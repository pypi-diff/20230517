# Comparing `tmp/tskit-0.5.4.tar.gz` & `tmp/tskit-0.5.5.tar.gz`

## filetype from file(1)

```diff
@@ -1 +1 @@
-gzip compressed data, was "tskit-0.5.4.tar", last modified: Fri Jan 13 20:30:14 2023, max compression
+gzip compressed data, was "tskit-0.5.5.tar", last modified: Wed May 17 20:09:22 2023, max compression
```

## Comparing `tskit-0.5.4.tar` & `tskit-0.5.5.tar`

### file list

```diff
@@ -1,58 +1,58 @@
-drwxr-xr-x   0 runner    (1001) docker     (123)        0 2023-01-13 20:30:14.482324 tskit-0.5.4/
--rw-r--r--   0 runner    (1001) docker     (123)     1078 2023-01-13 20:30:11.000000 tskit-0.5.4/LICENSE
--rw-r--r--   0 runner    (1001) docker     (123)      207 2023-01-13 20:30:11.000000 tskit-0.5.4/MANIFEST.in
--rw-r--r--   0 runner    (1001) docker     (123)     2048 2023-01-13 20:30:14.482324 tskit-0.5.4/PKG-INFO
--rw-r--r--   0 runner    (1001) docker     (123)      370 2023-01-13 20:30:11.000000 tskit-0.5.4/README.rst
--rw-r--r--   0 runner    (1001) docker     (123)   376460 2023-01-13 20:30:11.000000 tskit-0.5.4/_tskitmodule.c
-drwxr-xr-x   0 runner    (1001) docker     (123)        0 2023-01-13 20:30:14.478324 tskit-0.5.4/lib/
-drwxr-xr-x   0 runner    (1001) docker     (123)        0 2023-01-13 20:30:14.474324 tskit-0.5.4/lib/subprojects/
-drwxr-xr-x   0 runner    (1001) docker     (123)        0 2023-01-13 20:30:14.478324 tskit-0.5.4/lib/subprojects/kastore/
--rw-r--r--   0 runner    (1001) docker     (123)    33757 2023-01-13 20:30:11.000000 tskit-0.5.4/lib/subprojects/kastore/kastore.c
--rw-r--r--   0 runner    (1001) docker     (123)    21452 2023-01-13 20:30:11.000000 tskit-0.5.4/lib/subprojects/kastore/kastore.h
-drwxr-xr-x   0 runner    (1001) docker     (123)        0 2023-01-13 20:30:14.478324 tskit-0.5.4/lib/tskit/
--rw-r--r--   0 runner    (1001) docker     (123)     6245 2023-01-13 20:30:11.000000 tskit-0.5.4/lib/tskit/convert.c
--rw-r--r--   0 runner    (1001) docker     (123)     1532 2023-01-13 20:30:11.000000 tskit-0.5.4/lib/tskit/convert.h
--rw-r--r--   0 runner    (1001) docker     (123)    39172 2023-01-13 20:30:11.000000 tskit-0.5.4/lib/tskit/core.c
--rw-r--r--   0 runner    (1001) docker     (123)    31098 2023-01-13 20:30:11.000000 tskit-0.5.4/lib/tskit/core.h
--rw-r--r--   0 runner    (1001) docker     (123)    21534 2023-01-13 20:30:11.000000 tskit-0.5.4/lib/tskit/genotypes.c
--rw-r--r--   0 runner    (1001) docker     (123)     7275 2023-01-13 20:30:11.000000 tskit-0.5.4/lib/tskit/genotypes.h
--rw-r--r--   0 runner    (1001) docker     (123)    54813 2023-01-13 20:30:11.000000 tskit-0.5.4/lib/tskit/haplotype_matching.c
--rw-r--r--   0 runner    (1001) docker     (123)     6210 2023-01-13 20:30:11.000000 tskit-0.5.4/lib/tskit/haplotype_matching.h
--rw-r--r--   0 runner    (1001) docker     (123)     8164 2023-01-13 20:30:11.000000 tskit-0.5.4/lib/tskit/stats.c
--rw-r--r--   0 runner    (1001) docker     (123)     2084 2023-01-13 20:30:11.000000 tskit-0.5.4/lib/tskit/stats.h
--rw-r--r--   0 runner    (1001) docker     (123)   419221 2023-01-13 20:30:11.000000 tskit-0.5.4/lib/tskit/tables.c
--rw-r--r--   0 runner    (1001) docker     (123)   171562 2023-01-13 20:30:11.000000 tskit-0.5.4/lib/tskit/tables.h
--rw-r--r--   0 runner    (1001) docker     (123)   194126 2023-01-13 20:30:11.000000 tskit-0.5.4/lib/tskit/trees.c
--rw-r--r--   0 runner    (1001) docker     (123)    58747 2023-01-13 20:30:11.000000 tskit-0.5.4/lib/tskit/trees.h
--rw-r--r--   0 runner    (1001) docker     (123)     1403 2023-01-13 20:30:11.000000 tskit-0.5.4/lib/tskit.h
-drwxr-xr-x   0 runner    (1001) docker     (123)        0 2023-01-13 20:30:14.478324 tskit-0.5.4/lwt_interface/
--rw-r--r--   0 runner    (1001) docker     (123)    68785 2023-01-13 20:30:11.000000 tskit-0.5.4/lwt_interface/tskit_lwt_interface.h
--rw-r--r--   0 runner    (1001) docker     (123)     1747 2023-01-13 20:30:14.486324 tskit-0.5.4/setup.cfg
--rw-r--r--   0 runner    (1001) docker     (123)     1881 2023-01-13 20:30:11.000000 tskit-0.5.4/setup.py
-drwxr-xr-x   0 runner    (1001) docker     (123)        0 2023-01-13 20:30:14.482324 tskit-0.5.4/tskit/
--rw-r--r--   0 runner    (1001) docker     (123)     3256 2023-01-13 20:30:11.000000 tskit-0.5.4/tskit/__init__.py
--rw-r--r--   0 runner    (1001) docker     (123)       67 2023-01-13 20:30:11.000000 tskit-0.5.4/tskit/__main__.py
--rw-r--r--   0 runner    (1001) docker     (123)      142 2023-01-13 20:30:11.000000 tskit-0.5.4/tskit/_version.py
--rw-r--r--   0 runner    (1001) docker     (123)     9596 2023-01-13 20:30:11.000000 tskit-0.5.4/tskit/cli.py
--rw-r--r--   0 runner    (1001) docker     (123)    55713 2023-01-13 20:30:11.000000 tskit-0.5.4/tskit/combinatorics.py
--rw-r--r--   0 runner    (1001) docker     (123)    88693 2023-01-13 20:30:11.000000 tskit-0.5.4/tskit/drawing.py
--rw-r--r--   0 runner    (1001) docker     (123)     2214 2023-01-13 20:30:11.000000 tskit-0.5.4/tskit/exceptions.py
--rw-r--r--   0 runner    (1001) docker     (123)    22977 2023-01-13 20:30:11.000000 tskit-0.5.4/tskit/formats.py
--rw-r--r--   0 runner    (1001) docker     (123)    15669 2023-01-13 20:30:11.000000 tskit-0.5.4/tskit/genotypes.py
--rw-r--r--   0 runner    (1001) docker     (123)    23924 2023-01-13 20:30:11.000000 tskit-0.5.4/tskit/intervals.py
--rw-r--r--   0 runner    (1001) docker     (123)    31023 2023-01-13 20:30:11.000000 tskit-0.5.4/tskit/metadata.py
--rw-r--r--   0 runner    (1001) docker     (123)     4173 2023-01-13 20:30:11.000000 tskit-0.5.4/tskit/provenance.py
--rw-r--r--   0 runner    (1001) docker     (123)     1499 2023-01-13 20:30:11.000000 tskit-0.5.4/tskit/provenance.schema.json
--rw-r--r--   0 runner    (1001) docker     (123)    28067 2023-01-13 20:30:11.000000 tskit-0.5.4/tskit/stats.py
--rw-r--r--   0 runner    (1001) docker     (123)   170800 2023-01-13 20:30:11.000000 tskit-0.5.4/tskit/tables.py
--rw-r--r--   0 runner    (1001) docker     (123)    14754 2023-01-13 20:30:11.000000 tskit-0.5.4/tskit/text_formats.py
--rw-r--r--   0 runner    (1001) docker     (123)   395385 2023-01-13 20:30:11.000000 tskit-0.5.4/tskit/trees.py
--rw-r--r--   0 runner    (1001) docker     (123)    30649 2023-01-13 20:30:11.000000 tskit-0.5.4/tskit/util.py
--rw-r--r--   0 runner    (1001) docker     (123)    10589 2023-01-13 20:30:11.000000 tskit-0.5.4/tskit/vcf.py
-drwxr-xr-x   0 runner    (1001) docker     (123)        0 2023-01-13 20:30:14.482324 tskit-0.5.4/tskit.egg-info/
--rw-r--r--   0 runner    (1001) docker     (123)     2048 2023-01-13 20:30:14.000000 tskit-0.5.4/tskit.egg-info/PKG-INFO
--rw-r--r--   0 runner    (1001) docker     (123)      990 2023-01-13 20:30:14.000000 tskit-0.5.4/tskit.egg-info/SOURCES.txt
--rw-r--r--   0 runner    (1001) docker     (123)        1 2023-01-13 20:30:14.000000 tskit-0.5.4/tskit.egg-info/dependency_links.txt
--rw-r--r--   0 runner    (1001) docker     (123)       48 2023-01-13 20:30:14.000000 tskit-0.5.4/tskit.egg-info/entry_points.txt
--rw-r--r--   0 runner    (1001) docker     (123)       46 2023-01-13 20:30:14.000000 tskit-0.5.4/tskit.egg-info/requires.txt
--rw-r--r--   0 runner    (1001) docker     (123)       13 2023-01-13 20:30:14.000000 tskit-0.5.4/tskit.egg-info/top_level.txt
+drwxr-xr-x   0 runner    (1001) docker     (123)        0 2023-05-17 20:09:22.868939 tskit-0.5.5/
+-rw-r--r--   0 runner    (1001) docker     (123)     1078 2023-05-17 20:09:17.000000 tskit-0.5.5/LICENSE
+-rw-r--r--   0 runner    (1001) docker     (123)      207 2023-05-17 20:09:17.000000 tskit-0.5.5/MANIFEST.in
+-rw-r--r--   0 runner    (1001) docker     (123)     2048 2023-05-17 20:09:22.868939 tskit-0.5.5/PKG-INFO
+-rw-r--r--   0 runner    (1001) docker     (123)      370 2023-05-17 20:09:17.000000 tskit-0.5.5/README.rst
+-rw-r--r--   0 runner    (1001) docker     (123)   384733 2023-05-17 20:09:17.000000 tskit-0.5.5/_tskitmodule.c
+drwxr-xr-x   0 runner    (1001) docker     (123)        0 2023-05-17 20:09:22.860939 tskit-0.5.5/lib/
+drwxr-xr-x   0 runner    (1001) docker     (123)        0 2023-05-17 20:09:22.856939 tskit-0.5.5/lib/subprojects/
+drwxr-xr-x   0 runner    (1001) docker     (123)        0 2023-05-17 20:09:22.860939 tskit-0.5.5/lib/subprojects/kastore/
+-rw-r--r--   0 runner    (1001) docker     (123)    33757 2023-05-17 20:09:17.000000 tskit-0.5.5/lib/subprojects/kastore/kastore.c
+-rw-r--r--   0 runner    (1001) docker     (123)    21452 2023-05-17 20:09:17.000000 tskit-0.5.5/lib/subprojects/kastore/kastore.h
+drwxr-xr-x   0 runner    (1001) docker     (123)        0 2023-05-17 20:09:22.860939 tskit-0.5.5/lib/tskit/
+-rw-r--r--   0 runner    (1001) docker     (123)     6245 2023-05-17 20:09:17.000000 tskit-0.5.5/lib/tskit/convert.c
+-rw-r--r--   0 runner    (1001) docker     (123)     1532 2023-05-17 20:09:17.000000 tskit-0.5.5/lib/tskit/convert.h
+-rw-r--r--   0 runner    (1001) docker     (123)    39374 2023-05-17 20:09:17.000000 tskit-0.5.5/lib/tskit/core.c
+-rw-r--r--   0 runner    (1001) docker     (123)    31363 2023-05-17 20:09:17.000000 tskit-0.5.5/lib/tskit/core.h
+-rw-r--r--   0 runner    (1001) docker     (123)    21534 2023-05-17 20:09:17.000000 tskit-0.5.5/lib/tskit/genotypes.c
+-rw-r--r--   0 runner    (1001) docker     (123)     7275 2023-05-17 20:09:17.000000 tskit-0.5.5/lib/tskit/genotypes.h
+-rw-r--r--   0 runner    (1001) docker     (123)    54821 2023-05-17 20:09:17.000000 tskit-0.5.5/lib/tskit/haplotype_matching.c
+-rw-r--r--   0 runner    (1001) docker     (123)     6210 2023-05-17 20:09:17.000000 tskit-0.5.5/lib/tskit/haplotype_matching.h
+-rw-r--r--   0 runner    (1001) docker     (123)     8164 2023-05-17 20:09:17.000000 tskit-0.5.5/lib/tskit/stats.c
+-rw-r--r--   0 runner    (1001) docker     (123)     2084 2023-05-17 20:09:17.000000 tskit-0.5.5/lib/tskit/stats.h
+-rw-r--r--   0 runner    (1001) docker     (123)   438163 2023-05-17 20:09:17.000000 tskit-0.5.5/lib/tskit/tables.c
+-rw-r--r--   0 runner    (1001) docker     (123)   187690 2023-05-17 20:09:17.000000 tskit-0.5.5/lib/tskit/tables.h
+-rw-r--r--   0 runner    (1001) docker     (123)   193499 2023-05-17 20:09:17.000000 tskit-0.5.5/lib/tskit/trees.c
+-rw-r--r--   0 runner    (1001) docker     (123)    57764 2023-05-17 20:09:17.000000 tskit-0.5.5/lib/tskit/trees.h
+-rw-r--r--   0 runner    (1001) docker     (123)     1403 2023-05-17 20:09:17.000000 tskit-0.5.5/lib/tskit.h
+drwxr-xr-x   0 runner    (1001) docker     (123)        0 2023-05-17 20:09:22.860939 tskit-0.5.5/lwt_interface/
+-rw-r--r--   0 runner    (1001) docker     (123)    68785 2023-05-17 20:09:17.000000 tskit-0.5.5/lwt_interface/tskit_lwt_interface.h
+-rw-r--r--   0 runner    (1001) docker     (123)     1747 2023-05-17 20:09:22.868939 tskit-0.5.5/setup.cfg
+-rw-r--r--   0 runner    (1001) docker     (123)     1881 2023-05-17 20:09:17.000000 tskit-0.5.5/setup.py
+drwxr-xr-x   0 runner    (1001) docker     (123)        0 2023-05-17 20:09:22.864939 tskit-0.5.5/tskit/
+-rw-r--r--   0 runner    (1001) docker     (123)     3256 2023-05-17 20:09:17.000000 tskit-0.5.5/tskit/__init__.py
+-rw-r--r--   0 runner    (1001) docker     (123)       67 2023-05-17 20:09:17.000000 tskit-0.5.5/tskit/__main__.py
+-rw-r--r--   0 runner    (1001) docker     (123)      142 2023-05-17 20:09:17.000000 tskit-0.5.5/tskit/_version.py
+-rw-r--r--   0 runner    (1001) docker     (123)     9596 2023-05-17 20:09:17.000000 tskit-0.5.5/tskit/cli.py
+-rw-r--r--   0 runner    (1001) docker     (123)    55713 2023-05-17 20:09:17.000000 tskit-0.5.5/tskit/combinatorics.py
+-rw-r--r--   0 runner    (1001) docker     (123)    88693 2023-05-17 20:09:17.000000 tskit-0.5.5/tskit/drawing.py
+-rw-r--r--   0 runner    (1001) docker     (123)     2214 2023-05-17 20:09:17.000000 tskit-0.5.5/tskit/exceptions.py
+-rw-r--r--   0 runner    (1001) docker     (123)    22977 2023-05-17 20:09:17.000000 tskit-0.5.5/tskit/formats.py
+-rw-r--r--   0 runner    (1001) docker     (123)    16017 2023-05-17 20:09:17.000000 tskit-0.5.5/tskit/genotypes.py
+-rw-r--r--   0 runner    (1001) docker     (123)    23924 2023-05-17 20:09:17.000000 tskit-0.5.5/tskit/intervals.py
+-rw-r--r--   0 runner    (1001) docker     (123)    31023 2023-05-17 20:09:17.000000 tskit-0.5.5/tskit/metadata.py
+-rw-r--r--   0 runner    (1001) docker     (123)     4173 2023-05-17 20:09:17.000000 tskit-0.5.5/tskit/provenance.py
+-rw-r--r--   0 runner    (1001) docker     (123)     1499 2023-05-17 20:09:17.000000 tskit-0.5.5/tskit/provenance.schema.json
+-rw-r--r--   0 runner    (1001) docker     (123)    36261 2023-05-17 20:09:17.000000 tskit-0.5.5/tskit/stats.py
+-rw-r--r--   0 runner    (1001) docker     (123)   174066 2023-05-17 20:09:17.000000 tskit-0.5.5/tskit/tables.py
+-rw-r--r--   0 runner    (1001) docker     (123)    14754 2023-05-17 20:09:17.000000 tskit-0.5.5/tskit/text_formats.py
+-rw-r--r--   0 runner    (1001) docker     (123)   395444 2023-05-17 20:09:17.000000 tskit-0.5.5/tskit/trees.py
+-rw-r--r--   0 runner    (1001) docker     (123)    30649 2023-05-17 20:09:17.000000 tskit-0.5.5/tskit/util.py
+-rw-r--r--   0 runner    (1001) docker     (123)    10589 2023-05-17 20:09:17.000000 tskit-0.5.5/tskit/vcf.py
+drwxr-xr-x   0 runner    (1001) docker     (123)        0 2023-05-17 20:09:22.864939 tskit-0.5.5/tskit.egg-info/
+-rw-r--r--   0 runner    (1001) docker     (123)     2048 2023-05-17 20:09:22.000000 tskit-0.5.5/tskit.egg-info/PKG-INFO
+-rw-r--r--   0 runner    (1001) docker     (123)      990 2023-05-17 20:09:22.000000 tskit-0.5.5/tskit.egg-info/SOURCES.txt
+-rw-r--r--   0 runner    (1001) docker     (123)        1 2023-05-17 20:09:22.000000 tskit-0.5.5/tskit.egg-info/dependency_links.txt
+-rw-r--r--   0 runner    (1001) docker     (123)       48 2023-05-17 20:09:22.000000 tskit-0.5.5/tskit.egg-info/entry_points.txt
+-rw-r--r--   0 runner    (1001) docker     (123)       46 2023-05-17 20:09:22.000000 tskit-0.5.5/tskit.egg-info/requires.txt
+-rw-r--r--   0 runner    (1001) docker     (123)       13 2023-05-17 20:09:22.000000 tskit-0.5.5/tskit.egg-info/top_level.txt
```

### Comparing `tskit-0.5.4/LICENSE` & `tskit-0.5.5/LICENSE`

 * *Files identical despite different names*

### Comparing `tskit-0.5.4/PKG-INFO` & `tskit-0.5.5/PKG-INFO`

 * *Files 0% similar despite different names*

```diff
@@ -1,10 +1,10 @@
 Metadata-Version: 2.1
 Name: tskit
-Version: 0.5.4
+Version: 0.5.5
 Summary: The tree sequence toolkit.
 Home-page: https://tskit.dev/tskit
 Author: Tskit Developers
 Author-email: admin@tskit.dev
 License: MIT
 Project-URL: Documentation, https://tskit.dev/tskit/docs/stable
 Project-URL: Changelog, https://tskit.dev/tskit/docs/stable/changelogs.html
```

### Comparing `tskit-0.5.4/_tskitmodule.c` & `tskit-0.5.5/_tskitmodule.c`

 * *Files 1% similar despite different names*

```diff
@@ -574,15 +574,16 @@
     tsk_size_t j;
 
     t = PyTuple_New(variant->num_alleles + variant->has_missing_data);
     if (t == NULL) {
         goto out;
     }
     for (j = 0; j < variant->num_alleles; j++) {
-        item = Py_BuildValue("s#", variant->alleles[j], variant->allele_lengths[j]);
+        item = Py_BuildValue(
+            "s#", variant->alleles[j], (Py_ssize_t) variant->allele_lengths[j]);
         if (item == NULL) {
             Py_DECREF(t);
             goto out;
         }
         PyTuple_SET_ITEM(t, j, item);
     }
     if (variant->has_missing_data) {
@@ -938,30 +939,89 @@
     id_out[0] = (tsk_id_t) temp_long;
     ret = 1;
 out:
     return ret;
 }
 
 static int
-int32_array_converter(PyObject *py_obj, PyArrayObject **array_out)
+array_converter(int type, PyObject *py_obj, PyArrayObject **array_out)
 {
     int ret = 0;
     PyArrayObject *temp_array;
 
     temp_array = (PyArrayObject *) PyArray_FromAny(
-        py_obj, PyArray_DescrFromType(NPY_INT32), 1, 1, NPY_ARRAY_IN_ARRAY, NULL);
+        py_obj, PyArray_DescrFromType(type), 1, 1, NPY_ARRAY_IN_ARRAY, NULL);
+
     if (temp_array == NULL) {
         goto out;
     }
     *array_out = temp_array;
     ret = 1;
 out:
     return ret;
 }
 
+static int
+int32_array_converter(PyObject *py_obj, PyArrayObject **array_out)
+{
+    return array_converter(NPY_INT32, py_obj, array_out);
+}
+
+static int
+bool_array_converter(PyObject *py_obj, PyArrayObject **array_out)
+{
+    return array_converter(NPY_BOOL, py_obj, array_out);
+}
+
+/* Note: it doesn't seem to be possible to cast pointers to the actual
+ * table functions to this type because the first argument must be a
+ * void *, so the simplest option is to put in a small shim that
+ * wraps the library function and casts to the correct table type.
+ */
+typedef int keep_row_func_t(
+    void *self, const tsk_bool_t *keep, tsk_flags_t options, tsk_id_t *id_map);
+
+static PyObject *
+table_keep_rows(
+    PyObject *args, void *table, tsk_size_t num_rows, keep_row_func_t keep_row_func)
+{
+
+    PyObject *ret = NULL;
+    PyArrayObject *keep = NULL;
+    PyArrayObject *id_map = NULL;
+    npy_intp n = (npy_intp) num_rows;
+    npy_intp array_len;
+    int err;
+
+    if (!PyArg_ParseTuple(args, "O&", &bool_array_converter, &keep)) {
+        goto out;
+    }
+    array_len = PyArray_DIMS(keep)[0];
+    if (array_len != n) {
+        PyErr_SetString(PyExc_ValueError, "keep array must be of length Table.num_rows");
+        goto out;
+    }
+    id_map = (PyArrayObject *) PyArray_SimpleNew(1, &n, NPY_INT32);
+    if (id_map == NULL) {
+        goto out;
+    }
+    err = keep_row_func(table, PyArray_DATA(keep), 0, PyArray_DATA(id_map));
+
+    if (err != 0) {
+        handle_library_error(err);
+        goto out;
+    }
+    ret = (PyObject *) id_map;
+    id_map = NULL;
+out:
+    Py_XDECREF(keep);
+    Py_XDECREF(id_map);
+    return ret;
+}
+
 /*===================================================================
  * IndividualTable
  *===================================================================
  */
 
 static int
 IndividualTable_check_state(IndividualTable *self)
@@ -1328,14 +1388,36 @@
     }
     ret = Py_BuildValue("");
 out:
     Py_XDECREF(row_indexes);
     return ret;
 }
 
+static int
+individual_table_keep_rows_generic(
+    void *table, const tsk_bool_t *keep, tsk_flags_t options, tsk_id_t *id_map)
+{
+    return tsk_individual_table_keep_rows(
+        (tsk_individual_table_t *) table, keep, options, id_map);
+}
+
+static PyObject *
+IndividualTable_keep_rows(IndividualTable *self, PyObject *args)
+{
+    PyObject *ret = NULL;
+
+    if (IndividualTable_check_state(self) != 0) {
+        goto out;
+    }
+    ret = table_keep_rows(args, (void *) self->table, self->table->num_rows,
+        individual_table_keep_rows_generic);
+out:
+    return ret;
+}
+
 static PyObject *
 IndividualTable_get_max_rows_increment(IndividualTable *self, void *closure)
 {
     PyObject *ret = NULL;
     if (IndividualTable_check_state(self) != 0) {
         goto out;
     }
@@ -1574,14 +1656,18 @@
         .ml_meth = (PyCFunction) IndividualTable_truncate,
         .ml_flags = METH_VARARGS,
         .ml_doc = "Truncates this table to the specified number of rows." },
     { .ml_name = "extend",
         .ml_meth = (PyCFunction) IndividualTable_extend,
         .ml_flags = METH_VARARGS | METH_KEYWORDS,
         .ml_doc = "Extend this table from another using specified row_indexes" },
+    { .ml_name = "keep_rows",
+        .ml_meth = (PyCFunction) IndividualTable_keep_rows,
+        .ml_flags = METH_VARARGS,
+        .ml_doc = "Keep rows in this table according to boolean array" },
     { NULL } /* Sentinel */
 };
 
 static PyTypeObject IndividualTableType = {
     // clang-format off
     PyVarObject_HEAD_INIT(NULL, 0)
     .tp_name = "_tskit.IndividualTable",
@@ -1907,14 +1993,35 @@
     }
     ret = Py_BuildValue("");
 out:
     Py_XDECREF(row_indexes);
     return ret;
 }
 
+static int
+node_table_keep_rows_generic(
+    void *table, const tsk_bool_t *keep, tsk_flags_t options, tsk_id_t *id_map)
+{
+    return tsk_node_table_keep_rows((tsk_node_table_t *) table, keep, options, id_map);
+}
+
+static PyObject *
+NodeTable_keep_rows(NodeTable *self, PyObject *args)
+{
+    PyObject *ret = NULL;
+
+    if (NodeTable_check_state(self) != 0) {
+        goto out;
+    }
+    ret = table_keep_rows(
+        args, (void *) self->table, self->table->num_rows, node_table_keep_rows_generic);
+out:
+    return ret;
+}
+
 static PyObject *
 NodeTable_get_max_rows_increment(NodeTable *self, void *closure)
 {
     PyObject *ret = NULL;
     if (NodeTable_check_state(self) != 0) {
         goto out;
     }
@@ -2134,14 +2241,18 @@
         .ml_meth = (PyCFunction) NodeTable_truncate,
         .ml_flags = METH_VARARGS,
         .ml_doc = "Truncates this table to the specified number of rows." },
     { .ml_name = "extend",
         .ml_meth = (PyCFunction) NodeTable_extend,
         .ml_flags = METH_VARARGS | METH_KEYWORDS,
         .ml_doc = "Extend this table from another using specified row_indexes" },
+    { .ml_name = "keep_rows",
+        .ml_meth = (PyCFunction) NodeTable_keep_rows,
+        .ml_flags = METH_VARARGS,
+        .ml_doc = "Keep rows in this table according to boolean array" },
 
     { NULL } /* Sentinel */
 };
 
 static PyTypeObject NodeTableType = {
     // clang-format off
     PyVarObject_HEAD_INIT(NULL, 0)
@@ -2478,14 +2589,35 @@
     }
     ret = Py_BuildValue("");
 out:
     Py_XDECREF(row_indexes);
     return ret;
 }
 
+static int
+edge_table_keep_rows_generic(
+    void *table, const tsk_bool_t *keep, tsk_flags_t options, tsk_id_t *id_map)
+{
+    return tsk_edge_table_keep_rows((tsk_edge_table_t *) table, keep, options, id_map);
+}
+
+static PyObject *
+EdgeTable_keep_rows(EdgeTable *self, PyObject *args)
+{
+    PyObject *ret = NULL;
+
+    if (EdgeTable_check_state(self) != 0) {
+        goto out;
+    }
+    ret = table_keep_rows(
+        args, (void *) self->table, self->table->num_rows, edge_table_keep_rows_generic);
+out:
+    return ret;
+}
+
 static PyObject *
 EdgeTable_get_max_rows_increment(EdgeTable *self, void *closure)
 {
     PyObject *ret = NULL;
     if (EdgeTable_check_state(self) != 0) {
         goto out;
     }
@@ -2703,19 +2835,22 @@
         .ml_meth = (PyCFunction) EdgeTable_truncate,
         .ml_flags = METH_VARARGS,
         .ml_doc = "Truncates this table to the specified number of rows." },
     { .ml_name = "extend",
         .ml_meth = (PyCFunction) EdgeTable_extend,
         .ml_flags = METH_VARARGS | METH_KEYWORDS,
         .ml_doc = "Extend this table from another using specified row_indexes" },
-
     { .ml_name = "squash",
         .ml_meth = (PyCFunction) EdgeTable_squash,
         .ml_flags = METH_NOARGS,
         .ml_doc = "Squashes sets of edges with adjacent L,R and identical P,C values." },
+    { .ml_name = "keep_rows",
+        .ml_meth = (PyCFunction) EdgeTable_keep_rows,
+        .ml_flags = METH_VARARGS,
+        .ml_doc = "Keep rows in this table according to boolean array" },
     { NULL } /* Sentinel */
 };
 
 static PyTypeObject EdgeTableType = {
     // clang-format off
     PyVarObject_HEAD_INIT(NULL, 0)
     .tp_name = "_tskit.EdgeTable",
@@ -3035,14 +3170,36 @@
     }
     ret = Py_BuildValue("");
 out:
     Py_XDECREF(row_indexes);
     return ret;
 }
 
+static int
+migration_table_keep_rows_generic(
+    void *table, const tsk_bool_t *keep, tsk_flags_t options, tsk_id_t *id_map)
+{
+    return tsk_migration_table_keep_rows(
+        (tsk_migration_table_t *) table, keep, options, id_map);
+}
+
+static PyObject *
+MigrationTable_keep_rows(MigrationTable *self, PyObject *args)
+{
+    PyObject *ret = NULL;
+
+    if (MigrationTable_check_state(self) != 0) {
+        goto out;
+    }
+    ret = table_keep_rows(args, (void *) self->table, self->table->num_rows,
+        migration_table_keep_rows_generic);
+out:
+    return ret;
+}
+
 static PyObject *
 MigrationTable_get_max_rows_increment(MigrationTable *self, void *closure)
 {
     PyObject *ret = NULL;
     if (MigrationTable_check_state(self) != 0) {
         goto out;
     }
@@ -3292,14 +3449,18 @@
         .ml_meth = (PyCFunction) MigrationTable_truncate,
         .ml_flags = METH_VARARGS,
         .ml_doc = "Truncates this table to the specified number of rows." },
     { .ml_name = "extend",
         .ml_meth = (PyCFunction) MigrationTable_extend,
         .ml_flags = METH_VARARGS | METH_KEYWORDS,
         .ml_doc = "Extend this table from another using specified row_indexes" },
+    { .ml_name = "keep_rows",
+        .ml_meth = (PyCFunction) MigrationTable_keep_rows,
+        .ml_flags = METH_VARARGS,
+        .ml_doc = "Keep rows in this table according to boolean array" },
 
     { NULL } /* Sentinel */
 };
 
 static PyTypeObject MigrationTableType = {
     // clang-format off
     PyVarObject_HEAD_INIT(NULL, 0)
@@ -3619,14 +3780,35 @@
     }
     ret = Py_BuildValue("");
 out:
     Py_XDECREF(row_indexes);
     return ret;
 }
 
+static int
+site_table_keep_rows_generic(
+    void *table, const tsk_bool_t *keep, tsk_flags_t options, tsk_id_t *id_map)
+{
+    return tsk_site_table_keep_rows((tsk_site_table_t *) table, keep, options, id_map);
+}
+
+static PyObject *
+SiteTable_keep_rows(SiteTable *self, PyObject *args)
+{
+    PyObject *ret = NULL;
+
+    if (SiteTable_check_state(self) != 0) {
+        goto out;
+    }
+    ret = table_keep_rows(
+        args, (void *) self->table, self->table->num_rows, site_table_keep_rows_generic);
+out:
+    return ret;
+}
+
 static PyObject *
 SiteTable_get_max_rows_increment(SiteTable *self, void *closure)
 {
     PyObject *ret = NULL;
     if (SiteTable_check_state(self) != 0) {
         goto out;
     }
@@ -3833,14 +4015,18 @@
         .ml_meth = (PyCFunction) SiteTable_truncate,
         .ml_flags = METH_VARARGS,
         .ml_doc = "Truncates this table to the specified number of rows." },
     { .ml_name = "extend",
         .ml_meth = (PyCFunction) SiteTable_extend,
         .ml_flags = METH_VARARGS | METH_KEYWORDS,
         .ml_doc = "Extend this table from another using specified row_indexes" },
+    { .ml_name = "keep_rows",
+        .ml_meth = (PyCFunction) SiteTable_keep_rows,
+        .ml_flags = METH_VARARGS,
+        .ml_doc = "Keep rows in this table according to boolean array" },
 
     { NULL } /* Sentinel */
 };
 
 static PyTypeObject SiteTableType = {
     // clang-format off
     PyVarObject_HEAD_INIT(NULL, 0)
@@ -4169,14 +4355,36 @@
     }
     ret = Py_BuildValue("");
 out:
     Py_XDECREF(row_indexes);
     return ret;
 }
 
+static int
+mutation_table_keep_rows_generic(
+    void *table, const tsk_bool_t *keep, tsk_flags_t options, tsk_id_t *id_map)
+{
+    return tsk_mutation_table_keep_rows(
+        (tsk_mutation_table_t *) table, keep, options, id_map);
+}
+
+static PyObject *
+MutationTable_keep_rows(MutationTable *self, PyObject *args)
+{
+    PyObject *ret = NULL;
+
+    if (MutationTable_check_state(self) != 0) {
+        goto out;
+    }
+    ret = table_keep_rows(args, (void *) self->table, self->table->num_rows,
+        mutation_table_keep_rows_generic);
+out:
+    return ret;
+}
+
 static PyObject *
 MutationTable_get_max_rows_increment(MutationTable *self, void *closure)
 {
     PyObject *ret = NULL;
     if (MutationTable_check_state(self) != 0) {
         goto out;
     }
@@ -4428,14 +4636,18 @@
         .ml_meth = (PyCFunction) MutationTable_truncate,
         .ml_flags = METH_VARARGS,
         .ml_doc = "Truncates this table to the specified number of rows." },
     { .ml_name = "extend",
         .ml_meth = (PyCFunction) MutationTable_extend,
         .ml_flags = METH_VARARGS | METH_KEYWORDS,
         .ml_doc = "Extend this table from another using specified row_indexes" },
+    { .ml_name = "keep_rows",
+        .ml_meth = (PyCFunction) MutationTable_keep_rows,
+        .ml_flags = METH_VARARGS,
+        .ml_doc = "Keep rows in this table according to boolean array" },
 
     { NULL } /* Sentinel */
 };
 
 static PyTypeObject MutationTableType = {
     // clang-format off
     PyVarObject_HEAD_INIT(NULL, 0)
@@ -4750,14 +4962,36 @@
     }
     ret = Py_BuildValue("");
 out:
     Py_XDECREF(row_indexes);
     return ret;
 }
 
+static int
+population_table_keep_rows_generic(
+    void *table, const tsk_bool_t *keep, tsk_flags_t options, tsk_id_t *id_map)
+{
+    return tsk_population_table_keep_rows(
+        (tsk_population_table_t *) table, keep, options, id_map);
+}
+
+static PyObject *
+PopulationTable_keep_rows(PopulationTable *self, PyObject *args)
+{
+    PyObject *ret = NULL;
+
+    if (PopulationTable_check_state(self) != 0) {
+        goto out;
+    }
+    ret = table_keep_rows(args, (void *) self->table, self->table->num_rows,
+        population_table_keep_rows_generic);
+out:
+    return ret;
+}
+
 static PyObject *
 PopulationTable_get_max_rows_increment(PopulationTable *self, void *closure)
 {
     PyObject *ret = NULL;
     if (PopulationTable_check_state(self) != 0) {
         goto out;
     }
@@ -4914,14 +5148,18 @@
         .ml_meth = (PyCFunction) PopulationTable_truncate,
         .ml_flags = METH_VARARGS,
         .ml_doc = "Truncates this table to the specified number of rows." },
     { .ml_name = "extend",
         .ml_meth = (PyCFunction) PopulationTable_extend,
         .ml_flags = METH_VARARGS | METH_KEYWORDS,
         .ml_doc = "Extend this table from another using specified row_indexes" },
+    { .ml_name = "keep_rows",
+        .ml_meth = (PyCFunction) PopulationTable_keep_rows,
+        .ml_flags = METH_VARARGS,
+        .ml_doc = "Keep rows in this table according to boolean array" },
 
     { NULL } /* Sentinel */
 };
 
 static PyTypeObject PopulationTableType = {
     // clang-format off
     PyVarObject_HEAD_INIT(NULL, 0)
@@ -5228,14 +5466,36 @@
     }
     ret = Py_BuildValue("");
 out:
     Py_XDECREF(row_indexes);
     return ret;
 }
 
+static int
+provenance_table_keep_rows_generic(
+    void *table, const tsk_bool_t *keep, tsk_flags_t options, tsk_id_t *id_map)
+{
+    return tsk_provenance_table_keep_rows(
+        (tsk_provenance_table_t *) table, keep, options, id_map);
+}
+
+static PyObject *
+ProvenanceTable_keep_rows(ProvenanceTable *self, PyObject *args)
+{
+    PyObject *ret = NULL;
+
+    if (ProvenanceTable_check_state(self) != 0) {
+        goto out;
+    }
+    ret = table_keep_rows(args, (void *) self->table, self->table->num_rows,
+        provenance_table_keep_rows_generic);
+out:
+    return ret;
+}
+
 static PyObject *
 ProvenanceTable_get_max_rows_increment(ProvenanceTable *self, void *closure)
 {
     PyObject *ret = NULL;
     if (ProvenanceTable_check_state(self) != 0) {
         goto out;
     }
@@ -5381,14 +5641,18 @@
         .ml_meth = (PyCFunction) ProvenanceTable_truncate,
         .ml_flags = METH_VARARGS,
         .ml_doc = "Truncates this table to the specified number of rows." },
     { .ml_name = "extend",
         .ml_meth = (PyCFunction) ProvenanceTable_extend,
         .ml_flags = METH_VARARGS | METH_KEYWORDS,
         .ml_doc = "Extend this table from another using specified row_indexes" },
+    { .ml_name = "keep_rows",
+        .ml_meth = (PyCFunction) ProvenanceTable_keep_rows,
+        .ml_flags = METH_VARARGS,
+        .ml_doc = "Keep rows in this table according to boolean array" },
 
     { NULL } /* Sentinel */
 };
 
 static PyTypeObject ProvenanceTableType = {
     // clang-format off
     PyVarObject_HEAD_INIT(NULL, 0)
@@ -10392,14 +10656,37 @@
     }
     ret = Py_BuildValue("");
 out:
     return ret;
 }
 
 static PyObject *
+Tree_seek_index(Tree *self, PyObject *args)
+{
+    PyObject *ret = NULL;
+    tsk_id_t index = 0;
+    int err;
+
+    if (Tree_check_state(self) != 0) {
+        goto out;
+    }
+    if (!PyArg_ParseTuple(args, "O&", tsk_id_converter, &index)) {
+        goto out;
+    }
+    err = tsk_tree_seek_index(self->tree, index, 0);
+    if (err != 0) {
+        handle_library_error(err);
+        goto out;
+    }
+    ret = Py_BuildValue("");
+out:
+    return ret;
+}
+
+static PyObject *
 Tree_clear(Tree *self)
 {
     PyObject *ret = NULL;
     int err;
 
     if (Tree_check_state(self) != 0) {
         goto out;
@@ -11529,14 +11816,18 @@
         .ml_meth = (PyCFunction) Tree_next,
         .ml_flags = METH_NOARGS,
         .ml_doc = "Sets this tree to the next one in the sequence." },
     { .ml_name = "seek",
         .ml_meth = (PyCFunction) Tree_seek,
         .ml_flags = METH_VARARGS,
         .ml_doc = "Seeks to the tree at the specified position" },
+    { .ml_name = "seek_index",
+        .ml_meth = (PyCFunction) Tree_seek_index,
+        .ml_flags = METH_VARARGS,
+        .ml_doc = "Seeks to the tree at the specified index" },
     { .ml_name = "clear",
         .ml_meth = (PyCFunction) Tree_clear,
         .ml_flags = METH_NOARGS,
         .ml_doc = "Resets this tree back to the cleared null state." },
     { .ml_name = "get_sample_size",
         .ml_meth = (PyCFunction) Tree_get_sample_size,
         .ml_flags = METH_NOARGS,
```

### Comparing `tskit-0.5.4/lib/subprojects/kastore/kastore.c` & `tskit-0.5.5/lib/subprojects/kastore/kastore.c`

 * *Files identical despite different names*

### Comparing `tskit-0.5.4/lib/subprojects/kastore/kastore.h` & `tskit-0.5.5/lib/subprojects/kastore/kastore.h`

 * *Files identical despite different names*

### Comparing `tskit-0.5.4/lib/tskit/convert.c` & `tskit-0.5.5/lib/tskit/convert.c`

 * *Files identical despite different names*

### Comparing `tskit-0.5.4/lib/tskit/convert.h` & `tskit-0.5.5/lib/tskit/convert.h`

 * *Files identical despite different names*

### Comparing `tskit-0.5.4/lib/tskit/core.c` & `tskit-0.5.5/lib/tskit/core.c`

 * *Files 0% similar despite different names*

```diff
@@ -1,11 +1,11 @@
 /*
  * MIT License
  *
- * Copyright (c) 2019-2022 Tskit Developers
+ * Copyright (c) 2019-2023 Tskit Developers
  * Copyright (c) 2015-2018 University of Oxford
  *
  * Permission is hereby granted, free of charge, to any person obtaining a copy
  * of this software and associated documentation files (the "Software"), to deal
  * in the Software without restriction, including without limitation the rights
  * to use, copy, modify, merge, publish, distribute, sublicense, and/or sell
  * copies of the Software, and to permit persons to whom the Software is
@@ -218,14 +218,18 @@
         case TSK_ERR_GENOME_COORDS_NONFINITE:
             ret = "Genome coordinates must be finite numbers. "
                   "(TSK_ERR_GENOME_COORDS_NONFINITE)";
             break;
         case TSK_ERR_SEEK_OUT_OF_BOUNDS:
             ret = "Tree seek position out of bounds. (TSK_ERR_SEEK_OUT_OF_BOUNDS)";
             break;
+        case TSK_ERR_KEEP_ROWS_MAP_TO_DELETED:
+            ret = "One of the kept rows in the table refers to a deleted row. "
+                  "(TSK_ERR_KEEP_ROWS_MAP_TO_DELETED)";
+            break;
 
         /* Edge errors */
         case TSK_ERR_NULL_PARENT:
             ret = "Edge in parent is null. (TSK_ERR_NULL_PARENT)";
             break;
         case TSK_ERR_NULL_CHILD:
             ret = "Edge in parent is null. (TSK_ERR_NULL_CHILD)";
```

### Comparing `tskit-0.5.4/lib/tskit/core.h` & `tskit-0.5.5/lib/tskit/core.h`

 * *Files 1% similar despite different names*

```diff
@@ -1,11 +1,11 @@
 /*
  * MIT License
  *
- * Copyright (c) 2019-2022 Tskit Developers
+ * Copyright (c) 2019-2023 Tskit Developers
  * Copyright (c) 2015-2018 University of Oxford
  *
  * Permission is hereby granted, free of charge, to any person obtaining a copy
  * of this software and associated documentation files (the "Software"), to deal
  * in the Software without restriction, including without limitation the rights
  * to use, copy, modify, merge, publish, distribute, sublicense, and/or sell
  * copies of the Software, and to permit persons to whom the Software is
@@ -119,14 +119,23 @@
 Bitwise flags are used in tskit as a column type and also as a way to
 specify options to API functions.
 @endrst
 */
 typedef uint32_t tsk_flags_t;
 #define TSK_FLAGS_STORAGE_TYPE KAS_UINT32
 
+/**
+@brief Boolean type.
+
+@rst
+Fixed-size (1 byte) boolean values.
+@endrst
+*/
+typedef uint8_t tsk_bool_t;
+
 // clang-format off
 /**
 @defgroup API_VERSION_GROUP API version macros.
 @{
 */
 /**
 The library major version. Incremented when breaking changes to the API or ABI are
@@ -139,15 +148,15 @@
 to the API or ABI are introduced, i.e., the addition of a new function.
 */
 #define TSK_VERSION_MINOR   1
 /**
 The library patch version. Incremented when any changes not relevant to the
 to the API or ABI are introduced, i.e., internal refactors of bugfixes.
 */
-#define TSK_VERSION_PATCH   1
+#define TSK_VERSION_PATCH   2
 /** @} */
 
 /*
 We define a specific NAN value for default mutation time which indicates
 the time is unknown. We use a specific value so that if mutation time is set to
 a NAN from a computation we can reject it. This specific value is a non-signalling
 NAN with the last six fraction bytes set to the ascii of "tskit!"
@@ -352,14 +361,20 @@
 A time value was non-finite (NaN counts as finite)
 */
 #define TSK_ERR_TIME_NONFINITE                                      -210
 /**
 A genomic position was non-finite
 */
 #define TSK_ERR_GENOME_COORDS_NONFINITE                             -211
+/**
+One of the rows in the retained table refers to a row that has been
+deleted.
+*/
+#define TSK_ERR_KEEP_ROWS_MAP_TO_DELETED                            -212
+
 /** @} */
 
 /**
 @defgroup EDGE_ERROR_GROUP Edge errors.
 @{
 */
 /**
```

### Comparing `tskit-0.5.4/lib/tskit/genotypes.c` & `tskit-0.5.5/lib/tskit/genotypes.c`

 * *Files identical despite different names*

### Comparing `tskit-0.5.4/lib/tskit/genotypes.h` & `tskit-0.5.5/lib/tskit/genotypes.h`

 * *Files identical despite different names*

### Comparing `tskit-0.5.4/lib/tskit/haplotype_matching.c` & `tskit-0.5.5/lib/tskit/haplotype_matching.c`

 * *Files 0% similar despite different names*

```diff
@@ -1,11 +1,11 @@
 /*
  * MIT License
  *
- * Copyright (c) 2019-2022 Tskit Developers
+ * Copyright (c) 2019-2023 Tskit Developers
  *
  * Permission is hereby granted, free of charge, to any person obtaining a copy
  * of this software and associated documentation files (the "Software"), to deal
  * in the Software without restriction, including without limitation the rights
  * to use, copy, modify, merge, publish, distribute, sublicense, and/or sell
  * copies of the Software, and to permit persons to whom the Software is
  * furnished to do so, subject to the following conditions:
@@ -246,15 +246,15 @@
     tsk_memset(self->num_transition_samples, 0,
         self->max_transitions * sizeof(*self->num_transition_samples));
     tsk_memset(self->transition_parent, 0xff,
         self->max_transitions * sizeof(*self->transition_parent));
 
     /* This is safe because we've already zero'd out the memory. */
     tsk_diff_iter_free(&self->diffs);
-    ret = tsk_diff_iter_init(&self->diffs, self->tree_sequence, false);
+    ret = tsk_diff_iter_init_from_ts(&self->diffs, self->tree_sequence, false);
     if (ret != 0) {
         goto out;
     }
     samples = tsk_treeseq_get_samples(self->tree_sequence);
     for (j = 0; j < self->num_samples; j++) {
         u = samples[j];
         self->transitions[j].tree_node = u;
```

### Comparing `tskit-0.5.4/lib/tskit/haplotype_matching.h` & `tskit-0.5.5/lib/tskit/haplotype_matching.h`

 * *Files identical despite different names*

### Comparing `tskit-0.5.4/lib/tskit/stats.c` & `tskit-0.5.5/lib/tskit/stats.c`

 * *Files identical despite different names*

### Comparing `tskit-0.5.4/lib/tskit/stats.h` & `tskit-0.5.5/lib/tskit/stats.h`

 * *Files identical despite different names*

### Comparing `tskit-0.5.4/lib/tskit/tables.c` & `tskit-0.5.5/lib/tskit/tables.c`

 * *Files 2% similar despite different names*

```diff
@@ -1,11 +1,11 @@
 /*
  * MIT License
  *
- * Copyright (c) 2019-2022 Tskit Developers
+ * Copyright (c) 2019-2023 Tskit Developers
  * Copyright (c) 2017-2018 University of Oxford
  *
  * Permission is hereby granted, free of charge, to any person obtaining a copy
  * of this software and associated documentation files (the "Software"), to deal
  * in the Software without restriction, including without limitation the rights
  * to use, copy, modify, merge, publish, distribute, sublicense, and/or sell
  * copies of the Software, and to permit persons to whom the Software is
@@ -728,14 +728,196 @@
 {
     const char *fmt = "#metadata_schema#\n"
                       "%.*s\n"
                       "#end#metadata_schema\n" TABLE_SEP;
     return fprintf(out, fmt, (int) metadata_schema_length, metadata_schema);
 }
 
+/* Utilities for in-place subsetting columns */
+
+static tsk_size_t
+count_true(tsk_size_t num_rows, const tsk_bool_t *restrict keep)
+{
+    tsk_size_t j;
+    tsk_size_t count = 0;
+
+    for (j = 0; j < num_rows; j++) {
+        if (keep[j]) {
+            count++;
+        }
+    }
+    return count;
+}
+
+static void
+keep_mask_to_id_map(
+    tsk_size_t num_rows, const tsk_bool_t *restrict keep, tsk_id_t *restrict id_map)
+{
+    tsk_size_t j;
+    tsk_id_t next_id = 0;
+
+    for (j = 0; j < num_rows; j++) {
+        id_map[j] = TSK_NULL;
+        if (keep[j]) {
+            id_map[j] = next_id;
+            next_id++;
+        }
+    }
+}
+
+static tsk_size_t
+subset_remap_id_column(tsk_id_t *restrict column, tsk_size_t num_rows,
+    const tsk_bool_t *restrict keep, const tsk_id_t *restrict id_map)
+{
+    tsk_size_t j, k;
+    tsk_id_t value;
+
+    k = 0;
+    for (j = 0; j < num_rows; j++) {
+        if (keep[j]) {
+            value = column[j];
+            if (value != TSK_NULL) {
+                value = id_map[value];
+            }
+            column[k] = value;
+            k++;
+        }
+    }
+    return k;
+}
+
+/* Trigger warning: C++ programmers should look away... This may be one of the
+ * few cases where some macro funkiness is warranted, as these are exact
+ * duplicates of the same function with just the type of the column
+ * parameter changed. */
+
+static tsk_size_t
+subset_id_column(
+    tsk_id_t *restrict column, tsk_size_t num_rows, const tsk_bool_t *restrict keep)
+{
+    tsk_size_t j, k;
+
+    k = 0;
+    for (j = 0; j < num_rows; j++) {
+        if (keep[j]) {
+            column[k] = column[j];
+            k++;
+        }
+    }
+    return k;
+}
+
+static tsk_size_t
+subset_flags_column(
+    tsk_flags_t *restrict column, tsk_size_t num_rows, const tsk_bool_t *restrict keep)
+{
+    tsk_size_t j, k;
+
+    k = 0;
+    for (j = 0; j < num_rows; j++) {
+        if (keep[j]) {
+            column[k] = column[j];
+            k++;
+        }
+    }
+    return k;
+}
+
+static tsk_size_t
+subset_double_column(
+    double *restrict column, tsk_size_t num_rows, const tsk_bool_t *restrict keep)
+{
+    tsk_size_t j, k;
+
+    k = 0;
+    for (j = 0; j < num_rows; j++) {
+        if (keep[j]) {
+            column[k] = column[j];
+            k++;
+        }
+    }
+    return k;
+}
+
+static tsk_size_t
+subset_ragged_char_column(char *restrict data, tsk_size_t *restrict offset_col,
+    tsk_size_t num_rows, const tsk_bool_t *restrict keep)
+{
+    tsk_size_t j, k, i, offset;
+
+    k = 0;
+    offset = 0;
+    for (j = 0; j < num_rows; j++) {
+        if (keep[j]) {
+            offset_col[k] = offset;
+            /* Note: Unclear whether it's worth calling memcpy instead here?
+             * Need to be careful since the regions are overlapping */
+            for (i = offset_col[j]; i < offset_col[j + 1]; i++) {
+                data[offset] = data[i];
+                offset++;
+            }
+            k++;
+        }
+    }
+    offset_col[k] = offset;
+    return offset;
+}
+
+static tsk_size_t
+subset_ragged_double_column(double *restrict data, tsk_size_t *restrict offset_col,
+    tsk_size_t num_rows, const tsk_bool_t *restrict keep)
+{
+    tsk_size_t j, k, i, offset;
+
+    k = 0;
+    offset = 0;
+    for (j = 0; j < num_rows; j++) {
+        if (keep[j]) {
+            offset_col[k] = offset;
+            /* Note: Unclear whether it's worth calling memcpy instead here?
+             * Need to be careful since the regions are overlapping */
+            for (i = offset_col[j]; i < offset_col[j + 1]; i++) {
+                data[offset] = data[i];
+                offset++;
+            }
+            k++;
+        }
+    }
+    offset_col[k] = offset;
+    return offset;
+}
+
+static tsk_size_t
+subset_remap_ragged_id_column(tsk_id_t *restrict data, tsk_size_t *restrict offset_col,
+    tsk_size_t num_rows, const tsk_bool_t *restrict keep,
+    const tsk_id_t *restrict id_map)
+{
+    tsk_size_t j, k, i, offset;
+    tsk_id_t di;
+
+    k = 0;
+    offset = 0;
+    for (j = 0; j < num_rows; j++) {
+        if (keep[j]) {
+            offset_col[k] = offset;
+            for (i = offset_col[j]; i < offset_col[j + 1]; i++) {
+                di = data[i];
+                if (di != TSK_NULL) {
+                    di = id_map[di];
+                }
+                data[offset] = di;
+                offset++;
+            }
+            k++;
+        }
+    }
+    offset_col[k] = offset;
+    return offset;
+}
+
 /*************************
  * reference sequence
  *************************/
 
 int
 tsk_reference_sequence_init(
     tsk_reference_sequence_t *self, tsk_flags_t TSK_UNUSED(options))
@@ -1618,14 +1800,79 @@
               && tsk_memcmp(self->metadata_schema, other->metadata_schema,
                      self->metadata_schema_length * sizeof(char))
                      == 0;
     }
     return ret;
 }
 
+int
+tsk_individual_table_keep_rows(tsk_individual_table_t *self, const tsk_bool_t *keep,
+    tsk_flags_t TSK_UNUSED(options), tsk_id_t *ret_id_map)
+{
+    int ret = 0;
+    const tsk_size_t current_num_rows = self->num_rows;
+    tsk_size_t j, k, remaining_rows;
+    tsk_id_t pk;
+    tsk_id_t *id_map = ret_id_map;
+    tsk_id_t *restrict parents = self->parents;
+    tsk_size_t *restrict parents_offset = self->parents_offset;
+
+    if (ret_id_map == NULL) {
+        id_map = tsk_malloc(current_num_rows * sizeof(*id_map));
+        if (id_map == NULL) {
+            ret = TSK_ERR_NO_MEMORY;
+            goto out;
+        }
+    }
+
+    keep_mask_to_id_map(current_num_rows, keep, id_map);
+
+    /* See notes in tsk_mutation_table_keep_rows for possibilities
+     * on making this more flexible */
+    for (j = 0; j < current_num_rows; j++) {
+        if (keep[j]) {
+            for (k = parents_offset[j]; k < parents_offset[j + 1]; k++) {
+                pk = parents[k];
+                if (pk != TSK_NULL) {
+                    if (pk < 0 || pk >= (tsk_id_t) current_num_rows) {
+                        ret = TSK_ERR_INDIVIDUAL_OUT_OF_BOUNDS;
+                        ;
+                        goto out;
+                    }
+                    if (id_map[pk] == TSK_NULL) {
+                        ret = TSK_ERR_KEEP_ROWS_MAP_TO_DELETED;
+                        goto out;
+                    }
+                }
+            }
+        }
+    }
+
+    remaining_rows = subset_flags_column(self->flags, current_num_rows, keep);
+    self->parents_length = subset_remap_ragged_id_column(
+        self->parents, self->parents_offset, current_num_rows, keep, id_map);
+    self->location_length = subset_ragged_double_column(
+        self->location, self->location_offset, current_num_rows, keep);
+    if (self->metadata_length > 0) {
+        /* Implementation note: we special case metadata here because
+         * it'll make the common-case of no metadata a bit faster, and
+         * to also potentially support more general use of the
+         * TSK_TABLE_NO_METADATA option. This is done for all the tables
+         * but only commented on here. */
+        self->metadata_length = subset_ragged_char_column(
+            self->metadata, self->metadata_offset, current_num_rows, keep);
+    }
+    self->num_rows = remaining_rows;
+out:
+    if (ret_id_map == NULL) {
+        tsk_safe_free(id_map);
+    }
+    return ret;
+}
+
 static int
 tsk_individual_table_dump(
     const tsk_individual_table_t *self, kastore_t *store, tsk_flags_t options)
 {
     const write_table_col_t write_cols[] = {
         { "individuals/flags", (void *) self->flags, self->num_rows,
             TSK_FLAGS_STORAGE_TYPE },
@@ -2267,14 +2514,37 @@
         goto out;
     }
     tsk_node_table_get_row_unsafe(self, index, row);
 out:
     return ret;
 }
 
+int
+tsk_node_table_keep_rows(tsk_node_table_t *self, const tsk_bool_t *keep,
+    tsk_flags_t TSK_UNUSED(options), tsk_id_t *id_map)
+{
+    int ret = 0;
+    tsk_size_t remaining_rows;
+
+    if (id_map != NULL) {
+        keep_mask_to_id_map(self->num_rows, keep, id_map);
+    }
+
+    remaining_rows = subset_flags_column(self->flags, self->num_rows, keep);
+    subset_double_column(self->time, self->num_rows, keep);
+    subset_id_column(self->population, self->num_rows, keep);
+    subset_id_column(self->individual, self->num_rows, keep);
+    if (self->metadata_length > 0) {
+        self->metadata_length = subset_ragged_char_column(
+            self->metadata, self->metadata_offset, self->num_rows, keep);
+    }
+    self->num_rows = remaining_rows;
+    return ret;
+}
+
 static int
 tsk_node_table_dump(const tsk_node_table_t *self, kastore_t *store, tsk_flags_t options)
 {
     const write_table_col_t cols[] = {
         { "nodes/time", (void *) self->time, self->num_rows, KAS_FLOAT64 },
         { "nodes/flags", (void *) self->flags, self->num_rows, TSK_FLAGS_STORAGE_TYPE },
         { "nodes/population", (void *) self->population, self->num_rows,
@@ -2936,14 +3206,37 @@
             }
         }
         ret = ret && metadata_equal;
     }
     return ret;
 }
 
+int
+tsk_edge_table_keep_rows(tsk_edge_table_t *self, const tsk_bool_t *keep,
+    tsk_flags_t TSK_UNUSED(options), tsk_id_t *id_map)
+{
+    int ret = 0;
+    tsk_size_t remaining_rows;
+
+    if (id_map != NULL) {
+        keep_mask_to_id_map(self->num_rows, keep, id_map);
+    }
+    remaining_rows = subset_double_column(self->left, self->num_rows, keep);
+    subset_double_column(self->right, self->num_rows, keep);
+    subset_id_column(self->parent, self->num_rows, keep);
+    subset_id_column(self->child, self->num_rows, keep);
+    if (self->metadata_length > 0) {
+        tsk_bug_assert(!(self->options & TSK_TABLE_NO_METADATA));
+        self->metadata_length = subset_ragged_char_column(
+            self->metadata, self->metadata_offset, self->num_rows, keep);
+    }
+    self->num_rows = remaining_rows;
+    return ret;
+}
+
 static int
 tsk_edge_table_dump(const tsk_edge_table_t *self, kastore_t *store, tsk_flags_t options)
 {
     int ret = 0;
     const write_table_col_t write_cols[] = {
         { "edges/left", (void *) self->left, self->num_rows, KAS_FLOAT64 },
         { "edges/right", (void *) self->right, self->num_rows, KAS_FLOAT64 },
@@ -3671,14 +3964,36 @@
         }
     }
     ret = 0;
 out:
     return ret;
 }
 
+int
+tsk_site_table_keep_rows(tsk_site_table_t *self, const tsk_bool_t *keep,
+    tsk_flags_t TSK_UNUSED(options), tsk_id_t *id_map)
+{
+    int ret = 0;
+    tsk_size_t remaining_rows;
+
+    if (id_map != NULL) {
+        keep_mask_to_id_map(self->num_rows, keep, id_map);
+    }
+
+    remaining_rows = subset_double_column(self->position, self->num_rows, keep);
+    self->ancestral_state_length = subset_ragged_char_column(
+        self->ancestral_state, self->ancestral_state_offset, self->num_rows, keep);
+    if (self->metadata_length > 0) {
+        self->metadata_length = subset_ragged_char_column(
+            self->metadata, self->metadata_offset, self->num_rows, keep);
+    }
+    self->num_rows = remaining_rows;
+    return ret;
+}
+
 static int
 tsk_site_table_dump(const tsk_site_table_t *self, kastore_t *store, tsk_flags_t options)
 {
     const write_table_col_t cols[] = {
         { "sites/position", (void *) self->position, self->num_rows, KAS_FLOAT64 },
         { "sites/metadata_schema", (void *) self->metadata_schema,
             self->metadata_schema_length, KAS_UINT8 },
@@ -4414,14 +4729,73 @@
         }
     }
     ret = 0;
 out:
     return ret;
 }
 
+int
+tsk_mutation_table_keep_rows(tsk_mutation_table_t *self, const tsk_bool_t *keep,
+    tsk_flags_t TSK_UNUSED(options), tsk_id_t *ret_id_map)
+{
+    int ret = 0;
+    const tsk_size_t current_num_rows = self->num_rows;
+    tsk_size_t j, remaining_rows;
+    tsk_id_t pj;
+    tsk_id_t *id_map = ret_id_map;
+    tsk_id_t *restrict parent = self->parent;
+
+    if (ret_id_map == NULL) {
+        id_map = tsk_malloc(current_num_rows * sizeof(*id_map));
+        if (id_map == NULL) {
+            ret = TSK_ERR_NO_MEMORY;
+            goto out;
+        }
+    }
+
+    keep_mask_to_id_map(current_num_rows, keep, id_map);
+
+    /* Note: we could add some options to avoid these checks if we wanted.
+     * MAP_DELETED_TO_NULL is an obvious one, and I guess it might be
+     * helpful to also provide NO_REMAP to prevent reference remapping
+     * entirely. */
+    for (j = 0; j < current_num_rows; j++) {
+        if (keep[j]) {
+            pj = parent[j];
+            if (pj != TSK_NULL) {
+                if (pj < 0 || pj >= (tsk_id_t) current_num_rows) {
+                    ret = TSK_ERR_MUTATION_OUT_OF_BOUNDS;
+                    goto out;
+                }
+                if (id_map[pj] == TSK_NULL) {
+                    ret = TSK_ERR_KEEP_ROWS_MAP_TO_DELETED;
+                    goto out;
+                }
+            }
+        }
+    }
+
+    remaining_rows = subset_id_column(self->site, current_num_rows, keep);
+    subset_id_column(self->node, current_num_rows, keep);
+    subset_remap_id_column(parent, current_num_rows, keep, id_map);
+    subset_double_column(self->time, current_num_rows, keep);
+    self->derived_state_length = subset_ragged_char_column(
+        self->derived_state, self->derived_state_offset, current_num_rows, keep);
+    if (self->metadata_length > 0) {
+        self->metadata_length = subset_ragged_char_column(
+            self->metadata, self->metadata_offset, current_num_rows, keep);
+    }
+    self->num_rows = remaining_rows;
+out:
+    if (ret_id_map == NULL) {
+        tsk_safe_free(id_map);
+    }
+    return ret;
+}
+
 static int
 tsk_mutation_table_dump(
     const tsk_mutation_table_t *self, kastore_t *store, tsk_flags_t options)
 {
     const write_table_col_t cols[] = {
         { "mutations/site", (void *) self->site, self->num_rows, TSK_ID_STORAGE_TYPE },
         { "mutations/node", (void *) self->node, self->num_rows, TSK_ID_STORAGE_TYPE },
@@ -5059,14 +5433,39 @@
               && tsk_memcmp(self->metadata_schema, other->metadata_schema,
                      self->metadata_schema_length * sizeof(char))
                      == 0;
     }
     return ret;
 }
 
+int
+tsk_migration_table_keep_rows(tsk_migration_table_t *self, const tsk_bool_t *keep,
+    tsk_flags_t TSK_UNUSED(options), tsk_id_t *id_map)
+{
+    int ret = 0;
+    tsk_size_t remaining_rows;
+
+    if (id_map != NULL) {
+        keep_mask_to_id_map(self->num_rows, keep, id_map);
+    }
+
+    remaining_rows = subset_double_column(self->left, self->num_rows, keep);
+    subset_double_column(self->right, self->num_rows, keep);
+    subset_id_column(self->node, self->num_rows, keep);
+    subset_id_column(self->source, self->num_rows, keep);
+    subset_id_column(self->dest, self->num_rows, keep);
+    subset_double_column(self->time, self->num_rows, keep);
+    if (self->metadata_length > 0) {
+        self->metadata_length = subset_ragged_char_column(
+            self->metadata, self->metadata_offset, self->num_rows, keep);
+    }
+    self->num_rows = remaining_rows;
+    return ret;
+}
+
 static int
 tsk_migration_table_dump(
     const tsk_migration_table_t *self, kastore_t *store, tsk_flags_t options)
 {
     const write_table_col_t cols[] = {
         { "migrations/left", (void *) self->left, self->num_rows, KAS_FLOAT64 },
         { "migrations/right", (void *) self->right, self->num_rows, KAS_FLOAT64 },
@@ -5628,14 +6027,32 @@
               && tsk_memcmp(self->metadata_schema, other->metadata_schema,
                      self->metadata_schema_length * sizeof(char))
                      == 0;
     }
     return ret;
 }
 
+int
+tsk_population_table_keep_rows(tsk_population_table_t *self, const tsk_bool_t *keep,
+    tsk_flags_t TSK_UNUSED(options), tsk_id_t *id_map)
+{
+    int ret = 0;
+
+    if (id_map != NULL) {
+        keep_mask_to_id_map(self->num_rows, keep, id_map);
+    }
+
+    if (self->metadata_length > 0) {
+        self->metadata_length = subset_ragged_char_column(
+            self->metadata, self->metadata_offset, self->num_rows, keep);
+    }
+    self->num_rows = count_true(self->num_rows, keep);
+    return ret;
+}
+
 static int
 tsk_population_table_dump(
     const tsk_population_table_t *self, kastore_t *store, tsk_flags_t options)
 {
     const write_table_col_t cols[] = {
         { "populations/metadata_schema", (void *) self->metadata_schema,
             self->metadata_schema_length, KAS_UINT8 },
@@ -6240,14 +6657,32 @@
               && tsk_memcmp(self->timestamp, other->timestamp,
                      self->timestamp_length * sizeof(char))
                      == 0;
     }
     return ret;
 }
 
+int
+tsk_provenance_table_keep_rows(tsk_provenance_table_t *self, const tsk_bool_t *keep,
+    tsk_flags_t TSK_UNUSED(options), tsk_id_t *id_map)
+{
+    int ret = 0;
+
+    if (id_map != NULL) {
+        keep_mask_to_id_map(self->num_rows, keep, id_map);
+    }
+    self->timestamp_length = subset_ragged_char_column(
+        self->timestamp, self->timestamp_offset, self->num_rows, keep);
+    self->record_length = subset_ragged_char_column(
+        self->record, self->record_offset, self->num_rows, keep);
+    self->num_rows = count_true(self->num_rows, keep);
+
+    return ret;
+}
+
 static int
 tsk_provenance_table_dump(
     const tsk_provenance_table_t *self, kastore_t *store, tsk_flags_t options)
 {
     write_table_ragged_col_t ragged_cols[] = {
         { "provenances/timestamp", (void *) self->timestamp, self->timestamp_length,
             KAS_UINT8, self->timestamp_offset, self->num_rows },
@@ -13006,7 +13441,169 @@
     edges[l].child = edges[j].child;
 
     *num_output_edges = (tsk_size_t) l + 1;
 
 out:
     return ret;
 }
+
+/* ======================================================== *
+ * Tree diff iterator.
+ * ======================================================== */
+
+int TSK_WARN_UNUSED
+tsk_diff_iter_init(tsk_diff_iter_t *self, const tsk_table_collection_t *tables,
+    tsk_id_t num_trees, tsk_flags_t options)
+{
+    int ret = 0;
+
+    tsk_bug_assert(tables != NULL);
+    tsk_memset(self, 0, sizeof(tsk_diff_iter_t));
+    self->num_nodes = tables->nodes.num_rows;
+    self->num_edges = tables->edges.num_rows;
+    self->tables = tables;
+    self->insertion_index = 0;
+    self->removal_index = 0;
+    self->tree_left = 0;
+    self->tree_index = -1;
+    if (num_trees < 0) {
+        num_trees = tsk_table_collection_check_integrity(self->tables, TSK_CHECK_TREES);
+        if (num_trees < 0) {
+            ret = (int) num_trees;
+            goto out;
+        }
+    }
+    self->last_index = num_trees;
+
+    if (options & TSK_INCLUDE_TERMINAL) {
+        self->last_index = self->last_index + 1;
+    }
+    self->edge_list_nodes = tsk_malloc(self->num_edges * sizeof(*self->edge_list_nodes));
+    if (self->edge_list_nodes == NULL) {
+        ret = TSK_ERR_NO_MEMORY;
+        goto out;
+    }
+out:
+    return ret;
+}
+
+int
+tsk_diff_iter_free(tsk_diff_iter_t *self)
+{
+    tsk_safe_free(self->edge_list_nodes);
+    return 0;
+}
+
+void
+tsk_diff_iter_print_state(const tsk_diff_iter_t *self, FILE *out)
+{
+    fprintf(out, "tree_diff_iterator state\n");
+    fprintf(out, "num_edges = %lld\n", (long long) self->num_edges);
+    fprintf(out, "insertion_index = %lld\n", (long long) self->insertion_index);
+    fprintf(out, "removal_index = %lld\n", (long long) self->removal_index);
+    fprintf(out, "tree_left = %f\n", self->tree_left);
+    fprintf(out, "tree_index = %lld\n", (long long) self->tree_index);
+}
+
+int TSK_WARN_UNUSED
+tsk_diff_iter_next(tsk_diff_iter_t *self, double *ret_left, double *ret_right,
+    tsk_edge_list_t *edges_out_ret, tsk_edge_list_t *edges_in_ret)
+{
+    int ret = 0;
+    tsk_id_t k;
+    const double sequence_length = self->tables->sequence_length;
+    double left = self->tree_left;
+    double right = sequence_length;
+    tsk_size_t next_edge_list_node = 0;
+    tsk_edge_list_node_t *out_head = NULL;
+    tsk_edge_list_node_t *out_tail = NULL;
+    tsk_edge_list_node_t *in_head = NULL;
+    tsk_edge_list_node_t *in_tail = NULL;
+    tsk_edge_list_node_t *w = NULL;
+    tsk_edge_list_t edges_out;
+    tsk_edge_list_t edges_in;
+    const tsk_edge_table_t *edges = &self->tables->edges;
+    const tsk_id_t *insertion_order = self->tables->indexes.edge_insertion_order;
+    const tsk_id_t *removal_order = self->tables->indexes.edge_removal_order;
+
+    tsk_memset(&edges_out, 0, sizeof(edges_out));
+    tsk_memset(&edges_in, 0, sizeof(edges_in));
+
+    if (self->tree_index + 1 < self->last_index) {
+        /* First we remove the stale records */
+        while (self->removal_index < (tsk_id_t) self->num_edges
+               && left == edges->right[removal_order[self->removal_index]]) {
+            k = removal_order[self->removal_index];
+            tsk_bug_assert(next_edge_list_node < self->num_edges);
+            w = &self->edge_list_nodes[next_edge_list_node];
+            next_edge_list_node++;
+            w->edge.id = k;
+            w->edge.left = edges->left[k];
+            w->edge.right = edges->right[k];
+            w->edge.parent = edges->parent[k];
+            w->edge.child = edges->child[k];
+            w->edge.metadata = edges->metadata + edges->metadata_offset[k];
+            w->edge.metadata_length
+                = edges->metadata_offset[k + 1] - edges->metadata_offset[k];
+            w->next = NULL;
+            w->prev = NULL;
+            if (out_head == NULL) {
+                out_head = w;
+                out_tail = w;
+            } else {
+                out_tail->next = w;
+                w->prev = out_tail;
+                out_tail = w;
+            }
+            self->removal_index++;
+        }
+        edges_out.head = out_head;
+        edges_out.tail = out_tail;
+
+        /* Now insert the new records */
+        while (self->insertion_index < (tsk_id_t) self->num_edges
+               && left == edges->left[insertion_order[self->insertion_index]]) {
+            k = insertion_order[self->insertion_index];
+            tsk_bug_assert(next_edge_list_node < self->num_edges);
+            w = &self->edge_list_nodes[next_edge_list_node];
+            next_edge_list_node++;
+            w->edge.id = k;
+            w->edge.left = edges->left[k];
+            w->edge.right = edges->right[k];
+            w->edge.parent = edges->parent[k];
+            w->edge.child = edges->child[k];
+            w->edge.metadata = edges->metadata + edges->metadata_offset[k];
+            w->edge.metadata_length
+                = edges->metadata_offset[k + 1] - edges->metadata_offset[k];
+            w->next = NULL;
+            w->prev = NULL;
+            if (in_head == NULL) {
+                in_head = w;
+                in_tail = w;
+            } else {
+                in_tail->next = w;
+                w->prev = in_tail;
+                in_tail = w;
+            }
+            self->insertion_index++;
+        }
+        edges_in.head = in_head;
+        edges_in.tail = in_tail;
+
+        right = sequence_length;
+        if (self->insertion_index < (tsk_id_t) self->num_edges) {
+            right = TSK_MIN(right, edges->left[insertion_order[self->insertion_index]]);
+        }
+        if (self->removal_index < (tsk_id_t) self->num_edges) {
+            right = TSK_MIN(right, edges->right[removal_order[self->removal_index]]);
+        }
+        self->tree_index++;
+        ret = TSK_TREE_OK;
+    }
+    *edges_out_ret = edges_out;
+    *edges_in_ret = edges_in;
+    *ret_left = left;
+    *ret_right = right;
+    /* Set the left coordinate for the next tree */
+    self->tree_left = right;
+    return ret;
+}
```

### Comparing `tskit-0.5.4/lib/tskit/tables.h` & `tskit-0.5.5/lib/tskit/tables.h`

 * *Files 7% similar despite different names*

```diff
@@ -666,14 +666,38 @@
     tsk_size_t num_segments;
     double total_span;
     tsk_blkalloc_t heap;
     bool store_segments;
     bool store_pairs;
 } tsk_identity_segments_t;
 
+/* Diff iterator. */
+typedef struct _tsk_edge_list_node_t {
+    tsk_edge_t edge;
+    struct _tsk_edge_list_node_t *next;
+    struct _tsk_edge_list_node_t *prev;
+} tsk_edge_list_node_t;
+
+typedef struct {
+    tsk_edge_list_node_t *head;
+    tsk_edge_list_node_t *tail;
+} tsk_edge_list_t;
+
+typedef struct {
+    tsk_size_t num_nodes;
+    tsk_size_t num_edges;
+    double tree_left;
+    const tsk_table_collection_t *tables;
+    tsk_id_t insertion_index;
+    tsk_id_t removal_index;
+    tsk_id_t tree_index;
+    tsk_id_t last_index;
+    tsk_edge_list_node_t *edge_list_nodes;
+} tsk_diff_iter_t;
+
 /****************************************************************************/
 /* Common function options */
 /****************************************************************************/
 
 /**
 @defgroup API_FLAGS_SIMPLIFY_GROUP :c:func:`tsk_table_collection_simplify` and
 :c:func:`tsk_treeseq_simplify` specific flags.
@@ -888,14 +912,24 @@
 #define TSK_CLEAR_METADATA_SCHEMAS (1 << 0)
 /** Additionally clear the tree-sequence metadata and schema*/
 #define TSK_CLEAR_TS_METADATA_AND_SCHEMA (1 << 1)
 /** Additionally clear the provenance table*/
 #define TSK_CLEAR_PROVENANCE (1 << 2)
 /** @} */
 
+/* For the edge diff iterator */
+#define TSK_INCLUDE_TERMINAL (1 << 0)
+
+/** @brief Value returned by seeking methods when they have successfully
+    seeked to a non-null tree.
+
+    @ingroup TREE_API_SEEKING_GROUP
+*/
+#define TSK_TREE_OK 1
+
 /****************************************************************************/
 /* Function signatures */
 /****************************************************************************/
 
 /**
 @defgroup INDIVIDUAL_TABLE_API_GROUP Individual table API.
 @{
@@ -1040,14 +1074,63 @@
 @return Return 0 on success or a negative value on failure.
 */
 int tsk_individual_table_extend(tsk_individual_table_t *self,
     const tsk_individual_table_t *other, tsk_size_t num_rows,
     const tsk_id_t *row_indexes, tsk_flags_t options);
 
 /**
+@brief Subset this table by keeping rows according to a boolean mask.
+
+@rst
+Deletes rows from this table and optionally return the mapping from IDs in
+the current table to the updated table. Rows are kept or deleted according to
+the specified boolean array ``keep`` such that for each row ``j`` if
+``keep[j]`` is false (zero) the row is deleted, and otherwise the row is
+retained. Thus, ``keep`` must be an array of at least ``num_rows``
+:c:type:`bool` values.
+
+If the ``id_map`` argument is non-null, this array will be updated to represent
+the mapping between IDs before and after row deletion. For row ``j``,
+``id_map[j]`` will contain the new ID for row ``j`` if it is retained, or
+:c:macro:`TSK_NULL` if the row has been removed. Thus, ``id_map`` must be an
+array of at least ``num_rows`` :c:type:`tsk_id_t` values.
+
+The values in the ``parents`` column are updated according to this map, so that
+reference integrity within the table is maintained. As a consequence of this,
+the values in the ``parents`` column for kept rows are bounds-checked and an
+error raised if they are not valid. Rows that are deleted are not checked for
+parent ID integrity.
+
+If an attempt is made to delete rows that are referred to by the ``parents``
+column of rows that are retained, an error is raised.
+
+These error conditions are checked before any alterations to the table are
+made.
+
+.. warning::
+    C++ users need to be careful to specify the correct type when
+    passing in values for the ``keep`` array,
+    using ``std::vector<tsk_bool_t>`` and not ``std::vector<bool>``,
+    as the latter may not be correct size.
+
+@endrst
+
+@param self A pointer to a tsk_individual_table_t object.
+@param keep Array of boolean flags describing whether a particular
+    row should be kept or not. Must be at least ``num_rows`` long.
+@param options Bitwise option flags. Currently unused; should be
+    set to zero to ensure compatibility with later versions of tskit.
+@param id_map An array in which to store the mapping between new
+    and old IDs. If NULL, this will be ignored.
+@return Return 0 on success or a negative value on failure.
+*/
+int tsk_individual_table_keep_rows(tsk_individual_table_t *self, const tsk_bool_t *keep,
+    tsk_flags_t options, tsk_id_t *id_map);
+
+/**
 @brief Returns true if the data in the specified table is identical to the data
        in this table.
 
 @rst
 
 **Options**
 
@@ -1388,14 +1471,51 @@
     set to zero to ensure compatibility with later versions of tskit.
 @return Return 0 on success or a negative value on failure.
 */
 int tsk_node_table_extend(tsk_node_table_t *self, const tsk_node_table_t *other,
     tsk_size_t num_rows, const tsk_id_t *row_indexes, tsk_flags_t options);
 
 /**
+@brief Subset this table by keeping rows according to a boolean mask.
+
+@rst
+Deletes rows from this table and optionally return the mapping from IDs in
+the current table to the updated table. Rows are kept or deleted according to
+the specified boolean array ``keep`` such that for each row ``j`` if
+``keep[j]`` is false (zero) the row is deleted, and otherwise the row is
+retained. Thus, ``keep`` must be an array of at least ``num_rows``
+:c:type:`bool` values.
+
+If the ``id_map`` argument is non-null, this array will be updated to represent
+the mapping between IDs before and after row deletion. For row ``j``,
+``id_map[j]`` will contain the new ID for row ``j`` if it is retained, or
+:c:macro:`TSK_NULL` if the row has been removed. Thus, ``id_map`` must be an
+array of at least ``num_rows`` :c:type:`tsk_id_t` values.
+
+.. warning::
+    C++ users need to be careful to specify the correct type when
+    passing in values for the ``keep`` array,
+    using ``std::vector<tsk_bool_t>`` and not ``std::vector<bool>``,
+    as the latter may not be correct size.
+
+@endrst
+
+@param self A pointer to a tsk_node_table_t object.
+@param keep Array of boolean flags describing whether a particular
+    row should be kept or not. Must be at least ``num_rows`` long.
+@param options Bitwise option flags. Currently unused; should be
+    set to zero to ensure compatibility with later versions of tskit.
+@param id_map An array in which to store the mapping between new
+    and old IDs. If NULL, this will be ignored.
+@return Return 0 on success or a negative value on failure.
+*/
+int tsk_node_table_keep_rows(tsk_node_table_t *self, const tsk_bool_t *keep,
+    tsk_flags_t options, tsk_id_t *id_map);
+
+/**
 @brief Returns true if the data in the specified table is identical to the data
        in this table.
 
 @rst
 
 **Options**
 
@@ -1698,14 +1818,51 @@
     set to zero to ensure compatibility with later versions of tskit.
 @return Return 0 on success or a negative value on failure.
 */
 int tsk_edge_table_extend(tsk_edge_table_t *self, const tsk_edge_table_t *other,
     tsk_size_t num_rows, const tsk_id_t *row_indexes, tsk_flags_t options);
 
 /**
+@brief Subset this table by keeping rows according to a boolean mask.
+
+@rst
+Deletes rows from this table and optionally return the mapping from IDs in
+the current table to the updated table. Rows are kept or deleted according to
+the specified boolean array ``keep`` such that for each row ``j`` if
+``keep[j]`` is false (zero) the row is deleted, and otherwise the row is
+retained. Thus, ``keep`` must be an array of at least ``num_rows``
+:c:type:`bool` values.
+
+If the ``id_map`` argument is non-null, this array will be updated to represent
+the mapping between IDs before and after row deletion. For row ``j``,
+``id_map[j]`` will contain the new ID for row ``j`` if it is retained, or
+:c:macro:`TSK_NULL` if the row has been removed. Thus, ``id_map`` must be an
+array of at least ``num_rows`` :c:type:`tsk_id_t` values.
+
+.. warning::
+    C++ users need to be careful to specify the correct type when
+    passing in values for the ``keep`` array,
+    using ``std::vector<tsk_bool_t>`` and not ``std::vector<bool>``,
+    as the latter may not be correct size.
+
+@endrst
+
+@param self A pointer to a tsk_edge_table_t object.
+@param keep Array of boolean flags describing whether a particular
+    row should be kept or not. Must be at least ``num_rows`` long.
+@param options Bitwise option flags. Currently unused; should be
+    set to zero to ensure compatibility with later versions of tskit.
+@param id_map An array in which to store the mapping between new
+    and old IDs. If NULL, this will be ignored.
+@return Return 0 on success or a negative value on failure.
+*/
+int tsk_edge_table_keep_rows(tsk_edge_table_t *self, const tsk_bool_t *keep,
+    tsk_flags_t options, tsk_id_t *id_map);
+
+/**
 @brief Returns true if the data in the specified table is identical to the data
        in this table.
 
 @rst
 
 **Options**
 
@@ -2032,14 +2189,51 @@
 */
 
 int tsk_migration_table_extend(tsk_migration_table_t *self,
     const tsk_migration_table_t *other, tsk_size_t num_rows, const tsk_id_t *row_indexes,
     tsk_flags_t options);
 
 /**
+@brief Subset this table by keeping rows according to a boolean mask.
+
+@rst
+Deletes rows from this table and optionally return the mapping from IDs in
+the current table to the updated table. Rows are kept or deleted according to
+the specified boolean array ``keep`` such that for each row ``j`` if
+``keep[j]`` is false (zero) the row is deleted, and otherwise the row is
+retained. Thus, ``keep`` must be an array of at least ``num_rows``
+:c:type:`bool` values.
+
+If the ``id_map`` argument is non-null, this array will be updated to represent
+the mapping between IDs before and after row deletion. For row ``j``,
+``id_map[j]`` will contain the new ID for row ``j`` if it is retained, or
+:c:macro:`TSK_NULL` if the row has been removed. Thus, ``id_map`` must be an
+array of at least ``num_rows`` :c:type:`tsk_id_t` values.
+
+.. warning::
+    C++ users need to be careful to specify the correct type when
+    passing in values for the ``keep`` array,
+    using ``std::vector<tsk_bool_t>`` and not ``std::vector<bool>``,
+    as the latter may not be correct size.
+
+@endrst
+
+@param self A pointer to a tsk_migration_table_t object.
+@param keep Array of boolean flags describing whether a particular
+    row should be kept or not. Must be at least ``num_rows`` long.
+@param options Bitwise option flags. Currently unused; should be
+    set to zero to ensure compatibility with later versions of tskit.
+@param id_map An array in which to store the mapping between new
+    and old IDs. If NULL, this will be ignored.
+@return Return 0 on success or a negative value on failure.
+*/
+int tsk_migration_table_keep_rows(tsk_migration_table_t *self, const tsk_bool_t *keep,
+    tsk_flags_t options, tsk_id_t *id_map);
+
+/**
 @brief Returns true if the data in the specified table is identical to the data
        in this table.
 
 @rst
 
 **Options**
 
@@ -2340,14 +2534,51 @@
     set to zero to ensure compatibility with later versions of tskit.
 @return Return 0 on success or a negative value on failure.
 */
 int tsk_site_table_extend(tsk_site_table_t *self, const tsk_site_table_t *other,
     tsk_size_t num_rows, const tsk_id_t *row_indexes, tsk_flags_t options);
 
 /**
+@brief Subset this table by keeping rows according to a boolean mask.
+
+@rst
+Deletes rows from this table and optionally return the mapping from IDs in
+the current table to the updated table. Rows are kept or deleted according to
+the specified boolean array ``keep`` such that for each row ``j`` if
+``keep[j]`` is false (zero) the row is deleted, and otherwise the row is
+retained. Thus, ``keep`` must be an array of at least ``num_rows``
+:c:type:`bool` values.
+
+If the ``id_map`` argument is non-null, this array will be updated to represent
+the mapping between IDs before and after row deletion. For row ``j``,
+``id_map[j]`` will contain the new ID for row ``j`` if it is retained, or
+:c:macro:`TSK_NULL` if the row has been removed. Thus, ``id_map`` must be an
+array of at least ``num_rows`` :c:type:`tsk_id_t` values.
+
+.. warning::
+    C++ users need to be careful to specify the correct type when
+    passing in values for the ``keep`` array,
+    using ``std::vector<tsk_bool_t>`` and not ``std::vector<bool>``,
+    as the latter may not be correct size.
+
+@endrst
+
+@param self A pointer to a tsk_site_table_t object.
+@param keep Array of boolean flags describing whether a particular
+    row should be kept or not. Must be at least ``num_rows`` long.
+@param options Bitwise option flags. Currently unused; should be
+    set to zero to ensure compatibility with later versions of tskit.
+@param id_map An array in which to store the mapping between new
+    and old IDs. If NULL, this will be ignored.
+@return Return 0 on success or a negative value on failure.
+*/
+int tsk_site_table_keep_rows(tsk_site_table_t *self, const tsk_bool_t *keep,
+    tsk_flags_t options, tsk_id_t *id_map);
+
+/**
 @brief Returns true if the data in the specified table is identical to the data
        in this table.
 
 @rst
 
 **Options**
 
@@ -2676,14 +2907,63 @@
 @return Return 0 on success or a negative value on failure.
 */
 int tsk_mutation_table_extend(tsk_mutation_table_t *self,
     const tsk_mutation_table_t *other, tsk_size_t num_rows, const tsk_id_t *row_indexes,
     tsk_flags_t options);
 
 /**
+@brief Subset this table by keeping rows according to a boolean mask.
+
+@rst
+Deletes rows from this table and optionally return the mapping from IDs in
+the current table to the updated table. Rows are kept or deleted according to
+the specified boolean array ``keep`` such that for each row ``j`` if
+``keep[j]`` is false (zero) the row is deleted, and otherwise the row is
+retained. Thus, ``keep`` must be an array of at least ``num_rows``
+:c:type:`bool` values.
+
+If the ``id_map`` argument is non-null, this array will be updated to represent
+the mapping between IDs before and after row deletion. For row ``j``,
+``id_map[j]`` will contain the new ID for row ``j`` if it is retained, or
+:c:macro:`TSK_NULL` if the row has been removed. Thus, ``id_map`` must be an
+array of at least ``num_rows`` :c:type:`tsk_id_t` values.
+
+The values in the ``parent`` column are updated according to this map, so that
+reference integrity within the table is maintained. As a consequence of this,
+the values in the ``parent`` column for kept rows are bounds-checked and an
+error raised if they are not valid. Rows that are deleted are not checked for
+parent ID integrity.
+
+If an attempt is made to delete rows that are referred to by the ``parent``
+column of rows that are retained, an error is raised.
+
+These error conditions are checked before any alterations to the table are
+made.
+
+.. warning::
+    C++ users need to be careful to specify the correct type when
+    passing in values for the ``keep`` array,
+    using ``std::vector<tsk_bool_t>`` and not ``std::vector<bool>``,
+    as the latter may not be correct size.
+
+@endrst
+
+@param self A pointer to a tsk_mutation_table_t object.
+@param keep Array of boolean flags describing whether a particular
+    row should be kept or not. Must be at least ``num_rows`` long.
+@param options Bitwise option flags. Currently unused; should be
+    set to zero to ensure compatibility with later versions of tskit.
+@param id_map An array in which to store the mapping between new
+    and old IDs. If NULL, this will be ignored.
+@return Return 0 on success or a negative value on failure.
+*/
+int tsk_mutation_table_keep_rows(tsk_mutation_table_t *self, const tsk_bool_t *keep,
+    tsk_flags_t options, tsk_id_t *id_map);
+
+/**
 @brief Returns true if the data in the specified table is identical to the data
        in this table.
 
 @rst
 
 **Options**
 
@@ -3003,14 +3283,51 @@
 @return Return 0 on success or a negative value on failure.
 */
 int tsk_population_table_extend(tsk_population_table_t *self,
     const tsk_population_table_t *other, tsk_size_t num_rows,
     const tsk_id_t *row_indexes, tsk_flags_t options);
 
 /**
+@brief Subset this table by keeping rows according to a boolean mask.
+
+@rst
+Deletes rows from this table and optionally return the mapping from IDs in
+the current table to the updated table. Rows are kept or deleted according to
+the specified boolean array ``keep`` such that for each row ``j`` if
+``keep[j]`` is false (zero) the row is deleted, and otherwise the row is
+retained. Thus, ``keep`` must be an array of at least ``num_rows``
+:c:type:`bool` values.
+
+If the ``id_map`` argument is non-null, this array will be updated to represent
+the mapping between IDs before and after row deletion. For row ``j``,
+``id_map[j]`` will contain the new ID for row ``j`` if it is retained, or
+:c:macro:`TSK_NULL` if the row has been removed. Thus, ``id_map`` must be an
+array of at least ``num_rows`` :c:type:`tsk_id_t` values.
+
+.. warning::
+    C++ users need to be careful to specify the correct type when
+    passing in values for the ``keep`` array,
+    using ``std::vector<tsk_bool_t>`` and not ``std::vector<bool>``,
+    as the latter may not be correct size.
+
+@endrst
+
+@param self A pointer to a tsk_population_table_t object.
+@param keep Array of boolean flags describing whether a particular
+    row should be kept or not. Must be at least ``num_rows`` long.
+@param options Bitwise option flags. Currently unused; should be
+    set to zero to ensure compatibility with later versions of tskit.
+@param id_map An array in which to store the mapping between new
+    and old IDs. If NULL, this will be ignored.
+@return Return 0 on success or a negative value on failure.
+*/
+int tsk_population_table_keep_rows(tsk_population_table_t *self, const tsk_bool_t *keep,
+    tsk_flags_t options, tsk_id_t *id_map);
+
+/**
 @brief Returns true if the data in the specified table is identical to the data
        in this table.
 
 @rst
 
 **Options**
 
@@ -3297,14 +3614,51 @@
 @return Return 0 on success or a negative value on failure.
 */
 int tsk_provenance_table_extend(tsk_provenance_table_t *self,
     const tsk_provenance_table_t *other, tsk_size_t num_rows,
     const tsk_id_t *row_indexes, tsk_flags_t options);
 
 /**
+@brief Subset this table by keeping rows according to a boolean mask.
+
+@rst
+Deletes rows from this table and optionally return the mapping from IDs in
+the current table to the updated table. Rows are kept or deleted according to
+the specified boolean array ``keep`` such that for each row ``j`` if
+``keep[j]`` is false (zero) the row is deleted, and otherwise the row is
+retained. Thus, ``keep`` must be an array of at least ``num_rows``
+:c:type:`bool` values.
+
+If the ``id_map`` argument is non-null, this array will be updated to represent
+the mapping between IDs before and after row deletion. For row ``j``,
+``id_map[j]`` will contain the new ID for row ``j`` if it is retained, or
+:c:macro:`TSK_NULL` if the row has been removed. Thus, ``id_map`` must be an
+array of at least ``num_rows`` :c:type:`tsk_id_t` values.
+
+.. warning::
+    C++ users need to be careful to specify the correct type when
+    passing in values for the ``keep`` array,
+    using ``std::vector<tsk_bool_t>`` and not ``std::vector<bool>``,
+    as the latter may not be correct size.
+
+@endrst
+
+@param self A pointer to a tsk_provenance_table_t object.
+@param keep Array of boolean flags describing whether a particular
+    row should be kept or not. Must be at least ``num_rows`` long.
+@param options Bitwise option flags. Currently unused; should be
+    set to zero to ensure compatibility with later versions of tskit.
+@param id_map An array in which to store the mapping between new
+    and old IDs. If NULL, this will be ignored.
+@return Return 0 on success or a negative value on failure.
+*/
+int tsk_provenance_table_keep_rows(tsk_provenance_table_t *self, const tsk_bool_t *keep,
+    tsk_flags_t options, tsk_id_t *id_map);
+
+/**
 @brief Returns true if the data in the specified table is identical to the data
        in this table.
 
 @rst
 
 **Options**
 
@@ -4413,11 +4767,24 @@
 int tsk_identity_segments_get_items(const tsk_identity_segments_t *self, tsk_id_t *pairs,
     tsk_identity_segment_list_t **lists);
 int tsk_identity_segments_get(const tsk_identity_segments_t *self, tsk_id_t a,
     tsk_id_t b, tsk_identity_segment_list_t **ret_list);
 void tsk_identity_segments_print_state(tsk_identity_segments_t *self, FILE *out);
 int tsk_identity_segments_free(tsk_identity_segments_t *self);
 
+/* Edge differences */
+
+/* Internal API - currently used in a few places, but a better API is envisaged
+ * at some point.
+ * IMPORTANT: tskit-rust uses this API, so don't break without discussing!
+ */
+int tsk_diff_iter_init(tsk_diff_iter_t *self, const tsk_table_collection_t *tables,
+    tsk_id_t num_trees, tsk_flags_t options);
+int tsk_diff_iter_free(tsk_diff_iter_t *self);
+int tsk_diff_iter_next(tsk_diff_iter_t *self, double *left, double *right,
+    tsk_edge_list_t *edges_out, tsk_edge_list_t *edges_in);
+void tsk_diff_iter_print_state(const tsk_diff_iter_t *self, FILE *out);
+
 #ifdef __cplusplus
 }
 #endif
 #endif
```

### Comparing `tskit-0.5.4/lib/tskit/trees.c` & `tskit-0.5.5/lib/tskit/trees.c`

 * *Files 3% similar despite different names*

```diff
@@ -1,11 +1,11 @@
 /*
  * MIT License
  *
- * Copyright (c) 2019-2022 Tskit Developers
+ * Copyright (c) 2019-2023 Tskit Developers
  * Copyright (c) 2015-2018 University of Oxford
  *
  * Permission is hereby granted, free of charge, to any person obtaining a copy
  * of this software and associated documentation files (the "Software"), to deal
  * in the Software without restriction, including without limitation the rights
  * to use, copy, modify, merge, publish, distribute, sublicense, and/or sell
  * copies of the Software, and to permit persons to whom the Software is
@@ -1260,15 +1260,15 @@
 tsk_treeseq_branch_general_stat(const tsk_treeseq_t *self, tsk_size_t state_dim,
     const double *sample_weights, tsk_size_t result_dim, general_stat_func_t *f,
     void *f_params, tsk_size_t num_windows, const double *windows, tsk_flags_t options,
     double *result)
 {
     int ret = 0;
     tsk_id_t u, v;
-    tsk_size_t j, k, tree_index, window_index;
+    tsk_size_t j, k, window_index;
     tsk_size_t num_nodes = self->tables->nodes.num_rows;
     const tsk_id_t num_edges = (tsk_id_t) self->tables->edges.num_rows;
     const tsk_id_t *restrict I = self->tables->indexes.edge_insertion_order;
     const tsk_id_t *restrict O = self->tables->indexes.edge_removal_order;
     const double *restrict edge_left = self->tables->edges.left;
     const double *restrict edge_right = self->tables->edges.right;
     const tsk_id_t *restrict edge_parent = self->tables->edges.parent;
@@ -1311,15 +1311,14 @@
     }
     tsk_memset(result, 0, num_windows * result_dim * sizeof(*result));
 
     /* Iterate over the trees */
     tj = 0;
     tk = 0;
     t_left = 0;
-    tree_index = 0;
     window_index = 0;
     while (tj < num_edges || t_left < sequence_length) {
         while (tk < num_edges && edge_right[O[tk]] == t_left) {
             h = O[tk];
             tk++;
 
             u = edge_child[h];
@@ -1396,15 +1395,14 @@
                 /* This interval crosses a tree boundary, so we update it again in the */
                 /* for the next tree */
                 break;
             }
         }
         /* Move to the next tree */
         t_left = t_right;
-        tree_index++;
     }
     tsk_bug_assert(window_index == num_windows);
 out:
     /* Can't use msp_safe_free here because of restrict */
     if (parent != NULL) {
         free(parent);
     }
@@ -4547,27 +4545,146 @@
 
 static inline bool
 tsk_tree_position_in_interval(const tsk_tree_t *self, double x)
 {
     return self->interval.left <= x && x < self->interval.right;
 }
 
-int TSK_WARN_UNUSED
-tsk_tree_seek(tsk_tree_t *self, double x, tsk_flags_t TSK_UNUSED(options))
+/* NOTE:
+ *
+ * Notes from Kevin Thornton:
+ *
+ * This method inserts the edges for an arbitrary tree
+ * in linear time and requires no additional memory.
+ *
+ * During design, the following alternatives were tested
+ * (in a combination of rust + C):
+ * 1. Indexing edge insertion/removal locations by tree.
+ *    The indexing can be done in O(n) time, giving O(1)
+ *    access to the first edge in a tree. We can then add
+ *    edges to the tree in O(e) time, where e is the number
+ *    of edges. This apparoach requires O(n) additional memory
+ *    and is only marginally faster than the implementation below.
+ * 2. Building an interval tree mapping edge id -> span.
+ *    This approach adds a lot of complexity and wasn't any faster
+ *    than the indexing described above.
+ */
+static int
+tsk_tree_seek_from_null(tsk_tree_t *self, double x, tsk_flags_t TSK_UNUSED(options))
 {
     int ret = 0;
+    tsk_size_t edge;
+    tsk_id_t p, c, e, j, k, tree_index;
     const double L = tsk_treeseq_get_sequence_length(self->tree_sequence);
-    const double t_l = self->interval.left;
-    const double t_r = self->interval.right;
-    double distance_left, distance_right;
+    const tsk_treeseq_t *treeseq = self->tree_sequence;
+    const tsk_table_collection_t *tables = treeseq->tables;
+    const tsk_id_t *restrict edge_parent = tables->edges.parent;
+    const tsk_id_t *restrict edge_child = tables->edges.child;
+    const tsk_size_t num_edges = tables->edges.num_rows;
+    const tsk_size_t num_trees = self->tree_sequence->num_trees;
+    const double *restrict edge_left = tables->edges.left;
+    const double *restrict edge_right = tables->edges.right;
+    const double *restrict breakpoints = treeseq->breakpoints;
+    const tsk_id_t *restrict insertion = tables->indexes.edge_insertion_order;
+    const tsk_id_t *restrict removal = tables->indexes.edge_removal_order;
+
+    // NOTE: it may be better to get the
+    // index first and then ask if we are
+    // searching in the first or last 1/2
+    // of trees.
+    j = -1;
+    if (x <= L / 2.0) {
+        for (edge = 0; edge < num_edges; edge++) {
+            e = insertion[edge];
+            if (edge_left[e] > x) {
+                j = (tsk_id_t) edge;
+                break;
+            }
+            if (x >= edge_left[e] && x < edge_right[e]) {
+                p = edge_parent[e];
+                c = edge_child[e];
+                tsk_tree_insert_edge(self, p, c, e);
+            }
+        }
+    } else {
+        for (edge = 0; edge < num_edges; edge++) {
+            e = removal[num_edges - edge - 1];
+            if (edge_right[e] < x) {
+                j = (tsk_id_t)(num_edges - edge - 1);
+                while (j < (tsk_id_t) num_edges && edge_left[insertion[j]] <= x) {
+                    j++;
+                }
+                break;
+            }
+            if (x >= edge_left[e] && x < edge_right[e]) {
+                p = edge_parent[e];
+                c = edge_child[e];
+                tsk_tree_insert_edge(self, p, c, e);
+            }
+        }
+    }
 
-    if (x < 0 || x >= L) {
+    if (j == -1) {
+        j = 0;
+        while (j < (tsk_id_t) num_edges && edge_left[insertion[j]] <= x) {
+            j++;
+        }
+    }
+    k = 0;
+    while (k < (tsk_id_t) num_edges && edge_right[removal[k]] <= x) {
+        k++;
+    }
+
+    /* NOTE: tsk_search_sorted finds the first the first
+     * insertion locatiom >= the query point, which
+     * finds a RIGHT value for queries not at the left edge.
+     */
+    tree_index = (tsk_id_t) tsk_search_sorted(breakpoints, num_trees + 1, x);
+    if (breakpoints[tree_index] > x) {
+        tree_index--;
+    }
+    self->index = tree_index;
+    self->interval.left = breakpoints[tree_index];
+    self->interval.right = breakpoints[tree_index + 1];
+    self->left_index = j;
+    self->right_index = k;
+    self->direction = TSK_DIR_FORWARD;
+    self->num_nodes = tables->nodes.num_rows;
+    if (tables->sites.num_rows > 0) {
+        self->sites = treeseq->tree_sites[self->index];
+        self->sites_length = treeseq->tree_sites_length[self->index];
+    }
+
+    return ret;
+}
+
+int TSK_WARN_UNUSED
+tsk_tree_seek_index(tsk_tree_t *self, tsk_id_t tree, tsk_flags_t options)
+{
+    int ret = 0;
+    double x;
+
+    if (tree < 0 || tree >= (tsk_id_t) self->tree_sequence->num_trees) {
         ret = TSK_ERR_SEEK_OUT_OF_BOUNDS;
         goto out;
     }
+    x = self->tree_sequence->breakpoints[tree];
+    ret = tsk_tree_seek(self, x, options);
+out:
+    return ret;
+}
+
+static int TSK_WARN_UNUSED
+tsk_tree_seek_linear(tsk_tree_t *self, double x, tsk_flags_t TSK_UNUSED(options))
+{
+    const double L = tsk_treeseq_get_sequence_length(self->tree_sequence);
+    const double t_l = self->interval.left;
+    const double t_r = self->interval.right;
+    int ret = 0;
+    double distance_left, distance_right;
 
     if (x < t_l) {
         /* |-----|-----|========|---------| */
         /* 0     x    t_l      t_r        L */
         distance_left = t_l - x;
         distance_right = L - t_r + x;
     } else {
@@ -4593,14 +4710,35 @@
     }
     ret = 0;
 out:
     return ret;
 }
 
 int TSK_WARN_UNUSED
+tsk_tree_seek(tsk_tree_t *self, double x, tsk_flags_t options)
+{
+    int ret = 0;
+    const double L = tsk_treeseq_get_sequence_length(self->tree_sequence);
+
+    if (x < 0 || x >= L) {
+        ret = TSK_ERR_SEEK_OUT_OF_BOUNDS;
+        goto out;
+    }
+
+    if (self->index == -1) {
+        ret = tsk_tree_seek_from_null(self, x, options);
+    } else {
+        ret = tsk_tree_seek_linear(self, x, options);
+    }
+
+out:
+    return ret;
+}
+
+int TSK_WARN_UNUSED
 tsk_tree_clear(tsk_tree_t *self)
 {
     int ret = 0;
     tsk_size_t j;
     tsk_id_t u;
     const tsk_size_t N = self->num_nodes + 1;
     const tsk_size_t num_samples = self->tree_sequence->num_samples;
@@ -5340,167 +5478,24 @@
     }
     if (nodes != NULL) {
         free(nodes);
     }
     return ret;
 }
 
-/* ======================================================== *
- * Tree diff iterator.
- * ======================================================== */
-
+/* Compatibility shim for initialising the diff iterator from a tree sequence. We are
+ * using this function in a small number of places internally, so simplest to keep it
+ * until a more satisfactory "diff" API comes along.
+ */
 int TSK_WARN_UNUSED
-tsk_diff_iter_init(
+tsk_diff_iter_init_from_ts(
     tsk_diff_iter_t *self, const tsk_treeseq_t *tree_sequence, tsk_flags_t options)
 {
-    int ret = 0;
-
-    tsk_bug_assert(tree_sequence != NULL);
-    tsk_memset(self, 0, sizeof(tsk_diff_iter_t));
-    self->num_nodes = tsk_treeseq_get_num_nodes(tree_sequence);
-    self->num_edges = tsk_treeseq_get_num_edges(tree_sequence);
-    self->tree_sequence = tree_sequence;
-    self->insertion_index = 0;
-    self->removal_index = 0;
-    self->tree_left = 0;
-    self->tree_index = -1;
-    self->last_index = (tsk_id_t) tsk_treeseq_get_num_trees(tree_sequence);
-    if (options & TSK_INCLUDE_TERMINAL) {
-        self->last_index = self->last_index + 1;
-    }
-    self->edge_list_nodes = tsk_malloc(self->num_edges * sizeof(*self->edge_list_nodes));
-    if (self->edge_list_nodes == NULL) {
-        ret = TSK_ERR_NO_MEMORY;
-        goto out;
-    }
-out:
-    return ret;
-}
-
-int
-tsk_diff_iter_free(tsk_diff_iter_t *self)
-{
-    tsk_safe_free(self->edge_list_nodes);
-    return 0;
-}
-
-void
-tsk_diff_iter_print_state(const tsk_diff_iter_t *self, FILE *out)
-{
-    fprintf(out, "tree_diff_iterator state\n");
-    fprintf(out, "num_edges = %lld\n", (long long) self->num_edges);
-    fprintf(out, "insertion_index = %lld\n", (long long) self->insertion_index);
-    fprintf(out, "removal_index = %lld\n", (long long) self->removal_index);
-    fprintf(out, "tree_left = %f\n", self->tree_left);
-    fprintf(out, "tree_index = %lld\n", (long long) self->tree_index);
-}
-
-int TSK_WARN_UNUSED
-tsk_diff_iter_next(tsk_diff_iter_t *self, double *ret_left, double *ret_right,
-    tsk_edge_list_t *edges_out_ret, tsk_edge_list_t *edges_in_ret)
-{
-    int ret = 0;
-    tsk_id_t k;
-    const double sequence_length = self->tree_sequence->tables->sequence_length;
-    double left = self->tree_left;
-    double right = sequence_length;
-    tsk_size_t next_edge_list_node = 0;
-    const tsk_treeseq_t *s = self->tree_sequence;
-    tsk_edge_list_node_t *out_head = NULL;
-    tsk_edge_list_node_t *out_tail = NULL;
-    tsk_edge_list_node_t *in_head = NULL;
-    tsk_edge_list_node_t *in_tail = NULL;
-    tsk_edge_list_node_t *w = NULL;
-    tsk_edge_list_t edges_out;
-    tsk_edge_list_t edges_in;
-    const tsk_edge_table_t *edges = &s->tables->edges;
-    const tsk_id_t *insertion_order = s->tables->indexes.edge_insertion_order;
-    const tsk_id_t *removal_order = s->tables->indexes.edge_removal_order;
-
-    tsk_memset(&edges_out, 0, sizeof(edges_out));
-    tsk_memset(&edges_in, 0, sizeof(edges_in));
-
-    if (self->tree_index + 1 < self->last_index) {
-        /* First we remove the stale records */
-        while (self->removal_index < (tsk_id_t) self->num_edges
-               && left == edges->right[removal_order[self->removal_index]]) {
-            k = removal_order[self->removal_index];
-            tsk_bug_assert(next_edge_list_node < self->num_edges);
-            w = &self->edge_list_nodes[next_edge_list_node];
-            next_edge_list_node++;
-            w->edge.id = k;
-            w->edge.left = edges->left[k];
-            w->edge.right = edges->right[k];
-            w->edge.parent = edges->parent[k];
-            w->edge.child = edges->child[k];
-            w->edge.metadata = edges->metadata + edges->metadata_offset[k];
-            w->edge.metadata_length
-                = edges->metadata_offset[k + 1] - edges->metadata_offset[k];
-            w->next = NULL;
-            w->prev = NULL;
-            if (out_head == NULL) {
-                out_head = w;
-                out_tail = w;
-            } else {
-                out_tail->next = w;
-                w->prev = out_tail;
-                out_tail = w;
-            }
-            self->removal_index++;
-        }
-        edges_out.head = out_head;
-        edges_out.tail = out_tail;
-
-        /* Now insert the new records */
-        while (self->insertion_index < (tsk_id_t) self->num_edges
-               && left == edges->left[insertion_order[self->insertion_index]]) {
-            k = insertion_order[self->insertion_index];
-            tsk_bug_assert(next_edge_list_node < self->num_edges);
-            w = &self->edge_list_nodes[next_edge_list_node];
-            next_edge_list_node++;
-            w->edge.id = k;
-            w->edge.left = edges->left[k];
-            w->edge.right = edges->right[k];
-            w->edge.parent = edges->parent[k];
-            w->edge.child = edges->child[k];
-            w->edge.metadata = edges->metadata + edges->metadata_offset[k];
-            w->edge.metadata_length
-                = edges->metadata_offset[k + 1] - edges->metadata_offset[k];
-            w->next = NULL;
-            w->prev = NULL;
-            if (in_head == NULL) {
-                in_head = w;
-                in_tail = w;
-            } else {
-                in_tail->next = w;
-                w->prev = in_tail;
-                in_tail = w;
-            }
-            self->insertion_index++;
-        }
-        edges_in.head = in_head;
-        edges_in.tail = in_tail;
-
-        right = sequence_length;
-        if (self->insertion_index < (tsk_id_t) self->num_edges) {
-            right = TSK_MIN(right, edges->left[insertion_order[self->insertion_index]]);
-        }
-        if (self->removal_index < (tsk_id_t) self->num_edges) {
-            right = TSK_MIN(right, edges->right[removal_order[self->removal_index]]);
-        }
-        self->tree_index++;
-        ret = TSK_TREE_OK;
-    }
-    *edges_out_ret = edges_out;
-    *edges_in_ret = edges_in;
-    *ret_left = left;
-    *ret_right = right;
-    /* Set the left coordinate for the next tree */
-    self->tree_left = right;
-    return ret;
+    return tsk_diff_iter_init(
+        self, tree_sequence->tables, (tsk_id_t) tree_sequence->num_trees, options);
 }
 
 /* ======================================================== *
  * KC Distance
  * ======================================================== */
 
 typedef struct {
@@ -5923,15 +5918,15 @@
 
     n = (tsk_id_t) self->num_samples;
     for (i = 0; i < 2; i++) {
         ret = tsk_tree_init(&trees[i], treeseqs[i], TSK_SAMPLE_LISTS);
         if (ret != 0) {
             goto out;
         }
-        ret = tsk_diff_iter_init(&diff_iters[i], treeseqs[i], false);
+        ret = tsk_diff_iter_init_from_ts(&diff_iters[i], treeseqs[i], false);
         if (ret != 0) {
             goto out;
         }
         ret = kc_vectors_alloc(&kcs[i], n);
         if (ret != 0) {
             goto out;
         }
```

### Comparing `tskit-0.5.4/lib/tskit/trees.h` & `tskit-0.5.5/lib/tskit/trees.h`

 * *Files 3% similar despite different names*

```diff
@@ -1,11 +1,11 @@
 /*
  * MIT License
  *
- * Copyright (c) 2019-2022 Tskit Developers
+ * Copyright (c) 2019-2023 Tskit Developers
  * Copyright (c) 2015-2018 University of Oxford
  *
  * Permission is hereby granted, free of charge, to any person obtaining a copy
  * of this software and associated documentation files (the "Software"), to deal
  * in the Software without restriction, including without limitation the rights
  * to use, copy, modify, merge, publish, distribute, sublicense, and/or sell
  * copies of the Software, and to permit persons to whom the Software is
@@ -55,17 +55,14 @@
 
 /* Options for map_mutations */
 #define TSK_MM_FIXED_ANCESTRAL_STATE (1 << 0)
 
 #define TSK_DIR_FORWARD 1
 #define TSK_DIR_REVERSE -1
 
-/* For the edge diff iterator */
-#define TSK_INCLUDE_TERMINAL        (1 << 0)
-
 /**
 @defgroup API_FLAGS_TS_INIT_GROUP :c:func:`tsk_treeseq_init` specific flags.
 @{
 */
 /**
 If specified edge indexes will be built and stored in the table collection
 when the tree sequence is initialised. Indexes are required for a valid
@@ -257,38 +254,14 @@
     tsk_size_t sites_length;
     /* Counters needed for next() and prev() transformations. */
     int direction;
     tsk_id_t left_index;
     tsk_id_t right_index;
 } tsk_tree_t;
 
-/* Diff iterator. */
-typedef struct _tsk_edge_list_node_t {
-    tsk_edge_t edge;
-    struct _tsk_edge_list_node_t *next;
-    struct _tsk_edge_list_node_t *prev;
-} tsk_edge_list_node_t;
-
-typedef struct {
-    tsk_edge_list_node_t *head;
-    tsk_edge_list_node_t *tail;
-} tsk_edge_list_t;
-
-typedef struct {
-    tsk_size_t num_nodes;
-    tsk_size_t num_edges;
-    double tree_left;
-    const tsk_treeseq_t *tree_sequence;
-    tsk_id_t insertion_index;
-    tsk_id_t removal_index;
-    tsk_id_t tree_index;
-    tsk_id_t last_index;
-    tsk_edge_list_node_t *edge_list_nodes;
-} tsk_diff_iter_t;
-
 /****************************************************************************/
 /* Tree sequence.*/
 /****************************************************************************/
 
 /**
 @defgroup TREESEQ_API_GROUP Tree sequence API
 @{
@@ -1110,18 +1083,14 @@
 /** @} */
 
 /**
 @defgroup TREE_API_SEEKING_GROUP Seeking along the sequence
 @{
 */
 
-/** @brief Value returned by seeking methods when they have successfully
-    seeked to a non-null tree. */
-#define TSK_TREE_OK 1
-
 /**
 @brief Seek to the first tree in the sequence.
 
 @rst
 Set the state of this tree to reflect the first tree in parent
 tree sequence.
 @endrst
@@ -1219,30 +1188,40 @@
 Set the state of this tree to reflect the tree in parent
 tree sequence covering the specified ``position``. That is, on success
 we will have ``tree.interval.left <= position`` and
 we will have ``position < tree.interval.right``.
 
 Seeking to a position currently covered by the tree is
 a constant time operation.
-
-.. warning::
-   The current implementation of ``seek`` does **not** provide efficient
-   random access to arbitrary positions along the genome. However,
-   sequentially seeking in either direction is as efficient as calling
-   :c:func:`tsk_tree_next` or :c:func:`tsk_tree_prev` directly.
 @endrst
 
 @param self A pointer to an initialised tsk_tree_t object.
 @param position The position in genome coordinates
 @param options Seek options. Currently unused. Set to 0 for compatibility
     with future versions of tskit.
 @return Return 0 on success or a negative value on failure.
 */
 int tsk_tree_seek(tsk_tree_t *self, double position, tsk_flags_t options);
 
+/**
+@brief Seek to a specific tree in a tree sequence.
+
+@rst
+Set the state of this tree to reflect the tree in parent
+tree sequence whose index is ``0 <= tree < num_trees``.
+@endrst
+
+@param self A pointer to an initialised tsk_tree_t object.
+@param tree The target tree index.
+@param options Seek options. Currently unused. Set to 0 for compatibility
+    with future versions of tskit.
+@return Return 0 on success or a negative value on failure.
+*/
+int tsk_tree_seek_index(tsk_tree_t *self, tsk_id_t tree, tsk_flags_t options);
+
 /** @} */
 
 /**
 @defgroup TREE_API_TREE_QUERY_GROUP Tree Queries
 @{
 */
 
@@ -1738,22 +1717,14 @@
 
 /* Not terribly useful, since the definition is
  * return (self->tree_sequence == other->tree_sequence) && (self->index == other->index)
  * Remove?
  */
 bool tsk_tree_equals(const tsk_tree_t *self, const tsk_tree_t *other);
 
-/****************************************************************************/
-/* Diff iterator */
-/****************************************************************************/
-
-int tsk_diff_iter_init(
+int tsk_diff_iter_init_from_ts(
     tsk_diff_iter_t *self, const tsk_treeseq_t *tree_sequence, tsk_flags_t options);
-int tsk_diff_iter_free(tsk_diff_iter_t *self);
-int tsk_diff_iter_next(tsk_diff_iter_t *self, double *left, double *right,
-    tsk_edge_list_t *edges_out, tsk_edge_list_t *edges_in);
-void tsk_diff_iter_print_state(const tsk_diff_iter_t *self, FILE *out);
 
 #ifdef __cplusplus
 }
 #endif
 #endif
```

### Comparing `tskit-0.5.4/lib/tskit.h` & `tskit-0.5.5/lib/tskit.h`

 * *Files identical despite different names*

### Comparing `tskit-0.5.4/lwt_interface/tskit_lwt_interface.h` & `tskit-0.5.5/lwt_interface/tskit_lwt_interface.h`

 * *Files identical despite different names*

### Comparing `tskit-0.5.4/setup.cfg` & `tskit-0.5.5/setup.cfg`

 * *Files identical despite different names*

### Comparing `tskit-0.5.4/setup.py` & `tskit-0.5.5/setup.py`

 * *Files identical despite different names*

### Comparing `tskit-0.5.4/tskit/__init__.py` & `tskit-0.5.5/tskit/__init__.py`

 * *Files identical despite different names*

### Comparing `tskit-0.5.4/tskit/cli.py` & `tskit-0.5.5/tskit/cli.py`

 * *Files identical despite different names*

### Comparing `tskit-0.5.4/tskit/combinatorics.py` & `tskit-0.5.5/tskit/combinatorics.py`

 * *Files identical despite different names*

### Comparing `tskit-0.5.4/tskit/drawing.py` & `tskit-0.5.5/tskit/drawing.py`

 * *Files identical despite different names*

### Comparing `tskit-0.5.4/tskit/exceptions.py` & `tskit-0.5.5/tskit/exceptions.py`

 * *Files identical despite different names*

### Comparing `tskit-0.5.4/tskit/formats.py` & `tskit-0.5.5/tskit/formats.py`

 * *Files identical despite different names*

### Comparing `tskit-0.5.4/tskit/genotypes.py` & `tskit-0.5.5/tskit/genotypes.py`

 * *Files 2% similar despite different names*

```diff
@@ -1,11 +1,11 @@
 #
 # MIT License
 #
-# Copyright (c) 2018-2022 Tskit Developers
+# Copyright (c) 2018-2023 Tskit Developers
 # Copyright (c) 2015-2018 University of Oxford
 #
 # Permission is hereby granted, free of charge, to any person obtaining a copy
 # of this software and associated documentation files (the "Software"), to deal
 # in the Software without restriction, including without limitation the rights
 # to use, copy, modify, merge, publish, distribute, sublicense, and/or sell
 # copies of the Software, and to permit persons to whom the Software is
@@ -336,14 +336,25 @@
     def _repr_html_(self) -> str:
         """
         Return an html summary of a variant. Called by Jupyter notebooks
         to render a Variant.
         """
         return util.variant_html(self)
 
+    def __repr__(self):
+        d = {
+            "site": self.site,
+            "samples": self.samples,
+            "alleles": self.alleles,
+            "genotypes": self.genotypes,
+            "has_missing_data": self.has_missing_data,
+            "isolated_as_missing": self.isolated_as_missing,
+        }
+        return f"Variant({repr(d)})"
+
 
 #
 # Miscellaneous auxiliary methods.
 #
 def allele_remap(alleles_from, alleles_to):
     # Returns an index map from the elements in one list (alleles_from)
     # to the elements of another list (alleles_to).
```

### Comparing `tskit-0.5.4/tskit/intervals.py` & `tskit-0.5.5/tskit/intervals.py`

 * *Files identical despite different names*

### Comparing `tskit-0.5.4/tskit/metadata.py` & `tskit-0.5.5/tskit/metadata.py`

 * *Files identical despite different names*

### Comparing `tskit-0.5.4/tskit/provenance.py` & `tskit-0.5.5/tskit/provenance.py`

 * *Files identical despite different names*

### Comparing `tskit-0.5.4/tskit/provenance.schema.json` & `tskit-0.5.5/tskit/provenance.schema.json`

 * *Files identical despite different names*

### Comparing `tskit-0.5.4/tskit/stats.py` & `tskit-0.5.5/tskit/stats.py`

 * *Files 17% similar despite different names*

```diff
@@ -211,69 +211,93 @@
         self.block_multiplier = block_multiplier
         for i in range(self.num_weights):
             self.cum_weights[:, i] = np.cumsum(
                 self.weights[:, i] * self.block_multiplier[self.block], 0
             )
             if self.cum_weights[-1, i] > 0:
                 self.quantile[:, i] = self.cum_weights[:, i] / self.cum_weights[-1, i]
+            else:
+                self.quantile[:, i] = np.nan
 
 
 class CoalescenceTimeDistribution:
     """
     Class to precompute a table of sorted/weighted node times, from which to calculate
     the empirical distribution function and estimate coalescence rates in time windows.
+
+    To compute weights efficiently requires an update operation of the form:
+
+        ``output[parent], state[parent] = update(state[children])``
+
+    where ``output`` are the weights associated with the node, and ``state``
+    are values that are needed to compute ``output`` that are recursively
+    calculated along the tree. The value of ``state`` on the leaves is
+    initialized via,
+
+        ``state[sample] = initialize(sample, sample_sets)``
     """
 
     @staticmethod
-    def _count_coalescence_events(node, tree, sample_sets):
-        # TODO this will count unary nodes: should it count nodes
-        # with >1 child instead?
-        return np.array([1], dtype=np.int32)
+    def _count_coalescence_events():
+        """
+        Count the number of samples that coalesce in ``node``, within each
+        set of samples in ``sample_sets``.
+        """
+
+        def initialize(node, sample_sets):
+            singles = np.array([[node in s for s in sample_sets]], dtype=np.float64)
+            return (singles,)
+
+        def update(singles_per_child):
+            singles = np.sum(singles_per_child, axis=0, keepdims=True)
+            is_ancestor = (singles > 0).astype(np.float64)
+            return is_ancestor, (singles,)
+
+        return (initialize, update)
 
     @staticmethod
-    def _count_pair_coalescence_events(node, tree, sample_sets):
+    def _count_pair_coalescence_events():
         """
-        Count the number of pairs that coalesce in node, within and between the
+        Count the number of pairs that coalesce in ``node``, within and between the
         sets of samples in ``sample_sets``. The count of pairs with members that
         belong to sets :math:`a` and :math:`b` is:
 
         .. math:
 
             \\sum_{i \\neq j} (C_i(a) C_j(b) + C_i(b) C_j(a))/(1 - \\mathbb{I}[a = b])
 
         where :math:`C_i(a)` is the number of samples from set :math:`a`
         descended from child :math:`i`.  The values in the output are ordered
         canonically; e.g. if ``len(sample_sets) == 2`` then the values would
         correspond to counts of pairs with set labels ``[(0,0), (0,1), (1,1)]``.
         """
 
-        # TODO needs to be optimized, use np.intersect1d
-        children = tree.children(node)
-        samples_per_child = [set(list(tree.samples(c))) for c in children]
-        sample_counts = np.zeros((len(sample_sets), len(children)), dtype=np.int32)
-        for i, s1 in enumerate(samples_per_child):
-            for a, s2 in enumerate([set(s) for s in sample_sets]):
-                sample_counts[a, i] = len(s1 & s2)
-
-        pair_counts = []
-        for a, b in itertools.combinations_with_replacement(
-            range(sample_counts.shape[0]), 2
-        ):
-            count = 0
-            for i, j in itertools.combinations(range(sample_counts.shape[1]), 2):
-                count += (
-                    sample_counts[a, i] * sample_counts[b, j]
-                    + sample_counts[a, j] * sample_counts[b, i]
-                ) / (1 + int(a == b))
-            pair_counts.append(count)
+        def initialize(node, sample_sets):
+            singles = np.array([[node in s for s in sample_sets]], dtype=np.float64)
+            return (singles,)
+
+        def update(singles_per_child):
+            C = singles_per_child.shape[0]  # number of children
+            S = singles_per_child.shape[1]  # number of sample sets
+            singles = np.sum(singles_per_child, axis=0, keepdims=True)
+            pairs = np.zeros((1, int(S * (S + 1) / 2)), dtype=np.float64)
+            for a, b in itertools.combinations(range(C), 2):
+                for i, (j, k) in enumerate(
+                    itertools.combinations_with_replacement(range(S), 2)
+                ):
+                    pairs[0, i] += (
+                        singles_per_child[a, j] * singles_per_child[b, k]
+                        + singles_per_child[a, k] * singles_per_child[b, j]
+                    ) / (1 + int(j == k))
+            return pairs, (singles,)
 
-        return np.array(pair_counts, dtype=np.int32)
+        return (initialize, update)
 
     @staticmethod
-    def _count_trio_first_coalescence_events(node, tree, sample_sets):
+    def _count_trio_first_coalescence_events():
         """
         Count the number of pairs that coalesce in node with an outgroup,
         within and between the sets of samples in ``sample_sets``. In other
         words, count topologies of the form ``((A,B):node,C)`` where ``A,B,C``
         are labels and `node` is the node ID.  The count of pairs with members
         that belong to sets :math:`a` and :math:`b` with outgroup :math:`c` is:
 
@@ -286,166 +310,277 @@
         descended from child :math:`i` of the node, and :math:`O(c)` is the
         number of samples from set :math:`c` that are *not* descended from the
         node.  The values in the output are ordered canonically by pair then
         outgroup; e.g. if ``len(sample_sets) == 2`` then the values would
         correspond to counts of pairs with set labels,
         ``[((0,0),0), ((0,0),1), ..., ((0,1),0), ((0,1),1), ...]``.
         """
-        samples = list(tree.samples(node))
-        outg_counts = [len(s) - len(np.intersect1d(samples, s)) for s in sample_sets]
-        pair_counts = CoalescenceTimeDistribution._count_pair_coalescence_events(
-            node, tree, sample_sets
-        )
-        trio_counts = []
-        for i in pair_counts:
-            for j in outg_counts:
-                trio_counts.append(i * j)
-        return np.array(trio_counts, dtype=np.int32)
 
-    def _update_weights_by_edge_diff(self, tree, edge_diff, running_weights):
+        def initialize(node, sample_sets):
+            S = len(sample_sets)
+            totals = np.array([[len(s) for s in sample_sets]], dtype=np.float64)
+            singles = np.array([[node in s for s in sample_sets]], dtype=np.float64)
+            pairs = np.zeros((1, int(S * (S + 1) / 2)), dtype=np.float64)
+            return (
+                totals,
+                singles,
+                pairs,
+            )
+
+        def update(totals_per_child, singles_per_child, pairs_per_child):
+            C = totals_per_child.shape[0]  # number of children
+            S = totals_per_child.shape[1]  # number of sample sets
+            totals = np.mean(totals_per_child, axis=0, keepdims=True)
+            singles = np.sum(singles_per_child, axis=0, keepdims=True)
+            pairs = np.zeros((1, int(S * (S + 1) / 2)), dtype=np.float64)
+            for a, b in itertools.combinations(range(C), 2):
+                pair_iterator = itertools.combinations_with_replacement(range(S), 2)
+                for i, (j, k) in enumerate(pair_iterator):
+                    pairs[0, i] += (
+                        singles_per_child[a, j] * singles_per_child[b, k]
+                        + singles_per_child[a, k] * singles_per_child[b, j]
+                    ) / (1 + int(j == k))
+            outgr = totals - singles
+            trios = np.zeros((1, pairs.size * outgr.size), dtype=np.float64)
+            trio_iterator = itertools.product(range(pairs.size), range(outgr.size))
+            for i, (j, k) in enumerate(trio_iterator):
+                trios[0, i] += pairs[0, j] * outgr[0, k]
+            return trios, (
+                totals,
+                singles,
+                pairs,
+            )
+
+        return (initialize, update)
+
+    def _update_running_with_edge_diff(
+        self, tree, edge_diff, running_output, running_state, running_index
+    ):
         """
-        Update ``running_weights`` to reflect ``tree`` using edge differences
-        ``edge_diff`` with the previous tree.
+        Update ``running_output`` and ``running_state`` to reflect ``tree``,
+        using edge differences ``edge_diff`` with the previous tree.
+        The dict ``running_index`` maps node IDs onto rows of the running arrays.
         """
 
         assert edge_diff.interval == tree.interval
 
-        # nodes that have been removed from tree
-        removed = {i.child for i in edge_diff.edges_out if tree.is_isolated(i.child)}
-        # TODO: What if sample is removed from tree? In that case should all
-        # nodes be updated for trio first coalescences?
-
-        # nodes where descendant subtree has been altered
-        modified = {i.parent for i in edge_diff.edges_in}
-        for i in copy.deepcopy(modified):
-            while tree.parent(i) != tskit.NULL and not tree.parent(i) in modified:
+        # empty rows in the running arrays
+        available_rows = {i for i in range(self.running_array_size)}
+        available_rows -= set(running_index.values())
+
+        # find internal nodes that have been removed from tree or are unary
+        removed_nodes = set()
+        for i in edge_diff.edges_out:
+            for j in [i.child, i.parent]:
+                if tree.num_children(j) < 2 and not tree.is_sample(j):
+                    removed_nodes.add(j)
+
+        # find non-unary nodes where descendant subtree has been altered
+        modified_nodes = {
+            i.parent for i in edge_diff.edges_in if tree.num_children(i.parent) > 1
+        }
+        for i in copy.deepcopy(modified_nodes):
+            while tree.parent(i) != tskit.NULL and not tree.parent(i) in modified_nodes:
                 i = tree.parent(i)
-                modified.add(i)
+                if tree.num_children(i) > 1:
+                    modified_nodes.add(i)
+
+        # clear running state/output for nodes that are no longer in tree
+        for i in removed_nodes:
+            if i in running_index:
+                running_state[running_index[i], :] = 0
+                running_output[running_index[i], :] = 0
+                available_rows.add(running_index.pop(i))
+
+        # recalculate state/output for nodes whose descendants have changed
+        for i in sorted(modified_nodes, key=lambda node: tree.time(node)):
+            children = []
+            for c in tree.children(i):  # skip unary children
+                while tree.num_children(c) == 1:
+                    (c,) = tree.children(c)
+                children.append(c)
+            child_index = [running_index[c] for c in children]
+
+            inputs = (
+                running_state[child_index][:, state_index]
+                for state_index in self.state_indices
+            )
+            output, state = self._update(*inputs)
 
-        # recalculate weights for current tree
-        for i in removed:
-            running_weights[i, :] = 0
-        for i in modified:
-            running_weights[i, :] = self.weight_func(i, tree, self.sample_sets)
-        self.weight_func_evals += len(modified)
+            # update running state/output arrays
+            if i not in running_index:
+                running_index[i] = available_rows.pop()
+            running_output[running_index[i], :] = output
+            for state_index, x in zip(self.state_indices, state):
+                running_state[running_index[i], state_index] = x
+
+        # track the number of times the weight function was called
+        self.weight_func_evals += len(modified_nodes)
 
     def _build_ecdf_table_for_window(
-        self, left, right, tree, edge_diffs, running_weights
+        self,
+        left,
+        right,
+        tree,
+        edge_diffs,
+        running_output,
+        running_state,
+        running_index,
     ):
         """
-        Construct ECDF table for genomic interval [left, right]. Update ``tree``,
-        ``edge_diffs``, and ``running_weights`` for input for next window. Trees are
-        counted as belonging to any interval with which they overlap, and thus
-        can be used in several intervals. Thus, the concatenation of ECDF
-        tables across multiple intervals is not the same as the ECDF table
-        for the union of those intervals. Trees within intervals are chunked
-        into roughly equal-sized blocks for bootstrapping.
+        Construct ECDF table for genomic interval [left, right]. Update
+        ``tree``; ``edge_diffs``; and ``running_output``, ``running_state``,
+        `running_idx``; for input for next window. Trees are counted as
+        belonging to any interval with which they overlap, and thus can be used
+        in several intervals.  Thus, the concatenation of ECDF tables across
+        multiple intervals is not the same as the ECDF table for the union of
+        those intervals. Trees within intervals are chunked into roughly
+        equal-sized blocks for bootstrapping.
         """
 
         assert tree.interval.left <= left and right > left
 
+        # TODO: if bootstrapping, block span needs to be tracked
+        #   and used to renormalise each replicate. This should be
+        #   done by the bootstrapping machinery, not here.
+
         # assign trees in window to equal-sized blocks with unique id
-        other_tree = tree.copy()
-        # TODO: is a full copy of the tree needed, given that the original is
-        # mutated below?
-        if right >= other_tree.tree_sequence.sequence_length:
-            other_tree.last()
-        else:
-            # other_tree.seek(right) won't work if `right` is recomb breakpoint
-            while other_tree.interval.right < right:
-                other_tree.next()
-        tree_idx = np.arange(tree.index, other_tree.index + 1) - tree.index
         tree_offset = tree.index
+        if right >= tree.tree_sequence.sequence_length:
+            tree.last()
+        else:
+            # tree.seek(right) won't work if `right` is recomb breakpoint
+            while tree.interval.right < right:
+                tree.next()
+        tree_idx = np.arange(tree_offset, tree.index + 1) - tree_offset
         num_blocks = min(self.num_blocks, len(tree_idx))
         tree_blocks = np.floor_divide(num_blocks * tree_idx, len(tree_idx))
 
         # calculate span weights
-        # TODO: if bootstrapping, does block span need to be tracked
-        # and used to renormalise each replicate?
-        other_tree.seek(tree.interval.left)
-        tree_span = [
-            min(other_tree.interval.right, right) - max(other_tree.interval.left, left)
-        ]
-        while other_tree.index < tree_offset + tree_idx[-1]:
-            other_tree.next()
+        tree.seek_index(tree_offset)
+        tree_span = [min(tree.interval.right, right) - max(tree.interval.left, left)]
+        while tree.index < tree_offset + tree_idx[-1]:
+            tree.next()
             tree_span.append(
-                min(other_tree.interval.right, right)
-                - max(other_tree.interval.left, left)
+                min(tree.interval.right, right) - max(tree.interval.left, left)
             )
-        tree_span = np.array(tree_span) / sum(tree_span)
+        tree_span = np.array(tree_span)
+        total_span = np.sum(tree_span)
+        assert np.isclose(
+            total_span, min(right, tree.tree_sequence.sequence_length) - left
+        )
 
         # storage if using single window, block for entire tree sequence
         buffer_size = self.buffer_size
         table_size = buffer_size
         time = np.zeros(table_size)
         block = np.zeros(table_size, dtype=np.int32)
         weights = np.zeros((table_size, self.num_weights))
 
         # assemble table of coalescence times in window
+        num_record = 0
+        accessible_span = 0.0
+        span_weight = 1.0
         indices = np.zeros(tree.tree_sequence.num_nodes, dtype=np.int32) - 1
         last_block = np.zeros(tree.tree_sequence.num_nodes, dtype=np.int32) - 1
-        num_record = 0
+        tree.seek_index(tree_offset)
         while tree.index != tskit.NULL:
             if tree.interval.right > left:
                 current_block = tree_blocks[tree.index - tree_offset]
                 if self.span_normalise:
-                    span_weight = tree_span[tree.index - tree_offset]
-                else:
-                    span_weight = 1.0
-                nodes_in_tree = np.array(
-                    [i for i in tree.nodes() if tree.is_internal(i)]
-                )
-                # TODO this will fail if all nodes are isolated (masked tree)
-                nodes_to_add = nodes_in_tree[
-                    np.where(last_block[nodes_in_tree] != current_block)
-                ]
-                if len(nodes_to_add) > 0:
-                    idx = np.arange(num_record, num_record + len(nodes_to_add))
-                    last_block[nodes_to_add] = current_block
-                    indices[nodes_to_add] = idx
-                    if table_size < num_record + len(nodes_to_add):
-                        table_size += buffer_size
-                        time = np.pad(time, (0, buffer_size))
-                        block = np.pad(block, (0, buffer_size))
-                        weights = np.pad(weights, ((0, buffer_size), (0, 0)))
-                    time[idx] = [tree.time(i) for i in nodes_to_add]
-                    block[idx] = current_block
-                    num_record += len(nodes_to_add)
-                weights[indices[nodes_in_tree], :] += (
-                    span_weight * running_weights[nodes_in_tree, :]
+                    span_weight = tree_span[tree.index - tree_offset] / total_span
+
+                # TODO: shouldn't need to loop over all keys (nodes) for every tree
+                internal_nodes = np.array(
+                    [i for i in running_index.keys() if not tree.is_sample(i)],
+                    dtype=np.int32,
                 )
 
+                if internal_nodes.size > 0:
+                    accessible_span += tree_span[tree.index - tree_offset]
+                    rows_in_running = np.array(
+                        [running_index[i] for i in internal_nodes], dtype=np.int32
+                    )
+                    nodes_to_add = internal_nodes[
+                        last_block[internal_nodes] != current_block
+                    ]
+                    if nodes_to_add.size > 0:
+                        table_idx = np.arange(
+                            num_record, num_record + len(nodes_to_add)
+                        )
+                        last_block[nodes_to_add] = current_block
+                        indices[nodes_to_add] = table_idx
+                        if table_size < num_record + len(nodes_to_add):
+                            table_size += buffer_size
+                            time = np.pad(time, (0, buffer_size))
+                            block = np.pad(block, (0, buffer_size))
+                            weights = np.pad(weights, ((0, buffer_size), (0, 0)))
+                        time[table_idx] = [tree.time(i) for i in nodes_to_add]
+                        block[table_idx] = current_block
+                        num_record += len(nodes_to_add)
+                    weights[indices[internal_nodes], :] += (
+                        span_weight * running_output[rows_in_running, :]
+                    )
+
             if tree.interval.right < right:
                 # if current tree does not cross window boundary, move to next
                 tree.next()
-                self._update_weights_by_edge_diff(
-                    tree, next(edge_diffs), running_weights
+                self._update_running_with_edge_diff(
+                    tree, next(edge_diffs), running_output, running_state, running_index
                 )
             else:
                 # use current tree as initial tree for next window
                 break
 
+        # reweight span so that weights are averaged over nonmissing trees
+        if self.span_normalise:
+            weights *= total_span / accessible_span
+
         return CoalescenceTimeTable(time, block, weights)
 
     def _generate_ecdf_tables(self, ts, window_breaks):
         """
         Return generator for ECDF tables across genomic windows defined by
         ``window_breaks``.
 
         ..note:: This could be used in methods in place of loops over
             pre-assembled tables.
         """
 
         tree = ts.first()
         edge_diffs = ts.edge_diffs()
-        running_weights = np.zeros((ts.num_nodes, self.num_weights))
-        self._update_weights_by_edge_diff(tree, next(edge_diffs), running_weights)
+
+        # initialize running arrays for first tree
+        running_index = {i: n for i, n in enumerate(tree.samples())}
+        running_output = np.zeros(
+            (self.running_array_size, self.num_weights),
+            dtype=np.float64,
+        )
+        running_state = np.zeros(
+            (self.running_array_size, self.num_states),
+            dtype=np.float64,
+        )
+        for node in tree.samples():
+            state = self._initialize(node, self.sample_sets)
+            for state_index, x in zip(self.state_indices, state):
+                running_state[running_index[node], state_index] = x
+
+        self._update_running_with_edge_diff(
+            tree, next(edge_diffs), running_output, running_state, running_index
+        )
+
         for left, right in zip(window_breaks[:-1], window_breaks[1:]):
             yield self._build_ecdf_table_for_window(
-                left, right, tree, edge_diffs, running_weights
+                left,
+                right,
+                tree,
+                edge_diffs,
+                running_output,
+                running_state,
+                running_index,
             )
 
     def __init__(
         self,
         ts,
         sample_sets=None,
         weight_func=None,
@@ -459,26 +594,55 @@
         if sample_sets is None:
             sample_sets = [list(ts.samples())]
         assert all([isinstance(i, list) for i in sample_sets])
         assert all([i in ts.samples() for j in sample_sets for i in j])
         self.sample_sets = sample_sets
 
         if weight_func is None or weight_func == "coalescence_events":
-            self.weight_func = self._count_coalescence_events
+            self._initialize, self._update = self._count_coalescence_events()
         elif weight_func == "pair_coalescence_events":
-            self.weight_func = self._count_pair_coalescence_events
+            self._initialize, self._update = self._count_pair_coalescence_events()
         elif weight_func == "trio_first_coalescence_events":
-            self.weight_func = self._count_trio_first_coalescence_events
+            self._initialize, self._update = self._count_trio_first_coalescence_events()
         else:
-            assert callable(weight_func)
-            self.weight_func = weight_func
-        _weight_func_eval = self.weight_func(0, ts.first(), self.sample_sets)
-        assert isinstance(_weight_func_eval, np.ndarray)
-        assert _weight_func_eval.ndim == 1
-        self.num_weights = len(_weight_func_eval)
+            # user supplies pair of callables ``(initialize, update)``
+            assert isinstance(weight_func, tuple)
+            assert len(weight_func) == 2
+            self._initialize, self._update = weight_func
+            assert callable(self._initialize)
+            assert callable(self._update)
+
+        # check initialization operation
+        _state = self._initialize(0, self.sample_sets)
+        assert isinstance(_state, tuple)
+        self.num_states = 0
+        self.state_indices = []
+        for x in _state:
+            # ``assert is_row_vector(x)``
+            assert isinstance(x, np.ndarray)
+            assert x.ndim == 2
+            assert x.shape[0] == 1
+            index = list(range(self.num_states, self.num_states + x.size))
+            self.state_indices.append(index)
+            self.num_states += x.size
+
+        # check update operation
+        _weights, _state = self._update(*_state)
+        assert isinstance(_state, tuple)
+        for state_index, x in zip(self.state_indices, _state):
+            # ``assert is_row_vector(x, len(state_index))``
+            assert isinstance(x, np.ndarray)
+            assert x.ndim == 2
+            assert x.shape[0] == 1
+            assert x.size == len(state_index)
+        # ``assert is_row_vector(_weights)``
+        assert isinstance(_weights, np.ndarray)
+        assert _weights.ndim == 2
+        assert _weights.shape[0] == 1
+        self.num_weights = _weights.size
 
         if window_breaks is None:
             window_breaks = np.array([0.0, ts.sequence_length])
         assert isinstance(window_breaks, np.ndarray)
         assert window_breaks.ndim == 1
         assert np.min(window_breaks) >= 0.0
         assert np.max(window_breaks) <= ts.sequence_length
@@ -495,14 +659,15 @@
         assert blocks_per_window > 0
         self.num_blocks = blocks_per_window
 
         assert isinstance(span_normalise, bool)
         self.span_normalise = span_normalise
 
         self.buffer_size = ts.num_nodes
+        self.running_array_size = ts.num_samples * 2 - 1  # assumes no unary nodes
         self.weight_func_evals = 0
         self.tables = [table for table in self._generate_ecdf_tables(ts, window_breaks)]
 
     # TODO
     #
     # def __str__(self):
     #    return self.useful_text_summary()
@@ -529,21 +694,52 @@
         values[:] = np.nan
         for k, table in enumerate(self.tables):
             indices = np.searchsorted(table.time, times, side="right") - 1
             assert all([0 <= i < table.num_records for i in indices])
             values[:, :, k] = table.quantile[indices, :].T
         return values
 
-    # TODO
-    #
-    # def quantile(self, times):
-    #   """
-    #   Return interpolated quantiles of coalescence times, using the same
-    #   approach as numpy.quantile(..., method="linear")
-    #   """
+    def quantile(self, quantiles):
+        """
+        Return interpolated quantiles of weighted coalescence times.
+        """
+
+        assert isinstance(quantiles, np.ndarray)
+        assert quantiles.ndim == 1
+        assert np.all(np.logical_and(quantiles >= 0, quantiles <= 1))
+
+        values = np.empty((self.num_weights, quantiles.size, self.num_windows))
+        values[:] = np.nan
+        for k, table in enumerate(self.tables):
+            # retrieve ECDF for each unique timepoint in table
+            last_index = np.flatnonzero(table.time[:-1] != table.time[1:])
+            time = np.append(table.time[last_index], table.time[-1])
+            ecdf = np.append(
+                table.quantile[last_index, :], table.quantile[[-1]], axis=0
+            )
+            for i in range(self.num_weights):
+                if not np.isnan(ecdf[-1, i]):
+                    # interpolation requires strictly increasing arguments, so
+                    # retrieve leftmost x for step-like F(x), including F(0) = 0.
+                    assert ecdf[-1, i] == 1.0
+                    assert ecdf[0, i] == 0.0
+                    delta = ecdf[1:, i] - ecdf[:-1, i]
+                    first_index = 1 + np.flatnonzero(delta > 0)
+
+                    n_eff = first_index.size
+                    weight = delta[first_index - 1]
+                    cum_weight = np.roll(ecdf[first_index, i], 1)
+                    cum_weight[0] = 0
+                    midpoint = np.arange(n_eff) * weight + (n_eff - 1) * cum_weight
+                    assert midpoint[0] == 0
+                    assert midpoint[-1] == n_eff - 1
+                    values[i, :, k] = np.interp(
+                        quantiles * (n_eff - 1), midpoint, time[first_index]
+                    )
+        return values
 
     def num_coalesced(self, times):
         """
         Returns number of coalescence events that have occured by the time
         points in ``times``.
 
         The output array has shape ``(self.num_weights, len(times),
@@ -593,19 +789,20 @@
         values[:] = np.nan
         for k, table in enumerate(self.tables):
             index = np.searchsorted(table.time, since, side="right")
             if index == table.num_records:
                 values[:, k] = np.nan
             else:
                 for i in range(self.num_weights):
-                    if table.cum_weights[-1, i] > 0:
-                        multiplier = table.block_multiplier[table.block[index:]]
+                    multiplier = table.block_multiplier[table.block[index:]]
+                    weights = table.weights[index:, i] * multiplier
+                    if np.any(weights > 0):
                         values[i, k] = np.average(
                             table.time[index:] - since,
-                            weights=table.weights[index:, i] * multiplier,
+                            weights=weights,
                         )
         return values
 
     def coalescence_probability_in_intervals(self, time_breaks):
         """
         Returns the proportion of coalescence events occurring in the time
         intervals defined by ``time_breaks``, out of events that have not
```

### Comparing `tskit-0.5.4/tskit/tables.py` & `tskit-0.5.5/tskit/tables.py`

 * *Files 2% similar despite different names*

```diff
@@ -608,14 +608,38 @@
         """
         Truncates this table so that the only the first ``num_rows`` are retained.
 
         :param int num_rows: The number of rows to retain in this table.
         """
         return self.ll_table.truncate(num_rows)
 
+    def keep_rows(self, keep):
+        """
+        .. include:: substitutions/table_keep_rows_main.rst
+
+        :param array-like keep: The rows to keep as a boolean array. Must
+            be the same length as the table, and convertible to a numpy
+            array of dtype bool.
+        :return: The mapping between old and new row IDs as a numpy
+            array (dtype int32).
+        :rtype: numpy.ndarray (dtype=np.int32)
+        """
+        # We do this check here rather than in the C code because calling
+        # len() on the input will cause a more readable exception to be
+        # raised than the inscrutable errors we get from numpy when
+        # converting arguments of the wrong type.
+        if len(keep) != len(self):
+            msg = (
+                "Argument for keep_rows must be a boolean array of "
+                "the same length as the table. "
+                f"(need:{len(self)}, got:{len(keep)})"
+            )
+            raise ValueError(msg)
+        return self.ll_table.keep_rows(keep)
+
     # Pickle support
     def __getstate__(self):
         return self.asdict()
 
     # Unpickle support
     def __setstate__(self, state):
         self.__init__()
@@ -1019,14 +1043,41 @@
         """
         packed, offset = util.pack_arrays(parents, np.int32)
         d = self.asdict()
         d["parents"] = packed
         d["parents_offset"] = offset
         self.set_columns(**d)
 
+    def keep_rows(self, keep):
+        """
+        .. include:: substitutions/table_keep_rows_main.rst
+
+        The values in the ``parents`` column are updated according to this
+        map, so that reference integrity within the table is maintained.
+        As a consequence of this, the values in the ``parents`` column
+        for kept rows are bounds-checked and an error raised if they
+        are not valid. Rows that are deleted are not checked for
+        parent ID integrity.
+
+        If an attempt is made to delete rows that are referred to by
+        the ``parents`` column of rows that are retained, an error
+        is raised.
+
+        These error conditions are checked before any alterations to
+        the table are made.
+
+        :param array-like keep: The rows to keep as a boolean array. Must
+            be the same length as the table, and convertible to a numpy
+            array of dtype bool.
+        :return: The mapping between old and new row IDs as a numpy
+            array (dtype int32).
+        :rtype: numpy.ndarray (dtype=np.int32)
+        """
+        return super().keep_rows(keep)
+
 
 class NodeTable(MetadataTable):
     """
     A table defining the nodes in a tree sequence. See the
     :ref:`definitions <sec_node_table_definition>` for details on the columns
     in this table and the
     :ref:`tree sequence requirements <sec_valid_tree_sequence_requirements>` section
@@ -2107,14 +2158,41 @@
         """
         packed, offset = util.pack_strings(derived_states)
         d = self.asdict()
         d["derived_state"] = packed
         d["derived_state_offset"] = offset
         self.set_columns(**d)
 
+    def keep_rows(self, keep):
+        """
+        .. include:: substitutions/table_keep_rows_main.rst
+
+        The values in the ``parent`` column are updated according to this
+        map, so that reference integrity within the table is maintained.
+        As a consequence of this, the values in the ``parent`` column
+        for kept rows are bounds-checked and an error raised if they
+        are not valid. Rows that are deleted are not checked for
+        parent ID integrity.
+
+        If an attempt is made to delete rows that are referred to by
+        the ``parent`` column of rows that are retained, an error
+        is raised.
+
+        These error conditions are checked before any alterations to
+        the table are made.
+
+        :param array-like keep: The rows to keep as a boolean array. Must
+            be the same length as the table, and convertible to a numpy
+            array of dtype bool.
+        :return: The mapping between old and new row IDs as a numpy
+            array (dtype int32).
+        :rtype: numpy.ndarray (dtype=np.int32)
+        """
+        return super().keep_rows(keep)
+
 
 class PopulationTable(MetadataTable):
     """
     A table defining the populations referred to in a tree sequence.
     The PopulationTable stores metadata for populations that may be referred to
     in the NodeTable and MigrationTable".  Note that although nodes
     may be associated with populations, this association is stored in
```

### Comparing `tskit-0.5.4/tskit/text_formats.py` & `tskit-0.5.5/tskit/text_formats.py`

 * *Files identical despite different names*

### Comparing `tskit-0.5.4/tskit/trees.py` & `tskit-0.5.5/tskit/trees.py`

 * *Files 0% similar despite different names*

```diff
@@ -1202,455 +1202,455 @@
 00004b10: 6573 6020 6d65 7468 6f64 2e0a 2020 2020  es` method..    
 00004b20: 3a70 6172 616d 2062 6f6f 6c20 7361 6d70  :param bool samp
 00004b30: 6c65 5f6c 6973 7473 3a20 4966 2054 7275  le_lists: If Tru
 00004b40: 652c 2070 726f 7669 6465 206d 6f72 6520  e, provide more 
 00004b50: 6566 6669 6369 656e 7420 6163 6365 7373  efficient access
 00004b60: 0a20 2020 2020 2020 2074 6f20 7468 6520  .        to the 
 00004b70: 7361 6d70 6c65 7320 6265 6e65 6174 6820  samples beneath 
-00004b80: 6120 6769 7665 206e 6f64 6520 7573 696e  a give node usin
-00004b90: 6720 7468 650a 2020 2020 2020 2020 3a6d  g the.        :m
-00004ba0: 6574 683a 6054 7265 652e 7361 6d70 6c65  eth:`Tree.sample
-00004bb0: 7360 206d 6574 686f 642e 0a20 2020 203a  s` method..    :
-00004bc0: 7061 7261 6d20 696e 7420 726f 6f74 5f74  param int root_t
-00004bd0: 6872 6573 686f 6c64 3a20 5468 6520 6d69  hreshold: The mi
-00004be0: 6e69 6d75 6d20 6e75 6d62 6572 206f 6620  nimum number of 
-00004bf0: 7361 6d70 6c65 7320 7468 6174 2061 206e  samples that a n
-00004c00: 6f64 650a 2020 2020 2020 2020 6d75 7374  ode.        must
-00004c10: 2062 6520 616e 6365 7374 7261 6c20 746f   be ancestral to
-00004c20: 2066 6f72 2069 7420 746f 2062 6520 696e   for it to be in
-00004c30: 2074 6865 206c 6973 7420 6f66 2072 6f6f   the list of roo
-00004c40: 7473 2e20 4279 2064 6566 6175 6c74 0a20  ts. By default. 
-00004c50: 2020 2020 2020 2074 6869 7320 6973 2031         this is 1
-00004c60: 2c20 736f 2074 6861 7420 6973 6f6c 6174  , so that isolat
-00004c70: 6564 2073 616d 706c 6573 2028 7265 7072  ed samples (repr
-00004c80: 6573 656e 7469 6e67 206d 6973 7369 6e67  esenting missing
-00004c90: 2064 6174 6129 0a20 2020 2020 2020 2061   data).        a
-00004ca0: 7265 2072 6f6f 7473 2e20 546f 2065 6666  re roots. To eff
-00004cb0: 6963 6965 6e74 6c79 2072 6573 7472 6963  iciently restric
-00004cc0: 7420 7468 6520 726f 6f74 7320 6f66 2074  t the roots of t
-00004cd0: 6865 2074 7265 6520 746f 0a20 2020 2020  he tree to.     
-00004ce0: 2020 2074 686f 7365 2073 7562 7465 6e64     those subtend
-00004cf0: 696e 6720 6d65 616e 696e 6766 756c 2074  ing meaningful t
-00004d00: 6f70 6f6c 6f67 792c 2073 6574 2074 6869  opology, set thi
-00004d10: 7320 746f 2032 2e20 5468 6973 2076 616c  s to 2. This val
-00004d20: 7565 0a20 2020 2020 2020 2069 7320 6f6e  ue.        is on
-00004d30: 6c79 2072 656c 6576 616e 7420 7768 656e  ly relevant when
-00004d40: 2074 7265 6573 2068 6176 6520 6d75 6c74   trees have mult
-00004d50: 6970 6c65 2072 6f6f 7473 2e0a 2020 2020  iple roots..    
-00004d60: 3a70 6172 616d 2062 6f6f 6c20 7361 6d70  :param bool samp
-00004d70: 6c65 5f63 6f75 6e74 733a 2044 6570 7265  le_counts: Depre
-00004d80: 6361 7465 6420 7369 6e63 6520 302e 322e  cated since 0.2.
-00004d90: 342e 0a20 2020 2022 2222 0a0a 2020 2020  4..    """..    
-00004da0: 6465 6620 5f5f 696e 6974 5f5f 280a 2020  def __init__(.  
-00004db0: 2020 2020 2020 7365 6c66 2c0a 2020 2020        self,.    
-00004dc0: 2020 2020 7472 6565 5f73 6571 7565 6e63      tree_sequenc
-00004dd0: 652c 0a20 2020 2020 2020 2074 7261 636b  e,.        track
-00004de0: 6564 5f73 616d 706c 6573 3d4e 6f6e 652c  ed_samples=None,
-00004df0: 0a20 2020 2020 2020 202a 2c0a 2020 2020  .        *,.    
-00004e00: 2020 2020 7361 6d70 6c65 5f6c 6973 7473      sample_lists
-00004e10: 3d46 616c 7365 2c0a 2020 2020 2020 2020  =False,.        
-00004e20: 726f 6f74 5f74 6872 6573 686f 6c64 3d31  root_threshold=1
-00004e30: 2c0a 2020 2020 2020 2020 7361 6d70 6c65  ,.        sample
-00004e40: 5f63 6f75 6e74 733d 4e6f 6e65 2c0a 2020  _counts=None,.  
-00004e50: 2020 293a 0a20 2020 2020 2020 206f 7074    ):.        opt
-00004e60: 696f 6e73 203d 2030 0a20 2020 2020 2020  ions = 0.       
-00004e70: 2069 6620 7361 6d70 6c65 5f63 6f75 6e74   if sample_count
-00004e80: 7320 6973 206e 6f74 204e 6f6e 653a 0a20  s is not None:. 
-00004e90: 2020 2020 2020 2020 2020 2077 6172 6e69             warni
-00004ea0: 6e67 732e 7761 726e 280a 2020 2020 2020  ngs.warn(.      
-00004eb0: 2020 2020 2020 2020 2020 2254 6865 2073            "The s
-00004ec0: 616d 706c 655f 636f 756e 7473 206f 7074  ample_counts opt
-00004ed0: 696f 6e20 6973 206e 6f74 2073 7570 706f  ion is not suppo
-00004ee0: 7274 6564 2073 696e 6365 2030 2e32 2e34  rted since 0.2.4
-00004ef0: 2022 0a20 2020 2020 2020 2020 2020 2020   ".             
-00004f00: 2020 2022 616e 6420 6973 2069 676e 6f72     "and is ignor
-00004f10: 6564 222c 0a20 2020 2020 2020 2020 2020  ed",.           
-00004f20: 2020 2020 2052 756e 7469 6d65 5761 726e       RuntimeWarn
-00004f30: 696e 672c 0a20 2020 2020 2020 2020 2020  ing,.           
-00004f40: 2029 0a20 2020 2020 2020 2069 6620 7361   ).        if sa
-00004f50: 6d70 6c65 5f6c 6973 7473 3a0a 2020 2020  mple_lists:.    
-00004f60: 2020 2020 2020 2020 6f70 7469 6f6e 7320          options 
-00004f70: 7c3d 205f 7473 6b69 742e 5341 4d50 4c45  |= _tskit.SAMPLE
-00004f80: 5f4c 4953 5453 0a20 2020 2020 2020 206b  _LISTS.        k
-00004f90: 7761 7267 7320 3d20 7b22 6f70 7469 6f6e  wargs = {"option
-00004fa0: 7322 3a20 6f70 7469 6f6e 737d 0a20 2020  s": options}.   
-00004fb0: 2020 2020 2069 6620 726f 6f74 5f74 6872       if root_thr
-00004fc0: 6573 686f 6c64 203c 3d20 303a 0a20 2020  eshold <= 0:.   
-00004fd0: 2020 2020 2020 2020 2072 6169 7365 2056           raise V
-00004fe0: 616c 7565 4572 726f 7228 2252 6f6f 7420  alueError("Root 
-00004ff0: 7468 7265 7368 6f6c 6420 6d75 7374 2062  threshold must b
-00005000: 6520 6772 6561 7465 7220 7468 616e 2030  e greater than 0
-00005010: 2229 0a20 2020 2020 2020 2069 6620 7472  ").        if tr
-00005020: 6163 6b65 645f 7361 6d70 6c65 7320 6973  acked_samples is
-00005030: 206e 6f74 204e 6f6e 653a 0a20 2020 2020   not None:.     
-00005040: 2020 2020 2020 2023 2054 4f44 4f20 7265         # TODO re
-00005050: 6d6f 7665 2074 6869 7320 7768 656e 2077  move this when w
-00005060: 6520 616c 6c6f 7720 6e75 6d70 7920 6172  e allow numpy ar
-00005070: 7261 7973 2069 6e20 7468 6520 6c6f 772d  rays in the low-
-00005080: 6c65 7665 6c20 4150 492e 0a20 2020 2020  level API..     
-00005090: 2020 2020 2020 206b 7761 7267 735b 2274         kwargs["t
-000050a0: 7261 636b 6564 5f73 616d 706c 6573 225d  racked_samples"]
-000050b0: 203d 206c 6973 7428 7472 6163 6b65 645f   = list(tracked_
-000050c0: 7361 6d70 6c65 7329 0a0a 2020 2020 2020  samples)..      
-000050d0: 2020 7365 6c66 2e5f 7472 6565 5f73 6571    self._tree_seq
-000050e0: 7565 6e63 6520 3d20 7472 6565 5f73 6571  uence = tree_seq
-000050f0: 7565 6e63 650a 2020 2020 2020 2020 7365  uence.        se
-00005100: 6c66 2e5f 6c6c 5f74 7265 6520 3d20 5f74  lf._ll_tree = _t
-00005110: 736b 6974 2e54 7265 6528 7472 6565 5f73  skit.Tree(tree_s
-00005120: 6571 7565 6e63 652e 6c6c 5f74 7265 655f  equence.ll_tree_
-00005130: 7365 7175 656e 6365 2c20 2a2a 6b77 6172  sequence, **kwar
-00005140: 6773 290a 2020 2020 2020 2020 7365 6c66  gs).        self
-00005150: 2e5f 6c6c 5f74 7265 652e 7365 745f 726f  ._ll_tree.set_ro
-00005160: 6f74 5f74 6872 6573 686f 6c64 2872 6f6f  ot_threshold(roo
-00005170: 745f 7468 7265 7368 6f6c 6429 0a20 2020  t_threshold).   
-00005180: 2020 2020 2073 656c 662e 5f6d 616b 655f       self._make_
-00005190: 6172 7261 7973 2829 0a0a 2020 2020 6465  arrays()..    de
-000051a0: 6620 636f 7079 2873 656c 6629 3a0a 2020  f copy(self):.  
-000051b0: 2020 2020 2020 2222 220a 2020 2020 2020        """.      
-000051c0: 2020 5265 7475 726e 7320 6120 6465 6570    Returns a deep
-000051d0: 2063 6f70 7920 6f66 2074 6869 7320 7472   copy of this tr
-000051e0: 6565 2e20 5468 6520 7265 7475 726e 6564  ee. The returned
-000051f0: 2074 7265 6520 7769 6c6c 2068 6176 6520   tree will have 
-00005200: 6964 656e 7469 6361 6c20 7374 6174 650a  identical state.
-00005210: 2020 2020 2020 2020 746f 2074 6869 7320          to this 
-00005220: 7472 6565 2e0a 0a20 2020 2020 2020 203a  tree...        :
-00005230: 7265 7475 726e 3a20 4120 636f 7079 206f  return: A copy o
-00005240: 6620 7468 6973 2074 7265 652e 0a20 2020  f this tree..   
-00005250: 2020 2020 203a 7274 7970 653a 2054 7265       :rtype: Tre
-00005260: 650a 2020 2020 2020 2020 2222 220a 2020  e.        """.  
-00005270: 2020 2020 2020 636f 7079 203d 2074 7970        copy = typ
-00005280: 6528 7365 6c66 292e 5f5f 6e65 775f 5f28  e(self).__new__(
-00005290: 7479 7065 2873 656c 6629 290a 2020 2020  type(self)).    
-000052a0: 2020 2020 636f 7079 2e5f 7472 6565 5f73      copy._tree_s
-000052b0: 6571 7565 6e63 6520 3d20 7365 6c66 2e5f  equence = self._
-000052c0: 7472 6565 5f73 6571 7565 6e63 650a 2020  tree_sequence.  
-000052d0: 2020 2020 2020 636f 7079 2e5f 6c6c 5f74        copy._ll_t
-000052e0: 7265 6520 3d20 7365 6c66 2e5f 6c6c 5f74  ree = self._ll_t
-000052f0: 7265 652e 636f 7079 2829 0a20 2020 2020  ree.copy().     
-00005300: 2020 2063 6f70 792e 5f6d 616b 655f 6172     copy._make_ar
-00005310: 7261 7973 2829 0a20 2020 2020 2020 2072  rays().        r
-00005320: 6574 7572 6e20 636f 7079 0a0a 2020 2020  eturn copy..    
-00005330: 2320 544f 444f 206d 616b 6520 7468 6973  # TODO make this
-00005340: 206d 6574 686f 6420 7075 626c 6963 2061   method public a
-00005350: 6e64 2064 6f63 756d 656e 7420 6974 2e0a  nd document it..
-00005360: 2020 2020 2320 4e6f 7465 2074 6861 7420      # Note that 
-00005370: 7468 6973 2070 726f 6261 626c 7920 646f  this probably do
-00005380: 6573 206e 6f74 2063 6f76 6572 2061 6c6c  es not cover all
-00005390: 2063 6f72 6e65 7220 6361 7365 7320 636f   corner cases co
-000053a0: 7272 6563 746c 790a 2020 2020 2320 6874  rrectly.    # ht
-000053b0: 7470 733a 2f2f 6769 7468 7562 2e63 6f6d  tps://github.com
-000053c0: 2f74 736b 6974 2d64 6576 2f74 736b 6974  /tskit-dev/tskit
-000053d0: 2f69 7373 7565 732f 3139 3038 0a20 2020  /issues/1908.   
-000053e0: 2064 6566 205f 6861 735f 6973 6f6c 6174   def _has_isolat
-000053f0: 6564 5f73 616d 706c 6573 2873 656c 6629  ed_samples(self)
-00005400: 3a0a 2020 2020 2020 2020 2320 544f 444f  :.        # TODO
-00005410: 2049 7320 7468 6973 2064 6566 696e 6974   Is this definit
-00005420: 696f 6e20 636f 7272 6563 7420 666f 7220  ion correct for 
-00005430: 6120 7369 6e67 6c65 2d6e 6f64 6520 7472  a single-node tr
-00005440: 6565 2073 6571 7565 6e63 653f 0a20 2020  ee sequence?.   
-00005450: 2020 2020 2066 6f72 2072 6f6f 7420 696e       for root in
-00005460: 2073 656c 662e 726f 6f74 733a 0a20 2020   self.roots:.   
-00005470: 2020 2020 2020 2020 2023 2049 6620 7468           # If th
-00005480: 6520 726f 6f74 2068 6173 206e 6f20 6368  e root has no ch
-00005490: 696c 6472 656e 2074 6865 6e20 6974 206d  ildren then it m
-000054a0: 7573 7420 6265 2061 2073 616d 706c 650a  ust be a sample.
-000054b0: 2020 2020 2020 2020 2020 2020 6966 2073              if s
-000054c0: 656c 662e 6c65 6674 5f63 6869 6c64 2872  elf.left_child(r
-000054d0: 6f6f 7429 203d 3d20 4e55 4c4c 3a0a 2020  oot) == NULL:.  
-000054e0: 2020 2020 2020 2020 2020 2020 2020 7265                re
-000054f0: 7475 726e 2054 7275 650a 2020 2020 2020  turn True.      
-00005500: 2020 7265 7475 726e 2046 616c 7365 0a0a    return False..
-00005510: 2020 2020 6465 6620 5f6d 616b 655f 6172      def _make_ar
-00005520: 7261 7973 2873 656c 6629 3a0a 2020 2020  rays(self):.    
-00005530: 2020 2020 2320 5374 6f72 6520 7468 6520      # Store the 
-00005540: 6c6f 772d 6c65 7665 6c20 6172 7261 7973  low-level arrays
-00005550: 2066 6f72 2065 6666 6963 6965 6e63 792e   for efficiency.
-00005560: 2054 6865 7265 2773 206e 6f20 7265 616c   There's no real
-00005570: 206f 7665 7268 6561 640a 2020 2020 2020   overhead.      
-00005580: 2020 2320 696e 2074 6869 732c 2062 6563    # in this, bec
-00005590: 6175 7365 2074 6865 2072 6566 6572 2074  ause the refer t
-000055a0: 6f20 7468 6520 7361 6d65 2075 6e64 6572  o the same under
-000055b0: 6c79 696e 6720 6d65 6d6f 7279 2061 7320  lying memory as 
-000055c0: 7468 650a 2020 2020 2020 2020 2320 7472  the.        # tr
-000055d0: 6565 206f 626a 6563 742e 0a20 2020 2020  ee object..     
-000055e0: 2020 2073 656c 662e 5f70 6172 656e 745f     self._parent_
-000055f0: 6172 7261 7920 3d20 7365 6c66 2e5f 6c6c  array = self._ll
-00005600: 5f74 7265 652e 7061 7265 6e74 5f61 7272  _tree.parent_arr
-00005610: 6179 0a20 2020 2020 2020 2073 656c 662e  ay.        self.
-00005620: 5f6c 6566 745f 6368 696c 645f 6172 7261  _left_child_arra
-00005630: 7920 3d20 7365 6c66 2e5f 6c6c 5f74 7265  y = self._ll_tre
-00005640: 652e 6c65 6674 5f63 6869 6c64 5f61 7272  e.left_child_arr
-00005650: 6179 0a20 2020 2020 2020 2073 656c 662e  ay.        self.
-00005660: 5f72 6967 6874 5f63 6869 6c64 5f61 7272  _right_child_arr
-00005670: 6179 203d 2073 656c 662e 5f6c 6c5f 7472  ay = self._ll_tr
-00005680: 6565 2e72 6967 6874 5f63 6869 6c64 5f61  ee.right_child_a
-00005690: 7272 6179 0a20 2020 2020 2020 2073 656c  rray.        sel
-000056a0: 662e 5f6c 6566 745f 7369 625f 6172 7261  f._left_sib_arra
-000056b0: 7920 3d20 7365 6c66 2e5f 6c6c 5f74 7265  y = self._ll_tre
-000056c0: 652e 6c65 6674 5f73 6962 5f61 7272 6179  e.left_sib_array
-000056d0: 0a20 2020 2020 2020 2073 656c 662e 5f72  .        self._r
-000056e0: 6967 6874 5f73 6962 5f61 7272 6179 203d  ight_sib_array =
-000056f0: 2073 656c 662e 5f6c 6c5f 7472 6565 2e72   self._ll_tree.r
-00005700: 6967 6874 5f73 6962 5f61 7272 6179 0a20  ight_sib_array. 
-00005710: 2020 2020 2020 2073 656c 662e 5f6e 756d         self._num
-00005720: 5f63 6869 6c64 7265 6e5f 6172 7261 7920  _children_array 
-00005730: 3d20 7365 6c66 2e5f 6c6c 5f74 7265 652e  = self._ll_tree.
-00005740: 6e75 6d5f 6368 696c 6472 656e 5f61 7272  num_children_arr
-00005750: 6179 0a20 2020 2020 2020 2073 656c 662e  ay.        self.
-00005760: 5f65 6467 655f 6172 7261 7920 3d20 7365  _edge_array = se
-00005770: 6c66 2e5f 6c6c 5f74 7265 652e 6564 6765  lf._ll_tree.edge
-00005780: 5f61 7272 6179 0a0a 2020 2020 4070 726f  _array..    @pro
-00005790: 7065 7274 790a 2020 2020 6465 6620 7472  perty.    def tr
-000057a0: 6565 5f73 6571 7565 6e63 6528 7365 6c66  ee_sequence(self
-000057b0: 293a 0a20 2020 2020 2020 2022 2222 0a20  ):.        """. 
-000057c0: 2020 2020 2020 2052 6574 7572 6e73 2074         Returns t
-000057d0: 6865 2074 7265 6520 7365 7175 656e 6365  he tree sequence
-000057e0: 2074 6861 7420 7468 6973 2074 7265 6520   that this tree 
-000057f0: 6973 2066 726f 6d2e 0a0a 2020 2020 2020  is from...      
-00005800: 2020 3a72 6574 7572 6e3a 2054 6865 2070    :return: The p
-00005810: 6172 656e 7420 7472 6565 2073 6571 7565  arent tree seque
-00005820: 6e63 6520 666f 7220 7468 6973 2074 7265  nce for this tre
-00005830: 652e 0a20 2020 2020 2020 203a 7274 7970  e..        :rtyp
-00005840: 653a 203a 636c 6173 733a 6054 7265 6553  e: :class:`TreeS
-00005850: 6571 7565 6e63 6560 0a20 2020 2020 2020  equence`.       
-00005860: 2022 2222 0a20 2020 2020 2020 2072 6574   """.        ret
-00005870: 7572 6e20 7365 6c66 2e5f 7472 6565 5f73  urn self._tree_s
-00005880: 6571 7565 6e63 650a 0a20 2020 2040 7072  equence..    @pr
-00005890: 6f70 6572 7479 0a20 2020 2064 6566 2072  operty.    def r
-000058a0: 6f6f 745f 7468 7265 7368 6f6c 6428 7365  oot_threshold(se
-000058b0: 6c66 293a 0a20 2020 2020 2020 2022 2222  lf):.        """
-000058c0: 0a20 2020 2020 2020 2052 6574 7572 6e73  .        Returns
-000058d0: 2074 6865 206d 696e 696d 756d 206e 756d   the minimum num
-000058e0: 6265 7220 6f66 2073 616d 706c 6573 2074  ber of samples t
-000058f0: 6861 7420 6120 6e6f 6465 206d 7573 7420  hat a node must 
-00005900: 6265 2061 6e20 616e 6365 7374 6f72 0a20  be an ancestor. 
-00005910: 2020 2020 2020 206f 6620 746f 2062 6520         of to be 
-00005920: 636f 6e73 6964 6572 6564 2061 2070 6f74  considered a pot
-00005930: 656e 7469 616c 2072 6f6f 742e 2054 6869  ential root. Thi
-00005940: 7320 6361 6e20 6265 2073 6574 2c20 666f  s can be set, fo
-00005950: 7220 6578 616d 706c 652c 2077 6865 6e0a  r example, when.
-00005960: 2020 2020 2020 2020 6361 6c6c 696e 6720          calling 
-00005970: 7468 6520 3a6d 6574 683a 6054 7265 6553  the :meth:`TreeS
-00005980: 6571 7565 6e63 652e 7472 6565 7360 2069  equence.trees` i
-00005990: 7465 7261 746f 722e 0a0a 2020 2020 2020  terator...      
-000059a0: 2020 3a72 6574 7572 6e3a 2054 6865 2072    :return: The r
-000059b0: 6f6f 7420 7468 7265 7368 6f6c 642e 0a20  oot threshold.. 
-000059c0: 2020 2020 2020 203a 7274 7970 653a 203a         :rtype: :
-000059d0: 636c 6173 733a 6054 7265 6553 6571 7565  class:`TreeSeque
-000059e0: 6e63 6560 0a20 2020 2020 2020 2022 2222  nce`.        """
-000059f0: 0a20 2020 2020 2020 2072 6574 7572 6e20  .        return 
-00005a00: 7365 6c66 2e5f 6c6c 5f74 7265 652e 6765  self._ll_tree.ge
-00005a10: 745f 726f 6f74 5f74 6872 6573 686f 6c64  t_root_threshold
-00005a20: 2829 0a0a 2020 2020 6465 6620 5f5f 6571  ()..    def __eq
-00005a30: 5f5f 2873 656c 662c 206f 7468 6572 293a  __(self, other):
-00005a40: 0a20 2020 2020 2020 2072 6574 203d 2046  .        ret = F
-00005a50: 616c 7365 0a20 2020 2020 2020 2069 6620  alse.        if 
-00005a60: 7479 7065 286f 7468 6572 2920 6973 2074  type(other) is t
-00005a70: 7970 6528 7365 6c66 293a 0a20 2020 2020  ype(self):.     
-00005a80: 2020 2020 2020 2072 6574 203d 2062 6f6f         ret = boo
-00005a90: 6c28 7365 6c66 2e5f 6c6c 5f74 7265 652e  l(self._ll_tree.
-00005aa0: 6571 7561 6c73 286f 7468 6572 2e5f 6c6c  equals(other._ll
-00005ab0: 5f74 7265 6529 290a 2020 2020 2020 2020  _tree)).        
-00005ac0: 7265 7475 726e 2072 6574 0a0a 2020 2020  return ret..    
-00005ad0: 6465 6620 5f5f 6e65 5f5f 2873 656c 662c  def __ne__(self,
-00005ae0: 206f 7468 6572 293a 0a20 2020 2020 2020   other):.       
-00005af0: 2072 6574 7572 6e20 6e6f 7420 7365 6c66   return not self
-00005b00: 2e5f 5f65 715f 5f28 6f74 6865 7229 0a0a  .__eq__(other)..
-00005b10: 2020 2020 6465 6620 6669 7273 7428 7365      def first(se
-00005b20: 6c66 293a 0a20 2020 2020 2020 2022 2222  lf):.        """
-00005b30: 0a20 2020 2020 2020 2053 6565 6b73 2074  .        Seeks t
-00005b40: 6f20 7468 6520 6669 7273 7420 7472 6565  o the first tree
-00005b50: 2069 6e20 7468 6520 7365 7175 656e 6365   in the sequence
-00005b60: 2e20 5468 6973 2063 616e 2062 6520 6361  . This can be ca
-00005b70: 6c6c 6564 2077 6865 7468 6572 0a20 2020  lled whether.   
-00005b80: 2020 2020 2074 6865 2074 7265 6520 6973       the tree is
-00005b90: 2069 6e20 7468 6520 6e75 6c6c 2073 7461   in the null sta
-00005ba0: 7465 206f 7220 6e6f 742e 0a20 2020 2020  te or not..     
-00005bb0: 2020 2022 2222 0a20 2020 2020 2020 2073     """.        s
-00005bc0: 656c 662e 5f6c 6c5f 7472 6565 2e66 6972  elf._ll_tree.fir
-00005bd0: 7374 2829 0a0a 2020 2020 6465 6620 6c61  st()..    def la
-00005be0: 7374 2873 656c 6629 3a0a 2020 2020 2020  st(self):.      
-00005bf0: 2020 2222 220a 2020 2020 2020 2020 5365    """.        Se
-00005c00: 656b 7320 746f 2074 6865 206c 6173 7420  eks to the last 
-00005c10: 7472 6565 2069 6e20 7468 6520 7365 7175  tree in the sequ
-00005c20: 656e 6365 2e20 5468 6973 2063 616e 2062  ence. This can b
-00005c30: 6520 6361 6c6c 6564 2077 6865 7468 6572  e called whether
-00005c40: 0a20 2020 2020 2020 2074 6865 2074 7265  .        the tre
-00005c50: 6520 6973 2069 6e20 7468 6520 6e75 6c6c  e is in the null
-00005c60: 2073 7461 7465 206f 7220 6e6f 742e 0a20   state or not.. 
-00005c70: 2020 2020 2020 2022 2222 0a20 2020 2020         """.     
-00005c80: 2020 2073 656c 662e 5f6c 6c5f 7472 6565     self._ll_tree
-00005c90: 2e6c 6173 7428 290a 0a20 2020 2064 6566  .last()..    def
-00005ca0: 206e 6578 7428 7365 6c66 293a 2020 2320   next(self):  # 
-00005cb0: 6e6f 7161 2041 3030 320a 2020 2020 2020  noqa A002.      
-00005cc0: 2020 2222 220a 2020 2020 2020 2020 5365    """.        Se
-00005cd0: 656b 7320 746f 2074 6865 206e 6578 7420  eks to the next 
-00005ce0: 7472 6565 2069 6e20 7468 6520 7365 7175  tree in the sequ
-00005cf0: 656e 6365 2e20 4966 2074 6865 2074 7265  ence. If the tre
-00005d00: 6520 6973 2069 6e20 7468 6520 696e 6974  e is in the init
-00005d10: 6961 6c0a 2020 2020 2020 2020 6e75 6c6c  ial.        null
-00005d20: 2073 7461 7465 2077 6520 7365 656b 2074   state we seek t
-00005d30: 6f20 7468 6520 6669 7273 7420 7472 6565  o the first tree
-00005d40: 2028 6571 7569 7661 6c65 6e74 2074 6f20   (equivalent to 
-00005d50: 6361 6c6c 696e 6720 3a6d 6574 683a 607e  calling :meth:`~
-00005d60: 5472 6565 2e66 6972 7374 6029 2e0a 2020  Tree.first`)..  
-00005d70: 2020 2020 2020 4361 6c6c 696e 6720 6060        Calling ``
-00005d80: 6e65 7874 6060 206f 6e20 7468 6520 6c61  next`` on the la
-00005d90: 7374 2074 7265 6520 696e 2074 6865 2073  st tree in the s
-00005da0: 6571 7565 6e63 6520 7265 7375 6c74 7320  equence results 
-00005db0: 696e 2074 6865 2074 7265 650a 2020 2020  in the tree.    
-00005dc0: 2020 2020 6265 696e 6720 636c 6561 7265      being cleare
-00005dd0: 6420 6261 636b 2069 6e74 6f20 7468 6520  d back into the 
-00005de0: 6e75 6c6c 2069 6e69 7469 616c 2073 7461  null initial sta
-00005df0: 7465 2028 6571 7569 7661 6c65 6e74 2074  te (equivalent t
-00005e00: 6f20 6361 6c6c 696e 670a 2020 2020 2020  o calling.      
-00005e10: 2020 3a6d 6574 683a 607e 5472 6565 2e63    :meth:`~Tree.c
-00005e20: 6c65 6172 6029 2e20 5468 6520 7265 7475  lear`). The retu
-00005e30: 726e 2076 616c 7565 206f 6620 7468 6520  rn value of the 
-00005e40: 6675 6e63 7469 6f6e 2069 6e64 6963 6174  function indicat
-00005e50: 6573 2077 6865 7468 6572 2074 6865 0a20  es whether the. 
-00005e60: 2020 2020 2020 2074 7265 6520 6973 2069         tree is i
-00005e70: 6e20 6120 6e6f 6e2d 6e75 6c6c 2073 7461  n a non-null sta
-00005e80: 7465 2c20 616e 6420 6361 6e20 6265 2075  te, and can be u
-00005e90: 7365 6420 746f 206c 6f6f 7020 6f76 6572  sed to loop over
-00005ea0: 2074 6865 2074 7265 6573 3a3a 0a0a 2020   the trees::..  
-00005eb0: 2020 2020 2020 2020 2020 2320 4974 6572            # Iter
-00005ec0: 6174 6520 6f76 6572 2074 6865 2074 7265  ate over the tre
-00005ed0: 6573 2066 726f 6d20 6c65 6674 2d74 6f2d  es from left-to-
-00005ee0: 7269 6768 740a 2020 2020 2020 2020 2020  right.          
-00005ef0: 2020 7472 6565 203d 2074 736b 6974 2e54    tree = tskit.T
-00005f00: 7265 6528 7472 6565 5f73 6571 7565 6e63  ree(tree_sequenc
-00005f10: 6529 0a20 2020 2020 2020 2020 2020 2077  e).            w
-00005f20: 6869 6c65 2074 7265 652e 6e65 7874 2829  hile tree.next()
-00005f30: 0a20 2020 2020 2020 2020 2020 2020 2020  .               
-00005f40: 2023 2044 6f20 736f 6d65 7468 696e 6720   # Do something 
-00005f50: 7769 7468 2074 6865 2074 7265 652e 0a20  with the tree.. 
-00005f60: 2020 2020 2020 2020 2020 2020 2020 2070                 p
-00005f70: 7269 6e74 2874 7265 652e 696e 6465 7829  rint(tree.index)
-00005f80: 0a20 2020 2020 2020 2020 2020 2023 2074  .            # t
-00005f90: 7265 6520 6973 206e 6f77 2062 6163 6b20  ree is now back 
-00005fa0: 696e 2074 6865 206e 756c 6c20 7374 6174  in the null stat
-00005fb0: 652e 0a0a 2020 2020 2020 2020 3a72 6574  e...        :ret
-00005fc0: 7572 6e3a 2054 7275 6520 6966 2074 6865  urn: True if the
-00005fd0: 2074 7265 6520 6861 7320 6265 656e 2074   tree has been t
-00005fe0: 7261 6e73 666f 726d 6564 2069 6e74 6f20  ransformed into 
-00005ff0: 6f6e 6520 6f66 2074 6865 2074 7265 6573  one of the trees
-00006000: 0a20 2020 2020 2020 2020 2020 2069 6e20  .            in 
-00006010: 7468 6520 7365 7175 656e 6365 3b20 4661  the sequence; Fa
-00006020: 6c73 6520 6966 2074 6865 2074 7265 6520  lse if the tree 
-00006030: 6861 7320 6265 656e 2074 7261 6e73 666f  has been transfo
-00006040: 726d 6564 2069 6e74 6f20 7468 650a 2020  rmed into the.  
-00006050: 2020 2020 2020 2020 2020 6e75 6c6c 2073            null s
-00006060: 7461 7465 2e0a 2020 2020 2020 2020 3a72  tate..        :r
-00006070: 7479 7065 3a20 626f 6f6c 0a20 2020 2020  type: bool.     
-00006080: 2020 2022 2222 0a20 2020 2020 2020 2072     """.        r
-00006090: 6574 7572 6e20 626f 6f6c 2873 656c 662e  eturn bool(self.
-000060a0: 5f6c 6c5f 7472 6565 2e6e 6578 7428 2929  _ll_tree.next())
-000060b0: 0a0a 2020 2020 6465 6620 7072 6576 2873  ..    def prev(s
-000060c0: 656c 6629 3a0a 2020 2020 2020 2020 2222  elf):.        ""
-000060d0: 220a 2020 2020 2020 2020 5365 656b 7320  ".        Seeks 
-000060e0: 746f 2074 6865 2070 7265 7669 6f75 7320  to the previous 
-000060f0: 7472 6565 2069 6e20 7468 6520 7365 7175  tree in the sequ
-00006100: 656e 6365 2e20 4966 2074 6865 2074 7265  ence. If the tre
-00006110: 6520 6973 2069 6e20 7468 6520 696e 6974  e is in the init
-00006120: 6961 6c0a 2020 2020 2020 2020 6e75 6c6c  ial.        null
-00006130: 2073 7461 7465 2077 6520 7365 656b 2074   state we seek t
-00006140: 6f20 7468 6520 6c61 7374 2074 7265 6520  o the last tree 
-00006150: 2865 7175 6976 616c 656e 7420 746f 2063  (equivalent to c
-00006160: 616c 6c69 6e67 203a 6d65 7468 3a60 7e54  alling :meth:`~T
-00006170: 7265 652e 6c61 7374 6029 2e0a 2020 2020  ree.last`)..    
-00006180: 2020 2020 4361 6c6c 696e 6720 6060 7072      Calling ``pr
-00006190: 6576 6060 206f 6e20 7468 6520 6669 7273  ev`` on the firs
-000061a0: 7420 7472 6565 2069 6e20 7468 6520 7365  t tree in the se
-000061b0: 7175 656e 6365 2072 6573 756c 7473 2069  quence results i
-000061c0: 6e20 7468 6520 7472 6565 0a20 2020 2020  n the tree.     
-000061d0: 2020 2062 6569 6e67 2063 6c65 6172 6564     being cleared
-000061e0: 2062 6163 6b20 696e 746f 2074 6865 206e   back into the n
-000061f0: 756c 6c20 696e 6974 6961 6c20 7374 6174  ull initial stat
-00006200: 6520 2865 7175 6976 616c 656e 7420 746f  e (equivalent to
-00006210: 2063 616c 6c69 6e67 0a20 2020 2020 2020   calling.       
-00006220: 203a 6d65 7468 3a60 7e54 7265 652e 636c   :meth:`~Tree.cl
-00006230: 6561 7260 292e 2054 6865 2072 6574 7572  ear`). The retur
-00006240: 6e20 7661 6c75 6520 6f66 2074 6865 2066  n value of the f
-00006250: 756e 6374 696f 6e20 696e 6469 6361 7465  unction indicate
-00006260: 7320 7768 6574 6865 7220 7468 650a 2020  s whether the.  
-00006270: 2020 2020 2020 7472 6565 2069 7320 696e        tree is in
-00006280: 2061 206e 6f6e 2d6e 756c 6c20 7374 6174   a non-null stat
-00006290: 652c 2061 6e64 2063 616e 2062 6520 7573  e, and can be us
-000062a0: 6564 2074 6f20 6c6f 6f70 206f 7665 7220  ed to loop over 
-000062b0: 7468 6520 7472 6565 733a 3a0a 0a20 2020  the trees::..   
-000062c0: 2020 2020 2020 2020 2023 2049 7465 7261           # Itera
-000062d0: 7465 206f 7665 7220 7468 6520 7472 6565  te over the tree
-000062e0: 7320 6672 6f6d 2072 6967 6874 2d74 6f2d  s from right-to-
-000062f0: 6c65 6674 0a20 2020 2020 2020 2020 2020  left.           
-00006300: 2074 7265 6520 3d20 7473 6b69 742e 5472   tree = tskit.Tr
-00006310: 6565 2874 7265 655f 7365 7175 656e 6365  ee(tree_sequence
-00006320: 290a 2020 2020 2020 2020 2020 2020 7768  ).            wh
-00006330: 696c 6520 7472 6565 2e70 7265 7628 290a  ile tree.prev().
-00006340: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00006350: 2320 446f 2073 6f6d 6574 6869 6e67 2077  # Do something w
-00006360: 6974 6820 7468 6520 7472 6565 2e0a 2020  ith the tree..  
-00006370: 2020 2020 2020 2020 2020 2020 2020 7072                pr
-00006380: 696e 7428 7472 6565 2e69 6e64 6578 290a  int(tree.index).
-00006390: 2020 2020 2020 2020 2020 2020 2320 7472              # tr
-000063a0: 6565 2069 7320 6e6f 7720 6261 636b 2069  ee is now back i
-000063b0: 6e20 7468 6520 6e75 6c6c 2073 7461 7465  n the null state
-000063c0: 2e0a 0a20 2020 2020 2020 203a 7265 7475  ...        :retu
-000063d0: 726e 3a20 5472 7565 2069 6620 7468 6520  rn: True if the 
-000063e0: 7472 6565 2068 6173 2062 6565 6e20 7472  tree has been tr
-000063f0: 616e 7366 6f72 6d65 6420 696e 746f 206f  ansformed into o
-00006400: 6e65 206f 6620 7468 6520 7472 6565 730a  ne of the trees.
-00006410: 2020 2020 2020 2020 2020 2020 696e 2074              in t
-00006420: 6865 2073 6571 7565 6e63 653b 2046 616c  he sequence; Fal
-00006430: 7365 2069 6620 7468 6520 7472 6565 2068  se if the tree h
-00006440: 6173 2062 6565 6e20 7472 616e 7366 6f72  as been transfor
-00006450: 6d65 6420 696e 746f 2074 6865 0a20 2020  med into the.   
-00006460: 2020 2020 2020 2020 206e 756c 6c20 7374           null st
-00006470: 6174 652e 0a20 2020 2020 2020 203a 7274  ate..        :rt
-00006480: 7970 653a 2062 6f6f 6c0a 2020 2020 2020  ype: bool.      
-00006490: 2020 2222 220a 2020 2020 2020 2020 7265    """.        re
-000064a0: 7475 726e 2062 6f6f 6c28 7365 6c66 2e5f  turn bool(self._
-000064b0: 6c6c 5f74 7265 652e 7072 6576 2829 290a  ll_tree.prev()).
-000064c0: 0a20 2020 2064 6566 2063 6c65 6172 2873  .    def clear(s
-000064d0: 656c 6629 3a0a 2020 2020 2020 2020 2222  elf):.        ""
-000064e0: 220a 2020 2020 2020 2020 5265 7365 7473  ".        Resets
-000064f0: 2074 6869 7320 7472 6565 2062 6163 6b20   this tree back 
-00006500: 746f 2074 6865 2069 6e69 7469 616c 206e  to the initial n
-00006510: 756c 6c20 7374 6174 652e 2043 616c 6c69  ull state. Calli
-00006520: 6e67 2074 6869 7320 6d65 7468 6f64 0a20  ng this method. 
-00006530: 2020 2020 2020 206f 6e20 6120 7472 6565         on a tree
-00006540: 2061 6c72 6561 6479 2069 6e20 7468 6520   already in the 
-00006550: 6e75 6c6c 2073 7461 7465 2068 6173 206e  null state has n
-00006560: 6f20 6566 6665 6374 2e0a 2020 2020 2020  o effect..      
-00006570: 2020 2222 220a 2020 2020 2020 2020 7365    """.        se
-00006580: 6c66 2e5f 6c6c 5f74 7265 652e 636c 6561  lf._ll_tree.clea
-00006590: 7228 290a 0a20 2020 2064 6566 2073 6565  r()..    def see
-000065a0: 6b5f 696e 6465 7828 7365 6c66 2c20 696e  k_index(self, in
-000065b0: 6465 7829 3a0a 2020 2020 2020 2020 2222  dex):.        ""
-000065c0: 220a 2020 2020 2020 2020 5365 7473 2074  ".        Sets t
-000065d0: 6865 2073 7461 7465 2074 6f20 7265 7072  he state to repr
-000065e0: 6573 656e 7420 7468 6520 7472 6565 2061  esent the tree a
-000065f0: 7420 7468 6520 7370 6563 6966 6965 640a  t the specified.
-00006600: 2020 2020 2020 2020 696e 6465 7820 696e          index in
-00006610: 2074 6865 2070 6172 656e 7420 7472 6565   the parent tree
-00006620: 2073 6571 7565 6e63 652e 204e 6567 6174   sequence. Negat
-00006630: 6976 6520 696e 6465 7865 7320 666f 6c6c  ive indexes foll
-00006640: 6f77 696e 6720 7468 650a 2020 2020 2020  owing the.      
-00006650: 2020 7374 616e 6461 7264 2050 7974 686f    standard Pytho
-00006660: 6e20 636f 6e76 656e 7469 6f6e 7320 6172  n conventions ar
-00006670: 6520 616c 6c6f 7765 642c 2069 2e65 2e2c  e allowed, i.e.,
-00006680: 2060 6069 6e64 6578 3d2d 3160 6020 7769   ``index=-1`` wi
-00006690: 6c6c 0a20 2020 2020 2020 2073 6565 6b20  ll.        seek 
-000066a0: 746f 2074 6865 206c 6173 7420 7472 6565  to the last tree
-000066b0: 2069 6e20 7468 6520 7365 7175 656e 6365   in the sequence
-000066c0: 2e0a 0a20 2020 2020 2020 202e 2e20 696e  ...        .. in
-000066d0: 636c 7564 653a 3a20 7375 6273 7469 7475  clude:: substitu
-000066e0: 7469 6f6e 732f 6c69 6e65 6172 5f74 7261  tions/linear_tra
-000066f0: 7665 7273 616c 5f77 6172 6e69 6e67 2e72  versal_warning.r
-00006700: 7374 0a0a 0a20 2020 2020 2020 203a 7061  st...        :pa
+00004b80: 6120 6769 7665 6e20 6e6f 6465 2075 7369  a given node usi
+00004b90: 6e67 2074 6865 0a20 2020 2020 2020 203a  ng the.        :
+00004ba0: 6d65 7468 3a60 5472 6565 2e73 616d 706c  meth:`Tree.sampl
+00004bb0: 6573 6020 6d65 7468 6f64 2e0a 2020 2020  es` method..    
+00004bc0: 3a70 6172 616d 2069 6e74 2072 6f6f 745f  :param int root_
+00004bd0: 7468 7265 7368 6f6c 643a 2054 6865 206d  threshold: The m
+00004be0: 696e 696d 756d 206e 756d 6265 7220 6f66  inimum number of
+00004bf0: 2073 616d 706c 6573 2074 6861 7420 6120   samples that a 
+00004c00: 6e6f 6465 0a20 2020 2020 2020 206d 7573  node.        mus
+00004c10: 7420 6265 2061 6e63 6573 7472 616c 2074  t be ancestral t
+00004c20: 6f20 666f 7220 6974 2074 6f20 6265 2069  o for it to be i
+00004c30: 6e20 7468 6520 6c69 7374 206f 6620 726f  n the list of ro
+00004c40: 6f74 732e 2042 7920 6465 6661 756c 740a  ots. By default.
+00004c50: 2020 2020 2020 2020 7468 6973 2069 7320          this is 
+00004c60: 312c 2073 6f20 7468 6174 2069 736f 6c61  1, so that isola
+00004c70: 7465 6420 7361 6d70 6c65 7320 2872 6570  ted samples (rep
+00004c80: 7265 7365 6e74 696e 6720 6d69 7373 696e  resenting missin
+00004c90: 6720 6461 7461 290a 2020 2020 2020 2020  g data).        
+00004ca0: 6172 6520 726f 6f74 732e 2054 6f20 6566  are roots. To ef
+00004cb0: 6669 6369 656e 746c 7920 7265 7374 7269  ficiently restri
+00004cc0: 6374 2074 6865 2072 6f6f 7473 206f 6620  ct the roots of 
+00004cd0: 7468 6520 7472 6565 2074 6f0a 2020 2020  the tree to.    
+00004ce0: 2020 2020 7468 6f73 6520 7375 6274 656e      those subten
+00004cf0: 6469 6e67 206d 6561 6e69 6e67 6675 6c20  ding meaningful 
+00004d00: 746f 706f 6c6f 6779 2c20 7365 7420 7468  topology, set th
+00004d10: 6973 2074 6f20 322e 2054 6869 7320 7661  is to 2. This va
+00004d20: 6c75 650a 2020 2020 2020 2020 6973 206f  lue.        is o
+00004d30: 6e6c 7920 7265 6c65 7661 6e74 2077 6865  nly relevant whe
+00004d40: 6e20 7472 6565 7320 6861 7665 206d 756c  n trees have mul
+00004d50: 7469 706c 6520 726f 6f74 732e 0a20 2020  tiple roots..   
+00004d60: 203a 7061 7261 6d20 626f 6f6c 2073 616d   :param bool sam
+00004d70: 706c 655f 636f 756e 7473 3a20 4465 7072  ple_counts: Depr
+00004d80: 6563 6174 6564 2073 696e 6365 2030 2e32  ecated since 0.2
+00004d90: 2e34 2e0a 2020 2020 2222 220a 0a20 2020  .4..    """..   
+00004da0: 2064 6566 205f 5f69 6e69 745f 5f28 0a20   def __init__(. 
+00004db0: 2020 2020 2020 2073 656c 662c 0a20 2020         self,.   
+00004dc0: 2020 2020 2074 7265 655f 7365 7175 656e       tree_sequen
+00004dd0: 6365 2c0a 2020 2020 2020 2020 7472 6163  ce,.        trac
+00004de0: 6b65 645f 7361 6d70 6c65 733d 4e6f 6e65  ked_samples=None
+00004df0: 2c0a 2020 2020 2020 2020 2a2c 0a20 2020  ,.        *,.   
+00004e00: 2020 2020 2073 616d 706c 655f 6c69 7374       sample_list
+00004e10: 733d 4661 6c73 652c 0a20 2020 2020 2020  s=False,.       
+00004e20: 2072 6f6f 745f 7468 7265 7368 6f6c 643d   root_threshold=
+00004e30: 312c 0a20 2020 2020 2020 2073 616d 706c  1,.        sampl
+00004e40: 655f 636f 756e 7473 3d4e 6f6e 652c 0a20  e_counts=None,. 
+00004e50: 2020 2029 3a0a 2020 2020 2020 2020 6f70     ):.        op
+00004e60: 7469 6f6e 7320 3d20 300a 2020 2020 2020  tions = 0.      
+00004e70: 2020 6966 2073 616d 706c 655f 636f 756e    if sample_coun
+00004e80: 7473 2069 7320 6e6f 7420 4e6f 6e65 3a0a  ts is not None:.
+00004e90: 2020 2020 2020 2020 2020 2020 7761 726e              warn
+00004ea0: 696e 6773 2e77 6172 6e28 0a20 2020 2020  ings.warn(.     
+00004eb0: 2020 2020 2020 2020 2020 2022 5468 6520             "The 
+00004ec0: 7361 6d70 6c65 5f63 6f75 6e74 7320 6f70  sample_counts op
+00004ed0: 7469 6f6e 2069 7320 6e6f 7420 7375 7070  tion is not supp
+00004ee0: 6f72 7465 6420 7369 6e63 6520 302e 322e  orted since 0.2.
+00004ef0: 3420 220a 2020 2020 2020 2020 2020 2020  4 ".            
+00004f00: 2020 2020 2261 6e64 2069 7320 6967 6e6f      "and is igno
+00004f10: 7265 6422 2c0a 2020 2020 2020 2020 2020  red",.          
+00004f20: 2020 2020 2020 5275 6e74 696d 6557 6172        RuntimeWar
+00004f30: 6e69 6e67 2c0a 2020 2020 2020 2020 2020  ning,.          
+00004f40: 2020 290a 2020 2020 2020 2020 6966 2073    ).        if s
+00004f50: 616d 706c 655f 6c69 7374 733a 0a20 2020  ample_lists:.   
+00004f60: 2020 2020 2020 2020 206f 7074 696f 6e73           options
+00004f70: 207c 3d20 5f74 736b 6974 2e53 414d 504c   |= _tskit.SAMPL
+00004f80: 455f 4c49 5354 530a 2020 2020 2020 2020  E_LISTS.        
+00004f90: 6b77 6172 6773 203d 207b 226f 7074 696f  kwargs = {"optio
+00004fa0: 6e73 223a 206f 7074 696f 6e73 7d0a 2020  ns": options}.  
+00004fb0: 2020 2020 2020 6966 2072 6f6f 745f 7468        if root_th
+00004fc0: 7265 7368 6f6c 6420 3c3d 2030 3a0a 2020  reshold <= 0:.  
+00004fd0: 2020 2020 2020 2020 2020 7261 6973 6520            raise 
+00004fe0: 5661 6c75 6545 7272 6f72 2822 526f 6f74  ValueError("Root
+00004ff0: 2074 6872 6573 686f 6c64 206d 7573 7420   threshold must 
+00005000: 6265 2067 7265 6174 6572 2074 6861 6e20  be greater than 
+00005010: 3022 290a 2020 2020 2020 2020 6966 2074  0").        if t
+00005020: 7261 636b 6564 5f73 616d 706c 6573 2069  racked_samples i
+00005030: 7320 6e6f 7420 4e6f 6e65 3a0a 2020 2020  s not None:.    
+00005040: 2020 2020 2020 2020 2320 544f 444f 2072          # TODO r
+00005050: 656d 6f76 6520 7468 6973 2077 6865 6e20  emove this when 
+00005060: 7765 2061 6c6c 6f77 206e 756d 7079 2061  we allow numpy a
+00005070: 7272 6179 7320 696e 2074 6865 206c 6f77  rrays in the low
+00005080: 2d6c 6576 656c 2041 5049 2e0a 2020 2020  -level API..    
+00005090: 2020 2020 2020 2020 6b77 6172 6773 5b22          kwargs["
+000050a0: 7472 6163 6b65 645f 7361 6d70 6c65 7322  tracked_samples"
+000050b0: 5d20 3d20 6c69 7374 2874 7261 636b 6564  ] = list(tracked
+000050c0: 5f73 616d 706c 6573 290a 0a20 2020 2020  _samples)..     
+000050d0: 2020 2073 656c 662e 5f74 7265 655f 7365     self._tree_se
+000050e0: 7175 656e 6365 203d 2074 7265 655f 7365  quence = tree_se
+000050f0: 7175 656e 6365 0a20 2020 2020 2020 2073  quence.        s
+00005100: 656c 662e 5f6c 6c5f 7472 6565 203d 205f  elf._ll_tree = _
+00005110: 7473 6b69 742e 5472 6565 2874 7265 655f  tskit.Tree(tree_
+00005120: 7365 7175 656e 6365 2e6c 6c5f 7472 6565  sequence.ll_tree
+00005130: 5f73 6571 7565 6e63 652c 202a 2a6b 7761  _sequence, **kwa
+00005140: 7267 7329 0a20 2020 2020 2020 2073 656c  rgs).        sel
+00005150: 662e 5f6c 6c5f 7472 6565 2e73 6574 5f72  f._ll_tree.set_r
+00005160: 6f6f 745f 7468 7265 7368 6f6c 6428 726f  oot_threshold(ro
+00005170: 6f74 5f74 6872 6573 686f 6c64 290a 2020  ot_threshold).  
+00005180: 2020 2020 2020 7365 6c66 2e5f 6d61 6b65        self._make
+00005190: 5f61 7272 6179 7328 290a 0a20 2020 2064  _arrays()..    d
+000051a0: 6566 2063 6f70 7928 7365 6c66 293a 0a20  ef copy(self):. 
+000051b0: 2020 2020 2020 2022 2222 0a20 2020 2020         """.     
+000051c0: 2020 2052 6574 7572 6e73 2061 2064 6565     Returns a dee
+000051d0: 7020 636f 7079 206f 6620 7468 6973 2074  p copy of this t
+000051e0: 7265 652e 2054 6865 2072 6574 7572 6e65  ree. The returne
+000051f0: 6420 7472 6565 2077 696c 6c20 6861 7665  d tree will have
+00005200: 2069 6465 6e74 6963 616c 2073 7461 7465   identical state
+00005210: 0a20 2020 2020 2020 2074 6f20 7468 6973  .        to this
+00005220: 2074 7265 652e 0a0a 2020 2020 2020 2020   tree...        
+00005230: 3a72 6574 7572 6e3a 2041 2063 6f70 7920  :return: A copy 
+00005240: 6f66 2074 6869 7320 7472 6565 2e0a 2020  of this tree..  
+00005250: 2020 2020 2020 3a72 7479 7065 3a20 5472        :rtype: Tr
+00005260: 6565 0a20 2020 2020 2020 2022 2222 0a20  ee.        """. 
+00005270: 2020 2020 2020 2063 6f70 7920 3d20 7479         copy = ty
+00005280: 7065 2873 656c 6629 2e5f 5f6e 6577 5f5f  pe(self).__new__
+00005290: 2874 7970 6528 7365 6c66 2929 0a20 2020  (type(self)).   
+000052a0: 2020 2020 2063 6f70 792e 5f74 7265 655f       copy._tree_
+000052b0: 7365 7175 656e 6365 203d 2073 656c 662e  sequence = self.
+000052c0: 5f74 7265 655f 7365 7175 656e 6365 0a20  _tree_sequence. 
+000052d0: 2020 2020 2020 2063 6f70 792e 5f6c 6c5f         copy._ll_
+000052e0: 7472 6565 203d 2073 656c 662e 5f6c 6c5f  tree = self._ll_
+000052f0: 7472 6565 2e63 6f70 7928 290a 2020 2020  tree.copy().    
+00005300: 2020 2020 636f 7079 2e5f 6d61 6b65 5f61      copy._make_a
+00005310: 7272 6179 7328 290a 2020 2020 2020 2020  rrays().        
+00005320: 7265 7475 726e 2063 6f70 790a 0a20 2020  return copy..   
+00005330: 2023 2054 4f44 4f20 6d61 6b65 2074 6869   # TODO make thi
+00005340: 7320 6d65 7468 6f64 2070 7562 6c69 6320  s method public 
+00005350: 616e 6420 646f 6375 6d65 6e74 2069 742e  and document it.
+00005360: 0a20 2020 2023 204e 6f74 6520 7468 6174  .    # Note that
+00005370: 2074 6869 7320 7072 6f62 6162 6c79 2064   this probably d
+00005380: 6f65 7320 6e6f 7420 636f 7665 7220 616c  oes not cover al
+00005390: 6c20 636f 726e 6572 2063 6173 6573 2063  l corner cases c
+000053a0: 6f72 7265 6374 6c79 0a20 2020 2023 2068  orrectly.    # h
+000053b0: 7474 7073 3a2f 2f67 6974 6875 622e 636f  ttps://github.co
+000053c0: 6d2f 7473 6b69 742d 6465 762f 7473 6b69  m/tskit-dev/tski
+000053d0: 742f 6973 7375 6573 2f31 3930 380a 2020  t/issues/1908.  
+000053e0: 2020 6465 6620 5f68 6173 5f69 736f 6c61    def _has_isola
+000053f0: 7465 645f 7361 6d70 6c65 7328 7365 6c66  ted_samples(self
+00005400: 293a 0a20 2020 2020 2020 2023 2054 4f44  ):.        # TOD
+00005410: 4f20 4973 2074 6869 7320 6465 6669 6e69  O Is this defini
+00005420: 7469 6f6e 2063 6f72 7265 6374 2066 6f72  tion correct for
+00005430: 2061 2073 696e 676c 652d 6e6f 6465 2074   a single-node t
+00005440: 7265 6520 7365 7175 656e 6365 3f0a 2020  ree sequence?.  
+00005450: 2020 2020 2020 666f 7220 726f 6f74 2069        for root i
+00005460: 6e20 7365 6c66 2e72 6f6f 7473 3a0a 2020  n self.roots:.  
+00005470: 2020 2020 2020 2020 2020 2320 4966 2074            # If t
+00005480: 6865 2072 6f6f 7420 6861 7320 6e6f 2063  he root has no c
+00005490: 6869 6c64 7265 6e20 7468 656e 2069 7420  hildren then it 
+000054a0: 6d75 7374 2062 6520 6120 7361 6d70 6c65  must be a sample
+000054b0: 0a20 2020 2020 2020 2020 2020 2069 6620  .            if 
+000054c0: 7365 6c66 2e6c 6566 745f 6368 696c 6428  self.left_child(
+000054d0: 726f 6f74 2920 3d3d 204e 554c 4c3a 0a20  root) == NULL:. 
+000054e0: 2020 2020 2020 2020 2020 2020 2020 2072                 r
+000054f0: 6574 7572 6e20 5472 7565 0a20 2020 2020  eturn True.     
+00005500: 2020 2072 6574 7572 6e20 4661 6c73 650a     return False.
+00005510: 0a20 2020 2064 6566 205f 6d61 6b65 5f61  .    def _make_a
+00005520: 7272 6179 7328 7365 6c66 293a 0a20 2020  rrays(self):.   
+00005530: 2020 2020 2023 2053 746f 7265 2074 6865       # Store the
+00005540: 206c 6f77 2d6c 6576 656c 2061 7272 6179   low-level array
+00005550: 7320 666f 7220 6566 6669 6369 656e 6379  s for efficiency
+00005560: 2e20 5468 6572 6527 7320 6e6f 2072 6561  . There's no rea
+00005570: 6c20 6f76 6572 6865 6164 0a20 2020 2020  l overhead.     
+00005580: 2020 2023 2069 6e20 7468 6973 2c20 6265     # in this, be
+00005590: 6361 7573 6520 7468 6520 7265 6665 7220  cause the refer 
+000055a0: 746f 2074 6865 2073 616d 6520 756e 6465  to the same unde
+000055b0: 726c 7969 6e67 206d 656d 6f72 7920 6173  rlying memory as
+000055c0: 2074 6865 0a20 2020 2020 2020 2023 2074   the.        # t
+000055d0: 7265 6520 6f62 6a65 6374 2e0a 2020 2020  ree object..    
+000055e0: 2020 2020 7365 6c66 2e5f 7061 7265 6e74      self._parent
+000055f0: 5f61 7272 6179 203d 2073 656c 662e 5f6c  _array = self._l
+00005600: 6c5f 7472 6565 2e70 6172 656e 745f 6172  l_tree.parent_ar
+00005610: 7261 790a 2020 2020 2020 2020 7365 6c66  ray.        self
+00005620: 2e5f 6c65 6674 5f63 6869 6c64 5f61 7272  ._left_child_arr
+00005630: 6179 203d 2073 656c 662e 5f6c 6c5f 7472  ay = self._ll_tr
+00005640: 6565 2e6c 6566 745f 6368 696c 645f 6172  ee.left_child_ar
+00005650: 7261 790a 2020 2020 2020 2020 7365 6c66  ray.        self
+00005660: 2e5f 7269 6768 745f 6368 696c 645f 6172  ._right_child_ar
+00005670: 7261 7920 3d20 7365 6c66 2e5f 6c6c 5f74  ray = self._ll_t
+00005680: 7265 652e 7269 6768 745f 6368 696c 645f  ree.right_child_
+00005690: 6172 7261 790a 2020 2020 2020 2020 7365  array.        se
+000056a0: 6c66 2e5f 6c65 6674 5f73 6962 5f61 7272  lf._left_sib_arr
+000056b0: 6179 203d 2073 656c 662e 5f6c 6c5f 7472  ay = self._ll_tr
+000056c0: 6565 2e6c 6566 745f 7369 625f 6172 7261  ee.left_sib_arra
+000056d0: 790a 2020 2020 2020 2020 7365 6c66 2e5f  y.        self._
+000056e0: 7269 6768 745f 7369 625f 6172 7261 7920  right_sib_array 
+000056f0: 3d20 7365 6c66 2e5f 6c6c 5f74 7265 652e  = self._ll_tree.
+00005700: 7269 6768 745f 7369 625f 6172 7261 790a  right_sib_array.
+00005710: 2020 2020 2020 2020 7365 6c66 2e5f 6e75          self._nu
+00005720: 6d5f 6368 696c 6472 656e 5f61 7272 6179  m_children_array
+00005730: 203d 2073 656c 662e 5f6c 6c5f 7472 6565   = self._ll_tree
+00005740: 2e6e 756d 5f63 6869 6c64 7265 6e5f 6172  .num_children_ar
+00005750: 7261 790a 2020 2020 2020 2020 7365 6c66  ray.        self
+00005760: 2e5f 6564 6765 5f61 7272 6179 203d 2073  ._edge_array = s
+00005770: 656c 662e 5f6c 6c5f 7472 6565 2e65 6467  elf._ll_tree.edg
+00005780: 655f 6172 7261 790a 0a20 2020 2040 7072  e_array..    @pr
+00005790: 6f70 6572 7479 0a20 2020 2064 6566 2074  operty.    def t
+000057a0: 7265 655f 7365 7175 656e 6365 2873 656c  ree_sequence(sel
+000057b0: 6629 3a0a 2020 2020 2020 2020 2222 220a  f):.        """.
+000057c0: 2020 2020 2020 2020 5265 7475 726e 7320          Returns 
+000057d0: 7468 6520 7472 6565 2073 6571 7565 6e63  the tree sequenc
+000057e0: 6520 7468 6174 2074 6869 7320 7472 6565  e that this tree
+000057f0: 2069 7320 6672 6f6d 2e0a 0a20 2020 2020   is from...     
+00005800: 2020 203a 7265 7475 726e 3a20 5468 6520     :return: The 
+00005810: 7061 7265 6e74 2074 7265 6520 7365 7175  parent tree sequ
+00005820: 656e 6365 2066 6f72 2074 6869 7320 7472  ence for this tr
+00005830: 6565 2e0a 2020 2020 2020 2020 3a72 7479  ee..        :rty
+00005840: 7065 3a20 3a63 6c61 7373 3a60 5472 6565  pe: :class:`Tree
+00005850: 5365 7175 656e 6365 600a 2020 2020 2020  Sequence`.      
+00005860: 2020 2222 220a 2020 2020 2020 2020 7265    """.        re
+00005870: 7475 726e 2073 656c 662e 5f74 7265 655f  turn self._tree_
+00005880: 7365 7175 656e 6365 0a0a 2020 2020 4070  sequence..    @p
+00005890: 726f 7065 7274 790a 2020 2020 6465 6620  roperty.    def 
+000058a0: 726f 6f74 5f74 6872 6573 686f 6c64 2873  root_threshold(s
+000058b0: 656c 6629 3a0a 2020 2020 2020 2020 2222  elf):.        ""
+000058c0: 220a 2020 2020 2020 2020 5265 7475 726e  ".        Return
+000058d0: 7320 7468 6520 6d69 6e69 6d75 6d20 6e75  s the minimum nu
+000058e0: 6d62 6572 206f 6620 7361 6d70 6c65 7320  mber of samples 
+000058f0: 7468 6174 2061 206e 6f64 6520 6d75 7374  that a node must
+00005900: 2062 6520 616e 2061 6e63 6573 746f 720a   be an ancestor.
+00005910: 2020 2020 2020 2020 6f66 2074 6f20 6265          of to be
+00005920: 2063 6f6e 7369 6465 7265 6420 6120 706f   considered a po
+00005930: 7465 6e74 6961 6c20 726f 6f74 2e20 5468  tential root. Th
+00005940: 6973 2063 616e 2062 6520 7365 742c 2066  is can be set, f
+00005950: 6f72 2065 7861 6d70 6c65 2c20 7768 656e  or example, when
+00005960: 0a20 2020 2020 2020 2063 616c 6c69 6e67  .        calling
+00005970: 2074 6865 203a 6d65 7468 3a60 5472 6565   the :meth:`Tree
+00005980: 5365 7175 656e 6365 2e74 7265 6573 6020  Sequence.trees` 
+00005990: 6974 6572 6174 6f72 2e0a 0a20 2020 2020  iterator...     
+000059a0: 2020 203a 7265 7475 726e 3a20 5468 6520     :return: The 
+000059b0: 726f 6f74 2074 6872 6573 686f 6c64 2e0a  root threshold..
+000059c0: 2020 2020 2020 2020 3a72 7479 7065 3a20          :rtype: 
+000059d0: 3a63 6c61 7373 3a60 5472 6565 5365 7175  :class:`TreeSequ
+000059e0: 656e 6365 600a 2020 2020 2020 2020 2222  ence`.        ""
+000059f0: 220a 2020 2020 2020 2020 7265 7475 726e  ".        return
+00005a00: 2073 656c 662e 5f6c 6c5f 7472 6565 2e67   self._ll_tree.g
+00005a10: 6574 5f72 6f6f 745f 7468 7265 7368 6f6c  et_root_threshol
+00005a20: 6428 290a 0a20 2020 2064 6566 205f 5f65  d()..    def __e
+00005a30: 715f 5f28 7365 6c66 2c20 6f74 6865 7229  q__(self, other)
+00005a40: 3a0a 2020 2020 2020 2020 7265 7420 3d20  :.        ret = 
+00005a50: 4661 6c73 650a 2020 2020 2020 2020 6966  False.        if
+00005a60: 2074 7970 6528 6f74 6865 7229 2069 7320   type(other) is 
+00005a70: 7479 7065 2873 656c 6629 3a0a 2020 2020  type(self):.    
+00005a80: 2020 2020 2020 2020 7265 7420 3d20 626f          ret = bo
+00005a90: 6f6c 2873 656c 662e 5f6c 6c5f 7472 6565  ol(self._ll_tree
+00005aa0: 2e65 7175 616c 7328 6f74 6865 722e 5f6c  .equals(other._l
+00005ab0: 6c5f 7472 6565 2929 0a20 2020 2020 2020  l_tree)).       
+00005ac0: 2072 6574 7572 6e20 7265 740a 0a20 2020   return ret..   
+00005ad0: 2064 6566 205f 5f6e 655f 5f28 7365 6c66   def __ne__(self
+00005ae0: 2c20 6f74 6865 7229 3a0a 2020 2020 2020  , other):.      
+00005af0: 2020 7265 7475 726e 206e 6f74 2073 656c    return not sel
+00005b00: 662e 5f5f 6571 5f5f 286f 7468 6572 290a  f.__eq__(other).
+00005b10: 0a20 2020 2064 6566 2066 6972 7374 2873  .    def first(s
+00005b20: 656c 6629 3a0a 2020 2020 2020 2020 2222  elf):.        ""
+00005b30: 220a 2020 2020 2020 2020 5365 656b 7320  ".        Seeks 
+00005b40: 746f 2074 6865 2066 6972 7374 2074 7265  to the first tre
+00005b50: 6520 696e 2074 6865 2073 6571 7565 6e63  e in the sequenc
+00005b60: 652e 2054 6869 7320 6361 6e20 6265 2063  e. This can be c
+00005b70: 616c 6c65 6420 7768 6574 6865 720a 2020  alled whether.  
+00005b80: 2020 2020 2020 7468 6520 7472 6565 2069        the tree i
+00005b90: 7320 696e 2074 6865 206e 756c 6c20 7374  s in the null st
+00005ba0: 6174 6520 6f72 206e 6f74 2e0a 2020 2020  ate or not..    
+00005bb0: 2020 2020 2222 220a 2020 2020 2020 2020      """.        
+00005bc0: 7365 6c66 2e5f 6c6c 5f74 7265 652e 6669  self._ll_tree.fi
+00005bd0: 7273 7428 290a 0a20 2020 2064 6566 206c  rst()..    def l
+00005be0: 6173 7428 7365 6c66 293a 0a20 2020 2020  ast(self):.     
+00005bf0: 2020 2022 2222 0a20 2020 2020 2020 2053     """.        S
+00005c00: 6565 6b73 2074 6f20 7468 6520 6c61 7374  eeks to the last
+00005c10: 2074 7265 6520 696e 2074 6865 2073 6571   tree in the seq
+00005c20: 7565 6e63 652e 2054 6869 7320 6361 6e20  uence. This can 
+00005c30: 6265 2063 616c 6c65 6420 7768 6574 6865  be called whethe
+00005c40: 720a 2020 2020 2020 2020 7468 6520 7472  r.        the tr
+00005c50: 6565 2069 7320 696e 2074 6865 206e 756c  ee is in the nul
+00005c60: 6c20 7374 6174 6520 6f72 206e 6f74 2e0a  l state or not..
+00005c70: 2020 2020 2020 2020 2222 220a 2020 2020          """.    
+00005c80: 2020 2020 7365 6c66 2e5f 6c6c 5f74 7265      self._ll_tre
+00005c90: 652e 6c61 7374 2829 0a0a 2020 2020 6465  e.last()..    de
+00005ca0: 6620 6e65 7874 2873 656c 6629 3a20 2023  f next(self):  #
+00005cb0: 206e 6f71 6120 4130 3032 0a20 2020 2020   noqa A002.     
+00005cc0: 2020 2022 2222 0a20 2020 2020 2020 2053     """.        S
+00005cd0: 6565 6b73 2074 6f20 7468 6520 6e65 7874  eeks to the next
+00005ce0: 2074 7265 6520 696e 2074 6865 2073 6571   tree in the seq
+00005cf0: 7565 6e63 652e 2049 6620 7468 6520 7472  uence. If the tr
+00005d00: 6565 2069 7320 696e 2074 6865 2069 6e69  ee is in the ini
+00005d10: 7469 616c 0a20 2020 2020 2020 206e 756c  tial.        nul
+00005d20: 6c20 7374 6174 6520 7765 2073 6565 6b20  l state we seek 
+00005d30: 746f 2074 6865 2066 6972 7374 2074 7265  to the first tre
+00005d40: 6520 2865 7175 6976 616c 656e 7420 746f  e (equivalent to
+00005d50: 2063 616c 6c69 6e67 203a 6d65 7468 3a60   calling :meth:`
+00005d60: 7e54 7265 652e 6669 7273 7460 292e 0a20  ~Tree.first`).. 
+00005d70: 2020 2020 2020 2043 616c 6c69 6e67 2060         Calling `
+00005d80: 606e 6578 7460 6020 6f6e 2074 6865 206c  `next`` on the l
+00005d90: 6173 7420 7472 6565 2069 6e20 7468 6520  ast tree in the 
+00005da0: 7365 7175 656e 6365 2072 6573 756c 7473  sequence results
+00005db0: 2069 6e20 7468 6520 7472 6565 0a20 2020   in the tree.   
+00005dc0: 2020 2020 2062 6569 6e67 2063 6c65 6172       being clear
+00005dd0: 6564 2062 6163 6b20 696e 746f 2074 6865  ed back into the
+00005de0: 206e 756c 6c20 696e 6974 6961 6c20 7374   null initial st
+00005df0: 6174 6520 2865 7175 6976 616c 656e 7420  ate (equivalent 
+00005e00: 746f 2063 616c 6c69 6e67 0a20 2020 2020  to calling.     
+00005e10: 2020 203a 6d65 7468 3a60 7e54 7265 652e     :meth:`~Tree.
+00005e20: 636c 6561 7260 292e 2054 6865 2072 6574  clear`). The ret
+00005e30: 7572 6e20 7661 6c75 6520 6f66 2074 6865  urn value of the
+00005e40: 2066 756e 6374 696f 6e20 696e 6469 6361   function indica
+00005e50: 7465 7320 7768 6574 6865 7220 7468 650a  tes whether the.
+00005e60: 2020 2020 2020 2020 7472 6565 2069 7320          tree is 
+00005e70: 696e 2061 206e 6f6e 2d6e 756c 6c20 7374  in a non-null st
+00005e80: 6174 652c 2061 6e64 2063 616e 2062 6520  ate, and can be 
+00005e90: 7573 6564 2074 6f20 6c6f 6f70 206f 7665  used to loop ove
+00005ea0: 7220 7468 6520 7472 6565 733a 3a0a 0a20  r the trees::.. 
+00005eb0: 2020 2020 2020 2020 2020 2023 2049 7465             # Ite
+00005ec0: 7261 7465 206f 7665 7220 7468 6520 7472  rate over the tr
+00005ed0: 6565 7320 6672 6f6d 206c 6566 742d 746f  ees from left-to
+00005ee0: 2d72 6967 6874 0a20 2020 2020 2020 2020  -right.         
+00005ef0: 2020 2074 7265 6520 3d20 7473 6b69 742e     tree = tskit.
+00005f00: 5472 6565 2874 7265 655f 7365 7175 656e  Tree(tree_sequen
+00005f10: 6365 290a 2020 2020 2020 2020 2020 2020  ce).            
+00005f20: 7768 696c 6520 7472 6565 2e6e 6578 7428  while tree.next(
+00005f30: 290a 2020 2020 2020 2020 2020 2020 2020  ).              
+00005f40: 2020 2320 446f 2073 6f6d 6574 6869 6e67    # Do something
+00005f50: 2077 6974 6820 7468 6520 7472 6565 2e0a   with the tree..
+00005f60: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00005f70: 7072 696e 7428 7472 6565 2e69 6e64 6578  print(tree.index
+00005f80: 290a 2020 2020 2020 2020 2020 2020 2320  ).            # 
+00005f90: 7472 6565 2069 7320 6e6f 7720 6261 636b  tree is now back
+00005fa0: 2069 6e20 7468 6520 6e75 6c6c 2073 7461   in the null sta
+00005fb0: 7465 2e0a 0a20 2020 2020 2020 203a 7265  te...        :re
+00005fc0: 7475 726e 3a20 5472 7565 2069 6620 7468  turn: True if th
+00005fd0: 6520 7472 6565 2068 6173 2062 6565 6e20  e tree has been 
+00005fe0: 7472 616e 7366 6f72 6d65 6420 696e 746f  transformed into
+00005ff0: 206f 6e65 206f 6620 7468 6520 7472 6565   one of the tree
+00006000: 730a 2020 2020 2020 2020 2020 2020 696e  s.            in
+00006010: 2074 6865 2073 6571 7565 6e63 653b 2046   the sequence; F
+00006020: 616c 7365 2069 6620 7468 6520 7472 6565  alse if the tree
+00006030: 2068 6173 2062 6565 6e20 7472 616e 7366   has been transf
+00006040: 6f72 6d65 6420 696e 746f 2074 6865 0a20  ormed into the. 
+00006050: 2020 2020 2020 2020 2020 206e 756c 6c20             null 
+00006060: 7374 6174 652e 0a20 2020 2020 2020 203a  state..        :
+00006070: 7274 7970 653a 2062 6f6f 6c0a 2020 2020  rtype: bool.    
+00006080: 2020 2020 2222 220a 2020 2020 2020 2020      """.        
+00006090: 7265 7475 726e 2062 6f6f 6c28 7365 6c66  return bool(self
+000060a0: 2e5f 6c6c 5f74 7265 652e 6e65 7874 2829  ._ll_tree.next()
+000060b0: 290a 0a20 2020 2064 6566 2070 7265 7628  )..    def prev(
+000060c0: 7365 6c66 293a 0a20 2020 2020 2020 2022  self):.        "
+000060d0: 2222 0a20 2020 2020 2020 2053 6565 6b73  "".        Seeks
+000060e0: 2074 6f20 7468 6520 7072 6576 696f 7573   to the previous
+000060f0: 2074 7265 6520 696e 2074 6865 2073 6571   tree in the seq
+00006100: 7565 6e63 652e 2049 6620 7468 6520 7472  uence. If the tr
+00006110: 6565 2069 7320 696e 2074 6865 2069 6e69  ee is in the ini
+00006120: 7469 616c 0a20 2020 2020 2020 206e 756c  tial.        nul
+00006130: 6c20 7374 6174 6520 7765 2073 6565 6b20  l state we seek 
+00006140: 746f 2074 6865 206c 6173 7420 7472 6565  to the last tree
+00006150: 2028 6571 7569 7661 6c65 6e74 2074 6f20   (equivalent to 
+00006160: 6361 6c6c 696e 6720 3a6d 6574 683a 607e  calling :meth:`~
+00006170: 5472 6565 2e6c 6173 7460 292e 0a20 2020  Tree.last`)..   
+00006180: 2020 2020 2043 616c 6c69 6e67 2060 6070       Calling ``p
+00006190: 7265 7660 6020 6f6e 2074 6865 2066 6972  rev`` on the fir
+000061a0: 7374 2074 7265 6520 696e 2074 6865 2073  st tree in the s
+000061b0: 6571 7565 6e63 6520 7265 7375 6c74 7320  equence results 
+000061c0: 696e 2074 6865 2074 7265 650a 2020 2020  in the tree.    
+000061d0: 2020 2020 6265 696e 6720 636c 6561 7265      being cleare
+000061e0: 6420 6261 636b 2069 6e74 6f20 7468 6520  d back into the 
+000061f0: 6e75 6c6c 2069 6e69 7469 616c 2073 7461  null initial sta
+00006200: 7465 2028 6571 7569 7661 6c65 6e74 2074  te (equivalent t
+00006210: 6f20 6361 6c6c 696e 670a 2020 2020 2020  o calling.      
+00006220: 2020 3a6d 6574 683a 607e 5472 6565 2e63    :meth:`~Tree.c
+00006230: 6c65 6172 6029 2e20 5468 6520 7265 7475  lear`). The retu
+00006240: 726e 2076 616c 7565 206f 6620 7468 6520  rn value of the 
+00006250: 6675 6e63 7469 6f6e 2069 6e64 6963 6174  function indicat
+00006260: 6573 2077 6865 7468 6572 2074 6865 0a20  es whether the. 
+00006270: 2020 2020 2020 2074 7265 6520 6973 2069         tree is i
+00006280: 6e20 6120 6e6f 6e2d 6e75 6c6c 2073 7461  n a non-null sta
+00006290: 7465 2c20 616e 6420 6361 6e20 6265 2075  te, and can be u
+000062a0: 7365 6420 746f 206c 6f6f 7020 6f76 6572  sed to loop over
+000062b0: 2074 6865 2074 7265 6573 3a3a 0a0a 2020   the trees::..  
+000062c0: 2020 2020 2020 2020 2020 2320 4974 6572            # Iter
+000062d0: 6174 6520 6f76 6572 2074 6865 2074 7265  ate over the tre
+000062e0: 6573 2066 726f 6d20 7269 6768 742d 746f  es from right-to
+000062f0: 2d6c 6566 740a 2020 2020 2020 2020 2020  -left.          
+00006300: 2020 7472 6565 203d 2074 736b 6974 2e54    tree = tskit.T
+00006310: 7265 6528 7472 6565 5f73 6571 7565 6e63  ree(tree_sequenc
+00006320: 6529 0a20 2020 2020 2020 2020 2020 2077  e).            w
+00006330: 6869 6c65 2074 7265 652e 7072 6576 2829  hile tree.prev()
+00006340: 0a20 2020 2020 2020 2020 2020 2020 2020  .               
+00006350: 2023 2044 6f20 736f 6d65 7468 696e 6720   # Do something 
+00006360: 7769 7468 2074 6865 2074 7265 652e 0a20  with the tree.. 
+00006370: 2020 2020 2020 2020 2020 2020 2020 2070                 p
+00006380: 7269 6e74 2874 7265 652e 696e 6465 7829  rint(tree.index)
+00006390: 0a20 2020 2020 2020 2020 2020 2023 2074  .            # t
+000063a0: 7265 6520 6973 206e 6f77 2062 6163 6b20  ree is now back 
+000063b0: 696e 2074 6865 206e 756c 6c20 7374 6174  in the null stat
+000063c0: 652e 0a0a 2020 2020 2020 2020 3a72 6574  e...        :ret
+000063d0: 7572 6e3a 2054 7275 6520 6966 2074 6865  urn: True if the
+000063e0: 2074 7265 6520 6861 7320 6265 656e 2074   tree has been t
+000063f0: 7261 6e73 666f 726d 6564 2069 6e74 6f20  ransformed into 
+00006400: 6f6e 6520 6f66 2074 6865 2074 7265 6573  one of the trees
+00006410: 0a20 2020 2020 2020 2020 2020 2069 6e20  .            in 
+00006420: 7468 6520 7365 7175 656e 6365 3b20 4661  the sequence; Fa
+00006430: 6c73 6520 6966 2074 6865 2074 7265 6520  lse if the tree 
+00006440: 6861 7320 6265 656e 2074 7261 6e73 666f  has been transfo
+00006450: 726d 6564 2069 6e74 6f20 7468 650a 2020  rmed into the.  
+00006460: 2020 2020 2020 2020 2020 6e75 6c6c 2073            null s
+00006470: 7461 7465 2e0a 2020 2020 2020 2020 3a72  tate..        :r
+00006480: 7479 7065 3a20 626f 6f6c 0a20 2020 2020  type: bool.     
+00006490: 2020 2022 2222 0a20 2020 2020 2020 2072     """.        r
+000064a0: 6574 7572 6e20 626f 6f6c 2873 656c 662e  eturn bool(self.
+000064b0: 5f6c 6c5f 7472 6565 2e70 7265 7628 2929  _ll_tree.prev())
+000064c0: 0a0a 2020 2020 6465 6620 636c 6561 7228  ..    def clear(
+000064d0: 7365 6c66 293a 0a20 2020 2020 2020 2022  self):.        "
+000064e0: 2222 0a20 2020 2020 2020 2052 6573 6574  "".        Reset
+000064f0: 7320 7468 6973 2074 7265 6520 6261 636b  s this tree back
+00006500: 2074 6f20 7468 6520 696e 6974 6961 6c20   to the initial 
+00006510: 6e75 6c6c 2073 7461 7465 2e20 4361 6c6c  null state. Call
+00006520: 696e 6720 7468 6973 206d 6574 686f 640a  ing this method.
+00006530: 2020 2020 2020 2020 6f6e 2061 2074 7265          on a tre
+00006540: 6520 616c 7265 6164 7920 696e 2074 6865  e already in the
+00006550: 206e 756c 6c20 7374 6174 6520 6861 7320   null state has 
+00006560: 6e6f 2065 6666 6563 742e 0a20 2020 2020  no effect..     
+00006570: 2020 2022 2222 0a20 2020 2020 2020 2073     """.        s
+00006580: 656c 662e 5f6c 6c5f 7472 6565 2e63 6c65  elf._ll_tree.cle
+00006590: 6172 2829 0a0a 2020 2020 6465 6620 7365  ar()..    def se
+000065a0: 656b 5f69 6e64 6578 2873 656c 662c 2069  ek_index(self, i
+000065b0: 6e64 6578 293a 0a20 2020 2020 2020 2022  ndex):.        "
+000065c0: 2222 0a20 2020 2020 2020 2053 6574 7320  "".        Sets 
+000065d0: 7468 6520 7374 6174 6520 746f 2072 6570  the state to rep
+000065e0: 7265 7365 6e74 2074 6865 2074 7265 6520  resent the tree 
+000065f0: 6174 2074 6865 2073 7065 6369 6669 6564  at the specified
+00006600: 0a20 2020 2020 2020 2069 6e64 6578 2069  .        index i
+00006610: 6e20 7468 6520 7061 7265 6e74 2074 7265  n the parent tre
+00006620: 6520 7365 7175 656e 6365 2e20 4e65 6761  e sequence. Nega
+00006630: 7469 7665 2069 6e64 6578 6573 2066 6f6c  tive indexes fol
+00006640: 6c6f 7769 6e67 2074 6865 0a20 2020 2020  lowing the.     
+00006650: 2020 2073 7461 6e64 6172 6420 5079 7468     standard Pyth
+00006660: 6f6e 2063 6f6e 7665 6e74 696f 6e73 2061  on conventions a
+00006670: 7265 2061 6c6c 6f77 6564 2c20 692e 652e  re allowed, i.e.
+00006680: 2c20 6060 696e 6465 783d 2d31 6060 2077  , ``index=-1`` w
+00006690: 696c 6c0a 2020 2020 2020 2020 7365 656b  ill.        seek
+000066a0: 2074 6f20 7468 6520 6c61 7374 2074 7265   to the last tre
+000066b0: 6520 696e 2074 6865 2073 6571 7565 6e63  e in the sequenc
+000066c0: 652e 0a0a 2020 2020 2020 2020 2e2e 2069  e...        .. i
+000066d0: 6e63 6c75 6465 3a3a 2073 7562 7374 6974  nclude:: substit
+000066e0: 7574 696f 6e73 2f6c 696e 6561 725f 7472  utions/linear_tr
+000066f0: 6176 6572 7361 6c5f 7761 726e 696e 672e  aversal_warning.
+00006700: 7273 740a 0a20 2020 2020 2020 203a 7061  rst..        :pa
 00006710: 7261 6d20 696e 7420 696e 6465 783a 2054  ram int index: T
 00006720: 6865 2074 7265 6520 696e 6465 7820 746f  he tree index to
 00006730: 2073 6565 6b20 746f 2e0a 2020 2020 2020   seek to..      
 00006740: 2020 3a72 6169 7365 7320 496e 6465 7845    :raises IndexE
 00006750: 7272 6f72 3a20 4966 2061 6e20 696e 6465  rror: If an inde
 00006760: 7820 6f75 7473 6964 6520 7468 6520 6163  x outside the ac
 00006770: 6365 7074 6162 6c65 2072 616e 6765 2069  ceptable range i
@@ -1664,23049 +1664,23053 @@
 000067f0: 202b 3d20 6e75 6d5f 7472 6565 730a 2020   += num_trees.  
 00006800: 2020 2020 2020 6966 2069 6e64 6578 203c        if index <
 00006810: 2030 206f 7220 696e 6465 7820 3e3d 206e   0 or index >= n
 00006820: 756d 5f74 7265 6573 3a0a 2020 2020 2020  um_trees:.      
 00006830: 2020 2020 2020 7261 6973 6520 496e 6465        raise Inde
 00006840: 7845 7272 6f72 2822 496e 6465 7820 6f75  xError("Index ou
 00006850: 7420 6f66 2062 6f75 6e64 7322 290a 2020  t of bounds").  
-00006860: 2020 2020 2020 2320 5468 6973 2073 686f        # This sho
-00006870: 756c 6420 6265 2069 6d70 6c65 6d65 6e74  uld be implement
-00006880: 6564 2069 6e20 4320 6566 6669 6369 656e  ed in C efficien
-00006890: 746c 7920 7573 696e 6720 7468 6520 696e  tly using the in
-000068a0: 6465 7865 732e 0a20 2020 2020 2020 2023  dexes..        #
-000068b0: 204e 6f20 706f 696e 7420 696e 2063 6f6d   No point in com
-000068c0: 706c 6963 6174 696e 6720 7468 6520 6375  plicating the cu
-000068d0: 7272 656e 7420 696d 706c 656d 656e 7461  rrent implementa
-000068e0: 7469 6f6e 2062 7920 7472 7969 6e67 0a20  tion by trying. 
-000068f0: 2020 2020 2020 2023 2074 6f20 7365 656b         # to seek
-00006900: 2066 726f 6d20 7468 6520 636f 7272 6563   from the correc
-00006910: 7420 6469 7265 6374 696f 6e2e 0a20 2020  t direction..   
-00006920: 2020 2020 2073 656c 662e 6669 7273 7428       self.first(
-00006930: 290a 2020 2020 2020 2020 7768 696c 6520  ).        while 
-00006940: 7365 6c66 2e69 6e64 6578 2021 3d20 696e  self.index != in
-00006950: 6465 783a 0a20 2020 2020 2020 2020 2020  dex:.           
-00006960: 2073 656c 662e 6e65 7874 2829 0a0a 2020   self.next()..  
-00006970: 2020 6465 6620 7365 656b 2873 656c 662c    def seek(self,
-00006980: 2070 6f73 6974 696f 6e29 3a0a 2020 2020   position):.    
-00006990: 2020 2020 2222 220a 2020 2020 2020 2020      """.        
-000069a0: 5365 7473 2074 6865 2073 7461 7465 2074  Sets the state t
-000069b0: 6f20 7265 7072 6573 656e 7420 7468 6520  o represent the 
-000069c0: 7472 6565 2074 6861 7420 636f 7665 7273  tree that covers
-000069d0: 2074 6865 2073 7065 6369 6669 6564 0a20   the specified. 
-000069e0: 2020 2020 2020 2070 6f73 6974 696f 6e20         position 
-000069f0: 696e 2074 6865 2070 6172 656e 7420 7472  in the parent tr
-00006a00: 6565 2073 6571 7565 6e63 652e 2041 6674  ee sequence. Aft
-00006a10: 6572 2061 2073 7563 6365 7373 6675 6c20  er a successful 
-00006a20: 7265 7475 726e 0a20 2020 2020 2020 206f  return.        o
-00006a30: 6620 7468 6973 206d 6574 686f 6420 7765  f this method we
-00006a40: 2068 6176 6520 6060 7472 6565 2e69 6e74   have ``tree.int
-00006a50: 6572 7661 6c2e 6c65 6674 6060 203c 3d20  erval.left`` <= 
-00006a60: 6060 706f 7369 7469 6f6e 6060 0a20 2020  ``position``.   
-00006a70: 2020 2020 203c 2060 6074 7265 652e 696e       < ``tree.in
-00006a80: 7465 7276 616c 2e72 6967 6874 6060 2e0a  terval.right``..
-00006a90: 0a20 2020 2020 2020 202e 2e20 696e 636c  .        .. incl
-00006aa0: 7564 653a 3a20 7375 6273 7469 7475 7469  ude:: substituti
-00006ab0: 6f6e 732f 6c69 6e65 6172 5f74 7261 7665  ons/linear_trave
-00006ac0: 7273 616c 5f77 6172 6e69 6e67 2e72 7374  rsal_warning.rst
-00006ad0: 0a0a 2020 2020 2020 2020 3a70 6172 616d  ..        :param
-00006ae0: 2066 6c6f 6174 2070 6f73 6974 696f 6e3a   float position:
-00006af0: 2054 6865 2070 6f73 6974 696f 6e20 616c   The position al
-00006b00: 6f6e 6720 7468 6520 7365 7175 656e 6365  ong the sequence
-00006b10: 206c 656e 6774 6820 746f 0a20 2020 2020   length to.     
-00006b20: 2020 2020 2020 2073 6565 6b20 746f 2e0a         seek to..
-00006b30: 2020 2020 2020 2020 3a72 6169 7365 7320          :raises 
-00006b40: 5661 6c75 6545 7272 6f72 3a20 4966 2030  ValueError: If 0
-00006b50: 203c 2070 6f73 6974 696f 6e20 6f72 2070   < position or p
-00006b60: 6f73 6974 696f 6e20 3e3d 0a20 2020 2020  osition >=.     
-00006b70: 2020 2020 2020 203a 6174 7472 3a60 5472         :attr:`Tr
-00006b80: 6565 5365 7175 656e 6365 2e73 6571 7565  eeSequence.seque
-00006b90: 6e63 655f 6c65 6e67 7468 602e 0a20 2020  nce_length`..   
-00006ba0: 2020 2020 2022 2222 0a20 2020 2020 2020       """.       
-00006bb0: 2069 6620 706f 7369 7469 6f6e 203c 2030   if position < 0
-00006bc0: 206f 7220 706f 7369 7469 6f6e 203e 3d20   or position >= 
-00006bd0: 7365 6c66 2e74 7265 655f 7365 7175 656e  self.tree_sequen
-00006be0: 6365 2e73 6571 7565 6e63 655f 6c65 6e67  ce.sequence_leng
-00006bf0: 7468 3a0a 2020 2020 2020 2020 2020 2020  th:.            
-00006c00: 7261 6973 6520 5661 6c75 6545 7272 6f72  raise ValueError
-00006c10: 2822 506f 7369 7469 6f6e 206f 7574 206f  ("Position out o
-00006c20: 6620 626f 756e 6473 2229 0a20 2020 2020  f bounds").     
-00006c30: 2020 2073 656c 662e 5f6c 6c5f 7472 6565     self._ll_tree
-00006c40: 2e73 6565 6b28 706f 7369 7469 6f6e 290a  .seek(position).
-00006c50: 0a20 2020 2064 6566 2072 616e 6b28 7365  .    def rank(se
-00006c60: 6c66 2920 2d3e 2074 736b 6974 2e52 616e  lf) -> tskit.Ran
-00006c70: 6b3a 0a20 2020 2020 2020 2022 2222 0a20  k:.        """. 
-00006c80: 2020 2020 2020 2050 726f 6475 6365 2074         Produce t
-00006c90: 6865 2072 616e 6b20 6f66 2074 6869 7320  he rank of this 
-00006ca0: 7472 6565 2069 6e20 7468 6520 656e 756d  tree in the enum
-00006cb0: 6572 6174 696f 6e20 6f66 2061 6c6c 206c  eration of all l
-00006cc0: 6561 662d 6c61 6265 6c6c 6564 0a20 2020  eaf-labelled.   
-00006cd0: 2020 2020 2074 7265 6573 206f 6620 6e20       trees of n 
-00006ce0: 6c65 6176 6573 2e20 5365 6520 7468 6520  leaves. See the 
-00006cf0: 3a72 6566 3a60 7365 635f 7472 6565 5f72  :ref:`sec_tree_r
-00006d00: 616e 6b73 6020 7365 6374 696f 6e20 666f  anks` section fo
-00006d10: 720a 2020 2020 2020 2020 6465 7461 696c  r.        detail
-00006d20: 7320 6f6e 2072 616e 6b69 6e67 2061 6e64  s on ranking and
-00006d30: 2075 6e72 616e 6b69 6e67 2074 7265 6573   unranking trees
-00006d40: 2e0a 0a20 2020 2020 2020 203a 7261 6973  ...        :rais
-00006d50: 6573 2056 616c 7565 4572 726f 723a 2049  es ValueError: I
-00006d60: 6620 7468 6520 7472 6565 2068 6173 206d  f the tree has m
-00006d70: 756c 7469 706c 6520 726f 6f74 732e 0a20  ultiple roots.. 
-00006d80: 2020 2020 2020 2022 2222 0a20 2020 2020         """.     
-00006d90: 2020 2072 6574 7572 6e20 636f 6d62 696e     return combin
-00006da0: 6174 6f72 6963 732e 5261 6e6b 5472 6565  atorics.RankTree
-00006db0: 2e66 726f 6d5f 7473 6b5f 7472 6565 2873  .from_tsk_tree(s
-00006dc0: 656c 6629 2e72 616e 6b28 290a 0a20 2020  elf).rank()..   
-00006dd0: 2040 7374 6174 6963 6d65 7468 6f64 0a20   @staticmethod. 
-00006de0: 2020 2064 6566 2075 6e72 616e 6b28 6e75     def unrank(nu
-00006df0: 6d5f 6c65 6176 6573 2c20 7261 6e6b 2c20  m_leaves, rank, 
-00006e00: 2a2c 2073 7061 6e3d 312c 2062 7261 6e63  *, span=1, branc
-00006e10: 685f 6c65 6e67 7468 3d31 2920 2d3e 2054  h_length=1) -> T
-00006e20: 7265 653a 0a20 2020 2020 2020 2022 2222  ree:.        """
-00006e30: 0a20 2020 2020 2020 2052 6563 6f6e 7374  .        Reconst
-00006e40: 7275 6374 2074 6865 2074 7265 6520 6f66  ruct the tree of
-00006e50: 2074 6865 2067 6976 656e 2060 6072 616e   the given ``ran
-00006e60: 6b60 600a 2020 2020 2020 2020 2873 6565  k``.        (see
-00006e70: 203a 6d65 7468 3a60 7473 6b69 742e 5472   :meth:`tskit.Tr
-00006e80: 6565 2e72 616e 6b60 2920 7769 7468 2060  ee.rank`) with `
-00006e90: 606e 756d 5f6c 6561 7665 7360 6020 6c65  `num_leaves`` le
-00006ea0: 6176 6573 2e0a 2020 2020 2020 2020 5468  aves..        Th
-00006eb0: 6520 6c61 6265 6c73 2061 6e64 2074 696d  e labels and tim
-00006ec0: 6573 206f 6620 696e 7465 726e 616c 206e  es of internal n
-00006ed0: 6f64 6573 2061 7265 2061 7373 6967 6e65  odes are assigne
-00006ee0: 6420 6279 2061 2070 6f73 746f 7264 6572  d by a postorder
-00006ef0: 0a20 2020 2020 2020 2074 7261 7665 7273  .        travers
-00006f00: 616c 206f 6620 7468 6520 6e6f 6465 732c  al of the nodes,
-00006f10: 2073 7563 6820 7468 6174 2074 6865 2074   such that the t
-00006f20: 696d 6520 6f66 2065 6163 6820 696e 7465  ime of each inte
-00006f30: 726e 616c 206e 6f64 650a 2020 2020 2020  rnal node.      
-00006f40: 2020 6973 2074 6865 206d 6178 696d 756d    is the maximum
-00006f50: 2074 696d 6520 6f66 2069 7473 2063 6869   time of its chi
-00006f60: 6c64 7265 6e20 706c 7573 2074 6865 2073  ldren plus the s
-00006f70: 7065 6369 6669 6564 2060 6062 7261 6e63  pecified ``branc
-00006f80: 685f 6c65 6e67 7468 6060 2e0a 2020 2020  h_length``..    
-00006f90: 2020 2020 5468 6520 7469 6d65 206f 6620      The time of 
-00006fa0: 6561 6368 206c 6561 6620 6973 2030 2e0a  each leaf is 0..
-00006fb0: 0a20 2020 2020 2020 2053 6565 2074 6865  .        See the
-00006fc0: 203a 7265 663a 6073 6563 5f74 7265 655f   :ref:`sec_tree_
-00006fd0: 7261 6e6b 7360 2073 6563 7469 6f6e 2066  ranks` section f
-00006fe0: 6f72 2064 6574 6169 6c73 206f 6e20 7261  or details on ra
-00006ff0: 6e6b 696e 6720 616e 640a 2020 2020 2020  nking and.      
-00007000: 2020 756e 7261 6e6b 696e 6720 7472 6565    unranking tree
-00007010: 7320 616e 6420 7768 6174 2063 6f6e 7374  s and what const
-00007020: 6974 7574 6573 2076 616c 6964 2072 616e  itutes valid ran
-00007030: 6b73 2e0a 0a20 2020 2020 2020 203a 7061  ks...        :pa
-00007040: 7261 6d20 696e 7420 6e75 6d5f 6c65 6176  ram int num_leav
-00007050: 6573 3a20 5468 6520 6e75 6d62 6572 206f  es: The number o
-00007060: 6620 6c65 6176 6573 206f 6620 7468 6520  f leaves of the 
-00007070: 7472 6565 2074 6f20 6765 6e65 7261 7465  tree to generate
-00007080: 2e0a 2020 2020 2020 2020 3a70 6172 616d  ..        :param
-00007090: 2074 7570 6c65 2869 6e74 2920 7261 6e6b   tuple(int) rank
-000070a0: 3a20 5468 6520 7261 6e6b 206f 6620 7468  : The rank of th
-000070b0: 6520 7472 6565 2074 6f20 6765 6e65 7261  e tree to genera
-000070c0: 7465 2e0a 2020 2020 2020 2020 3a70 6172  te..        :par
-000070d0: 616d 2066 6c6f 6174 2073 7061 6e3a 2054  am float span: T
-000070e0: 6865 2067 656e 6f6d 6963 2073 7061 6e20  he genomic span 
-000070f0: 6f66 2074 6865 2072 6574 7572 6e65 6420  of the returned 
-00007100: 7472 6565 2e20 5468 6520 7472 6565 2077  tree. The tree w
-00007110: 696c 6c20 636f 7665 720a 2020 2020 2020  ill cover.      
-00007120: 2020 2020 2020 7468 6520 696e 7465 7276        the interv
-00007130: 616c 203a 6d61 7468 3a60 5b30 2c20 5c5c  al :math:`[0, \\
-00007140: 7465 7874 7b73 7061 6e7d 2960 2061 6e64  text{span})` and
-00007150: 2074 6865 203a 6174 7472 3a60 7e54 7265   the :attr:`~Tre
-00007160: 652e 7472 6565 5f73 6571 7565 6e63 6560  e.tree_sequence`
-00007170: 0a20 2020 2020 2020 2020 2020 2066 726f  .            fro
-00007180: 6d20 7768 6963 6820 7468 6520 7472 6565  m which the tree
-00007190: 2069 7320 7461 6b65 6e20 7769 6c6c 2068   is taken will h
-000071a0: 6176 6520 6974 730a 2020 2020 2020 2020  ave its.        
-000071b0: 2020 2020 3a61 7474 723a 607e 7473 6b69      :attr:`~tski
-000071c0: 742e 5472 6565 5365 7175 656e 6365 2e73  t.TreeSequence.s
-000071d0: 6571 7565 6e63 655f 6c65 6e67 7468 6020  equence_length` 
-000071e0: 6571 7561 6c20 746f 2060 6073 7061 6e60  equal to ``span`
-000071f0: 602e 0a20 2020 2020 2020 203a 7061 7261  `..        :para
-00007200: 6d3a 2066 6c6f 6174 2062 7261 6e63 685f  m: float branch_
-00007210: 6c65 6e67 7468 3a20 5468 6520 6d69 6e69  length: The mini
-00007220: 6d75 6d20 6c65 6e67 7468 206f 6620 6120  mum length of a 
-00007230: 6272 616e 6368 2069 6e20 7468 6973 2074  branch in this t
-00007240: 7265 652e 0a20 2020 2020 2020 203a 7261  ree..        :ra
-00007250: 6973 6573 3a20 5661 6c75 6545 7272 6f72  ises: ValueError
-00007260: 3a20 4966 2074 6865 2067 6976 656e 2072  : If the given r
-00007270: 616e 6b20 6973 206f 7574 206f 6620 626f  ank is out of bo
-00007280: 756e 6473 2066 6f72 2074 7265 6573 0a20  unds for trees. 
-00007290: 2020 2020 2020 2020 2020 2077 6974 6820             with 
-000072a0: 6060 6e75 6d5f 6c65 6176 6573 6060 206c  ``num_leaves`` l
-000072b0: 6561 7665 732e 0a20 2020 2020 2020 2022  eaves..        "
-000072c0: 2222 0a20 2020 2020 2020 2072 616e 6b5f  "".        rank_
-000072d0: 7472 6565 203d 2063 6f6d 6269 6e61 746f  tree = combinato
-000072e0: 7269 6373 2e52 616e 6b54 7265 652e 756e  rics.RankTree.un
-000072f0: 7261 6e6b 286e 756d 5f6c 6561 7665 732c  rank(num_leaves,
-00007300: 2072 616e 6b29 0a20 2020 2020 2020 2072   rank).        r
-00007310: 6574 7572 6e20 7261 6e6b 5f74 7265 652e  eturn rank_tree.
-00007320: 746f 5f74 736b 5f74 7265 6528 7370 616e  to_tsk_tree(span
-00007330: 3d73 7061 6e2c 2062 7261 6e63 685f 6c65  =span, branch_le
-00007340: 6e67 7468 3d62 7261 6e63 685f 6c65 6e67  ngth=branch_leng
-00007350: 7468 290a 0a20 2020 2064 6566 2063 6f75  th)..    def cou
-00007360: 6e74 5f74 6f70 6f6c 6f67 6965 7328 7365  nt_topologies(se
-00007370: 6c66 2c20 7361 6d70 6c65 5f73 6574 733d  lf, sample_sets=
-00007380: 4e6f 6e65 2920 2d3e 2074 736b 6974 2e54  None) -> tskit.T
-00007390: 6f70 6f6c 6f67 7943 6f75 6e74 6572 3a0a  opologyCounter:.
-000073a0: 2020 2020 2020 2020 2222 220a 2020 2020          """.    
-000073b0: 2020 2020 4361 6c63 756c 6174 6573 2074      Calculates t
-000073c0: 6865 2064 6973 7472 6962 7574 696f 6e20  he distribution 
-000073d0: 6f66 2065 6d62 6564 6465 6420 746f 706f  of embedded topo
-000073e0: 6c6f 6769 6573 2066 6f72 2065 7665 7279  logies for every
-000073f0: 2063 6f6d 6269 6e61 7469 6f6e 0a20 2020   combination.   
-00007400: 2020 2020 206f 6620 7468 6520 7361 6d70       of the samp
-00007410: 6c65 2073 6574 7320 696e 2060 6073 616d  le sets in ``sam
-00007420: 706c 655f 7365 7473 6060 2e20 6060 7361  ple_sets``. ``sa
-00007430: 6d70 6c65 5f73 6574 7360 6020 6465 6661  mple_sets`` defa
-00007440: 756c 7473 2074 6f20 616c 6c0a 2020 2020  ults to all.    
-00007450: 2020 2020 7361 6d70 6c65 7320 696e 2074      samples in t
-00007460: 6865 2074 7265 6520 6772 6f75 7065 6420  he tree grouped 
-00007470: 6279 2070 6f70 756c 6174 696f 6e2e 0a0a  by population...
-00007480: 2020 2020 2020 2020 6060 7361 6d70 6c65          ``sample
-00007490: 5f73 6574 7360 6020 6e65 6564 206e 6f74  _sets`` need not
-000074a0: 2069 6e63 6c75 6465 2061 6c6c 2073 616d   include all sam
-000074b0: 706c 6573 2062 7574 206d 7573 7420 6265  ples but must be
-000074c0: 2070 6169 7277 6973 6520 6469 736a 6f69   pairwise disjoi
-000074d0: 6e74 2e0a 0a20 2020 2020 2020 2054 6865  nt...        The
-000074e0: 2072 6574 7572 6e65 6420 6f62 6a65 6374   returned object
-000074f0: 2069 7320 6120 3a63 6c61 7373 3a60 7473   is a :class:`ts
-00007500: 6b69 742e 546f 706f 6c6f 6779 436f 756e  kit.TopologyCoun
-00007510: 7465 7260 2074 6861 7420 636f 6e74 6169  ter` that contai
-00007520: 6e73 0a20 2020 2020 2020 2063 6f75 6e74  ns.        count
-00007530: 7320 6f66 2074 6f70 6f6c 6f67 6965 7320  s of topologies 
-00007540: 7065 7220 636f 6d62 696e 6174 696f 6e20  per combination 
-00007550: 6f66 2073 616d 706c 6520 7365 7473 2e20  of sample sets. 
-00007560: 466f 7220 6578 616d 706c 652c 0a0a 2020  For example,..  
-00007570: 2020 2020 2020 3e3e 3e20 746f 706f 6c6f        >>> topolo
-00007580: 6779 5f63 6f75 6e74 6572 203d 2074 7265  gy_counter = tre
-00007590: 652e 636f 756e 745f 746f 706f 6c6f 6769  e.count_topologi
-000075a0: 6573 2829 0a20 2020 2020 2020 203e 3e3e  es().        >>>
-000075b0: 2072 616e 6b2c 2063 6f75 6e74 203d 2074   rank, count = t
-000075c0: 6f70 6f6c 6f67 795f 636f 756e 7465 725b  opology_counter[
-000075d0: 302c 2031 2c20 325d 2e6d 6f73 745f 636f  0, 1, 2].most_co
-000075e0: 6d6d 6f6e 2831 295b 305d 0a0a 2020 2020  mmon(1)[0]..    
-000075f0: 2020 2020 7072 6f64 7563 6573 2074 6865      produces the
-00007600: 206d 6f73 7420 636f 6d6d 6f6e 2074 7265   most common tre
-00007610: 6520 746f 706f 6c6f 6779 2c20 7769 7468  e topology, with
-00007620: 2070 6f70 756c 6174 696f 6e73 2030 2c20   populations 0, 
-00007630: 310a 2020 2020 2020 2020 616e 6420 3220  1.        and 2 
-00007640: 6173 2069 7473 2074 6970 732c 2061 6363  as its tips, acc
-00007650: 6f72 6469 6e67 2074 6f20 7468 6520 6765  ording to the ge
-00007660: 6e65 616c 6f67 6965 7320 6f66 2074 686f  nealogies of tho
-00007670: 7365 0a20 2020 2020 2020 2070 6f70 756c  se.        popul
-00007680: 6174 696f 6e73 2720 7361 6d70 6c65 7320  ations' samples 
-00007690: 696e 2074 6869 7320 7472 6565 2e0a 0a20  in this tree... 
-000076a0: 2020 2020 2020 2054 6865 2063 6f75 6e74         The count
-000076b0: 7320 666f 7220 6561 6368 2074 6f70 6f6c  s for each topol
-000076c0: 6f67 7920 696e 2074 6865 203a 636c 6173  ogy in the :clas
-000076d0: 733a 6074 736b 6974 2e54 6f70 6f6c 6f67  s:`tskit.Topolog
-000076e0: 7943 6f75 6e74 6572 600a 2020 2020 2020  yCounter`.      
-000076f0: 2020 6172 6520 6162 736f 6c75 7465 2063    are absolute c
-00007700: 6f75 6e74 7320 7468 6174 2077 6520 776f  ounts that we wo
-00007710: 756c 6420 6765 7420 6966 2077 6520 7765  uld get if we we
-00007720: 7265 2074 6f20 7365 6c65 6374 2061 6c6c  re to select all
-00007730: 0a20 2020 2020 2020 2063 6f6d 6269 6e61  .        combina
-00007740: 7469 6f6e 7320 6f66 2073 616d 706c 6573  tions of samples
-00007750: 2066 726f 6d20 7468 6520 7265 6c65 7661   from the releva
-00007760: 6e74 2073 616d 706c 6520 7365 7473 2e0a  nt sample sets..
-00007770: 2020 2020 2020 2020 466f 7220 7361 6d70          For samp
-00007780: 6c65 2073 6574 7320 3a6d 6174 683a 605b  le sets :math:`[
-00007790: 735f 302c 2073 5f31 2c20 2e2e 2e2c 2073  s_0, s_1, ..., s
-000077a0: 5f6e 5d60 2c20 7468 6520 746f 7461 6c20  _n]`, the total 
-000077b0: 6e75 6d62 6572 206f 660a 2020 2020 2020  number of.      
-000077c0: 2020 746f 706f 6c6f 6769 6573 2066 6f72    topologies for
-000077d0: 2074 686f 7365 2073 616d 706c 6520 7365   those sample se
-000077e0: 7473 2069 7320 6571 7561 6c20 746f 0a20  ts is equal to. 
-000077f0: 2020 2020 2020 203a 6d61 7468 3a60 7c73         :math:`|s
-00007800: 5f30 7c20 2a20 7c73 5f31 7c20 2a20 2e2e  _0| * |s_1| * ..
-00007810: 2e20 2a20 7c73 5f6e 7c60 2c20 736f 2074  . * |s_n|`, so t
-00007820: 6865 2063 6f75 6e74 7320 696e 2074 6865  he counts in the
-00007830: 2063 6f75 6e74 6572 0a20 2020 2020 2020   counter.       
-00007840: 2060 6074 6f70 6f6c 6f67 795f 636f 756e   ``topology_coun
-00007850: 7465 725b 302c 2031 2c20 2e2e 2e2c 206e  ter[0, 1, ..., n
-00007860: 5d60 6020 7368 6f75 6c64 2073 756d 2074  ]`` should sum t
-00007870: 6f0a 2020 2020 2020 2020 3a6d 6174 683a  o.        :math:
-00007880: 607c 735f 307c 202a 207c 735f 317c 202a  `|s_0| * |s_1| *
-00007890: 202e 2e2e 202a 207c 735f 6e7c 602e 0a0a   ... * |s_n|`...
-000078a0: 2020 2020 2020 2020 546f 2063 6f6e 7665          To conve
-000078b0: 7274 2074 6865 2074 6f70 6f6c 6f67 7920  rt the topology 
-000078c0: 636f 756e 7473 2074 6f20 7072 6f62 6162  counts to probab
-000078d0: 696c 6974 6965 732c 2064 6976 6964 6520  ilities, divide 
-000078e0: 6279 2074 6865 2074 6f74 616c 0a20 2020  by the total.   
-000078f0: 2020 2020 2070 6f73 7369 626c 6520 6e75       possible nu
-00007900: 6d62 6572 206f 6620 7361 6d70 6c65 2063  mber of sample c
-00007910: 6f6d 6269 6e61 7469 6f6e 7320 6672 6f6d  ombinations from
-00007920: 2074 6865 2073 616d 706c 6520 7365 7473   the sample sets
-00007930: 2069 6e20 7175 6573 7469 6f6e 3a3a 0a0a   in question::..
-00007940: 2020 2020 2020 2020 2020 2020 3e3e 3e20              >>> 
-00007950: 7365 745f 7369 7a65 7320 3d20 5b6c 656e  set_sizes = [len
-00007960: 2873 616d 706c 655f 7365 7429 2066 6f72  (sample_set) for
-00007970: 2073 616d 706c 655f 7365 7420 696e 2073   sample_set in s
-00007980: 616d 706c 655f 7365 7473 5d0a 2020 2020  ample_sets].    
-00007990: 2020 2020 2020 2020 3e3e 3e20 7020 3d20          >>> p = 
-000079a0: 636f 756e 7420 2f20 2873 6574 5f73 697a  count / (set_siz
-000079b0: 6573 5b30 5d20 2a20 7365 745f 7369 7a65  es[0] * set_size
-000079c0: 735b 315d 202a 2073 6574 5f73 697a 6573  s[1] * set_sizes
-000079d0: 5b32 5d29 0a0a 2020 2020 2020 2020 2e2e  [2])..        ..
-000079e0: 2077 6172 6e69 6e67 3a3a 2054 6865 2069   warning:: The i
-000079f0: 6e74 6572 6661 6365 2066 6f72 2074 6869  nterface for thi
-00007a00: 7320 6d65 7468 6f64 2069 7320 7072 656c  s method is prel
-00007a10: 696d 696e 6172 7920 616e 6420 6d61 7920  iminary and may 
-00007a20: 6265 2073 7562 6a65 6374 2074 6f0a 2020  be subject to.  
-00007a30: 2020 2020 2020 2020 2020 6261 636b 7761            backwa
-00007a40: 7264 7320 696e 636f 6d70 6174 6962 6c65  rds incompatible
-00007a50: 2063 6861 6e67 6573 2069 6e20 7468 6520   changes in the 
-00007a60: 6e65 6172 2066 7574 7572 652e 0a0a 2020  near future...  
-00007a70: 2020 2020 2020 3a70 6172 616d 206c 6973        :param lis
-00007a80: 7420 7361 6d70 6c65 5f73 6574 733a 2041  t sample_sets: A
-00007a90: 206c 6973 7420 6f66 206c 6973 7473 206f   list of lists o
-00007aa0: 6620 4e6f 6465 2049 4473 2c20 7370 6563  f Node IDs, spec
-00007ab0: 6966 7969 6e67 2074 6865 0a20 2020 2020  ifying the.     
-00007ac0: 2020 2020 2020 2067 726f 7570 7320 6f66         groups of
-00007ad0: 206e 6f64 6573 2074 6f20 636f 6d70 7574   nodes to comput
-00007ae0: 6520 7468 6520 7374 6174 6973 7469 6320  e the statistic 
-00007af0: 7769 7468 2e0a 2020 2020 2020 2020 2020  with..          
-00007b00: 2020 4465 6661 756c 7473 2074 6f20 616c    Defaults to al
-00007b10: 6c20 7361 6d70 6c65 7320 6772 6f75 7065  l samples groupe
-00007b20: 6420 6279 2070 6f70 756c 6174 696f 6e2e  d by population.
-00007b30: 0a20 2020 2020 2020 203a 7261 6973 6573  .        :raises
-00007b40: 2056 616c 7565 4572 726f 723a 2049 6620   ValueError: If 
-00007b50: 6e6f 6465 7320 696e 2060 6073 616d 706c  nodes in ``sampl
-00007b60: 655f 7365 7473 6060 2061 7265 2069 6e76  e_sets`` are inv
-00007b70: 616c 6964 206f 7220 6172 650a 2020 2020  alid or are.    
-00007b80: 2020 2020 2020 2020 696e 7465 726e 616c          internal
-00007b90: 2073 616d 706c 6573 2e0a 2020 2020 2020   samples..      
-00007ba0: 2020 2222 220a 2020 2020 2020 2020 6966    """.        if
-00007bb0: 2073 616d 706c 655f 7365 7473 2069 7320   sample_sets is 
-00007bc0: 4e6f 6e65 3a0a 2020 2020 2020 2020 2020  None:.          
-00007bd0: 2020 7361 6d70 6c65 5f73 6574 7320 3d20    sample_sets = 
-00007be0: 5b0a 2020 2020 2020 2020 2020 2020 2020  [.              
-00007bf0: 2020 7365 6c66 2e74 7265 655f 7365 7175    self.tree_sequ
-00007c00: 656e 6365 2e73 616d 706c 6573 2870 6f70  ence.samples(pop
-00007c10: 756c 6174 696f 6e3d 706f 702e 6964 290a  ulation=pop.id).
-00007c20: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00007c30: 666f 7220 706f 7020 696e 2073 656c 662e  for pop in self.
-00007c40: 7472 6565 5f73 6571 7565 6e63 652e 706f  tree_sequence.po
-00007c50: 7075 6c61 7469 6f6e 7328 290a 2020 2020  pulations().    
-00007c60: 2020 2020 2020 2020 5d0a 0a20 2020 2020          ]..     
-00007c70: 2020 2072 6574 7572 6e20 636f 6d62 696e     return combin
-00007c80: 6174 6f72 6963 732e 7472 6565 5f63 6f75  atorics.tree_cou
-00007c90: 6e74 5f74 6f70 6f6c 6f67 6965 7328 7365  nt_topologies(se
-00007ca0: 6c66 2c20 7361 6d70 6c65 5f73 6574 7329  lf, sample_sets)
-00007cb0: 0a0a 2020 2020 6465 6620 6765 745f 6272  ..    def get_br
-00007cc0: 616e 6368 5f6c 656e 6774 6828 7365 6c66  anch_length(self
-00007cd0: 2c20 7529 3a0a 2020 2020 2020 2020 2320  , u):.        # 
-00007ce0: 4465 7072 6563 6174 6564 2061 6c69 6173  Deprecated alias
-00007cf0: 2066 6f72 2062 7261 6e63 685f 6c65 6e67   for branch_leng
-00007d00: 7468 0a20 2020 2020 2020 2072 6574 7572  th.        retur
-00007d10: 6e20 7365 6c66 2e62 7261 6e63 685f 6c65  n self.branch_le
-00007d20: 6e67 7468 2875 290a 0a20 2020 2064 6566  ngth(u)..    def
-00007d30: 2062 7261 6e63 685f 6c65 6e67 7468 2873   branch_length(s
-00007d40: 656c 662c 2075 293a 0a20 2020 2020 2020  elf, u):.       
-00007d50: 2022 2222 0a20 2020 2020 2020 2052 6574   """.        Ret
-00007d60: 7572 6e73 2074 6865 206c 656e 6774 6820  urns the length 
-00007d70: 6f66 2074 6865 2062 7261 6e63 6820 2869  of the branch (i
-00007d80: 6e20 756e 6974 7320 6f66 2074 696d 6529  n units of time)
-00007d90: 206a 6f69 6e69 6e67 2074 6865 0a20 2020   joining the.   
-00007da0: 2020 2020 2073 7065 6369 6669 6564 206e       specified n
-00007db0: 6f64 6520 746f 2069 7473 2070 6172 656e  ode to its paren
-00007dc0: 742e 2054 6869 7320 6973 2065 7175 6976  t. This is equiv
-00007dd0: 616c 656e 7420 746f 0a0a 2020 2020 2020  alent to..      
-00007de0: 2020 3e3e 3e20 7472 6565 2e74 696d 6528    >>> tree.time(
-00007df0: 7472 6565 2e70 6172 656e 7428 7529 2920  tree.parent(u)) 
-00007e00: 2d20 7472 6565 2e74 696d 6528 7529 0a0a  - tree.time(u)..
-00007e10: 2020 2020 2020 2020 5468 6520 6272 616e          The bran
-00007e20: 6368 206c 656e 6774 6820 666f 7220 6120  ch length for a 
-00007e30: 6e6f 6465 2074 6861 7420 6861 7320 6e6f  node that has no
-00007e40: 2070 6172 656e 7420 2865 2e67 2e2c 2061   parent (e.g., a
-00007e50: 2072 6f6f 7429 2069 730a 2020 2020 2020   root) is.      
-00007e60: 2020 6465 6669 6e65 6420 6173 207a 6572    defined as zer
-00007e70: 6f2e 0a0a 2020 2020 2020 2020 4e6f 7465  o...        Note
-00007e80: 2074 6861 7420 7468 6973 2069 7320 6e6f   that this is no
-00007e90: 7420 7265 6c61 7465 6420 746f 2074 6865  t related to the
-00007ea0: 2070 726f 7065 7274 7920 602e 6c65 6e67   property `.leng
-00007eb0: 7468 6020 7768 6963 680a 2020 2020 2020  th` which.      
-00007ec0: 2020 6973 2061 2064 6570 7265 6361 7465    is a deprecate
-00007ed0: 6420 616c 6961 7320 666f 7220 7468 6520  d alias for the 
-00007ee0: 6765 6e6f 6d69 6320 3a61 7474 723a 607e  genomic :attr:`~
-00007ef0: 5472 6565 2e73 7061 6e60 2063 6f76 6572  Tree.span` cover
-00007f00: 6564 2062 7920 6120 7472 6565 2e0a 0a20  ed by a tree... 
-00007f10: 2020 2020 2020 203a 7061 7261 6d20 696e         :param in
-00007f20: 7420 753a 2054 6865 206e 6f64 6520 6f66  t u: The node of
-00007f30: 2069 6e74 6572 6573 742e 0a20 2020 2020   interest..     
-00007f40: 2020 203a 7265 7475 726e 3a20 5468 6520     :return: The 
-00007f50: 6272 616e 6368 206c 656e 6774 6820 6672  branch length fr
-00007f60: 6f6d 2075 2074 6f20 6974 7320 7061 7265  om u to its pare
-00007f70: 6e74 2e0a 2020 2020 2020 2020 3a72 7479  nt..        :rty
-00007f80: 7065 3a20 666c 6f61 740a 2020 2020 2020  pe: float.      
-00007f90: 2020 2222 220a 2020 2020 2020 2020 7265    """.        re
-00007fa0: 7420 3d20 300a 2020 2020 2020 2020 7061  t = 0.        pa
-00007fb0: 7265 6e74 203d 2073 656c 662e 7061 7265  rent = self.pare
-00007fc0: 6e74 2875 290a 2020 2020 2020 2020 6966  nt(u).        if
-00007fd0: 2070 6172 656e 7420 213d 204e 554c 4c3a   parent != NULL:
-00007fe0: 0a20 2020 2020 2020 2020 2020 2072 6574  .            ret
-00007ff0: 203d 2073 656c 662e 7469 6d65 2870 6172   = self.time(par
-00008000: 656e 7429 202d 2073 656c 662e 7469 6d65  ent) - self.time
-00008010: 2875 290a 2020 2020 2020 2020 7265 7475  (u).        retu
-00008020: 726e 2072 6574 0a0a 2020 2020 6465 6620  rn ret..    def 
-00008030: 6765 745f 746f 7461 6c5f 6272 616e 6368  get_total_branch
-00008040: 5f6c 656e 6774 6828 7365 6c66 293a 0a20  _length(self):. 
-00008050: 2020 2020 2020 2023 2044 6570 7265 6361         # Depreca
-00008060: 7465 6420 616c 6961 7320 666f 7220 746f  ted alias for to
-00008070: 7461 6c5f 6272 616e 6368 5f6c 656e 6774  tal_branch_lengt
-00008080: 680a 2020 2020 2020 2020 7265 7475 726e  h.        return
-00008090: 2073 656c 662e 746f 7461 6c5f 6272 616e   self.total_bran
-000080a0: 6368 5f6c 656e 6774 680a 0a20 2020 2040  ch_length..    @
-000080b0: 7072 6f70 6572 7479 0a20 2020 2064 6566  property.    def
-000080c0: 2074 6f74 616c 5f62 7261 6e63 685f 6c65   total_branch_le
-000080d0: 6e67 7468 2873 656c 6629 3a0a 2020 2020  ngth(self):.    
-000080e0: 2020 2020 2222 220a 2020 2020 2020 2020      """.        
-000080f0: 5265 7475 726e 7320 7468 6520 7375 6d20  Returns the sum 
-00008100: 6f66 2061 6c6c 2074 6865 2062 7261 6e63  of all the branc
-00008110: 6820 6c65 6e67 7468 7320 696e 2074 6869  h lengths in thi
-00008120: 7320 7472 6565 2028 696e 0a20 2020 2020  s tree (in.     
-00008130: 2020 2075 6e69 7473 206f 6620 7469 6d65     units of time
-00008140: 292e 2054 6869 7320 6973 2065 7175 6976  ). This is equiv
-00008150: 616c 656e 7420 746f 0a0a 2020 2020 2020  alent to..      
-00008160: 2020 3e3e 3e20 7375 6d28 7472 6565 2e62    >>> sum(tree.b
-00008170: 7261 6e63 685f 6c65 6e67 7468 2875 2920  ranch_length(u) 
-00008180: 666f 7220 7520 696e 2074 7265 652e 6e6f  for u in tree.no
-00008190: 6465 7328 2929 0a0a 2020 2020 2020 2020  des())..        
-000081a0: 4e6f 7465 2074 6861 7420 7468 6520 6272  Note that the br
-000081b0: 616e 6368 206c 656e 6774 6873 2066 6f72  anch lengths for
-000081c0: 2072 6f6f 7420 6e6f 6465 7320 6172 6520   root nodes are 
-000081d0: 6465 6669 6e65 6420 6173 207a 6572 6f2e  defined as zero.
-000081e0: 0a0a 2020 2020 2020 2020 4173 2074 6869  ..        As thi
-000081f0: 7320 6973 2064 6566 696e 6564 2062 7920  s is defined by 
-00008200: 6120 7472 6176 6572 7361 6c20 6f66 2074  a traversal of t
-00008210: 6865 2074 7265 652c 2074 6563 686e 6963  he tree, technic
-00008220: 616c 6c79 2077 650a 2020 2020 2020 2020  ally we.        
-00008230: 7265 7475 726e 2074 6865 2073 756d 206f  return the sum o
-00008240: 6620 616c 6c20 6272 616e 6368 206c 656e  f all branch len
-00008250: 6774 6873 2074 6861 7420 6172 6520 7265  gths that are re
-00008260: 6163 6861 626c 6520 6672 6f6d 0a20 2020  achable from.   
-00008270: 2020 2020 2072 6f6f 7473 2e20 5468 7573       roots. Thus
-00008280: 2c20 7468 6973 2069 7320 7468 6520 746f  , this is the to
-00008290: 7461 6c20 6c65 6e67 7468 206f 6620 616c  tal length of al
-000082a0: 6c20 6272 616e 6368 6573 2074 6861 7420  l branches that 
-000082b0: 6172 6520 636f 6e6e 6563 7465 640a 2020  are connected.  
-000082c0: 2020 2020 2020 746f 2061 7420 6c65 6173        to at leas
-000082d0: 7420 6f6e 6520 7361 6d70 6c65 2e20 5468  t one sample. Th
-000082e0: 6973 2064 6973 7469 6e63 7469 6f6e 2069  is distinction i
-000082f0: 7320 6f6e 6c79 2069 6d70 6f72 7461 6e74  s only important
-00008300: 0a20 2020 2020 2020 2069 6e20 7472 6565  .        in tree
-00008310: 2073 6571 7565 6e63 6573 2074 6861 7420   sequences that 
-00008320: 636f 6e74 6169 6e20 2764 6561 6420 6272  contain 'dead br
-00008330: 616e 6368 6573 272c 2069 2e65 2e2c 2074  anches', i.e., t
-00008340: 686f 7365 0a20 2020 2020 2020 2074 6861  hose.        tha
-00008350: 7420 6465 6669 6e65 2074 6f70 6f6c 6f67  t define topolog
-00008360: 7920 7468 6174 2069 7320 6e6f 7420 636f  y that is not co
-00008370: 6e6e 6563 7465 6420 746f 2061 2074 7265  nnected to a tre
-00008380: 6520 726f 6f74 0a20 2020 2020 2020 2028  e root.        (
-00008390: 7365 6520 3a72 6566 3a60 7365 635f 6461  see :ref:`sec_da
-000083a0: 7461 5f6d 6f64 656c 5f74 7265 655f 6465  ta_model_tree_de
-000083b0: 6164 5f6c 6561 7665 735f 616e 645f 6272  ad_leaves_and_br
-000083c0: 616e 6368 6573 6029 0a0a 2020 2020 2020  anches`)..      
-000083d0: 2020 3a72 6574 7572 6e3a 2054 6865 2073    :return: The s
-000083e0: 756d 206f 6620 6c65 6e67 7468 7320 6f66  um of lengths of
-000083f0: 2062 7261 6e63 6865 7320 696e 2074 6869   branches in thi
-00008400: 7320 7472 6565 2e0a 2020 2020 2020 2020  s tree..        
-00008410: 3a72 7479 7065 3a20 666c 6f61 740a 2020  :rtype: float.  
-00008420: 2020 2020 2020 2222 220a 2020 2020 2020        """.      
-00008430: 2020 7265 7475 726e 2073 656c 662e 5f6c    return self._l
-00008440: 6c5f 7472 6565 2e67 6574 5f74 6f74 616c  l_tree.get_total
-00008450: 5f62 7261 6e63 685f 6c65 6e67 7468 2829  _branch_length()
-00008460: 0a0a 2020 2020 6465 6620 6765 745f 6d72  ..    def get_mr
-00008470: 6361 2873 656c 662c 2075 2c20 7629 3a0a  ca(self, u, v):.
-00008480: 2020 2020 2020 2020 2320 4465 7072 6563          # Deprec
-00008490: 6174 6564 2061 6c69 6173 2066 6f72 206d  ated alias for m
-000084a0: 7263 610a 2020 2020 2020 2020 7265 7475  rca.        retu
-000084b0: 726e 2073 656c 662e 6d72 6361 2875 2c20  rn self.mrca(u, 
-000084c0: 7629 0a0a 2020 2020 6465 6620 6d72 6361  v)..    def mrca
-000084d0: 2873 656c 662c 202a 6172 6773 293a 0a20  (self, *args):. 
-000084e0: 2020 2020 2020 2022 2222 0a20 2020 2020         """.     
-000084f0: 2020 2052 6574 7572 6e73 2074 6865 206d     Returns the m
-00008500: 6f73 7420 7265 6365 6e74 2063 6f6d 6d6f  ost recent commo
-00008510: 6e20 616e 6365 7374 6f72 206f 6620 7468  n ancestor of th
-00008520: 6520 7370 6563 6966 6965 6420 6e6f 6465  e specified node
-00008530: 732e 0a0a 2020 2020 2020 2020 3a70 6172  s...        :par
-00008540: 616d 2069 6e74 2060 2a61 7267 7360 3a20  am int `*args`: 
-00008550: 696e 7075 7420 6e6f 6465 2049 4473 2c20  input node IDs, 
-00008560: 6d75 7374 2062 6520 6174 206c 6561 7374  must be at least
-00008570: 2032 2e0a 2020 2020 2020 2020 3a72 6574   2..        :ret
-00008580: 7572 6e3a 2054 6865 206d 6f73 7420 7265  urn: The most re
-00008590: 6365 6e74 2063 6f6d 6d6f 6e20 616e 6365  cent common ance
-000085a0: 7374 6f72 206f 6620 696e 7075 7420 6e6f  stor of input no
-000085b0: 6465 732e 0a20 2020 2020 2020 203a 7274  des..        :rt
-000085c0: 7970 653a 2069 6e74 0a20 2020 2020 2020  ype: int.       
-000085d0: 2022 2222 0a20 2020 2020 2020 2069 6620   """.        if 
-000085e0: 6c65 6e28 6172 6773 2920 3c20 323a 0a20  len(args) < 2:. 
-000085f0: 2020 2020 2020 2020 2020 2072 6169 7365             raise
-00008600: 2056 616c 7565 4572 726f 7228 224d 7573   ValueError("Mus
-00008610: 7420 7375 7070 6c79 2061 7420 6c65 6173  t supply at leas
-00008620: 7420 7477 6f20 6172 6775 6d65 6e74 7322  t two arguments"
-00008630: 290a 2020 2020 2020 2020 6d72 6361 203d  ).        mrca =
-00008640: 2061 7267 735b 305d 0a20 2020 2020 2020   args[0].       
-00008650: 2066 6f72 206e 6f64 6520 696e 2061 7267   for node in arg
-00008660: 735b 313a 5d3a 0a20 2020 2020 2020 2020  s[1:]:.         
-00008670: 2020 206d 7263 6120 3d20 7365 6c66 2e5f     mrca = self._
-00008680: 6c6c 5f74 7265 652e 6765 745f 6d72 6361  ll_tree.get_mrca
-00008690: 286d 7263 612c 206e 6f64 6529 0a20 2020  (mrca, node).   
-000086a0: 2020 2020 2020 2020 2069 6620 6d72 6361           if mrca
-000086b0: 203d 3d20 7473 6b69 742e 4e55 4c4c 3a0a   == tskit.NULL:.
-000086c0: 2020 2020 2020 2020 2020 2020 2020 2020                  
-000086d0: 6272 6561 6b0a 2020 2020 2020 2020 7265  break.        re
-000086e0: 7475 726e 206d 7263 610a 0a20 2020 2064  turn mrca..    d
-000086f0: 6566 2067 6574 5f74 6d72 6361 2873 656c  ef get_tmrca(sel
-00008700: 662c 2075 2c20 7629 3a0a 2020 2020 2020  f, u, v):.      
-00008710: 2020 2320 4465 7072 6563 6174 6564 2061    # Deprecated a
-00008720: 6c69 6173 2066 6f72 2074 6d72 6361 0a20  lias for tmrca. 
-00008730: 2020 2020 2020 2072 6574 7572 6e20 7365         return se
-00008740: 6c66 2e74 6d72 6361 2875 2c20 7629 0a0a  lf.tmrca(u, v)..
-00008750: 2020 2020 6465 6620 746d 7263 6128 7365      def tmrca(se
-00008760: 6c66 2c20 752c 2076 293a 0a20 2020 2020  lf, u, v):.     
-00008770: 2020 2022 2222 0a20 2020 2020 2020 2052     """.        R
-00008780: 6574 7572 6e73 2074 6865 2074 696d 6520  eturns the time 
-00008790: 6f66 2074 6865 206d 6f73 7420 7265 6365  of the most rece
-000087a0: 6e74 2063 6f6d 6d6f 6e20 616e 6365 7374  nt common ancest
-000087b0: 6f72 206f 6620 7468 6520 7370 6563 6966  or of the specif
-000087c0: 6965 640a 2020 2020 2020 2020 6e6f 6465  ied.        node
-000087d0: 732e 2054 6869 7320 6973 2065 7175 6976  s. This is equiv
-000087e0: 616c 656e 7420 746f 3a3a 0a0a 2020 2020  alent to::..    
-000087f0: 2020 2020 2020 2020 3e3e 3e20 7472 6565          >>> tree
-00008800: 2e74 696d 6528 7472 6565 2e6d 7263 6128  .time(tree.mrca(
-00008810: 752c 2076 2929 0a0a 2020 2020 2020 2020  u, v))..        
-00008820: 2e2e 206e 6f74 653a 3a0a 2020 2020 2020  .. note::.      
-00008830: 2020 2020 2020 4966 2079 6f75 2061 7265        If you are
-00008840: 2075 7369 6e67 2074 6869 7320 6d65 7468   using this meth
-00008850: 6f64 2074 6f20 6361 6c63 756c 6174 6520  od to calculate 
-00008860: 6176 6572 6167 6520 746d 7263 6120 7661  average tmrca va
-00008870: 6c75 6573 2061 6c6f 6e67 2074 6865 0a20  lues along the. 
-00008880: 2020 2020 2020 2020 2020 2067 656e 6f6d             genom
-00008890: 6520 6265 7477 6565 6e20 7061 6972 7320  e between pairs 
-000088a0: 6f66 2073 616d 706c 6520 6e6f 6465 732c  of sample nodes,
-000088b0: 2066 6f72 2065 6666 6963 6965 6e63 7920   for efficiency 
-000088c0: 7265 6173 6f6e 7320 796f 7520 7368 6f75  reasons you shou
-000088d0: 6c64 0a20 2020 2020 2020 2020 2020 2069  ld.            i
-000088e0: 6e73 7465 6164 2063 6f6e 7369 6465 7220  nstead consider 
-000088f0: 7468 6520 6060 6d6f 6465 3d22 6272 616e  the ``mode="bran
-00008900: 6368 2260 6020 6f70 7469 6f6e 206f 6620  ch"`` option of 
-00008910: 7468 650a 2020 2020 2020 2020 2020 2020  the.            
-00008920: 3a6d 6574 683a 6054 7265 6553 6571 7565  :meth:`TreeSeque
-00008930: 6e63 652e 6469 7665 7267 656e 6365 6020  nce.divergence` 
-00008940: 6f72 203a 6d65 7468 3a60 5472 6565 5365  or :meth:`TreeSe
-00008950: 7175 656e 6365 2e64 6976 6572 7369 7479  quence.diversity
-00008960: 6020 6d65 7468 6f64 732e 0a20 2020 2020  ` methods..     
-00008970: 2020 2020 2020 2053 696e 6365 2074 6865         Since the
-00008980: 7365 2063 616c 6375 6c61 7465 2074 6865  se calculate the
-00008990: 2061 7665 7261 6765 2062 7261 6e63 6820   average branch 
-000089a0: 6c65 6e67 7468 2062 6574 7765 656e 2070  length between p
-000089b0: 6169 7273 206f 6620 7361 6d70 6c65 0a20  airs of sample. 
-000089c0: 2020 2020 2020 2020 2020 206e 6f64 6573             nodes
-000089d0: 2c20 666f 7220 7361 6d70 6c65 7320 6174  , for samples at
-000089e0: 2074 696d 6520 3020 7468 6520 7265 7375   time 0 the resu
-000089f0: 6c74 696e 6720 7374 6174 6973 7469 6373  lting statistics
-00008a00: 2077 696c 6c20 6265 2065 7861 6374 6c79   will be exactly
-00008a10: 0a20 2020 2020 2020 2020 2020 2074 7769  .            twi
-00008a20: 6365 2074 6865 2074 6d72 6361 2076 616c  ce the tmrca val
-00008a30: 7565 2e0a 0a20 2020 2020 2020 203a 7061  ue...        :pa
-00008a40: 7261 6d20 696e 7420 753a 2054 6865 2066  ram int u: The f
-00008a50: 6972 7374 206e 6f64 652e 0a20 2020 2020  irst node..     
-00008a60: 2020 203a 7061 7261 6d20 696e 7420 763a     :param int v:
-00008a70: 2054 6865 2073 6563 6f6e 6420 6e6f 6465   The second node
-00008a80: 2e0a 2020 2020 2020 2020 3a72 6574 7572  ..        :retur
-00008a90: 6e3a 2054 6865 2074 696d 6520 6f66 2074  n: The time of t
-00008aa0: 6865 206d 6f73 7420 7265 6365 6e74 2063  he most recent c
-00008ab0: 6f6d 6d6f 6e20 616e 6365 7374 6f72 206f  ommon ancestor o
-00008ac0: 6620 7520 616e 6420 762e 0a20 2020 2020  f u and v..     
-00008ad0: 2020 203a 7274 7970 653a 2066 6c6f 6174     :rtype: float
-00008ae0: 0a20 2020 2020 2020 2022 2222 0a20 2020  .        """.   
-00008af0: 2020 2020 2072 6574 7572 6e20 7365 6c66       return self
-00008b00: 2e67 6574 5f74 696d 6528 7365 6c66 2e67  .get_time(self.g
-00008b10: 6574 5f6d 7263 6128 752c 2076 2929 0a0a  et_mrca(u, v))..
-00008b20: 2020 2020 6465 6620 6765 745f 7061 7265      def get_pare
-00008b30: 6e74 2873 656c 662c 2075 293a 0a20 2020  nt(self, u):.   
-00008b40: 2020 2020 2023 2044 6570 7265 6361 7465       # Deprecate
-00008b50: 6420 616c 6961 7320 666f 7220 7061 7265  d alias for pare
-00008b60: 6e74 0a20 2020 2020 2020 2072 6574 7572  nt.        retur
-00008b70: 6e20 7365 6c66 2e70 6172 656e 7428 7529  n self.parent(u)
-00008b80: 0a0a 2020 2020 6465 6620 7061 7265 6e74  ..    def parent
-00008b90: 2873 656c 662c 2075 293a 0a20 2020 2020  (self, u):.     
-00008ba0: 2020 2022 2222 0a20 2020 2020 2020 2052     """.        R
-00008bb0: 6574 7572 6e73 2074 6865 2070 6172 656e  eturns the paren
-00008bc0: 7420 6f66 2074 6865 2073 7065 6369 6669  t of the specifi
-00008bd0: 6564 206e 6f64 652e 2052 6574 7572 6e73  ed node. Returns
-00008be0: 0a20 2020 2020 2020 203a 6461 7461 3a60  .        :data:`
-00008bf0: 7473 6b69 742e 4e55 4c4c 6020 6966 2075  tskit.NULL` if u
-00008c00: 2069 7320 6120 726f 6f74 206f 7220 6973   is a root or is
-00008c10: 206e 6f74 2061 206e 6f64 6520 696e 0a20   not a node in. 
-00008c20: 2020 2020 2020 2074 6865 2063 7572 7265         the curre
-00008c30: 6e74 2074 7265 652e 0a0a 2020 2020 2020  nt tree...      
-00008c40: 2020 3a70 6172 616d 2069 6e74 2075 3a20    :param int u: 
-00008c50: 5468 6520 6e6f 6465 206f 6620 696e 7465  The node of inte
-00008c60: 7265 7374 2e0a 2020 2020 2020 2020 3a72  rest..        :r
-00008c70: 6574 7572 6e3a 2054 6865 2070 6172 656e  eturn: The paren
-00008c80: 7420 6f66 2075 2e0a 2020 2020 2020 2020  t of u..        
-00008c90: 3a72 7479 7065 3a20 696e 740a 2020 2020  :rtype: int.    
-00008ca0: 2020 2020 2222 220a 2020 2020 2020 2020      """.        
-00008cb0: 7265 7475 726e 2073 656c 662e 5f6c 6c5f  return self._ll_
-00008cc0: 7472 6565 2e67 6574 5f70 6172 656e 7428  tree.get_parent(
-00008cd0: 7529 0a0a 2020 2020 4070 726f 7065 7274  u)..    @propert
-00008ce0: 790a 2020 2020 6465 6620 7061 7265 6e74  y.    def parent
-00008cf0: 5f61 7272 6179 2873 656c 6629 3a0a 2020  _array(self):.  
-00008d00: 2020 2020 2020 2222 220a 2020 2020 2020        """.      
-00008d10: 2020 4120 6e75 6d70 7920 6172 7261 7920    A numpy array 
-00008d20: 2864 7479 7065 3d6e 702e 696e 7433 3229  (dtype=np.int32)
-00008d30: 2065 6e63 6f64 696e 6720 7468 6520 7061   encoding the pa
-00008d40: 7265 6e74 206f 6620 6561 6368 206e 6f64  rent of each nod
-00008d50: 650a 2020 2020 2020 2020 696e 2074 6869  e.        in thi
-00008d60: 7320 7472 6565 2c20 7375 6368 2074 6861  s tree, such tha
-00008d70: 7420 6060 7472 6565 2e70 6172 656e 745f  t ``tree.parent_
-00008d80: 6172 7261 795b 755d 203d 3d20 7472 6565  array[u] == tree
-00008d90: 2e70 6172 656e 7428 7529 6060 0a20 2020  .parent(u)``.   
-00008da0: 2020 2020 2066 6f72 2061 6c6c 2060 6030       for all ``0
-00008db0: 203c 3d20 7520 3c3d 2074 732e 6e75 6d5f   <= u <= ts.num_
-00008dc0: 6e6f 6465 7360 602e 2053 6565 2074 6865  nodes``. See the
-00008dd0: 203a 6d65 7468 3a60 7e2e 7061 7265 6e74   :meth:`~.parent
-00008de0: 600a 2020 2020 2020 2020 6d65 7468 6f64  `.        method
-00008df0: 2066 6f72 2064 6574 6169 6c73 206f 6e20   for details on 
-00008e00: 7468 6520 7365 6d61 6e74 6963 7320 6f66  the semantics of
-00008e10: 2074 7265 6520 7061 7265 6e74 7320 616e   tree parents an
-00008e20: 6420 7468 650a 2020 2020 2020 2020 3a72  d the.        :r
-00008e30: 6566 3a60 7365 635f 6461 7461 5f6d 6f64  ef:`sec_data_mod
-00008e40: 656c 5f74 7265 655f 7374 7275 6374 7572  el_tree_structur
-00008e50: 6560 2073 6563 7469 6f6e 2066 6f72 2069  e` section for i
-00008e60: 6e66 6f72 6d61 7469 6f6e 206f 6e20 7468  nformation on th
-00008e70: 650a 2020 2020 2020 2020 7175 696e 7475  e.        quintu
-00008e80: 706c 7920 6c69 6e6b 6564 2074 7265 6520  ply linked tree 
-00008e90: 656e 636f 6469 6e67 2e0a 0a20 2020 2020  encoding...     
-00008ea0: 2020 202e 2e20 696e 636c 7564 653a 3a20     .. include:: 
-00008eb0: 7375 6273 7469 7475 7469 6f6e 732f 7669  substitutions/vi
-00008ec0: 7274 7561 6c5f 726f 6f74 5f61 7272 6179  rtual_root_array
-00008ed0: 5f6e 6f74 652e 7273 740a 0a20 2020 2020  _note.rst..     
-00008ee0: 2020 202e 2e20 696e 636c 7564 653a 3a20     .. include:: 
-00008ef0: 7375 6273 7469 7475 7469 6f6e 732f 7472  substitutions/tr
-00008f00: 6565 5f61 7272 6179 5f77 6172 6e69 6e67  ee_array_warning
-00008f10: 2e72 7374 0a20 2020 2020 2020 2022 2222  .rst.        """
-00008f20: 0a20 2020 2020 2020 2072 6574 7572 6e20  .        return 
-00008f30: 7365 6c66 2e5f 7061 7265 6e74 5f61 7272  self._parent_arr
-00008f40: 6179 0a0a 2020 2020 2320 5175 696e 7475  ay..    # Quintu
-00008f50: 706c 7920 6c69 6e6b 6564 2074 7265 6520  ply linked tree 
-00008f60: 7374 7275 6374 7572 652e 0a0a 2020 2020  structure...    
-00008f70: 6465 6620 6c65 6674 5f63 6869 6c64 2873  def left_child(s
-00008f80: 656c 662c 2075 293a 0a20 2020 2020 2020  elf, u):.       
-00008f90: 2022 2222 0a20 2020 2020 2020 2052 6574   """.        Ret
-00008fa0: 7572 6e73 2074 6865 206c 6566 746d 6f73  urns the leftmos
-00008fb0: 7420 6368 696c 6420 6f66 2074 6865 2073  t child of the s
-00008fc0: 7065 6369 6669 6564 206e 6f64 652e 2052  pecified node. R
-00008fd0: 6574 7572 6e73 0a20 2020 2020 2020 203a  eturns.        :
-00008fe0: 6461 7461 3a60 7473 6b69 742e 4e55 4c4c  data:`tskit.NULL
-00008ff0: 6020 6966 2075 2069 7320 6120 6c65 6166  ` if u is a leaf
-00009000: 206f 7220 6973 206e 6f74 2061 206e 6f64   or is not a nod
-00009010: 6520 696e 0a20 2020 2020 2020 2074 6865  e in.        the
-00009020: 2063 7572 7265 6e74 2074 7265 652e 2054   current tree. T
-00009030: 6865 206c 6566 742d 746f 2d72 6967 6874  he left-to-right
-00009040: 206f 7264 6572 696e 6720 6f66 2063 6869   ordering of chi
-00009050: 6c64 7265 6e0a 2020 2020 2020 2020 6973  ldren.        is
-00009060: 2061 7262 6974 7261 7279 2061 6e64 2073   arbitrary and s
-00009070: 686f 756c 6420 6e6f 7420 6265 2064 6570  hould not be dep
-00009080: 656e 6465 6420 6f6e 3b20 7365 6520 7468  ended on; see th
-00009090: 650a 2020 2020 2020 2020 3a72 6566 3a60  e.        :ref:`
-000090a0: 6461 7461 206d 6f64 656c 203c 7365 635f  data model <sec_
-000090b0: 6461 7461 5f6d 6f64 656c 5f74 7265 655f  data_model_tree_
-000090c0: 7374 7275 6374 7572 653e 6020 7365 6374  structure>` sect
-000090d0: 696f 6e0a 2020 2020 2020 2020 666f 7220  ion.        for 
-000090e0: 6465 7461 696c 732e 0a0a 2020 2020 2020  details...      
-000090f0: 2020 5468 6973 2069 7320 6120 6c6f 772d    This is a low-
-00009100: 6c65 7665 6c20 6d65 7468 6f64 2067 6976  level method giv
-00009110: 696e 6720 6163 6365 7373 2074 6f20 7468  ing access to th
-00009120: 6520 7175 696e 7475 706c 7920 6c69 6e6b  e quintuply link
-00009130: 6564 0a20 2020 2020 2020 2074 7265 6520  ed.        tree 
-00009140: 7374 7275 6374 7572 6520 696e 206d 656d  structure in mem
-00009150: 6f72 793b 2074 6865 203a 6d65 7468 3a60  ory; the :meth:`
-00009160: 2e63 6869 6c64 7265 6e60 206d 6574 686f  .children` metho
-00009170: 6420 6973 2061 206d 6f72 650a 2020 2020  d is a more.    
-00009180: 2020 2020 636f 6e76 656e 6965 6e74 2077      convenient w
-00009190: 6179 2074 6f20 6f62 7461 696e 2074 6865  ay to obtain the
-000091a0: 2063 6869 6c64 7265 6e20 6f66 2061 2067   children of a g
-000091b0: 6976 656e 206e 6f64 652e 0a0a 2020 2020  iven node...    
-000091c0: 2020 2020 3a70 6172 616d 2069 6e74 2075      :param int u
-000091d0: 3a20 5468 6520 6e6f 6465 206f 6620 696e  : The node of in
-000091e0: 7465 7265 7374 2e0a 2020 2020 2020 2020  terest..        
-000091f0: 3a72 6574 7572 6e3a 2054 6865 206c 6566  :return: The lef
-00009200: 746d 6f73 7420 6368 696c 6420 6f66 2075  tmost child of u
-00009210: 2e0a 2020 2020 2020 2020 3a72 7479 7065  ..        :rtype
-00009220: 3a20 696e 740a 2020 2020 2020 2020 2222  : int.        ""
-00009230: 220a 2020 2020 2020 2020 7265 7475 726e  ".        return
-00009240: 2073 656c 662e 5f6c 6c5f 7472 6565 2e67   self._ll_tree.g
-00009250: 6574 5f6c 6566 745f 6368 696c 6428 7529  et_left_child(u)
-00009260: 0a0a 2020 2020 4070 726f 7065 7274 790a  ..    @property.
-00009270: 2020 2020 6465 6620 6c65 6674 5f63 6869      def left_chi
-00009280: 6c64 5f61 7272 6179 2873 656c 6629 3a0a  ld_array(self):.
-00009290: 2020 2020 2020 2020 2222 220a 2020 2020          """.    
-000092a0: 2020 2020 4120 6e75 6d70 7920 6172 7261      A numpy arra
-000092b0: 7920 2864 7479 7065 3d6e 702e 696e 7433  y (dtype=np.int3
-000092c0: 3229 2065 6e63 6f64 696e 6720 7468 6520  2) encoding the 
-000092d0: 6c65 6674 2063 6869 6c64 206f 6620 6561  left child of ea
-000092e0: 6368 206e 6f64 650a 2020 2020 2020 2020  ch node.        
-000092f0: 696e 2074 6869 7320 7472 6565 2c20 7375  in this tree, su
-00009300: 6368 2074 6861 7420 6060 7472 6565 2e6c  ch that ``tree.l
-00009310: 6566 745f 6368 696c 645f 6172 7261 795b  eft_child_array[
-00009320: 755d 203d 3d20 7472 6565 2e6c 6566 745f  u] == tree.left_
-00009330: 6368 696c 6428 7529 6060 0a20 2020 2020  child(u)``.     
-00009340: 2020 2066 6f72 2061 6c6c 2060 6030 203c     for all ``0 <
-00009350: 3d20 7520 3c3d 2074 732e 6e75 6d5f 6e6f  = u <= ts.num_no
-00009360: 6465 7360 602e 2053 6565 2074 6865 203a  des``. See the :
-00009370: 6d65 7468 3a60 7e2e 6c65 6674 5f63 6869  meth:`~.left_chi
-00009380: 6c64 600a 2020 2020 2020 2020 6d65 7468  ld`.        meth
-00009390: 6f64 2066 6f72 2064 6574 6169 6c73 206f  od for details o
-000093a0: 6e20 7468 6520 7365 6d61 6e74 6963 7320  n the semantics 
-000093b0: 6f66 2074 7265 6520 6c65 6674 5f63 6869  of tree left_chi
-000093c0: 6c64 2061 6e64 2074 6865 0a20 2020 2020  ld and the.     
-000093d0: 2020 203a 7265 663a 6073 6563 5f64 6174     :ref:`sec_dat
-000093e0: 615f 6d6f 6465 6c5f 7472 6565 5f73 7472  a_model_tree_str
-000093f0: 7563 7475 7265 6020 7365 6374 696f 6e20  ucture` section 
-00009400: 666f 7220 696e 666f 726d 6174 696f 6e20  for information 
-00009410: 6f6e 2074 6865 0a20 2020 2020 2020 2071  on the.        q
-00009420: 7569 6e74 7570 6c79 206c 696e 6b65 6420  uintuply linked 
-00009430: 7472 6565 2065 6e63 6f64 696e 672e 0a0a  tree encoding...
-00009440: 2020 2020 2020 2020 2e2e 2069 6e63 6c75          .. inclu
-00009450: 6465 3a3a 2073 7562 7374 6974 7574 696f  de:: substitutio
-00009460: 6e73 2f76 6972 7475 616c 5f72 6f6f 745f  ns/virtual_root_
-00009470: 6172 7261 795f 6e6f 7465 2e72 7374 0a0a  array_note.rst..
-00009480: 2020 2020 2020 2020 2e2e 2069 6e63 6c75          .. inclu
-00009490: 6465 3a3a 2073 7562 7374 6974 7574 696f  de:: substitutio
-000094a0: 6e73 2f74 7265 655f 6172 7261 795f 7761  ns/tree_array_wa
-000094b0: 726e 696e 672e 7273 740a 2020 2020 2020  rning.rst.      
-000094c0: 2020 2222 220a 2020 2020 2020 2020 7265    """.        re
-000094d0: 7475 726e 2073 656c 662e 5f6c 6566 745f  turn self._left_
-000094e0: 6368 696c 645f 6172 7261 790a 0a20 2020  child_array..   
-000094f0: 2064 6566 2072 6967 6874 5f63 6869 6c64   def right_child
-00009500: 2873 656c 662c 2075 293a 0a20 2020 2020  (self, u):.     
-00009510: 2020 2022 2222 0a20 2020 2020 2020 2052     """.        R
-00009520: 6574 7572 6e73 2074 6865 2072 6967 6874  eturns the right
-00009530: 6d6f 7374 2063 6869 6c64 206f 6620 7468  most child of th
-00009540: 6520 7370 6563 6966 6965 6420 6e6f 6465  e specified node
-00009550: 2e20 5265 7475 726e 730a 2020 2020 2020  . Returns.      
-00009560: 2020 3a64 6174 613a 6074 736b 6974 2e4e    :data:`tskit.N
-00009570: 554c 4c60 2069 6620 7520 6973 2061 206c  ULL` if u is a l
-00009580: 6561 6620 6f72 2069 7320 6e6f 7420 6120  eaf or is not a 
-00009590: 6e6f 6465 2069 6e0a 2020 2020 2020 2020  node in.        
-000095a0: 7468 6520 6375 7272 656e 7420 7472 6565  the current tree
-000095b0: 2e20 5468 6520 6c65 6674 2d74 6f2d 7269  . The left-to-ri
-000095c0: 6768 7420 6f72 6465 7269 6e67 206f 6620  ght ordering of 
-000095d0: 6368 696c 6472 656e 0a20 2020 2020 2020  children.       
-000095e0: 2069 7320 6172 6269 7472 6172 7920 616e   is arbitrary an
-000095f0: 6420 7368 6f75 6c64 206e 6f74 2062 6520  d should not be 
-00009600: 6465 7065 6e64 6564 206f 6e3b 2073 6565  depended on; see
-00009610: 2074 6865 0a20 2020 2020 2020 203a 7265   the.        :re
-00009620: 663a 6064 6174 6120 6d6f 6465 6c20 3c73  f:`data model <s
-00009630: 6563 5f64 6174 615f 6d6f 6465 6c5f 7472  ec_data_model_tr
-00009640: 6565 5f73 7472 7563 7475 7265 3e60 2073  ee_structure>` s
-00009650: 6563 7469 6f6e 0a20 2020 2020 2020 2066  ection.        f
-00009660: 6f72 2064 6574 6169 6c73 2e0a 0a20 2020  or details...   
-00009670: 2020 2020 2054 6869 7320 6973 2061 206c       This is a l
-00009680: 6f77 2d6c 6576 656c 206d 6574 686f 6420  ow-level method 
-00009690: 6769 7669 6e67 2061 6363 6573 7320 746f  giving access to
-000096a0: 2074 6865 2071 7569 6e74 7570 6c79 206c   the quintuply l
-000096b0: 696e 6b65 640a 2020 2020 2020 2020 7472  inked.        tr
-000096c0: 6565 2073 7472 7563 7475 7265 2069 6e20  ee structure in 
-000096d0: 6d65 6d6f 7279 3b20 7468 6520 3a6d 6574  memory; the :met
-000096e0: 683a 602e 6368 696c 6472 656e 6020 6d65  h:`.children` me
-000096f0: 7468 6f64 2069 7320 6120 6d6f 7265 0a20  thod is a more. 
-00009700: 2020 2020 2020 2063 6f6e 7665 6e69 656e         convenien
-00009710: 7420 7761 7920 746f 206f 6274 6169 6e20  t way to obtain 
-00009720: 7468 6520 6368 696c 6472 656e 206f 6620  the children of 
-00009730: 6120 6769 7665 6e20 6e6f 6465 2e0a 0a20  a given node... 
-00009740: 2020 2020 2020 203a 7061 7261 6d20 696e         :param in
-00009750: 7420 753a 2054 6865 206e 6f64 6520 6f66  t u: The node of
-00009760: 2069 6e74 6572 6573 742e 0a20 2020 2020   interest..     
-00009770: 2020 203a 7265 7475 726e 3a20 5468 6520     :return: The 
-00009780: 7269 6768 746d 6f73 7420 6368 696c 6420  rightmost child 
-00009790: 6f66 2075 2e0a 2020 2020 2020 2020 3a72  of u..        :r
-000097a0: 7479 7065 3a20 696e 740a 2020 2020 2020  type: int.      
-000097b0: 2020 2222 220a 2020 2020 2020 2020 7265    """.        re
-000097c0: 7475 726e 2073 656c 662e 5f6c 6c5f 7472  turn self._ll_tr
-000097d0: 6565 2e67 6574 5f72 6967 6874 5f63 6869  ee.get_right_chi
-000097e0: 6c64 2875 290a 0a20 2020 2040 7072 6f70  ld(u)..    @prop
-000097f0: 6572 7479 0a20 2020 2064 6566 2072 6967  erty.    def rig
-00009800: 6874 5f63 6869 6c64 5f61 7272 6179 2873  ht_child_array(s
-00009810: 656c 6629 3a0a 2020 2020 2020 2020 2222  elf):.        ""
-00009820: 220a 2020 2020 2020 2020 4120 6e75 6d70  ".        A nump
-00009830: 7920 6172 7261 7920 2864 7479 7065 3d6e  y array (dtype=n
-00009840: 702e 696e 7433 3229 2065 6e63 6f64 696e  p.int32) encodin
-00009850: 6720 7468 6520 7269 6768 7420 6368 696c  g the right chil
-00009860: 6420 6f66 2065 6163 6820 6e6f 6465 0a20  d of each node. 
-00009870: 2020 2020 2020 2069 6e20 7468 6973 2074         in this t
-00009880: 7265 652c 2073 7563 6820 7468 6174 2060  ree, such that `
-00009890: 6074 7265 652e 7269 6768 745f 6368 696c  `tree.right_chil
-000098a0: 645f 6172 7261 795b 755d 203d 3d20 7472  d_array[u] == tr
-000098b0: 6565 2e72 6967 6874 5f63 6869 6c64 2875  ee.right_child(u
-000098c0: 2960 600a 2020 2020 2020 2020 666f 7220  )``.        for 
-000098d0: 616c 6c20 6060 3020 3c3d 2075 203c 3d20  all ``0 <= u <= 
-000098e0: 7473 2e6e 756d 5f6e 6f64 6573 6060 2e20  ts.num_nodes``. 
-000098f0: 5365 6520 7468 6520 3a6d 6574 683a 607e  See the :meth:`~
-00009900: 2e72 6967 6874 5f63 6869 6c64 600a 2020  .right_child`.  
-00009910: 2020 2020 2020 6d65 7468 6f64 2066 6f72        method for
-00009920: 2064 6574 6169 6c73 206f 6e20 7468 6520   details on the 
-00009930: 7365 6d61 6e74 6963 7320 6f66 2074 7265  semantics of tre
-00009940: 6520 7269 6768 745f 6368 696c 6420 616e  e right_child an
-00009950: 6420 7468 650a 2020 2020 2020 2020 3a72  d the.        :r
-00009960: 6566 3a60 7365 635f 6461 7461 5f6d 6f64  ef:`sec_data_mod
-00009970: 656c 5f74 7265 655f 7374 7275 6374 7572  el_tree_structur
-00009980: 6560 2073 6563 7469 6f6e 2066 6f72 2069  e` section for i
-00009990: 6e66 6f72 6d61 7469 6f6e 206f 6e20 7468  nformation on th
-000099a0: 650a 2020 2020 2020 2020 7175 696e 7475  e.        quintu
-000099b0: 706c 7920 6c69 6e6b 6564 2074 7265 6520  ply linked tree 
-000099c0: 656e 636f 6469 6e67 2e0a 0a20 2020 2020  encoding...     
-000099d0: 2020 202e 2e20 696e 636c 7564 653a 3a20     .. include:: 
-000099e0: 7375 6273 7469 7475 7469 6f6e 732f 7669  substitutions/vi
-000099f0: 7274 7561 6c5f 726f 6f74 5f61 7272 6179  rtual_root_array
-00009a00: 5f6e 6f74 652e 7273 740a 0a20 2020 2020  _note.rst..     
-00009a10: 2020 202e 2e20 696e 636c 7564 653a 3a20     .. include:: 
-00009a20: 7375 6273 7469 7475 7469 6f6e 732f 7472  substitutions/tr
-00009a30: 6565 5f61 7272 6179 5f77 6172 6e69 6e67  ee_array_warning
-00009a40: 2e72 7374 0a20 2020 2020 2020 2022 2222  .rst.        """
-00009a50: 0a20 2020 2020 2020 2072 6574 7572 6e20  .        return 
-00009a60: 7365 6c66 2e5f 7269 6768 745f 6368 696c  self._right_chil
-00009a70: 645f 6172 7261 790a 0a20 2020 2064 6566  d_array..    def
-00009a80: 206c 6566 745f 7369 6228 7365 6c66 2c20   left_sib(self, 
-00009a90: 7529 3a0a 2020 2020 2020 2020 2222 220a  u):.        """.
-00009aa0: 2020 2020 2020 2020 5265 7475 726e 7320          Returns 
-00009ab0: 7468 6520 7369 626c 696e 6720 6e6f 6465  the sibling node
-00009ac0: 2074 6f20 7468 6520 6c65 6674 206f 6620   to the left of 
-00009ad0: 752c 206f 7220 3a64 6174 613a 6074 736b  u, or :data:`tsk
-00009ae0: 6974 2e4e 554c 4c60 0a20 2020 2020 2020  it.NULL`.       
-00009af0: 2069 6620 7520 646f 6573 206e 6f74 2068   if u does not h
-00009b00: 6176 6520 6120 6c65 6674 2073 6962 6c69  ave a left sibli
-00009b10: 6e67 2e0a 2020 2020 2020 2020 5468 6520  ng..        The 
-00009b20: 6c65 6674 2d74 6f2d 7269 6768 7420 6f72  left-to-right or
-00009b30: 6465 7269 6e67 206f 6620 6368 696c 6472  dering of childr
-00009b40: 656e 0a20 2020 2020 2020 2069 7320 6172  en.        is ar
-00009b50: 6269 7472 6172 7920 616e 6420 7368 6f75  bitrary and shou
-00009b60: 6c64 206e 6f74 2062 6520 6465 7065 6e64  ld not be depend
-00009b70: 6564 206f 6e3b 2073 6565 2074 6865 0a20  ed on; see the. 
-00009b80: 2020 2020 2020 203a 7265 663a 6064 6174         :ref:`dat
-00009b90: 6120 6d6f 6465 6c20 3c73 6563 5f64 6174  a model <sec_dat
-00009ba0: 615f 6d6f 6465 6c5f 7472 6565 5f73 7472  a_model_tree_str
-00009bb0: 7563 7475 7265 3e60 2073 6563 7469 6f6e  ucture>` section
-00009bc0: 0a20 2020 2020 2020 2066 6f72 2064 6574  .        for det
-00009bd0: 6169 6c73 2e0a 0a20 2020 2020 2020 203a  ails...        :
-00009be0: 7061 7261 6d20 696e 7420 753a 2054 6865  param int u: The
-00009bf0: 206e 6f64 6520 6f66 2069 6e74 6572 6573   node of interes
-00009c00: 742e 0a20 2020 2020 2020 203a 7265 7475  t..        :retu
-00009c10: 726e 3a20 5468 6520 7369 626c 696e 6720  rn: The sibling 
-00009c20: 6e6f 6465 2074 6f20 7468 6520 6c65 6674  node to the left
-00009c30: 206f 6620 752e 0a20 2020 2020 2020 203a   of u..        :
-00009c40: 7274 7970 653a 2069 6e74 0a20 2020 2020  rtype: int.     
-00009c50: 2020 2022 2222 0a20 2020 2020 2020 2072     """.        r
-00009c60: 6574 7572 6e20 7365 6c66 2e5f 6c6c 5f74  eturn self._ll_t
-00009c70: 7265 652e 6765 745f 6c65 6674 5f73 6962  ree.get_left_sib
-00009c80: 2875 290a 0a20 2020 2040 7072 6f70 6572  (u)..    @proper
-00009c90: 7479 0a20 2020 2064 6566 206c 6566 745f  ty.    def left_
-00009ca0: 7369 625f 6172 7261 7928 7365 6c66 293a  sib_array(self):
-00009cb0: 0a20 2020 2020 2020 2022 2222 0a20 2020  .        """.   
-00009cc0: 2020 2020 2041 206e 756d 7079 2061 7272       A numpy arr
-00009cd0: 6179 2028 6474 7970 653d 6e70 2e69 6e74  ay (dtype=np.int
-00009ce0: 3332 2920 656e 636f 6469 6e67 2074 6865  32) encoding the
-00009cf0: 206c 6566 7420 7369 6220 6f66 2065 6163   left sib of eac
-00009d00: 6820 6e6f 6465 0a20 2020 2020 2020 2069  h node.        i
-00009d10: 6e20 7468 6973 2074 7265 652c 2073 7563  n this tree, suc
-00009d20: 6820 7468 6174 2060 6074 7265 652e 6c65  h that ``tree.le
-00009d30: 6674 5f73 6962 5f61 7272 6179 5b75 5d20  ft_sib_array[u] 
-00009d40: 3d3d 2074 7265 652e 6c65 6674 5f73 6962  == tree.left_sib
-00009d50: 2875 2960 600a 2020 2020 2020 2020 666f  (u)``.        fo
-00009d60: 7220 616c 6c20 6060 3020 3c3d 2075 203c  r all ``0 <= u <
-00009d70: 3d20 7473 2e6e 756d 5f6e 6f64 6573 6060  = ts.num_nodes``
-00009d80: 2e20 5365 6520 7468 6520 3a6d 6574 683a  . See the :meth:
-00009d90: 607e 2e6c 6566 745f 7369 6260 0a20 2020  `~.left_sib`.   
-00009da0: 2020 2020 206d 6574 686f 6420 666f 7220       method for 
-00009db0: 6465 7461 696c 7320 6f6e 2074 6865 2073  details on the s
-00009dc0: 656d 616e 7469 6373 206f 6620 7472 6565  emantics of tree
-00009dd0: 206c 6566 745f 7369 6220 616e 6420 7468   left_sib and th
-00009de0: 650a 2020 2020 2020 2020 3a72 6566 3a60  e.        :ref:`
-00009df0: 7365 635f 6461 7461 5f6d 6f64 656c 5f74  sec_data_model_t
-00009e00: 7265 655f 7374 7275 6374 7572 6560 2073  ree_structure` s
-00009e10: 6563 7469 6f6e 2066 6f72 2069 6e66 6f72  ection for infor
-00009e20: 6d61 7469 6f6e 206f 6e20 7468 650a 2020  mation on the.  
-00009e30: 2020 2020 2020 7175 696e 7475 706c 7920        quintuply 
-00009e40: 6c69 6e6b 6564 2074 7265 6520 656e 636f  linked tree enco
-00009e50: 6469 6e67 2e0a 0a20 2020 2020 2020 202e  ding...        .
-00009e60: 2e20 696e 636c 7564 653a 3a20 7375 6273  . include:: subs
-00009e70: 7469 7475 7469 6f6e 732f 7669 7274 7561  titutions/virtua
-00009e80: 6c5f 726f 6f74 5f61 7272 6179 5f6e 6f74  l_root_array_not
-00009e90: 652e 7273 740a 0a20 2020 2020 2020 202e  e.rst..        .
-00009ea0: 2e20 696e 636c 7564 653a 3a20 7375 6273  . include:: subs
-00009eb0: 7469 7475 7469 6f6e 732f 7472 6565 5f61  titutions/tree_a
-00009ec0: 7272 6179 5f77 6172 6e69 6e67 2e72 7374  rray_warning.rst
-00009ed0: 0a20 2020 2020 2020 2022 2222 0a20 2020  .        """.   
-00009ee0: 2020 2020 2072 6574 7572 6e20 7365 6c66       return self
-00009ef0: 2e5f 6c65 6674 5f73 6962 5f61 7272 6179  ._left_sib_array
-00009f00: 0a0a 2020 2020 6465 6620 7269 6768 745f  ..    def right_
-00009f10: 7369 6228 7365 6c66 2c20 7529 3a0a 2020  sib(self, u):.  
-00009f20: 2020 2020 2020 2222 220a 2020 2020 2020        """.      
-00009f30: 2020 5265 7475 726e 7320 7468 6520 7369    Returns the si
-00009f40: 626c 696e 6720 6e6f 6465 2074 6f20 7468  bling node to th
-00009f50: 6520 7269 6768 7420 6f66 2075 2c20 6f72  e right of u, or
-00009f60: 203a 6461 7461 3a60 7473 6b69 742e 4e55   :data:`tskit.NU
-00009f70: 4c4c 600a 2020 2020 2020 2020 6966 2075  LL`.        if u
-00009f80: 2064 6f65 7320 6e6f 7420 6861 7665 2061   does not have a
-00009f90: 2072 6967 6874 2073 6962 6c69 6e67 2e0a   right sibling..
-00009fa0: 2020 2020 2020 2020 5468 6520 6c65 6674          The left
-00009fb0: 2d74 6f2d 7269 6768 7420 6f72 6465 7269  -to-right orderi
-00009fc0: 6e67 206f 6620 6368 696c 6472 656e 0a20  ng of children. 
-00009fd0: 2020 2020 2020 2069 7320 6172 6269 7472         is arbitr
-00009fe0: 6172 7920 616e 6420 7368 6f75 6c64 206e  ary and should n
-00009ff0: 6f74 2062 6520 6465 7065 6e64 6564 206f  ot be depended o
-0000a000: 6e3b 2073 6565 2074 6865 0a20 2020 2020  n; see the.     
-0000a010: 2020 203a 7265 663a 6064 6174 6120 6d6f     :ref:`data mo
-0000a020: 6465 6c20 3c73 6563 5f64 6174 615f 6d6f  del <sec_data_mo
-0000a030: 6465 6c5f 7472 6565 5f73 7472 7563 7475  del_tree_structu
-0000a040: 7265 3e60 2073 6563 7469 6f6e 0a20 2020  re>` section.   
-0000a050: 2020 2020 2066 6f72 2064 6574 6169 6c73       for details
-0000a060: 2e0a 0a20 2020 2020 2020 203a 7061 7261  ...        :para
-0000a070: 6d20 696e 7420 753a 2054 6865 206e 6f64  m int u: The nod
-0000a080: 6520 6f66 2069 6e74 6572 6573 742e 0a20  e of interest.. 
-0000a090: 2020 2020 2020 203a 7265 7475 726e 3a20         :return: 
-0000a0a0: 5468 6520 7369 626c 696e 6720 6e6f 6465  The sibling node
-0000a0b0: 2074 6f20 7468 6520 7269 6768 7420 6f66   to the right of
-0000a0c0: 2075 2e0a 2020 2020 2020 2020 3a72 7479   u..        :rty
-0000a0d0: 7065 3a20 696e 740a 2020 2020 2020 2020  pe: int.        
-0000a0e0: 2222 220a 2020 2020 2020 2020 7265 7475  """.        retu
-0000a0f0: 726e 2073 656c 662e 5f6c 6c5f 7472 6565  rn self._ll_tree
-0000a100: 2e67 6574 5f72 6967 6874 5f73 6962 2875  .get_right_sib(u
-0000a110: 290a 0a20 2020 2040 7072 6f70 6572 7479  )..    @property
-0000a120: 0a20 2020 2064 6566 2072 6967 6874 5f73  .    def right_s
-0000a130: 6962 5f61 7272 6179 2873 656c 6629 3a0a  ib_array(self):.
-0000a140: 2020 2020 2020 2020 2222 220a 2020 2020          """.    
-0000a150: 2020 2020 4120 6e75 6d70 7920 6172 7261      A numpy arra
-0000a160: 7920 2864 7479 7065 3d6e 702e 696e 7433  y (dtype=np.int3
-0000a170: 3229 2065 6e63 6f64 696e 6720 7468 6520  2) encoding the 
-0000a180: 7269 6768 7420 7369 6220 6f66 2065 6163  right sib of eac
-0000a190: 6820 6e6f 6465 0a20 2020 2020 2020 2069  h node.        i
-0000a1a0: 6e20 7468 6973 2074 7265 652c 2073 7563  n this tree, suc
-0000a1b0: 6820 7468 6174 2060 6074 7265 652e 7269  h that ``tree.ri
-0000a1c0: 6768 745f 7369 625f 6172 7261 795b 755d  ght_sib_array[u]
-0000a1d0: 203d 3d20 7472 6565 2e72 6967 6874 5f73   == tree.right_s
-0000a1e0: 6962 2875 2960 600a 2020 2020 2020 2020  ib(u)``.        
-0000a1f0: 666f 7220 616c 6c20 6060 3020 3c3d 2075  for all ``0 <= u
-0000a200: 203c 3d20 7473 2e6e 756d 5f6e 6f64 6573   <= ts.num_nodes
-0000a210: 6060 2e20 5365 6520 7468 6520 3a6d 6574  ``. See the :met
-0000a220: 683a 607e 2e72 6967 6874 5f73 6962 600a  h:`~.right_sib`.
-0000a230: 2020 2020 2020 2020 6d65 7468 6f64 2066          method f
-0000a240: 6f72 2064 6574 6169 6c73 206f 6e20 7468  or details on th
-0000a250: 6520 7365 6d61 6e74 6963 7320 6f66 2074  e semantics of t
-0000a260: 7265 6520 7269 6768 745f 7369 6220 616e  ree right_sib an
-0000a270: 6420 7468 650a 2020 2020 2020 2020 3a72  d the.        :r
-0000a280: 6566 3a60 7365 635f 6461 7461 5f6d 6f64  ef:`sec_data_mod
-0000a290: 656c 5f74 7265 655f 7374 7275 6374 7572  el_tree_structur
-0000a2a0: 6560 2073 6563 7469 6f6e 2066 6f72 2069  e` section for i
-0000a2b0: 6e66 6f72 6d61 7469 6f6e 206f 6e20 7468  nformation on th
-0000a2c0: 650a 2020 2020 2020 2020 7175 696e 7475  e.        quintu
-0000a2d0: 706c 7920 6c69 6e6b 6564 2074 7265 6520  ply linked tree 
-0000a2e0: 656e 636f 6469 6e67 2e0a 0a20 2020 2020  encoding...     
-0000a2f0: 2020 202e 2e20 696e 636c 7564 653a 3a20     .. include:: 
-0000a300: 7375 6273 7469 7475 7469 6f6e 732f 7669  substitutions/vi
-0000a310: 7274 7561 6c5f 726f 6f74 5f61 7272 6179  rtual_root_array
-0000a320: 5f6e 6f74 652e 7273 740a 0a20 2020 2020  _note.rst..     
-0000a330: 2020 202e 2e20 696e 636c 7564 653a 3a20     .. include:: 
-0000a340: 7375 6273 7469 7475 7469 6f6e 732f 7472  substitutions/tr
-0000a350: 6565 5f61 7272 6179 5f77 6172 6e69 6e67  ee_array_warning
-0000a360: 2e72 7374 0a20 2020 2020 2020 2022 2222  .rst.        """
-0000a370: 0a20 2020 2020 2020 2072 6574 7572 6e20  .        return 
-0000a380: 7365 6c66 2e5f 7269 6768 745f 7369 625f  self._right_sib_
-0000a390: 6172 7261 790a 0a20 2020 2064 6566 2073  array..    def s
-0000a3a0: 6962 6c69 6e67 7328 7365 6c66 2c20 7529  iblings(self, u)
-0000a3b0: 3a0a 2020 2020 2020 2020 2222 220a 2020  :.        """.  
-0000a3c0: 2020 2020 2020 5265 7475 726e 7320 7468        Returns th
-0000a3d0: 6520 7369 626c 696e 6728 7329 206f 6620  e sibling(s) of 
-0000a3e0: 7468 6520 7370 6563 6966 6965 6420 6e6f  the specified no
-0000a3f0: 6465 2060 6075 6060 2061 7320 6120 7475  de ``u`` as a tu
-0000a400: 706c 6520 6f66 2069 6e74 6567 6572 0a20  ple of integer. 
-0000a410: 2020 2020 2020 206e 6f64 6520 4944 732e         node IDs.
-0000a420: 2049 6620 6060 7560 6020 6861 7320 6e6f   If ``u`` has no
-0000a430: 2073 6962 6c69 6e67 7320 6f72 2069 7320   siblings or is 
-0000a440: 6e6f 7420 6120 6e6f 6465 2069 6e20 7468  not a node in th
-0000a450: 6520 6375 7272 656e 7420 7472 6565 2c0a  e current tree,.
-0000a460: 2020 2020 2020 2020 7265 7475 726e 7320          returns 
-0000a470: 616e 2065 6d70 7479 2074 7570 6c65 2e20  an empty tuple. 
-0000a480: 4966 2060 6075 6060 2069 7320 7468 6520  If ``u`` is the 
-0000a490: 726f 6f74 206f 6620 6120 7369 6e67 6c65  root of a single
-0000a4a0: 2d72 6f6f 7420 7472 6565 2c0a 2020 2020  -root tree,.    
-0000a4b0: 2020 2020 7265 7475 726e 7320 616e 2065      returns an e
-0000a4c0: 6d70 7479 2074 7570 6c65 3b20 6966 2060  mpty tuple; if `
-0000a4d0: 6075 6060 2069 7320 7468 6520 726f 6f74  `u`` is the root
-0000a4e0: 206f 6620 6120 6d75 6c74 692d 726f 6f74   of a multi-root
-0000a4f0: 2074 7265 652c 0a20 2020 2020 2020 2072   tree,.        r
-0000a500: 6574 7572 6e73 2074 6865 206f 7468 6572  eturns the other
-0000a510: 2072 6f6f 7473 2028 6e6f 7465 2061 6c6c   roots (note all
-0000a520: 2074 6865 2072 6f6f 7473 2061 7265 2072   the roots are r
-0000a530: 656c 6174 6564 2062 7920 7468 6520 7669  elated by the vi
-0000a540: 7274 7561 6c20 726f 6f74 292e 0a20 2020  rtual root)..   
-0000a550: 2020 2020 2049 6620 6060 7560 6020 6973       If ``u`` is
-0000a560: 2074 6865 2076 6972 7475 616c 2072 6f6f   the virtual roo
-0000a570: 7420 2877 6869 6368 2068 6173 206e 6f20  t (which has no 
-0000a580: 7369 626c 696e 6773 292c 2072 6574 7572  siblings), retur
+00006860: 2020 2020 2020 7365 6c66 2e5f 6c6c 5f74        self._ll_t
+00006870: 7265 652e 7365 656b 5f69 6e64 6578 2869  ree.seek_index(i
+00006880: 6e64 6578 290a 0a20 2020 2064 6566 2073  ndex)..    def s
+00006890: 6565 6b28 7365 6c66 2c20 706f 7369 7469  eek(self, positi
+000068a0: 6f6e 293a 0a20 2020 2020 2020 2022 2222  on):.        """
+000068b0: 0a20 2020 2020 2020 2053 6574 7320 7468  .        Sets th
+000068c0: 6520 7374 6174 6520 746f 2072 6570 7265  e state to repre
+000068d0: 7365 6e74 2074 6865 2074 7265 6520 7468  sent the tree th
+000068e0: 6174 2063 6f76 6572 7320 7468 6520 7370  at covers the sp
+000068f0: 6563 6966 6965 640a 2020 2020 2020 2020  ecified.        
+00006900: 706f 7369 7469 6f6e 2069 6e20 7468 6520  position in the 
+00006910: 7061 7265 6e74 2074 7265 6520 7365 7175  parent tree sequ
+00006920: 656e 6365 2e20 4166 7465 7220 6120 7375  ence. After a su
+00006930: 6363 6573 7366 756c 2072 6574 7572 6e0a  ccessful return.
+00006940: 2020 2020 2020 2020 6f66 2074 6869 7320          of this 
+00006950: 6d65 7468 6f64 2077 6520 6861 7665 2060  method we have `
+00006960: 6074 7265 652e 696e 7465 7276 616c 2e6c  `tree.interval.l
+00006970: 6566 7460 6020 3c3d 2060 6070 6f73 6974  eft`` <= ``posit
+00006980: 696f 6e60 600a 2020 2020 2020 2020 3c20  ion``.        < 
+00006990: 6060 7472 6565 2e69 6e74 6572 7661 6c2e  ``tree.interval.
+000069a0: 7269 6768 7460 602e 0a0a 2020 2020 2020  right``...      
+000069b0: 2020 2e2e 2069 6e63 6c75 6465 3a3a 2073    .. include:: s
+000069c0: 7562 7374 6974 7574 696f 6e73 2f6c 696e  ubstitutions/lin
+000069d0: 6561 725f 7472 6176 6572 7361 6c5f 7761  ear_traversal_wa
+000069e0: 726e 696e 672e 7273 740a 0a20 2020 2020  rning.rst..     
+000069f0: 2020 203a 7061 7261 6d20 666c 6f61 7420     :param float 
+00006a00: 706f 7369 7469 6f6e 3a20 5468 6520 706f  position: The po
+00006a10: 7369 7469 6f6e 2061 6c6f 6e67 2074 6865  sition along the
+00006a20: 2073 6571 7565 6e63 6520 6c65 6e67 7468   sequence length
+00006a30: 2074 6f0a 2020 2020 2020 2020 2020 2020   to.            
+00006a40: 7365 656b 2074 6f2e 0a20 2020 2020 2020  seek to..       
+00006a50: 203a 7261 6973 6573 2056 616c 7565 4572   :raises ValueEr
+00006a60: 726f 723a 2049 6620 3020 3c20 706f 7369  ror: If 0 < posi
+00006a70: 7469 6f6e 206f 7220 706f 7369 7469 6f6e  tion or position
+00006a80: 203e 3d0a 2020 2020 2020 2020 2020 2020   >=.            
+00006a90: 3a61 7474 723a 6054 7265 6553 6571 7565  :attr:`TreeSeque
+00006aa0: 6e63 652e 7365 7175 656e 6365 5f6c 656e  nce.sequence_len
+00006ab0: 6774 6860 2e0a 2020 2020 2020 2020 2222  gth`..        ""
+00006ac0: 220a 2020 2020 2020 2020 6966 2070 6f73  ".        if pos
+00006ad0: 6974 696f 6e20 3c20 3020 6f72 2070 6f73  ition < 0 or pos
+00006ae0: 6974 696f 6e20 3e3d 2073 656c 662e 7472  ition >= self.tr
+00006af0: 6565 5f73 6571 7565 6e63 652e 7365 7175  ee_sequence.sequ
+00006b00: 656e 6365 5f6c 656e 6774 683a 0a20 2020  ence_length:.   
+00006b10: 2020 2020 2020 2020 2072 6169 7365 2056           raise V
+00006b20: 616c 7565 4572 726f 7228 2250 6f73 6974  alueError("Posit
+00006b30: 696f 6e20 6f75 7420 6f66 2062 6f75 6e64  ion out of bound
+00006b40: 7322 290a 2020 2020 2020 2020 7365 6c66  s").        self
+00006b50: 2e5f 6c6c 5f74 7265 652e 7365 656b 2870  ._ll_tree.seek(p
+00006b60: 6f73 6974 696f 6e29 0a0a 2020 2020 6465  osition)..    de
+00006b70: 6620 7261 6e6b 2873 656c 6629 202d 3e20  f rank(self) -> 
+00006b80: 7473 6b69 742e 5261 6e6b 3a0a 2020 2020  tskit.Rank:.    
+00006b90: 2020 2020 2222 220a 2020 2020 2020 2020      """.        
+00006ba0: 5072 6f64 7563 6520 7468 6520 7261 6e6b  Produce the rank
+00006bb0: 206f 6620 7468 6973 2074 7265 6520 696e   of this tree in
+00006bc0: 2074 6865 2065 6e75 6d65 7261 7469 6f6e   the enumeration
+00006bd0: 206f 6620 616c 6c20 6c65 6166 2d6c 6162   of all leaf-lab
+00006be0: 656c 6c65 640a 2020 2020 2020 2020 7472  elled.        tr
+00006bf0: 6565 7320 6f66 206e 206c 6561 7665 732e  ees of n leaves.
+00006c00: 2053 6565 2074 6865 203a 7265 663a 6073   See the :ref:`s
+00006c10: 6563 5f74 7265 655f 7261 6e6b 7360 2073  ec_tree_ranks` s
+00006c20: 6563 7469 6f6e 2066 6f72 0a20 2020 2020  ection for.     
+00006c30: 2020 2064 6574 6169 6c73 206f 6e20 7261     details on ra
+00006c40: 6e6b 696e 6720 616e 6420 756e 7261 6e6b  nking and unrank
+00006c50: 696e 6720 7472 6565 732e 0a0a 2020 2020  ing trees...    
+00006c60: 2020 2020 3a72 6169 7365 7320 5661 6c75      :raises Valu
+00006c70: 6545 7272 6f72 3a20 4966 2074 6865 2074  eError: If the t
+00006c80: 7265 6520 6861 7320 6d75 6c74 6970 6c65  ree has multiple
+00006c90: 2072 6f6f 7473 2e0a 2020 2020 2020 2020   roots..        
+00006ca0: 2222 220a 2020 2020 2020 2020 7265 7475  """.        retu
+00006cb0: 726e 2063 6f6d 6269 6e61 746f 7269 6373  rn combinatorics
+00006cc0: 2e52 616e 6b54 7265 652e 6672 6f6d 5f74  .RankTree.from_t
+00006cd0: 736b 5f74 7265 6528 7365 6c66 292e 7261  sk_tree(self).ra
+00006ce0: 6e6b 2829 0a0a 2020 2020 4073 7461 7469  nk()..    @stati
+00006cf0: 636d 6574 686f 640a 2020 2020 6465 6620  cmethod.    def 
+00006d00: 756e 7261 6e6b 286e 756d 5f6c 6561 7665  unrank(num_leave
+00006d10: 732c 2072 616e 6b2c 202a 2c20 7370 616e  s, rank, *, span
+00006d20: 3d31 2c20 6272 616e 6368 5f6c 656e 6774  =1, branch_lengt
+00006d30: 683d 3129 202d 3e20 5472 6565 3a0a 2020  h=1) -> Tree:.  
+00006d40: 2020 2020 2020 2222 220a 2020 2020 2020        """.      
+00006d50: 2020 5265 636f 6e73 7472 7563 7420 7468    Reconstruct th
+00006d60: 6520 7472 6565 206f 6620 7468 6520 6769  e tree of the gi
+00006d70: 7665 6e20 6060 7261 6e6b 6060 0a20 2020  ven ``rank``.   
+00006d80: 2020 2020 2028 7365 6520 3a6d 6574 683a       (see :meth:
+00006d90: 6074 736b 6974 2e54 7265 652e 7261 6e6b  `tskit.Tree.rank
+00006da0: 6029 2077 6974 6820 6060 6e75 6d5f 6c65  `) with ``num_le
+00006db0: 6176 6573 6060 206c 6561 7665 732e 0a20  aves`` leaves.. 
+00006dc0: 2020 2020 2020 2054 6865 206c 6162 656c         The label
+00006dd0: 7320 616e 6420 7469 6d65 7320 6f66 2069  s and times of i
+00006de0: 6e74 6572 6e61 6c20 6e6f 6465 7320 6172  nternal nodes ar
+00006df0: 6520 6173 7369 676e 6564 2062 7920 6120  e assigned by a 
+00006e00: 706f 7374 6f72 6465 720a 2020 2020 2020  postorder.      
+00006e10: 2020 7472 6176 6572 7361 6c20 6f66 2074    traversal of t
+00006e20: 6865 206e 6f64 6573 2c20 7375 6368 2074  he nodes, such t
+00006e30: 6861 7420 7468 6520 7469 6d65 206f 6620  hat the time of 
+00006e40: 6561 6368 2069 6e74 6572 6e61 6c20 6e6f  each internal no
+00006e50: 6465 0a20 2020 2020 2020 2069 7320 7468  de.        is th
+00006e60: 6520 6d61 7869 6d75 6d20 7469 6d65 206f  e maximum time o
+00006e70: 6620 6974 7320 6368 696c 6472 656e 2070  f its children p
+00006e80: 6c75 7320 7468 6520 7370 6563 6966 6965  lus the specifie
+00006e90: 6420 6060 6272 616e 6368 5f6c 656e 6774  d ``branch_lengt
+00006ea0: 6860 602e 0a20 2020 2020 2020 2054 6865  h``..        The
+00006eb0: 2074 696d 6520 6f66 2065 6163 6820 6c65   time of each le
+00006ec0: 6166 2069 7320 302e 0a0a 2020 2020 2020  af is 0...      
+00006ed0: 2020 5365 6520 7468 6520 3a72 6566 3a60    See the :ref:`
+00006ee0: 7365 635f 7472 6565 5f72 616e 6b73 6020  sec_tree_ranks` 
+00006ef0: 7365 6374 696f 6e20 666f 7220 6465 7461  section for deta
+00006f00: 696c 7320 6f6e 2072 616e 6b69 6e67 2061  ils on ranking a
+00006f10: 6e64 0a20 2020 2020 2020 2075 6e72 616e  nd.        unran
+00006f20: 6b69 6e67 2074 7265 6573 2061 6e64 2077  king trees and w
+00006f30: 6861 7420 636f 6e73 7469 7475 7465 7320  hat constitutes 
+00006f40: 7661 6c69 6420 7261 6e6b 732e 0a0a 2020  valid ranks...  
+00006f50: 2020 2020 2020 3a70 6172 616d 2069 6e74        :param int
+00006f60: 206e 756d 5f6c 6561 7665 733a 2054 6865   num_leaves: The
+00006f70: 206e 756d 6265 7220 6f66 206c 6561 7665   number of leave
+00006f80: 7320 6f66 2074 6865 2074 7265 6520 746f  s of the tree to
+00006f90: 2067 656e 6572 6174 652e 0a20 2020 2020   generate..     
+00006fa0: 2020 203a 7061 7261 6d20 7475 706c 6528     :param tuple(
+00006fb0: 696e 7429 2072 616e 6b3a 2054 6865 2072  int) rank: The r
+00006fc0: 616e 6b20 6f66 2074 6865 2074 7265 6520  ank of the tree 
+00006fd0: 746f 2067 656e 6572 6174 652e 0a20 2020  to generate..   
+00006fe0: 2020 2020 203a 7061 7261 6d20 666c 6f61       :param floa
+00006ff0: 7420 7370 616e 3a20 5468 6520 6765 6e6f  t span: The geno
+00007000: 6d69 6320 7370 616e 206f 6620 7468 6520  mic span of the 
+00007010: 7265 7475 726e 6564 2074 7265 652e 2054  returned tree. T
+00007020: 6865 2074 7265 6520 7769 6c6c 2063 6f76  he tree will cov
+00007030: 6572 0a20 2020 2020 2020 2020 2020 2074  er.            t
+00007040: 6865 2069 6e74 6572 7661 6c20 3a6d 6174  he interval :mat
+00007050: 683a 605b 302c 205c 5c74 6578 747b 7370  h:`[0, \\text{sp
+00007060: 616e 7d29 6020 616e 6420 7468 6520 3a61  an})` and the :a
+00007070: 7474 723a 607e 5472 6565 2e74 7265 655f  ttr:`~Tree.tree_
+00007080: 7365 7175 656e 6365 600a 2020 2020 2020  sequence`.      
+00007090: 2020 2020 2020 6672 6f6d 2077 6869 6368        from which
+000070a0: 2074 6865 2074 7265 6520 6973 2074 616b   the tree is tak
+000070b0: 656e 2077 696c 6c20 6861 7665 2069 7473  en will have its
+000070c0: 0a20 2020 2020 2020 2020 2020 203a 6174  .            :at
+000070d0: 7472 3a60 7e74 736b 6974 2e54 7265 6553  tr:`~tskit.TreeS
+000070e0: 6571 7565 6e63 652e 7365 7175 656e 6365  equence.sequence
+000070f0: 5f6c 656e 6774 6860 2065 7175 616c 2074  _length` equal t
+00007100: 6f20 6060 7370 616e 6060 2e0a 2020 2020  o ``span``..    
+00007110: 2020 2020 3a70 6172 616d 3a20 666c 6f61      :param: floa
+00007120: 7420 6272 616e 6368 5f6c 656e 6774 683a  t branch_length:
+00007130: 2054 6865 206d 696e 696d 756d 206c 656e   The minimum len
+00007140: 6774 6820 6f66 2061 2062 7261 6e63 6820  gth of a branch 
+00007150: 696e 2074 6869 7320 7472 6565 2e0a 2020  in this tree..  
+00007160: 2020 2020 2020 3a72 6169 7365 733a 2056        :raises: V
+00007170: 616c 7565 4572 726f 723a 2049 6620 7468  alueError: If th
+00007180: 6520 6769 7665 6e20 7261 6e6b 2069 7320  e given rank is 
+00007190: 6f75 7420 6f66 2062 6f75 6e64 7320 666f  out of bounds fo
+000071a0: 7220 7472 6565 730a 2020 2020 2020 2020  r trees.        
+000071b0: 2020 2020 7769 7468 2060 606e 756d 5f6c      with ``num_l
+000071c0: 6561 7665 7360 6020 6c65 6176 6573 2e0a  eaves`` leaves..
+000071d0: 2020 2020 2020 2020 2222 220a 2020 2020          """.    
+000071e0: 2020 2020 7261 6e6b 5f74 7265 6520 3d20      rank_tree = 
+000071f0: 636f 6d62 696e 6174 6f72 6963 732e 5261  combinatorics.Ra
+00007200: 6e6b 5472 6565 2e75 6e72 616e 6b28 6e75  nkTree.unrank(nu
+00007210: 6d5f 6c65 6176 6573 2c20 7261 6e6b 290a  m_leaves, rank).
+00007220: 2020 2020 2020 2020 7265 7475 726e 2072          return r
+00007230: 616e 6b5f 7472 6565 2e74 6f5f 7473 6b5f  ank_tree.to_tsk_
+00007240: 7472 6565 2873 7061 6e3d 7370 616e 2c20  tree(span=span, 
+00007250: 6272 616e 6368 5f6c 656e 6774 683d 6272  branch_length=br
+00007260: 616e 6368 5f6c 656e 6774 6829 0a0a 2020  anch_length)..  
+00007270: 2020 6465 6620 636f 756e 745f 746f 706f    def count_topo
+00007280: 6c6f 6769 6573 2873 656c 662c 2073 616d  logies(self, sam
+00007290: 706c 655f 7365 7473 3d4e 6f6e 6529 202d  ple_sets=None) -
+000072a0: 3e20 7473 6b69 742e 546f 706f 6c6f 6779  > tskit.Topology
+000072b0: 436f 756e 7465 723a 0a20 2020 2020 2020  Counter:.       
+000072c0: 2022 2222 0a20 2020 2020 2020 2043 616c   """.        Cal
+000072d0: 6375 6c61 7465 7320 7468 6520 6469 7374  culates the dist
+000072e0: 7269 6275 7469 6f6e 206f 6620 656d 6265  ribution of embe
+000072f0: 6464 6564 2074 6f70 6f6c 6f67 6965 7320  dded topologies 
+00007300: 666f 7220 6576 6572 7920 636f 6d62 696e  for every combin
+00007310: 6174 696f 6e0a 2020 2020 2020 2020 6f66  ation.        of
+00007320: 2074 6865 2073 616d 706c 6520 7365 7473   the sample sets
+00007330: 2069 6e20 6060 7361 6d70 6c65 5f73 6574   in ``sample_set
+00007340: 7360 602e 2060 6073 616d 706c 655f 7365  s``. ``sample_se
+00007350: 7473 6060 2064 6566 6175 6c74 7320 746f  ts`` defaults to
+00007360: 2061 6c6c 0a20 2020 2020 2020 2073 616d   all.        sam
+00007370: 706c 6573 2069 6e20 7468 6520 7472 6565  ples in the tree
+00007380: 2067 726f 7570 6564 2062 7920 706f 7075   grouped by popu
+00007390: 6c61 7469 6f6e 2e0a 0a20 2020 2020 2020  lation...       
+000073a0: 2060 6073 616d 706c 655f 7365 7473 6060   ``sample_sets``
+000073b0: 206e 6565 6420 6e6f 7420 696e 636c 7564   need not includ
+000073c0: 6520 616c 6c20 7361 6d70 6c65 7320 6275  e all samples bu
+000073d0: 7420 6d75 7374 2062 6520 7061 6972 7769  t must be pairwi
+000073e0: 7365 2064 6973 6a6f 696e 742e 0a0a 2020  se disjoint...  
+000073f0: 2020 2020 2020 5468 6520 7265 7475 726e        The return
+00007400: 6564 206f 626a 6563 7420 6973 2061 203a  ed object is a :
+00007410: 636c 6173 733a 6074 736b 6974 2e54 6f70  class:`tskit.Top
+00007420: 6f6c 6f67 7943 6f75 6e74 6572 6020 7468  ologyCounter` th
+00007430: 6174 2063 6f6e 7461 696e 730a 2020 2020  at contains.    
+00007440: 2020 2020 636f 756e 7473 206f 6620 746f      counts of to
+00007450: 706f 6c6f 6769 6573 2070 6572 2063 6f6d  pologies per com
+00007460: 6269 6e61 7469 6f6e 206f 6620 7361 6d70  bination of samp
+00007470: 6c65 2073 6574 732e 2046 6f72 2065 7861  le sets. For exa
+00007480: 6d70 6c65 2c0a 0a20 2020 2020 2020 203e  mple,..        >
+00007490: 3e3e 2074 6f70 6f6c 6f67 795f 636f 756e  >> topology_coun
+000074a0: 7465 7220 3d20 7472 6565 2e63 6f75 6e74  ter = tree.count
+000074b0: 5f74 6f70 6f6c 6f67 6965 7328 290a 2020  _topologies().  
+000074c0: 2020 2020 2020 3e3e 3e20 7261 6e6b 2c20        >>> rank, 
+000074d0: 636f 756e 7420 3d20 746f 706f 6c6f 6779  count = topology
+000074e0: 5f63 6f75 6e74 6572 5b30 2c20 312c 2032  _counter[0, 1, 2
+000074f0: 5d2e 6d6f 7374 5f63 6f6d 6d6f 6e28 3129  ].most_common(1)
+00007500: 5b30 5d0a 0a20 2020 2020 2020 2070 726f  [0]..        pro
+00007510: 6475 6365 7320 7468 6520 6d6f 7374 2063  duces the most c
+00007520: 6f6d 6d6f 6e20 7472 6565 2074 6f70 6f6c  ommon tree topol
+00007530: 6f67 792c 2077 6974 6820 706f 7075 6c61  ogy, with popula
+00007540: 7469 6f6e 7320 302c 2031 0a20 2020 2020  tions 0, 1.     
+00007550: 2020 2061 6e64 2032 2061 7320 6974 7320     and 2 as its 
+00007560: 7469 7073 2c20 6163 636f 7264 696e 6720  tips, according 
+00007570: 746f 2074 6865 2067 656e 6561 6c6f 6769  to the genealogi
+00007580: 6573 206f 6620 7468 6f73 650a 2020 2020  es of those.    
+00007590: 2020 2020 706f 7075 6c61 7469 6f6e 7327      populations'
+000075a0: 2073 616d 706c 6573 2069 6e20 7468 6973   samples in this
+000075b0: 2074 7265 652e 0a0a 2020 2020 2020 2020   tree...        
+000075c0: 5468 6520 636f 756e 7473 2066 6f72 2065  The counts for e
+000075d0: 6163 6820 746f 706f 6c6f 6779 2069 6e20  ach topology in 
+000075e0: 7468 6520 3a63 6c61 7373 3a60 7473 6b69  the :class:`tski
+000075f0: 742e 546f 706f 6c6f 6779 436f 756e 7465  t.TopologyCounte
+00007600: 7260 0a20 2020 2020 2020 2061 7265 2061  r`.        are a
+00007610: 6273 6f6c 7574 6520 636f 756e 7473 2074  bsolute counts t
+00007620: 6861 7420 7765 2077 6f75 6c64 2067 6574  hat we would get
+00007630: 2069 6620 7765 2077 6572 6520 746f 2073   if we were to s
+00007640: 656c 6563 7420 616c 6c0a 2020 2020 2020  elect all.      
+00007650: 2020 636f 6d62 696e 6174 696f 6e73 206f    combinations o
+00007660: 6620 7361 6d70 6c65 7320 6672 6f6d 2074  f samples from t
+00007670: 6865 2072 656c 6576 616e 7420 7361 6d70  he relevant samp
+00007680: 6c65 2073 6574 732e 0a20 2020 2020 2020  le sets..       
+00007690: 2046 6f72 2073 616d 706c 6520 7365 7473   For sample sets
+000076a0: 203a 6d61 7468 3a60 5b73 5f30 2c20 735f   :math:`[s_0, s_
+000076b0: 312c 202e 2e2e 2c20 735f 6e5d 602c 2074  1, ..., s_n]`, t
+000076c0: 6865 2074 6f74 616c 206e 756d 6265 7220  he total number 
+000076d0: 6f66 0a20 2020 2020 2020 2074 6f70 6f6c  of.        topol
+000076e0: 6f67 6965 7320 666f 7220 7468 6f73 6520  ogies for those 
+000076f0: 7361 6d70 6c65 2073 6574 7320 6973 2065  sample sets is e
+00007700: 7175 616c 2074 6f0a 2020 2020 2020 2020  qual to.        
+00007710: 3a6d 6174 683a 607c 735f 307c 202a 207c  :math:`|s_0| * |
+00007720: 735f 317c 202a 202e 2e2e 202a 207c 735f  s_1| * ... * |s_
+00007730: 6e7c 602c 2073 6f20 7468 6520 636f 756e  n|`, so the coun
+00007740: 7473 2069 6e20 7468 6520 636f 756e 7465  ts in the counte
+00007750: 720a 2020 2020 2020 2020 6060 746f 706f  r.        ``topo
+00007760: 6c6f 6779 5f63 6f75 6e74 6572 5b30 2c20  logy_counter[0, 
+00007770: 312c 202e 2e2e 2c20 6e5d 6060 2073 686f  1, ..., n]`` sho
+00007780: 756c 6420 7375 6d20 746f 0a20 2020 2020  uld sum to.     
+00007790: 2020 203a 6d61 7468 3a60 7c73 5f30 7c20     :math:`|s_0| 
+000077a0: 2a20 7c73 5f31 7c20 2a20 2e2e 2e20 2a20  * |s_1| * ... * 
+000077b0: 7c73 5f6e 7c60 2e0a 0a20 2020 2020 2020  |s_n|`...       
+000077c0: 2054 6f20 636f 6e76 6572 7420 7468 6520   To convert the 
+000077d0: 746f 706f 6c6f 6779 2063 6f75 6e74 7320  topology counts 
+000077e0: 746f 2070 726f 6261 6269 6c69 7469 6573  to probabilities
+000077f0: 2c20 6469 7669 6465 2062 7920 7468 6520  , divide by the 
+00007800: 746f 7461 6c0a 2020 2020 2020 2020 706f  total.        po
+00007810: 7373 6962 6c65 206e 756d 6265 7220 6f66  ssible number of
+00007820: 2073 616d 706c 6520 636f 6d62 696e 6174   sample combinat
+00007830: 696f 6e73 2066 726f 6d20 7468 6520 7361  ions from the sa
+00007840: 6d70 6c65 2073 6574 7320 696e 2071 7565  mple sets in que
+00007850: 7374 696f 6e3a 3a0a 0a20 2020 2020 2020  stion::..       
+00007860: 2020 2020 203e 3e3e 2073 6574 5f73 697a       >>> set_siz
+00007870: 6573 203d 205b 6c65 6e28 7361 6d70 6c65  es = [len(sample
+00007880: 5f73 6574 2920 666f 7220 7361 6d70 6c65  _set) for sample
+00007890: 5f73 6574 2069 6e20 7361 6d70 6c65 5f73  _set in sample_s
+000078a0: 6574 735d 0a20 2020 2020 2020 2020 2020  ets].           
+000078b0: 203e 3e3e 2070 203d 2063 6f75 6e74 202f   >>> p = count /
+000078c0: 2028 7365 745f 7369 7a65 735b 305d 202a   (set_sizes[0] *
+000078d0: 2073 6574 5f73 697a 6573 5b31 5d20 2a20   set_sizes[1] * 
+000078e0: 7365 745f 7369 7a65 735b 325d 290a 0a20  set_sizes[2]).. 
+000078f0: 2020 2020 2020 202e 2e20 7761 726e 696e         .. warnin
+00007900: 673a 3a20 5468 6520 696e 7465 7266 6163  g:: The interfac
+00007910: 6520 666f 7220 7468 6973 206d 6574 686f  e for this metho
+00007920: 6420 6973 2070 7265 6c69 6d69 6e61 7279  d is preliminary
+00007930: 2061 6e64 206d 6179 2062 6520 7375 626a   and may be subj
+00007940: 6563 7420 746f 0a20 2020 2020 2020 2020  ect to.         
+00007950: 2020 2062 6163 6b77 6172 6473 2069 6e63     backwards inc
+00007960: 6f6d 7061 7469 626c 6520 6368 616e 6765  ompatible change
+00007970: 7320 696e 2074 6865 206e 6561 7220 6675  s in the near fu
+00007980: 7475 7265 2e0a 0a20 2020 2020 2020 203a  ture...        :
+00007990: 7061 7261 6d20 6c69 7374 2073 616d 706c  param list sampl
+000079a0: 655f 7365 7473 3a20 4120 6c69 7374 206f  e_sets: A list o
+000079b0: 6620 6c69 7374 7320 6f66 204e 6f64 6520  f lists of Node 
+000079c0: 4944 732c 2073 7065 6369 6679 696e 6720  IDs, specifying 
+000079d0: 7468 650a 2020 2020 2020 2020 2020 2020  the.            
+000079e0: 6772 6f75 7073 206f 6620 6e6f 6465 7320  groups of nodes 
+000079f0: 746f 2063 6f6d 7075 7465 2074 6865 2073  to compute the s
+00007a00: 7461 7469 7374 6963 2077 6974 682e 0a20  tatistic with.. 
+00007a10: 2020 2020 2020 2020 2020 2044 6566 6175             Defau
+00007a20: 6c74 7320 746f 2061 6c6c 2073 616d 706c  lts to all sampl
+00007a30: 6573 2067 726f 7570 6564 2062 7920 706f  es grouped by po
+00007a40: 7075 6c61 7469 6f6e 2e0a 2020 2020 2020  pulation..      
+00007a50: 2020 3a72 6169 7365 7320 5661 6c75 6545    :raises ValueE
+00007a60: 7272 6f72 3a20 4966 206e 6f64 6573 2069  rror: If nodes i
+00007a70: 6e20 6060 7361 6d70 6c65 5f73 6574 7360  n ``sample_sets`
+00007a80: 6020 6172 6520 696e 7661 6c69 6420 6f72  ` are invalid or
+00007a90: 2061 7265 0a20 2020 2020 2020 2020 2020   are.           
+00007aa0: 2069 6e74 6572 6e61 6c20 7361 6d70 6c65   internal sample
+00007ab0: 732e 0a20 2020 2020 2020 2022 2222 0a20  s..        """. 
+00007ac0: 2020 2020 2020 2069 6620 7361 6d70 6c65         if sample
+00007ad0: 5f73 6574 7320 6973 204e 6f6e 653a 0a20  _sets is None:. 
+00007ae0: 2020 2020 2020 2020 2020 2073 616d 706c             sampl
+00007af0: 655f 7365 7473 203d 205b 0a20 2020 2020  e_sets = [.     
+00007b00: 2020 2020 2020 2020 2020 2073 656c 662e             self.
+00007b10: 7472 6565 5f73 6571 7565 6e63 652e 7361  tree_sequence.sa
+00007b20: 6d70 6c65 7328 706f 7075 6c61 7469 6f6e  mples(population
+00007b30: 3d70 6f70 2e69 6429 0a20 2020 2020 2020  =pop.id).       
+00007b40: 2020 2020 2020 2020 2066 6f72 2070 6f70           for pop
+00007b50: 2069 6e20 7365 6c66 2e74 7265 655f 7365   in self.tree_se
+00007b60: 7175 656e 6365 2e70 6f70 756c 6174 696f  quence.populatio
+00007b70: 6e73 2829 0a20 2020 2020 2020 2020 2020  ns().           
+00007b80: 205d 0a0a 2020 2020 2020 2020 7265 7475   ]..        retu
+00007b90: 726e 2063 6f6d 6269 6e61 746f 7269 6373  rn combinatorics
+00007ba0: 2e74 7265 655f 636f 756e 745f 746f 706f  .tree_count_topo
+00007bb0: 6c6f 6769 6573 2873 656c 662c 2073 616d  logies(self, sam
+00007bc0: 706c 655f 7365 7473 290a 0a20 2020 2064  ple_sets)..    d
+00007bd0: 6566 2067 6574 5f62 7261 6e63 685f 6c65  ef get_branch_le
+00007be0: 6e67 7468 2873 656c 662c 2075 293a 0a20  ngth(self, u):. 
+00007bf0: 2020 2020 2020 2023 2044 6570 7265 6361         # Depreca
+00007c00: 7465 6420 616c 6961 7320 666f 7220 6272  ted alias for br
+00007c10: 616e 6368 5f6c 656e 6774 680a 2020 2020  anch_length.    
+00007c20: 2020 2020 7265 7475 726e 2073 656c 662e      return self.
+00007c30: 6272 616e 6368 5f6c 656e 6774 6828 7529  branch_length(u)
+00007c40: 0a0a 2020 2020 6465 6620 6272 616e 6368  ..    def branch
+00007c50: 5f6c 656e 6774 6828 7365 6c66 2c20 7529  _length(self, u)
+00007c60: 3a0a 2020 2020 2020 2020 2222 220a 2020  :.        """.  
+00007c70: 2020 2020 2020 5265 7475 726e 7320 7468        Returns th
+00007c80: 6520 6c65 6e67 7468 206f 6620 7468 6520  e length of the 
+00007c90: 6272 616e 6368 2028 696e 2075 6e69 7473  branch (in units
+00007ca0: 206f 6620 7469 6d65 2920 6a6f 696e 696e   of time) joinin
+00007cb0: 6720 7468 650a 2020 2020 2020 2020 7370  g the.        sp
+00007cc0: 6563 6966 6965 6420 6e6f 6465 2074 6f20  ecified node to 
+00007cd0: 6974 7320 7061 7265 6e74 2e20 5468 6973  its parent. This
+00007ce0: 2069 7320 6571 7569 7661 6c65 6e74 2074   is equivalent t
+00007cf0: 6f0a 0a20 2020 2020 2020 203e 3e3e 2074  o..        >>> t
+00007d00: 7265 652e 7469 6d65 2874 7265 652e 7061  ree.time(tree.pa
+00007d10: 7265 6e74 2875 2929 202d 2074 7265 652e  rent(u)) - tree.
+00007d20: 7469 6d65 2875 290a 0a20 2020 2020 2020  time(u)..       
+00007d30: 2054 6865 2062 7261 6e63 6820 6c65 6e67   The branch leng
+00007d40: 7468 2066 6f72 2061 206e 6f64 6520 7468  th for a node th
+00007d50: 6174 2068 6173 206e 6f20 7061 7265 6e74  at has no parent
+00007d60: 2028 652e 672e 2c20 6120 726f 6f74 2920   (e.g., a root) 
+00007d70: 6973 0a20 2020 2020 2020 2064 6566 696e  is.        defin
+00007d80: 6564 2061 7320 7a65 726f 2e0a 0a20 2020  ed as zero...   
+00007d90: 2020 2020 204e 6f74 6520 7468 6174 2074       Note that t
+00007da0: 6869 7320 6973 206e 6f74 2072 656c 6174  his is not relat
+00007db0: 6564 2074 6f20 7468 6520 7072 6f70 6572  ed to the proper
+00007dc0: 7479 2060 2e6c 656e 6774 6860 2077 6869  ty `.length` whi
+00007dd0: 6368 0a20 2020 2020 2020 2069 7320 6120  ch.        is a 
+00007de0: 6465 7072 6563 6174 6564 2061 6c69 6173  deprecated alias
+00007df0: 2066 6f72 2074 6865 2067 656e 6f6d 6963   for the genomic
+00007e00: 203a 6174 7472 3a60 7e54 7265 652e 7370   :attr:`~Tree.sp
+00007e10: 616e 6020 636f 7665 7265 6420 6279 2061  an` covered by a
+00007e20: 2074 7265 652e 0a0a 2020 2020 2020 2020   tree...        
+00007e30: 3a70 6172 616d 2069 6e74 2075 3a20 5468  :param int u: Th
+00007e40: 6520 6e6f 6465 206f 6620 696e 7465 7265  e node of intere
+00007e50: 7374 2e0a 2020 2020 2020 2020 3a72 6574  st..        :ret
+00007e60: 7572 6e3a 2054 6865 2062 7261 6e63 6820  urn: The branch 
+00007e70: 6c65 6e67 7468 2066 726f 6d20 7520 746f  length from u to
+00007e80: 2069 7473 2070 6172 656e 742e 0a20 2020   its parent..   
+00007e90: 2020 2020 203a 7274 7970 653a 2066 6c6f       :rtype: flo
+00007ea0: 6174 0a20 2020 2020 2020 2022 2222 0a20  at.        """. 
+00007eb0: 2020 2020 2020 2072 6574 203d 2030 0a20         ret = 0. 
+00007ec0: 2020 2020 2020 2070 6172 656e 7420 3d20         parent = 
+00007ed0: 7365 6c66 2e70 6172 656e 7428 7529 0a20  self.parent(u). 
+00007ee0: 2020 2020 2020 2069 6620 7061 7265 6e74         if parent
+00007ef0: 2021 3d20 4e55 4c4c 3a0a 2020 2020 2020   != NULL:.      
+00007f00: 2020 2020 2020 7265 7420 3d20 7365 6c66        ret = self
+00007f10: 2e74 696d 6528 7061 7265 6e74 2920 2d20  .time(parent) - 
+00007f20: 7365 6c66 2e74 696d 6528 7529 0a20 2020  self.time(u).   
+00007f30: 2020 2020 2072 6574 7572 6e20 7265 740a       return ret.
+00007f40: 0a20 2020 2064 6566 2067 6574 5f74 6f74  .    def get_tot
+00007f50: 616c 5f62 7261 6e63 685f 6c65 6e67 7468  al_branch_length
+00007f60: 2873 656c 6629 3a0a 2020 2020 2020 2020  (self):.        
+00007f70: 2320 4465 7072 6563 6174 6564 2061 6c69  # Deprecated ali
+00007f80: 6173 2066 6f72 2074 6f74 616c 5f62 7261  as for total_bra
+00007f90: 6e63 685f 6c65 6e67 7468 0a20 2020 2020  nch_length.     
+00007fa0: 2020 2072 6574 7572 6e20 7365 6c66 2e74     return self.t
+00007fb0: 6f74 616c 5f62 7261 6e63 685f 6c65 6e67  otal_branch_leng
+00007fc0: 7468 0a0a 2020 2020 4070 726f 7065 7274  th..    @propert
+00007fd0: 790a 2020 2020 6465 6620 746f 7461 6c5f  y.    def total_
+00007fe0: 6272 616e 6368 5f6c 656e 6774 6828 7365  branch_length(se
+00007ff0: 6c66 293a 0a20 2020 2020 2020 2022 2222  lf):.        """
+00008000: 0a20 2020 2020 2020 2052 6574 7572 6e73  .        Returns
+00008010: 2074 6865 2073 756d 206f 6620 616c 6c20   the sum of all 
+00008020: 7468 6520 6272 616e 6368 206c 656e 6774  the branch lengt
+00008030: 6873 2069 6e20 7468 6973 2074 7265 6520  hs in this tree 
+00008040: 2869 6e0a 2020 2020 2020 2020 756e 6974  (in.        unit
+00008050: 7320 6f66 2074 696d 6529 2e20 5468 6973  s of time). This
+00008060: 2069 7320 6571 7569 7661 6c65 6e74 2074   is equivalent t
+00008070: 6f0a 0a20 2020 2020 2020 203e 3e3e 2073  o..        >>> s
+00008080: 756d 2874 7265 652e 6272 616e 6368 5f6c  um(tree.branch_l
+00008090: 656e 6774 6828 7529 2066 6f72 2075 2069  ength(u) for u i
+000080a0: 6e20 7472 6565 2e6e 6f64 6573 2829 290a  n tree.nodes()).
+000080b0: 0a20 2020 2020 2020 204e 6f74 6520 7468  .        Note th
+000080c0: 6174 2074 6865 2062 7261 6e63 6820 6c65  at the branch le
+000080d0: 6e67 7468 7320 666f 7220 726f 6f74 206e  ngths for root n
+000080e0: 6f64 6573 2061 7265 2064 6566 696e 6564  odes are defined
+000080f0: 2061 7320 7a65 726f 2e0a 0a20 2020 2020   as zero...     
+00008100: 2020 2041 7320 7468 6973 2069 7320 6465     As this is de
+00008110: 6669 6e65 6420 6279 2061 2074 7261 7665  fined by a trave
+00008120: 7273 616c 206f 6620 7468 6520 7472 6565  rsal of the tree
+00008130: 2c20 7465 6368 6e69 6361 6c6c 7920 7765  , technically we
+00008140: 0a20 2020 2020 2020 2072 6574 7572 6e20  .        return 
+00008150: 7468 6520 7375 6d20 6f66 2061 6c6c 2062  the sum of all b
+00008160: 7261 6e63 6820 6c65 6e67 7468 7320 7468  ranch lengths th
+00008170: 6174 2061 7265 2072 6561 6368 6162 6c65  at are reachable
+00008180: 2066 726f 6d0a 2020 2020 2020 2020 726f   from.        ro
+00008190: 6f74 732e 2054 6875 732c 2074 6869 7320  ots. Thus, this 
+000081a0: 6973 2074 6865 2074 6f74 616c 206c 656e  is the total len
+000081b0: 6774 6820 6f66 2061 6c6c 2062 7261 6e63  gth of all branc
+000081c0: 6865 7320 7468 6174 2061 7265 2063 6f6e  hes that are con
+000081d0: 6e65 6374 6564 0a20 2020 2020 2020 2074  nected.        t
+000081e0: 6f20 6174 206c 6561 7374 206f 6e65 2073  o at least one s
+000081f0: 616d 706c 652e 2054 6869 7320 6469 7374  ample. This dist
+00008200: 696e 6374 696f 6e20 6973 206f 6e6c 7920  inction is only 
+00008210: 696d 706f 7274 616e 740a 2020 2020 2020  important.      
+00008220: 2020 696e 2074 7265 6520 7365 7175 656e    in tree sequen
+00008230: 6365 7320 7468 6174 2063 6f6e 7461 696e  ces that contain
+00008240: 2027 6465 6164 2062 7261 6e63 6865 7327   'dead branches'
+00008250: 2c20 692e 652e 2c20 7468 6f73 650a 2020  , i.e., those.  
+00008260: 2020 2020 2020 7468 6174 2064 6566 696e        that defin
+00008270: 6520 746f 706f 6c6f 6779 2074 6861 7420  e topology that 
+00008280: 6973 206e 6f74 2063 6f6e 6e65 6374 6564  is not connected
+00008290: 2074 6f20 6120 7472 6565 2072 6f6f 740a   to a tree root.
+000082a0: 2020 2020 2020 2020 2873 6565 203a 7265          (see :re
+000082b0: 663a 6073 6563 5f64 6174 615f 6d6f 6465  f:`sec_data_mode
+000082c0: 6c5f 7472 6565 5f64 6561 645f 6c65 6176  l_tree_dead_leav
+000082d0: 6573 5f61 6e64 5f62 7261 6e63 6865 7360  es_and_branches`
+000082e0: 290a 0a20 2020 2020 2020 203a 7265 7475  )..        :retu
+000082f0: 726e 3a20 5468 6520 7375 6d20 6f66 206c  rn: The sum of l
+00008300: 656e 6774 6873 206f 6620 6272 616e 6368  engths of branch
+00008310: 6573 2069 6e20 7468 6973 2074 7265 652e  es in this tree.
+00008320: 0a20 2020 2020 2020 203a 7274 7970 653a  .        :rtype:
+00008330: 2066 6c6f 6174 0a20 2020 2020 2020 2022   float.        "
+00008340: 2222 0a20 2020 2020 2020 2072 6574 7572  "".        retur
+00008350: 6e20 7365 6c66 2e5f 6c6c 5f74 7265 652e  n self._ll_tree.
+00008360: 6765 745f 746f 7461 6c5f 6272 616e 6368  get_total_branch
+00008370: 5f6c 656e 6774 6828 290a 0a20 2020 2064  _length()..    d
+00008380: 6566 2067 6574 5f6d 7263 6128 7365 6c66  ef get_mrca(self
+00008390: 2c20 752c 2076 293a 0a20 2020 2020 2020  , u, v):.       
+000083a0: 2023 2044 6570 7265 6361 7465 6420 616c   # Deprecated al
+000083b0: 6961 7320 666f 7220 6d72 6361 0a20 2020  ias for mrca.   
+000083c0: 2020 2020 2072 6574 7572 6e20 7365 6c66       return self
+000083d0: 2e6d 7263 6128 752c 2076 290a 0a20 2020  .mrca(u, v)..   
+000083e0: 2064 6566 206d 7263 6128 7365 6c66 2c20   def mrca(self, 
+000083f0: 2a61 7267 7329 3a0a 2020 2020 2020 2020  *args):.        
+00008400: 2222 220a 2020 2020 2020 2020 5265 7475  """.        Retu
+00008410: 726e 7320 7468 6520 6d6f 7374 2072 6563  rns the most rec
+00008420: 656e 7420 636f 6d6d 6f6e 2061 6e63 6573  ent common ances
+00008430: 746f 7220 6f66 2074 6865 2073 7065 6369  tor of the speci
+00008440: 6669 6564 206e 6f64 6573 2e0a 0a20 2020  fied nodes...   
+00008450: 2020 2020 203a 7061 7261 6d20 696e 7420       :param int 
+00008460: 602a 6172 6773 603a 2069 6e70 7574 206e  `*args`: input n
+00008470: 6f64 6520 4944 732c 206d 7573 7420 6265  ode IDs, must be
+00008480: 2061 7420 6c65 6173 7420 322e 0a20 2020   at least 2..   
+00008490: 2020 2020 203a 7265 7475 726e 3a20 5468       :return: Th
+000084a0: 6520 6d6f 7374 2072 6563 656e 7420 636f  e most recent co
+000084b0: 6d6d 6f6e 2061 6e63 6573 746f 7220 6f66  mmon ancestor of
+000084c0: 2069 6e70 7574 206e 6f64 6573 2e0a 2020   input nodes..  
+000084d0: 2020 2020 2020 3a72 7479 7065 3a20 696e        :rtype: in
+000084e0: 740a 2020 2020 2020 2020 2222 220a 2020  t.        """.  
+000084f0: 2020 2020 2020 6966 206c 656e 2861 7267        if len(arg
+00008500: 7329 203c 2032 3a0a 2020 2020 2020 2020  s) < 2:.        
+00008510: 2020 2020 7261 6973 6520 5661 6c75 6545      raise ValueE
+00008520: 7272 6f72 2822 4d75 7374 2073 7570 706c  rror("Must suppl
+00008530: 7920 6174 206c 6561 7374 2074 776f 2061  y at least two a
+00008540: 7267 756d 656e 7473 2229 0a20 2020 2020  rguments").     
+00008550: 2020 206d 7263 6120 3d20 6172 6773 5b30     mrca = args[0
+00008560: 5d0a 2020 2020 2020 2020 666f 7220 6e6f  ].        for no
+00008570: 6465 2069 6e20 6172 6773 5b31 3a5d 3a0a  de in args[1:]:.
+00008580: 2020 2020 2020 2020 2020 2020 6d72 6361              mrca
+00008590: 203d 2073 656c 662e 5f6c 6c5f 7472 6565   = self._ll_tree
+000085a0: 2e67 6574 5f6d 7263 6128 6d72 6361 2c20  .get_mrca(mrca, 
+000085b0: 6e6f 6465 290a 2020 2020 2020 2020 2020  node).          
+000085c0: 2020 6966 206d 7263 6120 3d3d 2074 736b    if mrca == tsk
+000085d0: 6974 2e4e 554c 4c3a 0a20 2020 2020 2020  it.NULL:.       
+000085e0: 2020 2020 2020 2020 2062 7265 616b 0a20           break. 
+000085f0: 2020 2020 2020 2072 6574 7572 6e20 6d72         return mr
+00008600: 6361 0a0a 2020 2020 6465 6620 6765 745f  ca..    def get_
+00008610: 746d 7263 6128 7365 6c66 2c20 752c 2076  tmrca(self, u, v
+00008620: 293a 0a20 2020 2020 2020 2023 2044 6570  ):.        # Dep
+00008630: 7265 6361 7465 6420 616c 6961 7320 666f  recated alias fo
+00008640: 7220 746d 7263 610a 2020 2020 2020 2020  r tmrca.        
+00008650: 7265 7475 726e 2073 656c 662e 746d 7263  return self.tmrc
+00008660: 6128 752c 2076 290a 0a20 2020 2064 6566  a(u, v)..    def
+00008670: 2074 6d72 6361 2873 656c 662c 2075 2c20   tmrca(self, u, 
+00008680: 7629 3a0a 2020 2020 2020 2020 2222 220a  v):.        """.
+00008690: 2020 2020 2020 2020 5265 7475 726e 7320          Returns 
+000086a0: 7468 6520 7469 6d65 206f 6620 7468 6520  the time of the 
+000086b0: 6d6f 7374 2072 6563 656e 7420 636f 6d6d  most recent comm
+000086c0: 6f6e 2061 6e63 6573 746f 7220 6f66 2074  on ancestor of t
+000086d0: 6865 2073 7065 6369 6669 6564 0a20 2020  he specified.   
+000086e0: 2020 2020 206e 6f64 6573 2e20 5468 6973       nodes. This
+000086f0: 2069 7320 6571 7569 7661 6c65 6e74 2074   is equivalent t
+00008700: 6f3a 3a0a 0a20 2020 2020 2020 2020 2020  o::..           
+00008710: 203e 3e3e 2074 7265 652e 7469 6d65 2874   >>> tree.time(t
+00008720: 7265 652e 6d72 6361 2875 2c20 7629 290a  ree.mrca(u, v)).
+00008730: 0a20 2020 2020 2020 202e 2e20 6e6f 7465  .        .. note
+00008740: 3a3a 0a20 2020 2020 2020 2020 2020 2049  ::.            I
+00008750: 6620 796f 7520 6172 6520 7573 696e 6720  f you are using 
+00008760: 7468 6973 206d 6574 686f 6420 746f 2063  this method to c
+00008770: 616c 6375 6c61 7465 2061 7665 7261 6765  alculate average
+00008780: 2074 6d72 6361 2076 616c 7565 7320 616c   tmrca values al
+00008790: 6f6e 6720 7468 650a 2020 2020 2020 2020  ong the.        
+000087a0: 2020 2020 6765 6e6f 6d65 2062 6574 7765      genome betwe
+000087b0: 656e 2070 6169 7273 206f 6620 7361 6d70  en pairs of samp
+000087c0: 6c65 206e 6f64 6573 2c20 666f 7220 6566  le nodes, for ef
+000087d0: 6669 6369 656e 6379 2072 6561 736f 6e73  ficiency reasons
+000087e0: 2079 6f75 2073 686f 756c 640a 2020 2020   you should.    
+000087f0: 2020 2020 2020 2020 696e 7374 6561 6420          instead 
+00008800: 636f 6e73 6964 6572 2074 6865 2060 606d  consider the ``m
+00008810: 6f64 653d 2262 7261 6e63 6822 6060 206f  ode="branch"`` o
+00008820: 7074 696f 6e20 6f66 2074 6865 0a20 2020  ption of the.   
+00008830: 2020 2020 2020 2020 203a 6d65 7468 3a60           :meth:`
+00008840: 5472 6565 5365 7175 656e 6365 2e64 6976  TreeSequence.div
+00008850: 6572 6765 6e63 6560 206f 7220 3a6d 6574  ergence` or :met
+00008860: 683a 6054 7265 6553 6571 7565 6e63 652e  h:`TreeSequence.
+00008870: 6469 7665 7273 6974 7960 206d 6574 686f  diversity` metho
+00008880: 6473 2e0a 2020 2020 2020 2020 2020 2020  ds..            
+00008890: 5369 6e63 6520 7468 6573 6520 6361 6c63  Since these calc
+000088a0: 756c 6174 6520 7468 6520 6176 6572 6167  ulate the averag
+000088b0: 6520 6272 616e 6368 206c 656e 6774 6820  e branch length 
+000088c0: 6265 7477 6565 6e20 7061 6972 7320 6f66  between pairs of
+000088d0: 2073 616d 706c 650a 2020 2020 2020 2020   sample.        
+000088e0: 2020 2020 6e6f 6465 732c 2066 6f72 2073      nodes, for s
+000088f0: 616d 706c 6573 2061 7420 7469 6d65 2030  amples at time 0
+00008900: 2074 6865 2072 6573 756c 7469 6e67 2073   the resulting s
+00008910: 7461 7469 7374 6963 7320 7769 6c6c 2062  tatistics will b
+00008920: 6520 6578 6163 746c 790a 2020 2020 2020  e exactly.      
+00008930: 2020 2020 2020 7477 6963 6520 7468 6520        twice the 
+00008940: 746d 7263 6120 7661 6c75 652e 0a0a 2020  tmrca value...  
+00008950: 2020 2020 2020 3a70 6172 616d 2069 6e74        :param int
+00008960: 2075 3a20 5468 6520 6669 7273 7420 6e6f   u: The first no
+00008970: 6465 2e0a 2020 2020 2020 2020 3a70 6172  de..        :par
+00008980: 616d 2069 6e74 2076 3a20 5468 6520 7365  am int v: The se
+00008990: 636f 6e64 206e 6f64 652e 0a20 2020 2020  cond node..     
+000089a0: 2020 203a 7265 7475 726e 3a20 5468 6520     :return: The 
+000089b0: 7469 6d65 206f 6620 7468 6520 6d6f 7374  time of the most
+000089c0: 2072 6563 656e 7420 636f 6d6d 6f6e 2061   recent common a
+000089d0: 6e63 6573 746f 7220 6f66 2075 2061 6e64  ncestor of u and
+000089e0: 2076 2e0a 2020 2020 2020 2020 3a72 7479   v..        :rty
+000089f0: 7065 3a20 666c 6f61 740a 2020 2020 2020  pe: float.      
+00008a00: 2020 2222 220a 2020 2020 2020 2020 7265    """.        re
+00008a10: 7475 726e 2073 656c 662e 6765 745f 7469  turn self.get_ti
+00008a20: 6d65 2873 656c 662e 6765 745f 6d72 6361  me(self.get_mrca
+00008a30: 2875 2c20 7629 290a 0a20 2020 2064 6566  (u, v))..    def
+00008a40: 2067 6574 5f70 6172 656e 7428 7365 6c66   get_parent(self
+00008a50: 2c20 7529 3a0a 2020 2020 2020 2020 2320  , u):.        # 
+00008a60: 4465 7072 6563 6174 6564 2061 6c69 6173  Deprecated alias
+00008a70: 2066 6f72 2070 6172 656e 740a 2020 2020   for parent.    
+00008a80: 2020 2020 7265 7475 726e 2073 656c 662e      return self.
+00008a90: 7061 7265 6e74 2875 290a 0a20 2020 2064  parent(u)..    d
+00008aa0: 6566 2070 6172 656e 7428 7365 6c66 2c20  ef parent(self, 
+00008ab0: 7529 3a0a 2020 2020 2020 2020 2222 220a  u):.        """.
+00008ac0: 2020 2020 2020 2020 5265 7475 726e 7320          Returns 
+00008ad0: 7468 6520 7061 7265 6e74 206f 6620 7468  the parent of th
+00008ae0: 6520 7370 6563 6966 6965 6420 6e6f 6465  e specified node
+00008af0: 2e20 5265 7475 726e 730a 2020 2020 2020  . Returns.      
+00008b00: 2020 3a64 6174 613a 6074 736b 6974 2e4e    :data:`tskit.N
+00008b10: 554c 4c60 2069 6620 7520 6973 2061 2072  ULL` if u is a r
+00008b20: 6f6f 7420 6f72 2069 7320 6e6f 7420 6120  oot or is not a 
+00008b30: 6e6f 6465 2069 6e0a 2020 2020 2020 2020  node in.        
+00008b40: 7468 6520 6375 7272 656e 7420 7472 6565  the current tree
+00008b50: 2e0a 0a20 2020 2020 2020 203a 7061 7261  ...        :para
+00008b60: 6d20 696e 7420 753a 2054 6865 206e 6f64  m int u: The nod
+00008b70: 6520 6f66 2069 6e74 6572 6573 742e 0a20  e of interest.. 
+00008b80: 2020 2020 2020 203a 7265 7475 726e 3a20         :return: 
+00008b90: 5468 6520 7061 7265 6e74 206f 6620 752e  The parent of u.
+00008ba0: 0a20 2020 2020 2020 203a 7274 7970 653a  .        :rtype:
+00008bb0: 2069 6e74 0a20 2020 2020 2020 2022 2222   int.        """
+00008bc0: 0a20 2020 2020 2020 2072 6574 7572 6e20  .        return 
+00008bd0: 7365 6c66 2e5f 6c6c 5f74 7265 652e 6765  self._ll_tree.ge
+00008be0: 745f 7061 7265 6e74 2875 290a 0a20 2020  t_parent(u)..   
+00008bf0: 2040 7072 6f70 6572 7479 0a20 2020 2064   @property.    d
+00008c00: 6566 2070 6172 656e 745f 6172 7261 7928  ef parent_array(
+00008c10: 7365 6c66 293a 0a20 2020 2020 2020 2022  self):.        "
+00008c20: 2222 0a20 2020 2020 2020 2041 206e 756d  "".        A num
+00008c30: 7079 2061 7272 6179 2028 6474 7970 653d  py array (dtype=
+00008c40: 6e70 2e69 6e74 3332 2920 656e 636f 6469  np.int32) encodi
+00008c50: 6e67 2074 6865 2070 6172 656e 7420 6f66  ng the parent of
+00008c60: 2065 6163 6820 6e6f 6465 0a20 2020 2020   each node.     
+00008c70: 2020 2069 6e20 7468 6973 2074 7265 652c     in this tree,
+00008c80: 2073 7563 6820 7468 6174 2060 6074 7265   such that ``tre
+00008c90: 652e 7061 7265 6e74 5f61 7272 6179 5b75  e.parent_array[u
+00008ca0: 5d20 3d3d 2074 7265 652e 7061 7265 6e74  ] == tree.parent
+00008cb0: 2875 2960 600a 2020 2020 2020 2020 666f  (u)``.        fo
+00008cc0: 7220 616c 6c20 6060 3020 3c3d 2075 203c  r all ``0 <= u <
+00008cd0: 3d20 7473 2e6e 756d 5f6e 6f64 6573 6060  = ts.num_nodes``
+00008ce0: 2e20 5365 6520 7468 6520 3a6d 6574 683a  . See the :meth:
+00008cf0: 607e 2e70 6172 656e 7460 0a20 2020 2020  `~.parent`.     
+00008d00: 2020 206d 6574 686f 6420 666f 7220 6465     method for de
+00008d10: 7461 696c 7320 6f6e 2074 6865 2073 656d  tails on the sem
+00008d20: 616e 7469 6373 206f 6620 7472 6565 2070  antics of tree p
+00008d30: 6172 656e 7473 2061 6e64 2074 6865 0a20  arents and the. 
+00008d40: 2020 2020 2020 203a 7265 663a 6073 6563         :ref:`sec
+00008d50: 5f64 6174 615f 6d6f 6465 6c5f 7472 6565  _data_model_tree
+00008d60: 5f73 7472 7563 7475 7265 6020 7365 6374  _structure` sect
+00008d70: 696f 6e20 666f 7220 696e 666f 726d 6174  ion for informat
+00008d80: 696f 6e20 6f6e 2074 6865 0a20 2020 2020  ion on the.     
+00008d90: 2020 2071 7569 6e74 7570 6c79 206c 696e     quintuply lin
+00008da0: 6b65 6420 7472 6565 2065 6e63 6f64 696e  ked tree encodin
+00008db0: 672e 0a0a 2020 2020 2020 2020 2e2e 2069  g...        .. i
+00008dc0: 6e63 6c75 6465 3a3a 2073 7562 7374 6974  nclude:: substit
+00008dd0: 7574 696f 6e73 2f76 6972 7475 616c 5f72  utions/virtual_r
+00008de0: 6f6f 745f 6172 7261 795f 6e6f 7465 2e72  oot_array_note.r
+00008df0: 7374 0a0a 2020 2020 2020 2020 2e2e 2069  st..        .. i
+00008e00: 6e63 6c75 6465 3a3a 2073 7562 7374 6974  nclude:: substit
+00008e10: 7574 696f 6e73 2f74 7265 655f 6172 7261  utions/tree_arra
+00008e20: 795f 7761 726e 696e 672e 7273 740a 2020  y_warning.rst.  
+00008e30: 2020 2020 2020 2222 220a 2020 2020 2020        """.      
+00008e40: 2020 7265 7475 726e 2073 656c 662e 5f70    return self._p
+00008e50: 6172 656e 745f 6172 7261 790a 0a20 2020  arent_array..   
+00008e60: 2023 2051 7569 6e74 7570 6c79 206c 696e   # Quintuply lin
+00008e70: 6b65 6420 7472 6565 2073 7472 7563 7475  ked tree structu
+00008e80: 7265 2e0a 0a20 2020 2064 6566 206c 6566  re...    def lef
+00008e90: 745f 6368 696c 6428 7365 6c66 2c20 7529  t_child(self, u)
+00008ea0: 3a0a 2020 2020 2020 2020 2222 220a 2020  :.        """.  
+00008eb0: 2020 2020 2020 5265 7475 726e 7320 7468        Returns th
+00008ec0: 6520 6c65 6674 6d6f 7374 2063 6869 6c64  e leftmost child
+00008ed0: 206f 6620 7468 6520 7370 6563 6966 6965   of the specifie
+00008ee0: 6420 6e6f 6465 2e20 5265 7475 726e 730a  d node. Returns.
+00008ef0: 2020 2020 2020 2020 3a64 6174 613a 6074          :data:`t
+00008f00: 736b 6974 2e4e 554c 4c60 2069 6620 7520  skit.NULL` if u 
+00008f10: 6973 2061 206c 6561 6620 6f72 2069 7320  is a leaf or is 
+00008f20: 6e6f 7420 6120 6e6f 6465 2069 6e0a 2020  not a node in.  
+00008f30: 2020 2020 2020 7468 6520 6375 7272 656e        the curren
+00008f40: 7420 7472 6565 2e20 5468 6520 6c65 6674  t tree. The left
+00008f50: 2d74 6f2d 7269 6768 7420 6f72 6465 7269  -to-right orderi
+00008f60: 6e67 206f 6620 6368 696c 6472 656e 0a20  ng of children. 
+00008f70: 2020 2020 2020 2069 7320 6172 6269 7472         is arbitr
+00008f80: 6172 7920 616e 6420 7368 6f75 6c64 206e  ary and should n
+00008f90: 6f74 2062 6520 6465 7065 6e64 6564 206f  ot be depended o
+00008fa0: 6e3b 2073 6565 2074 6865 0a20 2020 2020  n; see the.     
+00008fb0: 2020 203a 7265 663a 6064 6174 6120 6d6f     :ref:`data mo
+00008fc0: 6465 6c20 3c73 6563 5f64 6174 615f 6d6f  del <sec_data_mo
+00008fd0: 6465 6c5f 7472 6565 5f73 7472 7563 7475  del_tree_structu
+00008fe0: 7265 3e60 2073 6563 7469 6f6e 0a20 2020  re>` section.   
+00008ff0: 2020 2020 2066 6f72 2064 6574 6169 6c73       for details
+00009000: 2e0a 0a20 2020 2020 2020 2054 6869 7320  ...        This 
+00009010: 6973 2061 206c 6f77 2d6c 6576 656c 206d  is a low-level m
+00009020: 6574 686f 6420 6769 7669 6e67 2061 6363  ethod giving acc
+00009030: 6573 7320 746f 2074 6865 2071 7569 6e74  ess to the quint
+00009040: 7570 6c79 206c 696e 6b65 640a 2020 2020  uply linked.    
+00009050: 2020 2020 7472 6565 2073 7472 7563 7475      tree structu
+00009060: 7265 2069 6e20 6d65 6d6f 7279 3b20 7468  re in memory; th
+00009070: 6520 3a6d 6574 683a 602e 6368 696c 6472  e :meth:`.childr
+00009080: 656e 6020 6d65 7468 6f64 2069 7320 6120  en` method is a 
+00009090: 6d6f 7265 0a20 2020 2020 2020 2063 6f6e  more.        con
+000090a0: 7665 6e69 656e 7420 7761 7920 746f 206f  venient way to o
+000090b0: 6274 6169 6e20 7468 6520 6368 696c 6472  btain the childr
+000090c0: 656e 206f 6620 6120 6769 7665 6e20 6e6f  en of a given no
+000090d0: 6465 2e0a 0a20 2020 2020 2020 203a 7061  de...        :pa
+000090e0: 7261 6d20 696e 7420 753a 2054 6865 206e  ram int u: The n
+000090f0: 6f64 6520 6f66 2069 6e74 6572 6573 742e  ode of interest.
+00009100: 0a20 2020 2020 2020 203a 7265 7475 726e  .        :return
+00009110: 3a20 5468 6520 6c65 6674 6d6f 7374 2063  : The leftmost c
+00009120: 6869 6c64 206f 6620 752e 0a20 2020 2020  hild of u..     
+00009130: 2020 203a 7274 7970 653a 2069 6e74 0a20     :rtype: int. 
+00009140: 2020 2020 2020 2022 2222 0a20 2020 2020         """.     
+00009150: 2020 2072 6574 7572 6e20 7365 6c66 2e5f     return self._
+00009160: 6c6c 5f74 7265 652e 6765 745f 6c65 6674  ll_tree.get_left
+00009170: 5f63 6869 6c64 2875 290a 0a20 2020 2040  _child(u)..    @
+00009180: 7072 6f70 6572 7479 0a20 2020 2064 6566  property.    def
+00009190: 206c 6566 745f 6368 696c 645f 6172 7261   left_child_arra
+000091a0: 7928 7365 6c66 293a 0a20 2020 2020 2020  y(self):.       
+000091b0: 2022 2222 0a20 2020 2020 2020 2041 206e   """.        A n
+000091c0: 756d 7079 2061 7272 6179 2028 6474 7970  umpy array (dtyp
+000091d0: 653d 6e70 2e69 6e74 3332 2920 656e 636f  e=np.int32) enco
+000091e0: 6469 6e67 2074 6865 206c 6566 7420 6368  ding the left ch
+000091f0: 696c 6420 6f66 2065 6163 6820 6e6f 6465  ild of each node
+00009200: 0a20 2020 2020 2020 2069 6e20 7468 6973  .        in this
+00009210: 2074 7265 652c 2073 7563 6820 7468 6174   tree, such that
+00009220: 2060 6074 7265 652e 6c65 6674 5f63 6869   ``tree.left_chi
+00009230: 6c64 5f61 7272 6179 5b75 5d20 3d3d 2074  ld_array[u] == t
+00009240: 7265 652e 6c65 6674 5f63 6869 6c64 2875  ree.left_child(u
+00009250: 2960 600a 2020 2020 2020 2020 666f 7220  )``.        for 
+00009260: 616c 6c20 6060 3020 3c3d 2075 203c 3d20  all ``0 <= u <= 
+00009270: 7473 2e6e 756d 5f6e 6f64 6573 6060 2e20  ts.num_nodes``. 
+00009280: 5365 6520 7468 6520 3a6d 6574 683a 607e  See the :meth:`~
+00009290: 2e6c 6566 745f 6368 696c 6460 0a20 2020  .left_child`.   
+000092a0: 2020 2020 206d 6574 686f 6420 666f 7220       method for 
+000092b0: 6465 7461 696c 7320 6f6e 2074 6865 2073  details on the s
+000092c0: 656d 616e 7469 6373 206f 6620 7472 6565  emantics of tree
+000092d0: 206c 6566 745f 6368 696c 6420 616e 6420   left_child and 
+000092e0: 7468 650a 2020 2020 2020 2020 3a72 6566  the.        :ref
+000092f0: 3a60 7365 635f 6461 7461 5f6d 6f64 656c  :`sec_data_model
+00009300: 5f74 7265 655f 7374 7275 6374 7572 6560  _tree_structure`
+00009310: 2073 6563 7469 6f6e 2066 6f72 2069 6e66   section for inf
+00009320: 6f72 6d61 7469 6f6e 206f 6e20 7468 650a  ormation on the.
+00009330: 2020 2020 2020 2020 7175 696e 7475 706c          quintupl
+00009340: 7920 6c69 6e6b 6564 2074 7265 6520 656e  y linked tree en
+00009350: 636f 6469 6e67 2e0a 0a20 2020 2020 2020  coding...       
+00009360: 202e 2e20 696e 636c 7564 653a 3a20 7375   .. include:: su
+00009370: 6273 7469 7475 7469 6f6e 732f 7669 7274  bstitutions/virt
+00009380: 7561 6c5f 726f 6f74 5f61 7272 6179 5f6e  ual_root_array_n
+00009390: 6f74 652e 7273 740a 0a20 2020 2020 2020  ote.rst..       
+000093a0: 202e 2e20 696e 636c 7564 653a 3a20 7375   .. include:: su
+000093b0: 6273 7469 7475 7469 6f6e 732f 7472 6565  bstitutions/tree
+000093c0: 5f61 7272 6179 5f77 6172 6e69 6e67 2e72  _array_warning.r
+000093d0: 7374 0a20 2020 2020 2020 2022 2222 0a20  st.        """. 
+000093e0: 2020 2020 2020 2072 6574 7572 6e20 7365         return se
+000093f0: 6c66 2e5f 6c65 6674 5f63 6869 6c64 5f61  lf._left_child_a
+00009400: 7272 6179 0a0a 2020 2020 6465 6620 7269  rray..    def ri
+00009410: 6768 745f 6368 696c 6428 7365 6c66 2c20  ght_child(self, 
+00009420: 7529 3a0a 2020 2020 2020 2020 2222 220a  u):.        """.
+00009430: 2020 2020 2020 2020 5265 7475 726e 7320          Returns 
+00009440: 7468 6520 7269 6768 746d 6f73 7420 6368  the rightmost ch
+00009450: 696c 6420 6f66 2074 6865 2073 7065 6369  ild of the speci
+00009460: 6669 6564 206e 6f64 652e 2052 6574 7572  fied node. Retur
+00009470: 6e73 0a20 2020 2020 2020 203a 6461 7461  ns.        :data
+00009480: 3a60 7473 6b69 742e 4e55 4c4c 6020 6966  :`tskit.NULL` if
+00009490: 2075 2069 7320 6120 6c65 6166 206f 7220   u is a leaf or 
+000094a0: 6973 206e 6f74 2061 206e 6f64 6520 696e  is not a node in
+000094b0: 0a20 2020 2020 2020 2074 6865 2063 7572  .        the cur
+000094c0: 7265 6e74 2074 7265 652e 2054 6865 206c  rent tree. The l
+000094d0: 6566 742d 746f 2d72 6967 6874 206f 7264  eft-to-right ord
+000094e0: 6572 696e 6720 6f66 2063 6869 6c64 7265  ering of childre
+000094f0: 6e0a 2020 2020 2020 2020 6973 2061 7262  n.        is arb
+00009500: 6974 7261 7279 2061 6e64 2073 686f 756c  itrary and shoul
+00009510: 6420 6e6f 7420 6265 2064 6570 656e 6465  d not be depende
+00009520: 6420 6f6e 3b20 7365 6520 7468 650a 2020  d on; see the.  
+00009530: 2020 2020 2020 3a72 6566 3a60 6461 7461        :ref:`data
+00009540: 206d 6f64 656c 203c 7365 635f 6461 7461   model <sec_data
+00009550: 5f6d 6f64 656c 5f74 7265 655f 7374 7275  _model_tree_stru
+00009560: 6374 7572 653e 6020 7365 6374 696f 6e0a  cture>` section.
+00009570: 2020 2020 2020 2020 666f 7220 6465 7461          for deta
+00009580: 696c 732e 0a0a 2020 2020 2020 2020 5468  ils...        Th
+00009590: 6973 2069 7320 6120 6c6f 772d 6c65 7665  is is a low-leve
+000095a0: 6c20 6d65 7468 6f64 2067 6976 696e 6720  l method giving 
+000095b0: 6163 6365 7373 2074 6f20 7468 6520 7175  access to the qu
+000095c0: 696e 7475 706c 7920 6c69 6e6b 6564 0a20  intuply linked. 
+000095d0: 2020 2020 2020 2074 7265 6520 7374 7275         tree stru
+000095e0: 6374 7572 6520 696e 206d 656d 6f72 793b  cture in memory;
+000095f0: 2074 6865 203a 6d65 7468 3a60 2e63 6869   the :meth:`.chi
+00009600: 6c64 7265 6e60 206d 6574 686f 6420 6973  ldren` method is
+00009610: 2061 206d 6f72 650a 2020 2020 2020 2020   a more.        
+00009620: 636f 6e76 656e 6965 6e74 2077 6179 2074  convenient way t
+00009630: 6f20 6f62 7461 696e 2074 6865 2063 6869  o obtain the chi
+00009640: 6c64 7265 6e20 6f66 2061 2067 6976 656e  ldren of a given
+00009650: 206e 6f64 652e 0a0a 2020 2020 2020 2020   node...        
+00009660: 3a70 6172 616d 2069 6e74 2075 3a20 5468  :param int u: Th
+00009670: 6520 6e6f 6465 206f 6620 696e 7465 7265  e node of intere
+00009680: 7374 2e0a 2020 2020 2020 2020 3a72 6574  st..        :ret
+00009690: 7572 6e3a 2054 6865 2072 6967 6874 6d6f  urn: The rightmo
+000096a0: 7374 2063 6869 6c64 206f 6620 752e 0a20  st child of u.. 
+000096b0: 2020 2020 2020 203a 7274 7970 653a 2069         :rtype: i
+000096c0: 6e74 0a20 2020 2020 2020 2022 2222 0a20  nt.        """. 
+000096d0: 2020 2020 2020 2072 6574 7572 6e20 7365         return se
+000096e0: 6c66 2e5f 6c6c 5f74 7265 652e 6765 745f  lf._ll_tree.get_
+000096f0: 7269 6768 745f 6368 696c 6428 7529 0a0a  right_child(u)..
+00009700: 2020 2020 4070 726f 7065 7274 790a 2020      @property.  
+00009710: 2020 6465 6620 7269 6768 745f 6368 696c    def right_chil
+00009720: 645f 6172 7261 7928 7365 6c66 293a 0a20  d_array(self):. 
+00009730: 2020 2020 2020 2022 2222 0a20 2020 2020         """.     
+00009740: 2020 2041 206e 756d 7079 2061 7272 6179     A numpy array
+00009750: 2028 6474 7970 653d 6e70 2e69 6e74 3332   (dtype=np.int32
+00009760: 2920 656e 636f 6469 6e67 2074 6865 2072  ) encoding the r
+00009770: 6967 6874 2063 6869 6c64 206f 6620 6561  ight child of ea
+00009780: 6368 206e 6f64 650a 2020 2020 2020 2020  ch node.        
+00009790: 696e 2074 6869 7320 7472 6565 2c20 7375  in this tree, su
+000097a0: 6368 2074 6861 7420 6060 7472 6565 2e72  ch that ``tree.r
+000097b0: 6967 6874 5f63 6869 6c64 5f61 7272 6179  ight_child_array
+000097c0: 5b75 5d20 3d3d 2074 7265 652e 7269 6768  [u] == tree.righ
+000097d0: 745f 6368 696c 6428 7529 6060 0a20 2020  t_child(u)``.   
+000097e0: 2020 2020 2066 6f72 2061 6c6c 2060 6030       for all ``0
+000097f0: 203c 3d20 7520 3c3d 2074 732e 6e75 6d5f   <= u <= ts.num_
+00009800: 6e6f 6465 7360 602e 2053 6565 2074 6865  nodes``. See the
+00009810: 203a 6d65 7468 3a60 7e2e 7269 6768 745f   :meth:`~.right_
+00009820: 6368 696c 6460 0a20 2020 2020 2020 206d  child`.        m
+00009830: 6574 686f 6420 666f 7220 6465 7461 696c  ethod for detail
+00009840: 7320 6f6e 2074 6865 2073 656d 616e 7469  s on the semanti
+00009850: 6373 206f 6620 7472 6565 2072 6967 6874  cs of tree right
+00009860: 5f63 6869 6c64 2061 6e64 2074 6865 0a20  _child and the. 
+00009870: 2020 2020 2020 203a 7265 663a 6073 6563         :ref:`sec
+00009880: 5f64 6174 615f 6d6f 6465 6c5f 7472 6565  _data_model_tree
+00009890: 5f73 7472 7563 7475 7265 6020 7365 6374  _structure` sect
+000098a0: 696f 6e20 666f 7220 696e 666f 726d 6174  ion for informat
+000098b0: 696f 6e20 6f6e 2074 6865 0a20 2020 2020  ion on the.     
+000098c0: 2020 2071 7569 6e74 7570 6c79 206c 696e     quintuply lin
+000098d0: 6b65 6420 7472 6565 2065 6e63 6f64 696e  ked tree encodin
+000098e0: 672e 0a0a 2020 2020 2020 2020 2e2e 2069  g...        .. i
+000098f0: 6e63 6c75 6465 3a3a 2073 7562 7374 6974  nclude:: substit
+00009900: 7574 696f 6e73 2f76 6972 7475 616c 5f72  utions/virtual_r
+00009910: 6f6f 745f 6172 7261 795f 6e6f 7465 2e72  oot_array_note.r
+00009920: 7374 0a0a 2020 2020 2020 2020 2e2e 2069  st..        .. i
+00009930: 6e63 6c75 6465 3a3a 2073 7562 7374 6974  nclude:: substit
+00009940: 7574 696f 6e73 2f74 7265 655f 6172 7261  utions/tree_arra
+00009950: 795f 7761 726e 696e 672e 7273 740a 2020  y_warning.rst.  
+00009960: 2020 2020 2020 2222 220a 2020 2020 2020        """.      
+00009970: 2020 7265 7475 726e 2073 656c 662e 5f72    return self._r
+00009980: 6967 6874 5f63 6869 6c64 5f61 7272 6179  ight_child_array
+00009990: 0a0a 2020 2020 6465 6620 6c65 6674 5f73  ..    def left_s
+000099a0: 6962 2873 656c 662c 2075 293a 0a20 2020  ib(self, u):.   
+000099b0: 2020 2020 2022 2222 0a20 2020 2020 2020       """.       
+000099c0: 2052 6574 7572 6e73 2074 6865 2073 6962   Returns the sib
+000099d0: 6c69 6e67 206e 6f64 6520 746f 2074 6865  ling node to the
+000099e0: 206c 6566 7420 6f66 2075 2c20 6f72 203a   left of u, or :
+000099f0: 6461 7461 3a60 7473 6b69 742e 4e55 4c4c  data:`tskit.NULL
+00009a00: 600a 2020 2020 2020 2020 6966 2075 2064  `.        if u d
+00009a10: 6f65 7320 6e6f 7420 6861 7665 2061 206c  oes not have a l
+00009a20: 6566 7420 7369 626c 696e 672e 0a20 2020  eft sibling..   
+00009a30: 2020 2020 2054 6865 206c 6566 742d 746f       The left-to
+00009a40: 2d72 6967 6874 206f 7264 6572 696e 6720  -right ordering 
+00009a50: 6f66 2063 6869 6c64 7265 6e0a 2020 2020  of children.    
+00009a60: 2020 2020 6973 2061 7262 6974 7261 7279      is arbitrary
+00009a70: 2061 6e64 2073 686f 756c 6420 6e6f 7420   and should not 
+00009a80: 6265 2064 6570 656e 6465 6420 6f6e 3b20  be depended on; 
+00009a90: 7365 6520 7468 650a 2020 2020 2020 2020  see the.        
+00009aa0: 3a72 6566 3a60 6461 7461 206d 6f64 656c  :ref:`data model
+00009ab0: 203c 7365 635f 6461 7461 5f6d 6f64 656c   <sec_data_model
+00009ac0: 5f74 7265 655f 7374 7275 6374 7572 653e  _tree_structure>
+00009ad0: 6020 7365 6374 696f 6e0a 2020 2020 2020  ` section.      
+00009ae0: 2020 666f 7220 6465 7461 696c 732e 0a0a    for details...
+00009af0: 2020 2020 2020 2020 3a70 6172 616d 2069          :param i
+00009b00: 6e74 2075 3a20 5468 6520 6e6f 6465 206f  nt u: The node o
+00009b10: 6620 696e 7465 7265 7374 2e0a 2020 2020  f interest..    
+00009b20: 2020 2020 3a72 6574 7572 6e3a 2054 6865      :return: The
+00009b30: 2073 6962 6c69 6e67 206e 6f64 6520 746f   sibling node to
+00009b40: 2074 6865 206c 6566 7420 6f66 2075 2e0a   the left of u..
+00009b50: 2020 2020 2020 2020 3a72 7479 7065 3a20          :rtype: 
+00009b60: 696e 740a 2020 2020 2020 2020 2222 220a  int.        """.
+00009b70: 2020 2020 2020 2020 7265 7475 726e 2073          return s
+00009b80: 656c 662e 5f6c 6c5f 7472 6565 2e67 6574  elf._ll_tree.get
+00009b90: 5f6c 6566 745f 7369 6228 7529 0a0a 2020  _left_sib(u)..  
+00009ba0: 2020 4070 726f 7065 7274 790a 2020 2020    @property.    
+00009bb0: 6465 6620 6c65 6674 5f73 6962 5f61 7272  def left_sib_arr
+00009bc0: 6179 2873 656c 6629 3a0a 2020 2020 2020  ay(self):.      
+00009bd0: 2020 2222 220a 2020 2020 2020 2020 4120    """.        A 
+00009be0: 6e75 6d70 7920 6172 7261 7920 2864 7479  numpy array (dty
+00009bf0: 7065 3d6e 702e 696e 7433 3229 2065 6e63  pe=np.int32) enc
+00009c00: 6f64 696e 6720 7468 6520 6c65 6674 2073  oding the left s
+00009c10: 6962 206f 6620 6561 6368 206e 6f64 650a  ib of each node.
+00009c20: 2020 2020 2020 2020 696e 2074 6869 7320          in this 
+00009c30: 7472 6565 2c20 7375 6368 2074 6861 7420  tree, such that 
+00009c40: 6060 7472 6565 2e6c 6566 745f 7369 625f  ``tree.left_sib_
+00009c50: 6172 7261 795b 755d 203d 3d20 7472 6565  array[u] == tree
+00009c60: 2e6c 6566 745f 7369 6228 7529 6060 0a20  .left_sib(u)``. 
+00009c70: 2020 2020 2020 2066 6f72 2061 6c6c 2060         for all `
+00009c80: 6030 203c 3d20 7520 3c3d 2074 732e 6e75  `0 <= u <= ts.nu
+00009c90: 6d5f 6e6f 6465 7360 602e 2053 6565 2074  m_nodes``. See t
+00009ca0: 6865 203a 6d65 7468 3a60 7e2e 6c65 6674  he :meth:`~.left
+00009cb0: 5f73 6962 600a 2020 2020 2020 2020 6d65  _sib`.        me
+00009cc0: 7468 6f64 2066 6f72 2064 6574 6169 6c73  thod for details
+00009cd0: 206f 6e20 7468 6520 7365 6d61 6e74 6963   on the semantic
+00009ce0: 7320 6f66 2074 7265 6520 6c65 6674 5f73  s of tree left_s
+00009cf0: 6962 2061 6e64 2074 6865 0a20 2020 2020  ib and the.     
+00009d00: 2020 203a 7265 663a 6073 6563 5f64 6174     :ref:`sec_dat
+00009d10: 615f 6d6f 6465 6c5f 7472 6565 5f73 7472  a_model_tree_str
+00009d20: 7563 7475 7265 6020 7365 6374 696f 6e20  ucture` section 
+00009d30: 666f 7220 696e 666f 726d 6174 696f 6e20  for information 
+00009d40: 6f6e 2074 6865 0a20 2020 2020 2020 2071  on the.        q
+00009d50: 7569 6e74 7570 6c79 206c 696e 6b65 6420  uintuply linked 
+00009d60: 7472 6565 2065 6e63 6f64 696e 672e 0a0a  tree encoding...
+00009d70: 2020 2020 2020 2020 2e2e 2069 6e63 6c75          .. inclu
+00009d80: 6465 3a3a 2073 7562 7374 6974 7574 696f  de:: substitutio
+00009d90: 6e73 2f76 6972 7475 616c 5f72 6f6f 745f  ns/virtual_root_
+00009da0: 6172 7261 795f 6e6f 7465 2e72 7374 0a0a  array_note.rst..
+00009db0: 2020 2020 2020 2020 2e2e 2069 6e63 6c75          .. inclu
+00009dc0: 6465 3a3a 2073 7562 7374 6974 7574 696f  de:: substitutio
+00009dd0: 6e73 2f74 7265 655f 6172 7261 795f 7761  ns/tree_array_wa
+00009de0: 726e 696e 672e 7273 740a 2020 2020 2020  rning.rst.      
+00009df0: 2020 2222 220a 2020 2020 2020 2020 7265    """.        re
+00009e00: 7475 726e 2073 656c 662e 5f6c 6566 745f  turn self._left_
+00009e10: 7369 625f 6172 7261 790a 0a20 2020 2064  sib_array..    d
+00009e20: 6566 2072 6967 6874 5f73 6962 2873 656c  ef right_sib(sel
+00009e30: 662c 2075 293a 0a20 2020 2020 2020 2022  f, u):.        "
+00009e40: 2222 0a20 2020 2020 2020 2052 6574 7572  "".        Retur
+00009e50: 6e73 2074 6865 2073 6962 6c69 6e67 206e  ns the sibling n
+00009e60: 6f64 6520 746f 2074 6865 2072 6967 6874  ode to the right
+00009e70: 206f 6620 752c 206f 7220 3a64 6174 613a   of u, or :data:
+00009e80: 6074 736b 6974 2e4e 554c 4c60 0a20 2020  `tskit.NULL`.   
+00009e90: 2020 2020 2069 6620 7520 646f 6573 206e       if u does n
+00009ea0: 6f74 2068 6176 6520 6120 7269 6768 7420  ot have a right 
+00009eb0: 7369 626c 696e 672e 0a20 2020 2020 2020  sibling..       
+00009ec0: 2054 6865 206c 6566 742d 746f 2d72 6967   The left-to-rig
+00009ed0: 6874 206f 7264 6572 696e 6720 6f66 2063  ht ordering of c
+00009ee0: 6869 6c64 7265 6e0a 2020 2020 2020 2020  hildren.        
+00009ef0: 6973 2061 7262 6974 7261 7279 2061 6e64  is arbitrary and
+00009f00: 2073 686f 756c 6420 6e6f 7420 6265 2064   should not be d
+00009f10: 6570 656e 6465 6420 6f6e 3b20 7365 6520  epended on; see 
+00009f20: 7468 650a 2020 2020 2020 2020 3a72 6566  the.        :ref
+00009f30: 3a60 6461 7461 206d 6f64 656c 203c 7365  :`data model <se
+00009f40: 635f 6461 7461 5f6d 6f64 656c 5f74 7265  c_data_model_tre
+00009f50: 655f 7374 7275 6374 7572 653e 6020 7365  e_structure>` se
+00009f60: 6374 696f 6e0a 2020 2020 2020 2020 666f  ction.        fo
+00009f70: 7220 6465 7461 696c 732e 0a0a 2020 2020  r details...    
+00009f80: 2020 2020 3a70 6172 616d 2069 6e74 2075      :param int u
+00009f90: 3a20 5468 6520 6e6f 6465 206f 6620 696e  : The node of in
+00009fa0: 7465 7265 7374 2e0a 2020 2020 2020 2020  terest..        
+00009fb0: 3a72 6574 7572 6e3a 2054 6865 2073 6962  :return: The sib
+00009fc0: 6c69 6e67 206e 6f64 6520 746f 2074 6865  ling node to the
+00009fd0: 2072 6967 6874 206f 6620 752e 0a20 2020   right of u..   
+00009fe0: 2020 2020 203a 7274 7970 653a 2069 6e74       :rtype: int
+00009ff0: 0a20 2020 2020 2020 2022 2222 0a20 2020  .        """.   
+0000a000: 2020 2020 2072 6574 7572 6e20 7365 6c66       return self
+0000a010: 2e5f 6c6c 5f74 7265 652e 6765 745f 7269  ._ll_tree.get_ri
+0000a020: 6768 745f 7369 6228 7529 0a0a 2020 2020  ght_sib(u)..    
+0000a030: 4070 726f 7065 7274 790a 2020 2020 6465  @property.    de
+0000a040: 6620 7269 6768 745f 7369 625f 6172 7261  f right_sib_arra
+0000a050: 7928 7365 6c66 293a 0a20 2020 2020 2020  y(self):.       
+0000a060: 2022 2222 0a20 2020 2020 2020 2041 206e   """.        A n
+0000a070: 756d 7079 2061 7272 6179 2028 6474 7970  umpy array (dtyp
+0000a080: 653d 6e70 2e69 6e74 3332 2920 656e 636f  e=np.int32) enco
+0000a090: 6469 6e67 2074 6865 2072 6967 6874 2073  ding the right s
+0000a0a0: 6962 206f 6620 6561 6368 206e 6f64 650a  ib of each node.
+0000a0b0: 2020 2020 2020 2020 696e 2074 6869 7320          in this 
+0000a0c0: 7472 6565 2c20 7375 6368 2074 6861 7420  tree, such that 
+0000a0d0: 6060 7472 6565 2e72 6967 6874 5f73 6962  ``tree.right_sib
+0000a0e0: 5f61 7272 6179 5b75 5d20 3d3d 2074 7265  _array[u] == tre
+0000a0f0: 652e 7269 6768 745f 7369 6228 7529 6060  e.right_sib(u)``
+0000a100: 0a20 2020 2020 2020 2066 6f72 2061 6c6c  .        for all
+0000a110: 2060 6030 203c 3d20 7520 3c3d 2074 732e   ``0 <= u <= ts.
+0000a120: 6e75 6d5f 6e6f 6465 7360 602e 2053 6565  num_nodes``. See
+0000a130: 2074 6865 203a 6d65 7468 3a60 7e2e 7269   the :meth:`~.ri
+0000a140: 6768 745f 7369 6260 0a20 2020 2020 2020  ght_sib`.       
+0000a150: 206d 6574 686f 6420 666f 7220 6465 7461   method for deta
+0000a160: 696c 7320 6f6e 2074 6865 2073 656d 616e  ils on the seman
+0000a170: 7469 6373 206f 6620 7472 6565 2072 6967  tics of tree rig
+0000a180: 6874 5f73 6962 2061 6e64 2074 6865 0a20  ht_sib and the. 
+0000a190: 2020 2020 2020 203a 7265 663a 6073 6563         :ref:`sec
+0000a1a0: 5f64 6174 615f 6d6f 6465 6c5f 7472 6565  _data_model_tree
+0000a1b0: 5f73 7472 7563 7475 7265 6020 7365 6374  _structure` sect
+0000a1c0: 696f 6e20 666f 7220 696e 666f 726d 6174  ion for informat
+0000a1d0: 696f 6e20 6f6e 2074 6865 0a20 2020 2020  ion on the.     
+0000a1e0: 2020 2071 7569 6e74 7570 6c79 206c 696e     quintuply lin
+0000a1f0: 6b65 6420 7472 6565 2065 6e63 6f64 696e  ked tree encodin
+0000a200: 672e 0a0a 2020 2020 2020 2020 2e2e 2069  g...        .. i
+0000a210: 6e63 6c75 6465 3a3a 2073 7562 7374 6974  nclude:: substit
+0000a220: 7574 696f 6e73 2f76 6972 7475 616c 5f72  utions/virtual_r
+0000a230: 6f6f 745f 6172 7261 795f 6e6f 7465 2e72  oot_array_note.r
+0000a240: 7374 0a0a 2020 2020 2020 2020 2e2e 2069  st..        .. i
+0000a250: 6e63 6c75 6465 3a3a 2073 7562 7374 6974  nclude:: substit
+0000a260: 7574 696f 6e73 2f74 7265 655f 6172 7261  utions/tree_arra
+0000a270: 795f 7761 726e 696e 672e 7273 740a 2020  y_warning.rst.  
+0000a280: 2020 2020 2020 2222 220a 2020 2020 2020        """.      
+0000a290: 2020 7265 7475 726e 2073 656c 662e 5f72    return self._r
+0000a2a0: 6967 6874 5f73 6962 5f61 7272 6179 0a0a  ight_sib_array..
+0000a2b0: 2020 2020 6465 6620 7369 626c 696e 6773      def siblings
+0000a2c0: 2873 656c 662c 2075 293a 0a20 2020 2020  (self, u):.     
+0000a2d0: 2020 2022 2222 0a20 2020 2020 2020 2052     """.        R
+0000a2e0: 6574 7572 6e73 2074 6865 2073 6962 6c69  eturns the sibli
+0000a2f0: 6e67 2873 2920 6f66 2074 6865 2073 7065  ng(s) of the spe
+0000a300: 6369 6669 6564 206e 6f64 6520 6060 7560  cified node ``u`
+0000a310: 6020 6173 2061 2074 7570 6c65 206f 6620  ` as a tuple of 
+0000a320: 696e 7465 6765 720a 2020 2020 2020 2020  integer.        
+0000a330: 6e6f 6465 2049 4473 2e20 4966 2060 6075  node IDs. If ``u
+0000a340: 6060 2068 6173 206e 6f20 7369 626c 696e  `` has no siblin
+0000a350: 6773 206f 7220 6973 206e 6f74 2061 206e  gs or is not a n
+0000a360: 6f64 6520 696e 2074 6865 2063 7572 7265  ode in the curre
+0000a370: 6e74 2074 7265 652c 0a20 2020 2020 2020  nt tree,.       
+0000a380: 2072 6574 7572 6e73 2061 6e20 656d 7074   returns an empt
+0000a390: 7920 7475 706c 652e 2049 6620 6060 7560  y tuple. If ``u`
+0000a3a0: 6020 6973 2074 6865 2072 6f6f 7420 6f66  ` is the root of
+0000a3b0: 2061 2073 696e 676c 652d 726f 6f74 2074   a single-root t
+0000a3c0: 7265 652c 0a20 2020 2020 2020 2072 6574  ree,.        ret
+0000a3d0: 7572 6e73 2061 6e20 656d 7074 7920 7475  urns an empty tu
+0000a3e0: 706c 653b 2069 6620 6060 7560 6020 6973  ple; if ``u`` is
+0000a3f0: 2074 6865 2072 6f6f 7420 6f66 2061 206d   the root of a m
+0000a400: 756c 7469 2d72 6f6f 7420 7472 6565 2c0a  ulti-root tree,.
+0000a410: 2020 2020 2020 2020 7265 7475 726e 7320          returns 
+0000a420: 7468 6520 6f74 6865 7220 726f 6f74 7320  the other roots 
+0000a430: 286e 6f74 6520 616c 6c20 7468 6520 726f  (note all the ro
+0000a440: 6f74 7320 6172 6520 7265 6c61 7465 6420  ots are related 
+0000a450: 6279 2074 6865 2076 6972 7475 616c 2072  by the virtual r
+0000a460: 6f6f 7429 2e0a 2020 2020 2020 2020 4966  oot)..        If
+0000a470: 2060 6075 6060 2069 7320 7468 6520 7669   ``u`` is the vi
+0000a480: 7274 7561 6c20 726f 6f74 2028 7768 6963  rtual root (whic
+0000a490: 6820 6861 7320 6e6f 2073 6962 6c69 6e67  h has no sibling
+0000a4a0: 7329 2c20 7265 7475 726e 7320 616e 2065  s), returns an e
+0000a4b0: 6d70 7479 2074 7570 6c65 2e0a 2020 2020  mpty tuple..    
+0000a4c0: 2020 2020 4966 2060 6075 6060 2069 7320      If ``u`` is 
+0000a4d0: 616e 2069 736f 6c61 7465 6420 6e6f 6465  an isolated node
+0000a4e0: 2c20 7768 6574 6865 7220 6974 2068 6173  , whether it has
+0000a4f0: 2073 6962 6c69 6e67 7320 6f72 206e 6f74   siblings or not
+0000a500: 2064 6570 656e 6473 206f 6e0a 2020 2020   depends on.    
+0000a510: 2020 2020 7768 6574 6865 7220 6974 2069      whether it i
+0000a520: 7320 6120 7361 6d70 6c65 206f 7220 6e6f  s a sample or no
+0000a530: 6e2d 7361 6d70 6c65 206e 6f64 653b 2069  n-sample node; i
+0000a540: 6620 6974 2069 7320 6120 7361 6d70 6c65  f it is a sample
+0000a550: 206e 6f64 652c 0a20 2020 2020 2020 2072   node,.        r
+0000a560: 6574 7572 6e73 2074 6865 2072 6f6f 7428  eturns the root(
+0000a570: 7329 206f 6620 7468 6520 7472 6565 2c20  s) of the tree, 
+0000a580: 6f74 6865 7277 6973 652c 2072 6574 7572  otherwise, retur
 0000a590: 6e73 2061 6e20 656d 7074 7920 7475 706c  ns an empty tupl
-0000a5a0: 652e 0a20 2020 2020 2020 2049 6620 6060  e..        If ``
-0000a5b0: 7560 6020 6973 2061 6e20 6973 6f6c 6174  u`` is an isolat
-0000a5c0: 6564 206e 6f64 652c 2077 6865 7468 6572  ed node, whether
-0000a5d0: 2069 7420 6861 7320 7369 626c 696e 6773   it has siblings
-0000a5e0: 206f 7220 6e6f 7420 6465 7065 6e64 7320   or not depends 
-0000a5f0: 6f6e 0a20 2020 2020 2020 2077 6865 7468  on.        wheth
-0000a600: 6572 2069 7420 6973 2061 2073 616d 706c  er it is a sampl
-0000a610: 6520 6f72 206e 6f6e 2d73 616d 706c 6520  e or non-sample 
-0000a620: 6e6f 6465 3b20 6966 2069 7420 6973 2061  node; if it is a
-0000a630: 2073 616d 706c 6520 6e6f 6465 2c0a 2020   sample node,.  
-0000a640: 2020 2020 2020 7265 7475 726e 7320 7468        returns th
-0000a650: 6520 726f 6f74 2873 2920 6f66 2074 6865  e root(s) of the
-0000a660: 2074 7265 652c 206f 7468 6572 7769 7365   tree, otherwise
-0000a670: 2c20 7265 7475 726e 7320 616e 2065 6d70  , returns an emp
-0000a680: 7479 2074 7570 6c65 2e0a 2020 2020 2020  ty tuple..      
-0000a690: 2020 5468 6520 6f72 6465 7269 6e67 206f    The ordering o
-0000a6a0: 6620 7369 626c 696e 6773 2020 6973 2061  f siblings  is a
-0000a6b0: 7262 6974 7261 7279 2061 6e64 2073 686f  rbitrary and sho
-0000a6c0: 756c 6420 6e6f 7420 6265 2064 6570 656e  uld not be depen
-0000a6d0: 6465 6420 6f6e 3b0a 2020 2020 2020 2020  ded on;.        
-0000a6e0: 7365 6520 7468 6520 3a72 6566 3a60 6461  see the :ref:`da
-0000a6f0: 7461 206d 6f64 656c 203c 7365 635f 6461  ta model <sec_da
-0000a700: 7461 5f6d 6f64 656c 5f74 7265 655f 7374  ta_model_tree_st
-0000a710: 7275 6374 7572 653e 6020 7365 6374 696f  ructure>` sectio
-0000a720: 6e20 666f 7220 6465 7461 696c 732e 0a0a  n for details...
-0000a730: 2020 2020 2020 2020 3a70 6172 616d 2069          :param i
-0000a740: 6e74 2075 3a20 5468 6520 6e6f 6465 206f  nt u: The node o
-0000a750: 6620 696e 7465 7265 7374 2e0a 2020 2020  f interest..    
-0000a760: 2020 2020 3a72 6574 7572 6e3a 2054 6865      :return: The
-0000a770: 2073 6962 6c69 6e67 7320 6f66 2060 6075   siblings of ``u
-0000a780: 6060 2e0a 2020 2020 2020 2020 3a72 7479  ``..        :rty
-0000a790: 7065 3a20 7475 706c 6528 696e 7429 0a20  pe: tuple(int). 
-0000a7a0: 2020 2020 2020 2022 2222 0a20 2020 2020         """.     
-0000a7b0: 2020 2069 6620 7520 3d3d 2073 656c 662e     if u == self.
-0000a7c0: 7669 7274 7561 6c5f 726f 6f74 3a0a 2020  virtual_root:.  
-0000a7d0: 2020 2020 2020 2020 2020 7265 7475 726e            return
-0000a7e0: 2074 7570 6c65 2829 0a20 2020 2020 2020   tuple().       
-0000a7f0: 2070 6172 656e 7420 3d20 7365 6c66 2e70   parent = self.p
-0000a800: 6172 656e 7428 7529 0a20 2020 2020 2020  arent(u).       
-0000a810: 2069 6620 7365 6c66 2e69 735f 726f 6f74   if self.is_root
-0000a820: 2875 293a 0a20 2020 2020 2020 2020 2020  (u):.           
-0000a830: 2070 6172 656e 7420 3d20 7365 6c66 2e76   parent = self.v
-0000a840: 6972 7475 616c 5f72 6f6f 740a 2020 2020  irtual_root.    
-0000a850: 2020 2020 6966 2070 6172 656e 7420 213d      if parent !=
-0000a860: 2074 736b 6974 2e4e 554c 4c3a 0a20 2020   tskit.NULL:.   
-0000a870: 2020 2020 2020 2020 2072 6574 7572 6e20           return 
-0000a880: 7475 706c 6528 7620 666f 7220 7620 696e  tuple(v for v in
-0000a890: 2073 656c 662e 6368 696c 6472 656e 2870   self.children(p
-0000a8a0: 6172 656e 7429 2069 6620 7520 213d 2076  arent) if u != v
-0000a8b0: 290a 2020 2020 2020 2020 7265 7475 726e  ).        return
-0000a8c0: 2074 7570 6c65 2829 0a0a 2020 2020 4070   tuple()..    @p
-0000a8d0: 726f 7065 7274 790a 2020 2020 6465 6620  roperty.    def 
-0000a8e0: 6e75 6d5f 6368 696c 6472 656e 5f61 7272  num_children_arr
-0000a8f0: 6179 2873 656c 6629 3a0a 2020 2020 2020  ay(self):.      
-0000a900: 2020 2222 220a 2020 2020 2020 2020 4120    """.        A 
-0000a910: 6e75 6d70 7920 6172 7261 7920 2864 7479  numpy array (dty
-0000a920: 7065 3d6e 702e 696e 7433 3229 2065 6e63  pe=np.int32) enc
-0000a930: 6f64 696e 6720 7468 6520 6e75 6d62 6572  oding the number
-0000a940: 206f 6620 6368 696c 6472 656e 206f 660a   of children of.
-0000a950: 2020 2020 2020 2020 6561 6368 206e 6f64          each nod
-0000a960: 6520 696e 2074 6869 7320 7472 6565 2c20  e in this tree, 
-0000a970: 7375 6368 2074 6861 740a 2020 2020 2020  such that.      
-0000a980: 2020 6060 7472 6565 2e6e 756d 5f63 6869    ``tree.num_chi
-0000a990: 6c64 7265 6e5f 6172 7261 795b 755d 203d  ldren_array[u] =
-0000a9a0: 3d20 7472 6565 2e6e 756d 5f63 6869 6c64  = tree.num_child
-0000a9b0: 7265 6e28 7529 6060 2066 6f72 2061 6c6c  ren(u)`` for all
-0000a9c0: 0a20 2020 2020 2020 2060 6030 203c 3d20  .        ``0 <= 
-0000a9d0: 7520 3c3d 2074 732e 6e75 6d5f 6e6f 6465  u <= ts.num_node
-0000a9e0: 7360 602e 2053 6565 2074 6865 203a 6d65  s``. See the :me
-0000a9f0: 7468 3a60 7e2e 6e75 6d5f 6368 696c 6472  th:`~.num_childr
-0000aa00: 656e 600a 2020 2020 2020 2020 6d65 7468  en`.        meth
-0000aa10: 6f64 2066 6f72 2064 6574 6169 6c73 206f  od for details o
-0000aa20: 6e20 7468 6520 7365 6d61 6e74 6963 7320  n the semantics 
-0000aa30: 6f66 2074 7265 6520 6e75 6d5f 6368 696c  of tree num_chil
-0000aa40: 6472 656e 2061 6e64 2074 6865 0a20 2020  dren and the.   
-0000aa50: 2020 2020 203a 7265 663a 6073 6563 5f64       :ref:`sec_d
-0000aa60: 6174 615f 6d6f 6465 6c5f 7472 6565 5f73  ata_model_tree_s
-0000aa70: 7472 7563 7475 7265 6020 7365 6374 696f  tructure` sectio
-0000aa80: 6e20 666f 7220 696e 666f 726d 6174 696f  n for informatio
-0000aa90: 6e20 6f6e 2074 6865 0a20 2020 2020 2020  n on the.       
-0000aaa0: 2071 7569 6e74 7570 6c79 206c 696e 6b65   quintuply linke
-0000aab0: 6420 7472 6565 2065 6e63 6f64 696e 672e  d tree encoding.
-0000aac0: 0a0a 2020 2020 2020 2020 2e2e 2069 6e63  ..        .. inc
-0000aad0: 6c75 6465 3a3a 2073 7562 7374 6974 7574  lude:: substitut
-0000aae0: 696f 6e73 2f76 6972 7475 616c 5f72 6f6f  ions/virtual_roo
-0000aaf0: 745f 6172 7261 795f 6e6f 7465 2e72 7374  t_array_note.rst
-0000ab00: 0a0a 2020 2020 2020 2020 2e2e 2069 6e63  ..        .. inc
-0000ab10: 6c75 6465 3a3a 2073 7562 7374 6974 7574  lude:: substitut
-0000ab20: 696f 6e73 2f74 7265 655f 6172 7261 795f  ions/tree_array_
-0000ab30: 7761 726e 696e 672e 7273 740a 2020 2020  warning.rst.    
-0000ab40: 2020 2020 2222 220a 2020 2020 2020 2020      """.        
-0000ab50: 7265 7475 726e 2073 656c 662e 5f6e 756d  return self._num
-0000ab60: 5f63 6869 6c64 7265 6e5f 6172 7261 790a  _children_array.
-0000ab70: 0a20 2020 2064 6566 2065 6467 6528 7365  .    def edge(se
-0000ab80: 6c66 2c20 7529 3a0a 2020 2020 2020 2020  lf, u):.        
-0000ab90: 2222 220a 2020 2020 2020 2020 5265 7475  """.        Retu
-0000aba0: 726e 7320 7468 6520 6964 206f 6620 7468  rns the id of th
-0000abb0: 6520 6564 6765 2065 6e63 6f64 696e 6720  e edge encoding 
-0000abc0: 7468 6520 7265 6c61 7469 6f6e 7368 6970  the relationship
-0000abd0: 2062 6574 7765 656e 2060 6075 6060 0a20   between ``u``. 
-0000abe0: 2020 2020 2020 2061 6e64 2069 7473 2070         and its p
-0000abf0: 6172 656e 742c 206f 7220 3a64 6174 613a  arent, or :data:
-0000ac00: 6074 736b 6974 2e4e 554c 4c60 2069 6620  `tskit.NULL` if 
-0000ac10: 6060 7560 6020 6973 2061 2072 6f6f 742c  ``u`` is a root,
-0000ac20: 2076 6972 7475 616c 2072 6f6f 740a 2020   virtual root.  
-0000ac30: 2020 2020 2020 6f72 2069 7320 6e6f 7420        or is not 
-0000ac40: 6120 6e6f 6465 2069 6e20 7468 6520 6375  a node in the cu
-0000ac50: 7272 656e 7420 7472 6565 2e0a 0a20 2020  rrent tree...   
-0000ac60: 2020 2020 203a 7061 7261 6d20 696e 7420       :param int 
-0000ac70: 753a 2054 6865 206e 6f64 6520 6f66 2069  u: The node of i
-0000ac80: 6e74 6572 6573 742e 0a20 2020 2020 2020  nterest..       
-0000ac90: 203a 7265 7475 726e 3a20 4964 206f 6620   :return: Id of 
-0000aca0: 6564 6765 2063 6f6e 6e65 6374 696e 6720  edge connecting 
-0000acb0: 7520 746f 2069 7473 2070 6172 656e 742e  u to its parent.
-0000acc0: 0a20 2020 2020 2020 203a 7274 7970 653a  .        :rtype:
-0000acd0: 2069 6e74 0a20 2020 2020 2020 2022 2222   int.        """
-0000ace0: 0a20 2020 2020 2020 2072 6574 7572 6e20  .        return 
-0000acf0: 7365 6c66 2e5f 6c6c 5f74 7265 652e 6765  self._ll_tree.ge
-0000ad00: 745f 6564 6765 2875 290a 0a20 2020 2040  t_edge(u)..    @
-0000ad10: 7072 6f70 6572 7479 0a20 2020 2064 6566  property.    def
-0000ad20: 2065 6467 655f 6172 7261 7928 7365 6c66   edge_array(self
-0000ad30: 293a 0a20 2020 2020 2020 2022 2222 0a20  ):.        """. 
-0000ad40: 2020 2020 2020 2041 206e 756d 7079 2061         A numpy a
-0000ad50: 7272 6179 2028 6474 7970 653d 6e70 2e69  rray (dtype=np.i
-0000ad60: 6e74 3332 2920 6f66 2065 6467 6520 6964  nt32) of edge id
-0000ad70: 7320 656e 636f 6469 6e67 2074 6865 2072  s encoding the r
-0000ad80: 656c 6174 696f 6e73 6869 700a 2020 2020  elationship.    
-0000ad90: 2020 2020 6265 7477 6565 6e20 7468 6520      between the 
-0000ada0: 6368 696c 6420 6e6f 6465 2060 6075 6060  child node ``u``
-0000adb0: 2061 6e64 2069 7473 2070 6172 656e 742c   and its parent,
-0000adc0: 2073 7563 6820 7468 6174 0a20 2020 2020   such that.     
-0000add0: 2020 2060 6074 7265 652e 6564 6765 5f61     ``tree.edge_a
-0000ade0: 7272 6179 5b75 5d20 3d3d 2074 7265 652e  rray[u] == tree.
-0000adf0: 6564 6765 2875 2960 6020 666f 7220 616c  edge(u)`` for al
-0000ae00: 6c0a 2020 2020 2020 2020 6060 3020 3c3d  l.        ``0 <=
-0000ae10: 2075 203c 3d20 7473 2e6e 756d 5f6e 6f64   u <= ts.num_nod
-0000ae20: 6573 6060 2e20 5365 6520 7468 6520 3a6d  es``. See the :m
-0000ae30: 6574 683a 607e 2e65 6467 6560 0a20 2020  eth:`~.edge`.   
-0000ae40: 2020 2020 206d 6574 686f 6420 666f 7220       method for 
-0000ae50: 6465 7461 696c 7320 6f6e 2074 6865 2073  details on the s
-0000ae60: 656d 616e 7469 6373 206f 6620 7472 6565  emantics of tree
-0000ae70: 2065 6467 6520 616e 6420 7468 650a 2020   edge and the.  
-0000ae80: 2020 2020 2020 3a72 6566 3a60 7365 635f        :ref:`sec_
-0000ae90: 6461 7461 5f6d 6f64 656c 5f74 7265 655f  data_model_tree_
-0000aea0: 7374 7275 6374 7572 6560 2073 6563 7469  structure` secti
-0000aeb0: 6f6e 2066 6f72 2069 6e66 6f72 6d61 7469  on for informati
-0000aec0: 6f6e 206f 6e20 7468 650a 2020 2020 2020  on on the.      
-0000aed0: 2020 7175 696e 7475 706c 7920 6c69 6e6b    quintuply link
-0000aee0: 6564 2074 7265 6520 656e 636f 6469 6e67  ed tree encoding
-0000aef0: 2e0a 0a20 2020 2020 2020 202e 2e20 696e  ...        .. in
-0000af00: 636c 7564 653a 3a20 7375 6273 7469 7475  clude:: substitu
-0000af10: 7469 6f6e 732f 7669 7274 7561 6c5f 726f  tions/virtual_ro
-0000af20: 6f74 5f61 7272 6179 5f6e 6f74 652e 7273  ot_array_note.rs
-0000af30: 740a 0a20 2020 2020 2020 202e 2e20 696e  t..        .. in
-0000af40: 636c 7564 653a 3a20 7375 6273 7469 7475  clude:: substitu
-0000af50: 7469 6f6e 732f 7472 6565 5f61 7272 6179  tions/tree_array
-0000af60: 5f77 6172 6e69 6e67 2e72 7374 0a20 2020  _warning.rst.   
-0000af70: 2020 2020 2022 2222 0a20 2020 2020 2020       """.       
-0000af80: 2072 6574 7572 6e20 7365 6c66 2e5f 6564   return self._ed
-0000af90: 6765 5f61 7272 6179 0a0a 2020 2020 2320  ge_array..    # 
-0000afa0: 5361 6d70 6c65 206c 6973 742e 0a0a 2020  Sample list...  
-0000afb0: 2020 6465 6620 6c65 6674 5f73 616d 706c    def left_sampl
-0000afc0: 6528 7365 6c66 2c20 7529 3a0a 2020 2020  e(self, u):.    
-0000afd0: 2020 2020 7265 7475 726e 2073 656c 662e      return self.
-0000afe0: 5f6c 6c5f 7472 6565 2e67 6574 5f6c 6566  _ll_tree.get_lef
-0000aff0: 745f 7361 6d70 6c65 2875 290a 0a20 2020  t_sample(u)..   
-0000b000: 2064 6566 2072 6967 6874 5f73 616d 706c   def right_sampl
-0000b010: 6528 7365 6c66 2c20 7529 3a0a 2020 2020  e(self, u):.    
-0000b020: 2020 2020 7265 7475 726e 2073 656c 662e      return self.
-0000b030: 5f6c 6c5f 7472 6565 2e67 6574 5f72 6967  _ll_tree.get_rig
-0000b040: 6874 5f73 616d 706c 6528 7529 0a0a 2020  ht_sample(u)..  
-0000b050: 2020 6465 6620 6e65 7874 5f73 616d 706c    def next_sampl
-0000b060: 6528 7365 6c66 2c20 7529 3a0a 2020 2020  e(self, u):.    
-0000b070: 2020 2020 7265 7475 726e 2073 656c 662e      return self.
-0000b080: 5f6c 6c5f 7472 6565 2e67 6574 5f6e 6578  _ll_tree.get_nex
-0000b090: 745f 7361 6d70 6c65 2875 290a 0a20 2020  t_sample(u)..   
-0000b0a0: 2040 7072 6f70 6572 7479 0a20 2020 2064   @property.    d
-0000b0b0: 6566 2076 6972 7475 616c 5f72 6f6f 7428  ef virtual_root(
-0000b0c0: 7365 6c66 293a 0a20 2020 2020 2020 2022  self):.        "
-0000b0d0: 2222 0a20 2020 2020 2020 2054 6865 2049  "".        The I
-0000b0e0: 4420 6f66 2074 6865 2076 6972 7475 616c  D of the virtual
-0000b0f0: 2072 6f6f 7420 696e 2074 6869 7320 7472   root in this tr
-0000b100: 6565 2e20 5468 6973 2069 7320 6571 7561  ee. This is equa
-0000b110: 6c20 746f 0a20 2020 2020 2020 203a 6174  l to.        :at
-0000b120: 7472 3a60 5472 6565 5365 7175 656e 6365  tr:`TreeSequence
-0000b130: 2e6e 756d 5f6e 6f64 6573 602e 0a0a 2020  .num_nodes`...  
-0000b140: 2020 2020 2020 506c 6561 7365 2073 6565        Please see
-0000b150: 2074 6865 203a 7265 663a 6074 7265 6520   the :ref:`tree 
-0000b160: 726f 6f74 7320 3c73 6563 5f64 6174 615f  roots <sec_data_
-0000b170: 6d6f 6465 6c5f 7472 6565 5f72 6f6f 7473  model_tree_roots
-0000b180: 3e60 0a20 2020 2020 2020 2073 6563 7469  >`.        secti
-0000b190: 6f6e 2066 6f72 206d 6f72 6520 6465 7461  on for more deta
-0000b1a0: 696c 732e 0a20 2020 2020 2020 2022 2222  ils..        """
-0000b1b0: 0a20 2020 2020 2020 2072 6574 7572 6e20  .        return 
-0000b1c0: 7365 6c66 2e5f 6c6c 5f74 7265 652e 6765  self._ll_tree.ge
-0000b1d0: 745f 7669 7274 7561 6c5f 726f 6f74 2829  t_virtual_root()
-0000b1e0: 0a0a 2020 2020 4070 726f 7065 7274 790a  ..    @property.
-0000b1f0: 2020 2020 6465 6620 6e75 6d5f 6564 6765      def num_edge
-0000b200: 7328 7365 6c66 293a 0a20 2020 2020 2020  s(self):.       
-0000b210: 2022 2222 0a20 2020 2020 2020 2054 6865   """.        The
-0000b220: 2074 6f74 616c 206e 756d 6265 7220 6f66   total number of
-0000b230: 2065 6467 6573 2069 6e20 7468 6973 2074   edges in this t
-0000b240: 7265 652e 2054 6869 7320 6973 2065 7175  ree. This is equ
-0000b250: 616c 2074 6f20 7468 650a 2020 2020 2020  al to the.      
-0000b260: 2020 6e75 6d62 6572 206f 6620 7472 6565    number of tree
-0000b270: 2073 6571 7565 6e63 6520 6564 6765 7320   sequence edges 
-0000b280: 7468 6174 2069 6e74 6572 7365 6374 2077  that intersect w
-0000b290: 6974 6820 7468 6973 2074 7265 6527 730a  ith this tree's.
-0000b2a0: 2020 2020 2020 2020 6765 6e6f 6d69 6320          genomic 
-0000b2b0: 696e 7465 7276 616c 2e0a 0a20 2020 2020  interval...     
-0000b2c0: 2020 204e 6f74 6520 7468 6174 2074 6869     Note that thi
-0000b2d0: 7320 6d61 7920 6265 2067 7265 6174 6572  s may be greater
-0000b2e0: 2074 6861 6e20 7468 6520 6e75 6d62 6572   than the number
-0000b2f0: 206f 6620 6272 616e 6368 6573 2074 6861   of branches tha
-0000b300: 740a 2020 2020 2020 2020 6172 6520 7265  t.        are re
-0000b310: 6163 6861 626c 6520 6672 6f6d 2074 6865  achable from the
-0000b320: 2074 7265 6527 7320 726f 6f74 732c 2073   tree's roots, s
-0000b330: 696e 6365 2077 6520 6361 6e20 6861 7665  ince we can have
-0000b340: 2074 6f70 6f6c 6f67 790a 2020 2020 2020   topology.      
-0000b350: 2020 7468 6174 2069 7320 6e6f 7420 6173    that is not as
-0000b360: 736f 6369 6174 6564 2077 6974 6820 616e  sociated with an
-0000b370: 7920 7361 6d70 6c65 732e 0a20 2020 2020  y samples..     
-0000b380: 2020 2022 2222 0a20 2020 2020 2020 2072     """.        r
-0000b390: 6574 7572 6e20 7365 6c66 2e5f 6c6c 5f74  eturn self._ll_t
-0000b3a0: 7265 652e 6765 745f 6e75 6d5f 6564 6765  ree.get_num_edge
-0000b3b0: 7328 290a 0a20 2020 2040 7072 6f70 6572  s()..    @proper
-0000b3c0: 7479 0a20 2020 2064 6566 206c 6566 745f  ty.    def left_
-0000b3d0: 726f 6f74 2873 656c 6629 3a0a 2020 2020  root(self):.    
-0000b3e0: 2020 2020 2222 220a 2020 2020 2020 2020      """.        
-0000b3f0: 5468 6520 6c65 6674 6d6f 7374 2072 6f6f  The leftmost roo
-0000b400: 7420 696e 2074 6869 7320 7472 6565 2e20  t in this tree. 
-0000b410: 4966 2074 6865 7265 2061 7265 206d 756c  If there are mul
-0000b420: 7469 706c 6520 726f 6f74 730a 2020 2020  tiple roots.    
-0000b430: 2020 2020 696e 2074 6869 7320 7472 6565      in this tree
-0000b440: 2c20 7468 6579 2061 7265 2073 6962 6c69  , they are sibli
-0000b450: 6e67 7320 6f66 2074 6869 7320 6e6f 6465  ngs of this node
-0000b460: 2c20 616e 6420 736f 2077 6520 6361 6e0a  , and so we can.
-0000b470: 2020 2020 2020 2020 7573 6520 3a6d 6574          use :met
-0000b480: 683a 602e 7269 6768 745f 7369 6260 2074  h:`.right_sib` t
-0000b490: 6f20 6974 6572 6174 6520 6f76 6572 2061  o iterate over a
-0000b4a0: 6c6c 2072 6f6f 7473 3a0a 0a20 2020 2020  ll roots:..     
-0000b4b0: 2020 202e 2e20 636f 6465 2d62 6c6f 636b     .. code-block
-0000b4c0: 3a3a 2070 7974 686f 6e0a 0a20 2020 2020  :: python..     
-0000b4d0: 2020 2020 2020 2075 203d 2074 7265 652e         u = tree.
-0000b4e0: 6c65 6674 5f72 6f6f 740a 2020 2020 2020  left_root.      
-0000b4f0: 2020 2020 2020 7768 696c 6520 7520 213d        while u !=
-0000b500: 2074 736b 6974 2e4e 554c 4c3a 0a20 2020   tskit.NULL:.   
-0000b510: 2020 2020 2020 2020 2020 2020 2070 7269               pri
-0000b520: 6e74 2822 526f 6f74 3a22 2c20 7529 0a20  nt("Root:", u). 
-0000b530: 2020 2020 2020 2020 2020 2020 2020 2075                 u
-0000b540: 203d 2074 7265 652e 7269 6768 745f 7369   = tree.right_si
-0000b550: 6228 7529 0a0a 2020 2020 2020 2020 5468  b(u)..        Th
-0000b560: 6520 6c65 6674 2d74 6f2d 7269 6768 7420  e left-to-right 
-0000b570: 6f72 6465 7269 6e67 206f 6620 726f 6f74  ordering of root
-0000b580: 7320 6973 2061 7262 6974 7261 7279 2061  s is arbitrary a
-0000b590: 6e64 2073 686f 756c 640a 2020 2020 2020  nd should.      
-0000b5a0: 2020 6e6f 7420 6265 2064 6570 656e 6465    not be depende
-0000b5b0: 6420 6f6e 3b20 7365 6520 7468 650a 2020  d on; see the.  
-0000b5c0: 2020 2020 2020 3a72 6566 3a60 6461 7461        :ref:`data
-0000b5d0: 206d 6f64 656c 203c 7365 635f 6461 7461   model <sec_data
-0000b5e0: 5f6d 6f64 656c 5f74 7265 655f 7374 7275  _model_tree_stru
-0000b5f0: 6374 7572 653e 600a 2020 2020 2020 2020  cture>`.        
-0000b600: 7365 6374 696f 6e20 666f 7220 6465 7461  section for deta
-0000b610: 696c 732e 0a0a 2020 2020 2020 2020 5468  ils...        Th
-0000b620: 6973 2069 7320 6120 6c6f 772d 6c65 7665  is is a low-leve
-0000b630: 6c20 6d65 7468 6f64 2067 6976 696e 6720  l method giving 
-0000b640: 6163 6365 7373 2074 6f20 7468 6520 7175  access to the qu
-0000b650: 696e 7475 706c 7920 6c69 6e6b 6564 0a20  intuply linked. 
-0000b660: 2020 2020 2020 2074 7265 6520 7374 7275         tree stru
-0000b670: 6374 7572 6520 696e 206d 656d 6f72 793b  cture in memory;
-0000b680: 2074 6865 203a 6174 7472 3a60 7e54 7265   the :attr:`~Tre
-0000b690: 652e 726f 6f74 7360 2061 7474 7269 6275  e.roots` attribu
-0000b6a0: 7465 2069 7320 6120 6d6f 7265 0a20 2020  te is a more.   
-0000b6b0: 2020 2020 2063 6f6e 7665 6e69 656e 7420       convenient 
-0000b6c0: 7761 7920 746f 206f 6274 6169 6e20 7468  way to obtain th
-0000b6d0: 6520 726f 6f74 7320 6f66 2061 2074 7265  e roots of a tre
-0000b6e0: 652e 2049 6620 796f 7520 6172 6520 6173  e. If you are as
-0000b6f0: 7375 6d69 6e67 0a20 2020 2020 2020 2074  suming.        t
-0000b700: 6861 7420 7468 6572 6520 6973 2061 2073  hat there is a s
-0000b710: 696e 676c 6520 726f 6f74 2069 6e20 7468  ingle root in th
-0000b720: 6520 7472 6565 2079 6f75 2073 686f 756c  e tree you shoul
-0000b730: 6420 7573 6520 7468 650a 2020 2020 2020  d use the.      
-0000b740: 2020 3a61 7474 723a 607e 5472 6565 2e72    :attr:`~Tree.r
-0000b750: 6f6f 7460 2070 726f 7065 7274 792e 0a0a  oot` property...
-0000b760: 2020 2020 2020 2020 2e2e 2077 6172 6e69          .. warni
-0000b770: 6e67 3a3a 2044 6f20 6e6f 7420 7573 6520  ng:: Do not use 
-0000b780: 7468 6973 2070 726f 7065 7274 7920 6966  this property if
-0000b790: 2079 6f75 2061 7265 2061 7373 756d 696e   you are assumin
-0000b7a0: 6720 7468 6174 2074 6865 7265 0a20 2020  g that there.   
-0000b7b0: 2020 2020 2020 2020 2069 7320 6120 7369           is a si
-0000b7c0: 6e67 6c65 2072 6f6f 7420 696e 2074 7265  ngle root in tre
-0000b7d0: 6573 2074 6861 7420 6172 6520 6265 696e  es that are bein
-0000b7e0: 6720 7072 6f63 6573 7365 642e 2054 6865  g processed. The
-0000b7f0: 0a20 2020 2020 2020 2020 2020 203a 6174  .            :at
-0000b800: 7472 3a60 7e54 7265 652e 726f 6f74 6020  tr:`~Tree.root` 
-0000b810: 7072 6f70 6572 7479 2073 686f 756c 6420  property should 
-0000b820: 6265 2075 7365 6420 696e 2074 6869 7320  be used in this 
-0000b830: 6361 7365 2c20 6173 2069 7420 7769 6c6c  case, as it will
-0000b840: 0a20 2020 2020 2020 2020 2020 2072 6169  .            rai
-0000b850: 7365 2061 6e20 6572 726f 7220 7768 656e  se an error when
-0000b860: 206d 756c 7469 706c 6520 726f 6f74 7320   multiple roots 
-0000b870: 6578 6973 7473 2e0a 0a20 2020 2020 2020  exists...       
-0000b880: 203a 7274 7970 653a 2069 6e74 0a20 2020   :rtype: int.   
-0000b890: 2020 2020 2022 2222 0a20 2020 2020 2020       """.       
-0000b8a0: 2072 6574 7572 6e20 7365 6c66 2e6c 6566   return self.lef
-0000b8b0: 745f 6368 696c 6428 7365 6c66 2e76 6972  t_child(self.vir
-0000b8c0: 7475 616c 5f72 6f6f 7429 0a0a 2020 2020  tual_root)..    
-0000b8d0: 4070 726f 7065 7274 790a 2020 2020 6465  @property.    de
-0000b8e0: 6620 7269 6768 745f 726f 6f74 2873 656c  f right_root(sel
-0000b8f0: 6629 3a0a 2020 2020 2020 2020 7265 7475  f):.        retu
-0000b900: 726e 2073 656c 662e 7269 6768 745f 6368  rn self.right_ch
-0000b910: 696c 6428 7365 6c66 2e76 6972 7475 616c  ild(self.virtual
-0000b920: 5f72 6f6f 7429 0a0a 2020 2020 6465 6620  _root)..    def 
-0000b930: 6765 745f 6368 696c 6472 656e 2873 656c  get_children(sel
-0000b940: 662c 2075 293a 0a20 2020 2020 2020 2023  f, u):.        #
-0000b950: 2044 6570 7265 6361 7465 6420 616c 6961   Deprecated alia
-0000b960: 7320 666f 7220 7365 6c66 2e63 6869 6c64  s for self.child
-0000b970: 7265 6e0a 2020 2020 2020 2020 7265 7475  ren.        retu
-0000b980: 726e 2073 656c 662e 6368 696c 6472 656e  rn self.children
-0000b990: 2875 290a 0a20 2020 2064 6566 2063 6869  (u)..    def chi
-0000b9a0: 6c64 7265 6e28 7365 6c66 2c20 7529 3a0a  ldren(self, u):.
-0000b9b0: 2020 2020 2020 2020 2222 220a 2020 2020          """.    
-0000b9c0: 2020 2020 5265 7475 726e 7320 7468 6520      Returns the 
-0000b9d0: 6368 696c 6472 656e 206f 6620 7468 6520  children of the 
-0000b9e0: 7370 6563 6966 6965 6420 6e6f 6465 2060  specified node `
-0000b9f0: 6075 6060 2061 7320 6120 7475 706c 6520  `u`` as a tuple 
-0000ba00: 6f66 2069 6e74 6567 6572 206e 6f64 6520  of integer node 
-0000ba10: 4944 732e 0a20 2020 2020 2020 2049 6620  IDs..        If 
-0000ba20: 6060 7560 6020 6973 2061 206c 6561 662c  ``u`` is a leaf,
-0000ba30: 2072 6574 7572 6e20 7468 6520 656d 7074   return the empt
-0000ba40: 7920 7475 706c 652e 2054 6865 206f 7264  y tuple. The ord
-0000ba50: 6572 696e 6720 6f66 2063 6869 6c64 7265  ering of childre
-0000ba60: 6e0a 2020 2020 2020 2020 6973 2061 7262  n.        is arb
-0000ba70: 6974 7261 7279 2061 6e64 2073 686f 756c  itrary and shoul
-0000ba80: 6420 6e6f 7420 6265 2064 6570 656e 6465  d not be depende
-0000ba90: 6420 6f6e 3b20 7365 6520 7468 650a 2020  d on; see the.  
-0000baa0: 2020 2020 2020 3a72 6566 3a60 6461 7461        :ref:`data
-0000bab0: 206d 6f64 656c 203c 7365 635f 6461 7461   model <sec_data
-0000bac0: 5f6d 6f64 656c 5f74 7265 655f 7374 7275  _model_tree_stru
-0000bad0: 6374 7572 653e 6020 7365 6374 696f 6e0a  cture>` section.
-0000bae0: 2020 2020 2020 2020 666f 7220 6465 7461          for deta
-0000baf0: 696c 732e 0a0a 2020 2020 2020 2020 3a70  ils...        :p
-0000bb00: 6172 616d 2069 6e74 2075 3a20 5468 6520  aram int u: The 
-0000bb10: 6e6f 6465 206f 6620 696e 7465 7265 7374  node of interest
-0000bb20: 2e0a 2020 2020 2020 2020 3a72 6574 7572  ..        :retur
-0000bb30: 6e3a 2054 6865 2063 6869 6c64 7265 6e20  n: The children 
-0000bb40: 6f66 2060 6075 6060 2061 7320 6120 7475  of ``u`` as a tu
-0000bb50: 706c 6520 6f66 2069 6e74 6567 6572 730a  ple of integers.
-0000bb60: 2020 2020 2020 2020 3a72 7479 7065 3a20          :rtype: 
-0000bb70: 7475 706c 6528 696e 7429 0a20 2020 2020  tuple(int).     
-0000bb80: 2020 2022 2222 0a20 2020 2020 2020 2072     """.        r
-0000bb90: 6574 7572 6e20 7365 6c66 2e5f 6c6c 5f74  eturn self._ll_t
-0000bba0: 7265 652e 6765 745f 6368 696c 6472 656e  ree.get_children
-0000bbb0: 2875 290a 0a20 2020 2064 6566 2067 6574  (u)..    def get
-0000bbc0: 5f74 696d 6528 7365 6c66 2c20 7529 3a0a  _time(self, u):.
-0000bbd0: 2020 2020 2020 2020 2320 4465 7072 6563          # Deprec
-0000bbe0: 6174 6564 2061 6c69 6173 2066 6f72 2073  ated alias for s
-0000bbf0: 656c 662e 7469 6d65 0a20 2020 2020 2020  elf.time.       
-0000bc00: 2072 6574 7572 6e20 7365 6c66 2e74 696d   return self.tim
-0000bc10: 6528 7529 0a0a 2020 2020 6465 6620 7469  e(u)..    def ti
-0000bc20: 6d65 2873 656c 662c 2075 293a 0a20 2020  me(self, u):.   
-0000bc30: 2020 2020 2022 2222 0a20 2020 2020 2020       """.       
-0000bc40: 2052 6574 7572 6e73 2074 6865 2074 696d   Returns the tim
-0000bc50: 6520 6f66 2074 6865 2073 7065 6369 6669  e of the specifi
-0000bc60: 6564 206e 6f64 652e 2054 6869 7320 6973  ed node. This is
-0000bc70: 2065 7175 6976 616c 656e 746c 790a 2020   equivalently.  
-0000bc80: 2020 2020 2020 746f 2060 6074 7265 652e        to ``tree.
-0000bc90: 7472 6565 5f73 6571 7565 6e63 652e 6e6f  tree_sequence.no
-0000bca0: 6465 2875 292e 7469 6d65 6060 2065 7863  de(u).time`` exc
-0000bcb0: 6570 7420 666f 7220 7468 6520 7370 6563  ept for the spec
-0000bcc0: 6961 6c0a 2020 2020 2020 2020 6361 7365  ial.        case
-0000bcd0: 206f 6620 7468 6520 7472 6565 2773 203a   of the tree's :
-0000bce0: 7265 663a 6076 6972 7475 616c 2072 6f6f  ref:`virtual roo
-0000bcf0: 7420 3c73 6563 5f64 6174 615f 6d6f 6465  t <sec_data_mode
-0000bd00: 6c5f 7472 6565 5f72 6f6f 7473 3e60 2c0a  l_tree_roots>`,.
-0000bd10: 2020 2020 2020 2020 7768 6963 6820 6973          which is
-0000bd20: 2064 6566 696e 6564 2061 7320 706f 7369   defined as posi
-0000bd30: 7469 7665 2069 6e66 696e 6974 792e 0a0a  tive infinity...
-0000bd40: 2020 2020 2020 2020 3a70 6172 616d 2069          :param i
-0000bd50: 6e74 2075 3a20 5468 6520 6e6f 6465 206f  nt u: The node o
-0000bd60: 6620 696e 7465 7265 7374 2e0a 2020 2020  f interest..    
-0000bd70: 2020 2020 3a72 6574 7572 6e3a 2054 6865      :return: The
-0000bd80: 2074 696d 6520 6f66 2075 2e0a 2020 2020   time of u..    
-0000bd90: 2020 2020 3a72 7479 7065 3a20 666c 6f61      :rtype: floa
-0000bda0: 740a 2020 2020 2020 2020 2222 220a 2020  t.        """.  
-0000bdb0: 2020 2020 2020 7265 7475 726e 2073 656c        return sel
-0000bdc0: 662e 5f6c 6c5f 7472 6565 2e67 6574 5f74  f._ll_tree.get_t
-0000bdd0: 696d 6528 7529 0a0a 2020 2020 6465 6620  ime(u)..    def 
-0000bde0: 6465 7074 6828 7365 6c66 2c20 7529 3a0a  depth(self, u):.
-0000bdf0: 2020 2020 2020 2020 2222 220a 2020 2020          """.    
-0000be00: 2020 2020 5265 7475 726e 7320 7468 6520      Returns the 
-0000be10: 6e75 6d62 6572 206f 6620 6e6f 6465 7320  number of nodes 
-0000be20: 6f6e 2074 6865 2070 6174 6820 6672 6f6d  on the path from
-0000be30: 2060 6075 6060 2074 6f20 610a 2020 2020   ``u`` to a.    
-0000be40: 2020 2020 726f 6f74 2c20 6e6f 7420 696e      root, not in
-0000be50: 636c 7564 696e 6720 6060 7560 602e 2054  cluding ``u``. T
-0000be60: 6875 732c 2074 6865 2064 6570 7468 206f  hus, the depth o
-0000be70: 6620 6120 726f 6f74 2069 730a 2020 2020  f a root is.    
-0000be80: 2020 2020 7a65 726f 2e0a 0a20 2020 2020      zero...     
-0000be90: 2020 2041 7320 6120 7370 6563 6961 6c20     As a special 
-0000bea0: 6361 7365 2c20 7468 6520 6465 7074 6820  case, the depth 
-0000beb0: 6f66 2074 6865 203a 7265 663a 6076 6972  of the :ref:`vir
-0000bec0: 7475 616c 2072 6f6f 740a 2020 2020 2020  tual root.      
-0000bed0: 2020 3c73 6563 5f64 6174 615f 6d6f 6465    <sec_data_mode
-0000bee0: 6c5f 7472 6565 5f72 6f6f 7473 3e60 2069  l_tree_roots>` i
-0000bef0: 7320 6465 6669 6e65 6420 6173 202d 312e  s defined as -1.
-0000bf00: 0a0a 2020 2020 2020 2020 3a70 6172 616d  ..        :param
-0000bf10: 2069 6e74 2075 3a20 5468 6520 6e6f 6465   int u: The node
-0000bf20: 206f 6620 696e 7465 7265 7374 2e0a 2020   of interest..  
-0000bf30: 2020 2020 2020 3a72 6574 7572 6e3a 2054        :return: T
-0000bf40: 6865 2064 6570 7468 206f 6620 752e 0a20  he depth of u.. 
-0000bf50: 2020 2020 2020 203a 7274 7970 653a 2069         :rtype: i
-0000bf60: 6e74 0a20 2020 2020 2020 2022 2222 0a20  nt.        """. 
-0000bf70: 2020 2020 2020 2072 6574 7572 6e20 7365         return se
-0000bf80: 6c66 2e5f 6c6c 5f74 7265 652e 6465 7074  lf._ll_tree.dept
-0000bf90: 6828 7529 0a0a 2020 2020 6465 6620 6765  h(u)..    def ge
-0000bfa0: 745f 706f 7075 6c61 7469 6f6e 2873 656c  t_population(sel
-0000bfb0: 662c 2075 293a 0a20 2020 2020 2020 2023  f, u):.        #
-0000bfc0: 2044 6570 7265 6361 7465 6420 616c 6961   Deprecated alia
-0000bfd0: 7320 666f 7220 7365 6c66 2e70 6f70 756c  s for self.popul
-0000bfe0: 6174 696f 6e0a 2020 2020 2020 2020 7265  ation.        re
-0000bff0: 7475 726e 2073 656c 662e 706f 7075 6c61  turn self.popula
-0000c000: 7469 6f6e 2875 290a 0a20 2020 2064 6566  tion(u)..    def
-0000c010: 2070 6f70 756c 6174 696f 6e28 7365 6c66   population(self
-0000c020: 2c20 7529 3a0a 2020 2020 2020 2020 2222  , u):.        ""
-0000c030: 220a 2020 2020 2020 2020 5265 7475 726e  ".        Return
-0000c040: 7320 7468 6520 706f 7075 6c61 7469 6f6e  s the population
-0000c050: 2061 7373 6f63 6961 7465 6420 7769 7468   associated with
-0000c060: 2074 6865 2073 7065 6369 6669 6564 206e   the specified n
-0000c070: 6f64 652e 0a20 2020 2020 2020 2045 7175  ode..        Equ
-0000c080: 6976 616c 656e 7420 746f 2060 6074 7265  ivalent to ``tre
-0000c090: 652e 7472 6565 5f73 6571 7565 6e63 652e  e.tree_sequence.
-0000c0a0: 6e6f 6465 2875 292e 706f 7075 6c61 7469  node(u).populati
-0000c0b0: 6f6e 6060 2e0a 0a20 2020 2020 2020 203a  on``...        :
-0000c0c0: 7061 7261 6d20 696e 7420 753a 2054 6865  param int u: The
-0000c0d0: 206e 6f64 6520 6f66 2069 6e74 6572 6573   node of interes
-0000c0e0: 742e 0a20 2020 2020 2020 203a 7265 7475  t..        :retu
-0000c0f0: 726e 3a20 5468 6520 4944 206f 6620 7468  rn: The ID of th
-0000c100: 6520 706f 7075 6c61 7469 6f6e 2061 7373  e population ass
-0000c110: 6f63 6961 7465 6420 7769 7468 206e 6f64  ociated with nod
-0000c120: 6520 752e 0a20 2020 2020 2020 203a 7274  e u..        :rt
-0000c130: 7970 653a 2069 6e74 0a20 2020 2020 2020  ype: int.       
-0000c140: 2022 2222 0a20 2020 2020 2020 2072 6574   """.        ret
-0000c150: 7572 6e20 7365 6c66 2e5f 6c6c 5f74 7265  urn self._ll_tre
-0000c160: 652e 6765 745f 706f 7075 6c61 7469 6f6e  e.get_population
-0000c170: 2875 290a 0a20 2020 2064 6566 2069 735f  (u)..    def is_
-0000c180: 696e 7465 726e 616c 2873 656c 662c 2075  internal(self, u
-0000c190: 293a 0a20 2020 2020 2020 2022 2222 0a20  ):.        """. 
-0000c1a0: 2020 2020 2020 2052 6574 7572 6e73 2054         Returns T
-0000c1b0: 7275 6520 6966 2074 6865 2073 7065 6369  rue if the speci
-0000c1c0: 6669 6564 206e 6f64 6520 6973 206e 6f74  fied node is not
-0000c1d0: 2061 206c 6561 662e 2041 206e 6f64 6520   a leaf. A node 
-0000c1e0: 6973 2069 6e74 6572 6e61 6c0a 2020 2020  is internal.    
-0000c1f0: 2020 2020 6966 2069 7420 6861 7320 6f6e      if it has on
-0000c200: 6520 6f72 206d 6f72 6520 6368 696c 6472  e or more childr
-0000c210: 656e 2069 6e20 7468 6520 6375 7272 656e  en in the curren
-0000c220: 7420 7472 6565 2e0a 0a20 2020 2020 2020  t tree...       
-0000c230: 203a 7061 7261 6d20 696e 7420 753a 2054   :param int u: T
-0000c240: 6865 206e 6f64 6520 6f66 2069 6e74 6572  he node of inter
-0000c250: 6573 742e 0a20 2020 2020 2020 203a 7265  est..        :re
-0000c260: 7475 726e 3a20 5472 7565 2069 6620 7520  turn: True if u 
-0000c270: 6973 206e 6f74 2061 206c 6561 6620 6e6f  is not a leaf no
-0000c280: 6465 2e0a 2020 2020 2020 2020 3a72 7479  de..        :rty
-0000c290: 7065 3a20 626f 6f6c 0a20 2020 2020 2020  pe: bool.       
-0000c2a0: 2022 2222 0a20 2020 2020 2020 2072 6574   """.        ret
-0000c2b0: 7572 6e20 6e6f 7420 7365 6c66 2e69 735f  urn not self.is_
-0000c2c0: 6c65 6166 2875 290a 0a20 2020 2064 6566  leaf(u)..    def
-0000c2d0: 2069 735f 6c65 6166 2873 656c 662c 2075   is_leaf(self, u
-0000c2e0: 293a 0a20 2020 2020 2020 2022 2222 0a20  ):.        """. 
-0000c2f0: 2020 2020 2020 2052 6574 7572 6e73 2054         Returns T
-0000c300: 7275 6520 6966 2074 6865 2073 7065 6369  rue if the speci
-0000c310: 6669 6564 206e 6f64 6520 6973 2061 206c  fied node is a l
-0000c320: 6561 662e 2041 206e 6f64 6520 3a6d 6174  eaf. A node :mat
-0000c330: 683a 6075 6020 6973 2061 0a20 2020 2020  h:`u` is a.     
-0000c340: 2020 206c 6561 6620 6966 2069 7420 6861     leaf if it ha
-0000c350: 7320 7a65 726f 2063 6869 6c64 7265 6e2e  s zero children.
-0000c360: 0a0a 2020 2020 2020 2020 2e2e 206e 6f74  ..        .. not
-0000c370: 653a 3a0a 2020 2020 2020 2020 2020 2020  e::.            
-0000c380: 3a6d 6174 683a 6075 6020 6361 6e20 6265  :math:`u` can be
-0000c390: 2061 6e79 206e 6f64 6520 696e 2074 6865   any node in the
-0000c3a0: 2065 6e74 6972 6520 7472 6565 2073 6571   entire tree seq
-0000c3b0: 7565 6e63 652c 2069 6e63 6c75 6469 6e67  uence, including
-0000c3c0: 206f 6e65 730a 2020 2020 2020 2020 2020   ones.          
-0000c3d0: 2020 7768 6963 6820 6172 6520 6e6f 7420    which are not 
-0000c3e0: 636f 6e6e 6563 7465 6420 7669 6120 6272  connected via br
-0000c3f0: 616e 6368 6573 2074 6f20 6120 726f 6f74  anches to a root
-0000c400: 206e 6f64 6520 6f66 2074 6865 2074 7265   node of the tre
-0000c410: 6520 2861 6e64 2077 6869 6368 0a20 2020  e (and which.   
-0000c420: 2020 2020 2020 2020 2061 7265 2074 6865           are the
-0000c430: 7265 666f 7265 206e 6f74 2063 6f6e 7665  refore not conve
-0000c440: 6e74 696f 6e61 6c6c 7920 636f 6e73 6964  ntionally consid
-0000c450: 6572 6564 2070 6172 7420 6f66 2074 6865  ered part of the
-0000c460: 2074 7265 6529 2e20 496e 6465 6564 2c20   tree). Indeed, 
-0000c470: 6966 0a20 2020 2020 2020 2020 2020 2074  if.            t
-0000c480: 6865 7265 2061 7265 206d 616e 7920 7472  here are many tr
-0000c490: 6565 7320 696e 2074 6865 2074 7265 6520  ees in the tree 
-0000c4a0: 7365 7175 656e 6365 2c20 6974 2069 7320  sequence, it is 
-0000c4b0: 636f 6d6d 6f6e 2066 6f72 2074 6865 206d  common for the m
-0000c4c0: 616a 6f72 6974 7920 6f66 0a20 2020 2020  ajority of.     
-0000c4d0: 2020 2020 2020 206e 6f6e 2d73 616d 706c         non-sampl
-0000c4e0: 6520 6e6f 6465 7320 746f 2062 6520 3a6d  e nodes to be :m
-0000c4f0: 6574 683a 6069 736f 6c61 7465 643c 6973  eth:`isolated<is
-0000c500: 5f69 736f 6c61 7465 643e 6020 696e 2061  _isolated>` in a
-0000c510: 6e79 206f 6e65 0a20 2020 2020 2020 2020  ny one.         
-0000c520: 2020 2074 7265 652e 2042 7920 7468 6520     tree. By the 
-0000c530: 6465 6669 6e69 7469 6f6e 2061 626f 7665  definition above
-0000c540: 2c20 7468 6973 206d 6574 686f 6420 7769  , this method wi
-0000c550: 6c6c 2072 6574 7572 6e20 6060 5472 7565  ll return ``True
-0000c560: 6060 2066 6f72 2073 7563 680a 2020 2020  `` for such.    
-0000c570: 2020 2020 2020 2020 6120 7472 6565 2077          a tree w
-0000c580: 6865 6e20 6120 6e6f 6465 206f 6620 7468  hen a node of th
-0000c590: 6973 2073 6f72 7420 6973 2073 7065 6369  is sort is speci
-0000c5a0: 6669 6564 2e20 5375 6368 206e 6f64 6573  fied. Such nodes
-0000c5b0: 2063 616e 2062 6520 7468 6f75 6768 7420   can be thought 
-0000c5c0: 6f66 0a20 2020 2020 2020 2020 2020 2061  of.            a
-0000c5d0: 7320 2264 6561 6420 6c65 6176 6573 222c  s "dead leaves",
-0000c5e0: 2073 6565 203a 7265 663a 6073 6563 5f64   see :ref:`sec_d
-0000c5f0: 6174 615f 6d6f 6465 6c5f 7472 6565 5f64  ata_model_tree_d
-0000c600: 6561 645f 6c65 6176 6573 5f61 6e64 5f62  ead_leaves_and_b
-0000c610: 7261 6e63 6865 7360 2e0a 0a20 2020 2020  ranches`...     
-0000c620: 2020 203a 7061 7261 6d20 696e 7420 753a     :param int u:
-0000c630: 2054 6865 206e 6f64 6520 6f66 2069 6e74   The node of int
-0000c640: 6572 6573 742e 0a20 2020 2020 2020 203a  erest..        :
-0000c650: 7265 7475 726e 3a20 5472 7565 2069 6620  return: True if 
-0000c660: 7520 6973 2061 206c 6561 6620 6e6f 6465  u is a leaf node
-0000c670: 2e0a 2020 2020 2020 2020 3a72 7479 7065  ..        :rtype
-0000c680: 3a20 626f 6f6c 0a20 2020 2020 2020 2022  : bool.        "
-0000c690: 2222 0a20 2020 2020 2020 2072 6574 7572  "".        retur
-0000c6a0: 6e20 6c65 6e28 7365 6c66 2e63 6869 6c64  n len(self.child
-0000c6b0: 7265 6e28 7529 2920 3d3d 2030 0a0a 2020  ren(u)) == 0..  
-0000c6c0: 2020 6465 6620 6973 5f69 736f 6c61 7465    def is_isolate
-0000c6d0: 6428 7365 6c66 2c20 7529 3a0a 2020 2020  d(self, u):.    
-0000c6e0: 2020 2020 2222 220a 2020 2020 2020 2020      """.        
-0000c6f0: 5265 7475 726e 7320 5472 7565 2069 6620  Returns True if 
-0000c700: 7468 6520 7370 6563 6966 6965 6420 6e6f  the specified no
-0000c710: 6465 2069 7320 6973 6f6c 6174 6564 2069  de is isolated i
-0000c720: 6e20 7468 6973 2074 7265 653a 2074 6861  n this tree: tha
-0000c730: 7420 6973 0a20 2020 2020 2020 2069 7420  t is.        it 
-0000c740: 6861 7320 6e6f 2070 6172 656e 7473 2061  has no parents a
-0000c750: 6e64 206e 6f20 6368 696c 6472 656e 2028  nd no children (
-0000c760: 6e6f 7465 2074 6861 7420 616c 6c20 6973  note that all is
-0000c770: 6f6c 6174 6564 206e 6f64 6573 2069 6e20  olated nodes in 
-0000c780: 7468 6520 7472 6565 0a20 2020 2020 2020  the tree.       
-0000c790: 2061 7265 2074 6865 7265 666f 7265 2061   are therefore a
-0000c7a0: 6c73 6f20 3a6d 6574 683a 606c 6561 7665  lso :meth:`leave
-0000c7b0: 733c 5472 6565 2e69 735f 6c65 6166 3e60  s<Tree.is_leaf>`
-0000c7c0: 292e 2053 616d 706c 6520 6e6f 6465 7320  ). Sample nodes 
-0000c7d0: 7468 6174 2061 7265 2069 736f 6c61 7465  that are isolate
-0000c7e0: 640a 2020 2020 2020 2020 616e 6420 6861  d.        and ha
-0000c7f0: 7665 206e 6f20 6d75 7461 7469 6f6e 7320  ve no mutations 
-0000c800: 6162 6f76 6520 7468 656d 2061 7265 2075  above them are u
-0000c810: 7365 6420 746f 2072 6570 7265 7365 6e74  sed to represent
-0000c820: 0a20 2020 2020 2020 203a 7265 663a 606d  .        :ref:`m
-0000c830: 6973 7369 6e67 2064 6174 613c 7365 635f  issing data<sec_
-0000c840: 6461 7461 5f6d 6f64 656c 5f6d 6973 7369  data_model_missi
-0000c850: 6e67 5f64 6174 613e 602e 0a0a 2020 2020  ng_data>`...    
-0000c860: 2020 2020 3a70 6172 616d 2069 6e74 2075      :param int u
-0000c870: 3a20 5468 6520 6e6f 6465 206f 6620 696e  : The node of in
-0000c880: 7465 7265 7374 2e0a 2020 2020 2020 2020  terest..        
-0000c890: 3a72 6574 7572 6e3a 2054 7275 6520 6966  :return: True if
-0000c8a0: 2075 2069 7320 616e 2069 736f 6c61 7465   u is an isolate
-0000c8b0: 6420 6e6f 6465 2e0a 2020 2020 2020 2020  d node..        
-0000c8c0: 3a72 7479 7065 3a20 626f 6f6c 0a20 2020  :rtype: bool.   
-0000c8d0: 2020 2020 2022 2222 0a20 2020 2020 2020       """.       
-0000c8e0: 2072 6574 7572 6e20 7365 6c66 2e6e 756d   return self.num
-0000c8f0: 5f63 6869 6c64 7265 6e28 7529 203d 3d20  _children(u) == 
-0000c900: 3020 616e 6420 7365 6c66 2e70 6172 656e  0 and self.paren
-0000c910: 7428 7529 203d 3d20 4e55 4c4c 0a0a 2020  t(u) == NULL..  
-0000c920: 2020 6465 6620 6973 5f73 616d 706c 6528    def is_sample(
-0000c930: 7365 6c66 2c20 7529 3a0a 2020 2020 2020  self, u):.      
-0000c940: 2020 2222 220a 2020 2020 2020 2020 5265    """.        Re
-0000c950: 7475 726e 7320 5472 7565 2069 6620 7468  turns True if th
-0000c960: 6520 7370 6563 6966 6965 6420 6e6f 6465  e specified node
-0000c970: 2069 7320 6120 7361 6d70 6c65 2e20 4120   is a sample. A 
-0000c980: 6e6f 6465 203a 6d61 7468 3a60 7560 2069  node :math:`u` i
-0000c990: 7320 610a 2020 2020 2020 2020 7361 6d70  s a.        samp
-0000c9a0: 6c65 2069 6620 6974 2068 6173 2062 6565  le if it has bee
-0000c9b0: 6e20 6d61 726b 6564 2061 7320 6120 7361  n marked as a sa
-0000c9c0: 6d70 6c65 2069 6e20 7468 6520 7061 7265  mple in the pare
-0000c9d0: 6e74 2074 7265 6520 7365 7175 656e 6365  nt tree sequence
-0000c9e0: 2e0a 0a20 2020 2020 2020 203a 7061 7261  ...        :para
-0000c9f0: 6d20 696e 7420 753a 2054 6865 206e 6f64  m int u: The nod
-0000ca00: 6520 6f66 2069 6e74 6572 6573 742e 0a20  e of interest.. 
-0000ca10: 2020 2020 2020 203a 7265 7475 726e 3a20         :return: 
-0000ca20: 5472 7565 2069 6620 7520 6973 2061 2073  True if u is a s
-0000ca30: 616d 706c 652e 0a20 2020 2020 2020 203a  ample..        :
-0000ca40: 7274 7970 653a 2062 6f6f 6c0a 2020 2020  rtype: bool.    
-0000ca50: 2020 2020 2222 220a 2020 2020 2020 2020      """.        
-0000ca60: 7265 7475 726e 2062 6f6f 6c28 7365 6c66  return bool(self
-0000ca70: 2e5f 6c6c 5f74 7265 652e 6973 5f73 616d  ._ll_tree.is_sam
-0000ca80: 706c 6528 7529 290a 0a20 2020 2064 6566  ple(u))..    def
-0000ca90: 2069 735f 6465 7363 656e 6461 6e74 2873   is_descendant(s
-0000caa0: 656c 662c 2075 2c20 7629 3a0a 2020 2020  elf, u, v):.    
-0000cab0: 2020 2020 2222 220a 2020 2020 2020 2020      """.        
-0000cac0: 5265 7475 726e 7320 5472 7565 2069 6620  Returns True if 
-0000cad0: 7468 6520 7370 6563 6966 6965 6420 6e6f  the specified no
-0000cae0: 6465 2075 2069 7320 6120 6465 7363 656e  de u is a descen
-0000caf0: 6461 6e74 206f 6620 6e6f 6465 2076 2061  dant of node v a
-0000cb00: 6e64 2046 616c 7365 0a20 2020 2020 2020  nd False.       
-0000cb10: 206f 7468 6572 7769 7365 2e20 4120 6e6f   otherwise. A no
-0000cb20: 6465 203a 6d61 7468 3a60 7560 2069 7320  de :math:`u` is 
-0000cb30: 6120 6465 7363 656e 6461 6e74 206f 6620  a descendant of 
-0000cb40: 616e 6f74 6865 7220 6e6f 6465 203a 6d61  another node :ma
-0000cb50: 7468 3a60 7660 2069 660a 2020 2020 2020  th:`v` if.      
-0000cb60: 2020 3a6d 6174 683a 6076 6020 6973 206f    :math:`v` is o
-0000cb70: 6e20 7468 6520 7061 7468 2066 726f 6d20  n the path from 
-0000cb80: 3a6d 6174 683a 6075 6020 746f 2072 6f6f  :math:`u` to roo
-0000cb90: 742e 2041 206e 6f64 6520 6973 2063 6f6e  t. A node is con
-0000cba0: 7369 6465 7265 640a 2020 2020 2020 2020  sidered.        
-0000cbb0: 746f 2062 6520 6120 6465 7363 656e 6461  to be a descenda
-0000cbc0: 6e74 206f 6620 6974 7365 6c66 2c20 736f  nt of itself, so
-0000cbd0: 2060 6074 7265 652e 6973 5f64 6573 6365   ``tree.is_desce
-0000cbe0: 6e64 616e 7428 752c 2075 2960 6020 7769  ndant(u, u)`` wi
-0000cbf0: 6c6c 2062 650a 2020 2020 2020 2020 5472  ll be.        Tr
-0000cc00: 7565 2066 6f72 2061 6e79 2076 616c 6964  ue for any valid
-0000cc10: 206e 6f64 652e 0a0a 2020 2020 2020 2020   node...        
-0000cc20: 3a70 6172 616d 2069 6e74 2075 3a20 5468  :param int u: Th
-0000cc30: 6520 6465 7363 656e 6461 6e74 206e 6f64  e descendant nod
-0000cc40: 652e 0a20 2020 2020 2020 203a 7061 7261  e..        :para
-0000cc50: 6d20 696e 7420 763a 2054 6865 2061 6e63  m int v: The anc
-0000cc60: 6573 7472 616c 206e 6f64 652e 0a20 2020  estral node..   
-0000cc70: 2020 2020 203a 7265 7475 726e 3a20 5472       :return: Tr
-0000cc80: 7565 2069 6620 7520 6973 2061 2064 6573  ue if u is a des
-0000cc90: 6365 6e64 616e 7420 6f66 2076 2e0a 2020  cendant of v..  
-0000cca0: 2020 2020 2020 3a72 7479 7065 3a20 626f        :rtype: bo
-0000ccb0: 6f6c 0a20 2020 2020 2020 203a 7261 6973  ol.        :rais
-0000ccc0: 6573 2056 616c 7565 4572 726f 723a 2049  es ValueError: I
-0000ccd0: 6620 7520 6f72 2076 2061 7265 206e 6f74  f u or v are not
-0000cce0: 2076 616c 6964 206e 6f64 6520 4944 732e   valid node IDs.
-0000ccf0: 0a20 2020 2020 2020 2022 2222 0a20 2020  .        """.   
-0000cd00: 2020 2020 2072 6574 7572 6e20 626f 6f6c       return bool
-0000cd10: 2873 656c 662e 5f6c 6c5f 7472 6565 2e69  (self._ll_tree.i
-0000cd20: 735f 6465 7363 656e 6461 6e74 2875 2c20  s_descendant(u, 
-0000cd30: 7629 290a 0a20 2020 2040 7072 6f70 6572  v))..    @proper
-0000cd40: 7479 0a20 2020 2064 6566 206e 756d 5f6e  ty.    def num_n
-0000cd50: 6f64 6573 2873 656c 6629 3a0a 2020 2020  odes(self):.    
-0000cd60: 2020 2020 2222 220a 2020 2020 2020 2020      """.        
-0000cd70: 5265 7475 726e 7320 7468 6520 6e75 6d62  Returns the numb
-0000cd80: 6572 206f 6620 6e6f 6465 7320 696e 2074  er of nodes in t
-0000cd90: 6865 203a 636c 6173 733a 6054 7265 6553  he :class:`TreeS
-0000cda0: 6571 7565 6e63 6560 2074 6869 7320 7472  equence` this tr
-0000cdb0: 6565 2069 7320 696e 2e0a 2020 2020 2020  ee is in..      
-0000cdc0: 2020 4571 7569 7661 6c65 6e74 2074 6f20    Equivalent to 
-0000cdd0: 6060 7472 6565 2e74 7265 655f 7365 7175  ``tree.tree_sequ
-0000cde0: 656e 6365 2e6e 756d 5f6e 6f64 6573 6060  ence.num_nodes``
-0000cdf0: 2e0a 0a20 2020 2020 2020 202e 2e20 6465  ...        .. de
-0000ce00: 7072 6563 6174 6564 3a3a 2030 2e34 0a20  precated:: 0.4. 
-0000ce10: 2020 2020 2020 2020 2020 2055 7365 203a             Use :
-0000ce20: 6174 7472 3a60 5472 6565 2e74 7265 655f  attr:`Tree.tree_
-0000ce30: 7365 7175 656e 6365 2e6e 756d 5f6e 6f64  sequence.num_nod
-0000ce40: 6573 3c54 7265 6553 6571 7565 6e63 652e  es<TreeSequence.
-0000ce50: 6e75 6d5f 6e6f 6465 733e 6020 6966 2079  num_nodes>` if y
-0000ce60: 6f75 2077 616e 740a 2020 2020 2020 2020  ou want.        
-0000ce70: 2020 2020 7468 6520 6e75 6d62 6572 206f      the number o
-0000ce80: 6620 6e6f 6465 7320 696e 2074 6865 2065  f nodes in the e
-0000ce90: 6e74 6972 6520 7472 6565 2073 6571 7565  ntire tree seque
-0000cea0: 6e63 652c 206f 720a 2020 2020 2020 2020  nce, or.        
-0000ceb0: 2020 2020 6060 6c65 6e28 7472 6565 2e70      ``len(tree.p
-0000cec0: 7265 6f72 6465 7228 2929 6060 2074 6f20  reorder())`` to 
-0000ced0: 6669 6e64 2074 6865 206e 756d 6265 7220  find the number 
-0000cee0: 6f66 206e 6f64 6573 2074 6861 7420 6172  of nodes that ar
-0000cef0: 650a 2020 2020 2020 2020 2020 2020 7265  e.            re
-0000cf00: 6163 6861 626c 6520 6672 6f6d 2061 6c6c  achable from all
-0000cf10: 2072 6f6f 7473 2069 6e20 7468 6973 2074   roots in this t
-0000cf20: 7265 652e 0a0a 2020 2020 2020 2020 3a72  ree...        :r
-0000cf30: 7479 7065 3a20 696e 740a 0a20 2020 2020  type: int..     
-0000cf40: 2020 2022 2222 0a20 2020 2020 2020 2077     """.        w
-0000cf50: 6172 6e69 6e67 732e 7761 726e 280a 2020  arnings.warn(.  
-0000cf60: 2020 2020 2020 2020 2020 2254 6869 7320            "This 
-0000cf70: 7072 6f70 6572 7479 2069 7320 6120 6465  property is a de
-0000cf80: 7072 6563 6174 6564 2061 6c69 6173 2066  precated alias f
-0000cf90: 6f72 2054 7265 652e 7472 6565 5f73 6571  or Tree.tree_seq
-0000cfa0: 7565 6e63 652e 6e75 6d5f 6e6f 6465 7320  uence.num_nodes 
-0000cfb0: 220a 2020 2020 2020 2020 2020 2020 2261  ".            "a
-0000cfc0: 6e64 2077 696c 6c20 6265 2072 656d 6f76  nd will be remov
-0000cfd0: 6564 2069 6e20 7468 6520 6675 7475 7265  ed in the future
-0000cfe0: 2e20 546f 206f 6274 6169 6e20 7468 6520  . To obtain the 
-0000cff0: 6e75 6d62 6572 206f 6620 6e6f 6465 7320  number of nodes 
-0000d000: 220a 2020 2020 2020 2020 2020 2020 2269  ".            "i
-0000d010: 6e20 7468 6520 746f 706f 6c6f 6779 206f  n the topology o
-0000d020: 6620 7468 6520 6375 7272 656e 7420 7472  f the current tr
-0000d030: 6565 2028 692e 652e 2072 6561 6368 6162  ee (i.e. reachab
-0000d040: 6c65 2066 726f 6d20 7468 6520 726f 6f74  le from the root
-0000d050: 7329 2022 0a20 2020 2020 2020 2020 2020  s) ".           
-0000d060: 2022 7573 6520 6c65 6e28 7472 6565 2e70   "use len(tree.p
-0000d070: 7265 6f72 6465 7228 2929 2e22 2c0a 2020  reorder()).",.  
-0000d080: 2020 2020 2020 2020 2020 4675 7475 7265            Future
-0000d090: 5761 726e 696e 672c 0a20 2020 2020 2020  Warning,.       
-0000d0a0: 2029 0a20 2020 2020 2020 2072 6574 7572   ).        retur
-0000d0b0: 6e20 7365 6c66 2e74 7265 655f 7365 7175  n self.tree_sequ
-0000d0c0: 656e 6365 2e6e 756d 5f6e 6f64 6573 0a0a  ence.num_nodes..
-0000d0d0: 2020 2020 4070 726f 7065 7274 790a 2020      @property.  
-0000d0e0: 2020 6465 6620 6e75 6d5f 726f 6f74 7328    def num_roots(
-0000d0f0: 7365 6c66 293a 0a20 2020 2020 2020 2022  self):.        "
-0000d100: 2222 0a20 2020 2020 2020 2054 6865 206e  "".        The n
-0000d110: 756d 6265 7220 6f66 2072 6f6f 7473 2069  umber of roots i
-0000d120: 6e20 7468 6973 2074 7265 652c 2061 7320  n this tree, as 
-0000d130: 6465 6669 6e65 6420 696e 2074 6865 203a  defined in the :
-0000d140: 6174 7472 3a60 7e54 7265 652e 726f 6f74  attr:`~Tree.root
-0000d150: 7360 0a20 2020 2020 2020 2061 7474 7269  s`.        attri
-0000d160: 6275 7465 2e0a 0a20 2020 2020 2020 204f  bute...        O
-0000d170: 6e6c 7920 7265 7175 6972 6573 204f 286e  nly requires O(n
-0000d180: 756d 6265 7220 6f66 2072 6f6f 7473 2920  umber of roots) 
-0000d190: 7469 6d65 2e0a 0a20 2020 2020 2020 203a  time...        :
-0000d1a0: 7274 7970 653a 2069 6e74 0a20 2020 2020  rtype: int.     
-0000d1b0: 2020 2022 2222 0a20 2020 2020 2020 2072     """.        r
-0000d1c0: 6574 7572 6e20 7365 6c66 2e5f 6c6c 5f74  eturn self._ll_t
-0000d1d0: 7265 652e 6765 745f 6e75 6d5f 726f 6f74  ree.get_num_root
-0000d1e0: 7328 290a 0a20 2020 2040 7072 6f70 6572  s()..    @proper
-0000d1f0: 7479 0a20 2020 2064 6566 2068 6173 5f73  ty.    def has_s
-0000d200: 696e 676c 655f 726f 6f74 2873 656c 6629  ingle_root(self)
-0000d210: 3a0a 2020 2020 2020 2020 2222 220a 2020  :.        """.  
-0000d220: 2020 2020 2020 6060 5472 7565 6060 2069        ``True`` i
-0000d230: 6620 7468 6973 2074 7265 6520 6861 7320  f this tree has 
-0000d240: 6120 7369 6e67 6c65 2072 6f6f 742c 2060  a single root, `
-0000d250: 6046 616c 7365 6060 206f 7468 6572 7769  `False`` otherwi
-0000d260: 7365 2e0a 2020 2020 2020 2020 4571 7569  se..        Equi
-0000d270: 7661 6c65 6e74 2074 6f20 7472 6565 2e6e  valent to tree.n
-0000d280: 756d 5f72 6f6f 7473 203d 3d20 312e 2054  um_roots == 1. T
-0000d290: 6869 7320 6973 2061 204f 2831 2920 6f70  his is a O(1) op
-0000d2a0: 6572 6174 696f 6e2e 0a0a 2020 2020 2020  eration...      
-0000d2b0: 2020 3a72 7479 7065 3a20 626f 6f6c 0a20    :rtype: bool. 
-0000d2c0: 2020 2020 2020 2022 2222 0a20 2020 2020         """.     
-0000d2d0: 2020 2072 6f6f 7420 3d20 7365 6c66 2e6c     root = self.l
-0000d2e0: 6566 745f 726f 6f74 0a20 2020 2020 2020  eft_root.       
-0000d2f0: 2069 6620 726f 6f74 2021 3d20 4e55 4c4c   if root != NULL
-0000d300: 2061 6e64 2073 656c 662e 7269 6768 745f   and self.right_
-0000d310: 7369 6228 726f 6f74 2920 3d3d 204e 554c  sib(root) == NUL
-0000d320: 4c3a 0a20 2020 2020 2020 2020 2020 2072  L:.            r
-0000d330: 6574 7572 6e20 5472 7565 0a20 2020 2020  eturn True.     
-0000d340: 2020 2072 6574 7572 6e20 4661 6c73 650a     return False.
-0000d350: 0a20 2020 2040 7072 6f70 6572 7479 0a20  .    @property. 
-0000d360: 2020 2064 6566 2068 6173 5f6d 756c 7469     def has_multi
-0000d370: 706c 655f 726f 6f74 7328 7365 6c66 293a  ple_roots(self):
-0000d380: 0a20 2020 2020 2020 2022 2222 0a20 2020  .        """.   
-0000d390: 2020 2020 2060 6054 7275 6560 6020 6966       ``True`` if
-0000d3a0: 2074 6869 7320 7472 6565 2068 6173 206d   this tree has m
-0000d3b0: 6f72 6520 7468 616e 206f 6e65 2072 6f6f  ore than one roo
-0000d3c0: 742c 2060 6046 616c 7365 6060 206f 7468  t, ``False`` oth
-0000d3d0: 6572 7769 7365 2e0a 2020 2020 2020 2020  erwise..        
-0000d3e0: 4571 7569 7661 6c65 6e74 2074 6f20 7472  Equivalent to tr
-0000d3f0: 6565 2e6e 756d 5f72 6f6f 7473 203e 2031  ee.num_roots > 1
-0000d400: 2e20 5468 6973 2069 7320 6120 4f28 3129  . This is a O(1)
-0000d410: 206f 7065 7261 7469 6f6e 2e0a 0a20 2020   operation...   
-0000d420: 2020 2020 203a 7274 7970 653a 2062 6f6f       :rtype: boo
-0000d430: 6c0a 2020 2020 2020 2020 2222 220a 2020  l.        """.  
-0000d440: 2020 2020 2020 726f 6f74 203d 2073 656c        root = sel
-0000d450: 662e 6c65 6674 5f72 6f6f 740a 2020 2020  f.left_root.    
-0000d460: 2020 2020 6966 2072 6f6f 7420 213d 204e      if root != N
-0000d470: 554c 4c20 616e 6420 7365 6c66 2e72 6967  ULL and self.rig
-0000d480: 6874 5f73 6962 2872 6f6f 7429 2021 3d20  ht_sib(root) != 
-0000d490: 4e55 4c4c 3a0a 2020 2020 2020 2020 2020  NULL:.          
-0000d4a0: 2020 7265 7475 726e 2054 7275 650a 2020    return True.  
-0000d4b0: 2020 2020 2020 7265 7475 726e 2046 616c        return Fal
-0000d4c0: 7365 0a0a 2020 2020 4070 726f 7065 7274  se..    @propert
-0000d4d0: 790a 2020 2020 6465 6620 726f 6f74 7328  y.    def roots(
-0000d4e0: 7365 6c66 293a 0a20 2020 2020 2020 2022  self):.        "
-0000d4f0: 2222 0a20 2020 2020 2020 2054 6865 206c  "".        The l
-0000d500: 6973 7420 6f66 2072 6f6f 7473 2069 6e20  ist of roots in 
-0000d510: 7468 6973 2074 7265 652e 2041 2072 6f6f  this tree. A roo
-0000d520: 7420 6973 2064 6566 696e 6564 2061 7320  t is defined as 
-0000d530: 6120 756e 6971 7565 2065 6e64 706f 696e  a unique endpoin
-0000d540: 7420 6f66 2074 6865 0a20 2020 2020 2020  t of the.       
-0000d550: 2070 6174 6873 2073 7461 7274 696e 6720   paths starting 
-0000d560: 6174 2073 616d 706c 6573 2c20 7375 626a  at samples, subj
-0000d570: 6563 7420 746f 2074 6865 2063 6f6e 6469  ect to the condi
-0000d580: 7469 6f6e 2074 6861 7420 6974 2069 7320  tion that it is 
-0000d590: 636f 6e6e 6563 7465 6420 746f 2061 740a  connected to at.
-0000d5a0: 2020 2020 2020 2020 6c65 6173 7420 3a61          least :a
-0000d5b0: 7474 723a 6072 6f6f 745f 7468 7265 7368  ttr:`root_thresh
-0000d5c0: 6f6c 6460 2073 616d 706c 6573 2e20 5765  old` samples. We
-0000d5d0: 2063 616e 2064 6566 696e 6520 7468 6520   can define the 
-0000d5e0: 7365 7420 6f66 2072 6f6f 7473 2061 7320  set of roots as 
-0000d5f0: 666f 6c6c 6f77 733a 0a0a 2020 2020 2020  follows:..      
-0000d600: 2020 2e2e 2063 6f64 652d 626c 6f63 6b3a    .. code-block:
-0000d610: 3a20 7079 7468 6f6e 0a0a 2020 2020 2020  : python..      
-0000d620: 2020 2020 2020 726f 6f74 7320 3d20 7365        roots = se
-0000d630: 7428 290a 2020 2020 2020 2020 2020 2020  t().            
-0000d640: 666f 7220 7520 696e 2074 7265 655f 7365  for u in tree_se
-0000d650: 7175 656e 6365 2e73 616d 706c 6573 2829  quence.samples()
-0000d660: 3a0a 2020 2020 2020 2020 2020 2020 2020  :.              
-0000d670: 2020 7768 696c 6520 7472 6565 2e70 6172    while tree.par
-0000d680: 656e 7428 7529 2021 3d20 7473 6b69 742e  ent(u) != tskit.
-0000d690: 4e55 4c4c 3a0a 2020 2020 2020 2020 2020  NULL:.          
-0000d6a0: 2020 2020 2020 2020 2020 7520 3d20 7472            u = tr
-0000d6b0: 6565 2e70 6172 656e 7428 7529 0a20 2020  ee.parent(u).   
-0000d6c0: 2020 2020 2020 2020 2020 2020 2069 6620               if 
-0000d6d0: 7472 6565 2e6e 756d 5f73 616d 706c 6573  tree.num_samples
-0000d6e0: 2875 2920 3e3d 2074 7265 652e 726f 6f74  (u) >= tree.root
-0000d6f0: 5f74 6872 6573 686f 6c64 3a0a 2020 2020  _threshold:.    
-0000d700: 2020 2020 2020 2020 2020 2020 2020 2020                  
-0000d710: 726f 6f74 732e 6164 6428 7529 0a20 2020  roots.add(u).   
-0000d720: 2020 2020 2020 2020 2023 2072 6f6f 7473           # roots
-0000d730: 2069 7320 6e6f 7720 7468 6520 7365 7420   is now the set 
-0000d740: 6f66 2061 6c6c 2072 6f6f 7473 2069 6e20  of all roots in 
-0000d750: 7468 6973 2074 7265 652e 0a20 2020 2020  this tree..     
-0000d760: 2020 2020 2020 2061 7373 6572 7420 736f         assert so
-0000d770: 7274 6564 2872 6f6f 7473 2920 3d3d 2073  rted(roots) == s
-0000d780: 6f72 7465 6428 7472 6565 2e72 6f6f 7473  orted(tree.roots
-0000d790: 290a 0a20 2020 2020 2020 2054 6865 2072  )..        The r
-0000d7a0: 6f6f 7473 206f 6620 7468 6520 7472 6565  oots of the tree
-0000d7b0: 2061 7265 2072 6574 7572 6e65 6420 696e   are returned in
-0000d7c0: 2061 206c 6973 742c 2069 6e20 6e6f 2070   a list, in no p
-0000d7d0: 6172 7469 6375 6c61 7220 6f72 6465 722e  articular order.
-0000d7e0: 0a0a 2020 2020 2020 2020 4f6e 6c79 2072  ..        Only r
-0000d7f0: 6571 7569 7265 7320 4f28 6e75 6d62 6572  equires O(number
-0000d800: 206f 6620 726f 6f74 7329 2074 696d 652e   of roots) time.
-0000d810: 0a0a 2020 2020 2020 2020 2e2e 206e 6f74  ..        .. not
-0000d820: 653a 3a0a 2020 2020 2020 2020 2020 2020  e::.            
-0000d830: 496e 2074 7265 6573 2077 6974 6820 6c61  In trees with la
-0000d840: 7267 6520 616d 6f75 6e74 7320 6f66 203a  rge amounts of :
-0000d850: 7265 663a 6073 6563 5f64 6174 615f 6d6f  ref:`sec_data_mo
-0000d860: 6465 6c5f 6d69 7373 696e 675f 6461 7461  del_missing_data
-0000d870: 602c 0a20 2020 2020 2020 2020 2020 2066  `,.            f
-0000d880: 6f72 2065 7861 6d70 6c65 2077 6865 7265  or example where
-0000d890: 2061 2072 6567 696f 6e20 6f66 2074 6865   a region of the
-0000d8a0: 2067 656e 6f6d 6520 6c61 636b 7320 616e   genome lacks an
-0000d8b0: 7920 616e 6365 7374 7261 6c20 696e 666f  y ancestral info
-0000d8c0: 726d 6174 696f 6e2c 0a20 2020 2020 2020  rmation,.       
-0000d8d0: 2020 2020 2074 6865 7265 2063 616e 2062       there can b
-0000d8e0: 6520 6120 7665 7279 206c 6172 6765 206e  e a very large n
-0000d8f0: 756d 6265 7220 6f66 2072 6f6f 7473 2c20  umber of roots, 
-0000d900: 706f 7465 6e74 6961 6c6c 7920 616c 6c20  potentially all 
-0000d910: 7468 6520 7361 6d70 6c65 730a 2020 2020  the samples.    
-0000d920: 2020 2020 2020 2020 696e 2074 6865 2074          in the t
-0000d930: 7265 6520 7365 7175 656e 6365 2e0a 0a20  ree sequence... 
-0000d940: 2020 2020 2020 203a 7265 7475 726e 3a20         :return: 
-0000d950: 5468 6520 6c69 7374 206f 6620 726f 6f74  The list of root
-0000d960: 7320 696e 2074 6869 7320 7472 6565 2e0a  s in this tree..
-0000d970: 2020 2020 2020 2020 3a72 7479 7065 3a20          :rtype: 
-0000d980: 6c69 7374 0a20 2020 2020 2020 2022 2222  list.        """
-0000d990: 0a20 2020 2020 2020 2072 6f6f 7473 203d  .        roots =
-0000d9a0: 205b 5d0a 2020 2020 2020 2020 7520 3d20   [].        u = 
-0000d9b0: 7365 6c66 2e6c 6566 745f 726f 6f74 0a20  self.left_root. 
-0000d9c0: 2020 2020 2020 2077 6869 6c65 2075 2021         while u !
-0000d9d0: 3d20 4e55 4c4c 3a0a 2020 2020 2020 2020  = NULL:.        
-0000d9e0: 2020 2020 726f 6f74 732e 6170 7065 6e64      roots.append
-0000d9f0: 2875 290a 2020 2020 2020 2020 2020 2020  (u).            
-0000da00: 7520 3d20 7365 6c66 2e72 6967 6874 5f73  u = self.right_s
-0000da10: 6962 2875 290a 2020 2020 2020 2020 7265  ib(u).        re
-0000da20: 7475 726e 2072 6f6f 7473 0a0a 2020 2020  turn roots..    
-0000da30: 6465 6620 6765 745f 726f 6f74 2873 656c  def get_root(sel
-0000da40: 6629 3a0a 2020 2020 2020 2020 2320 4465  f):.        # De
-0000da50: 7072 6563 6174 6564 2061 6c69 6173 2066  precated alias f
-0000da60: 6f72 2073 656c 662e 726f 6f74 0a20 2020  or self.root.   
-0000da70: 2020 2020 2072 6574 7572 6e20 7365 6c66       return self
-0000da80: 2e72 6f6f 740a 0a20 2020 2040 7072 6f70  .root..    @prop
-0000da90: 6572 7479 0a20 2020 2064 6566 2072 6f6f  erty.    def roo
-0000daa0: 7428 7365 6c66 293a 0a20 2020 2020 2020  t(self):.       
-0000dab0: 2022 2222 0a20 2020 2020 2020 2054 6865   """.        The
-0000dac0: 2072 6f6f 7420 6f66 2074 6869 7320 7472   root of this tr
-0000dad0: 6565 2e20 4966 2074 6865 2074 7265 6520  ee. If the tree 
-0000dae0: 636f 6e74 6169 6e73 206d 756c 7469 706c  contains multipl
-0000daf0: 6520 726f 6f74 732c 2061 2056 616c 7565  e roots, a Value
-0000db00: 4572 726f 7220 6973 0a20 2020 2020 2020  Error is.       
-0000db10: 2072 6169 7365 6420 696e 6469 6361 7469   raised indicati
-0000db20: 6e67 2074 6861 7420 7468 6520 3a61 7474  ng that the :att
-0000db30: 723a 607e 5472 6565 2e72 6f6f 7473 6020  r:`~Tree.roots` 
-0000db40: 6174 7472 6962 7574 6520 7368 6f75 6c64  attribute should
-0000db50: 2062 6520 7573 6564 2069 6e73 7465 6164   be used instead
-0000db60: 2e0a 0a20 2020 2020 2020 203a 7265 7475  ...        :retu
-0000db70: 726e 3a20 5468 6520 726f 6f74 206e 6f64  rn: The root nod
-0000db80: 652e 0a20 2020 2020 2020 203a 7274 7970  e..        :rtyp
-0000db90: 653a 2069 6e74 0a20 2020 2020 2020 203a  e: int.        :
-0000dba0: 7261 6973 6573 3a20 3a63 6c61 7373 3a60  raises: :class:`
-0000dbb0: 5661 6c75 6545 7272 6f72 6020 6966 2074  ValueError` if t
-0000dbc0: 6869 7320 7472 6565 2063 6f6e 7461 696e  his tree contain
-0000dbd0: 7320 6d6f 7265 2074 6861 6e20 6f6e 6520  s more than one 
-0000dbe0: 726f 6f74 2e0a 2020 2020 2020 2020 2222  root..        ""
-0000dbf0: 220a 2020 2020 2020 2020 6966 2073 656c  ".        if sel
-0000dc00: 662e 6861 735f 6d75 6c74 6970 6c65 5f72  f.has_multiple_r
-0000dc10: 6f6f 7473 3a0a 2020 2020 2020 2020 2020  oots:.          
-0000dc20: 2020 7261 6973 6520 5661 6c75 6545 7272    raise ValueErr
-0000dc30: 6f72 2822 4d6f 7265 2074 6861 6e20 6f6e  or("More than on
-0000dc40: 6520 726f 6f74 2065 7869 7374 732e 2055  e root exists. U
-0000dc50: 7365 2074 7265 652e 726f 6f74 7320 696e  se tree.roots in
-0000dc60: 7374 6561 6422 290a 2020 2020 2020 2020  stead").        
-0000dc70: 7265 7475 726e 2073 656c 662e 6c65 6674  return self.left
-0000dc80: 5f72 6f6f 740a 0a20 2020 2064 6566 2069  _root..    def i
-0000dc90: 735f 726f 6f74 2873 656c 662c 2075 2920  s_root(self, u) 
-0000dca0: 2d3e 2062 6f6f 6c3a 0a20 2020 2020 2020  -> bool:.       
-0000dcb0: 2022 2222 0a20 2020 2020 2020 2052 6574   """.        Ret
-0000dcc0: 7572 6e73 2060 6054 7275 6560 6020 6966  urns ``True`` if
-0000dcd0: 2074 6865 2073 7065 6369 6669 6564 206e   the specified n
-0000dce0: 6f64 6520 6973 2061 2072 6f6f 7420 696e  ode is a root in
-0000dcf0: 2074 6869 7320 7472 6565 2028 7365 650a   this tree (see.
-0000dd00: 2020 2020 2020 2020 3a61 7474 723a 607e          :attr:`~
-0000dd10: 5472 6565 2e72 6f6f 7473 6020 666f 7220  Tree.roots` for 
-0000dd20: 7468 6520 6465 6669 6e69 7469 6f6e 206f  the definition o
-0000dd30: 6620 6120 726f 6f74 292e 2054 6869 7320  f a root). This 
-0000dd40: 6973 2065 7861 6374 6c79 2065 7175 6976  is exactly equiv
-0000dd50: 616c 656e 7420 746f 0a20 2020 2020 2020  alent to.       
-0000dd60: 2066 696e 6469 6e67 2074 6865 206e 6f64   finding the nod
-0000dd70: 6520 4944 2069 6e20 3a61 7474 723a 607e  e ID in :attr:`~
-0000dd80: 5472 6565 2e72 6f6f 7473 602c 2062 7574  Tree.roots`, but
-0000dd90: 2069 7320 6d6f 7265 2065 6666 6963 6965   is more efficie
-0000dda0: 6e74 2066 6f72 2074 7265 6573 0a20 2020  nt for trees.   
-0000ddb0: 2020 2020 2077 6974 6820 6c61 7267 6520       with large 
-0000ddc0: 6e75 6d62 6572 7320 6f66 2072 6f6f 7473  numbers of roots
-0000ddd0: 2c20 7375 6368 2061 7320 696e 2072 6567  , such as in reg
-0000dde0: 696f 6e73 2077 6974 6820 6578 7465 6e73  ions with extens
-0000ddf0: 6976 650a 2020 2020 2020 2020 3a72 6566  ive.        :ref
-0000de00: 3a60 7365 635f 6461 7461 5f6d 6f64 656c  :`sec_data_model
-0000de10: 5f6d 6973 7369 6e67 5f64 6174 6160 2e20  _missing_data`. 
-0000de20: 204e 6f74 6520 7468 6174 2060 6046 616c   Note that ``Fal
-0000de30: 7365 6060 2069 7320 7265 7475 726e 6564  se`` is returned
-0000de40: 2066 6f72 2061 6c6c 0a20 2020 2020 2020   for all.       
-0000de50: 206f 7468 6572 206e 6f64 6573 2c20 696e   other nodes, in
-0000de60: 636c 7564 696e 6720 3a72 6566 3a60 6973  cluding :ref:`is
-0000de70: 6f6c 6174 6564 3c73 6563 5f64 6174 615f  olated<sec_data_
-0000de80: 6d6f 6465 6c5f 7472 6565 5f69 736f 6c61  model_tree_isola
-0000de90: 7465 645f 6e6f 6465 733e 600a 2020 2020  ted_nodes>`.    
-0000dea0: 2020 2020 6e6f 6e2d 7361 6d70 6c65 206e      non-sample n
-0000deb0: 6f64 6573 2077 6869 6368 2061 7265 206e  odes which are n
-0000dec0: 6f74 2066 6f75 6e64 2069 6e20 7468 6520  ot found in the 
-0000ded0: 746f 706f 6c6f 6779 206f 6620 7468 6520  topology of the 
-0000dee0: 6375 7272 656e 7420 7472 6565 2e0a 0a20  current tree... 
-0000def0: 2020 2020 2020 203a 7061 7261 6d20 696e         :param in
-0000df00: 7420 753a 2054 6865 206e 6f64 6520 6f66  t u: The node of
-0000df10: 2069 6e74 6572 6573 742e 0a20 2020 2020   interest..     
-0000df20: 2020 203a 7265 7475 726e 3a20 6060 5472     :return: ``Tr
-0000df30: 7565 6060 2069 6620 7520 6973 2061 2072  ue`` if u is a r
-0000df40: 6f6f 742e 0a20 2020 2020 2020 2022 2222  oot..        """
-0000df50: 0a20 2020 2020 2020 2072 6574 7572 6e20  .        return 
-0000df60: 280a 2020 2020 2020 2020 2020 2020 7365  (.            se
-0000df70: 6c66 2e6e 756d 5f73 616d 706c 6573 2875  lf.num_samples(u
-0000df80: 2920 3e3d 2073 656c 662e 726f 6f74 5f74  ) >= self.root_t
-0000df90: 6872 6573 686f 6c64 2061 6e64 2073 656c  hreshold and sel
-0000dfa0: 662e 7061 7265 6e74 2875 2920 3d3d 2074  f.parent(u) == t
-0000dfb0: 736b 6974 2e4e 554c 4c0a 2020 2020 2020  skit.NULL.      
-0000dfc0: 2020 290a 0a20 2020 2064 6566 2067 6574    )..    def get
-0000dfd0: 5f69 6e64 6578 2873 656c 6629 3a0a 2020  _index(self):.  
-0000dfe0: 2020 2020 2020 2320 4465 7072 6563 6174        # Deprecat
-0000dff0: 6564 2061 6c69 6173 2066 6f72 2073 656c  ed alias for sel
-0000e000: 662e 696e 6465 780a 2020 2020 2020 2020  f.index.        
-0000e010: 7265 7475 726e 2073 656c 662e 696e 6465  return self.inde
-0000e020: 780a 0a20 2020 2040 7072 6f70 6572 7479  x..    @property
-0000e030: 0a20 2020 2064 6566 2069 6e64 6578 2873  .    def index(s
-0000e040: 656c 6629 3a0a 2020 2020 2020 2020 2222  elf):.        ""
-0000e050: 220a 2020 2020 2020 2020 5265 7475 726e  ".        Return
-0000e060: 7320 7468 6520 696e 6465 7820 7468 6973  s the index this
-0000e070: 2074 7265 6520 6f63 6375 7069 6573 2069   tree occupies i
-0000e080: 6e20 7468 6520 7061 7265 6e74 2074 7265  n the parent tre
-0000e090: 6520 7365 7175 656e 6365 2e0a 2020 2020  e sequence..    
-0000e0a0: 2020 2020 5468 6973 2069 6e64 6578 2069      This index i
-0000e0b0: 7320 7a65 726f 2062 6173 6564 2c20 736f  s zero based, so
-0000e0c0: 2074 6865 2066 6972 7374 2074 7265 6520   the first tree 
-0000e0d0: 696e 2074 6865 2073 6571 7565 6e63 6520  in the sequence 
-0000e0e0: 6861 7320 696e 6465 7820 302e 0a0a 2020  has index 0...  
-0000e0f0: 2020 2020 2020 3a72 6574 7572 6e3a 2054        :return: T
-0000e100: 6865 2069 6e64 6578 206f 6620 7468 6973  he index of this
-0000e110: 2074 7265 652e 0a20 2020 2020 2020 203a   tree..        :
-0000e120: 7274 7970 653a 2069 6e74 0a20 2020 2020  rtype: int.     
-0000e130: 2020 2022 2222 0a20 2020 2020 2020 2072     """.        r
-0000e140: 6574 7572 6e20 7365 6c66 2e5f 6c6c 5f74  eturn self._ll_t
-0000e150: 7265 652e 6765 745f 696e 6465 7828 290a  ree.get_index().
-0000e160: 0a20 2020 2064 6566 2067 6574 5f69 6e74  .    def get_int
-0000e170: 6572 7661 6c28 7365 6c66 293a 0a20 2020  erval(self):.   
-0000e180: 2020 2020 2023 2044 6570 7265 6361 7465       # Deprecate
-0000e190: 6420 616c 6961 7320 666f 7220 7365 6c66  d alias for self
-0000e1a0: 2e69 6e74 6572 7661 6c0a 2020 2020 2020  .interval.      
-0000e1b0: 2020 7265 7475 726e 2073 656c 662e 696e    return self.in
-0000e1c0: 7465 7276 616c 0a0a 2020 2020 4070 726f  terval..    @pro
-0000e1d0: 7065 7274 790a 2020 2020 6465 6620 696e  perty.    def in
-0000e1e0: 7465 7276 616c 2873 656c 6629 3a0a 2020  terval(self):.  
-0000e1f0: 2020 2020 2020 2222 220a 2020 2020 2020        """.      
-0000e200: 2020 5265 7475 726e 7320 7468 6520 636f    Returns the co
-0000e210: 6f72 6469 6e61 7465 7320 6f66 2074 6865  ordinates of the
-0000e220: 2067 656e 6f6d 6963 2069 6e74 6572 7661   genomic interva
-0000e230: 6c20 7468 6174 2074 6869 7320 7472 6565  l that this tree
-0000e240: 0a20 2020 2020 2020 2072 6570 7265 7365  .        represe
-0000e250: 6e74 7320 7468 6520 6869 7374 6f72 7920  nts the history 
-0000e260: 6f66 2e20 5468 6520 696e 7465 7276 616c  of. The interval
-0000e270: 2069 7320 7265 7475 726e 6564 2061 7320   is returned as 
-0000e280: 6120 7475 706c 650a 2020 2020 2020 2020  a tuple.        
-0000e290: 3a6d 6174 683a 6028 6c2c 2072 2960 2061  :math:`(l, r)` a
-0000e2a0: 6e64 2069 7320 6120 6861 6c66 2d6f 7065  nd is a half-ope
-0000e2b0: 6e20 696e 7465 7276 616c 2073 7563 6820  n interval such 
-0000e2c0: 7468 6174 2074 6865 206c 6566 740a 2020  that the left.  
-0000e2d0: 2020 2020 2020 636f 6f72 6469 6e61 7465        coordinate
-0000e2e0: 2069 7320 696e 636c 7573 6976 6520 616e   is inclusive an
-0000e2f0: 6420 7468 6520 7269 6768 7420 636f 6f72  d the right coor
-0000e300: 6469 6e61 7465 2069 7320 6578 636c 7573  dinate is exclus
-0000e310: 6976 652e 2054 6869 730a 2020 2020 2020  ive. This.      
-0000e320: 2020 7472 6565 2074 6865 7265 666f 7265    tree therefore
-0000e330: 2061 7070 6c69 6573 2074 6f20 616c 6c20   applies to all 
-0000e340: 6765 6e6f 6d69 6320 6c6f 6361 7469 6f6e  genomic location
-0000e350: 7320 3a6d 6174 683a 6078 6020 7375 6368  s :math:`x` such
-0000e360: 2074 6861 740a 2020 2020 2020 2020 3a6d   that.        :m
-0000e370: 6174 683a 606c 205c 5c6c 6571 2078 203c  ath:`l \\leq x <
-0000e380: 2072 602e 0a0a 2020 2020 2020 2020 3a72   r`...        :r
-0000e390: 6574 7572 6e3a 2041 206e 616d 6564 2074  eturn: A named t
-0000e3a0: 7570 6c65 2028 6c2c 2072 2920 7265 7072  uple (l, r) repr
-0000e3b0: 6573 656e 7469 6e67 2074 6865 206c 6566  esenting the lef
-0000e3c0: 742d 6d6f 7374 2028 696e 636c 7573 6976  t-most (inclusiv
-0000e3d0: 6529 0a20 2020 2020 2020 2020 2020 2061  e).            a
-0000e3e0: 6e64 2072 6967 6874 2d6d 6f73 7420 2865  nd right-most (e
-0000e3f0: 7863 6c75 7369 7665 2920 636f 6f72 6469  xclusive) coordi
-0000e400: 6e61 7465 7320 6f66 2074 6865 2067 656e  nates of the gen
-0000e410: 6f6d 6963 2072 6567 696f 6e0a 2020 2020  omic region.    
-0000e420: 2020 2020 2020 2020 636f 7665 7265 6420          covered 
-0000e430: 6279 2074 6869 7320 7472 6565 2e20 5468  by this tree. Th
-0000e440: 6520 636f 6f72 6469 6e61 7465 7320 6361  e coordinates ca
-0000e450: 6e20 6265 2061 6363 6573 7365 6420 6279  n be accessed by
-0000e460: 2069 6e64 6578 0a20 2020 2020 2020 2020   index.         
-0000e470: 2020 2028 6060 3060 6020 6f72 2060 6031     (``0`` or ``1
-0000e480: 6060 2920 6f72 2065 7175 6976 616c 656e  ``) or equivalen
-0000e490: 746c 7920 6279 206e 616d 6520 2860 602e  tly by name (``.
-0000e4a0: 6c65 6674 6060 206f 7220 6060 2e72 6967  left`` or ``.rig
-0000e4b0: 6874 6060 290a 2020 2020 2020 2020 3a72  ht``).        :r
-0000e4c0: 7479 7065 3a20 496e 7465 7276 616c 0a20  type: Interval. 
-0000e4d0: 2020 2020 2020 2022 2222 0a20 2020 2020         """.     
-0000e4e0: 2020 2072 6574 7572 6e20 496e 7465 7276     return Interv
-0000e4f0: 616c 2873 656c 662e 5f6c 6c5f 7472 6565  al(self._ll_tree
-0000e500: 2e67 6574 5f6c 6566 7428 292c 2073 656c  .get_left(), sel
-0000e510: 662e 5f6c 6c5f 7472 6565 2e67 6574 5f72  f._ll_tree.get_r
-0000e520: 6967 6874 2829 290a 0a20 2020 2064 6566  ight())..    def
-0000e530: 2067 6574 5f6c 656e 6774 6828 7365 6c66   get_length(self
-0000e540: 293a 0a20 2020 2020 2020 2023 2044 6570  ):.        # Dep
-0000e550: 7265 6361 7465 6420 616c 6961 7320 666f  recated alias fo
-0000e560: 7220 7365 6c66 2e73 7061 6e0a 2020 2020  r self.span.    
-0000e570: 2020 2020 7265 7475 726e 2073 656c 662e      return self.
-0000e580: 6c65 6e67 7468 0a0a 2020 2020 4070 726f  length..    @pro
-0000e590: 7065 7274 790a 2020 2020 6465 6620 6c65  perty.    def le
-0000e5a0: 6e67 7468 2873 656c 6629 3a0a 2020 2020  ngth(self):.    
-0000e5b0: 2020 2020 2320 4465 7072 6563 6174 6564      # Deprecated
-0000e5c0: 2061 6c69 6173 2066 6f72 2073 656c 662e   alias for self.
-0000e5d0: 7370 616e 0a20 2020 2020 2020 2072 6574  span.        ret
-0000e5e0: 7572 6e20 7365 6c66 2e73 7061 6e0a 0a20  urn self.span.. 
-0000e5f0: 2020 2040 7072 6f70 6572 7479 0a20 2020     @property.   
-0000e600: 2064 6566 2073 7061 6e28 7365 6c66 293a   def span(self):
-0000e610: 0a20 2020 2020 2020 2022 2222 0a20 2020  .        """.   
-0000e620: 2020 2020 2052 6574 7572 6e73 2074 6865       Returns the
-0000e630: 2067 656e 6f6d 6963 2064 6973 7461 6e63   genomic distanc
-0000e640: 6520 7468 6174 2074 6869 7320 7472 6565  e that this tree
-0000e650: 2073 7061 6e73 2e0a 2020 2020 2020 2020   spans..        
-0000e660: 5468 6973 2069 7320 6465 6669 6e65 6420  This is defined 
-0000e670: 6173 203a 6d61 7468 3a60 7220 2d20 6c60  as :math:`r - l`
-0000e680: 2c20 7768 6572 6520 3a6d 6174 683a 6028  , where :math:`(
-0000e690: 6c2c 2072 2960 2069 7320 7468 6520 6765  l, r)` is the ge
-0000e6a0: 6e6f 6d69 630a 2020 2020 2020 2020 696e  nomic.        in
-0000e6b0: 7465 7276 616c 2072 6574 7572 6e65 6420  terval returned 
-0000e6c0: 6279 203a 6174 7472 3a60 7e54 7265 652e  by :attr:`~Tree.
-0000e6d0: 696e 7465 7276 616c 602e 0a0a 2020 2020  interval`...    
-0000e6e0: 2020 2020 3a72 6574 7572 6e3a 2054 6865      :return: The
-0000e6f0: 2067 656e 6f6d 6963 2064 6973 7461 6e63   genomic distanc
-0000e700: 6520 636f 7665 7265 6420 6279 2074 6869  e covered by thi
-0000e710: 7320 7472 6565 2e0a 2020 2020 2020 2020  s tree..        
-0000e720: 3a72 7479 7065 3a20 666c 6f61 740a 2020  :rtype: float.  
-0000e730: 2020 2020 2020 2222 220a 2020 2020 2020        """.      
-0000e740: 2020 7265 7475 726e 2073 656c 662e 696e    return self.in
-0000e750: 7465 7276 616c 2e73 7061 6e0a 0a20 2020  terval.span..   
-0000e760: 2064 6566 2067 6574 5f73 616d 706c 655f   def get_sample_
-0000e770: 7369 7a65 2873 656c 6629 3a0a 2020 2020  size(self):.    
-0000e780: 2020 2020 2320 4465 7072 6563 6174 6564      # Deprecated
-0000e790: 2061 6c69 6173 2066 6f72 2073 656c 662e   alias for self.
-0000e7a0: 7361 6d70 6c65 5f73 697a 650a 2020 2020  sample_size.    
-0000e7b0: 2020 2020 7265 7475 726e 2073 656c 662e      return self.
-0000e7c0: 7361 6d70 6c65 5f73 697a 650a 0a20 2020  sample_size..   
-0000e7d0: 2040 7072 6f70 6572 7479 0a20 2020 2064   @property.    d
-0000e7e0: 6566 2073 616d 706c 655f 7369 7a65 2873  ef sample_size(s
-0000e7f0: 656c 6629 3a0a 2020 2020 2020 2020 2320  elf):.        # 
-0000e800: 4465 6c69 6265 7261 7465 6c79 2075 6e64  Deliberately und
-0000e810: 6f63 756d 656e 7465 6420 6275 7420 6b65  ocumented but ke
-0000e820: 7074 2066 6f72 2062 6163 6b77 6172 6473  pt for backwards
-0000e830: 2063 6f6d 7061 7469 6269 6c69 7479 2e0a   compatibility..
-0000e840: 2020 2020 2020 2020 2320 5468 6520 7072          # The pr
-0000e850: 6f70 6572 2077 6179 2074 6f20 6163 6365  oper way to acce
-0000e860: 7373 2074 6869 7320 6973 2076 6961 2074  ss this is via t
-0000e870: 7265 652e 7472 6565 5f73 6571 7565 6e63  ree.tree_sequenc
-0000e880: 652e 6e75 6d5f 7361 6d70 6c65 730a 2020  e.num_samples.  
-0000e890: 2020 2020 2020 7265 7475 726e 2073 656c        return sel
-0000e8a0: 662e 5f6c 6c5f 7472 6565 2e67 6574 5f73  f._ll_tree.get_s
-0000e8b0: 616d 706c 655f 7369 7a65 2829 0a0a 2020  ample_size()..  
-0000e8c0: 2020 6465 6620 6472 6177 5f74 6578 7428    def draw_text(
-0000e8d0: 0a20 2020 2020 2020 2073 656c 662c 0a20  .        self,. 
-0000e8e0: 2020 2020 2020 206f 7269 656e 7461 7469         orientati
-0000e8f0: 6f6e 3d4e 6f6e 652c 0a20 2020 2020 2020  on=None,.       
-0000e900: 202a 2c0a 2020 2020 2020 2020 6e6f 6465   *,.        node
-0000e910: 5f6c 6162 656c 733d 4e6f 6e65 2c0a 2020  _labels=None,.  
-0000e920: 2020 2020 2020 6d61 785f 7469 6d65 3d4e        max_time=N
-0000e930: 6f6e 652c 0a20 2020 2020 2020 2075 7365  one,.        use
-0000e940: 5f61 7363 6969 3d46 616c 7365 2c0a 2020  _ascii=False,.  
-0000e950: 2020 2020 2020 6f72 6465 723d 4e6f 6e65        order=None
-0000e960: 2c0a 2020 2020 293a 0a20 2020 2020 2020  ,.    ):.       
-0000e970: 2022 2222 0a20 2020 2020 2020 2043 7265   """.        Cre
-0000e980: 6174 6520 6120 7465 7874 2072 6570 7265  ate a text repre
-0000e990: 7365 6e74 6174 696f 6e20 6f66 2061 2074  sentation of a t
-0000e9a0: 7265 652e 0a0a 2020 2020 2020 2020 3a70  ree...        :p
-0000e9b0: 6172 616d 2073 7472 206f 7269 656e 7461  aram str orienta
-0000e9c0: 7469 6f6e 3a20 6f6e 6520 6f66 2060 6022  tion: one of ``"
-0000e9d0: 746f 7022 6060 2c20 6060 226c 6566 7422  top"``, ``"left"
-0000e9e0: 6060 2c20 6060 2262 6f74 746f 6d22 6060  ``, ``"bottom"``
-0000e9f0: 2c20 6f72 0a20 2020 2020 2020 2020 2020  , or.           
-0000ea00: 2060 6022 7269 6768 7422 6060 2c20 7370   ``"right"``, sp
-0000ea10: 6563 6966 7969 6e67 2074 6865 206d 6172  ecifying the mar
-0000ea20: 6769 6e20 6f6e 2077 6869 6368 2074 6865  gin on which the
-0000ea30: 2072 6f6f 7420 6973 2070 6c61 6365 642e   root is placed.
-0000ea40: 2053 7065 6369 6679 696e 670a 2020 2020   Specifying.    
-0000ea50: 2020 2020 2020 2020 6060 226c 6566 7422          ``"left"
-0000ea60: 6060 206f 7220 6060 2272 6967 6874 2260  `` or ``"right"`
-0000ea70: 6020 7769 6c6c 206c 6561 6420 746f 2074  ` will lead to t
-0000ea80: 696d 6520 6265 696e 6720 7368 6f77 6e20  ime being shown 
-0000ea90: 6f6e 2074 6865 2078 2061 7869 7320 2869  on the x axis (i
-0000eaa0: 2e65 2e0a 2020 2020 2020 2020 2020 2020  .e..            
-0000eab0: 6120 2268 6f72 697a 6f6e 7461 6c22 2074  a "horizontal" t
-0000eac0: 7265 652e 2049 6620 6060 4e6f 6e65 6060  ree. If ``None``
-0000ead0: 2028 6465 6661 756c 7429 2075 7365 2074   (default) use t
-0000eae0: 6865 2073 7461 6e64 6172 6420 636f 616c  he standard coal
-0000eaf0: 6573 6365 6e74 0a20 2020 2020 2020 2020  escent.         
-0000eb00: 2020 2061 7272 616e 6765 6d65 6e74 206f     arrangement o
-0000eb10: 6620 6120 7665 7274 6963 616c 2074 7265  f a vertical tre
-0000eb20: 6520 7769 7468 2072 6563 656e 7420 6e6f  e with recent no
-0000eb30: 6465 7320 6174 2074 6865 2062 6f74 746f  des at the botto
-0000eb40: 6d20 6f66 2074 6865 2070 6c6f 740a 2020  m of the plot.  
-0000eb50: 2020 2020 2020 2020 2020 616e 6420 6f6c            and ol
-0000eb60: 6465 7220 6e6f 6465 7320 6162 6f76 652e  der nodes above.
-0000eb70: 0a20 2020 2020 2020 203a 7061 7261 6d20  .        :param 
-0000eb80: 6469 6374 206e 6f64 655f 6c61 6265 6c73  dict node_labels
-0000eb90: 3a20 4966 2073 7065 6369 6669 6564 2c20  : If specified, 
-0000eba0: 7368 6f77 2063 7573 746f 6d20 6c61 6265  show custom labe
-0000ebb0: 6c73 2066 6f72 2074 6865 206e 6f64 6573  ls for the nodes
-0000ebc0: 0a20 2020 2020 2020 2020 2020 2074 6861  .            tha
-0000ebd0: 7420 6172 6520 7072 6573 656e 7420 696e  t are present in
-0000ebe0: 2074 6865 206d 6170 2e20 416e 7920 6e6f   the map. Any no
-0000ebf0: 6465 7320 6e6f 7420 7370 6563 6966 6965  des not specifie
-0000ec00: 6420 696e 2074 6865 206d 6170 2077 696c  d in the map wil
-0000ec10: 6c0a 2020 2020 2020 2020 2020 2020 6e6f  l.            no
-0000ec20: 7420 6861 7665 2061 206e 6f64 6520 6c61  t have a node la
-0000ec30: 6265 6c2e 0a20 2020 2020 2020 203a 7061  bel..        :pa
-0000ec40: 7261 6d20 7374 7220 6d61 785f 7469 6d65  ram str max_time
-0000ec50: 3a20 4966 2065 7175 616c 2074 6f20 6060  : If equal to ``
-0000ec60: 2274 7265 6522 6060 2028 7468 6520 6465  "tree"`` (the de
-0000ec70: 6661 756c 7429 2c20 7468 6520 6d61 7869  fault), the maxi
-0000ec80: 6d75 6d20 7469 6d65 0a20 2020 2020 2020  mum time.       
-0000ec90: 2020 2020 2069 7320 7365 7420 746f 2062       is set to b
-0000eca0: 6520 7468 6174 206f 6620 7468 6520 6f6c  e that of the ol
-0000ecb0: 6465 7374 2072 6f6f 7420 696e 2074 6865  dest root in the
-0000ecc0: 2074 7265 652e 2049 6620 6571 7561 6c20   tree. If equal 
-0000ecd0: 746f 2060 6022 7473 2260 6020 7468 650a  to ``"ts"`` the.
-0000ece0: 2020 2020 2020 2020 2020 2020 6d61 7869              maxi
-0000ecf0: 6d75 6d20 7469 6d65 2069 7320 7365 7420  mum time is set 
-0000ed00: 746f 2062 6520 7468 6520 7469 6d65 206f  to be the time o
-0000ed10: 6620 7468 6520 6f6c 6465 7374 2072 6f6f  f the oldest roo
-0000ed20: 7420 696e 2074 6865 2074 7265 650a 2020  t in the tree.  
-0000ed30: 2020 2020 2020 2020 2020 7365 7175 656e            sequen
-0000ed40: 6365 3b20 7468 6973 2069 7320 7573 6566  ce; this is usef
-0000ed50: 756c 2077 6865 6e20 6472 6177 696e 6720  ul when drawing 
-0000ed60: 7472 6565 7320 6672 6f6d 2074 6865 2073  trees from the s
-0000ed70: 616d 6520 7472 6565 2073 6571 7565 6e63  ame tree sequenc
-0000ed80: 6520 6173 2069 740a 2020 2020 2020 2020  e as it.        
-0000ed90: 2020 2020 656e 7375 7265 7320 7468 6174      ensures that
-0000eda0: 206e 6f64 6520 6865 6967 6874 7320 6172   node heights ar
-0000edb0: 6520 636f 6e73 6973 7465 6e74 2e0a 2020  e consistent..  
-0000edc0: 2020 2020 2020 3a70 6172 616d 2062 6f6f        :param boo
-0000edd0: 6c20 7573 655f 6173 6369 693a 2049 6620  l use_ascii: If 
-0000ede0: 6060 4661 6c73 6560 6020 2864 6566 6175  ``False`` (defau
-0000edf0: 6c74 2920 7468 656e 2075 7365 2075 6e69  lt) then use uni
-0000ee00: 636f 6465 0a20 2020 2020 2020 2020 2020  code.           
-0000ee10: 2060 626f 7820 6472 6177 696e 6720 6368   `box drawing ch
-0000ee20: 6172 6163 7465 7273 205c 0a3c 6874 7470  aracters \.<http
-0000ee30: 733a 2f2f 656e 2e77 696b 6970 6564 6961  s://en.wikipedia
-0000ee40: 2e6f 7267 2f77 696b 692f 426f 782d 6472  .org/wiki/Box-dr
-0000ee50: 6177 696e 675f 6368 6172 6163 7465 723e  awing_character>
-0000ee60: 605f 0a20 2020 2020 2020 2020 2020 2074  `_.            t
-0000ee70: 6f20 7265 6e64 6572 2074 6865 2074 7265  o render the tre
-0000ee80: 652e 2049 6620 6060 5472 7565 6060 2c20  e. If ``True``, 
-0000ee90: 7573 6520 706c 6169 6e20 6173 6369 6920  use plain ascii 
-0000eea0: 6368 6172 6163 7465 7273 2c20 7768 6963  characters, whic
-0000eeb0: 6820 6c6f 6f6b 0a20 2020 2020 2020 2020  h look.         
-0000eec0: 2020 2063 7275 6465 7220 6275 7420 6172     cruder but ar
-0000eed0: 6520 6c65 7373 2073 7573 6365 7074 6962  e less susceptib
-0000eee0: 6c65 2074 6f20 6d69 7361 6c69 676e 6d65  le to misalignme
-0000eef0: 6e74 206f 7220 666f 6e74 2073 7562 7374  nt or font subst
-0000ef00: 6974 7574 696f 6e2e 0a20 2020 2020 2020  itution..       
-0000ef10: 2020 2020 2041 6c74 6572 6e61 7469 7665       Alternative
-0000ef20: 6c79 2c20 6966 2079 6f75 2061 7265 2068  ly, if you are h
-0000ef30: 6176 696e 6720 616c 6967 6e6d 656e 7420  aving alignment 
-0000ef40: 7072 6f62 6c65 6d73 2077 6974 6820 556e  problems with Un
-0000ef50: 6963 6f64 652c 2079 6f75 2063 616e 2074  icode, you can t
-0000ef60: 7279 0a20 2020 2020 2020 2020 2020 206f  ry.            o
-0000ef70: 7574 2074 6865 2073 6f6c 7574 696f 6e20  ut the solution 
-0000ef80: 646f 6375 6d65 6e74 6564 2060 6865 7265  documented `here
-0000ef90: 205c 0a3c 6874 7470 733a 2f2f 6769 7468   \.<https://gith
-0000efa0: 7562 2e63 6f6d 2f74 736b 6974 2d64 6576  ub.com/tskit-dev
-0000efb0: 2f74 736b 6974 2f69 7373 7565 732f 3138  /tskit/issues/18
-0000efc0: 3923 6973 7375 6563 6f6d 6d65 6e74 2d34  9#issuecomment-4
-0000efd0: 3939 3131 3438 3131 3e60 5f2e 0a20 2020  99114811>`_..   
-0000efe0: 2020 2020 203a 7061 7261 6d20 7374 7220       :param str 
-0000eff0: 6f72 6465 723a 2054 6865 206c 6566 742d  order: The left-
-0000f000: 746f 2d72 6967 6874 206f 7264 6572 696e  to-right orderin
-0000f010: 6720 6f66 2063 6869 6c64 206e 6f64 6573  g of child nodes
-0000f020: 2069 6e20 7468 6520 6472 6177 6e20 7472   in the drawn tr
-0000f030: 6565 2e0a 2020 2020 2020 2020 2020 2020  ee..            
-0000f040: 5468 6973 2063 616e 2062 6520 6569 7468  This can be eith
-0000f050: 6572 3a20 6060 226d 696e 6c65 7822 6060  er: ``"minlex"``
-0000f060: 2c20 7768 6963 6820 6d69 6e69 6d69 7365  , which minimise
-0000f070: 7320 7468 6520 6469 6666 6572 656e 6365  s the difference
-0000f080: 730a 2020 2020 2020 2020 2020 2020 6265  s.            be
-0000f090: 7477 6565 6e20 6164 6a61 6365 6e74 2074  tween adjacent t
-0000f0a0: 7265 6573 2028 7365 6520 616c 736f 2074  rees (see also t
-0000f0b0: 6865 2060 6022 6d69 6e6c 6578 5f70 6f73  he ``"minlex_pos
-0000f0c0: 746f 7264 6572 2260 6020 7472 6176 6572  torder"`` traver
-0000f0d0: 7361 6c0a 2020 2020 2020 2020 2020 2020  sal.            
-0000f0e0: 6f72 6465 7220 666f 7220 7468 6520 3a6d  order for the :m
-0000f0f0: 6574 683a 602e 6e6f 6465 7360 206d 6574  eth:`.nodes` met
-0000f100: 686f 6429 3b20 6f72 2060 6022 7472 6565  hod); or ``"tree
-0000f110: 2260 6020 7768 6963 6820 6472 6177 7320  "`` which draws 
-0000f120: 7472 6565 730a 2020 2020 2020 2020 2020  trees.          
-0000f130: 2020 696e 2074 6865 206c 6566 742d 746f    in the left-to
-0000f140: 2d72 6967 6874 206f 7264 6572 2064 6566  -right order def
-0000f150: 696e 6564 2062 7920 7468 650a 2020 2020  ined by the.    
-0000f160: 2020 2020 2020 2020 3a72 6566 3a60 7175          :ref:`qu
-0000f170: 696e 7475 706c 7920 6c69 6e6b 6564 2074  intuply linked t
-0000f180: 7265 6520 7374 7275 6374 7572 6520 3c73  ree structure <s
-0000f190: 6563 5f64 6174 615f 6d6f 6465 6c5f 7472  ec_data_model_tr
-0000f1a0: 6565 5f73 7472 7563 7475 7265 3e60 2e0a  ee_structure>`..
-0000f1b0: 2020 2020 2020 2020 2020 2020 4966 206e              If n
-0000f1c0: 6f74 2073 7065 6369 6669 6564 206f 7220  ot specified or 
-0000f1d0: 4e6f 6e65 2c20 7468 6973 2064 6566 6175  None, this defau
-0000f1e0: 6c74 7320 746f 2060 6022 6d69 6e6c 6578  lts to ``"minlex
-0000f1f0: 2260 602e 0a0a 2020 2020 2020 2020 3a72  "``...        :r
-0000f200: 6574 7572 6e3a 2041 2074 6578 7420 7265  eturn: A text re
-0000f210: 7072 6573 656e 7461 7469 6f6e 206f 6620  presentation of 
-0000f220: 6120 7472 6565 2e0a 2020 2020 2020 2020  a tree..        
-0000f230: 3a72 7479 7065 3a20 7374 720a 2020 2020  :rtype: str.    
-0000f240: 2020 2020 2222 220a 2020 2020 2020 2020      """.        
-0000f250: 6f72 6965 6e74 6174 696f 6e20 3d20 6472  orientation = dr
-0000f260: 6177 696e 672e 6368 6563 6b5f 6f72 6965  awing.check_orie
-0000f270: 6e74 6174 696f 6e28 6f72 6965 6e74 6174  ntation(orientat
-0000f280: 696f 6e29 0a20 2020 2020 2020 2069 6620  ion).        if 
-0000f290: 6f72 6965 6e74 6174 696f 6e20 696e 2028  orientation in (
-0000f2a0: 6472 6177 696e 672e 4c45 4654 2c20 6472  drawing.LEFT, dr
-0000f2b0: 6177 696e 672e 5249 4748 5429 3a0a 2020  awing.RIGHT):.  
-0000f2c0: 2020 2020 2020 2020 2020 7465 7874 5f74            text_t
-0000f2d0: 7265 6520 3d20 6472 6177 696e 672e 486f  ree = drawing.Ho
-0000f2e0: 7269 7a6f 6e74 616c 5465 7874 5472 6565  rizontalTextTree
-0000f2f0: 280a 2020 2020 2020 2020 2020 2020 2020  (.              
-0000f300: 2020 7365 6c66 2c0a 2020 2020 2020 2020    self,.        
-0000f310: 2020 2020 2020 2020 6f72 6965 6e74 6174          orientat
-0000f320: 696f 6e3d 6f72 6965 6e74 6174 696f 6e2c  ion=orientation,
-0000f330: 0a20 2020 2020 2020 2020 2020 2020 2020  .               
-0000f340: 206e 6f64 655f 6c61 6265 6c73 3d6e 6f64   node_labels=nod
-0000f350: 655f 6c61 6265 6c73 2c0a 2020 2020 2020  e_labels,.      
-0000f360: 2020 2020 2020 2020 2020 6d61 785f 7469            max_ti
-0000f370: 6d65 3d6d 6178 5f74 696d 652c 0a20 2020  me=max_time,.   
-0000f380: 2020 2020 2020 2020 2020 2020 2075 7365               use
-0000f390: 5f61 7363 6969 3d75 7365 5f61 7363 6969  _ascii=use_ascii
-0000f3a0: 2c0a 2020 2020 2020 2020 2020 2020 2020  ,.              
-0000f3b0: 2020 6f72 6465 723d 6f72 6465 722c 0a20    order=order,. 
-0000f3c0: 2020 2020 2020 2020 2020 2029 0a20 2020             ).   
-0000f3d0: 2020 2020 2065 6c73 653a 0a20 2020 2020       else:.     
-0000f3e0: 2020 2020 2020 2074 6578 745f 7472 6565         text_tree
-0000f3f0: 203d 2064 7261 7769 6e67 2e56 6572 7469   = drawing.Verti
-0000f400: 6361 6c54 6578 7454 7265 6528 0a20 2020  calTextTree(.   
-0000f410: 2020 2020 2020 2020 2020 2020 2073 656c               sel
-0000f420: 662c 0a20 2020 2020 2020 2020 2020 2020  f,.             
-0000f430: 2020 206f 7269 656e 7461 7469 6f6e 3d6f     orientation=o
-0000f440: 7269 656e 7461 7469 6f6e 2c0a 2020 2020  rientation,.    
-0000f450: 2020 2020 2020 2020 2020 2020 6e6f 6465              node
-0000f460: 5f6c 6162 656c 733d 6e6f 6465 5f6c 6162  _labels=node_lab
-0000f470: 656c 732c 0a20 2020 2020 2020 2020 2020  els,.           
-0000f480: 2020 2020 206d 6178 5f74 696d 653d 6d61       max_time=ma
-0000f490: 785f 7469 6d65 2c0a 2020 2020 2020 2020  x_time,.        
-0000f4a0: 2020 2020 2020 2020 7573 655f 6173 6369          use_asci
-0000f4b0: 693d 7573 655f 6173 6369 692c 0a20 2020  i=use_ascii,.   
-0000f4c0: 2020 2020 2020 2020 2020 2020 206f 7264               ord
-0000f4d0: 6572 3d6f 7264 6572 2c0a 2020 2020 2020  er=order,.      
-0000f4e0: 2020 2020 2020 290a 2020 2020 2020 2020        ).        
-0000f4f0: 7265 7475 726e 2073 7472 2874 6578 745f  return str(text_
-0000f500: 7472 6565 290a 0a20 2020 2064 6566 2064  tree)..    def d
-0000f510: 7261 775f 7376 6728 0a20 2020 2020 2020  raw_svg(.       
-0000f520: 2073 656c 662c 0a20 2020 2020 2020 2070   self,.        p
-0000f530: 6174 683d 4e6f 6e65 2c0a 2020 2020 2020  ath=None,.      
-0000f540: 2020 2a2c 0a20 2020 2020 2020 2073 697a    *,.        siz
-0000f550: 653d 4e6f 6e65 2c0a 2020 2020 2020 2020  e=None,.        
-0000f560: 7469 6d65 5f73 6361 6c65 3d4e 6f6e 652c  time_scale=None,
-0000f570: 0a20 2020 2020 2020 2074 7265 655f 6865  .        tree_he
-0000f580: 6967 6874 5f73 6361 6c65 3d4e 6f6e 652c  ight_scale=None,
-0000f590: 0a20 2020 2020 2020 206d 6178 5f74 696d  .        max_tim
-0000f5a0: 653d 4e6f 6e65 2c0a 2020 2020 2020 2020  e=None,.        
-0000f5b0: 6d69 6e5f 7469 6d65 3d4e 6f6e 652c 0a20  min_time=None,. 
-0000f5c0: 2020 2020 2020 206d 6178 5f74 7265 655f         max_tree_
-0000f5d0: 6865 6967 6874 3d4e 6f6e 652c 0a20 2020  height=None,.   
-0000f5e0: 2020 2020 206e 6f64 655f 6c61 6265 6c73       node_labels
-0000f5f0: 3d4e 6f6e 652c 0a20 2020 2020 2020 206d  =None,.        m
-0000f600: 7574 6174 696f 6e5f 6c61 6265 6c73 3d4e  utation_labels=N
-0000f610: 6f6e 652c 0a20 2020 2020 2020 2072 6f6f  one,.        roo
-0000f620: 745f 7376 675f 6174 7472 6962 7574 6573  t_svg_attributes
-0000f630: 3d4e 6f6e 652c 0a20 2020 2020 2020 2073  =None,.        s
-0000f640: 7479 6c65 3d4e 6f6e 652c 0a20 2020 2020  tyle=None,.     
-0000f650: 2020 206f 7264 6572 3d4e 6f6e 652c 0a20     order=None,. 
-0000f660: 2020 2020 2020 2066 6f72 6365 5f72 6f6f         force_roo
-0000f670: 745f 6272 616e 6368 3d4e 6f6e 652c 0a20  t_branch=None,. 
-0000f680: 2020 2020 2020 2073 796d 626f 6c5f 7369         symbol_si
-0000f690: 7a65 3d4e 6f6e 652c 0a20 2020 2020 2020  ze=None,.       
-0000f6a0: 2078 5f61 7869 733d 4e6f 6e65 2c0a 2020   x_axis=None,.  
-0000f6b0: 2020 2020 2020 785f 6c61 6265 6c3d 4e6f        x_label=No
-0000f6c0: 6e65 2c0a 2020 2020 2020 2020 795f 6178  ne,.        y_ax
-0000f6d0: 6973 3d4e 6f6e 652c 0a20 2020 2020 2020  is=None,.       
-0000f6e0: 2079 5f6c 6162 656c 3d4e 6f6e 652c 0a20   y_label=None,. 
-0000f6f0: 2020 2020 2020 2079 5f74 6963 6b73 3d4e         y_ticks=N
-0000f700: 6f6e 652c 0a20 2020 2020 2020 2079 5f67  one,.        y_g
-0000f710: 7269 646c 696e 6573 3d4e 6f6e 652c 0a20  ridlines=None,. 
-0000f720: 2020 2020 2020 2061 6c6c 5f65 6467 655f         all_edge_
-0000f730: 6d75 7461 7469 6f6e 733d 4e6f 6e65 2c0a  mutations=None,.
-0000f740: 2020 2020 2020 2020 6f6d 6974 5f73 6974          omit_sit
-0000f750: 6573 3d4e 6f6e 652c 0a20 2020 2020 2020  es=None,.       
-0000f760: 2063 616e 7661 735f 7369 7a65 3d4e 6f6e   canvas_size=Non
-0000f770: 652c 0a20 2020 2020 2020 202a 2a6b 7761  e,.        **kwa
-0000f780: 7267 732c 0a20 2020 2029 3a0a 2020 2020  rgs,.    ):.    
-0000f790: 2020 2020 2222 220a 2020 2020 2020 2020      """.        
-0000f7a0: 5265 7475 726e 2061 6e20 5356 4720 7265  Return an SVG re
-0000f7b0: 7072 6573 656e 7461 7469 6f6e 206f 6620  presentation of 
-0000f7c0: 6120 7369 6e67 6c65 2074 7265 652e 2042  a single tree. B
-0000f7d0: 7920 6465 6661 756c 742c 206e 756d 6572  y default, numer
-0000f7e0: 6963 0a20 2020 2020 2020 206c 6162 656c  ic.        label
-0000f7f0: 7320 6172 6520 6472 6177 6e20 6265 7369  s are drawn besi
-0000f800: 6465 206e 6f64 6573 2061 6e64 206d 7574  de nodes and mut
-0000f810: 6174 696f 6e73 3a20 7468 6573 6520 6361  ations: these ca
-0000f820: 6e20 6265 2061 6c74 6572 6564 2075 7369  n be altered usi
-0000f830: 6e67 2074 6865 0a20 2020 2020 2020 2060  ng the.        `
-0000f840: 606e 6f64 655f 6c61 6265 6c73 6060 2061  `node_labels`` a
-0000f850: 6e64 2060 606d 7574 6174 696f 6e5f 6c61  nd ``mutation_la
-0000f860: 6265 6c73 6060 2070 6172 616d 6574 6572  bels`` parameter
-0000f870: 732e 2053 6565 2074 6865 0a20 2020 2020  s. See the.     
-0000f880: 2020 203a 7265 663a 6076 6973 7561 6c69     :ref:`visuali
-0000f890: 7a61 7469 6f6e 2074 7574 6f72 6961 6c3c  zation tutorial<
-0000f8a0: 7475 746f 7269 616c 733a 7365 635f 7473  tutorials:sec_ts
-0000f8b0: 6b69 745f 7669 7a3e 6020 666f 7220 6d6f  kit_viz>` for mo
-0000f8c0: 7265 2064 6574 6169 6c73 2e0a 0a20 2020  re details...   
-0000f8d0: 2020 2020 203a 7061 7261 6d20 7374 7220       :param str 
-0000f8e0: 7061 7468 3a20 5468 6520 7061 7468 2074  path: The path t
-0000f8f0: 6f20 7468 6520 6669 6c65 2074 6f20 7772  o the file to wr
-0000f900: 6974 6520 7468 6520 6f75 7470 7574 2e20  ite the output. 
-0000f910: 4966 204e 6f6e 652c 2064 6f20 6e6f 740a  If None, do not.
-0000f920: 2020 2020 2020 2020 2020 2020 7772 6974              writ
-0000f930: 6520 746f 2066 696c 652e 0a20 2020 2020  e to file..     
-0000f940: 2020 203a 7061 7261 6d20 7475 706c 6528     :param tuple(
-0000f950: 696e 742c 2069 6e74 2920 7369 7a65 3a20  int, int) size: 
-0000f960: 4120 7475 706c 6520 6f66 2028 7769 6474  A tuple of (widt
-0000f970: 682c 2068 6569 6768 7429 2073 7065 6369  h, height) speci
-0000f980: 6679 696e 6720 6120 7461 7267 6574 0a20  fying a target. 
-0000f990: 2020 2020 2020 2020 2020 2064 7261 7769             drawi
-0000f9a0: 6e67 2073 697a 6520 696e 2061 6273 7472  ng size in abstr
-0000f9b0: 6163 7420 7573 6572 2075 6e69 7473 2028  act user units (
-0000f9c0: 7573 7561 6c6c 7920 696e 7465 7270 7265  usually interpre
-0000f9d0: 7465 6420 6173 2070 6978 656c 7320 6f6e  ted as pixels on
-0000f9e0: 0a20 2020 2020 2020 2020 2020 2069 6e69  .            ini
-0000f9f0: 7469 616c 2064 6973 706c 6179 292e 2043  tial display). C
-0000fa00: 6f6d 706f 6e65 6e74 7320 6f66 2074 6865  omponents of the
-0000fa10: 2064 7261 7769 6e67 2077 696c 6c20 6265   drawing will be
-0000fa20: 2073 6361 6c65 6420 736f 2074 6861 7420   scaled so that 
-0000fa30: 7468 6520 746f 7461 6c0a 2020 2020 2020  the total.      
-0000fa40: 2020 2020 2020 706c 6f74 2069 6e63 6c75        plot inclu
-0000fa50: 6469 6e67 206c 6162 656c 7320 6574 632e  ding labels etc.
-0000fa60: 206e 6f72 6d61 6c6c 7920 6669 7473 206f   normally fits o
-0000fa70: 6e74 6f20 6120 6361 6e76 6173 206f 6620  nto a canvas of 
-0000fa80: 7468 6973 2073 697a 6520 2873 6565 0a20  this size (see. 
-0000fa90: 2020 2020 2020 2020 2020 2060 6063 616e             ``can
-0000faa0: 7661 735f 7369 7a65 6060 2062 656c 6f77  vas_size`` below
-0000fab0: 292e 2049 6620 6060 4e6f 6e65 6060 2c20  ). If ``None``, 
-0000fac0: 7069 636b 2061 2073 697a 6520 6170 7072  pick a size appr
-0000fad0: 6f70 7269 6174 6520 666f 7220 6120 7472  opriate for a tr
-0000fae0: 6565 0a20 2020 2020 2020 2020 2020 2077  ee.            w
-0000faf0: 6974 6820 6120 7265 6173 6f6e 6162 6c79  ith a reasonably
-0000fb00: 2073 6d61 6c6c 206e 756d 6265 7220 2869   small number (i
-0000fb10: 2e65 2e20 7465 6e73 2920 6f66 2073 616d  .e. tens) of sam
-0000fb20: 706c 6573 2e20 4465 6661 756c 743a 2060  ples. Default: `
-0000fb30: 604e 6f6e 6560 600a 2020 2020 2020 2020  `None``.        
-0000fb40: 3a74 7970 6520 7369 7a65 3a0a 2020 2020  :type size:.    
-0000fb50: 2020 2020 3a70 6172 616d 2073 7472 2074      :param str t
-0000fb60: 696d 655f 7363 616c 653a 2043 6f6e 7472  ime_scale: Contr
-0000fb70: 6f6c 2068 6f77 2068 6569 6768 7420 7661  ol how height va
-0000fb80: 6c75 6573 2066 6f72 206e 6f64 6573 2061  lues for nodes a
-0000fb90: 7265 2063 6f6d 7075 7465 642e 0a20 2020  re computed..   
-0000fba0: 2020 2020 2020 2020 2049 6620 7468 6973           If this
-0000fbb0: 2069 7320 6571 7561 6c20 746f 2060 6022   is equal to ``"
-0000fbc0: 7469 6d65 2260 6020 2874 6865 2064 6566  time"`` (the def
-0000fbd0: 6175 6c74 292c 206e 6f64 6520 6865 6967  ault), node heig
-0000fbe0: 6874 7320 6172 6520 7072 6f70 6f72 7469  hts are proporti
-0000fbf0: 6f6e 616c 0a20 2020 2020 2020 2020 2020  onal.           
-0000fc00: 2074 6f20 7468 6569 7220 7469 6d65 2076   to their time v
-0000fc10: 616c 7565 732e 2049 6620 7468 6973 2069  alues. If this i
-0000fc20: 7320 6571 7561 6c20 746f 2060 6022 6c6f  s equal to ``"lo
-0000fc30: 675f 7469 6d65 2260 602c 206e 6f64 6520  g_time"``, node 
-0000fc40: 6865 6967 6874 7320 6172 650a 2020 2020  heights are.    
-0000fc50: 2020 2020 2020 2020 7072 6f70 6f72 7469          proporti
-0000fc60: 6f6e 616c 2074 6f20 7468 6569 7220 6c6f  onal to their lo
-0000fc70: 6728 7469 6d65 2920 7661 6c75 6573 2e20  g(time) values. 
-0000fc80: 4966 2069 7420 6973 2065 7175 616c 2074  If it is equal t
-0000fc90: 6f20 6060 2272 616e 6b22 6060 2c20 6e6f  o ``"rank"``, no
-0000fca0: 6465 0a20 2020 2020 2020 2020 2020 2068  de.            h
-0000fcb0: 6569 6768 7473 2061 7265 2073 7061 6365  eights are space
-0000fcc0: 6420 6571 7561 6c6c 7920 6163 636f 7264  d equally accord
-0000fcd0: 696e 6720 746f 2074 6865 6972 2072 616e  ing to their ran
-0000fce0: 6b65 6420 7469 6d65 732e 0a20 2020 2020  ked times..     
-0000fcf0: 2020 203a 7061 7261 6d20 7374 7220 7472     :param str tr
-0000fd00: 6565 5f68 6569 6768 745f 7363 616c 653a  ee_height_scale:
-0000fd10: 2044 6570 7265 6361 7465 6420 616c 6961   Deprecated alia
-0000fd20: 7320 666f 7220 7469 6d65 5f73 6361 6c65  s for time_scale
-0000fd30: 2e20 2844 6570 7265 6361 7465 6420 696e  . (Deprecated in
-0000fd40: 0a20 2020 2020 2020 2020 2020 2020 2020  .               
-0000fd50: 2030 2e33 2e36 290a 2020 2020 2020 2020   0.3.6).        
-0000fd60: 3a70 6172 616d 2073 7472 2c66 6c6f 6174  :param str,float
-0000fd70: 206d 6178 5f74 696d 653a 2054 6865 206d   max_time: The m
-0000fd80: 6178 696d 756d 2070 6c6f 7474 6564 2074  aximum plotted t
-0000fd90: 696d 6520 7661 6c75 6520 696e 2074 6865  ime value in the
-0000fda0: 2063 7572 7265 6e74 0a20 2020 2020 2020   current.       
-0000fdb0: 2020 2020 2073 6361 6c69 6e67 2073 7973       scaling sys
-0000fdc0: 7465 6d20 2873 6565 2060 6074 696d 655f  tem (see ``time_
-0000fdd0: 7363 616c 6560 6029 2e20 4361 6e20 6265  scale``). Can be
-0000fde0: 2065 6974 6865 7220 6120 7374 7269 6e67   either a string
-0000fdf0: 206f 7220 610a 2020 2020 2020 2020 2020   or a.          
-0000fe00: 2020 6e75 6d65 7269 6320 7661 6c75 652e    numeric value.
-0000fe10: 2049 6620 6571 7561 6c20 746f 2060 6022   If equal to ``"
-0000fe20: 7472 6565 2260 6020 2874 6865 2064 6566  tree"`` (the def
-0000fe30: 6175 6c74 292c 2074 6865 206d 6178 696d  ault), the maxim
-0000fe40: 756d 2074 696d 650a 2020 2020 2020 2020  um time.        
-0000fe50: 2020 2020 6973 2073 6574 2074 6f20 6265      is set to be
-0000fe60: 2074 6861 7420 6f66 2074 6865 206f 6c64   that of the old
-0000fe70: 6573 7420 726f 6f74 2069 6e20 7468 6520  est root in the 
-0000fe80: 7472 6565 2e20 4966 2065 7175 616c 2074  tree. If equal t
-0000fe90: 6f20 6060 2274 7322 6060 2074 6865 0a20  o ``"ts"`` the. 
-0000fea0: 2020 2020 2020 2020 2020 206d 6178 696d             maxim
-0000feb0: 756d 2074 696d 6520 6973 2073 6574 2074  um time is set t
-0000fec0: 6f20 6265 2074 6865 2074 696d 6520 6f66  o be the time of
-0000fed0: 2074 6865 206f 6c64 6573 7420 726f 6f74   the oldest root
-0000fee0: 2069 6e20 7468 6520 7472 6565 0a20 2020   in the tree.   
-0000fef0: 2020 2020 2020 2020 2073 6571 7565 6e63           sequenc
-0000ff00: 653b 2074 6869 7320 6973 2075 7365 6675  e; this is usefu
-0000ff10: 6c20 7768 656e 2064 7261 7769 6e67 2074  l when drawing t
-0000ff20: 7265 6573 2066 726f 6d20 7468 6520 7361  rees from the sa
-0000ff30: 6d65 2074 7265 6520 7365 7175 656e 6365  me tree sequence
-0000ff40: 2061 7320 6974 0a20 2020 2020 2020 2020   as it.         
-0000ff50: 2020 2065 6e73 7572 6573 2074 6861 7420     ensures that 
-0000ff60: 6e6f 6465 2068 6569 6768 7473 2061 7265  node heights are
-0000ff70: 2063 6f6e 7369 7374 656e 742e 2049 6620   consistent. If 
-0000ff80: 6120 6e75 6d65 7269 6320 7661 6c75 652c  a numeric value,
-0000ff90: 2074 6869 7320 6973 2075 7365 6420 6173   this is used as
-0000ffa0: 0a20 2020 2020 2020 2020 2020 2074 6865  .            the
-0000ffb0: 206d 6178 696d 756d 2070 6c6f 7474 6564   maximum plotted
-0000ffc0: 2074 696d 6520 6279 2077 6869 6368 2074   time by which t
-0000ffd0: 6f20 7363 616c 6520 6f74 6865 7220 6e6f  o scale other no
-0000ffe0: 6465 732e 0a20 2020 2020 2020 203a 7061  des..        :pa
-0000fff0: 7261 6d20 7374 722c 666c 6f61 7420 6d69  ram str,float mi
-00010000: 6e5f 7469 6d65 3a20 5468 6520 6d69 6e69  n_time: The mini
-00010010: 6d75 6d20 706c 6f74 7465 6420 7469 6d65  mum plotted time
-00010020: 2076 616c 7565 2069 6e20 7468 6520 6375   value in the cu
-00010030: 7272 656e 740a 2020 2020 2020 2020 2020  rrent.          
-00010040: 2020 7363 616c 696e 6720 7379 7374 656d    scaling system
-00010050: 2028 7365 6520 6060 7469 6d65 5f73 6361   (see ``time_sca
-00010060: 6c65 6060 292e 2043 616e 2062 6520 6569  le``). Can be ei
-00010070: 7468 6572 2061 2073 7472 696e 6720 6f72  ther a string or
-00010080: 2061 0a20 2020 2020 2020 2020 2020 206e   a.            n
-00010090: 756d 6572 6963 2076 616c 7565 2e20 4966  umeric value. If
-000100a0: 2065 7175 616c 2074 6f20 6060 2274 7265   equal to ``"tre
-000100b0: 6522 6060 2028 7468 6520 6465 6661 756c  e"`` (the defaul
-000100c0: 7429 2c20 7468 6520 6d69 6e69 6d75 6d20  t), the minimum 
-000100d0: 7469 6d65 0a20 2020 2020 2020 2020 2020  time.           
-000100e0: 2069 7320 7365 7420 746f 2062 6520 7468   is set to be th
-000100f0: 6174 206f 6620 7468 6520 796f 756e 6765  at of the younge
-00010100: 7374 206e 6f64 6520 696e 2074 6865 2074  st node in the t
-00010110: 7265 652e 2049 6620 6571 7561 6c20 746f  ree. If equal to
-00010120: 2060 6022 7473 2260 6020 7468 650a 2020   ``"ts"`` the.  
-00010130: 2020 2020 2020 2020 2020 6d69 6e69 6d75            minimu
-00010140: 6d20 7469 6d65 2069 7320 7365 7420 746f  m time is set to
-00010150: 2062 6520 7468 6520 7469 6d65 206f 6620   be the time of 
-00010160: 7468 6520 796f 756e 6765 7374 206e 6f64  the youngest nod
-00010170: 6520 696e 2074 6865 2074 7265 650a 2020  e in the tree.  
-00010180: 2020 2020 2020 2020 2020 7365 7175 656e            sequen
-00010190: 6365 3b20 7468 6973 2069 7320 7573 6566  ce; this is usef
-000101a0: 756c 2077 6865 6e20 6472 6177 696e 6720  ul when drawing 
-000101b0: 7472 6565 7320 6672 6f6d 2074 6865 2073  trees from the s
-000101c0: 616d 6520 7472 6565 2073 6571 7565 6e63  ame tree sequenc
-000101d0: 6520 6173 2069 740a 2020 2020 2020 2020  e as it.        
-000101e0: 2020 2020 656e 7375 7265 7320 7468 6174      ensures that
-000101f0: 206e 6f64 6520 6865 6967 6874 7320 6172   node heights ar
-00010200: 6520 636f 6e73 6973 7465 6e74 2e20 4966  e consistent. If
-00010210: 2061 206e 756d 6572 6963 2076 616c 7565   a numeric value
-00010220: 2c20 7468 6973 2069 7320 7573 6564 2061  , this is used a
-00010230: 730a 2020 2020 2020 2020 2020 2020 7468  s.            th
-00010240: 6520 6d69 6e69 6d75 6d20 706c 6f74 7465  e minimum plotte
-00010250: 6420 7469 6d65 2e0a 2020 2020 2020 2020  d time..        
-00010260: 3a70 6172 616d 2073 7472 2c66 6c6f 6174  :param str,float
-00010270: 206d 6178 5f74 7265 655f 6865 6967 6874   max_tree_height
-00010280: 3a20 4465 7072 6563 6174 6564 2061 6c69  : Deprecated ali
-00010290: 6173 2066 6f72 206d 6178 5f74 696d 652e  as for max_time.
-000102a0: 2028 4465 7072 6563 6174 6564 2069 6e0a   (Deprecated in.
-000102b0: 2020 2020 2020 2020 2020 2020 302e 332e              0.3.
-000102c0: 3629 0a20 2020 2020 2020 203a 7061 7261  6).        :para
-000102d0: 6d20 6e6f 6465 5f6c 6162 656c 733a 2049  m node_labels: I
-000102e0: 6620 7370 6563 6966 6965 642c 2073 686f  f specified, sho
-000102f0: 7720 6375 7374 6f6d 206c 6162 656c 7320  w custom labels 
-00010300: 666f 7220 7468 6520 6e6f 6465 730a 2020  for the nodes.  
-00010310: 2020 2020 2020 2020 2020 2873 7065 6369            (speci
-00010320: 6669 6564 2062 7920 4944 2920 7468 6174  fied by ID) that
-00010330: 2061 7265 2070 7265 7365 6e74 2069 6e20   are present in 
-00010340: 7468 6973 206d 6170 3b20 616e 7920 6e6f  this map; any no
-00010350: 6465 7320 6e6f 7420 7072 6573 656e 7420  des not present 
-00010360: 7769 6c6c 0a20 2020 2020 2020 2020 2020  will.           
-00010370: 206e 6f74 2068 6176 6520 6120 6c61 6265   not have a labe
-00010380: 6c2e 0a20 2020 2020 2020 203a 7479 7065  l..        :type
-00010390: 206e 6f64 655f 6c61 6265 6c73 3a20 6469   node_labels: di
-000103a0: 6374 2869 6e74 2c20 7374 7229 0a20 2020  ct(int, str).   
-000103b0: 2020 2020 203a 7061 7261 6d20 6d75 7461       :param muta
-000103c0: 7469 6f6e 5f6c 6162 656c 733a 2049 6620  tion_labels: If 
-000103d0: 7370 6563 6966 6965 642c 2073 686f 7720  specified, show 
-000103e0: 6375 7374 6f6d 206c 6162 656c 7320 666f  custom labels fo
-000103f0: 7220 7468 650a 2020 2020 2020 2020 2020  r the.          
-00010400: 2020 6d75 7461 7469 6f6e 7320 2873 7065    mutations (spe
-00010410: 6369 6669 6564 2062 7920 4944 2920 7468  cified by ID) th
-00010420: 6174 2061 7265 2070 7265 7365 6e74 2069  at are present i
-00010430: 6e20 7468 6520 6d61 703b 2061 6e79 206d  n the map; any m
-00010440: 7574 6174 696f 6e73 0a20 2020 2020 2020  utations.       
-00010450: 2020 2020 206e 6f74 2070 7265 7365 6e74       not present
-00010460: 2077 696c 6c20 6e6f 7420 6861 7665 2061   will not have a
-00010470: 206c 6162 656c 2e0a 2020 2020 2020 2020   label..        
-00010480: 3a74 7970 6520 6d75 7461 7469 6f6e 5f6c  :type mutation_l
-00010490: 6162 656c 733a 2064 6963 7428 696e 742c  abels: dict(int,
-000104a0: 2073 7472 290a 2020 2020 2020 2020 3a70   str).        :p
-000104b0: 6172 616d 2064 6963 7420 726f 6f74 5f73  aram dict root_s
-000104c0: 7667 5f61 7474 7269 6275 7465 733a 2041  vg_attributes: A
-000104d0: 6464 6974 696f 6e61 6c20 6174 7472 6962  dditional attrib
-000104e0: 7574 6573 2c20 7375 6368 2061 7320 616e  utes, such as an
-000104f0: 2069 642c 2074 6861 7420 7769 6c6c 0a20   id, that will. 
-00010500: 2020 2020 2020 2020 2020 2062 6520 656d             be em
-00010510: 6265 6464 6564 2069 6e20 7468 6520 726f  bedded in the ro
-00010520: 6f74 2060 603c 7376 673e 6060 2074 6167  ot ``<svg>`` tag
-00010530: 206f 6620 7468 6520 6765 6e65 7261 7465   of the generate
-00010540: 6420 6472 6177 696e 672e 0a20 2020 2020  d drawing..     
-00010550: 2020 203a 7061 7261 6d20 7374 7220 7374     :param str st
-00010560: 796c 653a 2041 0a20 2020 2020 2020 2020  yle: A.         
-00010570: 2020 2060 6373 7320 7374 796c 6520 7374     `css style st
-00010580: 7269 6e67 203c 6874 7470 733a 2f2f 7777  ring <https://ww
-00010590: 772e 7733 2e6f 7267 2f54 522f 4353 5332  w.w3.org/TR/CSS2
-000105a0: 322f 7379 6e64 6174 612e 6874 6d6c 3e60  2/syndata.html>`
-000105b0: 5f20 7468 6174 2077 696c 6c20 6265 0a20  _ that will be. 
-000105c0: 2020 2020 2020 2020 2020 2069 6e63 6c75             inclu
-000105d0: 6465 6420 696e 2074 6865 2060 603c 7374  ded in the ``<st
-000105e0: 796c 653e 6060 2074 6167 206f 6620 7468  yle>`` tag of th
-000105f0: 6520 6765 6e65 7261 7465 6420 7376 672e  e generated svg.
-00010600: 0a20 2020 2020 2020 203a 7061 7261 6d20  .        :param 
-00010610: 7374 7220 6f72 6465 723a 2054 6865 206c  str order: The l
-00010620: 6566 742d 746f 2d72 6967 6874 206f 7264  eft-to-right ord
-00010630: 6572 696e 6720 6f66 2063 6869 6c64 206e  ering of child n
-00010640: 6f64 6573 2069 6e20 7468 6520 6472 6177  odes in the draw
-00010650: 6e20 7472 6565 2e0a 2020 2020 2020 2020  n tree..        
-00010660: 2020 2020 5468 6973 2063 616e 2062 6520      This can be 
-00010670: 6569 7468 6572 3a20 6060 226d 696e 6c65  either: ``"minle
-00010680: 7822 6060 2c20 7768 6963 6820 6d69 6e69  x"``, which mini
-00010690: 6d69 7365 7320 7468 6520 6469 6666 6572  mises the differ
-000106a0: 656e 6365 730a 2020 2020 2020 2020 2020  ences.          
-000106b0: 2020 6265 7477 6565 6e20 6164 6a61 6365    between adjace
-000106c0: 6e74 2074 7265 6573 2028 7365 6520 616c  nt trees (see al
-000106d0: 736f 2074 6865 2060 6022 6d69 6e6c 6578  so the ``"minlex
-000106e0: 5f70 6f73 746f 7264 6572 2260 6020 7472  _postorder"`` tr
-000106f0: 6176 6572 7361 6c0a 2020 2020 2020 2020  aversal.        
-00010700: 2020 2020 6f72 6465 7220 666f 7220 7468      order for th
-00010710: 6520 3a6d 6574 683a 602e 6e6f 6465 7360  e :meth:`.nodes`
-00010720: 206d 6574 686f 6429 3b20 6f72 2060 6022   method); or ``"
-00010730: 7472 6565 2260 6020 7768 6963 6820 6472  tree"`` which dr
-00010740: 6177 7320 7472 6565 730a 2020 2020 2020  aws trees.      
-00010750: 2020 2020 2020 696e 2074 6865 206c 6566        in the lef
-00010760: 742d 746f 2d72 6967 6874 206f 7264 6572  t-to-right order
-00010770: 2064 6566 696e 6564 2062 7920 7468 650a   defined by the.
-00010780: 2020 2020 2020 2020 2020 2020 3a72 6566              :ref
-00010790: 3a60 7175 696e 7475 706c 7920 6c69 6e6b  :`quintuply link
-000107a0: 6564 2074 7265 6520 7374 7275 6374 7572  ed tree structur
-000107b0: 6520 3c73 6563 5f64 6174 615f 6d6f 6465  e <sec_data_mode
-000107c0: 6c5f 7472 6565 5f73 7472 7563 7475 7265  l_tree_structure
-000107d0: 3e60 2e0a 2020 2020 2020 2020 2020 2020  >`..            
-000107e0: 4966 206e 6f74 2073 7065 6369 6669 6564  If not specified
-000107f0: 206f 7220 4e6f 6e65 2c20 7468 6973 2064   or None, this d
-00010800: 6566 6175 6c74 7320 746f 2060 6022 6d69  efaults to ``"mi
-00010810: 6e6c 6578 2260 602e 0a20 2020 2020 2020  nlex"``..       
-00010820: 203a 7061 7261 6d20 626f 6f6c 2066 6f72   :param bool for
-00010830: 6365 5f72 6f6f 745f 6272 616e 6368 3a20  ce_root_branch: 
-00010840: 4966 2060 6054 7275 6560 6020 616c 7761  If ``True`` alwa
-00010850: 7973 2070 6c6f 7420 6120 6272 616e 6368  ys plot a branch
-00010860: 2028 6564 6765 2920 6162 6f76 6520 7468   (edge) above th
-00010870: 650a 2020 2020 2020 2020 2020 2020 726f  e.            ro
-00010880: 6f74 2873 2920 696e 2074 6865 2074 7265  ot(s) in the tre
-00010890: 652e 2049 6620 6060 4e6f 6e65 6060 2028  e. If ``None`` (
-000108a0: 6465 6661 756c 7429 2074 6865 6e20 6f6e  default) then on
-000108b0: 6c79 2070 6c6f 7420 7375 6368 2072 6f6f  ly plot such roo
-000108c0: 7420 6272 616e 6368 6573 0a20 2020 2020  t branches.     
-000108d0: 2020 2020 2020 2069 6620 7468 6572 6520         if there 
-000108e0: 6973 2061 206d 7574 6174 696f 6e20 6162  is a mutation ab
-000108f0: 6f76 6520 6120 726f 6f74 206f 6620 7468  ove a root of th
-00010900: 6520 7472 6565 2e0a 2020 2020 2020 2020  e tree..        
-00010910: 3a70 6172 616d 2066 6c6f 6174 2073 796d  :param float sym
-00010920: 626f 6c5f 7369 7a65 3a20 4368 616e 6765  bol_size: Change
-00010930: 2074 6865 2064 6566 6175 6c74 2073 697a   the default siz
-00010940: 6520 6f66 2074 6865 206e 6f64 6520 616e  e of the node an
-00010950: 6420 6d75 7461 7469 6f6e 0a20 2020 2020  d mutation.     
-00010960: 2020 2020 2020 2070 6c6f 7474 696e 6720         plotting 
-00010970: 7379 6d62 6f6c 732e 2049 6620 6060 4e6f  symbols. If ``No
-00010980: 6e65 6060 2028 6465 6661 756c 7429 2075  ne`` (default) u
-00010990: 7365 2061 2073 7461 6e64 6172 6420 7369  se a standard si
-000109a0: 7a65 2e0a 2020 2020 2020 2020 3a70 6172  ze..        :par
-000109b0: 616d 2062 6f6f 6c20 785f 6178 6973 3a20  am bool x_axis: 
-000109c0: 5368 6f75 6c64 2074 6865 2070 6c6f 7420  Should the plot 
-000109d0: 6861 7665 2061 6e20 5820 6178 6973 206c  have an X axis l
-000109e0: 696e 652c 2073 686f 7769 6e67 2074 6865  ine, showing the
-000109f0: 2073 7461 7274 2061 6e64 0a20 2020 2020   start and.     
-00010a00: 2020 2020 2020 2065 6e64 2070 6f73 6974         end posit
-00010a10: 696f 6e20 6f66 2074 6869 7320 7472 6565  ion of this tree
-00010a20: 2061 6c6f 6e67 2074 6865 2067 656e 6f6d   along the genom
-00010a30: 652e 2049 6620 6060 4e6f 6e65 6060 2028  e. If ``None`` (
-00010a40: 6465 6661 756c 7429 2064 6f20 6e6f 740a  default) do not.
-00010a50: 2020 2020 2020 2020 2020 2020 706c 6f74              plot
-00010a60: 2061 6e20 5820 6178 6973 2e0a 2020 2020   an X axis..    
-00010a70: 2020 2020 3a70 6172 616d 2073 7472 2078      :param str x
-00010a80: 5f6c 6162 656c 3a20 506c 6163 6520 6120  _label: Place a 
-00010a90: 6c61 6265 6c20 756e 6465 7220 7468 6520  label under the 
-00010aa0: 706c 6f74 2e20 4966 2060 604e 6f6e 6560  plot. If ``None`
-00010ab0: 6020 2864 6566 6175 6c74 2920 616e 640a  ` (default) and.
-00010ac0: 2020 2020 2020 2020 2020 2020 7468 6572              ther
-00010ad0: 6520 6973 2061 6e20 5820 6178 6973 2c20  e is an X axis, 
-00010ae0: 6372 6561 7465 2061 6e64 2070 6c61 6365  create and place
-00010af0: 2061 6e20 6170 7072 6f70 7269 6174 6520   an appropriate 
-00010b00: 6c61 6265 6c2e 0a20 2020 2020 2020 203a  label..        :
-00010b10: 7061 7261 6d20 626f 6f6c 2079 5f61 7869  param bool y_axi
-00010b20: 733a 2053 686f 756c 6420 7468 6520 706c  s: Should the pl
-00010b30: 6f74 2068 6176 6520 616e 2059 2061 7869  ot have an Y axi
-00010b40: 7320 6c69 6e65 2c20 7368 6f77 696e 6720  s line, showing 
-00010b50: 7469 6d65 2028 6f72 0a20 2020 2020 2020  time (or.       
-00010b60: 2020 2020 2072 616e 6b65 6420 6e6f 6465       ranked node
-00010b70: 2074 696d 6520 6966 2060 6074 696d 655f   time if ``time_
-00010b80: 7363 616c 653d 2272 616e 6b22 6060 292e  scale="rank"``).
-00010b90: 2049 6620 6060 4e6f 6e65 6060 2028 6465   If ``None`` (de
-00010ba0: 6661 756c 7429 0a20 2020 2020 2020 2020  fault).         
-00010bb0: 2020 2064 6f20 6e6f 7420 706c 6f74 2061     do not plot a
-00010bc0: 2059 2061 7869 732e 0a20 2020 2020 2020   Y axis..       
-00010bd0: 203a 7061 7261 6d20 7374 7220 795f 6c61   :param str y_la
-00010be0: 6265 6c3a 2050 6c61 6365 2061 206c 6162  bel: Place a lab
-00010bf0: 656c 2074 6f20 7468 6520 6c65 6674 206f  el to the left o
-00010c00: 6620 7468 6520 706c 6f74 2e20 4966 2060  f the plot. If `
-00010c10: 604e 6f6e 6560 6020 2864 6566 6175 6c74  `None`` (default
-00010c20: 290a 2020 2020 2020 2020 2020 2020 616e  ).            an
-00010c30: 6420 7468 6572 6520 6973 2061 2059 2061  d there is a Y a
-00010c40: 7869 732c 2020 6372 6561 7465 2061 6e64  xis,  create and
-00010c50: 2070 6c61 6365 2061 6e20 6170 7072 6f70   place an approp
-00010c60: 7269 6174 6520 6c61 6265 6c2e 0a20 2020  riate label..   
-00010c70: 2020 2020 203a 7061 7261 6d20 6c69 7374       :param list
-00010c80: 2079 5f74 6963 6b73 3a20 4120 6c69 7374   y_ticks: A list
-00010c90: 206f 6620 5920 7661 6c75 6573 2061 7420   of Y values at 
-00010ca0: 7768 6963 6820 746f 2070 6c6f 7420 7469  which to plot ti
-00010cb0: 636b 6d61 726b 7320 2860 605b 5d60 600a  ckmarks (``[]``.
-00010cc0: 2020 2020 2020 2020 2020 2020 6769 7665              give
-00010cd0: 7320 6e6f 2074 6963 6b6d 6172 6b73 292e  s no tickmarks).
-00010ce0: 2049 6620 6060 4e6f 6e65 6060 2c20 706c   If ``None``, pl
-00010cf0: 6f74 206f 6e65 2074 6963 6b6d 6172 6b20  ot one tickmark 
-00010d00: 666f 7220 6561 6368 2075 6e69 7175 650a  for each unique.
-00010d10: 2020 2020 2020 2020 2020 2020 6e6f 6465              node
-00010d20: 2076 616c 7565 2e0a 2020 2020 2020 2020   value..        
-00010d30: 3a70 6172 616d 2062 6f6f 6c20 795f 6772  :param bool y_gr
-00010d40: 6964 6c69 6e65 733a 2057 6865 7468 6572  idlines: Whether
-00010d50: 2074 6f20 706c 6f74 2068 6f72 697a 6f6e   to plot horizon
-00010d60: 7461 6c20 6c69 6e65 7320 6265 6869 6e64  tal lines behind
-00010d70: 2074 6865 2074 7265 650a 2020 2020 2020   the tree.      
-00010d80: 2020 2020 2020 6174 2065 6163 6820 7920        at each y 
-00010d90: 7469 636b 6d61 726b 2e0a 2020 2020 2020  tickmark..      
-00010da0: 2020 3a70 6172 616d 2062 6f6f 6c20 616c    :param bool al
-00010db0: 6c5f 6564 6765 5f6d 7574 6174 696f 6e73  l_edge_mutations
-00010dc0: 3a20 5468 6520 6564 6765 206f 6e20 7768  : The edge on wh
-00010dd0: 6963 6820 6120 6d75 7461 7469 6f6e 206f  ich a mutation o
-00010de0: 6363 7572 7320 6d61 7920 7370 616e 0a20  ccurs may span. 
-00010df0: 2020 2020 2020 2020 2020 206d 756c 7469             multi
-00010e00: 706c 6520 7472 6565 732e 2049 6620 6060  ple trees. If ``
-00010e10: 4661 6c73 6560 6020 6f72 2060 604e 6f6e  False`` or ``Non
-00010e20: 6560 6020 2864 6566 6175 6c74 2920 6d75  e`` (default) mu
-00010e30: 7461 7469 6f6e 7320 6172 6520 6f6e 6c79  tations are only
-00010e40: 2064 7261 776e 0a20 2020 2020 2020 2020   drawn.         
-00010e50: 2020 206f 6e20 616e 2065 6467 6520 6966     on an edge if
-00010e60: 2074 6865 6972 2073 6974 6520 706f 7369   their site posi
-00010e70: 7469 6f6e 2065 7869 7374 7320 7769 7468  tion exists with
-00010e80: 696e 2074 6865 2067 656e 6f6d 6963 2069  in the genomic i
-00010e90: 6e74 6572 7661 6c20 636f 7665 7265 640a  nterval covered.
-00010ea0: 2020 2020 2020 2020 2020 2020 6279 2074              by t
-00010eb0: 6869 7320 7472 6565 2e20 4966 2060 6054  his tree. If ``T
-00010ec0: 7275 6560 602c 2061 6c6c 206d 7574 6174  rue``, all mutat
-00010ed0: 696f 6e73 206f 6e20 6561 6368 2065 6467  ions on each edg
-00010ee0: 6520 6f66 2074 6865 2074 7265 6520 6172  e of the tree ar
-00010ef0: 6520 6472 6177 6e2c 0a20 2020 2020 2020  e drawn,.       
-00010f00: 2020 2020 2065 7665 6e20 6966 2074 6865       even if the
-00010f10: 6972 2067 656e 6f6d 6963 2070 6f73 6974  ir genomic posit
-00010f20: 696f 6e20 6973 2074 6f20 7468 6520 6c65  ion is to the le
-00010f30: 6674 206f 7220 7269 6768 7420 6f66 2074  ft or right of t
-00010f40: 6865 2074 7265 650a 2020 2020 2020 2020  he tree.        
-00010f50: 2020 2020 6974 7365 6c66 2e20 4e6f 7465      itself. Note
-00010f60: 2074 6861 7420 7468 6973 206d 6561 6e73   that this means
-00010f70: 2074 6861 7420 696e 6465 7065 6e64 656e   that independen
-00010f80: 7420 6472 6177 696e 6773 206f 6620 6469  t drawings of di
-00010f90: 6666 6572 656e 7420 7472 6565 730a 2020  fferent trees.  
-00010fa0: 2020 2020 2020 2020 2020 6672 6f6d 2074            from t
-00010fb0: 6865 2073 616d 6520 7472 6565 2073 6571  he same tree seq
-00010fc0: 7565 6e63 6520 6d61 7920 7368 6172 6520  uence may share 
-00010fd0: 736f 6d65 2070 6c6f 7474 6564 206d 7574  some plotted mut
-00010fe0: 6174 696f 6e73 2e0a 2020 2020 2020 2020  ations..        
-00010ff0: 3a70 6172 616d 2062 6f6f 6c20 6f6d 6974  :param bool omit
-00011000: 5f73 6974 6573 3a20 4966 2054 7275 652c  _sites: If True,
-00011010: 206f 6d69 7420 7369 7465 7320 616e 6420   omit sites and 
-00011020: 6d75 7461 7469 6f6e 7320 6672 6f6d 2074  mutations from t
-00011030: 6865 2064 7261 7769 6e67 2e0a 2020 2020  he drawing..    
-00011040: 2020 2020 2020 2020 4465 6661 756c 743a          Default:
-00011050: 2046 616c 7365 0a20 2020 2020 2020 203a   False.        :
-00011060: 7061 7261 6d20 7475 706c 6528 696e 742c  param tuple(int,
-00011070: 2069 6e74 2920 6361 6e76 6173 5f73 697a   int) canvas_siz
-00011080: 653a 2054 6865 2028 7769 6474 682c 2068  e: The (width, h
-00011090: 6569 6768 7429 206f 6620 7468 6520 5356  eight) of the SV
-000110a0: 4720 6361 6e76 6173 2e0a 2020 2020 2020  G canvas..      
-000110b0: 2020 2020 2020 5468 6973 2077 696c 6c20        This will 
-000110c0: 6368 616e 6765 2074 6865 2053 5647 2077  change the SVG w
-000110d0: 6964 7468 2061 6e64 2068 6569 6768 7420  idth and height 
-000110e0: 7769 7468 6f75 7420 7265 7363 616c 696e  without rescalin
-000110f0: 6720 6772 6170 6869 6361 6c0a 2020 2020  g graphical.    
-00011100: 2020 2020 2020 2020 656c 656d 656e 7473          elements
-00011110: 2c20 616c 6c6f 7769 6e67 2065 7874 7261  , allowing extra
-00011120: 2072 6f6f 6d20 652e 672e 2066 6f72 2075   room e.g. for u
-00011130: 6e75 7375 616c 6c79 206c 6f6e 6720 6c61  nusually long la
-00011140: 6265 6c73 2e20 4966 2060 604e 6f6e 6560  bels. If ``None`
-00011150: 600a 2020 2020 2020 2020 2020 2020 7461  `.            ta
-00011160: 6b65 2074 6865 2063 616e 7661 7320 7369  ke the canvas si
-00011170: 7a65 2074 6f20 6265 2074 6865 2073 616d  ze to be the sam
-00011180: 6520 6173 2074 6865 2074 6172 6765 7420  e as the target 
-00011190: 6472 6177 696e 6720 7369 7a65 2028 7365  drawing size (se
-000111a0: 650a 2020 2020 2020 2020 2020 2020 6060  e.            ``
-000111b0: 7369 7a65 6060 2c20 6162 6f76 6529 2e20  size``, above). 
-000111c0: 4465 6661 756c 743a 204e 6f6e 650a 0a20  Default: None.. 
-000111d0: 2020 2020 2020 203a 7265 7475 726e 3a20         :return: 
-000111e0: 416e 2053 5647 2072 6570 7265 7365 6e74  An SVG represent
-000111f0: 6174 696f 6e20 6f66 2061 2074 7265 652e  ation of a tree.
-00011200: 0a20 2020 2020 2020 203a 7274 7970 653a  .        :rtype:
-00011210: 2053 5647 5374 7269 6e67 0a20 2020 2020   SVGString.     
-00011220: 2020 2022 2222 0a20 2020 2020 2020 2064     """.        d
-00011230: 7261 7720 3d20 6472 6177 696e 672e 5376  raw = drawing.Sv
-00011240: 6754 7265 6528 0a20 2020 2020 2020 2020  gTree(.         
-00011250: 2020 2073 656c 662c 0a20 2020 2020 2020     self,.       
-00011260: 2020 2020 2073 697a 652c 0a20 2020 2020       size,.     
-00011270: 2020 2020 2020 2074 696d 655f 7363 616c         time_scal
-00011280: 653d 7469 6d65 5f73 6361 6c65 2c0a 2020  e=time_scale,.  
-00011290: 2020 2020 2020 2020 2020 7472 6565 5f68            tree_h
-000112a0: 6569 6768 745f 7363 616c 653d 7472 6565  eight_scale=tree
-000112b0: 5f68 6569 6768 745f 7363 616c 652c 0a20  _height_scale,. 
-000112c0: 2020 2020 2020 2020 2020 206d 6178 5f74             max_t
-000112d0: 696d 653d 6d61 785f 7469 6d65 2c0a 2020  ime=max_time,.  
-000112e0: 2020 2020 2020 2020 2020 6d69 6e5f 7469            min_ti
-000112f0: 6d65 3d6d 696e 5f74 696d 652c 0a20 2020  me=min_time,.   
-00011300: 2020 2020 2020 2020 206d 6178 5f74 7265           max_tre
-00011310: 655f 6865 6967 6874 3d6d 6178 5f74 7265  e_height=max_tre
-00011320: 655f 6865 6967 6874 2c0a 2020 2020 2020  e_height,.      
-00011330: 2020 2020 2020 6e6f 6465 5f6c 6162 656c        node_label
-00011340: 733d 6e6f 6465 5f6c 6162 656c 732c 0a20  s=node_labels,. 
-00011350: 2020 2020 2020 2020 2020 206d 7574 6174             mutat
-00011360: 696f 6e5f 6c61 6265 6c73 3d6d 7574 6174  ion_labels=mutat
-00011370: 696f 6e5f 6c61 6265 6c73 2c0a 2020 2020  ion_labels,.    
-00011380: 2020 2020 2020 2020 726f 6f74 5f73 7667          root_svg
-00011390: 5f61 7474 7269 6275 7465 733d 726f 6f74  _attributes=root
-000113a0: 5f73 7667 5f61 7474 7269 6275 7465 732c  _svg_attributes,
-000113b0: 0a20 2020 2020 2020 2020 2020 2073 7479  .            sty
-000113c0: 6c65 3d73 7479 6c65 2c0a 2020 2020 2020  le=style,.      
-000113d0: 2020 2020 2020 6f72 6465 723d 6f72 6465        order=orde
-000113e0: 722c 0a20 2020 2020 2020 2020 2020 2066  r,.            f
-000113f0: 6f72 6365 5f72 6f6f 745f 6272 616e 6368  orce_root_branch
-00011400: 3d66 6f72 6365 5f72 6f6f 745f 6272 616e  =force_root_bran
-00011410: 6368 2c0a 2020 2020 2020 2020 2020 2020  ch,.            
-00011420: 7379 6d62 6f6c 5f73 697a 653d 7379 6d62  symbol_size=symb
-00011430: 6f6c 5f73 697a 652c 0a20 2020 2020 2020  ol_size,.       
-00011440: 2020 2020 2078 5f61 7869 733d 785f 6178       x_axis=x_ax
-00011450: 6973 2c0a 2020 2020 2020 2020 2020 2020  is,.            
-00011460: 785f 6c61 6265 6c3d 785f 6c61 6265 6c2c  x_label=x_label,
-00011470: 0a20 2020 2020 2020 2020 2020 2079 5f61  .            y_a
-00011480: 7869 733d 795f 6178 6973 2c0a 2020 2020  xis=y_axis,.    
-00011490: 2020 2020 2020 2020 795f 6c61 6265 6c3d          y_label=
-000114a0: 795f 6c61 6265 6c2c 0a20 2020 2020 2020  y_label,.       
-000114b0: 2020 2020 2079 5f74 6963 6b73 3d79 5f74       y_ticks=y_t
-000114c0: 6963 6b73 2c0a 2020 2020 2020 2020 2020  icks,.          
-000114d0: 2020 795f 6772 6964 6c69 6e65 733d 795f    y_gridlines=y_
-000114e0: 6772 6964 6c69 6e65 732c 0a20 2020 2020  gridlines,.     
-000114f0: 2020 2020 2020 2061 6c6c 5f65 6467 655f         all_edge_
-00011500: 6d75 7461 7469 6f6e 733d 616c 6c5f 6564  mutations=all_ed
-00011510: 6765 5f6d 7574 6174 696f 6e73 2c0a 2020  ge_mutations,.  
-00011520: 2020 2020 2020 2020 2020 6f6d 6974 5f73            omit_s
-00011530: 6974 6573 3d6f 6d69 745f 7369 7465 732c  ites=omit_sites,
-00011540: 0a20 2020 2020 2020 2020 2020 2063 616e  .            can
-00011550: 7661 735f 7369 7a65 3d63 616e 7661 735f  vas_size=canvas_
-00011560: 7369 7a65 2c0a 2020 2020 2020 2020 2020  size,.          
-00011570: 2020 2a2a 6b77 6172 6773 2c0a 2020 2020    **kwargs,.    
-00011580: 2020 2020 290a 2020 2020 2020 2020 6f75      ).        ou
-00011590: 7470 7574 203d 2064 7261 772e 6472 6177  tput = draw.draw
-000115a0: 696e 672e 746f 7374 7269 6e67 2829 0a20  ing.tostring(). 
-000115b0: 2020 2020 2020 2069 6620 7061 7468 2069         if path i
-000115c0: 7320 6e6f 7420 4e6f 6e65 3a0a 2020 2020  s not None:.    
-000115d0: 2020 2020 2020 2020 2320 544f 444f 3a20          # TODO: 
-000115e0: 7265 6d6f 7665 6420 7468 6520 7072 6574  removed the pret
-000115f0: 7479 2068 6572 6520 7768 656e 2074 6869  ty here when thi
-00011600: 7320 6973 2073 7461 626c 652e 0a20 2020  s is stable..   
-00011610: 2020 2020 2020 2020 2064 7261 772e 6472           draw.dr
-00011620: 6177 696e 672e 7361 7665 6173 2870 6174  awing.saveas(pat
-00011630: 682c 2070 7265 7474 793d 5472 7565 290a  h, pretty=True).
-00011640: 2020 2020 2020 2020 7265 7475 726e 2064          return d
-00011650: 7261 7769 6e67 2e53 5647 5374 7269 6e67  rawing.SVGString
-00011660: 286f 7574 7075 7429 0a0a 2020 2020 6465  (output)..    de
-00011670: 6620 6472 6177 280a 2020 2020 2020 2020  f draw(.        
-00011680: 7365 6c66 2c0a 2020 2020 2020 2020 7061  self,.        pa
-00011690: 7468 3d4e 6f6e 652c 0a20 2020 2020 2020  th=None,.       
-000116a0: 2077 6964 7468 3d4e 6f6e 652c 0a20 2020   width=None,.   
-000116b0: 2020 2020 2068 6569 6768 743d 4e6f 6e65       height=None
-000116c0: 2c0a 2020 2020 2020 2020 6e6f 6465 5f6c  ,.        node_l
-000116d0: 6162 656c 733d 4e6f 6e65 2c0a 2020 2020  abels=None,.    
-000116e0: 2020 2020 6e6f 6465 5f63 6f6c 6f75 7273      node_colours
-000116f0: 3d4e 6f6e 652c 0a20 2020 2020 2020 206d  =None,.        m
-00011700: 7574 6174 696f 6e5f 6c61 6265 6c73 3d4e  utation_labels=N
-00011710: 6f6e 652c 0a20 2020 2020 2020 206d 7574  one,.        mut
-00011720: 6174 696f 6e5f 636f 6c6f 7572 733d 4e6f  ation_colours=No
-00011730: 6e65 2c0a 2020 2020 2020 2020 666f 726d  ne,.        form
-00011740: 6174 3d4e 6f6e 652c 2020 2320 6e6f 7161  at=None,  # noqa
-00011750: 2041 3030 320a 2020 2020 2020 2020 6564   A002.        ed
-00011760: 6765 5f63 6f6c 6f75 7273 3d4e 6f6e 652c  ge_colours=None,
-00011770: 0a20 2020 2020 2020 2074 696d 655f 7363  .        time_sc
-00011780: 616c 653d 4e6f 6e65 2c0a 2020 2020 2020  ale=None,.      
-00011790: 2020 7472 6565 5f68 6569 6768 745f 7363    tree_height_sc
-000117a0: 616c 653d 4e6f 6e65 2c0a 2020 2020 2020  ale=None,.      
-000117b0: 2020 6d61 785f 7469 6d65 3d4e 6f6e 652c    max_time=None,
-000117c0: 0a20 2020 2020 2020 206d 696e 5f74 696d  .        min_tim
-000117d0: 653d 4e6f 6e65 2c0a 2020 2020 2020 2020  e=None,.        
-000117e0: 6d61 785f 7472 6565 5f68 6569 6768 743d  max_tree_height=
-000117f0: 4e6f 6e65 2c0a 2020 2020 2020 2020 6f72  None,.        or
-00011800: 6465 723d 4e6f 6e65 2c0a 2020 2020 2020  der=None,.      
-00011810: 2020 6f6d 6974 5f73 6974 6573 3d4e 6f6e    omit_sites=Non
-00011820: 652c 0a20 2020 2029 3a0a 2020 2020 2020  e,.    ):.      
-00011830: 2020 2222 220a 2020 2020 2020 2020 5265    """.        Re
-00011840: 7475 726e 7320 6120 6472 6177 696e 6720  turns a drawing 
-00011850: 6f66 2074 6869 7320 7472 6565 2e0a 0a20  of this tree... 
-00011860: 2020 2020 2020 2057 6865 6e20 776f 726b         When work
-00011870: 696e 6720 696e 2061 204a 7570 7974 6572  ing in a Jupyter
-00011880: 206e 6f74 6562 6f6f 6b2c 2075 7365 2074   notebook, use t
-00011890: 6865 2060 6049 5079 7468 6f6e 2e64 6973  he ``IPython.dis
-000118a0: 706c 6179 2e53 5647 6060 0a20 2020 2020  play.SVG``.     
-000118b0: 2020 2066 756e 6374 696f 6e20 746f 2064     function to d
-000118c0: 6973 706c 6179 2074 6865 2053 5647 206f  isplay the SVG o
-000118d0: 7574 7075 7420 6672 6f6d 2074 6869 7320  utput from this 
-000118e0: 6675 6e63 7469 6f6e 2069 6e6c 696e 6520  function inline 
-000118f0: 696e 2074 6865 206e 6f74 6562 6f6f 6b3a  in the notebook:
-00011900: 3a0a 0a20 2020 2020 2020 2020 2020 203e  :..            >
-00011910: 3e3e 2053 5647 2874 7265 652e 6472 6177  >> SVG(tree.draw
-00011920: 2829 290a 0a20 2020 2020 2020 2054 6865  ())..        The
-00011930: 2075 6e69 636f 6465 2066 6f72 6d61 7420   unicode format 
-00011940: 7573 6573 2075 6e69 636f 6465 2060 626f  uses unicode `bo
-00011950: 7820 6472 6177 696e 6720 6368 6172 6163  x drawing charac
-00011960: 7465 7273 0a20 2020 2020 2020 203c 6874  ters.        <ht
-00011970: 7470 733a 2f2f 656e 2e77 696b 6970 6564  tps://en.wikiped
-00011980: 6961 2e6f 7267 2f77 696b 692f 426f 782d  ia.org/wiki/Box-
-00011990: 6472 6177 696e 675f 6368 6172 6163 7465  drawing_characte
-000119a0: 723e 605f 2074 6f20 7265 6e64 6572 2074  r>`_ to render t
-000119b0: 6865 2074 7265 652e 0a20 2020 2020 2020  he tree..       
-000119c0: 2054 6869 7320 616c 6c6f 7773 2072 656e   This allows ren
-000119d0: 6465 7265 6420 7472 6565 7320 746f 2062  dered trees to b
-000119e0: 6520 7072 696e 7465 6420 6f75 7420 746f  e printed out to
-000119f0: 2074 6865 2074 6572 6d69 6e61 6c3a 3a0a   the terminal::.
-00011a00: 0a20 2020 2020 2020 2020 2020 203e 3e3e  .            >>>
-00011a10: 2070 7269 6e74 2874 7265 652e 6472 6177   print(tree.draw
-00011a20: 2866 6f72 6d61 743d 2275 6e69 636f 6465  (format="unicode
-00011a30: 2229 290a 2020 2020 2020 2020 2020 2020  ")).            
-00011a40: 2020 360a 2020 2020 2020 2020 2020 2020    6.            
-00011a50: e294 8fe2 9481 e294 bbe2 9481 e294 930a  ................
-00011a60: 2020 2020 2020 2020 2020 2020 e294 8320              ... 
-00011a70: 2020 350a 2020 2020 2020 2020 2020 2020    5.            
-00011a80: e294 8320 e294 8fe2 9481 e294 bbe2 9493  ... ............
-00011a90: 0a20 2020 2020 2020 2020 2020 20e2 9483  .            ...
-00011aa0: 20e2 9483 2020 340a 2020 2020 2020 2020   ...  4.        
-00011ab0: 2020 2020 e294 8320 e294 8320 e294 8fe2      ... ... ....
-00011ac0: 94bb e294 930a 2020 2020 2020 2020 2020  ......          
-00011ad0: 2020 3320 3020 3120 320a 0a20 2020 2020    3 0 1 2..     
-00011ae0: 2020 2054 6865 2060 606e 6f64 655f 6c61     The ``node_la
-00011af0: 6265 6c73 6060 2061 7267 756d 656e 7420  bels`` argument 
-00011b00: 616c 6c6f 7773 2074 6865 2075 7365 7220  allows the user 
-00011b10: 746f 2073 7065 6369 6679 2063 7573 746f  to specify custo
-00011b20: 6d20 6c61 6265 6c73 0a20 2020 2020 2020  m labels.       
-00011b30: 2066 6f72 206e 6f64 6573 2c20 6f72 206e   for nodes, or n
-00011b40: 6f20 6c61 6265 6c73 2061 7420 616c 6c3a  o labels at all:
-00011b50: 3a0a 0a20 2020 2020 2020 2020 2020 203e  :..            >
-00011b60: 3e3e 2070 7269 6e74 2874 7265 652e 6472  >> print(tree.dr
-00011b70: 6177 2866 6f72 6d61 743d 2275 6e69 636f  aw(format="unico
-00011b80: 6465 222c 206e 6f64 655f 6c61 6265 6c73  de", node_labels
-00011b90: 3d7b 7d29 290a 2020 2020 2020 2020 2020  ={})).          
-00011ba0: 2020 2020 e294 830a 2020 2020 2020 2020      ....        
-00011bb0: 2020 2020 e294 8fe2 9481 e294 bbe2 9481      ............
-00011bc0: e294 930a 2020 2020 2020 2020 2020 2020  ....            
-00011bd0: e294 8320 2020 e294 830a 2020 2020 2020  ...   ....      
-00011be0: 2020 2020 2020 e294 8320 e294 8fe2 9481        ... ......
-00011bf0: e294 bbe2 9493 0a20 2020 2020 2020 2020  .......         
-00011c00: 2020 20e2 9483 20e2 9483 2020 e294 830a     ... ...  ....
-00011c10: 2020 2020 2020 2020 2020 2020 e294 8320              ... 
-00011c20: e294 8320 e294 8fe2 94bb e294 930a 2020  ... ..........  
-00011c30: 2020 2020 2020 2020 2020 e294 8320 e294            ... ..
-00011c40: 8320 e294 8320 e294 830a 0a20 2020 2020  . ... .....     
-00011c50: 2020 204e 6f74 653a 2069 6e20 736f 6d65     Note: in some
-00011c60: 2065 6e76 6972 6f6e 6d65 6e74 7320 7375   environments su
-00011c70: 6368 2061 7320 4a75 7079 7465 7220 6e6f  ch as Jupyter no
-00011c80: 7465 626f 6f6b 7320 7769 7468 2057 696e  tebooks with Win
-00011c90: 646f 7773 206f 7220 4d61 632c 0a20 2020  dows or Mac,.   
-00011ca0: 2020 2020 2075 7365 7273 2068 6176 6520       users have 
-00011cb0: 6f62 7365 7276 6564 2074 6861 7420 7468  observed that th
-00011cc0: 6520 556e 6963 6f64 6520 626f 7820 6472  e Unicode box dr
-00011cd0: 6177 696e 6773 2063 616e 2062 6520 6d69  awings can be mi
-00011ce0: 7361 6c69 676e 6564 2e20 496e 0a20 2020  saligned. In.   
-00011cf0: 2020 2020 2074 6865 7365 2063 6173 6573       these cases
-00011d00: 2c20 7765 2072 6563 6f6d 6d65 6e64 2075  , we recommend u
-00011d10: 7369 6e67 2074 6865 2053 5647 206f 7220  sing the SVG or 
-00011d20: 4153 4349 4920 6469 7370 6c61 7920 666f  ASCII display fo
-00011d30: 726d 6174 7320 696e 7374 6561 642e 0a20  rmats instead.. 
-00011d40: 2020 2020 2020 2049 6620 796f 7520 6861         If you ha
-00011d50: 7665 2061 2073 7472 6f6e 6720 7072 6566  ve a strong pref
-00011d60: 6572 656e 6365 2066 6f72 2061 6c69 676e  erence for align
-00011d70: 6564 2055 6e69 636f 6465 2c20 796f 7520  ed Unicode, you 
-00011d80: 6361 6e20 7472 7920 6f75 7420 7468 650a  can try out the.
-00011d90: 2020 2020 2020 2020 736f 6c75 7469 6f6e          solution
-00011da0: 2064 6f63 756d 656e 7465 640a 2020 2020   documented.    
-00011db0: 2020 2020 6068 6572 6520 3c68 7474 7073      `here <https
-00011dc0: 3a2f 2f67 6974 6875 622e 636f 6d2f 7473  ://github.com/ts
-00011dd0: 6b69 742d 6465 762f 7473 6b69 742f 6973  kit-dev/tskit/is
-00011de0: 7375 6573 2f31 3839 2369 7373 7565 636f  sues/189#issueco
-00011df0: 6d6d 656e 742d 3439 3931 3134 3831 313e  mment-499114811>
-00011e00: 605f 2e0a 0a20 2020 2020 2020 203a 7061  `_...        :pa
-00011e10: 7261 6d20 7374 7220 7061 7468 3a20 5468  ram str path: Th
-00011e20: 6520 7061 7468 2074 6f20 7468 6520 6669  e path to the fi
-00011e30: 6c65 2074 6f20 7772 6974 6520 7468 6520  le to write the 
-00011e40: 6f75 7470 7574 2e20 4966 204e 6f6e 652c  output. If None,
-00011e50: 2064 6f20 6e6f 740a 2020 2020 2020 2020   do not.        
-00011e60: 2020 2020 7772 6974 6520 746f 2066 696c      write to fil
-00011e70: 652e 0a20 2020 2020 2020 203a 7061 7261  e..        :para
-00011e80: 6d20 696e 7420 7769 6474 683a 2054 6865  m int width: The
-00011e90: 2077 6964 7468 206f 6620 7468 6520 696d   width of the im
-00011ea0: 6167 6520 696e 2070 6978 656c 732e 2049  age in pixels. I
-00011eb0: 6620 6e6f 7420 7370 6563 6966 6965 642c  f not specified,
-00011ec0: 2065 6974 6865 720a 2020 2020 2020 2020   either.        
-00011ed0: 2020 2020 6465 6661 756c 7473 2074 6f20      defaults to 
-00011ee0: 7468 6520 6d69 6e69 6d75 6d20 7369 7a65  the minimum size
-00011ef0: 2072 6571 7569 7265 6420 746f 2064 6570   required to dep
-00011f00: 6963 7420 7468 6520 7472 6565 2028 7465  ict the tree (te
-00011f10: 7874 2066 6f72 6d61 7473 290a 2020 2020  xt formats).    
-00011f20: 2020 2020 2020 2020 6f72 2032 3030 2070          or 200 p
-00011f30: 6978 656c 732e 0a20 2020 2020 2020 203a  ixels..        :
-00011f40: 7061 7261 6d20 696e 7420 6865 6967 6874  param int height
-00011f50: 3a20 5468 6520 6865 6967 6874 206f 6620  : The height of 
-00011f60: 7468 6520 696d 6167 6520 696e 2070 6978  the image in pix
-00011f70: 656c 732e 2049 6620 6e6f 7420 7370 6563  els. If not spec
-00011f80: 6966 6965 642c 2065 6974 6865 720a 2020  ified, either.  
-00011f90: 2020 2020 2020 2020 2020 6465 6661 756c            defaul
-00011fa0: 7473 2074 6f20 7468 6520 6d69 6e69 6d75  ts to the minimu
-00011fb0: 6d20 7369 7a65 2072 6571 7569 7265 6420  m size required 
-00011fc0: 746f 2064 6570 6963 7420 7468 6520 7472  to depict the tr
-00011fd0: 6565 2028 7465 7874 2066 6f72 6d61 7473  ee (text formats
-00011fe0: 290a 2020 2020 2020 2020 2020 2020 6f72  ).            or
-00011ff0: 2032 3030 2070 6978 656c 732e 0a20 2020   200 pixels..   
-00012000: 2020 2020 203a 7061 7261 6d20 6469 6374       :param dict
-00012010: 206e 6f64 655f 6c61 6265 6c73 3a20 4966   node_labels: If
-00012020: 2073 7065 6369 6669 6564 2c20 7368 6f77   specified, show
-00012030: 2063 7573 746f 6d20 6c61 6265 6c73 2066   custom labels f
-00012040: 6f72 2074 6865 206e 6f64 6573 0a20 2020  or the nodes.   
-00012050: 2020 2020 2020 2020 2074 6861 7420 6172           that ar
-00012060: 6520 7072 6573 656e 7420 696e 2074 6865  e present in the
-00012070: 206d 6170 2e20 416e 7920 6e6f 6465 7320   map. Any nodes 
-00012080: 6e6f 7420 7370 6563 6966 6965 6420 696e  not specified in
-00012090: 2074 6865 206d 6170 2077 696c 6c0a 2020   the map will.  
-000120a0: 2020 2020 2020 2020 2020 6e6f 7420 6861            not ha
-000120b0: 7665 2061 206e 6f64 6520 6c61 6265 6c2e  ve a node label.
-000120c0: 0a20 2020 2020 2020 203a 7061 7261 6d20  .        :param 
-000120d0: 6469 6374 206e 6f64 655f 636f 6c6f 7572  dict node_colour
-000120e0: 733a 2049 6620 7370 6563 6966 6965 642c  s: If specified,
-000120f0: 2073 686f 7720 6375 7374 6f6d 2063 6f6c   show custom col
-00012100: 6f75 7273 2066 6f72 2074 6865 206e 6f64  ours for the nod
-00012110: 6573 0a20 2020 2020 2020 2020 2020 2067  es.            g
-00012120: 6976 656e 2069 6e20 7468 6520 6d61 702e  iven in the map.
-00012130: 2041 6e79 206e 6f64 6573 206e 6f74 2073   Any nodes not s
-00012140: 7065 6369 6669 6564 2069 6e20 7468 6520  pecified in the 
-00012150: 6d61 7020 7769 6c6c 2074 616b 6520 7468  map will take th
-00012160: 6520 6465 6661 756c 740a 2020 2020 2020  e default.      
-00012170: 2020 2020 2020 636f 6c6f 7572 3b20 6120        colour; a 
-00012180: 7661 6c75 6520 6f66 2060 604e 6f6e 6560  value of ``None`
-00012190: 6020 6973 2074 7265 6174 6564 2061 7320  ` is treated as 
-000121a0: 7472 616e 7370 6172 656e 7420 616e 6420  transparent and 
-000121b0: 6865 6e63 6520 7468 6520 6e6f 6465 0a20  hence the node. 
-000121c0: 2020 2020 2020 2020 2020 2073 796d 626f             symbo
-000121d0: 6c20 6973 206e 6f74 2070 6c6f 7474 6564  l is not plotted
-000121e0: 2e20 284f 6e6c 7920 7375 7070 6f72 7465  . (Only supporte
-000121f0: 6420 696e 2074 6865 2053 5647 2066 6f72  d in the SVG for
-00012200: 6d61 742e 290a 2020 2020 2020 2020 3a70  mat.).        :p
-00012210: 6172 616d 2064 6963 7420 6d75 7461 7469  aram dict mutati
-00012220: 6f6e 5f6c 6162 656c 733a 2049 6620 7370  on_labels: If sp
-00012230: 6563 6966 6965 642c 2073 686f 7720 6375  ecified, show cu
-00012240: 7374 6f6d 206c 6162 656c 7320 666f 7220  stom labels for 
-00012250: 7468 6520 6d75 7461 7469 6f6e 730a 2020  the mutations.  
-00012260: 2020 2020 2020 2020 2020 2873 7065 6369            (speci
-00012270: 6669 6564 2062 7920 4944 2920 7468 6174  fied by ID) that
-00012280: 2061 7265 2070 7265 7365 6e74 2069 6e20   are present in 
-00012290: 7468 6520 6d61 702e 2041 6e79 206d 7574  the map. Any mut
-000122a0: 6174 696f 6e73 206e 6f74 2069 6e20 7468  ations not in th
-000122b0: 6520 6d61 700a 2020 2020 2020 2020 2020  e map.          
-000122c0: 2020 7769 6c6c 206e 6f74 2068 6176 6520    will not have 
-000122d0: 6120 6c61 6265 6c2e 2028 5368 6f77 696e  a label. (Showin
-000122e0: 6720 6d75 7461 7469 6f6e 7320 6973 2063  g mutations is c
-000122f0: 7572 7265 6e74 6c79 206f 6e6c 7920 7375  urrently only su
-00012300: 7070 6f72 7465 6420 696e 2074 6865 0a20  pported in the. 
-00012310: 2020 2020 2020 2020 2020 2053 5647 2066             SVG f
-00012320: 6f72 6d61 7429 0a20 2020 2020 2020 203a  ormat).        :
-00012330: 7061 7261 6d20 6469 6374 206d 7574 6174  param dict mutat
-00012340: 696f 6e5f 636f 6c6f 7572 733a 2049 6620  ion_colours: If 
-00012350: 7370 6563 6966 6965 642c 2073 686f 7720  specified, show 
-00012360: 6375 7374 6f6d 2063 6f6c 6f75 7273 2066  custom colours f
-00012370: 6f72 2074 6865 206d 7574 6174 696f 6e73  or the mutations
-00012380: 0a20 2020 2020 2020 2020 2020 2067 6976  .            giv
-00012390: 656e 2069 6e20 7468 6520 6d61 7020 2873  en in the map (s
-000123a0: 7065 6369 6669 6564 2062 7920 4944 292e  pecified by ID).
-000123b0: 2041 7320 666f 7220 6060 6e6f 6465 5f63   As for ``node_c
-000123c0: 6f6c 6f75 7273 6060 2c20 6d75 7461 7469  olours``, mutati
-000123d0: 6f6e 7320 6e6f 740a 2020 2020 2020 2020  ons not.        
-000123e0: 2020 2020 7072 6573 656e 7420 696e 2074      present in t
-000123f0: 6865 206d 6170 2074 616b 6520 7468 6520  he map take the 
-00012400: 6465 6661 756c 7420 636f 6c6f 7572 2c20  default colour, 
-00012410: 616e 6420 7468 6f73 6520 6d61 7070 696e  and those mappin
-00012420: 6720 746f 2060 604e 6f6e 6560 600a 2020  g to ``None``.  
-00012430: 2020 2020 2020 2020 2020 6172 6520 6e6f            are no
-00012440: 7420 6472 6177 6e2e 2028 4f6e 6c79 2073  t drawn. (Only s
-00012450: 7570 706f 7274 6564 2069 6e20 7468 6520  upported in the 
-00012460: 5356 4720 666f 726d 6174 2e29 0a20 2020  SVG format.).   
-00012470: 2020 2020 203a 7061 7261 6d20 7374 7220       :param str 
-00012480: 666f 726d 6174 3a20 5468 6520 666f 726d  format: The form
-00012490: 6174 206f 6620 7468 6520 7265 7475 726e  at of the return
-000124a0: 6564 2069 6d61 6765 2e20 4375 7272 656e  ed image. Curren
-000124b0: 746c 7920 7375 7070 6f72 7465 640a 2020  tly supported.  
-000124c0: 2020 2020 2020 2020 2020 6172 6520 2773            are 's
-000124d0: 7667 272c 2027 6173 6369 6927 2061 6e64  vg', 'ascii' and
-000124e0: 2027 756e 6963 6f64 6527 2e20 4e6f 7465   'unicode'. Note
-000124f0: 2074 6861 7420 7468 6520 3a6d 6574 683a   that the :meth:
-00012500: 6054 7265 652e 6472 6177 5f73 7667 600a  `Tree.draw_svg`.
-00012510: 2020 2020 2020 2020 2020 2020 6d65 7468              meth
-00012520: 6f64 2070 726f 7669 6465 7320 6d6f 7265  od provides more
-00012530: 2063 6f6d 7072 6568 656e 7369 7665 2066   comprehensive f
-00012540: 756e 6374 696f 6e61 6c69 7479 2066 6f72  unctionality for
-00012550: 2063 7265 6174 696e 6720 5356 4773 2e0a   creating SVGs..
-00012560: 2020 2020 2020 2020 3a70 6172 616d 2064          :param d
-00012570: 6963 7420 6564 6765 5f63 6f6c 6f75 7273  ict edge_colours
-00012580: 3a20 4966 2073 7065 6369 6669 6564 2c20  : If specified, 
-00012590: 7368 6f77 2063 7573 746f 6d20 636f 6c6f  show custom colo
-000125a0: 7572 7320 666f 7220 7468 6520 6564 6765  urs for the edge
-000125b0: 0a20 2020 2020 2020 2020 2020 206a 6f69  .            joi
-000125c0: 6e69 6e67 2065 6163 6820 6e6f 6465 2069  ning each node i
-000125d0: 6e20 7468 6520 6d61 7020 746f 2069 7473  n the map to its
-000125e0: 2070 6172 656e 742e 2041 7320 666f 7220   parent. As for 
-000125f0: 6060 6e6f 6465 5f63 6f6c 6f75 7273 6060  ``node_colours``
-00012600: 2c0a 2020 2020 2020 2020 2020 2020 756e  ,.            un
-00012610: 7370 6563 6966 6965 6420 6564 6765 7320  specified edges 
-00012620: 7461 6b65 2074 6865 2064 6566 6175 6c74  take the default
-00012630: 2063 6f6c 6f75 722c 2061 6e64 2060 604e   colour, and ``N
-00012640: 6f6e 6560 6020 7661 6c75 6573 2072 6573  one`` values res
-00012650: 756c 7420 696e 2074 6865 0a20 2020 2020  ult in the.     
-00012660: 2020 2020 2020 2065 6467 6520 6265 696e         edge bein
-00012670: 6720 6f6d 6974 7465 642e 2028 4f6e 6c79  g omitted. (Only
-00012680: 2073 7570 706f 7274 6564 2069 6e20 7468   supported in th
-00012690: 6520 5356 4720 666f 726d 6174 2e29 0a20  e SVG format.). 
-000126a0: 2020 2020 2020 203a 7061 7261 6d20 7374         :param st
-000126b0: 7220 7469 6d65 5f73 6361 6c65 3a20 436f  r time_scale: Co
-000126c0: 6e74 726f 6c20 686f 7720 6865 6967 6874  ntrol how height
-000126d0: 2076 616c 7565 7320 666f 7220 6e6f 6465   values for node
-000126e0: 7320 6172 6520 636f 6d70 7574 6564 2e0a  s are computed..
-000126f0: 2020 2020 2020 2020 2020 2020 4966 2074              If t
-00012700: 6869 7320 6973 2065 7175 616c 2074 6f20  his is equal to 
-00012710: 6060 2274 696d 6522 6060 2c20 6e6f 6465  ``"time"``, node
-00012720: 2068 6569 6768 7473 2061 7265 2070 726f   heights are pro
-00012730: 706f 7274 696f 6e61 6c20 746f 2074 6865  portional to the
-00012740: 6972 2074 696d 650a 2020 2020 2020 2020  ir time.        
-00012750: 2020 2020 7661 6c75 6573 2e20 4966 2074      values. If t
-00012760: 6869 7320 6973 2065 7175 616c 2074 6f20  his is equal to 
-00012770: 6060 226c 6f67 5f74 696d 6522 6060 2c20  ``"log_time"``, 
-00012780: 6e6f 6465 2068 6569 6768 7473 2061 7265  node heights are
-00012790: 2070 726f 706f 7274 696f 6e61 6c20 746f   proportional to
-000127a0: 0a20 2020 2020 2020 2020 2020 2074 6865  .            the
-000127b0: 6972 206c 6f67 2874 696d 6529 2076 616c  ir log(time) val
-000127c0: 7565 732e 2049 6620 6974 2069 7320 6571  ues. If it is eq
-000127d0: 7561 6c20 746f 2060 6022 7261 6e6b 2260  ual to ``"rank"`
-000127e0: 602c 206e 6f64 6520 6865 6967 6874 7320  `, node heights 
-000127f0: 6172 6520 7370 6163 6564 0a20 2020 2020  are spaced.     
-00012800: 2020 2020 2020 2065 7175 616c 6c79 2061         equally a
-00012810: 6363 6f72 6469 6e67 2074 6f20 7468 6569  ccording to thei
-00012820: 7220 7261 6e6b 6564 2074 696d 6573 2e20  r ranked times. 
-00012830: 466f 7220 5356 4720 6f75 7470 7574 2074  For SVG output t
-00012840: 6865 2064 6566 6175 6c74 2069 730a 2020  he default is.  
-00012850: 2020 2020 2020 2020 2020 2774 696d 6527            'time'
-00012860: 2d73 6361 6c65 2077 6865 7265 6173 2066  -scale whereas f
-00012870: 6f72 2074 6578 7420 6f75 7470 7574 2074  or text output t
-00012880: 6865 2064 6566 6175 6c74 2069 7320 2772  he default is 'r
-00012890: 616e 6b27 2d73 6361 6c65 2e0a 2020 2020  ank'-scale..    
-000128a0: 2020 2020 2020 2020 5469 6d65 2073 6361          Time sca
-000128b0: 6c69 6e67 2069 7320 6e6f 7420 6375 7272  ling is not curr
-000128c0: 656e 746c 7920 7375 7070 6f72 7465 6420  ently supported 
-000128d0: 666f 7220 7465 7874 206f 7574 7075 742e  for text output.
-000128e0: 0a20 2020 2020 2020 203a 7061 7261 6d20  .        :param 
-000128f0: 7374 7220 7472 6565 5f68 6569 6768 745f  str tree_height_
-00012900: 7363 616c 653a 2044 6570 7265 6361 7465  scale: Deprecate
-00012910: 6420 616c 6961 7320 666f 7220 7469 6d65  d alias for time
-00012920: 5f73 6361 6c65 2e20 2844 6570 7265 6361  _scale. (Depreca
-00012930: 7465 6420 696e 0a20 2020 2020 2020 2020  ted in.         
-00012940: 2020 2020 2020 2030 2e33 2e36 290a 2020         0.3.6).  
-00012950: 2020 2020 2020 3a70 6172 616d 2073 7472        :param str
-00012960: 2c66 6c6f 6174 206d 6178 5f74 696d 653a  ,float max_time:
-00012970: 2054 6865 206d 6178 696d 756d 2074 696d   The maximum tim
-00012980: 6520 7661 6c75 6520 696e 2074 6865 2063  e value in the c
-00012990: 7572 7265 6e74 0a20 2020 2020 2020 2020  urrent.         
-000129a0: 2020 2073 6361 6c69 6e67 2073 7973 7465     scaling syste
-000129b0: 6d20 2873 6565 2060 6074 696d 655f 7363  m (see ``time_sc
-000129c0: 616c 6560 6029 2e20 4361 6e20 6265 2065  ale``). Can be e
-000129d0: 6974 6865 7220 6120 7374 7269 6e67 206f  ither a string o
-000129e0: 7220 610a 2020 2020 2020 2020 2020 2020  r a.            
-000129f0: 6e75 6d65 7269 6320 7661 6c75 652e 2049  numeric value. I
-00012a00: 6620 6571 7561 6c20 746f 2060 6022 7472  f equal to ``"tr
-00012a10: 6565 2260 602c 2074 6865 206d 6178 696d  ee"``, the maxim
-00012a20: 756d 2074 696d 6520 6973 2073 6574 2074  um time is set t
-00012a30: 6f20 6265 0a20 2020 2020 2020 2020 2020  o be.           
-00012a40: 2074 6861 7420 6f66 2074 6865 206f 6c64   that of the old
-00012a50: 6573 7420 726f 6f74 2069 6e20 7468 6520  est root in the 
-00012a60: 7472 6565 2e20 4966 2065 7175 616c 2074  tree. If equal t
-00012a70: 6f20 6060 2274 7322 6060 2074 6865 206d  o ``"ts"`` the m
-00012a80: 6178 696d 756d 0a20 2020 2020 2020 2020  aximum.         
-00012a90: 2020 2074 696d 6520 6973 2073 6574 2074     time is set t
-00012aa0: 6f20 6265 2074 6865 2074 696d 6520 6f66  o be the time of
-00012ab0: 2074 6865 206f 6c64 6573 7420 726f 6f74   the oldest root
-00012ac0: 2069 6e20 7468 6520 7472 6565 2073 6571   in the tree seq
-00012ad0: 7565 6e63 653b 0a20 2020 2020 2020 2020  uence;.         
-00012ae0: 2020 2074 6869 7320 6973 2075 7365 6675     this is usefu
-00012af0: 6c20 7768 656e 2064 7261 7769 6e67 2074  l when drawing t
-00012b00: 7265 6573 2066 726f 6d20 7468 6520 7361  rees from the sa
-00012b10: 6d65 2074 7265 6520 7365 7175 656e 6365  me tree sequence
-00012b20: 2061 7320 6974 2065 6e73 7572 6573 0a20   as it ensures. 
-00012b30: 2020 2020 2020 2020 2020 2074 6861 7420             that 
-00012b40: 6e6f 6465 2068 6569 6768 7473 2061 7265  node heights are
-00012b50: 2063 6f6e 7369 7374 656e 742e 2049 6620   consistent. If 
-00012b60: 6120 6e75 6d65 7269 6320 7661 6c75 652c  a numeric value,
-00012b70: 2074 6869 7320 6973 2075 7365 6420 6173   this is used as
-00012b80: 2074 6865 0a20 2020 2020 2020 2020 2020   the.           
-00012b90: 206d 6178 696d 756d 2074 696d 6520 6279   maximum time by
-00012ba0: 2077 6869 6368 2074 6f20 7363 616c 6520   which to scale 
-00012bb0: 6f74 6865 7220 6e6f 6465 732e 2054 6869  other nodes. Thi
-00012bc0: 7320 7061 7261 6d65 7465 720a 2020 2020  s parameter.    
-00012bd0: 2020 2020 2020 2020 6973 206e 6f74 2063          is not c
-00012be0: 7572 7265 6e74 6c79 2073 7570 706f 7274  urrently support
-00012bf0: 6564 2066 6f72 2074 6578 7420 6f75 7470  ed for text outp
-00012c00: 7574 2e0a 2020 2020 2020 2020 3a70 6172  ut..        :par
-00012c10: 616d 2073 7472 2c66 6c6f 6174 206d 696e  am str,float min
-00012c20: 5f74 696d 653a 2054 6865 206d 696e 696d  _time: The minim
-00012c30: 756d 2074 696d 6520 7661 6c75 6520 696e  um time value in
-00012c40: 2074 6865 2063 7572 7265 6e74 0a20 2020   the current.   
-00012c50: 2020 2020 2020 2020 2073 6361 6c69 6e67           scaling
-00012c60: 2073 7973 7465 6d20 2873 6565 2060 6074   system (see ``t
-00012c70: 696d 655f 7363 616c 6560 6029 2e20 4361  ime_scale``). Ca
-00012c80: 6e20 6265 2065 6974 6865 7220 6120 7374  n be either a st
-00012c90: 7269 6e67 206f 7220 610a 2020 2020 2020  ring or a.      
-00012ca0: 2020 2020 2020 6e75 6d65 7269 6320 7661        numeric va
-00012cb0: 6c75 652e 2049 6620 6571 7561 6c20 746f  lue. If equal to
-00012cc0: 2060 6022 7472 6565 2260 602c 2074 6865   ``"tree"``, the
-00012cd0: 206d 696e 696d 756d 2074 696d 6520 6973   minimum time is
-00012ce0: 2073 6574 2074 6f20 6265 0a20 2020 2020   set to be.     
-00012cf0: 2020 2020 2020 2074 6861 7420 6f66 2074         that of t
-00012d00: 6865 2079 6f75 6e67 6573 7420 6e6f 6465  he youngest node
-00012d10: 2069 6e20 7468 6520 7472 6565 2e20 4966   in the tree. If
-00012d20: 2065 7175 616c 2074 6f20 6060 2274 7322   equal to ``"ts"
-00012d30: 6060 2074 6865 206d 696e 696d 756d 0a20  `` the minimum. 
-00012d40: 2020 2020 2020 2020 2020 2074 696d 6520             time 
-00012d50: 6973 2073 6574 2074 6f20 6265 2074 6865  is set to be the
-00012d60: 2074 696d 6520 6f66 2074 6865 2079 6f75   time of the you
-00012d70: 6e67 6573 7420 6e6f 6465 2069 6e20 7468  ngest node in th
-00012d80: 6520 7472 6565 2073 6571 7565 6e63 653b  e tree sequence;
-00012d90: 0a20 2020 2020 2020 2020 2020 2074 6869  .            thi
-00012da0: 7320 6973 2075 7365 6675 6c20 7768 656e  s is useful when
-00012db0: 2064 7261 7769 6e67 2074 7265 6573 2066   drawing trees f
-00012dc0: 726f 6d20 7468 6520 7361 6d65 2074 7265  rom the same tre
-00012dd0: 6520 7365 7175 656e 6365 2061 7320 6974  e sequence as it
-00012de0: 2065 6e73 7572 6573 0a20 2020 2020 2020   ensures.       
-00012df0: 2020 2020 2074 6861 7420 6e6f 6465 2068       that node h
-00012e00: 6569 6768 7473 2061 7265 2063 6f6e 7369  eights are consi
-00012e10: 7374 656e 742e 2049 6620 6120 6e75 6d65  stent. If a nume
-00012e20: 7269 6320 7661 6c75 652c 2074 6869 7320  ric value, this 
-00012e30: 6973 2075 7365 6420 6173 2074 6865 0a20  is used as the. 
-00012e40: 2020 2020 2020 2020 2020 206d 696e 696d             minim
-00012e50: 756d 2074 696d 6520 746f 2064 6973 706c  um time to displ
-00012e60: 6179 2e20 5468 6973 2070 6172 616d 6574  ay. This paramet
-00012e70: 6572 2069 7320 6e6f 7420 6375 7272 656e  er is not curren
-00012e80: 746c 7920 7375 7070 6f72 7465 6420 666f  tly supported fo
-00012e90: 7220 7465 7874 0a20 2020 2020 2020 2020  r text.         
-00012ea0: 2020 206f 7574 7075 742e 0a20 2020 2020     output..     
-00012eb0: 2020 203a 7061 7261 6d20 7374 7220 6d61     :param str ma
-00012ec0: 785f 7472 6565 5f68 6569 6768 743a 2044  x_tree_height: D
-00012ed0: 6570 7265 6361 7465 6420 616c 6961 7320  eprecated alias 
-00012ee0: 666f 7220 6d61 785f 7469 6d65 2e20 2844  for max_time. (D
-00012ef0: 6570 7265 6361 7465 6420 696e 0a20 2020  eprecated in.   
-00012f00: 2020 2020 2020 2020 2020 2020 2030 2e33               0.3
-00012f10: 2e36 290a 2020 2020 2020 2020 3a70 6172  .6).        :par
-00012f20: 616d 2073 7472 206f 7264 6572 3a20 5468  am str order: Th
-00012f30: 6520 6c65 6674 2d74 6f2d 7269 6768 7420  e left-to-right 
-00012f40: 6f72 6465 7269 6e67 206f 6620 6368 696c  ordering of chil
-00012f50: 6420 6e6f 6465 7320 696e 2074 6865 2064  d nodes in the d
-00012f60: 7261 776e 2074 7265 652e 0a20 2020 2020  rawn tree..     
-00012f70: 2020 2020 2020 2054 6869 7320 6361 6e20         This can 
-00012f80: 6265 2065 6974 6865 723a 2060 6022 6d69  be either: ``"mi
-00012f90: 6e6c 6578 2260 602c 2077 6869 6368 206d  nlex"``, which m
-00012fa0: 696e 696d 6973 6573 2074 6865 2064 6966  inimises the dif
-00012fb0: 6665 7265 6e63 6573 0a20 2020 2020 2020  ferences.       
-00012fc0: 2020 2020 2062 6574 7765 656e 2061 646a       between adj
-00012fd0: 6163 656e 7420 7472 6565 7320 2873 6565  acent trees (see
-00012fe0: 2061 6c73 6f20 7468 6520 6060 226d 696e   also the ``"min
-00012ff0: 6c65 785f 706f 7374 6f72 6465 7222 6060  lex_postorder"``
-00013000: 2074 7261 7665 7273 616c 0a20 2020 2020   traversal.     
-00013010: 2020 2020 2020 206f 7264 6572 2066 6f72         order for
-00013020: 2074 6865 203a 6d65 7468 3a60 2e6e 6f64   the :meth:`.nod
-00013030: 6573 6020 6d65 7468 6f64 293b 206f 7220  es` method); or 
-00013040: 6060 2274 7265 6522 6060 2077 6869 6368  ``"tree"`` which
-00013050: 2064 7261 7773 2074 7265 6573 0a20 2020   draws trees.   
-00013060: 2020 2020 2020 2020 2069 6e20 7468 6520           in the 
-00013070: 6c65 6674 2d74 6f2d 7269 6768 7420 6f72  left-to-right or
-00013080: 6465 7220 6465 6669 6e65 6420 6279 2074  der defined by t
-00013090: 6865 0a20 2020 2020 2020 2020 2020 203a  he.            :
-000130a0: 7265 663a 6071 7569 6e74 7570 6c79 206c  ref:`quintuply l
-000130b0: 696e 6b65 6420 7472 6565 2073 7472 7563  inked tree struc
-000130c0: 7475 7265 203c 7365 635f 6461 7461 5f6d  ture <sec_data_m
-000130d0: 6f64 656c 5f74 7265 655f 7374 7275 6374  odel_tree_struct
-000130e0: 7572 653e 602e 0a20 2020 2020 2020 2020  ure>`..         
-000130f0: 2020 2049 6620 6e6f 7420 7370 6563 6966     If not specif
-00013100: 6965 6420 6f72 204e 6f6e 652c 2074 6869  ied or None, thi
-00013110: 7320 6465 6661 756c 7473 2074 6f20 6060  s defaults to ``
-00013120: 226d 696e 6c65 7822 6060 2e0a 2020 2020  "minlex"``..    
-00013130: 2020 2020 3a70 6172 616d 2062 6f6f 6c20      :param bool 
-00013140: 6f6d 6974 5f73 6974 6573 3a20 4966 2054  omit_sites: If T
-00013150: 7275 652c 206f 6d69 7420 7369 7465 7320  rue, omit sites 
-00013160: 616e 6420 6d75 7461 7469 6f6e 7320 6672  and mutations fr
-00013170: 6f6d 2074 6865 2064 7261 7769 6e67 0a20  om the drawing. 
-00013180: 2020 2020 2020 2020 2020 2028 6f6e 6c79             (only
-00013190: 2072 656c 6576 616e 7420 746f 2074 6865   relevant to the
-000131a0: 2053 5647 2066 6f72 6d61 7429 2e20 4465   SVG format). De
-000131b0: 6661 756c 743a 2046 616c 7365 0a20 2020  fault: False.   
-000131c0: 2020 2020 203a 7265 7475 726e 3a20 4120       :return: A 
-000131d0: 7265 7072 6573 656e 7461 7469 6f6e 206f  representation o
-000131e0: 6620 7468 6973 2074 7265 6520 696e 2074  f this tree in t
-000131f0: 6865 2072 6571 7565 7374 6564 2066 6f72  he requested for
-00013200: 6d61 742e 0a20 2020 2020 2020 203a 7274  mat..        :rt
-00013210: 7970 653a 2073 7472 0a20 2020 2020 2020  ype: str.       
-00013220: 2022 2222 0a20 2020 2020 2020 206f 7574   """.        out
-00013230: 7075 7420 3d20 6472 6177 696e 672e 6472  put = drawing.dr
-00013240: 6177 5f74 7265 6528 0a20 2020 2020 2020  aw_tree(.       
-00013250: 2020 2020 2073 656c 662c 0a20 2020 2020       self,.     
-00013260: 2020 2020 2020 2066 6f72 6d61 743d 666f         format=fo
-00013270: 726d 6174 2c0a 2020 2020 2020 2020 2020  rmat,.          
-00013280: 2020 7769 6474 683d 7769 6474 682c 0a20    width=width,. 
-00013290: 2020 2020 2020 2020 2020 2068 6569 6768             heigh
-000132a0: 743d 6865 6967 6874 2c0a 2020 2020 2020  t=height,.      
-000132b0: 2020 2020 2020 6e6f 6465 5f6c 6162 656c        node_label
-000132c0: 733d 6e6f 6465 5f6c 6162 656c 732c 0a20  s=node_labels,. 
-000132d0: 2020 2020 2020 2020 2020 206e 6f64 655f             node_
-000132e0: 636f 6c6f 7572 733d 6e6f 6465 5f63 6f6c  colours=node_col
-000132f0: 6f75 7273 2c0a 2020 2020 2020 2020 2020  ours,.          
-00013300: 2020 6d75 7461 7469 6f6e 5f6c 6162 656c    mutation_label
-00013310: 733d 6d75 7461 7469 6f6e 5f6c 6162 656c  s=mutation_label
-00013320: 732c 0a20 2020 2020 2020 2020 2020 206d  s,.            m
-00013330: 7574 6174 696f 6e5f 636f 6c6f 7572 733d  utation_colours=
-00013340: 6d75 7461 7469 6f6e 5f63 6f6c 6f75 7273  mutation_colours
-00013350: 2c0a 2020 2020 2020 2020 2020 2020 6564  ,.            ed
-00013360: 6765 5f63 6f6c 6f75 7273 3d65 6467 655f  ge_colours=edge_
-00013370: 636f 6c6f 7572 732c 0a20 2020 2020 2020  colours,.       
-00013380: 2020 2020 2074 696d 655f 7363 616c 653d       time_scale=
-00013390: 7469 6d65 5f73 6361 6c65 2c0a 2020 2020  time_scale,.    
-000133a0: 2020 2020 2020 2020 7472 6565 5f68 6569          tree_hei
-000133b0: 6768 745f 7363 616c 653d 7472 6565 5f68  ght_scale=tree_h
-000133c0: 6569 6768 745f 7363 616c 652c 0a20 2020  eight_scale,.   
-000133d0: 2020 2020 2020 2020 206d 6178 5f74 696d           max_tim
-000133e0: 653d 6d61 785f 7469 6d65 2c0a 2020 2020  e=max_time,.    
-000133f0: 2020 2020 2020 2020 6d69 6e5f 7469 6d65          min_time
-00013400: 3d6d 696e 5f74 696d 652c 0a20 2020 2020  =min_time,.     
-00013410: 2020 2020 2020 206d 6178 5f74 7265 655f         max_tree_
-00013420: 6865 6967 6874 3d6d 6178 5f74 7265 655f  height=max_tree_
-00013430: 6865 6967 6874 2c0a 2020 2020 2020 2020  height,.        
-00013440: 2020 2020 6f72 6465 723d 6f72 6465 722c      order=order,
-00013450: 0a20 2020 2020 2020 2020 2020 206f 6d69  .            omi
-00013460: 745f 7369 7465 733d 6f6d 6974 5f73 6974  t_sites=omit_sit
-00013470: 6573 2c0a 2020 2020 2020 2020 290a 2020  es,.        ).  
-00013480: 2020 2020 2020 6966 2070 6174 6820 6973        if path is
-00013490: 206e 6f74 204e 6f6e 653a 0a20 2020 2020   not None:.     
-000134a0: 2020 2020 2020 2077 6974 6820 6f70 656e         with open
-000134b0: 2870 6174 682c 2022 7722 2920 6173 2066  (path, "w") as f
-000134c0: 3a0a 2020 2020 2020 2020 2020 2020 2020  :.              
-000134d0: 2020 662e 7772 6974 6528 6f75 7470 7574    f.write(output
-000134e0: 290a 2020 2020 2020 2020 7265 7475 726e  ).        return
-000134f0: 206f 7574 7075 740a 0a20 2020 2064 6566   output..    def
-00013500: 2067 6574 5f6e 756d 5f6d 7574 6174 696f   get_num_mutatio
-00013510: 6e73 2873 656c 6629 3a0a 2020 2020 2020  ns(self):.      
-00013520: 2020 7265 7475 726e 2073 656c 662e 6e75    return self.nu
-00013530: 6d5f 6d75 7461 7469 6f6e 730a 0a20 2020  m_mutations..   
-00013540: 2040 7072 6f70 6572 7479 0a20 2020 2064   @property.    d
-00013550: 6566 206e 756d 5f6d 7574 6174 696f 6e73  ef num_mutations
-00013560: 2873 656c 6629 3a0a 2020 2020 2020 2020  (self):.        
-00013570: 2222 220a 2020 2020 2020 2020 5265 7475  """.        Retu
-00013580: 726e 7320 7468 6520 746f 7461 6c20 6e75  rns the total nu
-00013590: 6d62 6572 206f 6620 6d75 7461 7469 6f6e  mber of mutation
-000135a0: 7320 6163 726f 7373 2061 6c6c 2073 6974  s across all sit
-000135b0: 6573 206f 6e20 7468 6973 2074 7265 652e  es on this tree.
-000135c0: 0a0a 2020 2020 2020 2020 3a72 6574 7572  ..        :retur
-000135d0: 6e3a 2054 6865 2074 6f74 616c 206e 756d  n: The total num
-000135e0: 6265 7220 6f66 206d 7574 6174 696f 6e73  ber of mutations
-000135f0: 206f 7665 7220 616c 6c20 7369 7465 7320   over all sites 
-00013600: 6f6e 2074 6869 7320 7472 6565 2e0a 2020  on this tree..  
-00013610: 2020 2020 2020 3a72 7479 7065 3a20 696e        :rtype: in
-00013620: 740a 2020 2020 2020 2020 2222 220a 2020  t.        """.  
-00013630: 2020 2020 2020 7265 7475 726e 2073 756d        return sum
-00013640: 286c 656e 2873 6974 652e 6d75 7461 7469  (len(site.mutati
-00013650: 6f6e 7329 2066 6f72 2073 6974 6520 696e  ons) for site in
-00013660: 2073 656c 662e 7369 7465 7328 2929 0a0a   self.sites())..
-00013670: 2020 2020 4070 726f 7065 7274 790a 2020      @property.  
-00013680: 2020 6465 6620 6e75 6d5f 7369 7465 7328    def num_sites(
-00013690: 7365 6c66 293a 0a20 2020 2020 2020 2022  self):.        "
-000136a0: 2222 0a20 2020 2020 2020 2052 6574 7572  "".        Retur
-000136b0: 6e73 2074 6865 206e 756d 6265 7220 6f66  ns the number of
-000136c0: 2073 6974 6573 206f 6e20 7468 6973 2074   sites on this t
-000136d0: 7265 652e 0a0a 2020 2020 2020 2020 3a72  ree...        :r
-000136e0: 6574 7572 6e3a 2054 6865 206e 756d 6265  eturn: The numbe
-000136f0: 7220 6f66 2073 6974 6573 206f 6e20 7468  r of sites on th
-00013700: 6973 2074 7265 652e 0a20 2020 2020 2020  is tree..       
-00013710: 203a 7274 7970 653a 2069 6e74 0a20 2020   :rtype: int.   
-00013720: 2020 2020 2022 2222 0a20 2020 2020 2020       """.       
-00013730: 2072 6574 7572 6e20 7365 6c66 2e5f 6c6c   return self._ll
-00013740: 5f74 7265 652e 6765 745f 6e75 6d5f 7369  _tree.get_num_si
-00013750: 7465 7328 290a 0a20 2020 2064 6566 2073  tes()..    def s
-00013760: 6974 6573 2873 656c 6629 3a0a 2020 2020  ites(self):.    
-00013770: 2020 2020 2222 220a 2020 2020 2020 2020      """.        
-00013780: 5265 7475 726e 7320 616e 2069 7465 7261  Returns an itera
-00013790: 746f 7220 6f76 6572 2061 6c6c 2074 6865  tor over all the
-000137a0: 203a 7265 663a 6073 6974 6573 203c 7365   :ref:`sites <se
-000137b0: 635f 7369 7465 5f74 6162 6c65 5f64 6566  c_site_table_def
-000137c0: 696e 6974 696f 6e3e 600a 2020 2020 2020  inition>`.      
-000137d0: 2020 696e 2074 6869 7320 7472 6565 2e20    in this tree. 
-000137e0: 5369 7465 7320 6172 6520 7265 7475 726e  Sites are return
-000137f0: 6564 2069 6e20 6f72 6465 7220 6f66 2069  ed in order of i
-00013800: 6e63 7265 6173 696e 6720 4944 0a20 2020  ncreasing ID.   
-00013810: 2020 2020 2028 616e 6420 616c 736f 2070       (and also p
-00013820: 6f73 6974 696f 6e29 2e20 5365 6520 7468  osition). See th
-00013830: 6520 3a63 6c61 7373 3a60 5369 7465 6020  e :class:`Site` 
-00013840: 636c 6173 7320 666f 7220 6465 7461 696c  class for detail
-00013850: 7320 6f6e 0a20 2020 2020 2020 2074 6865  s on.        the
-00013860: 2061 7661 696c 6162 6c65 2066 6965 6c64   available field
-00013870: 7320 666f 7220 6561 6368 2073 6974 652e  s for each site.
-00013880: 0a0a 2020 2020 2020 2020 3a72 6574 7572  ..        :retur
-00013890: 6e3a 2041 6e20 6974 6572 6174 6f72 206f  n: An iterator o
-000138a0: 7665 7220 616c 6c20 7369 7465 7320 696e  ver all sites in
-000138b0: 2074 6869 7320 7472 6565 2e0a 2020 2020   this tree..    
-000138c0: 2020 2020 2222 220a 2020 2020 2020 2020      """.        
-000138d0: 2320 544f 444f 2063 6861 6e67 6520 7468  # TODO change th
-000138e0: 6520 6c6f 772d 6c65 7665 6c20 4150 4920  e low-level API 
-000138f0: 746f 206a 7573 7420 7265 7475 726e 2074  to just return t
-00013900: 6865 2049 4473 206f 6620 7468 6520 7369  he IDs of the si
-00013910: 7465 732e 0a20 2020 2020 2020 2066 6f72  tes..        for
-00013920: 206c 6c5f 7369 7465 2069 6e20 7365 6c66   ll_site in self
-00013930: 2e5f 6c6c 5f74 7265 652e 6765 745f 7369  ._ll_tree.get_si
-00013940: 7465 7328 293a 0a20 2020 2020 2020 2020  tes():.         
-00013950: 2020 205f 2c20 5f2c 205f 2c20 6964 5f2c     _, _, _, id_,
-00013960: 205f 203d 206c 6c5f 7369 7465 0a20 2020   _ = ll_site.   
-00013970: 2020 2020 2020 2020 2079 6965 6c64 2073           yield s
-00013980: 656c 662e 7472 6565 5f73 6571 7565 6e63  elf.tree_sequenc
-00013990: 652e 7369 7465 2869 645f 290a 0a20 2020  e.site(id_)..   
-000139a0: 2064 6566 206d 7574 6174 696f 6e73 2873   def mutations(s
-000139b0: 656c 6629 3a0a 2020 2020 2020 2020 2222  elf):.        ""
-000139c0: 220a 2020 2020 2020 2020 5265 7475 726e  ".        Return
-000139d0: 7320 616e 2069 7465 7261 746f 7220 6f76  s an iterator ov
-000139e0: 6572 2061 6c6c 2074 6865 0a20 2020 2020  er all the.     
-000139f0: 2020 203a 7265 663a 606d 7574 6174 696f     :ref:`mutatio
-00013a00: 6e73 203c 7365 635f 6d75 7461 7469 6f6e  ns <sec_mutation
-00013a10: 5f74 6162 6c65 5f64 6566 696e 6974 696f  _table_definitio
-00013a20: 6e3e 6020 696e 2074 6869 7320 7472 6565  n>` in this tree
-00013a30: 2e0a 2020 2020 2020 2020 4d75 7461 7469  ..        Mutati
-00013a40: 6f6e 7320 6172 6520 7265 7475 726e 6564  ons are returned
-00013a50: 2069 6e20 7468 6569 720a 2020 2020 2020   in their.      
-00013a60: 2020 3a72 6566 3a60 6f72 6465 7220 696e    :ref:`order in
-00013a70: 2074 6865 206d 7574 6174 696f 6e73 2074   the mutations t
-00013a80: 6162 6c65 3c73 6563 5f6d 7574 6174 696f  able<sec_mutatio
-00013a90: 6e5f 7265 7175 6972 656d 656e 7473 3e60  n_requirements>`
-00013aa0: 2c0a 2020 2020 2020 2020 7468 6174 2069  ,.        that i
-00013ab0: 732c 2062 7920 6e6f 6e64 6563 7265 6173  s, by nondecreas
-00013ac0: 696e 6720 7369 7465 2049 442c 2061 6e64  ing site ID, and
-00013ad0: 2077 6974 6869 6e20 6120 7369 7465 2c20   within a site, 
-00013ae0: 6279 2064 6563 7265 6173 696e 670a 2020  by decreasing.  
-00013af0: 2020 2020 2020 6d75 7461 7469 6f6e 2074        mutation t
-00013b00: 696d 6520 7769 7468 2070 6172 656e 7420  ime with parent 
-00013b10: 6d75 7461 7469 6f6e 7320 6265 666f 7265  mutations before
-00013b20: 2074 6865 6972 2063 6869 6c64 7265 6e2e   their children.
-00013b30: 0a20 2020 2020 2020 2053 6565 2074 6865  .        See the
-00013b40: 203a 636c 6173 733a 604d 7574 6174 696f   :class:`Mutatio
-00013b50: 6e60 2063 6c61 7373 2066 6f72 2064 6574  n` class for det
-00013b60: 6169 6c73 206f 6e20 7468 6520 6176 6169  ails on the avai
-00013b70: 6c61 626c 6520 6669 656c 6473 2066 6f72  lable fields for
-00013b80: 0a20 2020 2020 2020 2065 6163 6820 6d75  .        each mu
-00013b90: 7461 7469 6f6e 2e0a 0a20 2020 2020 2020  tation...       
-00013ba0: 2054 6865 2072 6574 7572 6e65 6420 6974   The returned it
-00013bb0: 6572 6174 6f72 2069 7320 6571 7569 7661  erator is equiva
-00013bc0: 6c65 6e74 2074 6f20 6974 6572 6174 696e  lent to iteratin
-00013bd0: 6720 6f76 6572 2061 6c6c 2073 6974 6573  g over all sites
-00013be0: 0a20 2020 2020 2020 2061 6e64 2061 6c6c  .        and all
-00013bf0: 206d 7574 6174 696f 6e73 2069 6e20 6561   mutations in ea
-00013c00: 6368 2073 6974 652c 2069 2e65 2e3a 3a0a  ch site, i.e.::.
-00013c10: 0a20 2020 2020 2020 2020 2020 203e 3e3e  .            >>>
-00013c20: 2066 6f72 2073 6974 6520 696e 2074 7265   for site in tre
-00013c30: 652e 7369 7465 7328 293a 0a20 2020 2020  e.sites():.     
-00013c40: 2020 2020 2020 203e 3e3e 2020 2020 2066         >>>     f
-00013c50: 6f72 206d 7574 6174 696f 6e20 696e 2073  or mutation in s
-00013c60: 6974 652e 6d75 7461 7469 6f6e 733a 0a20  ite.mutations:. 
-00013c70: 2020 2020 2020 2020 2020 203e 3e3e 2020             >>>  
-00013c80: 2020 2020 2020 2079 6965 6c64 206d 7574         yield mut
-00013c90: 6174 696f 6e0a 0a20 2020 2020 2020 203a  ation..        :
-00013ca0: 7265 7475 726e 3a20 416e 2069 7465 7261  return: An itera
-00013cb0: 746f 7220 6f76 6572 2061 6c6c 203a 636c  tor over all :cl
-00013cc0: 6173 733a 604d 7574 6174 696f 6e60 206f  ass:`Mutation` o
-00013cd0: 626a 6563 7473 2069 6e20 7468 6973 2074  bjects in this t
-00013ce0: 7265 652e 0a20 2020 2020 2020 203a 7274  ree..        :rt
-00013cf0: 7970 653a 2069 7465 7228 3a63 6c61 7373  ype: iter(:class
-00013d00: 3a60 4d75 7461 7469 6f6e 6029 0a20 2020  :`Mutation`).   
-00013d10: 2020 2020 2022 2222 0a20 2020 2020 2020       """.       
-00013d20: 2066 6f72 2073 6974 6520 696e 2073 656c   for site in sel
-00013d30: 662e 7369 7465 7328 293a 0a20 2020 2020  f.sites():.     
-00013d40: 2020 2020 2020 2079 6965 6c64 2066 726f         yield fro
-00013d50: 6d20 7369 7465 2e6d 7574 6174 696f 6e73  m site.mutations
-00013d60: 0a0a 2020 2020 6465 6620 6765 745f 6c65  ..    def get_le
-00013d70: 6176 6573 2873 656c 662c 2075 293a 0a20  aves(self, u):. 
-00013d80: 2020 2020 2020 2023 2044 6570 7265 6361         # Depreca
-00013d90: 7465 6420 616c 6961 7320 666f 7220 7361  ted alias for sa
-00013da0: 6d70 6c65 732e 2053 6565 2074 6865 2064  mples. See the d
-00013db0: 6973 6375 7373 696f 6e20 696e 2074 6865  iscussion in the
-00013dc0: 2067 6574 5f6e 756d 5f6c 6561 7665 730a   get_num_leaves.
-00013dd0: 2020 2020 2020 2020 2320 6d65 7468 6f64          # method
-00013de0: 2066 6f72 2077 6879 2074 6869 7320 6d65   for why this me
-00013df0: 7468 6f64 2069 7320 6865 7265 2061 6e64  thod is here and
-00013e00: 2077 6879 2069 7420 6973 2073 656d 616e   why it is seman
-00013e10: 7469 6361 6c6c 7920 696e 636f 7272 6563  tically incorrec
-00013e20: 742e 0a20 2020 2020 2020 2023 2054 6865  t..        # The
-00013e30: 2027 6c65 6176 6573 2720 6974 6572 6174   'leaves' iterat
-00013e40: 6f72 2062 656c 6f77 2063 6f72 7265 6374  or below correct
-00013e50: 6c79 2072 6574 7572 6e73 2074 6865 206c  ly returns the l
-00013e60: 6561 7665 7320 6265 6c6f 7720 6120 6769  eaves below a gi
-00013e70: 7665 6e0a 2020 2020 2020 2020 2320 6e6f  ven.        # no
-00013e80: 6465 2e0a 2020 2020 2020 2020 7265 7475  de..        retu
-00013e90: 726e 2073 656c 662e 7361 6d70 6c65 7328  rn self.samples(
-00013ea0: 7529 0a0a 2020 2020 6465 6620 6c65 6176  u)..    def leav
-00013eb0: 6573 2873 656c 662c 2075 3d4e 6f6e 6529  es(self, u=None)
-00013ec0: 3a0a 2020 2020 2020 2020 2222 220a 2020  :.        """.  
-00013ed0: 2020 2020 2020 5265 7475 726e 7320 616e        Returns an
-00013ee0: 2069 7465 7261 746f 7220 6f76 6572 2061   iterator over a
-00013ef0: 6c6c 2074 6865 206c 6561 7665 7320 696e  ll the leaves in
-00013f00: 2074 6869 7320 7472 6565 2074 6861 7420   this tree that 
-00013f10: 6465 7363 656e 6420 6672 6f6d 0a20 2020  descend from.   
-00013f20: 2020 2020 2074 6865 2073 7065 6369 6669       the specifi
-00013f30: 6564 206e 6f64 652e 2049 6620 3a6d 6174  ed node. If :mat
-00013f40: 683a 6075 6020 2069 7320 6e6f 7420 7370  h:`u`  is not sp
-00013f50: 6563 6966 6965 642c 2072 6574 7572 6e20  ecified, return 
-00013f60: 616c 6c20 6c65 6176 6573 206f 6e0a 2020  all leaves on.  
-00013f70: 2020 2020 2020 7468 6520 7472 6565 2028        the tree (
-00013f80: 692e 652e 2061 6c6c 206c 6561 7665 7320  i.e. all leaves 
-00013f90: 7265 6163 6861 626c 6520 6672 6f6d 2074  reachable from t
-00013fa0: 6865 2074 7265 6520 726f 6f74 2873 292c  he tree root(s),
-00013fb0: 2073 6565 206e 6f74 6520 6265 6c6f 7729   see note below)
-00013fc0: 2e0a 0a20 2020 2020 2020 202e 2e20 6e6f  ...        .. no
-00013fd0: 7465 3a3a 0a20 2020 2020 2020 2020 2020  te::.           
-00013fe0: 203a 6d61 7468 3a60 7560 2063 616e 2062   :math:`u` can b
-00013ff0: 6520 616e 7920 6e6f 6465 2069 6e20 7468  e any node in th
-00014000: 6520 656e 7469 7265 2074 7265 6520 7365  e entire tree se
-00014010: 7175 656e 6365 2c20 696e 636c 7564 696e  quence, includin
-00014020: 6720 6f6e 6573 0a20 2020 2020 2020 2020  g ones.         
-00014030: 2020 2077 6869 6368 2061 7265 206e 6f74     which are not
-00014040: 2063 6f6e 6e65 6374 6564 2076 6961 2062   connected via b
-00014050: 7261 6e63 6865 7320 746f 2061 2072 6f6f  ranches to a roo
-00014060: 7420 6e6f 6465 206f 6620 7468 6520 7472  t node of the tr
-00014070: 6565 2e20 4966 0a20 2020 2020 2020 2020  ee. If.         
-00014080: 2020 2063 616c 6c65 6420 6f6e 2073 7563     called on suc
-00014090: 6820 6120 6e6f 6465 2c20 7468 6520 6974  h a node, the it
-000140a0: 6572 6174 6f72 2077 696c 6c20 7265 7475  erator will retu
-000140b0: 726e 2022 6465 6164 2220 6c65 6176 6573  rn "dead" leaves
-000140c0: 0a20 2020 2020 2020 2020 2020 2028 7365  .            (se
-000140d0: 6520 3a72 6566 3a60 7365 635f 6461 7461  e :ref:`sec_data
-000140e0: 5f6d 6f64 656c 5f74 7265 655f 6465 6164  _model_tree_dead
-000140f0: 5f6c 6561 7665 735f 616e 645f 6272 616e  _leaves_and_bran
-00014100: 6368 6573 6029 2077 6869 6368 2063 616e  ches`) which can
-00014110: 6e6f 740a 2020 2020 2020 2020 2020 2020  not.            
-00014120: 6265 2072 6561 6368 6564 2066 726f 6d20  be reached from 
-00014130: 6120 726f 6f74 206f 6620 7468 6973 2074  a root of this t
-00014140: 7265 652e 2048 6f77 6576 6572 2c20 6465  ree. However, de
-00014150: 6164 206c 6561 7665 7320 7769 6c6c 206e  ad leaves will n
-00014160: 6576 6572 2062 650a 2020 2020 2020 2020  ever be.        
-00014170: 2020 2020 7265 7475 726e 6564 2069 6620      returned if 
-00014180: 3a6d 6174 683a 6075 6020 6973 206c 6566  :math:`u` is lef
-00014190: 7420 756e 7370 6563 6966 6965 642e 0a0a  t unspecified...
-000141a0: 2020 2020 2020 2020 3a70 6172 616d 2069          :param i
-000141b0: 6e74 2075 3a20 5468 6520 6e6f 6465 206f  nt u: The node o
-000141c0: 6620 696e 7465 7265 7374 2e0a 2020 2020  f interest..    
-000141d0: 2020 2020 3a72 6574 7572 6e3a 2041 6e20      :return: An 
-000141e0: 6974 6572 6174 6f72 206f 7665 7220 616c  iterator over al
-000141f0: 6c20 6c65 6176 6573 2069 6e20 7468 6520  l leaves in the 
-00014200: 7375 6274 7265 6520 726f 6f74 6564 2061  subtree rooted a
-00014210: 7420 752e 0a20 2020 2020 2020 203a 7274  t u..        :rt
-00014220: 7970 653a 2063 6f6c 6c65 6374 696f 6e73  ype: collections
-00014230: 2e61 6263 2e49 7465 7261 626c 650a 2020  .abc.Iterable.  
-00014240: 2020 2020 2020 2222 220a 2020 2020 2020        """.      
-00014250: 2020 726f 6f74 7320 3d20 5b75 5d0a 2020    roots = [u].  
-00014260: 2020 2020 2020 6966 2075 2069 7320 4e6f        if u is No
-00014270: 6e65 3a0a 2020 2020 2020 2020 2020 2020  ne:.            
-00014280: 726f 6f74 7320 3d20 7365 6c66 2e72 6f6f  roots = self.roo
-00014290: 7473 0a20 2020 2020 2020 2066 6f72 2072  ts.        for r
-000142a0: 6f6f 7420 696e 2072 6f6f 7473 3a0a 2020  oot in roots:.  
-000142b0: 2020 2020 2020 2020 2020 666f 7220 7620            for v 
-000142c0: 696e 2073 656c 662e 6e6f 6465 7328 726f  in self.nodes(ro
-000142d0: 6f74 293a 0a20 2020 2020 2020 2020 2020  ot):.           
-000142e0: 2020 2020 2069 6620 7365 6c66 2e69 735f       if self.is_
-000142f0: 6c65 6166 2876 293a 0a20 2020 2020 2020  leaf(v):.       
-00014300: 2020 2020 2020 2020 2020 2020 2079 6965               yie
-00014310: 6c64 2076 0a0a 2020 2020 6465 6620 5f73  ld v..    def _s
-00014320: 616d 706c 655f 6765 6e65 7261 746f 7228  ample_generator(
-00014330: 7365 6c66 2c20 7529 3a0a 2020 2020 2020  self, u):.      
-00014340: 2020 6966 2073 656c 662e 5f6c 6c5f 7472    if self._ll_tr
-00014350: 6565 2e67 6574 5f6f 7074 696f 6e73 2829  ee.get_options()
-00014360: 2026 205f 7473 6b69 742e 5341 4d50 4c45   & _tskit.SAMPLE
-00014370: 5f4c 4953 5453 3a0a 2020 2020 2020 2020  _LISTS:.        
-00014380: 2020 2020 7361 6d70 6c65 7320 3d20 7365      samples = se
-00014390: 6c66 2e74 7265 655f 7365 7175 656e 6365  lf.tree_sequence
-000143a0: 2e73 616d 706c 6573 2829 0a20 2020 2020  .samples().     
-000143b0: 2020 2020 2020 2069 6e64 6578 203d 2073         index = s
-000143c0: 656c 662e 6c65 6674 5f73 616d 706c 6528  elf.left_sample(
-000143d0: 7529 0a20 2020 2020 2020 2020 2020 2069  u).            i
-000143e0: 6620 696e 6465 7820 213d 204e 554c 4c3a  f index != NULL:
-000143f0: 0a20 2020 2020 2020 2020 2020 2020 2020  .               
-00014400: 2073 746f 7020 3d20 7365 6c66 2e72 6967   stop = self.rig
-00014410: 6874 5f73 616d 706c 6528 7529 0a20 2020  ht_sample(u).   
-00014420: 2020 2020 2020 2020 2020 2020 2077 6869               whi
-00014430: 6c65 2054 7275 653a 0a20 2020 2020 2020  le True:.       
-00014440: 2020 2020 2020 2020 2020 2020 2079 6965               yie
-00014450: 6c64 2073 616d 706c 6573 5b69 6e64 6578  ld samples[index
-00014460: 5d0a 2020 2020 2020 2020 2020 2020 2020  ].              
-00014470: 2020 2020 2020 6966 2069 6e64 6578 203d        if index =
-00014480: 3d20 7374 6f70 3a0a 2020 2020 2020 2020  = stop:.        
-00014490: 2020 2020 2020 2020 2020 2020 2020 2020                  
-000144a0: 6272 6561 6b0a 2020 2020 2020 2020 2020  break.          
-000144b0: 2020 2020 2020 2020 2020 696e 6465 7820            index 
-000144c0: 3d20 7365 6c66 2e6e 6578 745f 7361 6d70  = self.next_samp
-000144d0: 6c65 2869 6e64 6578 290a 2020 2020 2020  le(index).      
-000144e0: 2020 656c 7365 3a0a 2020 2020 2020 2020    else:.        
-000144f0: 2020 2020 2320 4661 6c6c 2062 6163 6b20      # Fall back 
-00014500: 6f6e 2069 7465 7261 7469 6e67 206f 7665  on iterating ove
-00014510: 7220 616c 6c20 6e6f 6465 7320 696e 2074  r all nodes in t
-00014520: 6865 2074 7265 652c 2079 6965 6c64 696e  he tree, yieldin
-00014530: 670a 2020 2020 2020 2020 2020 2020 2320  g.            # 
-00014540: 7361 6d70 6c65 7320 6173 2077 6520 7365  samples as we se
-00014550: 6520 7468 656d 2e0a 2020 2020 2020 2020  e them..        
-00014560: 2020 2020 666f 7220 7620 696e 2073 656c      for v in sel
-00014570: 662e 6e6f 6465 7328 7529 3a0a 2020 2020  f.nodes(u):.    
-00014580: 2020 2020 2020 2020 2020 2020 6966 2073              if s
-00014590: 656c 662e 6973 5f73 616d 706c 6528 7629  elf.is_sample(v)
-000145a0: 3a0a 2020 2020 2020 2020 2020 2020 2020  :.              
-000145b0: 2020 2020 2020 7969 656c 6420 760a 0a20        yield v.. 
-000145c0: 2020 2064 6566 2073 616d 706c 6573 2873     def samples(s
-000145d0: 656c 662c 2075 3d4e 6f6e 6529 3a0a 2020  elf, u=None):.  
-000145e0: 2020 2020 2020 2222 220a 2020 2020 2020        """.      
-000145f0: 2020 5265 7475 726e 7320 616e 2069 7465    Returns an ite
-00014600: 7261 746f 7220 6f76 6572 2074 6865 206e  rator over the n
-00014610: 756d 6572 6963 616c 2049 4473 206f 6620  umerical IDs of 
-00014620: 616c 6c20 7468 6520 7361 6d70 6c65 206e  all the sample n
-00014630: 6f64 6573 2069 6e0a 2020 2020 2020 2020  odes in.        
-00014640: 7468 6973 2074 7265 6520 7468 6174 2061  this tree that a
-00014650: 7265 2075 6e64 6572 6e65 6174 6820 6e6f  re underneath no
-00014660: 6465 2060 6075 6060 2e20 4966 2060 6075  de ``u``. If ``u
-00014670: 6060 2069 7320 6120 7361 6d70 6c65 2c20  `` is a sample, 
-00014680: 6974 2069 730a 2020 2020 2020 2020 696e  it is.        in
-00014690: 636c 7564 6564 2069 6e20 7468 6520 7265  cluded in the re
-000146a0: 7475 726e 6564 2069 7465 7261 746f 722e  turned iterator.
-000146b0: 2049 6620 7520 6973 206e 6f74 2073 7065   If u is not spe
-000146c0: 6369 6669 6564 2c20 7265 7475 726e 2061  cified, return a
-000146d0: 6c6c 0a20 2020 2020 2020 2073 616d 706c  ll.        sampl
-000146e0: 6520 6e6f 6465 2049 4473 2069 6e20 7468  e node IDs in th
-000146f0: 6520 7472 6565 2e0a 0a20 2020 2020 2020  e tree...       
-00014700: 2049 6620 7468 6520 3a6d 6574 683a 6054   If the :meth:`T
-00014710: 7265 6553 6571 7565 6e63 652e 7472 6565  reeSequence.tree
-00014720: 7360 206d 6574 686f 6420 6973 2063 616c  s` method is cal
-00014730: 6c65 6420 7769 7468 0a20 2020 2020 2020  led with.       
-00014740: 2060 6073 616d 706c 655f 6c69 7374 733d   ``sample_lists=
-00014750: 5472 7565 6060 2c20 7468 6973 206d 6574  True``, this met
-00014760: 686f 6420 7573 6573 2061 6e20 6566 6669  hod uses an effi
-00014770: 6369 656e 7420 616c 676f 7269 7468 6d20  cient algorithm 
-00014780: 746f 2066 696e 640a 2020 2020 2020 2020  to find.        
-00014790: 7468 6520 7361 6d70 6c65 206e 6f64 6573  the sample nodes
-000147a0: 2e20 4966 206e 6f74 2c20 6120 7369 6d70  . If not, a simp
-000147b0: 6c65 2074 7261 7665 7273 616c 2062 6173  le traversal bas
-000147c0: 6564 206d 6574 686f 6420 6973 2075 7365  ed method is use
-000147d0: 642e 0a0a 2020 2020 2020 2020 2e2e 206e  d...        .. n
-000147e0: 6f74 653a 3a0a 0a20 2020 2020 2020 2020  ote::..         
-000147f0: 2020 2054 6865 2069 7465 7261 746f 7220     The iterator 
-00014800: 6973 202a 6e6f 742a 2067 7561 7261 6e74  is *not* guarant
-00014810: 6565 6420 746f 2072 6574 7572 6e20 7468  eed to return th
-00014820: 6520 7361 6d70 6c65 206e 6f64 6520 4944  e sample node ID
-00014830: 7320 696e 0a20 2020 2020 2020 2020 2020  s in.           
-00014840: 206e 756d 6572 6963 616c 206f 7220 616e   numerical or an
-00014850: 7920 6f74 6865 7220 7061 7274 6963 756c  y other particul
-00014860: 6172 206f 7264 6572 2e0a 0a20 2020 2020  ar order...     
-00014870: 2020 203a 7061 7261 6d20 696e 7420 753a     :param int u:
-00014880: 2054 6865 206e 6f64 6520 6f66 2069 6e74   The node of int
-00014890: 6572 6573 742e 0a20 2020 2020 2020 203a  erest..        :
-000148a0: 7265 7475 726e 3a20 416e 2069 7465 7261  return: An itera
-000148b0: 746f 7220 6f76 6572 2061 6c6c 2073 616d  tor over all sam
-000148c0: 706c 6520 6e6f 6465 2049 4473 2069 6e20  ple node IDs in 
-000148d0: 7468 6520 7375 6274 7265 6520 726f 6f74  the subtree root
-000148e0: 6564 2061 7420 752e 0a20 2020 2020 2020  ed at u..       
-000148f0: 203a 7274 7970 653a 2063 6f6c 6c65 6374   :rtype: collect
-00014900: 696f 6e73 2e61 6263 2e49 7465 7261 626c  ions.abc.Iterabl
-00014910: 650a 2020 2020 2020 2020 2222 220a 2020  e.        """.  
-00014920: 2020 2020 2020 726f 6f74 7320 3d20 5b75        roots = [u
-00014930: 5d0a 2020 2020 2020 2020 6966 2075 2069  ].        if u i
-00014940: 7320 4e6f 6e65 3a0a 2020 2020 2020 2020  s None:.        
-00014950: 2020 2020 726f 6f74 7320 3d20 7365 6c66      roots = self
-00014960: 2e72 6f6f 7473 0a20 2020 2020 2020 2066  .roots.        f
-00014970: 6f72 2072 6f6f 7420 696e 2072 6f6f 7473  or root in roots
-00014980: 3a0a 2020 2020 2020 2020 2020 2020 7969  :.            yi
-00014990: 656c 6420 6672 6f6d 2073 656c 662e 5f73  eld from self._s
-000149a0: 616d 706c 655f 6765 6e65 7261 746f 7228  ample_generator(
-000149b0: 726f 6f74 290a 0a20 2020 2064 6566 206e  root)..    def n
-000149c0: 756d 5f63 6869 6c64 7265 6e28 7365 6c66  um_children(self
-000149d0: 2c20 7529 3a0a 2020 2020 2020 2020 2222  , u):.        ""
-000149e0: 220a 2020 2020 2020 2020 5265 7475 726e  ".        Return
-000149f0: 7320 7468 6520 6e75 6d62 6572 206f 6620  s the number of 
-00014a00: 6368 696c 6472 656e 206f 6620 7468 6520  children of the 
-00014a10: 7370 6563 6966 6965 640a 2020 2020 2020  specified.      
-00014a20: 2020 6e6f 6465 2028 692e 652e 2c20 6060    node (i.e., ``
-00014a30: 6c65 6e28 7472 6565 2e63 6869 6c64 7265  len(tree.childre
-00014a40: 6e28 7529 2960 6029 0a0a 2020 2020 2020  n(u))``)..      
-00014a50: 2020 3a70 6172 616d 2069 6e74 2075 3a20    :param int u: 
-00014a60: 5468 6520 6e6f 6465 206f 6620 696e 7465  The node of inte
-00014a70: 7265 7374 2e0a 2020 2020 2020 2020 3a72  rest..        :r
-00014a80: 6574 7572 6e3a 2054 6865 206e 756d 6265  eturn: The numbe
-00014a90: 7220 6f66 2069 6d6d 6564 6961 7465 2063  r of immediate c
-00014aa0: 6869 6c64 7265 6e20 6f66 2074 6865 206e  hildren of the n
-00014ab0: 6f64 6520 7520 696e 2074 6869 7320 7472  ode u in this tr
-00014ac0: 6565 2e0a 2020 2020 2020 2020 3a72 7479  ee..        :rty
-00014ad0: 7065 3a20 696e 740a 2020 2020 2020 2020  pe: int.        
-00014ae0: 2222 220a 2020 2020 2020 2020 7265 7475  """.        retu
-00014af0: 726e 2073 656c 662e 5f6c 6c5f 7472 6565  rn self._ll_tree
-00014b00: 2e67 6574 5f6e 756d 5f63 6869 6c64 7265  .get_num_childre
-00014b10: 6e28 7529 0a0a 2020 2020 6465 6620 6765  n(u)..    def ge
-00014b20: 745f 6e75 6d5f 6c65 6176 6573 2873 656c  t_num_leaves(sel
-00014b30: 662c 2075 293a 0a20 2020 2020 2020 2023  f, u):.        #
-00014b40: 2044 6570 7265 6361 7465 6420 616c 6961   Deprecated alia
-00014b50: 7320 666f 7220 6e75 6d5f 7361 6d70 6c65  s for num_sample
-00014b60: 732e 2054 6865 206d 6574 686f 6420 6e61  s. The method na
-00014b70: 6d65 2069 7320 696e 6163 6375 7261 7465  me is inaccurate
-00014b80: 0a20 2020 2020 2020 2023 2061 7320 7468  .        # as th
-00014b90: 6973 2077 696c 6c20 636f 756e 7420 7468  is will count th
-00014ba0: 6520 6e75 6d62 6572 206f 6620 7472 6163  e number of trac
-00014bb0: 6b65 6420 5f73 616d 706c 6573 5f2e 2054  ked _samples_. T
-00014bc0: 6869 7320 6973 206f 6e6c 7920 7072 6f76  his is only prov
-00014bd0: 6964 6564 2074 6f0a 2020 2020 2020 2020  ided to.        
-00014be0: 2320 6176 6f69 6420 6272 6561 6b69 6e67  # avoid breaking
-00014bf0: 2065 7869 7374 696e 6720 636f 6465 2061   existing code a
-00014c00: 6e64 2073 686f 756c 6420 6e6f 7420 6265  nd should not be
-00014c10: 2075 7365 6420 696e 206e 6577 2063 6f64   used in new cod
-00014c20: 652e 2057 6520 636f 756c 640a 2020 2020  e. We could.    
-00014c30: 2020 2020 2320 6368 616e 6765 2074 6869      # change thi
-00014c40: 7320 6d65 7468 6f64 2074 6f20 6265 2073  s method to be s
-00014c50: 656d 616e 7469 6361 6c6c 7920 636f 7272  emantically corr
-00014c60: 6563 7420 616e 6420 6a75 7374 2063 6f75  ect and just cou
-00014c70: 6e74 2074 6865 0a20 2020 2020 2020 2023  nt the.        #
-00014c80: 206e 756d 6265 7220 6f66 206c 6561 7665   number of leave
-00014c90: 7320 7765 2068 6974 2069 6e20 7468 6520  s we hit in the 
-00014ca0: 6c65 6176 6573 2829 2069 7465 7261 746f  leaves() iterato
-00014cb0: 722e 2048 6f77 6576 6572 2c20 7468 6973  r. However, this
-00014cc0: 2077 6f75 6c64 0a20 2020 2020 2020 2023   would.        #
-00014cd0: 2068 6176 6520 7468 6520 756e 6465 7369   have the undesi
-00014ce0: 7261 626c 6520 6566 6665 6374 206f 6620  rable effect of 
-00014cf0: 6d61 6b69 6e67 2063 6f64 6520 7468 6174  making code that
-00014d00: 2064 6570 656e 6473 206f 6e20 7468 6520   depends on the 
-00014d10: 636f 6e73 7461 6e74 0a20 2020 2020 2020  constant.       
-00014d20: 2023 2074 696d 6520 7065 7266 6f72 6d61   # time performa
-00014d30: 6e63 6520 6f66 2067 6574 5f6e 756d 5f6c  nce of get_num_l
-00014d40: 6561 7665 7320 6d61 6e79 2074 696d 6573  eaves many times
-00014d50: 2073 6c6f 7765 722e 2053 6f2c 2074 6865   slower. So, the
-00014d60: 2062 6573 7420 6f70 7469 6f6e 0a20 2020   best option.   
-00014d70: 2020 2020 2023 2069 7320 746f 206c 6561       # is to lea
-00014d80: 7665 2074 6869 7320 6d65 7468 6f64 2061  ve this method a
-00014d90: 7320 6973 2c20 616e 6420 746f 2073 6c6f  s is, and to slo
-00014da0: 776c 7920 6465 7072 6563 6174 6520 6974  wly deprecate it
-00014db0: 206f 7574 2e20 4f6e 6365 2074 6869 730a   out. Once this.
-00014dc0: 2020 2020 2020 2020 2320 6861 7320 6265          # has be
-00014dd0: 656e 2072 656d 6f76 6564 2c20 7765 206d  en removed, we m
-00014de0: 6967 6874 2061 6464 2069 6e20 6120 6060  ight add in a ``
-00014df0: 6e75 6d5f 6c65 6176 6573 6060 206d 6574  num_leaves`` met
-00014e00: 686f 6420 7468 6174 2072 6574 7572 6e73  hod that returns
-00014e10: 2074 6865 0a20 2020 2020 2020 2023 206c   the.        # l
-00014e20: 656e 6774 6820 6f66 2074 6865 206c 6561  ength of the lea
-00014e30: 7665 7328 2920 6974 6572 6174 6f72 2061  ves() iterator a
-00014e40: 7320 6f6e 6520 776f 756c 6420 6578 7065  s one would expe
-00014e50: 6374 2e0a 2020 2020 2020 2020 7265 7475  ct..        retu
-00014e60: 726e 2073 656c 662e 6e75 6d5f 7361 6d70  rn self.num_samp
-00014e70: 6c65 7328 7529 0a0a 2020 2020 6465 6620  les(u)..    def 
-00014e80: 6765 745f 6e75 6d5f 7361 6d70 6c65 7328  get_num_samples(
-00014e90: 7365 6c66 2c20 753d 4e6f 6e65 293a 0a20  self, u=None):. 
-00014ea0: 2020 2020 2020 2023 2044 6570 7265 6361         # Depreca
-00014eb0: 7465 6420 616c 6961 7320 666f 7220 6e75  ted alias for nu
-00014ec0: 6d5f 7361 6d70 6c65 732e 0a20 2020 2020  m_samples..     
-00014ed0: 2020 2072 6574 7572 6e20 7365 6c66 2e6e     return self.n
-00014ee0: 756d 5f73 616d 706c 6573 2875 290a 0a20  um_samples(u).. 
-00014ef0: 2020 2064 6566 206e 756d 5f73 616d 706c     def num_sampl
-00014f00: 6573 2873 656c 662c 2075 3d4e 6f6e 6529  es(self, u=None)
-00014f10: 3a0a 2020 2020 2020 2020 2222 220a 2020  :.        """.  
-00014f20: 2020 2020 2020 5265 7475 726e 7320 7468        Returns th
-00014f30: 6520 6e75 6d62 6572 206f 6620 7361 6d70  e number of samp
-00014f40: 6c65 206e 6f64 6573 2069 6e20 7468 6973  le nodes in this
-00014f50: 2074 7265 6520 756e 6465 726e 6561 7468   tree underneath
-00014f60: 2074 6865 2073 7065 6369 6669 6564 0a20   the specified. 
-00014f70: 2020 2020 2020 206e 6f64 6520 2869 6e63         node (inc
-00014f80: 6c75 6469 6e67 2074 6865 206e 6f64 6520  luding the node 
-00014f90: 6974 7365 6c66 292e 2049 6620 7520 6973  itself). If u is
-00014fa0: 206e 6f74 2073 7065 6369 6669 6564 2072   not specified r
-00014fb0: 6574 7572 6e0a 2020 2020 2020 2020 7468  eturn.        th
-00014fc0: 6520 746f 7461 6c20 6e75 6d62 6572 206f  e total number o
-00014fd0: 6620 7361 6d70 6c65 7320 696e 2074 6865  f samples in the
-00014fe0: 2074 7265 652e 0a0a 2020 2020 2020 2020   tree...        
-00014ff0: 5468 6973 2069 7320 6120 636f 6e73 7461  This is a consta
-00015000: 6e74 2074 696d 6520 6f70 6572 6174 696f  nt time operatio
-00015010: 6e2e 0a0a 2020 2020 2020 2020 3a70 6172  n...        :par
-00015020: 616d 2069 6e74 2075 3a20 5468 6520 6e6f  am int u: The no
-00015030: 6465 206f 6620 696e 7465 7265 7374 2e0a  de of interest..
-00015040: 2020 2020 2020 2020 3a72 6574 7572 6e3a          :return:
-00015050: 2054 6865 206e 756d 6265 7220 6f66 2073   The number of s
-00015060: 616d 706c 6573 2069 6e20 7468 6520 7375  amples in the su
-00015070: 6274 7265 6520 726f 6f74 6564 2061 7420  btree rooted at 
-00015080: 752e 0a20 2020 2020 2020 203a 7274 7970  u..        :rtyp
-00015090: 653a 2069 6e74 0a20 2020 2020 2020 2022  e: int.        "
-000150a0: 2222 0a20 2020 2020 2020 2075 203d 2073  "".        u = s
-000150b0: 656c 662e 7669 7274 7561 6c5f 726f 6f74  elf.virtual_root
-000150c0: 2069 6620 7520 6973 204e 6f6e 6520 656c   if u is None el
-000150d0: 7365 2075 0a20 2020 2020 2020 2072 6574  se u.        ret
-000150e0: 7572 6e20 7365 6c66 2e5f 6c6c 5f74 7265  urn self._ll_tre
-000150f0: 652e 6765 745f 6e75 6d5f 7361 6d70 6c65  e.get_num_sample
-00015100: 7328 7529 0a0a 2020 2020 6465 6620 6765  s(u)..    def ge
-00015110: 745f 6e75 6d5f 7472 6163 6b65 645f 6c65  t_num_tracked_le
-00015120: 6176 6573 2873 656c 662c 2075 293a 0a20  aves(self, u):. 
-00015130: 2020 2020 2020 2023 2044 6570 7265 6361         # Depreca
-00015140: 7465 6420 616c 6961 7320 666f 7220 6e75  ted alias for nu
-00015150: 6d5f 7472 6163 6b65 645f 7361 6d70 6c65  m_tracked_sample
-00015160: 732e 2054 6865 206d 6574 686f 6420 6e61  s. The method na
-00015170: 6d65 2069 7320 696e 6163 6375 7261 7465  me is inaccurate
-00015180: 0a20 2020 2020 2020 2023 2061 7320 7468  .        # as th
-00015190: 6973 2077 696c 6c20 636f 756e 7420 7468  is will count th
-000151a0: 6520 6e75 6d62 6572 206f 6620 7472 6163  e number of trac
-000151b0: 6b65 6420 5f73 616d 706c 6573 5f2e 2054  ked _samples_. T
-000151c0: 6869 7320 6973 206f 6e6c 7920 7072 6f76  his is only prov
-000151d0: 6964 6564 2074 6f0a 2020 2020 2020 2020  ided to.        
-000151e0: 2320 6176 6f69 6420 6272 6561 6b69 6e67  # avoid breaking
-000151f0: 2065 7869 7374 696e 6720 636f 6465 2061   existing code a
-00015200: 6e64 2073 686f 756c 6420 6e6f 7420 6265  nd should not be
-00015210: 2075 7365 6420 696e 206e 6577 2063 6f64   used in new cod
-00015220: 652e 0a20 2020 2020 2020 2072 6574 7572  e..        retur
-00015230: 6e20 7365 6c66 2e6e 756d 5f74 7261 636b  n self.num_track
-00015240: 6564 5f73 616d 706c 6573 2875 290a 0a20  ed_samples(u).. 
-00015250: 2020 2064 6566 2067 6574 5f6e 756d 5f74     def get_num_t
-00015260: 7261 636b 6564 5f73 616d 706c 6573 2873  racked_samples(s
-00015270: 656c 662c 2075 3d4e 6f6e 6529 3a0a 2020  elf, u=None):.  
-00015280: 2020 2020 2020 2320 4465 7072 6563 6174        # Deprecat
-00015290: 6564 2061 6c69 6173 2066 6f72 206e 756d  ed alias for num
-000152a0: 5f74 7261 636b 6564 5f73 616d 706c 6573  _tracked_samples
-000152b0: 0a20 2020 2020 2020 2072 6574 7572 6e20  .        return 
-000152c0: 7365 6c66 2e6e 756d 5f74 7261 636b 6564  self.num_tracked
-000152d0: 5f73 616d 706c 6573 2875 290a 0a20 2020  _samples(u)..   
-000152e0: 2064 6566 206e 756d 5f74 7261 636b 6564   def num_tracked
-000152f0: 5f73 616d 706c 6573 2873 656c 662c 2075  _samples(self, u
-00015300: 3d4e 6f6e 6529 3a0a 2020 2020 2020 2020  =None):.        
-00015310: 2222 220a 2020 2020 2020 2020 5265 7475  """.        Retu
-00015320: 726e 7320 7468 6520 6e75 6d62 6572 206f  rns the number o
-00015330: 6620 7361 6d70 6c65 7320 696e 2074 6865  f samples in the
-00015340: 2073 6574 2073 7065 6369 6669 6564 2069   set specified i
-00015350: 6e20 7468 650a 2020 2020 2020 2020 6060  n the.        ``
-00015360: 7472 6163 6b65 645f 7361 6d70 6c65 7360  tracked_samples`
-00015370: 6020 7061 7261 6d65 7465 7220 6f66 2074  ` parameter of t
-00015380: 6865 203a 6d65 7468 3a60 5472 6565 5365  he :meth:`TreeSe
-00015390: 7175 656e 6365 2e74 7265 6573 6020 6d65  quence.trees` me
-000153a0: 7468 6f64 0a20 2020 2020 2020 2075 6e64  thod.        und
-000153b0: 6572 6e65 6174 6820 7468 6520 7370 6563  erneath the spec
-000153c0: 6966 6965 6420 6e6f 6465 2e20 4966 2074  ified node. If t
-000153d0: 6865 2069 6e70 7574 206e 6f64 6520 6973  he input node is
-000153e0: 206e 6f74 2073 7065 6369 6669 6564 2c0a   not specified,.
-000153f0: 2020 2020 2020 2020 7265 7475 726e 2074          return t
-00015400: 6865 2074 6f74 616c 206e 756d 6265 7220  he total number 
-00015410: 6f66 2074 7261 636b 6564 2073 616d 706c  of tracked sampl
-00015420: 6573 2069 6e20 7468 6520 7472 6565 2e0a  es in the tree..
-00015430: 0a20 2020 2020 2020 2054 6869 7320 6973  .        This is
-00015440: 2061 2063 6f6e 7374 616e 7420 7469 6d65   a constant time
-00015450: 206f 7065 7261 7469 6f6e 2e0a 0a20 2020   operation...   
-00015460: 2020 2020 203a 7061 7261 6d20 696e 7420       :param int 
-00015470: 753a 2054 6865 206e 6f64 6520 6f66 2069  u: The node of i
-00015480: 6e74 6572 6573 742e 0a20 2020 2020 2020  nterest..       
-00015490: 203a 7265 7475 726e 3a20 5468 6520 6e75   :return: The nu
-000154a0: 6d62 6572 206f 6620 7361 6d70 6c65 7320  mber of samples 
-000154b0: 7769 7468 696e 2074 6865 2073 6574 206f  within the set o
-000154c0: 6620 7472 6163 6b65 6420 7361 6d70 6c65  f tracked sample
-000154d0: 7320 696e 0a20 2020 2020 2020 2020 2020  s in.           
-000154e0: 2074 6865 2073 7562 7472 6565 2072 6f6f   the subtree roo
-000154f0: 7465 6420 6174 2075 2e0a 2020 2020 2020  ted at u..      
-00015500: 2020 3a72 7479 7065 3a20 696e 740a 2020    :rtype: int.  
-00015510: 2020 2020 2020 2222 220a 2020 2020 2020        """.      
-00015520: 2020 7520 3d20 7365 6c66 2e76 6972 7475    u = self.virtu
-00015530: 616c 5f72 6f6f 7420 6966 2075 2069 7320  al_root if u is 
-00015540: 4e6f 6e65 2065 6c73 6520 750a 2020 2020  None else u.    
-00015550: 2020 2020 7265 7475 726e 2073 656c 662e      return self.
-00015560: 5f6c 6c5f 7472 6565 2e67 6574 5f6e 756d  _ll_tree.get_num
-00015570: 5f74 7261 636b 6564 5f73 616d 706c 6573  _tracked_samples
-00015580: 2875 290a 0a20 2020 2064 6566 2070 7265  (u)..    def pre
-00015590: 6f72 6465 7228 7365 6c66 2c20 753d 4e55  order(self, u=NU
-000155a0: 4c4c 293a 0a20 2020 2020 2020 2022 2222  LL):.        """
-000155b0: 0a20 2020 2020 2020 2052 6574 7572 6e73  .        Returns
-000155c0: 2061 206e 756d 7079 2061 7272 6179 206f   a numpy array o
-000155d0: 6620 6e6f 6465 2069 6473 2069 6e20 6070  f node ids in `p
-000155e0: 7265 6f72 6465 720a 2020 2020 2020 2020  reorder.        
-000155f0: 3c68 7474 7073 3a2f 2f65 6e2e 7769 6b69  <https://en.wiki
-00015600: 7065 6469 612e 6f72 672f 7769 6b69 2f54  pedia.org/wiki/T
-00015610: 7265 655f 7472 6176 6572 7361 6c23 5072  ree_traversal#Pr
-00015620: 652d 6f72 6465 725f 284e 4c52 293e 605f  e-order_(NLR)>`_
-00015630: 2e20 4966 2074 6865 206e 6f64 6520 750a  . If the node u.
-00015640: 2020 2020 2020 2020 6973 2073 7065 6369          is speci
-00015650: 6669 6564 2074 6865 2074 7261 7665 7273  fied the travers
-00015660: 616c 2069 7320 726f 6f74 6564 2061 7420  al is rooted at 
-00015670: 7468 6973 206e 6f64 6520 2861 6e64 2069  this node (and i
-00015680: 7420 7769 6c6c 2062 6520 7468 6520 6669  t will be the fi
-00015690: 7273 740a 2020 2020 2020 2020 656c 656d  rst.        elem
-000156a0: 656e 7420 696e 2074 6865 2072 6574 7572  ent in the retur
-000156b0: 6e65 6420 6172 7261 7929 2e20 4f74 6865  ned array). Othe
-000156c0: 7277 6973 652c 2061 6c6c 206e 6f64 6573  rwise, all nodes
-000156d0: 2072 6561 6368 6162 6c65 2066 726f 6d20   reachable from 
-000156e0: 7468 6520 7472 6565 0a20 2020 2020 2020  the tree.       
-000156f0: 2072 6f6f 7473 2077 696c 6c20 6265 2072   roots will be r
-00015700: 6574 7572 6e65 642e 2053 6565 203a 7265  eturned. See :re
-00015710: 663a 6074 7574 6f72 6961 6c73 3a73 6563  f:`tutorials:sec
-00015720: 5f61 6e61 6c79 7369 6e67 5f74 7265 6573  _analysing_trees
-00015730: 5f74 7261 7665 7273 616c 7360 2066 6f72  _traversals` for
-00015740: 0a20 2020 2020 2020 2065 7861 6d70 6c65  .        example
-00015750: 732e 0a0a 2020 2020 2020 2020 3a70 6172  s...        :par
-00015760: 616d 2069 6e74 2075 3a20 4966 2073 7065  am int u: If spe
-00015770: 6369 6669 6564 2c20 7265 7475 726e 2061  cified, return a
-00015780: 6c6c 206e 6f64 6573 2069 6e20 7468 6520  ll nodes in the 
-00015790: 7375 6274 7265 6520 726f 6f74 6564 2061  subtree rooted a
-000157a0: 7420 750a 2020 2020 2020 2020 2020 2020  t u.            
-000157b0: 2869 6e63 6c75 6469 6e67 2075 2920 696e  (including u) in
-000157c0: 2074 7261 7665 7273 616c 206f 7264 6572   traversal order
-000157d0: 2e0a 2020 2020 2020 2020 3a72 6574 7572  ..        :retur
-000157e0: 6e3a 2041 7272 6179 206f 6620 6e6f 6465  n: Array of node
-000157f0: 2069 6473 0a20 2020 2020 2020 203a 7274   ids.        :rt
-00015800: 7970 653a 206e 756d 7079 2e6e 6461 7272  ype: numpy.ndarr
-00015810: 6179 2028 6474 7970 653d 6e70 2e69 6e74  ay (dtype=np.int
-00015820: 3332 290a 2020 2020 2020 2020 2222 220a  32).        """.
-00015830: 2020 2020 2020 2020 7265 7475 726e 2073          return s
-00015840: 656c 662e 5f6c 6c5f 7472 6565 2e67 6574  elf._ll_tree.get
-00015850: 5f70 7265 6f72 6465 7228 7529 0a0a 2020  _preorder(u)..  
-00015860: 2020 6465 6620 706f 7374 6f72 6465 7228    def postorder(
-00015870: 7365 6c66 2c20 753d 4e55 4c4c 293a 0a20  self, u=NULL):. 
-00015880: 2020 2020 2020 2022 2222 0a20 2020 2020         """.     
-00015890: 2020 2052 6574 7572 6e73 2061 206e 756d     Returns a num
-000158a0: 7079 2061 7272 6179 206f 6620 6e6f 6465  py array of node
-000158b0: 2069 6473 2069 6e20 6070 6f73 746f 7264   ids in `postord
-000158c0: 6572 0a20 2020 2020 2020 203c 6874 7470  er.        <http
-000158d0: 733a 2f2f 656e 2e77 696b 6970 6564 6961  s://en.wikipedia
-000158e0: 2e6f 7267 2f77 696b 692f 5472 6565 5f74  .org/wiki/Tree_t
-000158f0: 7261 7665 7273 616c 2323 506f 7374 2d6f  raversal##Post-o
-00015900: 7264 6572 5f28 4c52 4e29 3e60 5f2e 2049  rder_(LRN)>`_. I
-00015910: 6620 7468 6520 6e6f 6465 2075 0a20 2020  f the node u.   
-00015920: 2020 2020 2069 7320 7370 6563 6966 6965       is specifie
-00015930: 6420 7468 6520 7472 6176 6572 7361 6c20  d the traversal 
-00015940: 6973 2072 6f6f 7465 6420 6174 2074 6869  is rooted at thi
-00015950: 7320 6e6f 6465 2028 616e 6420 6974 2077  s node (and it w
-00015960: 696c 6c20 6265 2074 6865 206c 6173 740a  ill be the last.
-00015970: 2020 2020 2020 2020 656c 656d 656e 7420          element 
-00015980: 696e 2074 6865 2072 6574 7572 6e65 6420  in the returned 
-00015990: 6172 7261 7929 2e20 4f74 6865 7277 6973  array). Otherwis
-000159a0: 652c 2061 6c6c 206e 6f64 6573 2072 6561  e, all nodes rea
-000159b0: 6368 6162 6c65 2066 726f 6d20 7468 6520  chable from the 
-000159c0: 7472 6565 0a20 2020 2020 2020 2072 6f6f  tree.        roo
-000159d0: 7473 2077 696c 6c20 6265 2072 6574 7572  ts will be retur
-000159e0: 6e65 642e 2053 6565 203a 7265 663a 6074  ned. See :ref:`t
-000159f0: 7574 6f72 6961 6c73 3a73 6563 5f61 6e61  utorials:sec_ana
-00015a00: 6c79 7369 6e67 5f74 7265 6573 5f74 7261  lysing_trees_tra
-00015a10: 7665 7273 616c 7360 2066 6f72 0a20 2020  versals` for.   
-00015a20: 2020 2020 2065 7861 6d70 6c65 732e 0a0a       examples...
-00015a30: 2020 2020 2020 2020 3a70 6172 616d 2069          :param i
-00015a40: 6e74 2075 3a20 4966 2073 7065 6369 6669  nt u: If specifi
-00015a50: 6564 2c20 7265 7475 726e 2061 6c6c 206e  ed, return all n
-00015a60: 6f64 6573 2069 6e20 7468 6520 7375 6274  odes in the subt
-00015a70: 7265 6520 726f 6f74 6564 2061 7420 750a  ree rooted at u.
-00015a80: 2020 2020 2020 2020 2020 2020 2869 6e63              (inc
-00015a90: 6c75 6469 6e67 2075 2920 696e 2074 7261  luding u) in tra
-00015aa0: 7665 7273 616c 206f 7264 6572 2e0a 2020  versal order..  
-00015ab0: 2020 2020 2020 3a72 6574 7572 6e3a 2041        :return: A
-00015ac0: 7272 6179 206f 6620 6e6f 6465 2069 6473  rray of node ids
-00015ad0: 0a20 2020 2020 2020 203a 7274 7970 653a  .        :rtype:
-00015ae0: 206e 756d 7079 2e6e 6461 7272 6179 2028   numpy.ndarray (
-00015af0: 6474 7970 653d 6e70 2e69 6e74 3332 290a  dtype=np.int32).
-00015b00: 2020 2020 2020 2020 2222 220a 2020 2020          """.    
-00015b10: 2020 2020 7265 7475 726e 2073 656c 662e      return self.
-00015b20: 5f6c 6c5f 7472 6565 2e67 6574 5f70 6f73  _ll_tree.get_pos
-00015b30: 746f 7264 6572 2875 290a 0a20 2020 2064  torder(u)..    d
-00015b40: 6566 2074 696d 6561 7363 2873 656c 662c  ef timeasc(self,
-00015b50: 2075 3d4e 554c 4c29 3a0a 2020 2020 2020   u=NULL):.      
-00015b60: 2020 2222 220a 2020 2020 2020 2020 5265    """.        Re
-00015b70: 7475 726e 7320 6120 6e75 6d70 7920 6172  turns a numpy ar
-00015b80: 7261 7920 6f66 206e 6f64 6520 6964 732e  ray of node ids.
-00015b90: 2053 7461 7274 696e 6720 6174 2060 7560   Starting at `u`
-00015ba0: 2c20 7265 7475 726e 7320 7468 6520 7265  , returns the re
-00015bb0: 6163 6861 626c 650a 2020 2020 2020 2020  achable.        
-00015bc0: 6465 7363 656e 6461 6e74 206e 6f64 6573  descendant nodes
-00015bd0: 2069 6e20 6f72 6465 7220 6f66 2069 6e63   in order of inc
-00015be0: 7265 6173 696e 6720 7469 6d65 2028 6d6f  reasing time (mo
-00015bf0: 7374 2072 6563 656e 7420 6669 7273 7429  st recent first)
-00015c00: 2c20 6661 6c6c 696e 6720 6261 636b 0a20  , falling back. 
-00015c10: 2020 2020 2020 2074 6f20 696e 6372 6561         to increa
-00015c20: 7369 6e67 2049 4420 6966 2074 696d 6573  sing ID if times
-00015c30: 2061 7265 2065 7175 616c 2e20 416c 736f   are equal. Also
-00015c40: 2073 6565 0a20 2020 2020 2020 203a 7265   see.        :re
-00015c50: 663a 6074 7574 6f72 6961 6c73 3a73 6563  f:`tutorials:sec
-00015c60: 5f61 6e61 6c79 7369 6e67 5f74 7265 6573  _analysing_trees
-00015c70: 5f74 7261 7665 7273 616c 7360 2066 6f72  _traversals` for
-00015c80: 2065 7861 6d70 6c65 7320 6f66 2068 6f77   examples of how
-00015c90: 2074 6f20 7573 650a 2020 2020 2020 2020   to use.        
-00015ca0: 7472 6176 6572 7361 6c73 2e0a 0a20 2020  traversals...   
-00015cb0: 2020 2020 203a 7061 7261 6d20 696e 7420       :param int 
-00015cc0: 753a 2049 6620 7370 6563 6966 6965 642c  u: If specified,
-00015cd0: 2072 6574 7572 6e20 616c 6c20 6e6f 6465   return all node
-00015ce0: 7320 696e 2074 6865 2073 7562 7472 6565  s in the subtree
-00015cf0: 2072 6f6f 7465 6420 6174 2075 0a20 2020   rooted at u.   
-00015d00: 2020 2020 2020 2020 2028 696e 636c 7564           (includ
-00015d10: 696e 6720 7529 2069 6e20 7472 6176 6572  ing u) in traver
-00015d20: 7361 6c20 6f72 6465 722e 0a20 2020 2020  sal order..     
-00015d30: 2020 203a 7265 7475 726e 3a20 4172 7261     :return: Arra
-00015d40: 7920 6f66 206e 6f64 6520 6964 730a 2020  y of node ids.  
-00015d50: 2020 2020 2020 3a72 7479 7065 3a20 6e75        :rtype: nu
-00015d60: 6d70 792e 6e64 6172 7261 7920 2864 7479  mpy.ndarray (dty
-00015d70: 7065 3d6e 702e 696e 7433 3229 0a20 2020  pe=np.int32).   
-00015d80: 2020 2020 2022 2222 0a20 2020 2020 2020       """.       
-00015d90: 206e 6f64 6573 203d 2073 656c 662e 7072   nodes = self.pr
-00015da0: 656f 7264 6572 2875 290a 2020 2020 2020  eorder(u).      
-00015db0: 2020 6973 5f76 6972 7475 616c 5f72 6f6f    is_virtual_roo
-00015dc0: 7420 3d20 7520 3d3d 2073 656c 662e 7669  t = u == self.vi
-00015dd0: 7274 7561 6c5f 726f 6f74 0a20 2020 2020  rtual_root.     
-00015de0: 2020 2074 696d 6520 3d20 7365 6c66 2e74     time = self.t
-00015df0: 7265 655f 7365 7175 656e 6365 2e6e 6f64  ree_sequence.nod
-00015e00: 6573 5f74 696d 650a 2020 2020 2020 2020  es_time.        
-00015e10: 6966 2069 735f 7669 7274 7561 6c5f 726f  if is_virtual_ro
-00015e20: 6f74 3a0a 2020 2020 2020 2020 2020 2020  ot:.            
-00015e30: 2320 5765 2063 6f75 6c64 2061 766f 6964  # We could avoid
-00015e40: 2063 7265 6174 696e 6720 7468 6973 2061   creating this a
-00015e50: 7272 6179 2069 6620 7765 2077 616e 7465  rray if we wante
-00015e60: 6420 746f 2c20 6275 740a 2020 2020 2020  d to, but.      
-00015e70: 2020 2020 2020 2320 6974 2773 206e 6f74        # it's not
-00015e80: 2074 6861 7420 6f66 7465 6e20 7065 6f70   that often peop
-00015e90: 6c65 2077 696c 6c20 6265 2075 7369 6e67  le will be using
-00015ea0: 2074 6869 7320 7769 7468 2074 6865 0a20   this with the. 
-00015eb0: 2020 2020 2020 2020 2020 2023 2076 6972             # vir
-00015ec0: 7475 616c 5f72 6f6f 7420 6173 2061 6e20  tual_root as an 
-00015ed0: 6172 6775 6d65 6e74 2c20 736f 2064 6f65  argument, so doe
-00015ee0: 736e 2774 2073 6565 6d20 776f 7274 680a  sn't seem worth.
-00015ef0: 2020 2020 2020 2020 2020 2020 2320 7468              # th
-00015f00: 6520 636f 6d70 6c65 7869 7479 0a20 2020  e complexity.   
-00015f10: 2020 2020 2020 2020 2074 696d 6520 3d20           time = 
-00015f20: 6e70 2e61 7070 656e 6428 7469 6d65 2c20  np.append(time, 
-00015f30: 5b6e 702e 696e 665d 290a 2020 2020 2020  [np.inf]).      
-00015f40: 2020 6f72 6465 7220 3d20 6e70 2e6c 6578    order = np.lex
-00015f50: 736f 7274 285b 6e6f 6465 732c 2074 696d  sort([nodes, tim
-00015f60: 655b 6e6f 6465 735d 5d29 0a20 2020 2020  e[nodes]]).     
-00015f70: 2020 2072 6574 7572 6e20 6e6f 6465 735b     return nodes[
-00015f80: 6f72 6465 725d 0a0a 2020 2020 6465 6620  order]..    def 
-00015f90: 7469 6d65 6465 7363 2873 656c 662c 2075  timedesc(self, u
-00015fa0: 3d4e 554c 4c29 3a0a 2020 2020 2020 2020  =NULL):.        
-00015fb0: 2222 220a 2020 2020 2020 2020 5265 7475  """.        Retu
-00015fc0: 726e 7320 6120 6e75 6d70 7920 6172 7261  rns a numpy arra
-00015fd0: 7920 6f66 206e 6f64 6520 6964 732e 2053  y of node ids. S
-00015fe0: 7461 7274 696e 6720 6174 2060 7560 2c20  tarting at `u`, 
-00015ff0: 7265 7475 726e 7320 7468 6520 7265 6163  returns the reac
-00016000: 6861 626c 650a 2020 2020 2020 2020 6465  hable.        de
-00016010: 7363 656e 6461 6e74 206e 6f64 6573 2069  scendant nodes i
-00016020: 6e20 6f72 6465 7220 6f66 2064 6563 7265  n order of decre
-00016030: 6173 696e 6720 7469 6d65 2028 6c65 6173  asing time (leas
-00016040: 7420 7265 6365 6e74 2066 6972 7374 292c  t recent first),
-00016050: 2066 616c 6c69 6e67 2062 6163 6b0a 2020   falling back.  
-00016060: 2020 2020 2020 746f 2064 6563 7265 6173        to decreas
-00016070: 696e 6720 4944 2069 6620 7469 6d65 7320  ing ID if times 
-00016080: 6172 6520 6571 7561 6c2e 2041 6c73 6f20  are equal. Also 
-00016090: 7365 650a 2020 2020 2020 2020 3a72 6566  see.        :ref
-000160a0: 3a60 7475 746f 7269 616c 733a 7365 635f  :`tutorials:sec_
-000160b0: 616e 616c 7973 696e 675f 7472 6565 735f  analysing_trees_
-000160c0: 7472 6176 6572 7361 6c73 6020 666f 7220  traversals` for 
-000160d0: 6578 616d 706c 6573 206f 6620 686f 7720  examples of how 
-000160e0: 746f 2075 7365 0a20 2020 2020 2020 2074  to use.        t
-000160f0: 7261 7665 7273 616c 732e 0a0a 2020 2020  raversals...    
-00016100: 2020 2020 3a70 6172 616d 2069 6e74 2075      :param int u
-00016110: 3a20 4966 2073 7065 6369 6669 6564 2c20  : If specified, 
-00016120: 7265 7475 726e 2061 6c6c 206e 6f64 6573  return all nodes
-00016130: 2069 6e20 7468 6520 7375 6274 7265 6520   in the subtree 
-00016140: 726f 6f74 6564 2061 7420 750a 2020 2020  rooted at u.    
-00016150: 2020 2020 2020 2020 2869 6e63 6c75 6469          (includi
-00016160: 6e67 2075 2920 696e 2074 7261 7665 7273  ng u) in travers
-00016170: 616c 206f 7264 6572 2e0a 2020 2020 2020  al order..      
-00016180: 2020 3a72 6574 7572 6e3a 2041 7272 6179    :return: Array
-00016190: 206f 6620 6e6f 6465 2069 6473 0a20 2020   of node ids.   
-000161a0: 2020 2020 203a 7274 7970 653a 206e 756d       :rtype: num
-000161b0: 7079 2e6e 6461 7272 6179 2028 6474 7970  py.ndarray (dtyp
-000161c0: 653d 6e70 2e69 6e74 3332 290a 2020 2020  e=np.int32).    
-000161d0: 2020 2020 2222 220a 2020 2020 2020 2020      """.        
-000161e0: 7265 7475 726e 2073 656c 662e 7469 6d65  return self.time
-000161f0: 6173 6328 7529 5b3a 3a2d 315d 0a0a 2020  asc(u)[::-1]..  
-00016200: 2020 6465 6620 5f70 7265 6f72 6465 725f    def _preorder_
-00016210: 7472 6176 6572 7361 6c28 7365 6c66 2c20  traversal(self, 
-00016220: 726f 6f74 293a 0a20 2020 2020 2020 2023  root):.        #
-00016230: 2052 6574 7572 6e20 5079 7468 6f6e 2069   Return Python i
-00016240: 6e74 6567 6572 7320 666f 7220 636f 6d70  ntegers for comp
-00016250: 6174 6962 696c 6974 790a 2020 2020 2020  atibility.      
-00016260: 2020 7265 7475 726e 206d 6170 2869 6e74    return map(int
-00016270: 2c20 7365 6c66 2e70 7265 6f72 6465 7228  , self.preorder(
-00016280: 726f 6f74 2929 0a0a 2020 2020 6465 6620  root))..    def 
-00016290: 5f70 6f73 746f 7264 6572 5f74 7261 7665  _postorder_trave
-000162a0: 7273 616c 2873 656c 662c 2072 6f6f 7429  rsal(self, root)
-000162b0: 3a0a 2020 2020 2020 2020 2320 5265 7475  :.        # Retu
-000162c0: 726e 2050 7974 686f 6e20 696e 7465 6765  rn Python intege
-000162d0: 7273 2066 6f72 2063 6f6d 7061 7469 6269  rs for compatibi
-000162e0: 6c69 7479 0a20 2020 2020 2020 2072 6574  lity.        ret
-000162f0: 7572 6e20 6d61 7028 696e 742c 2073 656c  urn map(int, sel
-00016300: 662e 706f 7374 6f72 6465 7228 726f 6f74  f.postorder(root
-00016310: 2929 0a0a 2020 2020 6465 6620 5f69 6e6f  ))..    def _ino
-00016320: 7264 6572 5f74 7261 7665 7273 616c 2873  rder_traversal(s
-00016330: 656c 662c 2072 6f6f 7429 3a0a 2020 2020  elf, root):.    
-00016340: 2020 2020 2320 544f 444f 2061 6464 2061      # TODO add a
-00016350: 206e 6f6e 7265 6375 7273 6976 6520 7665   nonrecursive ve
-00016360: 7273 696f 6e20 6f66 2074 6865 2069 6e6f  rsion of the ino
-00016370: 7264 6572 2074 7261 7665 7273 616c 2e0a  rder traversal..
-00016380: 0a20 2020 2020 2020 2064 6566 2074 7261  .        def tra
-00016390: 7665 7273 6528 7529 3a0a 2020 2020 2020  verse(u):.      
-000163a0: 2020 2020 2020 6368 696c 6472 656e 203d        children =
-000163b0: 2073 656c 662e 6765 745f 6368 696c 6472   self.get_childr
-000163c0: 656e 2875 290a 2020 2020 2020 2020 2020  en(u).          
-000163d0: 2020 6d69 6420 3d20 6c65 6e28 6368 696c    mid = len(chil
-000163e0: 6472 656e 2920 2f2f 2032 0a20 2020 2020  dren) // 2.     
-000163f0: 2020 2020 2020 2066 6f72 2063 2069 6e20         for c in 
-00016400: 6368 696c 6472 656e 5b3a 6d69 645d 3a0a  children[:mid]:.
-00016410: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00016420: 7969 656c 6420 6672 6f6d 2074 7261 7665  yield from trave
-00016430: 7273 6528 6329 0a20 2020 2020 2020 2020  rse(c).         
-00016440: 2020 2079 6965 6c64 2075 0a20 2020 2020     yield u.     
-00016450: 2020 2020 2020 2066 6f72 2063 2069 6e20         for c in 
-00016460: 6368 696c 6472 656e 5b6d 6964 3a5d 3a0a  children[mid:]:.
-00016470: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00016480: 7969 656c 6420 6672 6f6d 2074 7261 7665  yield from trave
-00016490: 7273 6528 6329 0a0a 2020 2020 2020 2020  rse(c)..        
-000164a0: 726f 6f74 7320 3d20 7365 6c66 2e72 6f6f  roots = self.roo
-000164b0: 7473 2069 6620 726f 6f74 203d 3d20 4e55  ts if root == NU
-000164c0: 4c4c 2065 6c73 6520 5b72 6f6f 745d 0a20  LL else [root]. 
-000164d0: 2020 2020 2020 2066 6f72 2072 6f6f 7420         for root 
-000164e0: 696e 2072 6f6f 7473 3a0a 2020 2020 2020  in roots:.      
-000164f0: 2020 2020 2020 7969 656c 6420 6672 6f6d        yield from
-00016500: 2074 7261 7665 7273 6528 726f 6f74 290a   traverse(root).
-00016510: 0a20 2020 2064 6566 205f 6c65 7665 6c6f  .    def _levelo
-00016520: 7264 6572 5f74 7261 7665 7273 616c 2873  rder_traversal(s
-00016530: 656c 662c 2072 6f6f 7429 3a0a 2020 2020  elf, root):.    
-00016540: 2020 2020 726f 6f74 7320 3d20 7365 6c66      roots = self
-00016550: 2e72 6f6f 7473 2069 6620 726f 6f74 203d  .roots if root =
-00016560: 3d20 4e55 4c4c 2065 6c73 6520 5b72 6f6f  = NULL else [roo
-00016570: 745d 0a20 2020 2020 2020 2071 7565 7565  t].        queue
-00016580: 203d 2063 6f6c 6c65 6374 696f 6e73 2e64   = collections.d
-00016590: 6571 7565 2872 6f6f 7473 290a 2020 2020  eque(roots).    
-000165a0: 2020 2020 2320 466f 7220 7065 7266 2077      # For perf w
-000165b0: 6520 7374 6f72 6520 7468 6573 6520 746f  e store these to
-000165c0: 2061 766f 6964 206c 6f6f 6b75 7073 2069   avoid lookups i
-000165d0: 6e20 7468 6520 7469 6768 7420 6c6f 6f70  n the tight loop
-000165e0: 0a20 2020 2020 2020 2070 6f70 203d 2071  .        pop = q
-000165f0: 7565 7565 2e70 6f70 6c65 6674 0a20 2020  ueue.popleft.   
-00016600: 2020 2020 2065 7874 656e 6420 3d20 7175       extend = qu
-00016610: 6575 652e 6578 7465 6e64 0a20 2020 2020  eue.extend.     
-00016620: 2020 2063 6869 6c64 7265 6e20 3d20 7365     children = se
-00016630: 6c66 2e63 6869 6c64 7265 6e0a 2020 2020  lf.children.    
-00016640: 2020 2020 2320 4e6f 7465 3a20 7468 6520      # Note: the 
-00016650: 7573 7561 6c20 7374 796c 6520 6973 2074  usual style is t
-00016660: 6f20 6265 2065 7870 6c69 6369 7420 6162  o be explicit ab
-00016670: 6f75 7420 7768 6174 2077 6527 7265 2074  out what we're t
-00016680: 6573 7469 6e67 0a20 2020 2020 2020 2023  esting.        #
-00016690: 2061 6e64 2075 7365 2077 6869 6c65 206c   and use while l
-000166a0: 656e 2871 7565 7565 2920 3e20 302c 2062  en(queue) > 0, b
-000166b0: 7574 2074 6869 7320 666f 726d 2069 7320  ut this form is 
-000166c0: 736c 6967 6874 6c79 2066 6173 7465 722e  slightly faster.
-000166d0: 0a20 2020 2020 2020 2077 6869 6c65 2071  .        while q
-000166e0: 7565 7565 3a0a 2020 2020 2020 2020 2020  ueue:.          
-000166f0: 2020 7620 3d20 706f 7028 290a 2020 2020    v = pop().    
-00016700: 2020 2020 2020 2020 6578 7465 6e64 2863          extend(c
-00016710: 6869 6c64 7265 6e28 7629 290a 2020 2020  hildren(v)).    
-00016720: 2020 2020 2020 2020 7969 656c 6420 760a          yield v.
-00016730: 0a20 2020 2064 6566 205f 7469 6d65 6173  .    def _timeas
-00016740: 635f 7472 6176 6572 7361 6c28 7365 6c66  c_traversal(self
-00016750: 2c20 726f 6f74 293a 0a20 2020 2020 2020  , root):.       
-00016760: 2022 2222 0a20 2020 2020 2020 2053 6f72   """.        Sor
-00016770: 7473 2062 7920 696e 6372 6561 7369 6e67  ts by increasing
-00016780: 2074 696d 6520 6275 7420 6661 6c6c 7320   time but falls 
-00016790: 6261 636b 2074 6f20 696e 6372 6561 7369  back to increasi
-000167a0: 6e67 2049 4420 666f 7220 6571 7561 6c20  ng ID for equal 
-000167b0: 7469 6d65 732e 0a20 2020 2020 2020 2022  times..        "
-000167c0: 2222 0a20 2020 2020 2020 2072 6574 7572  "".        retur
-000167d0: 6e20 6d61 7028 696e 742c 2073 656c 662e  n map(int, self.
-000167e0: 7469 6d65 6173 6328 726f 6f74 2929 0a0a  timeasc(root))..
-000167f0: 2020 2020 6465 6620 5f74 696d 6564 6573      def _timedes
-00016800: 635f 7472 6176 6572 7361 6c28 7365 6c66  c_traversal(self
-00016810: 2c20 726f 6f74 293a 0a20 2020 2020 2020  , root):.       
-00016820: 2022 2222 0a20 2020 2020 2020 2054 6865   """.        The
-00016830: 2072 6576 6572 7365 206f 6620 7469 6d65   reverse of time
-00016840: 6173 632e 0a20 2020 2020 2020 2022 2222  asc..        """
-00016850: 0a20 2020 2020 2020 2072 6574 7572 6e20  .        return 
-00016860: 6d61 7028 696e 742c 2073 656c 662e 7469  map(int, self.ti
-00016870: 6d65 6465 7363 2872 6f6f 7429 290a 0a20  medesc(root)).. 
-00016880: 2020 2064 6566 205f 6d69 6e6c 6578 5f70     def _minlex_p
-00016890: 6f73 746f 7264 6572 5f74 7261 7665 7273  ostorder_travers
-000168a0: 616c 2873 656c 662c 2072 6f6f 7429 3a0a  al(self, root):.
-000168b0: 2020 2020 2020 2020 2222 220a 2020 2020          """.    
-000168c0: 2020 2020 506f 7374 6f72 6465 7220 7472      Postorder tr
-000168d0: 6176 6572 7361 6c20 7468 6174 2076 6973  aversal that vis
-000168e0: 6974 7320 6c65 6176 6573 2069 6e20 6d69  its leaves in mi
-000168f0: 6e69 6d75 6d20 6c65 7869 636f 6772 6170  nimum lexicograp
-00016900: 6869 6320 6f72 6465 722e 0a0a 2020 2020  hic order...    
-00016910: 2020 2020 4d69 6e6c 6578 2073 7461 6e64      Minlex stand
-00016920: 7320 666f 7220 6d69 6e69 6d75 6d20 6c65  s for minimum le
-00016930: 7869 636f 6772 6170 6869 632e 2057 6520  xicographic. We 
-00016940: 7769 7368 2074 6f20 7669 7369 7420 6120  wish to visit a 
-00016950: 7472 6565 2069 6e20 7375 6368 0a20 2020  tree in such.   
-00016960: 2020 2020 2061 2077 6179 2074 6861 7420       a way that 
-00016970: 7468 6520 6c65 6176 6573 2076 6973 6974  the leaves visit
-00016980: 6564 2c20 7768 656e 2074 6865 6972 2049  ed, when their I
-00016990: 4473 2061 7265 206c 6973 7465 6420 6f75  Ds are listed ou
-000169a0: 742c 2068 6176 650a 2020 2020 2020 2020  t, have.        
-000169b0: 6d69 6e69 6d75 6d20 6c65 7869 636f 6772  minimum lexicogr
-000169c0: 6170 6869 6320 6f72 6465 722e 2054 6869  aphic order. Thi
-000169d0: 7320 6973 2061 2075 7365 6675 6c20 6f72  s is a useful or
-000169e0: 6465 7269 6e67 2066 6f72 2064 7261 7769  dering for drawi
-000169f0: 6e67 0a20 2020 2020 2020 206d 756c 7469  ng.        multi
-00016a00: 706c 6520 5472 6565 7320 6f66 2061 2054  ple Trees of a T
-00016a10: 7265 6553 6571 7565 6e63 652c 2061 7320  reeSequence, as 
-00016a20: 6974 206c 6561 6473 2074 6f20 6d6f 7265  it leads to more
-00016a30: 2063 6f6e 7369 7374 656e 6379 0a20 2020   consistency.   
-00016a40: 2020 2020 2062 6574 7765 656e 2061 646a       between adj
-00016a50: 6163 656e 7420 5472 6565 732e 0a20 2020  acent Trees..   
-00016a60: 2020 2020 2022 2222 0a0a 2020 2020 2020       """..      
-00016a70: 2020 2320 5765 2063 6f6d 7075 7465 2061    # We compute a
-00016a80: 2064 6963 7469 6f6e 6172 7920 6d61 7070   dictionary mapp
-00016a90: 696e 6720 6672 6f6d 2069 6e74 6572 6e61  ing from interna
-00016aa0: 6c20 6e6f 6465 2049 4420 746f 206d 696e  l node ID to min
-00016ab0: 206c 6561 6620 4944 0a20 2020 2020 2020   leaf ID.       
-00016ac0: 2023 2075 6e64 6572 2074 6865 206e 6f64   # under the nod
-00016ad0: 652c 2075 7369 6e67 2061 2066 6972 7374  e, using a first
-00016ae0: 2070 6f73 746f 7264 6572 2074 7261 7665   postorder trave
-00016af0: 7273 616c 0a20 2020 2020 2020 206d 696e  rsal.        min
-00016b00: 5f6c 6561 6620 3d20 7b7d 0a20 2020 2020  _leaf = {}.     
-00016b10: 2020 2066 6f72 2075 2069 6e20 7365 6c66     for u in self
-00016b20: 2e6e 6f64 6573 2872 6f6f 742c 206f 7264  .nodes(root, ord
-00016b30: 6572 3d22 706f 7374 6f72 6465 7222 293a  er="postorder"):
-00016b40: 0a20 2020 2020 2020 2020 2020 2069 6620  .            if 
-00016b50: 7365 6c66 2e69 735f 6c65 6166 2875 293a  self.is_leaf(u):
-00016b60: 0a20 2020 2020 2020 2020 2020 2020 2020  .               
-00016b70: 206d 696e 5f6c 6561 665b 755d 203d 2075   min_leaf[u] = u
-00016b80: 0a20 2020 2020 2020 2020 2020 2065 6c73  .            els
-00016b90: 653a 0a20 2020 2020 2020 2020 2020 2020  e:.             
-00016ba0: 2020 206d 696e 5f6c 6561 665b 755d 203d     min_leaf[u] =
-00016bb0: 206d 696e 286d 696e 5f6c 6561 665b 765d   min(min_leaf[v]
-00016bc0: 2066 6f72 2076 2069 6e20 7365 6c66 2e63   for v in self.c
-00016bd0: 6869 6c64 7265 6e28 7529 290a 0a20 2020  hildren(u))..   
-00016be0: 2020 2020 2073 7461 636b 203d 205b 5d0a       stack = [].
-00016bf0: 0a20 2020 2020 2020 2064 6566 2070 7573  .        def pus
-00016c00: 6828 6e6f 6465 7329 3a0a 2020 2020 2020  h(nodes):.      
-00016c10: 2020 2020 2020 7374 6163 6b2e 6578 7465        stack.exte
-00016c20: 6e64 2873 6f72 7465 6428 6e6f 6465 732c  nd(sorted(nodes,
-00016c30: 206b 6579 3d6c 616d 6264 6120 753a 206d   key=lambda u: m
-00016c40: 696e 5f6c 6561 665b 755d 2c20 7265 7665  in_leaf[u], reve
-00016c50: 7273 653d 5472 7565 2929 0a0a 2020 2020  rse=True))..    
-00016c60: 2020 2020 2320 5468 6520 706f 7374 6f72      # The postor
-00016c70: 6465 7220 7472 6176 6572 7361 6c20 6973  der traversal is
-00016c80: 6e27 7420 726f 6275 7374 2074 6f20 7573  n't robust to us
-00016c90: 696e 6720 7669 7274 7561 6c5f 726f 6f74  ing virtual_root
-00016ca0: 2064 6972 6563 746c 790a 2020 2020 2020   directly.      
-00016cb0: 2020 2320 6173 2061 206e 6f64 6520 6265    # as a node be
-00016cc0: 6361 7573 6520 7765 2064 6570 656e 6420  cause we depend 
-00016cd0: 6f6e 2074 7265 652e 7061 7265 6e74 2829  on tree.parent()
-00016ce0: 2072 6574 7572 6e69 6e67 2074 6865 206c   returning the l
-00016cf0: 6173 740a 2020 2020 2020 2020 2320 6e6f  ast.        # no
-00016d00: 6465 2077 6520 7669 7369 7469 6e67 206f  de we visiting o
-00016d10: 6e20 7468 6520 7061 7468 2066 726f 6d20  n the path from 
-00016d20: 2272 6f6f 7422 2e20 536f 2c20 7765 2074  "root". So, we t
-00016d30: 7265 6174 2074 6869 7320 6173 2061 0a20  reat this as a. 
-00016d40: 2020 2020 2020 2023 2073 7065 6369 616c         # special
-00016d50: 2063 6173 652e 0a20 2020 2020 2020 2069   case..        i
-00016d60: 735f 7669 7274 7561 6c5f 726f 6f74 203d  s_virtual_root =
-00016d70: 2072 6f6f 7420 3d3d 2073 656c 662e 7669   root == self.vi
-00016d80: 7274 7561 6c5f 726f 6f74 0a20 2020 2020  rtual_root.     
-00016d90: 2020 2072 6f6f 7473 203d 2073 656c 662e     roots = self.
-00016da0: 726f 6f74 7320 6966 2072 6f6f 7420 3d3d  roots if root ==
-00016db0: 202d 3120 6f72 2069 735f 7669 7274 7561   -1 or is_virtua
-00016dc0: 6c5f 726f 6f74 2065 6c73 6520 5b72 6f6f  l_root else [roo
-00016dd0: 745d 0a0a 2020 2020 2020 2020 7075 7368  t]..        push
-00016de0: 2872 6f6f 7473 290a 2020 2020 2020 2020  (roots).        
-00016df0: 7061 7265 6e74 203d 204e 554c 4c0a 2020  parent = NULL.  
-00016e00: 2020 2020 2020 7768 696c 6520 6c65 6e28        while len(
-00016e10: 7374 6163 6b29 203e 2030 3a0a 2020 2020  stack) > 0:.    
-00016e20: 2020 2020 2020 2020 7620 3d20 7374 6163          v = stac
-00016e30: 6b5b 2d31 5d0a 2020 2020 2020 2020 2020  k[-1].          
-00016e40: 2020 6368 696c 6472 656e 203d 205b 5d20    children = [] 
-00016e50: 6966 2076 203d 3d20 7061 7265 6e74 2065  if v == parent e
-00016e60: 6c73 6520 7365 6c66 2e63 6869 6c64 7265  lse self.childre
-00016e70: 6e28 7629 0a20 2020 2020 2020 2020 2020  n(v).           
-00016e80: 2069 6620 6c65 6e28 6368 696c 6472 656e   if len(children
-00016e90: 2920 3e20 303a 0a20 2020 2020 2020 2020  ) > 0:.         
-00016ea0: 2020 2020 2020 2023 2054 6865 2066 6972         # The fir
-00016eb0: 7374 2074 696d 6520 7669 7369 7469 6e67  st time visiting
-00016ec0: 2061 206e 6f64 652c 2077 6520 7075 7368   a node, we push
-00016ed0: 206f 6e74 6f20 7468 6520 7374 6163 6b20   onto the stack 
-00016ee0: 6974 7320 6368 696c 6472 656e 0a20 2020  its children.   
-00016ef0: 2020 2020 2020 2020 2020 2020 2023 2069               # i
-00016f00: 6e20 6f72 6465 7220 6f66 2072 6576 6572  n order of rever
-00016f10: 7365 206d 696e 206c 6561 6620 4944 2075  se min leaf ID u
-00016f20: 6e64 6572 2065 6163 6820 6368 696c 642e  nder each child.
-00016f30: 2054 6869 7320 6775 6172 616e 7465 6573   This guarantees
-00016f40: 0a20 2020 2020 2020 2020 2020 2020 2020  .               
-00016f50: 2023 2074 6861 7420 7468 6520 6561 726c   # that the earl
-00016f60: 6965 7220 6368 696c 6472 656e 2076 6973  ier children vis
-00016f70: 6974 6564 2068 6176 6520 736d 616c 6c65  ited have smalle
-00016f80: 7220 6d69 6e20 6c65 6166 2049 442c 0a20  r min leaf ID,. 
-00016f90: 2020 2020 2020 2020 2020 2020 2020 2023                 #
-00016fa0: 2077 6869 6368 2069 7320 6571 7569 7661   which is equiva
-00016fb0: 6c65 6e74 2074 6f20 7468 6520 6d69 6e6c  lent to the minl
-00016fc0: 6578 2063 6f6e 6469 7469 6f6e 2e0a 2020  ex condition..  
-00016fd0: 2020 2020 2020 2020 2020 2020 2020 7075                pu
-00016fe0: 7368 2863 6869 6c64 7265 6e29 0a20 2020  sh(children).   
-00016ff0: 2020 2020 2020 2020 2065 6c73 653a 0a20           else:. 
-00017000: 2020 2020 2020 2020 2020 2020 2020 2023                 #
-00017010: 2054 6865 2073 6563 6f6e 6420 7469 6d65   The second time
-00017020: 2076 6973 6974 696e 6720 6120 6e6f 6465   visiting a node
-00017030: 2c20 7765 2070 6f70 2061 6e64 2079 6965  , we pop and yie
-00017040: 6c64 2069 742c 2061 6e64 0a20 2020 2020  ld it, and.     
-00017050: 2020 2020 2020 2020 2020 2023 2077 6520             # we 
-00017060: 7570 6461 7465 2074 6865 2070 6172 656e  update the paren
-00017070: 7420 7661 7269 6162 6c65 0a20 2020 2020  t variable.     
-00017080: 2020 2020 2020 2020 2020 2070 6172 656e             paren
-00017090: 7420 3d20 7365 6c66 2e67 6574 5f70 6172  t = self.get_par
-000170a0: 656e 7428 7629 0a20 2020 2020 2020 2020  ent(v).         
-000170b0: 2020 2020 2020 2079 6965 6c64 2073 7461         yield sta
-000170c0: 636b 2e70 6f70 2829 0a20 2020 2020 2020  ck.pop().       
-000170d0: 2069 6620 6973 5f76 6972 7475 616c 5f72   if is_virtual_r
-000170e0: 6f6f 743a 0a20 2020 2020 2020 2020 2020  oot:.           
-000170f0: 2079 6965 6c64 2073 656c 662e 7669 7274   yield self.virt
-00017100: 7561 6c5f 726f 6f74 0a0a 2020 2020 6465  ual_root..    de
-00017110: 6620 6e6f 6465 7328 7365 6c66 2c20 726f  f nodes(self, ro
-00017120: 6f74 3d4e 6f6e 652c 206f 7264 6572 3d22  ot=None, order="
-00017130: 7072 656f 7264 6572 2229 3a0a 2020 2020  preorder"):.    
-00017140: 2020 2020 2222 220a 2020 2020 2020 2020      """.        
-00017150: 5265 7475 726e 7320 616e 2069 7465 7261  Returns an itera
-00017160: 746f 7220 6f76 6572 2074 6865 206e 6f64  tor over the nod
-00017170: 6520 4944 7320 7265 6163 6861 626c 6520  e IDs reachable 
-00017180: 6672 6f6d 2074 6865 2073 7065 6369 6669  from the specifi
-00017190: 6564 206e 6f64 6520 696e 2074 6869 730a  ed node in this.
-000171a0: 2020 2020 2020 2020 7472 6565 2069 6e20          tree in 
-000171b0: 7468 6520 7370 6563 6966 6965 6420 7472  the specified tr
-000171c0: 6176 6572 7361 6c20 6f72 6465 722e 0a0a  aversal order...
-000171d0: 2020 2020 2020 2020 2e2e 206e 6f74 653a          .. note:
-000171e0: 3a0a 2020 2020 2020 2020 2020 2020 556e  :.            Un
-000171f0: 6c69 6b65 2074 6865 203a 6d65 7468 3a60  like the :meth:`
-00017200: 5472 6565 5365 7175 656e 6365 2e6e 6f64  TreeSequence.nod
-00017210: 6573 6020 6d65 7468 6f64 2c20 7468 6973  es` method, this
-00017220: 2069 7465 7261 746f 7220 7072 6f64 7563   iterator produc
-00017230: 6573 0a20 2020 2020 2020 2020 2020 2069  es.            i
-00017240: 6e74 6567 6572 206e 6f64 6520 4944 732c  nteger node IDs,
-00017250: 206e 6f74 203a 636c 6173 733a 604e 6f64   not :class:`Nod
-00017260: 6560 206f 626a 6563 7473 2e0a 0a20 2020  e` objects...   
-00017270: 2020 2020 2049 6620 7468 6520 6060 726f       If the ``ro
-00017280: 6f74 6060 2070 6172 616d 6574 6572 2069  ot`` parameter i
-00017290: 7320 6e6f 7420 7072 6f76 6964 6564 206f  s not provided o
-000172a0: 7220 6060 4e6f 6e65 6060 2c20 6974 6572  r ``None``, iter
-000172b0: 6174 6520 6f76 6572 2061 6c6c 0a20 2020  ate over all.   
-000172c0: 2020 2020 206e 6f64 6573 2072 6561 6368       nodes reach
-000172d0: 6162 6c65 2066 726f 6d20 7468 6520 726f  able from the ro
-000172e0: 6f74 7320 2873 6565 203a 6174 7472 3a60  ots (see :attr:`
-000172f0: 5472 6565 2e72 6f6f 7473 6020 666f 7220  Tree.roots` for 
-00017300: 6465 7461 696c 730a 2020 2020 2020 2020  details.        
-00017310: 6f6e 2077 6869 6368 206e 6f64 6573 2061  on which nodes a
-00017320: 7265 2063 6f6e 7369 6465 7265 6420 726f  re considered ro
-00017330: 6f74 7329 2e20 4966 2074 6865 2060 6072  ots). If the ``r
-00017340: 6f6f 7460 6020 7061 7261 6d65 7465 720a  oot`` parameter.
-00017350: 2020 2020 2020 2020 6973 2070 726f 7669          is provi
-00017360: 6465 642c 206f 6e6c 7920 7468 6520 6e6f  ded, only the no
-00017370: 6465 7320 696e 2074 6865 2073 7562 7472  des in the subtr
-00017380: 6565 2072 6f6f 7465 6420 6174 2074 6869  ee rooted at thi
-00017390: 7320 6e6f 6465 0a20 2020 2020 2020 2028  s node.        (
-000173a0: 696e 636c 7564 696e 6720 7468 6520 7370  including the sp
-000173b0: 6563 6966 6965 6420 6e6f 6465 2920 7769  ecified node) wi
-000173c0: 6c6c 2062 6520 6974 6572 6174 6564 206f  ll be iterated o
-000173d0: 7665 722e 2049 6620 7468 650a 2020 2020  ver. If the.    
-000173e0: 2020 2020 3a61 7474 723a 602e 7669 7274      :attr:`.virt
-000173f0: 7561 6c5f 726f 6f74 6020 6973 2073 7065  ual_root` is spe
-00017400: 6369 6669 6564 2061 7320 7468 6520 7472  cified as the tr
-00017410: 6176 6572 7361 6c20 726f 6f74 2c20 6974  aversal root, it
-00017420: 2077 696c 6c0a 2020 2020 2020 2020 6265   will.        be
-00017430: 2069 6e63 6c75 6465 6420 696e 2074 6865   included in the
-00017440: 2074 7261 7665 7273 6564 206e 6f64 6573   traversed nodes
-00017450: 2069 6e20 7468 6520 6170 7072 6f70 7269   in the appropri
-00017460: 6174 6520 706f 7369 7469 6f6e 0a20 2020  ate position.   
-00017470: 2020 2020 2066 6f72 2074 6865 2067 6976       for the giv
-00017480: 656e 206f 7264 6572 696e 672e 2028 5365  en ordering. (Se
-00017490: 6520 7468 650a 2020 2020 2020 2020 3a72  e the.        :r
-000174a0: 6566 3a60 7472 6565 2072 6f6f 7473 203c  ef:`tree roots <
-000174b0: 7365 635f 6461 7461 5f6d 6f64 656c 5f74  sec_data_model_t
-000174c0: 7265 655f 7669 7274 7561 6c5f 726f 6f74  ree_virtual_root
-000174d0: 3e60 2073 6563 7469 6f6e 2066 6f72 206d  >` section for m
-000174e0: 6f72 650a 2020 2020 2020 2020 696e 666f  ore.        info
-000174f0: 726d 6174 696f 6e20 6f6e 2074 6865 2076  rmation on the v
-00017500: 6972 7475 616c 2072 6f6f 742e 290a 0a20  irtual root.).. 
-00017510: 2020 2020 2020 2054 6865 2060 606f 7264         The ``ord
-00017520: 6572 6060 2070 6172 616d 6574 6572 2064  er`` parameter d
-00017530: 6566 696e 6573 2074 6865 206f 7264 6572  efines the order
-00017540: 2069 6e20 7768 6963 6820 7472 6565 206e   in which tree n
-00017550: 6f64 6573 2061 7265 2076 6973 6974 6564  odes are visited
-00017560: 0a20 2020 2020 2020 2069 6e20 7468 6520  .        in the 
-00017570: 6974 6572 6174 696f 6e20 2861 6c73 6f20  iteration (also 
-00017580: 7365 6520 7468 6520 3a72 6566 3a60 7365  see the :ref:`se
-00017590: 635f 616e 616c 7973 696e 675f 7472 6565  c_analysing_tree
-000175a0: 735f 7472 6176 6572 7361 6c73 6020 7365  s_traversals` se
-000175b0: 6374 696f 6e0a 2020 2020 2020 2020 696e  ction.        in
-000175c0: 2074 6865 2060 7475 746f 7269 616c 7320   the `tutorials 
-000175d0: 3c68 7474 7073 3a2f 2f74 736b 6974 2e64  <https://tskit.d
-000175e0: 6576 2f74 7574 6f72 6961 6c73 3e60 5f5f  ev/tutorials>`__
-000175f0: 292e 2054 6865 2061 7661 696c 6162 6c65  ). The available
-00017600: 206f 7264 6572 7320 6172 653a 0a0a 2020   orders are:..  
-00017610: 2020 2020 2020 2d20 2770 7265 6f72 6465        - 'preorde
-00017620: 7227 3a20 7374 6172 7469 6e67 2061 7420  r': starting at 
-00017630: 726f 6f74 2c20 7969 656c 6420 7468 6520  root, yield the 
-00017640: 6375 7272 656e 7420 6e6f 6465 2c20 7468  current node, th
-00017650: 656e 2072 6563 7572 7365 0a20 2020 2020  en recurse.     
-00017660: 2020 2020 2061 6e64 2064 6f20 6120 7072       and do a pr
-00017670: 656f 7264 6572 206f 6e20 6561 6368 2063  eorder on each c
-00017680: 6869 6c64 206f 6620 7468 6520 6375 7272  hild of the curr
-00017690: 656e 7420 6e6f 6465 2e20 5365 6520 616c  ent node. See al
-000176a0: 736f 2060 5769 6b69 7065 6469 610a 2020  so `Wikipedia.  
-000176b0: 2020 2020 2020 2020 3c68 7474 7073 3a2f          <https:/
-000176c0: 2f65 6e2e 7769 6b69 7065 6469 612e 6f72  /en.wikipedia.or
-000176d0: 672f 7769 6b69 2f54 7265 655f 7472 6176  g/wiki/Tree_trav
-000176e0: 6572 7361 6c23 5072 652d 6f72 6465 725f  ersal#Pre-order_
-000176f0: 284e 4c52 293e 605f 5f2e 0a20 2020 2020  (NLR)>`__..     
-00017700: 2020 202d 2027 696e 6f72 6465 7227 3a20     - 'inorder': 
-00017710: 7374 6172 7469 6e67 2061 7420 726f 6f74  starting at root
-00017720: 2c20 6173 7375 6d69 6e67 2062 696e 6172  , assuming binar
-00017730: 7920 7472 6565 732c 2072 6563 7572 7365  y trees, recurse
-00017740: 2061 6e64 2064 6f0a 2020 2020 2020 2020   and do.        
-00017750: 2020 616e 2069 6e6f 7264 6572 206f 6e20    an inorder on 
-00017760: 7468 6520 6669 7273 7420 6368 696c 642c  the first child,
-00017770: 2074 6865 6e20 7969 656c 6420 7468 6520   then yield the 
-00017780: 6375 7272 656e 7420 6e6f 6465 2c20 7468  current node, th
-00017790: 656e 0a20 2020 2020 2020 2020 2072 6563  en.          rec
-000177a0: 7572 7365 2061 6e64 2064 6f20 616e 2069  urse and do an i
-000177b0: 6e6f 7264 6572 206f 6e20 7468 6520 7365  norder on the se
-000177c0: 636f 6e64 2063 6869 6c64 2e20 496e 2074  cond child. In t
-000177d0: 6865 2063 6173 6520 6f66 2060 606e 6060  he case of ``n``
-000177e0: 0a20 2020 2020 2020 2020 2063 6869 6c64  .          child
-000177f0: 206e 6f64 6573 2028 6e6f 7420 6e65 6365   nodes (not nece
-00017800: 7373 6172 696c 7920 3229 2c20 7468 6520  ssarily 2), the 
-00017810: 6669 7273 7420 6060 6e20 2f2f 2032 6060  first ``n // 2``
-00017820: 2063 6869 6c64 7265 6e20 6172 650a 2020   children are.  
-00017830: 2020 2020 2020 2020 7669 7369 7465 6420          visited 
-00017840: 696e 2074 6865 2066 6972 7374 2073 7461  in the first sta
-00017850: 6765 2c20 616e 6420 7468 6520 7265 6d61  ge, and the rema
-00017860: 696e 696e 6720 6060 6e20 2d20 6e20 2f2f  ining ``n - n //
-00017870: 2032 6060 2063 6869 6c64 7265 6e0a 2020   2`` children.  
-00017880: 2020 2020 2020 2020 6172 6520 7669 7369          are visi
-00017890: 7465 6420 696e 2074 6865 2073 6563 6f6e  ted in the secon
-000178a0: 6420 7374 6167 652e 2053 6565 2061 6c73  d stage. See als
-000178b0: 6f20 6057 696b 6970 6564 6961 0a20 2020  o `Wikipedia.   
-000178c0: 2020 2020 2020 203c 6874 7470 733a 2f2f         <https://
-000178d0: 656e 2e77 696b 6970 6564 6961 2e6f 7267  en.wikipedia.org
-000178e0: 2f77 696b 692f 5472 6565 5f74 7261 7665  /wiki/Tree_trave
-000178f0: 7273 616c 2349 6e2d 6f72 6465 725f 284c  rsal#In-order_(L
-00017900: 4e52 293e 605f 5f2e 0a20 2020 2020 2020  NR)>`__..       
-00017910: 202d 2027 706f 7374 6f72 6465 7227 3a20   - 'postorder': 
-00017920: 7374 6172 7469 6e67 2061 7420 726f 6f74  starting at root
-00017930: 2c20 7265 6375 7273 6520 616e 6420 646f  , recurse and do
-00017940: 2061 2070 6f73 746f 7264 6572 206f 6e20   a postorder on 
-00017950: 6561 6368 0a20 2020 2020 2020 2020 2063  each.          c
-00017960: 6869 6c64 206f 6620 7468 6520 6375 7272  hild of the curr
-00017970: 656e 7420 6e6f 6465 2c20 7468 656e 2079  ent node, then y
-00017980: 6965 6c64 2074 6865 2063 7572 7265 6e74  ield the current
-00017990: 206e 6f64 652e 2053 6565 2061 6c73 6f0a   node. See also.
-000179a0: 2020 2020 2020 2020 2020 6057 696b 6970            `Wikip
-000179b0: 6564 6961 0a20 2020 2020 2020 2020 203c  edia.          <
-000179c0: 6874 7470 733a 2f2f 656e 2e77 696b 6970  https://en.wikip
-000179d0: 6564 6961 2e6f 7267 2f77 696b 692f 5472  edia.org/wiki/Tr
-000179e0: 6565 5f74 7261 7665 7273 616c 2350 6f73  ee_traversal#Pos
-000179f0: 742d 6f72 6465 725f 284c 524e 293e 605f  t-order_(LRN)>`_
-00017a00: 5f2e 0a20 2020 2020 2020 202d 2027 6c65  _..        - 'le
-00017a10: 7665 6c6f 7264 6572 2720 2827 6272 6561  velorder' ('brea
-00017a20: 6474 6866 6972 7374 2729 3a20 7669 7369  dthfirst'): visi
-00017a30: 7420 7468 6520 6e6f 6465 7320 756e 6465  t the nodes unde
-00017a40: 7220 726f 6f74 2028 696e 636c 7564 696e  r root (includin
-00017a50: 670a 2020 2020 2020 2020 2020 7468 6520  g.          the 
-00017a60: 726f 6f74 2920 696e 2069 6e63 7265 6173  root) in increas
-00017a70: 696e 6720 6f72 6465 7220 6f66 2074 6865  ing order of the
-00017a80: 6972 2064 6570 7468 2066 726f 6d20 726f  ir depth from ro
-00017a90: 6f74 2e20 5365 6520 616c 736f 0a20 2020  ot. See also.   
-00017aa0: 2020 2020 2020 2060 5769 6b69 7065 6469         `Wikipedi
-00017ab0: 610a 2020 2020 2020 2020 2020 3c68 7474  a.          <htt
-00017ac0: 7073 3a2f 2f65 6e2e 7769 6b69 7065 6469  ps://en.wikipedi
-00017ad0: 612e 6f72 672f 7769 6b69 2f54 7265 655f  a.org/wiki/Tree_
-00017ae0: 7472 6176 6572 7361 6c5c 0a23 4272 6561  traversal\.#Brea
-00017af0: 6474 682d 6669 7273 745f 7365 6172 6368  dth-first_search
-00017b00: 5f2f 5f6c 6576 656c 5f6f 7264 6572 3e60  _/_level_order>`
-00017b10: 5f5f 2e0a 2020 2020 2020 2020 2d20 2774  __..        - 't
-00017b20: 696d 6561 7363 273a 2076 6973 6974 7320  imeasc': visits 
-00017b30: 7468 6520 6e6f 6465 7320 696e 206f 7264  the nodes in ord
-00017b40: 6572 206f 6620 696e 6372 6561 7369 6e67  er of increasing
-00017b50: 2074 696d 652c 2066 616c 6c69 6e67 2062   time, falling b
-00017b60: 6163 6b20 746f 0a20 2020 2020 2020 2020  ack to.         
-00017b70: 2069 6e63 7265 6173 696e 6720 4944 2069   increasing ID i
-00017b80: 6620 7469 6d65 7320 6172 6520 6571 7561  f times are equa
-00017b90: 6c2e 0a20 2020 2020 2020 202d 2027 7469  l..        - 'ti
-00017ba0: 6d65 6465 7363 273a 2076 6973 6974 7320  medesc': visits 
-00017bb0: 7468 6520 6e6f 6465 7320 696e 206f 7264  the nodes in ord
-00017bc0: 6572 206f 6620 6465 6372 6561 7369 6e67  er of decreasing
-00017bd0: 2074 696d 652c 2066 616c 6c69 6e67 2062   time, falling b
-00017be0: 6163 6b20 746f 0a20 2020 2020 2020 2020  ack to.         
-00017bf0: 2064 6563 7265 6173 696e 6720 4944 2069   decreasing ID i
-00017c00: 6620 7469 6d65 7320 6172 6520 6571 7561  f times are equa
-00017c10: 6c2e 0a20 2020 2020 2020 202d 2027 6d69  l..        - 'mi
-00017c20: 6e6c 6578 5f70 6f73 746f 7264 6572 273a  nlex_postorder':
-00017c30: 2061 2075 7375 616c 2070 6f73 746f 7264   a usual postord
-00017c40: 6572 2068 6173 2061 6d62 6967 7569 7479  er has ambiguity
-00017c50: 2069 6e20 7468 6520 6f72 6465 7220 696e   in the order in
-00017c60: 0a20 2020 2020 2020 2020 2077 6869 6368  .          which
-00017c70: 2063 6869 6c64 7265 6e20 6f66 2061 206e   children of a n
-00017c80: 6f64 6520 6172 6520 7669 7369 7465 642e  ode are visited.
-00017c90: 2057 6520 636f 6e73 7472 6169 6e20 7468   We constrain th
-00017ca0: 6973 2062 7920 6f75 7470 7574 7469 6e67  is by outputting
-00017cb0: 0a20 2020 2020 2020 2020 2061 2070 6f73  .          a pos
-00017cc0: 746f 7264 6572 2073 7563 6820 7468 6174  torder such that
-00017cd0: 2074 6865 206c 6561 7665 7320 7669 7369   the leaves visi
-00017ce0: 7465 642c 2077 6865 6e20 7468 6569 7220  ted, when their 
-00017cf0: 4944 7320 6172 650a 2020 2020 2020 2020  IDs are.        
-00017d00: 2020 6c69 7374 6564 206f 7574 2c20 6861    listed out, ha
-00017d10: 7665 206d 696e 696d 756d 2060 6c65 7869  ve minimum `lexi
-00017d20: 636f 6772 6170 6869 6320 6f72 6465 720a  cographic order.
-00017d30: 2020 2020 2020 2020 2020 3c68 7474 7073            <https
-00017d40: 3a2f 2f65 6e2e 7769 6b69 7065 6469 612e  ://en.wikipedia.
-00017d50: 6f72 672f 7769 6b69 2f4c 6578 6963 6f67  org/wiki/Lexicog
-00017d60: 7261 7068 6963 616c 5f6f 7264 6572 3e60  raphical_order>`
-00017d70: 5f5f 206f 7574 206f 6620 616c 6c20 7661  __ out of all va
-00017d80: 6c69 640a 2020 2020 2020 2020 2020 7472  lid.          tr
-00017d90: 6176 6572 7361 6c73 2e20 5468 6973 2074  aversals. This t
-00017da0: 7261 7665 7273 616c 2069 7320 7573 6566  raversal is usef
-00017db0: 756c 2066 6f72 2064 7261 7769 6e67 206d  ul for drawing m
-00017dc0: 756c 7469 706c 6520 7472 6565 7320 6f66  ultiple trees of
-00017dd0: 0a20 2020 2020 2020 2020 2061 2060 6054  .          a ``T
-00017de0: 7265 6553 6571 7565 6e63 6560 602c 2061  reeSequence``, a
-00017df0: 7320 6974 206c 6561 6473 2074 6f20 6d6f  s it leads to mo
-00017e00: 7265 2063 6f6e 7369 7374 656e 6379 2062  re consistency b
-00017e10: 6574 7765 656e 2061 646a 6163 656e 740a  etween adjacent.
-00017e20: 2020 2020 2020 2020 2020 7472 6565 732e            trees.
-00017e30: 204e 6f74 6520 7468 6174 2069 6e74 6572   Note that inter
-00017e40: 6e61 6c20 6e6f 6e2d 6c65 6166 206e 6f64  nal non-leaf nod
-00017e50: 6573 2061 7265 206e 6f74 2063 6f75 6e74  es are not count
-00017e60: 6564 2069 6e0a 2020 2020 2020 2020 2020  ed in.          
-00017e70: 6173 7365 7373 696e 6720 7468 6520 6c65  assessing the le
-00017e80: 7869 636f 6772 6170 6869 6320 6f72 6465  xicographic orde
-00017e90: 722e 0a0a 2020 2020 2020 2020 3a70 6172  r...        :par
-00017ea0: 616d 2069 6e74 2072 6f6f 743a 2054 6865  am int root: The
-00017eb0: 2072 6f6f 7420 6f66 2074 6865 2073 7562   root of the sub
-00017ec0: 7472 6565 2077 6520 6172 6520 7472 6176  tree we are trav
-00017ed0: 6572 7369 6e67 2e0a 2020 2020 2020 2020  ersing..        
-00017ee0: 3a70 6172 616d 2073 7472 206f 7264 6572  :param str order
-00017ef0: 3a20 5468 6520 7472 6176 6572 7361 6c20  : The traversal 
-00017f00: 6f72 6465 7269 6e67 2e20 4375 7272 656e  ordering. Curren
-00017f10: 746c 7920 2770 7265 6f72 6465 7227 2c0a  tly 'preorder',.
-00017f20: 2020 2020 2020 2020 2020 2020 2769 6e6f              'ino
-00017f30: 7264 6572 272c 2027 706f 7374 6f72 6465  rder', 'postorde
-00017f40: 7227 2c20 276c 6576 656c 6f72 6465 7227  r', 'levelorder'
-00017f50: 2028 2762 7265 6164 7468 6669 7273 7427   ('breadthfirst'
-00017f60: 292c 2027 7469 6d65 6173 6327 2061 6e64  ), 'timeasc' and
-00017f70: 0a20 2020 2020 2020 2020 2020 2027 7469  .            'ti
-00017f80: 6d65 6465 7363 2720 616e 6420 276d 696e  medesc' and 'min
-00017f90: 6c65 785f 706f 7374 6f72 6465 7227 2061  lex_postorder' a
-00017fa0: 7265 2073 7570 706f 7274 6564 2e0a 2020  re supported..  
-00017fb0: 2020 2020 2020 3a72 6574 7572 6e3a 2041        :return: A
-00017fc0: 6e20 6974 6572 6174 6f72 206f 7665 7220  n iterator over 
-00017fd0: 7468 6520 6e6f 6465 2049 4473 2069 6e20  the node IDs in 
-00017fe0: 7468 6520 7472 6565 2069 6e20 736f 6d65  the tree in some
-00017ff0: 2074 7261 7665 7273 616c 206f 7264 6572   traversal order
-00018000: 2e0a 2020 2020 2020 2020 3a72 7479 7065  ..        :rtype
-00018010: 3a20 636f 6c6c 6563 7469 6f6e 732e 6162  : collections.ab
-00018020: 632e 4974 6572 6162 6c65 2c20 696e 740a  c.Iterable, int.
-00018030: 2020 2020 2020 2020 2222 220a 2020 2020          """.    
-00018040: 2020 2020 6d65 7468 6f64 7320 3d20 7b0a      methods = {.
-00018050: 2020 2020 2020 2020 2020 2020 2270 7265              "pre
-00018060: 6f72 6465 7222 3a20 7365 6c66 2e5f 7072  order": self._pr
-00018070: 656f 7264 6572 5f74 7261 7665 7273 616c  eorder_traversal
-00018080: 2c0a 2020 2020 2020 2020 2020 2020 2269  ,.            "i
-00018090: 6e6f 7264 6572 223a 2073 656c 662e 5f69  norder": self._i
-000180a0: 6e6f 7264 6572 5f74 7261 7665 7273 616c  norder_traversal
-000180b0: 2c0a 2020 2020 2020 2020 2020 2020 2270  ,.            "p
-000180c0: 6f73 746f 7264 6572 223a 2073 656c 662e  ostorder": self.
-000180d0: 5f70 6f73 746f 7264 6572 5f74 7261 7665  _postorder_trave
-000180e0: 7273 616c 2c0a 2020 2020 2020 2020 2020  rsal,.          
-000180f0: 2020 226c 6576 656c 6f72 6465 7222 3a20    "levelorder": 
-00018100: 7365 6c66 2e5f 6c65 7665 6c6f 7264 6572  self._levelorder
-00018110: 5f74 7261 7665 7273 616c 2c0a 2020 2020  _traversal,.    
-00018120: 2020 2020 2020 2020 2262 7265 6164 7468          "breadth
-00018130: 6669 7273 7422 3a20 7365 6c66 2e5f 6c65  first": self._le
-00018140: 7665 6c6f 7264 6572 5f74 7261 7665 7273  velorder_travers
-00018150: 616c 2c0a 2020 2020 2020 2020 2020 2020  al,.            
-00018160: 2274 696d 6561 7363 223a 2073 656c 662e  "timeasc": self.
-00018170: 5f74 696d 6561 7363 5f74 7261 7665 7273  _timeasc_travers
-00018180: 616c 2c0a 2020 2020 2020 2020 2020 2020  al,.            
-00018190: 2274 696d 6564 6573 6322 3a20 7365 6c66  "timedesc": self
-000181a0: 2e5f 7469 6d65 6465 7363 5f74 7261 7665  ._timedesc_trave
-000181b0: 7273 616c 2c0a 2020 2020 2020 2020 2020  rsal,.          
-000181c0: 2020 226d 696e 6c65 785f 706f 7374 6f72    "minlex_postor
-000181d0: 6465 7222 3a20 7365 6c66 2e5f 6d69 6e6c  der": self._minl
-000181e0: 6578 5f70 6f73 746f 7264 6572 5f74 7261  ex_postorder_tra
-000181f0: 7665 7273 616c 2c0a 2020 2020 2020 2020  versal,.        
-00018200: 7d0a 2020 2020 2020 2020 7472 793a 0a20  }.        try:. 
-00018210: 2020 2020 2020 2020 2020 2069 7465 7261             itera
-00018220: 746f 7220 3d20 6d65 7468 6f64 735b 6f72  tor = methods[or
-00018230: 6465 725d 0a20 2020 2020 2020 2065 7863  der].        exc
-00018240: 6570 7420 4b65 7945 7272 6f72 3a0a 2020  ept KeyError:.  
-00018250: 2020 2020 2020 2020 2020 7261 6973 6520            raise 
-00018260: 5661 6c75 6545 7272 6f72 2866 2254 7261  ValueError(f"Tra
-00018270: 7665 7273 616c 206f 7264 6572 696e 6720  versal ordering 
-00018280: 277b 6f72 6465 727d 2720 6e6f 7420 7375  '{order}' not su
-00018290: 7070 6f72 7465 6422 290a 0a20 2020 2020  pported")..     
-000182a0: 2020 2072 6f6f 7420 3d20 2d31 2069 6620     root = -1 if 
-000182b0: 726f 6f74 2069 7320 4e6f 6e65 2065 6c73  root is None els
-000182c0: 6520 726f 6f74 0a20 2020 2020 2020 2072  e root.        r
-000182d0: 6574 7572 6e20 6974 6572 6174 6f72 2872  eturn iterator(r
-000182e0: 6f6f 7429 0a0a 2020 2020 6465 6620 5f61  oot)..    def _a
-000182f0: 735f 6e65 7769 636b 5f66 6173 7428 7365  s_newick_fast(se
-00018300: 6c66 2c20 2a2c 2072 6f6f 742c 2070 7265  lf, *, root, pre
-00018310: 6369 7369 6f6e 2c20 6c65 6761 6379 5f6d  cision, legacy_m
-00018320: 735f 6c61 6265 6c73 293a 0a20 2020 2020  s_labels):.     
-00018330: 2020 2022 2222 0a20 2020 2020 2020 2043     """.        C
-00018340: 616c 6c20 696e 746f 2074 6865 2066 6173  all into the fas
-00018350: 7420 6275 7420 6c69 6d69 7465 6420 4320  t but limited C 
-00018360: 696d 706c 656d 656e 7461 7469 6f6e 206f  implementation o
-00018370: 6620 7468 6520 6e65 7769 636b 2063 6f6e  f the newick con
-00018380: 7665 7273 696f 6e2e 0a20 2020 2020 2020  version..       
-00018390: 2022 2222 0a20 2020 2020 2020 2072 6f6f   """.        roo
-000183a0: 745f 7469 6d65 203d 206d 6178 2831 2c20  t_time = max(1, 
-000183b0: 7365 6c66 2e74 696d 6528 726f 6f74 2929  self.time(root))
-000183c0: 0a20 2020 2020 2020 206d 6178 5f6c 6162  .        max_lab
-000183d0: 656c 5f73 697a 6520 3d20 6d61 7468 2e63  el_size = math.c
-000183e0: 6569 6c28 6d61 7468 2e6c 6f67 3130 2873  eil(math.log10(s
-000183f0: 656c 662e 7472 6565 5f73 6571 7565 6e63  elf.tree_sequenc
-00018400: 652e 6e75 6d5f 6e6f 6465 7329 290a 2020  e.num_nodes)).  
-00018410: 2020 2020 2020 7369 6e67 6c65 5f6e 6f64        single_nod
-00018420: 655f 7369 7a65 203d 2028 0a20 2020 2020  e_size = (.     
-00018430: 2020 2020 2020 2035 202b 206d 6178 5f6c         5 + max_l
-00018440: 6162 656c 5f73 697a 6520 2b20 6d61 7468  abel_size + math
-00018450: 2e63 6569 6c28 6d61 7468 2e6c 6f67 3130  .ceil(math.log10
-00018460: 2872 6f6f 745f 7469 6d65 2929 202b 2070  (root_time)) + p
-00018470: 7265 6369 7369 6f6e 0a20 2020 2020 2020  recision.       
-00018480: 2029 0a20 2020 2020 2020 2062 7566 6665   ).        buffe
-00018490: 725f 7369 7a65 203d 2031 202b 2073 696e  r_size = 1 + sin
-000184a0: 676c 655f 6e6f 6465 5f73 697a 6520 2a20  gle_node_size * 
-000184b0: 7365 6c66 2e74 7265 655f 7365 7175 656e  self.tree_sequen
-000184c0: 6365 2e6e 756d 5f6e 6f64 6573 0a20 2020  ce.num_nodes.   
-000184d0: 2020 2020 2072 6574 7572 6e20 7365 6c66       return self
-000184e0: 2e5f 6c6c 5f74 7265 652e 6765 745f 6e65  ._ll_tree.get_ne
-000184f0: 7769 636b 280a 2020 2020 2020 2020 2020  wick(.          
-00018500: 2020 7072 6563 6973 696f 6e3d 7072 6563    precision=prec
-00018510: 6973 696f 6e2c 0a20 2020 2020 2020 2020  ision,.         
-00018520: 2020 2072 6f6f 743d 726f 6f74 2c0a 2020     root=root,.  
-00018530: 2020 2020 2020 2020 2020 6275 6666 6572            buffer
-00018540: 5f73 697a 653d 6275 6666 6572 5f73 697a  _size=buffer_siz
-00018550: 652c 0a20 2020 2020 2020 2020 2020 206c  e,.            l
-00018560: 6567 6163 795f 6d73 5f6c 6162 656c 733d  egacy_ms_labels=
-00018570: 6c65 6761 6379 5f6d 735f 6c61 6265 6c73  legacy_ms_labels
-00018580: 2c0a 2020 2020 2020 2020 290a 0a20 2020  ,.        )..   
-00018590: 2064 6566 2061 735f 6e65 7769 636b 280a   def as_newick(.
-000185a0: 2020 2020 2020 2020 7365 6c66 2c0a 2020          self,.  
-000185b0: 2020 2020 2020 2a2c 0a20 2020 2020 2020        *,.       
-000185c0: 2072 6f6f 743d 4e6f 6e65 2c0a 2020 2020   root=None,.    
-000185d0: 2020 2020 7072 6563 6973 696f 6e3d 4e6f      precision=No
-000185e0: 6e65 2c0a 2020 2020 2020 2020 6e6f 6465  ne,.        node
-000185f0: 5f6c 6162 656c 733d 4e6f 6e65 2c0a 2020  _labels=None,.  
-00018600: 2020 2020 2020 696e 636c 7564 655f 6272        include_br
-00018610: 616e 6368 5f6c 656e 6774 6873 3d4e 6f6e  anch_lengths=Non
-00018620: 652c 0a20 2020 2029 3a0a 2020 2020 2020  e,.    ):.      
-00018630: 2020 2222 220a 2020 2020 2020 2020 5265    """.        Re
-00018640: 7475 726e 7320 6120 606e 6577 6963 6b20  turns a `newick 
-00018650: 656e 636f 6469 6e67 0a20 2020 2020 2020  encoding.       
-00018660: 203c 6874 7470 733a 2f2f 656e 2e77 696b   <https://en.wik
-00018670: 6970 6564 6961 2e6f 7267 2f77 696b 692f  ipedia.org/wiki/
-00018680: 4e65 7769 636b 5f66 6f72 6d61 743e 605f  Newick_format>`_
-00018690: 206f 6620 7468 6973 2074 7265 652e 0a20   of this tree.. 
-000186a0: 2020 2020 2020 2046 6f72 2065 7861 6d70         For examp
-000186b0: 6c65 2c20 6120 6269 6e61 7279 2074 7265  le, a binary tre
-000186c0: 6520 7769 7468 2033 206c 6561 7665 7320  e with 3 leaves 
-000186d0: 6765 6e65 7261 7465 6420 6279 0a20 2020  generated by.   
-000186e0: 2020 2020 203a 6d65 7468 3a60 5472 6565       :meth:`Tree
-000186f0: 2e67 656e 6572 6174 655f 6261 6c61 6e63  .generate_balanc
-00018700: 6564 2833 293c 5472 6565 2e67 656e 6572  ed(3)<Tree.gener
-00018710: 6174 655f 6261 6c61 6e63 6564 3e60 0a20  ate_balanced>`. 
-00018720: 2020 2020 2020 2065 6e63 6f64 6573 2061         encodes a
-00018730: 733a 3a0a 0a20 2020 2020 2020 2020 2020  s::..           
-00018740: 2028 6e30 3a32 2c28 6e31 3a31 2c6e 323a   (n0:2,(n1:1,n2:
-00018750: 3129 3a31 293b 0a0a 2020 2020 2020 2020  1):1);..        
-00018760: 4279 2064 6566 6175 6c74 203a 7265 663a  By default :ref:
-00018770: 6073 616d 706c 6520 6e6f 6465 733c 7365  `sample nodes<se
-00018780: 635f 6461 7461 5f6d 6f64 656c 5f64 6566  c_data_model_def
-00018790: 696e 6974 696f 6e73 3e60 2061 7265 0a20  initions>` are. 
-000187a0: 2020 2020 2020 206c 6162 656c 6c65 6420         labelled 
-000187b0: 7573 696e 6720 7468 6520 666f 726d 2060  using the form `
-000187c0: 6066 226e 7b6e 6f64 655f 6964 7d22 6060  `f"n{node_id}"``
-000187d0: 2c20 692e 652e 2074 6865 2073 616d 706c  , i.e. the sampl
-000187e0: 6520 6e6f 6465 2773 0a20 2020 2020 2020  e node's.       
-000187f0: 2049 4420 7072 6566 6978 6564 2077 6974   ID prefixed wit
-00018800: 6820 7468 6520 7374 7269 6e67 2060 6022  h the string ``"
-00018810: 6e22 6060 2e20 4e6f 6465 206c 6162 656c  n"``. Node label
-00018820: 7320 6361 6e20 6265 2073 7065 6369 6669  s can be specifi
-00018830: 6564 0a20 2020 2020 2020 2065 7870 6c69  ed.        expli
-00018840: 6369 746c 7920 7573 696e 6720 7468 6520  citly using the 
-00018850: 6060 6e6f 6465 5f6c 6162 656c 7360 6020  ``node_labels`` 
-00018860: 6172 6775 6d65 6e74 2c20 7768 6963 6820  argument, which 
-00018870: 6973 2061 206d 6170 7069 6e67 2066 726f  is a mapping fro
-00018880: 6d0a 2020 2020 2020 2020 696e 7465 6765  m.        intege
-00018890: 7220 6e6f 6465 2049 4473 2074 6f20 7468  r node IDs to th
-000188a0: 6520 636f 7272 6573 706f 6e64 696e 6720  e corresponding 
-000188b0: 7374 7269 6e67 206c 6162 656c 2e20 4966  string label. If
-000188c0: 2061 206e 6f64 6520 6973 206e 6f74 0a20   a node is not. 
-000188d0: 2020 2020 2020 2070 7265 7365 6e74 2069         present i
-000188e0: 6e20 7468 6520 6d61 7070 696e 672c 206e  n the mapping, n
-000188f0: 6f20 6c61 6265 6c20 6973 2061 7373 6f63  o label is assoc
-00018900: 6961 7465 6420 7769 7468 2074 6865 206e  iated with the n
-00018910: 6f64 6520 696e 0a20 2020 2020 2020 206f  ode in.        o
-00018920: 7574 7075 742e 0a0a 2020 2020 2020 2020  utput...        
-00018930: 2e2e 2077 6172 6e69 6e67 3a3a 204e 6f64  .. warning:: Nod
-00018940: 6520 6c61 6265 6c73 2061 7265 202a 2a6e  e labels are **n
-00018950: 6f74 2a2a 204e 6577 6963 6b20 6573 6361  ot** Newick esca
-00018960: 7065 642c 2073 6f20 6361 7265 206d 7573  ped, so care mus
-00018970: 7420 6265 2074 616b 656e 0a20 2020 2020  t be taken.     
-00018980: 2020 2020 2020 2074 6f20 7072 6f76 6964         to provid
-00018990: 6520 6c61 6265 6c73 2074 6861 7420 7769  e labels that wi
-000189a0: 6c6c 206e 6f74 2062 7265 616b 2074 6865  ll not break the
-000189b0: 2065 6e63 6f64 696e 672e 0a0a 2020 2020   encoding...    
-000189c0: 2020 2020 2e2e 206e 6f74 653a 3a20 5370      .. note:: Sp
-000189d0: 6563 6966 7969 6e67 2061 2060 606e 6f64  ecifying a ``nod
-000189e0: 655f 6c61 6265 6c73 6060 2064 6963 7469  e_labels`` dicti
-000189f0: 6f6e 6172 7920 6f72 2073 6574 7469 6e67  onary or setting
-00018a00: 0a20 2020 2020 2020 2020 2020 2060 6069  .            ``i
-00018a10: 6e63 6c75 6465 5f62 7261 6e63 685f 6c65  nclude_branch_le
-00018a20: 6e67 7468 733d 4661 6c73 6560 6020 7265  ngths=False`` re
-00018a30: 7375 6c74 7320 696e 2061 206c 6573 7320  sults in a less 
-00018a40: 6566 6669 6369 656e 740a 2020 2020 2020  efficient.      
-00018a50: 2020 2020 2020 6d65 7468 6f64 2062 6569        method bei
-00018a60: 6e67 2075 7365 6420 746f 2067 656e 6572  ng used to gener
-00018a70: 6174 6520 7468 6520 6e65 7769 636b 206f  ate the newick o
-00018a80: 7574 7075 742e 2054 6865 2070 6572 666f  utput. The perfo
-00018a90: 726d 616e 6365 0a20 2020 2020 2020 2020  rmance.         
-00018aa0: 2020 2064 6966 6665 7265 6e63 6520 6361     difference ca
-00018ab0: 6e20 6265 2073 7562 7374 616e 7469 616c  n be substantial
-00018ac0: 2066 6f72 206c 6172 6765 2074 7265 6573   for large trees
-00018ad0: 2e0a 0a20 2020 2020 2020 2042 7920 6465  ...        By de
-00018ae0: 6661 756c 742c 2062 7261 6e63 6820 6c65  fault, branch le
-00018af0: 6e67 7468 7320 6172 6520 7072 696e 7465  ngths are printe
-00018b00: 6420 6f75 7420 7769 7468 2073 7566 6669  d out with suffi
-00018b10: 6369 656e 7420 7072 6563 6973 696f 6e0a  cient precision.
-00018b20: 2020 2020 2020 2020 666f 7220 7468 656d          for them
-00018b30: 2074 6f20 6265 2072 6563 6f76 6572 6564   to be recovered
-00018b40: 2065 7861 6374 6c79 2069 6e20 646f 7562   exactly in doub
-00018b50: 6c65 2070 7265 6369 7369 6f6e 2028 616c  le precision (al
-00018b60: 7468 6f75 6768 206e 6f74 650a 2020 2020  though note.    
-00018b70: 2020 2020 7468 6174 2074 6869 7320 646f      that this do
-00018b80: 6573 206e 6f74 206e 6563 6573 7361 7269  es not necessari
-00018b90: 6c79 206d 6561 6e20 7468 6174 2077 6520  ly mean that we 
-00018ba0: 6361 6e20 7072 6563 6973 656c 7920 7265  can precisely re
-00018bb0: 636f 7665 7220 7468 650a 2020 2020 2020  cover the.      
-00018bc0: 2020 636f 7272 6573 706f 6e64 696e 6720    corresponding 
-00018bd0: 6e6f 6465 2074 696d 6573 2c20 7369 6e63  node times, sinc
-00018be0: 6520 6272 616e 6368 206c 656e 6774 6873  e branch lengths
-00018bf0: 2061 7265 206f 6274 6169 6e65 6420 6279   are obtained by
-00018c00: 0a20 2020 2020 2020 2073 7562 7472 6163  .        subtrac
-00018c10: 7469 6f6e 292e 2049 6620 616c 6c20 7469  tion). If all ti
-00018c20: 6d65 7320 6f6e 2074 6865 2074 7265 6520  mes on the tree 
-00018c30: 7365 7175 656e 6365 2061 7265 2064 6973  sequence are dis
-00018c40: 6372 6574 652c 2074 6865 6e0a 2020 2020  crete, then.    
-00018c50: 2020 2020 6272 616e 6368 206c 656e 6774      branch lengt
-00018c60: 6873 2061 7265 2070 7269 6e74 6564 2061  hs are printed a
-00018c70: 7320 696e 7465 6765 7273 2e20 4f74 6865  s integers. Othe
-00018c80: 7277 6973 652c 2062 7261 6e63 6820 6c65  rwise, branch le
-00018c90: 6e67 7468 7320 6172 650a 2020 2020 2020  ngths are.      
-00018ca0: 2020 7072 696e 7465 6420 7769 7468 2031    printed with 1
-00018cb0: 3720 6469 6769 7473 206f 6620 7072 6563  7 digits of prec
-00018cc0: 6973 696f 6e20 2869 2e65 2e2c 2060 6022  ision (i.e., ``"
-00018cd0: 252e 3137 6622 6060 2069 6e0a 2020 2020  %.17f"`` in.    
-00018ce0: 2020 2020 7072 696e 7466 2d6e 6f74 6174      printf-notat
-00018cf0: 696f 6e29 2e0a 0a20 2020 2020 2020 2054  ion)...        T
-00018d00: 6865 2070 7265 6369 7369 6f6e 2066 6f72  he precision for
-00018d10: 2062 7261 6e63 6820 6c65 6e67 7468 7320   branch lengths 
-00018d20: 6361 6e20 6265 2073 7065 6369 6669 6564  can be specified
-00018d30: 2075 7369 6e67 2074 6865 2060 6070 7265   using the ``pre
-00018d40: 6369 7369 6f6e 6060 0a20 2020 2020 2020  cision``.       
-00018d50: 2061 7267 756d 656e 742e 2042 7261 6e63   argument. Branc
-00018d60: 6820 6c65 6e67 7468 7320 6361 6e20 6265  h lengths can be
-00018d70: 206f 6d69 7474 6564 2065 6e74 6972 656c   omitted entirel
-00018d80: 7920 6279 2073 6574 7469 6e67 0a20 2020  y by setting.   
-00018d90: 2020 2020 2060 6069 6e63 6c75 6465 5f62       ``include_b
-00018da0: 7261 6e63 685f 6c65 6e67 7468 733d 4661  ranch_lengths=Fa
-00018db0: 6c73 6560 602e 0a0a 2020 2020 2020 2020  lse``...        
-00018dc0: 4966 2074 6865 2060 6072 6f6f 7460 6020  If the ``root`` 
-00018dd0: 6172 6775 6d65 6e74 2069 7320 7370 6563  argument is spec
-00018de0: 6966 6965 642c 2077 6520 7265 7475 726e  ified, we return
-00018df0: 2074 6865 206e 6577 6963 6b20 656e 636f   the newick enco
-00018e00: 6469 6e67 206f 660a 2020 2020 2020 2020  ding of.        
-00018e10: 7468 6520 7370 6563 6966 6965 6420 7375  the specified su
-00018e20: 6274 7265 652c 206f 7468 6572 7769 7365  btree, otherwise
-00018e30: 2074 6865 2066 756c 6c20 7472 6565 2069   the full tree i
-00018e40: 7320 7265 7475 726e 6564 2e20 4966 2074  s returned. If t
-00018e50: 6865 2074 7265 650a 2020 2020 2020 2020  he tree.        
-00018e60: 6861 7320 3a72 6566 3a60 6d75 6c74 6970  has :ref:`multip
-00018e70: 6c65 2072 6f6f 7473 203c 7365 635f 6461  le roots <sec_da
-00018e80: 7461 5f6d 6f64 656c 5f74 7265 655f 726f  ta_model_tree_ro
-00018e90: 6f74 733e 6020 616e 6420 6120 726f 6f74  ots>` and a root
-00018ea0: 206e 6f64 650a 2020 2020 2020 2020 6973   node.        is
-00018eb0: 206e 6f74 2065 7870 6c69 6369 746c 7920   not explicitly 
-00018ec0: 7370 6563 6966 6965 642c 2077 6520 7261  specified, we ra
-00018ed0: 6973 6520 6120 6060 5661 6c75 6545 7272  ise a ``ValueErr
-00018ee0: 6f72 6060 2e20 5468 6973 2069 7320 6265  or``. This is be
-00018ef0: 6361 7573 650a 2020 2020 2020 2020 6d6f  cause.        mo
-00018f00: 7374 206c 6962 7261 7269 6573 2061 6e64  st libraries and
-00018f10: 2064 6f77 6e73 7472 6561 6d20 736f 6674   downstream soft
-00018f20: 7761 7265 2063 6f6e 7369 6465 7220 6120  ware consider a 
-00018f30: 6e65 7769 636b 2073 7472 696e 6720 7468  newick string th
-00018f40: 6174 0a20 2020 2020 2020 2063 6f6e 7461  at.        conta
-00018f50: 696e 7320 6d75 6c74 6970 6c65 2064 6973  ins multiple dis
-00018f60: 636f 6e6e 6563 7465 6420 7375 6274 7265  connected subtre
-00018f70: 6573 2061 6e20 6572 726f 722c 2061 6e64  es an error, and
-00018f80: 2069 7420 6973 2074 6865 7265 666f 7265   it is therefore
-00018f90: 0a20 2020 2020 2020 2062 6573 7420 746f  .        best to
-00018fa0: 2063 6f6e 7369 6465 7220 686f 7720 7375   consider how su
-00018fb0: 6368 2074 6f70 6f6c 6f67 6965 7320 7368  ch topologies sh
-00018fc0: 6f75 6c64 2062 6520 696e 7465 7263 6861  ould be intercha
-00018fd0: 6e67 6564 206f 6e20 610a 2020 2020 2020  nged on a.      
-00018fe0: 2020 6361 7365 2d62 792d 6261 7365 2062    case-by-base b
-00018ff0: 6173 6973 2e20 4120 6c69 7374 206f 6620  asis. A list of 
-00019000: 7468 6520 6e65 7769 636b 2073 7472 696e  the newick strin
-00019010: 6773 2066 6f72 2065 6163 6820 726f 6f74  gs for each root
-00019020: 2063 616e 2062 650a 2020 2020 2020 2020   can be.        
-00019030: 6f62 7461 696e 6564 2062 7920 6060 5b74  obtained by ``[t
-00019040: 7265 652e 6173 5f6e 6577 6963 6b28 726f  ree.as_newick(ro
-00019050: 6f74 3d72 6f6f 7429 2066 6f72 2072 6f6f  ot=root) for roo
-00019060: 7420 696e 2074 7265 652e 726f 6f74 735d  t in tree.roots]
-00019070: 6060 2e0a 0a20 2020 2020 2020 203a 7061  ``...        :pa
-00019080: 7261 6d20 696e 7420 7072 6563 6973 696f  ram int precisio
-00019090: 6e3a 2054 6865 206e 756d 6572 6963 616c  n: The numerical
-000190a0: 2070 7265 6369 7369 6f6e 2077 6974 6820   precision with 
-000190b0: 7768 6963 6820 6272 616e 6368 206c 656e  which branch len
-000190c0: 6774 6873 2061 7265 0a20 2020 2020 2020  gths are.       
-000190d0: 2020 2020 2070 7269 6e74 6564 2e20 4966       printed. If
-000190e0: 206e 6f74 2073 7065 6369 6669 6564 206f   not specified o
-000190f0: 7220 4e6f 6e65 2064 6566 6175 6c74 2074  r None default t
-00019100: 6f20 3020 6966 2074 6865 2074 7265 6520  o 0 if the tree 
-00019110: 7365 7175 656e 6365 0a20 2020 2020 2020  sequence.       
-00019120: 2020 2020 2063 6f6e 7461 696e 7320 6f6e       contains on
-00019130: 6c79 2069 6e74 6567 6572 206e 6f64 6520  ly integer node 
-00019140: 7469 6d65 732c 206f 7220 3137 206f 7468  times, or 17 oth
-00019150: 6572 7769 7365 2e0a 2020 2020 2020 2020  erwise..        
-00019160: 3a70 6172 616d 2069 6e74 2072 6f6f 743a  :param int root:
-00019170: 2049 6620 7370 6563 6966 6965 642c 2072   If specified, r
-00019180: 6574 7572 6e20 7468 6520 7472 6565 2072  eturn the tree r
-00019190: 6f6f 7465 6420 6174 2074 6869 7320 6e6f  ooted at this no
-000191a0: 6465 2e0a 2020 2020 2020 2020 3a70 6172  de..        :par
-000191b0: 616d 2064 6963 7420 6e6f 6465 5f6c 6162  am dict node_lab
-000191c0: 656c 733a 2049 6620 7370 6563 6966 6965  els: If specifie
-000191d0: 642c 2073 686f 7720 6375 7374 6f6d 206c  d, show custom l
-000191e0: 6162 656c 7320 666f 7220 7468 6520 6e6f  abels for the no
-000191f0: 6465 730a 2020 2020 2020 2020 2020 2020  des.            
-00019200: 7468 6174 2061 7265 2070 7265 7365 6e74  that are present
-00019210: 2069 6e20 7468 6520 6d61 702e 2041 6e79   in the map. Any
-00019220: 206e 6f64 6573 206e 6f74 2073 7065 6369   nodes not speci
-00019230: 6669 6564 2069 6e20 7468 6520 6d61 7020  fied in the map 
-00019240: 7769 6c6c 0a20 2020 2020 2020 2020 2020  will.           
-00019250: 206e 6f74 2068 6176 6520 6120 6e6f 6465   not have a node
-00019260: 206c 6162 656c 2e0a 2020 2020 2020 2020   label..        
-00019270: 3a70 6172 616d 2069 6e63 6c75 6465 5f62  :param include_b
-00019280: 7261 6e63 685f 6c65 6e67 7468 733a 2049  ranch_lengths: I
-00019290: 6620 5472 7565 2028 6465 6661 756c 7429  f True (default)
-000192a0: 2c20 6f75 7470 7574 2062 7261 6e63 6820  , output branch 
-000192b0: 6c65 6e67 7468 7320 696e 2074 6865 0a20  lengths in the. 
-000192c0: 2020 2020 2020 2020 2020 204e 6577 6963             Newic
-000192d0: 6b20 7374 7269 6e67 2e20 4966 2046 616c  k string. If Fal
-000192e0: 7365 2c20 6f6e 6c79 206f 7574 7075 7420  se, only output 
-000192f0: 7468 6520 746f 706f 6c6f 6779 2c20 7769  the topology, wi
-00019300: 7468 6f75 7420 6272 616e 6368 206c 656e  thout branch len
-00019310: 6774 6873 2e0a 2020 2020 2020 2020 3a72  gths..        :r
-00019320: 6574 7572 6e3a 2041 206e 6577 6963 6b20  eturn: A newick 
-00019330: 7265 7072 6573 656e 7461 7469 6f6e 206f  representation o
-00019340: 6620 7468 6973 2074 7265 652e 0a20 2020  f this tree..   
-00019350: 2020 2020 203a 7274 7970 653a 2073 7472       :rtype: str
-00019360: 0a20 2020 2020 2020 2022 2222 0a20 2020  .        """.   
-00019370: 2020 2020 2069 6620 726f 6f74 2069 7320       if root is 
-00019380: 4e6f 6e65 3a0a 2020 2020 2020 2020 2020  None:.          
-00019390: 2020 6966 206e 6f74 2073 656c 662e 6861    if not self.ha
-000193a0: 735f 7369 6e67 6c65 5f72 6f6f 743a 0a20  s_single_root:. 
-000193b0: 2020 2020 2020 2020 2020 2020 2020 2072                 r
-000193c0: 6169 7365 2056 616c 7565 4572 726f 7228  aise ValueError(
-000193d0: 0a20 2020 2020 2020 2020 2020 2020 2020  .               
-000193e0: 2020 2020 2022 4361 6e6e 6f74 2067 6574       "Cannot get
-000193f0: 206e 6577 6963 6b20 756e 6c65 7373 2061   newick unless a
-00019400: 2074 7265 6520 6861 7320 6120 7369 6e67   tree has a sing
-00019410: 6c65 2072 6f6f 742e 2054 7279 2022 0a20  le root. Try ". 
-00019420: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00019430: 2020 2022 5b74 2e61 735f 6e65 7769 636b     "[t.as_newick
-00019440: 2872 6f6f 7429 2066 6f72 2072 6f6f 7420  (root) for root 
-00019450: 696e 2074 2e72 6f6f 7473 5d20 746f 2067  in t.roots] to g
-00019460: 6574 2061 206c 6973 7420 6f66 2022 0a20  et a list of ". 
-00019470: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00019480: 2020 2022 6e65 7769 636b 2074 7265 6573     "newick trees
-00019490: 2c20 6f6e 6520 666f 7220 6561 6368 2072  , one for each r
-000194a0: 6f6f 742e 220a 2020 2020 2020 2020 2020  oot.".          
-000194b0: 2020 2020 2020 290a 2020 2020 2020 2020        ).        
-000194c0: 2020 2020 726f 6f74 203d 2073 656c 662e      root = self.
-000194d0: 726f 6f74 0a0a 2020 2020 2020 2020 6966  root..        if
-000194e0: 2070 7265 6369 7369 6f6e 2069 7320 4e6f   precision is No
-000194f0: 6e65 3a0a 2020 2020 2020 2020 2020 2020  ne:.            
-00019500: 2320 3137 2064 6563 696d 616c 2064 6967  # 17 decimal dig
-00019510: 6974 7320 7072 6f76 6964 6573 2074 6865  its provides the
-00019520: 2066 756c 6c20 7072 6563 6973 696f 6e20   full precision 
-00019530: 6f66 2061 6e20 4945 4545 2064 6f75 626c  of an IEEE doubl
-00019540: 652c 0a20 2020 2020 2020 2020 2020 2023  e,.            #
-00019550: 2061 7320 6465 6669 6e65 6420 6279 2044   as defined by D
-00019560: 424c 5f44 4543 494d 414c 5f44 4947 206d  BL_DECIMAL_DIG m
-00019570: 6163 726f 2e20 4966 2077 6520 6861 7665  acro. If we have
-00019580: 2064 6973 6372 6574 6520 7469 6d65 0a20   discrete time. 
-00019590: 2020 2020 2020 2020 2020 2023 2074 6865             # the
-000195a0: 6e20 7772 6974 6520 6f75 7420 696e 7465  n write out inte
-000195b0: 6765 7220 6272 616e 6368 206c 656e 6774  ger branch lengt
-000195c0: 6873 2e0a 2020 2020 2020 2020 2020 2020  hs..            
-000195d0: 7072 6563 6973 696f 6e20 3d20 3020 6966  precision = 0 if
-000195e0: 2073 656c 662e 7472 6565 5f73 6571 7565   self.tree_seque
-000195f0: 6e63 652e 6469 7363 7265 7465 5f74 696d  nce.discrete_tim
-00019600: 6520 656c 7365 2031 370a 2020 2020 2020  e else 17.      
-00019610: 2020 696e 636c 7564 655f 6272 616e 6368    include_branch
-00019620: 5f6c 656e 6774 6873 203d 2028 0a20 2020  _lengths = (.   
-00019630: 2020 2020 2020 2020 2054 7275 6520 6966           True if
-00019640: 2069 6e63 6c75 6465 5f62 7261 6e63 685f   include_branch_
-00019650: 6c65 6e67 7468 7320 6973 204e 6f6e 6520  lengths is None 
-00019660: 656c 7365 2069 6e63 6c75 6465 5f62 7261  else include_bra
-00019670: 6e63 685f 6c65 6e67 7468 730a 2020 2020  nch_lengths.    
-00019680: 2020 2020 290a 2020 2020 2020 2020 2320      ).        # 
-00019690: 4361 6e20 7765 2072 756e 2074 6869 7320  Can we run this 
-000196a0: 7468 726f 7567 6820 7468 6520 6661 7374  through the fast
-000196b0: 2070 6174 683f 0a20 2020 2020 2020 2069   path?.        i
-000196c0: 6620 696e 636c 7564 655f 6272 616e 6368  f include_branch
-000196d0: 5f6c 656e 6774 6873 2061 6e64 206e 6f64  _lengths and nod
-000196e0: 655f 6c61 6265 6c73 2069 6e20 5b4c 4547  e_labels in [LEG
-000196f0: 4143 595f 4d53 5f4c 4142 454c 532c 204e  ACY_MS_LABELS, N
-00019700: 6f6e 655d 3a0a 2020 2020 2020 2020 2020  one]:.          
-00019710: 2020 2320 4e6f 7465 2074 6865 204c 4547    # Note the LEG
-00019720: 4143 595f 4d53 5f4c 4142 454c 5320 636f  ACY_MS_LABELS co
-00019730: 6465 2070 6174 6820 6973 206e 6f74 2070  de path is not p
-00019740: 6172 7420 6f66 2074 6865 2064 6f63 756d  art of the docum
-00019750: 656e 7465 640a 2020 2020 2020 2020 2020  ented.          
-00019760: 2020 2320 696e 7465 7266 6163 6520 616e    # interface an
-00019770: 6420 7368 6f75 6c64 206e 6f74 2062 6520  d should not be 
-00019780: 6465 7065 6e64 6564 206f 6e20 6279 2063  depended on by c
-00019790: 6c69 656e 7420 636f 6465 2e0a 2020 2020  lient code..    
-000197a0: 2020 2020 2020 2020 7265 7475 726e 2073          return s
-000197b0: 656c 662e 5f61 735f 6e65 7769 636b 5f66  elf._as_newick_f
-000197c0: 6173 7428 0a20 2020 2020 2020 2020 2020  ast(.           
-000197d0: 2020 2020 2072 6f6f 743d 726f 6f74 2c0a       root=root,.
-000197e0: 2020 2020 2020 2020 2020 2020 2020 2020                  
-000197f0: 7072 6563 6973 696f 6e3d 7072 6563 6973  precision=precis
-00019800: 696f 6e2c 0a20 2020 2020 2020 2020 2020  ion,.           
-00019810: 2020 2020 206c 6567 6163 795f 6d73 5f6c       legacy_ms_l
-00019820: 6162 656c 733d 6e6f 6465 5f6c 6162 656c  abels=node_label
-00019830: 7320 3d3d 204c 4547 4143 595f 4d53 5f4c  s == LEGACY_MS_L
-00019840: 4142 454c 532c 0a20 2020 2020 2020 2020  ABELS,.         
-00019850: 2020 2029 0a0a 2020 2020 2020 2020 2320     )..        # 
-00019860: 4e6f 2c20 7765 2068 6176 6520 746f 2075  No, we have to u
-00019870: 7365 2074 6865 2073 6c6f 7765 7220 5079  se the slower Py
-00019880: 7468 6f6e 2063 6f64 652e 0a20 2020 2020  thon code..     
-00019890: 2020 2069 6620 6e6f 6465 5f6c 6162 656c     if node_label
-000198a0: 7320 6973 204e 6f6e 653a 0a20 2020 2020  s is None:.     
-000198b0: 2020 2020 2020 206e 6f64 655f 6c61 6265         node_labe
-000198c0: 6c73 203d 207b 753a 2066 226e 7b75 7d22  ls = {u: f"n{u}"
-000198d0: 2066 6f72 2075 2069 6e20 7365 6c66 2e74   for u in self.t
-000198e0: 7265 655f 7365 7175 656e 6365 2e73 616d  ree_sequence.sam
-000198f0: 706c 6573 2829 7d0a 2020 2020 2020 2020  ples()}.        
-00019900: 656c 6966 206e 6f64 655f 6c61 6265 6c73  elif node_labels
-00019910: 203d 3d20 4c45 4741 4359 5f4d 535f 4c41   == LEGACY_MS_LA
-00019920: 4245 4c53 3a0a 2020 2020 2020 2020 2020  BELS:.          
-00019930: 2020 2320 4e4f 5445 2069 6e20 7468 6520    # NOTE in the 
-00019940: 6d73 2066 6f72 6d61 7420 6974 2773 2074  ms format it's t
-00019950: 6865 202a 6c65 6166 2a20 6e6f 6465 7320  he *leaf* nodes 
-00019960: 7765 206c 6162 656c 206e 6f74 0a20 2020  we label not.   
-00019970: 2020 2020 2020 2020 2023 206e 6563 6573           # neces
-00019980: 7361 7269 6c79 2074 6865 2073 616d 706c  sarily the sampl
-00019990: 6573 2e20 5765 206b 6565 7020 7468 6973  es. We keep this
-000199a0: 2062 6568 6176 696f 7572 2074 6f20 6176   behaviour to av
-000199b0: 6f69 640a 2020 2020 2020 2020 2020 2020  oid.            
-000199c0: 2320 6272 6561 6b69 6e67 206c 6567 6163  # breaking legac
-000199d0: 7920 636f 6465 2074 6861 7420 6d61 7920  y code that may 
-000199e0: 6465 7065 6e64 206f 6e20 6974 2e0a 2020  depend on it..  
-000199f0: 2020 2020 2020 2020 2020 6e6f 6465 5f6c            node_l
-00019a00: 6162 656c 7320 3d20 7b75 3a20 6622 7b75  abels = {u: f"{u
-00019a10: 202b 2031 7d22 2066 6f72 2075 2069 6e20   + 1}" for u in 
-00019a20: 7365 6c66 2e6c 6561 7665 7328 297d 0a20  self.leaves()}. 
-00019a30: 2020 2020 2020 2072 6574 7572 6e20 7465         return te
-00019a40: 7874 5f66 6f72 6d61 7473 2e62 7569 6c64  xt_formats.build
-00019a50: 5f6e 6577 6963 6b28 0a20 2020 2020 2020  _newick(.       
-00019a60: 2020 2020 2073 656c 662c 0a20 2020 2020       self,.     
-00019a70: 2020 2020 2020 2072 6f6f 743d 726f 6f74         root=root
-00019a80: 2c0a 2020 2020 2020 2020 2020 2020 7072  ,.            pr
-00019a90: 6563 6973 696f 6e3d 7072 6563 6973 696f  ecision=precisio
-00019aa0: 6e2c 0a20 2020 2020 2020 2020 2020 206e  n,.            n
-00019ab0: 6f64 655f 6c61 6265 6c73 3d6e 6f64 655f  ode_labels=node_
-00019ac0: 6c61 6265 6c73 2c0a 2020 2020 2020 2020  labels,.        
-00019ad0: 2020 2020 696e 636c 7564 655f 6272 616e      include_bran
-00019ae0: 6368 5f6c 656e 6774 6873 3d69 6e63 6c75  ch_lengths=inclu
-00019af0: 6465 5f62 7261 6e63 685f 6c65 6e67 7468  de_branch_length
-00019b00: 732c 0a20 2020 2020 2020 2029 0a0a 2020  s,.        )..  
-00019b10: 2020 6465 6620 6e65 7769 636b 280a 2020    def newick(.  
-00019b20: 2020 2020 2020 7365 6c66 2c0a 2020 2020        self,.    
-00019b30: 2020 2020 7072 6563 6973 696f 6e3d 3134      precision=14
-00019b40: 2c0a 2020 2020 2020 2020 2a2c 0a20 2020  ,.        *,.   
-00019b50: 2020 2020 2072 6f6f 743d 4e6f 6e65 2c0a       root=None,.
-00019b60: 2020 2020 2020 2020 6e6f 6465 5f6c 6162          node_lab
-00019b70: 656c 733d 4e6f 6e65 2c0a 2020 2020 2020  els=None,.      
-00019b80: 2020 696e 636c 7564 655f 6272 616e 6368    include_branch
-00019b90: 5f6c 656e 6774 6873 3d54 7275 652c 0a20  _lengths=True,. 
-00019ba0: 2020 2029 3a0a 2020 2020 2020 2020 2222     ):.        ""
-00019bb0: 220a 2020 2020 2020 2020 2e2e 2077 6172  ".        .. war
-00019bc0: 6e69 6e67 3a3a 2054 6869 7320 6d65 7468  ning:: This meth
-00019bd0: 6f64 2069 7320 6465 7072 6563 6174 6564  od is deprecated
-00019be0: 2061 6e64 206d 6179 2062 6520 7265 6d6f   and may be remo
-00019bf0: 7665 6420 696e 2066 7574 7572 650a 2020  ved in future.  
-00019c00: 2020 2020 2020 2020 2020 7665 7273 696f            versio
-00019c10: 6e73 206f 6620 7473 6b69 742e 2050 6c65  ns of tskit. Ple
-00019c20: 6173 6520 7573 6520 7468 6520 3a6d 6574  ase use the :met
-00019c30: 683a 602e 6173 5f6e 6577 6963 6b60 206d  h:`.as_newick` m
-00019c40: 6574 686f 640a 2020 2020 2020 2020 2020  ethod.          
-00019c50: 2020 696e 206e 6577 2063 6f64 652e 0a0a    in new code...
-00019c60: 2020 2020 2020 2020 5468 6973 206d 6574          This met
-00019c70: 686f 6420 6973 2061 2064 6570 7265 6361  hod is a depreca
-00019c80: 7465 6420 7665 7273 696f 6e20 6f66 2074  ted version of t
-00019c90: 6865 203a 6d65 7468 3a60 2e61 735f 6e65  he :meth:`.as_ne
-00019ca0: 7769 636b 6020 6d65 7468 6f64 2e0a 2020  wick` method..  
-00019cb0: 2020 2020 2020 4675 6e63 7469 6f6e 616c        Functional
-00019cc0: 6974 7920 6973 2065 7175 6976 616c 656e  ity is equivalen
-00019cd0: 742c 2065 7863 6570 7420 666f 7220 7468  t, except for th
-00019ce0: 6520 6465 6661 756c 7420 6e6f 6465 206c  e default node l
-00019cf0: 6162 656c 732e 0a0a 2020 2020 2020 2020  abels...        
-00019d00: 4279 2064 6566 6175 6c74 2c20 2a6c 6561  By default, *lea
-00019d10: 662a 206e 6f64 6573 2061 7265 206c 6162  f* nodes are lab
-00019d20: 656c 6c65 6420 7769 7468 2074 6865 6972  elled with their
-00019d30: 206e 756d 6572 6963 616c 2049 4420 2b20   numerical ID + 
-00019d40: 312c 0a20 2020 2020 2020 2061 6e64 2069  1,.        and i
-00019d50: 6e74 6572 6e61 6c20 6e6f 6465 7320 6172  nternal nodes ar
-00019d60: 6520 6e6f 7420 6c61 6265 6c6c 6564 2e20  e not labelled. 
-00019d70: 5468 6973 2064 6566 6175 6c74 2073 7472  This default str
-00019d80: 6174 6567 7920 7761 7320 6f72 6967 696e  ategy was origin
-00019d90: 616c 6c79 0a20 2020 2020 2020 2075 7365  ally.        use
-00019da0: 6420 746f 206d 696d 6963 2074 6865 206f  d to mimic the o
-00019db0: 7574 7075 7420 6f66 2074 6865 2060 606d  utput of the ``m
-00019dc0: 7360 6020 7369 6d75 6c61 746f 722e 2048  s`` simulator. H
-00019dd0: 6f77 6576 6572 2c20 7468 6520 6368 6f69  owever, the choi
-00019de0: 6365 0a20 2020 2020 2020 206f 6620 6c61  ce.        of la
-00019df0: 6265 6c6c 696e 6720 6c65 6166 206e 6f64  belling leaf nod
-00019e00: 6573 2072 6174 6865 7220 7468 616e 2073  es rather than s
-00019e10: 616d 706c 6573 2069 7320 7072 6f62 6c65  amples is proble
-00019e20: 6d61 7469 632c 2061 6e64 2074 6869 730a  matic, and this.
-00019e30: 2020 2020 2020 2020 6265 6861 7669 6f75          behaviou
-00019e40: 7220 6973 206f 6e6c 7920 7265 7461 696e  r is only retain
-00019e50: 6564 2074 6f20 6176 6f69 6420 6272 6561  ed to avoid brea
-00019e60: 6b69 6e67 2065 7869 7374 696e 6720 636f  king existing co
-00019e70: 6465 2077 6869 6368 206d 6179 0a20 2020  de which may.   
-00019e80: 2020 2020 2072 656c 7920 6f6e 2069 742e       rely on it.
-00019e90: 0a0a 2020 2020 2020 2020 4f74 6865 7220  ..        Other 
-00019ea0: 7061 7261 6d65 7465 7273 2062 6568 6176  parameters behav
-00019eb0: 6520 6173 2064 6f63 756d 656e 7465 6420  e as documented 
-00019ec0: 696e 2074 6865 203a 6d65 7468 3a60 2e61  in the :meth:`.a
-00019ed0: 735f 6e65 7769 636b 6020 6d65 7468 6f64  s_newick` method
-00019ee0: 2e0a 0a20 2020 2020 2020 203a 7061 7261  ...        :para
-00019ef0: 6d20 696e 7420 7072 6563 6973 696f 6e3a  m int precision:
-00019f00: 2054 6865 206e 756d 6572 6963 616c 2070   The numerical p
-00019f10: 7265 6369 7369 6f6e 2077 6974 6820 7768  recision with wh
-00019f20: 6963 6820 6272 616e 6368 206c 656e 6774  ich branch lengt
-00019f30: 6873 2061 7265 0a20 2020 2020 2020 2020  hs are.         
-00019f40: 2020 2070 7269 6e74 6564 2e20 4465 6661     printed. Defa
-00019f50: 756c 7473 2074 6f20 3134 2e0a 2020 2020  ults to 14..    
-00019f60: 2020 2020 3a70 6172 616d 2069 6e74 2072      :param int r
-00019f70: 6f6f 743a 2049 6620 7370 6563 6966 6965  oot: If specifie
-00019f80: 642c 2072 6574 7572 6e20 7468 6520 7472  d, return the tr
-00019f90: 6565 2072 6f6f 7465 6420 6174 2074 6869  ee rooted at thi
-00019fa0: 7320 6e6f 6465 2e0a 2020 2020 2020 2020  s node..        
-00019fb0: 3a70 6172 616d 2064 6963 7420 6e6f 6465  :param dict node
-00019fc0: 5f6c 6162 656c 733a 2049 6620 7370 6563  _labels: If spec
-00019fd0: 6966 6965 642c 2073 686f 7720 6375 7374  ified, show cust
-00019fe0: 6f6d 206c 6162 656c 7320 666f 7220 7468  om labels for th
-00019ff0: 6520 6e6f 6465 730a 2020 2020 2020 2020  e nodes.        
-0001a000: 2020 2020 7468 6174 2061 7265 2070 7265      that are pre
-0001a010: 7365 6e74 2069 6e20 7468 6520 6d61 702e  sent in the map.
-0001a020: 2041 6e79 206e 6f64 6573 206e 6f74 2073   Any nodes not s
-0001a030: 7065 6369 6669 6564 2069 6e20 7468 6520  pecified in the 
-0001a040: 6d61 7020 7769 6c6c 0a20 2020 2020 2020  map will.       
-0001a050: 2020 2020 206e 6f74 2068 6176 6520 6120       not have a 
-0001a060: 6e6f 6465 206c 6162 656c 2e0a 2020 2020  node label..    
-0001a070: 2020 2020 3a70 6172 616d 2069 6e63 6c75      :param inclu
-0001a080: 6465 5f62 7261 6e63 685f 6c65 6e67 7468  de_branch_length
-0001a090: 733a 2049 6620 5472 7565 2028 6465 6661  s: If True (defa
-0001a0a0: 756c 7429 2c20 6f75 7470 7574 2062 7261  ult), output bra
-0001a0b0: 6e63 6820 6c65 6e67 7468 7320 696e 2074  nch lengths in t
-0001a0c0: 6865 0a20 2020 2020 2020 2020 2020 204e  he.            N
-0001a0d0: 6577 6963 6b20 7374 7269 6e67 2e20 4966  ewick string. If
-0001a0e0: 2046 616c 7365 2c20 6f6e 6c79 206f 7574   False, only out
-0001a0f0: 7075 7420 7468 6520 746f 706f 6c6f 6779  put the topology
-0001a100: 2c20 7769 7468 6f75 7420 6272 616e 6368  , without branch
-0001a110: 206c 656e 6774 6873 2e0a 2020 2020 2020   lengths..      
-0001a120: 2020 3a72 6574 7572 6e3a 2041 206e 6577    :return: A new
-0001a130: 6963 6b20 7265 7072 6573 656e 7461 7469  ick representati
-0001a140: 6f6e 206f 6620 7468 6973 2074 7265 652e  on of this tree.
-0001a150: 0a20 2020 2020 2020 203a 7274 7970 653a  .        :rtype:
-0001a160: 2073 7472 0a20 2020 2020 2020 2022 2222   str.        """
-0001a170: 0a20 2020 2020 2020 206e 6f64 655f 6c61  .        node_la
-0001a180: 6265 6c73 203d 204c 4547 4143 595f 4d53  bels = LEGACY_MS
-0001a190: 5f4c 4142 454c 5320 6966 206e 6f64 655f  _LABELS if node_
-0001a1a0: 6c61 6265 6c73 2069 7320 4e6f 6e65 2065  labels is None e
-0001a1b0: 6c73 6520 6e6f 6465 5f6c 6162 656c 730a  lse node_labels.
-0001a1c0: 2020 2020 2020 2020 7265 7475 726e 2073          return s
-0001a1d0: 656c 662e 6173 5f6e 6577 6963 6b28 0a20  elf.as_newick(. 
-0001a1e0: 2020 2020 2020 2020 2020 2072 6f6f 743d             root=
-0001a1f0: 726f 6f74 2c0a 2020 2020 2020 2020 2020  root,.          
-0001a200: 2020 7072 6563 6973 696f 6e3d 7072 6563    precision=prec
-0001a210: 6973 696f 6e2c 0a20 2020 2020 2020 2020  ision,.         
-0001a220: 2020 206e 6f64 655f 6c61 6265 6c73 3d6e     node_labels=n
-0001a230: 6f64 655f 6c61 6265 6c73 2c0a 2020 2020  ode_labels,.    
-0001a240: 2020 2020 2020 2020 696e 636c 7564 655f          include_
-0001a250: 6272 616e 6368 5f6c 656e 6774 6873 3d69  branch_lengths=i
-0001a260: 6e63 6c75 6465 5f62 7261 6e63 685f 6c65  nclude_branch_le
-0001a270: 6e67 7468 732c 0a20 2020 2020 2020 2029  ngths,.        )
-0001a280: 0a0a 2020 2020 6465 6620 6173 5f64 6963  ..    def as_dic
-0001a290: 745f 6f66 5f64 6963 7473 2873 656c 6629  t_of_dicts(self)
-0001a2a0: 3a0a 2020 2020 2020 2020 2222 220a 2020  :.        """.  
-0001a2b0: 2020 2020 2020 436f 6e76 6572 7420 7472        Convert tr
-0001a2c0: 6565 2074 6f20 6469 6374 206f 6620 6469  ee to dict of di
-0001a2d0: 6374 7320 666f 7220 636f 6e76 6572 7369  cts for conversi
-0001a2e0: 6f6e 2074 6f20 610a 2020 2020 2020 2020  on to a.        
-0001a2f0: 606e 6574 776f 726b 7820 6772 6170 6820  `networkx graph 
-0001a300: 3c68 7474 7073 3a2f 2f6e 6574 776f 726b  <https://network
-0001a310: 782e 6769 7468 7562 2e69 6f2f 646f 6375  x.github.io/docu
-0001a320: 6d65 6e74 6174 696f 6e2f 7374 6162 6c65  mentation/stable
-0001a330: 2f0a 2020 2020 2020 2020 7265 6665 7265  /.        refere
-0001a340: 6e63 652f 636c 6173 7365 732f 6469 6772  nce/classes/digr
-0001a350: 6170 682e 6874 6d6c 3e60 5f2e 0a0a 2020  aph.html>`_...  
-0001a360: 2020 2020 2020 466f 7220 6578 616d 706c        For exampl
-0001a370: 653a 3a0a 0a20 2020 2020 2020 2020 2020  e::..           
-0001a380: 203e 3e3e 2069 6d70 6f72 7420 6e65 7477   >>> import netw
-0001a390: 6f72 6b78 2061 7320 6e78 0a20 2020 2020  orkx as nx.     
-0001a3a0: 2020 2020 2020 203e 3e3e 206e 782e 4469         >>> nx.Di
-0001a3b0: 4772 6170 6828 7472 6565 2e61 735f 6469  Graph(tree.as_di
-0001a3c0: 6374 5f6f 665f 6469 6374 7328 2929 0a20  ct_of_dicts()). 
-0001a3d0: 2020 2020 2020 2020 2020 203e 3e3e 2023             >>> #
-0001a3e0: 2075 6e64 6972 6563 7465 6420 6772 6170   undirected grap
-0001a3f0: 6873 2077 6f72 6b20 6173 2077 656c 6c0a  hs work as well.
-0001a400: 2020 2020 2020 2020 2020 2020 3e3e 3e20              >>> 
-0001a410: 6e78 2e47 7261 7068 2874 7265 652e 6173  nx.Graph(tree.as
-0001a420: 5f64 6963 745f 6f66 5f64 6963 7473 2829  _dict_of_dicts()
-0001a430: 290a 0a20 2020 2020 2020 203a 7265 7475  )..        :retu
-0001a440: 726e 3a20 4469 6374 696f 6e61 7279 206f  rn: Dictionary o
-0001a450: 6620 6469 6374 696f 6e61 7269 6573 206f  f dictionaries o
-0001a460: 6620 6469 6374 696f 6e61 7269 6573 2077  f dictionaries w
-0001a470: 6865 7265 2074 6865 2066 6972 7374 206b  here the first k
-0001a480: 6579 0a20 2020 2020 2020 2020 2020 2069  ey.            i
-0001a490: 7320 7468 6520 736f 7572 6365 2c20 7468  s the source, th
-0001a4a0: 6520 7365 636f 6e64 206b 6579 2069 7320  e second key is 
-0001a4b0: 7468 6520 7461 7267 6574 206f 6620 616e  the target of an
-0001a4c0: 2065 6467 652c 2061 6e64 2074 6865 0a20   edge, and the. 
-0001a4d0: 2020 2020 2020 2020 2020 2074 6869 7264             third
-0001a4e0: 206b 6579 2069 7320 616e 2065 6467 6520   key is an edge 
-0001a4f0: 616e 6e6f 7461 7469 6f6e 2e20 4174 2074  annotation. At t
-0001a500: 6869 7320 706f 696e 7420 7468 6520 6f6e  his point the on
-0001a510: 6c79 2061 6e6e 6f74 6174 696f 6e0a 2020  ly annotation.  
-0001a520: 2020 2020 2020 2020 2020 6973 2022 6272            is "br
-0001a530: 616e 6368 5f6c 656e 6774 6822 2c20 7468  anch_length", th
-0001a540: 6520 6c65 6e67 7468 206f 6620 7468 6520  e length of the 
-0001a550: 6272 616e 6368 2028 696e 2075 6e69 7473  branch (in units
-0001a560: 206f 6620 7469 6d65 292e 0a20 2020 2020   of time)..     
-0001a570: 2020 2022 2222 0a20 2020 2020 2020 2064     """.        d
-0001a580: 6f64 203d 207b 7d0a 2020 2020 2020 2020  od = {}.        
-0001a590: 666f 7220 7061 7265 6e74 2069 6e20 7365  for parent in se
-0001a5a0: 6c66 2e6e 6f64 6573 2829 3a0a 2020 2020  lf.nodes():.    
-0001a5b0: 2020 2020 2020 2020 646f 645b 7061 7265          dod[pare
-0001a5c0: 6e74 5d20 3d20 7b7d 0a20 2020 2020 2020  nt] = {}.       
-0001a5d0: 2020 2020 2066 6f72 2063 6869 6c64 2069       for child i
-0001a5e0: 6e20 7365 6c66 2e63 6869 6c64 7265 6e28  n self.children(
-0001a5f0: 7061 7265 6e74 293a 0a20 2020 2020 2020  parent):.       
-0001a600: 2020 2020 2020 2020 2064 6f64 5b70 6172           dod[par
-0001a610: 656e 745d 5b63 6869 6c64 5d20 3d20 7b22  ent][child] = {"
-0001a620: 6272 616e 6368 5f6c 656e 6774 6822 3a20  branch_length": 
-0001a630: 7365 6c66 2e62 7261 6e63 685f 6c65 6e67  self.branch_leng
-0001a640: 7468 2863 6869 6c64 297d 0a20 2020 2020  th(child)}.     
-0001a650: 2020 2072 6574 7572 6e20 646f 640a 0a20     return dod.. 
-0001a660: 2020 2040 7072 6f70 6572 7479 0a20 2020     @property.   
-0001a670: 2064 6566 2070 6172 656e 745f 6469 6374   def parent_dict
-0001a680: 2873 656c 6629 3a0a 2020 2020 2020 2020  (self):.        
-0001a690: 7265 7475 726e 2073 656c 662e 6765 745f  return self.get_
-0001a6a0: 7061 7265 6e74 5f64 6963 7428 290a 0a20  parent_dict().. 
-0001a6b0: 2020 2064 6566 2067 6574 5f70 6172 656e     def get_paren
-0001a6c0: 745f 6469 6374 2873 656c 6629 3a0a 2020  t_dict(self):.  
-0001a6d0: 2020 2020 2020 7069 203d 207b 0a20 2020        pi = {.   
-0001a6e0: 2020 2020 2020 2020 2075 3a20 7365 6c66           u: self
-0001a6f0: 2e70 6172 656e 7428 7529 0a20 2020 2020  .parent(u).     
-0001a700: 2020 2020 2020 2066 6f72 2075 2069 6e20         for u in 
-0001a710: 7261 6e67 6528 7365 6c66 2e74 7265 655f  range(self.tree_
-0001a720: 7365 7175 656e 6365 2e6e 756d 5f6e 6f64  sequence.num_nod
-0001a730: 6573 290a 2020 2020 2020 2020 2020 2020  es).            
-0001a740: 6966 2073 656c 662e 7061 7265 6e74 2875  if self.parent(u
-0001a750: 2920 213d 204e 554c 4c0a 2020 2020 2020  ) != NULL.      
-0001a760: 2020 7d0a 2020 2020 2020 2020 7265 7475    }.        retu
-0001a770: 726e 2070 690a 0a20 2020 2064 6566 205f  rn pi..    def _
-0001a780: 5f73 7472 5f5f 2873 656c 6629 3a0a 2020  _str__(self):.  
-0001a790: 2020 2020 2020 2222 220a 2020 2020 2020        """.      
-0001a7a0: 2020 5265 7475 726e 2061 2070 6c61 696e    Return a plain
-0001a7b0: 2074 6578 7420 7375 6d6d 6172 7920 6f66   text summary of
-0001a7c0: 2061 2074 7265 6520 696e 2061 2074 7265   a tree in a tre
-0001a7d0: 6520 7365 7175 656e 6365 0a20 2020 2020  e sequence.     
-0001a7e0: 2020 2022 2222 0a20 2020 2020 2020 2074     """.        t
-0001a7f0: 7265 655f 726f 7773 203d 205b 0a20 2020  ree_rows = [.   
-0001a800: 2020 2020 2020 2020 205b 2249 6e64 6578           ["Index
-0001a810: 222c 2073 7472 2873 656c 662e 696e 6465  ", str(self.inde
-0001a820: 7829 5d2c 0a20 2020 2020 2020 2020 2020  x)],.           
-0001a830: 205b 0a20 2020 2020 2020 2020 2020 2020   [.             
-0001a840: 2020 2022 496e 7465 7276 616c 222c 0a20     "Interval",. 
-0001a850: 2020 2020 2020 2020 2020 2020 2020 2066                 f
-0001a860: 227b 7365 6c66 2e69 6e74 6572 7661 6c2e  "{self.interval.
-0001a870: 6c65 6674 3a2e 3867 7d2d 7b73 656c 662e  left:.8g}-{self.
-0001a880: 696e 7465 7276 616c 2e72 6967 6874 3a2e  interval.right:.
-0001a890: 3867 7d20 287b 7365 6c66 2e73 7061 6e3a  8g} ({self.span:
-0001a8a0: 2e38 677d 2922 2c0a 2020 2020 2020 2020  .8g})",.        
-0001a8b0: 2020 2020 5d2c 0a20 2020 2020 2020 2020      ],.         
-0001a8c0: 2020 205b 2252 6f6f 7473 222c 2073 7472     ["Roots", str
-0001a8d0: 2873 656c 662e 6e75 6d5f 726f 6f74 7329  (self.num_roots)
-0001a8e0: 5d2c 0a20 2020 2020 2020 2020 2020 205b  ],.            [
-0001a8f0: 224e 6f64 6573 222c 2073 7472 286c 656e  "Nodes", str(len
-0001a900: 2873 656c 662e 7072 656f 7264 6572 2829  (self.preorder()
-0001a910: 2929 5d2c 0a20 2020 2020 2020 2020 2020  ))],.           
-0001a920: 205b 2253 6974 6573 222c 2073 7472 2873   ["Sites", str(s
-0001a930: 656c 662e 6e75 6d5f 7369 7465 7329 5d2c  elf.num_sites)],
-0001a940: 0a20 2020 2020 2020 2020 2020 205b 224d  .            ["M
-0001a950: 7574 6174 696f 6e73 222c 2073 7472 2873  utations", str(s
-0001a960: 656c 662e 6e75 6d5f 6d75 7461 7469 6f6e  elf.num_mutation
-0001a970: 7329 5d2c 0a20 2020 2020 2020 2020 2020  s)],.           
-0001a980: 205b 2254 6f74 616c 2042 7261 6e63 6820   ["Total Branch 
-0001a990: 4c65 6e67 7468 222c 2066 227b 7365 6c66  Length", f"{self
-0001a9a0: 2e74 6f74 616c 5f62 7261 6e63 685f 6c65  .total_branch_le
-0001a9b0: 6e67 7468 3a2e 3867 7d22 5d2c 0a20 2020  ngth:.8g}"],.   
-0001a9c0: 2020 2020 205d 0a20 2020 2020 2020 2072       ].        r
-0001a9d0: 6574 7572 6e20 7574 696c 2e75 6e69 636f  eturn util.unico
-0001a9e0: 6465 5f74 6162 6c65 2874 7265 655f 726f  de_table(tree_ro
-0001a9f0: 7773 2c20 7469 746c 653d 2254 7265 6522  ws, title="Tree"
-0001aa00: 290a 0a20 2020 2064 6566 205f 7265 7072  )..    def _repr
-0001aa10: 5f68 746d 6c5f 2873 656c 6629 3a0a 2020  _html_(self):.  
-0001aa20: 2020 2020 2020 2222 220a 2020 2020 2020        """.      
-0001aa30: 2020 5265 7475 726e 2061 6e20 6874 6d6c    Return an html
-0001aa40: 2073 756d 6d61 7279 206f 6620 6120 7472   summary of a tr
-0001aa50: 6565 2069 6e20 6120 7472 6565 2073 6571  ee in a tree seq
-0001aa60: 7565 6e63 652e 2043 616c 6c65 6420 6279  uence. Called by
-0001aa70: 206a 7570 7974 6572 0a20 2020 2020 2020   jupyter.       
-0001aa80: 206e 6f74 6562 6f6f 6b73 2074 6f20 7265   notebooks to re
-0001aa90: 6e64 6572 2074 7265 6573 0a20 2020 2020  nder trees.     
-0001aaa0: 2020 2022 2222 0a20 2020 2020 2020 2072     """.        r
-0001aab0: 6574 7572 6e20 7574 696c 2e74 7265 655f  eturn util.tree_
-0001aac0: 6874 6d6c 2873 656c 6629 0a0a 2020 2020  html(self)..    
-0001aad0: 6465 6620 6d61 705f 6d75 7461 7469 6f6e  def map_mutation
-0001aae0: 7328 7365 6c66 2c20 6765 6e6f 7479 7065  s(self, genotype
-0001aaf0: 732c 2061 6c6c 656c 6573 2c20 616e 6365  s, alleles, ance
-0001ab00: 7374 7261 6c5f 7374 6174 653d 4e6f 6e65  stral_state=None
-0001ab10: 293a 0a20 2020 2020 2020 2022 2222 0a20  ):.        """. 
-0001ab20: 2020 2020 2020 2047 6976 656e 206f 6273         Given obs
-0001ab30: 6572 7661 7469 6f6e 7320 666f 7220 7468  ervations for th
-0001ab40: 6520 7361 6d70 6c65 7320 696e 2074 6869  e samples in thi
-0001ab50: 7320 7472 6565 2064 6573 6372 6962 6564  s tree described
-0001ab60: 2062 7920 7468 6520 7370 6563 6966 6965   by the specifie
-0001ab70: 640a 2020 2020 2020 2020 7365 7420 6f66  d.        set of
-0001ab80: 2067 656e 6f74 7970 6573 2061 6e64 2061   genotypes and a
-0001ab90: 6c6c 656c 6573 2c20 7265 7475 726e 2061  lleles, return a
-0001aba0: 2070 6172 7369 6d6f 6e69 6f75 7320 7365   parsimonious se
-0001abb0: 7420 6f66 2073 7461 7465 2074 7261 6e73  t of state trans
-0001abc0: 6974 696f 6e73 0a20 2020 2020 2020 2065  itions.        e
-0001abd0: 7870 6c61 696e 696e 6720 7468 6573 6520  xplaining these 
-0001abe0: 6f62 7365 7276 6174 696f 6e73 2e20 5468  observations. Th
-0001abf0: 6520 6765 6e6f 7479 7065 7320 6172 7261  e genotypes arra
-0001ac00: 7920 6973 2069 6e74 6572 7072 6574 6564  y is interpreted
-0001ac10: 2061 7320 696e 6465 7865 730a 2020 2020   as indexes.    
-0001ac20: 2020 2020 696e 746f 2074 6865 2061 6c6c      into the all
-0001ac30: 656c 6573 206c 6973 7420 696e 2074 6865  eles list in the
-0001ac40: 2073 616d 6520 6d61 6e6e 6572 2061 7320   same manner as 
-0001ac50: 6465 7363 7269 6265 6420 696e 2074 6865  described in the
-0001ac60: 0a20 2020 2020 2020 203a 6d65 7468 3a60  .        :meth:`
-0001ac70: 5472 6565 5365 7175 656e 6365 2e76 6172  TreeSequence.var
-0001ac80: 6961 6e74 7360 206d 6574 686f 642e 2054  iants` method. T
-0001ac90: 6875 732c 2069 6620 7361 6d70 6c65 2060  hus, if sample `
-0001aca0: 606a 6060 2063 6172 7269 6573 2074 6865  `j`` carries the
-0001acb0: 0a20 2020 2020 2020 2061 6c6c 656c 6520  .        allele 
-0001acc0: 6174 2069 6e64 6578 2060 606b 6060 2c20  at index ``k``, 
-0001acd0: 7468 656e 2077 6520 6861 7665 2060 6067  then we have ``g
-0001ace0: 656e 6f74 7970 6573 5b6a 5d20 3d20 6b60  enotypes[j] = k`
-0001acf0: 602e 0a20 2020 2020 2020 204d 6973 7369  `..        Missi
-0001ad00: 6e67 206f 6273 6572 7661 7469 6f6e 7320  ng observations 
-0001ad10: 6361 6e20 6265 2073 7065 6369 6669 6564  can be specified
-0001ad20: 2066 6f72 2061 2073 616d 706c 6520 7573   for a sample us
-0001ad30: 696e 6720 7468 6520 7661 6c75 650a 2020  ing the value.  
-0001ad40: 2020 2020 2020 6060 7473 6b69 742e 4d49        ``tskit.MI
-0001ad50: 5353 494e 475f 4441 5441 6060 2028 2d31  SSING_DATA`` (-1
-0001ad60: 292c 2069 6e20 7768 6963 6820 6361 7365  ), in which case
-0001ad70: 2074 6865 2073 7461 7465 2061 7420 7468   the state at th
-0001ad80: 6973 2073 616d 706c 6520 646f 6573 206e  is sample does n
-0001ad90: 6f74 0a20 2020 2020 2020 2069 6e66 6c75  ot.        influ
-0001ada0: 656e 6365 2074 6865 2061 6e63 6573 7472  ence the ancestr
-0001adb0: 616c 2073 7461 7465 206f 7220 7468 6520  al state or the 
-0001adc0: 706f 7369 7469 6f6e 206f 6620 6d75 7461  position of muta
-0001add0: 7469 6f6e 7320 7265 7475 726e 6564 2e20  tions returned. 
-0001ade0: 4174 206c 6561 7374 0a20 2020 2020 2020  At least.       
-0001adf0: 206f 6e65 206e 6f6e 2d6d 6973 7369 6e67   one non-missing
-0001ae00: 206f 6273 6572 7661 7469 6f6e 206d 7573   observation mus
-0001ae10: 7420 6265 2070 726f 7669 6465 642e 2041  t be provided. A
-0001ae20: 206d 6178 696d 756d 206f 6620 3634 2061   maximum of 64 a
-0001ae30: 6c6c 656c 6573 2061 7265 0a20 2020 2020  lleles are.     
-0001ae40: 2020 2073 7570 706f 7274 6564 2e0a 0a20     supported... 
-0001ae50: 2020 2020 2020 2054 6865 2063 7572 7265         The curre
-0001ae60: 6e74 2069 6d70 6c65 6d65 6e74 6174 696f  nt implementatio
-0001ae70: 6e20 7573 6573 2074 6865 2048 6172 7469  n uses the Harti
-0001ae80: 6761 6e20 7061 7273 696d 6f6e 7920 616c  gan parsimony al
-0001ae90: 676f 7269 7468 6d20 746f 2064 6574 6572  gorithm to deter
-0001aea0: 6d69 6e65 0a20 2020 2020 2020 2074 6865  mine.        the
-0001aeb0: 206d 696e 696d 756d 206e 756d 6265 7220   minimum number 
-0001aec0: 6f66 2073 7461 7465 2074 7261 6e73 6974  of state transit
-0001aed0: 696f 6e73 2072 6571 7569 7265 6420 746f  ions required to
-0001aee0: 2065 7870 6c61 696e 2074 6865 2064 6174   explain the dat
-0001aef0: 612e 2049 6e20 7468 6973 0a20 2020 2020  a. In this.     
-0001af00: 2020 206d 6f64 656c 2c20 7472 616e 7369     model, transi
-0001af10: 7469 6f6e 7320 6265 7477 6565 6e20 616e  tions between an
-0001af20: 7920 6f66 2074 6865 206e 6f6e 2d6d 6973  y of the non-mis
-0001af30: 7369 6e67 2073 7461 7465 7320 6973 2065  sing states is e
-0001af40: 7175 616c 6c79 206c 696b 656c 792e 0a0a  qually likely...
-0001af50: 2020 2020 2020 2020 5468 6520 7265 7475          The retu
-0001af60: 726e 6564 2076 616c 7565 7320 636f 7272  rned values corr
-0001af70: 6573 706f 6e64 2064 6972 6563 746c 7920  espond directly 
-0001af80: 746f 2074 6865 2064 6174 6120 6d6f 6465  to the data mode
-0001af90: 6c20 666f 7220 6465 7363 7269 6269 6e67  l for describing
-0001afa0: 0a20 2020 2020 2020 2076 6172 6961 7469  .        variati
-0001afb0: 6f6e 2061 7420 7369 7465 7320 7573 696e  on at sites usin
-0001afc0: 6720 6d75 7461 7469 6f6e 732e 2053 6565  g mutations. See
-0001afd0: 2074 6865 203a 7265 663a 6073 6563 5f73   the :ref:`sec_s
-0001afe0: 6974 655f 7461 626c 655f 6465 6669 6e69  ite_table_defini
-0001aff0: 7469 6f6e 600a 2020 2020 2020 2020 616e  tion`.        an
-0001b000: 6420 3a72 6566 3a60 7365 635f 6d75 7461  d :ref:`sec_muta
-0001b010: 7469 6f6e 5f74 6162 6c65 5f64 6566 696e  tion_table_defin
-0001b020: 6974 696f 6e60 2064 6566 696e 6974 696f  ition` definitio
-0001b030: 6e73 2066 6f72 2064 6574 6169 6c73 2061  ns for details a
-0001b040: 6e64 2062 6163 6b67 726f 756e 642e 0a0a  nd background...
-0001b050: 2020 2020 2020 2020 5468 6520 7374 6174          The stat
-0001b060: 6520 7265 636f 6e73 7472 7563 7469 6f6e  e reconstruction
-0001b070: 2069 7320 7265 7475 726e 6564 2061 7320   is returned as 
-0001b080: 7477 6f2d 7475 706c 652c 2060 6028 616e  two-tuple, ``(an
-0001b090: 6365 7374 7261 6c5f 7374 6174 652c 0a20  cestral_state,. 
-0001b0a0: 2020 2020 2020 206d 7574 6174 696f 6e73         mutations
-0001b0b0: 2960 602c 2077 6865 7265 2060 6061 6e63  )``, where ``anc
-0001b0c0: 6573 7472 616c 5f73 7461 7465 6060 2069  estral_state`` i
-0001b0d0: 7320 7468 6520 616c 6c65 6c65 2061 7373  s the allele ass
-0001b0e0: 6967 6e65 6420 746f 2074 6865 0a20 2020  igned to the.   
-0001b0f0: 2020 2020 2074 7265 6520 726f 6f74 2873       tree root(s
-0001b100: 2920 616e 6420 6060 6d75 7461 7469 6f6e  ) and ``mutation
-0001b110: 7360 6020 6973 2061 206c 6973 7420 6f66  s`` is a list of
-0001b120: 203a 636c 6173 733a 604d 7574 6174 696f   :class:`Mutatio
-0001b130: 6e60 206f 626a 6563 7473 2c0a 2020 2020  n` objects,.    
-0001b140: 2020 2020 6f72 6465 7265 6420 6173 203a      ordered as :
-0001b150: 7265 663a 6072 6571 7569 7265 6420 696e  ref:`required in
-0001b160: 2061 206d 7574 6174 696f 6e20 7461 626c   a mutation tabl
-0001b170: 653c 7365 635f 6d75 7461 7469 6f6e 5f72  e<sec_mutation_r
-0001b180: 6571 7569 7265 6d65 6e74 733e 602e 0a20  equirements>`.. 
-0001b190: 2020 2020 2020 2046 6f72 2065 6163 6820         For each 
-0001b1a0: 6d75 7461 7469 6f6e 2c20 6060 6465 7269  mutation, ``deri
-0001b1b0: 7665 645f 7374 6174 6560 6020 6973 2074  ved_state`` is t
-0001b1c0: 6865 206e 6577 2073 7461 7465 2061 6674  he new state aft
-0001b1d0: 6572 2074 6869 7320 6d75 7461 7469 6f6e  er this mutation
-0001b1e0: 2061 6e64 0a20 2020 2020 2020 2060 606e   and.        ``n
-0001b1f0: 6f64 6560 6020 6973 2074 6865 2074 7265  ode`` is the tre
-0001b200: 6520 6e6f 6465 2069 6d6d 6564 6961 7465  e node immediate
-0001b210: 6c79 2062 656e 6561 7468 2074 6865 206d  ly beneath the m
-0001b220: 7574 6174 696f 6e20 2869 6620 7468 6572  utation (if ther
-0001b230: 6520 6172 6520 756e 6172 790a 2020 2020  e are unary.    
-0001b240: 2020 2020 6e6f 6465 7320 6265 7477 6565      nodes betwee
-0001b250: 6e20 7477 6f20 6272 616e 6368 2070 6f69  n two branch poi
-0001b260: 6e74 732c 2068 656e 6365 206d 756c 7469  nts, hence multi
-0001b270: 706c 6520 6e6f 6465 7320 6162 6f76 6520  ple nodes above 
-0001b280: 7768 6963 6820 7468 650a 2020 2020 2020  which the.      
-0001b290: 2020 6d75 7461 7469 6f6e 2063 6f75 6c64    mutation could
-0001b2a0: 2062 6520 7061 7273 696d 6f6e 696f 7573   be parsimonious
-0001b2b0: 6c79 2070 6c61 6365 642c 2074 6865 206f  ly placed, the o
-0001b2c0: 6c64 6573 7420 6e6f 6465 2069 7320 7573  ldest node is us
-0001b2d0: 6564 292e 2054 6865 0a20 2020 2020 2020  ed). The.       
-0001b2e0: 2060 6070 6172 656e 7460 6020 7072 6f70   ``parent`` prop
-0001b2f0: 6572 7479 2063 6f6e 7461 696e 7320 7468  erty contains th
-0001b300: 6520 696e 6465 7820 696e 2074 6865 2072  e index in the r
-0001b310: 6574 7572 6e65 6420 6c69 7374 206f 6620  eturned list of 
-0001b320: 7468 6520 7072 6576 696f 7573 0a20 2020  the previous.   
-0001b330: 2020 2020 206d 7574 6174 696f 6e20 6f6e       mutation on
-0001b340: 2074 6865 2070 6174 6820 746f 2072 6f6f   the path to roo
-0001b350: 742c 206f 7220 6060 7473 6b69 742e 4e55  t, or ``tskit.NU
-0001b360: 4c4c 6060 0a20 2020 2020 2020 2069 6620  LL``.        if 
-0001b370: 7468 6572 6520 6172 6520 6e6f 2070 7265  there are no pre
-0001b380: 7669 6f75 7320 6d75 7461 7469 6f6e 7320  vious mutations 
-0001b390: 2873 6565 2074 6865 203a 7265 663a 6073  (see the :ref:`s
-0001b3a0: 6563 5f6d 7574 6174 696f 6e5f 7461 626c  ec_mutation_tabl
-0001b3b0: 655f 6465 6669 6e69 7469 6f6e 600a 2020  e_definition`.  
-0001b3c0: 2020 2020 2020 666f 7220 6d6f 7265 2069        for more i
-0001b3d0: 6e66 6f72 6d61 7469 6f6e 206f 6e20 7468  nformation on th
-0001b3e0: 6520 636f 6e63 6570 7420 6f66 206d 7574  e concept of mut
-0001b3f0: 6174 696f 6e20 7061 7265 6e74 7329 2e20  ation parents). 
-0001b400: 416c 6c20 6f74 6865 7220 6174 7472 6962  All other attrib
-0001b410: 7574 6573 0a20 2020 2020 2020 206f 6620  utes.        of 
-0001b420: 7468 6520 3a63 6c61 7373 3a60 4d75 7461  the :class:`Muta
-0001b430: 7469 6f6e 6020 6f62 6a65 6374 2061 7265  tion` object are
-0001b440: 2075 6e64 6566 696e 6564 2061 6e64 2073   undefined and s
-0001b450: 686f 756c 6420 6e6f 7420 6265 2075 7365  hould not be use
-0001b460: 642e 0a0a 2020 2020 2020 2020 2e2e 206e  d...        .. n
-0001b470: 6f74 653a 3a0a 2020 2020 2020 2020 2020  ote::.          
-0001b480: 2020 5361 6d70 6c65 2073 7461 7465 7320    Sample states 
-0001b490: 6f62 7365 7276 6564 2061 7320 6d69 7373  observed as miss
-0001b4a0: 696e 6720 696e 2074 6865 2069 6e70 7574  ing in the input
-0001b4b0: 2060 6067 656e 6f74 7970 6573 6060 206e   ``genotypes`` n
-0001b4c0: 6565 640a 2020 2020 2020 2020 2020 2020  eed.            
-0001b4d0: 6e6f 7420 636f 7272 6573 706f 6e64 2074  not correspond t
-0001b4e0: 6f20 7361 6d70 6c65 7320 7768 6f73 6520  o samples whose 
-0001b4f0: 6e6f 6465 7320 6172 6520 6163 7475 616c  nodes are actual
-0001b500: 6c79 2022 6d69 7373 696e 6722 2028 692e  ly "missing" (i.
-0001b510: 652e 2c0a 2020 2020 2020 2020 2020 2020  e.,.            
-0001b520: 3a72 6566 3a60 6973 6f6c 6174 6564 3c73  :ref:`isolated<s
-0001b530: 6563 5f64 6174 615f 6d6f 6465 6c5f 6d69  ec_data_model_mi
-0001b540: 7373 696e 675f 6461 7461 3e60 2920 696e  ssing_data>`) in
-0001b550: 2074 6865 2074 7265 652e 2049 6e20 7468   the tree. In th
-0001b560: 6973 0a20 2020 2020 2020 2020 2020 2063  is.            c
-0001b570: 6173 652c 206d 6170 7069 6e67 2074 6865  ase, mapping the
-0001b580: 206d 7574 6174 696f 6e73 2072 6574 7572   mutations retur
-0001b590: 6e65 6420 6279 2074 6869 7320 6d65 7468  ned by this meth
-0001b5a0: 6f64 206f 6e74 6f20 7468 6520 7472 6565  od onto the tree
-0001b5b0: 0a20 2020 2020 2020 2020 2020 2077 696c  .            wil
-0001b5c0: 6c20 7265 7375 6c74 2069 6e20 7468 6573  l result in thes
-0001b5d0: 6520 6d69 7373 696e 6720 6f62 7365 7276  e missing observ
-0001b5e0: 6174 696f 6e73 2062 6569 6e67 2069 6d70  ations being imp
-0001b5f0: 7574 6564 2074 6f20 7468 650a 2020 2020  uted to the.    
-0001b600: 2020 2020 2020 2020 6d6f 7374 2070 6172          most par
-0001b610: 7369 6d6f 6e69 6f75 7320 7374 6174 652e  simonious state.
-0001b620: 0a0a 2020 2020 2020 2020 4265 6361 7573  ..        Becaus
-0001b630: 6520 7468 6520 6060 7061 7265 6e74 6060  e the ``parent``
-0001b640: 2069 6e20 7468 6520 7265 7475 726e 6564   in the returned
-0001b650: 206c 6973 7420 6f66 206d 7574 6174 696f   list of mutatio
-0001b660: 6e73 2072 6566 6572 7320 746f 2074 6865  ns refers to the
-0001b670: 2069 6e64 6578 0a20 2020 2020 2020 2069   index.        i
-0001b680: 6e20 7468 6174 206c 6973 742c 2069 6620  n that list, if 
-0001b690: 796f 7520 6172 6520 6164 6469 6e67 206d  you are adding m
-0001b6a0: 7574 6174 696f 6e73 2074 6f20 616e 2065  utations to an e
-0001b6b0: 7869 7374 696e 6720 7472 6565 2073 6571  xisting tree seq
-0001b6c0: 7565 6e63 652c 2079 6f75 0a20 2020 2020  uence, you.     
-0001b6d0: 2020 2077 696c 6c20 6e65 6564 2074 6f20     will need to 
-0001b6e0: 6d61 696e 7461 696e 2061 206d 6170 206f  maintain a map o
-0001b6f0: 6620 6c69 7374 2049 4473 2074 6f20 7468  f list IDs to th
-0001b700: 6520 6e65 776c 7920 6164 6465 6420 6d75  e newly added mu
-0001b710: 7461 7469 6f6e 732c 2066 6f72 0a20 2020  tations, for.   
-0001b720: 2020 2020 2069 6e73 7461 6e63 653a 3a0a       instance::.
-0001b730: 0a20 2020 2020 2020 2020 2020 206c 6173  .            las
-0001b740: 745f 7472 6565 203d 2074 732e 6c61 7374  t_tree = ts.last
-0001b750: 2829 0a20 2020 2020 2020 2020 2020 2061  ().            a
-0001b760: 6e63 5f73 7461 7465 2c20 7061 7273 696d  nc_state, parsim
-0001b770: 6f6e 696f 7573 5f6d 7574 7320 3d20 6c61  onious_muts = la
-0001b780: 7374 5f74 7265 652e 6d61 705f 6d75 7461  st_tree.map_muta
-0001b790: 7469 6f6e 7328 5b30 2c20 312c 2030 5d2c  tions([0, 1, 0],
-0001b7a0: 2028 2241 222c 2022 5422 2929 0a20 2020   ("A", "T")).   
-0001b7b0: 2020 2020 2020 2020 2023 2045 6469 7420           # Edit 
-0001b7c0: 7468 6520 7472 6565 2073 6571 7565 6e63  the tree sequenc
-0001b7d0: 652c 2073 6565 2074 6865 2022 5461 626c  e, see the "Tabl
-0001b7e0: 6573 2061 6e64 2045 6469 7469 6e67 2220  es and Editing" 
-0001b7f0: 7475 746f 7269 616c 0a20 2020 2020 2020  tutorial.       
-0001b800: 2020 2020 2074 6162 6c65 7320 3d20 7473       tables = ts
-0001b810: 2e64 756d 705f 7461 626c 6573 2829 0a20  .dump_tables(). 
-0001b820: 2020 2020 2020 2020 2020 2023 2061 6464             # add
-0001b830: 2061 206e 6577 2073 6974 6520 6174 2074   a new site at t
-0001b840: 6865 2065 6e64 206f 6620 7473 2c20 6173  he end of ts, as
-0001b850: 7375 6d65 7320 7468 6572 6520 6973 6e27  sumes there isn'
-0001b860: 7420 6f6e 6520 7468 6572 6520 616c 7265  t one there alre
-0001b870: 6164 790a 2020 2020 2020 2020 2020 2020  ady.            
-0001b880: 7369 7465 5f69 6420 3d20 7461 626c 6573  site_id = tables
-0001b890: 2e73 6974 6573 2e61 6464 5f72 6f77 2874  .sites.add_row(t
-0001b8a0: 732e 7365 7175 656e 6365 5f6c 656e 6774  s.sequence_lengt
-0001b8b0: 6820 2d20 312c 2061 6e63 5f73 7461 7465  h - 1, anc_state
-0001b8c0: 290a 0a20 2020 2020 2020 2020 2020 206d  )..            m
-0001b8d0: 7574 5f69 645f 6d61 7020 3d20 7b74 736b  ut_id_map = {tsk
-0001b8e0: 6974 2e4e 554c 4c3a 2074 736b 6974 2e4e  it.NULL: tskit.N
-0001b8f0: 554c 4c7d 2020 2320 646f 6e27 7420 6368  ULL}  # don't ch
-0001b900: 616e 6765 2069 6620 7061 7265 6e74 2069  ange if parent i
-0001b910: 6420 6973 202d 310a 2020 2020 2020 2020  d is -1.        
-0001b920: 2020 2020 666f 7220 6c69 7374 5f69 642c      for list_id,
-0001b930: 206d 7574 6174 696f 6e20 696e 2065 6e75   mutation in enu
-0001b940: 6d65 7261 7465 2870 6172 7369 6d6f 6e69  merate(parsimoni
-0001b950: 6f75 735f 6d75 7473 293a 0a20 2020 2020  ous_muts):.     
-0001b960: 2020 2020 2020 2020 2020 206d 7574 5f69             mut_i
-0001b970: 645f 6d61 705b 6c69 7374 5f69 645d 203d  d_map[list_id] =
-0001b980: 2074 6162 6c65 732e 6d75 7461 7469 6f6e   tables.mutation
-0001b990: 732e 6170 7065 6e64 280a 2020 2020 2020  s.append(.      
-0001b9a0: 2020 2020 2020 2020 2020 2020 2020 6d75                mu
-0001b9b0: 7461 7469 6f6e 2e72 6570 6c61 6365 2873  tation.replace(s
-0001b9c0: 6974 653d 7369 7465 5f69 642c 2070 6172  ite=site_id, par
-0001b9d0: 656e 743d 6d75 745f 6964 5f6d 6170 5b6d  ent=mut_id_map[m
-0001b9e0: 7574 6174 696f 6e2e 7061 7265 6e74 5d29  utation.parent])
-0001b9f0: 290a 2020 2020 2020 2020 2020 2020 7461  ).            ta
-0001ba00: 626c 6573 2e73 6f72 7428 2920 2023 2052  bles.sort()  # R
-0001ba10: 6564 756e 6461 6e74 2068 6572 652c 2062  edundant here, b
-0001ba20: 7574 206e 6565 6465 6420 6966 2074 6865  ut needed if the
-0001ba30: 2073 6974 6520 6973 206e 6f74 2074 6865   site is not the
-0001ba40: 206c 6173 7420 6f6e 650a 2020 2020 2020   last one.      
-0001ba50: 2020 2020 2020 6e65 775f 7473 203d 2074        new_ts = t
-0001ba60: 6162 6c65 732e 7472 6565 5f73 6571 7565  ables.tree_seque
-0001ba70: 6e63 6528 290a 0a20 2020 2020 2020 2053  nce()..        S
-0001ba80: 6565 2074 6865 203a 7265 663a 6074 7574  ee the :ref:`tut
-0001ba90: 6f72 6961 6c73 3a73 6563 5f61 6e61 6c79  orials:sec_analy
-0001baa0: 7369 6e67 5f74 7265 6573 5f70 6172 7369  sing_trees_parsi
-0001bab0: 6d6f 6e79 6020 7365 6374 696f 6e20 696e  mony` section in
-0001bac0: 2074 6865 2074 7574 6f72 6961 6c0a 2020   the tutorial.  
-0001bad0: 2020 2020 2020 666f 7220 6675 7274 6865        for furthe
-0001bae0: 7220 6578 616d 706c 6573 206f 6620 686f  r examples of ho
-0001baf0: 7720 746f 2075 7365 2074 6869 7320 6d65  w to use this me
-0001bb00: 7468 6f64 2e0a 0a20 2020 2020 2020 203a  thod...        :
-0001bb10: 7061 7261 6d20 6172 7261 795f 6c69 6b65  param array_like
-0001bb20: 2067 656e 6f74 7970 6573 3a20 5468 6520   genotypes: The 
-0001bb30: 696e 7075 7420 6f62 7365 7276 6174 696f  input observatio
-0001bb40: 6e73 2066 6f72 2074 6865 2073 616d 706c  ns for the sampl
-0001bb50: 6573 2069 6e20 7468 6973 2074 7265 652e  es in this tree.
-0001bb60: 0a20 2020 2020 2020 203a 7061 7261 6d20  .        :param 
-0001bb70: 7475 706c 6528 7374 7229 2061 6c6c 656c  tuple(str) allel
-0001bb80: 6573 3a20 5468 6520 616c 6c65 6c65 7320  es: The alleles 
-0001bb90: 666f 7220 7468 6520 7370 6563 6966 6965  for the specifie
-0001bba0: 6420 6060 6765 6e6f 7479 7065 7360 602e  d ``genotypes``.
-0001bbb0: 2045 6163 680a 2020 2020 2020 2020 2020   Each.          
-0001bbc0: 2020 706f 7369 7469 7665 2076 616c 7565    positive value
-0001bbd0: 2069 6e20 7468 6520 6060 6765 6e6f 7479   in the ``genoty
-0001bbe0: 7065 7360 6020 6172 7261 7920 6973 2074  pes`` array is t
-0001bbf0: 7265 6174 6564 2061 7320 616e 2069 6e64  reated as an ind
-0001bc00: 6578 2069 6e74 6f20 7468 6973 0a20 2020  ex into this.   
-0001bc10: 2020 2020 2020 2020 206c 6973 7420 6f66           list of
-0001bc20: 2061 6c6c 656c 6573 2e0a 2020 2020 2020   alleles..      
-0001bc30: 2020 3a70 6172 616d 2061 6e63 6573 7472    :param ancestr
-0001bc40: 616c 5f73 7461 7465 3a20 4120 6669 7865  al_state: A fixe
-0001bc50: 6420 616e 6365 7374 7261 6c20 7374 6174  d ancestral stat
-0001bc60: 652c 2073 7065 6369 6669 6564 2065 6974  e, specified eit
-0001bc70: 6865 7220 6173 2061 0a20 2020 2020 2020  her as a.       
-0001bc80: 2020 2020 206e 6f6e 2d6e 6567 6174 6976       non-negativ
-0001bc90: 6520 696e 7465 6765 7220 6c65 7373 2074  e integer less t
-0001bca0: 6861 6e20 7468 6520 6e75 6d62 6572 206f  han the number o
-0001bcb0: 6620 616c 6c65 6c65 732c 206f 7220 6120  f alleles, or a 
-0001bcc0: 7374 7269 6e67 2077 6869 6368 0a20 2020  string which.   
-0001bcd0: 2020 2020 2020 2020 206d 7573 7420 6265           must be
-0001bce0: 206f 6e65 206f 6620 7468 6520 6060 616c   one of the ``al
-0001bcf0: 6c65 6c65 7360 6020 7072 6f76 6964 6564  leles`` provided
-0001bd00: 2061 626f 7665 2e20 4966 2060 604e 6f6e   above. If ``Non
-0001bd10: 6560 6020 2864 6566 6175 6c74 2920 7468  e`` (default) th
-0001bd20: 656e 0a20 2020 2020 2020 2020 2020 2061  en.            a
-0001bd30: 6e20 616e 6365 7374 7261 6c20 7374 6174  n ancestral stat
-0001bd40: 6520 6973 2063 686f 7365 6e20 6172 6269  e is chosen arbi
-0001bd50: 7472 6172 696c 7920 6672 6f6d 2061 6d6f  trarily from amo
-0001bd60: 6e67 2074 686f 7365 2074 6861 7420 7072  ng those that pr
-0001bd70: 6f76 6964 650a 2020 2020 2020 2020 2020  ovide.          
-0001bd80: 2020 7468 6520 6d6f 7374 2070 6172 7369    the most parsi
-0001bd90: 6d6f 6e69 6f75 7320 706c 6163 656d 656e  monious placemen
-0001bda0: 7420 6f66 206d 7574 6174 696f 6e73 2e20  t of mutations. 
-0001bdb0: 4e6f 7465 2074 6861 7420 6966 2074 6865  Note that if the
-0001bdc0: 2061 6e63 6573 7472 616c 0a20 2020 2020   ancestral.     
-0001bdd0: 2020 2020 2020 2073 7461 7465 2069 7320         state is 
-0001bde0: 7370 6563 6966 6965 642c 2074 6865 2070  specified, the p
-0001bdf0: 6c61 6365 6d65 6e74 206f 6620 6d75 7461  lacement of muta
-0001be00: 7469 6f6e 7320 6d61 7920 6e6f 7420 6265  tions may not be
-0001be10: 2061 7320 7061 7273 696d 6f6e 696f 7573   as parsimonious
-0001be20: 0a20 2020 2020 2020 2020 2020 2061 7320  .            as 
-0001be30: 7468 6174 2077 6869 6368 2063 6f75 6c64  that which could
-0001be40: 2062 6520 6163 6869 6576 6564 2062 7920   be achieved by 
-0001be50: 6c65 6176 696e 6720 7468 6520 616e 6365  leaving the ance
-0001be60: 7374 7261 6c20 7374 6174 6520 756e 7370  stral state unsp
-0001be70: 6563 6966 6965 643b 0a20 2020 2020 2020  ecified;.       
-0001be80: 2020 2020 2061 6464 6974 696f 6e61 6c6c       additionall
-0001be90: 7920 6974 206d 6179 206c 6561 6420 746f  y it may lead to
-0001bea0: 206d 7574 6174 696f 6e73 2062 6569 6e67   mutations being
-0001beb0: 2070 6c61 6365 6420 6162 6f76 6520 7468   placed above th
-0001bec0: 6520 726f 6f74 206e 6f64 6528 7329 206f  e root node(s) o
-0001bed0: 660a 2020 2020 2020 2020 2020 2020 7468  f.            th
-0001bee0: 6520 7472 6565 2028 666f 7220 6578 616d  e tree (for exam
-0001bef0: 706c 6520 6966 2061 6c6c 2074 6865 2073  ple if all the s
-0001bf00: 616d 706c 6573 2068 6176 6520 6120 6765  amples have a ge
-0001bf10: 6e6f 7479 7065 206f 6620 3120 6275 7420  notype of 1 but 
-0001bf20: 7468 650a 2020 2020 2020 2020 2020 2020  the.            
-0001bf30: 616e 6365 7374 7261 6c20 7374 6174 6520  ancestral state 
-0001bf40: 6973 2066 6978 6564 2074 6f20 6265 2030  is fixed to be 0
-0001bf50: 292e 0a20 2020 2020 2020 203a 7479 7065  )..        :type
-0001bf60: 2061 6e63 6573 7472 616c 5f73 7461 7465   ancestral_state
-0001bf70: 3a20 556e 696f 6e5b 696e 742c 2073 7472  : Union[int, str
-0001bf80: 5d0a 2020 2020 2020 2020 3a72 6574 7572  ].        :retur
-0001bf90: 6e3a 2054 6865 2069 6e66 6572 7265 6420  n: The inferred 
-0001bfa0: 616e 6365 7374 7261 6c20 7374 6174 6520  ancestral state 
-0001bfb0: 616e 6420 6c69 7374 206f 6620 6d75 7461  and list of muta
-0001bfc0: 7469 6f6e 7320 6f6e 2074 6869 7320 7472  tions on this tr
-0001bfd0: 6565 0a20 2020 2020 2020 2020 2020 2074  ee.            t
-0001bfe0: 6861 7420 656e 636f 6465 2074 6865 2073  hat encode the s
-0001bff0: 7065 6369 6669 6564 206f 6273 6572 7661  pecified observa
-0001c000: 7469 6f6e 732e 0a20 2020 2020 2020 203a  tions..        :
-0001c010: 7274 7970 653a 2028 7374 722c 206c 6973  rtype: (str, lis
-0001c020: 7428 7473 6b69 742e 4d75 7461 7469 6f6e  t(tskit.Mutation
-0001c030: 2929 0a20 2020 2020 2020 2022 2222 0a20  )).        """. 
-0001c040: 2020 2020 2020 2067 656e 6f74 7970 6573         genotypes
-0001c050: 203d 2075 7469 6c2e 7361 6665 5f6e 705f   = util.safe_np_
-0001c060: 696e 745f 6361 7374 2867 656e 6f74 7970  int_cast(genotyp
-0001c070: 6573 2c20 6e70 2e69 6e74 3829 0a20 2020  es, np.int8).   
-0001c080: 2020 2020 206d 6178 5f61 6c6c 656c 6573       max_alleles
-0001c090: 203d 206e 702e 6d61 7828 6765 6e6f 7479   = np.max(genoty
-0001c0a0: 7065 7329 0a20 2020 2020 2020 2069 6620  pes).        if 
-0001c0b0: 616e 6365 7374 7261 6c5f 7374 6174 6520  ancestral_state 
-0001c0c0: 6973 206e 6f74 204e 6f6e 653a 0a20 2020  is not None:.   
-0001c0d0: 2020 2020 2020 2020 2069 6620 6973 696e           if isin
-0001c0e0: 7374 616e 6365 2861 6e63 6573 7472 616c  stance(ancestral
-0001c0f0: 5f73 7461 7465 2c20 7374 7229 3a0a 2020  _state, str):.  
-0001c100: 2020 2020 2020 2020 2020 2020 2020 2320                # 
-0001c110: 5769 6c6c 2072 6169 7365 2061 2056 616c  Will raise a Val
-0001c120: 7565 4572 726f 7220 6966 206e 6f74 2069  ueError if not i
-0001c130: 6e20 7468 6520 6c69 7374 0a20 2020 2020  n the list.     
-0001c140: 2020 2020 2020 2020 2020 2061 6e63 6573             ances
-0001c150: 7472 616c 5f73 7461 7465 203d 2061 6c6c  tral_state = all
-0001c160: 656c 6573 2e69 6e64 6578 2861 6e63 6573  eles.index(ances
-0001c170: 7472 616c 5f73 7461 7465 290a 2020 2020  tral_state).    
-0001c180: 2020 2020 2020 2020 6966 2061 6e63 6573          if ances
-0001c190: 7472 616c 5f73 7461 7465 203c 2030 206f  tral_state < 0 o
-0001c1a0: 7220 616e 6365 7374 7261 6c5f 7374 6174  r ancestral_stat
-0001c1b0: 6520 3e3d 206c 656e 2861 6c6c 656c 6573  e >= len(alleles
-0001c1c0: 293a 0a20 2020 2020 2020 2020 2020 2020  ):.             
-0001c1d0: 2020 2072 6169 7365 2056 616c 7565 4572     raise ValueEr
-0001c1e0: 726f 7228 2261 6e63 6573 7472 616c 5f73  ror("ancestral_s
-0001c1f0: 7461 7465 206e 6f74 2062 6574 7765 656e  tate not between
-0001c200: 2030 2061 6e64 2028 6e75 6d5f 616c 6c65   0 and (num_alle
-0001c210: 6c65 732d 3129 2229 0a20 2020 2020 2020  les-1)").       
-0001c220: 2020 2020 206d 6178 5f61 6c6c 656c 6573       max_alleles
-0001c230: 203d 206d 6178 2861 6e63 6573 7472 616c   = max(ancestral
-0001c240: 5f73 7461 7465 2c20 6d61 785f 616c 6c65  _state, max_alle
-0001c250: 6c65 7329 0a20 2020 2020 2020 2069 6620  les).        if 
-0001c260: 6d61 785f 616c 6c65 6c65 7320 3e3d 2036  max_alleles >= 6
-0001c270: 343a 0a20 2020 2020 2020 2020 2020 2072  4:.            r
-0001c280: 6169 7365 2056 616c 7565 4572 726f 7228  aise ValueError(
-0001c290: 2241 206d 6178 696d 756d 206f 6620 3634  "A maximum of 64
-0001c2a0: 2073 7461 7465 7320 6973 2073 7570 706f   states is suppo
-0001c2b0: 7274 6564 2229 0a20 2020 2020 2020 2061  rted").        a
-0001c2c0: 6e63 6573 7472 616c 5f73 7461 7465 2c20  ncestral_state, 
-0001c2d0: 7472 616e 7369 7469 6f6e 7320 3d20 7365  transitions = se
-0001c2e0: 6c66 2e5f 6c6c 5f74 7265 652e 6d61 705f  lf._ll_tree.map_
-0001c2f0: 6d75 7461 7469 6f6e 7328 0a20 2020 2020  mutations(.     
-0001c300: 2020 2020 2020 2067 656e 6f74 7970 6573         genotypes
-0001c310: 2c20 616e 6365 7374 7261 6c5f 7374 6174  , ancestral_stat
-0001c320: 650a 2020 2020 2020 2020 290a 2020 2020  e.        ).    
-0001c330: 2020 2020 2320 5472 616e 736c 6174 6520      # Translate 
-0001c340: 6261 636b 2069 6e74 6f20 7374 7269 6e67  back into string
-0001c350: 2061 6c6c 656c 6573 0a20 2020 2020 2020   alleles.       
-0001c360: 2061 6e63 6573 7472 616c 5f73 7461 7465   ancestral_state
-0001c370: 203d 2061 6c6c 656c 6573 5b61 6e63 6573   = alleles[ances
-0001c380: 7472 616c 5f73 7461 7465 5d0a 2020 2020  tral_state].    
-0001c390: 2020 2020 6d75 7461 7469 6f6e 7320 3d20      mutations = 
-0001c3a0: 5b0a 2020 2020 2020 2020 2020 2020 4d75  [.            Mu
-0001c3b0: 7461 7469 6f6e 280a 2020 2020 2020 2020  tation(.        
-0001c3c0: 2020 2020 2020 2020 6e6f 6465 3d6e 6f64          node=nod
-0001c3d0: 652c 0a20 2020 2020 2020 2020 2020 2020  e,.             
-0001c3e0: 2020 2064 6572 6976 6564 5f73 7461 7465     derived_state
-0001c3f0: 3d61 6c6c 656c 6573 5b64 6572 6976 6564  =alleles[derived
-0001c400: 5f73 7461 7465 5d2c 0a20 2020 2020 2020  _state],.       
-0001c410: 2020 2020 2020 2020 2070 6172 656e 743d           parent=
-0001c420: 7061 7265 6e74 2c0a 2020 2020 2020 2020  parent,.        
-0001c430: 2020 2020 2020 2020 6d65 7461 6461 7461          metadata
-0001c440: 3d73 656c 662e 7472 6565 5f73 6571 7565  =self.tree_seque
-0001c450: 6e63 652e 7461 626c 655f 6d65 7461 6461  nce.table_metada
-0001c460: 7461 5f73 6368 656d 6173 2e6d 7574 6174  ta_schemas.mutat
-0001c470: 696f 6e2e 656d 7074 795f 7661 6c75 652c  ion.empty_value,
-0001c480: 0a20 2020 2020 2020 2020 2020 2029 0a20  .            ). 
-0001c490: 2020 2020 2020 2020 2020 2066 6f72 206e             for n
-0001c4a0: 6f64 652c 2070 6172 656e 742c 2064 6572  ode, parent, der
-0001c4b0: 6976 6564 5f73 7461 7465 2069 6e20 7472  ived_state in tr
-0001c4c0: 616e 7369 7469 6f6e 730a 2020 2020 2020  ansitions.      
-0001c4d0: 2020 5d0a 2020 2020 2020 2020 7265 7475    ].        retu
-0001c4e0: 726e 2061 6e63 6573 7472 616c 5f73 7461  rn ancestral_sta
-0001c4f0: 7465 2c20 6d75 7461 7469 6f6e 730a 0a20  te, mutations.. 
-0001c500: 2020 2064 6566 206b 635f 6469 7374 616e     def kc_distan
-0001c510: 6365 2873 656c 662c 206f 7468 6572 2c20  ce(self, other, 
-0001c520: 6c61 6d62 6461 5f3d 302e 3029 3a0a 2020  lambda_=0.0):.  
-0001c530: 2020 2020 2020 2222 220a 2020 2020 2020        """.      
-0001c540: 2020 5265 7475 726e 7320 7468 6520 4b65    Returns the Ke
-0001c550: 6e64 616c 6c2d 436f 6c69 6a6e 2064 6973  ndall-Colijn dis
-0001c560: 7461 6e63 6520 6265 7477 6565 6e20 7468  tance between th
-0001c570: 6520 7370 6563 6966 6965 6420 7061 6972  e specified pair
-0001c580: 206f 6620 7472 6565 732e 0a20 2020 2020   of trees..     
-0001c590: 2020 2054 6865 2060 606c 616d 6264 615f     The ``lambda_
-0001c5a0: 6060 2070 6172 616d 6574 6572 2020 6465  `` parameter  de
-0001c5b0: 7465 726d 696e 6573 2074 6865 2072 656c  termines the rel
-0001c5c0: 6174 6976 6520 7765 6967 6874 206f 6620  ative weight of 
-0001c5d0: 746f 706f 6c6f 6779 0a20 2020 2020 2020  topology.       
-0001c5e0: 2076 7320 6272 616e 6368 206c 656e 6774   vs branch lengt
-0001c5f0: 6873 2069 6e20 6361 6c63 756c 6174 696e  hs in calculatin
-0001c600: 6720 7468 6520 6469 7374 616e 6365 2e20  g the distance. 
-0001c610: 4966 2060 606c 616d 6264 615f 6060 2069  If ``lambda_`` i
-0001c620: 7320 300a 2020 2020 2020 2020 2874 6865  s 0.        (the
-0001c630: 2064 6566 6175 6c74 2920 7765 206f 6e6c   default) we onl
-0001c640: 7920 636f 6e73 6964 6572 2074 6f70 6f6c  y consider topol
-0001c650: 6f67 792c 2061 6e64 2069 6620 6974 2069  ogy, and if it i
-0001c660: 7320 3120 7765 206f 6e6c 790a 2020 2020  s 1 we only.    
-0001c670: 2020 2020 636f 6e73 6964 6572 2062 7261      consider bra
-0001c680: 6e63 6820 6c65 6e67 7468 732e 2053 6565  nch lengths. See
-0001c690: 2060 4b65 6e64 616c 6c20 2620 436f 6c69   `Kendall & Coli
-0001c6a0: 6a6e 2028 3230 3136 290a 2020 2020 2020  jn (2016).      
-0001c6b0: 2020 3c68 7474 7073 3a2f 2f61 6361 6465    <https://acade
-0001c6c0: 6d69 632e 6f75 702e 636f 6d2f 6d62 652f  mic.oup.com/mbe/
-0001c6d0: 6172 7469 636c 652f 3333 2f31 302f 3237  article/33/10/27
-0001c6e0: 3335 2f32 3932 3535 3438 3e60 5f20 666f  35/2925548>`_ fo
-0001c6f0: 7220 6465 7461 696c 732e 0a0a 2020 2020  r details...    
-0001c700: 2020 2020 5468 6520 7472 6565 7320 7765      The trees we
-0001c710: 2061 7265 2063 6f6d 7061 7269 6e67 2074   are comparing t
-0001c720: 6f20 6d75 7374 2068 6176 6520 6964 656e  o must have iden
-0001c730: 7469 6361 6c20 6c69 7374 7320 6f66 2073  tical lists of s
-0001c740: 616d 706c 650a 2020 2020 2020 2020 6e6f  ample.        no
-0001c750: 6465 7320 2869 2e65 2e2c 2074 6865 2073  des (i.e., the s
-0001c760: 616d 6520 4944 7320 696e 2074 6865 2073  ame IDs in the s
-0001c770: 616d 6520 6f72 6465 7229 2e20 5468 6520  ame order). The 
-0001c780: 6d65 7472 6963 206f 7065 7261 7465 7320  metric operates 
-0001c790: 6f6e 0a20 2020 2020 2020 2073 616d 706c  on.        sampl
-0001c7a0: 6573 2c20 6e6f 7420 6c65 6176 6573 2c20  es, not leaves, 
-0001c7b0: 736f 2069 6e74 6572 6e61 6c20 7361 6d70  so internal samp
-0001c7c0: 6c65 7320 6172 6520 7472 6561 7465 6420  les are treated 
-0001c7d0: 6964 656e 7469 6361 6c6c 7920 746f 0a20  identically to. 
-0001c7e0: 2020 2020 2020 2073 616d 706c 6520 7469         sample ti
-0001c7f0: 7073 2e20 5375 6274 7265 6573 2077 6974  ps. Subtrees wit
-0001c800: 6820 6e6f 2073 616d 706c 6573 2064 6f20  h no samples do 
-0001c810: 6e6f 7420 636f 6e74 7269 6275 7465 2074  not contribute t
-0001c820: 6f20 7468 6520 6d65 7472 6963 2e0a 0a20  o the metric... 
-0001c830: 2020 2020 2020 203a 7061 7261 6d20 5472         :param Tr
-0001c840: 6565 206f 7468 6572 3a20 5468 6520 6f74  ee other: The ot
-0001c850: 6865 7220 7472 6565 2074 6f20 636f 6d70  her tree to comp
-0001c860: 6172 6520 746f 2e0a 2020 2020 2020 2020  are to..        
-0001c870: 3a70 6172 616d 2066 6c6f 6174 206c 616d  :param float lam
-0001c880: 6264 615f 3a20 5468 6520 4b43 206d 6574  bda_: The KC met
-0001c890: 7269 6320 6c61 6d62 6461 2070 6172 616d  ric lambda param
-0001c8a0: 6574 6572 2064 6574 6572 6d69 6e69 6e67  eter determining
-0001c8b0: 2074 6865 0a20 2020 2020 2020 2020 2020   the.           
-0001c8c0: 2072 656c 6174 6976 6520 7765 6967 6874   relative weight
-0001c8d0: 206f 6620 746f 706f 6c6f 6779 2061 6e64   of topology and
-0001c8e0: 2062 7261 6e63 6820 6c65 6e67 7468 2e0a   branch length..
-0001c8f0: 2020 2020 2020 2020 3a72 6574 7572 6e3a          :return:
-0001c900: 2054 6865 2063 6f6d 7075 7465 6420 4b43   The computed KC
-0001c910: 2064 6973 7461 6e63 6520 6265 7477 6565   distance betwee
-0001c920: 6e20 7468 6973 2074 7265 6520 616e 6420  n this tree and 
-0001c930: 6f74 6865 722e 0a20 2020 2020 2020 203a  other..        :
-0001c940: 7274 7970 653a 2066 6c6f 6174 0a20 2020  rtype: float.   
-0001c950: 2020 2020 2022 2222 0a20 2020 2020 2020       """.       
-0001c960: 2072 6574 7572 6e20 7365 6c66 2e5f 6c6c   return self._ll
-0001c970: 5f74 7265 652e 6765 745f 6b63 5f64 6973  _tree.get_kc_dis
-0001c980: 7461 6e63 6528 6f74 6865 722e 5f6c 6c5f  tance(other._ll_
-0001c990: 7472 6565 2c20 6c61 6d62 6461 5f29 0a0a  tree, lambda_)..
-0001c9a0: 2020 2020 6465 6620 7061 7468 5f6c 656e      def path_len
-0001c9b0: 6774 6828 7365 6c66 2c20 752c 2076 293a  gth(self, u, v):
-0001c9c0: 0a20 2020 2020 2020 2022 2222 0a20 2020  .        """.   
-0001c9d0: 2020 2020 2052 6574 7572 6e73 2074 6865       Returns the
-0001c9e0: 2070 6174 6820 6c65 6e67 7468 2062 6574   path length bet
-0001c9f0: 7765 656e 2074 776f 206e 6f64 6573 0a20  ween two nodes. 
-0001ca00: 2020 2020 2020 2028 692e 652e 2c20 7468         (i.e., th
-0001ca10: 6520 6e75 6d62 6572 206f 6620 6564 6765  e number of edge
-0001ca20: 7320 6265 7477 6565 6e20 7477 6f20 6e6f  s between two no
-0001ca30: 6465 7320 696e 2074 6869 7320 7472 6565  des in this tree
-0001ca40: 292e 0a20 2020 2020 2020 2049 6620 7468  )..        If th
-0001ca50: 6520 7477 6f20 6e6f 6465 7320 6861 7665  e two nodes have
-0001ca60: 2061 206d 6f73 7420 7265 6365 6e74 2063   a most recent c
-0001ca70: 6f6d 6d6f 6e20 616e 6365 7374 6f72 2c20  ommon ancestor, 
-0001ca80: 7468 656e 2074 6869 7320 6973 2064 6566  then this is def
-0001ca90: 696e 6564 2061 730a 2020 2020 2020 2020  ined as.        
-0001caa0: 6060 7472 6565 2e64 6570 7468 2875 2920  ``tree.depth(u) 
-0001cab0: 2b20 7472 6565 2e64 6570 7468 2876 2920  + tree.depth(v) 
-0001cac0: 2d20 3220 2a20 7472 6565 2e64 6570 7468  - 2 * tree.depth
-0001cad0: 2874 7265 652e 6d72 6361 2875 2c20 7629  (tree.mrca(u, v)
-0001cae0: 2960 602e 2049 6620 7468 6520 6e6f 6465  )``. If the node
-0001caf0: 730a 2020 2020 2020 2020 646f 206e 6f74  s.        do not
-0001cb00: 2068 6176 6520 616e 204d 5243 4120 2869   have an MRCA (i
-0001cb10: 2e65 2e2c 2074 6865 7920 6172 6520 696e  .e., they are in
-0001cb20: 2064 6973 636f 6e6e 6563 7465 6420 7375   disconnected su
-0001cb30: 6274 7265 6573 2920 7468 6520 7061 7468  btrees) the path
-0001cb40: 206c 656e 6774 680a 2020 2020 2020 2020   length.        
-0001cb50: 6973 2069 6e66 696e 6974 792e 0a0a 2020  is infinity...  
-0001cb60: 2020 2020 2020 2e2e 2073 6565 616c 736f        .. seealso
-0001cb70: 3a3a 2053 6565 2061 6c73 6f20 7468 6520  :: See also the 
-0001cb80: 3a6d 6574 683a 602e 6465 7074 6860 206d  :meth:`.depth` m
-0001cb90: 6574 686f 640a 0a20 2020 2020 2020 203a  ethod..        :
-0001cba0: 7061 7261 6d20 696e 7420 753a 2054 6865  param int u: The
-0001cbb0: 2066 6972 7374 206e 6f64 6520 666f 7220   first node for 
-0001cbc0: 7061 7468 206c 656e 6774 6820 636f 6d70  path length comp
-0001cbd0: 7574 6174 696f 6e2e 0a20 2020 2020 2020  utation..       
-0001cbe0: 203a 7061 7261 6d20 696e 7420 763a 2054   :param int v: T
-0001cbf0: 6865 2073 6563 6f6e 6420 6e6f 6465 2066  he second node f
-0001cc00: 6f72 2070 6174 6820 6c65 6e67 7468 2063  or path length c
-0001cc10: 6f6d 7075 7461 7469 6f6e 2e0a 2020 2020  omputation..    
-0001cc20: 2020 2020 3a72 6574 7572 6e3a 2054 6865      :return: The
-0001cc30: 206e 756d 6265 7220 6f66 2065 6467 6573   number of edges
-0001cc40: 2062 6574 7765 656e 2074 6865 2074 776f   between the two
-0001cc50: 206e 6f64 6573 2e0a 2020 2020 2020 2020   nodes..        
-0001cc60: 3a72 7479 7065 3a20 696e 740a 2020 2020  :rtype: int.    
-0001cc70: 2020 2020 2222 220a 2020 2020 2020 2020      """.        
-0001cc80: 6d72 6361 203d 2073 656c 662e 6d72 6361  mrca = self.mrca
-0001cc90: 2875 2c20 7629 0a20 2020 2020 2020 2069  (u, v).        i
-0001cca0: 6620 6d72 6361 203d 3d20 2d31 3a0a 2020  f mrca == -1:.  
-0001ccb0: 2020 2020 2020 2020 2020 7265 7475 726e            return
-0001ccc0: 206d 6174 682e 696e 660a 2020 2020 2020   math.inf.      
-0001ccd0: 2020 7265 7475 726e 2073 656c 662e 6465    return self.de
-0001cce0: 7074 6828 7529 202b 2073 656c 662e 6465  pth(u) + self.de
-0001ccf0: 7074 6828 7629 202d 2032 202a 2073 656c  pth(v) - 2 * sel
-0001cd00: 662e 6465 7074 6828 6d72 6361 290a 0a20  f.depth(mrca).. 
-0001cd10: 2020 2064 6566 2062 315f 696e 6465 7828     def b1_index(
-0001cd20: 7365 6c66 293a 0a20 2020 2020 2020 2022  self):.        "
-0001cd30: 2222 0a20 2020 2020 2020 2052 6574 7572  "".        Retur
-0001cd40: 6e73 2074 6865 0a20 2020 2020 2020 2060  ns the.        `
-0001cd50: 4231 2062 616c 616e 6365 2069 6e64 6578  B1 balance index
-0001cd60: 203c 6874 7470 733a 2f2f 7472 6565 6261   <https://treeba
-0001cd70: 6c61 6e63 652e 776f 7264 7072 6573 732e  lance.wordpress.
-0001cd80: 636f 6d2f 62e2 8281 2d69 6e64 6578 2f3e  com/b...-index/>
-0001cd90: 605f 0a20 2020 2020 2020 2066 6f72 2074  `_.        for t
-0001cda0: 6869 7320 7472 6565 2e20 5468 6973 2069  his tree. This i
-0001cdb0: 7320 6465 6669 6e65 6420 6173 2074 6865  s defined as the
-0001cdc0: 2069 6e76 6572 7365 206f 6620 7468 6520   inverse of the 
-0001cdd0: 7375 6d20 6f66 2061 6c6c 0a20 2020 2020  sum of all.     
-0001cde0: 2020 206c 6f6e 6765 7374 2070 6174 6873     longest paths
-0001cdf0: 2074 6f20 6c65 6176 6573 2066 6f72 2065   to leaves for e
-0001ce00: 6163 6820 6e6f 6465 2062 6573 6964 6573  ach node besides
-0001ce10: 2072 6f6f 7473 2e0a 0a20 2020 2020 2020   roots...       
-0001ce20: 202e 2e20 7365 6561 6c73 6f3a 3a20 5365   .. seealso:: Se
-0001ce30: 6520 6053 6861 6f20 616e 6420 536f 6b61  e `Shao and Soka
-0001ce40: 6c20 2831 3939 3029 0a20 2020 2020 2020  l (1990).       
-0001ce50: 2020 2020 203c 6874 7470 733a 2f2f 7777       <https://ww
-0001ce60: 772e 6a73 746f 722e 6f72 672f 7374 6162  w.jstor.org/stab
-0001ce70: 6c65 2f32 3939 3231 3836 3e60 5f20 666f  le/2992186>`_ fo
-0001ce80: 7220 6465 7461 696c 732e 0a0a 2020 2020  r details...    
-0001ce90: 2020 2020 3a72 6574 7572 6e3a 2054 6865      :return: The
-0001cea0: 2042 3120 6261 6c61 6e63 6520 696e 6465   B1 balance inde
-0001ceb0: 782e 0a20 2020 2020 2020 203a 7274 7970  x..        :rtyp
-0001cec0: 653a 2066 6c6f 6174 0a20 2020 2020 2020  e: float.       
-0001ced0: 2022 2222 0a20 2020 2020 2020 2072 6574   """.        ret
-0001cee0: 7572 6e20 7365 6c66 2e5f 6c6c 5f74 7265  urn self._ll_tre
-0001cef0: 652e 6765 745f 6231 5f69 6e64 6578 2829  e.get_b1_index()
-0001cf00: 0a0a 2020 2020 6465 6620 6232 5f69 6e64  ..    def b2_ind
-0001cf10: 6578 2873 656c 662c 2062 6173 653d 3130  ex(self, base=10
-0001cf20: 293a 0a20 2020 2020 2020 2022 2222 0a20  ):.        """. 
-0001cf30: 2020 2020 2020 2052 6574 7572 6e73 2074         Returns t
-0001cf40: 6865 0a20 2020 2020 2020 2060 4232 2062  he.        `B2 b
-0001cf50: 616c 616e 6365 2069 6e64 6578 203c 6874  alance index <ht
-0001cf60: 7470 733a 2f2f 7472 6565 6261 6c61 6e63  tps://treebalanc
-0001cf70: 652e 776f 7264 7072 6573 732e 636f 6d2f  e.wordpress.com/
-0001cf80: 62e2 8282 2d69 6e64 6578 2f3e 605f 0a20  b...-index/>`_. 
-0001cf90: 2020 2020 2020 2074 6869 7320 7472 6565         this tree
-0001cfa0: 2e0a 2020 2020 2020 2020 5468 6973 2069  ..        This i
-0001cfb0: 7320 6465 6669 6e65 6420 6173 2074 6865  s defined as the
-0001cfc0: 2053 6861 6e6e 6f6e 2065 6e74 726f 7079   Shannon entropy
-0001cfd0: 206f 6620 7468 6520 7072 6f62 6162 696c   of the probabil
-0001cfe0: 6974 790a 2020 2020 2020 2020 6469 7374  ity.        dist
-0001cff0: 7269 6275 7469 6f6e 2074 6f20 7265 6163  ribution to reac
-0001d000: 6820 6c65 6176 6573 2061 7373 756d 696e  h leaves assumin
-0001d010: 6720 6120 7261 6e64 6f6d 2077 616c 6b0a  g a random walk.
-0001d020: 2020 2020 2020 2020 6672 6f6d 2061 2072          from a r
-0001d030: 6f6f 742e 2054 6865 2064 6566 6175 6c74  oot. The default
-0001d040: 2062 6173 6520 6973 2031 302c 2066 6f6c   base is 10, fol
-0001d050: 6c6f 7769 6e67 2053 6861 6f20 616e 6420  lowing Shao and 
-0001d060: 536f 6b61 6c20 2831 3939 3029 2e0a 0a20  Sokal (1990)... 
-0001d070: 2020 2020 2020 202e 2e20 7365 6561 6c73         .. seeals
-0001d080: 6f3a 3a20 5365 6520 6053 6861 6f20 616e  o:: See `Shao an
-0001d090: 6420 536f 6b61 6c20 2831 3939 3029 0a20  d Sokal (1990). 
-0001d0a0: 2020 2020 2020 2020 2020 203c 6874 7470             <http
-0001d0b0: 733a 2f2f 7777 772e 6a73 746f 722e 6f72  s://www.jstor.or
-0001d0c0: 672f 7374 6162 6c65 2f32 3939 3231 3836  g/stable/2992186
-0001d0d0: 3e60 5f20 666f 7220 6465 7461 696c 732e  >`_ for details.
-0001d0e0: 0a0a 2020 2020 2020 2020 3a70 6172 616d  ..        :param
-0001d0f0: 2069 6e74 2062 6173 653a 2054 6865 2062   int base: The b
-0001d100: 6173 6520 7573 6564 2066 6f72 2074 6865  ase used for the
-0001d110: 206c 6f67 6172 6974 686d 2069 6e20 7468   logarithm in th
-0001d120: 650a 2020 2020 2020 2020 2020 2020 5368  e.            Sh
-0001d130: 616e 6e6f 6e20 656e 7472 6f70 7920 636f  annon entropy co
-0001d140: 6d70 7574 6174 696f 6e2e 0a20 2020 2020  mputation..     
-0001d150: 2020 203a 7265 7475 726e 3a20 5468 6520     :return: The 
-0001d160: 4232 2062 616c 616e 6365 2069 6e64 6578  B2 balance index
-0001d170: 2e0a 2020 2020 2020 2020 3a72 7479 7065  ..        :rtype
-0001d180: 3a20 666c 6f61 740a 2020 2020 2020 2020  : float.        
-0001d190: 2222 220a 2020 2020 2020 2020 2320 4c65  """.        # Le
-0001d1a0: 7420 5079 7468 6f6e 2064 6563 6964 6520  t Python decide 
-0001d1b0: 6966 2074 6865 2062 6173 6520 6973 2061  if the base is a
-0001d1c0: 6363 6570 7461 626c 650a 2020 2020 2020  cceptable.      
-0001d1d0: 2020 6d61 7468 2e6c 6f67 2831 302c 2062    math.log(10, b
-0001d1e0: 6173 6529 0a20 2020 2020 2020 2072 6574  ase).        ret
-0001d1f0: 7572 6e20 7365 6c66 2e5f 6c6c 5f74 7265  urn self._ll_tre
-0001d200: 652e 6765 745f 6232 5f69 6e64 6578 2862  e.get_b2_index(b
-0001d210: 6173 6529 0a0a 2020 2020 6465 6620 636f  ase)..    def co
-0001d220: 6c6c 6573 735f 696e 6465 7828 7365 6c66  lless_index(self
-0001d230: 293a 0a20 2020 2020 2020 2022 2222 0a20  ):.        """. 
-0001d240: 2020 2020 2020 2052 6574 7572 6e73 2074         Returns t
-0001d250: 6865 0a20 2020 2020 2020 2060 436f 6c6c  he.        `Coll
-0001d260: 6573 7320 696d 6261 6c61 6e63 6520 696e  ess imbalance in
-0001d270: 6465 7820 3c68 7474 7073 3a2f 2f74 7265  dex <https://tre
-0001d280: 6562 616c 616e 6365 2e77 6f72 6470 7265  ebalance.wordpre
-0001d290: 7373 2e63 6f6d 2f63 6f6c 6c65 7373 2d69  ss.com/colless-i
-0001d2a0: 6e64 6578 2f3e 605f 0a20 2020 2020 2020  ndex/>`_.       
-0001d2b0: 2066 6f72 2074 6869 7320 7472 6565 2e20   for this tree. 
-0001d2c0: 5468 6973 2069 7320 6465 6669 6e65 6420  This is defined 
-0001d2d0: 6173 2074 6865 2073 756d 206f 6620 616c  as the sum of al
-0001d2e0: 6c20 6469 6666 6572 656e 6365 7320 6265  l differences be
-0001d2f0: 7477 6565 6e0a 2020 2020 2020 2020 6e75  tween.        nu
-0001d300: 6d62 6572 206f 6620 6c65 6176 6573 2073  mber of leaves s
-0001d310: 7562 7465 6e64 6564 2062 7920 7468 6520  ubtended by the 
-0001d320: 6c65 6674 2061 6e64 2072 6967 6874 2063  left and right c
-0001d330: 6869 6c64 206f 6620 6561 6368 206e 6f64  hild of each nod
-0001d340: 652e 0a20 2020 2020 2020 2054 6865 2043  e..        The C
-0001d350: 6f6c 6c65 7373 2069 6e64 6578 2069 7320  olless index is 
-0001d360: 756e 6465 6669 6e65 6420 666f 7220 6e6f  undefined for no
-0001d370: 6e2d 6269 6e61 7279 2074 7265 6573 2061  n-binary trees a
-0001d380: 6e64 2074 7265 6573 2077 6974 680a 2020  nd trees with.  
-0001d390: 2020 2020 2020 6d75 6c74 6970 6c65 2072        multiple r
-0001d3a0: 6f6f 7473 2e20 5468 6973 206d 6574 686f  oots. This metho
-0001d3b0: 6420 7769 6c6c 2072 6169 7365 2061 204c  d will raise a L
-0001d3c0: 6962 7261 7279 4572 726f 7220 6966 2074  ibraryError if t
-0001d3d0: 6865 2074 7265 6520 6973 0a20 2020 2020  he tree is.     
-0001d3e0: 2020 206e 6f74 2073 696e 676c 792d 726f     not singly-ro
-0001d3f0: 6f74 6564 2061 6e64 2062 696e 6172 792e  oted and binary.
-0001d400: 0a0a 2020 2020 2020 2020 2e2e 2073 6565  ..        .. see
-0001d410: 616c 736f 3a3a 2053 6565 2060 5368 616f  also:: See `Shao
-0001d420: 2061 6e64 2053 6f6b 616c 2028 3139 3930   and Sokal (1990
-0001d430: 290a 2020 2020 2020 2020 2020 2020 3c68  ).            <h
-0001d440: 7474 7073 3a2f 2f77 7777 2e6a 7374 6f72  ttps://www.jstor
-0001d450: 2e6f 7267 2f73 7461 626c 652f 3239 3932  .org/stable/2992
-0001d460: 3138 363e 605f 2066 6f72 2064 6574 6169  186>`_ for detai
-0001d470: 6c73 2e0a 0a20 2020 2020 2020 203a 7265  ls...        :re
-0001d480: 7475 726e 3a20 5468 6520 436f 6c6c 6573  turn: The Colles
-0001d490: 7320 696d 6261 6c61 6e63 6520 696e 6465  s imbalance inde
-0001d4a0: 782e 0a20 2020 2020 2020 203a 7274 7970  x..        :rtyp
-0001d4b0: 653a 2069 6e74 0a20 2020 2020 2020 2022  e: int.        "
-0001d4c0: 2222 0a20 2020 2020 2020 2072 6574 7572  "".        retur
-0001d4d0: 6e20 7365 6c66 2e5f 6c6c 5f74 7265 652e  n self._ll_tree.
-0001d4e0: 6765 745f 636f 6c6c 6573 735f 696e 6465  get_colless_inde
-0001d4f0: 7828 290a 0a20 2020 2064 6566 2073 6163  x()..    def sac
-0001d500: 6b69 6e5f 696e 6465 7828 7365 6c66 293a  kin_index(self):
-0001d510: 0a20 2020 2020 2020 2022 2222 0a20 2020  .        """.   
-0001d520: 2020 2020 2052 6574 7572 6e73 2074 6865       Returns the
-0001d530: 0a20 2020 2020 2020 2060 5361 636b 696e  .        `Sackin
-0001d540: 2069 6d62 616c 616e 6365 2069 6e64 6578   imbalance index
-0001d550: 203c 6874 7470 733a 2f2f 7472 6565 6261   <https://treeba
-0001d560: 6c61 6e63 652e 776f 7264 7072 6573 732e  lance.wordpress.
-0001d570: 636f 6d2f 7361 636b 696e 2d69 6e64 6578  com/sackin-index
-0001d580: 2f3e 605f 0a20 2020 2020 2020 2066 6f72  />`_.        for
-0001d590: 2074 6869 7320 7472 6565 2e20 5468 6973   this tree. This
-0001d5a0: 2069 7320 6465 6669 6e65 6420 6173 2074   is defined as t
-0001d5b0: 6865 2073 756d 206f 6620 7468 6520 6465  he sum of the de
-0001d5c0: 7074 6873 206f 6620 616c 6c20 6c65 6176  pths of all leav
-0001d5d0: 6573 0a20 2020 2020 2020 2069 6e20 7468  es.        in th
-0001d5e0: 6520 7472 6565 2e20 4571 7569 7661 6c65  e tree. Equivale
-0001d5f0: 6e74 2074 6f20 6060 7375 6d28 7472 6565  nt to ``sum(tree
-0001d600: 2e64 6570 7468 2875 2920 666f 7220 7520  .depth(u) for u 
-0001d610: 696e 0a20 2020 2020 2020 2074 7265 652e  in.        tree.
-0001d620: 6c65 6176 6573 2829 2960 600a 0a20 2020  leaves())``..   
-0001d630: 2020 2020 202e 2e20 7365 6561 6c73 6f3a       .. seealso:
-0001d640: 3a20 5365 6520 6053 6861 6f20 616e 6420  : See `Shao and 
-0001d650: 536f 6b61 6c20 2831 3939 3029 0a20 2020  Sokal (1990).   
-0001d660: 2020 2020 2020 2020 203c 6874 7470 733a           <https:
-0001d670: 2f2f 7777 772e 6a73 746f 722e 6f72 672f  //www.jstor.org/
-0001d680: 7374 6162 6c65 2f32 3939 3231 3836 3e60  stable/2992186>`
-0001d690: 5f20 666f 7220 6465 7461 696c 732e 0a0a  _ for details...
-0001d6a0: 2020 2020 2020 2020 3a72 6574 7572 6e3a          :return:
-0001d6b0: 2054 6865 2053 6163 6b69 6e20 696d 6261   The Sackin imba
-0001d6c0: 6c61 6e63 6520 696e 6465 782e 0a20 2020  lance index..   
-0001d6d0: 2020 2020 203a 7274 7970 653a 2069 6e74       :rtype: int
-0001d6e0: 0a20 2020 2020 2020 2022 2222 0a20 2020  .        """.   
-0001d6f0: 2020 2020 2072 6574 7572 6e20 7365 6c66       return self
-0001d700: 2e5f 6c6c 5f74 7265 652e 6765 745f 7361  ._ll_tree.get_sa
-0001d710: 636b 696e 5f69 6e64 6578 2829 0a0a 2020  ckin_index()..  
-0001d720: 2020 6465 6620 6e75 6d5f 6c69 6e65 6167    def num_lineag
-0001d730: 6573 2873 656c 662c 2074 293a 0a20 2020  es(self, t):.   
-0001d740: 2020 2020 2022 2222 0a20 2020 2020 2020       """.       
-0001d750: 2052 6574 7572 6e73 2074 6865 206e 756d   Returns the num
-0001d760: 6265 7220 6f66 206c 696e 6561 6765 7320  ber of lineages 
-0001d770: 7072 6573 656e 7420 696e 2074 6869 7320  present in this 
-0001d780: 7472 6565 2061 7420 7469 6d65 2060 6074  tree at time ``t
-0001d790: 6060 2e20 5468 6973 0a20 2020 2020 2020  ``. This.       
-0001d7a0: 2069 7320 6465 6669 6e65 6420 6173 2074   is defined as t
-0001d7b0: 6865 206e 756d 6265 7220 6f66 2062 7261  he number of bra
-0001d7c0: 6e63 6865 7320 696e 2074 6869 7320 7472  nches in this tr
-0001d7d0: 6565 2028 7265 6163 6861 626c 6520 6672  ee (reachable fr
-0001d7e0: 6f6d 2074 6865 0a20 2020 2020 2020 2073  om the.        s
-0001d7f0: 616d 706c 6573 2920 7468 6174 2069 6e74  amples) that int
-0001d800: 6572 7365 6374 2077 6974 6820 6060 7460  ersect with ``t`
-0001d810: 602e 2054 6875 732c 2060 6074 7265 652e  `. Thus, ``tree.
-0001d820: 6e75 6d5f 6c69 6e65 6167 6573 2874 2960  num_lineages(t)`
-0001d830: 600a 2020 2020 2020 2020 6973 2065 7175  `.        is equ
-0001d840: 616c 2074 6f20 3020 666f 7220 616e 7920  al to 0 for any 
-0001d850: 6060 7460 6020 6772 6561 7465 7220 7468  ``t`` greater th
-0001d860: 616e 206f 7220 6571 7561 6c20 746f 2074  an or equal to t
-0001d870: 6865 2074 696d 6520 6f66 0a20 2020 2020  he time of.     
-0001d880: 2020 2074 6865 2072 6f6f 7420 696e 2061     the root in a
-0001d890: 2073 696e 676c 792d 726f 6f74 6564 2074   singly-rooted t
-0001d8a0: 7265 652e 0a0a 2020 2020 2020 2020 2e2e  ree...        ..
-0001d8b0: 206e 6f74 653a 3a20 4e6f 7465 2074 6861   note:: Note tha
-0001d8c0: 7420 7468 6973 2064 6566 696e 6974 696f  t this definitio
-0001d8d0: 6e20 6d65 616e 7320 7468 6174 2069 6620  n means that if 
-0001d8e0: 6120 286e 6f6e 2072 6f6f 7429 206e 6f64  a (non root) nod
-0001d8f0: 650a 2020 2020 2020 2020 2020 2020 7769  e.            wi
-0001d900: 7468 2074 6872 6565 2063 6869 6c64 7265  th three childre
-0001d910: 6e20 6861 7320 7469 6d65 2060 6074 6060  n has time ``t``
-0001d920: 2c20 7468 656e 2069 7420 7769 6c6c 2063  , then it will c
-0001d930: 6f75 6e74 2061 7320 6f6e 6520 6c69 6e65  ount as one line
-0001d940: 6167 652c 0a20 2020 2020 2020 2020 2020  age,.           
-0001d950: 206e 6f74 2074 6872 6565 2e0a 0a20 2020   not three...   
-0001d960: 2020 2020 203a 7061 7261 6d20 696e 7420       :param int 
-0001d970: 743a 2054 6865 2074 696d 6520 746f 2063  t: The time to c
-0001d980: 6f75 6e74 206c 696e 6561 6765 7320 6174  ount lineages at
-0001d990: 2e0a 2020 2020 2020 2020 3a72 6574 7572  ..        :retur
-0001d9a0: 6e3a 2054 6865 206e 756d 6265 7220 6f66  n: The number of
-0001d9b0: 206c 696e 6561 6765 7320 696e 2074 6865   lineages in the
-0001d9c0: 2074 7265 6520 6174 2074 696d 6520 742e   tree at time t.
-0001d9d0: 0a20 2020 2020 2020 203a 7274 7970 653a  .        :rtype:
-0001d9e0: 2069 6e74 0a20 2020 2020 2020 2022 2222   int.        """
-0001d9f0: 0a20 2020 2020 2020 2072 6574 7572 6e20  .        return 
-0001da00: 7365 6c66 2e5f 6c6c 5f74 7265 652e 6765  self._ll_tree.ge
-0001da10: 745f 6e75 6d5f 6c69 6e65 6167 6573 2874  t_num_lineages(t
-0001da20: 290a 0a20 2020 2064 6566 2073 706c 6974  )..    def split
-0001da30: 5f70 6f6c 7974 6f6d 6965 7328 0a20 2020  _polytomies(.   
-0001da40: 2020 2020 2073 656c 662c 0a20 2020 2020       self,.     
-0001da50: 2020 202a 2c0a 2020 2020 2020 2020 6570     *,.        ep
-0001da60: 7369 6c6f 6e3d 4e6f 6e65 2c0a 2020 2020  silon=None,.    
-0001da70: 2020 2020 6d65 7468 6f64 3d4e 6f6e 652c      method=None,
-0001da80: 0a20 2020 2020 2020 2072 6563 6f72 645f  .        record_
-0001da90: 7072 6f76 656e 616e 6365 3d54 7275 652c  provenance=True,
-0001daa0: 0a20 2020 2020 2020 2072 616e 646f 6d5f  .        random_
-0001dab0: 7365 6564 3d4e 6f6e 652c 0a20 2020 2020  seed=None,.     
-0001dac0: 2020 202a 2a6b 7761 7267 732c 0a20 2020     **kwargs,.   
-0001dad0: 2029 3a0a 2020 2020 2020 2020 2222 220a   ):.        """.
-0001dae0: 2020 2020 2020 2020 5265 7475 726e 2061          Return a
-0001daf0: 206e 6577 203a 636c 6173 733a 602e 5472   new :class:`.Tr
-0001db00: 6565 6020 7768 6572 6520 6578 7472 6120  ee` where extra 
-0001db10: 6e6f 6465 7320 616e 6420 6564 6765 7320  nodes and edges 
-0001db20: 6861 7665 2062 6565 6e20 696e 7365 7274  have been insert
-0001db30: 6564 0a20 2020 2020 2020 2073 6f20 7468  ed.        so th
-0001db40: 6174 2061 6e79 2061 6e79 206e 6f64 6520  at any any node 
-0001db50: 6060 7560 6020 7769 7468 2067 7265 6174  ``u`` with great
-0001db60: 6572 2074 6861 6e20 3220 6368 696c 6472  er than 2 childr
-0001db70: 656e 202d 2d2d 2061 206d 756c 7469 6675  en --- a multifu
-0001db80: 7263 6174 696f 6e0a 2020 2020 2020 2020  rcation.        
-0001db90: 6f72 2022 706f 6c79 746f 6d79 2220 2d2d  or "polytomy" --
-0001dba0: 2d20 6973 2072 6573 6f6c 7665 6420 696e  - is resolved in
-0001dbb0: 746f 2073 7563 6365 7373 6976 6520 6269  to successive bi
-0001dbc0: 6675 7263 6174 696f 6e73 2e20 4e65 7720  furcations. New 
-0001dbd0: 6e6f 6465 7320 6172 650a 2020 2020 2020  nodes are.      
-0001dbe0: 2020 696e 7365 7274 6564 2061 7420 7469    inserted at ti
-0001dbf0: 6d65 7320 6672 6163 7469 6f6e 616c 6c79  mes fractionally
-0001dc00: 206c 6573 7320 7468 616e 2074 6861 6e20   less than than 
-0001dc10: 7468 6520 7469 6d65 206f 6620 6e6f 6465  the time of node
-0001dc20: 2060 6075 6060 2e0a 2020 2020 2020 2020   ``u``..        
-0001dc30: 5469 6d65 7320 6172 6520 616c 6c6f 6361  Times are alloca
-0001dc40: 7465 6420 746f 2064 6966 6665 7265 6e74  ted to different
-0001dc50: 206c 6576 656c 7320 6f66 2074 6865 2074   levels of the t
-0001dc60: 7265 652c 2073 7563 6820 7468 6174 2061  ree, such that a
-0001dc70: 6e79 206e 6577 6c79 0a20 2020 2020 2020  ny newly.       
-0001dc80: 2069 6e73 6572 7465 6420 7369 626c 696e   inserted siblin
-0001dc90: 6720 6e6f 6465 7320 7769 6c6c 2068 6176  g nodes will hav
-0001dca0: 6520 7468 6520 7361 6d65 2074 696d 652e  e the same time.
-0001dcb0: 0a0a 2020 2020 2020 2020 4279 2064 6566  ..        By def
-0001dcc0: 6175 6c74 2c20 7468 6520 7469 6d65 7320  ault, the times 
-0001dcd0: 6f66 2074 6865 206e 6577 6c79 2067 656e  of the newly gen
-0001dce0: 6572 6174 6564 2063 6869 6c64 7265 6e20  erated children 
-0001dcf0: 6f66 2061 2070 6172 7469 6375 6c61 720a  of a particular.
-0001dd00: 2020 2020 2020 2020 6e6f 6465 2061 7265          node are
-0001dd10: 2074 6865 206d 696e 696d 756d 2072 6570   the minimum rep
-0001dd20: 7265 7365 6e74 6162 6c65 2064 6973 7461  resentable dista
-0001dd30: 6e63 6520 696e 2066 6c6f 6174 696e 6720  nce in floating 
-0001dd40: 706f 696e 7420 6172 6974 686d 6574 6963  point arithmetic
-0001dd50: 0a20 2020 2020 2020 2066 726f 6d20 7468  .        from th
-0001dd60: 6569 7220 7061 7265 6e74 7320 2875 7369  eir parents (usi
-0001dd70: 6e67 2074 6865 2060 6e65 7874 6166 7465  ng the `nextafte
-0001dd80: 720a 2020 2020 2020 2020 3c68 7474 7073  r.        <https
-0001dd90: 3a2f 2f6e 756d 7079 2e6f 7267 2f64 6f63  ://numpy.org/doc
-0001dda0: 2f73 7461 626c 652f 7265 6665 7265 6e63  /stable/referenc
-0001ddb0: 652f 6765 6e65 7261 7465 642f 6e75 6d70  e/generated/nump
-0001ddc0: 792e 6e65 7874 6166 7465 722e 6874 6d6c  y.nextafter.html
-0001ddd0: 3e60 5f0a 2020 2020 2020 2020 6675 6e63  >`_.        func
-0001dde0: 7469 6f6e 292e 2054 6875 732c 2074 6865  tion). Thus, the
-0001ddf0: 2067 656e 6572 6174 6564 2062 7261 6e63   generated branc
-0001de00: 6865 7320 6861 7665 2074 6865 2073 686f  hes have the sho
-0001de10: 7274 6573 7420 706f 7373 6962 6c65 206e  rtest possible n
-0001de20: 6f6e 7a65 726f 0a20 2020 2020 2020 206c  onzero.        l
-0001de30: 656e 6774 682e 2041 2066 6978 6564 2062  ength. A fixed b
-0001de40: 7261 6e63 6820 6c65 6e67 7468 2062 6574  ranch length bet
-0001de50: 7765 656e 2069 6e73 6572 7465 6420 6e6f  ween inserted no
-0001de60: 6465 7320 616e 6420 7468 6569 7220 7061  des and their pa
-0001de70: 7265 6e74 730a 2020 2020 2020 2020 6361  rents.        ca
-0001de80: 6e20 616c 736f 2062 6520 7370 6563 6966  n also be specif
-0001de90: 6965 6420 6279 2075 7369 6e67 2074 6865  ied by using the
-0001dea0: 2060 6065 7073 696c 6f6e 6060 2070 6172   ``epsilon`` par
-0001deb0: 616d 6574 6572 2e0a 0a20 2020 2020 2020  ameter...       
-0001dec0: 202e 2e20 6e6f 7465 3a3a 0a20 2020 2020   .. note::.     
-0001ded0: 2020 2020 2020 2041 2074 7265 6520 7365         A tree se
-0001dee0: 7175 656e 6365 203a 7265 663a 6072 6571  quence :ref:`req
-0001def0: 7569 7265 733c 7365 635f 7661 6c69 645f  uires<sec_valid_
-0001df00: 7472 6565 5f73 6571 7565 6e63 655f 7265  tree_sequence_re
-0001df10: 7175 6972 656d 656e 7473 3e60 2074 6861  quirements>` tha
-0001df20: 740a 2020 2020 2020 2020 2020 2020 7061  t.            pa
-0001df30: 7265 6e74 7320 6265 206f 6c64 6572 2074  rents be older t
-0001df40: 6861 6e20 6368 696c 6472 656e 2061 6e64  han children and
-0001df50: 2074 6861 7420 6d75 7461 7469 6f6e 7320   that mutations 
-0001df60: 6172 6520 796f 756e 6765 7220 7468 616e  are younger than
-0001df70: 2074 6865 0a20 2020 2020 2020 2020 2020   the.           
-0001df80: 2070 6172 656e 7420 6f66 2074 6865 2065   parent of the e
-0001df90: 6467 6520 6f6e 2077 6869 6368 2074 6865  dge on which the
-0001dfa0: 7920 6c69 652e 2049 6620 6120 6669 7865  y lie. If a fixe
-0001dfb0: 6420 6060 6570 7369 6c6f 6e60 6020 6973  d ``epsilon`` is
-0001dfc0: 2073 7065 6369 6665 640a 2020 2020 2020   specifed.      
-0001dfd0: 2020 2020 2020 616e 6420 6973 206e 6f74        and is not
-0001dfe0: 2073 6d61 6c6c 2065 6e6f 7567 6820 636f   small enough co
-0001dff0: 6d70 6172 6564 2074 6f20 7468 6520 6469  mpared to the di
-0001e000: 7374 616e 6365 2062 6574 7765 656e 2061  stance between a
-0001e010: 2070 6f6c 7974 6f6d 7920 616e 640a 2020   polytomy and.  
-0001e020: 2020 2020 2020 2020 2020 6974 7320 6f6c            its ol
-0001e030: 6465 7374 2063 6869 6c64 2028 6f72 206f  dest child (or o
-0001e040: 6c64 6573 7420 6368 696c 6420 6d75 7461  ldest child muta
-0001e050: 7469 6f6e 2920 7468 6573 6520 7265 7175  tion) these requ
-0001e060: 6972 656d 656e 7473 206d 6179 206e 6f74  irements may not
-0001e070: 0a20 2020 2020 2020 2020 2020 2062 6520  .            be 
-0001e080: 6d65 742e 2049 6e20 7468 6973 2063 6173  met. In this cas
-0001e090: 6520 616e 2065 7272 6f72 2077 696c 6c20  e an error will 
-0001e0a0: 6265 2072 6169 7365 642e 0a0a 2020 2020  be raised...    
-0001e0b0: 2020 2020 4966 2074 6865 2060 606d 6574      If the ``met
-0001e0c0: 686f 6460 6020 6973 2060 6022 7261 6e64  hod`` is ``"rand
-0001e0d0: 6f6d 2260 6020 2863 7572 7265 6e74 6c79  om"`` (currently
-0001e0e0: 2074 6865 206f 6e6c 7920 6f70 7469 6f6e   the only option
-0001e0f0: 2c20 616e 6420 7468 6520 6465 6661 756c  , and the defaul
-0001e100: 740a 2020 2020 2020 2020 7768 656e 206e  t.        when n
-0001e110: 6f20 6d65 7468 6f64 2069 7320 7370 6563  o method is spec
-0001e120: 6966 6965 6429 2c20 7468 656e 2066 6f72  ified), then for
-0001e130: 2061 206e 6f64 6520 7769 7468 203a 6d61   a node with :ma
-0001e140: 7468 3a60 6e60 2063 6869 6c64 7265 6e2c  th:`n` children,
-0001e150: 2074 6865 0a20 2020 2020 2020 203a 6d61   the.        :ma
-0001e160: 7468 3a60 2832 6e20 2d20 3329 2120 2f20  th:`(2n - 3)! / 
-0001e170: 2832 5e28 6e20 2d20 3229 2028 6e20 2d20  (2^(n - 2) (n - 
-0001e180: 3221 2929 6020 706f 7373 6962 6c65 2062  2!))` possible b
-0001e190: 696e 6172 7920 7472 6565 7320 7769 7468  inary trees with
-0001e1a0: 2065 7175 616c 0a20 2020 2020 2020 2070   equal.        p
-0001e1b0: 726f 6261 6269 6c69 7479 2e0a 0a20 2020  robability...   
-0001e1c0: 2020 2020 2054 6865 2072 6574 7572 6e65       The returne
-0001e1d0: 6420 3a63 6c61 7373 3a60 2e54 7265 6560  d :class:`.Tree`
-0001e1e0: 2077 696c 6c20 6861 7665 2074 6865 2073   will have the s
-0001e1f0: 616d 6520 6765 6e6f 6d69 6320 7370 616e  ame genomic span
-0001e200: 2061 7320 7468 6973 2074 7265 652c 0a20   as this tree,. 
-0001e210: 2020 2020 2020 2061 6e64 206e 6f64 6520         and node 
-0001e220: 4944 7320 7769 6c6c 2062 6520 636f 6e73  IDs will be cons
-0001e230: 6572 7665 6420 2874 6861 7420 6973 2c20  erved (that is, 
-0001e240: 6e6f 6465 2060 6075 6060 2069 6e20 7468  node ``u`` in th
-0001e250: 6973 2074 7265 6520 7769 6c6c 0a20 2020  is tree will.   
-0001e260: 2020 2020 2062 6520 7468 6520 7361 6d65       be the same
-0001e270: 206e 6f64 6520 696e 2074 6865 2072 6574   node in the ret
-0001e280: 7572 6e65 6420 7472 6565 292e 2054 6865  urned tree). The
-0001e290: 2072 6574 7572 6e65 6420 7472 6565 2069   returned tree i
-0001e2a0: 7320 6465 7269 7665 6420 6672 6f6d 2061  s derived from a
-0001e2b0: 0a20 2020 2020 2020 2074 7265 6520 7365  .        tree se
-0001e2c0: 7175 656e 6365 2074 6861 7420 636f 6e74  quence that cont
-0001e2d0: 6169 6e73 206f 6e6c 7920 6f6e 6520 6e6f  ains only one no
-0001e2e0: 6e2d 6465 6765 6e65 7261 7465 2074 7265  n-degenerate tre
-0001e2f0: 652c 2074 6861 7420 6973 2c20 7768 6572  e, that is, wher
-0001e300: 650a 2020 2020 2020 2020 6564 6765 7320  e.        edges 
-0001e310: 636f 7665 7220 6f6e 6c79 2074 6865 2069  cover only the i
-0001e320: 6e74 6572 7661 6c20 7370 616e 6e65 6420  nterval spanned 
-0001e330: 6279 2074 6869 7320 7472 6565 2e0a 0a20  by this tree... 
-0001e340: 2020 2020 2020 203a 7061 7261 6d20 6570         :param ep
-0001e350: 7369 6c6f 6e3a 2049 6620 7370 6563 6966  silon: If specif
-0001e360: 6965 642c 2074 6865 2066 6978 6564 2062  ied, the fixed b
-0001e370: 7261 6e63 6820 6c65 6e67 7468 2062 6574  ranch length bet
-0001e380: 7765 656e 2069 6e73 6572 7465 640a 2020  ween inserted.  
-0001e390: 2020 2020 2020 2020 2020 6e6f 6465 7320            nodes 
-0001e3a0: 616e 6420 7468 6569 7220 7061 7265 6e74  and their parent
-0001e3b0: 732e 2049 6620 4e6f 6e65 2028 7468 6520  s. If None (the 
-0001e3c0: 6465 6661 756c 7429 2c20 7468 6520 6d69  default), the mi
-0001e3d0: 6e69 6d61 6c20 706f 7373 6962 6c65 0a20  nimal possible. 
-0001e3e0: 2020 2020 2020 2020 2020 206e 6f6e 7a65             nonze
-0001e3f0: 726f 2062 7261 6e63 6820 6c65 6e67 7468  ro branch length
-0001e400: 2069 7320 6765 6e65 7261 7465 6420 666f   is generated fo
-0001e410: 7220 6561 6368 206e 6f64 652e 0a20 2020  r each node..   
-0001e420: 2020 2020 203a 7061 7261 6d20 7374 7220       :param str 
-0001e430: 6d65 7468 6f64 3a20 5468 6520 6d65 7468  method: The meth
-0001e440: 6f64 2075 7365 6420 746f 2062 7265 616b  od used to break
-0001e450: 2070 6f6c 7974 6f6d 6965 732e 2043 7572   polytomies. Cur
-0001e460: 7265 6e74 6c79 206f 6e6c 7920 2272 616e  rently only "ran
-0001e470: 646f 6d22 0a20 2020 2020 2020 2020 2020  dom".           
-0001e480: 2069 7320 7375 7070 6f72 7465 642c 2077   is supported, w
-0001e490: 6869 6368 2063 616e 2061 6c73 6f20 6265  hich can also be
-0001e4a0: 2073 7065 6369 6669 6564 2062 7920 6060   specified by ``
-0001e4b0: 6d65 7468 6f64 3d4e 6f6e 6560 600a 2020  method=None``.  
-0001e4c0: 2020 2020 2020 2020 2020 2844 6566 6175            (Defau
-0001e4d0: 6c74 3a20 6060 4e6f 6e65 6060 292e 0a20  lt: ``None``).. 
-0001e4e0: 2020 2020 2020 203a 7061 7261 6d20 626f         :param bo
-0001e4f0: 6f6c 2072 6563 6f72 645f 7072 6f76 656e  ol record_proven
-0001e500: 616e 6365 3a20 4966 2054 7275 652c 2061  ance: If True, a
-0001e510: 6464 2064 6574 6169 6c73 206f 6620 7468  dd details of th
-0001e520: 6973 206f 7065 7261 7469 6f6e 2074 6f20  is operation to 
-0001e530: 7468 650a 2020 2020 2020 2020 2020 2020  the.            
-0001e540: 7072 6f76 656e 616e 6365 2069 6e66 6f72  provenance infor
-0001e550: 6d61 7469 6f6e 206f 6620 7468 6520 7265  mation of the re
-0001e560: 7475 726e 6564 2074 7265 6520 7365 7175  turned tree sequ
-0001e570: 656e 6365 2e20 2844 6566 6175 6c74 3a20  ence. (Default: 
-0001e580: 5472 7565 292e 0a20 2020 2020 2020 203a  True)..        :
-0001e590: 7061 7261 6d20 696e 7420 7261 6e64 6f6d  param int random
-0001e5a0: 5f73 6565 643a 2054 6865 2072 616e 646f  _seed: The rando
-0001e5b0: 6d20 7365 6564 2e20 4966 2074 6869 7320  m seed. If this 
-0001e5c0: 6973 204e 6f6e 652c 2061 2072 616e 646f  is None, a rando
-0001e5d0: 6d20 7365 6564 2077 696c 6c0a 2020 2020  m seed will.    
-0001e5e0: 2020 2020 2020 2020 6265 2061 7574 6f6d          be autom
-0001e5f0: 6174 6963 616c 6c79 2067 656e 6572 6174  atically generat
-0001e600: 6564 2e20 5661 6c69 6420 7261 6e64 6f6d  ed. Valid random
-0001e610: 2073 6565 6473 206d 7573 7420 6265 2062   seeds must be b
-0001e620: 6574 7765 656e 2031 2061 6e64 0a20 2020  etween 1 and.   
-0001e630: 2020 2020 2020 2020 203a 6d61 7468 3a60           :math:`
-0001e640: 325e 3332 20e2 8892 2031 602e 0a20 2020  2^32 ... 1`..   
-0001e650: 2020 2020 203a 7061 7261 6d20 5c5c 2a2a       :param \\**
-0001e660: 6b77 6172 6773 3a20 4675 7274 6865 7220  kwargs: Further 
-0001e670: 6172 6775 6d65 6e74 7320 7573 6564 2061  arguments used a
-0001e680: 7320 7061 7261 6d65 7465 7273 2077 6865  s parameters whe
-0001e690: 6e20 636f 6e73 7472 7563 7469 6e67 2074  n constructing t
-0001e6a0: 6865 0a20 2020 2020 2020 2020 2020 2072  he.            r
-0001e6b0: 6574 7572 6e65 6420 3a63 6c61 7373 3a60  eturned :class:`
-0001e6c0: 5472 6565 602e 2046 6f72 2065 7861 6d70  Tree`. For examp
-0001e6d0: 6c65 0a20 2020 2020 2020 2020 2020 2060  le.            `
-0001e6e0: 6074 7265 652e 7370 6c69 745f 706f 6c79  `tree.split_poly
-0001e6f0: 746f 6d69 6573 2873 616d 706c 655f 6c69  tomies(sample_li
-0001e700: 7374 733d 5472 7565 2960 6020 7769 6c6c  sts=True)`` will
-0001e710: 0a20 2020 2020 2020 2020 2020 2072 6574  .            ret
-0001e720: 7572 6e20 6120 3a63 6c61 7373 3a60 5472  urn a :class:`Tr
-0001e730: 6565 6020 6372 6561 7465 6420 7769 7468  ee` created with
-0001e740: 2060 6073 616d 706c 655f 6c69 7374 733d   ``sample_lists=
-0001e750: 5472 7565 6060 2e0a 2020 2020 2020 2020  True``..        
-0001e760: 3a72 6574 7572 6e3a 2041 206e 6577 2074  :return: A new t
-0001e770: 7265 6520 7769 7468 2070 6f6c 7974 6f6d  ree with polytom
-0001e780: 6965 7320 7370 6c69 7420 696e 746f 2072  ies split into r
-0001e790: 616e 646f 6d20 6269 6675 7263 6174 696f  andom bifurcatio
-0001e7a0: 6e73 2e0a 2020 2020 2020 2020 3a72 7479  ns..        :rty
-0001e7b0: 7065 3a20 7473 6b69 742e 5472 6565 0a20  pe: tskit.Tree. 
-0001e7c0: 2020 2020 2020 2022 2222 0a20 2020 2020         """.     
-0001e7d0: 2020 2072 6574 7572 6e20 636f 6d62 696e     return combin
-0001e7e0: 6174 6f72 6963 732e 7370 6c69 745f 706f  atorics.split_po
-0001e7f0: 6c79 746f 6d69 6573 280a 2020 2020 2020  lytomies(.      
-0001e800: 2020 2020 2020 7365 6c66 2c0a 2020 2020        self,.    
-0001e810: 2020 2020 2020 2020 6570 7369 6c6f 6e3d          epsilon=
-0001e820: 6570 7369 6c6f 6e2c 0a20 2020 2020 2020  epsilon,.       
-0001e830: 2020 2020 206d 6574 686f 643d 6d65 7468       method=meth
-0001e840: 6f64 2c0a 2020 2020 2020 2020 2020 2020  od,.            
-0001e850: 7265 636f 7264 5f70 726f 7665 6e61 6e63  record_provenanc
-0001e860: 653d 7265 636f 7264 5f70 726f 7665 6e61  e=record_provena
-0001e870: 6e63 652c 0a20 2020 2020 2020 2020 2020  nce,.           
-0001e880: 2072 616e 646f 6d5f 7365 6564 3d72 616e   random_seed=ran
-0001e890: 646f 6d5f 7365 6564 2c0a 2020 2020 2020  dom_seed,.      
-0001e8a0: 2020 2020 2020 2a2a 6b77 6172 6773 2c0a        **kwargs,.
-0001e8b0: 2020 2020 2020 2020 290a 0a20 2020 2040          )..    @
-0001e8c0: 7374 6174 6963 6d65 7468 6f64 0a20 2020  staticmethod.   
-0001e8d0: 2064 6566 2067 656e 6572 6174 655f 7374   def generate_st
-0001e8e0: 6172 280a 2020 2020 2020 2020 6e75 6d5f  ar(.        num_
-0001e8f0: 6c65 6176 6573 2c20 2a2c 2073 7061 6e3d  leaves, *, span=
-0001e900: 312c 2062 7261 6e63 685f 6c65 6e67 7468  1, branch_length
-0001e910: 3d31 2c20 7265 636f 7264 5f70 726f 7665  =1, record_prove
-0001e920: 6e61 6e63 653d 5472 7565 2c20 2a2a 6b77  nance=True, **kw
-0001e930: 6172 6773 0a20 2020 2029 3a0a 2020 2020  args.    ):.    
-0001e940: 2020 2020 2222 220a 2020 2020 2020 2020      """.        
-0001e950: 4765 6e65 7261 7465 2061 203a 636c 6173  Generate a :clas
-0001e960: 733a 6054 7265 6560 2077 686f 7365 206c  s:`Tree` whose l
-0001e970: 6561 6620 6e6f 6465 7320 616c 6c20 6861  eaf nodes all ha
-0001e980: 7665 2074 6865 2073 616d 6520 7061 7265  ve the same pare
-0001e990: 6e74 2028 692e 652e 2c0a 2020 2020 2020  nt (i.e.,.      
-0001e9a0: 2020 6120 2273 7461 7222 2074 7265 6529    a "star" tree)
-0001e9b0: 2e20 5468 6520 6c65 6166 206e 6f64 6573  . The leaf nodes
-0001e9c0: 2061 7265 2061 6c6c 2061 7420 7469 6d65   are all at time
-0001e9d0: 2030 2061 6e64 2061 7265 206d 6172 6b65   0 and are marke
-0001e9e0: 6420 6173 2073 616d 706c 6520 6e6f 6465  d as sample node
-0001e9f0: 732e 0a0a 2020 2020 2020 2020 5468 6520  s...        The 
-0001ea00: 7472 6565 2070 726f 6475 6365 6420 6279  tree produced by
-0001ea10: 2074 6869 7320 6d65 7468 6f64 2069 7320   this method is 
-0001ea20: 6964 656e 7469 6361 6c20 746f 0a20 2020  identical to.   
-0001ea30: 2020 2020 2060 6074 736b 6974 2e54 7265       ``tskit.Tre
-0001ea40: 652e 756e 7261 6e6b 286e 2c20 2830 2c20  e.unrank(n, (0, 
-0001ea50: 3029 2960 602c 2062 7574 2067 656e 6572  0))``, but gener
-0001ea60: 6174 6564 206d 6f72 6520 6566 6669 6369  ated more effici
-0001ea70: 656e 746c 7920 666f 7220 6c61 7267 6520  ently for large 
-0001ea80: 6060 6e60 602e 0a0a 2020 2020 2020 2020  ``n``...        
-0001ea90: 3a70 6172 616d 2069 6e74 206e 756d 5f6c  :param int num_l
-0001eaa0: 6561 7665 733a 2054 6865 206e 756d 6265  eaves: The numbe
-0001eab0: 7220 6f66 206c 6561 6620 6e6f 6465 7320  r of leaf nodes 
-0001eac0: 696e 2074 6865 2072 6574 7572 6e65 6420  in the returned 
-0001ead0: 7472 6565 2028 6d75 7374 2062 650a 2020  tree (must be.  
-0001eae0: 2020 2020 2020 2020 2020 3220 6f72 2067            2 or g
-0001eaf0: 7265 6174 6572 292e 0a20 2020 2020 2020  reater)..       
-0001eb00: 203a 7061 7261 6d20 666c 6f61 7420 7370   :param float sp
-0001eb10: 616e 3a20 5468 6520 7370 616e 206f 6620  an: The span of 
-0001eb20: 7468 6520 7472 6565 2c20 616e 6420 7468  the tree, and th
-0001eb30: 6572 6566 6f72 6520 7468 650a 2020 2020  erefore the.    
-0001eb40: 2020 2020 2020 2020 3a61 7474 723a 607e          :attr:`~
-0001eb50: 5472 6565 5365 7175 656e 6365 2e73 6571  TreeSequence.seq
-0001eb60: 7565 6e63 655f 6c65 6e67 7468 6020 6f66  uence_length` of
-0001eb70: 2074 6865 203a 6174 7472 3a60 2e74 7265   the :attr:`.tre
-0001eb80: 655f 7365 7175 656e 6365 600a 2020 2020  e_sequence`.    
-0001eb90: 2020 2020 2020 2020 7072 6f70 6572 7479          property
-0001eba0: 206f 6620 7468 6520 7265 7475 726e 6564   of the returned
-0001ebb0: 203a 636c 6173 733a 6054 7265 6560 2e0a   :class:`Tree`..
-0001ebc0: 2020 2020 2020 2020 3a70 6172 616d 2066          :param f
-0001ebd0: 6c6f 6174 2062 7261 6e63 685f 6c65 6e67  loat branch_leng
-0001ebe0: 7468 3a20 5468 6520 6c65 6e67 7468 206f  th: The length o
-0001ebf0: 6620 6576 6572 7920 6272 616e 6368 2069  f every branch i
-0001ec00: 6e20 7468 6520 7472 6565 2028 6571 7569  n the tree (equi
-0001ec10: 7661 6c65 6e74 0a20 2020 2020 2020 2020  valent.         
-0001ec20: 2020 2074 6f20 7468 6520 7469 6d65 206f     to the time o
-0001ec30: 6620 7468 6520 726f 6f74 206e 6f64 6529  f the root node)
-0001ec40: 2e0a 2020 2020 2020 2020 3a70 6172 616d  ..        :param
-0001ec50: 2062 6f6f 6c20 7265 636f 7264 5f70 726f   bool record_pro
-0001ec60: 7665 6e61 6e63 653a 2049 6620 5472 7565  venance: If True
-0001ec70: 2c20 6164 6420 6465 7461 696c 7320 6f66  , add details of
-0001ec80: 2074 6869 7320 6f70 6572 6174 696f 6e20   this operation 
-0001ec90: 746f 2074 6865 0a20 2020 2020 2020 2020  to the.         
-0001eca0: 2020 2070 726f 7665 6e61 6e63 6520 696e     provenance in
-0001ecb0: 666f 726d 6174 696f 6e20 6f66 2074 6865  formation of the
-0001ecc0: 2072 6574 7572 6e65 6420 7472 6565 2073   returned tree s
-0001ecd0: 6571 7565 6e63 652e 2028 4465 6661 756c  equence. (Defaul
-0001ece0: 743a 2054 7275 6529 2e0a 2020 2020 2020  t: True)..      
-0001ecf0: 2020 3a70 6172 616d 205c 5c2a 2a6b 7761    :param \\**kwa
-0001ed00: 7267 733a 2046 7572 7468 6572 2061 7267  rgs: Further arg
-0001ed10: 756d 656e 7473 2075 7365 6420 6173 2070  uments used as p
-0001ed20: 6172 616d 6574 6572 7320 7768 656e 2063  arameters when c
-0001ed30: 6f6e 7374 7275 6374 696e 6720 7468 650a  onstructing the.
-0001ed40: 2020 2020 2020 2020 2020 2020 7265 7475              retu
-0001ed50: 726e 6564 203a 636c 6173 733a 6054 7265  rned :class:`Tre
-0001ed60: 6560 2e20 466f 7220 6578 616d 706c 650a  e`. For example.
-0001ed70: 2020 2020 2020 2020 2020 2020 6060 7473              ``ts
-0001ed80: 6b69 742e 5472 6565 2e67 656e 6572 6174  kit.Tree.generat
-0001ed90: 655f 7374 6172 2873 616d 706c 655f 6c69  e_star(sample_li
-0001eda0: 7374 733d 5472 7565 2960 6020 7769 6c6c  sts=True)`` will
-0001edb0: 0a20 2020 2020 2020 2020 2020 2072 6574  .            ret
-0001edc0: 7572 6e20 6120 3a63 6c61 7373 3a60 5472  urn a :class:`Tr
-0001edd0: 6565 6020 6372 6561 7465 6420 7769 7468  ee` created with
-0001ede0: 2060 6073 616d 706c 655f 6c69 7374 733d   ``sample_lists=
-0001edf0: 5472 7565 6060 2e0a 2020 2020 2020 2020  True``..        
-0001ee00: 3a72 6574 7572 6e3a 2041 2073 7461 722d  :return: A star-
-0001ee10: 7368 6170 6564 2074 7265 652e 2049 7473  shaped tree. Its
-0001ee20: 2063 6f72 7265 7370 6f6e 6469 6e67 203a   corresponding :
-0001ee30: 636c 6173 733a 6054 7265 6553 6571 7565  class:`TreeSeque
-0001ee40: 6e63 6560 2069 7320 6176 6169 6c61 626c  nce` is availabl
-0001ee50: 650a 2020 2020 2020 2020 2020 2020 7669  e.            vi
-0001ee60: 6120 7468 6520 3a61 7474 723a 602e 7472  a the :attr:`.tr
-0001ee70: 6565 5f73 6571 7565 6e63 6560 2061 7474  ee_sequence` att
-0001ee80: 7269 6275 7465 2e0a 2020 2020 2020 2020  ribute..        
-0001ee90: 3a72 7479 7065 3a20 5472 6565 0a20 2020  :rtype: Tree.   
-0001eea0: 2020 2020 2022 2222 0a20 2020 2020 2020       """.       
-0001eeb0: 2072 6574 7572 6e20 636f 6d62 696e 6174   return combinat
-0001eec0: 6f72 6963 732e 6765 6e65 7261 7465 5f73  orics.generate_s
-0001eed0: 7461 7228 0a20 2020 2020 2020 2020 2020  tar(.           
-0001eee0: 206e 756d 5f6c 6561 7665 732c 0a20 2020   num_leaves,.   
-0001eef0: 2020 2020 2020 2020 2073 7061 6e3d 7370           span=sp
-0001ef00: 616e 2c0a 2020 2020 2020 2020 2020 2020  an,.            
-0001ef10: 6272 616e 6368 5f6c 656e 6774 683d 6272  branch_length=br
-0001ef20: 616e 6368 5f6c 656e 6774 682c 0a20 2020  anch_length,.   
-0001ef30: 2020 2020 2020 2020 2072 6563 6f72 645f           record_
-0001ef40: 7072 6f76 656e 616e 6365 3d72 6563 6f72  provenance=recor
-0001ef50: 645f 7072 6f76 656e 616e 6365 2c0a 2020  d_provenance,.  
-0001ef60: 2020 2020 2020 2020 2020 2a2a 6b77 6172            **kwar
-0001ef70: 6773 2c0a 2020 2020 2020 2020 290a 0a20  gs,.        ).. 
-0001ef80: 2020 2040 7374 6174 6963 6d65 7468 6f64     @staticmethod
-0001ef90: 0a20 2020 2064 6566 2067 656e 6572 6174  .    def generat
-0001efa0: 655f 6261 6c61 6e63 6564 280a 2020 2020  e_balanced(.    
-0001efb0: 2020 2020 6e75 6d5f 6c65 6176 6573 2c0a      num_leaves,.
-0001efc0: 2020 2020 2020 2020 2a2c 0a20 2020 2020          *,.     
-0001efd0: 2020 2061 7269 7479 3d32 2c0a 2020 2020     arity=2,.    
-0001efe0: 2020 2020 7370 616e 3d31 2c0a 2020 2020      span=1,.    
-0001eff0: 2020 2020 6272 616e 6368 5f6c 656e 6774      branch_lengt
-0001f000: 683d 312c 0a20 2020 2020 2020 2072 6563  h=1,.        rec
-0001f010: 6f72 645f 7072 6f76 656e 616e 6365 3d54  ord_provenance=T
-0001f020: 7275 652c 0a20 2020 2020 2020 202a 2a6b  rue,.        **k
-0001f030: 7761 7267 732c 0a20 2020 2029 3a0a 2020  wargs,.    ):.  
-0001f040: 2020 2020 2020 2222 220a 2020 2020 2020        """.      
-0001f050: 2020 4765 6e65 7261 7465 2061 203a 636c    Generate a :cl
-0001f060: 6173 733a 6054 7265 6560 2077 6974 6820  ass:`Tree` with 
-0001f070: 7468 6520 7370 6563 6966 6965 6420 6e75  the specified nu
-0001f080: 6d62 6572 206f 6620 6c65 6176 6573 2074  mber of leaves t
-0001f090: 6861 7420 6973 206d 6178 696d 616c 6c79  hat is maximally
-0001f0a0: 0a20 2020 2020 2020 2062 616c 616e 6365  .        balance
-0001f0b0: 642e 2042 7920 6465 6661 756c 742c 2074  d. By default, t
-0001f0c0: 6865 2074 7265 6520 7265 7475 726e 6564  he tree returned
-0001f0d0: 2069 7320 6269 6e61 7279 2c20 7375 6368   is binary, such
-0001f0e0: 2074 6861 7420 666f 7220 6561 6368 0a20   that for each. 
-0001f0f0: 2020 2020 2020 206e 6f64 6520 7468 6174         node that
-0001f100: 2073 7562 7465 6e64 7320 3a6d 6174 683a   subtends :math:
-0001f110: 606e 6020 6c65 6176 6573 2c20 7468 6520  `n` leaves, the 
-0001f120: 6c65 6674 2063 6869 6c64 2077 696c 6c20  left child will 
-0001f130: 7375 6274 656e 640a 2020 2020 2020 2020  subtend.        
-0001f140: 3a6d 6174 683a 605c 5c6c 666c 6f6f 727b  :math:`\\lfloor{
-0001f150: 6e20 2f20 327d 5c5c 7266 6c6f 6f72 6020  n / 2}\\rfloor` 
-0001f160: 6c65 6176 6573 2061 6e64 2074 6865 2072  leaves and the r
-0001f170: 6967 6874 2063 6869 6c64 2074 6865 0a20  ight child the. 
-0001f180: 2020 2020 2020 2072 656d 6169 6e64 6572         remainder
-0001f190: 2e20 4261 6c61 6e63 6564 2074 7265 6573  . Balanced trees
-0001f1a0: 2077 6974 6820 6869 6768 6572 2061 7269   with higher ari
-0001f1b0: 7479 2063 616e 2061 6c73 6f20 6765 6e65  ty can also gene
-0001f1c0: 7261 7465 6420 7573 696e 6720 7468 650a  rated using the.
-0001f1d0: 2020 2020 2020 2020 6060 6172 6974 7960          ``arity`
-0001f1e0: 6020 7061 7261 6d65 7465 722c 2077 6865  ` parameter, whe
-0001f1f0: 7265 2074 6865 206c 6561 7665 7320 7375  re the leaves su
-0001f200: 6274 656e 6469 6e67 2061 206e 6f64 6520  btending a node 
-0001f210: 6172 6520 6469 7374 7269 6275 7465 640a  are distributed.
-0001f220: 2020 2020 2020 2020 616d 6f6e 6720 6974          among it
-0001f230: 7320 6368 696c 6472 656e 2061 6e61 6c6f  s children analo
-0001f240: 676f 7573 6c79 2e0a 0a20 2020 2020 2020  gously...       
-0001f250: 2049 6e20 7468 6520 7265 7475 726e 6564   In the returned
-0001f260: 2074 7265 652c 2074 6865 206c 6561 6620   tree, the leaf 
-0001f270: 6e6f 6465 7320 6172 6520 616c 6c20 6174  nodes are all at
-0001f280: 2074 696d 6520 302c 206d 6172 6b65 6420   time 0, marked 
-0001f290: 6173 2073 616d 706c 6573 2c0a 2020 2020  as samples,.    
-0001f2a0: 2020 2020 616e 6420 6c61 6265 6c6c 6564      and labelled
-0001f2b0: 2030 2074 6f20 6e20 6672 6f6d 206c 6566   0 to n from lef
-0001f2c0: 742d 746f 2d72 6967 6874 2e20 496e 7465  t-to-right. Inte
-0001f2d0: 726e 616c 206e 6f64 6520 4944 7320 6172  rnal node IDs ar
-0001f2e0: 6520 6173 7369 676e 6564 0a20 2020 2020  e assigned.     
-0001f2f0: 2020 2073 6571 7565 6e74 6961 6c6c 7920     sequentially 
-0001f300: 6672 6f6d 206e 2069 6e20 6120 706f 7374  from n in a post
-0001f310: 6f72 6465 7220 7472 6176 6572 7361 6c2c  order traversal,
-0001f320: 2061 6e64 2074 6865 2074 696d 6520 6f66   and the time of
-0001f330: 2061 6e20 696e 7465 726e 616c 0a20 2020   an internal.   
-0001f340: 2020 2020 206e 6f64 6520 6973 2074 6865       node is the
-0001f350: 206d 6178 696d 756d 2074 696d 6520 6f66   maximum time of
-0001f360: 2069 7473 2063 6869 6c64 7265 6e20 706c   its children pl
-0001f370: 7573 2074 6865 2073 7065 6369 6669 6564  us the specified
-0001f380: 2060 6062 7261 6e63 685f 6c65 6e67 7468   ``branch_length
-0001f390: 6060 2e0a 0a20 2020 2020 2020 203a 7061  ``...        :pa
-0001f3a0: 7261 6d20 696e 7420 6e75 6d5f 6c65 6176  ram int num_leav
-0001f3b0: 6573 3a20 5468 6520 6e75 6d62 6572 206f  es: The number o
-0001f3c0: 6620 6c65 6166 206e 6f64 6573 2069 6e20  f leaf nodes in 
-0001f3d0: 7468 6520 7265 7475 726e 6564 2074 7265  the returned tre
-0001f3e0: 6520 286d 7573 7420 6265 0a20 2020 2020  e (must be.     
-0001f3f0: 2020 2020 2020 2062 6520 3220 6f72 2067         be 2 or g
-0001f400: 7265 6174 6572 292e 0a20 2020 2020 2020  reater)..       
-0001f410: 203a 7061 7261 6d20 696e 7420 6172 6974   :param int arit
-0001f420: 793a 2054 6865 206d 6178 696d 756d 206e  y: The maximum n
-0001f430: 756d 6265 7220 6f66 2063 6869 6c64 7265  umber of childre
-0001f440: 6e20 6120 6e6f 6465 2063 616e 2068 6176  n a node can hav
-0001f450: 6520 696e 2074 6865 2072 6574 7572 6e65  e in the returne
-0001f460: 640a 2020 2020 2020 2020 2020 2020 7472  d.            tr
-0001f470: 6565 2e0a 2020 2020 2020 2020 3a70 6172  ee..        :par
-0001f480: 616d 2066 6c6f 6174 2073 7061 6e3a 2054  am float span: T
-0001f490: 6865 2073 7061 6e20 6f66 2074 6865 2074  he span of the t
-0001f4a0: 7265 652c 2061 6e64 2074 6865 7265 666f  ree, and therefo
-0001f4b0: 7265 2074 6865 0a20 2020 2020 2020 2020  re the.         
-0001f4c0: 2020 203a 6174 7472 3a60 7e54 7265 6553     :attr:`~TreeS
-0001f4d0: 6571 7565 6e63 652e 7365 7175 656e 6365  equence.sequence
-0001f4e0: 5f6c 656e 6774 6860 206f 6620 7468 6520  _length` of the 
-0001f4f0: 3a61 7474 723a 602e 7472 6565 5f73 6571  :attr:`.tree_seq
-0001f500: 7565 6e63 6560 0a20 2020 2020 2020 2020  uence`.         
-0001f510: 2020 2070 726f 7065 7274 7920 6f66 2074     property of t
-0001f520: 6865 2072 6574 7572 6e65 6420 3a63 6c61  he returned :cla
-0001f530: 7373 3a60 5472 6565 602e 0a20 2020 2020  ss:`Tree`..     
-0001f540: 2020 203a 7061 7261 6d20 666c 6f61 7420     :param float 
-0001f550: 6272 616e 6368 5f6c 656e 6774 683a 2054  branch_length: T
-0001f560: 6865 206d 696e 696d 756d 206c 656e 6774  he minimum lengt
-0001f570: 6820 6f66 2061 2062 7261 6e63 6820 696e  h of a branch in
-0001f580: 2074 6865 2074 7265 6520 2873 6565 0a20   the tree (see. 
-0001f590: 2020 2020 2020 2020 2020 2061 626f 7665             above
-0001f5a0: 2066 6f72 2064 6574 6169 6c73 206f 6e20   for details on 
-0001f5b0: 686f 7720 696e 7465 726e 616c 206e 6f64  how internal nod
-0001f5c0: 6520 7469 6d65 7320 6172 6520 6173 7369  e times are assi
-0001f5d0: 676e 6564 292e 0a20 2020 2020 2020 203a  gned)..        :
-0001f5e0: 7061 7261 6d20 626f 6f6c 2072 6563 6f72  param bool recor
-0001f5f0: 645f 7072 6f76 656e 616e 6365 3a20 4966  d_provenance: If
-0001f600: 2054 7275 652c 2061 6464 2064 6574 6169   True, add detai
-0001f610: 6c73 206f 6620 7468 6973 206f 7065 7261  ls of this opera
-0001f620: 7469 6f6e 2074 6f20 7468 650a 2020 2020  tion to the.    
-0001f630: 2020 2020 2020 2020 7072 6f76 656e 616e          provenan
-0001f640: 6365 2069 6e66 6f72 6d61 7469 6f6e 206f  ce information o
-0001f650: 6620 7468 6520 7265 7475 726e 6564 2074  f the returned t
-0001f660: 7265 6520 7365 7175 656e 6365 2e20 2844  ree sequence. (D
-0001f670: 6566 6175 6c74 3a20 5472 7565 292e 0a20  efault: True).. 
-0001f680: 2020 2020 2020 203a 7061 7261 6d20 5c5c         :param \\
-0001f690: 2a2a 6b77 6172 6773 3a20 4675 7274 6865  **kwargs: Furthe
-0001f6a0: 7220 6172 6775 6d65 6e74 7320 7573 6564  r arguments used
-0001f6b0: 2061 7320 7061 7261 6d65 7465 7273 2077   as parameters w
-0001f6c0: 6865 6e20 636f 6e73 7472 7563 7469 6e67  hen constructing
-0001f6d0: 2074 6865 0a20 2020 2020 2020 2020 2020   the.           
-0001f6e0: 2072 6574 7572 6e65 6420 3a63 6c61 7373   returned :class
-0001f6f0: 3a60 5472 6565 602e 2046 6f72 2065 7861  :`Tree`. For exa
-0001f700: 6d70 6c65 0a20 2020 2020 2020 2020 2020  mple.           
-0001f710: 2060 6074 736b 6974 2e54 7265 652e 6765   ``tskit.Tree.ge
-0001f720: 6e65 7261 7465 5f62 616c 616e 6365 6428  nerate_balanced(
-0001f730: 7361 6d70 6c65 5f6c 6973 7473 3d54 7275  sample_lists=Tru
-0001f740: 6529 6060 2077 696c 6c0a 2020 2020 2020  e)`` will.      
-0001f750: 2020 2020 2020 7265 7475 726e 2061 203a        return a :
-0001f760: 636c 6173 733a 6054 7265 6560 2063 7265  class:`Tree` cre
-0001f770: 6174 6564 2077 6974 6820 6060 7361 6d70  ated with ``samp
-0001f780: 6c65 5f6c 6973 7473 3d54 7275 6560 602e  le_lists=True``.
-0001f790: 0a20 2020 2020 2020 203a 7265 7475 726e  .        :return
-0001f7a0: 3a20 4120 6261 6c61 6e63 6564 2074 7265  : A balanced tre
-0001f7b0: 652e 2049 7473 2063 6f72 7265 7370 6f6e  e. Its correspon
-0001f7c0: 6469 6e67 203a 636c 6173 733a 6054 7265  ding :class:`Tre
-0001f7d0: 6553 6571 7565 6e63 6560 2069 7320 6176  eSequence` is av
-0001f7e0: 6169 6c61 626c 650a 2020 2020 2020 2020  ailable.        
-0001f7f0: 2020 2020 7669 6120 7468 6520 3a61 7474      via the :att
-0001f800: 723a 602e 7472 6565 5f73 6571 7565 6e63  r:`.tree_sequenc
-0001f810: 6560 2061 7474 7269 6275 7465 2e0a 2020  e` attribute..  
-0001f820: 2020 2020 2020 3a72 7479 7065 3a20 5472        :rtype: Tr
-0001f830: 6565 0a20 2020 2020 2020 2022 2222 0a20  ee.        """. 
-0001f840: 2020 2020 2020 2072 6574 7572 6e20 636f         return co
-0001f850: 6d62 696e 6174 6f72 6963 732e 6765 6e65  mbinatorics.gene
-0001f860: 7261 7465 5f62 616c 616e 6365 6428 0a20  rate_balanced(. 
-0001f870: 2020 2020 2020 2020 2020 206e 756d 5f6c             num_l
-0001f880: 6561 7665 732c 0a20 2020 2020 2020 2020  eaves,.         
-0001f890: 2020 2061 7269 7479 3d61 7269 7479 2c0a     arity=arity,.
-0001f8a0: 2020 2020 2020 2020 2020 2020 7370 616e              span
-0001f8b0: 3d73 7061 6e2c 0a20 2020 2020 2020 2020  =span,.         
-0001f8c0: 2020 2062 7261 6e63 685f 6c65 6e67 7468     branch_length
-0001f8d0: 3d62 7261 6e63 685f 6c65 6e67 7468 2c0a  =branch_length,.
-0001f8e0: 2020 2020 2020 2020 2020 2020 7265 636f              reco
-0001f8f0: 7264 5f70 726f 7665 6e61 6e63 653d 7265  rd_provenance=re
-0001f900: 636f 7264 5f70 726f 7665 6e61 6e63 652c  cord_provenance,
-0001f910: 0a20 2020 2020 2020 2020 2020 202a 2a6b  .            **k
-0001f920: 7761 7267 732c 0a20 2020 2020 2020 2029  wargs,.        )
-0001f930: 0a0a 2020 2020 4073 7461 7469 636d 6574  ..    @staticmet
-0001f940: 686f 640a 2020 2020 6465 6620 6765 6e65  hod.    def gene
-0001f950: 7261 7465 5f63 6f6d 6228 0a20 2020 2020  rate_comb(.     
-0001f960: 2020 206e 756d 5f6c 6561 7665 732c 202a     num_leaves, *
-0001f970: 2c20 7370 616e 3d31 2c20 6272 616e 6368  , span=1, branch
-0001f980: 5f6c 656e 6774 683d 312c 2072 6563 6f72  _length=1, recor
-0001f990: 645f 7072 6f76 656e 616e 6365 3d54 7275  d_provenance=Tru
-0001f9a0: 652c 202a 2a6b 7761 7267 730a 2020 2020  e, **kwargs.    
-0001f9b0: 293a 0a20 2020 2020 2020 2022 2222 0a20  ):.        """. 
-0001f9c0: 2020 2020 2020 2047 656e 6572 6174 6520         Generate 
-0001f9d0: 6120 3a63 6c61 7373 3a60 5472 6565 6020  a :class:`Tree` 
-0001f9e0: 696e 2077 6869 6368 2061 6c6c 2069 6e74  in which all int
-0001f9f0: 6572 6e61 6c20 6e6f 6465 7320 6861 7665  ernal nodes have
-0001fa00: 2074 776f 2063 6869 6c64 7265 6e0a 2020   two children.  
-0001fa10: 2020 2020 2020 616e 6420 7468 6520 6c65        and the le
-0001fa20: 6674 2063 6869 6c64 2069 7320 6120 6c65  ft child is a le
-0001fa30: 6166 2e20 5468 6973 2069 7320 6120 2263  af. This is a "c
-0001fa40: 6f6d 6222 2c20 226c 6164 6465 7222 206f  omb", "ladder" o
-0001fa50: 7220 2270 6563 7469 6e61 7465 220a 2020  r "pectinate".  
-0001fa60: 2020 2020 2020 7068 796c 6f67 656e 792c        phylogeny,
-0001fa70: 2061 6e64 2061 6c73 6f20 6b6e 6f77 6e20   and also known 
-0001fa80: 6173 2061 2060 6361 7465 7270 696c 6c61  as a `caterpilla
-0001fa90: 7220 7472 6565 0a20 2020 2020 2020 203c  r tree.        <
-0001faa0: 6874 7470 733a 2f2f 656e 2e77 696b 6970  https://en.wikip
-0001fab0: 6564 6961 2e6f 7267 2f77 696b 692f 4361  edia.org/wiki/Ca
-0001fac0: 7465 7270 696c 6c61 725f 7472 6565 3e60  terpillar_tree>`
-0001fad0: 5f2e 0a0a 2020 2020 2020 2020 5468 6520  _...        The 
-0001fae0: 6c65 6166 206e 6f64 6573 2061 7265 2061  leaf nodes are a
-0001faf0: 6c6c 2061 7420 7469 6d65 2030 2c20 6d61  ll at time 0, ma
-0001fb00: 726b 6564 2061 7320 7361 6d70 6c65 732c  rked as samples,
-0001fb10: 0a20 2020 2020 2020 2061 6e64 206c 6162  .        and lab
-0001fb20: 656c 6c65 6420 3020 746f 206e 2066 726f  elled 0 to n fro
-0001fb30: 6d20 6c65 6674 2d74 6f2d 7269 6768 742e  m left-to-right.
-0001fb40: 2049 6e74 6572 6e61 6c20 6e6f 6465 2049   Internal node I
-0001fb50: 4473 2061 7265 2061 7373 6967 6e65 640a  Ds are assigned.
-0001fb60: 2020 2020 2020 2020 7365 7175 656e 7469          sequenti
-0001fb70: 616c 6c79 2066 726f 6d20 6e20 6173 2077  ally from n as w
-0001fb80: 6520 6173 6365 6e64 2074 6865 2074 7265  e ascend the tre
-0001fb90: 652c 2061 6e64 2074 6865 2074 696d 6520  e, and the time 
-0001fba0: 6f66 2061 6e20 696e 7465 726e 616c 0a20  of an internal. 
-0001fbb0: 2020 2020 2020 206e 6f64 6520 6973 2074         node is t
-0001fbc0: 6865 206d 6178 696d 756d 2074 696d 6520  he maximum time 
-0001fbd0: 6f66 2069 7473 2063 6869 6c64 7265 6e20  of its children 
-0001fbe0: 706c 7573 2074 6865 2073 7065 6369 6669  plus the specifi
-0001fbf0: 6564 2060 6062 7261 6e63 685f 6c65 6e67  ed ``branch_leng
-0001fc00: 7468 6060 2e0a 0a20 2020 2020 2020 203a  th``...        :
-0001fc10: 7061 7261 6d20 696e 7420 6e75 6d5f 6c65  param int num_le
-0001fc20: 6176 6573 3a20 5468 6520 6e75 6d62 6572  aves: The number
-0001fc30: 206f 6620 6c65 6166 206e 6f64 6573 2069   of leaf nodes i
-0001fc40: 6e20 7468 6520 7265 7475 726e 6564 2074  n the returned t
-0001fc50: 7265 6520 286d 7573 7420 6265 0a20 2020  ree (must be.   
-0001fc60: 2020 2020 2020 2020 2032 206f 7220 6772           2 or gr
-0001fc70: 6561 7465 7229 2e0a 2020 2020 2020 2020  eater)..        
-0001fc80: 3a70 6172 616d 2066 6c6f 6174 2073 7061  :param float spa
-0001fc90: 6e3a 2054 6865 2073 7061 6e20 6f66 2074  n: The span of t
-0001fca0: 6865 2074 7265 652c 2061 6e64 2074 6865  he tree, and the
-0001fcb0: 7265 666f 7265 2074 6865 0a20 2020 2020  refore the.     
-0001fcc0: 2020 2020 2020 203a 6174 7472 3a60 7e54         :attr:`~T
-0001fcd0: 7265 6553 6571 7565 6e63 652e 7365 7175  reeSequence.sequ
-0001fce0: 656e 6365 5f6c 656e 6774 6860 206f 6620  ence_length` of 
-0001fcf0: 7468 6520 3a61 7474 723a 602e 7472 6565  the :attr:`.tree
-0001fd00: 5f73 6571 7565 6e63 6560 0a20 2020 2020  _sequence`.     
-0001fd10: 2020 2020 2020 2070 726f 7065 7274 7920         property 
-0001fd20: 6f66 2074 6865 2072 6574 7572 6e65 6420  of the returned 
-0001fd30: 3a63 6c61 7373 3a60 5472 6565 602e 0a20  :class:`Tree`.. 
-0001fd40: 2020 2020 2020 203a 7061 7261 6d20 666c         :param fl
-0001fd50: 6f61 7420 6272 616e 6368 5f6c 656e 6774  oat branch_lengt
-0001fd60: 683a 2054 6865 2062 7261 6e63 6820 6c65  h: The branch le
-0001fd70: 6e67 7468 2062 6574 7765 656e 2065 6163  ngth between eac
-0001fd80: 6820 696e 7465 726e 616c 206e 6f64 653b  h internal node;
-0001fd90: 2074 6865 0a20 2020 2020 2020 2020 2020   the.           
-0001fda0: 2072 6f6f 7420 6e6f 6465 2069 7320 7468   root node is th
-0001fdb0: 6572 6566 6f72 6520 706c 6163 6564 2061  erefore placed a
-0001fdc0: 7420 7469 6d65 2060 6062 7261 6e63 685f  t time ``branch_
-0001fdd0: 6c65 6e67 7468 202a 2028 6e75 6d5f 6c65  length * (num_le
-0001fde0: 6176 6573 202d 2031 2960 602e 0a20 2020  aves - 1)``..   
-0001fdf0: 2020 2020 203a 7061 7261 6d20 626f 6f6c       :param bool
-0001fe00: 2072 6563 6f72 645f 7072 6f76 656e 616e   record_provenan
-0001fe10: 6365 3a20 4966 2054 7275 652c 2061 6464  ce: If True, add
-0001fe20: 2064 6574 6169 6c73 206f 6620 7468 6973   details of this
-0001fe30: 206f 7065 7261 7469 6f6e 2074 6f20 7468   operation to th
-0001fe40: 650a 2020 2020 2020 2020 2020 2020 7072  e.            pr
-0001fe50: 6f76 656e 616e 6365 2069 6e66 6f72 6d61  ovenance informa
-0001fe60: 7469 6f6e 206f 6620 7468 6520 7265 7475  tion of the retu
-0001fe70: 726e 6564 2074 7265 6520 7365 7175 656e  rned tree sequen
-0001fe80: 6365 2e20 2844 6566 6175 6c74 3a20 5472  ce. (Default: Tr
-0001fe90: 7565 292e 0a20 2020 2020 2020 203a 7061  ue)..        :pa
-0001fea0: 7261 6d20 5c5c 2a2a 6b77 6172 6773 3a20  ram \\**kwargs: 
-0001feb0: 4675 7274 6865 7220 6172 6775 6d65 6e74  Further argument
-0001fec0: 7320 7573 6564 2061 7320 7061 7261 6d65  s used as parame
-0001fed0: 7465 7273 2077 6865 6e20 636f 6e73 7472  ters when constr
-0001fee0: 7563 7469 6e67 2074 6865 0a20 2020 2020  ucting the.     
-0001fef0: 2020 2020 2020 2072 6574 7572 6e65 6420         returned 
-0001ff00: 3a63 6c61 7373 3a60 5472 6565 602e 2046  :class:`Tree`. F
-0001ff10: 6f72 2065 7861 6d70 6c65 0a20 2020 2020  or example.     
-0001ff20: 2020 2020 2020 2060 6074 736b 6974 2e54         ``tskit.T
-0001ff30: 7265 652e 6765 6e65 7261 7465 5f63 6f6d  ree.generate_com
-0001ff40: 6228 7361 6d70 6c65 5f6c 6973 7473 3d54  b(sample_lists=T
-0001ff50: 7275 6529 6060 2077 696c 6c0a 2020 2020  rue)`` will.    
-0001ff60: 2020 2020 2020 2020 7265 7475 726e 2061          return a
-0001ff70: 203a 636c 6173 733a 6054 7265 6560 2063   :class:`Tree` c
-0001ff80: 7265 6174 6564 2077 6974 6820 6060 7361  reated with ``sa
-0001ff90: 6d70 6c65 5f6c 6973 7473 3d54 7275 6560  mple_lists=True`
-0001ffa0: 602e 0a20 2020 2020 2020 203a 7265 7475  `..        :retu
-0001ffb0: 726e 3a20 4120 636f 6d62 2d73 6861 7065  rn: A comb-shape
-0001ffc0: 6420 6269 6675 7263 6174 696e 6720 7472  d bifurcating tr
-0001ffd0: 6565 2e20 4974 7320 636f 7272 6573 706f  ee. Its correspo
-0001ffe0: 6e64 696e 6720 3a63 6c61 7373 3a60 5472  nding :class:`Tr
-0001fff0: 6565 5365 7175 656e 6365 600a 2020 2020  eeSequence`.    
-00020000: 2020 2020 2020 2020 6973 2061 7661 696c          is avail
-00020010: 6162 6c65 2076 6961 2074 6865 203a 6174  able via the :at
-00020020: 7472 3a60 2e74 7265 655f 7365 7175 656e  tr:`.tree_sequen
-00020030: 6365 6020 6174 7472 6962 7574 652e 0a20  ce` attribute.. 
-00020040: 2020 2020 2020 203a 7274 7970 653a 2054         :rtype: T
-00020050: 7265 650a 2020 2020 2020 2020 2222 220a  ree.        """.
-00020060: 2020 2020 2020 2020 7265 7475 726e 2063          return c
-00020070: 6f6d 6269 6e61 746f 7269 6373 2e67 656e  ombinatorics.gen
-00020080: 6572 6174 655f 636f 6d62 280a 2020 2020  erate_comb(.    
-00020090: 2020 2020 2020 2020 6e75 6d5f 6c65 6176          num_leav
-000200a0: 6573 2c0a 2020 2020 2020 2020 2020 2020  es,.            
-000200b0: 7370 616e 3d73 7061 6e2c 0a20 2020 2020  span=span,.     
-000200c0: 2020 2020 2020 2062 7261 6e63 685f 6c65         branch_le
-000200d0: 6e67 7468 3d62 7261 6e63 685f 6c65 6e67  ngth=branch_leng
-000200e0: 7468 2c0a 2020 2020 2020 2020 2020 2020  th,.            
-000200f0: 7265 636f 7264 5f70 726f 7665 6e61 6e63  record_provenanc
-00020100: 653d 7265 636f 7264 5f70 726f 7665 6e61  e=record_provena
-00020110: 6e63 652c 0a20 2020 2020 2020 2020 2020  nce,.           
-00020120: 202a 2a6b 7761 7267 732c 0a20 2020 2020   **kwargs,.     
-00020130: 2020 2029 0a0a 2020 2020 4073 7461 7469     )..    @stati
-00020140: 636d 6574 686f 640a 2020 2020 6465 6620  cmethod.    def 
-00020150: 6765 6e65 7261 7465 5f72 616e 646f 6d5f  generate_random_
-00020160: 6269 6e61 7279 280a 2020 2020 2020 2020  binary(.        
-00020170: 6e75 6d5f 6c65 6176 6573 2c0a 2020 2020  num_leaves,.    
-00020180: 2020 2020 2a2c 0a20 2020 2020 2020 2073      *,.        s
-00020190: 7061 6e3d 312c 0a20 2020 2020 2020 2062  pan=1,.        b
-000201a0: 7261 6e63 685f 6c65 6e67 7468 3d31 2c0a  ranch_length=1,.
-000201b0: 2020 2020 2020 2020 7261 6e64 6f6d 5f73          random_s
-000201c0: 6565 643d 4e6f 6e65 2c0a 2020 2020 2020  eed=None,.      
-000201d0: 2020 7265 636f 7264 5f70 726f 7665 6e61    record_provena
-000201e0: 6e63 653d 5472 7565 2c0a 2020 2020 2020  nce=True,.      
-000201f0: 2020 2a2a 6b77 6172 6773 2c0a 2020 2020    **kwargs,.    
-00020200: 293a 0a20 2020 2020 2020 2022 2222 0a20  ):.        """. 
-00020210: 2020 2020 2020 2047 656e 6572 6174 6520         Generate 
-00020220: 6120 7261 6e64 6f6d 2062 696e 6172 7920  a random binary 
-00020230: 3a63 6c61 7373 3a60 5472 6565 6020 7769  :class:`Tree` wi
-00020240: 7468 203a 6d61 7468 3a60 6e60 203d 2060  th :math:`n` = `
-00020250: 606e 756d 5f6c 6561 7665 7360 600a 2020  `num_leaves``.  
-00020260: 2020 2020 2020 6c65 6176 6573 2077 6974        leaves wit
-00020270: 6820 616e 2065 7175 616c 2070 726f 6261  h an equal proba
-00020280: 6269 6c69 7479 206f 6620 7265 7475 726e  bility of return
-00020290: 696e 6720 616e 7920 746f 706f 6c6f 6779  ing any topology
-000202a0: 2061 6e64 0a20 2020 2020 2020 206c 6561   and.        lea
-000202b0: 6620 6c61 6265 6c20 7065 726d 7574 6174  f label permutat
-000202c0: 696f 6e20 616d 6f6e 6720 7468 6520 3a6d  ion among the :m
-000202d0: 6174 683a 6028 326e 202d 2033 2921 202f  ath:`(2n - 3)! /
-000202e0: 2028 325e 7b6e 202d 2032 7d20 286e 202d   (2^{n - 2} (n -
-000202f0: 2032 2921 2960 0a20 2020 2020 2020 206c   2)!)`.        l
-00020300: 6561 662d 6c61 6265 6c6c 6564 2062 696e  eaf-labelled bin
-00020310: 6172 7920 7472 6565 732e 0a0a 2020 2020  ary trees...    
-00020320: 2020 2020 5468 6520 6c65 6166 206e 6f64      The leaf nod
-00020330: 6573 2061 7265 206d 6172 6b65 6420 6173  es are marked as
-00020340: 2073 616d 706c 6573 2c20 6c61 6265 6c6c   samples, labell
-00020350: 6564 2030 2074 6f20 6e2c 2061 6e64 2070  ed 0 to n, and p
-00020360: 6c61 6365 6420 6174 0a20 2020 2020 2020  laced at.       
-00020370: 2074 696d 6520 302e 2049 6e74 6572 6e61   time 0. Interna
-00020380: 6c20 6e6f 6465 2049 4473 2061 7265 2061  l node IDs are a
-00020390: 7373 6967 6e65 6420 7365 7175 656e 7469  ssigned sequenti
-000203a0: 616c 6c79 2066 726f 6d20 6e20 6173 2077  ally from n as w
-000203b0: 6520 6173 6365 6e64 0a20 2020 2020 2020  e ascend.       
-000203c0: 2074 6865 2074 7265 652c 2061 6e64 2074   the tree, and t
-000203d0: 6865 2074 696d 6520 6f66 2061 6e20 696e  he time of an in
-000203e0: 7465 726e 616c 206e 6f64 6520 6973 2074  ternal node is t
-000203f0: 6865 206d 6178 696d 756d 2074 696d 6520  he maximum time 
-00020400: 6f66 2069 7473 0a20 2020 2020 2020 2063  of its.        c
-00020410: 6869 6c64 7265 6e20 706c 7573 2074 6865  hildren plus the
-00020420: 2073 7065 6369 6669 6564 2060 6062 7261   specified ``bra
-00020430: 6e63 685f 6c65 6e67 7468 6060 2e0a 0a20  nch_length``... 
-00020440: 2020 2020 2020 202e 2e20 6e6f 7465 3a3a         .. note::
-00020450: 0a20 2020 2020 2020 2020 2020 2054 6865  .            The
-00020460: 2072 6574 7572 6e65 6420 7472 6565 2068   returned tree h
-00020470: 6173 206e 6f74 2062 6565 6e20 6372 6561  as not been crea
-00020480: 7465 6420 756e 6465 7220 616e 7920 6578  ted under any ex
-00020490: 706c 6963 6974 206d 6f64 656c 206f 660a  plicit model of.
-000204a0: 2020 2020 2020 2020 2020 2020 6576 6f6c              evol
-000204b0: 7574 696f 6e2e 2049 6e20 6f72 6465 7220  ution. In order 
-000204c0: 746f 2073 696d 756c 6174 6520 7375 6368  to simulate such
-000204d0: 2074 7265 6573 2c20 6164 6469 7469 6f6e   trees, addition
-000204e0: 616c 2073 6f66 7477 6172 650a 2020 2020  al software.    
-000204f0: 2020 2020 2020 2020 7375 6368 2061 7320          such as 
-00020500: 606d 7370 7269 6d65 203c 6874 7470 733a  `msprime <https:
-00020510: 2f2f 6769 7468 7562 2e63 6f6d 2f74 736b  //github.com/tsk
-00020520: 6974 2d64 6576 2f6d 7370 7269 6d65 3e60  it-dev/msprime>`
-00020530: 6020 6973 2072 6571 7569 7265 642e 0a0a  ` is required...
-00020540: 2020 2020 2020 2020 3a70 6172 616d 2069          :param i
-00020550: 6e74 206e 756d 5f6c 6561 7665 733a 2054  nt num_leaves: T
-00020560: 6865 206e 756d 6265 7220 6f66 206c 6561  he number of lea
-00020570: 6620 6e6f 6465 7320 696e 2074 6865 2072  f nodes in the r
-00020580: 6574 7572 6e65 6420 7472 6565 2028 6d75  eturned tree (mu
-00020590: 7374 0a20 2020 2020 2020 2020 2020 2062  st.            b
-000205a0: 6520 3220 6f72 2067 7265 6174 6572 292e  e 2 or greater).
-000205b0: 0a20 2020 2020 2020 203a 7061 7261 6d20  .        :param 
-000205c0: 666c 6f61 7420 7370 616e 3a20 5468 6520  float span: The 
-000205d0: 7370 616e 206f 6620 7468 6520 7472 6565  span of the tree
-000205e0: 2c20 616e 6420 7468 6572 6566 6f72 6520  , and therefore 
-000205f0: 7468 650a 2020 2020 2020 2020 2020 2020  the.            
-00020600: 3a61 7474 723a 607e 5472 6565 5365 7175  :attr:`~TreeSequ
-00020610: 656e 6365 2e73 6571 7565 6e63 655f 6c65  ence.sequence_le
-00020620: 6e67 7468 6020 6f66 2074 6865 203a 6174  ngth` of the :at
-00020630: 7472 3a60 2e74 7265 655f 7365 7175 656e  tr:`.tree_sequen
-00020640: 6365 600a 2020 2020 2020 2020 2020 2020  ce`.            
-00020650: 7072 6f70 6572 7479 206f 6620 7468 6520  property of the 
-00020660: 7265 7475 726e 6564 203a 636c 6173 733a  returned :class:
-00020670: 6054 7265 6560 2e0a 2020 2020 2020 2020  `Tree`..        
-00020680: 3a70 6172 616d 2066 6c6f 6174 2062 7261  :param float bra
-00020690: 6e63 685f 6c65 6e67 7468 3a20 5468 6520  nch_length: The 
-000206a0: 6d69 6e69 6d75 6d20 7469 6d65 2062 6574  minimum time bet
-000206b0: 7765 656e 2070 6172 656e 7420 616e 6420  ween parent and 
-000206c0: 6368 696c 6420 6e6f 6465 732e 0a20 2020  child nodes..   
-000206d0: 2020 2020 203a 7061 7261 6d20 696e 7420       :param int 
-000206e0: 7261 6e64 6f6d 5f73 6565 643a 2054 6865  random_seed: The
-000206f0: 2072 616e 646f 6d20 7365 6564 2e20 4966   random seed. If
-00020700: 2074 6869 7320 6973 204e 6f6e 652c 2061   this is None, a
-00020710: 2072 616e 646f 6d20 7365 6564 2077 696c   random seed wil
-00020720: 6c0a 2020 2020 2020 2020 2020 2020 6265  l.            be
-00020730: 2061 7574 6f6d 6174 6963 616c 6c79 2067   automatically g
-00020740: 656e 6572 6174 6564 2e20 5661 6c69 6420  enerated. Valid 
-00020750: 7261 6e64 6f6d 2073 6565 6473 206d 7573  random seeds mus
-00020760: 7420 6265 2062 6574 7765 656e 2031 2061  t be between 1 a
-00020770: 6e64 0a20 2020 2020 2020 2020 2020 203a  nd.            :
-00020780: 6d61 7468 3a60 325e 3332 20e2 8892 2031  math:`2^32 ... 1
-00020790: 602e 0a20 2020 2020 2020 203a 7061 7261  `..        :para
-000207a0: 6d20 626f 6f6c 2072 6563 6f72 645f 7072  m bool record_pr
-000207b0: 6f76 656e 616e 6365 3a20 4966 2054 7275  ovenance: If Tru
-000207c0: 652c 2061 6464 2064 6574 6169 6c73 206f  e, add details o
-000207d0: 6620 7468 6973 206f 7065 7261 7469 6f6e  f this operation
-000207e0: 2074 6f20 7468 650a 2020 2020 2020 2020   to the.        
-000207f0: 2020 2020 7072 6f76 656e 616e 6365 2069      provenance i
-00020800: 6e66 6f72 6d61 7469 6f6e 206f 6620 7468  nformation of th
-00020810: 6520 7265 7475 726e 6564 2074 7265 6520  e returned tree 
-00020820: 7365 7175 656e 6365 2e20 2844 6566 6175  sequence. (Defau
-00020830: 6c74 3a20 5472 7565 292e 0a20 2020 2020  lt: True)..     
-00020840: 2020 203a 7061 7261 6d20 5c5c 2a2a 6b77     :param \\**kw
-00020850: 6172 6773 3a20 4675 7274 6865 7220 6172  args: Further ar
-00020860: 6775 6d65 6e74 7320 7573 6564 2061 7320  guments used as 
-00020870: 7061 7261 6d65 7465 7273 2077 6865 6e20  parameters when 
-00020880: 636f 6e73 7472 7563 7469 6e67 2074 6865  constructing the
-00020890: 0a20 2020 2020 2020 2020 2020 2072 6574  .            ret
-000208a0: 7572 6e65 6420 3a63 6c61 7373 3a60 5472  urned :class:`Tr
-000208b0: 6565 602e 2046 6f72 2065 7861 6d70 6c65  ee`. For example
-000208c0: 0a20 2020 2020 2020 2020 2020 2060 6074  .            ``t
-000208d0: 736b 6974 2e54 7265 652e 6765 6e65 7261  skit.Tree.genera
-000208e0: 7465 5f63 6f6d 6228 7361 6d70 6c65 5f6c  te_comb(sample_l
-000208f0: 6973 7473 3d54 7275 6529 6060 2077 696c  ists=True)`` wil
-00020900: 6c0a 2020 2020 2020 2020 2020 2020 7265  l.            re
-00020910: 7475 726e 2061 203a 636c 6173 733a 6054  turn a :class:`T
-00020920: 7265 6560 2063 7265 6174 6564 2077 6974  ree` created wit
-00020930: 6820 6060 7361 6d70 6c65 5f6c 6973 7473  h ``sample_lists
-00020940: 3d54 7275 6560 602e 0a20 2020 2020 2020  =True``..       
-00020950: 203a 7265 7475 726e 3a20 4120 7261 6e64   :return: A rand
-00020960: 6f6d 2062 696e 6172 7920 7472 6565 2e20  om binary tree. 
-00020970: 4974 7320 636f 7272 6573 706f 6e64 696e  Its correspondin
-00020980: 6720 3a63 6c61 7373 3a60 5472 6565 5365  g :class:`TreeSe
-00020990: 7175 656e 6365 6020 6973 0a20 2020 2020  quence` is.     
-000209a0: 2020 2020 2020 2061 7661 696c 6162 6c65         available
-000209b0: 2076 6961 2074 6865 203a 6174 7472 3a60   via the :attr:`
-000209c0: 2e74 7265 655f 7365 7175 656e 6365 6020  .tree_sequence` 
-000209d0: 6174 7472 6962 7574 652e 0a20 2020 2020  attribute..     
-000209e0: 2020 203a 7274 7970 653a 2054 7265 650a     :rtype: Tree.
-000209f0: 2020 2020 2020 2020 2222 220a 2020 2020          """.    
-00020a00: 2020 2020 7265 7475 726e 2063 6f6d 6269      return combi
-00020a10: 6e61 746f 7269 6373 2e67 656e 6572 6174  natorics.generat
-00020a20: 655f 7261 6e64 6f6d 5f62 696e 6172 7928  e_random_binary(
-00020a30: 0a20 2020 2020 2020 2020 2020 206e 756d  .            num
-00020a40: 5f6c 6561 7665 732c 0a20 2020 2020 2020  _leaves,.       
-00020a50: 2020 2020 2073 7061 6e3d 7370 616e 2c0a       span=span,.
-00020a60: 2020 2020 2020 2020 2020 2020 6272 616e              bran
-00020a70: 6368 5f6c 656e 6774 683d 6272 616e 6368  ch_length=branch
-00020a80: 5f6c 656e 6774 682c 0a20 2020 2020 2020  _length,.       
-00020a90: 2020 2020 2072 616e 646f 6d5f 7365 6564       random_seed
-00020aa0: 3d72 616e 646f 6d5f 7365 6564 2c0a 2020  =random_seed,.  
-00020ab0: 2020 2020 2020 2020 2020 7265 636f 7264            record
-00020ac0: 5f70 726f 7665 6e61 6e63 653d 7265 636f  _provenance=reco
-00020ad0: 7264 5f70 726f 7665 6e61 6e63 652c 0a20  rd_provenance,. 
-00020ae0: 2020 2020 2020 2020 2020 202a 2a6b 7761             **kwa
-00020af0: 7267 732c 0a20 2020 2020 2020 2029 0a0a  rgs,.        )..
-00020b00: 0a64 6566 206c 6f61 6428 6669 6c65 2c20  .def load(file, 
-00020b10: 2a2c 2073 6b69 705f 7461 626c 6573 3d46  *, skip_tables=F
-00020b20: 616c 7365 2c20 736b 6970 5f72 6566 6572  alse, skip_refer
-00020b30: 656e 6365 5f73 6571 7565 6e63 653d 4661  ence_sequence=Fa
-00020b40: 6c73 6529 3a0a 2020 2020 2222 220a 2020  lse):.    """.  
-00020b50: 2020 5265 7475 726e 2061 203a 636c 6173    Return a :clas
-00020b60: 733a 6054 7265 6553 6571 7565 6e63 6560  s:`TreeSequence`
-00020b70: 2069 6e73 7461 6e63 6520 6c6f 6164 6564   instance loaded
-00020b80: 2066 726f 6d20 7468 6520 7370 6563 6966   from the specif
-00020b90: 6965 6420 6669 6c65 206f 626a 6563 7420  ied file object 
-00020ba0: 6f72 0a20 2020 2070 6174 682e 2054 6865  or.    path. The
-00020bb0: 2066 696c 6520 6d75 7374 2062 6520 696e   file must be in
-00020bc0: 2074 6865 0a20 2020 203a 7265 663a 6074   the.    :ref:`t
-00020bd0: 7265 6520 7365 7175 656e 6365 2066 696c  ree sequence fil
-00020be0: 6520 666f 726d 6174 203c 7365 635f 7472  e format <sec_tr
-00020bf0: 6565 5f73 6571 7565 6e63 655f 6669 6c65  ee_sequence_file
-00020c00: 5f66 6f72 6d61 743e 600a 2020 2020 7072  _format>`.    pr
-00020c10: 6f64 7563 6564 2062 7920 7468 6520 3a6d  oduced by the :m
-00020c20: 6574 683a 6054 7265 6553 6571 7565 6e63  eth:`TreeSequenc
-00020c30: 652e 6475 6d70 6020 6d65 7468 6f64 2e0a  e.dump` method..
-00020c40: 0a20 2020 202e 2e20 7761 726e 696e 673a  .    .. warning:
-00020c50: 3a20 5769 7468 2061 6e79 206f 6620 7468  : With any of th
-00020c60: 6520 6060 736b 6970 5f74 6162 6c65 7360  e ``skip_tables`
-00020c70: 6020 6f72 2060 6073 6b69 705f 7265 6665  ` or ``skip_refe
-00020c80: 7265 6e63 655f 7365 7175 656e 6365 6060  rence_sequence``
-00020c90: 0a20 2020 2020 2020 206f 7074 696f 6e73  .        options
-00020ca0: 2073 6574 2c20 6974 2069 7320 6e6f 7420   set, it is not 
-00020cb0: 706f 7373 6962 6c65 2074 6f20 6c6f 6164  possible to load
-00020cc0: 2064 6174 6120 6672 6f6d 2061 206e 6f6e   data from a non
-00020cd0: 2d73 6565 6b61 626c 6520 7374 7265 616d  -seekable stream
-00020ce0: 0a20 2020 2020 2020 2028 652e 672e 2061  .        (e.g. a
-00020cf0: 2073 6f63 6b65 7420 6f72 2053 5444 494e   socket or STDIN
-00020d00: 2920 6f66 206d 756c 7469 706c 6520 7472  ) of multiple tr
-00020d10: 6565 2073 6571 7565 6e63 6573 2075 7369  ee sequences usi
-00020d20: 6e67 2063 6f6e 7365 6375 7469 7665 0a20  ng consecutive. 
-00020d30: 2020 2020 2020 2063 616c 6c73 2074 6f20         calls to 
-00020d40: 3a6d 6574 683a 6074 736b 6974 2e6c 6f61  :meth:`tskit.loa
-00020d50: 6460 2e0a 0a20 2020 203a 7061 7261 6d20  d`...    :param 
-00020d60: 7374 7220 6669 6c65 3a20 5468 6520 6669  str file: The fi
-00020d70: 6c65 206f 626a 6563 7420 6f72 2070 6174  le object or pat
-00020d80: 6820 6f66 2074 6865 2060 602e 7472 6565  h of the ``.tree
-00020d90: 7360 6020 6669 6c65 2063 6f6e 7461 696e  s`` file contain
-00020da0: 696e 6720 7468 650a 2020 2020 2020 2020  ing the.        
-00020db0: 7472 6565 2073 6571 7565 6e63 6520 7765  tree sequence we
-00020dc0: 2077 6973 6820 746f 206c 6f61 642e 0a20   wish to load.. 
-00020dd0: 2020 203a 7061 7261 6d20 626f 6f6c 2073     :param bool s
-00020de0: 6b69 705f 7461 626c 6573 3a20 4966 2054  kip_tables: If T
-00020df0: 7275 652c 206e 6f20 7461 626c 6573 2061  rue, no tables a
-00020e00: 7265 2072 6561 6420 6672 6f6d 2074 6865  re read from the
-00020e10: 2060 602e 7472 6565 7360 600a 2020 2020   ``.trees``.    
-00020e20: 2020 2020 6669 6c65 2061 6e64 206f 6e6c      file and onl
-00020e30: 7920 7468 6520 746f 702d 6c65 7665 6c20  y the top-level 
-00020e40: 696e 666f 726d 6174 696f 6e20 6973 2070  information is p
-00020e50: 6f70 756c 6174 6564 2069 6e20 7468 6520  opulated in the 
-00020e60: 7472 6565 0a20 2020 2020 2020 2073 6571  tree.        seq
-00020e70: 7565 6e63 6520 6f62 6a65 6374 2e0a 2020  uence object..  
-00020e80: 2020 3a70 6172 616d 2062 6f6f 6c20 736b    :param bool sk
-00020e90: 6970 5f72 6566 6572 656e 6365 5f73 6571  ip_reference_seq
-00020ea0: 7565 6e63 653a 2049 6620 5472 7565 2c20  uence: If True, 
-00020eb0: 7468 6520 7472 6565 2073 6571 7565 6e63  the tree sequenc
-00020ec0: 6520 6973 2072 6561 640a 2020 2020 2020  e is read.      
-00020ed0: 2020 7769 7468 6f75 7420 6c6f 6164 696e    without loadin
-00020ee0: 6720 6974 7320 7265 6665 7265 6e63 6520  g its reference 
-00020ef0: 7365 7175 656e 6365 2e0a 2020 2020 3a72  sequence..    :r
-00020f00: 6574 7572 6e3a 2054 6865 2074 7265 6520  eturn: The tree 
-00020f10: 7365 7175 656e 6365 206f 626a 6563 7420  sequence object 
-00020f20: 636f 6e74 6169 6e69 6e67 2074 6865 2069  containing the i
-00020f30: 6e66 6f72 6d61 7469 6f6e 0a20 2020 2020  nformation.     
-00020f40: 2020 2073 746f 7265 6420 696e 2074 6865     stored in the
-00020f50: 2073 7065 6369 6669 6564 2066 696c 6520   specified file 
-00020f60: 7061 7468 2e0a 2020 2020 3a72 7479 7065  path..    :rtype
-00020f70: 3a20 3a63 6c61 7373 3a60 7473 6b69 742e  : :class:`tskit.
-00020f80: 5472 6565 5365 7175 656e 6365 600a 2020  TreeSequence`.  
-00020f90: 2020 2222 220a 2020 2020 7265 7475 726e    """.    return
-00020fa0: 2054 7265 6553 6571 7565 6e63 652e 6c6f   TreeSequence.lo
-00020fb0: 6164 280a 2020 2020 2020 2020 6669 6c65  ad(.        file
-00020fc0: 2c20 736b 6970 5f74 6162 6c65 733d 736b  , skip_tables=sk
-00020fd0: 6970 5f74 6162 6c65 732c 2073 6b69 705f  ip_tables, skip_
-00020fe0: 7265 6665 7265 6e63 655f 7365 7175 656e  reference_sequen
-00020ff0: 6365 3d73 6b69 705f 7265 6665 7265 6e63  ce=skip_referenc
-00021000: 655f 7365 7175 656e 6365 0a20 2020 2029  e_sequence.    )
-00021010: 0a0a 0a64 6566 2070 6172 7365 5f69 6e64  ...def parse_ind
-00021020: 6976 6964 7561 6c73 280a 2020 2020 736f  ividuals(.    so
-00021030: 7572 6365 2c20 7374 7269 6374 3d54 7275  urce, strict=Tru
-00021040: 652c 2065 6e63 6f64 696e 673d 2275 7466  e, encoding="utf
-00021050: 3822 2c20 6261 7365 3634 5f6d 6574 6164  8", base64_metad
-00021060: 6174 613d 5472 7565 2c20 7461 626c 653d  ata=True, table=
-00021070: 4e6f 6e65 0a29 3a0a 2020 2020 2222 220a  None.):.    """.
-00021080: 2020 2020 5061 7273 6520 7468 6520 7370      Parse the sp
-00021090: 6563 6966 6965 6420 6669 6c65 2d6c 696b  ecified file-lik
-000210a0: 6520 6f62 6a65 6374 2063 6f6e 7461 696e  e object contain
-000210b0: 696e 6720 6120 7768 6974 6573 7061 6365  ing a whitespace
-000210c0: 2064 656c 696d 6974 6564 0a20 2020 2064   delimited.    d
-000210d0: 6573 6372 6970 7469 6f6e 206f 6620 616e  escription of an
-000210e0: 2069 6e64 6976 6964 7561 6c20 7461 626c   individual tabl
-000210f0: 6520 616e 6420 7265 7475 726e 7320 7468  e and returns th
-00021100: 6520 636f 7272 6573 706f 6e64 696e 670a  e corresponding.
-00021110: 2020 2020 3a63 6c61 7373 3a60 496e 6469      :class:`Indi
-00021120: 7669 6475 616c 5461 626c 6560 2069 6e73  vidualTable` ins
-00021130: 7461 6e63 652e 2053 6565 2074 6865 203a  tance. See the :
-00021140: 7265 663a 6069 6e64 6976 6964 7561 6c20  ref:`individual 
-00021150: 7465 7874 2066 6f72 6d61 740a 2020 2020  text format.    
-00021160: 3c73 6563 5f69 6e64 6976 6964 7561 6c5f  <sec_individual_
-00021170: 7465 7874 5f66 6f72 6d61 743e 6020 7365  text_format>` se
-00021180: 6374 696f 6e20 666f 7220 7468 6520 6465  ction for the de
-00021190: 7461 696c 7320 6f66 2074 6865 2072 6571  tails of the req
-000211a0: 7569 7265 640a 2020 2020 666f 726d 6174  uired.    format
-000211b0: 2061 6e64 2074 6865 203a 7265 663a 6069   and the :ref:`i
-000211c0: 6e64 6976 6964 7561 6c20 7461 626c 6520  ndividual table 
-000211d0: 6465 6669 6e69 7469 6f6e 0a20 2020 203c  definition.    <
-000211e0: 7365 635f 696e 6469 7669 6475 616c 5f74  sec_individual_t
-000211f0: 6162 6c65 5f64 6566 696e 6974 696f 6e3e  able_definition>
-00021200: 6020 7365 6374 696f 6e20 666f 7220 7468  ` section for th
-00021210: 6520 7265 7175 6972 6564 2070 726f 7065  e required prope
-00021220: 7274 6965 7320 6f66 0a20 2020 2074 6865  rties of.    the
-00021230: 2063 6f6e 7465 6e74 732e 0a0a 2020 2020   contents...    
-00021240: 5365 6520 3a66 756e 633a 6074 736b 6974  See :func:`tskit
-00021250: 2e6c 6f61 645f 7465 7874 6020 666f 7220  .load_text` for 
-00021260: 6120 6465 7461 696c 6564 2065 7870 6c61  a detailed expla
-00021270: 6e61 7469 6f6e 206f 6620 7468 6520 6060  nation of the ``
-00021280: 7374 7269 6374 6060 0a20 2020 2070 6172  strict``.    par
-00021290: 616d 6574 6572 2e0a 0a20 2020 203a 7061  ameter...    :pa
-000212a0: 7261 6d20 696f 2e54 6578 7449 4f42 6173  ram io.TextIOBas
-000212b0: 6520 736f 7572 6365 3a20 5468 6520 6669  e source: The fi
-000212c0: 6c65 2d6c 696b 6520 6f62 6a65 6374 2063  le-like object c
-000212d0: 6f6e 7461 696e 696e 6720 7468 6520 7465  ontaining the te
-000212e0: 7874 2e0a 2020 2020 3a70 6172 616d 2062  xt..    :param b
-000212f0: 6f6f 6c20 7374 7269 6374 3a20 4966 2054  ool strict: If T
-00021300: 7275 652c 2072 6571 7569 7265 2073 7472  rue, require str
-00021310: 6963 7420 7461 6220 6465 6c69 6d69 7469  ict tab delimiti
-00021320: 6e67 2028 6465 6661 756c 7429 2e20 4966  ng (default). If
-00021330: 0a20 2020 2020 2020 2046 616c 7365 2c20  .        False, 
-00021340: 6120 7265 6c61 7865 6420 7768 6974 6573  a relaxed whites
-00021350: 7061 6365 2073 706c 6974 7469 6e67 2061  pace splitting a
-00021360: 6c67 6f72 6974 686d 2069 7320 7573 6564  lgorithm is used
-00021370: 2e0a 2020 2020 3a70 6172 616d 2073 7472  ..    :param str
-00021380: 2065 6e63 6f64 696e 673a 2045 6e63 6f64   encoding: Encod
-00021390: 696e 6720 7573 6564 2066 6f72 2074 6578  ing used for tex
-000213a0: 7420 7265 7072 6573 656e 7461 7469 6f6e  t representation
-000213b0: 2e0a 2020 2020 3a70 6172 616d 2062 6f6f  ..    :param boo
-000213c0: 6c20 6261 7365 3634 5f6d 6574 6164 6174  l base64_metadat
-000213d0: 613a 2049 6620 5472 7565 2c20 6d65 7461  a: If True, meta
-000213e0: 6461 7461 2069 7320 656e 636f 6465 6420  data is encoded 
-000213f0: 7573 696e 6720 4261 7365 3634 0a20 2020  using Base64.   
-00021400: 2020 2020 2065 6e63 6f64 696e 673b 206f       encoding; o
-00021410: 7468 6572 7769 7365 2c20 6173 2070 6c61  therwise, as pla
-00021420: 696e 2074 6578 742e 0a20 2020 203a 7061  in text..    :pa
-00021430: 7261 6d20 496e 6469 7669 6475 616c 5461  ram IndividualTa
-00021440: 626c 6520 7461 626c 653a 2049 6620 7370  ble table: If sp
-00021450: 6563 6966 6965 6420 7772 6974 6520 696e  ecified write in
-00021460: 746f 2074 6869 7320 7461 626c 652e 2049  to this table. I
-00021470: 6620 6e6f 742c 0a20 2020 2020 2020 2063  f not,.        c
-00021480: 7265 6174 6520 6120 6e65 7720 3a63 6c61  reate a new :cla
-00021490: 7373 3a60 496e 6469 7669 6475 616c 5461  ss:`IndividualTa
-000214a0: 626c 6560 2069 6e73 7461 6e63 652e 0a20  ble` instance.. 
-000214b0: 2020 2022 2222 0a20 2020 2073 6570 203d     """.    sep =
-000214c0: 204e 6f6e 650a 2020 2020 6966 2073 7472   None.    if str
-000214d0: 6963 743a 0a20 2020 2020 2020 2073 6570  ict:.        sep
-000214e0: 203d 2022 5c74 220a 2020 2020 6966 2074   = "\t".    if t
-000214f0: 6162 6c65 2069 7320 4e6f 6e65 3a0a 2020  able is None:.  
-00021500: 2020 2020 2020 7461 626c 6520 3d20 7461        table = ta
-00021510: 626c 6573 2e49 6e64 6976 6964 7561 6c54  bles.IndividualT
-00021520: 6162 6c65 2829 0a20 2020 2023 2052 6561  able().    # Rea
-00021530: 6420 7468 6520 6865 6164 6572 2061 6e64  d the header and
-00021540: 2066 696e 6420 7468 6520 696e 6465 7865   find the indexe
-00021550: 7320 6f66 2074 6865 2072 6571 7569 7265  s of the require
-00021560: 6420 6669 656c 6473 2e0a 2020 2020 6865  d fields..    he
-00021570: 6164 6572 203d 2073 6f75 7263 652e 7265  ader = source.re
-00021580: 6164 6c69 6e65 2829 2e72 7374 7269 7028  adline().rstrip(
-00021590: 225c 6e22 292e 7370 6c69 7428 7365 7029  "\n").split(sep)
-000215a0: 0a20 2020 2066 6c61 6773 5f69 6e64 6578  .    flags_index
-000215b0: 203d 2068 6561 6465 722e 696e 6465 7828   = header.index(
-000215c0: 2266 6c61 6773 2229 0a20 2020 206c 6f63  "flags").    loc
-000215d0: 6174 696f 6e5f 696e 6465 7820 3d20 4e6f  ation_index = No
-000215e0: 6e65 0a20 2020 2070 6172 656e 7473 5f69  ne.    parents_i
-000215f0: 6e64 6578 203d 204e 6f6e 650a 2020 2020  ndex = None.    
-00021600: 6d65 7461 6461 7461 5f69 6e64 6578 203d  metadata_index =
-00021610: 204e 6f6e 650a 2020 2020 7472 793a 0a20   None.    try:. 
-00021620: 2020 2020 2020 206c 6f63 6174 696f 6e5f         location_
-00021630: 696e 6465 7820 3d20 6865 6164 6572 2e69  index = header.i
-00021640: 6e64 6578 2822 6c6f 6361 7469 6f6e 2229  ndex("location")
-00021650: 0a20 2020 2065 7863 6570 7420 5661 6c75  .    except Valu
-00021660: 6545 7272 6f72 3a0a 2020 2020 2020 2020  eError:.        
-00021670: 7061 7373 0a20 2020 2074 7279 3a0a 2020  pass.    try:.  
-00021680: 2020 2020 2020 7061 7265 6e74 735f 696e        parents_in
-00021690: 6465 7820 3d20 6865 6164 6572 2e69 6e64  dex = header.ind
-000216a0: 6578 2822 7061 7265 6e74 7322 290a 2020  ex("parents").  
-000216b0: 2020 6578 6365 7074 2056 616c 7565 4572    except ValueEr
-000216c0: 726f 723a 0a20 2020 2020 2020 2070 6173  ror:.        pas
-000216d0: 730a 2020 2020 7472 793a 0a20 2020 2020  s.    try:.     
-000216e0: 2020 206d 6574 6164 6174 615f 696e 6465     metadata_inde
-000216f0: 7820 3d20 6865 6164 6572 2e69 6e64 6578  x = header.index
-00021700: 2822 6d65 7461 6461 7461 2229 0a20 2020  ("metadata").   
-00021710: 2065 7863 6570 7420 5661 6c75 6545 7272   except ValueErr
-00021720: 6f72 3a0a 2020 2020 2020 2020 7061 7373  or:.        pass
-00021730: 0a20 2020 2066 6f72 206c 696e 6520 696e  .    for line in
-00021740: 2073 6f75 7263 653a 0a20 2020 2020 2020   source:.       
-00021750: 2074 6f6b 656e 7320 3d20 6c69 6e65 2e72   tokens = line.r
-00021760: 7374 7269 7028 225c 6e22 292e 7370 6c69  strip("\n").spli
-00021770: 7428 7365 7029 0a20 2020 2020 2020 2069  t(sep).        i
-00021780: 6620 6c65 6e28 746f 6b65 6e73 2920 3e3d  f len(tokens) >=
-00021790: 2031 3a0a 2020 2020 2020 2020 2020 2020   1:.            
-000217a0: 666c 6167 7320 3d20 696e 7428 746f 6b65  flags = int(toke
-000217b0: 6e73 5b66 6c61 6773 5f69 6e64 6578 5d29  ns[flags_index])
-000217c0: 0a20 2020 2020 2020 2020 2020 206c 6f63  .            loc
-000217d0: 6174 696f 6e20 3d20 2829 0a20 2020 2020  ation = ().     
-000217e0: 2020 2020 2020 2069 6620 6c6f 6361 7469         if locati
-000217f0: 6f6e 5f69 6e64 6578 2069 7320 6e6f 7420  on_index is not 
-00021800: 4e6f 6e65 3a0a 2020 2020 2020 2020 2020  None:.          
-00021810: 2020 2020 2020 6c6f 6361 7469 6f6e 5f73        location_s
-00021820: 7472 696e 6720 3d20 746f 6b65 6e73 5b6c  tring = tokens[l
-00021830: 6f63 6174 696f 6e5f 696e 6465 785d 0a20  ocation_index]. 
-00021840: 2020 2020 2020 2020 2020 2020 2020 2069                 i
-00021850: 6620 6c65 6e28 6c6f 6361 7469 6f6e 5f73  f len(location_s
-00021860: 7472 696e 6729 203e 2030 3a0a 2020 2020  tring) > 0:.    
-00021870: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00021880: 6c6f 6361 7469 6f6e 203d 2074 7570 6c65  location = tuple
-00021890: 286d 6170 2866 6c6f 6174 2c20 6c6f 6361  (map(float, loca
-000218a0: 7469 6f6e 5f73 7472 696e 672e 7370 6c69  tion_string.spli
-000218b0: 7428 222c 2229 2929 0a20 2020 2020 2020  t(","))).       
-000218c0: 2020 2020 2070 6172 656e 7473 203d 2028       parents = (
-000218d0: 290a 2020 2020 2020 2020 2020 2020 6966  ).            if
-000218e0: 2070 6172 656e 7473 5f69 6e64 6578 2069   parents_index i
-000218f0: 7320 6e6f 7420 4e6f 6e65 3a0a 2020 2020  s not None:.    
-00021900: 2020 2020 2020 2020 2020 2020 7061 7265              pare
-00021910: 6e74 735f 7374 7269 6e67 203d 2074 6f6b  nts_string = tok
-00021920: 656e 735b 7061 7265 6e74 735f 696e 6465  ens[parents_inde
-00021930: 785d 0a20 2020 2020 2020 2020 2020 2020  x].             
-00021940: 2020 2069 6620 6c65 6e28 7061 7265 6e74     if len(parent
-00021950: 735f 7374 7269 6e67 2920 3e20 303a 0a20  s_string) > 0:. 
-00021960: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00021970: 2020 2070 6172 656e 7473 203d 2074 7570     parents = tup
-00021980: 6c65 286d 6170 2869 6e74 2c20 7061 7265  le(map(int, pare
-00021990: 6e74 735f 7374 7269 6e67 2e73 706c 6974  nts_string.split
-000219a0: 2822 2c22 2929 290a 2020 2020 2020 2020  (","))).        
-000219b0: 2020 2020 6d65 7461 6461 7461 203d 2062      metadata = b
-000219c0: 2222 0a20 2020 2020 2020 2020 2020 2069  "".            i
-000219d0: 6620 6d65 7461 6461 7461 5f69 6e64 6578  f metadata_index
-000219e0: 2069 7320 6e6f 7420 4e6f 6e65 2061 6e64   is not None and
-000219f0: 206d 6574 6164 6174 615f 696e 6465 7820   metadata_index 
-00021a00: 3c20 6c65 6e28 746f 6b65 6e73 293a 0a20  < len(tokens):. 
-00021a10: 2020 2020 2020 2020 2020 2020 2020 206d                 m
-00021a20: 6574 6164 6174 6120 3d20 746f 6b65 6e73  etadata = tokens
-00021a30: 5b6d 6574 6164 6174 615f 696e 6465 785d  [metadata_index]
-00021a40: 2e65 6e63 6f64 6528 656e 636f 6469 6e67  .encode(encoding
-00021a50: 290a 2020 2020 2020 2020 2020 2020 2020  ).              
-00021a60: 2020 6966 2062 6173 6536 345f 6d65 7461    if base64_meta
-00021a70: 6461 7461 3a0a 2020 2020 2020 2020 2020  data:.          
-00021a80: 2020 2020 2020 2020 2020 6d65 7461 6461            metada
-00021a90: 7461 203d 2062 6173 6536 342e 6236 3464  ta = base64.b64d
-00021aa0: 6563 6f64 6528 6d65 7461 6461 7461 290a  ecode(metadata).
-00021ab0: 2020 2020 2020 2020 2020 2020 7461 626c              tabl
-00021ac0: 652e 6164 645f 726f 7728 0a20 2020 2020  e.add_row(.     
-00021ad0: 2020 2020 2020 2020 2020 2066 6c61 6773             flags
-00021ae0: 3d66 6c61 6773 2c20 6c6f 6361 7469 6f6e  =flags, location
-00021af0: 3d6c 6f63 6174 696f 6e2c 2070 6172 656e  =location, paren
-00021b00: 7473 3d70 6172 656e 7473 2c20 6d65 7461  ts=parents, meta
-00021b10: 6461 7461 3d6d 6574 6164 6174 610a 2020  data=metadata.  
-00021b20: 2020 2020 2020 2020 2020 290a 2020 2020            ).    
-00021b30: 7265 7475 726e 2074 6162 6c65 0a0a 0a64  return table...d
-00021b40: 6566 2070 6172 7365 5f6e 6f64 6573 2873  ef parse_nodes(s
-00021b50: 6f75 7263 652c 2073 7472 6963 743d 5472  ource, strict=Tr
-00021b60: 7565 2c20 656e 636f 6469 6e67 3d22 7574  ue, encoding="ut
-00021b70: 6638 222c 2062 6173 6536 345f 6d65 7461  f8", base64_meta
-00021b80: 6461 7461 3d54 7275 652c 2074 6162 6c65  data=True, table
-00021b90: 3d4e 6f6e 6529 3a0a 2020 2020 2222 220a  =None):.    """.
-00021ba0: 2020 2020 5061 7273 6520 7468 6520 7370      Parse the sp
-00021bb0: 6563 6966 6965 6420 6669 6c65 2d6c 696b  ecified file-lik
-00021bc0: 6520 6f62 6a65 6374 2063 6f6e 7461 696e  e object contain
-00021bd0: 696e 6720 6120 7768 6974 6573 7061 6365  ing a whitespace
-00021be0: 2064 656c 696d 6974 6564 0a20 2020 2064   delimited.    d
-00021bf0: 6573 6372 6970 7469 6f6e 206f 6620 6120  escription of a 
-00021c00: 6e6f 6465 2074 6162 6c65 2061 6e64 2072  node table and r
-00021c10: 6574 7572 6e73 2074 6865 2063 6f72 7265  eturns the corre
-00021c20: 7370 6f6e 6469 6e67 203a 636c 6173 733a  sponding :class:
-00021c30: 604e 6f64 6554 6162 6c65 600a 2020 2020  `NodeTable`.    
-00021c40: 696e 7374 616e 6365 2e20 5365 6520 7468  instance. See th
-00021c50: 6520 3a72 6566 3a60 6e6f 6465 2074 6578  e :ref:`node tex
-00021c60: 7420 666f 726d 6174 203c 7365 635f 6e6f  t format <sec_no
-00021c70: 6465 5f74 6578 745f 666f 726d 6174 3e60  de_text_format>`
-00021c80: 2073 6563 7469 6f6e 0a20 2020 2066 6f72   section.    for
-00021c90: 2074 6865 2064 6574 6169 6c73 206f 6620   the details of 
-00021ca0: 7468 6520 7265 7175 6972 6564 2066 6f72  the required for
-00021cb0: 6d61 7420 616e 6420 7468 650a 2020 2020  mat and the.    
-00021cc0: 3a72 6566 3a60 6e6f 6465 2074 6162 6c65  :ref:`node table
-00021cd0: 2064 6566 696e 6974 696f 6e20 3c73 6563   definition <sec
-00021ce0: 5f6e 6f64 655f 7461 626c 655f 6465 6669  _node_table_defi
-00021cf0: 6e69 7469 6f6e 3e60 2073 6563 7469 6f6e  nition>` section
-00021d00: 2066 6f72 2074 6865 0a20 2020 2072 6571   for the.    req
-00021d10: 7569 7265 6420 7072 6f70 6572 7469 6573  uired properties
-00021d20: 206f 6620 7468 6520 636f 6e74 656e 7473   of the contents
-00021d30: 2e0a 0a20 2020 2053 6565 203a 6675 6e63  ...    See :func
-00021d40: 3a60 7473 6b69 742e 6c6f 6164 5f74 6578  :`tskit.load_tex
-00021d50: 7460 2066 6f72 2061 2064 6574 6169 6c65  t` for a detaile
-00021d60: 6420 6578 706c 616e 6174 696f 6e20 6f66  d explanation of
-00021d70: 2074 6865 2060 6073 7472 6963 7460 600a   the ``strict``.
-00021d80: 2020 2020 7061 7261 6d65 7465 722e 0a0a      parameter...
-00021d90: 2020 2020 3a70 6172 616d 2069 6f2e 5465      :param io.Te
-00021da0: 7874 494f 4261 7365 2073 6f75 7263 653a  xtIOBase source:
-00021db0: 2054 6865 2066 696c 652d 6c69 6b65 206f   The file-like o
-00021dc0: 626a 6563 7420 636f 6e74 6169 6e69 6e67  bject containing
-00021dd0: 2074 6865 2074 6578 742e 0a20 2020 203a   the text..    :
-00021de0: 7061 7261 6d20 626f 6f6c 2073 7472 6963  param bool stric
-00021df0: 743a 2049 6620 5472 7565 2c20 7265 7175  t: If True, requ
-00021e00: 6972 6520 7374 7269 6374 2074 6162 2064  ire strict tab d
-00021e10: 656c 696d 6974 696e 6720 2864 6566 6175  elimiting (defau
-00021e20: 6c74 292e 2049 660a 2020 2020 2020 2020  lt). If.        
-00021e30: 4661 6c73 652c 2061 2072 656c 6178 6564  False, a relaxed
-00021e40: 2077 6869 7465 7370 6163 6520 7370 6c69   whitespace spli
-00021e50: 7474 696e 6720 616c 676f 7269 7468 6d20  tting algorithm 
-00021e60: 6973 2075 7365 642e 0a20 2020 203a 7061  is used..    :pa
-00021e70: 7261 6d20 7374 7220 656e 636f 6469 6e67  ram str encoding
-00021e80: 3a20 456e 636f 6469 6e67 2075 7365 6420  : Encoding used 
-00021e90: 666f 7220 7465 7874 2072 6570 7265 7365  for text represe
-00021ea0: 6e74 6174 696f 6e2e 0a20 2020 203a 7061  ntation..    :pa
-00021eb0: 7261 6d20 626f 6f6c 2062 6173 6536 345f  ram bool base64_
-00021ec0: 6d65 7461 6461 7461 3a20 4966 2054 7275  metadata: If Tru
-00021ed0: 652c 206d 6574 6164 6174 6120 6973 2065  e, metadata is e
-00021ee0: 6e63 6f64 6564 2075 7369 6e67 2042 6173  ncoded using Bas
-00021ef0: 6536 340a 2020 2020 2020 2020 656e 636f  e64.        enco
-00021f00: 6469 6e67 3b20 6f74 6865 7277 6973 652c  ding; otherwise,
-00021f10: 2061 7320 706c 6169 6e20 7465 7874 2e0a   as plain text..
-00021f20: 2020 2020 3a70 6172 616d 204e 6f64 6554      :param NodeT
-00021f30: 6162 6c65 2074 6162 6c65 3a20 4966 2073  able table: If s
-00021f40: 7065 6369 6669 6564 2077 7269 7465 2069  pecified write i
-00021f50: 6e74 6f20 7468 6973 2074 6162 6c65 2e20  nto this table. 
-00021f60: 4966 206e 6f74 2c0a 2020 2020 2020 2020  If not,.        
-00021f70: 6372 6561 7465 2061 206e 6577 203a 636c  create a new :cl
-00021f80: 6173 733a 604e 6f64 6554 6162 6c65 6020  ass:`NodeTable` 
-00021f90: 696e 7374 616e 6365 2e0a 2020 2020 2222  instance..    ""
-00021fa0: 220a 2020 2020 7365 7020 3d20 4e6f 6e65  ".    sep = None
-00021fb0: 0a20 2020 2069 6620 7374 7269 6374 3a0a  .    if strict:.
-00021fc0: 2020 2020 2020 2020 7365 7020 3d20 225c          sep = "\
-00021fd0: 7422 0a20 2020 2069 6620 7461 626c 6520  t".    if table 
-00021fe0: 6973 204e 6f6e 653a 0a20 2020 2020 2020  is None:.       
-00021ff0: 2074 6162 6c65 203d 2074 6162 6c65 732e   table = tables.
-00022000: 4e6f 6465 5461 626c 6528 290a 2020 2020  NodeTable().    
-00022010: 2320 5265 6164 2074 6865 2068 6561 6465  # Read the heade
-00022020: 7220 616e 6420 6669 6e64 2074 6865 2069  r and find the i
-00022030: 6e64 6578 6573 206f 6620 7468 6520 7265  ndexes of the re
-00022040: 7175 6972 6564 2066 6965 6c64 732e 0a20  quired fields.. 
-00022050: 2020 2068 6561 6465 7220 3d20 736f 7572     header = sour
-00022060: 6365 2e72 6561 646c 696e 6528 292e 7273  ce.readline().rs
-00022070: 7472 6970 2822 5c6e 2229 2e73 706c 6974  trip("\n").split
-00022080: 2873 6570 290a 2020 2020 6973 5f73 616d  (sep).    is_sam
-00022090: 706c 655f 696e 6465 7820 3d20 6865 6164  ple_index = head
-000220a0: 6572 2e69 6e64 6578 2822 6973 5f73 616d  er.index("is_sam
-000220b0: 706c 6522 290a 2020 2020 7469 6d65 5f69  ple").    time_i
-000220c0: 6e64 6578 203d 2068 6561 6465 722e 696e  ndex = header.in
-000220d0: 6465 7828 2274 696d 6522 290a 2020 2020  dex("time").    
-000220e0: 706f 7075 6c61 7469 6f6e 5f69 6e64 6578  population_index
-000220f0: 203d 204e 6f6e 650a 2020 2020 696e 6469   = None.    indi
-00022100: 7669 6475 616c 5f69 6e64 6578 203d 204e  vidual_index = N
-00022110: 6f6e 650a 2020 2020 6d65 7461 6461 7461  one.    metadata
-00022120: 5f69 6e64 6578 203d 204e 6f6e 650a 2020  _index = None.  
-00022130: 2020 7472 793a 0a20 2020 2020 2020 2070    try:.        p
-00022140: 6f70 756c 6174 696f 6e5f 696e 6465 7820  opulation_index 
-00022150: 3d20 6865 6164 6572 2e69 6e64 6578 2822  = header.index("
-00022160: 706f 7075 6c61 7469 6f6e 2229 0a20 2020  population").   
-00022170: 2065 7863 6570 7420 5661 6c75 6545 7272   except ValueErr
-00022180: 6f72 3a0a 2020 2020 2020 2020 7061 7373  or:.        pass
-00022190: 0a20 2020 2074 7279 3a0a 2020 2020 2020  .    try:.      
-000221a0: 2020 696e 6469 7669 6475 616c 5f69 6e64    individual_ind
-000221b0: 6578 203d 2068 6561 6465 722e 696e 6465  ex = header.inde
-000221c0: 7828 2269 6e64 6976 6964 7561 6c22 290a  x("individual").
-000221d0: 2020 2020 6578 6365 7074 2056 616c 7565      except Value
-000221e0: 4572 726f 723a 0a20 2020 2020 2020 2070  Error:.        p
-000221f0: 6173 730a 2020 2020 7472 793a 0a20 2020  ass.    try:.   
-00022200: 2020 2020 206d 6574 6164 6174 615f 696e       metadata_in
-00022210: 6465 7820 3d20 6865 6164 6572 2e69 6e64  dex = header.ind
-00022220: 6578 2822 6d65 7461 6461 7461 2229 0a20  ex("metadata"). 
-00022230: 2020 2065 7863 6570 7420 5661 6c75 6545     except ValueE
-00022240: 7272 6f72 3a0a 2020 2020 2020 2020 7061  rror:.        pa
-00022250: 7373 0a20 2020 2066 6f72 206c 696e 6520  ss.    for line 
-00022260: 696e 2073 6f75 7263 653a 0a20 2020 2020  in source:.     
-00022270: 2020 2074 6f6b 656e 7320 3d20 6c69 6e65     tokens = line
-00022280: 2e72 7374 7269 7028 225c 6e22 292e 7370  .rstrip("\n").sp
-00022290: 6c69 7428 7365 7029 0a20 2020 2020 2020  lit(sep).       
-000222a0: 2069 6620 6c65 6e28 746f 6b65 6e73 2920   if len(tokens) 
-000222b0: 3e3d 2032 3a0a 2020 2020 2020 2020 2020  >= 2:.          
-000222c0: 2020 6973 5f73 616d 706c 6520 3d20 696e    is_sample = in
-000222d0: 7428 746f 6b65 6e73 5b69 735f 7361 6d70  t(tokens[is_samp
-000222e0: 6c65 5f69 6e64 6578 5d29 0a20 2020 2020  le_index]).     
-000222f0: 2020 2020 2020 2074 696d 6520 3d20 666c         time = fl
-00022300: 6f61 7428 746f 6b65 6e73 5b74 696d 655f  oat(tokens[time_
-00022310: 696e 6465 785d 290a 2020 2020 2020 2020  index]).        
-00022320: 2020 2020 666c 6167 7320 3d20 300a 2020      flags = 0.  
-00022330: 2020 2020 2020 2020 2020 6966 2069 735f            if is_
-00022340: 7361 6d70 6c65 2021 3d20 303a 0a20 2020  sample != 0:.   
-00022350: 2020 2020 2020 2020 2020 2020 2066 6c61               fla
-00022360: 6773 207c 3d20 4e4f 4445 5f49 535f 5341  gs |= NODE_IS_SA
-00022370: 4d50 4c45 0a20 2020 2020 2020 2020 2020  MPLE.           
-00022380: 2070 6f70 756c 6174 696f 6e20 3d20 4e55   population = NU
-00022390: 4c4c 0a20 2020 2020 2020 2020 2020 2069  LL.            i
-000223a0: 6620 706f 7075 6c61 7469 6f6e 5f69 6e64  f population_ind
-000223b0: 6578 2069 7320 6e6f 7420 4e6f 6e65 3a0a  ex is not None:.
-000223c0: 2020 2020 2020 2020 2020 2020 2020 2020                  
-000223d0: 706f 7075 6c61 7469 6f6e 203d 2069 6e74  population = int
-000223e0: 2874 6f6b 656e 735b 706f 7075 6c61 7469  (tokens[populati
-000223f0: 6f6e 5f69 6e64 6578 5d29 0a20 2020 2020  on_index]).     
-00022400: 2020 2020 2020 2069 6e64 6976 6964 7561         individua
-00022410: 6c20 3d20 4e55 4c4c 0a20 2020 2020 2020  l = NULL.       
-00022420: 2020 2020 2069 6620 696e 6469 7669 6475       if individu
-00022430: 616c 5f69 6e64 6578 2069 7320 6e6f 7420  al_index is not 
-00022440: 4e6f 6e65 3a0a 2020 2020 2020 2020 2020  None:.          
-00022450: 2020 2020 2020 696e 6469 7669 6475 616c        individual
-00022460: 203d 2069 6e74 2874 6f6b 656e 735b 696e   = int(tokens[in
-00022470: 6469 7669 6475 616c 5f69 6e64 6578 5d29  dividual_index])
-00022480: 0a20 2020 2020 2020 2020 2020 206d 6574  .            met
-00022490: 6164 6174 6120 3d20 6222 220a 2020 2020  adata = b"".    
-000224a0: 2020 2020 2020 2020 6966 206d 6574 6164          if metad
-000224b0: 6174 615f 696e 6465 7820 6973 206e 6f74  ata_index is not
-000224c0: 204e 6f6e 6520 616e 6420 6d65 7461 6461   None and metada
-000224d0: 7461 5f69 6e64 6578 203c 206c 656e 2874  ta_index < len(t
-000224e0: 6f6b 656e 7329 3a0a 2020 2020 2020 2020  okens):.        
-000224f0: 2020 2020 2020 2020 6d65 7461 6461 7461          metadata
-00022500: 203d 2074 6f6b 656e 735b 6d65 7461 6461   = tokens[metada
-00022510: 7461 5f69 6e64 6578 5d2e 656e 636f 6465  ta_index].encode
-00022520: 2865 6e63 6f64 696e 6729 0a20 2020 2020  (encoding).     
-00022530: 2020 2020 2020 2020 2020 2069 6620 6261             if ba
-00022540: 7365 3634 5f6d 6574 6164 6174 613a 0a20  se64_metadata:. 
-00022550: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00022560: 2020 206d 6574 6164 6174 6120 3d20 6261     metadata = ba
-00022570: 7365 3634 2e62 3634 6465 636f 6465 286d  se64.b64decode(m
-00022580: 6574 6164 6174 6129 0a20 2020 2020 2020  etadata).       
-00022590: 2020 2020 2074 6162 6c65 2e61 6464 5f72       table.add_r
-000225a0: 6f77 280a 2020 2020 2020 2020 2020 2020  ow(.            
-000225b0: 2020 2020 666c 6167 733d 666c 6167 732c      flags=flags,
-000225c0: 0a20 2020 2020 2020 2020 2020 2020 2020  .               
-000225d0: 2074 696d 653d 7469 6d65 2c0a 2020 2020   time=time,.    
-000225e0: 2020 2020 2020 2020 2020 2020 706f 7075              popu
-000225f0: 6c61 7469 6f6e 3d70 6f70 756c 6174 696f  lation=populatio
-00022600: 6e2c 0a20 2020 2020 2020 2020 2020 2020  n,.             
-00022610: 2020 2069 6e64 6976 6964 7561 6c3d 696e     individual=in
-00022620: 6469 7669 6475 616c 2c0a 2020 2020 2020  dividual,.      
-00022630: 2020 2020 2020 2020 2020 6d65 7461 6461            metada
-00022640: 7461 3d6d 6574 6164 6174 612c 0a20 2020  ta=metadata,.   
-00022650: 2020 2020 2020 2020 2029 0a20 2020 2072           ).    r
-00022660: 6574 7572 6e20 7461 626c 650a 0a0a 6465  eturn table...de
-00022670: 6620 7061 7273 655f 6564 6765 7328 736f  f parse_edges(so
-00022680: 7572 6365 2c20 7374 7269 6374 3d54 7275  urce, strict=Tru
-00022690: 652c 2074 6162 6c65 3d4e 6f6e 6529 3a0a  e, table=None):.
-000226a0: 2020 2020 2222 220a 2020 2020 5061 7273      """.    Pars
-000226b0: 6520 7468 6520 7370 6563 6966 6965 6420  e the specified 
-000226c0: 6669 6c65 2d6c 696b 6520 6f62 6a65 6374  file-like object
-000226d0: 2063 6f6e 7461 696e 696e 6720 6120 7768   containing a wh
-000226e0: 6974 6573 7061 6365 2064 656c 696d 6974  itespace delimit
-000226f0: 6564 0a20 2020 2064 6573 6372 6970 7469  ed.    descripti
-00022700: 6f6e 206f 6620 6120 6564 6765 2074 6162  on of a edge tab
-00022710: 6c65 2061 6e64 2072 6574 7572 6e73 2074  le and returns t
-00022720: 6865 2063 6f72 7265 7370 6f6e 6469 6e67  he corresponding
-00022730: 203a 636c 6173 733a 6045 6467 6554 6162   :class:`EdgeTab
-00022740: 6c65 600a 2020 2020 696e 7374 616e 6365  le`.    instance
-00022750: 2e20 5365 6520 7468 6520 3a72 6566 3a60  . See the :ref:`
-00022760: 6564 6765 2074 6578 7420 666f 726d 6174  edge text format
-00022770: 203c 7365 635f 6564 6765 5f74 6578 745f   <sec_edge_text_
-00022780: 666f 726d 6174 3e60 2073 6563 7469 6f6e  format>` section
-00022790: 0a20 2020 2066 6f72 2074 6865 2064 6574  .    for the det
-000227a0: 6169 6c73 206f 6620 7468 6520 7265 7175  ails of the requ
-000227b0: 6972 6564 2066 6f72 6d61 7420 616e 6420  ired format and 
-000227c0: 7468 650a 2020 2020 3a72 6566 3a60 6564  the.    :ref:`ed
-000227d0: 6765 2074 6162 6c65 2064 6566 696e 6974  ge table definit
-000227e0: 696f 6e20 3c73 6563 5f65 6467 655f 7461  ion <sec_edge_ta
-000227f0: 626c 655f 6465 6669 6e69 7469 6f6e 3e60  ble_definition>`
-00022800: 2073 6563 7469 6f6e 2066 6f72 2074 6865   section for the
-00022810: 0a20 2020 2072 6571 7569 7265 6420 7072  .    required pr
-00022820: 6f70 6572 7469 6573 206f 6620 7468 6520  operties of the 
-00022830: 636f 6e74 656e 7473 2e0a 0a20 2020 2053  contents...    S
-00022840: 6565 203a 6675 6e63 3a60 7473 6b69 742e  ee :func:`tskit.
-00022850: 6c6f 6164 5f74 6578 7460 2066 6f72 2061  load_text` for a
-00022860: 2064 6574 6169 6c65 6420 6578 706c 616e   detailed explan
-00022870: 6174 696f 6e20 6f66 2074 6865 2060 6073  ation of the ``s
-00022880: 7472 6963 7460 6020 7061 7261 6d65 7465  trict`` paramete
-00022890: 722e 0a0a 2020 2020 3a70 6172 616d 2069  r...    :param i
-000228a0: 6f2e 5465 7874 494f 4261 7365 2073 6f75  o.TextIOBase sou
-000228b0: 7263 653a 2054 6865 2066 696c 652d 6c69  rce: The file-li
-000228c0: 6b65 206f 626a 6563 7420 636f 6e74 6169  ke object contai
-000228d0: 6e69 6e67 2074 6865 2074 6578 742e 0a20  ning the text.. 
-000228e0: 2020 203a 7061 7261 6d20 626f 6f6c 2073     :param bool s
-000228f0: 7472 6963 743a 2049 6620 5472 7565 2c20  trict: If True, 
-00022900: 7265 7175 6972 6520 7374 7269 6374 2074  require strict t
-00022910: 6162 2064 656c 696d 6974 696e 6720 2864  ab delimiting (d
-00022920: 6566 6175 6c74 292e 2049 660a 2020 2020  efault). If.    
-00022930: 2020 2020 4661 6c73 652c 2061 2072 656c      False, a rel
-00022940: 6178 6564 2077 6869 7465 7370 6163 6520  axed whitespace 
-00022950: 7370 6c69 7474 696e 6720 616c 676f 7269  splitting algori
-00022960: 7468 6d20 6973 2075 7365 642e 0a20 2020  thm is used..   
-00022970: 203a 7061 7261 6d20 4564 6765 5461 626c   :param EdgeTabl
-00022980: 6520 7461 626c 653a 2049 6620 7370 6563  e table: If spec
-00022990: 6966 6965 642c 2077 7269 7465 2074 6865  ified, write the
-000229a0: 2065 6467 6573 2069 6e74 6f20 7468 6973   edges into this
-000229b0: 2074 6162 6c65 2e20 4966 0a20 2020 2020   table. If.     
-000229c0: 2020 206e 6f74 2c20 6372 6561 7465 2061     not, create a
-000229d0: 206e 6577 203a 636c 6173 733a 6045 6467   new :class:`Edg
-000229e0: 6554 6162 6c65 6020 696e 7374 616e 6365  eTable` instance
-000229f0: 2061 6e64 2072 6574 7572 6e2e 0a20 2020   and return..   
-00022a00: 2022 2222 0a20 2020 2073 6570 203d 204e   """.    sep = N
-00022a10: 6f6e 650a 2020 2020 6966 2073 7472 6963  one.    if stric
-00022a20: 743a 0a20 2020 2020 2020 2073 6570 203d  t:.        sep =
-00022a30: 2022 5c74 220a 2020 2020 6966 2074 6162   "\t".    if tab
-00022a40: 6c65 2069 7320 4e6f 6e65 3a0a 2020 2020  le is None:.    
-00022a50: 2020 2020 7461 626c 6520 3d20 7461 626c      table = tabl
-00022a60: 6573 2e45 6467 6554 6162 6c65 2829 0a20  es.EdgeTable(). 
-00022a70: 2020 2068 6561 6465 7220 3d20 736f 7572     header = sour
-00022a80: 6365 2e72 6561 646c 696e 6528 292e 7273  ce.readline().rs
-00022a90: 7472 6970 2822 5c6e 2229 2e73 706c 6974  trip("\n").split
-00022aa0: 2873 6570 290a 2020 2020 6c65 6674 5f69  (sep).    left_i
-00022ab0: 6e64 6578 203d 2068 6561 6465 722e 696e  ndex = header.in
-00022ac0: 6465 7828 226c 6566 7422 290a 2020 2020  dex("left").    
-00022ad0: 7269 6768 745f 696e 6465 7820 3d20 6865  right_index = he
-00022ae0: 6164 6572 2e69 6e64 6578 2822 7269 6768  ader.index("righ
-00022af0: 7422 290a 2020 2020 7061 7265 6e74 5f69  t").    parent_i
-00022b00: 6e64 6578 203d 2068 6561 6465 722e 696e  ndex = header.in
-00022b10: 6465 7828 2270 6172 656e 7422 290a 2020  dex("parent").  
-00022b20: 2020 6368 696c 6472 656e 5f69 6e64 6578    children_index
-00022b30: 203d 2068 6561 6465 722e 696e 6465 7828   = header.index(
-00022b40: 2263 6869 6c64 2229 0a20 2020 2066 6f72  "child").    for
-00022b50: 206c 696e 6520 696e 2073 6f75 7263 653a   line in source:
-00022b60: 0a20 2020 2020 2020 2074 6f6b 656e 7320  .        tokens 
-00022b70: 3d20 6c69 6e65 2e72 7374 7269 7028 225c  = line.rstrip("\
-00022b80: 6e22 292e 7370 6c69 7428 7365 7029 0a20  n").split(sep). 
-00022b90: 2020 2020 2020 2069 6620 6c65 6e28 746f         if len(to
-00022ba0: 6b65 6e73 2920 3e3d 2034 3a0a 2020 2020  kens) >= 4:.    
-00022bb0: 2020 2020 2020 2020 6c65 6674 203d 2066          left = f
-00022bc0: 6c6f 6174 2874 6f6b 656e 735b 6c65 6674  loat(tokens[left
-00022bd0: 5f69 6e64 6578 5d29 0a20 2020 2020 2020  _index]).       
-00022be0: 2020 2020 2072 6967 6874 203d 2066 6c6f       right = flo
-00022bf0: 6174 2874 6f6b 656e 735b 7269 6768 745f  at(tokens[right_
-00022c00: 696e 6465 785d 290a 2020 2020 2020 2020  index]).        
-00022c10: 2020 2020 7061 7265 6e74 203d 2069 6e74      parent = int
-00022c20: 2874 6f6b 656e 735b 7061 7265 6e74 5f69  (tokens[parent_i
-00022c30: 6e64 6578 5d29 0a20 2020 2020 2020 2020  ndex]).         
-00022c40: 2020 2063 6869 6c64 7265 6e20 3d20 7475     children = tu
-00022c50: 706c 6528 6d61 7028 696e 742c 2074 6f6b  ple(map(int, tok
-00022c60: 656e 735b 6368 696c 6472 656e 5f69 6e64  ens[children_ind
-00022c70: 6578 5d2e 7370 6c69 7428 222c 2229 2929  ex].split(",")))
-00022c80: 0a20 2020 2020 2020 2020 2020 2066 6f72  .            for
-00022c90: 2063 6869 6c64 2069 6e20 6368 696c 6472   child in childr
-00022ca0: 656e 3a0a 2020 2020 2020 2020 2020 2020  en:.            
-00022cb0: 2020 2020 7461 626c 652e 6164 645f 726f      table.add_ro
-00022cc0: 7728 6c65 6674 3d6c 6566 742c 2072 6967  w(left=left, rig
-00022cd0: 6874 3d72 6967 6874 2c20 7061 7265 6e74  ht=right, parent
-00022ce0: 3d70 6172 656e 742c 2063 6869 6c64 3d63  =parent, child=c
-00022cf0: 6869 6c64 290a 2020 2020 7265 7475 726e  hild).    return
-00022d00: 2074 6162 6c65 0a0a 0a64 6566 2070 6172   table...def par
-00022d10: 7365 5f73 6974 6573 2873 6f75 7263 652c  se_sites(source,
-00022d20: 2073 7472 6963 743d 5472 7565 2c20 656e   strict=True, en
-00022d30: 636f 6469 6e67 3d22 7574 6638 222c 2062  coding="utf8", b
-00022d40: 6173 6536 345f 6d65 7461 6461 7461 3d54  ase64_metadata=T
-00022d50: 7275 652c 2074 6162 6c65 3d4e 6f6e 6529  rue, table=None)
-00022d60: 3a0a 2020 2020 2222 220a 2020 2020 5061  :.    """.    Pa
-00022d70: 7273 6520 7468 6520 7370 6563 6966 6965  rse the specifie
-00022d80: 6420 6669 6c65 2d6c 696b 6520 6f62 6a65  d file-like obje
-00022d90: 6374 2063 6f6e 7461 696e 696e 6720 6120  ct containing a 
-00022da0: 7768 6974 6573 7061 6365 2064 656c 696d  whitespace delim
-00022db0: 6974 6564 0a20 2020 2064 6573 6372 6970  ited.    descrip
-00022dc0: 7469 6f6e 206f 6620 6120 7369 7465 2074  tion of a site t
-00022dd0: 6162 6c65 2061 6e64 2072 6574 7572 6e73  able and returns
-00022de0: 2074 6865 2063 6f72 7265 7370 6f6e 6469   the correspondi
-00022df0: 6e67 203a 636c 6173 733a 6053 6974 6554  ng :class:`SiteT
-00022e00: 6162 6c65 600a 2020 2020 696e 7374 616e  able`.    instan
-00022e10: 6365 2e20 5365 6520 7468 6520 3a72 6566  ce. See the :ref
-00022e20: 3a60 7369 7465 2074 6578 7420 666f 726d  :`site text form
-00022e30: 6174 203c 7365 635f 7369 7465 5f74 6578  at <sec_site_tex
-00022e40: 745f 666f 726d 6174 3e60 2073 6563 7469  t_format>` secti
-00022e50: 6f6e 0a20 2020 2066 6f72 2074 6865 2064  on.    for the d
-00022e60: 6574 6169 6c73 206f 6620 7468 6520 7265  etails of the re
-00022e70: 7175 6972 6564 2066 6f72 6d61 7420 616e  quired format an
-00022e80: 6420 7468 650a 2020 2020 3a72 6566 3a60  d the.    :ref:`
-00022e90: 7369 7465 2074 6162 6c65 2064 6566 696e  site table defin
-00022ea0: 6974 696f 6e20 3c73 6563 5f73 6974 655f  ition <sec_site_
-00022eb0: 7461 626c 655f 6465 6669 6e69 7469 6f6e  table_definition
-00022ec0: 3e60 2073 6563 7469 6f6e 2066 6f72 2074  >` section for t
-00022ed0: 6865 0a20 2020 2072 6571 7569 7265 6420  he.    required 
-00022ee0: 7072 6f70 6572 7469 6573 206f 6620 7468  properties of th
-00022ef0: 6520 636f 6e74 656e 7473 2e0a 0a20 2020  e contents...   
-00022f00: 2053 6565 203a 6675 6e63 3a60 7473 6b69   See :func:`tski
-00022f10: 742e 6c6f 6164 5f74 6578 7460 2066 6f72  t.load_text` for
-00022f20: 2061 2064 6574 6169 6c65 6420 6578 706c   a detailed expl
-00022f30: 616e 6174 696f 6e20 6f66 2074 6865 2060  anation of the `
-00022f40: 6073 7472 6963 7460 600a 2020 2020 7061  `strict``.    pa
-00022f50: 7261 6d65 7465 722e 0a0a 2020 2020 3a70  rameter...    :p
-00022f60: 6172 616d 2069 6f2e 5465 7874 494f 4261  aram io.TextIOBa
-00022f70: 7365 2073 6f75 7263 653a 2054 6865 2066  se source: The f
-00022f80: 696c 652d 6c69 6b65 206f 626a 6563 7420  ile-like object 
-00022f90: 636f 6e74 6169 6e69 6e67 2074 6865 2074  containing the t
-00022fa0: 6578 742e 0a20 2020 203a 7061 7261 6d20  ext..    :param 
-00022fb0: 626f 6f6c 2073 7472 6963 743a 2049 6620  bool strict: If 
-00022fc0: 5472 7565 2c20 7265 7175 6972 6520 7374  True, require st
-00022fd0: 7269 6374 2074 6162 2064 656c 696d 6974  rict tab delimit
-00022fe0: 696e 6720 2864 6566 6175 6c74 292e 2049  ing (default). I
-00022ff0: 660a 2020 2020 2020 2020 4661 6c73 652c  f.        False,
-00023000: 2061 2072 656c 6178 6564 2077 6869 7465   a relaxed white
-00023010: 7370 6163 6520 7370 6c69 7474 696e 6720  space splitting 
-00023020: 616c 676f 7269 7468 6d20 6973 2075 7365  algorithm is use
-00023030: 642e 0a20 2020 203a 7061 7261 6d20 7374  d..    :param st
-00023040: 7220 656e 636f 6469 6e67 3a20 456e 636f  r encoding: Enco
-00023050: 6469 6e67 2075 7365 6420 666f 7220 7465  ding used for te
-00023060: 7874 2072 6570 7265 7365 6e74 6174 696f  xt representatio
-00023070: 6e2e 0a20 2020 203a 7061 7261 6d20 626f  n..    :param bo
-00023080: 6f6c 2062 6173 6536 345f 6d65 7461 6461  ol base64_metada
-00023090: 7461 3a20 4966 2054 7275 652c 206d 6574  ta: If True, met
-000230a0: 6164 6174 6120 6973 2065 6e63 6f64 6564  adata is encoded
-000230b0: 2075 7369 6e67 2042 6173 6536 340a 2020   using Base64.  
-000230c0: 2020 2020 2020 656e 636f 6469 6e67 3b20        encoding; 
-000230d0: 6f74 6865 7277 6973 652c 2061 7320 706c  otherwise, as pl
-000230e0: 6169 6e20 7465 7874 2e0a 2020 2020 3a70  ain text..    :p
-000230f0: 6172 616d 2053 6974 6554 6162 6c65 2074  aram SiteTable t
-00023100: 6162 6c65 3a20 4966 2073 7065 6369 6669  able: If specifi
-00023110: 6564 2077 7269 7465 2073 6974 6520 696e  ed write site in
-00023120: 746f 2074 6869 7320 7461 626c 652e 2049  to this table. I
-00023130: 6620 6e6f 742c 0a20 2020 2020 2020 2063  f not,.        c
-00023140: 7265 6174 6520 6120 6e65 7720 3a63 6c61  reate a new :cla
-00023150: 7373 3a60 5369 7465 5461 626c 6560 2069  ss:`SiteTable` i
-00023160: 6e73 7461 6e63 652e 0a20 2020 2022 2222  nstance..    """
-00023170: 0a20 2020 2073 6570 203d 204e 6f6e 650a  .    sep = None.
-00023180: 2020 2020 6966 2073 7472 6963 743a 0a20      if strict:. 
-00023190: 2020 2020 2020 2073 6570 203d 2022 5c74         sep = "\t
-000231a0: 220a 2020 2020 6966 2074 6162 6c65 2069  ".    if table i
-000231b0: 7320 4e6f 6e65 3a0a 2020 2020 2020 2020  s None:.        
-000231c0: 7461 626c 6520 3d20 7461 626c 6573 2e53  table = tables.S
-000231d0: 6974 6554 6162 6c65 2829 0a20 2020 2068  iteTable().    h
-000231e0: 6561 6465 7220 3d20 736f 7572 6365 2e72  eader = source.r
-000231f0: 6561 646c 696e 6528 292e 7273 7472 6970  eadline().rstrip
-00023200: 2822 5c6e 2229 2e73 706c 6974 2873 6570  ("\n").split(sep
-00023210: 290a 2020 2020 706f 7369 7469 6f6e 5f69  ).    position_i
-00023220: 6e64 6578 203d 2068 6561 6465 722e 696e  ndex = header.in
-00023230: 6465 7828 2270 6f73 6974 696f 6e22 290a  dex("position").
-00023240: 2020 2020 616e 6365 7374 7261 6c5f 7374      ancestral_st
-00023250: 6174 655f 696e 6465 7820 3d20 6865 6164  ate_index = head
-00023260: 6572 2e69 6e64 6578 2822 616e 6365 7374  er.index("ancest
-00023270: 7261 6c5f 7374 6174 6522 290a 2020 2020  ral_state").    
-00023280: 6d65 7461 6461 7461 5f69 6e64 6578 203d  metadata_index =
-00023290: 204e 6f6e 650a 2020 2020 7472 793a 0a20   None.    try:. 
-000232a0: 2020 2020 2020 206d 6574 6164 6174 615f         metadata_
-000232b0: 696e 6465 7820 3d20 6865 6164 6572 2e69  index = header.i
-000232c0: 6e64 6578 2822 6d65 7461 6461 7461 2229  ndex("metadata")
-000232d0: 0a20 2020 2065 7863 6570 7420 5661 6c75  .    except Valu
-000232e0: 6545 7272 6f72 3a0a 2020 2020 2020 2020  eError:.        
-000232f0: 7061 7373 0a20 2020 2066 6f72 206c 696e  pass.    for lin
-00023300: 6520 696e 2073 6f75 7263 653a 0a20 2020  e in source:.   
-00023310: 2020 2020 2074 6f6b 656e 7320 3d20 6c69       tokens = li
-00023320: 6e65 2e72 7374 7269 7028 225c 6e22 292e  ne.rstrip("\n").
-00023330: 7370 6c69 7428 7365 7029 0a20 2020 2020  split(sep).     
-00023340: 2020 2069 6620 6c65 6e28 746f 6b65 6e73     if len(tokens
-00023350: 2920 3e3d 2032 3a0a 2020 2020 2020 2020  ) >= 2:.        
-00023360: 2020 2020 706f 7369 7469 6f6e 203d 2066      position = f
-00023370: 6c6f 6174 2874 6f6b 656e 735b 706f 7369  loat(tokens[posi
-00023380: 7469 6f6e 5f69 6e64 6578 5d29 0a20 2020  tion_index]).   
-00023390: 2020 2020 2020 2020 2061 6e63 6573 7472           ancestr
-000233a0: 616c 5f73 7461 7465 203d 2074 6f6b 656e  al_state = token
-000233b0: 735b 616e 6365 7374 7261 6c5f 7374 6174  s[ancestral_stat
-000233c0: 655f 696e 6465 785d 0a20 2020 2020 2020  e_index].       
-000233d0: 2020 2020 206d 6574 6164 6174 6120 3d20       metadata = 
-000233e0: 6222 220a 2020 2020 2020 2020 2020 2020  b"".            
-000233f0: 6966 206d 6574 6164 6174 615f 696e 6465  if metadata_inde
-00023400: 7820 6973 206e 6f74 204e 6f6e 6520 616e  x is not None an
-00023410: 6420 6d65 7461 6461 7461 5f69 6e64 6578  d metadata_index
-00023420: 203c 206c 656e 2874 6f6b 656e 7329 3a0a   < len(tokens):.
-00023430: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00023440: 6d65 7461 6461 7461 203d 2074 6f6b 656e  metadata = token
-00023450: 735b 6d65 7461 6461 7461 5f69 6e64 6578  s[metadata_index
-00023460: 5d2e 656e 636f 6465 2865 6e63 6f64 696e  ].encode(encodin
-00023470: 6729 0a20 2020 2020 2020 2020 2020 2020  g).             
-00023480: 2020 2069 6620 6261 7365 3634 5f6d 6574     if base64_met
-00023490: 6164 6174 613a 0a20 2020 2020 2020 2020  adata:.         
-000234a0: 2020 2020 2020 2020 2020 206d 6574 6164             metad
-000234b0: 6174 6120 3d20 6261 7365 3634 2e62 3634  ata = base64.b64
-000234c0: 6465 636f 6465 286d 6574 6164 6174 6129  decode(metadata)
-000234d0: 0a20 2020 2020 2020 2020 2020 2074 6162  .            tab
-000234e0: 6c65 2e61 6464 5f72 6f77 280a 2020 2020  le.add_row(.    
-000234f0: 2020 2020 2020 2020 2020 2020 706f 7369              posi
-00023500: 7469 6f6e 3d70 6f73 6974 696f 6e2c 2061  tion=position, a
-00023510: 6e63 6573 7472 616c 5f73 7461 7465 3d61  ncestral_state=a
-00023520: 6e63 6573 7472 616c 5f73 7461 7465 2c20  ncestral_state, 
-00023530: 6d65 7461 6461 7461 3d6d 6574 6164 6174  metadata=metadat
-00023540: 610a 2020 2020 2020 2020 2020 2020 290a  a.            ).
-00023550: 2020 2020 7265 7475 726e 2074 6162 6c65      return table
-00023560: 0a0a 0a64 6566 2070 6172 7365 5f6d 7574  ...def parse_mut
-00023570: 6174 696f 6e73 280a 2020 2020 736f 7572  ations(.    sour
-00023580: 6365 2c20 7374 7269 6374 3d54 7275 652c  ce, strict=True,
-00023590: 2065 6e63 6f64 696e 673d 2275 7466 3822   encoding="utf8"
-000235a0: 2c20 6261 7365 3634 5f6d 6574 6164 6174  , base64_metadat
-000235b0: 613d 5472 7565 2c20 7461 626c 653d 4e6f  a=True, table=No
-000235c0: 6e65 0a29 3a0a 2020 2020 2222 220a 2020  ne.):.    """.  
-000235d0: 2020 5061 7273 6520 7468 6520 7370 6563    Parse the spec
-000235e0: 6966 6965 6420 6669 6c65 2d6c 696b 6520  ified file-like 
-000235f0: 6f62 6a65 6374 2063 6f6e 7461 696e 696e  object containin
-00023600: 6720 6120 7768 6974 6573 7061 6365 2064  g a whitespace d
-00023610: 656c 696d 6974 6564 0a20 2020 2064 6573  elimited.    des
-00023620: 6372 6970 7469 6f6e 206f 6620 6120 6d75  cription of a mu
-00023630: 7461 7469 6f6e 2074 6162 6c65 2061 6e64  tation table and
-00023640: 2072 6574 7572 6e73 2074 6865 2063 6f72   returns the cor
-00023650: 7265 7370 6f6e 6469 6e67 203a 636c 6173  responding :clas
-00023660: 733a 604d 7574 6174 696f 6e54 6162 6c65  s:`MutationTable
-00023670: 600a 2020 2020 696e 7374 616e 6365 2e20  `.    instance. 
-00023680: 5365 6520 7468 6520 3a72 6566 3a60 6d75  See the :ref:`mu
-00023690: 7461 7469 6f6e 2074 6578 7420 666f 726d  tation text form
-000236a0: 6174 203c 7365 635f 6d75 7461 7469 6f6e  at <sec_mutation
-000236b0: 5f74 6578 745f 666f 726d 6174 3e60 2073  _text_format>` s
-000236c0: 6563 7469 6f6e 0a20 2020 2066 6f72 2074  ection.    for t
-000236d0: 6865 2064 6574 6169 6c73 206f 6620 7468  he details of th
-000236e0: 6520 7265 7175 6972 6564 2066 6f72 6d61  e required forma
-000236f0: 7420 616e 6420 7468 650a 2020 2020 3a72  t and the.    :r
-00023700: 6566 3a60 6d75 7461 7469 6f6e 2074 6162  ef:`mutation tab
-00023710: 6c65 2064 6566 696e 6974 696f 6e20 3c73  le definition <s
-00023720: 6563 5f6d 7574 6174 696f 6e5f 7461 626c  ec_mutation_tabl
-00023730: 655f 6465 6669 6e69 7469 6f6e 3e60 2073  e_definition>` s
-00023740: 6563 7469 6f6e 2066 6f72 2074 6865 0a20  ection for the. 
-00023750: 2020 2072 6571 7569 7265 6420 7072 6f70     required prop
-00023760: 6572 7469 6573 206f 6620 7468 6520 636f  erties of the co
-00023770: 6e74 656e 7473 2e20 4e6f 7465 2074 6861  ntents. Note tha
-00023780: 7420 6966 2074 6865 2060 6074 696d 6560  t if the ``time`
-00023790: 6020 636f 6c75 6d6e 2069 7320 6d69 7373  ` column is miss
-000237a0: 696e 6720 6974 730a 2020 2020 656e 7472  ing its.    entr
-000237b0: 6965 7320 6172 6520 6669 6c6c 6564 2077  ies are filled w
-000237c0: 6974 6820 6060 554e 4b4e 4f57 4e5f 5449  ith ``UNKNOWN_TI
-000237d0: 4d45 6060 2e0a 0a20 2020 2053 6565 203a  ME``...    See :
-000237e0: 6675 6e63 3a60 7473 6b69 742e 6c6f 6164  func:`tskit.load
-000237f0: 5f74 6578 7460 2066 6f72 2061 2064 6574  _text` for a det
-00023800: 6169 6c65 6420 6578 706c 616e 6174 696f  ailed explanatio
-00023810: 6e20 6f66 2074 6865 2060 6073 7472 6963  n of the ``stric
-00023820: 7460 600a 2020 2020 7061 7261 6d65 7465  t``.    paramete
-00023830: 722e 0a0a 2020 2020 3a70 6172 616d 2069  r...    :param i
-00023840: 6f2e 5465 7874 494f 4261 7365 2073 6f75  o.TextIOBase sou
-00023850: 7263 653a 2054 6865 2066 696c 652d 6c69  rce: The file-li
-00023860: 6b65 206f 626a 6563 7420 636f 6e74 6169  ke object contai
-00023870: 6e69 6e67 2074 6865 2074 6578 742e 0a20  ning the text.. 
-00023880: 2020 203a 7061 7261 6d20 626f 6f6c 2073     :param bool s
-00023890: 7472 6963 743a 2049 6620 5472 7565 2c20  trict: If True, 
-000238a0: 7265 7175 6972 6520 7374 7269 6374 2074  require strict t
-000238b0: 6162 2064 656c 696d 6974 696e 6720 2864  ab delimiting (d
-000238c0: 6566 6175 6c74 292e 2049 660a 2020 2020  efault). If.    
-000238d0: 2020 2020 4661 6c73 652c 2061 2072 656c      False, a rel
-000238e0: 6178 6564 2077 6869 7465 7370 6163 6520  axed whitespace 
-000238f0: 7370 6c69 7474 696e 6720 616c 676f 7269  splitting algori
-00023900: 7468 6d20 6973 2075 7365 642e 0a20 2020  thm is used..   
-00023910: 203a 7061 7261 6d20 7374 7220 656e 636f   :param str enco
-00023920: 6469 6e67 3a20 456e 636f 6469 6e67 2075  ding: Encoding u
-00023930: 7365 6420 666f 7220 7465 7874 2072 6570  sed for text rep
-00023940: 7265 7365 6e74 6174 696f 6e2e 0a20 2020  resentation..   
-00023950: 203a 7061 7261 6d20 626f 6f6c 2062 6173   :param bool bas
-00023960: 6536 345f 6d65 7461 6461 7461 3a20 4966  e64_metadata: If
-00023970: 2054 7275 652c 206d 6574 6164 6174 6120   True, metadata 
-00023980: 6973 2065 6e63 6f64 6564 2075 7369 6e67  is encoded using
-00023990: 2042 6173 6536 340a 2020 2020 2020 2020   Base64.        
-000239a0: 656e 636f 6469 6e67 3b20 6f74 6865 7277  encoding; otherw
-000239b0: 6973 652c 2061 7320 706c 6169 6e20 7465  ise, as plain te
-000239c0: 7874 2e0a 2020 2020 3a70 6172 616d 204d  xt..    :param M
-000239d0: 7574 6174 696f 6e54 6162 6c65 2074 6162  utationTable tab
-000239e0: 6c65 3a20 4966 2073 7065 6369 6669 6564  le: If specified
-000239f0: 2c20 7772 6974 6520 6d75 7461 7469 6f6e  , write mutation
-00023a00: 7320 696e 746f 2074 6869 7320 7461 626c  s into this tabl
-00023a10: 652e 0a20 2020 2020 2020 2049 6620 6e6f  e..        If no
-00023a20: 742c 2063 7265 6174 6520 6120 6e65 7720  t, create a new 
-00023a30: 3a63 6c61 7373 3a60 4d75 7461 7469 6f6e  :class:`Mutation
-00023a40: 5461 626c 6560 2069 6e73 7461 6e63 652e  Table` instance.
-00023a50: 0a20 2020 2022 2222 0a20 2020 2073 6570  .    """.    sep
-00023a60: 203d 204e 6f6e 650a 2020 2020 6966 2073   = None.    if s
-00023a70: 7472 6963 743a 0a20 2020 2020 2020 2073  trict:.        s
-00023a80: 6570 203d 2022 5c74 220a 2020 2020 6966  ep = "\t".    if
-00023a90: 2074 6162 6c65 2069 7320 4e6f 6e65 3a0a   table is None:.
-00023aa0: 2020 2020 2020 2020 7461 626c 6520 3d20          table = 
-00023ab0: 7461 626c 6573 2e4d 7574 6174 696f 6e54  tables.MutationT
-00023ac0: 6162 6c65 2829 0a20 2020 2068 6561 6465  able().    heade
-00023ad0: 7220 3d20 736f 7572 6365 2e72 6561 646c  r = source.readl
-00023ae0: 696e 6528 292e 7273 7472 6970 2822 5c6e  ine().rstrip("\n
-00023af0: 2229 2e73 706c 6974 2873 6570 290a 2020  ").split(sep).  
-00023b00: 2020 7369 7465 5f69 6e64 6578 203d 2068    site_index = h
-00023b10: 6561 6465 722e 696e 6465 7828 2273 6974  eader.index("sit
-00023b20: 6522 290a 2020 2020 6e6f 6465 5f69 6e64  e").    node_ind
-00023b30: 6578 203d 2068 6561 6465 722e 696e 6465  ex = header.inde
-00023b40: 7828 226e 6f64 6522 290a 2020 2020 7472  x("node").    tr
-00023b50: 793a 0a20 2020 2020 2020 2074 696d 655f  y:.        time_
-00023b60: 696e 6465 7820 3d20 6865 6164 6572 2e69  index = header.i
-00023b70: 6e64 6578 2822 7469 6d65 2229 0a20 2020  ndex("time").   
-00023b80: 2065 7863 6570 7420 5661 6c75 6545 7272   except ValueErr
-00023b90: 6f72 3a0a 2020 2020 2020 2020 7469 6d65  or:.        time
-00023ba0: 5f69 6e64 6578 203d 204e 6f6e 650a 2020  _index = None.  
-00023bb0: 2020 6465 7269 7665 645f 7374 6174 655f    derived_state_
-00023bc0: 696e 6465 7820 3d20 6865 6164 6572 2e69  index = header.i
-00023bd0: 6e64 6578 2822 6465 7269 7665 645f 7374  ndex("derived_st
-00023be0: 6174 6522 290a 2020 2020 7061 7265 6e74  ate").    parent
-00023bf0: 5f69 6e64 6578 203d 204e 6f6e 650a 2020  _index = None.  
-00023c00: 2020 7061 7265 6e74 203d 204e 554c 4c0a    parent = NULL.
-00023c10: 2020 2020 7472 793a 0a20 2020 2020 2020      try:.       
-00023c20: 2070 6172 656e 745f 696e 6465 7820 3d20   parent_index = 
-00023c30: 6865 6164 6572 2e69 6e64 6578 2822 7061  header.index("pa
-00023c40: 7265 6e74 2229 0a20 2020 2065 7863 6570  rent").    excep
-00023c50: 7420 5661 6c75 6545 7272 6f72 3a0a 2020  t ValueError:.  
-00023c60: 2020 2020 2020 7061 7373 0a20 2020 206d        pass.    m
-00023c70: 6574 6164 6174 615f 696e 6465 7820 3d20  etadata_index = 
-00023c80: 4e6f 6e65 0a20 2020 2074 7279 3a0a 2020  None.    try:.  
-00023c90: 2020 2020 2020 6d65 7461 6461 7461 5f69        metadata_i
-00023ca0: 6e64 6578 203d 2068 6561 6465 722e 696e  ndex = header.in
-00023cb0: 6465 7828 226d 6574 6164 6174 6122 290a  dex("metadata").
-00023cc0: 2020 2020 6578 6365 7074 2056 616c 7565      except Value
-00023cd0: 4572 726f 723a 0a20 2020 2020 2020 2070  Error:.        p
-00023ce0: 6173 730a 2020 2020 666f 7220 6c69 6e65  ass.    for line
-00023cf0: 2069 6e20 736f 7572 6365 3a0a 2020 2020   in source:.    
-00023d00: 2020 2020 746f 6b65 6e73 203d 206c 696e      tokens = lin
-00023d10: 652e 7273 7472 6970 2822 5c6e 2229 2e73  e.rstrip("\n").s
-00023d20: 706c 6974 2873 6570 290a 2020 2020 2020  plit(sep).      
-00023d30: 2020 6966 206c 656e 2874 6f6b 656e 7329    if len(tokens)
-00023d40: 203e 3d20 333a 0a20 2020 2020 2020 2020   >= 3:.         
-00023d50: 2020 2073 6974 6520 3d20 696e 7428 746f     site = int(to
-00023d60: 6b65 6e73 5b73 6974 655f 696e 6465 785d  kens[site_index]
-00023d70: 290a 2020 2020 2020 2020 2020 2020 6e6f  ).            no
-00023d80: 6465 203d 2069 6e74 2874 6f6b 656e 735b  de = int(tokens[
-00023d90: 6e6f 6465 5f69 6e64 6578 5d29 0a20 2020  node_index]).   
-00023da0: 2020 2020 2020 2020 2069 6620 7469 6d65           if time
-00023db0: 5f69 6e64 6578 2069 7320 4e6f 6e65 206f  _index is None o
-00023dc0: 7220 746f 6b65 6e73 5b74 696d 655f 696e  r tokens[time_in
-00023dd0: 6465 785d 203d 3d20 7473 6b69 742e 5449  dex] == tskit.TI
-00023de0: 4d45 5f55 4e49 5453 5f55 4e4b 4e4f 574e  ME_UNITS_UNKNOWN
-00023df0: 3a0a 2020 2020 2020 2020 2020 2020 2020  :.              
-00023e00: 2020 7469 6d65 203d 2055 4e4b 4e4f 574e    time = UNKNOWN
-00023e10: 5f54 494d 450a 2020 2020 2020 2020 2020  _TIME.          
-00023e20: 2020 656c 7365 3a0a 2020 2020 2020 2020    else:.        
-00023e30: 2020 2020 2020 2020 7469 6d65 203d 2066          time = f
-00023e40: 6c6f 6174 2874 6f6b 656e 735b 7469 6d65  loat(tokens[time
-00023e50: 5f69 6e64 6578 5d29 0a20 2020 2020 2020  _index]).       
-00023e60: 2020 2020 2064 6572 6976 6564 5f73 7461       derived_sta
-00023e70: 7465 203d 2074 6f6b 656e 735b 6465 7269  te = tokens[deri
-00023e80: 7665 645f 7374 6174 655f 696e 6465 785d  ved_state_index]
-00023e90: 0a20 2020 2020 2020 2020 2020 2069 6620  .            if 
-00023ea0: 7061 7265 6e74 5f69 6e64 6578 2069 7320  parent_index is 
-00023eb0: 6e6f 7420 4e6f 6e65 3a0a 2020 2020 2020  not None:.      
-00023ec0: 2020 2020 2020 2020 2020 7061 7265 6e74            parent
-00023ed0: 203d 2069 6e74 2874 6f6b 656e 735b 7061   = int(tokens[pa
-00023ee0: 7265 6e74 5f69 6e64 6578 5d29 0a20 2020  rent_index]).   
-00023ef0: 2020 2020 2020 2020 206d 6574 6164 6174           metadat
-00023f00: 6120 3d20 6222 220a 2020 2020 2020 2020  a = b"".        
-00023f10: 2020 2020 6966 206d 6574 6164 6174 615f      if metadata_
-00023f20: 696e 6465 7820 6973 206e 6f74 204e 6f6e  index is not Non
-00023f30: 6520 616e 6420 6d65 7461 6461 7461 5f69  e and metadata_i
-00023f40: 6e64 6578 203c 206c 656e 2874 6f6b 656e  ndex < len(token
-00023f50: 7329 3a0a 2020 2020 2020 2020 2020 2020  s):.            
-00023f60: 2020 2020 6d65 7461 6461 7461 203d 2074      metadata = t
-00023f70: 6f6b 656e 735b 6d65 7461 6461 7461 5f69  okens[metadata_i
-00023f80: 6e64 6578 5d2e 656e 636f 6465 2865 6e63  ndex].encode(enc
-00023f90: 6f64 696e 6729 0a20 2020 2020 2020 2020  oding).         
-00023fa0: 2020 2020 2020 2069 6620 6261 7365 3634         if base64
-00023fb0: 5f6d 6574 6164 6174 613a 0a20 2020 2020  _metadata:.     
-00023fc0: 2020 2020 2020 2020 2020 2020 2020 206d                 m
-00023fd0: 6574 6164 6174 6120 3d20 6261 7365 3634  etadata = base64
-00023fe0: 2e62 3634 6465 636f 6465 286d 6574 6164  .b64decode(metad
-00023ff0: 6174 6129 0a20 2020 2020 2020 2020 2020  ata).           
-00024000: 2074 6162 6c65 2e61 6464 5f72 6f77 280a   table.add_row(.
-00024010: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00024020: 7369 7465 3d73 6974 652c 0a20 2020 2020  site=site,.     
-00024030: 2020 2020 2020 2020 2020 206e 6f64 653d             node=
-00024040: 6e6f 6465 2c0a 2020 2020 2020 2020 2020  node,.          
-00024050: 2020 2020 2020 7469 6d65 3d74 696d 652c        time=time,
-00024060: 0a20 2020 2020 2020 2020 2020 2020 2020  .               
-00024070: 2064 6572 6976 6564 5f73 7461 7465 3d64   derived_state=d
-00024080: 6572 6976 6564 5f73 7461 7465 2c0a 2020  erived_state,.  
-00024090: 2020 2020 2020 2020 2020 2020 2020 7061                pa
-000240a0: 7265 6e74 3d70 6172 656e 742c 0a20 2020  rent=parent,.   
-000240b0: 2020 2020 2020 2020 2020 2020 206d 6574               met
-000240c0: 6164 6174 613d 6d65 7461 6461 7461 2c0a  adata=metadata,.
-000240d0: 2020 2020 2020 2020 2020 2020 290a 2020              ).  
-000240e0: 2020 7265 7475 726e 2074 6162 6c65 0a0a    return table..
-000240f0: 0a64 6566 2070 6172 7365 5f70 6f70 756c  .def parse_popul
-00024100: 6174 696f 6e73 280a 2020 2020 736f 7572  ations(.    sour
-00024110: 6365 2c20 7374 7269 6374 3d54 7275 652c  ce, strict=True,
-00024120: 2065 6e63 6f64 696e 673d 2275 7466 3822   encoding="utf8"
-00024130: 2c20 6261 7365 3634 5f6d 6574 6164 6174  , base64_metadat
-00024140: 613d 5472 7565 2c20 7461 626c 653d 4e6f  a=True, table=No
-00024150: 6e65 0a29 3a0a 2020 2020 2222 220a 2020  ne.):.    """.  
-00024160: 2020 5061 7273 6520 7468 6520 7370 6563    Parse the spec
-00024170: 6966 6965 6420 6669 6c65 2d6c 696b 6520  ified file-like 
-00024180: 6f62 6a65 6374 2063 6f6e 7461 696e 696e  object containin
-00024190: 6720 6120 7768 6974 6573 7061 6365 2064  g a whitespace d
-000241a0: 656c 696d 6974 6564 0a20 2020 2064 6573  elimited.    des
-000241b0: 6372 6970 7469 6f6e 206f 6620 6120 706f  cription of a po
-000241c0: 7075 6c61 7469 6f6e 2074 6162 6c65 2061  pulation table a
-000241d0: 6e64 2072 6574 7572 6e73 2074 6865 2063  nd returns the c
-000241e0: 6f72 7265 7370 6f6e 6469 6e67 0a20 2020  orresponding.   
-000241f0: 203a 636c 6173 733a 6050 6f70 756c 6174   :class:`Populat
-00024200: 696f 6e54 6162 6c65 6020 696e 7374 616e  ionTable` instan
-00024210: 6365 2e20 5365 6520 7468 6520 3a72 6566  ce. See the :ref
-00024220: 3a60 706f 7075 6c61 7469 6f6e 2074 6578  :`population tex
-00024230: 7420 666f 726d 6174 0a20 2020 203c 7365  t format.    <se
-00024240: 635f 706f 7075 6c61 7469 6f6e 5f74 6578  c_population_tex
-00024250: 745f 666f 726d 6174 3e60 2073 6563 7469  t_format>` secti
-00024260: 6f6e 2066 6f72 2074 6865 2064 6574 6169  on for the detai
-00024270: 6c73 206f 6620 7468 6520 7265 7175 6972  ls of the requir
-00024280: 6564 0a20 2020 2066 6f72 6d61 7420 616e  ed.    format an
-00024290: 6420 7468 6520 3a72 6566 3a60 706f 7075  d the :ref:`popu
-000242a0: 6c61 7469 6f6e 2074 6162 6c65 2064 6566  lation table def
-000242b0: 696e 6974 696f 6e0a 2020 2020 3c73 6563  inition.    <sec
-000242c0: 5f70 6f70 756c 6174 696f 6e5f 7461 626c  _population_tabl
-000242d0: 655f 6465 6669 6e69 7469 6f6e 3e60 2073  e_definition>` s
-000242e0: 6563 7469 6f6e 2066 6f72 2074 6865 2072  ection for the r
-000242f0: 6571 7569 7265 6420 7072 6f70 6572 7469  equired properti
-00024300: 6573 206f 660a 2020 2020 7468 6520 636f  es of.    the co
-00024310: 6e74 656e 7473 2e0a 0a20 2020 2053 6565  ntents...    See
-00024320: 203a 6675 6e63 3a60 7473 6b69 742e 6c6f   :func:`tskit.lo
-00024330: 6164 5f74 6578 7460 2066 6f72 2061 2064  ad_text` for a d
-00024340: 6574 6169 6c65 6420 6578 706c 616e 6174  etailed explanat
-00024350: 696f 6e20 6f66 2074 6865 2060 6073 7472  ion of the ``str
-00024360: 6963 7460 600a 2020 2020 7061 7261 6d65  ict``.    parame
-00024370: 7465 722e 0a0a 2020 2020 3a70 6172 616d  ter...    :param
-00024380: 2069 6f2e 5465 7874 494f 4261 7365 2073   io.TextIOBase s
-00024390: 6f75 7263 653a 2054 6865 2066 696c 652d  ource: The file-
-000243a0: 6c69 6b65 206f 626a 6563 7420 636f 6e74  like object cont
-000243b0: 6169 6e69 6e67 2074 6865 2074 6578 742e  aining the text.
-000243c0: 0a20 2020 203a 7061 7261 6d20 626f 6f6c  .    :param bool
-000243d0: 2073 7472 6963 743a 2049 6620 5472 7565   strict: If True
-000243e0: 2c20 7265 7175 6972 6520 7374 7269 6374  , require strict
-000243f0: 2074 6162 2064 656c 696d 6974 696e 6720   tab delimiting 
-00024400: 2864 6566 6175 6c74 292e 2049 660a 2020  (default). If.  
-00024410: 2020 2020 2020 4661 6c73 652c 2061 2072        False, a r
-00024420: 656c 6178 6564 2077 6869 7465 7370 6163  elaxed whitespac
-00024430: 6520 7370 6c69 7474 696e 6720 616c 676f  e splitting algo
-00024440: 7269 7468 6d20 6973 2075 7365 642e 0a20  rithm is used.. 
-00024450: 2020 203a 7061 7261 6d20 7374 7220 656e     :param str en
-00024460: 636f 6469 6e67 3a20 456e 636f 6469 6e67  coding: Encoding
-00024470: 2075 7365 6420 666f 7220 7465 7874 2072   used for text r
-00024480: 6570 7265 7365 6e74 6174 696f 6e2e 0a20  epresentation.. 
-00024490: 2020 203a 7061 7261 6d20 626f 6f6c 2062     :param bool b
-000244a0: 6173 6536 345f 6d65 7461 6461 7461 3a20  ase64_metadata: 
-000244b0: 4966 2054 7275 652c 206d 6574 6164 6174  If True, metadat
-000244c0: 6120 6973 2065 6e63 6f64 6564 2075 7369  a is encoded usi
-000244d0: 6e67 2042 6173 6536 340a 2020 2020 2020  ng Base64.      
-000244e0: 2020 656e 636f 6469 6e67 3b20 6f74 6865    encoding; othe
-000244f0: 7277 6973 652c 2061 7320 706c 6169 6e20  rwise, as plain 
-00024500: 7465 7874 2e0a 2020 2020 3a70 6172 616d  text..    :param
-00024510: 2050 6f70 756c 6174 696f 6e54 6162 6c65   PopulationTable
-00024520: 2074 6162 6c65 3a20 4966 2073 7065 6369   table: If speci
-00024530: 6669 6564 2077 7269 7465 2069 6e74 6f20  fied write into 
-00024540: 7468 6973 2074 6162 6c65 2e20 4966 206e  this table. If n
-00024550: 6f74 2c0a 2020 2020 2020 2020 6372 6561  ot,.        crea
-00024560: 7465 2061 206e 6577 203a 636c 6173 733a  te a new :class:
-00024570: 6050 6f70 756c 6174 696f 6e54 6162 6c65  `PopulationTable
-00024580: 6020 696e 7374 616e 6365 2e0a 2020 2020  ` instance..    
-00024590: 2222 220a 2020 2020 7365 7020 3d20 4e6f  """.    sep = No
-000245a0: 6e65 0a20 2020 2069 6620 7374 7269 6374  ne.    if strict
-000245b0: 3a0a 2020 2020 2020 2020 7365 7020 3d20  :.        sep = 
-000245c0: 225c 7422 0a20 2020 2069 6620 7461 626c  "\t".    if tabl
-000245d0: 6520 6973 204e 6f6e 653a 0a20 2020 2020  e is None:.     
-000245e0: 2020 2074 6162 6c65 203d 2074 6162 6c65     table = table
-000245f0: 732e 506f 7075 6c61 7469 6f6e 5461 626c  s.PopulationTabl
-00024600: 6528 290a 2020 2020 2320 5265 6164 2074  e().    # Read t
-00024610: 6865 2068 6561 6465 7220 616e 6420 6669  he header and fi
-00024620: 6e64 2074 6865 2069 6e64 6578 6573 206f  nd the indexes o
-00024630: 6620 7468 6520 7265 7175 6972 6564 2066  f the required f
-00024640: 6965 6c64 732e 0a20 2020 2068 6561 6465  ields..    heade
-00024650: 7220 3d20 736f 7572 6365 2e72 6561 646c  r = source.readl
-00024660: 696e 6528 292e 7273 7472 6970 2822 5c6e  ine().rstrip("\n
-00024670: 2229 2e73 706c 6974 2873 6570 290a 2020  ").split(sep).  
-00024680: 2020 6d65 7461 6461 7461 5f69 6e64 6578    metadata_index
-00024690: 203d 2068 6561 6465 722e 696e 6465 7828   = header.index(
-000246a0: 226d 6574 6164 6174 6122 290a 2020 2020  "metadata").    
-000246b0: 666f 7220 6c69 6e65 2069 6e20 736f 7572  for line in sour
-000246c0: 6365 3a0a 2020 2020 2020 2020 746f 6b65  ce:.        toke
-000246d0: 6e73 203d 206c 696e 652e 7273 7472 6970  ns = line.rstrip
-000246e0: 2822 5c6e 2229 2e73 706c 6974 2873 6570  ("\n").split(sep
-000246f0: 290a 2020 2020 2020 2020 6966 206c 656e  ).        if len
-00024700: 2874 6f6b 656e 7329 203e 3d20 313a 0a20  (tokens) >= 1:. 
-00024710: 2020 2020 2020 2020 2020 206d 6574 6164             metad
-00024720: 6174 6120 3d20 746f 6b65 6e73 5b6d 6574  ata = tokens[met
-00024730: 6164 6174 615f 696e 6465 785d 2e65 6e63  adata_index].enc
-00024740: 6f64 6528 656e 636f 6469 6e67 290a 2020  ode(encoding).  
-00024750: 2020 2020 2020 2020 2020 6966 2062 6173            if bas
-00024760: 6536 345f 6d65 7461 6461 7461 3a0a 2020  e64_metadata:.  
-00024770: 2020 2020 2020 2020 2020 2020 2020 6d65                me
-00024780: 7461 6461 7461 203d 2062 6173 6536 342e  tadata = base64.
-00024790: 6236 3464 6563 6f64 6528 6d65 7461 6461  b64decode(metada
-000247a0: 7461 290a 2020 2020 2020 2020 2020 2020  ta).            
-000247b0: 7461 626c 652e 6164 645f 726f 7728 6d65  table.add_row(me
-000247c0: 7461 6461 7461 3d6d 6574 6164 6174 6129  tadata=metadata)
-000247d0: 0a20 2020 2072 6574 7572 6e20 7461 626c  .    return tabl
-000247e0: 650a 0a0a 6465 6620 7061 7273 655f 6d69  e...def parse_mi
-000247f0: 6772 6174 696f 6e73 280a 2020 2020 736f  grations(.    so
-00024800: 7572 6365 2c20 7374 7269 6374 3d54 7275  urce, strict=Tru
-00024810: 652c 2065 6e63 6f64 696e 673d 2275 7466  e, encoding="utf
-00024820: 3822 2c20 6261 7365 3634 5f6d 6574 6164  8", base64_metad
-00024830: 6174 613d 5472 7565 2c20 7461 626c 653d  ata=True, table=
-00024840: 4e6f 6e65 0a29 3a0a 2020 2020 2222 220a  None.):.    """.
-00024850: 2020 2020 5061 7273 6520 7468 6520 7370      Parse the sp
-00024860: 6563 6966 6965 6420 6669 6c65 2d6c 696b  ecified file-lik
-00024870: 6520 6f62 6a65 6374 2063 6f6e 7461 696e  e object contain
-00024880: 696e 6720 6120 7768 6974 6573 7061 6365  ing a whitespace
-00024890: 2064 656c 696d 6974 6564 0a20 2020 2064   delimited.    d
-000248a0: 6573 6372 6970 7469 6f6e 206f 6620 6120  escription of a 
-000248b0: 6d69 6772 6174 696f 6e20 7461 626c 6520  migration table 
-000248c0: 616e 6420 7265 7475 726e 7320 7468 6520  and returns the 
-000248d0: 636f 7272 6573 706f 6e64 696e 670a 2020  corresponding.  
-000248e0: 2020 3a63 6c61 7373 3a60 4d69 6772 6174    :class:`Migrat
-000248f0: 696f 6e54 6162 6c65 6020 696e 7374 616e  ionTable` instan
-00024900: 6365 2e0a 0a20 2020 2053 6565 2074 6865  ce...    See the
-00024910: 203a 7265 663a 606d 6967 7261 7469 6f6e   :ref:`migration
-00024920: 2074 6578 7420 666f 726d 6174 203c 7365   text format <se
-00024930: 635f 6d69 6772 6174 696f 6e5f 7465 7874  c_migration_text
-00024940: 5f66 6f72 6d61 743e 6020 7365 6374 696f  _format>` sectio
-00024950: 6e0a 2020 2020 666f 7220 7468 6520 6465  n.    for the de
-00024960: 7461 696c 7320 6f66 2074 6865 2072 6571  tails of the req
-00024970: 7569 7265 6420 666f 726d 6174 2061 6e64  uired format and
-00024980: 2074 6865 0a20 2020 203a 7265 663a 606d   the.    :ref:`m
-00024990: 6967 7261 7469 6f6e 2074 6162 6c65 2064  igration table d
-000249a0: 6566 696e 6974 696f 6e20 3c73 6563 5f6d  efinition <sec_m
-000249b0: 6967 7261 7469 6f6e 5f74 6162 6c65 5f64  igration_table_d
-000249c0: 6566 696e 6974 696f 6e3e 6020 7365 6374  efinition>` sect
-000249d0: 696f 6e0a 2020 2020 666f 7220 7468 6520  ion.    for the 
-000249e0: 7265 7175 6972 6564 2070 726f 7065 7274  required propert
-000249f0: 6965 7320 6f66 2074 6865 2063 6f6e 7465  ies of the conte
-00024a00: 6e74 732e 204e 6f74 6520 7468 6174 2069  nts. Note that i
-00024a10: 6620 7468 6520 6060 7469 6d65 6060 2063  f the ``time`` c
-00024a20: 6f6c 756d 6e0a 2020 2020 6973 206d 6973  olumn.    is mis
-00024a30: 7369 6e67 2069 7473 2065 6e74 7269 6573  sing its entries
-00024a40: 2061 7265 2066 696c 6c65 6420 7769 7468   are filled with
-00024a50: 203a 6461 7461 3a60 554e 4b4e 4f57 4e5f   :data:`UNKNOWN_
-00024a60: 5449 4d45 602e 0a0a 2020 2020 5365 6520  TIME`...    See 
-00024a70: 3a66 756e 633a 6074 736b 6974 2e6c 6f61  :func:`tskit.loa
-00024a80: 645f 7465 7874 6020 666f 7220 6120 6465  d_text` for a de
-00024a90: 7461 696c 6564 2065 7870 6c61 6e61 7469  tailed explanati
-00024aa0: 6f6e 206f 6620 7468 6520 6060 7374 7269  on of the ``stri
-00024ab0: 6374 6060 0a20 2020 2070 6172 616d 6574  ct``.    paramet
-00024ac0: 6572 2e0a 0a20 2020 203a 7061 7261 6d20  er...    :param 
-00024ad0: 696f 2e54 6578 7449 4f42 6173 6520 736f  io.TextIOBase so
-00024ae0: 7572 6365 3a20 5468 6520 6669 6c65 2d6c  urce: The file-l
-00024af0: 696b 6520 6f62 6a65 6374 2063 6f6e 7461  ike object conta
-00024b00: 696e 696e 6720 7468 6520 7465 7874 2e0a  ining the text..
-00024b10: 2020 2020 3a70 6172 616d 2062 6f6f 6c20      :param bool 
-00024b20: 7374 7269 6374 3a20 4966 2054 7275 652c  strict: If True,
-00024b30: 2072 6571 7569 7265 2073 7472 6963 7420   require strict 
-00024b40: 7461 6220 6465 6c69 6d69 7469 6e67 2028  tab delimiting (
-00024b50: 6465 6661 756c 7429 2e20 4966 0a20 2020  default). If.   
-00024b60: 2020 2020 2046 616c 7365 2c20 6120 7265       False, a re
-00024b70: 6c61 7865 6420 7768 6974 6573 7061 6365  laxed whitespace
-00024b80: 2073 706c 6974 7469 6e67 2061 6c67 6f72   splitting algor
-00024b90: 6974 686d 2069 7320 7573 6564 2e0a 2020  ithm is used..  
-00024ba0: 2020 3a70 6172 616d 2073 7472 2065 6e63    :param str enc
-00024bb0: 6f64 696e 673a 2045 6e63 6f64 696e 6720  oding: Encoding 
-00024bc0: 7573 6564 2066 6f72 2074 6578 7420 7265  used for text re
-00024bd0: 7072 6573 656e 7461 7469 6f6e 2e0a 2020  presentation..  
-00024be0: 2020 3a70 6172 616d 2062 6f6f 6c20 6261    :param bool ba
-00024bf0: 7365 3634 5f6d 6574 6164 6174 613a 2049  se64_metadata: I
-00024c00: 6620 5472 7565 2c20 6d65 7461 6461 7461  f True, metadata
-00024c10: 2069 7320 656e 636f 6465 6420 7573 696e   is encoded usin
-00024c20: 6720 4261 7365 3634 0a20 2020 2020 2020  g Base64.       
-00024c30: 2065 6e63 6f64 696e 673b 206f 7468 6572   encoding; other
-00024c40: 7769 7365 2c20 6173 2070 6c61 696e 2074  wise, as plain t
-00024c50: 6578 742e 0a20 2020 203a 7061 7261 6d20  ext..    :param 
-00024c60: 4d69 6772 6174 696f 6e54 6162 6c65 2074  MigrationTable t
-00024c70: 6162 6c65 3a20 4966 2073 7065 6369 6669  able: If specifi
-00024c80: 6564 2c20 7772 6974 6520 6d69 6772 6174  ed, write migrat
-00024c90: 696f 6e73 2069 6e74 6f20 7468 6973 2074  ions into this t
-00024ca0: 6162 6c65 2e0a 2020 2020 2020 2020 4966  able..        If
-00024cb0: 206e 6f74 2c20 6372 6561 7465 2061 206e   not, create a n
-00024cc0: 6577 203a 636c 6173 733a 604d 6967 7261  ew :class:`Migra
-00024cd0: 7469 6f6e 5461 626c 6560 2069 6e73 7461  tionTable` insta
-00024ce0: 6e63 652e 0a20 2020 2022 2222 0a20 2020  nce..    """.   
-00024cf0: 2073 6570 203d 204e 6f6e 650a 2020 2020   sep = None.    
-00024d00: 6966 2073 7472 6963 743a 0a20 2020 2020  if strict:.     
-00024d10: 2020 2073 6570 203d 2022 5c74 220a 2020     sep = "\t".  
-00024d20: 2020 6966 2074 6162 6c65 2069 7320 4e6f    if table is No
-00024d30: 6e65 3a0a 2020 2020 2020 2020 7461 626c  ne:.        tabl
-00024d40: 6520 3d20 7461 626c 6573 2e4d 6967 7261  e = tables.Migra
-00024d50: 7469 6f6e 5461 626c 6528 290a 2020 2020  tionTable().    
-00024d60: 6865 6164 6572 203d 2073 6f75 7263 652e  header = source.
-00024d70: 7265 6164 6c69 6e65 2829 2e72 7374 7269  readline().rstri
-00024d80: 7028 225c 6e22 292e 7370 6c69 7428 7365  p("\n").split(se
-00024d90: 7029 0a20 2020 206c 6566 745f 696e 6465  p).    left_inde
-00024da0: 7820 3d20 6865 6164 6572 2e69 6e64 6578  x = header.index
-00024db0: 2822 6c65 6674 2229 0a20 2020 2072 6967  ("left").    rig
-00024dc0: 6874 5f69 6e64 6578 203d 2068 6561 6465  ht_index = heade
-00024dd0: 722e 696e 6465 7828 2272 6967 6874 2229  r.index("right")
-00024de0: 0a20 2020 206e 6f64 655f 696e 6465 7820  .    node_index 
-00024df0: 3d20 6865 6164 6572 2e69 6e64 6578 2822  = header.index("
-00024e00: 6e6f 6465 2229 0a20 2020 2073 6f75 7263  node").    sourc
-00024e10: 655f 696e 6465 7820 3d20 6865 6164 6572  e_index = header
-00024e20: 2e69 6e64 6578 2822 736f 7572 6365 2229  .index("source")
-00024e30: 0a20 2020 2064 6573 745f 696e 6465 7820  .    dest_index 
-00024e40: 3d20 6865 6164 6572 2e69 6e64 6578 2822  = header.index("
-00024e50: 6465 7374 2229 0a20 2020 2074 696d 655f  dest").    time_
-00024e60: 696e 6465 7820 3d20 6865 6164 6572 2e69  index = header.i
-00024e70: 6e64 6578 2822 7469 6d65 2229 0a20 2020  ndex("time").   
-00024e80: 206d 6574 6164 6174 615f 696e 6465 7820   metadata_index 
-00024e90: 3d20 4e6f 6e65 0a20 2020 2074 7279 3a0a  = None.    try:.
-00024ea0: 2020 2020 2020 2020 6d65 7461 6461 7461          metadata
-00024eb0: 5f69 6e64 6578 203d 2068 6561 6465 722e  _index = header.
-00024ec0: 696e 6465 7828 226d 6574 6164 6174 6122  index("metadata"
-00024ed0: 290a 2020 2020 6578 6365 7074 2056 616c  ).    except Val
-00024ee0: 7565 4572 726f 723a 0a20 2020 2020 2020  ueError:.       
-00024ef0: 2070 6173 730a 2020 2020 666f 7220 6c69   pass.    for li
-00024f00: 6e65 2069 6e20 736f 7572 6365 3a0a 2020  ne in source:.  
-00024f10: 2020 2020 2020 746f 6b65 6e73 203d 206c        tokens = l
-00024f20: 696e 652e 7273 7472 6970 2822 5c6e 2229  ine.rstrip("\n")
-00024f30: 2e73 706c 6974 2873 6570 290a 2020 2020  .split(sep).    
-00024f40: 2020 2020 6966 206c 656e 2874 6f6b 656e      if len(token
-00024f50: 7329 203e 3d20 363a 0a20 2020 2020 2020  s) >= 6:.       
-00024f60: 2020 2020 206c 6566 7420 3d20 666c 6f61       left = floa
-00024f70: 7428 746f 6b65 6e73 5b6c 6566 745f 696e  t(tokens[left_in
-00024f80: 6465 785d 290a 2020 2020 2020 2020 2020  dex]).          
-00024f90: 2020 7269 6768 7420 3d20 666c 6f61 7428    right = float(
-00024fa0: 746f 6b65 6e73 5b72 6967 6874 5f69 6e64  tokens[right_ind
-00024fb0: 6578 5d29 0a20 2020 2020 2020 2020 2020  ex]).           
-00024fc0: 206e 6f64 6520 3d20 696e 7428 746f 6b65   node = int(toke
-00024fd0: 6e73 5b6e 6f64 655f 696e 6465 785d 290a  ns[node_index]).
-00024fe0: 2020 2020 2020 2020 2020 2020 736f 7572              sour
-00024ff0: 6365 203d 2069 6e74 2874 6f6b 656e 735b  ce = int(tokens[
-00025000: 736f 7572 6365 5f69 6e64 6578 5d29 0a20  source_index]). 
-00025010: 2020 2020 2020 2020 2020 2064 6573 7420             dest 
-00025020: 3d20 696e 7428 746f 6b65 6e73 5b64 6573  = int(tokens[des
-00025030: 745f 696e 6465 785d 290a 2020 2020 2020  t_index]).      
-00025040: 2020 2020 2020 7469 6d65 203d 2066 6c6f        time = flo
-00025050: 6174 2874 6f6b 656e 735b 7469 6d65 5f69  at(tokens[time_i
-00025060: 6e64 6578 5d29 0a20 2020 2020 2020 2020  ndex]).         
-00025070: 2020 206d 6574 6164 6174 6120 3d20 6222     metadata = b"
-00025080: 220a 2020 2020 2020 2020 2020 2020 6966  ".            if
-00025090: 206d 6574 6164 6174 615f 696e 6465 7820   metadata_index 
-000250a0: 6973 206e 6f74 204e 6f6e 6520 616e 6420  is not None and 
-000250b0: 6d65 7461 6461 7461 5f69 6e64 6578 203c  metadata_index <
-000250c0: 206c 656e 2874 6f6b 656e 7329 3a0a 2020   len(tokens):.  
-000250d0: 2020 2020 2020 2020 2020 2020 2020 6d65                me
-000250e0: 7461 6461 7461 203d 2074 6f6b 656e 735b  tadata = tokens[
-000250f0: 6d65 7461 6461 7461 5f69 6e64 6578 5d2e  metadata_index].
-00025100: 656e 636f 6465 2865 6e63 6f64 696e 6729  encode(encoding)
-00025110: 0a20 2020 2020 2020 2020 2020 2020 2020  .               
-00025120: 2069 6620 6261 7365 3634 5f6d 6574 6164   if base64_metad
-00025130: 6174 613a 0a20 2020 2020 2020 2020 2020  ata:.           
-00025140: 2020 2020 2020 2020 206d 6574 6164 6174           metadat
-00025150: 6120 3d20 6261 7365 3634 2e62 3634 6465  a = base64.b64de
-00025160: 636f 6465 286d 6574 6164 6174 6129 0a20  code(metadata). 
-00025170: 2020 2020 2020 2020 2020 2074 6162 6c65             table
-00025180: 2e61 6464 5f72 6f77 280a 2020 2020 2020  .add_row(.      
-00025190: 2020 2020 2020 2020 2020 6c65 6674 3d6c            left=l
-000251a0: 6566 742c 0a20 2020 2020 2020 2020 2020  eft,.           
-000251b0: 2020 2020 2072 6967 6874 3d72 6967 6874       right=right
-000251c0: 2c0a 2020 2020 2020 2020 2020 2020 2020  ,.              
-000251d0: 2020 6e6f 6465 3d6e 6f64 652c 0a20 2020    node=node,.   
-000251e0: 2020 2020 2020 2020 2020 2020 2073 6f75               sou
-000251f0: 7263 653d 736f 7572 6365 2c0a 2020 2020  rce=source,.    
-00025200: 2020 2020 2020 2020 2020 2020 6465 7374              dest
-00025210: 3d64 6573 742c 0a20 2020 2020 2020 2020  =dest,.         
-00025220: 2020 2020 2020 2074 696d 653d 7469 6d65         time=time
-00025230: 2c0a 2020 2020 2020 2020 2020 2020 2020  ,.              
-00025240: 2020 6d65 7461 6461 7461 3d6d 6574 6164    metadata=metad
-00025250: 6174 612c 0a20 2020 2020 2020 2020 2020  ata,.           
-00025260: 2029 0a20 2020 2072 6574 7572 6e20 7461   ).    return ta
-00025270: 626c 650a 0a0a 6465 6620 6c6f 6164 5f74  ble...def load_t
-00025280: 6578 7428 0a20 2020 206e 6f64 6573 2c0a  ext(.    nodes,.
-00025290: 2020 2020 6564 6765 732c 0a20 2020 2073      edges,.    s
-000252a0: 6974 6573 3d4e 6f6e 652c 0a20 2020 206d  ites=None,.    m
-000252b0: 7574 6174 696f 6e73 3d4e 6f6e 652c 0a20  utations=None,. 
-000252c0: 2020 2069 6e64 6976 6964 7561 6c73 3d4e     individuals=N
-000252d0: 6f6e 652c 0a20 2020 2070 6f70 756c 6174  one,.    populat
-000252e0: 696f 6e73 3d4e 6f6e 652c 0a20 2020 206d  ions=None,.    m
-000252f0: 6967 7261 7469 6f6e 733d 4e6f 6e65 2c0a  igrations=None,.
-00025300: 2020 2020 7365 7175 656e 6365 5f6c 656e      sequence_len
-00025310: 6774 683d 302c 0a20 2020 2073 7472 6963  gth=0,.    stric
-00025320: 743d 5472 7565 2c0a 2020 2020 656e 636f  t=True,.    enco
-00025330: 6469 6e67 3d22 7574 6638 222c 0a20 2020  ding="utf8",.   
-00025340: 2062 6173 6536 345f 6d65 7461 6461 7461   base64_metadata
-00025350: 3d54 7275 652c 0a29 3a0a 2020 2020 2222  =True,.):.    ""
-00025360: 220a 2020 2020 5265 7475 726e 2061 203a  ".    Return a :
-00025370: 636c 6173 733a 6054 7265 6553 6571 7565  class:`TreeSeque
-00025380: 6e63 6560 2069 6e73 7461 6e63 6520 7061  nce` instance pa
-00025390: 7273 6564 2066 726f 6d20 7461 6275 6c61  rsed from tabula
-000253a0: 7465 6420 7465 7874 2064 6174 610a 2020  ted text data.  
-000253b0: 2020 636f 6e74 6169 6e65 6420 696e 2074    contained in t
-000253c0: 6865 2073 7065 6369 6669 6564 2066 696c  he specified fil
-000253d0: 652d 6c69 6b65 206f 626a 6563 7473 2e20  e-like objects. 
-000253e0: 5468 6520 666f 726d 6174 0a20 2020 2066  The format.    f
-000253f0: 6f72 2074 6865 7365 2066 696c 6573 2069  or these files i
-00025400: 7320 646f 6375 6d65 6e74 6564 2069 6e20  s documented in 
-00025410: 7468 6520 3a72 6566 3a60 7365 635f 7465  the :ref:`sec_te
-00025420: 7874 5f66 696c 655f 666f 726d 6174 6020  xt_file_format` 
-00025430: 7365 6374 696f 6e2c 0a20 2020 2061 6e64  section,.    and
-00025440: 2069 7320 7072 6f64 7563 6564 2062 7920   is produced by 
-00025450: 7468 6520 3a6d 6574 683a 6054 7265 6553  the :meth:`TreeS
-00025460: 6571 7565 6e63 652e 6475 6d70 5f74 6578  equence.dump_tex
-00025470: 7460 206d 6574 686f 642e 2046 7572 7468  t` method. Furth
-00025480: 6572 0a20 2020 2070 726f 7065 7274 6965  er.    propertie
-00025490: 7320 7265 7175 6972 6564 2066 6f72 2061  s required for a
-000254a0: 6e20 696e 7075 7420 7472 6565 2073 6571  n input tree seq
-000254b0: 7565 6e63 6520 6172 6520 6465 7363 7269  uence are descri
-000254c0: 6265 6420 696e 2074 6865 0a20 2020 203a  bed in the.    :
-000254d0: 7265 663a 6073 6563 5f76 616c 6964 5f74  ref:`sec_valid_t
-000254e0: 7265 655f 7365 7175 656e 6365 5f72 6571  ree_sequence_req
-000254f0: 7569 7265 6d65 6e74 7360 2073 6563 7469  uirements` secti
-00025500: 6f6e 2e20 5468 6973 206d 6574 686f 6420  on. This method 
-00025510: 6973 2069 6e74 656e 6465 6420 6173 2061  is intended as a
-00025520: 0a20 2020 2063 6f6e 7665 6e69 656e 7420  .    convenient 
-00025530: 696e 7465 7266 6163 6520 666f 7220 696d  interface for im
-00025540: 706f 7274 696e 6720 6578 7465 726e 616c  porting external
-00025550: 2064 6174 6120 696e 746f 2074 736b 6974   data into tskit
-00025560: 3b20 7468 6520 6269 6e61 7279 0a20 2020  ; the binary.   
-00025570: 2066 696c 6520 666f 726d 6174 2075 7369   file format usi
-00025580: 6e67 2062 7920 3a6d 6574 683a 6074 736b  ng by :meth:`tsk
-00025590: 6974 2e6c 6f61 6460 2069 7320 6d61 6e79  it.load` is many
-000255a0: 2074 696d 6573 206d 6f72 6520 6566 6669   times more effi
-000255b0: 6369 656e 7420 7468 616e 0a20 2020 2074  cient than.    t
-000255c0: 6869 7320 7465 7874 2066 6f72 6d61 742e  his text format.
-000255d0: 0a0a 2020 2020 5468 6520 6060 6e6f 6465  ..    The ``node
-000255e0: 7360 6020 616e 6420 6060 6564 6765 7360  s`` and ``edges`
-000255f0: 6020 7061 7261 6d65 7465 7273 2061 7265  ` parameters are
-00025600: 206d 616e 6461 746f 7279 2061 6e64 206d   mandatory and m
-00025610: 7573 7420 6265 2066 696c 652d 6c69 6b65  ust be file-like
-00025620: 0a20 2020 206f 626a 6563 7473 2063 6f6e  .    objects con
-00025630: 7461 696e 696e 6720 7465 7874 2077 6974  taining text wit
-00025640: 6820 7768 6974 6573 7061 6365 2064 656c  h whitespace del
-00025650: 696d 6974 6564 2063 6f6c 756d 6e73 2c20  imited columns, 
-00025660: 2070 6172 7361 626c 6520 6279 0a20 2020   parsable by.   
-00025670: 203a 6675 6e63 3a60 7061 7273 655f 6e6f   :func:`parse_no
-00025680: 6465 7360 2061 6e64 203a 6675 6e63 3a60  des` and :func:`
-00025690: 7061 7273 655f 6564 6765 7360 2c20 7265  parse_edges`, re
-000256a0: 7370 6563 7469 7665 6c79 2e20 6060 7369  spectively. ``si
-000256b0: 7465 7360 602c 0a20 2020 2060 6069 6e64  tes``,.    ``ind
-000256c0: 6976 6964 7561 6c73 6060 2c20 6060 706f  ividuals``, ``po
-000256d0: 7075 6c61 7469 6f6e 7360 602c 2060 606d  pulations``, ``m
-000256e0: 7574 6174 696f 6e73 6060 2c20 616e 6420  utations``, and 
-000256f0: 6060 6d69 6772 6174 696f 6e73 6060 2061  ``migrations`` a
-00025700: 7265 206f 7074 696f 6e61 6c2c 0a20 2020  re optional,.   
-00025710: 2061 6e64 206d 7573 7420 6265 2070 6172   and must be par
-00025720: 7361 626c 6520 6279 203a 6675 6e63 3a60  sable by :func:`
-00025730: 7061 7273 655f 7369 7465 7360 2c20 3a66  parse_sites`, :f
-00025740: 756e 633a 6070 6172 7365 5f69 6e64 6976  unc:`parse_indiv
-00025750: 6964 7561 6c73 602c 0a20 2020 203a 6675  iduals`,.    :fu
-00025760: 6e63 3a60 7061 7273 655f 706f 7075 6c61  nc:`parse_popula
-00025770: 7469 6f6e 7360 2c20 3a66 756e 633a 6070  tions`, :func:`p
-00025780: 6172 7365 5f6d 7574 6174 696f 6e73 602c  arse_mutations`,
-00025790: 2061 6e64 203a 6675 6e63 3a60 7061 7273   and :func:`pars
-000257a0: 655f 6d69 6772 6174 696f 6e73 602c 0a20  e_migrations`,. 
-000257b0: 2020 2072 6573 7065 6374 6976 656c 792e     respectively.
-000257c0: 2046 6f72 2063 6f6e 7665 6e69 656e 6365   For convenience
-000257d0: 2c20 6966 2074 6865 206e 6f64 6520 7461  , if the node ta
-000257e0: 626c 6520 7265 6665 7273 2074 6f20 706f  ble refers to po
-000257f0: 7075 6c61 7469 6f6e 732c 0a20 2020 2062  pulations,.    b
-00025800: 7574 2074 6865 2060 6070 6f70 756c 6174  ut the ``populat
-00025810: 696f 6e73 6060 2070 6172 616d 6574 6572  ions`` parameter
-00025820: 2069 7320 6e6f 7420 7072 6f76 6964 6564   is not provided
-00025830: 2c20 6120 6d69 6e69 6d61 6c20 7365 7420  , a minimal set 
-00025840: 6f66 2072 6f77 7320 6172 650a 2020 2020  of rows are.    
-00025850: 6164 6465 6420 746f 2074 6865 2070 6f70  added to the pop
-00025860: 756c 6174 696f 6e20 7461 626c 652c 2073  ulation table, s
-00025870: 6f20 7468 6174 2061 2076 616c 6964 2074  o that a valid t
-00025880: 7265 6520 7365 7175 656e 6365 2063 616e  ree sequence can
-00025890: 2062 6520 7265 7475 726e 6564 2e0a 0a20   be returned... 
-000258a0: 2020 2054 6865 2060 6073 6571 7565 6e63     The ``sequenc
-000258b0: 655f 6c65 6e67 7468 6060 2070 6172 616d  e_length`` param
-000258c0: 6574 6572 2064 6574 6572 6d69 6e65 7320  eter determines 
-000258d0: 7468 650a 2020 2020 3a61 7474 723a 6054  the.    :attr:`T
-000258e0: 7265 6553 6571 7565 6e63 652e 7365 7175  reeSequence.sequ
-000258f0: 656e 6365 5f6c 656e 6774 6860 206f 6620  ence_length` of 
-00025900: 7468 6520 7265 7475 726e 6564 2074 7265  the returned tre
-00025910: 6520 7365 7175 656e 6365 2e20 4966 2069  e sequence. If i
-00025920: 740a 2020 2020 6973 2030 206f 7220 6e6f  t.    is 0 or no
-00025930: 7420 7370 6563 6966 6965 642c 2074 6865  t specified, the
-00025940: 2076 616c 7565 2069 7320 7461 6b65 6e20   value is taken 
-00025950: 746f 2062 6520 7468 6520 6d61 7869 6d75  to be the maximu
-00025960: 6d20 7269 6768 740a 2020 2020 636f 6f72  m right.    coor
-00025970: 6469 6e61 7465 206f 6620 7468 6520 696e  dinate of the in
-00025980: 7075 7420 6564 6765 732e 2054 6869 7320  put edges. This 
-00025990: 7061 7261 6d65 7465 7220 6973 2075 7365  parameter is use
-000259a0: 6675 6c20 696e 2064 6567 656e 6572 6174  ful in degenerat
-000259b0: 650a 2020 2020 7369 7475 6174 696f 6e73  e.    situations
-000259c0: 2028 7375 6368 2061 7320 7768 656e 2074   (such as when t
-000259d0: 6865 7265 2061 7265 207a 6572 6f20 6564  here are zero ed
-000259e0: 6765 7329 2c20 6275 7420 6361 6e20 7573  ges), but can us
-000259f0: 7561 6c6c 7920 6265 2069 676e 6f72 6564  ually be ignored
-00025a00: 2e0a 0a20 2020 2054 6865 2060 6073 7472  ...    The ``str
-00025a10: 6963 7460 6020 7061 7261 6d65 7465 7220  ict`` parameter 
-00025a20: 636f 6e74 726f 6c73 2074 6865 2066 6965  controls the fie
-00025a30: 6c64 2064 656c 696d 6974 696e 6720 616c  ld delimiting al
-00025a40: 676f 7269 7468 6d20 7468 6174 0a20 2020  gorithm that.   
-00025a50: 2069 7320 7573 6564 2e20 4966 2060 6073   is used. If ``s
-00025a60: 7472 6963 7460 6020 6973 2054 7275 6520  trict`` is True 
-00025a70: 2874 6865 2064 6566 6175 6c74 292c 2077  (the default), w
-00025a80: 6520 7265 7175 6972 6520 6578 6163 746c  e require exactl
-00025a90: 7920 6f6e 650a 2020 2020 7461 6220 6368  y one.    tab ch
-00025aa0: 6172 6163 7465 7220 7365 7061 7261 7469  aracter separati
-00025ab0: 6e67 2065 6163 6820 6669 656c 642e 2049  ng each field. I
-00025ac0: 6620 6060 7374 7269 6374 6060 2069 7320  f ``strict`` is 
-00025ad0: 4661 6c73 652c 2061 206d 6f72 6520 7265  False, a more re
-00025ae0: 6c61 7865 640a 2020 2020 7768 6974 6573  laxed.    whites
-00025af0: 7061 6365 2064 656c 696d 6974 696e 6720  pace delimiting 
-00025b00: 616c 676f 7269 7468 6d20 6973 2075 7365  algorithm is use
-00025b10: 642c 2073 7563 6820 7468 6174 2061 6e79  d, such that any
-00025b20: 2072 756e 206f 6620 7768 6974 6573 7061   run of whitespa
-00025b30: 6365 0a20 2020 2069 7320 7265 6761 7264  ce.    is regard
-00025b40: 6564 2061 7320 6120 6669 656c 6420 7365  ed as a field se
-00025b50: 7061 7261 746f 722e 2049 6e20 6d6f 7374  parator. In most
-00025b60: 2073 6974 7561 7469 6f6e 732c 2060 6073   situations, ``s
-00025b70: 7472 6963 743d 4661 6c73 6560 600a 2020  trict=False``.  
-00025b80: 2020 6973 206d 6f72 6520 636f 6e76 656e    is more conven
-00025b90: 6965 6e74 2c20 6275 7420 6974 2063 616e  ient, but it can
-00025ba0: 206c 6561 6420 746f 2065 7272 6f72 2069   lead to error i
-00025bb0: 6e20 6365 7274 6169 6e20 7369 7475 6174  n certain situat
-00025bc0: 696f 6e73 2e20 466f 720a 2020 2020 6578  ions. For.    ex
-00025bd0: 616d 706c 652c 2069 6620 6120 6465 6c65  ample, if a dele
-00025be0: 7469 6f6e 2069 7320 656e 636f 6465 6420  tion is encoded 
-00025bf0: 696e 2074 6865 206d 7574 6174 696f 6e20  in the mutation 
-00025c00: 7461 626c 6520 7468 6973 2077 696c 6c20  table this will 
-00025c10: 6e6f 740a 2020 2020 6265 2070 6172 7365  not.    be parse
-00025c20: 6162 6c65 2077 6865 6e20 6060 7374 7269  able when ``stri
-00025c30: 6374 3d46 616c 7365 6060 2e0a 0a20 2020  ct=False``...   
-00025c40: 2041 6674 6572 2070 6172 7369 6e67 2074   After parsing t
-00025c50: 6865 2074 6162 6c65 732c 203a 6d65 7468  he tables, :meth
-00025c60: 3a60 5461 626c 6543 6f6c 6c65 6374 696f  :`TableCollectio
-00025c70: 6e2e 736f 7274 6020 6973 2063 616c 6c65  n.sort` is calle
-00025c80: 6420 746f 2065 6e73 7572 6520 7468 6174  d to ensure that
-00025c90: 0a20 2020 2074 6865 206c 6f61 6465 6420  .    the loaded 
-00025ca0: 7461 626c 6573 2073 6174 6973 6679 2074  tables satisfy t
-00025cb0: 6865 2074 7265 6520 7365 7175 656e 6365  he tree sequence
-00025cc0: 203a 7265 663a 606f 7264 6572 696e 6720   :ref:`ordering 
-00025cd0: 7265 7175 6972 656d 656e 7473 0a20 2020  requirements.   
-00025ce0: 203c 7365 635f 7661 6c69 645f 7472 6565   <sec_valid_tree
-00025cf0: 5f73 6571 7565 6e63 655f 7265 7175 6972  _sequence_requir
-00025d00: 656d 656e 7473 3e60 2e20 4e6f 7465 2074  ements>`. Note t
-00025d10: 6861 7420 7468 6973 206d 6179 2072 6573  hat this may res
-00025d20: 756c 7420 696e 2074 6865 0a20 2020 2049  ult in the.    I
-00025d30: 4473 206f 6620 7661 7269 6f75 7320 656e  Ds of various en
-00025d40: 7469 7469 6573 2063 6861 6e67 696e 6720  tities changing 
-00025d50: 6672 6f6d 2074 6865 6972 2070 6f73 6974  from their posit
-00025d60: 696f 6e73 2069 6e20 7468 6520 696e 7075  ions in the inpu
-00025d70: 7420 6669 6c65 2e0a 0a20 2020 203a 7061  t file...    :pa
-00025d80: 7261 6d20 696f 2e54 6578 7449 4f42 6173  ram io.TextIOBas
-00025d90: 6520 6e6f 6465 733a 2054 6865 2066 696c  e nodes: The fil
-00025da0: 652d 6c69 6b65 206f 626a 6563 7420 636f  e-like object co
-00025db0: 6e74 6169 6e69 6e67 2074 6578 7420 6465  ntaining text de
-00025dc0: 7363 7269 6269 6e67 2061 0a20 2020 2020  scribing a.     
-00025dd0: 2020 203a 636c 6173 733a 604e 6f64 6554     :class:`NodeT
-00025de0: 6162 6c65 602e 0a20 2020 203a 7061 7261  able`..    :para
-00025df0: 6d20 696f 2e54 6578 7449 4f42 6173 6520  m io.TextIOBase 
-00025e00: 6564 6765 733a 2054 6865 2066 696c 652d  edges: The file-
-00025e10: 6c69 6b65 206f 626a 6563 7420 636f 6e74  like object cont
-00025e20: 6169 6e69 6e67 2074 6578 740a 2020 2020  aining text.    
-00025e30: 2020 2020 6465 7363 7269 6269 6e67 2061      describing a
-00025e40: 6e20 3a63 6c61 7373 3a60 4564 6765 5461  n :class:`EdgeTa
-00025e50: 626c 6560 2e0a 2020 2020 3a70 6172 616d  ble`..    :param
-00025e60: 2069 6f2e 5465 7874 494f 4261 7365 2073   io.TextIOBase s
-00025e70: 6974 6573 3a20 5468 6520 6669 6c65 2d6c  ites: The file-l
-00025e80: 696b 6520 6f62 6a65 6374 2063 6f6e 7461  ike object conta
-00025e90: 696e 696e 6720 7465 7874 2064 6573 6372  ining text descr
-00025ea0: 6962 696e 6720 610a 2020 2020 2020 2020  ibing a.        
-00025eb0: 3a63 6c61 7373 3a60 5369 7465 5461 626c  :class:`SiteTabl
-00025ec0: 6560 2e0a 2020 2020 3a70 6172 616d 2069  e`..    :param i
-00025ed0: 6f2e 5465 7874 494f 4261 7365 206d 7574  o.TextIOBase mut
-00025ee0: 6174 696f 6e73 3a20 5468 6520 6669 6c65  ations: The file
-00025ef0: 2d6c 696b 6520 6f62 6a65 6374 2063 6f6e  -like object con
-00025f00: 7461 696e 696e 6720 7465 7874 0a20 2020  taining text.   
-00025f10: 2020 2020 2064 6573 6372 6962 696e 6720       describing 
-00025f20: 6120 3a63 6c61 7373 3a60 4d75 7461 7469  a :class:`Mutati
-00025f30: 6f6e 5461 626c 6560 2e0a 2020 2020 3a70  onTable`..    :p
-00025f40: 6172 616d 2069 6f2e 5465 7874 494f 4261  aram io.TextIOBa
-00025f50: 7365 2069 6e64 6976 6964 7561 6c73 3a20  se individuals: 
-00025f60: 5468 6520 6669 6c65 2d6c 696b 6520 6f62  The file-like ob
-00025f70: 6a65 6374 2063 6f6e 7461 696e 696e 6720  ject containing 
-00025f80: 7465 7874 0a20 2020 2020 2020 2064 6573  text.        des
-00025f90: 6372 6962 696e 6720 6120 3a63 6c61 7373  cribing a :class
-00025fa0: 3a60 496e 6469 7669 6475 616c 5461 626c  :`IndividualTabl
-00025fb0: 6560 2e0a 2020 2020 3a70 6172 616d 2069  e`..    :param i
-00025fc0: 6f2e 5465 7874 494f 4261 7365 2070 6f70  o.TextIOBase pop
-00025fd0: 756c 6174 696f 6e73 3a20 5468 6520 6669  ulations: The fi
-00025fe0: 6c65 2d6c 696b 6520 6f62 6a65 6374 2063  le-like object c
-00025ff0: 6f6e 7461 696e 696e 6720 7465 7874 0a20  ontaining text. 
-00026000: 2020 2020 2020 2064 6573 6372 6962 696e         describin
-00026010: 6720 6120 3a63 6c61 7373 3a60 506f 7075  g a :class:`Popu
-00026020: 6c61 7469 6f6e 5461 626c 6560 2e0a 2020  lationTable`..  
-00026030: 2020 3a70 6172 616d 2069 6f2e 5465 7874    :param io.Text
-00026040: 494f 4261 7365 206d 6967 7261 7469 6f6e  IOBase migration
-00026050: 733a 2054 6865 2066 696c 652d 6c69 6b65  s: The file-like
-00026060: 206f 626a 6563 7420 636f 6e74 6169 6e69   object containi
-00026070: 6e67 2074 6578 740a 2020 2020 2020 2020  ng text.        
-00026080: 6465 7363 7269 6269 6e67 2061 203a 636c  describing a :cl
-00026090: 6173 733a 604d 6967 7261 7469 6f6e 5461  ass:`MigrationTa
-000260a0: 626c 6560 2e0a 2020 2020 3a70 6172 616d  ble`..    :param
-000260b0: 2066 6c6f 6174 2073 6571 7565 6e63 655f   float sequence_
-000260c0: 6c65 6e67 7468 3a20 5468 6520 7365 7175  length: The sequ
-000260d0: 656e 6365 206c 656e 6774 6820 6f66 2074  ence length of t
-000260e0: 6865 2072 6574 7572 6e65 6420 7472 6565  he returned tree
-000260f0: 2073 6571 7565 6e63 652e 2049 660a 2020   sequence. If.  
-00026100: 2020 2020 2020 6e6f 7420 7375 7070 6c69        not suppli
-00026110: 6564 206f 7220 7a65 726f 2074 6869 7320  ed or zero this 
-00026120: 7769 6c6c 2062 6520 696e 6665 7272 6564  will be inferred
-00026130: 2066 726f 6d20 7468 6520 7365 7420 6f66   from the set of
-00026140: 2065 6467 6573 2e0a 2020 2020 3a70 6172   edges..    :par
-00026150: 616d 2062 6f6f 6c20 7374 7269 6374 3a20  am bool strict: 
-00026160: 4966 2054 7275 652c 2072 6571 7569 7265  If True, require
-00026170: 2073 7472 6963 7420 7461 6220 6465 6c69   strict tab deli
-00026180: 6d69 7469 6e67 2028 6465 6661 756c 7429  miting (default)
-00026190: 2e20 4966 0a20 2020 2020 2020 2046 616c  . If.        Fal
-000261a0: 7365 2c20 6120 7265 6c61 7865 6420 7768  se, a relaxed wh
-000261b0: 6974 6573 7061 6365 2073 706c 6974 7469  itespace splitti
-000261c0: 6e67 2061 6c67 6f72 6974 686d 2069 7320  ng algorithm is 
-000261d0: 7573 6564 2e0a 2020 2020 3a70 6172 616d  used..    :param
-000261e0: 2073 7472 2065 6e63 6f64 696e 673a 2045   str encoding: E
-000261f0: 6e63 6f64 696e 6720 7573 6564 2066 6f72  ncoding used for
-00026200: 2074 6578 7420 7265 7072 6573 656e 7461   text representa
-00026210: 7469 6f6e 2e0a 2020 2020 3a70 6172 616d  tion..    :param
-00026220: 2062 6f6f 6c20 6261 7365 3634 5f6d 6574   bool base64_met
-00026230: 6164 6174 613a 2049 6620 5472 7565 2c20  adata: If True, 
-00026240: 6d65 7461 6461 7461 2069 7320 656e 636f  metadata is enco
-00026250: 6465 6420 7573 696e 6720 4261 7365 3634  ded using Base64
-00026260: 0a20 2020 2020 2020 2065 6e63 6f64 696e  .        encodin
-00026270: 673b 206f 7468 6572 7769 7365 2c20 6173  g; otherwise, as
-00026280: 2070 6c61 696e 2074 6578 742e 0a20 2020   plain text..   
-00026290: 203a 7265 7475 726e 3a20 5468 6520 7472   :return: The tr
-000262a0: 6565 2073 6571 7565 6e63 6520 6f62 6a65  ee sequence obje
-000262b0: 6374 2063 6f6e 7461 696e 696e 6720 7468  ct containing th
-000262c0: 6520 696e 666f 726d 6174 696f 6e0a 2020  e information.  
-000262d0: 2020 2020 2020 7374 6f72 6564 2069 6e20        stored in 
-000262e0: 7468 6520 7370 6563 6966 6965 6420 6669  the specified fi
-000262f0: 6c65 2070 6174 6873 2e0a 2020 2020 3a72  le paths..    :r
-00026300: 7479 7065 3a20 3a63 6c61 7373 3a60 7473  type: :class:`ts
-00026310: 6b69 742e 5472 6565 5365 7175 656e 6365  kit.TreeSequence
-00026320: 600a 2020 2020 2222 220a 2020 2020 2320  `.    """.    # 
-00026330: 5765 206e 6565 6420 746f 2070 6172 7365  We need to parse
-00026340: 2074 6865 2065 6467 6573 2073 6f20 7765   the edges so we
-00026350: 2063 616e 2066 6967 7572 6520 6f75 7420   can figure out 
-00026360: 7468 6520 7365 7175 656e 6365 206c 656e  the sequence len
-00026370: 6774 682c 2061 6e64 0a20 2020 2023 2054  gth, and.    # T
-00026380: 6162 6c65 436f 6c6c 6563 7469 6f6e 2e73  ableCollection.s
-00026390: 6571 7565 6e63 655f 6c65 6e67 7468 2069  equence_length i
-000263a0: 7320 696d 6d75 7461 626c 6520 736f 2077  s immutable so w
-000263b0: 6520 6e65 6564 2074 6f20 6372 6561 7465  e need to create
-000263c0: 2061 2074 656d 706f 7261 7279 0a20 2020   a temporary.   
-000263d0: 2023 2065 6467 6520 7461 626c 652e 0a20   # edge table.. 
-000263e0: 2020 2065 6467 655f 7461 626c 6520 3d20     edge_table = 
-000263f0: 7061 7273 655f 6564 6765 7328 6564 6765  parse_edges(edge
-00026400: 732c 2073 7472 6963 743d 7374 7269 6374  s, strict=strict
-00026410: 290a 2020 2020 6966 2073 6571 7565 6e63  ).    if sequenc
-00026420: 655f 6c65 6e67 7468 203d 3d20 3020 616e  e_length == 0 an
-00026430: 6420 6c65 6e28 6564 6765 5f74 6162 6c65  d len(edge_table
-00026440: 2920 3e20 303a 0a20 2020 2020 2020 2073  ) > 0:.        s
-00026450: 6571 7565 6e63 655f 6c65 6e67 7468 203d  equence_length =
-00026460: 2065 6467 655f 7461 626c 652e 7269 6768   edge_table.righ
-00026470: 742e 6d61 7828 290a 2020 2020 7463 203d  t.max().    tc =
-00026480: 2074 6162 6c65 732e 5461 626c 6543 6f6c   tables.TableCol
-00026490: 6c65 6374 696f 6e28 7365 7175 656e 6365  lection(sequence
-000264a0: 5f6c 656e 6774 6829 0a20 2020 2074 632e  _length).    tc.
-000264b0: 6564 6765 732e 7365 745f 636f 6c75 6d6e  edges.set_column
-000264c0: 7328 0a20 2020 2020 2020 206c 6566 743d  s(.        left=
-000264d0: 6564 6765 5f74 6162 6c65 2e6c 6566 742c  edge_table.left,
-000264e0: 0a20 2020 2020 2020 2072 6967 6874 3d65  .        right=e
-000264f0: 6467 655f 7461 626c 652e 7269 6768 742c  dge_table.right,
-00026500: 0a20 2020 2020 2020 2070 6172 656e 743d  .        parent=
-00026510: 6564 6765 5f74 6162 6c65 2e70 6172 656e  edge_table.paren
-00026520: 742c 0a20 2020 2020 2020 2063 6869 6c64  t,.        child
-00026530: 3d65 6467 655f 7461 626c 652e 6368 696c  =edge_table.chil
-00026540: 642c 0a20 2020 2029 0a20 2020 2070 6172  d,.    ).    par
-00026550: 7365 5f6e 6f64 6573 280a 2020 2020 2020  se_nodes(.      
-00026560: 2020 6e6f 6465 732c 0a20 2020 2020 2020    nodes,.       
-00026570: 2073 7472 6963 743d 7374 7269 6374 2c0a   strict=strict,.
-00026580: 2020 2020 2020 2020 656e 636f 6469 6e67          encoding
-00026590: 3d65 6e63 6f64 696e 672c 0a20 2020 2020  =encoding,.     
-000265a0: 2020 2062 6173 6536 345f 6d65 7461 6461     base64_metada
-000265b0: 7461 3d62 6173 6536 345f 6d65 7461 6461  ta=base64_metada
-000265c0: 7461 2c0a 2020 2020 2020 2020 7461 626c  ta,.        tabl
-000265d0: 653d 7463 2e6e 6f64 6573 2c0a 2020 2020  e=tc.nodes,.    
-000265e0: 290a 2020 2020 6966 2073 6974 6573 2069  ).    if sites i
-000265f0: 7320 6e6f 7420 4e6f 6e65 3a0a 2020 2020  s not None:.    
-00026600: 2020 2020 7061 7273 655f 7369 7465 7328      parse_sites(
-00026610: 0a20 2020 2020 2020 2020 2020 2073 6974  .            sit
-00026620: 6573 2c0a 2020 2020 2020 2020 2020 2020  es,.            
-00026630: 7374 7269 6374 3d73 7472 6963 742c 0a20  strict=strict,. 
-00026640: 2020 2020 2020 2020 2020 2065 6e63 6f64             encod
-00026650: 696e 673d 656e 636f 6469 6e67 2c0a 2020  ing=encoding,.  
-00026660: 2020 2020 2020 2020 2020 6261 7365 3634            base64
-00026670: 5f6d 6574 6164 6174 613d 6261 7365 3634  _metadata=base64
-00026680: 5f6d 6574 6164 6174 612c 0a20 2020 2020  _metadata,.     
-00026690: 2020 2020 2020 2074 6162 6c65 3d74 632e         table=tc.
-000266a0: 7369 7465 732c 0a20 2020 2020 2020 2029  sites,.        )
-000266b0: 0a20 2020 2069 6620 6d75 7461 7469 6f6e  .    if mutation
-000266c0: 7320 6973 206e 6f74 204e 6f6e 653a 0a20  s is not None:. 
-000266d0: 2020 2020 2020 2070 6172 7365 5f6d 7574         parse_mut
-000266e0: 6174 696f 6e73 280a 2020 2020 2020 2020  ations(.        
-000266f0: 2020 2020 6d75 7461 7469 6f6e 732c 0a20      mutations,. 
-00026700: 2020 2020 2020 2020 2020 2073 7472 6963             stric
-00026710: 743d 7374 7269 6374 2c0a 2020 2020 2020  t=strict,.      
-00026720: 2020 2020 2020 656e 636f 6469 6e67 3d65        encoding=e
-00026730: 6e63 6f64 696e 672c 0a20 2020 2020 2020  ncoding,.       
-00026740: 2020 2020 2062 6173 6536 345f 6d65 7461       base64_meta
-00026750: 6461 7461 3d62 6173 6536 345f 6d65 7461  data=base64_meta
-00026760: 6461 7461 2c0a 2020 2020 2020 2020 2020  data,.          
-00026770: 2020 7461 626c 653d 7463 2e6d 7574 6174    table=tc.mutat
-00026780: 696f 6e73 2c0a 2020 2020 2020 2020 290a  ions,.        ).
-00026790: 2020 2020 6966 2069 6e64 6976 6964 7561      if individua
-000267a0: 6c73 2069 7320 6e6f 7420 4e6f 6e65 3a0a  ls is not None:.
-000267b0: 2020 2020 2020 2020 7061 7273 655f 696e          parse_in
-000267c0: 6469 7669 6475 616c 7328 0a20 2020 2020  dividuals(.     
-000267d0: 2020 2020 2020 2069 6e64 6976 6964 7561         individua
-000267e0: 6c73 2c0a 2020 2020 2020 2020 2020 2020  ls,.            
-000267f0: 7374 7269 6374 3d73 7472 6963 742c 0a20  strict=strict,. 
-00026800: 2020 2020 2020 2020 2020 2065 6e63 6f64             encod
-00026810: 696e 673d 656e 636f 6469 6e67 2c0a 2020  ing=encoding,.  
-00026820: 2020 2020 2020 2020 2020 6261 7365 3634            base64
-00026830: 5f6d 6574 6164 6174 613d 6261 7365 3634  _metadata=base64
-00026840: 5f6d 6574 6164 6174 612c 0a20 2020 2020  _metadata,.     
-00026850: 2020 2020 2020 2074 6162 6c65 3d74 632e         table=tc.
-00026860: 696e 6469 7669 6475 616c 732c 0a20 2020  individuals,.   
-00026870: 2020 2020 2029 0a20 2020 2069 6620 706f       ).    if po
-00026880: 7075 6c61 7469 6f6e 7320 6973 204e 6f6e  pulations is Non
-00026890: 653a 0a20 2020 2020 2020 2023 2041 7320  e:.        # As 
-000268a0: 6120 636f 6e76 656e 6965 6e63 6520 7765  a convenience we
-000268b0: 2061 6464 2061 6e79 2070 6f70 756c 6174   add any populat
-000268c0: 696f 6e73 2072 6566 6572 656e 6365 6420  ions referenced 
-000268d0: 696e 2074 6865 206e 6f64 6520 7461 626c  in the node tabl
-000268e0: 652e 0a20 2020 2020 2020 2069 6620 6c65  e..        if le
-000268f0: 6e28 7463 2e6e 6f64 6573 2920 3e20 303a  n(tc.nodes) > 0:
-00026900: 0a20 2020 2020 2020 2020 2020 206d 6178  .            max
-00026910: 5f70 6f70 756c 6174 696f 6e20 3d20 7463  _population = tc
-00026920: 2e6e 6f64 6573 2e70 6f70 756c 6174 696f  .nodes.populatio
-00026930: 6e2e 6d61 7828 290a 2020 2020 2020 2020  n.max().        
-00026940: 2020 2020 6966 206d 6178 5f70 6f70 756c      if max_popul
-00026950: 6174 696f 6e20 213d 204e 554c 4c3a 0a20  ation != NULL:. 
-00026960: 2020 2020 2020 2020 2020 2020 2020 2066                 f
-00026970: 6f72 205f 2069 6e20 7261 6e67 6528 6d61  or _ in range(ma
-00026980: 785f 706f 7075 6c61 7469 6f6e 202b 2031  x_population + 1
-00026990: 293a 0a20 2020 2020 2020 2020 2020 2020  ):.             
-000269a0: 2020 2020 2020 2074 632e 706f 7075 6c61         tc.popula
-000269b0: 7469 6f6e 732e 6164 645f 726f 7728 290a  tions.add_row().
-000269c0: 2020 2020 656c 7365 3a0a 2020 2020 2020      else:.      
-000269d0: 2020 7061 7273 655f 706f 7075 6c61 7469    parse_populati
-000269e0: 6f6e 7328 0a20 2020 2020 2020 2020 2020  ons(.           
-000269f0: 2070 6f70 756c 6174 696f 6e73 2c0a 2020   populations,.  
-00026a00: 2020 2020 2020 2020 2020 7374 7269 6374            strict
-00026a10: 3d73 7472 6963 742c 0a20 2020 2020 2020  =strict,.       
-00026a20: 2020 2020 2065 6e63 6f64 696e 673d 656e       encoding=en
-00026a30: 636f 6469 6e67 2c0a 2020 2020 2020 2020  coding,.        
-00026a40: 2020 2020 6261 7365 3634 5f6d 6574 6164      base64_metad
-00026a50: 6174 613d 6261 7365 3634 5f6d 6574 6164  ata=base64_metad
-00026a60: 6174 612c 0a20 2020 2020 2020 2020 2020  ata,.           
-00026a70: 2074 6162 6c65 3d74 632e 706f 7075 6c61   table=tc.popula
-00026a80: 7469 6f6e 732c 0a20 2020 2020 2020 2029  tions,.        )
-00026a90: 0a20 2020 2069 6620 6d69 6772 6174 696f  .    if migratio
-00026aa0: 6e73 2069 7320 6e6f 7420 4e6f 6e65 3a0a  ns is not None:.
-00026ab0: 2020 2020 2020 2020 7061 7273 655f 6d69          parse_mi
-00026ac0: 6772 6174 696f 6e73 280a 2020 2020 2020  grations(.      
-00026ad0: 2020 2020 2020 6d69 6772 6174 696f 6e73        migrations
-00026ae0: 2c0a 2020 2020 2020 2020 2020 2020 7374  ,.            st
-00026af0: 7269 6374 3d73 7472 6963 742c 0a20 2020  rict=strict,.   
-00026b00: 2020 2020 2020 2020 2065 6e63 6f64 696e           encodin
-00026b10: 673d 656e 636f 6469 6e67 2c0a 2020 2020  g=encoding,.    
-00026b20: 2020 2020 2020 2020 6261 7365 3634 5f6d          base64_m
-00026b30: 6574 6164 6174 613d 6261 7365 3634 5f6d  etadata=base64_m
-00026b40: 6574 6164 6174 612c 0a20 2020 2020 2020  etadata,.       
-00026b50: 2020 2020 2074 6162 6c65 3d74 632e 6d69       table=tc.mi
-00026b60: 6772 6174 696f 6e73 2c0a 2020 2020 2020  grations,.      
-00026b70: 2020 290a 2020 2020 7463 2e73 6f72 7428    ).    tc.sort(
-00026b80: 290a 2020 2020 7265 7475 726e 2074 632e  ).    return tc.
-00026b90: 7472 6565 5f73 6571 7565 6e63 6528 290a  tree_sequence().
-00026ba0: 0a0a 636c 6173 7320 5472 6565 4974 6572  ..class TreeIter
-00026bb0: 6174 6f72 3a0a 2020 2020 2222 220a 2020  ator:.    """.  
-00026bc0: 2020 5369 6d70 6c65 2063 6c61 7373 2070    Simple class p
-00026bd0: 726f 7669 6469 6e67 2066 6f72 7761 7264  roviding forward
-00026be0: 2061 6e64 2062 6163 6b77 6172 6420 6974   and backward it
-00026bf0: 6572 6174 696f 6e20 6f76 6572 2061 2074  eration over a t
-00026c00: 7265 6520 7365 7175 656e 6365 2e0a 2020  ree sequence..  
-00026c10: 2020 2222 220a 0a20 2020 2064 6566 205f    """..    def _
-00026c20: 5f69 6e69 745f 5f28 7365 6c66 2c20 7472  _init__(self, tr
-00026c30: 6565 293a 0a20 2020 2020 2020 2073 656c  ee):.        sel
-00026c40: 662e 7472 6565 203d 2074 7265 650a 2020  f.tree = tree.  
-00026c50: 2020 2020 2020 7365 6c66 2e6d 6f72 655f        self.more_
-00026c60: 7472 6565 7320 3d20 5472 7565 0a20 2020  trees = True.   
-00026c70: 2020 2020 2073 656c 662e 666f 7277 6172       self.forwar
-00026c80: 6420 3d20 5472 7565 0a0a 2020 2020 6465  d = True..    de
-00026c90: 6620 5f5f 6974 6572 5f5f 2873 656c 6629  f __iter__(self)
-00026ca0: 3a0a 2020 2020 2020 2020 7265 7475 726e  :.        return
-00026cb0: 2073 656c 660a 0a20 2020 2064 6566 205f   self..    def _
-00026cc0: 5f72 6576 6572 7365 645f 5f28 7365 6c66  _reversed__(self
-00026cd0: 293a 0a20 2020 2020 2020 2073 656c 662e  ):.        self.
-00026ce0: 666f 7277 6172 6420 3d20 4661 6c73 650a  forward = False.
-00026cf0: 2020 2020 2020 2020 7265 7475 726e 2073          return s
-00026d00: 656c 660a 0a20 2020 2064 6566 205f 5f6e  elf..    def __n
-00026d10: 6578 745f 5f28 7365 6c66 293a 0a20 2020  ext__(self):.   
-00026d20: 2020 2020 2069 6620 7365 6c66 2e66 6f72       if self.for
-00026d30: 7761 7264 3a0a 2020 2020 2020 2020 2020  ward:.          
-00026d40: 2020 7365 6c66 2e6d 6f72 655f 7472 6565    self.more_tree
-00026d50: 7320 3d20 7365 6c66 2e6d 6f72 655f 7472  s = self.more_tr
-00026d60: 6565 7320 616e 6420 7365 6c66 2e74 7265  ees and self.tre
-00026d70: 652e 6e65 7874 2829 0a20 2020 2020 2020  e.next().       
-00026d80: 2065 6c73 653a 0a20 2020 2020 2020 2020   else:.         
-00026d90: 2020 2073 656c 662e 6d6f 7265 5f74 7265     self.more_tre
-00026da0: 6573 203d 2073 656c 662e 6d6f 7265 5f74  es = self.more_t
-00026db0: 7265 6573 2061 6e64 2073 656c 662e 7472  rees and self.tr
-00026dc0: 6565 2e70 7265 7628 290a 2020 2020 2020  ee.prev().      
-00026dd0: 2020 6966 206e 6f74 2073 656c 662e 6d6f    if not self.mo
-00026de0: 7265 5f74 7265 6573 3a0a 2020 2020 2020  re_trees:.      
-00026df0: 2020 2020 2020 7261 6973 6520 5374 6f70        raise Stop
-00026e00: 4974 6572 6174 696f 6e28 290a 2020 2020  Iteration().    
-00026e10: 2020 2020 7265 7475 726e 2073 656c 662e      return self.
-00026e20: 7472 6565 0a0a 2020 2020 6465 6620 5f5f  tree..    def __
-00026e30: 6c65 6e5f 5f28 7365 6c66 293a 0a20 2020  len__(self):.   
-00026e40: 2020 2020 2072 6574 7572 6e20 7365 6c66       return self
-00026e50: 2e74 7265 652e 7472 6565 5f73 6571 7565  .tree.tree_seque
-00026e60: 6e63 652e 6e75 6d5f 7472 6565 730a 0a0a  nce.num_trees...
-00026e70: 636c 6173 7320 5369 6d70 6c65 436f 6e74  class SimpleCont
-00026e80: 6169 6e65 7253 6571 7565 6e63 653a 0a20  ainerSequence:. 
-00026e90: 2020 2022 2222 0a20 2020 2053 696d 706c     """.    Simpl
-00026ea0: 6520 7772 6170 7065 7220 746f 2061 6c6c  e wrapper to all
-00026eb0: 6f77 2061 7272 6179 7320 6f66 2053 696d  ow arrays of Sim
-00026ec0: 706c 6543 6f6e 7461 696e 6572 7320 2865  pleContainers (e
-00026ed0: 2e67 2e20 6564 6765 732c 206e 6f64 6573  .g. edges, nodes
-00026ee0: 2920 7468 6174 2068 6176 6520 610a 2020  ) that have a.  
-00026ef0: 2020 6675 6e63 7469 6f6e 2061 6c6c 6f77    function allow
-00026f00: 696e 6720 6163 6365 7373 2062 7920 696e  ing access by in
-00026f10: 6465 7820 2865 2e67 2e20 7473 2e65 6467  dex (e.g. ts.edg
-00026f20: 6528 6929 2c20 7473 2e6e 6f64 6528 6929  e(i), ts.node(i)
-00026f30: 2920 746f 2062 6520 7472 6561 7465 6420  ) to be treated 
-00026f40: 6173 2061 0a20 2020 2070 7974 686f 6e20  as a.    python 
-00026f50: 7365 7175 656e 6365 2c20 616c 6c6f 7769  sequence, allowi
-00026f60: 6e67 2066 6f72 7761 7264 2061 6e64 2072  ng forward and r
-00026f70: 6576 6572 7365 2069 7465 7261 7469 6f6e  everse iteration
-00026f80: 2e0a 0a20 2020 2054 6f20 6765 6e65 7261  ...    To genera
-00026f90: 7465 2061 2073 6571 7565 6e63 6520 6f66  te a sequence of
-00026fa0: 2069 7465 6d73 2069 6e20 6120 6469 6666   items in a diff
-00026fb0: 6572 656e 7420 6f72 6465 722c 2074 6865  erent order, the
-00026fc0: 2060 606f 7264 6572 6060 2070 6172 616d   ``order`` param
-00026fd0: 6574 6572 2061 6c6c 6f77 730a 2020 2020  eter allows.    
-00026fe0: 616e 2061 7272 6179 206f 6620 696e 6465  an array of inde
-00026ff0: 7865 7320 746f 2062 6520 7061 7373 6564  xes to be passed
-00027000: 2069 6e2c 2073 7563 6820 6173 2072 6574   in, such as ret
-00027010: 7572 6e65 6420 6672 6f6d 206e 702e 6172  urned from np.ar
-00027020: 6773 6f72 7420 6f72 206e 702e 6c65 7873  gsort or np.lexs
-00027030: 6f72 742e 0a20 2020 2022 2222 0a0a 2020  ort..    """..  
-00027040: 2020 6465 6620 5f5f 696e 6974 5f5f 2873    def __init__(s
-00027050: 656c 662c 2067 6574 7465 722c 206c 656e  elf, getter, len
-00027060: 6774 682c 206f 7264 6572 3d4e 6f6e 6529  gth, order=None)
-00027070: 3a0a 2020 2020 2020 2020 6966 206f 7264  :.        if ord
-00027080: 6572 2069 7320 4e6f 6e65 3a0a 2020 2020  er is None:.    
-00027090: 2020 2020 2020 2020 7365 6c66 2e67 6574          self.get
-000270a0: 7465 7220 3d20 6765 7474 6572 0a20 2020  ter = getter.   
-000270b0: 2020 2020 2065 6c73 653a 0a20 2020 2020       else:.     
-000270c0: 2020 2020 2020 2073 656c 662e 6765 7474         self.gett
-000270d0: 6572 203d 206c 616d 6264 6120 696e 6465  er = lambda inde
-000270e0: 783a 2067 6574 7465 7228 6f72 6465 725b  x: getter(order[
-000270f0: 696e 6465 785d 290a 2020 2020 2020 2020  index]).        
-00027100: 7365 6c66 2e6c 656e 6774 6820 3d20 6c65  self.length = le
-00027110: 6e67 7468 0a0a 2020 2020 6465 6620 5f5f  ngth..    def __
-00027120: 6c65 6e5f 5f28 7365 6c66 293a 0a20 2020  len__(self):.   
-00027130: 2020 2020 2072 6574 7572 6e20 7365 6c66       return self
-00027140: 2e6c 656e 6774 680a 0a20 2020 2064 6566  .length..    def
-00027150: 205f 5f67 6574 6974 656d 5f5f 2873 656c   __getitem__(sel
-00027160: 662c 2069 6e64 6578 293a 0a20 2020 2020  f, index):.     
-00027170: 2020 2072 6574 7572 6e20 7365 6c66 2e67     return self.g
-00027180: 6574 7465 7228 696e 6465 7829 0a0a 0a40  etter(index)...@
-00027190: 6461 7461 636c 6173 7328 6672 6f7a 656e  dataclass(frozen
-000271a0: 3d54 7275 6529 0a63 6c61 7373 2054 6162  =True).class Tab
-000271b0: 6c65 4d65 7461 6461 7461 5363 6865 6d61  leMetadataSchema
-000271c0: 733a 0a20 2020 2022 2222 0a20 2020 2043  s:.    """.    C
-000271d0: 6f6e 7665 6e69 656e 6365 2063 6c61 7373  onvenience class
-000271e0: 2066 6f72 2072 6574 7572 6e69 6e67 2074   for returning t
-000271f0: 6865 2073 6368 656d 6173 206f 6620 616c  he schemas of al
-00027200: 6c20 7468 6520 7461 626c 6573 2069 6e20  l the tables in 
-00027210: 6120 7472 6565 2073 6571 7565 6e63 652e  a tree sequence.
-00027220: 0a20 2020 2022 2222 0a0a 2020 2020 6e6f  .    """..    no
-00027230: 6465 3a20 6d65 7461 6461 7461 5f6d 6f64  de: metadata_mod
-00027240: 756c 652e 4d65 7461 6461 7461 5363 6865  ule.MetadataSche
-00027250: 6d61 203d 204e 6f6e 650a 2020 2020 2222  ma = None.    ""
-00027260: 220a 2020 2020 5468 6520 6d65 7461 6461  ".    The metada
-00027270: 7461 2073 6368 656d 6120 6f66 2074 6865  ta schema of the
-00027280: 206e 6f64 6520 7461 626c 652e 0a20 2020   node table..   
-00027290: 2022 2222 0a0a 2020 2020 6564 6765 3a20   """..    edge: 
-000272a0: 6d65 7461 6461 7461 5f6d 6f64 756c 652e  metadata_module.
-000272b0: 4d65 7461 6461 7461 5363 6865 6d61 203d  MetadataSchema =
-000272c0: 204e 6f6e 650a 2020 2020 2222 220a 2020   None.    """.  
-000272d0: 2020 5468 6520 6d65 7461 6461 7461 2073    The metadata s
-000272e0: 6368 656d 6120 6f66 2074 6865 2065 6467  chema of the edg
-000272f0: 6520 7461 626c 652e 0a20 2020 2022 2222  e table..    """
-00027300: 0a0a 2020 2020 7369 7465 3a20 6d65 7461  ..    site: meta
-00027310: 6461 7461 5f6d 6f64 756c 652e 4d65 7461  data_module.Meta
-00027320: 6461 7461 5363 6865 6d61 203d 204e 6f6e  dataSchema = Non
-00027330: 650a 2020 2020 2222 220a 2020 2020 5468  e.    """.    Th
-00027340: 6520 6d65 7461 6461 7461 2073 6368 656d  e metadata schem
-00027350: 6120 6f66 2074 6865 2073 6974 6520 7461  a of the site ta
-00027360: 626c 652e 0a20 2020 2022 2222 0a0a 2020  ble..    """..  
-00027370: 2020 6d75 7461 7469 6f6e 3a20 6d65 7461    mutation: meta
-00027380: 6461 7461 5f6d 6f64 756c 652e 4d65 7461  data_module.Meta
-00027390: 6461 7461 5363 6865 6d61 203d 204e 6f6e  dataSchema = Non
-000273a0: 650a 2020 2020 2222 220a 2020 2020 5468  e.    """.    Th
-000273b0: 6520 6d65 7461 6461 7461 2073 6368 656d  e metadata schem
-000273c0: 6120 6f66 2074 6865 206d 7574 6174 696f  a of the mutatio
-000273d0: 6e20 7461 626c 652e 0a20 2020 2022 2222  n table..    """
-000273e0: 0a0a 2020 2020 6d69 6772 6174 696f 6e3a  ..    migration:
-000273f0: 206d 6574 6164 6174 615f 6d6f 6475 6c65   metadata_module
-00027400: 2e4d 6574 6164 6174 6153 6368 656d 6120  .MetadataSchema 
-00027410: 3d20 4e6f 6e65 0a20 2020 2022 2222 0a20  = None.    """. 
-00027420: 2020 2054 6865 206d 6574 6164 6174 6120     The metadata 
-00027430: 7363 6865 6d61 206f 6620 7468 6520 6d69  schema of the mi
-00027440: 6772 6174 696f 6e20 7461 626c 652e 0a20  gration table.. 
-00027450: 2020 2022 2222 0a0a 2020 2020 696e 6469     """..    indi
-00027460: 7669 6475 616c 3a20 6d65 7461 6461 7461  vidual: metadata
-00027470: 5f6d 6f64 756c 652e 4d65 7461 6461 7461  _module.Metadata
-00027480: 5363 6865 6d61 203d 204e 6f6e 650a 2020  Schema = None.  
-00027490: 2020 2222 220a 2020 2020 5468 6520 6d65    """.    The me
-000274a0: 7461 6461 7461 2073 6368 656d 6120 6f66  tadata schema of
-000274b0: 2074 6865 2069 6e64 6976 6964 7561 6c20   the individual 
-000274c0: 7461 626c 652e 0a20 2020 2022 2222 0a0a  table..    """..
-000274d0: 2020 2020 706f 7075 6c61 7469 6f6e 3a20      population: 
-000274e0: 6d65 7461 6461 7461 5f6d 6f64 756c 652e  metadata_module.
-000274f0: 4d65 7461 6461 7461 5363 6865 6d61 203d  MetadataSchema =
-00027500: 204e 6f6e 650a 2020 2020 2222 220a 2020   None.    """.  
-00027510: 2020 5468 6520 6d65 7461 6461 7461 2073    The metadata s
-00027520: 6368 656d 6120 6f66 2074 6865 2070 6f70  chema of the pop
-00027530: 756c 6174 696f 6e20 7461 626c 652e 0a20  ulation table.. 
-00027540: 2020 2022 2222 0a0a 0a63 6c61 7373 2054     """...class T
-00027550: 7265 6553 6571 7565 6e63 653a 0a20 2020  reeSequence:.   
-00027560: 2022 2222 0a20 2020 2041 2073 696e 676c   """.    A singl
-00027570: 6520 7472 6565 2073 6571 7565 6e63 652c  e tree sequence,
-00027580: 2061 7320 6465 6669 6e65 6420 6279 2074   as defined by t
-00027590: 6865 203a 7265 663a 6064 6174 6120 6d6f  he :ref:`data mo
-000275a0: 6465 6c20 3c73 6563 5f64 6174 615f 6d6f  del <sec_data_mo
-000275b0: 6465 6c3e 602e 0a20 2020 2041 2054 7265  del>`..    A Tre
-000275c0: 6553 6571 7565 6e63 6520 696e 7374 616e  eSequence instan
-000275d0: 6365 2063 616e 2062 6520 6372 6561 7465  ce can be create
-000275e0: 6420 6672 6f6d 2061 2073 6574 206f 660a  d from a set of.
-000275f0: 2020 2020 3a72 6566 3a60 7461 626c 6573      :ref:`tables
-00027600: 203c 7365 635f 7461 626c 655f 6465 6669   <sec_table_defi
-00027610: 6e69 7469 6f6e 733e 6020 7573 696e 670a  nitions>` using.
-00027620: 2020 2020 3a6d 6574 683a 6054 6162 6c65      :meth:`Table
-00027630: 436f 6c6c 6563 7469 6f6e 2e74 7265 655f  Collection.tree_
-00027640: 7365 7175 656e 6365 602c 206f 7220 6c6f  sequence`, or lo
-00027650: 6164 6564 2066 726f 6d20 6120 7365 7420  aded from a set 
-00027660: 6f66 2074 6578 7420 6669 6c65 730a 2020  of text files.  
-00027670: 2020 7573 696e 6720 3a66 756e 633a 6074    using :func:`t
-00027680: 736b 6974 2e6c 6f61 645f 7465 7874 602c  skit.load_text`,
-00027690: 206f 7220 6c6f 6164 6564 2066 726f 6d20   or loaded from 
-000276a0: 6120 6e61 7469 7665 2062 696e 6172 7920  a native binary 
-000276b0: 6669 6c65 2075 7369 6e67 0a20 2020 203a  file using.    :
-000276c0: 6675 6e63 3a60 7473 6b69 742e 6c6f 6164  func:`tskit.load
-000276d0: 602e 0a0a 2020 2020 5472 6565 5365 7175  `...    TreeSequ
-000276e0: 656e 6365 7320 6172 6520 696d 6d75 7461  ences are immuta
-000276f0: 626c 652e 2054 6f20 6368 616e 6765 2074  ble. To change t
-00027700: 6865 2064 6174 6120 6865 6c64 2069 6e20  he data held in 
-00027710: 6120 7061 7274 6963 756c 6172 0a20 2020  a particular.   
-00027720: 2074 7265 6520 7365 7175 656e 6365 2c20   tree sequence, 
-00027730: 6669 7273 7420 6765 7420 7468 6520 7461  first get the ta
-00027740: 626c 6520 696e 666f 726d 6174 696f 6e20  ble information 
-00027750: 6173 2061 203a 636c 6173 733a 6054 6162  as a :class:`Tab
-00027760: 6c65 436f 6c6c 6563 7469 6f6e 600a 2020  leCollection`.  
-00027770: 2020 696e 7374 616e 6365 2028 7573 696e    instance (usin
-00027780: 6720 3a6d 6574 683a 602e 6475 6d70 5f74  g :meth:`.dump_t
-00027790: 6162 6c65 7360 292c 2065 6469 7420 7468  ables`), edit th
-000277a0: 6f73 6520 7461 626c 6573 2075 7369 6e67  ose tables using
-000277b0: 2074 6865 0a20 2020 203a 7265 663a 6074   the.    :ref:`t
-000277c0: 6162 6c65 7320 6170 6920 3c73 6563 5f74  ables api <sec_t
-000277d0: 6162 6c65 735f 6170 693e 602c 2061 6e64  ables_api>`, and
-000277e0: 2063 7265 6174 6520 6120 6e65 7720 7472   create a new tr
-000277f0: 6565 2073 6571 7565 6e63 6520 7573 696e  ee sequence usin
-00027800: 670a 2020 2020 3a6d 6574 683a 6054 6162  g.    :meth:`Tab
-00027810: 6c65 436f 6c6c 6563 7469 6f6e 2e74 7265  leCollection.tre
-00027820: 655f 7365 7175 656e 6365 602e 0a0a 2020  e_sequence`...  
-00027830: 2020 5468 6520 3a6d 6574 683a 602e 7472    The :meth:`.tr
-00027840: 6565 7360 206d 6574 686f 6420 6974 6572  ees` method iter
-00027850: 6174 6573 206f 7665 7220 616c 6c20 7472  ates over all tr
-00027860: 6565 7320 696e 2061 2074 7265 6520 7365  ees in a tree se
-00027870: 7175 656e 6365 2c20 616e 640a 2020 2020  quence, and.    
-00027880: 7468 6520 3a6d 6574 683a 602e 7661 7269  the :meth:`.vari
-00027890: 616e 7473 6020 6d65 7468 6f64 2069 7465  ants` method ite
-000278a0: 7261 7465 7320 6f76 6572 2061 6c6c 2073  rates over all s
-000278b0: 6974 6573 2061 6e64 2074 6865 6972 2067  ites and their g
-000278c0: 656e 6f74 7970 6573 2e0a 2020 2020 2222  enotypes..    ""
-000278d0: 220a 0a20 2020 2064 6566 205f 5f69 6e69  "..    def __ini
-000278e0: 745f 5f28 7365 6c66 2c20 6c6c 5f74 7265  t__(self, ll_tre
-000278f0: 655f 7365 7175 656e 6365 293a 0a20 2020  e_sequence):.   
-00027900: 2020 2020 2073 656c 662e 5f6c 6c5f 7472       self._ll_tr
-00027910: 6565 5f73 6571 7565 6e63 6520 3d20 6c6c  ee_sequence = ll
-00027920: 5f74 7265 655f 7365 7175 656e 6365 0a20  _tree_sequence. 
-00027930: 2020 2020 2020 206d 6574 6164 6174 615f         metadata_
-00027940: 7363 6865 6d61 5f73 7472 696e 6773 203d  schema_strings =
-00027950: 2073 656c 662e 5f6c 6c5f 7472 6565 5f73   self._ll_tree_s
-00027960: 6571 7565 6e63 652e 6765 745f 7461 626c  equence.get_tabl
-00027970: 655f 6d65 7461 6461 7461 5f73 6368 656d  e_metadata_schem
-00027980: 6173 2829 0a20 2020 2020 2020 206d 6574  as().        met
-00027990: 6164 6174 615f 7363 6865 6d61 5f69 6e73  adata_schema_ins
-000279a0: 7461 6e63 6573 203d 207b 0a20 2020 2020  tances = {.     
-000279b0: 2020 2020 2020 206e 616d 653a 206d 6574         name: met
-000279c0: 6164 6174 615f 6d6f 6475 6c65 2e70 6172  adata_module.par
-000279d0: 7365 5f6d 6574 6164 6174 615f 7363 6865  se_metadata_sche
-000279e0: 6d61 280a 2020 2020 2020 2020 2020 2020  ma(.            
-000279f0: 2020 2020 6765 7461 7474 7228 6d65 7461      getattr(meta
-00027a00: 6461 7461 5f73 6368 656d 615f 7374 7269  data_schema_stri
-00027a10: 6e67 732c 206e 616d 6529 0a20 2020 2020  ngs, name).     
-00027a20: 2020 2020 2020 2029 0a20 2020 2020 2020         ).       
-00027a30: 2020 2020 2066 6f72 206e 616d 6520 696e       for name in
-00027a40: 2076 6172 7328 5461 626c 654d 6574 6164   vars(TableMetad
-00027a50: 6174 6153 6368 656d 6173 290a 2020 2020  ataSchemas).    
-00027a60: 2020 2020 2020 2020 6966 206e 6f74 206e          if not n
-00027a70: 616d 652e 7374 6172 7473 7769 7468 2822  ame.startswith("
-00027a80: 5f22 290a 2020 2020 2020 2020 7d0a 2020  _").        }.  
-00027a90: 2020 2020 2020 7365 6c66 2e5f 7461 626c        self._tabl
-00027aa0: 655f 6d65 7461 6461 7461 5f73 6368 656d  e_metadata_schem
-00027ab0: 6173 203d 2054 6162 6c65 4d65 7461 6461  as = TableMetada
-00027ac0: 7461 5363 6865 6d61 7328 2a2a 6d65 7461  taSchemas(**meta
-00027ad0: 6461 7461 5f73 6368 656d 615f 696e 7374  data_schema_inst
-00027ae0: 616e 6365 7329 0a20 2020 2020 2020 2073  ances).        s
-00027af0: 656c 662e 5f69 6e64 6976 6964 7561 6c73  elf._individuals
-00027b00: 5f74 696d 6520 3d20 4e6f 6e65 0a20 2020  _time = None.   
-00027b10: 2020 2020 2073 656c 662e 5f69 6e64 6976       self._indiv
-00027b20: 6964 7561 6c73 5f70 6f70 756c 6174 696f  iduals_populatio
-00027b30: 6e20 3d20 4e6f 6e65 0a20 2020 2020 2020  n = None.       
-00027b40: 2073 656c 662e 5f69 6e64 6976 6964 7561   self._individua
-00027b50: 6c73 5f6c 6f63 6174 696f 6e20 3d20 4e6f  ls_location = No
-00027b60: 6e65 0a20 2020 2020 2020 2023 204e 4f54  ne.        # NOT
-00027b70: 453a 2077 6865 6e20 7765 2776 6520 696d  E: when we've im
-00027b80: 706c 656d 656e 7465 6420 7265 6164 2d6f  plemented read-o
-00027b90: 6e6c 7920 6163 6365 7373 2076 6961 2074  nly access via t
-00027ba0: 6865 2075 6e64 6572 6c79 696e 670a 2020  he underlying.  
-00027bb0: 2020 2020 2020 2320 7461 626c 6573 2077        # tables w
-00027bc0: 6520 6361 6e20 7265 706c 6163 6520 7468  e can replace th
-00027bd0: 6573 6520 6172 7261 7973 2077 6974 6820  ese arrays with 
-00027be0: 7265 6665 7265 6e63 6520 746f 2074 6865  reference to the
-00027bf0: 2072 6561 642d 6f6e 6c79 0a20 2020 2020   read-only.     
-00027c00: 2020 2023 2074 6162 6c65 7320 6865 7265     # tables here
-00027c10: 2028 616e 6420 7265 6d6f 7665 2074 6865   (and remove the
-00027c20: 206c 6f77 2d6c 6576 656c 2062 6f69 6c65   low-level boile
-00027c30: 7270 6c61 7465 292e 0a20 2020 2020 2020  rplate)..       
-00027c40: 206c 6c74 7320 3d20 7365 6c66 2e5f 6c6c   llts = self._ll
-00027c50: 5f74 7265 655f 7365 7175 656e 6365 0a20  _tree_sequence. 
-00027c60: 2020 2020 2020 2073 656c 662e 5f69 6e64         self._ind
-00027c70: 6976 6964 7561 6c73 5f66 6c61 6773 203d  ividuals_flags =
-00027c80: 206c 6c74 732e 696e 6469 7669 6475 616c   llts.individual
-00027c90: 735f 666c 6167 730a 2020 2020 2020 2020  s_flags.        
-00027ca0: 7365 6c66 2e5f 6e6f 6465 735f 7469 6d65  self._nodes_time
-00027cb0: 203d 206c 6c74 732e 6e6f 6465 735f 7469   = llts.nodes_ti
-00027cc0: 6d65 0a20 2020 2020 2020 2073 656c 662e  me.        self.
-00027cd0: 5f6e 6f64 6573 5f66 6c61 6773 203d 206c  _nodes_flags = l
-00027ce0: 6c74 732e 6e6f 6465 735f 666c 6167 730a  lts.nodes_flags.
-00027cf0: 2020 2020 2020 2020 7365 6c66 2e5f 6e6f          self._no
-00027d00: 6465 735f 706f 7075 6c61 7469 6f6e 203d  des_population =
-00027d10: 206c 6c74 732e 6e6f 6465 735f 706f 7075   llts.nodes_popu
-00027d20: 6c61 7469 6f6e 0a20 2020 2020 2020 2073  lation.        s
-00027d30: 656c 662e 5f6e 6f64 6573 5f69 6e64 6976  elf._nodes_indiv
-00027d40: 6964 7561 6c20 3d20 6c6c 7473 2e6e 6f64  idual = llts.nod
-00027d50: 6573 5f69 6e64 6976 6964 7561 6c0a 2020  es_individual.  
-00027d60: 2020 2020 2020 7365 6c66 2e5f 6564 6765        self._edge
-00027d70: 735f 6c65 6674 203d 206c 6c74 732e 6564  s_left = llts.ed
-00027d80: 6765 735f 6c65 6674 0a20 2020 2020 2020  ges_left.       
-00027d90: 2073 656c 662e 5f65 6467 6573 5f72 6967   self._edges_rig
-00027da0: 6874 203d 206c 6c74 732e 6564 6765 735f  ht = llts.edges_
-00027db0: 7269 6768 740a 2020 2020 2020 2020 7365  right.        se
-00027dc0: 6c66 2e5f 6564 6765 735f 7061 7265 6e74  lf._edges_parent
-00027dd0: 203d 206c 6c74 732e 6564 6765 735f 7061   = llts.edges_pa
-00027de0: 7265 6e74 0a20 2020 2020 2020 2073 656c  rent.        sel
-00027df0: 662e 5f65 6467 6573 5f63 6869 6c64 203d  f._edges_child =
-00027e00: 206c 6c74 732e 6564 6765 735f 6368 696c   llts.edges_chil
-00027e10: 640a 2020 2020 2020 2020 7365 6c66 2e5f  d.        self._
-00027e20: 7369 7465 735f 706f 7369 7469 6f6e 203d  sites_position =
-00027e30: 206c 6c74 732e 7369 7465 735f 706f 7369   llts.sites_posi
-00027e40: 7469 6f6e 0a20 2020 2020 2020 2073 656c  tion.        sel
-00027e50: 662e 5f6d 7574 6174 696f 6e73 5f73 6974  f._mutations_sit
-00027e60: 6520 3d20 6c6c 7473 2e6d 7574 6174 696f  e = llts.mutatio
-00027e70: 6e73 5f73 6974 650a 2020 2020 2020 2020  ns_site.        
-00027e80: 7365 6c66 2e5f 6d75 7461 7469 6f6e 735f  self._mutations_
-00027e90: 6e6f 6465 203d 206c 6c74 732e 6d75 7461  node = llts.muta
-00027ea0: 7469 6f6e 735f 6e6f 6465 0a20 2020 2020  tions_node.     
-00027eb0: 2020 2073 656c 662e 5f6d 7574 6174 696f     self._mutatio
-00027ec0: 6e73 5f70 6172 656e 7420 3d20 6c6c 7473  ns_parent = llts
-00027ed0: 2e6d 7574 6174 696f 6e73 5f70 6172 656e  .mutations_paren
-00027ee0: 740a 2020 2020 2020 2020 7365 6c66 2e5f  t.        self._
-00027ef0: 6d75 7461 7469 6f6e 735f 7469 6d65 203d  mutations_time =
-00027f00: 206c 6c74 732e 6d75 7461 7469 6f6e 735f   llts.mutations_
-00027f10: 7469 6d65 0a20 2020 2020 2020 2073 656c  time.        sel
-00027f20: 662e 5f6d 6967 7261 7469 6f6e 735f 6c65  f._migrations_le
-00027f30: 6674 203d 206c 6c74 732e 6d69 6772 6174  ft = llts.migrat
-00027f40: 696f 6e73 5f6c 6566 740a 2020 2020 2020  ions_left.      
-00027f50: 2020 7365 6c66 2e5f 6d69 6772 6174 696f    self._migratio
-00027f60: 6e73 5f72 6967 6874 203d 206c 6c74 732e  ns_right = llts.
-00027f70: 6d69 6772 6174 696f 6e73 5f72 6967 6874  migrations_right
-00027f80: 0a20 2020 2020 2020 2073 656c 662e 5f6d  .        self._m
-00027f90: 6967 7261 7469 6f6e 735f 7269 6768 7420  igrations_right 
-00027fa0: 3d20 6c6c 7473 2e6d 6967 7261 7469 6f6e  = llts.migration
-00027fb0: 735f 7269 6768 740a 2020 2020 2020 2020  s_right.        
-00027fc0: 7365 6c66 2e5f 6d69 6772 6174 696f 6e73  self._migrations
-00027fd0: 5f6e 6f64 6520 3d20 6c6c 7473 2e6d 6967  _node = llts.mig
-00027fe0: 7261 7469 6f6e 735f 6e6f 6465 0a20 2020  rations_node.   
-00027ff0: 2020 2020 2073 656c 662e 5f6d 6967 7261       self._migra
-00028000: 7469 6f6e 735f 736f 7572 6365 203d 206c  tions_source = l
-00028010: 6c74 732e 6d69 6772 6174 696f 6e73 5f73  lts.migrations_s
-00028020: 6f75 7263 650a 2020 2020 2020 2020 7365  ource.        se
-00028030: 6c66 2e5f 6d69 6772 6174 696f 6e73 5f64  lf._migrations_d
-00028040: 6573 7420 3d20 6c6c 7473 2e6d 6967 7261  est = llts.migra
-00028050: 7469 6f6e 735f 6465 7374 0a20 2020 2020  tions_dest.     
-00028060: 2020 2073 656c 662e 5f6d 6967 7261 7469     self._migrati
-00028070: 6f6e 735f 7469 6d65 203d 206c 6c74 732e  ons_time = llts.
-00028080: 6d69 6772 6174 696f 6e73 5f74 696d 650a  migrations_time.
-00028090: 2020 2020 2020 2020 7365 6c66 2e5f 696e          self._in
-000280a0: 6465 7865 735f 6564 6765 5f69 6e73 6572  dexes_edge_inser
-000280b0: 7469 6f6e 5f6f 7264 6572 203d 206c 6c74  tion_order = llt
-000280c0: 732e 696e 6465 7865 735f 6564 6765 5f69  s.indexes_edge_i
-000280d0: 6e73 6572 7469 6f6e 5f6f 7264 6572 0a20  nsertion_order. 
-000280e0: 2020 2020 2020 2073 656c 662e 5f69 6e64         self._ind
-000280f0: 6578 6573 5f65 6467 655f 7265 6d6f 7661  exes_edge_remova
-00028100: 6c5f 6f72 6465 7220 3d20 6c6c 7473 2e69  l_order = llts.i
-00028110: 6e64 6578 6573 5f65 6467 655f 7265 6d6f  ndexes_edge_remo
-00028120: 7661 6c5f 6f72 6465 720a 0a20 2020 2023  val_order..    #
-00028130: 2049 6d70 6c65 6d65 6e74 2074 6865 2070   Implement the p
-00028140: 6963 6b6c 6520 7072 6f74 6f63 6f6c 2066  ickle protocol f
-00028150: 6f72 2054 7265 6553 6571 7565 6e63 650a  or TreeSequence.
-00028160: 2020 2020 6465 6620 5f5f 6765 7473 7461      def __getsta
-00028170: 7465 5f5f 2873 656c 6629 3a0a 2020 2020  te__(self):.    
-00028180: 2020 2020 7265 7475 726e 2073 656c 662e      return self.
-00028190: 6475 6d70 5f74 6162 6c65 7328 290a 0a20  dump_tables().. 
-000281a0: 2020 2064 6566 205f 5f73 6574 7374 6174     def __setstat
-000281b0: 655f 5f28 7365 6c66 2c20 7463 293a 0a20  e__(self, tc):. 
-000281c0: 2020 2020 2020 2073 656c 662e 5f5f 696e         self.__in
-000281d0: 6974 5f5f 2874 632e 7472 6565 5f73 6571  it__(tc.tree_seq
-000281e0: 7565 6e63 6528 292e 6c6c 5f74 7265 655f  uence().ll_tree_
-000281f0: 7365 7175 656e 6365 290a 0a20 2020 2064  sequence)..    d
-00028200: 6566 205f 5f65 715f 5f28 7365 6c66 2c20  ef __eq__(self, 
-00028210: 6f74 6865 7229 3a0a 2020 2020 2020 2020  other):.        
-00028220: 7265 7475 726e 2073 656c 662e 7461 626c  return self.tabl
-00028230: 6573 203d 3d20 6f74 6865 722e 7461 626c  es == other.tabl
-00028240: 6573 0a0a 2020 2020 6465 6620 6571 7561  es..    def equa
-00028250: 6c73 280a 2020 2020 2020 2020 7365 6c66  ls(.        self
-00028260: 2c0a 2020 2020 2020 2020 6f74 6865 722c  ,.        other,
-00028270: 0a20 2020 2020 2020 202a 2c0a 2020 2020  .        *,.    
-00028280: 2020 2020 6967 6e6f 7265 5f6d 6574 6164      ignore_metad
-00028290: 6174 613d 4661 6c73 652c 0a20 2020 2020  ata=False,.     
-000282a0: 2020 2069 676e 6f72 655f 7473 5f6d 6574     ignore_ts_met
-000282b0: 6164 6174 613d 4661 6c73 652c 0a20 2020  adata=False,.   
-000282c0: 2020 2020 2069 676e 6f72 655f 7072 6f76       ignore_prov
-000282d0: 656e 616e 6365 3d46 616c 7365 2c0a 2020  enance=False,.  
-000282e0: 2020 2020 2020 6967 6e6f 7265 5f74 696d        ignore_tim
-000282f0: 6573 7461 6d70 733d 4661 6c73 652c 0a20  estamps=False,. 
-00028300: 2020 2020 2020 2069 676e 6f72 655f 7461         ignore_ta
-00028310: 626c 6573 3d46 616c 7365 2c0a 2020 2020  bles=False,.    
-00028320: 2020 2020 6967 6e6f 7265 5f72 6566 6572      ignore_refer
-00028330: 656e 6365 5f73 6571 7565 6e63 653d 4661  ence_sequence=Fa
-00028340: 6c73 652c 0a20 2020 2029 3a0a 2020 2020  lse,.    ):.    
-00028350: 2020 2020 2222 220a 2020 2020 2020 2020      """.        
-00028360: 5265 7475 726e 7320 5472 7565 2069 6620  Returns True if 
-00028370: 2060 7365 6c66 6020 616e 6420 606f 7468   `self` and `oth
-00028380: 6572 6020 6172 6520 6571 7561 6c2e 2055  er` are equal. U
-00028390: 7365 7320 7468 6520 756e 6465 726c 7969  ses the underlyi
-000283a0: 6e67 2074 6162 6c65 0a20 2020 2020 2020  ng table.       
-000283b0: 2065 7175 616c 6974 792c 2073 6565 203a   equality, see :
-000283c0: 6d65 7468 3a60 5461 626c 6543 6f6c 6c65  meth:`TableColle
-000283d0: 6374 696f 6e2e 6571 7561 6c73 6020 666f  ction.equals` fo
-000283e0: 7220 6465 7461 696c 7320 616e 6420 6f70  r details and op
-000283f0: 7469 6f6e 732e 0a20 2020 2020 2020 2022  tions..        "
-00028400: 2222 0a20 2020 2020 2020 2072 6574 7572  "".        retur
-00028410: 6e20 7365 6c66 2e74 6162 6c65 732e 6571  n self.tables.eq
-00028420: 7561 6c73 280a 2020 2020 2020 2020 2020  uals(.          
-00028430: 2020 6f74 6865 722e 7461 626c 6573 2c0a    other.tables,.
-00028440: 2020 2020 2020 2020 2020 2020 6967 6e6f              igno
-00028450: 7265 5f6d 6574 6164 6174 613d 6967 6e6f  re_metadata=igno
-00028460: 7265 5f6d 6574 6164 6174 612c 0a20 2020  re_metadata,.   
-00028470: 2020 2020 2020 2020 2069 676e 6f72 655f           ignore_
-00028480: 7473 5f6d 6574 6164 6174 613d 6967 6e6f  ts_metadata=igno
-00028490: 7265 5f74 735f 6d65 7461 6461 7461 2c0a  re_ts_metadata,.
-000284a0: 2020 2020 2020 2020 2020 2020 6967 6e6f              igno
-000284b0: 7265 5f70 726f 7665 6e61 6e63 653d 6967  re_provenance=ig
-000284c0: 6e6f 7265 5f70 726f 7665 6e61 6e63 652c  nore_provenance,
-000284d0: 0a20 2020 2020 2020 2020 2020 2069 676e  .            ign
-000284e0: 6f72 655f 7469 6d65 7374 616d 7073 3d69  ore_timestamps=i
-000284f0: 676e 6f72 655f 7469 6d65 7374 616d 7073  gnore_timestamps
-00028500: 2c0a 2020 2020 2020 2020 2020 2020 6967  ,.            ig
-00028510: 6e6f 7265 5f74 6162 6c65 733d 6967 6e6f  nore_tables=igno
-00028520: 7265 5f74 6162 6c65 732c 0a20 2020 2020  re_tables,.     
-00028530: 2020 2020 2020 2069 676e 6f72 655f 7265         ignore_re
-00028540: 6665 7265 6e63 655f 7365 7175 656e 6365  ference_sequence
-00028550: 3d69 676e 6f72 655f 7265 6665 7265 6e63  =ignore_referenc
-00028560: 655f 7365 7175 656e 6365 2c0a 2020 2020  e_sequence,.    
-00028570: 2020 2020 290a 0a20 2020 2040 7072 6f70      )..    @prop
-00028580: 6572 7479 0a20 2020 2064 6566 206c 6c5f  erty.    def ll_
-00028590: 7472 6565 5f73 6571 7565 6e63 6528 7365  tree_sequence(se
-000285a0: 6c66 293a 0a20 2020 2020 2020 2072 6574  lf):.        ret
-000285b0: 7572 6e20 7365 6c66 2e67 6574 5f6c 6c5f  urn self.get_ll_
-000285c0: 7472 6565 5f73 6571 7565 6e63 6528 290a  tree_sequence().
-000285d0: 0a20 2020 2064 6566 2067 6574 5f6c 6c5f  .    def get_ll_
-000285e0: 7472 6565 5f73 6571 7565 6e63 6528 7365  tree_sequence(se
-000285f0: 6c66 293a 0a20 2020 2020 2020 2072 6574  lf):.        ret
-00028600: 7572 6e20 7365 6c66 2e5f 6c6c 5f74 7265  urn self._ll_tre
-00028610: 655f 7365 7175 656e 6365 0a0a 2020 2020  e_sequence..    
-00028620: 6465 6620 6173 6c69 7374 2873 656c 662c  def aslist(self,
-00028630: 202a 2a6b 7761 7267 7329 3a0a 2020 2020   **kwargs):.    
-00028640: 2020 2020 2222 220a 2020 2020 2020 2020      """.        
-00028650: 5265 7475 726e 7320 7468 6520 7472 6565  Returns the tree
-00028660: 7320 696e 2074 6869 7320 7472 6565 2073  s in this tree s
-00028670: 6571 7565 6e63 6520 6173 2061 206c 6973  equence as a lis
-00028680: 742e 2045 6163 6820 7472 6565 2069 730a  t. Each tree is.
-00028690: 2020 2020 2020 2020 7265 7072 6573 656e          represen
-000286a0: 7465 6420 6279 2061 2064 6966 6665 7265  ted by a differe
-000286b0: 6e74 2069 6e73 7461 6e63 6520 6f66 203a  nt instance of :
-000286c0: 636c 6173 733a 6054 7265 6560 2e20 4173  class:`Tree`. As
-000286d0: 2073 7563 682c 2074 6869 730a 2020 2020   such, this.    
-000286e0: 2020 2020 6d65 7468 6f64 2069 7320 696e      method is in
-000286f0: 6566 6669 6369 656e 7420 616e 6420 6d61  efficient and ma
-00028700: 7920 7573 6520 6120 6c61 7267 6520 616d  y use a large am
-00028710: 6f75 6e74 206f 6620 6d65 6d6f 7279 2c20  ount of memory, 
-00028720: 616e 6420 7368 6f75 6c64 0a20 2020 2020  and should.     
-00028730: 2020 206e 6f74 2062 6520 7573 6564 2077     not be used w
-00028740: 6865 6e20 7065 7266 6f72 6d61 6e63 6520  hen performance 
-00028750: 6973 2061 2063 6f6e 7369 6465 7261 7469  is a considerati
-00028760: 6f6e 2e20 5468 6520 3a6d 6574 683a 602e  on. The :meth:`.
-00028770: 7472 6565 7360 0a20 2020 2020 2020 206d  trees`.        m
-00028780: 6574 686f 6420 6973 2074 6865 2072 6563  ethod is the rec
-00028790: 6f6d 6d65 6e64 6564 2077 6179 2074 6f20  ommended way to 
-000287a0: 6566 6669 6369 656e 746c 7920 6974 6572  efficiently iter
-000287b0: 6174 6520 6f76 6572 2074 6865 2074 7265  ate over the tre
-000287c0: 6573 0a20 2020 2020 2020 2069 6e20 6120  es.        in a 
-000287d0: 7472 6565 2073 6571 7565 6e63 652e 0a0a  tree sequence...
-000287e0: 2020 2020 2020 2020 3a70 6172 616d 205c          :param \
-000287f0: 5c2a 2a6b 7761 7267 733a 2046 7572 7468  \**kwargs: Furth
-00028800: 6572 2061 7267 756d 656e 7473 2075 7365  er arguments use
-00028810: 6420 6173 2070 6172 616d 6574 6572 7320  d as parameters 
-00028820: 7768 656e 2063 6f6e 7374 7275 6374 696e  when constructin
-00028830: 6720 7468 650a 2020 2020 2020 2020 2020  g the.          
-00028840: 2020 7265 7475 726e 6564 2074 7265 6573    returned trees
-00028850: 2e20 466f 7220 6578 616d 706c 6520 6060  . For example ``
-00028860: 7473 2e61 736c 6973 7428 7361 6d70 6c65  ts.aslist(sample
-00028870: 5f6c 6973 7473 3d54 7275 6529 6060 2077  _lists=True)`` w
-00028880: 696c 6c20 7265 7375 6c74 0a20 2020 2020  ill result.     
-00028890: 2020 2020 2020 2069 6e20 6120 6c69 7374         in a list
-000288a0: 206f 6620 3a63 6c61 7373 3a60 5472 6565   of :class:`Tree
-000288b0: 6020 696e 7374 616e 6365 7320 6372 6561  ` instances crea
-000288c0: 7465 6420 7769 7468 2060 6073 616d 706c  ted with ``sampl
-000288d0: 655f 6c69 7374 733d 5472 7565 6060 2e0a  e_lists=True``..
-000288e0: 2020 2020 2020 2020 3a72 6574 7572 6e3a          :return:
-000288f0: 2041 206c 6973 7420 6f66 2074 6865 2074   A list of the t
-00028900: 7265 6573 2069 6e20 7468 6973 2074 7265  rees in this tre
-00028910: 6520 7365 7175 656e 6365 2e0a 2020 2020  e sequence..    
-00028920: 2020 2020 3a72 7479 7065 3a20 6c69 7374      :rtype: list
-00028930: 0a20 2020 2020 2020 2022 2222 0a20 2020  .        """.   
-00028940: 2020 2020 2072 6574 7572 6e20 5b74 7265       return [tre
-00028950: 652e 636f 7079 2829 2066 6f72 2074 7265  e.copy() for tre
-00028960: 6520 696e 2073 656c 662e 7472 6565 7328  e in self.trees(
-00028970: 2a2a 6b77 6172 6773 295d 0a0a 2020 2020  **kwargs)]..    
-00028980: 4063 6c61 7373 6d65 7468 6f64 0a20 2020  @classmethod.   
-00028990: 2064 6566 206c 6f61 6428 636c 732c 2066   def load(cls, f
-000289a0: 696c 655f 6f72 5f70 6174 682c 202a 2c20  ile_or_path, *, 
-000289b0: 736b 6970 5f74 6162 6c65 733d 4661 6c73  skip_tables=Fals
-000289c0: 652c 2073 6b69 705f 7265 6665 7265 6e63  e, skip_referenc
-000289d0: 655f 7365 7175 656e 6365 3d46 616c 7365  e_sequence=False
-000289e0: 293a 0a20 2020 2020 2020 2066 696c 652c  ):.        file,
-000289f0: 206c 6f63 616c 5f66 696c 6520 3d20 7574   local_file = ut
-00028a00: 696c 2e63 6f6e 7665 7274 5f66 696c 655f  il.convert_file_
-00028a10: 6c69 6b65 5f74 6f5f 6f70 656e 5f66 696c  like_to_open_fil
-00028a20: 6528 6669 6c65 5f6f 725f 7061 7468 2c20  e(file_or_path, 
-00028a30: 2272 6222 290a 2020 2020 2020 2020 7472  "rb").        tr
-00028a40: 793a 0a20 2020 2020 2020 2020 2020 2074  y:.            t
-00028a50: 7320 3d20 5f74 736b 6974 2e54 7265 6553  s = _tskit.TreeS
-00028a60: 6571 7565 6e63 6528 290a 2020 2020 2020  equence().      
-00028a70: 2020 2020 2020 7473 2e6c 6f61 6428 0a20        ts.load(. 
-00028a80: 2020 2020 2020 2020 2020 2020 2020 2066                 f
-00028a90: 696c 652c 0a20 2020 2020 2020 2020 2020  ile,.           
-00028aa0: 2020 2020 2073 6b69 705f 7461 626c 6573       skip_tables
-00028ab0: 3d73 6b69 705f 7461 626c 6573 2c0a 2020  =skip_tables,.  
-00028ac0: 2020 2020 2020 2020 2020 2020 2020 736b                sk
-00028ad0: 6970 5f72 6566 6572 656e 6365 5f73 6571  ip_reference_seq
-00028ae0: 7565 6e63 653d 736b 6970 5f72 6566 6572  uence=skip_refer
-00028af0: 656e 6365 5f73 6571 7565 6e63 652c 0a20  ence_sequence,. 
-00028b00: 2020 2020 2020 2020 2020 2029 0a20 2020             ).   
-00028b10: 2020 2020 2020 2020 2072 6574 7572 6e20           return 
-00028b20: 5472 6565 5365 7175 656e 6365 2874 7329  TreeSequence(ts)
-00028b30: 0a20 2020 2020 2020 2065 7863 6570 7420  .        except 
-00028b40: 7473 6b69 742e 4669 6c65 466f 726d 6174  tskit.FileFormat
-00028b50: 4572 726f 7220 6173 2065 3a0a 2020 2020  Error as e:.    
-00028b60: 2020 2020 2020 2020 7574 696c 2e72 6169          util.rai
-00028b70: 7365 5f6b 6e6f 776e 5f66 696c 655f 666f  se_known_file_fo
-00028b80: 726d 6174 5f65 7272 6f72 7328 6669 6c65  rmat_errors(file
-00028b90: 2c20 6529 0a20 2020 2020 2020 2066 696e  , e).        fin
-00028ba0: 616c 6c79 3a0a 2020 2020 2020 2020 2020  ally:.          
-00028bb0: 2020 6966 206c 6f63 616c 5f66 696c 653a    if local_file:
-00028bc0: 0a20 2020 2020 2020 2020 2020 2020 2020  .               
-00028bd0: 2066 696c 652e 636c 6f73 6528 290a 0a20   file.close().. 
-00028be0: 2020 2040 636c 6173 736d 6574 686f 640a     @classmethod.
-00028bf0: 2020 2020 6465 6620 6c6f 6164 5f74 6162      def load_tab
-00028c00: 6c65 7328 636c 732c 2074 6162 6c65 732c  les(cls, tables,
-00028c10: 202a 2c20 6275 696c 645f 696e 6465 7865   *, build_indexe
-00028c20: 733d 4661 6c73 6529 3a0a 2020 2020 2020  s=False):.      
-00028c30: 2020 7473 203d 205f 7473 6b69 742e 5472    ts = _tskit.Tr
-00028c40: 6565 5365 7175 656e 6365 2829 0a20 2020  eeSequence().   
-00028c50: 2020 2020 2074 732e 6c6f 6164 5f74 6162       ts.load_tab
-00028c60: 6c65 7328 7461 626c 6573 2e5f 6c6c 5f74  les(tables._ll_t
-00028c70: 6162 6c65 732c 2062 7569 6c64 5f69 6e64  ables, build_ind
-00028c80: 6578 6573 3d62 7569 6c64 5f69 6e64 6578  exes=build_index
-00028c90: 6573 290a 2020 2020 2020 2020 7265 7475  es).        retu
-00028ca0: 726e 2054 7265 6553 6571 7565 6e63 6528  rn TreeSequence(
-00028cb0: 7473 290a 0a20 2020 2064 6566 2064 756d  ts)..    def dum
-00028cc0: 7028 7365 6c66 2c20 6669 6c65 5f6f 725f  p(self, file_or_
-00028cd0: 7061 7468 2c20 7a6c 6962 5f63 6f6d 7072  path, zlib_compr
-00028ce0: 6573 7369 6f6e 3d46 616c 7365 293a 0a20  ession=False):. 
-00028cf0: 2020 2020 2020 2022 2222 0a20 2020 2020         """.     
-00028d00: 2020 2057 7269 7465 7320 7468 6520 7472     Writes the tr
-00028d10: 6565 2073 6571 7565 6e63 6520 746f 2074  ee sequence to t
-00028d20: 6865 2073 7065 6369 6669 6564 2070 6174  he specified pat
-00028d30: 6820 6f72 2066 696c 6520 6f62 6a65 6374  h or file object
-00028d40: 2e0a 0a20 2020 2020 2020 203a 7061 7261  ...        :para
-00028d50: 6d20 7374 7220 6669 6c65 5f6f 725f 7061  m str file_or_pa
-00028d60: 7468 3a20 5468 6520 6669 6c65 206f 626a  th: The file obj
-00028d70: 6563 7420 6f72 2070 6174 6820 746f 2077  ect or path to w
-00028d80: 7269 7465 2074 6865 2054 7265 6553 6571  rite the TreeSeq
-00028d90: 7565 6e63 6520 746f 2e0a 2020 2020 2020  uence to..      
-00028da0: 2020 3a70 6172 616d 2062 6f6f 6c20 7a6c    :param bool zl
-00028db0: 6962 5f63 6f6d 7072 6573 7369 6f6e 3a20  ib_compression: 
-00028dc0: 5468 6973 2070 6172 616d 6574 6572 2069  This parameter i
-00028dd0: 7320 6465 7072 6563 6174 6564 2061 6e64  s deprecated and
-00028de0: 2069 676e 6f72 6564 2e0a 2020 2020 2020   ignored..      
-00028df0: 2020 2222 220a 2020 2020 2020 2020 6966    """.        if
-00028e00: 207a 6c69 625f 636f 6d70 7265 7373 696f   zlib_compressio
-00028e10: 6e3a 0a20 2020 2020 2020 2020 2020 2023  n:.            #
-00028e20: 204e 6f74 653a 2074 6865 206d 7370 7269   Note: the mspri
-00028e30: 6d65 2043 4c49 2062 6566 6f72 6520 7665  me CLI before ve
-00028e40: 7273 696f 6e20 312e 3020 7573 6573 2074  rsion 1.0 uses t
-00028e50: 6869 7320 6f70 7469 6f6e 2c20 736f 2077  his option, so w
-00028e60: 6520 6e65 6564 0a20 2020 2020 2020 2020  e need.         
-00028e70: 2020 2023 2074 6f20 6b65 6570 2069 7420     # to keep it 
-00028e80: 696e 6465 6669 6e69 7465 6c79 2e0a 2020  indefinitely..  
-00028e90: 2020 2020 2020 2020 2020 7761 726e 696e            warnin
-00028ea0: 6773 2e77 6172 6e28 0a20 2020 2020 2020  gs.warn(.       
-00028eb0: 2020 2020 2020 2020 2022 5468 6520 7a6c           "The zl
-00028ec0: 6962 5f63 6f6d 7072 6573 7369 6f6e 206f  ib_compression o
-00028ed0: 7074 696f 6e20 6973 206e 6f20 6c6f 6e67  ption is no long
-00028ee0: 6572 2073 7570 706f 7274 6564 2061 6e64  er supported and
-00028ef0: 2069 7320 6967 6e6f 7265 6422 2c0a 2020   is ignored",.  
-00028f00: 2020 2020 2020 2020 2020 2020 2020 5275                Ru
-00028f10: 6e74 696d 6557 6172 6e69 6e67 2c0a 2020  ntimeWarning,.  
-00028f20: 2020 2020 2020 2020 2020 290a 2020 2020            ).    
-00028f30: 2020 2020 6669 6c65 2c20 6c6f 6361 6c5f      file, local_
-00028f40: 6669 6c65 203d 2075 7469 6c2e 636f 6e76  file = util.conv
-00028f50: 6572 745f 6669 6c65 5f6c 696b 655f 746f  ert_file_like_to
-00028f60: 5f6f 7065 6e5f 6669 6c65 2866 696c 655f  _open_file(file_
-00028f70: 6f72 5f70 6174 682c 2022 7762 2229 0a20  or_path, "wb"). 
-00028f80: 2020 2020 2020 2074 7279 3a0a 2020 2020         try:.    
-00028f90: 2020 2020 2020 2020 7365 6c66 2e5f 6c6c          self._ll
-00028fa0: 5f74 7265 655f 7365 7175 656e 6365 2e64  _tree_sequence.d
-00028fb0: 756d 7028 6669 6c65 290a 2020 2020 2020  ump(file).      
-00028fc0: 2020 6669 6e61 6c6c 793a 0a20 2020 2020    finally:.     
-00028fd0: 2020 2020 2020 2069 6620 6c6f 6361 6c5f         if local_
-00028fe0: 6669 6c65 3a0a 2020 2020 2020 2020 2020  file:.          
-00028ff0: 2020 2020 2020 6669 6c65 2e63 6c6f 7365        file.close
-00029000: 2829 0a0a 2020 2020 4070 726f 7065 7274  ()..    @propert
-00029010: 790a 2020 2020 6465 6620 7265 6665 7265  y.    def refere
-00029020: 6e63 655f 7365 7175 656e 6365 2873 656c  nce_sequence(sel
-00029030: 6629 3a0a 2020 2020 2020 2020 2222 220a  f):.        """.
-00029040: 2020 2020 2020 2020 5468 6520 3a63 6c61          The :cla
-00029050: 7373 3a60 2e52 6566 6572 656e 6365 5365  ss:`.ReferenceSe
-00029060: 7175 656e 6365 6020 6173 736f 6369 6174  quence` associat
-00029070: 6564 2077 6974 6820 7468 6973 203a 636c  ed with this :cl
-00029080: 6173 733a 602e 5472 6565 5365 7175 656e  ass:`.TreeSequen
-00029090: 6365 600a 2020 2020 2020 2020 6966 206f  ce`.        if o
-000290a0: 6e65 2069 7320 6465 6669 6e65 6420 2873  ne is defined (s
-000290b0: 6565 203a 6d65 7468 3a60 2e54 7265 6553  ee :meth:`.TreeS
-000290c0: 6571 7565 6e63 652e 6861 735f 7265 6665  equence.has_refe
-000290d0: 7265 6e63 655f 7365 7175 656e 6365 6029  rence_sequence`)
-000290e0: 2c0a 2020 2020 2020 2020 6f72 204e 6f6e  ,.        or Non
-000290f0: 6520 6f74 6865 7277 6973 652e 0a20 2020  e otherwise..   
-00029100: 2020 2020 2022 2222 0a20 2020 2020 2020       """.       
-00029110: 2069 6620 7365 6c66 2e68 6173 5f72 6566   if self.has_ref
-00029120: 6572 656e 6365 5f73 6571 7565 6e63 6528  erence_sequence(
-00029130: 293a 0a20 2020 2020 2020 2020 2020 2072  ):.            r
-00029140: 6574 7572 6e20 7461 626c 6573 2e52 6566  eturn tables.Ref
-00029150: 6572 656e 6365 5365 7175 656e 6365 2873  erenceSequence(s
-00029160: 656c 662e 5f6c 6c5f 7472 6565 5f73 6571  elf._ll_tree_seq
-00029170: 7565 6e63 652e 7265 6665 7265 6e63 655f  uence.reference_
-00029180: 7365 7175 656e 6365 290a 2020 2020 2020  sequence).      
-00029190: 2020 7265 7475 726e 204e 6f6e 650a 0a20    return None.. 
-000291a0: 2020 2064 6566 2068 6173 5f72 6566 6572     def has_refer
-000291b0: 656e 6365 5f73 6571 7565 6e63 6528 7365  ence_sequence(se
-000291c0: 6c66 293a 0a20 2020 2020 2020 2022 2222  lf):.        """
-000291d0: 0a20 2020 2020 2020 2052 6574 7572 6e73  .        Returns
-000291e0: 2054 7275 6520 6966 2074 6869 7320 3a63   True if this :c
-000291f0: 6c61 7373 3a60 2e54 7265 6553 6571 7565  lass:`.TreeSeque
-00029200: 6e63 6560 2068 6173 2061 6e20 6173 736f  nce` has an asso
-00029210: 6369 6174 6564 0a20 2020 2020 2020 203a  ciated.        :
-00029220: 7265 663a 6072 6566 6572 656e 6365 2073  ref:`reference s
-00029230: 6571 7565 6e63 653c 7365 635f 6461 7461  equence<sec_data
-00029240: 5f6d 6f64 656c 5f72 6566 6572 656e 6365  _model_reference
-00029250: 5f73 6571 7565 6e63 653e 602e 0a20 2020  _sequence>`..   
-00029260: 2020 2020 2022 2222 0a20 2020 2020 2020       """.       
-00029270: 2072 6574 7572 6e20 626f 6f6c 2873 656c   return bool(sel
-00029280: 662e 5f6c 6c5f 7472 6565 5f73 6571 7565  f._ll_tree_seque
-00029290: 6e63 652e 6861 735f 7265 6665 7265 6e63  nce.has_referenc
-000292a0: 655f 7365 7175 656e 6365 2829 290a 0a20  e_sequence()).. 
-000292b0: 2020 2040 7072 6f70 6572 7479 0a20 2020     @property.   
-000292c0: 2064 6566 2074 6162 6c65 735f 6469 6374   def tables_dict
-000292d0: 2873 656c 6629 3a0a 2020 2020 2020 2020  (self):.        
-000292e0: 2222 220a 2020 2020 2020 2020 5265 7475  """.        Retu
-000292f0: 726e 7320 6120 6469 6374 696f 6e61 7279  rns a dictionary
-00029300: 206d 6170 7069 6e67 206e 616d 6573 2074   mapping names t
-00029310: 6f20 7461 626c 6573 2069 6e20 7468 650a  o tables in the.
-00029320: 2020 2020 2020 2020 756e 6465 726c 7969          underlyi
-00029330: 6e67 203a 636c 6173 733a 602e 5461 626c  ng :class:`.Tabl
-00029340: 6543 6f6c 6c65 6374 696f 6e60 2e20 4571  eCollection`. Eq
-00029350: 7569 7661 6c65 6e74 2074 6f20 6361 6c6c  uivalent to call
-00029360: 696e 670a 2020 2020 2020 2020 6060 7473  ing.        ``ts
-00029370: 2e74 6162 6c65 732e 7461 626c 655f 6e61  .tables.table_na
-00029380: 6d65 5f6d 6170 6060 2e0a 2020 2020 2020  me_map``..      
-00029390: 2020 2222 220a 2020 2020 2020 2020 7265    """.        re
-000293a0: 7475 726e 2073 656c 662e 7461 626c 6573  turn self.tables
-000293b0: 2e74 6162 6c65 5f6e 616d 655f 6d61 700a  .table_name_map.
-000293c0: 0a20 2020 2040 7072 6f70 6572 7479 0a20  .    @property. 
-000293d0: 2020 2064 6566 2074 6162 6c65 7328 7365     def tables(se
-000293e0: 6c66 293a 0a20 2020 2020 2020 2022 2222  lf):.        """
-000293f0: 0a20 2020 2020 2020 2052 6574 7572 6e73  .        Returns
-00029400: 2074 6865 203a 636c 6173 733a 6074 6162   the :class:`tab
-00029410: 6c65 733c 5461 626c 6543 6f6c 6c65 6374  les<TableCollect
-00029420: 696f 6e3e 6020 756e 6465 726c 7969 6e67  ion>` underlying
-00029430: 2074 6869 7320 7472 6565 0a20 2020 2020   this tree.     
-00029440: 2020 2073 6571 7565 6e63 652c 2069 6e74     sequence, int
-00029450: 656e 6465 6420 666f 7220 7265 6164 2d6f  ended for read-o
-00029460: 6e6c 7920 6163 6365 7373 2e20 5365 6520  nly access. See 
-00029470: 3a6d 6574 683a 602e 6475 6d70 5f74 6162  :meth:`.dump_tab
-00029480: 6c65 7360 2069 6620 796f 7520 7769 7368  les` if you wish
-00029490: 0a20 2020 2020 2020 2074 6f20 6d6f 6469  .        to modi
-000294a0: 6679 2074 6865 2074 6162 6c65 732e 0a0a  fy the tables...
-000294b0: 2020 2020 2020 2020 2e2e 2077 6172 6e69          .. warni
-000294c0: 6e67 3a3a 2054 6869 7320 7072 6f70 6572  ng:: This proper
-000294d0: 7479 2063 7572 7265 6e74 6c79 2072 6574  ty currently ret
-000294e0: 7572 6e73 2061 2063 6f70 7920 6f66 2074  urns a copy of t
-000294f0: 6865 2074 6162 6c65 730a 2020 2020 2020  he tables.      
-00029500: 2020 2020 2020 756e 6465 726c 7969 6e67        underlying
-00029510: 2061 2074 7265 6520 7365 7175 656e 6365   a tree sequence
-00029520: 2062 7574 2069 7420 6d61 7920 7265 7475   but it may retu
-00029530: 726e 2061 2072 6561 642d 6f6e 6c79 0a20  rn a read-only. 
-00029540: 2020 2020 2020 2020 2020 202a 2a76 6965             **vie
-00029550: 772a 2a20 696e 2074 6865 2066 7574 7572  w** in the futur
-00029560: 652e 2054 6875 732c 2069 6620 7468 6520  e. Thus, if the 
-00029570: 7461 626c 6573 2077 696c 6c20 7375 6273  tables will subs
-00029580: 6571 7565 6e74 6c79 2062 650a 2020 2020  equently be.    
-00029590: 2020 2020 2020 2020 7570 6461 7465 642c          updated,
-000295a0: 2070 6c65 6173 6520 7573 6520 7468 6520   please use the 
-000295b0: 3a6d 6574 683a 602e 6475 6d70 5f74 6162  :meth:`.dump_tab
-000295c0: 6c65 7360 206d 6574 686f 6420 696e 7374  les` method inst
-000295d0: 6561 6420 6173 0a20 2020 2020 2020 2020  ead as.         
-000295e0: 2020 2074 6869 7320 7769 6c6c 2061 6c77     this will alw
-000295f0: 6179 7320 7265 7475 726e 2061 206e 6577  ays return a new
-00029600: 2063 6f70 7920 6f66 2074 6865 2054 6162   copy of the Tab
-00029610: 6c65 436f 6c6c 6563 7469 6f6e 2e0a 0a20  leCollection... 
-00029620: 2020 2020 2020 203a 7265 7475 726e 3a20         :return: 
-00029630: 4120 3a63 6c61 7373 3a60 5461 626c 6543  A :class:`TableC
-00029640: 6f6c 6c65 6374 696f 6e60 2063 6f6e 7461  ollection` conta
-00029650: 696e 696e 6720 616c 6c20 6120 636f 7079  ining all a copy
-00029660: 206f 6620 7468 650a 2020 2020 2020 2020   of the.        
-00029670: 2020 2020 7461 626c 6573 2075 6e64 6572      tables under
-00029680: 6c79 696e 6720 7468 6973 2074 7265 6520  lying this tree 
-00029690: 7365 7175 656e 6365 2e0a 2020 2020 2020  sequence..      
-000296a0: 2020 3a72 7479 7065 3a20 5461 626c 6543    :rtype: TableC
-000296b0: 6f6c 6c65 6374 696f 6e0a 2020 2020 2020  ollection.      
-000296c0: 2020 2222 220a 2020 2020 2020 2020 7265    """.        re
-000296d0: 7475 726e 2073 656c 662e 6475 6d70 5f74  turn self.dump_t
-000296e0: 6162 6c65 7328 290a 0a20 2020 2040 7072  ables()..    @pr
-000296f0: 6f70 6572 7479 0a20 2020 2064 6566 206e  operty.    def n
-00029700: 6279 7465 7328 7365 6c66 293a 0a20 2020  bytes(self):.   
-00029710: 2020 2020 2022 2222 0a20 2020 2020 2020       """.       
-00029720: 2052 6574 7572 6e73 2074 6865 2074 6f74   Returns the tot
-00029730: 616c 206e 756d 6265 7220 6f66 2062 7974  al number of byt
-00029740: 6573 2072 6571 7569 7265 6420 746f 2073  es required to s
-00029750: 746f 7265 2074 6865 2064 6174 610a 2020  tore the data.  
-00029760: 2020 2020 2020 696e 2074 6869 7320 7472        in this tr
-00029770: 6565 2073 6571 7565 6e63 652e 204e 6f74  ee sequence. Not
-00029780: 6520 7468 6174 2074 6869 7320 6d61 7920  e that this may 
-00029790: 6e6f 7420 6265 2065 7175 616c 2074 6f0a  not be equal to.
-000297a0: 2020 2020 2020 2020 7468 6520 6163 7475          the actu
-000297b0: 616c 206d 656d 6f72 7920 666f 6f74 7072  al memory footpr
-000297c0: 696e 742e 0a20 2020 2020 2020 2022 2222  int..        """
-000297d0: 0a20 2020 2020 2020 2072 6574 7572 6e20  .        return 
-000297e0: 7365 6c66 2e74 6162 6c65 732e 6e62 7974  self.tables.nbyt
-000297f0: 6573 0a0a 2020 2020 6465 6620 6475 6d70  es..    def dump
-00029800: 5f74 6162 6c65 7328 7365 6c66 293a 0a20  _tables(self):. 
-00029810: 2020 2020 2020 2022 2222 0a20 2020 2020         """.     
-00029820: 2020 2052 6574 7572 6e73 2061 206d 6f64     Returns a mod
-00029830: 6966 6961 626c 6520 636f 7079 206f 6620  ifiable copy of 
-00029840: 7468 6520 3a63 6c61 7373 3a60 7461 626c  the :class:`tabl
-00029850: 6573 3c54 6162 6c65 436f 6c6c 6563 7469  es<TableCollecti
-00029860: 6f6e 3e60 2064 6566 696e 696e 670a 2020  on>` defining.  
-00029870: 2020 2020 2020 7468 6973 2074 7265 6520        this tree 
-00029880: 7365 7175 656e 6365 2e0a 0a20 2020 2020  sequence...     
-00029890: 2020 203a 7265 7475 726e 3a20 4120 3a63     :return: A :c
-000298a0: 6c61 7373 3a60 5461 626c 6543 6f6c 6c65  lass:`TableColle
-000298b0: 6374 696f 6e60 2063 6f6e 7461 696e 696e  ction` containin
-000298c0: 6720 616c 6c20 7461 626c 6573 2075 6e64  g all tables und
-000298d0: 6572 6c79 696e 670a 2020 2020 2020 2020  erlying.        
-000298e0: 2020 2020 7468 6520 7472 6565 2073 6571      the tree seq
-000298f0: 7565 6e63 652e 0a20 2020 2020 2020 203a  uence..        :
-00029900: 7274 7970 653a 2054 6162 6c65 436f 6c6c  rtype: TableColl
-00029910: 6563 7469 6f6e 0a20 2020 2020 2020 2022  ection.        "
-00029920: 2222 0a20 2020 2020 2020 206c 6c5f 7461  "".        ll_ta
-00029930: 626c 6573 203d 205f 7473 6b69 742e 5461  bles = _tskit.Ta
-00029940: 626c 6543 6f6c 6c65 6374 696f 6e28 7365  bleCollection(se
-00029950: 6c66 2e73 6571 7565 6e63 655f 6c65 6e67  lf.sequence_leng
-00029960: 7468 290a 2020 2020 2020 2020 7365 6c66  th).        self
-00029970: 2e5f 6c6c 5f74 7265 655f 7365 7175 656e  ._ll_tree_sequen
-00029980: 6365 2e64 756d 705f 7461 626c 6573 286c  ce.dump_tables(l
-00029990: 6c5f 7461 626c 6573 290a 2020 2020 2020  l_tables).      
-000299a0: 2020 7265 7475 726e 2074 6162 6c65 732e    return tables.
-000299b0: 5461 626c 6543 6f6c 6c65 6374 696f 6e28  TableCollection(
-000299c0: 6c6c 5f74 6162 6c65 733d 6c6c 5f74 6162  ll_tables=ll_tab
-000299d0: 6c65 7329 0a0a 2020 2020 6465 6620 6475  les)..    def du
-000299e0: 6d70 5f74 6578 7428 0a20 2020 2020 2020  mp_text(.       
-000299f0: 2073 656c 662c 0a20 2020 2020 2020 206e   self,.        n
-00029a00: 6f64 6573 3d4e 6f6e 652c 0a20 2020 2020  odes=None,.     
-00029a10: 2020 2065 6467 6573 3d4e 6f6e 652c 0a20     edges=None,. 
-00029a20: 2020 2020 2020 2073 6974 6573 3d4e 6f6e         sites=Non
-00029a30: 652c 0a20 2020 2020 2020 206d 7574 6174  e,.        mutat
-00029a40: 696f 6e73 3d4e 6f6e 652c 0a20 2020 2020  ions=None,.     
-00029a50: 2020 2069 6e64 6976 6964 7561 6c73 3d4e     individuals=N
-00029a60: 6f6e 652c 0a20 2020 2020 2020 2070 6f70  one,.        pop
-00029a70: 756c 6174 696f 6e73 3d4e 6f6e 652c 0a20  ulations=None,. 
-00029a80: 2020 2020 2020 206d 6967 7261 7469 6f6e         migration
-00029a90: 733d 4e6f 6e65 2c0a 2020 2020 2020 2020  s=None,.        
-00029aa0: 7072 6f76 656e 616e 6365 733d 4e6f 6e65  provenances=None
-00029ab0: 2c0a 2020 2020 2020 2020 7072 6563 6973  ,.        precis
-00029ac0: 696f 6e3d 362c 0a20 2020 2020 2020 2065  ion=6,.        e
-00029ad0: 6e63 6f64 696e 673d 2275 7466 3822 2c0a  ncoding="utf8",.
-00029ae0: 2020 2020 2020 2020 6261 7365 3634 5f6d          base64_m
-00029af0: 6574 6164 6174 613d 5472 7565 2c0a 2020  etadata=True,.  
-00029b00: 2020 293a 0a20 2020 2020 2020 2022 2222    ):.        """
-00029b10: 0a20 2020 2020 2020 2057 7269 7465 7320  .        Writes 
-00029b20: 6120 7465 7874 2072 6570 7265 7365 6e74  a text represent
-00029b30: 6174 696f 6e20 6f66 2074 6865 2074 6162  ation of the tab
-00029b40: 6c65 7320 756e 6465 726c 7969 6e67 2074  les underlying t
-00029b50: 6865 2074 7265 6520 7365 7175 656e 6365  he tree sequence
-00029b60: 0a20 2020 2020 2020 2074 6f20 7468 6520  .        to the 
-00029b70: 7370 6563 6966 6965 6420 636f 6e6e 6563  specified connec
-00029b80: 7469 6f6e 732e 0a0a 2020 2020 2020 2020  tions...        
-00029b90: 4966 2042 6173 6536 3420 656e 636f 6469  If Base64 encodi
-00029ba0: 6e67 2069 7320 6e6f 7420 7573 6564 2c20  ng is not used, 
-00029bb0: 7468 656e 206d 6574 6164 6174 6120 7769  then metadata wi
-00029bc0: 6c6c 2062 6520 7361 7665 6420 6469 7265  ll be saved dire
-00029bd0: 6374 6c79 2c20 706f 7373 6962 6c79 0a20  ctly, possibly. 
-00029be0: 2020 2020 2020 2072 6573 756c 7469 6e67         resulting
-00029bf0: 2069 6e20 6572 726f 7273 2072 6561 6469   in errors readi
-00029c00: 6e67 2074 6865 2074 6162 6c65 7320 6261  ng the tables ba
-00029c10: 636b 2069 6e20 6966 206d 6574 6164 6174  ck in if metadat
-00029c20: 6120 696e 636c 7564 6573 2077 6869 7465  a includes white
-00029c30: 7370 6163 652e 0a0a 2020 2020 2020 2020  space...        
-00029c40: 3a70 6172 616d 2069 6f2e 5465 7874 494f  :param io.TextIO
-00029c50: 4261 7365 206e 6f64 6573 3a20 5468 6520  Base nodes: The 
-00029c60: 6669 6c65 2d6c 696b 6520 6f62 6a65 6374  file-like object
-00029c70: 2028 6861 7669 6e67 2061 202e 7772 6974   (having a .writ
-00029c80: 6528 2920 6d65 7468 6f64 2920 746f 0a20  e() method) to. 
-00029c90: 2020 2020 2020 2020 2020 2077 7269 7465             write
-00029ca0: 2074 6865 204e 6f64 6554 6162 6c65 2074   the NodeTable t
-00029cb0: 6f2e 0a20 2020 2020 2020 203a 7061 7261  o..        :para
-00029cc0: 6d20 696f 2e54 6578 7449 4f42 6173 6520  m io.TextIOBase 
-00029cd0: 6564 6765 733a 2054 6865 2066 696c 652d  edges: The file-
-00029ce0: 6c69 6b65 206f 626a 6563 7420 746f 2077  like object to w
-00029cf0: 7269 7465 2074 6865 2045 6467 6554 6162  rite the EdgeTab
-00029d00: 6c65 2074 6f2e 0a20 2020 2020 2020 203a  le to..        :
-00029d10: 7061 7261 6d20 696f 2e54 6578 7449 4f42  param io.TextIOB
-00029d20: 6173 6520 7369 7465 733a 2054 6865 2066  ase sites: The f
-00029d30: 696c 652d 6c69 6b65 206f 626a 6563 7420  ile-like object 
-00029d40: 746f 2077 7269 7465 2074 6865 2053 6974  to write the Sit
-00029d50: 6554 6162 6c65 2074 6f2e 0a20 2020 2020  eTable to..     
-00029d60: 2020 203a 7061 7261 6d20 696f 2e54 6578     :param io.Tex
-00029d70: 7449 4f42 6173 6520 6d75 7461 7469 6f6e  tIOBase mutation
-00029d80: 733a 2054 6865 2066 696c 652d 6c69 6b65  s: The file-like
-00029d90: 206f 626a 6563 7420 746f 2077 7269 7465   object to write
-00029da0: 2074 6865 0a20 2020 2020 2020 2020 2020   the.           
-00029db0: 204d 7574 6174 696f 6e54 6162 6c65 2074   MutationTable t
-00029dc0: 6f2e 0a20 2020 2020 2020 203a 7061 7261  o..        :para
-00029dd0: 6d20 696f 2e54 6578 7449 4f42 6173 6520  m io.TextIOBase 
-00029de0: 696e 6469 7669 6475 616c 733a 2054 6865  individuals: The
-00029df0: 2066 696c 652d 6c69 6b65 206f 626a 6563   file-like objec
-00029e00: 7420 746f 2077 7269 7465 2074 6865 0a20  t to write the. 
-00029e10: 2020 2020 2020 2020 2020 2049 6e64 6976             Indiv
-00029e20: 6964 7561 6c54 6162 6c65 2074 6f2e 0a20  idualTable to.. 
-00029e30: 2020 2020 2020 203a 7061 7261 6d20 696f         :param io
-00029e40: 2e54 6578 7449 4f42 6173 6520 706f 7075  .TextIOBase popu
-00029e50: 6c61 7469 6f6e 733a 2054 6865 2066 696c  lations: The fil
-00029e60: 652d 6c69 6b65 206f 626a 6563 7420 746f  e-like object to
-00029e70: 2077 7269 7465 2074 6865 0a20 2020 2020   write the.     
-00029e80: 2020 2020 2020 2050 6f70 756c 6174 696f         Populatio
-00029e90: 6e54 6162 6c65 2074 6f2e 0a20 2020 2020  nTable to..     
-00029ea0: 2020 203a 7061 7261 6d20 696f 2e54 6578     :param io.Tex
-00029eb0: 7449 4f42 6173 6520 6d69 6772 6174 696f  tIOBase migratio
-00029ec0: 6e73 3a20 5468 6520 6669 6c65 2d6c 696b  ns: The file-lik
-00029ed0: 6520 6f62 6a65 6374 2074 6f20 7772 6974  e object to writ
-00029ee0: 6520 7468 650a 2020 2020 2020 2020 2020  e the.          
-00029ef0: 2020 4d69 6772 6174 696f 6e54 6162 6c65    MigrationTable
-00029f00: 2074 6f2e 0a20 2020 2020 2020 203a 7061   to..        :pa
-00029f10: 7261 6d20 696f 2e54 6578 7449 4f42 6173  ram io.TextIOBas
-00029f20: 6520 7072 6f76 656e 616e 6365 733a 2054  e provenances: T
-00029f30: 6865 2066 696c 652d 6c69 6b65 206f 626a  he file-like obj
-00029f40: 6563 7420 746f 2077 7269 7465 2074 6865  ect to write the
-00029f50: 0a20 2020 2020 2020 2020 2020 2050 726f  .            Pro
-00029f60: 7665 6e61 6e63 6554 6162 6c65 2074 6f2e  venanceTable to.
-00029f70: 0a20 2020 2020 2020 203a 7061 7261 6d20  .        :param 
-00029f80: 696e 7420 7072 6563 6973 696f 6e3a 2054  int precision: T
-00029f90: 6865 206e 756d 6265 7220 6f66 2064 6967  he number of dig
-00029fa0: 6974 7320 6f66 2070 7265 6369 7369 6f6e  its of precision
-00029fb0: 2e0a 2020 2020 2020 2020 3a70 6172 616d  ..        :param
-00029fc0: 2073 7472 2065 6e63 6f64 696e 673a 2045   str encoding: E
-00029fd0: 6e63 6f64 696e 6720 7573 6564 2066 6f72  ncoding used for
-00029fe0: 2074 6578 7420 7265 7072 6573 656e 7461   text representa
-00029ff0: 7469 6f6e 2e0a 2020 2020 2020 2020 3a70  tion..        :p
-0002a000: 6172 616d 2062 6f6f 6c20 6261 7365 3634  aram bool base64
-0002a010: 5f6d 6574 6164 6174 613a 204f 6e6c 7920  _metadata: Only 
-0002a020: 7573 6564 2069 6620 6120 7363 6865 6d61  used if a schema
-0002a030: 2069 7320 6e6f 7420 7072 6573 656e 7420   is not present 
-0002a040: 6f6e 2065 6163 6820 7461 626c 650a 2020  on each table.  
-0002a050: 2020 2020 2020 2020 2020 6265 696e 6720            being 
-0002a060: 6475 6d70 6564 2e20 4966 2054 7275 652c  dumped. If True,
-0002a070: 206d 6574 6164 6174 6120 6973 2065 6e63   metadata is enc
-0002a080: 6f64 6564 2075 7369 6e67 2042 6173 6536  oded using Base6
-0002a090: 340a 2020 2020 2020 2020 2020 2020 656e  4.            en
-0002a0a0: 636f 6469 6e67 3b20 6f74 6865 7277 6973  coding; otherwis
-0002a0b0: 652c 2061 7320 706c 6169 6e20 7465 7874  e, as plain text
-0002a0c0: 2e0a 2020 2020 2020 2020 2222 220a 2020  ..        """.  
-0002a0d0: 2020 2020 2020 7465 7874 5f66 6f72 6d61        text_forma
-0002a0e0: 7473 2e64 756d 705f 7465 7874 280a 2020  ts.dump_text(.  
-0002a0f0: 2020 2020 2020 2020 2020 7365 6c66 2c0a            self,.
-0002a100: 2020 2020 2020 2020 2020 2020 6e6f 6465              node
-0002a110: 733d 6e6f 6465 732c 0a20 2020 2020 2020  s=nodes,.       
-0002a120: 2020 2020 2065 6467 6573 3d65 6467 6573       edges=edges
-0002a130: 2c0a 2020 2020 2020 2020 2020 2020 7369  ,.            si
-0002a140: 7465 733d 7369 7465 732c 0a20 2020 2020  tes=sites,.     
-0002a150: 2020 2020 2020 206d 7574 6174 696f 6e73         mutations
-0002a160: 3d6d 7574 6174 696f 6e73 2c0a 2020 2020  =mutations,.    
-0002a170: 2020 2020 2020 2020 696e 6469 7669 6475          individu
-0002a180: 616c 733d 696e 6469 7669 6475 616c 732c  als=individuals,
-0002a190: 0a20 2020 2020 2020 2020 2020 2070 6f70  .            pop
-0002a1a0: 756c 6174 696f 6e73 3d70 6f70 756c 6174  ulations=populat
-0002a1b0: 696f 6e73 2c0a 2020 2020 2020 2020 2020  ions,.          
-0002a1c0: 2020 6d69 6772 6174 696f 6e73 3d6d 6967    migrations=mig
-0002a1d0: 7261 7469 6f6e 732c 0a20 2020 2020 2020  rations,.       
-0002a1e0: 2020 2020 2070 726f 7665 6e61 6e63 6573       provenances
-0002a1f0: 3d70 726f 7665 6e61 6e63 6573 2c0a 2020  =provenances,.  
-0002a200: 2020 2020 2020 2020 2020 7072 6563 6973            precis
-0002a210: 696f 6e3d 7072 6563 6973 696f 6e2c 0a20  ion=precision,. 
-0002a220: 2020 2020 2020 2020 2020 2065 6e63 6f64             encod
-0002a230: 696e 673d 656e 636f 6469 6e67 2c0a 2020  ing=encoding,.  
-0002a240: 2020 2020 2020 2020 2020 6261 7365 3634            base64
-0002a250: 5f6d 6574 6164 6174 613d 6261 7365 3634  _metadata=base64
-0002a260: 5f6d 6574 6164 6174 612c 0a20 2020 2020  _metadata,.     
-0002a270: 2020 2029 0a0a 2020 2020 6465 6620 5f5f     )..    def __
-0002a280: 7374 725f 5f28 7365 6c66 293a 0a20 2020  str__(self):.   
-0002a290: 2020 2020 2022 2222 0a20 2020 2020 2020       """.       
-0002a2a0: 2052 6574 7572 6e20 6120 706c 6169 6e20   Return a plain 
-0002a2b0: 7465 7874 2073 756d 6d61 7279 206f 6620  text summary of 
-0002a2c0: 7468 6520 636f 6e74 656e 7473 206f 6620  the contents of 
-0002a2d0: 6120 7472 6565 2073 6571 7565 6e63 650a  a tree sequence.
-0002a2e0: 2020 2020 2020 2020 2222 220a 2020 2020          """.    
-0002a2f0: 2020 2020 7473 5f72 6f77 7320 3d20 5b0a      ts_rows = [.
-0002a300: 2020 2020 2020 2020 2020 2020 5b22 5472              ["Tr
-0002a310: 6565 7322 2c20 7374 7228 7365 6c66 2e6e  ees", str(self.n
-0002a320: 756d 5f74 7265 6573 295d 2c0a 2020 2020  um_trees)],.    
-0002a330: 2020 2020 2020 2020 5b0a 2020 2020 2020          [.      
-0002a340: 2020 2020 2020 2020 2020 2253 6571 7565            "Seque
-0002a350: 6e63 6520 4c65 6e67 7468 222c 0a20 2020  nce Length",.   
-0002a360: 2020 2020 2020 2020 2020 2020 2073 7472               str
-0002a370: 280a 2020 2020 2020 2020 2020 2020 2020  (.              
-0002a380: 2020 2020 2020 696e 7428 7365 6c66 2e73        int(self.s
-0002a390: 6571 7565 6e63 655f 6c65 6e67 7468 290a  equence_length).
-0002a3a0: 2020 2020 2020 2020 2020 2020 2020 2020                  
-0002a3b0: 2020 2020 6966 2073 656c 662e 6469 7363      if self.disc
-0002a3c0: 7265 7465 5f67 656e 6f6d 650a 2020 2020  rete_genome.    
-0002a3d0: 2020 2020 2020 2020 2020 2020 2020 2020                  
-0002a3e0: 656c 7365 2073 656c 662e 7365 7175 656e  else self.sequen
-0002a3f0: 6365 5f6c 656e 6774 680a 2020 2020 2020  ce_length.      
-0002a400: 2020 2020 2020 2020 2020 292c 0a20 2020            ),.   
-0002a410: 2020 2020 2020 2020 205d 2c0a 2020 2020           ],.    
-0002a420: 2020 2020 2020 2020 5b22 5469 6d65 2055          ["Time U
-0002a430: 6e69 7473 222c 2073 656c 662e 7469 6d65  nits", self.time
-0002a440: 5f75 6e69 7473 5d2c 0a20 2020 2020 2020  _units],.       
-0002a450: 2020 2020 205b 2253 616d 706c 6520 4e6f       ["Sample No
-0002a460: 6465 7322 2c20 7374 7228 7365 6c66 2e6e  des", str(self.n
-0002a470: 756d 5f73 616d 706c 6573 295d 2c0a 2020  um_samples)],.  
-0002a480: 2020 2020 2020 2020 2020 5b22 546f 7461            ["Tota
-0002a490: 6c20 5369 7a65 222c 2075 7469 6c2e 6e61  l Size", util.na
-0002a4a0: 7475 7261 6c73 697a 6528 7365 6c66 2e6e  turalsize(self.n
-0002a4b0: 6279 7465 7329 5d2c 0a20 2020 2020 2020  bytes)],.       
-0002a4c0: 205d 0a20 2020 2020 2020 2068 6561 6465   ].        heade
-0002a4d0: 7220 3d20 5b22 5461 626c 6522 2c20 2252  r = ["Table", "R
-0002a4e0: 6f77 7322 2c20 2253 697a 6522 2c20 2248  ows", "Size", "H
-0002a4f0: 6173 204d 6574 6164 6174 6122 5d0a 2020  as Metadata"].  
-0002a500: 2020 2020 2020 7461 626c 655f 726f 7773        table_rows
-0002a510: 203d 205b 5d0a 2020 2020 2020 2020 666f   = [].        fo
-0002a520: 7220 6e61 6d65 2c20 7461 626c 6520 696e  r name, table in
-0002a530: 2073 656c 662e 7461 626c 6573 2e74 6162   self.tables.tab
-0002a540: 6c65 5f6e 616d 655f 6d61 702e 6974 656d  le_name_map.item
-0002a550: 7328 293a 0a20 2020 2020 2020 2020 2020  s():.           
-0002a560: 2074 6162 6c65 5f72 6f77 732e 6170 7065   table_rows.appe
-0002a570: 6e64 280a 2020 2020 2020 2020 2020 2020  nd(.            
-0002a580: 2020 2020 5b0a 2020 2020 2020 2020 2020      [.          
-0002a590: 2020 2020 2020 2020 2020 7374 7228 7329            str(s)
-0002a5a0: 0a20 2020 2020 2020 2020 2020 2020 2020  .               
-0002a5b0: 2020 2020 2066 6f72 2073 2069 6e20 5b0a       for s in [.
-0002a5c0: 2020 2020 2020 2020 2020 2020 2020 2020                  
-0002a5d0: 2020 2020 2020 2020 6e61 6d65 2e63 6170          name.cap
-0002a5e0: 6974 616c 697a 6528 292c 0a20 2020 2020  italize(),.     
-0002a5f0: 2020 2020 2020 2020 2020 2020 2020 2020                  
-0002a600: 2020 2074 6162 6c65 2e6e 756d 5f72 6f77     table.num_row
-0002a610: 732c 0a20 2020 2020 2020 2020 2020 2020  s,.             
-0002a620: 2020 2020 2020 2020 2020 2075 7469 6c2e             util.
-0002a630: 6e61 7475 7261 6c73 697a 6528 7461 626c  naturalsize(tabl
-0002a640: 652e 6e62 7974 6573 292c 0a20 2020 2020  e.nbytes),.     
+0000a5a0: 652e 0a20 2020 2020 2020 2054 6865 206f  e..        The o
+0000a5b0: 7264 6572 696e 6720 6f66 2073 6962 6c69  rdering of sibli
+0000a5c0: 6e67 7320 2069 7320 6172 6269 7472 6172  ngs  is arbitrar
+0000a5d0: 7920 616e 6420 7368 6f75 6c64 206e 6f74  y and should not
+0000a5e0: 2062 6520 6465 7065 6e64 6564 206f 6e3b   be depended on;
+0000a5f0: 0a20 2020 2020 2020 2073 6565 2074 6865  .        see the
+0000a600: 203a 7265 663a 6064 6174 6120 6d6f 6465   :ref:`data mode
+0000a610: 6c20 3c73 6563 5f64 6174 615f 6d6f 6465  l <sec_data_mode
+0000a620: 6c5f 7472 6565 5f73 7472 7563 7475 7265  l_tree_structure
+0000a630: 3e60 2073 6563 7469 6f6e 2066 6f72 2064  >` section for d
+0000a640: 6574 6169 6c73 2e0a 0a20 2020 2020 2020  etails...       
+0000a650: 203a 7061 7261 6d20 696e 7420 753a 2054   :param int u: T
+0000a660: 6865 206e 6f64 6520 6f66 2069 6e74 6572  he node of inter
+0000a670: 6573 742e 0a20 2020 2020 2020 203a 7265  est..        :re
+0000a680: 7475 726e 3a20 5468 6520 7369 626c 696e  turn: The siblin
+0000a690: 6773 206f 6620 6060 7560 602e 0a20 2020  gs of ``u``..   
+0000a6a0: 2020 2020 203a 7274 7970 653a 2074 7570       :rtype: tup
+0000a6b0: 6c65 2869 6e74 290a 2020 2020 2020 2020  le(int).        
+0000a6c0: 2222 220a 2020 2020 2020 2020 6966 2075  """.        if u
+0000a6d0: 203d 3d20 7365 6c66 2e76 6972 7475 616c   == self.virtual
+0000a6e0: 5f72 6f6f 743a 0a20 2020 2020 2020 2020  _root:.         
+0000a6f0: 2020 2072 6574 7572 6e20 7475 706c 6528     return tuple(
+0000a700: 290a 2020 2020 2020 2020 7061 7265 6e74  ).        parent
+0000a710: 203d 2073 656c 662e 7061 7265 6e74 2875   = self.parent(u
+0000a720: 290a 2020 2020 2020 2020 6966 2073 656c  ).        if sel
+0000a730: 662e 6973 5f72 6f6f 7428 7529 3a0a 2020  f.is_root(u):.  
+0000a740: 2020 2020 2020 2020 2020 7061 7265 6e74            parent
+0000a750: 203d 2073 656c 662e 7669 7274 7561 6c5f   = self.virtual_
+0000a760: 726f 6f74 0a20 2020 2020 2020 2069 6620  root.        if 
+0000a770: 7061 7265 6e74 2021 3d20 7473 6b69 742e  parent != tskit.
+0000a780: 4e55 4c4c 3a0a 2020 2020 2020 2020 2020  NULL:.          
+0000a790: 2020 7265 7475 726e 2074 7570 6c65 2876    return tuple(v
+0000a7a0: 2066 6f72 2076 2069 6e20 7365 6c66 2e63   for v in self.c
+0000a7b0: 6869 6c64 7265 6e28 7061 7265 6e74 2920  hildren(parent) 
+0000a7c0: 6966 2075 2021 3d20 7629 0a20 2020 2020  if u != v).     
+0000a7d0: 2020 2072 6574 7572 6e20 7475 706c 6528     return tuple(
+0000a7e0: 290a 0a20 2020 2040 7072 6f70 6572 7479  )..    @property
+0000a7f0: 0a20 2020 2064 6566 206e 756d 5f63 6869  .    def num_chi
+0000a800: 6c64 7265 6e5f 6172 7261 7928 7365 6c66  ldren_array(self
+0000a810: 293a 0a20 2020 2020 2020 2022 2222 0a20  ):.        """. 
+0000a820: 2020 2020 2020 2041 206e 756d 7079 2061         A numpy a
+0000a830: 7272 6179 2028 6474 7970 653d 6e70 2e69  rray (dtype=np.i
+0000a840: 6e74 3332 2920 656e 636f 6469 6e67 2074  nt32) encoding t
+0000a850: 6865 206e 756d 6265 7220 6f66 2063 6869  he number of chi
+0000a860: 6c64 7265 6e20 6f66 0a20 2020 2020 2020  ldren of.       
+0000a870: 2065 6163 6820 6e6f 6465 2069 6e20 7468   each node in th
+0000a880: 6973 2074 7265 652c 2073 7563 6820 7468  is tree, such th
+0000a890: 6174 0a20 2020 2020 2020 2060 6074 7265  at.        ``tre
+0000a8a0: 652e 6e75 6d5f 6368 696c 6472 656e 5f61  e.num_children_a
+0000a8b0: 7272 6179 5b75 5d20 3d3d 2074 7265 652e  rray[u] == tree.
+0000a8c0: 6e75 6d5f 6368 696c 6472 656e 2875 2960  num_children(u)`
+0000a8d0: 6020 666f 7220 616c 6c0a 2020 2020 2020  ` for all.      
+0000a8e0: 2020 6060 3020 3c3d 2075 203c 3d20 7473    ``0 <= u <= ts
+0000a8f0: 2e6e 756d 5f6e 6f64 6573 6060 2e20 5365  .num_nodes``. Se
+0000a900: 6520 7468 6520 3a6d 6574 683a 607e 2e6e  e the :meth:`~.n
+0000a910: 756d 5f63 6869 6c64 7265 6e60 0a20 2020  um_children`.   
+0000a920: 2020 2020 206d 6574 686f 6420 666f 7220       method for 
+0000a930: 6465 7461 696c 7320 6f6e 2074 6865 2073  details on the s
+0000a940: 656d 616e 7469 6373 206f 6620 7472 6565  emantics of tree
+0000a950: 206e 756d 5f63 6869 6c64 7265 6e20 616e   num_children an
+0000a960: 6420 7468 650a 2020 2020 2020 2020 3a72  d the.        :r
+0000a970: 6566 3a60 7365 635f 6461 7461 5f6d 6f64  ef:`sec_data_mod
+0000a980: 656c 5f74 7265 655f 7374 7275 6374 7572  el_tree_structur
+0000a990: 6560 2073 6563 7469 6f6e 2066 6f72 2069  e` section for i
+0000a9a0: 6e66 6f72 6d61 7469 6f6e 206f 6e20 7468  nformation on th
+0000a9b0: 650a 2020 2020 2020 2020 7175 696e 7475  e.        quintu
+0000a9c0: 706c 7920 6c69 6e6b 6564 2074 7265 6520  ply linked tree 
+0000a9d0: 656e 636f 6469 6e67 2e0a 0a20 2020 2020  encoding...     
+0000a9e0: 2020 202e 2e20 696e 636c 7564 653a 3a20     .. include:: 
+0000a9f0: 7375 6273 7469 7475 7469 6f6e 732f 7669  substitutions/vi
+0000aa00: 7274 7561 6c5f 726f 6f74 5f61 7272 6179  rtual_root_array
+0000aa10: 5f6e 6f74 652e 7273 740a 0a20 2020 2020  _note.rst..     
+0000aa20: 2020 202e 2e20 696e 636c 7564 653a 3a20     .. include:: 
+0000aa30: 7375 6273 7469 7475 7469 6f6e 732f 7472  substitutions/tr
+0000aa40: 6565 5f61 7272 6179 5f77 6172 6e69 6e67  ee_array_warning
+0000aa50: 2e72 7374 0a20 2020 2020 2020 2022 2222  .rst.        """
+0000aa60: 0a20 2020 2020 2020 2072 6574 7572 6e20  .        return 
+0000aa70: 7365 6c66 2e5f 6e75 6d5f 6368 696c 6472  self._num_childr
+0000aa80: 656e 5f61 7272 6179 0a0a 2020 2020 6465  en_array..    de
+0000aa90: 6620 6564 6765 2873 656c 662c 2075 293a  f edge(self, u):
+0000aaa0: 0a20 2020 2020 2020 2022 2222 0a20 2020  .        """.   
+0000aab0: 2020 2020 2052 6574 7572 6e73 2074 6865       Returns the
+0000aac0: 2069 6420 6f66 2074 6865 2065 6467 6520   id of the edge 
+0000aad0: 656e 636f 6469 6e67 2074 6865 2072 656c  encoding the rel
+0000aae0: 6174 696f 6e73 6869 7020 6265 7477 6565  ationship betwee
+0000aaf0: 6e20 6060 7560 600a 2020 2020 2020 2020  n ``u``.        
+0000ab00: 616e 6420 6974 7320 7061 7265 6e74 2c20  and its parent, 
+0000ab10: 6f72 203a 6461 7461 3a60 7473 6b69 742e  or :data:`tskit.
+0000ab20: 4e55 4c4c 6020 6966 2060 6075 6060 2069  NULL` if ``u`` i
+0000ab30: 7320 6120 726f 6f74 2c20 7669 7274 7561  s a root, virtua
+0000ab40: 6c20 726f 6f74 0a20 2020 2020 2020 206f  l root.        o
+0000ab50: 7220 6973 206e 6f74 2061 206e 6f64 6520  r is not a node 
+0000ab60: 696e 2074 6865 2063 7572 7265 6e74 2074  in the current t
+0000ab70: 7265 652e 0a0a 2020 2020 2020 2020 3a70  ree...        :p
+0000ab80: 6172 616d 2069 6e74 2075 3a20 5468 6520  aram int u: The 
+0000ab90: 6e6f 6465 206f 6620 696e 7465 7265 7374  node of interest
+0000aba0: 2e0a 2020 2020 2020 2020 3a72 6574 7572  ..        :retur
+0000abb0: 6e3a 2049 6420 6f66 2065 6467 6520 636f  n: Id of edge co
+0000abc0: 6e6e 6563 7469 6e67 2075 2074 6f20 6974  nnecting u to it
+0000abd0: 7320 7061 7265 6e74 2e0a 2020 2020 2020  s parent..      
+0000abe0: 2020 3a72 7479 7065 3a20 696e 740a 2020    :rtype: int.  
+0000abf0: 2020 2020 2020 2222 220a 2020 2020 2020        """.      
+0000ac00: 2020 7265 7475 726e 2073 656c 662e 5f6c    return self._l
+0000ac10: 6c5f 7472 6565 2e67 6574 5f65 6467 6528  l_tree.get_edge(
+0000ac20: 7529 0a0a 2020 2020 4070 726f 7065 7274  u)..    @propert
+0000ac30: 790a 2020 2020 6465 6620 6564 6765 5f61  y.    def edge_a
+0000ac40: 7272 6179 2873 656c 6629 3a0a 2020 2020  rray(self):.    
+0000ac50: 2020 2020 2222 220a 2020 2020 2020 2020      """.        
+0000ac60: 4120 6e75 6d70 7920 6172 7261 7920 2864  A numpy array (d
+0000ac70: 7479 7065 3d6e 702e 696e 7433 3229 206f  type=np.int32) o
+0000ac80: 6620 6564 6765 2069 6473 2065 6e63 6f64  f edge ids encod
+0000ac90: 696e 6720 7468 6520 7265 6c61 7469 6f6e  ing the relation
+0000aca0: 7368 6970 0a20 2020 2020 2020 2062 6574  ship.        bet
+0000acb0: 7765 656e 2074 6865 2063 6869 6c64 206e  ween the child n
+0000acc0: 6f64 6520 6060 7560 6020 616e 6420 6974  ode ``u`` and it
+0000acd0: 7320 7061 7265 6e74 2c20 7375 6368 2074  s parent, such t
+0000ace0: 6861 740a 2020 2020 2020 2020 6060 7472  hat.        ``tr
+0000acf0: 6565 2e65 6467 655f 6172 7261 795b 755d  ee.edge_array[u]
+0000ad00: 203d 3d20 7472 6565 2e65 6467 6528 7529   == tree.edge(u)
+0000ad10: 6060 2066 6f72 2061 6c6c 0a20 2020 2020  `` for all.     
+0000ad20: 2020 2060 6030 203c 3d20 7520 3c3d 2074     ``0 <= u <= t
+0000ad30: 732e 6e75 6d5f 6e6f 6465 7360 602e 2053  s.num_nodes``. S
+0000ad40: 6565 2074 6865 203a 6d65 7468 3a60 7e2e  ee the :meth:`~.
+0000ad50: 6564 6765 600a 2020 2020 2020 2020 6d65  edge`.        me
+0000ad60: 7468 6f64 2066 6f72 2064 6574 6169 6c73  thod for details
+0000ad70: 206f 6e20 7468 6520 7365 6d61 6e74 6963   on the semantic
+0000ad80: 7320 6f66 2074 7265 6520 6564 6765 2061  s of tree edge a
+0000ad90: 6e64 2074 6865 0a20 2020 2020 2020 203a  nd the.        :
+0000ada0: 7265 663a 6073 6563 5f64 6174 615f 6d6f  ref:`sec_data_mo
+0000adb0: 6465 6c5f 7472 6565 5f73 7472 7563 7475  del_tree_structu
+0000adc0: 7265 6020 7365 6374 696f 6e20 666f 7220  re` section for 
+0000add0: 696e 666f 726d 6174 696f 6e20 6f6e 2074  information on t
+0000ade0: 6865 0a20 2020 2020 2020 2071 7569 6e74  he.        quint
+0000adf0: 7570 6c79 206c 696e 6b65 6420 7472 6565  uply linked tree
+0000ae00: 2065 6e63 6f64 696e 672e 0a0a 2020 2020   encoding...    
+0000ae10: 2020 2020 2e2e 2069 6e63 6c75 6465 3a3a      .. include::
+0000ae20: 2073 7562 7374 6974 7574 696f 6e73 2f76   substitutions/v
+0000ae30: 6972 7475 616c 5f72 6f6f 745f 6172 7261  irtual_root_arra
+0000ae40: 795f 6e6f 7465 2e72 7374 0a0a 2020 2020  y_note.rst..    
+0000ae50: 2020 2020 2e2e 2069 6e63 6c75 6465 3a3a      .. include::
+0000ae60: 2073 7562 7374 6974 7574 696f 6e73 2f74   substitutions/t
+0000ae70: 7265 655f 6172 7261 795f 7761 726e 696e  ree_array_warnin
+0000ae80: 672e 7273 740a 2020 2020 2020 2020 2222  g.rst.        ""
+0000ae90: 220a 2020 2020 2020 2020 7265 7475 726e  ".        return
+0000aea0: 2073 656c 662e 5f65 6467 655f 6172 7261   self._edge_arra
+0000aeb0: 790a 0a20 2020 2023 2053 616d 706c 6520  y..    # Sample 
+0000aec0: 6c69 7374 2e0a 0a20 2020 2064 6566 206c  list...    def l
+0000aed0: 6566 745f 7361 6d70 6c65 2873 656c 662c  eft_sample(self,
+0000aee0: 2075 293a 0a20 2020 2020 2020 2072 6574   u):.        ret
+0000aef0: 7572 6e20 7365 6c66 2e5f 6c6c 5f74 7265  urn self._ll_tre
+0000af00: 652e 6765 745f 6c65 6674 5f73 616d 706c  e.get_left_sampl
+0000af10: 6528 7529 0a0a 2020 2020 6465 6620 7269  e(u)..    def ri
+0000af20: 6768 745f 7361 6d70 6c65 2873 656c 662c  ght_sample(self,
+0000af30: 2075 293a 0a20 2020 2020 2020 2072 6574   u):.        ret
+0000af40: 7572 6e20 7365 6c66 2e5f 6c6c 5f74 7265  urn self._ll_tre
+0000af50: 652e 6765 745f 7269 6768 745f 7361 6d70  e.get_right_samp
+0000af60: 6c65 2875 290a 0a20 2020 2064 6566 206e  le(u)..    def n
+0000af70: 6578 745f 7361 6d70 6c65 2873 656c 662c  ext_sample(self,
+0000af80: 2075 293a 0a20 2020 2020 2020 2072 6574   u):.        ret
+0000af90: 7572 6e20 7365 6c66 2e5f 6c6c 5f74 7265  urn self._ll_tre
+0000afa0: 652e 6765 745f 6e65 7874 5f73 616d 706c  e.get_next_sampl
+0000afb0: 6528 7529 0a0a 2020 2020 4070 726f 7065  e(u)..    @prope
+0000afc0: 7274 790a 2020 2020 6465 6620 7669 7274  rty.    def virt
+0000afd0: 7561 6c5f 726f 6f74 2873 656c 6629 3a0a  ual_root(self):.
+0000afe0: 2020 2020 2020 2020 2222 220a 2020 2020          """.    
+0000aff0: 2020 2020 5468 6520 4944 206f 6620 7468      The ID of th
+0000b000: 6520 7669 7274 7561 6c20 726f 6f74 2069  e virtual root i
+0000b010: 6e20 7468 6973 2074 7265 652e 2054 6869  n this tree. Thi
+0000b020: 7320 6973 2065 7175 616c 2074 6f0a 2020  s is equal to.  
+0000b030: 2020 2020 2020 3a61 7474 723a 6054 7265        :attr:`Tre
+0000b040: 6553 6571 7565 6e63 652e 6e75 6d5f 6e6f  eSequence.num_no
+0000b050: 6465 7360 2e0a 0a20 2020 2020 2020 2050  des`...        P
+0000b060: 6c65 6173 6520 7365 6520 7468 6520 3a72  lease see the :r
+0000b070: 6566 3a60 7472 6565 2072 6f6f 7473 203c  ef:`tree roots <
+0000b080: 7365 635f 6461 7461 5f6d 6f64 656c 5f74  sec_data_model_t
+0000b090: 7265 655f 726f 6f74 733e 600a 2020 2020  ree_roots>`.    
+0000b0a0: 2020 2020 7365 6374 696f 6e20 666f 7220      section for 
+0000b0b0: 6d6f 7265 2064 6574 6169 6c73 2e0a 2020  more details..  
+0000b0c0: 2020 2020 2020 2222 220a 2020 2020 2020        """.      
+0000b0d0: 2020 7265 7475 726e 2073 656c 662e 5f6c    return self._l
+0000b0e0: 6c5f 7472 6565 2e67 6574 5f76 6972 7475  l_tree.get_virtu
+0000b0f0: 616c 5f72 6f6f 7428 290a 0a20 2020 2040  al_root()..    @
+0000b100: 7072 6f70 6572 7479 0a20 2020 2064 6566  property.    def
+0000b110: 206e 756d 5f65 6467 6573 2873 656c 6629   num_edges(self)
+0000b120: 3a0a 2020 2020 2020 2020 2222 220a 2020  :.        """.  
+0000b130: 2020 2020 2020 5468 6520 746f 7461 6c20        The total 
+0000b140: 6e75 6d62 6572 206f 6620 6564 6765 7320  number of edges 
+0000b150: 696e 2074 6869 7320 7472 6565 2e20 5468  in this tree. Th
+0000b160: 6973 2069 7320 6571 7561 6c20 746f 2074  is is equal to t
+0000b170: 6865 0a20 2020 2020 2020 206e 756d 6265  he.        numbe
+0000b180: 7220 6f66 2074 7265 6520 7365 7175 656e  r of tree sequen
+0000b190: 6365 2065 6467 6573 2074 6861 7420 696e  ce edges that in
+0000b1a0: 7465 7273 6563 7420 7769 7468 2074 6869  tersect with thi
+0000b1b0: 7320 7472 6565 2773 0a20 2020 2020 2020  s tree's.       
+0000b1c0: 2067 656e 6f6d 6963 2069 6e74 6572 7661   genomic interva
+0000b1d0: 6c2e 0a0a 2020 2020 2020 2020 4e6f 7465  l...        Note
+0000b1e0: 2074 6861 7420 7468 6973 206d 6179 2062   that this may b
+0000b1f0: 6520 6772 6561 7465 7220 7468 616e 2074  e greater than t
+0000b200: 6865 206e 756d 6265 7220 6f66 2062 7261  he number of bra
+0000b210: 6e63 6865 7320 7468 6174 0a20 2020 2020  nches that.     
+0000b220: 2020 2061 7265 2072 6561 6368 6162 6c65     are reachable
+0000b230: 2066 726f 6d20 7468 6520 7472 6565 2773   from the tree's
+0000b240: 2072 6f6f 7473 2c20 7369 6e63 6520 7765   roots, since we
+0000b250: 2063 616e 2068 6176 6520 746f 706f 6c6f   can have topolo
+0000b260: 6779 0a20 2020 2020 2020 2074 6861 7420  gy.        that 
+0000b270: 6973 206e 6f74 2061 7373 6f63 6961 7465  is not associate
+0000b280: 6420 7769 7468 2061 6e79 2073 616d 706c  d with any sampl
+0000b290: 6573 2e0a 2020 2020 2020 2020 2222 220a  es..        """.
+0000b2a0: 2020 2020 2020 2020 7265 7475 726e 2073          return s
+0000b2b0: 656c 662e 5f6c 6c5f 7472 6565 2e67 6574  elf._ll_tree.get
+0000b2c0: 5f6e 756d 5f65 6467 6573 2829 0a0a 2020  _num_edges()..  
+0000b2d0: 2020 4070 726f 7065 7274 790a 2020 2020    @property.    
+0000b2e0: 6465 6620 6c65 6674 5f72 6f6f 7428 7365  def left_root(se
+0000b2f0: 6c66 293a 0a20 2020 2020 2020 2022 2222  lf):.        """
+0000b300: 0a20 2020 2020 2020 2054 6865 206c 6566  .        The lef
+0000b310: 746d 6f73 7420 726f 6f74 2069 6e20 7468  tmost root in th
+0000b320: 6973 2074 7265 652e 2049 6620 7468 6572  is tree. If ther
+0000b330: 6520 6172 6520 6d75 6c74 6970 6c65 2072  e are multiple r
+0000b340: 6f6f 7473 0a20 2020 2020 2020 2069 6e20  oots.        in 
+0000b350: 7468 6973 2074 7265 652c 2074 6865 7920  this tree, they 
+0000b360: 6172 6520 7369 626c 696e 6773 206f 6620  are siblings of 
+0000b370: 7468 6973 206e 6f64 652c 2061 6e64 2073  this node, and s
+0000b380: 6f20 7765 2063 616e 0a20 2020 2020 2020  o we can.       
+0000b390: 2075 7365 203a 6d65 7468 3a60 2e72 6967   use :meth:`.rig
+0000b3a0: 6874 5f73 6962 6020 746f 2069 7465 7261  ht_sib` to itera
+0000b3b0: 7465 206f 7665 7220 616c 6c20 726f 6f74  te over all root
+0000b3c0: 733a 0a0a 2020 2020 2020 2020 2e2e 2063  s:..        .. c
+0000b3d0: 6f64 652d 626c 6f63 6b3a 3a20 7079 7468  ode-block:: pyth
+0000b3e0: 6f6e 0a0a 2020 2020 2020 2020 2020 2020  on..            
+0000b3f0: 7520 3d20 7472 6565 2e6c 6566 745f 726f  u = tree.left_ro
+0000b400: 6f74 0a20 2020 2020 2020 2020 2020 2077  ot.            w
+0000b410: 6869 6c65 2075 2021 3d20 7473 6b69 742e  hile u != tskit.
+0000b420: 4e55 4c4c 3a0a 2020 2020 2020 2020 2020  NULL:.          
+0000b430: 2020 2020 2020 7072 696e 7428 2252 6f6f        print("Roo
+0000b440: 743a 222c 2075 290a 2020 2020 2020 2020  t:", u).        
+0000b450: 2020 2020 2020 2020 7520 3d20 7472 6565          u = tree
+0000b460: 2e72 6967 6874 5f73 6962 2875 290a 0a20  .right_sib(u).. 
+0000b470: 2020 2020 2020 2054 6865 206c 6566 742d         The left-
+0000b480: 746f 2d72 6967 6874 206f 7264 6572 696e  to-right orderin
+0000b490: 6720 6f66 2072 6f6f 7473 2069 7320 6172  g of roots is ar
+0000b4a0: 6269 7472 6172 7920 616e 6420 7368 6f75  bitrary and shou
+0000b4b0: 6c64 0a20 2020 2020 2020 206e 6f74 2062  ld.        not b
+0000b4c0: 6520 6465 7065 6e64 6564 206f 6e3b 2073  e depended on; s
+0000b4d0: 6565 2074 6865 0a20 2020 2020 2020 203a  ee the.        :
+0000b4e0: 7265 663a 6064 6174 6120 6d6f 6465 6c20  ref:`data model 
+0000b4f0: 3c73 6563 5f64 6174 615f 6d6f 6465 6c5f  <sec_data_model_
+0000b500: 7472 6565 5f73 7472 7563 7475 7265 3e60  tree_structure>`
+0000b510: 0a20 2020 2020 2020 2073 6563 7469 6f6e  .        section
+0000b520: 2066 6f72 2064 6574 6169 6c73 2e0a 0a20   for details... 
+0000b530: 2020 2020 2020 2054 6869 7320 6973 2061         This is a
+0000b540: 206c 6f77 2d6c 6576 656c 206d 6574 686f   low-level metho
+0000b550: 6420 6769 7669 6e67 2061 6363 6573 7320  d giving access 
+0000b560: 746f 2074 6865 2071 7569 6e74 7570 6c79  to the quintuply
+0000b570: 206c 696e 6b65 640a 2020 2020 2020 2020   linked.        
+0000b580: 7472 6565 2073 7472 7563 7475 7265 2069  tree structure i
+0000b590: 6e20 6d65 6d6f 7279 3b20 7468 6520 3a61  n memory; the :a
+0000b5a0: 7474 723a 607e 5472 6565 2e72 6f6f 7473  ttr:`~Tree.roots
+0000b5b0: 6020 6174 7472 6962 7574 6520 6973 2061  ` attribute is a
+0000b5c0: 206d 6f72 650a 2020 2020 2020 2020 636f   more.        co
+0000b5d0: 6e76 656e 6965 6e74 2077 6179 2074 6f20  nvenient way to 
+0000b5e0: 6f62 7461 696e 2074 6865 2072 6f6f 7473  obtain the roots
+0000b5f0: 206f 6620 6120 7472 6565 2e20 4966 2079   of a tree. If y
+0000b600: 6f75 2061 7265 2061 7373 756d 696e 670a  ou are assuming.
+0000b610: 2020 2020 2020 2020 7468 6174 2074 6865          that the
+0000b620: 7265 2069 7320 6120 7369 6e67 6c65 2072  re is a single r
+0000b630: 6f6f 7420 696e 2074 6865 2074 7265 6520  oot in the tree 
+0000b640: 796f 7520 7368 6f75 6c64 2075 7365 2074  you should use t
+0000b650: 6865 0a20 2020 2020 2020 203a 6174 7472  he.        :attr
+0000b660: 3a60 7e54 7265 652e 726f 6f74 6020 7072  :`~Tree.root` pr
+0000b670: 6f70 6572 7479 2e0a 0a20 2020 2020 2020  operty...       
+0000b680: 202e 2e20 7761 726e 696e 673a 3a20 446f   .. warning:: Do
+0000b690: 206e 6f74 2075 7365 2074 6869 7320 7072   not use this pr
+0000b6a0: 6f70 6572 7479 2069 6620 796f 7520 6172  operty if you ar
+0000b6b0: 6520 6173 7375 6d69 6e67 2074 6861 7420  e assuming that 
+0000b6c0: 7468 6572 650a 2020 2020 2020 2020 2020  there.          
+0000b6d0: 2020 6973 2061 2073 696e 676c 6520 726f    is a single ro
+0000b6e0: 6f74 2069 6e20 7472 6565 7320 7468 6174  ot in trees that
+0000b6f0: 2061 7265 2062 6569 6e67 2070 726f 6365   are being proce
+0000b700: 7373 6564 2e20 5468 650a 2020 2020 2020  ssed. The.      
+0000b710: 2020 2020 2020 3a61 7474 723a 607e 5472        :attr:`~Tr
+0000b720: 6565 2e72 6f6f 7460 2070 726f 7065 7274  ee.root` propert
+0000b730: 7920 7368 6f75 6c64 2062 6520 7573 6564  y should be used
+0000b740: 2069 6e20 7468 6973 2063 6173 652c 2061   in this case, a
+0000b750: 7320 6974 2077 696c 6c0a 2020 2020 2020  s it will.      
+0000b760: 2020 2020 2020 7261 6973 6520 616e 2065        raise an e
+0000b770: 7272 6f72 2077 6865 6e20 6d75 6c74 6970  rror when multip
+0000b780: 6c65 2072 6f6f 7473 2065 7869 7374 732e  le roots exists.
+0000b790: 0a0a 2020 2020 2020 2020 3a72 7479 7065  ..        :rtype
+0000b7a0: 3a20 696e 740a 2020 2020 2020 2020 2222  : int.        ""
+0000b7b0: 220a 2020 2020 2020 2020 7265 7475 726e  ".        return
+0000b7c0: 2073 656c 662e 6c65 6674 5f63 6869 6c64   self.left_child
+0000b7d0: 2873 656c 662e 7669 7274 7561 6c5f 726f  (self.virtual_ro
+0000b7e0: 6f74 290a 0a20 2020 2040 7072 6f70 6572  ot)..    @proper
+0000b7f0: 7479 0a20 2020 2064 6566 2072 6967 6874  ty.    def right
+0000b800: 5f72 6f6f 7428 7365 6c66 293a 0a20 2020  _root(self):.   
+0000b810: 2020 2020 2072 6574 7572 6e20 7365 6c66       return self
+0000b820: 2e72 6967 6874 5f63 6869 6c64 2873 656c  .right_child(sel
+0000b830: 662e 7669 7274 7561 6c5f 726f 6f74 290a  f.virtual_root).
+0000b840: 0a20 2020 2064 6566 2067 6574 5f63 6869  .    def get_chi
+0000b850: 6c64 7265 6e28 7365 6c66 2c20 7529 3a0a  ldren(self, u):.
+0000b860: 2020 2020 2020 2020 2320 4465 7072 6563          # Deprec
+0000b870: 6174 6564 2061 6c69 6173 2066 6f72 2073  ated alias for s
+0000b880: 656c 662e 6368 696c 6472 656e 0a20 2020  elf.children.   
+0000b890: 2020 2020 2072 6574 7572 6e20 7365 6c66       return self
+0000b8a0: 2e63 6869 6c64 7265 6e28 7529 0a0a 2020  .children(u)..  
+0000b8b0: 2020 6465 6620 6368 696c 6472 656e 2873    def children(s
+0000b8c0: 656c 662c 2075 293a 0a20 2020 2020 2020  elf, u):.       
+0000b8d0: 2022 2222 0a20 2020 2020 2020 2052 6574   """.        Ret
+0000b8e0: 7572 6e73 2074 6865 2063 6869 6c64 7265  urns the childre
+0000b8f0: 6e20 6f66 2074 6865 2073 7065 6369 6669  n of the specifi
+0000b900: 6564 206e 6f64 6520 6060 7560 6020 6173  ed node ``u`` as
+0000b910: 2061 2074 7570 6c65 206f 6620 696e 7465   a tuple of inte
+0000b920: 6765 7220 6e6f 6465 2049 4473 2e0a 2020  ger node IDs..  
+0000b930: 2020 2020 2020 4966 2060 6075 6060 2069        If ``u`` i
+0000b940: 7320 6120 6c65 6166 2c20 7265 7475 726e  s a leaf, return
+0000b950: 2074 6865 2065 6d70 7479 2074 7570 6c65   the empty tuple
+0000b960: 2e20 5468 6520 6f72 6465 7269 6e67 206f  . The ordering o
+0000b970: 6620 6368 696c 6472 656e 0a20 2020 2020  f children.     
+0000b980: 2020 2069 7320 6172 6269 7472 6172 7920     is arbitrary 
+0000b990: 616e 6420 7368 6f75 6c64 206e 6f74 2062  and should not b
+0000b9a0: 6520 6465 7065 6e64 6564 206f 6e3b 2073  e depended on; s
+0000b9b0: 6565 2074 6865 0a20 2020 2020 2020 203a  ee the.        :
+0000b9c0: 7265 663a 6064 6174 6120 6d6f 6465 6c20  ref:`data model 
+0000b9d0: 3c73 6563 5f64 6174 615f 6d6f 6465 6c5f  <sec_data_model_
+0000b9e0: 7472 6565 5f73 7472 7563 7475 7265 3e60  tree_structure>`
+0000b9f0: 2073 6563 7469 6f6e 0a20 2020 2020 2020   section.       
+0000ba00: 2066 6f72 2064 6574 6169 6c73 2e0a 0a20   for details... 
+0000ba10: 2020 2020 2020 203a 7061 7261 6d20 696e         :param in
+0000ba20: 7420 753a 2054 6865 206e 6f64 6520 6f66  t u: The node of
+0000ba30: 2069 6e74 6572 6573 742e 0a20 2020 2020   interest..     
+0000ba40: 2020 203a 7265 7475 726e 3a20 5468 6520     :return: The 
+0000ba50: 6368 696c 6472 656e 206f 6620 6060 7560  children of ``u`
+0000ba60: 6020 6173 2061 2074 7570 6c65 206f 6620  ` as a tuple of 
+0000ba70: 696e 7465 6765 7273 0a20 2020 2020 2020  integers.       
+0000ba80: 203a 7274 7970 653a 2074 7570 6c65 2869   :rtype: tuple(i
+0000ba90: 6e74 290a 2020 2020 2020 2020 2222 220a  nt).        """.
+0000baa0: 2020 2020 2020 2020 7265 7475 726e 2073          return s
+0000bab0: 656c 662e 5f6c 6c5f 7472 6565 2e67 6574  elf._ll_tree.get
+0000bac0: 5f63 6869 6c64 7265 6e28 7529 0a0a 2020  _children(u)..  
+0000bad0: 2020 6465 6620 6765 745f 7469 6d65 2873    def get_time(s
+0000bae0: 656c 662c 2075 293a 0a20 2020 2020 2020  elf, u):.       
+0000baf0: 2023 2044 6570 7265 6361 7465 6420 616c   # Deprecated al
+0000bb00: 6961 7320 666f 7220 7365 6c66 2e74 696d  ias for self.tim
+0000bb10: 650a 2020 2020 2020 2020 7265 7475 726e  e.        return
+0000bb20: 2073 656c 662e 7469 6d65 2875 290a 0a20   self.time(u).. 
+0000bb30: 2020 2064 6566 2074 696d 6528 7365 6c66     def time(self
+0000bb40: 2c20 7529 3a0a 2020 2020 2020 2020 2222  , u):.        ""
+0000bb50: 220a 2020 2020 2020 2020 5265 7475 726e  ".        Return
+0000bb60: 7320 7468 6520 7469 6d65 206f 6620 7468  s the time of th
+0000bb70: 6520 7370 6563 6966 6965 6420 6e6f 6465  e specified node
+0000bb80: 2e20 5468 6973 2069 7320 6571 7569 7661  . This is equiva
+0000bb90: 6c65 6e74 6c79 0a20 2020 2020 2020 2074  lently.        t
+0000bba0: 6f20 6060 7472 6565 2e74 7265 655f 7365  o ``tree.tree_se
+0000bbb0: 7175 656e 6365 2e6e 6f64 6528 7529 2e74  quence.node(u).t
+0000bbc0: 696d 6560 6020 6578 6365 7074 2066 6f72  ime`` except for
+0000bbd0: 2074 6865 2073 7065 6369 616c 0a20 2020   the special.   
+0000bbe0: 2020 2020 2063 6173 6520 6f66 2074 6865       case of the
+0000bbf0: 2074 7265 6527 7320 3a72 6566 3a60 7669   tree's :ref:`vi
+0000bc00: 7274 7561 6c20 726f 6f74 203c 7365 635f  rtual root <sec_
+0000bc10: 6461 7461 5f6d 6f64 656c 5f74 7265 655f  data_model_tree_
+0000bc20: 726f 6f74 733e 602c 0a20 2020 2020 2020  roots>`,.       
+0000bc30: 2077 6869 6368 2069 7320 6465 6669 6e65   which is define
+0000bc40: 6420 6173 2070 6f73 6974 6976 6520 696e  d as positive in
+0000bc50: 6669 6e69 7479 2e0a 0a20 2020 2020 2020  finity...       
+0000bc60: 203a 7061 7261 6d20 696e 7420 753a 2054   :param int u: T
+0000bc70: 6865 206e 6f64 6520 6f66 2069 6e74 6572  he node of inter
+0000bc80: 6573 742e 0a20 2020 2020 2020 203a 7265  est..        :re
+0000bc90: 7475 726e 3a20 5468 6520 7469 6d65 206f  turn: The time o
+0000bca0: 6620 752e 0a20 2020 2020 2020 203a 7274  f u..        :rt
+0000bcb0: 7970 653a 2066 6c6f 6174 0a20 2020 2020  ype: float.     
+0000bcc0: 2020 2022 2222 0a20 2020 2020 2020 2072     """.        r
+0000bcd0: 6574 7572 6e20 7365 6c66 2e5f 6c6c 5f74  eturn self._ll_t
+0000bce0: 7265 652e 6765 745f 7469 6d65 2875 290a  ree.get_time(u).
+0000bcf0: 0a20 2020 2064 6566 2064 6570 7468 2873  .    def depth(s
+0000bd00: 656c 662c 2075 293a 0a20 2020 2020 2020  elf, u):.       
+0000bd10: 2022 2222 0a20 2020 2020 2020 2052 6574   """.        Ret
+0000bd20: 7572 6e73 2074 6865 206e 756d 6265 7220  urns the number 
+0000bd30: 6f66 206e 6f64 6573 206f 6e20 7468 6520  of nodes on the 
+0000bd40: 7061 7468 2066 726f 6d20 6060 7560 6020  path from ``u`` 
+0000bd50: 746f 2061 0a20 2020 2020 2020 2072 6f6f  to a.        roo
+0000bd60: 742c 206e 6f74 2069 6e63 6c75 6469 6e67  t, not including
+0000bd70: 2060 6075 6060 2e20 5468 7573 2c20 7468   ``u``. Thus, th
+0000bd80: 6520 6465 7074 6820 6f66 2061 2072 6f6f  e depth of a roo
+0000bd90: 7420 6973 0a20 2020 2020 2020 207a 6572  t is.        zer
+0000bda0: 6f2e 0a0a 2020 2020 2020 2020 4173 2061  o...        As a
+0000bdb0: 2073 7065 6369 616c 2063 6173 652c 2074   special case, t
+0000bdc0: 6865 2064 6570 7468 206f 6620 7468 6520  he depth of the 
+0000bdd0: 3a72 6566 3a60 7669 7274 7561 6c20 726f  :ref:`virtual ro
+0000bde0: 6f74 0a20 2020 2020 2020 203c 7365 635f  ot.        <sec_
+0000bdf0: 6461 7461 5f6d 6f64 656c 5f74 7265 655f  data_model_tree_
+0000be00: 726f 6f74 733e 6020 6973 2064 6566 696e  roots>` is defin
+0000be10: 6564 2061 7320 2d31 2e0a 0a20 2020 2020  ed as -1...     
+0000be20: 2020 203a 7061 7261 6d20 696e 7420 753a     :param int u:
+0000be30: 2054 6865 206e 6f64 6520 6f66 2069 6e74   The node of int
+0000be40: 6572 6573 742e 0a20 2020 2020 2020 203a  erest..        :
+0000be50: 7265 7475 726e 3a20 5468 6520 6465 7074  return: The dept
+0000be60: 6820 6f66 2075 2e0a 2020 2020 2020 2020  h of u..        
+0000be70: 3a72 7479 7065 3a20 696e 740a 2020 2020  :rtype: int.    
+0000be80: 2020 2020 2222 220a 2020 2020 2020 2020      """.        
+0000be90: 7265 7475 726e 2073 656c 662e 5f6c 6c5f  return self._ll_
+0000bea0: 7472 6565 2e64 6570 7468 2875 290a 0a20  tree.depth(u).. 
+0000beb0: 2020 2064 6566 2067 6574 5f70 6f70 756c     def get_popul
+0000bec0: 6174 696f 6e28 7365 6c66 2c20 7529 3a0a  ation(self, u):.
+0000bed0: 2020 2020 2020 2020 2320 4465 7072 6563          # Deprec
+0000bee0: 6174 6564 2061 6c69 6173 2066 6f72 2073  ated alias for s
+0000bef0: 656c 662e 706f 7075 6c61 7469 6f6e 0a20  elf.population. 
+0000bf00: 2020 2020 2020 2072 6574 7572 6e20 7365         return se
+0000bf10: 6c66 2e70 6f70 756c 6174 696f 6e28 7529  lf.population(u)
+0000bf20: 0a0a 2020 2020 6465 6620 706f 7075 6c61  ..    def popula
+0000bf30: 7469 6f6e 2873 656c 662c 2075 293a 0a20  tion(self, u):. 
+0000bf40: 2020 2020 2020 2022 2222 0a20 2020 2020         """.     
+0000bf50: 2020 2052 6574 7572 6e73 2074 6865 2070     Returns the p
+0000bf60: 6f70 756c 6174 696f 6e20 6173 736f 6369  opulation associ
+0000bf70: 6174 6564 2077 6974 6820 7468 6520 7370  ated with the sp
+0000bf80: 6563 6966 6965 6420 6e6f 6465 2e0a 2020  ecified node..  
+0000bf90: 2020 2020 2020 4571 7569 7661 6c65 6e74        Equivalent
+0000bfa0: 2074 6f20 6060 7472 6565 2e74 7265 655f   to ``tree.tree_
+0000bfb0: 7365 7175 656e 6365 2e6e 6f64 6528 7529  sequence.node(u)
+0000bfc0: 2e70 6f70 756c 6174 696f 6e60 602e 0a0a  .population``...
+0000bfd0: 2020 2020 2020 2020 3a70 6172 616d 2069          :param i
+0000bfe0: 6e74 2075 3a20 5468 6520 6e6f 6465 206f  nt u: The node o
+0000bff0: 6620 696e 7465 7265 7374 2e0a 2020 2020  f interest..    
+0000c000: 2020 2020 3a72 6574 7572 6e3a 2054 6865      :return: The
+0000c010: 2049 4420 6f66 2074 6865 2070 6f70 756c   ID of the popul
+0000c020: 6174 696f 6e20 6173 736f 6369 6174 6564  ation associated
+0000c030: 2077 6974 6820 6e6f 6465 2075 2e0a 2020   with node u..  
+0000c040: 2020 2020 2020 3a72 7479 7065 3a20 696e        :rtype: in
+0000c050: 740a 2020 2020 2020 2020 2222 220a 2020  t.        """.  
+0000c060: 2020 2020 2020 7265 7475 726e 2073 656c        return sel
+0000c070: 662e 5f6c 6c5f 7472 6565 2e67 6574 5f70  f._ll_tree.get_p
+0000c080: 6f70 756c 6174 696f 6e28 7529 0a0a 2020  opulation(u)..  
+0000c090: 2020 6465 6620 6973 5f69 6e74 6572 6e61    def is_interna
+0000c0a0: 6c28 7365 6c66 2c20 7529 3a0a 2020 2020  l(self, u):.    
+0000c0b0: 2020 2020 2222 220a 2020 2020 2020 2020      """.        
+0000c0c0: 5265 7475 726e 7320 5472 7565 2069 6620  Returns True if 
+0000c0d0: 7468 6520 7370 6563 6966 6965 6420 6e6f  the specified no
+0000c0e0: 6465 2069 7320 6e6f 7420 6120 6c65 6166  de is not a leaf
+0000c0f0: 2e20 4120 6e6f 6465 2069 7320 696e 7465  . A node is inte
+0000c100: 726e 616c 0a20 2020 2020 2020 2069 6620  rnal.        if 
+0000c110: 6974 2068 6173 206f 6e65 206f 7220 6d6f  it has one or mo
+0000c120: 7265 2063 6869 6c64 7265 6e20 696e 2074  re children in t
+0000c130: 6865 2063 7572 7265 6e74 2074 7265 652e  he current tree.
+0000c140: 0a0a 2020 2020 2020 2020 3a70 6172 616d  ..        :param
+0000c150: 2069 6e74 2075 3a20 5468 6520 6e6f 6465   int u: The node
+0000c160: 206f 6620 696e 7465 7265 7374 2e0a 2020   of interest..  
+0000c170: 2020 2020 2020 3a72 6574 7572 6e3a 2054        :return: T
+0000c180: 7275 6520 6966 2075 2069 7320 6e6f 7420  rue if u is not 
+0000c190: 6120 6c65 6166 206e 6f64 652e 0a20 2020  a leaf node..   
+0000c1a0: 2020 2020 203a 7274 7970 653a 2062 6f6f       :rtype: boo
+0000c1b0: 6c0a 2020 2020 2020 2020 2222 220a 2020  l.        """.  
+0000c1c0: 2020 2020 2020 7265 7475 726e 206e 6f74        return not
+0000c1d0: 2073 656c 662e 6973 5f6c 6561 6628 7529   self.is_leaf(u)
+0000c1e0: 0a0a 2020 2020 6465 6620 6973 5f6c 6561  ..    def is_lea
+0000c1f0: 6628 7365 6c66 2c20 7529 3a0a 2020 2020  f(self, u):.    
+0000c200: 2020 2020 2222 220a 2020 2020 2020 2020      """.        
+0000c210: 5265 7475 726e 7320 5472 7565 2069 6620  Returns True if 
+0000c220: 7468 6520 7370 6563 6966 6965 6420 6e6f  the specified no
+0000c230: 6465 2069 7320 6120 6c65 6166 2e20 4120  de is a leaf. A 
+0000c240: 6e6f 6465 203a 6d61 7468 3a60 7560 2069  node :math:`u` i
+0000c250: 7320 610a 2020 2020 2020 2020 6c65 6166  s a.        leaf
+0000c260: 2069 6620 6974 2068 6173 207a 6572 6f20   if it has zero 
+0000c270: 6368 696c 6472 656e 2e0a 0a20 2020 2020  children...     
+0000c280: 2020 202e 2e20 6e6f 7465 3a3a 0a20 2020     .. note::.   
+0000c290: 2020 2020 2020 2020 203a 6d61 7468 3a60           :math:`
+0000c2a0: 7560 2063 616e 2062 6520 616e 7920 6e6f  u` can be any no
+0000c2b0: 6465 2069 6e20 7468 6520 656e 7469 7265  de in the entire
+0000c2c0: 2074 7265 6520 7365 7175 656e 6365 2c20   tree sequence, 
+0000c2d0: 696e 636c 7564 696e 6720 6f6e 6573 0a20  including ones. 
+0000c2e0: 2020 2020 2020 2020 2020 2077 6869 6368             which
+0000c2f0: 2061 7265 206e 6f74 2063 6f6e 6e65 6374   are not connect
+0000c300: 6564 2076 6961 2062 7261 6e63 6865 7320  ed via branches 
+0000c310: 746f 2061 2072 6f6f 7420 6e6f 6465 206f  to a root node o
+0000c320: 6620 7468 6520 7472 6565 2028 616e 6420  f the tree (and 
+0000c330: 7768 6963 680a 2020 2020 2020 2020 2020  which.          
+0000c340: 2020 6172 6520 7468 6572 6566 6f72 6520    are therefore 
+0000c350: 6e6f 7420 636f 6e76 656e 7469 6f6e 616c  not conventional
+0000c360: 6c79 2063 6f6e 7369 6465 7265 6420 7061  ly considered pa
+0000c370: 7274 206f 6620 7468 6520 7472 6565 292e  rt of the tree).
+0000c380: 2049 6e64 6565 642c 2069 660a 2020 2020   Indeed, if.    
+0000c390: 2020 2020 2020 2020 7468 6572 6520 6172          there ar
+0000c3a0: 6520 6d61 6e79 2074 7265 6573 2069 6e20  e many trees in 
+0000c3b0: 7468 6520 7472 6565 2073 6571 7565 6e63  the tree sequenc
+0000c3c0: 652c 2069 7420 6973 2063 6f6d 6d6f 6e20  e, it is common 
+0000c3d0: 666f 7220 7468 6520 6d61 6a6f 7269 7479  for the majority
+0000c3e0: 206f 660a 2020 2020 2020 2020 2020 2020   of.            
+0000c3f0: 6e6f 6e2d 7361 6d70 6c65 206e 6f64 6573  non-sample nodes
+0000c400: 2074 6f20 6265 203a 6d65 7468 3a60 6973   to be :meth:`is
+0000c410: 6f6c 6174 6564 3c69 735f 6973 6f6c 6174  olated<is_isolat
+0000c420: 6564 3e60 2069 6e20 616e 7920 6f6e 650a  ed>` in any one.
+0000c430: 2020 2020 2020 2020 2020 2020 7472 6565              tree
+0000c440: 2e20 4279 2074 6865 2064 6566 696e 6974  . By the definit
+0000c450: 696f 6e20 6162 6f76 652c 2074 6869 7320  ion above, this 
+0000c460: 6d65 7468 6f64 2077 696c 6c20 7265 7475  method will retu
+0000c470: 726e 2060 6054 7275 6560 6020 666f 7220  rn ``True`` for 
+0000c480: 7375 6368 0a20 2020 2020 2020 2020 2020  such.           
+0000c490: 2061 2074 7265 6520 7768 656e 2061 206e   a tree when a n
+0000c4a0: 6f64 6520 6f66 2074 6869 7320 736f 7274  ode of this sort
+0000c4b0: 2069 7320 7370 6563 6966 6965 642e 2053   is specified. S
+0000c4c0: 7563 6820 6e6f 6465 7320 6361 6e20 6265  uch nodes can be
+0000c4d0: 2074 686f 7567 6874 206f 660a 2020 2020   thought of.    
+0000c4e0: 2020 2020 2020 2020 6173 2022 6465 6164          as "dead
+0000c4f0: 206c 6561 7665 7322 2c20 7365 6520 3a72   leaves", see :r
+0000c500: 6566 3a60 7365 635f 6461 7461 5f6d 6f64  ef:`sec_data_mod
+0000c510: 656c 5f74 7265 655f 6465 6164 5f6c 6561  el_tree_dead_lea
+0000c520: 7665 735f 616e 645f 6272 616e 6368 6573  ves_and_branches
+0000c530: 602e 0a0a 2020 2020 2020 2020 3a70 6172  `...        :par
+0000c540: 616d 2069 6e74 2075 3a20 5468 6520 6e6f  am int u: The no
+0000c550: 6465 206f 6620 696e 7465 7265 7374 2e0a  de of interest..
+0000c560: 2020 2020 2020 2020 3a72 6574 7572 6e3a          :return:
+0000c570: 2054 7275 6520 6966 2075 2069 7320 6120   True if u is a 
+0000c580: 6c65 6166 206e 6f64 652e 0a20 2020 2020  leaf node..     
+0000c590: 2020 203a 7274 7970 653a 2062 6f6f 6c0a     :rtype: bool.
+0000c5a0: 2020 2020 2020 2020 2222 220a 2020 2020          """.    
+0000c5b0: 2020 2020 7265 7475 726e 206c 656e 2873      return len(s
+0000c5c0: 656c 662e 6368 696c 6472 656e 2875 2929  elf.children(u))
+0000c5d0: 203d 3d20 300a 0a20 2020 2064 6566 2069   == 0..    def i
+0000c5e0: 735f 6973 6f6c 6174 6564 2873 656c 662c  s_isolated(self,
+0000c5f0: 2075 293a 0a20 2020 2020 2020 2022 2222   u):.        """
+0000c600: 0a20 2020 2020 2020 2052 6574 7572 6e73  .        Returns
+0000c610: 2054 7275 6520 6966 2074 6865 2073 7065   True if the spe
+0000c620: 6369 6669 6564 206e 6f64 6520 6973 2069  cified node is i
+0000c630: 736f 6c61 7465 6420 696e 2074 6869 7320  solated in this 
+0000c640: 7472 6565 3a20 7468 6174 2069 730a 2020  tree: that is.  
+0000c650: 2020 2020 2020 6974 2068 6173 206e 6f20        it has no 
+0000c660: 7061 7265 6e74 7320 616e 6420 6e6f 2063  parents and no c
+0000c670: 6869 6c64 7265 6e20 286e 6f74 6520 7468  hildren (note th
+0000c680: 6174 2061 6c6c 2069 736f 6c61 7465 6420  at all isolated 
+0000c690: 6e6f 6465 7320 696e 2074 6865 2074 7265  nodes in the tre
+0000c6a0: 650a 2020 2020 2020 2020 6172 6520 7468  e.        are th
+0000c6b0: 6572 6566 6f72 6520 616c 736f 203a 6d65  erefore also :me
+0000c6c0: 7468 3a60 6c65 6176 6573 3c54 7265 652e  th:`leaves<Tree.
+0000c6d0: 6973 5f6c 6561 663e 6029 2e20 5361 6d70  is_leaf>`). Samp
+0000c6e0: 6c65 206e 6f64 6573 2074 6861 7420 6172  le nodes that ar
+0000c6f0: 6520 6973 6f6c 6174 6564 0a20 2020 2020  e isolated.     
+0000c700: 2020 2061 6e64 2068 6176 6520 6e6f 206d     and have no m
+0000c710: 7574 6174 696f 6e73 2061 626f 7665 2074  utations above t
+0000c720: 6865 6d20 6172 6520 7573 6564 2074 6f20  hem are used to 
+0000c730: 7265 7072 6573 656e 740a 2020 2020 2020  represent.      
+0000c740: 2020 3a72 6566 3a60 6d69 7373 696e 6720    :ref:`missing 
+0000c750: 6461 7461 3c73 6563 5f64 6174 615f 6d6f  data<sec_data_mo
+0000c760: 6465 6c5f 6d69 7373 696e 675f 6461 7461  del_missing_data
+0000c770: 3e60 2e0a 0a20 2020 2020 2020 203a 7061  >`...        :pa
+0000c780: 7261 6d20 696e 7420 753a 2054 6865 206e  ram int u: The n
+0000c790: 6f64 6520 6f66 2069 6e74 6572 6573 742e  ode of interest.
+0000c7a0: 0a20 2020 2020 2020 203a 7265 7475 726e  .        :return
+0000c7b0: 3a20 5472 7565 2069 6620 7520 6973 2061  : True if u is a
+0000c7c0: 6e20 6973 6f6c 6174 6564 206e 6f64 652e  n isolated node.
+0000c7d0: 0a20 2020 2020 2020 203a 7274 7970 653a  .        :rtype:
+0000c7e0: 2062 6f6f 6c0a 2020 2020 2020 2020 2222   bool.        ""
+0000c7f0: 220a 2020 2020 2020 2020 7265 7475 726e  ".        return
+0000c800: 2073 656c 662e 6e75 6d5f 6368 696c 6472   self.num_childr
+0000c810: 656e 2875 2920 3d3d 2030 2061 6e64 2073  en(u) == 0 and s
+0000c820: 656c 662e 7061 7265 6e74 2875 2920 3d3d  elf.parent(u) ==
+0000c830: 204e 554c 4c0a 0a20 2020 2064 6566 2069   NULL..    def i
+0000c840: 735f 7361 6d70 6c65 2873 656c 662c 2075  s_sample(self, u
+0000c850: 293a 0a20 2020 2020 2020 2022 2222 0a20  ):.        """. 
+0000c860: 2020 2020 2020 2052 6574 7572 6e73 2054         Returns T
+0000c870: 7275 6520 6966 2074 6865 2073 7065 6369  rue if the speci
+0000c880: 6669 6564 206e 6f64 6520 6973 2061 2073  fied node is a s
+0000c890: 616d 706c 652e 2041 206e 6f64 6520 3a6d  ample. A node :m
+0000c8a0: 6174 683a 6075 6020 6973 2061 0a20 2020  ath:`u` is a.   
+0000c8b0: 2020 2020 2073 616d 706c 6520 6966 2069       sample if i
+0000c8c0: 7420 6861 7320 6265 656e 206d 6172 6b65  t has been marke
+0000c8d0: 6420 6173 2061 2073 616d 706c 6520 696e  d as a sample in
+0000c8e0: 2074 6865 2070 6172 656e 7420 7472 6565   the parent tree
+0000c8f0: 2073 6571 7565 6e63 652e 0a0a 2020 2020   sequence...    
+0000c900: 2020 2020 3a70 6172 616d 2069 6e74 2075      :param int u
+0000c910: 3a20 5468 6520 6e6f 6465 206f 6620 696e  : The node of in
+0000c920: 7465 7265 7374 2e0a 2020 2020 2020 2020  terest..        
+0000c930: 3a72 6574 7572 6e3a 2054 7275 6520 6966  :return: True if
+0000c940: 2075 2069 7320 6120 7361 6d70 6c65 2e0a   u is a sample..
+0000c950: 2020 2020 2020 2020 3a72 7479 7065 3a20          :rtype: 
+0000c960: 626f 6f6c 0a20 2020 2020 2020 2022 2222  bool.        """
+0000c970: 0a20 2020 2020 2020 2072 6574 7572 6e20  .        return 
+0000c980: 626f 6f6c 2873 656c 662e 5f6c 6c5f 7472  bool(self._ll_tr
+0000c990: 6565 2e69 735f 7361 6d70 6c65 2875 2929  ee.is_sample(u))
+0000c9a0: 0a0a 2020 2020 6465 6620 6973 5f64 6573  ..    def is_des
+0000c9b0: 6365 6e64 616e 7428 7365 6c66 2c20 752c  cendant(self, u,
+0000c9c0: 2076 293a 0a20 2020 2020 2020 2022 2222   v):.        """
+0000c9d0: 0a20 2020 2020 2020 2052 6574 7572 6e73  .        Returns
+0000c9e0: 2054 7275 6520 6966 2074 6865 2073 7065   True if the spe
+0000c9f0: 6369 6669 6564 206e 6f64 6520 7520 6973  cified node u is
+0000ca00: 2061 2064 6573 6365 6e64 616e 7420 6f66   a descendant of
+0000ca10: 206e 6f64 6520 7620 616e 6420 4661 6c73   node v and Fals
+0000ca20: 650a 2020 2020 2020 2020 6f74 6865 7277  e.        otherw
+0000ca30: 6973 652e 2041 206e 6f64 6520 3a6d 6174  ise. A node :mat
+0000ca40: 683a 6075 6020 6973 2061 2064 6573 6365  h:`u` is a desce
+0000ca50: 6e64 616e 7420 6f66 2061 6e6f 7468 6572  ndant of another
+0000ca60: 206e 6f64 6520 3a6d 6174 683a 6076 6020   node :math:`v` 
+0000ca70: 6966 0a20 2020 2020 2020 203a 6d61 7468  if.        :math
+0000ca80: 3a60 7660 2069 7320 6f6e 2074 6865 2070  :`v` is on the p
+0000ca90: 6174 6820 6672 6f6d 203a 6d61 7468 3a60  ath from :math:`
+0000caa0: 7560 2074 6f20 726f 6f74 2e20 4120 6e6f  u` to root. A no
+0000cab0: 6465 2069 7320 636f 6e73 6964 6572 6564  de is considered
+0000cac0: 0a20 2020 2020 2020 2074 6f20 6265 2061  .        to be a
+0000cad0: 2064 6573 6365 6e64 616e 7420 6f66 2069   descendant of i
+0000cae0: 7473 656c 662c 2073 6f20 6060 7472 6565  tself, so ``tree
+0000caf0: 2e69 735f 6465 7363 656e 6461 6e74 2875  .is_descendant(u
+0000cb00: 2c20 7529 6060 2077 696c 6c20 6265 0a20  , u)`` will be. 
+0000cb10: 2020 2020 2020 2054 7275 6520 666f 7220         True for 
+0000cb20: 616e 7920 7661 6c69 6420 6e6f 6465 2e0a  any valid node..
+0000cb30: 0a20 2020 2020 2020 203a 7061 7261 6d20  .        :param 
+0000cb40: 696e 7420 753a 2054 6865 2064 6573 6365  int u: The desce
+0000cb50: 6e64 616e 7420 6e6f 6465 2e0a 2020 2020  ndant node..    
+0000cb60: 2020 2020 3a70 6172 616d 2069 6e74 2076      :param int v
+0000cb70: 3a20 5468 6520 616e 6365 7374 7261 6c20  : The ancestral 
+0000cb80: 6e6f 6465 2e0a 2020 2020 2020 2020 3a72  node..        :r
+0000cb90: 6574 7572 6e3a 2054 7275 6520 6966 2075  eturn: True if u
+0000cba0: 2069 7320 6120 6465 7363 656e 6461 6e74   is a descendant
+0000cbb0: 206f 6620 762e 0a20 2020 2020 2020 203a   of v..        :
+0000cbc0: 7274 7970 653a 2062 6f6f 6c0a 2020 2020  rtype: bool.    
+0000cbd0: 2020 2020 3a72 6169 7365 7320 5661 6c75      :raises Valu
+0000cbe0: 6545 7272 6f72 3a20 4966 2075 206f 7220  eError: If u or 
+0000cbf0: 7620 6172 6520 6e6f 7420 7661 6c69 6420  v are not valid 
+0000cc00: 6e6f 6465 2049 4473 2e0a 2020 2020 2020  node IDs..      
+0000cc10: 2020 2222 220a 2020 2020 2020 2020 7265    """.        re
+0000cc20: 7475 726e 2062 6f6f 6c28 7365 6c66 2e5f  turn bool(self._
+0000cc30: 6c6c 5f74 7265 652e 6973 5f64 6573 6365  ll_tree.is_desce
+0000cc40: 6e64 616e 7428 752c 2076 2929 0a0a 2020  ndant(u, v))..  
+0000cc50: 2020 4070 726f 7065 7274 790a 2020 2020    @property.    
+0000cc60: 6465 6620 6e75 6d5f 6e6f 6465 7328 7365  def num_nodes(se
+0000cc70: 6c66 293a 0a20 2020 2020 2020 2022 2222  lf):.        """
+0000cc80: 0a20 2020 2020 2020 2052 6574 7572 6e73  .        Returns
+0000cc90: 2074 6865 206e 756d 6265 7220 6f66 206e   the number of n
+0000cca0: 6f64 6573 2069 6e20 7468 6520 3a63 6c61  odes in the :cla
+0000ccb0: 7373 3a60 5472 6565 5365 7175 656e 6365  ss:`TreeSequence
+0000ccc0: 6020 7468 6973 2074 7265 6520 6973 2069  ` this tree is i
+0000ccd0: 6e2e 0a20 2020 2020 2020 2045 7175 6976  n..        Equiv
+0000cce0: 616c 656e 7420 746f 2060 6074 7265 652e  alent to ``tree.
+0000ccf0: 7472 6565 5f73 6571 7565 6e63 652e 6e75  tree_sequence.nu
+0000cd00: 6d5f 6e6f 6465 7360 602e 0a0a 2020 2020  m_nodes``...    
+0000cd10: 2020 2020 2e2e 2064 6570 7265 6361 7465      .. deprecate
+0000cd20: 643a 3a20 302e 340a 2020 2020 2020 2020  d:: 0.4.        
+0000cd30: 2020 2020 5573 6520 3a61 7474 723a 6054      Use :attr:`T
+0000cd40: 7265 652e 7472 6565 5f73 6571 7565 6e63  ree.tree_sequenc
+0000cd50: 652e 6e75 6d5f 6e6f 6465 733c 5472 6565  e.num_nodes<Tree
+0000cd60: 5365 7175 656e 6365 2e6e 756d 5f6e 6f64  Sequence.num_nod
+0000cd70: 6573 3e60 2069 6620 796f 7520 7761 6e74  es>` if you want
+0000cd80: 0a20 2020 2020 2020 2020 2020 2074 6865  .            the
+0000cd90: 206e 756d 6265 7220 6f66 206e 6f64 6573   number of nodes
+0000cda0: 2069 6e20 7468 6520 656e 7469 7265 2074   in the entire t
+0000cdb0: 7265 6520 7365 7175 656e 6365 2c20 6f72  ree sequence, or
+0000cdc0: 0a20 2020 2020 2020 2020 2020 2060 606c  .            ``l
+0000cdd0: 656e 2874 7265 652e 7072 656f 7264 6572  en(tree.preorder
+0000cde0: 2829 2960 6020 746f 2066 696e 6420 7468  ())`` to find th
+0000cdf0: 6520 6e75 6d62 6572 206f 6620 6e6f 6465  e number of node
+0000ce00: 7320 7468 6174 2061 7265 0a20 2020 2020  s that are.     
+0000ce10: 2020 2020 2020 2072 6561 6368 6162 6c65         reachable
+0000ce20: 2066 726f 6d20 616c 6c20 726f 6f74 7320   from all roots 
+0000ce30: 696e 2074 6869 7320 7472 6565 2e0a 0a20  in this tree... 
+0000ce40: 2020 2020 2020 203a 7274 7970 653a 2069         :rtype: i
+0000ce50: 6e74 0a0a 2020 2020 2020 2020 2222 220a  nt..        """.
+0000ce60: 2020 2020 2020 2020 7761 726e 696e 6773          warnings
+0000ce70: 2e77 6172 6e28 0a20 2020 2020 2020 2020  .warn(.         
+0000ce80: 2020 2022 5468 6973 2070 726f 7065 7274     "This propert
+0000ce90: 7920 6973 2061 2064 6570 7265 6361 7465  y is a deprecate
+0000cea0: 6420 616c 6961 7320 666f 7220 5472 6565  d alias for Tree
+0000ceb0: 2e74 7265 655f 7365 7175 656e 6365 2e6e  .tree_sequence.n
+0000cec0: 756d 5f6e 6f64 6573 2022 0a20 2020 2020  um_nodes ".     
+0000ced0: 2020 2020 2020 2022 616e 6420 7769 6c6c         "and will
+0000cee0: 2062 6520 7265 6d6f 7665 6420 696e 2074   be removed in t
+0000cef0: 6865 2066 7574 7572 652e 2054 6f20 6f62  he future. To ob
+0000cf00: 7461 696e 2074 6865 206e 756d 6265 7220  tain the number 
+0000cf10: 6f66 206e 6f64 6573 2022 0a20 2020 2020  of nodes ".     
+0000cf20: 2020 2020 2020 2022 696e 2074 6865 2074         "in the t
+0000cf30: 6f70 6f6c 6f67 7920 6f66 2074 6865 2063  opology of the c
+0000cf40: 7572 7265 6e74 2074 7265 6520 2869 2e65  urrent tree (i.e
+0000cf50: 2e20 7265 6163 6861 626c 6520 6672 6f6d  . reachable from
+0000cf60: 2074 6865 2072 6f6f 7473 2920 220a 2020   the roots) ".  
+0000cf70: 2020 2020 2020 2020 2020 2275 7365 206c            "use l
+0000cf80: 656e 2874 7265 652e 7072 656f 7264 6572  en(tree.preorder
+0000cf90: 2829 292e 222c 0a20 2020 2020 2020 2020  ()).",.         
+0000cfa0: 2020 2046 7574 7572 6557 6172 6e69 6e67     FutureWarning
+0000cfb0: 2c0a 2020 2020 2020 2020 290a 2020 2020  ,.        ).    
+0000cfc0: 2020 2020 7265 7475 726e 2073 656c 662e      return self.
+0000cfd0: 7472 6565 5f73 6571 7565 6e63 652e 6e75  tree_sequence.nu
+0000cfe0: 6d5f 6e6f 6465 730a 0a20 2020 2040 7072  m_nodes..    @pr
+0000cff0: 6f70 6572 7479 0a20 2020 2064 6566 206e  operty.    def n
+0000d000: 756d 5f72 6f6f 7473 2873 656c 6629 3a0a  um_roots(self):.
+0000d010: 2020 2020 2020 2020 2222 220a 2020 2020          """.    
+0000d020: 2020 2020 5468 6520 6e75 6d62 6572 206f      The number o
+0000d030: 6620 726f 6f74 7320 696e 2074 6869 7320  f roots in this 
+0000d040: 7472 6565 2c20 6173 2064 6566 696e 6564  tree, as defined
+0000d050: 2069 6e20 7468 6520 3a61 7474 723a 607e   in the :attr:`~
+0000d060: 5472 6565 2e72 6f6f 7473 600a 2020 2020  Tree.roots`.    
+0000d070: 2020 2020 6174 7472 6962 7574 652e 0a0a      attribute...
+0000d080: 2020 2020 2020 2020 4f6e 6c79 2072 6571          Only req
+0000d090: 7569 7265 7320 4f28 6e75 6d62 6572 206f  uires O(number o
+0000d0a0: 6620 726f 6f74 7329 2074 696d 652e 0a0a  f roots) time...
+0000d0b0: 2020 2020 2020 2020 3a72 7479 7065 3a20          :rtype: 
+0000d0c0: 696e 740a 2020 2020 2020 2020 2222 220a  int.        """.
+0000d0d0: 2020 2020 2020 2020 7265 7475 726e 2073          return s
+0000d0e0: 656c 662e 5f6c 6c5f 7472 6565 2e67 6574  elf._ll_tree.get
+0000d0f0: 5f6e 756d 5f72 6f6f 7473 2829 0a0a 2020  _num_roots()..  
+0000d100: 2020 4070 726f 7065 7274 790a 2020 2020    @property.    
+0000d110: 6465 6620 6861 735f 7369 6e67 6c65 5f72  def has_single_r
+0000d120: 6f6f 7428 7365 6c66 293a 0a20 2020 2020  oot(self):.     
+0000d130: 2020 2022 2222 0a20 2020 2020 2020 2060     """.        `
+0000d140: 6054 7275 6560 6020 6966 2074 6869 7320  `True`` if this 
+0000d150: 7472 6565 2068 6173 2061 2073 696e 676c  tree has a singl
+0000d160: 6520 726f 6f74 2c20 6060 4661 6c73 6560  e root, ``False`
+0000d170: 6020 6f74 6865 7277 6973 652e 0a20 2020  ` otherwise..   
+0000d180: 2020 2020 2045 7175 6976 616c 656e 7420       Equivalent 
+0000d190: 746f 2074 7265 652e 6e75 6d5f 726f 6f74  to tree.num_root
+0000d1a0: 7320 3d3d 2031 2e20 5468 6973 2069 7320  s == 1. This is 
+0000d1b0: 6120 4f28 3129 206f 7065 7261 7469 6f6e  a O(1) operation
+0000d1c0: 2e0a 0a20 2020 2020 2020 203a 7274 7970  ...        :rtyp
+0000d1d0: 653a 2062 6f6f 6c0a 2020 2020 2020 2020  e: bool.        
+0000d1e0: 2222 220a 2020 2020 2020 2020 726f 6f74  """.        root
+0000d1f0: 203d 2073 656c 662e 6c65 6674 5f72 6f6f   = self.left_roo
+0000d200: 740a 2020 2020 2020 2020 6966 2072 6f6f  t.        if roo
+0000d210: 7420 213d 204e 554c 4c20 616e 6420 7365  t != NULL and se
+0000d220: 6c66 2e72 6967 6874 5f73 6962 2872 6f6f  lf.right_sib(roo
+0000d230: 7429 203d 3d20 4e55 4c4c 3a0a 2020 2020  t) == NULL:.    
+0000d240: 2020 2020 2020 2020 7265 7475 726e 2054          return T
+0000d250: 7275 650a 2020 2020 2020 2020 7265 7475  rue.        retu
+0000d260: 726e 2046 616c 7365 0a0a 2020 2020 4070  rn False..    @p
+0000d270: 726f 7065 7274 790a 2020 2020 6465 6620  roperty.    def 
+0000d280: 6861 735f 6d75 6c74 6970 6c65 5f72 6f6f  has_multiple_roo
+0000d290: 7473 2873 656c 6629 3a0a 2020 2020 2020  ts(self):.      
+0000d2a0: 2020 2222 220a 2020 2020 2020 2020 6060    """.        ``
+0000d2b0: 5472 7565 6060 2069 6620 7468 6973 2074  True`` if this t
+0000d2c0: 7265 6520 6861 7320 6d6f 7265 2074 6861  ree has more tha
+0000d2d0: 6e20 6f6e 6520 726f 6f74 2c20 6060 4661  n one root, ``Fa
+0000d2e0: 6c73 6560 6020 6f74 6865 7277 6973 652e  lse`` otherwise.
+0000d2f0: 0a20 2020 2020 2020 2045 7175 6976 616c  .        Equival
+0000d300: 656e 7420 746f 2074 7265 652e 6e75 6d5f  ent to tree.num_
+0000d310: 726f 6f74 7320 3e20 312e 2054 6869 7320  roots > 1. This 
+0000d320: 6973 2061 204f 2831 2920 6f70 6572 6174  is a O(1) operat
+0000d330: 696f 6e2e 0a0a 2020 2020 2020 2020 3a72  ion...        :r
+0000d340: 7479 7065 3a20 626f 6f6c 0a20 2020 2020  type: bool.     
+0000d350: 2020 2022 2222 0a20 2020 2020 2020 2072     """.        r
+0000d360: 6f6f 7420 3d20 7365 6c66 2e6c 6566 745f  oot = self.left_
+0000d370: 726f 6f74 0a20 2020 2020 2020 2069 6620  root.        if 
+0000d380: 726f 6f74 2021 3d20 4e55 4c4c 2061 6e64  root != NULL and
+0000d390: 2073 656c 662e 7269 6768 745f 7369 6228   self.right_sib(
+0000d3a0: 726f 6f74 2920 213d 204e 554c 4c3a 0a20  root) != NULL:. 
+0000d3b0: 2020 2020 2020 2020 2020 2072 6574 7572             retur
+0000d3c0: 6e20 5472 7565 0a20 2020 2020 2020 2072  n True.        r
+0000d3d0: 6574 7572 6e20 4661 6c73 650a 0a20 2020  eturn False..   
+0000d3e0: 2040 7072 6f70 6572 7479 0a20 2020 2064   @property.    d
+0000d3f0: 6566 2072 6f6f 7473 2873 656c 6629 3a0a  ef roots(self):.
+0000d400: 2020 2020 2020 2020 2222 220a 2020 2020          """.    
+0000d410: 2020 2020 5468 6520 6c69 7374 206f 6620      The list of 
+0000d420: 726f 6f74 7320 696e 2074 6869 7320 7472  roots in this tr
+0000d430: 6565 2e20 4120 726f 6f74 2069 7320 6465  ee. A root is de
+0000d440: 6669 6e65 6420 6173 2061 2075 6e69 7175  fined as a uniqu
+0000d450: 6520 656e 6470 6f69 6e74 206f 6620 7468  e endpoint of th
+0000d460: 650a 2020 2020 2020 2020 7061 7468 7320  e.        paths 
+0000d470: 7374 6172 7469 6e67 2061 7420 7361 6d70  starting at samp
+0000d480: 6c65 732c 2073 7562 6a65 6374 2074 6f20  les, subject to 
+0000d490: 7468 6520 636f 6e64 6974 696f 6e20 7468  the condition th
+0000d4a0: 6174 2069 7420 6973 2063 6f6e 6e65 6374  at it is connect
+0000d4b0: 6564 2074 6f20 6174 0a20 2020 2020 2020  ed to at.       
+0000d4c0: 206c 6561 7374 203a 6174 7472 3a60 726f   least :attr:`ro
+0000d4d0: 6f74 5f74 6872 6573 686f 6c64 6020 7361  ot_threshold` sa
+0000d4e0: 6d70 6c65 732e 2057 6520 6361 6e20 6465  mples. We can de
+0000d4f0: 6669 6e65 2074 6865 2073 6574 206f 6620  fine the set of 
+0000d500: 726f 6f74 7320 6173 2066 6f6c 6c6f 7773  roots as follows
+0000d510: 3a0a 0a20 2020 2020 2020 202e 2e20 636f  :..        .. co
+0000d520: 6465 2d62 6c6f 636b 3a3a 2070 7974 686f  de-block:: pytho
+0000d530: 6e0a 0a20 2020 2020 2020 2020 2020 2072  n..            r
+0000d540: 6f6f 7473 203d 2073 6574 2829 0a20 2020  oots = set().   
+0000d550: 2020 2020 2020 2020 2066 6f72 2075 2069           for u i
+0000d560: 6e20 7472 6565 5f73 6571 7565 6e63 652e  n tree_sequence.
+0000d570: 7361 6d70 6c65 7328 293a 0a20 2020 2020  samples():.     
+0000d580: 2020 2020 2020 2020 2020 2077 6869 6c65             while
+0000d590: 2074 7265 652e 7061 7265 6e74 2875 2920   tree.parent(u) 
+0000d5a0: 213d 2074 736b 6974 2e4e 554c 4c3a 0a20  != tskit.NULL:. 
+0000d5b0: 2020 2020 2020 2020 2020 2020 2020 2020                  
+0000d5c0: 2020 2075 203d 2074 7265 652e 7061 7265     u = tree.pare
+0000d5d0: 6e74 2875 290a 2020 2020 2020 2020 2020  nt(u).          
+0000d5e0: 2020 2020 2020 6966 2074 7265 652e 6e75        if tree.nu
+0000d5f0: 6d5f 7361 6d70 6c65 7328 7529 203e 3d20  m_samples(u) >= 
+0000d600: 7472 6565 2e72 6f6f 745f 7468 7265 7368  tree.root_thresh
+0000d610: 6f6c 643a 0a20 2020 2020 2020 2020 2020  old:.           
+0000d620: 2020 2020 2020 2020 2072 6f6f 7473 2e61           roots.a
+0000d630: 6464 2875 290a 2020 2020 2020 2020 2020  dd(u).          
+0000d640: 2020 2320 726f 6f74 7320 6973 206e 6f77    # roots is now
+0000d650: 2074 6865 2073 6574 206f 6620 616c 6c20   the set of all 
+0000d660: 726f 6f74 7320 696e 2074 6869 7320 7472  roots in this tr
+0000d670: 6565 2e0a 2020 2020 2020 2020 2020 2020  ee..            
+0000d680: 6173 7365 7274 2073 6f72 7465 6428 726f  assert sorted(ro
+0000d690: 6f74 7329 203d 3d20 736f 7274 6564 2874  ots) == sorted(t
+0000d6a0: 7265 652e 726f 6f74 7329 0a0a 2020 2020  ree.roots)..    
+0000d6b0: 2020 2020 5468 6520 726f 6f74 7320 6f66      The roots of
+0000d6c0: 2074 6865 2074 7265 6520 6172 6520 7265   the tree are re
+0000d6d0: 7475 726e 6564 2069 6e20 6120 6c69 7374  turned in a list
+0000d6e0: 2c20 696e 206e 6f20 7061 7274 6963 756c  , in no particul
+0000d6f0: 6172 206f 7264 6572 2e0a 0a20 2020 2020  ar order...     
+0000d700: 2020 204f 6e6c 7920 7265 7175 6972 6573     Only requires
+0000d710: 204f 286e 756d 6265 7220 6f66 2072 6f6f   O(number of roo
+0000d720: 7473 2920 7469 6d65 2e0a 0a20 2020 2020  ts) time...     
+0000d730: 2020 202e 2e20 6e6f 7465 3a3a 0a20 2020     .. note::.   
+0000d740: 2020 2020 2020 2020 2049 6e20 7472 6565           In tree
+0000d750: 7320 7769 7468 206c 6172 6765 2061 6d6f  s with large amo
+0000d760: 756e 7473 206f 6620 3a72 6566 3a60 7365  unts of :ref:`se
+0000d770: 635f 6461 7461 5f6d 6f64 656c 5f6d 6973  c_data_model_mis
+0000d780: 7369 6e67 5f64 6174 6160 2c0a 2020 2020  sing_data`,.    
+0000d790: 2020 2020 2020 2020 666f 7220 6578 616d          for exam
+0000d7a0: 706c 6520 7768 6572 6520 6120 7265 6769  ple where a regi
+0000d7b0: 6f6e 206f 6620 7468 6520 6765 6e6f 6d65  on of the genome
+0000d7c0: 206c 6163 6b73 2061 6e79 2061 6e63 6573   lacks any ances
+0000d7d0: 7472 616c 2069 6e66 6f72 6d61 7469 6f6e  tral information
+0000d7e0: 2c0a 2020 2020 2020 2020 2020 2020 7468  ,.            th
+0000d7f0: 6572 6520 6361 6e20 6265 2061 2076 6572  ere can be a ver
+0000d800: 7920 6c61 7267 6520 6e75 6d62 6572 206f  y large number o
+0000d810: 6620 726f 6f74 732c 2070 6f74 656e 7469  f roots, potenti
+0000d820: 616c 6c79 2061 6c6c 2074 6865 2073 616d  ally all the sam
+0000d830: 706c 6573 0a20 2020 2020 2020 2020 2020  ples.           
+0000d840: 2069 6e20 7468 6520 7472 6565 2073 6571   in the tree seq
+0000d850: 7565 6e63 652e 0a0a 2020 2020 2020 2020  uence...        
+0000d860: 3a72 6574 7572 6e3a 2054 6865 206c 6973  :return: The lis
+0000d870: 7420 6f66 2072 6f6f 7473 2069 6e20 7468  t of roots in th
+0000d880: 6973 2074 7265 652e 0a20 2020 2020 2020  is tree..       
+0000d890: 203a 7274 7970 653a 206c 6973 740a 2020   :rtype: list.  
+0000d8a0: 2020 2020 2020 2222 220a 2020 2020 2020        """.      
+0000d8b0: 2020 726f 6f74 7320 3d20 5b5d 0a20 2020    roots = [].   
+0000d8c0: 2020 2020 2075 203d 2073 656c 662e 6c65       u = self.le
+0000d8d0: 6674 5f72 6f6f 740a 2020 2020 2020 2020  ft_root.        
+0000d8e0: 7768 696c 6520 7520 213d 204e 554c 4c3a  while u != NULL:
+0000d8f0: 0a20 2020 2020 2020 2020 2020 2072 6f6f  .            roo
+0000d900: 7473 2e61 7070 656e 6428 7529 0a20 2020  ts.append(u).   
+0000d910: 2020 2020 2020 2020 2075 203d 2073 656c           u = sel
+0000d920: 662e 7269 6768 745f 7369 6228 7529 0a20  f.right_sib(u). 
+0000d930: 2020 2020 2020 2072 6574 7572 6e20 726f         return ro
+0000d940: 6f74 730a 0a20 2020 2064 6566 2067 6574  ots..    def get
+0000d950: 5f72 6f6f 7428 7365 6c66 293a 0a20 2020  _root(self):.   
+0000d960: 2020 2020 2023 2044 6570 7265 6361 7465       # Deprecate
+0000d970: 6420 616c 6961 7320 666f 7220 7365 6c66  d alias for self
+0000d980: 2e72 6f6f 740a 2020 2020 2020 2020 7265  .root.        re
+0000d990: 7475 726e 2073 656c 662e 726f 6f74 0a0a  turn self.root..
+0000d9a0: 2020 2020 4070 726f 7065 7274 790a 2020      @property.  
+0000d9b0: 2020 6465 6620 726f 6f74 2873 656c 6629    def root(self)
+0000d9c0: 3a0a 2020 2020 2020 2020 2222 220a 2020  :.        """.  
+0000d9d0: 2020 2020 2020 5468 6520 726f 6f74 206f        The root o
+0000d9e0: 6620 7468 6973 2074 7265 652e 2049 6620  f this tree. If 
+0000d9f0: 7468 6520 7472 6565 2063 6f6e 7461 696e  the tree contain
+0000da00: 7320 6d75 6c74 6970 6c65 2072 6f6f 7473  s multiple roots
+0000da10: 2c20 6120 5661 6c75 6545 7272 6f72 2069  , a ValueError i
+0000da20: 730a 2020 2020 2020 2020 7261 6973 6564  s.        raised
+0000da30: 2069 6e64 6963 6174 696e 6720 7468 6174   indicating that
+0000da40: 2074 6865 203a 6174 7472 3a60 7e54 7265   the :attr:`~Tre
+0000da50: 652e 726f 6f74 7360 2061 7474 7269 6275  e.roots` attribu
+0000da60: 7465 2073 686f 756c 6420 6265 2075 7365  te should be use
+0000da70: 6420 696e 7374 6561 642e 0a0a 2020 2020  d instead...    
+0000da80: 2020 2020 3a72 6574 7572 6e3a 2054 6865      :return: The
+0000da90: 2072 6f6f 7420 6e6f 6465 2e0a 2020 2020   root node..    
+0000daa0: 2020 2020 3a72 7479 7065 3a20 696e 740a      :rtype: int.
+0000dab0: 2020 2020 2020 2020 3a72 6169 7365 733a          :raises:
+0000dac0: 203a 636c 6173 733a 6056 616c 7565 4572   :class:`ValueEr
+0000dad0: 726f 7260 2069 6620 7468 6973 2074 7265  ror` if this tre
+0000dae0: 6520 636f 6e74 6169 6e73 206d 6f72 6520  e contains more 
+0000daf0: 7468 616e 206f 6e65 2072 6f6f 742e 0a20  than one root.. 
+0000db00: 2020 2020 2020 2022 2222 0a20 2020 2020         """.     
+0000db10: 2020 2069 6620 7365 6c66 2e68 6173 5f6d     if self.has_m
+0000db20: 756c 7469 706c 655f 726f 6f74 733a 0a20  ultiple_roots:. 
+0000db30: 2020 2020 2020 2020 2020 2072 6169 7365             raise
+0000db40: 2056 616c 7565 4572 726f 7228 224d 6f72   ValueError("Mor
+0000db50: 6520 7468 616e 206f 6e65 2072 6f6f 7420  e than one root 
+0000db60: 6578 6973 7473 2e20 5573 6520 7472 6565  exists. Use tree
+0000db70: 2e72 6f6f 7473 2069 6e73 7465 6164 2229  .roots instead")
+0000db80: 0a20 2020 2020 2020 2072 6574 7572 6e20  .        return 
+0000db90: 7365 6c66 2e6c 6566 745f 726f 6f74 0a0a  self.left_root..
+0000dba0: 2020 2020 6465 6620 6973 5f72 6f6f 7428      def is_root(
+0000dbb0: 7365 6c66 2c20 7529 202d 3e20 626f 6f6c  self, u) -> bool
+0000dbc0: 3a0a 2020 2020 2020 2020 2222 220a 2020  :.        """.  
+0000dbd0: 2020 2020 2020 5265 7475 726e 7320 6060        Returns ``
+0000dbe0: 5472 7565 6060 2069 6620 7468 6520 7370  True`` if the sp
+0000dbf0: 6563 6966 6965 6420 6e6f 6465 2069 7320  ecified node is 
+0000dc00: 6120 726f 6f74 2069 6e20 7468 6973 2074  a root in this t
+0000dc10: 7265 6520 2873 6565 0a20 2020 2020 2020  ree (see.       
+0000dc20: 203a 6174 7472 3a60 7e54 7265 652e 726f   :attr:`~Tree.ro
+0000dc30: 6f74 7360 2066 6f72 2074 6865 2064 6566  ots` for the def
+0000dc40: 696e 6974 696f 6e20 6f66 2061 2072 6f6f  inition of a roo
+0000dc50: 7429 2e20 5468 6973 2069 7320 6578 6163  t). This is exac
+0000dc60: 746c 7920 6571 7569 7661 6c65 6e74 2074  tly equivalent t
+0000dc70: 6f0a 2020 2020 2020 2020 6669 6e64 696e  o.        findin
+0000dc80: 6720 7468 6520 6e6f 6465 2049 4420 696e  g the node ID in
+0000dc90: 203a 6174 7472 3a60 7e54 7265 652e 726f   :attr:`~Tree.ro
+0000dca0: 6f74 7360 2c20 6275 7420 6973 206d 6f72  ots`, but is mor
+0000dcb0: 6520 6566 6669 6369 656e 7420 666f 7220  e efficient for 
+0000dcc0: 7472 6565 730a 2020 2020 2020 2020 7769  trees.        wi
+0000dcd0: 7468 206c 6172 6765 206e 756d 6265 7273  th large numbers
+0000dce0: 206f 6620 726f 6f74 732c 2073 7563 6820   of roots, such 
+0000dcf0: 6173 2069 6e20 7265 6769 6f6e 7320 7769  as in regions wi
+0000dd00: 7468 2065 7874 656e 7369 7665 0a20 2020  th extensive.   
+0000dd10: 2020 2020 203a 7265 663a 6073 6563 5f64       :ref:`sec_d
+0000dd20: 6174 615f 6d6f 6465 6c5f 6d69 7373 696e  ata_model_missin
+0000dd30: 675f 6461 7461 602e 2020 4e6f 7465 2074  g_data`.  Note t
+0000dd40: 6861 7420 6060 4661 6c73 6560 6020 6973  hat ``False`` is
+0000dd50: 2072 6574 7572 6e65 6420 666f 7220 616c   returned for al
+0000dd60: 6c0a 2020 2020 2020 2020 6f74 6865 7220  l.        other 
+0000dd70: 6e6f 6465 732c 2069 6e63 6c75 6469 6e67  nodes, including
+0000dd80: 203a 7265 663a 6069 736f 6c61 7465 643c   :ref:`isolated<
+0000dd90: 7365 635f 6461 7461 5f6d 6f64 656c 5f74  sec_data_model_t
+0000dda0: 7265 655f 6973 6f6c 6174 6564 5f6e 6f64  ree_isolated_nod
+0000ddb0: 6573 3e60 0a20 2020 2020 2020 206e 6f6e  es>`.        non
+0000ddc0: 2d73 616d 706c 6520 6e6f 6465 7320 7768  -sample nodes wh
+0000ddd0: 6963 6820 6172 6520 6e6f 7420 666f 756e  ich are not foun
+0000dde0: 6420 696e 2074 6865 2074 6f70 6f6c 6f67  d in the topolog
+0000ddf0: 7920 6f66 2074 6865 2063 7572 7265 6e74  y of the current
+0000de00: 2074 7265 652e 0a0a 2020 2020 2020 2020   tree...        
+0000de10: 3a70 6172 616d 2069 6e74 2075 3a20 5468  :param int u: Th
+0000de20: 6520 6e6f 6465 206f 6620 696e 7465 7265  e node of intere
+0000de30: 7374 2e0a 2020 2020 2020 2020 3a72 6574  st..        :ret
+0000de40: 7572 6e3a 2060 6054 7275 6560 6020 6966  urn: ``True`` if
+0000de50: 2075 2069 7320 6120 726f 6f74 2e0a 2020   u is a root..  
+0000de60: 2020 2020 2020 2222 220a 2020 2020 2020        """.      
+0000de70: 2020 7265 7475 726e 2028 0a20 2020 2020    return (.     
+0000de80: 2020 2020 2020 2073 656c 662e 6e75 6d5f         self.num_
+0000de90: 7361 6d70 6c65 7328 7529 203e 3d20 7365  samples(u) >= se
+0000dea0: 6c66 2e72 6f6f 745f 7468 7265 7368 6f6c  lf.root_threshol
+0000deb0: 6420 616e 6420 7365 6c66 2e70 6172 656e  d and self.paren
+0000dec0: 7428 7529 203d 3d20 7473 6b69 742e 4e55  t(u) == tskit.NU
+0000ded0: 4c4c 0a20 2020 2020 2020 2029 0a0a 2020  LL.        )..  
+0000dee0: 2020 6465 6620 6765 745f 696e 6465 7828    def get_index(
+0000def0: 7365 6c66 293a 0a20 2020 2020 2020 2023  self):.        #
+0000df00: 2044 6570 7265 6361 7465 6420 616c 6961   Deprecated alia
+0000df10: 7320 666f 7220 7365 6c66 2e69 6e64 6578  s for self.index
+0000df20: 0a20 2020 2020 2020 2072 6574 7572 6e20  .        return 
+0000df30: 7365 6c66 2e69 6e64 6578 0a0a 2020 2020  self.index..    
+0000df40: 4070 726f 7065 7274 790a 2020 2020 6465  @property.    de
+0000df50: 6620 696e 6465 7828 7365 6c66 293a 0a20  f index(self):. 
+0000df60: 2020 2020 2020 2022 2222 0a20 2020 2020         """.     
+0000df70: 2020 2052 6574 7572 6e73 2074 6865 2069     Returns the i
+0000df80: 6e64 6578 2074 6869 7320 7472 6565 206f  ndex this tree o
+0000df90: 6363 7570 6965 7320 696e 2074 6865 2070  ccupies in the p
+0000dfa0: 6172 656e 7420 7472 6565 2073 6571 7565  arent tree seque
+0000dfb0: 6e63 652e 0a20 2020 2020 2020 2054 6869  nce..        Thi
+0000dfc0: 7320 696e 6465 7820 6973 207a 6572 6f20  s index is zero 
+0000dfd0: 6261 7365 642c 2073 6f20 7468 6520 6669  based, so the fi
+0000dfe0: 7273 7420 7472 6565 2069 6e20 7468 6520  rst tree in the 
+0000dff0: 7365 7175 656e 6365 2068 6173 2069 6e64  sequence has ind
+0000e000: 6578 2030 2e0a 0a20 2020 2020 2020 203a  ex 0...        :
+0000e010: 7265 7475 726e 3a20 5468 6520 696e 6465  return: The inde
+0000e020: 7820 6f66 2074 6869 7320 7472 6565 2e0a  x of this tree..
+0000e030: 2020 2020 2020 2020 3a72 7479 7065 3a20          :rtype: 
+0000e040: 696e 740a 2020 2020 2020 2020 2222 220a  int.        """.
+0000e050: 2020 2020 2020 2020 7265 7475 726e 2073          return s
+0000e060: 656c 662e 5f6c 6c5f 7472 6565 2e67 6574  elf._ll_tree.get
+0000e070: 5f69 6e64 6578 2829 0a0a 2020 2020 6465  _index()..    de
+0000e080: 6620 6765 745f 696e 7465 7276 616c 2873  f get_interval(s
+0000e090: 656c 6629 3a0a 2020 2020 2020 2020 2320  elf):.        # 
+0000e0a0: 4465 7072 6563 6174 6564 2061 6c69 6173  Deprecated alias
+0000e0b0: 2066 6f72 2073 656c 662e 696e 7465 7276   for self.interv
+0000e0c0: 616c 0a20 2020 2020 2020 2072 6574 7572  al.        retur
+0000e0d0: 6e20 7365 6c66 2e69 6e74 6572 7661 6c0a  n self.interval.
+0000e0e0: 0a20 2020 2040 7072 6f70 6572 7479 0a20  .    @property. 
+0000e0f0: 2020 2064 6566 2069 6e74 6572 7661 6c28     def interval(
+0000e100: 7365 6c66 293a 0a20 2020 2020 2020 2022  self):.        "
+0000e110: 2222 0a20 2020 2020 2020 2052 6574 7572  "".        Retur
+0000e120: 6e73 2074 6865 2063 6f6f 7264 696e 6174  ns the coordinat
+0000e130: 6573 206f 6620 7468 6520 6765 6e6f 6d69  es of the genomi
+0000e140: 6320 696e 7465 7276 616c 2074 6861 7420  c interval that 
+0000e150: 7468 6973 2074 7265 650a 2020 2020 2020  this tree.      
+0000e160: 2020 7265 7072 6573 656e 7473 2074 6865    represents the
+0000e170: 2068 6973 746f 7279 206f 662e 2054 6865   history of. The
+0000e180: 2069 6e74 6572 7661 6c20 6973 2072 6574   interval is ret
+0000e190: 7572 6e65 6420 6173 2061 2074 7570 6c65  urned as a tuple
+0000e1a0: 0a20 2020 2020 2020 203a 6d61 7468 3a60  .        :math:`
+0000e1b0: 286c 2c20 7229 6020 616e 6420 6973 2061  (l, r)` and is a
+0000e1c0: 2068 616c 662d 6f70 656e 2069 6e74 6572   half-open inter
+0000e1d0: 7661 6c20 7375 6368 2074 6861 7420 7468  val such that th
+0000e1e0: 6520 6c65 6674 0a20 2020 2020 2020 2063  e left.        c
+0000e1f0: 6f6f 7264 696e 6174 6520 6973 2069 6e63  oordinate is inc
+0000e200: 6c75 7369 7665 2061 6e64 2074 6865 2072  lusive and the r
+0000e210: 6967 6874 2063 6f6f 7264 696e 6174 6520  ight coordinate 
+0000e220: 6973 2065 7863 6c75 7369 7665 2e20 5468  is exclusive. Th
+0000e230: 6973 0a20 2020 2020 2020 2074 7265 6520  is.        tree 
+0000e240: 7468 6572 6566 6f72 6520 6170 706c 6965  therefore applie
+0000e250: 7320 746f 2061 6c6c 2067 656e 6f6d 6963  s to all genomic
+0000e260: 206c 6f63 6174 696f 6e73 203a 6d61 7468   locations :math
+0000e270: 3a60 7860 2073 7563 6820 7468 6174 0a20  :`x` such that. 
+0000e280: 2020 2020 2020 203a 6d61 7468 3a60 6c20         :math:`l 
+0000e290: 5c5c 6c65 7120 7820 3c20 7260 2e0a 0a20  \\leq x < r`... 
+0000e2a0: 2020 2020 2020 203a 7265 7475 726e 3a20         :return: 
+0000e2b0: 4120 6e61 6d65 6420 7475 706c 6520 286c  A named tuple (l
+0000e2c0: 2c20 7229 2072 6570 7265 7365 6e74 696e  , r) representin
+0000e2d0: 6720 7468 6520 6c65 6674 2d6d 6f73 7420  g the left-most 
+0000e2e0: 2869 6e63 6c75 7369 7665 290a 2020 2020  (inclusive).    
+0000e2f0: 2020 2020 2020 2020 616e 6420 7269 6768          and righ
+0000e300: 742d 6d6f 7374 2028 6578 636c 7573 6976  t-most (exclusiv
+0000e310: 6529 2063 6f6f 7264 696e 6174 6573 206f  e) coordinates o
+0000e320: 6620 7468 6520 6765 6e6f 6d69 6320 7265  f the genomic re
+0000e330: 6769 6f6e 0a20 2020 2020 2020 2020 2020  gion.           
+0000e340: 2063 6f76 6572 6564 2062 7920 7468 6973   covered by this
+0000e350: 2074 7265 652e 2054 6865 2063 6f6f 7264   tree. The coord
+0000e360: 696e 6174 6573 2063 616e 2062 6520 6163  inates can be ac
+0000e370: 6365 7373 6564 2062 7920 696e 6465 780a  cessed by index.
+0000e380: 2020 2020 2020 2020 2020 2020 2860 6030              (``0
+0000e390: 6060 206f 7220 6060 3160 6029 206f 7220  `` or ``1``) or 
+0000e3a0: 6571 7569 7661 6c65 6e74 6c79 2062 7920  equivalently by 
+0000e3b0: 6e61 6d65 2028 6060 2e6c 6566 7460 6020  name (``.left`` 
+0000e3c0: 6f72 2060 602e 7269 6768 7460 6029 0a20  or ``.right``). 
+0000e3d0: 2020 2020 2020 203a 7274 7970 653a 2049         :rtype: I
+0000e3e0: 6e74 6572 7661 6c0a 2020 2020 2020 2020  nterval.        
+0000e3f0: 2222 220a 2020 2020 2020 2020 7265 7475  """.        retu
+0000e400: 726e 2049 6e74 6572 7661 6c28 7365 6c66  rn Interval(self
+0000e410: 2e5f 6c6c 5f74 7265 652e 6765 745f 6c65  ._ll_tree.get_le
+0000e420: 6674 2829 2c20 7365 6c66 2e5f 6c6c 5f74  ft(), self._ll_t
+0000e430: 7265 652e 6765 745f 7269 6768 7428 2929  ree.get_right())
+0000e440: 0a0a 2020 2020 6465 6620 6765 745f 6c65  ..    def get_le
+0000e450: 6e67 7468 2873 656c 6629 3a0a 2020 2020  ngth(self):.    
+0000e460: 2020 2020 2320 4465 7072 6563 6174 6564      # Deprecated
+0000e470: 2061 6c69 6173 2066 6f72 2073 656c 662e   alias for self.
+0000e480: 7370 616e 0a20 2020 2020 2020 2072 6574  span.        ret
+0000e490: 7572 6e20 7365 6c66 2e6c 656e 6774 680a  urn self.length.
+0000e4a0: 0a20 2020 2040 7072 6f70 6572 7479 0a20  .    @property. 
+0000e4b0: 2020 2064 6566 206c 656e 6774 6828 7365     def length(se
+0000e4c0: 6c66 293a 0a20 2020 2020 2020 2023 2044  lf):.        # D
+0000e4d0: 6570 7265 6361 7465 6420 616c 6961 7320  eprecated alias 
+0000e4e0: 666f 7220 7365 6c66 2e73 7061 6e0a 2020  for self.span.  
+0000e4f0: 2020 2020 2020 7265 7475 726e 2073 656c        return sel
+0000e500: 662e 7370 616e 0a0a 2020 2020 4070 726f  f.span..    @pro
+0000e510: 7065 7274 790a 2020 2020 6465 6620 7370  perty.    def sp
+0000e520: 616e 2873 656c 6629 3a0a 2020 2020 2020  an(self):.      
+0000e530: 2020 2222 220a 2020 2020 2020 2020 5265    """.        Re
+0000e540: 7475 726e 7320 7468 6520 6765 6e6f 6d69  turns the genomi
+0000e550: 6320 6469 7374 616e 6365 2074 6861 7420  c distance that 
+0000e560: 7468 6973 2074 7265 6520 7370 616e 732e  this tree spans.
+0000e570: 0a20 2020 2020 2020 2054 6869 7320 6973  .        This is
+0000e580: 2064 6566 696e 6564 2061 7320 3a6d 6174   defined as :mat
+0000e590: 683a 6072 202d 206c 602c 2077 6865 7265  h:`r - l`, where
+0000e5a0: 203a 6d61 7468 3a60 286c 2c20 7229 6020   :math:`(l, r)` 
+0000e5b0: 6973 2074 6865 2067 656e 6f6d 6963 0a20  is the genomic. 
+0000e5c0: 2020 2020 2020 2069 6e74 6572 7661 6c20         interval 
+0000e5d0: 7265 7475 726e 6564 2062 7920 3a61 7474  returned by :att
+0000e5e0: 723a 607e 5472 6565 2e69 6e74 6572 7661  r:`~Tree.interva
+0000e5f0: 6c60 2e0a 0a20 2020 2020 2020 203a 7265  l`...        :re
+0000e600: 7475 726e 3a20 5468 6520 6765 6e6f 6d69  turn: The genomi
+0000e610: 6320 6469 7374 616e 6365 2063 6f76 6572  c distance cover
+0000e620: 6564 2062 7920 7468 6973 2074 7265 652e  ed by this tree.
+0000e630: 0a20 2020 2020 2020 203a 7274 7970 653a  .        :rtype:
+0000e640: 2066 6c6f 6174 0a20 2020 2020 2020 2022   float.        "
+0000e650: 2222 0a20 2020 2020 2020 2072 6574 7572  "".        retur
+0000e660: 6e20 7365 6c66 2e69 6e74 6572 7661 6c2e  n self.interval.
+0000e670: 7370 616e 0a0a 2020 2020 6465 6620 6765  span..    def ge
+0000e680: 745f 7361 6d70 6c65 5f73 697a 6528 7365  t_sample_size(se
+0000e690: 6c66 293a 0a20 2020 2020 2020 2023 2044  lf):.        # D
+0000e6a0: 6570 7265 6361 7465 6420 616c 6961 7320  eprecated alias 
+0000e6b0: 666f 7220 7365 6c66 2e73 616d 706c 655f  for self.sample_
+0000e6c0: 7369 7a65 0a20 2020 2020 2020 2072 6574  size.        ret
+0000e6d0: 7572 6e20 7365 6c66 2e73 616d 706c 655f  urn self.sample_
+0000e6e0: 7369 7a65 0a0a 2020 2020 4070 726f 7065  size..    @prope
+0000e6f0: 7274 790a 2020 2020 6465 6620 7361 6d70  rty.    def samp
+0000e700: 6c65 5f73 697a 6528 7365 6c66 293a 0a20  le_size(self):. 
+0000e710: 2020 2020 2020 2023 2044 656c 6962 6572         # Deliber
+0000e720: 6174 656c 7920 756e 646f 6375 6d65 6e74  ately undocument
+0000e730: 6564 2062 7574 206b 6570 7420 666f 7220  ed but kept for 
+0000e740: 6261 636b 7761 7264 7320 636f 6d70 6174  backwards compat
+0000e750: 6962 696c 6974 792e 0a20 2020 2020 2020  ibility..       
+0000e760: 2023 2054 6865 2070 726f 7065 7220 7761   # The proper wa
+0000e770: 7920 746f 2061 6363 6573 7320 7468 6973  y to access this
+0000e780: 2069 7320 7669 6120 7472 6565 2e74 7265   is via tree.tre
+0000e790: 655f 7365 7175 656e 6365 2e6e 756d 5f73  e_sequence.num_s
+0000e7a0: 616d 706c 6573 0a20 2020 2020 2020 2072  amples.        r
+0000e7b0: 6574 7572 6e20 7365 6c66 2e5f 6c6c 5f74  eturn self._ll_t
+0000e7c0: 7265 652e 6765 745f 7361 6d70 6c65 5f73  ree.get_sample_s
+0000e7d0: 697a 6528 290a 0a20 2020 2064 6566 2064  ize()..    def d
+0000e7e0: 7261 775f 7465 7874 280a 2020 2020 2020  raw_text(.      
+0000e7f0: 2020 7365 6c66 2c0a 2020 2020 2020 2020    self,.        
+0000e800: 6f72 6965 6e74 6174 696f 6e3d 4e6f 6e65  orientation=None
+0000e810: 2c0a 2020 2020 2020 2020 2a2c 0a20 2020  ,.        *,.   
+0000e820: 2020 2020 206e 6f64 655f 6c61 6265 6c73       node_labels
+0000e830: 3d4e 6f6e 652c 0a20 2020 2020 2020 206d  =None,.        m
+0000e840: 6178 5f74 696d 653d 4e6f 6e65 2c0a 2020  ax_time=None,.  
+0000e850: 2020 2020 2020 7573 655f 6173 6369 693d        use_ascii=
+0000e860: 4661 6c73 652c 0a20 2020 2020 2020 206f  False,.        o
+0000e870: 7264 6572 3d4e 6f6e 652c 0a20 2020 2029  rder=None,.    )
+0000e880: 3a0a 2020 2020 2020 2020 2222 220a 2020  :.        """.  
+0000e890: 2020 2020 2020 4372 6561 7465 2061 2074        Create a t
+0000e8a0: 6578 7420 7265 7072 6573 656e 7461 7469  ext representati
+0000e8b0: 6f6e 206f 6620 6120 7472 6565 2e0a 0a20  on of a tree... 
+0000e8c0: 2020 2020 2020 203a 7061 7261 6d20 7374         :param st
+0000e8d0: 7220 6f72 6965 6e74 6174 696f 6e3a 206f  r orientation: o
+0000e8e0: 6e65 206f 6620 6060 2274 6f70 2260 602c  ne of ``"top"``,
+0000e8f0: 2060 6022 6c65 6674 2260 602c 2060 6022   ``"left"``, ``"
+0000e900: 626f 7474 6f6d 2260 602c 206f 720a 2020  bottom"``, or.  
+0000e910: 2020 2020 2020 2020 2020 6060 2272 6967            ``"rig
+0000e920: 6874 2260 602c 2073 7065 6369 6679 696e  ht"``, specifyin
+0000e930: 6720 7468 6520 6d61 7267 696e 206f 6e20  g the margin on 
+0000e940: 7768 6963 6820 7468 6520 726f 6f74 2069  which the root i
+0000e950: 7320 706c 6163 6564 2e20 5370 6563 6966  s placed. Specif
+0000e960: 7969 6e67 0a20 2020 2020 2020 2020 2020  ying.           
+0000e970: 2060 6022 6c65 6674 2260 6020 6f72 2060   ``"left"`` or `
+0000e980: 6022 7269 6768 7422 6060 2077 696c 6c20  `"right"`` will 
+0000e990: 6c65 6164 2074 6f20 7469 6d65 2062 6569  lead to time bei
+0000e9a0: 6e67 2073 686f 776e 206f 6e20 7468 6520  ng shown on the 
+0000e9b0: 7820 6178 6973 2028 692e 652e 0a20 2020  x axis (i.e..   
+0000e9c0: 2020 2020 2020 2020 2061 2022 686f 7269           a "hori
+0000e9d0: 7a6f 6e74 616c 2220 7472 6565 2e20 4966  zontal" tree. If
+0000e9e0: 2060 604e 6f6e 6560 6020 2864 6566 6175   ``None`` (defau
+0000e9f0: 6c74 2920 7573 6520 7468 6520 7374 616e  lt) use the stan
+0000ea00: 6461 7264 2063 6f61 6c65 7363 656e 740a  dard coalescent.
+0000ea10: 2020 2020 2020 2020 2020 2020 6172 7261              arra
+0000ea20: 6e67 656d 656e 7420 6f66 2061 2076 6572  ngement of a ver
+0000ea30: 7469 6361 6c20 7472 6565 2077 6974 6820  tical tree with 
+0000ea40: 7265 6365 6e74 206e 6f64 6573 2061 7420  recent nodes at 
+0000ea50: 7468 6520 626f 7474 6f6d 206f 6620 7468  the bottom of th
+0000ea60: 6520 706c 6f74 0a20 2020 2020 2020 2020  e plot.         
+0000ea70: 2020 2061 6e64 206f 6c64 6572 206e 6f64     and older nod
+0000ea80: 6573 2061 626f 7665 2e0a 2020 2020 2020  es above..      
+0000ea90: 2020 3a70 6172 616d 2064 6963 7420 6e6f    :param dict no
+0000eaa0: 6465 5f6c 6162 656c 733a 2049 6620 7370  de_labels: If sp
+0000eab0: 6563 6966 6965 642c 2073 686f 7720 6375  ecified, show cu
+0000eac0: 7374 6f6d 206c 6162 656c 7320 666f 7220  stom labels for 
+0000ead0: 7468 6520 6e6f 6465 730a 2020 2020 2020  the nodes.      
+0000eae0: 2020 2020 2020 7468 6174 2061 7265 2070        that are p
+0000eaf0: 7265 7365 6e74 2069 6e20 7468 6520 6d61  resent in the ma
+0000eb00: 702e 2041 6e79 206e 6f64 6573 206e 6f74  p. Any nodes not
+0000eb10: 2073 7065 6369 6669 6564 2069 6e20 7468   specified in th
+0000eb20: 6520 6d61 7020 7769 6c6c 0a20 2020 2020  e map will.     
+0000eb30: 2020 2020 2020 206e 6f74 2068 6176 6520         not have 
+0000eb40: 6120 6e6f 6465 206c 6162 656c 2e0a 2020  a node label..  
+0000eb50: 2020 2020 2020 3a70 6172 616d 2073 7472        :param str
+0000eb60: 206d 6178 5f74 696d 653a 2049 6620 6571   max_time: If eq
+0000eb70: 7561 6c20 746f 2060 6022 7472 6565 2260  ual to ``"tree"`
+0000eb80: 6020 2874 6865 2064 6566 6175 6c74 292c  ` (the default),
+0000eb90: 2074 6865 206d 6178 696d 756d 2074 696d   the maximum tim
+0000eba0: 650a 2020 2020 2020 2020 2020 2020 6973  e.            is
+0000ebb0: 2073 6574 2074 6f20 6265 2074 6861 7420   set to be that 
+0000ebc0: 6f66 2074 6865 206f 6c64 6573 7420 726f  of the oldest ro
+0000ebd0: 6f74 2069 6e20 7468 6520 7472 6565 2e20  ot in the tree. 
+0000ebe0: 4966 2065 7175 616c 2074 6f20 6060 2274  If equal to ``"t
+0000ebf0: 7322 6060 2074 6865 0a20 2020 2020 2020  s"`` the.       
+0000ec00: 2020 2020 206d 6178 696d 756d 2074 696d       maximum tim
+0000ec10: 6520 6973 2073 6574 2074 6f20 6265 2074  e is set to be t
+0000ec20: 6865 2074 696d 6520 6f66 2074 6865 206f  he time of the o
+0000ec30: 6c64 6573 7420 726f 6f74 2069 6e20 7468  ldest root in th
+0000ec40: 6520 7472 6565 0a20 2020 2020 2020 2020  e tree.         
+0000ec50: 2020 2073 6571 7565 6e63 653b 2074 6869     sequence; thi
+0000ec60: 7320 6973 2075 7365 6675 6c20 7768 656e  s is useful when
+0000ec70: 2064 7261 7769 6e67 2074 7265 6573 2066   drawing trees f
+0000ec80: 726f 6d20 7468 6520 7361 6d65 2074 7265  rom the same tre
+0000ec90: 6520 7365 7175 656e 6365 2061 7320 6974  e sequence as it
+0000eca0: 0a20 2020 2020 2020 2020 2020 2065 6e73  .            ens
+0000ecb0: 7572 6573 2074 6861 7420 6e6f 6465 2068  ures that node h
+0000ecc0: 6569 6768 7473 2061 7265 2063 6f6e 7369  eights are consi
+0000ecd0: 7374 656e 742e 0a20 2020 2020 2020 203a  stent..        :
+0000ece0: 7061 7261 6d20 626f 6f6c 2075 7365 5f61  param bool use_a
+0000ecf0: 7363 6969 3a20 4966 2060 6046 616c 7365  scii: If ``False
+0000ed00: 6060 2028 6465 6661 756c 7429 2074 6865  `` (default) the
+0000ed10: 6e20 7573 6520 756e 6963 6f64 650a 2020  n use unicode.  
+0000ed20: 2020 2020 2020 2020 2020 6062 6f78 2064            `box d
+0000ed30: 7261 7769 6e67 2063 6861 7261 6374 6572  rawing character
+0000ed40: 7320 5c0a 3c68 7474 7073 3a2f 2f65 6e2e  s \.<https://en.
+0000ed50: 7769 6b69 7065 6469 612e 6f72 672f 7769  wikipedia.org/wi
+0000ed60: 6b69 2f42 6f78 2d64 7261 7769 6e67 5f63  ki/Box-drawing_c
+0000ed70: 6861 7261 6374 6572 3e60 5f0a 2020 2020  haracter>`_.    
+0000ed80: 2020 2020 2020 2020 746f 2072 656e 6465          to rende
+0000ed90: 7220 7468 6520 7472 6565 2e20 4966 2060  r the tree. If `
+0000eda0: 6054 7275 6560 602c 2075 7365 2070 6c61  `True``, use pla
+0000edb0: 696e 2061 7363 6969 2063 6861 7261 6374  in ascii charact
+0000edc0: 6572 732c 2077 6869 6368 206c 6f6f 6b0a  ers, which look.
+0000edd0: 2020 2020 2020 2020 2020 2020 6372 7564              crud
+0000ede0: 6572 2062 7574 2061 7265 206c 6573 7320  er but are less 
+0000edf0: 7375 7363 6570 7469 626c 6520 746f 206d  susceptible to m
+0000ee00: 6973 616c 6967 6e6d 656e 7420 6f72 2066  isalignment or f
+0000ee10: 6f6e 7420 7375 6273 7469 7475 7469 6f6e  ont substitution
+0000ee20: 2e0a 2020 2020 2020 2020 2020 2020 416c  ..            Al
+0000ee30: 7465 726e 6174 6976 656c 792c 2069 6620  ternatively, if 
+0000ee40: 796f 7520 6172 6520 6861 7669 6e67 2061  you are having a
+0000ee50: 6c69 676e 6d65 6e74 2070 726f 626c 656d  lignment problem
+0000ee60: 7320 7769 7468 2055 6e69 636f 6465 2c20  s with Unicode, 
+0000ee70: 796f 7520 6361 6e20 7472 790a 2020 2020  you can try.    
+0000ee80: 2020 2020 2020 2020 6f75 7420 7468 6520          out the 
+0000ee90: 736f 6c75 7469 6f6e 2064 6f63 756d 656e  solution documen
+0000eea0: 7465 6420 6068 6572 6520 5c0a 3c68 7474  ted `here \.<htt
+0000eeb0: 7073 3a2f 2f67 6974 6875 622e 636f 6d2f  ps://github.com/
+0000eec0: 7473 6b69 742d 6465 762f 7473 6b69 742f  tskit-dev/tskit/
+0000eed0: 6973 7375 6573 2f31 3839 2369 7373 7565  issues/189#issue
+0000eee0: 636f 6d6d 656e 742d 3439 3931 3134 3831  comment-49911481
+0000eef0: 313e 605f 2e0a 2020 2020 2020 2020 3a70  1>`_..        :p
+0000ef00: 6172 616d 2073 7472 206f 7264 6572 3a20  aram str order: 
+0000ef10: 5468 6520 6c65 6674 2d74 6f2d 7269 6768  The left-to-righ
+0000ef20: 7420 6f72 6465 7269 6e67 206f 6620 6368  t ordering of ch
+0000ef30: 696c 6420 6e6f 6465 7320 696e 2074 6865  ild nodes in the
+0000ef40: 2064 7261 776e 2074 7265 652e 0a20 2020   drawn tree..   
+0000ef50: 2020 2020 2020 2020 2054 6869 7320 6361           This ca
+0000ef60: 6e20 6265 2065 6974 6865 723a 2060 6022  n be either: ``"
+0000ef70: 6d69 6e6c 6578 2260 602c 2077 6869 6368  minlex"``, which
+0000ef80: 206d 696e 696d 6973 6573 2074 6865 2064   minimises the d
+0000ef90: 6966 6665 7265 6e63 6573 0a20 2020 2020  ifferences.     
+0000efa0: 2020 2020 2020 2062 6574 7765 656e 2061         between a
+0000efb0: 646a 6163 656e 7420 7472 6565 7320 2873  djacent trees (s
+0000efc0: 6565 2061 6c73 6f20 7468 6520 6060 226d  ee also the ``"m
+0000efd0: 696e 6c65 785f 706f 7374 6f72 6465 7222  inlex_postorder"
+0000efe0: 6060 2074 7261 7665 7273 616c 0a20 2020  `` traversal.   
+0000eff0: 2020 2020 2020 2020 206f 7264 6572 2066           order f
+0000f000: 6f72 2074 6865 203a 6d65 7468 3a60 2e6e  or the :meth:`.n
+0000f010: 6f64 6573 6020 6d65 7468 6f64 293b 206f  odes` method); o
+0000f020: 7220 6060 2274 7265 6522 6060 2077 6869  r ``"tree"`` whi
+0000f030: 6368 2064 7261 7773 2074 7265 6573 0a20  ch draws trees. 
+0000f040: 2020 2020 2020 2020 2020 2069 6e20 7468             in th
+0000f050: 6520 6c65 6674 2d74 6f2d 7269 6768 7420  e left-to-right 
+0000f060: 6f72 6465 7220 6465 6669 6e65 6420 6279  order defined by
+0000f070: 2074 6865 0a20 2020 2020 2020 2020 2020   the.           
+0000f080: 203a 7265 663a 6071 7569 6e74 7570 6c79   :ref:`quintuply
+0000f090: 206c 696e 6b65 6420 7472 6565 2073 7472   linked tree str
+0000f0a0: 7563 7475 7265 203c 7365 635f 6461 7461  ucture <sec_data
+0000f0b0: 5f6d 6f64 656c 5f74 7265 655f 7374 7275  _model_tree_stru
+0000f0c0: 6374 7572 653e 602e 0a20 2020 2020 2020  cture>`..       
+0000f0d0: 2020 2020 2049 6620 6e6f 7420 7370 6563       If not spec
+0000f0e0: 6966 6965 6420 6f72 204e 6f6e 652c 2074  ified or None, t
+0000f0f0: 6869 7320 6465 6661 756c 7473 2074 6f20  his defaults to 
+0000f100: 6060 226d 696e 6c65 7822 6060 2e0a 0a20  ``"minlex"``... 
+0000f110: 2020 2020 2020 203a 7265 7475 726e 3a20         :return: 
+0000f120: 4120 7465 7874 2072 6570 7265 7365 6e74  A text represent
+0000f130: 6174 696f 6e20 6f66 2061 2074 7265 652e  ation of a tree.
+0000f140: 0a20 2020 2020 2020 203a 7274 7970 653a  .        :rtype:
+0000f150: 2073 7472 0a20 2020 2020 2020 2022 2222   str.        """
+0000f160: 0a20 2020 2020 2020 206f 7269 656e 7461  .        orienta
+0000f170: 7469 6f6e 203d 2064 7261 7769 6e67 2e63  tion = drawing.c
+0000f180: 6865 636b 5f6f 7269 656e 7461 7469 6f6e  heck_orientation
+0000f190: 286f 7269 656e 7461 7469 6f6e 290a 2020  (orientation).  
+0000f1a0: 2020 2020 2020 6966 206f 7269 656e 7461        if orienta
+0000f1b0: 7469 6f6e 2069 6e20 2864 7261 7769 6e67  tion in (drawing
+0000f1c0: 2e4c 4546 542c 2064 7261 7769 6e67 2e52  .LEFT, drawing.R
+0000f1d0: 4947 4854 293a 0a20 2020 2020 2020 2020  IGHT):.         
+0000f1e0: 2020 2074 6578 745f 7472 6565 203d 2064     text_tree = d
+0000f1f0: 7261 7769 6e67 2e48 6f72 697a 6f6e 7461  rawing.Horizonta
+0000f200: 6c54 6578 7454 7265 6528 0a20 2020 2020  lTextTree(.     
+0000f210: 2020 2020 2020 2020 2020 2073 656c 662c             self,
+0000f220: 0a20 2020 2020 2020 2020 2020 2020 2020  .               
+0000f230: 206f 7269 656e 7461 7469 6f6e 3d6f 7269   orientation=ori
+0000f240: 656e 7461 7469 6f6e 2c0a 2020 2020 2020  entation,.      
+0000f250: 2020 2020 2020 2020 2020 6e6f 6465 5f6c            node_l
+0000f260: 6162 656c 733d 6e6f 6465 5f6c 6162 656c  abels=node_label
+0000f270: 732c 0a20 2020 2020 2020 2020 2020 2020  s,.             
+0000f280: 2020 206d 6178 5f74 696d 653d 6d61 785f     max_time=max_
+0000f290: 7469 6d65 2c0a 2020 2020 2020 2020 2020  time,.          
+0000f2a0: 2020 2020 2020 7573 655f 6173 6369 693d        use_ascii=
+0000f2b0: 7573 655f 6173 6369 692c 0a20 2020 2020  use_ascii,.     
+0000f2c0: 2020 2020 2020 2020 2020 206f 7264 6572             order
+0000f2d0: 3d6f 7264 6572 2c0a 2020 2020 2020 2020  =order,.        
+0000f2e0: 2020 2020 290a 2020 2020 2020 2020 656c      ).        el
+0000f2f0: 7365 3a0a 2020 2020 2020 2020 2020 2020  se:.            
+0000f300: 7465 7874 5f74 7265 6520 3d20 6472 6177  text_tree = draw
+0000f310: 696e 672e 5665 7274 6963 616c 5465 7874  ing.VerticalText
+0000f320: 5472 6565 280a 2020 2020 2020 2020 2020  Tree(.          
+0000f330: 2020 2020 2020 7365 6c66 2c0a 2020 2020        self,.    
+0000f340: 2020 2020 2020 2020 2020 2020 6f72 6965              orie
+0000f350: 6e74 6174 696f 6e3d 6f72 6965 6e74 6174  ntation=orientat
+0000f360: 696f 6e2c 0a20 2020 2020 2020 2020 2020  ion,.           
+0000f370: 2020 2020 206e 6f64 655f 6c61 6265 6c73       node_labels
+0000f380: 3d6e 6f64 655f 6c61 6265 6c73 2c0a 2020  =node_labels,.  
+0000f390: 2020 2020 2020 2020 2020 2020 2020 6d61                ma
+0000f3a0: 785f 7469 6d65 3d6d 6178 5f74 696d 652c  x_time=max_time,
+0000f3b0: 0a20 2020 2020 2020 2020 2020 2020 2020  .               
+0000f3c0: 2075 7365 5f61 7363 6969 3d75 7365 5f61   use_ascii=use_a
+0000f3d0: 7363 6969 2c0a 2020 2020 2020 2020 2020  scii,.          
+0000f3e0: 2020 2020 2020 6f72 6465 723d 6f72 6465        order=orde
+0000f3f0: 722c 0a20 2020 2020 2020 2020 2020 2029  r,.            )
+0000f400: 0a20 2020 2020 2020 2072 6574 7572 6e20  .        return 
+0000f410: 7374 7228 7465 7874 5f74 7265 6529 0a0a  str(text_tree)..
+0000f420: 2020 2020 6465 6620 6472 6177 5f73 7667      def draw_svg
+0000f430: 280a 2020 2020 2020 2020 7365 6c66 2c0a  (.        self,.
+0000f440: 2020 2020 2020 2020 7061 7468 3d4e 6f6e          path=Non
+0000f450: 652c 0a20 2020 2020 2020 202a 2c0a 2020  e,.        *,.  
+0000f460: 2020 2020 2020 7369 7a65 3d4e 6f6e 652c        size=None,
+0000f470: 0a20 2020 2020 2020 2074 696d 655f 7363  .        time_sc
+0000f480: 616c 653d 4e6f 6e65 2c0a 2020 2020 2020  ale=None,.      
+0000f490: 2020 7472 6565 5f68 6569 6768 745f 7363    tree_height_sc
+0000f4a0: 616c 653d 4e6f 6e65 2c0a 2020 2020 2020  ale=None,.      
+0000f4b0: 2020 6d61 785f 7469 6d65 3d4e 6f6e 652c    max_time=None,
+0000f4c0: 0a20 2020 2020 2020 206d 696e 5f74 696d  .        min_tim
+0000f4d0: 653d 4e6f 6e65 2c0a 2020 2020 2020 2020  e=None,.        
+0000f4e0: 6d61 785f 7472 6565 5f68 6569 6768 743d  max_tree_height=
+0000f4f0: 4e6f 6e65 2c0a 2020 2020 2020 2020 6e6f  None,.        no
+0000f500: 6465 5f6c 6162 656c 733d 4e6f 6e65 2c0a  de_labels=None,.
+0000f510: 2020 2020 2020 2020 6d75 7461 7469 6f6e          mutation
+0000f520: 5f6c 6162 656c 733d 4e6f 6e65 2c0a 2020  _labels=None,.  
+0000f530: 2020 2020 2020 726f 6f74 5f73 7667 5f61        root_svg_a
+0000f540: 7474 7269 6275 7465 733d 4e6f 6e65 2c0a  ttributes=None,.
+0000f550: 2020 2020 2020 2020 7374 796c 653d 4e6f          style=No
+0000f560: 6e65 2c0a 2020 2020 2020 2020 6f72 6465  ne,.        orde
+0000f570: 723d 4e6f 6e65 2c0a 2020 2020 2020 2020  r=None,.        
+0000f580: 666f 7263 655f 726f 6f74 5f62 7261 6e63  force_root_branc
+0000f590: 683d 4e6f 6e65 2c0a 2020 2020 2020 2020  h=None,.        
+0000f5a0: 7379 6d62 6f6c 5f73 697a 653d 4e6f 6e65  symbol_size=None
+0000f5b0: 2c0a 2020 2020 2020 2020 785f 6178 6973  ,.        x_axis
+0000f5c0: 3d4e 6f6e 652c 0a20 2020 2020 2020 2078  =None,.        x
+0000f5d0: 5f6c 6162 656c 3d4e 6f6e 652c 0a20 2020  _label=None,.   
+0000f5e0: 2020 2020 2079 5f61 7869 733d 4e6f 6e65       y_axis=None
+0000f5f0: 2c0a 2020 2020 2020 2020 795f 6c61 6265  ,.        y_labe
+0000f600: 6c3d 4e6f 6e65 2c0a 2020 2020 2020 2020  l=None,.        
+0000f610: 795f 7469 636b 733d 4e6f 6e65 2c0a 2020  y_ticks=None,.  
+0000f620: 2020 2020 2020 795f 6772 6964 6c69 6e65        y_gridline
+0000f630: 733d 4e6f 6e65 2c0a 2020 2020 2020 2020  s=None,.        
+0000f640: 616c 6c5f 6564 6765 5f6d 7574 6174 696f  all_edge_mutatio
+0000f650: 6e73 3d4e 6f6e 652c 0a20 2020 2020 2020  ns=None,.       
+0000f660: 206f 6d69 745f 7369 7465 733d 4e6f 6e65   omit_sites=None
+0000f670: 2c0a 2020 2020 2020 2020 6361 6e76 6173  ,.        canvas
+0000f680: 5f73 697a 653d 4e6f 6e65 2c0a 2020 2020  _size=None,.    
+0000f690: 2020 2020 2a2a 6b77 6172 6773 2c0a 2020      **kwargs,.  
+0000f6a0: 2020 293a 0a20 2020 2020 2020 2022 2222    ):.        """
+0000f6b0: 0a20 2020 2020 2020 2052 6574 7572 6e20  .        Return 
+0000f6c0: 616e 2053 5647 2072 6570 7265 7365 6e74  an SVG represent
+0000f6d0: 6174 696f 6e20 6f66 2061 2073 696e 676c  ation of a singl
+0000f6e0: 6520 7472 6565 2e20 4279 2064 6566 6175  e tree. By defau
+0000f6f0: 6c74 2c20 6e75 6d65 7269 630a 2020 2020  lt, numeric.    
+0000f700: 2020 2020 6c61 6265 6c73 2061 7265 2064      labels are d
+0000f710: 7261 776e 2062 6573 6964 6520 6e6f 6465  rawn beside node
+0000f720: 7320 616e 6420 6d75 7461 7469 6f6e 733a  s and mutations:
+0000f730: 2074 6865 7365 2063 616e 2062 6520 616c   these can be al
+0000f740: 7465 7265 6420 7573 696e 6720 7468 650a  tered using the.
+0000f750: 2020 2020 2020 2020 6060 6e6f 6465 5f6c          ``node_l
+0000f760: 6162 656c 7360 6020 616e 6420 6060 6d75  abels`` and ``mu
+0000f770: 7461 7469 6f6e 5f6c 6162 656c 7360 6020  tation_labels`` 
+0000f780: 7061 7261 6d65 7465 7273 2e20 5365 6520  parameters. See 
+0000f790: 7468 650a 2020 2020 2020 2020 3a72 6566  the.        :ref
+0000f7a0: 3a60 7669 7375 616c 697a 6174 696f 6e20  :`visualization 
+0000f7b0: 7475 746f 7269 616c 3c74 7574 6f72 6961  tutorial<tutoria
+0000f7c0: 6c73 3a73 6563 5f74 736b 6974 5f76 697a  ls:sec_tskit_viz
+0000f7d0: 3e60 2066 6f72 206d 6f72 6520 6465 7461  >` for more deta
+0000f7e0: 696c 732e 0a0a 2020 2020 2020 2020 3a70  ils...        :p
+0000f7f0: 6172 616d 2073 7472 2070 6174 683a 2054  aram str path: T
+0000f800: 6865 2070 6174 6820 746f 2074 6865 2066  he path to the f
+0000f810: 696c 6520 746f 2077 7269 7465 2074 6865  ile to write the
+0000f820: 206f 7574 7075 742e 2049 6620 4e6f 6e65   output. If None
+0000f830: 2c20 646f 206e 6f74 0a20 2020 2020 2020  , do not.       
+0000f840: 2020 2020 2077 7269 7465 2074 6f20 6669       write to fi
+0000f850: 6c65 2e0a 2020 2020 2020 2020 3a70 6172  le..        :par
+0000f860: 616d 2074 7570 6c65 2869 6e74 2c20 696e  am tuple(int, in
+0000f870: 7429 2073 697a 653a 2041 2074 7570 6c65  t) size: A tuple
+0000f880: 206f 6620 2877 6964 7468 2c20 6865 6967   of (width, heig
+0000f890: 6874 2920 7370 6563 6966 7969 6e67 2061  ht) specifying a
+0000f8a0: 2074 6172 6765 740a 2020 2020 2020 2020   target.        
+0000f8b0: 2020 2020 6472 6177 696e 6720 7369 7a65      drawing size
+0000f8c0: 2069 6e20 6162 7374 7261 6374 2075 7365   in abstract use
+0000f8d0: 7220 756e 6974 7320 2875 7375 616c 6c79  r units (usually
+0000f8e0: 2069 6e74 6572 7072 6574 6564 2061 7320   interpreted as 
+0000f8f0: 7069 7865 6c73 206f 6e0a 2020 2020 2020  pixels on.      
+0000f900: 2020 2020 2020 696e 6974 6961 6c20 6469        initial di
+0000f910: 7370 6c61 7929 2e20 436f 6d70 6f6e 656e  splay). Componen
+0000f920: 7473 206f 6620 7468 6520 6472 6177 696e  ts of the drawin
+0000f930: 6720 7769 6c6c 2062 6520 7363 616c 6564  g will be scaled
+0000f940: 2073 6f20 7468 6174 2074 6865 2074 6f74   so that the tot
+0000f950: 616c 0a20 2020 2020 2020 2020 2020 2070  al.            p
+0000f960: 6c6f 7420 696e 636c 7564 696e 6720 6c61  lot including la
+0000f970: 6265 6c73 2065 7463 2e20 6e6f 726d 616c  bels etc. normal
+0000f980: 6c79 2066 6974 7320 6f6e 746f 2061 2063  ly fits onto a c
+0000f990: 616e 7661 7320 6f66 2074 6869 7320 7369  anvas of this si
+0000f9a0: 7a65 2028 7365 650a 2020 2020 2020 2020  ze (see.        
+0000f9b0: 2020 2020 6060 6361 6e76 6173 5f73 697a      ``canvas_siz
+0000f9c0: 6560 6020 6265 6c6f 7729 2e20 4966 2060  e`` below). If `
+0000f9d0: 604e 6f6e 6560 602c 2070 6963 6b20 6120  `None``, pick a 
+0000f9e0: 7369 7a65 2061 7070 726f 7072 6961 7465  size appropriate
+0000f9f0: 2066 6f72 2061 2074 7265 650a 2020 2020   for a tree.    
+0000fa00: 2020 2020 2020 2020 7769 7468 2061 2072          with a r
+0000fa10: 6561 736f 6e61 626c 7920 736d 616c 6c20  easonably small 
+0000fa20: 6e75 6d62 6572 2028 692e 652e 2074 656e  number (i.e. ten
+0000fa30: 7329 206f 6620 7361 6d70 6c65 732e 2044  s) of samples. D
+0000fa40: 6566 6175 6c74 3a20 6060 4e6f 6e65 6060  efault: ``None``
+0000fa50: 0a20 2020 2020 2020 203a 7479 7065 2073  .        :type s
+0000fa60: 697a 653a 0a20 2020 2020 2020 203a 7061  ize:.        :pa
+0000fa70: 7261 6d20 7374 7220 7469 6d65 5f73 6361  ram str time_sca
+0000fa80: 6c65 3a20 436f 6e74 726f 6c20 686f 7720  le: Control how 
+0000fa90: 6865 6967 6874 2076 616c 7565 7320 666f  height values fo
+0000faa0: 7220 6e6f 6465 7320 6172 6520 636f 6d70  r nodes are comp
+0000fab0: 7574 6564 2e0a 2020 2020 2020 2020 2020  uted..          
+0000fac0: 2020 4966 2074 6869 7320 6973 2065 7175    If this is equ
+0000fad0: 616c 2074 6f20 6060 2274 696d 6522 6060  al to ``"time"``
+0000fae0: 2028 7468 6520 6465 6661 756c 7429 2c20   (the default), 
+0000faf0: 6e6f 6465 2068 6569 6768 7473 2061 7265  node heights are
+0000fb00: 2070 726f 706f 7274 696f 6e61 6c0a 2020   proportional.  
+0000fb10: 2020 2020 2020 2020 2020 746f 2074 6865            to the
+0000fb20: 6972 2074 696d 6520 7661 6c75 6573 2e20  ir time values. 
+0000fb30: 4966 2074 6869 7320 6973 2065 7175 616c  If this is equal
+0000fb40: 2074 6f20 6060 226c 6f67 5f74 696d 6522   to ``"log_time"
+0000fb50: 6060 2c20 6e6f 6465 2068 6569 6768 7473  ``, node heights
+0000fb60: 2061 7265 0a20 2020 2020 2020 2020 2020   are.           
+0000fb70: 2070 726f 706f 7274 696f 6e61 6c20 746f   proportional to
+0000fb80: 2074 6865 6972 206c 6f67 2874 696d 6529   their log(time)
+0000fb90: 2076 616c 7565 732e 2049 6620 6974 2069   values. If it i
+0000fba0: 7320 6571 7561 6c20 746f 2060 6022 7261  s equal to ``"ra
+0000fbb0: 6e6b 2260 602c 206e 6f64 650a 2020 2020  nk"``, node.    
+0000fbc0: 2020 2020 2020 2020 6865 6967 6874 7320          heights 
+0000fbd0: 6172 6520 7370 6163 6564 2065 7175 616c  are spaced equal
+0000fbe0: 6c79 2061 6363 6f72 6469 6e67 2074 6f20  ly according to 
+0000fbf0: 7468 6569 7220 7261 6e6b 6564 2074 696d  their ranked tim
+0000fc00: 6573 2e0a 2020 2020 2020 2020 3a70 6172  es..        :par
+0000fc10: 616d 2073 7472 2074 7265 655f 6865 6967  am str tree_heig
+0000fc20: 6874 5f73 6361 6c65 3a20 4465 7072 6563  ht_scale: Deprec
+0000fc30: 6174 6564 2061 6c69 6173 2066 6f72 2074  ated alias for t
+0000fc40: 696d 655f 7363 616c 652e 2028 4465 7072  ime_scale. (Depr
+0000fc50: 6563 6174 6564 2069 6e0a 2020 2020 2020  ecated in.      
+0000fc60: 2020 2020 2020 2020 2020 302e 332e 3629            0.3.6)
+0000fc70: 0a20 2020 2020 2020 203a 7061 7261 6d20  .        :param 
+0000fc80: 7374 722c 666c 6f61 7420 6d61 785f 7469  str,float max_ti
+0000fc90: 6d65 3a20 5468 6520 6d61 7869 6d75 6d20  me: The maximum 
+0000fca0: 706c 6f74 7465 6420 7469 6d65 2076 616c  plotted time val
+0000fcb0: 7565 2069 6e20 7468 6520 6375 7272 656e  ue in the curren
+0000fcc0: 740a 2020 2020 2020 2020 2020 2020 7363  t.            sc
+0000fcd0: 616c 696e 6720 7379 7374 656d 2028 7365  aling system (se
+0000fce0: 6520 6060 7469 6d65 5f73 6361 6c65 6060  e ``time_scale``
+0000fcf0: 292e 2043 616e 2062 6520 6569 7468 6572  ). Can be either
+0000fd00: 2061 2073 7472 696e 6720 6f72 2061 0a20   a string or a. 
+0000fd10: 2020 2020 2020 2020 2020 206e 756d 6572             numer
+0000fd20: 6963 2076 616c 7565 2e20 4966 2065 7175  ic value. If equ
+0000fd30: 616c 2074 6f20 6060 2274 7265 6522 6060  al to ``"tree"``
+0000fd40: 2028 7468 6520 6465 6661 756c 7429 2c20   (the default), 
+0000fd50: 7468 6520 6d61 7869 6d75 6d20 7469 6d65  the maximum time
+0000fd60: 0a20 2020 2020 2020 2020 2020 2069 7320  .            is 
+0000fd70: 7365 7420 746f 2062 6520 7468 6174 206f  set to be that o
+0000fd80: 6620 7468 6520 6f6c 6465 7374 2072 6f6f  f the oldest roo
+0000fd90: 7420 696e 2074 6865 2074 7265 652e 2049  t in the tree. I
+0000fda0: 6620 6571 7561 6c20 746f 2060 6022 7473  f equal to ``"ts
+0000fdb0: 2260 6020 7468 650a 2020 2020 2020 2020  "`` the.        
+0000fdc0: 2020 2020 6d61 7869 6d75 6d20 7469 6d65      maximum time
+0000fdd0: 2069 7320 7365 7420 746f 2062 6520 7468   is set to be th
+0000fde0: 6520 7469 6d65 206f 6620 7468 6520 6f6c  e time of the ol
+0000fdf0: 6465 7374 2072 6f6f 7420 696e 2074 6865  dest root in the
+0000fe00: 2074 7265 650a 2020 2020 2020 2020 2020   tree.          
+0000fe10: 2020 7365 7175 656e 6365 3b20 7468 6973    sequence; this
+0000fe20: 2069 7320 7573 6566 756c 2077 6865 6e20   is useful when 
+0000fe30: 6472 6177 696e 6720 7472 6565 7320 6672  drawing trees fr
+0000fe40: 6f6d 2074 6865 2073 616d 6520 7472 6565  om the same tree
+0000fe50: 2073 6571 7565 6e63 6520 6173 2069 740a   sequence as it.
+0000fe60: 2020 2020 2020 2020 2020 2020 656e 7375              ensu
+0000fe70: 7265 7320 7468 6174 206e 6f64 6520 6865  res that node he
+0000fe80: 6967 6874 7320 6172 6520 636f 6e73 6973  ights are consis
+0000fe90: 7465 6e74 2e20 4966 2061 206e 756d 6572  tent. If a numer
+0000fea0: 6963 2076 616c 7565 2c20 7468 6973 2069  ic value, this i
+0000feb0: 7320 7573 6564 2061 730a 2020 2020 2020  s used as.      
+0000fec0: 2020 2020 2020 7468 6520 6d61 7869 6d75        the maximu
+0000fed0: 6d20 706c 6f74 7465 6420 7469 6d65 2062  m plotted time b
+0000fee0: 7920 7768 6963 6820 746f 2073 6361 6c65  y which to scale
+0000fef0: 206f 7468 6572 206e 6f64 6573 2e0a 2020   other nodes..  
+0000ff00: 2020 2020 2020 3a70 6172 616d 2073 7472        :param str
+0000ff10: 2c66 6c6f 6174 206d 696e 5f74 696d 653a  ,float min_time:
+0000ff20: 2054 6865 206d 696e 696d 756d 2070 6c6f   The minimum plo
+0000ff30: 7474 6564 2074 696d 6520 7661 6c75 6520  tted time value 
+0000ff40: 696e 2074 6865 2063 7572 7265 6e74 0a20  in the current. 
+0000ff50: 2020 2020 2020 2020 2020 2073 6361 6c69             scali
+0000ff60: 6e67 2073 7973 7465 6d20 2873 6565 2060  ng system (see `
+0000ff70: 6074 696d 655f 7363 616c 6560 6029 2e20  `time_scale``). 
+0000ff80: 4361 6e20 6265 2065 6974 6865 7220 6120  Can be either a 
+0000ff90: 7374 7269 6e67 206f 7220 610a 2020 2020  string or a.    
+0000ffa0: 2020 2020 2020 2020 6e75 6d65 7269 6320          numeric 
+0000ffb0: 7661 6c75 652e 2049 6620 6571 7561 6c20  value. If equal 
+0000ffc0: 746f 2060 6022 7472 6565 2260 6020 2874  to ``"tree"`` (t
+0000ffd0: 6865 2064 6566 6175 6c74 292c 2074 6865  he default), the
+0000ffe0: 206d 696e 696d 756d 2074 696d 650a 2020   minimum time.  
+0000fff0: 2020 2020 2020 2020 2020 6973 2073 6574            is set
+00010000: 2074 6f20 6265 2074 6861 7420 6f66 2074   to be that of t
+00010010: 6865 2079 6f75 6e67 6573 7420 6e6f 6465  he youngest node
+00010020: 2069 6e20 7468 6520 7472 6565 2e20 4966   in the tree. If
+00010030: 2065 7175 616c 2074 6f20 6060 2274 7322   equal to ``"ts"
+00010040: 6060 2074 6865 0a20 2020 2020 2020 2020  `` the.         
+00010050: 2020 206d 696e 696d 756d 2074 696d 6520     minimum time 
+00010060: 6973 2073 6574 2074 6f20 6265 2074 6865  is set to be the
+00010070: 2074 696d 6520 6f66 2074 6865 2079 6f75   time of the you
+00010080: 6e67 6573 7420 6e6f 6465 2069 6e20 7468  ngest node in th
+00010090: 6520 7472 6565 0a20 2020 2020 2020 2020  e tree.         
+000100a0: 2020 2073 6571 7565 6e63 653b 2074 6869     sequence; thi
+000100b0: 7320 6973 2075 7365 6675 6c20 7768 656e  s is useful when
+000100c0: 2064 7261 7769 6e67 2074 7265 6573 2066   drawing trees f
+000100d0: 726f 6d20 7468 6520 7361 6d65 2074 7265  rom the same tre
+000100e0: 6520 7365 7175 656e 6365 2061 7320 6974  e sequence as it
+000100f0: 0a20 2020 2020 2020 2020 2020 2065 6e73  .            ens
+00010100: 7572 6573 2074 6861 7420 6e6f 6465 2068  ures that node h
+00010110: 6569 6768 7473 2061 7265 2063 6f6e 7369  eights are consi
+00010120: 7374 656e 742e 2049 6620 6120 6e75 6d65  stent. If a nume
+00010130: 7269 6320 7661 6c75 652c 2074 6869 7320  ric value, this 
+00010140: 6973 2075 7365 6420 6173 0a20 2020 2020  is used as.     
+00010150: 2020 2020 2020 2074 6865 206d 696e 696d         the minim
+00010160: 756d 2070 6c6f 7474 6564 2074 696d 652e  um plotted time.
+00010170: 0a20 2020 2020 2020 203a 7061 7261 6d20  .        :param 
+00010180: 7374 722c 666c 6f61 7420 6d61 785f 7472  str,float max_tr
+00010190: 6565 5f68 6569 6768 743a 2044 6570 7265  ee_height: Depre
+000101a0: 6361 7465 6420 616c 6961 7320 666f 7220  cated alias for 
+000101b0: 6d61 785f 7469 6d65 2e20 2844 6570 7265  max_time. (Depre
+000101c0: 6361 7465 6420 696e 0a20 2020 2020 2020  cated in.       
+000101d0: 2020 2020 2030 2e33 2e36 290a 2020 2020       0.3.6).    
+000101e0: 2020 2020 3a70 6172 616d 206e 6f64 655f      :param node_
+000101f0: 6c61 6265 6c73 3a20 4966 2073 7065 6369  labels: If speci
+00010200: 6669 6564 2c20 7368 6f77 2063 7573 746f  fied, show custo
+00010210: 6d20 6c61 6265 6c73 2066 6f72 2074 6865  m labels for the
+00010220: 206e 6f64 6573 0a20 2020 2020 2020 2020   nodes.         
+00010230: 2020 2028 7370 6563 6966 6965 6420 6279     (specified by
+00010240: 2049 4429 2074 6861 7420 6172 6520 7072   ID) that are pr
+00010250: 6573 656e 7420 696e 2074 6869 7320 6d61  esent in this ma
+00010260: 703b 2061 6e79 206e 6f64 6573 206e 6f74  p; any nodes not
+00010270: 2070 7265 7365 6e74 2077 696c 6c0a 2020   present will.  
+00010280: 2020 2020 2020 2020 2020 6e6f 7420 6861            not ha
+00010290: 7665 2061 206c 6162 656c 2e0a 2020 2020  ve a label..    
+000102a0: 2020 2020 3a74 7970 6520 6e6f 6465 5f6c      :type node_l
+000102b0: 6162 656c 733a 2064 6963 7428 696e 742c  abels: dict(int,
+000102c0: 2073 7472 290a 2020 2020 2020 2020 3a70   str).        :p
+000102d0: 6172 616d 206d 7574 6174 696f 6e5f 6c61  aram mutation_la
+000102e0: 6265 6c73 3a20 4966 2073 7065 6369 6669  bels: If specifi
+000102f0: 6564 2c20 7368 6f77 2063 7573 746f 6d20  ed, show custom 
+00010300: 6c61 6265 6c73 2066 6f72 2074 6865 0a20  labels for the. 
+00010310: 2020 2020 2020 2020 2020 206d 7574 6174             mutat
+00010320: 696f 6e73 2028 7370 6563 6966 6965 6420  ions (specified 
+00010330: 6279 2049 4429 2074 6861 7420 6172 6520  by ID) that are 
+00010340: 7072 6573 656e 7420 696e 2074 6865 206d  present in the m
+00010350: 6170 3b20 616e 7920 6d75 7461 7469 6f6e  ap; any mutation
+00010360: 730a 2020 2020 2020 2020 2020 2020 6e6f  s.            no
+00010370: 7420 7072 6573 656e 7420 7769 6c6c 206e  t present will n
+00010380: 6f74 2068 6176 6520 6120 6c61 6265 6c2e  ot have a label.
+00010390: 0a20 2020 2020 2020 203a 7479 7065 206d  .        :type m
+000103a0: 7574 6174 696f 6e5f 6c61 6265 6c73 3a20  utation_labels: 
+000103b0: 6469 6374 2869 6e74 2c20 7374 7229 0a20  dict(int, str). 
+000103c0: 2020 2020 2020 203a 7061 7261 6d20 6469         :param di
+000103d0: 6374 2072 6f6f 745f 7376 675f 6174 7472  ct root_svg_attr
+000103e0: 6962 7574 6573 3a20 4164 6469 7469 6f6e  ibutes: Addition
+000103f0: 616c 2061 7474 7269 6275 7465 732c 2073  al attributes, s
+00010400: 7563 6820 6173 2061 6e20 6964 2c20 7468  uch as an id, th
+00010410: 6174 2077 696c 6c0a 2020 2020 2020 2020  at will.        
+00010420: 2020 2020 6265 2065 6d62 6564 6465 6420      be embedded 
+00010430: 696e 2074 6865 2072 6f6f 7420 6060 3c73  in the root ``<s
+00010440: 7667 3e60 6020 7461 6720 6f66 2074 6865  vg>`` tag of the
+00010450: 2067 656e 6572 6174 6564 2064 7261 7769   generated drawi
+00010460: 6e67 2e0a 2020 2020 2020 2020 3a70 6172  ng..        :par
+00010470: 616d 2073 7472 2073 7479 6c65 3a20 410a  am str style: A.
+00010480: 2020 2020 2020 2020 2020 2020 6063 7373              `css
+00010490: 2073 7479 6c65 2073 7472 696e 6720 3c68   style string <h
+000104a0: 7474 7073 3a2f 2f77 7777 2e77 332e 6f72  ttps://www.w3.or
+000104b0: 672f 5452 2f43 5353 3232 2f73 796e 6461  g/TR/CSS22/synda
+000104c0: 7461 2e68 746d 6c3e 605f 2074 6861 7420  ta.html>`_ that 
+000104d0: 7769 6c6c 2062 650a 2020 2020 2020 2020  will be.        
+000104e0: 2020 2020 696e 636c 7564 6564 2069 6e20      included in 
+000104f0: 7468 6520 6060 3c73 7479 6c65 3e60 6020  the ``<style>`` 
+00010500: 7461 6720 6f66 2074 6865 2067 656e 6572  tag of the gener
+00010510: 6174 6564 2073 7667 2e0a 2020 2020 2020  ated svg..      
+00010520: 2020 3a70 6172 616d 2073 7472 206f 7264    :param str ord
+00010530: 6572 3a20 5468 6520 6c65 6674 2d74 6f2d  er: The left-to-
+00010540: 7269 6768 7420 6f72 6465 7269 6e67 206f  right ordering o
+00010550: 6620 6368 696c 6420 6e6f 6465 7320 696e  f child nodes in
+00010560: 2074 6865 2064 7261 776e 2074 7265 652e   the drawn tree.
+00010570: 0a20 2020 2020 2020 2020 2020 2054 6869  .            Thi
+00010580: 7320 6361 6e20 6265 2065 6974 6865 723a  s can be either:
+00010590: 2060 6022 6d69 6e6c 6578 2260 602c 2077   ``"minlex"``, w
+000105a0: 6869 6368 206d 696e 696d 6973 6573 2074  hich minimises t
+000105b0: 6865 2064 6966 6665 7265 6e63 6573 0a20  he differences. 
+000105c0: 2020 2020 2020 2020 2020 2062 6574 7765             betwe
+000105d0: 656e 2061 646a 6163 656e 7420 7472 6565  en adjacent tree
+000105e0: 7320 2873 6565 2061 6c73 6f20 7468 6520  s (see also the 
+000105f0: 6060 226d 696e 6c65 785f 706f 7374 6f72  ``"minlex_postor
+00010600: 6465 7222 6060 2074 7261 7665 7273 616c  der"`` traversal
+00010610: 0a20 2020 2020 2020 2020 2020 206f 7264  .            ord
+00010620: 6572 2066 6f72 2074 6865 203a 6d65 7468  er for the :meth
+00010630: 3a60 2e6e 6f64 6573 6020 6d65 7468 6f64  :`.nodes` method
+00010640: 293b 206f 7220 6060 2274 7265 6522 6060  ); or ``"tree"``
+00010650: 2077 6869 6368 2064 7261 7773 2074 7265   which draws tre
+00010660: 6573 0a20 2020 2020 2020 2020 2020 2069  es.            i
+00010670: 6e20 7468 6520 6c65 6674 2d74 6f2d 7269  n the left-to-ri
+00010680: 6768 7420 6f72 6465 7220 6465 6669 6e65  ght order define
+00010690: 6420 6279 2074 6865 0a20 2020 2020 2020  d by the.       
+000106a0: 2020 2020 203a 7265 663a 6071 7569 6e74       :ref:`quint
+000106b0: 7570 6c79 206c 696e 6b65 6420 7472 6565  uply linked tree
+000106c0: 2073 7472 7563 7475 7265 203c 7365 635f   structure <sec_
+000106d0: 6461 7461 5f6d 6f64 656c 5f74 7265 655f  data_model_tree_
+000106e0: 7374 7275 6374 7572 653e 602e 0a20 2020  structure>`..   
+000106f0: 2020 2020 2020 2020 2049 6620 6e6f 7420           If not 
+00010700: 7370 6563 6966 6965 6420 6f72 204e 6f6e  specified or Non
+00010710: 652c 2074 6869 7320 6465 6661 756c 7473  e, this defaults
+00010720: 2074 6f20 6060 226d 696e 6c65 7822 6060   to ``"minlex"``
+00010730: 2e0a 2020 2020 2020 2020 3a70 6172 616d  ..        :param
+00010740: 2062 6f6f 6c20 666f 7263 655f 726f 6f74   bool force_root
+00010750: 5f62 7261 6e63 683a 2049 6620 6060 5472  _branch: If ``Tr
+00010760: 7565 6060 2061 6c77 6179 7320 706c 6f74  ue`` always plot
+00010770: 2061 2062 7261 6e63 6820 2865 6467 6529   a branch (edge)
+00010780: 2061 626f 7665 2074 6865 0a20 2020 2020   above the.     
+00010790: 2020 2020 2020 2072 6f6f 7428 7329 2069         root(s) i
+000107a0: 6e20 7468 6520 7472 6565 2e20 4966 2060  n the tree. If `
+000107b0: 604e 6f6e 6560 6020 2864 6566 6175 6c74  `None`` (default
+000107c0: 2920 7468 656e 206f 6e6c 7920 706c 6f74  ) then only plot
+000107d0: 2073 7563 6820 726f 6f74 2062 7261 6e63   such root branc
+000107e0: 6865 730a 2020 2020 2020 2020 2020 2020  hes.            
+000107f0: 6966 2074 6865 7265 2069 7320 6120 6d75  if there is a mu
+00010800: 7461 7469 6f6e 2061 626f 7665 2061 2072  tation above a r
+00010810: 6f6f 7420 6f66 2074 6865 2074 7265 652e  oot of the tree.
+00010820: 0a20 2020 2020 2020 203a 7061 7261 6d20  .        :param 
+00010830: 666c 6f61 7420 7379 6d62 6f6c 5f73 697a  float symbol_siz
+00010840: 653a 2043 6861 6e67 6520 7468 6520 6465  e: Change the de
+00010850: 6661 756c 7420 7369 7a65 206f 6620 7468  fault size of th
+00010860: 6520 6e6f 6465 2061 6e64 206d 7574 6174  e node and mutat
+00010870: 696f 6e0a 2020 2020 2020 2020 2020 2020  ion.            
+00010880: 706c 6f74 7469 6e67 2073 796d 626f 6c73  plotting symbols
+00010890: 2e20 4966 2060 604e 6f6e 6560 6020 2864  . If ``None`` (d
+000108a0: 6566 6175 6c74 2920 7573 6520 6120 7374  efault) use a st
+000108b0: 616e 6461 7264 2073 697a 652e 0a20 2020  andard size..   
+000108c0: 2020 2020 203a 7061 7261 6d20 626f 6f6c       :param bool
+000108d0: 2078 5f61 7869 733a 2053 686f 756c 6420   x_axis: Should 
+000108e0: 7468 6520 706c 6f74 2068 6176 6520 616e  the plot have an
+000108f0: 2058 2061 7869 7320 6c69 6e65 2c20 7368   X axis line, sh
+00010900: 6f77 696e 6720 7468 6520 7374 6172 7420  owing the start 
+00010910: 616e 640a 2020 2020 2020 2020 2020 2020  and.            
+00010920: 656e 6420 706f 7369 7469 6f6e 206f 6620  end position of 
+00010930: 7468 6973 2074 7265 6520 616c 6f6e 6720  this tree along 
+00010940: 7468 6520 6765 6e6f 6d65 2e20 4966 2060  the genome. If `
+00010950: 604e 6f6e 6560 6020 2864 6566 6175 6c74  `None`` (default
+00010960: 2920 646f 206e 6f74 0a20 2020 2020 2020  ) do not.       
+00010970: 2020 2020 2070 6c6f 7420 616e 2058 2061       plot an X a
+00010980: 7869 732e 0a20 2020 2020 2020 203a 7061  xis..        :pa
+00010990: 7261 6d20 7374 7220 785f 6c61 6265 6c3a  ram str x_label:
+000109a0: 2050 6c61 6365 2061 206c 6162 656c 2075   Place a label u
+000109b0: 6e64 6572 2074 6865 2070 6c6f 742e 2049  nder the plot. I
+000109c0: 6620 6060 4e6f 6e65 6060 2028 6465 6661  f ``None`` (defa
+000109d0: 756c 7429 2061 6e64 0a20 2020 2020 2020  ult) and.       
+000109e0: 2020 2020 2074 6865 7265 2069 7320 616e       there is an
+000109f0: 2058 2061 7869 732c 2063 7265 6174 6520   X axis, create 
+00010a00: 616e 6420 706c 6163 6520 616e 2061 7070  and place an app
+00010a10: 726f 7072 6961 7465 206c 6162 656c 2e0a  ropriate label..
+00010a20: 2020 2020 2020 2020 3a70 6172 616d 2062          :param b
+00010a30: 6f6f 6c20 795f 6178 6973 3a20 5368 6f75  ool y_axis: Shou
+00010a40: 6c64 2074 6865 2070 6c6f 7420 6861 7665  ld the plot have
+00010a50: 2061 6e20 5920 6178 6973 206c 696e 652c   an Y axis line,
+00010a60: 2073 686f 7769 6e67 2074 696d 6520 286f   showing time (o
+00010a70: 720a 2020 2020 2020 2020 2020 2020 7261  r.            ra
+00010a80: 6e6b 6564 206e 6f64 6520 7469 6d65 2069  nked node time i
+00010a90: 6620 6060 7469 6d65 5f73 6361 6c65 3d22  f ``time_scale="
+00010aa0: 7261 6e6b 2260 6029 2e20 4966 2060 604e  rank"``). If ``N
+00010ab0: 6f6e 6560 6020 2864 6566 6175 6c74 290a  one`` (default).
+00010ac0: 2020 2020 2020 2020 2020 2020 646f 206e              do n
+00010ad0: 6f74 2070 6c6f 7420 6120 5920 6178 6973  ot plot a Y axis
+00010ae0: 2e0a 2020 2020 2020 2020 3a70 6172 616d  ..        :param
+00010af0: 2073 7472 2079 5f6c 6162 656c 3a20 506c   str y_label: Pl
+00010b00: 6163 6520 6120 6c61 6265 6c20 746f 2074  ace a label to t
+00010b10: 6865 206c 6566 7420 6f66 2074 6865 2070  he left of the p
+00010b20: 6c6f 742e 2049 6620 6060 4e6f 6e65 6060  lot. If ``None``
+00010b30: 2028 6465 6661 756c 7429 0a20 2020 2020   (default).     
+00010b40: 2020 2020 2020 2061 6e64 2074 6865 7265         and there
+00010b50: 2069 7320 6120 5920 6178 6973 2c20 2063   is a Y axis,  c
+00010b60: 7265 6174 6520 616e 6420 706c 6163 6520  reate and place 
+00010b70: 616e 2061 7070 726f 7072 6961 7465 206c  an appropriate l
+00010b80: 6162 656c 2e0a 2020 2020 2020 2020 3a70  abel..        :p
+00010b90: 6172 616d 206c 6973 7420 795f 7469 636b  aram list y_tick
+00010ba0: 733a 2041 206c 6973 7420 6f66 2059 2076  s: A list of Y v
+00010bb0: 616c 7565 7320 6174 2077 6869 6368 2074  alues at which t
+00010bc0: 6f20 706c 6f74 2074 6963 6b6d 6172 6b73  o plot tickmarks
+00010bd0: 2028 6060 5b5d 6060 0a20 2020 2020 2020   (``[]``.       
+00010be0: 2020 2020 2067 6976 6573 206e 6f20 7469       gives no ti
+00010bf0: 636b 6d61 726b 7329 2e20 4966 2060 604e  ckmarks). If ``N
+00010c00: 6f6e 6560 602c 2070 6c6f 7420 6f6e 6520  one``, plot one 
+00010c10: 7469 636b 6d61 726b 2066 6f72 2065 6163  tickmark for eac
+00010c20: 6820 756e 6971 7565 0a20 2020 2020 2020  h unique.       
+00010c30: 2020 2020 206e 6f64 6520 7661 6c75 652e       node value.
+00010c40: 0a20 2020 2020 2020 203a 7061 7261 6d20  .        :param 
+00010c50: 626f 6f6c 2079 5f67 7269 646c 696e 6573  bool y_gridlines
+00010c60: 3a20 5768 6574 6865 7220 746f 2070 6c6f  : Whether to plo
+00010c70: 7420 686f 7269 7a6f 6e74 616c 206c 696e  t horizontal lin
+00010c80: 6573 2062 6568 696e 6420 7468 6520 7472  es behind the tr
+00010c90: 6565 0a20 2020 2020 2020 2020 2020 2061  ee.            a
+00010ca0: 7420 6561 6368 2079 2074 6963 6b6d 6172  t each y tickmar
+00010cb0: 6b2e 0a20 2020 2020 2020 203a 7061 7261  k..        :para
+00010cc0: 6d20 626f 6f6c 2061 6c6c 5f65 6467 655f  m bool all_edge_
+00010cd0: 6d75 7461 7469 6f6e 733a 2054 6865 2065  mutations: The e
+00010ce0: 6467 6520 6f6e 2077 6869 6368 2061 206d  dge on which a m
+00010cf0: 7574 6174 696f 6e20 6f63 6375 7273 206d  utation occurs m
+00010d00: 6179 2073 7061 6e0a 2020 2020 2020 2020  ay span.        
+00010d10: 2020 2020 6d75 6c74 6970 6c65 2074 7265      multiple tre
+00010d20: 6573 2e20 4966 2060 6046 616c 7365 6060  es. If ``False``
+00010d30: 206f 7220 6060 4e6f 6e65 6060 2028 6465   or ``None`` (de
+00010d40: 6661 756c 7429 206d 7574 6174 696f 6e73  fault) mutations
+00010d50: 2061 7265 206f 6e6c 7920 6472 6177 6e0a   are only drawn.
+00010d60: 2020 2020 2020 2020 2020 2020 6f6e 2061              on a
+00010d70: 6e20 6564 6765 2069 6620 7468 6569 7220  n edge if their 
+00010d80: 7369 7465 2070 6f73 6974 696f 6e20 6578  site position ex
+00010d90: 6973 7473 2077 6974 6869 6e20 7468 6520  ists within the 
+00010da0: 6765 6e6f 6d69 6320 696e 7465 7276 616c  genomic interval
+00010db0: 2063 6f76 6572 6564 0a20 2020 2020 2020   covered.       
+00010dc0: 2020 2020 2062 7920 7468 6973 2074 7265       by this tre
+00010dd0: 652e 2049 6620 6060 5472 7565 6060 2c20  e. If ``True``, 
+00010de0: 616c 6c20 6d75 7461 7469 6f6e 7320 6f6e  all mutations on
+00010df0: 2065 6163 6820 6564 6765 206f 6620 7468   each edge of th
+00010e00: 6520 7472 6565 2061 7265 2064 7261 776e  e tree are drawn
+00010e10: 2c0a 2020 2020 2020 2020 2020 2020 6576  ,.            ev
+00010e20: 656e 2069 6620 7468 6569 7220 6765 6e6f  en if their geno
+00010e30: 6d69 6320 706f 7369 7469 6f6e 2069 7320  mic position is 
+00010e40: 746f 2074 6865 206c 6566 7420 6f72 2072  to the left or r
+00010e50: 6967 6874 206f 6620 7468 6520 7472 6565  ight of the tree
+00010e60: 0a20 2020 2020 2020 2020 2020 2069 7473  .            its
+00010e70: 656c 662e 204e 6f74 6520 7468 6174 2074  elf. Note that t
+00010e80: 6869 7320 6d65 616e 7320 7468 6174 2069  his means that i
+00010e90: 6e64 6570 656e 6465 6e74 2064 7261 7769  ndependent drawi
+00010ea0: 6e67 7320 6f66 2064 6966 6665 7265 6e74  ngs of different
+00010eb0: 2074 7265 6573 0a20 2020 2020 2020 2020   trees.         
+00010ec0: 2020 2066 726f 6d20 7468 6520 7361 6d65     from the same
+00010ed0: 2074 7265 6520 7365 7175 656e 6365 206d   tree sequence m
+00010ee0: 6179 2073 6861 7265 2073 6f6d 6520 706c  ay share some pl
+00010ef0: 6f74 7465 6420 6d75 7461 7469 6f6e 732e  otted mutations.
+00010f00: 0a20 2020 2020 2020 203a 7061 7261 6d20  .        :param 
+00010f10: 626f 6f6c 206f 6d69 745f 7369 7465 733a  bool omit_sites:
+00010f20: 2049 6620 5472 7565 2c20 6f6d 6974 2073   If True, omit s
+00010f30: 6974 6573 2061 6e64 206d 7574 6174 696f  ites and mutatio
+00010f40: 6e73 2066 726f 6d20 7468 6520 6472 6177  ns from the draw
+00010f50: 696e 672e 0a20 2020 2020 2020 2020 2020  ing..           
+00010f60: 2044 6566 6175 6c74 3a20 4661 6c73 650a   Default: False.
+00010f70: 2020 2020 2020 2020 3a70 6172 616d 2074          :param t
+00010f80: 7570 6c65 2869 6e74 2c20 696e 7429 2063  uple(int, int) c
+00010f90: 616e 7661 735f 7369 7a65 3a20 5468 6520  anvas_size: The 
+00010fa0: 2877 6964 7468 2c20 6865 6967 6874 2920  (width, height) 
+00010fb0: 6f66 2074 6865 2053 5647 2063 616e 7661  of the SVG canva
+00010fc0: 732e 0a20 2020 2020 2020 2020 2020 2054  s..            T
+00010fd0: 6869 7320 7769 6c6c 2063 6861 6e67 6520  his will change 
+00010fe0: 7468 6520 5356 4720 7769 6474 6820 616e  the SVG width an
+00010ff0: 6420 6865 6967 6874 2077 6974 686f 7574  d height without
+00011000: 2072 6573 6361 6c69 6e67 2067 7261 7068   rescaling graph
+00011010: 6963 616c 0a20 2020 2020 2020 2020 2020  ical.           
+00011020: 2065 6c65 6d65 6e74 732c 2061 6c6c 6f77   elements, allow
+00011030: 696e 6720 6578 7472 6120 726f 6f6d 2065  ing extra room e
+00011040: 2e67 2e20 666f 7220 756e 7573 7561 6c6c  .g. for unusuall
+00011050: 7920 6c6f 6e67 206c 6162 656c 732e 2049  y long labels. I
+00011060: 6620 6060 4e6f 6e65 6060 0a20 2020 2020  f ``None``.     
+00011070: 2020 2020 2020 2074 616b 6520 7468 6520         take the 
+00011080: 6361 6e76 6173 2073 697a 6520 746f 2062  canvas size to b
+00011090: 6520 7468 6520 7361 6d65 2061 7320 7468  e the same as th
+000110a0: 6520 7461 7267 6574 2064 7261 7769 6e67  e target drawing
+000110b0: 2073 697a 6520 2873 6565 0a20 2020 2020   size (see.     
+000110c0: 2020 2020 2020 2060 6073 697a 6560 602c         ``size``,
+000110d0: 2061 626f 7665 292e 2044 6566 6175 6c74   above). Default
+000110e0: 3a20 4e6f 6e65 0a0a 2020 2020 2020 2020  : None..        
+000110f0: 3a72 6574 7572 6e3a 2041 6e20 5356 4720  :return: An SVG 
+00011100: 7265 7072 6573 656e 7461 7469 6f6e 206f  representation o
+00011110: 6620 6120 7472 6565 2e0a 2020 2020 2020  f a tree..      
+00011120: 2020 3a72 7479 7065 3a20 5356 4753 7472    :rtype: SVGStr
+00011130: 696e 670a 2020 2020 2020 2020 2222 220a  ing.        """.
+00011140: 2020 2020 2020 2020 6472 6177 203d 2064          draw = d
+00011150: 7261 7769 6e67 2e53 7667 5472 6565 280a  rawing.SvgTree(.
+00011160: 2020 2020 2020 2020 2020 2020 7365 6c66              self
+00011170: 2c0a 2020 2020 2020 2020 2020 2020 7369  ,.            si
+00011180: 7a65 2c0a 2020 2020 2020 2020 2020 2020  ze,.            
+00011190: 7469 6d65 5f73 6361 6c65 3d74 696d 655f  time_scale=time_
+000111a0: 7363 616c 652c 0a20 2020 2020 2020 2020  scale,.         
+000111b0: 2020 2074 7265 655f 6865 6967 6874 5f73     tree_height_s
+000111c0: 6361 6c65 3d74 7265 655f 6865 6967 6874  cale=tree_height
+000111d0: 5f73 6361 6c65 2c0a 2020 2020 2020 2020  _scale,.        
+000111e0: 2020 2020 6d61 785f 7469 6d65 3d6d 6178      max_time=max
+000111f0: 5f74 696d 652c 0a20 2020 2020 2020 2020  _time,.         
+00011200: 2020 206d 696e 5f74 696d 653d 6d69 6e5f     min_time=min_
+00011210: 7469 6d65 2c0a 2020 2020 2020 2020 2020  time,.          
+00011220: 2020 6d61 785f 7472 6565 5f68 6569 6768    max_tree_heigh
+00011230: 743d 6d61 785f 7472 6565 5f68 6569 6768  t=max_tree_heigh
+00011240: 742c 0a20 2020 2020 2020 2020 2020 206e  t,.            n
+00011250: 6f64 655f 6c61 6265 6c73 3d6e 6f64 655f  ode_labels=node_
+00011260: 6c61 6265 6c73 2c0a 2020 2020 2020 2020  labels,.        
+00011270: 2020 2020 6d75 7461 7469 6f6e 5f6c 6162      mutation_lab
+00011280: 656c 733d 6d75 7461 7469 6f6e 5f6c 6162  els=mutation_lab
+00011290: 656c 732c 0a20 2020 2020 2020 2020 2020  els,.           
+000112a0: 2072 6f6f 745f 7376 675f 6174 7472 6962   root_svg_attrib
+000112b0: 7574 6573 3d72 6f6f 745f 7376 675f 6174  utes=root_svg_at
+000112c0: 7472 6962 7574 6573 2c0a 2020 2020 2020  tributes,.      
+000112d0: 2020 2020 2020 7374 796c 653d 7374 796c        style=styl
+000112e0: 652c 0a20 2020 2020 2020 2020 2020 206f  e,.            o
+000112f0: 7264 6572 3d6f 7264 6572 2c0a 2020 2020  rder=order,.    
+00011300: 2020 2020 2020 2020 666f 7263 655f 726f          force_ro
+00011310: 6f74 5f62 7261 6e63 683d 666f 7263 655f  ot_branch=force_
+00011320: 726f 6f74 5f62 7261 6e63 682c 0a20 2020  root_branch,.   
+00011330: 2020 2020 2020 2020 2073 796d 626f 6c5f           symbol_
+00011340: 7369 7a65 3d73 796d 626f 6c5f 7369 7a65  size=symbol_size
+00011350: 2c0a 2020 2020 2020 2020 2020 2020 785f  ,.            x_
+00011360: 6178 6973 3d78 5f61 7869 732c 0a20 2020  axis=x_axis,.   
+00011370: 2020 2020 2020 2020 2078 5f6c 6162 656c           x_label
+00011380: 3d78 5f6c 6162 656c 2c0a 2020 2020 2020  =x_label,.      
+00011390: 2020 2020 2020 795f 6178 6973 3d79 5f61        y_axis=y_a
+000113a0: 7869 732c 0a20 2020 2020 2020 2020 2020  xis,.           
+000113b0: 2079 5f6c 6162 656c 3d79 5f6c 6162 656c   y_label=y_label
+000113c0: 2c0a 2020 2020 2020 2020 2020 2020 795f  ,.            y_
+000113d0: 7469 636b 733d 795f 7469 636b 732c 0a20  ticks=y_ticks,. 
+000113e0: 2020 2020 2020 2020 2020 2079 5f67 7269             y_gri
+000113f0: 646c 696e 6573 3d79 5f67 7269 646c 696e  dlines=y_gridlin
+00011400: 6573 2c0a 2020 2020 2020 2020 2020 2020  es,.            
+00011410: 616c 6c5f 6564 6765 5f6d 7574 6174 696f  all_edge_mutatio
+00011420: 6e73 3d61 6c6c 5f65 6467 655f 6d75 7461  ns=all_edge_muta
+00011430: 7469 6f6e 732c 0a20 2020 2020 2020 2020  tions,.         
+00011440: 2020 206f 6d69 745f 7369 7465 733d 6f6d     omit_sites=om
+00011450: 6974 5f73 6974 6573 2c0a 2020 2020 2020  it_sites,.      
+00011460: 2020 2020 2020 6361 6e76 6173 5f73 697a        canvas_siz
+00011470: 653d 6361 6e76 6173 5f73 697a 652c 0a20  e=canvas_size,. 
+00011480: 2020 2020 2020 2020 2020 202a 2a6b 7761             **kwa
+00011490: 7267 732c 0a20 2020 2020 2020 2029 0a20  rgs,.        ). 
+000114a0: 2020 2020 2020 206f 7574 7075 7420 3d20         output = 
+000114b0: 6472 6177 2e64 7261 7769 6e67 2e74 6f73  draw.drawing.tos
+000114c0: 7472 696e 6728 290a 2020 2020 2020 2020  tring().        
+000114d0: 6966 2070 6174 6820 6973 206e 6f74 204e  if path is not N
+000114e0: 6f6e 653a 0a20 2020 2020 2020 2020 2020  one:.           
+000114f0: 2023 2054 4f44 4f3a 2072 656d 6f76 6564   # TODO: removed
+00011500: 2074 6865 2070 7265 7474 7920 6865 7265   the pretty here
+00011510: 2077 6865 6e20 7468 6973 2069 7320 7374   when this is st
+00011520: 6162 6c65 2e0a 2020 2020 2020 2020 2020  able..          
+00011530: 2020 6472 6177 2e64 7261 7769 6e67 2e73    draw.drawing.s
+00011540: 6176 6561 7328 7061 7468 2c20 7072 6574  aveas(path, pret
+00011550: 7479 3d54 7275 6529 0a20 2020 2020 2020  ty=True).       
+00011560: 2072 6574 7572 6e20 6472 6177 696e 672e   return drawing.
+00011570: 5356 4753 7472 696e 6728 6f75 7470 7574  SVGString(output
+00011580: 290a 0a20 2020 2064 6566 2064 7261 7728  )..    def draw(
+00011590: 0a20 2020 2020 2020 2073 656c 662c 0a20  .        self,. 
+000115a0: 2020 2020 2020 2070 6174 683d 4e6f 6e65         path=None
+000115b0: 2c0a 2020 2020 2020 2020 7769 6474 683d  ,.        width=
+000115c0: 4e6f 6e65 2c0a 2020 2020 2020 2020 6865  None,.        he
+000115d0: 6967 6874 3d4e 6f6e 652c 0a20 2020 2020  ight=None,.     
+000115e0: 2020 206e 6f64 655f 6c61 6265 6c73 3d4e     node_labels=N
+000115f0: 6f6e 652c 0a20 2020 2020 2020 206e 6f64  one,.        nod
+00011600: 655f 636f 6c6f 7572 733d 4e6f 6e65 2c0a  e_colours=None,.
+00011610: 2020 2020 2020 2020 6d75 7461 7469 6f6e          mutation
+00011620: 5f6c 6162 656c 733d 4e6f 6e65 2c0a 2020  _labels=None,.  
+00011630: 2020 2020 2020 6d75 7461 7469 6f6e 5f63        mutation_c
+00011640: 6f6c 6f75 7273 3d4e 6f6e 652c 0a20 2020  olours=None,.   
+00011650: 2020 2020 2066 6f72 6d61 743d 4e6f 6e65       format=None
+00011660: 2c20 2023 206e 6f71 6120 4130 3032 0a20  ,  # noqa A002. 
+00011670: 2020 2020 2020 2065 6467 655f 636f 6c6f         edge_colo
+00011680: 7572 733d 4e6f 6e65 2c0a 2020 2020 2020  urs=None,.      
+00011690: 2020 7469 6d65 5f73 6361 6c65 3d4e 6f6e    time_scale=Non
+000116a0: 652c 0a20 2020 2020 2020 2074 7265 655f  e,.        tree_
+000116b0: 6865 6967 6874 5f73 6361 6c65 3d4e 6f6e  height_scale=Non
+000116c0: 652c 0a20 2020 2020 2020 206d 6178 5f74  e,.        max_t
+000116d0: 696d 653d 4e6f 6e65 2c0a 2020 2020 2020  ime=None,.      
+000116e0: 2020 6d69 6e5f 7469 6d65 3d4e 6f6e 652c    min_time=None,
+000116f0: 0a20 2020 2020 2020 206d 6178 5f74 7265  .        max_tre
+00011700: 655f 6865 6967 6874 3d4e 6f6e 652c 0a20  e_height=None,. 
+00011710: 2020 2020 2020 206f 7264 6572 3d4e 6f6e         order=Non
+00011720: 652c 0a20 2020 2020 2020 206f 6d69 745f  e,.        omit_
+00011730: 7369 7465 733d 4e6f 6e65 2c0a 2020 2020  sites=None,.    
+00011740: 293a 0a20 2020 2020 2020 2022 2222 0a20  ):.        """. 
+00011750: 2020 2020 2020 2052 6574 7572 6e73 2061         Returns a
+00011760: 2064 7261 7769 6e67 206f 6620 7468 6973   drawing of this
+00011770: 2074 7265 652e 0a0a 2020 2020 2020 2020   tree...        
+00011780: 5768 656e 2077 6f72 6b69 6e67 2069 6e20  When working in 
+00011790: 6120 4a75 7079 7465 7220 6e6f 7465 626f  a Jupyter notebo
+000117a0: 6f6b 2c20 7573 6520 7468 6520 6060 4950  ok, use the ``IP
+000117b0: 7974 686f 6e2e 6469 7370 6c61 792e 5356  ython.display.SV
+000117c0: 4760 600a 2020 2020 2020 2020 6675 6e63  G``.        func
+000117d0: 7469 6f6e 2074 6f20 6469 7370 6c61 7920  tion to display 
+000117e0: 7468 6520 5356 4720 6f75 7470 7574 2066  the SVG output f
+000117f0: 726f 6d20 7468 6973 2066 756e 6374 696f  rom this functio
+00011800: 6e20 696e 6c69 6e65 2069 6e20 7468 6520  n inline in the 
+00011810: 6e6f 7465 626f 6f6b 3a3a 0a0a 2020 2020  notebook::..    
+00011820: 2020 2020 2020 2020 3e3e 3e20 5356 4728          >>> SVG(
+00011830: 7472 6565 2e64 7261 7728 2929 0a0a 2020  tree.draw())..  
+00011840: 2020 2020 2020 5468 6520 756e 6963 6f64        The unicod
+00011850: 6520 666f 726d 6174 2075 7365 7320 756e  e format uses un
+00011860: 6963 6f64 6520 6062 6f78 2064 7261 7769  icode `box drawi
+00011870: 6e67 2063 6861 7261 6374 6572 730a 2020  ng characters.  
+00011880: 2020 2020 2020 3c68 7474 7073 3a2f 2f65        <https://e
+00011890: 6e2e 7769 6b69 7065 6469 612e 6f72 672f  n.wikipedia.org/
+000118a0: 7769 6b69 2f42 6f78 2d64 7261 7769 6e67  wiki/Box-drawing
+000118b0: 5f63 6861 7261 6374 6572 3e60 5f20 746f  _character>`_ to
+000118c0: 2072 656e 6465 7220 7468 6520 7472 6565   render the tree
+000118d0: 2e0a 2020 2020 2020 2020 5468 6973 2061  ..        This a
+000118e0: 6c6c 6f77 7320 7265 6e64 6572 6564 2074  llows rendered t
+000118f0: 7265 6573 2074 6f20 6265 2070 7269 6e74  rees to be print
+00011900: 6564 206f 7574 2074 6f20 7468 6520 7465  ed out to the te
+00011910: 726d 696e 616c 3a3a 0a0a 2020 2020 2020  rminal::..      
+00011920: 2020 2020 2020 3e3e 3e20 7072 696e 7428        >>> print(
+00011930: 7472 6565 2e64 7261 7728 666f 726d 6174  tree.draw(format
+00011940: 3d22 756e 6963 6f64 6522 2929 0a20 2020  ="unicode")).   
+00011950: 2020 2020 2020 2020 2020 2036 0a20 2020             6.   
+00011960: 2020 2020 2020 2020 20e2 948f e294 81e2           .......
+00011970: 94bb e294 81e2 9493 0a20 2020 2020 2020  .........       
+00011980: 2020 2020 20e2 9483 2020 2035 0a20 2020       ...   5.   
+00011990: 2020 2020 2020 2020 20e2 9483 20e2 948f           ... ...
+000119a0: e294 81e2 94bb e294 930a 2020 2020 2020  ..........      
+000119b0: 2020 2020 2020 e294 8320 e294 8320 2034        ... ...  4
+000119c0: 0a20 2020 2020 2020 2020 2020 20e2 9483  .            ...
+000119d0: 20e2 9483 20e2 948f e294 bbe2 9493 0a20   ... .......... 
+000119e0: 2020 2020 2020 2020 2020 2033 2030 2031             3 0 1
+000119f0: 2032 0a0a 2020 2020 2020 2020 5468 6520   2..        The 
+00011a00: 6060 6e6f 6465 5f6c 6162 656c 7360 6020  ``node_labels`` 
+00011a10: 6172 6775 6d65 6e74 2061 6c6c 6f77 7320  argument allows 
+00011a20: 7468 6520 7573 6572 2074 6f20 7370 6563  the user to spec
+00011a30: 6966 7920 6375 7374 6f6d 206c 6162 656c  ify custom label
+00011a40: 730a 2020 2020 2020 2020 666f 7220 6e6f  s.        for no
+00011a50: 6465 732c 206f 7220 6e6f 206c 6162 656c  des, or no label
+00011a60: 7320 6174 2061 6c6c 3a3a 0a0a 2020 2020  s at all::..    
+00011a70: 2020 2020 2020 2020 3e3e 3e20 7072 696e          >>> prin
+00011a80: 7428 7472 6565 2e64 7261 7728 666f 726d  t(tree.draw(form
+00011a90: 6174 3d22 756e 6963 6f64 6522 2c20 6e6f  at="unicode", no
+00011aa0: 6465 5f6c 6162 656c 733d 7b7d 2929 0a20  de_labels={})). 
+00011ab0: 2020 2020 2020 2020 2020 2020 20e2 9483               ...
+00011ac0: 0a20 2020 2020 2020 2020 2020 20e2 948f  .            ...
+00011ad0: e294 81e2 94bb e294 81e2 9493 0a20 2020  .............   
+00011ae0: 2020 2020 2020 2020 20e2 9483 2020 20e2           ...   .
+00011af0: 9483 0a20 2020 2020 2020 2020 2020 20e2  ...            .
+00011b00: 9483 20e2 948f e294 81e2 94bb e294 930a  .. .............
+00011b10: 2020 2020 2020 2020 2020 2020 e294 8320              ... 
+00011b20: e294 8320 20e2 9483 0a20 2020 2020 2020  ...  ....       
+00011b30: 2020 2020 20e2 9483 20e2 9483 20e2 948f       ... ... ...
+00011b40: e294 bbe2 9493 0a20 2020 2020 2020 2020  .......         
+00011b50: 2020 20e2 9483 20e2 9483 20e2 9483 20e2     ... ... ... .
+00011b60: 9483 0a0a 2020 2020 2020 2020 4e6f 7465  ....        Note
+00011b70: 3a20 696e 2073 6f6d 6520 656e 7669 726f  : in some enviro
+00011b80: 6e6d 656e 7473 2073 7563 6820 6173 204a  nments such as J
+00011b90: 7570 7974 6572 206e 6f74 6562 6f6f 6b73  upyter notebooks
+00011ba0: 2077 6974 6820 5769 6e64 6f77 7320 6f72   with Windows or
+00011bb0: 204d 6163 2c0a 2020 2020 2020 2020 7573   Mac,.        us
+00011bc0: 6572 7320 6861 7665 206f 6273 6572 7665  ers have observe
+00011bd0: 6420 7468 6174 2074 6865 2055 6e69 636f  d that the Unico
+00011be0: 6465 2062 6f78 2064 7261 7769 6e67 7320  de box drawings 
+00011bf0: 6361 6e20 6265 206d 6973 616c 6967 6e65  can be misaligne
+00011c00: 642e 2049 6e0a 2020 2020 2020 2020 7468  d. In.        th
+00011c10: 6573 6520 6361 7365 732c 2077 6520 7265  ese cases, we re
+00011c20: 636f 6d6d 656e 6420 7573 696e 6720 7468  commend using th
+00011c30: 6520 5356 4720 6f72 2041 5343 4949 2064  e SVG or ASCII d
+00011c40: 6973 706c 6179 2066 6f72 6d61 7473 2069  isplay formats i
+00011c50: 6e73 7465 6164 2e0a 2020 2020 2020 2020  nstead..        
+00011c60: 4966 2079 6f75 2068 6176 6520 6120 7374  If you have a st
+00011c70: 726f 6e67 2070 7265 6665 7265 6e63 6520  rong preference 
+00011c80: 666f 7220 616c 6967 6e65 6420 556e 6963  for aligned Unic
+00011c90: 6f64 652c 2079 6f75 2063 616e 2074 7279  ode, you can try
+00011ca0: 206f 7574 2074 6865 0a20 2020 2020 2020   out the.       
+00011cb0: 2073 6f6c 7574 696f 6e20 646f 6375 6d65   solution docume
+00011cc0: 6e74 6564 0a20 2020 2020 2020 2060 6865  nted.        `he
+00011cd0: 7265 203c 6874 7470 733a 2f2f 6769 7468  re <https://gith
+00011ce0: 7562 2e63 6f6d 2f74 736b 6974 2d64 6576  ub.com/tskit-dev
+00011cf0: 2f74 736b 6974 2f69 7373 7565 732f 3138  /tskit/issues/18
+00011d00: 3923 6973 7375 6563 6f6d 6d65 6e74 2d34  9#issuecomment-4
+00011d10: 3939 3131 3438 3131 3e60 5f2e 0a0a 2020  99114811>`_...  
+00011d20: 2020 2020 2020 3a70 6172 616d 2073 7472        :param str
+00011d30: 2070 6174 683a 2054 6865 2070 6174 6820   path: The path 
+00011d40: 746f 2074 6865 2066 696c 6520 746f 2077  to the file to w
+00011d50: 7269 7465 2074 6865 206f 7574 7075 742e  rite the output.
+00011d60: 2049 6620 4e6f 6e65 2c20 646f 206e 6f74   If None, do not
+00011d70: 0a20 2020 2020 2020 2020 2020 2077 7269  .            wri
+00011d80: 7465 2074 6f20 6669 6c65 2e0a 2020 2020  te to file..    
+00011d90: 2020 2020 3a70 6172 616d 2069 6e74 2077      :param int w
+00011da0: 6964 7468 3a20 5468 6520 7769 6474 6820  idth: The width 
+00011db0: 6f66 2074 6865 2069 6d61 6765 2069 6e20  of the image in 
+00011dc0: 7069 7865 6c73 2e20 4966 206e 6f74 2073  pixels. If not s
+00011dd0: 7065 6369 6669 6564 2c20 6569 7468 6572  pecified, either
+00011de0: 0a20 2020 2020 2020 2020 2020 2064 6566  .            def
+00011df0: 6175 6c74 7320 746f 2074 6865 206d 696e  aults to the min
+00011e00: 696d 756d 2073 697a 6520 7265 7175 6972  imum size requir
+00011e10: 6564 2074 6f20 6465 7069 6374 2074 6865  ed to depict the
+00011e20: 2074 7265 6520 2874 6578 7420 666f 726d   tree (text form
+00011e30: 6174 7329 0a20 2020 2020 2020 2020 2020  ats).           
+00011e40: 206f 7220 3230 3020 7069 7865 6c73 2e0a   or 200 pixels..
+00011e50: 2020 2020 2020 2020 3a70 6172 616d 2069          :param i
+00011e60: 6e74 2068 6569 6768 743a 2054 6865 2068  nt height: The h
+00011e70: 6569 6768 7420 6f66 2074 6865 2069 6d61  eight of the ima
+00011e80: 6765 2069 6e20 7069 7865 6c73 2e20 4966  ge in pixels. If
+00011e90: 206e 6f74 2073 7065 6369 6669 6564 2c20   not specified, 
+00011ea0: 6569 7468 6572 0a20 2020 2020 2020 2020  either.         
+00011eb0: 2020 2064 6566 6175 6c74 7320 746f 2074     defaults to t
+00011ec0: 6865 206d 696e 696d 756d 2073 697a 6520  he minimum size 
+00011ed0: 7265 7175 6972 6564 2074 6f20 6465 7069  required to depi
+00011ee0: 6374 2074 6865 2074 7265 6520 2874 6578  ct the tree (tex
+00011ef0: 7420 666f 726d 6174 7329 0a20 2020 2020  t formats).     
+00011f00: 2020 2020 2020 206f 7220 3230 3020 7069         or 200 pi
+00011f10: 7865 6c73 2e0a 2020 2020 2020 2020 3a70  xels..        :p
+00011f20: 6172 616d 2064 6963 7420 6e6f 6465 5f6c  aram dict node_l
+00011f30: 6162 656c 733a 2049 6620 7370 6563 6966  abels: If specif
+00011f40: 6965 642c 2073 686f 7720 6375 7374 6f6d  ied, show custom
+00011f50: 206c 6162 656c 7320 666f 7220 7468 6520   labels for the 
+00011f60: 6e6f 6465 730a 2020 2020 2020 2020 2020  nodes.          
+00011f70: 2020 7468 6174 2061 7265 2070 7265 7365    that are prese
+00011f80: 6e74 2069 6e20 7468 6520 6d61 702e 2041  nt in the map. A
+00011f90: 6e79 206e 6f64 6573 206e 6f74 2073 7065  ny nodes not spe
+00011fa0: 6369 6669 6564 2069 6e20 7468 6520 6d61  cified in the ma
+00011fb0: 7020 7769 6c6c 0a20 2020 2020 2020 2020  p will.         
+00011fc0: 2020 206e 6f74 2068 6176 6520 6120 6e6f     not have a no
+00011fd0: 6465 206c 6162 656c 2e0a 2020 2020 2020  de label..      
+00011fe0: 2020 3a70 6172 616d 2064 6963 7420 6e6f    :param dict no
+00011ff0: 6465 5f63 6f6c 6f75 7273 3a20 4966 2073  de_colours: If s
+00012000: 7065 6369 6669 6564 2c20 7368 6f77 2063  pecified, show c
+00012010: 7573 746f 6d20 636f 6c6f 7572 7320 666f  ustom colours fo
+00012020: 7220 7468 6520 6e6f 6465 730a 2020 2020  r the nodes.    
+00012030: 2020 2020 2020 2020 6769 7665 6e20 696e          given in
+00012040: 2074 6865 206d 6170 2e20 416e 7920 6e6f   the map. Any no
+00012050: 6465 7320 6e6f 7420 7370 6563 6966 6965  des not specifie
+00012060: 6420 696e 2074 6865 206d 6170 2077 696c  d in the map wil
+00012070: 6c20 7461 6b65 2074 6865 2064 6566 6175  l take the defau
+00012080: 6c74 0a20 2020 2020 2020 2020 2020 2063  lt.            c
+00012090: 6f6c 6f75 723b 2061 2076 616c 7565 206f  olour; a value o
+000120a0: 6620 6060 4e6f 6e65 6060 2069 7320 7472  f ``None`` is tr
+000120b0: 6561 7465 6420 6173 2074 7261 6e73 7061  eated as transpa
+000120c0: 7265 6e74 2061 6e64 2068 656e 6365 2074  rent and hence t
+000120d0: 6865 206e 6f64 650a 2020 2020 2020 2020  he node.        
+000120e0: 2020 2020 7379 6d62 6f6c 2069 7320 6e6f      symbol is no
+000120f0: 7420 706c 6f74 7465 642e 2028 4f6e 6c79  t plotted. (Only
+00012100: 2073 7570 706f 7274 6564 2069 6e20 7468   supported in th
+00012110: 6520 5356 4720 666f 726d 6174 2e29 0a20  e SVG format.). 
+00012120: 2020 2020 2020 203a 7061 7261 6d20 6469         :param di
+00012130: 6374 206d 7574 6174 696f 6e5f 6c61 6265  ct mutation_labe
+00012140: 6c73 3a20 4966 2073 7065 6369 6669 6564  ls: If specified
+00012150: 2c20 7368 6f77 2063 7573 746f 6d20 6c61  , show custom la
+00012160: 6265 6c73 2066 6f72 2074 6865 206d 7574  bels for the mut
+00012170: 6174 696f 6e73 0a20 2020 2020 2020 2020  ations.         
+00012180: 2020 2028 7370 6563 6966 6965 6420 6279     (specified by
+00012190: 2049 4429 2074 6861 7420 6172 6520 7072   ID) that are pr
+000121a0: 6573 656e 7420 696e 2074 6865 206d 6170  esent in the map
+000121b0: 2e20 416e 7920 6d75 7461 7469 6f6e 7320  . Any mutations 
+000121c0: 6e6f 7420 696e 2074 6865 206d 6170 0a20  not in the map. 
+000121d0: 2020 2020 2020 2020 2020 2077 696c 6c20             will 
+000121e0: 6e6f 7420 6861 7665 2061 206c 6162 656c  not have a label
+000121f0: 2e20 2853 686f 7769 6e67 206d 7574 6174  . (Showing mutat
+00012200: 696f 6e73 2069 7320 6375 7272 656e 746c  ions is currentl
+00012210: 7920 6f6e 6c79 2073 7570 706f 7274 6564  y only supported
+00012220: 2069 6e20 7468 650a 2020 2020 2020 2020   in the.        
+00012230: 2020 2020 5356 4720 666f 726d 6174 290a      SVG format).
+00012240: 2020 2020 2020 2020 3a70 6172 616d 2064          :param d
+00012250: 6963 7420 6d75 7461 7469 6f6e 5f63 6f6c  ict mutation_col
+00012260: 6f75 7273 3a20 4966 2073 7065 6369 6669  ours: If specifi
+00012270: 6564 2c20 7368 6f77 2063 7573 746f 6d20  ed, show custom 
+00012280: 636f 6c6f 7572 7320 666f 7220 7468 6520  colours for the 
+00012290: 6d75 7461 7469 6f6e 730a 2020 2020 2020  mutations.      
+000122a0: 2020 2020 2020 6769 7665 6e20 696e 2074        given in t
+000122b0: 6865 206d 6170 2028 7370 6563 6966 6965  he map (specifie
+000122c0: 6420 6279 2049 4429 2e20 4173 2066 6f72  d by ID). As for
+000122d0: 2060 606e 6f64 655f 636f 6c6f 7572 7360   ``node_colours`
+000122e0: 602c 206d 7574 6174 696f 6e73 206e 6f74  `, mutations not
+000122f0: 0a20 2020 2020 2020 2020 2020 2070 7265  .            pre
+00012300: 7365 6e74 2069 6e20 7468 6520 6d61 7020  sent in the map 
+00012310: 7461 6b65 2074 6865 2064 6566 6175 6c74  take the default
+00012320: 2063 6f6c 6f75 722c 2061 6e64 2074 686f   colour, and tho
+00012330: 7365 206d 6170 7069 6e67 2074 6f20 6060  se mapping to ``
+00012340: 4e6f 6e65 6060 0a20 2020 2020 2020 2020  None``.         
+00012350: 2020 2061 7265 206e 6f74 2064 7261 776e     are not drawn
+00012360: 2e20 284f 6e6c 7920 7375 7070 6f72 7465  . (Only supporte
+00012370: 6420 696e 2074 6865 2053 5647 2066 6f72  d in the SVG for
+00012380: 6d61 742e 290a 2020 2020 2020 2020 3a70  mat.).        :p
+00012390: 6172 616d 2073 7472 2066 6f72 6d61 743a  aram str format:
+000123a0: 2054 6865 2066 6f72 6d61 7420 6f66 2074   The format of t
+000123b0: 6865 2072 6574 7572 6e65 6420 696d 6167  he returned imag
+000123c0: 652e 2043 7572 7265 6e74 6c79 2073 7570  e. Currently sup
+000123d0: 706f 7274 6564 0a20 2020 2020 2020 2020  ported.         
+000123e0: 2020 2061 7265 2027 7376 6727 2c20 2761     are 'svg', 'a
+000123f0: 7363 6969 2720 616e 6420 2775 6e69 636f  scii' and 'unico
+00012400: 6465 272e 204e 6f74 6520 7468 6174 2074  de'. Note that t
+00012410: 6865 203a 6d65 7468 3a60 5472 6565 2e64  he :meth:`Tree.d
+00012420: 7261 775f 7376 6760 0a20 2020 2020 2020  raw_svg`.       
+00012430: 2020 2020 206d 6574 686f 6420 7072 6f76       method prov
+00012440: 6964 6573 206d 6f72 6520 636f 6d70 7265  ides more compre
+00012450: 6865 6e73 6976 6520 6675 6e63 7469 6f6e  hensive function
+00012460: 616c 6974 7920 666f 7220 6372 6561 7469  ality for creati
+00012470: 6e67 2053 5647 732e 0a20 2020 2020 2020  ng SVGs..       
+00012480: 203a 7061 7261 6d20 6469 6374 2065 6467   :param dict edg
+00012490: 655f 636f 6c6f 7572 733a 2049 6620 7370  e_colours: If sp
+000124a0: 6563 6966 6965 642c 2073 686f 7720 6375  ecified, show cu
+000124b0: 7374 6f6d 2063 6f6c 6f75 7273 2066 6f72  stom colours for
+000124c0: 2074 6865 2065 6467 650a 2020 2020 2020   the edge.      
+000124d0: 2020 2020 2020 6a6f 696e 696e 6720 6561        joining ea
+000124e0: 6368 206e 6f64 6520 696e 2074 6865 206d  ch node in the m
+000124f0: 6170 2074 6f20 6974 7320 7061 7265 6e74  ap to its parent
+00012500: 2e20 4173 2066 6f72 2060 606e 6f64 655f  . As for ``node_
+00012510: 636f 6c6f 7572 7360 602c 0a20 2020 2020  colours``,.     
+00012520: 2020 2020 2020 2075 6e73 7065 6369 6669         unspecifi
+00012530: 6564 2065 6467 6573 2074 616b 6520 7468  ed edges take th
+00012540: 6520 6465 6661 756c 7420 636f 6c6f 7572  e default colour
+00012550: 2c20 616e 6420 6060 4e6f 6e65 6060 2076  , and ``None`` v
+00012560: 616c 7565 7320 7265 7375 6c74 2069 6e20  alues result in 
+00012570: 7468 650a 2020 2020 2020 2020 2020 2020  the.            
+00012580: 6564 6765 2062 6569 6e67 206f 6d69 7474  edge being omitt
+00012590: 6564 2e20 284f 6e6c 7920 7375 7070 6f72  ed. (Only suppor
+000125a0: 7465 6420 696e 2074 6865 2053 5647 2066  ted in the SVG f
+000125b0: 6f72 6d61 742e 290a 2020 2020 2020 2020  ormat.).        
+000125c0: 3a70 6172 616d 2073 7472 2074 696d 655f  :param str time_
+000125d0: 7363 616c 653a 2043 6f6e 7472 6f6c 2068  scale: Control h
+000125e0: 6f77 2068 6569 6768 7420 7661 6c75 6573  ow height values
+000125f0: 2066 6f72 206e 6f64 6573 2061 7265 2063   for nodes are c
+00012600: 6f6d 7075 7465 642e 0a20 2020 2020 2020  omputed..       
+00012610: 2020 2020 2049 6620 7468 6973 2069 7320       If this is 
+00012620: 6571 7561 6c20 746f 2060 6022 7469 6d65  equal to ``"time
+00012630: 2260 602c 206e 6f64 6520 6865 6967 6874  "``, node height
+00012640: 7320 6172 6520 7072 6f70 6f72 7469 6f6e  s are proportion
+00012650: 616c 2074 6f20 7468 6569 7220 7469 6d65  al to their time
+00012660: 0a20 2020 2020 2020 2020 2020 2076 616c  .            val
+00012670: 7565 732e 2049 6620 7468 6973 2069 7320  ues. If this is 
+00012680: 6571 7561 6c20 746f 2060 6022 6c6f 675f  equal to ``"log_
+00012690: 7469 6d65 2260 602c 206e 6f64 6520 6865  time"``, node he
+000126a0: 6967 6874 7320 6172 6520 7072 6f70 6f72  ights are propor
+000126b0: 7469 6f6e 616c 2074 6f0a 2020 2020 2020  tional to.      
+000126c0: 2020 2020 2020 7468 6569 7220 6c6f 6728        their log(
+000126d0: 7469 6d65 2920 7661 6c75 6573 2e20 4966  time) values. If
+000126e0: 2069 7420 6973 2065 7175 616c 2074 6f20   it is equal to 
+000126f0: 6060 2272 616e 6b22 6060 2c20 6e6f 6465  ``"rank"``, node
+00012700: 2068 6569 6768 7473 2061 7265 2073 7061   heights are spa
+00012710: 6365 640a 2020 2020 2020 2020 2020 2020  ced.            
+00012720: 6571 7561 6c6c 7920 6163 636f 7264 696e  equally accordin
+00012730: 6720 746f 2074 6865 6972 2072 616e 6b65  g to their ranke
+00012740: 6420 7469 6d65 732e 2046 6f72 2053 5647  d times. For SVG
+00012750: 206f 7574 7075 7420 7468 6520 6465 6661   output the defa
+00012760: 756c 7420 6973 0a20 2020 2020 2020 2020  ult is.         
+00012770: 2020 2027 7469 6d65 272d 7363 616c 6520     'time'-scale 
+00012780: 7768 6572 6561 7320 666f 7220 7465 7874  whereas for text
+00012790: 206f 7574 7075 7420 7468 6520 6465 6661   output the defa
+000127a0: 756c 7420 6973 2027 7261 6e6b 272d 7363  ult is 'rank'-sc
+000127b0: 616c 652e 0a20 2020 2020 2020 2020 2020  ale..           
+000127c0: 2054 696d 6520 7363 616c 696e 6720 6973   Time scaling is
+000127d0: 206e 6f74 2063 7572 7265 6e74 6c79 2073   not currently s
+000127e0: 7570 706f 7274 6564 2066 6f72 2074 6578  upported for tex
+000127f0: 7420 6f75 7470 7574 2e0a 2020 2020 2020  t output..      
+00012800: 2020 3a70 6172 616d 2073 7472 2074 7265    :param str tre
+00012810: 655f 6865 6967 6874 5f73 6361 6c65 3a20  e_height_scale: 
+00012820: 4465 7072 6563 6174 6564 2061 6c69 6173  Deprecated alias
+00012830: 2066 6f72 2074 696d 655f 7363 616c 652e   for time_scale.
+00012840: 2028 4465 7072 6563 6174 6564 2069 6e0a   (Deprecated in.
+00012850: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00012860: 302e 332e 3629 0a20 2020 2020 2020 203a  0.3.6).        :
+00012870: 7061 7261 6d20 7374 722c 666c 6f61 7420  param str,float 
+00012880: 6d61 785f 7469 6d65 3a20 5468 6520 6d61  max_time: The ma
+00012890: 7869 6d75 6d20 7469 6d65 2076 616c 7565  ximum time value
+000128a0: 2069 6e20 7468 6520 6375 7272 656e 740a   in the current.
+000128b0: 2020 2020 2020 2020 2020 2020 7363 616c              scal
+000128c0: 696e 6720 7379 7374 656d 2028 7365 6520  ing system (see 
+000128d0: 6060 7469 6d65 5f73 6361 6c65 6060 292e  ``time_scale``).
+000128e0: 2043 616e 2062 6520 6569 7468 6572 2061   Can be either a
+000128f0: 2073 7472 696e 6720 6f72 2061 0a20 2020   string or a.   
+00012900: 2020 2020 2020 2020 206e 756d 6572 6963           numeric
+00012910: 2076 616c 7565 2e20 4966 2065 7175 616c   value. If equal
+00012920: 2074 6f20 6060 2274 7265 6522 6060 2c20   to ``"tree"``, 
+00012930: 7468 6520 6d61 7869 6d75 6d20 7469 6d65  the maximum time
+00012940: 2069 7320 7365 7420 746f 2062 650a 2020   is set to be.  
+00012950: 2020 2020 2020 2020 2020 7468 6174 206f            that o
+00012960: 6620 7468 6520 6f6c 6465 7374 2072 6f6f  f the oldest roo
+00012970: 7420 696e 2074 6865 2074 7265 652e 2049  t in the tree. I
+00012980: 6620 6571 7561 6c20 746f 2060 6022 7473  f equal to ``"ts
+00012990: 2260 6020 7468 6520 6d61 7869 6d75 6d0a  "`` the maximum.
+000129a0: 2020 2020 2020 2020 2020 2020 7469 6d65              time
+000129b0: 2069 7320 7365 7420 746f 2062 6520 7468   is set to be th
+000129c0: 6520 7469 6d65 206f 6620 7468 6520 6f6c  e time of the ol
+000129d0: 6465 7374 2072 6f6f 7420 696e 2074 6865  dest root in the
+000129e0: 2074 7265 6520 7365 7175 656e 6365 3b0a   tree sequence;.
+000129f0: 2020 2020 2020 2020 2020 2020 7468 6973              this
+00012a00: 2069 7320 7573 6566 756c 2077 6865 6e20   is useful when 
+00012a10: 6472 6177 696e 6720 7472 6565 7320 6672  drawing trees fr
+00012a20: 6f6d 2074 6865 2073 616d 6520 7472 6565  om the same tree
+00012a30: 2073 6571 7565 6e63 6520 6173 2069 7420   sequence as it 
+00012a40: 656e 7375 7265 730a 2020 2020 2020 2020  ensures.        
+00012a50: 2020 2020 7468 6174 206e 6f64 6520 6865      that node he
+00012a60: 6967 6874 7320 6172 6520 636f 6e73 6973  ights are consis
+00012a70: 7465 6e74 2e20 4966 2061 206e 756d 6572  tent. If a numer
+00012a80: 6963 2076 616c 7565 2c20 7468 6973 2069  ic value, this i
+00012a90: 7320 7573 6564 2061 7320 7468 650a 2020  s used as the.  
+00012aa0: 2020 2020 2020 2020 2020 6d61 7869 6d75            maximu
+00012ab0: 6d20 7469 6d65 2062 7920 7768 6963 6820  m time by which 
+00012ac0: 746f 2073 6361 6c65 206f 7468 6572 206e  to scale other n
+00012ad0: 6f64 6573 2e20 5468 6973 2070 6172 616d  odes. This param
+00012ae0: 6574 6572 0a20 2020 2020 2020 2020 2020  eter.           
+00012af0: 2069 7320 6e6f 7420 6375 7272 656e 746c   is not currentl
+00012b00: 7920 7375 7070 6f72 7465 6420 666f 7220  y supported for 
+00012b10: 7465 7874 206f 7574 7075 742e 0a20 2020  text output..   
+00012b20: 2020 2020 203a 7061 7261 6d20 7374 722c       :param str,
+00012b30: 666c 6f61 7420 6d69 6e5f 7469 6d65 3a20  float min_time: 
+00012b40: 5468 6520 6d69 6e69 6d75 6d20 7469 6d65  The minimum time
+00012b50: 2076 616c 7565 2069 6e20 7468 6520 6375   value in the cu
+00012b60: 7272 656e 740a 2020 2020 2020 2020 2020  rrent.          
+00012b70: 2020 7363 616c 696e 6720 7379 7374 656d    scaling system
+00012b80: 2028 7365 6520 6060 7469 6d65 5f73 6361   (see ``time_sca
+00012b90: 6c65 6060 292e 2043 616e 2062 6520 6569  le``). Can be ei
+00012ba0: 7468 6572 2061 2073 7472 696e 6720 6f72  ther a string or
+00012bb0: 2061 0a20 2020 2020 2020 2020 2020 206e   a.            n
+00012bc0: 756d 6572 6963 2076 616c 7565 2e20 4966  umeric value. If
+00012bd0: 2065 7175 616c 2074 6f20 6060 2274 7265   equal to ``"tre
+00012be0: 6522 6060 2c20 7468 6520 6d69 6e69 6d75  e"``, the minimu
+00012bf0: 6d20 7469 6d65 2069 7320 7365 7420 746f  m time is set to
+00012c00: 2062 650a 2020 2020 2020 2020 2020 2020   be.            
+00012c10: 7468 6174 206f 6620 7468 6520 796f 756e  that of the youn
+00012c20: 6765 7374 206e 6f64 6520 696e 2074 6865  gest node in the
+00012c30: 2074 7265 652e 2049 6620 6571 7561 6c20   tree. If equal 
+00012c40: 746f 2060 6022 7473 2260 6020 7468 6520  to ``"ts"`` the 
+00012c50: 6d69 6e69 6d75 6d0a 2020 2020 2020 2020  minimum.        
+00012c60: 2020 2020 7469 6d65 2069 7320 7365 7420      time is set 
+00012c70: 746f 2062 6520 7468 6520 7469 6d65 206f  to be the time o
+00012c80: 6620 7468 6520 796f 756e 6765 7374 206e  f the youngest n
+00012c90: 6f64 6520 696e 2074 6865 2074 7265 6520  ode in the tree 
+00012ca0: 7365 7175 656e 6365 3b0a 2020 2020 2020  sequence;.      
+00012cb0: 2020 2020 2020 7468 6973 2069 7320 7573        this is us
+00012cc0: 6566 756c 2077 6865 6e20 6472 6177 696e  eful when drawin
+00012cd0: 6720 7472 6565 7320 6672 6f6d 2074 6865  g trees from the
+00012ce0: 2073 616d 6520 7472 6565 2073 6571 7565   same tree seque
+00012cf0: 6e63 6520 6173 2069 7420 656e 7375 7265  nce as it ensure
+00012d00: 730a 2020 2020 2020 2020 2020 2020 7468  s.            th
+00012d10: 6174 206e 6f64 6520 6865 6967 6874 7320  at node heights 
+00012d20: 6172 6520 636f 6e73 6973 7465 6e74 2e20  are consistent. 
+00012d30: 4966 2061 206e 756d 6572 6963 2076 616c  If a numeric val
+00012d40: 7565 2c20 7468 6973 2069 7320 7573 6564  ue, this is used
+00012d50: 2061 7320 7468 650a 2020 2020 2020 2020   as the.        
+00012d60: 2020 2020 6d69 6e69 6d75 6d20 7469 6d65      minimum time
+00012d70: 2074 6f20 6469 7370 6c61 792e 2054 6869   to display. Thi
+00012d80: 7320 7061 7261 6d65 7465 7220 6973 206e  s parameter is n
+00012d90: 6f74 2063 7572 7265 6e74 6c79 2073 7570  ot currently sup
+00012da0: 706f 7274 6564 2066 6f72 2074 6578 740a  ported for text.
+00012db0: 2020 2020 2020 2020 2020 2020 6f75 7470              outp
+00012dc0: 7574 2e0a 2020 2020 2020 2020 3a70 6172  ut..        :par
+00012dd0: 616d 2073 7472 206d 6178 5f74 7265 655f  am str max_tree_
+00012de0: 6865 6967 6874 3a20 4465 7072 6563 6174  height: Deprecat
+00012df0: 6564 2061 6c69 6173 2066 6f72 206d 6178  ed alias for max
+00012e00: 5f74 696d 652e 2028 4465 7072 6563 6174  _time. (Deprecat
+00012e10: 6564 2069 6e0a 2020 2020 2020 2020 2020  ed in.          
+00012e20: 2020 2020 2020 302e 332e 3629 0a20 2020        0.3.6).   
+00012e30: 2020 2020 203a 7061 7261 6d20 7374 7220       :param str 
+00012e40: 6f72 6465 723a 2054 6865 206c 6566 742d  order: The left-
+00012e50: 746f 2d72 6967 6874 206f 7264 6572 696e  to-right orderin
+00012e60: 6720 6f66 2063 6869 6c64 206e 6f64 6573  g of child nodes
+00012e70: 2069 6e20 7468 6520 6472 6177 6e20 7472   in the drawn tr
+00012e80: 6565 2e0a 2020 2020 2020 2020 2020 2020  ee..            
+00012e90: 5468 6973 2063 616e 2062 6520 6569 7468  This can be eith
+00012ea0: 6572 3a20 6060 226d 696e 6c65 7822 6060  er: ``"minlex"``
+00012eb0: 2c20 7768 6963 6820 6d69 6e69 6d69 7365  , which minimise
+00012ec0: 7320 7468 6520 6469 6666 6572 656e 6365  s the difference
+00012ed0: 730a 2020 2020 2020 2020 2020 2020 6265  s.            be
+00012ee0: 7477 6565 6e20 6164 6a61 6365 6e74 2074  tween adjacent t
+00012ef0: 7265 6573 2028 7365 6520 616c 736f 2074  rees (see also t
+00012f00: 6865 2060 6022 6d69 6e6c 6578 5f70 6f73  he ``"minlex_pos
+00012f10: 746f 7264 6572 2260 6020 7472 6176 6572  torder"`` traver
+00012f20: 7361 6c0a 2020 2020 2020 2020 2020 2020  sal.            
+00012f30: 6f72 6465 7220 666f 7220 7468 6520 3a6d  order for the :m
+00012f40: 6574 683a 602e 6e6f 6465 7360 206d 6574  eth:`.nodes` met
+00012f50: 686f 6429 3b20 6f72 2060 6022 7472 6565  hod); or ``"tree
+00012f60: 2260 6020 7768 6963 6820 6472 6177 7320  "`` which draws 
+00012f70: 7472 6565 730a 2020 2020 2020 2020 2020  trees.          
+00012f80: 2020 696e 2074 6865 206c 6566 742d 746f    in the left-to
+00012f90: 2d72 6967 6874 206f 7264 6572 2064 6566  -right order def
+00012fa0: 696e 6564 2062 7920 7468 650a 2020 2020  ined by the.    
+00012fb0: 2020 2020 2020 2020 3a72 6566 3a60 7175          :ref:`qu
+00012fc0: 696e 7475 706c 7920 6c69 6e6b 6564 2074  intuply linked t
+00012fd0: 7265 6520 7374 7275 6374 7572 6520 3c73  ree structure <s
+00012fe0: 6563 5f64 6174 615f 6d6f 6465 6c5f 7472  ec_data_model_tr
+00012ff0: 6565 5f73 7472 7563 7475 7265 3e60 2e0a  ee_structure>`..
+00013000: 2020 2020 2020 2020 2020 2020 4966 206e              If n
+00013010: 6f74 2073 7065 6369 6669 6564 206f 7220  ot specified or 
+00013020: 4e6f 6e65 2c20 7468 6973 2064 6566 6175  None, this defau
+00013030: 6c74 7320 746f 2060 6022 6d69 6e6c 6578  lts to ``"minlex
+00013040: 2260 602e 0a20 2020 2020 2020 203a 7061  "``..        :pa
+00013050: 7261 6d20 626f 6f6c 206f 6d69 745f 7369  ram bool omit_si
+00013060: 7465 733a 2049 6620 5472 7565 2c20 6f6d  tes: If True, om
+00013070: 6974 2073 6974 6573 2061 6e64 206d 7574  it sites and mut
+00013080: 6174 696f 6e73 2066 726f 6d20 7468 6520  ations from the 
+00013090: 6472 6177 696e 670a 2020 2020 2020 2020  drawing.        
+000130a0: 2020 2020 286f 6e6c 7920 7265 6c65 7661      (only releva
+000130b0: 6e74 2074 6f20 7468 6520 5356 4720 666f  nt to the SVG fo
+000130c0: 726d 6174 292e 2044 6566 6175 6c74 3a20  rmat). Default: 
+000130d0: 4661 6c73 650a 2020 2020 2020 2020 3a72  False.        :r
+000130e0: 6574 7572 6e3a 2041 2072 6570 7265 7365  eturn: A represe
+000130f0: 6e74 6174 696f 6e20 6f66 2074 6869 7320  ntation of this 
+00013100: 7472 6565 2069 6e20 7468 6520 7265 7175  tree in the requ
+00013110: 6573 7465 6420 666f 726d 6174 2e0a 2020  ested format..  
+00013120: 2020 2020 2020 3a72 7479 7065 3a20 7374        :rtype: st
+00013130: 720a 2020 2020 2020 2020 2222 220a 2020  r.        """.  
+00013140: 2020 2020 2020 6f75 7470 7574 203d 2064        output = d
+00013150: 7261 7769 6e67 2e64 7261 775f 7472 6565  rawing.draw_tree
+00013160: 280a 2020 2020 2020 2020 2020 2020 7365  (.            se
+00013170: 6c66 2c0a 2020 2020 2020 2020 2020 2020  lf,.            
+00013180: 666f 726d 6174 3d66 6f72 6d61 742c 0a20  format=format,. 
+00013190: 2020 2020 2020 2020 2020 2077 6964 7468             width
+000131a0: 3d77 6964 7468 2c0a 2020 2020 2020 2020  =width,.        
+000131b0: 2020 2020 6865 6967 6874 3d68 6569 6768      height=heigh
+000131c0: 742c 0a20 2020 2020 2020 2020 2020 206e  t,.            n
+000131d0: 6f64 655f 6c61 6265 6c73 3d6e 6f64 655f  ode_labels=node_
+000131e0: 6c61 6265 6c73 2c0a 2020 2020 2020 2020  labels,.        
+000131f0: 2020 2020 6e6f 6465 5f63 6f6c 6f75 7273      node_colours
+00013200: 3d6e 6f64 655f 636f 6c6f 7572 732c 0a20  =node_colours,. 
+00013210: 2020 2020 2020 2020 2020 206d 7574 6174             mutat
+00013220: 696f 6e5f 6c61 6265 6c73 3d6d 7574 6174  ion_labels=mutat
+00013230: 696f 6e5f 6c61 6265 6c73 2c0a 2020 2020  ion_labels,.    
+00013240: 2020 2020 2020 2020 6d75 7461 7469 6f6e          mutation
+00013250: 5f63 6f6c 6f75 7273 3d6d 7574 6174 696f  _colours=mutatio
+00013260: 6e5f 636f 6c6f 7572 732c 0a20 2020 2020  n_colours,.     
+00013270: 2020 2020 2020 2065 6467 655f 636f 6c6f         edge_colo
+00013280: 7572 733d 6564 6765 5f63 6f6c 6f75 7273  urs=edge_colours
+00013290: 2c0a 2020 2020 2020 2020 2020 2020 7469  ,.            ti
+000132a0: 6d65 5f73 6361 6c65 3d74 696d 655f 7363  me_scale=time_sc
+000132b0: 616c 652c 0a20 2020 2020 2020 2020 2020  ale,.           
+000132c0: 2074 7265 655f 6865 6967 6874 5f73 6361   tree_height_sca
+000132d0: 6c65 3d74 7265 655f 6865 6967 6874 5f73  le=tree_height_s
+000132e0: 6361 6c65 2c0a 2020 2020 2020 2020 2020  cale,.          
+000132f0: 2020 6d61 785f 7469 6d65 3d6d 6178 5f74    max_time=max_t
+00013300: 696d 652c 0a20 2020 2020 2020 2020 2020  ime,.           
+00013310: 206d 696e 5f74 696d 653d 6d69 6e5f 7469   min_time=min_ti
+00013320: 6d65 2c0a 2020 2020 2020 2020 2020 2020  me,.            
+00013330: 6d61 785f 7472 6565 5f68 6569 6768 743d  max_tree_height=
+00013340: 6d61 785f 7472 6565 5f68 6569 6768 742c  max_tree_height,
+00013350: 0a20 2020 2020 2020 2020 2020 206f 7264  .            ord
+00013360: 6572 3d6f 7264 6572 2c0a 2020 2020 2020  er=order,.      
+00013370: 2020 2020 2020 6f6d 6974 5f73 6974 6573        omit_sites
+00013380: 3d6f 6d69 745f 7369 7465 732c 0a20 2020  =omit_sites,.   
+00013390: 2020 2020 2029 0a20 2020 2020 2020 2069       ).        i
+000133a0: 6620 7061 7468 2069 7320 6e6f 7420 4e6f  f path is not No
+000133b0: 6e65 3a0a 2020 2020 2020 2020 2020 2020  ne:.            
+000133c0: 7769 7468 206f 7065 6e28 7061 7468 2c20  with open(path, 
+000133d0: 2277 2229 2061 7320 663a 0a20 2020 2020  "w") as f:.     
+000133e0: 2020 2020 2020 2020 2020 2066 2e77 7269             f.wri
+000133f0: 7465 286f 7574 7075 7429 0a20 2020 2020  te(output).     
+00013400: 2020 2072 6574 7572 6e20 6f75 7470 7574     return output
+00013410: 0a0a 2020 2020 6465 6620 6765 745f 6e75  ..    def get_nu
+00013420: 6d5f 6d75 7461 7469 6f6e 7328 7365 6c66  m_mutations(self
+00013430: 293a 0a20 2020 2020 2020 2072 6574 7572  ):.        retur
+00013440: 6e20 7365 6c66 2e6e 756d 5f6d 7574 6174  n self.num_mutat
+00013450: 696f 6e73 0a0a 2020 2020 4070 726f 7065  ions..    @prope
+00013460: 7274 790a 2020 2020 6465 6620 6e75 6d5f  rty.    def num_
+00013470: 6d75 7461 7469 6f6e 7328 7365 6c66 293a  mutations(self):
+00013480: 0a20 2020 2020 2020 2022 2222 0a20 2020  .        """.   
+00013490: 2020 2020 2052 6574 7572 6e73 2074 6865       Returns the
+000134a0: 2074 6f74 616c 206e 756d 6265 7220 6f66   total number of
+000134b0: 206d 7574 6174 696f 6e73 2061 6372 6f73   mutations acros
+000134c0: 7320 616c 6c20 7369 7465 7320 6f6e 2074  s all sites on t
+000134d0: 6869 7320 7472 6565 2e0a 0a20 2020 2020  his tree...     
+000134e0: 2020 203a 7265 7475 726e 3a20 5468 6520     :return: The 
+000134f0: 746f 7461 6c20 6e75 6d62 6572 206f 6620  total number of 
+00013500: 6d75 7461 7469 6f6e 7320 6f76 6572 2061  mutations over a
+00013510: 6c6c 2073 6974 6573 206f 6e20 7468 6973  ll sites on this
+00013520: 2074 7265 652e 0a20 2020 2020 2020 203a   tree..        :
+00013530: 7274 7970 653a 2069 6e74 0a20 2020 2020  rtype: int.     
+00013540: 2020 2022 2222 0a20 2020 2020 2020 2072     """.        r
+00013550: 6574 7572 6e20 7375 6d28 6c65 6e28 7369  eturn sum(len(si
+00013560: 7465 2e6d 7574 6174 696f 6e73 2920 666f  te.mutations) fo
+00013570: 7220 7369 7465 2069 6e20 7365 6c66 2e73  r site in self.s
+00013580: 6974 6573 2829 290a 0a20 2020 2040 7072  ites())..    @pr
+00013590: 6f70 6572 7479 0a20 2020 2064 6566 206e  operty.    def n
+000135a0: 756d 5f73 6974 6573 2873 656c 6629 3a0a  um_sites(self):.
+000135b0: 2020 2020 2020 2020 2222 220a 2020 2020          """.    
+000135c0: 2020 2020 5265 7475 726e 7320 7468 6520      Returns the 
+000135d0: 6e75 6d62 6572 206f 6620 7369 7465 7320  number of sites 
+000135e0: 6f6e 2074 6869 7320 7472 6565 2e0a 0a20  on this tree... 
+000135f0: 2020 2020 2020 203a 7265 7475 726e 3a20         :return: 
+00013600: 5468 6520 6e75 6d62 6572 206f 6620 7369  The number of si
+00013610: 7465 7320 6f6e 2074 6869 7320 7472 6565  tes on this tree
+00013620: 2e0a 2020 2020 2020 2020 3a72 7479 7065  ..        :rtype
+00013630: 3a20 696e 740a 2020 2020 2020 2020 2222  : int.        ""
+00013640: 220a 2020 2020 2020 2020 7265 7475 726e  ".        return
+00013650: 2073 656c 662e 5f6c 6c5f 7472 6565 2e67   self._ll_tree.g
+00013660: 6574 5f6e 756d 5f73 6974 6573 2829 0a0a  et_num_sites()..
+00013670: 2020 2020 6465 6620 7369 7465 7328 7365      def sites(se
+00013680: 6c66 293a 0a20 2020 2020 2020 2022 2222  lf):.        """
+00013690: 0a20 2020 2020 2020 2052 6574 7572 6e73  .        Returns
+000136a0: 2061 6e20 6974 6572 6174 6f72 206f 7665   an iterator ove
+000136b0: 7220 616c 6c20 7468 6520 3a72 6566 3a60  r all the :ref:`
+000136c0: 7369 7465 7320 3c73 6563 5f73 6974 655f  sites <sec_site_
+000136d0: 7461 626c 655f 6465 6669 6e69 7469 6f6e  table_definition
+000136e0: 3e60 0a20 2020 2020 2020 2069 6e20 7468  >`.        in th
+000136f0: 6973 2074 7265 652e 2053 6974 6573 2061  is tree. Sites a
+00013700: 7265 2072 6574 7572 6e65 6420 696e 206f  re returned in o
+00013710: 7264 6572 206f 6620 696e 6372 6561 7369  rder of increasi
+00013720: 6e67 2049 440a 2020 2020 2020 2020 2861  ng ID.        (a
+00013730: 6e64 2061 6c73 6f20 706f 7369 7469 6f6e  nd also position
+00013740: 292e 2053 6565 2074 6865 203a 636c 6173  ). See the :clas
+00013750: 733a 6053 6974 6560 2063 6c61 7373 2066  s:`Site` class f
+00013760: 6f72 2064 6574 6169 6c73 206f 6e0a 2020  or details on.  
+00013770: 2020 2020 2020 7468 6520 6176 6169 6c61        the availa
+00013780: 626c 6520 6669 656c 6473 2066 6f72 2065  ble fields for e
+00013790: 6163 6820 7369 7465 2e0a 0a20 2020 2020  ach site...     
+000137a0: 2020 203a 7265 7475 726e 3a20 416e 2069     :return: An i
+000137b0: 7465 7261 746f 7220 6f76 6572 2061 6c6c  terator over all
+000137c0: 2073 6974 6573 2069 6e20 7468 6973 2074   sites in this t
+000137d0: 7265 652e 0a20 2020 2020 2020 2022 2222  ree..        """
+000137e0: 0a20 2020 2020 2020 2023 2054 4f44 4f20  .        # TODO 
+000137f0: 6368 616e 6765 2074 6865 206c 6f77 2d6c  change the low-l
+00013800: 6576 656c 2041 5049 2074 6f20 6a75 7374  evel API to just
+00013810: 2072 6574 7572 6e20 7468 6520 4944 7320   return the IDs 
+00013820: 6f66 2074 6865 2073 6974 6573 2e0a 2020  of the sites..  
+00013830: 2020 2020 2020 666f 7220 6c6c 5f73 6974        for ll_sit
+00013840: 6520 696e 2073 656c 662e 5f6c 6c5f 7472  e in self._ll_tr
+00013850: 6565 2e67 6574 5f73 6974 6573 2829 3a0a  ee.get_sites():.
+00013860: 2020 2020 2020 2020 2020 2020 5f2c 205f              _, _
+00013870: 2c20 5f2c 2069 645f 2c20 5f20 3d20 6c6c  , _, id_, _ = ll
+00013880: 5f73 6974 650a 2020 2020 2020 2020 2020  _site.          
+00013890: 2020 7969 656c 6420 7365 6c66 2e74 7265    yield self.tre
+000138a0: 655f 7365 7175 656e 6365 2e73 6974 6528  e_sequence.site(
+000138b0: 6964 5f29 0a0a 2020 2020 6465 6620 6d75  id_)..    def mu
+000138c0: 7461 7469 6f6e 7328 7365 6c66 293a 0a20  tations(self):. 
+000138d0: 2020 2020 2020 2022 2222 0a20 2020 2020         """.     
+000138e0: 2020 2052 6574 7572 6e73 2061 6e20 6974     Returns an it
+000138f0: 6572 6174 6f72 206f 7665 7220 616c 6c20  erator over all 
+00013900: 7468 650a 2020 2020 2020 2020 3a72 6566  the.        :ref
+00013910: 3a60 6d75 7461 7469 6f6e 7320 3c73 6563  :`mutations <sec
+00013920: 5f6d 7574 6174 696f 6e5f 7461 626c 655f  _mutation_table_
+00013930: 6465 6669 6e69 7469 6f6e 3e60 2069 6e20  definition>` in 
+00013940: 7468 6973 2074 7265 652e 0a20 2020 2020  this tree..     
+00013950: 2020 204d 7574 6174 696f 6e73 2061 7265     Mutations are
+00013960: 2072 6574 7572 6e65 6420 696e 2074 6865   returned in the
+00013970: 6972 0a20 2020 2020 2020 203a 7265 663a  ir.        :ref:
+00013980: 606f 7264 6572 2069 6e20 7468 6520 6d75  `order in the mu
+00013990: 7461 7469 6f6e 7320 7461 626c 653c 7365  tations table<se
+000139a0: 635f 6d75 7461 7469 6f6e 5f72 6571 7569  c_mutation_requi
+000139b0: 7265 6d65 6e74 733e 602c 0a20 2020 2020  rements>`,.     
+000139c0: 2020 2074 6861 7420 6973 2c20 6279 206e     that is, by n
+000139d0: 6f6e 6465 6372 6561 7369 6e67 2073 6974  ondecreasing sit
+000139e0: 6520 4944 2c20 616e 6420 7769 7468 696e  e ID, and within
+000139f0: 2061 2073 6974 652c 2062 7920 6465 6372   a site, by decr
+00013a00: 6561 7369 6e67 0a20 2020 2020 2020 206d  easing.        m
+00013a10: 7574 6174 696f 6e20 7469 6d65 2077 6974  utation time wit
+00013a20: 6820 7061 7265 6e74 206d 7574 6174 696f  h parent mutatio
+00013a30: 6e73 2062 6566 6f72 6520 7468 6569 7220  ns before their 
+00013a40: 6368 696c 6472 656e 2e0a 2020 2020 2020  children..      
+00013a50: 2020 5365 6520 7468 6520 3a63 6c61 7373    See the :class
+00013a60: 3a60 4d75 7461 7469 6f6e 6020 636c 6173  :`Mutation` clas
+00013a70: 7320 666f 7220 6465 7461 696c 7320 6f6e  s for details on
+00013a80: 2074 6865 2061 7661 696c 6162 6c65 2066   the available f
+00013a90: 6965 6c64 7320 666f 720a 2020 2020 2020  ields for.      
+00013aa0: 2020 6561 6368 206d 7574 6174 696f 6e2e    each mutation.
+00013ab0: 0a0a 2020 2020 2020 2020 5468 6520 7265  ..        The re
+00013ac0: 7475 726e 6564 2069 7465 7261 746f 7220  turned iterator 
+00013ad0: 6973 2065 7175 6976 616c 656e 7420 746f  is equivalent to
+00013ae0: 2069 7465 7261 7469 6e67 206f 7665 7220   iterating over 
+00013af0: 616c 6c20 7369 7465 730a 2020 2020 2020  all sites.      
+00013b00: 2020 616e 6420 616c 6c20 6d75 7461 7469    and all mutati
+00013b10: 6f6e 7320 696e 2065 6163 6820 7369 7465  ons in each site
+00013b20: 2c20 692e 652e 3a3a 0a0a 2020 2020 2020  , i.e.::..      
+00013b30: 2020 2020 2020 3e3e 3e20 666f 7220 7369        >>> for si
+00013b40: 7465 2069 6e20 7472 6565 2e73 6974 6573  te in tree.sites
+00013b50: 2829 3a0a 2020 2020 2020 2020 2020 2020  ():.            
+00013b60: 3e3e 3e20 2020 2020 666f 7220 6d75 7461  >>>     for muta
+00013b70: 7469 6f6e 2069 6e20 7369 7465 2e6d 7574  tion in site.mut
+00013b80: 6174 696f 6e73 3a0a 2020 2020 2020 2020  ations:.        
+00013b90: 2020 2020 3e3e 3e20 2020 2020 2020 2020      >>>         
+00013ba0: 7969 656c 6420 6d75 7461 7469 6f6e 0a0a  yield mutation..
+00013bb0: 2020 2020 2020 2020 3a72 6574 7572 6e3a          :return:
+00013bc0: 2041 6e20 6974 6572 6174 6f72 206f 7665   An iterator ove
+00013bd0: 7220 616c 6c20 3a63 6c61 7373 3a60 4d75  r all :class:`Mu
+00013be0: 7461 7469 6f6e 6020 6f62 6a65 6374 7320  tation` objects 
+00013bf0: 696e 2074 6869 7320 7472 6565 2e0a 2020  in this tree..  
+00013c00: 2020 2020 2020 3a72 7479 7065 3a20 6974        :rtype: it
+00013c10: 6572 283a 636c 6173 733a 604d 7574 6174  er(:class:`Mutat
+00013c20: 696f 6e60 290a 2020 2020 2020 2020 2222  ion`).        ""
+00013c30: 220a 2020 2020 2020 2020 666f 7220 7369  ".        for si
+00013c40: 7465 2069 6e20 7365 6c66 2e73 6974 6573  te in self.sites
+00013c50: 2829 3a0a 2020 2020 2020 2020 2020 2020  ():.            
+00013c60: 7969 656c 6420 6672 6f6d 2073 6974 652e  yield from site.
+00013c70: 6d75 7461 7469 6f6e 730a 0a20 2020 2064  mutations..    d
+00013c80: 6566 2067 6574 5f6c 6561 7665 7328 7365  ef get_leaves(se
+00013c90: 6c66 2c20 7529 3a0a 2020 2020 2020 2020  lf, u):.        
+00013ca0: 2320 4465 7072 6563 6174 6564 2061 6c69  # Deprecated ali
+00013cb0: 6173 2066 6f72 2073 616d 706c 6573 2e20  as for samples. 
+00013cc0: 5365 6520 7468 6520 6469 7363 7573 7369  See the discussi
+00013cd0: 6f6e 2069 6e20 7468 6520 6765 745f 6e75  on in the get_nu
+00013ce0: 6d5f 6c65 6176 6573 0a20 2020 2020 2020  m_leaves.       
+00013cf0: 2023 206d 6574 686f 6420 666f 7220 7768   # method for wh
+00013d00: 7920 7468 6973 206d 6574 686f 6420 6973  y this method is
+00013d10: 2068 6572 6520 616e 6420 7768 7920 6974   here and why it
+00013d20: 2069 7320 7365 6d61 6e74 6963 616c 6c79   is semantically
+00013d30: 2069 6e63 6f72 7265 6374 2e0a 2020 2020   incorrect..    
+00013d40: 2020 2020 2320 5468 6520 276c 6561 7665      # The 'leave
+00013d50: 7327 2069 7465 7261 746f 7220 6265 6c6f  s' iterator belo
+00013d60: 7720 636f 7272 6563 746c 7920 7265 7475  w correctly retu
+00013d70: 726e 7320 7468 6520 6c65 6176 6573 2062  rns the leaves b
+00013d80: 656c 6f77 2061 2067 6976 656e 0a20 2020  elow a given.   
+00013d90: 2020 2020 2023 206e 6f64 652e 0a20 2020       # node..   
+00013da0: 2020 2020 2072 6574 7572 6e20 7365 6c66       return self
+00013db0: 2e73 616d 706c 6573 2875 290a 0a20 2020  .samples(u)..   
+00013dc0: 2064 6566 206c 6561 7665 7328 7365 6c66   def leaves(self
+00013dd0: 2c20 753d 4e6f 6e65 293a 0a20 2020 2020  , u=None):.     
+00013de0: 2020 2022 2222 0a20 2020 2020 2020 2052     """.        R
+00013df0: 6574 7572 6e73 2061 6e20 6974 6572 6174  eturns an iterat
+00013e00: 6f72 206f 7665 7220 616c 6c20 7468 6520  or over all the 
+00013e10: 6c65 6176 6573 2069 6e20 7468 6973 2074  leaves in this t
+00013e20: 7265 6520 7468 6174 2064 6573 6365 6e64  ree that descend
+00013e30: 2066 726f 6d0a 2020 2020 2020 2020 7468   from.        th
+00013e40: 6520 7370 6563 6966 6965 6420 6e6f 6465  e specified node
+00013e50: 2e20 4966 203a 6d61 7468 3a60 7560 2020  . If :math:`u`  
+00013e60: 6973 206e 6f74 2073 7065 6369 6669 6564  is not specified
+00013e70: 2c20 7265 7475 726e 2061 6c6c 206c 6561  , return all lea
+00013e80: 7665 7320 6f6e 0a20 2020 2020 2020 2074  ves on.        t
+00013e90: 6865 2074 7265 6520 2869 2e65 2e20 616c  he tree (i.e. al
+00013ea0: 6c20 6c65 6176 6573 2072 6561 6368 6162  l leaves reachab
+00013eb0: 6c65 2066 726f 6d20 7468 6520 7472 6565  le from the tree
+00013ec0: 2072 6f6f 7428 7329 2c20 7365 6520 6e6f   root(s), see no
+00013ed0: 7465 2062 656c 6f77 292e 0a0a 2020 2020  te below)...    
+00013ee0: 2020 2020 2e2e 206e 6f74 653a 3a0a 2020      .. note::.  
+00013ef0: 2020 2020 2020 2020 2020 3a6d 6174 683a            :math:
+00013f00: 6075 6020 6361 6e20 6265 2061 6e79 206e  `u` can be any n
+00013f10: 6f64 6520 696e 2074 6865 2065 6e74 6972  ode in the entir
+00013f20: 6520 7472 6565 2073 6571 7565 6e63 652c  e tree sequence,
+00013f30: 2069 6e63 6c75 6469 6e67 206f 6e65 730a   including ones.
+00013f40: 2020 2020 2020 2020 2020 2020 7768 6963              whic
+00013f50: 6820 6172 6520 6e6f 7420 636f 6e6e 6563  h are not connec
+00013f60: 7465 6420 7669 6120 6272 616e 6368 6573  ted via branches
+00013f70: 2074 6f20 6120 726f 6f74 206e 6f64 6520   to a root node 
+00013f80: 6f66 2074 6865 2074 7265 652e 2049 660a  of the tree. If.
+00013f90: 2020 2020 2020 2020 2020 2020 6361 6c6c              call
+00013fa0: 6564 206f 6e20 7375 6368 2061 206e 6f64  ed on such a nod
+00013fb0: 652c 2074 6865 2069 7465 7261 746f 7220  e, the iterator 
+00013fc0: 7769 6c6c 2072 6574 7572 6e20 2264 6561  will return "dea
+00013fd0: 6422 206c 6561 7665 730a 2020 2020 2020  d" leaves.      
+00013fe0: 2020 2020 2020 2873 6565 203a 7265 663a        (see :ref:
+00013ff0: 6073 6563 5f64 6174 615f 6d6f 6465 6c5f  `sec_data_model_
+00014000: 7472 6565 5f64 6561 645f 6c65 6176 6573  tree_dead_leaves
+00014010: 5f61 6e64 5f62 7261 6e63 6865 7360 2920  _and_branches`) 
+00014020: 7768 6963 6820 6361 6e6e 6f74 0a20 2020  which cannot.   
+00014030: 2020 2020 2020 2020 2062 6520 7265 6163           be reac
+00014040: 6865 6420 6672 6f6d 2061 2072 6f6f 7420  hed from a root 
+00014050: 6f66 2074 6869 7320 7472 6565 2e20 486f  of this tree. Ho
+00014060: 7765 7665 722c 2064 6561 6420 6c65 6176  wever, dead leav
+00014070: 6573 2077 696c 6c20 6e65 7665 7220 6265  es will never be
+00014080: 0a20 2020 2020 2020 2020 2020 2072 6574  .            ret
+00014090: 7572 6e65 6420 6966 203a 6d61 7468 3a60  urned if :math:`
+000140a0: 7560 2069 7320 6c65 6674 2075 6e73 7065  u` is left unspe
+000140b0: 6369 6669 6564 2e0a 0a20 2020 2020 2020  cified...       
+000140c0: 203a 7061 7261 6d20 696e 7420 753a 2054   :param int u: T
+000140d0: 6865 206e 6f64 6520 6f66 2069 6e74 6572  he node of inter
+000140e0: 6573 742e 0a20 2020 2020 2020 203a 7265  est..        :re
+000140f0: 7475 726e 3a20 416e 2069 7465 7261 746f  turn: An iterato
+00014100: 7220 6f76 6572 2061 6c6c 206c 6561 7665  r over all leave
+00014110: 7320 696e 2074 6865 2073 7562 7472 6565  s in the subtree
+00014120: 2072 6f6f 7465 6420 6174 2075 2e0a 2020   rooted at u..  
+00014130: 2020 2020 2020 3a72 7479 7065 3a20 636f        :rtype: co
+00014140: 6c6c 6563 7469 6f6e 732e 6162 632e 4974  llections.abc.It
+00014150: 6572 6162 6c65 0a20 2020 2020 2020 2022  erable.        "
+00014160: 2222 0a20 2020 2020 2020 2072 6f6f 7473  "".        roots
+00014170: 203d 205b 755d 0a20 2020 2020 2020 2069   = [u].        i
+00014180: 6620 7520 6973 204e 6f6e 653a 0a20 2020  f u is None:.   
+00014190: 2020 2020 2020 2020 2072 6f6f 7473 203d           roots =
+000141a0: 2073 656c 662e 726f 6f74 730a 2020 2020   self.roots.    
+000141b0: 2020 2020 666f 7220 726f 6f74 2069 6e20      for root in 
+000141c0: 726f 6f74 733a 0a20 2020 2020 2020 2020  roots:.         
+000141d0: 2020 2066 6f72 2076 2069 6e20 7365 6c66     for v in self
+000141e0: 2e6e 6f64 6573 2872 6f6f 7429 3a0a 2020  .nodes(root):.  
+000141f0: 2020 2020 2020 2020 2020 2020 2020 6966                if
+00014200: 2073 656c 662e 6973 5f6c 6561 6628 7629   self.is_leaf(v)
+00014210: 3a0a 2020 2020 2020 2020 2020 2020 2020  :.              
+00014220: 2020 2020 2020 7969 656c 6420 760a 0a20        yield v.. 
+00014230: 2020 2064 6566 205f 7361 6d70 6c65 5f67     def _sample_g
+00014240: 656e 6572 6174 6f72 2873 656c 662c 2075  enerator(self, u
+00014250: 293a 0a20 2020 2020 2020 2069 6620 7365  ):.        if se
+00014260: 6c66 2e5f 6c6c 5f74 7265 652e 6765 745f  lf._ll_tree.get_
+00014270: 6f70 7469 6f6e 7328 2920 2620 5f74 736b  options() & _tsk
+00014280: 6974 2e53 414d 504c 455f 4c49 5354 533a  it.SAMPLE_LISTS:
+00014290: 0a20 2020 2020 2020 2020 2020 2073 616d  .            sam
+000142a0: 706c 6573 203d 2073 656c 662e 7472 6565  ples = self.tree
+000142b0: 5f73 6571 7565 6e63 652e 7361 6d70 6c65  _sequence.sample
+000142c0: 7328 290a 2020 2020 2020 2020 2020 2020  s().            
+000142d0: 696e 6465 7820 3d20 7365 6c66 2e6c 6566  index = self.lef
+000142e0: 745f 7361 6d70 6c65 2875 290a 2020 2020  t_sample(u).    
+000142f0: 2020 2020 2020 2020 6966 2069 6e64 6578          if index
+00014300: 2021 3d20 4e55 4c4c 3a0a 2020 2020 2020   != NULL:.      
+00014310: 2020 2020 2020 2020 2020 7374 6f70 203d            stop =
+00014320: 2073 656c 662e 7269 6768 745f 7361 6d70   self.right_samp
+00014330: 6c65 2875 290a 2020 2020 2020 2020 2020  le(u).          
+00014340: 2020 2020 2020 7768 696c 6520 5472 7565        while True
+00014350: 3a0a 2020 2020 2020 2020 2020 2020 2020  :.              
+00014360: 2020 2020 2020 7969 656c 6420 7361 6d70        yield samp
+00014370: 6c65 735b 696e 6465 785d 0a20 2020 2020  les[index].     
+00014380: 2020 2020 2020 2020 2020 2020 2020 2069                 i
+00014390: 6620 696e 6465 7820 3d3d 2073 746f 703a  f index == stop:
+000143a0: 0a20 2020 2020 2020 2020 2020 2020 2020  .               
+000143b0: 2020 2020 2020 2020 2062 7265 616b 0a20           break. 
+000143c0: 2020 2020 2020 2020 2020 2020 2020 2020                  
+000143d0: 2020 2069 6e64 6578 203d 2073 656c 662e     index = self.
+000143e0: 6e65 7874 5f73 616d 706c 6528 696e 6465  next_sample(inde
+000143f0: 7829 0a20 2020 2020 2020 2065 6c73 653a  x).        else:
+00014400: 0a20 2020 2020 2020 2020 2020 2023 2046  .            # F
+00014410: 616c 6c20 6261 636b 206f 6e20 6974 6572  all back on iter
+00014420: 6174 696e 6720 6f76 6572 2061 6c6c 206e  ating over all n
+00014430: 6f64 6573 2069 6e20 7468 6520 7472 6565  odes in the tree
+00014440: 2c20 7969 656c 6469 6e67 0a20 2020 2020  , yielding.     
+00014450: 2020 2020 2020 2023 2073 616d 706c 6573         # samples
+00014460: 2061 7320 7765 2073 6565 2074 6865 6d2e   as we see them.
+00014470: 0a20 2020 2020 2020 2020 2020 2066 6f72  .            for
+00014480: 2076 2069 6e20 7365 6c66 2e6e 6f64 6573   v in self.nodes
+00014490: 2875 293a 0a20 2020 2020 2020 2020 2020  (u):.           
+000144a0: 2020 2020 2069 6620 7365 6c66 2e69 735f       if self.is_
+000144b0: 7361 6d70 6c65 2876 293a 0a20 2020 2020  sample(v):.     
+000144c0: 2020 2020 2020 2020 2020 2020 2020 2079                 y
+000144d0: 6965 6c64 2076 0a0a 2020 2020 6465 6620  ield v..    def 
+000144e0: 7361 6d70 6c65 7328 7365 6c66 2c20 753d  samples(self, u=
+000144f0: 4e6f 6e65 293a 0a20 2020 2020 2020 2022  None):.        "
+00014500: 2222 0a20 2020 2020 2020 2052 6574 7572  "".        Retur
+00014510: 6e73 2061 6e20 6974 6572 6174 6f72 206f  ns an iterator o
+00014520: 7665 7220 7468 6520 6e75 6d65 7269 6361  ver the numerica
+00014530: 6c20 4944 7320 6f66 2061 6c6c 2074 6865  l IDs of all the
+00014540: 2073 616d 706c 6520 6e6f 6465 7320 696e   sample nodes in
+00014550: 0a20 2020 2020 2020 2074 6869 7320 7472  .        this tr
+00014560: 6565 2074 6861 7420 6172 6520 756e 6465  ee that are unde
+00014570: 726e 6561 7468 2074 6865 206e 6f64 6520  rneath the node 
+00014580: 7769 7468 2049 4420 6060 7560 602e 2049  with ID ``u``. I
+00014590: 6620 6060 7560 6020 6973 2061 2073 616d  f ``u`` is a sam
+000145a0: 706c 652c 0a20 2020 2020 2020 2069 7420  ple,.        it 
+000145b0: 6973 2069 6e63 6c75 6465 6420 696e 2074  is included in t
+000145c0: 6865 2072 6574 7572 6e65 6420 6974 6572  he returned iter
+000145d0: 6174 6f72 2e20 4966 2060 6075 6060 2069  ator. If ``u`` i
+000145e0: 7320 6e6f 7420 6120 7361 6d70 6c65 2c20  s not a sample, 
+000145f0: 6974 2069 730a 2020 2020 2020 2020 706f  it is.        po
+00014600: 7373 6962 6c65 2066 6f72 2074 6865 2072  ssible for the r
+00014610: 6574 7572 6e65 6420 6974 6572 6174 6f72  eturned iterator
+00014620: 2074 6f20 6265 2065 6d70 7479 2c20 666f   to be empty, fo
+00014630: 7220 6578 616d 706c 6520 6966 2060 6075  r example if ``u
+00014640: 6060 2069 7320 616e 0a20 2020 2020 2020  `` is an.       
+00014650: 203a 6d65 7468 3a60 6973 6f6c 6174 6564   :meth:`isolated
+00014660: 3c54 7265 652e 6973 5f69 736f 6c61 7465  <Tree.is_isolate
+00014670: 643e 6020 6e6f 6465 2074 6861 7420 6973  d>` node that is
+00014680: 206e 6f74 2070 6172 7420 6f66 2074 6865   not part of the
+00014690: 2074 6865 2063 7572 7265 6e74 0a20 2020   the current.   
+000146a0: 2020 2020 2074 6f70 6f6c 6f67 792e 2049       topology. I
+000146b0: 6620 7520 6973 206e 6f74 2073 7065 6369  f u is not speci
+000146c0: 6669 6564 2c20 7265 7475 726e 2061 6c6c  fied, return all
+000146d0: 2073 616d 706c 6520 6e6f 6465 2049 4473   sample node IDs
+000146e0: 2069 6e20 7468 6520 7472 6565 0a20 2020   in the tree.   
+000146f0: 2020 2020 2028 6571 7569 7661 6c65 6e74       (equivalent
+00014700: 2074 6f20 616c 6c20 7468 6520 7361 6d70   to all the samp
+00014710: 6c65 206e 6f64 6520 4944 7320 696e 2074  le node IDs in t
+00014720: 6865 2074 7265 6520 7365 7175 656e 6365  he tree sequence
+00014730: 292e 0a0a 2020 2020 2020 2020 4966 2074  )...        If t
+00014740: 6865 203a 6d65 7468 3a60 5472 6565 5365  he :meth:`TreeSe
+00014750: 7175 656e 6365 2e74 7265 6573 6020 6d65  quence.trees` me
+00014760: 7468 6f64 2069 7320 6361 6c6c 6564 2077  thod is called w
+00014770: 6974 680a 2020 2020 2020 2020 6060 7361  ith.        ``sa
+00014780: 6d70 6c65 5f6c 6973 7473 3d54 7275 6560  mple_lists=True`
+00014790: 602c 2074 6869 7320 6d65 7468 6f64 2075  `, this method u
+000147a0: 7365 7320 616e 2065 6666 6963 6965 6e74  ses an efficient
+000147b0: 2061 6c67 6f72 6974 686d 2074 6f20 6669   algorithm to fi
+000147c0: 6e64 0a20 2020 2020 2020 2074 6865 2073  nd.        the s
+000147d0: 616d 706c 6520 6e6f 6465 732e 2049 6620  ample nodes. If 
+000147e0: 6e6f 742c 2061 2073 696d 706c 6520 7472  not, a simple tr
+000147f0: 6176 6572 7361 6c20 6261 7365 6420 6d65  aversal based me
+00014800: 7468 6f64 2069 7320 7573 6564 2e0a 0a20  thod is used... 
+00014810: 2020 2020 2020 202e 2e20 6e6f 7465 3a3a         .. note::
+00014820: 0a0a 2020 2020 2020 2020 2020 2020 5468  ..            Th
+00014830: 6520 6974 6572 6174 6f72 2069 7320 2a6e  e iterator is *n
+00014840: 6f74 2a20 6775 6172 616e 7465 6564 2074  ot* guaranteed t
+00014850: 6f20 7265 7475 726e 2074 6865 2073 616d  o return the sam
+00014860: 706c 6520 6e6f 6465 2049 4473 2069 6e0a  ple node IDs in.
+00014870: 2020 2020 2020 2020 2020 2020 6e75 6d65              nume
+00014880: 7269 6361 6c20 6f72 2061 6e79 206f 7468  rical or any oth
+00014890: 6572 2070 6172 7469 6375 6c61 7220 6f72  er particular or
+000148a0: 6465 722e 0a0a 2020 2020 2020 2020 3a70  der...        :p
+000148b0: 6172 616d 2069 6e74 2075 3a20 5468 6520  aram int u: The 
+000148c0: 6e6f 6465 206f 6620 696e 7465 7265 7374  node of interest
+000148d0: 2e0a 2020 2020 2020 2020 3a72 6574 7572  ..        :retur
+000148e0: 6e3a 2041 6e20 6974 6572 6174 6f72 206f  n: An iterator o
+000148f0: 7665 7220 616c 6c20 7361 6d70 6c65 206e  ver all sample n
+00014900: 6f64 6520 4944 7320 696e 2074 6865 2073  ode IDs in the s
+00014910: 7562 7472 6565 2072 6f6f 7465 6420 6174  ubtree rooted at
+00014920: 2075 2e0a 2020 2020 2020 2020 3a72 7479   u..        :rty
+00014930: 7065 3a20 636f 6c6c 6563 7469 6f6e 732e  pe: collections.
+00014940: 6162 632e 4974 6572 6162 6c65 0a20 2020  abc.Iterable.   
+00014950: 2020 2020 2022 2222 0a20 2020 2020 2020       """.       
+00014960: 2072 6f6f 7473 203d 205b 755d 0a20 2020   roots = [u].   
+00014970: 2020 2020 2069 6620 7520 6973 204e 6f6e       if u is Non
+00014980: 653a 0a20 2020 2020 2020 2020 2020 2072  e:.            r
+00014990: 6f6f 7473 203d 2073 656c 662e 726f 6f74  oots = self.root
+000149a0: 730a 2020 2020 2020 2020 666f 7220 726f  s.        for ro
+000149b0: 6f74 2069 6e20 726f 6f74 733a 0a20 2020  ot in roots:.   
+000149c0: 2020 2020 2020 2020 2079 6965 6c64 2066           yield f
+000149d0: 726f 6d20 7365 6c66 2e5f 7361 6d70 6c65  rom self._sample
+000149e0: 5f67 656e 6572 6174 6f72 2872 6f6f 7429  _generator(root)
+000149f0: 0a0a 2020 2020 6465 6620 6e75 6d5f 6368  ..    def num_ch
+00014a00: 696c 6472 656e 2873 656c 662c 2075 293a  ildren(self, u):
+00014a10: 0a20 2020 2020 2020 2022 2222 0a20 2020  .        """.   
+00014a20: 2020 2020 2052 6574 7572 6e73 2074 6865       Returns the
+00014a30: 206e 756d 6265 7220 6f66 2063 6869 6c64   number of child
+00014a40: 7265 6e20 6f66 2074 6865 2073 7065 6369  ren of the speci
+00014a50: 6669 6564 0a20 2020 2020 2020 206e 6f64  fied.        nod
+00014a60: 6520 2869 2e65 2e2c 2060 606c 656e 2874  e (i.e., ``len(t
+00014a70: 7265 652e 6368 696c 6472 656e 2875 2929  ree.children(u))
+00014a80: 6060 290a 0a20 2020 2020 2020 203a 7061  ``)..        :pa
+00014a90: 7261 6d20 696e 7420 753a 2054 6865 206e  ram int u: The n
+00014aa0: 6f64 6520 6f66 2069 6e74 6572 6573 742e  ode of interest.
+00014ab0: 0a20 2020 2020 2020 203a 7265 7475 726e  .        :return
+00014ac0: 3a20 5468 6520 6e75 6d62 6572 206f 6620  : The number of 
+00014ad0: 696d 6d65 6469 6174 6520 6368 696c 6472  immediate childr
+00014ae0: 656e 206f 6620 7468 6520 6e6f 6465 2075  en of the node u
+00014af0: 2069 6e20 7468 6973 2074 7265 652e 0a20   in this tree.. 
+00014b00: 2020 2020 2020 203a 7274 7970 653a 2069         :rtype: i
+00014b10: 6e74 0a20 2020 2020 2020 2022 2222 0a20  nt.        """. 
+00014b20: 2020 2020 2020 2072 6574 7572 6e20 7365         return se
+00014b30: 6c66 2e5f 6c6c 5f74 7265 652e 6765 745f  lf._ll_tree.get_
+00014b40: 6e75 6d5f 6368 696c 6472 656e 2875 290a  num_children(u).
+00014b50: 0a20 2020 2064 6566 2067 6574 5f6e 756d  .    def get_num
+00014b60: 5f6c 6561 7665 7328 7365 6c66 2c20 7529  _leaves(self, u)
+00014b70: 3a0a 2020 2020 2020 2020 2320 4465 7072  :.        # Depr
+00014b80: 6563 6174 6564 2061 6c69 6173 2066 6f72  ecated alias for
+00014b90: 206e 756d 5f73 616d 706c 6573 2e20 5468   num_samples. Th
+00014ba0: 6520 6d65 7468 6f64 206e 616d 6520 6973  e method name is
+00014bb0: 2069 6e61 6363 7572 6174 650a 2020 2020   inaccurate.    
+00014bc0: 2020 2020 2320 6173 2074 6869 7320 7769      # as this wi
+00014bd0: 6c6c 2063 6f75 6e74 2074 6865 206e 756d  ll count the num
+00014be0: 6265 7220 6f66 2074 7261 636b 6564 205f  ber of tracked _
+00014bf0: 7361 6d70 6c65 735f 2e20 5468 6973 2069  samples_. This i
+00014c00: 7320 6f6e 6c79 2070 726f 7669 6465 6420  s only provided 
+00014c10: 746f 0a20 2020 2020 2020 2023 2061 766f  to.        # avo
+00014c20: 6964 2062 7265 616b 696e 6720 6578 6973  id breaking exis
+00014c30: 7469 6e67 2063 6f64 6520 616e 6420 7368  ting code and sh
+00014c40: 6f75 6c64 206e 6f74 2062 6520 7573 6564  ould not be used
+00014c50: 2069 6e20 6e65 7720 636f 6465 2e20 5765   in new code. We
+00014c60: 2063 6f75 6c64 0a20 2020 2020 2020 2023   could.        #
+00014c70: 2063 6861 6e67 6520 7468 6973 206d 6574   change this met
+00014c80: 686f 6420 746f 2062 6520 7365 6d61 6e74  hod to be semant
+00014c90: 6963 616c 6c79 2063 6f72 7265 6374 2061  ically correct a
+00014ca0: 6e64 206a 7573 7420 636f 756e 7420 7468  nd just count th
+00014cb0: 650a 2020 2020 2020 2020 2320 6e75 6d62  e.        # numb
+00014cc0: 6572 206f 6620 6c65 6176 6573 2077 6520  er of leaves we 
+00014cd0: 6869 7420 696e 2074 6865 206c 6561 7665  hit in the leave
+00014ce0: 7328 2920 6974 6572 6174 6f72 2e20 486f  s() iterator. Ho
+00014cf0: 7765 7665 722c 2074 6869 7320 776f 756c  wever, this woul
+00014d00: 640a 2020 2020 2020 2020 2320 6861 7665  d.        # have
+00014d10: 2074 6865 2075 6e64 6573 6972 6162 6c65   the undesirable
+00014d20: 2065 6666 6563 7420 6f66 206d 616b 696e   effect of makin
+00014d30: 6720 636f 6465 2074 6861 7420 6465 7065  g code that depe
+00014d40: 6e64 7320 6f6e 2074 6865 2063 6f6e 7374  nds on the const
+00014d50: 616e 740a 2020 2020 2020 2020 2320 7469  ant.        # ti
+00014d60: 6d65 2070 6572 666f 726d 616e 6365 206f  me performance o
+00014d70: 6620 6765 745f 6e75 6d5f 6c65 6176 6573  f get_num_leaves
+00014d80: 206d 616e 7920 7469 6d65 7320 736c 6f77   many times slow
+00014d90: 6572 2e20 536f 2c20 7468 6520 6265 7374  er. So, the best
+00014da0: 206f 7074 696f 6e0a 2020 2020 2020 2020   option.        
+00014db0: 2320 6973 2074 6f20 6c65 6176 6520 7468  # is to leave th
+00014dc0: 6973 206d 6574 686f 6420 6173 2069 732c  is method as is,
+00014dd0: 2061 6e64 2074 6f20 736c 6f77 6c79 2064   and to slowly d
+00014de0: 6570 7265 6361 7465 2069 7420 6f75 742e  eprecate it out.
+00014df0: 204f 6e63 6520 7468 6973 0a20 2020 2020   Once this.     
+00014e00: 2020 2023 2068 6173 2062 6565 6e20 7265     # has been re
+00014e10: 6d6f 7665 642c 2077 6520 6d69 6768 7420  moved, we might 
+00014e20: 6164 6420 696e 2061 2060 606e 756d 5f6c  add in a ``num_l
+00014e30: 6561 7665 7360 6020 6d65 7468 6f64 2074  eaves`` method t
+00014e40: 6861 7420 7265 7475 726e 7320 7468 650a  hat returns the.
+00014e50: 2020 2020 2020 2020 2320 6c65 6e67 7468          # length
+00014e60: 206f 6620 7468 6520 6c65 6176 6573 2829   of the leaves()
+00014e70: 2069 7465 7261 746f 7220 6173 206f 6e65   iterator as one
+00014e80: 2077 6f75 6c64 2065 7870 6563 742e 0a20   would expect.. 
+00014e90: 2020 2020 2020 2072 6574 7572 6e20 7365         return se
+00014ea0: 6c66 2e6e 756d 5f73 616d 706c 6573 2875  lf.num_samples(u
+00014eb0: 290a 0a20 2020 2064 6566 2067 6574 5f6e  )..    def get_n
+00014ec0: 756d 5f73 616d 706c 6573 2873 656c 662c  um_samples(self,
+00014ed0: 2075 3d4e 6f6e 6529 3a0a 2020 2020 2020   u=None):.      
+00014ee0: 2020 2320 4465 7072 6563 6174 6564 2061    # Deprecated a
+00014ef0: 6c69 6173 2066 6f72 206e 756d 5f73 616d  lias for num_sam
+00014f00: 706c 6573 2e0a 2020 2020 2020 2020 7265  ples..        re
+00014f10: 7475 726e 2073 656c 662e 6e75 6d5f 7361  turn self.num_sa
+00014f20: 6d70 6c65 7328 7529 0a0a 2020 2020 6465  mples(u)..    de
+00014f30: 6620 6e75 6d5f 7361 6d70 6c65 7328 7365  f num_samples(se
+00014f40: 6c66 2c20 753d 4e6f 6e65 293a 0a20 2020  lf, u=None):.   
+00014f50: 2020 2020 2022 2222 0a20 2020 2020 2020       """.       
+00014f60: 2052 6574 7572 6e73 2074 6865 206e 756d   Returns the num
+00014f70: 6265 7220 6f66 2073 616d 706c 6520 6e6f  ber of sample no
+00014f80: 6465 7320 696e 2074 6869 7320 7472 6565  des in this tree
+00014f90: 2075 6e64 6572 6e65 6174 6820 7468 6520   underneath the 
+00014fa0: 7370 6563 6966 6965 640a 2020 2020 2020  specified.      
+00014fb0: 2020 6e6f 6465 2028 696e 636c 7564 696e    node (includin
+00014fc0: 6720 7468 6520 6e6f 6465 2069 7473 656c  g the node itsel
+00014fd0: 6629 2e20 4966 2075 2069 7320 6e6f 7420  f). If u is not 
+00014fe0: 7370 6563 6966 6965 6420 7265 7475 726e  specified return
+00014ff0: 0a20 2020 2020 2020 2074 6865 2074 6f74  .        the tot
+00015000: 616c 206e 756d 6265 7220 6f66 2073 616d  al number of sam
+00015010: 706c 6573 2069 6e20 7468 6520 7472 6565  ples in the tree
+00015020: 2e0a 0a20 2020 2020 2020 2054 6869 7320  ...        This 
+00015030: 6973 2061 2063 6f6e 7374 616e 7420 7469  is a constant ti
+00015040: 6d65 206f 7065 7261 7469 6f6e 2e0a 0a20  me operation... 
+00015050: 2020 2020 2020 203a 7061 7261 6d20 696e         :param in
+00015060: 7420 753a 2054 6865 206e 6f64 6520 6f66  t u: The node of
+00015070: 2069 6e74 6572 6573 742e 0a20 2020 2020   interest..     
+00015080: 2020 203a 7265 7475 726e 3a20 5468 6520     :return: The 
+00015090: 6e75 6d62 6572 206f 6620 7361 6d70 6c65  number of sample
+000150a0: 7320 696e 2074 6865 2073 7562 7472 6565  s in the subtree
+000150b0: 2072 6f6f 7465 6420 6174 2075 2e0a 2020   rooted at u..  
+000150c0: 2020 2020 2020 3a72 7479 7065 3a20 696e        :rtype: in
+000150d0: 740a 2020 2020 2020 2020 2222 220a 2020  t.        """.  
+000150e0: 2020 2020 2020 7520 3d20 7365 6c66 2e76        u = self.v
+000150f0: 6972 7475 616c 5f72 6f6f 7420 6966 2075  irtual_root if u
+00015100: 2069 7320 4e6f 6e65 2065 6c73 6520 750a   is None else u.
+00015110: 2020 2020 2020 2020 7265 7475 726e 2073          return s
+00015120: 656c 662e 5f6c 6c5f 7472 6565 2e67 6574  elf._ll_tree.get
+00015130: 5f6e 756d 5f73 616d 706c 6573 2875 290a  _num_samples(u).
+00015140: 0a20 2020 2064 6566 2067 6574 5f6e 756d  .    def get_num
+00015150: 5f74 7261 636b 6564 5f6c 6561 7665 7328  _tracked_leaves(
+00015160: 7365 6c66 2c20 7529 3a0a 2020 2020 2020  self, u):.      
+00015170: 2020 2320 4465 7072 6563 6174 6564 2061    # Deprecated a
+00015180: 6c69 6173 2066 6f72 206e 756d 5f74 7261  lias for num_tra
+00015190: 636b 6564 5f73 616d 706c 6573 2e20 5468  cked_samples. Th
+000151a0: 6520 6d65 7468 6f64 206e 616d 6520 6973  e method name is
+000151b0: 2069 6e61 6363 7572 6174 650a 2020 2020   inaccurate.    
+000151c0: 2020 2020 2320 6173 2074 6869 7320 7769      # as this wi
+000151d0: 6c6c 2063 6f75 6e74 2074 6865 206e 756d  ll count the num
+000151e0: 6265 7220 6f66 2074 7261 636b 6564 205f  ber of tracked _
+000151f0: 7361 6d70 6c65 735f 2e20 5468 6973 2069  samples_. This i
+00015200: 7320 6f6e 6c79 2070 726f 7669 6465 6420  s only provided 
+00015210: 746f 0a20 2020 2020 2020 2023 2061 766f  to.        # avo
+00015220: 6964 2062 7265 616b 696e 6720 6578 6973  id breaking exis
+00015230: 7469 6e67 2063 6f64 6520 616e 6420 7368  ting code and sh
+00015240: 6f75 6c64 206e 6f74 2062 6520 7573 6564  ould not be used
+00015250: 2069 6e20 6e65 7720 636f 6465 2e0a 2020   in new code..  
+00015260: 2020 2020 2020 7265 7475 726e 2073 656c        return sel
+00015270: 662e 6e75 6d5f 7472 6163 6b65 645f 7361  f.num_tracked_sa
+00015280: 6d70 6c65 7328 7529 0a0a 2020 2020 6465  mples(u)..    de
+00015290: 6620 6765 745f 6e75 6d5f 7472 6163 6b65  f get_num_tracke
+000152a0: 645f 7361 6d70 6c65 7328 7365 6c66 2c20  d_samples(self, 
+000152b0: 753d 4e6f 6e65 293a 0a20 2020 2020 2020  u=None):.       
+000152c0: 2023 2044 6570 7265 6361 7465 6420 616c   # Deprecated al
+000152d0: 6961 7320 666f 7220 6e75 6d5f 7472 6163  ias for num_trac
+000152e0: 6b65 645f 7361 6d70 6c65 730a 2020 2020  ked_samples.    
+000152f0: 2020 2020 7265 7475 726e 2073 656c 662e      return self.
+00015300: 6e75 6d5f 7472 6163 6b65 645f 7361 6d70  num_tracked_samp
+00015310: 6c65 7328 7529 0a0a 2020 2020 6465 6620  les(u)..    def 
+00015320: 6e75 6d5f 7472 6163 6b65 645f 7361 6d70  num_tracked_samp
+00015330: 6c65 7328 7365 6c66 2c20 753d 4e6f 6e65  les(self, u=None
+00015340: 293a 0a20 2020 2020 2020 2022 2222 0a20  ):.        """. 
+00015350: 2020 2020 2020 2052 6574 7572 6e73 2074         Returns t
+00015360: 6865 206e 756d 6265 7220 6f66 2073 616d  he number of sam
+00015370: 706c 6573 2069 6e20 7468 6520 7365 7420  ples in the set 
+00015380: 7370 6563 6966 6965 6420 696e 2074 6865  specified in the
+00015390: 0a20 2020 2020 2020 2060 6074 7261 636b  .        ``track
+000153a0: 6564 5f73 616d 706c 6573 6060 2070 6172  ed_samples`` par
+000153b0: 616d 6574 6572 206f 6620 7468 6520 3a6d  ameter of the :m
+000153c0: 6574 683a 6054 7265 6553 6571 7565 6e63  eth:`TreeSequenc
+000153d0: 652e 7472 6565 7360 206d 6574 686f 640a  e.trees` method.
+000153e0: 2020 2020 2020 2020 756e 6465 726e 6561          undernea
+000153f0: 7468 2074 6865 2073 7065 6369 6669 6564  th the specified
+00015400: 206e 6f64 652e 2049 6620 7468 6520 696e   node. If the in
+00015410: 7075 7420 6e6f 6465 2069 7320 6e6f 7420  put node is not 
+00015420: 7370 6563 6966 6965 642c 0a20 2020 2020  specified,.     
+00015430: 2020 2072 6574 7572 6e20 7468 6520 746f     return the to
+00015440: 7461 6c20 6e75 6d62 6572 206f 6620 7472  tal number of tr
+00015450: 6163 6b65 6420 7361 6d70 6c65 7320 696e  acked samples in
+00015460: 2074 6865 2074 7265 652e 0a0a 2020 2020   the tree...    
+00015470: 2020 2020 5468 6973 2069 7320 6120 636f      This is a co
+00015480: 6e73 7461 6e74 2074 696d 6520 6f70 6572  nstant time oper
+00015490: 6174 696f 6e2e 0a0a 2020 2020 2020 2020  ation...        
+000154a0: 3a70 6172 616d 2069 6e74 2075 3a20 5468  :param int u: Th
+000154b0: 6520 6e6f 6465 206f 6620 696e 7465 7265  e node of intere
+000154c0: 7374 2e0a 2020 2020 2020 2020 3a72 6574  st..        :ret
+000154d0: 7572 6e3a 2054 6865 206e 756d 6265 7220  urn: The number 
+000154e0: 6f66 2073 616d 706c 6573 2077 6974 6869  of samples withi
+000154f0: 6e20 7468 6520 7365 7420 6f66 2074 7261  n the set of tra
+00015500: 636b 6564 2073 616d 706c 6573 2069 6e0a  cked samples in.
+00015510: 2020 2020 2020 2020 2020 2020 7468 6520              the 
+00015520: 7375 6274 7265 6520 726f 6f74 6564 2061  subtree rooted a
+00015530: 7420 752e 0a20 2020 2020 2020 203a 7274  t u..        :rt
+00015540: 7970 653a 2069 6e74 0a20 2020 2020 2020  ype: int.       
+00015550: 2022 2222 0a20 2020 2020 2020 2075 203d   """.        u =
+00015560: 2073 656c 662e 7669 7274 7561 6c5f 726f   self.virtual_ro
+00015570: 6f74 2069 6620 7520 6973 204e 6f6e 6520  ot if u is None 
+00015580: 656c 7365 2075 0a20 2020 2020 2020 2072  else u.        r
+00015590: 6574 7572 6e20 7365 6c66 2e5f 6c6c 5f74  eturn self._ll_t
+000155a0: 7265 652e 6765 745f 6e75 6d5f 7472 6163  ree.get_num_trac
+000155b0: 6b65 645f 7361 6d70 6c65 7328 7529 0a0a  ked_samples(u)..
+000155c0: 2020 2020 6465 6620 7072 656f 7264 6572      def preorder
+000155d0: 2873 656c 662c 2075 3d4e 554c 4c29 3a0a  (self, u=NULL):.
+000155e0: 2020 2020 2020 2020 2222 220a 2020 2020          """.    
+000155f0: 2020 2020 5265 7475 726e 7320 6120 6e75      Returns a nu
+00015600: 6d70 7920 6172 7261 7920 6f66 206e 6f64  mpy array of nod
+00015610: 6520 6964 7320 696e 2060 7072 656f 7264  e ids in `preord
+00015620: 6572 0a20 2020 2020 2020 203c 6874 7470  er.        <http
+00015630: 733a 2f2f 656e 2e77 696b 6970 6564 6961  s://en.wikipedia
+00015640: 2e6f 7267 2f77 696b 692f 5472 6565 5f74  .org/wiki/Tree_t
+00015650: 7261 7665 7273 616c 2350 7265 2d6f 7264  raversal#Pre-ord
+00015660: 6572 5f28 4e4c 5229 3e60 5f2e 2049 6620  er_(NLR)>`_. If 
+00015670: 7468 6520 6e6f 6465 2075 0a20 2020 2020  the node u.     
+00015680: 2020 2069 7320 7370 6563 6966 6965 6420     is specified 
+00015690: 7468 6520 7472 6176 6572 7361 6c20 6973  the traversal is
+000156a0: 2072 6f6f 7465 6420 6174 2074 6869 7320   rooted at this 
+000156b0: 6e6f 6465 2028 616e 6420 6974 2077 696c  node (and it wil
+000156c0: 6c20 6265 2074 6865 2066 6972 7374 0a20  l be the first. 
+000156d0: 2020 2020 2020 2065 6c65 6d65 6e74 2069         element i
+000156e0: 6e20 7468 6520 7265 7475 726e 6564 2061  n the returned a
+000156f0: 7272 6179 292e 204f 7468 6572 7769 7365  rray). Otherwise
+00015700: 2c20 616c 6c20 6e6f 6465 7320 7265 6163  , all nodes reac
+00015710: 6861 626c 6520 6672 6f6d 2074 6865 2074  hable from the t
+00015720: 7265 650a 2020 2020 2020 2020 726f 6f74  ree.        root
+00015730: 7320 7769 6c6c 2062 6520 7265 7475 726e  s will be return
+00015740: 6564 2e20 5365 6520 3a72 6566 3a60 7475  ed. See :ref:`tu
+00015750: 746f 7269 616c 733a 7365 635f 616e 616c  torials:sec_anal
+00015760: 7973 696e 675f 7472 6565 735f 7472 6176  ysing_trees_trav
+00015770: 6572 7361 6c73 6020 666f 720a 2020 2020  ersals` for.    
+00015780: 2020 2020 6578 616d 706c 6573 2e0a 0a20      examples... 
+00015790: 2020 2020 2020 203a 7061 7261 6d20 696e         :param in
+000157a0: 7420 753a 2049 6620 7370 6563 6966 6965  t u: If specifie
+000157b0: 642c 2072 6574 7572 6e20 616c 6c20 6e6f  d, return all no
+000157c0: 6465 7320 696e 2074 6865 2073 7562 7472  des in the subtr
+000157d0: 6565 2072 6f6f 7465 6420 6174 2075 0a20  ee rooted at u. 
+000157e0: 2020 2020 2020 2020 2020 2028 696e 636c             (incl
+000157f0: 7564 696e 6720 7529 2069 6e20 7472 6176  uding u) in trav
+00015800: 6572 7361 6c20 6f72 6465 722e 0a20 2020  ersal order..   
+00015810: 2020 2020 203a 7265 7475 726e 3a20 4172       :return: Ar
+00015820: 7261 7920 6f66 206e 6f64 6520 6964 730a  ray of node ids.
+00015830: 2020 2020 2020 2020 3a72 7479 7065 3a20          :rtype: 
+00015840: 6e75 6d70 792e 6e64 6172 7261 7920 2864  numpy.ndarray (d
+00015850: 7479 7065 3d6e 702e 696e 7433 3229 0a20  type=np.int32). 
+00015860: 2020 2020 2020 2022 2222 0a20 2020 2020         """.     
+00015870: 2020 2072 6574 7572 6e20 7365 6c66 2e5f     return self._
+00015880: 6c6c 5f74 7265 652e 6765 745f 7072 656f  ll_tree.get_preo
+00015890: 7264 6572 2875 290a 0a20 2020 2064 6566  rder(u)..    def
+000158a0: 2070 6f73 746f 7264 6572 2873 656c 662c   postorder(self,
+000158b0: 2075 3d4e 554c 4c29 3a0a 2020 2020 2020   u=NULL):.      
+000158c0: 2020 2222 220a 2020 2020 2020 2020 5265    """.        Re
+000158d0: 7475 726e 7320 6120 6e75 6d70 7920 6172  turns a numpy ar
+000158e0: 7261 7920 6f66 206e 6f64 6520 6964 7320  ray of node ids 
+000158f0: 696e 2060 706f 7374 6f72 6465 720a 2020  in `postorder.  
+00015900: 2020 2020 2020 3c68 7474 7073 3a2f 2f65        <https://e
+00015910: 6e2e 7769 6b69 7065 6469 612e 6f72 672f  n.wikipedia.org/
+00015920: 7769 6b69 2f54 7265 655f 7472 6176 6572  wiki/Tree_traver
+00015930: 7361 6c23 2350 6f73 742d 6f72 6465 725f  sal##Post-order_
+00015940: 284c 524e 293e 605f 2e20 4966 2074 6865  (LRN)>`_. If the
+00015950: 206e 6f64 6520 750a 2020 2020 2020 2020   node u.        
+00015960: 6973 2073 7065 6369 6669 6564 2074 6865  is specified the
+00015970: 2074 7261 7665 7273 616c 2069 7320 726f   traversal is ro
+00015980: 6f74 6564 2061 7420 7468 6973 206e 6f64  oted at this nod
+00015990: 6520 2861 6e64 2069 7420 7769 6c6c 2062  e (and it will b
+000159a0: 6520 7468 6520 6c61 7374 0a20 2020 2020  e the last.     
+000159b0: 2020 2065 6c65 6d65 6e74 2069 6e20 7468     element in th
+000159c0: 6520 7265 7475 726e 6564 2061 7272 6179  e returned array
+000159d0: 292e 204f 7468 6572 7769 7365 2c20 616c  ). Otherwise, al
+000159e0: 6c20 6e6f 6465 7320 7265 6163 6861 626c  l nodes reachabl
+000159f0: 6520 6672 6f6d 2074 6865 2074 7265 650a  e from the tree.
+00015a00: 2020 2020 2020 2020 726f 6f74 7320 7769          roots wi
+00015a10: 6c6c 2062 6520 7265 7475 726e 6564 2e20  ll be returned. 
+00015a20: 5365 6520 3a72 6566 3a60 7475 746f 7269  See :ref:`tutori
+00015a30: 616c 733a 7365 635f 616e 616c 7973 696e  als:sec_analysin
+00015a40: 675f 7472 6565 735f 7472 6176 6572 7361  g_trees_traversa
+00015a50: 6c73 6020 666f 720a 2020 2020 2020 2020  ls` for.        
+00015a60: 6578 616d 706c 6573 2e0a 0a20 2020 2020  examples...     
+00015a70: 2020 203a 7061 7261 6d20 696e 7420 753a     :param int u:
+00015a80: 2049 6620 7370 6563 6966 6965 642c 2072   If specified, r
+00015a90: 6574 7572 6e20 616c 6c20 6e6f 6465 7320  eturn all nodes 
+00015aa0: 696e 2074 6865 2073 7562 7472 6565 2072  in the subtree r
+00015ab0: 6f6f 7465 6420 6174 2075 0a20 2020 2020  ooted at u.     
+00015ac0: 2020 2020 2020 2028 696e 636c 7564 696e         (includin
+00015ad0: 6720 7529 2069 6e20 7472 6176 6572 7361  g u) in traversa
+00015ae0: 6c20 6f72 6465 722e 0a20 2020 2020 2020  l order..       
+00015af0: 203a 7265 7475 726e 3a20 4172 7261 7920   :return: Array 
+00015b00: 6f66 206e 6f64 6520 6964 730a 2020 2020  of node ids.    
+00015b10: 2020 2020 3a72 7479 7065 3a20 6e75 6d70      :rtype: nump
+00015b20: 792e 6e64 6172 7261 7920 2864 7479 7065  y.ndarray (dtype
+00015b30: 3d6e 702e 696e 7433 3229 0a20 2020 2020  =np.int32).     
+00015b40: 2020 2022 2222 0a20 2020 2020 2020 2072     """.        r
+00015b50: 6574 7572 6e20 7365 6c66 2e5f 6c6c 5f74  eturn self._ll_t
+00015b60: 7265 652e 6765 745f 706f 7374 6f72 6465  ree.get_postorde
+00015b70: 7228 7529 0a0a 2020 2020 6465 6620 7469  r(u)..    def ti
+00015b80: 6d65 6173 6328 7365 6c66 2c20 753d 4e55  measc(self, u=NU
+00015b90: 4c4c 293a 0a20 2020 2020 2020 2022 2222  LL):.        """
+00015ba0: 0a20 2020 2020 2020 2052 6574 7572 6e73  .        Returns
+00015bb0: 2061 206e 756d 7079 2061 7272 6179 206f   a numpy array o
+00015bc0: 6620 6e6f 6465 2069 6473 2e20 5374 6172  f node ids. Star
+00015bd0: 7469 6e67 2061 7420 6075 602c 2072 6574  ting at `u`, ret
+00015be0: 7572 6e73 2074 6865 2072 6561 6368 6162  urns the reachab
+00015bf0: 6c65 0a20 2020 2020 2020 2064 6573 6365  le.        desce
+00015c00: 6e64 616e 7420 6e6f 6465 7320 696e 206f  ndant nodes in o
+00015c10: 7264 6572 206f 6620 696e 6372 6561 7369  rder of increasi
+00015c20: 6e67 2074 696d 6520 286d 6f73 7420 7265  ng time (most re
+00015c30: 6365 6e74 2066 6972 7374 292c 2066 616c  cent first), fal
+00015c40: 6c69 6e67 2062 6163 6b0a 2020 2020 2020  ling back.      
+00015c50: 2020 746f 2069 6e63 7265 6173 696e 6720    to increasing 
+00015c60: 4944 2069 6620 7469 6d65 7320 6172 6520  ID if times are 
+00015c70: 6571 7561 6c2e 2041 6c73 6f20 7365 650a  equal. Also see.
+00015c80: 2020 2020 2020 2020 3a72 6566 3a60 7475          :ref:`tu
+00015c90: 746f 7269 616c 733a 7365 635f 616e 616c  torials:sec_anal
+00015ca0: 7973 696e 675f 7472 6565 735f 7472 6176  ysing_trees_trav
+00015cb0: 6572 7361 6c73 6020 666f 7220 6578 616d  ersals` for exam
+00015cc0: 706c 6573 206f 6620 686f 7720 746f 2075  ples of how to u
+00015cd0: 7365 0a20 2020 2020 2020 2074 7261 7665  se.        trave
+00015ce0: 7273 616c 732e 0a0a 2020 2020 2020 2020  rsals...        
+00015cf0: 3a70 6172 616d 2069 6e74 2075 3a20 4966  :param int u: If
+00015d00: 2073 7065 6369 6669 6564 2c20 7265 7475   specified, retu
+00015d10: 726e 2061 6c6c 206e 6f64 6573 2069 6e20  rn all nodes in 
+00015d20: 7468 6520 7375 6274 7265 6520 726f 6f74  the subtree root
+00015d30: 6564 2061 7420 750a 2020 2020 2020 2020  ed at u.        
+00015d40: 2020 2020 2869 6e63 6c75 6469 6e67 2075      (including u
+00015d50: 2920 696e 2074 7261 7665 7273 616c 206f  ) in traversal o
+00015d60: 7264 6572 2e0a 2020 2020 2020 2020 3a72  rder..        :r
+00015d70: 6574 7572 6e3a 2041 7272 6179 206f 6620  eturn: Array of 
+00015d80: 6e6f 6465 2069 6473 0a20 2020 2020 2020  node ids.       
+00015d90: 203a 7274 7970 653a 206e 756d 7079 2e6e   :rtype: numpy.n
+00015da0: 6461 7272 6179 2028 6474 7970 653d 6e70  darray (dtype=np
+00015db0: 2e69 6e74 3332 290a 2020 2020 2020 2020  .int32).        
+00015dc0: 2222 220a 2020 2020 2020 2020 6e6f 6465  """.        node
+00015dd0: 7320 3d20 7365 6c66 2e70 7265 6f72 6465  s = self.preorde
+00015de0: 7228 7529 0a20 2020 2020 2020 2069 735f  r(u).        is_
+00015df0: 7669 7274 7561 6c5f 726f 6f74 203d 2075  virtual_root = u
+00015e00: 203d 3d20 7365 6c66 2e76 6972 7475 616c   == self.virtual
+00015e10: 5f72 6f6f 740a 2020 2020 2020 2020 7469  _root.        ti
+00015e20: 6d65 203d 2073 656c 662e 7472 6565 5f73  me = self.tree_s
+00015e30: 6571 7565 6e63 652e 6e6f 6465 735f 7469  equence.nodes_ti
+00015e40: 6d65 0a20 2020 2020 2020 2069 6620 6973  me.        if is
+00015e50: 5f76 6972 7475 616c 5f72 6f6f 743a 0a20  _virtual_root:. 
+00015e60: 2020 2020 2020 2020 2020 2023 2057 6520             # We 
+00015e70: 636f 756c 6420 6176 6f69 6420 6372 6561  could avoid crea
+00015e80: 7469 6e67 2074 6869 7320 6172 7261 7920  ting this array 
+00015e90: 6966 2077 6520 7761 6e74 6564 2074 6f2c  if we wanted to,
+00015ea0: 2062 7574 0a20 2020 2020 2020 2020 2020   but.           
+00015eb0: 2023 2069 7427 7320 6e6f 7420 7468 6174   # it's not that
+00015ec0: 206f 6674 656e 2070 656f 706c 6520 7769   often people wi
+00015ed0: 6c6c 2062 6520 7573 696e 6720 7468 6973  ll be using this
+00015ee0: 2077 6974 6820 7468 650a 2020 2020 2020   with the.      
+00015ef0: 2020 2020 2020 2320 7669 7274 7561 6c5f        # virtual_
+00015f00: 726f 6f74 2061 7320 616e 2061 7267 756d  root as an argum
+00015f10: 656e 742c 2073 6f20 646f 6573 6e27 7420  ent, so doesn't 
+00015f20: 7365 656d 2077 6f72 7468 0a20 2020 2020  seem worth.     
+00015f30: 2020 2020 2020 2023 2074 6865 2063 6f6d         # the com
+00015f40: 706c 6578 6974 790a 2020 2020 2020 2020  plexity.        
+00015f50: 2020 2020 7469 6d65 203d 206e 702e 6170      time = np.ap
+00015f60: 7065 6e64 2874 696d 652c 205b 6e70 2e69  pend(time, [np.i
+00015f70: 6e66 5d29 0a20 2020 2020 2020 206f 7264  nf]).        ord
+00015f80: 6572 203d 206e 702e 6c65 7873 6f72 7428  er = np.lexsort(
+00015f90: 5b6e 6f64 6573 2c20 7469 6d65 5b6e 6f64  [nodes, time[nod
+00015fa0: 6573 5d5d 290a 2020 2020 2020 2020 7265  es]]).        re
+00015fb0: 7475 726e 206e 6f64 6573 5b6f 7264 6572  turn nodes[order
+00015fc0: 5d0a 0a20 2020 2064 6566 2074 696d 6564  ]..    def timed
+00015fd0: 6573 6328 7365 6c66 2c20 753d 4e55 4c4c  esc(self, u=NULL
+00015fe0: 293a 0a20 2020 2020 2020 2022 2222 0a20  ):.        """. 
+00015ff0: 2020 2020 2020 2052 6574 7572 6e73 2061         Returns a
+00016000: 206e 756d 7079 2061 7272 6179 206f 6620   numpy array of 
+00016010: 6e6f 6465 2069 6473 2e20 5374 6172 7469  node ids. Starti
+00016020: 6e67 2061 7420 6075 602c 2072 6574 7572  ng at `u`, retur
+00016030: 6e73 2074 6865 2072 6561 6368 6162 6c65  ns the reachable
+00016040: 0a20 2020 2020 2020 2064 6573 6365 6e64  .        descend
+00016050: 616e 7420 6e6f 6465 7320 696e 206f 7264  ant nodes in ord
+00016060: 6572 206f 6620 6465 6372 6561 7369 6e67  er of decreasing
+00016070: 2074 696d 6520 286c 6561 7374 2072 6563   time (least rec
+00016080: 656e 7420 6669 7273 7429 2c20 6661 6c6c  ent first), fall
+00016090: 696e 6720 6261 636b 0a20 2020 2020 2020  ing back.       
+000160a0: 2074 6f20 6465 6372 6561 7369 6e67 2049   to decreasing I
+000160b0: 4420 6966 2074 696d 6573 2061 7265 2065  D if times are e
+000160c0: 7175 616c 2e20 416c 736f 2073 6565 0a20  qual. Also see. 
+000160d0: 2020 2020 2020 203a 7265 663a 6074 7574         :ref:`tut
+000160e0: 6f72 6961 6c73 3a73 6563 5f61 6e61 6c79  orials:sec_analy
+000160f0: 7369 6e67 5f74 7265 6573 5f74 7261 7665  sing_trees_trave
+00016100: 7273 616c 7360 2066 6f72 2065 7861 6d70  rsals` for examp
+00016110: 6c65 7320 6f66 2068 6f77 2074 6f20 7573  les of how to us
+00016120: 650a 2020 2020 2020 2020 7472 6176 6572  e.        traver
+00016130: 7361 6c73 2e0a 0a20 2020 2020 2020 203a  sals...        :
+00016140: 7061 7261 6d20 696e 7420 753a 2049 6620  param int u: If 
+00016150: 7370 6563 6966 6965 642c 2072 6574 7572  specified, retur
+00016160: 6e20 616c 6c20 6e6f 6465 7320 696e 2074  n all nodes in t
+00016170: 6865 2073 7562 7472 6565 2072 6f6f 7465  he subtree roote
+00016180: 6420 6174 2075 0a20 2020 2020 2020 2020  d at u.         
+00016190: 2020 2028 696e 636c 7564 696e 6720 7529     (including u)
+000161a0: 2069 6e20 7472 6176 6572 7361 6c20 6f72   in traversal or
+000161b0: 6465 722e 0a20 2020 2020 2020 203a 7265  der..        :re
+000161c0: 7475 726e 3a20 4172 7261 7920 6f66 206e  turn: Array of n
+000161d0: 6f64 6520 6964 730a 2020 2020 2020 2020  ode ids.        
+000161e0: 3a72 7479 7065 3a20 6e75 6d70 792e 6e64  :rtype: numpy.nd
+000161f0: 6172 7261 7920 2864 7479 7065 3d6e 702e  array (dtype=np.
+00016200: 696e 7433 3229 0a20 2020 2020 2020 2022  int32).        "
+00016210: 2222 0a20 2020 2020 2020 2072 6574 7572  "".        retur
+00016220: 6e20 7365 6c66 2e74 696d 6561 7363 2875  n self.timeasc(u
+00016230: 295b 3a3a 2d31 5d0a 0a20 2020 2064 6566  )[::-1]..    def
+00016240: 205f 7072 656f 7264 6572 5f74 7261 7665   _preorder_trave
+00016250: 7273 616c 2873 656c 662c 2072 6f6f 7429  rsal(self, root)
+00016260: 3a0a 2020 2020 2020 2020 2320 5265 7475  :.        # Retu
+00016270: 726e 2050 7974 686f 6e20 696e 7465 6765  rn Python intege
+00016280: 7273 2066 6f72 2063 6f6d 7061 7469 6269  rs for compatibi
+00016290: 6c69 7479 0a20 2020 2020 2020 2072 6574  lity.        ret
+000162a0: 7572 6e20 6d61 7028 696e 742c 2073 656c  urn map(int, sel
+000162b0: 662e 7072 656f 7264 6572 2872 6f6f 7429  f.preorder(root)
+000162c0: 290a 0a20 2020 2064 6566 205f 706f 7374  )..    def _post
+000162d0: 6f72 6465 725f 7472 6176 6572 7361 6c28  order_traversal(
+000162e0: 7365 6c66 2c20 726f 6f74 293a 0a20 2020  self, root):.   
+000162f0: 2020 2020 2023 2052 6574 7572 6e20 5079       # Return Py
+00016300: 7468 6f6e 2069 6e74 6567 6572 7320 666f  thon integers fo
+00016310: 7220 636f 6d70 6174 6962 696c 6974 790a  r compatibility.
+00016320: 2020 2020 2020 2020 7265 7475 726e 206d          return m
+00016330: 6170 2869 6e74 2c20 7365 6c66 2e70 6f73  ap(int, self.pos
+00016340: 746f 7264 6572 2872 6f6f 7429 290a 0a20  torder(root)).. 
+00016350: 2020 2064 6566 205f 696e 6f72 6465 725f     def _inorder_
+00016360: 7472 6176 6572 7361 6c28 7365 6c66 2c20  traversal(self, 
+00016370: 726f 6f74 293a 0a20 2020 2020 2020 2023  root):.        #
+00016380: 2054 4f44 4f20 6164 6420 6120 6e6f 6e72   TODO add a nonr
+00016390: 6563 7572 7369 7665 2076 6572 7369 6f6e  ecursive version
+000163a0: 206f 6620 7468 6520 696e 6f72 6465 7220   of the inorder 
+000163b0: 7472 6176 6572 7361 6c2e 0a0a 2020 2020  traversal...    
+000163c0: 2020 2020 6465 6620 7472 6176 6572 7365      def traverse
+000163d0: 2875 293a 0a20 2020 2020 2020 2020 2020  (u):.           
+000163e0: 2063 6869 6c64 7265 6e20 3d20 7365 6c66   children = self
+000163f0: 2e67 6574 5f63 6869 6c64 7265 6e28 7529  .get_children(u)
+00016400: 0a20 2020 2020 2020 2020 2020 206d 6964  .            mid
+00016410: 203d 206c 656e 2863 6869 6c64 7265 6e29   = len(children)
+00016420: 202f 2f20 320a 2020 2020 2020 2020 2020   // 2.          
+00016430: 2020 666f 7220 6320 696e 2063 6869 6c64    for c in child
+00016440: 7265 6e5b 3a6d 6964 5d3a 0a20 2020 2020  ren[:mid]:.     
+00016450: 2020 2020 2020 2020 2020 2079 6965 6c64             yield
+00016460: 2066 726f 6d20 7472 6176 6572 7365 2863   from traverse(c
+00016470: 290a 2020 2020 2020 2020 2020 2020 7969  ).            yi
+00016480: 656c 6420 750a 2020 2020 2020 2020 2020  eld u.          
+00016490: 2020 666f 7220 6320 696e 2063 6869 6c64    for c in child
+000164a0: 7265 6e5b 6d69 643a 5d3a 0a20 2020 2020  ren[mid:]:.     
+000164b0: 2020 2020 2020 2020 2020 2079 6965 6c64             yield
+000164c0: 2066 726f 6d20 7472 6176 6572 7365 2863   from traverse(c
+000164d0: 290a 0a20 2020 2020 2020 2072 6f6f 7473  )..        roots
+000164e0: 203d 2073 656c 662e 726f 6f74 7320 6966   = self.roots if
+000164f0: 2072 6f6f 7420 3d3d 204e 554c 4c20 656c   root == NULL el
+00016500: 7365 205b 726f 6f74 5d0a 2020 2020 2020  se [root].      
+00016510: 2020 666f 7220 726f 6f74 2069 6e20 726f    for root in ro
+00016520: 6f74 733a 0a20 2020 2020 2020 2020 2020  ots:.           
+00016530: 2079 6965 6c64 2066 726f 6d20 7472 6176   yield from trav
+00016540: 6572 7365 2872 6f6f 7429 0a0a 2020 2020  erse(root)..    
+00016550: 6465 6620 5f6c 6576 656c 6f72 6465 725f  def _levelorder_
+00016560: 7472 6176 6572 7361 6c28 7365 6c66 2c20  traversal(self, 
+00016570: 726f 6f74 293a 0a20 2020 2020 2020 2072  root):.        r
+00016580: 6f6f 7473 203d 2073 656c 662e 726f 6f74  oots = self.root
+00016590: 7320 6966 2072 6f6f 7420 3d3d 204e 554c  s if root == NUL
+000165a0: 4c20 656c 7365 205b 726f 6f74 5d0a 2020  L else [root].  
+000165b0: 2020 2020 2020 7175 6575 6520 3d20 636f        queue = co
+000165c0: 6c6c 6563 7469 6f6e 732e 6465 7175 6528  llections.deque(
+000165d0: 726f 6f74 7329 0a20 2020 2020 2020 2023  roots).        #
+000165e0: 2046 6f72 2070 6572 6620 7765 2073 746f   For perf we sto
+000165f0: 7265 2074 6865 7365 2074 6f20 6176 6f69  re these to avoi
+00016600: 6420 6c6f 6f6b 7570 7320 696e 2074 6865  d lookups in the
+00016610: 2074 6967 6874 206c 6f6f 700a 2020 2020   tight loop.    
+00016620: 2020 2020 706f 7020 3d20 7175 6575 652e      pop = queue.
+00016630: 706f 706c 6566 740a 2020 2020 2020 2020  popleft.        
+00016640: 6578 7465 6e64 203d 2071 7565 7565 2e65  extend = queue.e
+00016650: 7874 656e 640a 2020 2020 2020 2020 6368  xtend.        ch
+00016660: 696c 6472 656e 203d 2073 656c 662e 6368  ildren = self.ch
+00016670: 696c 6472 656e 0a20 2020 2020 2020 2023  ildren.        #
+00016680: 204e 6f74 653a 2074 6865 2075 7375 616c   Note: the usual
+00016690: 2073 7479 6c65 2069 7320 746f 2062 6520   style is to be 
+000166a0: 6578 706c 6963 6974 2061 626f 7574 2077  explicit about w
+000166b0: 6861 7420 7765 2772 6520 7465 7374 696e  hat we're testin
+000166c0: 670a 2020 2020 2020 2020 2320 616e 6420  g.        # and 
+000166d0: 7573 6520 7768 696c 6520 6c65 6e28 7175  use while len(qu
+000166e0: 6575 6529 203e 2030 2c20 6275 7420 7468  eue) > 0, but th
+000166f0: 6973 2066 6f72 6d20 6973 2073 6c69 6768  is form is sligh
+00016700: 746c 7920 6661 7374 6572 2e0a 2020 2020  tly faster..    
+00016710: 2020 2020 7768 696c 6520 7175 6575 653a      while queue:
+00016720: 0a20 2020 2020 2020 2020 2020 2076 203d  .            v =
+00016730: 2070 6f70 2829 0a20 2020 2020 2020 2020   pop().         
+00016740: 2020 2065 7874 656e 6428 6368 696c 6472     extend(childr
+00016750: 656e 2876 2929 0a20 2020 2020 2020 2020  en(v)).         
+00016760: 2020 2079 6965 6c64 2076 0a0a 2020 2020     yield v..    
+00016770: 6465 6620 5f74 696d 6561 7363 5f74 7261  def _timeasc_tra
+00016780: 7665 7273 616c 2873 656c 662c 2072 6f6f  versal(self, roo
+00016790: 7429 3a0a 2020 2020 2020 2020 2222 220a  t):.        """.
+000167a0: 2020 2020 2020 2020 536f 7274 7320 6279          Sorts by
+000167b0: 2069 6e63 7265 6173 696e 6720 7469 6d65   increasing time
+000167c0: 2062 7574 2066 616c 6c73 2062 6163 6b20   but falls back 
+000167d0: 746f 2069 6e63 7265 6173 696e 6720 4944  to increasing ID
+000167e0: 2066 6f72 2065 7175 616c 2074 696d 6573   for equal times
+000167f0: 2e0a 2020 2020 2020 2020 2222 220a 2020  ..        """.  
+00016800: 2020 2020 2020 7265 7475 726e 206d 6170        return map
+00016810: 2869 6e74 2c20 7365 6c66 2e74 696d 6561  (int, self.timea
+00016820: 7363 2872 6f6f 7429 290a 0a20 2020 2064  sc(root))..    d
+00016830: 6566 205f 7469 6d65 6465 7363 5f74 7261  ef _timedesc_tra
+00016840: 7665 7273 616c 2873 656c 662c 2072 6f6f  versal(self, roo
+00016850: 7429 3a0a 2020 2020 2020 2020 2222 220a  t):.        """.
+00016860: 2020 2020 2020 2020 5468 6520 7265 7665          The reve
+00016870: 7273 6520 6f66 2074 696d 6561 7363 2e0a  rse of timeasc..
+00016880: 2020 2020 2020 2020 2222 220a 2020 2020          """.    
+00016890: 2020 2020 7265 7475 726e 206d 6170 2869      return map(i
+000168a0: 6e74 2c20 7365 6c66 2e74 696d 6564 6573  nt, self.timedes
+000168b0: 6328 726f 6f74 2929 0a0a 2020 2020 6465  c(root))..    de
+000168c0: 6620 5f6d 696e 6c65 785f 706f 7374 6f72  f _minlex_postor
+000168d0: 6465 725f 7472 6176 6572 7361 6c28 7365  der_traversal(se
+000168e0: 6c66 2c20 726f 6f74 293a 0a20 2020 2020  lf, root):.     
+000168f0: 2020 2022 2222 0a20 2020 2020 2020 2050     """.        P
+00016900: 6f73 746f 7264 6572 2074 7261 7665 7273  ostorder travers
+00016910: 616c 2074 6861 7420 7669 7369 7473 206c  al that visits l
+00016920: 6561 7665 7320 696e 206d 696e 696d 756d  eaves in minimum
+00016930: 206c 6578 6963 6f67 7261 7068 6963 206f   lexicographic o
+00016940: 7264 6572 2e0a 0a20 2020 2020 2020 204d  rder...        M
+00016950: 696e 6c65 7820 7374 616e 6473 2066 6f72  inlex stands for
+00016960: 206d 696e 696d 756d 206c 6578 6963 6f67   minimum lexicog
+00016970: 7261 7068 6963 2e20 5765 2077 6973 6820  raphic. We wish 
+00016980: 746f 2076 6973 6974 2061 2074 7265 6520  to visit a tree 
+00016990: 696e 2073 7563 680a 2020 2020 2020 2020  in such.        
+000169a0: 6120 7761 7920 7468 6174 2074 6865 206c  a way that the l
+000169b0: 6561 7665 7320 7669 7369 7465 642c 2077  eaves visited, w
+000169c0: 6865 6e20 7468 6569 7220 4944 7320 6172  hen their IDs ar
+000169d0: 6520 6c69 7374 6564 206f 7574 2c20 6861  e listed out, ha
+000169e0: 7665 0a20 2020 2020 2020 206d 696e 696d  ve.        minim
+000169f0: 756d 206c 6578 6963 6f67 7261 7068 6963  um lexicographic
+00016a00: 206f 7264 6572 2e20 5468 6973 2069 7320   order. This is 
+00016a10: 6120 7573 6566 756c 206f 7264 6572 696e  a useful orderin
+00016a20: 6720 666f 7220 6472 6177 696e 670a 2020  g for drawing.  
+00016a30: 2020 2020 2020 6d75 6c74 6970 6c65 2054        multiple T
+00016a40: 7265 6573 206f 6620 6120 5472 6565 5365  rees of a TreeSe
+00016a50: 7175 656e 6365 2c20 6173 2069 7420 6c65  quence, as it le
+00016a60: 6164 7320 746f 206d 6f72 6520 636f 6e73  ads to more cons
+00016a70: 6973 7465 6e63 790a 2020 2020 2020 2020  istency.        
+00016a80: 6265 7477 6565 6e20 6164 6a61 6365 6e74  between adjacent
+00016a90: 2054 7265 6573 2e0a 2020 2020 2020 2020   Trees..        
+00016aa0: 2222 220a 0a20 2020 2020 2020 2023 2057  """..        # W
+00016ab0: 6520 636f 6d70 7574 6520 6120 6469 6374  e compute a dict
+00016ac0: 696f 6e61 7279 206d 6170 7069 6e67 2066  ionary mapping f
+00016ad0: 726f 6d20 696e 7465 726e 616c 206e 6f64  rom internal nod
+00016ae0: 6520 4944 2074 6f20 6d69 6e20 6c65 6166  e ID to min leaf
+00016af0: 2049 440a 2020 2020 2020 2020 2320 756e   ID.        # un
+00016b00: 6465 7220 7468 6520 6e6f 6465 2c20 7573  der the node, us
+00016b10: 696e 6720 6120 6669 7273 7420 706f 7374  ing a first post
+00016b20: 6f72 6465 7220 7472 6176 6572 7361 6c0a  order traversal.
+00016b30: 2020 2020 2020 2020 6d69 6e5f 6c65 6166          min_leaf
+00016b40: 203d 207b 7d0a 2020 2020 2020 2020 666f   = {}.        fo
+00016b50: 7220 7520 696e 2073 656c 662e 6e6f 6465  r u in self.node
+00016b60: 7328 726f 6f74 2c20 6f72 6465 723d 2270  s(root, order="p
+00016b70: 6f73 746f 7264 6572 2229 3a0a 2020 2020  ostorder"):.    
+00016b80: 2020 2020 2020 2020 6966 2073 656c 662e          if self.
+00016b90: 6973 5f6c 6561 6628 7529 3a0a 2020 2020  is_leaf(u):.    
+00016ba0: 2020 2020 2020 2020 2020 2020 6d69 6e5f              min_
+00016bb0: 6c65 6166 5b75 5d20 3d20 750a 2020 2020  leaf[u] = u.    
+00016bc0: 2020 2020 2020 2020 656c 7365 3a0a 2020          else:.  
+00016bd0: 2020 2020 2020 2020 2020 2020 2020 6d69                mi
+00016be0: 6e5f 6c65 6166 5b75 5d20 3d20 6d69 6e28  n_leaf[u] = min(
+00016bf0: 6d69 6e5f 6c65 6166 5b76 5d20 666f 7220  min_leaf[v] for 
+00016c00: 7620 696e 2073 656c 662e 6368 696c 6472  v in self.childr
+00016c10: 656e 2875 2929 0a0a 2020 2020 2020 2020  en(u))..        
+00016c20: 7374 6163 6b20 3d20 5b5d 0a0a 2020 2020  stack = []..    
+00016c30: 2020 2020 6465 6620 7075 7368 286e 6f64      def push(nod
+00016c40: 6573 293a 0a20 2020 2020 2020 2020 2020  es):.           
+00016c50: 2073 7461 636b 2e65 7874 656e 6428 736f   stack.extend(so
+00016c60: 7274 6564 286e 6f64 6573 2c20 6b65 793d  rted(nodes, key=
+00016c70: 6c61 6d62 6461 2075 3a20 6d69 6e5f 6c65  lambda u: min_le
+00016c80: 6166 5b75 5d2c 2072 6576 6572 7365 3d54  af[u], reverse=T
+00016c90: 7275 6529 290a 0a20 2020 2020 2020 2023  rue))..        #
+00016ca0: 2054 6865 2070 6f73 746f 7264 6572 2074   The postorder t
+00016cb0: 7261 7665 7273 616c 2069 736e 2774 2072  raversal isn't r
+00016cc0: 6f62 7573 7420 746f 2075 7369 6e67 2076  obust to using v
+00016cd0: 6972 7475 616c 5f72 6f6f 7420 6469 7265  irtual_root dire
+00016ce0: 6374 6c79 0a20 2020 2020 2020 2023 2061  ctly.        # a
+00016cf0: 7320 6120 6e6f 6465 2062 6563 6175 7365  s a node because
+00016d00: 2077 6520 6465 7065 6e64 206f 6e20 7472   we depend on tr
+00016d10: 6565 2e70 6172 656e 7428 2920 7265 7475  ee.parent() retu
+00016d20: 726e 696e 6720 7468 6520 6c61 7374 0a20  rning the last. 
+00016d30: 2020 2020 2020 2023 206e 6f64 6520 7765         # node we
+00016d40: 2076 6973 6974 696e 6720 6f6e 2074 6865   visiting on the
+00016d50: 2070 6174 6820 6672 6f6d 2022 726f 6f74   path from "root
+00016d60: 222e 2053 6f2c 2077 6520 7472 6561 7420  ". So, we treat 
+00016d70: 7468 6973 2061 7320 610a 2020 2020 2020  this as a.      
+00016d80: 2020 2320 7370 6563 6961 6c20 6361 7365    # special case
+00016d90: 2e0a 2020 2020 2020 2020 6973 5f76 6972  ..        is_vir
+00016da0: 7475 616c 5f72 6f6f 7420 3d20 726f 6f74  tual_root = root
+00016db0: 203d 3d20 7365 6c66 2e76 6972 7475 616c   == self.virtual
+00016dc0: 5f72 6f6f 740a 2020 2020 2020 2020 726f  _root.        ro
+00016dd0: 6f74 7320 3d20 7365 6c66 2e72 6f6f 7473  ots = self.roots
+00016de0: 2069 6620 726f 6f74 203d 3d20 2d31 206f   if root == -1 o
+00016df0: 7220 6973 5f76 6972 7475 616c 5f72 6f6f  r is_virtual_roo
+00016e00: 7420 656c 7365 205b 726f 6f74 5d0a 0a20  t else [root].. 
+00016e10: 2020 2020 2020 2070 7573 6828 726f 6f74         push(root
+00016e20: 7329 0a20 2020 2020 2020 2070 6172 656e  s).        paren
+00016e30: 7420 3d20 4e55 4c4c 0a20 2020 2020 2020  t = NULL.       
+00016e40: 2077 6869 6c65 206c 656e 2873 7461 636b   while len(stack
+00016e50: 2920 3e20 303a 0a20 2020 2020 2020 2020  ) > 0:.         
+00016e60: 2020 2076 203d 2073 7461 636b 5b2d 315d     v = stack[-1]
+00016e70: 0a20 2020 2020 2020 2020 2020 2063 6869  .            chi
+00016e80: 6c64 7265 6e20 3d20 5b5d 2069 6620 7620  ldren = [] if v 
+00016e90: 3d3d 2070 6172 656e 7420 656c 7365 2073  == parent else s
+00016ea0: 656c 662e 6368 696c 6472 656e 2876 290a  elf.children(v).
+00016eb0: 2020 2020 2020 2020 2020 2020 6966 206c              if l
+00016ec0: 656e 2863 6869 6c64 7265 6e29 203e 2030  en(children) > 0
+00016ed0: 3a0a 2020 2020 2020 2020 2020 2020 2020  :.              
+00016ee0: 2020 2320 5468 6520 6669 7273 7420 7469    # The first ti
+00016ef0: 6d65 2076 6973 6974 696e 6720 6120 6e6f  me visiting a no
+00016f00: 6465 2c20 7765 2070 7573 6820 6f6e 746f  de, we push onto
+00016f10: 2074 6865 2073 7461 636b 2069 7473 2063   the stack its c
+00016f20: 6869 6c64 7265 6e0a 2020 2020 2020 2020  hildren.        
+00016f30: 2020 2020 2020 2020 2320 696e 206f 7264          # in ord
+00016f40: 6572 206f 6620 7265 7665 7273 6520 6d69  er of reverse mi
+00016f50: 6e20 6c65 6166 2049 4420 756e 6465 7220  n leaf ID under 
+00016f60: 6561 6368 2063 6869 6c64 2e20 5468 6973  each child. This
+00016f70: 2067 7561 7261 6e74 6565 730a 2020 2020   guarantees.    
+00016f80: 2020 2020 2020 2020 2020 2020 2320 7468              # th
+00016f90: 6174 2074 6865 2065 6172 6c69 6572 2063  at the earlier c
+00016fa0: 6869 6c64 7265 6e20 7669 7369 7465 6420  hildren visited 
+00016fb0: 6861 7665 2073 6d61 6c6c 6572 206d 696e  have smaller min
+00016fc0: 206c 6561 6620 4944 2c0a 2020 2020 2020   leaf ID,.      
+00016fd0: 2020 2020 2020 2020 2020 2320 7768 6963            # whic
+00016fe0: 6820 6973 2065 7175 6976 616c 656e 7420  h is equivalent 
+00016ff0: 746f 2074 6865 206d 696e 6c65 7820 636f  to the minlex co
+00017000: 6e64 6974 696f 6e2e 0a20 2020 2020 2020  ndition..       
+00017010: 2020 2020 2020 2020 2070 7573 6828 6368           push(ch
+00017020: 696c 6472 656e 290a 2020 2020 2020 2020  ildren).        
+00017030: 2020 2020 656c 7365 3a0a 2020 2020 2020      else:.      
+00017040: 2020 2020 2020 2020 2020 2320 5468 6520            # The 
+00017050: 7365 636f 6e64 2074 696d 6520 7669 7369  second time visi
+00017060: 7469 6e67 2061 206e 6f64 652c 2077 6520  ting a node, we 
+00017070: 706f 7020 616e 6420 7969 656c 6420 6974  pop and yield it
+00017080: 2c20 616e 640a 2020 2020 2020 2020 2020  , and.          
+00017090: 2020 2020 2020 2320 7765 2075 7064 6174        # we updat
+000170a0: 6520 7468 6520 7061 7265 6e74 2076 6172  e the parent var
+000170b0: 6961 626c 650a 2020 2020 2020 2020 2020  iable.          
+000170c0: 2020 2020 2020 7061 7265 6e74 203d 2073        parent = s
+000170d0: 656c 662e 6765 745f 7061 7265 6e74 2876  elf.get_parent(v
+000170e0: 290a 2020 2020 2020 2020 2020 2020 2020  ).              
+000170f0: 2020 7969 656c 6420 7374 6163 6b2e 706f    yield stack.po
+00017100: 7028 290a 2020 2020 2020 2020 6966 2069  p().        if i
+00017110: 735f 7669 7274 7561 6c5f 726f 6f74 3a0a  s_virtual_root:.
+00017120: 2020 2020 2020 2020 2020 2020 7969 656c              yiel
+00017130: 6420 7365 6c66 2e76 6972 7475 616c 5f72  d self.virtual_r
+00017140: 6f6f 740a 0a20 2020 2064 6566 206e 6f64  oot..    def nod
+00017150: 6573 2873 656c 662c 2072 6f6f 743d 4e6f  es(self, root=No
+00017160: 6e65 2c20 6f72 6465 723d 2270 7265 6f72  ne, order="preor
+00017170: 6465 7222 293a 0a20 2020 2020 2020 2022  der"):.        "
+00017180: 2222 0a20 2020 2020 2020 2052 6574 7572  "".        Retur
+00017190: 6e73 2061 6e20 6974 6572 6174 6f72 206f  ns an iterator o
+000171a0: 7665 7220 7468 6520 6e6f 6465 2049 4473  ver the node IDs
+000171b0: 2072 6561 6368 6162 6c65 2066 726f 6d20   reachable from 
+000171c0: 7468 6520 7370 6563 6966 6965 6420 6e6f  the specified no
+000171d0: 6465 2069 6e20 7468 6973 0a20 2020 2020  de in this.     
+000171e0: 2020 2074 7265 6520 696e 2074 6865 2073     tree in the s
+000171f0: 7065 6369 6669 6564 2074 7261 7665 7273  pecified travers
+00017200: 616c 206f 7264 6572 2e0a 0a20 2020 2020  al order...     
+00017210: 2020 202e 2e20 6e6f 7465 3a3a 0a20 2020     .. note::.   
+00017220: 2020 2020 2020 2020 2055 6e6c 696b 6520           Unlike 
+00017230: 7468 6520 3a6d 6574 683a 6054 7265 6553  the :meth:`TreeS
+00017240: 6571 7565 6e63 652e 6e6f 6465 7360 206d  equence.nodes` m
+00017250: 6574 686f 642c 2074 6869 7320 6974 6572  ethod, this iter
+00017260: 6174 6f72 2070 726f 6475 6365 730a 2020  ator produces.  
+00017270: 2020 2020 2020 2020 2020 696e 7465 6765            intege
+00017280: 7220 6e6f 6465 2049 4473 2c20 6e6f 7420  r node IDs, not 
+00017290: 3a63 6c61 7373 3a60 4e6f 6465 6020 6f62  :class:`Node` ob
+000172a0: 6a65 6374 732e 0a0a 2020 2020 2020 2020  jects...        
+000172b0: 4966 2074 6865 2060 6072 6f6f 7460 6020  If the ``root`` 
+000172c0: 7061 7261 6d65 7465 7220 6973 206e 6f74  parameter is not
+000172d0: 2070 726f 7669 6465 6420 6f72 2060 604e   provided or ``N
+000172e0: 6f6e 6560 602c 2069 7465 7261 7465 206f  one``, iterate o
+000172f0: 7665 7220 616c 6c0a 2020 2020 2020 2020  ver all.        
+00017300: 6e6f 6465 7320 7265 6163 6861 626c 6520  nodes reachable 
+00017310: 6672 6f6d 2074 6865 2072 6f6f 7473 2028  from the roots (
+00017320: 7365 6520 3a61 7474 723a 6054 7265 652e  see :attr:`Tree.
+00017330: 726f 6f74 7360 2066 6f72 2064 6574 6169  roots` for detai
+00017340: 6c73 0a20 2020 2020 2020 206f 6e20 7768  ls.        on wh
+00017350: 6963 6820 6e6f 6465 7320 6172 6520 636f  ich nodes are co
+00017360: 6e73 6964 6572 6564 2072 6f6f 7473 292e  nsidered roots).
+00017370: 2049 6620 7468 6520 6060 726f 6f74 6060   If the ``root``
+00017380: 2070 6172 616d 6574 6572 0a20 2020 2020   parameter.     
+00017390: 2020 2069 7320 7072 6f76 6964 6564 2c20     is provided, 
+000173a0: 6f6e 6c79 2074 6865 206e 6f64 6573 2069  only the nodes i
+000173b0: 6e20 7468 6520 7375 6274 7265 6520 726f  n the subtree ro
+000173c0: 6f74 6564 2061 7420 7468 6973 206e 6f64  oted at this nod
+000173d0: 650a 2020 2020 2020 2020 2869 6e63 6c75  e.        (inclu
+000173e0: 6469 6e67 2074 6865 2073 7065 6369 6669  ding the specifi
+000173f0: 6564 206e 6f64 6529 2077 696c 6c20 6265  ed node) will be
+00017400: 2069 7465 7261 7465 6420 6f76 6572 2e20   iterated over. 
+00017410: 4966 2074 6865 0a20 2020 2020 2020 203a  If the.        :
+00017420: 6174 7472 3a60 2e76 6972 7475 616c 5f72  attr:`.virtual_r
+00017430: 6f6f 7460 2069 7320 7370 6563 6966 6965  oot` is specifie
+00017440: 6420 6173 2074 6865 2074 7261 7665 7273  d as the travers
+00017450: 616c 2072 6f6f 742c 2069 7420 7769 6c6c  al root, it will
+00017460: 0a20 2020 2020 2020 2062 6520 696e 636c  .        be incl
+00017470: 7564 6564 2069 6e20 7468 6520 7472 6176  uded in the trav
+00017480: 6572 7365 6420 6e6f 6465 7320 696e 2074  ersed nodes in t
+00017490: 6865 2061 7070 726f 7072 6961 7465 2070  he appropriate p
+000174a0: 6f73 6974 696f 6e0a 2020 2020 2020 2020  osition.        
+000174b0: 666f 7220 7468 6520 6769 7665 6e20 6f72  for the given or
+000174c0: 6465 7269 6e67 2e20 2853 6565 2074 6865  dering. (See the
+000174d0: 0a20 2020 2020 2020 203a 7265 663a 6074  .        :ref:`t
+000174e0: 7265 6520 726f 6f74 7320 3c73 6563 5f64  ree roots <sec_d
+000174f0: 6174 615f 6d6f 6465 6c5f 7472 6565 5f76  ata_model_tree_v
+00017500: 6972 7475 616c 5f72 6f6f 743e 6020 7365  irtual_root>` se
+00017510: 6374 696f 6e20 666f 7220 6d6f 7265 0a20  ction for more. 
+00017520: 2020 2020 2020 2069 6e66 6f72 6d61 7469         informati
+00017530: 6f6e 206f 6e20 7468 6520 7669 7274 7561  on on the virtua
+00017540: 6c20 726f 6f74 2e29 0a0a 2020 2020 2020  l root.)..      
+00017550: 2020 5468 6520 6060 6f72 6465 7260 6020    The ``order`` 
+00017560: 7061 7261 6d65 7465 7220 6465 6669 6e65  parameter define
+00017570: 7320 7468 6520 6f72 6465 7220 696e 2077  s the order in w
+00017580: 6869 6368 2074 7265 6520 6e6f 6465 7320  hich tree nodes 
+00017590: 6172 6520 7669 7369 7465 640a 2020 2020  are visited.    
+000175a0: 2020 2020 696e 2074 6865 2069 7465 7261      in the itera
+000175b0: 7469 6f6e 2028 616c 736f 2073 6565 2074  tion (also see t
+000175c0: 6865 203a 7265 663a 6073 6563 5f61 6e61  he :ref:`sec_ana
+000175d0: 6c79 7369 6e67 5f74 7265 6573 5f74 7261  lysing_trees_tra
+000175e0: 7665 7273 616c 7360 2073 6563 7469 6f6e  versals` section
+000175f0: 0a20 2020 2020 2020 2069 6e20 7468 6520  .        in the 
+00017600: 6074 7574 6f72 6961 6c73 203c 6874 7470  `tutorials <http
+00017610: 733a 2f2f 7473 6b69 742e 6465 762f 7475  s://tskit.dev/tu
+00017620: 746f 7269 616c 733e 605f 5f29 2e20 5468  torials>`__). Th
+00017630: 6520 6176 6169 6c61 626c 6520 6f72 6465  e available orde
+00017640: 7273 2061 7265 3a0a 0a20 2020 2020 2020  rs are:..       
+00017650: 202d 2027 7072 656f 7264 6572 273a 2073   - 'preorder': s
+00017660: 7461 7274 696e 6720 6174 2072 6f6f 742c  tarting at root,
+00017670: 2079 6965 6c64 2074 6865 2063 7572 7265   yield the curre
+00017680: 6e74 206e 6f64 652c 2074 6865 6e20 7265  nt node, then re
+00017690: 6375 7273 650a 2020 2020 2020 2020 2020  curse.          
+000176a0: 616e 6420 646f 2061 2070 7265 6f72 6465  and do a preorde
+000176b0: 7220 6f6e 2065 6163 6820 6368 696c 6420  r on each child 
+000176c0: 6f66 2074 6865 2063 7572 7265 6e74 206e  of the current n
+000176d0: 6f64 652e 2053 6565 2061 6c73 6f20 6057  ode. See also `W
+000176e0: 696b 6970 6564 6961 0a20 2020 2020 2020  ikipedia.       
+000176f0: 2020 203c 6874 7470 733a 2f2f 656e 2e77     <https://en.w
+00017700: 696b 6970 6564 6961 2e6f 7267 2f77 696b  ikipedia.org/wik
+00017710: 692f 5472 6565 5f74 7261 7665 7273 616c  i/Tree_traversal
+00017720: 2350 7265 2d6f 7264 6572 5f28 4e4c 5229  #Pre-order_(NLR)
+00017730: 3e60 5f5f 2e0a 2020 2020 2020 2020 2d20  >`__..        - 
+00017740: 2769 6e6f 7264 6572 273a 2073 7461 7274  'inorder': start
+00017750: 696e 6720 6174 2072 6f6f 742c 2061 7373  ing at root, ass
+00017760: 756d 696e 6720 6269 6e61 7279 2074 7265  uming binary tre
+00017770: 6573 2c20 7265 6375 7273 6520 616e 6420  es, recurse and 
+00017780: 646f 0a20 2020 2020 2020 2020 2061 6e20  do.          an 
+00017790: 696e 6f72 6465 7220 6f6e 2074 6865 2066  inorder on the f
+000177a0: 6972 7374 2063 6869 6c64 2c20 7468 656e  irst child, then
+000177b0: 2079 6965 6c64 2074 6865 2063 7572 7265   yield the curre
+000177c0: 6e74 206e 6f64 652c 2074 6865 6e0a 2020  nt node, then.  
+000177d0: 2020 2020 2020 2020 7265 6375 7273 6520          recurse 
+000177e0: 616e 6420 646f 2061 6e20 696e 6f72 6465  and do an inorde
+000177f0: 7220 6f6e 2074 6865 2073 6563 6f6e 6420  r on the second 
+00017800: 6368 696c 642e 2049 6e20 7468 6520 6361  child. In the ca
+00017810: 7365 206f 6620 6060 6e60 600a 2020 2020  se of ``n``.    
+00017820: 2020 2020 2020 6368 696c 6420 6e6f 6465        child node
+00017830: 7320 286e 6f74 206e 6563 6573 7361 7269  s (not necessari
+00017840: 6c79 2032 292c 2074 6865 2066 6972 7374  ly 2), the first
+00017850: 2060 606e 202f 2f20 3260 6020 6368 696c   ``n // 2`` chil
+00017860: 6472 656e 2061 7265 0a20 2020 2020 2020  dren are.       
+00017870: 2020 2076 6973 6974 6564 2069 6e20 7468     visited in th
+00017880: 6520 6669 7273 7420 7374 6167 652c 2061  e first stage, a
+00017890: 6e64 2074 6865 2072 656d 6169 6e69 6e67  nd the remaining
+000178a0: 2060 606e 202d 206e 202f 2f20 3260 6020   ``n - n // 2`` 
+000178b0: 6368 696c 6472 656e 0a20 2020 2020 2020  children.       
+000178c0: 2020 2061 7265 2076 6973 6974 6564 2069     are visited i
+000178d0: 6e20 7468 6520 7365 636f 6e64 2073 7461  n the second sta
+000178e0: 6765 2e20 5365 6520 616c 736f 2060 5769  ge. See also `Wi
+000178f0: 6b69 7065 6469 610a 2020 2020 2020 2020  kipedia.        
+00017900: 2020 3c68 7474 7073 3a2f 2f65 6e2e 7769    <https://en.wi
+00017910: 6b69 7065 6469 612e 6f72 672f 7769 6b69  kipedia.org/wiki
+00017920: 2f54 7265 655f 7472 6176 6572 7361 6c23  /Tree_traversal#
+00017930: 496e 2d6f 7264 6572 5f28 4c4e 5229 3e60  In-order_(LNR)>`
+00017940: 5f5f 2e0a 2020 2020 2020 2020 2d20 2770  __..        - 'p
+00017950: 6f73 746f 7264 6572 273a 2073 7461 7274  ostorder': start
+00017960: 696e 6720 6174 2072 6f6f 742c 2072 6563  ing at root, rec
+00017970: 7572 7365 2061 6e64 2064 6f20 6120 706f  urse and do a po
+00017980: 7374 6f72 6465 7220 6f6e 2065 6163 680a  storder on each.
+00017990: 2020 2020 2020 2020 2020 6368 696c 6420            child 
+000179a0: 6f66 2074 6865 2063 7572 7265 6e74 206e  of the current n
+000179b0: 6f64 652c 2074 6865 6e20 7969 656c 6420  ode, then yield 
+000179c0: 7468 6520 6375 7272 656e 7420 6e6f 6465  the current node
+000179d0: 2e20 5365 6520 616c 736f 0a20 2020 2020  . See also.     
+000179e0: 2020 2020 2060 5769 6b69 7065 6469 610a       `Wikipedia.
+000179f0: 2020 2020 2020 2020 2020 3c68 7474 7073            <https
+00017a00: 3a2f 2f65 6e2e 7769 6b69 7065 6469 612e  ://en.wikipedia.
+00017a10: 6f72 672f 7769 6b69 2f54 7265 655f 7472  org/wiki/Tree_tr
+00017a20: 6176 6572 7361 6c23 506f 7374 2d6f 7264  aversal#Post-ord
+00017a30: 6572 5f28 4c52 4e29 3e60 5f5f 2e0a 2020  er_(LRN)>`__..  
+00017a40: 2020 2020 2020 2d20 276c 6576 656c 6f72        - 'levelor
+00017a50: 6465 7227 2028 2762 7265 6164 7468 6669  der' ('breadthfi
+00017a60: 7273 7427 293a 2076 6973 6974 2074 6865  rst'): visit the
+00017a70: 206e 6f64 6573 2075 6e64 6572 2072 6f6f   nodes under roo
+00017a80: 7420 2869 6e63 6c75 6469 6e67 0a20 2020  t (including.   
+00017a90: 2020 2020 2020 2074 6865 2072 6f6f 7429         the root)
+00017aa0: 2069 6e20 696e 6372 6561 7369 6e67 206f   in increasing o
+00017ab0: 7264 6572 206f 6620 7468 6569 7220 6465  rder of their de
+00017ac0: 7074 6820 6672 6f6d 2072 6f6f 742e 2053  pth from root. S
+00017ad0: 6565 2061 6c73 6f0a 2020 2020 2020 2020  ee also.        
+00017ae0: 2020 6057 696b 6970 6564 6961 0a20 2020    `Wikipedia.   
+00017af0: 2020 2020 2020 203c 6874 7470 733a 2f2f         <https://
+00017b00: 656e 2e77 696b 6970 6564 6961 2e6f 7267  en.wikipedia.org
+00017b10: 2f77 696b 692f 5472 6565 5f74 7261 7665  /wiki/Tree_trave
+00017b20: 7273 616c 5c0a 2342 7265 6164 7468 2d66  rsal\.#Breadth-f
+00017b30: 6972 7374 5f73 6561 7263 685f 2f5f 6c65  irst_search_/_le
+00017b40: 7665 6c5f 6f72 6465 723e 605f 5f2e 0a20  vel_order>`__.. 
+00017b50: 2020 2020 2020 202d 2027 7469 6d65 6173         - 'timeas
+00017b60: 6327 3a20 7669 7369 7473 2074 6865 206e  c': visits the n
+00017b70: 6f64 6573 2069 6e20 6f72 6465 7220 6f66  odes in order of
+00017b80: 2069 6e63 7265 6173 696e 6720 7469 6d65   increasing time
+00017b90: 2c20 6661 6c6c 696e 6720 6261 636b 2074  , falling back t
+00017ba0: 6f0a 2020 2020 2020 2020 2020 696e 6372  o.          incr
+00017bb0: 6561 7369 6e67 2049 4420 6966 2074 696d  easing ID if tim
+00017bc0: 6573 2061 7265 2065 7175 616c 2e0a 2020  es are equal..  
+00017bd0: 2020 2020 2020 2d20 2774 696d 6564 6573        - 'timedes
+00017be0: 6327 3a20 7669 7369 7473 2074 6865 206e  c': visits the n
+00017bf0: 6f64 6573 2069 6e20 6f72 6465 7220 6f66  odes in order of
+00017c00: 2064 6563 7265 6173 696e 6720 7469 6d65   decreasing time
+00017c10: 2c20 6661 6c6c 696e 6720 6261 636b 2074  , falling back t
+00017c20: 6f0a 2020 2020 2020 2020 2020 6465 6372  o.          decr
+00017c30: 6561 7369 6e67 2049 4420 6966 2074 696d  easing ID if tim
+00017c40: 6573 2061 7265 2065 7175 616c 2e0a 2020  es are equal..  
+00017c50: 2020 2020 2020 2d20 276d 696e 6c65 785f        - 'minlex_
+00017c60: 706f 7374 6f72 6465 7227 3a20 6120 7573  postorder': a us
+00017c70: 7561 6c20 706f 7374 6f72 6465 7220 6861  ual postorder ha
+00017c80: 7320 616d 6269 6775 6974 7920 696e 2074  s ambiguity in t
+00017c90: 6865 206f 7264 6572 2069 6e0a 2020 2020  he order in.    
+00017ca0: 2020 2020 2020 7768 6963 6820 6368 696c        which chil
+00017cb0: 6472 656e 206f 6620 6120 6e6f 6465 2061  dren of a node a
+00017cc0: 7265 2076 6973 6974 6564 2e20 5765 2063  re visited. We c
+00017cd0: 6f6e 7374 7261 696e 2074 6869 7320 6279  onstrain this by
+00017ce0: 206f 7574 7075 7474 696e 670a 2020 2020   outputting.    
+00017cf0: 2020 2020 2020 6120 706f 7374 6f72 6465        a postorde
+00017d00: 7220 7375 6368 2074 6861 7420 7468 6520  r such that the 
+00017d10: 6c65 6176 6573 2076 6973 6974 6564 2c20  leaves visited, 
+00017d20: 7768 656e 2074 6865 6972 2049 4473 2061  when their IDs a
+00017d30: 7265 0a20 2020 2020 2020 2020 206c 6973  re.          lis
+00017d40: 7465 6420 6f75 742c 2068 6176 6520 6d69  ted out, have mi
+00017d50: 6e69 6d75 6d20 606c 6578 6963 6f67 7261  nimum `lexicogra
+00017d60: 7068 6963 206f 7264 6572 0a20 2020 2020  phic order.     
+00017d70: 2020 2020 203c 6874 7470 733a 2f2f 656e       <https://en
+00017d80: 2e77 696b 6970 6564 6961 2e6f 7267 2f77  .wikipedia.org/w
+00017d90: 696b 692f 4c65 7869 636f 6772 6170 6869  iki/Lexicographi
+00017da0: 6361 6c5f 6f72 6465 723e 605f 5f20 6f75  cal_order>`__ ou
+00017db0: 7420 6f66 2061 6c6c 2076 616c 6964 0a20  t of all valid. 
+00017dc0: 2020 2020 2020 2020 2074 7261 7665 7273           travers
+00017dd0: 616c 732e 2054 6869 7320 7472 6176 6572  als. This traver
+00017de0: 7361 6c20 6973 2075 7365 6675 6c20 666f  sal is useful fo
+00017df0: 7220 6472 6177 696e 6720 6d75 6c74 6970  r drawing multip
+00017e00: 6c65 2074 7265 6573 206f 660a 2020 2020  le trees of.    
+00017e10: 2020 2020 2020 6120 6060 5472 6565 5365        a ``TreeSe
+00017e20: 7175 656e 6365 6060 2c20 6173 2069 7420  quence``, as it 
+00017e30: 6c65 6164 7320 746f 206d 6f72 6520 636f  leads to more co
+00017e40: 6e73 6973 7465 6e63 7920 6265 7477 6565  nsistency betwee
+00017e50: 6e20 6164 6a61 6365 6e74 0a20 2020 2020  n adjacent.     
+00017e60: 2020 2020 2074 7265 6573 2e20 4e6f 7465       trees. Note
+00017e70: 2074 6861 7420 696e 7465 726e 616c 206e   that internal n
+00017e80: 6f6e 2d6c 6561 6620 6e6f 6465 7320 6172  on-leaf nodes ar
+00017e90: 6520 6e6f 7420 636f 756e 7465 6420 696e  e not counted in
+00017ea0: 0a20 2020 2020 2020 2020 2061 7373 6573  .          asses
+00017eb0: 7369 6e67 2074 6865 206c 6578 6963 6f67  sing the lexicog
+00017ec0: 7261 7068 6963 206f 7264 6572 2e0a 0a20  raphic order... 
+00017ed0: 2020 2020 2020 203a 7061 7261 6d20 696e         :param in
+00017ee0: 7420 726f 6f74 3a20 5468 6520 726f 6f74  t root: The root
+00017ef0: 206f 6620 7468 6520 7375 6274 7265 6520   of the subtree 
+00017f00: 7765 2061 7265 2074 7261 7665 7273 696e  we are traversin
+00017f10: 672e 0a20 2020 2020 2020 203a 7061 7261  g..        :para
+00017f20: 6d20 7374 7220 6f72 6465 723a 2054 6865  m str order: The
+00017f30: 2074 7261 7665 7273 616c 206f 7264 6572   traversal order
+00017f40: 696e 672e 2043 7572 7265 6e74 6c79 2027  ing. Currently '
+00017f50: 7072 656f 7264 6572 272c 0a20 2020 2020  preorder',.     
+00017f60: 2020 2020 2020 2027 696e 6f72 6465 7227         'inorder'
+00017f70: 2c20 2770 6f73 746f 7264 6572 272c 2027  , 'postorder', '
+00017f80: 6c65 7665 6c6f 7264 6572 2720 2827 6272  levelorder' ('br
+00017f90: 6561 6474 6866 6972 7374 2729 2c20 2774  eadthfirst'), 't
+00017fa0: 696d 6561 7363 2720 616e 640a 2020 2020  imeasc' and.    
+00017fb0: 2020 2020 2020 2020 2774 696d 6564 6573          'timedes
+00017fc0: 6327 2061 6e64 2027 6d69 6e6c 6578 5f70  c' and 'minlex_p
+00017fd0: 6f73 746f 7264 6572 2720 6172 6520 7375  ostorder' are su
+00017fe0: 7070 6f72 7465 642e 0a20 2020 2020 2020  pported..       
+00017ff0: 203a 7265 7475 726e 3a20 416e 2069 7465   :return: An ite
+00018000: 7261 746f 7220 6f76 6572 2074 6865 206e  rator over the n
+00018010: 6f64 6520 4944 7320 696e 2074 6865 2074  ode IDs in the t
+00018020: 7265 6520 696e 2073 6f6d 6520 7472 6176  ree in some trav
+00018030: 6572 7361 6c20 6f72 6465 722e 0a20 2020  ersal order..   
+00018040: 2020 2020 203a 7274 7970 653a 2063 6f6c       :rtype: col
+00018050: 6c65 6374 696f 6e73 2e61 6263 2e49 7465  lections.abc.Ite
+00018060: 7261 626c 652c 2069 6e74 0a20 2020 2020  rable, int.     
+00018070: 2020 2022 2222 0a20 2020 2020 2020 206d     """.        m
+00018080: 6574 686f 6473 203d 207b 0a20 2020 2020  ethods = {.     
+00018090: 2020 2020 2020 2022 7072 656f 7264 6572         "preorder
+000180a0: 223a 2073 656c 662e 5f70 7265 6f72 6465  ": self._preorde
+000180b0: 725f 7472 6176 6572 7361 6c2c 0a20 2020  r_traversal,.   
+000180c0: 2020 2020 2020 2020 2022 696e 6f72 6465           "inorde
+000180d0: 7222 3a20 7365 6c66 2e5f 696e 6f72 6465  r": self._inorde
+000180e0: 725f 7472 6176 6572 7361 6c2c 0a20 2020  r_traversal,.   
+000180f0: 2020 2020 2020 2020 2022 706f 7374 6f72           "postor
+00018100: 6465 7222 3a20 7365 6c66 2e5f 706f 7374  der": self._post
+00018110: 6f72 6465 725f 7472 6176 6572 7361 6c2c  order_traversal,
+00018120: 0a20 2020 2020 2020 2020 2020 2022 6c65  .            "le
+00018130: 7665 6c6f 7264 6572 223a 2073 656c 662e  velorder": self.
+00018140: 5f6c 6576 656c 6f72 6465 725f 7472 6176  _levelorder_trav
+00018150: 6572 7361 6c2c 0a20 2020 2020 2020 2020  ersal,.         
+00018160: 2020 2022 6272 6561 6474 6866 6972 7374     "breadthfirst
+00018170: 223a 2073 656c 662e 5f6c 6576 656c 6f72  ": self._levelor
+00018180: 6465 725f 7472 6176 6572 7361 6c2c 0a20  der_traversal,. 
+00018190: 2020 2020 2020 2020 2020 2022 7469 6d65             "time
+000181a0: 6173 6322 3a20 7365 6c66 2e5f 7469 6d65  asc": self._time
+000181b0: 6173 635f 7472 6176 6572 7361 6c2c 0a20  asc_traversal,. 
+000181c0: 2020 2020 2020 2020 2020 2022 7469 6d65             "time
+000181d0: 6465 7363 223a 2073 656c 662e 5f74 696d  desc": self._tim
+000181e0: 6564 6573 635f 7472 6176 6572 7361 6c2c  edesc_traversal,
+000181f0: 0a20 2020 2020 2020 2020 2020 2022 6d69  .            "mi
+00018200: 6e6c 6578 5f70 6f73 746f 7264 6572 223a  nlex_postorder":
+00018210: 2073 656c 662e 5f6d 696e 6c65 785f 706f   self._minlex_po
+00018220: 7374 6f72 6465 725f 7472 6176 6572 7361  storder_traversa
+00018230: 6c2c 0a20 2020 2020 2020 207d 0a20 2020  l,.        }.   
+00018240: 2020 2020 2074 7279 3a0a 2020 2020 2020       try:.      
+00018250: 2020 2020 2020 6974 6572 6174 6f72 203d        iterator =
+00018260: 206d 6574 686f 6473 5b6f 7264 6572 5d0a   methods[order].
+00018270: 2020 2020 2020 2020 6578 6365 7074 204b          except K
+00018280: 6579 4572 726f 723a 0a20 2020 2020 2020  eyError:.       
+00018290: 2020 2020 2072 6169 7365 2056 616c 7565       raise Value
+000182a0: 4572 726f 7228 6622 5472 6176 6572 7361  Error(f"Traversa
+000182b0: 6c20 6f72 6465 7269 6e67 2027 7b6f 7264  l ordering '{ord
+000182c0: 6572 7d27 206e 6f74 2073 7570 706f 7274  er}' not support
+000182d0: 6564 2229 0a0a 2020 2020 2020 2020 726f  ed")..        ro
+000182e0: 6f74 203d 202d 3120 6966 2072 6f6f 7420  ot = -1 if root 
+000182f0: 6973 204e 6f6e 6520 656c 7365 2072 6f6f  is None else roo
+00018300: 740a 2020 2020 2020 2020 7265 7475 726e  t.        return
+00018310: 2069 7465 7261 746f 7228 726f 6f74 290a   iterator(root).
+00018320: 0a20 2020 2064 6566 205f 6173 5f6e 6577  .    def _as_new
+00018330: 6963 6b5f 6661 7374 2873 656c 662c 202a  ick_fast(self, *
+00018340: 2c20 726f 6f74 2c20 7072 6563 6973 696f  , root, precisio
+00018350: 6e2c 206c 6567 6163 795f 6d73 5f6c 6162  n, legacy_ms_lab
+00018360: 656c 7329 3a0a 2020 2020 2020 2020 2222  els):.        ""
+00018370: 220a 2020 2020 2020 2020 4361 6c6c 2069  ".        Call i
+00018380: 6e74 6f20 7468 6520 6661 7374 2062 7574  nto the fast but
+00018390: 206c 696d 6974 6564 2043 2069 6d70 6c65   limited C imple
+000183a0: 6d65 6e74 6174 696f 6e20 6f66 2074 6865  mentation of the
+000183b0: 206e 6577 6963 6b20 636f 6e76 6572 7369   newick conversi
+000183c0: 6f6e 2e0a 2020 2020 2020 2020 2222 220a  on..        """.
+000183d0: 2020 2020 2020 2020 726f 6f74 5f74 696d          root_tim
+000183e0: 6520 3d20 6d61 7828 312c 2073 656c 662e  e = max(1, self.
+000183f0: 7469 6d65 2872 6f6f 7429 290a 2020 2020  time(root)).    
+00018400: 2020 2020 6d61 785f 6c61 6265 6c5f 7369      max_label_si
+00018410: 7a65 203d 206d 6174 682e 6365 696c 286d  ze = math.ceil(m
+00018420: 6174 682e 6c6f 6731 3028 7365 6c66 2e74  ath.log10(self.t
+00018430: 7265 655f 7365 7175 656e 6365 2e6e 756d  ree_sequence.num
+00018440: 5f6e 6f64 6573 2929 0a20 2020 2020 2020  _nodes)).       
+00018450: 2073 696e 676c 655f 6e6f 6465 5f73 697a   single_node_siz
+00018460: 6520 3d20 280a 2020 2020 2020 2020 2020  e = (.          
+00018470: 2020 3520 2b20 6d61 785f 6c61 6265 6c5f    5 + max_label_
+00018480: 7369 7a65 202b 206d 6174 682e 6365 696c  size + math.ceil
+00018490: 286d 6174 682e 6c6f 6731 3028 726f 6f74  (math.log10(root
+000184a0: 5f74 696d 6529 2920 2b20 7072 6563 6973  _time)) + precis
+000184b0: 696f 6e0a 2020 2020 2020 2020 290a 2020  ion.        ).  
+000184c0: 2020 2020 2020 6275 6666 6572 5f73 697a        buffer_siz
+000184d0: 6520 3d20 3120 2b20 7369 6e67 6c65 5f6e  e = 1 + single_n
+000184e0: 6f64 655f 7369 7a65 202a 2073 656c 662e  ode_size * self.
+000184f0: 7472 6565 5f73 6571 7565 6e63 652e 6e75  tree_sequence.nu
+00018500: 6d5f 6e6f 6465 730a 2020 2020 2020 2020  m_nodes.        
+00018510: 7265 7475 726e 2073 656c 662e 5f6c 6c5f  return self._ll_
+00018520: 7472 6565 2e67 6574 5f6e 6577 6963 6b28  tree.get_newick(
+00018530: 0a20 2020 2020 2020 2020 2020 2070 7265  .            pre
+00018540: 6369 7369 6f6e 3d70 7265 6369 7369 6f6e  cision=precision
+00018550: 2c0a 2020 2020 2020 2020 2020 2020 726f  ,.            ro
+00018560: 6f74 3d72 6f6f 742c 0a20 2020 2020 2020  ot=root,.       
+00018570: 2020 2020 2062 7566 6665 725f 7369 7a65       buffer_size
+00018580: 3d62 7566 6665 725f 7369 7a65 2c0a 2020  =buffer_size,.  
+00018590: 2020 2020 2020 2020 2020 6c65 6761 6379            legacy
+000185a0: 5f6d 735f 6c61 6265 6c73 3d6c 6567 6163  _ms_labels=legac
+000185b0: 795f 6d73 5f6c 6162 656c 732c 0a20 2020  y_ms_labels,.   
+000185c0: 2020 2020 2029 0a0a 2020 2020 6465 6620       )..    def 
+000185d0: 6173 5f6e 6577 6963 6b28 0a20 2020 2020  as_newick(.     
+000185e0: 2020 2073 656c 662c 0a20 2020 2020 2020     self,.       
+000185f0: 202a 2c0a 2020 2020 2020 2020 726f 6f74   *,.        root
+00018600: 3d4e 6f6e 652c 0a20 2020 2020 2020 2070  =None,.        p
+00018610: 7265 6369 7369 6f6e 3d4e 6f6e 652c 0a20  recision=None,. 
+00018620: 2020 2020 2020 206e 6f64 655f 6c61 6265         node_labe
+00018630: 6c73 3d4e 6f6e 652c 0a20 2020 2020 2020  ls=None,.       
+00018640: 2069 6e63 6c75 6465 5f62 7261 6e63 685f   include_branch_
+00018650: 6c65 6e67 7468 733d 4e6f 6e65 2c0a 2020  lengths=None,.  
+00018660: 2020 293a 0a20 2020 2020 2020 2022 2222    ):.        """
+00018670: 0a20 2020 2020 2020 2052 6574 7572 6e73  .        Returns
+00018680: 2061 2060 6e65 7769 636b 2065 6e63 6f64   a `newick encod
+00018690: 696e 670a 2020 2020 2020 2020 3c68 7474  ing.        <htt
+000186a0: 7073 3a2f 2f65 6e2e 7769 6b69 7065 6469  ps://en.wikipedi
+000186b0: 612e 6f72 672f 7769 6b69 2f4e 6577 6963  a.org/wiki/Newic
+000186c0: 6b5f 666f 726d 6174 3e60 5f20 6f66 2074  k_format>`_ of t
+000186d0: 6869 7320 7472 6565 2e0a 2020 2020 2020  his tree..      
+000186e0: 2020 466f 7220 6578 616d 706c 652c 2061    For example, a
+000186f0: 2062 696e 6172 7920 7472 6565 2077 6974   binary tree wit
+00018700: 6820 3320 6c65 6176 6573 2067 656e 6572  h 3 leaves gener
+00018710: 6174 6564 2062 790a 2020 2020 2020 2020  ated by.        
+00018720: 3a6d 6574 683a 6054 7265 652e 6765 6e65  :meth:`Tree.gene
+00018730: 7261 7465 5f62 616c 616e 6365 6428 3329  rate_balanced(3)
+00018740: 3c54 7265 652e 6765 6e65 7261 7465 5f62  <Tree.generate_b
+00018750: 616c 616e 6365 643e 600a 2020 2020 2020  alanced>`.      
+00018760: 2020 656e 636f 6465 7320 6173 3a3a 0a0a    encodes as::..
+00018770: 2020 2020 2020 2020 2020 2020 286e 303a              (n0:
+00018780: 322c 286e 313a 312c 6e32 3a31 293a 3129  2,(n1:1,n2:1):1)
+00018790: 3b0a 0a20 2020 2020 2020 2042 7920 6465  ;..        By de
+000187a0: 6661 756c 7420 3a72 6566 3a60 7361 6d70  fault :ref:`samp
+000187b0: 6c65 206e 6f64 6573 3c73 6563 5f64 6174  le nodes<sec_dat
+000187c0: 615f 6d6f 6465 6c5f 6465 6669 6e69 7469  a_model_definiti
+000187d0: 6f6e 733e 6020 6172 650a 2020 2020 2020  ons>` are.      
+000187e0: 2020 6c61 6265 6c6c 6564 2075 7369 6e67    labelled using
+000187f0: 2074 6865 2066 6f72 6d20 6060 6622 6e7b   the form ``f"n{
+00018800: 6e6f 6465 5f69 647d 2260 602c 2069 2e65  node_id}"``, i.e
+00018810: 2e20 7468 6520 7361 6d70 6c65 206e 6f64  . the sample nod
+00018820: 6527 730a 2020 2020 2020 2020 4944 2070  e's.        ID p
+00018830: 7265 6669 7865 6420 7769 7468 2074 6865  refixed with the
+00018840: 2073 7472 696e 6720 6060 226e 2260 602e   string ``"n"``.
+00018850: 204e 6f64 6520 6c61 6265 6c73 2063 616e   Node labels can
+00018860: 2062 6520 7370 6563 6966 6965 640a 2020   be specified.  
+00018870: 2020 2020 2020 6578 706c 6963 6974 6c79        explicitly
+00018880: 2075 7369 6e67 2074 6865 2060 606e 6f64   using the ``nod
+00018890: 655f 6c61 6265 6c73 6060 2061 7267 756d  e_labels`` argum
+000188a0: 656e 742c 2077 6869 6368 2069 7320 6120  ent, which is a 
+000188b0: 6d61 7070 696e 6720 6672 6f6d 0a20 2020  mapping from.   
+000188c0: 2020 2020 2069 6e74 6567 6572 206e 6f64       integer nod
+000188d0: 6520 4944 7320 746f 2074 6865 2063 6f72  e IDs to the cor
+000188e0: 7265 7370 6f6e 6469 6e67 2073 7472 696e  responding strin
+000188f0: 6720 6c61 6265 6c2e 2049 6620 6120 6e6f  g label. If a no
+00018900: 6465 2069 7320 6e6f 740a 2020 2020 2020  de is not.      
+00018910: 2020 7072 6573 656e 7420 696e 2074 6865    present in the
+00018920: 206d 6170 7069 6e67 2c20 6e6f 206c 6162   mapping, no lab
+00018930: 656c 2069 7320 6173 736f 6369 6174 6564  el is associated
+00018940: 2077 6974 6820 7468 6520 6e6f 6465 2069   with the node i
+00018950: 6e0a 2020 2020 2020 2020 6f75 7470 7574  n.        output
+00018960: 2e0a 0a20 2020 2020 2020 202e 2e20 7761  ...        .. wa
+00018970: 726e 696e 673a 3a20 4e6f 6465 206c 6162  rning:: Node lab
+00018980: 656c 7320 6172 6520 2a2a 6e6f 742a 2a20  els are **not** 
+00018990: 4e65 7769 636b 2065 7363 6170 6564 2c20  Newick escaped, 
+000189a0: 736f 2063 6172 6520 6d75 7374 2062 6520  so care must be 
+000189b0: 7461 6b65 6e0a 2020 2020 2020 2020 2020  taken.          
+000189c0: 2020 746f 2070 726f 7669 6465 206c 6162    to provide lab
+000189d0: 656c 7320 7468 6174 2077 696c 6c20 6e6f  els that will no
+000189e0: 7420 6272 6561 6b20 7468 6520 656e 636f  t break the enco
+000189f0: 6469 6e67 2e0a 0a20 2020 2020 2020 202e  ding...        .
+00018a00: 2e20 6e6f 7465 3a3a 2053 7065 6369 6679  . note:: Specify
+00018a10: 696e 6720 6120 6060 6e6f 6465 5f6c 6162  ing a ``node_lab
+00018a20: 656c 7360 6020 6469 6374 696f 6e61 7279  els`` dictionary
+00018a30: 206f 7220 7365 7474 696e 670a 2020 2020   or setting.    
+00018a40: 2020 2020 2020 2020 6060 696e 636c 7564          ``includ
+00018a50: 655f 6272 616e 6368 5f6c 656e 6774 6873  e_branch_lengths
+00018a60: 3d46 616c 7365 6060 2072 6573 756c 7473  =False`` results
+00018a70: 2069 6e20 6120 6c65 7373 2065 6666 6963   in a less effic
+00018a80: 6965 6e74 0a20 2020 2020 2020 2020 2020  ient.           
+00018a90: 206d 6574 686f 6420 6265 696e 6720 7573   method being us
+00018aa0: 6564 2074 6f20 6765 6e65 7261 7465 2074  ed to generate t
+00018ab0: 6865 206e 6577 6963 6b20 6f75 7470 7574  he newick output
+00018ac0: 2e20 5468 6520 7065 7266 6f72 6d61 6e63  . The performanc
+00018ad0: 650a 2020 2020 2020 2020 2020 2020 6469  e.            di
+00018ae0: 6666 6572 656e 6365 2063 616e 2062 6520  fference can be 
+00018af0: 7375 6273 7461 6e74 6961 6c20 666f 7220  substantial for 
+00018b00: 6c61 7267 6520 7472 6565 732e 0a0a 2020  large trees...  
+00018b10: 2020 2020 2020 4279 2064 6566 6175 6c74        By default
+00018b20: 2c20 6272 616e 6368 206c 656e 6774 6873  , branch lengths
+00018b30: 2061 7265 2070 7269 6e74 6564 206f 7574   are printed out
+00018b40: 2077 6974 6820 7375 6666 6963 6965 6e74   with sufficient
+00018b50: 2070 7265 6369 7369 6f6e 0a20 2020 2020   precision.     
+00018b60: 2020 2066 6f72 2074 6865 6d20 746f 2062     for them to b
+00018b70: 6520 7265 636f 7665 7265 6420 6578 6163  e recovered exac
+00018b80: 746c 7920 696e 2064 6f75 626c 6520 7072  tly in double pr
+00018b90: 6563 6973 696f 6e20 2861 6c74 686f 7567  ecision (althoug
+00018ba0: 6820 6e6f 7465 0a20 2020 2020 2020 2074  h note.        t
+00018bb0: 6861 7420 7468 6973 2064 6f65 7320 6e6f  hat this does no
+00018bc0: 7420 6e65 6365 7373 6172 696c 7920 6d65  t necessarily me
+00018bd0: 616e 2074 6861 7420 7765 2063 616e 2070  an that we can p
+00018be0: 7265 6369 7365 6c79 2072 6563 6f76 6572  recisely recover
+00018bf0: 2074 6865 0a20 2020 2020 2020 2063 6f72   the.        cor
+00018c00: 7265 7370 6f6e 6469 6e67 206e 6f64 6520  responding node 
+00018c10: 7469 6d65 732c 2073 696e 6365 2062 7261  times, since bra
+00018c20: 6e63 6820 6c65 6e67 7468 7320 6172 6520  nch lengths are 
+00018c30: 6f62 7461 696e 6564 2062 790a 2020 2020  obtained by.    
+00018c40: 2020 2020 7375 6274 7261 6374 696f 6e29      subtraction)
+00018c50: 2e20 4966 2061 6c6c 2074 696d 6573 206f  . If all times o
+00018c60: 6e20 7468 6520 7472 6565 2073 6571 7565  n the tree seque
+00018c70: 6e63 6520 6172 6520 6469 7363 7265 7465  nce are discrete
+00018c80: 2c20 7468 656e 0a20 2020 2020 2020 2062  , then.        b
+00018c90: 7261 6e63 6820 6c65 6e67 7468 7320 6172  ranch lengths ar
+00018ca0: 6520 7072 696e 7465 6420 6173 2069 6e74  e printed as int
+00018cb0: 6567 6572 732e 204f 7468 6572 7769 7365  egers. Otherwise
+00018cc0: 2c20 6272 616e 6368 206c 656e 6774 6873  , branch lengths
+00018cd0: 2061 7265 0a20 2020 2020 2020 2070 7269   are.        pri
+00018ce0: 6e74 6564 2077 6974 6820 3137 2064 6967  nted with 17 dig
+00018cf0: 6974 7320 6f66 2070 7265 6369 7369 6f6e  its of precision
+00018d00: 2028 692e 652e 2c20 6060 2225 2e31 3766   (i.e., ``"%.17f
+00018d10: 2260 6020 696e 0a20 2020 2020 2020 2070  "`` in.        p
+00018d20: 7269 6e74 662d 6e6f 7461 7469 6f6e 292e  rintf-notation).
+00018d30: 0a0a 2020 2020 2020 2020 5468 6520 7072  ..        The pr
+00018d40: 6563 6973 696f 6e20 666f 7220 6272 616e  ecision for bran
+00018d50: 6368 206c 656e 6774 6873 2063 616e 2062  ch lengths can b
+00018d60: 6520 7370 6563 6966 6965 6420 7573 696e  e specified usin
+00018d70: 6720 7468 6520 6060 7072 6563 6973 696f  g the ``precisio
+00018d80: 6e60 600a 2020 2020 2020 2020 6172 6775  n``.        argu
+00018d90: 6d65 6e74 2e20 4272 616e 6368 206c 656e  ment. Branch len
+00018da0: 6774 6873 2063 616e 2062 6520 6f6d 6974  gths can be omit
+00018db0: 7465 6420 656e 7469 7265 6c79 2062 7920  ted entirely by 
+00018dc0: 7365 7474 696e 670a 2020 2020 2020 2020  setting.        
+00018dd0: 6060 696e 636c 7564 655f 6272 616e 6368  ``include_branch
+00018de0: 5f6c 656e 6774 6873 3d46 616c 7365 6060  _lengths=False``
+00018df0: 2e0a 0a20 2020 2020 2020 2049 6620 7468  ...        If th
+00018e00: 6520 6060 726f 6f74 6060 2061 7267 756d  e ``root`` argum
+00018e10: 656e 7420 6973 2073 7065 6369 6669 6564  ent is specified
+00018e20: 2c20 7765 2072 6574 7572 6e20 7468 6520  , we return the 
+00018e30: 6e65 7769 636b 2065 6e63 6f64 696e 6720  newick encoding 
+00018e40: 6f66 0a20 2020 2020 2020 2074 6865 2073  of.        the s
+00018e50: 7065 6369 6669 6564 2073 7562 7472 6565  pecified subtree
+00018e60: 2c20 6f74 6865 7277 6973 6520 7468 6520  , otherwise the 
+00018e70: 6675 6c6c 2074 7265 6520 6973 2072 6574  full tree is ret
+00018e80: 7572 6e65 642e 2049 6620 7468 6520 7472  urned. If the tr
+00018e90: 6565 0a20 2020 2020 2020 2068 6173 203a  ee.        has :
+00018ea0: 7265 663a 606d 756c 7469 706c 6520 726f  ref:`multiple ro
+00018eb0: 6f74 7320 3c73 6563 5f64 6174 615f 6d6f  ots <sec_data_mo
+00018ec0: 6465 6c5f 7472 6565 5f72 6f6f 7473 3e60  del_tree_roots>`
+00018ed0: 2061 6e64 2061 2072 6f6f 7420 6e6f 6465   and a root node
+00018ee0: 0a20 2020 2020 2020 2069 7320 6e6f 7420  .        is not 
+00018ef0: 6578 706c 6963 6974 6c79 2073 7065 6369  explicitly speci
+00018f00: 6669 6564 2c20 7765 2072 6169 7365 2061  fied, we raise a
+00018f10: 2060 6056 616c 7565 4572 726f 7260 602e   ``ValueError``.
+00018f20: 2054 6869 7320 6973 2062 6563 6175 7365   This is because
+00018f30: 0a20 2020 2020 2020 206d 6f73 7420 6c69  .        most li
+00018f40: 6272 6172 6965 7320 616e 6420 646f 776e  braries and down
+00018f50: 7374 7265 616d 2073 6f66 7477 6172 6520  stream software 
+00018f60: 636f 6e73 6964 6572 2061 206e 6577 6963  consider a newic
+00018f70: 6b20 7374 7269 6e67 2074 6861 740a 2020  k string that.  
+00018f80: 2020 2020 2020 636f 6e74 6169 6e73 206d        contains m
+00018f90: 756c 7469 706c 6520 6469 7363 6f6e 6e65  ultiple disconne
+00018fa0: 6374 6564 2073 7562 7472 6565 7320 616e  cted subtrees an
+00018fb0: 2065 7272 6f72 2c20 616e 6420 6974 2069   error, and it i
+00018fc0: 7320 7468 6572 6566 6f72 650a 2020 2020  s therefore.    
+00018fd0: 2020 2020 6265 7374 2074 6f20 636f 6e73      best to cons
+00018fe0: 6964 6572 2068 6f77 2073 7563 6820 746f  ider how such to
+00018ff0: 706f 6c6f 6769 6573 2073 686f 756c 6420  pologies should 
+00019000: 6265 2069 6e74 6572 6368 616e 6765 6420  be interchanged 
+00019010: 6f6e 2061 0a20 2020 2020 2020 2063 6173  on a.        cas
+00019020: 652d 6279 2d62 6173 6520 6261 7369 732e  e-by-base basis.
+00019030: 2041 206c 6973 7420 6f66 2074 6865 206e   A list of the n
+00019040: 6577 6963 6b20 7374 7269 6e67 7320 666f  ewick strings fo
+00019050: 7220 6561 6368 2072 6f6f 7420 6361 6e20  r each root can 
+00019060: 6265 0a20 2020 2020 2020 206f 6274 6169  be.        obtai
+00019070: 6e65 6420 6279 2060 605b 7472 6565 2e61  ned by ``[tree.a
+00019080: 735f 6e65 7769 636b 2872 6f6f 743d 726f  s_newick(root=ro
+00019090: 6f74 2920 666f 7220 726f 6f74 2069 6e20  ot) for root in 
+000190a0: 7472 6565 2e72 6f6f 7473 5d60 602e 0a0a  tree.roots]``...
+000190b0: 2020 2020 2020 2020 3a70 6172 616d 2069          :param i
+000190c0: 6e74 2070 7265 6369 7369 6f6e 3a20 5468  nt precision: Th
+000190d0: 6520 6e75 6d65 7269 6361 6c20 7072 6563  e numerical prec
+000190e0: 6973 696f 6e20 7769 7468 2077 6869 6368  ision with which
+000190f0: 2062 7261 6e63 6820 6c65 6e67 7468 7320   branch lengths 
+00019100: 6172 650a 2020 2020 2020 2020 2020 2020  are.            
+00019110: 7072 696e 7465 642e 2049 6620 6e6f 7420  printed. If not 
+00019120: 7370 6563 6966 6965 6420 6f72 204e 6f6e  specified or Non
+00019130: 6520 6465 6661 756c 7420 746f 2030 2069  e default to 0 i
+00019140: 6620 7468 6520 7472 6565 2073 6571 7565  f the tree seque
+00019150: 6e63 650a 2020 2020 2020 2020 2020 2020  nce.            
+00019160: 636f 6e74 6169 6e73 206f 6e6c 7920 696e  contains only in
+00019170: 7465 6765 7220 6e6f 6465 2074 696d 6573  teger node times
+00019180: 2c20 6f72 2031 3720 6f74 6865 7277 6973  , or 17 otherwis
+00019190: 652e 0a20 2020 2020 2020 203a 7061 7261  e..        :para
+000191a0: 6d20 696e 7420 726f 6f74 3a20 4966 2073  m int root: If s
+000191b0: 7065 6369 6669 6564 2c20 7265 7475 726e  pecified, return
+000191c0: 2074 6865 2074 7265 6520 726f 6f74 6564   the tree rooted
+000191d0: 2061 7420 7468 6973 206e 6f64 652e 0a20   at this node.. 
+000191e0: 2020 2020 2020 203a 7061 7261 6d20 6469         :param di
+000191f0: 6374 206e 6f64 655f 6c61 6265 6c73 3a20  ct node_labels: 
+00019200: 4966 2073 7065 6369 6669 6564 2c20 7368  If specified, sh
+00019210: 6f77 2063 7573 746f 6d20 6c61 6265 6c73  ow custom labels
+00019220: 2066 6f72 2074 6865 206e 6f64 6573 0a20   for the nodes. 
+00019230: 2020 2020 2020 2020 2020 2074 6861 7420             that 
+00019240: 6172 6520 7072 6573 656e 7420 696e 2074  are present in t
+00019250: 6865 206d 6170 2e20 416e 7920 6e6f 6465  he map. Any node
+00019260: 7320 6e6f 7420 7370 6563 6966 6965 6420  s not specified 
+00019270: 696e 2074 6865 206d 6170 2077 696c 6c0a  in the map will.
+00019280: 2020 2020 2020 2020 2020 2020 6e6f 7420              not 
+00019290: 6861 7665 2061 206e 6f64 6520 6c61 6265  have a node labe
+000192a0: 6c2e 0a20 2020 2020 2020 203a 7061 7261  l..        :para
+000192b0: 6d20 696e 636c 7564 655f 6272 616e 6368  m include_branch
+000192c0: 5f6c 656e 6774 6873 3a20 4966 2054 7275  _lengths: If Tru
+000192d0: 6520 2864 6566 6175 6c74 292c 206f 7574  e (default), out
+000192e0: 7075 7420 6272 616e 6368 206c 656e 6774  put branch lengt
+000192f0: 6873 2069 6e20 7468 650a 2020 2020 2020  hs in the.      
+00019300: 2020 2020 2020 4e65 7769 636b 2073 7472        Newick str
+00019310: 696e 672e 2049 6620 4661 6c73 652c 206f  ing. If False, o
+00019320: 6e6c 7920 6f75 7470 7574 2074 6865 2074  nly output the t
+00019330: 6f70 6f6c 6f67 792c 2077 6974 686f 7574  opology, without
+00019340: 2062 7261 6e63 6820 6c65 6e67 7468 732e   branch lengths.
+00019350: 0a20 2020 2020 2020 203a 7265 7475 726e  .        :return
+00019360: 3a20 4120 6e65 7769 636b 2072 6570 7265  : A newick repre
+00019370: 7365 6e74 6174 696f 6e20 6f66 2074 6869  sentation of thi
+00019380: 7320 7472 6565 2e0a 2020 2020 2020 2020  s tree..        
+00019390: 3a72 7479 7065 3a20 7374 720a 2020 2020  :rtype: str.    
+000193a0: 2020 2020 2222 220a 2020 2020 2020 2020      """.        
+000193b0: 6966 2072 6f6f 7420 6973 204e 6f6e 653a  if root is None:
+000193c0: 0a20 2020 2020 2020 2020 2020 2069 6620  .            if 
+000193d0: 6e6f 7420 7365 6c66 2e68 6173 5f73 696e  not self.has_sin
+000193e0: 676c 655f 726f 6f74 3a0a 2020 2020 2020  gle_root:.      
+000193f0: 2020 2020 2020 2020 2020 7261 6973 6520            raise 
+00019400: 5661 6c75 6545 7272 6f72 280a 2020 2020  ValueError(.    
+00019410: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00019420: 2243 616e 6e6f 7420 6765 7420 6e65 7769  "Cannot get newi
+00019430: 636b 2075 6e6c 6573 7320 6120 7472 6565  ck unless a tree
+00019440: 2068 6173 2061 2073 696e 676c 6520 726f   has a single ro
+00019450: 6f74 2e20 5472 7920 220a 2020 2020 2020  ot. Try ".      
+00019460: 2020 2020 2020 2020 2020 2020 2020 225b                "[
+00019470: 742e 6173 5f6e 6577 6963 6b28 726f 6f74  t.as_newick(root
+00019480: 2920 666f 7220 726f 6f74 2069 6e20 742e  ) for root in t.
+00019490: 726f 6f74 735d 2074 6f20 6765 7420 6120  roots] to get a 
+000194a0: 6c69 7374 206f 6620 220a 2020 2020 2020  list of ".      
+000194b0: 2020 2020 2020 2020 2020 2020 2020 226e                "n
+000194c0: 6577 6963 6b20 7472 6565 732c 206f 6e65  ewick trees, one
+000194d0: 2066 6f72 2065 6163 6820 726f 6f74 2e22   for each root."
+000194e0: 0a20 2020 2020 2020 2020 2020 2020 2020  .               
+000194f0: 2029 0a20 2020 2020 2020 2020 2020 2072   ).            r
+00019500: 6f6f 7420 3d20 7365 6c66 2e72 6f6f 740a  oot = self.root.
+00019510: 0a20 2020 2020 2020 2069 6620 7072 6563  .        if prec
+00019520: 6973 696f 6e20 6973 204e 6f6e 653a 0a20  ision is None:. 
+00019530: 2020 2020 2020 2020 2020 2023 2031 3720             # 17 
+00019540: 6465 6369 6d61 6c20 6469 6769 7473 2070  decimal digits p
+00019550: 726f 7669 6465 7320 7468 6520 6675 6c6c  rovides the full
+00019560: 2070 7265 6369 7369 6f6e 206f 6620 616e   precision of an
+00019570: 2049 4545 4520 646f 7562 6c65 2c0a 2020   IEEE double,.  
+00019580: 2020 2020 2020 2020 2020 2320 6173 2064            # as d
+00019590: 6566 696e 6564 2062 7920 4442 4c5f 4445  efined by DBL_DE
+000195a0: 4349 4d41 4c5f 4449 4720 6d61 6372 6f2e  CIMAL_DIG macro.
+000195b0: 2049 6620 7765 2068 6176 6520 6469 7363   If we have disc
+000195c0: 7265 7465 2074 696d 650a 2020 2020 2020  rete time.      
+000195d0: 2020 2020 2020 2320 7468 656e 2077 7269        # then wri
+000195e0: 7465 206f 7574 2069 6e74 6567 6572 2062  te out integer b
+000195f0: 7261 6e63 6820 6c65 6e67 7468 732e 0a20  ranch lengths.. 
+00019600: 2020 2020 2020 2020 2020 2070 7265 6369             preci
+00019610: 7369 6f6e 203d 2030 2069 6620 7365 6c66  sion = 0 if self
+00019620: 2e74 7265 655f 7365 7175 656e 6365 2e64  .tree_sequence.d
+00019630: 6973 6372 6574 655f 7469 6d65 2065 6c73  iscrete_time els
+00019640: 6520 3137 0a20 2020 2020 2020 2069 6e63  e 17.        inc
+00019650: 6c75 6465 5f62 7261 6e63 685f 6c65 6e67  lude_branch_leng
+00019660: 7468 7320 3d20 280a 2020 2020 2020 2020  ths = (.        
+00019670: 2020 2020 5472 7565 2069 6620 696e 636c      True if incl
+00019680: 7564 655f 6272 616e 6368 5f6c 656e 6774  ude_branch_lengt
+00019690: 6873 2069 7320 4e6f 6e65 2065 6c73 6520  hs is None else 
+000196a0: 696e 636c 7564 655f 6272 616e 6368 5f6c  include_branch_l
+000196b0: 656e 6774 6873 0a20 2020 2020 2020 2029  engths.        )
+000196c0: 0a20 2020 2020 2020 2023 2043 616e 2077  .        # Can w
+000196d0: 6520 7275 6e20 7468 6973 2074 6872 6f75  e run this throu
+000196e0: 6768 2074 6865 2066 6173 7420 7061 7468  gh the fast path
+000196f0: 3f0a 2020 2020 2020 2020 6966 2069 6e63  ?.        if inc
+00019700: 6c75 6465 5f62 7261 6e63 685f 6c65 6e67  lude_branch_leng
+00019710: 7468 7320 616e 6420 6e6f 6465 5f6c 6162  ths and node_lab
+00019720: 656c 7320 696e 205b 4c45 4741 4359 5f4d  els in [LEGACY_M
+00019730: 535f 4c41 4245 4c53 2c20 4e6f 6e65 5d3a  S_LABELS, None]:
+00019740: 0a20 2020 2020 2020 2020 2020 2023 204e  .            # N
+00019750: 6f74 6520 7468 6520 4c45 4741 4359 5f4d  ote the LEGACY_M
+00019760: 535f 4c41 4245 4c53 2063 6f64 6520 7061  S_LABELS code pa
+00019770: 7468 2069 7320 6e6f 7420 7061 7274 206f  th is not part o
+00019780: 6620 7468 6520 646f 6375 6d65 6e74 6564  f the documented
+00019790: 0a20 2020 2020 2020 2020 2020 2023 2069  .            # i
+000197a0: 6e74 6572 6661 6365 2061 6e64 2073 686f  nterface and sho
+000197b0: 756c 6420 6e6f 7420 6265 2064 6570 656e  uld not be depen
+000197c0: 6465 6420 6f6e 2062 7920 636c 6965 6e74  ded on by client
+000197d0: 2063 6f64 652e 0a20 2020 2020 2020 2020   code..         
+000197e0: 2020 2072 6574 7572 6e20 7365 6c66 2e5f     return self._
+000197f0: 6173 5f6e 6577 6963 6b5f 6661 7374 280a  as_newick_fast(.
+00019800: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00019810: 726f 6f74 3d72 6f6f 742c 0a20 2020 2020  root=root,.     
+00019820: 2020 2020 2020 2020 2020 2070 7265 6369             preci
+00019830: 7369 6f6e 3d70 7265 6369 7369 6f6e 2c0a  sion=precision,.
+00019840: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00019850: 6c65 6761 6379 5f6d 735f 6c61 6265 6c73  legacy_ms_labels
+00019860: 3d6e 6f64 655f 6c61 6265 6c73 203d 3d20  =node_labels == 
+00019870: 4c45 4741 4359 5f4d 535f 4c41 4245 4c53  LEGACY_MS_LABELS
+00019880: 2c0a 2020 2020 2020 2020 2020 2020 290a  ,.            ).
+00019890: 0a20 2020 2020 2020 2023 204e 6f2c 2077  .        # No, w
+000198a0: 6520 6861 7665 2074 6f20 7573 6520 7468  e have to use th
+000198b0: 6520 736c 6f77 6572 2050 7974 686f 6e20  e slower Python 
+000198c0: 636f 6465 2e0a 2020 2020 2020 2020 6966  code..        if
+000198d0: 206e 6f64 655f 6c61 6265 6c73 2069 7320   node_labels is 
+000198e0: 4e6f 6e65 3a0a 2020 2020 2020 2020 2020  None:.          
+000198f0: 2020 6e6f 6465 5f6c 6162 656c 7320 3d20    node_labels = 
+00019900: 7b75 3a20 6622 6e7b 757d 2220 666f 7220  {u: f"n{u}" for 
+00019910: 7520 696e 2073 656c 662e 7472 6565 5f73  u in self.tree_s
+00019920: 6571 7565 6e63 652e 7361 6d70 6c65 7328  equence.samples(
+00019930: 297d 0a20 2020 2020 2020 2065 6c69 6620  )}.        elif 
+00019940: 6e6f 6465 5f6c 6162 656c 7320 3d3d 204c  node_labels == L
+00019950: 4547 4143 595f 4d53 5f4c 4142 454c 533a  EGACY_MS_LABELS:
+00019960: 0a20 2020 2020 2020 2020 2020 2023 204e  .            # N
+00019970: 4f54 4520 696e 2074 6865 206d 7320 666f  OTE in the ms fo
+00019980: 726d 6174 2069 7427 7320 7468 6520 2a6c  rmat it's the *l
+00019990: 6561 662a 206e 6f64 6573 2077 6520 6c61  eaf* nodes we la
+000199a0: 6265 6c20 6e6f 740a 2020 2020 2020 2020  bel not.        
+000199b0: 2020 2020 2320 6e65 6365 7373 6172 696c      # necessaril
+000199c0: 7920 7468 6520 7361 6d70 6c65 732e 2057  y the samples. W
+000199d0: 6520 6b65 6570 2074 6869 7320 6265 6861  e keep this beha
+000199e0: 7669 6f75 7220 746f 2061 766f 6964 0a20  viour to avoid. 
+000199f0: 2020 2020 2020 2020 2020 2023 2062 7265             # bre
+00019a00: 616b 696e 6720 6c65 6761 6379 2063 6f64  aking legacy cod
+00019a10: 6520 7468 6174 206d 6179 2064 6570 656e  e that may depen
+00019a20: 6420 6f6e 2069 742e 0a20 2020 2020 2020  d on it..       
+00019a30: 2020 2020 206e 6f64 655f 6c61 6265 6c73       node_labels
+00019a40: 203d 207b 753a 2066 227b 7520 2b20 317d   = {u: f"{u + 1}
+00019a50: 2220 666f 7220 7520 696e 2073 656c 662e  " for u in self.
+00019a60: 6c65 6176 6573 2829 7d0a 2020 2020 2020  leaves()}.      
+00019a70: 2020 7265 7475 726e 2074 6578 745f 666f    return text_fo
+00019a80: 726d 6174 732e 6275 696c 645f 6e65 7769  rmats.build_newi
+00019a90: 636b 280a 2020 2020 2020 2020 2020 2020  ck(.            
+00019aa0: 7365 6c66 2c0a 2020 2020 2020 2020 2020  self,.          
+00019ab0: 2020 726f 6f74 3d72 6f6f 742c 0a20 2020    root=root,.   
+00019ac0: 2020 2020 2020 2020 2070 7265 6369 7369           precisi
+00019ad0: 6f6e 3d70 7265 6369 7369 6f6e 2c0a 2020  on=precision,.  
+00019ae0: 2020 2020 2020 2020 2020 6e6f 6465 5f6c            node_l
+00019af0: 6162 656c 733d 6e6f 6465 5f6c 6162 656c  abels=node_label
+00019b00: 732c 0a20 2020 2020 2020 2020 2020 2069  s,.            i
+00019b10: 6e63 6c75 6465 5f62 7261 6e63 685f 6c65  nclude_branch_le
+00019b20: 6e67 7468 733d 696e 636c 7564 655f 6272  ngths=include_br
+00019b30: 616e 6368 5f6c 656e 6774 6873 2c0a 2020  anch_lengths,.  
+00019b40: 2020 2020 2020 290a 0a20 2020 2064 6566        )..    def
+00019b50: 206e 6577 6963 6b28 0a20 2020 2020 2020   newick(.       
+00019b60: 2073 656c 662c 0a20 2020 2020 2020 2070   self,.        p
+00019b70: 7265 6369 7369 6f6e 3d31 342c 0a20 2020  recision=14,.   
+00019b80: 2020 2020 202a 2c0a 2020 2020 2020 2020       *,.        
+00019b90: 726f 6f74 3d4e 6f6e 652c 0a20 2020 2020  root=None,.     
+00019ba0: 2020 206e 6f64 655f 6c61 6265 6c73 3d4e     node_labels=N
+00019bb0: 6f6e 652c 0a20 2020 2020 2020 2069 6e63  one,.        inc
+00019bc0: 6c75 6465 5f62 7261 6e63 685f 6c65 6e67  lude_branch_leng
+00019bd0: 7468 733d 5472 7565 2c0a 2020 2020 293a  ths=True,.    ):
+00019be0: 0a20 2020 2020 2020 2022 2222 0a20 2020  .        """.   
+00019bf0: 2020 2020 202e 2e20 7761 726e 696e 673a       .. warning:
+00019c00: 3a20 5468 6973 206d 6574 686f 6420 6973  : This method is
+00019c10: 2064 6570 7265 6361 7465 6420 616e 6420   deprecated and 
+00019c20: 6d61 7920 6265 2072 656d 6f76 6564 2069  may be removed i
+00019c30: 6e20 6675 7475 7265 0a20 2020 2020 2020  n future.       
+00019c40: 2020 2020 2076 6572 7369 6f6e 7320 6f66       versions of
+00019c50: 2074 736b 6974 2e20 506c 6561 7365 2075   tskit. Please u
+00019c60: 7365 2074 6865 203a 6d65 7468 3a60 2e61  se the :meth:`.a
+00019c70: 735f 6e65 7769 636b 6020 6d65 7468 6f64  s_newick` method
+00019c80: 0a20 2020 2020 2020 2020 2020 2069 6e20  .            in 
+00019c90: 6e65 7720 636f 6465 2e0a 0a20 2020 2020  new code...     
+00019ca0: 2020 2054 6869 7320 6d65 7468 6f64 2069     This method i
+00019cb0: 7320 6120 6465 7072 6563 6174 6564 2076  s a deprecated v
+00019cc0: 6572 7369 6f6e 206f 6620 7468 6520 3a6d  ersion of the :m
+00019cd0: 6574 683a 602e 6173 5f6e 6577 6963 6b60  eth:`.as_newick`
+00019ce0: 206d 6574 686f 642e 0a20 2020 2020 2020   method..       
+00019cf0: 2046 756e 6374 696f 6e61 6c69 7479 2069   Functionality i
+00019d00: 7320 6571 7569 7661 6c65 6e74 2c20 6578  s equivalent, ex
+00019d10: 6365 7074 2066 6f72 2074 6865 2064 6566  cept for the def
+00019d20: 6175 6c74 206e 6f64 6520 6c61 6265 6c73  ault node labels
+00019d30: 2e0a 0a20 2020 2020 2020 2042 7920 6465  ...        By de
+00019d40: 6661 756c 742c 202a 6c65 6166 2a20 6e6f  fault, *leaf* no
+00019d50: 6465 7320 6172 6520 6c61 6265 6c6c 6564  des are labelled
+00019d60: 2077 6974 6820 7468 6569 7220 6e75 6d65   with their nume
+00019d70: 7269 6361 6c20 4944 202b 2031 2c0a 2020  rical ID + 1,.  
+00019d80: 2020 2020 2020 616e 6420 696e 7465 726e        and intern
+00019d90: 616c 206e 6f64 6573 2061 7265 206e 6f74  al nodes are not
+00019da0: 206c 6162 656c 6c65 642e 2054 6869 7320   labelled. This 
+00019db0: 6465 6661 756c 7420 7374 7261 7465 6779  default strategy
+00019dc0: 2077 6173 206f 7269 6769 6e61 6c6c 790a   was originally.
+00019dd0: 2020 2020 2020 2020 7573 6564 2074 6f20          used to 
+00019de0: 6d69 6d69 6320 7468 6520 6f75 7470 7574  mimic the output
+00019df0: 206f 6620 7468 6520 6060 6d73 6060 2073   of the ``ms`` s
+00019e00: 696d 756c 6174 6f72 2e20 486f 7765 7665  imulator. Howeve
+00019e10: 722c 2074 6865 2063 686f 6963 650a 2020  r, the choice.  
+00019e20: 2020 2020 2020 6f66 206c 6162 656c 6c69        of labelli
+00019e30: 6e67 206c 6561 6620 6e6f 6465 7320 7261  ng leaf nodes ra
+00019e40: 7468 6572 2074 6861 6e20 7361 6d70 6c65  ther than sample
+00019e50: 7320 6973 2070 726f 626c 656d 6174 6963  s is problematic
+00019e60: 2c20 616e 6420 7468 6973 0a20 2020 2020  , and this.     
+00019e70: 2020 2062 6568 6176 696f 7572 2069 7320     behaviour is 
+00019e80: 6f6e 6c79 2072 6574 6169 6e65 6420 746f  only retained to
+00019e90: 2061 766f 6964 2062 7265 616b 696e 6720   avoid breaking 
+00019ea0: 6578 6973 7469 6e67 2063 6f64 6520 7768  existing code wh
+00019eb0: 6963 6820 6d61 790a 2020 2020 2020 2020  ich may.        
+00019ec0: 7265 6c79 206f 6e20 6974 2e0a 0a20 2020  rely on it...   
+00019ed0: 2020 2020 204f 7468 6572 2070 6172 616d       Other param
+00019ee0: 6574 6572 7320 6265 6861 7665 2061 7320  eters behave as 
+00019ef0: 646f 6375 6d65 6e74 6564 2069 6e20 7468  documented in th
+00019f00: 6520 3a6d 6574 683a 602e 6173 5f6e 6577  e :meth:`.as_new
+00019f10: 6963 6b60 206d 6574 686f 642e 0a0a 2020  ick` method...  
+00019f20: 2020 2020 2020 3a70 6172 616d 2069 6e74        :param int
+00019f30: 2070 7265 6369 7369 6f6e 3a20 5468 6520   precision: The 
+00019f40: 6e75 6d65 7269 6361 6c20 7072 6563 6973  numerical precis
+00019f50: 696f 6e20 7769 7468 2077 6869 6368 2062  ion with which b
+00019f60: 7261 6e63 6820 6c65 6e67 7468 7320 6172  ranch lengths ar
+00019f70: 650a 2020 2020 2020 2020 2020 2020 7072  e.            pr
+00019f80: 696e 7465 642e 2044 6566 6175 6c74 7320  inted. Defaults 
+00019f90: 746f 2031 342e 0a20 2020 2020 2020 203a  to 14..        :
+00019fa0: 7061 7261 6d20 696e 7420 726f 6f74 3a20  param int root: 
+00019fb0: 4966 2073 7065 6369 6669 6564 2c20 7265  If specified, re
+00019fc0: 7475 726e 2074 6865 2074 7265 6520 726f  turn the tree ro
+00019fd0: 6f74 6564 2061 7420 7468 6973 206e 6f64  oted at this nod
+00019fe0: 652e 0a20 2020 2020 2020 203a 7061 7261  e..        :para
+00019ff0: 6d20 6469 6374 206e 6f64 655f 6c61 6265  m dict node_labe
+0001a000: 6c73 3a20 4966 2073 7065 6369 6669 6564  ls: If specified
+0001a010: 2c20 7368 6f77 2063 7573 746f 6d20 6c61  , show custom la
+0001a020: 6265 6c73 2066 6f72 2074 6865 206e 6f64  bels for the nod
+0001a030: 6573 0a20 2020 2020 2020 2020 2020 2074  es.            t
+0001a040: 6861 7420 6172 6520 7072 6573 656e 7420  hat are present 
+0001a050: 696e 2074 6865 206d 6170 2e20 416e 7920  in the map. Any 
+0001a060: 6e6f 6465 7320 6e6f 7420 7370 6563 6966  nodes not specif
+0001a070: 6965 6420 696e 2074 6865 206d 6170 2077  ied in the map w
+0001a080: 696c 6c0a 2020 2020 2020 2020 2020 2020  ill.            
+0001a090: 6e6f 7420 6861 7665 2061 206e 6f64 6520  not have a node 
+0001a0a0: 6c61 6265 6c2e 0a20 2020 2020 2020 203a  label..        :
+0001a0b0: 7061 7261 6d20 696e 636c 7564 655f 6272  param include_br
+0001a0c0: 616e 6368 5f6c 656e 6774 6873 3a20 4966  anch_lengths: If
+0001a0d0: 2054 7275 6520 2864 6566 6175 6c74 292c   True (default),
+0001a0e0: 206f 7574 7075 7420 6272 616e 6368 206c   output branch l
+0001a0f0: 656e 6774 6873 2069 6e20 7468 650a 2020  engths in the.  
+0001a100: 2020 2020 2020 2020 2020 4e65 7769 636b            Newick
+0001a110: 2073 7472 696e 672e 2049 6620 4661 6c73   string. If Fals
+0001a120: 652c 206f 6e6c 7920 6f75 7470 7574 2074  e, only output t
+0001a130: 6865 2074 6f70 6f6c 6f67 792c 2077 6974  he topology, wit
+0001a140: 686f 7574 2062 7261 6e63 6820 6c65 6e67  hout branch leng
+0001a150: 7468 732e 0a20 2020 2020 2020 203a 7265  ths..        :re
+0001a160: 7475 726e 3a20 4120 6e65 7769 636b 2072  turn: A newick r
+0001a170: 6570 7265 7365 6e74 6174 696f 6e20 6f66  epresentation of
+0001a180: 2074 6869 7320 7472 6565 2e0a 2020 2020   this tree..    
+0001a190: 2020 2020 3a72 7479 7065 3a20 7374 720a      :rtype: str.
+0001a1a0: 2020 2020 2020 2020 2222 220a 2020 2020          """.    
+0001a1b0: 2020 2020 6e6f 6465 5f6c 6162 656c 7320      node_labels 
+0001a1c0: 3d20 4c45 4741 4359 5f4d 535f 4c41 4245  = LEGACY_MS_LABE
+0001a1d0: 4c53 2069 6620 6e6f 6465 5f6c 6162 656c  LS if node_label
+0001a1e0: 7320 6973 204e 6f6e 6520 656c 7365 206e  s is None else n
+0001a1f0: 6f64 655f 6c61 6265 6c73 0a20 2020 2020  ode_labels.     
+0001a200: 2020 2072 6574 7572 6e20 7365 6c66 2e61     return self.a
+0001a210: 735f 6e65 7769 636b 280a 2020 2020 2020  s_newick(.      
+0001a220: 2020 2020 2020 726f 6f74 3d72 6f6f 742c        root=root,
+0001a230: 0a20 2020 2020 2020 2020 2020 2070 7265  .            pre
+0001a240: 6369 7369 6f6e 3d70 7265 6369 7369 6f6e  cision=precision
+0001a250: 2c0a 2020 2020 2020 2020 2020 2020 6e6f  ,.            no
+0001a260: 6465 5f6c 6162 656c 733d 6e6f 6465 5f6c  de_labels=node_l
+0001a270: 6162 656c 732c 0a20 2020 2020 2020 2020  abels,.         
+0001a280: 2020 2069 6e63 6c75 6465 5f62 7261 6e63     include_branc
+0001a290: 685f 6c65 6e67 7468 733d 696e 636c 7564  h_lengths=includ
+0001a2a0: 655f 6272 616e 6368 5f6c 656e 6774 6873  e_branch_lengths
+0001a2b0: 2c0a 2020 2020 2020 2020 290a 0a20 2020  ,.        )..   
+0001a2c0: 2064 6566 2061 735f 6469 6374 5f6f 665f   def as_dict_of_
+0001a2d0: 6469 6374 7328 7365 6c66 293a 0a20 2020  dicts(self):.   
+0001a2e0: 2020 2020 2022 2222 0a20 2020 2020 2020       """.       
+0001a2f0: 2043 6f6e 7665 7274 2074 7265 6520 746f   Convert tree to
+0001a300: 2064 6963 7420 6f66 2064 6963 7473 2066   dict of dicts f
+0001a310: 6f72 2063 6f6e 7665 7273 696f 6e20 746f  or conversion to
+0001a320: 2061 0a20 2020 2020 2020 2060 6e65 7477   a.        `netw
+0001a330: 6f72 6b78 2067 7261 7068 203c 6874 7470  orkx graph <http
+0001a340: 733a 2f2f 6e65 7477 6f72 6b78 2e67 6974  s://networkx.git
+0001a350: 6875 622e 696f 2f64 6f63 756d 656e 7461  hub.io/documenta
+0001a360: 7469 6f6e 2f73 7461 626c 652f 0a20 2020  tion/stable/.   
+0001a370: 2020 2020 2072 6566 6572 656e 6365 2f63       reference/c
+0001a380: 6c61 7373 6573 2f64 6967 7261 7068 2e68  lasses/digraph.h
+0001a390: 746d 6c3e 605f 2e0a 0a20 2020 2020 2020  tml>`_...       
+0001a3a0: 2046 6f72 2065 7861 6d70 6c65 3a3a 0a0a   For example::..
+0001a3b0: 2020 2020 2020 2020 2020 2020 3e3e 3e20              >>> 
+0001a3c0: 696d 706f 7274 206e 6574 776f 726b 7820  import networkx 
+0001a3d0: 6173 206e 780a 2020 2020 2020 2020 2020  as nx.          
+0001a3e0: 2020 3e3e 3e20 6e78 2e44 6947 7261 7068    >>> nx.DiGraph
+0001a3f0: 2874 7265 652e 6173 5f64 6963 745f 6f66  (tree.as_dict_of
+0001a400: 5f64 6963 7473 2829 290a 2020 2020 2020  _dicts()).      
+0001a410: 2020 2020 2020 3e3e 3e20 2320 756e 6469        >>> # undi
+0001a420: 7265 6374 6564 2067 7261 7068 7320 776f  rected graphs wo
+0001a430: 726b 2061 7320 7765 6c6c 0a20 2020 2020  rk as well.     
+0001a440: 2020 2020 2020 203e 3e3e 206e 782e 4772         >>> nx.Gr
+0001a450: 6170 6828 7472 6565 2e61 735f 6469 6374  aph(tree.as_dict
+0001a460: 5f6f 665f 6469 6374 7328 2929 0a0a 2020  _of_dicts())..  
+0001a470: 2020 2020 2020 3a72 6574 7572 6e3a 2044        :return: D
+0001a480: 6963 7469 6f6e 6172 7920 6f66 2064 6963  ictionary of dic
+0001a490: 7469 6f6e 6172 6965 7320 6f66 2064 6963  tionaries of dic
+0001a4a0: 7469 6f6e 6172 6965 7320 7768 6572 6520  tionaries where 
+0001a4b0: 7468 6520 6669 7273 7420 6b65 790a 2020  the first key.  
+0001a4c0: 2020 2020 2020 2020 2020 6973 2074 6865            is the
+0001a4d0: 2073 6f75 7263 652c 2074 6865 2073 6563   source, the sec
+0001a4e0: 6f6e 6420 6b65 7920 6973 2074 6865 2074  ond key is the t
+0001a4f0: 6172 6765 7420 6f66 2061 6e20 6564 6765  arget of an edge
+0001a500: 2c20 616e 6420 7468 650a 2020 2020 2020  , and the.      
+0001a510: 2020 2020 2020 7468 6972 6420 6b65 7920        third key 
+0001a520: 6973 2061 6e20 6564 6765 2061 6e6e 6f74  is an edge annot
+0001a530: 6174 696f 6e2e 2041 7420 7468 6973 2070  ation. At this p
+0001a540: 6f69 6e74 2074 6865 206f 6e6c 7920 616e  oint the only an
+0001a550: 6e6f 7461 7469 6f6e 0a20 2020 2020 2020  notation.       
+0001a560: 2020 2020 2069 7320 2262 7261 6e63 685f       is "branch_
+0001a570: 6c65 6e67 7468 222c 2074 6865 206c 656e  length", the len
+0001a580: 6774 6820 6f66 2074 6865 2062 7261 6e63  gth of the branc
+0001a590: 6820 2869 6e20 756e 6974 7320 6f66 2074  h (in units of t
+0001a5a0: 696d 6529 2e0a 2020 2020 2020 2020 2222  ime)..        ""
+0001a5b0: 220a 2020 2020 2020 2020 646f 6420 3d20  ".        dod = 
+0001a5c0: 7b7d 0a20 2020 2020 2020 2066 6f72 2070  {}.        for p
+0001a5d0: 6172 656e 7420 696e 2073 656c 662e 6e6f  arent in self.no
+0001a5e0: 6465 7328 293a 0a20 2020 2020 2020 2020  des():.         
+0001a5f0: 2020 2064 6f64 5b70 6172 656e 745d 203d     dod[parent] =
+0001a600: 207b 7d0a 2020 2020 2020 2020 2020 2020   {}.            
+0001a610: 666f 7220 6368 696c 6420 696e 2073 656c  for child in sel
+0001a620: 662e 6368 696c 6472 656e 2870 6172 656e  f.children(paren
+0001a630: 7429 3a0a 2020 2020 2020 2020 2020 2020  t):.            
+0001a640: 2020 2020 646f 645b 7061 7265 6e74 5d5b      dod[parent][
+0001a650: 6368 696c 645d 203d 207b 2262 7261 6e63  child] = {"branc
+0001a660: 685f 6c65 6e67 7468 223a 2073 656c 662e  h_length": self.
+0001a670: 6272 616e 6368 5f6c 656e 6774 6828 6368  branch_length(ch
+0001a680: 696c 6429 7d0a 2020 2020 2020 2020 7265  ild)}.        re
+0001a690: 7475 726e 2064 6f64 0a0a 2020 2020 4070  turn dod..    @p
+0001a6a0: 726f 7065 7274 790a 2020 2020 6465 6620  roperty.    def 
+0001a6b0: 7061 7265 6e74 5f64 6963 7428 7365 6c66  parent_dict(self
+0001a6c0: 293a 0a20 2020 2020 2020 2072 6574 7572  ):.        retur
+0001a6d0: 6e20 7365 6c66 2e67 6574 5f70 6172 656e  n self.get_paren
+0001a6e0: 745f 6469 6374 2829 0a0a 2020 2020 6465  t_dict()..    de
+0001a6f0: 6620 6765 745f 7061 7265 6e74 5f64 6963  f get_parent_dic
+0001a700: 7428 7365 6c66 293a 0a20 2020 2020 2020  t(self):.       
+0001a710: 2070 6920 3d20 7b0a 2020 2020 2020 2020   pi = {.        
+0001a720: 2020 2020 753a 2073 656c 662e 7061 7265      u: self.pare
+0001a730: 6e74 2875 290a 2020 2020 2020 2020 2020  nt(u).          
+0001a740: 2020 666f 7220 7520 696e 2072 616e 6765    for u in range
+0001a750: 2873 656c 662e 7472 6565 5f73 6571 7565  (self.tree_seque
+0001a760: 6e63 652e 6e75 6d5f 6e6f 6465 7329 0a20  nce.num_nodes). 
+0001a770: 2020 2020 2020 2020 2020 2069 6620 7365             if se
+0001a780: 6c66 2e70 6172 656e 7428 7529 2021 3d20  lf.parent(u) != 
+0001a790: 4e55 4c4c 0a20 2020 2020 2020 207d 0a20  NULL.        }. 
+0001a7a0: 2020 2020 2020 2072 6574 7572 6e20 7069         return pi
+0001a7b0: 0a0a 2020 2020 6465 6620 5f5f 7374 725f  ..    def __str_
+0001a7c0: 5f28 7365 6c66 293a 0a20 2020 2020 2020  _(self):.       
+0001a7d0: 2022 2222 0a20 2020 2020 2020 2052 6574   """.        Ret
+0001a7e0: 7572 6e20 6120 706c 6169 6e20 7465 7874  urn a plain text
+0001a7f0: 2073 756d 6d61 7279 206f 6620 6120 7472   summary of a tr
+0001a800: 6565 2069 6e20 6120 7472 6565 2073 6571  ee in a tree seq
+0001a810: 7565 6e63 650a 2020 2020 2020 2020 2222  uence.        ""
+0001a820: 220a 2020 2020 2020 2020 7472 6565 5f72  ".        tree_r
+0001a830: 6f77 7320 3d20 5b0a 2020 2020 2020 2020  ows = [.        
+0001a840: 2020 2020 5b22 496e 6465 7822 2c20 7374      ["Index", st
+0001a850: 7228 7365 6c66 2e69 6e64 6578 295d 2c0a  r(self.index)],.
+0001a860: 2020 2020 2020 2020 2020 2020 5b0a 2020              [.  
+0001a870: 2020 2020 2020 2020 2020 2020 2020 2249                "I
+0001a880: 6e74 6572 7661 6c22 2c0a 2020 2020 2020  nterval",.      
+0001a890: 2020 2020 2020 2020 2020 6622 7b73 656c            f"{sel
+0001a8a0: 662e 696e 7465 7276 616c 2e6c 6566 743a  f.interval.left:
+0001a8b0: 2e38 677d 2d7b 7365 6c66 2e69 6e74 6572  .8g}-{self.inter
+0001a8c0: 7661 6c2e 7269 6768 743a 2e38 677d 2028  val.right:.8g} (
+0001a8d0: 7b73 656c 662e 7370 616e 3a2e 3867 7d29  {self.span:.8g})
+0001a8e0: 222c 0a20 2020 2020 2020 2020 2020 205d  ",.            ]
+0001a8f0: 2c0a 2020 2020 2020 2020 2020 2020 5b22  ,.            ["
+0001a900: 526f 6f74 7322 2c20 7374 7228 7365 6c66  Roots", str(self
+0001a910: 2e6e 756d 5f72 6f6f 7473 295d 2c0a 2020  .num_roots)],.  
+0001a920: 2020 2020 2020 2020 2020 5b22 4e6f 6465            ["Node
+0001a930: 7322 2c20 7374 7228 6c65 6e28 7365 6c66  s", str(len(self
+0001a940: 2e70 7265 6f72 6465 7228 2929 295d 2c0a  .preorder()))],.
+0001a950: 2020 2020 2020 2020 2020 2020 5b22 5369              ["Si
+0001a960: 7465 7322 2c20 7374 7228 7365 6c66 2e6e  tes", str(self.n
+0001a970: 756d 5f73 6974 6573 295d 2c0a 2020 2020  um_sites)],.    
+0001a980: 2020 2020 2020 2020 5b22 4d75 7461 7469          ["Mutati
+0001a990: 6f6e 7322 2c20 7374 7228 7365 6c66 2e6e  ons", str(self.n
+0001a9a0: 756d 5f6d 7574 6174 696f 6e73 295d 2c0a  um_mutations)],.
+0001a9b0: 2020 2020 2020 2020 2020 2020 5b22 546f              ["To
+0001a9c0: 7461 6c20 4272 616e 6368 204c 656e 6774  tal Branch Lengt
+0001a9d0: 6822 2c20 6622 7b73 656c 662e 746f 7461  h", f"{self.tota
+0001a9e0: 6c5f 6272 616e 6368 5f6c 656e 6774 683a  l_branch_length:
+0001a9f0: 2e38 677d 225d 2c0a 2020 2020 2020 2020  .8g}"],.        
+0001aa00: 5d0a 2020 2020 2020 2020 7265 7475 726e  ].        return
+0001aa10: 2075 7469 6c2e 756e 6963 6f64 655f 7461   util.unicode_ta
+0001aa20: 626c 6528 7472 6565 5f72 6f77 732c 2074  ble(tree_rows, t
+0001aa30: 6974 6c65 3d22 5472 6565 2229 0a0a 2020  itle="Tree")..  
+0001aa40: 2020 6465 6620 5f72 6570 725f 6874 6d6c    def _repr_html
+0001aa50: 5f28 7365 6c66 293a 0a20 2020 2020 2020  _(self):.       
+0001aa60: 2022 2222 0a20 2020 2020 2020 2052 6574   """.        Ret
+0001aa70: 7572 6e20 616e 2068 746d 6c20 7375 6d6d  urn an html summ
+0001aa80: 6172 7920 6f66 2061 2074 7265 6520 696e  ary of a tree in
+0001aa90: 2061 2074 7265 6520 7365 7175 656e 6365   a tree sequence
+0001aaa0: 2e20 4361 6c6c 6564 2062 7920 6a75 7079  . Called by jupy
+0001aab0: 7465 720a 2020 2020 2020 2020 6e6f 7465  ter.        note
+0001aac0: 626f 6f6b 7320 746f 2072 656e 6465 7220  books to render 
+0001aad0: 7472 6565 730a 2020 2020 2020 2020 2222  trees.        ""
+0001aae0: 220a 2020 2020 2020 2020 7265 7475 726e  ".        return
+0001aaf0: 2075 7469 6c2e 7472 6565 5f68 746d 6c28   util.tree_html(
+0001ab00: 7365 6c66 290a 0a20 2020 2064 6566 206d  self)..    def m
+0001ab10: 6170 5f6d 7574 6174 696f 6e73 2873 656c  ap_mutations(sel
+0001ab20: 662c 2067 656e 6f74 7970 6573 2c20 616c  f, genotypes, al
+0001ab30: 6c65 6c65 732c 2061 6e63 6573 7472 616c  leles, ancestral
+0001ab40: 5f73 7461 7465 3d4e 6f6e 6529 3a0a 2020  _state=None):.  
+0001ab50: 2020 2020 2020 2222 220a 2020 2020 2020        """.      
+0001ab60: 2020 4769 7665 6e20 6f62 7365 7276 6174    Given observat
+0001ab70: 696f 6e73 2066 6f72 2074 6865 2073 616d  ions for the sam
+0001ab80: 706c 6573 2069 6e20 7468 6973 2074 7265  ples in this tre
+0001ab90: 6520 6465 7363 7269 6265 6420 6279 2074  e described by t
+0001aba0: 6865 2073 7065 6369 6669 6564 0a20 2020  he specified.   
+0001abb0: 2020 2020 2073 6574 206f 6620 6765 6e6f       set of geno
+0001abc0: 7479 7065 7320 616e 6420 616c 6c65 6c65  types and allele
+0001abd0: 732c 2072 6574 7572 6e20 6120 7061 7273  s, return a pars
+0001abe0: 696d 6f6e 696f 7573 2073 6574 206f 6620  imonious set of 
+0001abf0: 7374 6174 6520 7472 616e 7369 7469 6f6e  state transition
+0001ac00: 730a 2020 2020 2020 2020 6578 706c 6169  s.        explai
+0001ac10: 6e69 6e67 2074 6865 7365 206f 6273 6572  ning these obser
+0001ac20: 7661 7469 6f6e 732e 2054 6865 2067 656e  vations. The gen
+0001ac30: 6f74 7970 6573 2061 7272 6179 2069 7320  otypes array is 
+0001ac40: 696e 7465 7270 7265 7465 6420 6173 2069  interpreted as i
+0001ac50: 6e64 6578 6573 0a20 2020 2020 2020 2069  ndexes.        i
+0001ac60: 6e74 6f20 7468 6520 616c 6c65 6c65 7320  nto the alleles 
+0001ac70: 6c69 7374 2069 6e20 7468 6520 7361 6d65  list in the same
+0001ac80: 206d 616e 6e65 7220 6173 2064 6573 6372   manner as descr
+0001ac90: 6962 6564 2069 6e20 7468 650a 2020 2020  ibed in the.    
+0001aca0: 2020 2020 3a6d 6574 683a 6054 7265 6553      :meth:`TreeS
+0001acb0: 6571 7565 6e63 652e 7661 7269 616e 7473  equence.variants
+0001acc0: 6020 6d65 7468 6f64 2e20 5468 7573 2c20  ` method. Thus, 
+0001acd0: 6966 2073 616d 706c 6520 6060 6a60 6020  if sample ``j`` 
+0001ace0: 6361 7272 6965 7320 7468 650a 2020 2020  carries the.    
+0001acf0: 2020 2020 616c 6c65 6c65 2061 7420 696e      allele at in
+0001ad00: 6465 7820 6060 6b60 602c 2074 6865 6e20  dex ``k``, then 
+0001ad10: 7765 2068 6176 6520 6060 6765 6e6f 7479  we have ``genoty
+0001ad20: 7065 735b 6a5d 203d 206b 6060 2e0a 2020  pes[j] = k``..  
+0001ad30: 2020 2020 2020 4d69 7373 696e 6720 6f62        Missing ob
+0001ad40: 7365 7276 6174 696f 6e73 2063 616e 2062  servations can b
+0001ad50: 6520 7370 6563 6966 6965 6420 666f 7220  e specified for 
+0001ad60: 6120 7361 6d70 6c65 2075 7369 6e67 2074  a sample using t
+0001ad70: 6865 2076 616c 7565 0a20 2020 2020 2020  he value.       
+0001ad80: 2060 6074 736b 6974 2e4d 4953 5349 4e47   ``tskit.MISSING
+0001ad90: 5f44 4154 4160 6020 282d 3129 2c20 696e  _DATA`` (-1), in
+0001ada0: 2077 6869 6368 2063 6173 6520 7468 6520   which case the 
+0001adb0: 7374 6174 6520 6174 2074 6869 7320 7361  state at this sa
+0001adc0: 6d70 6c65 2064 6f65 7320 6e6f 740a 2020  mple does not.  
+0001add0: 2020 2020 2020 696e 666c 7565 6e63 6520        influence 
+0001ade0: 7468 6520 616e 6365 7374 7261 6c20 7374  the ancestral st
+0001adf0: 6174 6520 6f72 2074 6865 2070 6f73 6974  ate or the posit
+0001ae00: 696f 6e20 6f66 206d 7574 6174 696f 6e73  ion of mutations
+0001ae10: 2072 6574 7572 6e65 642e 2041 7420 6c65   returned. At le
+0001ae20: 6173 740a 2020 2020 2020 2020 6f6e 6520  ast.        one 
+0001ae30: 6e6f 6e2d 6d69 7373 696e 6720 6f62 7365  non-missing obse
+0001ae40: 7276 6174 696f 6e20 6d75 7374 2062 6520  rvation must be 
+0001ae50: 7072 6f76 6964 6564 2e20 4120 6d61 7869  provided. A maxi
+0001ae60: 6d75 6d20 6f66 2036 3420 616c 6c65 6c65  mum of 64 allele
+0001ae70: 7320 6172 650a 2020 2020 2020 2020 7375  s are.        su
+0001ae80: 7070 6f72 7465 642e 0a0a 2020 2020 2020  pported...      
+0001ae90: 2020 5468 6520 6375 7272 656e 7420 696d    The current im
+0001aea0: 706c 656d 656e 7461 7469 6f6e 2075 7365  plementation use
+0001aeb0: 7320 7468 6520 4861 7274 6967 616e 2070  s the Hartigan p
+0001aec0: 6172 7369 6d6f 6e79 2061 6c67 6f72 6974  arsimony algorit
+0001aed0: 686d 2074 6f20 6465 7465 726d 696e 650a  hm to determine.
+0001aee0: 2020 2020 2020 2020 7468 6520 6d69 6e69          the mini
+0001aef0: 6d75 6d20 6e75 6d62 6572 206f 6620 7374  mum number of st
+0001af00: 6174 6520 7472 616e 7369 7469 6f6e 7320  ate transitions 
+0001af10: 7265 7175 6972 6564 2074 6f20 6578 706c  required to expl
+0001af20: 6169 6e20 7468 6520 6461 7461 2e20 496e  ain the data. In
+0001af30: 2074 6869 730a 2020 2020 2020 2020 6d6f   this.        mo
+0001af40: 6465 6c2c 2074 7261 6e73 6974 696f 6e73  del, transitions
+0001af50: 2062 6574 7765 656e 2061 6e79 206f 6620   between any of 
+0001af60: 7468 6520 6e6f 6e2d 6d69 7373 696e 6720  the non-missing 
+0001af70: 7374 6174 6573 2069 7320 6571 7561 6c6c  states is equall
+0001af80: 7920 6c69 6b65 6c79 2e0a 0a20 2020 2020  y likely...     
+0001af90: 2020 2054 6865 2072 6574 7572 6e65 6420     The returned 
+0001afa0: 7661 6c75 6573 2063 6f72 7265 7370 6f6e  values correspon
+0001afb0: 6420 6469 7265 6374 6c79 2074 6f20 7468  d directly to th
+0001afc0: 6520 6461 7461 206d 6f64 656c 2066 6f72  e data model for
+0001afd0: 2064 6573 6372 6962 696e 670a 2020 2020   describing.    
+0001afe0: 2020 2020 7661 7269 6174 696f 6e20 6174      variation at
+0001aff0: 2073 6974 6573 2075 7369 6e67 206d 7574   sites using mut
+0001b000: 6174 696f 6e73 2e20 5365 6520 7468 6520  ations. See the 
+0001b010: 3a72 6566 3a60 7365 635f 7369 7465 5f74  :ref:`sec_site_t
+0001b020: 6162 6c65 5f64 6566 696e 6974 696f 6e60  able_definition`
+0001b030: 0a20 2020 2020 2020 2061 6e64 203a 7265  .        and :re
+0001b040: 663a 6073 6563 5f6d 7574 6174 696f 6e5f  f:`sec_mutation_
+0001b050: 7461 626c 655f 6465 6669 6e69 7469 6f6e  table_definition
+0001b060: 6020 6465 6669 6e69 7469 6f6e 7320 666f  ` definitions fo
+0001b070: 7220 6465 7461 696c 7320 616e 6420 6261  r details and ba
+0001b080: 636b 6772 6f75 6e64 2e0a 0a20 2020 2020  ckground...     
+0001b090: 2020 2054 6865 2073 7461 7465 2072 6563     The state rec
+0001b0a0: 6f6e 7374 7275 6374 696f 6e20 6973 2072  onstruction is r
+0001b0b0: 6574 7572 6e65 6420 6173 2074 776f 2d74  eturned as two-t
+0001b0c0: 7570 6c65 2c20 6060 2861 6e63 6573 7472  uple, ``(ancestr
+0001b0d0: 616c 5f73 7461 7465 2c0a 2020 2020 2020  al_state,.      
+0001b0e0: 2020 6d75 7461 7469 6f6e 7329 6060 2c20    mutations)``, 
+0001b0f0: 7768 6572 6520 6060 616e 6365 7374 7261  where ``ancestra
+0001b100: 6c5f 7374 6174 6560 6020 6973 2074 6865  l_state`` is the
+0001b110: 2061 6c6c 656c 6520 6173 7369 676e 6564   allele assigned
+0001b120: 2074 6f20 7468 650a 2020 2020 2020 2020   to the.        
+0001b130: 7472 6565 2072 6f6f 7428 7329 2061 6e64  tree root(s) and
+0001b140: 2060 606d 7574 6174 696f 6e73 6060 2069   ``mutations`` i
+0001b150: 7320 6120 6c69 7374 206f 6620 3a63 6c61  s a list of :cla
+0001b160: 7373 3a60 4d75 7461 7469 6f6e 6020 6f62  ss:`Mutation` ob
+0001b170: 6a65 6374 732c 0a20 2020 2020 2020 206f  jects,.        o
+0001b180: 7264 6572 6564 2061 7320 3a72 6566 3a60  rdered as :ref:`
+0001b190: 7265 7175 6972 6564 2069 6e20 6120 6d75  required in a mu
+0001b1a0: 7461 7469 6f6e 2074 6162 6c65 3c73 6563  tation table<sec
+0001b1b0: 5f6d 7574 6174 696f 6e5f 7265 7175 6972  _mutation_requir
+0001b1c0: 656d 656e 7473 3e60 2e0a 2020 2020 2020  ements>`..      
+0001b1d0: 2020 466f 7220 6561 6368 206d 7574 6174    For each mutat
+0001b1e0: 696f 6e2c 2060 6064 6572 6976 6564 5f73  ion, ``derived_s
+0001b1f0: 7461 7465 6060 2069 7320 7468 6520 6e65  tate`` is the ne
+0001b200: 7720 7374 6174 6520 6166 7465 7220 7468  w state after th
+0001b210: 6973 206d 7574 6174 696f 6e20 616e 640a  is mutation and.
+0001b220: 2020 2020 2020 2020 6060 6e6f 6465 6060          ``node``
+0001b230: 2069 7320 7468 6520 7472 6565 206e 6f64   is the tree nod
+0001b240: 6520 696d 6d65 6469 6174 656c 7920 6265  e immediately be
+0001b250: 6e65 6174 6820 7468 6520 6d75 7461 7469  neath the mutati
+0001b260: 6f6e 2028 6966 2074 6865 7265 2061 7265  on (if there are
+0001b270: 2075 6e61 7279 0a20 2020 2020 2020 206e   unary.        n
+0001b280: 6f64 6573 2062 6574 7765 656e 2074 776f  odes between two
+0001b290: 2062 7261 6e63 6820 706f 696e 7473 2c20   branch points, 
+0001b2a0: 6865 6e63 6520 6d75 6c74 6970 6c65 206e  hence multiple n
+0001b2b0: 6f64 6573 2061 626f 7665 2077 6869 6368  odes above which
+0001b2c0: 2074 6865 0a20 2020 2020 2020 206d 7574   the.        mut
+0001b2d0: 6174 696f 6e20 636f 756c 6420 6265 2070  ation could be p
+0001b2e0: 6172 7369 6d6f 6e69 6f75 736c 7920 706c  arsimoniously pl
+0001b2f0: 6163 6564 2c20 7468 6520 6f6c 6465 7374  aced, the oldest
+0001b300: 206e 6f64 6520 6973 2075 7365 6429 2e20   node is used). 
+0001b310: 5468 650a 2020 2020 2020 2020 6060 7061  The.        ``pa
+0001b320: 7265 6e74 6060 2070 726f 7065 7274 7920  rent`` property 
+0001b330: 636f 6e74 6169 6e73 2074 6865 2069 6e64  contains the ind
+0001b340: 6578 2069 6e20 7468 6520 7265 7475 726e  ex in the return
+0001b350: 6564 206c 6973 7420 6f66 2074 6865 2070  ed list of the p
+0001b360: 7265 7669 6f75 730a 2020 2020 2020 2020  revious.        
+0001b370: 6d75 7461 7469 6f6e 206f 6e20 7468 6520  mutation on the 
+0001b380: 7061 7468 2074 6f20 726f 6f74 2c20 6f72  path to root, or
+0001b390: 2060 6074 736b 6974 2e4e 554c 4c60 600a   ``tskit.NULL``.
+0001b3a0: 2020 2020 2020 2020 6966 2074 6865 7265          if there
+0001b3b0: 2061 7265 206e 6f20 7072 6576 696f 7573   are no previous
+0001b3c0: 206d 7574 6174 696f 6e73 2028 7365 6520   mutations (see 
+0001b3d0: 7468 6520 3a72 6566 3a60 7365 635f 6d75  the :ref:`sec_mu
+0001b3e0: 7461 7469 6f6e 5f74 6162 6c65 5f64 6566  tation_table_def
+0001b3f0: 696e 6974 696f 6e60 0a20 2020 2020 2020  inition`.       
+0001b400: 2066 6f72 206d 6f72 6520 696e 666f 726d   for more inform
+0001b410: 6174 696f 6e20 6f6e 2074 6865 2063 6f6e  ation on the con
+0001b420: 6365 7074 206f 6620 6d75 7461 7469 6f6e  cept of mutation
+0001b430: 2070 6172 656e 7473 292e 2041 6c6c 206f   parents). All o
+0001b440: 7468 6572 2061 7474 7269 6275 7465 730a  ther attributes.
+0001b450: 2020 2020 2020 2020 6f66 2074 6865 203a          of the :
+0001b460: 636c 6173 733a 604d 7574 6174 696f 6e60  class:`Mutation`
+0001b470: 206f 626a 6563 7420 6172 6520 756e 6465   object are unde
+0001b480: 6669 6e65 6420 616e 6420 7368 6f75 6c64  fined and should
+0001b490: 206e 6f74 2062 6520 7573 6564 2e0a 0a20   not be used... 
+0001b4a0: 2020 2020 2020 202e 2e20 6e6f 7465 3a3a         .. note::
+0001b4b0: 0a20 2020 2020 2020 2020 2020 2053 616d  .            Sam
+0001b4c0: 706c 6520 7374 6174 6573 206f 6273 6572  ple states obser
+0001b4d0: 7665 6420 6173 206d 6973 7369 6e67 2069  ved as missing i
+0001b4e0: 6e20 7468 6520 696e 7075 7420 6060 6765  n the input ``ge
+0001b4f0: 6e6f 7479 7065 7360 6020 6e65 6564 0a20  notypes`` need. 
+0001b500: 2020 2020 2020 2020 2020 206e 6f74 2063             not c
+0001b510: 6f72 7265 7370 6f6e 6420 746f 2073 616d  orrespond to sam
+0001b520: 706c 6573 2077 686f 7365 206e 6f64 6573  ples whose nodes
+0001b530: 2061 7265 2061 6374 7561 6c6c 7920 226d   are actually "m
+0001b540: 6973 7369 6e67 2220 2869 2e65 2e2c 0a20  issing" (i.e.,. 
+0001b550: 2020 2020 2020 2020 2020 203a 7265 663a             :ref:
+0001b560: 6069 736f 6c61 7465 643c 7365 635f 6461  `isolated<sec_da
+0001b570: 7461 5f6d 6f64 656c 5f6d 6973 7369 6e67  ta_model_missing
+0001b580: 5f64 6174 613e 6029 2069 6e20 7468 6520  _data>`) in the 
+0001b590: 7472 6565 2e20 496e 2074 6869 730a 2020  tree. In this.  
+0001b5a0: 2020 2020 2020 2020 2020 6361 7365 2c20            case, 
+0001b5b0: 6d61 7070 696e 6720 7468 6520 6d75 7461  mapping the muta
+0001b5c0: 7469 6f6e 7320 7265 7475 726e 6564 2062  tions returned b
+0001b5d0: 7920 7468 6973 206d 6574 686f 6420 6f6e  y this method on
+0001b5e0: 746f 2074 6865 2074 7265 650a 2020 2020  to the tree.    
+0001b5f0: 2020 2020 2020 2020 7769 6c6c 2072 6573          will res
+0001b600: 756c 7420 696e 2074 6865 7365 206d 6973  ult in these mis
+0001b610: 7369 6e67 206f 6273 6572 7661 7469 6f6e  sing observation
+0001b620: 7320 6265 696e 6720 696d 7075 7465 6420  s being imputed 
+0001b630: 746f 2074 6865 0a20 2020 2020 2020 2020  to the.         
+0001b640: 2020 206d 6f73 7420 7061 7273 696d 6f6e     most parsimon
+0001b650: 696f 7573 2073 7461 7465 2e0a 0a20 2020  ious state...   
+0001b660: 2020 2020 2042 6563 6175 7365 2074 6865       Because the
+0001b670: 2060 6070 6172 656e 7460 6020 696e 2074   ``parent`` in t
+0001b680: 6865 2072 6574 7572 6e65 6420 6c69 7374  he returned list
+0001b690: 206f 6620 6d75 7461 7469 6f6e 7320 7265   of mutations re
+0001b6a0: 6665 7273 2074 6f20 7468 6520 696e 6465  fers to the inde
+0001b6b0: 780a 2020 2020 2020 2020 696e 2074 6861  x.        in tha
+0001b6c0: 7420 6c69 7374 2c20 6966 2079 6f75 2061  t list, if you a
+0001b6d0: 7265 2061 6464 696e 6720 6d75 7461 7469  re adding mutati
+0001b6e0: 6f6e 7320 746f 2061 6e20 6578 6973 7469  ons to an existi
+0001b6f0: 6e67 2074 7265 6520 7365 7175 656e 6365  ng tree sequence
+0001b700: 2c20 796f 750a 2020 2020 2020 2020 7769  , you.        wi
+0001b710: 6c6c 206e 6565 6420 746f 206d 6169 6e74  ll need to maint
+0001b720: 6169 6e20 6120 6d61 7020 6f66 206c 6973  ain a map of lis
+0001b730: 7420 4944 7320 746f 2074 6865 206e 6577  t IDs to the new
+0001b740: 6c79 2061 6464 6564 206d 7574 6174 696f  ly added mutatio
+0001b750: 6e73 2c20 666f 720a 2020 2020 2020 2020  ns, for.        
+0001b760: 696e 7374 616e 6365 3a3a 0a0a 2020 2020  instance::..    
+0001b770: 2020 2020 2020 2020 6c61 7374 5f74 7265          last_tre
+0001b780: 6520 3d20 7473 2e6c 6173 7428 290a 2020  e = ts.last().  
+0001b790: 2020 2020 2020 2020 2020 616e 635f 7374            anc_st
+0001b7a0: 6174 652c 2070 6172 7369 6d6f 6e69 6f75  ate, parsimoniou
+0001b7b0: 735f 6d75 7473 203d 206c 6173 745f 7472  s_muts = last_tr
+0001b7c0: 6565 2e6d 6170 5f6d 7574 6174 696f 6e73  ee.map_mutations
+0001b7d0: 285b 302c 2031 2c20 305d 2c20 2822 4122  ([0, 1, 0], ("A"
+0001b7e0: 2c20 2254 2229 290a 2020 2020 2020 2020  , "T")).        
+0001b7f0: 2020 2020 2320 4564 6974 2074 6865 2074      # Edit the t
+0001b800: 7265 6520 7365 7175 656e 6365 2c20 7365  ree sequence, se
+0001b810: 6520 7468 6520 2254 6162 6c65 7320 616e  e the "Tables an
+0001b820: 6420 4564 6974 696e 6722 2074 7574 6f72  d Editing" tutor
+0001b830: 6961 6c0a 2020 2020 2020 2020 2020 2020  ial.            
+0001b840: 7461 626c 6573 203d 2074 732e 6475 6d70  tables = ts.dump
+0001b850: 5f74 6162 6c65 7328 290a 2020 2020 2020  _tables().      
+0001b860: 2020 2020 2020 2320 6164 6420 6120 6e65        # add a ne
+0001b870: 7720 7369 7465 2061 7420 7468 6520 656e  w site at the en
+0001b880: 6420 6f66 2074 732c 2061 7373 756d 6573  d of ts, assumes
+0001b890: 2074 6865 7265 2069 736e 2774 206f 6e65   there isn't one
+0001b8a0: 2074 6865 7265 2061 6c72 6561 6479 0a20   there already. 
+0001b8b0: 2020 2020 2020 2020 2020 2073 6974 655f             site_
+0001b8c0: 6964 203d 2074 6162 6c65 732e 7369 7465  id = tables.site
+0001b8d0: 732e 6164 645f 726f 7728 7473 2e73 6571  s.add_row(ts.seq
+0001b8e0: 7565 6e63 655f 6c65 6e67 7468 202d 2031  uence_length - 1
+0001b8f0: 2c20 616e 635f 7374 6174 6529 0a0a 2020  , anc_state)..  
+0001b900: 2020 2020 2020 2020 2020 6d75 745f 6964            mut_id
+0001b910: 5f6d 6170 203d 207b 7473 6b69 742e 4e55  _map = {tskit.NU
+0001b920: 4c4c 3a20 7473 6b69 742e 4e55 4c4c 7d20  LL: tskit.NULL} 
+0001b930: 2023 2064 6f6e 2774 2063 6861 6e67 6520   # don't change 
+0001b940: 6966 2070 6172 656e 7420 6964 2069 7320  if parent id is 
+0001b950: 2d31 0a20 2020 2020 2020 2020 2020 2066  -1.            f
+0001b960: 6f72 206c 6973 745f 6964 2c20 6d75 7461  or list_id, muta
+0001b970: 7469 6f6e 2069 6e20 656e 756d 6572 6174  tion in enumerat
+0001b980: 6528 7061 7273 696d 6f6e 696f 7573 5f6d  e(parsimonious_m
+0001b990: 7574 7329 3a0a 2020 2020 2020 2020 2020  uts):.          
+0001b9a0: 2020 2020 2020 6d75 745f 6964 5f6d 6170        mut_id_map
+0001b9b0: 5b6c 6973 745f 6964 5d20 3d20 7461 626c  [list_id] = tabl
+0001b9c0: 6573 2e6d 7574 6174 696f 6e73 2e61 7070  es.mutations.app
+0001b9d0: 656e 6428 0a20 2020 2020 2020 2020 2020  end(.           
+0001b9e0: 2020 2020 2020 2020 206d 7574 6174 696f           mutatio
+0001b9f0: 6e2e 7265 706c 6163 6528 7369 7465 3d73  n.replace(site=s
+0001ba00: 6974 655f 6964 2c20 7061 7265 6e74 3d6d  ite_id, parent=m
+0001ba10: 7574 5f69 645f 6d61 705b 6d75 7461 7469  ut_id_map[mutati
+0001ba20: 6f6e 2e70 6172 656e 745d 2929 0a20 2020  on.parent])).   
+0001ba30: 2020 2020 2020 2020 2074 6162 6c65 732e           tables.
+0001ba40: 736f 7274 2829 2020 2320 5265 6475 6e64  sort()  # Redund
+0001ba50: 616e 7420 6865 7265 2c20 6275 7420 6e65  ant here, but ne
+0001ba60: 6564 6564 2069 6620 7468 6520 7369 7465  eded if the site
+0001ba70: 2069 7320 6e6f 7420 7468 6520 6c61 7374   is not the last
+0001ba80: 206f 6e65 0a20 2020 2020 2020 2020 2020   one.           
+0001ba90: 206e 6577 5f74 7320 3d20 7461 626c 6573   new_ts = tables
+0001baa0: 2e74 7265 655f 7365 7175 656e 6365 2829  .tree_sequence()
+0001bab0: 0a0a 2020 2020 2020 2020 5365 6520 7468  ..        See th
+0001bac0: 6520 3a72 6566 3a60 7475 746f 7269 616c  e :ref:`tutorial
+0001bad0: 733a 7365 635f 616e 616c 7973 696e 675f  s:sec_analysing_
+0001bae0: 7472 6565 735f 7061 7273 696d 6f6e 7960  trees_parsimony`
+0001baf0: 2073 6563 7469 6f6e 2069 6e20 7468 6520   section in the 
+0001bb00: 7475 746f 7269 616c 0a20 2020 2020 2020  tutorial.       
+0001bb10: 2066 6f72 2066 7572 7468 6572 2065 7861   for further exa
+0001bb20: 6d70 6c65 7320 6f66 2068 6f77 2074 6f20  mples of how to 
+0001bb30: 7573 6520 7468 6973 206d 6574 686f 642e  use this method.
+0001bb40: 0a0a 2020 2020 2020 2020 3a70 6172 616d  ..        :param
+0001bb50: 2061 7272 6179 5f6c 696b 6520 6765 6e6f   array_like geno
+0001bb60: 7479 7065 733a 2054 6865 2069 6e70 7574  types: The input
+0001bb70: 206f 6273 6572 7661 7469 6f6e 7320 666f   observations fo
+0001bb80: 7220 7468 6520 7361 6d70 6c65 7320 696e  r the samples in
+0001bb90: 2074 6869 7320 7472 6565 2e0a 2020 2020   this tree..    
+0001bba0: 2020 2020 3a70 6172 616d 2074 7570 6c65      :param tuple
+0001bbb0: 2873 7472 2920 616c 6c65 6c65 733a 2054  (str) alleles: T
+0001bbc0: 6865 2061 6c6c 656c 6573 2066 6f72 2074  he alleles for t
+0001bbd0: 6865 2073 7065 6369 6669 6564 2060 6067  he specified ``g
+0001bbe0: 656e 6f74 7970 6573 6060 2e20 4561 6368  enotypes``. Each
+0001bbf0: 0a20 2020 2020 2020 2020 2020 2070 6f73  .            pos
+0001bc00: 6974 6976 6520 7661 6c75 6520 696e 2074  itive value in t
+0001bc10: 6865 2060 6067 656e 6f74 7970 6573 6060  he ``genotypes``
+0001bc20: 2061 7272 6179 2069 7320 7472 6561 7465   array is treate
+0001bc30: 6420 6173 2061 6e20 696e 6465 7820 696e  d as an index in
+0001bc40: 746f 2074 6869 730a 2020 2020 2020 2020  to this.        
+0001bc50: 2020 2020 6c69 7374 206f 6620 616c 6c65      list of alle
+0001bc60: 6c65 732e 0a20 2020 2020 2020 203a 7061  les..        :pa
+0001bc70: 7261 6d20 616e 6365 7374 7261 6c5f 7374  ram ancestral_st
+0001bc80: 6174 653a 2041 2066 6978 6564 2061 6e63  ate: A fixed anc
+0001bc90: 6573 7472 616c 2073 7461 7465 2c20 7370  estral state, sp
+0001bca0: 6563 6966 6965 6420 6569 7468 6572 2061  ecified either a
+0001bcb0: 7320 610a 2020 2020 2020 2020 2020 2020  s a.            
+0001bcc0: 6e6f 6e2d 6e65 6761 7469 7665 2069 6e74  non-negative int
+0001bcd0: 6567 6572 206c 6573 7320 7468 616e 2074  eger less than t
+0001bce0: 6865 206e 756d 6265 7220 6f66 2061 6c6c  he number of all
+0001bcf0: 656c 6573 2c20 6f72 2061 2073 7472 696e  eles, or a strin
+0001bd00: 6720 7768 6963 680a 2020 2020 2020 2020  g which.        
+0001bd10: 2020 2020 6d75 7374 2062 6520 6f6e 6520      must be one 
+0001bd20: 6f66 2074 6865 2060 6061 6c6c 656c 6573  of the ``alleles
+0001bd30: 6060 2070 726f 7669 6465 6420 6162 6f76  `` provided abov
+0001bd40: 652e 2049 6620 6060 4e6f 6e65 6060 2028  e. If ``None`` (
+0001bd50: 6465 6661 756c 7429 2074 6865 6e0a 2020  default) then.  
+0001bd60: 2020 2020 2020 2020 2020 616e 2061 6e63            an anc
+0001bd70: 6573 7472 616c 2073 7461 7465 2069 7320  estral state is 
+0001bd80: 6368 6f73 656e 2061 7262 6974 7261 7269  chosen arbitrari
+0001bd90: 6c79 2066 726f 6d20 616d 6f6e 6720 7468  ly from among th
+0001bda0: 6f73 6520 7468 6174 2070 726f 7669 6465  ose that provide
+0001bdb0: 0a20 2020 2020 2020 2020 2020 2074 6865  .            the
+0001bdc0: 206d 6f73 7420 7061 7273 696d 6f6e 696f   most parsimonio
+0001bdd0: 7573 2070 6c61 6365 6d65 6e74 206f 6620  us placement of 
+0001bde0: 6d75 7461 7469 6f6e 732e 204e 6f74 6520  mutations. Note 
+0001bdf0: 7468 6174 2069 6620 7468 6520 616e 6365  that if the ance
+0001be00: 7374 7261 6c0a 2020 2020 2020 2020 2020  stral.          
+0001be10: 2020 7374 6174 6520 6973 2073 7065 6369    state is speci
+0001be20: 6669 6564 2c20 7468 6520 706c 6163 656d  fied, the placem
+0001be30: 656e 7420 6f66 206d 7574 6174 696f 6e73  ent of mutations
+0001be40: 206d 6179 206e 6f74 2062 6520 6173 2070   may not be as p
+0001be50: 6172 7369 6d6f 6e69 6f75 730a 2020 2020  arsimonious.    
+0001be60: 2020 2020 2020 2020 6173 2074 6861 7420          as that 
+0001be70: 7768 6963 6820 636f 756c 6420 6265 2061  which could be a
+0001be80: 6368 6965 7665 6420 6279 206c 6561 7669  chieved by leavi
+0001be90: 6e67 2074 6865 2061 6e63 6573 7472 616c  ng the ancestral
+0001bea0: 2073 7461 7465 2075 6e73 7065 6369 6669   state unspecifi
+0001beb0: 6564 3b0a 2020 2020 2020 2020 2020 2020  ed;.            
+0001bec0: 6164 6469 7469 6f6e 616c 6c79 2069 7420  additionally it 
+0001bed0: 6d61 7920 6c65 6164 2074 6f20 6d75 7461  may lead to muta
+0001bee0: 7469 6f6e 7320 6265 696e 6720 706c 6163  tions being plac
+0001bef0: 6564 2061 626f 7665 2074 6865 2072 6f6f  ed above the roo
+0001bf00: 7420 6e6f 6465 2873 2920 6f66 0a20 2020  t node(s) of.   
+0001bf10: 2020 2020 2020 2020 2074 6865 2074 7265           the tre
+0001bf20: 6520 2866 6f72 2065 7861 6d70 6c65 2069  e (for example i
+0001bf30: 6620 616c 6c20 7468 6520 7361 6d70 6c65  f all the sample
+0001bf40: 7320 6861 7665 2061 2067 656e 6f74 7970  s have a genotyp
+0001bf50: 6520 6f66 2031 2062 7574 2074 6865 0a20  e of 1 but the. 
+0001bf60: 2020 2020 2020 2020 2020 2061 6e63 6573             ances
+0001bf70: 7472 616c 2073 7461 7465 2069 7320 6669  tral state is fi
+0001bf80: 7865 6420 746f 2062 6520 3029 2e0a 2020  xed to be 0)..  
+0001bf90: 2020 2020 2020 3a74 7970 6520 616e 6365        :type ance
+0001bfa0: 7374 7261 6c5f 7374 6174 653a 2055 6e69  stral_state: Uni
+0001bfb0: 6f6e 5b69 6e74 2c20 7374 725d 0a20 2020  on[int, str].   
+0001bfc0: 2020 2020 203a 7265 7475 726e 3a20 5468       :return: Th
+0001bfd0: 6520 696e 6665 7272 6564 2061 6e63 6573  e inferred ances
+0001bfe0: 7472 616c 2073 7461 7465 2061 6e64 206c  tral state and l
+0001bff0: 6973 7420 6f66 206d 7574 6174 696f 6e73  ist of mutations
+0001c000: 206f 6e20 7468 6973 2074 7265 650a 2020   on this tree.  
+0001c010: 2020 2020 2020 2020 2020 7468 6174 2065            that e
+0001c020: 6e63 6f64 6520 7468 6520 7370 6563 6966  ncode the specif
+0001c030: 6965 6420 6f62 7365 7276 6174 696f 6e73  ied observations
+0001c040: 2e0a 2020 2020 2020 2020 3a72 7479 7065  ..        :rtype
+0001c050: 3a20 2873 7472 2c20 6c69 7374 2874 736b  : (str, list(tsk
+0001c060: 6974 2e4d 7574 6174 696f 6e29 290a 2020  it.Mutation)).  
+0001c070: 2020 2020 2020 2222 220a 2020 2020 2020        """.      
+0001c080: 2020 6765 6e6f 7479 7065 7320 3d20 7574    genotypes = ut
+0001c090: 696c 2e73 6166 655f 6e70 5f69 6e74 5f63  il.safe_np_int_c
+0001c0a0: 6173 7428 6765 6e6f 7479 7065 732c 206e  ast(genotypes, n
+0001c0b0: 702e 696e 7438 290a 2020 2020 2020 2020  p.int8).        
+0001c0c0: 6d61 785f 616c 6c65 6c65 7320 3d20 6e70  max_alleles = np
+0001c0d0: 2e6d 6178 2867 656e 6f74 7970 6573 290a  .max(genotypes).
+0001c0e0: 2020 2020 2020 2020 6966 2061 6e63 6573          if ances
+0001c0f0: 7472 616c 5f73 7461 7465 2069 7320 6e6f  tral_state is no
+0001c100: 7420 4e6f 6e65 3a0a 2020 2020 2020 2020  t None:.        
+0001c110: 2020 2020 6966 2069 7369 6e73 7461 6e63      if isinstanc
+0001c120: 6528 616e 6365 7374 7261 6c5f 7374 6174  e(ancestral_stat
+0001c130: 652c 2073 7472 293a 0a20 2020 2020 2020  e, str):.       
+0001c140: 2020 2020 2020 2020 2023 2057 696c 6c20           # Will 
+0001c150: 7261 6973 6520 6120 5661 6c75 6545 7272  raise a ValueErr
+0001c160: 6f72 2069 6620 6e6f 7420 696e 2074 6865  or if not in the
+0001c170: 206c 6973 740a 2020 2020 2020 2020 2020   list.          
+0001c180: 2020 2020 2020 616e 6365 7374 7261 6c5f        ancestral_
+0001c190: 7374 6174 6520 3d20 616c 6c65 6c65 732e  state = alleles.
+0001c1a0: 696e 6465 7828 616e 6365 7374 7261 6c5f  index(ancestral_
+0001c1b0: 7374 6174 6529 0a20 2020 2020 2020 2020  state).         
+0001c1c0: 2020 2069 6620 616e 6365 7374 7261 6c5f     if ancestral_
+0001c1d0: 7374 6174 6520 3c20 3020 6f72 2061 6e63  state < 0 or anc
+0001c1e0: 6573 7472 616c 5f73 7461 7465 203e 3d20  estral_state >= 
+0001c1f0: 6c65 6e28 616c 6c65 6c65 7329 3a0a 2020  len(alleles):.  
+0001c200: 2020 2020 2020 2020 2020 2020 2020 7261                ra
+0001c210: 6973 6520 5661 6c75 6545 7272 6f72 2822  ise ValueError("
+0001c220: 616e 6365 7374 7261 6c5f 7374 6174 6520  ancestral_state 
+0001c230: 6e6f 7420 6265 7477 6565 6e20 3020 616e  not between 0 an
+0001c240: 6420 286e 756d 5f61 6c6c 656c 6573 2d31  d (num_alleles-1
+0001c250: 2922 290a 2020 2020 2020 2020 2020 2020  )").            
+0001c260: 6d61 785f 616c 6c65 6c65 7320 3d20 6d61  max_alleles = ma
+0001c270: 7828 616e 6365 7374 7261 6c5f 7374 6174  x(ancestral_stat
+0001c280: 652c 206d 6178 5f61 6c6c 656c 6573 290a  e, max_alleles).
+0001c290: 2020 2020 2020 2020 6966 206d 6178 5f61          if max_a
+0001c2a0: 6c6c 656c 6573 203e 3d20 3634 3a0a 2020  lleles >= 64:.  
+0001c2b0: 2020 2020 2020 2020 2020 7261 6973 6520            raise 
+0001c2c0: 5661 6c75 6545 7272 6f72 2822 4120 6d61  ValueError("A ma
+0001c2d0: 7869 6d75 6d20 6f66 2036 3420 7374 6174  ximum of 64 stat
+0001c2e0: 6573 2069 7320 7375 7070 6f72 7465 6422  es is supported"
+0001c2f0: 290a 2020 2020 2020 2020 616e 6365 7374  ).        ancest
+0001c300: 7261 6c5f 7374 6174 652c 2074 7261 6e73  ral_state, trans
+0001c310: 6974 696f 6e73 203d 2073 656c 662e 5f6c  itions = self._l
+0001c320: 6c5f 7472 6565 2e6d 6170 5f6d 7574 6174  l_tree.map_mutat
+0001c330: 696f 6e73 280a 2020 2020 2020 2020 2020  ions(.          
+0001c340: 2020 6765 6e6f 7479 7065 732c 2061 6e63    genotypes, anc
+0001c350: 6573 7472 616c 5f73 7461 7465 0a20 2020  estral_state.   
+0001c360: 2020 2020 2029 0a20 2020 2020 2020 2023       ).        #
+0001c370: 2054 7261 6e73 6c61 7465 2062 6163 6b20   Translate back 
+0001c380: 696e 746f 2073 7472 696e 6720 616c 6c65  into string alle
+0001c390: 6c65 730a 2020 2020 2020 2020 616e 6365  les.        ance
+0001c3a0: 7374 7261 6c5f 7374 6174 6520 3d20 616c  stral_state = al
+0001c3b0: 6c65 6c65 735b 616e 6365 7374 7261 6c5f  leles[ancestral_
+0001c3c0: 7374 6174 655d 0a20 2020 2020 2020 206d  state].        m
+0001c3d0: 7574 6174 696f 6e73 203d 205b 0a20 2020  utations = [.   
+0001c3e0: 2020 2020 2020 2020 204d 7574 6174 696f           Mutatio
+0001c3f0: 6e28 0a20 2020 2020 2020 2020 2020 2020  n(.             
+0001c400: 2020 206e 6f64 653d 6e6f 6465 2c0a 2020     node=node,.  
+0001c410: 2020 2020 2020 2020 2020 2020 2020 6465                de
+0001c420: 7269 7665 645f 7374 6174 653d 616c 6c65  rived_state=alle
+0001c430: 6c65 735b 6465 7269 7665 645f 7374 6174  les[derived_stat
+0001c440: 655d 2c0a 2020 2020 2020 2020 2020 2020  e],.            
+0001c450: 2020 2020 7061 7265 6e74 3d70 6172 656e      parent=paren
+0001c460: 742c 0a20 2020 2020 2020 2020 2020 2020  t,.             
+0001c470: 2020 206d 6574 6164 6174 613d 7365 6c66     metadata=self
+0001c480: 2e74 7265 655f 7365 7175 656e 6365 2e74  .tree_sequence.t
+0001c490: 6162 6c65 5f6d 6574 6164 6174 615f 7363  able_metadata_sc
+0001c4a0: 6865 6d61 732e 6d75 7461 7469 6f6e 2e65  hemas.mutation.e
+0001c4b0: 6d70 7479 5f76 616c 7565 2c0a 2020 2020  mpty_value,.    
+0001c4c0: 2020 2020 2020 2020 290a 2020 2020 2020          ).      
+0001c4d0: 2020 2020 2020 666f 7220 6e6f 6465 2c20        for node, 
+0001c4e0: 7061 7265 6e74 2c20 6465 7269 7665 645f  parent, derived_
+0001c4f0: 7374 6174 6520 696e 2074 7261 6e73 6974  state in transit
+0001c500: 696f 6e73 0a20 2020 2020 2020 205d 0a20  ions.        ]. 
+0001c510: 2020 2020 2020 2072 6574 7572 6e20 616e         return an
+0001c520: 6365 7374 7261 6c5f 7374 6174 652c 206d  cestral_state, m
+0001c530: 7574 6174 696f 6e73 0a0a 2020 2020 6465  utations..    de
+0001c540: 6620 6b63 5f64 6973 7461 6e63 6528 7365  f kc_distance(se
+0001c550: 6c66 2c20 6f74 6865 722c 206c 616d 6264  lf, other, lambd
+0001c560: 615f 3d30 2e30 293a 0a20 2020 2020 2020  a_=0.0):.       
+0001c570: 2022 2222 0a20 2020 2020 2020 2052 6574   """.        Ret
+0001c580: 7572 6e73 2074 6865 204b 656e 6461 6c6c  urns the Kendall
+0001c590: 2d43 6f6c 696a 6e20 6469 7374 616e 6365  -Colijn distance
+0001c5a0: 2062 6574 7765 656e 2074 6865 2073 7065   between the spe
+0001c5b0: 6369 6669 6564 2070 6169 7220 6f66 2074  cified pair of t
+0001c5c0: 7265 6573 2e0a 2020 2020 2020 2020 5468  rees..        Th
+0001c5d0: 6520 6060 6c61 6d62 6461 5f60 6020 7061  e ``lambda_`` pa
+0001c5e0: 7261 6d65 7465 7220 2064 6574 6572 6d69  rameter  determi
+0001c5f0: 6e65 7320 7468 6520 7265 6c61 7469 7665  nes the relative
+0001c600: 2077 6569 6768 7420 6f66 2074 6f70 6f6c   weight of topol
+0001c610: 6f67 790a 2020 2020 2020 2020 7673 2062  ogy.        vs b
+0001c620: 7261 6e63 6820 6c65 6e67 7468 7320 696e  ranch lengths in
+0001c630: 2063 616c 6375 6c61 7469 6e67 2074 6865   calculating the
+0001c640: 2064 6973 7461 6e63 652e 2049 6620 6060   distance. If ``
+0001c650: 6c61 6d62 6461 5f60 6020 6973 2030 0a20  lambda_`` is 0. 
+0001c660: 2020 2020 2020 2028 7468 6520 6465 6661         (the defa
+0001c670: 756c 7429 2077 6520 6f6e 6c79 2063 6f6e  ult) we only con
+0001c680: 7369 6465 7220 746f 706f 6c6f 6779 2c20  sider topology, 
+0001c690: 616e 6420 6966 2069 7420 6973 2031 2077  and if it is 1 w
+0001c6a0: 6520 6f6e 6c79 0a20 2020 2020 2020 2063  e only.        c
+0001c6b0: 6f6e 7369 6465 7220 6272 616e 6368 206c  onsider branch l
+0001c6c0: 656e 6774 6873 2e20 5365 6520 604b 656e  engths. See `Ken
+0001c6d0: 6461 6c6c 2026 2043 6f6c 696a 6e20 2832  dall & Colijn (2
+0001c6e0: 3031 3629 0a20 2020 2020 2020 203c 6874  016).        <ht
+0001c6f0: 7470 733a 2f2f 6163 6164 656d 6963 2e6f  tps://academic.o
+0001c700: 7570 2e63 6f6d 2f6d 6265 2f61 7274 6963  up.com/mbe/artic
+0001c710: 6c65 2f33 332f 3130 2f32 3733 352f 3239  le/33/10/2735/29
+0001c720: 3235 3534 383e 605f 2066 6f72 2064 6574  25548>`_ for det
+0001c730: 6169 6c73 2e0a 0a20 2020 2020 2020 2054  ails...        T
+0001c740: 6865 2074 7265 6573 2077 6520 6172 6520  he trees we are 
+0001c750: 636f 6d70 6172 696e 6720 746f 206d 7573  comparing to mus
+0001c760: 7420 6861 7665 2069 6465 6e74 6963 616c  t have identical
+0001c770: 206c 6973 7473 206f 6620 7361 6d70 6c65   lists of sample
+0001c780: 0a20 2020 2020 2020 206e 6f64 6573 2028  .        nodes (
+0001c790: 692e 652e 2c20 7468 6520 7361 6d65 2049  i.e., the same I
+0001c7a0: 4473 2069 6e20 7468 6520 7361 6d65 206f  Ds in the same o
+0001c7b0: 7264 6572 292e 2054 6865 206d 6574 7269  rder). The metri
+0001c7c0: 6320 6f70 6572 6174 6573 206f 6e0a 2020  c operates on.  
+0001c7d0: 2020 2020 2020 7361 6d70 6c65 732c 206e        samples, n
+0001c7e0: 6f74 206c 6561 7665 732c 2073 6f20 696e  ot leaves, so in
+0001c7f0: 7465 726e 616c 2073 616d 706c 6573 2061  ternal samples a
+0001c800: 7265 2074 7265 6174 6564 2069 6465 6e74  re treated ident
+0001c810: 6963 616c 6c79 2074 6f0a 2020 2020 2020  ically to.      
+0001c820: 2020 7361 6d70 6c65 2074 6970 732e 2053    sample tips. S
+0001c830: 7562 7472 6565 7320 7769 7468 206e 6f20  ubtrees with no 
+0001c840: 7361 6d70 6c65 7320 646f 206e 6f74 2063  samples do not c
+0001c850: 6f6e 7472 6962 7574 6520 746f 2074 6865  ontribute to the
+0001c860: 206d 6574 7269 632e 0a0a 2020 2020 2020   metric...      
+0001c870: 2020 3a70 6172 616d 2054 7265 6520 6f74    :param Tree ot
+0001c880: 6865 723a 2054 6865 206f 7468 6572 2074  her: The other t
+0001c890: 7265 6520 746f 2063 6f6d 7061 7265 2074  ree to compare t
+0001c8a0: 6f2e 0a20 2020 2020 2020 203a 7061 7261  o..        :para
+0001c8b0: 6d20 666c 6f61 7420 6c61 6d62 6461 5f3a  m float lambda_:
+0001c8c0: 2054 6865 204b 4320 6d65 7472 6963 206c   The KC metric l
+0001c8d0: 616d 6264 6120 7061 7261 6d65 7465 7220  ambda parameter 
+0001c8e0: 6465 7465 726d 696e 696e 6720 7468 650a  determining the.
+0001c8f0: 2020 2020 2020 2020 2020 2020 7265 6c61              rela
+0001c900: 7469 7665 2077 6569 6768 7420 6f66 2074  tive weight of t
+0001c910: 6f70 6f6c 6f67 7920 616e 6420 6272 616e  opology and bran
+0001c920: 6368 206c 656e 6774 682e 0a20 2020 2020  ch length..     
+0001c930: 2020 203a 7265 7475 726e 3a20 5468 6520     :return: The 
+0001c940: 636f 6d70 7574 6564 204b 4320 6469 7374  computed KC dist
+0001c950: 616e 6365 2062 6574 7765 656e 2074 6869  ance between thi
+0001c960: 7320 7472 6565 2061 6e64 206f 7468 6572  s tree and other
+0001c970: 2e0a 2020 2020 2020 2020 3a72 7479 7065  ..        :rtype
+0001c980: 3a20 666c 6f61 740a 2020 2020 2020 2020  : float.        
+0001c990: 2222 220a 2020 2020 2020 2020 7265 7475  """.        retu
+0001c9a0: 726e 2073 656c 662e 5f6c 6c5f 7472 6565  rn self._ll_tree
+0001c9b0: 2e67 6574 5f6b 635f 6469 7374 616e 6365  .get_kc_distance
+0001c9c0: 286f 7468 6572 2e5f 6c6c 5f74 7265 652c  (other._ll_tree,
+0001c9d0: 206c 616d 6264 615f 290a 0a20 2020 2064   lambda_)..    d
+0001c9e0: 6566 2070 6174 685f 6c65 6e67 7468 2873  ef path_length(s
+0001c9f0: 656c 662c 2075 2c20 7629 3a0a 2020 2020  elf, u, v):.    
+0001ca00: 2020 2020 2222 220a 2020 2020 2020 2020      """.        
+0001ca10: 5265 7475 726e 7320 7468 6520 7061 7468  Returns the path
+0001ca20: 206c 656e 6774 6820 6265 7477 6565 6e20   length between 
+0001ca30: 7477 6f20 6e6f 6465 730a 2020 2020 2020  two nodes.      
+0001ca40: 2020 2869 2e65 2e2c 2074 6865 206e 756d    (i.e., the num
+0001ca50: 6265 7220 6f66 2065 6467 6573 2062 6574  ber of edges bet
+0001ca60: 7765 656e 2074 776f 206e 6f64 6573 2069  ween two nodes i
+0001ca70: 6e20 7468 6973 2074 7265 6529 2e0a 2020  n this tree)..  
+0001ca80: 2020 2020 2020 4966 2074 6865 2074 776f        If the two
+0001ca90: 206e 6f64 6573 2068 6176 6520 6120 6d6f   nodes have a mo
+0001caa0: 7374 2072 6563 656e 7420 636f 6d6d 6f6e  st recent common
+0001cab0: 2061 6e63 6573 746f 722c 2074 6865 6e20   ancestor, then 
+0001cac0: 7468 6973 2069 7320 6465 6669 6e65 6420  this is defined 
+0001cad0: 6173 0a20 2020 2020 2020 2060 6074 7265  as.        ``tre
+0001cae0: 652e 6465 7074 6828 7529 202b 2074 7265  e.depth(u) + tre
+0001caf0: 652e 6465 7074 6828 7629 202d 2032 202a  e.depth(v) - 2 *
+0001cb00: 2074 7265 652e 6465 7074 6828 7472 6565   tree.depth(tree
+0001cb10: 2e6d 7263 6128 752c 2076 2929 6060 2e20  .mrca(u, v))``. 
+0001cb20: 4966 2074 6865 206e 6f64 6573 0a20 2020  If the nodes.   
+0001cb30: 2020 2020 2064 6f20 6e6f 7420 6861 7665       do not have
+0001cb40: 2061 6e20 4d52 4341 2028 692e 652e 2c20   an MRCA (i.e., 
+0001cb50: 7468 6579 2061 7265 2069 6e20 6469 7363  they are in disc
+0001cb60: 6f6e 6e65 6374 6564 2073 7562 7472 6565  onnected subtree
+0001cb70: 7329 2074 6865 2070 6174 6820 6c65 6e67  s) the path leng
+0001cb80: 7468 0a20 2020 2020 2020 2069 7320 696e  th.        is in
+0001cb90: 6669 6e69 7479 2e0a 0a20 2020 2020 2020  finity...       
+0001cba0: 202e 2e20 7365 6561 6c73 6f3a 3a20 5365   .. seealso:: Se
+0001cbb0: 6520 616c 736f 2074 6865 203a 6d65 7468  e also the :meth
+0001cbc0: 3a60 2e64 6570 7468 6020 6d65 7468 6f64  :`.depth` method
+0001cbd0: 0a0a 2020 2020 2020 2020 3a70 6172 616d  ..        :param
+0001cbe0: 2069 6e74 2075 3a20 5468 6520 6669 7273   int u: The firs
+0001cbf0: 7420 6e6f 6465 2066 6f72 2070 6174 6820  t node for path 
+0001cc00: 6c65 6e67 7468 2063 6f6d 7075 7461 7469  length computati
+0001cc10: 6f6e 2e0a 2020 2020 2020 2020 3a70 6172  on..        :par
+0001cc20: 616d 2069 6e74 2076 3a20 5468 6520 7365  am int v: The se
+0001cc30: 636f 6e64 206e 6f64 6520 666f 7220 7061  cond node for pa
+0001cc40: 7468 206c 656e 6774 6820 636f 6d70 7574  th length comput
+0001cc50: 6174 696f 6e2e 0a20 2020 2020 2020 203a  ation..        :
+0001cc60: 7265 7475 726e 3a20 5468 6520 6e75 6d62  return: The numb
+0001cc70: 6572 206f 6620 6564 6765 7320 6265 7477  er of edges betw
+0001cc80: 6565 6e20 7468 6520 7477 6f20 6e6f 6465  een the two node
+0001cc90: 732e 0a20 2020 2020 2020 203a 7274 7970  s..        :rtyp
+0001cca0: 653a 2069 6e74 0a20 2020 2020 2020 2022  e: int.        "
+0001ccb0: 2222 0a20 2020 2020 2020 206d 7263 6120  "".        mrca 
+0001ccc0: 3d20 7365 6c66 2e6d 7263 6128 752c 2076  = self.mrca(u, v
+0001ccd0: 290a 2020 2020 2020 2020 6966 206d 7263  ).        if mrc
+0001cce0: 6120 3d3d 202d 313a 0a20 2020 2020 2020  a == -1:.       
+0001ccf0: 2020 2020 2072 6574 7572 6e20 6d61 7468       return math
+0001cd00: 2e69 6e66 0a20 2020 2020 2020 2072 6574  .inf.        ret
+0001cd10: 7572 6e20 7365 6c66 2e64 6570 7468 2875  urn self.depth(u
+0001cd20: 2920 2b20 7365 6c66 2e64 6570 7468 2876  ) + self.depth(v
+0001cd30: 2920 2d20 3220 2a20 7365 6c66 2e64 6570  ) - 2 * self.dep
+0001cd40: 7468 286d 7263 6129 0a0a 2020 2020 6465  th(mrca)..    de
+0001cd50: 6620 6231 5f69 6e64 6578 2873 656c 6629  f b1_index(self)
+0001cd60: 3a0a 2020 2020 2020 2020 2222 220a 2020  :.        """.  
+0001cd70: 2020 2020 2020 5265 7475 726e 7320 7468        Returns th
+0001cd80: 650a 2020 2020 2020 2020 6042 3120 6261  e.        `B1 ba
+0001cd90: 6c61 6e63 6520 696e 6465 7820 3c68 7474  lance index <htt
+0001cda0: 7073 3a2f 2f74 7265 6562 616c 616e 6365  ps://treebalance
+0001cdb0: 2e77 6f72 6470 7265 7373 2e63 6f6d 2f62  .wordpress.com/b
+0001cdc0: e282 812d 696e 6465 782f 3e60 5f0a 2020  ...-index/>`_.  
+0001cdd0: 2020 2020 2020 666f 7220 7468 6973 2074        for this t
+0001cde0: 7265 652e 2054 6869 7320 6973 2064 6566  ree. This is def
+0001cdf0: 696e 6564 2061 7320 7468 6520 696e 7665  ined as the inve
+0001ce00: 7273 6520 6f66 2074 6865 2073 756d 206f  rse of the sum o
+0001ce10: 6620 616c 6c0a 2020 2020 2020 2020 6c6f  f all.        lo
+0001ce20: 6e67 6573 7420 7061 7468 7320 746f 206c  ngest paths to l
+0001ce30: 6561 7665 7320 666f 7220 6561 6368 206e  eaves for each n
+0001ce40: 6f64 6520 6265 7369 6465 7320 726f 6f74  ode besides root
+0001ce50: 732e 0a0a 2020 2020 2020 2020 2e2e 2073  s...        .. s
+0001ce60: 6565 616c 736f 3a3a 2053 6565 2060 5368  eealso:: See `Sh
+0001ce70: 616f 2061 6e64 2053 6f6b 616c 2028 3139  ao and Sokal (19
+0001ce80: 3930 290a 2020 2020 2020 2020 2020 2020  90).            
+0001ce90: 3c68 7474 7073 3a2f 2f77 7777 2e6a 7374  <https://www.jst
+0001cea0: 6f72 2e6f 7267 2f73 7461 626c 652f 3239  or.org/stable/29
+0001ceb0: 3932 3138 363e 605f 2066 6f72 2064 6574  92186>`_ for det
+0001cec0: 6169 6c73 2e0a 0a20 2020 2020 2020 203a  ails...        :
+0001ced0: 7265 7475 726e 3a20 5468 6520 4231 2062  return: The B1 b
+0001cee0: 616c 616e 6365 2069 6e64 6578 2e0a 2020  alance index..  
+0001cef0: 2020 2020 2020 3a72 7479 7065 3a20 666c        :rtype: fl
+0001cf00: 6f61 740a 2020 2020 2020 2020 2222 220a  oat.        """.
+0001cf10: 2020 2020 2020 2020 7265 7475 726e 2073          return s
+0001cf20: 656c 662e 5f6c 6c5f 7472 6565 2e67 6574  elf._ll_tree.get
+0001cf30: 5f62 315f 696e 6465 7828 290a 0a20 2020  _b1_index()..   
+0001cf40: 2064 6566 2062 325f 696e 6465 7828 7365   def b2_index(se
+0001cf50: 6c66 2c20 6261 7365 3d31 3029 3a0a 2020  lf, base=10):.  
+0001cf60: 2020 2020 2020 2222 220a 2020 2020 2020        """.      
+0001cf70: 2020 5265 7475 726e 7320 7468 650a 2020    Returns the.  
+0001cf80: 2020 2020 2020 6042 3220 6261 6c61 6e63        `B2 balanc
+0001cf90: 6520 696e 6465 7820 3c68 7474 7073 3a2f  e index <https:/
+0001cfa0: 2f74 7265 6562 616c 616e 6365 2e77 6f72  /treebalance.wor
+0001cfb0: 6470 7265 7373 2e63 6f6d 2f62 e282 822d  dpress.com/b...-
+0001cfc0: 696e 6465 782f 3e60 5f0a 2020 2020 2020  index/>`_.      
+0001cfd0: 2020 7468 6973 2074 7265 652e 0a20 2020    this tree..   
+0001cfe0: 2020 2020 2054 6869 7320 6973 2064 6566       This is def
+0001cff0: 696e 6564 2061 7320 7468 6520 5368 616e  ined as the Shan
+0001d000: 6e6f 6e20 656e 7472 6f70 7920 6f66 2074  non entropy of t
+0001d010: 6865 2070 726f 6261 6269 6c69 7479 0a20  he probability. 
+0001d020: 2020 2020 2020 2064 6973 7472 6962 7574         distribut
+0001d030: 696f 6e20 746f 2072 6561 6368 206c 6561  ion to reach lea
+0001d040: 7665 7320 6173 7375 6d69 6e67 2061 2072  ves assuming a r
+0001d050: 616e 646f 6d20 7761 6c6b 0a20 2020 2020  andom walk.     
+0001d060: 2020 2066 726f 6d20 6120 726f 6f74 2e20     from a root. 
+0001d070: 5468 6520 6465 6661 756c 7420 6261 7365  The default base
+0001d080: 2069 7320 3130 2c20 666f 6c6c 6f77 696e   is 10, followin
+0001d090: 6720 5368 616f 2061 6e64 2053 6f6b 616c  g Shao and Sokal
+0001d0a0: 2028 3139 3930 292e 0a0a 2020 2020 2020   (1990)...      
+0001d0b0: 2020 2e2e 2073 6565 616c 736f 3a3a 2053    .. seealso:: S
+0001d0c0: 6565 2060 5368 616f 2061 6e64 2053 6f6b  ee `Shao and Sok
+0001d0d0: 616c 2028 3139 3930 290a 2020 2020 2020  al (1990).      
+0001d0e0: 2020 2020 2020 3c68 7474 7073 3a2f 2f77        <https://w
+0001d0f0: 7777 2e6a 7374 6f72 2e6f 7267 2f73 7461  ww.jstor.org/sta
+0001d100: 626c 652f 3239 3932 3138 363e 605f 2066  ble/2992186>`_ f
+0001d110: 6f72 2064 6574 6169 6c73 2e0a 0a20 2020  or details...   
+0001d120: 2020 2020 203a 7061 7261 6d20 696e 7420       :param int 
+0001d130: 6261 7365 3a20 5468 6520 6261 7365 2075  base: The base u
+0001d140: 7365 6420 666f 7220 7468 6520 6c6f 6761  sed for the loga
+0001d150: 7269 7468 6d20 696e 2074 6865 0a20 2020  rithm in the.   
+0001d160: 2020 2020 2020 2020 2053 6861 6e6e 6f6e           Shannon
+0001d170: 2065 6e74 726f 7079 2063 6f6d 7075 7461   entropy computa
+0001d180: 7469 6f6e 2e0a 2020 2020 2020 2020 3a72  tion..        :r
+0001d190: 6574 7572 6e3a 2054 6865 2042 3220 6261  eturn: The B2 ba
+0001d1a0: 6c61 6e63 6520 696e 6465 782e 0a20 2020  lance index..   
+0001d1b0: 2020 2020 203a 7274 7970 653a 2066 6c6f       :rtype: flo
+0001d1c0: 6174 0a20 2020 2020 2020 2022 2222 0a20  at.        """. 
+0001d1d0: 2020 2020 2020 2023 204c 6574 2050 7974         # Let Pyt
+0001d1e0: 686f 6e20 6465 6369 6465 2069 6620 7468  hon decide if th
+0001d1f0: 6520 6261 7365 2069 7320 6163 6365 7074  e base is accept
+0001d200: 6162 6c65 0a20 2020 2020 2020 206d 6174  able.        mat
+0001d210: 682e 6c6f 6728 3130 2c20 6261 7365 290a  h.log(10, base).
+0001d220: 2020 2020 2020 2020 7265 7475 726e 2073          return s
+0001d230: 656c 662e 5f6c 6c5f 7472 6565 2e67 6574  elf._ll_tree.get
+0001d240: 5f62 325f 696e 6465 7828 6261 7365 290a  _b2_index(base).
+0001d250: 0a20 2020 2064 6566 2063 6f6c 6c65 7373  .    def colless
+0001d260: 5f69 6e64 6578 2873 656c 6629 3a0a 2020  _index(self):.  
+0001d270: 2020 2020 2020 2222 220a 2020 2020 2020        """.      
+0001d280: 2020 5265 7475 726e 7320 7468 650a 2020    Returns the.  
+0001d290: 2020 2020 2020 6043 6f6c 6c65 7373 2069        `Colless i
+0001d2a0: 6d62 616c 616e 6365 2069 6e64 6578 203c  mbalance index <
+0001d2b0: 6874 7470 733a 2f2f 7472 6565 6261 6c61  https://treebala
+0001d2c0: 6e63 652e 776f 7264 7072 6573 732e 636f  nce.wordpress.co
+0001d2d0: 6d2f 636f 6c6c 6573 732d 696e 6465 782f  m/colless-index/
+0001d2e0: 3e60 5f0a 2020 2020 2020 2020 666f 7220  >`_.        for 
+0001d2f0: 7468 6973 2074 7265 652e 2054 6869 7320  this tree. This 
+0001d300: 6973 2064 6566 696e 6564 2061 7320 7468  is defined as th
+0001d310: 6520 7375 6d20 6f66 2061 6c6c 2064 6966  e sum of all dif
+0001d320: 6665 7265 6e63 6573 2062 6574 7765 656e  ferences between
+0001d330: 0a20 2020 2020 2020 206e 756d 6265 7220  .        number 
+0001d340: 6f66 206c 6561 7665 7320 7375 6274 656e  of leaves subten
+0001d350: 6465 6420 6279 2074 6865 206c 6566 7420  ded by the left 
+0001d360: 616e 6420 7269 6768 7420 6368 696c 6420  and right child 
+0001d370: 6f66 2065 6163 6820 6e6f 6465 2e0a 2020  of each node..  
+0001d380: 2020 2020 2020 5468 6520 436f 6c6c 6573        The Colles
+0001d390: 7320 696e 6465 7820 6973 2075 6e64 6566  s index is undef
+0001d3a0: 696e 6564 2066 6f72 206e 6f6e 2d62 696e  ined for non-bin
+0001d3b0: 6172 7920 7472 6565 7320 616e 6420 7472  ary trees and tr
+0001d3c0: 6565 7320 7769 7468 0a20 2020 2020 2020  ees with.       
+0001d3d0: 206d 756c 7469 706c 6520 726f 6f74 732e   multiple roots.
+0001d3e0: 2054 6869 7320 6d65 7468 6f64 2077 696c   This method wil
+0001d3f0: 6c20 7261 6973 6520 6120 4c69 6272 6172  l raise a Librar
+0001d400: 7945 7272 6f72 2069 6620 7468 6520 7472  yError if the tr
+0001d410: 6565 2069 730a 2020 2020 2020 2020 6e6f  ee is.        no
+0001d420: 7420 7369 6e67 6c79 2d72 6f6f 7465 6420  t singly-rooted 
+0001d430: 616e 6420 6269 6e61 7279 2e0a 0a20 2020  and binary...   
+0001d440: 2020 2020 202e 2e20 7365 6561 6c73 6f3a       .. seealso:
+0001d450: 3a20 5365 6520 6053 6861 6f20 616e 6420  : See `Shao and 
+0001d460: 536f 6b61 6c20 2831 3939 3029 0a20 2020  Sokal (1990).   
+0001d470: 2020 2020 2020 2020 203c 6874 7470 733a           <https:
+0001d480: 2f2f 7777 772e 6a73 746f 722e 6f72 672f  //www.jstor.org/
+0001d490: 7374 6162 6c65 2f32 3939 3231 3836 3e60  stable/2992186>`
+0001d4a0: 5f20 666f 7220 6465 7461 696c 732e 0a0a  _ for details...
+0001d4b0: 2020 2020 2020 2020 3a72 6574 7572 6e3a          :return:
+0001d4c0: 2054 6865 2043 6f6c 6c65 7373 2069 6d62   The Colless imb
+0001d4d0: 616c 616e 6365 2069 6e64 6578 2e0a 2020  alance index..  
+0001d4e0: 2020 2020 2020 3a72 7479 7065 3a20 696e        :rtype: in
+0001d4f0: 740a 2020 2020 2020 2020 2222 220a 2020  t.        """.  
+0001d500: 2020 2020 2020 7265 7475 726e 2073 656c        return sel
+0001d510: 662e 5f6c 6c5f 7472 6565 2e67 6574 5f63  f._ll_tree.get_c
+0001d520: 6f6c 6c65 7373 5f69 6e64 6578 2829 0a0a  olless_index()..
+0001d530: 2020 2020 6465 6620 7361 636b 696e 5f69      def sackin_i
+0001d540: 6e64 6578 2873 656c 6629 3a0a 2020 2020  ndex(self):.    
+0001d550: 2020 2020 2222 220a 2020 2020 2020 2020      """.        
+0001d560: 5265 7475 726e 7320 7468 650a 2020 2020  Returns the.    
+0001d570: 2020 2020 6053 6163 6b69 6e20 696d 6261      `Sackin imba
+0001d580: 6c61 6e63 6520 696e 6465 7820 3c68 7474  lance index <htt
+0001d590: 7073 3a2f 2f74 7265 6562 616c 616e 6365  ps://treebalance
+0001d5a0: 2e77 6f72 6470 7265 7373 2e63 6f6d 2f73  .wordpress.com/s
+0001d5b0: 6163 6b69 6e2d 696e 6465 782f 3e60 5f0a  ackin-index/>`_.
+0001d5c0: 2020 2020 2020 2020 666f 7220 7468 6973          for this
+0001d5d0: 2074 7265 652e 2054 6869 7320 6973 2064   tree. This is d
+0001d5e0: 6566 696e 6564 2061 7320 7468 6520 7375  efined as the su
+0001d5f0: 6d20 6f66 2074 6865 2064 6570 7468 7320  m of the depths 
+0001d600: 6f66 2061 6c6c 206c 6561 7665 730a 2020  of all leaves.  
+0001d610: 2020 2020 2020 696e 2074 6865 2074 7265        in the tre
+0001d620: 652e 2045 7175 6976 616c 656e 7420 746f  e. Equivalent to
+0001d630: 2060 6073 756d 2874 7265 652e 6465 7074   ``sum(tree.dept
+0001d640: 6828 7529 2066 6f72 2075 2069 6e0a 2020  h(u) for u in.  
+0001d650: 2020 2020 2020 7472 6565 2e6c 6561 7665        tree.leave
+0001d660: 7328 2929 6060 0a0a 2020 2020 2020 2020  s())``..        
+0001d670: 2e2e 2073 6565 616c 736f 3a3a 2053 6565  .. seealso:: See
+0001d680: 2060 5368 616f 2061 6e64 2053 6f6b 616c   `Shao and Sokal
+0001d690: 2028 3139 3930 290a 2020 2020 2020 2020   (1990).        
+0001d6a0: 2020 2020 3c68 7474 7073 3a2f 2f77 7777      <https://www
+0001d6b0: 2e6a 7374 6f72 2e6f 7267 2f73 7461 626c  .jstor.org/stabl
+0001d6c0: 652f 3239 3932 3138 363e 605f 2066 6f72  e/2992186>`_ for
+0001d6d0: 2064 6574 6169 6c73 2e0a 0a20 2020 2020   details...     
+0001d6e0: 2020 203a 7265 7475 726e 3a20 5468 6520     :return: The 
+0001d6f0: 5361 636b 696e 2069 6d62 616c 616e 6365  Sackin imbalance
+0001d700: 2069 6e64 6578 2e0a 2020 2020 2020 2020   index..        
+0001d710: 3a72 7479 7065 3a20 696e 740a 2020 2020  :rtype: int.    
+0001d720: 2020 2020 2222 220a 2020 2020 2020 2020      """.        
+0001d730: 7265 7475 726e 2073 656c 662e 5f6c 6c5f  return self._ll_
+0001d740: 7472 6565 2e67 6574 5f73 6163 6b69 6e5f  tree.get_sackin_
+0001d750: 696e 6465 7828 290a 0a20 2020 2064 6566  index()..    def
+0001d760: 206e 756d 5f6c 696e 6561 6765 7328 7365   num_lineages(se
+0001d770: 6c66 2c20 7429 3a0a 2020 2020 2020 2020  lf, t):.        
+0001d780: 2222 220a 2020 2020 2020 2020 5265 7475  """.        Retu
+0001d790: 726e 7320 7468 6520 6e75 6d62 6572 206f  rns the number o
+0001d7a0: 6620 6c69 6e65 6167 6573 2070 7265 7365  f lineages prese
+0001d7b0: 6e74 2069 6e20 7468 6973 2074 7265 6520  nt in this tree 
+0001d7c0: 6174 2074 696d 6520 6060 7460 602e 2054  at time ``t``. T
+0001d7d0: 6869 730a 2020 2020 2020 2020 6973 2064  his.        is d
+0001d7e0: 6566 696e 6564 2061 7320 7468 6520 6e75  efined as the nu
+0001d7f0: 6d62 6572 206f 6620 6272 616e 6368 6573  mber of branches
+0001d800: 2069 6e20 7468 6973 2074 7265 6520 2872   in this tree (r
+0001d810: 6561 6368 6162 6c65 2066 726f 6d20 7468  eachable from th
+0001d820: 650a 2020 2020 2020 2020 7361 6d70 6c65  e.        sample
+0001d830: 7329 2074 6861 7420 696e 7465 7273 6563  s) that intersec
+0001d840: 7420 7769 7468 2060 6074 6060 2e20 5468  t with ``t``. Th
+0001d850: 7573 2c20 6060 7472 6565 2e6e 756d 5f6c  us, ``tree.num_l
+0001d860: 696e 6561 6765 7328 7429 6060 0a20 2020  ineages(t)``.   
+0001d870: 2020 2020 2069 7320 6571 7561 6c20 746f       is equal to
+0001d880: 2030 2066 6f72 2061 6e79 2060 6074 6060   0 for any ``t``
+0001d890: 2067 7265 6174 6572 2074 6861 6e20 6f72   greater than or
+0001d8a0: 2065 7175 616c 2074 6f20 7468 6520 7469   equal to the ti
+0001d8b0: 6d65 206f 660a 2020 2020 2020 2020 7468  me of.        th
+0001d8c0: 6520 726f 6f74 2069 6e20 6120 7369 6e67  e root in a sing
+0001d8d0: 6c79 2d72 6f6f 7465 6420 7472 6565 2e0a  ly-rooted tree..
+0001d8e0: 0a20 2020 2020 2020 202e 2e20 6e6f 7465  .        .. note
+0001d8f0: 3a3a 204e 6f74 6520 7468 6174 2074 6869  :: Note that thi
+0001d900: 7320 6465 6669 6e69 7469 6f6e 206d 6561  s definition mea
+0001d910: 6e73 2074 6861 7420 6966 2061 2028 6e6f  ns that if a (no
+0001d920: 6e20 726f 6f74 2920 6e6f 6465 0a20 2020  n root) node.   
+0001d930: 2020 2020 2020 2020 2077 6974 6820 7468           with th
+0001d940: 7265 6520 6368 696c 6472 656e 2068 6173  ree children has
+0001d950: 2074 696d 6520 6060 7460 602c 2074 6865   time ``t``, the
+0001d960: 6e20 6974 2077 696c 6c20 636f 756e 7420  n it will count 
+0001d970: 6173 206f 6e65 206c 696e 6561 6765 2c0a  as one lineage,.
+0001d980: 2020 2020 2020 2020 2020 2020 6e6f 7420              not 
+0001d990: 7468 7265 652e 0a0a 2020 2020 2020 2020  three...        
+0001d9a0: 3a70 6172 616d 2069 6e74 2074 3a20 5468  :param int t: Th
+0001d9b0: 6520 7469 6d65 2074 6f20 636f 756e 7420  e time to count 
+0001d9c0: 6c69 6e65 6167 6573 2061 742e 0a20 2020  lineages at..   
+0001d9d0: 2020 2020 203a 7265 7475 726e 3a20 5468       :return: Th
+0001d9e0: 6520 6e75 6d62 6572 206f 6620 6c69 6e65  e number of line
+0001d9f0: 6167 6573 2069 6e20 7468 6520 7472 6565  ages in the tree
+0001da00: 2061 7420 7469 6d65 2074 2e0a 2020 2020   at time t..    
+0001da10: 2020 2020 3a72 7479 7065 3a20 696e 740a      :rtype: int.
+0001da20: 2020 2020 2020 2020 2222 220a 2020 2020          """.    
+0001da30: 2020 2020 7265 7475 726e 2073 656c 662e      return self.
+0001da40: 5f6c 6c5f 7472 6565 2e67 6574 5f6e 756d  _ll_tree.get_num
+0001da50: 5f6c 696e 6561 6765 7328 7429 0a0a 2020  _lineages(t)..  
+0001da60: 2020 6465 6620 7370 6c69 745f 706f 6c79    def split_poly
+0001da70: 746f 6d69 6573 280a 2020 2020 2020 2020  tomies(.        
+0001da80: 7365 6c66 2c0a 2020 2020 2020 2020 2a2c  self,.        *,
+0001da90: 0a20 2020 2020 2020 2065 7073 696c 6f6e  .        epsilon
+0001daa0: 3d4e 6f6e 652c 0a20 2020 2020 2020 206d  =None,.        m
+0001dab0: 6574 686f 643d 4e6f 6e65 2c0a 2020 2020  ethod=None,.    
+0001dac0: 2020 2020 7265 636f 7264 5f70 726f 7665      record_prove
+0001dad0: 6e61 6e63 653d 5472 7565 2c0a 2020 2020  nance=True,.    
+0001dae0: 2020 2020 7261 6e64 6f6d 5f73 6565 643d      random_seed=
+0001daf0: 4e6f 6e65 2c0a 2020 2020 2020 2020 2a2a  None,.        **
+0001db00: 6b77 6172 6773 2c0a 2020 2020 293a 0a20  kwargs,.    ):. 
+0001db10: 2020 2020 2020 2022 2222 0a20 2020 2020         """.     
+0001db20: 2020 2052 6574 7572 6e20 6120 6e65 7720     Return a new 
+0001db30: 3a63 6c61 7373 3a60 2e54 7265 6560 2077  :class:`.Tree` w
+0001db40: 6865 7265 2065 7874 7261 206e 6f64 6573  here extra nodes
+0001db50: 2061 6e64 2065 6467 6573 2068 6176 6520   and edges have 
+0001db60: 6265 656e 2069 6e73 6572 7465 640a 2020  been inserted.  
+0001db70: 2020 2020 2020 736f 2074 6861 7420 616e        so that an
+0001db80: 7920 616e 7920 6e6f 6465 2060 6075 6060  y any node ``u``
+0001db90: 2077 6974 6820 6772 6561 7465 7220 7468   with greater th
+0001dba0: 616e 2032 2063 6869 6c64 7265 6e20 2d2d  an 2 children --
+0001dbb0: 2d20 6120 6d75 6c74 6966 7572 6361 7469  - a multifurcati
+0001dbc0: 6f6e 0a20 2020 2020 2020 206f 7220 2270  on.        or "p
+0001dbd0: 6f6c 7974 6f6d 7922 202d 2d2d 2069 7320  olytomy" --- is 
+0001dbe0: 7265 736f 6c76 6564 2069 6e74 6f20 7375  resolved into su
+0001dbf0: 6363 6573 7369 7665 2062 6966 7572 6361  ccessive bifurca
+0001dc00: 7469 6f6e 732e 204e 6577 206e 6f64 6573  tions. New nodes
+0001dc10: 2061 7265 0a20 2020 2020 2020 2069 6e73   are.        ins
+0001dc20: 6572 7465 6420 6174 2074 696d 6573 2066  erted at times f
+0001dc30: 7261 6374 696f 6e61 6c6c 7920 6c65 7373  ractionally less
+0001dc40: 2074 6861 6e20 7468 616e 2074 6865 2074   than than the t
+0001dc50: 696d 6520 6f66 206e 6f64 6520 6060 7560  ime of node ``u`
+0001dc60: 602e 0a20 2020 2020 2020 2054 696d 6573  `..        Times
+0001dc70: 2061 7265 2061 6c6c 6f63 6174 6564 2074   are allocated t
+0001dc80: 6f20 6469 6666 6572 656e 7420 6c65 7665  o different leve
+0001dc90: 6c73 206f 6620 7468 6520 7472 6565 2c20  ls of the tree, 
+0001dca0: 7375 6368 2074 6861 7420 616e 7920 6e65  such that any ne
+0001dcb0: 776c 790a 2020 2020 2020 2020 696e 7365  wly.        inse
+0001dcc0: 7274 6564 2073 6962 6c69 6e67 206e 6f64  rted sibling nod
+0001dcd0: 6573 2077 696c 6c20 6861 7665 2074 6865  es will have the
+0001dce0: 2073 616d 6520 7469 6d65 2e0a 0a20 2020   same time...   
+0001dcf0: 2020 2020 2042 7920 6465 6661 756c 742c       By default,
+0001dd00: 2074 6865 2074 696d 6573 206f 6620 7468   the times of th
+0001dd10: 6520 6e65 776c 7920 6765 6e65 7261 7465  e newly generate
+0001dd20: 6420 6368 696c 6472 656e 206f 6620 6120  d children of a 
+0001dd30: 7061 7274 6963 756c 6172 0a20 2020 2020  particular.     
+0001dd40: 2020 206e 6f64 6520 6172 6520 7468 6520     node are the 
+0001dd50: 6d69 6e69 6d75 6d20 7265 7072 6573 656e  minimum represen
+0001dd60: 7461 626c 6520 6469 7374 616e 6365 2069  table distance i
+0001dd70: 6e20 666c 6f61 7469 6e67 2070 6f69 6e74  n floating point
+0001dd80: 2061 7269 7468 6d65 7469 630a 2020 2020   arithmetic.    
+0001dd90: 2020 2020 6672 6f6d 2074 6865 6972 2070      from their p
+0001dda0: 6172 656e 7473 2028 7573 696e 6720 7468  arents (using th
+0001ddb0: 6520 606e 6578 7461 6674 6572 0a20 2020  e `nextafter.   
+0001ddc0: 2020 2020 203c 6874 7470 733a 2f2f 6e75       <https://nu
+0001ddd0: 6d70 792e 6f72 672f 646f 632f 7374 6162  mpy.org/doc/stab
+0001dde0: 6c65 2f72 6566 6572 656e 6365 2f67 656e  le/reference/gen
+0001ddf0: 6572 6174 6564 2f6e 756d 7079 2e6e 6578  erated/numpy.nex
+0001de00: 7461 6674 6572 2e68 746d 6c3e 605f 0a20  tafter.html>`_. 
+0001de10: 2020 2020 2020 2066 756e 6374 696f 6e29         function)
+0001de20: 2e20 5468 7573 2c20 7468 6520 6765 6e65  . Thus, the gene
+0001de30: 7261 7465 6420 6272 616e 6368 6573 2068  rated branches h
+0001de40: 6176 6520 7468 6520 7368 6f72 7465 7374  ave the shortest
+0001de50: 2070 6f73 7369 626c 6520 6e6f 6e7a 6572   possible nonzer
+0001de60: 6f0a 2020 2020 2020 2020 6c65 6e67 7468  o.        length
+0001de70: 2e20 4120 6669 7865 6420 6272 616e 6368  . A fixed branch
+0001de80: 206c 656e 6774 6820 6265 7477 6565 6e20   length between 
+0001de90: 696e 7365 7274 6564 206e 6f64 6573 2061  inserted nodes a
+0001dea0: 6e64 2074 6865 6972 2070 6172 656e 7473  nd their parents
+0001deb0: 0a20 2020 2020 2020 2063 616e 2061 6c73  .        can als
+0001dec0: 6f20 6265 2073 7065 6369 6669 6564 2062  o be specified b
+0001ded0: 7920 7573 696e 6720 7468 6520 6060 6570  y using the ``ep
+0001dee0: 7369 6c6f 6e60 6020 7061 7261 6d65 7465  silon`` paramete
+0001def0: 722e 0a0a 2020 2020 2020 2020 2e2e 206e  r...        .. n
+0001df00: 6f74 653a 3a0a 2020 2020 2020 2020 2020  ote::.          
+0001df10: 2020 4120 7472 6565 2073 6571 7565 6e63    A tree sequenc
+0001df20: 6520 3a72 6566 3a60 7265 7175 6972 6573  e :ref:`requires
+0001df30: 3c73 6563 5f76 616c 6964 5f74 7265 655f  <sec_valid_tree_
+0001df40: 7365 7175 656e 6365 5f72 6571 7569 7265  sequence_require
+0001df50: 6d65 6e74 733e 6020 7468 6174 0a20 2020  ments>` that.   
+0001df60: 2020 2020 2020 2020 2070 6172 656e 7473           parents
+0001df70: 2062 6520 6f6c 6465 7220 7468 616e 2063   be older than c
+0001df80: 6869 6c64 7265 6e20 616e 6420 7468 6174  hildren and that
+0001df90: 206d 7574 6174 696f 6e73 2061 7265 2079   mutations are y
+0001dfa0: 6f75 6e67 6572 2074 6861 6e20 7468 650a  ounger than the.
+0001dfb0: 2020 2020 2020 2020 2020 2020 7061 7265              pare
+0001dfc0: 6e74 206f 6620 7468 6520 6564 6765 206f  nt of the edge o
+0001dfd0: 6e20 7768 6963 6820 7468 6579 206c 6965  n which they lie
+0001dfe0: 2e20 4966 2061 2066 6978 6564 2060 6065  . If a fixed ``e
+0001dff0: 7073 696c 6f6e 6060 2069 7320 7370 6563  psilon`` is spec
+0001e000: 6966 6564 0a20 2020 2020 2020 2020 2020  ifed.           
+0001e010: 2061 6e64 2069 7320 6e6f 7420 736d 616c   and is not smal
+0001e020: 6c20 656e 6f75 6768 2063 6f6d 7061 7265  l enough compare
+0001e030: 6420 746f 2074 6865 2064 6973 7461 6e63  d to the distanc
+0001e040: 6520 6265 7477 6565 6e20 6120 706f 6c79  e between a poly
+0001e050: 746f 6d79 2061 6e64 0a20 2020 2020 2020  tomy and.       
+0001e060: 2020 2020 2069 7473 206f 6c64 6573 7420       its oldest 
+0001e070: 6368 696c 6420 286f 7220 6f6c 6465 7374  child (or oldest
+0001e080: 2063 6869 6c64 206d 7574 6174 696f 6e29   child mutation)
+0001e090: 2074 6865 7365 2072 6571 7569 7265 6d65   these requireme
+0001e0a0: 6e74 7320 6d61 7920 6e6f 740a 2020 2020  nts may not.    
+0001e0b0: 2020 2020 2020 2020 6265 206d 6574 2e20          be met. 
+0001e0c0: 496e 2074 6869 7320 6361 7365 2061 6e20  In this case an 
+0001e0d0: 6572 726f 7220 7769 6c6c 2062 6520 7261  error will be ra
+0001e0e0: 6973 6564 2e0a 0a20 2020 2020 2020 2049  ised...        I
+0001e0f0: 6620 7468 6520 6060 6d65 7468 6f64 6060  f the ``method``
+0001e100: 2069 7320 6060 2272 616e 646f 6d22 6060   is ``"random"``
+0001e110: 2028 6375 7272 656e 746c 7920 7468 6520   (currently the 
+0001e120: 6f6e 6c79 206f 7074 696f 6e2c 2061 6e64  only option, and
+0001e130: 2074 6865 2064 6566 6175 6c74 0a20 2020   the default.   
+0001e140: 2020 2020 2077 6865 6e20 6e6f 206d 6574       when no met
+0001e150: 686f 6420 6973 2073 7065 6369 6669 6564  hod is specified
+0001e160: 292c 2074 6865 6e20 666f 7220 6120 6e6f  ), then for a no
+0001e170: 6465 2077 6974 6820 3a6d 6174 683a 606e  de with :math:`n
+0001e180: 6020 6368 696c 6472 656e 2c20 7468 650a  ` children, the.
+0001e190: 2020 2020 2020 2020 3a6d 6174 683a 6028          :math:`(
+0001e1a0: 326e 202d 2033 2921 202f 2028 325e 286e  2n - 3)! / (2^(n
+0001e1b0: 202d 2032 2920 286e 202d 2032 2129 2960   - 2) (n - 2!))`
+0001e1c0: 2070 6f73 7369 626c 6520 6269 6e61 7279   possible binary
+0001e1d0: 2074 7265 6573 2077 6974 6820 6571 7561   trees with equa
+0001e1e0: 6c0a 2020 2020 2020 2020 7072 6f62 6162  l.        probab
+0001e1f0: 696c 6974 792e 0a0a 2020 2020 2020 2020  ility...        
+0001e200: 5468 6520 7265 7475 726e 6564 203a 636c  The returned :cl
+0001e210: 6173 733a 602e 5472 6565 6020 7769 6c6c  ass:`.Tree` will
+0001e220: 2068 6176 6520 7468 6520 7361 6d65 2067   have the same g
+0001e230: 656e 6f6d 6963 2073 7061 6e20 6173 2074  enomic span as t
+0001e240: 6869 7320 7472 6565 2c0a 2020 2020 2020  his tree,.      
+0001e250: 2020 616e 6420 6e6f 6465 2049 4473 2077    and node IDs w
+0001e260: 696c 6c20 6265 2063 6f6e 7365 7276 6564  ill be conserved
+0001e270: 2028 7468 6174 2069 732c 206e 6f64 6520   (that is, node 
+0001e280: 6060 7560 6020 696e 2074 6869 7320 7472  ``u`` in this tr
+0001e290: 6565 2077 696c 6c0a 2020 2020 2020 2020  ee will.        
+0001e2a0: 6265 2074 6865 2073 616d 6520 6e6f 6465  be the same node
+0001e2b0: 2069 6e20 7468 6520 7265 7475 726e 6564   in the returned
+0001e2c0: 2074 7265 6529 2e20 5468 6520 7265 7475   tree). The retu
+0001e2d0: 726e 6564 2074 7265 6520 6973 2064 6572  rned tree is der
+0001e2e0: 6976 6564 2066 726f 6d20 610a 2020 2020  ived from a.    
+0001e2f0: 2020 2020 7472 6565 2073 6571 7565 6e63      tree sequenc
+0001e300: 6520 7468 6174 2063 6f6e 7461 696e 7320  e that contains 
+0001e310: 6f6e 6c79 206f 6e65 206e 6f6e 2d64 6567  only one non-deg
+0001e320: 656e 6572 6174 6520 7472 6565 2c20 7468  enerate tree, th
+0001e330: 6174 2069 732c 2077 6865 7265 0a20 2020  at is, where.   
+0001e340: 2020 2020 2065 6467 6573 2063 6f76 6572       edges cover
+0001e350: 206f 6e6c 7920 7468 6520 696e 7465 7276   only the interv
+0001e360: 616c 2073 7061 6e6e 6564 2062 7920 7468  al spanned by th
+0001e370: 6973 2074 7265 652e 0a0a 2020 2020 2020  is tree...      
+0001e380: 2020 3a70 6172 616d 2065 7073 696c 6f6e    :param epsilon
+0001e390: 3a20 4966 2073 7065 6369 6669 6564 2c20  : If specified, 
+0001e3a0: 7468 6520 6669 7865 6420 6272 616e 6368  the fixed branch
+0001e3b0: 206c 656e 6774 6820 6265 7477 6565 6e20   length between 
+0001e3c0: 696e 7365 7274 6564 0a20 2020 2020 2020  inserted.       
+0001e3d0: 2020 2020 206e 6f64 6573 2061 6e64 2074       nodes and t
+0001e3e0: 6865 6972 2070 6172 656e 7473 2e20 4966  heir parents. If
+0001e3f0: 204e 6f6e 6520 2874 6865 2064 6566 6175   None (the defau
+0001e400: 6c74 292c 2074 6865 206d 696e 696d 616c  lt), the minimal
+0001e410: 2070 6f73 7369 626c 650a 2020 2020 2020   possible.      
+0001e420: 2020 2020 2020 6e6f 6e7a 6572 6f20 6272        nonzero br
+0001e430: 616e 6368 206c 656e 6774 6820 6973 2067  anch length is g
+0001e440: 656e 6572 6174 6564 2066 6f72 2065 6163  enerated for eac
+0001e450: 6820 6e6f 6465 2e0a 2020 2020 2020 2020  h node..        
+0001e460: 3a70 6172 616d 2073 7472 206d 6574 686f  :param str metho
+0001e470: 643a 2054 6865 206d 6574 686f 6420 7573  d: The method us
+0001e480: 6564 2074 6f20 6272 6561 6b20 706f 6c79  ed to break poly
+0001e490: 746f 6d69 6573 2e20 4375 7272 656e 746c  tomies. Currentl
+0001e4a0: 7920 6f6e 6c79 2022 7261 6e64 6f6d 220a  y only "random".
+0001e4b0: 2020 2020 2020 2020 2020 2020 6973 2073              is s
+0001e4c0: 7570 706f 7274 6564 2c20 7768 6963 6820  upported, which 
+0001e4d0: 6361 6e20 616c 736f 2062 6520 7370 6563  can also be spec
+0001e4e0: 6966 6965 6420 6279 2060 606d 6574 686f  ified by ``metho
+0001e4f0: 643d 4e6f 6e65 6060 0a20 2020 2020 2020  d=None``.       
+0001e500: 2020 2020 2028 4465 6661 756c 743a 2060       (Default: `
+0001e510: 604e 6f6e 6560 6029 2e0a 2020 2020 2020  `None``)..      
+0001e520: 2020 3a70 6172 616d 2062 6f6f 6c20 7265    :param bool re
+0001e530: 636f 7264 5f70 726f 7665 6e61 6e63 653a  cord_provenance:
+0001e540: 2049 6620 5472 7565 2c20 6164 6420 6465   If True, add de
+0001e550: 7461 696c 7320 6f66 2074 6869 7320 6f70  tails of this op
+0001e560: 6572 6174 696f 6e20 746f 2074 6865 0a20  eration to the. 
+0001e570: 2020 2020 2020 2020 2020 2070 726f 7665             prove
+0001e580: 6e61 6e63 6520 696e 666f 726d 6174 696f  nance informatio
+0001e590: 6e20 6f66 2074 6865 2072 6574 7572 6e65  n of the returne
+0001e5a0: 6420 7472 6565 2073 6571 7565 6e63 652e  d tree sequence.
+0001e5b0: 2028 4465 6661 756c 743a 2054 7275 6529   (Default: True)
+0001e5c0: 2e0a 2020 2020 2020 2020 3a70 6172 616d  ..        :param
+0001e5d0: 2069 6e74 2072 616e 646f 6d5f 7365 6564   int random_seed
+0001e5e0: 3a20 5468 6520 7261 6e64 6f6d 2073 6565  : The random see
+0001e5f0: 642e 2049 6620 7468 6973 2069 7320 4e6f  d. If this is No
+0001e600: 6e65 2c20 6120 7261 6e64 6f6d 2073 6565  ne, a random see
+0001e610: 6420 7769 6c6c 0a20 2020 2020 2020 2020  d will.         
+0001e620: 2020 2062 6520 6175 746f 6d61 7469 6361     be automatica
+0001e630: 6c6c 7920 6765 6e65 7261 7465 642e 2056  lly generated. V
+0001e640: 616c 6964 2072 616e 646f 6d20 7365 6564  alid random seed
+0001e650: 7320 6d75 7374 2062 6520 6265 7477 6565  s must be betwee
+0001e660: 6e20 3120 616e 640a 2020 2020 2020 2020  n 1 and.        
+0001e670: 2020 2020 3a6d 6174 683a 6032 5e33 3220      :math:`2^32 
+0001e680: e288 9220 3160 2e0a 2020 2020 2020 2020  ... 1`..        
+0001e690: 3a70 6172 616d 205c 5c2a 2a6b 7761 7267  :param \\**kwarg
+0001e6a0: 733a 2046 7572 7468 6572 2061 7267 756d  s: Further argum
+0001e6b0: 656e 7473 2075 7365 6420 6173 2070 6172  ents used as par
+0001e6c0: 616d 6574 6572 7320 7768 656e 2063 6f6e  ameters when con
+0001e6d0: 7374 7275 6374 696e 6720 7468 650a 2020  structing the.  
+0001e6e0: 2020 2020 2020 2020 2020 7265 7475 726e            return
+0001e6f0: 6564 203a 636c 6173 733a 6054 7265 6560  ed :class:`Tree`
+0001e700: 2e20 466f 7220 6578 616d 706c 650a 2020  . For example.  
+0001e710: 2020 2020 2020 2020 2020 6060 7472 6565            ``tree
+0001e720: 2e73 706c 6974 5f70 6f6c 7974 6f6d 6965  .split_polytomie
+0001e730: 7328 7361 6d70 6c65 5f6c 6973 7473 3d54  s(sample_lists=T
+0001e740: 7275 6529 6060 2077 696c 6c0a 2020 2020  rue)`` will.    
+0001e750: 2020 2020 2020 2020 7265 7475 726e 2061          return a
+0001e760: 203a 636c 6173 733a 6054 7265 6560 2063   :class:`Tree` c
+0001e770: 7265 6174 6564 2077 6974 6820 6060 7361  reated with ``sa
+0001e780: 6d70 6c65 5f6c 6973 7473 3d54 7275 6560  mple_lists=True`
+0001e790: 602e 0a20 2020 2020 2020 203a 7265 7475  `..        :retu
+0001e7a0: 726e 3a20 4120 6e65 7720 7472 6565 2077  rn: A new tree w
+0001e7b0: 6974 6820 706f 6c79 746f 6d69 6573 2073  ith polytomies s
+0001e7c0: 706c 6974 2069 6e74 6f20 7261 6e64 6f6d  plit into random
+0001e7d0: 2062 6966 7572 6361 7469 6f6e 732e 0a20   bifurcations.. 
+0001e7e0: 2020 2020 2020 203a 7274 7970 653a 2074         :rtype: t
+0001e7f0: 736b 6974 2e54 7265 650a 2020 2020 2020  skit.Tree.      
+0001e800: 2020 2222 220a 2020 2020 2020 2020 7265    """.        re
+0001e810: 7475 726e 2063 6f6d 6269 6e61 746f 7269  turn combinatori
+0001e820: 6373 2e73 706c 6974 5f70 6f6c 7974 6f6d  cs.split_polytom
+0001e830: 6965 7328 0a20 2020 2020 2020 2020 2020  ies(.           
+0001e840: 2073 656c 662c 0a20 2020 2020 2020 2020   self,.         
+0001e850: 2020 2065 7073 696c 6f6e 3d65 7073 696c     epsilon=epsil
+0001e860: 6f6e 2c0a 2020 2020 2020 2020 2020 2020  on,.            
+0001e870: 6d65 7468 6f64 3d6d 6574 686f 642c 0a20  method=method,. 
+0001e880: 2020 2020 2020 2020 2020 2072 6563 6f72             recor
+0001e890: 645f 7072 6f76 656e 616e 6365 3d72 6563  d_provenance=rec
+0001e8a0: 6f72 645f 7072 6f76 656e 616e 6365 2c0a  ord_provenance,.
+0001e8b0: 2020 2020 2020 2020 2020 2020 7261 6e64              rand
+0001e8c0: 6f6d 5f73 6565 643d 7261 6e64 6f6d 5f73  om_seed=random_s
+0001e8d0: 6565 642c 0a20 2020 2020 2020 2020 2020  eed,.           
+0001e8e0: 202a 2a6b 7761 7267 732c 0a20 2020 2020   **kwargs,.     
+0001e8f0: 2020 2029 0a0a 2020 2020 4073 7461 7469     )..    @stati
+0001e900: 636d 6574 686f 640a 2020 2020 6465 6620  cmethod.    def 
+0001e910: 6765 6e65 7261 7465 5f73 7461 7228 0a20  generate_star(. 
+0001e920: 2020 2020 2020 206e 756d 5f6c 6561 7665         num_leave
+0001e930: 732c 202a 2c20 7370 616e 3d31 2c20 6272  s, *, span=1, br
+0001e940: 616e 6368 5f6c 656e 6774 683d 312c 2072  anch_length=1, r
+0001e950: 6563 6f72 645f 7072 6f76 656e 616e 6365  ecord_provenance
+0001e960: 3d54 7275 652c 202a 2a6b 7761 7267 730a  =True, **kwargs.
+0001e970: 2020 2020 293a 0a20 2020 2020 2020 2022      ):.        "
+0001e980: 2222 0a20 2020 2020 2020 2047 656e 6572  "".        Gener
+0001e990: 6174 6520 6120 3a63 6c61 7373 3a60 5472  ate a :class:`Tr
+0001e9a0: 6565 6020 7768 6f73 6520 6c65 6166 206e  ee` whose leaf n
+0001e9b0: 6f64 6573 2061 6c6c 2068 6176 6520 7468  odes all have th
+0001e9c0: 6520 7361 6d65 2070 6172 656e 7420 2869  e same parent (i
+0001e9d0: 2e65 2e2c 0a20 2020 2020 2020 2061 2022  .e.,.        a "
+0001e9e0: 7374 6172 2220 7472 6565 292e 2054 6865  star" tree). The
+0001e9f0: 206c 6561 6620 6e6f 6465 7320 6172 6520   leaf nodes are 
+0001ea00: 616c 6c20 6174 2074 696d 6520 3020 616e  all at time 0 an
+0001ea10: 6420 6172 6520 6d61 726b 6564 2061 7320  d are marked as 
+0001ea20: 7361 6d70 6c65 206e 6f64 6573 2e0a 0a20  sample nodes... 
+0001ea30: 2020 2020 2020 2054 6865 2074 7265 6520         The tree 
+0001ea40: 7072 6f64 7563 6564 2062 7920 7468 6973  produced by this
+0001ea50: 206d 6574 686f 6420 6973 2069 6465 6e74   method is ident
+0001ea60: 6963 616c 2074 6f0a 2020 2020 2020 2020  ical to.        
+0001ea70: 6060 7473 6b69 742e 5472 6565 2e75 6e72  ``tskit.Tree.unr
+0001ea80: 616e 6b28 6e2c 2028 302c 2030 2929 6060  ank(n, (0, 0))``
+0001ea90: 2c20 6275 7420 6765 6e65 7261 7465 6420  , but generated 
+0001eaa0: 6d6f 7265 2065 6666 6963 6965 6e74 6c79  more efficiently
+0001eab0: 2066 6f72 206c 6172 6765 2060 606e 6060   for large ``n``
+0001eac0: 2e0a 0a20 2020 2020 2020 203a 7061 7261  ...        :para
+0001ead0: 6d20 696e 7420 6e75 6d5f 6c65 6176 6573  m int num_leaves
+0001eae0: 3a20 5468 6520 6e75 6d62 6572 206f 6620  : The number of 
+0001eaf0: 6c65 6166 206e 6f64 6573 2069 6e20 7468  leaf nodes in th
+0001eb00: 6520 7265 7475 726e 6564 2074 7265 6520  e returned tree 
+0001eb10: 286d 7573 7420 6265 0a20 2020 2020 2020  (must be.       
+0001eb20: 2020 2020 2032 206f 7220 6772 6561 7465       2 or greate
+0001eb30: 7229 2e0a 2020 2020 2020 2020 3a70 6172  r)..        :par
+0001eb40: 616d 2066 6c6f 6174 2073 7061 6e3a 2054  am float span: T
+0001eb50: 6865 2073 7061 6e20 6f66 2074 6865 2074  he span of the t
+0001eb60: 7265 652c 2061 6e64 2074 6865 7265 666f  ree, and therefo
+0001eb70: 7265 2074 6865 0a20 2020 2020 2020 2020  re the.         
+0001eb80: 2020 203a 6174 7472 3a60 7e54 7265 6553     :attr:`~TreeS
+0001eb90: 6571 7565 6e63 652e 7365 7175 656e 6365  equence.sequence
+0001eba0: 5f6c 656e 6774 6860 206f 6620 7468 6520  _length` of the 
+0001ebb0: 3a61 7474 723a 602e 7472 6565 5f73 6571  :attr:`.tree_seq
+0001ebc0: 7565 6e63 6560 0a20 2020 2020 2020 2020  uence`.         
+0001ebd0: 2020 2070 726f 7065 7274 7920 6f66 2074     property of t
+0001ebe0: 6865 2072 6574 7572 6e65 6420 3a63 6c61  he returned :cla
+0001ebf0: 7373 3a60 5472 6565 602e 0a20 2020 2020  ss:`Tree`..     
+0001ec00: 2020 203a 7061 7261 6d20 666c 6f61 7420     :param float 
+0001ec10: 6272 616e 6368 5f6c 656e 6774 683a 2054  branch_length: T
+0001ec20: 6865 206c 656e 6774 6820 6f66 2065 7665  he length of eve
+0001ec30: 7279 2062 7261 6e63 6820 696e 2074 6865  ry branch in the
+0001ec40: 2074 7265 6520 2865 7175 6976 616c 656e   tree (equivalen
+0001ec50: 740a 2020 2020 2020 2020 2020 2020 746f  t.            to
+0001ec60: 2074 6865 2074 696d 6520 6f66 2074 6865   the time of the
+0001ec70: 2072 6f6f 7420 6e6f 6465 292e 0a20 2020   root node)..   
+0001ec80: 2020 2020 203a 7061 7261 6d20 626f 6f6c       :param bool
+0001ec90: 2072 6563 6f72 645f 7072 6f76 656e 616e   record_provenan
+0001eca0: 6365 3a20 4966 2054 7275 652c 2061 6464  ce: If True, add
+0001ecb0: 2064 6574 6169 6c73 206f 6620 7468 6973   details of this
+0001ecc0: 206f 7065 7261 7469 6f6e 2074 6f20 7468   operation to th
+0001ecd0: 650a 2020 2020 2020 2020 2020 2020 7072  e.            pr
+0001ece0: 6f76 656e 616e 6365 2069 6e66 6f72 6d61  ovenance informa
+0001ecf0: 7469 6f6e 206f 6620 7468 6520 7265 7475  tion of the retu
+0001ed00: 726e 6564 2074 7265 6520 7365 7175 656e  rned tree sequen
+0001ed10: 6365 2e20 2844 6566 6175 6c74 3a20 5472  ce. (Default: Tr
+0001ed20: 7565 292e 0a20 2020 2020 2020 203a 7061  ue)..        :pa
+0001ed30: 7261 6d20 5c5c 2a2a 6b77 6172 6773 3a20  ram \\**kwargs: 
+0001ed40: 4675 7274 6865 7220 6172 6775 6d65 6e74  Further argument
+0001ed50: 7320 7573 6564 2061 7320 7061 7261 6d65  s used as parame
+0001ed60: 7465 7273 2077 6865 6e20 636f 6e73 7472  ters when constr
+0001ed70: 7563 7469 6e67 2074 6865 0a20 2020 2020  ucting the.     
+0001ed80: 2020 2020 2020 2072 6574 7572 6e65 6420         returned 
+0001ed90: 3a63 6c61 7373 3a60 5472 6565 602e 2046  :class:`Tree`. F
+0001eda0: 6f72 2065 7861 6d70 6c65 0a20 2020 2020  or example.     
+0001edb0: 2020 2020 2020 2060 6074 736b 6974 2e54         ``tskit.T
+0001edc0: 7265 652e 6765 6e65 7261 7465 5f73 7461  ree.generate_sta
+0001edd0: 7228 7361 6d70 6c65 5f6c 6973 7473 3d54  r(sample_lists=T
+0001ede0: 7275 6529 6060 2077 696c 6c0a 2020 2020  rue)`` will.    
+0001edf0: 2020 2020 2020 2020 7265 7475 726e 2061          return a
+0001ee00: 203a 636c 6173 733a 6054 7265 6560 2063   :class:`Tree` c
+0001ee10: 7265 6174 6564 2077 6974 6820 6060 7361  reated with ``sa
+0001ee20: 6d70 6c65 5f6c 6973 7473 3d54 7275 6560  mple_lists=True`
+0001ee30: 602e 0a20 2020 2020 2020 203a 7265 7475  `..        :retu
+0001ee40: 726e 3a20 4120 7374 6172 2d73 6861 7065  rn: A star-shape
+0001ee50: 6420 7472 6565 2e20 4974 7320 636f 7272  d tree. Its corr
+0001ee60: 6573 706f 6e64 696e 6720 3a63 6c61 7373  esponding :class
+0001ee70: 3a60 5472 6565 5365 7175 656e 6365 6020  :`TreeSequence` 
+0001ee80: 6973 2061 7661 696c 6162 6c65 0a20 2020  is available.   
+0001ee90: 2020 2020 2020 2020 2076 6961 2074 6865           via the
+0001eea0: 203a 6174 7472 3a60 2e74 7265 655f 7365   :attr:`.tree_se
+0001eeb0: 7175 656e 6365 6020 6174 7472 6962 7574  quence` attribut
+0001eec0: 652e 0a20 2020 2020 2020 203a 7274 7970  e..        :rtyp
+0001eed0: 653a 2054 7265 650a 2020 2020 2020 2020  e: Tree.        
+0001eee0: 2222 220a 2020 2020 2020 2020 7265 7475  """.        retu
+0001eef0: 726e 2063 6f6d 6269 6e61 746f 7269 6373  rn combinatorics
+0001ef00: 2e67 656e 6572 6174 655f 7374 6172 280a  .generate_star(.
+0001ef10: 2020 2020 2020 2020 2020 2020 6e75 6d5f              num_
+0001ef20: 6c65 6176 6573 2c0a 2020 2020 2020 2020  leaves,.        
+0001ef30: 2020 2020 7370 616e 3d73 7061 6e2c 0a20      span=span,. 
+0001ef40: 2020 2020 2020 2020 2020 2062 7261 6e63             branc
+0001ef50: 685f 6c65 6e67 7468 3d62 7261 6e63 685f  h_length=branch_
+0001ef60: 6c65 6e67 7468 2c0a 2020 2020 2020 2020  length,.        
+0001ef70: 2020 2020 7265 636f 7264 5f70 726f 7665      record_prove
+0001ef80: 6e61 6e63 653d 7265 636f 7264 5f70 726f  nance=record_pro
+0001ef90: 7665 6e61 6e63 652c 0a20 2020 2020 2020  venance,.       
+0001efa0: 2020 2020 202a 2a6b 7761 7267 732c 0a20       **kwargs,. 
+0001efb0: 2020 2020 2020 2029 0a0a 2020 2020 4073         )..    @s
+0001efc0: 7461 7469 636d 6574 686f 640a 2020 2020  taticmethod.    
+0001efd0: 6465 6620 6765 6e65 7261 7465 5f62 616c  def generate_bal
+0001efe0: 616e 6365 6428 0a20 2020 2020 2020 206e  anced(.        n
+0001eff0: 756d 5f6c 6561 7665 732c 0a20 2020 2020  um_leaves,.     
+0001f000: 2020 202a 2c0a 2020 2020 2020 2020 6172     *,.        ar
+0001f010: 6974 793d 322c 0a20 2020 2020 2020 2073  ity=2,.        s
+0001f020: 7061 6e3d 312c 0a20 2020 2020 2020 2062  pan=1,.        b
+0001f030: 7261 6e63 685f 6c65 6e67 7468 3d31 2c0a  ranch_length=1,.
+0001f040: 2020 2020 2020 2020 7265 636f 7264 5f70          record_p
+0001f050: 726f 7665 6e61 6e63 653d 5472 7565 2c0a  rovenance=True,.
+0001f060: 2020 2020 2020 2020 2a2a 6b77 6172 6773          **kwargs
+0001f070: 2c0a 2020 2020 293a 0a20 2020 2020 2020  ,.    ):.       
+0001f080: 2022 2222 0a20 2020 2020 2020 2047 656e   """.        Gen
+0001f090: 6572 6174 6520 6120 3a63 6c61 7373 3a60  erate a :class:`
+0001f0a0: 5472 6565 6020 7769 7468 2074 6865 2073  Tree` with the s
+0001f0b0: 7065 6369 6669 6564 206e 756d 6265 7220  pecified number 
+0001f0c0: 6f66 206c 6561 7665 7320 7468 6174 2069  of leaves that i
+0001f0d0: 7320 6d61 7869 6d61 6c6c 790a 2020 2020  s maximally.    
+0001f0e0: 2020 2020 6261 6c61 6e63 6564 2e20 4279      balanced. By
+0001f0f0: 2064 6566 6175 6c74 2c20 7468 6520 7472   default, the tr
+0001f100: 6565 2072 6574 7572 6e65 6420 6973 2062  ee returned is b
+0001f110: 696e 6172 792c 2073 7563 6820 7468 6174  inary, such that
+0001f120: 2066 6f72 2065 6163 680a 2020 2020 2020   for each.      
+0001f130: 2020 6e6f 6465 2074 6861 7420 7375 6274    node that subt
+0001f140: 656e 6473 203a 6d61 7468 3a60 6e60 206c  ends :math:`n` l
+0001f150: 6561 7665 732c 2074 6865 206c 6566 7420  eaves, the left 
+0001f160: 6368 696c 6420 7769 6c6c 2073 7562 7465  child will subte
+0001f170: 6e64 0a20 2020 2020 2020 203a 6d61 7468  nd.        :math
+0001f180: 3a60 5c5c 6c66 6c6f 6f72 7b6e 202f 2032  :`\\lfloor{n / 2
+0001f190: 7d5c 5c72 666c 6f6f 7260 206c 6561 7665  }\\rfloor` leave
+0001f1a0: 7320 616e 6420 7468 6520 7269 6768 7420  s and the right 
+0001f1b0: 6368 696c 6420 7468 650a 2020 2020 2020  child the.      
+0001f1c0: 2020 7265 6d61 696e 6465 722e 2042 616c    remainder. Bal
+0001f1d0: 616e 6365 6420 7472 6565 7320 7769 7468  anced trees with
+0001f1e0: 2068 6967 6865 7220 6172 6974 7920 6361   higher arity ca
+0001f1f0: 6e20 616c 736f 2067 656e 6572 6174 6564  n also generated
+0001f200: 2075 7369 6e67 2074 6865 0a20 2020 2020   using the.     
+0001f210: 2020 2060 6061 7269 7479 6060 2070 6172     ``arity`` par
+0001f220: 616d 6574 6572 2c20 7768 6572 6520 7468  ameter, where th
+0001f230: 6520 6c65 6176 6573 2073 7562 7465 6e64  e leaves subtend
+0001f240: 696e 6720 6120 6e6f 6465 2061 7265 2064  ing a node are d
+0001f250: 6973 7472 6962 7574 6564 0a20 2020 2020  istributed.     
+0001f260: 2020 2061 6d6f 6e67 2069 7473 2063 6869     among its chi
+0001f270: 6c64 7265 6e20 616e 616c 6f67 6f75 736c  ldren analogousl
+0001f280: 792e 0a0a 2020 2020 2020 2020 496e 2074  y...        In t
+0001f290: 6865 2072 6574 7572 6e65 6420 7472 6565  he returned tree
+0001f2a0: 2c20 7468 6520 6c65 6166 206e 6f64 6573  , the leaf nodes
+0001f2b0: 2061 7265 2061 6c6c 2061 7420 7469 6d65   are all at time
+0001f2c0: 2030 2c20 6d61 726b 6564 2061 7320 7361   0, marked as sa
+0001f2d0: 6d70 6c65 732c 0a20 2020 2020 2020 2061  mples,.        a
+0001f2e0: 6e64 206c 6162 656c 6c65 6420 3020 746f  nd labelled 0 to
+0001f2f0: 206e 2066 726f 6d20 6c65 6674 2d74 6f2d   n from left-to-
+0001f300: 7269 6768 742e 2049 6e74 6572 6e61 6c20  right. Internal 
+0001f310: 6e6f 6465 2049 4473 2061 7265 2061 7373  node IDs are ass
+0001f320: 6967 6e65 640a 2020 2020 2020 2020 7365  igned.        se
+0001f330: 7175 656e 7469 616c 6c79 2066 726f 6d20  quentially from 
+0001f340: 6e20 696e 2061 2070 6f73 746f 7264 6572  n in a postorder
+0001f350: 2074 7261 7665 7273 616c 2c20 616e 6420   traversal, and 
+0001f360: 7468 6520 7469 6d65 206f 6620 616e 2069  the time of an i
+0001f370: 6e74 6572 6e61 6c0a 2020 2020 2020 2020  nternal.        
+0001f380: 6e6f 6465 2069 7320 7468 6520 6d61 7869  node is the maxi
+0001f390: 6d75 6d20 7469 6d65 206f 6620 6974 7320  mum time of its 
+0001f3a0: 6368 696c 6472 656e 2070 6c75 7320 7468  children plus th
+0001f3b0: 6520 7370 6563 6966 6965 6420 6060 6272  e specified ``br
+0001f3c0: 616e 6368 5f6c 656e 6774 6860 602e 0a0a  anch_length``...
+0001f3d0: 2020 2020 2020 2020 3a70 6172 616d 2069          :param i
+0001f3e0: 6e74 206e 756d 5f6c 6561 7665 733a 2054  nt num_leaves: T
+0001f3f0: 6865 206e 756d 6265 7220 6f66 206c 6561  he number of lea
+0001f400: 6620 6e6f 6465 7320 696e 2074 6865 2072  f nodes in the r
+0001f410: 6574 7572 6e65 6420 7472 6565 2028 6d75  eturned tree (mu
+0001f420: 7374 2062 650a 2020 2020 2020 2020 2020  st be.          
+0001f430: 2020 6265 2032 206f 7220 6772 6561 7465    be 2 or greate
+0001f440: 7229 2e0a 2020 2020 2020 2020 3a70 6172  r)..        :par
+0001f450: 616d 2069 6e74 2061 7269 7479 3a20 5468  am int arity: Th
+0001f460: 6520 6d61 7869 6d75 6d20 6e75 6d62 6572  e maximum number
+0001f470: 206f 6620 6368 696c 6472 656e 2061 206e   of children a n
+0001f480: 6f64 6520 6361 6e20 6861 7665 2069 6e20  ode can have in 
+0001f490: 7468 6520 7265 7475 726e 6564 0a20 2020  the returned.   
+0001f4a0: 2020 2020 2020 2020 2074 7265 652e 0a20           tree.. 
+0001f4b0: 2020 2020 2020 203a 7061 7261 6d20 666c         :param fl
+0001f4c0: 6f61 7420 7370 616e 3a20 5468 6520 7370  oat span: The sp
+0001f4d0: 616e 206f 6620 7468 6520 7472 6565 2c20  an of the tree, 
+0001f4e0: 616e 6420 7468 6572 6566 6f72 6520 7468  and therefore th
+0001f4f0: 650a 2020 2020 2020 2020 2020 2020 3a61  e.            :a
+0001f500: 7474 723a 607e 5472 6565 5365 7175 656e  ttr:`~TreeSequen
+0001f510: 6365 2e73 6571 7565 6e63 655f 6c65 6e67  ce.sequence_leng
+0001f520: 7468 6020 6f66 2074 6865 203a 6174 7472  th` of the :attr
+0001f530: 3a60 2e74 7265 655f 7365 7175 656e 6365  :`.tree_sequence
+0001f540: 600a 2020 2020 2020 2020 2020 2020 7072  `.            pr
+0001f550: 6f70 6572 7479 206f 6620 7468 6520 7265  operty of the re
+0001f560: 7475 726e 6564 203a 636c 6173 733a 6054  turned :class:`T
+0001f570: 7265 6560 2e0a 2020 2020 2020 2020 3a70  ree`..        :p
+0001f580: 6172 616d 2066 6c6f 6174 2062 7261 6e63  aram float branc
+0001f590: 685f 6c65 6e67 7468 3a20 5468 6520 6d69  h_length: The mi
+0001f5a0: 6e69 6d75 6d20 6c65 6e67 7468 206f 6620  nimum length of 
+0001f5b0: 6120 6272 616e 6368 2069 6e20 7468 6520  a branch in the 
+0001f5c0: 7472 6565 2028 7365 650a 2020 2020 2020  tree (see.      
+0001f5d0: 2020 2020 2020 6162 6f76 6520 666f 7220        above for 
+0001f5e0: 6465 7461 696c 7320 6f6e 2068 6f77 2069  details on how i
+0001f5f0: 6e74 6572 6e61 6c20 6e6f 6465 2074 696d  nternal node tim
+0001f600: 6573 2061 7265 2061 7373 6967 6e65 6429  es are assigned)
+0001f610: 2e0a 2020 2020 2020 2020 3a70 6172 616d  ..        :param
+0001f620: 2062 6f6f 6c20 7265 636f 7264 5f70 726f   bool record_pro
+0001f630: 7665 6e61 6e63 653a 2049 6620 5472 7565  venance: If True
+0001f640: 2c20 6164 6420 6465 7461 696c 7320 6f66  , add details of
+0001f650: 2074 6869 7320 6f70 6572 6174 696f 6e20   this operation 
+0001f660: 746f 2074 6865 0a20 2020 2020 2020 2020  to the.         
+0001f670: 2020 2070 726f 7665 6e61 6e63 6520 696e     provenance in
+0001f680: 666f 726d 6174 696f 6e20 6f66 2074 6865  formation of the
+0001f690: 2072 6574 7572 6e65 6420 7472 6565 2073   returned tree s
+0001f6a0: 6571 7565 6e63 652e 2028 4465 6661 756c  equence. (Defaul
+0001f6b0: 743a 2054 7275 6529 2e0a 2020 2020 2020  t: True)..      
+0001f6c0: 2020 3a70 6172 616d 205c 5c2a 2a6b 7761    :param \\**kwa
+0001f6d0: 7267 733a 2046 7572 7468 6572 2061 7267  rgs: Further arg
+0001f6e0: 756d 656e 7473 2075 7365 6420 6173 2070  uments used as p
+0001f6f0: 6172 616d 6574 6572 7320 7768 656e 2063  arameters when c
+0001f700: 6f6e 7374 7275 6374 696e 6720 7468 650a  onstructing the.
+0001f710: 2020 2020 2020 2020 2020 2020 7265 7475              retu
+0001f720: 726e 6564 203a 636c 6173 733a 6054 7265  rned :class:`Tre
+0001f730: 6560 2e20 466f 7220 6578 616d 706c 650a  e`. For example.
+0001f740: 2020 2020 2020 2020 2020 2020 6060 7473              ``ts
+0001f750: 6b69 742e 5472 6565 2e67 656e 6572 6174  kit.Tree.generat
+0001f760: 655f 6261 6c61 6e63 6564 2873 616d 706c  e_balanced(sampl
+0001f770: 655f 6c69 7374 733d 5472 7565 2960 6020  e_lists=True)`` 
+0001f780: 7769 6c6c 0a20 2020 2020 2020 2020 2020  will.           
+0001f790: 2072 6574 7572 6e20 6120 3a63 6c61 7373   return a :class
+0001f7a0: 3a60 5472 6565 6020 6372 6561 7465 6420  :`Tree` created 
+0001f7b0: 7769 7468 2060 6073 616d 706c 655f 6c69  with ``sample_li
+0001f7c0: 7374 733d 5472 7565 6060 2e0a 2020 2020  sts=True``..    
+0001f7d0: 2020 2020 3a72 6574 7572 6e3a 2041 2062      :return: A b
+0001f7e0: 616c 616e 6365 6420 7472 6565 2e20 4974  alanced tree. It
+0001f7f0: 7320 636f 7272 6573 706f 6e64 696e 6720  s corresponding 
+0001f800: 3a63 6c61 7373 3a60 5472 6565 5365 7175  :class:`TreeSequ
+0001f810: 656e 6365 6020 6973 2061 7661 696c 6162  ence` is availab
+0001f820: 6c65 0a20 2020 2020 2020 2020 2020 2076  le.            v
+0001f830: 6961 2074 6865 203a 6174 7472 3a60 2e74  ia the :attr:`.t
+0001f840: 7265 655f 7365 7175 656e 6365 6020 6174  ree_sequence` at
+0001f850: 7472 6962 7574 652e 0a20 2020 2020 2020  tribute..       
+0001f860: 203a 7274 7970 653a 2054 7265 650a 2020   :rtype: Tree.  
+0001f870: 2020 2020 2020 2222 220a 2020 2020 2020        """.      
+0001f880: 2020 7265 7475 726e 2063 6f6d 6269 6e61    return combina
+0001f890: 746f 7269 6373 2e67 656e 6572 6174 655f  torics.generate_
+0001f8a0: 6261 6c61 6e63 6564 280a 2020 2020 2020  balanced(.      
+0001f8b0: 2020 2020 2020 6e75 6d5f 6c65 6176 6573        num_leaves
+0001f8c0: 2c0a 2020 2020 2020 2020 2020 2020 6172  ,.            ar
+0001f8d0: 6974 793d 6172 6974 792c 0a20 2020 2020  ity=arity,.     
+0001f8e0: 2020 2020 2020 2073 7061 6e3d 7370 616e         span=span
+0001f8f0: 2c0a 2020 2020 2020 2020 2020 2020 6272  ,.            br
+0001f900: 616e 6368 5f6c 656e 6774 683d 6272 616e  anch_length=bran
+0001f910: 6368 5f6c 656e 6774 682c 0a20 2020 2020  ch_length,.     
+0001f920: 2020 2020 2020 2072 6563 6f72 645f 7072         record_pr
+0001f930: 6f76 656e 616e 6365 3d72 6563 6f72 645f  ovenance=record_
+0001f940: 7072 6f76 656e 616e 6365 2c0a 2020 2020  provenance,.    
+0001f950: 2020 2020 2020 2020 2a2a 6b77 6172 6773          **kwargs
+0001f960: 2c0a 2020 2020 2020 2020 290a 0a20 2020  ,.        )..   
+0001f970: 2040 7374 6174 6963 6d65 7468 6f64 0a20   @staticmethod. 
+0001f980: 2020 2064 6566 2067 656e 6572 6174 655f     def generate_
+0001f990: 636f 6d62 280a 2020 2020 2020 2020 6e75  comb(.        nu
+0001f9a0: 6d5f 6c65 6176 6573 2c20 2a2c 2073 7061  m_leaves, *, spa
+0001f9b0: 6e3d 312c 2062 7261 6e63 685f 6c65 6e67  n=1, branch_leng
+0001f9c0: 7468 3d31 2c20 7265 636f 7264 5f70 726f  th=1, record_pro
+0001f9d0: 7665 6e61 6e63 653d 5472 7565 2c20 2a2a  venance=True, **
+0001f9e0: 6b77 6172 6773 0a20 2020 2029 3a0a 2020  kwargs.    ):.  
+0001f9f0: 2020 2020 2020 2222 220a 2020 2020 2020        """.      
+0001fa00: 2020 4765 6e65 7261 7465 2061 203a 636c    Generate a :cl
+0001fa10: 6173 733a 6054 7265 6560 2069 6e20 7768  ass:`Tree` in wh
+0001fa20: 6963 6820 616c 6c20 696e 7465 726e 616c  ich all internal
+0001fa30: 206e 6f64 6573 2068 6176 6520 7477 6f20   nodes have two 
+0001fa40: 6368 696c 6472 656e 0a20 2020 2020 2020  children.       
+0001fa50: 2061 6e64 2074 6865 206c 6566 7420 6368   and the left ch
+0001fa60: 696c 6420 6973 2061 206c 6561 662e 2054  ild is a leaf. T
+0001fa70: 6869 7320 6973 2061 2022 636f 6d62 222c  his is a "comb",
+0001fa80: 2022 6c61 6464 6572 2220 6f72 2022 7065   "ladder" or "pe
+0001fa90: 6374 696e 6174 6522 0a20 2020 2020 2020  ctinate".       
+0001faa0: 2070 6879 6c6f 6765 6e79 2c20 616e 6420   phylogeny, and 
+0001fab0: 616c 736f 206b 6e6f 776e 2061 7320 6120  also known as a 
+0001fac0: 6063 6174 6572 7069 6c6c 6172 2074 7265  `caterpillar tre
+0001fad0: 650a 2020 2020 2020 2020 3c68 7474 7073  e.        <https
+0001fae0: 3a2f 2f65 6e2e 7769 6b69 7065 6469 612e  ://en.wikipedia.
+0001faf0: 6f72 672f 7769 6b69 2f43 6174 6572 7069  org/wiki/Caterpi
+0001fb00: 6c6c 6172 5f74 7265 653e 605f 2e0a 0a20  llar_tree>`_... 
+0001fb10: 2020 2020 2020 2054 6865 206c 6561 6620         The leaf 
+0001fb20: 6e6f 6465 7320 6172 6520 616c 6c20 6174  nodes are all at
+0001fb30: 2074 696d 6520 302c 206d 6172 6b65 6420   time 0, marked 
+0001fb40: 6173 2073 616d 706c 6573 2c0a 2020 2020  as samples,.    
+0001fb50: 2020 2020 616e 6420 6c61 6265 6c6c 6564      and labelled
+0001fb60: 2030 2074 6f20 6e20 6672 6f6d 206c 6566   0 to n from lef
+0001fb70: 742d 746f 2d72 6967 6874 2e20 496e 7465  t-to-right. Inte
+0001fb80: 726e 616c 206e 6f64 6520 4944 7320 6172  rnal node IDs ar
+0001fb90: 6520 6173 7369 676e 6564 0a20 2020 2020  e assigned.     
+0001fba0: 2020 2073 6571 7565 6e74 6961 6c6c 7920     sequentially 
+0001fbb0: 6672 6f6d 206e 2061 7320 7765 2061 7363  from n as we asc
+0001fbc0: 656e 6420 7468 6520 7472 6565 2c20 616e  end the tree, an
+0001fbd0: 6420 7468 6520 7469 6d65 206f 6620 616e  d the time of an
+0001fbe0: 2069 6e74 6572 6e61 6c0a 2020 2020 2020   internal.      
+0001fbf0: 2020 6e6f 6465 2069 7320 7468 6520 6d61    node is the ma
+0001fc00: 7869 6d75 6d20 7469 6d65 206f 6620 6974  ximum time of it
+0001fc10: 7320 6368 696c 6472 656e 2070 6c75 7320  s children plus 
+0001fc20: 7468 6520 7370 6563 6966 6965 6420 6060  the specified ``
+0001fc30: 6272 616e 6368 5f6c 656e 6774 6860 602e  branch_length``.
+0001fc40: 0a0a 2020 2020 2020 2020 3a70 6172 616d  ..        :param
+0001fc50: 2069 6e74 206e 756d 5f6c 6561 7665 733a   int num_leaves:
+0001fc60: 2054 6865 206e 756d 6265 7220 6f66 206c   The number of l
+0001fc70: 6561 6620 6e6f 6465 7320 696e 2074 6865  eaf nodes in the
+0001fc80: 2072 6574 7572 6e65 6420 7472 6565 2028   returned tree (
+0001fc90: 6d75 7374 2062 650a 2020 2020 2020 2020  must be.        
+0001fca0: 2020 2020 3220 6f72 2067 7265 6174 6572      2 or greater
+0001fcb0: 292e 0a20 2020 2020 2020 203a 7061 7261  )..        :para
+0001fcc0: 6d20 666c 6f61 7420 7370 616e 3a20 5468  m float span: Th
+0001fcd0: 6520 7370 616e 206f 6620 7468 6520 7472  e span of the tr
+0001fce0: 6565 2c20 616e 6420 7468 6572 6566 6f72  ee, and therefor
+0001fcf0: 6520 7468 650a 2020 2020 2020 2020 2020  e the.          
+0001fd00: 2020 3a61 7474 723a 607e 5472 6565 5365    :attr:`~TreeSe
+0001fd10: 7175 656e 6365 2e73 6571 7565 6e63 655f  quence.sequence_
+0001fd20: 6c65 6e67 7468 6020 6f66 2074 6865 203a  length` of the :
+0001fd30: 6174 7472 3a60 2e74 7265 655f 7365 7175  attr:`.tree_sequ
+0001fd40: 656e 6365 600a 2020 2020 2020 2020 2020  ence`.          
+0001fd50: 2020 7072 6f70 6572 7479 206f 6620 7468    property of th
+0001fd60: 6520 7265 7475 726e 6564 203a 636c 6173  e returned :clas
+0001fd70: 733a 6054 7265 6560 2e0a 2020 2020 2020  s:`Tree`..      
+0001fd80: 2020 3a70 6172 616d 2066 6c6f 6174 2062    :param float b
+0001fd90: 7261 6e63 685f 6c65 6e67 7468 3a20 5468  ranch_length: Th
+0001fda0: 6520 6272 616e 6368 206c 656e 6774 6820  e branch length 
+0001fdb0: 6265 7477 6565 6e20 6561 6368 2069 6e74  between each int
+0001fdc0: 6572 6e61 6c20 6e6f 6465 3b20 7468 650a  ernal node; the.
+0001fdd0: 2020 2020 2020 2020 2020 2020 726f 6f74              root
+0001fde0: 206e 6f64 6520 6973 2074 6865 7265 666f   node is therefo
+0001fdf0: 7265 2070 6c61 6365 6420 6174 2074 696d  re placed at tim
+0001fe00: 6520 6060 6272 616e 6368 5f6c 656e 6774  e ``branch_lengt
+0001fe10: 6820 2a20 286e 756d 5f6c 6561 7665 7320  h * (num_leaves 
+0001fe20: 2d20 3129 6060 2e0a 2020 2020 2020 2020  - 1)``..        
+0001fe30: 3a70 6172 616d 2062 6f6f 6c20 7265 636f  :param bool reco
+0001fe40: 7264 5f70 726f 7665 6e61 6e63 653a 2049  rd_provenance: I
+0001fe50: 6620 5472 7565 2c20 6164 6420 6465 7461  f True, add deta
+0001fe60: 696c 7320 6f66 2074 6869 7320 6f70 6572  ils of this oper
+0001fe70: 6174 696f 6e20 746f 2074 6865 0a20 2020  ation to the.   
+0001fe80: 2020 2020 2020 2020 2070 726f 7665 6e61           provena
+0001fe90: 6e63 6520 696e 666f 726d 6174 696f 6e20  nce information 
+0001fea0: 6f66 2074 6865 2072 6574 7572 6e65 6420  of the returned 
+0001feb0: 7472 6565 2073 6571 7565 6e63 652e 2028  tree sequence. (
+0001fec0: 4465 6661 756c 743a 2054 7275 6529 2e0a  Default: True)..
+0001fed0: 2020 2020 2020 2020 3a70 6172 616d 205c          :param \
+0001fee0: 5c2a 2a6b 7761 7267 733a 2046 7572 7468  \**kwargs: Furth
+0001fef0: 6572 2061 7267 756d 656e 7473 2075 7365  er arguments use
+0001ff00: 6420 6173 2070 6172 616d 6574 6572 7320  d as parameters 
+0001ff10: 7768 656e 2063 6f6e 7374 7275 6374 696e  when constructin
+0001ff20: 6720 7468 650a 2020 2020 2020 2020 2020  g the.          
+0001ff30: 2020 7265 7475 726e 6564 203a 636c 6173    returned :clas
+0001ff40: 733a 6054 7265 6560 2e20 466f 7220 6578  s:`Tree`. For ex
+0001ff50: 616d 706c 650a 2020 2020 2020 2020 2020  ample.          
+0001ff60: 2020 6060 7473 6b69 742e 5472 6565 2e67    ``tskit.Tree.g
+0001ff70: 656e 6572 6174 655f 636f 6d62 2873 616d  enerate_comb(sam
+0001ff80: 706c 655f 6c69 7374 733d 5472 7565 2960  ple_lists=True)`
+0001ff90: 6020 7769 6c6c 0a20 2020 2020 2020 2020  ` will.         
+0001ffa0: 2020 2072 6574 7572 6e20 6120 3a63 6c61     return a :cla
+0001ffb0: 7373 3a60 5472 6565 6020 6372 6561 7465  ss:`Tree` create
+0001ffc0: 6420 7769 7468 2060 6073 616d 706c 655f  d with ``sample_
+0001ffd0: 6c69 7374 733d 5472 7565 6060 2e0a 2020  lists=True``..  
+0001ffe0: 2020 2020 2020 3a72 6574 7572 6e3a 2041        :return: A
+0001fff0: 2063 6f6d 622d 7368 6170 6564 2062 6966   comb-shaped bif
+00020000: 7572 6361 7469 6e67 2074 7265 652e 2049  urcating tree. I
+00020010: 7473 2063 6f72 7265 7370 6f6e 6469 6e67  ts corresponding
+00020020: 203a 636c 6173 733a 6054 7265 6553 6571   :class:`TreeSeq
+00020030: 7565 6e63 6560 0a20 2020 2020 2020 2020  uence`.         
+00020040: 2020 2069 7320 6176 6169 6c61 626c 6520     is available 
+00020050: 7669 6120 7468 6520 3a61 7474 723a 602e  via the :attr:`.
+00020060: 7472 6565 5f73 6571 7565 6e63 6560 2061  tree_sequence` a
+00020070: 7474 7269 6275 7465 2e0a 2020 2020 2020  ttribute..      
+00020080: 2020 3a72 7479 7065 3a20 5472 6565 0a20    :rtype: Tree. 
+00020090: 2020 2020 2020 2022 2222 0a20 2020 2020         """.     
+000200a0: 2020 2072 6574 7572 6e20 636f 6d62 696e     return combin
+000200b0: 6174 6f72 6963 732e 6765 6e65 7261 7465  atorics.generate
+000200c0: 5f63 6f6d 6228 0a20 2020 2020 2020 2020  _comb(.         
+000200d0: 2020 206e 756d 5f6c 6561 7665 732c 0a20     num_leaves,. 
+000200e0: 2020 2020 2020 2020 2020 2073 7061 6e3d             span=
+000200f0: 7370 616e 2c0a 2020 2020 2020 2020 2020  span,.          
+00020100: 2020 6272 616e 6368 5f6c 656e 6774 683d    branch_length=
+00020110: 6272 616e 6368 5f6c 656e 6774 682c 0a20  branch_length,. 
+00020120: 2020 2020 2020 2020 2020 2072 6563 6f72             recor
+00020130: 645f 7072 6f76 656e 616e 6365 3d72 6563  d_provenance=rec
+00020140: 6f72 645f 7072 6f76 656e 616e 6365 2c0a  ord_provenance,.
+00020150: 2020 2020 2020 2020 2020 2020 2a2a 6b77              **kw
+00020160: 6172 6773 2c0a 2020 2020 2020 2020 290a  args,.        ).
+00020170: 0a20 2020 2040 7374 6174 6963 6d65 7468  .    @staticmeth
+00020180: 6f64 0a20 2020 2064 6566 2067 656e 6572  od.    def gener
+00020190: 6174 655f 7261 6e64 6f6d 5f62 696e 6172  ate_random_binar
+000201a0: 7928 0a20 2020 2020 2020 206e 756d 5f6c  y(.        num_l
+000201b0: 6561 7665 732c 0a20 2020 2020 2020 202a  eaves,.        *
+000201c0: 2c0a 2020 2020 2020 2020 7370 616e 3d31  ,.        span=1
+000201d0: 2c0a 2020 2020 2020 2020 6272 616e 6368  ,.        branch
+000201e0: 5f6c 656e 6774 683d 312c 0a20 2020 2020  _length=1,.     
+000201f0: 2020 2072 616e 646f 6d5f 7365 6564 3d4e     random_seed=N
+00020200: 6f6e 652c 0a20 2020 2020 2020 2072 6563  one,.        rec
+00020210: 6f72 645f 7072 6f76 656e 616e 6365 3d54  ord_provenance=T
+00020220: 7275 652c 0a20 2020 2020 2020 202a 2a6b  rue,.        **k
+00020230: 7761 7267 732c 0a20 2020 2029 3a0a 2020  wargs,.    ):.  
+00020240: 2020 2020 2020 2222 220a 2020 2020 2020        """.      
+00020250: 2020 4765 6e65 7261 7465 2061 2072 616e    Generate a ran
+00020260: 646f 6d20 6269 6e61 7279 203a 636c 6173  dom binary :clas
+00020270: 733a 6054 7265 6560 2077 6974 6820 3a6d  s:`Tree` with :m
+00020280: 6174 683a 606e 6020 3d20 6060 6e75 6d5f  ath:`n` = ``num_
+00020290: 6c65 6176 6573 6060 0a20 2020 2020 2020  leaves``.       
+000202a0: 206c 6561 7665 7320 7769 7468 2061 6e20   leaves with an 
+000202b0: 6571 7561 6c20 7072 6f62 6162 696c 6974  equal probabilit
+000202c0: 7920 6f66 2072 6574 7572 6e69 6e67 2061  y of returning a
+000202d0: 6e79 2074 6f70 6f6c 6f67 7920 616e 640a  ny topology and.
+000202e0: 2020 2020 2020 2020 6c65 6166 206c 6162          leaf lab
+000202f0: 656c 2070 6572 6d75 7461 7469 6f6e 2061  el permutation a
+00020300: 6d6f 6e67 2074 6865 203a 6d61 7468 3a60  mong the :math:`
+00020310: 2832 6e20 2d20 3329 2120 2f20 2832 5e7b  (2n - 3)! / (2^{
+00020320: 6e20 2d20 327d 2028 6e20 2d20 3229 2129  n - 2} (n - 2)!)
+00020330: 600a 2020 2020 2020 2020 6c65 6166 2d6c  `.        leaf-l
+00020340: 6162 656c 6c65 6420 6269 6e61 7279 2074  abelled binary t
+00020350: 7265 6573 2e0a 0a20 2020 2020 2020 2054  rees...        T
+00020360: 6865 206c 6561 6620 6e6f 6465 7320 6172  he leaf nodes ar
+00020370: 6520 6d61 726b 6564 2061 7320 7361 6d70  e marked as samp
+00020380: 6c65 732c 206c 6162 656c 6c65 6420 3020  les, labelled 0 
+00020390: 746f 206e 2c20 616e 6420 706c 6163 6564  to n, and placed
+000203a0: 2061 740a 2020 2020 2020 2020 7469 6d65   at.        time
+000203b0: 2030 2e20 496e 7465 726e 616c 206e 6f64   0. Internal nod
+000203c0: 6520 4944 7320 6172 6520 6173 7369 676e  e IDs are assign
+000203d0: 6564 2073 6571 7565 6e74 6961 6c6c 7920  ed sequentially 
+000203e0: 6672 6f6d 206e 2061 7320 7765 2061 7363  from n as we asc
+000203f0: 656e 640a 2020 2020 2020 2020 7468 6520  end.        the 
+00020400: 7472 6565 2c20 616e 6420 7468 6520 7469  tree, and the ti
+00020410: 6d65 206f 6620 616e 2069 6e74 6572 6e61  me of an interna
+00020420: 6c20 6e6f 6465 2069 7320 7468 6520 6d61  l node is the ma
+00020430: 7869 6d75 6d20 7469 6d65 206f 6620 6974  ximum time of it
+00020440: 730a 2020 2020 2020 2020 6368 696c 6472  s.        childr
+00020450: 656e 2070 6c75 7320 7468 6520 7370 6563  en plus the spec
+00020460: 6966 6965 6420 6060 6272 616e 6368 5f6c  ified ``branch_l
+00020470: 656e 6774 6860 602e 0a0a 2020 2020 2020  ength``...      
+00020480: 2020 2e2e 206e 6f74 653a 3a0a 2020 2020    .. note::.    
+00020490: 2020 2020 2020 2020 5468 6520 7265 7475          The retu
+000204a0: 726e 6564 2074 7265 6520 6861 7320 6e6f  rned tree has no
+000204b0: 7420 6265 656e 2063 7265 6174 6564 2075  t been created u
+000204c0: 6e64 6572 2061 6e79 2065 7870 6c69 6369  nder any explici
+000204d0: 7420 6d6f 6465 6c20 6f66 0a20 2020 2020  t model of.     
+000204e0: 2020 2020 2020 2065 766f 6c75 7469 6f6e         evolution
+000204f0: 2e20 496e 206f 7264 6572 2074 6f20 7369  . In order to si
+00020500: 6d75 6c61 7465 2073 7563 6820 7472 6565  mulate such tree
+00020510: 732c 2061 6464 6974 696f 6e61 6c20 736f  s, additional so
+00020520: 6674 7761 7265 0a20 2020 2020 2020 2020  ftware.         
+00020530: 2020 2073 7563 6820 6173 2060 6d73 7072     such as `mspr
+00020540: 696d 6520 3c68 7474 7073 3a2f 2f67 6974  ime <https://git
+00020550: 6875 622e 636f 6d2f 7473 6b69 742d 6465  hub.com/tskit-de
+00020560: 762f 6d73 7072 696d 653e 6060 2069 7320  v/msprime>`` is 
+00020570: 7265 7175 6972 6564 2e0a 0a20 2020 2020  required...     
+00020580: 2020 203a 7061 7261 6d20 696e 7420 6e75     :param int nu
+00020590: 6d5f 6c65 6176 6573 3a20 5468 6520 6e75  m_leaves: The nu
+000205a0: 6d62 6572 206f 6620 6c65 6166 206e 6f64  mber of leaf nod
+000205b0: 6573 2069 6e20 7468 6520 7265 7475 726e  es in the return
+000205c0: 6564 2074 7265 6520 286d 7573 740a 2020  ed tree (must.  
+000205d0: 2020 2020 2020 2020 2020 6265 2032 206f            be 2 o
+000205e0: 7220 6772 6561 7465 7229 2e0a 2020 2020  r greater)..    
+000205f0: 2020 2020 3a70 6172 616d 2066 6c6f 6174      :param float
+00020600: 2073 7061 6e3a 2054 6865 2073 7061 6e20   span: The span 
+00020610: 6f66 2074 6865 2074 7265 652c 2061 6e64  of the tree, and
+00020620: 2074 6865 7265 666f 7265 2074 6865 0a20   therefore the. 
+00020630: 2020 2020 2020 2020 2020 203a 6174 7472             :attr
+00020640: 3a60 7e54 7265 6553 6571 7565 6e63 652e  :`~TreeSequence.
+00020650: 7365 7175 656e 6365 5f6c 656e 6774 6860  sequence_length`
+00020660: 206f 6620 7468 6520 3a61 7474 723a 602e   of the :attr:`.
+00020670: 7472 6565 5f73 6571 7565 6e63 6560 0a20  tree_sequence`. 
+00020680: 2020 2020 2020 2020 2020 2070 726f 7065             prope
+00020690: 7274 7920 6f66 2074 6865 2072 6574 7572  rty of the retur
+000206a0: 6e65 6420 3a63 6c61 7373 3a60 5472 6565  ned :class:`Tree
+000206b0: 602e 0a20 2020 2020 2020 203a 7061 7261  `..        :para
+000206c0: 6d20 666c 6f61 7420 6272 616e 6368 5f6c  m float branch_l
+000206d0: 656e 6774 683a 2054 6865 206d 696e 696d  ength: The minim
+000206e0: 756d 2074 696d 6520 6265 7477 6565 6e20  um time between 
+000206f0: 7061 7265 6e74 2061 6e64 2063 6869 6c64  parent and child
+00020700: 206e 6f64 6573 2e0a 2020 2020 2020 2020   nodes..        
+00020710: 3a70 6172 616d 2069 6e74 2072 616e 646f  :param int rando
+00020720: 6d5f 7365 6564 3a20 5468 6520 7261 6e64  m_seed: The rand
+00020730: 6f6d 2073 6565 642e 2049 6620 7468 6973  om seed. If this
+00020740: 2069 7320 4e6f 6e65 2c20 6120 7261 6e64   is None, a rand
+00020750: 6f6d 2073 6565 6420 7769 6c6c 0a20 2020  om seed will.   
+00020760: 2020 2020 2020 2020 2062 6520 6175 746f           be auto
+00020770: 6d61 7469 6361 6c6c 7920 6765 6e65 7261  matically genera
+00020780: 7465 642e 2056 616c 6964 2072 616e 646f  ted. Valid rando
+00020790: 6d20 7365 6564 7320 6d75 7374 2062 6520  m seeds must be 
+000207a0: 6265 7477 6565 6e20 3120 616e 640a 2020  between 1 and.  
+000207b0: 2020 2020 2020 2020 2020 3a6d 6174 683a            :math:
+000207c0: 6032 5e33 3220 e288 9220 3160 2e0a 2020  `2^32 ... 1`..  
+000207d0: 2020 2020 2020 3a70 6172 616d 2062 6f6f        :param boo
+000207e0: 6c20 7265 636f 7264 5f70 726f 7665 6e61  l record_provena
+000207f0: 6e63 653a 2049 6620 5472 7565 2c20 6164  nce: If True, ad
+00020800: 6420 6465 7461 696c 7320 6f66 2074 6869  d details of thi
+00020810: 7320 6f70 6572 6174 696f 6e20 746f 2074  s operation to t
+00020820: 6865 0a20 2020 2020 2020 2020 2020 2070  he.            p
+00020830: 726f 7665 6e61 6e63 6520 696e 666f 726d  rovenance inform
+00020840: 6174 696f 6e20 6f66 2074 6865 2072 6574  ation of the ret
+00020850: 7572 6e65 6420 7472 6565 2073 6571 7565  urned tree seque
+00020860: 6e63 652e 2028 4465 6661 756c 743a 2054  nce. (Default: T
+00020870: 7275 6529 2e0a 2020 2020 2020 2020 3a70  rue)..        :p
+00020880: 6172 616d 205c 5c2a 2a6b 7761 7267 733a  aram \\**kwargs:
+00020890: 2046 7572 7468 6572 2061 7267 756d 656e   Further argumen
+000208a0: 7473 2075 7365 6420 6173 2070 6172 616d  ts used as param
+000208b0: 6574 6572 7320 7768 656e 2063 6f6e 7374  eters when const
+000208c0: 7275 6374 696e 6720 7468 650a 2020 2020  ructing the.    
+000208d0: 2020 2020 2020 2020 7265 7475 726e 6564          returned
+000208e0: 203a 636c 6173 733a 6054 7265 6560 2e20   :class:`Tree`. 
+000208f0: 466f 7220 6578 616d 706c 650a 2020 2020  For example.    
+00020900: 2020 2020 2020 2020 6060 7473 6b69 742e          ``tskit.
+00020910: 5472 6565 2e67 656e 6572 6174 655f 636f  Tree.generate_co
+00020920: 6d62 2873 616d 706c 655f 6c69 7374 733d  mb(sample_lists=
+00020930: 5472 7565 2960 6020 7769 6c6c 0a20 2020  True)`` will.   
+00020940: 2020 2020 2020 2020 2072 6574 7572 6e20           return 
+00020950: 6120 3a63 6c61 7373 3a60 5472 6565 6020  a :class:`Tree` 
+00020960: 6372 6561 7465 6420 7769 7468 2060 6073  created with ``s
+00020970: 616d 706c 655f 6c69 7374 733d 5472 7565  ample_lists=True
+00020980: 6060 2e0a 2020 2020 2020 2020 3a72 6574  ``..        :ret
+00020990: 7572 6e3a 2041 2072 616e 646f 6d20 6269  urn: A random bi
+000209a0: 6e61 7279 2074 7265 652e 2049 7473 2063  nary tree. Its c
+000209b0: 6f72 7265 7370 6f6e 6469 6e67 203a 636c  orresponding :cl
+000209c0: 6173 733a 6054 7265 6553 6571 7565 6e63  ass:`TreeSequenc
+000209d0: 6560 2069 730a 2020 2020 2020 2020 2020  e` is.          
+000209e0: 2020 6176 6169 6c61 626c 6520 7669 6120    available via 
+000209f0: 7468 6520 3a61 7474 723a 602e 7472 6565  the :attr:`.tree
+00020a00: 5f73 6571 7565 6e63 6560 2061 7474 7269  _sequence` attri
+00020a10: 6275 7465 2e0a 2020 2020 2020 2020 3a72  bute..        :r
+00020a20: 7479 7065 3a20 5472 6565 0a20 2020 2020  type: Tree.     
+00020a30: 2020 2022 2222 0a20 2020 2020 2020 2072     """.        r
+00020a40: 6574 7572 6e20 636f 6d62 696e 6174 6f72  eturn combinator
+00020a50: 6963 732e 6765 6e65 7261 7465 5f72 616e  ics.generate_ran
+00020a60: 646f 6d5f 6269 6e61 7279 280a 2020 2020  dom_binary(.    
+00020a70: 2020 2020 2020 2020 6e75 6d5f 6c65 6176          num_leav
+00020a80: 6573 2c0a 2020 2020 2020 2020 2020 2020  es,.            
+00020a90: 7370 616e 3d73 7061 6e2c 0a20 2020 2020  span=span,.     
+00020aa0: 2020 2020 2020 2062 7261 6e63 685f 6c65         branch_le
+00020ab0: 6e67 7468 3d62 7261 6e63 685f 6c65 6e67  ngth=branch_leng
+00020ac0: 7468 2c0a 2020 2020 2020 2020 2020 2020  th,.            
+00020ad0: 7261 6e64 6f6d 5f73 6565 643d 7261 6e64  random_seed=rand
+00020ae0: 6f6d 5f73 6565 642c 0a20 2020 2020 2020  om_seed,.       
+00020af0: 2020 2020 2072 6563 6f72 645f 7072 6f76       record_prov
+00020b00: 656e 616e 6365 3d72 6563 6f72 645f 7072  enance=record_pr
+00020b10: 6f76 656e 616e 6365 2c0a 2020 2020 2020  ovenance,.      
+00020b20: 2020 2020 2020 2a2a 6b77 6172 6773 2c0a        **kwargs,.
+00020b30: 2020 2020 2020 2020 290a 0a0a 6465 6620          )...def 
+00020b40: 6c6f 6164 2866 696c 652c 202a 2c20 736b  load(file, *, sk
+00020b50: 6970 5f74 6162 6c65 733d 4661 6c73 652c  ip_tables=False,
+00020b60: 2073 6b69 705f 7265 6665 7265 6e63 655f   skip_reference_
+00020b70: 7365 7175 656e 6365 3d46 616c 7365 293a  sequence=False):
+00020b80: 0a20 2020 2022 2222 0a20 2020 2052 6574  .    """.    Ret
+00020b90: 7572 6e20 6120 3a63 6c61 7373 3a60 5472  urn a :class:`Tr
+00020ba0: 6565 5365 7175 656e 6365 6020 696e 7374  eeSequence` inst
+00020bb0: 616e 6365 206c 6f61 6465 6420 6672 6f6d  ance loaded from
+00020bc0: 2074 6865 2073 7065 6369 6669 6564 2066   the specified f
+00020bd0: 696c 6520 6f62 6a65 6374 206f 720a 2020  ile object or.  
+00020be0: 2020 7061 7468 2e20 5468 6520 6669 6c65    path. The file
+00020bf0: 206d 7573 7420 6265 2069 6e20 7468 650a   must be in the.
+00020c00: 2020 2020 3a72 6566 3a60 7472 6565 2073      :ref:`tree s
+00020c10: 6571 7565 6e63 6520 6669 6c65 2066 6f72  equence file for
+00020c20: 6d61 7420 3c73 6563 5f74 7265 655f 7365  mat <sec_tree_se
+00020c30: 7175 656e 6365 5f66 696c 655f 666f 726d  quence_file_form
+00020c40: 6174 3e60 0a20 2020 2070 726f 6475 6365  at>`.    produce
+00020c50: 6420 6279 2074 6865 203a 6d65 7468 3a60  d by the :meth:`
+00020c60: 5472 6565 5365 7175 656e 6365 2e64 756d  TreeSequence.dum
+00020c70: 7060 206d 6574 686f 642e 0a0a 2020 2020  p` method...    
+00020c80: 2e2e 2077 6172 6e69 6e67 3a3a 2057 6974  .. warning:: Wit
+00020c90: 6820 616e 7920 6f66 2074 6865 2060 6073  h any of the ``s
+00020ca0: 6b69 705f 7461 626c 6573 6060 206f 7220  kip_tables`` or 
+00020cb0: 6060 736b 6970 5f72 6566 6572 656e 6365  ``skip_reference
+00020cc0: 5f73 6571 7565 6e63 6560 600a 2020 2020  _sequence``.    
+00020cd0: 2020 2020 6f70 7469 6f6e 7320 7365 742c      options set,
+00020ce0: 2069 7420 6973 206e 6f74 2070 6f73 7369   it is not possi
+00020cf0: 626c 6520 746f 206c 6f61 6420 6461 7461  ble to load data
+00020d00: 2066 726f 6d20 6120 6e6f 6e2d 7365 656b   from a non-seek
+00020d10: 6162 6c65 2073 7472 6561 6d0a 2020 2020  able stream.    
+00020d20: 2020 2020 2865 2e67 2e20 6120 736f 636b      (e.g. a sock
+00020d30: 6574 206f 7220 5354 4449 4e29 206f 6620  et or STDIN) of 
+00020d40: 6d75 6c74 6970 6c65 2074 7265 6520 7365  multiple tree se
+00020d50: 7175 656e 6365 7320 7573 696e 6720 636f  quences using co
+00020d60: 6e73 6563 7574 6976 650a 2020 2020 2020  nsecutive.      
+00020d70: 2020 6361 6c6c 7320 746f 203a 6d65 7468    calls to :meth
+00020d80: 3a60 7473 6b69 742e 6c6f 6164 602e 0a0a  :`tskit.load`...
+00020d90: 2020 2020 3a70 6172 616d 2073 7472 2066      :param str f
+00020da0: 696c 653a 2054 6865 2066 696c 6520 6f62  ile: The file ob
+00020db0: 6a65 6374 206f 7220 7061 7468 206f 6620  ject or path of 
+00020dc0: 7468 6520 6060 2e74 7265 6573 6060 2066  the ``.trees`` f
+00020dd0: 696c 6520 636f 6e74 6169 6e69 6e67 2074  ile containing t
+00020de0: 6865 0a20 2020 2020 2020 2074 7265 6520  he.        tree 
+00020df0: 7365 7175 656e 6365 2077 6520 7769 7368  sequence we wish
+00020e00: 2074 6f20 6c6f 6164 2e0a 2020 2020 3a70   to load..    :p
+00020e10: 6172 616d 2062 6f6f 6c20 736b 6970 5f74  aram bool skip_t
+00020e20: 6162 6c65 733a 2049 6620 5472 7565 2c20  ables: If True, 
+00020e30: 6e6f 2074 6162 6c65 7320 6172 6520 7265  no tables are re
+00020e40: 6164 2066 726f 6d20 7468 6520 6060 2e74  ad from the ``.t
+00020e50: 7265 6573 6060 0a20 2020 2020 2020 2066  rees``.        f
+00020e60: 696c 6520 616e 6420 6f6e 6c79 2074 6865  ile and only the
+00020e70: 2074 6f70 2d6c 6576 656c 2069 6e66 6f72   top-level infor
+00020e80: 6d61 7469 6f6e 2069 7320 706f 7075 6c61  mation is popula
+00020e90: 7465 6420 696e 2074 6865 2074 7265 650a  ted in the tree.
+00020ea0: 2020 2020 2020 2020 7365 7175 656e 6365          sequence
+00020eb0: 206f 626a 6563 742e 0a20 2020 203a 7061   object..    :pa
+00020ec0: 7261 6d20 626f 6f6c 2073 6b69 705f 7265  ram bool skip_re
+00020ed0: 6665 7265 6e63 655f 7365 7175 656e 6365  ference_sequence
+00020ee0: 3a20 4966 2054 7275 652c 2074 6865 2074  : If True, the t
+00020ef0: 7265 6520 7365 7175 656e 6365 2069 7320  ree sequence is 
+00020f00: 7265 6164 0a20 2020 2020 2020 2077 6974  read.        wit
+00020f10: 686f 7574 206c 6f61 6469 6e67 2069 7473  hout loading its
+00020f20: 2072 6566 6572 656e 6365 2073 6571 7565   reference seque
+00020f30: 6e63 652e 0a20 2020 203a 7265 7475 726e  nce..    :return
+00020f40: 3a20 5468 6520 7472 6565 2073 6571 7565  : The tree seque
+00020f50: 6e63 6520 6f62 6a65 6374 2063 6f6e 7461  nce object conta
+00020f60: 696e 696e 6720 7468 6520 696e 666f 726d  ining the inform
+00020f70: 6174 696f 6e0a 2020 2020 2020 2020 7374  ation.        st
+00020f80: 6f72 6564 2069 6e20 7468 6520 7370 6563  ored in the spec
+00020f90: 6966 6965 6420 6669 6c65 2070 6174 682e  ified file path.
+00020fa0: 0a20 2020 203a 7274 7970 653a 203a 636c  .    :rtype: :cl
+00020fb0: 6173 733a 6074 736b 6974 2e54 7265 6553  ass:`tskit.TreeS
+00020fc0: 6571 7565 6e63 6560 0a20 2020 2022 2222  equence`.    """
+00020fd0: 0a20 2020 2072 6574 7572 6e20 5472 6565  .    return Tree
+00020fe0: 5365 7175 656e 6365 2e6c 6f61 6428 0a20  Sequence.load(. 
+00020ff0: 2020 2020 2020 2066 696c 652c 2073 6b69         file, ski
+00021000: 705f 7461 626c 6573 3d73 6b69 705f 7461  p_tables=skip_ta
+00021010: 626c 6573 2c20 736b 6970 5f72 6566 6572  bles, skip_refer
+00021020: 656e 6365 5f73 6571 7565 6e63 653d 736b  ence_sequence=sk
+00021030: 6970 5f72 6566 6572 656e 6365 5f73 6571  ip_reference_seq
+00021040: 7565 6e63 650a 2020 2020 290a 0a0a 6465  uence.    )...de
+00021050: 6620 7061 7273 655f 696e 6469 7669 6475  f parse_individu
+00021060: 616c 7328 0a20 2020 2073 6f75 7263 652c  als(.    source,
+00021070: 2073 7472 6963 743d 5472 7565 2c20 656e   strict=True, en
+00021080: 636f 6469 6e67 3d22 7574 6638 222c 2062  coding="utf8", b
+00021090: 6173 6536 345f 6d65 7461 6461 7461 3d54  ase64_metadata=T
+000210a0: 7275 652c 2074 6162 6c65 3d4e 6f6e 650a  rue, table=None.
+000210b0: 293a 0a20 2020 2022 2222 0a20 2020 2050  ):.    """.    P
+000210c0: 6172 7365 2074 6865 2073 7065 6369 6669  arse the specifi
+000210d0: 6564 2066 696c 652d 6c69 6b65 206f 626a  ed file-like obj
+000210e0: 6563 7420 636f 6e74 6169 6e69 6e67 2061  ect containing a
+000210f0: 2077 6869 7465 7370 6163 6520 6465 6c69   whitespace deli
+00021100: 6d69 7465 640a 2020 2020 6465 7363 7269  mited.    descri
+00021110: 7074 696f 6e20 6f66 2061 6e20 696e 6469  ption of an indi
+00021120: 7669 6475 616c 2074 6162 6c65 2061 6e64  vidual table and
+00021130: 2072 6574 7572 6e73 2074 6865 2063 6f72   returns the cor
+00021140: 7265 7370 6f6e 6469 6e67 0a20 2020 203a  responding.    :
+00021150: 636c 6173 733a 6049 6e64 6976 6964 7561  class:`Individua
+00021160: 6c54 6162 6c65 6020 696e 7374 616e 6365  lTable` instance
+00021170: 2e20 5365 6520 7468 6520 3a72 6566 3a60  . See the :ref:`
+00021180: 696e 6469 7669 6475 616c 2074 6578 7420  individual text 
+00021190: 666f 726d 6174 0a20 2020 203c 7365 635f  format.    <sec_
+000211a0: 696e 6469 7669 6475 616c 5f74 6578 745f  individual_text_
+000211b0: 666f 726d 6174 3e60 2073 6563 7469 6f6e  format>` section
+000211c0: 2066 6f72 2074 6865 2064 6574 6169 6c73   for the details
+000211d0: 206f 6620 7468 6520 7265 7175 6972 6564   of the required
+000211e0: 0a20 2020 2066 6f72 6d61 7420 616e 6420  .    format and 
+000211f0: 7468 6520 3a72 6566 3a60 696e 6469 7669  the :ref:`indivi
+00021200: 6475 616c 2074 6162 6c65 2064 6566 696e  dual table defin
+00021210: 6974 696f 6e0a 2020 2020 3c73 6563 5f69  ition.    <sec_i
+00021220: 6e64 6976 6964 7561 6c5f 7461 626c 655f  ndividual_table_
+00021230: 6465 6669 6e69 7469 6f6e 3e60 2073 6563  definition>` sec
+00021240: 7469 6f6e 2066 6f72 2074 6865 2072 6571  tion for the req
+00021250: 7569 7265 6420 7072 6f70 6572 7469 6573  uired properties
+00021260: 206f 660a 2020 2020 7468 6520 636f 6e74   of.    the cont
+00021270: 656e 7473 2e0a 0a20 2020 2053 6565 203a  ents...    See :
+00021280: 6675 6e63 3a60 7473 6b69 742e 6c6f 6164  func:`tskit.load
+00021290: 5f74 6578 7460 2066 6f72 2061 2064 6574  _text` for a det
+000212a0: 6169 6c65 6420 6578 706c 616e 6174 696f  ailed explanatio
+000212b0: 6e20 6f66 2074 6865 2060 6073 7472 6963  n of the ``stric
+000212c0: 7460 600a 2020 2020 7061 7261 6d65 7465  t``.    paramete
+000212d0: 722e 0a0a 2020 2020 3a70 6172 616d 2069  r...    :param i
+000212e0: 6f2e 5465 7874 494f 4261 7365 2073 6f75  o.TextIOBase sou
+000212f0: 7263 653a 2054 6865 2066 696c 652d 6c69  rce: The file-li
+00021300: 6b65 206f 626a 6563 7420 636f 6e74 6169  ke object contai
+00021310: 6e69 6e67 2074 6865 2074 6578 742e 0a20  ning the text.. 
+00021320: 2020 203a 7061 7261 6d20 626f 6f6c 2073     :param bool s
+00021330: 7472 6963 743a 2049 6620 5472 7565 2c20  trict: If True, 
+00021340: 7265 7175 6972 6520 7374 7269 6374 2074  require strict t
+00021350: 6162 2064 656c 696d 6974 696e 6720 2864  ab delimiting (d
+00021360: 6566 6175 6c74 292e 2049 660a 2020 2020  efault). If.    
+00021370: 2020 2020 4661 6c73 652c 2061 2072 656c      False, a rel
+00021380: 6178 6564 2077 6869 7465 7370 6163 6520  axed whitespace 
+00021390: 7370 6c69 7474 696e 6720 616c 676f 7269  splitting algori
+000213a0: 7468 6d20 6973 2075 7365 642e 0a20 2020  thm is used..   
+000213b0: 203a 7061 7261 6d20 7374 7220 656e 636f   :param str enco
+000213c0: 6469 6e67 3a20 456e 636f 6469 6e67 2075  ding: Encoding u
+000213d0: 7365 6420 666f 7220 7465 7874 2072 6570  sed for text rep
+000213e0: 7265 7365 6e74 6174 696f 6e2e 0a20 2020  resentation..   
+000213f0: 203a 7061 7261 6d20 626f 6f6c 2062 6173   :param bool bas
+00021400: 6536 345f 6d65 7461 6461 7461 3a20 4966  e64_metadata: If
+00021410: 2054 7275 652c 206d 6574 6164 6174 6120   True, metadata 
+00021420: 6973 2065 6e63 6f64 6564 2075 7369 6e67  is encoded using
+00021430: 2042 6173 6536 340a 2020 2020 2020 2020   Base64.        
+00021440: 656e 636f 6469 6e67 3b20 6f74 6865 7277  encoding; otherw
+00021450: 6973 652c 2061 7320 706c 6169 6e20 7465  ise, as plain te
+00021460: 7874 2e0a 2020 2020 3a70 6172 616d 2049  xt..    :param I
+00021470: 6e64 6976 6964 7561 6c54 6162 6c65 2074  ndividualTable t
+00021480: 6162 6c65 3a20 4966 2073 7065 6369 6669  able: If specifi
+00021490: 6564 2077 7269 7465 2069 6e74 6f20 7468  ed write into th
+000214a0: 6973 2074 6162 6c65 2e20 4966 206e 6f74  is table. If not
+000214b0: 2c0a 2020 2020 2020 2020 6372 6561 7465  ,.        create
+000214c0: 2061 206e 6577 203a 636c 6173 733a 6049   a new :class:`I
+000214d0: 6e64 6976 6964 7561 6c54 6162 6c65 6020  ndividualTable` 
+000214e0: 696e 7374 616e 6365 2e0a 2020 2020 2222  instance..    ""
+000214f0: 220a 2020 2020 7365 7020 3d20 4e6f 6e65  ".    sep = None
+00021500: 0a20 2020 2069 6620 7374 7269 6374 3a0a  .    if strict:.
+00021510: 2020 2020 2020 2020 7365 7020 3d20 225c          sep = "\
+00021520: 7422 0a20 2020 2069 6620 7461 626c 6520  t".    if table 
+00021530: 6973 204e 6f6e 653a 0a20 2020 2020 2020  is None:.       
+00021540: 2074 6162 6c65 203d 2074 6162 6c65 732e   table = tables.
+00021550: 496e 6469 7669 6475 616c 5461 626c 6528  IndividualTable(
+00021560: 290a 2020 2020 2320 5265 6164 2074 6865  ).    # Read the
+00021570: 2068 6561 6465 7220 616e 6420 6669 6e64   header and find
+00021580: 2074 6865 2069 6e64 6578 6573 206f 6620   the indexes of 
+00021590: 7468 6520 7265 7175 6972 6564 2066 6965  the required fie
+000215a0: 6c64 732e 0a20 2020 2068 6561 6465 7220  lds..    header 
+000215b0: 3d20 736f 7572 6365 2e72 6561 646c 696e  = source.readlin
+000215c0: 6528 292e 7273 7472 6970 2822 5c6e 2229  e().rstrip("\n")
+000215d0: 2e73 706c 6974 2873 6570 290a 2020 2020  .split(sep).    
+000215e0: 666c 6167 735f 696e 6465 7820 3d20 6865  flags_index = he
+000215f0: 6164 6572 2e69 6e64 6578 2822 666c 6167  ader.index("flag
+00021600: 7322 290a 2020 2020 6c6f 6361 7469 6f6e  s").    location
+00021610: 5f69 6e64 6578 203d 204e 6f6e 650a 2020  _index = None.  
+00021620: 2020 7061 7265 6e74 735f 696e 6465 7820    parents_index 
+00021630: 3d20 4e6f 6e65 0a20 2020 206d 6574 6164  = None.    metad
+00021640: 6174 615f 696e 6465 7820 3d20 4e6f 6e65  ata_index = None
+00021650: 0a20 2020 2074 7279 3a0a 2020 2020 2020  .    try:.      
+00021660: 2020 6c6f 6361 7469 6f6e 5f69 6e64 6578    location_index
+00021670: 203d 2068 6561 6465 722e 696e 6465 7828   = header.index(
+00021680: 226c 6f63 6174 696f 6e22 290a 2020 2020  "location").    
+00021690: 6578 6365 7074 2056 616c 7565 4572 726f  except ValueErro
+000216a0: 723a 0a20 2020 2020 2020 2070 6173 730a  r:.        pass.
+000216b0: 2020 2020 7472 793a 0a20 2020 2020 2020      try:.       
+000216c0: 2070 6172 656e 7473 5f69 6e64 6578 203d   parents_index =
+000216d0: 2068 6561 6465 722e 696e 6465 7828 2270   header.index("p
+000216e0: 6172 656e 7473 2229 0a20 2020 2065 7863  arents").    exc
+000216f0: 6570 7420 5661 6c75 6545 7272 6f72 3a0a  ept ValueError:.
+00021700: 2020 2020 2020 2020 7061 7373 0a20 2020          pass.   
+00021710: 2074 7279 3a0a 2020 2020 2020 2020 6d65   try:.        me
+00021720: 7461 6461 7461 5f69 6e64 6578 203d 2068  tadata_index = h
+00021730: 6561 6465 722e 696e 6465 7828 226d 6574  eader.index("met
+00021740: 6164 6174 6122 290a 2020 2020 6578 6365  adata").    exce
+00021750: 7074 2056 616c 7565 4572 726f 723a 0a20  pt ValueError:. 
+00021760: 2020 2020 2020 2070 6173 730a 2020 2020         pass.    
+00021770: 666f 7220 6c69 6e65 2069 6e20 736f 7572  for line in sour
+00021780: 6365 3a0a 2020 2020 2020 2020 746f 6b65  ce:.        toke
+00021790: 6e73 203d 206c 696e 652e 7273 7472 6970  ns = line.rstrip
+000217a0: 2822 5c6e 2229 2e73 706c 6974 2873 6570  ("\n").split(sep
+000217b0: 290a 2020 2020 2020 2020 6966 206c 656e  ).        if len
+000217c0: 2874 6f6b 656e 7329 203e 3d20 313a 0a20  (tokens) >= 1:. 
+000217d0: 2020 2020 2020 2020 2020 2066 6c61 6773             flags
+000217e0: 203d 2069 6e74 2874 6f6b 656e 735b 666c   = int(tokens[fl
+000217f0: 6167 735f 696e 6465 785d 290a 2020 2020  ags_index]).    
+00021800: 2020 2020 2020 2020 6c6f 6361 7469 6f6e          location
+00021810: 203d 2028 290a 2020 2020 2020 2020 2020   = ().          
+00021820: 2020 6966 206c 6f63 6174 696f 6e5f 696e    if location_in
+00021830: 6465 7820 6973 206e 6f74 204e 6f6e 653a  dex is not None:
+00021840: 0a20 2020 2020 2020 2020 2020 2020 2020  .               
+00021850: 206c 6f63 6174 696f 6e5f 7374 7269 6e67   location_string
+00021860: 203d 2074 6f6b 656e 735b 6c6f 6361 7469   = tokens[locati
+00021870: 6f6e 5f69 6e64 6578 5d0a 2020 2020 2020  on_index].      
+00021880: 2020 2020 2020 2020 2020 6966 206c 656e            if len
+00021890: 286c 6f63 6174 696f 6e5f 7374 7269 6e67  (location_string
+000218a0: 2920 3e20 303a 0a20 2020 2020 2020 2020  ) > 0:.         
+000218b0: 2020 2020 2020 2020 2020 206c 6f63 6174             locat
+000218c0: 696f 6e20 3d20 7475 706c 6528 6d61 7028  ion = tuple(map(
+000218d0: 666c 6f61 742c 206c 6f63 6174 696f 6e5f  float, location_
+000218e0: 7374 7269 6e67 2e73 706c 6974 2822 2c22  string.split(","
+000218f0: 2929 290a 2020 2020 2020 2020 2020 2020  ))).            
+00021900: 7061 7265 6e74 7320 3d20 2829 0a20 2020  parents = ().   
+00021910: 2020 2020 2020 2020 2069 6620 7061 7265           if pare
+00021920: 6e74 735f 696e 6465 7820 6973 206e 6f74  nts_index is not
+00021930: 204e 6f6e 653a 0a20 2020 2020 2020 2020   None:.         
+00021940: 2020 2020 2020 2070 6172 656e 7473 5f73         parents_s
+00021950: 7472 696e 6720 3d20 746f 6b65 6e73 5b70  tring = tokens[p
+00021960: 6172 656e 7473 5f69 6e64 6578 5d0a 2020  arents_index].  
+00021970: 2020 2020 2020 2020 2020 2020 2020 6966                if
+00021980: 206c 656e 2870 6172 656e 7473 5f73 7472   len(parents_str
+00021990: 696e 6729 203e 2030 3a0a 2020 2020 2020  ing) > 0:.      
+000219a0: 2020 2020 2020 2020 2020 2020 2020 7061                pa
+000219b0: 7265 6e74 7320 3d20 7475 706c 6528 6d61  rents = tuple(ma
+000219c0: 7028 696e 742c 2070 6172 656e 7473 5f73  p(int, parents_s
+000219d0: 7472 696e 672e 7370 6c69 7428 222c 2229  tring.split(",")
+000219e0: 2929 0a20 2020 2020 2020 2020 2020 206d  )).            m
+000219f0: 6574 6164 6174 6120 3d20 6222 220a 2020  etadata = b"".  
+00021a00: 2020 2020 2020 2020 2020 6966 206d 6574            if met
+00021a10: 6164 6174 615f 696e 6465 7820 6973 206e  adata_index is n
+00021a20: 6f74 204e 6f6e 6520 616e 6420 6d65 7461  ot None and meta
+00021a30: 6461 7461 5f69 6e64 6578 203c 206c 656e  data_index < len
+00021a40: 2874 6f6b 656e 7329 3a0a 2020 2020 2020  (tokens):.      
+00021a50: 2020 2020 2020 2020 2020 6d65 7461 6461            metada
+00021a60: 7461 203d 2074 6f6b 656e 735b 6d65 7461  ta = tokens[meta
+00021a70: 6461 7461 5f69 6e64 6578 5d2e 656e 636f  data_index].enco
+00021a80: 6465 2865 6e63 6f64 696e 6729 0a20 2020  de(encoding).   
+00021a90: 2020 2020 2020 2020 2020 2020 2069 6620               if 
+00021aa0: 6261 7365 3634 5f6d 6574 6164 6174 613a  base64_metadata:
+00021ab0: 0a20 2020 2020 2020 2020 2020 2020 2020  .               
+00021ac0: 2020 2020 206d 6574 6164 6174 6120 3d20       metadata = 
+00021ad0: 6261 7365 3634 2e62 3634 6465 636f 6465  base64.b64decode
+00021ae0: 286d 6574 6164 6174 6129 0a20 2020 2020  (metadata).     
+00021af0: 2020 2020 2020 2074 6162 6c65 2e61 6464         table.add
+00021b00: 5f72 6f77 280a 2020 2020 2020 2020 2020  _row(.          
+00021b10: 2020 2020 2020 666c 6167 733d 666c 6167        flags=flag
+00021b20: 732c 206c 6f63 6174 696f 6e3d 6c6f 6361  s, location=loca
+00021b30: 7469 6f6e 2c20 7061 7265 6e74 733d 7061  tion, parents=pa
+00021b40: 7265 6e74 732c 206d 6574 6164 6174 613d  rents, metadata=
+00021b50: 6d65 7461 6461 7461 0a20 2020 2020 2020  metadata.       
+00021b60: 2020 2020 2029 0a20 2020 2072 6574 7572       ).    retur
+00021b70: 6e20 7461 626c 650a 0a0a 6465 6620 7061  n table...def pa
+00021b80: 7273 655f 6e6f 6465 7328 736f 7572 6365  rse_nodes(source
+00021b90: 2c20 7374 7269 6374 3d54 7275 652c 2065  , strict=True, e
+00021ba0: 6e63 6f64 696e 673d 2275 7466 3822 2c20  ncoding="utf8", 
+00021bb0: 6261 7365 3634 5f6d 6574 6164 6174 613d  base64_metadata=
+00021bc0: 5472 7565 2c20 7461 626c 653d 4e6f 6e65  True, table=None
+00021bd0: 293a 0a20 2020 2022 2222 0a20 2020 2050  ):.    """.    P
+00021be0: 6172 7365 2074 6865 2073 7065 6369 6669  arse the specifi
+00021bf0: 6564 2066 696c 652d 6c69 6b65 206f 626a  ed file-like obj
+00021c00: 6563 7420 636f 6e74 6169 6e69 6e67 2061  ect containing a
+00021c10: 2077 6869 7465 7370 6163 6520 6465 6c69   whitespace deli
+00021c20: 6d69 7465 640a 2020 2020 6465 7363 7269  mited.    descri
+00021c30: 7074 696f 6e20 6f66 2061 206e 6f64 6520  ption of a node 
+00021c40: 7461 626c 6520 616e 6420 7265 7475 726e  table and return
+00021c50: 7320 7468 6520 636f 7272 6573 706f 6e64  s the correspond
+00021c60: 696e 6720 3a63 6c61 7373 3a60 4e6f 6465  ing :class:`Node
+00021c70: 5461 626c 6560 0a20 2020 2069 6e73 7461  Table`.    insta
+00021c80: 6e63 652e 2053 6565 2074 6865 203a 7265  nce. See the :re
+00021c90: 663a 606e 6f64 6520 7465 7874 2066 6f72  f:`node text for
+00021ca0: 6d61 7420 3c73 6563 5f6e 6f64 655f 7465  mat <sec_node_te
+00021cb0: 7874 5f66 6f72 6d61 743e 6020 7365 6374  xt_format>` sect
+00021cc0: 696f 6e0a 2020 2020 666f 7220 7468 6520  ion.    for the 
+00021cd0: 6465 7461 696c 7320 6f66 2074 6865 2072  details of the r
+00021ce0: 6571 7569 7265 6420 666f 726d 6174 2061  equired format a
+00021cf0: 6e64 2074 6865 0a20 2020 203a 7265 663a  nd the.    :ref:
+00021d00: 606e 6f64 6520 7461 626c 6520 6465 6669  `node table defi
+00021d10: 6e69 7469 6f6e 203c 7365 635f 6e6f 6465  nition <sec_node
+00021d20: 5f74 6162 6c65 5f64 6566 696e 6974 696f  _table_definitio
+00021d30: 6e3e 6020 7365 6374 696f 6e20 666f 7220  n>` section for 
+00021d40: 7468 650a 2020 2020 7265 7175 6972 6564  the.    required
+00021d50: 2070 726f 7065 7274 6965 7320 6f66 2074   properties of t
+00021d60: 6865 2063 6f6e 7465 6e74 732e 0a0a 2020  he contents...  
+00021d70: 2020 5365 6520 3a66 756e 633a 6074 736b    See :func:`tsk
+00021d80: 6974 2e6c 6f61 645f 7465 7874 6020 666f  it.load_text` fo
+00021d90: 7220 6120 6465 7461 696c 6564 2065 7870  r a detailed exp
+00021da0: 6c61 6e61 7469 6f6e 206f 6620 7468 6520  lanation of the 
+00021db0: 6060 7374 7269 6374 6060 0a20 2020 2070  ``strict``.    p
+00021dc0: 6172 616d 6574 6572 2e0a 0a20 2020 203a  arameter...    :
+00021dd0: 7061 7261 6d20 696f 2e54 6578 7449 4f42  param io.TextIOB
+00021de0: 6173 6520 736f 7572 6365 3a20 5468 6520  ase source: The 
+00021df0: 6669 6c65 2d6c 696b 6520 6f62 6a65 6374  file-like object
+00021e00: 2063 6f6e 7461 696e 696e 6720 7468 6520   containing the 
+00021e10: 7465 7874 2e0a 2020 2020 3a70 6172 616d  text..    :param
+00021e20: 2062 6f6f 6c20 7374 7269 6374 3a20 4966   bool strict: If
+00021e30: 2054 7275 652c 2072 6571 7569 7265 2073   True, require s
+00021e40: 7472 6963 7420 7461 6220 6465 6c69 6d69  trict tab delimi
+00021e50: 7469 6e67 2028 6465 6661 756c 7429 2e20  ting (default). 
+00021e60: 4966 0a20 2020 2020 2020 2046 616c 7365  If.        False
+00021e70: 2c20 6120 7265 6c61 7865 6420 7768 6974  , a relaxed whit
+00021e80: 6573 7061 6365 2073 706c 6974 7469 6e67  espace splitting
+00021e90: 2061 6c67 6f72 6974 686d 2069 7320 7573   algorithm is us
+00021ea0: 6564 2e0a 2020 2020 3a70 6172 616d 2073  ed..    :param s
+00021eb0: 7472 2065 6e63 6f64 696e 673a 2045 6e63  tr encoding: Enc
+00021ec0: 6f64 696e 6720 7573 6564 2066 6f72 2074  oding used for t
+00021ed0: 6578 7420 7265 7072 6573 656e 7461 7469  ext representati
+00021ee0: 6f6e 2e0a 2020 2020 3a70 6172 616d 2062  on..    :param b
+00021ef0: 6f6f 6c20 6261 7365 3634 5f6d 6574 6164  ool base64_metad
+00021f00: 6174 613a 2049 6620 5472 7565 2c20 6d65  ata: If True, me
+00021f10: 7461 6461 7461 2069 7320 656e 636f 6465  tadata is encode
+00021f20: 6420 7573 696e 6720 4261 7365 3634 0a20  d using Base64. 
+00021f30: 2020 2020 2020 2065 6e63 6f64 696e 673b         encoding;
+00021f40: 206f 7468 6572 7769 7365 2c20 6173 2070   otherwise, as p
+00021f50: 6c61 696e 2074 6578 742e 0a20 2020 203a  lain text..    :
+00021f60: 7061 7261 6d20 4e6f 6465 5461 626c 6520  param NodeTable 
+00021f70: 7461 626c 653a 2049 6620 7370 6563 6966  table: If specif
+00021f80: 6965 6420 7772 6974 6520 696e 746f 2074  ied write into t
+00021f90: 6869 7320 7461 626c 652e 2049 6620 6e6f  his table. If no
+00021fa0: 742c 0a20 2020 2020 2020 2063 7265 6174  t,.        creat
+00021fb0: 6520 6120 6e65 7720 3a63 6c61 7373 3a60  e a new :class:`
+00021fc0: 4e6f 6465 5461 626c 6560 2069 6e73 7461  NodeTable` insta
+00021fd0: 6e63 652e 0a20 2020 2022 2222 0a20 2020  nce..    """.   
+00021fe0: 2073 6570 203d 204e 6f6e 650a 2020 2020   sep = None.    
+00021ff0: 6966 2073 7472 6963 743a 0a20 2020 2020  if strict:.     
+00022000: 2020 2073 6570 203d 2022 5c74 220a 2020     sep = "\t".  
+00022010: 2020 6966 2074 6162 6c65 2069 7320 4e6f    if table is No
+00022020: 6e65 3a0a 2020 2020 2020 2020 7461 626c  ne:.        tabl
+00022030: 6520 3d20 7461 626c 6573 2e4e 6f64 6554  e = tables.NodeT
+00022040: 6162 6c65 2829 0a20 2020 2023 2052 6561  able().    # Rea
+00022050: 6420 7468 6520 6865 6164 6572 2061 6e64  d the header and
+00022060: 2066 696e 6420 7468 6520 696e 6465 7865   find the indexe
+00022070: 7320 6f66 2074 6865 2072 6571 7569 7265  s of the require
+00022080: 6420 6669 656c 6473 2e0a 2020 2020 6865  d fields..    he
+00022090: 6164 6572 203d 2073 6f75 7263 652e 7265  ader = source.re
+000220a0: 6164 6c69 6e65 2829 2e72 7374 7269 7028  adline().rstrip(
+000220b0: 225c 6e22 292e 7370 6c69 7428 7365 7029  "\n").split(sep)
+000220c0: 0a20 2020 2069 735f 7361 6d70 6c65 5f69  .    is_sample_i
+000220d0: 6e64 6578 203d 2068 6561 6465 722e 696e  ndex = header.in
+000220e0: 6465 7828 2269 735f 7361 6d70 6c65 2229  dex("is_sample")
+000220f0: 0a20 2020 2074 696d 655f 696e 6465 7820  .    time_index 
+00022100: 3d20 6865 6164 6572 2e69 6e64 6578 2822  = header.index("
+00022110: 7469 6d65 2229 0a20 2020 2070 6f70 756c  time").    popul
+00022120: 6174 696f 6e5f 696e 6465 7820 3d20 4e6f  ation_index = No
+00022130: 6e65 0a20 2020 2069 6e64 6976 6964 7561  ne.    individua
+00022140: 6c5f 696e 6465 7820 3d20 4e6f 6e65 0a20  l_index = None. 
+00022150: 2020 206d 6574 6164 6174 615f 696e 6465     metadata_inde
+00022160: 7820 3d20 4e6f 6e65 0a20 2020 2074 7279  x = None.    try
+00022170: 3a0a 2020 2020 2020 2020 706f 7075 6c61  :.        popula
+00022180: 7469 6f6e 5f69 6e64 6578 203d 2068 6561  tion_index = hea
+00022190: 6465 722e 696e 6465 7828 2270 6f70 756c  der.index("popul
+000221a0: 6174 696f 6e22 290a 2020 2020 6578 6365  ation").    exce
+000221b0: 7074 2056 616c 7565 4572 726f 723a 0a20  pt ValueError:. 
+000221c0: 2020 2020 2020 2070 6173 730a 2020 2020         pass.    
+000221d0: 7472 793a 0a20 2020 2020 2020 2069 6e64  try:.        ind
+000221e0: 6976 6964 7561 6c5f 696e 6465 7820 3d20  ividual_index = 
+000221f0: 6865 6164 6572 2e69 6e64 6578 2822 696e  header.index("in
+00022200: 6469 7669 6475 616c 2229 0a20 2020 2065  dividual").    e
+00022210: 7863 6570 7420 5661 6c75 6545 7272 6f72  xcept ValueError
+00022220: 3a0a 2020 2020 2020 2020 7061 7373 0a20  :.        pass. 
+00022230: 2020 2074 7279 3a0a 2020 2020 2020 2020     try:.        
+00022240: 6d65 7461 6461 7461 5f69 6e64 6578 203d  metadata_index =
+00022250: 2068 6561 6465 722e 696e 6465 7828 226d   header.index("m
+00022260: 6574 6164 6174 6122 290a 2020 2020 6578  etadata").    ex
+00022270: 6365 7074 2056 616c 7565 4572 726f 723a  cept ValueError:
+00022280: 0a20 2020 2020 2020 2070 6173 730a 2020  .        pass.  
+00022290: 2020 666f 7220 6c69 6e65 2069 6e20 736f    for line in so
+000222a0: 7572 6365 3a0a 2020 2020 2020 2020 746f  urce:.        to
+000222b0: 6b65 6e73 203d 206c 696e 652e 7273 7472  kens = line.rstr
+000222c0: 6970 2822 5c6e 2229 2e73 706c 6974 2873  ip("\n").split(s
+000222d0: 6570 290a 2020 2020 2020 2020 6966 206c  ep).        if l
+000222e0: 656e 2874 6f6b 656e 7329 203e 3d20 323a  en(tokens) >= 2:
+000222f0: 0a20 2020 2020 2020 2020 2020 2069 735f  .            is_
+00022300: 7361 6d70 6c65 203d 2069 6e74 2874 6f6b  sample = int(tok
+00022310: 656e 735b 6973 5f73 616d 706c 655f 696e  ens[is_sample_in
+00022320: 6465 785d 290a 2020 2020 2020 2020 2020  dex]).          
+00022330: 2020 7469 6d65 203d 2066 6c6f 6174 2874    time = float(t
+00022340: 6f6b 656e 735b 7469 6d65 5f69 6e64 6578  okens[time_index
+00022350: 5d29 0a20 2020 2020 2020 2020 2020 2066  ]).            f
+00022360: 6c61 6773 203d 2030 0a20 2020 2020 2020  lags = 0.       
+00022370: 2020 2020 2069 6620 6973 5f73 616d 706c       if is_sampl
+00022380: 6520 213d 2030 3a0a 2020 2020 2020 2020  e != 0:.        
+00022390: 2020 2020 2020 2020 666c 6167 7320 7c3d          flags |=
+000223a0: 204e 4f44 455f 4953 5f53 414d 504c 450a   NODE_IS_SAMPLE.
+000223b0: 2020 2020 2020 2020 2020 2020 706f 7075              popu
+000223c0: 6c61 7469 6f6e 203d 204e 554c 4c0a 2020  lation = NULL.  
+000223d0: 2020 2020 2020 2020 2020 6966 2070 6f70            if pop
+000223e0: 756c 6174 696f 6e5f 696e 6465 7820 6973  ulation_index is
+000223f0: 206e 6f74 204e 6f6e 653a 0a20 2020 2020   not None:.     
+00022400: 2020 2020 2020 2020 2020 2070 6f70 756c             popul
+00022410: 6174 696f 6e20 3d20 696e 7428 746f 6b65  ation = int(toke
+00022420: 6e73 5b70 6f70 756c 6174 696f 6e5f 696e  ns[population_in
+00022430: 6465 785d 290a 2020 2020 2020 2020 2020  dex]).          
+00022440: 2020 696e 6469 7669 6475 616c 203d 204e    individual = N
+00022450: 554c 4c0a 2020 2020 2020 2020 2020 2020  ULL.            
+00022460: 6966 2069 6e64 6976 6964 7561 6c5f 696e  if individual_in
+00022470: 6465 7820 6973 206e 6f74 204e 6f6e 653a  dex is not None:
+00022480: 0a20 2020 2020 2020 2020 2020 2020 2020  .               
+00022490: 2069 6e64 6976 6964 7561 6c20 3d20 696e   individual = in
+000224a0: 7428 746f 6b65 6e73 5b69 6e64 6976 6964  t(tokens[individ
+000224b0: 7561 6c5f 696e 6465 785d 290a 2020 2020  ual_index]).    
+000224c0: 2020 2020 2020 2020 6d65 7461 6461 7461          metadata
+000224d0: 203d 2062 2222 0a20 2020 2020 2020 2020   = b"".         
+000224e0: 2020 2069 6620 6d65 7461 6461 7461 5f69     if metadata_i
+000224f0: 6e64 6578 2069 7320 6e6f 7420 4e6f 6e65  ndex is not None
+00022500: 2061 6e64 206d 6574 6164 6174 615f 696e   and metadata_in
+00022510: 6465 7820 3c20 6c65 6e28 746f 6b65 6e73  dex < len(tokens
+00022520: 293a 0a20 2020 2020 2020 2020 2020 2020  ):.             
+00022530: 2020 206d 6574 6164 6174 6120 3d20 746f     metadata = to
+00022540: 6b65 6e73 5b6d 6574 6164 6174 615f 696e  kens[metadata_in
+00022550: 6465 785d 2e65 6e63 6f64 6528 656e 636f  dex].encode(enco
+00022560: 6469 6e67 290a 2020 2020 2020 2020 2020  ding).          
+00022570: 2020 2020 2020 6966 2062 6173 6536 345f        if base64_
+00022580: 6d65 7461 6461 7461 3a0a 2020 2020 2020  metadata:.      
+00022590: 2020 2020 2020 2020 2020 2020 2020 6d65                me
+000225a0: 7461 6461 7461 203d 2062 6173 6536 342e  tadata = base64.
+000225b0: 6236 3464 6563 6f64 6528 6d65 7461 6461  b64decode(metada
+000225c0: 7461 290a 2020 2020 2020 2020 2020 2020  ta).            
+000225d0: 7461 626c 652e 6164 645f 726f 7728 0a20  table.add_row(. 
+000225e0: 2020 2020 2020 2020 2020 2020 2020 2066                 f
+000225f0: 6c61 6773 3d66 6c61 6773 2c0a 2020 2020  lags=flags,.    
+00022600: 2020 2020 2020 2020 2020 2020 7469 6d65              time
+00022610: 3d74 696d 652c 0a20 2020 2020 2020 2020  =time,.         
+00022620: 2020 2020 2020 2070 6f70 756c 6174 696f         populatio
+00022630: 6e3d 706f 7075 6c61 7469 6f6e 2c0a 2020  n=population,.  
+00022640: 2020 2020 2020 2020 2020 2020 2020 696e                in
+00022650: 6469 7669 6475 616c 3d69 6e64 6976 6964  dividual=individ
+00022660: 7561 6c2c 0a20 2020 2020 2020 2020 2020  ual,.           
+00022670: 2020 2020 206d 6574 6164 6174 613d 6d65       metadata=me
+00022680: 7461 6461 7461 2c0a 2020 2020 2020 2020  tadata,.        
+00022690: 2020 2020 290a 2020 2020 7265 7475 726e      ).    return
+000226a0: 2074 6162 6c65 0a0a 0a64 6566 2070 6172   table...def par
+000226b0: 7365 5f65 6467 6573 2873 6f75 7263 652c  se_edges(source,
+000226c0: 2073 7472 6963 743d 5472 7565 2c20 7461   strict=True, ta
+000226d0: 626c 653d 4e6f 6e65 293a 0a20 2020 2022  ble=None):.    "
+000226e0: 2222 0a20 2020 2050 6172 7365 2074 6865  "".    Parse the
+000226f0: 2073 7065 6369 6669 6564 2066 696c 652d   specified file-
+00022700: 6c69 6b65 206f 626a 6563 7420 636f 6e74  like object cont
+00022710: 6169 6e69 6e67 2061 2077 6869 7465 7370  aining a whitesp
+00022720: 6163 6520 6465 6c69 6d69 7465 640a 2020  ace delimited.  
+00022730: 2020 6465 7363 7269 7074 696f 6e20 6f66    description of
+00022740: 2061 2065 6467 6520 7461 626c 6520 616e   a edge table an
+00022750: 6420 7265 7475 726e 7320 7468 6520 636f  d returns the co
+00022760: 7272 6573 706f 6e64 696e 6720 3a63 6c61  rresponding :cla
+00022770: 7373 3a60 4564 6765 5461 626c 6560 0a20  ss:`EdgeTable`. 
+00022780: 2020 2069 6e73 7461 6e63 652e 2053 6565     instance. See
+00022790: 2074 6865 203a 7265 663a 6065 6467 6520   the :ref:`edge 
+000227a0: 7465 7874 2066 6f72 6d61 7420 3c73 6563  text format <sec
+000227b0: 5f65 6467 655f 7465 7874 5f66 6f72 6d61  _edge_text_forma
+000227c0: 743e 6020 7365 6374 696f 6e0a 2020 2020  t>` section.    
+000227d0: 666f 7220 7468 6520 6465 7461 696c 7320  for the details 
+000227e0: 6f66 2074 6865 2072 6571 7569 7265 6420  of the required 
+000227f0: 666f 726d 6174 2061 6e64 2074 6865 0a20  format and the. 
+00022800: 2020 203a 7265 663a 6065 6467 6520 7461     :ref:`edge ta
+00022810: 626c 6520 6465 6669 6e69 7469 6f6e 203c  ble definition <
+00022820: 7365 635f 6564 6765 5f74 6162 6c65 5f64  sec_edge_table_d
+00022830: 6566 696e 6974 696f 6e3e 6020 7365 6374  efinition>` sect
+00022840: 696f 6e20 666f 7220 7468 650a 2020 2020  ion for the.    
+00022850: 7265 7175 6972 6564 2070 726f 7065 7274  required propert
+00022860: 6965 7320 6f66 2074 6865 2063 6f6e 7465  ies of the conte
+00022870: 6e74 732e 0a0a 2020 2020 5365 6520 3a66  nts...    See :f
+00022880: 756e 633a 6074 736b 6974 2e6c 6f61 645f  unc:`tskit.load_
+00022890: 7465 7874 6020 666f 7220 6120 6465 7461  text` for a deta
+000228a0: 696c 6564 2065 7870 6c61 6e61 7469 6f6e  iled explanation
+000228b0: 206f 6620 7468 6520 6060 7374 7269 6374   of the ``strict
+000228c0: 6060 2070 6172 616d 6574 6572 2e0a 0a20  `` parameter... 
+000228d0: 2020 203a 7061 7261 6d20 696f 2e54 6578     :param io.Tex
+000228e0: 7449 4f42 6173 6520 736f 7572 6365 3a20  tIOBase source: 
+000228f0: 5468 6520 6669 6c65 2d6c 696b 6520 6f62  The file-like ob
+00022900: 6a65 6374 2063 6f6e 7461 696e 696e 6720  ject containing 
+00022910: 7468 6520 7465 7874 2e0a 2020 2020 3a70  the text..    :p
+00022920: 6172 616d 2062 6f6f 6c20 7374 7269 6374  aram bool strict
+00022930: 3a20 4966 2054 7275 652c 2072 6571 7569  : If True, requi
+00022940: 7265 2073 7472 6963 7420 7461 6220 6465  re strict tab de
+00022950: 6c69 6d69 7469 6e67 2028 6465 6661 756c  limiting (defaul
+00022960: 7429 2e20 4966 0a20 2020 2020 2020 2046  t). If.        F
+00022970: 616c 7365 2c20 6120 7265 6c61 7865 6420  alse, a relaxed 
+00022980: 7768 6974 6573 7061 6365 2073 706c 6974  whitespace split
+00022990: 7469 6e67 2061 6c67 6f72 6974 686d 2069  ting algorithm i
+000229a0: 7320 7573 6564 2e0a 2020 2020 3a70 6172  s used..    :par
+000229b0: 616d 2045 6467 6554 6162 6c65 2074 6162  am EdgeTable tab
+000229c0: 6c65 3a20 4966 2073 7065 6369 6669 6564  le: If specified
+000229d0: 2c20 7772 6974 6520 7468 6520 6564 6765  , write the edge
+000229e0: 7320 696e 746f 2074 6869 7320 7461 626c  s into this tabl
+000229f0: 652e 2049 660a 2020 2020 2020 2020 6e6f  e. If.        no
+00022a00: 742c 2063 7265 6174 6520 6120 6e65 7720  t, create a new 
+00022a10: 3a63 6c61 7373 3a60 4564 6765 5461 626c  :class:`EdgeTabl
+00022a20: 6560 2069 6e73 7461 6e63 6520 616e 6420  e` instance and 
+00022a30: 7265 7475 726e 2e0a 2020 2020 2222 220a  return..    """.
+00022a40: 2020 2020 7365 7020 3d20 4e6f 6e65 0a20      sep = None. 
+00022a50: 2020 2069 6620 7374 7269 6374 3a0a 2020     if strict:.  
+00022a60: 2020 2020 2020 7365 7020 3d20 225c 7422        sep = "\t"
+00022a70: 0a20 2020 2069 6620 7461 626c 6520 6973  .    if table is
+00022a80: 204e 6f6e 653a 0a20 2020 2020 2020 2074   None:.        t
+00022a90: 6162 6c65 203d 2074 6162 6c65 732e 4564  able = tables.Ed
+00022aa0: 6765 5461 626c 6528 290a 2020 2020 6865  geTable().    he
+00022ab0: 6164 6572 203d 2073 6f75 7263 652e 7265  ader = source.re
+00022ac0: 6164 6c69 6e65 2829 2e72 7374 7269 7028  adline().rstrip(
+00022ad0: 225c 6e22 292e 7370 6c69 7428 7365 7029  "\n").split(sep)
+00022ae0: 0a20 2020 206c 6566 745f 696e 6465 7820  .    left_index 
+00022af0: 3d20 6865 6164 6572 2e69 6e64 6578 2822  = header.index("
+00022b00: 6c65 6674 2229 0a20 2020 2072 6967 6874  left").    right
+00022b10: 5f69 6e64 6578 203d 2068 6561 6465 722e  _index = header.
+00022b20: 696e 6465 7828 2272 6967 6874 2229 0a20  index("right"). 
+00022b30: 2020 2070 6172 656e 745f 696e 6465 7820     parent_index 
+00022b40: 3d20 6865 6164 6572 2e69 6e64 6578 2822  = header.index("
+00022b50: 7061 7265 6e74 2229 0a20 2020 2063 6869  parent").    chi
+00022b60: 6c64 7265 6e5f 696e 6465 7820 3d20 6865  ldren_index = he
+00022b70: 6164 6572 2e69 6e64 6578 2822 6368 696c  ader.index("chil
+00022b80: 6422 290a 2020 2020 666f 7220 6c69 6e65  d").    for line
+00022b90: 2069 6e20 736f 7572 6365 3a0a 2020 2020   in source:.    
+00022ba0: 2020 2020 746f 6b65 6e73 203d 206c 696e      tokens = lin
+00022bb0: 652e 7273 7472 6970 2822 5c6e 2229 2e73  e.rstrip("\n").s
+00022bc0: 706c 6974 2873 6570 290a 2020 2020 2020  plit(sep).      
+00022bd0: 2020 6966 206c 656e 2874 6f6b 656e 7329    if len(tokens)
+00022be0: 203e 3d20 343a 0a20 2020 2020 2020 2020   >= 4:.         
+00022bf0: 2020 206c 6566 7420 3d20 666c 6f61 7428     left = float(
+00022c00: 746f 6b65 6e73 5b6c 6566 745f 696e 6465  tokens[left_inde
+00022c10: 785d 290a 2020 2020 2020 2020 2020 2020  x]).            
+00022c20: 7269 6768 7420 3d20 666c 6f61 7428 746f  right = float(to
+00022c30: 6b65 6e73 5b72 6967 6874 5f69 6e64 6578  kens[right_index
+00022c40: 5d29 0a20 2020 2020 2020 2020 2020 2070  ]).            p
+00022c50: 6172 656e 7420 3d20 696e 7428 746f 6b65  arent = int(toke
+00022c60: 6e73 5b70 6172 656e 745f 696e 6465 785d  ns[parent_index]
+00022c70: 290a 2020 2020 2020 2020 2020 2020 6368  ).            ch
+00022c80: 696c 6472 656e 203d 2074 7570 6c65 286d  ildren = tuple(m
+00022c90: 6170 2869 6e74 2c20 746f 6b65 6e73 5b63  ap(int, tokens[c
+00022ca0: 6869 6c64 7265 6e5f 696e 6465 785d 2e73  hildren_index].s
+00022cb0: 706c 6974 2822 2c22 2929 290a 2020 2020  plit(","))).    
+00022cc0: 2020 2020 2020 2020 666f 7220 6368 696c          for chil
+00022cd0: 6420 696e 2063 6869 6c64 7265 6e3a 0a20  d in children:. 
+00022ce0: 2020 2020 2020 2020 2020 2020 2020 2074                 t
+00022cf0: 6162 6c65 2e61 6464 5f72 6f77 286c 6566  able.add_row(lef
+00022d00: 743d 6c65 6674 2c20 7269 6768 743d 7269  t=left, right=ri
+00022d10: 6768 742c 2070 6172 656e 743d 7061 7265  ght, parent=pare
+00022d20: 6e74 2c20 6368 696c 643d 6368 696c 6429  nt, child=child)
+00022d30: 0a20 2020 2072 6574 7572 6e20 7461 626c  .    return tabl
+00022d40: 650a 0a0a 6465 6620 7061 7273 655f 7369  e...def parse_si
+00022d50: 7465 7328 736f 7572 6365 2c20 7374 7269  tes(source, stri
+00022d60: 6374 3d54 7275 652c 2065 6e63 6f64 696e  ct=True, encodin
+00022d70: 673d 2275 7466 3822 2c20 6261 7365 3634  g="utf8", base64
+00022d80: 5f6d 6574 6164 6174 613d 5472 7565 2c20  _metadata=True, 
+00022d90: 7461 626c 653d 4e6f 6e65 293a 0a20 2020  table=None):.   
+00022da0: 2022 2222 0a20 2020 2050 6172 7365 2074   """.    Parse t
+00022db0: 6865 2073 7065 6369 6669 6564 2066 696c  he specified fil
+00022dc0: 652d 6c69 6b65 206f 626a 6563 7420 636f  e-like object co
+00022dd0: 6e74 6169 6e69 6e67 2061 2077 6869 7465  ntaining a white
+00022de0: 7370 6163 6520 6465 6c69 6d69 7465 640a  space delimited.
+00022df0: 2020 2020 6465 7363 7269 7074 696f 6e20      description 
+00022e00: 6f66 2061 2073 6974 6520 7461 626c 6520  of a site table 
+00022e10: 616e 6420 7265 7475 726e 7320 7468 6520  and returns the 
+00022e20: 636f 7272 6573 706f 6e64 696e 6720 3a63  corresponding :c
+00022e30: 6c61 7373 3a60 5369 7465 5461 626c 6560  lass:`SiteTable`
+00022e40: 0a20 2020 2069 6e73 7461 6e63 652e 2053  .    instance. S
+00022e50: 6565 2074 6865 203a 7265 663a 6073 6974  ee the :ref:`sit
+00022e60: 6520 7465 7874 2066 6f72 6d61 7420 3c73  e text format <s
+00022e70: 6563 5f73 6974 655f 7465 7874 5f66 6f72  ec_site_text_for
+00022e80: 6d61 743e 6020 7365 6374 696f 6e0a 2020  mat>` section.  
+00022e90: 2020 666f 7220 7468 6520 6465 7461 696c    for the detail
+00022ea0: 7320 6f66 2074 6865 2072 6571 7569 7265  s of the require
+00022eb0: 6420 666f 726d 6174 2061 6e64 2074 6865  d format and the
+00022ec0: 0a20 2020 203a 7265 663a 6073 6974 6520  .    :ref:`site 
+00022ed0: 7461 626c 6520 6465 6669 6e69 7469 6f6e  table definition
+00022ee0: 203c 7365 635f 7369 7465 5f74 6162 6c65   <sec_site_table
+00022ef0: 5f64 6566 696e 6974 696f 6e3e 6020 7365  _definition>` se
+00022f00: 6374 696f 6e20 666f 7220 7468 650a 2020  ction for the.  
+00022f10: 2020 7265 7175 6972 6564 2070 726f 7065    required prope
+00022f20: 7274 6965 7320 6f66 2074 6865 2063 6f6e  rties of the con
+00022f30: 7465 6e74 732e 0a0a 2020 2020 5365 6520  tents...    See 
+00022f40: 3a66 756e 633a 6074 736b 6974 2e6c 6f61  :func:`tskit.loa
+00022f50: 645f 7465 7874 6020 666f 7220 6120 6465  d_text` for a de
+00022f60: 7461 696c 6564 2065 7870 6c61 6e61 7469  tailed explanati
+00022f70: 6f6e 206f 6620 7468 6520 6060 7374 7269  on of the ``stri
+00022f80: 6374 6060 0a20 2020 2070 6172 616d 6574  ct``.    paramet
+00022f90: 6572 2e0a 0a20 2020 203a 7061 7261 6d20  er...    :param 
+00022fa0: 696f 2e54 6578 7449 4f42 6173 6520 736f  io.TextIOBase so
+00022fb0: 7572 6365 3a20 5468 6520 6669 6c65 2d6c  urce: The file-l
+00022fc0: 696b 6520 6f62 6a65 6374 2063 6f6e 7461  ike object conta
+00022fd0: 696e 696e 6720 7468 6520 7465 7874 2e0a  ining the text..
+00022fe0: 2020 2020 3a70 6172 616d 2062 6f6f 6c20      :param bool 
+00022ff0: 7374 7269 6374 3a20 4966 2054 7275 652c  strict: If True,
+00023000: 2072 6571 7569 7265 2073 7472 6963 7420   require strict 
+00023010: 7461 6220 6465 6c69 6d69 7469 6e67 2028  tab delimiting (
+00023020: 6465 6661 756c 7429 2e20 4966 0a20 2020  default). If.   
+00023030: 2020 2020 2046 616c 7365 2c20 6120 7265       False, a re
+00023040: 6c61 7865 6420 7768 6974 6573 7061 6365  laxed whitespace
+00023050: 2073 706c 6974 7469 6e67 2061 6c67 6f72   splitting algor
+00023060: 6974 686d 2069 7320 7573 6564 2e0a 2020  ithm is used..  
+00023070: 2020 3a70 6172 616d 2073 7472 2065 6e63    :param str enc
+00023080: 6f64 696e 673a 2045 6e63 6f64 696e 6720  oding: Encoding 
+00023090: 7573 6564 2066 6f72 2074 6578 7420 7265  used for text re
+000230a0: 7072 6573 656e 7461 7469 6f6e 2e0a 2020  presentation..  
+000230b0: 2020 3a70 6172 616d 2062 6f6f 6c20 6261    :param bool ba
+000230c0: 7365 3634 5f6d 6574 6164 6174 613a 2049  se64_metadata: I
+000230d0: 6620 5472 7565 2c20 6d65 7461 6461 7461  f True, metadata
+000230e0: 2069 7320 656e 636f 6465 6420 7573 696e   is encoded usin
+000230f0: 6720 4261 7365 3634 0a20 2020 2020 2020  g Base64.       
+00023100: 2065 6e63 6f64 696e 673b 206f 7468 6572   encoding; other
+00023110: 7769 7365 2c20 6173 2070 6c61 696e 2074  wise, as plain t
+00023120: 6578 742e 0a20 2020 203a 7061 7261 6d20  ext..    :param 
+00023130: 5369 7465 5461 626c 6520 7461 626c 653a  SiteTable table:
+00023140: 2049 6620 7370 6563 6966 6965 6420 7772   If specified wr
+00023150: 6974 6520 7369 7465 2069 6e74 6f20 7468  ite site into th
+00023160: 6973 2074 6162 6c65 2e20 4966 206e 6f74  is table. If not
+00023170: 2c0a 2020 2020 2020 2020 6372 6561 7465  ,.        create
+00023180: 2061 206e 6577 203a 636c 6173 733a 6053   a new :class:`S
+00023190: 6974 6554 6162 6c65 6020 696e 7374 616e  iteTable` instan
+000231a0: 6365 2e0a 2020 2020 2222 220a 2020 2020  ce..    """.    
+000231b0: 7365 7020 3d20 4e6f 6e65 0a20 2020 2069  sep = None.    i
+000231c0: 6620 7374 7269 6374 3a0a 2020 2020 2020  f strict:.      
+000231d0: 2020 7365 7020 3d20 225c 7422 0a20 2020    sep = "\t".   
+000231e0: 2069 6620 7461 626c 6520 6973 204e 6f6e   if table is Non
+000231f0: 653a 0a20 2020 2020 2020 2074 6162 6c65  e:.        table
+00023200: 203d 2074 6162 6c65 732e 5369 7465 5461   = tables.SiteTa
+00023210: 626c 6528 290a 2020 2020 6865 6164 6572  ble().    header
+00023220: 203d 2073 6f75 7263 652e 7265 6164 6c69   = source.readli
+00023230: 6e65 2829 2e72 7374 7269 7028 225c 6e22  ne().rstrip("\n"
+00023240: 292e 7370 6c69 7428 7365 7029 0a20 2020  ).split(sep).   
+00023250: 2070 6f73 6974 696f 6e5f 696e 6465 7820   position_index 
+00023260: 3d20 6865 6164 6572 2e69 6e64 6578 2822  = header.index("
+00023270: 706f 7369 7469 6f6e 2229 0a20 2020 2061  position").    a
+00023280: 6e63 6573 7472 616c 5f73 7461 7465 5f69  ncestral_state_i
+00023290: 6e64 6578 203d 2068 6561 6465 722e 696e  ndex = header.in
+000232a0: 6465 7828 2261 6e63 6573 7472 616c 5f73  dex("ancestral_s
+000232b0: 7461 7465 2229 0a20 2020 206d 6574 6164  tate").    metad
+000232c0: 6174 615f 696e 6465 7820 3d20 4e6f 6e65  ata_index = None
+000232d0: 0a20 2020 2074 7279 3a0a 2020 2020 2020  .    try:.      
+000232e0: 2020 6d65 7461 6461 7461 5f69 6e64 6578    metadata_index
+000232f0: 203d 2068 6561 6465 722e 696e 6465 7828   = header.index(
+00023300: 226d 6574 6164 6174 6122 290a 2020 2020  "metadata").    
+00023310: 6578 6365 7074 2056 616c 7565 4572 726f  except ValueErro
+00023320: 723a 0a20 2020 2020 2020 2070 6173 730a  r:.        pass.
+00023330: 2020 2020 666f 7220 6c69 6e65 2069 6e20      for line in 
+00023340: 736f 7572 6365 3a0a 2020 2020 2020 2020  source:.        
+00023350: 746f 6b65 6e73 203d 206c 696e 652e 7273  tokens = line.rs
+00023360: 7472 6970 2822 5c6e 2229 2e73 706c 6974  trip("\n").split
+00023370: 2873 6570 290a 2020 2020 2020 2020 6966  (sep).        if
+00023380: 206c 656e 2874 6f6b 656e 7329 203e 3d20   len(tokens) >= 
+00023390: 323a 0a20 2020 2020 2020 2020 2020 2070  2:.            p
+000233a0: 6f73 6974 696f 6e20 3d20 666c 6f61 7428  osition = float(
+000233b0: 746f 6b65 6e73 5b70 6f73 6974 696f 6e5f  tokens[position_
+000233c0: 696e 6465 785d 290a 2020 2020 2020 2020  index]).        
+000233d0: 2020 2020 616e 6365 7374 7261 6c5f 7374      ancestral_st
+000233e0: 6174 6520 3d20 746f 6b65 6e73 5b61 6e63  ate = tokens[anc
+000233f0: 6573 7472 616c 5f73 7461 7465 5f69 6e64  estral_state_ind
+00023400: 6578 5d0a 2020 2020 2020 2020 2020 2020  ex].            
+00023410: 6d65 7461 6461 7461 203d 2062 2222 0a20  metadata = b"". 
+00023420: 2020 2020 2020 2020 2020 2069 6620 6d65             if me
+00023430: 7461 6461 7461 5f69 6e64 6578 2069 7320  tadata_index is 
+00023440: 6e6f 7420 4e6f 6e65 2061 6e64 206d 6574  not None and met
+00023450: 6164 6174 615f 696e 6465 7820 3c20 6c65  adata_index < le
+00023460: 6e28 746f 6b65 6e73 293a 0a20 2020 2020  n(tokens):.     
+00023470: 2020 2020 2020 2020 2020 206d 6574 6164             metad
+00023480: 6174 6120 3d20 746f 6b65 6e73 5b6d 6574  ata = tokens[met
+00023490: 6164 6174 615f 696e 6465 785d 2e65 6e63  adata_index].enc
+000234a0: 6f64 6528 656e 636f 6469 6e67 290a 2020  ode(encoding).  
+000234b0: 2020 2020 2020 2020 2020 2020 2020 6966                if
+000234c0: 2062 6173 6536 345f 6d65 7461 6461 7461   base64_metadata
+000234d0: 3a0a 2020 2020 2020 2020 2020 2020 2020  :.              
+000234e0: 2020 2020 2020 6d65 7461 6461 7461 203d        metadata =
+000234f0: 2062 6173 6536 342e 6236 3464 6563 6f64   base64.b64decod
+00023500: 6528 6d65 7461 6461 7461 290a 2020 2020  e(metadata).    
+00023510: 2020 2020 2020 2020 7461 626c 652e 6164          table.ad
+00023520: 645f 726f 7728 0a20 2020 2020 2020 2020  d_row(.         
+00023530: 2020 2020 2020 2070 6f73 6974 696f 6e3d         position=
+00023540: 706f 7369 7469 6f6e 2c20 616e 6365 7374  position, ancest
+00023550: 7261 6c5f 7374 6174 653d 616e 6365 7374  ral_state=ancest
+00023560: 7261 6c5f 7374 6174 652c 206d 6574 6164  ral_state, metad
+00023570: 6174 613d 6d65 7461 6461 7461 0a20 2020  ata=metadata.   
+00023580: 2020 2020 2020 2020 2029 0a20 2020 2072           ).    r
+00023590: 6574 7572 6e20 7461 626c 650a 0a0a 6465  eturn table...de
+000235a0: 6620 7061 7273 655f 6d75 7461 7469 6f6e  f parse_mutation
+000235b0: 7328 0a20 2020 2073 6f75 7263 652c 2073  s(.    source, s
+000235c0: 7472 6963 743d 5472 7565 2c20 656e 636f  trict=True, enco
+000235d0: 6469 6e67 3d22 7574 6638 222c 2062 6173  ding="utf8", bas
+000235e0: 6536 345f 6d65 7461 6461 7461 3d54 7275  e64_metadata=Tru
+000235f0: 652c 2074 6162 6c65 3d4e 6f6e 650a 293a  e, table=None.):
+00023600: 0a20 2020 2022 2222 0a20 2020 2050 6172  .    """.    Par
+00023610: 7365 2074 6865 2073 7065 6369 6669 6564  se the specified
+00023620: 2066 696c 652d 6c69 6b65 206f 626a 6563   file-like objec
+00023630: 7420 636f 6e74 6169 6e69 6e67 2061 2077  t containing a w
+00023640: 6869 7465 7370 6163 6520 6465 6c69 6d69  hitespace delimi
+00023650: 7465 640a 2020 2020 6465 7363 7269 7074  ted.    descript
+00023660: 696f 6e20 6f66 2061 206d 7574 6174 696f  ion of a mutatio
+00023670: 6e20 7461 626c 6520 616e 6420 7265 7475  n table and retu
+00023680: 726e 7320 7468 6520 636f 7272 6573 706f  rns the correspo
+00023690: 6e64 696e 6720 3a63 6c61 7373 3a60 4d75  nding :class:`Mu
+000236a0: 7461 7469 6f6e 5461 626c 6560 0a20 2020  tationTable`.   
+000236b0: 2069 6e73 7461 6e63 652e 2053 6565 2074   instance. See t
+000236c0: 6865 203a 7265 663a 606d 7574 6174 696f  he :ref:`mutatio
+000236d0: 6e20 7465 7874 2066 6f72 6d61 7420 3c73  n text format <s
+000236e0: 6563 5f6d 7574 6174 696f 6e5f 7465 7874  ec_mutation_text
+000236f0: 5f66 6f72 6d61 743e 6020 7365 6374 696f  _format>` sectio
+00023700: 6e0a 2020 2020 666f 7220 7468 6520 6465  n.    for the de
+00023710: 7461 696c 7320 6f66 2074 6865 2072 6571  tails of the req
+00023720: 7569 7265 6420 666f 726d 6174 2061 6e64  uired format and
+00023730: 2074 6865 0a20 2020 203a 7265 663a 606d   the.    :ref:`m
+00023740: 7574 6174 696f 6e20 7461 626c 6520 6465  utation table de
+00023750: 6669 6e69 7469 6f6e 203c 7365 635f 6d75  finition <sec_mu
+00023760: 7461 7469 6f6e 5f74 6162 6c65 5f64 6566  tation_table_def
+00023770: 696e 6974 696f 6e3e 6020 7365 6374 696f  inition>` sectio
+00023780: 6e20 666f 7220 7468 650a 2020 2020 7265  n for the.    re
+00023790: 7175 6972 6564 2070 726f 7065 7274 6965  quired propertie
+000237a0: 7320 6f66 2074 6865 2063 6f6e 7465 6e74  s of the content
+000237b0: 732e 204e 6f74 6520 7468 6174 2069 6620  s. Note that if 
+000237c0: 7468 6520 6060 7469 6d65 6060 2063 6f6c  the ``time`` col
+000237d0: 756d 6e20 6973 206d 6973 7369 6e67 2069  umn is missing i
+000237e0: 7473 0a20 2020 2065 6e74 7269 6573 2061  ts.    entries a
+000237f0: 7265 2066 696c 6c65 6420 7769 7468 2060  re filled with `
+00023800: 6055 4e4b 4e4f 574e 5f54 494d 4560 602e  `UNKNOWN_TIME``.
+00023810: 0a0a 2020 2020 5365 6520 3a66 756e 633a  ..    See :func:
+00023820: 6074 736b 6974 2e6c 6f61 645f 7465 7874  `tskit.load_text
+00023830: 6020 666f 7220 6120 6465 7461 696c 6564  ` for a detailed
+00023840: 2065 7870 6c61 6e61 7469 6f6e 206f 6620   explanation of 
+00023850: 7468 6520 6060 7374 7269 6374 6060 0a20  the ``strict``. 
+00023860: 2020 2070 6172 616d 6574 6572 2e0a 0a20     parameter... 
+00023870: 2020 203a 7061 7261 6d20 696f 2e54 6578     :param io.Tex
+00023880: 7449 4f42 6173 6520 736f 7572 6365 3a20  tIOBase source: 
+00023890: 5468 6520 6669 6c65 2d6c 696b 6520 6f62  The file-like ob
+000238a0: 6a65 6374 2063 6f6e 7461 696e 696e 6720  ject containing 
+000238b0: 7468 6520 7465 7874 2e0a 2020 2020 3a70  the text..    :p
+000238c0: 6172 616d 2062 6f6f 6c20 7374 7269 6374  aram bool strict
+000238d0: 3a20 4966 2054 7275 652c 2072 6571 7569  : If True, requi
+000238e0: 7265 2073 7472 6963 7420 7461 6220 6465  re strict tab de
+000238f0: 6c69 6d69 7469 6e67 2028 6465 6661 756c  limiting (defaul
+00023900: 7429 2e20 4966 0a20 2020 2020 2020 2046  t). If.        F
+00023910: 616c 7365 2c20 6120 7265 6c61 7865 6420  alse, a relaxed 
+00023920: 7768 6974 6573 7061 6365 2073 706c 6974  whitespace split
+00023930: 7469 6e67 2061 6c67 6f72 6974 686d 2069  ting algorithm i
+00023940: 7320 7573 6564 2e0a 2020 2020 3a70 6172  s used..    :par
+00023950: 616d 2073 7472 2065 6e63 6f64 696e 673a  am str encoding:
+00023960: 2045 6e63 6f64 696e 6720 7573 6564 2066   Encoding used f
+00023970: 6f72 2074 6578 7420 7265 7072 6573 656e  or text represen
+00023980: 7461 7469 6f6e 2e0a 2020 2020 3a70 6172  tation..    :par
+00023990: 616d 2062 6f6f 6c20 6261 7365 3634 5f6d  am bool base64_m
+000239a0: 6574 6164 6174 613a 2049 6620 5472 7565  etadata: If True
+000239b0: 2c20 6d65 7461 6461 7461 2069 7320 656e  , metadata is en
+000239c0: 636f 6465 6420 7573 696e 6720 4261 7365  coded using Base
+000239d0: 3634 0a20 2020 2020 2020 2065 6e63 6f64  64.        encod
+000239e0: 696e 673b 206f 7468 6572 7769 7365 2c20  ing; otherwise, 
+000239f0: 6173 2070 6c61 696e 2074 6578 742e 0a20  as plain text.. 
+00023a00: 2020 203a 7061 7261 6d20 4d75 7461 7469     :param Mutati
+00023a10: 6f6e 5461 626c 6520 7461 626c 653a 2049  onTable table: I
+00023a20: 6620 7370 6563 6966 6965 642c 2077 7269  f specified, wri
+00023a30: 7465 206d 7574 6174 696f 6e73 2069 6e74  te mutations int
+00023a40: 6f20 7468 6973 2074 6162 6c65 2e0a 2020  o this table..  
+00023a50: 2020 2020 2020 4966 206e 6f74 2c20 6372        If not, cr
+00023a60: 6561 7465 2061 206e 6577 203a 636c 6173  eate a new :clas
+00023a70: 733a 604d 7574 6174 696f 6e54 6162 6c65  s:`MutationTable
+00023a80: 6020 696e 7374 616e 6365 2e0a 2020 2020  ` instance..    
+00023a90: 2222 220a 2020 2020 7365 7020 3d20 4e6f  """.    sep = No
+00023aa0: 6e65 0a20 2020 2069 6620 7374 7269 6374  ne.    if strict
+00023ab0: 3a0a 2020 2020 2020 2020 7365 7020 3d20  :.        sep = 
+00023ac0: 225c 7422 0a20 2020 2069 6620 7461 626c  "\t".    if tabl
+00023ad0: 6520 6973 204e 6f6e 653a 0a20 2020 2020  e is None:.     
+00023ae0: 2020 2074 6162 6c65 203d 2074 6162 6c65     table = table
+00023af0: 732e 4d75 7461 7469 6f6e 5461 626c 6528  s.MutationTable(
+00023b00: 290a 2020 2020 6865 6164 6572 203d 2073  ).    header = s
+00023b10: 6f75 7263 652e 7265 6164 6c69 6e65 2829  ource.readline()
+00023b20: 2e72 7374 7269 7028 225c 6e22 292e 7370  .rstrip("\n").sp
+00023b30: 6c69 7428 7365 7029 0a20 2020 2073 6974  lit(sep).    sit
+00023b40: 655f 696e 6465 7820 3d20 6865 6164 6572  e_index = header
+00023b50: 2e69 6e64 6578 2822 7369 7465 2229 0a20  .index("site"). 
+00023b60: 2020 206e 6f64 655f 696e 6465 7820 3d20     node_index = 
+00023b70: 6865 6164 6572 2e69 6e64 6578 2822 6e6f  header.index("no
+00023b80: 6465 2229 0a20 2020 2074 7279 3a0a 2020  de").    try:.  
+00023b90: 2020 2020 2020 7469 6d65 5f69 6e64 6578        time_index
+00023ba0: 203d 2068 6561 6465 722e 696e 6465 7828   = header.index(
+00023bb0: 2274 696d 6522 290a 2020 2020 6578 6365  "time").    exce
+00023bc0: 7074 2056 616c 7565 4572 726f 723a 0a20  pt ValueError:. 
+00023bd0: 2020 2020 2020 2074 696d 655f 696e 6465         time_inde
+00023be0: 7820 3d20 4e6f 6e65 0a20 2020 2064 6572  x = None.    der
+00023bf0: 6976 6564 5f73 7461 7465 5f69 6e64 6578  ived_state_index
+00023c00: 203d 2068 6561 6465 722e 696e 6465 7828   = header.index(
+00023c10: 2264 6572 6976 6564 5f73 7461 7465 2229  "derived_state")
+00023c20: 0a20 2020 2070 6172 656e 745f 696e 6465  .    parent_inde
+00023c30: 7820 3d20 4e6f 6e65 0a20 2020 2070 6172  x = None.    par
+00023c40: 656e 7420 3d20 4e55 4c4c 0a20 2020 2074  ent = NULL.    t
+00023c50: 7279 3a0a 2020 2020 2020 2020 7061 7265  ry:.        pare
+00023c60: 6e74 5f69 6e64 6578 203d 2068 6561 6465  nt_index = heade
+00023c70: 722e 696e 6465 7828 2270 6172 656e 7422  r.index("parent"
+00023c80: 290a 2020 2020 6578 6365 7074 2056 616c  ).    except Val
+00023c90: 7565 4572 726f 723a 0a20 2020 2020 2020  ueError:.       
+00023ca0: 2070 6173 730a 2020 2020 6d65 7461 6461   pass.    metada
+00023cb0: 7461 5f69 6e64 6578 203d 204e 6f6e 650a  ta_index = None.
+00023cc0: 2020 2020 7472 793a 0a20 2020 2020 2020      try:.       
+00023cd0: 206d 6574 6164 6174 615f 696e 6465 7820   metadata_index 
+00023ce0: 3d20 6865 6164 6572 2e69 6e64 6578 2822  = header.index("
+00023cf0: 6d65 7461 6461 7461 2229 0a20 2020 2065  metadata").    e
+00023d00: 7863 6570 7420 5661 6c75 6545 7272 6f72  xcept ValueError
+00023d10: 3a0a 2020 2020 2020 2020 7061 7373 0a20  :.        pass. 
+00023d20: 2020 2066 6f72 206c 696e 6520 696e 2073     for line in s
+00023d30: 6f75 7263 653a 0a20 2020 2020 2020 2074  ource:.        t
+00023d40: 6f6b 656e 7320 3d20 6c69 6e65 2e72 7374  okens = line.rst
+00023d50: 7269 7028 225c 6e22 292e 7370 6c69 7428  rip("\n").split(
+00023d60: 7365 7029 0a20 2020 2020 2020 2069 6620  sep).        if 
+00023d70: 6c65 6e28 746f 6b65 6e73 2920 3e3d 2033  len(tokens) >= 3
+00023d80: 3a0a 2020 2020 2020 2020 2020 2020 7369  :.            si
+00023d90: 7465 203d 2069 6e74 2874 6f6b 656e 735b  te = int(tokens[
+00023da0: 7369 7465 5f69 6e64 6578 5d29 0a20 2020  site_index]).   
+00023db0: 2020 2020 2020 2020 206e 6f64 6520 3d20           node = 
+00023dc0: 696e 7428 746f 6b65 6e73 5b6e 6f64 655f  int(tokens[node_
+00023dd0: 696e 6465 785d 290a 2020 2020 2020 2020  index]).        
+00023de0: 2020 2020 6966 2074 696d 655f 696e 6465      if time_inde
+00023df0: 7820 6973 204e 6f6e 6520 6f72 2074 6f6b  x is None or tok
+00023e00: 656e 735b 7469 6d65 5f69 6e64 6578 5d20  ens[time_index] 
+00023e10: 3d3d 2074 736b 6974 2e54 494d 455f 554e  == tskit.TIME_UN
+00023e20: 4954 535f 554e 4b4e 4f57 4e3a 0a20 2020  ITS_UNKNOWN:.   
+00023e30: 2020 2020 2020 2020 2020 2020 2074 696d               tim
+00023e40: 6520 3d20 554e 4b4e 4f57 4e5f 5449 4d45  e = UNKNOWN_TIME
+00023e50: 0a20 2020 2020 2020 2020 2020 2065 6c73  .            els
+00023e60: 653a 0a20 2020 2020 2020 2020 2020 2020  e:.             
+00023e70: 2020 2074 696d 6520 3d20 666c 6f61 7428     time = float(
+00023e80: 746f 6b65 6e73 5b74 696d 655f 696e 6465  tokens[time_inde
+00023e90: 785d 290a 2020 2020 2020 2020 2020 2020  x]).            
+00023ea0: 6465 7269 7665 645f 7374 6174 6520 3d20  derived_state = 
+00023eb0: 746f 6b65 6e73 5b64 6572 6976 6564 5f73  tokens[derived_s
+00023ec0: 7461 7465 5f69 6e64 6578 5d0a 2020 2020  tate_index].    
+00023ed0: 2020 2020 2020 2020 6966 2070 6172 656e          if paren
+00023ee0: 745f 696e 6465 7820 6973 206e 6f74 204e  t_index is not N
+00023ef0: 6f6e 653a 0a20 2020 2020 2020 2020 2020  one:.           
+00023f00: 2020 2020 2070 6172 656e 7420 3d20 696e       parent = in
+00023f10: 7428 746f 6b65 6e73 5b70 6172 656e 745f  t(tokens[parent_
+00023f20: 696e 6465 785d 290a 2020 2020 2020 2020  index]).        
+00023f30: 2020 2020 6d65 7461 6461 7461 203d 2062      metadata = b
+00023f40: 2222 0a20 2020 2020 2020 2020 2020 2069  "".            i
+00023f50: 6620 6d65 7461 6461 7461 5f69 6e64 6578  f metadata_index
+00023f60: 2069 7320 6e6f 7420 4e6f 6e65 2061 6e64   is not None and
+00023f70: 206d 6574 6164 6174 615f 696e 6465 7820   metadata_index 
+00023f80: 3c20 6c65 6e28 746f 6b65 6e73 293a 0a20  < len(tokens):. 
+00023f90: 2020 2020 2020 2020 2020 2020 2020 206d                 m
+00023fa0: 6574 6164 6174 6120 3d20 746f 6b65 6e73  etadata = tokens
+00023fb0: 5b6d 6574 6164 6174 615f 696e 6465 785d  [metadata_index]
+00023fc0: 2e65 6e63 6f64 6528 656e 636f 6469 6e67  .encode(encoding
+00023fd0: 290a 2020 2020 2020 2020 2020 2020 2020  ).              
+00023fe0: 2020 6966 2062 6173 6536 345f 6d65 7461    if base64_meta
+00023ff0: 6461 7461 3a0a 2020 2020 2020 2020 2020  data:.          
+00024000: 2020 2020 2020 2020 2020 6d65 7461 6461            metada
+00024010: 7461 203d 2062 6173 6536 342e 6236 3464  ta = base64.b64d
+00024020: 6563 6f64 6528 6d65 7461 6461 7461 290a  ecode(metadata).
+00024030: 2020 2020 2020 2020 2020 2020 7461 626c              tabl
+00024040: 652e 6164 645f 726f 7728 0a20 2020 2020  e.add_row(.     
+00024050: 2020 2020 2020 2020 2020 2073 6974 653d             site=
+00024060: 7369 7465 2c0a 2020 2020 2020 2020 2020  site,.          
+00024070: 2020 2020 2020 6e6f 6465 3d6e 6f64 652c        node=node,
+00024080: 0a20 2020 2020 2020 2020 2020 2020 2020  .               
+00024090: 2074 696d 653d 7469 6d65 2c0a 2020 2020   time=time,.    
+000240a0: 2020 2020 2020 2020 2020 2020 6465 7269              deri
+000240b0: 7665 645f 7374 6174 653d 6465 7269 7665  ved_state=derive
+000240c0: 645f 7374 6174 652c 0a20 2020 2020 2020  d_state,.       
+000240d0: 2020 2020 2020 2020 2070 6172 656e 743d           parent=
+000240e0: 7061 7265 6e74 2c0a 2020 2020 2020 2020  parent,.        
+000240f0: 2020 2020 2020 2020 6d65 7461 6461 7461          metadata
+00024100: 3d6d 6574 6164 6174 612c 0a20 2020 2020  =metadata,.     
+00024110: 2020 2020 2020 2029 0a20 2020 2072 6574         ).    ret
+00024120: 7572 6e20 7461 626c 650a 0a0a 6465 6620  urn table...def 
+00024130: 7061 7273 655f 706f 7075 6c61 7469 6f6e  parse_population
+00024140: 7328 0a20 2020 2073 6f75 7263 652c 2073  s(.    source, s
+00024150: 7472 6963 743d 5472 7565 2c20 656e 636f  trict=True, enco
+00024160: 6469 6e67 3d22 7574 6638 222c 2062 6173  ding="utf8", bas
+00024170: 6536 345f 6d65 7461 6461 7461 3d54 7275  e64_metadata=Tru
+00024180: 652c 2074 6162 6c65 3d4e 6f6e 650a 293a  e, table=None.):
+00024190: 0a20 2020 2022 2222 0a20 2020 2050 6172  .    """.    Par
+000241a0: 7365 2074 6865 2073 7065 6369 6669 6564  se the specified
+000241b0: 2066 696c 652d 6c69 6b65 206f 626a 6563   file-like objec
+000241c0: 7420 636f 6e74 6169 6e69 6e67 2061 2077  t containing a w
+000241d0: 6869 7465 7370 6163 6520 6465 6c69 6d69  hitespace delimi
+000241e0: 7465 640a 2020 2020 6465 7363 7269 7074  ted.    descript
+000241f0: 696f 6e20 6f66 2061 2070 6f70 756c 6174  ion of a populat
+00024200: 696f 6e20 7461 626c 6520 616e 6420 7265  ion table and re
+00024210: 7475 726e 7320 7468 6520 636f 7272 6573  turns the corres
+00024220: 706f 6e64 696e 670a 2020 2020 3a63 6c61  ponding.    :cla
+00024230: 7373 3a60 506f 7075 6c61 7469 6f6e 5461  ss:`PopulationTa
+00024240: 626c 6560 2069 6e73 7461 6e63 652e 2053  ble` instance. S
+00024250: 6565 2074 6865 203a 7265 663a 6070 6f70  ee the :ref:`pop
+00024260: 756c 6174 696f 6e20 7465 7874 2066 6f72  ulation text for
+00024270: 6d61 740a 2020 2020 3c73 6563 5f70 6f70  mat.    <sec_pop
+00024280: 756c 6174 696f 6e5f 7465 7874 5f66 6f72  ulation_text_for
+00024290: 6d61 743e 6020 7365 6374 696f 6e20 666f  mat>` section fo
+000242a0: 7220 7468 6520 6465 7461 696c 7320 6f66  r the details of
+000242b0: 2074 6865 2072 6571 7569 7265 640a 2020   the required.  
+000242c0: 2020 666f 726d 6174 2061 6e64 2074 6865    format and the
+000242d0: 203a 7265 663a 6070 6f70 756c 6174 696f   :ref:`populatio
+000242e0: 6e20 7461 626c 6520 6465 6669 6e69 7469  n table definiti
+000242f0: 6f6e 0a20 2020 203c 7365 635f 706f 7075  on.    <sec_popu
+00024300: 6c61 7469 6f6e 5f74 6162 6c65 5f64 6566  lation_table_def
+00024310: 696e 6974 696f 6e3e 6020 7365 6374 696f  inition>` sectio
+00024320: 6e20 666f 7220 7468 6520 7265 7175 6972  n for the requir
+00024330: 6564 2070 726f 7065 7274 6965 7320 6f66  ed properties of
+00024340: 0a20 2020 2074 6865 2063 6f6e 7465 6e74  .    the content
+00024350: 732e 0a0a 2020 2020 5365 6520 3a66 756e  s...    See :fun
+00024360: 633a 6074 736b 6974 2e6c 6f61 645f 7465  c:`tskit.load_te
+00024370: 7874 6020 666f 7220 6120 6465 7461 696c  xt` for a detail
+00024380: 6564 2065 7870 6c61 6e61 7469 6f6e 206f  ed explanation o
+00024390: 6620 7468 6520 6060 7374 7269 6374 6060  f the ``strict``
+000243a0: 0a20 2020 2070 6172 616d 6574 6572 2e0a  .    parameter..
+000243b0: 0a20 2020 203a 7061 7261 6d20 696f 2e54  .    :param io.T
+000243c0: 6578 7449 4f42 6173 6520 736f 7572 6365  extIOBase source
+000243d0: 3a20 5468 6520 6669 6c65 2d6c 696b 6520  : The file-like 
+000243e0: 6f62 6a65 6374 2063 6f6e 7461 696e 696e  object containin
+000243f0: 6720 7468 6520 7465 7874 2e0a 2020 2020  g the text..    
+00024400: 3a70 6172 616d 2062 6f6f 6c20 7374 7269  :param bool stri
+00024410: 6374 3a20 4966 2054 7275 652c 2072 6571  ct: If True, req
+00024420: 7569 7265 2073 7472 6963 7420 7461 6220  uire strict tab 
+00024430: 6465 6c69 6d69 7469 6e67 2028 6465 6661  delimiting (defa
+00024440: 756c 7429 2e20 4966 0a20 2020 2020 2020  ult). If.       
+00024450: 2046 616c 7365 2c20 6120 7265 6c61 7865   False, a relaxe
+00024460: 6420 7768 6974 6573 7061 6365 2073 706c  d whitespace spl
+00024470: 6974 7469 6e67 2061 6c67 6f72 6974 686d  itting algorithm
+00024480: 2069 7320 7573 6564 2e0a 2020 2020 3a70   is used..    :p
+00024490: 6172 616d 2073 7472 2065 6e63 6f64 696e  aram str encodin
+000244a0: 673a 2045 6e63 6f64 696e 6720 7573 6564  g: Encoding used
+000244b0: 2066 6f72 2074 6578 7420 7265 7072 6573   for text repres
+000244c0: 656e 7461 7469 6f6e 2e0a 2020 2020 3a70  entation..    :p
+000244d0: 6172 616d 2062 6f6f 6c20 6261 7365 3634  aram bool base64
+000244e0: 5f6d 6574 6164 6174 613a 2049 6620 5472  _metadata: If Tr
+000244f0: 7565 2c20 6d65 7461 6461 7461 2069 7320  ue, metadata is 
+00024500: 656e 636f 6465 6420 7573 696e 6720 4261  encoded using Ba
+00024510: 7365 3634 0a20 2020 2020 2020 2065 6e63  se64.        enc
+00024520: 6f64 696e 673b 206f 7468 6572 7769 7365  oding; otherwise
+00024530: 2c20 6173 2070 6c61 696e 2074 6578 742e  , as plain text.
+00024540: 0a20 2020 203a 7061 7261 6d20 506f 7075  .    :param Popu
+00024550: 6c61 7469 6f6e 5461 626c 6520 7461 626c  lationTable tabl
+00024560: 653a 2049 6620 7370 6563 6966 6965 6420  e: If specified 
+00024570: 7772 6974 6520 696e 746f 2074 6869 7320  write into this 
+00024580: 7461 626c 652e 2049 6620 6e6f 742c 0a20  table. If not,. 
+00024590: 2020 2020 2020 2063 7265 6174 6520 6120         create a 
+000245a0: 6e65 7720 3a63 6c61 7373 3a60 506f 7075  new :class:`Popu
+000245b0: 6c61 7469 6f6e 5461 626c 6560 2069 6e73  lationTable` ins
+000245c0: 7461 6e63 652e 0a20 2020 2022 2222 0a20  tance..    """. 
+000245d0: 2020 2073 6570 203d 204e 6f6e 650a 2020     sep = None.  
+000245e0: 2020 6966 2073 7472 6963 743a 0a20 2020    if strict:.   
+000245f0: 2020 2020 2073 6570 203d 2022 5c74 220a       sep = "\t".
+00024600: 2020 2020 6966 2074 6162 6c65 2069 7320      if table is 
+00024610: 4e6f 6e65 3a0a 2020 2020 2020 2020 7461  None:.        ta
+00024620: 626c 6520 3d20 7461 626c 6573 2e50 6f70  ble = tables.Pop
+00024630: 756c 6174 696f 6e54 6162 6c65 2829 0a20  ulationTable(). 
+00024640: 2020 2023 2052 6561 6420 7468 6520 6865     # Read the he
+00024650: 6164 6572 2061 6e64 2066 696e 6420 7468  ader and find th
+00024660: 6520 696e 6465 7865 7320 6f66 2074 6865  e indexes of the
+00024670: 2072 6571 7569 7265 6420 6669 656c 6473   required fields
+00024680: 2e0a 2020 2020 6865 6164 6572 203d 2073  ..    header = s
+00024690: 6f75 7263 652e 7265 6164 6c69 6e65 2829  ource.readline()
+000246a0: 2e72 7374 7269 7028 225c 6e22 292e 7370  .rstrip("\n").sp
+000246b0: 6c69 7428 7365 7029 0a20 2020 206d 6574  lit(sep).    met
+000246c0: 6164 6174 615f 696e 6465 7820 3d20 6865  adata_index = he
+000246d0: 6164 6572 2e69 6e64 6578 2822 6d65 7461  ader.index("meta
+000246e0: 6461 7461 2229 0a20 2020 2066 6f72 206c  data").    for l
+000246f0: 696e 6520 696e 2073 6f75 7263 653a 0a20  ine in source:. 
+00024700: 2020 2020 2020 2074 6f6b 656e 7320 3d20         tokens = 
+00024710: 6c69 6e65 2e72 7374 7269 7028 225c 6e22  line.rstrip("\n"
+00024720: 292e 7370 6c69 7428 7365 7029 0a20 2020  ).split(sep).   
+00024730: 2020 2020 2069 6620 6c65 6e28 746f 6b65       if len(toke
+00024740: 6e73 2920 3e3d 2031 3a0a 2020 2020 2020  ns) >= 1:.      
+00024750: 2020 2020 2020 6d65 7461 6461 7461 203d        metadata =
+00024760: 2074 6f6b 656e 735b 6d65 7461 6461 7461   tokens[metadata
+00024770: 5f69 6e64 6578 5d2e 656e 636f 6465 2865  _index].encode(e
+00024780: 6e63 6f64 696e 6729 0a20 2020 2020 2020  ncoding).       
+00024790: 2020 2020 2069 6620 6261 7365 3634 5f6d       if base64_m
+000247a0: 6574 6164 6174 613a 0a20 2020 2020 2020  etadata:.       
+000247b0: 2020 2020 2020 2020 206d 6574 6164 6174           metadat
+000247c0: 6120 3d20 6261 7365 3634 2e62 3634 6465  a = base64.b64de
+000247d0: 636f 6465 286d 6574 6164 6174 6129 0a20  code(metadata). 
+000247e0: 2020 2020 2020 2020 2020 2074 6162 6c65             table
+000247f0: 2e61 6464 5f72 6f77 286d 6574 6164 6174  .add_row(metadat
+00024800: 613d 6d65 7461 6461 7461 290a 2020 2020  a=metadata).    
+00024810: 7265 7475 726e 2074 6162 6c65 0a0a 0a64  return table...d
+00024820: 6566 2070 6172 7365 5f6d 6967 7261 7469  ef parse_migrati
+00024830: 6f6e 7328 0a20 2020 2073 6f75 7263 652c  ons(.    source,
+00024840: 2073 7472 6963 743d 5472 7565 2c20 656e   strict=True, en
+00024850: 636f 6469 6e67 3d22 7574 6638 222c 2062  coding="utf8", b
+00024860: 6173 6536 345f 6d65 7461 6461 7461 3d54  ase64_metadata=T
+00024870: 7275 652c 2074 6162 6c65 3d4e 6f6e 650a  rue, table=None.
+00024880: 293a 0a20 2020 2022 2222 0a20 2020 2050  ):.    """.    P
+00024890: 6172 7365 2074 6865 2073 7065 6369 6669  arse the specifi
+000248a0: 6564 2066 696c 652d 6c69 6b65 206f 626a  ed file-like obj
+000248b0: 6563 7420 636f 6e74 6169 6e69 6e67 2061  ect containing a
+000248c0: 2077 6869 7465 7370 6163 6520 6465 6c69   whitespace deli
+000248d0: 6d69 7465 640a 2020 2020 6465 7363 7269  mited.    descri
+000248e0: 7074 696f 6e20 6f66 2061 206d 6967 7261  ption of a migra
+000248f0: 7469 6f6e 2074 6162 6c65 2061 6e64 2072  tion table and r
+00024900: 6574 7572 6e73 2074 6865 2063 6f72 7265  eturns the corre
+00024910: 7370 6f6e 6469 6e67 0a20 2020 203a 636c  sponding.    :cl
+00024920: 6173 733a 604d 6967 7261 7469 6f6e 5461  ass:`MigrationTa
+00024930: 626c 6560 2069 6e73 7461 6e63 652e 0a0a  ble` instance...
+00024940: 2020 2020 5365 6520 7468 6520 3a72 6566      See the :ref
+00024950: 3a60 6d69 6772 6174 696f 6e20 7465 7874  :`migration text
+00024960: 2066 6f72 6d61 7420 3c73 6563 5f6d 6967   format <sec_mig
+00024970: 7261 7469 6f6e 5f74 6578 745f 666f 726d  ration_text_form
+00024980: 6174 3e60 2073 6563 7469 6f6e 0a20 2020  at>` section.   
+00024990: 2066 6f72 2074 6865 2064 6574 6169 6c73   for the details
+000249a0: 206f 6620 7468 6520 7265 7175 6972 6564   of the required
+000249b0: 2066 6f72 6d61 7420 616e 6420 7468 650a   format and the.
+000249c0: 2020 2020 3a72 6566 3a60 6d69 6772 6174      :ref:`migrat
+000249d0: 696f 6e20 7461 626c 6520 6465 6669 6e69  ion table defini
+000249e0: 7469 6f6e 203c 7365 635f 6d69 6772 6174  tion <sec_migrat
+000249f0: 696f 6e5f 7461 626c 655f 6465 6669 6e69  ion_table_defini
+00024a00: 7469 6f6e 3e60 2073 6563 7469 6f6e 0a20  tion>` section. 
+00024a10: 2020 2066 6f72 2074 6865 2072 6571 7569     for the requi
+00024a20: 7265 6420 7072 6f70 6572 7469 6573 206f  red properties o
+00024a30: 6620 7468 6520 636f 6e74 656e 7473 2e20  f the contents. 
+00024a40: 4e6f 7465 2074 6861 7420 6966 2074 6865  Note that if the
+00024a50: 2060 6074 696d 6560 6020 636f 6c75 6d6e   ``time`` column
+00024a60: 0a20 2020 2069 7320 6d69 7373 696e 6720  .    is missing 
+00024a70: 6974 7320 656e 7472 6965 7320 6172 6520  its entries are 
+00024a80: 6669 6c6c 6564 2077 6974 6820 3a64 6174  filled with :dat
+00024a90: 613a 6055 4e4b 4e4f 574e 5f54 494d 4560  a:`UNKNOWN_TIME`
+00024aa0: 2e0a 0a20 2020 2053 6565 203a 6675 6e63  ...    See :func
+00024ab0: 3a60 7473 6b69 742e 6c6f 6164 5f74 6578  :`tskit.load_tex
+00024ac0: 7460 2066 6f72 2061 2064 6574 6169 6c65  t` for a detaile
+00024ad0: 6420 6578 706c 616e 6174 696f 6e20 6f66  d explanation of
+00024ae0: 2074 6865 2060 6073 7472 6963 7460 600a   the ``strict``.
+00024af0: 2020 2020 7061 7261 6d65 7465 722e 0a0a      parameter...
+00024b00: 2020 2020 3a70 6172 616d 2069 6f2e 5465      :param io.Te
+00024b10: 7874 494f 4261 7365 2073 6f75 7263 653a  xtIOBase source:
+00024b20: 2054 6865 2066 696c 652d 6c69 6b65 206f   The file-like o
+00024b30: 626a 6563 7420 636f 6e74 6169 6e69 6e67  bject containing
+00024b40: 2074 6865 2074 6578 742e 0a20 2020 203a   the text..    :
+00024b50: 7061 7261 6d20 626f 6f6c 2073 7472 6963  param bool stric
+00024b60: 743a 2049 6620 5472 7565 2c20 7265 7175  t: If True, requ
+00024b70: 6972 6520 7374 7269 6374 2074 6162 2064  ire strict tab d
+00024b80: 656c 696d 6974 696e 6720 2864 6566 6175  elimiting (defau
+00024b90: 6c74 292e 2049 660a 2020 2020 2020 2020  lt). If.        
+00024ba0: 4661 6c73 652c 2061 2072 656c 6178 6564  False, a relaxed
+00024bb0: 2077 6869 7465 7370 6163 6520 7370 6c69   whitespace spli
+00024bc0: 7474 696e 6720 616c 676f 7269 7468 6d20  tting algorithm 
+00024bd0: 6973 2075 7365 642e 0a20 2020 203a 7061  is used..    :pa
+00024be0: 7261 6d20 7374 7220 656e 636f 6469 6e67  ram str encoding
+00024bf0: 3a20 456e 636f 6469 6e67 2075 7365 6420  : Encoding used 
+00024c00: 666f 7220 7465 7874 2072 6570 7265 7365  for text represe
+00024c10: 6e74 6174 696f 6e2e 0a20 2020 203a 7061  ntation..    :pa
+00024c20: 7261 6d20 626f 6f6c 2062 6173 6536 345f  ram bool base64_
+00024c30: 6d65 7461 6461 7461 3a20 4966 2054 7275  metadata: If Tru
+00024c40: 652c 206d 6574 6164 6174 6120 6973 2065  e, metadata is e
+00024c50: 6e63 6f64 6564 2075 7369 6e67 2042 6173  ncoded using Bas
+00024c60: 6536 340a 2020 2020 2020 2020 656e 636f  e64.        enco
+00024c70: 6469 6e67 3b20 6f74 6865 7277 6973 652c  ding; otherwise,
+00024c80: 2061 7320 706c 6169 6e20 7465 7874 2e0a   as plain text..
+00024c90: 2020 2020 3a70 6172 616d 204d 6967 7261      :param Migra
+00024ca0: 7469 6f6e 5461 626c 6520 7461 626c 653a  tionTable table:
+00024cb0: 2049 6620 7370 6563 6966 6965 642c 2077   If specified, w
+00024cc0: 7269 7465 206d 6967 7261 7469 6f6e 7320  rite migrations 
+00024cd0: 696e 746f 2074 6869 7320 7461 626c 652e  into this table.
+00024ce0: 0a20 2020 2020 2020 2049 6620 6e6f 742c  .        If not,
+00024cf0: 2063 7265 6174 6520 6120 6e65 7720 3a63   create a new :c
+00024d00: 6c61 7373 3a60 4d69 6772 6174 696f 6e54  lass:`MigrationT
+00024d10: 6162 6c65 6020 696e 7374 616e 6365 2e0a  able` instance..
+00024d20: 2020 2020 2222 220a 2020 2020 7365 7020      """.    sep 
+00024d30: 3d20 4e6f 6e65 0a20 2020 2069 6620 7374  = None.    if st
+00024d40: 7269 6374 3a0a 2020 2020 2020 2020 7365  rict:.        se
+00024d50: 7020 3d20 225c 7422 0a20 2020 2069 6620  p = "\t".    if 
+00024d60: 7461 626c 6520 6973 204e 6f6e 653a 0a20  table is None:. 
+00024d70: 2020 2020 2020 2074 6162 6c65 203d 2074         table = t
+00024d80: 6162 6c65 732e 4d69 6772 6174 696f 6e54  ables.MigrationT
+00024d90: 6162 6c65 2829 0a20 2020 2068 6561 6465  able().    heade
+00024da0: 7220 3d20 736f 7572 6365 2e72 6561 646c  r = source.readl
+00024db0: 696e 6528 292e 7273 7472 6970 2822 5c6e  ine().rstrip("\n
+00024dc0: 2229 2e73 706c 6974 2873 6570 290a 2020  ").split(sep).  
+00024dd0: 2020 6c65 6674 5f69 6e64 6578 203d 2068    left_index = h
+00024de0: 6561 6465 722e 696e 6465 7828 226c 6566  eader.index("lef
+00024df0: 7422 290a 2020 2020 7269 6768 745f 696e  t").    right_in
+00024e00: 6465 7820 3d20 6865 6164 6572 2e69 6e64  dex = header.ind
+00024e10: 6578 2822 7269 6768 7422 290a 2020 2020  ex("right").    
+00024e20: 6e6f 6465 5f69 6e64 6578 203d 2068 6561  node_index = hea
+00024e30: 6465 722e 696e 6465 7828 226e 6f64 6522  der.index("node"
+00024e40: 290a 2020 2020 736f 7572 6365 5f69 6e64  ).    source_ind
+00024e50: 6578 203d 2068 6561 6465 722e 696e 6465  ex = header.inde
+00024e60: 7828 2273 6f75 7263 6522 290a 2020 2020  x("source").    
+00024e70: 6465 7374 5f69 6e64 6578 203d 2068 6561  dest_index = hea
+00024e80: 6465 722e 696e 6465 7828 2264 6573 7422  der.index("dest"
+00024e90: 290a 2020 2020 7469 6d65 5f69 6e64 6578  ).    time_index
+00024ea0: 203d 2068 6561 6465 722e 696e 6465 7828   = header.index(
+00024eb0: 2274 696d 6522 290a 2020 2020 6d65 7461  "time").    meta
+00024ec0: 6461 7461 5f69 6e64 6578 203d 204e 6f6e  data_index = Non
+00024ed0: 650a 2020 2020 7472 793a 0a20 2020 2020  e.    try:.     
+00024ee0: 2020 206d 6574 6164 6174 615f 696e 6465     metadata_inde
+00024ef0: 7820 3d20 6865 6164 6572 2e69 6e64 6578  x = header.index
+00024f00: 2822 6d65 7461 6461 7461 2229 0a20 2020  ("metadata").   
+00024f10: 2065 7863 6570 7420 5661 6c75 6545 7272   except ValueErr
+00024f20: 6f72 3a0a 2020 2020 2020 2020 7061 7373  or:.        pass
+00024f30: 0a20 2020 2066 6f72 206c 696e 6520 696e  .    for line in
+00024f40: 2073 6f75 7263 653a 0a20 2020 2020 2020   source:.       
+00024f50: 2074 6f6b 656e 7320 3d20 6c69 6e65 2e72   tokens = line.r
+00024f60: 7374 7269 7028 225c 6e22 292e 7370 6c69  strip("\n").spli
+00024f70: 7428 7365 7029 0a20 2020 2020 2020 2069  t(sep).        i
+00024f80: 6620 6c65 6e28 746f 6b65 6e73 2920 3e3d  f len(tokens) >=
+00024f90: 2036 3a0a 2020 2020 2020 2020 2020 2020   6:.            
+00024fa0: 6c65 6674 203d 2066 6c6f 6174 2874 6f6b  left = float(tok
+00024fb0: 656e 735b 6c65 6674 5f69 6e64 6578 5d29  ens[left_index])
+00024fc0: 0a20 2020 2020 2020 2020 2020 2072 6967  .            rig
+00024fd0: 6874 203d 2066 6c6f 6174 2874 6f6b 656e  ht = float(token
+00024fe0: 735b 7269 6768 745f 696e 6465 785d 290a  s[right_index]).
+00024ff0: 2020 2020 2020 2020 2020 2020 6e6f 6465              node
+00025000: 203d 2069 6e74 2874 6f6b 656e 735b 6e6f   = int(tokens[no
+00025010: 6465 5f69 6e64 6578 5d29 0a20 2020 2020  de_index]).     
+00025020: 2020 2020 2020 2073 6f75 7263 6520 3d20         source = 
+00025030: 696e 7428 746f 6b65 6e73 5b73 6f75 7263  int(tokens[sourc
+00025040: 655f 696e 6465 785d 290a 2020 2020 2020  e_index]).      
+00025050: 2020 2020 2020 6465 7374 203d 2069 6e74        dest = int
+00025060: 2874 6f6b 656e 735b 6465 7374 5f69 6e64  (tokens[dest_ind
+00025070: 6578 5d29 0a20 2020 2020 2020 2020 2020  ex]).           
+00025080: 2074 696d 6520 3d20 666c 6f61 7428 746f   time = float(to
+00025090: 6b65 6e73 5b74 696d 655f 696e 6465 785d  kens[time_index]
+000250a0: 290a 2020 2020 2020 2020 2020 2020 6d65  ).            me
+000250b0: 7461 6461 7461 203d 2062 2222 0a20 2020  tadata = b"".   
+000250c0: 2020 2020 2020 2020 2069 6620 6d65 7461           if meta
+000250d0: 6461 7461 5f69 6e64 6578 2069 7320 6e6f  data_index is no
+000250e0: 7420 4e6f 6e65 2061 6e64 206d 6574 6164  t None and metad
+000250f0: 6174 615f 696e 6465 7820 3c20 6c65 6e28  ata_index < len(
+00025100: 746f 6b65 6e73 293a 0a20 2020 2020 2020  tokens):.       
+00025110: 2020 2020 2020 2020 206d 6574 6164 6174           metadat
+00025120: 6120 3d20 746f 6b65 6e73 5b6d 6574 6164  a = tokens[metad
+00025130: 6174 615f 696e 6465 785d 2e65 6e63 6f64  ata_index].encod
+00025140: 6528 656e 636f 6469 6e67 290a 2020 2020  e(encoding).    
+00025150: 2020 2020 2020 2020 2020 2020 6966 2062              if b
+00025160: 6173 6536 345f 6d65 7461 6461 7461 3a0a  ase64_metadata:.
+00025170: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00025180: 2020 2020 6d65 7461 6461 7461 203d 2062      metadata = b
+00025190: 6173 6536 342e 6236 3464 6563 6f64 6528  ase64.b64decode(
+000251a0: 6d65 7461 6461 7461 290a 2020 2020 2020  metadata).      
+000251b0: 2020 2020 2020 7461 626c 652e 6164 645f        table.add_
+000251c0: 726f 7728 0a20 2020 2020 2020 2020 2020  row(.           
+000251d0: 2020 2020 206c 6566 743d 6c65 6674 2c0a       left=left,.
+000251e0: 2020 2020 2020 2020 2020 2020 2020 2020                  
+000251f0: 7269 6768 743d 7269 6768 742c 0a20 2020  right=right,.   
+00025200: 2020 2020 2020 2020 2020 2020 206e 6f64               nod
+00025210: 653d 6e6f 6465 2c0a 2020 2020 2020 2020  e=node,.        
+00025220: 2020 2020 2020 2020 736f 7572 6365 3d73          source=s
+00025230: 6f75 7263 652c 0a20 2020 2020 2020 2020  ource,.         
+00025240: 2020 2020 2020 2064 6573 743d 6465 7374         dest=dest
+00025250: 2c0a 2020 2020 2020 2020 2020 2020 2020  ,.              
+00025260: 2020 7469 6d65 3d74 696d 652c 0a20 2020    time=time,.   
+00025270: 2020 2020 2020 2020 2020 2020 206d 6574               met
+00025280: 6164 6174 613d 6d65 7461 6461 7461 2c0a  adata=metadata,.
+00025290: 2020 2020 2020 2020 2020 2020 290a 2020              ).  
+000252a0: 2020 7265 7475 726e 2074 6162 6c65 0a0a    return table..
+000252b0: 0a64 6566 206c 6f61 645f 7465 7874 280a  .def load_text(.
+000252c0: 2020 2020 6e6f 6465 732c 0a20 2020 2065      nodes,.    e
+000252d0: 6467 6573 2c0a 2020 2020 7369 7465 733d  dges,.    sites=
+000252e0: 4e6f 6e65 2c0a 2020 2020 6d75 7461 7469  None,.    mutati
+000252f0: 6f6e 733d 4e6f 6e65 2c0a 2020 2020 696e  ons=None,.    in
+00025300: 6469 7669 6475 616c 733d 4e6f 6e65 2c0a  dividuals=None,.
+00025310: 2020 2020 706f 7075 6c61 7469 6f6e 733d      populations=
+00025320: 4e6f 6e65 2c0a 2020 2020 6d69 6772 6174  None,.    migrat
+00025330: 696f 6e73 3d4e 6f6e 652c 0a20 2020 2073  ions=None,.    s
+00025340: 6571 7565 6e63 655f 6c65 6e67 7468 3d30  equence_length=0
+00025350: 2c0a 2020 2020 7374 7269 6374 3d54 7275  ,.    strict=Tru
+00025360: 652c 0a20 2020 2065 6e63 6f64 696e 673d  e,.    encoding=
+00025370: 2275 7466 3822 2c0a 2020 2020 6261 7365  "utf8",.    base
+00025380: 3634 5f6d 6574 6164 6174 613d 5472 7565  64_metadata=True
+00025390: 2c0a 293a 0a20 2020 2022 2222 0a20 2020  ,.):.    """.   
+000253a0: 2052 6574 7572 6e20 6120 3a63 6c61 7373   Return a :class
+000253b0: 3a60 5472 6565 5365 7175 656e 6365 6020  :`TreeSequence` 
+000253c0: 696e 7374 616e 6365 2070 6172 7365 6420  instance parsed 
+000253d0: 6672 6f6d 2074 6162 756c 6174 6564 2074  from tabulated t
+000253e0: 6578 7420 6461 7461 0a20 2020 2063 6f6e  ext data.    con
+000253f0: 7461 696e 6564 2069 6e20 7468 6520 7370  tained in the sp
+00025400: 6563 6966 6965 6420 6669 6c65 2d6c 696b  ecified file-lik
+00025410: 6520 6f62 6a65 6374 732e 2054 6865 2066  e objects. The f
+00025420: 6f72 6d61 740a 2020 2020 666f 7220 7468  ormat.    for th
+00025430: 6573 6520 6669 6c65 7320 6973 2064 6f63  ese files is doc
+00025440: 756d 656e 7465 6420 696e 2074 6865 203a  umented in the :
+00025450: 7265 663a 6073 6563 5f74 6578 745f 6669  ref:`sec_text_fi
+00025460: 6c65 5f66 6f72 6d61 7460 2073 6563 7469  le_format` secti
+00025470: 6f6e 2c0a 2020 2020 616e 6420 6973 2070  on,.    and is p
+00025480: 726f 6475 6365 6420 6279 2074 6865 203a  roduced by the :
+00025490: 6d65 7468 3a60 5472 6565 5365 7175 656e  meth:`TreeSequen
+000254a0: 6365 2e64 756d 705f 7465 7874 6020 6d65  ce.dump_text` me
+000254b0: 7468 6f64 2e20 4675 7274 6865 720a 2020  thod. Further.  
+000254c0: 2020 7072 6f70 6572 7469 6573 2072 6571    properties req
+000254d0: 7569 7265 6420 666f 7220 616e 2069 6e70  uired for an inp
+000254e0: 7574 2074 7265 6520 7365 7175 656e 6365  ut tree sequence
+000254f0: 2061 7265 2064 6573 6372 6962 6564 2069   are described i
+00025500: 6e20 7468 650a 2020 2020 3a72 6566 3a60  n the.    :ref:`
+00025510: 7365 635f 7661 6c69 645f 7472 6565 5f73  sec_valid_tree_s
+00025520: 6571 7565 6e63 655f 7265 7175 6972 656d  equence_requirem
+00025530: 656e 7473 6020 7365 6374 696f 6e2e 2054  ents` section. T
+00025540: 6869 7320 6d65 7468 6f64 2069 7320 696e  his method is in
+00025550: 7465 6e64 6564 2061 7320 610a 2020 2020  tended as a.    
+00025560: 636f 6e76 656e 6965 6e74 2069 6e74 6572  convenient inter
+00025570: 6661 6365 2066 6f72 2069 6d70 6f72 7469  face for importi
+00025580: 6e67 2065 7874 6572 6e61 6c20 6461 7461  ng external data
+00025590: 2069 6e74 6f20 7473 6b69 743b 2074 6865   into tskit; the
+000255a0: 2062 696e 6172 790a 2020 2020 6669 6c65   binary.    file
+000255b0: 2066 6f72 6d61 7420 7573 696e 6720 6279   format using by
+000255c0: 203a 6d65 7468 3a60 7473 6b69 742e 6c6f   :meth:`tskit.lo
+000255d0: 6164 6020 6973 206d 616e 7920 7469 6d65  ad` is many time
+000255e0: 7320 6d6f 7265 2065 6666 6963 6965 6e74  s more efficient
+000255f0: 2074 6861 6e0a 2020 2020 7468 6973 2074   than.    this t
+00025600: 6578 7420 666f 726d 6174 2e0a 0a20 2020  ext format...   
+00025610: 2054 6865 2060 606e 6f64 6573 6060 2061   The ``nodes`` a
+00025620: 6e64 2060 6065 6467 6573 6060 2070 6172  nd ``edges`` par
+00025630: 616d 6574 6572 7320 6172 6520 6d61 6e64  ameters are mand
+00025640: 6174 6f72 7920 616e 6420 6d75 7374 2062  atory and must b
+00025650: 6520 6669 6c65 2d6c 696b 650a 2020 2020  e file-like.    
+00025660: 6f62 6a65 6374 7320 636f 6e74 6169 6e69  objects containi
+00025670: 6e67 2074 6578 7420 7769 7468 2077 6869  ng text with whi
+00025680: 7465 7370 6163 6520 6465 6c69 6d69 7465  tespace delimite
+00025690: 6420 636f 6c75 6d6e 732c 2020 7061 7273  d columns,  pars
+000256a0: 6162 6c65 2062 790a 2020 2020 3a66 756e  able by.    :fun
+000256b0: 633a 6070 6172 7365 5f6e 6f64 6573 6020  c:`parse_nodes` 
+000256c0: 616e 6420 3a66 756e 633a 6070 6172 7365  and :func:`parse
+000256d0: 5f65 6467 6573 602c 2072 6573 7065 6374  _edges`, respect
+000256e0: 6976 656c 792e 2060 6073 6974 6573 6060  ively. ``sites``
+000256f0: 2c0a 2020 2020 6060 696e 6469 7669 6475  ,.    ``individu
+00025700: 616c 7360 602c 2060 6070 6f70 756c 6174  als``, ``populat
+00025710: 696f 6e73 6060 2c20 6060 6d75 7461 7469  ions``, ``mutati
+00025720: 6f6e 7360 602c 2061 6e64 2060 606d 6967  ons``, and ``mig
+00025730: 7261 7469 6f6e 7360 6020 6172 6520 6f70  rations`` are op
+00025740: 7469 6f6e 616c 2c0a 2020 2020 616e 6420  tional,.    and 
+00025750: 6d75 7374 2062 6520 7061 7273 6162 6c65  must be parsable
+00025760: 2062 7920 3a66 756e 633a 6070 6172 7365   by :func:`parse
+00025770: 5f73 6974 6573 602c 203a 6675 6e63 3a60  _sites`, :func:`
+00025780: 7061 7273 655f 696e 6469 7669 6475 616c  parse_individual
+00025790: 7360 2c0a 2020 2020 3a66 756e 633a 6070  s`,.    :func:`p
+000257a0: 6172 7365 5f70 6f70 756c 6174 696f 6e73  arse_populations
+000257b0: 602c 203a 6675 6e63 3a60 7061 7273 655f  `, :func:`parse_
+000257c0: 6d75 7461 7469 6f6e 7360 2c20 616e 6420  mutations`, and 
+000257d0: 3a66 756e 633a 6070 6172 7365 5f6d 6967  :func:`parse_mig
+000257e0: 7261 7469 6f6e 7360 2c0a 2020 2020 7265  rations`,.    re
+000257f0: 7370 6563 7469 7665 6c79 2e20 466f 7220  spectively. For 
+00025800: 636f 6e76 656e 6965 6e63 652c 2069 6620  convenience, if 
+00025810: 7468 6520 6e6f 6465 2074 6162 6c65 2072  the node table r
+00025820: 6566 6572 7320 746f 2070 6f70 756c 6174  efers to populat
+00025830: 696f 6e73 2c0a 2020 2020 6275 7420 7468  ions,.    but th
+00025840: 6520 6060 706f 7075 6c61 7469 6f6e 7360  e ``populations`
+00025850: 6020 7061 7261 6d65 7465 7220 6973 206e  ` parameter is n
+00025860: 6f74 2070 726f 7669 6465 642c 2061 206d  ot provided, a m
+00025870: 696e 696d 616c 2073 6574 206f 6620 726f  inimal set of ro
+00025880: 7773 2061 7265 0a20 2020 2061 6464 6564  ws are.    added
+00025890: 2074 6f20 7468 6520 706f 7075 6c61 7469   to the populati
+000258a0: 6f6e 2074 6162 6c65 2c20 736f 2074 6861  on table, so tha
+000258b0: 7420 6120 7661 6c69 6420 7472 6565 2073  t a valid tree s
+000258c0: 6571 7565 6e63 6520 6361 6e20 6265 2072  equence can be r
+000258d0: 6574 7572 6e65 642e 0a0a 2020 2020 5468  eturned...    Th
+000258e0: 6520 6060 7365 7175 656e 6365 5f6c 656e  e ``sequence_len
+000258f0: 6774 6860 6020 7061 7261 6d65 7465 7220  gth`` parameter 
+00025900: 6465 7465 726d 696e 6573 2074 6865 0a20  determines the. 
+00025910: 2020 203a 6174 7472 3a60 5472 6565 5365     :attr:`TreeSe
+00025920: 7175 656e 6365 2e73 6571 7565 6e63 655f  quence.sequence_
+00025930: 6c65 6e67 7468 6020 6f66 2074 6865 2072  length` of the r
+00025940: 6574 7572 6e65 6420 7472 6565 2073 6571  eturned tree seq
+00025950: 7565 6e63 652e 2049 6620 6974 0a20 2020  uence. If it.   
+00025960: 2069 7320 3020 6f72 206e 6f74 2073 7065   is 0 or not spe
+00025970: 6369 6669 6564 2c20 7468 6520 7661 6c75  cified, the valu
+00025980: 6520 6973 2074 616b 656e 2074 6f20 6265  e is taken to be
+00025990: 2074 6865 206d 6178 696d 756d 2072 6967   the maximum rig
+000259a0: 6874 0a20 2020 2063 6f6f 7264 696e 6174  ht.    coordinat
+000259b0: 6520 6f66 2074 6865 2069 6e70 7574 2065  e of the input e
+000259c0: 6467 6573 2e20 5468 6973 2070 6172 616d  dges. This param
+000259d0: 6574 6572 2069 7320 7573 6566 756c 2069  eter is useful i
+000259e0: 6e20 6465 6765 6e65 7261 7465 0a20 2020  n degenerate.   
+000259f0: 2073 6974 7561 7469 6f6e 7320 2873 7563   situations (suc
+00025a00: 6820 6173 2077 6865 6e20 7468 6572 6520  h as when there 
+00025a10: 6172 6520 7a65 726f 2065 6467 6573 292c  are zero edges),
+00025a20: 2062 7574 2063 616e 2075 7375 616c 6c79   but can usually
+00025a30: 2062 6520 6967 6e6f 7265 642e 0a0a 2020   be ignored...  
+00025a40: 2020 5468 6520 6060 7374 7269 6374 6060    The ``strict``
+00025a50: 2070 6172 616d 6574 6572 2063 6f6e 7472   parameter contr
+00025a60: 6f6c 7320 7468 6520 6669 656c 6420 6465  ols the field de
+00025a70: 6c69 6d69 7469 6e67 2061 6c67 6f72 6974  limiting algorit
+00025a80: 686d 2074 6861 740a 2020 2020 6973 2075  hm that.    is u
+00025a90: 7365 642e 2049 6620 6060 7374 7269 6374  sed. If ``strict
+00025aa0: 6060 2069 7320 5472 7565 2028 7468 6520  `` is True (the 
+00025ab0: 6465 6661 756c 7429 2c20 7765 2072 6571  default), we req
+00025ac0: 7569 7265 2065 7861 6374 6c79 206f 6e65  uire exactly one
+00025ad0: 0a20 2020 2074 6162 2063 6861 7261 6374  .    tab charact
+00025ae0: 6572 2073 6570 6172 6174 696e 6720 6561  er separating ea
+00025af0: 6368 2066 6965 6c64 2e20 4966 2060 6073  ch field. If ``s
+00025b00: 7472 6963 7460 6020 6973 2046 616c 7365  trict`` is False
+00025b10: 2c20 6120 6d6f 7265 2072 656c 6178 6564  , a more relaxed
+00025b20: 0a20 2020 2077 6869 7465 7370 6163 6520  .    whitespace 
+00025b30: 6465 6c69 6d69 7469 6e67 2061 6c67 6f72  delimiting algor
+00025b40: 6974 686d 2069 7320 7573 6564 2c20 7375  ithm is used, su
+00025b50: 6368 2074 6861 7420 616e 7920 7275 6e20  ch that any run 
+00025b60: 6f66 2077 6869 7465 7370 6163 650a 2020  of whitespace.  
+00025b70: 2020 6973 2072 6567 6172 6465 6420 6173    is regarded as
+00025b80: 2061 2066 6965 6c64 2073 6570 6172 6174   a field separat
+00025b90: 6f72 2e20 496e 206d 6f73 7420 7369 7475  or. In most situ
+00025ba0: 6174 696f 6e73 2c20 6060 7374 7269 6374  ations, ``strict
+00025bb0: 3d46 616c 7365 6060 0a20 2020 2069 7320  =False``.    is 
+00025bc0: 6d6f 7265 2063 6f6e 7665 6e69 656e 742c  more convenient,
+00025bd0: 2062 7574 2069 7420 6361 6e20 6c65 6164   but it can lead
+00025be0: 2074 6f20 6572 726f 7220 696e 2063 6572   to error in cer
+00025bf0: 7461 696e 2073 6974 7561 7469 6f6e 732e  tain situations.
+00025c00: 2046 6f72 0a20 2020 2065 7861 6d70 6c65   For.    example
+00025c10: 2c20 6966 2061 2064 656c 6574 696f 6e20  , if a deletion 
+00025c20: 6973 2065 6e63 6f64 6564 2069 6e20 7468  is encoded in th
+00025c30: 6520 6d75 7461 7469 6f6e 2074 6162 6c65  e mutation table
+00025c40: 2074 6869 7320 7769 6c6c 206e 6f74 0a20   this will not. 
+00025c50: 2020 2062 6520 7061 7273 6561 626c 6520     be parseable 
+00025c60: 7768 656e 2060 6073 7472 6963 743d 4661  when ``strict=Fa
+00025c70: 6c73 6560 602e 0a0a 2020 2020 4166 7465  lse``...    Afte
+00025c80: 7220 7061 7273 696e 6720 7468 6520 7461  r parsing the ta
+00025c90: 626c 6573 2c20 3a6d 6574 683a 6054 6162  bles, :meth:`Tab
+00025ca0: 6c65 436f 6c6c 6563 7469 6f6e 2e73 6f72  leCollection.sor
+00025cb0: 7460 2069 7320 6361 6c6c 6564 2074 6f20  t` is called to 
+00025cc0: 656e 7375 7265 2074 6861 740a 2020 2020  ensure that.    
+00025cd0: 7468 6520 6c6f 6164 6564 2074 6162 6c65  the loaded table
+00025ce0: 7320 7361 7469 7366 7920 7468 6520 7472  s satisfy the tr
+00025cf0: 6565 2073 6571 7565 6e63 6520 3a72 6566  ee sequence :ref
+00025d00: 3a60 6f72 6465 7269 6e67 2072 6571 7569  :`ordering requi
+00025d10: 7265 6d65 6e74 730a 2020 2020 3c73 6563  rements.    <sec
+00025d20: 5f76 616c 6964 5f74 7265 655f 7365 7175  _valid_tree_sequ
+00025d30: 656e 6365 5f72 6571 7569 7265 6d65 6e74  ence_requirement
+00025d40: 733e 602e 204e 6f74 6520 7468 6174 2074  s>`. Note that t
+00025d50: 6869 7320 6d61 7920 7265 7375 6c74 2069  his may result i
+00025d60: 6e20 7468 650a 2020 2020 4944 7320 6f66  n the.    IDs of
+00025d70: 2076 6172 696f 7573 2065 6e74 6974 6965   various entitie
+00025d80: 7320 6368 616e 6769 6e67 2066 726f 6d20  s changing from 
+00025d90: 7468 6569 7220 706f 7369 7469 6f6e 7320  their positions 
+00025da0: 696e 2074 6865 2069 6e70 7574 2066 696c  in the input fil
+00025db0: 652e 0a0a 2020 2020 3a70 6172 616d 2069  e...    :param i
+00025dc0: 6f2e 5465 7874 494f 4261 7365 206e 6f64  o.TextIOBase nod
+00025dd0: 6573 3a20 5468 6520 6669 6c65 2d6c 696b  es: The file-lik
+00025de0: 6520 6f62 6a65 6374 2063 6f6e 7461 696e  e object contain
+00025df0: 696e 6720 7465 7874 2064 6573 6372 6962  ing text describ
+00025e00: 696e 6720 610a 2020 2020 2020 2020 3a63  ing a.        :c
+00025e10: 6c61 7373 3a60 4e6f 6465 5461 626c 6560  lass:`NodeTable`
+00025e20: 2e0a 2020 2020 3a70 6172 616d 2069 6f2e  ..    :param io.
+00025e30: 5465 7874 494f 4261 7365 2065 6467 6573  TextIOBase edges
+00025e40: 3a20 5468 6520 6669 6c65 2d6c 696b 6520  : The file-like 
+00025e50: 6f62 6a65 6374 2063 6f6e 7461 696e 696e  object containin
+00025e60: 6720 7465 7874 0a20 2020 2020 2020 2064  g text.        d
+00025e70: 6573 6372 6962 696e 6720 616e 203a 636c  escribing an :cl
+00025e80: 6173 733a 6045 6467 6554 6162 6c65 602e  ass:`EdgeTable`.
+00025e90: 0a20 2020 203a 7061 7261 6d20 696f 2e54  .    :param io.T
+00025ea0: 6578 7449 4f42 6173 6520 7369 7465 733a  extIOBase sites:
+00025eb0: 2054 6865 2066 696c 652d 6c69 6b65 206f   The file-like o
+00025ec0: 626a 6563 7420 636f 6e74 6169 6e69 6e67  bject containing
+00025ed0: 2074 6578 7420 6465 7363 7269 6269 6e67   text describing
+00025ee0: 2061 0a20 2020 2020 2020 203a 636c 6173   a.        :clas
+00025ef0: 733a 6053 6974 6554 6162 6c65 602e 0a20  s:`SiteTable`.. 
+00025f00: 2020 203a 7061 7261 6d20 696f 2e54 6578     :param io.Tex
+00025f10: 7449 4f42 6173 6520 6d75 7461 7469 6f6e  tIOBase mutation
+00025f20: 733a 2054 6865 2066 696c 652d 6c69 6b65  s: The file-like
+00025f30: 206f 626a 6563 7420 636f 6e74 6169 6e69   object containi
+00025f40: 6e67 2074 6578 740a 2020 2020 2020 2020  ng text.        
+00025f50: 6465 7363 7269 6269 6e67 2061 203a 636c  describing a :cl
+00025f60: 6173 733a 604d 7574 6174 696f 6e54 6162  ass:`MutationTab
+00025f70: 6c65 602e 0a20 2020 203a 7061 7261 6d20  le`..    :param 
+00025f80: 696f 2e54 6578 7449 4f42 6173 6520 696e  io.TextIOBase in
+00025f90: 6469 7669 6475 616c 733a 2054 6865 2066  dividuals: The f
+00025fa0: 696c 652d 6c69 6b65 206f 626a 6563 7420  ile-like object 
+00025fb0: 636f 6e74 6169 6e69 6e67 2074 6578 740a  containing text.
+00025fc0: 2020 2020 2020 2020 6465 7363 7269 6269          describi
+00025fd0: 6e67 2061 203a 636c 6173 733a 6049 6e64  ng a :class:`Ind
+00025fe0: 6976 6964 7561 6c54 6162 6c65 602e 0a20  ividualTable`.. 
+00025ff0: 2020 203a 7061 7261 6d20 696f 2e54 6578     :param io.Tex
+00026000: 7449 4f42 6173 6520 706f 7075 6c61 7469  tIOBase populati
+00026010: 6f6e 733a 2054 6865 2066 696c 652d 6c69  ons: The file-li
+00026020: 6b65 206f 626a 6563 7420 636f 6e74 6169  ke object contai
+00026030: 6e69 6e67 2074 6578 740a 2020 2020 2020  ning text.      
+00026040: 2020 6465 7363 7269 6269 6e67 2061 203a    describing a :
+00026050: 636c 6173 733a 6050 6f70 756c 6174 696f  class:`Populatio
+00026060: 6e54 6162 6c65 602e 0a20 2020 203a 7061  nTable`..    :pa
+00026070: 7261 6d20 696f 2e54 6578 7449 4f42 6173  ram io.TextIOBas
+00026080: 6520 6d69 6772 6174 696f 6e73 3a20 5468  e migrations: Th
+00026090: 6520 6669 6c65 2d6c 696b 6520 6f62 6a65  e file-like obje
+000260a0: 6374 2063 6f6e 7461 696e 696e 6720 7465  ct containing te
+000260b0: 7874 0a20 2020 2020 2020 2064 6573 6372  xt.        descr
+000260c0: 6962 696e 6720 6120 3a63 6c61 7373 3a60  ibing a :class:`
+000260d0: 4d69 6772 6174 696f 6e54 6162 6c65 602e  MigrationTable`.
+000260e0: 0a20 2020 203a 7061 7261 6d20 666c 6f61  .    :param floa
+000260f0: 7420 7365 7175 656e 6365 5f6c 656e 6774  t sequence_lengt
+00026100: 683a 2054 6865 2073 6571 7565 6e63 6520  h: The sequence 
+00026110: 6c65 6e67 7468 206f 6620 7468 6520 7265  length of the re
+00026120: 7475 726e 6564 2074 7265 6520 7365 7175  turned tree sequ
+00026130: 656e 6365 2e20 4966 0a20 2020 2020 2020  ence. If.       
+00026140: 206e 6f74 2073 7570 706c 6965 6420 6f72   not supplied or
+00026150: 207a 6572 6f20 7468 6973 2077 696c 6c20   zero this will 
+00026160: 6265 2069 6e66 6572 7265 6420 6672 6f6d  be inferred from
+00026170: 2074 6865 2073 6574 206f 6620 6564 6765   the set of edge
+00026180: 732e 0a20 2020 203a 7061 7261 6d20 626f  s..    :param bo
+00026190: 6f6c 2073 7472 6963 743a 2049 6620 5472  ol strict: If Tr
+000261a0: 7565 2c20 7265 7175 6972 6520 7374 7269  ue, require stri
+000261b0: 6374 2074 6162 2064 656c 696d 6974 696e  ct tab delimitin
+000261c0: 6720 2864 6566 6175 6c74 292e 2049 660a  g (default). If.
+000261d0: 2020 2020 2020 2020 4661 6c73 652c 2061          False, a
+000261e0: 2072 656c 6178 6564 2077 6869 7465 7370   relaxed whitesp
+000261f0: 6163 6520 7370 6c69 7474 696e 6720 616c  ace splitting al
+00026200: 676f 7269 7468 6d20 6973 2075 7365 642e  gorithm is used.
+00026210: 0a20 2020 203a 7061 7261 6d20 7374 7220  .    :param str 
+00026220: 656e 636f 6469 6e67 3a20 456e 636f 6469  encoding: Encodi
+00026230: 6e67 2075 7365 6420 666f 7220 7465 7874  ng used for text
+00026240: 2072 6570 7265 7365 6e74 6174 696f 6e2e   representation.
+00026250: 0a20 2020 203a 7061 7261 6d20 626f 6f6c  .    :param bool
+00026260: 2062 6173 6536 345f 6d65 7461 6461 7461   base64_metadata
+00026270: 3a20 4966 2054 7275 652c 206d 6574 6164  : If True, metad
+00026280: 6174 6120 6973 2065 6e63 6f64 6564 2075  ata is encoded u
+00026290: 7369 6e67 2042 6173 6536 340a 2020 2020  sing Base64.    
+000262a0: 2020 2020 656e 636f 6469 6e67 3b20 6f74      encoding; ot
+000262b0: 6865 7277 6973 652c 2061 7320 706c 6169  herwise, as plai
+000262c0: 6e20 7465 7874 2e0a 2020 2020 3a72 6574  n text..    :ret
+000262d0: 7572 6e3a 2054 6865 2074 7265 6520 7365  urn: The tree se
+000262e0: 7175 656e 6365 206f 626a 6563 7420 636f  quence object co
+000262f0: 6e74 6169 6e69 6e67 2074 6865 2069 6e66  ntaining the inf
+00026300: 6f72 6d61 7469 6f6e 0a20 2020 2020 2020  ormation.       
+00026310: 2073 746f 7265 6420 696e 2074 6865 2073   stored in the s
+00026320: 7065 6369 6669 6564 2066 696c 6520 7061  pecified file pa
+00026330: 7468 732e 0a20 2020 203a 7274 7970 653a  ths..    :rtype:
+00026340: 203a 636c 6173 733a 6074 736b 6974 2e54   :class:`tskit.T
+00026350: 7265 6553 6571 7565 6e63 6560 0a20 2020  reeSequence`.   
+00026360: 2022 2222 0a20 2020 2023 2057 6520 6e65   """.    # We ne
+00026370: 6564 2074 6f20 7061 7273 6520 7468 6520  ed to parse the 
+00026380: 6564 6765 7320 736f 2077 6520 6361 6e20  edges so we can 
+00026390: 6669 6775 7265 206f 7574 2074 6865 2073  figure out the s
+000263a0: 6571 7565 6e63 6520 6c65 6e67 7468 2c20  equence length, 
+000263b0: 616e 640a 2020 2020 2320 5461 626c 6543  and.    # TableC
+000263c0: 6f6c 6c65 6374 696f 6e2e 7365 7175 656e  ollection.sequen
+000263d0: 6365 5f6c 656e 6774 6820 6973 2069 6d6d  ce_length is imm
+000263e0: 7574 6162 6c65 2073 6f20 7765 206e 6565  utable so we nee
+000263f0: 6420 746f 2063 7265 6174 6520 6120 7465  d to create a te
+00026400: 6d70 6f72 6172 790a 2020 2020 2320 6564  mporary.    # ed
+00026410: 6765 2074 6162 6c65 2e0a 2020 2020 6564  ge table..    ed
+00026420: 6765 5f74 6162 6c65 203d 2070 6172 7365  ge_table = parse
+00026430: 5f65 6467 6573 2865 6467 6573 2c20 7374  _edges(edges, st
+00026440: 7269 6374 3d73 7472 6963 7429 0a20 2020  rict=strict).   
+00026450: 2069 6620 7365 7175 656e 6365 5f6c 656e   if sequence_len
+00026460: 6774 6820 3d3d 2030 2061 6e64 206c 656e  gth == 0 and len
+00026470: 2865 6467 655f 7461 626c 6529 203e 2030  (edge_table) > 0
+00026480: 3a0a 2020 2020 2020 2020 7365 7175 656e  :.        sequen
+00026490: 6365 5f6c 656e 6774 6820 3d20 6564 6765  ce_length = edge
+000264a0: 5f74 6162 6c65 2e72 6967 6874 2e6d 6178  _table.right.max
+000264b0: 2829 0a20 2020 2074 6320 3d20 7461 626c  ().    tc = tabl
+000264c0: 6573 2e54 6162 6c65 436f 6c6c 6563 7469  es.TableCollecti
+000264d0: 6f6e 2873 6571 7565 6e63 655f 6c65 6e67  on(sequence_leng
+000264e0: 7468 290a 2020 2020 7463 2e65 6467 6573  th).    tc.edges
+000264f0: 2e73 6574 5f63 6f6c 756d 6e73 280a 2020  .set_columns(.  
+00026500: 2020 2020 2020 6c65 6674 3d65 6467 655f        left=edge_
+00026510: 7461 626c 652e 6c65 6674 2c0a 2020 2020  table.left,.    
+00026520: 2020 2020 7269 6768 743d 6564 6765 5f74      right=edge_t
+00026530: 6162 6c65 2e72 6967 6874 2c0a 2020 2020  able.right,.    
+00026540: 2020 2020 7061 7265 6e74 3d65 6467 655f      parent=edge_
+00026550: 7461 626c 652e 7061 7265 6e74 2c0a 2020  table.parent,.  
+00026560: 2020 2020 2020 6368 696c 643d 6564 6765        child=edge
+00026570: 5f74 6162 6c65 2e63 6869 6c64 2c0a 2020  _table.child,.  
+00026580: 2020 290a 2020 2020 7061 7273 655f 6e6f    ).    parse_no
+00026590: 6465 7328 0a20 2020 2020 2020 206e 6f64  des(.        nod
+000265a0: 6573 2c0a 2020 2020 2020 2020 7374 7269  es,.        stri
+000265b0: 6374 3d73 7472 6963 742c 0a20 2020 2020  ct=strict,.     
+000265c0: 2020 2065 6e63 6f64 696e 673d 656e 636f     encoding=enco
+000265d0: 6469 6e67 2c0a 2020 2020 2020 2020 6261  ding,.        ba
+000265e0: 7365 3634 5f6d 6574 6164 6174 613d 6261  se64_metadata=ba
+000265f0: 7365 3634 5f6d 6574 6164 6174 612c 0a20  se64_metadata,. 
+00026600: 2020 2020 2020 2074 6162 6c65 3d74 632e         table=tc.
+00026610: 6e6f 6465 732c 0a20 2020 2029 0a20 2020  nodes,.    ).   
+00026620: 2069 6620 7369 7465 7320 6973 206e 6f74   if sites is not
+00026630: 204e 6f6e 653a 0a20 2020 2020 2020 2070   None:.        p
+00026640: 6172 7365 5f73 6974 6573 280a 2020 2020  arse_sites(.    
+00026650: 2020 2020 2020 2020 7369 7465 732c 0a20          sites,. 
+00026660: 2020 2020 2020 2020 2020 2073 7472 6963             stric
+00026670: 743d 7374 7269 6374 2c0a 2020 2020 2020  t=strict,.      
+00026680: 2020 2020 2020 656e 636f 6469 6e67 3d65        encoding=e
+00026690: 6e63 6f64 696e 672c 0a20 2020 2020 2020  ncoding,.       
+000266a0: 2020 2020 2062 6173 6536 345f 6d65 7461       base64_meta
+000266b0: 6461 7461 3d62 6173 6536 345f 6d65 7461  data=base64_meta
+000266c0: 6461 7461 2c0a 2020 2020 2020 2020 2020  data,.          
+000266d0: 2020 7461 626c 653d 7463 2e73 6974 6573    table=tc.sites
+000266e0: 2c0a 2020 2020 2020 2020 290a 2020 2020  ,.        ).    
+000266f0: 6966 206d 7574 6174 696f 6e73 2069 7320  if mutations is 
+00026700: 6e6f 7420 4e6f 6e65 3a0a 2020 2020 2020  not None:.      
+00026710: 2020 7061 7273 655f 6d75 7461 7469 6f6e    parse_mutation
+00026720: 7328 0a20 2020 2020 2020 2020 2020 206d  s(.            m
+00026730: 7574 6174 696f 6e73 2c0a 2020 2020 2020  utations,.      
+00026740: 2020 2020 2020 7374 7269 6374 3d73 7472        strict=str
+00026750: 6963 742c 0a20 2020 2020 2020 2020 2020  ict,.           
+00026760: 2065 6e63 6f64 696e 673d 656e 636f 6469   encoding=encodi
+00026770: 6e67 2c0a 2020 2020 2020 2020 2020 2020  ng,.            
+00026780: 6261 7365 3634 5f6d 6574 6164 6174 613d  base64_metadata=
+00026790: 6261 7365 3634 5f6d 6574 6164 6174 612c  base64_metadata,
+000267a0: 0a20 2020 2020 2020 2020 2020 2074 6162  .            tab
+000267b0: 6c65 3d74 632e 6d75 7461 7469 6f6e 732c  le=tc.mutations,
+000267c0: 0a20 2020 2020 2020 2029 0a20 2020 2069  .        ).    i
+000267d0: 6620 696e 6469 7669 6475 616c 7320 6973  f individuals is
+000267e0: 206e 6f74 204e 6f6e 653a 0a20 2020 2020   not None:.     
+000267f0: 2020 2070 6172 7365 5f69 6e64 6976 6964     parse_individ
+00026800: 7561 6c73 280a 2020 2020 2020 2020 2020  uals(.          
+00026810: 2020 696e 6469 7669 6475 616c 732c 0a20    individuals,. 
+00026820: 2020 2020 2020 2020 2020 2073 7472 6963             stric
+00026830: 743d 7374 7269 6374 2c0a 2020 2020 2020  t=strict,.      
+00026840: 2020 2020 2020 656e 636f 6469 6e67 3d65        encoding=e
+00026850: 6e63 6f64 696e 672c 0a20 2020 2020 2020  ncoding,.       
+00026860: 2020 2020 2062 6173 6536 345f 6d65 7461       base64_meta
+00026870: 6461 7461 3d62 6173 6536 345f 6d65 7461  data=base64_meta
+00026880: 6461 7461 2c0a 2020 2020 2020 2020 2020  data,.          
+00026890: 2020 7461 626c 653d 7463 2e69 6e64 6976    table=tc.indiv
+000268a0: 6964 7561 6c73 2c0a 2020 2020 2020 2020  iduals,.        
+000268b0: 290a 2020 2020 6966 2070 6f70 756c 6174  ).    if populat
+000268c0: 696f 6e73 2069 7320 4e6f 6e65 3a0a 2020  ions is None:.  
+000268d0: 2020 2020 2020 2320 4173 2061 2063 6f6e        # As a con
+000268e0: 7665 6e69 656e 6365 2077 6520 6164 6420  venience we add 
+000268f0: 616e 7920 706f 7075 6c61 7469 6f6e 7320  any populations 
+00026900: 7265 6665 7265 6e63 6564 2069 6e20 7468  referenced in th
+00026910: 6520 6e6f 6465 2074 6162 6c65 2e0a 2020  e node table..  
+00026920: 2020 2020 2020 6966 206c 656e 2874 632e        if len(tc.
+00026930: 6e6f 6465 7329 203e 2030 3a0a 2020 2020  nodes) > 0:.    
+00026940: 2020 2020 2020 2020 6d61 785f 706f 7075          max_popu
+00026950: 6c61 7469 6f6e 203d 2074 632e 6e6f 6465  lation = tc.node
+00026960: 732e 706f 7075 6c61 7469 6f6e 2e6d 6178  s.population.max
+00026970: 2829 0a20 2020 2020 2020 2020 2020 2069  ().            i
+00026980: 6620 6d61 785f 706f 7075 6c61 7469 6f6e  f max_population
+00026990: 2021 3d20 4e55 4c4c 3a0a 2020 2020 2020   != NULL:.      
+000269a0: 2020 2020 2020 2020 2020 666f 7220 5f20            for _ 
+000269b0: 696e 2072 616e 6765 286d 6178 5f70 6f70  in range(max_pop
+000269c0: 756c 6174 696f 6e20 2b20 3129 3a0a 2020  ulation + 1):.  
+000269d0: 2020 2020 2020 2020 2020 2020 2020 2020                  
+000269e0: 2020 7463 2e70 6f70 756c 6174 696f 6e73    tc.populations
+000269f0: 2e61 6464 5f72 6f77 2829 0a20 2020 2065  .add_row().    e
+00026a00: 6c73 653a 0a20 2020 2020 2020 2070 6172  lse:.        par
+00026a10: 7365 5f70 6f70 756c 6174 696f 6e73 280a  se_populations(.
+00026a20: 2020 2020 2020 2020 2020 2020 706f 7075              popu
+00026a30: 6c61 7469 6f6e 732c 0a20 2020 2020 2020  lations,.       
+00026a40: 2020 2020 2073 7472 6963 743d 7374 7269       strict=stri
+00026a50: 6374 2c0a 2020 2020 2020 2020 2020 2020  ct,.            
+00026a60: 656e 636f 6469 6e67 3d65 6e63 6f64 696e  encoding=encodin
+00026a70: 672c 0a20 2020 2020 2020 2020 2020 2062  g,.            b
+00026a80: 6173 6536 345f 6d65 7461 6461 7461 3d62  ase64_metadata=b
+00026a90: 6173 6536 345f 6d65 7461 6461 7461 2c0a  ase64_metadata,.
+00026aa0: 2020 2020 2020 2020 2020 2020 7461 626c              tabl
+00026ab0: 653d 7463 2e70 6f70 756c 6174 696f 6e73  e=tc.populations
+00026ac0: 2c0a 2020 2020 2020 2020 290a 2020 2020  ,.        ).    
+00026ad0: 6966 206d 6967 7261 7469 6f6e 7320 6973  if migrations is
+00026ae0: 206e 6f74 204e 6f6e 653a 0a20 2020 2020   not None:.     
+00026af0: 2020 2070 6172 7365 5f6d 6967 7261 7469     parse_migrati
+00026b00: 6f6e 7328 0a20 2020 2020 2020 2020 2020  ons(.           
+00026b10: 206d 6967 7261 7469 6f6e 732c 0a20 2020   migrations,.   
+00026b20: 2020 2020 2020 2020 2073 7472 6963 743d           strict=
+00026b30: 7374 7269 6374 2c0a 2020 2020 2020 2020  strict,.        
+00026b40: 2020 2020 656e 636f 6469 6e67 3d65 6e63      encoding=enc
+00026b50: 6f64 696e 672c 0a20 2020 2020 2020 2020  oding,.         
+00026b60: 2020 2062 6173 6536 345f 6d65 7461 6461     base64_metada
+00026b70: 7461 3d62 6173 6536 345f 6d65 7461 6461  ta=base64_metada
+00026b80: 7461 2c0a 2020 2020 2020 2020 2020 2020  ta,.            
+00026b90: 7461 626c 653d 7463 2e6d 6967 7261 7469  table=tc.migrati
+00026ba0: 6f6e 732c 0a20 2020 2020 2020 2029 0a20  ons,.        ). 
+00026bb0: 2020 2074 632e 736f 7274 2829 0a20 2020     tc.sort().   
+00026bc0: 2072 6574 7572 6e20 7463 2e74 7265 655f   return tc.tree_
+00026bd0: 7365 7175 656e 6365 2829 0a0a 0a63 6c61  sequence()...cla
+00026be0: 7373 2054 7265 6549 7465 7261 746f 723a  ss TreeIterator:
+00026bf0: 0a20 2020 2022 2222 0a20 2020 2053 696d  .    """.    Sim
+00026c00: 706c 6520 636c 6173 7320 7072 6f76 6964  ple class provid
+00026c10: 696e 6720 666f 7277 6172 6420 616e 6420  ing forward and 
+00026c20: 6261 636b 7761 7264 2069 7465 7261 7469  backward iterati
+00026c30: 6f6e 206f 7665 7220 6120 7472 6565 2073  on over a tree s
+00026c40: 6571 7565 6e63 652e 0a20 2020 2022 2222  equence..    """
+00026c50: 0a0a 2020 2020 6465 6620 5f5f 696e 6974  ..    def __init
+00026c60: 5f5f 2873 656c 662c 2074 7265 6529 3a0a  __(self, tree):.
+00026c70: 2020 2020 2020 2020 7365 6c66 2e74 7265          self.tre
+00026c80: 6520 3d20 7472 6565 0a20 2020 2020 2020  e = tree.       
+00026c90: 2073 656c 662e 6d6f 7265 5f74 7265 6573   self.more_trees
+00026ca0: 203d 2054 7275 650a 2020 2020 2020 2020   = True.        
+00026cb0: 7365 6c66 2e66 6f72 7761 7264 203d 2054  self.forward = T
+00026cc0: 7275 650a 0a20 2020 2064 6566 205f 5f69  rue..    def __i
+00026cd0: 7465 725f 5f28 7365 6c66 293a 0a20 2020  ter__(self):.   
+00026ce0: 2020 2020 2072 6574 7572 6e20 7365 6c66       return self
+00026cf0: 0a0a 2020 2020 6465 6620 5f5f 7265 7665  ..    def __reve
+00026d00: 7273 6564 5f5f 2873 656c 6629 3a0a 2020  rsed__(self):.  
+00026d10: 2020 2020 2020 7365 6c66 2e66 6f72 7761        self.forwa
+00026d20: 7264 203d 2046 616c 7365 0a20 2020 2020  rd = False.     
+00026d30: 2020 2072 6574 7572 6e20 7365 6c66 0a0a     return self..
+00026d40: 2020 2020 6465 6620 5f5f 6e65 7874 5f5f      def __next__
+00026d50: 2873 656c 6629 3a0a 2020 2020 2020 2020  (self):.        
+00026d60: 6966 2073 656c 662e 666f 7277 6172 643a  if self.forward:
+00026d70: 0a20 2020 2020 2020 2020 2020 2073 656c  .            sel
+00026d80: 662e 6d6f 7265 5f74 7265 6573 203d 2073  f.more_trees = s
+00026d90: 656c 662e 6d6f 7265 5f74 7265 6573 2061  elf.more_trees a
+00026da0: 6e64 2073 656c 662e 7472 6565 2e6e 6578  nd self.tree.nex
+00026db0: 7428 290a 2020 2020 2020 2020 656c 7365  t().        else
+00026dc0: 3a0a 2020 2020 2020 2020 2020 2020 7365  :.            se
+00026dd0: 6c66 2e6d 6f72 655f 7472 6565 7320 3d20  lf.more_trees = 
+00026de0: 7365 6c66 2e6d 6f72 655f 7472 6565 7320  self.more_trees 
+00026df0: 616e 6420 7365 6c66 2e74 7265 652e 7072  and self.tree.pr
+00026e00: 6576 2829 0a20 2020 2020 2020 2069 6620  ev().        if 
+00026e10: 6e6f 7420 7365 6c66 2e6d 6f72 655f 7472  not self.more_tr
+00026e20: 6565 733a 0a20 2020 2020 2020 2020 2020  ees:.           
+00026e30: 2072 6169 7365 2053 746f 7049 7465 7261   raise StopItera
+00026e40: 7469 6f6e 2829 0a20 2020 2020 2020 2072  tion().        r
+00026e50: 6574 7572 6e20 7365 6c66 2e74 7265 650a  eturn self.tree.
+00026e60: 0a20 2020 2064 6566 205f 5f6c 656e 5f5f  .    def __len__
+00026e70: 2873 656c 6629 3a0a 2020 2020 2020 2020  (self):.        
+00026e80: 7265 7475 726e 2073 656c 662e 7472 6565  return self.tree
+00026e90: 2e74 7265 655f 7365 7175 656e 6365 2e6e  .tree_sequence.n
+00026ea0: 756d 5f74 7265 6573 0a0a 0a63 6c61 7373  um_trees...class
+00026eb0: 2053 696d 706c 6543 6f6e 7461 696e 6572   SimpleContainer
+00026ec0: 5365 7175 656e 6365 3a0a 2020 2020 2222  Sequence:.    ""
+00026ed0: 220a 2020 2020 5369 6d70 6c65 2077 7261  ".    Simple wra
+00026ee0: 7070 6572 2074 6f20 616c 6c6f 7720 6172  pper to allow ar
+00026ef0: 7261 7973 206f 6620 5369 6d70 6c65 436f  rays of SimpleCo
+00026f00: 6e74 6169 6e65 7273 2028 652e 672e 2065  ntainers (e.g. e
+00026f10: 6467 6573 2c20 6e6f 6465 7329 2074 6861  dges, nodes) tha
+00026f20: 7420 6861 7665 2061 0a20 2020 2066 756e  t have a.    fun
+00026f30: 6374 696f 6e20 616c 6c6f 7769 6e67 2061  ction allowing a
+00026f40: 6363 6573 7320 6279 2069 6e64 6578 2028  ccess by index (
+00026f50: 652e 672e 2074 732e 6564 6765 2869 292c  e.g. ts.edge(i),
+00026f60: 2074 732e 6e6f 6465 2869 2929 2074 6f20   ts.node(i)) to 
+00026f70: 6265 2074 7265 6174 6564 2061 7320 610a  be treated as a.
+00026f80: 2020 2020 7079 7468 6f6e 2073 6571 7565      python seque
+00026f90: 6e63 652c 2061 6c6c 6f77 696e 6720 666f  nce, allowing fo
+00026fa0: 7277 6172 6420 616e 6420 7265 7665 7273  rward and revers
+00026fb0: 6520 6974 6572 6174 696f 6e2e 0a0a 2020  e iteration...  
+00026fc0: 2020 546f 2067 656e 6572 6174 6520 6120    To generate a 
+00026fd0: 7365 7175 656e 6365 206f 6620 6974 656d  sequence of item
+00026fe0: 7320 696e 2061 2064 6966 6665 7265 6e74  s in a different
+00026ff0: 206f 7264 6572 2c20 7468 6520 6060 6f72   order, the ``or
+00027000: 6465 7260 6020 7061 7261 6d65 7465 7220  der`` parameter 
+00027010: 616c 6c6f 7773 0a20 2020 2061 6e20 6172  allows.    an ar
+00027020: 7261 7920 6f66 2069 6e64 6578 6573 2074  ray of indexes t
+00027030: 6f20 6265 2070 6173 7365 6420 696e 2c20  o be passed in, 
+00027040: 7375 6368 2061 7320 7265 7475 726e 6564  such as returned
+00027050: 2066 726f 6d20 6e70 2e61 7267 736f 7274   from np.argsort
+00027060: 206f 7220 6e70 2e6c 6578 736f 7274 2e0a   or np.lexsort..
+00027070: 2020 2020 2222 220a 0a20 2020 2064 6566      """..    def
+00027080: 205f 5f69 6e69 745f 5f28 7365 6c66 2c20   __init__(self, 
+00027090: 6765 7474 6572 2c20 6c65 6e67 7468 2c20  getter, length, 
+000270a0: 6f72 6465 723d 4e6f 6e65 293a 0a20 2020  order=None):.   
+000270b0: 2020 2020 2069 6620 6f72 6465 7220 6973       if order is
+000270c0: 204e 6f6e 653a 0a20 2020 2020 2020 2020   None:.         
+000270d0: 2020 2073 656c 662e 6765 7474 6572 203d     self.getter =
+000270e0: 2067 6574 7465 720a 2020 2020 2020 2020   getter.        
+000270f0: 656c 7365 3a0a 2020 2020 2020 2020 2020  else:.          
+00027100: 2020 7365 6c66 2e67 6574 7465 7220 3d20    self.getter = 
+00027110: 6c61 6d62 6461 2069 6e64 6578 3a20 6765  lambda index: ge
+00027120: 7474 6572 286f 7264 6572 5b69 6e64 6578  tter(order[index
+00027130: 5d29 0a20 2020 2020 2020 2073 656c 662e  ]).        self.
+00027140: 6c65 6e67 7468 203d 206c 656e 6774 680a  length = length.
+00027150: 0a20 2020 2064 6566 205f 5f6c 656e 5f5f  .    def __len__
+00027160: 2873 656c 6629 3a0a 2020 2020 2020 2020  (self):.        
+00027170: 7265 7475 726e 2073 656c 662e 6c65 6e67  return self.leng
+00027180: 7468 0a0a 2020 2020 6465 6620 5f5f 6765  th..    def __ge
+00027190: 7469 7465 6d5f 5f28 7365 6c66 2c20 696e  titem__(self, in
+000271a0: 6465 7829 3a0a 2020 2020 2020 2020 7265  dex):.        re
+000271b0: 7475 726e 2073 656c 662e 6765 7474 6572  turn self.getter
+000271c0: 2869 6e64 6578 290a 0a0a 4064 6174 6163  (index)...@datac
+000271d0: 6c61 7373 2866 726f 7a65 6e3d 5472 7565  lass(frozen=True
+000271e0: 290a 636c 6173 7320 5461 626c 654d 6574  ).class TableMet
+000271f0: 6164 6174 6153 6368 656d 6173 3a0a 2020  adataSchemas:.  
+00027200: 2020 2222 220a 2020 2020 436f 6e76 656e    """.    Conven
+00027210: 6965 6e63 6520 636c 6173 7320 666f 7220  ience class for 
+00027220: 7265 7475 726e 696e 6720 7468 6520 7363  returning the sc
+00027230: 6865 6d61 7320 6f66 2061 6c6c 2074 6865  hemas of all the
+00027240: 2074 6162 6c65 7320 696e 2061 2074 7265   tables in a tre
+00027250: 6520 7365 7175 656e 6365 2e0a 2020 2020  e sequence..    
+00027260: 2222 220a 0a20 2020 206e 6f64 653a 206d  """..    node: m
+00027270: 6574 6164 6174 615f 6d6f 6475 6c65 2e4d  etadata_module.M
+00027280: 6574 6164 6174 6153 6368 656d 6120 3d20  etadataSchema = 
+00027290: 4e6f 6e65 0a20 2020 2022 2222 0a20 2020  None.    """.   
+000272a0: 2054 6865 206d 6574 6164 6174 6120 7363   The metadata sc
+000272b0: 6865 6d61 206f 6620 7468 6520 6e6f 6465  hema of the node
+000272c0: 2074 6162 6c65 2e0a 2020 2020 2222 220a   table..    """.
+000272d0: 0a20 2020 2065 6467 653a 206d 6574 6164  .    edge: metad
+000272e0: 6174 615f 6d6f 6475 6c65 2e4d 6574 6164  ata_module.Metad
+000272f0: 6174 6153 6368 656d 6120 3d20 4e6f 6e65  ataSchema = None
+00027300: 0a20 2020 2022 2222 0a20 2020 2054 6865  .    """.    The
+00027310: 206d 6574 6164 6174 6120 7363 6865 6d61   metadata schema
+00027320: 206f 6620 7468 6520 6564 6765 2074 6162   of the edge tab
+00027330: 6c65 2e0a 2020 2020 2222 220a 0a20 2020  le..    """..   
+00027340: 2073 6974 653a 206d 6574 6164 6174 615f   site: metadata_
+00027350: 6d6f 6475 6c65 2e4d 6574 6164 6174 6153  module.MetadataS
+00027360: 6368 656d 6120 3d20 4e6f 6e65 0a20 2020  chema = None.   
+00027370: 2022 2222 0a20 2020 2054 6865 206d 6574   """.    The met
+00027380: 6164 6174 6120 7363 6865 6d61 206f 6620  adata schema of 
+00027390: 7468 6520 7369 7465 2074 6162 6c65 2e0a  the site table..
+000273a0: 2020 2020 2222 220a 0a20 2020 206d 7574      """..    mut
+000273b0: 6174 696f 6e3a 206d 6574 6164 6174 615f  ation: metadata_
+000273c0: 6d6f 6475 6c65 2e4d 6574 6164 6174 6153  module.MetadataS
+000273d0: 6368 656d 6120 3d20 4e6f 6e65 0a20 2020  chema = None.   
+000273e0: 2022 2222 0a20 2020 2054 6865 206d 6574   """.    The met
+000273f0: 6164 6174 6120 7363 6865 6d61 206f 6620  adata schema of 
+00027400: 7468 6520 6d75 7461 7469 6f6e 2074 6162  the mutation tab
+00027410: 6c65 2e0a 2020 2020 2222 220a 0a20 2020  le..    """..   
+00027420: 206d 6967 7261 7469 6f6e 3a20 6d65 7461   migration: meta
+00027430: 6461 7461 5f6d 6f64 756c 652e 4d65 7461  data_module.Meta
+00027440: 6461 7461 5363 6865 6d61 203d 204e 6f6e  dataSchema = Non
+00027450: 650a 2020 2020 2222 220a 2020 2020 5468  e.    """.    Th
+00027460: 6520 6d65 7461 6461 7461 2073 6368 656d  e metadata schem
+00027470: 6120 6f66 2074 6865 206d 6967 7261 7469  a of the migrati
+00027480: 6f6e 2074 6162 6c65 2e0a 2020 2020 2222  on table..    ""
+00027490: 220a 0a20 2020 2069 6e64 6976 6964 7561  "..    individua
+000274a0: 6c3a 206d 6574 6164 6174 615f 6d6f 6475  l: metadata_modu
+000274b0: 6c65 2e4d 6574 6164 6174 6153 6368 656d  le.MetadataSchem
+000274c0: 6120 3d20 4e6f 6e65 0a20 2020 2022 2222  a = None.    """
+000274d0: 0a20 2020 2054 6865 206d 6574 6164 6174  .    The metadat
+000274e0: 6120 7363 6865 6d61 206f 6620 7468 6520  a schema of the 
+000274f0: 696e 6469 7669 6475 616c 2074 6162 6c65  individual table
+00027500: 2e0a 2020 2020 2222 220a 0a20 2020 2070  ..    """..    p
+00027510: 6f70 756c 6174 696f 6e3a 206d 6574 6164  opulation: metad
+00027520: 6174 615f 6d6f 6475 6c65 2e4d 6574 6164  ata_module.Metad
+00027530: 6174 6153 6368 656d 6120 3d20 4e6f 6e65  ataSchema = None
+00027540: 0a20 2020 2022 2222 0a20 2020 2054 6865  .    """.    The
+00027550: 206d 6574 6164 6174 6120 7363 6865 6d61   metadata schema
+00027560: 206f 6620 7468 6520 706f 7075 6c61 7469   of the populati
+00027570: 6f6e 2074 6162 6c65 2e0a 2020 2020 2222  on table..    ""
+00027580: 220a 0a0a 636c 6173 7320 5472 6565 5365  "...class TreeSe
+00027590: 7175 656e 6365 3a0a 2020 2020 2222 220a  quence:.    """.
+000275a0: 2020 2020 4120 7369 6e67 6c65 2074 7265      A single tre
+000275b0: 6520 7365 7175 656e 6365 2c20 6173 2064  e sequence, as d
+000275c0: 6566 696e 6564 2062 7920 7468 6520 3a72  efined by the :r
+000275d0: 6566 3a60 6461 7461 206d 6f64 656c 203c  ef:`data model <
+000275e0: 7365 635f 6461 7461 5f6d 6f64 656c 3e60  sec_data_model>`
+000275f0: 2e0a 2020 2020 4120 5472 6565 5365 7175  ..    A TreeSequ
+00027600: 656e 6365 2069 6e73 7461 6e63 6520 6361  ence instance ca
+00027610: 6e20 6265 2063 7265 6174 6564 2066 726f  n be created fro
+00027620: 6d20 6120 7365 7420 6f66 0a20 2020 203a  m a set of.    :
+00027630: 7265 663a 6074 6162 6c65 7320 3c73 6563  ref:`tables <sec
+00027640: 5f74 6162 6c65 5f64 6566 696e 6974 696f  _table_definitio
+00027650: 6e73 3e60 2075 7369 6e67 0a20 2020 203a  ns>` using.    :
+00027660: 6d65 7468 3a60 5461 626c 6543 6f6c 6c65  meth:`TableColle
+00027670: 6374 696f 6e2e 7472 6565 5f73 6571 7565  ction.tree_seque
+00027680: 6e63 6560 2c20 6f72 206c 6f61 6465 6420  nce`, or loaded 
+00027690: 6672 6f6d 2061 2073 6574 206f 6620 7465  from a set of te
+000276a0: 7874 2066 696c 6573 0a20 2020 2075 7369  xt files.    usi
+000276b0: 6e67 203a 6675 6e63 3a60 7473 6b69 742e  ng :func:`tskit.
+000276c0: 6c6f 6164 5f74 6578 7460 2c20 6f72 206c  load_text`, or l
+000276d0: 6f61 6465 6420 6672 6f6d 2061 206e 6174  oaded from a nat
+000276e0: 6976 6520 6269 6e61 7279 2066 696c 6520  ive binary file 
+000276f0: 7573 696e 670a 2020 2020 3a66 756e 633a  using.    :func:
+00027700: 6074 736b 6974 2e6c 6f61 6460 2e0a 0a20  `tskit.load`... 
+00027710: 2020 2054 7265 6553 6571 7565 6e63 6573     TreeSequences
+00027720: 2061 7265 2069 6d6d 7574 6162 6c65 2e20   are immutable. 
+00027730: 546f 2063 6861 6e67 6520 7468 6520 6461  To change the da
+00027740: 7461 2068 656c 6420 696e 2061 2070 6172  ta held in a par
+00027750: 7469 6375 6c61 720a 2020 2020 7472 6565  ticular.    tree
+00027760: 2073 6571 7565 6e63 652c 2066 6972 7374   sequence, first
+00027770: 2067 6574 2074 6865 2074 6162 6c65 2069   get the table i
+00027780: 6e66 6f72 6d61 7469 6f6e 2061 7320 6120  nformation as a 
+00027790: 3a63 6c61 7373 3a60 5461 626c 6543 6f6c  :class:`TableCol
+000277a0: 6c65 6374 696f 6e60 0a20 2020 2069 6e73  lection`.    ins
+000277b0: 7461 6e63 6520 2875 7369 6e67 203a 6d65  tance (using :me
+000277c0: 7468 3a60 2e64 756d 705f 7461 626c 6573  th:`.dump_tables
+000277d0: 6029 2c20 6564 6974 2074 686f 7365 2074  `), edit those t
+000277e0: 6162 6c65 7320 7573 696e 6720 7468 650a  ables using the.
+000277f0: 2020 2020 3a72 6566 3a60 7461 626c 6573      :ref:`tables
+00027800: 2061 7069 203c 7365 635f 7461 626c 6573   api <sec_tables
+00027810: 5f61 7069 3e60 2c20 616e 6420 6372 6561  _api>`, and crea
+00027820: 7465 2061 206e 6577 2074 7265 6520 7365  te a new tree se
+00027830: 7175 656e 6365 2075 7369 6e67 0a20 2020  quence using.   
+00027840: 203a 6d65 7468 3a60 5461 626c 6543 6f6c   :meth:`TableCol
+00027850: 6c65 6374 696f 6e2e 7472 6565 5f73 6571  lection.tree_seq
+00027860: 7565 6e63 6560 2e0a 0a20 2020 2054 6865  uence`...    The
+00027870: 203a 6d65 7468 3a60 2e74 7265 6573 6020   :meth:`.trees` 
+00027880: 6d65 7468 6f64 2069 7465 7261 7465 7320  method iterates 
+00027890: 6f76 6572 2061 6c6c 2074 7265 6573 2069  over all trees i
+000278a0: 6e20 6120 7472 6565 2073 6571 7565 6e63  n a tree sequenc
+000278b0: 652c 2061 6e64 0a20 2020 2074 6865 203a  e, and.    the :
+000278c0: 6d65 7468 3a60 2e76 6172 6961 6e74 7360  meth:`.variants`
+000278d0: 206d 6574 686f 6420 6974 6572 6174 6573   method iterates
+000278e0: 206f 7665 7220 616c 6c20 7369 7465 7320   over all sites 
+000278f0: 616e 6420 7468 6569 7220 6765 6e6f 7479  and their genoty
+00027900: 7065 732e 0a20 2020 2022 2222 0a0a 2020  pes..    """..  
+00027910: 2020 6465 6620 5f5f 696e 6974 5f5f 2873    def __init__(s
+00027920: 656c 662c 206c 6c5f 7472 6565 5f73 6571  elf, ll_tree_seq
+00027930: 7565 6e63 6529 3a0a 2020 2020 2020 2020  uence):.        
+00027940: 7365 6c66 2e5f 6c6c 5f74 7265 655f 7365  self._ll_tree_se
+00027950: 7175 656e 6365 203d 206c 6c5f 7472 6565  quence = ll_tree
+00027960: 5f73 6571 7565 6e63 650a 2020 2020 2020  _sequence.      
+00027970: 2020 6d65 7461 6461 7461 5f73 6368 656d    metadata_schem
+00027980: 615f 7374 7269 6e67 7320 3d20 7365 6c66  a_strings = self
+00027990: 2e5f 6c6c 5f74 7265 655f 7365 7175 656e  ._ll_tree_sequen
+000279a0: 6365 2e67 6574 5f74 6162 6c65 5f6d 6574  ce.get_table_met
+000279b0: 6164 6174 615f 7363 6865 6d61 7328 290a  adata_schemas().
+000279c0: 2020 2020 2020 2020 6d65 7461 6461 7461          metadata
+000279d0: 5f73 6368 656d 615f 696e 7374 616e 6365  _schema_instance
+000279e0: 7320 3d20 7b0a 2020 2020 2020 2020 2020  s = {.          
+000279f0: 2020 6e61 6d65 3a20 6d65 7461 6461 7461    name: metadata
+00027a00: 5f6d 6f64 756c 652e 7061 7273 655f 6d65  _module.parse_me
+00027a10: 7461 6461 7461 5f73 6368 656d 6128 0a20  tadata_schema(. 
+00027a20: 2020 2020 2020 2020 2020 2020 2020 2067                 g
+00027a30: 6574 6174 7472 286d 6574 6164 6174 615f  etattr(metadata_
+00027a40: 7363 6865 6d61 5f73 7472 696e 6773 2c20  schema_strings, 
+00027a50: 6e61 6d65 290a 2020 2020 2020 2020 2020  name).          
+00027a60: 2020 290a 2020 2020 2020 2020 2020 2020    ).            
+00027a70: 666f 7220 6e61 6d65 2069 6e20 7661 7273  for name in vars
+00027a80: 2854 6162 6c65 4d65 7461 6461 7461 5363  (TableMetadataSc
+00027a90: 6865 6d61 7329 0a20 2020 2020 2020 2020  hemas).         
+00027aa0: 2020 2069 6620 6e6f 7420 6e61 6d65 2e73     if not name.s
+00027ab0: 7461 7274 7377 6974 6828 225f 2229 0a20  tartswith("_"). 
+00027ac0: 2020 2020 2020 207d 0a20 2020 2020 2020         }.       
+00027ad0: 2073 656c 662e 5f74 6162 6c65 5f6d 6574   self._table_met
+00027ae0: 6164 6174 615f 7363 6865 6d61 7320 3d20  adata_schemas = 
+00027af0: 5461 626c 654d 6574 6164 6174 6153 6368  TableMetadataSch
+00027b00: 656d 6173 282a 2a6d 6574 6164 6174 615f  emas(**metadata_
+00027b10: 7363 6865 6d61 5f69 6e73 7461 6e63 6573  schema_instances
+00027b20: 290a 2020 2020 2020 2020 7365 6c66 2e5f  ).        self._
+00027b30: 696e 6469 7669 6475 616c 735f 7469 6d65  individuals_time
+00027b40: 203d 204e 6f6e 650a 2020 2020 2020 2020   = None.        
+00027b50: 7365 6c66 2e5f 696e 6469 7669 6475 616c  self._individual
+00027b60: 735f 706f 7075 6c61 7469 6f6e 203d 204e  s_population = N
+00027b70: 6f6e 650a 2020 2020 2020 2020 7365 6c66  one.        self
+00027b80: 2e5f 696e 6469 7669 6475 616c 735f 6c6f  ._individuals_lo
+00027b90: 6361 7469 6f6e 203d 204e 6f6e 650a 2020  cation = None.  
+00027ba0: 2020 2020 2020 2320 4e4f 5445 3a20 7768        # NOTE: wh
+00027bb0: 656e 2077 6527 7665 2069 6d70 6c65 6d65  en we've impleme
+00027bc0: 6e74 6564 2072 6561 642d 6f6e 6c79 2061  nted read-only a
+00027bd0: 6363 6573 7320 7669 6120 7468 6520 756e  ccess via the un
+00027be0: 6465 726c 7969 6e67 0a20 2020 2020 2020  derlying.       
+00027bf0: 2023 2074 6162 6c65 7320 7765 2063 616e   # tables we can
+00027c00: 2072 6570 6c61 6365 2074 6865 7365 2061   replace these a
+00027c10: 7272 6179 7320 7769 7468 2072 6566 6572  rrays with refer
+00027c20: 656e 6365 2074 6f20 7468 6520 7265 6164  ence to the read
+00027c30: 2d6f 6e6c 790a 2020 2020 2020 2020 2320  -only.        # 
+00027c40: 7461 626c 6573 2068 6572 6520 2861 6e64  tables here (and
+00027c50: 2072 656d 6f76 6520 7468 6520 6c6f 772d   remove the low-
+00027c60: 6c65 7665 6c20 626f 696c 6572 706c 6174  level boilerplat
+00027c70: 6529 2e0a 2020 2020 2020 2020 6c6c 7473  e)..        llts
+00027c80: 203d 2073 656c 662e 5f6c 6c5f 7472 6565   = self._ll_tree
+00027c90: 5f73 6571 7565 6e63 650a 2020 2020 2020  _sequence.      
+00027ca0: 2020 7365 6c66 2e5f 696e 6469 7669 6475    self._individu
+00027cb0: 616c 735f 666c 6167 7320 3d20 6c6c 7473  als_flags = llts
+00027cc0: 2e69 6e64 6976 6964 7561 6c73 5f66 6c61  .individuals_fla
+00027cd0: 6773 0a20 2020 2020 2020 2073 656c 662e  gs.        self.
+00027ce0: 5f6e 6f64 6573 5f74 696d 6520 3d20 6c6c  _nodes_time = ll
+00027cf0: 7473 2e6e 6f64 6573 5f74 696d 650a 2020  ts.nodes_time.  
+00027d00: 2020 2020 2020 7365 6c66 2e5f 6e6f 6465        self._node
+00027d10: 735f 666c 6167 7320 3d20 6c6c 7473 2e6e  s_flags = llts.n
+00027d20: 6f64 6573 5f66 6c61 6773 0a20 2020 2020  odes_flags.     
+00027d30: 2020 2073 656c 662e 5f6e 6f64 6573 5f70     self._nodes_p
+00027d40: 6f70 756c 6174 696f 6e20 3d20 6c6c 7473  opulation = llts
+00027d50: 2e6e 6f64 6573 5f70 6f70 756c 6174 696f  .nodes_populatio
+00027d60: 6e0a 2020 2020 2020 2020 7365 6c66 2e5f  n.        self._
+00027d70: 6e6f 6465 735f 696e 6469 7669 6475 616c  nodes_individual
+00027d80: 203d 206c 6c74 732e 6e6f 6465 735f 696e   = llts.nodes_in
+00027d90: 6469 7669 6475 616c 0a20 2020 2020 2020  dividual.       
+00027da0: 2073 656c 662e 5f65 6467 6573 5f6c 6566   self._edges_lef
+00027db0: 7420 3d20 6c6c 7473 2e65 6467 6573 5f6c  t = llts.edges_l
+00027dc0: 6566 740a 2020 2020 2020 2020 7365 6c66  eft.        self
+00027dd0: 2e5f 6564 6765 735f 7269 6768 7420 3d20  ._edges_right = 
+00027de0: 6c6c 7473 2e65 6467 6573 5f72 6967 6874  llts.edges_right
+00027df0: 0a20 2020 2020 2020 2073 656c 662e 5f65  .        self._e
+00027e00: 6467 6573 5f70 6172 656e 7420 3d20 6c6c  dges_parent = ll
+00027e10: 7473 2e65 6467 6573 5f70 6172 656e 740a  ts.edges_parent.
+00027e20: 2020 2020 2020 2020 7365 6c66 2e5f 6564          self._ed
+00027e30: 6765 735f 6368 696c 6420 3d20 6c6c 7473  ges_child = llts
+00027e40: 2e65 6467 6573 5f63 6869 6c64 0a20 2020  .edges_child.   
+00027e50: 2020 2020 2073 656c 662e 5f73 6974 6573       self._sites
+00027e60: 5f70 6f73 6974 696f 6e20 3d20 6c6c 7473  _position = llts
+00027e70: 2e73 6974 6573 5f70 6f73 6974 696f 6e0a  .sites_position.
+00027e80: 2020 2020 2020 2020 7365 6c66 2e5f 6d75          self._mu
+00027e90: 7461 7469 6f6e 735f 7369 7465 203d 206c  tations_site = l
+00027ea0: 6c74 732e 6d75 7461 7469 6f6e 735f 7369  lts.mutations_si
+00027eb0: 7465 0a20 2020 2020 2020 2073 656c 662e  te.        self.
+00027ec0: 5f6d 7574 6174 696f 6e73 5f6e 6f64 6520  _mutations_node 
+00027ed0: 3d20 6c6c 7473 2e6d 7574 6174 696f 6e73  = llts.mutations
+00027ee0: 5f6e 6f64 650a 2020 2020 2020 2020 7365  _node.        se
+00027ef0: 6c66 2e5f 6d75 7461 7469 6f6e 735f 7061  lf._mutations_pa
+00027f00: 7265 6e74 203d 206c 6c74 732e 6d75 7461  rent = llts.muta
+00027f10: 7469 6f6e 735f 7061 7265 6e74 0a20 2020  tions_parent.   
+00027f20: 2020 2020 2073 656c 662e 5f6d 7574 6174       self._mutat
+00027f30: 696f 6e73 5f74 696d 6520 3d20 6c6c 7473  ions_time = llts
+00027f40: 2e6d 7574 6174 696f 6e73 5f74 696d 650a  .mutations_time.
+00027f50: 2020 2020 2020 2020 7365 6c66 2e5f 6d69          self._mi
+00027f60: 6772 6174 696f 6e73 5f6c 6566 7420 3d20  grations_left = 
+00027f70: 6c6c 7473 2e6d 6967 7261 7469 6f6e 735f  llts.migrations_
+00027f80: 6c65 6674 0a20 2020 2020 2020 2073 656c  left.        sel
+00027f90: 662e 5f6d 6967 7261 7469 6f6e 735f 7269  f._migrations_ri
+00027fa0: 6768 7420 3d20 6c6c 7473 2e6d 6967 7261  ght = llts.migra
+00027fb0: 7469 6f6e 735f 7269 6768 740a 2020 2020  tions_right.    
+00027fc0: 2020 2020 7365 6c66 2e5f 6d69 6772 6174      self._migrat
+00027fd0: 696f 6e73 5f72 6967 6874 203d 206c 6c74  ions_right = llt
+00027fe0: 732e 6d69 6772 6174 696f 6e73 5f72 6967  s.migrations_rig
+00027ff0: 6874 0a20 2020 2020 2020 2073 656c 662e  ht.        self.
+00028000: 5f6d 6967 7261 7469 6f6e 735f 6e6f 6465  _migrations_node
+00028010: 203d 206c 6c74 732e 6d69 6772 6174 696f   = llts.migratio
+00028020: 6e73 5f6e 6f64 650a 2020 2020 2020 2020  ns_node.        
+00028030: 7365 6c66 2e5f 6d69 6772 6174 696f 6e73  self._migrations
+00028040: 5f73 6f75 7263 6520 3d20 6c6c 7473 2e6d  _source = llts.m
+00028050: 6967 7261 7469 6f6e 735f 736f 7572 6365  igrations_source
+00028060: 0a20 2020 2020 2020 2073 656c 662e 5f6d  .        self._m
+00028070: 6967 7261 7469 6f6e 735f 6465 7374 203d  igrations_dest =
+00028080: 206c 6c74 732e 6d69 6772 6174 696f 6e73   llts.migrations
+00028090: 5f64 6573 740a 2020 2020 2020 2020 7365  _dest.        se
+000280a0: 6c66 2e5f 6d69 6772 6174 696f 6e73 5f74  lf._migrations_t
+000280b0: 696d 6520 3d20 6c6c 7473 2e6d 6967 7261  ime = llts.migra
+000280c0: 7469 6f6e 735f 7469 6d65 0a20 2020 2020  tions_time.     
+000280d0: 2020 2073 656c 662e 5f69 6e64 6578 6573     self._indexes
+000280e0: 5f65 6467 655f 696e 7365 7274 696f 6e5f  _edge_insertion_
+000280f0: 6f72 6465 7220 3d20 6c6c 7473 2e69 6e64  order = llts.ind
+00028100: 6578 6573 5f65 6467 655f 696e 7365 7274  exes_edge_insert
+00028110: 696f 6e5f 6f72 6465 720a 2020 2020 2020  ion_order.      
+00028120: 2020 7365 6c66 2e5f 696e 6465 7865 735f    self._indexes_
+00028130: 6564 6765 5f72 656d 6f76 616c 5f6f 7264  edge_removal_ord
+00028140: 6572 203d 206c 6c74 732e 696e 6465 7865  er = llts.indexe
+00028150: 735f 6564 6765 5f72 656d 6f76 616c 5f6f  s_edge_removal_o
+00028160: 7264 6572 0a0a 2020 2020 2320 496d 706c  rder..    # Impl
+00028170: 656d 656e 7420 7468 6520 7069 636b 6c65  ement the pickle
+00028180: 2070 726f 746f 636f 6c20 666f 7220 5472   protocol for Tr
+00028190: 6565 5365 7175 656e 6365 0a20 2020 2064  eeSequence.    d
+000281a0: 6566 205f 5f67 6574 7374 6174 655f 5f28  ef __getstate__(
+000281b0: 7365 6c66 293a 0a20 2020 2020 2020 2072  self):.        r
+000281c0: 6574 7572 6e20 7365 6c66 2e64 756d 705f  eturn self.dump_
+000281d0: 7461 626c 6573 2829 0a0a 2020 2020 6465  tables()..    de
+000281e0: 6620 5f5f 7365 7473 7461 7465 5f5f 2873  f __setstate__(s
+000281f0: 656c 662c 2074 6329 3a0a 2020 2020 2020  elf, tc):.      
+00028200: 2020 7365 6c66 2e5f 5f69 6e69 745f 5f28    self.__init__(
+00028210: 7463 2e74 7265 655f 7365 7175 656e 6365  tc.tree_sequence
+00028220: 2829 2e6c 6c5f 7472 6565 5f73 6571 7565  ().ll_tree_seque
+00028230: 6e63 6529 0a0a 2020 2020 6465 6620 5f5f  nce)..    def __
+00028240: 6571 5f5f 2873 656c 662c 206f 7468 6572  eq__(self, other
+00028250: 293a 0a20 2020 2020 2020 2072 6574 7572  ):.        retur
+00028260: 6e20 7365 6c66 2e74 6162 6c65 7320 3d3d  n self.tables ==
+00028270: 206f 7468 6572 2e74 6162 6c65 730a 0a20   other.tables.. 
+00028280: 2020 2064 6566 2065 7175 616c 7328 0a20     def equals(. 
+00028290: 2020 2020 2020 2073 656c 662c 0a20 2020         self,.   
+000282a0: 2020 2020 206f 7468 6572 2c0a 2020 2020       other,.    
+000282b0: 2020 2020 2a2c 0a20 2020 2020 2020 2069      *,.        i
+000282c0: 676e 6f72 655f 6d65 7461 6461 7461 3d46  gnore_metadata=F
+000282d0: 616c 7365 2c0a 2020 2020 2020 2020 6967  alse,.        ig
+000282e0: 6e6f 7265 5f74 735f 6d65 7461 6461 7461  nore_ts_metadata
+000282f0: 3d46 616c 7365 2c0a 2020 2020 2020 2020  =False,.        
+00028300: 6967 6e6f 7265 5f70 726f 7665 6e61 6e63  ignore_provenanc
+00028310: 653d 4661 6c73 652c 0a20 2020 2020 2020  e=False,.       
+00028320: 2069 676e 6f72 655f 7469 6d65 7374 616d   ignore_timestam
+00028330: 7073 3d46 616c 7365 2c0a 2020 2020 2020  ps=False,.      
+00028340: 2020 6967 6e6f 7265 5f74 6162 6c65 733d    ignore_tables=
+00028350: 4661 6c73 652c 0a20 2020 2020 2020 2069  False,.        i
+00028360: 676e 6f72 655f 7265 6665 7265 6e63 655f  gnore_reference_
+00028370: 7365 7175 656e 6365 3d46 616c 7365 2c0a  sequence=False,.
+00028380: 2020 2020 293a 0a20 2020 2020 2020 2022      ):.        "
+00028390: 2222 0a20 2020 2020 2020 2052 6574 7572  "".        Retur
+000283a0: 6e73 2054 7275 6520 6966 2020 6073 656c  ns True if  `sel
+000283b0: 6660 2061 6e64 2060 6f74 6865 7260 2061  f` and `other` a
+000283c0: 7265 2065 7175 616c 2e20 5573 6573 2074  re equal. Uses t
+000283d0: 6865 2075 6e64 6572 6c79 696e 6720 7461  he underlying ta
+000283e0: 626c 650a 2020 2020 2020 2020 6571 7561  ble.        equa
+000283f0: 6c69 7479 2c20 7365 6520 3a6d 6574 683a  lity, see :meth:
+00028400: 6054 6162 6c65 436f 6c6c 6563 7469 6f6e  `TableCollection
+00028410: 2e65 7175 616c 7360 2066 6f72 2064 6574  .equals` for det
+00028420: 6169 6c73 2061 6e64 206f 7074 696f 6e73  ails and options
+00028430: 2e0a 2020 2020 2020 2020 2222 220a 2020  ..        """.  
+00028440: 2020 2020 2020 7265 7475 726e 2073 656c        return sel
+00028450: 662e 7461 626c 6573 2e65 7175 616c 7328  f.tables.equals(
+00028460: 0a20 2020 2020 2020 2020 2020 206f 7468  .            oth
+00028470: 6572 2e74 6162 6c65 732c 0a20 2020 2020  er.tables,.     
+00028480: 2020 2020 2020 2069 676e 6f72 655f 6d65         ignore_me
+00028490: 7461 6461 7461 3d69 676e 6f72 655f 6d65  tadata=ignore_me
+000284a0: 7461 6461 7461 2c0a 2020 2020 2020 2020  tadata,.        
+000284b0: 2020 2020 6967 6e6f 7265 5f74 735f 6d65      ignore_ts_me
+000284c0: 7461 6461 7461 3d69 676e 6f72 655f 7473  tadata=ignore_ts
+000284d0: 5f6d 6574 6164 6174 612c 0a20 2020 2020  _metadata,.     
+000284e0: 2020 2020 2020 2069 676e 6f72 655f 7072         ignore_pr
+000284f0: 6f76 656e 616e 6365 3d69 676e 6f72 655f  ovenance=ignore_
+00028500: 7072 6f76 656e 616e 6365 2c0a 2020 2020  provenance,.    
+00028510: 2020 2020 2020 2020 6967 6e6f 7265 5f74          ignore_t
+00028520: 696d 6573 7461 6d70 733d 6967 6e6f 7265  imestamps=ignore
+00028530: 5f74 696d 6573 7461 6d70 732c 0a20 2020  _timestamps,.   
+00028540: 2020 2020 2020 2020 2069 676e 6f72 655f           ignore_
+00028550: 7461 626c 6573 3d69 676e 6f72 655f 7461  tables=ignore_ta
+00028560: 626c 6573 2c0a 2020 2020 2020 2020 2020  bles,.          
+00028570: 2020 6967 6e6f 7265 5f72 6566 6572 656e    ignore_referen
+00028580: 6365 5f73 6571 7565 6e63 653d 6967 6e6f  ce_sequence=igno
+00028590: 7265 5f72 6566 6572 656e 6365 5f73 6571  re_reference_seq
+000285a0: 7565 6e63 652c 0a20 2020 2020 2020 2029  uence,.        )
+000285b0: 0a0a 2020 2020 4070 726f 7065 7274 790a  ..    @property.
+000285c0: 2020 2020 6465 6620 6c6c 5f74 7265 655f      def ll_tree_
+000285d0: 7365 7175 656e 6365 2873 656c 6629 3a0a  sequence(self):.
+000285e0: 2020 2020 2020 2020 7265 7475 726e 2073          return s
+000285f0: 656c 662e 6765 745f 6c6c 5f74 7265 655f  elf.get_ll_tree_
+00028600: 7365 7175 656e 6365 2829 0a0a 2020 2020  sequence()..    
+00028610: 6465 6620 6765 745f 6c6c 5f74 7265 655f  def get_ll_tree_
+00028620: 7365 7175 656e 6365 2873 656c 6629 3a0a  sequence(self):.
+00028630: 2020 2020 2020 2020 7265 7475 726e 2073          return s
+00028640: 656c 662e 5f6c 6c5f 7472 6565 5f73 6571  elf._ll_tree_seq
+00028650: 7565 6e63 650a 0a20 2020 2064 6566 2061  uence..    def a
+00028660: 736c 6973 7428 7365 6c66 2c20 2a2a 6b77  slist(self, **kw
+00028670: 6172 6773 293a 0a20 2020 2020 2020 2022  args):.        "
+00028680: 2222 0a20 2020 2020 2020 2052 6574 7572  "".        Retur
+00028690: 6e73 2074 6865 2074 7265 6573 2069 6e20  ns the trees in 
+000286a0: 7468 6973 2074 7265 6520 7365 7175 656e  this tree sequen
+000286b0: 6365 2061 7320 6120 6c69 7374 2e20 4561  ce as a list. Ea
+000286c0: 6368 2074 7265 6520 6973 0a20 2020 2020  ch tree is.     
+000286d0: 2020 2072 6570 7265 7365 6e74 6564 2062     represented b
+000286e0: 7920 6120 6469 6666 6572 656e 7420 696e  y a different in
+000286f0: 7374 616e 6365 206f 6620 3a63 6c61 7373  stance of :class
+00028700: 3a60 5472 6565 602e 2041 7320 7375 6368  :`Tree`. As such
+00028710: 2c20 7468 6973 0a20 2020 2020 2020 206d  , this.        m
+00028720: 6574 686f 6420 6973 2069 6e65 6666 6963  ethod is ineffic
+00028730: 6965 6e74 2061 6e64 206d 6179 2075 7365  ient and may use
+00028740: 2061 206c 6172 6765 2061 6d6f 756e 7420   a large amount 
+00028750: 6f66 206d 656d 6f72 792c 2061 6e64 2073  of memory, and s
+00028760: 686f 756c 640a 2020 2020 2020 2020 6e6f  hould.        no
+00028770: 7420 6265 2075 7365 6420 7768 656e 2070  t be used when p
+00028780: 6572 666f 726d 616e 6365 2069 7320 6120  erformance is a 
+00028790: 636f 6e73 6964 6572 6174 696f 6e2e 2054  consideration. T
+000287a0: 6865 203a 6d65 7468 3a60 2e74 7265 6573  he :meth:`.trees
+000287b0: 600a 2020 2020 2020 2020 6d65 7468 6f64  `.        method
+000287c0: 2069 7320 7468 6520 7265 636f 6d6d 656e   is the recommen
+000287d0: 6465 6420 7761 7920 746f 2065 6666 6963  ded way to effic
+000287e0: 6965 6e74 6c79 2069 7465 7261 7465 206f  iently iterate o
+000287f0: 7665 7220 7468 6520 7472 6565 730a 2020  ver the trees.  
+00028800: 2020 2020 2020 696e 2061 2074 7265 6520        in a tree 
+00028810: 7365 7175 656e 6365 2e0a 0a20 2020 2020  sequence...     
+00028820: 2020 203a 7061 7261 6d20 5c5c 2a2a 6b77     :param \\**kw
+00028830: 6172 6773 3a20 4675 7274 6865 7220 6172  args: Further ar
+00028840: 6775 6d65 6e74 7320 7573 6564 2061 7320  guments used as 
+00028850: 7061 7261 6d65 7465 7273 2077 6865 6e20  parameters when 
+00028860: 636f 6e73 7472 7563 7469 6e67 2074 6865  constructing the
+00028870: 0a20 2020 2020 2020 2020 2020 2072 6574  .            ret
+00028880: 7572 6e65 6420 7472 6565 732e 2046 6f72  urned trees. For
+00028890: 2065 7861 6d70 6c65 2060 6074 732e 6173   example ``ts.as
+000288a0: 6c69 7374 2873 616d 706c 655f 6c69 7374  list(sample_list
+000288b0: 733d 5472 7565 2960 6020 7769 6c6c 2072  s=True)`` will r
+000288c0: 6573 756c 740a 2020 2020 2020 2020 2020  esult.          
+000288d0: 2020 696e 2061 206c 6973 7420 6f66 203a    in a list of :
+000288e0: 636c 6173 733a 6054 7265 6560 2069 6e73  class:`Tree` ins
+000288f0: 7461 6e63 6573 2063 7265 6174 6564 2077  tances created w
+00028900: 6974 6820 6060 7361 6d70 6c65 5f6c 6973  ith ``sample_lis
+00028910: 7473 3d54 7275 6560 602e 0a20 2020 2020  ts=True``..     
+00028920: 2020 203a 7265 7475 726e 3a20 4120 6c69     :return: A li
+00028930: 7374 206f 6620 7468 6520 7472 6565 7320  st of the trees 
+00028940: 696e 2074 6869 7320 7472 6565 2073 6571  in this tree seq
+00028950: 7565 6e63 652e 0a20 2020 2020 2020 203a  uence..        :
+00028960: 7274 7970 653a 206c 6973 740a 2020 2020  rtype: list.    
+00028970: 2020 2020 2222 220a 2020 2020 2020 2020      """.        
+00028980: 7265 7475 726e 205b 7472 6565 2e63 6f70  return [tree.cop
+00028990: 7928 2920 666f 7220 7472 6565 2069 6e20  y() for tree in 
+000289a0: 7365 6c66 2e74 7265 6573 282a 2a6b 7761  self.trees(**kwa
+000289b0: 7267 7329 5d0a 0a20 2020 2040 636c 6173  rgs)]..    @clas
+000289c0: 736d 6574 686f 640a 2020 2020 6465 6620  smethod.    def 
+000289d0: 6c6f 6164 2863 6c73 2c20 6669 6c65 5f6f  load(cls, file_o
+000289e0: 725f 7061 7468 2c20 2a2c 2073 6b69 705f  r_path, *, skip_
+000289f0: 7461 626c 6573 3d46 616c 7365 2c20 736b  tables=False, sk
+00028a00: 6970 5f72 6566 6572 656e 6365 5f73 6571  ip_reference_seq
+00028a10: 7565 6e63 653d 4661 6c73 6529 3a0a 2020  uence=False):.  
+00028a20: 2020 2020 2020 6669 6c65 2c20 6c6f 6361        file, loca
+00028a30: 6c5f 6669 6c65 203d 2075 7469 6c2e 636f  l_file = util.co
+00028a40: 6e76 6572 745f 6669 6c65 5f6c 696b 655f  nvert_file_like_
+00028a50: 746f 5f6f 7065 6e5f 6669 6c65 2866 696c  to_open_file(fil
+00028a60: 655f 6f72 5f70 6174 682c 2022 7262 2229  e_or_path, "rb")
+00028a70: 0a20 2020 2020 2020 2074 7279 3a0a 2020  .        try:.  
+00028a80: 2020 2020 2020 2020 2020 7473 203d 205f            ts = _
+00028a90: 7473 6b69 742e 5472 6565 5365 7175 656e  tskit.TreeSequen
+00028aa0: 6365 2829 0a20 2020 2020 2020 2020 2020  ce().           
+00028ab0: 2074 732e 6c6f 6164 280a 2020 2020 2020   ts.load(.      
+00028ac0: 2020 2020 2020 2020 2020 6669 6c65 2c0a            file,.
+00028ad0: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00028ae0: 736b 6970 5f74 6162 6c65 733d 736b 6970  skip_tables=skip
+00028af0: 5f74 6162 6c65 732c 0a20 2020 2020 2020  _tables,.       
+00028b00: 2020 2020 2020 2020 2073 6b69 705f 7265           skip_re
+00028b10: 6665 7265 6e63 655f 7365 7175 656e 6365  ference_sequence
+00028b20: 3d73 6b69 705f 7265 6665 7265 6e63 655f  =skip_reference_
+00028b30: 7365 7175 656e 6365 2c0a 2020 2020 2020  sequence,.      
+00028b40: 2020 2020 2020 290a 2020 2020 2020 2020        ).        
+00028b50: 2020 2020 7265 7475 726e 2054 7265 6553      return TreeS
+00028b60: 6571 7565 6e63 6528 7473 290a 2020 2020  equence(ts).    
+00028b70: 2020 2020 6578 6365 7074 2074 736b 6974      except tskit
+00028b80: 2e46 696c 6546 6f72 6d61 7445 7272 6f72  .FileFormatError
+00028b90: 2061 7320 653a 0a20 2020 2020 2020 2020   as e:.         
+00028ba0: 2020 2075 7469 6c2e 7261 6973 655f 6b6e     util.raise_kn
+00028bb0: 6f77 6e5f 6669 6c65 5f66 6f72 6d61 745f  own_file_format_
+00028bc0: 6572 726f 7273 2866 696c 652c 2065 290a  errors(file, e).
+00028bd0: 2020 2020 2020 2020 6669 6e61 6c6c 793a          finally:
+00028be0: 0a20 2020 2020 2020 2020 2020 2069 6620  .            if 
+00028bf0: 6c6f 6361 6c5f 6669 6c65 3a0a 2020 2020  local_file:.    
+00028c00: 2020 2020 2020 2020 2020 2020 6669 6c65              file
+00028c10: 2e63 6c6f 7365 2829 0a0a 2020 2020 4063  .close()..    @c
+00028c20: 6c61 7373 6d65 7468 6f64 0a20 2020 2064  lassmethod.    d
+00028c30: 6566 206c 6f61 645f 7461 626c 6573 2863  ef load_tables(c
+00028c40: 6c73 2c20 7461 626c 6573 2c20 2a2c 2062  ls, tables, *, b
+00028c50: 7569 6c64 5f69 6e64 6578 6573 3d46 616c  uild_indexes=Fal
+00028c60: 7365 293a 0a20 2020 2020 2020 2074 7320  se):.        ts 
+00028c70: 3d20 5f74 736b 6974 2e54 7265 6553 6571  = _tskit.TreeSeq
+00028c80: 7565 6e63 6528 290a 2020 2020 2020 2020  uence().        
+00028c90: 7473 2e6c 6f61 645f 7461 626c 6573 2874  ts.load_tables(t
+00028ca0: 6162 6c65 732e 5f6c 6c5f 7461 626c 6573  ables._ll_tables
+00028cb0: 2c20 6275 696c 645f 696e 6465 7865 733d  , build_indexes=
+00028cc0: 6275 696c 645f 696e 6465 7865 7329 0a20  build_indexes). 
+00028cd0: 2020 2020 2020 2072 6574 7572 6e20 5472         return Tr
+00028ce0: 6565 5365 7175 656e 6365 2874 7329 0a0a  eeSequence(ts)..
+00028cf0: 2020 2020 6465 6620 6475 6d70 2873 656c      def dump(sel
+00028d00: 662c 2066 696c 655f 6f72 5f70 6174 682c  f, file_or_path,
+00028d10: 207a 6c69 625f 636f 6d70 7265 7373 696f   zlib_compressio
+00028d20: 6e3d 4661 6c73 6529 3a0a 2020 2020 2020  n=False):.      
+00028d30: 2020 2222 220a 2020 2020 2020 2020 5772    """.        Wr
+00028d40: 6974 6573 2074 6865 2074 7265 6520 7365  ites the tree se
+00028d50: 7175 656e 6365 2074 6f20 7468 6520 7370  quence to the sp
+00028d60: 6563 6966 6965 6420 7061 7468 206f 7220  ecified path or 
+00028d70: 6669 6c65 206f 626a 6563 742e 0a0a 2020  file object...  
+00028d80: 2020 2020 2020 3a70 6172 616d 2073 7472        :param str
+00028d90: 2066 696c 655f 6f72 5f70 6174 683a 2054   file_or_path: T
+00028da0: 6865 2066 696c 6520 6f62 6a65 6374 206f  he file object o
+00028db0: 7220 7061 7468 2074 6f20 7772 6974 6520  r path to write 
+00028dc0: 7468 6520 5472 6565 5365 7175 656e 6365  the TreeSequence
+00028dd0: 2074 6f2e 0a20 2020 2020 2020 203a 7061   to..        :pa
+00028de0: 7261 6d20 626f 6f6c 207a 6c69 625f 636f  ram bool zlib_co
+00028df0: 6d70 7265 7373 696f 6e3a 2054 6869 7320  mpression: This 
+00028e00: 7061 7261 6d65 7465 7220 6973 2064 6570  parameter is dep
+00028e10: 7265 6361 7465 6420 616e 6420 6967 6e6f  recated and igno
+00028e20: 7265 642e 0a20 2020 2020 2020 2022 2222  red..        """
+00028e30: 0a20 2020 2020 2020 2069 6620 7a6c 6962  .        if zlib
+00028e40: 5f63 6f6d 7072 6573 7369 6f6e 3a0a 2020  _compression:.  
+00028e50: 2020 2020 2020 2020 2020 2320 4e6f 7465            # Note
+00028e60: 3a20 7468 6520 6d73 7072 696d 6520 434c  : the msprime CL
+00028e70: 4920 6265 666f 7265 2076 6572 7369 6f6e  I before version
+00028e80: 2031 2e30 2075 7365 7320 7468 6973 206f   1.0 uses this o
+00028e90: 7074 696f 6e2c 2073 6f20 7765 206e 6565  ption, so we nee
+00028ea0: 640a 2020 2020 2020 2020 2020 2020 2320  d.            # 
+00028eb0: 746f 206b 6565 7020 6974 2069 6e64 6566  to keep it indef
+00028ec0: 696e 6974 656c 792e 0a20 2020 2020 2020  initely..       
+00028ed0: 2020 2020 2077 6172 6e69 6e67 732e 7761       warnings.wa
+00028ee0: 726e 280a 2020 2020 2020 2020 2020 2020  rn(.            
+00028ef0: 2020 2020 2254 6865 207a 6c69 625f 636f      "The zlib_co
+00028f00: 6d70 7265 7373 696f 6e20 6f70 7469 6f6e  mpression option
+00028f10: 2069 7320 6e6f 206c 6f6e 6765 7220 7375   is no longer su
+00028f20: 7070 6f72 7465 6420 616e 6420 6973 2069  pported and is i
+00028f30: 676e 6f72 6564 222c 0a20 2020 2020 2020  gnored",.       
+00028f40: 2020 2020 2020 2020 2052 756e 7469 6d65           Runtime
+00028f50: 5761 726e 696e 672c 0a20 2020 2020 2020  Warning,.       
+00028f60: 2020 2020 2029 0a20 2020 2020 2020 2066       ).        f
+00028f70: 696c 652c 206c 6f63 616c 5f66 696c 6520  ile, local_file 
+00028f80: 3d20 7574 696c 2e63 6f6e 7665 7274 5f66  = util.convert_f
+00028f90: 696c 655f 6c69 6b65 5f74 6f5f 6f70 656e  ile_like_to_open
+00028fa0: 5f66 696c 6528 6669 6c65 5f6f 725f 7061  _file(file_or_pa
+00028fb0: 7468 2c20 2277 6222 290a 2020 2020 2020  th, "wb").      
+00028fc0: 2020 7472 793a 0a20 2020 2020 2020 2020    try:.         
+00028fd0: 2020 2073 656c 662e 5f6c 6c5f 7472 6565     self._ll_tree
+00028fe0: 5f73 6571 7565 6e63 652e 6475 6d70 2866  _sequence.dump(f
+00028ff0: 696c 6529 0a20 2020 2020 2020 2066 696e  ile).        fin
+00029000: 616c 6c79 3a0a 2020 2020 2020 2020 2020  ally:.          
+00029010: 2020 6966 206c 6f63 616c 5f66 696c 653a    if local_file:
+00029020: 0a20 2020 2020 2020 2020 2020 2020 2020  .               
+00029030: 2066 696c 652e 636c 6f73 6528 290a 0a20   file.close().. 
+00029040: 2020 2040 7072 6f70 6572 7479 0a20 2020     @property.   
+00029050: 2064 6566 2072 6566 6572 656e 6365 5f73   def reference_s
+00029060: 6571 7565 6e63 6528 7365 6c66 293a 0a20  equence(self):. 
+00029070: 2020 2020 2020 2022 2222 0a20 2020 2020         """.     
+00029080: 2020 2054 6865 203a 636c 6173 733a 602e     The :class:`.
+00029090: 5265 6665 7265 6e63 6553 6571 7565 6e63  ReferenceSequenc
+000290a0: 6560 2061 7373 6f63 6961 7465 6420 7769  e` associated wi
+000290b0: 7468 2074 6869 7320 3a63 6c61 7373 3a60  th this :class:`
+000290c0: 2e54 7265 6553 6571 7565 6e63 6560 0a20  .TreeSequence`. 
+000290d0: 2020 2020 2020 2069 6620 6f6e 6520 6973         if one is
+000290e0: 2064 6566 696e 6564 2028 7365 6520 3a6d   defined (see :m
+000290f0: 6574 683a 602e 5472 6565 5365 7175 656e  eth:`.TreeSequen
+00029100: 6365 2e68 6173 5f72 6566 6572 656e 6365  ce.has_reference
+00029110: 5f73 6571 7565 6e63 6560 292c 0a20 2020  _sequence`),.   
+00029120: 2020 2020 206f 7220 4e6f 6e65 206f 7468       or None oth
+00029130: 6572 7769 7365 2e0a 2020 2020 2020 2020  erwise..        
+00029140: 2222 220a 2020 2020 2020 2020 6966 2073  """.        if s
+00029150: 656c 662e 6861 735f 7265 6665 7265 6e63  elf.has_referenc
+00029160: 655f 7365 7175 656e 6365 2829 3a0a 2020  e_sequence():.  
+00029170: 2020 2020 2020 2020 2020 7265 7475 726e            return
+00029180: 2074 6162 6c65 732e 5265 6665 7265 6e63   tables.Referenc
+00029190: 6553 6571 7565 6e63 6528 7365 6c66 2e5f  eSequence(self._
+000291a0: 6c6c 5f74 7265 655f 7365 7175 656e 6365  ll_tree_sequence
+000291b0: 2e72 6566 6572 656e 6365 5f73 6571 7565  .reference_seque
+000291c0: 6e63 6529 0a20 2020 2020 2020 2072 6574  nce).        ret
+000291d0: 7572 6e20 4e6f 6e65 0a0a 2020 2020 6465  urn None..    de
+000291e0: 6620 6861 735f 7265 6665 7265 6e63 655f  f has_reference_
+000291f0: 7365 7175 656e 6365 2873 656c 6629 3a0a  sequence(self):.
+00029200: 2020 2020 2020 2020 2222 220a 2020 2020          """.    
+00029210: 2020 2020 5265 7475 726e 7320 5472 7565      Returns True
+00029220: 2069 6620 7468 6973 203a 636c 6173 733a   if this :class:
+00029230: 602e 5472 6565 5365 7175 656e 6365 6020  `.TreeSequence` 
+00029240: 6861 7320 616e 2061 7373 6f63 6961 7465  has an associate
+00029250: 640a 2020 2020 2020 2020 3a72 6566 3a60  d.        :ref:`
+00029260: 7265 6665 7265 6e63 6520 7365 7175 656e  reference sequen
+00029270: 6365 3c73 6563 5f64 6174 615f 6d6f 6465  ce<sec_data_mode
+00029280: 6c5f 7265 6665 7265 6e63 655f 7365 7175  l_reference_sequ
+00029290: 656e 6365 3e60 2e0a 2020 2020 2020 2020  ence>`..        
+000292a0: 2222 220a 2020 2020 2020 2020 7265 7475  """.        retu
+000292b0: 726e 2062 6f6f 6c28 7365 6c66 2e5f 6c6c  rn bool(self._ll
+000292c0: 5f74 7265 655f 7365 7175 656e 6365 2e68  _tree_sequence.h
+000292d0: 6173 5f72 6566 6572 656e 6365 5f73 6571  as_reference_seq
+000292e0: 7565 6e63 6528 2929 0a0a 2020 2020 4070  uence())..    @p
+000292f0: 726f 7065 7274 790a 2020 2020 6465 6620  roperty.    def 
+00029300: 7461 626c 6573 5f64 6963 7428 7365 6c66  tables_dict(self
+00029310: 293a 0a20 2020 2020 2020 2022 2222 0a20  ):.        """. 
+00029320: 2020 2020 2020 2052 6574 7572 6e73 2061         Returns a
+00029330: 2064 6963 7469 6f6e 6172 7920 6d61 7070   dictionary mapp
+00029340: 696e 6720 6e61 6d65 7320 746f 2074 6162  ing names to tab
+00029350: 6c65 7320 696e 2074 6865 0a20 2020 2020  les in the.     
+00029360: 2020 2075 6e64 6572 6c79 696e 6720 3a63     underlying :c
+00029370: 6c61 7373 3a60 2e54 6162 6c65 436f 6c6c  lass:`.TableColl
+00029380: 6563 7469 6f6e 602e 2045 7175 6976 616c  ection`. Equival
+00029390: 656e 7420 746f 2063 616c 6c69 6e67 0a20  ent to calling. 
+000293a0: 2020 2020 2020 2060 6074 732e 7461 626c         ``ts.tabl
+000293b0: 6573 2e74 6162 6c65 5f6e 616d 655f 6d61  es.table_name_ma
+000293c0: 7060 602e 0a20 2020 2020 2020 2022 2222  p``..        """
+000293d0: 0a20 2020 2020 2020 2072 6574 7572 6e20  .        return 
+000293e0: 7365 6c66 2e74 6162 6c65 732e 7461 626c  self.tables.tabl
+000293f0: 655f 6e61 6d65 5f6d 6170 0a0a 2020 2020  e_name_map..    
+00029400: 4070 726f 7065 7274 790a 2020 2020 6465  @property.    de
+00029410: 6620 7461 626c 6573 2873 656c 6629 3a0a  f tables(self):.
+00029420: 2020 2020 2020 2020 2222 220a 2020 2020          """.    
+00029430: 2020 2020 5265 7475 726e 7320 7468 6520      Returns the 
+00029440: 3a63 6c61 7373 3a60 7461 626c 6573 3c54  :class:`tables<T
+00029450: 6162 6c65 436f 6c6c 6563 7469 6f6e 3e60  ableCollection>`
+00029460: 2075 6e64 6572 6c79 696e 6720 7468 6973   underlying this
+00029470: 2074 7265 650a 2020 2020 2020 2020 7365   tree.        se
+00029480: 7175 656e 6365 2c20 696e 7465 6e64 6564  quence, intended
+00029490: 2066 6f72 2072 6561 642d 6f6e 6c79 2061   for read-only a
+000294a0: 6363 6573 732e 2053 6565 203a 6d65 7468  ccess. See :meth
+000294b0: 3a60 2e64 756d 705f 7461 626c 6573 6020  :`.dump_tables` 
+000294c0: 6966 2079 6f75 2077 6973 680a 2020 2020  if you wish.    
+000294d0: 2020 2020 746f 206d 6f64 6966 7920 7468      to modify th
+000294e0: 6520 7461 626c 6573 2e0a 0a20 2020 2020  e tables...     
+000294f0: 2020 202e 2e20 7761 726e 696e 673a 3a20     .. warning:: 
+00029500: 5468 6973 2070 726f 7065 7274 7920 6375  This property cu
+00029510: 7272 656e 746c 7920 7265 7475 726e 7320  rrently returns 
+00029520: 6120 636f 7079 206f 6620 7468 6520 7461  a copy of the ta
+00029530: 626c 6573 0a20 2020 2020 2020 2020 2020  bles.           
+00029540: 2075 6e64 6572 6c79 696e 6720 6120 7472   underlying a tr
+00029550: 6565 2073 6571 7565 6e63 6520 6275 7420  ee sequence but 
+00029560: 6974 206d 6179 2072 6574 7572 6e20 6120  it may return a 
+00029570: 7265 6164 2d6f 6e6c 790a 2020 2020 2020  read-only.      
+00029580: 2020 2020 2020 2a2a 7669 6577 2a2a 2069        **view** i
+00029590: 6e20 7468 6520 6675 7475 7265 2e20 5468  n the future. Th
+000295a0: 7573 2c20 6966 2074 6865 2074 6162 6c65  us, if the table
+000295b0: 7320 7769 6c6c 2073 7562 7365 7175 656e  s will subsequen
+000295c0: 746c 7920 6265 0a20 2020 2020 2020 2020  tly be.         
+000295d0: 2020 2075 7064 6174 6564 2c20 706c 6561     updated, plea
+000295e0: 7365 2075 7365 2074 6865 203a 6d65 7468  se use the :meth
+000295f0: 3a60 2e64 756d 705f 7461 626c 6573 6020  :`.dump_tables` 
+00029600: 6d65 7468 6f64 2069 6e73 7465 6164 2061  method instead a
+00029610: 730a 2020 2020 2020 2020 2020 2020 7468  s.            th
+00029620: 6973 2077 696c 6c20 616c 7761 7973 2072  is will always r
+00029630: 6574 7572 6e20 6120 6e65 7720 636f 7079  eturn a new copy
+00029640: 206f 6620 7468 6520 5461 626c 6543 6f6c   of the TableCol
+00029650: 6c65 6374 696f 6e2e 0a0a 2020 2020 2020  lection...      
+00029660: 2020 3a72 6574 7572 6e3a 2041 203a 636c    :return: A :cl
+00029670: 6173 733a 6054 6162 6c65 436f 6c6c 6563  ass:`TableCollec
+00029680: 7469 6f6e 6020 636f 6e74 6169 6e69 6e67  tion` containing
+00029690: 2061 6c6c 2061 2063 6f70 7920 6f66 2074   all a copy of t
+000296a0: 6865 0a20 2020 2020 2020 2020 2020 2074  he.            t
+000296b0: 6162 6c65 7320 756e 6465 726c 7969 6e67  ables underlying
+000296c0: 2074 6869 7320 7472 6565 2073 6571 7565   this tree seque
+000296d0: 6e63 652e 0a20 2020 2020 2020 203a 7274  nce..        :rt
+000296e0: 7970 653a 2054 6162 6c65 436f 6c6c 6563  ype: TableCollec
+000296f0: 7469 6f6e 0a20 2020 2020 2020 2022 2222  tion.        """
+00029700: 0a20 2020 2020 2020 2072 6574 7572 6e20  .        return 
+00029710: 7365 6c66 2e64 756d 705f 7461 626c 6573  self.dump_tables
+00029720: 2829 0a0a 2020 2020 4070 726f 7065 7274  ()..    @propert
+00029730: 790a 2020 2020 6465 6620 6e62 7974 6573  y.    def nbytes
+00029740: 2873 656c 6629 3a0a 2020 2020 2020 2020  (self):.        
+00029750: 2222 220a 2020 2020 2020 2020 5265 7475  """.        Retu
+00029760: 726e 7320 7468 6520 746f 7461 6c20 6e75  rns the total nu
+00029770: 6d62 6572 206f 6620 6279 7465 7320 7265  mber of bytes re
+00029780: 7175 6972 6564 2074 6f20 7374 6f72 6520  quired to store 
+00029790: 7468 6520 6461 7461 0a20 2020 2020 2020  the data.       
+000297a0: 2069 6e20 7468 6973 2074 7265 6520 7365   in this tree se
+000297b0: 7175 656e 6365 2e20 4e6f 7465 2074 6861  quence. Note tha
+000297c0: 7420 7468 6973 206d 6179 206e 6f74 2062  t this may not b
+000297d0: 6520 6571 7561 6c20 746f 0a20 2020 2020  e equal to.     
+000297e0: 2020 2074 6865 2061 6374 7561 6c20 6d65     the actual me
+000297f0: 6d6f 7279 2066 6f6f 7470 7269 6e74 2e0a  mory footprint..
+00029800: 2020 2020 2020 2020 2222 220a 2020 2020          """.    
+00029810: 2020 2020 7265 7475 726e 2073 656c 662e      return self.
+00029820: 7461 626c 6573 2e6e 6279 7465 730a 0a20  tables.nbytes.. 
+00029830: 2020 2064 6566 2064 756d 705f 7461 626c     def dump_tabl
+00029840: 6573 2873 656c 6629 3a0a 2020 2020 2020  es(self):.      
+00029850: 2020 2222 220a 2020 2020 2020 2020 5265    """.        Re
+00029860: 7475 726e 7320 6120 6d6f 6469 6669 6162  turns a modifiab
+00029870: 6c65 2063 6f70 7920 6f66 2074 6865 203a  le copy of the :
+00029880: 636c 6173 733a 6074 6162 6c65 733c 5461  class:`tables<Ta
+00029890: 626c 6543 6f6c 6c65 6374 696f 6e3e 6020  bleCollection>` 
+000298a0: 6465 6669 6e69 6e67 0a20 2020 2020 2020  defining.       
+000298b0: 2074 6869 7320 7472 6565 2073 6571 7565   this tree seque
+000298c0: 6e63 652e 0a0a 2020 2020 2020 2020 3a72  nce...        :r
+000298d0: 6574 7572 6e3a 2041 203a 636c 6173 733a  eturn: A :class:
+000298e0: 6054 6162 6c65 436f 6c6c 6563 7469 6f6e  `TableCollection
+000298f0: 6020 636f 6e74 6169 6e69 6e67 2061 6c6c  ` containing all
+00029900: 2074 6162 6c65 7320 756e 6465 726c 7969   tables underlyi
+00029910: 6e67 0a20 2020 2020 2020 2020 2020 2074  ng.            t
+00029920: 6865 2074 7265 6520 7365 7175 656e 6365  he tree sequence
+00029930: 2e0a 2020 2020 2020 2020 3a72 7479 7065  ..        :rtype
+00029940: 3a20 5461 626c 6543 6f6c 6c65 6374 696f  : TableCollectio
+00029950: 6e0a 2020 2020 2020 2020 2222 220a 2020  n.        """.  
+00029960: 2020 2020 2020 6c6c 5f74 6162 6c65 7320        ll_tables 
+00029970: 3d20 5f74 736b 6974 2e54 6162 6c65 436f  = _tskit.TableCo
+00029980: 6c6c 6563 7469 6f6e 2873 656c 662e 7365  llection(self.se
+00029990: 7175 656e 6365 5f6c 656e 6774 6829 0a20  quence_length). 
+000299a0: 2020 2020 2020 2073 656c 662e 5f6c 6c5f         self._ll_
+000299b0: 7472 6565 5f73 6571 7565 6e63 652e 6475  tree_sequence.du
+000299c0: 6d70 5f74 6162 6c65 7328 6c6c 5f74 6162  mp_tables(ll_tab
+000299d0: 6c65 7329 0a20 2020 2020 2020 2072 6574  les).        ret
+000299e0: 7572 6e20 7461 626c 6573 2e54 6162 6c65  urn tables.Table
+000299f0: 436f 6c6c 6563 7469 6f6e 286c 6c5f 7461  Collection(ll_ta
+00029a00: 626c 6573 3d6c 6c5f 7461 626c 6573 290a  bles=ll_tables).
+00029a10: 0a20 2020 2064 6566 2064 756d 705f 7465  .    def dump_te
+00029a20: 7874 280a 2020 2020 2020 2020 7365 6c66  xt(.        self
+00029a30: 2c0a 2020 2020 2020 2020 6e6f 6465 733d  ,.        nodes=
+00029a40: 4e6f 6e65 2c0a 2020 2020 2020 2020 6564  None,.        ed
+00029a50: 6765 733d 4e6f 6e65 2c0a 2020 2020 2020  ges=None,.      
+00029a60: 2020 7369 7465 733d 4e6f 6e65 2c0a 2020    sites=None,.  
+00029a70: 2020 2020 2020 6d75 7461 7469 6f6e 733d        mutations=
+00029a80: 4e6f 6e65 2c0a 2020 2020 2020 2020 696e  None,.        in
+00029a90: 6469 7669 6475 616c 733d 4e6f 6e65 2c0a  dividuals=None,.
+00029aa0: 2020 2020 2020 2020 706f 7075 6c61 7469          populati
+00029ab0: 6f6e 733d 4e6f 6e65 2c0a 2020 2020 2020  ons=None,.      
+00029ac0: 2020 6d69 6772 6174 696f 6e73 3d4e 6f6e    migrations=Non
+00029ad0: 652c 0a20 2020 2020 2020 2070 726f 7665  e,.        prove
+00029ae0: 6e61 6e63 6573 3d4e 6f6e 652c 0a20 2020  nances=None,.   
+00029af0: 2020 2020 2070 7265 6369 7369 6f6e 3d36       precision=6
+00029b00: 2c0a 2020 2020 2020 2020 656e 636f 6469  ,.        encodi
+00029b10: 6e67 3d22 7574 6638 222c 0a20 2020 2020  ng="utf8",.     
+00029b20: 2020 2062 6173 6536 345f 6d65 7461 6461     base64_metada
+00029b30: 7461 3d54 7275 652c 0a20 2020 2029 3a0a  ta=True,.    ):.
+00029b40: 2020 2020 2020 2020 2222 220a 2020 2020          """.    
+00029b50: 2020 2020 5772 6974 6573 2061 2074 6578      Writes a tex
+00029b60: 7420 7265 7072 6573 656e 7461 7469 6f6e  t representation
+00029b70: 206f 6620 7468 6520 7461 626c 6573 2075   of the tables u
+00029b80: 6e64 6572 6c79 696e 6720 7468 6520 7472  nderlying the tr
+00029b90: 6565 2073 6571 7565 6e63 650a 2020 2020  ee sequence.    
+00029ba0: 2020 2020 746f 2074 6865 2073 7065 6369      to the speci
+00029bb0: 6669 6564 2063 6f6e 6e65 6374 696f 6e73  fied connections
+00029bc0: 2e0a 0a20 2020 2020 2020 2049 6620 4261  ...        If Ba
+00029bd0: 7365 3634 2065 6e63 6f64 696e 6720 6973  se64 encoding is
+00029be0: 206e 6f74 2075 7365 642c 2074 6865 6e20   not used, then 
+00029bf0: 6d65 7461 6461 7461 2077 696c 6c20 6265  metadata will be
+00029c00: 2073 6176 6564 2064 6972 6563 746c 792c   saved directly,
+00029c10: 2070 6f73 7369 626c 790a 2020 2020 2020   possibly.      
+00029c20: 2020 7265 7375 6c74 696e 6720 696e 2065    resulting in e
+00029c30: 7272 6f72 7320 7265 6164 696e 6720 7468  rrors reading th
+00029c40: 6520 7461 626c 6573 2062 6163 6b20 696e  e tables back in
+00029c50: 2069 6620 6d65 7461 6461 7461 2069 6e63   if metadata inc
+00029c60: 6c75 6465 7320 7768 6974 6573 7061 6365  ludes whitespace
+00029c70: 2e0a 0a20 2020 2020 2020 203a 7061 7261  ...        :para
+00029c80: 6d20 696f 2e54 6578 7449 4f42 6173 6520  m io.TextIOBase 
+00029c90: 6e6f 6465 733a 2054 6865 2066 696c 652d  nodes: The file-
+00029ca0: 6c69 6b65 206f 626a 6563 7420 2868 6176  like object (hav
+00029cb0: 696e 6720 6120 2e77 7269 7465 2829 206d  ing a .write() m
+00029cc0: 6574 686f 6429 2074 6f0a 2020 2020 2020  ethod) to.      
+00029cd0: 2020 2020 2020 7772 6974 6520 7468 6520        write the 
+00029ce0: 4e6f 6465 5461 626c 6520 746f 2e0a 2020  NodeTable to..  
+00029cf0: 2020 2020 2020 3a70 6172 616d 2069 6f2e        :param io.
+00029d00: 5465 7874 494f 4261 7365 2065 6467 6573  TextIOBase edges
+00029d10: 3a20 5468 6520 6669 6c65 2d6c 696b 6520  : The file-like 
+00029d20: 6f62 6a65 6374 2074 6f20 7772 6974 6520  object to write 
+00029d30: 7468 6520 4564 6765 5461 626c 6520 746f  the EdgeTable to
+00029d40: 2e0a 2020 2020 2020 2020 3a70 6172 616d  ..        :param
+00029d50: 2069 6f2e 5465 7874 494f 4261 7365 2073   io.TextIOBase s
+00029d60: 6974 6573 3a20 5468 6520 6669 6c65 2d6c  ites: The file-l
+00029d70: 696b 6520 6f62 6a65 6374 2074 6f20 7772  ike object to wr
+00029d80: 6974 6520 7468 6520 5369 7465 5461 626c  ite the SiteTabl
+00029d90: 6520 746f 2e0a 2020 2020 2020 2020 3a70  e to..        :p
+00029da0: 6172 616d 2069 6f2e 5465 7874 494f 4261  aram io.TextIOBa
+00029db0: 7365 206d 7574 6174 696f 6e73 3a20 5468  se mutations: Th
+00029dc0: 6520 6669 6c65 2d6c 696b 6520 6f62 6a65  e file-like obje
+00029dd0: 6374 2074 6f20 7772 6974 6520 7468 650a  ct to write the.
+00029de0: 2020 2020 2020 2020 2020 2020 4d75 7461              Muta
+00029df0: 7469 6f6e 5461 626c 6520 746f 2e0a 2020  tionTable to..  
+00029e00: 2020 2020 2020 3a70 6172 616d 2069 6f2e        :param io.
+00029e10: 5465 7874 494f 4261 7365 2069 6e64 6976  TextIOBase indiv
+00029e20: 6964 7561 6c73 3a20 5468 6520 6669 6c65  iduals: The file
+00029e30: 2d6c 696b 6520 6f62 6a65 6374 2074 6f20  -like object to 
+00029e40: 7772 6974 6520 7468 650a 2020 2020 2020  write the.      
+00029e50: 2020 2020 2020 496e 6469 7669 6475 616c        Individual
+00029e60: 5461 626c 6520 746f 2e0a 2020 2020 2020  Table to..      
+00029e70: 2020 3a70 6172 616d 2069 6f2e 5465 7874    :param io.Text
+00029e80: 494f 4261 7365 2070 6f70 756c 6174 696f  IOBase populatio
+00029e90: 6e73 3a20 5468 6520 6669 6c65 2d6c 696b  ns: The file-lik
+00029ea0: 6520 6f62 6a65 6374 2074 6f20 7772 6974  e object to writ
+00029eb0: 6520 7468 650a 2020 2020 2020 2020 2020  e the.          
+00029ec0: 2020 506f 7075 6c61 7469 6f6e 5461 626c    PopulationTabl
+00029ed0: 6520 746f 2e0a 2020 2020 2020 2020 3a70  e to..        :p
+00029ee0: 6172 616d 2069 6f2e 5465 7874 494f 4261  aram io.TextIOBa
+00029ef0: 7365 206d 6967 7261 7469 6f6e 733a 2054  se migrations: T
+00029f00: 6865 2066 696c 652d 6c69 6b65 206f 626a  he file-like obj
+00029f10: 6563 7420 746f 2077 7269 7465 2074 6865  ect to write the
+00029f20: 0a20 2020 2020 2020 2020 2020 204d 6967  .            Mig
+00029f30: 7261 7469 6f6e 5461 626c 6520 746f 2e0a  rationTable to..
+00029f40: 2020 2020 2020 2020 3a70 6172 616d 2069          :param i
+00029f50: 6f2e 5465 7874 494f 4261 7365 2070 726f  o.TextIOBase pro
+00029f60: 7665 6e61 6e63 6573 3a20 5468 6520 6669  venances: The fi
+00029f70: 6c65 2d6c 696b 6520 6f62 6a65 6374 2074  le-like object t
+00029f80: 6f20 7772 6974 6520 7468 650a 2020 2020  o write the.    
+00029f90: 2020 2020 2020 2020 5072 6f76 656e 616e          Provenan
+00029fa0: 6365 5461 626c 6520 746f 2e0a 2020 2020  ceTable to..    
+00029fb0: 2020 2020 3a70 6172 616d 2069 6e74 2070      :param int p
+00029fc0: 7265 6369 7369 6f6e 3a20 5468 6520 6e75  recision: The nu
+00029fd0: 6d62 6572 206f 6620 6469 6769 7473 206f  mber of digits o
+00029fe0: 6620 7072 6563 6973 696f 6e2e 0a20 2020  f precision..   
+00029ff0: 2020 2020 203a 7061 7261 6d20 7374 7220       :param str 
+0002a000: 656e 636f 6469 6e67 3a20 456e 636f 6469  encoding: Encodi
+0002a010: 6e67 2075 7365 6420 666f 7220 7465 7874  ng used for text
+0002a020: 2072 6570 7265 7365 6e74 6174 696f 6e2e   representation.
+0002a030: 0a20 2020 2020 2020 203a 7061 7261 6d20  .        :param 
+0002a040: 626f 6f6c 2062 6173 6536 345f 6d65 7461  bool base64_meta
+0002a050: 6461 7461 3a20 4f6e 6c79 2075 7365 6420  data: Only used 
+0002a060: 6966 2061 2073 6368 656d 6120 6973 206e  if a schema is n
+0002a070: 6f74 2070 7265 7365 6e74 206f 6e20 6561  ot present on ea
+0002a080: 6368 2074 6162 6c65 0a20 2020 2020 2020  ch table.       
+0002a090: 2020 2020 2062 6569 6e67 2064 756d 7065       being dumpe
+0002a0a0: 642e 2049 6620 5472 7565 2c20 6d65 7461  d. If True, meta
+0002a0b0: 6461 7461 2069 7320 656e 636f 6465 6420  data is encoded 
+0002a0c0: 7573 696e 6720 4261 7365 3634 0a20 2020  using Base64.   
+0002a0d0: 2020 2020 2020 2020 2065 6e63 6f64 696e           encodin
+0002a0e0: 673b 206f 7468 6572 7769 7365 2c20 6173  g; otherwise, as
+0002a0f0: 2070 6c61 696e 2074 6578 742e 0a20 2020   plain text..   
+0002a100: 2020 2020 2022 2222 0a20 2020 2020 2020       """.       
+0002a110: 2074 6578 745f 666f 726d 6174 732e 6475   text_formats.du
+0002a120: 6d70 5f74 6578 7428 0a20 2020 2020 2020  mp_text(.       
+0002a130: 2020 2020 2073 656c 662c 0a20 2020 2020       self,.     
+0002a140: 2020 2020 2020 206e 6f64 6573 3d6e 6f64         nodes=nod
+0002a150: 6573 2c0a 2020 2020 2020 2020 2020 2020  es,.            
+0002a160: 6564 6765 733d 6564 6765 732c 0a20 2020  edges=edges,.   
+0002a170: 2020 2020 2020 2020 2073 6974 6573 3d73           sites=s
+0002a180: 6974 6573 2c0a 2020 2020 2020 2020 2020  ites,.          
+0002a190: 2020 6d75 7461 7469 6f6e 733d 6d75 7461    mutations=muta
+0002a1a0: 7469 6f6e 732c 0a20 2020 2020 2020 2020  tions,.         
+0002a1b0: 2020 2069 6e64 6976 6964 7561 6c73 3d69     individuals=i
+0002a1c0: 6e64 6976 6964 7561 6c73 2c0a 2020 2020  ndividuals,.    
+0002a1d0: 2020 2020 2020 2020 706f 7075 6c61 7469          populati
+0002a1e0: 6f6e 733d 706f 7075 6c61 7469 6f6e 732c  ons=populations,
+0002a1f0: 0a20 2020 2020 2020 2020 2020 206d 6967  .            mig
+0002a200: 7261 7469 6f6e 733d 6d69 6772 6174 696f  rations=migratio
+0002a210: 6e73 2c0a 2020 2020 2020 2020 2020 2020  ns,.            
+0002a220: 7072 6f76 656e 616e 6365 733d 7072 6f76  provenances=prov
+0002a230: 656e 616e 6365 732c 0a20 2020 2020 2020  enances,.       
+0002a240: 2020 2020 2070 7265 6369 7369 6f6e 3d70       precision=p
+0002a250: 7265 6369 7369 6f6e 2c0a 2020 2020 2020  recision,.      
+0002a260: 2020 2020 2020 656e 636f 6469 6e67 3d65        encoding=e
+0002a270: 6e63 6f64 696e 672c 0a20 2020 2020 2020  ncoding,.       
+0002a280: 2020 2020 2062 6173 6536 345f 6d65 7461       base64_meta
+0002a290: 6461 7461 3d62 6173 6536 345f 6d65 7461  data=base64_meta
+0002a2a0: 6461 7461 2c0a 2020 2020 2020 2020 290a  data,.        ).
+0002a2b0: 0a20 2020 2064 6566 205f 5f73 7472 5f5f  .    def __str__
+0002a2c0: 2873 656c 6629 3a0a 2020 2020 2020 2020  (self):.        
+0002a2d0: 2222 220a 2020 2020 2020 2020 5265 7475  """.        Retu
+0002a2e0: 726e 2061 2070 6c61 696e 2074 6578 7420  rn a plain text 
+0002a2f0: 7375 6d6d 6172 7920 6f66 2074 6865 2063  summary of the c
+0002a300: 6f6e 7465 6e74 7320 6f66 2061 2074 7265  ontents of a tre
+0002a310: 6520 7365 7175 656e 6365 0a20 2020 2020  e sequence.     
+0002a320: 2020 2022 2222 0a20 2020 2020 2020 2074     """.        t
+0002a330: 735f 726f 7773 203d 205b 0a20 2020 2020  s_rows = [.     
+0002a340: 2020 2020 2020 205b 2254 7265 6573 222c         ["Trees",
+0002a350: 2073 7472 2873 656c 662e 6e75 6d5f 7472   str(self.num_tr
+0002a360: 6565 7329 5d2c 0a20 2020 2020 2020 2020  ees)],.         
+0002a370: 2020 205b 0a20 2020 2020 2020 2020 2020     [.           
+0002a380: 2020 2020 2022 5365 7175 656e 6365 204c       "Sequence L
+0002a390: 656e 6774 6822 2c0a 2020 2020 2020 2020  ength",.        
+0002a3a0: 2020 2020 2020 2020 7374 7228 0a20 2020          str(.   
+0002a3b0: 2020 2020 2020 2020 2020 2020 2020 2020                  
+0002a3c0: 2069 6e74 2873 656c 662e 7365 7175 656e   int(self.sequen
+0002a3d0: 6365 5f6c 656e 6774 6829 0a20 2020 2020  ce_length).     
+0002a3e0: 2020 2020 2020 2020 2020 2020 2020 2069                 i
+0002a3f0: 6620 7365 6c66 2e64 6973 6372 6574 655f  f self.discrete_
+0002a400: 6765 6e6f 6d65 0a20 2020 2020 2020 2020  genome.         
+0002a410: 2020 2020 2020 2020 2020 2065 6c73 6520             else 
+0002a420: 7365 6c66 2e73 6571 7565 6e63 655f 6c65  self.sequence_le
+0002a430: 6e67 7468 0a20 2020 2020 2020 2020 2020  ngth.           
+0002a440: 2020 2020 2029 2c0a 2020 2020 2020 2020       ),.        
+0002a450: 2020 2020 5d2c 0a20 2020 2020 2020 2020      ],.         
+0002a460: 2020 205b 2254 696d 6520 556e 6974 7322     ["Time Units"
+0002a470: 2c20 7365 6c66 2e74 696d 655f 756e 6974  , self.time_unit
+0002a480: 735d 2c0a 2020 2020 2020 2020 2020 2020  s],.            
+0002a490: 5b22 5361 6d70 6c65 204e 6f64 6573 222c  ["Sample Nodes",
+0002a4a0: 2073 7472 2873 656c 662e 6e75 6d5f 7361   str(self.num_sa
+0002a4b0: 6d70 6c65 7329 5d2c 0a20 2020 2020 2020  mples)],.       
+0002a4c0: 2020 2020 205b 2254 6f74 616c 2053 697a       ["Total Siz
+0002a4d0: 6522 2c20 7574 696c 2e6e 6174 7572 616c  e", util.natural
+0002a4e0: 7369 7a65 2873 656c 662e 6e62 7974 6573  size(self.nbytes
+0002a4f0: 295d 2c0a 2020 2020 2020 2020 5d0a 2020  )],.        ].  
+0002a500: 2020 2020 2020 6865 6164 6572 203d 205b        header = [
+0002a510: 2254 6162 6c65 222c 2022 526f 7773 222c  "Table", "Rows",
+0002a520: 2022 5369 7a65 222c 2022 4861 7320 4d65   "Size", "Has Me
+0002a530: 7461 6461 7461 225d 0a20 2020 2020 2020  tadata"].       
+0002a540: 2074 6162 6c65 5f72 6f77 7320 3d20 5b5d   table_rows = []
+0002a550: 0a20 2020 2020 2020 2066 6f72 206e 616d  .        for nam
+0002a560: 652c 2074 6162 6c65 2069 6e20 7365 6c66  e, table in self
+0002a570: 2e74 6162 6c65 732e 7461 626c 655f 6e61  .tables.table_na
+0002a580: 6d65 5f6d 6170 2e69 7465 6d73 2829 3a0a  me_map.items():.
+0002a590: 2020 2020 2020 2020 2020 2020 7461 626c              tabl
+0002a5a0: 655f 726f 7773 2e61 7070 656e 6428 0a20  e_rows.append(. 
+0002a5b0: 2020 2020 2020 2020 2020 2020 2020 205b                 [
+0002a5c0: 0a20 2020 2020 2020 2020 2020 2020 2020  .               
+0002a5d0: 2020 2020 2073 7472 2873 290a 2020 2020       str(s).    
+0002a5e0: 2020 2020 2020 2020 2020 2020 2020 2020                  
+0002a5f0: 666f 7220 7320 696e 205b 0a20 2020 2020  for s in [.     
+0002a600: 2020 2020 2020 2020 2020 2020 2020 2020                  
+0002a610: 2020 206e 616d 652e 6361 7069 7461 6c69     name.capitali
+0002a620: 7a65 2829 2c0a 2020 2020 2020 2020 2020  ze(),.          
+0002a630: 2020 2020 2020 2020 2020 2020 2020 7461                ta
+0002a640: 626c 652e 6e75 6d5f 726f 7773 2c0a 2020  ble.num_rows,.  
 0002a650: 2020 2020 2020 2020 2020 2020 2020 2020                  
-0002a660: 2020 2022 5965 7322 0a20 2020 2020 2020     "Yes".       
-0002a670: 2020 2020 2020 2020 2020 2020 2020 2020                  
-0002a680: 2069 6620 6861 7361 7474 7228 7461 626c   if hasattr(tabl
-0002a690: 652c 2022 6d65 7461 6461 7461 2229 2061  e, "metadata") a
-0002a6a0: 6e64 206c 656e 2874 6162 6c65 2e6d 6574  nd len(table.met
-0002a6b0: 6164 6174 6129 203e 2030 0a20 2020 2020  adata) > 0.     
-0002a6c0: 2020 2020 2020 2020 2020 2020 2020 2020                  
-0002a6d0: 2020 2065 6c73 6520 224e 6f22 2c0a 2020     else "No",.  
-0002a6e0: 2020 2020 2020 2020 2020 2020 2020 2020                  
-0002a6f0: 2020 5d0a 2020 2020 2020 2020 2020 2020    ].            
-0002a700: 2020 2020 5d0a 2020 2020 2020 2020 2020      ].          
-0002a710: 2020 290a 2020 2020 2020 2020 7265 7475    ).        retu
-0002a720: 726e 2075 7469 6c2e 756e 6963 6f64 655f  rn util.unicode_
-0002a730: 7461 626c 6528 7473 5f72 6f77 732c 2074  table(ts_rows, t
-0002a740: 6974 6c65 3d22 5472 6565 5365 7175 656e  itle="TreeSequen
-0002a750: 6365 2229 202b 2075 7469 6c2e 756e 6963  ce") + util.unic
-0002a760: 6f64 655f 7461 626c 6528 0a20 2020 2020  ode_table(.     
-0002a770: 2020 2020 2020 2074 6162 6c65 5f72 6f77         table_row
-0002a780: 732c 2068 6561 6465 723d 6865 6164 6572  s, header=header
-0002a790: 0a20 2020 2020 2020 2029 0a0a 2020 2020  .        )..    
-0002a7a0: 6465 6620 5f72 6570 725f 6874 6d6c 5f28  def _repr_html_(
-0002a7b0: 7365 6c66 293a 0a20 2020 2020 2020 2022  self):.        "
-0002a7c0: 2222 0a20 2020 2020 2020 2052 6574 7572  "".        Retur
-0002a7d0: 6e20 616e 2068 746d 6c20 7375 6d6d 6172  n an html summar
-0002a7e0: 7920 6f66 2061 2074 7265 6520 7365 7175  y of a tree sequ
-0002a7f0: 656e 6365 2e20 4361 6c6c 6564 2062 7920  ence. Called by 
-0002a800: 6a75 7079 7465 7220 6e6f 7465 626f 6f6b  jupyter notebook
-0002a810: 730a 2020 2020 2020 2020 746f 2072 656e  s.        to ren
-0002a820: 6465 7220 6120 5472 6565 5365 7175 656e  der a TreeSequen
-0002a830: 6365 2e0a 2020 2020 2020 2020 2222 220a  ce..        """.
-0002a840: 2020 2020 2020 2020 7265 7475 726e 2075          return u
-0002a850: 7469 6c2e 7472 6565 5f73 6571 7565 6e63  til.tree_sequenc
-0002a860: 655f 6874 6d6c 2873 656c 6629 0a0a 2020  e_html(self)..  
-0002a870: 2020 2320 6e75 6d5f 7361 6d70 6c65 7320    # num_samples 
-0002a880: 7761 7320 6f72 6967 696e 616c 6c79 2063  was originally c
-0002a890: 616c 6c65 6420 7361 6d70 6c65 5f73 697a  alled sample_siz
-0002a8a0: 652c 2061 6e64 2073 6f20 7765 206d 7573  e, and so we mus
-0002a8b0: 7420 6b65 6570 2073 616d 706c 655f 7369  t keep sample_si
-0002a8c0: 7a65 0a20 2020 2023 2061 726f 756e 6420  ze.    # around 
-0002a8d0: 6173 2061 2064 6570 7265 6361 7465 6420  as a deprecated 
-0002a8e0: 616c 6961 732e 0a20 2020 2040 7072 6f70  alias..    @prop
-0002a8f0: 6572 7479 0a20 2020 2064 6566 206e 756d  erty.    def num
-0002a900: 5f73 616d 706c 6573 2873 656c 6629 3a0a  _samples(self):.
-0002a910: 2020 2020 2020 2020 2222 220a 2020 2020          """.    
-0002a920: 2020 2020 5265 7475 726e 7320 7468 6520      Returns the 
-0002a930: 6e75 6d62 6572 206f 6620 7361 6d70 6c65  number of sample
-0002a940: 206e 6f64 6573 2069 6e20 7468 6973 2074   nodes in this t
-0002a950: 7265 6520 7365 7175 656e 6365 2e20 5468  ree sequence. Th
-0002a960: 6973 2069 7320 616c 736f 2074 6865 0a20  is is also the. 
-0002a970: 2020 2020 2020 206e 756d 6265 7220 6f66         number of
-0002a980: 2073 616d 706c 6520 6e6f 6465 7320 696e   sample nodes in
-0002a990: 2065 6163 6820 7472 6565 2e0a 0a20 2020   each tree...   
-0002a9a0: 2020 2020 203a 7265 7475 726e 3a20 5468       :return: Th
-0002a9b0: 6520 6e75 6d62 6572 206f 6620 7361 6d70  e number of samp
-0002a9c0: 6c65 206e 6f64 6573 2069 6e20 7468 6973  le nodes in this
-0002a9d0: 2074 7265 6520 7365 7175 656e 6365 2e0a   tree sequence..
-0002a9e0: 2020 2020 2020 2020 3a72 7479 7065 3a20          :rtype: 
-0002a9f0: 696e 740a 2020 2020 2020 2020 2222 220a  int.        """.
-0002aa00: 2020 2020 2020 2020 7265 7475 726e 2073          return s
-0002aa10: 656c 662e 5f6c 6c5f 7472 6565 5f73 6571  elf._ll_tree_seq
-0002aa20: 7565 6e63 652e 6765 745f 6e75 6d5f 7361  uence.get_num_sa
-0002aa30: 6d70 6c65 7328 290a 0a20 2020 2040 7072  mples()..    @pr
-0002aa40: 6f70 6572 7479 0a20 2020 2064 6566 2074  operty.    def t
-0002aa50: 6162 6c65 5f6d 6574 6164 6174 615f 7363  able_metadata_sc
-0002aa60: 6865 6d61 7328 7365 6c66 2920 2d3e 2054  hemas(self) -> T
-0002aa70: 6162 6c65 4d65 7461 6461 7461 5363 6865  ableMetadataSche
-0002aa80: 6d61 733a 0a20 2020 2020 2020 2022 2222  mas:.        """
-0002aa90: 0a20 2020 2020 2020 2054 6865 2073 6574  .        The set
-0002aaa0: 206f 6620 6d65 7461 6461 7461 2073 6368   of metadata sch
-0002aab0: 656d 6173 2066 6f72 2074 6865 2074 6162  emas for the tab
-0002aac0: 6c65 7320 696e 2074 6869 7320 7472 6565  les in this tree
-0002aad0: 2073 6571 7565 6e63 652e 0a20 2020 2020   sequence..     
-0002aae0: 2020 2022 2222 0a20 2020 2020 2020 2072     """.        r
-0002aaf0: 6574 7572 6e20 7365 6c66 2e5f 7461 626c  eturn self._tabl
-0002ab00: 655f 6d65 7461 6461 7461 5f73 6368 656d  e_metadata_schem
-0002ab10: 6173 0a0a 2020 2020 4070 726f 7065 7274  as..    @propert
-0002ab20: 790a 2020 2020 6465 6620 7361 6d70 6c65  y.    def sample
-0002ab30: 5f73 697a 6528 7365 6c66 293a 0a20 2020  _size(self):.   
-0002ab40: 2020 2020 2023 2044 6570 7265 6361 7465       # Deprecate
-0002ab50: 6420 616c 6961 7320 666f 7220 6e75 6d5f  d alias for num_
-0002ab60: 7361 6d70 6c65 730a 2020 2020 2020 2020  samples.        
-0002ab70: 7265 7475 726e 2073 656c 662e 6e75 6d5f  return self.num_
-0002ab80: 7361 6d70 6c65 730a 0a20 2020 2064 6566  samples..    def
-0002ab90: 2067 6574 5f73 616d 706c 655f 7369 7a65   get_sample_size
-0002aba0: 2873 656c 6629 3a0a 2020 2020 2020 2020  (self):.        
-0002abb0: 2320 4465 7072 6563 6174 6564 2061 6c69  # Deprecated ali
-0002abc0: 6173 2066 6f72 206e 756d 5f73 616d 706c  as for num_sampl
-0002abd0: 6573 0a20 2020 2020 2020 2072 6574 7572  es.        retur
-0002abe0: 6e20 7365 6c66 2e6e 756d 5f73 616d 706c  n self.num_sampl
-0002abf0: 6573 0a0a 2020 2020 4070 726f 7065 7274  es..    @propert
-0002ac00: 790a 2020 2020 6465 6620 6669 6c65 5f75  y.    def file_u
-0002ac10: 7569 6428 7365 6c66 293a 0a20 2020 2020  uid(self):.     
-0002ac20: 2020 2072 6574 7572 6e20 7365 6c66 2e5f     return self._
-0002ac30: 6c6c 5f74 7265 655f 7365 7175 656e 6365  ll_tree_sequence
-0002ac40: 2e67 6574 5f66 696c 655f 7575 6964 2829  .get_file_uuid()
-0002ac50: 0a0a 2020 2020 4070 726f 7065 7274 790a  ..    @property.
-0002ac60: 2020 2020 6465 6620 6469 7363 7265 7465      def discrete
-0002ac70: 5f67 656e 6f6d 6528 7365 6c66 293a 0a20  _genome(self):. 
-0002ac80: 2020 2020 2020 2022 2222 0a20 2020 2020         """.     
-0002ac90: 2020 2052 6574 7572 6e73 2054 7275 6520     Returns True 
-0002aca0: 6966 2061 6c6c 2067 656e 6f6d 6520 636f  if all genome co
-0002acb0: 6f72 6469 6e61 7465 7320 696e 2074 6869  ordinates in thi
-0002acc0: 7320 5472 6565 5365 7175 656e 6365 2061  s TreeSequence a
-0002acd0: 7265 0a20 2020 2020 2020 2064 6973 6372  re.        discr
-0002ace0: 6574 6520 696e 7465 6765 7220 7661 6c75  ete integer valu
-0002acf0: 6573 2e20 5468 6973 2069 7320 7472 7565  es. This is true
-0002ad00: 2069 6666 2061 6c6c 2074 6865 2066 6f6c   iff all the fol
-0002ad10: 6c6f 7769 6e67 2061 7265 2074 7275 653a  lowing are true:
-0002ad20: 0a0a 2020 2020 2020 2020 2d20 5468 6520  ..        - The 
-0002ad30: 7365 7175 656e 6365 206c 656e 6774 6820  sequence length 
-0002ad40: 6973 2064 6973 6372 6574 650a 2020 2020  is discrete.    
-0002ad50: 2020 2020 2d20 416c 6c20 7369 7465 2070      - All site p
-0002ad60: 6f73 6974 696f 6e73 2061 7265 2064 6973  ositions are dis
-0002ad70: 6372 6574 650a 2020 2020 2020 2020 2d20  crete.        - 
-0002ad80: 416c 6c20 6c65 6674 2061 6e64 2072 6967  All left and rig
-0002ad90: 6874 2065 6467 6520 636f 6f72 6469 6e61  ht edge coordina
-0002ada0: 7465 7320 6172 6520 6469 7363 7265 7465  tes are discrete
-0002adb0: 0a20 2020 2020 2020 202d 2041 6c6c 206d  .        - All m
-0002adc0: 6967 7261 7469 6f6e 206c 6566 7420 616e  igration left an
-0002add0: 6420 7269 6768 7420 636f 6f72 6469 6e61  d right coordina
-0002ade0: 7465 7320 6172 6520 6469 7363 7265 7465  tes are discrete
-0002adf0: 0a0a 2020 2020 2020 2020 3a72 6574 7572  ..        :retur
-0002ae00: 6e3a 2054 7275 6520 6966 2074 6869 7320  n: True if this 
-0002ae10: 5472 6565 5365 7175 656e 6365 2075 7365  TreeSequence use
-0002ae20: 7320 6469 7363 7265 7465 2067 656e 6f6d  s discrete genom
-0002ae30: 6520 636f 6f72 6469 6e61 7465 732e 0a20  e coordinates.. 
-0002ae40: 2020 2020 2020 203a 7274 7970 653a 2062         :rtype: b
-0002ae50: 6f6f 6c0a 2020 2020 2020 2020 2222 220a  ool.        """.
-0002ae60: 2020 2020 2020 2020 7265 7475 726e 2062          return b
-0002ae70: 6f6f 6c28 7365 6c66 2e5f 6c6c 5f74 7265  ool(self._ll_tre
-0002ae80: 655f 7365 7175 656e 6365 2e67 6574 5f64  e_sequence.get_d
-0002ae90: 6973 6372 6574 655f 6765 6e6f 6d65 2829  iscrete_genome()
-0002aea0: 290a 0a20 2020 2040 7072 6f70 6572 7479  )..    @property
-0002aeb0: 0a20 2020 2064 6566 2064 6973 6372 6574  .    def discret
-0002aec0: 655f 7469 6d65 2873 656c 6629 3a0a 2020  e_time(self):.  
-0002aed0: 2020 2020 2020 2222 220a 2020 2020 2020        """.      
-0002aee0: 2020 5265 7475 726e 7320 5472 7565 2069    Returns True i
-0002aef0: 6620 616c 6c20 7469 6d65 2063 6f6f 7264  f all time coord
-0002af00: 696e 6174 6573 2069 6e20 7468 6973 2054  inates in this T
-0002af10: 7265 6553 6571 7565 6e63 6520 6172 650a  reeSequence are.
-0002af20: 2020 2020 2020 2020 6469 7363 7265 7465          discrete
-0002af30: 2069 6e74 6567 6572 2076 616c 7565 732e   integer values.
-0002af40: 2054 6869 7320 6973 2074 7275 6520 6966   This is true if
-0002af50: 6620 616c 6c20 7468 6520 666f 6c6c 6f77  f all the follow
-0002af60: 696e 6720 6172 6520 7472 7565 3a0a 0a20  ing are true:.. 
-0002af70: 2020 2020 2020 202d 2041 6c6c 206e 6f64         - All nod
-0002af80: 6520 7469 6d65 7320 6172 6520 6469 7363  e times are disc
-0002af90: 7265 7465 0a20 2020 2020 2020 202d 2041  rete.        - A
-0002afa0: 6c6c 206d 7574 6174 696f 6e20 7469 6d65  ll mutation time
-0002afb0: 7320 6172 6520 6469 7363 7265 7465 0a20  s are discrete. 
-0002afc0: 2020 2020 2020 202d 2041 6c6c 206d 6967         - All mig
-0002afd0: 7261 7469 6f6e 2074 696d 6573 2061 7265  ration times are
-0002afe0: 2064 6973 6372 6574 650a 0a20 2020 2020   discrete..     
-0002aff0: 2020 204e 6f74 6520 7468 6174 2060 6074     Note that ``t
-0002b000: 736b 6974 2e55 4e4b 4e4f 574e 5f54 494d  skit.UNKNOWN_TIM
-0002b010: 4560 6020 636f 756e 7473 2061 7320 6469  E`` counts as di
-0002b020: 7363 7265 7465 2e0a 0a20 2020 2020 2020  screte...       
-0002b030: 203a 7265 7475 726e 3a20 5472 7565 2069   :return: True i
-0002b040: 6620 7468 6973 2054 7265 6553 6571 7565  f this TreeSeque
-0002b050: 6e63 6520 7573 6573 2064 6973 6372 6574  nce uses discret
-0002b060: 6520 7469 6d65 2063 6f6f 7264 696e 6174  e time coordinat
-0002b070: 6573 2e0a 2020 2020 2020 2020 3a72 7479  es..        :rty
-0002b080: 7065 3a20 626f 6f6c 0a20 2020 2020 2020  pe: bool.       
-0002b090: 2022 2222 0a20 2020 2020 2020 2072 6574   """.        ret
-0002b0a0: 7572 6e20 626f 6f6c 2873 656c 662e 5f6c  urn bool(self._l
-0002b0b0: 6c5f 7472 6565 5f73 6571 7565 6e63 652e  l_tree_sequence.
-0002b0c0: 6765 745f 6469 7363 7265 7465 5f74 696d  get_discrete_tim
-0002b0d0: 6528 2929 0a0a 2020 2020 4070 726f 7065  e())..    @prope
-0002b0e0: 7274 790a 2020 2020 6465 6620 6d69 6e5f  rty.    def min_
-0002b0f0: 7469 6d65 2873 656c 6629 3a0a 2020 2020  time(self):.    
-0002b100: 2020 2020 2222 220a 2020 2020 2020 2020      """.        
-0002b110: 5265 7475 726e 7320 7468 6520 6d69 6e20  Returns the min 
-0002b120: 7469 6d65 2069 6e20 7468 6973 2074 7265  time in this tre
-0002b130: 6520 7365 7175 656e 6365 2e20 5468 6973  e sequence. This
-0002b140: 2069 7320 7468 6520 6d69 6e69 6d75 6d0a   is the minimum.
-0002b150: 2020 2020 2020 2020 6f66 2074 6865 206e          of the n
-0002b160: 6f64 6520 7469 6d65 7320 616e 6420 6d75  ode times and mu
-0002b170: 7461 7469 6f6e 2074 696d 6573 2e0a 0a20  tation times... 
-0002b180: 2020 2020 2020 204e 6f74 6520 7468 6174         Note that
-0002b190: 206d 7574 6174 696f 6e20 7469 6d65 7320   mutation times 
-0002b1a0: 7769 7468 2074 6865 2076 616c 7565 2060  with the value `
-0002b1b0: 6074 736b 6974 2e55 4e4b 4e4f 574e 5f54  `tskit.UNKNOWN_T
-0002b1c0: 494d 4560 600a 2020 2020 2020 2020 6172  IME``.        ar
-0002b1d0: 6520 6967 6e6f 7265 642e 0a0a 2020 2020  e ignored...    
-0002b1e0: 2020 2020 3a72 6574 7572 6e3a 2054 6865      :return: The
-0002b1f0: 206d 696e 2074 696d 6520 6f66 2074 6865   min time of the
-0002b200: 206e 6f64 6573 2061 6e64 206d 7574 6174   nodes and mutat
-0002b210: 696f 6e73 2069 6e20 7468 6973 2074 7265  ions in this tre
-0002b220: 6520 7365 7175 656e 6365 2e0a 2020 2020  e sequence..    
-0002b230: 2020 2020 3a72 7479 7065 3a20 666c 6f61      :rtype: floa
-0002b240: 740a 2020 2020 2020 2020 2222 220a 2020  t.        """.  
-0002b250: 2020 2020 2020 7265 7475 726e 2073 656c        return sel
-0002b260: 662e 5f6c 6c5f 7472 6565 5f73 6571 7565  f._ll_tree_seque
-0002b270: 6e63 652e 6765 745f 6d69 6e5f 7469 6d65  nce.get_min_time
-0002b280: 2829 0a0a 2020 2020 4070 726f 7065 7274  ()..    @propert
-0002b290: 790a 2020 2020 6465 6620 6d61 785f 7469  y.    def max_ti
-0002b2a0: 6d65 2873 656c 6629 3a0a 2020 2020 2020  me(self):.      
-0002b2b0: 2020 2222 220a 2020 2020 2020 2020 5265    """.        Re
-0002b2c0: 7475 726e 7320 7468 6520 6d61 7820 7469  turns the max ti
-0002b2d0: 6d65 2069 6e20 7468 6973 2074 7265 6520  me in this tree 
-0002b2e0: 7365 7175 656e 6365 2e20 5468 6973 2069  sequence. This i
-0002b2f0: 7320 7468 6520 6d61 7869 6d75 6d0a 2020  s the maximum.  
-0002b300: 2020 2020 2020 6f66 2074 6865 206e 6f64        of the nod
-0002b310: 6520 7469 6d65 7320 616e 6420 6d75 7461  e times and muta
-0002b320: 7469 6f6e 2074 696d 6573 2e0a 0a20 2020  tion times...   
-0002b330: 2020 2020 204e 6f74 6520 7468 6174 206d       Note that m
-0002b340: 7574 6174 696f 6e20 7469 6d65 7320 7769  utation times wi
-0002b350: 7468 2074 6865 2076 616c 7565 2060 6074  th the value ``t
-0002b360: 736b 6974 2e55 4e4b 4e4f 574e 5f54 494d  skit.UNKNOWN_TIM
-0002b370: 4560 600a 2020 2020 2020 2020 6172 6520  E``.        are 
-0002b380: 6967 6e6f 7265 642e 0a0a 2020 2020 2020  ignored...      
-0002b390: 2020 3a72 6574 7572 6e3a 2054 6865 206d    :return: The m
-0002b3a0: 6178 2074 696d 6520 6f66 2074 6865 206e  ax time of the n
-0002b3b0: 6f64 6573 2061 6e64 206d 7574 6174 696f  odes and mutatio
-0002b3c0: 6e73 2069 6e20 7468 6973 2074 7265 6520  ns in this tree 
-0002b3d0: 7365 7175 656e 6365 2e0a 2020 2020 2020  sequence..      
-0002b3e0: 2020 3a72 7479 7065 3a20 666c 6f61 740a    :rtype: float.
-0002b3f0: 2020 2020 2020 2020 2222 220a 2020 2020          """.    
-0002b400: 2020 2020 7265 7475 726e 2073 656c 662e      return self.
-0002b410: 5f6c 6c5f 7472 6565 5f73 6571 7565 6e63  _ll_tree_sequenc
-0002b420: 652e 6765 745f 6d61 785f 7469 6d65 2829  e.get_max_time()
-0002b430: 0a0a 2020 2020 4070 726f 7065 7274 790a  ..    @property.
-0002b440: 2020 2020 6465 6620 7365 7175 656e 6365      def sequence
-0002b450: 5f6c 656e 6774 6828 7365 6c66 293a 0a20  _length(self):. 
-0002b460: 2020 2020 2020 2022 2222 0a20 2020 2020         """.     
-0002b470: 2020 2052 6574 7572 6e73 2074 6865 2073     Returns the s
-0002b480: 6571 7565 6e63 6520 6c65 6e67 7468 2069  equence length i
-0002b490: 6e20 7468 6973 2074 7265 6520 7365 7175  n this tree sequ
-0002b4a0: 656e 6365 2e20 5468 6973 2064 6566 696e  ence. This defin
-0002b4b0: 6573 2074 6865 0a20 2020 2020 2020 2067  es the.        g
-0002b4c0: 656e 6f6d 6963 2073 6361 6c65 206f 7665  enomic scale ove
-0002b4d0: 7220 7768 6963 6820 7472 6565 2063 6f6f  r which tree coo
-0002b4e0: 7264 696e 6174 6573 2061 7265 2064 6566  rdinates are def
-0002b4f0: 696e 6564 2e20 4769 7665 6e20 610a 2020  ined. Given a.  
-0002b500: 2020 2020 2020 7472 6565 2073 6571 7565        tree seque
-0002b510: 6e63 6520 7769 7468 2061 2073 6571 7565  nce with a seque
-0002b520: 6e63 6520 6c65 6e67 7468 203a 6d61 7468  nce length :math
-0002b530: 3a60 4c60 2c20 7468 6520 636f 6e73 7469  :`L`, the consti
-0002b540: 7475 656e 740a 2020 2020 2020 2020 7472  tuent.        tr
-0002b550: 6565 7320 7769 6c6c 2062 6520 6465 6669  ees will be defi
-0002b560: 6e65 6420 6f76 6572 2074 6865 2068 616c  ned over the hal
-0002b570: 662d 636c 6f73 6564 2069 6e74 6572 7661  f-closed interva
-0002b580: 6c0a 2020 2020 2020 2020 3a6d 6174 683a  l.        :math:
-0002b590: 605b 302c 204c 2960 2e20 4561 6368 2074  `[0, L)`. Each t
-0002b5a0: 7265 6520 7468 656e 2063 6f76 6572 7320  ree then covers 
-0002b5b0: 736f 6d65 2073 7562 7365 7420 6f66 2074  some subset of t
-0002b5c0: 6869 730a 2020 2020 2020 2020 696e 7465  his.        inte
-0002b5d0: 7276 616c 202d 2d2d 2073 6565 203a 6174  rval --- see :at
-0002b5e0: 7472 3a60 7473 6b69 742e 5472 6565 2e69  tr:`tskit.Tree.i
-0002b5f0: 6e74 6572 7661 6c60 2066 6f72 2064 6574  nterval` for det
-0002b600: 6169 6c73 2e0a 0a20 2020 2020 2020 203a  ails...        :
-0002b610: 7265 7475 726e 3a20 5468 6520 6c65 6e67  return: The leng
-0002b620: 7468 206f 6620 7468 6520 7365 7175 656e  th of the sequen
-0002b630: 6365 2069 6e20 7468 6973 2074 7265 6520  ce in this tree 
-0002b640: 7365 7175 656e 6365 2069 6e20 6261 7365  sequence in base
-0002b650: 732e 0a20 2020 2020 2020 203a 7274 7970  s..        :rtyp
-0002b660: 653a 2066 6c6f 6174 0a20 2020 2020 2020  e: float.       
-0002b670: 2022 2222 0a20 2020 2020 2020 2072 6574   """.        ret
-0002b680: 7572 6e20 7365 6c66 2e67 6574 5f73 6571  urn self.get_seq
-0002b690: 7565 6e63 655f 6c65 6e67 7468 2829 0a0a  uence_length()..
-0002b6a0: 2020 2020 6465 6620 6765 745f 7365 7175      def get_sequ
-0002b6b0: 656e 6365 5f6c 656e 6774 6828 7365 6c66  ence_length(self
-0002b6c0: 293a 0a20 2020 2020 2020 2072 6574 7572  ):.        retur
-0002b6d0: 6e20 7365 6c66 2e5f 6c6c 5f74 7265 655f  n self._ll_tree_
-0002b6e0: 7365 7175 656e 6365 2e67 6574 5f73 6571  sequence.get_seq
-0002b6f0: 7565 6e63 655f 6c65 6e67 7468 2829 0a0a  uence_length()..
-0002b700: 2020 2020 4070 726f 7065 7274 790a 2020      @property.  
-0002b710: 2020 6465 6620 6d65 7461 6461 7461 2873    def metadata(s
-0002b720: 656c 6629 202d 3e20 416e 793a 0a20 2020  elf) -> Any:.   
-0002b730: 2020 2020 2022 2222 0a20 2020 2020 2020       """.       
-0002b740: 2054 6865 2064 6563 6f64 6564 206d 6574   The decoded met
-0002b750: 6164 6174 6120 666f 7220 7468 6973 2054  adata for this T
-0002b760: 7265 6553 6571 7565 6e63 652e 0a20 2020  reeSequence..   
-0002b770: 2020 2020 2022 2222 0a20 2020 2020 2020       """.       
-0002b780: 2072 6574 7572 6e20 7365 6c66 2e6d 6574   return self.met
-0002b790: 6164 6174 615f 7363 6865 6d61 2e64 6563  adata_schema.dec
-0002b7a0: 6f64 655f 726f 7728 7365 6c66 2e5f 6c6c  ode_row(self._ll
-0002b7b0: 5f74 7265 655f 7365 7175 656e 6365 2e67  _tree_sequence.g
-0002b7c0: 6574 5f6d 6574 6164 6174 6128 2929 0a0a  et_metadata())..
-0002b7d0: 2020 2020 4070 726f 7065 7274 790a 2020      @property.  
-0002b7e0: 2020 6465 6620 6d65 7461 6461 7461 5f73    def metadata_s
-0002b7f0: 6368 656d 6128 7365 6c66 2920 2d3e 206d  chema(self) -> m
-0002b800: 6574 6164 6174 615f 6d6f 6475 6c65 2e4d  etadata_module.M
-0002b810: 6574 6164 6174 6153 6368 656d 613a 0a20  etadataSchema:. 
-0002b820: 2020 2020 2020 2022 2222 0a20 2020 2020         """.     
-0002b830: 2020 2054 6865 203a 636c 6173 733a 6074     The :class:`t
-0002b840: 736b 6974 2e4d 6574 6164 6174 6153 6368  skit.MetadataSch
-0002b850: 656d 6160 2066 6f72 2074 6869 7320 5472  ema` for this Tr
-0002b860: 6565 5365 7175 656e 6365 2e0a 2020 2020  eeSequence..    
-0002b870: 2020 2020 2222 220a 2020 2020 2020 2020      """.        
-0002b880: 7265 7475 726e 206d 6574 6164 6174 615f  return metadata_
-0002b890: 6d6f 6475 6c65 2e70 6172 7365 5f6d 6574  module.parse_met
-0002b8a0: 6164 6174 615f 7363 6865 6d61 280a 2020  adata_schema(.  
-0002b8b0: 2020 2020 2020 2020 2020 7365 6c66 2e5f            self._
-0002b8c0: 6c6c 5f74 7265 655f 7365 7175 656e 6365  ll_tree_sequence
-0002b8d0: 2e67 6574 5f6d 6574 6164 6174 615f 7363  .get_metadata_sc
-0002b8e0: 6865 6d61 2829 0a20 2020 2020 2020 2029  hema().        )
-0002b8f0: 0a0a 2020 2020 4070 726f 7065 7274 790a  ..    @property.
-0002b900: 2020 2020 6465 6620 7469 6d65 5f75 6e69      def time_uni
-0002b910: 7473 2873 656c 6629 202d 3e20 7374 723a  ts(self) -> str:
-0002b920: 0a20 2020 2020 2020 2022 2222 0a20 2020  .        """.   
-0002b930: 2020 2020 2053 7472 696e 6720 6465 7363       String desc
-0002b940: 7269 6269 6e67 2074 6865 2075 6e69 7473  ribing the units
-0002b950: 206f 6620 7468 6520 7469 6d65 2064 696d   of the time dim
-0002b960: 656e 7369 6f6e 2066 6f72 2074 6869 7320  ension for this 
-0002b970: 5472 6565 5365 7175 656e 6365 2e0a 2020  TreeSequence..  
-0002b980: 2020 2020 2020 2222 220a 2020 2020 2020        """.      
-0002b990: 2020 7265 7475 726e 2073 656c 662e 5f6c    return self._l
-0002b9a0: 6c5f 7472 6565 5f73 6571 7565 6e63 652e  l_tree_sequence.
-0002b9b0: 6765 745f 7469 6d65 5f75 6e69 7473 2829  get_time_units()
-0002b9c0: 0a0a 2020 2020 4070 726f 7065 7274 790a  ..    @property.
-0002b9d0: 2020 2020 6465 6620 6e75 6d5f 6564 6765      def num_edge
-0002b9e0: 7328 7365 6c66 293a 0a20 2020 2020 2020  s(self):.       
-0002b9f0: 2022 2222 0a20 2020 2020 2020 2052 6574   """.        Ret
-0002ba00: 7572 6e73 2074 6865 206e 756d 6265 7220  urns the number 
-0002ba10: 6f66 203a 7265 663a 6065 6467 6573 203c  of :ref:`edges <
-0002ba20: 7365 635f 6564 6765 5f74 6162 6c65 5f64  sec_edge_table_d
-0002ba30: 6566 696e 6974 696f 6e3e 6020 696e 2074  efinition>` in t
-0002ba40: 6869 730a 2020 2020 2020 2020 7472 6565  his.        tree
-0002ba50: 2073 6571 7565 6e63 652e 0a0a 2020 2020   sequence...    
-0002ba60: 2020 2020 3a72 6574 7572 6e3a 2054 6865      :return: The
-0002ba70: 206e 756d 6265 7220 6f66 2065 6467 6573   number of edges
-0002ba80: 2069 6e20 7468 6973 2074 7265 6520 7365   in this tree se
-0002ba90: 7175 656e 6365 2e0a 2020 2020 2020 2020  quence..        
-0002baa0: 3a72 7479 7065 3a20 696e 740a 2020 2020  :rtype: int.    
-0002bab0: 2020 2020 2222 220a 2020 2020 2020 2020      """.        
-0002bac0: 7265 7475 726e 2073 656c 662e 5f6c 6c5f  return self._ll_
-0002bad0: 7472 6565 5f73 6571 7565 6e63 652e 6765  tree_sequence.ge
-0002bae0: 745f 6e75 6d5f 6564 6765 7328 290a 0a20  t_num_edges().. 
-0002baf0: 2020 2064 6566 2067 6574 5f6e 756d 5f74     def get_num_t
-0002bb00: 7265 6573 2873 656c 6629 3a0a 2020 2020  rees(self):.    
-0002bb10: 2020 2020 2320 4465 7072 6563 6174 6564      # Deprecated
-0002bb20: 2061 6c69 6173 2066 6f72 2073 656c 662e   alias for self.
-0002bb30: 6e75 6d5f 7472 6565 730a 2020 2020 2020  num_trees.      
-0002bb40: 2020 7265 7475 726e 2073 656c 662e 6e75    return self.nu
-0002bb50: 6d5f 7472 6565 730a 0a20 2020 2040 7072  m_trees..    @pr
-0002bb60: 6f70 6572 7479 0a20 2020 2064 6566 206e  operty.    def n
-0002bb70: 756d 5f74 7265 6573 2873 656c 6629 3a0a  um_trees(self):.
-0002bb80: 2020 2020 2020 2020 2222 220a 2020 2020          """.    
-0002bb90: 2020 2020 5265 7475 726e 7320 7468 6520      Returns the 
-0002bba0: 6e75 6d62 6572 206f 6620 6469 7374 696e  number of distin
-0002bbb0: 6374 2074 7265 6573 2069 6e20 7468 6973  ct trees in this
-0002bbc0: 2074 7265 6520 7365 7175 656e 6365 2e20   tree sequence. 
-0002bbd0: 5468 6973 0a20 2020 2020 2020 2069 7320  This.        is 
-0002bbe0: 6571 7561 6c20 746f 2074 6865 206e 756d  equal to the num
-0002bbf0: 6265 7220 6f66 2074 7265 6573 2072 6574  ber of trees ret
-0002bc00: 7572 6e65 6420 6279 2074 6865 203a 6d65  urned by the :me
-0002bc10: 7468 3a60 2e74 7265 6573 600a 2020 2020  th:`.trees`.    
-0002bc20: 2020 2020 6d65 7468 6f64 2e0a 0a20 2020      method...   
-0002bc30: 2020 2020 203a 7265 7475 726e 3a20 5468       :return: Th
-0002bc40: 6520 6e75 6d62 6572 206f 6620 7472 6565  e number of tree
-0002bc50: 7320 696e 2074 6869 7320 7472 6565 2073  s in this tree s
-0002bc60: 6571 7565 6e63 652e 0a20 2020 2020 2020  equence..       
-0002bc70: 203a 7274 7970 653a 2069 6e74 0a20 2020   :rtype: int.   
-0002bc80: 2020 2020 2022 2222 0a20 2020 2020 2020       """.       
-0002bc90: 2072 6574 7572 6e20 7365 6c66 2e5f 6c6c   return self._ll
-0002bca0: 5f74 7265 655f 7365 7175 656e 6365 2e67  _tree_sequence.g
-0002bcb0: 6574 5f6e 756d 5f74 7265 6573 2829 0a0a  et_num_trees()..
-0002bcc0: 2020 2020 6465 6620 6765 745f 6e75 6d5f      def get_num_
-0002bcd0: 7369 7465 7328 7365 6c66 293a 0a20 2020  sites(self):.   
-0002bce0: 2020 2020 2023 2044 6570 7265 6361 7465       # Deprecate
-0002bcf0: 6420 616c 6961 7320 666f 7220 7365 6c66  d alias for self
-0002bd00: 2e6e 756d 5f73 6974 6573 0a20 2020 2020  .num_sites.     
-0002bd10: 2020 2072 6574 7572 6e20 7365 6c66 2e5f     return self._
-0002bd20: 6c6c 5f74 7265 655f 7365 7175 656e 6365  ll_tree_sequence
-0002bd30: 2e67 6574 5f6e 756d 5f73 6974 6573 2829  .get_num_sites()
-0002bd40: 0a0a 2020 2020 4070 726f 7065 7274 790a  ..    @property.
-0002bd50: 2020 2020 6465 6620 6e75 6d5f 7369 7465      def num_site
-0002bd60: 7328 7365 6c66 293a 0a20 2020 2020 2020  s(self):.       
-0002bd70: 2022 2222 0a20 2020 2020 2020 2052 6574   """.        Ret
-0002bd80: 7572 6e73 2074 6865 206e 756d 6265 7220  urns the number 
-0002bd90: 6f66 203a 7265 663a 6073 6974 6573 203c  of :ref:`sites <
-0002bda0: 7365 635f 7369 7465 5f74 6162 6c65 5f64  sec_site_table_d
-0002bdb0: 6566 696e 6974 696f 6e3e 6020 696e 0a20  efinition>` in. 
-0002bdc0: 2020 2020 2020 2074 6869 7320 7472 6565         this tree
-0002bdd0: 2073 6571 7565 6e63 652e 0a0a 2020 2020   sequence...    
-0002bde0: 2020 2020 3a72 6574 7572 6e3a 2054 6865      :return: The
-0002bdf0: 206e 756d 6265 7220 6f66 2073 6974 6573   number of sites
-0002be00: 2069 6e20 7468 6973 2074 7265 6520 7365   in this tree se
-0002be10: 7175 656e 6365 2e0a 2020 2020 2020 2020  quence..        
-0002be20: 3a72 7479 7065 3a20 696e 740a 2020 2020  :rtype: int.    
-0002be30: 2020 2020 2222 220a 2020 2020 2020 2020      """.        
-0002be40: 7265 7475 726e 2073 656c 662e 6765 745f  return self.get_
-0002be50: 6e75 6d5f 7369 7465 7328 290a 0a20 2020  num_sites()..   
-0002be60: 2064 6566 2067 6574 5f6e 756d 5f6d 7574   def get_num_mut
-0002be70: 6174 696f 6e73 2873 656c 6629 3a0a 2020  ations(self):.  
-0002be80: 2020 2020 2020 2320 4465 7072 6563 6174        # Deprecat
-0002be90: 6564 2061 6c69 6173 2066 6f72 2073 656c  ed alias for sel
-0002bea0: 662e 6e75 6d5f 6d75 7461 7469 6f6e 730a  f.num_mutations.
-0002beb0: 2020 2020 2020 2020 7265 7475 726e 2073          return s
-0002bec0: 656c 662e 6e75 6d5f 6d75 7461 7469 6f6e  elf.num_mutation
-0002bed0: 730a 0a20 2020 2040 7072 6f70 6572 7479  s..    @property
-0002bee0: 0a20 2020 2064 6566 206e 756d 5f6d 7574  .    def num_mut
-0002bef0: 6174 696f 6e73 2873 656c 6629 3a0a 2020  ations(self):.  
-0002bf00: 2020 2020 2020 2222 220a 2020 2020 2020        """.      
-0002bf10: 2020 5265 7475 726e 7320 7468 6520 6e75    Returns the nu
-0002bf20: 6d62 6572 206f 6620 3a72 6566 3a60 6d75  mber of :ref:`mu
-0002bf30: 7461 7469 6f6e 7320 3c73 6563 5f6d 7574  tations <sec_mut
-0002bf40: 6174 696f 6e5f 7461 626c 655f 6465 6669  ation_table_defi
-0002bf50: 6e69 7469 6f6e 3e60 0a20 2020 2020 2020  nition>`.       
-0002bf60: 2069 6e20 7468 6973 2074 7265 6520 7365   in this tree se
-0002bf70: 7175 656e 6365 2e0a 0a20 2020 2020 2020  quence...       
-0002bf80: 203a 7265 7475 726e 3a20 5468 6520 6e75   :return: The nu
-0002bf90: 6d62 6572 206f 6620 6d75 7461 7469 6f6e  mber of mutation
-0002bfa0: 7320 696e 2074 6869 7320 7472 6565 2073  s in this tree s
-0002bfb0: 6571 7565 6e63 652e 0a20 2020 2020 2020  equence..       
-0002bfc0: 203a 7274 7970 653a 2069 6e74 0a20 2020   :rtype: int.   
-0002bfd0: 2020 2020 2022 2222 0a20 2020 2020 2020       """.       
-0002bfe0: 2072 6574 7572 6e20 7365 6c66 2e5f 6c6c   return self._ll
-0002bff0: 5f74 7265 655f 7365 7175 656e 6365 2e67  _tree_sequence.g
-0002c000: 6574 5f6e 756d 5f6d 7574 6174 696f 6e73  et_num_mutations
-0002c010: 2829 0a0a 2020 2020 6465 6620 6765 745f  ()..    def get_
-0002c020: 6e75 6d5f 6e6f 6465 7328 7365 6c66 293a  num_nodes(self):
-0002c030: 0a20 2020 2020 2020 2023 2044 6570 7265  .        # Depre
-0002c040: 6361 7465 6420 616c 6961 7320 666f 7220  cated alias for 
-0002c050: 7365 6c66 2e6e 756d 5f6e 6f64 6573 0a20  self.num_nodes. 
-0002c060: 2020 2020 2020 2072 6574 7572 6e20 7365         return se
-0002c070: 6c66 2e6e 756d 5f6e 6f64 6573 0a0a 2020  lf.num_nodes..  
-0002c080: 2020 4070 726f 7065 7274 790a 2020 2020    @property.    
-0002c090: 6465 6620 6e75 6d5f 696e 6469 7669 6475  def num_individu
-0002c0a0: 616c 7328 7365 6c66 293a 0a20 2020 2020  als(self):.     
-0002c0b0: 2020 2022 2222 0a20 2020 2020 2020 2052     """.        R
-0002c0c0: 6574 7572 6e73 2074 6865 206e 756d 6265  eturns the numbe
-0002c0d0: 7220 6f66 203a 7265 663a 6069 6e64 6976  r of :ref:`indiv
-0002c0e0: 6964 7561 6c73 203c 7365 635f 696e 6469  iduals <sec_indi
-0002c0f0: 7669 6475 616c 5f74 6162 6c65 5f64 6566  vidual_table_def
-0002c100: 696e 6974 696f 6e3e 6020 696e 0a20 2020  inition>` in.   
-0002c110: 2020 2020 2074 6869 7320 7472 6565 2073       this tree s
-0002c120: 6571 7565 6e63 652e 0a0a 2020 2020 2020  equence...      
-0002c130: 2020 3a72 6574 7572 6e3a 2054 6865 206e    :return: The n
-0002c140: 756d 6265 7220 6f66 2069 6e64 6976 6964  umber of individ
-0002c150: 7561 6c73 2069 6e20 7468 6973 2074 7265  uals in this tre
-0002c160: 6520 7365 7175 656e 6365 2e0a 2020 2020  e sequence..    
-0002c170: 2020 2020 3a72 7479 7065 3a20 696e 740a      :rtype: int.
-0002c180: 2020 2020 2020 2020 2222 220a 2020 2020          """.    
-0002c190: 2020 2020 7265 7475 726e 2073 656c 662e      return self.
-0002c1a0: 5f6c 6c5f 7472 6565 5f73 6571 7565 6e63  _ll_tree_sequenc
-0002c1b0: 652e 6765 745f 6e75 6d5f 696e 6469 7669  e.get_num_indivi
-0002c1c0: 6475 616c 7328 290a 0a20 2020 2040 7072  duals()..    @pr
-0002c1d0: 6f70 6572 7479 0a20 2020 2064 6566 206e  operty.    def n
-0002c1e0: 756d 5f6e 6f64 6573 2873 656c 6629 3a0a  um_nodes(self):.
-0002c1f0: 2020 2020 2020 2020 2222 220a 2020 2020          """.    
-0002c200: 2020 2020 5265 7475 726e 7320 7468 6520      Returns the 
-0002c210: 6e75 6d62 6572 206f 6620 3a72 6566 3a60  number of :ref:`
-0002c220: 6e6f 6465 7320 3c73 6563 5f6e 6f64 655f  nodes <sec_node_
-0002c230: 7461 626c 655f 6465 6669 6e69 7469 6f6e  table_definition
-0002c240: 3e60 2069 6e0a 2020 2020 2020 2020 7468  >` in.        th
-0002c250: 6973 2074 7265 6520 7365 7175 656e 6365  is tree sequence
-0002c260: 2e0a 0a20 2020 2020 2020 203a 7265 7475  ...        :retu
-0002c270: 726e 3a20 5468 6520 6e75 6d62 6572 206f  rn: The number o
-0002c280: 6620 6e6f 6465 7320 696e 2074 6869 7320  f nodes in this 
-0002c290: 7472 6565 2073 6571 7565 6e63 652e 0a20  tree sequence.. 
-0002c2a0: 2020 2020 2020 203a 7274 7970 653a 2069         :rtype: i
-0002c2b0: 6e74 0a20 2020 2020 2020 2022 2222 0a20  nt.        """. 
-0002c2c0: 2020 2020 2020 2072 6574 7572 6e20 7365         return se
-0002c2d0: 6c66 2e5f 6c6c 5f74 7265 655f 7365 7175  lf._ll_tree_sequ
-0002c2e0: 656e 6365 2e67 6574 5f6e 756d 5f6e 6f64  ence.get_num_nod
-0002c2f0: 6573 2829 0a0a 2020 2020 4070 726f 7065  es()..    @prope
-0002c300: 7274 790a 2020 2020 6465 6620 6e75 6d5f  rty.    def num_
-0002c310: 7072 6f76 656e 616e 6365 7328 7365 6c66  provenances(self
-0002c320: 293a 0a20 2020 2020 2020 2022 2222 0a20  ):.        """. 
-0002c330: 2020 2020 2020 2052 6574 7572 6e73 2074         Returns t
-0002c340: 6865 206e 756d 6265 7220 6f66 203a 7265  he number of :re
-0002c350: 663a 6070 726f 7665 6e61 6e63 6573 203c  f:`provenances <
-0002c360: 7365 635f 7072 6f76 656e 616e 6365 5f74  sec_provenance_t
-0002c370: 6162 6c65 5f64 6566 696e 6974 696f 6e3e  able_definition>
-0002c380: 600a 2020 2020 2020 2020 696e 2074 6869  `.        in thi
-0002c390: 7320 7472 6565 2073 6571 7565 6e63 652e  s tree sequence.
-0002c3a0: 0a0a 2020 2020 2020 2020 3a72 6574 7572  ..        :retur
-0002c3b0: 6e3a 2054 6865 206e 756d 6265 7220 6f66  n: The number of
-0002c3c0: 2070 726f 7665 6e61 6e63 6573 2069 6e20   provenances in 
-0002c3d0: 7468 6973 2074 7265 6520 7365 7175 656e  this tree sequen
-0002c3e0: 6365 2e0a 2020 2020 2020 2020 3a72 7479  ce..        :rty
-0002c3f0: 7065 3a20 696e 740a 2020 2020 2020 2020  pe: int.        
-0002c400: 2222 220a 2020 2020 2020 2020 7265 7475  """.        retu
-0002c410: 726e 2073 656c 662e 5f6c 6c5f 7472 6565  rn self._ll_tree
-0002c420: 5f73 6571 7565 6e63 652e 6765 745f 6e75  _sequence.get_nu
-0002c430: 6d5f 7072 6f76 656e 616e 6365 7328 290a  m_provenances().
-0002c440: 0a20 2020 2040 7072 6f70 6572 7479 0a20  .    @property. 
-0002c450: 2020 2064 6566 206e 756d 5f70 6f70 756c     def num_popul
-0002c460: 6174 696f 6e73 2873 656c 6629 3a0a 2020  ations(self):.  
-0002c470: 2020 2020 2020 2222 220a 2020 2020 2020        """.      
-0002c480: 2020 5265 7475 726e 7320 7468 6520 6e75    Returns the nu
-0002c490: 6d62 6572 206f 6620 3a72 6566 3a60 706f  mber of :ref:`po
-0002c4a0: 7075 6c61 7469 6f6e 7320 3c73 6563 5f70  pulations <sec_p
-0002c4b0: 6f70 756c 6174 696f 6e5f 7461 626c 655f  opulation_table_
-0002c4c0: 6465 6669 6e69 7469 6f6e 3e60 0a20 2020  definition>`.   
-0002c4d0: 2020 2020 2069 6e20 7468 6973 2074 7265       in this tre
-0002c4e0: 6520 7365 7175 656e 6365 2e0a 0a20 2020  e sequence...   
-0002c4f0: 2020 2020 203a 7265 7475 726e 3a20 5468       :return: Th
-0002c500: 6520 6e75 6d62 6572 206f 6620 706f 7075  e number of popu
-0002c510: 6c61 7469 6f6e 7320 696e 2074 6869 7320  lations in this 
-0002c520: 7472 6565 2073 6571 7565 6e63 652e 0a20  tree sequence.. 
-0002c530: 2020 2020 2020 203a 7274 7970 653a 2069         :rtype: i
-0002c540: 6e74 0a20 2020 2020 2020 2022 2222 0a20  nt.        """. 
-0002c550: 2020 2020 2020 2072 6574 7572 6e20 7365         return se
-0002c560: 6c66 2e5f 6c6c 5f74 7265 655f 7365 7175  lf._ll_tree_sequ
-0002c570: 656e 6365 2e67 6574 5f6e 756d 5f70 6f70  ence.get_num_pop
-0002c580: 756c 6174 696f 6e73 2829 0a0a 2020 2020  ulations()..    
-0002c590: 4070 726f 7065 7274 790a 2020 2020 6465  @property.    de
-0002c5a0: 6620 6e75 6d5f 6d69 6772 6174 696f 6e73  f num_migrations
-0002c5b0: 2873 656c 6629 3a0a 2020 2020 2020 2020  (self):.        
-0002c5c0: 2222 220a 2020 2020 2020 2020 5265 7475  """.        Retu
-0002c5d0: 726e 7320 7468 6520 6e75 6d62 6572 206f  rns the number o
-0002c5e0: 6620 3a72 6566 3a60 6d69 6772 6174 696f  f :ref:`migratio
-0002c5f0: 6e73 203c 7365 635f 6d69 6772 6174 696f  ns <sec_migratio
-0002c600: 6e5f 7461 626c 655f 6465 6669 6e69 7469  n_table_definiti
-0002c610: 6f6e 3e60 0a20 2020 2020 2020 2069 6e20  on>`.        in 
-0002c620: 7468 6973 2074 7265 6520 7365 7175 656e  this tree sequen
-0002c630: 6365 2e0a 0a20 2020 2020 2020 203a 7265  ce...        :re
-0002c640: 7475 726e 3a20 5468 6520 6e75 6d62 6572  turn: The number
-0002c650: 206f 6620 6d69 6772 6174 696f 6e73 2069   of migrations i
-0002c660: 6e20 7468 6973 2074 7265 6520 7365 7175  n this tree sequ
-0002c670: 656e 6365 2e0a 2020 2020 2020 2020 3a72  ence..        :r
-0002c680: 7479 7065 3a20 696e 740a 2020 2020 2020  type: int.      
-0002c690: 2020 2222 220a 2020 2020 2020 2020 7265    """.        re
-0002c6a0: 7475 726e 2073 656c 662e 5f6c 6c5f 7472  turn self._ll_tr
-0002c6b0: 6565 5f73 6571 7565 6e63 652e 6765 745f  ee_sequence.get_
-0002c6c0: 6e75 6d5f 6d69 6772 6174 696f 6e73 2829  num_migrations()
-0002c6d0: 0a0a 2020 2020 4070 726f 7065 7274 790a  ..    @property.
-0002c6e0: 2020 2020 6465 6620 6d61 785f 726f 6f74      def max_root
-0002c6f0: 5f74 696d 6528 7365 6c66 293a 0a20 2020  _time(self):.   
-0002c700: 2020 2020 2022 2222 0a20 2020 2020 2020       """.       
-0002c710: 2052 6574 7572 6e73 2074 6865 2074 696d   Returns the tim
-0002c720: 6520 6f66 2074 6865 206f 6c64 6573 7420  e of the oldest 
-0002c730: 726f 6f74 2069 6e20 616e 7920 6f66 2074  root in any of t
-0002c740: 6865 2074 7265 6573 2069 6e20 7468 6973  he trees in this
-0002c750: 2074 7265 6520 7365 7175 656e 6365 2e0a   tree sequence..
-0002c760: 2020 2020 2020 2020 5468 6973 2069 7320          This is 
-0002c770: 7573 7561 6c6c 7920 6571 7561 6c20 746f  usually equal to
-0002c780: 2060 606e 702e 6d61 7828 7473 2e74 6162   ``np.max(ts.tab
-0002c790: 6c65 732e 6e6f 6465 732e 7469 6d65 2960  les.nodes.time)`
-0002c7a0: 6020 6275 7420 6d61 7920 6e6f 7420 6265  ` but may not be
-0002c7b0: 0a20 2020 2020 2020 2073 696e 6365 2074  .        since t
-0002c7c0: 6865 7265 2063 616e 2062 6520 6e6f 6e2d  here can be non-
-0002c7d0: 7361 6d70 6c65 206e 6f64 6573 2074 6861  sample nodes tha
-0002c7e0: 7420 6172 6520 6e6f 7420 7072 6573 656e  t are not presen
-0002c7f0: 7420 696e 2061 6e79 2074 7265 652e 204e  t in any tree. N
-0002c800: 6f74 6520 7468 6174 0a20 2020 2020 2020  ote that.       
-0002c810: 2069 736f 6c61 7465 6420 7361 6d70 6c65   isolated sample
-0002c820: 7320 6172 6520 616c 736f 2064 6566 696e  s are also defin
-0002c830: 6564 2061 7320 726f 6f74 7320 2873 6f20  ed as roots (so 
-0002c840: 7468 6572 6520 6361 6e20 6265 2061 206d  there can be a m
-0002c850: 6178 5f72 6f6f 745f 7469 6d65 0a20 2020  ax_root_time.   
-0002c860: 2020 2020 2065 7665 6e20 696e 2061 2074       even in a t
-0002c870: 7265 6520 7365 7175 656e 6365 2077 6974  ree sequence wit
-0002c880: 6820 6e6f 2065 6467 6573 292e 0a0a 2020  h no edges)...  
-0002c890: 2020 2020 2020 3a72 6574 7572 6e3a 2054        :return: T
-0002c8a0: 6865 206d 6178 696d 756d 2074 696d 6520  he maximum time 
-0002c8b0: 6f66 2061 2072 6f6f 7420 696e 2074 6869  of a root in thi
-0002c8c0: 7320 7472 6565 2073 6571 7565 6e63 652e  s tree sequence.
-0002c8d0: 0a20 2020 2020 2020 203a 7274 7970 653a  .        :rtype:
-0002c8e0: 2066 6c6f 6174 0a20 2020 2020 2020 203a   float.        :
-0002c8f0: 7261 6973 6573 2056 616c 7565 4572 726f  raises ValueErro
-0002c900: 723a 2049 6620 7468 6572 6520 6172 6520  r: If there are 
-0002c910: 6e6f 2073 616d 706c 6573 2069 6e20 7468  no samples in th
-0002c920: 6520 7472 6565 2c20 616e 6420 6865 6e63  e tree, and henc
-0002c930: 6520 6e6f 2072 6f6f 7473 2028 6173 0a20  e no roots (as. 
-0002c940: 2020 2020 2020 2020 2020 2072 6f6f 7473             roots
-0002c950: 2061 7265 2064 6566 696e 6564 2062 7920   are defined by 
-0002c960: 7468 6520 656e 6473 206f 6620 7468 6520  the ends of the 
-0002c970: 7570 7761 7264 2070 6174 6873 2066 726f  upward paths fro
-0002c980: 6d20 7468 6520 7365 7420 6f66 2073 616d  m the set of sam
-0002c990: 706c 6573 292e 0a20 2020 2020 2020 2022  ples)..        "
-0002c9a0: 2222 0a20 2020 2020 2020 2069 6620 7365  "".        if se
-0002c9b0: 6c66 2e6e 756d 5f73 616d 706c 6573 203d  lf.num_samples =
-0002c9c0: 3d20 303a 0a20 2020 2020 2020 2020 2020  = 0:.           
-0002c9d0: 2072 6169 7365 2056 616c 7565 4572 726f   raise ValueErro
-0002c9e0: 7228 0a20 2020 2020 2020 2020 2020 2020  r(.             
-0002c9f0: 2020 2022 6d61 785f 726f 6f74 5f74 696d     "max_root_tim
-0002ca00: 6520 6973 206e 6f74 2064 6566 696e 6564  e is not defined
-0002ca10: 2069 6e20 6120 7472 6565 2073 6571 7565   in a tree seque
-0002ca20: 6e63 6520 7769 7468 2030 2073 616d 706c  nce with 0 sampl
-0002ca30: 6573 220a 2020 2020 2020 2020 2020 2020  es".            
-0002ca40: 290a 2020 2020 2020 2020 7265 7420 3d20  ).        ret = 
-0002ca50: 6d61 7828 7365 6c66 2e6e 6f64 6528 7529  max(self.node(u)
-0002ca60: 2e74 696d 6520 666f 7220 7520 696e 2073  .time for u in s
-0002ca70: 656c 662e 7361 6d70 6c65 7328 2929 0a20  elf.samples()). 
-0002ca80: 2020 2020 2020 2069 6620 7365 6c66 2e6e         if self.n
-0002ca90: 756d 5f65 6467 6573 203e 2030 3a0a 2020  um_edges > 0:.  
-0002caa0: 2020 2020 2020 2020 2020 2320 4564 6765            # Edge
-0002cab0: 7320 6172 6520 6775 6172 616e 7465 6564  s are guaranteed
-0002cac0: 2074 6f20 6265 206c 6973 7465 6420 696e   to be listed in
-0002cad0: 2070 6172 656e 742d 7469 6d65 206f 7264   parent-time ord
-0002cae0: 6572 2c20 736f 2077 6520 6361 6e20 6765  er, so we can ge
-0002caf0: 7420 7468 650a 2020 2020 2020 2020 2020  t the.          
-0002cb00: 2020 2320 6c61 7374 206f 6e65 2074 6f20    # last one to 
-0002cb10: 6765 7420 7468 6520 6f6c 6465 7374 2072  get the oldest r
-0002cb20: 6f6f 740a 2020 2020 2020 2020 2020 2020  oot.            
-0002cb30: 6564 6765 203d 2073 656c 662e 6564 6765  edge = self.edge
-0002cb40: 2873 656c 662e 6e75 6d5f 6564 6765 7320  (self.num_edges 
-0002cb50: 2d20 3129 0a20 2020 2020 2020 2020 2020  - 1).           
-0002cb60: 2023 2048 6f77 6576 6572 2c20 7765 2063   # However, we c
-0002cb70: 616e 2068 6176 6520 7369 7475 6174 696f  an have situatio
-0002cb80: 6e73 2077 6865 7265 2074 6865 7265 2069  ns where there i
-0002cb90: 7320 6120 7361 6d70 6c65 206f 6c64 6572  s a sample older
-0002cba0: 2074 6861 6e20 610a 2020 2020 2020 2020   than a.        
-0002cbb0: 2020 2020 2320 2770 726f 7065 7227 2072      # 'proper' r
-0002cbc0: 6f6f 740a 2020 2020 2020 2020 2020 2020  oot.            
-0002cbd0: 7265 7420 3d20 6d61 7828 7265 742c 2073  ret = max(ret, s
-0002cbe0: 656c 662e 6e6f 6465 2865 6467 652e 7061  elf.node(edge.pa
-0002cbf0: 7265 6e74 292e 7469 6d65 290a 2020 2020  rent).time).    
-0002cc00: 2020 2020 7265 7475 726e 2072 6574 0a0a      return ret..
-0002cc10: 2020 2020 6465 6620 6d69 6772 6174 696f      def migratio
-0002cc20: 6e73 2873 656c 6629 3a0a 2020 2020 2020  ns(self):.      
-0002cc30: 2020 2222 220a 2020 2020 2020 2020 5265    """.        Re
-0002cc40: 7475 726e 7320 616e 2069 7465 7261 626c  turns an iterabl
-0002cc50: 6520 7365 7175 656e 6365 206f 6620 616c  e sequence of al
-0002cc60: 6c20 7468 650a 2020 2020 2020 2020 3a72  l the.        :r
-0002cc70: 6566 3a60 6d69 6772 6174 696f 6e73 203c  ef:`migrations <
-0002cc80: 7365 635f 6d69 6772 6174 696f 6e5f 7461  sec_migration_ta
-0002cc90: 626c 655f 6465 6669 6e69 7469 6f6e 3e60  ble_definition>`
-0002cca0: 2069 6e20 7468 6973 2074 7265 6520 7365   in this tree se
-0002ccb0: 7175 656e 6365 2e0a 0a20 2020 2020 2020  quence...       
-0002ccc0: 204d 6967 7261 7469 6f6e 7320 6172 6520   Migrations are 
-0002ccd0: 7265 7475 726e 6564 2069 6e20 6e6f 6e64  returned in nond
-0002cce0: 6563 7265 6173 696e 6720 6f72 6465 7220  ecreasing order 
-0002ccf0: 6f66 2074 6865 2060 6074 696d 6560 6020  of the ``time`` 
-0002cd00: 7661 6c75 652e 0a0a 2020 2020 2020 2020  value...        
-0002cd10: 3a72 6574 7572 6e3a 2041 6e20 6974 6572  :return: An iter
-0002cd20: 6162 6c65 2073 6571 7565 6e63 6520 6f66  able sequence of
-0002cd30: 2061 6c6c 206d 6967 7261 7469 6f6e 732e   all migrations.
-0002cd40: 0a20 2020 2020 2020 203a 7274 7970 653a  .        :rtype:
-0002cd50: 2053 6571 7565 6e63 6528 3a63 6c61 7373   Sequence(:class
-0002cd60: 3a60 2e4d 6967 7261 7469 6f6e 6029 0a20  :`.Migration`). 
-0002cd70: 2020 2020 2020 2022 2222 0a20 2020 2020         """.     
-0002cd80: 2020 2072 6574 7572 6e20 5369 6d70 6c65     return Simple
-0002cd90: 436f 6e74 6169 6e65 7253 6571 7565 6e63  ContainerSequenc
-0002cda0: 6528 7365 6c66 2e6d 6967 7261 7469 6f6e  e(self.migration
-0002cdb0: 2c20 7365 6c66 2e6e 756d 5f6d 6967 7261  , self.num_migra
-0002cdc0: 7469 6f6e 7329 0a0a 2020 2020 6465 6620  tions)..    def 
-0002cdd0: 696e 6469 7669 6475 616c 7328 7365 6c66  individuals(self
-0002cde0: 293a 0a20 2020 2020 2020 2022 2222 0a20  ):.        """. 
-0002cdf0: 2020 2020 2020 2052 6574 7572 6e73 2061         Returns a
-0002ce00: 6e20 6974 6572 6162 6c65 2073 6571 7565  n iterable seque
-0002ce10: 6e63 6520 6f66 2061 6c6c 2074 6865 0a20  nce of all the. 
-0002ce20: 2020 2020 2020 203a 7265 663a 6069 6e64         :ref:`ind
-0002ce30: 6976 6964 7561 6c73 203c 7365 635f 696e  ividuals <sec_in
-0002ce40: 6469 7669 6475 616c 5f74 6162 6c65 5f64  dividual_table_d
-0002ce50: 6566 696e 6974 696f 6e3e 6020 696e 2074  efinition>` in t
-0002ce60: 6869 7320 7472 6565 2073 6571 7565 6e63  his tree sequenc
-0002ce70: 652e 0a0a 2020 2020 2020 2020 3a72 6574  e...        :ret
-0002ce80: 7572 6e3a 2041 6e20 6974 6572 6162 6c65  urn: An iterable
-0002ce90: 2073 6571 7565 6e63 6520 6f66 2061 6c6c   sequence of all
-0002cea0: 2069 6e64 6976 6964 7561 6c73 2e0a 2020   individuals..  
-0002ceb0: 2020 2020 2020 3a72 7479 7065 3a20 5365        :rtype: Se
-0002cec0: 7175 656e 6365 283a 636c 6173 733a 602e  quence(:class:`.
-0002ced0: 496e 6469 7669 6475 616c 6029 0a20 2020  Individual`).   
-0002cee0: 2020 2020 2022 2222 0a20 2020 2020 2020       """.       
-0002cef0: 2072 6574 7572 6e20 5369 6d70 6c65 436f   return SimpleCo
-0002cf00: 6e74 6169 6e65 7253 6571 7565 6e63 6528  ntainerSequence(
-0002cf10: 7365 6c66 2e69 6e64 6976 6964 7561 6c2c  self.individual,
-0002cf20: 2073 656c 662e 6e75 6d5f 696e 6469 7669   self.num_indivi
-0002cf30: 6475 616c 7329 0a0a 2020 2020 6465 6620  duals)..    def 
-0002cf40: 6e6f 6465 7328 7365 6c66 2c20 2a2c 206f  nodes(self, *, o
-0002cf50: 7264 6572 3d4e 6f6e 6529 3a0a 2020 2020  rder=None):.    
-0002cf60: 2020 2020 2222 220a 2020 2020 2020 2020      """.        
-0002cf70: 5265 7475 726e 7320 616e 2069 7465 7261  Returns an itera
-0002cf80: 626c 6520 7365 7175 656e 6365 206f 6620  ble sequence of 
-0002cf90: 616c 6c20 7468 6520 3a72 6566 3a60 6e6f  all the :ref:`no
-0002cfa0: 6465 7320 3c73 6563 5f6e 6f64 655f 7461  des <sec_node_ta
-0002cfb0: 626c 655f 6465 6669 6e69 7469 6f6e 3e60  ble_definition>`
-0002cfc0: 0a20 2020 2020 2020 2069 6e20 7468 6973  .        in this
-0002cfd0: 2074 7265 6520 7365 7175 656e 6365 2e0a   tree sequence..
-0002cfe0: 0a20 2020 2020 2020 202e 2e20 6e6f 7465  .        .. note
-0002cff0: 3a3a 2041 6c74 686f 7567 6820 6e6f 6465  :: Although node
-0002d000: 2069 6473 2061 7265 2063 6f6d 6d6f 6e6c   ids are commonl
-0002d010: 7920 6f72 6465 7265 6420 6279 206e 6f64  y ordered by nod
-0002d020: 6520 7469 6d65 2c20 7468 6973 2069 7320  e time, this is 
-0002d030: 6e6f 7420 610a 2020 2020 2020 2020 2020  not a.          
-0002d040: 2020 666f 726d 616c 2074 7265 6520 7365    formal tree se
-0002d050: 7175 656e 6365 2072 6571 7569 7265 6d65  quence requireme
-0002d060: 6e74 2e20 4966 2079 6f75 2077 6973 6820  nt. If you wish 
-0002d070: 746f 2069 7465 7261 7465 206f 7665 7220  to iterate over 
-0002d080: 6e6f 6465 7320 696e 0a20 2020 2020 2020  nodes in.       
-0002d090: 2020 2020 2074 696d 6520 6f72 6465 722c       time order,
-0002d0a0: 2079 6f75 2073 686f 756c 6420 7468 6572   you should ther
-0002d0b0: 6566 6f72 6520 7573 6520 6060 6f72 6465  efore use ``orde
-0002d0c0: 723d 2274 696d 6561 7363 2260 6020 2861  r="timeasc"`` (a
-0002d0d0: 6e64 2077 7261 7020 7468 650a 2020 2020  nd wrap the.    
-0002d0e0: 2020 2020 2020 2020 7265 7375 6c74 696e          resultin
-0002d0f0: 6720 7365 7175 656e 6365 2069 6e20 7468  g sequence in th
-0002d100: 6520 7374 616e 6461 7264 2050 7974 686f  e standard Pytho
-0002d110: 6e20 3a66 756e 633a 6070 7974 686f 6e3a  n :func:`python:
-0002d120: 7265 7665 7273 6564 6020 6675 6e63 7469  reversed` functi
-0002d130: 6f6e 0a20 2020 2020 2020 2020 2020 2069  on.            i
-0002d140: 6620 796f 7520 7769 7368 2074 6f20 6974  f you wish to it
-0002d150: 6572 6174 6520 6f76 6572 206f 6c64 6572  erate over older
-0002d160: 206e 6f64 6573 2062 6566 6f72 6520 796f   nodes before yo
-0002d170: 756e 6765 7220 6f6e 6573 290a 0a20 2020  unger ones)..   
-0002d180: 2020 2020 203a 7061 7261 6d20 7374 7220       :param str 
-0002d190: 6f72 6465 723a 2054 6865 206f 7264 6572  order: The order
-0002d1a0: 2069 6e20 7768 6963 6820 7468 6520 6e6f   in which the no
-0002d1b0: 6465 7320 7368 6f75 6c64 2062 6520 7265  des should be re
-0002d1c0: 7475 726e 6564 3a20 6d75 7374 2062 650a  turned: must be.
-0002d1d0: 2020 2020 2020 2020 2020 2020 6f6e 6520              one 
-0002d1e0: 6f66 2022 6964 2220 2864 6566 6175 6c74  of "id" (default
-0002d1f0: 2920 6f72 2022 7469 6d65 6173 6322 2028  ) or "timeasc" (
-0002d200: 6173 6365 6e64 696e 6720 6f72 6465 7220  ascending order 
-0002d210: 6f66 2074 696d 652c 2074 6865 6e20 6279  of time, then by
-0002d220: 0a20 2020 2020 2020 2020 2020 2061 7363  .            asc
-0002d230: 656e 6469 6e67 206e 6f64 6520 6964 2c20  ending node id, 
-0002d240: 6d61 7463 6869 6e67 2074 6865 2066 6972  matching the fir
-0002d250: 7374 2074 776f 206f 7264 6572 696e 6720  st two ordering 
-0002d260: 7265 7175 6972 656d 656e 7473 206f 660a  requirements of.
-0002d270: 2020 2020 2020 2020 2020 2020 7061 7265              pare
-0002d280: 6e74 206e 6f64 6573 2069 6e20 6120 3a6d  nt nodes in a :m
-0002d290: 6574 683a 6073 6f72 7465 6420 3c54 6162  eth:`sorted <Tab
-0002d2a0: 6c65 436f 6c6c 6563 7469 6f6e 2e73 6f72  leCollection.sor
-0002d2b0: 743e 6020 6564 6765 2074 6162 6c65 292e  t>` edge table).
-0002d2c0: 0a20 2020 2020 2020 203a 7265 7475 726e  .        :return
-0002d2d0: 3a20 416e 2069 7465 7261 626c 6520 7365  : An iterable se
-0002d2e0: 7175 656e 6365 206f 6620 616c 6c20 6e6f  quence of all no
-0002d2f0: 6465 732e 0a20 2020 2020 2020 203a 7274  des..        :rt
-0002d300: 7970 653a 2053 6571 7565 6e63 6528 3a63  ype: Sequence(:c
-0002d310: 6c61 7373 3a60 2e4e 6f64 6560 290a 2020  lass:`.Node`).  
-0002d320: 2020 2020 2020 2222 220a 2020 2020 2020        """.      
-0002d330: 2020 6f72 6465 7220 3d20 2269 6422 2069    order = "id" i
-0002d340: 6620 6f72 6465 7220 6973 204e 6f6e 6520  f order is None 
-0002d350: 656c 7365 206f 7264 6572 0a20 2020 2020  else order.     
-0002d360: 2020 2069 6620 6f72 6465 7220 6e6f 7420     if order not 
-0002d370: 696e 205b 2269 6422 2c20 2274 696d 6561  in ["id", "timea
-0002d380: 7363 225d 3a0a 2020 2020 2020 2020 2020  sc"]:.          
-0002d390: 2020 7261 6973 6520 5661 6c75 6545 7272    raise ValueErr
-0002d3a0: 6f72 2827 6f72 6465 7220 6d75 7374 2062  or('order must b
-0002d3b0: 6520 2269 6422 206f 7220 2274 696d 6561  e "id" or "timea
-0002d3c0: 7363 2227 290a 2020 2020 2020 2020 6f64  sc"').        od
-0002d3d0: 7220 3d20 4e6f 6e65 0a20 2020 2020 2020  r = None.       
-0002d3e0: 2069 6620 6f72 6465 7220 3d3d 2022 7469   if order == "ti
-0002d3f0: 6d65 6173 6322 3a0a 2020 2020 2020 2020  measc":.        
-0002d400: 2020 2020 6f64 7220 3d20 6e70 2e6c 6578      odr = np.lex
-0002d410: 736f 7274 2828 6e70 2e61 7261 6e67 6528  sort((np.arange(
-0002d420: 7365 6c66 2e6e 756d 5f6e 6f64 6573 292c  self.num_nodes),
-0002d430: 2073 656c 662e 6e6f 6465 735f 7469 6d65   self.nodes_time
-0002d440: 2929 0a20 2020 2020 2020 2072 6574 7572  )).        retur
-0002d450: 6e20 5369 6d70 6c65 436f 6e74 6169 6e65  n SimpleContaine
-0002d460: 7253 6571 7565 6e63 6528 7365 6c66 2e6e  rSequence(self.n
-0002d470: 6f64 652c 2073 656c 662e 6e75 6d5f 6e6f  ode, self.num_no
-0002d480: 6465 732c 206f 7264 6572 3d6f 6472 290a  des, order=odr).
-0002d490: 0a20 2020 2064 6566 2065 6467 6573 2873  .    def edges(s
-0002d4a0: 656c 6629 3a0a 2020 2020 2020 2020 2222  elf):.        ""
-0002d4b0: 220a 2020 2020 2020 2020 5265 7475 726e  ".        Return
-0002d4c0: 7320 616e 2069 7465 7261 626c 6520 7365  s an iterable se
-0002d4d0: 7175 656e 6365 206f 6620 616c 6c20 7468  quence of all th
-0002d4e0: 6520 3a72 6566 3a60 6564 6765 7320 3c73  e :ref:`edges <s
-0002d4f0: 6563 5f65 6467 655f 7461 626c 655f 6465  ec_edge_table_de
-0002d500: 6669 6e69 7469 6f6e 3e60 0a20 2020 2020  finition>`.     
-0002d510: 2020 2069 6e20 7468 6973 2074 7265 6520     in this tree 
-0002d520: 7365 7175 656e 6365 2e20 4564 6765 7320  sequence. Edges 
-0002d530: 6172 6520 7265 7475 726e 6564 2069 6e20  are returned in 
-0002d540: 7468 6520 6f72 6465 7220 7265 7175 6972  the order requir
-0002d550: 6564 0a20 2020 2020 2020 2066 6f72 2061  ed.        for a
-0002d560: 203a 7265 663a 6076 616c 6964 2074 7265   :ref:`valid tre
-0002d570: 6520 7365 7175 656e 6365 203c 7365 635f  e sequence <sec_
-0002d580: 7661 6c69 645f 7472 6565 5f73 6571 7565  valid_tree_seque
-0002d590: 6e63 655f 7265 7175 6972 656d 656e 7473  nce_requirements
-0002d5a0: 3e60 2e20 536f 2c0a 2020 2020 2020 2020  >`. So,.        
-0002d5b0: 6564 6765 7320 6172 6520 6775 6172 616e  edges are guaran
-0002d5c0: 7465 6564 2074 6f20 6265 206f 7264 6572  teed to be order
-0002d5d0: 6564 2073 7563 6820 7468 6174 2028 6129  ed such that (a)
-0002d5e0: 2061 6c6c 2070 6172 656e 7473 2077 6974   all parents wit
-0002d5f0: 6820 610a 2020 2020 2020 2020 6769 7665  h a.        give
-0002d600: 6e20 4944 2061 7265 2063 6f6e 7469 6775  n ID are contigu
-0002d610: 6f75 733b 2028 6229 2065 6467 6573 2061  ous; (b) edges a
-0002d620: 7265 2072 6574 7572 6e65 6420 696e 206e  re returned in n
-0002d630: 6f6e 2d64 6563 7265 6173 696e 670a 2020  on-decreasing.  
-0002d640: 2020 2020 2020 6f72 6465 7220 6f66 2070        order of p
-0002d650: 6172 656e 7420 7469 6d65 2061 676f 3b20  arent time ago; 
-0002d660: 2863 2920 7769 7468 696e 2074 6865 2065  (c) within the e
-0002d670: 6467 6573 2066 6f72 2061 2067 6976 656e  dges for a given
-0002d680: 2070 6172 656e 742c 2065 6467 6573 0a20   parent, edges. 
-0002d690: 2020 2020 2020 2061 7265 2073 6f72 7465         are sorte
-0002d6a0: 6420 6669 7273 7420 6279 2063 6869 6c64  d first by child
-0002d6b0: 2049 4420 616e 6420 7468 656e 2062 7920   ID and then by 
-0002d6c0: 6c65 6674 2063 6f6f 7264 696e 6174 652e  left coordinate.
-0002d6d0: 0a0a 2020 2020 2020 2020 3a72 6574 7572  ..        :retur
-0002d6e0: 6e3a 2041 6e20 6974 6572 6162 6c65 2073  n: An iterable s
-0002d6f0: 6571 7565 6e63 6520 6f66 2061 6c6c 2065  equence of all e
-0002d700: 6467 6573 2e0a 2020 2020 2020 2020 3a72  dges..        :r
-0002d710: 7479 7065 3a20 5365 7175 656e 6365 283a  type: Sequence(:
-0002d720: 636c 6173 733a 602e 4564 6765 6029 0a20  class:`.Edge`). 
-0002d730: 2020 2020 2020 2022 2222 0a20 2020 2020         """.     
-0002d740: 2020 2072 6574 7572 6e20 5369 6d70 6c65     return Simple
-0002d750: 436f 6e74 6169 6e65 7253 6571 7565 6e63  ContainerSequenc
-0002d760: 6528 7365 6c66 2e65 6467 652c 2073 656c  e(self.edge, sel
-0002d770: 662e 6e75 6d5f 6564 6765 7329 0a0a 2020  f.num_edges)..  
-0002d780: 2020 6465 6620 6564 6765 7365 7473 2873    def edgesets(s
-0002d790: 656c 6629 3a0a 2020 2020 2020 2020 2320  elf):.        # 
-0002d7a0: 544f 444f 2074 6865 206f 7264 6572 2074  TODO the order t
-0002d7b0: 6861 7420 7468 6573 6520 7265 636f 7264  hat these record
-0002d7c0: 7320 6172 6520 7265 7475 726e 6564 2069  s are returned i
-0002d7d0: 6e20 6973 206e 6f74 2077 656c 6c20 7370  n is not well sp
-0002d7e0: 6563 6966 6965 642e 0a20 2020 2020 2020  ecified..       
-0002d7f0: 2023 2048 6f70 6566 756c 6c79 2074 6869   # Hopefully thi
-0002d800: 7320 646f 6573 206e 6f74 206d 6174 7465  s does not matte
-0002d810: 722c 2061 6e64 2077 6520 6361 6e20 6a75  r, and we can ju
-0002d820: 7374 2073 7461 7465 2074 6861 7420 7468  st state that th
-0002d830: 6520 6f72 6465 7269 6e67 0a20 2020 2020  e ordering.     
-0002d840: 2020 2023 2073 686f 756c 6420 6e6f 7420     # should not 
-0002d850: 6265 2064 6570 656e 6465 6420 6f6e 2e0a  be depended on..
-0002d860: 2020 2020 2020 2020 6368 696c 6472 656e          children
-0002d870: 203d 2063 6f6c 6c65 6374 696f 6e73 2e64   = collections.d
-0002d880: 6566 6175 6c74 6469 6374 2873 6574 290a  efaultdict(set).
-0002d890: 2020 2020 2020 2020 6163 7469 7665 5f65          active_e
-0002d8a0: 6467 6573 6574 7320 3d20 7b7d 0a20 2020  dgesets = {}.   
-0002d8b0: 2020 2020 2066 6f72 2028 6c65 6674 2c20       for (left, 
-0002d8c0: 7269 6768 7429 2c20 6564 6765 735f 6f75  right), edges_ou
-0002d8d0: 742c 2065 6467 6573 5f69 6e20 696e 2073  t, edges_in in s
-0002d8e0: 656c 662e 6564 6765 5f64 6966 6673 2829  elf.edge_diffs()
-0002d8f0: 3a0a 2020 2020 2020 2020 2020 2020 2320  :.            # 
-0002d900: 436f 6d70 6c65 7465 2061 6e64 2072 6574  Complete and ret
-0002d910: 7572 6e20 616e 7920 6564 6765 7365 7473  urn any edgesets
-0002d920: 2074 6861 7420 6172 6520 6166 6665 6374   that are affect
-0002d930: 6564 2062 7920 7468 6973 2074 7265 650a  ed by this tree.
-0002d940: 2020 2020 2020 2020 2020 2020 2320 7472              # tr
-0002d950: 616e 7369 7469 6f6e 0a20 2020 2020 2020  ansition.       
-0002d960: 2020 2020 2070 6172 656e 7473 203d 2069       parents = i
-0002d970: 7465 7228 6564 6765 2e70 6172 656e 7420  ter(edge.parent 
-0002d980: 666f 7220 6564 6765 2069 6e20 6974 6572  for edge in iter
-0002d990: 746f 6f6c 732e 6368 6169 6e28 6564 6765  tools.chain(edge
-0002d9a0: 735f 6f75 742c 2065 6467 6573 5f69 6e29  s_out, edges_in)
-0002d9b0: 290a 2020 2020 2020 2020 2020 2020 666f  ).            fo
-0002d9c0: 7220 7061 7265 6e74 2069 6e20 7061 7265  r parent in pare
-0002d9d0: 6e74 733a 0a20 2020 2020 2020 2020 2020  nts:.           
-0002d9e0: 2020 2020 2069 6620 7061 7265 6e74 2069       if parent i
-0002d9f0: 6e20 6163 7469 7665 5f65 6467 6573 6574  n active_edgeset
-0002da00: 733a 0a20 2020 2020 2020 2020 2020 2020  s:.             
-0002da10: 2020 2020 2020 2065 6467 6573 6574 203d         edgeset =
-0002da20: 2061 6374 6976 655f 6564 6765 7365 7473   active_edgesets
-0002da30: 2e70 6f70 2870 6172 656e 7429 0a20 2020  .pop(parent).   
+0002a660: 2020 2020 2020 7574 696c 2e6e 6174 7572        util.natur
+0002a670: 616c 7369 7a65 2874 6162 6c65 2e6e 6279  alsize(table.nby
+0002a680: 7465 7329 2c0a 2020 2020 2020 2020 2020  tes),.          
+0002a690: 2020 2020 2020 2020 2020 2020 2020 2259                "Y
+0002a6a0: 6573 220a 2020 2020 2020 2020 2020 2020  es".            
+0002a6b0: 2020 2020 2020 2020 2020 2020 6966 2068              if h
+0002a6c0: 6173 6174 7472 2874 6162 6c65 2c20 226d  asattr(table, "m
+0002a6d0: 6574 6164 6174 6122 2920 616e 6420 6c65  etadata") and le
+0002a6e0: 6e28 7461 626c 652e 6d65 7461 6461 7461  n(table.metadata
+0002a6f0: 2920 3e20 300a 2020 2020 2020 2020 2020  ) > 0.          
+0002a700: 2020 2020 2020 2020 2020 2020 2020 656c                el
+0002a710: 7365 2022 4e6f 222c 0a20 2020 2020 2020  se "No",.       
+0002a720: 2020 2020 2020 2020 2020 2020 205d 0a20               ]. 
+0002a730: 2020 2020 2020 2020 2020 2020 2020 205d                 ]
+0002a740: 0a20 2020 2020 2020 2020 2020 2029 0a20  .            ). 
+0002a750: 2020 2020 2020 2072 6574 7572 6e20 7574         return ut
+0002a760: 696c 2e75 6e69 636f 6465 5f74 6162 6c65  il.unicode_table
+0002a770: 2874 735f 726f 7773 2c20 7469 746c 653d  (ts_rows, title=
+0002a780: 2254 7265 6553 6571 7565 6e63 6522 2920  "TreeSequence") 
+0002a790: 2b20 7574 696c 2e75 6e69 636f 6465 5f74  + util.unicode_t
+0002a7a0: 6162 6c65 280a 2020 2020 2020 2020 2020  able(.          
+0002a7b0: 2020 7461 626c 655f 726f 7773 2c20 6865    table_rows, he
+0002a7c0: 6164 6572 3d68 6561 6465 720a 2020 2020  ader=header.    
+0002a7d0: 2020 2020 290a 0a20 2020 2064 6566 205f      )..    def _
+0002a7e0: 7265 7072 5f68 746d 6c5f 2873 656c 6629  repr_html_(self)
+0002a7f0: 3a0a 2020 2020 2020 2020 2222 220a 2020  :.        """.  
+0002a800: 2020 2020 2020 5265 7475 726e 2061 6e20        Return an 
+0002a810: 6874 6d6c 2073 756d 6d61 7279 206f 6620  html summary of 
+0002a820: 6120 7472 6565 2073 6571 7565 6e63 652e  a tree sequence.
+0002a830: 2043 616c 6c65 6420 6279 206a 7570 7974   Called by jupyt
+0002a840: 6572 206e 6f74 6562 6f6f 6b73 0a20 2020  er notebooks.   
+0002a850: 2020 2020 2074 6f20 7265 6e64 6572 2061       to render a
+0002a860: 2054 7265 6553 6571 7565 6e63 652e 0a20   TreeSequence.. 
+0002a870: 2020 2020 2020 2022 2222 0a20 2020 2020         """.     
+0002a880: 2020 2072 6574 7572 6e20 7574 696c 2e74     return util.t
+0002a890: 7265 655f 7365 7175 656e 6365 5f68 746d  ree_sequence_htm
+0002a8a0: 6c28 7365 6c66 290a 0a20 2020 2023 206e  l(self)..    # n
+0002a8b0: 756d 5f73 616d 706c 6573 2077 6173 206f  um_samples was o
+0002a8c0: 7269 6769 6e61 6c6c 7920 6361 6c6c 6564  riginally called
+0002a8d0: 2073 616d 706c 655f 7369 7a65 2c20 616e   sample_size, an
+0002a8e0: 6420 736f 2077 6520 6d75 7374 206b 6565  d so we must kee
+0002a8f0: 7020 7361 6d70 6c65 5f73 697a 650a 2020  p sample_size.  
+0002a900: 2020 2320 6172 6f75 6e64 2061 7320 6120    # around as a 
+0002a910: 6465 7072 6563 6174 6564 2061 6c69 6173  deprecated alias
+0002a920: 2e0a 2020 2020 4070 726f 7065 7274 790a  ..    @property.
+0002a930: 2020 2020 6465 6620 6e75 6d5f 7361 6d70      def num_samp
+0002a940: 6c65 7328 7365 6c66 293a 0a20 2020 2020  les(self):.     
+0002a950: 2020 2022 2222 0a20 2020 2020 2020 2052     """.        R
+0002a960: 6574 7572 6e73 2074 6865 206e 756d 6265  eturns the numbe
+0002a970: 7220 6f66 2073 616d 706c 6520 6e6f 6465  r of sample node
+0002a980: 7320 696e 2074 6869 7320 7472 6565 2073  s in this tree s
+0002a990: 6571 7565 6e63 652e 2054 6869 7320 6973  equence. This is
+0002a9a0: 2061 6c73 6f20 7468 650a 2020 2020 2020   also the.      
+0002a9b0: 2020 6e75 6d62 6572 206f 6620 7361 6d70    number of samp
+0002a9c0: 6c65 206e 6f64 6573 2069 6e20 6561 6368  le nodes in each
+0002a9d0: 2074 7265 652e 0a0a 2020 2020 2020 2020   tree...        
+0002a9e0: 3a72 6574 7572 6e3a 2054 6865 206e 756d  :return: The num
+0002a9f0: 6265 7220 6f66 2073 616d 706c 6520 6e6f  ber of sample no
+0002aa00: 6465 7320 696e 2074 6869 7320 7472 6565  des in this tree
+0002aa10: 2073 6571 7565 6e63 652e 0a20 2020 2020   sequence..     
+0002aa20: 2020 203a 7274 7970 653a 2069 6e74 0a20     :rtype: int. 
+0002aa30: 2020 2020 2020 2022 2222 0a20 2020 2020         """.     
+0002aa40: 2020 2072 6574 7572 6e20 7365 6c66 2e5f     return self._
+0002aa50: 6c6c 5f74 7265 655f 7365 7175 656e 6365  ll_tree_sequence
+0002aa60: 2e67 6574 5f6e 756d 5f73 616d 706c 6573  .get_num_samples
+0002aa70: 2829 0a0a 2020 2020 4070 726f 7065 7274  ()..    @propert
+0002aa80: 790a 2020 2020 6465 6620 7461 626c 655f  y.    def table_
+0002aa90: 6d65 7461 6461 7461 5f73 6368 656d 6173  metadata_schemas
+0002aaa0: 2873 656c 6629 202d 3e20 5461 626c 654d  (self) -> TableM
+0002aab0: 6574 6164 6174 6153 6368 656d 6173 3a0a  etadataSchemas:.
+0002aac0: 2020 2020 2020 2020 2222 220a 2020 2020          """.    
+0002aad0: 2020 2020 5468 6520 7365 7420 6f66 206d      The set of m
+0002aae0: 6574 6164 6174 6120 7363 6865 6d61 7320  etadata schemas 
+0002aaf0: 666f 7220 7468 6520 7461 626c 6573 2069  for the tables i
+0002ab00: 6e20 7468 6973 2074 7265 6520 7365 7175  n this tree sequ
+0002ab10: 656e 6365 2e0a 2020 2020 2020 2020 2222  ence..        ""
+0002ab20: 220a 2020 2020 2020 2020 7265 7475 726e  ".        return
+0002ab30: 2073 656c 662e 5f74 6162 6c65 5f6d 6574   self._table_met
+0002ab40: 6164 6174 615f 7363 6865 6d61 730a 0a20  adata_schemas.. 
+0002ab50: 2020 2040 7072 6f70 6572 7479 0a20 2020     @property.   
+0002ab60: 2064 6566 2073 616d 706c 655f 7369 7a65   def sample_size
+0002ab70: 2873 656c 6629 3a0a 2020 2020 2020 2020  (self):.        
+0002ab80: 2320 4465 7072 6563 6174 6564 2061 6c69  # Deprecated ali
+0002ab90: 6173 2066 6f72 206e 756d 5f73 616d 706c  as for num_sampl
+0002aba0: 6573 0a20 2020 2020 2020 2072 6574 7572  es.        retur
+0002abb0: 6e20 7365 6c66 2e6e 756d 5f73 616d 706c  n self.num_sampl
+0002abc0: 6573 0a0a 2020 2020 6465 6620 6765 745f  es..    def get_
+0002abd0: 7361 6d70 6c65 5f73 697a 6528 7365 6c66  sample_size(self
+0002abe0: 293a 0a20 2020 2020 2020 2023 2044 6570  ):.        # Dep
+0002abf0: 7265 6361 7465 6420 616c 6961 7320 666f  recated alias fo
+0002ac00: 7220 6e75 6d5f 7361 6d70 6c65 730a 2020  r num_samples.  
+0002ac10: 2020 2020 2020 7265 7475 726e 2073 656c        return sel
+0002ac20: 662e 6e75 6d5f 7361 6d70 6c65 730a 0a20  f.num_samples.. 
+0002ac30: 2020 2040 7072 6f70 6572 7479 0a20 2020     @property.   
+0002ac40: 2064 6566 2066 696c 655f 7575 6964 2873   def file_uuid(s
+0002ac50: 656c 6629 3a0a 2020 2020 2020 2020 7265  elf):.        re
+0002ac60: 7475 726e 2073 656c 662e 5f6c 6c5f 7472  turn self._ll_tr
+0002ac70: 6565 5f73 6571 7565 6e63 652e 6765 745f  ee_sequence.get_
+0002ac80: 6669 6c65 5f75 7569 6428 290a 0a20 2020  file_uuid()..   
+0002ac90: 2040 7072 6f70 6572 7479 0a20 2020 2064   @property.    d
+0002aca0: 6566 2064 6973 6372 6574 655f 6765 6e6f  ef discrete_geno
+0002acb0: 6d65 2873 656c 6629 3a0a 2020 2020 2020  me(self):.      
+0002acc0: 2020 2222 220a 2020 2020 2020 2020 5265    """.        Re
+0002acd0: 7475 726e 7320 5472 7565 2069 6620 616c  turns True if al
+0002ace0: 6c20 6765 6e6f 6d65 2063 6f6f 7264 696e  l genome coordin
+0002acf0: 6174 6573 2069 6e20 7468 6973 2054 7265  ates in this Tre
+0002ad00: 6553 6571 7565 6e63 6520 6172 650a 2020  eSequence are.  
+0002ad10: 2020 2020 2020 6469 7363 7265 7465 2069        discrete i
+0002ad20: 6e74 6567 6572 2076 616c 7565 732e 2054  nteger values. T
+0002ad30: 6869 7320 6973 2074 7275 6520 6966 6620  his is true iff 
+0002ad40: 616c 6c20 7468 6520 666f 6c6c 6f77 696e  all the followin
+0002ad50: 6720 6172 6520 7472 7565 3a0a 0a20 2020  g are true:..   
+0002ad60: 2020 2020 202d 2054 6865 2073 6571 7565       - The seque
+0002ad70: 6e63 6520 6c65 6e67 7468 2069 7320 6469  nce length is di
+0002ad80: 7363 7265 7465 0a20 2020 2020 2020 202d  screte.        -
+0002ad90: 2041 6c6c 2073 6974 6520 706f 7369 7469   All site positi
+0002ada0: 6f6e 7320 6172 6520 6469 7363 7265 7465  ons are discrete
+0002adb0: 0a20 2020 2020 2020 202d 2041 6c6c 206c  .        - All l
+0002adc0: 6566 7420 616e 6420 7269 6768 7420 6564  eft and right ed
+0002add0: 6765 2063 6f6f 7264 696e 6174 6573 2061  ge coordinates a
+0002ade0: 7265 2064 6973 6372 6574 650a 2020 2020  re discrete.    
+0002adf0: 2020 2020 2d20 416c 6c20 6d69 6772 6174      - All migrat
+0002ae00: 696f 6e20 6c65 6674 2061 6e64 2072 6967  ion left and rig
+0002ae10: 6874 2063 6f6f 7264 696e 6174 6573 2061  ht coordinates a
+0002ae20: 7265 2064 6973 6372 6574 650a 0a20 2020  re discrete..   
+0002ae30: 2020 2020 203a 7265 7475 726e 3a20 5472       :return: Tr
+0002ae40: 7565 2069 6620 7468 6973 2054 7265 6553  ue if this TreeS
+0002ae50: 6571 7565 6e63 6520 7573 6573 2064 6973  equence uses dis
+0002ae60: 6372 6574 6520 6765 6e6f 6d65 2063 6f6f  crete genome coo
+0002ae70: 7264 696e 6174 6573 2e0a 2020 2020 2020  rdinates..      
+0002ae80: 2020 3a72 7479 7065 3a20 626f 6f6c 0a20    :rtype: bool. 
+0002ae90: 2020 2020 2020 2022 2222 0a20 2020 2020         """.     
+0002aea0: 2020 2072 6574 7572 6e20 626f 6f6c 2873     return bool(s
+0002aeb0: 656c 662e 5f6c 6c5f 7472 6565 5f73 6571  elf._ll_tree_seq
+0002aec0: 7565 6e63 652e 6765 745f 6469 7363 7265  uence.get_discre
+0002aed0: 7465 5f67 656e 6f6d 6528 2929 0a0a 2020  te_genome())..  
+0002aee0: 2020 4070 726f 7065 7274 790a 2020 2020    @property.    
+0002aef0: 6465 6620 6469 7363 7265 7465 5f74 696d  def discrete_tim
+0002af00: 6528 7365 6c66 293a 0a20 2020 2020 2020  e(self):.       
+0002af10: 2022 2222 0a20 2020 2020 2020 2052 6574   """.        Ret
+0002af20: 7572 6e73 2054 7275 6520 6966 2061 6c6c  urns True if all
+0002af30: 2074 696d 6520 636f 6f72 6469 6e61 7465   time coordinate
+0002af40: 7320 696e 2074 6869 7320 5472 6565 5365  s in this TreeSe
+0002af50: 7175 656e 6365 2061 7265 0a20 2020 2020  quence are.     
+0002af60: 2020 2064 6973 6372 6574 6520 696e 7465     discrete inte
+0002af70: 6765 7220 7661 6c75 6573 2e20 5468 6973  ger values. This
+0002af80: 2069 7320 7472 7565 2069 6666 2061 6c6c   is true iff all
+0002af90: 2074 6865 2066 6f6c 6c6f 7769 6e67 2061   the following a
+0002afa0: 7265 2074 7275 653a 0a0a 2020 2020 2020  re true:..      
+0002afb0: 2020 2d20 416c 6c20 6e6f 6465 2074 696d    - All node tim
+0002afc0: 6573 2061 7265 2064 6973 6372 6574 650a  es are discrete.
+0002afd0: 2020 2020 2020 2020 2d20 416c 6c20 6d75          - All mu
+0002afe0: 7461 7469 6f6e 2074 696d 6573 2061 7265  tation times are
+0002aff0: 2064 6973 6372 6574 650a 2020 2020 2020   discrete.      
+0002b000: 2020 2d20 416c 6c20 6d69 6772 6174 696f    - All migratio
+0002b010: 6e20 7469 6d65 7320 6172 6520 6469 7363  n times are disc
+0002b020: 7265 7465 0a0a 2020 2020 2020 2020 4e6f  rete..        No
+0002b030: 7465 2074 6861 7420 6060 7473 6b69 742e  te that ``tskit.
+0002b040: 554e 4b4e 4f57 4e5f 5449 4d45 6060 2063  UNKNOWN_TIME`` c
+0002b050: 6f75 6e74 7320 6173 2064 6973 6372 6574  ounts as discret
+0002b060: 652e 0a0a 2020 2020 2020 2020 3a72 6574  e...        :ret
+0002b070: 7572 6e3a 2054 7275 6520 6966 2074 6869  urn: True if thi
+0002b080: 7320 5472 6565 5365 7175 656e 6365 2075  s TreeSequence u
+0002b090: 7365 7320 6469 7363 7265 7465 2074 696d  ses discrete tim
+0002b0a0: 6520 636f 6f72 6469 6e61 7465 732e 0a20  e coordinates.. 
+0002b0b0: 2020 2020 2020 203a 7274 7970 653a 2062         :rtype: b
+0002b0c0: 6f6f 6c0a 2020 2020 2020 2020 2222 220a  ool.        """.
+0002b0d0: 2020 2020 2020 2020 7265 7475 726e 2062          return b
+0002b0e0: 6f6f 6c28 7365 6c66 2e5f 6c6c 5f74 7265  ool(self._ll_tre
+0002b0f0: 655f 7365 7175 656e 6365 2e67 6574 5f64  e_sequence.get_d
+0002b100: 6973 6372 6574 655f 7469 6d65 2829 290a  iscrete_time()).
+0002b110: 0a20 2020 2040 7072 6f70 6572 7479 0a20  .    @property. 
+0002b120: 2020 2064 6566 206d 696e 5f74 696d 6528     def min_time(
+0002b130: 7365 6c66 293a 0a20 2020 2020 2020 2022  self):.        "
+0002b140: 2222 0a20 2020 2020 2020 2052 6574 7572  "".        Retur
+0002b150: 6e73 2074 6865 206d 696e 2074 696d 6520  ns the min time 
+0002b160: 696e 2074 6869 7320 7472 6565 2073 6571  in this tree seq
+0002b170: 7565 6e63 652e 2054 6869 7320 6973 2074  uence. This is t
+0002b180: 6865 206d 696e 696d 756d 0a20 2020 2020  he minimum.     
+0002b190: 2020 206f 6620 7468 6520 6e6f 6465 2074     of the node t
+0002b1a0: 696d 6573 2061 6e64 206d 7574 6174 696f  imes and mutatio
+0002b1b0: 6e20 7469 6d65 732e 0a0a 2020 2020 2020  n times...      
+0002b1c0: 2020 4e6f 7465 2074 6861 7420 6d75 7461    Note that muta
+0002b1d0: 7469 6f6e 2074 696d 6573 2077 6974 6820  tion times with 
+0002b1e0: 7468 6520 7661 6c75 6520 6060 7473 6b69  the value ``tski
+0002b1f0: 742e 554e 4b4e 4f57 4e5f 5449 4d45 6060  t.UNKNOWN_TIME``
+0002b200: 0a20 2020 2020 2020 2061 7265 2069 676e  .        are ign
+0002b210: 6f72 6564 2e0a 0a20 2020 2020 2020 203a  ored...        :
+0002b220: 7265 7475 726e 3a20 5468 6520 6d69 6e20  return: The min 
+0002b230: 7469 6d65 206f 6620 7468 6520 6e6f 6465  time of the node
+0002b240: 7320 616e 6420 6d75 7461 7469 6f6e 7320  s and mutations 
+0002b250: 696e 2074 6869 7320 7472 6565 2073 6571  in this tree seq
+0002b260: 7565 6e63 652e 0a20 2020 2020 2020 203a  uence..        :
+0002b270: 7274 7970 653a 2066 6c6f 6174 0a20 2020  rtype: float.   
+0002b280: 2020 2020 2022 2222 0a20 2020 2020 2020       """.       
+0002b290: 2072 6574 7572 6e20 7365 6c66 2e5f 6c6c   return self._ll
+0002b2a0: 5f74 7265 655f 7365 7175 656e 6365 2e67  _tree_sequence.g
+0002b2b0: 6574 5f6d 696e 5f74 696d 6528 290a 0a20  et_min_time().. 
+0002b2c0: 2020 2040 7072 6f70 6572 7479 0a20 2020     @property.   
+0002b2d0: 2064 6566 206d 6178 5f74 696d 6528 7365   def max_time(se
+0002b2e0: 6c66 293a 0a20 2020 2020 2020 2022 2222  lf):.        """
+0002b2f0: 0a20 2020 2020 2020 2052 6574 7572 6e73  .        Returns
+0002b300: 2074 6865 206d 6178 2074 696d 6520 696e   the max time in
+0002b310: 2074 6869 7320 7472 6565 2073 6571 7565   this tree seque
+0002b320: 6e63 652e 2054 6869 7320 6973 2074 6865  nce. This is the
+0002b330: 206d 6178 696d 756d 0a20 2020 2020 2020   maximum.       
+0002b340: 206f 6620 7468 6520 6e6f 6465 2074 696d   of the node tim
+0002b350: 6573 2061 6e64 206d 7574 6174 696f 6e20  es and mutation 
+0002b360: 7469 6d65 732e 0a0a 2020 2020 2020 2020  times...        
+0002b370: 4e6f 7465 2074 6861 7420 6d75 7461 7469  Note that mutati
+0002b380: 6f6e 2074 696d 6573 2077 6974 6820 7468  on times with th
+0002b390: 6520 7661 6c75 6520 6060 7473 6b69 742e  e value ``tskit.
+0002b3a0: 554e 4b4e 4f57 4e5f 5449 4d45 6060 0a20  UNKNOWN_TIME``. 
+0002b3b0: 2020 2020 2020 2061 7265 2069 676e 6f72         are ignor
+0002b3c0: 6564 2e0a 0a20 2020 2020 2020 203a 7265  ed...        :re
+0002b3d0: 7475 726e 3a20 5468 6520 6d61 7820 7469  turn: The max ti
+0002b3e0: 6d65 206f 6620 7468 6520 6e6f 6465 7320  me of the nodes 
+0002b3f0: 616e 6420 6d75 7461 7469 6f6e 7320 696e  and mutations in
+0002b400: 2074 6869 7320 7472 6565 2073 6571 7565   this tree seque
+0002b410: 6e63 652e 0a20 2020 2020 2020 203a 7274  nce..        :rt
+0002b420: 7970 653a 2066 6c6f 6174 0a20 2020 2020  ype: float.     
+0002b430: 2020 2022 2222 0a20 2020 2020 2020 2072     """.        r
+0002b440: 6574 7572 6e20 7365 6c66 2e5f 6c6c 5f74  eturn self._ll_t
+0002b450: 7265 655f 7365 7175 656e 6365 2e67 6574  ree_sequence.get
+0002b460: 5f6d 6178 5f74 696d 6528 290a 0a20 2020  _max_time()..   
+0002b470: 2040 7072 6f70 6572 7479 0a20 2020 2064   @property.    d
+0002b480: 6566 2073 6571 7565 6e63 655f 6c65 6e67  ef sequence_leng
+0002b490: 7468 2873 656c 6629 3a0a 2020 2020 2020  th(self):.      
+0002b4a0: 2020 2222 220a 2020 2020 2020 2020 5265    """.        Re
+0002b4b0: 7475 726e 7320 7468 6520 7365 7175 656e  turns the sequen
+0002b4c0: 6365 206c 656e 6774 6820 696e 2074 6869  ce length in thi
+0002b4d0: 7320 7472 6565 2073 6571 7565 6e63 652e  s tree sequence.
+0002b4e0: 2054 6869 7320 6465 6669 6e65 7320 7468   This defines th
+0002b4f0: 650a 2020 2020 2020 2020 6765 6e6f 6d69  e.        genomi
+0002b500: 6320 7363 616c 6520 6f76 6572 2077 6869  c scale over whi
+0002b510: 6368 2074 7265 6520 636f 6f72 6469 6e61  ch tree coordina
+0002b520: 7465 7320 6172 6520 6465 6669 6e65 642e  tes are defined.
+0002b530: 2047 6976 656e 2061 0a20 2020 2020 2020   Given a.       
+0002b540: 2074 7265 6520 7365 7175 656e 6365 2077   tree sequence w
+0002b550: 6974 6820 6120 7365 7175 656e 6365 206c  ith a sequence l
+0002b560: 656e 6774 6820 3a6d 6174 683a 604c 602c  ength :math:`L`,
+0002b570: 2074 6865 2063 6f6e 7374 6974 7565 6e74   the constituent
+0002b580: 0a20 2020 2020 2020 2074 7265 6573 2077  .        trees w
+0002b590: 696c 6c20 6265 2064 6566 696e 6564 206f  ill be defined o
+0002b5a0: 7665 7220 7468 6520 6861 6c66 2d63 6c6f  ver the half-clo
+0002b5b0: 7365 6420 696e 7465 7276 616c 0a20 2020  sed interval.   
+0002b5c0: 2020 2020 203a 6d61 7468 3a60 5b30 2c20       :math:`[0, 
+0002b5d0: 4c29 602e 2045 6163 6820 7472 6565 2074  L)`. Each tree t
+0002b5e0: 6865 6e20 636f 7665 7273 2073 6f6d 6520  hen covers some 
+0002b5f0: 7375 6273 6574 206f 6620 7468 6973 0a20  subset of this. 
+0002b600: 2020 2020 2020 2069 6e74 6572 7661 6c20         interval 
+0002b610: 2d2d 2d20 7365 6520 3a61 7474 723a 6074  --- see :attr:`t
+0002b620: 736b 6974 2e54 7265 652e 696e 7465 7276  skit.Tree.interv
+0002b630: 616c 6020 666f 7220 6465 7461 696c 732e  al` for details.
+0002b640: 0a0a 2020 2020 2020 2020 3a72 6574 7572  ..        :retur
+0002b650: 6e3a 2054 6865 206c 656e 6774 6820 6f66  n: The length of
+0002b660: 2074 6865 2073 6571 7565 6e63 6520 696e   the sequence in
+0002b670: 2074 6869 7320 7472 6565 2073 6571 7565   this tree seque
+0002b680: 6e63 6520 696e 2062 6173 6573 2e0a 2020  nce in bases..  
+0002b690: 2020 2020 2020 3a72 7479 7065 3a20 666c        :rtype: fl
+0002b6a0: 6f61 740a 2020 2020 2020 2020 2222 220a  oat.        """.
+0002b6b0: 2020 2020 2020 2020 7265 7475 726e 2073          return s
+0002b6c0: 656c 662e 6765 745f 7365 7175 656e 6365  elf.get_sequence
+0002b6d0: 5f6c 656e 6774 6828 290a 0a20 2020 2064  _length()..    d
+0002b6e0: 6566 2067 6574 5f73 6571 7565 6e63 655f  ef get_sequence_
+0002b6f0: 6c65 6e67 7468 2873 656c 6629 3a0a 2020  length(self):.  
+0002b700: 2020 2020 2020 7265 7475 726e 2073 656c        return sel
+0002b710: 662e 5f6c 6c5f 7472 6565 5f73 6571 7565  f._ll_tree_seque
+0002b720: 6e63 652e 6765 745f 7365 7175 656e 6365  nce.get_sequence
+0002b730: 5f6c 656e 6774 6828 290a 0a20 2020 2040  _length()..    @
+0002b740: 7072 6f70 6572 7479 0a20 2020 2064 6566  property.    def
+0002b750: 206d 6574 6164 6174 6128 7365 6c66 2920   metadata(self) 
+0002b760: 2d3e 2041 6e79 3a0a 2020 2020 2020 2020  -> Any:.        
+0002b770: 2222 220a 2020 2020 2020 2020 5468 6520  """.        The 
+0002b780: 6465 636f 6465 6420 6d65 7461 6461 7461  decoded metadata
+0002b790: 2066 6f72 2074 6869 7320 5472 6565 5365   for this TreeSe
+0002b7a0: 7175 656e 6365 2e0a 2020 2020 2020 2020  quence..        
+0002b7b0: 2222 220a 2020 2020 2020 2020 7265 7475  """.        retu
+0002b7c0: 726e 2073 656c 662e 6d65 7461 6461 7461  rn self.metadata
+0002b7d0: 5f73 6368 656d 612e 6465 636f 6465 5f72  _schema.decode_r
+0002b7e0: 6f77 2873 656c 662e 5f6c 6c5f 7472 6565  ow(self._ll_tree
+0002b7f0: 5f73 6571 7565 6e63 652e 6765 745f 6d65  _sequence.get_me
+0002b800: 7461 6461 7461 2829 290a 0a20 2020 2040  tadata())..    @
+0002b810: 7072 6f70 6572 7479 0a20 2020 2064 6566  property.    def
+0002b820: 206d 6574 6164 6174 615f 7363 6865 6d61   metadata_schema
+0002b830: 2873 656c 6629 202d 3e20 6d65 7461 6461  (self) -> metada
+0002b840: 7461 5f6d 6f64 756c 652e 4d65 7461 6461  ta_module.Metada
+0002b850: 7461 5363 6865 6d61 3a0a 2020 2020 2020  taSchema:.      
+0002b860: 2020 2222 220a 2020 2020 2020 2020 5468    """.        Th
+0002b870: 6520 3a63 6c61 7373 3a60 7473 6b69 742e  e :class:`tskit.
+0002b880: 4d65 7461 6461 7461 5363 6865 6d61 6020  MetadataSchema` 
+0002b890: 666f 7220 7468 6973 2054 7265 6553 6571  for this TreeSeq
+0002b8a0: 7565 6e63 652e 0a20 2020 2020 2020 2022  uence..        "
+0002b8b0: 2222 0a20 2020 2020 2020 2072 6574 7572  "".        retur
+0002b8c0: 6e20 6d65 7461 6461 7461 5f6d 6f64 756c  n metadata_modul
+0002b8d0: 652e 7061 7273 655f 6d65 7461 6461 7461  e.parse_metadata
+0002b8e0: 5f73 6368 656d 6128 0a20 2020 2020 2020  _schema(.       
+0002b8f0: 2020 2020 2073 656c 662e 5f6c 6c5f 7472       self._ll_tr
+0002b900: 6565 5f73 6571 7565 6e63 652e 6765 745f  ee_sequence.get_
+0002b910: 6d65 7461 6461 7461 5f73 6368 656d 6128  metadata_schema(
+0002b920: 290a 2020 2020 2020 2020 290a 0a20 2020  ).        )..   
+0002b930: 2040 7072 6f70 6572 7479 0a20 2020 2064   @property.    d
+0002b940: 6566 2074 696d 655f 756e 6974 7328 7365  ef time_units(se
+0002b950: 6c66 2920 2d3e 2073 7472 3a0a 2020 2020  lf) -> str:.    
+0002b960: 2020 2020 2222 220a 2020 2020 2020 2020      """.        
+0002b970: 5374 7269 6e67 2064 6573 6372 6962 696e  String describin
+0002b980: 6720 7468 6520 756e 6974 7320 6f66 2074  g the units of t
+0002b990: 6865 2074 696d 6520 6469 6d65 6e73 696f  he time dimensio
+0002b9a0: 6e20 666f 7220 7468 6973 2054 7265 6553  n for this TreeS
+0002b9b0: 6571 7565 6e63 652e 0a20 2020 2020 2020  equence..       
+0002b9c0: 2022 2222 0a20 2020 2020 2020 2072 6574   """.        ret
+0002b9d0: 7572 6e20 7365 6c66 2e5f 6c6c 5f74 7265  urn self._ll_tre
+0002b9e0: 655f 7365 7175 656e 6365 2e67 6574 5f74  e_sequence.get_t
+0002b9f0: 696d 655f 756e 6974 7328 290a 0a20 2020  ime_units()..   
+0002ba00: 2040 7072 6f70 6572 7479 0a20 2020 2064   @property.    d
+0002ba10: 6566 206e 756d 5f65 6467 6573 2873 656c  ef num_edges(sel
+0002ba20: 6629 3a0a 2020 2020 2020 2020 2222 220a  f):.        """.
+0002ba30: 2020 2020 2020 2020 5265 7475 726e 7320          Returns 
+0002ba40: 7468 6520 6e75 6d62 6572 206f 6620 3a72  the number of :r
+0002ba50: 6566 3a60 6564 6765 7320 3c73 6563 5f65  ef:`edges <sec_e
+0002ba60: 6467 655f 7461 626c 655f 6465 6669 6e69  dge_table_defini
+0002ba70: 7469 6f6e 3e60 2069 6e20 7468 6973 0a20  tion>` in this. 
+0002ba80: 2020 2020 2020 2074 7265 6520 7365 7175         tree sequ
+0002ba90: 656e 6365 2e0a 0a20 2020 2020 2020 203a  ence...        :
+0002baa0: 7265 7475 726e 3a20 5468 6520 6e75 6d62  return: The numb
+0002bab0: 6572 206f 6620 6564 6765 7320 696e 2074  er of edges in t
+0002bac0: 6869 7320 7472 6565 2073 6571 7565 6e63  his tree sequenc
+0002bad0: 652e 0a20 2020 2020 2020 203a 7274 7970  e..        :rtyp
+0002bae0: 653a 2069 6e74 0a20 2020 2020 2020 2022  e: int.        "
+0002baf0: 2222 0a20 2020 2020 2020 2072 6574 7572  "".        retur
+0002bb00: 6e20 7365 6c66 2e5f 6c6c 5f74 7265 655f  n self._ll_tree_
+0002bb10: 7365 7175 656e 6365 2e67 6574 5f6e 756d  sequence.get_num
+0002bb20: 5f65 6467 6573 2829 0a0a 2020 2020 6465  _edges()..    de
+0002bb30: 6620 6765 745f 6e75 6d5f 7472 6565 7328  f get_num_trees(
+0002bb40: 7365 6c66 293a 0a20 2020 2020 2020 2023  self):.        #
+0002bb50: 2044 6570 7265 6361 7465 6420 616c 6961   Deprecated alia
+0002bb60: 7320 666f 7220 7365 6c66 2e6e 756d 5f74  s for self.num_t
+0002bb70: 7265 6573 0a20 2020 2020 2020 2072 6574  rees.        ret
+0002bb80: 7572 6e20 7365 6c66 2e6e 756d 5f74 7265  urn self.num_tre
+0002bb90: 6573 0a0a 2020 2020 4070 726f 7065 7274  es..    @propert
+0002bba0: 790a 2020 2020 6465 6620 6e75 6d5f 7472  y.    def num_tr
+0002bbb0: 6565 7328 7365 6c66 293a 0a20 2020 2020  ees(self):.     
+0002bbc0: 2020 2022 2222 0a20 2020 2020 2020 2052     """.        R
+0002bbd0: 6574 7572 6e73 2074 6865 206e 756d 6265  eturns the numbe
+0002bbe0: 7220 6f66 2064 6973 7469 6e63 7420 7472  r of distinct tr
+0002bbf0: 6565 7320 696e 2074 6869 7320 7472 6565  ees in this tree
+0002bc00: 2073 6571 7565 6e63 652e 2054 6869 730a   sequence. This.
+0002bc10: 2020 2020 2020 2020 6973 2065 7175 616c          is equal
+0002bc20: 2074 6f20 7468 6520 6e75 6d62 6572 206f   to the number o
+0002bc30: 6620 7472 6565 7320 7265 7475 726e 6564  f trees returned
+0002bc40: 2062 7920 7468 6520 3a6d 6574 683a 602e   by the :meth:`.
+0002bc50: 7472 6565 7360 0a20 2020 2020 2020 206d  trees`.        m
+0002bc60: 6574 686f 642e 0a0a 2020 2020 2020 2020  ethod...        
+0002bc70: 3a72 6574 7572 6e3a 2054 6865 206e 756d  :return: The num
+0002bc80: 6265 7220 6f66 2074 7265 6573 2069 6e20  ber of trees in 
+0002bc90: 7468 6973 2074 7265 6520 7365 7175 656e  this tree sequen
+0002bca0: 6365 2e0a 2020 2020 2020 2020 3a72 7479  ce..        :rty
+0002bcb0: 7065 3a20 696e 740a 2020 2020 2020 2020  pe: int.        
+0002bcc0: 2222 220a 2020 2020 2020 2020 7265 7475  """.        retu
+0002bcd0: 726e 2073 656c 662e 5f6c 6c5f 7472 6565  rn self._ll_tree
+0002bce0: 5f73 6571 7565 6e63 652e 6765 745f 6e75  _sequence.get_nu
+0002bcf0: 6d5f 7472 6565 7328 290a 0a20 2020 2064  m_trees()..    d
+0002bd00: 6566 2067 6574 5f6e 756d 5f73 6974 6573  ef get_num_sites
+0002bd10: 2873 656c 6629 3a0a 2020 2020 2020 2020  (self):.        
+0002bd20: 2320 4465 7072 6563 6174 6564 2061 6c69  # Deprecated ali
+0002bd30: 6173 2066 6f72 2073 656c 662e 6e75 6d5f  as for self.num_
+0002bd40: 7369 7465 730a 2020 2020 2020 2020 7265  sites.        re
+0002bd50: 7475 726e 2073 656c 662e 5f6c 6c5f 7472  turn self._ll_tr
+0002bd60: 6565 5f73 6571 7565 6e63 652e 6765 745f  ee_sequence.get_
+0002bd70: 6e75 6d5f 7369 7465 7328 290a 0a20 2020  num_sites()..   
+0002bd80: 2040 7072 6f70 6572 7479 0a20 2020 2064   @property.    d
+0002bd90: 6566 206e 756d 5f73 6974 6573 2873 656c  ef num_sites(sel
+0002bda0: 6629 3a0a 2020 2020 2020 2020 2222 220a  f):.        """.
+0002bdb0: 2020 2020 2020 2020 5265 7475 726e 7320          Returns 
+0002bdc0: 7468 6520 6e75 6d62 6572 206f 6620 3a72  the number of :r
+0002bdd0: 6566 3a60 7369 7465 7320 3c73 6563 5f73  ef:`sites <sec_s
+0002bde0: 6974 655f 7461 626c 655f 6465 6669 6e69  ite_table_defini
+0002bdf0: 7469 6f6e 3e60 2069 6e0a 2020 2020 2020  tion>` in.      
+0002be00: 2020 7468 6973 2074 7265 6520 7365 7175    this tree sequ
+0002be10: 656e 6365 2e0a 0a20 2020 2020 2020 203a  ence...        :
+0002be20: 7265 7475 726e 3a20 5468 6520 6e75 6d62  return: The numb
+0002be30: 6572 206f 6620 7369 7465 7320 696e 2074  er of sites in t
+0002be40: 6869 7320 7472 6565 2073 6571 7565 6e63  his tree sequenc
+0002be50: 652e 0a20 2020 2020 2020 203a 7274 7970  e..        :rtyp
+0002be60: 653a 2069 6e74 0a20 2020 2020 2020 2022  e: int.        "
+0002be70: 2222 0a20 2020 2020 2020 2072 6574 7572  "".        retur
+0002be80: 6e20 7365 6c66 2e67 6574 5f6e 756d 5f73  n self.get_num_s
+0002be90: 6974 6573 2829 0a0a 2020 2020 6465 6620  ites()..    def 
+0002bea0: 6765 745f 6e75 6d5f 6d75 7461 7469 6f6e  get_num_mutation
+0002beb0: 7328 7365 6c66 293a 0a20 2020 2020 2020  s(self):.       
+0002bec0: 2023 2044 6570 7265 6361 7465 6420 616c   # Deprecated al
+0002bed0: 6961 7320 666f 7220 7365 6c66 2e6e 756d  ias for self.num
+0002bee0: 5f6d 7574 6174 696f 6e73 0a20 2020 2020  _mutations.     
+0002bef0: 2020 2072 6574 7572 6e20 7365 6c66 2e6e     return self.n
+0002bf00: 756d 5f6d 7574 6174 696f 6e73 0a0a 2020  um_mutations..  
+0002bf10: 2020 4070 726f 7065 7274 790a 2020 2020    @property.    
+0002bf20: 6465 6620 6e75 6d5f 6d75 7461 7469 6f6e  def num_mutation
+0002bf30: 7328 7365 6c66 293a 0a20 2020 2020 2020  s(self):.       
+0002bf40: 2022 2222 0a20 2020 2020 2020 2052 6574   """.        Ret
+0002bf50: 7572 6e73 2074 6865 206e 756d 6265 7220  urns the number 
+0002bf60: 6f66 203a 7265 663a 606d 7574 6174 696f  of :ref:`mutatio
+0002bf70: 6e73 203c 7365 635f 6d75 7461 7469 6f6e  ns <sec_mutation
+0002bf80: 5f74 6162 6c65 5f64 6566 696e 6974 696f  _table_definitio
+0002bf90: 6e3e 600a 2020 2020 2020 2020 696e 2074  n>`.        in t
+0002bfa0: 6869 7320 7472 6565 2073 6571 7565 6e63  his tree sequenc
+0002bfb0: 652e 0a0a 2020 2020 2020 2020 3a72 6574  e...        :ret
+0002bfc0: 7572 6e3a 2054 6865 206e 756d 6265 7220  urn: The number 
+0002bfd0: 6f66 206d 7574 6174 696f 6e73 2069 6e20  of mutations in 
+0002bfe0: 7468 6973 2074 7265 6520 7365 7175 656e  this tree sequen
+0002bff0: 6365 2e0a 2020 2020 2020 2020 3a72 7479  ce..        :rty
+0002c000: 7065 3a20 696e 740a 2020 2020 2020 2020  pe: int.        
+0002c010: 2222 220a 2020 2020 2020 2020 7265 7475  """.        retu
+0002c020: 726e 2073 656c 662e 5f6c 6c5f 7472 6565  rn self._ll_tree
+0002c030: 5f73 6571 7565 6e63 652e 6765 745f 6e75  _sequence.get_nu
+0002c040: 6d5f 6d75 7461 7469 6f6e 7328 290a 0a20  m_mutations().. 
+0002c050: 2020 2064 6566 2067 6574 5f6e 756d 5f6e     def get_num_n
+0002c060: 6f64 6573 2873 656c 6629 3a0a 2020 2020  odes(self):.    
+0002c070: 2020 2020 2320 4465 7072 6563 6174 6564      # Deprecated
+0002c080: 2061 6c69 6173 2066 6f72 2073 656c 662e   alias for self.
+0002c090: 6e75 6d5f 6e6f 6465 730a 2020 2020 2020  num_nodes.      
+0002c0a0: 2020 7265 7475 726e 2073 656c 662e 6e75    return self.nu
+0002c0b0: 6d5f 6e6f 6465 730a 0a20 2020 2040 7072  m_nodes..    @pr
+0002c0c0: 6f70 6572 7479 0a20 2020 2064 6566 206e  operty.    def n
+0002c0d0: 756d 5f69 6e64 6976 6964 7561 6c73 2873  um_individuals(s
+0002c0e0: 656c 6629 3a0a 2020 2020 2020 2020 2222  elf):.        ""
+0002c0f0: 220a 2020 2020 2020 2020 5265 7475 726e  ".        Return
+0002c100: 7320 7468 6520 6e75 6d62 6572 206f 6620  s the number of 
+0002c110: 3a72 6566 3a60 696e 6469 7669 6475 616c  :ref:`individual
+0002c120: 7320 3c73 6563 5f69 6e64 6976 6964 7561  s <sec_individua
+0002c130: 6c5f 7461 626c 655f 6465 6669 6e69 7469  l_table_definiti
+0002c140: 6f6e 3e60 2069 6e0a 2020 2020 2020 2020  on>` in.        
+0002c150: 7468 6973 2074 7265 6520 7365 7175 656e  this tree sequen
+0002c160: 6365 2e0a 0a20 2020 2020 2020 203a 7265  ce...        :re
+0002c170: 7475 726e 3a20 5468 6520 6e75 6d62 6572  turn: The number
+0002c180: 206f 6620 696e 6469 7669 6475 616c 7320   of individuals 
+0002c190: 696e 2074 6869 7320 7472 6565 2073 6571  in this tree seq
+0002c1a0: 7565 6e63 652e 0a20 2020 2020 2020 203a  uence..        :
+0002c1b0: 7274 7970 653a 2069 6e74 0a20 2020 2020  rtype: int.     
+0002c1c0: 2020 2022 2222 0a20 2020 2020 2020 2072     """.        r
+0002c1d0: 6574 7572 6e20 7365 6c66 2e5f 6c6c 5f74  eturn self._ll_t
+0002c1e0: 7265 655f 7365 7175 656e 6365 2e67 6574  ree_sequence.get
+0002c1f0: 5f6e 756d 5f69 6e64 6976 6964 7561 6c73  _num_individuals
+0002c200: 2829 0a0a 2020 2020 4070 726f 7065 7274  ()..    @propert
+0002c210: 790a 2020 2020 6465 6620 6e75 6d5f 6e6f  y.    def num_no
+0002c220: 6465 7328 7365 6c66 293a 0a20 2020 2020  des(self):.     
+0002c230: 2020 2022 2222 0a20 2020 2020 2020 2052     """.        R
+0002c240: 6574 7572 6e73 2074 6865 206e 756d 6265  eturns the numbe
+0002c250: 7220 6f66 203a 7265 663a 606e 6f64 6573  r of :ref:`nodes
+0002c260: 203c 7365 635f 6e6f 6465 5f74 6162 6c65   <sec_node_table
+0002c270: 5f64 6566 696e 6974 696f 6e3e 6020 696e  _definition>` in
+0002c280: 0a20 2020 2020 2020 2074 6869 7320 7472  .        this tr
+0002c290: 6565 2073 6571 7565 6e63 652e 0a0a 2020  ee sequence...  
+0002c2a0: 2020 2020 2020 3a72 6574 7572 6e3a 2054        :return: T
+0002c2b0: 6865 206e 756d 6265 7220 6f66 206e 6f64  he number of nod
+0002c2c0: 6573 2069 6e20 7468 6973 2074 7265 6520  es in this tree 
+0002c2d0: 7365 7175 656e 6365 2e0a 2020 2020 2020  sequence..      
+0002c2e0: 2020 3a72 7479 7065 3a20 696e 740a 2020    :rtype: int.  
+0002c2f0: 2020 2020 2020 2222 220a 2020 2020 2020        """.      
+0002c300: 2020 7265 7475 726e 2073 656c 662e 5f6c    return self._l
+0002c310: 6c5f 7472 6565 5f73 6571 7565 6e63 652e  l_tree_sequence.
+0002c320: 6765 745f 6e75 6d5f 6e6f 6465 7328 290a  get_num_nodes().
+0002c330: 0a20 2020 2040 7072 6f70 6572 7479 0a20  .    @property. 
+0002c340: 2020 2064 6566 206e 756d 5f70 726f 7665     def num_prove
+0002c350: 6e61 6e63 6573 2873 656c 6629 3a0a 2020  nances(self):.  
+0002c360: 2020 2020 2020 2222 220a 2020 2020 2020        """.      
+0002c370: 2020 5265 7475 726e 7320 7468 6520 6e75    Returns the nu
+0002c380: 6d62 6572 206f 6620 3a72 6566 3a60 7072  mber of :ref:`pr
+0002c390: 6f76 656e 616e 6365 7320 3c73 6563 5f70  ovenances <sec_p
+0002c3a0: 726f 7665 6e61 6e63 655f 7461 626c 655f  rovenance_table_
+0002c3b0: 6465 6669 6e69 7469 6f6e 3e60 0a20 2020  definition>`.   
+0002c3c0: 2020 2020 2069 6e20 7468 6973 2074 7265       in this tre
+0002c3d0: 6520 7365 7175 656e 6365 2e0a 0a20 2020  e sequence...   
+0002c3e0: 2020 2020 203a 7265 7475 726e 3a20 5468       :return: Th
+0002c3f0: 6520 6e75 6d62 6572 206f 6620 7072 6f76  e number of prov
+0002c400: 656e 616e 6365 7320 696e 2074 6869 7320  enances in this 
+0002c410: 7472 6565 2073 6571 7565 6e63 652e 0a20  tree sequence.. 
+0002c420: 2020 2020 2020 203a 7274 7970 653a 2069         :rtype: i
+0002c430: 6e74 0a20 2020 2020 2020 2022 2222 0a20  nt.        """. 
+0002c440: 2020 2020 2020 2072 6574 7572 6e20 7365         return se
+0002c450: 6c66 2e5f 6c6c 5f74 7265 655f 7365 7175  lf._ll_tree_sequ
+0002c460: 656e 6365 2e67 6574 5f6e 756d 5f70 726f  ence.get_num_pro
+0002c470: 7665 6e61 6e63 6573 2829 0a0a 2020 2020  venances()..    
+0002c480: 4070 726f 7065 7274 790a 2020 2020 6465  @property.    de
+0002c490: 6620 6e75 6d5f 706f 7075 6c61 7469 6f6e  f num_population
+0002c4a0: 7328 7365 6c66 293a 0a20 2020 2020 2020  s(self):.       
+0002c4b0: 2022 2222 0a20 2020 2020 2020 2052 6574   """.        Ret
+0002c4c0: 7572 6e73 2074 6865 206e 756d 6265 7220  urns the number 
+0002c4d0: 6f66 203a 7265 663a 6070 6f70 756c 6174  of :ref:`populat
+0002c4e0: 696f 6e73 203c 7365 635f 706f 7075 6c61  ions <sec_popula
+0002c4f0: 7469 6f6e 5f74 6162 6c65 5f64 6566 696e  tion_table_defin
+0002c500: 6974 696f 6e3e 600a 2020 2020 2020 2020  ition>`.        
+0002c510: 696e 2074 6869 7320 7472 6565 2073 6571  in this tree seq
+0002c520: 7565 6e63 652e 0a0a 2020 2020 2020 2020  uence...        
+0002c530: 3a72 6574 7572 6e3a 2054 6865 206e 756d  :return: The num
+0002c540: 6265 7220 6f66 2070 6f70 756c 6174 696f  ber of populatio
+0002c550: 6e73 2069 6e20 7468 6973 2074 7265 6520  ns in this tree 
+0002c560: 7365 7175 656e 6365 2e0a 2020 2020 2020  sequence..      
+0002c570: 2020 3a72 7479 7065 3a20 696e 740a 2020    :rtype: int.  
+0002c580: 2020 2020 2020 2222 220a 2020 2020 2020        """.      
+0002c590: 2020 7265 7475 726e 2073 656c 662e 5f6c    return self._l
+0002c5a0: 6c5f 7472 6565 5f73 6571 7565 6e63 652e  l_tree_sequence.
+0002c5b0: 6765 745f 6e75 6d5f 706f 7075 6c61 7469  get_num_populati
+0002c5c0: 6f6e 7328 290a 0a20 2020 2040 7072 6f70  ons()..    @prop
+0002c5d0: 6572 7479 0a20 2020 2064 6566 206e 756d  erty.    def num
+0002c5e0: 5f6d 6967 7261 7469 6f6e 7328 7365 6c66  _migrations(self
+0002c5f0: 293a 0a20 2020 2020 2020 2022 2222 0a20  ):.        """. 
+0002c600: 2020 2020 2020 2052 6574 7572 6e73 2074         Returns t
+0002c610: 6865 206e 756d 6265 7220 6f66 203a 7265  he number of :re
+0002c620: 663a 606d 6967 7261 7469 6f6e 7320 3c73  f:`migrations <s
+0002c630: 6563 5f6d 6967 7261 7469 6f6e 5f74 6162  ec_migration_tab
+0002c640: 6c65 5f64 6566 696e 6974 696f 6e3e 600a  le_definition>`.
+0002c650: 2020 2020 2020 2020 696e 2074 6869 7320          in this 
+0002c660: 7472 6565 2073 6571 7565 6e63 652e 0a0a  tree sequence...
+0002c670: 2020 2020 2020 2020 3a72 6574 7572 6e3a          :return:
+0002c680: 2054 6865 206e 756d 6265 7220 6f66 206d   The number of m
+0002c690: 6967 7261 7469 6f6e 7320 696e 2074 6869  igrations in thi
+0002c6a0: 7320 7472 6565 2073 6571 7565 6e63 652e  s tree sequence.
+0002c6b0: 0a20 2020 2020 2020 203a 7274 7970 653a  .        :rtype:
+0002c6c0: 2069 6e74 0a20 2020 2020 2020 2022 2222   int.        """
+0002c6d0: 0a20 2020 2020 2020 2072 6574 7572 6e20  .        return 
+0002c6e0: 7365 6c66 2e5f 6c6c 5f74 7265 655f 7365  self._ll_tree_se
+0002c6f0: 7175 656e 6365 2e67 6574 5f6e 756d 5f6d  quence.get_num_m
+0002c700: 6967 7261 7469 6f6e 7328 290a 0a20 2020  igrations()..   
+0002c710: 2040 7072 6f70 6572 7479 0a20 2020 2064   @property.    d
+0002c720: 6566 206d 6178 5f72 6f6f 745f 7469 6d65  ef max_root_time
+0002c730: 2873 656c 6629 3a0a 2020 2020 2020 2020  (self):.        
+0002c740: 2222 220a 2020 2020 2020 2020 5265 7475  """.        Retu
+0002c750: 726e 7320 7468 6520 7469 6d65 206f 6620  rns the time of 
+0002c760: 7468 6520 6f6c 6465 7374 2072 6f6f 7420  the oldest root 
+0002c770: 696e 2061 6e79 206f 6620 7468 6520 7472  in any of the tr
+0002c780: 6565 7320 696e 2074 6869 7320 7472 6565  ees in this tree
+0002c790: 2073 6571 7565 6e63 652e 0a20 2020 2020   sequence..     
+0002c7a0: 2020 2054 6869 7320 6973 2075 7375 616c     This is usual
+0002c7b0: 6c79 2065 7175 616c 2074 6f20 6060 6e70  ly equal to ``np
+0002c7c0: 2e6d 6178 2874 732e 7461 626c 6573 2e6e  .max(ts.tables.n
+0002c7d0: 6f64 6573 2e74 696d 6529 6060 2062 7574  odes.time)`` but
+0002c7e0: 206d 6179 206e 6f74 2062 650a 2020 2020   may not be.    
+0002c7f0: 2020 2020 7369 6e63 6520 7468 6572 6520      since there 
+0002c800: 6361 6e20 6265 206e 6f6e 2d73 616d 706c  can be non-sampl
+0002c810: 6520 6e6f 6465 7320 7468 6174 2061 7265  e nodes that are
+0002c820: 206e 6f74 2070 7265 7365 6e74 2069 6e20   not present in 
+0002c830: 616e 7920 7472 6565 2e20 4e6f 7465 2074  any tree. Note t
+0002c840: 6861 740a 2020 2020 2020 2020 6973 6f6c  hat.        isol
+0002c850: 6174 6564 2073 616d 706c 6573 2061 7265  ated samples are
+0002c860: 2061 6c73 6f20 6465 6669 6e65 6420 6173   also defined as
+0002c870: 2072 6f6f 7473 2028 736f 2074 6865 7265   roots (so there
+0002c880: 2063 616e 2062 6520 6120 6d61 785f 726f   can be a max_ro
+0002c890: 6f74 5f74 696d 650a 2020 2020 2020 2020  ot_time.        
+0002c8a0: 6576 656e 2069 6e20 6120 7472 6565 2073  even in a tree s
+0002c8b0: 6571 7565 6e63 6520 7769 7468 206e 6f20  equence with no 
+0002c8c0: 6564 6765 7329 2e0a 0a20 2020 2020 2020  edges)...       
+0002c8d0: 203a 7265 7475 726e 3a20 5468 6520 6d61   :return: The ma
+0002c8e0: 7869 6d75 6d20 7469 6d65 206f 6620 6120  ximum time of a 
+0002c8f0: 726f 6f74 2069 6e20 7468 6973 2074 7265  root in this tre
+0002c900: 6520 7365 7175 656e 6365 2e0a 2020 2020  e sequence..    
+0002c910: 2020 2020 3a72 7479 7065 3a20 666c 6f61      :rtype: floa
+0002c920: 740a 2020 2020 2020 2020 3a72 6169 7365  t.        :raise
+0002c930: 7320 5661 6c75 6545 7272 6f72 3a20 4966  s ValueError: If
+0002c940: 2074 6865 7265 2061 7265 206e 6f20 7361   there are no sa
+0002c950: 6d70 6c65 7320 696e 2074 6865 2074 7265  mples in the tre
+0002c960: 652c 2061 6e64 2068 656e 6365 206e 6f20  e, and hence no 
+0002c970: 726f 6f74 7320 2861 730a 2020 2020 2020  roots (as.      
+0002c980: 2020 2020 2020 726f 6f74 7320 6172 6520        roots are 
+0002c990: 6465 6669 6e65 6420 6279 2074 6865 2065  defined by the e
+0002c9a0: 6e64 7320 6f66 2074 6865 2075 7077 6172  nds of the upwar
+0002c9b0: 6420 7061 7468 7320 6672 6f6d 2074 6865  d paths from the
+0002c9c0: 2073 6574 206f 6620 7361 6d70 6c65 7329   set of samples)
+0002c9d0: 2e0a 2020 2020 2020 2020 2222 220a 2020  ..        """.  
+0002c9e0: 2020 2020 2020 6966 2073 656c 662e 6e75        if self.nu
+0002c9f0: 6d5f 7361 6d70 6c65 7320 3d3d 2030 3a0a  m_samples == 0:.
+0002ca00: 2020 2020 2020 2020 2020 2020 7261 6973              rais
+0002ca10: 6520 5661 6c75 6545 7272 6f72 280a 2020  e ValueError(.  
+0002ca20: 2020 2020 2020 2020 2020 2020 2020 226d                "m
+0002ca30: 6178 5f72 6f6f 745f 7469 6d65 2069 7320  ax_root_time is 
+0002ca40: 6e6f 7420 6465 6669 6e65 6420 696e 2061  not defined in a
+0002ca50: 2074 7265 6520 7365 7175 656e 6365 2077   tree sequence w
+0002ca60: 6974 6820 3020 7361 6d70 6c65 7322 0a20  ith 0 samples". 
+0002ca70: 2020 2020 2020 2020 2020 2029 0a20 2020             ).   
+0002ca80: 2020 2020 2072 6574 203d 206d 6178 2873       ret = max(s
+0002ca90: 656c 662e 6e6f 6465 2875 292e 7469 6d65  elf.node(u).time
+0002caa0: 2066 6f72 2075 2069 6e20 7365 6c66 2e73   for u in self.s
+0002cab0: 616d 706c 6573 2829 290a 2020 2020 2020  amples()).      
+0002cac0: 2020 6966 2073 656c 662e 6e75 6d5f 6564    if self.num_ed
+0002cad0: 6765 7320 3e20 303a 0a20 2020 2020 2020  ges > 0:.       
+0002cae0: 2020 2020 2023 2045 6467 6573 2061 7265       # Edges are
+0002caf0: 2067 7561 7261 6e74 6565 6420 746f 2062   guaranteed to b
+0002cb00: 6520 6c69 7374 6564 2069 6e20 7061 7265  e listed in pare
+0002cb10: 6e74 2d74 696d 6520 6f72 6465 722c 2073  nt-time order, s
+0002cb20: 6f20 7765 2063 616e 2067 6574 2074 6865  o we can get the
+0002cb30: 0a20 2020 2020 2020 2020 2020 2023 206c  .            # l
+0002cb40: 6173 7420 6f6e 6520 746f 2067 6574 2074  ast one to get t
+0002cb50: 6865 206f 6c64 6573 7420 726f 6f74 0a20  he oldest root. 
+0002cb60: 2020 2020 2020 2020 2020 2065 6467 6520             edge 
+0002cb70: 3d20 7365 6c66 2e65 6467 6528 7365 6c66  = self.edge(self
+0002cb80: 2e6e 756d 5f65 6467 6573 202d 2031 290a  .num_edges - 1).
+0002cb90: 2020 2020 2020 2020 2020 2020 2320 486f              # Ho
+0002cba0: 7765 7665 722c 2077 6520 6361 6e20 6861  wever, we can ha
+0002cbb0: 7665 2073 6974 7561 7469 6f6e 7320 7768  ve situations wh
+0002cbc0: 6572 6520 7468 6572 6520 6973 2061 2073  ere there is a s
+0002cbd0: 616d 706c 6520 6f6c 6465 7220 7468 616e  ample older than
+0002cbe0: 2061 0a20 2020 2020 2020 2020 2020 2023   a.            #
+0002cbf0: 2027 7072 6f70 6572 2720 726f 6f74 0a20   'proper' root. 
+0002cc00: 2020 2020 2020 2020 2020 2072 6574 203d             ret =
+0002cc10: 206d 6178 2872 6574 2c20 7365 6c66 2e6e   max(ret, self.n
+0002cc20: 6f64 6528 6564 6765 2e70 6172 656e 7429  ode(edge.parent)
+0002cc30: 2e74 696d 6529 0a20 2020 2020 2020 2072  .time).        r
+0002cc40: 6574 7572 6e20 7265 740a 0a20 2020 2064  eturn ret..    d
+0002cc50: 6566 206d 6967 7261 7469 6f6e 7328 7365  ef migrations(se
+0002cc60: 6c66 293a 0a20 2020 2020 2020 2022 2222  lf):.        """
+0002cc70: 0a20 2020 2020 2020 2052 6574 7572 6e73  .        Returns
+0002cc80: 2061 6e20 6974 6572 6162 6c65 2073 6571   an iterable seq
+0002cc90: 7565 6e63 6520 6f66 2061 6c6c 2074 6865  uence of all the
+0002cca0: 0a20 2020 2020 2020 203a 7265 663a 606d  .        :ref:`m
+0002ccb0: 6967 7261 7469 6f6e 7320 3c73 6563 5f6d  igrations <sec_m
+0002ccc0: 6967 7261 7469 6f6e 5f74 6162 6c65 5f64  igration_table_d
+0002ccd0: 6566 696e 6974 696f 6e3e 6020 696e 2074  efinition>` in t
+0002cce0: 6869 7320 7472 6565 2073 6571 7565 6e63  his tree sequenc
+0002ccf0: 652e 0a0a 2020 2020 2020 2020 4d69 6772  e...        Migr
+0002cd00: 6174 696f 6e73 2061 7265 2072 6574 7572  ations are retur
+0002cd10: 6e65 6420 696e 206e 6f6e 6465 6372 6561  ned in nondecrea
+0002cd20: 7369 6e67 206f 7264 6572 206f 6620 7468  sing order of th
+0002cd30: 6520 6060 7469 6d65 6060 2076 616c 7565  e ``time`` value
+0002cd40: 2e0a 0a20 2020 2020 2020 203a 7265 7475  ...        :retu
+0002cd50: 726e 3a20 416e 2069 7465 7261 626c 6520  rn: An iterable 
+0002cd60: 7365 7175 656e 6365 206f 6620 616c 6c20  sequence of all 
+0002cd70: 6d69 6772 6174 696f 6e73 2e0a 2020 2020  migrations..    
+0002cd80: 2020 2020 3a72 7479 7065 3a20 5365 7175      :rtype: Sequ
+0002cd90: 656e 6365 283a 636c 6173 733a 602e 4d69  ence(:class:`.Mi
+0002cda0: 6772 6174 696f 6e60 290a 2020 2020 2020  gration`).      
+0002cdb0: 2020 2222 220a 2020 2020 2020 2020 7265    """.        re
+0002cdc0: 7475 726e 2053 696d 706c 6543 6f6e 7461  turn SimpleConta
+0002cdd0: 696e 6572 5365 7175 656e 6365 2873 656c  inerSequence(sel
+0002cde0: 662e 6d69 6772 6174 696f 6e2c 2073 656c  f.migration, sel
+0002cdf0: 662e 6e75 6d5f 6d69 6772 6174 696f 6e73  f.num_migrations
+0002ce00: 290a 0a20 2020 2064 6566 2069 6e64 6976  )..    def indiv
+0002ce10: 6964 7561 6c73 2873 656c 6629 3a0a 2020  iduals(self):.  
+0002ce20: 2020 2020 2020 2222 220a 2020 2020 2020        """.      
+0002ce30: 2020 5265 7475 726e 7320 616e 2069 7465    Returns an ite
+0002ce40: 7261 626c 6520 7365 7175 656e 6365 206f  rable sequence o
+0002ce50: 6620 616c 6c20 7468 650a 2020 2020 2020  f all the.      
+0002ce60: 2020 3a72 6566 3a60 696e 6469 7669 6475    :ref:`individu
+0002ce70: 616c 7320 3c73 6563 5f69 6e64 6976 6964  als <sec_individ
+0002ce80: 7561 6c5f 7461 626c 655f 6465 6669 6e69  ual_table_defini
+0002ce90: 7469 6f6e 3e60 2069 6e20 7468 6973 2074  tion>` in this t
+0002cea0: 7265 6520 7365 7175 656e 6365 2e0a 0a20  ree sequence... 
+0002ceb0: 2020 2020 2020 203a 7265 7475 726e 3a20         :return: 
+0002cec0: 416e 2069 7465 7261 626c 6520 7365 7175  An iterable sequ
+0002ced0: 656e 6365 206f 6620 616c 6c20 696e 6469  ence of all indi
+0002cee0: 7669 6475 616c 732e 0a20 2020 2020 2020  viduals..       
+0002cef0: 203a 7274 7970 653a 2053 6571 7565 6e63   :rtype: Sequenc
+0002cf00: 6528 3a63 6c61 7373 3a60 2e49 6e64 6976  e(:class:`.Indiv
+0002cf10: 6964 7561 6c60 290a 2020 2020 2020 2020  idual`).        
+0002cf20: 2222 220a 2020 2020 2020 2020 7265 7475  """.        retu
+0002cf30: 726e 2053 696d 706c 6543 6f6e 7461 696e  rn SimpleContain
+0002cf40: 6572 5365 7175 656e 6365 2873 656c 662e  erSequence(self.
+0002cf50: 696e 6469 7669 6475 616c 2c20 7365 6c66  individual, self
+0002cf60: 2e6e 756d 5f69 6e64 6976 6964 7561 6c73  .num_individuals
+0002cf70: 290a 0a20 2020 2064 6566 206e 6f64 6573  )..    def nodes
+0002cf80: 2873 656c 662c 202a 2c20 6f72 6465 723d  (self, *, order=
+0002cf90: 4e6f 6e65 293a 0a20 2020 2020 2020 2022  None):.        "
+0002cfa0: 2222 0a20 2020 2020 2020 2052 6574 7572  "".        Retur
+0002cfb0: 6e73 2061 6e20 6974 6572 6162 6c65 2073  ns an iterable s
+0002cfc0: 6571 7565 6e63 6520 6f66 2061 6c6c 2074  equence of all t
+0002cfd0: 6865 203a 7265 663a 606e 6f64 6573 203c  he :ref:`nodes <
+0002cfe0: 7365 635f 6e6f 6465 5f74 6162 6c65 5f64  sec_node_table_d
+0002cff0: 6566 696e 6974 696f 6e3e 600a 2020 2020  efinition>`.    
+0002d000: 2020 2020 696e 2074 6869 7320 7472 6565      in this tree
+0002d010: 2073 6571 7565 6e63 652e 0a0a 2020 2020   sequence...    
+0002d020: 2020 2020 2e2e 206e 6f74 653a 3a20 416c      .. note:: Al
+0002d030: 7468 6f75 6768 206e 6f64 6520 6964 7320  though node ids 
+0002d040: 6172 6520 636f 6d6d 6f6e 6c79 206f 7264  are commonly ord
+0002d050: 6572 6564 2062 7920 6e6f 6465 2074 696d  ered by node tim
+0002d060: 652c 2074 6869 7320 6973 206e 6f74 2061  e, this is not a
+0002d070: 0a20 2020 2020 2020 2020 2020 2066 6f72  .            for
+0002d080: 6d61 6c20 7472 6565 2073 6571 7565 6e63  mal tree sequenc
+0002d090: 6520 7265 7175 6972 656d 656e 742e 2049  e requirement. I
+0002d0a0: 6620 796f 7520 7769 7368 2074 6f20 6974  f you wish to it
+0002d0b0: 6572 6174 6520 6f76 6572 206e 6f64 6573  erate over nodes
+0002d0c0: 2069 6e0a 2020 2020 2020 2020 2020 2020   in.            
+0002d0d0: 7469 6d65 206f 7264 6572 2c20 796f 7520  time order, you 
+0002d0e0: 7368 6f75 6c64 2074 6865 7265 666f 7265  should therefore
+0002d0f0: 2075 7365 2060 606f 7264 6572 3d22 7469   use ``order="ti
+0002d100: 6d65 6173 6322 6060 2028 616e 6420 7772  measc"`` (and wr
+0002d110: 6170 2074 6865 0a20 2020 2020 2020 2020  ap the.         
+0002d120: 2020 2072 6573 756c 7469 6e67 2073 6571     resulting seq
+0002d130: 7565 6e63 6520 696e 2074 6865 2073 7461  uence in the sta
+0002d140: 6e64 6172 6420 5079 7468 6f6e 203a 6675  ndard Python :fu
+0002d150: 6e63 3a60 7079 7468 6f6e 3a72 6576 6572  nc:`python:rever
+0002d160: 7365 6460 2066 756e 6374 696f 6e0a 2020  sed` function.  
+0002d170: 2020 2020 2020 2020 2020 6966 2079 6f75            if you
+0002d180: 2077 6973 6820 746f 2069 7465 7261 7465   wish to iterate
+0002d190: 206f 7665 7220 6f6c 6465 7220 6e6f 6465   over older node
+0002d1a0: 7320 6265 666f 7265 2079 6f75 6e67 6572  s before younger
+0002d1b0: 206f 6e65 7329 0a0a 2020 2020 2020 2020   ones)..        
+0002d1c0: 3a70 6172 616d 2073 7472 206f 7264 6572  :param str order
+0002d1d0: 3a20 5468 6520 6f72 6465 7220 696e 2077  : The order in w
+0002d1e0: 6869 6368 2074 6865 206e 6f64 6573 2073  hich the nodes s
+0002d1f0: 686f 756c 6420 6265 2072 6574 7572 6e65  hould be returne
+0002d200: 643a 206d 7573 7420 6265 0a20 2020 2020  d: must be.     
+0002d210: 2020 2020 2020 206f 6e65 206f 6620 2269         one of "i
+0002d220: 6422 2028 6465 6661 756c 7429 206f 7220  d" (default) or 
+0002d230: 2274 696d 6561 7363 2220 2861 7363 656e  "timeasc" (ascen
+0002d240: 6469 6e67 206f 7264 6572 206f 6620 7469  ding order of ti
+0002d250: 6d65 2c20 7468 656e 2062 790a 2020 2020  me, then by.    
+0002d260: 2020 2020 2020 2020 6173 6365 6e64 696e          ascendin
+0002d270: 6720 6e6f 6465 2069 642c 206d 6174 6368  g node id, match
+0002d280: 696e 6720 7468 6520 6669 7273 7420 7477  ing the first tw
+0002d290: 6f20 6f72 6465 7269 6e67 2072 6571 7569  o ordering requi
+0002d2a0: 7265 6d65 6e74 7320 6f66 0a20 2020 2020  rements of.     
+0002d2b0: 2020 2020 2020 2070 6172 656e 7420 6e6f         parent no
+0002d2c0: 6465 7320 696e 2061 203a 6d65 7468 3a60  des in a :meth:`
+0002d2d0: 736f 7274 6564 203c 5461 626c 6543 6f6c  sorted <TableCol
+0002d2e0: 6c65 6374 696f 6e2e 736f 7274 3e60 2065  lection.sort>` e
+0002d2f0: 6467 6520 7461 626c 6529 2e0a 2020 2020  dge table)..    
+0002d300: 2020 2020 3a72 6574 7572 6e3a 2041 6e20      :return: An 
+0002d310: 6974 6572 6162 6c65 2073 6571 7565 6e63  iterable sequenc
+0002d320: 6520 6f66 2061 6c6c 206e 6f64 6573 2e0a  e of all nodes..
+0002d330: 2020 2020 2020 2020 3a72 7479 7065 3a20          :rtype: 
+0002d340: 5365 7175 656e 6365 283a 636c 6173 733a  Sequence(:class:
+0002d350: 602e 4e6f 6465 6029 0a20 2020 2020 2020  `.Node`).       
+0002d360: 2022 2222 0a20 2020 2020 2020 206f 7264   """.        ord
+0002d370: 6572 203d 2022 6964 2220 6966 206f 7264  er = "id" if ord
+0002d380: 6572 2069 7320 4e6f 6e65 2065 6c73 6520  er is None else 
+0002d390: 6f72 6465 720a 2020 2020 2020 2020 6966  order.        if
+0002d3a0: 206f 7264 6572 206e 6f74 2069 6e20 5b22   order not in ["
+0002d3b0: 6964 222c 2022 7469 6d65 6173 6322 5d3a  id", "timeasc"]:
+0002d3c0: 0a20 2020 2020 2020 2020 2020 2072 6169  .            rai
+0002d3d0: 7365 2056 616c 7565 4572 726f 7228 276f  se ValueError('o
+0002d3e0: 7264 6572 206d 7573 7420 6265 2022 6964  rder must be "id
+0002d3f0: 2220 6f72 2022 7469 6d65 6173 6322 2729  " or "timeasc"')
+0002d400: 0a20 2020 2020 2020 206f 6472 203d 204e  .        odr = N
+0002d410: 6f6e 650a 2020 2020 2020 2020 6966 206f  one.        if o
+0002d420: 7264 6572 203d 3d20 2274 696d 6561 7363  rder == "timeasc
+0002d430: 223a 0a20 2020 2020 2020 2020 2020 206f  ":.            o
+0002d440: 6472 203d 206e 702e 6c65 7873 6f72 7428  dr = np.lexsort(
+0002d450: 286e 702e 6172 616e 6765 2873 656c 662e  (np.arange(self.
+0002d460: 6e75 6d5f 6e6f 6465 7329 2c20 7365 6c66  num_nodes), self
+0002d470: 2e6e 6f64 6573 5f74 696d 6529 290a 2020  .nodes_time)).  
+0002d480: 2020 2020 2020 7265 7475 726e 2053 696d        return Sim
+0002d490: 706c 6543 6f6e 7461 696e 6572 5365 7175  pleContainerSequ
+0002d4a0: 656e 6365 2873 656c 662e 6e6f 6465 2c20  ence(self.node, 
+0002d4b0: 7365 6c66 2e6e 756d 5f6e 6f64 6573 2c20  self.num_nodes, 
+0002d4c0: 6f72 6465 723d 6f64 7229 0a0a 2020 2020  order=odr)..    
+0002d4d0: 6465 6620 6564 6765 7328 7365 6c66 293a  def edges(self):
+0002d4e0: 0a20 2020 2020 2020 2022 2222 0a20 2020  .        """.   
+0002d4f0: 2020 2020 2052 6574 7572 6e73 2061 6e20       Returns an 
+0002d500: 6974 6572 6162 6c65 2073 6571 7565 6e63  iterable sequenc
+0002d510: 6520 6f66 2061 6c6c 2074 6865 203a 7265  e of all the :re
+0002d520: 663a 6065 6467 6573 203c 7365 635f 6564  f:`edges <sec_ed
+0002d530: 6765 5f74 6162 6c65 5f64 6566 696e 6974  ge_table_definit
+0002d540: 696f 6e3e 600a 2020 2020 2020 2020 696e  ion>`.        in
+0002d550: 2074 6869 7320 7472 6565 2073 6571 7565   this tree seque
+0002d560: 6e63 652e 2045 6467 6573 2061 7265 2072  nce. Edges are r
+0002d570: 6574 7572 6e65 6420 696e 2074 6865 206f  eturned in the o
+0002d580: 7264 6572 2072 6571 7569 7265 640a 2020  rder required.  
+0002d590: 2020 2020 2020 666f 7220 6120 3a72 6566        for a :ref
+0002d5a0: 3a60 7661 6c69 6420 7472 6565 2073 6571  :`valid tree seq
+0002d5b0: 7565 6e63 6520 3c73 6563 5f76 616c 6964  uence <sec_valid
+0002d5c0: 5f74 7265 655f 7365 7175 656e 6365 5f72  _tree_sequence_r
+0002d5d0: 6571 7569 7265 6d65 6e74 733e 602e 2053  equirements>`. S
+0002d5e0: 6f2c 0a20 2020 2020 2020 2065 6467 6573  o,.        edges
+0002d5f0: 2061 7265 2067 7561 7261 6e74 6565 6420   are guaranteed 
+0002d600: 746f 2062 6520 6f72 6465 7265 6420 7375  to be ordered su
+0002d610: 6368 2074 6861 7420 2861 2920 616c 6c20  ch that (a) all 
+0002d620: 7061 7265 6e74 7320 7769 7468 2061 0a20  parents with a. 
+0002d630: 2020 2020 2020 2067 6976 656e 2049 4420         given ID 
+0002d640: 6172 6520 636f 6e74 6967 756f 7573 3b20  are contiguous; 
+0002d650: 2862 2920 6564 6765 7320 6172 6520 7265  (b) edges are re
+0002d660: 7475 726e 6564 2069 6e20 6e6f 6e2d 6465  turned in non-de
+0002d670: 6372 6561 7369 6e67 0a20 2020 2020 2020  creasing.       
+0002d680: 206f 7264 6572 206f 6620 7061 7265 6e74   order of parent
+0002d690: 2074 696d 6520 6167 6f3b 2028 6329 2077   time ago; (c) w
+0002d6a0: 6974 6869 6e20 7468 6520 6564 6765 7320  ithin the edges 
+0002d6b0: 666f 7220 6120 6769 7665 6e20 7061 7265  for a given pare
+0002d6c0: 6e74 2c20 6564 6765 730a 2020 2020 2020  nt, edges.      
+0002d6d0: 2020 6172 6520 736f 7274 6564 2066 6972    are sorted fir
+0002d6e0: 7374 2062 7920 6368 696c 6420 4944 2061  st by child ID a
+0002d6f0: 6e64 2074 6865 6e20 6279 206c 6566 7420  nd then by left 
+0002d700: 636f 6f72 6469 6e61 7465 2e0a 0a20 2020  coordinate...   
+0002d710: 2020 2020 203a 7265 7475 726e 3a20 416e       :return: An
+0002d720: 2069 7465 7261 626c 6520 7365 7175 656e   iterable sequen
+0002d730: 6365 206f 6620 616c 6c20 6564 6765 732e  ce of all edges.
+0002d740: 0a20 2020 2020 2020 203a 7274 7970 653a  .        :rtype:
+0002d750: 2053 6571 7565 6e63 6528 3a63 6c61 7373   Sequence(:class
+0002d760: 3a60 2e45 6467 6560 290a 2020 2020 2020  :`.Edge`).      
+0002d770: 2020 2222 220a 2020 2020 2020 2020 7265    """.        re
+0002d780: 7475 726e 2053 696d 706c 6543 6f6e 7461  turn SimpleConta
+0002d790: 696e 6572 5365 7175 656e 6365 2873 656c  inerSequence(sel
+0002d7a0: 662e 6564 6765 2c20 7365 6c66 2e6e 756d  f.edge, self.num
+0002d7b0: 5f65 6467 6573 290a 0a20 2020 2064 6566  _edges)..    def
+0002d7c0: 2065 6467 6573 6574 7328 7365 6c66 293a   edgesets(self):
+0002d7d0: 0a20 2020 2020 2020 2023 2054 4f44 4f20  .        # TODO 
+0002d7e0: 7468 6520 6f72 6465 7220 7468 6174 2074  the order that t
+0002d7f0: 6865 7365 2072 6563 6f72 6473 2061 7265  hese records are
+0002d800: 2072 6574 7572 6e65 6420 696e 2069 7320   returned in is 
+0002d810: 6e6f 7420 7765 6c6c 2073 7065 6369 6669  not well specifi
+0002d820: 6564 2e0a 2020 2020 2020 2020 2320 486f  ed..        # Ho
+0002d830: 7065 6675 6c6c 7920 7468 6973 2064 6f65  pefully this doe
+0002d840: 7320 6e6f 7420 6d61 7474 6572 2c20 616e  s not matter, an
+0002d850: 6420 7765 2063 616e 206a 7573 7420 7374  d we can just st
+0002d860: 6174 6520 7468 6174 2074 6865 206f 7264  ate that the ord
+0002d870: 6572 696e 670a 2020 2020 2020 2020 2320  ering.        # 
+0002d880: 7368 6f75 6c64 206e 6f74 2062 6520 6465  should not be de
+0002d890: 7065 6e64 6564 206f 6e2e 0a20 2020 2020  pended on..     
+0002d8a0: 2020 2063 6869 6c64 7265 6e20 3d20 636f     children = co
+0002d8b0: 6c6c 6563 7469 6f6e 732e 6465 6661 756c  llections.defaul
+0002d8c0: 7464 6963 7428 7365 7429 0a20 2020 2020  tdict(set).     
+0002d8d0: 2020 2061 6374 6976 655f 6564 6765 7365     active_edgese
+0002d8e0: 7473 203d 207b 7d0a 2020 2020 2020 2020  ts = {}.        
+0002d8f0: 666f 7220 286c 6566 742c 2072 6967 6874  for (left, right
+0002d900: 292c 2065 6467 6573 5f6f 7574 2c20 6564  ), edges_out, ed
+0002d910: 6765 735f 696e 2069 6e20 7365 6c66 2e65  ges_in in self.e
+0002d920: 6467 655f 6469 6666 7328 293a 0a20 2020  dge_diffs():.   
+0002d930: 2020 2020 2020 2020 2023 2043 6f6d 706c           # Compl
+0002d940: 6574 6520 616e 6420 7265 7475 726e 2061  ete and return a
+0002d950: 6e79 2065 6467 6573 6574 7320 7468 6174  ny edgesets that
+0002d960: 2061 7265 2061 6666 6563 7465 6420 6279   are affected by
+0002d970: 2074 6869 7320 7472 6565 0a20 2020 2020   this tree.     
+0002d980: 2020 2020 2020 2023 2074 7261 6e73 6974         # transit
+0002d990: 696f 6e0a 2020 2020 2020 2020 2020 2020  ion.            
+0002d9a0: 7061 7265 6e74 7320 3d20 6974 6572 2865  parents = iter(e
+0002d9b0: 6467 652e 7061 7265 6e74 2066 6f72 2065  dge.parent for e
+0002d9c0: 6467 6520 696e 2069 7465 7274 6f6f 6c73  dge in itertools
+0002d9d0: 2e63 6861 696e 2865 6467 6573 5f6f 7574  .chain(edges_out
+0002d9e0: 2c20 6564 6765 735f 696e 2929 0a20 2020  , edges_in)).   
+0002d9f0: 2020 2020 2020 2020 2066 6f72 2070 6172           for par
+0002da00: 656e 7420 696e 2070 6172 656e 7473 3a0a  ent in parents:.
+0002da10: 2020 2020 2020 2020 2020 2020 2020 2020                  
+0002da20: 6966 2070 6172 656e 7420 696e 2061 6374  if parent in act
+0002da30: 6976 655f 6564 6765 7365 7473 3a0a 2020  ive_edgesets:.  
 0002da40: 2020 2020 2020 2020 2020 2020 2020 2020                  
-0002da50: 2065 6467 6573 6574 2e72 6967 6874 203d   edgeset.right =
-0002da60: 206c 6566 740a 2020 2020 2020 2020 2020   left.          
-0002da70: 2020 2020 2020 2020 2020 6564 6765 7365            edgese
-0002da80: 742e 6368 696c 6472 656e 203d 2073 6f72  t.children = sor
-0002da90: 7465 6428 6368 696c 6472 656e 5b70 6172  ted(children[par
-0002daa0: 656e 745d 290a 2020 2020 2020 2020 2020  ent]).          
-0002dab0: 2020 2020 2020 2020 2020 7969 656c 6420            yield 
-0002dac0: 6564 6765 7365 740a 2020 2020 2020 2020  edgeset.        
-0002dad0: 2020 2020 666f 7220 6564 6765 2069 6e20      for edge in 
-0002dae0: 6564 6765 735f 6f75 743a 0a20 2020 2020  edges_out:.     
-0002daf0: 2020 2020 2020 2020 2020 2063 6869 6c64             child
-0002db00: 7265 6e5b 6564 6765 2e70 6172 656e 745d  ren[edge.parent]
-0002db10: 2e72 656d 6f76 6528 6564 6765 2e63 6869  .remove(edge.chi
-0002db20: 6c64 290a 2020 2020 2020 2020 2020 2020  ld).            
-0002db30: 666f 7220 6564 6765 2069 6e20 6564 6765  for edge in edge
-0002db40: 735f 696e 3a0a 2020 2020 2020 2020 2020  s_in:.          
-0002db50: 2020 2020 2020 6368 696c 6472 656e 5b65        children[e
-0002db60: 6467 652e 7061 7265 6e74 5d2e 6164 6428  dge.parent].add(
-0002db70: 6564 6765 2e63 6869 6c64 290a 2020 2020  edge.child).    
-0002db80: 2020 2020 2020 2020 2320 5570 6461 7465          # Update
-0002db90: 2074 6865 2061 6374 6976 6520 6564 6765   the active edge
-0002dba0: 7365 7473 0a20 2020 2020 2020 2020 2020  sets.           
-0002dbb0: 2066 6f72 2065 6467 6520 696e 2069 7465   for edge in ite
-0002dbc0: 7274 6f6f 6c73 2e63 6861 696e 2865 6467  rtools.chain(edg
-0002dbd0: 6573 5f6f 7574 2c20 6564 6765 735f 696e  es_out, edges_in
-0002dbe0: 293a 0a20 2020 2020 2020 2020 2020 2020  ):.             
-0002dbf0: 2020 2069 6620 280a 2020 2020 2020 2020     if (.        
-0002dc00: 2020 2020 2020 2020 2020 2020 6c65 6e28              len(
-0002dc10: 6368 696c 6472 656e 5b65 6467 652e 7061  children[edge.pa
-0002dc20: 7265 6e74 5d29 203e 2030 0a20 2020 2020  rent]) > 0.     
-0002dc30: 2020 2020 2020 2020 2020 2020 2020 2061                 a
-0002dc40: 6e64 2065 6467 652e 7061 7265 6e74 206e  nd edge.parent n
-0002dc50: 6f74 2069 6e20 6163 7469 7665 5f65 6467  ot in active_edg
-0002dc60: 6573 6574 730a 2020 2020 2020 2020 2020  esets.          
-0002dc70: 2020 2020 2020 293a 0a20 2020 2020 2020        ):.       
-0002dc80: 2020 2020 2020 2020 2020 2020 2061 6374               act
-0002dc90: 6976 655f 6564 6765 7365 7473 5b65 6467  ive_edgesets[edg
-0002dca0: 652e 7061 7265 6e74 5d20 3d20 4564 6765  e.parent] = Edge
-0002dcb0: 7365 7428 6c65 6674 2c20 7269 6768 742c  set(left, right,
-0002dcc0: 2065 6467 652e 7061 7265 6e74 2c20 5b5d   edge.parent, []
-0002dcd0: 290a 0a20 2020 2020 2020 2066 6f72 2070  )..        for p
-0002dce0: 6172 656e 7420 696e 2061 6374 6976 655f  arent in active_
-0002dcf0: 6564 6765 7365 7473 2e6b 6579 7328 293a  edgesets.keys():
-0002dd00: 0a20 2020 2020 2020 2020 2020 2065 6467  .            edg
-0002dd10: 6573 6574 203d 2061 6374 6976 655f 6564  eset = active_ed
-0002dd20: 6765 7365 7473 5b70 6172 656e 745d 0a20  gesets[parent]. 
-0002dd30: 2020 2020 2020 2020 2020 2065 6467 6573             edges
-0002dd40: 6574 2e72 6967 6874 203d 2073 656c 662e  et.right = self.
-0002dd50: 7365 7175 656e 6365 5f6c 656e 6774 680a  sequence_length.
-0002dd60: 2020 2020 2020 2020 2020 2020 6564 6765              edge
-0002dd70: 7365 742e 6368 696c 6472 656e 203d 2073  set.children = s
-0002dd80: 6f72 7465 6428 6368 696c 6472 656e 5b65  orted(children[e
-0002dd90: 6467 6573 6574 2e70 6172 656e 745d 290a  dgeset.parent]).
-0002dda0: 2020 2020 2020 2020 2020 2020 7969 656c              yiel
-0002ddb0: 6420 6564 6765 7365 740a 0a20 2020 2064  d edgeset..    d
-0002ddc0: 6566 205f 6564 6765 5f64 6966 6673 5f66  ef _edge_diffs_f
-0002ddd0: 6f72 7761 7264 2873 656c 662c 2069 6e63  orward(self, inc
-0002dde0: 6c75 6465 5f74 6572 6d69 6e61 6c3d 4661  lude_terminal=Fa
-0002ddf0: 6c73 6529 3a0a 2020 2020 2020 2020 6d65  lse):.        me
-0002de00: 7461 6461 7461 5f64 6563 6f64 6572 203d  tadata_decoder =
-0002de10: 2073 656c 662e 7461 626c 655f 6d65 7461   self.table_meta
-0002de20: 6461 7461 5f73 6368 656d 6173 2e65 6467  data_schemas.edg
-0002de30: 652e 6465 636f 6465 5f72 6f77 0a20 2020  e.decode_row.   
-0002de40: 2020 2020 2065 6467 655f 6c65 6674 203d       edge_left =
-0002de50: 2073 656c 662e 6564 6765 735f 6c65 6674   self.edges_left
-0002de60: 0a20 2020 2020 2020 2065 6467 655f 7269  .        edge_ri
-0002de70: 6768 7420 3d20 7365 6c66 2e65 6467 6573  ght = self.edges
-0002de80: 5f72 6967 6874 0a20 2020 2020 2020 2073  _right.        s
-0002de90: 6571 7565 6e63 655f 6c65 6e67 7468 203d  equence_length =
-0002dea0: 2073 656c 662e 7365 7175 656e 6365 5f6c   self.sequence_l
-0002deb0: 656e 6774 680a 2020 2020 2020 2020 696e  ength.        in
-0002dec0: 5f6f 7264 6572 203d 2073 656c 662e 696e  _order = self.in
-0002ded0: 6465 7865 735f 6564 6765 5f69 6e73 6572  dexes_edge_inser
-0002dee0: 7469 6f6e 5f6f 7264 6572 0a20 2020 2020  tion_order.     
-0002def0: 2020 206f 7574 5f6f 7264 6572 203d 2073     out_order = s
-0002df00: 656c 662e 696e 6465 7865 735f 6564 6765  elf.indexes_edge
-0002df10: 5f72 656d 6f76 616c 5f6f 7264 6572 0a20  _removal_order. 
-0002df20: 2020 2020 2020 204d 203d 2073 656c 662e         M = self.
-0002df30: 6e75 6d5f 6564 6765 730a 2020 2020 2020  num_edges.      
-0002df40: 2020 6a20 3d20 300a 2020 2020 2020 2020    j = 0.        
-0002df50: 6b20 3d20 300a 2020 2020 2020 2020 6c65  k = 0.        le
-0002df60: 6674 203d 2030 2e30 0a20 2020 2020 2020  ft = 0.0.       
-0002df70: 2077 6869 6c65 206a 203c 204d 206f 7220   while j < M or 
-0002df80: 6c65 6674 203c 2073 6571 7565 6e63 655f  left < sequence_
-0002df90: 6c65 6e67 7468 3a0a 2020 2020 2020 2020  length:.        
-0002dfa0: 2020 2020 6564 6765 735f 6f75 7420 3d20      edges_out = 
-0002dfb0: 5b5d 0a20 2020 2020 2020 2020 2020 2065  [].            e
-0002dfc0: 6467 6573 5f69 6e20 3d20 5b5d 0a20 2020  dges_in = [].   
-0002dfd0: 2020 2020 2020 2020 2077 6869 6c65 206b           while k
-0002dfe0: 203c 204d 2061 6e64 2065 6467 655f 7269   < M and edge_ri
-0002dff0: 6768 745b 6f75 745f 6f72 6465 725b 6b5d  ght[out_order[k]
-0002e000: 5d20 3d3d 206c 6566 743a 0a20 2020 2020  ] == left:.     
-0002e010: 2020 2020 2020 2020 2020 2065 6467 6573             edges
-0002e020: 5f6f 7574 2e61 7070 656e 6428 0a20 2020  _out.append(.   
-0002e030: 2020 2020 2020 2020 2020 2020 2020 2020                  
-0002e040: 2045 6467 6528 0a20 2020 2020 2020 2020   Edge(.         
-0002e050: 2020 2020 2020 2020 2020 2020 2020 202a                 *
-0002e060: 7365 6c66 2e5f 6c6c 5f74 7265 655f 7365  self._ll_tree_se
-0002e070: 7175 656e 6365 2e67 6574 5f65 6467 6528  quence.get_edge(
-0002e080: 6f75 745f 6f72 6465 725b 6b5d 292c 0a20  out_order[k]),. 
-0002e090: 2020 2020 2020 2020 2020 2020 2020 2020                  
-0002e0a0: 2020 2020 2020 2069 643d 6f75 745f 6f72         id=out_or
-0002e0b0: 6465 725b 6b5d 2c0a 2020 2020 2020 2020  der[k],.        
-0002e0c0: 2020 2020 2020 2020 2020 2020 2020 2020                  
-0002e0d0: 6d65 7461 6461 7461 5f64 6563 6f64 6572  metadata_decoder
-0002e0e0: 3d6d 6574 6164 6174 615f 6465 636f 6465  =metadata_decode
-0002e0f0: 722c 0a20 2020 2020 2020 2020 2020 2020  r,.             
-0002e100: 2020 2020 2020 2029 0a20 2020 2020 2020         ).       
-0002e110: 2020 2020 2020 2020 2029 0a20 2020 2020           ).     
-0002e120: 2020 2020 2020 2020 2020 206b 202b 3d20             k += 
-0002e130: 310a 2020 2020 2020 2020 2020 2020 7768  1.            wh
-0002e140: 696c 6520 6a20 3c20 4d20 616e 6420 6564  ile j < M and ed
-0002e150: 6765 5f6c 6566 745b 696e 5f6f 7264 6572  ge_left[in_order
-0002e160: 5b6a 5d5d 203d 3d20 6c65 6674 3a0a 2020  [j]] == left:.  
-0002e170: 2020 2020 2020 2020 2020 2020 2020 6564                ed
-0002e180: 6765 735f 696e 2e61 7070 656e 6428 0a20  ges_in.append(. 
-0002e190: 2020 2020 2020 2020 2020 2020 2020 2020                  
-0002e1a0: 2020 2045 6467 6528 0a20 2020 2020 2020     Edge(.       
-0002e1b0: 2020 2020 2020 2020 2020 2020 2020 2020                  
-0002e1c0: 202a 7365 6c66 2e5f 6c6c 5f74 7265 655f   *self._ll_tree_
-0002e1d0: 7365 7175 656e 6365 2e67 6574 5f65 6467  sequence.get_edg
-0002e1e0: 6528 696e 5f6f 7264 6572 5b6a 5d29 2c0a  e(in_order[j]),.
-0002e1f0: 2020 2020 2020 2020 2020 2020 2020 2020                  
-0002e200: 2020 2020 2020 2020 6964 3d69 6e5f 6f72          id=in_or
-0002e210: 6465 725b 6a5d 2c0a 2020 2020 2020 2020  der[j],.        
-0002e220: 2020 2020 2020 2020 2020 2020 2020 2020                  
-0002e230: 6d65 7461 6461 7461 5f64 6563 6f64 6572  metadata_decoder
-0002e240: 3d6d 6574 6164 6174 615f 6465 636f 6465  =metadata_decode
-0002e250: 722c 0a20 2020 2020 2020 2020 2020 2020  r,.             
-0002e260: 2020 2020 2020 2029 0a20 2020 2020 2020         ).       
-0002e270: 2020 2020 2020 2020 2029 0a20 2020 2020           ).     
-0002e280: 2020 2020 2020 2020 2020 206a 202b 3d20             j += 
-0002e290: 310a 2020 2020 2020 2020 2020 2020 7269  1.            ri
-0002e2a0: 6768 7420 3d20 7365 7175 656e 6365 5f6c  ght = sequence_l
-0002e2b0: 656e 6774 680a 2020 2020 2020 2020 2020  ength.          
-0002e2c0: 2020 6966 206a 203c 204d 3a0a 2020 2020    if j < M:.    
-0002e2d0: 2020 2020 2020 2020 2020 2020 7269 6768              righ
-0002e2e0: 7420 3d20 6d69 6e28 7269 6768 742c 2065  t = min(right, e
-0002e2f0: 6467 655f 6c65 6674 5b69 6e5f 6f72 6465  dge_left[in_orde
-0002e300: 725b 6a5d 5d29 0a20 2020 2020 2020 2020  r[j]]).         
-0002e310: 2020 2069 6620 6b20 3c20 4d3a 0a20 2020     if k < M:.   
-0002e320: 2020 2020 2020 2020 2020 2020 2072 6967               rig
-0002e330: 6874 203d 206d 696e 2872 6967 6874 2c20  ht = min(right, 
-0002e340: 6564 6765 5f72 6967 6874 5b6f 7574 5f6f  edge_right[out_o
-0002e350: 7264 6572 5b6b 5d5d 290a 2020 2020 2020  rder[k]]).      
-0002e360: 2020 2020 2020 7969 656c 6420 4564 6765        yield Edge
-0002e370: 4469 6666 2849 6e74 6572 7661 6c28 6c65  Diff(Interval(le
-0002e380: 6674 2c20 7269 6768 7429 2c20 6564 6765  ft, right), edge
-0002e390: 735f 6f75 742c 2065 6467 6573 5f69 6e29  s_out, edges_in)
-0002e3a0: 0a20 2020 2020 2020 2020 2020 206c 6566  .            lef
-0002e3b0: 7420 3d20 7269 6768 740a 0a20 2020 2020  t = right..     
-0002e3c0: 2020 2069 6620 696e 636c 7564 655f 7465     if include_te
-0002e3d0: 726d 696e 616c 3a0a 2020 2020 2020 2020  rminal:.        
-0002e3e0: 2020 2020 6564 6765 735f 6f75 7420 3d20      edges_out = 
-0002e3f0: 5b5d 0a20 2020 2020 2020 2020 2020 2077  [].            w
-0002e400: 6869 6c65 206b 203c 204d 3a0a 2020 2020  hile k < M:.    
-0002e410: 2020 2020 2020 2020 2020 2020 6564 6765              edge
-0002e420: 735f 6f75 742e 6170 7065 6e64 280a 2020  s_out.append(.  
-0002e430: 2020 2020 2020 2020 2020 2020 2020 2020                  
-0002e440: 2020 4564 6765 280a 2020 2020 2020 2020    Edge(.        
-0002e450: 2020 2020 2020 2020 2020 2020 2020 2020                  
-0002e460: 2a73 656c 662e 5f6c 6c5f 7472 6565 5f73  *self._ll_tree_s
-0002e470: 6571 7565 6e63 652e 6765 745f 6564 6765  equence.get_edge
-0002e480: 286f 7574 5f6f 7264 6572 5b6b 5d29 2c0a  (out_order[k]),.
-0002e490: 2020 2020 2020 2020 2020 2020 2020 2020                  
-0002e4a0: 2020 2020 2020 2020 6964 3d6f 7574 5f6f          id=out_o
-0002e4b0: 7264 6572 5b6b 5d2c 0a20 2020 2020 2020  rder[k],.       
-0002e4c0: 2020 2020 2020 2020 2020 2020 2020 2020                  
-0002e4d0: 206d 6574 6164 6174 615f 6465 636f 6465   metadata_decode
-0002e4e0: 723d 6d65 7461 6461 7461 5f64 6563 6f64  r=metadata_decod
-0002e4f0: 6572 2c0a 2020 2020 2020 2020 2020 2020  er,.            
-0002e500: 2020 2020 2020 2020 290a 2020 2020 2020          ).      
-0002e510: 2020 2020 2020 2020 2020 290a 2020 2020            ).    
-0002e520: 2020 2020 2020 2020 2020 2020 6b20 2b3d              k +=
-0002e530: 2031 0a20 2020 2020 2020 2020 2020 2079   1.            y
-0002e540: 6965 6c64 2045 6467 6544 6966 6628 496e  ield EdgeDiff(In
-0002e550: 7465 7276 616c 286c 6566 742c 2072 6967  terval(left, rig
-0002e560: 6874 292c 2065 6467 6573 5f6f 7574 2c20  ht), edges_out, 
-0002e570: 5b5d 290a 0a20 2020 2064 6566 205f 6564  [])..    def _ed
-0002e580: 6765 5f64 6966 6673 5f72 6576 6572 7365  ge_diffs_reverse
-0002e590: 2873 656c 662c 2069 6e63 6c75 6465 5f74  (self, include_t
-0002e5a0: 6572 6d69 6e61 6c3d 4661 6c73 6529 3a0a  erminal=False):.
-0002e5b0: 2020 2020 2020 2020 6d65 7461 6461 7461          metadata
-0002e5c0: 5f64 6563 6f64 6572 203d 2073 656c 662e  _decoder = self.
-0002e5d0: 7461 626c 655f 6d65 7461 6461 7461 5f73  table_metadata_s
-0002e5e0: 6368 656d 6173 2e65 6467 652e 6465 636f  chemas.edge.deco
-0002e5f0: 6465 5f72 6f77 0a20 2020 2020 2020 2065  de_row.        e
-0002e600: 6467 655f 6c65 6674 203d 2073 656c 662e  dge_left = self.
-0002e610: 6564 6765 735f 6c65 6674 0a20 2020 2020  edges_left.     
-0002e620: 2020 2065 6467 655f 7269 6768 7420 3d20     edge_right = 
-0002e630: 7365 6c66 2e65 6467 6573 5f72 6967 6874  self.edges_right
-0002e640: 0a20 2020 2020 2020 2073 6571 7565 6e63  .        sequenc
-0002e650: 655f 6c65 6e67 7468 203d 2073 656c 662e  e_length = self.
-0002e660: 7365 7175 656e 6365 5f6c 656e 6774 680a  sequence_length.
-0002e670: 2020 2020 2020 2020 696e 5f6f 7264 6572          in_order
-0002e680: 203d 2073 656c 662e 696e 6465 7865 735f   = self.indexes_
-0002e690: 6564 6765 5f72 656d 6f76 616c 5f6f 7264  edge_removal_ord
-0002e6a0: 6572 0a20 2020 2020 2020 206f 7574 5f6f  er.        out_o
-0002e6b0: 7264 6572 203d 2073 656c 662e 696e 6465  rder = self.inde
-0002e6c0: 7865 735f 6564 6765 5f69 6e73 6572 7469  xes_edge_inserti
-0002e6d0: 6f6e 5f6f 7264 6572 0a20 2020 2020 2020  on_order.       
-0002e6e0: 204d 203d 2073 656c 662e 6e75 6d5f 6564   M = self.num_ed
-0002e6f0: 6765 730a 2020 2020 2020 2020 6a20 3d20  ges.        j = 
-0002e700: 4d20 2d20 310a 2020 2020 2020 2020 6b20  M - 1.        k 
-0002e710: 3d20 4d20 2d20 310a 2020 2020 2020 2020  = M - 1.        
-0002e720: 7269 6768 7420 3d20 7365 7175 656e 6365  right = sequence
-0002e730: 5f6c 656e 6774 680a 2020 2020 2020 2020  _length.        
-0002e740: 7768 696c 6520 6a20 3e3d 2030 206f 7220  while j >= 0 or 
-0002e750: 7269 6768 7420 3e20 303a 0a20 2020 2020  right > 0:.     
-0002e760: 2020 2020 2020 2065 6467 6573 5f6f 7574         edges_out
-0002e770: 203d 205b 5d0a 2020 2020 2020 2020 2020   = [].          
-0002e780: 2020 6564 6765 735f 696e 203d 205b 5d0a    edges_in = [].
-0002e790: 2020 2020 2020 2020 2020 2020 7768 696c              whil
-0002e7a0: 6520 6b20 3e3d 2030 2061 6e64 2065 6467  e k >= 0 and edg
-0002e7b0: 655f 6c65 6674 5b6f 7574 5f6f 7264 6572  e_left[out_order
-0002e7c0: 5b6b 5d5d 203d 3d20 7269 6768 743a 0a20  [k]] == right:. 
-0002e7d0: 2020 2020 2020 2020 2020 2020 2020 2065                 e
-0002e7e0: 6467 6573 5f6f 7574 2e61 7070 656e 6428  dges_out.append(
-0002e7f0: 0a20 2020 2020 2020 2020 2020 2020 2020  .               
-0002e800: 2020 2020 2045 6467 6528 0a20 2020 2020       Edge(.     
-0002e810: 2020 2020 2020 2020 2020 2020 2020 2020                  
-0002e820: 2020 202a 7365 6c66 2e5f 6c6c 5f74 7265     *self._ll_tre
-0002e830: 655f 7365 7175 656e 6365 2e67 6574 5f65  e_sequence.get_e
-0002e840: 6467 6528 6f75 745f 6f72 6465 725b 6b5d  dge(out_order[k]
-0002e850: 292c 0a20 2020 2020 2020 2020 2020 2020  ),.             
-0002e860: 2020 2020 2020 2020 2020 2069 643d 6f75             id=ou
-0002e870: 745f 6f72 6465 725b 6b5d 2c0a 2020 2020  t_order[k],.    
-0002e880: 2020 2020 2020 2020 2020 2020 2020 2020                  
-0002e890: 2020 2020 6d65 7461 6461 7461 5f64 6563      metadata_dec
-0002e8a0: 6f64 6572 3d6d 6574 6164 6174 615f 6465  oder=metadata_de
-0002e8b0: 636f 6465 722c 0a20 2020 2020 2020 2020  coder,.         
-0002e8c0: 2020 2020 2020 2020 2020 2029 0a20 2020             ).   
-0002e8d0: 2020 2020 2020 2020 2020 2020 2029 0a20               ). 
-0002e8e0: 2020 2020 2020 2020 2020 2020 2020 206b                 k
-0002e8f0: 202d 3d20 310a 2020 2020 2020 2020 2020   -= 1.          
-0002e900: 2020 7768 696c 6520 6a20 3e3d 2030 2061    while j >= 0 a
-0002e910: 6e64 2065 6467 655f 7269 6768 745b 696e  nd edge_right[in
-0002e920: 5f6f 7264 6572 5b6a 5d5d 203d 3d20 7269  _order[j]] == ri
-0002e930: 6768 743a 0a20 2020 2020 2020 2020 2020  ght:.           
-0002e940: 2020 2020 2065 6467 6573 5f69 6e2e 6170       edges_in.ap
-0002e950: 7065 6e64 280a 2020 2020 2020 2020 2020  pend(.          
-0002e960: 2020 2020 2020 2020 2020 4564 6765 280a            Edge(.
+0002da50: 2020 6564 6765 7365 7420 3d20 6163 7469    edgeset = acti
+0002da60: 7665 5f65 6467 6573 6574 732e 706f 7028  ve_edgesets.pop(
+0002da70: 7061 7265 6e74 290a 2020 2020 2020 2020  parent).        
+0002da80: 2020 2020 2020 2020 2020 2020 6564 6765              edge
+0002da90: 7365 742e 7269 6768 7420 3d20 6c65 6674  set.right = left
+0002daa0: 0a20 2020 2020 2020 2020 2020 2020 2020  .               
+0002dab0: 2020 2020 2065 6467 6573 6574 2e63 6869       edgeset.chi
+0002dac0: 6c64 7265 6e20 3d20 736f 7274 6564 2863  ldren = sorted(c
+0002dad0: 6869 6c64 7265 6e5b 7061 7265 6e74 5d29  hildren[parent])
+0002dae0: 0a20 2020 2020 2020 2020 2020 2020 2020  .               
+0002daf0: 2020 2020 2079 6965 6c64 2065 6467 6573       yield edges
+0002db00: 6574 0a20 2020 2020 2020 2020 2020 2066  et.            f
+0002db10: 6f72 2065 6467 6520 696e 2065 6467 6573  or edge in edges
+0002db20: 5f6f 7574 3a0a 2020 2020 2020 2020 2020  _out:.          
+0002db30: 2020 2020 2020 6368 696c 6472 656e 5b65        children[e
+0002db40: 6467 652e 7061 7265 6e74 5d2e 7265 6d6f  dge.parent].remo
+0002db50: 7665 2865 6467 652e 6368 696c 6429 0a20  ve(edge.child). 
+0002db60: 2020 2020 2020 2020 2020 2066 6f72 2065             for e
+0002db70: 6467 6520 696e 2065 6467 6573 5f69 6e3a  dge in edges_in:
+0002db80: 0a20 2020 2020 2020 2020 2020 2020 2020  .               
+0002db90: 2063 6869 6c64 7265 6e5b 6564 6765 2e70   children[edge.p
+0002dba0: 6172 656e 745d 2e61 6464 2865 6467 652e  arent].add(edge.
+0002dbb0: 6368 696c 6429 0a20 2020 2020 2020 2020  child).         
+0002dbc0: 2020 2023 2055 7064 6174 6520 7468 6520     # Update the 
+0002dbd0: 6163 7469 7665 2065 6467 6573 6574 730a  active edgesets.
+0002dbe0: 2020 2020 2020 2020 2020 2020 666f 7220              for 
+0002dbf0: 6564 6765 2069 6e20 6974 6572 746f 6f6c  edge in itertool
+0002dc00: 732e 6368 6169 6e28 6564 6765 735f 6f75  s.chain(edges_ou
+0002dc10: 742c 2065 6467 6573 5f69 6e29 3a0a 2020  t, edges_in):.  
+0002dc20: 2020 2020 2020 2020 2020 2020 2020 6966                if
+0002dc30: 2028 0a20 2020 2020 2020 2020 2020 2020   (.             
+0002dc40: 2020 2020 2020 206c 656e 2863 6869 6c64         len(child
+0002dc50: 7265 6e5b 6564 6765 2e70 6172 656e 745d  ren[edge.parent]
+0002dc60: 2920 3e20 300a 2020 2020 2020 2020 2020  ) > 0.          
+0002dc70: 2020 2020 2020 2020 2020 616e 6420 6564            and ed
+0002dc80: 6765 2e70 6172 656e 7420 6e6f 7420 696e  ge.parent not in
+0002dc90: 2061 6374 6976 655f 6564 6765 7365 7473   active_edgesets
+0002dca0: 0a20 2020 2020 2020 2020 2020 2020 2020  .               
+0002dcb0: 2029 3a0a 2020 2020 2020 2020 2020 2020   ):.            
+0002dcc0: 2020 2020 2020 2020 6163 7469 7665 5f65          active_e
+0002dcd0: 6467 6573 6574 735b 6564 6765 2e70 6172  dgesets[edge.par
+0002dce0: 656e 745d 203d 2045 6467 6573 6574 286c  ent] = Edgeset(l
+0002dcf0: 6566 742c 2072 6967 6874 2c20 6564 6765  eft, right, edge
+0002dd00: 2e70 6172 656e 742c 205b 5d29 0a0a 2020  .parent, [])..  
+0002dd10: 2020 2020 2020 666f 7220 7061 7265 6e74        for parent
+0002dd20: 2069 6e20 6163 7469 7665 5f65 6467 6573   in active_edges
+0002dd30: 6574 732e 6b65 7973 2829 3a0a 2020 2020  ets.keys():.    
+0002dd40: 2020 2020 2020 2020 6564 6765 7365 7420          edgeset 
+0002dd50: 3d20 6163 7469 7665 5f65 6467 6573 6574  = active_edgeset
+0002dd60: 735b 7061 7265 6e74 5d0a 2020 2020 2020  s[parent].      
+0002dd70: 2020 2020 2020 6564 6765 7365 742e 7269        edgeset.ri
+0002dd80: 6768 7420 3d20 7365 6c66 2e73 6571 7565  ght = self.seque
+0002dd90: 6e63 655f 6c65 6e67 7468 0a20 2020 2020  nce_length.     
+0002dda0: 2020 2020 2020 2065 6467 6573 6574 2e63         edgeset.c
+0002ddb0: 6869 6c64 7265 6e20 3d20 736f 7274 6564  hildren = sorted
+0002ddc0: 2863 6869 6c64 7265 6e5b 6564 6765 7365  (children[edgese
+0002ddd0: 742e 7061 7265 6e74 5d29 0a20 2020 2020  t.parent]).     
+0002dde0: 2020 2020 2020 2079 6965 6c64 2065 6467         yield edg
+0002ddf0: 6573 6574 0a0a 2020 2020 6465 6620 5f65  eset..    def _e
+0002de00: 6467 655f 6469 6666 735f 666f 7277 6172  dge_diffs_forwar
+0002de10: 6428 7365 6c66 2c20 696e 636c 7564 655f  d(self, include_
+0002de20: 7465 726d 696e 616c 3d46 616c 7365 293a  terminal=False):
+0002de30: 0a20 2020 2020 2020 206d 6574 6164 6174  .        metadat
+0002de40: 615f 6465 636f 6465 7220 3d20 7365 6c66  a_decoder = self
+0002de50: 2e74 6162 6c65 5f6d 6574 6164 6174 615f  .table_metadata_
+0002de60: 7363 6865 6d61 732e 6564 6765 2e64 6563  schemas.edge.dec
+0002de70: 6f64 655f 726f 770a 2020 2020 2020 2020  ode_row.        
+0002de80: 6564 6765 5f6c 6566 7420 3d20 7365 6c66  edge_left = self
+0002de90: 2e65 6467 6573 5f6c 6566 740a 2020 2020  .edges_left.    
+0002dea0: 2020 2020 6564 6765 5f72 6967 6874 203d      edge_right =
+0002deb0: 2073 656c 662e 6564 6765 735f 7269 6768   self.edges_righ
+0002dec0: 740a 2020 2020 2020 2020 7365 7175 656e  t.        sequen
+0002ded0: 6365 5f6c 656e 6774 6820 3d20 7365 6c66  ce_length = self
+0002dee0: 2e73 6571 7565 6e63 655f 6c65 6e67 7468  .sequence_length
+0002def0: 0a20 2020 2020 2020 2069 6e5f 6f72 6465  .        in_orde
+0002df00: 7220 3d20 7365 6c66 2e69 6e64 6578 6573  r = self.indexes
+0002df10: 5f65 6467 655f 696e 7365 7274 696f 6e5f  _edge_insertion_
+0002df20: 6f72 6465 720a 2020 2020 2020 2020 6f75  order.        ou
+0002df30: 745f 6f72 6465 7220 3d20 7365 6c66 2e69  t_order = self.i
+0002df40: 6e64 6578 6573 5f65 6467 655f 7265 6d6f  ndexes_edge_remo
+0002df50: 7661 6c5f 6f72 6465 720a 2020 2020 2020  val_order.      
+0002df60: 2020 4d20 3d20 7365 6c66 2e6e 756d 5f65    M = self.num_e
+0002df70: 6467 6573 0a20 2020 2020 2020 206a 203d  dges.        j =
+0002df80: 2030 0a20 2020 2020 2020 206b 203d 2030   0.        k = 0
+0002df90: 0a20 2020 2020 2020 206c 6566 7420 3d20  .        left = 
+0002dfa0: 302e 300a 2020 2020 2020 2020 7768 696c  0.0.        whil
+0002dfb0: 6520 6a20 3c20 4d20 6f72 206c 6566 7420  e j < M or left 
+0002dfc0: 3c20 7365 7175 656e 6365 5f6c 656e 6774  < sequence_lengt
+0002dfd0: 683a 0a20 2020 2020 2020 2020 2020 2065  h:.            e
+0002dfe0: 6467 6573 5f6f 7574 203d 205b 5d0a 2020  dges_out = [].  
+0002dff0: 2020 2020 2020 2020 2020 6564 6765 735f            edges_
+0002e000: 696e 203d 205b 5d0a 2020 2020 2020 2020  in = [].        
+0002e010: 2020 2020 7768 696c 6520 6b20 3c20 4d20      while k < M 
+0002e020: 616e 6420 6564 6765 5f72 6967 6874 5b6f  and edge_right[o
+0002e030: 7574 5f6f 7264 6572 5b6b 5d5d 203d 3d20  ut_order[k]] == 
+0002e040: 6c65 6674 3a0a 2020 2020 2020 2020 2020  left:.          
+0002e050: 2020 2020 2020 6564 6765 735f 6f75 742e        edges_out.
+0002e060: 6170 7065 6e64 280a 2020 2020 2020 2020  append(.        
+0002e070: 2020 2020 2020 2020 2020 2020 4564 6765              Edge
+0002e080: 280a 2020 2020 2020 2020 2020 2020 2020  (.              
+0002e090: 2020 2020 2020 2020 2020 2a73 656c 662e            *self.
+0002e0a0: 5f6c 6c5f 7472 6565 5f73 6571 7565 6e63  _ll_tree_sequenc
+0002e0b0: 652e 6765 745f 6564 6765 286f 7574 5f6f  e.get_edge(out_o
+0002e0c0: 7264 6572 5b6b 5d29 2c0a 2020 2020 2020  rder[k]),.      
+0002e0d0: 2020 2020 2020 2020 2020 2020 2020 2020                  
+0002e0e0: 2020 6964 3d6f 7574 5f6f 7264 6572 5b6b    id=out_order[k
+0002e0f0: 5d2c 0a20 2020 2020 2020 2020 2020 2020  ],.             
+0002e100: 2020 2020 2020 2020 2020 206d 6574 6164             metad
+0002e110: 6174 615f 6465 636f 6465 723d 6d65 7461  ata_decoder=meta
+0002e120: 6461 7461 5f64 6563 6f64 6572 2c0a 2020  data_decoder,.  
+0002e130: 2020 2020 2020 2020 2020 2020 2020 2020                  
+0002e140: 2020 290a 2020 2020 2020 2020 2020 2020    ).            
+0002e150: 2020 2020 290a 2020 2020 2020 2020 2020      ).          
+0002e160: 2020 2020 2020 6b20 2b3d 2031 0a20 2020        k += 1.   
+0002e170: 2020 2020 2020 2020 2077 6869 6c65 206a           while j
+0002e180: 203c 204d 2061 6e64 2065 6467 655f 6c65   < M and edge_le
+0002e190: 6674 5b69 6e5f 6f72 6465 725b 6a5d 5d20  ft[in_order[j]] 
+0002e1a0: 3d3d 206c 6566 743a 0a20 2020 2020 2020  == left:.       
+0002e1b0: 2020 2020 2020 2020 2065 6467 6573 5f69           edges_i
+0002e1c0: 6e2e 6170 7065 6e64 280a 2020 2020 2020  n.append(.      
+0002e1d0: 2020 2020 2020 2020 2020 2020 2020 4564                Ed
+0002e1e0: 6765 280a 2020 2020 2020 2020 2020 2020  ge(.            
+0002e1f0: 2020 2020 2020 2020 2020 2020 2a73 656c              *sel
+0002e200: 662e 5f6c 6c5f 7472 6565 5f73 6571 7565  f._ll_tree_seque
+0002e210: 6e63 652e 6765 745f 6564 6765 2869 6e5f  nce.get_edge(in_
+0002e220: 6f72 6465 725b 6a5d 292c 0a20 2020 2020  order[j]),.     
+0002e230: 2020 2020 2020 2020 2020 2020 2020 2020                  
+0002e240: 2020 2069 643d 696e 5f6f 7264 6572 5b6a     id=in_order[j
+0002e250: 5d2c 0a20 2020 2020 2020 2020 2020 2020  ],.             
+0002e260: 2020 2020 2020 2020 2020 206d 6574 6164             metad
+0002e270: 6174 615f 6465 636f 6465 723d 6d65 7461  ata_decoder=meta
+0002e280: 6461 7461 5f64 6563 6f64 6572 2c0a 2020  data_decoder,.  
+0002e290: 2020 2020 2020 2020 2020 2020 2020 2020                  
+0002e2a0: 2020 290a 2020 2020 2020 2020 2020 2020    ).            
+0002e2b0: 2020 2020 290a 2020 2020 2020 2020 2020      ).          
+0002e2c0: 2020 2020 2020 6a20 2b3d 2031 0a20 2020        j += 1.   
+0002e2d0: 2020 2020 2020 2020 2072 6967 6874 203d           right =
+0002e2e0: 2073 6571 7565 6e63 655f 6c65 6e67 7468   sequence_length
+0002e2f0: 0a20 2020 2020 2020 2020 2020 2069 6620  .            if 
+0002e300: 6a20 3c20 4d3a 0a20 2020 2020 2020 2020  j < M:.         
+0002e310: 2020 2020 2020 2072 6967 6874 203d 206d         right = m
+0002e320: 696e 2872 6967 6874 2c20 6564 6765 5f6c  in(right, edge_l
+0002e330: 6566 745b 696e 5f6f 7264 6572 5b6a 5d5d  eft[in_order[j]]
+0002e340: 290a 2020 2020 2020 2020 2020 2020 6966  ).            if
+0002e350: 206b 203c 204d 3a0a 2020 2020 2020 2020   k < M:.        
+0002e360: 2020 2020 2020 2020 7269 6768 7420 3d20          right = 
+0002e370: 6d69 6e28 7269 6768 742c 2065 6467 655f  min(right, edge_
+0002e380: 7269 6768 745b 6f75 745f 6f72 6465 725b  right[out_order[
+0002e390: 6b5d 5d29 0a20 2020 2020 2020 2020 2020  k]]).           
+0002e3a0: 2079 6965 6c64 2045 6467 6544 6966 6628   yield EdgeDiff(
+0002e3b0: 496e 7465 7276 616c 286c 6566 742c 2072  Interval(left, r
+0002e3c0: 6967 6874 292c 2065 6467 6573 5f6f 7574  ight), edges_out
+0002e3d0: 2c20 6564 6765 735f 696e 290a 2020 2020  , edges_in).    
+0002e3e0: 2020 2020 2020 2020 6c65 6674 203d 2072          left = r
+0002e3f0: 6967 6874 0a0a 2020 2020 2020 2020 6966  ight..        if
+0002e400: 2069 6e63 6c75 6465 5f74 6572 6d69 6e61   include_termina
+0002e410: 6c3a 0a20 2020 2020 2020 2020 2020 2065  l:.            e
+0002e420: 6467 6573 5f6f 7574 203d 205b 5d0a 2020  dges_out = [].  
+0002e430: 2020 2020 2020 2020 2020 7768 696c 6520            while 
+0002e440: 6b20 3c20 4d3a 0a20 2020 2020 2020 2020  k < M:.         
+0002e450: 2020 2020 2020 2065 6467 6573 5f6f 7574         edges_out
+0002e460: 2e61 7070 656e 6428 0a20 2020 2020 2020  .append(.       
+0002e470: 2020 2020 2020 2020 2020 2020 2045 6467               Edg
+0002e480: 6528 0a20 2020 2020 2020 2020 2020 2020  e(.             
+0002e490: 2020 2020 2020 2020 2020 202a 7365 6c66             *self
+0002e4a0: 2e5f 6c6c 5f74 7265 655f 7365 7175 656e  ._ll_tree_sequen
+0002e4b0: 6365 2e67 6574 5f65 6467 6528 6f75 745f  ce.get_edge(out_
+0002e4c0: 6f72 6465 725b 6b5d 292c 0a20 2020 2020  order[k]),.     
+0002e4d0: 2020 2020 2020 2020 2020 2020 2020 2020                  
+0002e4e0: 2020 2069 643d 6f75 745f 6f72 6465 725b     id=out_order[
+0002e4f0: 6b5d 2c0a 2020 2020 2020 2020 2020 2020  k],.            
+0002e500: 2020 2020 2020 2020 2020 2020 6d65 7461              meta
+0002e510: 6461 7461 5f64 6563 6f64 6572 3d6d 6574  data_decoder=met
+0002e520: 6164 6174 615f 6465 636f 6465 722c 0a20  adata_decoder,. 
+0002e530: 2020 2020 2020 2020 2020 2020 2020 2020                  
+0002e540: 2020 2029 0a20 2020 2020 2020 2020 2020     ).           
+0002e550: 2020 2020 2029 0a20 2020 2020 2020 2020       ).         
+0002e560: 2020 2020 2020 206b 202b 3d20 310a 2020         k += 1.  
+0002e570: 2020 2020 2020 2020 2020 7969 656c 6420            yield 
+0002e580: 4564 6765 4469 6666 2849 6e74 6572 7661  EdgeDiff(Interva
+0002e590: 6c28 6c65 6674 2c20 7269 6768 7429 2c20  l(left, right), 
+0002e5a0: 6564 6765 735f 6f75 742c 205b 5d29 0a0a  edges_out, [])..
+0002e5b0: 2020 2020 6465 6620 5f65 6467 655f 6469      def _edge_di
+0002e5c0: 6666 735f 7265 7665 7273 6528 7365 6c66  ffs_reverse(self
+0002e5d0: 2c20 696e 636c 7564 655f 7465 726d 696e  , include_termin
+0002e5e0: 616c 3d46 616c 7365 293a 0a20 2020 2020  al=False):.     
+0002e5f0: 2020 206d 6574 6164 6174 615f 6465 636f     metadata_deco
+0002e600: 6465 7220 3d20 7365 6c66 2e74 6162 6c65  der = self.table
+0002e610: 5f6d 6574 6164 6174 615f 7363 6865 6d61  _metadata_schema
+0002e620: 732e 6564 6765 2e64 6563 6f64 655f 726f  s.edge.decode_ro
+0002e630: 770a 2020 2020 2020 2020 6564 6765 5f6c  w.        edge_l
+0002e640: 6566 7420 3d20 7365 6c66 2e65 6467 6573  eft = self.edges
+0002e650: 5f6c 6566 740a 2020 2020 2020 2020 6564  _left.        ed
+0002e660: 6765 5f72 6967 6874 203d 2073 656c 662e  ge_right = self.
+0002e670: 6564 6765 735f 7269 6768 740a 2020 2020  edges_right.    
+0002e680: 2020 2020 7365 7175 656e 6365 5f6c 656e      sequence_len
+0002e690: 6774 6820 3d20 7365 6c66 2e73 6571 7565  gth = self.seque
+0002e6a0: 6e63 655f 6c65 6e67 7468 0a20 2020 2020  nce_length.     
+0002e6b0: 2020 2069 6e5f 6f72 6465 7220 3d20 7365     in_order = se
+0002e6c0: 6c66 2e69 6e64 6578 6573 5f65 6467 655f  lf.indexes_edge_
+0002e6d0: 7265 6d6f 7661 6c5f 6f72 6465 720a 2020  removal_order.  
+0002e6e0: 2020 2020 2020 6f75 745f 6f72 6465 7220        out_order 
+0002e6f0: 3d20 7365 6c66 2e69 6e64 6578 6573 5f65  = self.indexes_e
+0002e700: 6467 655f 696e 7365 7274 696f 6e5f 6f72  dge_insertion_or
+0002e710: 6465 720a 2020 2020 2020 2020 4d20 3d20  der.        M = 
+0002e720: 7365 6c66 2e6e 756d 5f65 6467 6573 0a20  self.num_edges. 
+0002e730: 2020 2020 2020 206a 203d 204d 202d 2031         j = M - 1
+0002e740: 0a20 2020 2020 2020 206b 203d 204d 202d  .        k = M -
+0002e750: 2031 0a20 2020 2020 2020 2072 6967 6874   1.        right
+0002e760: 203d 2073 6571 7565 6e63 655f 6c65 6e67   = sequence_leng
+0002e770: 7468 0a20 2020 2020 2020 2077 6869 6c65  th.        while
+0002e780: 206a 203e 3d20 3020 6f72 2072 6967 6874   j >= 0 or right
+0002e790: 203e 2030 3a0a 2020 2020 2020 2020 2020   > 0:.          
+0002e7a0: 2020 6564 6765 735f 6f75 7420 3d20 5b5d    edges_out = []
+0002e7b0: 0a20 2020 2020 2020 2020 2020 2065 6467  .            edg
+0002e7c0: 6573 5f69 6e20 3d20 5b5d 0a20 2020 2020  es_in = [].     
+0002e7d0: 2020 2020 2020 2077 6869 6c65 206b 203e         while k >
+0002e7e0: 3d20 3020 616e 6420 6564 6765 5f6c 6566  = 0 and edge_lef
+0002e7f0: 745b 6f75 745f 6f72 6465 725b 6b5d 5d20  t[out_order[k]] 
+0002e800: 3d3d 2072 6967 6874 3a0a 2020 2020 2020  == right:.      
+0002e810: 2020 2020 2020 2020 2020 6564 6765 735f            edges_
+0002e820: 6f75 742e 6170 7065 6e64 280a 2020 2020  out.append(.    
+0002e830: 2020 2020 2020 2020 2020 2020 2020 2020                  
+0002e840: 4564 6765 280a 2020 2020 2020 2020 2020  Edge(.          
+0002e850: 2020 2020 2020 2020 2020 2020 2020 2a73                *s
+0002e860: 656c 662e 5f6c 6c5f 7472 6565 5f73 6571  elf._ll_tree_seq
+0002e870: 7565 6e63 652e 6765 745f 6564 6765 286f  uence.get_edge(o
+0002e880: 7574 5f6f 7264 6572 5b6b 5d29 2c0a 2020  ut_order[k]),.  
+0002e890: 2020 2020 2020 2020 2020 2020 2020 2020                  
+0002e8a0: 2020 2020 2020 6964 3d6f 7574 5f6f 7264        id=out_ord
+0002e8b0: 6572 5b6b 5d2c 0a20 2020 2020 2020 2020  er[k],.         
+0002e8c0: 2020 2020 2020 2020 2020 2020 2020 206d                 m
+0002e8d0: 6574 6164 6174 615f 6465 636f 6465 723d  etadata_decoder=
+0002e8e0: 6d65 7461 6461 7461 5f64 6563 6f64 6572  metadata_decoder
+0002e8f0: 2c0a 2020 2020 2020 2020 2020 2020 2020  ,.              
+0002e900: 2020 2020 2020 290a 2020 2020 2020 2020        ).        
+0002e910: 2020 2020 2020 2020 290a 2020 2020 2020          ).      
+0002e920: 2020 2020 2020 2020 2020 6b20 2d3d 2031            k -= 1
+0002e930: 0a20 2020 2020 2020 2020 2020 2077 6869  .            whi
+0002e940: 6c65 206a 203e 3d20 3020 616e 6420 6564  le j >= 0 and ed
+0002e950: 6765 5f72 6967 6874 5b69 6e5f 6f72 6465  ge_right[in_orde
+0002e960: 725b 6a5d 5d20 3d3d 2072 6967 6874 3a0a  r[j]] == right:.
 0002e970: 2020 2020 2020 2020 2020 2020 2020 2020                  
-0002e980: 2020 2020 2020 2020 2a73 656c 662e 5f6c          *self._l
-0002e990: 6c5f 7472 6565 5f73 6571 7565 6e63 652e  l_tree_sequence.
-0002e9a0: 6765 745f 6564 6765 2869 6e5f 6f72 6465  get_edge(in_orde
-0002e9b0: 725b 6a5d 292c 0a20 2020 2020 2020 2020  r[j]),.         
-0002e9c0: 2020 2020 2020 2020 2020 2020 2020 2069                 i
-0002e9d0: 643d 696e 5f6f 7264 6572 5b6a 5d2c 0a20  d=in_order[j],. 
-0002e9e0: 2020 2020 2020 2020 2020 2020 2020 2020                  
-0002e9f0: 2020 2020 2020 206d 6574 6164 6174 615f         metadata_
-0002ea00: 6465 636f 6465 723d 6d65 7461 6461 7461  decoder=metadata
-0002ea10: 5f64 6563 6f64 6572 2c0a 2020 2020 2020  _decoder,.      
-0002ea20: 2020 2020 2020 2020 2020 2020 2020 290a                ).
-0002ea30: 2020 2020 2020 2020 2020 2020 2020 2020                  
-0002ea40: 290a 2020 2020 2020 2020 2020 2020 2020  ).              
-0002ea50: 2020 6a20 2d3d 2031 0a20 2020 2020 2020    j -= 1.       
-0002ea60: 2020 2020 206c 6566 7420 3d20 300a 2020       left = 0.  
-0002ea70: 2020 2020 2020 2020 2020 6966 206a 203e            if j >
-0002ea80: 3d20 303a 0a20 2020 2020 2020 2020 2020  = 0:.           
-0002ea90: 2020 2020 206c 6566 7420 3d20 6d61 7828       left = max(
-0002eaa0: 6c65 6674 2c20 6564 6765 5f72 6967 6874  left, edge_right
-0002eab0: 5b69 6e5f 6f72 6465 725b 6a5d 5d29 0a20  [in_order[j]]). 
-0002eac0: 2020 2020 2020 2020 2020 2069 6620 6b20             if k 
-0002ead0: 3e3d 2030 3a0a 2020 2020 2020 2020 2020  >= 0:.          
-0002eae0: 2020 2020 2020 6c65 6674 203d 206d 6178        left = max
-0002eaf0: 286c 6566 742c 2065 6467 655f 6c65 6674  (left, edge_left
-0002eb00: 5b6f 7574 5f6f 7264 6572 5b6b 5d5d 290a  [out_order[k]]).
-0002eb10: 2020 2020 2020 2020 2020 2020 7969 656c              yiel
-0002eb20: 6420 4564 6765 4469 6666 2849 6e74 6572  d EdgeDiff(Inter
-0002eb30: 7661 6c28 6c65 6674 2c20 7269 6768 7429  val(left, right)
-0002eb40: 2c20 6564 6765 735f 6f75 742c 2065 6467  , edges_out, edg
-0002eb50: 6573 5f69 6e29 0a20 2020 2020 2020 2020  es_in).         
-0002eb60: 2020 2072 6967 6874 203d 206c 6566 740a     right = left.
-0002eb70: 0a20 2020 2020 2020 2069 6620 696e 636c  .        if incl
-0002eb80: 7564 655f 7465 726d 696e 616c 3a0a 2020  ude_terminal:.  
-0002eb90: 2020 2020 2020 2020 2020 6564 6765 735f            edges_
-0002eba0: 6f75 7420 3d20 5b5d 0a20 2020 2020 2020  out = [].       
-0002ebb0: 2020 2020 2077 6869 6c65 206b 203e 3d20       while k >= 
-0002ebc0: 303a 0a20 2020 2020 2020 2020 2020 2020  0:.             
-0002ebd0: 2020 2065 6467 6573 5f6f 7574 2e61 7070     edges_out.app
-0002ebe0: 656e 6428 0a20 2020 2020 2020 2020 2020  end(.           
-0002ebf0: 2020 2020 2020 2020 2045 6467 6528 0a20           Edge(. 
-0002ec00: 2020 2020 2020 2020 2020 2020 2020 2020                  
-0002ec10: 2020 2020 2020 202a 7365 6c66 2e5f 6c6c         *self._ll
-0002ec20: 5f74 7265 655f 7365 7175 656e 6365 2e67  _tree_sequence.g
-0002ec30: 6574 5f65 6467 6528 6f75 745f 6f72 6465  et_edge(out_orde
-0002ec40: 725b 6b5d 292c 0a20 2020 2020 2020 2020  r[k]),.         
-0002ec50: 2020 2020 2020 2020 2020 2020 2020 2069                 i
-0002ec60: 643d 6f75 745f 6f72 6465 725b 6b5d 2c0a  d=out_order[k],.
-0002ec70: 2020 2020 2020 2020 2020 2020 2020 2020                  
-0002ec80: 2020 2020 2020 2020 6d65 7461 6461 7461          metadata
-0002ec90: 5f64 6563 6f64 6572 3d6d 6574 6164 6174  _decoder=metadat
-0002eca0: 615f 6465 636f 6465 722c 0a20 2020 2020  a_decoder,.     
-0002ecb0: 2020 2020 2020 2020 2020 2020 2020 2029                 )
-0002ecc0: 0a20 2020 2020 2020 2020 2020 2020 2020  .               
-0002ecd0: 2029 0a20 2020 2020 2020 2020 2020 2020   ).             
-0002ece0: 2020 206b 202d 3d20 310a 2020 2020 2020     k -= 1.      
-0002ecf0: 2020 2020 2020 7969 656c 6420 4564 6765        yield Edge
-0002ed00: 4469 6666 2849 6e74 6572 7661 6c28 6c65  Diff(Interval(le
-0002ed10: 6674 2c20 7269 6768 7429 2c20 6564 6765  ft, right), edge
-0002ed20: 735f 6f75 742c 205b 5d29 0a0a 2020 2020  s_out, [])..    
-0002ed30: 6465 6620 6564 6765 5f64 6966 6673 2873  def edge_diffs(s
-0002ed40: 656c 662c 2069 6e63 6c75 6465 5f74 6572  elf, include_ter
-0002ed50: 6d69 6e61 6c3d 4661 6c73 652c 202a 2c20  minal=False, *, 
-0002ed60: 6469 7265 6374 696f 6e3d 7473 6b69 742e  direction=tskit.
-0002ed70: 464f 5257 4152 4429 3a0a 2020 2020 2020  FORWARD):.      
-0002ed80: 2020 2222 220a 2020 2020 2020 2020 5265    """.        Re
-0002ed90: 7475 726e 7320 616e 2069 7465 7261 746f  turns an iterato
-0002eda0: 7220 6f76 6572 2061 6c6c 2074 6865 203a  r over all the :
-0002edb0: 7265 663a 6065 6467 6573 203c 7365 635f  ref:`edges <sec_
-0002edc0: 6564 6765 5f74 6162 6c65 5f64 6566 696e  edge_table_defin
-0002edd0: 6974 696f 6e3e 6020 7468 6174 0a20 2020  ition>` that.   
-0002ede0: 2020 2020 2061 7265 2069 6e73 6572 7465       are inserte
-0002edf0: 6420 616e 6420 7265 6d6f 7665 6420 746f  d and removed to
-0002ee00: 2062 7569 6c64 2074 6865 2074 7265 6573   build the trees
-0002ee10: 2061 7320 7765 206d 6f76 6520 6672 6f6d   as we move from
-0002ee20: 206c 6566 742d 746f 2d72 6967 6874 2061   left-to-right a
-0002ee30: 6c6f 6e67 0a20 2020 2020 2020 2074 6865  long.        the
-0002ee40: 2074 7265 6520 7365 7175 656e 6365 2e20   tree sequence. 
-0002ee50: 4561 6368 2069 7465 7261 7469 6f6e 2079  Each iteration y
-0002ee60: 6965 6c64 7320 6120 6e61 6d65 6420 7475  ields a named tu
-0002ee70: 706c 6520 636f 6e73 6973 7469 6e67 206f  ple consisting o
-0002ee80: 6620 3320 7661 6c75 6573 2c0a 2020 2020  f 3 values,.    
-0002ee90: 2020 2020 6060 2869 6e74 6572 7661 6c2c      ``(interval,
-0002eea0: 2065 6467 6573 5f6f 7574 2c20 6564 6765   edges_out, edge
-0002eeb0: 735f 696e 2960 602e 2054 6865 2066 6972  s_in)``. The fir
-0002eec0: 7374 2076 616c 7565 2c20 6060 696e 7465  st value, ``inte
-0002eed0: 7276 616c 6060 2c20 6973 2074 6865 0a20  rval``, is the. 
-0002eee0: 2020 2020 2020 2067 656e 6f6d 6963 2069         genomic i
-0002eef0: 6e74 6572 7661 6c20 6060 286c 6566 742c  nterval ``(left,
-0002ef00: 2072 6967 6874 2960 6020 636f 7665 7265   right)`` covere
-0002ef10: 6420 6279 2074 6865 2069 6e63 6f6d 696e  d by the incomin
-0002ef20: 6720 7472 6565 0a20 2020 2020 2020 2028  g tree.        (
-0002ef30: 7365 6520 3a61 7474 723a 6054 7265 652e  see :attr:`Tree.
-0002ef40: 696e 7465 7276 616c 6029 2e20 5468 6520  interval`). The 
-0002ef50: 7365 636f 6e64 2c20 6060 6564 6765 735f  second, ``edges_
-0002ef60: 6f75 7460 6020 6973 2061 206c 6973 7420  out`` is a list 
-0002ef70: 6f66 2074 6865 2065 6467 6573 0a20 2020  of the edges.   
-0002ef80: 2020 2020 2074 6861 7420 7765 7265 206a       that were j
-0002ef90: 7573 742d 7265 6d6f 7665 6420 746f 2063  ust-removed to c
-0002efa0: 7265 6174 6520 7468 6520 7472 6565 2063  reate the tree c
-0002efb0: 6f76 6572 696e 6720 7468 6520 696e 7465  overing the inte
-0002efc0: 7276 616c 0a20 2020 2020 2020 2028 6865  rval.        (he
-0002efd0: 6e63 6520 6060 6564 6765 735f 6f75 7460  nce ``edges_out`
-0002efe0: 6020 7769 6c6c 2061 6c77 6179 7320 6265  ` will always be
-0002eff0: 2065 6d70 7479 2066 6f72 2074 6865 2066   empty for the f
-0002f000: 6972 7374 2074 7265 6529 2e20 5468 6520  irst tree). The 
-0002f010: 6c61 7374 2076 616c 7565 2c0a 2020 2020  last value,.    
-0002f020: 2020 2020 6060 6564 6765 735f 696e 6060      ``edges_in``
-0002f030: 2c20 6973 2061 206c 6973 7420 6f66 2065  , is a list of e
-0002f040: 6467 6573 2074 6861 7420 7765 7265 206a  dges that were j
-0002f050: 7573 740a 2020 2020 2020 2020 696e 7365  ust.        inse
-0002f060: 7274 6564 2074 6f20 636f 6e73 7472 7563  rted to construc
-0002f070: 7420 7468 6520 7472 6565 2063 6f76 6572  t the tree cover
-0002f080: 696e 6720 7468 6520 6375 7272 656e 7420  ing the current 
-0002f090: 696e 7465 7276 616c 2e0a 0a20 2020 2020  interval...     
-0002f0a0: 2020 2054 6865 2065 6467 6573 2072 6574     The edges ret
-0002f0b0: 7572 6e65 6420 7769 7468 696e 2065 6163  urned within eac
-0002f0c0: 6820 6060 6564 6765 735f 696e 6060 206c  h ``edges_in`` l
-0002f0d0: 6973 7420 6172 6520 6f72 6465 7265 6420  ist are ordered 
-0002f0e0: 6279 2061 7363 656e 6469 6e67 0a20 2020  by ascending.   
-0002f0f0: 2020 2020 2074 696d 6520 6f66 2074 6865       time of the
-0002f100: 2070 6172 656e 7420 6e6f 6465 2c20 7468   parent node, th
-0002f110: 656e 2061 7363 656e 6469 6e67 2070 6172  en ascending par
-0002f120: 656e 7420 6964 2c20 7468 656e 2061 7363  ent id, then asc
-0002f130: 656e 6469 6e67 2063 6869 6c64 2069 642e  ending child id.
-0002f140: 0a20 2020 2020 2020 2054 6865 2065 6467  .        The edg
-0002f150: 6573 2077 6974 6869 6e20 6561 6368 2060  es within each `
-0002f160: 6065 6467 6573 5f6f 7574 6060 206c 6973  `edges_out`` lis
-0002f170: 7420 6172 6520 7468 6520 7265 7665 7273  t are the revers
-0002f180: 6520 6f72 6465 7220 2865 2e67 2e0a 2020  e order (e.g..  
-0002f190: 2020 2020 2020 6465 7363 656e 6469 6e67        descending
-0002f1a0: 2070 6172 656e 7420 7469 6d65 2c20 7061   parent time, pa
-0002f1b0: 7265 6e74 2069 642c 2074 6865 6e20 6368  rent id, then ch
-0002f1c0: 696c 645f 6964 292e 2054 6869 7320 6d65  ild_id). This me
-0002f1d0: 616e 7320 7468 6174 2077 6974 6869 6e0a  ans that within.
-0002f1e0: 2020 2020 2020 2020 6561 6368 206c 6973          each lis
-0002f1f0: 742c 2065 6467 6573 2077 6974 6820 7468  t, edges with th
-0002f200: 6520 7361 6d65 2070 6172 656e 7420 6170  e same parent ap
-0002f210: 7065 6172 2063 6f6e 7365 6375 7469 7665  pear consecutive
-0002f220: 6c79 2e0a 0a20 2020 2020 2020 2054 6865  ly...        The
-0002f230: 2060 6064 6972 6563 7469 6f6e 6060 2061   ``direction`` a
-0002f240: 7267 756d 656e 7420 6361 6e20 6265 2075  rgument can be u
-0002f250: 7365 6420 746f 2063 6f6e 7472 6f6c 2077  sed to control w
-0002f260: 6865 7468 6572 2064 6966 6673 2061 7265  hether diffs are
-0002f270: 2070 726f 6475 6365 640a 2020 2020 2020   produced.      
-0002f280: 2020 696e 2074 6865 2066 6f72 7761 7264    in the forward
-0002f290: 2028 6c65 6674 2d74 6f2d 7269 6768 742c   (left-to-right,
-0002f2a0: 2069 6e63 7265 6173 696e 6720 6765 6e6f   increasing geno
-0002f2b0: 6d65 2063 6f6f 7264 696e 6174 6520 7661  me coordinate va
-0002f2c0: 6c75 6529 0a20 2020 2020 2020 206f 7220  lue).        or 
-0002f2d0: 7265 7665 7273 6520 2872 6967 6874 2d74  reverse (right-t
-0002f2e0: 6f2d 6c65 6674 2c20 6465 6372 6561 7369  o-left, decreasi
-0002f2f0: 6e67 2067 656e 6f6d 6520 636f 6f72 6469  ng genome coordi
-0002f300: 6e61 7465 2076 616c 7565 2920 6469 7265  nate value) dire
-0002f310: 6374 696f 6e2e 0a0a 2020 2020 2020 2020  ction...        
-0002f320: 3a70 6172 616d 2062 6f6f 6c20 696e 636c  :param bool incl
-0002f330: 7564 655f 7465 726d 696e 616c 3a20 4966  ude_terminal: If
-0002f340: 2046 616c 7365 2028 6465 6661 756c 7429   False (default)
-0002f350: 2c20 7468 6520 6974 6572 6174 6f72 2074  , the iterator t
-0002f360: 6572 6d69 6e61 7465 730a 2020 2020 2020  erminates.      
-0002f370: 2020 2020 2020 6166 7465 7220 7468 6520        after the 
-0002f380: 6669 6e61 6c20 696e 7465 7276 616c 2069  final interval i
-0002f390: 6e20 7468 6520 7472 6565 2073 6571 7565  n the tree seque
-0002f3a0: 6e63 6520 2869 2e65 2e2c 2069 7420 646f  nce (i.e., it do
-0002f3b0: 6573 206e 6f74 0a20 2020 2020 2020 2020  es not.         
-0002f3c0: 2020 2072 6570 6f72 7420 6120 6669 6e61     report a fina
-0002f3d0: 6c20 7265 6d6f 7661 6c20 6f66 2061 6c6c  l removal of all
-0002f3e0: 2072 656d 6169 6e69 6e67 2065 6467 6573   remaining edges
-0002f3f0: 292c 2061 6e64 2074 6865 206e 756d 6265  ), and the numbe
-0002f400: 720a 2020 2020 2020 2020 2020 2020 6f66  r.            of
-0002f410: 2069 7465 7261 7469 6f6e 7320 7769 6c6c   iterations will
-0002f420: 2062 6520 6571 7561 6c20 746f 2074 6865   be equal to the
-0002f430: 206e 756d 6265 7220 6f66 2074 7265 6573   number of trees
-0002f440: 2069 6e20 7468 6520 7472 6565 0a20 2020   in the tree.   
-0002f450: 2020 2020 2020 2020 2073 6571 7565 6e63           sequenc
-0002f460: 652e 2049 6620 5472 7565 2c20 616e 2061  e. If True, an a
-0002f470: 6464 6974 696f 6e61 6c20 6974 6572 6174  dditional iterat
-0002f480: 696f 6e20 7461 6b65 7320 706c 6163 652c  ion takes place,
-0002f490: 2077 6974 6820 7468 6520 6c61 7374 0a20   with the last. 
-0002f4a0: 2020 2020 2020 2020 2020 2060 6065 6467             ``edg
-0002f4b0: 6573 5f6f 7574 6060 2076 616c 7565 2072  es_out`` value r
-0002f4c0: 6570 6f72 7469 6e67 2061 6c6c 2074 6865  eporting all the
-0002f4d0: 2065 6467 6573 2063 6f6e 7461 696e 6564   edges contained
-0002f4e0: 2069 6e20 7468 6520 6669 6e61 6c0a 2020   in the final.  
-0002f4f0: 2020 2020 2020 2020 2020 7472 6565 2028            tree (
-0002f500: 7769 7468 2062 6f74 6820 6060 6c65 6674  with both ``left
-0002f510: 6060 2061 6e64 2060 6072 6967 6874 6060  `` and ``right``
-0002f520: 2065 7175 616c 2074 6f20 7468 6520 7365   equal to the se
-0002f530: 7175 656e 6365 206c 656e 6774 6829 2e0a  quence length)..
-0002f540: 2020 2020 2020 2020 3a70 6172 616d 2069          :param i
-0002f550: 6e74 2064 6972 6563 7469 6f6e 3a20 5468  nt direction: Th
-0002f560: 6520 6469 7265 6374 696f 6e20 6f66 2074  e direction of t
-0002f570: 7261 7665 6c20 616c 6f6e 6720 7468 6520  ravel along the 
-0002f580: 7365 7175 656e 6365 2066 6f72 0a20 2020  sequence for.   
-0002f590: 2020 2020 2020 2020 2064 6966 6673 2e20           diffs. 
-0002f5a0: 4d75 7374 2062 6520 6f6e 6520 6f66 203a  Must be one of :
-0002f5b0: 6461 7461 3a60 2e46 4f52 5741 5244 6020  data:`.FORWARD` 
-0002f5c0: 6f72 203a 6461 7461 3a60 2e52 4556 4552  or :data:`.REVER
-0002f5d0: 5345 602e 0a20 2020 2020 2020 2020 2020  SE`..           
-0002f5e0: 2028 4465 6661 756c 743a 203a 6461 7461   (Default: :data
-0002f5f0: 3a60 2e46 4f52 5741 5244 6029 2e0a 2020  :`.FORWARD`)..  
-0002f600: 2020 2020 2020 3a72 6574 7572 6e3a 2041        :return: A
-0002f610: 6e20 6974 6572 6174 6f72 206f 7665 7220  n iterator over 
-0002f620: 7468 6520 2869 6e74 6572 7661 6c2c 2065  the (interval, e
-0002f630: 6467 6573 5f6f 7574 2c20 6564 6765 735f  dges_out, edges_
-0002f640: 696e 2920 7475 706c 6573 2e20 5468 6973  in) tuples. This
-0002f650: 0a20 2020 2020 2020 2020 2020 2069 7320  .            is 
-0002f660: 6120 6e61 6d65 6420 7475 706c 652c 2073  a named tuple, s
-0002f670: 6f20 7468 6520 3320 7661 6c75 6573 2063  o the 3 values c
-0002f680: 616e 2062 6520 6163 6365 7373 6564 2062  an be accessed b
-0002f690: 7920 706f 7369 7469 6f6e 0a20 2020 2020  y position.     
-0002f6a0: 2020 2020 2020 2028 652e 672e 2060 6072         (e.g. ``r
-0002f6b0: 6574 7572 6e65 645f 7475 706c 655b 305d  eturned_tuple[0]
-0002f6c0: 6060 2920 6f72 206e 616d 6520 2865 2e67  ``) or name (e.g
-0002f6d0: 2e20 6060 7265 7475 726e 6564 5f74 7570  . ``returned_tup
-0002f6e0: 6c65 2e69 6e74 6572 7661 6c60 6029 2e0a  le.interval``)..
-0002f6f0: 2020 2020 2020 2020 3a72 7479 7065 3a20          :rtype: 
-0002f700: 3a63 6c61 7373 3a60 636f 6c6c 6563 7469  :class:`collecti
-0002f710: 6f6e 732e 6162 632e 4974 6572 6162 6c65  ons.abc.Iterable
-0002f720: 600a 2020 2020 2020 2020 2222 220a 2020  `.        """.  
-0002f730: 2020 2020 2020 6966 2064 6972 6563 7469        if directi
-0002f740: 6f6e 203d 3d20 5f74 736b 6974 2e46 4f52  on == _tskit.FOR
-0002f750: 5741 5244 3a0a 2020 2020 2020 2020 2020  WARD:.          
-0002f760: 2020 7265 7475 726e 2073 656c 662e 5f65    return self._e
-0002f770: 6467 655f 6469 6666 735f 666f 7277 6172  dge_diffs_forwar
-0002f780: 6428 696e 636c 7564 655f 7465 726d 696e  d(include_termin
-0002f790: 616c 3d69 6e63 6c75 6465 5f74 6572 6d69  al=include_termi
-0002f7a0: 6e61 6c29 0a20 2020 2020 2020 2065 6c69  nal).        eli
-0002f7b0: 6620 6469 7265 6374 696f 6e20 3d3d 205f  f direction == _
-0002f7c0: 7473 6b69 742e 5245 5645 5253 453a 0a20  tskit.REVERSE:. 
-0002f7d0: 2020 2020 2020 2020 2020 2072 6574 7572             retur
-0002f7e0: 6e20 7365 6c66 2e5f 6564 6765 5f64 6966  n self._edge_dif
-0002f7f0: 6673 5f72 6576 6572 7365 2869 6e63 6c75  fs_reverse(inclu
-0002f800: 6465 5f74 6572 6d69 6e61 6c3d 696e 636c  de_terminal=incl
-0002f810: 7564 655f 7465 726d 696e 616c 290a 2020  ude_terminal).  
-0002f820: 2020 2020 2020 656c 7365 3a0a 2020 2020        else:.    
-0002f830: 2020 2020 2020 2020 7261 6973 6520 5661          raise Va
-0002f840: 6c75 6545 7272 6f72 2822 6469 7265 6374  lueError("direct
-0002f850: 696f 6e20 6d75 7374 2062 6520 6569 7468  ion must be eith
-0002f860: 6572 2074 736b 6974 2e46 4f52 5741 5244  er tskit.FORWARD
-0002f870: 206f 7220 7473 6b69 742e 5245 5645 5253   or tskit.REVERS
-0002f880: 4522 290a 0a20 2020 2064 6566 2073 6974  E")..    def sit
-0002f890: 6573 2873 656c 6629 3a0a 2020 2020 2020  es(self):.      
-0002f8a0: 2020 2222 220a 2020 2020 2020 2020 5265    """.        Re
-0002f8b0: 7475 726e 7320 616e 2069 7465 7261 626c  turns an iterabl
-0002f8c0: 6520 7365 7175 656e 6365 206f 6620 616c  e sequence of al
-0002f8d0: 6c20 7468 6520 3a72 6566 3a60 7369 7465  l the :ref:`site
-0002f8e0: 7320 3c73 6563 5f73 6974 655f 7461 626c  s <sec_site_tabl
-0002f8f0: 655f 6465 6669 6e69 7469 6f6e 3e60 0a20  e_definition>`. 
-0002f900: 2020 2020 2020 2069 6e20 7468 6973 2074         in this t
-0002f910: 7265 6520 7365 7175 656e 6365 2e20 5369  ree sequence. Si
-0002f920: 7465 7320 6172 6520 7265 7475 726e 6564  tes are returned
-0002f930: 2069 6e20 6f72 6465 7220 6f66 2069 6e63   in order of inc
-0002f940: 7265 6173 696e 6720 4944 0a20 2020 2020  reasing ID.     
-0002f950: 2020 2028 616e 6420 616c 736f 2070 6f73     (and also pos
-0002f960: 6974 696f 6e29 2e20 5365 6520 7468 6520  ition). See the 
-0002f970: 3a63 6c61 7373 3a60 5369 7465 6020 636c  :class:`Site` cl
-0002f980: 6173 7320 666f 7220 6465 7461 696c 7320  ass for details 
-0002f990: 6f6e 0a20 2020 2020 2020 2074 6865 2061  on.        the a
-0002f9a0: 7661 696c 6162 6c65 2066 6965 6c64 7320  vailable fields 
-0002f9b0: 666f 7220 6561 6368 2073 6974 652e 0a0a  for each site...
-0002f9c0: 2020 2020 2020 2020 3a72 6574 7572 6e3a          :return:
-0002f9d0: 2041 6e20 6974 6572 6162 6c65 2073 6571   An iterable seq
-0002f9e0: 7565 6e63 6520 6f66 2061 6c6c 2073 6974  uence of all sit
-0002f9f0: 6573 2e0a 2020 2020 2020 2020 3a72 7479  es..        :rty
-0002fa00: 7065 3a20 5365 7175 656e 6365 283a 636c  pe: Sequence(:cl
-0002fa10: 6173 733a 602e 5369 7465 6029 0a20 2020  ass:`.Site`).   
-0002fa20: 2020 2020 2022 2222 0a20 2020 2020 2020       """.       
-0002fa30: 2072 6574 7572 6e20 5369 6d70 6c65 436f   return SimpleCo
-0002fa40: 6e74 6169 6e65 7253 6571 7565 6e63 6528  ntainerSequence(
-0002fa50: 7365 6c66 2e73 6974 652c 2073 656c 662e  self.site, self.
-0002fa60: 6e75 6d5f 7369 7465 7329 0a0a 2020 2020  num_sites)..    
-0002fa70: 6465 6620 6d75 7461 7469 6f6e 7328 7365  def mutations(se
-0002fa80: 6c66 293a 0a20 2020 2020 2020 2022 2222  lf):.        """
-0002fa90: 0a20 2020 2020 2020 2052 6574 7572 6e73  .        Returns
-0002faa0: 2061 6e20 6974 6572 6174 6f72 206f 7665   an iterator ove
-0002fab0: 7220 616c 6c20 7468 650a 2020 2020 2020  r all the.      
-0002fac0: 2020 3a72 6566 3a60 6d75 7461 7469 6f6e    :ref:`mutation
-0002fad0: 7320 3c73 6563 5f6d 7574 6174 696f 6e5f  s <sec_mutation_
-0002fae0: 7461 626c 655f 6465 6669 6e69 7469 6f6e  table_definition
-0002faf0: 3e60 2069 6e20 7468 6973 2074 7265 6520  >` in this tree 
-0002fb00: 7365 7175 656e 6365 2e0a 2020 2020 2020  sequence..      
-0002fb10: 2020 4d75 7461 7469 6f6e 7320 6172 6520    Mutations are 
-0002fb20: 7265 7475 726e 6564 2069 6e20 6f72 6465  returned in orde
-0002fb30: 7220 6f66 206e 6f6e 6465 6372 6561 7369  r of nondecreasi
-0002fb40: 6e67 2073 6974 6520 4944 2e0a 2020 2020  ng site ID..    
-0002fb50: 2020 2020 5365 6520 7468 6520 3a63 6c61      See the :cla
-0002fb60: 7373 3a60 4d75 7461 7469 6f6e 6020 636c  ss:`Mutation` cl
-0002fb70: 6173 7320 666f 7220 6465 7461 696c 7320  ass for details 
-0002fb80: 6f6e 2074 6865 2061 7661 696c 6162 6c65  on the available
-0002fb90: 2066 6965 6c64 7320 666f 720a 2020 2020   fields for.    
-0002fba0: 2020 2020 6561 6368 206d 7574 6174 696f      each mutatio
-0002fbb0: 6e2e 0a0a 2020 2020 2020 2020 5468 6520  n...        The 
-0002fbc0: 7265 7475 726e 6564 2069 7465 7261 746f  returned iterato
-0002fbd0: 7220 6973 2065 7175 6976 616c 656e 7420  r is equivalent 
-0002fbe0: 746f 2069 7465 7261 7469 6e67 206f 7665  to iterating ove
-0002fbf0: 7220 616c 6c20 7369 7465 730a 2020 2020  r all sites.    
-0002fc00: 2020 2020 616e 6420 616c 6c20 6d75 7461      and all muta
-0002fc10: 7469 6f6e 7320 696e 2065 6163 6820 7369  tions in each si
-0002fc20: 7465 2c20 692e 652e 3a3a 0a0a 2020 2020  te, i.e.::..    
-0002fc30: 2020 2020 2020 2020 3e3e 3e20 666f 7220          >>> for 
-0002fc40: 7369 7465 2069 6e20 7472 6565 5f73 6571  site in tree_seq
-0002fc50: 7565 6e63 652e 7369 7465 7328 293a 0a20  uence.sites():. 
-0002fc60: 2020 2020 2020 2020 2020 203e 3e3e 2020             >>>  
-0002fc70: 2020 2066 6f72 206d 7574 6174 696f 6e20     for mutation 
-0002fc80: 696e 2073 6974 652e 6d75 7461 7469 6f6e  in site.mutation
-0002fc90: 733a 0a20 2020 2020 2020 2020 2020 203e  s:.            >
-0002fca0: 3e3e 2020 2020 2020 2020 2079 6965 6c64  >>         yield
-0002fcb0: 206d 7574 6174 696f 6e0a 0a20 2020 2020   mutation..     
-0002fcc0: 2020 203a 7265 7475 726e 3a20 416e 2069     :return: An i
-0002fcd0: 7465 7261 746f 7220 6f76 6572 2061 6c6c  terator over all
-0002fce0: 206d 7574 6174 696f 6e73 2069 6e20 7468   mutations in th
-0002fcf0: 6973 2074 7265 6520 7365 7175 656e 6365  is tree sequence
-0002fd00: 2e0a 2020 2020 2020 2020 3a72 7479 7065  ..        :rtype
-0002fd10: 3a20 6974 6572 283a 636c 6173 733a 604d  : iter(:class:`M
-0002fd20: 7574 6174 696f 6e60 290a 2020 2020 2020  utation`).      
-0002fd30: 2020 2222 220a 2020 2020 2020 2020 666f    """.        fo
-0002fd40: 7220 7369 7465 2069 6e20 7365 6c66 2e73  r site in self.s
-0002fd50: 6974 6573 2829 3a0a 2020 2020 2020 2020  ites():.        
-0002fd60: 2020 2020 7969 656c 6420 6672 6f6d 2073      yield from s
-0002fd70: 6974 652e 6d75 7461 7469 6f6e 730a 0a20  ite.mutations.. 
-0002fd80: 2020 2064 6566 2070 6f70 756c 6174 696f     def populatio
-0002fd90: 6e73 2873 656c 6629 3a0a 2020 2020 2020  ns(self):.      
-0002fda0: 2020 2222 220a 2020 2020 2020 2020 5265    """.        Re
-0002fdb0: 7475 726e 7320 616e 2069 7465 7261 626c  turns an iterabl
-0002fdc0: 6520 7365 7175 656e 6365 206f 6620 616c  e sequence of al
-0002fdd0: 6c20 7468 650a 2020 2020 2020 2020 3a72  l the.        :r
-0002fde0: 6566 3a60 706f 7075 6c61 7469 6f6e 7320  ef:`populations 
-0002fdf0: 3c73 6563 5f70 6f70 756c 6174 696f 6e5f  <sec_population_
-0002fe00: 7461 626c 655f 6465 6669 6e69 7469 6f6e  table_definition
-0002fe10: 3e60 2069 6e20 7468 6973 2074 7265 6520  >` in this tree 
-0002fe20: 7365 7175 656e 6365 2e0a 0a20 2020 2020  sequence...     
-0002fe30: 2020 203a 7265 7475 726e 3a20 416e 2069     :return: An i
-0002fe40: 7465 7261 626c 6520 7365 7175 656e 6365  terable sequence
-0002fe50: 206f 6620 616c 6c20 706f 7075 6c61 7469   of all populati
-0002fe60: 6f6e 732e 0a20 2020 2020 2020 203a 7274  ons..        :rt
-0002fe70: 7970 653a 2053 6571 7565 6e63 6528 3a63  ype: Sequence(:c
-0002fe80: 6c61 7373 3a60 2e50 6f70 756c 6174 696f  lass:`.Populatio
-0002fe90: 6e60 290a 2020 2020 2020 2020 2222 220a  n`).        """.
-0002fea0: 2020 2020 2020 2020 7265 7475 726e 2053          return S
-0002feb0: 696d 706c 6543 6f6e 7461 696e 6572 5365  impleContainerSe
-0002fec0: 7175 656e 6365 2873 656c 662e 706f 7075  quence(self.popu
-0002fed0: 6c61 7469 6f6e 2c20 7365 6c66 2e6e 756d  lation, self.num
-0002fee0: 5f70 6f70 756c 6174 696f 6e73 290a 0a20  _populations).. 
-0002fef0: 2020 2064 6566 2070 726f 7665 6e61 6e63     def provenanc
-0002ff00: 6573 2873 656c 6629 3a0a 2020 2020 2020  es(self):.      
-0002ff10: 2020 2222 220a 2020 2020 2020 2020 5265    """.        Re
-0002ff20: 7475 726e 7320 616e 2069 7465 7261 626c  turns an iterabl
-0002ff30: 6520 7365 7175 656e 6365 206f 6620 616c  e sequence of al
-0002ff40: 6c20 7468 650a 2020 2020 2020 2020 3a72  l the.        :r
-0002ff50: 6566 3a60 7072 6f76 656e 616e 6365 7320  ef:`provenances 
-0002ff60: 3c73 6563 5f70 726f 7665 6e61 6e63 655f  <sec_provenance_
-0002ff70: 7461 626c 655f 6465 6669 6e69 7469 6f6e  table_definition
-0002ff80: 3e60 2069 6e20 7468 6973 2074 7265 6520  >` in this tree 
-0002ff90: 7365 7175 656e 6365 2e0a 0a20 2020 2020  sequence...     
-0002ffa0: 2020 203a 7265 7475 726e 3a20 416e 2069     :return: An i
-0002ffb0: 7465 7261 626c 6520 7365 7175 656e 6365  terable sequence
-0002ffc0: 206f 6620 616c 6c20 7072 6f76 656e 616e   of all provenan
-0002ffd0: 6365 732e 0a20 2020 2020 2020 203a 7274  ces..        :rt
-0002ffe0: 7970 653a 2053 6571 7565 6e63 6528 3a63  ype: Sequence(:c
-0002fff0: 6c61 7373 3a60 2e50 726f 7665 6e61 6e63  lass:`.Provenanc
-00030000: 6560 290a 2020 2020 2020 2020 2222 220a  e`).        """.
-00030010: 2020 2020 2020 2020 7265 7475 726e 2053          return S
-00030020: 696d 706c 6543 6f6e 7461 696e 6572 5365  impleContainerSe
-00030030: 7175 656e 6365 2873 656c 662e 7072 6f76  quence(self.prov
-00030040: 656e 616e 6365 2c20 7365 6c66 2e6e 756d  enance, self.num
-00030050: 5f70 726f 7665 6e61 6e63 6573 290a 0a20  _provenances).. 
-00030060: 2020 2064 6566 2062 7265 616b 706f 696e     def breakpoin
-00030070: 7473 2873 656c 662c 2061 735f 6172 7261  ts(self, as_arra
-00030080: 793d 4661 6c73 6529 3a0a 2020 2020 2020  y=False):.      
-00030090: 2020 2222 220a 2020 2020 2020 2020 5265    """.        Re
-000300a0: 7475 726e 7320 7468 6520 6272 6561 6b70  turns the breakp
-000300b0: 6f69 6e74 7320 7468 6174 2073 6570 6172  oints that separ
-000300c0: 6174 6520 7472 6565 7320 616c 6f6e 6720  ate trees along 
-000300d0: 7468 6520 6368 726f 6d6f 736f 6d65 2c20  the chromosome, 
-000300e0: 696e 636c 7564 696e 6720 7468 650a 2020  including the.  
-000300f0: 2020 2020 2020 7477 6f20 6578 7472 656d        two extrem
-00030100: 6520 706f 696e 7473 2030 2061 6e64 204c  e points 0 and L
-00030110: 2e20 5468 6973 2069 7320 6571 7569 7661  . This is equiva
-00030120: 6c65 6e74 2074 6f0a 0a20 2020 2020 2020  lent to..       
-00030130: 203e 3e3e 2069 7465 7228 5b30 5d20 2b20   >>> iter([0] + 
-00030140: 5b74 2e69 6e74 6572 7661 6c2e 7269 6768  [t.interval.righ
-00030150: 7420 666f 7220 7420 696e 2073 656c 662e  t for t in self.
-00030160: 7472 6565 7328 295d 290a 0a20 2020 2020  trees()])..     
-00030170: 2020 2042 7920 6465 6661 756c 7420 7765     By default we
-00030180: 2072 6574 7572 6e20 616e 2069 7465 7261   return an itera
-00030190: 746f 7220 6f76 6572 2074 6865 2062 7265  tor over the bre
-000301a0: 616b 706f 696e 7473 2061 7320 5079 7468  akpoints as Pyth
-000301b0: 6f6e 2066 6c6f 6174 206f 626a 6563 7473  on float objects
-000301c0: 3b0a 2020 2020 2020 2020 6966 2060 6061  ;.        if ``a
-000301d0: 735f 6172 7261 7960 6020 6973 2054 7275  s_array`` is Tru
-000301e0: 6520 7765 2072 6574 7572 6e20 7468 656d  e we return them
-000301f0: 2061 7320 6120 6e75 6d70 7920 6172 7261   as a numpy arra
-00030200: 792e 0a0a 2020 2020 2020 2020 4e6f 7465  y...        Note
-00030210: 2074 6861 7420 7468 6520 6060 6173 5f61   that the ``as_a
-00030220: 7272 6179 6060 2066 6f72 6d20 7769 6c6c  rray`` form will
-00030230: 2062 6520 6d6f 7265 2065 6666 6963 6965   be more efficie
-00030240: 6e74 2061 6e64 2063 6f6e 7665 6e69 656e  nt and convenien
-00030250: 7420 696e 206d 6f73 740a 2020 2020 2020  t in most.      
-00030260: 2020 6361 7365 733b 2074 6865 2064 6566    cases; the def
-00030270: 6175 6c74 2069 7465 7261 746f 7220 6265  ault iterator be
-00030280: 6861 7669 6f75 7220 6973 206d 6169 6e6c  haviour is mainl
-00030290: 7920 6b65 7074 2074 6f20 656e 7375 7265  y kept to ensure
-000302a0: 2063 6f6d 7061 7469 6269 6c69 7479 0a20   compatibility. 
-000302b0: 2020 2020 2020 2077 6974 6820 6578 6973         with exis
-000302c0: 7469 6e67 2063 6f64 652e 0a0a 2020 2020  ting code...    
-000302d0: 2020 2020 3a70 6172 616d 2062 6f6f 6c20      :param bool 
-000302e0: 6173 5f61 7272 6179 3a20 4966 2054 7275  as_array: If Tru
-000302f0: 652c 2072 6574 7572 6e20 7468 6520 6272  e, return the br
-00030300: 6561 6b70 6f69 6e74 7320 6173 2061 206e  eakpoints as a n
-00030310: 756d 7079 2061 7272 6179 2e0a 2020 2020  umpy array..    
-00030320: 2020 2020 3a72 6574 7572 6e3a 2054 6865      :return: The
-00030330: 2062 7265 616b 706f 696e 7473 2064 6566   breakpoints def
-00030340: 696e 6564 2062 7920 7468 6520 7472 6565  ined by the tree
-00030350: 2069 6e74 6572 7661 6c73 2061 6c6f 6e67   intervals along
-00030360: 2074 6865 2073 6571 7565 6e63 652e 0a20   the sequence.. 
-00030370: 2020 2020 2020 203a 7274 7970 653a 2063         :rtype: c
-00030380: 6f6c 6c65 6374 696f 6e73 2e61 6263 2e49  ollections.abc.I
-00030390: 7465 7261 626c 6520 6f72 206e 756d 7079  terable or numpy
-000303a0: 2e6e 6461 7272 6179 0a20 2020 2020 2020  .ndarray.       
-000303b0: 2022 2222 0a20 2020 2020 2020 2062 7265   """.        bre
-000303c0: 616b 706f 696e 7473 203d 2073 656c 662e  akpoints = self.
-000303d0: 6c6c 5f74 7265 655f 7365 7175 656e 6365  ll_tree_sequence
-000303e0: 2e67 6574 5f62 7265 616b 706f 696e 7473  .get_breakpoints
-000303f0: 2829 0a20 2020 2020 2020 2069 6620 6e6f  ().        if no
-00030400: 7420 6173 5f61 7272 6179 3a0a 2020 2020  t as_array:.    
-00030410: 2020 2020 2020 2020 2320 436f 6e76 6572          # Conver
-00030420: 7420 746f 2050 7974 686f 6e20 666c 6f61  t to Python floa
-00030430: 7473 2066 6f72 2062 6163 6b77 6172 6420  ts for backward 
-00030440: 636f 6d70 6174 6962 696c 6974 792e 0a20  compatibility.. 
-00030450: 2020 2020 2020 2020 2020 2062 7265 616b             break
-00030460: 706f 696e 7473 203d 206d 6170 2866 6c6f  points = map(flo
-00030470: 6174 2c20 6272 6561 6b70 6f69 6e74 7329  at, breakpoints)
-00030480: 0a20 2020 2020 2020 2072 6574 7572 6e20  .        return 
-00030490: 6272 6561 6b70 6f69 6e74 730a 0a20 2020  breakpoints..   
-000304a0: 2064 6566 2061 7428 7365 6c66 2c20 706f   def at(self, po
-000304b0: 7369 7469 6f6e 2c20 2a2a 6b77 6172 6773  sition, **kwargs
-000304c0: 293a 0a20 2020 2020 2020 2022 2222 0a20  ):.        """. 
-000304d0: 2020 2020 2020 2052 6574 7572 6e73 2074         Returns t
-000304e0: 6865 2074 7265 6520 636f 7665 7269 6e67  he tree covering
-000304f0: 2074 6865 2073 7065 6369 6669 6564 2067   the specified g
-00030500: 656e 6f6d 6963 206c 6f63 6174 696f 6e2e  enomic location.
-00030510: 2054 6865 2072 6574 7572 6e65 6420 7472   The returned tr
-00030520: 6565 0a20 2020 2020 2020 2077 696c 6c20  ee.        will 
-00030530: 6861 7665 2060 6074 7265 652e 696e 7465  have ``tree.inte
-00030540: 7276 616c 2e6c 6566 7460 6020 3c3d 2060  rval.left`` <= `
-00030550: 6070 6f73 6974 696f 6e60 6020 3c20 6060  `position`` < ``
-00030560: 7472 6565 2e69 6e74 6572 7661 6c2e 7269  tree.interval.ri
-00030570: 6768 7460 602e 0a20 2020 2020 2020 2053  ght``..        S
-00030580: 6565 2061 6c73 6f20 3a6d 6574 683a 6054  ee also :meth:`T
-00030590: 7265 652e 7365 656b 602e 0a0a 2020 2020  ree.seek`...    
-000305a0: 2020 2020 2e2e 2069 6e63 6c75 6465 3a3a      .. include::
-000305b0: 2073 7562 7374 6974 7574 696f 6e73 2f6c   substitutions/l
-000305c0: 696e 6561 725f 7472 6176 6572 7361 6c5f  inear_traversal_
-000305d0: 7761 726e 696e 672e 7273 740a 0a20 2020  warning.rst..   
-000305e0: 2020 2020 203a 7061 7261 6d20 666c 6f61       :param floa
-000305f0: 7420 706f 7369 7469 6f6e 3a20 4120 6765  t position: A ge
-00030600: 6e6f 6d69 6320 6c6f 6361 7469 6f6e 2e0a  nomic location..
-00030610: 2020 2020 2020 2020 3a70 6172 616d 205c          :param \
-00030620: 5c2a 2a6b 7761 7267 733a 2046 7572 7468  \**kwargs: Furth
-00030630: 6572 2061 7267 756d 656e 7473 2075 7365  er arguments use
-00030640: 6420 6173 2070 6172 616d 6574 6572 7320  d as parameters 
-00030650: 7768 656e 2063 6f6e 7374 7275 6374 696e  when constructin
-00030660: 6720 7468 650a 2020 2020 2020 2020 2020  g the.          
-00030670: 2020 7265 7475 726e 6564 203a 636c 6173    returned :clas
-00030680: 733a 6054 7265 6560 2e20 466f 7220 6578  s:`Tree`. For ex
-00030690: 616d 706c 6520 6060 7473 2e61 7428 322e  ample ``ts.at(2.
-000306a0: 352c 2073 616d 706c 655f 6c69 7374 733d  5, sample_lists=
-000306b0: 5472 7565 2960 6020 7769 6c6c 0a20 2020  True)`` will.   
-000306c0: 2020 2020 2020 2020 2072 6573 756c 7420           result 
-000306d0: 696e 2061 203a 636c 6173 733a 6054 7265  in a :class:`Tre
-000306e0: 6560 2063 7265 6174 6564 2077 6974 6820  e` created with 
-000306f0: 6060 7361 6d70 6c65 5f6c 6973 7473 3d54  ``sample_lists=T
-00030700: 7275 6560 602e 0a20 2020 2020 2020 203a  rue``..        :
-00030710: 7265 7475 726e 3a20 4120 6e65 7720 696e  return: A new in
-00030720: 7374 616e 6365 206f 6620 3a63 6c61 7373  stance of :class
-00030730: 3a60 5472 6565 6020 706f 7369 7469 6f6e  :`Tree` position
-00030740: 6564 2074 6f20 636f 7665 7220 7468 6520  ed to cover the 
-00030750: 7370 6563 6966 6965 640a 2020 2020 2020  specified.      
-00030760: 2020 2020 2020 6765 6e6f 6d69 6320 6c6f        genomic lo
-00030770: 6361 7469 6f6e 2e0a 2020 2020 2020 2020  cation..        
-00030780: 3a72 7479 7065 3a20 5472 6565 0a20 2020  :rtype: Tree.   
-00030790: 2020 2020 2022 2222 0a20 2020 2020 2020       """.       
-000307a0: 2074 7265 6520 3d20 5472 6565 2873 656c   tree = Tree(sel
-000307b0: 662c 202a 2a6b 7761 7267 7329 0a20 2020  f, **kwargs).   
-000307c0: 2020 2020 2074 7265 652e 7365 656b 2870       tree.seek(p
-000307d0: 6f73 6974 696f 6e29 0a20 2020 2020 2020  osition).       
-000307e0: 2072 6574 7572 6e20 7472 6565 0a0a 2020   return tree..  
-000307f0: 2020 6465 6620 6174 5f69 6e64 6578 2873    def at_index(s
-00030800: 656c 662c 2069 6e64 6578 2c20 2a2a 6b77  elf, index, **kw
-00030810: 6172 6773 293a 0a20 2020 2020 2020 2022  args):.        "
-00030820: 2222 0a20 2020 2020 2020 2052 6574 7572  "".        Retur
-00030830: 6e73 2074 6865 2074 7265 6520 6174 2074  ns the tree at t
-00030840: 6865 2073 7065 6369 6669 6564 2069 6e64  he specified ind
-00030850: 6578 2e20 5365 6520 616c 736f 203a 6d65  ex. See also :me
-00030860: 7468 3a60 5472 6565 2e73 6565 6b5f 696e  th:`Tree.seek_in
-00030870: 6465 7860 2e0a 0a20 2020 2020 2020 202e  dex`...        .
-00030880: 2e20 696e 636c 7564 653a 3a20 7375 6273  . include:: subs
-00030890: 7469 7475 7469 6f6e 732f 6c69 6e65 6172  titutions/linear
-000308a0: 5f74 7261 7665 7273 616c 5f77 6172 6e69  _traversal_warni
-000308b0: 6e67 2e72 7374 0a0a 2020 2020 2020 2020  ng.rst..        
-000308c0: 3a70 6172 616d 2069 6e74 2069 6e64 6578  :param int index
-000308d0: 3a20 5468 6520 696e 6465 7820 6f66 2074  : The index of t
-000308e0: 6865 2072 6571 7569 7265 6420 7472 6565  he required tree
-000308f0: 2e0a 2020 2020 2020 2020 3a70 6172 616d  ..        :param
-00030900: 205c 5c2a 2a6b 7761 7267 733a 2046 7572   \\**kwargs: Fur
-00030910: 7468 6572 2061 7267 756d 656e 7473 2075  ther arguments u
-00030920: 7365 6420 6173 2070 6172 616d 6574 6572  sed as parameter
-00030930: 7320 7768 656e 2063 6f6e 7374 7275 6374  s when construct
-00030940: 696e 6720 7468 650a 2020 2020 2020 2020  ing the.        
-00030950: 2020 2020 7265 7475 726e 6564 203a 636c      returned :cl
-00030960: 6173 733a 6054 7265 6560 2e20 466f 7220  ass:`Tree`. For 
-00030970: 6578 616d 706c 6520 6060 7473 2e61 745f  example ``ts.at_
-00030980: 696e 6465 7828 342c 2073 616d 706c 655f  index(4, sample_
-00030990: 6c69 7374 733d 5472 7565 2960 600a 2020  lists=True)``.  
-000309a0: 2020 2020 2020 2020 2020 7769 6c6c 2072            will r
-000309b0: 6573 756c 7420 696e 2061 203a 636c 6173  esult in a :clas
-000309c0: 733a 6054 7265 6560 2063 7265 6174 6564  s:`Tree` created
-000309d0: 2077 6974 6820 6060 7361 6d70 6c65 5f6c   with ``sample_l
-000309e0: 6973 7473 3d54 7275 6560 602e 0a20 2020  ists=True``..   
-000309f0: 2020 2020 203a 7265 7475 726e 3a20 4120       :return: A 
-00030a00: 6e65 7720 696e 7374 616e 6365 206f 6620  new instance of 
-00030a10: 3a63 6c61 7373 3a60 5472 6565 6020 706f  :class:`Tree` po
-00030a20: 7369 7469 6f6e 6564 2061 7420 7468 6520  sitioned at the 
-00030a30: 7370 6563 6966 6965 6420 696e 6465 782e  specified index.
-00030a40: 0a20 2020 2020 2020 203a 7274 7970 653a  .        :rtype:
-00030a50: 2054 7265 650a 2020 2020 2020 2020 2222   Tree.        ""
-00030a60: 220a 2020 2020 2020 2020 7472 6565 203d  ".        tree =
-00030a70: 2054 7265 6528 7365 6c66 2c20 2a2a 6b77   Tree(self, **kw
-00030a80: 6172 6773 290a 2020 2020 2020 2020 7472  args).        tr
-00030a90: 6565 2e73 6565 6b5f 696e 6465 7828 696e  ee.seek_index(in
-00030aa0: 6465 7829 0a20 2020 2020 2020 2072 6574  dex).        ret
-00030ab0: 7572 6e20 7472 6565 0a0a 2020 2020 6465  urn tree..    de
-00030ac0: 6620 6669 7273 7428 7365 6c66 2c20 2a2a  f first(self, **
-00030ad0: 6b77 6172 6773 293a 0a20 2020 2020 2020  kwargs):.       
-00030ae0: 2022 2222 0a20 2020 2020 2020 2052 6574   """.        Ret
-00030af0: 7572 6e73 2074 6865 2066 6972 7374 2074  urns the first t
-00030b00: 7265 6520 696e 2074 6869 7320 3a63 6c61  ree in this :cla
-00030b10: 7373 3a60 5472 6565 5365 7175 656e 6365  ss:`TreeSequence
-00030b20: 602e 2054 6f20 6974 6572 6174 6520 6f76  `. To iterate ov
-00030b30: 6572 2061 6c6c 0a20 2020 2020 2020 2074  er all.        t
-00030b40: 7265 6573 2069 6e20 7468 6520 7365 7175  rees in the sequ
-00030b50: 656e 6365 2c20 7573 6520 7468 6520 3a6d  ence, use the :m
-00030b60: 6574 683a 602e 7472 6565 7360 206d 6574  eth:`.trees` met
-00030b70: 686f 642e 0a0a 2020 2020 2020 2020 3a70  hod...        :p
-00030b80: 6172 616d 205c 5c2a 2a6b 7761 7267 733a  aram \\**kwargs:
-00030b90: 2046 7572 7468 6572 2061 7267 756d 656e   Further argumen
-00030ba0: 7473 2075 7365 6420 6173 2070 6172 616d  ts used as param
-00030bb0: 6574 6572 7320 7768 656e 2063 6f6e 7374  eters when const
-00030bc0: 7275 6374 696e 6720 7468 650a 2020 2020  ructing the.    
-00030bd0: 2020 2020 2020 2020 7265 7475 726e 6564          returned
-00030be0: 203a 636c 6173 733a 6054 7265 6560 2e20   :class:`Tree`. 
-00030bf0: 466f 7220 6578 616d 706c 6520 6060 7473  For example ``ts
-00030c00: 2e66 6972 7374 2873 616d 706c 655f 6c69  .first(sample_li
-00030c10: 7374 733d 5472 7565 2960 6020 7769 6c6c  sts=True)`` will
-00030c20: 0a20 2020 2020 2020 2020 2020 2072 6573  .            res
-00030c30: 756c 7420 696e 2061 203a 636c 6173 733a  ult in a :class:
-00030c40: 6054 7265 6560 2063 7265 6174 6564 2077  `Tree` created w
-00030c50: 6974 6820 6060 7361 6d70 6c65 5f6c 6973  ith ``sample_lis
-00030c60: 7473 3d54 7275 6560 602e 0a20 2020 2020  ts=True``..     
-00030c70: 2020 203a 7265 7475 726e 3a20 5468 6520     :return: The 
-00030c80: 6669 7273 7420 7472 6565 2069 6e20 7468  first tree in th
-00030c90: 6973 2074 7265 6520 7365 7175 656e 6365  is tree sequence
-00030ca0: 2e0a 2020 2020 2020 2020 3a72 7479 7065  ..        :rtype
-00030cb0: 3a20 3a63 6c61 7373 3a60 5472 6565 602e  : :class:`Tree`.
-00030cc0: 0a20 2020 2020 2020 2022 2222 0a20 2020  .        """.   
-00030cd0: 2020 2020 2074 7265 6520 3d20 5472 6565       tree = Tree
-00030ce0: 2873 656c 662c 202a 2a6b 7761 7267 7329  (self, **kwargs)
-00030cf0: 0a20 2020 2020 2020 2074 7265 652e 6669  .        tree.fi
-00030d00: 7273 7428 290a 2020 2020 2020 2020 7265  rst().        re
-00030d10: 7475 726e 2074 7265 650a 0a20 2020 2064  turn tree..    d
-00030d20: 6566 206c 6173 7428 7365 6c66 2c20 2a2a  ef last(self, **
-00030d30: 6b77 6172 6773 293a 0a20 2020 2020 2020  kwargs):.       
-00030d40: 2022 2222 0a20 2020 2020 2020 2052 6574   """.        Ret
-00030d50: 7572 6e73 2074 6865 206c 6173 7420 7472  urns the last tr
-00030d60: 6565 2069 6e20 7468 6973 203a 636c 6173  ee in this :clas
-00030d70: 733a 6054 7265 6553 6571 7565 6e63 6560  s:`TreeSequence`
-00030d80: 2e20 546f 2069 7465 7261 7465 206f 7665  . To iterate ove
-00030d90: 7220 616c 6c0a 2020 2020 2020 2020 7472  r all.        tr
-00030da0: 6565 7320 696e 2074 6865 2073 6571 7565  ees in the seque
-00030db0: 6e63 652c 2075 7365 2074 6865 203a 6d65  nce, use the :me
-00030dc0: 7468 3a60 2e74 7265 6573 6020 6d65 7468  th:`.trees` meth
-00030dd0: 6f64 2e0a 0a20 2020 2020 2020 203a 7061  od...        :pa
-00030de0: 7261 6d20 5c5c 2a2a 6b77 6172 6773 3a20  ram \\**kwargs: 
-00030df0: 4675 7274 6865 7220 6172 6775 6d65 6e74  Further argument
-00030e00: 7320 7573 6564 2061 7320 7061 7261 6d65  s used as parame
-00030e10: 7465 7273 2077 6865 6e20 636f 6e73 7472  ters when constr
-00030e20: 7563 7469 6e67 2074 6865 0a20 2020 2020  ucting the.     
-00030e30: 2020 2020 2020 2072 6574 7572 6e65 6420         returned 
-00030e40: 3a63 6c61 7373 3a60 5472 6565 602e 2046  :class:`Tree`. F
-00030e50: 6f72 2065 7861 6d70 6c65 2060 6074 732e  or example ``ts.
-00030e60: 6669 7273 7428 7361 6d70 6c65 5f6c 6973  first(sample_lis
-00030e70: 7473 3d54 7275 6529 6060 2077 696c 6c0a  ts=True)`` will.
-00030e80: 2020 2020 2020 2020 2020 2020 7265 7375              resu
-00030e90: 6c74 2069 6e20 6120 3a63 6c61 7373 3a60  lt in a :class:`
-00030ea0: 5472 6565 6020 6372 6561 7465 6420 7769  Tree` created wi
-00030eb0: 7468 2060 6073 616d 706c 655f 6c69 7374  th ``sample_list
-00030ec0: 733d 5472 7565 6060 2e0a 2020 2020 2020  s=True``..      
-00030ed0: 2020 3a72 6574 7572 6e3a 2054 6865 206c    :return: The l
-00030ee0: 6173 7420 7472 6565 2069 6e20 7468 6973  ast tree in this
-00030ef0: 2074 7265 6520 7365 7175 656e 6365 2e0a   tree sequence..
-00030f00: 2020 2020 2020 2020 3a72 7479 7065 3a20          :rtype: 
-00030f10: 3a63 6c61 7373 3a60 5472 6565 602e 0a20  :class:`Tree`.. 
-00030f20: 2020 2020 2020 2022 2222 0a20 2020 2020         """.     
-00030f30: 2020 2074 7265 6520 3d20 5472 6565 2873     tree = Tree(s
-00030f40: 656c 662c 202a 2a6b 7761 7267 7329 0a20  elf, **kwargs). 
-00030f50: 2020 2020 2020 2074 7265 652e 6c61 7374         tree.last
-00030f60: 2829 0a20 2020 2020 2020 2072 6574 7572  ().        retur
-00030f70: 6e20 7472 6565 0a0a 2020 2020 6465 6620  n tree..    def 
-00030f80: 7472 6565 7328 0a20 2020 2020 2020 2073  trees(.        s
-00030f90: 656c 662c 0a20 2020 2020 2020 2074 7261  elf,.        tra
-00030fa0: 636b 6564 5f73 616d 706c 6573 3d4e 6f6e  cked_samples=Non
-00030fb0: 652c 0a20 2020 2020 2020 202a 2c0a 2020  e,.        *,.  
-00030fc0: 2020 2020 2020 7361 6d70 6c65 5f6c 6973        sample_lis
-00030fd0: 7473 3d46 616c 7365 2c0a 2020 2020 2020  ts=False,.      
-00030fe0: 2020 726f 6f74 5f74 6872 6573 686f 6c64    root_threshold
-00030ff0: 3d31 2c0a 2020 2020 2020 2020 7361 6d70  =1,.        samp
-00031000: 6c65 5f63 6f75 6e74 733d 4e6f 6e65 2c0a  le_counts=None,.
-00031010: 2020 2020 2020 2020 7472 6163 6b65 645f          tracked_
-00031020: 6c65 6176 6573 3d4e 6f6e 652c 0a20 2020  leaves=None,.   
-00031030: 2020 2020 206c 6561 665f 636f 756e 7473       leaf_counts
-00031040: 3d4e 6f6e 652c 0a20 2020 2020 2020 206c  =None,.        l
-00031050: 6561 665f 6c69 7374 733d 4e6f 6e65 2c0a  eaf_lists=None,.
-00031060: 2020 2020 293a 0a20 2020 2020 2020 2022      ):.        "
-00031070: 2222 0a20 2020 2020 2020 2052 6574 7572  "".        Retur
-00031080: 6e73 2061 6e20 6974 6572 6174 6f72 206f  ns an iterator o
-00031090: 7665 7220 7468 6520 7472 6565 7320 696e  ver the trees in
-000310a0: 2074 6869 7320 7472 6565 2073 6571 7565   this tree seque
-000310b0: 6e63 652e 2045 6163 6820 7661 6c75 650a  nce. Each value.
-000310c0: 2020 2020 2020 2020 7265 7475 726e 6564          returned
-000310d0: 2069 6e20 7468 6973 2069 7465 7261 746f   in this iterato
-000310e0: 7220 6973 2061 6e20 696e 7374 616e 6365  r is an instance
-000310f0: 206f 6620 3a63 6c61 7373 3a60 5472 6565   of :class:`Tree
-00031100: 602e 2055 706f 6e0a 2020 2020 2020 2020  `. Upon.        
-00031110: 7375 6363 6573 7366 756c 2074 6572 6d69  successful termi
-00031120: 6e61 7469 6f6e 206f 6620 7468 6520 6974  nation of the it
-00031130: 6572 6174 6f72 2c20 7468 6520 7472 6565  erator, the tree
-00031140: 2077 696c 6c20 6265 2069 6e20 7468 650a   will be in the.
-00031150: 2020 2020 2020 2020 2263 6c65 6172 6564          "cleared
-00031160: 2220 6e75 6c6c 2073 7461 7465 2e0a 0a20  " null state... 
-00031170: 2020 2020 2020 2054 6865 2060 6073 616d         The ``sam
-00031180: 706c 655f 6c69 7374 7360 6020 616e 6420  ple_lists`` and 
-00031190: 6060 7472 6163 6b65 645f 7361 6d70 6c65  ``tracked_sample
-000311a0: 7360 6020 7061 7261 6d65 7465 7273 2061  s`` parameters a
-000311b0: 7265 2070 6173 7365 640a 2020 2020 2020  re passed.      
-000311c0: 2020 746f 2074 6865 203a 636c 6173 733a    to the :class:
-000311d0: 6054 7265 6560 2063 6f6e 7374 7275 6374  `Tree` construct
-000311e0: 6f72 2c20 616e 6420 636f 6e74 726f 6c0a  or, and control.
-000311f0: 2020 2020 2020 2020 7468 6520 6f70 7469          the opti
-00031200: 6f6e 7320 7468 6174 2061 7265 2073 6574  ons that are set
-00031210: 2069 6e20 7468 6520 7265 7475 726e 6564   in the returned
-00031220: 2074 7265 6520 696e 7374 616e 6365 2e0a   tree instance..
-00031230: 0a20 2020 2020 2020 202e 2e20 7761 726e  .        .. warn
-00031240: 696e 673a 3a20 446f 206e 6f74 2073 746f  ing:: Do not sto
-00031250: 7265 2074 6865 2072 6573 756c 7473 206f  re the results o
-00031260: 6620 7468 6973 2069 7465 7261 746f 7220  f this iterator 
-00031270: 696e 2061 206c 6973 7421 0a20 2020 2020  in a list!.     
-00031280: 2020 2020 2020 466f 7220 7065 7266 6f72        For perfor
-00031290: 6d61 6e63 6520 7265 6173 6f6e 732c 2074  mance reasons, t
-000312a0: 6865 2073 616d 6520 756e 6465 726c 7969  he same underlyi
-000312b0: 6e67 206f 626a 6563 7420 6973 2075 7365  ng object is use
-000312c0: 640a 2020 2020 2020 2020 2020 2066 6f72  d.           for
-000312d0: 2065 7665 7279 2074 7265 6520 7265 7475   every tree retu
-000312e0: 726e 6564 2077 6869 6368 2077 696c 6c20  rned which will 
-000312f0: 6d6f 7374 206c 696b 656c 7920 6c65 6164  most likely lead
-00031300: 2074 6f20 756e 6578 7065 6374 6564 0a20   to unexpected. 
-00031310: 2020 2020 2020 2020 2020 6265 6861 7669            behavi
-00031320: 6f75 722e 2049 6620 796f 7520 7769 7368  our. If you wish
-00031330: 2074 6f20 6f62 7461 696e 2061 206c 6973   to obtain a lis
-00031340: 7420 6f66 2074 7265 6573 2069 6e20 6120  t of trees in a 
-00031350: 7472 6565 2073 6571 7565 6e63 650a 2020  tree sequence.  
-00031360: 2020 2020 2020 2020 2070 6c65 6173 6520           please 
-00031370: 7573 6520 6060 7473 2e61 736c 6973 7428  use ``ts.aslist(
-00031380: 2960 6020 696e 7374 6561 642e 0a0a 2020  )`` instead...  
-00031390: 2020 2020 2020 3a70 6172 616d 206c 6973        :param lis
-000313a0: 7420 7472 6163 6b65 645f 7361 6d70 6c65  t tracked_sample
-000313b0: 733a 2054 6865 206c 6973 7420 6f66 2073  s: The list of s
-000313c0: 616d 706c 6573 2074 6f20 6265 2074 7261  amples to be tra
-000313d0: 636b 6564 2061 6e64 0a20 2020 2020 2020  cked and.       
-000313e0: 2020 2020 2063 6f75 6e74 6564 2075 7369       counted usi
-000313f0: 6e67 2074 6865 203a 6d65 7468 3a60 5472  ng the :meth:`Tr
-00031400: 6565 2e6e 756d 5f74 7261 636b 6564 5f73  ee.num_tracked_s
-00031410: 616d 706c 6573 6020 6d65 7468 6f64 2e0a  amples` method..
-00031420: 2020 2020 2020 2020 3a70 6172 616d 2062          :param b
-00031430: 6f6f 6c20 7361 6d70 6c65 5f6c 6973 7473  ool sample_lists
-00031440: 3a20 4966 2054 7275 652c 2070 726f 7669  : If True, provi
-00031450: 6465 206d 6f72 6520 6566 6669 6369 656e  de more efficien
-00031460: 7420 6163 6365 7373 0a20 2020 2020 2020  t access.       
-00031470: 2020 2020 2074 6f20 7468 6520 7361 6d70       to the samp
-00031480: 6c65 7320 6265 6e65 6174 6820 6120 6769  les beneath a gi
-00031490: 7665 6e20 6e6f 6465 2075 7369 6e67 2074  ven node using t
-000314a0: 6865 0a20 2020 2020 2020 2020 2020 203a  he.            :
-000314b0: 6d65 7468 3a60 5472 6565 2e73 616d 706c  meth:`Tree.sampl
-000314c0: 6573 6020 6d65 7468 6f64 2e0a 2020 2020  es` method..    
-000314d0: 2020 2020 3a70 6172 616d 2069 6e74 2072      :param int r
-000314e0: 6f6f 745f 7468 7265 7368 6f6c 643a 2054  oot_threshold: T
-000314f0: 6865 206d 696e 696d 756d 206e 756d 6265  he minimum numbe
-00031500: 7220 6f66 2073 616d 706c 6573 2074 6861  r of samples tha
-00031510: 7420 6120 6e6f 6465 0a20 2020 2020 2020  t a node.       
-00031520: 2020 2020 206d 7573 7420 6265 2061 6e63       must be anc
-00031530: 6573 7472 616c 2074 6f20 666f 7220 6974  estral to for it
-00031540: 2074 6f20 6265 2069 6e20 7468 6520 6c69   to be in the li
-00031550: 7374 206f 6620 726f 6f74 732e 2042 7920  st of roots. By 
-00031560: 6465 6661 756c 740a 2020 2020 2020 2020  default.        
-00031570: 2020 2020 7468 6973 2069 7320 312c 2073      this is 1, s
-00031580: 6f20 7468 6174 2069 736f 6c61 7465 6420  o that isolated 
-00031590: 7361 6d70 6c65 7320 2872 6570 7265 7365  samples (represe
-000315a0: 6e74 696e 6720 6d69 7373 696e 6720 6461  nting missing da
-000315b0: 7461 290a 2020 2020 2020 2020 2020 2020  ta).            
-000315c0: 6172 6520 726f 6f74 732e 2054 6f20 6566  are roots. To ef
-000315d0: 6669 6369 656e 746c 7920 7265 7374 7269  ficiently restri
-000315e0: 6374 2074 6865 2072 6f6f 7473 206f 6620  ct the roots of 
-000315f0: 7468 6520 7472 6565 2074 6f0a 2020 2020  the tree to.    
-00031600: 2020 2020 2020 2020 7468 6f73 6520 7375          those su
-00031610: 6274 656e 6469 6e67 206d 6561 6e69 6e67  btending meaning
-00031620: 6675 6c20 746f 706f 6c6f 6779 2c20 7365  ful topology, se
-00031630: 7420 7468 6973 2074 6f20 322e 2054 6869  t this to 2. Thi
-00031640: 7320 7661 6c75 650a 2020 2020 2020 2020  s value.        
-00031650: 2020 2020 6973 206f 6e6c 7920 7265 6c65      is only rele
-00031660: 7661 6e74 2077 6865 6e20 7472 6565 7320  vant when trees 
-00031670: 6861 7665 206d 756c 7469 706c 6520 726f  have multiple ro
-00031680: 6f74 732e 0a20 2020 2020 2020 203a 7061  ots..        :pa
-00031690: 7261 6d20 626f 6f6c 2073 616d 706c 655f  ram bool sample_
-000316a0: 636f 756e 7473 3a20 4465 7072 6563 6174  counts: Deprecat
-000316b0: 6564 2073 696e 6365 2030 2e32 2e34 2e0a  ed since 0.2.4..
-000316c0: 2020 2020 2020 2020 3a72 6574 7572 6e3a          :return:
-000316d0: 2041 6e20 6974 6572 6174 6f72 206f 7665   An iterator ove
-000316e0: 7220 7468 6520 5472 6565 7320 696e 2074  r the Trees in t
-000316f0: 6869 7320 7472 6565 2073 6571 7565 6e63  his tree sequenc
-00031700: 652e 0a20 2020 2020 2020 203a 7274 7970  e..        :rtyp
-00031710: 653a 2063 6f6c 6c65 6374 696f 6e73 2e61  e: collections.a
-00031720: 6263 2e49 7465 7261 626c 652c 203a 636c  bc.Iterable, :cl
-00031730: 6173 733a 6054 7265 6560 0a20 2020 2020  ass:`Tree`.     
-00031740: 2020 2022 2222 0a20 2020 2020 2020 2023     """.        #
-00031750: 2074 7261 636b 6564 5f6c 6561 7665 732c   tracked_leaves,
-00031760: 206c 6561 665f 636f 756e 7473 2061 6e64   leaf_counts and
-00031770: 206c 6561 665f 6c69 7374 7320 6172 6520   leaf_lists are 
-00031780: 6465 7072 6563 6174 6564 2061 6c69 6173  deprecated alias
-00031790: 6573 0a20 2020 2020 2020 2023 2066 6f72  es.        # for
-000317a0: 2074 7261 636b 6564 5f73 616d 706c 6573   tracked_samples
-000317b0: 2c20 7361 6d70 6c65 5f63 6f75 6e74 7320  , sample_counts 
-000317c0: 616e 6420 7361 6d70 6c65 5f6c 6973 7473  and sample_lists
-000317d0: 2072 6573 7065 6374 6976 656c 792e 0a20   respectively.. 
-000317e0: 2020 2020 2020 2023 2054 6865 7365 2061         # These a
-000317f0: 7265 206c 6566 7420 6f76 6572 2066 726f  re left over fro
-00031800: 6d20 616e 206f 6c64 6572 2076 6572 7369  m an older versi
-00031810: 6f6e 206f 6620 7468 6520 4150 4920 7768  on of the API wh
-00031820: 656e 206c 6561 7665 730a 2020 2020 2020  en leaves.      
-00031830: 2020 2320 616e 6420 7361 6d70 6c65 7320    # and samples 
-00031840: 7765 7265 2073 796e 6f6e 796d 6f75 732e  were synonymous.
-00031850: 0a20 2020 2020 2020 2069 6620 7472 6163  .        if trac
-00031860: 6b65 645f 6c65 6176 6573 2069 7320 6e6f  ked_leaves is no
-00031870: 7420 4e6f 6e65 3a0a 2020 2020 2020 2020  t None:.        
-00031880: 2020 2020 7472 6163 6b65 645f 7361 6d70      tracked_samp
-00031890: 6c65 7320 3d20 7472 6163 6b65 645f 6c65  les = tracked_le
-000318a0: 6176 6573 0a20 2020 2020 2020 2069 6620  aves.        if 
-000318b0: 6c65 6166 5f63 6f75 6e74 7320 6973 206e  leaf_counts is n
-000318c0: 6f74 204e 6f6e 653a 0a20 2020 2020 2020  ot None:.       
-000318d0: 2020 2020 2073 616d 706c 655f 636f 756e       sample_coun
-000318e0: 7473 203d 206c 6561 665f 636f 756e 7473  ts = leaf_counts
-000318f0: 0a20 2020 2020 2020 2069 6620 6c65 6166  .        if leaf
-00031900: 5f6c 6973 7473 2069 7320 6e6f 7420 4e6f  _lists is not No
-00031910: 6e65 3a0a 2020 2020 2020 2020 2020 2020  ne:.            
-00031920: 7361 6d70 6c65 5f6c 6973 7473 203d 206c  sample_lists = l
-00031930: 6561 665f 6c69 7374 730a 2020 2020 2020  eaf_lists.      
-00031940: 2020 7472 6565 203d 2054 7265 6528 0a20    tree = Tree(. 
-00031950: 2020 2020 2020 2020 2020 2073 656c 662c             self,
-00031960: 0a20 2020 2020 2020 2020 2020 2074 7261  .            tra
-00031970: 636b 6564 5f73 616d 706c 6573 3d74 7261  cked_samples=tra
-00031980: 636b 6564 5f73 616d 706c 6573 2c0a 2020  cked_samples,.  
-00031990: 2020 2020 2020 2020 2020 7361 6d70 6c65            sample
-000319a0: 5f6c 6973 7473 3d73 616d 706c 655f 6c69  _lists=sample_li
-000319b0: 7374 732c 0a20 2020 2020 2020 2020 2020  sts,.           
-000319c0: 2072 6f6f 745f 7468 7265 7368 6f6c 643d   root_threshold=
-000319d0: 726f 6f74 5f74 6872 6573 686f 6c64 2c0a  root_threshold,.
-000319e0: 2020 2020 2020 2020 2020 2020 7361 6d70              samp
-000319f0: 6c65 5f63 6f75 6e74 733d 7361 6d70 6c65  le_counts=sample
-00031a00: 5f63 6f75 6e74 732c 0a20 2020 2020 2020  _counts,.       
-00031a10: 2029 0a20 2020 2020 2020 2072 6574 7572   ).        retur
-00031a20: 6e20 5472 6565 4974 6572 6174 6f72 2874  n TreeIterator(t
-00031a30: 7265 6529 0a0a 2020 2020 6465 6620 636f  ree)..    def co
-00031a40: 6974 6572 6174 6528 7365 6c66 2c20 6f74  iterate(self, ot
-00031a50: 6865 722c 202a 2a6b 7761 7267 7329 3a0a  her, **kwargs):.
-00031a60: 2020 2020 2020 2020 2222 220a 2020 2020          """.    
-00031a70: 2020 2020 5265 7475 726e 7320 616e 2069      Returns an i
-00031a80: 7465 7261 746f 7220 6f76 6572 2074 6865  terator over the
-00031a90: 2070 6169 7273 206f 6620 7472 6565 7320   pairs of trees 
-00031aa0: 666f 7220 6561 6368 2064 6973 7469 6e63  for each distinc
-00031ab0: 740a 2020 2020 2020 2020 696e 7465 7276  t.        interv
-00031ac0: 616c 2069 6e20 7468 6520 7370 6563 6966  al in the specif
-00031ad0: 6965 6420 7061 6972 206f 6620 7472 6565  ied pair of tree
-00031ae0: 2073 6571 7565 6e63 6573 2e0a 0a20 2020   sequences...   
-00031af0: 2020 2020 203a 7061 7261 6d20 5472 6565       :param Tree
-00031b00: 5365 7175 656e 6365 206f 7468 6572 3a20  Sequence other: 
-00031b10: 5468 6520 6f74 6865 7220 7472 6565 2073  The other tree s
-00031b20: 6571 7565 6e63 6520 6672 6f6d 2077 6869  equence from whi
-00031b30: 6368 2074 6f20 7461 6b65 2074 7265 6573  ch to take trees
-00031b40: 2e20 5468 650a 2020 2020 2020 2020 2020  . The.          
-00031b50: 2020 7365 7175 656e 6365 206c 656e 6774    sequence lengt
-00031b60: 6820 6d75 7374 2062 6520 7468 6520 7361  h must be the sa
-00031b70: 6d65 2061 7320 7468 6520 6375 7272 656e  me as the curren
-00031b80: 7420 7472 6565 2073 6571 7565 6e63 652e  t tree sequence.
-00031b90: 0a20 2020 2020 2020 203a 7061 7261 6d20  .        :param 
-00031ba0: 5c5c 2a2a 6b77 6172 6773 3a20 4675 7274  \\**kwargs: Furt
-00031bb0: 6865 7220 6e61 6d65 6420 6172 6775 6d65  her named argume
-00031bc0: 6e74 7320 7468 6174 2077 696c 6c20 6265  nts that will be
-00031bd0: 2070 6173 7365 6420 746f 2074 6865 0a20   passed to the. 
-00031be0: 2020 2020 2020 2020 2020 203a 6d65 7468             :meth
-00031bf0: 3a60 2e74 7265 6573 6020 6d65 7468 6f64  :`.trees` method
-00031c00: 2077 6865 6e20 636f 6e73 7472 7563 7469   when constructi
-00031c10: 6e67 2074 6865 2072 6574 7572 6e65 6420  ng the returned 
-00031c20: 7472 6565 732e 0a0a 2020 2020 2020 2020  trees...        
-00031c30: 3a72 6574 7572 6e3a 2041 6e20 6974 6572  :return: An iter
-00031c40: 6174 6f72 2072 6574 7572 6e69 6e67 2073  ator returning s
-00031c50: 7563 6365 7373 6976 6520 7475 706c 6573  uccessive tuples
-00031c60: 206f 6620 7468 6520 666f 726d 0a20 2020   of the form.   
-00031c70: 2020 2020 2020 2020 2060 6028 696e 7465           ``(inte
-00031c80: 7276 616c 2c20 7472 6565 5f73 656c 662c  rval, tree_self,
-00031c90: 2074 7265 655f 6f74 6865 7229 6060 2e20   tree_other)``. 
-00031ca0: 466f 7220 6578 616d 706c 652c 2074 6865  For example, the
-00031cb0: 2066 6972 7374 2069 7465 6d20 7265 7475   first item retu
-00031cc0: 726e 6564 0a20 2020 2020 2020 2020 2020  rned.           
-00031cd0: 2077 696c 6c20 636f 6e73 6973 7420 6f66   will consist of
-00031ce0: 2061 6e20 7475 706c 6520 6f66 2074 6865   an tuple of the
-00031cf0: 2069 6e69 7469 616c 2069 6e74 6572 7661   initial interva
-00031d00: 6c2c 2074 6865 2066 6972 7374 2074 7265  l, the first tre
-00031d10: 6520 6f66 2074 6865 0a20 2020 2020 2020  e of the.       
-00031d20: 2020 2020 2063 7572 7265 6e74 2074 7265       current tre
-00031d30: 6520 7365 7175 656e 6365 2c20 616e 6420  e sequence, and 
-00031d40: 7468 6520 6669 7273 7420 7472 6565 206f  the first tree o
-00031d50: 6620 7468 6520 6060 6f74 6865 7260 6020  f the ``other`` 
-00031d60: 7472 6565 2073 6571 7565 6e63 653b 0a20  tree sequence;. 
-00031d70: 2020 2020 2020 2020 2020 2074 6865 2060             the `
-00031d80: 602e 6c65 6674 6060 2061 7474 7269 6275  `.left`` attribu
-00031d90: 7465 206f 6620 7468 6520 696e 6974 6961  te of the initia
-00031da0: 6c20 696e 7465 7276 616c 2077 696c 6c20  l interval will 
-00031db0: 6265 2030 2061 6e64 2074 6865 2060 602e  be 0 and the ``.
-00031dc0: 7269 6768 7460 600a 2020 2020 2020 2020  right``.        
-00031dd0: 2020 2020 6174 7472 6962 7574 6520 7769      attribute wi
-00031de0: 6c6c 2062 6520 7468 6520 736d 616c 6c65  ll be the smalle
-00031df0: 7374 206e 6f6e 2d7a 6572 6f20 6272 6561  st non-zero brea
-00031e00: 6b70 6f69 6e74 206f 6620 7468 6520 3220  kpoint of the 2 
-00031e10: 7472 6565 2073 6571 7565 6e63 6573 2e0a  tree sequences..
-00031e20: 2020 2020 2020 2020 3a72 7479 7065 3a20          :rtype: 
-00031e30: 6974 6572 283a 636c 6173 733a 6049 6e74  iter(:class:`Int
-00031e40: 6572 7661 6c60 2c20 3a63 6c61 7373 3a60  erval`, :class:`
-00031e50: 5472 6565 602c 203a 636c 6173 733a 6054  Tree`, :class:`T
-00031e60: 7265 6560 290a 0a20 2020 2020 2020 2022  ree`)..        "
-00031e70: 2222 0a20 2020 2020 2020 2069 6620 7365  "".        if se
-00031e80: 6c66 2e73 6571 7565 6e63 655f 6c65 6e67  lf.sequence_leng
-00031e90: 7468 2021 3d20 6f74 6865 722e 7365 7175  th != other.sequ
-00031ea0: 656e 6365 5f6c 656e 6774 683a 0a20 2020  ence_length:.   
-00031eb0: 2020 2020 2020 2020 2072 6169 7365 2056           raise V
-00031ec0: 616c 7565 4572 726f 7228 2254 7265 6520  alueError("Tree 
-00031ed0: 7365 7175 656e 6365 7320 6d75 7374 2062  sequences must b
-00031ee0: 6520 6f66 2065 7175 616c 2073 6571 7565  e of equal seque
-00031ef0: 6e63 6520 6c65 6e67 7468 2e22 290a 2020  nce length.").  
-00031f00: 2020 2020 2020 4c20 3d20 7365 6c66 2e73        L = self.s
-00031f10: 6571 7565 6e63 655f 6c65 6e67 7468 0a20  equence_length. 
-00031f20: 2020 2020 2020 2074 7265 6573 3120 3d20         trees1 = 
-00031f30: 7365 6c66 2e74 7265 6573 282a 2a6b 7761  self.trees(**kwa
-00031f40: 7267 7329 0a20 2020 2020 2020 2074 7265  rgs).        tre
-00031f50: 6573 3220 3d20 6f74 6865 722e 7472 6565  es2 = other.tree
-00031f60: 7328 2a2a 6b77 6172 6773 290a 2020 2020  s(**kwargs).    
-00031f70: 2020 2020 7472 6565 3120 3d20 6e65 7874      tree1 = next
-00031f80: 2874 7265 6573 3129 0a20 2020 2020 2020  (trees1).       
-00031f90: 2074 7265 6532 203d 206e 6578 7428 7472   tree2 = next(tr
-00031fa0: 6565 7332 290a 2020 2020 2020 2020 7269  ees2).        ri
-00031fb0: 6768 7420 3d20 300a 2020 2020 2020 2020  ght = 0.        
-00031fc0: 7768 696c 6520 7269 6768 7420 213d 204c  while right != L
-00031fd0: 3a0a 2020 2020 2020 2020 2020 2020 6c65  :.            le
-00031fe0: 6674 203d 2072 6967 6874 0a20 2020 2020  ft = right.     
-00031ff0: 2020 2020 2020 2072 6967 6874 203d 206d         right = m
-00032000: 696e 2874 7265 6531 2e69 6e74 6572 7661  in(tree1.interva
-00032010: 6c2e 7269 6768 742c 2074 7265 6532 2e69  l.right, tree2.i
-00032020: 6e74 6572 7661 6c2e 7269 6768 7429 0a20  nterval.right). 
-00032030: 2020 2020 2020 2020 2020 2079 6965 6c64             yield
-00032040: 2049 6e74 6572 7661 6c28 6c65 6674 2c20   Interval(left, 
-00032050: 7269 6768 7429 2c20 7472 6565 312c 2074  right), tree1, t
-00032060: 7265 6532 0a20 2020 2020 2020 2020 2020  ree2.           
-00032070: 2023 2041 6476 616e 6365 0a20 2020 2020   # Advance.     
-00032080: 2020 2020 2020 2069 6620 7472 6565 312e         if tree1.
-00032090: 696e 7465 7276 616c 2e72 6967 6874 203d  interval.right =
-000320a0: 3d20 7269 6768 743a 0a20 2020 2020 2020  = right:.       
-000320b0: 2020 2020 2020 2020 2074 7265 6531 203d           tree1 =
-000320c0: 206e 6578 7428 7472 6565 7331 2c20 4e6f   next(trees1, No
-000320d0: 6e65 290a 2020 2020 2020 2020 2020 2020  ne).            
-000320e0: 6966 2074 7265 6532 2e69 6e74 6572 7661  if tree2.interva
-000320f0: 6c2e 7269 6768 7420 3d3d 2072 6967 6874  l.right == right
-00032100: 3a0a 2020 2020 2020 2020 2020 2020 2020  :.              
-00032110: 2020 7472 6565 3220 3d20 6e65 7874 2874    tree2 = next(t
-00032120: 7265 6573 322c 204e 6f6e 6529 0a0a 2020  rees2, None)..  
-00032130: 2020 6465 6620 5f63 6865 636b 5f67 656e    def _check_gen
-00032140: 6f6d 6963 5f72 616e 6765 2873 656c 662c  omic_range(self,
-00032150: 206c 6566 742c 2072 6967 6874 2c20 656e   left, right, en
-00032160: 7375 7265 5f69 6e74 6567 6572 3d46 616c  sure_integer=Fal
-00032170: 7365 293a 0a20 2020 2020 2020 2069 6620  se):.        if 
-00032180: 6c65 6674 2069 7320 4e6f 6e65 3a0a 2020  left is None:.  
-00032190: 2020 2020 2020 2020 2020 6c65 6674 203d            left =
-000321a0: 2030 0a20 2020 2020 2020 2069 6620 7269   0.        if ri
-000321b0: 6768 7420 6973 204e 6f6e 653a 0a20 2020  ght is None:.   
-000321c0: 2020 2020 2020 2020 2072 6967 6874 203d           right =
-000321d0: 2073 656c 662e 7365 7175 656e 6365 5f6c   self.sequence_l
-000321e0: 656e 6774 680a 2020 2020 2020 2020 6966  ength.        if
-000321f0: 206e 702e 6973 6e61 6e28 6c65 6674 2920   np.isnan(left) 
-00032200: 6f72 206c 6566 7420 3c20 3020 6f72 206c  or left < 0 or l
-00032210: 6566 7420 3e3d 2073 656c 662e 7365 7175  eft >= self.sequ
-00032220: 656e 6365 5f6c 656e 6774 683a 0a20 2020  ence_length:.   
-00032230: 2020 2020 2020 2020 2072 6169 7365 2056           raise V
-00032240: 616c 7565 4572 726f 7228 0a20 2020 2020  alueError(.     
-00032250: 2020 2020 2020 2020 2020 2022 606c 6566             "`lef
-00032260: 7460 206e 6f74 2062 6574 7765 656e 207a  t` not between z
-00032270: 6572 6f20 2869 6e63 6c75 7369 7665 2920  ero (inclusive) 
-00032280: 616e 6420 7365 7175 656e 6365 206c 656e  and sequence len
-00032290: 6774 6820 2865 7863 6c75 7369 7665 2922  gth (exclusive)"
-000322a0: 0a20 2020 2020 2020 2020 2020 2029 0a20  .            ). 
-000322b0: 2020 2020 2020 2069 6620 6e70 2e69 736e         if np.isn
-000322c0: 616e 2872 6967 6874 2920 6f72 2072 6967  an(right) or rig
-000322d0: 6874 203c 3d20 3020 6f72 2072 6967 6874  ht <= 0 or right
-000322e0: 203e 2073 656c 662e 7365 7175 656e 6365   > self.sequence
-000322f0: 5f6c 656e 6774 683a 0a20 2020 2020 2020  _length:.       
-00032300: 2020 2020 2072 6169 7365 2056 616c 7565       raise Value
-00032310: 4572 726f 7228 0a20 2020 2020 2020 2020  Error(.         
-00032320: 2020 2020 2020 2022 6072 6967 6874 6020         "`right` 
-00032330: 6e6f 7420 6265 7477 6565 6e20 7a65 726f  not between zero
-00032340: 2028 6578 636c 7573 6976 6529 2061 6e64   (exclusive) and
-00032350: 2073 6571 7565 6e63 6520 6c65 6e67 7468   sequence length
-00032360: 2028 696e 636c 7573 6976 6529 220a 2020   (inclusive)".  
-00032370: 2020 2020 2020 2020 2020 290a 2020 2020            ).    
-00032380: 2020 2020 6966 206c 6566 7420 3e3d 2072      if left >= r
-00032390: 6967 6874 3a0a 2020 2020 2020 2020 2020  ight:.          
-000323a0: 2020 7261 6973 6520 5661 6c75 6545 7272    raise ValueErr
-000323b0: 6f72 2822 606c 6566 7460 206d 7573 7420  or("`left` must 
-000323c0: 6265 206c 6573 7320 7468 616e 2060 7269  be less than `ri
-000323d0: 6768 7460 2229 0a20 2020 2020 2020 2069  ght`").        i
-000323e0: 6620 656e 7375 7265 5f69 6e74 6567 6572  f ensure_integer
-000323f0: 3a0a 2020 2020 2020 2020 2020 2020 6966  :.            if
-00032400: 206c 6566 7420 213d 2069 6e74 286c 6566   left != int(lef
-00032410: 7429 206f 7220 7269 6768 7420 213d 2069  t) or right != i
-00032420: 6e74 2872 6967 6874 293a 0a20 2020 2020  nt(right):.     
-00032430: 2020 2020 2020 2020 2020 2072 6169 7365             raise
-00032440: 2056 616c 7565 4572 726f 7228 2260 6c65   ValueError("`le
-00032450: 6674 6020 616e 6420 6072 6967 6874 6020  ft` and `right` 
-00032460: 6d75 7374 2062 6520 696e 7465 6765 7273  must be integers
-00032470: 2229 0a20 2020 2020 2020 2020 2020 2072  ").            r
-00032480: 6574 7572 6e20 496e 7465 7276 616c 2869  eturn Interval(i
-00032490: 6e74 286c 6566 7429 2c20 696e 7428 7269  nt(left), int(ri
-000324a0: 6768 7429 290a 2020 2020 2020 2020 7265  ght)).        re
-000324b0: 7475 726e 2049 6e74 6572 7661 6c28 6c65  turn Interval(le
-000324c0: 6674 2c20 7269 6768 7429 0a0a 2020 2020  ft, right)..    
-000324d0: 6465 6620 5f68 6170 6c6f 7479 7065 735f  def _haplotypes_
-000324e0: 6172 7261 7928 0a20 2020 2020 2020 2073  array(.        s
-000324f0: 656c 662c 0a20 2020 2020 2020 202a 2c0a  elf,.        *,.
-00032500: 2020 2020 2020 2020 696e 7465 7276 616c          interval
-00032510: 2c0a 2020 2020 2020 2020 6973 6f6c 6174  ,.        isolat
-00032520: 6564 5f61 735f 6d69 7373 696e 673d 4e6f  ed_as_missing=No
-00032530: 6e65 2c0a 2020 2020 2020 2020 6d69 7373  ne,.        miss
-00032540: 696e 675f 6461 7461 5f63 6861 7261 6374  ing_data_charact
-00032550: 6572 3d4e 6f6e 652c 0a20 2020 2020 2020  er=None,.       
-00032560: 2073 616d 706c 6573 3d4e 6f6e 652c 0a20   samples=None,. 
-00032570: 2020 2029 3a0a 2020 2020 2020 2020 2320     ):.        # 
-00032580: 7265 7475 726e 2061 6e20 6172 7261 7920  return an array 
-00032590: 6f66 2068 6170 6c6f 7479 7065 7320 616e  of haplotypes an
-000325a0: 6420 7468 6520 6669 7273 7420 616e 6420  d the first and 
-000325b0: 6c61 7374 2073 6974 6520 706f 7369 7469  last site positi
-000325c0: 6f6e 730a 2020 2020 2020 2020 6966 206d  ons.        if m
-000325d0: 6973 7369 6e67 5f64 6174 615f 6368 6172  issing_data_char
-000325e0: 6163 7465 7220 6973 204e 6f6e 653a 0a20  acter is None:. 
-000325f0: 2020 2020 2020 2020 2020 206d 6973 7369             missi
-00032600: 6e67 5f64 6174 615f 6368 6172 6163 7465  ng_data_characte
-00032610: 7220 3d20 224e 220a 0a20 2020 2020 2020  r = "N"..       
-00032620: 2073 7461 7274 5f73 6974 652c 2073 746f   start_site, sto
-00032630: 705f 7369 7465 203d 206e 702e 7365 6172  p_site = np.sear
-00032640: 6368 736f 7274 6564 2873 656c 662e 7369  chsorted(self.si
-00032650: 7465 735f 706f 7369 7469 6f6e 2c20 696e  tes_position, in
-00032660: 7465 7276 616c 290a 2020 2020 2020 2020  terval).        
-00032670: 4820 3d20 6e70 2e65 6d70 7479 280a 2020  H = np.empty(.  
-00032680: 2020 2020 2020 2020 2020 280a 2020 2020            (.    
-00032690: 2020 2020 2020 2020 2020 2020 7365 6c66              self
-000326a0: 2e6e 756d 5f73 616d 706c 6573 2069 6620  .num_samples if 
-000326b0: 7361 6d70 6c65 7320 6973 204e 6f6e 6520  samples is None 
-000326c0: 656c 7365 206c 656e 2873 616d 706c 6573  else len(samples
-000326d0: 292c 0a20 2020 2020 2020 2020 2020 2020  ),.             
-000326e0: 2020 2073 746f 705f 7369 7465 202d 2073     stop_site - s
-000326f0: 7461 7274 5f73 6974 652c 0a20 2020 2020  tart_site,.     
-00032700: 2020 2020 2020 2029 2c0a 2020 2020 2020         ),.      
-00032710: 2020 2020 2020 6474 7970 653d 6e70 2e69        dtype=np.i
-00032720: 6e74 382c 0a20 2020 2020 2020 2029 0a20  nt8,.        ). 
-00032730: 2020 2020 2020 206d 6973 7369 6e67 5f69         missing_i
-00032740: 6e74 3820 3d20 6f72 6428 6d69 7373 696e  nt8 = ord(missin
-00032750: 675f 6461 7461 5f63 6861 7261 6374 6572  g_data_character
-00032760: 2e65 6e63 6f64 6528 2261 7363 6969 2229  .encode("ascii")
-00032770: 290a 2020 2020 2020 2020 666f 7220 7661  ).        for va
-00032780: 7220 696e 2073 656c 662e 7661 7269 616e  r in self.varian
-00032790: 7473 280a 2020 2020 2020 2020 2020 2020  ts(.            
-000327a0: 7361 6d70 6c65 733d 7361 6d70 6c65 732c  samples=samples,
-000327b0: 0a20 2020 2020 2020 2020 2020 2069 736f  .            iso
-000327c0: 6c61 7465 645f 6173 5f6d 6973 7369 6e67  lated_as_missing
-000327d0: 3d69 736f 6c61 7465 645f 6173 5f6d 6973  =isolated_as_mis
-000327e0: 7369 6e67 2c0a 2020 2020 2020 2020 2020  sing,.          
-000327f0: 2020 6c65 6674 3d69 6e74 6572 7661 6c2e    left=interval.
-00032800: 6c65 6674 2c0a 2020 2020 2020 2020 2020  left,.          
-00032810: 2020 7269 6768 743d 696e 7465 7276 616c    right=interval
-00032820: 2e72 6967 6874 2c0a 2020 2020 2020 2020  .right,.        
-00032830: 293a 0a20 2020 2020 2020 2020 2020 2061  ):.            a
-00032840: 6c6c 656c 6573 203d 206e 702e 6675 6c6c  lleles = np.full
-00032850: 286c 656e 2876 6172 2e61 6c6c 656c 6573  (len(var.alleles
-00032860: 292c 206d 6973 7369 6e67 5f69 6e74 382c  ), missing_int8,
-00032870: 2064 7479 7065 3d6e 702e 696e 7438 290a   dtype=np.int8).
-00032880: 2020 2020 2020 2020 2020 2020 666f 7220              for 
-00032890: 692c 2061 6c6c 656c 6520 696e 2065 6e75  i, allele in enu
-000328a0: 6d65 7261 7465 2876 6172 2e61 6c6c 656c  merate(var.allel
-000328b0: 6573 293a 0a20 2020 2020 2020 2020 2020  es):.           
-000328c0: 2020 2020 2069 6620 616c 6c65 6c65 2069       if allele i
-000328d0: 7320 6e6f 7420 4e6f 6e65 3a0a 2020 2020  s not None:.    
-000328e0: 2020 2020 2020 2020 2020 2020 2020 2020                  
-000328f0: 6966 206c 656e 2861 6c6c 656c 6529 2021  if len(allele) !
-00032900: 3d20 313a 0a20 2020 2020 2020 2020 2020  = 1:.           
-00032910: 2020 2020 2020 2020 2020 2020 2072 6169               rai
-00032920: 7365 2054 7970 6545 7272 6f72 280a 2020  se TypeError(.  
-00032930: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00032940: 2020 2020 2020 2020 2020 224d 756c 7469            "Multi
-00032950: 2d6c 6574 7465 7220 616c 6c65 6c65 206f  -letter allele o
-00032960: 7220 6465 6c65 7469 6f6e 2064 6574 6563  r deletion detec
-00032970: 7465 6420 6174 2073 6974 6520 7b7d 222e  ted at site {}".
-00032980: 666f 726d 6174 280a 2020 2020 2020 2020  format(.        
-00032990: 2020 2020 2020 2020 2020 2020 2020 2020                  
-000329a0: 2020 2020 2020 2020 7661 722e 7369 7465          var.site
-000329b0: 2e69 640a 2020 2020 2020 2020 2020 2020  .id.            
-000329c0: 2020 2020 2020 2020 2020 2020 2020 2020                  
-000329d0: 290a 2020 2020 2020 2020 2020 2020 2020  ).              
-000329e0: 2020 2020 2020 2020 2020 290a 2020 2020            ).    
+0002e980: 6564 6765 735f 696e 2e61 7070 656e 6428  edges_in.append(
+0002e990: 0a20 2020 2020 2020 2020 2020 2020 2020  .               
+0002e9a0: 2020 2020 2045 6467 6528 0a20 2020 2020       Edge(.     
+0002e9b0: 2020 2020 2020 2020 2020 2020 2020 2020                  
+0002e9c0: 2020 202a 7365 6c66 2e5f 6c6c 5f74 7265     *self._ll_tre
+0002e9d0: 655f 7365 7175 656e 6365 2e67 6574 5f65  e_sequence.get_e
+0002e9e0: 6467 6528 696e 5f6f 7264 6572 5b6a 5d29  dge(in_order[j])
+0002e9f0: 2c0a 2020 2020 2020 2020 2020 2020 2020  ,.              
+0002ea00: 2020 2020 2020 2020 2020 6964 3d69 6e5f            id=in_
+0002ea10: 6f72 6465 725b 6a5d 2c0a 2020 2020 2020  order[j],.      
+0002ea20: 2020 2020 2020 2020 2020 2020 2020 2020                  
+0002ea30: 2020 6d65 7461 6461 7461 5f64 6563 6f64    metadata_decod
+0002ea40: 6572 3d6d 6574 6164 6174 615f 6465 636f  er=metadata_deco
+0002ea50: 6465 722c 0a20 2020 2020 2020 2020 2020  der,.           
+0002ea60: 2020 2020 2020 2020 2029 0a20 2020 2020           ).     
+0002ea70: 2020 2020 2020 2020 2020 2029 0a20 2020             ).   
+0002ea80: 2020 2020 2020 2020 2020 2020 206a 202d               j -
+0002ea90: 3d20 310a 2020 2020 2020 2020 2020 2020  = 1.            
+0002eaa0: 6c65 6674 203d 2030 0a20 2020 2020 2020  left = 0.       
+0002eab0: 2020 2020 2069 6620 6a20 3e3d 2030 3a0a       if j >= 0:.
+0002eac0: 2020 2020 2020 2020 2020 2020 2020 2020                  
+0002ead0: 6c65 6674 203d 206d 6178 286c 6566 742c  left = max(left,
+0002eae0: 2065 6467 655f 7269 6768 745b 696e 5f6f   edge_right[in_o
+0002eaf0: 7264 6572 5b6a 5d5d 290a 2020 2020 2020  rder[j]]).      
+0002eb00: 2020 2020 2020 6966 206b 203e 3d20 303a        if k >= 0:
+0002eb10: 0a20 2020 2020 2020 2020 2020 2020 2020  .               
+0002eb20: 206c 6566 7420 3d20 6d61 7828 6c65 6674   left = max(left
+0002eb30: 2c20 6564 6765 5f6c 6566 745b 6f75 745f  , edge_left[out_
+0002eb40: 6f72 6465 725b 6b5d 5d29 0a20 2020 2020  order[k]]).     
+0002eb50: 2020 2020 2020 2079 6965 6c64 2045 6467         yield Edg
+0002eb60: 6544 6966 6628 496e 7465 7276 616c 286c  eDiff(Interval(l
+0002eb70: 6566 742c 2072 6967 6874 292c 2065 6467  eft, right), edg
+0002eb80: 6573 5f6f 7574 2c20 6564 6765 735f 696e  es_out, edges_in
+0002eb90: 290a 2020 2020 2020 2020 2020 2020 7269  ).            ri
+0002eba0: 6768 7420 3d20 6c65 6674 0a0a 2020 2020  ght = left..    
+0002ebb0: 2020 2020 6966 2069 6e63 6c75 6465 5f74      if include_t
+0002ebc0: 6572 6d69 6e61 6c3a 0a20 2020 2020 2020  erminal:.       
+0002ebd0: 2020 2020 2065 6467 6573 5f6f 7574 203d       edges_out =
+0002ebe0: 205b 5d0a 2020 2020 2020 2020 2020 2020   [].            
+0002ebf0: 7768 696c 6520 6b20 3e3d 2030 3a0a 2020  while k >= 0:.  
+0002ec00: 2020 2020 2020 2020 2020 2020 2020 6564                ed
+0002ec10: 6765 735f 6f75 742e 6170 7065 6e64 280a  ges_out.append(.
+0002ec20: 2020 2020 2020 2020 2020 2020 2020 2020                  
+0002ec30: 2020 2020 4564 6765 280a 2020 2020 2020      Edge(.      
+0002ec40: 2020 2020 2020 2020 2020 2020 2020 2020                  
+0002ec50: 2020 2a73 656c 662e 5f6c 6c5f 7472 6565    *self._ll_tree
+0002ec60: 5f73 6571 7565 6e63 652e 6765 745f 6564  _sequence.get_ed
+0002ec70: 6765 286f 7574 5f6f 7264 6572 5b6b 5d29  ge(out_order[k])
+0002ec80: 2c0a 2020 2020 2020 2020 2020 2020 2020  ,.              
+0002ec90: 2020 2020 2020 2020 2020 6964 3d6f 7574            id=out
+0002eca0: 5f6f 7264 6572 5b6b 5d2c 0a20 2020 2020  _order[k],.     
+0002ecb0: 2020 2020 2020 2020 2020 2020 2020 2020                  
+0002ecc0: 2020 206d 6574 6164 6174 615f 6465 636f     metadata_deco
+0002ecd0: 6465 723d 6d65 7461 6461 7461 5f64 6563  der=metadata_dec
+0002ece0: 6f64 6572 2c0a 2020 2020 2020 2020 2020  oder,.          
+0002ecf0: 2020 2020 2020 2020 2020 290a 2020 2020            ).    
+0002ed00: 2020 2020 2020 2020 2020 2020 290a 2020              ).  
+0002ed10: 2020 2020 2020 2020 2020 2020 2020 6b20                k 
+0002ed20: 2d3d 2031 0a20 2020 2020 2020 2020 2020  -= 1.           
+0002ed30: 2079 6965 6c64 2045 6467 6544 6966 6628   yield EdgeDiff(
+0002ed40: 496e 7465 7276 616c 286c 6566 742c 2072  Interval(left, r
+0002ed50: 6967 6874 292c 2065 6467 6573 5f6f 7574  ight), edges_out
+0002ed60: 2c20 5b5d 290a 0a20 2020 2064 6566 2065  , [])..    def e
+0002ed70: 6467 655f 6469 6666 7328 7365 6c66 2c20  dge_diffs(self, 
+0002ed80: 696e 636c 7564 655f 7465 726d 696e 616c  include_terminal
+0002ed90: 3d46 616c 7365 2c20 2a2c 2064 6972 6563  =False, *, direc
+0002eda0: 7469 6f6e 3d74 736b 6974 2e46 4f52 5741  tion=tskit.FORWA
+0002edb0: 5244 293a 0a20 2020 2020 2020 2022 2222  RD):.        """
+0002edc0: 0a20 2020 2020 2020 2052 6574 7572 6e73  .        Returns
+0002edd0: 2061 6e20 6974 6572 6174 6f72 206f 7665   an iterator ove
+0002ede0: 7220 616c 6c20 7468 6520 3a72 6566 3a60  r all the :ref:`
+0002edf0: 6564 6765 7320 3c73 6563 5f65 6467 655f  edges <sec_edge_
+0002ee00: 7461 626c 655f 6465 6669 6e69 7469 6f6e  table_definition
+0002ee10: 3e60 2074 6861 740a 2020 2020 2020 2020  >` that.        
+0002ee20: 6172 6520 696e 7365 7274 6564 2061 6e64  are inserted and
+0002ee30: 2072 656d 6f76 6564 2074 6f20 6275 696c   removed to buil
+0002ee40: 6420 7468 6520 7472 6565 7320 6173 2077  d the trees as w
+0002ee50: 6520 6d6f 7665 2066 726f 6d20 6c65 6674  e move from left
+0002ee60: 2d74 6f2d 7269 6768 7420 616c 6f6e 670a  -to-right along.
+0002ee70: 2020 2020 2020 2020 7468 6520 7472 6565          the tree
+0002ee80: 2073 6571 7565 6e63 652e 2045 6163 6820   sequence. Each 
+0002ee90: 6974 6572 6174 696f 6e20 7969 656c 6473  iteration yields
+0002eea0: 2061 206e 616d 6564 2074 7570 6c65 2063   a named tuple c
+0002eeb0: 6f6e 7369 7374 696e 6720 6f66 2033 2076  onsisting of 3 v
+0002eec0: 616c 7565 732c 0a20 2020 2020 2020 2060  alues,.        `
+0002eed0: 6028 696e 7465 7276 616c 2c20 6564 6765  `(interval, edge
+0002eee0: 735f 6f75 742c 2065 6467 6573 5f69 6e29  s_out, edges_in)
+0002eef0: 6060 2e20 5468 6520 6669 7273 7420 7661  ``. The first va
+0002ef00: 6c75 652c 2060 6069 6e74 6572 7661 6c60  lue, ``interval`
+0002ef10: 602c 2069 7320 7468 650a 2020 2020 2020  `, is the.      
+0002ef20: 2020 6765 6e6f 6d69 6320 696e 7465 7276    genomic interv
+0002ef30: 616c 2060 6028 6c65 6674 2c20 7269 6768  al ``(left, righ
+0002ef40: 7429 6060 2063 6f76 6572 6564 2062 7920  t)`` covered by 
+0002ef50: 7468 6520 696e 636f 6d69 6e67 2074 7265  the incoming tre
+0002ef60: 650a 2020 2020 2020 2020 2873 6565 203a  e.        (see :
+0002ef70: 6174 7472 3a60 5472 6565 2e69 6e74 6572  attr:`Tree.inter
+0002ef80: 7661 6c60 292e 2054 6865 2073 6563 6f6e  val`). The secon
+0002ef90: 642c 2060 6065 6467 6573 5f6f 7574 6060  d, ``edges_out``
+0002efa0: 2069 7320 6120 6c69 7374 206f 6620 7468   is a list of th
+0002efb0: 6520 6564 6765 730a 2020 2020 2020 2020  e edges.        
+0002efc0: 7468 6174 2077 6572 6520 6a75 7374 2d72  that were just-r
+0002efd0: 656d 6f76 6564 2074 6f20 6372 6561 7465  emoved to create
+0002efe0: 2074 6865 2074 7265 6520 636f 7665 7269   the tree coveri
+0002eff0: 6e67 2074 6865 2069 6e74 6572 7661 6c0a  ng the interval.
+0002f000: 2020 2020 2020 2020 2868 656e 6365 2060          (hence `
+0002f010: 6065 6467 6573 5f6f 7574 6060 2077 696c  `edges_out`` wil
+0002f020: 6c20 616c 7761 7973 2062 6520 656d 7074  l always be empt
+0002f030: 7920 666f 7220 7468 6520 6669 7273 7420  y for the first 
+0002f040: 7472 6565 292e 2054 6865 206c 6173 7420  tree). The last 
+0002f050: 7661 6c75 652c 0a20 2020 2020 2020 2060  value,.        `
+0002f060: 6065 6467 6573 5f69 6e60 602c 2069 7320  `edges_in``, is 
+0002f070: 6120 6c69 7374 206f 6620 6564 6765 7320  a list of edges 
+0002f080: 7468 6174 2077 6572 6520 6a75 7374 0a20  that were just. 
+0002f090: 2020 2020 2020 2069 6e73 6572 7465 6420         inserted 
+0002f0a0: 746f 2063 6f6e 7374 7275 6374 2074 6865  to construct the
+0002f0b0: 2074 7265 6520 636f 7665 7269 6e67 2074   tree covering t
+0002f0c0: 6865 2063 7572 7265 6e74 2069 6e74 6572  he current inter
+0002f0d0: 7661 6c2e 0a0a 2020 2020 2020 2020 5468  val...        Th
+0002f0e0: 6520 6564 6765 7320 7265 7475 726e 6564  e edges returned
+0002f0f0: 2077 6974 6869 6e20 6561 6368 2060 6065   within each ``e
+0002f100: 6467 6573 5f69 6e60 6020 6c69 7374 2061  dges_in`` list a
+0002f110: 7265 206f 7264 6572 6564 2062 7920 6173  re ordered by as
+0002f120: 6365 6e64 696e 670a 2020 2020 2020 2020  cending.        
+0002f130: 7469 6d65 206f 6620 7468 6520 7061 7265  time of the pare
+0002f140: 6e74 206e 6f64 652c 2074 6865 6e20 6173  nt node, then as
+0002f150: 6365 6e64 696e 6720 7061 7265 6e74 2069  cending parent i
+0002f160: 642c 2074 6865 6e20 6173 6365 6e64 696e  d, then ascendin
+0002f170: 6720 6368 696c 6420 6964 2e0a 2020 2020  g child id..    
+0002f180: 2020 2020 5468 6520 6564 6765 7320 7769      The edges wi
+0002f190: 7468 696e 2065 6163 6820 6060 6564 6765  thin each ``edge
+0002f1a0: 735f 6f75 7460 6020 6c69 7374 2061 7265  s_out`` list are
+0002f1b0: 2074 6865 2072 6576 6572 7365 206f 7264   the reverse ord
+0002f1c0: 6572 2028 652e 672e 0a20 2020 2020 2020  er (e.g..       
+0002f1d0: 2064 6573 6365 6e64 696e 6720 7061 7265   descending pare
+0002f1e0: 6e74 2074 696d 652c 2070 6172 656e 7420  nt time, parent 
+0002f1f0: 6964 2c20 7468 656e 2063 6869 6c64 5f69  id, then child_i
+0002f200: 6429 2e20 5468 6973 206d 6561 6e73 2074  d). This means t
+0002f210: 6861 7420 7769 7468 696e 0a20 2020 2020  hat within.     
+0002f220: 2020 2065 6163 6820 6c69 7374 2c20 6564     each list, ed
+0002f230: 6765 7320 7769 7468 2074 6865 2073 616d  ges with the sam
+0002f240: 6520 7061 7265 6e74 2061 7070 6561 7220  e parent appear 
+0002f250: 636f 6e73 6563 7574 6976 656c 792e 0a0a  consecutively...
+0002f260: 2020 2020 2020 2020 5468 6520 6060 6469          The ``di
+0002f270: 7265 6374 696f 6e60 6020 6172 6775 6d65  rection`` argume
+0002f280: 6e74 2063 616e 2062 6520 7573 6564 2074  nt can be used t
+0002f290: 6f20 636f 6e74 726f 6c20 7768 6574 6865  o control whethe
+0002f2a0: 7220 6469 6666 7320 6172 6520 7072 6f64  r diffs are prod
+0002f2b0: 7563 6564 0a20 2020 2020 2020 2069 6e20  uced.        in 
+0002f2c0: 7468 6520 666f 7277 6172 6420 286c 6566  the forward (lef
+0002f2d0: 742d 746f 2d72 6967 6874 2c20 696e 6372  t-to-right, incr
+0002f2e0: 6561 7369 6e67 2067 656e 6f6d 6520 636f  easing genome co
+0002f2f0: 6f72 6469 6e61 7465 2076 616c 7565 290a  ordinate value).
+0002f300: 2020 2020 2020 2020 6f72 2072 6576 6572          or rever
+0002f310: 7365 2028 7269 6768 742d 746f 2d6c 6566  se (right-to-lef
+0002f320: 742c 2064 6563 7265 6173 696e 6720 6765  t, decreasing ge
+0002f330: 6e6f 6d65 2063 6f6f 7264 696e 6174 6520  nome coordinate 
+0002f340: 7661 6c75 6529 2064 6972 6563 7469 6f6e  value) direction
+0002f350: 2e0a 0a20 2020 2020 2020 203a 7061 7261  ...        :para
+0002f360: 6d20 626f 6f6c 2069 6e63 6c75 6465 5f74  m bool include_t
+0002f370: 6572 6d69 6e61 6c3a 2049 6620 4661 6c73  erminal: If Fals
+0002f380: 6520 2864 6566 6175 6c74 292c 2074 6865  e (default), the
+0002f390: 2069 7465 7261 746f 7220 7465 726d 696e   iterator termin
+0002f3a0: 6174 6573 0a20 2020 2020 2020 2020 2020  ates.           
+0002f3b0: 2061 6674 6572 2074 6865 2066 696e 616c   after the final
+0002f3c0: 2069 6e74 6572 7661 6c20 696e 2074 6865   interval in the
+0002f3d0: 2074 7265 6520 7365 7175 656e 6365 2028   tree sequence (
+0002f3e0: 692e 652e 2c20 6974 2064 6f65 7320 6e6f  i.e., it does no
+0002f3f0: 740a 2020 2020 2020 2020 2020 2020 7265  t.            re
+0002f400: 706f 7274 2061 2066 696e 616c 2072 656d  port a final rem
+0002f410: 6f76 616c 206f 6620 616c 6c20 7265 6d61  oval of all rema
+0002f420: 696e 696e 6720 6564 6765 7329 2c20 616e  ining edges), an
+0002f430: 6420 7468 6520 6e75 6d62 6572 0a20 2020  d the number.   
+0002f440: 2020 2020 2020 2020 206f 6620 6974 6572           of iter
+0002f450: 6174 696f 6e73 2077 696c 6c20 6265 2065  ations will be e
+0002f460: 7175 616c 2074 6f20 7468 6520 6e75 6d62  qual to the numb
+0002f470: 6572 206f 6620 7472 6565 7320 696e 2074  er of trees in t
+0002f480: 6865 2074 7265 650a 2020 2020 2020 2020  he tree.        
+0002f490: 2020 2020 7365 7175 656e 6365 2e20 4966      sequence. If
+0002f4a0: 2054 7275 652c 2061 6e20 6164 6469 7469   True, an additi
+0002f4b0: 6f6e 616c 2069 7465 7261 7469 6f6e 2074  onal iteration t
+0002f4c0: 616b 6573 2070 6c61 6365 2c20 7769 7468  akes place, with
+0002f4d0: 2074 6865 206c 6173 740a 2020 2020 2020   the last.      
+0002f4e0: 2020 2020 2020 6060 6564 6765 735f 6f75        ``edges_ou
+0002f4f0: 7460 6020 7661 6c75 6520 7265 706f 7274  t`` value report
+0002f500: 696e 6720 616c 6c20 7468 6520 6564 6765  ing all the edge
+0002f510: 7320 636f 6e74 6169 6e65 6420 696e 2074  s contained in t
+0002f520: 6865 2066 696e 616c 0a20 2020 2020 2020  he final.       
+0002f530: 2020 2020 2074 7265 6520 2877 6974 6820       tree (with 
+0002f540: 626f 7468 2060 606c 6566 7460 6020 616e  both ``left`` an
+0002f550: 6420 6060 7269 6768 7460 6020 6571 7561  d ``right`` equa
+0002f560: 6c20 746f 2074 6865 2073 6571 7565 6e63  l to the sequenc
+0002f570: 6520 6c65 6e67 7468 292e 0a20 2020 2020  e length)..     
+0002f580: 2020 203a 7061 7261 6d20 696e 7420 6469     :param int di
+0002f590: 7265 6374 696f 6e3a 2054 6865 2064 6972  rection: The dir
+0002f5a0: 6563 7469 6f6e 206f 6620 7472 6176 656c  ection of travel
+0002f5b0: 2061 6c6f 6e67 2074 6865 2073 6571 7565   along the seque
+0002f5c0: 6e63 6520 666f 720a 2020 2020 2020 2020  nce for.        
+0002f5d0: 2020 2020 6469 6666 732e 204d 7573 7420      diffs. Must 
+0002f5e0: 6265 206f 6e65 206f 6620 3a64 6174 613a  be one of :data:
+0002f5f0: 602e 464f 5257 4152 4460 206f 7220 3a64  `.FORWARD` or :d
+0002f600: 6174 613a 602e 5245 5645 5253 4560 2e0a  ata:`.REVERSE`..
+0002f610: 2020 2020 2020 2020 2020 2020 2844 6566              (Def
+0002f620: 6175 6c74 3a20 3a64 6174 613a 602e 464f  ault: :data:`.FO
+0002f630: 5257 4152 4460 292e 0a20 2020 2020 2020  RWARD`)..       
+0002f640: 203a 7265 7475 726e 3a20 416e 2069 7465   :return: An ite
+0002f650: 7261 746f 7220 6f76 6572 2074 6865 2028  rator over the (
+0002f660: 696e 7465 7276 616c 2c20 6564 6765 735f  interval, edges_
+0002f670: 6f75 742c 2065 6467 6573 5f69 6e29 2074  out, edges_in) t
+0002f680: 7570 6c65 732e 2054 6869 730a 2020 2020  uples. This.    
+0002f690: 2020 2020 2020 2020 6973 2061 206e 616d          is a nam
+0002f6a0: 6564 2074 7570 6c65 2c20 736f 2074 6865  ed tuple, so the
+0002f6b0: 2033 2076 616c 7565 7320 6361 6e20 6265   3 values can be
+0002f6c0: 2061 6363 6573 7365 6420 6279 2070 6f73   accessed by pos
+0002f6d0: 6974 696f 6e0a 2020 2020 2020 2020 2020  ition.          
+0002f6e0: 2020 2865 2e67 2e20 6060 7265 7475 726e    (e.g. ``return
+0002f6f0: 6564 5f74 7570 6c65 5b30 5d60 6029 206f  ed_tuple[0]``) o
+0002f700: 7220 6e61 6d65 2028 652e 672e 2060 6072  r name (e.g. ``r
+0002f710: 6574 7572 6e65 645f 7475 706c 652e 696e  eturned_tuple.in
+0002f720: 7465 7276 616c 6060 292e 0a20 2020 2020  terval``)..     
+0002f730: 2020 203a 7274 7970 653a 203a 636c 6173     :rtype: :clas
+0002f740: 733a 6063 6f6c 6c65 6374 696f 6e73 2e61  s:`collections.a
+0002f750: 6263 2e49 7465 7261 626c 6560 0a20 2020  bc.Iterable`.   
+0002f760: 2020 2020 2022 2222 0a20 2020 2020 2020       """.       
+0002f770: 2069 6620 6469 7265 6374 696f 6e20 3d3d   if direction ==
+0002f780: 205f 7473 6b69 742e 464f 5257 4152 443a   _tskit.FORWARD:
+0002f790: 0a20 2020 2020 2020 2020 2020 2072 6574  .            ret
+0002f7a0: 7572 6e20 7365 6c66 2e5f 6564 6765 5f64  urn self._edge_d
+0002f7b0: 6966 6673 5f66 6f72 7761 7264 2869 6e63  iffs_forward(inc
+0002f7c0: 6c75 6465 5f74 6572 6d69 6e61 6c3d 696e  lude_terminal=in
+0002f7d0: 636c 7564 655f 7465 726d 696e 616c 290a  clude_terminal).
+0002f7e0: 2020 2020 2020 2020 656c 6966 2064 6972          elif dir
+0002f7f0: 6563 7469 6f6e 203d 3d20 5f74 736b 6974  ection == _tskit
+0002f800: 2e52 4556 4552 5345 3a0a 2020 2020 2020  .REVERSE:.      
+0002f810: 2020 2020 2020 7265 7475 726e 2073 656c        return sel
+0002f820: 662e 5f65 6467 655f 6469 6666 735f 7265  f._edge_diffs_re
+0002f830: 7665 7273 6528 696e 636c 7564 655f 7465  verse(include_te
+0002f840: 726d 696e 616c 3d69 6e63 6c75 6465 5f74  rminal=include_t
+0002f850: 6572 6d69 6e61 6c29 0a20 2020 2020 2020  erminal).       
+0002f860: 2065 6c73 653a 0a20 2020 2020 2020 2020   else:.         
+0002f870: 2020 2072 6169 7365 2056 616c 7565 4572     raise ValueEr
+0002f880: 726f 7228 2264 6972 6563 7469 6f6e 206d  ror("direction m
+0002f890: 7573 7420 6265 2065 6974 6865 7220 7473  ust be either ts
+0002f8a0: 6b69 742e 464f 5257 4152 4420 6f72 2074  kit.FORWARD or t
+0002f8b0: 736b 6974 2e52 4556 4552 5345 2229 0a0a  skit.REVERSE")..
+0002f8c0: 2020 2020 6465 6620 7369 7465 7328 7365      def sites(se
+0002f8d0: 6c66 293a 0a20 2020 2020 2020 2022 2222  lf):.        """
+0002f8e0: 0a20 2020 2020 2020 2052 6574 7572 6e73  .        Returns
+0002f8f0: 2061 6e20 6974 6572 6162 6c65 2073 6571   an iterable seq
+0002f900: 7565 6e63 6520 6f66 2061 6c6c 2074 6865  uence of all the
+0002f910: 203a 7265 663a 6073 6974 6573 203c 7365   :ref:`sites <se
+0002f920: 635f 7369 7465 5f74 6162 6c65 5f64 6566  c_site_table_def
+0002f930: 696e 6974 696f 6e3e 600a 2020 2020 2020  inition>`.      
+0002f940: 2020 696e 2074 6869 7320 7472 6565 2073    in this tree s
+0002f950: 6571 7565 6e63 652e 2053 6974 6573 2061  equence. Sites a
+0002f960: 7265 2072 6574 7572 6e65 6420 696e 206f  re returned in o
+0002f970: 7264 6572 206f 6620 696e 6372 6561 7369  rder of increasi
+0002f980: 6e67 2049 440a 2020 2020 2020 2020 2861  ng ID.        (a
+0002f990: 6e64 2061 6c73 6f20 706f 7369 7469 6f6e  nd also position
+0002f9a0: 292e 2053 6565 2074 6865 203a 636c 6173  ). See the :clas
+0002f9b0: 733a 6053 6974 6560 2063 6c61 7373 2066  s:`Site` class f
+0002f9c0: 6f72 2064 6574 6169 6c73 206f 6e0a 2020  or details on.  
+0002f9d0: 2020 2020 2020 7468 6520 6176 6169 6c61        the availa
+0002f9e0: 626c 6520 6669 656c 6473 2066 6f72 2065  ble fields for e
+0002f9f0: 6163 6820 7369 7465 2e0a 0a20 2020 2020  ach site...     
+0002fa00: 2020 203a 7265 7475 726e 3a20 416e 2069     :return: An i
+0002fa10: 7465 7261 626c 6520 7365 7175 656e 6365  terable sequence
+0002fa20: 206f 6620 616c 6c20 7369 7465 732e 0a20   of all sites.. 
+0002fa30: 2020 2020 2020 203a 7274 7970 653a 2053         :rtype: S
+0002fa40: 6571 7565 6e63 6528 3a63 6c61 7373 3a60  equence(:class:`
+0002fa50: 2e53 6974 6560 290a 2020 2020 2020 2020  .Site`).        
+0002fa60: 2222 220a 2020 2020 2020 2020 7265 7475  """.        retu
+0002fa70: 726e 2053 696d 706c 6543 6f6e 7461 696e  rn SimpleContain
+0002fa80: 6572 5365 7175 656e 6365 2873 656c 662e  erSequence(self.
+0002fa90: 7369 7465 2c20 7365 6c66 2e6e 756d 5f73  site, self.num_s
+0002faa0: 6974 6573 290a 0a20 2020 2064 6566 206d  ites)..    def m
+0002fab0: 7574 6174 696f 6e73 2873 656c 6629 3a0a  utations(self):.
+0002fac0: 2020 2020 2020 2020 2222 220a 2020 2020          """.    
+0002fad0: 2020 2020 5265 7475 726e 7320 616e 2069      Returns an i
+0002fae0: 7465 7261 746f 7220 6f76 6572 2061 6c6c  terator over all
+0002faf0: 2074 6865 0a20 2020 2020 2020 203a 7265   the.        :re
+0002fb00: 663a 606d 7574 6174 696f 6e73 203c 7365  f:`mutations <se
+0002fb10: 635f 6d75 7461 7469 6f6e 5f74 6162 6c65  c_mutation_table
+0002fb20: 5f64 6566 696e 6974 696f 6e3e 6020 696e  _definition>` in
+0002fb30: 2074 6869 7320 7472 6565 2073 6571 7565   this tree seque
+0002fb40: 6e63 652e 0a20 2020 2020 2020 204d 7574  nce..        Mut
+0002fb50: 6174 696f 6e73 2061 7265 2072 6574 7572  ations are retur
+0002fb60: 6e65 6420 696e 206f 7264 6572 206f 6620  ned in order of 
+0002fb70: 6e6f 6e64 6563 7265 6173 696e 6720 7369  nondecreasing si
+0002fb80: 7465 2049 442e 0a20 2020 2020 2020 2053  te ID..        S
+0002fb90: 6565 2074 6865 203a 636c 6173 733a 604d  ee the :class:`M
+0002fba0: 7574 6174 696f 6e60 2063 6c61 7373 2066  utation` class f
+0002fbb0: 6f72 2064 6574 6169 6c73 206f 6e20 7468  or details on th
+0002fbc0: 6520 6176 6169 6c61 626c 6520 6669 656c  e available fiel
+0002fbd0: 6473 2066 6f72 0a20 2020 2020 2020 2065  ds for.        e
+0002fbe0: 6163 6820 6d75 7461 7469 6f6e 2e0a 0a20  ach mutation... 
+0002fbf0: 2020 2020 2020 2054 6865 2072 6574 7572         The retur
+0002fc00: 6e65 6420 6974 6572 6174 6f72 2069 7320  ned iterator is 
+0002fc10: 6571 7569 7661 6c65 6e74 2074 6f20 6974  equivalent to it
+0002fc20: 6572 6174 696e 6720 6f76 6572 2061 6c6c  erating over all
+0002fc30: 2073 6974 6573 0a20 2020 2020 2020 2061   sites.        a
+0002fc40: 6e64 2061 6c6c 206d 7574 6174 696f 6e73  nd all mutations
+0002fc50: 2069 6e20 6561 6368 2073 6974 652c 2069   in each site, i
+0002fc60: 2e65 2e3a 3a0a 0a20 2020 2020 2020 2020  .e.::..         
+0002fc70: 2020 203e 3e3e 2066 6f72 2073 6974 6520     >>> for site 
+0002fc80: 696e 2074 7265 655f 7365 7175 656e 6365  in tree_sequence
+0002fc90: 2e73 6974 6573 2829 3a0a 2020 2020 2020  .sites():.      
+0002fca0: 2020 2020 2020 3e3e 3e20 2020 2020 666f        >>>     fo
+0002fcb0: 7220 6d75 7461 7469 6f6e 2069 6e20 7369  r mutation in si
+0002fcc0: 7465 2e6d 7574 6174 696f 6e73 3a0a 2020  te.mutations:.  
+0002fcd0: 2020 2020 2020 2020 2020 3e3e 3e20 2020            >>>   
+0002fce0: 2020 2020 2020 7969 656c 6420 6d75 7461        yield muta
+0002fcf0: 7469 6f6e 0a0a 2020 2020 2020 2020 3a72  tion..        :r
+0002fd00: 6574 7572 6e3a 2041 6e20 6974 6572 6174  eturn: An iterat
+0002fd10: 6f72 206f 7665 7220 616c 6c20 6d75 7461  or over all muta
+0002fd20: 7469 6f6e 7320 696e 2074 6869 7320 7472  tions in this tr
+0002fd30: 6565 2073 6571 7565 6e63 652e 0a20 2020  ee sequence..   
+0002fd40: 2020 2020 203a 7274 7970 653a 2069 7465       :rtype: ite
+0002fd50: 7228 3a63 6c61 7373 3a60 4d75 7461 7469  r(:class:`Mutati
+0002fd60: 6f6e 6029 0a20 2020 2020 2020 2022 2222  on`).        """
+0002fd70: 0a20 2020 2020 2020 2066 6f72 2073 6974  .        for sit
+0002fd80: 6520 696e 2073 656c 662e 7369 7465 7328  e in self.sites(
+0002fd90: 293a 0a20 2020 2020 2020 2020 2020 2079  ):.            y
+0002fda0: 6965 6c64 2066 726f 6d20 7369 7465 2e6d  ield from site.m
+0002fdb0: 7574 6174 696f 6e73 0a0a 2020 2020 6465  utations..    de
+0002fdc0: 6620 706f 7075 6c61 7469 6f6e 7328 7365  f populations(se
+0002fdd0: 6c66 293a 0a20 2020 2020 2020 2022 2222  lf):.        """
+0002fde0: 0a20 2020 2020 2020 2052 6574 7572 6e73  .        Returns
+0002fdf0: 2061 6e20 6974 6572 6162 6c65 2073 6571   an iterable seq
+0002fe00: 7565 6e63 6520 6f66 2061 6c6c 2074 6865  uence of all the
+0002fe10: 0a20 2020 2020 2020 203a 7265 663a 6070  .        :ref:`p
+0002fe20: 6f70 756c 6174 696f 6e73 203c 7365 635f  opulations <sec_
+0002fe30: 706f 7075 6c61 7469 6f6e 5f74 6162 6c65  population_table
+0002fe40: 5f64 6566 696e 6974 696f 6e3e 6020 696e  _definition>` in
+0002fe50: 2074 6869 7320 7472 6565 2073 6571 7565   this tree seque
+0002fe60: 6e63 652e 0a0a 2020 2020 2020 2020 3a72  nce...        :r
+0002fe70: 6574 7572 6e3a 2041 6e20 6974 6572 6162  eturn: An iterab
+0002fe80: 6c65 2073 6571 7565 6e63 6520 6f66 2061  le sequence of a
+0002fe90: 6c6c 2070 6f70 756c 6174 696f 6e73 2e0a  ll populations..
+0002fea0: 2020 2020 2020 2020 3a72 7479 7065 3a20          :rtype: 
+0002feb0: 5365 7175 656e 6365 283a 636c 6173 733a  Sequence(:class:
+0002fec0: 602e 506f 7075 6c61 7469 6f6e 6029 0a20  `.Population`). 
+0002fed0: 2020 2020 2020 2022 2222 0a20 2020 2020         """.     
+0002fee0: 2020 2072 6574 7572 6e20 5369 6d70 6c65     return Simple
+0002fef0: 436f 6e74 6169 6e65 7253 6571 7565 6e63  ContainerSequenc
+0002ff00: 6528 7365 6c66 2e70 6f70 756c 6174 696f  e(self.populatio
+0002ff10: 6e2c 2073 656c 662e 6e75 6d5f 706f 7075  n, self.num_popu
+0002ff20: 6c61 7469 6f6e 7329 0a0a 2020 2020 6465  lations)..    de
+0002ff30: 6620 7072 6f76 656e 616e 6365 7328 7365  f provenances(se
+0002ff40: 6c66 293a 0a20 2020 2020 2020 2022 2222  lf):.        """
+0002ff50: 0a20 2020 2020 2020 2052 6574 7572 6e73  .        Returns
+0002ff60: 2061 6e20 6974 6572 6162 6c65 2073 6571   an iterable seq
+0002ff70: 7565 6e63 6520 6f66 2061 6c6c 2074 6865  uence of all the
+0002ff80: 0a20 2020 2020 2020 203a 7265 663a 6070  .        :ref:`p
+0002ff90: 726f 7665 6e61 6e63 6573 203c 7365 635f  rovenances <sec_
+0002ffa0: 7072 6f76 656e 616e 6365 5f74 6162 6c65  provenance_table
+0002ffb0: 5f64 6566 696e 6974 696f 6e3e 6020 696e  _definition>` in
+0002ffc0: 2074 6869 7320 7472 6565 2073 6571 7565   this tree seque
+0002ffd0: 6e63 652e 0a0a 2020 2020 2020 2020 3a72  nce...        :r
+0002ffe0: 6574 7572 6e3a 2041 6e20 6974 6572 6162  eturn: An iterab
+0002fff0: 6c65 2073 6571 7565 6e63 6520 6f66 2061  le sequence of a
+00030000: 6c6c 2070 726f 7665 6e61 6e63 6573 2e0a  ll provenances..
+00030010: 2020 2020 2020 2020 3a72 7479 7065 3a20          :rtype: 
+00030020: 5365 7175 656e 6365 283a 636c 6173 733a  Sequence(:class:
+00030030: 602e 5072 6f76 656e 616e 6365 6029 0a20  `.Provenance`). 
+00030040: 2020 2020 2020 2022 2222 0a20 2020 2020         """.     
+00030050: 2020 2072 6574 7572 6e20 5369 6d70 6c65     return Simple
+00030060: 436f 6e74 6169 6e65 7253 6571 7565 6e63  ContainerSequenc
+00030070: 6528 7365 6c66 2e70 726f 7665 6e61 6e63  e(self.provenanc
+00030080: 652c 2073 656c 662e 6e75 6d5f 7072 6f76  e, self.num_prov
+00030090: 656e 616e 6365 7329 0a0a 2020 2020 6465  enances)..    de
+000300a0: 6620 6272 6561 6b70 6f69 6e74 7328 7365  f breakpoints(se
+000300b0: 6c66 2c20 6173 5f61 7272 6179 3d46 616c  lf, as_array=Fal
+000300c0: 7365 293a 0a20 2020 2020 2020 2022 2222  se):.        """
+000300d0: 0a20 2020 2020 2020 2052 6574 7572 6e73  .        Returns
+000300e0: 2074 6865 2062 7265 616b 706f 696e 7473   the breakpoints
+000300f0: 2074 6861 7420 7365 7061 7261 7465 2074   that separate t
+00030100: 7265 6573 2061 6c6f 6e67 2074 6865 2063  rees along the c
+00030110: 6872 6f6d 6f73 6f6d 652c 2069 6e63 6c75  hromosome, inclu
+00030120: 6469 6e67 2074 6865 0a20 2020 2020 2020  ding the.       
+00030130: 2074 776f 2065 7874 7265 6d65 2070 6f69   two extreme poi
+00030140: 6e74 7320 3020 616e 6420 4c2e 2054 6869  nts 0 and L. Thi
+00030150: 7320 6973 2065 7175 6976 616c 656e 7420  s is equivalent 
+00030160: 746f 0a0a 2020 2020 2020 2020 3e3e 3e20  to..        >>> 
+00030170: 6974 6572 285b 305d 202b 205b 742e 696e  iter([0] + [t.in
+00030180: 7465 7276 616c 2e72 6967 6874 2066 6f72  terval.right for
+00030190: 2074 2069 6e20 7365 6c66 2e74 7265 6573   t in self.trees
+000301a0: 2829 5d29 0a0a 2020 2020 2020 2020 4279  ()])..        By
+000301b0: 2064 6566 6175 6c74 2077 6520 7265 7475   default we retu
+000301c0: 726e 2061 6e20 6974 6572 6174 6f72 206f  rn an iterator o
+000301d0: 7665 7220 7468 6520 6272 6561 6b70 6f69  ver the breakpoi
+000301e0: 6e74 7320 6173 2050 7974 686f 6e20 666c  nts as Python fl
+000301f0: 6f61 7420 6f62 6a65 6374 733b 0a20 2020  oat objects;.   
+00030200: 2020 2020 2069 6620 6060 6173 5f61 7272       if ``as_arr
+00030210: 6179 6060 2069 7320 5472 7565 2077 6520  ay`` is True we 
+00030220: 7265 7475 726e 2074 6865 6d20 6173 2061  return them as a
+00030230: 206e 756d 7079 2061 7272 6179 2e0a 0a20   numpy array... 
+00030240: 2020 2020 2020 204e 6f74 6520 7468 6174         Note that
+00030250: 2074 6865 2060 6061 735f 6172 7261 7960   the ``as_array`
+00030260: 6020 666f 726d 2077 696c 6c20 6265 206d  ` form will be m
+00030270: 6f72 6520 6566 6669 6369 656e 7420 616e  ore efficient an
+00030280: 6420 636f 6e76 656e 6965 6e74 2069 6e20  d convenient in 
+00030290: 6d6f 7374 0a20 2020 2020 2020 2063 6173  most.        cas
+000302a0: 6573 3b20 7468 6520 6465 6661 756c 7420  es; the default 
+000302b0: 6974 6572 6174 6f72 2062 6568 6176 696f  iterator behavio
+000302c0: 7572 2069 7320 6d61 696e 6c79 206b 6570  ur is mainly kep
+000302d0: 7420 746f 2065 6e73 7572 6520 636f 6d70  t to ensure comp
+000302e0: 6174 6962 696c 6974 790a 2020 2020 2020  atibility.      
+000302f0: 2020 7769 7468 2065 7869 7374 696e 6720    with existing 
+00030300: 636f 6465 2e0a 0a20 2020 2020 2020 203a  code...        :
+00030310: 7061 7261 6d20 626f 6f6c 2061 735f 6172  param bool as_ar
+00030320: 7261 793a 2049 6620 5472 7565 2c20 7265  ray: If True, re
+00030330: 7475 726e 2074 6865 2062 7265 616b 706f  turn the breakpo
+00030340: 696e 7473 2061 7320 6120 6e75 6d70 7920  ints as a numpy 
+00030350: 6172 7261 792e 0a20 2020 2020 2020 203a  array..        :
+00030360: 7265 7475 726e 3a20 5468 6520 6272 6561  return: The brea
+00030370: 6b70 6f69 6e74 7320 6465 6669 6e65 6420  kpoints defined 
+00030380: 6279 2074 6865 2074 7265 6520 696e 7465  by the tree inte
+00030390: 7276 616c 7320 616c 6f6e 6720 7468 6520  rvals along the 
+000303a0: 7365 7175 656e 6365 2e0a 2020 2020 2020  sequence..      
+000303b0: 2020 3a72 7479 7065 3a20 636f 6c6c 6563    :rtype: collec
+000303c0: 7469 6f6e 732e 6162 632e 4974 6572 6162  tions.abc.Iterab
+000303d0: 6c65 206f 7220 6e75 6d70 792e 6e64 6172  le or numpy.ndar
+000303e0: 7261 790a 2020 2020 2020 2020 2222 220a  ray.        """.
+000303f0: 2020 2020 2020 2020 6272 6561 6b70 6f69          breakpoi
+00030400: 6e74 7320 3d20 7365 6c66 2e6c 6c5f 7472  nts = self.ll_tr
+00030410: 6565 5f73 6571 7565 6e63 652e 6765 745f  ee_sequence.get_
+00030420: 6272 6561 6b70 6f69 6e74 7328 290a 2020  breakpoints().  
+00030430: 2020 2020 2020 6966 206e 6f74 2061 735f        if not as_
+00030440: 6172 7261 793a 0a20 2020 2020 2020 2020  array:.         
+00030450: 2020 2023 2043 6f6e 7665 7274 2074 6f20     # Convert to 
+00030460: 5079 7468 6f6e 2066 6c6f 6174 7320 666f  Python floats fo
+00030470: 7220 6261 636b 7761 7264 2063 6f6d 7061  r backward compa
+00030480: 7469 6269 6c69 7479 2e0a 2020 2020 2020  tibility..      
+00030490: 2020 2020 2020 6272 6561 6b70 6f69 6e74        breakpoint
+000304a0: 7320 3d20 6d61 7028 666c 6f61 742c 2062  s = map(float, b
+000304b0: 7265 616b 706f 696e 7473 290a 2020 2020  reakpoints).    
+000304c0: 2020 2020 7265 7475 726e 2062 7265 616b      return break
+000304d0: 706f 696e 7473 0a0a 2020 2020 6465 6620  points..    def 
+000304e0: 6174 2873 656c 662c 2070 6f73 6974 696f  at(self, positio
+000304f0: 6e2c 202a 2a6b 7761 7267 7329 3a0a 2020  n, **kwargs):.  
+00030500: 2020 2020 2020 2222 220a 2020 2020 2020        """.      
+00030510: 2020 5265 7475 726e 7320 7468 6520 7472    Returns the tr
+00030520: 6565 2063 6f76 6572 696e 6720 7468 6520  ee covering the 
+00030530: 7370 6563 6966 6965 6420 6765 6e6f 6d69  specified genomi
+00030540: 6320 6c6f 6361 7469 6f6e 2e20 5468 6520  c location. The 
+00030550: 7265 7475 726e 6564 2074 7265 650a 2020  returned tree.  
+00030560: 2020 2020 2020 7769 6c6c 2068 6176 6520        will have 
+00030570: 6060 7472 6565 2e69 6e74 6572 7661 6c2e  ``tree.interval.
+00030580: 6c65 6674 6060 203c 3d20 6060 706f 7369  left`` <= ``posi
+00030590: 7469 6f6e 6060 203c 2060 6074 7265 652e  tion`` < ``tree.
+000305a0: 696e 7465 7276 616c 2e72 6967 6874 6060  interval.right``
+000305b0: 2e0a 2020 2020 2020 2020 5365 6520 616c  ..        See al
+000305c0: 736f 203a 6d65 7468 3a60 5472 6565 2e73  so :meth:`Tree.s
+000305d0: 6565 6b60 2e0a 0a20 2020 2020 2020 202e  eek`...        .
+000305e0: 2e20 696e 636c 7564 653a 3a20 7375 6273  . include:: subs
+000305f0: 7469 7475 7469 6f6e 732f 6c69 6e65 6172  titutions/linear
+00030600: 5f74 7261 7665 7273 616c 5f77 6172 6e69  _traversal_warni
+00030610: 6e67 2e72 7374 0a0a 2020 2020 2020 2020  ng.rst..        
+00030620: 3a70 6172 616d 2066 6c6f 6174 2070 6f73  :param float pos
+00030630: 6974 696f 6e3a 2041 2067 656e 6f6d 6963  ition: A genomic
+00030640: 206c 6f63 6174 696f 6e2e 0a20 2020 2020   location..     
+00030650: 2020 203a 7061 7261 6d20 5c5c 2a2a 6b77     :param \\**kw
+00030660: 6172 6773 3a20 4675 7274 6865 7220 6172  args: Further ar
+00030670: 6775 6d65 6e74 7320 7573 6564 2061 7320  guments used as 
+00030680: 7061 7261 6d65 7465 7273 2077 6865 6e20  parameters when 
+00030690: 636f 6e73 7472 7563 7469 6e67 2074 6865  constructing the
+000306a0: 0a20 2020 2020 2020 2020 2020 2072 6574  .            ret
+000306b0: 7572 6e65 6420 3a63 6c61 7373 3a60 5472  urned :class:`Tr
+000306c0: 6565 602e 2046 6f72 2065 7861 6d70 6c65  ee`. For example
+000306d0: 2060 6074 732e 6174 2832 2e35 2c20 7361   ``ts.at(2.5, sa
+000306e0: 6d70 6c65 5f6c 6973 7473 3d54 7275 6529  mple_lists=True)
+000306f0: 6060 2077 696c 6c0a 2020 2020 2020 2020  `` will.        
+00030700: 2020 2020 7265 7375 6c74 2069 6e20 6120      result in a 
+00030710: 3a63 6c61 7373 3a60 5472 6565 6020 6372  :class:`Tree` cr
+00030720: 6561 7465 6420 7769 7468 2060 6073 616d  eated with ``sam
+00030730: 706c 655f 6c69 7374 733d 5472 7565 6060  ple_lists=True``
+00030740: 2e0a 2020 2020 2020 2020 3a72 6574 7572  ..        :retur
+00030750: 6e3a 2041 206e 6577 2069 6e73 7461 6e63  n: A new instanc
+00030760: 6520 6f66 203a 636c 6173 733a 6054 7265  e of :class:`Tre
+00030770: 6560 2070 6f73 6974 696f 6e65 6420 746f  e` positioned to
+00030780: 2063 6f76 6572 2074 6865 2073 7065 6369   cover the speci
+00030790: 6669 6564 0a20 2020 2020 2020 2020 2020  fied.           
+000307a0: 2067 656e 6f6d 6963 206c 6f63 6174 696f   genomic locatio
+000307b0: 6e2e 0a20 2020 2020 2020 203a 7274 7970  n..        :rtyp
+000307c0: 653a 2054 7265 650a 2020 2020 2020 2020  e: Tree.        
+000307d0: 2222 220a 2020 2020 2020 2020 7472 6565  """.        tree
+000307e0: 203d 2054 7265 6528 7365 6c66 2c20 2a2a   = Tree(self, **
+000307f0: 6b77 6172 6773 290a 2020 2020 2020 2020  kwargs).        
+00030800: 7472 6565 2e73 6565 6b28 706f 7369 7469  tree.seek(positi
+00030810: 6f6e 290a 2020 2020 2020 2020 7265 7475  on).        retu
+00030820: 726e 2074 7265 650a 0a20 2020 2064 6566  rn tree..    def
+00030830: 2061 745f 696e 6465 7828 7365 6c66 2c20   at_index(self, 
+00030840: 696e 6465 782c 202a 2a6b 7761 7267 7329  index, **kwargs)
+00030850: 3a0a 2020 2020 2020 2020 2222 220a 2020  :.        """.  
+00030860: 2020 2020 2020 5265 7475 726e 7320 7468        Returns th
+00030870: 6520 7472 6565 2061 7420 7468 6520 7370  e tree at the sp
+00030880: 6563 6966 6965 6420 696e 6465 782e 2053  ecified index. S
+00030890: 6565 2061 6c73 6f20 3a6d 6574 683a 6054  ee also :meth:`T
+000308a0: 7265 652e 7365 656b 5f69 6e64 6578 602e  ree.seek_index`.
+000308b0: 0a0a 2020 2020 2020 2020 2e2e 2069 6e63  ..        .. inc
+000308c0: 6c75 6465 3a3a 2073 7562 7374 6974 7574  lude:: substitut
+000308d0: 696f 6e73 2f6c 696e 6561 725f 7472 6176  ions/linear_trav
+000308e0: 6572 7361 6c5f 7761 726e 696e 672e 7273  ersal_warning.rs
+000308f0: 740a 0a20 2020 2020 2020 203a 7061 7261  t..        :para
+00030900: 6d20 696e 7420 696e 6465 783a 2054 6865  m int index: The
+00030910: 2069 6e64 6578 206f 6620 7468 6520 7265   index of the re
+00030920: 7175 6972 6564 2074 7265 652e 0a20 2020  quired tree..   
+00030930: 2020 2020 203a 7061 7261 6d20 5c5c 2a2a       :param \\**
+00030940: 6b77 6172 6773 3a20 4675 7274 6865 7220  kwargs: Further 
+00030950: 6172 6775 6d65 6e74 7320 7573 6564 2061  arguments used a
+00030960: 7320 7061 7261 6d65 7465 7273 2077 6865  s parameters whe
+00030970: 6e20 636f 6e73 7472 7563 7469 6e67 2074  n constructing t
+00030980: 6865 0a20 2020 2020 2020 2020 2020 2072  he.            r
+00030990: 6574 7572 6e65 6420 3a63 6c61 7373 3a60  eturned :class:`
+000309a0: 5472 6565 602e 2046 6f72 2065 7861 6d70  Tree`. For examp
+000309b0: 6c65 2060 6074 732e 6174 5f69 6e64 6578  le ``ts.at_index
+000309c0: 2834 2c20 7361 6d70 6c65 5f6c 6973 7473  (4, sample_lists
+000309d0: 3d54 7275 6529 6060 0a20 2020 2020 2020  =True)``.       
+000309e0: 2020 2020 2077 696c 6c20 7265 7375 6c74       will result
+000309f0: 2069 6e20 6120 3a63 6c61 7373 3a60 5472   in a :class:`Tr
+00030a00: 6565 6020 6372 6561 7465 6420 7769 7468  ee` created with
+00030a10: 2060 6073 616d 706c 655f 6c69 7374 733d   ``sample_lists=
+00030a20: 5472 7565 6060 2e0a 2020 2020 2020 2020  True``..        
+00030a30: 3a72 6574 7572 6e3a 2041 206e 6577 2069  :return: A new i
+00030a40: 6e73 7461 6e63 6520 6f66 203a 636c 6173  nstance of :clas
+00030a50: 733a 6054 7265 6560 2070 6f73 6974 696f  s:`Tree` positio
+00030a60: 6e65 6420 6174 2074 6865 2073 7065 6369  ned at the speci
+00030a70: 6669 6564 2069 6e64 6578 2e0a 2020 2020  fied index..    
+00030a80: 2020 2020 3a72 7479 7065 3a20 5472 6565      :rtype: Tree
+00030a90: 0a20 2020 2020 2020 2022 2222 0a20 2020  .        """.   
+00030aa0: 2020 2020 2074 7265 6520 3d20 5472 6565       tree = Tree
+00030ab0: 2873 656c 662c 202a 2a6b 7761 7267 7329  (self, **kwargs)
+00030ac0: 0a20 2020 2020 2020 2074 7265 652e 7365  .        tree.se
+00030ad0: 656b 5f69 6e64 6578 2869 6e64 6578 290a  ek_index(index).
+00030ae0: 2020 2020 2020 2020 7265 7475 726e 2074          return t
+00030af0: 7265 650a 0a20 2020 2064 6566 2066 6972  ree..    def fir
+00030b00: 7374 2873 656c 662c 202a 2a6b 7761 7267  st(self, **kwarg
+00030b10: 7329 3a0a 2020 2020 2020 2020 2222 220a  s):.        """.
+00030b20: 2020 2020 2020 2020 5265 7475 726e 7320          Returns 
+00030b30: 7468 6520 6669 7273 7420 7472 6565 2069  the first tree i
+00030b40: 6e20 7468 6973 203a 636c 6173 733a 6054  n this :class:`T
+00030b50: 7265 6553 6571 7565 6e63 6560 2e20 546f  reeSequence`. To
+00030b60: 2069 7465 7261 7465 206f 7665 7220 616c   iterate over al
+00030b70: 6c0a 2020 2020 2020 2020 7472 6565 7320  l.        trees 
+00030b80: 696e 2074 6865 2073 6571 7565 6e63 652c  in the sequence,
+00030b90: 2075 7365 2074 6865 203a 6d65 7468 3a60   use the :meth:`
+00030ba0: 2e74 7265 6573 6020 6d65 7468 6f64 2e0a  .trees` method..
+00030bb0: 0a20 2020 2020 2020 203a 7061 7261 6d20  .        :param 
+00030bc0: 5c5c 2a2a 6b77 6172 6773 3a20 4675 7274  \\**kwargs: Furt
+00030bd0: 6865 7220 6172 6775 6d65 6e74 7320 7573  her arguments us
+00030be0: 6564 2061 7320 7061 7261 6d65 7465 7273  ed as parameters
+00030bf0: 2077 6865 6e20 636f 6e73 7472 7563 7469   when constructi
+00030c00: 6e67 2074 6865 0a20 2020 2020 2020 2020  ng the.         
+00030c10: 2020 2072 6574 7572 6e65 6420 3a63 6c61     returned :cla
+00030c20: 7373 3a60 5472 6565 602e 2046 6f72 2065  ss:`Tree`. For e
+00030c30: 7861 6d70 6c65 2060 6074 732e 6669 7273  xample ``ts.firs
+00030c40: 7428 7361 6d70 6c65 5f6c 6973 7473 3d54  t(sample_lists=T
+00030c50: 7275 6529 6060 2077 696c 6c0a 2020 2020  rue)`` will.    
+00030c60: 2020 2020 2020 2020 7265 7375 6c74 2069          result i
+00030c70: 6e20 6120 3a63 6c61 7373 3a60 5472 6565  n a :class:`Tree
+00030c80: 6020 6372 6561 7465 6420 7769 7468 2060  ` created with `
+00030c90: 6073 616d 706c 655f 6c69 7374 733d 5472  `sample_lists=Tr
+00030ca0: 7565 6060 2e0a 2020 2020 2020 2020 3a72  ue``..        :r
+00030cb0: 6574 7572 6e3a 2054 6865 2066 6972 7374  eturn: The first
+00030cc0: 2074 7265 6520 696e 2074 6869 7320 7472   tree in this tr
+00030cd0: 6565 2073 6571 7565 6e63 652e 0a20 2020  ee sequence..   
+00030ce0: 2020 2020 203a 7274 7970 653a 203a 636c       :rtype: :cl
+00030cf0: 6173 733a 6054 7265 6560 2e0a 2020 2020  ass:`Tree`..    
+00030d00: 2020 2020 2222 220a 2020 2020 2020 2020      """.        
+00030d10: 7472 6565 203d 2054 7265 6528 7365 6c66  tree = Tree(self
+00030d20: 2c20 2a2a 6b77 6172 6773 290a 2020 2020  , **kwargs).    
+00030d30: 2020 2020 7472 6565 2e66 6972 7374 2829      tree.first()
+00030d40: 0a20 2020 2020 2020 2072 6574 7572 6e20  .        return 
+00030d50: 7472 6565 0a0a 2020 2020 6465 6620 6c61  tree..    def la
+00030d60: 7374 2873 656c 662c 202a 2a6b 7761 7267  st(self, **kwarg
+00030d70: 7329 3a0a 2020 2020 2020 2020 2222 220a  s):.        """.
+00030d80: 2020 2020 2020 2020 5265 7475 726e 7320          Returns 
+00030d90: 7468 6520 6c61 7374 2074 7265 6520 696e  the last tree in
+00030da0: 2074 6869 7320 3a63 6c61 7373 3a60 5472   this :class:`Tr
+00030db0: 6565 5365 7175 656e 6365 602e 2054 6f20  eeSequence`. To 
+00030dc0: 6974 6572 6174 6520 6f76 6572 2061 6c6c  iterate over all
+00030dd0: 0a20 2020 2020 2020 2074 7265 6573 2069  .        trees i
+00030de0: 6e20 7468 6520 7365 7175 656e 6365 2c20  n the sequence, 
+00030df0: 7573 6520 7468 6520 3a6d 6574 683a 602e  use the :meth:`.
+00030e00: 7472 6565 7360 206d 6574 686f 642e 0a0a  trees` method...
+00030e10: 2020 2020 2020 2020 3a70 6172 616d 205c          :param \
+00030e20: 5c2a 2a6b 7761 7267 733a 2046 7572 7468  \**kwargs: Furth
+00030e30: 6572 2061 7267 756d 656e 7473 2075 7365  er arguments use
+00030e40: 6420 6173 2070 6172 616d 6574 6572 7320  d as parameters 
+00030e50: 7768 656e 2063 6f6e 7374 7275 6374 696e  when constructin
+00030e60: 6720 7468 650a 2020 2020 2020 2020 2020  g the.          
+00030e70: 2020 7265 7475 726e 6564 203a 636c 6173    returned :clas
+00030e80: 733a 6054 7265 6560 2e20 466f 7220 6578  s:`Tree`. For ex
+00030e90: 616d 706c 6520 6060 7473 2e66 6972 7374  ample ``ts.first
+00030ea0: 2873 616d 706c 655f 6c69 7374 733d 5472  (sample_lists=Tr
+00030eb0: 7565 2960 6020 7769 6c6c 0a20 2020 2020  ue)`` will.     
+00030ec0: 2020 2020 2020 2072 6573 756c 7420 696e         result in
+00030ed0: 2061 203a 636c 6173 733a 6054 7265 6560   a :class:`Tree`
+00030ee0: 2063 7265 6174 6564 2077 6974 6820 6060   created with ``
+00030ef0: 7361 6d70 6c65 5f6c 6973 7473 3d54 7275  sample_lists=Tru
+00030f00: 6560 602e 0a20 2020 2020 2020 203a 7265  e``..        :re
+00030f10: 7475 726e 3a20 5468 6520 6c61 7374 2074  turn: The last t
+00030f20: 7265 6520 696e 2074 6869 7320 7472 6565  ree in this tree
+00030f30: 2073 6571 7565 6e63 652e 0a20 2020 2020   sequence..     
+00030f40: 2020 203a 7274 7970 653a 203a 636c 6173     :rtype: :clas
+00030f50: 733a 6054 7265 6560 2e0a 2020 2020 2020  s:`Tree`..      
+00030f60: 2020 2222 220a 2020 2020 2020 2020 7472    """.        tr
+00030f70: 6565 203d 2054 7265 6528 7365 6c66 2c20  ee = Tree(self, 
+00030f80: 2a2a 6b77 6172 6773 290a 2020 2020 2020  **kwargs).      
+00030f90: 2020 7472 6565 2e6c 6173 7428 290a 2020    tree.last().  
+00030fa0: 2020 2020 2020 7265 7475 726e 2074 7265        return tre
+00030fb0: 650a 0a20 2020 2064 6566 2074 7265 6573  e..    def trees
+00030fc0: 280a 2020 2020 2020 2020 7365 6c66 2c0a  (.        self,.
+00030fd0: 2020 2020 2020 2020 7472 6163 6b65 645f          tracked_
+00030fe0: 7361 6d70 6c65 733d 4e6f 6e65 2c0a 2020  samples=None,.  
+00030ff0: 2020 2020 2020 2a2c 0a20 2020 2020 2020        *,.       
+00031000: 2073 616d 706c 655f 6c69 7374 733d 4661   sample_lists=Fa
+00031010: 6c73 652c 0a20 2020 2020 2020 2072 6f6f  lse,.        roo
+00031020: 745f 7468 7265 7368 6f6c 643d 312c 0a20  t_threshold=1,. 
+00031030: 2020 2020 2020 2073 616d 706c 655f 636f         sample_co
+00031040: 756e 7473 3d4e 6f6e 652c 0a20 2020 2020  unts=None,.     
+00031050: 2020 2074 7261 636b 6564 5f6c 6561 7665     tracked_leave
+00031060: 733d 4e6f 6e65 2c0a 2020 2020 2020 2020  s=None,.        
+00031070: 6c65 6166 5f63 6f75 6e74 733d 4e6f 6e65  leaf_counts=None
+00031080: 2c0a 2020 2020 2020 2020 6c65 6166 5f6c  ,.        leaf_l
+00031090: 6973 7473 3d4e 6f6e 652c 0a20 2020 2029  ists=None,.    )
+000310a0: 3a0a 2020 2020 2020 2020 2222 220a 2020  :.        """.  
+000310b0: 2020 2020 2020 5265 7475 726e 7320 616e        Returns an
+000310c0: 2069 7465 7261 746f 7220 6f76 6572 2074   iterator over t
+000310d0: 6865 2074 7265 6573 2069 6e20 7468 6973  he trees in this
+000310e0: 2074 7265 6520 7365 7175 656e 6365 2e20   tree sequence. 
+000310f0: 4561 6368 2076 616c 7565 0a20 2020 2020  Each value.     
+00031100: 2020 2072 6574 7572 6e65 6420 696e 2074     returned in t
+00031110: 6869 7320 6974 6572 6174 6f72 2069 7320  his iterator is 
+00031120: 616e 2069 6e73 7461 6e63 6520 6f66 203a  an instance of :
+00031130: 636c 6173 733a 6054 7265 6560 2e20 5570  class:`Tree`. Up
+00031140: 6f6e 0a20 2020 2020 2020 2073 7563 6365  on.        succe
+00031150: 7373 6675 6c20 7465 726d 696e 6174 696f  ssful terminatio
+00031160: 6e20 6f66 2074 6865 2069 7465 7261 746f  n of the iterato
+00031170: 722c 2074 6865 2074 7265 6520 7769 6c6c  r, the tree will
+00031180: 2062 6520 696e 2074 6865 0a20 2020 2020   be in the.     
+00031190: 2020 2022 636c 6561 7265 6422 206e 756c     "cleared" nul
+000311a0: 6c20 7374 6174 652e 0a0a 2020 2020 2020  l state...      
+000311b0: 2020 5468 6520 6060 7361 6d70 6c65 5f6c    The ``sample_l
+000311c0: 6973 7473 6060 2061 6e64 2060 6074 7261  ists`` and ``tra
+000311d0: 636b 6564 5f73 616d 706c 6573 6060 2070  cked_samples`` p
+000311e0: 6172 616d 6574 6572 7320 6172 6520 7061  arameters are pa
+000311f0: 7373 6564 0a20 2020 2020 2020 2074 6f20  ssed.        to 
+00031200: 7468 6520 3a63 6c61 7373 3a60 5472 6565  the :class:`Tree
+00031210: 6020 636f 6e73 7472 7563 746f 722c 2061  ` constructor, a
+00031220: 6e64 2063 6f6e 7472 6f6c 0a20 2020 2020  nd control.     
+00031230: 2020 2074 6865 206f 7074 696f 6e73 2074     the options t
+00031240: 6861 7420 6172 6520 7365 7420 696e 2074  hat are set in t
+00031250: 6865 2072 6574 7572 6e65 6420 7472 6565  he returned tree
+00031260: 2069 6e73 7461 6e63 652e 0a0a 2020 2020   instance...    
+00031270: 2020 2020 2e2e 2077 6172 6e69 6e67 3a3a      .. warning::
+00031280: 2044 6f20 6e6f 7420 7374 6f72 6520 7468   Do not store th
+00031290: 6520 7265 7375 6c74 7320 6f66 2074 6869  e results of thi
+000312a0: 7320 6974 6572 6174 6f72 2069 6e20 6120  s iterator in a 
+000312b0: 6c69 7374 210a 2020 2020 2020 2020 2020  list!.          
+000312c0: 2046 6f72 2070 6572 666f 726d 616e 6365   For performance
+000312d0: 2072 6561 736f 6e73 2c20 7468 6520 7361   reasons, the sa
+000312e0: 6d65 2075 6e64 6572 6c79 696e 6720 6f62  me underlying ob
+000312f0: 6a65 6374 2069 7320 7573 6564 0a20 2020  ject is used.   
+00031300: 2020 2020 2020 2020 666f 7220 6576 6572          for ever
+00031310: 7920 7472 6565 2072 6574 7572 6e65 6420  y tree returned 
+00031320: 7768 6963 6820 7769 6c6c 206d 6f73 7420  which will most 
+00031330: 6c69 6b65 6c79 206c 6561 6420 746f 2075  likely lead to u
+00031340: 6e65 7870 6563 7465 640a 2020 2020 2020  nexpected.      
+00031350: 2020 2020 2062 6568 6176 696f 7572 2e20       behaviour. 
+00031360: 4966 2079 6f75 2077 6973 6820 746f 206f  If you wish to o
+00031370: 6274 6169 6e20 6120 6c69 7374 206f 6620  btain a list of 
+00031380: 7472 6565 7320 696e 2061 2074 7265 6520  trees in a tree 
+00031390: 7365 7175 656e 6365 0a20 2020 2020 2020  sequence.       
+000313a0: 2020 2020 706c 6561 7365 2075 7365 2060      please use `
+000313b0: 6074 732e 6173 6c69 7374 2829 6060 2069  `ts.aslist()`` i
+000313c0: 6e73 7465 6164 2e0a 0a20 2020 2020 2020  nstead...       
+000313d0: 203a 7061 7261 6d20 6c69 7374 2074 7261   :param list tra
+000313e0: 636b 6564 5f73 616d 706c 6573 3a20 5468  cked_samples: Th
+000313f0: 6520 6c69 7374 206f 6620 7361 6d70 6c65  e list of sample
+00031400: 7320 746f 2062 6520 7472 6163 6b65 6420  s to be tracked 
+00031410: 616e 640a 2020 2020 2020 2020 2020 2020  and.            
+00031420: 636f 756e 7465 6420 7573 696e 6720 7468  counted using th
+00031430: 6520 3a6d 6574 683a 6054 7265 652e 6e75  e :meth:`Tree.nu
+00031440: 6d5f 7472 6163 6b65 645f 7361 6d70 6c65  m_tracked_sample
+00031450: 7360 206d 6574 686f 642e 0a20 2020 2020  s` method..     
+00031460: 2020 203a 7061 7261 6d20 626f 6f6c 2073     :param bool s
+00031470: 616d 706c 655f 6c69 7374 733a 2049 6620  ample_lists: If 
+00031480: 5472 7565 2c20 7072 6f76 6964 6520 6d6f  True, provide mo
+00031490: 7265 2065 6666 6963 6965 6e74 2061 6363  re efficient acc
+000314a0: 6573 730a 2020 2020 2020 2020 2020 2020  ess.            
+000314b0: 746f 2074 6865 2073 616d 706c 6573 2062  to the samples b
+000314c0: 656e 6561 7468 2061 2067 6976 656e 206e  eneath a given n
+000314d0: 6f64 6520 7573 696e 6720 7468 650a 2020  ode using the.  
+000314e0: 2020 2020 2020 2020 2020 3a6d 6574 683a            :meth:
+000314f0: 6054 7265 652e 7361 6d70 6c65 7360 206d  `Tree.samples` m
+00031500: 6574 686f 642e 0a20 2020 2020 2020 203a  ethod..        :
+00031510: 7061 7261 6d20 696e 7420 726f 6f74 5f74  param int root_t
+00031520: 6872 6573 686f 6c64 3a20 5468 6520 6d69  hreshold: The mi
+00031530: 6e69 6d75 6d20 6e75 6d62 6572 206f 6620  nimum number of 
+00031540: 7361 6d70 6c65 7320 7468 6174 2061 206e  samples that a n
+00031550: 6f64 650a 2020 2020 2020 2020 2020 2020  ode.            
+00031560: 6d75 7374 2062 6520 616e 6365 7374 7261  must be ancestra
+00031570: 6c20 746f 2066 6f72 2069 7420 746f 2062  l to for it to b
+00031580: 6520 696e 2074 6865 206c 6973 7420 6f66  e in the list of
+00031590: 2072 6f6f 7473 2e20 4279 2064 6566 6175   roots. By defau
+000315a0: 6c74 0a20 2020 2020 2020 2020 2020 2074  lt.            t
+000315b0: 6869 7320 6973 2031 2c20 736f 2074 6861  his is 1, so tha
+000315c0: 7420 6973 6f6c 6174 6564 2073 616d 706c  t isolated sampl
+000315d0: 6573 2028 7265 7072 6573 656e 7469 6e67  es (representing
+000315e0: 206d 6973 7369 6e67 2064 6174 6129 0a20   missing data). 
+000315f0: 2020 2020 2020 2020 2020 2061 7265 2072             are r
+00031600: 6f6f 7473 2e20 546f 2065 6666 6963 6965  oots. To efficie
+00031610: 6e74 6c79 2072 6573 7472 6963 7420 7468  ntly restrict th
+00031620: 6520 726f 6f74 7320 6f66 2074 6865 2074  e roots of the t
+00031630: 7265 6520 746f 0a20 2020 2020 2020 2020  ree to.         
+00031640: 2020 2074 686f 7365 2073 7562 7465 6e64     those subtend
+00031650: 696e 6720 6d65 616e 696e 6766 756c 2074  ing meaningful t
+00031660: 6f70 6f6c 6f67 792c 2073 6574 2074 6869  opology, set thi
+00031670: 7320 746f 2032 2e20 5468 6973 2076 616c  s to 2. This val
+00031680: 7565 0a20 2020 2020 2020 2020 2020 2069  ue.            i
+00031690: 7320 6f6e 6c79 2072 656c 6576 616e 7420  s only relevant 
+000316a0: 7768 656e 2074 7265 6573 2068 6176 6520  when trees have 
+000316b0: 6d75 6c74 6970 6c65 2072 6f6f 7473 2e0a  multiple roots..
+000316c0: 2020 2020 2020 2020 3a70 6172 616d 2062          :param b
+000316d0: 6f6f 6c20 7361 6d70 6c65 5f63 6f75 6e74  ool sample_count
+000316e0: 733a 2044 6570 7265 6361 7465 6420 7369  s: Deprecated si
+000316f0: 6e63 6520 302e 322e 342e 0a20 2020 2020  nce 0.2.4..     
+00031700: 2020 203a 7265 7475 726e 3a20 416e 2069     :return: An i
+00031710: 7465 7261 746f 7220 6f76 6572 2074 6865  terator over the
+00031720: 2054 7265 6573 2069 6e20 7468 6973 2074   Trees in this t
+00031730: 7265 6520 7365 7175 656e 6365 2e0a 2020  ree sequence..  
+00031740: 2020 2020 2020 3a72 7479 7065 3a20 636f        :rtype: co
+00031750: 6c6c 6563 7469 6f6e 732e 6162 632e 4974  llections.abc.It
+00031760: 6572 6162 6c65 2c20 3a63 6c61 7373 3a60  erable, :class:`
+00031770: 5472 6565 600a 2020 2020 2020 2020 2222  Tree`.        ""
+00031780: 220a 2020 2020 2020 2020 2320 7472 6163  ".        # trac
+00031790: 6b65 645f 6c65 6176 6573 2c20 6c65 6166  ked_leaves, leaf
+000317a0: 5f63 6f75 6e74 7320 616e 6420 6c65 6166  _counts and leaf
+000317b0: 5f6c 6973 7473 2061 7265 2064 6570 7265  _lists are depre
+000317c0: 6361 7465 6420 616c 6961 7365 730a 2020  cated aliases.  
+000317d0: 2020 2020 2020 2320 666f 7220 7472 6163        # for trac
+000317e0: 6b65 645f 7361 6d70 6c65 732c 2073 616d  ked_samples, sam
+000317f0: 706c 655f 636f 756e 7473 2061 6e64 2073  ple_counts and s
+00031800: 616d 706c 655f 6c69 7374 7320 7265 7370  ample_lists resp
+00031810: 6563 7469 7665 6c79 2e0a 2020 2020 2020  ectively..      
+00031820: 2020 2320 5468 6573 6520 6172 6520 6c65    # These are le
+00031830: 6674 206f 7665 7220 6672 6f6d 2061 6e20  ft over from an 
+00031840: 6f6c 6465 7220 7665 7273 696f 6e20 6f66  older version of
+00031850: 2074 6865 2041 5049 2077 6865 6e20 6c65   the API when le
+00031860: 6176 6573 0a20 2020 2020 2020 2023 2061  aves.        # a
+00031870: 6e64 2073 616d 706c 6573 2077 6572 6520  nd samples were 
+00031880: 7379 6e6f 6e79 6d6f 7573 2e0a 2020 2020  synonymous..    
+00031890: 2020 2020 6966 2074 7261 636b 6564 5f6c      if tracked_l
+000318a0: 6561 7665 7320 6973 206e 6f74 204e 6f6e  eaves is not Non
+000318b0: 653a 0a20 2020 2020 2020 2020 2020 2074  e:.            t
+000318c0: 7261 636b 6564 5f73 616d 706c 6573 203d  racked_samples =
+000318d0: 2074 7261 636b 6564 5f6c 6561 7665 730a   tracked_leaves.
+000318e0: 2020 2020 2020 2020 6966 206c 6561 665f          if leaf_
+000318f0: 636f 756e 7473 2069 7320 6e6f 7420 4e6f  counts is not No
+00031900: 6e65 3a0a 2020 2020 2020 2020 2020 2020  ne:.            
+00031910: 7361 6d70 6c65 5f63 6f75 6e74 7320 3d20  sample_counts = 
+00031920: 6c65 6166 5f63 6f75 6e74 730a 2020 2020  leaf_counts.    
+00031930: 2020 2020 6966 206c 6561 665f 6c69 7374      if leaf_list
+00031940: 7320 6973 206e 6f74 204e 6f6e 653a 0a20  s is not None:. 
+00031950: 2020 2020 2020 2020 2020 2073 616d 706c             sampl
+00031960: 655f 6c69 7374 7320 3d20 6c65 6166 5f6c  e_lists = leaf_l
+00031970: 6973 7473 0a20 2020 2020 2020 2074 7265  ists.        tre
+00031980: 6520 3d20 5472 6565 280a 2020 2020 2020  e = Tree(.      
+00031990: 2020 2020 2020 7365 6c66 2c0a 2020 2020        self,.    
+000319a0: 2020 2020 2020 2020 7472 6163 6b65 645f          tracked_
+000319b0: 7361 6d70 6c65 733d 7472 6163 6b65 645f  samples=tracked_
+000319c0: 7361 6d70 6c65 732c 0a20 2020 2020 2020  samples,.       
+000319d0: 2020 2020 2073 616d 706c 655f 6c69 7374       sample_list
+000319e0: 733d 7361 6d70 6c65 5f6c 6973 7473 2c0a  s=sample_lists,.
+000319f0: 2020 2020 2020 2020 2020 2020 726f 6f74              root
+00031a00: 5f74 6872 6573 686f 6c64 3d72 6f6f 745f  _threshold=root_
+00031a10: 7468 7265 7368 6f6c 642c 0a20 2020 2020  threshold,.     
+00031a20: 2020 2020 2020 2073 616d 706c 655f 636f         sample_co
+00031a30: 756e 7473 3d73 616d 706c 655f 636f 756e  unts=sample_coun
+00031a40: 7473 2c0a 2020 2020 2020 2020 290a 2020  ts,.        ).  
+00031a50: 2020 2020 2020 7265 7475 726e 2054 7265        return Tre
+00031a60: 6549 7465 7261 746f 7228 7472 6565 290a  eIterator(tree).
+00031a70: 0a20 2020 2064 6566 2063 6f69 7465 7261  .    def coitera
+00031a80: 7465 2873 656c 662c 206f 7468 6572 2c20  te(self, other, 
+00031a90: 2a2a 6b77 6172 6773 293a 0a20 2020 2020  **kwargs):.     
+00031aa0: 2020 2022 2222 0a20 2020 2020 2020 2052     """.        R
+00031ab0: 6574 7572 6e73 2061 6e20 6974 6572 6174  eturns an iterat
+00031ac0: 6f72 206f 7665 7220 7468 6520 7061 6972  or over the pair
+00031ad0: 7320 6f66 2074 7265 6573 2066 6f72 2065  s of trees for e
+00031ae0: 6163 6820 6469 7374 696e 6374 0a20 2020  ach distinct.   
+00031af0: 2020 2020 2069 6e74 6572 7661 6c20 696e       interval in
+00031b00: 2074 6865 2073 7065 6369 6669 6564 2070   the specified p
+00031b10: 6169 7220 6f66 2074 7265 6520 7365 7175  air of tree sequ
+00031b20: 656e 6365 732e 0a0a 2020 2020 2020 2020  ences...        
+00031b30: 3a70 6172 616d 2054 7265 6553 6571 7565  :param TreeSeque
+00031b40: 6e63 6520 6f74 6865 723a 2054 6865 206f  nce other: The o
+00031b50: 7468 6572 2074 7265 6520 7365 7175 656e  ther tree sequen
+00031b60: 6365 2066 726f 6d20 7768 6963 6820 746f  ce from which to
+00031b70: 2074 616b 6520 7472 6565 732e 2054 6865   take trees. The
+00031b80: 0a20 2020 2020 2020 2020 2020 2073 6571  .            seq
+00031b90: 7565 6e63 6520 6c65 6e67 7468 206d 7573  uence length mus
+00031ba0: 7420 6265 2074 6865 2073 616d 6520 6173  t be the same as
+00031bb0: 2074 6865 2063 7572 7265 6e74 2074 7265   the current tre
+00031bc0: 6520 7365 7175 656e 6365 2e0a 2020 2020  e sequence..    
+00031bd0: 2020 2020 3a70 6172 616d 205c 5c2a 2a6b      :param \\**k
+00031be0: 7761 7267 733a 2046 7572 7468 6572 206e  wargs: Further n
+00031bf0: 616d 6564 2061 7267 756d 656e 7473 2074  amed arguments t
+00031c00: 6861 7420 7769 6c6c 2062 6520 7061 7373  hat will be pass
+00031c10: 6564 2074 6f20 7468 650a 2020 2020 2020  ed to the.      
+00031c20: 2020 2020 2020 3a6d 6574 683a 602e 7472        :meth:`.tr
+00031c30: 6565 7360 206d 6574 686f 6420 7768 656e  ees` method when
+00031c40: 2063 6f6e 7374 7275 6374 696e 6720 7468   constructing th
+00031c50: 6520 7265 7475 726e 6564 2074 7265 6573  e returned trees
+00031c60: 2e0a 0a20 2020 2020 2020 203a 7265 7475  ...        :retu
+00031c70: 726e 3a20 416e 2069 7465 7261 746f 7220  rn: An iterator 
+00031c80: 7265 7475 726e 696e 6720 7375 6363 6573  returning succes
+00031c90: 7369 7665 2074 7570 6c65 7320 6f66 2074  sive tuples of t
+00031ca0: 6865 2066 6f72 6d0a 2020 2020 2020 2020  he form.        
+00031cb0: 2020 2020 6060 2869 6e74 6572 7661 6c2c      ``(interval,
+00031cc0: 2074 7265 655f 7365 6c66 2c20 7472 6565   tree_self, tree
+00031cd0: 5f6f 7468 6572 2960 602e 2046 6f72 2065  _other)``. For e
+00031ce0: 7861 6d70 6c65 2c20 7468 6520 6669 7273  xample, the firs
+00031cf0: 7420 6974 656d 2072 6574 7572 6e65 640a  t item returned.
+00031d00: 2020 2020 2020 2020 2020 2020 7769 6c6c              will
+00031d10: 2063 6f6e 7369 7374 206f 6620 616e 2074   consist of an t
+00031d20: 7570 6c65 206f 6620 7468 6520 696e 6974  uple of the init
+00031d30: 6961 6c20 696e 7465 7276 616c 2c20 7468  ial interval, th
+00031d40: 6520 6669 7273 7420 7472 6565 206f 6620  e first tree of 
+00031d50: 7468 650a 2020 2020 2020 2020 2020 2020  the.            
+00031d60: 6375 7272 656e 7420 7472 6565 2073 6571  current tree seq
+00031d70: 7565 6e63 652c 2061 6e64 2074 6865 2066  uence, and the f
+00031d80: 6972 7374 2074 7265 6520 6f66 2074 6865  irst tree of the
+00031d90: 2060 606f 7468 6572 6060 2074 7265 6520   ``other`` tree 
+00031da0: 7365 7175 656e 6365 3b0a 2020 2020 2020  sequence;.      
+00031db0: 2020 2020 2020 7468 6520 6060 2e6c 6566        the ``.lef
+00031dc0: 7460 6020 6174 7472 6962 7574 6520 6f66  t`` attribute of
+00031dd0: 2074 6865 2069 6e69 7469 616c 2069 6e74   the initial int
+00031de0: 6572 7661 6c20 7769 6c6c 2062 6520 3020  erval will be 0 
+00031df0: 616e 6420 7468 6520 6060 2e72 6967 6874  and the ``.right
+00031e00: 6060 0a20 2020 2020 2020 2020 2020 2061  ``.            a
+00031e10: 7474 7269 6275 7465 2077 696c 6c20 6265  ttribute will be
+00031e20: 2074 6865 2073 6d61 6c6c 6573 7420 6e6f   the smallest no
+00031e30: 6e2d 7a65 726f 2062 7265 616b 706f 696e  n-zero breakpoin
+00031e40: 7420 6f66 2074 6865 2032 2074 7265 6520  t of the 2 tree 
+00031e50: 7365 7175 656e 6365 732e 0a20 2020 2020  sequences..     
+00031e60: 2020 203a 7274 7970 653a 2069 7465 7228     :rtype: iter(
+00031e70: 3a63 6c61 7373 3a60 496e 7465 7276 616c  :class:`Interval
+00031e80: 602c 203a 636c 6173 733a 6054 7265 6560  `, :class:`Tree`
+00031e90: 2c20 3a63 6c61 7373 3a60 5472 6565 6029  , :class:`Tree`)
+00031ea0: 0a0a 2020 2020 2020 2020 2222 220a 2020  ..        """.  
+00031eb0: 2020 2020 2020 6966 2073 656c 662e 7365        if self.se
+00031ec0: 7175 656e 6365 5f6c 656e 6774 6820 213d  quence_length !=
+00031ed0: 206f 7468 6572 2e73 6571 7565 6e63 655f   other.sequence_
+00031ee0: 6c65 6e67 7468 3a0a 2020 2020 2020 2020  length:.        
+00031ef0: 2020 2020 7261 6973 6520 5661 6c75 6545      raise ValueE
+00031f00: 7272 6f72 2822 5472 6565 2073 6571 7565  rror("Tree seque
+00031f10: 6e63 6573 206d 7573 7420 6265 206f 6620  nces must be of 
+00031f20: 6571 7561 6c20 7365 7175 656e 6365 206c  equal sequence l
+00031f30: 656e 6774 682e 2229 0a20 2020 2020 2020  ength.").       
+00031f40: 204c 203d 2073 656c 662e 7365 7175 656e   L = self.sequen
+00031f50: 6365 5f6c 656e 6774 680a 2020 2020 2020  ce_length.      
+00031f60: 2020 7472 6565 7331 203d 2073 656c 662e    trees1 = self.
+00031f70: 7472 6565 7328 2a2a 6b77 6172 6773 290a  trees(**kwargs).
+00031f80: 2020 2020 2020 2020 7472 6565 7332 203d          trees2 =
+00031f90: 206f 7468 6572 2e74 7265 6573 282a 2a6b   other.trees(**k
+00031fa0: 7761 7267 7329 0a20 2020 2020 2020 2074  wargs).        t
+00031fb0: 7265 6531 203d 206e 6578 7428 7472 6565  ree1 = next(tree
+00031fc0: 7331 290a 2020 2020 2020 2020 7472 6565  s1).        tree
+00031fd0: 3220 3d20 6e65 7874 2874 7265 6573 3229  2 = next(trees2)
+00031fe0: 0a20 2020 2020 2020 2072 6967 6874 203d  .        right =
+00031ff0: 2030 0a20 2020 2020 2020 2077 6869 6c65   0.        while
+00032000: 2072 6967 6874 2021 3d20 4c3a 0a20 2020   right != L:.   
+00032010: 2020 2020 2020 2020 206c 6566 7420 3d20           left = 
+00032020: 7269 6768 740a 2020 2020 2020 2020 2020  right.          
+00032030: 2020 7269 6768 7420 3d20 6d69 6e28 7472    right = min(tr
+00032040: 6565 312e 696e 7465 7276 616c 2e72 6967  ee1.interval.rig
+00032050: 6874 2c20 7472 6565 322e 696e 7465 7276  ht, tree2.interv
+00032060: 616c 2e72 6967 6874 290a 2020 2020 2020  al.right).      
+00032070: 2020 2020 2020 7969 656c 6420 496e 7465        yield Inte
+00032080: 7276 616c 286c 6566 742c 2072 6967 6874  rval(left, right
+00032090: 292c 2074 7265 6531 2c20 7472 6565 320a  ), tree1, tree2.
+000320a0: 2020 2020 2020 2020 2020 2020 2320 4164              # Ad
+000320b0: 7661 6e63 650a 2020 2020 2020 2020 2020  vance.          
+000320c0: 2020 6966 2074 7265 6531 2e69 6e74 6572    if tree1.inter
+000320d0: 7661 6c2e 7269 6768 7420 3d3d 2072 6967  val.right == rig
+000320e0: 6874 3a0a 2020 2020 2020 2020 2020 2020  ht:.            
+000320f0: 2020 2020 7472 6565 3120 3d20 6e65 7874      tree1 = next
+00032100: 2874 7265 6573 312c 204e 6f6e 6529 0a20  (trees1, None). 
+00032110: 2020 2020 2020 2020 2020 2069 6620 7472             if tr
+00032120: 6565 322e 696e 7465 7276 616c 2e72 6967  ee2.interval.rig
+00032130: 6874 203d 3d20 7269 6768 743a 0a20 2020  ht == right:.   
+00032140: 2020 2020 2020 2020 2020 2020 2074 7265               tre
+00032150: 6532 203d 206e 6578 7428 7472 6565 7332  e2 = next(trees2
+00032160: 2c20 4e6f 6e65 290a 0a20 2020 2064 6566  , None)..    def
+00032170: 205f 6368 6563 6b5f 6765 6e6f 6d69 635f   _check_genomic_
+00032180: 7261 6e67 6528 7365 6c66 2c20 6c65 6674  range(self, left
+00032190: 2c20 7269 6768 742c 2065 6e73 7572 655f  , right, ensure_
+000321a0: 696e 7465 6765 723d 4661 6c73 6529 3a0a  integer=False):.
+000321b0: 2020 2020 2020 2020 6966 206c 6566 7420          if left 
+000321c0: 6973 204e 6f6e 653a 0a20 2020 2020 2020  is None:.       
+000321d0: 2020 2020 206c 6566 7420 3d20 300a 2020       left = 0.  
+000321e0: 2020 2020 2020 6966 2072 6967 6874 2069        if right i
+000321f0: 7320 4e6f 6e65 3a0a 2020 2020 2020 2020  s None:.        
+00032200: 2020 2020 7269 6768 7420 3d20 7365 6c66      right = self
+00032210: 2e73 6571 7565 6e63 655f 6c65 6e67 7468  .sequence_length
+00032220: 0a20 2020 2020 2020 2069 6620 6e70 2e69  .        if np.i
+00032230: 736e 616e 286c 6566 7429 206f 7220 6c65  snan(left) or le
+00032240: 6674 203c 2030 206f 7220 6c65 6674 203e  ft < 0 or left >
+00032250: 3d20 7365 6c66 2e73 6571 7565 6e63 655f  = self.sequence_
+00032260: 6c65 6e67 7468 3a0a 2020 2020 2020 2020  length:.        
+00032270: 2020 2020 7261 6973 6520 5661 6c75 6545      raise ValueE
+00032280: 7272 6f72 280a 2020 2020 2020 2020 2020  rror(.          
+00032290: 2020 2020 2020 2260 6c65 6674 6020 6e6f        "`left` no
+000322a0: 7420 6265 7477 6565 6e20 7a65 726f 2028  t between zero (
+000322b0: 696e 636c 7573 6976 6529 2061 6e64 2073  inclusive) and s
+000322c0: 6571 7565 6e63 6520 6c65 6e67 7468 2028  equence length (
+000322d0: 6578 636c 7573 6976 6529 220a 2020 2020  exclusive)".    
+000322e0: 2020 2020 2020 2020 290a 2020 2020 2020          ).      
+000322f0: 2020 6966 206e 702e 6973 6e61 6e28 7269    if np.isnan(ri
+00032300: 6768 7429 206f 7220 7269 6768 7420 3c3d  ght) or right <=
+00032310: 2030 206f 7220 7269 6768 7420 3e20 7365   0 or right > se
+00032320: 6c66 2e73 6571 7565 6e63 655f 6c65 6e67  lf.sequence_leng
+00032330: 7468 3a0a 2020 2020 2020 2020 2020 2020  th:.            
+00032340: 7261 6973 6520 5661 6c75 6545 7272 6f72  raise ValueError
+00032350: 280a 2020 2020 2020 2020 2020 2020 2020  (.              
+00032360: 2020 2260 7269 6768 7460 206e 6f74 2062    "`right` not b
+00032370: 6574 7765 656e 207a 6572 6f20 2865 7863  etween zero (exc
+00032380: 6c75 7369 7665 2920 616e 6420 7365 7175  lusive) and sequ
+00032390: 656e 6365 206c 656e 6774 6820 2869 6e63  ence length (inc
+000323a0: 6c75 7369 7665 2922 0a20 2020 2020 2020  lusive)".       
+000323b0: 2020 2020 2029 0a20 2020 2020 2020 2069       ).        i
+000323c0: 6620 6c65 6674 203e 3d20 7269 6768 743a  f left >= right:
+000323d0: 0a20 2020 2020 2020 2020 2020 2072 6169  .            rai
+000323e0: 7365 2056 616c 7565 4572 726f 7228 2260  se ValueError("`
+000323f0: 6c65 6674 6020 6d75 7374 2062 6520 6c65  left` must be le
+00032400: 7373 2074 6861 6e20 6072 6967 6874 6022  ss than `right`"
+00032410: 290a 2020 2020 2020 2020 6966 2065 6e73  ).        if ens
+00032420: 7572 655f 696e 7465 6765 723a 0a20 2020  ure_integer:.   
+00032430: 2020 2020 2020 2020 2069 6620 6c65 6674           if left
+00032440: 2021 3d20 696e 7428 6c65 6674 2920 6f72   != int(left) or
+00032450: 2072 6967 6874 2021 3d20 696e 7428 7269   right != int(ri
+00032460: 6768 7429 3a0a 2020 2020 2020 2020 2020  ght):.          
+00032470: 2020 2020 2020 7261 6973 6520 5661 6c75        raise Valu
+00032480: 6545 7272 6f72 2822 606c 6566 7460 2061  eError("`left` a
+00032490: 6e64 2060 7269 6768 7460 206d 7573 7420  nd `right` must 
+000324a0: 6265 2069 6e74 6567 6572 7322 290a 2020  be integers").  
+000324b0: 2020 2020 2020 2020 2020 7265 7475 726e            return
+000324c0: 2049 6e74 6572 7661 6c28 696e 7428 6c65   Interval(int(le
+000324d0: 6674 292c 2069 6e74 2872 6967 6874 2929  ft), int(right))
+000324e0: 0a20 2020 2020 2020 2072 6574 7572 6e20  .        return 
+000324f0: 496e 7465 7276 616c 286c 6566 742c 2072  Interval(left, r
+00032500: 6967 6874 290a 0a20 2020 2064 6566 205f  ight)..    def _
+00032510: 6861 706c 6f74 7970 6573 5f61 7272 6179  haplotypes_array
+00032520: 280a 2020 2020 2020 2020 7365 6c66 2c0a  (.        self,.
+00032530: 2020 2020 2020 2020 2a2c 0a20 2020 2020          *,.     
+00032540: 2020 2069 6e74 6572 7661 6c2c 0a20 2020     interval,.   
+00032550: 2020 2020 2069 736f 6c61 7465 645f 6173       isolated_as
+00032560: 5f6d 6973 7369 6e67 3d4e 6f6e 652c 0a20  _missing=None,. 
+00032570: 2020 2020 2020 206d 6973 7369 6e67 5f64         missing_d
+00032580: 6174 615f 6368 6172 6163 7465 723d 4e6f  ata_character=No
+00032590: 6e65 2c0a 2020 2020 2020 2020 7361 6d70  ne,.        samp
+000325a0: 6c65 733d 4e6f 6e65 2c0a 2020 2020 293a  les=None,.    ):
+000325b0: 0a20 2020 2020 2020 2023 2072 6574 7572  .        # retur
+000325c0: 6e20 616e 2061 7272 6179 206f 6620 6861  n an array of ha
+000325d0: 706c 6f74 7970 6573 2061 6e64 2074 6865  plotypes and the
+000325e0: 2066 6972 7374 2061 6e64 206c 6173 7420   first and last 
+000325f0: 7369 7465 2070 6f73 6974 696f 6e73 0a20  site positions. 
+00032600: 2020 2020 2020 2069 6620 6d69 7373 696e         if missin
+00032610: 675f 6461 7461 5f63 6861 7261 6374 6572  g_data_character
+00032620: 2069 7320 4e6f 6e65 3a0a 2020 2020 2020   is None:.      
+00032630: 2020 2020 2020 6d69 7373 696e 675f 6461        missing_da
+00032640: 7461 5f63 6861 7261 6374 6572 203d 2022  ta_character = "
+00032650: 4e22 0a0a 2020 2020 2020 2020 7374 6172  N"..        star
+00032660: 745f 7369 7465 2c20 7374 6f70 5f73 6974  t_site, stop_sit
+00032670: 6520 3d20 6e70 2e73 6561 7263 6873 6f72  e = np.searchsor
+00032680: 7465 6428 7365 6c66 2e73 6974 6573 5f70  ted(self.sites_p
+00032690: 6f73 6974 696f 6e2c 2069 6e74 6572 7661  osition, interva
+000326a0: 6c29 0a20 2020 2020 2020 2048 203d 206e  l).        H = n
+000326b0: 702e 656d 7074 7928 0a20 2020 2020 2020  p.empty(.       
+000326c0: 2020 2020 2028 0a20 2020 2020 2020 2020       (.         
+000326d0: 2020 2020 2020 2073 656c 662e 6e75 6d5f         self.num_
+000326e0: 7361 6d70 6c65 7320 6966 2073 616d 706c  samples if sampl
+000326f0: 6573 2069 7320 4e6f 6e65 2065 6c73 6520  es is None else 
+00032700: 6c65 6e28 7361 6d70 6c65 7329 2c0a 2020  len(samples),.  
+00032710: 2020 2020 2020 2020 2020 2020 2020 7374                st
+00032720: 6f70 5f73 6974 6520 2d20 7374 6172 745f  op_site - start_
+00032730: 7369 7465 2c0a 2020 2020 2020 2020 2020  site,.          
+00032740: 2020 292c 0a20 2020 2020 2020 2020 2020    ),.           
+00032750: 2064 7479 7065 3d6e 702e 696e 7438 2c0a   dtype=np.int8,.
+00032760: 2020 2020 2020 2020 290a 2020 2020 2020          ).      
+00032770: 2020 6d69 7373 696e 675f 696e 7438 203d    missing_int8 =
+00032780: 206f 7264 286d 6973 7369 6e67 5f64 6174   ord(missing_dat
+00032790: 615f 6368 6172 6163 7465 722e 656e 636f  a_character.enco
+000327a0: 6465 2822 6173 6369 6922 2929 0a20 2020  de("ascii")).   
+000327b0: 2020 2020 2066 6f72 2076 6172 2069 6e20       for var in 
+000327c0: 7365 6c66 2e76 6172 6961 6e74 7328 0a20  self.variants(. 
+000327d0: 2020 2020 2020 2020 2020 2073 616d 706c             sampl
+000327e0: 6573 3d73 616d 706c 6573 2c0a 2020 2020  es=samples,.    
+000327f0: 2020 2020 2020 2020 6973 6f6c 6174 6564          isolated
+00032800: 5f61 735f 6d69 7373 696e 673d 6973 6f6c  _as_missing=isol
+00032810: 6174 6564 5f61 735f 6d69 7373 696e 672c  ated_as_missing,
+00032820: 0a20 2020 2020 2020 2020 2020 206c 6566  .            lef
+00032830: 743d 696e 7465 7276 616c 2e6c 6566 742c  t=interval.left,
+00032840: 0a20 2020 2020 2020 2020 2020 2072 6967  .            rig
+00032850: 6874 3d69 6e74 6572 7661 6c2e 7269 6768  ht=interval.righ
+00032860: 742c 0a20 2020 2020 2020 2029 3a0a 2020  t,.        ):.  
+00032870: 2020 2020 2020 2020 2020 616c 6c65 6c65            allele
+00032880: 7320 3d20 6e70 2e66 756c 6c28 6c65 6e28  s = np.full(len(
+00032890: 7661 722e 616c 6c65 6c65 7329 2c20 6d69  var.alleles), mi
+000328a0: 7373 696e 675f 696e 7438 2c20 6474 7970  ssing_int8, dtyp
+000328b0: 653d 6e70 2e69 6e74 3829 0a20 2020 2020  e=np.int8).     
+000328c0: 2020 2020 2020 2066 6f72 2069 2c20 616c         for i, al
+000328d0: 6c65 6c65 2069 6e20 656e 756d 6572 6174  lele in enumerat
+000328e0: 6528 7661 722e 616c 6c65 6c65 7329 3a0a  e(var.alleles):.
+000328f0: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00032900: 6966 2061 6c6c 656c 6520 6973 206e 6f74  if allele is not
+00032910: 204e 6f6e 653a 0a20 2020 2020 2020 2020   None:.         
+00032920: 2020 2020 2020 2020 2020 2069 6620 6c65             if le
+00032930: 6e28 616c 6c65 6c65 2920 213d 2031 3a0a  n(allele) != 1:.
+00032940: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00032950: 2020 2020 2020 2020 7261 6973 6520 5479          raise Ty
+00032960: 7065 4572 726f 7228 0a20 2020 2020 2020  peError(.       
+00032970: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00032980: 2020 2020 2022 4d75 6c74 692d 6c65 7474       "Multi-lett
+00032990: 6572 2061 6c6c 656c 6520 6f72 2064 656c  er allele or del
+000329a0: 6574 696f 6e20 6465 7465 6374 6564 2061  etion detected a
+000329b0: 7420 7369 7465 207b 7d22 2e66 6f72 6d61  t site {}".forma
+000329c0: 7428 0a20 2020 2020 2020 2020 2020 2020  t(.             
+000329d0: 2020 2020 2020 2020 2020 2020 2020 2020                  
+000329e0: 2020 2076 6172 2e73 6974 652e 6964 0a20     var.site.id. 
 000329f0: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00032a00: 7472 793a 0a20 2020 2020 2020 2020 2020  try:.           
-00032a10: 2020 2020 2020 2020 2020 2020 2061 7363               asc
-00032a20: 6969 5f61 6c6c 656c 6520 3d20 616c 6c65  ii_allele = alle
-00032a30: 6c65 2e65 6e63 6f64 6528 2261 7363 6969  le.encode("ascii
-00032a40: 2229 0a20 2020 2020 2020 2020 2020 2020  ").             
-00032a50: 2020 2020 2020 2065 7863 6570 7420 556e         except Un
-00032a60: 6963 6f64 6545 6e63 6f64 6545 7272 6f72  icodeEncodeError
-00032a70: 3a0a 2020 2020 2020 2020 2020 2020 2020  :.              
-00032a80: 2020 2020 2020 2020 2020 7261 6973 6520            raise 
-00032a90: 5479 7065 4572 726f 7228 0a20 2020 2020  TypeError(.     
-00032aa0: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00032ab0: 2020 2020 2020 2022 4e6f 6e2d 6173 6369         "Non-asci
-00032ac0: 6920 6368 6172 6163 7465 7220 696e 2061  i character in a
-00032ad0: 6c6c 656c 6520 6174 2073 6974 6520 7b7d  llele at site {}
-00032ae0: 222e 666f 726d 6174 280a 2020 2020 2020  ".format(.      
-00032af0: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00032b00: 2020 2020 2020 2020 2020 7661 722e 7369            var.si
-00032b10: 7465 2e69 640a 2020 2020 2020 2020 2020  te.id.          
-00032b20: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00032b30: 2020 290a 2020 2020 2020 2020 2020 2020    ).            
-00032b40: 2020 2020 2020 2020 2020 2020 290a 2020              ).  
-00032b50: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00032b60: 2020 616c 6c65 6c65 5f69 6e74 3820 3d20    allele_int8 = 
-00032b70: 6f72 6428 6173 6369 695f 616c 6c65 6c65  ord(ascii_allele
-00032b80: 290a 2020 2020 2020 2020 2020 2020 2020  ).              
-00032b90: 2020 2020 2020 6966 2061 6c6c 656c 655f        if allele_
-00032ba0: 696e 7438 203d 3d20 6d69 7373 696e 675f  int8 == missing_
-00032bb0: 696e 7438 3a0a 2020 2020 2020 2020 2020  int8:.          
-00032bc0: 2020 2020 2020 2020 2020 2020 2020 7261                ra
-00032bd0: 6973 6520 5661 6c75 6545 7272 6f72 280a  ise ValueError(.
-00032be0: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00032bf0: 2020 2020 2020 2020 2020 2020 2254 6865              "The
-00032c00: 206d 6973 7369 6e67 2064 6174 6120 6368   missing data ch
-00032c10: 6172 6163 7465 7220 277b 7d27 2063 6c61  aracter '{}' cla
-00032c20: 7368 6573 2077 6974 6820 616e 2022 0a20  shes with an ". 
-00032c30: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00032c40: 2020 2020 2020 2020 2020 2022 6578 6973             "exis
-00032c50: 7469 6e67 2061 6c6c 656c 6520 6174 2073  ting allele at s
-00032c60: 6974 6520 7b7d 222e 666f 726d 6174 280a  ite {}".format(.
+00032a00: 2020 2020 2020 2020 2020 2029 0a20 2020             ).   
+00032a10: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00032a20: 2020 2020 2029 0a20 2020 2020 2020 2020       ).         
+00032a30: 2020 2020 2020 2020 2020 2074 7279 3a0a             try:.
+00032a40: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00032a50: 2020 2020 2020 2020 6173 6369 695f 616c          ascii_al
+00032a60: 6c65 6c65 203d 2061 6c6c 656c 652e 656e  lele = allele.en
+00032a70: 636f 6465 2822 6173 6369 6922 290a 2020  code("ascii").  
+00032a80: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00032a90: 2020 6578 6365 7074 2055 6e69 636f 6465    except Unicode
+00032aa0: 456e 636f 6465 4572 726f 723a 0a20 2020  EncodeError:.   
+00032ab0: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00032ac0: 2020 2020 2072 6169 7365 2054 7970 6545       raise TypeE
+00032ad0: 7272 6f72 280a 2020 2020 2020 2020 2020  rror(.          
+00032ae0: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00032af0: 2020 224e 6f6e 2d61 7363 6969 2063 6861    "Non-ascii cha
+00032b00: 7261 6374 6572 2069 6e20 616c 6c65 6c65  racter in allele
+00032b10: 2061 7420 7369 7465 207b 7d22 2e66 6f72   at site {}".for
+00032b20: 6d61 7428 0a20 2020 2020 2020 2020 2020  mat(.           
+00032b30: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00032b40: 2020 2020 2076 6172 2e73 6974 652e 6964       var.site.id
+00032b50: 0a20 2020 2020 2020 2020 2020 2020 2020  .               
+00032b60: 2020 2020 2020 2020 2020 2020 2029 0a20               ). 
+00032b70: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00032b80: 2020 2020 2020 2029 0a20 2020 2020 2020         ).       
+00032b90: 2020 2020 2020 2020 2020 2020 2061 6c6c               all
+00032ba0: 656c 655f 696e 7438 203d 206f 7264 2861  ele_int8 = ord(a
+00032bb0: 7363 6969 5f61 6c6c 656c 6529 0a20 2020  scii_allele).   
+00032bc0: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00032bd0: 2069 6620 616c 6c65 6c65 5f69 6e74 3820   if allele_int8 
+00032be0: 3d3d 206d 6973 7369 6e67 5f69 6e74 383a  == missing_int8:
+00032bf0: 0a20 2020 2020 2020 2020 2020 2020 2020  .               
+00032c00: 2020 2020 2020 2020 2072 6169 7365 2056           raise V
+00032c10: 616c 7565 4572 726f 7228 0a20 2020 2020  alueError(.     
+00032c20: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00032c30: 2020 2020 2020 2022 5468 6520 6d69 7373         "The miss
+00032c40: 696e 6720 6461 7461 2063 6861 7261 6374  ing data charact
+00032c50: 6572 2027 7b7d 2720 636c 6173 6865 7320  er '{}' clashes 
+00032c60: 7769 7468 2061 6e20 220a 2020 2020 2020  with an ".      
 00032c70: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00032c80: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00032c90: 6d69 7373 696e 675f 6461 7461 5f63 6861  missing_data_cha
-00032ca0: 7261 6374 6572 2c20 7661 722e 7369 7465  racter, var.site
-00032cb0: 2e69 640a 2020 2020 2020 2020 2020 2020  .id.            
-00032cc0: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00032cd0: 290a 2020 2020 2020 2020 2020 2020 2020  ).              
-00032ce0: 2020 2020 2020 2020 2020 290a 2020 2020            ).    
+00032c80: 2020 2020 2020 2265 7869 7374 696e 6720        "existing 
+00032c90: 616c 6c65 6c65 2061 7420 7369 7465 207b  allele at site {
+00032ca0: 7d22 2e66 6f72 6d61 7428 0a20 2020 2020  }".format(.     
+00032cb0: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00032cc0: 2020 2020 2020 2020 2020 206d 6973 7369             missi
+00032cd0: 6e67 5f64 6174 615f 6368 6172 6163 7465  ng_data_characte
+00032ce0: 722c 2076 6172 2e73 6974 652e 6964 0a20  r, var.site.id. 
 00032cf0: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00032d00: 616c 6c65 6c65 735b 695d 203d 2061 6c6c  alleles[i] = all
-00032d10: 656c 655f 696e 7438 0a20 2020 2020 2020  ele_int8.       
-00032d20: 2020 2020 2048 5b3a 2c20 7661 722e 7369       H[:, var.si
-00032d30: 7465 2e69 6420 2d20 7374 6172 745f 7369  te.id - start_si
-00032d40: 7465 5d20 3d20 616c 6c65 6c65 735b 7661  te] = alleles[va
-00032d50: 722e 6765 6e6f 7479 7065 735d 0a20 2020  r.genotypes].   
-00032d60: 2020 2020 2072 6574 7572 6e20 482c 2028       return H, (
-00032d70: 7374 6172 745f 7369 7465 2c20 7374 6f70  start_site, stop
-00032d80: 5f73 6974 6520 2d20 3129 0a0a 2020 2020  _site - 1)..    
-00032d90: 6465 6620 6861 706c 6f74 7970 6573 280a  def haplotypes(.
-00032da0: 2020 2020 2020 2020 7365 6c66 2c0a 2020          self,.  
-00032db0: 2020 2020 2020 2a2c 0a20 2020 2020 2020        *,.       
-00032dc0: 2069 736f 6c61 7465 645f 6173 5f6d 6973   isolated_as_mis
-00032dd0: 7369 6e67 3d4e 6f6e 652c 0a20 2020 2020  sing=None,.     
-00032de0: 2020 206d 6973 7369 6e67 5f64 6174 615f     missing_data_
-00032df0: 6368 6172 6163 7465 723d 4e6f 6e65 2c0a  character=None,.
-00032e00: 2020 2020 2020 2020 7361 6d70 6c65 733d          samples=
-00032e10: 4e6f 6e65 2c0a 2020 2020 2020 2020 6c65  None,.        le
-00032e20: 6674 3d4e 6f6e 652c 0a20 2020 2020 2020  ft=None,.       
-00032e30: 2072 6967 6874 3d4e 6f6e 652c 0a20 2020   right=None,.   
-00032e40: 2020 2020 2069 6d70 7574 655f 6d69 7373       impute_miss
-00032e50: 696e 675f 6461 7461 3d4e 6f6e 652c 0a20  ing_data=None,. 
-00032e60: 2020 2029 3a0a 2020 2020 2020 2020 2222     ):.        ""
-00032e70: 220a 2020 2020 2020 2020 5265 7475 726e  ".        Return
-00032e80: 7320 616e 2069 7465 7261 746f 7220 6f76  s an iterator ov
-00032e90: 6572 2074 6865 2073 7472 696e 6773 206f  er the strings o
-00032ea0: 6620 6861 706c 6f74 7970 6573 2074 6861  f haplotypes tha
-00032eb0: 7420 7265 7375 6c74 2066 726f 6d0a 2020  t result from.  
-00032ec0: 2020 2020 2020 7468 6520 7472 6565 7320        the trees 
-00032ed0: 616e 6420 6d75 7461 7469 6f6e 7320 696e  and mutations in
-00032ee0: 2074 6869 7320 7472 6565 2073 6571 7565   this tree seque
-00032ef0: 6e63 652e 2045 6163 6820 6861 706c 6f74  nce. Each haplot
-00032f00: 7970 6520 7374 7269 6e67 0a20 2020 2020  ype string.     
-00032f10: 2020 2069 7320 6775 6172 616e 7465 6564     is guaranteed
-00032f20: 2074 6f20 6265 206f 6620 7468 6520 7361   to be of the sa
-00032f30: 6d65 206c 656e 6774 682e 2041 2074 7265  me length. A tre
-00032f40: 6520 7365 7175 656e 6365 2077 6974 680a  e sequence with.
-00032f50: 2020 2020 2020 2020 3a6d 6174 683a 606e          :math:`n
-00032f60: 6020 7361 6d70 6c65 7320 616e 6420 7769  ` samples and wi
-00032f70: 7468 203a 6d61 7468 3a60 7360 2073 6974  th :math:`s` sit
-00032f80: 6573 206c 7969 6e67 2062 6574 7765 656e  es lying between
-00032f90: 2060 606c 6566 7460 6020 616e 640a 2020   ``left`` and.  
-00032fa0: 2020 2020 2020 6060 7269 6768 7460 6020        ``right`` 
-00032fb0: 7769 6c6c 2072 6574 7572 6e20 6120 746f  will return a to
-00032fc0: 7461 6c20 6f66 203a 6d61 7468 3a60 6e60  tal of :math:`n`
-00032fd0: 0a20 2020 2020 2020 2073 7472 696e 6773  .        strings
-00032fe0: 206f 6620 3a6d 6174 683a 6073 6020 616c   of :math:`s` al
-00032ff0: 6c65 6c65 7320 636f 6e63 6174 656e 6174  leles concatenat
-00033000: 6564 2074 6f67 6574 6865 722c 2077 6865  ed together, whe
-00033010: 7265 2061 6e20 616c 6c65 6c65 0a20 2020  re an allele.   
-00033020: 2020 2020 2063 6f6e 7369 7374 7320 6f66       consists of
-00033030: 2061 2073 696e 676c 6520 6173 6369 6920   a single ascii 
-00033040: 6368 6172 6163 7465 7220 2874 7265 6520  character (tree 
-00033050: 7365 7175 656e 6365 7320 7468 6174 2069  sequences that i
-00033060: 6e63 6c75 6465 2061 6c6c 656c 6573 0a20  nclude alleles. 
-00033070: 2020 2020 2020 2077 6869 6368 2061 7265         which are
-00033080: 206e 6f74 2061 2073 696e 676c 6520 6368   not a single ch
-00033090: 6172 6163 7465 7220 696e 206c 656e 6774  aracter in lengt
-000330a0: 682c 206f 7220 7768 6572 6520 7468 6520  h, or where the 
-000330b0: 6368 6172 6163 7465 7220 6973 0a20 2020  character is.   
-000330c0: 2020 2020 206e 6f6e 2d61 7363 6969 2c20       non-ascii, 
-000330d0: 7769 6c6c 2072 6169 7365 2061 6e20 6572  will raise an er
-000330e0: 726f 7229 2e20 5468 6520 6669 7273 7420  ror). The first 
-000330f0: 7374 7269 6e67 2072 6574 7572 6e65 6420  string returned 
-00033100: 6973 2074 6865 0a20 2020 2020 2020 2068  is the.        h
-00033110: 6170 6c6f 7479 7065 2066 6f72 2074 6865  aplotype for the
-00033120: 2066 6972 7374 2072 6571 7565 7374 6564   first requested
-00033130: 2073 616d 706c 652c 2061 6e64 2073 6f20   sample, and so 
-00033140: 6f6e 2e0a 0a20 2020 2020 2020 2054 6865  on...        The
-00033150: 2061 6c6c 656c 6573 2061 7420 6561 6368   alleles at each
-00033160: 2073 6974 6520 6d75 7374 2062 6520 7265   site must be re
-00033170: 7072 6573 656e 7465 6420 6279 2073 696e  presented by sin
-00033180: 676c 6520 6279 7465 2063 6861 7261 6374  gle byte charact
-00033190: 6572 732c 0a20 2020 2020 2020 2028 692e  ers,.        (i.
-000331a0: 652e 2c20 7661 7269 616e 7473 206d 7573  e., variants mus
-000331b0: 7420 6265 2073 696e 676c 6520 6e75 636c  t be single nucl
-000331c0: 656f 7469 6465 2070 6f6c 796d 6f72 7068  eotide polymorph
-000331d0: 6973 6d73 2c20 6f72 2053 4e50 7329 2c20  isms, or SNPs), 
-000331e0: 6865 6e63 650a 2020 2020 2020 2020 7468  hence.        th
-000331f0: 6520 7374 7269 6e67 7320 7265 7475 726e  e strings return
-00033200: 6564 2077 696c 6c20 616c 6c20 6265 206f  ed will all be o
-00033210: 6620 6c65 6e67 7468 203a 6d61 7468 3a60  f length :math:`
-00033220: 7360 2e20 4966 2074 6865 2060 606c 6566  s`. If the ``lef
-00033230: 7460 600a 2020 2020 2020 2020 706f 7369  t``.        posi
-00033240: 7469 6f6e 2069 7320 6c65 7373 2074 6861  tion is less tha
-00033250: 6e20 6f72 2065 7175 616c 2074 6f20 7468  n or equal to th
-00033260: 6520 706f 7369 7469 6f6e 206f 6620 7468  e position of th
-00033270: 6520 6669 7273 7420 7369 7465 2c20 666f  e first site, fo
-00033280: 7220 610a 2020 2020 2020 2020 6861 706c  r a.        hapl
-00033290: 6f74 7970 6520 6060 6860 602c 2074 6865  otype ``h``, the
-000332a0: 2076 616c 7565 206f 6620 6060 685b 6a5d   value of ``h[j]
-000332b0: 6060 2077 696c 6c20 7468 6572 6566 6f72  `` will therefor
-000332c0: 6520 6265 2074 6865 206f 6273 6572 7665  e be the observe
-000332d0: 640a 2020 2020 2020 2020 616c 6c65 6c69  d.        alleli
-000332e0: 6320 7374 6174 6520 6174 2073 6974 6520  c state at site 
-000332f0: 6060 6a60 602e 0a0a 2020 2020 2020 2020  ``j``...        
-00033300: 4966 2060 6069 736f 6c61 7465 645f 6173  If ``isolated_as
-00033310: 5f6d 6973 7369 6e67 6060 2069 7320 5472  _missing`` is Tr
-00033320: 7565 2028 7468 6520 6465 6661 756c 7429  ue (the default)
-00033330: 2c20 6973 6f6c 6174 6564 2073 616d 706c  , isolated sampl
-00033340: 6573 2077 6974 686f 7574 0a20 2020 2020  es without.     
-00033350: 2020 206d 7574 6174 696f 6e73 2064 6972     mutations dir
-00033360: 6563 746c 7920 6162 6f76 6520 7468 656d  ectly above them
-00033370: 2077 696c 6c20 6265 2074 7265 6174 6564   will be treated
-00033380: 2061 730a 2020 2020 2020 2020 3a72 6566   as.        :ref
-00033390: 3a60 6d69 7373 696e 6720 6461 7461 3c73  :`missing data<s
-000333a0: 6563 5f64 6174 615f 6d6f 6465 6c5f 6d69  ec_data_model_mi
-000333b0: 7373 696e 675f 6461 7461 3e60 2061 6e64  ssing_data>` and
-000333c0: 2077 696c 6c20 6265 0a20 2020 2020 2020   will be.       
-000333d0: 2072 6570 7265 7365 6e74 6564 2069 6e20   represented in 
-000333e0: 7468 6520 7374 7269 6e67 2062 7920 7468  the string by th
-000333f0: 6520 6060 6d69 7373 696e 675f 6461 7461  e ``missing_data
-00033400: 5f63 6861 7261 6374 6572 6060 2e20 4966  _character``. If
-00033410: 0a20 2020 2020 2020 2069 6e73 7465 6164  .        instead
-00033420: 2069 7420 6973 2073 6574 2074 6f20 4661   it is set to Fa
-00033430: 6c73 652c 206d 6973 7369 6e67 2064 6174  lse, missing dat
-00033440: 6120 7769 6c6c 2062 6520 6173 7369 676e  a will be assign
-00033450: 6564 2074 6865 2061 6e63 6573 7472 616c  ed the ancestral
-00033460: 2073 7461 7465 0a20 2020 2020 2020 2028   state.        (
-00033470: 756e 6c65 7373 2074 6865 7920 6861 7665  unless they have
-00033480: 206d 7574 6174 696f 6e73 2064 6972 6563   mutations direc
-00033490: 746c 7920 6162 6f76 6520 7468 656d 2c20  tly above them, 
-000334a0: 696e 2077 6869 6368 2063 6173 6520 7468  in which case th
-000334b0: 6579 2077 696c 6c20 7461 6b65 0a20 2020  ey will take.   
-000334c0: 2020 2020 2074 6865 206d 6f73 7420 7265       the most re
-000334d0: 6365 6e74 2064 6572 6976 6564 206d 7574  cent derived mut
-000334e0: 6174 696f 6e61 6c20 7374 6174 6520 666f  ational state fo
-000334f0: 7220 7468 6174 206e 6f64 6529 2e20 5468  r that node). Th
-00033500: 6973 2077 6173 2074 6865 2064 6566 6175  is was the defau
-00033510: 6c74 0a20 2020 2020 2020 2062 6568 6176  lt.        behav
-00033520: 696f 7572 2069 6e20 7665 7273 696f 6e73  iour in versions
-00033530: 2070 7269 6f72 2074 6f20 302e 322e 302e   prior to 0.2.0.
-00033540: 2050 7269 6f72 2074 6f20 302e 332e 3020   Prior to 0.3.0 
-00033550: 7468 6520 6069 6d70 7574 655f 6d69 7373  the `impute_miss
-00033560: 696e 675f 6461 7461 600a 2020 2020 2020  ing_data`.      
-00033570: 2020 6172 6775 6d65 6e74 2063 6f6e 7472    argument contr
-00033580: 6f6c 6c65 6420 7468 6973 2062 6568 6176  olled this behav
-00033590: 696f 7572 2e0a 0a20 2020 2020 2020 2053  iour...        S
-000335a0: 6565 2061 6c73 6f20 7468 6520 3a6d 6574  ee also the :met
-000335b0: 683a 602e 7661 7269 616e 7473 6020 6974  h:`.variants` it
-000335c0: 6572 6174 6f72 2066 6f72 2073 6974 652d  erator for site-
-000335d0: 6365 6e74 7269 6320 6163 6365 7373 0a20  centric access. 
-000335e0: 2020 2020 2020 2074 6f20 7361 6d70 6c65         to sample
-000335f0: 2067 656e 6f74 7970 6573 2e0a 0a20 2020   genotypes...   
-00033600: 2020 2020 202e 2e20 7761 726e 696e 673a       .. warning:
-00033610: 3a0a 2020 2020 2020 2020 2020 2020 466f  :.            Fo
-00033620: 7220 6c61 7267 6520 6461 7461 7365 7473  r large datasets
-00033630: 2c20 7468 6973 206d 6574 686f 6420 6361  , this method ca
-00033640: 6e20 636f 6e73 756d 6520 6120 2a2a 7665  n consume a **ve
-00033650: 7279 206c 6172 6765 2a2a 2061 6d6f 756e  ry large** amoun
-00033660: 7420 6f66 0a20 2020 2020 2020 2020 2020  t of.           
-00033670: 206d 656d 6f72 7921 2054 6f20 6f75 7470   memory! To outp
-00033680: 7574 2061 6c6c 2074 6865 2073 616d 706c  ut all the sampl
-00033690: 6520 6461 7461 2c20 6974 2069 7320 6d6f  e data, it is mo
-000336a0: 7265 2065 6666 6963 6965 6e74 2074 6f20  re efficient to 
-000336b0: 6974 6572 6174 650a 2020 2020 2020 2020  iterate.        
-000336c0: 2020 2020 6f76 6572 2073 6974 6573 2072      over sites r
-000336d0: 6174 6865 7220 7468 616e 206f 7665 7220  ather than over 
-000336e0: 7361 6d70 6c65 732e 0a0a 2020 2020 2020  samples...      
-000336f0: 2020 3a72 6574 7572 6e3a 2041 6e20 6974    :return: An it
-00033700: 6572 6174 6f72 206f 7665 7220 7468 6520  erator over the 
-00033710: 6861 706c 6f74 7970 6520 7374 7269 6e67  haplotype string
-00033720: 7320 666f 7220 7468 6520 7361 6d70 6c65  s for the sample
-00033730: 7320 696e 0a20 2020 2020 2020 2020 2020  s in.           
-00033740: 2074 6869 7320 7472 6565 2073 6571 7565   this tree seque
-00033750: 6e63 652e 0a20 2020 2020 2020 203a 7061  nce..        :pa
-00033760: 7261 6d20 626f 6f6c 2069 736f 6c61 7465  ram bool isolate
-00033770: 645f 6173 5f6d 6973 7369 6e67 3a20 4966  d_as_missing: If
-00033780: 2054 7275 652c 2074 6865 2061 6c6c 656c   True, the allel
-00033790: 6520 6173 7369 676e 6564 2074 6f0a 2020  e assigned to.  
-000337a0: 2020 2020 2020 2020 2020 6d69 7373 696e            missin
-000337b0: 6720 7361 6d70 6c65 7320 2869 2e65 2e2c  g samples (i.e.,
-000337c0: 2069 736f 6c61 7465 6420 7361 6d70 6c65   isolated sample
-000337d0: 7320 7769 7468 6f75 7420 6d75 7461 7469  s without mutati
-000337e0: 6f6e 7329 2069 730a 2020 2020 2020 2020  ons) is.        
-000337f0: 2020 2020 7468 6520 6060 6d69 7373 696e      the ``missin
-00033800: 675f 6461 7461 5f63 6861 7261 6374 6572  g_data_character
-00033810: 6060 2e20 4966 2046 616c 7365 2c0a 2020  ``. If False,.  
-00033820: 2020 2020 2020 2020 2020 6d69 7373 696e            missin
-00033830: 6720 7361 6d70 6c65 7320 7769 6c6c 2062  g samples will b
-00033840: 6520 6173 7369 676e 6564 2074 6865 2061  e assigned the a
-00033850: 6e63 6573 7472 616c 2073 7461 7465 2e0a  ncestral state..
-00033860: 2020 2020 2020 2020 2020 2020 4465 6661              Defa
-00033870: 756c 743a 2054 7275 652e 0a20 2020 2020  ult: True..     
-00033880: 2020 203a 7061 7261 6d20 7374 7220 6d69     :param str mi
-00033890: 7373 696e 675f 6461 7461 5f63 6861 7261  ssing_data_chara
-000338a0: 6374 6572 3a20 4120 7369 6e67 6c65 2061  cter: A single a
-000338b0: 7363 6969 2063 6861 7261 6374 6572 2074  scii character t
-000338c0: 6861 7420 7769 6c6c 0a20 2020 2020 2020  hat will.       
-000338d0: 2020 2020 2062 6520 7573 6564 2074 6f20       be used to 
-000338e0: 7265 7072 6573 656e 7420 6d69 7373 696e  represent missin
-000338f0: 6720 6461 7461 2e0a 2020 2020 2020 2020  g data..        
-00033900: 2020 2020 4966 2061 6e79 206e 6f72 6d61      If any norma
-00033910: 6c20 616c 6c65 6c65 2063 6f6e 7461 696e  l allele contain
-00033920: 7320 7468 6973 2063 6861 7261 6374 6572  s this character
-00033930: 2c20 616e 2065 7272 6f72 2069 7320 7261  , an error is ra
-00033940: 6973 6564 2e0a 2020 2020 2020 2020 2020  ised..          
-00033950: 2020 4465 6661 756c 743a 2027 4e27 2e0a    Default: 'N'..
-00033960: 2020 2020 2020 2020 3a70 6172 616d 206c          :param l
-00033970: 6973 745b 696e 745d 2073 616d 706c 6573  ist[int] samples
-00033980: 3a20 5468 6520 7361 6d70 6c65 7320 666f  : The samples fo
-00033990: 7220 7768 6963 6820 746f 206f 7574 7075  r which to outpu
-000339a0: 7420 6861 706c 6f74 7970 6573 2e20 4966  t haplotypes. If
-000339b0: 0a20 2020 2020 2020 2020 2020 2060 604e  .            ``N
-000339c0: 6f6e 6560 6020 2864 6566 6175 6c74 292c  one`` (default),
-000339d0: 2072 6574 7572 6e20 6861 706c 6f74 7970   return haplotyp
-000339e0: 6573 2066 6f72 2061 6c6c 2074 6865 2073  es for all the s
-000339f0: 616d 706c 6573 2069 6e20 7468 6520 7472  amples in the tr
-00033a00: 6565 0a20 2020 2020 2020 2020 2020 2073  ee.            s
-00033a10: 6571 7565 6e63 652c 2069 6e20 7468 6520  equence, in the 
-00033a20: 6f72 6465 7220 6769 7665 6e20 6279 2074  order given by t
-00033a30: 6865 203a 6d65 7468 3a60 2e73 616d 706c  he :meth:`.sampl
-00033a40: 6573 6020 6d65 7468 6f64 2e0a 2020 2020  es` method..    
-00033a50: 2020 2020 3a70 6172 616d 2069 6e74 206c      :param int l
-00033a60: 6566 743a 2048 6170 6c6f 7479 7065 2073  eft: Haplotype s
-00033a70: 7472 696e 6773 2077 696c 6c20 7374 6172  trings will star
-00033a80: 7420 7769 7468 2074 6865 2066 6972 7374  t with the first
-00033a90: 2073 6974 6520 6174 206f 7220 6166 7465   site at or afte
-00033aa0: 720a 2020 2020 2020 2020 2020 2020 7468  r.            th
-00033ab0: 6973 2067 656e 6f6d 6963 2070 6f73 6974  is genomic posit
-00033ac0: 696f 6e2e 2049 6620 6060 4e6f 6e65 6060  ion. If ``None``
-00033ad0: 2028 6465 6661 756c 7429 2073 7461 7274   (default) start
-00033ae0: 2061 7420 7468 6520 6669 7273 7420 7369   at the first si
-00033af0: 7465 2e0a 2020 2020 2020 2020 3a70 6172  te..        :par
-00033b00: 616d 2069 6e74 2072 6967 6874 3a20 4861  am int right: Ha
-00033b10: 706c 6f74 7970 6520 7374 7269 6e67 7320  plotype strings 
-00033b20: 7769 6c6c 2065 6e64 2077 6974 6820 7468  will end with th
-00033b30: 6520 6c61 7374 2073 6974 6520 6265 666f  e last site befo
-00033b40: 7265 2074 6869 730a 2020 2020 2020 2020  re this.        
-00033b50: 2020 2020 706f 7369 7469 6f6e 2e20 4966      position. If
-00033b60: 2060 604e 6f6e 6560 6020 2864 6566 6175   ``None`` (defau
-00033b70: 6c74 2920 6173 7375 6d65 2060 6072 6967  lt) assume ``rig
-00033b80: 6874 6060 2069 7320 7468 6520 7365 7175  ht`` is the sequ
-00033b90: 656e 6365 206c 656e 6774 680a 2020 2020  ence length.    
-00033ba0: 2020 2020 2020 2020 2869 2e65 2e20 7468          (i.e. th
-00033bb0: 6520 6c61 7374 2063 6861 7261 6374 6572  e last character
-00033bc0: 2069 6e20 7468 6520 7374 7269 6e67 2077   in the string w
-00033bd0: 696c 6c20 6265 2074 6865 206c 6173 7420  ill be the last 
-00033be0: 7369 7465 2069 6e20 7468 6520 7472 6565  site in the tree
-00033bf0: 0a20 2020 2020 2020 2020 2020 2073 6571  .            seq
-00033c00: 7565 6e63 6529 2e0a 2020 2020 2020 2020  uence)..        
-00033c10: 3a70 6172 616d 2062 6f6f 6c20 696d 7075  :param bool impu
-00033c20: 7465 5f6d 6973 7369 6e67 5f64 6174 613a  te_missing_data:
-00033c30: 0a20 2020 2020 2020 2020 2020 202a 4465  .            *De
-00033c40: 7072 6563 6174 6564 2069 6e20 302e 332e  precated in 0.3.
-00033c50: 302e 2055 7365 2060 6069 736f 6c61 7465  0. Use ``isolate
-00033c60: 645f 6173 5f6d 6973 7369 6e67 6060 2c20  d_as_missing``, 
-00033c70: 6275 7420 696e 7665 7274 696e 6720 7661  but inverting va
-00033c80: 6c75 652e 0a20 2020 2020 2020 2020 2020  lue..           
-00033c90: 2057 696c 6c20 6265 2072 656d 6f76 6564   Will be removed
-00033ca0: 2069 6e20 6120 6675 7475 7265 2076 6572   in a future ver
-00033cb0: 7369 6f6e 2a0a 2020 2020 2020 2020 3a72  sion*.        :r
-00033cc0: 7479 7065 3a20 636f 6c6c 6563 7469 6f6e  type: collection
-00033cd0: 732e 6162 632e 4974 6572 6162 6c65 0a20  s.abc.Iterable. 
-00033ce0: 2020 2020 2020 203a 7261 6973 6573 3a20         :raises: 
-00033cf0: 5479 7065 4572 726f 7220 6966 2074 6865  TypeError if the
-00033d00: 2060 606d 6973 7369 6e67 5f64 6174 615f   ``missing_data_
-00033d10: 6368 6172 6163 7465 7260 6020 6f72 2061  character`` or a
-00033d20: 6e79 206f 6620 7468 6520 616c 6c65 6c65  ny of the allele
-00033d30: 730a 2020 2020 2020 2020 2020 2020 6174  s.            at
-00033d40: 2061 2073 6974 6520 6172 6520 6e6f 7420   a site are not 
-00033d50: 6120 7369 6e67 6c65 2061 7363 6969 2063  a single ascii c
-00033d60: 6861 7261 6374 6572 2e0a 2020 2020 2020  haracter..      
-00033d70: 2020 3a72 6169 7365 733a 2056 616c 7565    :raises: Value
-00033d80: 4572 726f 720a 2020 2020 2020 2020 2020  Error.          
-00033d90: 2020 6966 2074 6865 2060 606d 6973 7369    if the ``missi
-00033da0: 6e67 5f64 6174 615f 6368 6172 6163 7465  ng_data_characte
-00033db0: 7260 6020 6578 6973 7473 2069 6e20 6f6e  r`` exists in on
-00033dc0: 6520 6f66 2074 6865 2061 6c6c 656c 6573  e of the alleles
-00033dd0: 0a20 2020 2020 2020 2022 2222 0a20 2020  .        """.   
-00033de0: 2020 2020 2069 6620 696d 7075 7465 5f6d       if impute_m
-00033df0: 6973 7369 6e67 5f64 6174 6120 6973 206e  issing_data is n
-00033e00: 6f74 204e 6f6e 653a 0a20 2020 2020 2020  ot None:.       
-00033e10: 2020 2020 2077 6172 6e69 6e67 732e 7761       warnings.wa
-00033e20: 726e 280a 2020 2020 2020 2020 2020 2020  rn(.            
-00033e30: 2020 2020 2254 6865 2069 6d70 7574 655f      "The impute_
-00033e40: 6d69 7373 696e 675f 6461 7461 2070 6172  missing_data par
-00033e50: 616d 6574 6572 2077 6173 2064 6570 7265  ameter was depre
-00033e60: 6361 7465 6420 696e 2030 2e33 2e30 2061  cated in 0.3.0 a
-00033e70: 6e64 2077 696c 6c22 0a20 2020 2020 2020  nd will".       
-00033e80: 2020 2020 2020 2020 2022 2062 6520 7265           " be re
-00033e90: 6d6f 7665 642e 2055 7365 2060 6069 736f  moved. Use ``iso
-00033ea0: 6c61 7465 645f 6173 5f6d 6973 7369 6e67  lated_as_missing
-00033eb0: 3d46 616c 7365 6060 2069 6e73 7465 6164  =False`` instead
-00033ec0: 206f 6622 0a20 2020 2020 2020 2020 2020   of".           
-00033ed0: 2020 2020 2022 6060 696d 7075 7465 5f6d       "``impute_m
-00033ee0: 6973 7369 6e67 5f64 6174 613d 5472 7565  issing_data=True
-00033ef0: 6060 2e22 2c0a 2020 2020 2020 2020 2020  ``.",.          
-00033f00: 2020 2020 2020 4675 7475 7265 5761 726e        FutureWarn
-00033f10: 696e 672c 0a20 2020 2020 2020 2020 2020  ing,.           
-00033f20: 2029 0a20 2020 2020 2020 2023 204f 6e6c   ).        # Onl
-00033f30: 7920 7573 6520 696d 7075 7465 5f6d 6973  y use impute_mis
-00033f40: 7369 6e67 5f64 6174 6120 6966 2069 736f  sing_data if iso
-00033f50: 6c61 7465 645f 6173 5f6d 6973 7369 6e67  lated_as_missing
-00033f60: 2068 6173 2074 6865 2064 6566 6175 6c74   has the default
-00033f70: 2076 616c 7565 0a20 2020 2020 2020 2069   value.        i
-00033f80: 6620 6973 6f6c 6174 6564 5f61 735f 6d69  f isolated_as_mi
-00033f90: 7373 696e 6720 6973 204e 6f6e 653a 0a20  ssing is None:. 
-00033fa0: 2020 2020 2020 2020 2020 2069 736f 6c61             isola
-00033fb0: 7465 645f 6173 5f6d 6973 7369 6e67 203d  ted_as_missing =
-00033fc0: 206e 6f74 2069 6d70 7574 655f 6d69 7373   not impute_miss
-00033fd0: 696e 675f 6461 7461 0a20 2020 2020 2020  ing_data.       
-00033fe0: 2069 6e74 6572 7661 6c20 3d20 7365 6c66   interval = self
-00033ff0: 2e5f 6368 6563 6b5f 6765 6e6f 6d69 635f  ._check_genomic_
-00034000: 7261 6e67 6528 6c65 6674 2c20 7269 6768  range(left, righ
-00034010: 7429 0a20 2020 2020 2020 2048 2c20 5f20  t).        H, _ 
-00034020: 3d20 7365 6c66 2e5f 6861 706c 6f74 7970  = self._haplotyp
-00034030: 6573 5f61 7272 6179 280a 2020 2020 2020  es_array(.      
-00034040: 2020 2020 2020 696e 7465 7276 616c 3d69        interval=i
-00034050: 6e74 6572 7661 6c2c 0a20 2020 2020 2020  nterval,.       
-00034060: 2020 2020 2069 736f 6c61 7465 645f 6173       isolated_as
-00034070: 5f6d 6973 7369 6e67 3d69 736f 6c61 7465  _missing=isolate
-00034080: 645f 6173 5f6d 6973 7369 6e67 2c0a 2020  d_as_missing,.  
-00034090: 2020 2020 2020 2020 2020 6d69 7373 696e            missin
-000340a0: 675f 6461 7461 5f63 6861 7261 6374 6572  g_data_character
-000340b0: 3d6d 6973 7369 6e67 5f64 6174 615f 6368  =missing_data_ch
-000340c0: 6172 6163 7465 722c 0a20 2020 2020 2020  aracter,.       
-000340d0: 2020 2020 2073 616d 706c 6573 3d73 616d       samples=sam
-000340e0: 706c 6573 2c0a 2020 2020 2020 2020 290a  ples,.        ).
-000340f0: 2020 2020 2020 2020 666f 7220 6820 696e          for h in
-00034100: 2048 3a0a 2020 2020 2020 2020 2020 2020   H:.            
-00034110: 7969 656c 6420 682e 746f 6279 7465 7328  yield h.tobytes(
-00034120: 292e 6465 636f 6465 2822 6173 6369 6922  ).decode("ascii"
-00034130: 290a 0a20 2020 2064 6566 2076 6172 6961  )..    def varia
-00034140: 6e74 7328 0a20 2020 2020 2020 2073 656c  nts(.        sel
-00034150: 662c 0a20 2020 2020 2020 202a 2c0a 2020  f,.        *,.  
-00034160: 2020 2020 2020 7361 6d70 6c65 733d 4e6f        samples=No
-00034170: 6e65 2c0a 2020 2020 2020 2020 6973 6f6c  ne,.        isol
-00034180: 6174 6564 5f61 735f 6d69 7373 696e 673d  ated_as_missing=
-00034190: 4e6f 6e65 2c0a 2020 2020 2020 2020 616c  None,.        al
-000341a0: 6c65 6c65 733d 4e6f 6e65 2c0a 2020 2020  leles=None,.    
-000341b0: 2020 2020 696d 7075 7465 5f6d 6973 7369      impute_missi
-000341c0: 6e67 5f64 6174 613d 4e6f 6e65 2c0a 2020  ng_data=None,.  
-000341d0: 2020 2020 2020 636f 7079 3d4e 6f6e 652c        copy=None,
-000341e0: 0a20 2020 2020 2020 206c 6566 743d 4e6f  .        left=No
-000341f0: 6e65 2c0a 2020 2020 2020 2020 7269 6768  ne,.        righ
-00034200: 743d 4e6f 6e65 2c0a 2020 2020 293a 0a20  t=None,.    ):. 
-00034210: 2020 2020 2020 2022 2222 0a20 2020 2020         """.     
-00034220: 2020 2052 6574 7572 6e73 2061 6e20 6974     Returns an it
-00034230: 6572 6174 6f72 206f 7665 7220 7468 6520  erator over the 
-00034240: 7661 7269 616e 7473 2062 6574 7765 656e  variants between
-00034250: 2074 6865 2060 606c 6566 7460 6020 2869   the ``left`` (i
-00034260: 6e63 6c75 7369 7665 290a 2020 2020 2020  nclusive).      
-00034270: 2020 616e 6420 6060 7269 6768 7460 6020    and ``right`` 
-00034280: 2865 7863 6c75 7369 7665 2920 6765 6e6f  (exclusive) geno
-00034290: 6d69 6320 706f 7369 7469 6f6e 7320 696e  mic positions in
-000342a0: 2074 6869 7320 7472 6565 2073 6571 7565   this tree seque
-000342b0: 6e63 652e 2045 6163 680a 2020 2020 2020  nce. Each.      
-000342c0: 2020 7265 7475 726e 6564 203a 636c 6173    returned :clas
-000342d0: 733a 6056 6172 6961 6e74 6020 6f62 6a65  s:`Variant` obje
-000342e0: 6374 2068 6173 2061 2073 6974 652c 2061  ct has a site, a
-000342f0: 206c 6973 7420 6f66 2070 6f73 7369 626c   list of possibl
-00034300: 6520 616c 6c65 6c69 630a 2020 2020 2020  e allelic.      
-00034310: 2020 7374 6174 6573 2061 6e64 2061 6e20    states and an 
-00034320: 6172 7261 7920 6f66 2067 656e 6f74 7970  array of genotyp
-00034330: 6573 2066 6f72 2074 6865 2073 7065 6369  es for the speci
-00034340: 6669 6564 2060 6073 616d 706c 6573 6060  fied ``samples``
-00034350: 2e20 5468 650a 2020 2020 2020 2020 6060  . The.        ``
-00034360: 6765 6e6f 7479 7065 7360 6020 7661 6c75  genotypes`` valu
-00034370: 6520 6973 2061 206e 756d 7079 2061 7272  e is a numpy arr
-00034380: 6179 2063 6f6e 7461 696e 696e 6720 696e  ay containing in
-00034390: 6465 7865 7320 696e 746f 2074 6865 0a20  dexes into the. 
-000343a0: 2020 2020 2020 2060 6061 6c6c 656c 6573         ``alleles
-000343b0: 6060 206c 6973 742e 2042 7920 6465 6661  `` list. By defa
-000343c0: 756c 742c 2074 6869 7320 6c69 7374 2069  ult, this list i
-000343d0: 7320 6765 6e65 7261 7465 6420 6175 746f  s generated auto
-000343e0: 6d61 7469 6361 6c6c 7920 666f 720a 2020  matically for.  
-000343f0: 2020 2020 2020 6561 6368 2073 6974 6520        each site 
-00034400: 7375 6368 2074 6861 7420 7468 6520 6669  such that the fi
-00034410: 7273 7420 656e 7472 792c 2060 6061 6c6c  rst entry, ``all
-00034420: 656c 6573 5b30 5d60 602c 2069 7320 7468  eles[0]``, is th
-00034430: 6520 616e 6365 7374 7261 6c0a 2020 2020  e ancestral.    
-00034440: 2020 2020 7374 6174 6520 616e 6420 7375      state and su
-00034450: 6273 6571 7565 6e74 2061 6c6c 656c 6573  bsequent alleles
-00034460: 2061 7265 206c 6973 7465 6420 696e 206e   are listed in n
-00034470: 6f0a 2020 2020 2020 2020 7061 7274 6963  o.        partic
-00034480: 756c 6172 206f 7264 6572 2e20 5468 6973  ular order. This
-00034490: 206d 6561 6e73 2074 6861 7420 7468 6520   means that the 
-000344a0: 656e 636f 6469 6e67 206f 6620 616c 6c65  encoding of alle
-000344b0: 6c65 7320 696e 0a20 2020 2020 2020 2074  les in.        t
-000344c0: 6572 6d73 206f 6620 6765 6e6f 7479 7065  erms of genotype
-000344d0: 2076 616c 7565 7320 6361 6e20 7661 7279   values can vary
-000344e0: 2066 726f 6d20 7369 7465 2d74 6f2d 7369   from site-to-si
-000344f0: 7465 2c20 7768 6963 6820 6973 0a20 2020  te, which is.   
-00034500: 2020 2020 2073 6f6d 6574 696d 6573 2069       sometimes i
-00034510: 6e63 6f6e 7665 6e69 656e 742e 2049 7420  nconvenient. It 
-00034520: 6973 2070 6f73 7369 626c 6520 746f 2073  is possible to s
-00034530: 7065 6369 6679 2061 2066 6978 6564 206d  pecify a fixed m
-00034540: 6170 7069 6e67 0a20 2020 2020 2020 2066  apping.        f
-00034550: 726f 6d20 616c 6c65 6c65 2073 7472 696e  rom allele strin
-00034560: 6773 2074 6f20 6765 6e6f 7479 7065 2076  gs to genotype v
-00034570: 616c 7565 7320 7573 696e 6720 7468 6520  alues using the 
-00034580: 6060 616c 6c65 6c65 7360 600a 2020 2020  ``alleles``.    
-00034590: 2020 2020 7061 7261 6d65 7465 722e 2046      parameter. F
-000345a0: 6f72 2065 7861 6d70 6c65 2c20 6966 2077  or example, if w
-000345b0: 6520 7365 7420 6060 616c 6c65 6c65 733d  e set ``alleles=
-000345c0: 2822 4122 2c20 2243 222c 2022 4722 2c20  ("A", "C", "G", 
-000345d0: 2254 2229 6060 2c0a 2020 2020 2020 2020  "T")``,.        
-000345e0: 7468 6973 2077 696c 6c20 6d61 7020 616c  this will map al
-000345f0: 6c65 6c65 2022 4122 2074 6f20 302c 2022  lele "A" to 0, "
-00034600: 4322 2074 6f20 3120 616e 6420 736f 206f  C" to 1 and so o
-00034610: 6e20 2874 6865 0a20 2020 2020 2020 203a  n (the.        :
-00034620: 6461 7461 3a60 414c 4c45 4c45 535f 4143  data:`ALLELES_AC
-00034630: 4754 6020 636f 6e73 7461 6e74 2070 726f  GT` constant pro
-00034640: 7669 6465 7320 6120 7368 6f72 7463 7574  vides a shortcut
-00034650: 2066 6f72 2074 6869 730a 2020 2020 2020   for this.      
-00034660: 2020 636f 6d6d 6f6e 206d 6170 7069 6e67    common mapping
-00034670: 292e 0a0a 2020 2020 2020 2020 4279 2064  )...        By d
-00034680: 6566 6175 6c74 2c20 6765 6e6f 7479 7065  efault, genotype
-00034690: 7320 6172 6520 6765 6e65 7261 7465 6420  s are generated 
-000346a0: 666f 7220 616c 6c20 7361 6d70 6c65 732e  for all samples.
-000346b0: 2054 6865 2060 6073 616d 706c 6573 6060   The ``samples``
-000346c0: 0a20 2020 2020 2020 2070 6172 616d 6574  .        paramet
-000346d0: 6572 2061 6c6c 6f77 7320 7573 2074 6f20  er allows us to 
-000346e0: 7370 6563 6966 7920 7468 6520 6e6f 6465  specify the node
-000346f0: 7320 666f 7220 7768 6963 6820 6765 6e6f  s for which geno
-00034700: 7479 7065 7320 6172 650a 2020 2020 2020  types are.      
-00034710: 2020 6765 6e65 7261 7465 643b 206f 7574    generated; out
-00034720: 7075 7420 6f72 6465 7220 6f66 2067 656e  put order of gen
-00034730: 6f74 7970 6573 2069 6e20 7468 6520 7265  otypes in the re
-00034740: 7475 726e 6564 2076 6172 6961 6e74 730a  turned variants.
-00034750: 2020 2020 2020 2020 636f 7272 6573 706f          correspo
-00034760: 6e64 7320 746f 2074 6865 206f 7264 6572  nds to the order
-00034770: 206f 6620 7468 6520 7361 6d70 6c65 7320   of the samples 
-00034780: 696e 2074 6869 7320 6c69 7374 2e20 4974  in this list. It
-00034790: 2069 7320 616c 736f 0a20 2020 2020 2020   is also.       
-000347a0: 2070 6f73 7369 626c 6520 746f 2070 726f   possible to pro
-000347b0: 7669 6465 202a 2a6e 6f6e 2d73 616d 706c  vide **non-sampl
-000347c0: 652a 2a20 6e6f 6465 7320 6173 2061 6e20  e** nodes as an 
-000347d0: 6172 6775 6d65 6e74 2068 6572 652c 2069  argument here, i
-000347e0: 6620 796f 750a 2020 2020 2020 2020 7769  f you.        wi
-000347f0: 7368 2074 6f20 6765 6e65 7261 7465 2067  sh to generate g
-00034800: 656e 6f74 7970 6573 2066 6f72 2028 652e  enotypes for (e.
-00034810: 672e 2920 696e 7465 726e 616c 206e 6f64  g.) internal nod
-00034820: 6573 2e20 486f 7765 7665 722c 0a20 2020  es. However,.   
-00034830: 2020 2020 2060 6069 736f 6c61 7465 645f       ``isolated_
-00034840: 6173 5f6d 6973 7369 6e67 6060 206d 7573  as_missing`` mus
-00034850: 7420 6265 2046 616c 7365 2069 6e20 7468  t be False in th
-00034860: 6973 2063 6173 652c 2061 7320 6974 2069  is case, as it i
-00034870: 7320 6e6f 740a 2020 2020 2020 2020 706f  s not.        po
-00034880: 7373 6962 6c65 2074 6f20 6465 7465 6374  ssible to detect
-00034890: 206d 6973 7369 6e67 2064 6174 6120 666f   missing data fo
-000348a0: 7220 6e6f 6e2d 7361 6d70 6c65 206e 6f64  r non-sample nod
-000348b0: 6573 2e0a 0a20 2020 2020 2020 2049 6620  es...        If 
-000348c0: 6973 6f6c 6174 6564 2073 616d 706c 6573  isolated samples
-000348d0: 2061 7265 2070 7265 7365 6e74 2061 7420   are present at 
-000348e0: 6120 6769 7665 6e20 7369 7465 2077 6974  a given site wit
-000348f0: 686f 7574 206d 7574 6174 696f 6e73 2061  hout mutations a
-00034900: 626f 7665 2074 6865 6d2c 0a20 2020 2020  bove them,.     
-00034910: 2020 2074 6865 7920 6172 6520 696e 7465     they are inte
-00034920: 7270 7265 7465 6420 6279 2064 6566 6175  rpreted by defau
-00034930: 6c74 2061 730a 2020 2020 2020 2020 3a72  lt as.        :r
-00034940: 6566 3a60 6d69 7373 696e 6720 6461 7461  ef:`missing data
-00034950: 3c73 6563 5f64 6174 615f 6d6f 6465 6c5f  <sec_data_model_
-00034960: 6d69 7373 696e 675f 6461 7461 3e60 2c20  missing_data>`, 
-00034970: 616e 6420 7468 6520 6765 6e6f 7479 7065  and the genotype
-00034980: 7320 6172 7261 790a 2020 2020 2020 2020  s array.        
-00034990: 7769 6c6c 2063 6f6e 7461 696e 2061 2073  will contain a s
-000349a0: 7065 6369 616c 2076 616c 7565 203a 6461  pecial value :da
-000349b0: 7461 3a60 4d49 5353 494e 475f 4441 5441  ta:`MISSING_DATA
-000349c0: 6020 282d 3129 2074 6f20 6964 656e 7469  ` (-1) to identi
-000349d0: 6679 2074 6865 6d0a 2020 2020 2020 2020  fy them.        
-000349e0: 7768 696c 6520 7468 6520 6060 616c 6c65  while the ``alle
-000349f0: 6c65 7360 6020 7475 706c 6520 7769 6c6c  les`` tuple will
-00034a00: 2065 6e64 2077 6974 6820 7468 6520 7661   end with the va
-00034a10: 6c75 6520 6060 4e6f 6e65 6060 2028 6e6f  lue ``None`` (no
-00034a20: 7465 2074 6861 7420 7468 6973 0a20 2020  te that this.   
-00034a30: 2020 2020 2077 696c 6c20 6265 2074 6865       will be the
-00034a40: 2063 6173 6520 7768 6574 6865 7220 6f72   case whether or
-00034a50: 206e 6f74 2077 6520 7370 6563 6966 7920   not we specify 
-00034a60: 6120 6669 7865 6420 6d61 7070 696e 6720  a fixed mapping 
-00034a70: 7573 696e 6720 7468 650a 2020 2020 2020  using the.      
-00034a80: 2020 6060 616c 6c65 6c65 7360 6020 7061    ``alleles`` pa
-00034a90: 7261 6d65 7465 723b 2073 6565 2074 6865  rameter; see the
-00034aa0: 203a 636c 6173 733a 6056 6172 6961 6e74   :class:`Variant
-00034ab0: 6020 636c 6173 7320 666f 7220 6d6f 7265  ` class for more
-00034ac0: 2064 6574 6169 6c73 292e 0a20 2020 2020   details)..     
-00034ad0: 2020 2041 6c74 6572 6e61 7469 7665 6c79     Alternatively
-00034ae0: 2c20 6966 2060 6069 736f 6c61 7465 645f  , if ``isolated_
-00034af0: 6173 5f6d 6973 7369 6e67 6060 2069 7320  as_missing`` is 
-00034b00: 7365 7420 746f 2074 6f20 4661 6c73 652c  set to to False,
-00034b10: 2073 7563 6820 6973 6f6c 6174 6564 0a20   such isolated. 
-00034b20: 2020 2020 2020 2073 616d 706c 6573 2077         samples w
-00034b30: 696c 6c20 6e6f 7420 6265 2074 7265 6174  ill not be treat
-00034b40: 6564 2061 7320 6d69 7373 696e 672c 2061  ed as missing, a
-00034b50: 6e64 2069 6e73 7465 6164 2061 7373 6967  nd instead assig
-00034b60: 6e65 6420 7468 6520 616e 6365 7374 7261  ned the ancestra
-00034b70: 6c0a 2020 2020 2020 2020 7374 6174 6520  l.        state 
-00034b80: 2874 6869 7320 7761 7320 7468 6520 6465  (this was the de
-00034b90: 6661 756c 7420 6265 6861 7669 6f75 7220  fault behaviour 
-00034ba0: 696e 2076 6572 7369 6f6e 7320 7072 696f  in versions prio
-00034bb0: 7220 746f 2030 2e32 2e30 292e 2050 7269  r to 0.2.0). Pri
-00034bc0: 6f72 2074 6f0a 2020 2020 2020 2020 302e  or to.        0.
-00034bd0: 332e 3020 7468 6520 6069 6d70 7574 655f  3.0 the `impute_
-00034be0: 6d69 7373 696e 675f 6461 7461 6020 6172  missing_data` ar
-00034bf0: 6775 6d65 6e74 2063 6f6e 7472 6f6c 6c65  gument controlle
-00034c00: 6420 7468 6973 2062 6568 6176 696f 7572  d this behaviour
-00034c10: 2e0a 0a20 2020 2020 2020 203a 7061 7261  ...        :para
-00034c20: 6d20 6172 7261 795f 6c69 6b65 2073 616d  m array_like sam
-00034c30: 706c 6573 3a20 416e 2061 7272 6179 206f  ples: An array o
-00034c40: 6620 6e6f 6465 2049 4473 2066 6f72 2077  f node IDs for w
-00034c50: 6869 6368 2074 6f20 6765 6e65 7261 7465  hich to generate
-00034c60: 0a20 2020 2020 2020 2020 2020 2067 656e  .            gen
-00034c70: 6f74 7970 6573 2c20 6f72 204e 6f6e 6520  otypes, or None 
-00034c80: 666f 7220 616c 6c20 7361 6d70 6c65 206e  for all sample n
-00034c90: 6f64 6573 2e20 4465 6661 756c 743a 204e  odes. Default: N
-00034ca0: 6f6e 652e 0a20 2020 2020 2020 203a 7061  one..        :pa
-00034cb0: 7261 6d20 626f 6f6c 2069 736f 6c61 7465  ram bool isolate
-00034cc0: 645f 6173 5f6d 6973 7369 6e67 3a20 4966  d_as_missing: If
-00034cd0: 2054 7275 652c 2074 6865 2067 656e 6f74   True, the genot
-00034ce0: 7970 6520 7661 6c75 6520 6173 7369 676e  ype value assign
-00034cf0: 6564 2074 6f0a 2020 2020 2020 2020 2020  ed to.          
-00034d00: 2020 6d69 7373 696e 6720 7361 6d70 6c65    missing sample
-00034d10: 7320 2869 2e65 2e2c 2069 736f 6c61 7465  s (i.e., isolate
-00034d20: 6420 7361 6d70 6c65 7320 7769 7468 6f75  d samples withou
-00034d30: 7420 6d75 7461 7469 6f6e 7329 2069 730a  t mutations) is.
-00034d40: 2020 2020 2020 2020 2020 2020 3a64 6174              :dat
-00034d50: 613a 602e 4d49 5353 494e 475f 4441 5441  a:`.MISSING_DATA
-00034d60: 6020 282d 3129 2e20 4966 2046 616c 7365  ` (-1). If False
-00034d70: 2c20 6d69 7373 696e 6720 7361 6d70 6c65  , missing sample
-00034d80: 7320 7769 6c6c 2062 650a 2020 2020 2020  s will be.      
-00034d90: 2020 2020 2020 6173 7369 676e 6564 2074        assigned t
-00034da0: 6865 2061 6c6c 656c 6520 696e 6465 7820  he allele index 
-00034db0: 666f 7220 7468 6520 616e 6365 7374 7261  for the ancestra
-00034dc0: 6c20 7374 6174 652e 0a20 2020 2020 2020  l state..       
-00034dd0: 2020 2020 2044 6566 6175 6c74 3a20 5472       Default: Tr
-00034de0: 7565 2e0a 2020 2020 2020 2020 3a70 6172  ue..        :par
-00034df0: 616d 2074 7570 6c65 2061 6c6c 656c 6573  am tuple alleles
-00034e00: 3a20 4120 7475 706c 6520 6f66 2073 7472  : A tuple of str
-00034e10: 696e 6773 2064 6566 696e 696e 6720 7468  ings defining th
-00034e20: 6520 656e 636f 6469 6e67 206f 660a 2020  e encoding of.  
-00034e30: 2020 2020 2020 2020 2020 616c 6c65 6c65            allele
-00034e40: 7320 6173 2069 6e74 6567 6572 2067 656e  s as integer gen
-00034e50: 6f74 7970 6520 7661 6c75 6573 2e20 4174  otype values. At
-00034e60: 206c 6561 7374 206f 6e65 2061 6c6c 656c   least one allel
-00034e70: 6520 6d75 7374 2062 6520 7072 6f76 6964  e must be provid
-00034e80: 6564 2e0a 2020 2020 2020 2020 2020 2020  ed..            
-00034e90: 4966 2064 7570 6c69 6361 7465 2061 6c6c  If duplicate all
-00034ea0: 656c 6573 2061 7265 2070 726f 7669 6465  eles are provide
-00034eb0: 642c 206f 7574 7075 7420 6765 6e6f 7479  d, output genoty
-00034ec0: 7065 7320 7769 6c6c 2061 6c77 6179 7320  pes will always 
-00034ed0: 6265 0a20 2020 2020 2020 2020 2020 2065  be.            e
-00034ee0: 6e63 6f64 6564 2061 7320 7468 6520 6669  ncoded as the fi
-00034ef0: 7273 7420 6f63 6375 7272 656e 6365 206f  rst occurrence o
-00034f00: 6620 7468 6520 616c 6c65 6c65 2e20 4966  f the allele. If
-00034f10: 204e 6f6e 6520 2874 6865 2064 6566 6175   None (the defau
-00034f20: 6c74 292c 0a20 2020 2020 2020 2020 2020  lt),.           
-00034f30: 2074 6865 2061 6c6c 656c 6573 2061 7265   the alleles are
-00034f40: 2065 6e63 6f64 6564 2061 7320 7468 6579   encoded as they
-00034f50: 2061 7265 2065 6e63 6f75 6e74 6572 6564   are encountered
-00034f60: 2064 7572 696e 6720 6765 6e6f 7479 7065   during genotype
-00034f70: 0a20 2020 2020 2020 2020 2020 2067 656e  .            gen
-00034f80: 6572 6174 696f 6e2e 0a20 2020 2020 2020  eration..       
-00034f90: 203a 7061 7261 6d20 626f 6f6c 2069 6d70   :param bool imp
-00034fa0: 7574 655f 6d69 7373 696e 675f 6461 7461  ute_missing_data
-00034fb0: 3a0a 2020 2020 2020 2020 2020 2020 2a44  :.            *D
-00034fc0: 6570 7265 6361 7465 6420 696e 2030 2e33  eprecated in 0.3
-00034fd0: 2e30 2e20 5573 6520 6060 6973 6f6c 6174  .0. Use ``isolat
-00034fe0: 6564 5f61 735f 6d69 7373 696e 6760 602c  ed_as_missing``,
-00034ff0: 2062 7574 2069 6e76 6572 7469 6e67 2076   but inverting v
-00035000: 616c 7565 2e0a 2020 2020 2020 2020 2020  alue..          
-00035010: 2020 5769 6c6c 2062 6520 7265 6d6f 7665    Will be remove
-00035020: 6420 696e 2061 2066 7574 7572 6520 7665  d in a future ve
-00035030: 7273 696f 6e2a 0a20 2020 2020 2020 203a  rsion*.        :
-00035040: 7061 7261 6d20 626f 6f6c 2063 6f70 793a  param bool copy:
-00035050: 0a20 2020 2020 2020 2020 2020 2049 6620  .            If 
-00035060: 4661 6c73 6520 7265 2d75 7365 2074 6865  False re-use the
-00035070: 2073 616d 6520 5661 7269 616e 7420 6f62   same Variant ob
-00035080: 6a65 6374 2066 6f72 2065 6163 6820 7369  ject for each si
-00035090: 7465 2073 7563 6820 7468 6174 2061 6e79  te such that any
-000350a0: 0a20 2020 2020 2020 2020 2020 2072 6566  .            ref
-000350b0: 6572 656e 6365 7320 6865 6c64 2074 6f20  erences held to 
-000350c0: 6974 2061 7265 206f 7665 7277 7269 7474  it are overwritt
-000350d0: 656e 2077 6865 6e20 7468 6520 6e65 7874  en when the next
-000350e0: 2073 6974 6520 6973 2076 6973 6974 6564   site is visited
-000350f0: 2e0a 2020 2020 2020 2020 2020 2020 4966  ..            If
-00035100: 2054 7275 6520 7265 7475 726e 2061 2066   True return a f
-00035110: 7265 7368 203a 636c 6173 733a 6056 6172  resh :class:`Var
-00035120: 6961 6e74 6020 666f 7220 6561 6368 2073  iant` for each s
-00035130: 6974 652e 2044 6566 6175 6c74 3a20 5472  ite. Default: Tr
-00035140: 7565 2e0a 2020 2020 2020 2020 3a70 6172  ue..        :par
-00035150: 616d 2069 6e74 206c 6566 743a 2053 7461  am int left: Sta
-00035160: 7274 2077 6974 6820 7468 6520 6669 7273  rt with the firs
-00035170: 7420 7369 7465 2061 7420 6f72 2061 6674  t site at or aft
-00035180: 6572 0a20 2020 2020 2020 2020 2020 2074  er.            t
-00035190: 6869 7320 6765 6e6f 6d69 6320 706f 7369  his genomic posi
-000351a0: 7469 6f6e 2e20 4966 2060 604e 6f6e 6560  tion. If ``None`
-000351b0: 6020 2864 6566 6175 6c74 2920 7374 6172  ` (default) star
-000351c0: 7420 6174 2074 6865 2066 6972 7374 2073  t at the first s
-000351d0: 6974 652e 0a20 2020 2020 2020 203a 7061  ite..        :pa
-000351e0: 7261 6d20 696e 7420 7269 6768 743a 2045  ram int right: E
-000351f0: 6e64 2077 6974 6820 7468 6520 6c61 7374  nd with the last
-00035200: 2073 6974 6520 6265 666f 7265 2074 6869   site before thi
-00035210: 7320 706f 7369 7469 6f6e 2e20 4966 2060  s position. If `
-00035220: 604e 6f6e 6560 600a 2020 2020 2020 2020  `None``.        
-00035230: 2020 2020 2864 6566 6175 6c74 2920 6173      (default) as
-00035240: 7375 6d65 2060 6072 6967 6874 6060 2069  sume ``right`` i
-00035250: 7320 7468 6520 7365 7175 656e 6365 206c  s the sequence l
-00035260: 656e 6774 682c 2073 6f20 7468 6174 2074  ength, so that t
-00035270: 6865 206c 6173 740a 2020 2020 2020 2020  he last.        
-00035280: 2020 2020 7661 7269 616e 7420 636f 7272      variant corr
-00035290: 6573 706f 6e64 7320 746f 2074 6865 206c  esponds to the l
-000352a0: 6173 7420 7369 7465 2069 6e20 7468 6520  ast site in the 
-000352b0: 7472 6565 2073 6571 7565 6e63 652e 0a20  tree sequence.. 
-000352c0: 2020 2020 2020 203a 7265 7475 726e 3a20         :return: 
-000352d0: 416e 2069 7465 7261 746f 7220 6f76 6572  An iterator over
-000352e0: 2061 6c6c 2076 6172 6961 6e74 7320 696e   all variants in
-000352f0: 2074 6869 7320 7472 6565 2073 6571 7565   this tree seque
-00035300: 6e63 652e 0a20 2020 2020 2020 203a 7274  nce..        :rt
-00035310: 7970 653a 2069 7465 7228 3a63 6c61 7373  ype: iter(:class
-00035320: 3a60 5661 7269 616e 7460 290a 2020 2020  :`Variant`).    
-00035330: 2020 2020 2222 220a 2020 2020 2020 2020      """.        
-00035340: 696e 7465 7276 616c 203d 2073 656c 662e  interval = self.
-00035350: 5f63 6865 636b 5f67 656e 6f6d 6963 5f72  _check_genomic_r
-00035360: 616e 6765 286c 6566 742c 2072 6967 6874  ange(left, right
-00035370: 290a 2020 2020 2020 2020 6966 2069 6d70  ).        if imp
-00035380: 7574 655f 6d69 7373 696e 675f 6461 7461  ute_missing_data
-00035390: 2069 7320 6e6f 7420 4e6f 6e65 3a0a 2020   is not None:.  
-000353a0: 2020 2020 2020 2020 2020 7761 726e 696e            warnin
-000353b0: 6773 2e77 6172 6e28 0a20 2020 2020 2020  gs.warn(.       
-000353c0: 2020 2020 2020 2020 2022 5468 6520 696d           "The im
-000353d0: 7075 7465 5f6d 6973 7369 6e67 5f64 6174  pute_missing_dat
-000353e0: 6120 7061 7261 6d65 7465 7220 7761 7320  a parameter was 
-000353f0: 6465 7072 6563 6174 6564 2069 6e20 302e  deprecated in 0.
-00035400: 332e 3020 616e 6420 7769 6c6c 220a 2020  3.0 and will".  
-00035410: 2020 2020 2020 2020 2020 2020 2020 2220                " 
-00035420: 6265 2072 656d 6f76 6564 2e20 5573 6520  be removed. Use 
-00035430: 6060 6973 6f6c 6174 6564 5f61 735f 6d69  ``isolated_as_mi
-00035440: 7373 696e 673d 4661 6c73 6560 6020 696e  ssing=False`` in
-00035450: 7374 6561 6420 6f66 220a 2020 2020 2020  stead of".      
-00035460: 2020 2020 2020 2020 2020 2260 6069 6d70            "``imp
-00035470: 7574 655f 6d69 7373 696e 675f 6461 7461  ute_missing_data
-00035480: 3d54 7275 6560 602e 222c 0a20 2020 2020  =True``.",.     
-00035490: 2020 2020 2020 2020 2020 2046 7574 7572             Futur
-000354a0: 6557 6172 6e69 6e67 2c0a 2020 2020 2020  eWarning,.      
-000354b0: 2020 2020 2020 290a 2020 2020 2020 2020        ).        
-000354c0: 2320 4f6e 6c79 2075 7365 2069 6d70 7574  # Only use imput
-000354d0: 655f 6d69 7373 696e 675f 6461 7461 2069  e_missing_data i
-000354e0: 6620 6973 6f6c 6174 6564 5f61 735f 6d69  f isolated_as_mi
-000354f0: 7373 696e 6720 6861 7320 7468 6520 6465  ssing has the de
-00035500: 6661 756c 7420 7661 6c75 650a 2020 2020  fault value.    
-00035510: 2020 2020 6966 2069 736f 6c61 7465 645f      if isolated_
-00035520: 6173 5f6d 6973 7369 6e67 2069 7320 4e6f  as_missing is No
-00035530: 6e65 3a0a 2020 2020 2020 2020 2020 2020  ne:.            
-00035540: 6973 6f6c 6174 6564 5f61 735f 6d69 7373  isolated_as_miss
-00035550: 696e 6720 3d20 6e6f 7420 696d 7075 7465  ing = not impute
-00035560: 5f6d 6973 7369 6e67 5f64 6174 610a 2020  _missing_data.  
-00035570: 2020 2020 2020 6966 2063 6f70 7920 6973        if copy is
-00035580: 204e 6f6e 653a 0a20 2020 2020 2020 2020   None:.         
-00035590: 2020 2063 6f70 7920 3d20 5472 7565 0a20     copy = True. 
-000355a0: 2020 2020 2020 2023 2053 6565 2063 6f6d         # See com
-000355b0: 6d65 6e74 7320 666f 7220 7468 6520 5661  ments for the Va
-000355c0: 7269 616e 7420 7479 7065 2066 6f72 2064  riant type for d
-000355d0: 6973 6375 7373 696f 6e20 6f6e 2077 6879  iscussion on why
-000355e0: 2074 6865 0a20 2020 2020 2020 2023 2070   the.        # p
-000355f0: 7265 7365 6e74 2066 6f72 6d20 7761 7320  resent form was 
-00035600: 6368 6f73 656e 2e0a 2020 2020 2020 2020  chosen..        
-00035610: 7661 7269 616e 7420 3d20 7473 6b69 742e  variant = tskit.
-00035620: 5661 7269 616e 7428 0a20 2020 2020 2020  Variant(.       
-00035630: 2020 2020 2073 656c 662c 0a20 2020 2020       self,.     
-00035640: 2020 2020 2020 2073 616d 706c 6573 3d73         samples=s
-00035650: 616d 706c 6573 2c0a 2020 2020 2020 2020  amples,.        
-00035660: 2020 2020 6973 6f6c 6174 6564 5f61 735f      isolated_as_
-00035670: 6d69 7373 696e 673d 6973 6f6c 6174 6564  missing=isolated
-00035680: 5f61 735f 6d69 7373 696e 672c 0a20 2020  _as_missing,.   
-00035690: 2020 2020 2020 2020 2061 6c6c 656c 6573           alleles
-000356a0: 3d61 6c6c 656c 6573 2c0a 2020 2020 2020  =alleles,.      
-000356b0: 2020 290a 2020 2020 2020 2020 6966 206c    ).        if l
-000356c0: 6566 7420 3d3d 2030 2061 6e64 2072 6967  eft == 0 and rig
-000356d0: 6874 203d 3d20 7365 6c66 2e73 6571 7565  ht == self.seque
-000356e0: 6e63 655f 6c65 6e67 7468 3a0a 2020 2020  nce_length:.    
-000356f0: 2020 2020 2020 2020 7374 6172 7420 3d20          start = 
-00035700: 300a 2020 2020 2020 2020 2020 2020 7374  0.            st
-00035710: 6f70 203d 2073 656c 662e 6e75 6d5f 7369  op = self.num_si
-00035720: 7465 730a 2020 2020 2020 2020 656c 7365  tes.        else
-00035730: 3a0a 2020 2020 2020 2020 2020 2020 7374  :.            st
-00035740: 6172 742c 2073 746f 7020 3d20 6e70 2e73  art, stop = np.s
-00035750: 6561 7263 6873 6f72 7465 6428 7365 6c66  earchsorted(self
-00035760: 2e73 6974 6573 5f70 6f73 6974 696f 6e2c  .sites_position,
-00035770: 2069 6e74 6572 7661 6c29 0a0a 2020 2020   interval)..    
-00035780: 2020 2020 6966 2063 6f70 793a 0a20 2020      if copy:.   
-00035790: 2020 2020 2020 2020 2066 6f72 2073 6974           for sit
-000357a0: 655f 6964 2069 6e20 7261 6e67 6528 7374  e_id in range(st
-000357b0: 6172 742c 2073 746f 7029 3a0a 2020 2020  art, stop):.    
-000357c0: 2020 2020 2020 2020 2020 2020 7661 7269              vari
-000357d0: 616e 742e 6465 636f 6465 2873 6974 655f  ant.decode(site_
-000357e0: 6964 290a 2020 2020 2020 2020 2020 2020  id).            
-000357f0: 2020 2020 7969 656c 6420 7661 7269 616e      yield varian
-00035800: 742e 636f 7079 2829 0a20 2020 2020 2020  t.copy().       
-00035810: 2065 6c73 653a 0a20 2020 2020 2020 2020   else:.         
-00035820: 2020 2066 6f72 2073 6974 655f 6964 2069     for site_id i
-00035830: 6e20 7261 6e67 6528 7374 6172 742c 2073  n range(start, s
-00035840: 746f 7029 3a0a 2020 2020 2020 2020 2020  top):.          
-00035850: 2020 2020 2020 7661 7269 616e 742e 6465        variant.de
-00035860: 636f 6465 2873 6974 655f 6964 290a 2020  code(site_id).  
-00035870: 2020 2020 2020 2020 2020 2020 2020 7969                yi
-00035880: 656c 6420 7661 7269 616e 740a 0a20 2020  eld variant..   
-00035890: 2064 6566 2067 656e 6f74 7970 655f 6d61   def genotype_ma
-000358a0: 7472 6978 280a 2020 2020 2020 2020 7365  trix(.        se
-000358b0: 6c66 2c0a 2020 2020 2020 2020 2a2c 0a20  lf,.        *,. 
-000358c0: 2020 2020 2020 2073 616d 706c 6573 3d4e         samples=N
-000358d0: 6f6e 652c 0a20 2020 2020 2020 2069 736f  one,.        iso
-000358e0: 6c61 7465 645f 6173 5f6d 6973 7369 6e67  lated_as_missing
-000358f0: 3d4e 6f6e 652c 0a20 2020 2020 2020 2061  =None,.        a
-00035900: 6c6c 656c 6573 3d4e 6f6e 652c 0a20 2020  lleles=None,.   
-00035910: 2020 2020 2069 6d70 7574 655f 6d69 7373       impute_miss
-00035920: 696e 675f 6461 7461 3d4e 6f6e 652c 0a20  ing_data=None,. 
-00035930: 2020 2029 3a0a 2020 2020 2020 2020 2222     ):.        ""
-00035940: 220a 2020 2020 2020 2020 5265 7475 726e  ".        Return
-00035950: 7320 616e 203a 6d61 7468 3a60 6d20 5c5c  s an :math:`m \\
-00035960: 7469 6d65 7320 6e60 206e 756d 7079 2061  times n` numpy a
-00035970: 7272 6179 206f 6620 7468 6520 6765 6e6f  rray of the geno
-00035980: 7479 7065 7320 696e 2074 6869 730a 2020  types in this.  
-00035990: 2020 2020 2020 7472 6565 2073 6571 7565        tree seque
-000359a0: 6e63 652c 2077 6865 7265 203a 6d61 7468  nce, where :math
-000359b0: 3a60 6d60 2069 7320 7468 6520 6e75 6d62  :`m` is the numb
-000359c0: 6572 206f 6620 7369 7465 7320 616e 6420  er of sites and 
-000359d0: 3a6d 6174 683a 606e 600a 2020 2020 2020  :math:`n`.      
-000359e0: 2020 7468 6520 6e75 6d62 6572 206f 6620    the number of 
-000359f0: 7361 6d70 6c65 732e 2054 6865 2067 656e  samples. The gen
-00035a00: 6f74 7970 6573 2061 7265 2074 6865 2069  otypes are the i
-00035a10: 6e64 6578 6573 2069 6e74 6f20 7468 6520  ndexes into the 
-00035a20: 6172 7261 790a 2020 2020 2020 2020 6f66  array.        of
-00035a30: 2060 6061 6c6c 656c 6573 6060 2c20 6173   ``alleles``, as
-00035a40: 2064 6573 6372 6962 6564 2066 6f72 2074   described for t
-00035a50: 6865 203a 636c 6173 733a 6056 6172 6961  he :class:`Varia
-00035a60: 6e74 6020 636c 6173 732e 0a0a 2020 2020  nt` class...    
-00035a70: 2020 2020 4966 2069 736f 6c61 7465 6420      If isolated 
-00035a80: 7361 6d70 6c65 7320 6172 6520 7072 6573  samples are pres
-00035a90: 656e 7420 6174 2061 2067 6976 656e 2073  ent at a given s
-00035aa0: 6974 6520 7769 7468 6f75 7420 6d75 7461  ite without muta
-00035ab0: 7469 6f6e 7320 6162 6f76 6520 7468 656d  tions above them
-00035ac0: 2c0a 2020 2020 2020 2020 7468 6579 2077  ,.        they w
-00035ad0: 696c 6c20 6265 2069 6e74 6572 7072 6574  ill be interpret
-00035ae0: 6564 2061 7320 3a72 6566 3a60 6d69 7373  ed as :ref:`miss
-00035af0: 696e 6720 6461 7461 3c73 6563 5f64 6174  ing data<sec_dat
-00035b00: 615f 6d6f 6465 6c5f 6d69 7373 696e 675f  a_model_missing_
-00035b10: 6461 7461 3e60 0a20 2020 2020 2020 2074  data>`.        t
-00035b20: 6865 2067 656e 6f74 7970 6573 2061 7272  he genotypes arr
-00035b30: 6179 2077 696c 6c20 636f 6e74 6169 6e20  ay will contain 
-00035b40: 6120 7370 6563 6961 6c20 7661 6c75 6520  a special value 
-00035b50: 3a64 6174 613a 604d 4953 5349 4e47 5f44  :data:`MISSING_D
-00035b60: 4154 4160 0a20 2020 2020 2020 2028 2d31  ATA`.        (-1
-00035b70: 2920 746f 2069 6465 6e74 6966 7920 7468  ) to identify th
-00035b80: 6573 6520 6d69 7373 696e 6720 7361 6d70  ese missing samp
-00035b90: 6c65 732e 0a0a 2020 2020 2020 2020 5375  les...        Su
-00035ba0: 6368 2073 616d 706c 6573 2061 7265 2074  ch samples are t
-00035bb0: 7265 6174 6564 2061 7320 6d69 7373 696e  reated as missin
-00035bc0: 6720 6461 7461 2062 7920 6465 6661 756c  g data by defaul
-00035bd0: 742c 2062 7574 2069 660a 2020 2020 2020  t, but if.      
-00035be0: 2020 6060 6973 6f6c 6174 6564 5f61 735f    ``isolated_as_
-00035bf0: 6d69 7373 696e 6760 6020 6973 2073 6574  missing`` is set
-00035c00: 2074 6f20 746f 2046 616c 7365 2c20 7468   to to False, th
-00035c10: 6579 2077 696c 6c20 6e6f 7420 6265 2074  ey will not be t
-00035c20: 7265 6174 6564 2061 7320 6d69 7373 696e  reated as missin
-00035c30: 672c 0a20 2020 2020 2020 2061 6e64 2073  g,.        and s
-00035c40: 6f20 6173 7369 676e 6564 2074 6865 2061  o assigned the a
-00035c50: 6e63 6573 7472 616c 2073 7461 7465 2e20  ncestral state. 
-00035c60: 5468 6973 2077 6173 2074 6865 2064 6566  This was the def
-00035c70: 6175 6c74 2062 6568 6176 696f 7572 2069  ault behaviour i
-00035c80: 6e0a 2020 2020 2020 2020 7665 7273 696f  n.        versio
-00035c90: 6e73 2070 7269 6f72 2074 6f20 302e 322e  ns prior to 0.2.
-00035ca0: 302e 2050 7269 6f72 2074 6f20 302e 332e  0. Prior to 0.3.
-00035cb0: 3020 7468 6520 6069 6d70 7574 655f 6d69  0 the `impute_mi
-00035cc0: 7373 696e 675f 6461 7461 600a 2020 2020  ssing_data`.    
-00035cd0: 2020 2020 6172 6775 6d65 6e74 2063 6f6e      argument con
-00035ce0: 7472 6f6c 6c65 6420 7468 6973 2062 6568  trolled this beh
-00035cf0: 6176 696f 7572 2e0a 0a20 2020 2020 2020  aviour...       
-00035d00: 202e 2e20 7761 726e 696e 673a 3a0a 2020   .. warning::.  
-00035d10: 2020 2020 2020 2020 2020 5468 6973 206d            This m
-00035d20: 6574 686f 6420 6361 6e20 636f 6e73 756d  ethod can consum
-00035d30: 6520 6120 2a2a 7665 7279 206c 6172 6765  e a **very large
-00035d40: 2a2a 2061 6d6f 756e 7420 6f66 206d 656d  ** amount of mem
-00035d50: 6f72 7921 2049 660a 2020 2020 2020 2020  ory! If.        
-00035d60: 2020 2020 616c 6c20 6765 6e6f 7479 7065      all genotype
-00035d70: 7320 6172 6520 6e6f 7420 6e65 6564 6564  s are not needed
-00035d80: 2061 7420 6f6e 6365 2c20 6974 2069 7320   at once, it is 
-00035d90: 7573 7561 6c6c 7920 6265 7474 6572 2074  usually better t
-00035da0: 6f0a 2020 2020 2020 2020 2020 2020 6163  o.            ac
-00035db0: 6365 7373 2074 6865 6d20 7365 7175 656e  cess them sequen
-00035dc0: 7469 616c 6c79 2075 7369 6e67 2074 6865  tially using the
-00035dd0: 203a 6d65 7468 3a60 2e76 6172 6961 6e74   :meth:`.variant
-00035de0: 7360 2069 7465 7261 746f 722e 0a0a 2020  s` iterator...  
-00035df0: 2020 2020 2020 3a70 6172 616d 2061 7272        :param arr
-00035e00: 6179 5f6c 696b 6520 7361 6d70 6c65 733a  ay_like samples:
-00035e10: 2041 6e20 6172 7261 7920 6f66 206e 6f64   An array of nod
-00035e20: 6520 4944 7320 666f 7220 7768 6963 6820  e IDs for which 
-00035e30: 746f 2067 656e 6572 6174 650a 2020 2020  to generate.    
-00035e40: 2020 2020 2020 2020 6765 6e6f 7479 7065          genotype
-00035e50: 732c 206f 7220 4e6f 6e65 2066 6f72 2061  s, or None for a
-00035e60: 6c6c 2073 616d 706c 6520 6e6f 6465 732e  ll sample nodes.
-00035e70: 2044 6566 6175 6c74 3a20 4e6f 6e65 2e0a   Default: None..
-00035e80: 2020 2020 2020 2020 3a70 6172 616d 2062          :param b
-00035e90: 6f6f 6c20 6973 6f6c 6174 6564 5f61 735f  ool isolated_as_
-00035ea0: 6d69 7373 696e 673a 2049 6620 5472 7565  missing: If True
-00035eb0: 2c20 7468 6520 6765 6e6f 7479 7065 2076  , the genotype v
-00035ec0: 616c 7565 2061 7373 6967 6e65 6420 746f  alue assigned to
-00035ed0: 0a20 2020 2020 2020 2020 2020 206d 6973  .            mis
-00035ee0: 7369 6e67 2073 616d 706c 6573 2028 692e  sing samples (i.
-00035ef0: 652e 2c20 6973 6f6c 6174 6564 2073 616d  e., isolated sam
-00035f00: 706c 6573 2077 6974 686f 7574 206d 7574  ples without mut
-00035f10: 6174 696f 6e73 2920 6973 0a20 2020 2020  ations) is.     
-00035f20: 2020 2020 2020 203a 6461 7461 3a60 2e4d         :data:`.M
-00035f30: 4953 5349 4e47 5f44 4154 4160 2028 2d31  ISSING_DATA` (-1
-00035f40: 292e 2049 6620 4661 6c73 652c 206d 6973  ). If False, mis
-00035f50: 7369 6e67 2073 616d 706c 6573 2077 696c  sing samples wil
-00035f60: 6c20 6265 0a20 2020 2020 2020 2020 2020  l be.           
-00035f70: 2061 7373 6967 6e65 6420 7468 6520 616c   assigned the al
-00035f80: 6c65 6c65 2069 6e64 6578 2066 6f72 2074  lele index for t
-00035f90: 6865 2061 6e63 6573 7472 616c 2073 7461  he ancestral sta
-00035fa0: 7465 2e0a 2020 2020 2020 2020 2020 2020  te..            
-00035fb0: 4465 6661 756c 743a 2054 7275 652e 0a20  Default: True.. 
-00035fc0: 2020 2020 2020 203a 7061 7261 6d20 7475         :param tu
-00035fd0: 706c 6520 616c 6c65 6c65 733a 2041 2074  ple alleles: A t
-00035fe0: 7570 6c65 206f 6620 7374 7269 6e67 7320  uple of strings 
-00035ff0: 6465 7363 7269 6269 6e67 2074 6865 2065  describing the e
-00036000: 6e63 6f64 696e 6720 6f66 0a20 2020 2020  ncoding of.     
-00036010: 2020 2020 2020 2061 6c6c 656c 6573 2074         alleles t
-00036020: 6f20 6765 6e6f 7479 7065 2076 616c 7565  o genotype value
-00036030: 732e 2041 7420 6c65 6173 7420 6f6e 6520  s. At least one 
-00036040: 616c 6c65 6c65 206d 7573 7420 6265 2070  allele must be p
-00036050: 726f 7669 6465 642e 0a20 2020 2020 2020  rovided..       
-00036060: 2020 2020 2049 6620 6475 706c 6963 6174       If duplicat
-00036070: 6520 616c 6c65 6c65 7320 6172 6520 7072  e alleles are pr
-00036080: 6f76 6964 6564 2c20 6f75 7470 7574 2067  ovided, output g
-00036090: 656e 6f74 7970 6573 2077 696c 6c20 616c  enotypes will al
-000360a0: 7761 7973 2062 650a 2020 2020 2020 2020  ways be.        
-000360b0: 2020 2020 656e 636f 6465 6420 6173 2074      encoded as t
-000360c0: 6865 2066 6972 7374 206f 6363 7572 7265  he first occurre
-000360d0: 6e63 6520 6f66 2074 6865 2061 6c6c 656c  nce of the allel
-000360e0: 652e 2049 6620 4e6f 6e65 2028 7468 6520  e. If None (the 
-000360f0: 6465 6661 756c 7429 2c0a 2020 2020 2020  default),.      
-00036100: 2020 2020 2020 7468 6520 616c 6c65 6c65        the allele
-00036110: 7320 6172 6520 656e 636f 6465 6420 6173  s are encoded as
-00036120: 2074 6865 7920 6172 6520 656e 636f 756e   they are encoun
-00036130: 7465 7265 6420 6475 7269 6e67 2067 656e  tered during gen
-00036140: 6f74 7970 650a 2020 2020 2020 2020 2020  otype.          
-00036150: 2020 6765 6e65 7261 7469 6f6e 2e0a 2020    generation..  
-00036160: 2020 2020 2020 3a70 6172 616d 2062 6f6f        :param boo
-00036170: 6c20 696d 7075 7465 5f6d 6973 7369 6e67  l impute_missing
-00036180: 5f64 6174 613a 0a20 2020 2020 2020 2020  _data:.         
-00036190: 2020 202a 4465 7072 6563 6174 6564 2069     *Deprecated i
-000361a0: 6e20 302e 332e 302e 2055 7365 2060 6069  n 0.3.0. Use ``i
-000361b0: 736f 6c61 7465 645f 6173 5f6d 6973 7369  solated_as_missi
-000361c0: 6e67 6060 2c20 6275 7420 696e 7665 7274  ng``, but invert
-000361d0: 696e 6720 7661 6c75 652e 0a20 2020 2020  ing value..     
-000361e0: 2020 2020 2020 2057 696c 6c20 6265 2072         Will be r
-000361f0: 656d 6f76 6564 2069 6e20 6120 6675 7475  emoved in a futu
-00036200: 7265 2076 6572 7369 6f6e 2a0a 0a20 2020  re version*..   
-00036210: 2020 2020 203a 7265 7475 726e 3a20 5468       :return: Th
-00036220: 6520 6675 6c6c 206d 6174 7269 7820 6f66  e full matrix of
-00036230: 2067 656e 6f74 7970 6573 2e0a 2020 2020   genotypes..    
-00036240: 2020 2020 3a72 7479 7065 3a20 6e75 6d70      :rtype: nump
-00036250: 792e 6e64 6172 7261 7920 2864 7479 7065  y.ndarray (dtype
-00036260: 3d6e 702e 696e 7433 3229 0a20 2020 2020  =np.int32).     
-00036270: 2020 2022 2222 0a20 2020 2020 2020 2069     """.        i
-00036280: 6620 696d 7075 7465 5f6d 6973 7369 6e67  f impute_missing
-00036290: 5f64 6174 6120 6973 206e 6f74 204e 6f6e  _data is not Non
-000362a0: 653a 0a20 2020 2020 2020 2020 2020 2077  e:.            w
-000362b0: 6172 6e69 6e67 732e 7761 726e 280a 2020  arnings.warn(.  
-000362c0: 2020 2020 2020 2020 2020 2020 2020 2254                "T
-000362d0: 6865 2069 6d70 7574 655f 6d69 7373 696e  he impute_missin
-000362e0: 675f 6461 7461 2070 6172 616d 6574 6572  g_data parameter
-000362f0: 2077 6173 2064 6570 7265 6361 7465 6420   was deprecated 
-00036300: 696e 2030 2e33 2e30 2061 6e64 2077 696c  in 0.3.0 and wil
-00036310: 6c22 0a20 2020 2020 2020 2020 2020 2020  l".             
-00036320: 2020 2022 2062 6520 7265 6d6f 7665 642e     " be removed.
-00036330: 2055 7365 2060 6069 736f 6c61 7465 645f   Use ``isolated_
-00036340: 6173 5f6d 6973 7369 6e67 3d46 616c 7365  as_missing=False
-00036350: 6060 2069 6e73 7465 6164 206f 6622 0a20  `` instead of". 
-00036360: 2020 2020 2020 2020 2020 2020 2020 2022                 "
-00036370: 6060 696d 7075 7465 5f6d 6973 7369 6e67  ``impute_missing
-00036380: 5f64 6174 613d 5472 7565 6060 2e22 2c0a  _data=True``.",.
-00036390: 2020 2020 2020 2020 2020 2020 2020 2020                  
-000363a0: 4675 7475 7265 5761 726e 696e 672c 0a20  FutureWarning,. 
-000363b0: 2020 2020 2020 2020 2020 2029 0a20 2020             ).   
-000363c0: 2020 2020 2023 204f 6e6c 7920 7573 6520       # Only use 
-000363d0: 696d 7075 7465 5f6d 6973 7369 6e67 5f64  impute_missing_d
-000363e0: 6174 6120 6966 2069 736f 6c61 7465 645f  ata if isolated_
-000363f0: 6173 5f6d 6973 7369 6e67 2068 6173 2074  as_missing has t
-00036400: 6865 2064 6566 6175 6c74 2076 616c 7565  he default value
-00036410: 0a20 2020 2020 2020 2069 6620 6973 6f6c  .        if isol
-00036420: 6174 6564 5f61 735f 6d69 7373 696e 6720  ated_as_missing 
-00036430: 6973 204e 6f6e 653a 0a20 2020 2020 2020  is None:.       
-00036440: 2020 2020 2069 736f 6c61 7465 645f 6173       isolated_as
-00036450: 5f6d 6973 7369 6e67 203d 206e 6f74 2069  _missing = not i
-00036460: 6d70 7574 655f 6d69 7373 696e 675f 6461  mpute_missing_da
-00036470: 7461 0a0a 2020 2020 2020 2020 7661 7269  ta..        vari
-00036480: 616e 7420 3d20 7473 6b69 742e 5661 7269  ant = tskit.Vari
-00036490: 616e 7428 0a20 2020 2020 2020 2020 2020  ant(.           
-000364a0: 2073 656c 662c 0a20 2020 2020 2020 2020   self,.         
-000364b0: 2020 2073 616d 706c 6573 3d73 616d 706c     samples=sampl
-000364c0: 6573 2c0a 2020 2020 2020 2020 2020 2020  es,.            
-000364d0: 6973 6f6c 6174 6564 5f61 735f 6d69 7373  isolated_as_miss
-000364e0: 696e 673d 6973 6f6c 6174 6564 5f61 735f  ing=isolated_as_
-000364f0: 6d69 7373 696e 672c 0a20 2020 2020 2020  missing,.       
-00036500: 2020 2020 2061 6c6c 656c 6573 3d61 6c6c       alleles=all
-00036510: 656c 6573 2c0a 2020 2020 2020 2020 290a  eles,.        ).
-00036520: 0a20 2020 2020 2020 206e 756d 5f73 616d  .        num_sam
-00036530: 706c 6573 203d 2073 656c 662e 6e75 6d5f  ples = self.num_
-00036540: 7361 6d70 6c65 7320 6966 2073 616d 706c  samples if sampl
-00036550: 6573 2069 7320 4e6f 6e65 2065 6c73 6520  es is None else 
-00036560: 6c65 6e28 7361 6d70 6c65 7329 0a20 2020  len(samples).   
-00036570: 2020 2020 2072 6574 203d 206e 702e 7a65       ret = np.ze
-00036580: 726f 7328 7368 6170 653d 2873 656c 662e  ros(shape=(self.
-00036590: 6e75 6d5f 7369 7465 732c 206e 756d 5f73  num_sites, num_s
-000365a0: 616d 706c 6573 292c 2064 7479 7065 3d6e  amples), dtype=n
-000365b0: 702e 696e 7433 3229 0a0a 2020 2020 2020  p.int32)..      
-000365c0: 2020 666f 7220 7369 7465 5f69 6420 696e    for site_id in
-000365d0: 2072 616e 6765 2873 656c 662e 6e75 6d5f   range(self.num_
-000365e0: 7369 7465 7329 3a0a 2020 2020 2020 2020  sites):.        
-000365f0: 2020 2020 7661 7269 616e 742e 6465 636f      variant.deco
-00036600: 6465 2873 6974 655f 6964 290a 2020 2020  de(site_id).    
-00036610: 2020 2020 2020 2020 7265 745b 7369 7465          ret[site
-00036620: 5f69 642c 203a 5d20 3d20 7661 7269 616e  _id, :] = varian
-00036630: 742e 6765 6e6f 7479 7065 730a 0a20 2020  t.genotypes..   
-00036640: 2020 2020 2072 6574 7572 6e20 7265 740a       return ret.
-00036650: 0a20 2020 2064 6566 2061 6c69 676e 6d65  .    def alignme
-00036660: 6e74 7328 0a20 2020 2020 2020 2073 656c  nts(.        sel
-00036670: 662c 0a20 2020 2020 2020 202a 2c0a 2020  f,.        *,.  
-00036680: 2020 2020 2020 7265 6665 7265 6e63 655f        reference_
-00036690: 7365 7175 656e 6365 3d4e 6f6e 652c 0a20  sequence=None,. 
-000366a0: 2020 2020 2020 206d 6973 7369 6e67 5f64         missing_d
-000366b0: 6174 615f 6368 6172 6163 7465 723d 4e6f  ata_character=No
-000366c0: 6e65 2c0a 2020 2020 2020 2020 7361 6d70  ne,.        samp
-000366d0: 6c65 733d 4e6f 6e65 2c0a 2020 2020 2020  les=None,.      
-000366e0: 2020 6c65 6674 3d4e 6f6e 652c 0a20 2020    left=None,.   
-000366f0: 2020 2020 2072 6967 6874 3d4e 6f6e 652c       right=None,
-00036700: 0a20 2020 2029 3a0a 2020 2020 2020 2020  .    ):.        
-00036710: 2222 220a 2020 2020 2020 2020 5265 7475  """.        Retu
-00036720: 726e 7320 616e 2069 7465 7261 746f 7220  rns an iterator 
-00036730: 6f76 6572 2074 6865 2066 756c 6c20 7365  over the full se
-00036740: 7175 656e 6365 2061 6c69 676e 6d65 6e74  quence alignment
-00036750: 7320 666f 7220 7468 6520 6465 6669 6e65  s for the define
-00036760: 6420 7361 6d70 6c65 730a 2020 2020 2020  d samples.      
-00036770: 2020 696e 2074 6869 7320 7472 6565 2073    in this tree s
-00036780: 6571 7565 6e63 652e 2045 6163 6820 616c  equence. Each al
-00036790: 6967 6e6d 656e 7420 6060 6160 6020 6973  ignment ``a`` is
-000367a0: 2061 2073 7472 696e 6720 6f66 206c 656e   a string of len
-000367b0: 6774 6820 6060 4c60 6020 7768 6572 650a  gth ``L`` where.
-000367c0: 2020 2020 2020 2020 7468 6520 6669 7273          the firs
-000367d0: 7420 6368 6172 6163 7465 7220 6973 2074  t character is t
-000367e0: 6865 2067 656e 6f6d 6963 2073 6571 7565  he genomic seque
-000367f0: 6e63 6520 6174 2074 6865 2060 6073 7461  nce at the ``sta
-00036800: 7274 6060 2070 6f73 6974 696f 6e20 696e  rt`` position in
-00036810: 2074 6865 0a20 2020 2020 2020 2067 656e   the.        gen
-00036820: 6f6d 6520 2864 6566 6175 6c74 696e 6720  ome (defaulting 
-00036830: 746f 2030 2920 616e 6420 7468 6520 6c61  to 0) and the la
-00036840: 7374 2063 6861 7261 6374 6572 2069 7320  st character is 
-00036850: 7468 6520 6765 6e6f 6d69 6320 7365 7175  the genomic sequ
-00036860: 656e 6365 206f 6e65 0a20 2020 2020 2020  ence one.       
-00036870: 2070 6f73 6974 696f 6e20 6265 666f 7265   position before
-00036880: 2074 6865 2060 6073 746f 7060 6020 7661   the ``stop`` va
-00036890: 6c75 6520 2864 6566 6175 6c74 696e 6720  lue (defaulting 
-000368a0: 746f 2074 6865 203a 6174 7472 3a60 2e73  to the :attr:`.s
-000368b0: 6571 7565 6e63 655f 6c65 6e67 7468 600a  equence_length`.
-000368c0: 2020 2020 2020 2020 6f66 2074 6869 7320          of this 
-000368d0: 7472 6565 2073 6571 7565 6e63 652c 2077  tree sequence, w
-000368e0: 6869 6368 206d 7573 7420 6861 7665 203a  hich must have :
-000368f0: 6174 7472 3a60 2e64 6973 6372 6574 655f  attr:`.discrete_
-00036900: 6765 6e6f 6d65 6020 6571 7561 6c20 746f  genome` equal to
-00036910: 2054 7275 6529 2e0a 2020 2020 2020 2020   True)..        
-00036920: 4279 2064 6566 6175 6c74 2060 604c 6060  By default ``L``
-00036930: 2069 7320 7468 6572 6566 6f72 6520 6571   is therefore eq
-00036940: 7561 6c20 746f 2074 6865 203a 6174 7472  ual to the :attr
-00036950: 3a60 2e73 6571 7565 6e63 655f 6c65 6e67  :`.sequence_leng
-00036960: 7468 602c 0a20 2020 2020 2020 2061 6e64  th`,.        and
-00036970: 2060 6061 5b6a 5d60 6020 6973 2074 6865   ``a[j]`` is the
-00036980: 206e 7563 6c65 6f74 6964 6520 7661 6c75   nucleotide valu
-00036990: 6520 6174 2067 656e 6f6d 6963 2070 6f73  e at genomic pos
-000369a0: 6974 696f 6e20 6060 6a60 602e 0a0a 2020  ition ``j``...  
-000369b0: 2020 2020 2020 2e2e 206e 6f74 653a 3a20        .. note:: 
-000369c0: 5468 6973 2069 7320 696e 6865 7265 6e74  This is inherent
-000369d0: 6c79 2061 202a 2a7a 6572 6f2d 6261 7365  ly a **zero-base
-000369e0: 642a 2a20 7265 7072 6573 656e 7461 7469  d** representati
-000369f0: 6f6e 206f 6620 7468 6520 7365 7175 656e  on of the sequen
-00036a00: 6365 0a20 2020 2020 2020 2020 2020 2063  ce.            c
-00036a10: 6f6f 7264 696e 6174 6520 7370 6163 652e  oordinate space.
-00036a20: 2043 6172 6520 7769 6c6c 2062 6520 6e65   Care will be ne
-00036a30: 6564 6564 2077 6865 6e20 696e 7465 7261  eded when intera
-00036a40: 6374 696e 6720 7769 7468 206f 7468 6572  cting with other
-00036a50: 0a20 2020 2020 2020 2020 2020 206c 6962  .            lib
-00036a60: 7261 7269 6573 2061 6e64 2075 7073 7472  raries and upstr
-00036a70: 6561 6d20 636f 6f72 6469 6e61 7465 2073  eam coordinate s
-00036a80: 7061 6365 732e 0a0a 0a20 2020 2020 2020  paces....       
-00036a90: 2054 6865 203a 7265 663a 6073 6974 6573   The :ref:`sites
-00036aa0: 3c73 6563 5f64 6174 615f 6d6f 6465 6c5f  <sec_data_model_
-00036ab0: 6465 6669 6e69 7469 6f6e 735f 7369 7465  definitions_site
-00036ac0: 3e60 2069 6e20 6120 7472 6565 2073 6571  >` in a tree seq
-00036ad0: 7565 6e63 6520 7769 6c6c 0a20 2020 2020  uence will.     
-00036ae0: 2020 2075 7375 616c 6c79 206f 6e6c 7920     usually only 
-00036af0: 6465 6669 6e65 2074 6865 2076 6172 6961  define the varia
-00036b00: 7469 6f6e 2066 6f72 2061 2073 7562 7365  tion for a subse
-00036b10: 7420 6f66 2074 6865 2060 604c 6060 206e  t of the ``L`` n
-00036b20: 7563 6c65 6f74 6964 650a 2020 2020 2020  ucleotide.      
-00036b30: 2020 706f 7369 7469 6f6e 7320 616c 6f6e    positions alon
-00036b40: 6720 7468 6520 6765 6e6f 6d65 2c20 616e  g the genome, an
-00036b50: 6420 7468 6520 7265 6d61 696e 696e 6720  d the remaining 
-00036b60: 706f 7369 7469 6f6e 7320 6172 6520 6669  positions are fi
-00036b70: 6c6c 6564 2075 7369 6e67 0a20 2020 2020  lled using.     
-00036b80: 2020 2061 203a 7265 663a 6072 6566 6572     a :ref:`refer
-00036b90: 656e 6365 2073 6571 7565 6e63 6520 3c73  ence sequence <s
-00036ba0: 6563 5f64 6174 615f 6d6f 6465 6c5f 7265  ec_data_model_re
-00036bb0: 6665 7265 6e63 655f 7365 7175 656e 6365  ference_sequence
-00036bc0: 3e60 2e0a 2020 2020 2020 2020 5468 6520  >`..        The 
-00036bd0: 7265 6665 7265 6e63 6520 7365 7175 656e  reference sequen
-00036be0: 6365 2064 6174 6120 6973 2064 6566 696e  ce data is defin
-00036bf0: 6564 2065 6974 6865 7220 7669 6120 7468  ed either via th
-00036c00: 650a 2020 2020 2020 2020 6060 7265 6665  e.        ``refe
-00036c10: 7265 6e63 655f 7365 7175 656e 6365 6060  rence_sequence``
-00036c20: 2070 6172 616d 6574 6572 2074 6f20 7468   parameter to th
-00036c30: 6973 206d 6574 686f 642c 206f 7220 656d  is method, or em
-00036c40: 6265 6464 6564 2077 6974 6869 6e0a 2020  bedded within.  
-00036c50: 2020 2020 2020 7769 7468 2074 6865 2074        with the t
-00036c60: 7265 6520 7365 7175 656e 6365 2069 7473  ree sequence its
-00036c70: 656c 6620 7669 6120 7468 6520 3a61 7474  elf via the :att
-00036c80: 723a 602e 5472 6565 5365 7175 656e 6365  r:`.TreeSequence
-00036c90: 2e72 6566 6572 656e 6365 5f73 6571 7565  .reference_seque
-00036ca0: 6e63 6560 2e0a 0a20 2020 2020 2020 2053  nce`...        S
-00036cb0: 6974 6520 696e 666f 726d 6174 696f 6e20  ite information 
-00036cc0: 6672 6f6d 2074 6865 2074 7265 6520 7365  from the tree se
-00036cd0: 7175 656e 6365 2074 616b 6573 2070 7265  quence takes pre
-00036ce0: 6365 6465 6e63 6520 6f76 6572 2074 6865  cedence over the
-00036cf0: 2072 6566 6572 656e 6365 0a20 2020 2020   reference.     
-00036d00: 2020 2073 6571 7565 6e63 6520 736f 2074     sequence so t
-00036d10: 6861 742c 2066 6f72 2065 7861 6d70 6c65  hat, for example
-00036d20: 2c20 6174 2061 2073 6974 6520 7769 7468  , at a site with
-00036d30: 206e 6f20 6d75 7461 7469 6f6e 7320 616c   no mutations al
-00036d40: 6c20 7361 6d70 6c65 730a 2020 2020 2020  l samples.      
-00036d50: 2020 7769 6c6c 2068 6176 6520 7468 6520    will have the 
-00036d60: 7369 7465 2773 2061 6e63 6573 7472 616c  site's ancestral
-00036d70: 2073 7461 7465 2e0a 0a20 2020 2020 2020   state...       
-00036d80: 2054 6865 2072 6566 6572 656e 6365 2073   The reference s
-00036d90: 6571 7565 6e63 6520 6261 7365 7320 6172  equence bases ar
-00036da0: 6520 6465 7465 726d 696e 6564 2069 6e20  e determined in 
-00036db0: 7468 6520 666f 6c6c 6f77 696e 6720 7761  the following wa
-00036dc0: 793a 0a0a 2020 2020 2020 2020 2d20 4966  y:..        - If
-00036dd0: 2074 6865 2060 6072 6566 6572 656e 6365   the ``reference
-00036de0: 5f73 6571 7565 6e63 6560 6020 7061 7261  _sequence`` para
-00036df0: 6d65 7465 7220 6973 2073 7570 706c 6965  meter is supplie
-00036e00: 6420 7468 6973 2077 696c 6c20 6265 0a20  d this will be. 
-00036e10: 2020 2020 2020 2020 2075 7365 642c 2072           used, r
-00036e20: 6567 6172 646c 6573 7320 6f66 2077 6865  egardless of whe
-00036e30: 7468 6572 2074 6865 2074 7265 6520 7365  ther the tree se
-00036e40: 7175 656e 6365 2068 6173 2061 6e20 656d  quence has an em
-00036e50: 6265 6464 6564 0a20 2020 2020 2020 2020  bedded.         
-00036e60: 2072 6566 6572 656e 6365 2073 6571 7565   reference seque
-00036e70: 6e63 652e 0a20 2020 2020 2020 202d 204f  nce..        - O
-00036e80: 7468 6572 7769 7365 2c20 6966 2074 6865  therwise, if the
-00036e90: 2074 7265 6520 7365 7175 656e 6365 2068   tree sequence h
-00036ea0: 6173 2061 6e20 656d 6265 6464 6564 2072  as an embedded r
-00036eb0: 6566 6572 656e 6365 2073 6571 7565 6e63  eference sequenc
-00036ec0: 652c 0a20 2020 2020 2020 2020 2074 6869  e,.          thi
-00036ed0: 7320 7769 6c6c 2062 6520 7573 6564 2e0a  s will be used..
-00036ee0: 2020 2020 2020 2020 2d20 4966 2074 6865          - If the
-00036ef0: 2060 6072 6566 6572 656e 6365 5f73 6571   ``reference_seq
-00036f00: 7565 6e63 6560 6020 7061 7261 6d65 7465  uence`` paramete
-00036f10: 7220 6973 206e 6f74 2073 7065 6369 6669  r is not specifi
-00036f20: 6564 2061 6e64 0a20 2020 2020 2020 2020  ed and.         
-00036f30: 2074 6865 7265 2069 7320 6e6f 2065 6d62   there is no emb
-00036f40: 6564 6465 6420 7265 6665 7265 6e63 6520  edded reference 
-00036f50: 7365 7175 656e 6365 2c20 6060 4c60 6020  sequence, ``L`` 
-00036f60: 636f 7069 6573 206f 6620 7468 650a 2020  copies of the.  
-00036f70: 2020 2020 2020 2020 6060 6d69 7373 696e          ``missin
-00036f80: 675f 6461 7461 5f63 6861 7261 6374 6572  g_data_character
-00036f90: 6060 2028 7768 6963 6820 6465 6661 756c  `` (which defaul
-00036fa0: 7473 2074 6f20 274e 2729 2061 7265 2075  ts to 'N') are u
-00036fb0: 7365 640a 2020 2020 2020 2020 2020 696e  sed.          in
-00036fc0: 7374 6561 642e 0a0a 2020 2020 2020 2020  stead...        
-00036fd0: 2e2e 2077 6172 6e69 6e67 3a3a 2054 6865  .. warning:: The
-00036fe0: 203a 636c 6173 733a 602e 5265 6665 7265   :class:`.Refere
-00036ff0: 6e63 6553 6571 7565 6e63 6560 2041 5049  nceSequence` API
-00037000: 2069 7320 7072 656c 696d 696e 6172 7920   is preliminary 
-00037010: 616e 640a 2020 2020 2020 2020 2020 2073  and.           s
-00037020: 6f6d 6520 6265 6861 7669 6f75 7273 206d  ome behaviours m
-00037030: 6179 2063 6861 6e67 6520 696e 2074 6865  ay change in the
-00037040: 2066 7574 7572 652e 2049 6e20 7061 7274   future. In part
-00037050: 6963 756c 6172 2c20 610a 2020 2020 2020  icular, a.      
-00037060: 2020 2020 2074 7265 6520 7365 7175 656e       tree sequen
-00037070: 6365 2069 7320 6375 7272 656e 746c 7920  ce is currently 
-00037080: 7265 6761 7264 6564 2061 7320 6861 7669  regarded as havi
-00037090: 6e67 2061 6e20 656d 6265 6464 6564 2072  ng an embedded r
-000370a0: 6566 6572 656e 6365 0a20 2020 2020 2020  eference.       
-000370b0: 2020 2020 7365 7175 656e 6365 2065 7665      sequence eve
-000370c0: 6e20 6966 2069 7420 6f6e 6c79 2068 6173  n if it only has
-000370d0: 2073 6f6d 6520 6d65 7461 6461 7461 2064   some metadata d
-000370e0: 6566 696e 6564 2e20 496e 2074 6869 7320  efined. In this 
-000370f0: 6361 7365 0a20 2020 2020 2020 2020 2020  case.           
-00037100: 7468 6520 6060 7265 6665 7265 6e63 655f  the ``reference_
-00037110: 7365 7175 656e 6365 6060 2070 6172 616d  sequence`` param
-00037120: 6574 6572 2077 696c 6c20 6e65 6564 2074  eter will need t
-00037130: 6f20 6265 2065 7870 6c69 6369 746c 7920  o be explicitly 
-00037140: 7365 742e 0a0a 2020 2020 2020 2020 2e2e  set...        ..
-00037150: 206e 6f74 653a 3a0a 2020 2020 2020 2020   note::.        
-00037160: 2020 2020 5477 6f20 636f 6d6d 6f6e 206f      Two common o
-00037170: 7074 696f 6e73 2066 6f72 2073 6574 7469  ptions for setti
-00037180: 6e67 2061 2072 6566 6572 656e 6365 2073  ng a reference s
-00037190: 6571 7565 6e63 6520 6172 653a 0a0a 2020  equence are:..  
-000371a0: 2020 2020 2020 2020 2020 2d20 4d61 726b            - Mark
-000371b0: 2074 6865 6d20 6173 206d 6973 7369 6e67   them as missing
-000371c0: 2064 6174 612c 2062 7920 7365 7474 696e   data, by settin
-000371d0: 670a 2020 2020 2020 2020 2020 2020 2020  g.              
-000371e0: 6060 7265 6665 7265 6e63 655f 7365 7175  ``reference_sequ
-000371f0: 656e 6365 3d22 4e22 202a 2069 6e74 2874  ence="N" * int(t
-00037200: 732e 7365 7175 656e 6365 5f6c 656e 6774  s.sequence_lengt
-00037210: 6829 6060 0a20 2020 2020 2020 2020 2020  h)``.           
-00037220: 202d 2046 696c 6c20 7468 6520 6761 7073   - Fill the gaps
-00037230: 2077 6974 6820 7261 6e64 6f6d 206e 7563   with random nuc
-00037240: 6c65 6f74 6964 6573 2c20 6279 2073 6574  leotides, by set
-00037250: 7469 6e67 0a20 2020 2020 2020 2020 2020  ting.           
-00037260: 2020 2060 6072 6566 6572 656e 6365 5f73     ``reference_s
-00037270: 6571 7565 6e63 653d 7473 6b69 742e 7261  equence=tskit.ra
-00037280: 6e64 6f6d 5f6e 7563 6c65 6f74 6964 6573  ndom_nucleotides
-00037290: 2874 732e 7365 7175 656e 6365 5f6c 656e  (ts.sequence_len
-000372a0: 6774 6829 6060 2e0a 2020 2020 2020 2020  gth)``..        
-000372b0: 2020 2020 2020 5365 6520 7468 6520 3a66        See the :f
-000372c0: 756e 633a 602e 7261 6e64 6f6d 5f6e 7563  unc:`.random_nuc
-000372d0: 6c65 6f74 6964 6573 6020 6675 6e63 7469  leotides` functi
-000372e0: 6f6e 2066 6f72 206d 6f72 6520 696e 666f  on for more info
-000372f0: 726d 6174 696f 6e2e 0a0a 2020 2020 2020  rmation...      
-00037300: 2020 2e2e 2077 6172 6e69 6e67 3a3a 2049    .. warning:: I
-00037310: 6e73 6572 7469 6f6e 7320 616e 6420 6465  nsertions and de
-00037320: 6c65 7469 6f6e 7320 6172 6520 6e6f 7420  letions are not 
-00037330: 6375 7272 656e 746c 7920 7375 7070 6f72  currently suppor
-00037340: 7465 6420 616e 640a 2020 2020 2020 2020  ted and.        
-00037350: 2020 2074 6865 2061 6c6c 656c 6573 2061     the alleles a
-00037360: 7420 6561 6368 2073 6974 6520 6d75 7374  t each site must
-00037370: 2062 6520 7265 7072 6573 656e 7465 6420   be represented 
-00037380: 6279 0a20 2020 2020 2020 2020 2020 7369  by.           si
-00037390: 6e67 6c65 2062 7974 6520 6368 6172 6163  ngle byte charac
-000373a0: 7465 7273 2c20 2869 2e65 2e2c 2076 6172  ters, (i.e., var
-000373b0: 6961 6e74 7320 6d75 7374 2062 6520 7369  iants must be si
-000373c0: 6e67 6c65 206e 7563 6c65 6f74 6964 650a  ngle nucleotide.
-000373d0: 2020 2020 2020 2020 2020 2070 6f6c 796d             polym
-000373e0: 6f72 7068 6973 6d73 2c20 6f72 2053 4e50  orphisms, or SNP
-000373f0: 7329 2e0a 0a20 2020 2020 2020 202e 2e20  s)...        .. 
-00037400: 7761 726e 696e 673a 3a20 3a72 6566 3a60  warning:: :ref:`
-00037410: 4d69 7373 696e 6720 6461 7461 3c73 6563  Missing data<sec
-00037420: 5f64 6174 615f 6d6f 6465 6c5f 6d69 7373  _data_model_miss
-00037430: 696e 675f 6461 7461 3e60 2069 7320 6e6f  ing_data>` is no
-00037440: 740a 2020 2020 2020 2020 2020 2063 7572  t.           cur
-00037450: 7265 6e74 6c79 2073 7570 706f 7274 6564  rently supported
-00037460: 2062 7920 7468 6973 206d 6574 686f 6420   by this method 
-00037470: 616e 6420 6974 2077 696c 6c20 7261 6973  and it will rais
-00037480: 6520 6120 5661 6c75 6545 7272 6f72 0a20  e a ValueError. 
-00037490: 2020 2020 2020 2020 2020 6966 2063 616c            if cal
-000374a0: 6c65 6420 6f6e 2074 7265 6520 7365 7175  led on tree sequ
-000374b0: 656e 6365 7320 636f 6e74 6169 6e69 6e67  ences containing
-000374c0: 2069 736f 6c61 7465 6420 7361 6d70 6c65   isolated sample
-000374d0: 732e 0a20 2020 2020 2020 2020 2020 5365  s..           Se
-000374e0: 6520 6874 7470 733a 2f2f 6769 7468 7562  e https://github
-000374f0: 2e63 6f6d 2f74 736b 6974 2d64 6576 2f74  .com/tskit-dev/t
-00037500: 736b 6974 2f69 7373 7565 732f 3138 3936  skit/issues/1896
-00037510: 2066 6f72 206d 6f72 650a 2020 2020 2020   for more.      
-00037520: 2020 2020 2069 6e66 6f72 6d61 7469 6f6e       information
-00037530: 2e0a 0a20 2020 2020 2020 2053 6565 2061  ...        See a
-00037540: 6c73 6f20 7468 6520 3a6d 6574 683a 602e  lso the :meth:`.
-00037550: 7661 7269 616e 7473 6020 6974 6572 6174  variants` iterat
-00037560: 6f72 2066 6f72 2073 6974 652d 6365 6e74  or for site-cent
-00037570: 7269 6320 6163 6365 7373 0a20 2020 2020  ric access.     
-00037580: 2020 2074 6f20 7361 6d70 6c65 2067 656e     to sample gen
-00037590: 6f74 7970 6573 2061 6e64 203a 6d65 7468  otypes and :meth
-000375a0: 3a60 2e68 6170 6c6f 7479 7065 7360 2066  :`.haplotypes` f
-000375b0: 6f72 2061 6363 6573 7320 746f 2073 616d  or access to sam
-000375c0: 706c 6520 7365 7175 656e 6365 730a 2020  ple sequences.  
-000375d0: 2020 2020 2020 6174 206a 7573 7420 7468        at just th
-000375e0: 6520 7369 7465 7320 696e 2074 6865 2074  e sites in the t
-000375f0: 7265 6520 7365 7175 656e 6365 2e0a 0a20  ree sequence... 
-00037600: 2020 2020 2020 203a 7061 7261 6d20 7374         :param st
-00037610: 7220 7265 6665 7265 6e63 655f 7365 7175  r reference_sequ
-00037620: 656e 6365 3a20 5468 6520 7265 6665 7265  ence: The refere
-00037630: 6e63 6520 7365 7175 656e 6365 2074 6f20  nce sequence to 
-00037640: 6669 6c6c 2069 6e0a 2020 2020 2020 2020  fill in.        
-00037650: 2020 2020 6761 7073 2062 6574 7765 656e      gaps between
-00037660: 2073 6974 6573 2069 6e20 7468 6520 616c   sites in the al
-00037670: 6967 6e6d 656e 7473 2e0a 2020 2020 2020  ignments..      
-00037680: 2020 3a70 6172 616d 2073 7472 206d 6973    :param str mis
-00037690: 7369 6e67 5f64 6174 615f 6368 6172 6163  sing_data_charac
-000376a0: 7465 723a 2041 2073 696e 676c 6520 6173  ter: A single as
-000376b0: 6369 6920 6368 6172 6163 7465 7220 7468  cii character th
-000376c0: 6174 2077 696c 6c0a 2020 2020 2020 2020  at will.        
-000376d0: 2020 2020 6265 2075 7365 6420 746f 2072      be used to r
-000376e0: 6570 7265 7365 6e74 206d 6973 7369 6e67  epresent missing
-000376f0: 2064 6174 612e 0a20 2020 2020 2020 2020   data..         
-00037700: 2020 2049 6620 616e 7920 6e6f 726d 616c     If any normal
-00037710: 2061 6c6c 656c 6520 636f 6e74 6169 6e73   allele contains
-00037720: 2074 6869 7320 6368 6172 6163 7465 722c   this character,
-00037730: 2061 6e20 6572 726f 7220 6973 2072 6169   an error is rai
-00037740: 7365 642e 0a20 2020 2020 2020 2020 2020  sed..           
-00037750: 2044 6566 6175 6c74 3a20 274e 272e 0a20   Default: 'N'.. 
-00037760: 2020 2020 2020 203a 7061 7261 6d20 6c69         :param li
-00037770: 7374 5b69 6e74 5d20 7361 6d70 6c65 733a  st[int] samples:
-00037780: 2054 6865 2073 616d 706c 6573 2066 6f72   The samples for
-00037790: 2077 6869 6368 2074 6f20 6f75 7470 7574   which to output
-000377a0: 2061 6c69 676e 6d65 6e74 732e 2049 660a   alignments. If.
-000377b0: 2020 2020 2020 2020 2020 2020 6060 4e6f              ``No
-000377c0: 6e65 6060 2028 6465 6661 756c 7429 2c20  ne`` (default), 
-000377d0: 7265 7475 726e 2061 6c69 676e 6d65 6e74  return alignment
-000377e0: 7320 666f 7220 616c 6c20 7468 6520 7361  s for all the sa
-000377f0: 6d70 6c65 7320 696e 2074 6865 2074 7265  mples in the tre
-00037800: 650a 2020 2020 2020 2020 2020 2020 7365  e.            se
-00037810: 7175 656e 6365 2c20 696e 2074 6865 206f  quence, in the o
-00037820: 7264 6572 2067 6976 656e 2062 7920 7468  rder given by th
-00037830: 6520 3a6d 6574 683a 602e 7361 6d70 6c65  e :meth:`.sample
-00037840: 7360 206d 6574 686f 642e 0a20 2020 2020  s` method..     
-00037850: 2020 203a 7061 7261 6d20 696e 7420 6c65     :param int le
-00037860: 6674 3a20 416c 6967 6e6d 656e 7473 2077  ft: Alignments w
-00037870: 696c 6c20 7374 6172 7420 6174 2074 6869  ill start at thi
-00037880: 7320 6765 6e6f 6d69 6320 706f 7369 7469  s genomic positi
-00037890: 6f6e 2e20 4966 2060 604e 6f6e 6560 600a  on. If ``None``.
-000378a0: 2020 2020 2020 2020 2020 2020 2864 6566              (def
-000378b0: 6175 6c74 2920 616c 6967 6e6d 656e 7473  ault) alignments
-000378c0: 2073 7461 7274 2061 7420 302e 0a20 2020   start at 0..   
-000378d0: 2020 2020 203a 7061 7261 6d20 696e 7420       :param int 
-000378e0: 7269 6768 743a 2041 6c69 676e 6d65 6e74  right: Alignment
-000378f0: 7320 7769 6c6c 2073 746f 7020 6265 666f  s will stop befo
-00037900: 7265 2074 6869 7320 6765 6e6f 6d69 6320  re this genomic 
-00037910: 706f 7369 7469 6f6e 2e20 4966 2060 604e  position. If ``N
-00037920: 6f6e 6560 600a 2020 2020 2020 2020 2020  one``.          
-00037930: 2020 2864 6566 6175 6c74 2920 616c 6967    (default) alig
-00037940: 6e6d 656e 7473 2077 696c 6c20 636f 6e74  nments will cont
-00037950: 696e 7565 2075 6e74 696c 2074 6865 2065  inue until the e
-00037960: 6e64 206f 6620 7468 6520 7472 6565 2073  nd of the tree s
-00037970: 6571 7565 6e63 652e 0a20 2020 2020 2020  equence..       
-00037980: 203a 7265 7475 726e 3a20 416e 2069 7465   :return: An ite
-00037990: 7261 746f 7220 6f76 6572 2074 6865 2061  rator over the a
-000379a0: 6c69 676e 6d65 6e74 2073 7472 696e 6773  lignment strings
-000379b0: 2066 6f72 2073 7065 6369 6669 6564 2073   for specified s
-000379c0: 616d 706c 6573 2069 6e0a 2020 2020 2020  amples in.      
-000379d0: 2020 2020 2020 7468 6973 2074 7265 6520        this tree 
-000379e0: 7365 7175 656e 6365 2c20 696e 2074 6865  sequence, in the
-000379f0: 206f 7264 6572 2067 6976 656e 2069 6e20   order given in 
-00037a00: 6060 7361 6d70 6c65 7360 602e 0a20 2020  ``samples``..   
-00037a10: 2020 2020 203a 7274 7970 653a 2063 6f6c       :rtype: col
-00037a20: 6c65 6374 696f 6e73 2e61 6263 2e49 7465  lections.abc.Ite
-00037a30: 7261 626c 650a 2020 2020 2020 2020 3a72  rable.        :r
-00037a40: 6169 7365 733a 2056 616c 7565 4572 726f  aises: ValueErro
-00037a50: 720a 2020 2020 2020 2020 2020 2020 6966  r.            if
-00037a60: 2061 6e79 2067 656e 6f6d 6520 636f 6f72   any genome coor
-00037a70: 6469 6e61 7465 2069 6e20 7468 6973 2074  dinate in this t
-00037a80: 7265 6520 7365 7175 656e 6365 2069 7320  ree sequence is 
-00037a90: 6e6f 7420 6469 7363 7265 7465 2c0a 2020  not discrete,.  
-00037aa0: 2020 2020 2020 2020 2020 6f72 2069 6620            or if 
-00037ab0: 7468 6520 6060 7265 6665 7265 6e63 655f  the ``reference_
-00037ac0: 7365 7175 656e 6365 6060 2069 7320 6e6f  sequence`` is no
-00037ad0: 7420 6f66 2074 6865 2063 6f72 7265 6374  t of the correct
-00037ae0: 206c 656e 6774 682e 0a20 2020 2020 2020   length..       
-00037af0: 203a 7261 6973 6573 3a20 5479 7065 4572   :raises: TypeEr
-00037b00: 726f 7220 6966 2061 6e79 206f 6620 7468  ror if any of th
-00037b10: 6520 616c 6c65 6c65 7320 6174 2061 2073  e alleles at a s
-00037b20: 6974 6520 6172 6520 6e6f 7420 610a 2020  ite are not a.  
-00037b30: 2020 2020 2020 2020 2020 7369 6e67 6c65            single
-00037b40: 2061 7363 6969 2063 6861 7261 6374 6572   ascii character
-00037b50: 2e0a 2020 2020 2020 2020 2222 220a 2020  ..        """.  
-00037b60: 2020 2020 2020 6966 206e 6f74 2073 656c        if not sel
-00037b70: 662e 6469 7363 7265 7465 5f67 656e 6f6d  f.discrete_genom
-00037b80: 653a 0a20 2020 2020 2020 2020 2020 2072  e:.            r
-00037b90: 6169 7365 2056 616c 7565 4572 726f 7228  aise ValueError(
-00037ba0: 2273 6571 7565 6e63 6520 616c 6967 6e6d  "sequence alignm
-00037bb0: 656e 7473 206f 6e6c 7920 6465 6669 6e65  ents only define
-00037bc0: 6420 666f 7220 6469 7363 7265 7465 2067  d for discrete g
-00037bd0: 656e 6f6d 6573 2229 0a20 2020 2020 2020  enomes").       
-00037be0: 2069 6e74 6572 7661 6c20 3d20 7365 6c66   interval = self
-00037bf0: 2e5f 6368 6563 6b5f 6765 6e6f 6d69 635f  ._check_genomic_
-00037c00: 7261 6e67 6528 6c65 6674 2c20 7269 6768  range(left, righ
-00037c10: 742c 2065 6e73 7572 655f 696e 7465 6765  t, ensure_intege
-00037c20: 723d 5472 7565 290a 2020 2020 2020 2020  r=True).        
-00037c30: 6d69 7373 696e 675f 6461 7461 5f63 6861  missing_data_cha
-00037c40: 7261 6374 6572 203d 2028 0a20 2020 2020  racter = (.     
-00037c50: 2020 2020 2020 2022 4e22 2069 6620 6d69         "N" if mi
-00037c60: 7373 696e 675f 6461 7461 5f63 6861 7261  ssing_data_chara
-00037c70: 6374 6572 2069 7320 4e6f 6e65 2065 6c73  cter is None els
-00037c80: 6520 6d69 7373 696e 675f 6461 7461 5f63  e missing_data_c
-00037c90: 6861 7261 6374 6572 0a20 2020 2020 2020  haracter.       
-00037ca0: 2029 0a0a 2020 2020 2020 2020 4c20 3d20   )..        L = 
-00037cb0: 696e 7465 7276 616c 2e73 7061 6e0a 2020  interval.span.  
-00037cc0: 2020 2020 2020 6120 3d20 6e70 2e65 6d70        a = np.emp
-00037cd0: 7479 284c 2c20 6474 7970 653d 6e70 2e69  ty(L, dtype=np.i
-00037ce0: 6e74 3829 0a20 2020 2020 2020 2069 6620  nt8).        if 
-00037cf0: 7265 6665 7265 6e63 655f 7365 7175 656e  reference_sequen
-00037d00: 6365 2069 7320 4e6f 6e65 3a0a 2020 2020  ce is None:.    
-00037d10: 2020 2020 2020 2020 6966 2073 656c 662e          if self.
-00037d20: 6861 735f 7265 6665 7265 6e63 655f 7365  has_reference_se
-00037d30: 7175 656e 6365 2829 3a0a 2020 2020 2020  quence():.      
-00037d40: 2020 2020 2020 2020 2020 2320 5468 6973            # This
-00037d50: 206d 6179 2062 6520 696e 6566 6669 6369   may be ineffici
-00037d60: 656e 7420 2d20 7365 6520 2331 3938 392e  ent - see #1989.
-00037d70: 2048 6f77 6576 6572 2c20 7369 6e63 6520   However, since 
-00037d80: 7765 2772 650a 2020 2020 2020 2020 2020  we're.          
-00037d90: 2020 2020 2020 2320 6e20 636f 7069 6573        # n copies
-00037da0: 206f 6620 7468 6520 7265 6665 7265 6e63   of the referenc
-00037db0: 6520 7365 7175 656e 6365 2061 6e79 7761  e sequence anywa
-00037dc0: 792c 2074 6869 7320 6973 2061 2072 656c  y, this is a rel
-00037dd0: 6174 6976 656c 790a 2020 2020 2020 2020  atively.        
-00037de0: 2020 2020 2020 2020 2320 6d69 6e6f 7220          # minor 
-00037df0: 7477 6561 6b2e 2057 6520 6d61 7920 616c  tweak. We may al
-00037e00: 736f 2077 616e 7420 746f 2072 6563 6f64  so want to recod
-00037e10: 6520 7468 6520 6265 6c6f 7720 6e6f 7420  e the below not 
-00037e20: 746f 2075 7365 2064 6972 6563 740a 2020  to use direct.  
-00037e30: 2020 2020 2020 2020 2020 2020 2020 2320                # 
-00037e40: 6163 6365 7373 2074 6f20 7468 6520 2e64  access to the .d
-00037e50: 6174 6120 6174 7472 6962 7574 652c 2065  ata attribute, e
-00037e60: 2e67 2e20 6966 2077 6520 616c 6c6f 7720  .g. if we allow 
-00037e70: 7265 6665 7265 6e63 6520 7365 7175 656e  reference sequen
-00037e80: 6365 730a 2020 2020 2020 2020 2020 2020  ces.            
-00037e90: 2020 2020 2320 746f 2073 7461 7274 2061      # to start a
-00037ea0: 7420 6e6f 6e2d 7a65 726f 2070 6f73 6974  t non-zero posit
-00037eb0: 696f 6e73 0a20 2020 2020 2020 2020 2020  ions.           
-00037ec0: 2020 2020 2072 6566 6572 656e 6365 5f73       reference_s
-00037ed0: 6571 7565 6e63 6520 3d20 7365 6c66 2e72  equence = self.r
-00037ee0: 6566 6572 656e 6365 5f73 6571 7565 6e63  eference_sequenc
-00037ef0: 652e 6461 7461 5b0a 2020 2020 2020 2020  e.data[.        
-00037f00: 2020 2020 2020 2020 2020 2020 696e 7465              inte
-00037f10: 7276 616c 2e6c 6566 7420 3a20 696e 7465  rval.left : inte
-00037f20: 7276 616c 2e72 6967 6874 0a20 2020 2020  rval.right.     
-00037f30: 2020 2020 2020 2020 2020 205d 0a20 2020             ].   
-00037f40: 2020 2020 2020 2020 2065 6c73 653a 0a20           else:. 
-00037f50: 2020 2020 2020 2020 2020 2020 2020 2072                 r
-00037f60: 6566 6572 656e 6365 5f73 6571 7565 6e63  eference_sequenc
-00037f70: 6520 3d20 6d69 7373 696e 675f 6461 7461  e = missing_data
-00037f80: 5f63 6861 7261 6374 6572 202a 204c 0a0a  _character * L..
-00037f90: 2020 2020 2020 2020 6966 206c 656e 2872          if len(r
-00037fa0: 6566 6572 656e 6365 5f73 6571 7565 6e63  eference_sequenc
-00037fb0: 6529 2021 3d20 4c3a 0a20 2020 2020 2020  e) != L:.       
-00037fc0: 2020 2020 2069 6620 696e 7465 7276 616c       if interval
-00037fd0: 2e72 6967 6874 203d 3d20 696e 7428 7365  .right == int(se
-00037fe0: 6c66 2e73 6571 7565 6e63 655f 6c65 6e67  lf.sequence_leng
-00037ff0: 7468 293a 0a20 2020 2020 2020 2020 2020  th):.           
-00038000: 2020 2020 2072 6169 7365 2056 616c 7565       raise Value
-00038010: 4572 726f 7228 0a20 2020 2020 2020 2020  Error(.         
-00038020: 2020 2020 2020 2020 2020 2022 5468 6520             "The 
-00038030: 7265 6665 7265 6e63 6520 7365 7175 656e  reference sequen
-00038040: 6365 2069 7320 7368 6f72 7465 7220 7468  ce is shorter th
-00038050: 616e 2074 6865 2074 7265 6520 7365 7175  an the tree sequ
-00038060: 656e 6365 206c 656e 6774 6822 0a20 2020  ence length".   
-00038070: 2020 2020 2020 2020 2020 2020 2029 0a20               ). 
-00038080: 2020 2020 2020 2020 2020 2065 6c73 653a             else:
-00038090: 0a20 2020 2020 2020 2020 2020 2020 2020  .               
-000380a0: 2072 6169 7365 2056 616c 7565 4572 726f   raise ValueErro
-000380b0: 7228 0a20 2020 2020 2020 2020 2020 2020  r(.             
-000380c0: 2020 2020 2020 2022 5468 6520 7265 6665         "The refe
-000380d0: 7265 6e63 6520 7365 7175 656e 6365 2065  rence sequence e
-000380e0: 6e64 7320 6265 666f 7265 2074 6865 2072  nds before the r
-000380f0: 6571 7565 7374 6564 2073 746f 7020 706f  equested stop po
-00038100: 7369 7469 6f6e 220a 2020 2020 2020 2020  sition".        
-00038110: 2020 2020 2020 2020 290a 2020 2020 2020          ).      
-00038120: 2020 7265 665f 6279 7465 7320 3d20 7265    ref_bytes = re
-00038130: 6665 7265 6e63 655f 7365 7175 656e 6365  ference_sequence
-00038140: 2e65 6e63 6f64 6528 2261 7363 6969 2229  .encode("ascii")
-00038150: 0a20 2020 2020 2020 2061 5b3a 5d20 3d20  .        a[:] = 
-00038160: 6e70 2e66 726f 6d62 7566 6665 7228 7265  np.frombuffer(re
-00038170: 665f 6279 7465 732c 2064 7479 7065 3d6e  f_bytes, dtype=n
-00038180: 702e 696e 7438 290a 0a20 2020 2020 2020  p.int8)..       
-00038190: 2023 2054 6f20 646f 2074 6869 7320 7072   # To do this pr
-000381a0: 6f70 6572 6c79 2077 6527 6c6c 2068 6176  operly we'll hav
-000381b0: 6520 746f 2064 6574 6563 7420 7468 6520  e to detect the 
-000381c0: 6d69 7373 696e 6720 6461 7461 2061 730a  missing data as.
-000381d0: 2020 2020 2020 2020 2320 7061 7274 206f          # part o
-000381e0: 6620 6120 6675 6c6c 2069 6d70 6c65 6d65  f a full impleme
-000381f0: 6e74 6174 696f 6e20 6f66 2061 6c69 676e  ntation of align
-00038200: 6d65 6e74 7320 696e 2043 2e20 5468 6520  ments in C. The 
-00038210: 6375 7272 656e 740a 2020 2020 2020 2020  current.        
-00038220: 2320 6465 6669 6e69 7469 6f6e 206d 6967  # definition mig
-00038230: 6874 206e 6f74 2062 6520 6361 6c6c 696e  ht not be callin
-00038240: 6720 736f 6d65 2064 6567 656e 6572 6174  g some degenerat
-00038250: 6520 6361 7365 7320 636f 7272 6563 746c  e cases correctl
-00038260: 793b 0a20 2020 2020 2020 2023 2073 6565  y;.        # see
-00038270: 2068 7474 7073 3a2f 2f67 6974 6875 622e   https://github.
-00038280: 636f 6d2f 7473 6b69 742d 6465 762f 7473  com/tskit-dev/ts
-00038290: 6b69 742f 6973 7375 6573 2f31 3930 380a  kit/issues/1908.
-000382a0: 2020 2020 2020 2020 230a 2020 2020 2020          #.      
-000382b0: 2020 2320 4e6f 7465 2061 6c73 6f20 7468    # Note also th
-000382c0: 6174 2074 6869 7320 7769 6c6c 2063 616c  at this will cal
-000382d0: 6c20 7468 6520 7072 6573 656e 6365 206f  l the presence o
-000382e0: 6620 6d69 7373 696e 6720 6461 7461 0a20  f missing data. 
-000382f0: 2020 2020 2020 2023 2069 6e63 6f72 7265         # incorre
-00038300: 6374 6c79 2069 6620 6861 7665 2061 2073  ctly if have a s
-00038310: 616d 706c 6520 6973 6f6c 6174 6564 206f  ample isolated o
-00038320: 7665 7220 7468 6520 7265 6769 6f6e 2028  ver the region (
-00038330: 612c 2062 5d2c 0a20 2020 2020 2020 2023  a, b],.        #
-00038340: 2061 6e64 2069 6620 7765 2068 6176 6520   and if we have 
-00038350: 7369 7465 7320 6174 2065 6163 6820 706f  sites at each po
-00038360: 7369 7469 6f6e 2066 726f 6d20 6120 746f  sition from a to
-00038370: 2062 2c20 616e 6420 6174 0a20 2020 2020   b, and at.     
-00038380: 2020 2023 2065 6163 6820 7369 7465 2074     # each site t
-00038390: 6865 7265 2069 7320 6120 6d75 7461 7469  here is a mutati
-000383a0: 6f6e 206f 7665 7220 7468 6520 6973 6f6c  on over the isol
-000383b0: 6174 6564 2073 616d 706c 652e 0a20 2020  ated sample..   
-000383c0: 2020 2020 2069 6620 616e 7928 7472 6565       if any(tree
-000383d0: 2e5f 6861 735f 6973 6f6c 6174 6564 5f73  ._has_isolated_s
-000383e0: 616d 706c 6573 2829 2066 6f72 2074 7265  amples() for tre
-000383f0: 6520 696e 2073 656c 662e 7472 6565 7328  e in self.trees(
-00038400: 2929 3a0a 2020 2020 2020 2020 2020 2020  )):.            
-00038410: 7261 6973 6520 5661 6c75 6545 7272 6f72  raise ValueError
-00038420: 280a 2020 2020 2020 2020 2020 2020 2020  (.              
-00038430: 2020 224d 6973 7369 6e67 2064 6174 6120    "Missing data 
-00038440: 6e6f 7420 6375 7272 656e 746c 7920 7375  not currently su
-00038450: 7070 6f72 7465 6420 696e 2061 6c69 676e  pported in align
-00038460: 6d65 6e74 733b 2073 6565 2022 0a20 2020  ments; see ".   
-00038470: 2020 2020 2020 2020 2020 2020 2022 6874               "ht
-00038480: 7470 733a 2f2f 6769 7468 7562 2e63 6f6d  tps://github.com
-00038490: 2f74 736b 6974 2d64 6576 2f74 736b 6974  /tskit-dev/tskit
-000384a0: 2f69 7373 7565 732f 3138 3936 2066 6f72  /issues/1896 for
-000384b0: 2064 6574 6169 6c73 2e22 0a20 2020 2020   details.".     
-000384c0: 2020 2020 2020 2020 2020 2022 5468 6520             "The 
-000384d0: 6375 7272 656e 7420 696d 706c 656d 656e  current implemen
-000384e0: 7461 7469 6f6e 206d 6179 2061 6c73 6f20  tation may also 
-000384f0: 696e 636f 7272 6563 746c 7920 6964 656e  incorrectly iden
-00038500: 7469 6679 2061 6e20 220a 2020 2020 2020  tify an ".      
-00038510: 2020 2020 2020 2020 2020 2269 6e70 7574            "input
-00038520: 2074 7265 6520 7365 7175 656e 6365 2068   tree sequence h
-00038530: 6173 2068 6176 696e 6720 6d69 7373 696e  as having missin
-00038540: 6720 6461 7461 2e22 0a20 2020 2020 2020  g data.".       
-00038550: 2020 2020 2029 0a20 2020 2020 2020 2048       ).        H
-00038560: 2c20 2866 6972 7374 5f73 6974 655f 6964  , (first_site_id
-00038570: 2c20 6c61 7374 5f73 6974 655f 6964 2920  , last_site_id) 
-00038580: 3d20 7365 6c66 2e5f 6861 706c 6f74 7970  = self._haplotyp
-00038590: 6573 5f61 7272 6179 280a 2020 2020 2020  es_array(.      
-000385a0: 2020 2020 2020 696e 7465 7276 616c 3d69        interval=i
-000385b0: 6e74 6572 7661 6c2c 0a20 2020 2020 2020  nterval,.       
-000385c0: 2020 2020 206d 6973 7369 6e67 5f64 6174       missing_dat
-000385d0: 615f 6368 6172 6163 7465 723d 6d69 7373  a_character=miss
-000385e0: 696e 675f 6461 7461 5f63 6861 7261 6374  ing_data_charact
-000385f0: 6572 2c0a 2020 2020 2020 2020 2020 2020  er,.            
-00038600: 7361 6d70 6c65 733d 7361 6d70 6c65 732c  samples=samples,
-00038610: 0a20 2020 2020 2020 2029 0a20 2020 2020  .        ).     
-00038620: 2020 2073 6974 655f 706f 7320 3d20 7365     site_pos = se
-00038630: 6c66 2e73 6974 6573 5f70 6f73 6974 696f  lf.sites_positio
-00038640: 6e2e 6173 7479 7065 286e 702e 696e 7436  n.astype(np.int6
-00038650: 3429 5b0a 2020 2020 2020 2020 2020 2020  4)[.            
-00038660: 6669 7273 745f 7369 7465 5f69 6420 3a20  first_site_id : 
-00038670: 6c61 7374 5f73 6974 655f 6964 202b 2031  last_site_id + 1
-00038680: 0a20 2020 2020 2020 205d 0a20 2020 2020  .        ].     
-00038690: 2020 2066 6f72 2068 2069 6e20 483a 0a20     for h in H:. 
-000386a0: 2020 2020 2020 2020 2020 2061 5b73 6974             a[sit
-000386b0: 655f 706f 7320 2d20 696e 7465 7276 616c  e_pos - interval
-000386c0: 2e6c 6566 745d 203d 2068 0a20 2020 2020  .left] = h.     
-000386d0: 2020 2020 2020 2079 6965 6c64 2061 2e74         yield a.t
-000386e0: 6f62 7974 6573 2829 2e64 6563 6f64 6528  obytes().decode(
-000386f0: 2261 7363 6969 2229 0a0a 2020 2020 4070  "ascii")..    @p
-00038700: 726f 7065 7274 790a 2020 2020 6465 6620  roperty.    def 
-00038710: 696e 6469 7669 6475 616c 735f 706f 7075  individuals_popu
-00038720: 6c61 7469 6f6e 2873 656c 6629 3a0a 2020  lation(self):.  
-00038730: 2020 2020 2020 2222 220a 2020 2020 2020        """.      
-00038740: 2020 5265 7475 726e 7320 7468 6520 6c65    Returns the le
-00038750: 6e67 7468 2d60 606e 756d 5f69 6e64 6976  ngth-``num_indiv
-00038760: 6964 7561 6c73 6060 2061 7272 6179 2063  iduals`` array c
-00038770: 6f6e 7461 696e 696e 672c 2066 6f72 2065  ontaining, for e
-00038780: 6163 680a 2020 2020 2020 2020 696e 6469  ach.        indi
-00038790: 7669 6475 616c 2c20 7468 6520 6060 706f  vidual, the ``po
-000387a0: 7075 6c61 7469 6f6e 6060 2061 7474 7269  pulation`` attri
-000387b0: 6275 7465 206f 6620 7468 6569 7220 6e6f  bute of their no
-000387c0: 6465 732c 206f 720a 2020 2020 2020 2020  des, or.        
-000387d0: 6060 7473 6b69 742e 4e55 4c4c 6060 2066  ``tskit.NULL`` f
-000387e0: 6f72 2069 6e64 6976 6964 7561 6c73 2077  or individuals w
-000387f0: 6974 6820 6e6f 206e 6f64 6573 2e20 4572  ith no nodes. Er
-00038800: 726f 7273 2069 6620 616e 7920 696e 6469  rors if any indi
-00038810: 7669 6475 616c 0a20 2020 2020 2020 2068  vidual.        h
-00038820: 6173 206e 6f64 6573 2077 6974 6820 696e  as nodes with in
-00038830: 636f 6e73 6973 7465 6e74 206e 6f6e 2d4e  consistent non-N
-00038840: 554c 4c20 706f 7075 6c61 7469 6f6e 732e  ULL populations.
-00038850: 0a20 2020 2020 2020 2022 2222 0a20 2020  .        """.   
-00038860: 2020 2020 2069 6620 7365 6c66 2e5f 696e       if self._in
-00038870: 6469 7669 6475 616c 735f 706f 7075 6c61  dividuals_popula
-00038880: 7469 6f6e 2069 7320 4e6f 6e65 3a0a 2020  tion is None:.  
-00038890: 2020 2020 2020 2020 2020 7365 6c66 2e5f            self._
-000388a0: 696e 6469 7669 6475 616c 735f 706f 7075  individuals_popu
-000388b0: 6c61 7469 6f6e 203d 2028 0a20 2020 2020  lation = (.     
-000388c0: 2020 2020 2020 2020 2020 2073 656c 662e             self.
-000388d0: 5f6c 6c5f 7472 6565 5f73 6571 7565 6e63  _ll_tree_sequenc
-000388e0: 652e 6765 745f 696e 6469 7669 6475 616c  e.get_individual
-000388f0: 735f 706f 7075 6c61 7469 6f6e 2829 0a20  s_population(). 
-00038900: 2020 2020 2020 2020 2020 2029 0a20 2020             ).   
-00038910: 2020 2020 2072 6574 7572 6e20 7365 6c66       return self
-00038920: 2e5f 696e 6469 7669 6475 616c 735f 706f  ._individuals_po
-00038930: 7075 6c61 7469 6f6e 0a0a 2020 2020 4070  pulation..    @p
-00038940: 726f 7065 7274 790a 2020 2020 6465 6620  roperty.    def 
-00038950: 696e 6469 7669 6475 616c 5f70 6f70 756c  individual_popul
-00038960: 6174 696f 6e73 2873 656c 6629 3a0a 2020  ations(self):.  
-00038970: 2020 2020 2020 2320 556e 646f 6375 6d65        # Undocume
-00038980: 6e74 6564 2061 6c69 6173 2066 6f72 2069  nted alias for i
-00038990: 6e64 6976 6964 7561 6c73 5f70 6f70 756c  ndividuals_popul
-000389a0: 6174 696f 6e20 746f 2061 766f 6964 2062  ation to avoid b
-000389b0: 7265 616b 696e 670a 2020 2020 2020 2020  reaking.        
-000389c0: 2320 7072 652d 312e 3020 7079 736c 696d  # pre-1.0 pyslim
-000389d0: 2063 6f64 650a 2020 2020 2020 2020 7265   code.        re
-000389e0: 7475 726e 2073 656c 662e 696e 6469 7669  turn self.indivi
-000389f0: 6475 616c 735f 706f 7075 6c61 7469 6f6e  duals_population
-00038a00: 0a0a 2020 2020 4070 726f 7065 7274 790a  ..    @property.
-00038a10: 2020 2020 6465 6620 696e 6469 7669 6475      def individu
-00038a20: 616c 735f 7469 6d65 2873 656c 6629 3a0a  als_time(self):.
-00038a30: 2020 2020 2020 2020 2222 220a 2020 2020          """.    
-00038a40: 2020 2020 5265 7475 726e 7320 7468 6520      Returns the 
-00038a50: 6c65 6e67 7468 2d60 606e 756d 5f69 6e64  length-``num_ind
-00038a60: 6976 6964 7561 6c73 6060 2061 7272 6179  ividuals`` array
-00038a70: 2063 6f6e 7461 696e 696e 672c 2066 6f72   containing, for
-00038a80: 2065 6163 680a 2020 2020 2020 2020 696e   each.        in
-00038a90: 6469 7669 6475 616c 2c20 7468 6520 6060  dividual, the ``
-00038aa0: 7469 6d65 6060 2061 7474 7269 6275 7465  time`` attribute
-00038ab0: 206f 6620 7468 6569 7220 6e6f 6465 7320   of their nodes 
-00038ac0: 6f72 2060 606e 702e 6e61 6e60 6020 666f  or ``np.nan`` fo
-00038ad0: 720a 2020 2020 2020 2020 696e 6469 7669  r.        indivi
-00038ae0: 6475 616c 7320 7769 7468 206e 6f20 6e6f  duals with no no
-00038af0: 6465 732e 2045 7272 6f72 7320 6966 2061  des. Errors if a
-00038b00: 6e79 2069 6e64 6976 6964 7561 6c20 6861  ny individual ha
-00038b10: 7320 6e6f 6465 7320 7769 7468 0a20 2020  s nodes with.   
-00038b20: 2020 2020 2069 6e63 6f6e 7369 7374 656e       inconsisten
-00038b30: 7420 7469 6d65 732e 0a20 2020 2020 2020  t times..       
-00038b40: 2022 2222 0a20 2020 2020 2020 2069 6620   """.        if 
-00038b50: 7365 6c66 2e5f 696e 6469 7669 6475 616c  self._individual
-00038b60: 735f 7469 6d65 2069 7320 4e6f 6e65 3a0a  s_time is None:.
-00038b70: 2020 2020 2020 2020 2020 2020 7365 6c66              self
-00038b80: 2e5f 696e 6469 7669 6475 616c 735f 7469  ._individuals_ti
-00038b90: 6d65 203d 2073 656c 662e 5f6c 6c5f 7472  me = self._ll_tr
-00038ba0: 6565 5f73 6571 7565 6e63 652e 6765 745f  ee_sequence.get_
-00038bb0: 696e 6469 7669 6475 616c 735f 7469 6d65  individuals_time
-00038bc0: 2829 0a20 2020 2020 2020 2072 6574 7572  ().        retur
-00038bd0: 6e20 7365 6c66 2e5f 696e 6469 7669 6475  n self._individu
-00038be0: 616c 735f 7469 6d65 0a0a 2020 2020 4070  als_time..    @p
-00038bf0: 726f 7065 7274 790a 2020 2020 6465 6620  roperty.    def 
-00038c00: 696e 6469 7669 6475 616c 5f74 696d 6573  individual_times
-00038c10: 2873 656c 6629 3a0a 2020 2020 2020 2020  (self):.        
-00038c20: 2320 556e 646f 6375 6d65 6e74 6564 2061  # Undocumented a
-00038c30: 6c69 6173 2066 6f72 2069 6e64 6976 6964  lias for individ
-00038c40: 7561 6c73 5f74 696d 6520 746f 2061 766f  uals_time to avo
-00038c50: 6964 2062 7265 616b 696e 670a 2020 2020  id breaking.    
-00038c60: 2020 2020 2320 7072 652d 312e 3020 7079      # pre-1.0 py
-00038c70: 736c 696d 2063 6f64 650a 2020 2020 2020  slim code.      
-00038c80: 2020 7265 7475 726e 2073 656c 662e 696e    return self.in
-00038c90: 6469 7669 6475 616c 735f 7469 6d65 0a0a  dividuals_time..
-00038ca0: 2020 2020 4070 726f 7065 7274 790a 2020      @property.  
-00038cb0: 2020 6465 6620 696e 6469 7669 6475 616c    def individual
-00038cc0: 735f 6c6f 6361 7469 6f6e 2873 656c 6629  s_location(self)
-00038cd0: 3a0a 2020 2020 2020 2020 2222 220a 2020  :.        """.  
-00038ce0: 2020 2020 2020 436f 6e76 656e 6965 6e63        Convenienc
-00038cf0: 6520 6d65 7468 6f64 2072 6574 7572 6e69  e method returni
-00038d00: 6e67 2074 6865 2060 606e 756d 5f69 6e64  ng the ``num_ind
-00038d10: 6976 6964 7561 6c73 2078 206e 6060 2061  ividuals x n`` a
-00038d20: 7272 6179 0a20 2020 2020 2020 2077 686f  rray.        who
-00038d30: 7365 2072 6f77 206b 2d74 6820 726f 7720  se row k-th row 
-00038d40: 636f 6e74 6169 6e73 2074 6865 2060 606c  contains the ``l
-00038d50: 6f63 6174 696f 6e60 6020 7072 6f70 6572  ocation`` proper
-00038d60: 7479 206f 6620 7468 6520 6b2d 7468 0a20  ty of the k-th. 
-00038d70: 2020 2020 2020 2069 6e64 6976 6964 7561         individua
-00038d80: 6c2e 2054 6865 206d 6574 686f 6420 6f6e  l. The method on
-00038d90: 6c79 2077 6f72 6b73 2069 6620 616c 6c20  ly works if all 
-00038da0: 696e 6469 7669 6475 616c 7327 206c 6f63  individuals' loc
-00038db0: 6174 696f 6e73 0a20 2020 2020 2020 2068  ations.        h
-00038dc0: 6176 6520 7468 6520 7361 6d65 206c 656e  ave the same len
-00038dd0: 6774 6820 2877 6869 6368 2069 7320 6060  gth (which is ``
-00038de0: 6e60 6029 2c20 616e 6420 6572 726f 7273  n``), and errors
-00038df0: 206f 7468 6572 7769 7365 2e0a 2020 2020   otherwise..    
-00038e00: 2020 2020 2222 220a 2020 2020 2020 2020      """.        
-00038e10: 6966 2073 656c 662e 5f69 6e64 6976 6964  if self._individ
-00038e20: 7561 6c73 5f6c 6f63 6174 696f 6e20 6973  uals_location is
-00038e30: 204e 6f6e 653a 0a20 2020 2020 2020 2020   None:.         
-00038e40: 2020 2069 6e64 6976 6964 7561 6c73 203d     individuals =
-00038e50: 2073 656c 662e 7461 626c 6573 2e69 6e64   self.tables.ind
-00038e60: 6976 6964 7561 6c73 0a20 2020 2020 2020  ividuals.       
-00038e70: 2020 2020 206e 203d 2030 0a20 2020 2020       n = 0.     
-00038e80: 2020 2020 2020 206c 656e 7320 3d20 6e70         lens = np
-00038e90: 2e75 6e69 7175 6528 6e70 2e64 6966 6628  .unique(np.diff(
-00038ea0: 696e 6469 7669 6475 616c 732e 6c6f 6361  individuals.loca
-00038eb0: 7469 6f6e 5f6f 6666 7365 7429 290a 2020  tion_offset)).  
-00038ec0: 2020 2020 2020 2020 2020 6966 206c 656e            if len
-00038ed0: 286c 656e 7329 203e 2031 3a0a 2020 2020  (lens) > 1:.    
-00038ee0: 2020 2020 2020 2020 2020 2020 7261 6973              rais
-00038ef0: 6520 5661 6c75 6545 7272 6f72 2822 496e  e ValueError("In
-00038f00: 6469 7669 6475 616c 206c 6f63 6174 696f  dividual locatio
-00038f10: 6e73 2061 7265 206e 6f74 2061 6c6c 2074  ns are not all t
-00038f20: 6865 2073 616d 6520 6c65 6e67 7468 2e22  he same length."
-00038f30: 290a 2020 2020 2020 2020 2020 2020 6966  ).            if
-00038f40: 206c 656e 286c 656e 7329 203e 2030 3a0a   len(lens) > 0:.
-00038f50: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00038f60: 6e20 3d20 6c65 6e73 5b30 5d0a 2020 2020  n = lens[0].    
-00038f70: 2020 2020 2020 2020 7365 6c66 2e5f 696e          self._in
-00038f80: 6469 7669 6475 616c 735f 6c6f 6361 7469  dividuals_locati
-00038f90: 6f6e 203d 2069 6e64 6976 6964 7561 6c73  on = individuals
-00038fa0: 2e6c 6f63 6174 696f 6e2e 7265 7368 6170  .location.reshap
-00038fb0: 6528 0a20 2020 2020 2020 2020 2020 2020  e(.             
-00038fc0: 2020 2028 7365 6c66 2e6e 756d 5f69 6e64     (self.num_ind
-00038fd0: 6976 6964 7561 6c73 2c20 6e29 0a20 2020  ividuals, n).   
-00038fe0: 2020 2020 2020 2020 2029 0a20 2020 2020           ).     
-00038ff0: 2020 2072 6574 7572 6e20 7365 6c66 2e5f     return self._
-00039000: 696e 6469 7669 6475 616c 735f 6c6f 6361  individuals_loca
-00039010: 7469 6f6e 0a0a 2020 2020 4070 726f 7065  tion..    @prope
-00039020: 7274 790a 2020 2020 6465 6620 696e 6469  rty.    def indi
-00039030: 7669 6475 616c 5f6c 6f63 6174 696f 6e73  vidual_locations
-00039040: 2873 656c 6629 3a0a 2020 2020 2020 2020  (self):.        
-00039050: 2320 556e 646f 6375 6d65 6e74 6564 2061  # Undocumented a
-00039060: 6c69 6173 2066 6f72 2069 6e64 6976 6964  lias for individ
-00039070: 7561 6c73 5f74 696d 6520 746f 2061 766f  uals_time to avo
-00039080: 6964 2062 7265 616b 696e 670a 2020 2020  id breaking.    
-00039090: 2020 2020 2320 7072 652d 312e 3020 7079      # pre-1.0 py
-000390a0: 736c 696d 2063 6f64 650a 2020 2020 2020  slim code.      
-000390b0: 2020 7265 7475 726e 2073 656c 662e 696e    return self.in
-000390c0: 6469 7669 6475 616c 735f 6c6f 6361 7469  dividuals_locati
-000390d0: 6f6e 0a0a 2020 2020 4070 726f 7065 7274  on..    @propert
-000390e0: 790a 2020 2020 6465 6620 696e 6469 7669  y.    def indivi
-000390f0: 6475 616c 735f 666c 6167 7328 7365 6c66  duals_flags(self
-00039100: 293a 0a20 2020 2020 2020 2022 2222 0a20  ):.        """. 
-00039110: 2020 2020 2020 2045 6666 6963 6965 6e74         Efficient
-00039120: 2061 6363 6573 7320 746f 2074 6865 2060   access to the `
-00039130: 6066 6c61 6773 6060 2063 6f6c 756d 6e20  `flags`` column 
-00039140: 696e 2074 6865 0a20 2020 2020 2020 203a  in the.        :
-00039150: 7265 663a 6073 6563 5f69 6e64 6976 6964  ref:`sec_individ
-00039160: 7561 6c5f 7461 626c 655f 6465 6669 6e69  ual_table_defini
-00039170: 7469 6f6e 6020 6173 2061 206e 756d 7079  tion` as a numpy
-00039180: 2061 7272 6179 2028 6474 7970 653d 6e70   array (dtype=np
-00039190: 2e75 696e 7433 3229 2e0a 2020 2020 2020  .uint32)..      
-000391a0: 2020 4571 7569 7661 6c65 6e74 2074 6f20    Equivalent to 
-000391b0: 6060 7473 2e74 6162 6c65 732e 696e 6469  ``ts.tables.indi
-000391c0: 7669 6475 616c 732e 666c 6167 7360 6020  viduals.flags`` 
-000391d0: 2862 7574 2061 766f 6964 696e 6720 7468  (but avoiding th
-000391e0: 6520 6675 6c6c 2063 6f70 790a 2020 2020  e full copy.    
-000391f0: 2020 2020 6f66 2074 6865 2074 6162 6c65      of the table
-00039200: 2064 6174 6120 7468 6174 2061 6363 6573   data that acces
-00039210: 7369 6e67 2060 6074 732e 7461 626c 6573  sing ``ts.tables
-00039220: 6060 2063 7572 7265 6e74 6c79 2065 6e74  `` currently ent
-00039230: 6169 6c73 292e 0a20 2020 2020 2020 2022  ails)..        "
-00039240: 2222 0a20 2020 2020 2020 2072 6574 7572  "".        retur
-00039250: 6e20 7365 6c66 2e5f 696e 6469 7669 6475  n self._individu
-00039260: 616c 735f 666c 6167 730a 0a20 2020 2040  als_flags..    @
-00039270: 7072 6f70 6572 7479 0a20 2020 2064 6566  property.    def
-00039280: 206e 6f64 6573 5f74 696d 6528 7365 6c66   nodes_time(self
-00039290: 293a 0a20 2020 2020 2020 2022 2222 0a20  ):.        """. 
-000392a0: 2020 2020 2020 2045 6666 6963 6965 6e74         Efficient
-000392b0: 2061 6363 6573 7320 746f 2074 6865 2060   access to the `
-000392c0: 6074 696d 6560 6020 636f 6c75 6d6e 2069  `time`` column i
-000392d0: 6e20 7468 650a 2020 2020 2020 2020 3a72  n the.        :r
-000392e0: 6566 3a60 7365 635f 6e6f 6465 5f74 6162  ef:`sec_node_tab
-000392f0: 6c65 5f64 6566 696e 6974 696f 6e60 2061  le_definition` a
-00039300: 7320 6120 6e75 6d70 7920 6172 7261 7920  s a numpy array 
-00039310: 2864 7479 7065 3d6e 702e 666c 6f61 7436  (dtype=np.float6
-00039320: 3429 2e0a 2020 2020 2020 2020 4571 7569  4)..        Equi
-00039330: 7661 6c65 6e74 2074 6f20 6060 7473 2e74  valent to ``ts.t
-00039340: 6162 6c65 732e 6e6f 6465 732e 7469 6d65  ables.nodes.time
-00039350: 6060 2028 6275 7420 6176 6f69 6469 6e67  `` (but avoiding
-00039360: 2074 6865 2066 756c 6c20 636f 7079 0a20   the full copy. 
-00039370: 2020 2020 2020 206f 6620 7468 6520 7461         of the ta
-00039380: 626c 6520 6461 7461 2074 6861 7420 6163  ble data that ac
-00039390: 6365 7373 696e 6720 6060 7473 2e74 6162  cessing ``ts.tab
-000393a0: 6c65 7360 6020 6375 7272 656e 746c 7920  les`` currently 
-000393b0: 656e 7461 696c 7329 2e0a 2020 2020 2020  entails)..      
-000393c0: 2020 2222 220a 2020 2020 2020 2020 7265    """.        re
-000393d0: 7475 726e 2073 656c 662e 5f6e 6f64 6573  turn self._nodes
-000393e0: 5f74 696d 650a 0a20 2020 2040 7072 6f70  _time..    @prop
-000393f0: 6572 7479 0a20 2020 2064 6566 206e 6f64  erty.    def nod
-00039400: 6573 5f66 6c61 6773 2873 656c 6629 3a0a  es_flags(self):.
-00039410: 2020 2020 2020 2020 2222 220a 2020 2020          """.    
-00039420: 2020 2020 4566 6669 6369 656e 7420 6163      Efficient ac
-00039430: 6365 7373 2074 6f20 7468 6520 6060 666c  cess to the ``fl
-00039440: 6167 7360 6020 636f 6c75 6d6e 2069 6e20  ags`` column in 
-00039450: 7468 650a 2020 2020 2020 2020 3a72 6566  the.        :ref
-00039460: 3a60 7365 635f 6e6f 6465 5f74 6162 6c65  :`sec_node_table
-00039470: 5f64 6566 696e 6974 696f 6e60 2061 7320  _definition` as 
-00039480: 6120 6e75 6d70 7920 6172 7261 7920 2864  a numpy array (d
-00039490: 7479 7065 3d6e 702e 7569 6e74 3332 292e  type=np.uint32).
-000394a0: 0a20 2020 2020 2020 2045 7175 6976 616c  .        Equival
-000394b0: 656e 7420 746f 2060 6074 732e 7461 626c  ent to ``ts.tabl
-000394c0: 6573 2e6e 6f64 6573 2e66 6c61 6773 6060  es.nodes.flags``
-000394d0: 2028 6275 7420 6176 6f69 6469 6e67 2074   (but avoiding t
-000394e0: 6865 2066 756c 6c20 636f 7079 0a20 2020  he full copy.   
-000394f0: 2020 2020 206f 6620 7468 6520 7461 626c       of the tabl
-00039500: 6520 6461 7461 2074 6861 7420 6163 6365  e data that acce
-00039510: 7373 696e 6720 6060 7473 2e74 6162 6c65  ssing ``ts.table
-00039520: 7360 6020 6375 7272 656e 746c 7920 656e  s`` currently en
-00039530: 7461 696c 7329 2e0a 2020 2020 2020 2020  tails)..        
-00039540: 2222 220a 2020 2020 2020 2020 7265 7475  """.        retu
-00039550: 726e 2073 656c 662e 5f6e 6f64 6573 5f66  rn self._nodes_f
-00039560: 6c61 6773 0a0a 2020 2020 4070 726f 7065  lags..    @prope
-00039570: 7274 790a 2020 2020 6465 6620 6e6f 6465  rty.    def node
-00039580: 735f 706f 7075 6c61 7469 6f6e 2873 656c  s_population(sel
-00039590: 6629 3a0a 2020 2020 2020 2020 2222 220a  f):.        """.
-000395a0: 2020 2020 2020 2020 4566 6669 6369 656e          Efficien
-000395b0: 7420 6163 6365 7373 2074 6f20 7468 6520  t access to the 
-000395c0: 6060 706f 7075 6c61 7469 6f6e 6060 2063  ``population`` c
-000395d0: 6f6c 756d 6e20 696e 2074 6865 0a20 2020  olumn in the.   
-000395e0: 2020 2020 203a 7265 663a 6073 6563 5f6e       :ref:`sec_n
-000395f0: 6f64 655f 7461 626c 655f 6465 6669 6e69  ode_table_defini
-00039600: 7469 6f6e 6020 6173 2061 206e 756d 7079  tion` as a numpy
-00039610: 2061 7272 6179 2028 6474 7970 653d 6e70   array (dtype=np
-00039620: 2e69 6e74 3332 292e 0a20 2020 2020 2020  .int32)..       
-00039630: 2045 7175 6976 616c 656e 7420 746f 2060   Equivalent to `
-00039640: 6074 732e 7461 626c 6573 2e6e 6f64 6573  `ts.tables.nodes
-00039650: 2e70 6f70 756c 6174 696f 6e60 6020 2862  .population`` (b
-00039660: 7574 2061 766f 6964 696e 6720 7468 6520  ut avoiding the 
-00039670: 6675 6c6c 2063 6f70 790a 2020 2020 2020  full copy.      
-00039680: 2020 6f66 2074 6865 2074 6162 6c65 2064    of the table d
-00039690: 6174 6120 7468 6174 2061 6363 6573 7369  ata that accessi
-000396a0: 6e67 2060 6074 732e 7461 626c 6573 6060  ng ``ts.tables``
-000396b0: 2063 7572 7265 6e74 6c79 2065 6e74 6169   currently entai
-000396c0: 6c73 292e 0a20 2020 2020 2020 2022 2222  ls)..        """
-000396d0: 0a20 2020 2020 2020 2072 6574 7572 6e20  .        return 
-000396e0: 7365 6c66 2e5f 6e6f 6465 735f 706f 7075  self._nodes_popu
-000396f0: 6c61 7469 6f6e 0a0a 2020 2020 4070 726f  lation..    @pro
-00039700: 7065 7274 790a 2020 2020 6465 6620 6e6f  perty.    def no
-00039710: 6465 735f 696e 6469 7669 6475 616c 2873  des_individual(s
-00039720: 656c 6629 3a0a 2020 2020 2020 2020 2222  elf):.        ""
-00039730: 220a 2020 2020 2020 2020 4566 6669 6369  ".        Effici
-00039740: 656e 7420 6163 6365 7373 2074 6f20 7468  ent access to th
-00039750: 6520 6060 696e 6469 7669 6475 616c 6060  e ``individual``
-00039760: 2063 6f6c 756d 6e20 696e 2074 6865 0a20   column in the. 
-00039770: 2020 2020 2020 203a 7265 663a 6073 6563         :ref:`sec
-00039780: 5f6e 6f64 655f 7461 626c 655f 6465 6669  _node_table_defi
-00039790: 6e69 7469 6f6e 6020 6173 2061 206e 756d  nition` as a num
-000397a0: 7079 2061 7272 6179 2028 6474 7970 653d  py array (dtype=
-000397b0: 6e70 2e69 6e74 3332 292e 0a20 2020 2020  np.int32)..     
-000397c0: 2020 2045 7175 6976 616c 656e 7420 746f     Equivalent to
-000397d0: 2060 6074 732e 7461 626c 6573 2e6e 6f64   ``ts.tables.nod
-000397e0: 6573 2e69 6e64 6976 6964 7561 6c60 6020  es.individual`` 
-000397f0: 2862 7574 2061 766f 6964 696e 6720 7468  (but avoiding th
-00039800: 6520 6675 6c6c 2063 6f70 790a 2020 2020  e full copy.    
-00039810: 2020 2020 6f66 2074 6865 2074 6162 6c65      of the table
-00039820: 2064 6174 6120 7468 6174 2061 6363 6573   data that acces
-00039830: 7369 6e67 2060 6074 732e 7461 626c 6573  sing ``ts.tables
-00039840: 6060 2063 7572 7265 6e74 6c79 2065 6e74  `` currently ent
-00039850: 6169 6c73 292e 0a20 2020 2020 2020 2022  ails)..        "
-00039860: 2222 0a20 2020 2020 2020 2072 6574 7572  "".        retur
-00039870: 6e20 7365 6c66 2e5f 6e6f 6465 735f 696e  n self._nodes_in
-00039880: 6469 7669 6475 616c 0a0a 2020 2020 4070  dividual..    @p
-00039890: 726f 7065 7274 790a 2020 2020 6465 6620  roperty.    def 
-000398a0: 6564 6765 735f 6c65 6674 2873 656c 6629  edges_left(self)
-000398b0: 3a0a 2020 2020 2020 2020 2222 220a 2020  :.        """.  
-000398c0: 2020 2020 2020 4566 6669 6369 656e 7420        Efficient 
-000398d0: 6163 6365 7373 2074 6f20 7468 6520 6060  access to the ``
-000398e0: 6c65 6674 6060 2063 6f6c 756d 6e20 696e  left`` column in
-000398f0: 2074 6865 0a20 2020 2020 2020 203a 7265   the.        :re
-00039900: 663a 6073 6563 5f65 6467 655f 7461 626c  f:`sec_edge_tabl
-00039910: 655f 6465 6669 6e69 7469 6f6e 6020 6173  e_definition` as
-00039920: 2061 206e 756d 7079 2061 7272 6179 2028   a numpy array (
-00039930: 6474 7970 653d 6e70 2e66 6c6f 6174 3634  dtype=np.float64
-00039940: 292e 0a20 2020 2020 2020 2045 7175 6976  )..        Equiv
-00039950: 616c 656e 7420 746f 2060 6074 732e 7461  alent to ``ts.ta
-00039960: 626c 6573 2e65 6467 6573 2e6c 6566 7460  bles.edges.left`
-00039970: 6020 2862 7574 2061 766f 6964 696e 6720  ` (but avoiding 
-00039980: 7468 6520 6675 6c6c 2063 6f70 790a 2020  the full copy.  
-00039990: 2020 2020 2020 6f66 2074 6865 2074 6162        of the tab
-000399a0: 6c65 2064 6174 6120 7468 6174 2061 6363  le data that acc
-000399b0: 6573 7369 6e67 2060 6074 732e 7461 626c  essing ``ts.tabl
-000399c0: 6573 6060 2063 7572 7265 6e74 6c79 2065  es`` currently e
-000399d0: 6e74 6169 6c73 292e 0a20 2020 2020 2020  ntails)..       
-000399e0: 2022 2222 0a20 2020 2020 2020 2072 6574   """.        ret
-000399f0: 7572 6e20 7365 6c66 2e5f 6564 6765 735f  urn self._edges_
-00039a00: 6c65 6674 0a0a 2020 2020 4070 726f 7065  left..    @prope
-00039a10: 7274 790a 2020 2020 6465 6620 6564 6765  rty.    def edge
-00039a20: 735f 7269 6768 7428 7365 6c66 293a 0a20  s_right(self):. 
-00039a30: 2020 2020 2020 2022 2222 0a20 2020 2020         """.     
-00039a40: 2020 2045 6666 6963 6965 6e74 2061 6363     Efficient acc
-00039a50: 6573 7320 746f 2074 6865 2060 6072 6967  ess to the ``rig
-00039a60: 6874 6060 2063 6f6c 756d 6e20 696e 2074  ht`` column in t
-00039a70: 6865 0a20 2020 2020 2020 203a 7265 663a  he.        :ref:
-00039a80: 6073 6563 5f65 6467 655f 7461 626c 655f  `sec_edge_table_
-00039a90: 6465 6669 6e69 7469 6f6e 6020 6173 2061  definition` as a
-00039aa0: 206e 756d 7079 2061 7272 6179 2028 6474   numpy array (dt
-00039ab0: 7970 653d 6e70 2e66 6c6f 6174 3634 292e  ype=np.float64).
-00039ac0: 0a20 2020 2020 2020 2045 7175 6976 616c  .        Equival
-00039ad0: 656e 7420 746f 2060 6074 732e 7461 626c  ent to ``ts.tabl
-00039ae0: 6573 2e65 6467 6573 2e72 6967 6874 6060  es.edges.right``
-00039af0: 2028 6275 7420 6176 6f69 6469 6e67 2074   (but avoiding t
-00039b00: 6865 2066 756c 6c20 636f 7079 0a20 2020  he full copy.   
-00039b10: 2020 2020 206f 6620 7468 6520 7461 626c       of the tabl
-00039b20: 6520 6461 7461 2074 6861 7420 6163 6365  e data that acce
-00039b30: 7373 696e 6720 6060 7473 2e74 6162 6c65  ssing ``ts.table
-00039b40: 7360 6020 6375 7272 656e 746c 7920 656e  s`` currently en
-00039b50: 7461 696c 7329 2e0a 2020 2020 2020 2020  tails)..        
-00039b60: 2222 220a 2020 2020 2020 2020 7265 7475  """.        retu
-00039b70: 726e 2073 656c 662e 5f65 6467 6573 5f72  rn self._edges_r
-00039b80: 6967 6874 0a0a 2020 2020 4070 726f 7065  ight..    @prope
-00039b90: 7274 790a 2020 2020 6465 6620 6564 6765  rty.    def edge
-00039ba0: 735f 7061 7265 6e74 2873 656c 6629 3a0a  s_parent(self):.
-00039bb0: 2020 2020 2020 2020 2222 220a 2020 2020          """.    
-00039bc0: 2020 2020 4566 6669 6369 656e 7420 6163      Efficient ac
-00039bd0: 6365 7373 2074 6f20 7468 6520 6060 7061  cess to the ``pa
-00039be0: 7265 6e74 6060 2063 6f6c 756d 6e20 696e  rent`` column in
-00039bf0: 2074 6865 0a20 2020 2020 2020 203a 7265   the.        :re
-00039c00: 663a 6073 6563 5f65 6467 655f 7461 626c  f:`sec_edge_tabl
-00039c10: 655f 6465 6669 6e69 7469 6f6e 6020 6173  e_definition` as
-00039c20: 2061 206e 756d 7079 2061 7272 6179 2028   a numpy array (
-00039c30: 6474 7970 653d 6e70 2e69 6e74 3332 292e  dtype=np.int32).
-00039c40: 0a20 2020 2020 2020 2045 7175 6976 616c  .        Equival
-00039c50: 656e 7420 746f 2060 6074 732e 7461 626c  ent to ``ts.tabl
-00039c60: 6573 2e65 6467 6573 2e70 6172 656e 7460  es.edges.parent`
-00039c70: 6020 2862 7574 2061 766f 6964 696e 6720  ` (but avoiding 
-00039c80: 7468 6520 6675 6c6c 2063 6f70 790a 2020  the full copy.  
-00039c90: 2020 2020 2020 6f66 2074 6865 2074 6162        of the tab
-00039ca0: 6c65 2064 6174 6120 7468 6174 2061 6363  le data that acc
-00039cb0: 6573 7369 6e67 2060 6074 732e 7461 626c  essing ``ts.tabl
-00039cc0: 6573 6060 2063 7572 7265 6e74 6c79 2065  es`` currently e
-00039cd0: 6e74 6169 6c73 292e 0a20 2020 2020 2020  ntails)..       
-00039ce0: 2022 2222 0a20 2020 2020 2020 2072 6574   """.        ret
-00039cf0: 7572 6e20 7365 6c66 2e5f 6564 6765 735f  urn self._edges_
-00039d00: 7061 7265 6e74 0a0a 2020 2020 4070 726f  parent..    @pro
-00039d10: 7065 7274 790a 2020 2020 6465 6620 6564  perty.    def ed
-00039d20: 6765 735f 6368 696c 6428 7365 6c66 293a  ges_child(self):
-00039d30: 0a20 2020 2020 2020 2022 2222 0a20 2020  .        """.   
-00039d40: 2020 2020 2045 6666 6963 6965 6e74 2061       Efficient a
-00039d50: 6363 6573 7320 746f 2074 6865 2060 6063  ccess to the ``c
-00039d60: 6869 6c64 6060 2063 6f6c 756d 6e20 696e  hild`` column in
-00039d70: 2074 6865 0a20 2020 2020 2020 203a 7265   the.        :re
-00039d80: 663a 6073 6563 5f65 6467 655f 7461 626c  f:`sec_edge_tabl
-00039d90: 655f 6465 6669 6e69 7469 6f6e 6020 6173  e_definition` as
-00039da0: 2061 206e 756d 7079 2061 7272 6179 2028   a numpy array (
-00039db0: 6474 7970 653d 6e70 2e69 6e74 3332 292e  dtype=np.int32).
-00039dc0: 0a20 2020 2020 2020 2045 7175 6976 616c  .        Equival
-00039dd0: 656e 7420 746f 2060 6074 732e 7461 626c  ent to ``ts.tabl
-00039de0: 6573 2e65 6467 6573 2e63 6869 6c64 6060  es.edges.child``
-00039df0: 2028 6275 7420 6176 6f69 6469 6e67 2074   (but avoiding t
-00039e00: 6865 2066 756c 6c20 636f 7079 0a20 2020  he full copy.   
-00039e10: 2020 2020 206f 6620 7468 6520 7461 626c       of the tabl
-00039e20: 6520 6461 7461 2074 6861 7420 6163 6365  e data that acce
-00039e30: 7373 696e 6720 6060 7473 2e74 6162 6c65  ssing ``ts.table
-00039e40: 7360 6020 6375 7272 656e 746c 7920 656e  s`` currently en
-00039e50: 7461 696c 7329 2e0a 2020 2020 2020 2020  tails)..        
-00039e60: 2222 220a 2020 2020 2020 2020 7265 7475  """.        retu
-00039e70: 726e 2073 656c 662e 5f65 6467 6573 5f63  rn self._edges_c
-00039e80: 6869 6c64 0a0a 2020 2020 4070 726f 7065  hild..    @prope
-00039e90: 7274 790a 2020 2020 6465 6620 7369 7465  rty.    def site
-00039ea0: 735f 706f 7369 7469 6f6e 2873 656c 6629  s_position(self)
-00039eb0: 3a0a 2020 2020 2020 2020 2222 220a 2020  :.        """.  
-00039ec0: 2020 2020 2020 4566 6669 6369 656e 7420        Efficient 
-00039ed0: 6163 6365 7373 2074 6f20 7468 6520 6060  access to the ``
-00039ee0: 706f 7369 7469 6f6e 6060 2063 6f6c 756d  position`` colum
-00039ef0: 6e20 696e 2074 6865 0a20 2020 2020 2020  n in the.       
-00039f00: 203a 7265 663a 6073 6563 5f73 6974 655f   :ref:`sec_site_
-00039f10: 7461 626c 655f 6465 6669 6e69 7469 6f6e  table_definition
-00039f20: 6020 6173 2061 206e 756d 7079 2061 7272  ` as a numpy arr
-00039f30: 6179 2028 6474 7970 653d 6e70 2e66 6c6f  ay (dtype=np.flo
-00039f40: 6174 3634 292e 0a20 2020 2020 2020 2045  at64)..        E
-00039f50: 7175 6976 616c 656e 7420 746f 2060 6074  quivalent to ``t
-00039f60: 732e 7461 626c 6573 2e73 6974 6573 2e70  s.tables.sites.p
-00039f70: 6f73 6974 696f 6e60 6020 2862 7574 2061  osition`` (but a
-00039f80: 766f 6964 696e 6720 7468 6520 6675 6c6c  voiding the full
-00039f90: 2063 6f70 790a 2020 2020 2020 2020 6f66   copy.        of
-00039fa0: 2074 6865 2074 6162 6c65 2064 6174 6120   the table data 
-00039fb0: 7468 6174 2061 6363 6573 7369 6e67 2060  that accessing `
-00039fc0: 6074 732e 7461 626c 6573 6060 2063 7572  `ts.tables`` cur
-00039fd0: 7265 6e74 6c79 2065 6e74 6169 6c73 292e  rently entails).
-00039fe0: 0a20 2020 2020 2020 2022 2222 0a20 2020  .        """.   
-00039ff0: 2020 2020 2072 6574 7572 6e20 7365 6c66       return self
-0003a000: 2e5f 7369 7465 735f 706f 7369 7469 6f6e  ._sites_position
-0003a010: 0a0a 2020 2020 4070 726f 7065 7274 790a  ..    @property.
-0003a020: 2020 2020 6465 6620 6d75 7461 7469 6f6e      def mutation
-0003a030: 735f 7369 7465 2873 656c 6629 3a0a 2020  s_site(self):.  
-0003a040: 2020 2020 2020 2222 220a 2020 2020 2020        """.      
-0003a050: 2020 4566 6669 6369 656e 7420 6163 6365    Efficient acce
-0003a060: 7373 2074 6f20 7468 6520 6060 7369 7465  ss to the ``site
-0003a070: 6060 2063 6f6c 756d 6e20 696e 2074 6865  `` column in the
-0003a080: 0a20 2020 2020 2020 203a 7265 663a 6073  .        :ref:`s
-0003a090: 6563 5f6d 7574 6174 696f 6e5f 7461 626c  ec_mutation_tabl
-0003a0a0: 655f 6465 6669 6e69 7469 6f6e 6020 6173  e_definition` as
-0003a0b0: 2061 206e 756d 7079 2061 7272 6179 2028   a numpy array (
-0003a0c0: 6474 7970 653d 6e70 2e69 6e74 3332 292e  dtype=np.int32).
-0003a0d0: 0a20 2020 2020 2020 2045 7175 6976 616c  .        Equival
-0003a0e0: 656e 7420 746f 2060 6074 732e 7461 626c  ent to ``ts.tabl
-0003a0f0: 6573 2e6d 7574 6174 696f 6e73 2e73 6974  es.mutations.sit
-0003a100: 6560 6020 2862 7574 2061 766f 6964 696e  e`` (but avoidin
-0003a110: 6720 7468 6520 6675 6c6c 2063 6f70 790a  g the full copy.
-0003a120: 2020 2020 2020 2020 6f66 2074 6865 2074          of the t
-0003a130: 6162 6c65 2064 6174 6120 7468 6174 2061  able data that a
-0003a140: 6363 6573 7369 6e67 2060 6074 732e 7461  ccessing ``ts.ta
-0003a150: 626c 6573 6060 2063 7572 7265 6e74 6c79  bles`` currently
-0003a160: 2065 6e74 6169 6c73 292e 0a20 2020 2020   entails)..     
-0003a170: 2020 2022 2222 0a20 2020 2020 2020 2072     """.        r
-0003a180: 6574 7572 6e20 7365 6c66 2e5f 6d75 7461  eturn self._muta
-0003a190: 7469 6f6e 735f 7369 7465 0a0a 2020 2020  tions_site..    
-0003a1a0: 4070 726f 7065 7274 790a 2020 2020 6465  @property.    de
-0003a1b0: 6620 6d75 7461 7469 6f6e 735f 6e6f 6465  f mutations_node
-0003a1c0: 2873 656c 6629 3a0a 2020 2020 2020 2020  (self):.        
-0003a1d0: 2222 220a 2020 2020 2020 2020 4566 6669  """.        Effi
-0003a1e0: 6369 656e 7420 6163 6365 7373 2074 6f20  cient access to 
-0003a1f0: 7468 6520 6060 6e6f 6465 6060 2063 6f6c  the ``node`` col
-0003a200: 756d 6e20 696e 2074 6865 0a20 2020 2020  umn in the.     
-0003a210: 2020 203a 7265 663a 6073 6563 5f6d 7574     :ref:`sec_mut
-0003a220: 6174 696f 6e5f 7461 626c 655f 6465 6669  ation_table_defi
-0003a230: 6e69 7469 6f6e 6020 6173 2061 206e 756d  nition` as a num
-0003a240: 7079 2061 7272 6179 2028 6474 7970 653d  py array (dtype=
-0003a250: 6e70 2e69 6e74 3332 292e 0a20 2020 2020  np.int32)..     
-0003a260: 2020 2045 7175 6976 616c 656e 7420 746f     Equivalent to
-0003a270: 2060 6074 732e 7461 626c 6573 2e6d 7574   ``ts.tables.mut
-0003a280: 6174 696f 6e73 2e6e 6f64 6560 6020 2862  ations.node`` (b
-0003a290: 7574 2061 766f 6964 696e 6720 7468 6520  ut avoiding the 
-0003a2a0: 6675 6c6c 2063 6f70 790a 2020 2020 2020  full copy.      
-0003a2b0: 2020 6f66 2074 6865 2074 6162 6c65 2064    of the table d
-0003a2c0: 6174 6120 7468 6174 2061 6363 6573 7369  ata that accessi
-0003a2d0: 6e67 2060 6074 732e 7461 626c 6573 6060  ng ``ts.tables``
-0003a2e0: 2063 7572 7265 6e74 6c79 2065 6e74 6169   currently entai
-0003a2f0: 6c73 292e 0a20 2020 2020 2020 2022 2222  ls)..        """
-0003a300: 0a20 2020 2020 2020 2072 6574 7572 6e20  .        return 
-0003a310: 7365 6c66 2e5f 6d75 7461 7469 6f6e 735f  self._mutations_
-0003a320: 6e6f 6465 0a0a 2020 2020 4070 726f 7065  node..    @prope
-0003a330: 7274 790a 2020 2020 6465 6620 6d75 7461  rty.    def muta
-0003a340: 7469 6f6e 735f 7061 7265 6e74 2873 656c  tions_parent(sel
-0003a350: 6629 3a0a 2020 2020 2020 2020 2222 220a  f):.        """.
-0003a360: 2020 2020 2020 2020 4566 6669 6369 656e          Efficien
-0003a370: 7420 6163 6365 7373 2074 6f20 7468 6520  t access to the 
-0003a380: 6060 7061 7265 6e74 6060 2063 6f6c 756d  ``parent`` colum
-0003a390: 6e20 696e 2074 6865 0a20 2020 2020 2020  n in the.       
-0003a3a0: 203a 7265 663a 6073 6563 5f6d 7574 6174   :ref:`sec_mutat
-0003a3b0: 696f 6e5f 7461 626c 655f 6465 6669 6e69  ion_table_defini
-0003a3c0: 7469 6f6e 6020 6173 2061 206e 756d 7079  tion` as a numpy
-0003a3d0: 2061 7272 6179 2028 6474 7970 653d 6e70   array (dtype=np
-0003a3e0: 2e69 6e74 3332 292e 0a20 2020 2020 2020  .int32)..       
-0003a3f0: 2045 7175 6976 616c 656e 7420 746f 2060   Equivalent to `
-0003a400: 6074 732e 7461 626c 6573 2e6d 7574 6174  `ts.tables.mutat
-0003a410: 696f 6e73 2e70 6172 656e 7460 6020 2862  ions.parent`` (b
-0003a420: 7574 2061 766f 6964 696e 6720 7468 6520  ut avoiding the 
-0003a430: 6675 6c6c 2063 6f70 790a 2020 2020 2020  full copy.      
-0003a440: 2020 6f66 2074 6865 2074 6162 6c65 2064    of the table d
-0003a450: 6174 6120 7468 6174 2061 6363 6573 7369  ata that accessi
-0003a460: 6e67 2060 6074 732e 7461 626c 6573 6060  ng ``ts.tables``
-0003a470: 2063 7572 7265 6e74 6c79 2065 6e74 6169   currently entai
-0003a480: 6c73 292e 0a20 2020 2020 2020 2022 2222  ls)..        """
-0003a490: 0a20 2020 2020 2020 2072 6574 7572 6e20  .        return 
-0003a4a0: 7365 6c66 2e5f 6d75 7461 7469 6f6e 735f  self._mutations_
-0003a4b0: 7061 7265 6e74 0a0a 2020 2020 4070 726f  parent..    @pro
-0003a4c0: 7065 7274 790a 2020 2020 6465 6620 6d75  perty.    def mu
-0003a4d0: 7461 7469 6f6e 735f 7469 6d65 2873 656c  tations_time(sel
-0003a4e0: 6629 3a0a 2020 2020 2020 2020 2222 220a  f):.        """.
-0003a4f0: 2020 2020 2020 2020 4566 6669 6369 656e          Efficien
-0003a500: 7420 6163 6365 7373 2074 6f20 7468 6520  t access to the 
-0003a510: 6060 7469 6d65 6060 2063 6f6c 756d 6e20  ``time`` column 
-0003a520: 696e 2074 6865 0a20 2020 2020 2020 203a  in the.        :
-0003a530: 7265 663a 6073 6563 5f6d 7574 6174 696f  ref:`sec_mutatio
-0003a540: 6e5f 7461 626c 655f 6465 6669 6e69 7469  n_table_definiti
-0003a550: 6f6e 6020 6173 2061 206e 756d 7079 2061  on` as a numpy a
-0003a560: 7272 6179 2028 6474 7970 653d 6e70 2e66  rray (dtype=np.f
-0003a570: 6c6f 6174 3634 292e 0a20 2020 2020 2020  loat64)..       
-0003a580: 2045 7175 6976 616c 656e 7420 746f 2060   Equivalent to `
-0003a590: 6074 732e 7461 626c 6573 2e6d 7574 6174  `ts.tables.mutat
-0003a5a0: 696f 6e73 2e74 696d 6560 6020 2862 7574  ions.time`` (but
-0003a5b0: 2061 766f 6964 696e 6720 7468 6520 6675   avoiding the fu
-0003a5c0: 6c6c 2063 6f70 790a 2020 2020 2020 2020  ll copy.        
-0003a5d0: 6f66 2074 6865 2074 6162 6c65 2064 6174  of the table dat
-0003a5e0: 6120 7468 6174 2061 6363 6573 7369 6e67  a that accessing
-0003a5f0: 2060 6074 732e 7461 626c 6573 6060 2063   ``ts.tables`` c
-0003a600: 7572 7265 6e74 6c79 2065 6e74 6169 6c73  urrently entails
-0003a610: 292e 0a20 2020 2020 2020 2022 2222 0a20  )..        """. 
-0003a620: 2020 2020 2020 2072 6574 7572 6e20 7365         return se
-0003a630: 6c66 2e5f 6d75 7461 7469 6f6e 735f 7469  lf._mutations_ti
-0003a640: 6d65 0a0a 2020 2020 4070 726f 7065 7274  me..    @propert
-0003a650: 790a 2020 2020 6465 6620 6d69 6772 6174  y.    def migrat
-0003a660: 696f 6e73 5f6c 6566 7428 7365 6c66 293a  ions_left(self):
-0003a670: 0a20 2020 2020 2020 2022 2222 0a20 2020  .        """.   
-0003a680: 2020 2020 2045 6666 6963 6965 6e74 2061       Efficient a
-0003a690: 6363 6573 7320 746f 2074 6865 2060 606c  ccess to the ``l
-0003a6a0: 6566 7460 6020 636f 6c75 6d6e 2069 6e20  eft`` column in 
-0003a6b0: 7468 650a 2020 2020 2020 2020 3a72 6566  the.        :ref
-0003a6c0: 3a60 7365 635f 6d69 6772 6174 696f 6e5f  :`sec_migration_
-0003a6d0: 7461 626c 655f 6465 6669 6e69 7469 6f6e  table_definition
-0003a6e0: 6020 6173 2061 206e 756d 7079 2061 7272  ` as a numpy arr
-0003a6f0: 6179 2028 6474 7970 653d 6e70 2e66 6c6f  ay (dtype=np.flo
-0003a700: 6174 3634 292e 0a20 2020 2020 2020 2045  at64)..        E
-0003a710: 7175 6976 616c 656e 7420 746f 2060 6074  quivalent to ``t
-0003a720: 732e 7461 626c 6573 2e6d 6967 7261 7469  s.tables.migrati
-0003a730: 6f6e 732e 6c65 6674 6060 2028 6275 7420  ons.left`` (but 
-0003a740: 6176 6f69 6469 6e67 2074 6865 2066 756c  avoiding the ful
-0003a750: 6c20 636f 7079 0a20 2020 2020 2020 206f  l copy.        o
-0003a760: 6620 7468 6520 7461 626c 6520 6461 7461  f the table data
-0003a770: 2074 6861 7420 6163 6365 7373 696e 6720   that accessing 
-0003a780: 6060 7473 2e74 6162 6c65 7360 6020 6375  ``ts.tables`` cu
-0003a790: 7272 656e 746c 7920 656e 7461 696c 7329  rrently entails)
-0003a7a0: 2e0a 2020 2020 2020 2020 2222 220a 2020  ..        """.  
-0003a7b0: 2020 2020 2020 7265 7475 726e 2073 656c        return sel
-0003a7c0: 662e 5f6d 6967 7261 7469 6f6e 735f 6c65  f._migrations_le
-0003a7d0: 6674 0a0a 2020 2020 4070 726f 7065 7274  ft..    @propert
-0003a7e0: 790a 2020 2020 6465 6620 6d69 6772 6174  y.    def migrat
-0003a7f0: 696f 6e73 5f72 6967 6874 2873 656c 6629  ions_right(self)
-0003a800: 3a0a 2020 2020 2020 2020 2222 220a 2020  :.        """.  
-0003a810: 2020 2020 2020 4566 6669 6369 656e 7420        Efficient 
-0003a820: 6163 6365 7373 2074 6f20 7468 6520 6060  access to the ``
-0003a830: 7269 6768 7460 6020 636f 6c75 6d6e 2069  right`` column i
-0003a840: 6e20 7468 650a 2020 2020 2020 2020 3a72  n the.        :r
-0003a850: 6566 3a60 7365 635f 6d69 6772 6174 696f  ef:`sec_migratio
-0003a860: 6e5f 7461 626c 655f 6465 6669 6e69 7469  n_table_definiti
-0003a870: 6f6e 6020 6173 2061 206e 756d 7079 2061  on` as a numpy a
-0003a880: 7272 6179 2028 6474 7970 653d 6e70 2e66  rray (dtype=np.f
-0003a890: 6c6f 6174 3634 292e 0a20 2020 2020 2020  loat64)..       
-0003a8a0: 2045 7175 6976 616c 656e 7420 746f 2060   Equivalent to `
-0003a8b0: 6074 732e 7461 626c 6573 2e6d 6967 7261  `ts.tables.migra
-0003a8c0: 7469 6f6e 732e 7269 6768 7460 6020 2862  tions.right`` (b
-0003a8d0: 7574 2061 766f 6964 696e 6720 7468 6520  ut avoiding the 
-0003a8e0: 6675 6c6c 2063 6f70 790a 2020 2020 2020  full copy.      
-0003a8f0: 2020 6f66 2074 6865 2074 6162 6c65 2064    of the table d
-0003a900: 6174 6120 7468 6174 2061 6363 6573 7369  ata that accessi
-0003a910: 6e67 2060 6074 732e 7461 626c 6573 6060  ng ``ts.tables``
-0003a920: 2063 7572 7265 6e74 6c79 2065 6e74 6169   currently entai
-0003a930: 6c73 292e 0a20 2020 2020 2020 2022 2222  ls)..        """
-0003a940: 0a20 2020 2020 2020 2072 6574 7572 6e20  .        return 
-0003a950: 7365 6c66 2e5f 6d69 6772 6174 696f 6e73  self._migrations
-0003a960: 5f72 6967 6874 0a0a 2020 2020 4070 726f  _right..    @pro
-0003a970: 7065 7274 790a 2020 2020 6465 6620 6d69  perty.    def mi
-0003a980: 6772 6174 696f 6e73 5f6e 6f64 6528 7365  grations_node(se
-0003a990: 6c66 293a 0a20 2020 2020 2020 2022 2222  lf):.        """
-0003a9a0: 0a20 2020 2020 2020 2045 6666 6963 6965  .        Efficie
-0003a9b0: 6e74 2061 6363 6573 7320 746f 2074 6865  nt access to the
-0003a9c0: 2060 606e 6f64 6560 6020 636f 6c75 6d6e   ``node`` column
-0003a9d0: 2069 6e20 7468 650a 2020 2020 2020 2020   in the.        
-0003a9e0: 3a72 6566 3a60 7365 635f 6d69 6772 6174  :ref:`sec_migrat
-0003a9f0: 696f 6e5f 7461 626c 655f 6465 6669 6e69  ion_table_defini
-0003aa00: 7469 6f6e 6020 6173 2061 206e 756d 7079  tion` as a numpy
-0003aa10: 2061 7272 6179 2028 6474 7970 653d 6e70   array (dtype=np
-0003aa20: 2e69 6e74 3332 292e 0a20 2020 2020 2020  .int32)..       
-0003aa30: 2045 7175 6976 616c 656e 7420 746f 2060   Equivalent to `
-0003aa40: 6074 732e 7461 626c 6573 2e6d 6967 7261  `ts.tables.migra
-0003aa50: 7469 6f6e 732e 6e6f 6465 6060 2028 6275  tions.node`` (bu
-0003aa60: 7420 6176 6f69 6469 6e67 2074 6865 2066  t avoiding the f
-0003aa70: 756c 6c20 636f 7079 0a20 2020 2020 2020  ull copy.       
-0003aa80: 206f 6620 7468 6520 7461 626c 6520 6461   of the table da
-0003aa90: 7461 2074 6861 7420 6163 6365 7373 696e  ta that accessin
-0003aaa0: 6720 6060 7473 2e74 6162 6c65 7360 6020  g ``ts.tables`` 
-0003aab0: 6375 7272 656e 746c 7920 656e 7461 696c  currently entail
-0003aac0: 7329 2e0a 2020 2020 2020 2020 2222 220a  s)..        """.
-0003aad0: 2020 2020 2020 2020 7265 7475 726e 2073          return s
-0003aae0: 656c 662e 5f6d 6967 7261 7469 6f6e 735f  elf._migrations_
-0003aaf0: 6e6f 6465 0a0a 2020 2020 4070 726f 7065  node..    @prope
-0003ab00: 7274 790a 2020 2020 6465 6620 6d69 6772  rty.    def migr
-0003ab10: 6174 696f 6e73 5f73 6f75 7263 6528 7365  ations_source(se
-0003ab20: 6c66 293a 0a20 2020 2020 2020 2022 2222  lf):.        """
-0003ab30: 0a20 2020 2020 2020 2045 6666 6963 6965  .        Efficie
-0003ab40: 6e74 2061 6363 6573 7320 746f 2074 6865  nt access to the
-0003ab50: 2060 6073 6f75 7263 6560 6020 636f 6c75   ``source`` colu
-0003ab60: 6d6e 2069 6e20 7468 650a 2020 2020 2020  mn in the.      
-0003ab70: 2020 3a72 6566 3a60 7365 635f 6d69 6772    :ref:`sec_migr
-0003ab80: 6174 696f 6e5f 7461 626c 655f 6465 6669  ation_table_defi
-0003ab90: 6e69 7469 6f6e 6020 6173 2061 206e 756d  nition` as a num
-0003aba0: 7079 2061 7272 6179 2028 6474 7970 653d  py array (dtype=
-0003abb0: 6e70 2e69 6e74 3332 292e 0a20 2020 2020  np.int32)..     
-0003abc0: 2020 2045 7175 6976 616c 656e 7420 746f     Equivalent to
-0003abd0: 2060 6074 732e 7461 626c 6573 2e6d 6967   ``ts.tables.mig
-0003abe0: 7261 7469 6f6e 732e 736f 7572 6365 6060  rations.source``
-0003abf0: 2028 6275 7420 6176 6f69 6469 6e67 2074   (but avoiding t
-0003ac00: 6865 2066 756c 6c20 636f 7079 0a20 2020  he full copy.   
-0003ac10: 2020 2020 206f 6620 7468 6520 7461 626c       of the tabl
-0003ac20: 6520 6461 7461 2074 6861 7420 6163 6365  e data that acce
-0003ac30: 7373 696e 6720 6060 7473 2e74 6162 6c65  ssing ``ts.table
-0003ac40: 7360 6020 6375 7272 656e 746c 7920 656e  s`` currently en
-0003ac50: 7461 696c 7329 2e0a 2020 2020 2020 2020  tails)..        
-0003ac60: 2222 220a 2020 2020 2020 2020 7265 7475  """.        retu
-0003ac70: 726e 2073 656c 662e 5f6d 6967 7261 7469  rn self._migrati
-0003ac80: 6f6e 735f 736f 7572 6365 0a0a 2020 2020  ons_source..    
-0003ac90: 4070 726f 7065 7274 790a 2020 2020 6465  @property.    de
-0003aca0: 6620 6d69 6772 6174 696f 6e73 5f64 6573  f migrations_des
-0003acb0: 7428 7365 6c66 293a 0a20 2020 2020 2020  t(self):.       
-0003acc0: 2022 2222 0a20 2020 2020 2020 2045 6666   """.        Eff
-0003acd0: 6963 6965 6e74 2061 6363 6573 7320 746f  icient access to
-0003ace0: 2074 6865 2060 6064 6573 7460 6020 636f   the ``dest`` co
-0003acf0: 6c75 6d6e 2069 6e20 7468 650a 2020 2020  lumn in the.    
-0003ad00: 2020 2020 3a72 6566 3a60 7365 635f 6d69      :ref:`sec_mi
-0003ad10: 6772 6174 696f 6e5f 7461 626c 655f 6465  gration_table_de
-0003ad20: 6669 6e69 7469 6f6e 6020 6173 2061 206e  finition` as a n
-0003ad30: 756d 7079 2061 7272 6179 2028 6474 7970  umpy array (dtyp
-0003ad40: 653d 6e70 2e69 6e74 3332 292e 0a20 2020  e=np.int32)..   
-0003ad50: 2020 2020 2045 7175 6976 616c 656e 7420       Equivalent 
-0003ad60: 746f 2060 6074 732e 7461 626c 6573 2e6d  to ``ts.tables.m
-0003ad70: 6967 7261 7469 6f6e 732e 6465 7374 6060  igrations.dest``
-0003ad80: 2028 6275 7420 6176 6f69 6469 6e67 2074   (but avoiding t
-0003ad90: 6865 2066 756c 6c20 636f 7079 0a20 2020  he full copy.   
-0003ada0: 2020 2020 206f 6620 7468 6520 7461 626c       of the tabl
-0003adb0: 6520 6461 7461 2074 6861 7420 6163 6365  e data that acce
-0003adc0: 7373 696e 6720 6060 7473 2e74 6162 6c65  ssing ``ts.table
-0003add0: 7360 6020 6375 7272 656e 746c 7920 656e  s`` currently en
-0003ade0: 7461 696c 7329 2e0a 2020 2020 2020 2020  tails)..        
-0003adf0: 2222 220a 2020 2020 2020 2020 7265 7475  """.        retu
-0003ae00: 726e 2073 656c 662e 5f6d 6967 7261 7469  rn self._migrati
-0003ae10: 6f6e 735f 6465 7374 0a0a 2020 2020 4070  ons_dest..    @p
-0003ae20: 726f 7065 7274 790a 2020 2020 6465 6620  roperty.    def 
-0003ae30: 6d69 6772 6174 696f 6e73 5f74 696d 6528  migrations_time(
-0003ae40: 7365 6c66 293a 0a20 2020 2020 2020 2022  self):.        "
-0003ae50: 2222 0a20 2020 2020 2020 2045 6666 6963  "".        Effic
-0003ae60: 6965 6e74 2061 6363 6573 7320 746f 2074  ient access to t
-0003ae70: 6865 2060 6074 696d 6560 6020 636f 6c75  he ``time`` colu
-0003ae80: 6d6e 2069 6e20 7468 650a 2020 2020 2020  mn in the.      
-0003ae90: 2020 3a72 6566 3a60 7365 635f 6d69 6772    :ref:`sec_migr
-0003aea0: 6174 696f 6e5f 7461 626c 655f 6465 6669  ation_table_defi
-0003aeb0: 6e69 7469 6f6e 6020 6173 2061 206e 756d  nition` as a num
-0003aec0: 7079 2061 7272 6179 2028 6474 7970 653d  py array (dtype=
-0003aed0: 6e70 2e66 6c6f 6174 3634 292e 0a20 2020  np.float64)..   
-0003aee0: 2020 2020 2045 7175 6976 616c 656e 7420       Equivalent 
-0003aef0: 746f 2060 6074 732e 7461 626c 6573 2e6d  to ``ts.tables.m
-0003af00: 6967 7261 7469 6f6e 732e 7469 6d65 6060  igrations.time``
-0003af10: 2028 6275 7420 6176 6f69 6469 6e67 2074   (but avoiding t
-0003af20: 6865 2066 756c 6c20 636f 7079 0a20 2020  he full copy.   
-0003af30: 2020 2020 206f 6620 7468 6520 7461 626c       of the tabl
-0003af40: 6520 6461 7461 2074 6861 7420 6163 6365  e data that acce
-0003af50: 7373 696e 6720 6060 7473 2e74 6162 6c65  ssing ``ts.table
-0003af60: 7360 6020 6375 7272 656e 746c 7920 656e  s`` currently en
-0003af70: 7461 696c 7329 2e0a 2020 2020 2020 2020  tails)..        
-0003af80: 2222 220a 2020 2020 2020 2020 7265 7475  """.        retu
-0003af90: 726e 2073 656c 662e 5f6d 6967 7261 7469  rn self._migrati
-0003afa0: 6f6e 735f 7469 6d65 0a0a 2020 2020 4070  ons_time..    @p
-0003afb0: 726f 7065 7274 790a 2020 2020 6465 6620  roperty.    def 
-0003afc0: 696e 6465 7865 735f 6564 6765 5f69 6e73  indexes_edge_ins
-0003afd0: 6572 7469 6f6e 5f6f 7264 6572 2873 656c  ertion_order(sel
-0003afe0: 6629 3a0a 2020 2020 2020 2020 2222 220a  f):.        """.
-0003aff0: 2020 2020 2020 2020 4566 6669 6369 656e          Efficien
-0003b000: 7420 6163 6365 7373 2074 6f20 7468 6520  t access to the 
-0003b010: 6060 6564 6765 5f69 6e73 6572 7469 6f6e  ``edge_insertion
-0003b020: 5f6f 7264 6572 6060 2063 6f6c 756d 6e20  _order`` column 
-0003b030: 696e 2074 6865 0a20 2020 2020 2020 203a  in the.        :
-0003b040: 7265 663a 6073 6563 5f74 6162 6c65 5f69  ref:`sec_table_i
-0003b050: 6e64 6578 6573 6020 6173 2061 206e 756d  ndexes` as a num
-0003b060: 7079 2061 7272 6179 2028 6474 7970 653d  py array (dtype=
-0003b070: 6e70 2e69 6e74 3332 292e 0a20 2020 2020  np.int32)..     
-0003b080: 2020 2045 7175 6976 616c 656e 7420 746f     Equivalent to
-0003b090: 2060 6074 732e 7461 626c 6573 2e69 6e64   ``ts.tables.ind
-0003b0a0: 6578 6573 2e65 6467 655f 696e 7365 7274  exes.edge_insert
-0003b0b0: 696f 6e5f 6f72 6465 7260 6020 2862 7574  ion_order`` (but
-0003b0c0: 2061 766f 6964 696e 670a 2020 2020 2020   avoiding.      
-0003b0d0: 2020 7468 6520 6675 6c6c 2063 6f70 7920    the full copy 
-0003b0e0: 6f66 2074 6865 2074 6162 6c65 2064 6174  of the table dat
-0003b0f0: 6120 7468 6174 2061 6363 6573 7369 6e67  a that accessing
-0003b100: 2060 6074 732e 7461 626c 6573 6060 0a20   ``ts.tables``. 
-0003b110: 2020 2020 2020 2063 7572 7265 6e74 6c79         currently
-0003b120: 2065 6e74 6169 6c73 292e 0a20 2020 2020   entails)..     
-0003b130: 2020 2022 2222 0a20 2020 2020 2020 2072     """.        r
-0003b140: 6574 7572 6e20 7365 6c66 2e5f 696e 6465  eturn self._inde
-0003b150: 7865 735f 6564 6765 5f69 6e73 6572 7469  xes_edge_inserti
-0003b160: 6f6e 5f6f 7264 6572 0a0a 2020 2020 4070  on_order..    @p
-0003b170: 726f 7065 7274 790a 2020 2020 6465 6620  roperty.    def 
-0003b180: 696e 6465 7865 735f 6564 6765 5f72 656d  indexes_edge_rem
-0003b190: 6f76 616c 5f6f 7264 6572 2873 656c 6629  oval_order(self)
-0003b1a0: 3a0a 2020 2020 2020 2020 2222 220a 2020  :.        """.  
-0003b1b0: 2020 2020 2020 4566 6669 6369 656e 7420        Efficient 
-0003b1c0: 6163 6365 7373 2074 6f20 7468 6520 6060  access to the ``
-0003b1d0: 6564 6765 5f72 656d 6f76 616c 5f6f 7264  edge_removal_ord
-0003b1e0: 6572 6060 2063 6f6c 756d 6e20 696e 2074  er`` column in t
-0003b1f0: 6865 0a20 2020 2020 2020 203a 7265 663a  he.        :ref:
-0003b200: 6073 6563 5f74 6162 6c65 5f69 6e64 6578  `sec_table_index
-0003b210: 6573 6020 6173 2061 206e 756d 7079 2061  es` as a numpy a
-0003b220: 7272 6179 2028 6474 7970 653d 6e70 2e69  rray (dtype=np.i
-0003b230: 6e74 3332 292e 0a20 2020 2020 2020 2045  nt32)..        E
-0003b240: 7175 6976 616c 656e 7420 746f 2060 6074  quivalent to ``t
-0003b250: 732e 7461 626c 6573 2e69 6e64 6578 6573  s.tables.indexes
-0003b260: 2e65 6467 655f 7265 6d6f 7661 6c5f 6f72  .edge_removal_or
-0003b270: 6465 7260 6020 2862 7574 2061 766f 6964  der`` (but avoid
-0003b280: 696e 670a 2020 2020 2020 2020 7468 6520  ing.        the 
-0003b290: 6675 6c6c 2063 6f70 7920 6f66 2074 6865  full copy of the
-0003b2a0: 2074 6162 6c65 2064 6174 6120 7468 6174   table data that
-0003b2b0: 2061 6363 6573 7369 6e67 2060 6074 732e   accessing ``ts.
-0003b2c0: 7461 626c 6573 6060 0a20 2020 2020 2020  tables``.       
-0003b2d0: 2063 7572 7265 6e74 6c79 2065 6e74 6169   currently entai
-0003b2e0: 6c73 292e 0a20 2020 2020 2020 2022 2222  ls)..        """
-0003b2f0: 0a20 2020 2020 2020 2072 6574 7572 6e20  .        return 
-0003b300: 7365 6c66 2e5f 696e 6465 7865 735f 6564  self._indexes_ed
-0003b310: 6765 5f72 656d 6f76 616c 5f6f 7264 6572  ge_removal_order
-0003b320: 0a0a 2020 2020 6465 6620 696e 6469 7669  ..    def indivi
-0003b330: 6475 616c 2873 656c 662c 2069 645f 293a  dual(self, id_):
-0003b340: 0a20 2020 2020 2020 2022 2222 0a20 2020  .        """.   
-0003b350: 2020 2020 2052 6574 7572 6e73 2074 6865       Returns the
-0003b360: 203a 7265 663a 6069 6e64 6976 6964 7561   :ref:`individua
-0003b370: 6c20 3c73 6563 5f69 6e64 6976 6964 7561  l <sec_individua
-0003b380: 6c5f 7461 626c 655f 6465 6669 6e69 7469  l_table_definiti
-0003b390: 6f6e 3e60 0a20 2020 2020 2020 2069 6e20  on>`.        in 
-0003b3a0: 7468 6973 2074 7265 6520 7365 7175 656e  this tree sequen
-0003b3b0: 6365 2077 6974 6820 7468 6520 7370 6563  ce with the spec
-0003b3c0: 6966 6965 6420 4944 2e20 2041 7320 7769  ified ID.  As wi
-0003b3d0: 7468 2070 7974 686f 6e20 6c69 7374 732c  th python lists,
-0003b3e0: 206e 6567 6174 6976 650a 2020 2020 2020   negative.      
-0003b3f0: 2020 4944 7320 6361 6e20 6265 2075 7365    IDs can be use
-0003b400: 6420 746f 2069 6e64 6578 2062 6163 6b77  d to index backw
-0003b410: 6172 6473 2066 726f 6d20 7468 6520 6c61  ards from the la
-0003b420: 7374 2069 6e64 6976 6964 7561 6c2e 0a0a  st individual...
-0003b430: 2020 2020 2020 2020 3a72 7479 7065 3a20          :rtype: 
-0003b440: 3a63 6c61 7373 3a60 496e 6469 7669 6475  :class:`Individu
-0003b450: 616c 600a 2020 2020 2020 2020 2222 220a  al`.        """.
-0003b460: 2020 2020 2020 2020 6964 5f20 3d20 7365          id_ = se
-0003b470: 6c66 2e63 6865 636b 5f69 6e64 6578 2869  lf.check_index(i
-0003b480: 645f 2c20 7365 6c66 2e6e 756d 5f69 6e64  d_, self.num_ind
-0003b490: 6976 6964 7561 6c73 290a 2020 2020 2020  ividuals).      
-0003b4a0: 2020 280a 2020 2020 2020 2020 2020 2020    (.            
-0003b4b0: 666c 6167 732c 0a20 2020 2020 2020 2020  flags,.         
-0003b4c0: 2020 206c 6f63 6174 696f 6e2c 0a20 2020     location,.   
-0003b4d0: 2020 2020 2020 2020 2070 6172 656e 7473           parents
-0003b4e0: 2c0a 2020 2020 2020 2020 2020 2020 6d65  ,.            me
-0003b4f0: 7461 6461 7461 2c0a 2020 2020 2020 2020  tadata,.        
-0003b500: 2020 2020 6e6f 6465 732c 0a20 2020 2020      nodes,.     
-0003b510: 2020 2029 203d 2073 656c 662e 5f6c 6c5f     ) = self._ll_
-0003b520: 7472 6565 5f73 6571 7565 6e63 652e 6765  tree_sequence.ge
-0003b530: 745f 696e 6469 7669 6475 616c 2869 645f  t_individual(id_
-0003b540: 290a 2020 2020 2020 2020 696e 6420 3d20  ).        ind = 
-0003b550: 496e 6469 7669 6475 616c 280a 2020 2020  Individual(.    
-0003b560: 2020 2020 2020 2020 6964 3d69 645f 2c0a          id=id_,.
-0003b570: 2020 2020 2020 2020 2020 2020 666c 6167              flag
-0003b580: 733d 666c 6167 732c 0a20 2020 2020 2020  s=flags,.       
-0003b590: 2020 2020 206c 6f63 6174 696f 6e3d 6c6f       location=lo
-0003b5a0: 6361 7469 6f6e 2c0a 2020 2020 2020 2020  cation,.        
-0003b5b0: 2020 2020 7061 7265 6e74 733d 7061 7265      parents=pare
-0003b5c0: 6e74 732c 0a20 2020 2020 2020 2020 2020  nts,.           
-0003b5d0: 206d 6574 6164 6174 613d 6d65 7461 6461   metadata=metada
-0003b5e0: 7461 2c0a 2020 2020 2020 2020 2020 2020  ta,.            
-0003b5f0: 6e6f 6465 733d 6e6f 6465 732c 0a20 2020  nodes=nodes,.   
-0003b600: 2020 2020 2020 2020 206d 6574 6164 6174           metadat
-0003b610: 615f 6465 636f 6465 723d 7365 6c66 2e74  a_decoder=self.t
-0003b620: 6162 6c65 5f6d 6574 6164 6174 615f 7363  able_metadata_sc
-0003b630: 6865 6d61 732e 696e 6469 7669 6475 616c  hemas.individual
-0003b640: 2e64 6563 6f64 655f 726f 772c 0a20 2020  .decode_row,.   
-0003b650: 2020 2020 2020 2020 2074 7265 655f 7365           tree_se
-0003b660: 7175 656e 6365 3d73 656c 662c 0a20 2020  quence=self,.   
-0003b670: 2020 2020 2029 0a20 2020 2020 2020 2072       ).        r
-0003b680: 6574 7572 6e20 696e 640a 0a20 2020 2064  eturn ind..    d
-0003b690: 6566 206e 6f64 6528 7365 6c66 2c20 6964  ef node(self, id
-0003b6a0: 5f29 3a0a 2020 2020 2020 2020 2222 220a  _):.        """.
-0003b6b0: 2020 2020 2020 2020 5265 7475 726e 7320          Returns 
-0003b6c0: 7468 6520 3a72 6566 3a60 6e6f 6465 203c  the :ref:`node <
-0003b6d0: 7365 635f 6e6f 6465 5f74 6162 6c65 5f64  sec_node_table_d
-0003b6e0: 6566 696e 6974 696f 6e3e 6020 696e 2074  efinition>` in t
-0003b6f0: 6869 7320 7472 6565 2073 6571 7565 6e63  his tree sequenc
-0003b700: 650a 2020 2020 2020 2020 7769 7468 2074  e.        with t
-0003b710: 6865 2073 7065 6369 6669 6564 2049 442e  he specified ID.
-0003b720: 2041 7320 7769 7468 2070 7974 686f 6e20   As with python 
-0003b730: 6c69 7374 732c 206e 6567 6174 6976 6520  lists, negative 
-0003b740: 4944 7320 6361 6e20 6265 2075 7365 6420  IDs can be used 
-0003b750: 746f 0a20 2020 2020 2020 2069 6e64 6578  to.        index
-0003b760: 2062 6163 6b77 6172 6473 2066 726f 6d20   backwards from 
-0003b770: 7468 6520 6c61 7374 206e 6f64 652e 0a0a  the last node...
-0003b780: 2020 2020 2020 2020 3a72 7479 7065 3a20          :rtype: 
-0003b790: 3a63 6c61 7373 3a60 4e6f 6465 600a 2020  :class:`Node`.  
-0003b7a0: 2020 2020 2020 2222 220a 2020 2020 2020        """.      
-0003b7b0: 2020 6964 5f20 3d20 7365 6c66 2e63 6865    id_ = self.che
-0003b7c0: 636b 5f69 6e64 6578 2869 645f 2c20 7365  ck_index(id_, se
-0003b7d0: 6c66 2e6e 756d 5f6e 6f64 6573 290a 2020  lf.num_nodes).  
-0003b7e0: 2020 2020 2020 280a 2020 2020 2020 2020        (.        
-0003b7f0: 2020 2020 666c 6167 732c 0a20 2020 2020      flags,.     
-0003b800: 2020 2020 2020 2074 696d 652c 0a20 2020         time,.   
-0003b810: 2020 2020 2020 2020 2070 6f70 756c 6174           populat
-0003b820: 696f 6e2c 0a20 2020 2020 2020 2020 2020  ion,.           
-0003b830: 2069 6e64 6976 6964 7561 6c2c 0a20 2020   individual,.   
-0003b840: 2020 2020 2020 2020 206d 6574 6164 6174           metadat
-0003b850: 612c 0a20 2020 2020 2020 2029 203d 2073  a,.        ) = s
-0003b860: 656c 662e 5f6c 6c5f 7472 6565 5f73 6571  elf._ll_tree_seq
-0003b870: 7565 6e63 652e 6765 745f 6e6f 6465 2869  uence.get_node(i
-0003b880: 645f 290a 2020 2020 2020 2020 7265 7475  d_).        retu
-0003b890: 726e 204e 6f64 6528 0a20 2020 2020 2020  rn Node(.       
-0003b8a0: 2020 2020 2069 643d 6964 5f2c 0a20 2020       id=id_,.   
-0003b8b0: 2020 2020 2020 2020 2066 6c61 6773 3d66           flags=f
-0003b8c0: 6c61 6773 2c0a 2020 2020 2020 2020 2020  lags,.          
-0003b8d0: 2020 7469 6d65 3d74 696d 652c 0a20 2020    time=time,.   
-0003b8e0: 2020 2020 2020 2020 2070 6f70 756c 6174           populat
-0003b8f0: 696f 6e3d 706f 7075 6c61 7469 6f6e 2c0a  ion=population,.
-0003b900: 2020 2020 2020 2020 2020 2020 696e 6469              indi
-0003b910: 7669 6475 616c 3d69 6e64 6976 6964 7561  vidual=individua
-0003b920: 6c2c 0a20 2020 2020 2020 2020 2020 206d  l,.            m
-0003b930: 6574 6164 6174 613d 6d65 7461 6461 7461  etadata=metadata
-0003b940: 2c0a 2020 2020 2020 2020 2020 2020 6d65  ,.            me
-0003b950: 7461 6461 7461 5f64 6563 6f64 6572 3d73  tadata_decoder=s
-0003b960: 656c 662e 7461 626c 655f 6d65 7461 6461  elf.table_metada
-0003b970: 7461 5f73 6368 656d 6173 2e6e 6f64 652e  ta_schemas.node.
-0003b980: 6465 636f 6465 5f72 6f77 2c0a 2020 2020  decode_row,.    
-0003b990: 2020 2020 290a 0a20 2020 2040 7374 6174      )..    @stat
-0003b9a0: 6963 6d65 7468 6f64 0a20 2020 2064 6566  icmethod.    def
-0003b9b0: 2063 6865 636b 5f69 6e64 6578 2869 6e64   check_index(ind
-0003b9c0: 6578 2c20 6c65 6e67 7468 293a 0a20 2020  ex, length):.   
-0003b9d0: 2020 2020 2069 6620 6e6f 7420 6973 696e       if not isin
-0003b9e0: 7374 616e 6365 2869 6e64 6578 2c20 6e75  stance(index, nu
-0003b9f0: 6d62 6572 732e 496e 7465 6772 616c 293a  mbers.Integral):
-0003ba00: 0a20 2020 2020 2020 2020 2020 2072 6169  .            rai
-0003ba10: 7365 2054 7970 6545 7272 6f72 280a 2020  se TypeError(.  
-0003ba20: 2020 2020 2020 2020 2020 2020 2020 6622                f"
-0003ba30: 496e 6465 7820 6d75 7374 2062 6520 6f66  Index must be of
-0003ba40: 2069 6e74 6567 6572 2074 7970 652c 206e   integer type, n
-0003ba50: 6f74 2027 7b74 7970 6528 696e 6465 7829  ot '{type(index)
-0003ba60: 2e5f 5f6e 616d 655f 5f7d 2722 0a20 2020  .__name__}'".   
-0003ba70: 2020 2020 2020 2020 2029 0a20 2020 2020           ).     
-0003ba80: 2020 2069 6620 696e 6465 7820 3c20 303a     if index < 0:
-0003ba90: 0a20 2020 2020 2020 2020 2020 2069 6e64  .            ind
-0003baa0: 6578 202b 3d20 6c65 6e67 7468 0a20 2020  ex += length.   
-0003bab0: 2020 2020 2069 6620 696e 6465 7820 3c20       if index < 
-0003bac0: 3020 6f72 2069 6e64 6578 203e 3d20 6c65  0 or index >= le
-0003bad0: 6e67 7468 3a0a 2020 2020 2020 2020 2020  ngth:.          
-0003bae0: 2020 7261 6973 6520 496e 6465 7845 7272    raise IndexErr
-0003baf0: 6f72 2822 496e 6465 7820 6f75 7420 6f66  or("Index out of
-0003bb00: 2062 6f75 6e64 7322 290a 2020 2020 2020   bounds").      
-0003bb10: 2020 7265 7475 726e 2069 6e64 6578 0a0a    return index..
-0003bb20: 2020 2020 6465 6620 6564 6765 2873 656c      def edge(sel
-0003bb30: 662c 2069 645f 293a 0a20 2020 2020 2020  f, id_):.       
-0003bb40: 2022 2222 0a20 2020 2020 2020 2052 6574   """.        Ret
-0003bb50: 7572 6e73 2074 6865 203a 7265 663a 6065  urns the :ref:`e
-0003bb60: 6467 6520 3c73 6563 5f65 6467 655f 7461  dge <sec_edge_ta
-0003bb70: 626c 655f 6465 6669 6e69 7469 6f6e 3e60  ble_definition>`
-0003bb80: 2069 6e20 7468 6973 2074 7265 6520 7365   in this tree se
-0003bb90: 7175 656e 6365 0a20 2020 2020 2020 2077  quence.        w
-0003bba0: 6974 6820 7468 6520 7370 6563 6966 6965  ith the specifie
-0003bbb0: 6420 4944 2e20 4173 2077 6974 6820 7079  d ID. As with py
-0003bbc0: 7468 6f6e 206c 6973 7473 2c20 6e65 6761  thon lists, nega
-0003bbd0: 7469 7665 2049 4473 2063 616e 2062 6520  tive IDs can be 
-0003bbe0: 7573 6564 2074 6f0a 2020 2020 2020 2020  used to.        
-0003bbf0: 696e 6465 7820 6261 636b 7761 7264 7320  index backwards 
-0003bc00: 6672 6f6d 2074 6865 206c 6173 7420 6564  from the last ed
-0003bc10: 6765 2e0a 0a20 2020 2020 2020 203a 7274  ge...        :rt
-0003bc20: 7970 653a 203a 636c 6173 733a 6045 6467  ype: :class:`Edg
-0003bc30: 6560 0a20 2020 2020 2020 2022 2222 0a20  e`.        """. 
-0003bc40: 2020 2020 2020 2069 645f 203d 2073 656c         id_ = sel
-0003bc50: 662e 6368 6563 6b5f 696e 6465 7828 6964  f.check_index(id
-0003bc60: 5f2c 2073 656c 662e 6e75 6d5f 6564 6765  _, self.num_edge
-0003bc70: 7329 0a20 2020 2020 2020 206c 6566 742c  s).        left,
-0003bc80: 2072 6967 6874 2c20 7061 7265 6e74 2c20   right, parent, 
-0003bc90: 6368 696c 642c 206d 6574 6164 6174 6120  child, metadata 
-0003bca0: 3d20 7365 6c66 2e5f 6c6c 5f74 7265 655f  = self._ll_tree_
-0003bcb0: 7365 7175 656e 6365 2e67 6574 5f65 6467  sequence.get_edg
-0003bcc0: 6528 6964 5f29 0a20 2020 2020 2020 2072  e(id_).        r
-0003bcd0: 6574 7572 6e20 4564 6765 280a 2020 2020  eturn Edge(.    
-0003bce0: 2020 2020 2020 2020 6964 3d69 645f 2c0a          id=id_,.
-0003bcf0: 2020 2020 2020 2020 2020 2020 6c65 6674              left
-0003bd00: 3d6c 6566 742c 0a20 2020 2020 2020 2020  =left,.         
-0003bd10: 2020 2072 6967 6874 3d72 6967 6874 2c0a     right=right,.
-0003bd20: 2020 2020 2020 2020 2020 2020 7061 7265              pare
-0003bd30: 6e74 3d70 6172 656e 742c 0a20 2020 2020  nt=parent,.     
-0003bd40: 2020 2020 2020 2063 6869 6c64 3d63 6869         child=chi
-0003bd50: 6c64 2c0a 2020 2020 2020 2020 2020 2020  ld,.            
-0003bd60: 6d65 7461 6461 7461 3d6d 6574 6164 6174  metadata=metadat
-0003bd70: 612c 0a20 2020 2020 2020 2020 2020 206d  a,.            m
-0003bd80: 6574 6164 6174 615f 6465 636f 6465 723d  etadata_decoder=
-0003bd90: 7365 6c66 2e74 6162 6c65 5f6d 6574 6164  self.table_metad
-0003bda0: 6174 615f 7363 6865 6d61 732e 6564 6765  ata_schemas.edge
-0003bdb0: 2e64 6563 6f64 655f 726f 772c 0a20 2020  .decode_row,.   
-0003bdc0: 2020 2020 2029 0a0a 2020 2020 6465 6620       )..    def 
-0003bdd0: 6d69 6772 6174 696f 6e28 7365 6c66 2c20  migration(self, 
-0003bde0: 6964 5f29 3a0a 2020 2020 2020 2020 2222  id_):.        ""
-0003bdf0: 220a 2020 2020 2020 2020 5265 7475 726e  ".        Return
-0003be00: 7320 7468 6520 3a72 6566 3a60 6d69 6772  s the :ref:`migr
-0003be10: 6174 696f 6e20 3c73 6563 5f6d 6967 7261  ation <sec_migra
-0003be20: 7469 6f6e 5f74 6162 6c65 5f64 6566 696e  tion_table_defin
-0003be30: 6974 696f 6e3e 6020 696e 2074 6869 7320  ition>` in this 
-0003be40: 7472 6565 0a20 2020 2020 2020 2073 6571  tree.        seq
-0003be50: 7565 6e63 6520 7769 7468 2074 6865 2073  uence with the s
-0003be60: 7065 6369 6669 6564 2049 442e 2041 7320  pecified ID. As 
-0003be70: 7769 7468 2070 7974 686f 6e20 6c69 7374  with python list
-0003be80: 732c 206e 6567 6174 6976 6520 4944 7320  s, negative IDs 
-0003be90: 6361 6e20 6265 0a20 2020 2020 2020 2075  can be.        u
-0003bea0: 7365 6420 746f 2069 6e64 6578 2062 6163  sed to index bac
-0003beb0: 6b77 6172 6473 2066 726f 6d20 7468 6520  kwards from the 
-0003bec0: 6c61 7374 206d 6967 7261 7469 6f6e 2e0a  last migration..
-0003bed0: 0a20 2020 2020 2020 203a 7274 7970 653a  .        :rtype:
-0003bee0: 203a 636c 6173 733a 602e 4d69 6772 6174   :class:`.Migrat
-0003bef0: 696f 6e60 0a20 2020 2020 2020 2022 2222  ion`.        """
-0003bf00: 0a20 2020 2020 2020 2069 645f 203d 2073  .        id_ = s
-0003bf10: 656c 662e 6368 6563 6b5f 696e 6465 7828  elf.check_index(
-0003bf20: 6964 5f2c 2073 656c 662e 6e75 6d5f 6d69  id_, self.num_mi
-0003bf30: 6772 6174 696f 6e73 290a 2020 2020 2020  grations).      
-0003bf40: 2020 280a 2020 2020 2020 2020 2020 2020    (.            
-0003bf50: 6c65 6674 2c0a 2020 2020 2020 2020 2020  left,.          
-0003bf60: 2020 7269 6768 742c 0a20 2020 2020 2020    right,.       
-0003bf70: 2020 2020 206e 6f64 652c 0a20 2020 2020       node,.     
-0003bf80: 2020 2020 2020 2073 6f75 7263 652c 0a20         source,. 
-0003bf90: 2020 2020 2020 2020 2020 2064 6573 742c             dest,
-0003bfa0: 0a20 2020 2020 2020 2020 2020 2074 696d  .            tim
-0003bfb0: 652c 0a20 2020 2020 2020 2020 2020 206d  e,.            m
-0003bfc0: 6574 6164 6174 612c 0a20 2020 2020 2020  etadata,.       
-0003bfd0: 2029 203d 2073 656c 662e 5f6c 6c5f 7472   ) = self._ll_tr
-0003bfe0: 6565 5f73 6571 7565 6e63 652e 6765 745f  ee_sequence.get_
-0003bff0: 6d69 6772 6174 696f 6e28 6964 5f29 0a20  migration(id_). 
-0003c000: 2020 2020 2020 2072 6574 7572 6e20 4d69         return Mi
-0003c010: 6772 6174 696f 6e28 0a20 2020 2020 2020  gration(.       
-0003c020: 2020 2020 2069 643d 6964 5f2c 0a20 2020       id=id_,.   
-0003c030: 2020 2020 2020 2020 206c 6566 743d 6c65           left=le
-0003c040: 6674 2c0a 2020 2020 2020 2020 2020 2020  ft,.            
-0003c050: 7269 6768 743d 7269 6768 742c 0a20 2020  right=right,.   
-0003c060: 2020 2020 2020 2020 206e 6f64 653d 6e6f           node=no
-0003c070: 6465 2c0a 2020 2020 2020 2020 2020 2020  de,.            
-0003c080: 736f 7572 6365 3d73 6f75 7263 652c 0a20  source=source,. 
-0003c090: 2020 2020 2020 2020 2020 2064 6573 743d             dest=
-0003c0a0: 6465 7374 2c0a 2020 2020 2020 2020 2020  dest,.          
-0003c0b0: 2020 7469 6d65 3d74 696d 652c 0a20 2020    time=time,.   
-0003c0c0: 2020 2020 2020 2020 206d 6574 6164 6174           metadat
-0003c0d0: 613d 6d65 7461 6461 7461 2c0a 2020 2020  a=metadata,.    
-0003c0e0: 2020 2020 2020 2020 6d65 7461 6461 7461          metadata
-0003c0f0: 5f64 6563 6f64 6572 3d73 656c 662e 7461  _decoder=self.ta
-0003c100: 626c 655f 6d65 7461 6461 7461 5f73 6368  ble_metadata_sch
-0003c110: 656d 6173 2e6d 6967 7261 7469 6f6e 2e64  emas.migration.d
-0003c120: 6563 6f64 655f 726f 772c 0a20 2020 2020  ecode_row,.     
-0003c130: 2020 2029 0a0a 2020 2020 6465 6620 6d75     )..    def mu
-0003c140: 7461 7469 6f6e 2873 656c 662c 2069 645f  tation(self, id_
-0003c150: 293a 0a20 2020 2020 2020 2022 2222 0a20  ):.        """. 
-0003c160: 2020 2020 2020 2052 6574 7572 6e73 2074         Returns t
-0003c170: 6865 203a 7265 663a 606d 7574 6174 696f  he :ref:`mutatio
-0003c180: 6e20 3c73 6563 5f6d 7574 6174 696f 6e5f  n <sec_mutation_
-0003c190: 7461 626c 655f 6465 6669 6e69 7469 6f6e  table_definition
-0003c1a0: 3e60 2069 6e20 7468 6973 2074 7265 6520  >` in this tree 
-0003c1b0: 7365 7175 656e 6365 0a20 2020 2020 2020  sequence.       
-0003c1c0: 2077 6974 6820 7468 6520 7370 6563 6966   with the specif
-0003c1d0: 6965 6420 4944 2e20 4173 2077 6974 6820  ied ID. As with 
-0003c1e0: 7079 7468 6f6e 206c 6973 7473 2c20 6e65  python lists, ne
-0003c1f0: 6761 7469 7665 2049 4473 2063 616e 2062  gative IDs can b
-0003c200: 6520 7573 6564 2074 6f0a 2020 2020 2020  e used to.      
-0003c210: 2020 696e 6465 7820 6261 636b 7761 7264    index backward
-0003c220: 7320 6672 6f6d 2074 6865 206c 6173 7420  s from the last 
-0003c230: 6d75 7461 7469 6f6e 2e0a 0a20 2020 2020  mutation...     
-0003c240: 2020 203a 7274 7970 653a 203a 636c 6173     :rtype: :clas
-0003c250: 733a 604d 7574 6174 696f 6e60 0a20 2020  s:`Mutation`.   
-0003c260: 2020 2020 2022 2222 0a20 2020 2020 2020       """.       
-0003c270: 2069 645f 203d 2073 656c 662e 6368 6563   id_ = self.chec
-0003c280: 6b5f 696e 6465 7828 6964 5f2c 2073 656c  k_index(id_, sel
-0003c290: 662e 6e75 6d5f 6d75 7461 7469 6f6e 7329  f.num_mutations)
-0003c2a0: 0a20 2020 2020 2020 2028 0a20 2020 2020  .        (.     
-0003c2b0: 2020 2020 2020 2073 6974 652c 0a20 2020         site,.   
-0003c2c0: 2020 2020 2020 2020 206e 6f64 652c 0a20           node,. 
-0003c2d0: 2020 2020 2020 2020 2020 2064 6572 6976             deriv
-0003c2e0: 6564 5f73 7461 7465 2c0a 2020 2020 2020  ed_state,.      
-0003c2f0: 2020 2020 2020 7061 7265 6e74 2c0a 2020        parent,.  
-0003c300: 2020 2020 2020 2020 2020 6d65 7461 6461            metada
-0003c310: 7461 2c0a 2020 2020 2020 2020 2020 2020  ta,.            
-0003c320: 7469 6d65 2c0a 2020 2020 2020 2020 2020  time,.          
-0003c330: 2020 6564 6765 2c0a 2020 2020 2020 2020    edge,.        
-0003c340: 2920 3d20 7365 6c66 2e5f 6c6c 5f74 7265  ) = self._ll_tre
-0003c350: 655f 7365 7175 656e 6365 2e67 6574 5f6d  e_sequence.get_m
-0003c360: 7574 6174 696f 6e28 6964 5f29 0a20 2020  utation(id_).   
-0003c370: 2020 2020 2072 6574 7572 6e20 4d75 7461       return Muta
-0003c380: 7469 6f6e 280a 2020 2020 2020 2020 2020  tion(.          
-0003c390: 2020 6964 3d69 645f 2c0a 2020 2020 2020    id=id_,.      
-0003c3a0: 2020 2020 2020 7369 7465 3d73 6974 652c        site=site,
-0003c3b0: 0a20 2020 2020 2020 2020 2020 206e 6f64  .            nod
-0003c3c0: 653d 6e6f 6465 2c0a 2020 2020 2020 2020  e=node,.        
-0003c3d0: 2020 2020 6465 7269 7665 645f 7374 6174      derived_stat
-0003c3e0: 653d 6465 7269 7665 645f 7374 6174 652c  e=derived_state,
-0003c3f0: 0a20 2020 2020 2020 2020 2020 2070 6172  .            par
-0003c400: 656e 743d 7061 7265 6e74 2c0a 2020 2020  ent=parent,.    
-0003c410: 2020 2020 2020 2020 6d65 7461 6461 7461          metadata
-0003c420: 3d6d 6574 6164 6174 612c 0a20 2020 2020  =metadata,.     
-0003c430: 2020 2020 2020 2074 696d 653d 7469 6d65         time=time
-0003c440: 2c0a 2020 2020 2020 2020 2020 2020 6564  ,.            ed
-0003c450: 6765 3d65 6467 652c 0a20 2020 2020 2020  ge=edge,.       
-0003c460: 2020 2020 206d 6574 6164 6174 615f 6465       metadata_de
-0003c470: 636f 6465 723d 7365 6c66 2e74 6162 6c65  coder=self.table
-0003c480: 5f6d 6574 6164 6174 615f 7363 6865 6d61  _metadata_schema
-0003c490: 732e 6d75 7461 7469 6f6e 2e64 6563 6f64  s.mutation.decod
-0003c4a0: 655f 726f 772c 0a20 2020 2020 2020 2029  e_row,.        )
-0003c4b0: 0a0a 2020 2020 6465 6620 7369 7465 2873  ..    def site(s
-0003c4c0: 656c 662c 2069 645f 3d4e 6f6e 652c 202a  elf, id_=None, *
-0003c4d0: 2c20 706f 7369 7469 6f6e 3d4e 6f6e 6529  , position=None)
-0003c4e0: 3a0a 2020 2020 2020 2020 2222 220a 2020  :.        """.  
-0003c4f0: 2020 2020 2020 5265 7475 726e 7320 7468        Returns th
-0003c500: 6520 3a72 6566 3a60 7369 7465 203c 7365  e :ref:`site <se
-0003c510: 635f 7369 7465 5f74 6162 6c65 5f64 6566  c_site_table_def
-0003c520: 696e 6974 696f 6e3e 6020 696e 2074 6869  inition>` in thi
-0003c530: 7320 7472 6565 2073 6571 7565 6e63 650a  s tree sequence.
-0003c540: 2020 2020 2020 2020 7769 7468 2065 6974          with eit
-0003c550: 6865 7220 7468 6520 7370 6563 6966 6965  her the specifie
-0003c560: 6420 4944 206f 7220 706f 7369 7469 6f6e  d ID or position
-0003c570: 2e20 4173 2077 6974 6820 7079 7468 6f6e  . As with python
-0003c580: 206c 6973 7473 2c20 6e65 6761 7469 7665   lists, negative
-0003c590: 2049 4473 0a20 2020 2020 2020 2063 616e   IDs.        can
-0003c5a0: 2062 6520 7573 6564 2074 6f20 696e 6465   be used to inde
-0003c5b0: 7820 6261 636b 7761 7264 7320 6672 6f6d  x backwards from
-0003c5c0: 2074 6865 206c 6173 7420 7369 7465 2e0a   the last site..
-0003c5d0: 0a20 2020 2020 2020 2057 6865 6e20 706f  .        When po
-0003c5e0: 7369 7469 6f6e 2069 7320 7370 6563 6966  sition is specif
-0003c5f0: 6965 6420 696e 7374 6561 6420 6f66 2073  ied instead of s
-0003c600: 6974 6520 4944 2c20 6120 6269 6e61 7279  ite ID, a binary
-0003c610: 2073 6561 7263 6820 6973 2064 6f6e 650a   search is done.
-0003c620: 2020 2020 2020 2020 6f6e 2074 6865 206c          on the l
-0003c630: 6973 7420 6f66 2070 6f73 6974 696f 6e73  ist of positions
-0003c640: 206f 6620 7468 6520 7369 7465 7320 746f   of the sites to
-0003c650: 2074 7279 2074 6f20 6669 6e64 2061 2073   try to find a s
-0003c660: 6974 650a 2020 2020 2020 2020 7769 7468  ite.        with
-0003c670: 2074 6865 2075 7365 722d 7370 6563 6966   the user-specif
-0003c680: 6965 6420 706f 7369 7469 6f6e 2e0a 0a20  ied position... 
-0003c690: 2020 2020 2020 203a 7274 7970 653a 203a         :rtype: :
-0003c6a0: 636c 6173 733a 6053 6974 6560 0a20 2020  class:`Site`.   
-0003c6b0: 2020 2020 2022 2222 0a20 2020 2020 2020       """.       
-0003c6c0: 2069 6620 6964 5f20 6973 204e 6f6e 6520   if id_ is None 
-0003c6d0: 616e 6420 706f 7369 7469 6f6e 2069 7320  and position is 
-0003c6e0: 4e6f 6e65 3a0a 2020 2020 2020 2020 2020  None:.          
-0003c6f0: 2020 7261 6973 6520 5479 7065 4572 726f    raise TypeErro
-0003c700: 7228 2253 6974 6520 6964 206f 7220 706f  r("Site id or po
-0003c710: 7369 7469 6f6e 206d 7573 7420 6265 2070  sition must be p
-0003c720: 726f 7669 6465 642e 2229 0a20 2020 2020  rovided.").     
-0003c730: 2020 2065 6c69 6620 6964 5f20 6973 206e     elif id_ is n
-0003c740: 6f74 204e 6f6e 6520 616e 6420 706f 7369  ot None and posi
-0003c750: 7469 6f6e 2069 7320 6e6f 7420 4e6f 6e65  tion is not None
-0003c760: 3a0a 2020 2020 2020 2020 2020 2020 7261  :.            ra
-0003c770: 6973 6520 5479 7065 4572 726f 7228 224f  ise TypeError("O
-0003c780: 6e6c 7920 6f6e 6520 6f66 2073 6974 6520  nly one of site 
-0003c790: 6964 206f 7220 706f 7369 7469 6f6e 206e  id or position n
-0003c7a0: 6565 6473 2074 6f20 6265 2070 726f 7669  eeds to be provi
-0003c7b0: 6465 642e 2229 0a20 2020 2020 2020 2065  ded.").        e
-0003c7c0: 6c69 6620 6964 5f20 6973 204e 6f6e 653a  lif id_ is None:
-0003c7d0: 0a20 2020 2020 2020 2020 2020 2070 6f73  .            pos
-0003c7e0: 6974 696f 6e20 3d20 6e70 2e61 7272 6179  ition = np.array
-0003c7f0: 2870 6f73 6974 696f 6e29 0a20 2020 2020  (position).     
-0003c800: 2020 2020 2020 2069 6620 6c65 6e28 706f         if len(po
-0003c810: 7369 7469 6f6e 2e73 6861 7065 2920 3e20  sition.shape) > 
-0003c820: 303a 0a20 2020 2020 2020 2020 2020 2020  0:.             
-0003c830: 2020 2072 6169 7365 2056 616c 7565 4572     raise ValueEr
-0003c840: 726f 7228 2250 6f73 6974 696f 6e20 6d75  ror("Position mu
-0003c850: 7374 2062 6520 7072 6f76 6964 6564 2061  st be provided a
-0003c860: 7320 6120 7363 616c 6172 2076 616c 7565  s a scalar value
-0003c870: 2e22 290a 2020 2020 2020 2020 2020 2020  .").            
-0003c880: 6966 2070 6f73 6974 696f 6e20 3c20 3020  if position < 0 
-0003c890: 6f72 2070 6f73 6974 696f 6e20 3e3d 2073  or position >= s
-0003c8a0: 656c 662e 7365 7175 656e 6365 5f6c 656e  elf.sequence_len
-0003c8b0: 6774 683a 0a20 2020 2020 2020 2020 2020  gth:.           
-0003c8c0: 2020 2020 2072 6169 7365 2056 616c 7565       raise Value
-0003c8d0: 4572 726f 7228 0a20 2020 2020 2020 2020  Error(.         
-0003c8e0: 2020 2020 2020 2020 2020 2022 506f 7369             "Posi
-0003c8f0: 7469 6f6e 2069 7320 6265 796f 6e64 2074  tion is beyond t
-0003c900: 6865 2063 6f6f 7264 696e 6174 6573 2064  he coordinates d
-0003c910: 6566 696e 6564 2062 7920 7365 7175 656e  efined by sequen
-0003c920: 6365 206c 656e 6774 682e 220a 2020 2020  ce length.".    
-0003c930: 2020 2020 2020 2020 2020 2020 290a 2020              ).  
-0003c940: 2020 2020 2020 2020 2020 7369 7465 5f70            site_p
-0003c950: 6f73 203d 2073 656c 662e 7369 7465 735f  os = self.sites_
-0003c960: 706f 7369 7469 6f6e 0a20 2020 2020 2020  position.       
-0003c970: 2020 2020 2069 645f 203d 2073 6974 655f       id_ = site_
-0003c980: 706f 732e 7365 6172 6368 736f 7274 6564  pos.searchsorted
-0003c990: 2870 6f73 6974 696f 6e29 0a20 2020 2020  (position).     
-0003c9a0: 2020 2020 2020 2069 6620 6964 5f20 3e3d         if id_ >=
-0003c9b0: 206c 656e 2873 6974 655f 706f 7329 206f   len(site_pos) o
-0003c9c0: 7220 7369 7465 5f70 6f73 5b69 645f 5d20  r site_pos[id_] 
-0003c9d0: 213d 2070 6f73 6974 696f 6e3a 0a20 2020  != position:.   
-0003c9e0: 2020 2020 2020 2020 2020 2020 2072 6169               rai
-0003c9f0: 7365 2056 616c 7565 4572 726f 7228 6622  se ValueError(f"
-0003ca00: 5468 6572 6520 6973 206e 6f20 7369 7465  There is no site
-0003ca10: 2061 7420 706f 7369 7469 6f6e 207b 706f   at position {po
-0003ca20: 7369 7469 6f6e 7d2e 2229 0a20 2020 2020  sition}.").     
-0003ca30: 2020 2065 6c73 653a 0a20 2020 2020 2020     else:.       
-0003ca40: 2020 2020 2069 645f 203d 2073 656c 662e       id_ = self.
-0003ca50: 6368 6563 6b5f 696e 6465 7828 6964 5f2c  check_index(id_,
-0003ca60: 2073 656c 662e 6e75 6d5f 7369 7465 7329   self.num_sites)
-0003ca70: 0a20 2020 2020 2020 206c 6c5f 7369 7465  .        ll_site
-0003ca80: 203d 2073 656c 662e 5f6c 6c5f 7472 6565   = self._ll_tree
-0003ca90: 5f73 6571 7565 6e63 652e 6765 745f 7369  _sequence.get_si
-0003caa0: 7465 2869 645f 290a 2020 2020 2020 2020  te(id_).        
-0003cab0: 706f 732c 2061 6e63 6573 7472 616c 5f73  pos, ancestral_s
-0003cac0: 7461 7465 2c20 6c6c 5f6d 7574 6174 696f  tate, ll_mutatio
-0003cad0: 6e73 2c20 5f2c 206d 6574 6164 6174 6120  ns, _, metadata 
-0003cae0: 3d20 6c6c 5f73 6974 650a 2020 2020 2020  = ll_site.      
-0003caf0: 2020 6d75 7461 7469 6f6e 7320 3d20 5b73    mutations = [s
-0003cb00: 656c 662e 6d75 7461 7469 6f6e 286d 7574  elf.mutation(mut
-0003cb10: 5f69 6429 2066 6f72 206d 7574 5f69 6420  _id) for mut_id 
-0003cb20: 696e 206c 6c5f 6d75 7461 7469 6f6e 735d  in ll_mutations]
-0003cb30: 0a20 2020 2020 2020 2072 6574 7572 6e20  .        return 
-0003cb40: 5369 7465 280a 2020 2020 2020 2020 2020  Site(.          
-0003cb50: 2020 6964 3d69 645f 2c0a 2020 2020 2020    id=id_,.      
-0003cb60: 2020 2020 2020 706f 7369 7469 6f6e 3d70        position=p
-0003cb70: 6f73 2c0a 2020 2020 2020 2020 2020 2020  os,.            
-0003cb80: 616e 6365 7374 7261 6c5f 7374 6174 653d  ancestral_state=
-0003cb90: 616e 6365 7374 7261 6c5f 7374 6174 652c  ancestral_state,
-0003cba0: 0a20 2020 2020 2020 2020 2020 206d 7574  .            mut
-0003cbb0: 6174 696f 6e73 3d6d 7574 6174 696f 6e73  ations=mutations
-0003cbc0: 2c0a 2020 2020 2020 2020 2020 2020 6d65  ,.            me
-0003cbd0: 7461 6461 7461 3d6d 6574 6164 6174 612c  tadata=metadata,
-0003cbe0: 0a20 2020 2020 2020 2020 2020 206d 6574  .            met
-0003cbf0: 6164 6174 615f 6465 636f 6465 723d 7365  adata_decoder=se
-0003cc00: 6c66 2e74 6162 6c65 5f6d 6574 6164 6174  lf.table_metadat
-0003cc10: 615f 7363 6865 6d61 732e 7369 7465 2e64  a_schemas.site.d
-0003cc20: 6563 6f64 655f 726f 772c 0a20 2020 2020  ecode_row,.     
-0003cc30: 2020 2029 0a0a 2020 2020 6465 6620 706f     )..    def po
-0003cc40: 7075 6c61 7469 6f6e 2873 656c 662c 2069  pulation(self, i
-0003cc50: 645f 293a 0a20 2020 2020 2020 2022 2222  d_):.        """
-0003cc60: 0a20 2020 2020 2020 2052 6574 7572 6e73  .        Returns
-0003cc70: 2074 6865 203a 7265 663a 6070 6f70 756c   the :ref:`popul
-0003cc80: 6174 696f 6e20 3c73 6563 5f70 6f70 756c  ation <sec_popul
-0003cc90: 6174 696f 6e5f 7461 626c 655f 6465 6669  ation_table_defi
-0003cca0: 6e69 7469 6f6e 3e60 0a20 2020 2020 2020  nition>`.       
-0003ccb0: 2069 6e20 7468 6973 2074 7265 6520 7365   in this tree se
-0003ccc0: 7175 656e 6365 2077 6974 6820 7468 6520  quence with the 
-0003ccd0: 7370 6563 6966 6965 6420 4944 2e20 2041  specified ID.  A
-0003cce0: 7320 7769 7468 2070 7974 686f 6e20 6c69  s with python li
-0003ccf0: 7374 732c 206e 6567 6174 6976 650a 2020  sts, negative.  
-0003cd00: 2020 2020 2020 4944 7320 6361 6e20 6265        IDs can be
-0003cd10: 2075 7365 6420 746f 2069 6e64 6578 2062   used to index b
-0003cd20: 6163 6b77 6172 6473 2066 726f 6d20 7468  ackwards from th
-0003cd30: 6520 6c61 7374 2070 6f70 756c 6174 696f  e last populatio
-0003cd40: 6e2e 0a0a 2020 2020 2020 2020 3a72 7479  n...        :rty
-0003cd50: 7065 3a20 3a63 6c61 7373 3a60 506f 7075  pe: :class:`Popu
-0003cd60: 6c61 7469 6f6e 600a 2020 2020 2020 2020  lation`.        
-0003cd70: 2222 220a 2020 2020 2020 2020 6964 5f20  """.        id_ 
-0003cd80: 3d20 7365 6c66 2e63 6865 636b 5f69 6e64  = self.check_ind
-0003cd90: 6578 2869 645f 2c20 7365 6c66 2e6e 756d  ex(id_, self.num
-0003cda0: 5f70 6f70 756c 6174 696f 6e73 290a 2020  _populations).  
-0003cdb0: 2020 2020 2020 286d 6574 6164 6174 612c        (metadata,
-0003cdc0: 2920 3d20 7365 6c66 2e5f 6c6c 5f74 7265  ) = self._ll_tre
-0003cdd0: 655f 7365 7175 656e 6365 2e67 6574 5f70  e_sequence.get_p
-0003cde0: 6f70 756c 6174 696f 6e28 6964 5f29 0a20  opulation(id_). 
-0003cdf0: 2020 2020 2020 2072 6574 7572 6e20 506f         return Po
-0003ce00: 7075 6c61 7469 6f6e 280a 2020 2020 2020  pulation(.      
-0003ce10: 2020 2020 2020 6964 3d69 645f 2c0a 2020        id=id_,.  
-0003ce20: 2020 2020 2020 2020 2020 6d65 7461 6461            metada
-0003ce30: 7461 3d6d 6574 6164 6174 612c 0a20 2020  ta=metadata,.   
-0003ce40: 2020 2020 2020 2020 206d 6574 6164 6174           metadat
-0003ce50: 615f 6465 636f 6465 723d 7365 6c66 2e74  a_decoder=self.t
-0003ce60: 6162 6c65 5f6d 6574 6164 6174 615f 7363  able_metadata_sc
-0003ce70: 6865 6d61 732e 706f 7075 6c61 7469 6f6e  hemas.population
-0003ce80: 2e64 6563 6f64 655f 726f 772c 0a20 2020  .decode_row,.   
-0003ce90: 2020 2020 2029 0a0a 2020 2020 6465 6620       )..    def 
-0003cea0: 7072 6f76 656e 616e 6365 2873 656c 662c  provenance(self,
-0003ceb0: 2069 645f 293a 0a20 2020 2020 2020 2022   id_):.        "
-0003cec0: 2222 0a20 2020 2020 2020 2052 6574 7572  "".        Retur
-0003ced0: 6e73 2074 6865 203a 7265 663a 6070 726f  ns the :ref:`pro
-0003cee0: 7665 6e61 6e63 6520 3c73 6563 5f70 726f  venance <sec_pro
-0003cef0: 7665 6e61 6e63 655f 7461 626c 655f 6465  venance_table_de
-0003cf00: 6669 6e69 7469 6f6e 3e60 0a20 2020 2020  finition>`.     
-0003cf10: 2020 2069 6e20 7468 6973 2074 7265 6520     in this tree 
-0003cf20: 7365 7175 656e 6365 2077 6974 6820 7468  sequence with th
-0003cf30: 6520 7370 6563 6966 6965 6420 4944 2e20  e specified ID. 
-0003cf40: 2041 7320 7769 7468 2070 7974 686f 6e20   As with python 
-0003cf50: 6c69 7374 732c 0a20 2020 2020 2020 206e  lists,.        n
-0003cf60: 6567 6174 6976 6520 4944 7320 6361 6e20  egative IDs can 
-0003cf70: 6265 2075 7365 6420 746f 2069 6e64 6578  be used to index
-0003cf80: 2062 6163 6b77 6172 6473 2066 726f 6d20   backwards from 
-0003cf90: 7468 6520 6c61 7374 2070 726f 7665 6e61  the last provena
-0003cfa0: 6e63 652e 0a20 2020 2020 2020 2022 2222  nce..        """
-0003cfb0: 0a20 2020 2020 2020 2069 645f 203d 2073  .        id_ = s
-0003cfc0: 656c 662e 6368 6563 6b5f 696e 6465 7828  elf.check_index(
-0003cfd0: 6964 5f2c 2073 656c 662e 6e75 6d5f 7072  id_, self.num_pr
-0003cfe0: 6f76 656e 616e 6365 7329 0a20 2020 2020  ovenances).     
-0003cff0: 2020 2074 696d 6573 7461 6d70 2c20 7265     timestamp, re
-0003d000: 636f 7264 203d 2073 656c 662e 5f6c 6c5f  cord = self._ll_
-0003d010: 7472 6565 5f73 6571 7565 6e63 652e 6765  tree_sequence.ge
-0003d020: 745f 7072 6f76 656e 616e 6365 2869 645f  t_provenance(id_
-0003d030: 290a 2020 2020 2020 2020 7265 7475 726e  ).        return
-0003d040: 2050 726f 7665 6e61 6e63 6528 6964 3d69   Provenance(id=i
-0003d050: 645f 2c20 7469 6d65 7374 616d 703d 7469  d_, timestamp=ti
-0003d060: 6d65 7374 616d 702c 2072 6563 6f72 643d  mestamp, record=
-0003d070: 7265 636f 7264 290a 0a20 2020 2064 6566  record)..    def
-0003d080: 2067 6574 5f73 616d 706c 6573 2873 656c   get_samples(sel
-0003d090: 662c 2070 6f70 756c 6174 696f 6e5f 6964  f, population_id
-0003d0a0: 3d4e 6f6e 6529 3a0a 2020 2020 2020 2020  =None):.        
-0003d0b0: 2320 4465 7072 6563 6174 6564 2061 6c69  # Deprecated ali
-0003d0c0: 6173 2066 6f72 2073 616d 706c 6573 2829  as for samples()
-0003d0d0: 0a20 2020 2020 2020 2072 6574 7572 6e20  .        return 
-0003d0e0: 7365 6c66 2e73 616d 706c 6573 2870 6f70  self.samples(pop
-0003d0f0: 756c 6174 696f 6e5f 6964 290a 0a20 2020  ulation_id)..   
-0003d100: 2064 6566 2073 616d 706c 6573 2873 656c   def samples(sel
-0003d110: 662c 2070 6f70 756c 6174 696f 6e3d 4e6f  f, population=No
-0003d120: 6e65 2c20 2a2c 2070 6f70 756c 6174 696f  ne, *, populatio
-0003d130: 6e5f 6964 3d4e 6f6e 652c 2074 696d 653d  n_id=None, time=
-0003d140: 4e6f 6e65 293a 0a20 2020 2020 2020 2022  None):.        "
-0003d150: 2222 0a20 2020 2020 2020 2052 6574 7572  "".        Retur
-0003d160: 6e73 2061 6e20 6172 7261 7920 6f66 2074  ns an array of t
-0003d170: 6865 2073 616d 706c 6520 6e6f 6465 2049  he sample node I
-0003d180: 4473 2069 6e20 7468 6973 2074 7265 6520  Ds in this tree 
-0003d190: 7365 7175 656e 6365 2e20 4966 0a20 2020  sequence. If.   
-0003d1a0: 2020 2020 2060 706f 7075 6c61 7469 6f6e       `population
-0003d1b0: 6020 6973 2073 7065 6369 6669 6564 2c20  ` is specified, 
-0003d1c0: 6f6e 6c79 2072 6574 7572 6e20 7361 6d70  only return samp
-0003d1d0: 6c65 2049 4473 2066 726f 6d20 7468 6174  le IDs from that
-0003d1e0: 2070 6f70 756c 6174 696f 6e2e 0a20 2020   population..   
-0003d1f0: 2020 2020 2049 7420 6973 2061 6c73 6f20       It is also 
-0003d200: 706f 7373 6962 6c65 2074 6f20 7265 7374  possible to rest
-0003d210: 7269 6374 2073 616d 706c 6573 2062 7920  rict samples by 
-0003d220: 7469 6d65 2075 7369 6e67 2074 6865 2070  time using the p
-0003d230: 6172 616d 6574 6572 0a20 2020 2020 2020  arameter.       
-0003d240: 2060 7469 6d65 602e 2049 6620 6074 696d   `time`. If `tim
-0003d250: 6560 2069 7320 6120 6e75 6d65 7269 6320  e` is a numeric 
-0003d260: 7661 6c75 652c 206f 6e6c 7920 7265 7475  value, only retu
-0003d270: 726e 2073 616d 706c 6520 4944 7320 7768  rn sample IDs wh
-0003d280: 6f73 6520 6e6f 6465 0a20 2020 2020 2020  ose node.       
-0003d290: 2074 696d 6520 6973 2061 7070 726f 7869   time is approxi
-0003d2a0: 6d61 7465 6c79 2065 7175 616c 2074 6f20  mately equal to 
-0003d2b0: 7468 6520 7370 6563 6966 6965 6420 7469  the specified ti
-0003d2c0: 6d65 2e20 4966 2060 7469 6d65 6020 6973  me. If `time` is
-0003d2d0: 2061 2070 6169 720a 2020 2020 2020 2020   a pair.        
-0003d2e0: 6f66 2076 616c 7565 7320 6f66 2074 6865  of values of the
-0003d2f0: 2066 6f72 6d20 6028 6d69 6e5f 7469 6d65   form `(min_time
-0003d300: 2c20 6d61 785f 7469 6d65 2960 2c20 6f6e  , max_time)`, on
-0003d310: 6c79 2072 6574 7572 6e20 7361 6d70 6c65  ly return sample
-0003d320: 2049 4473 0a20 2020 2020 2020 2077 686f   IDs.        who
-0003d330: 7365 206e 6f64 6520 7469 6d65 2060 7460  se node time `t`
-0003d340: 2069 7320 696e 2074 6869 7320 696e 7465   is in this inte
-0003d350: 7276 616c 2073 7563 6820 7468 6174 2060  rval such that `
-0003d360: 6d69 6e5f 7469 6d65 203c 3d20 7420 3c20  min_time <= t < 
-0003d370: 6d61 785f 7469 6d65 602e 0a0a 2020 2020  max_time`...    
-0003d380: 2020 2020 3a70 6172 616d 2069 6e74 2070      :param int p
-0003d390: 6f70 756c 6174 696f 6e3a 2054 6865 2070  opulation: The p
-0003d3a0: 6f70 756c 6174 696f 6e20 6f66 2069 6e74  opulation of int
-0003d3b0: 6572 6573 742e 2049 6620 4e6f 6e65 2c20  erest. If None, 
-0003d3c0: 646f 206e 6f74 0a20 2020 2020 2020 2020  do not.         
-0003d3d0: 2020 2066 696c 7465 7220 7361 6d70 6c65     filter sample
-0003d3e0: 7320 6279 2070 6f70 756c 6174 696f 6e2e  s by population.
-0003d3f0: 0a20 2020 2020 2020 203a 7061 7261 6d20  .        :param 
-0003d400: 696e 7420 706f 7075 6c61 7469 6f6e 5f69  int population_i
-0003d410: 643a 2044 6570 7265 6361 7465 6420 616c  d: Deprecated al
-0003d420: 6961 7320 666f 7220 6060 706f 7075 6c61  ias for ``popula
-0003d430: 7469 6f6e 6060 2e0a 2020 2020 2020 2020  tion``..        
-0003d440: 3a70 6172 616d 2066 6c6f 6174 2c74 7570  :param float,tup
-0003d450: 6c65 2074 696d 653a 2054 6865 2074 696d  le time: The tim
-0003d460: 6520 6f72 2074 696d 6520 696e 7465 7276  e or time interv
-0003d470: 616c 206f 6620 696e 7465 7265 7374 2e20  al of interest. 
-0003d480: 4966 0a20 2020 2020 2020 2020 2020 204e  If.            N
-0003d490: 6f6e 652c 2064 6f20 6e6f 7420 6669 6c74  one, do not filt
-0003d4a0: 6572 2073 616d 706c 6573 2062 7920 7469  er samples by ti
-0003d4b0: 6d65 2e0a 2020 2020 2020 2020 3a72 6574  me..        :ret
-0003d4c0: 7572 6e3a 2041 206e 756d 7079 2061 7272  urn: A numpy arr
-0003d4d0: 6179 206f 6620 7468 6520 6e6f 6465 2049  ay of the node I
-0003d4e0: 4473 2066 6f72 2074 6865 2073 616d 706c  Ds for the sampl
-0003d4f0: 6573 206f 6620 696e 7465 7265 7374 2c0a  es of interest,.
-0003d500: 2020 2020 2020 2020 2020 2020 6c69 7374              list
-0003d510: 6564 2069 6e20 6e75 6d65 7269 6361 6c20  ed in numerical 
-0003d520: 6f72 6465 722e 0a20 2020 2020 2020 203a  order..        :
-0003d530: 7274 7970 653a 206e 756d 7079 2e6e 6461  rtype: numpy.nda
-0003d540: 7272 6179 2028 6474 7970 653d 6e70 2e69  rray (dtype=np.i
-0003d550: 6e74 3332 290a 2020 2020 2020 2020 2222  nt32).        ""
-0003d560: 220a 2020 2020 2020 2020 6966 2070 6f70  ".        if pop
-0003d570: 756c 6174 696f 6e20 6973 206e 6f74 204e  ulation is not N
-0003d580: 6f6e 6520 616e 6420 706f 7075 6c61 7469  one and populati
-0003d590: 6f6e 5f69 6420 6973 206e 6f74 204e 6f6e  on_id is not Non
-0003d5a0: 653a 0a20 2020 2020 2020 2020 2020 2072  e:.            r
-0003d5b0: 6169 7365 2056 616c 7565 4572 726f 7228  aise ValueError(
-0003d5c0: 0a20 2020 2020 2020 2020 2020 2020 2020  .               
-0003d5d0: 2022 706f 7075 6c61 7469 6f6e 5f69 6420   "population_id 
-0003d5e0: 616e 6420 706f 7075 6c61 7469 6f6e 2061  and population a
-0003d5f0: 7265 2061 6c69 6173 6573 2e20 4361 6e6e  re aliases. Cann
-0003d600: 6f74 2073 7065 6369 6679 2062 6f74 6822  ot specify both"
-0003d610: 0a20 2020 2020 2020 2020 2020 2029 0a20  .            ). 
-0003d620: 2020 2020 2020 2069 6620 706f 7075 6c61         if popula
-0003d630: 7469 6f6e 5f69 6420 6973 206e 6f74 204e  tion_id is not N
-0003d640: 6f6e 653a 0a20 2020 2020 2020 2020 2020  one:.           
-0003d650: 2070 6f70 756c 6174 696f 6e20 3d20 706f   population = po
-0003d660: 7075 6c61 7469 6f6e 5f69 640a 2020 2020  pulation_id.    
-0003d670: 2020 2020 7361 6d70 6c65 7320 3d20 7365      samples = se
-0003d680: 6c66 2e5f 6c6c 5f74 7265 655f 7365 7175  lf._ll_tree_sequ
-0003d690: 656e 6365 2e67 6574 5f73 616d 706c 6573  ence.get_samples
-0003d6a0: 2829 0a20 2020 2020 2020 206b 6565 7020  ().        keep 
-0003d6b0: 3d20 6e70 2e66 756c 6c28 7368 6170 653d  = np.full(shape=
-0003d6c0: 7361 6d70 6c65 732e 7368 6170 652c 2066  samples.shape, f
-0003d6d0: 696c 6c5f 7661 6c75 653d 5472 7565 290a  ill_value=True).
-0003d6e0: 2020 2020 2020 2020 6966 2070 6f70 756c          if popul
-0003d6f0: 6174 696f 6e20 6973 206e 6f74 204e 6f6e  ation is not Non
-0003d700: 653a 0a20 2020 2020 2020 2020 2020 2073  e:.            s
-0003d710: 616d 706c 655f 706f 7075 6c61 7469 6f6e  ample_population
-0003d720: 203d 2073 656c 662e 6e6f 6465 735f 706f   = self.nodes_po
-0003d730: 7075 6c61 7469 6f6e 5b73 616d 706c 6573  pulation[samples
-0003d740: 5d0a 2020 2020 2020 2020 2020 2020 6b65  ].            ke
-0003d750: 6570 203d 206e 702e 6c6f 6769 6361 6c5f  ep = np.logical_
-0003d760: 616e 6428 6b65 6570 2c20 7361 6d70 6c65  and(keep, sample
-0003d770: 5f70 6f70 756c 6174 696f 6e20 3d3d 2070  _population == p
-0003d780: 6f70 756c 6174 696f 6e29 0a20 2020 2020  opulation).     
-0003d790: 2020 2069 6620 7469 6d65 2069 7320 6e6f     if time is no
-0003d7a0: 7420 4e6f 6e65 3a0a 2020 2020 2020 2020  t None:.        
-0003d7b0: 2020 2020 2320 6e64 6d69 6e20 6973 2073      # ndmin is s
-0003d7c0: 6574 2073 6f20 7468 6174 2073 6361 6c61  et so that scala
-0003d7d0: 7273 2061 7265 2063 6f6e 7665 7274 6564  rs are converted
-0003d7e0: 2069 6e74 6f20 3164 2061 7272 6179 730a   into 1d arrays.
-0003d7f0: 2020 2020 2020 2020 2020 2020 7469 6d65              time
-0003d800: 203d 206e 702e 6172 7261 7928 7469 6d65   = np.array(time
-0003d810: 2c20 6e64 6d69 6e3d 312c 2064 7479 7065  , ndmin=1, dtype
-0003d820: 3d66 6c6f 6174 290a 2020 2020 2020 2020  =float).        
-0003d830: 2020 2020 7361 6d70 6c65 5f74 696d 6573      sample_times
-0003d840: 203d 2073 656c 662e 6e6f 6465 735f 7469   = self.nodes_ti
-0003d850: 6d65 5b73 616d 706c 6573 5d0a 2020 2020  me[samples].    
-0003d860: 2020 2020 2020 2020 6966 2074 696d 652e          if time.
-0003d870: 7368 6170 6520 3d3d 2028 312c 293a 0a20  shape == (1,):. 
-0003d880: 2020 2020 2020 2020 2020 2020 2020 206b                 k
-0003d890: 6565 7020 3d20 6e70 2e6c 6f67 6963 616c  eep = np.logical
-0003d8a0: 5f61 6e64 286b 6565 702c 206e 702e 6973  _and(keep, np.is
-0003d8b0: 636c 6f73 6528 7361 6d70 6c65 5f74 696d  close(sample_tim
-0003d8c0: 6573 2c20 7469 6d65 2929 0a20 2020 2020  es, time)).     
-0003d8d0: 2020 2020 2020 2065 6c69 6620 7469 6d65         elif time
-0003d8e0: 2e73 6861 7065 203d 3d20 2832 2c29 3a0a  .shape == (2,):.
-0003d8f0: 2020 2020 2020 2020 2020 2020 2020 2020                  
-0003d900: 6966 2074 696d 655b 315d 203c 3d20 7469  if time[1] <= ti
-0003d910: 6d65 5b30 5d3a 0a20 2020 2020 2020 2020  me[0]:.         
-0003d920: 2020 2020 2020 2020 2020 2072 6169 7365             raise
-0003d930: 2056 616c 7565 4572 726f 7228 2274 696d   ValueError("tim
-0003d940: 655f 696e 7465 7276 616c 206d 6178 2069  e_interval max i
-0003d950: 7320 6c65 7373 2074 6861 6e20 6f72 2065  s less than or e
-0003d960: 7175 616c 2074 6f20 6d69 6e2e 2229 0a20  qual to min."). 
-0003d970: 2020 2020 2020 2020 2020 2020 2020 206b                 k
-0003d980: 6565 7020 3d20 6e70 2e6c 6f67 6963 616c  eep = np.logical
-0003d990: 5f61 6e64 286b 6565 702c 2073 616d 706c  _and(keep, sampl
-0003d9a0: 655f 7469 6d65 7320 3e3d 2074 696d 655b  e_times >= time[
-0003d9b0: 305d 290a 2020 2020 2020 2020 2020 2020  0]).            
-0003d9c0: 2020 2020 6b65 6570 203d 206e 702e 6c6f      keep = np.lo
-0003d9d0: 6769 6361 6c5f 616e 6428 6b65 6570 2c20  gical_and(keep, 
-0003d9e0: 7361 6d70 6c65 5f74 696d 6573 203c 2074  sample_times < t
-0003d9f0: 696d 655b 315d 290a 2020 2020 2020 2020  ime[1]).        
-0003da00: 2020 2020 656c 7365 3a0a 2020 2020 2020      else:.      
-0003da10: 2020 2020 2020 2020 2020 7261 6973 6520            raise 
-0003da20: 5661 6c75 6545 7272 6f72 280a 2020 2020  ValueError(.    
-0003da30: 2020 2020 2020 2020 2020 2020 2020 2020                  
-0003da40: 2274 696d 6520 6d75 7374 2062 6520 6569  "time must be ei
-0003da50: 7468 6572 2061 2073 696e 676c 6520 7661  ther a single va
-0003da60: 6c75 6520 6f72 2061 2070 6169 7220 6f66  lue or a pair of
-0003da70: 2076 616c 7565 7320 220a 2020 2020 2020   values ".      
-0003da80: 2020 2020 2020 2020 2020 2020 2020 2228                "(
-0003da90: 6d69 6e5f 7469 6d65 2c20 6d61 785f 7469  min_time, max_ti
-0003daa0: 6d65 292e 220a 2020 2020 2020 2020 2020  me).".          
-0003dab0: 2020 2020 2020 290a 2020 2020 2020 2020        ).        
-0003dac0: 7265 7475 726e 2073 616d 706c 6573 5b6b  return samples[k
-0003dad0: 6565 705d 0a0a 2020 2020 6465 6620 6173  eep]..    def as
-0003dae0: 5f76 6366 2873 656c 662c 202a 6172 6773  _vcf(self, *args
-0003daf0: 2c20 2a2a 6b77 6172 6773 293a 0a20 2020  , **kwargs):.   
-0003db00: 2020 2020 2022 2222 0a20 2020 2020 2020       """.       
-0003db10: 2052 6574 7572 6e20 7468 6520 7265 7375   Return the resu
-0003db20: 6c74 206f 6620 3a6d 6574 683a 602e 7772  lt of :meth:`.wr
-0003db30: 6974 655f 7663 6660 2061 7320 6120 7374  ite_vcf` as a st
-0003db40: 7269 6e67 2e0a 2020 2020 2020 2020 4b65  ring..        Ke
-0003db50: 7977 6f72 6420 7061 7261 6d65 7465 7273  yword parameters
-0003db60: 2061 7265 2061 7320 6465 6669 6e65 6420   are as defined 
-0003db70: 696e 203a 6d65 7468 3a60 2e77 7269 7465  in :meth:`.write
-0003db80: 5f76 6366 602e 0a0a 2020 2020 2020 2020  _vcf`...        
-0003db90: 3a72 6574 7572 6e3a 2041 2056 4346 2065  :return: A VCF e
-0003dba0: 6e63 6f64 696e 6720 6f66 2074 6865 2076  ncoding of the v
-0003dbb0: 6172 6961 6e74 7320 696e 2074 6869 7320  ariants in this 
-0003dbc0: 7472 6565 2073 6571 7565 6e63 6520 6173  tree sequence as
-0003dbd0: 2061 2073 7472 696e 672e 0a20 2020 2020   a string..     
-0003dbe0: 2020 203a 7274 7970 653a 2073 7472 0a20     :rtype: str. 
-0003dbf0: 2020 2020 2020 2022 2222 0a20 2020 2020         """.     
-0003dc00: 2020 2062 7566 6620 3d20 696f 2e53 7472     buff = io.Str
-0003dc10: 696e 6749 4f28 290a 2020 2020 2020 2020  ingIO().        
-0003dc20: 7365 6c66 2e77 7269 7465 5f76 6366 2862  self.write_vcf(b
-0003dc30: 7566 662c 202a 6172 6773 2c20 2a2a 6b77  uff, *args, **kw
-0003dc40: 6172 6773 290a 2020 2020 2020 2020 7265  args).        re
-0003dc50: 7475 726e 2062 7566 662e 6765 7476 616c  turn buff.getval
-0003dc60: 7565 2829 0a0a 2020 2020 6465 6620 7772  ue()..    def wr
-0003dc70: 6974 655f 7663 6628 0a20 2020 2020 2020  ite_vcf(.       
-0003dc80: 2073 656c 662c 0a20 2020 2020 2020 206f   self,.        o
-0003dc90: 7574 7075 742c 0a20 2020 2020 2020 2070  utput,.        p
-0003dca0: 6c6f 6964 793d 4e6f 6e65 2c0a 2020 2020  loidy=None,.    
-0003dcb0: 2020 2020 2a2c 0a20 2020 2020 2020 2063      *,.        c
-0003dcc0: 6f6e 7469 675f 6964 3d22 3122 2c0a 2020  ontig_id="1",.  
-0003dcd0: 2020 2020 2020 696e 6469 7669 6475 616c        individual
-0003dce0: 733d 4e6f 6e65 2c0a 2020 2020 2020 2020  s=None,.        
-0003dcf0: 696e 6469 7669 6475 616c 5f6e 616d 6573  individual_names
-0003dd00: 3d4e 6f6e 652c 0a20 2020 2020 2020 2070  =None,.        p
-0003dd10: 6f73 6974 696f 6e5f 7472 616e 7366 6f72  osition_transfor
-0003dd20: 6d3d 4e6f 6e65 2c0a 2020 2020 2020 2020  m=None,.        
-0003dd30: 7369 7465 5f6d 6173 6b3d 4e6f 6e65 2c0a  site_mask=None,.
-0003dd40: 2020 2020 2020 2020 7361 6d70 6c65 5f6d          sample_m
-0003dd50: 6173 6b3d 4e6f 6e65 2c0a 2020 2020 2020  ask=None,.      
-0003dd60: 2020 6973 6f6c 6174 6564 5f61 735f 6d69    isolated_as_mi
-0003dd70: 7373 696e 673d 4e6f 6e65 2c0a 2020 2020  ssing=None,.    
-0003dd80: 293a 0a20 2020 2020 2020 2022 2222 0a20  ):.        """. 
-0003dd90: 2020 2020 2020 2043 6f6e 7665 7274 2074         Convert t
-0003dda0: 6865 2067 656e 6574 6963 2076 6172 6961  he genetic varia
-0003ddb0: 7469 6f6e 2064 6174 6120 696e 2074 6869  tion data in thi
-0003ddc0: 7320 7472 6565 2073 6571 7565 6e63 6520  s tree sequence 
-0003ddd0: 746f 2056 6172 6961 6e74 0a20 2020 2020  to Variant.     
-0003dde0: 2020 2043 616c 6c20 466f 726d 6174 2061     Call Format a
-0003ddf0: 6e64 2077 7269 7465 2074 6f20 7468 6520  nd write to the 
-0003de00: 7370 6563 6966 6965 6420 6669 6c65 2d6c  specified file-l
-0003de10: 696b 6520 6f62 6a65 6374 2e0a 0a20 2020  ike object...   
-0003de20: 2020 2020 202e 2e20 7365 6561 6c73 6f3a       .. seealso:
-0003de30: 2053 6565 2074 6865 203a 7265 663a 6073   See the :ref:`s
-0003de40: 6563 5f65 7870 6f72 745f 7663 6660 2073  ec_export_vcf` s
-0003de50: 6563 7469 6f6e 2066 6f72 2065 7861 6d70  ection for examp
-0003de60: 6c65 730a 2020 2020 2020 2020 2020 2020  les.            
-0003de70: 616e 6420 6578 706c 616e 6174 696f 6e73  and explanations
-0003de80: 206f 6620 686f 7720 7765 206d 6170 2056   of how we map V
-0003de90: 4346 2074 6f20 7468 6520 7473 6b69 7420  CF to the tskit 
-0003dea0: 6461 7461 206d 6f64 656c 2e0a 0a20 2020  data model...   
-0003deb0: 2020 2020 204d 756c 7469 706c 6f69 6420       Multiploid 
-0003dec0: 7361 6d70 6c65 7320 696e 2074 6865 206f  samples in the o
-0003ded0: 7574 7075 7420 5643 4620 6172 6520 6765  utput VCF are ge
-0003dee0: 6e65 7261 7465 6420 6569 7468 6572 2075  nerated either u
-0003def0: 7369 6e67 0a20 2020 2020 2020 2069 6e64  sing.        ind
-0003df00: 6976 6964 7561 6c20 696e 666f 726d 6174  ividual informat
-0003df10: 696f 6e20 696e 2074 6865 2064 6174 6120  ion in the data 
-0003df20: 6d6f 6465 6c20 2873 6565 0a20 2020 2020  model (see.     
-0003df30: 2020 203a 7265 663a 6073 6563 5f69 6e64     :ref:`sec_ind
-0003df40: 6976 6964 7561 6c5f 7461 626c 655f 6465  ividual_table_de
-0003df50: 6669 6e69 7469 6f6e 6029 2c20 6f72 2062  finition`), or b
-0003df60: 7920 636f 6d62 696e 696e 6720 6765 6e6f  y combining geno
-0003df70: 7479 7065 7320 666f 720a 2020 2020 2020  types for.      
-0003df80: 2020 6164 6a61 6365 6e74 2073 616d 706c    adjacent sampl
-0003df90: 6520 6e6f 6465 7320 7573 696e 6720 7468  e nodes using th
-0003dfa0: 6520 6060 706c 6f69 6479 6060 2061 7267  e ``ploidy`` arg
-0003dfb0: 756d 656e 742e 2053 6565 2074 6865 0a20  ument. See the. 
-0003dfc0: 2020 2020 2020 203a 7265 663a 6073 6563         :ref:`sec
-0003dfd0: 5f65 7870 6f72 745f 7663 665f 636f 6e73  _export_vcf_cons
-0003dfe0: 7472 7563 7469 6e67 5f67 7460 2073 6563  tructing_gt` sec
-0003dff0: 7469 6f6e 2066 6f72 206d 6f72 6520 6465  tion for more de
-0003e000: 7461 696c 730a 2020 2020 2020 2020 616e  tails.        an
-0003e010: 6420 6578 616d 706c 6573 2e0a 0a20 2020  d examples...   
-0003e020: 2020 2020 2049 6620 696e 6469 7669 6475       If individu
-0003e030: 616c 7320 7468 6174 2061 7265 2061 7373  als that are ass
-0003e040: 6f63 6961 7465 6420 7769 7468 2073 616d  ociated with sam
-0003e050: 706c 6520 6e6f 6465 7320 6172 6520 6465  ple nodes are de
-0003e060: 6669 6e65 6420 696e 2074 6865 0a20 2020  fined in the.   
-0003e070: 2020 2020 2064 6174 6120 6d6f 6465 6c20       data model 
-0003e080: 2873 6565 203a 7265 663a 6073 6563 5f69  (see :ref:`sec_i
-0003e090: 6e64 6976 6964 7561 6c5f 7461 626c 655f  ndividual_table_
-0003e0a0: 6465 6669 6e69 7469 6f6e 6029 2c20 7468  definition`), th
-0003e0b0: 6520 6765 6e6f 7479 7065 730a 2020 2020  e genotypes.    
-0003e0c0: 2020 2020 666f 7220 6561 6368 206f 6620      for each of 
-0003e0d0: 7468 6520 696e 6469 7669 6475 616c 2773  the individual's
-0003e0e0: 2073 616d 706c 6573 2061 7265 2063 6f6d   samples are com
-0003e0f0: 6269 6e65 6420 696e 746f 2061 2070 6861  bined into a pha
-0003e100: 7365 640a 2020 2020 2020 2020 6d75 6c74  sed.        mult
-0003e110: 6970 6c6f 6964 2076 616c 7565 7320 6174  iploid values at
-0003e120: 2065 6163 6820 7369 7465 2e20 4279 2064   each site. By d
-0003e130: 6566 6175 6c74 2c20 616c 6c20 696e 6469  efault, all indi
-0003e140: 7669 6475 616c 7320 6173 736f 6369 6174  viduals associat
-0003e150: 6564 0a20 2020 2020 2020 2077 6974 6820  ed.        with 
-0003e160: 7361 6d70 6c65 206e 6f64 6573 2061 7265  sample nodes are
-0003e170: 2069 6e63 6c75 6465 6420 696e 2069 6e63   included in inc
-0003e180: 7265 6173 696e 6720 6f72 6465 7220 6f66  reasing order of
-0003e190: 2069 6e64 6976 6964 7561 6c20 4944 2e0a   individual ID..
-0003e1a0: 0a20 2020 2020 2020 2053 7562 7365 7473  .        Subsets
-0003e1b0: 206f 7220 7065 726d 7574 6174 696f 6e73   or permutations
-0003e1c0: 206f 6620 7468 6520 7361 6d70 6c65 2069   of the sample i
-0003e1d0: 6e64 6976 6964 7561 6c73 206d 6179 2062  ndividuals may b
-0003e1e0: 6520 7370 6563 6966 6965 640a 2020 2020  e specified.    
-0003e1f0: 2020 2020 7573 696e 6720 7468 6520 6060      using the ``
-0003e200: 696e 6469 7669 6475 616c 7360 6020 6172  individuals`` ar
-0003e210: 6775 6d65 6e74 2e20 4974 2069 7320 616e  gument. It is an
-0003e220: 2065 7272 6f72 2074 6f20 7370 6563 6966   error to specif
-0003e230: 7920 616e 790a 2020 2020 2020 2020 696e  y any.        in
-0003e240: 6469 7669 6475 616c 7320 7468 6174 2061  dividuals that a
-0003e250: 7265 206e 6f74 2061 7373 6f63 6961 7465  re not associate
-0003e260: 6420 7769 7468 2061 6e79 206e 6f64 6573  d with any nodes
-0003e270: 2c20 6f72 2077 686f 7365 0a20 2020 2020  , or whose.     
-0003e280: 2020 206e 6f64 6573 2061 7265 206e 6f74     nodes are not
-0003e290: 2061 6c6c 2073 616d 706c 6573 2e0a 0a20   all samples... 
-0003e2a0: 2020 2020 2020 204d 6978 6564 2d73 616d         Mixed-sam
-0003e2b0: 706c 6520 696e 6469 7669 6475 616c 7320  ple individuals 
-0003e2c0: 2865 2e67 2e2c 2074 686f 7365 2061 7373  (e.g., those ass
-0003e2d0: 6f63 6961 7465 6420 7769 7468 206f 6e65  ociated with one
-0003e2e0: 206e 6f64 650a 2020 2020 2020 2020 7468   node.        th
-0003e2f0: 6174 2069 7320 6120 7361 6d70 6c65 2061  at is a sample a
-0003e300: 6e64 2061 6e6f 7468 6572 2074 6861 7420  nd another that 
-0003e310: 6973 206e 6f74 2920 696e 2074 6865 2064  is not) in the d
-0003e320: 6174 6120 6d6f 6465 6c20 7769 6c6c 0a20  ata model will. 
-0003e330: 2020 2020 2020 2072 6573 756c 7420 696e         result in
-0003e340: 2061 6e20 6572 726f 7220 6279 2064 6566   an error by def
-0003e350: 6175 6c74 2e20 486f 7765 7665 722c 2073  ault. However, s
-0003e360: 7563 6820 696e 6469 7669 6475 616c 7320  uch individuals 
-0003e370: 6361 6e20 6265 0a20 2020 2020 2020 2065  can be.        e
-0003e380: 7863 6c75 6465 6420 7573 696e 6720 7468  xcluded using th
-0003e390: 6520 6060 696e 6469 7669 6475 616c 7360  e ``individuals`
-0003e3a0: 6020 6172 6775 6d65 6e74 2e0a 0a20 2020  ` argument...   
-0003e3b0: 2020 2020 2049 6620 7468 6572 6520 6172       If there ar
-0003e3c0: 6520 6e6f 2069 6e64 6976 6964 7561 6c73  e no individuals
-0003e3d0: 2069 6e20 7468 6520 7472 6565 2073 6571   in the tree seq
-0003e3e0: 7565 6e63 652c 0a20 2020 2020 2020 2073  uence,.        s
-0003e3f0: 796e 7468 6574 6963 2069 6e64 6976 6964  ynthetic individ
-0003e400: 7561 6c73 2061 7265 2063 7265 6174 6564  uals are created
-0003e410: 2062 7920 636f 6d62 696e 696e 6720 6164   by combining ad
-0003e420: 6a61 6365 6e74 2073 616d 706c 6573 2c20  jacent samples, 
-0003e430: 616e 640a 2020 2020 2020 2020 7468 6520  and.        the 
-0003e440: 6e75 6d62 6572 206f 6620 7361 6d70 6c65  number of sample
-0003e450: 7320 636f 6d62 696e 6564 2069 7320 6571  s combined is eq
-0003e460: 7561 6c20 746f 2074 6865 2060 6070 6c6f  ual to the ``plo
-0003e470: 6964 7960 6020 7661 6c75 6520 2831 2062  idy`` value (1 b
-0003e480: 790a 2020 2020 2020 2020 6465 6661 756c  y.        defaul
-0003e490: 7429 2e20 466f 7220 6578 616d 706c 652c  t). For example,
-0003e4a0: 2069 6620 7765 2068 6176 6520 6120 6060   if we have a ``
-0003e4b0: 706c 6f69 6479 6060 206f 6620 3220 616e  ploidy`` of 2 an
-0003e4c0: 6420 3620 7361 6d70 6c65 206e 6f64 6573  d 6 sample nodes
-0003e4d0: 2c0a 2020 2020 2020 2020 7468 656e 2077  ,.        then w
-0003e4e0: 6520 7769 6c6c 2068 6176 6520 3320 6469  e will have 3 di
-0003e4f0: 706c 6f69 6420 7361 6d70 6c65 7320 696e  ploid samples in
-0003e500: 2074 6865 2056 4346 2c20 636f 6e73 6973   the VCF, consis
-0003e510: 7469 6e67 206f 6620 7468 650a 2020 2020  ting of the.    
-0003e520: 2020 2020 636f 6d62 696e 6564 2067 656e      combined gen
-0003e530: 6f74 7970 6573 2066 6f72 2073 616d 706c  otypes for sampl
-0003e540: 6573 205b 302c 2031 5d2c 205b 322c 2033  es [0, 1], [2, 3
-0003e550: 5d20 616e 6420 5b34 2c20 355d 2e20 4966  ] and [4, 5]. If
-0003e560: 2077 6520 6861 640a 2020 2020 2020 2020   we had.        
-0003e570: 6765 6e6f 7479 7065 7320 3031 3131 3130  genotypes 011110
-0003e580: 2061 7420 6120 7061 7274 6963 756c 6172   at a particular
-0003e590: 2076 6172 6961 6e74 2c20 7468 656e 2077   variant, then w
-0003e5a0: 6520 776f 756c 6420 6f75 7470 7574 2074  e would output t
-0003e5b0: 6865 0a20 2020 2020 2020 2064 6970 6c6f  he.        diplo
-0003e5c0: 6964 2067 656e 6f74 7970 6573 2030 7c31  id genotypes 0|1
-0003e5d0: 2c20 317c 3120 616e 6420 317c 3020 696e  , 1|1 and 1|0 in
-0003e5e0: 2056 4346 2e0a 0a20 2020 2020 2020 2045   VCF...        E
-0003e5f0: 6163 6820 696e 6469 7669 6475 616c 2069  ach individual i
-0003e600: 6e20 7468 6520 6f75 7470 7574 2069 7320  n the output is 
-0003e610: 6964 656e 7469 6669 6564 2062 7920 6120  identified by a 
-0003e620: 7374 7269 6e67 3b20 7468 6573 6520 6172  string; these ar
-0003e630: 6520 7468 650a 2020 2020 2020 2020 5643  e the.        VC
-0003e640: 4620 2273 616d 706c 6522 206e 616d 6573  F "sample" names
-0003e650: 2e20 4279 2064 6566 6175 6c74 2c20 7468  . By default, th
-0003e660: 6573 6520 6172 6520 6f66 2074 6865 2066  ese are of the f
-0003e670: 6f72 6d20 6060 7473 6b5f 3060 602c 0a20  orm ``tsk_0``,. 
-0003e680: 2020 2020 2020 2060 6074 736b 5f31 6060         ``tsk_1``
-0003e690: 2065 7463 2c20 7570 2074 6f20 7468 6520   etc, up to the 
-0003e6a0: 6e75 6d62 6572 206f 6620 696e 6469 7669  number of indivi
-0003e6b0: 6475 616c 732c 2062 7574 2063 616e 2062  duals, but can b
-0003e6c0: 6520 6d61 6e75 616c 6c79 0a20 2020 2020  e manually.     
-0003e6d0: 2020 2073 7065 6369 6669 6564 2075 7369     specified usi
-0003e6e0: 6e67 2074 6865 2060 6069 6e64 6976 6964  ng the ``individ
-0003e6f0: 7561 6c5f 6e61 6d65 7360 6020 6172 6775  ual_names`` argu
-0003e700: 6d65 6e74 2e20 5765 2064 6f20 6e6f 7420  ment. We do not 
-0003e710: 6368 6563 6b0a 2020 2020 2020 2020 666f  check.        fo
-0003e720: 7220 6475 706c 6963 6174 6573 2069 6e20  r duplicates in 
-0003e730: 7468 6973 2061 7272 6179 2c20 6f72 2070  this array, or p
-0003e740: 6572 666f 726d 2061 6e79 2063 6865 636b  erform any check
-0003e750: 7320 746f 2065 6e73 7572 6520 7468 6174  s to ensure that
-0003e760: 0a20 2020 2020 2020 2074 6865 206f 7574  .        the out
-0003e770: 7075 7420 5643 4620 6973 2077 656c 6c2d  put VCF is well-
-0003e780: 666f 726d 6564 2e0a 0a20 2020 2020 2020  formed...       
-0003e790: 202e 2e20 6e6f 7465 3a3a 0a20 2020 2020   .. note::.     
-0003e7a0: 2020 2020 2020 2054 6865 2064 6566 6175         The defau
-0003e7b0: 6c74 2069 6e64 6976 6964 7561 6c20 6e61  lt individual na
-0003e7c0: 6d65 7320 2856 4346 2073 616d 706c 6520  mes (VCF sample 
-0003e7d0: 4944 7329 2061 7265 2061 6c77 6179 7320  IDs) are always 
-0003e7e0: 6f66 0a20 2020 2020 2020 2020 2020 2074  of.            t
-0003e7f0: 6865 2066 6f72 6d20 6060 7473 6b5f 3060  he form ``tsk_0`
-0003e800: 602c 2060 6074 736b 5f31 6060 2c20 2e2e  `, ``tsk_1``, ..
-0003e810: 2e2c 2060 6074 736b 5f7b 4e20 2d20 317d  ., ``tsk_{N - 1}
-0003e820: 6060 2c20 7768 6572 650a 2020 2020 2020  ``, where.      
-0003e830: 2020 2020 2020 4e20 6973 2074 6865 206e        N is the n
-0003e840: 756d 6265 7220 6f66 2069 6e64 6976 6964  umber of individ
-0003e850: 7561 6c73 2077 6520 6f75 7470 7574 2e20  uals we output. 
-0003e860: 5468 6573 6520 6e75 6d62 6572 730a 2020  These numbers.  
-0003e870: 2020 2020 2020 2020 2020 6172 6520 2a2a            are **
-0003e880: 6e6f 742a 2a20 6e65 6365 7373 6172 696c  not** necessaril
-0003e890: 7920 7468 6520 696e 6469 7669 6475 616c  y the individual
-0003e8a0: 2049 4473 2e0a 0a20 2020 2020 2020 2054   IDs...        T
-0003e8b0: 6865 2052 4546 2076 616c 7565 2069 6e20  he REF value in 
-0003e8c0: 7468 6520 6f75 7470 7574 2056 4346 2069  the output VCF i
-0003e8d0: 7320 7468 6520 616e 6365 7374 7261 6c20  s the ancestral 
-0003e8e0: 616c 6c65 6c65 2066 6f72 2061 2073 6974  allele for a sit
-0003e8f0: 650a 2020 2020 2020 2020 616e 6420 414c  e.        and AL
-0003e900: 5420 7661 6c75 6573 2061 7265 2074 6865  T values are the
-0003e910: 2072 656d 6169 6e69 6e67 2061 6c6c 656c   remaining allel
-0003e920: 6573 2e20 4974 2069 7320 696d 706f 7274  es. It is import
-0003e930: 616e 7420 746f 206e 6f74 652c 0a20 2020  ant to note,.   
-0003e940: 2020 2020 2074 6865 7265 666f 7265 2c20       therefore, 
-0003e950: 7468 6174 2066 6f72 2072 6561 6c20 6461  that for real da
-0003e960: 7461 2074 6869 7320 6d65 616e 7320 7468  ta this means th
-0003e970: 6174 2074 6865 2052 4546 2076 616c 7565  at the REF value
-0003e980: 2066 6f72 2061 2067 6976 656e 0a20 2020   for a given.   
-0003e990: 2020 2020 2073 6974 6520 2a2a 6d61 7920       site **may 
-0003e9a0: 6e6f 742a 2a20 6265 2065 7175 616c 2074  not** be equal t
-0003e9b0: 6f20 7468 6520 7265 6665 7265 6e63 6520  o the reference 
-0003e9c0: 616c 6c65 6c65 2e20 5765 2061 6c73 6f20  allele. We also 
-0003e9d0: 646f 206e 6f74 0a20 2020 2020 2020 2063  do not.        c
-0003e9e0: 6865 636b 2074 6861 7420 7468 6520 616c  heck that the al
-0003e9f0: 6c65 6c65 7320 7265 7375 6c74 2069 6e20  leles result in 
-0003ea00: 6120 7661 6c69 6420 5643 462d 2d2d 666f  a valid VCF---fo
-0003ea10: 7220 6578 616d 706c 652c 2069 7420 6973  r example, it is
-0003ea20: 2070 6f73 7369 626c 650a 2020 2020 2020   possible.      
-0003ea30: 2020 746f 2075 7365 2074 6865 2074 6162    to use the tab
-0003ea40: 2063 6861 7261 6374 6572 2061 7320 616e   character as an
-0003ea50: 2061 6c6c 656c 652c 206c 6561 6469 6e67   allele, leading
-0003ea60: 2074 6f20 6120 6272 6f6b 656e 2056 4346   to a broken VCF
-0003ea70: 2e0a 0a20 2020 2020 2020 2054 6865 2049  ...        The I
-0003ea80: 4420 7661 6c75 6520 696e 2074 6865 206f  D value in the o
-0003ea90: 7574 7075 7420 5643 4620 6669 6c65 2069  utput VCF file i
-0003eaa0: 7320 7468 6520 696e 7465 6765 7220 4944  s the integer ID
-0003eab0: 206f 6620 7468 650a 2020 2020 2020 2020   of the.        
-0003eac0: 636f 7272 6573 706f 6e64 696e 6720 3a72  corresponding :r
-0003ead0: 6566 3a60 7369 7465 203c 7365 635f 7369  ef:`site <sec_si
-0003eae0: 7465 5f74 6162 6c65 5f64 6566 696e 6974  te_table_definit
-0003eaf0: 696f 6e3e 6020 2860 6073 6974 652e 6964  ion>` (``site.id
-0003eb00: 6060 292e 0a20 2020 2020 2020 2054 6865  ``)..        The
-0003eb10: 7365 2049 4420 7661 6c75 6573 2063 616e  se ID values can
-0003eb20: 2062 6520 7574 696c 697a 6564 2074 6f20   be utilized to 
-0003eb30: 6d61 7463 6820 7468 6520 636f 6e74 656e  match the conten
-0003eb40: 7473 206f 6620 7468 6520 5643 4620 6669  ts of the VCF fi
-0003eb50: 6c65 0a20 2020 2020 2020 2074 6f20 7468  le.        to th
-0003eb60: 6520 7369 7465 7320 696e 2074 6865 2074  e sites in the t
-0003eb70: 7265 6520 7365 7175 656e 6365 206f 626a  ree sequence obj
-0003eb80: 6563 742e 0a0a 2020 2020 2020 2020 2e2e  ect...        ..
-0003eb90: 206e 6f74 653a 3a0a 2020 2020 2020 2020   note::.        
-0003eba0: 2020 204f 6c64 6572 2063 6f64 6520 6f66     Older code of
-0003ebb0: 7465 6e20 7573 6573 2074 6865 2060 6070  ten uses the ``p
-0003ebc0: 6c6f 6964 793d 3260 6020 6172 6775 6d65  loidy=2`` argume
-0003ebd0: 6e74 2c20 6265 6361 7573 6520 6f6c 640a  nt, because old.
-0003ebe0: 2020 2020 2020 2020 2020 2076 6572 7369             versi
-0003ebf0: 6f6e 7320 6f66 206d 7370 7269 6d65 2064  ons of msprime d
-0003ec00: 6964 206e 6f74 206f 7574 7075 7420 696e  id not output in
-0003ec10: 6469 7669 6475 616c 2064 6174 612e 2053  dividual data. S
-0003ec20: 7065 6369 6679 696e 670a 2020 2020 2020  pecifying.      
-0003ec30: 2020 2020 2069 6e64 6976 6964 7561 6c73       individuals
-0003ec40: 2069 6e20 7468 6520 7472 6565 2073 6571   in the tree seq
-0003ec50: 7565 6e63 6520 6973 206d 6f72 6520 726f  uence is more ro
-0003ec60: 6275 7374 2c20 616e 6420 7369 6e63 6520  bust, and since 
-0003ec70: 7472 6565 0a20 2020 2020 2020 2020 2020  tree.           
-0003ec80: 7365 7175 656e 6365 7320 6e6f 7720 2074  sequences now  t
-0003ec90: 7970 6963 616c 6c79 2063 6f6e 7461 696e  ypically contain
-0003eca0: 2069 6e64 6976 6964 7561 6c73 2028 652e   individuals (e.
-0003ecb0: 672e 2c20 6173 2070 726f 6475 6365 6420  g., as produced 
-0003ecc0: 6279 0a20 2020 2020 2020 2020 2020 6060  by.           ``
-0003ecd0: 6d73 7072 696d 652e 7369 6d5f 616e 6365  msprime.sim_ance
-0003ece0: 7374 7279 2820 2960 6029 2c20 7468 6973  stry( )``), this
-0003ecf0: 2069 7320 6e6f 7420 6e65 6365 7373 6172   is not necessar
-0003ed00: 792c 2061 6e64 2074 6865 0a20 2020 2020  y, and the.     
-0003ed10: 2020 2020 2020 6060 706c 6f69 6479 6060        ``ploidy``
-0003ed20: 2061 7267 756d 656e 7420 6361 6e20 7361   argument can sa
-0003ed30: 6665 6c79 2062 6520 7265 6d6f 7665 6420  fely be removed 
-0003ed40: 6173 2070 6172 7420 6f66 2074 6865 2070  as part of the p
-0003ed50: 726f 6365 7373 0a20 2020 2020 2020 2020  rocess.         
-0003ed60: 2020 6f66 2075 7064 6174 696e 6720 6672    of updating fr
-0003ed70: 6f6d 2074 6865 206d 7370 7269 6d65 2030  om the msprime 0
-0003ed80: 2e78 206c 6567 6163 7920 4150 492e 0a0a  .x legacy API...
-0003ed90: 2020 2020 2020 2020 3a70 6172 616d 2069          :param i
-0003eda0: 6f2e 494f 4261 7365 206f 7574 7075 743a  o.IOBase output:
-0003edb0: 2054 6865 2066 696c 652d 6c69 6b65 206f   The file-like o
-0003edc0: 626a 6563 7420 746f 2077 7269 7465 2074  bject to write t
-0003edd0: 6865 2056 4346 206f 7574 7075 742e 0a20  he VCF output.. 
-0003ede0: 2020 2020 2020 203a 7061 7261 6d20 696e         :param in
-0003edf0: 7420 706c 6f69 6479 3a20 5468 6520 706c  t ploidy: The pl
-0003ee00: 6f69 6479 206f 6620 7468 6520 696e 6469  oidy of the indi
-0003ee10: 7669 6475 616c 7320 746f 2062 6520 7772  viduals to be wr
-0003ee20: 6974 7465 6e20 746f 0a20 2020 2020 2020  itten to.       
-0003ee30: 2020 2020 2056 4346 2e20 5468 6973 2073       VCF. This s
-0003ee40: 616d 706c 6520 7369 7a65 206d 7573 7420  ample size must 
-0003ee50: 6265 2065 7665 6e6c 7920 6469 7669 7369  be evenly divisi
-0003ee60: 626c 6520 6279 2070 6c6f 6964 792e 2043  ble by ploidy. C
-0003ee70: 616e 6e6f 7420 6265 0a20 2020 2020 2020  annot be.       
-0003ee80: 2020 2020 2075 7365 6420 6966 2074 6865       used if the
-0003ee90: 7265 2069 7320 696e 6469 7669 6475 616c  re is individual
-0003eea0: 2064 6174 6120 696e 2074 6865 2074 7265   data in the tre
-0003eeb0: 6520 7365 7175 656e 6365 2e0a 2020 2020  e sequence..    
-0003eec0: 2020 2020 3a70 6172 616d 2073 7472 2063      :param str c
-0003eed0: 6f6e 7469 675f 6964 3a20 5468 6520 7661  ontig_id: The va
-0003eee0: 6c75 6520 6f66 2074 6865 2043 4852 4f4d  lue of the CHROM
-0003eef0: 2063 6f6c 756d 6e20 696e 2074 6865 206f   column in the o
-0003ef00: 7574 7075 7420 5643 462e 0a20 2020 2020  utput VCF..     
-0003ef10: 2020 203a 7061 7261 6d20 6c69 7374 2869     :param list(i
-0003ef20: 6e74 2920 696e 6469 7669 6475 616c 733a  nt) individuals:
-0003ef30: 2041 206c 6973 7420 636f 6e74 6169 6e69   A list containi
-0003ef40: 6e67 2074 6865 2069 6e64 6976 6964 7561  ng the individua
-0003ef50: 6c20 4944 7320 746f 0a20 2020 2020 2020  l IDs to.       
-0003ef60: 2020 2020 2063 6f72 7265 7370 6f6e 6469       correspondi
-0003ef70: 6e67 2074 6f20 7468 6520 5643 4620 7361  ng to the VCF sa
-0003ef80: 6d70 6c65 732e 2044 6566 6175 6c74 7320  mples. Defaults 
-0003ef90: 746f 2061 6c6c 2069 6e64 6976 6964 7561  to all individua
-0003efa0: 6c73 0a20 2020 2020 2020 2020 2020 2061  ls.            a
-0003efb0: 7373 6f63 6961 7465 6420 7769 7468 2073  ssociated with s
-0003efc0: 616d 706c 6520 6e6f 6465 7320 696e 2074  ample nodes in t
-0003efd0: 6865 2074 7265 6520 7365 7175 656e 6365  he tree sequence
-0003efe0: 2e0a 2020 2020 2020 2020 2020 2020 5365  ..            Se
-0003eff0: 6520 7468 6520 7b72 6566 7d60 7365 635f  e the {ref}`sec_
-0003f000: 6578 706f 7274 5f76 6366 5f63 6f6e 7374  export_vcf_const
-0003f010: 7275 6374 696e 675f 6774 6020 7365 6374  ructing_gt` sect
-0003f020: 696f 6e20 666f 7220 6d6f 7265 0a20 2020  ion for more.   
-0003f030: 2020 2020 2020 2020 2064 6574 6169 6c73           details
-0003f040: 2061 6e64 2065 7861 6d70 6c65 732e 0a20   and examples.. 
-0003f050: 2020 2020 2020 203a 7061 7261 6d20 6c69         :param li
-0003f060: 7374 2873 7472 2920 696e 6469 7669 6475  st(str) individu
-0003f070: 616c 5f6e 616d 6573 3a20 4120 6c69 7374  al_names: A list
-0003f080: 206f 6620 7374 7269 6e67 206e 616d 6573   of string names
-0003f090: 2074 6f20 6964 656e 7469 6679 0a20 2020   to identify.   
-0003f0a0: 2020 2020 2020 2020 2069 6e64 6976 6964           individ
-0003f0b0: 7561 6c20 636f 6c75 6d6e 7320 696e 2074  ual columns in t
-0003f0c0: 6865 2056 4346 2e20 496e 2056 4346 206e  he VCF. In VCF n
-0003f0d0: 6f6d 656e 636c 6174 7572 652c 2074 6865  omenclature, the
-0003f0e0: 7365 2061 7265 2074 6865 0a20 2020 2020  se are the.     
-0003f0f0: 2020 2020 2020 2073 616d 706c 6520 4944         sample ID
-0003f100: 732e 2049 6620 7370 6563 6966 6965 642c  s. If specified,
-0003f110: 2074 6869 7320 6d75 7374 2062 6520 6120   this must be a 
-0003f120: 6c69 7374 206f 6620 7374 7269 6e67 7320  list of strings 
-0003f130: 6f66 0a20 2020 2020 2020 2020 2020 206c  of.            l
-0003f140: 656e 6774 6820 6571 7561 6c20 746f 2074  ength equal to t
-0003f150: 6865 206e 756d 6265 7220 6f66 2069 6e64  he number of ind
-0003f160: 6976 6964 7561 6c73 2074 6f20 6265 206f  ividuals to be o
-0003f170: 7574 7075 742e 204e 6f74 6520 7468 6174  utput. Note that
-0003f180: 0a20 2020 2020 2020 2020 2020 2077 6520  .            we 
-0003f190: 646f 206e 6f74 2063 6865 636b 2074 6865  do not check the
-0003f1a0: 2066 6f72 6d20 6f66 2074 6865 7365 2073   form of these s
-0003f1b0: 7472 696e 6773 2069 6e20 616e 7920 7761  trings in any wa
-0003f1c0: 792c 2073 6f20 7468 6174 2069 730a 2020  y, so that is.  
-0003f1d0: 2020 2020 2020 2020 2020 6973 2070 6f73            is pos
-0003f1e0: 7369 626c 6520 746f 206f 7574 7075 7420  sible to output 
-0003f1f0: 6d61 6c66 6f72 6d65 6420 5643 4620 2866  malformed VCF (f
-0003f200: 6f72 2065 7861 6d70 6c65 2c20 6279 2065  or example, by e
-0003f210: 6d62 6564 6469 6e67 2061 0a20 2020 2020  mbedding a.     
-0003f220: 2020 2020 2020 2074 6162 2063 6861 7261         tab chara
-0003f230: 6374 6572 2077 6974 6869 6e20 6f6e 206f  cter within on o
-0003f240: 6620 7468 6520 6e61 6d65 7329 2e20 5468  f the names). Th
-0003f250: 6520 6465 6661 756c 7420 6973 2074 6f20  e default is to 
-0003f260: 6f75 7470 7574 0a20 2020 2020 2020 2020  output.         
-0003f270: 2020 2060 6074 736b 5f6a 6060 2066 6f72     ``tsk_j`` for
-0003f280: 2074 6865 206a 7468 2069 6e64 6976 6964   the jth individ
-0003f290: 7561 6c2e 0a20 2020 2020 2020 2020 2020  ual..           
-0003f2a0: 2053 6565 2074 6865 203a 7265 663a 6073   See the :ref:`s
-0003f2b0: 6563 5f65 7870 6f72 745f 7663 665f 696e  ec_export_vcf_in
-0003f2c0: 6469 7669 6475 616c 5f6e 616d 6573 6020  dividual_names` 
-0003f2d0: 666f 7220 6578 616d 706c 6573 0a20 2020  for examples.   
-0003f2e0: 2020 2020 2020 2020 2061 6e64 206d 6f72           and mor
-0003f2f0: 6520 696e 666f 726d 6174 696f 6e2e 0a20  e information.. 
-0003f300: 2020 2020 2020 203a 7061 7261 6d20 706f         :param po
-0003f310: 7369 7469 6f6e 5f74 7261 6e73 666f 726d  sition_transform
-0003f320: 3a20 4120 6361 6c6c 6162 6c65 2074 6861  : A callable tha
-0003f330: 7420 7472 616e 7366 6f72 6d73 2074 6865  t transforms the
-0003f340: 0a20 2020 2020 2020 2020 2020 2073 6974  .            sit
-0003f350: 6520 706f 7369 7469 6f6e 2076 616c 7565  e position value
-0003f360: 7320 696e 746f 2069 6e74 6567 6572 2076  s into integer v
-0003f370: 616c 7565 6420 636f 6f72 6469 6e61 7465  alued coordinate
-0003f380: 7320 7375 6974 6162 6c65 2066 6f72 0a20  s suitable for. 
-0003f390: 2020 2020 2020 2020 2020 2056 4346 2e20             VCF. 
-0003f3a0: 5468 6520 6675 6e63 7469 6f6e 2074 616b  The function tak
-0003f3b0: 6573 2061 2073 696e 676c 6520 706f 7369  es a single posi
-0003f3c0: 7469 6f6e 616c 2070 6172 616d 6574 6572  tional parameter
-0003f3d0: 2078 2061 6e64 206d 7573 740a 2020 2020   x and must.    
-0003f3e0: 2020 2020 2020 2020 7265 7475 726e 2061          return a
-0003f3f0: 6e20 696e 7465 6765 7220 6e75 6d70 7920  n integer numpy 
-0003f400: 6172 7261 7920 7468 6520 7361 6d65 2064  array the same d
-0003f410: 696d 656e 7369 6f6e 2061 7320 782e 2042  imension as x. B
-0003f420: 7920 6465 6661 756c 742c 0a20 2020 2020  y default,.     
-0003f430: 2020 2020 2020 2074 6869 7320 6973 2073         this is s
-0003f440: 6574 2074 6f20 6060 6e75 6d70 792e 726f  et to ``numpy.ro
-0003f450: 756e 6428 2960 6020 7768 6963 6820 7769  und()`` which wi
-0003f460: 6c6c 2072 6f75 6e64 2076 616c 7565 7320  ll round values 
-0003f470: 746f 2074 6865 0a20 2020 2020 2020 2020  to the.         
-0003f480: 2020 206e 6561 7265 7374 2069 6e74 6567     nearest integ
-0003f490: 6572 2e20 4966 2074 6865 2073 7472 696e  er. If the strin
-0003f4a0: 6720 226c 6567 6163 7922 2069 7320 7072  g "legacy" is pr
-0003f4b0: 6f76 6964 6564 2068 6572 652c 2074 6865  ovided here, the
-0003f4c0: 0a20 2020 2020 2020 2020 2020 2070 7265  .            pre
-0003f4d0: 2030 2e32 2e30 206c 6567 6163 7920 6265   0.2.0 legacy be
-0003f4e0: 6861 7669 6f75 7220 6f66 2072 6f75 6e64  haviour of round
-0003f4f0: 696e 6720 7661 6c75 6573 2074 6f20 7468  ing values to th
-0003f500: 6520 6e65 6172 6573 7420 696e 7465 6765  e nearest intege
-0003f510: 720a 2020 2020 2020 2020 2020 2020 2873  r.            (s
-0003f520: 7461 7274 696e 6720 6672 6f6d 2031 2920  tarting from 1) 
-0003f530: 616e 6420 6176 6f69 6469 6e67 2074 6865  and avoiding the
-0003f540: 206f 7574 7075 7420 6f66 2069 6465 6e74   output of ident
-0003f550: 6963 616c 2070 6f73 6974 696f 6e73 0a20  ical positions. 
-0003f560: 2020 2020 2020 2020 2020 2062 7920 696e             by in
-0003f570: 6372 656d 656e 7469 6e67 2069 7320 7573  crementing is us
-0003f580: 6564 2e0a 2020 2020 2020 2020 2020 2020  ed..            
-0003f590: 5365 6520 7468 6520 3a72 6566 3a60 7365  See the :ref:`se
-0003f5a0: 635f 6578 706f 7274 5f76 6366 5f6d 6f64  c_export_vcf_mod
-0003f5b0: 6966 7969 6e67 5f63 6f6f 7264 696e 6174  ifying_coordinat
-0003f5c0: 6573 6020 666f 7220 6578 616d 706c 6573  es` for examples
-0003f5d0: 0a20 2020 2020 2020 2020 2020 2061 6e64  .            and
-0003f5e0: 206d 6f72 6520 696e 666f 726d 6174 696f   more informatio
-0003f5f0: 6e2e 0a20 2020 2020 2020 203a 7061 7261  n..        :para
-0003f600: 6d20 7369 7465 5f6d 6173 6b3a 2041 206e  m site_mask: A n
-0003f610: 756d 7079 2062 6f6f 6c65 616e 2061 7272  umpy boolean arr
-0003f620: 6179 2028 6f72 2073 6f6d 6574 6869 6e67  ay (or something
-0003f630: 2063 6f6e 7665 7274 6162 6c65 2074 6f0a   convertable to.
-0003f640: 2020 2020 2020 2020 2020 2020 6120 6e75              a nu
-0003f650: 6d70 7920 626f 6f6c 6561 6e20 6172 7261  mpy boolean arra
-0003f660: 7929 2077 6974 6820 6e75 6d5f 7369 7465  y) with num_site
-0003f670: 7320 656c 656d 656e 7473 2c20 7573 6564  s elements, used
-0003f680: 2074 6f20 6d61 736b 206f 7574 0a20 2020   to mask out.   
-0003f690: 2020 2020 2020 2020 2073 6974 6573 2069           sites i
-0003f6a0: 6e20 7468 6520 6f75 7470 7574 2e20 4966  n the output. If
-0003f6b0: 2020 6060 7369 7465 5f6d 6173 6b5b 6a5d    ``site_mask[j]
-0003f6c0: 6060 2069 7320 5472 7565 2c20 7468 656e  `` is True, then
-0003f6d0: 2074 6869 730a 2020 2020 2020 2020 2020   this.          
-0003f6e0: 2020 7369 7465 2028 692e 652e 2c20 7468    site (i.e., th
-0003f6f0: 6520 6c69 6e65 2069 6e20 7468 6520 5643  e line in the VC
-0003f700: 4620 6669 6c65 2920 7769 6c6c 2062 6520  F file) will be 
-0003f710: 6f6d 6974 7465 642e 0a20 2020 2020 2020  omitted..       
-0003f720: 2020 2020 2053 6565 2074 6865 203a 7265       See the :re
-0003f730: 663a 6073 6563 5f65 7870 6f72 745f 7663  f:`sec_export_vc
-0003f740: 665f 6d61 736b 696e 675f 6f75 7470 7574  f_masking_output
-0003f750: 6020 666f 7220 6578 616d 706c 6573 0a20  ` for examples. 
-0003f760: 2020 2020 2020 2020 2020 2061 6e64 206d             and m
-0003f770: 6f72 6520 696e 666f 726d 6174 696f 6e2e  ore information.
-0003f780: 0a20 2020 2020 2020 203a 7061 7261 6d20  .        :param 
-0003f790: 7361 6d70 6c65 5f6d 6173 6b3a 2041 206e  sample_mask: A n
-0003f7a0: 756d 7079 2062 6f6f 6c65 616e 2061 7272  umpy boolean arr
-0003f7b0: 6179 2028 6f72 2073 6f6d 6574 6869 6e67  ay (or something
-0003f7c0: 2063 6f6e 7665 7274 6162 6c65 2074 6f0a   convertable to.
-0003f7d0: 2020 2020 2020 2020 2020 2020 6120 6e75              a nu
-0003f7e0: 6d70 7920 626f 6f6c 6561 6e20 6172 7261  mpy boolean arra
-0003f7f0: 7929 2077 6974 6820 6e75 6d5f 7361 6d70  y) with num_samp
-0003f800: 6c65 7320 656c 656d 656e 7473 2c20 6f72  les elements, or
-0003f810: 2061 2063 616c 6c61 626c 650a 2020 2020   a callable.    
-0003f820: 2020 2020 2020 2020 7468 6174 2072 6574          that ret
-0003f830: 7572 6e73 2073 7563 6820 616e 2061 7272  urns such an arr
-0003f840: 6179 2c20 7375 6368 2074 6861 7420 6966  ay, such that if
-0003f850: 0a20 2020 2020 2020 2020 2020 2060 6073  .            ``s
-0003f860: 616d 706c 655f 6d61 736b 5b6a 5d60 6020  ample_mask[j]`` 
-0003f870: 6973 2054 7275 652c 2074 6865 6e20 7468  is True, then th
-0003f880: 6520 6765 6e6f 7479 7065 2066 6f72 2073  e genotype for s
-0003f890: 616d 706c 6520 6060 6a60 600a 2020 2020  ample ``j``.    
-0003f8a0: 2020 2020 2020 2020 7769 6c6c 2062 6520          will be 
-0003f8b0: 6d61 726b 6564 2061 7320 6d69 7373 696e  marked as missin
-0003f8c0: 6720 7573 696e 6720 6120 222e 222e 2049  g using a ".". I
-0003f8d0: 6620 6060 7361 6d70 6c65 5f6d 6173 6b60  f ``sample_mask`
-0003f8e0: 6020 6973 2061 0a20 2020 2020 2020 2020  ` is a.         
-0003f8f0: 2020 2063 616c 6c61 626c 652c 2069 7420     callable, it 
-0003f900: 6d75 7374 2074 616b 6520 6120 7369 6e67  must take a sing
-0003f910: 6c65 2061 7267 756d 656e 7420 616e 6420  le argument and 
-0003f920: 7265 7475 726e 2061 2062 6f6f 6c65 616e  return a boolean
-0003f930: 0a20 2020 2020 2020 2020 2020 206e 756d  .            num
-0003f940: 7079 2061 7272 6179 2e20 5468 6973 2066  py array. This f
-0003f950: 756e 6374 696f 6e20 7769 6c6c 2062 6520  unction will be 
-0003f960: 6361 6c6c 6564 2066 6f72 2065 6163 6820  called for each 
-0003f970: 2875 6e6d 6173 6b65 6429 2073 6974 650a  (unmasked) site.
-0003f980: 2020 2020 2020 2020 2020 2020 7769 7468              with
-0003f990: 2074 6865 2063 6f72 7265 7370 6f6e 6469   the correspondi
-0003f9a0: 6e67 203a 636c 6173 733a 602e 5661 7269  ng :class:`.Vari
-0003f9b0: 616e 7460 206f 626a 6563 742c 2061 6c6c  ant` object, all
-0003f9c0: 6f77 696e 670a 2020 2020 2020 2020 2020  owing.          
-0003f9d0: 2020 666f 7220 6479 6e61 6d69 6320 6d61    for dynamic ma
-0003f9e0: 736b 7320 746f 2062 6520 6765 6e65 7261  sks to be genera
-0003f9f0: 7465 642e 0a20 2020 2020 2020 2020 2020  ted..           
-0003fa00: 2053 6565 2074 6865 203a 7265 663a 6073   See the :ref:`s
-0003fa10: 6563 5f65 7870 6f72 745f 7663 665f 6d61  ec_export_vcf_ma
-0003fa20: 736b 696e 675f 6f75 7470 7574 6020 666f  sking_output` fo
-0003fa30: 7220 6578 616d 706c 6573 0a20 2020 2020  r examples.     
-0003fa40: 2020 2020 2020 2061 6e64 206d 6f72 6520         and more 
-0003fa50: 696e 666f 726d 6174 696f 6e2e 0a20 2020  information..   
-0003fa60: 2020 2020 203a 7061 7261 6d20 626f 6f6c       :param bool
-0003fa70: 2069 736f 6c61 7465 645f 6173 5f6d 6973   isolated_as_mis
-0003fa80: 7369 6e67 3a20 4966 2054 7275 652c 2074  sing: If True, t
-0003fa90: 6865 2067 656e 6f74 7970 6520 7661 6c75  he genotype valu
-0003faa0: 6520 6173 7369 676e 6564 2074 6f0a 2020  e assigned to.  
-0003fab0: 2020 2020 2020 2020 2020 6d69 7373 696e            missin
-0003fac0: 6720 7361 6d70 6c65 7320 2869 2e65 2e2c  g samples (i.e.,
-0003fad0: 2069 736f 6c61 7465 6420 7361 6d70 6c65   isolated sample
-0003fae0: 7320 7769 7468 6f75 7420 6d75 7461 7469  s without mutati
-0003faf0: 6f6e 7329 2069 7320 222e 220a 2020 2020  ons) is ".".    
-0003fb00: 2020 2020 2020 2020 4966 2046 616c 7365          If False
-0003fb10: 2c20 6d69 7373 696e 6720 7361 6d70 6c65  , missing sample
-0003fb20: 7320 7769 6c6c 2062 6520 6173 7369 676e  s will be assign
-0003fb30: 6564 2074 6865 2061 6e63 6573 7472 616c  ed the ancestral
-0003fb40: 2061 6c6c 656c 652e 0a20 2020 2020 2020   allele..       
-0003fb50: 2020 2020 2053 6565 203a 6d65 7468 3a60       See :meth:`
-0003fb60: 2e76 6172 6961 6e74 7360 2066 6f72 206d  .variants` for m
-0003fb70: 6f72 6520 696e 666f 726d 6174 696f 6e2e  ore information.
-0003fb80: 2044 6566 6175 6c74 3a20 5472 7565 2e0a   Default: True..
-0003fb90: 2020 2020 2020 2020 2222 220a 2020 2020          """.    
-0003fba0: 2020 2020 7772 6974 6572 203d 2076 6366      writer = vcf
-0003fbb0: 2e56 6366 5772 6974 6572 280a 2020 2020  .VcfWriter(.    
-0003fbc0: 2020 2020 2020 2020 7365 6c66 2c0a 2020          self,.  
-0003fbd0: 2020 2020 2020 2020 2020 706c 6f69 6479            ploidy
-0003fbe0: 3d70 6c6f 6964 792c 0a20 2020 2020 2020  =ploidy,.       
-0003fbf0: 2020 2020 2063 6f6e 7469 675f 6964 3d63       contig_id=c
-0003fc00: 6f6e 7469 675f 6964 2c0a 2020 2020 2020  ontig_id,.      
-0003fc10: 2020 2020 2020 696e 6469 7669 6475 616c        individual
-0003fc20: 733d 696e 6469 7669 6475 616c 732c 0a20  s=individuals,. 
-0003fc30: 2020 2020 2020 2020 2020 2069 6e64 6976             indiv
-0003fc40: 6964 7561 6c5f 6e61 6d65 733d 696e 6469  idual_names=indi
-0003fc50: 7669 6475 616c 5f6e 616d 6573 2c0a 2020  vidual_names,.  
-0003fc60: 2020 2020 2020 2020 2020 706f 7369 7469            positi
-0003fc70: 6f6e 5f74 7261 6e73 666f 726d 3d70 6f73  on_transform=pos
-0003fc80: 6974 696f 6e5f 7472 616e 7366 6f72 6d2c  ition_transform,
-0003fc90: 0a20 2020 2020 2020 2020 2020 2073 6974  .            sit
-0003fca0: 655f 6d61 736b 3d73 6974 655f 6d61 736b  e_mask=site_mask
-0003fcb0: 2c0a 2020 2020 2020 2020 2020 2020 7361  ,.            sa
-0003fcc0: 6d70 6c65 5f6d 6173 6b3d 7361 6d70 6c65  mple_mask=sample
-0003fcd0: 5f6d 6173 6b2c 0a20 2020 2020 2020 2020  _mask,.         
-0003fce0: 2020 2069 736f 6c61 7465 645f 6173 5f6d     isolated_as_m
-0003fcf0: 6973 7369 6e67 3d69 736f 6c61 7465 645f  issing=isolated_
-0003fd00: 6173 5f6d 6973 7369 6e67 2c0a 2020 2020  as_missing,.    
-0003fd10: 2020 2020 290a 2020 2020 2020 2020 7772      ).        wr
-0003fd20: 6974 6572 2e77 7269 7465 286f 7574 7075  iter.write(outpu
-0003fd30: 7429 0a0a 2020 2020 6465 6620 7772 6974  t)..    def writ
-0003fd40: 655f 6661 7374 6128 0a20 2020 2020 2020  e_fasta(.       
-0003fd50: 2073 656c 662c 0a20 2020 2020 2020 2066   self,.        f
-0003fd60: 696c 655f 6f72 5f70 6174 682c 0a20 2020  ile_or_path,.   
-0003fd70: 2020 2020 202a 2c0a 2020 2020 2020 2020       *,.        
-0003fd80: 7772 6170 5f77 6964 7468 3d36 302c 0a20  wrap_width=60,. 
-0003fd90: 2020 2020 2020 2072 6566 6572 656e 6365         reference
-0003fda0: 5f73 6571 7565 6e63 653d 4e6f 6e65 2c0a  _sequence=None,.
-0003fdb0: 2020 2020 2020 2020 6d69 7373 696e 675f          missing_
-0003fdc0: 6461 7461 5f63 6861 7261 6374 6572 3d4e  data_character=N
-0003fdd0: 6f6e 652c 0a20 2020 2029 3a0a 2020 2020  one,.    ):.    
-0003fde0: 2020 2020 2222 220a 2020 2020 2020 2020      """.        
-0003fdf0: 5772 6974 6573 2074 6865 203a 6d65 7468  Writes the :meth
-0003fe00: 3a60 2e61 6c69 676e 6d65 6e74 7360 2066  :`.alignments` f
-0003fe10: 6f72 2074 6869 7320 7472 6565 2073 6571  or this tree seq
-0003fe20: 7565 6e63 6520 746f 2066 696c 6520 696e  uence to file in
-0003fe30: 0a20 2020 2020 2020 2060 4641 5354 4120  .        `FASTA 
-0003fe40: 3c68 7474 7073 3a2f 2f65 6e2e 7769 6b69  <https://en.wiki
-0003fe50: 7065 6469 612e 6f72 672f 7769 6b69 2f46  pedia.org/wiki/F
-0003fe60: 4153 5441 5f66 6f72 6d61 743e 605f 5f20  ASTA_format>`__ 
-0003fe70: 666f 726d 6174 2e0a 2020 2020 2020 2020  format..        
-0003fe80: 506c 6561 7365 2073 6565 2074 6865 203a  Please see the :
-0003fe90: 6d65 7468 3a60 2e61 6c69 676e 6d65 6e74  meth:`.alignment
-0003fea0: 7360 206d 6574 686f 6420 666f 7220 6465  s` method for de
-0003feb0: 7461 696c 7320 6f6e 2068 6f77 0a20 2020  tails on how.   
-0003fec0: 2020 2020 2072 6566 6572 656e 6365 2073       reference s
-0003fed0: 6571 7565 6e63 6573 2061 7265 2068 616e  equences are han
-0003fee0: 646c 6564 2e0a 0a20 2020 2020 2020 2041  dled...        A
-0003fef0: 6c69 676e 6d65 6e74 7320 6172 6520 7265  lignments are re
-0003ff00: 7475 726e 6564 2066 6f72 2074 6865 0a20  turned for the. 
-0003ff10: 2020 2020 2020 203a 7265 663a 6073 616d         :ref:`sam
-0003ff20: 706c 6520 6e6f 6465 733c 7365 635f 6461  ple nodes<sec_da
-0003ff30: 7461 5f6d 6f64 656c 5f64 6566 696e 6974  ta_model_definit
-0003ff40: 696f 6e73 3e60 2069 6e20 7468 6973 2074  ions>` in this t
-0003ff50: 7265 650a 2020 2020 2020 2020 7365 7175  ree.        sequ
-0003ff60: 656e 6365 2c20 616e 6420 6120 7361 6d70  ence, and a samp
-0003ff70: 6c65 2077 6974 6820 6e6f 6465 2069 6420  le with node id 
-0003ff80: 6060 7560 6020 6973 2067 6976 656e 2074  ``u`` is given t
-0003ff90: 6865 206c 6162 656c 0a20 2020 2020 2020  he label.       
-0003ffa0: 2060 6066 226e 7b75 7d22 6060 2c20 666f   ``f"n{u}"``, fo
-0003ffb0: 6c6c 6f77 696e 6720 7468 6520 7361 6d65  llowing the same
-0003ffc0: 2063 6f6e 7665 6e74 696f 6e20 6173 2074   convention as t
-0003ffd0: 6865 0a20 2020 2020 2020 203a 6d65 7468  he.        :meth
-0003ffe0: 3a60 2e77 7269 7465 5f6e 6578 7573 6020  :`.write_nexus` 
-0003fff0: 616e 6420 3a6d 6574 683a 6054 7265 652e  and :meth:`Tree.
-00040000: 6173 5f6e 6577 6963 6b60 206d 6574 686f  as_newick` metho
-00040010: 6473 2e0a 0a20 2020 2020 2020 2054 6865  ds...        The
-00040020: 2060 6077 7261 705f 7769 6474 6860 6020   ``wrap_width`` 
-00040030: 7061 7261 6d65 7465 7220 636f 6e74 726f  parameter contro
-00040040: 6c73 2074 6865 206d 6178 696d 756d 2077  ls the maximum w
-00040050: 6964 7468 206f 6620 6c69 6e65 730a 2020  idth of lines.  
-00040060: 2020 2020 2020 6f66 2073 6571 7565 6e63        of sequenc
-00040070: 6520 6461 7461 2069 6e20 7468 6520 6f75  e data in the ou
-00040080: 7470 7574 2e20 4279 2064 6566 6175 6c74  tput. By default
-00040090: 2074 6869 7320 6973 2036 300a 2020 2020   this is 60.    
-000400a0: 2020 2020 6368 6172 6163 7465 7273 2069      characters i
-000400b0: 6e20 6163 636f 7264 616e 6365 2077 6974  n accordance wit
-000400c0: 6820 6661 7374 6120 7374 616e 6461 7264  h fasta standard
-000400d0: 206f 7574 7075 7473 2e20 546f 2074 7572   outputs. To tur
-000400e0: 6e20 6f66 660a 2020 2020 2020 2020 6c69  n off.        li
-000400f0: 6e65 2d77 7261 7070 696e 6720 6f66 2073  ne-wrapping of s
-00040100: 6571 7565 6e63 6573 2c20 7365 7420 6060  equences, set ``
-00040110: 7772 6170 5f77 6964 7468 6060 203d 2030  wrap_width`` = 0
-00040120: 2e0a 0a20 2020 2020 2020 2045 7861 6d70  ...        Examp
-00040130: 6c65 2075 7361 6765 3a0a 0a20 2020 2020  le usage:..     
-00040140: 2020 202e 2e20 636f 6465 2d62 6c6f 636b     .. code-block
-00040150: 3a3a 2070 7974 686f 6e0a 0a20 2020 2020  :: python..     
-00040160: 2020 2020 2020 2074 732e 7772 6974 655f         ts.write_
-00040170: 6661 7374 6128 226f 7574 7075 742e 6661  fasta("output.fa
-00040180: 2229 0a0a 2020 2020 2020 2020 2e2e 2077  ")..        .. w
-00040190: 6172 6e69 6e67 3a3a 203a 7265 663a 604d  arning:: :ref:`M
-000401a0: 6973 7369 6e67 2064 6174 613c 7365 635f  issing data<sec_
-000401b0: 6461 7461 5f6d 6f64 656c 5f6d 6973 7369  data_model_missi
-000401c0: 6e67 5f64 6174 613e 6020 6973 206e 6f74  ng_data>` is not
-000401d0: 0a20 2020 2020 2020 2020 2020 2063 7572  .            cur
-000401e0: 7265 6e74 6c79 2073 7570 706f 7274 6564  rently supported
-000401f0: 2062 7920 7468 6973 206d 6574 686f 6420   by this method 
-00040200: 616e 6420 6974 2077 696c 6c20 7261 6973  and it will rais
-00040210: 6520 6120 5661 6c75 6545 7272 6f72 0a20  e a ValueError. 
-00040220: 2020 2020 2020 2020 2020 2069 6620 6361             if ca
-00040230: 6c6c 6564 206f 6e20 7472 6565 2073 6571  lled on tree seq
-00040240: 7565 6e63 6573 2063 6f6e 7461 696e 696e  uences containin
-00040250: 6720 6973 6f6c 6174 6564 2073 616d 706c  g isolated sampl
-00040260: 6573 2e0a 2020 2020 2020 2020 2020 2020  es..            
-00040270: 5365 6520 6874 7470 733a 2f2f 6769 7468  See https://gith
-00040280: 7562 2e63 6f6d 2f74 736b 6974 2d64 6576  ub.com/tskit-dev
-00040290: 2f74 736b 6974 2f69 7373 7565 732f 3138  /tskit/issues/18
-000402a0: 3936 2066 6f72 206d 6f72 650a 2020 2020  96 for more.    
-000402b0: 2020 2020 2020 2020 696e 666f 726d 6174          informat
-000402c0: 696f 6e2e 0a0a 2020 2020 2020 2020 3a70  ion...        :p
-000402d0: 6172 616d 2066 696c 655f 6f72 5f70 6174  aram file_or_pat
-000402e0: 683a 2054 6865 2066 696c 6520 6f62 6a65  h: The file obje
-000402f0: 6374 206f 7220 7061 7468 2074 6f20 7772  ct or path to wr
-00040300: 6974 6520 7468 6520 6f75 7470 7574 2e0a  ite the output..
-00040310: 2020 2020 2020 2020 2020 2020 5061 7468              Path
-00040320: 7320 6361 6e20 6265 2065 6974 6865 7220  s can be either 
-00040330: 7374 7269 6e67 7320 6f72 203a 636c 6173  strings or :clas
-00040340: 733a 6070 7974 686f 6e3a 7061 7468 6c69  s:`python:pathli
-00040350: 622e 5061 7468 6020 6f62 6a65 6374 732e  b.Path` objects.
-00040360: 0a20 2020 2020 2020 203a 7061 7261 6d20  .        :param 
-00040370: 696e 7420 7772 6170 5f77 6964 7468 3a20  int wrap_width: 
-00040380: 5468 6520 6e75 6d62 6572 206f 6620 7365  The number of se
-00040390: 7175 656e 6365 0a20 2020 2020 2020 2020  quence.         
-000403a0: 2020 2063 6861 7261 6374 6572 7320 746f     characters to
-000403b0: 2069 6e63 6c75 6465 206f 6e20 6561 6368   include on each
-000403c0: 206c 696e 6520 696e 2074 6865 2066 6173   line in the fas
-000403d0: 7461 2066 696c 652c 2062 6566 6f72 6520  ta file, before 
-000403e0: 7772 6170 7069 6e67 0a20 2020 2020 2020  wrapping.       
-000403f0: 2020 2020 2074 6f20 7468 6520 6e65 7874       to the next
-00040400: 206c 696e 6520 666f 7220 6561 6368 2073   line for each s
-00040410: 6571 7565 6e63 652c 206f 7220 3020 746f  equence, or 0 to
-00040420: 2074 7572 6e20 6f66 6620 6c69 6e65 2077   turn off line w
-00040430: 7261 7070 696e 672e 0a20 2020 2020 2020  rapping..       
-00040440: 2020 2020 2028 4465 6661 756c 743d 3630       (Default=60
-00040450: 292e 0a20 2020 2020 2020 203a 7061 7261  )..        :para
-00040460: 6d20 7374 7220 7265 6665 7265 6e63 655f  m str reference_
-00040470: 7365 7175 656e 6365 3a20 4173 2066 6f72  sequence: As for
-00040480: 2074 6865 203a 6d65 7468 3a60 2e61 6c69   the :meth:`.ali
-00040490: 676e 6d65 6e74 7360 206d 6574 686f 642e  gnments` method.
-000404a0: 0a20 2020 2020 2020 203a 7061 7261 6d20  .        :param 
-000404b0: 7374 7220 6d69 7373 696e 675f 6461 7461  str missing_data
-000404c0: 5f63 6861 7261 6374 6572 3a20 4173 2066  _character: As f
-000404d0: 6f72 2074 6865 203a 6d65 7468 3a60 2e61  or the :meth:`.a
-000404e0: 6c69 676e 6d65 6e74 7360 206d 6574 686f  lignments` metho
-000404f0: 642e 0a20 2020 2020 2020 2022 2222 0a20  d..        """. 
-00040500: 2020 2020 2020 2074 6578 745f 666f 726d         text_form
-00040510: 6174 732e 7772 6974 655f 6661 7374 6128  ats.write_fasta(
-00040520: 0a20 2020 2020 2020 2020 2020 2073 656c  .            sel
-00040530: 662c 0a20 2020 2020 2020 2020 2020 2066  f,.            f
-00040540: 696c 655f 6f72 5f70 6174 682c 0a20 2020  ile_or_path,.   
-00040550: 2020 2020 2020 2020 2077 7261 705f 7769           wrap_wi
-00040560: 6474 683d 7772 6170 5f77 6964 7468 2c0a  dth=wrap_width,.
-00040570: 2020 2020 2020 2020 2020 2020 7265 6665              refe
-00040580: 7265 6e63 655f 7365 7175 656e 6365 3d72  rence_sequence=r
-00040590: 6566 6572 656e 6365 5f73 6571 7565 6e63  eference_sequenc
-000405a0: 652c 0a20 2020 2020 2020 2020 2020 206d  e,.            m
-000405b0: 6973 7369 6e67 5f64 6174 615f 6368 6172  issing_data_char
-000405c0: 6163 7465 723d 6d69 7373 696e 675f 6461  acter=missing_da
-000405d0: 7461 5f63 6861 7261 6374 6572 2c0a 2020  ta_character,.  
-000405e0: 2020 2020 2020 290a 0a20 2020 2064 6566        )..    def
-000405f0: 2061 735f 6661 7374 6128 7365 6c66 2c20   as_fasta(self, 
-00040600: 2a2a 6b77 6172 6773 293a 0a20 2020 2020  **kwargs):.     
-00040610: 2020 2022 2222 0a20 2020 2020 2020 2052     """.        R
-00040620: 6574 7572 6e20 7468 6520 7265 7375 6c74  eturn the result
-00040630: 206f 6620 3a6d 6574 683a 602e 7772 6974   of :meth:`.writ
-00040640: 655f 6661 7374 6160 2061 7320 6120 7374  e_fasta` as a st
-00040650: 7269 6e67 2e0a 2020 2020 2020 2020 4b65  ring..        Ke
-00040660: 7977 6f72 6420 7061 7261 6d65 7465 7273  yword parameters
-00040670: 2061 7265 2061 7320 6465 6669 6e65 6420   are as defined 
-00040680: 696e 203a 6d65 7468 3a60 2e77 7269 7465  in :meth:`.write
-00040690: 5f66 6173 7461 602e 0a0a 2020 2020 2020  _fasta`...      
-000406a0: 2020 3a72 6574 7572 6e3a 2041 2046 4153    :return: A FAS
-000406b0: 5441 2065 6e63 6f64 696e 6720 6f66 2074  TA encoding of t
-000406c0: 6865 2061 6c69 676e 6d65 6e74 7320 696e  he alignments in
-000406d0: 2074 6869 7320 7472 6565 2073 6571 7565   this tree seque
-000406e0: 6e63 6520 6173 2061 2073 7472 696e 672e  nce as a string.
-000406f0: 0a20 2020 2020 2020 203a 7274 7970 653a  .        :rtype:
-00040700: 2073 7472 0a20 2020 2020 2020 2022 2222   str.        """
-00040710: 0a20 2020 2020 2020 2062 7566 6620 3d20  .        buff = 
-00040720: 696f 2e53 7472 696e 6749 4f28 290a 2020  io.StringIO().  
-00040730: 2020 2020 2020 7365 6c66 2e77 7269 7465        self.write
-00040740: 5f66 6173 7461 2862 7566 662c 202a 2a6b  _fasta(buff, **k
-00040750: 7761 7267 7329 0a20 2020 2020 2020 2072  wargs).        r
-00040760: 6574 7572 6e20 6275 6666 2e67 6574 7661  eturn buff.getva
-00040770: 6c75 6528 290a 0a20 2020 2064 6566 2077  lue()..    def w
-00040780: 7269 7465 5f6e 6578 7573 280a 2020 2020  rite_nexus(.    
-00040790: 2020 2020 7365 6c66 2c0a 2020 2020 2020      self,.      
-000407a0: 2020 6669 6c65 5f6f 725f 7061 7468 2c0a    file_or_path,.
-000407b0: 2020 2020 2020 2020 2a2c 0a20 2020 2020          *,.     
-000407c0: 2020 2070 7265 6369 7369 6f6e 3d4e 6f6e     precision=Non
-000407d0: 652c 0a20 2020 2020 2020 2069 6e63 6c75  e,.        inclu
-000407e0: 6465 5f74 7265 6573 3d4e 6f6e 652c 0a20  de_trees=None,. 
-000407f0: 2020 2020 2020 2069 6e63 6c75 6465 5f61         include_a
-00040800: 6c69 676e 6d65 6e74 733d 4e6f 6e65 2c0a  lignments=None,.
-00040810: 2020 2020 2020 2020 7265 6665 7265 6e63          referenc
-00040820: 655f 7365 7175 656e 6365 3d4e 6f6e 652c  e_sequence=None,
-00040830: 0a20 2020 2020 2020 206d 6973 7369 6e67  .        missing
-00040840: 5f64 6174 615f 6368 6172 6163 7465 723d  _data_character=
-00040850: 4e6f 6e65 2c0a 2020 2020 293a 0a20 2020  None,.    ):.   
-00040860: 2020 2020 2022 2222 0a20 2020 2020 2020       """.       
-00040870: 2052 6574 7572 6e73 2061 2060 6e65 7875   Returns a `nexu
-00040880: 7320 656e 636f 6469 6e67 203c 6874 7470  s encoding <http
-00040890: 733a 2f2f 656e 2e77 696b 6970 6564 6961  s://en.wikipedia
-000408a0: 2e6f 7267 2f77 696b 692f 4e65 7875 735f  .org/wiki/Nexus_
-000408b0: 6669 6c65 3e60 5f0a 2020 2020 2020 2020  file>`_.        
-000408c0: 6f66 2074 6869 7320 7472 6565 2073 6571  of this tree seq
-000408d0: 7565 6e63 652e 2042 7920 6465 6661 756c  uence. By defaul
-000408e0: 742c 2074 7265 6520 746f 706f 6c6f 6769  t, tree topologi
-000408f0: 6573 2061 7265 2069 6e63 6c75 6465 640a  es are included.
-00040900: 2020 2020 2020 2020 696e 2074 6865 206f          in the o
-00040910: 7574 7075 742c 2061 6e64 2073 6571 7565  utput, and seque
-00040920: 6e63 6520 6461 7461 2061 6c69 676e 6d65  nce data alignme
-00040930: 6e74 7320 6172 6520 696e 636c 7564 6564  nts are included
-00040940: 2062 7920 6465 6661 756c 740a 2020 2020   by default.    
-00040950: 2020 2020 6966 2074 6869 7320 7472 6565      if this tree
-00040960: 2073 6571 7565 6e63 6520 6861 7320 6469   sequence has di
-00040970: 7363 7265 7465 2067 656e 6f6d 6520 636f  screte genome co
-00040980: 6f72 6469 6e61 7465 7320 616e 6420 6f6e  ordinates and on
-00040990: 6520 6f72 0a20 2020 2020 2020 206d 6f72  e or.        mor
-000409a0: 6520 7369 7465 732e 2049 6e63 6c75 7369  e sites. Inclusi
-000409b0: 6f6e 206f 6620 7468 6573 6520 7365 6374  on of these sect
-000409c0: 696f 6e73 2063 616e 2062 6520 636f 6e74  ions can be cont
-000409d0: 726f 6c6c 6564 206d 616e 7561 6c6c 790a  rolled manually.
-000409e0: 2020 2020 2020 2020 7573 696e 6720 7468          using th
-000409f0: 6520 6060 696e 636c 7564 655f 7472 6565  e ``include_tree
-00040a00: 7360 6020 616e 6420 6060 696e 636c 7564  s`` and ``includ
-00040a10: 655f 616c 6967 6e6d 656e 7473 6060 2070  e_alignments`` p
-00040a20: 6172 616d 6574 6572 732e 0a0a 2020 2020  arameters...    
-00040a30: 2020 2020 5472 6565 2074 6f70 6f6c 6f67      Tree topolog
-00040a40: 6965 7320 616e 6420 6272 616e 6368 206c  ies and branch l
-00040a50: 656e 6774 6873 2061 7265 206c 6973 7465  engths are liste
-00040a60: 640a 2020 2020 2020 2020 7365 7175 656e  d.        sequen
-00040a70: 7469 616c 6c79 2069 6e20 7468 6520 5452  tially in the TR
-00040a80: 4545 5320 626c 6f63 6b20 616e 6420 7468  EES block and th
-00040a90: 6520 7370 6174 6961 6c20 6c6f 6361 7469  e spatial locati
-00040aa0: 6f6e 206f 6620 6561 6368 2074 7265 650a  on of each tree.
-00040ab0: 2020 2020 2020 2020 656e 636f 6465 6420          encoded 
-00040ac0: 7769 7468 696e 2074 6865 2074 7265 6520  within the tree 
-00040ad0: 6e61 6d65 206c 6162 656c 732e 2053 7065  name labels. Spe
-00040ae0: 6369 6669 6361 6c6c 792c 2061 2074 7265  cifically, a tre
-00040af0: 6520 7370 616e 6e69 6e67 0a20 2020 2020  e spanning.     
-00040b00: 2020 2074 6865 2069 6e74 6572 7661 6c20     the interval 
-00040b10: 3a6d 6174 683a 605b 782c 2079 2960 6020  :math:`[x, y)`` 
-00040b20: 6973 2067 6976 656e 2074 6865 206e 616d  is given the nam
-00040b30: 6520 6060 6622 747b 787d 5e7b 797d 2260  e ``f"t{x}^{y}"`
-00040b40: 600a 2020 2020 2020 2020 2853 6565 2062  `.        (See b
-00040b50: 656c 6f77 2066 6f72 2061 2064 6573 6372  elow for a descr
-00040b60: 6970 7469 6f6e 206f 6620 7468 6520 7072  iption of the pr
-00040b70: 6563 6973 696f 6e20 6174 2077 6869 6368  ecision at which
-00040b80: 2074 6865 7365 2073 7061 7469 616c 0a20   these spatial. 
-00040b90: 2020 2020 2020 2063 6f6f 7264 696e 6174         coordinat
-00040ba0: 6573 2061 7265 2070 7269 6e74 6564 206f  es are printed o
-00040bb0: 7574 292e 0a0a 2020 2020 2020 2020 5468  ut)...        Th
-00040bc0: 6520 3a72 6566 3a60 7361 6d70 6c65 206e  e :ref:`sample n
-00040bd0: 6f64 6573 3c73 6563 5f64 6174 615f 6d6f  odes<sec_data_mo
-00040be0: 6465 6c5f 6465 6669 6e69 7469 6f6e 733e  del_definitions>
-00040bf0: 6020 696e 2074 6869 7320 7472 6565 0a20  ` in this tree. 
-00040c00: 2020 2020 2020 2073 6571 7565 6e63 6520         sequence 
-00040c10: 6172 6520 7265 6761 7264 6564 2061 7320  are regarded as 
-00040c20: 7461 7861 2c20 616e 6420 6120 7361 6d70  taxa, and a samp
-00040c30: 6c65 2077 6974 6820 6e6f 6465 2069 6420  le with node id 
-00040c40: 6060 7560 600a 2020 2020 2020 2020 6973  ``u``.        is
-00040c50: 2067 6976 656e 2074 6865 206c 6162 656c   given the label
-00040c60: 2060 6066 226e 7b75 7d22 6060 2c20 666f   ``f"n{u}"``, fo
-00040c70: 6c6c 6f77 696e 6720 7468 6520 7361 6d65  llowing the same
-00040c80: 2063 6f6e 7665 6e74 696f 6e0a 2020 2020   convention.    
-00040c90: 2020 2020 6173 2074 6865 203a 6d65 7468      as the :meth
-00040ca0: 3a60 5472 6565 2e61 735f 6e65 7769 636b  :`Tree.as_newick
-00040cb0: 6020 6d65 7468 6f64 2e0a 0a20 2020 2020  ` method...     
-00040cc0: 2020 2042 7920 6465 6661 756c 742c 2067     By default, g
-00040cd0: 656e 6f6d 6520 706f 7369 7469 6f6e 7320  enome positions 
-00040ce0: 6172 6520 7072 696e 7465 6420 6f75 7420  are printed out 
-00040cf0: 7769 7468 2077 6974 6820 7375 6666 6963  with with suffic
-00040d00: 6965 6e74 0a20 2020 2020 2020 2070 7265  ient.        pre
-00040d10: 6369 7369 6f6e 2066 6f72 2074 6865 6d20  cision for them 
-00040d20: 746f 2062 6520 7265 636f 7665 7265 6420  to be recovered 
-00040d30: 6578 6163 746c 7920 696e 2064 6f75 626c  exactly in doubl
-00040d40: 6520 7072 6563 6973 696f 6e2e 0a20 2020  e precision..   
-00040d50: 2020 2020 2049 6620 7468 6520 7472 6565       If the tree
-00040d60: 2073 6571 7565 6e63 6520 6973 2064 6566   sequence is def
-00040d70: 696e 6564 206f 6e20 6120 3a61 7474 723a  ined on a :attr:
-00040d80: 602e 6469 7363 7265 7465 5f67 656e 6f6d  `.discrete_genom
-00040d90: 6560 2c0a 2020 2020 2020 2020 7468 656e  e`,.        then
-00040da0: 2070 6f73 6974 696f 6e73 2061 7265 2077   positions are w
-00040db0: 7269 7474 656e 206f 7574 2061 7320 696e  ritten out as in
-00040dc0: 7465 6765 7273 2e20 4f74 6865 7277 6973  tegers. Otherwis
-00040dd0: 652c 2031 3720 6469 6769 7473 0a20 2020  e, 17 digits.   
-00040de0: 2020 2020 206f 6620 7072 6563 6973 696f       of precisio
-00040df0: 6e20 6973 2075 7365 642e 2042 7261 6e63  n is used. Branc
-00040e00: 6820 6c65 6e67 7468 2070 7265 6369 7369  h length precisi
-00040e10: 6f6e 2064 6566 6175 6c74 7320 6172 6520  on defaults are 
-00040e20: 6861 6e64 6c65 640a 2020 2020 2020 2020  handled.        
-00040e30: 696e 2074 6865 2073 616d 6520 7761 7920  in the same way 
-00040e40: 6173 203a 6d65 7468 3a60 2e54 7265 652e  as :meth:`.Tree.
-00040e50: 6173 5f6e 6577 6963 6b60 2e0a 0a20 2020  as_newick`...   
-00040e60: 2020 2020 2049 6620 7468 6520 6060 7072       If the ``pr
-00040e70: 6563 6973 696f 6e60 6020 6172 6775 6d65  ecision`` argume
-00040e80: 6e74 2069 7320 7072 6f76 6964 6564 2c20  nt is provided, 
-00040e90: 6765 6e6f 6d65 2070 6f73 6974 696f 6e73  genome positions
-00040ea0: 2061 6e64 0a20 2020 2020 2020 2062 7261   and.        bra
-00040eb0: 6e63 6820 6c65 6e67 7468 7320 6172 6520  nch lengths are 
-00040ec0: 7072 696e 7465 6420 6f75 7420 7769 7468  printed out with
-00040ed0: 2074 6869 7320 6d61 6e79 2064 6967 6974   this many digit
-00040ee0: 7320 6f66 2070 7265 6369 7369 6f6e 2e0a  s of precision..
-00040ef0: 0a20 2020 2020 2020 2046 6f72 2065 7861  .        For exa
-00040f00: 6d70 6c65 2c20 6865 7265 2069 7320 7468  mple, here is th
-00040f10: 6520 6e65 7875 7320 656e 636f 6469 6e67  e nexus encoding
-00040f20: 206f 6620 6120 7369 6d70 6c65 2074 7265   of a simple tre
-00040f30: 6520 7365 7175 656e 6365 0a20 2020 2020  e sequence.     
-00040f40: 2020 2077 6974 6820 696e 7465 6765 7220     with integer 
-00040f50: 7469 6d65 7320 616e 6420 6765 6e6f 6d65  times and genome
-00040f60: 2063 6f6f 7264 696e 6174 6573 2077 6974   coordinates wit
-00040f70: 6820 7468 7265 6520 7361 6d70 6c65 730a  h three samples.
-00040f80: 2020 2020 2020 2020 616e 6420 7477 6f20          and two 
-00040f90: 7472 6565 733a 3a0a 0a20 2020 2020 2020  trees::..       
-00040fa0: 2020 2020 2023 4e45 5855 530a 2020 2020       #NEXUS.    
-00040fb0: 2020 2020 2020 2020 4245 4749 4e20 5441          BEGIN TA
-00040fc0: 5841 3b0a 2020 2020 2020 2020 2020 2020  XA;.            
-00040fd0: 2020 4449 4d45 4e53 494f 4e53 204e 5441    DIMENSIONS NTA
-00040fe0: 583d 333b 0a20 2020 2020 2020 2020 2020  X=3;.           
-00040ff0: 2020 2054 4158 4c41 4245 4c53 206e 3020     TAXLABELS n0 
-00041000: 6e31 206e 323b 0a20 2020 2020 2020 2020  n1 n2;.         
-00041010: 2020 2045 4e44 3b0a 2020 2020 2020 2020     END;.        
-00041020: 2020 2020 4245 4749 4e20 5452 4545 533b      BEGIN TREES;
-00041030: 0a20 2020 2020 2020 2020 2020 2020 2054  .              T
-00041040: 5245 4520 7430 5e32 203d 205b 2652 5d20  REE t0^2 = [&R] 
-00041050: 286e 303a 332c 286e 313a 322c 6e32 3a32  (n0:3,(n1:2,n2:2
-00041060: 293a 3129 3b0a 2020 2020 2020 2020 2020  ):1);.          
-00041070: 2020 2020 5452 4545 2074 325e 3130 203d      TREE t2^10 =
-00041080: 205b 2652 5d20 286e 313a 322c 286e 303a   [&R] (n1:2,(n0:
-00041090: 312c 6e32 3a31 293a 3129 3b0a 2020 2020  1,n2:1):1);.    
-000410a0: 2020 2020 2020 2020 454e 443b 0a0a 2020          END;..  
-000410b0: 2020 2020 2020 4966 2073 6571 7565 6e63        If sequenc
-000410c0: 6520 6461 7461 203a 6d65 7468 3a60 2e61  e data :meth:`.a
-000410d0: 6c69 676e 6d65 6e74 7360 2061 7265 2064  lignments` are d
-000410e0: 6566 696e 6564 2066 6f72 2074 6869 7320  efined for this 
-000410f0: 7472 6565 2073 6571 7565 6e63 650a 2020  tree sequence.  
-00041100: 2020 2020 2020 616e 6420 7468 6572 6520        and there 
-00041110: 6973 2061 7420 6c65 6173 7420 6f6e 6520  is at least one 
-00041120: 7369 7465 2070 7265 7365 6e74 2c20 7365  site present, se
-00041130: 7175 656e 6365 2061 6c69 676e 6d65 6e74  quence alignment
-00041140: 2064 6174 6120 7769 6c6c 2061 6c73 6f0a   data will also.
-00041150: 2020 2020 2020 2020 6265 2069 6e63 6c75          be inclu
-00041160: 6465 6420 6279 2064 6566 6175 6c74 2028  ded by default (
-00041170: 7468 6973 2063 616e 2062 6520 7375 7070  this can be supp
-00041180: 7265 7373 6564 2062 7920 7365 7474 696e  ressed by settin
-00041190: 670a 2020 2020 2020 2020 6060 696e 636c  g.        ``incl
-000411a0: 7564 655f 616c 6967 6e6d 656e 7473 3d46  ude_alignments=F
-000411b0: 616c 7365 6060 292e 2046 6f72 2065 7861  alse``). For exa
-000411c0: 6d70 6c65 2c20 7468 6973 2074 7265 6520  mple, this tree 
-000411d0: 7365 7175 656e 6365 2068 6173 0a20 2020  sequence has.   
-000411e0: 2020 2020 2061 2073 6571 7565 6e63 6520       a sequence 
-000411f0: 6c65 6e67 7468 206f 6620 3130 2c20 7477  length of 10, tw
-00041200: 6f20 7661 7269 6162 6c65 2073 6974 6573  o variable sites
-00041210: 2061 6e64 206e 6f0a 2020 2020 2020 2020   and no.        
-00041220: 3a72 6566 3a60 7265 6665 7265 6e63 6520  :ref:`reference 
-00041230: 7365 7175 656e 6365 3c73 6563 5f64 6174  sequence<sec_dat
-00041240: 615f 6d6f 6465 6c5f 7265 6665 7265 6e63  a_model_referenc
-00041250: 655f 7365 7175 656e 6365 3e60 3a3a 0a0a  e_sequence>`::..
-00041260: 2020 2020 2020 2020 2020 2020 234e 4558              #NEX
-00041270: 5553 0a20 2020 2020 2020 2020 2020 2042  US.            B
-00041280: 4547 494e 2054 4158 413b 0a20 2020 2020  EGIN TAXA;.     
-00041290: 2020 2020 2020 2020 2044 494d 454e 5349           DIMENSI
-000412a0: 4f4e 5320 4e54 4158 3d33 3b0a 2020 2020  ONS NTAX=3;.    
-000412b0: 2020 2020 2020 2020 2020 5441 584c 4142            TAXLAB
-000412c0: 454c 5320 6e30 206e 3120 6e32 3b0a 2020  ELS n0 n1 n2;.  
-000412d0: 2020 2020 2020 2020 2020 454e 443b 0a20            END;. 
-000412e0: 2020 2020 2020 2020 2020 2042 4547 494e             BEGIN
-000412f0: 2044 4154 413b 0a20 2020 2020 2020 2020   DATA;.         
-00041300: 2020 2020 2044 494d 454e 5349 4f4e 5320       DIMENSIONS 
-00041310: 4e43 4841 523d 3130 3b0a 2020 2020 2020  NCHAR=10;.      
-00041320: 2020 2020 2020 2020 464f 524d 4154 2044          FORMAT D
-00041330: 4154 4154 5950 453d 444e 4120 4d49 5353  ATATYPE=DNA MISS
-00041340: 494e 473d 3f3b 0a20 2020 2020 2020 2020  ING=?;.         
-00041350: 2020 2020 204d 4154 5249 580a 2020 2020       MATRIX.    
-00041360: 2020 2020 2020 2020 2020 2020 6e30 203f              n0 ?
-00041370: 3f47 3f3f 3f3f 3f3f 540a 2020 2020 2020  ?G??????T.      
-00041380: 2020 2020 2020 2020 2020 6e31 203f 3f41            n1 ??A
-00041390: 3f3f 3f3f 3f3f 430a 2020 2020 2020 2020  ??????C.        
-000413a0: 2020 2020 2020 2020 6e32 203f 3f41 3f3f          n2 ??A??
-000413b0: 3f3f 3f3f 430a 2020 2020 2020 2020 2020  ????C.          
-000413c0: 2020 2020 3b0a 2020 2020 2020 2020 2020      ;.          
-000413d0: 2020 454e 443b 0a20 2020 2020 2020 2020    END;.         
-000413e0: 2020 2042 4547 494e 2054 5245 4553 3b0a     BEGIN TREES;.
-000413f0: 2020 2020 2020 2020 2020 2020 2020 5452                TR
-00041400: 4545 2074 305e 3130 203d 205b 2652 5d20  EE t0^10 = [&R] 
-00041410: 286e 303a 322c 286e 313a 312c 6e32 3a31  (n0:2,(n1:1,n2:1
-00041420: 293a 3129 3b0a 2020 2020 2020 2020 2020  ):1);.          
-00041430: 2020 454e 443b 0a0a 2020 2020 2020 2020    END;..        
-00041440: 506c 6561 7365 2073 6565 2074 6865 203a  Please see the :
-00041450: 6d65 7468 3a60 2e61 6c69 676e 6d65 6e74  meth:`.alignment
-00041460: 7360 206d 6574 686f 6420 666f 7220 6465  s` method for de
-00041470: 7461 696c 7320 6f6e 2068 6f77 0a20 2020  tails on how.   
-00041480: 2020 2020 2072 6566 6572 656e 6365 2073       reference s
-00041490: 6571 7565 6e63 6573 2061 7265 2068 616e  equences are han
-000414a0: 646c 6564 2e0a 0a20 2020 2020 2020 202e  dled...        .
-000414b0: 2e20 6e6f 7465 3a3a 204e 6f74 6520 7468  . note:: Note th
-000414c0: 6520 6465 6661 756c 7420 6060 6d69 7373  e default ``miss
-000414d0: 696e 675f 6461 7461 5f63 6861 7261 6374  ing_data_charact
-000414e0: 6572 6060 2066 6f72 2074 6869 7320 6d65  er`` for this me
-000414f0: 7468 6f64 0a20 2020 2020 2020 2020 2020  thod.           
-00041500: 2069 7320 223f 2220 7261 7468 6572 2074   is "?" rather t
-00041510: 6865 6e20 224e 222c 2069 6e20 6b65 6570  hen "N", in keep
-00041520: 696e 6720 7769 7468 2063 6f6d 6d6f 6e20  ing with common 
-00041530: 636f 6e76 656e 7469 6f6e 7320 666f 720a  conventions for.
-00041540: 2020 2020 2020 2020 2020 2020 6e65 7875              nexu
-00041550: 7320 6461 7461 2e20 5468 6973 2063 616e  s data. This can
-00041560: 2062 6520 6368 616e 6765 6420 7573 696e   be changed usin
-00041570: 6720 7468 6520 6060 6d69 7373 696e 675f  g the ``missing_
-00041580: 6461 7461 5f63 6861 7261 6374 6572 6060  data_character``
-00041590: 0a20 2020 2020 2020 2020 2020 2070 6172  .            par
-000415a0: 616d 6574 6572 2e0a 0a20 2020 2020 2020  ameter...       
-000415b0: 202e 2e20 7761 726e 696e 673a 3a20 3a72   .. warning:: :r
-000415c0: 6566 3a60 4d69 7373 696e 6720 6461 7461  ef:`Missing data
-000415d0: 3c73 6563 5f64 6174 615f 6d6f 6465 6c5f  <sec_data_model_
-000415e0: 6d69 7373 696e 675f 6461 7461 3e60 0a20  missing_data>`. 
-000415f0: 2020 2020 2020 2020 2020 2069 7320 6e6f             is no
-00041600: 7420 7375 7070 6f72 7465 6420 666f 7220  t supported for 
-00041610: 656e 636f 6469 6e67 2074 7265 6520 746f  encoding tree to
-00041620: 706f 6c6f 6779 2069 6e66 6f72 6d61 7469  pology informati
-00041630: 6f6e 0a20 2020 2020 2020 2020 2020 2061  on.            a
-00041640: 7320 6f75 7220 636f 6e76 656e 7469 6f6e  s our convention
-00041650: 206f 6620 7573 696e 6720 7472 6565 7320   of using trees 
-00041660: 7769 7468 206d 756c 7469 706c 6520 726f  with multiple ro
-00041670: 6f74 730a 2020 2020 2020 2020 2020 2020  ots.            
-00041680: 6973 206e 6f74 206f 6674 656e 2073 7570  is not often sup
-00041690: 706f 7274 6564 2062 7920 6e65 7769 636b  ported by newick
-000416a0: 2070 6172 7365 7273 2e20 5468 7573 2c20   parsers. Thus, 
-000416b0: 7468 6520 6d65 7468 6f64 0a20 2020 2020  the method.     
-000416c0: 2020 2020 2020 2077 696c 6c20 7261 6973         will rais
-000416d0: 6520 6120 5661 6c75 6545 7272 6f72 2069  e a ValueError i
-000416e0: 6620 7765 2074 7279 2074 6f20 6f75 7470  f we try to outp
-000416f0: 7574 2074 7265 6573 2077 6974 680a 2020  ut trees with.  
-00041700: 2020 2020 2020 2020 2020 6d75 6c74 6970            multip
-00041710: 6c65 2072 6f6f 7473 2e20 4164 6469 7469  le roots. Additi
-00041720: 6f6e 616c 6c79 2c20 6d69 7373 696e 6720  onally, missing 
-00041730: 6461 7461 0a20 2020 2020 2020 2020 2020  data.           
-00041740: 2069 7320 6e6f 7420 6375 7272 656e 746c   is not currentl
-00041750: 7920 7375 7070 6f72 7465 6420 666f 7220  y supported for 
-00041760: 616c 6967 6e6d 656e 7420 6461 7461 2e0a  alignment data..
-00041770: 2020 2020 2020 2020 2020 2020 5365 6520              See 
-00041780: 6874 7470 733a 2f2f 6769 7468 7562 2e63  https://github.c
-00041790: 6f6d 2f74 736b 6974 2d64 6576 2f74 736b  om/tskit-dev/tsk
-000417a0: 6974 2f69 7373 7565 732f 3138 3936 2066  it/issues/1896 f
-000417b0: 6f72 206d 6f72 650a 2020 2020 2020 2020  or more.        
-000417c0: 2020 2020 696e 666f 726d 6174 696f 6e2e      information.
-000417d0: 0a0a 2020 2020 2020 2020 2e2e 2073 6565  ..        .. see
-000417e0: 616c 736f 3a20 5365 6520 616c 736f 2074  also: See also t
-000417f0: 6865 203a 6d65 7468 3a60 2e61 735f 6e65  he :meth:`.as_ne
-00041800: 7875 7360 206d 6574 686f 6420 7768 6963  xus` method whic
-00041810: 6820 7769 6c6c 0a20 2020 2020 2020 2020  h will.         
-00041820: 2020 2072 6574 7572 6e20 7468 6973 206e     return this n
-00041830: 6578 7573 2072 6570 7265 7365 6e74 6174  exus representat
-00041840: 696f 6e20 6173 2061 2073 7472 696e 672e  ion as a string.
-00041850: 0a0a 2020 2020 2020 2020 3a70 6172 616d  ..        :param
-00041860: 2069 6e74 2070 7265 6369 7369 6f6e 3a20   int precision: 
-00041870: 5468 6520 6e75 6d65 7269 6361 6c20 7072  The numerical pr
-00041880: 6563 6973 696f 6e20 7769 7468 2077 6869  ecision with whi
-00041890: 6368 2062 7261 6e63 6820 6c65 6e67 7468  ch branch length
-000418a0: 730a 2020 2020 2020 2020 2020 2020 616e  s.            an
-000418b0: 6420 7472 6565 2070 6f73 6974 696f 6e73  d tree positions
-000418c0: 2061 7265 2070 7269 6e74 6564 2e0a 2020   are printed..  
-000418d0: 2020 2020 2020 3a70 6172 616d 2062 6f6f        :param boo
-000418e0: 6c20 696e 636c 7564 655f 7472 6565 733a  l include_trees:
-000418f0: 2054 7275 6520 6966 2074 6865 2074 7265   True if the tre
-00041900: 6520 746f 706f 6c6f 6779 2069 6e66 6f72  e topology infor
-00041910: 6d61 7469 6f6e 2073 686f 756c 640a 2020  mation should.  
-00041920: 2020 2020 2020 2020 2020 6265 2069 6e63            be inc
-00041930: 6c75 6465 643b 2046 616c 7365 206f 7468  luded; False oth
-00041940: 6572 7769 7365 2028 6465 6661 756c 743d  erwise (default=
-00041950: 5472 7565 292e 0a20 2020 2020 2020 203a  True)..        :
-00041960: 7061 7261 6d20 626f 6f6c 2069 6e63 6c75  param bool inclu
-00041970: 6465 5f61 6c69 676e 6d65 6e74 733a 2054  de_alignments: T
-00041980: 7275 6520 6966 2074 6865 2073 6571 7565  rue if the seque
-00041990: 6e63 6520 6461 7461 2061 6c69 676e 6d65  nce data alignme
-000419a0: 6e74 2069 6e66 6f72 6d61 7469 6f6e 0a20  nt information. 
-000419b0: 2020 2020 2020 2020 2020 2073 686f 756c             shoul
-000419c0: 6420 6265 2069 6e63 6c75 6465 643b 2046  d be included; F
-000419d0: 616c 7365 206f 7468 6572 7769 7365 2028  alse otherwise (
-000419e0: 6465 6661 756c 743d 5472 7565 2069 6620  default=True if 
-000419f0: 7365 7175 656e 6365 2061 6c69 676e 6d65  sequence alignme
-00041a00: 6e74 730a 2020 2020 2020 2020 2020 2020  nts.            
-00041a10: 6172 6520 7765 6c6c 2d64 6566 696e 6564  are well-defined
-00041a20: 2061 6e64 2074 6865 2074 7265 6520 7365   and the tree se
-00041a30: 7175 656e 6365 2063 6f6e 7461 696e 7320  quence contains 
-00041a40: 6174 206c 6561 7374 206f 6e65 2073 6974  at least one sit
-00041a50: 6529 2e0a 2020 2020 2020 2020 3a70 6172  e)..        :par
-00041a60: 616d 2073 7472 2072 6566 6572 656e 6365  am str reference
-00041a70: 5f73 6571 7565 6e63 653a 2041 7320 666f  _sequence: As fo
-00041a80: 7220 7468 6520 3a6d 6574 683a 602e 616c  r the :meth:`.al
-00041a90: 6967 6e6d 656e 7473 6020 6d65 7468 6f64  ignments` method
-00041aa0: 2e0a 2020 2020 2020 2020 3a70 6172 616d  ..        :param
-00041ab0: 2073 7472 206d 6973 7369 6e67 5f64 6174   str missing_dat
-00041ac0: 615f 6368 6172 6163 7465 723a 2041 7320  a_character: As 
-00041ad0: 666f 7220 7468 6520 3a6d 6574 683a 602e  for the :meth:`.
-00041ae0: 616c 6967 6e6d 656e 7473 6020 6d65 7468  alignments` meth
-00041af0: 6f64 2c0a 2020 2020 2020 2020 2020 2020  od,.            
-00041b00: 6275 7420 6465 6661 756c 7473 2074 6f20  but defaults to 
-00041b10: 223f 222e 0a20 2020 2020 2020 203a 7265  "?"..        :re
-00041b20: 7475 726e 3a20 4120 6e65 7875 7320 7265  turn: A nexus re
-00041b30: 7072 6573 656e 7461 7469 6f6e 206f 6620  presentation of 
-00041b40: 7468 6973 203a 636c 6173 733a 6054 7265  this :class:`Tre
-00041b50: 6553 6571 7565 6e63 6560 0a20 2020 2020  eSequence`.     
-00041b60: 2020 203a 7274 7970 653a 2073 7472 0a20     :rtype: str. 
-00041b70: 2020 2020 2020 2022 2222 0a20 2020 2020         """.     
-00041b80: 2020 2074 6578 745f 666f 726d 6174 732e     text_formats.
-00041b90: 7772 6974 655f 6e65 7875 7328 0a20 2020  write_nexus(.   
-00041ba0: 2020 2020 2020 2020 2073 656c 662c 0a20           self,. 
-00041bb0: 2020 2020 2020 2020 2020 2066 696c 655f             file_
-00041bc0: 6f72 5f70 6174 682c 0a20 2020 2020 2020  or_path,.       
-00041bd0: 2020 2020 2070 7265 6369 7369 6f6e 3d70       precision=p
-00041be0: 7265 6369 7369 6f6e 2c0a 2020 2020 2020  recision,.      
-00041bf0: 2020 2020 2020 696e 636c 7564 655f 7472        include_tr
-00041c00: 6565 733d 696e 636c 7564 655f 7472 6565  ees=include_tree
-00041c10: 732c 0a20 2020 2020 2020 2020 2020 2069  s,.            i
-00041c20: 6e63 6c75 6465 5f61 6c69 676e 6d65 6e74  nclude_alignment
-00041c30: 733d 696e 636c 7564 655f 616c 6967 6e6d  s=include_alignm
-00041c40: 656e 7473 2c0a 2020 2020 2020 2020 2020  ents,.          
-00041c50: 2020 7265 6665 7265 6e63 655f 7365 7175    reference_sequ
-00041c60: 656e 6365 3d72 6566 6572 656e 6365 5f73  ence=reference_s
-00041c70: 6571 7565 6e63 652c 0a20 2020 2020 2020  equence,.       
-00041c80: 2020 2020 206d 6973 7369 6e67 5f64 6174       missing_dat
-00041c90: 615f 6368 6172 6163 7465 723d 6d69 7373  a_character=miss
-00041ca0: 696e 675f 6461 7461 5f63 6861 7261 6374  ing_data_charact
-00041cb0: 6572 2c0a 2020 2020 2020 2020 290a 0a20  er,.        ).. 
-00041cc0: 2020 2064 6566 2061 735f 6e65 7875 7328     def as_nexus(
-00041cd0: 7365 6c66 2c20 2a2a 6b77 6172 6773 293a  self, **kwargs):
-00041ce0: 0a20 2020 2020 2020 2022 2222 0a20 2020  .        """.   
-00041cf0: 2020 2020 2052 6574 7572 6e20 7468 6520       Return the 
-00041d00: 7265 7375 6c74 206f 6620 3a6d 6574 683a  result of :meth:
-00041d10: 602e 7772 6974 655f 6e65 7875 7360 2061  `.write_nexus` a
-00041d20: 7320 6120 7374 7269 6e67 2e0a 2020 2020  s a string..    
-00041d30: 2020 2020 4b65 7977 6f72 6420 7061 7261      Keyword para
-00041d40: 6d65 7465 7273 2061 7265 2061 7320 6465  meters are as de
-00041d50: 6669 6e65 6420 696e 203a 6d65 7468 3a60  fined in :meth:`
-00041d60: 2e77 7269 7465 5f6e 6578 7573 602e 0a0a  .write_nexus`...
-00041d70: 2020 2020 2020 2020 3a72 6574 7572 6e3a          :return:
-00041d80: 2041 206e 6578 7573 2065 6e63 6f64 696e   A nexus encodin
-00041d90: 6720 6f66 2074 6865 2061 6c69 676e 6d65  g of the alignme
-00041da0: 6e74 7320 696e 2074 6869 7320 7472 6565  nts in this tree
-00041db0: 2073 6571 7565 6e63 6520 6173 2061 2073   sequence as a s
-00041dc0: 7472 696e 672e 0a20 2020 2020 2020 203a  tring..        :
-00041dd0: 7274 7970 653a 2073 7472 0a20 2020 2020  rtype: str.     
-00041de0: 2020 2022 2222 0a20 2020 2020 2020 2062     """.        b
-00041df0: 7566 6620 3d20 696f 2e53 7472 696e 6749  uff = io.StringI
-00041e00: 4f28 290a 2020 2020 2020 2020 7365 6c66  O().        self
-00041e10: 2e77 7269 7465 5f6e 6578 7573 2862 7566  .write_nexus(buf
-00041e20: 662c 202a 2a6b 7761 7267 7329 0a20 2020  f, **kwargs).   
-00041e30: 2020 2020 2072 6574 7572 6e20 6275 6666       return buff
-00041e40: 2e67 6574 7661 6c75 6528 290a 0a20 2020  .getvalue()..   
-00041e50: 2023 2054 4f44 4f0a 2020 2020 2320 2831   # TODO.    # (1
-00041e60: 2920 4d6f 7665 2074 6865 2064 6566 696e  ) Move the defin
-00041e70: 6974 696f 6e20 746f 2074 6578 745f 666f  ition to text_fo
-00041e80: 726d 6174 732e 7079 0a20 2020 2023 2028  rmats.py.    # (
-00041e90: 3229 2052 656e 616d 6520 746f 2061 735f  2) Rename to as_
-00041ea0: 6d61 6373 2061 6e64 206b 6565 7020 746f  macs and keep to
-00041eb0: 5f6d 6163 7320 6173 2061 2064 6570 7265  _macs as a depre
-00041ec0: 6361 7465 6420 7379 6e6f 6e79 6d0a 2020  cated synonym.  
-00041ed0: 2020 6465 6620 746f 5f6d 6163 7328 7365    def to_macs(se
-00041ee0: 6c66 293a 0a20 2020 2020 2020 2022 2222  lf):.        """
-00041ef0: 0a20 2020 2020 2020 2052 6574 7572 6e20  .        Return 
-00041f00: 6120 606d 6163 7320 656e 636f 6469 6e67  a `macs encoding
-00041f10: 203c 6874 7470 733a 2f2f 6769 7468 7562   <https://github
-00041f20: 2e63 6f6d 2f67 6368 656e 3938 2f6d 6163  .com/gchen98/mac
-00041f30: 733e 605f 0a20 2020 2020 2020 206f 6620  s>`_.        of 
-00041f40: 7468 6973 2074 7265 6520 7365 7175 656e  this tree sequen
-00041f50: 6365 2e0a 0a20 2020 2020 2020 203a 7265  ce...        :re
-00041f60: 7475 726e 3a20 5468 6520 6d61 6373 2072  turn: The macs r
-00041f70: 6570 7265 7365 6e74 6174 696f 6e20 6f66  epresentation of
-00041f80: 2074 6869 7320 5472 6565 5365 7175 656e   this TreeSequen
-00041f90: 6365 2061 7320 6120 7374 7269 6e67 2e0a  ce as a string..
-00041fa0: 2020 2020 2020 2020 3a72 7479 7065 3a20          :rtype: 
-00041fb0: 7374 720a 2020 2020 2020 2020 2222 220a  str.        """.
-00041fc0: 2020 2020 2020 2020 6e20 3d20 7365 6c66          n = self
-00041fd0: 2e67 6574 5f73 616d 706c 655f 7369 7a65  .get_sample_size
-00041fe0: 2829 0a20 2020 2020 2020 206d 203d 2073  ().        m = s
-00041ff0: 656c 662e 6765 745f 7365 7175 656e 6365  elf.get_sequence
-00042000: 5f6c 656e 6774 6828 290a 2020 2020 2020  _length().      
-00042010: 2020 6f75 7470 7574 203d 205b 6622 434f    output = [f"CO
-00042020: 4d4d 414e 443a 5c74 6e6f 745f 6d61 6373  MMAND:\tnot_macs
-00042030: 207b 6e7d 207b 6d7d 225d 0a20 2020 2020   {n} {m}"].     
-00042040: 2020 206f 7574 7075 742e 6170 7065 6e64     output.append
-00042050: 2822 5345 4544 3a5c 7441 5345 4544 2229  ("SEED:\tASEED")
-00042060: 0a20 2020 2020 2020 2066 6f72 2076 6172  .        for var
-00042070: 6961 6e74 2069 6e20 7365 6c66 2e76 6172  iant in self.var
-00042080: 6961 6e74 7328 636f 7079 3d46 616c 7365  iants(copy=False
-00042090: 293a 0a20 2020 2020 2020 2020 2020 2069  ):.            i
-000420a0: 6620 616e 7928 6c65 6e28 616c 6c65 6c65  f any(len(allele
-000420b0: 2920 3e20 3120 666f 7220 616c 6c65 6c65  ) > 1 for allele
-000420c0: 2069 6e20 7661 7269 616e 742e 616c 6c65   in variant.alle
-000420d0: 6c65 7329 3a0a 2020 2020 2020 2020 2020  les):.          
-000420e0: 2020 2020 2020 7261 6973 6520 5661 6c75        raise Valu
-000420f0: 6545 7272 6f72 2822 6d61 6373 206f 7574  eError("macs out
-00042100: 7075 7420 6f6e 6c79 2073 7570 706f 7274  put only support
-00042110: 7320 7369 6e67 6c65 206c 6574 7465 7220  s single letter 
-00042120: 616c 6c65 6c65 7322 290a 2020 2020 2020  alleles").      
-00042130: 2020 2020 2020 6279 7465 735f 6765 6e6f        bytes_geno
-00042140: 7479 7065 7320 3d20 6e70 2e65 6d70 7479  types = np.empty
-00042150: 2873 656c 662e 6e75 6d5f 7361 6d70 6c65  (self.num_sample
-00042160: 732c 2064 7479 7065 3d6e 702e 7569 6e74  s, dtype=np.uint
-00042170: 3829 0a20 2020 2020 2020 2020 2020 206c  8).            l
-00042180: 6f6f 6b75 7020 3d20 6e70 2e61 7272 6179  ookup = np.array
-00042190: 285b 6f72 6428 615b 305d 2920 666f 7220  ([ord(a[0]) for 
-000421a0: 6120 696e 2076 6172 6961 6e74 2e61 6c6c  a in variant.all
-000421b0: 656c 6573 5d2c 2064 7479 7065 3d6e 702e  eles], dtype=np.
-000421c0: 7569 6e74 3829 0a20 2020 2020 2020 2020  uint8).         
-000421d0: 2020 2062 7974 6573 5f67 656e 6f74 7970     bytes_genotyp
-000421e0: 6573 5b3a 5d20 3d20 6c6f 6f6b 7570 5b76  es[:] = lookup[v
-000421f0: 6172 6961 6e74 2e67 656e 6f74 7970 6573  ariant.genotypes
-00042200: 5d0a 2020 2020 2020 2020 2020 2020 6765  ].            ge
-00042210: 6e6f 7479 7065 7320 3d20 6279 7465 735f  notypes = bytes_
-00042220: 6765 6e6f 7479 7065 732e 746f 6279 7465  genotypes.tobyte
-00042230: 7328 292e 6465 636f 6465 2829 0a20 2020  s().decode().   
-00042240: 2020 2020 2020 2020 206f 7574 7075 742e           output.
-00042250: 6170 7065 6e64 280a 2020 2020 2020 2020  append(.        
-00042260: 2020 2020 2020 2020 6622 5349 5445 3a5c          f"SITE:\
-00042270: 747b 7661 7269 616e 742e 696e 6465 787d  t{variant.index}
-00042280: 5c74 7b76 6172 6961 6e74 2e70 6f73 6974  \t{variant.posit
-00042290: 696f 6e20 2f20 6d7d 5c74 302e 305c 7422  ion / m}\t0.0\t"
-000422a0: 2066 227b 6765 6e6f 7479 7065 737d 220a   f"{genotypes}".
-000422b0: 2020 2020 2020 2020 2020 2020 290a 2020              ).  
-000422c0: 2020 2020 2020 7265 7475 726e 2022 5c6e        return "\n
-000422d0: 222e 6a6f 696e 286f 7574 7075 7429 202b  ".join(output) +
-000422e0: 2022 5c6e 220a 0a20 2020 2064 6566 2073   "\n"..    def s
-000422f0: 696d 706c 6966 7928 0a20 2020 2020 2020  implify(.       
-00042300: 2073 656c 662c 0a20 2020 2020 2020 2073   self,.        s
-00042310: 616d 706c 6573 3d4e 6f6e 652c 0a20 2020  amples=None,.   
-00042320: 2020 2020 202a 2c0a 2020 2020 2020 2020       *,.        
-00042330: 6d61 705f 6e6f 6465 733d 4661 6c73 652c  map_nodes=False,
-00042340: 0a20 2020 2020 2020 2072 6564 7563 655f  .        reduce_
-00042350: 746f 5f73 6974 655f 746f 706f 6c6f 6779  to_site_topology
-00042360: 3d46 616c 7365 2c0a 2020 2020 2020 2020  =False,.        
-00042370: 6669 6c74 6572 5f70 6f70 756c 6174 696f  filter_populatio
-00042380: 6e73 3d4e 6f6e 652c 0a20 2020 2020 2020  ns=None,.       
-00042390: 2066 696c 7465 725f 696e 6469 7669 6475   filter_individu
-000423a0: 616c 733d 4e6f 6e65 2c0a 2020 2020 2020  als=None,.      
-000423b0: 2020 6669 6c74 6572 5f73 6974 6573 3d4e    filter_sites=N
-000423c0: 6f6e 652c 0a20 2020 2020 2020 2066 696c  one,.        fil
-000423d0: 7465 725f 6e6f 6465 733d 4e6f 6e65 2c0a  ter_nodes=None,.
-000423e0: 2020 2020 2020 2020 7570 6461 7465 5f73          update_s
-000423f0: 616d 706c 655f 666c 6167 733d 4e6f 6e65  ample_flags=None
-00042400: 2c0a 2020 2020 2020 2020 6b65 6570 5f75  ,.        keep_u
-00042410: 6e61 7279 3d46 616c 7365 2c0a 2020 2020  nary=False,.    
-00042420: 2020 2020 6b65 6570 5f75 6e61 7279 5f69      keep_unary_i
-00042430: 6e5f 696e 6469 7669 6475 616c 733d 4e6f  n_individuals=No
-00042440: 6e65 2c0a 2020 2020 2020 2020 6b65 6570  ne,.        keep
-00042450: 5f69 6e70 7574 5f72 6f6f 7473 3d46 616c  _input_roots=Fal
-00042460: 7365 2c0a 2020 2020 2020 2020 7265 636f  se,.        reco
-00042470: 7264 5f70 726f 7665 6e61 6e63 653d 5472  rd_provenance=Tr
-00042480: 7565 2c0a 2020 2020 2020 2020 6669 6c74  ue,.        filt
-00042490: 6572 5f7a 6572 6f5f 6d75 7461 7469 6f6e  er_zero_mutation
-000424a0: 5f73 6974 6573 3d4e 6f6e 652c 2020 2320  _sites=None,  # 
-000424b0: 4465 7072 6563 6174 6564 2061 6c69 6173  Deprecated alias
-000424c0: 2066 6f72 2066 696c 7465 725f 7369 7465   for filter_site
-000424d0: 730a 2020 2020 293a 0a20 2020 2020 2020  s.    ):.       
-000424e0: 2022 2222 0a20 2020 2020 2020 2052 6574   """.        Ret
-000424f0: 7572 6e73 2061 2073 696d 706c 6966 6965  urns a simplifie
-00042500: 6420 7472 6565 2073 6571 7565 6e63 6520  d tree sequence 
-00042510: 7468 6174 2072 6574 6169 6e73 206f 6e6c  that retains onl
-00042520: 7920 7468 6520 6869 7374 6f72 7920 6f66  y the history of
-00042530: 0a20 2020 2020 2020 2074 6865 206e 6f64  .        the nod
-00042540: 6573 2067 6976 656e 2069 6e20 7468 6520  es given in the 
-00042550: 6c69 7374 2060 6073 616d 706c 6573 6060  list ``samples``
-00042560: 2e20 4966 2060 606d 6170 5f6e 6f64 6573  . If ``map_nodes
-00042570: 6060 2069 7320 7472 7565 2c0a 2020 2020  `` is true,.    
-00042580: 2020 2020 616c 736f 2072 6574 7572 6e20      also return 
-00042590: 6120 6e75 6d70 7920 6172 7261 7920 7768  a numpy array wh
-000425a0: 6f73 6520 6060 7560 602d 7468 2065 6c65  ose ``u``-th ele
-000425b0: 6d65 6e74 2069 7320 7468 6520 4944 206f  ment is the ID o
-000425c0: 6620 7468 6520 6e6f 6465 0a20 2020 2020  f the node.     
-000425d0: 2020 2069 6e20 7468 6520 7369 6d70 6c69     in the simpli
-000425e0: 6669 6564 2074 7265 6520 7365 7175 656e  fied tree sequen
-000425f0: 6365 2074 6861 7420 636f 7272 6573 706f  ce that correspo
-00042600: 6e64 7320 746f 206e 6f64 6520 6060 7560  nds to node ``u`
-00042610: 6020 696e 2074 6865 0a20 2020 2020 2020  ` in the.       
-00042620: 206f 7269 6769 6e61 6c20 7472 6565 2073   original tree s
-00042630: 6571 7565 6e63 652c 206f 7220 3a64 6174  equence, or :dat
-00042640: 613a 6074 736b 6974 2e4e 554c 4c60 2028  a:`tskit.NULL` (
-00042650: 2d31 2920 6966 2060 6075 6060 2069 7320  -1) if ``u`` is 
-00042660: 6e6f 206c 6f6e 6765 720a 2020 2020 2020  no longer.      
-00042670: 2020 7072 6573 656e 7420 696e 2074 6865    present in the
-00042680: 2073 696d 706c 6966 6965 6420 7472 6565   simplified tree
-00042690: 2073 6571 7565 6e63 652e 0a0a 2020 2020   sequence...    
-000426a0: 2020 2020 2e2e 206e 6f74 653a 3a0a 2020      .. note::.  
-000426b0: 2020 2020 2020 2020 2020 4966 2079 6f75            If you
-000426c0: 2077 6973 6820 746f 2073 696d 706c 6966   wish to simplif
-000426d0: 7920 6120 7365 7420 6f66 2074 6162 6c65  y a set of table
-000426e0: 7320 7468 6174 2064 6f20 6e6f 7420 7361  s that do not sa
-000426f0: 7469 7366 7920 616c 6c0a 2020 2020 2020  tisfy all.      
-00042700: 2020 2020 2020 7265 7175 6972 656d 656e        requiremen
-00042710: 7473 2066 6f72 2062 7569 6c64 696e 6720  ts for building 
-00042720: 6120 5472 6565 5365 7175 656e 6365 2c20  a TreeSequence, 
-00042730: 7468 656e 2075 7365 0a20 2020 2020 2020  then use.       
-00042740: 2020 2020 203a 6d65 7468 3a60 5461 626c       :meth:`Tabl
-00042750: 6543 6f6c 6c65 6374 696f 6e2e 7369 6d70  eCollection.simp
-00042760: 6c69 6679 602e 0a0a 2020 2020 2020 2020  lify`...        
-00042770: 4966 2074 6865 2060 6072 6564 7563 655f  If the ``reduce_
-00042780: 746f 5f73 6974 655f 746f 706f 6c6f 6779  to_site_topology
-00042790: 6060 2070 6172 616d 6574 6572 2069 7320  `` parameter is 
-000427a0: 5472 7565 2c20 7468 6520 7265 7475 726e  True, the return
-000427b0: 6564 2074 7265 650a 2020 2020 2020 2020  ed tree.        
-000427c0: 7365 7175 656e 6365 2077 696c 6c20 636f  sequence will co
-000427d0: 6e74 6169 6e20 6f6e 6c79 2074 6f70 6f6c  ntain only topol
-000427e0: 6f67 6963 616c 2069 6e66 6f72 6d61 7469  ogical informati
-000427f0: 6f6e 2074 6861 7420 6973 206e 6563 6573  on that is neces
-00042800: 7361 7279 2074 6f0a 2020 2020 2020 2020  sary to.        
-00042810: 7265 7072 6573 656e 7420 7468 6520 7472  represent the tr
-00042820: 6565 7320 7468 6174 2063 6f6e 7461 696e  ees that contain
-00042830: 2073 6974 6573 2e20 4966 2074 6865 7265   sites. If there
-00042840: 2061 7265 207a 6572 6f20 7369 7465 7320   are zero sites 
-00042850: 696e 2074 6869 730a 2020 2020 2020 2020  in this.        
-00042860: 7472 6565 2073 6571 7565 6e63 652c 2074  tree sequence, t
-00042870: 6869 7320 7769 6c6c 2072 6573 756c 7420  his will result 
-00042880: 696e 2061 6e20 6f75 7470 7574 2074 7265  in an output tre
-00042890: 6520 7365 7175 656e 6365 2077 6974 6820  e sequence with 
-000428a0: 7a65 726f 2065 6467 6573 2e0a 2020 2020  zero edges..    
-000428b0: 2020 2020 5768 656e 2074 6865 206e 756d      When the num
-000428c0: 6265 7220 6f66 2073 6974 6573 2069 7320  ber of sites is 
-000428d0: 6772 6561 7465 7220 7468 616e 207a 6572  greater than zer
-000428e0: 6f2c 2065 7665 7279 2074 7265 6520 696e  o, every tree in
-000428f0: 2074 6865 206f 7574 7075 740a 2020 2020   the output.    
-00042900: 2020 2020 7472 6565 2073 6571 7565 6e63      tree sequenc
-00042910: 6520 7769 6c6c 2063 6f6e 7461 696e 2061  e will contain a
-00042920: 7420 6c65 6173 7420 6f6e 6520 7369 7465  t least one site
-00042930: 2e20 466f 7220 6120 6769 7665 6e20 7369  . For a given si
-00042940: 7465 2c20 7468 650a 2020 2020 2020 2020  te, the.        
-00042950: 746f 706f 6c6f 6779 206f 6620 7468 6520  topology of the 
-00042960: 7472 6565 2063 6f6e 7461 696e 696e 6720  tree containing 
-00042970: 7468 6174 2073 6974 6520 7769 6c6c 2062  that site will b
-00042980: 6520 6964 656e 7469 6361 6c0a 2020 2020  e identical.    
-00042990: 2020 2020 2875 7020 746f 206e 6f64 6520      (up to node 
-000429a0: 4944 2072 656d 6170 7069 6e67 2920 746f  ID remapping) to
-000429b0: 2074 6865 2074 6f70 6f6c 6f67 7920 6f66   the topology of
-000429c0: 2074 6865 2063 6f72 7265 7370 6f6e 6469   the correspondi
-000429d0: 6e67 2074 7265 650a 2020 2020 2020 2020  ng tree.        
-000429e0: 696e 2074 6865 2069 6e70 7574 2074 7265  in the input tre
-000429f0: 6520 7365 7175 656e 6365 2e0a 0a20 2020  e sequence...   
-00042a00: 2020 2020 2049 6620 6060 6669 6c74 6572       If ``filter
-00042a10: 5f70 6f70 756c 6174 696f 6e73 6060 2c20  _populations``, 
-00042a20: 6060 6669 6c74 6572 5f69 6e64 6976 6964  ``filter_individ
-00042a30: 7561 6c73 6060 2c20 6060 6669 6c74 6572  uals``, ``filter
-00042a40: 5f73 6974 6573 6060 2c20 6f72 0a20 2020  _sites``, or.   
-00042a50: 2020 2020 2060 6066 696c 7465 725f 6e6f       ``filter_no
-00042a60: 6465 7360 6020 6973 2054 7275 652c 2061  des`` is True, a
-00042a70: 6e79 206f 6620 7468 6520 636f 7272 6573  ny of the corres
-00042a80: 706f 6e64 696e 6720 6f62 6a65 6374 7320  ponding objects 
-00042a90: 7468 6174 2061 7265 206e 6f74 0a20 2020  that are not.   
-00042aa0: 2020 2020 2072 6566 6572 656e 6365 6420       referenced 
-00042ab0: 656c 7365 7768 6572 6520 6172 6520 6669  elsewhere are fi
-00042ac0: 6c74 6572 6564 206f 7574 2e20 4173 2074  ltered out. As t
-00042ad0: 6869 7320 6973 2074 6865 2064 6566 6175  his is the defau
-00042ae0: 6c74 2062 6568 6176 696f 7572 2c0a 2020  lt behaviour,.  
-00042af0: 2020 2020 2020 6974 2069 7320 696d 706f        it is impo
-00042b00: 7274 616e 7420 746f 2072 6561 6c69 7365  rtant to realise
-00042b10: 2049 4473 2066 6f72 2074 6865 7365 206f   IDs for these o
-00042b20: 626a 6563 7473 206d 6179 2063 6861 6e67  bjects may chang
-00042b30: 6520 7468 726f 7567 680a 2020 2020 2020  e through.      
-00042b40: 2020 7369 6d70 6c69 6669 6361 7469 6f6e    simplification
-00042b50: 2e20 4279 2073 6574 7469 6e67 2074 6865  . By setting the
-00042b60: 7365 2070 6172 616d 6574 6572 7320 746f  se parameters to
-00042b70: 2046 616c 7365 2c20 686f 7765 7665 722c   False, however,
-00042b80: 2074 6865 0a20 2020 2020 2020 2063 6f72   the.        cor
-00042b90: 7265 7370 6f6e 6469 6e67 2074 6162 6c65  responding table
-00042ba0: 7320 6361 6e20 6265 2070 7265 7365 7276  s can be preserv
-00042bb0: 6564 2077 6974 686f 7574 2063 6861 6e67  ed without chang
-00042bc0: 6573 2e0a 0a20 2020 2020 2020 2049 6620  es...        If 
-00042bd0: 6060 6669 6c74 6572 5f6e 6f64 6573 6060  ``filter_nodes``
-00042be0: 2069 7320 4661 6c73 652c 2074 6865 6e20   is False, then 
-00042bf0: 7468 6520 6f75 7470 7574 206e 6f64 6520  the output node 
-00042c00: 7461 626c 6520 7769 6c6c 2062 650a 2020  table will be.  
-00042c10: 2020 2020 2020 756e 6368 616e 6765 6420        unchanged 
-00042c20: 6578 6365 7074 2066 6f72 2075 7064 6174  except for updat
-00042c30: 696e 6720 7468 6520 7361 6d70 6c65 2073  ing the sample s
-00042c40: 7461 7475 7320 6f66 206e 6f64 6573 2061  tatus of nodes a
-00042c50: 6e64 2061 6e79 2049 440a 2020 2020 2020  nd any ID.      
-00042c60: 2020 7265 6d61 7070 696e 6773 2063 6175    remappings cau
-00042c70: 7365 6420 6279 2066 696c 7465 7269 6e67  sed by filtering
-00042c80: 2069 6e64 6976 6964 7561 6c73 2061 6e64   individuals and
-00042c90: 2070 6f70 756c 6174 696f 6e73 2028 6966   populations (if
-00042ca0: 2074 6865 0a20 2020 2020 2020 2060 6066   the.        ``f
-00042cb0: 696c 7465 725f 696e 6469 7669 6475 616c  ilter_individual
-00042cc0: 7360 6020 616e 6420 6060 6669 6c74 6572  s`` and ``filter
-00042cd0: 5f70 6f70 756c 6174 696f 6e73 6060 206f  _populations`` o
-00042ce0: 7074 696f 6e73 2061 7265 2065 6e61 626c  ptions are enabl
-00042cf0: 6564 292e 0a20 2020 2020 2020 204e 6f64  ed)..        Nod
-00042d00: 6573 2074 6861 7420 6172 6520 696e 2074  es that are in t
-00042d10: 6865 2073 7065 6369 6669 6564 206c 6973  he specified lis
-00042d20: 7420 6f66 2060 6073 616d 706c 6573 6060  t of ``samples``
-00042d30: 2077 696c 6c20 6265 206d 6172 6b65 6420   will be marked 
-00042d40: 6173 0a20 2020 2020 2020 2073 616d 706c  as.        sampl
-00042d50: 6573 2069 6e20 7468 6520 6f75 7470 7574  es in the output
-00042d60: 2c20 616e 6420 6e6f 6465 7320 7468 6174  , and nodes that
-00042d70: 2061 7265 2063 7572 7265 6e74 6c79 206d   are currently m
-00042d80: 6172 6b65 6420 6173 2073 616d 706c 6573  arked as samples
-00042d90: 0a20 2020 2020 2020 2069 6e20 7468 6520  .        in the 
-00042da0: 6e6f 6465 2074 6162 6c65 2062 7574 206e  node table but n
-00042db0: 6f74 2069 6e20 7468 6520 7370 6563 6966  ot in the specif
-00042dc0: 6965 6420 6c69 7374 206f 6620 6060 7361  ied list of ``sa
-00042dd0: 6d70 6c65 7360 6020 7769 6c6c 0a20 2020  mples`` will.   
-00042de0: 2020 2020 2068 6176 6520 7468 6569 7220       have their 
-00042df0: 3a64 6174 613a 6074 736b 6974 2e4e 4f44  :data:`tskit.NOD
-00042e00: 455f 4953 5f53 414d 504c 4560 2066 6c61  E_IS_SAMPLE` fla
-00042e10: 6720 636c 6561 7265 642e 204e 6f74 6520  g cleared. Note 
-00042e20: 616c 736f 2074 6861 740a 2020 2020 2020  also that.      
-00042e30: 2020 7468 6520 6f72 6465 7220 6f66 2074    the order of t
-00042e40: 6865 2060 6073 616d 706c 6573 6060 206c  he ``samples`` l
-00042e50: 6973 7420 6973 206e 6f74 206d 6561 6e69  ist is not meani
-00042e60: 6e67 6675 6c20 7768 656e 0a20 2020 2020  ngful when.     
-00042e70: 2020 2060 6066 696c 7465 725f 6e6f 6465     ``filter_node
-00042e80: 7360 6020 6973 2046 616c 7365 2e20 496e  s`` is False. In
-00042e90: 2074 6869 7320 6361 7365 2c20 7468 6520   this case, the 
-00042ea0: 7265 7475 726e 6564 206e 6f64 6520 6d61  returned node ma
-00042eb0: 7070 696e 6720 6973 0a20 2020 2020 2020  pping is.       
-00042ec0: 2061 6c77 6179 7320 7468 6520 6964 656e   always the iden
-00042ed0: 7469 7479 206d 6170 7069 6e67 2c20 7375  tity mapping, su
-00042ee0: 6368 2074 6861 7420 6060 615b 755d 203d  ch that ``a[u] =
-00042ef0: 3d20 7560 6020 666f 7220 616c 6c20 6e6f  = u`` for all no
-00042f00: 6465 732e 0a0a 2020 2020 2020 2020 5365  des...        Se
-00042f10: 7474 696e 6720 7468 6520 6060 7570 6461  tting the ``upda
-00042f20: 7465 5f73 616d 706c 655f 666c 6167 7360  te_sample_flags`
-00042f30: 6020 7061 7261 6d65 7465 7220 746f 2046  ` parameter to F
-00042f40: 616c 7365 2064 6973 6162 6c65 7320 7468  alse disables th
-00042f50: 650a 2020 2020 2020 2020 6175 746f 6d61  e.        automa
-00042f60: 7469 6320 7361 6d70 6c65 2073 7461 7475  tic sample statu
-00042f70: 7320 7570 6461 7465 206f 6620 6e6f 6465  s update of node
-00042f80: 7320 2864 6573 6372 6962 6564 2061 626f  s (described abo
-00042f90: 7665 2920 6672 6f6d 0a20 2020 2020 2020  ve) from.       
-00042fa0: 206f 6363 7572 696e 672c 206d 616b 696e   occuring, makin
-00042fb0: 6720 6974 2074 6865 2072 6573 706f 6e73  g it the respons
-00042fc0: 6962 696c 6974 7920 6f66 2063 616c 6c69  ibility of calli
-00042fd0: 6e67 2063 6f64 6520 746f 206b 6565 7020  ng code to keep 
-00042fe0: 7472 6163 6b20 6f66 0a20 2020 2020 2020  track of.       
-00042ff0: 2074 6865 2075 6c74 696d 6174 6520 7361   the ultimate sa
-00043000: 6d70 6c65 2073 7461 7475 7320 6f66 206e  mple status of n
-00043010: 6f64 6573 2e20 5468 6973 2069 7320 616e  odes. This is an
-00043020: 2061 6476 616e 6365 6420 6f70 7469 6f6e   advanced option
-00043030: 2c20 6d6f 7374 6c79 0a20 2020 2020 2020  , mostly.       
-00043040: 206f 6620 7573 6520 7768 656e 2063 6f6d   of use when com
-00043050: 6269 6e65 6420 7769 7468 2074 6865 2060  bined with the `
-00043060: 6066 696c 7465 725f 6e6f 6465 733d 4661  `filter_nodes=Fa
-00043070: 6c73 6560 602c 0a20 2020 2020 2020 2060  lse``,.        `
-00043080: 6066 696c 7465 725f 706f 7075 6c61 7469  `filter_populati
-00043090: 6f6e 733d 4661 6c73 6560 6020 616e 6420  ons=False`` and 
-000430a0: 6060 6669 6c74 6572 5f69 6e64 6976 6964  ``filter_individ
-000430b0: 7561 6c73 3d46 616c 7365 6060 206f 7074  uals=False`` opt
-000430c0: 696f 6e73 2c0a 2020 2020 2020 2020 7768  ions,.        wh
-000430d0: 6963 6820 7468 656e 2067 7561 7261 6e74  ich then guarant
-000430e0: 6565 7320 7468 6174 2074 6865 206e 6f64  ees that the nod
-000430f0: 6520 7461 626c 6520 7769 6c6c 206e 6f74  e table will not
-00043100: 2062 6520 616c 7465 7265 6420 6279 0a20   be altered by. 
-00043110: 2020 2020 2020 2073 696d 706c 6966 6963         simplific
-00043120: 6174 696f 6e2e 0a0a 2020 2020 2020 2020  ation...        
-00043130: 3a70 6172 616d 206c 6973 745b 696e 745d  :param list[int]
-00043140: 2073 616d 706c 6573 3a20 4120 6c69 7374   samples: A list
-00043150: 206f 6620 6e6f 6465 2049 4473 2074 6f20   of node IDs to 
-00043160: 7265 7461 696e 2061 7320 7361 6d70 6c65  retain as sample
-00043170: 732e 2054 6865 790a 2020 2020 2020 2020  s. They.        
-00043180: 2020 2020 6e65 6564 206e 6f74 2062 6520      need not be 
-00043190: 6e6f 6465 7320 6d61 726b 6564 2061 7320  nodes marked as 
-000431a0: 7361 6d70 6c65 7320 696e 2074 6865 206f  samples in the o
-000431b0: 7269 6769 6e61 6c20 7472 6565 2073 6571  riginal tree seq
-000431c0: 7565 6e63 652c 2062 7574 0a20 2020 2020  uence, but.     
-000431d0: 2020 2020 2020 2077 696c 6c20 636f 6e73         will cons
-000431e0: 7469 7475 7465 2074 6865 2065 6e74 6972  titute the entir
-000431f0: 6520 7365 7420 6f66 2073 616d 706c 6573  e set of samples
-00043200: 2069 6e20 7468 6520 7265 7475 726e 6564   in the returned
-00043210: 2074 7265 6520 7365 7175 656e 6365 2e0a   tree sequence..
-00043220: 2020 2020 2020 2020 2020 2020 4966 206e              If n
-00043230: 6f74 2073 7065 6369 6669 6564 206f 7220  ot specified or 
-00043240: 4e6f 6e65 2c20 7573 6520 616c 6c20 6e6f  None, use all no
-00043250: 6465 7320 6d61 726b 6564 2077 6974 6820  des marked with 
-00043260: 7468 6520 4953 5f53 414d 504c 4520 666c  the IS_SAMPLE fl
-00043270: 6167 2e0a 2020 2020 2020 2020 2020 2020  ag..            
-00043280: 5468 6520 6c69 7374 206d 6179 2062 6520  The list may be 
-00043290: 7072 6f76 6964 6564 2061 7320 6120 6e75  provided as a nu
-000432a0: 6d70 7920 6172 7261 7920 286f 7220 6172  mpy array (or ar
-000432b0: 7261 792d 6c69 6b65 2920 6f62 6a65 6374  ray-like) object
-000432c0: 0a20 2020 2020 2020 2020 2020 2028 6474  .            (dt
-000432d0: 7970 653d 6e70 2e69 6e74 3332 292e 0a20  ype=np.int32).. 
-000432e0: 2020 2020 2020 203a 7061 7261 6d20 626f         :param bo
-000432f0: 6f6c 206d 6170 5f6e 6f64 6573 3a20 4966  ol map_nodes: If
-00043300: 2054 7275 652c 2072 6574 7572 6e20 6120   True, return a 
-00043310: 7475 706c 6520 636f 6e74 6169 6e69 6e67  tuple containing
-00043320: 2074 6865 2072 6573 756c 7469 6e67 0a20   the resulting. 
-00043330: 2020 2020 2020 2020 2020 2074 7265 6520             tree 
-00043340: 7365 7175 656e 6365 2061 6e64 2061 206e  sequence and a n
-00043350: 756d 7079 2061 7272 6179 206d 6170 7069  umpy array mappi
-00043360: 6e67 206e 6f64 6520 4944 7320 696e 2074  ng node IDs in t
-00043370: 6865 2063 7572 7265 6e74 2074 7265 650a  he current tree.
-00043380: 2020 2020 2020 2020 2020 2020 7365 7175              sequ
-00043390: 656e 6365 2074 6f20 7468 6569 7220 636f  ence to their co
-000433a0: 7272 6573 706f 6e64 696e 6720 6e6f 6465  rresponding node
-000433b0: 2049 4473 2069 6e20 7468 6520 7265 7475   IDs in the retu
-000433c0: 726e 6564 2074 7265 6520 7365 7175 656e  rned tree sequen
-000433d0: 6365 2e0a 2020 2020 2020 2020 2020 2020  ce..            
-000433e0: 4966 2046 616c 7365 2028 7468 6520 6465  If False (the de
-000433f0: 6661 756c 7429 2c20 7265 7475 726e 206f  fault), return o
-00043400: 6e6c 7920 7468 6520 7472 6565 2073 6571  nly the tree seq
-00043410: 7565 6e63 6520 6f62 6a65 6374 2069 7473  uence object its
-00043420: 656c 662e 0a20 2020 2020 2020 203a 7061  elf..        :pa
-00043430: 7261 6d20 626f 6f6c 2072 6564 7563 655f  ram bool reduce_
-00043440: 746f 5f73 6974 655f 746f 706f 6c6f 6779  to_site_topology
-00043450: 3a20 5768 6574 6865 7220 746f 2072 6564  : Whether to red
-00043460: 7563 6520 7468 6520 746f 706f 6c6f 6779  uce the topology
-00043470: 2064 6f77 6e0a 2020 2020 2020 2020 2020   down.          
-00043480: 2020 746f 2074 6865 2074 7265 6573 2074    to the trees t
-00043490: 6861 7420 6172 6520 7072 6573 656e 7420  hat are present 
-000434a0: 6174 2073 6974 6573 2e20 2844 6566 6175  at sites. (Defau
-000434b0: 6c74 3a20 4661 6c73 6529 0a20 2020 2020  lt: False).     
-000434c0: 2020 203a 7061 7261 6d20 626f 6f6c 2066     :param bool f
-000434d0: 696c 7465 725f 706f 7075 6c61 7469 6f6e  ilter_population
-000434e0: 733a 2049 6620 5472 7565 2c20 7265 6d6f  s: If True, remo
-000434f0: 7665 2061 6e79 2070 6f70 756c 6174 696f  ve any populatio
-00043500: 6e73 2074 6861 7420 6172 650a 2020 2020  ns that are.    
-00043510: 2020 2020 2020 2020 6e6f 7420 7265 6665          not refe
-00043520: 7265 6e63 6564 2062 7920 6e6f 6465 7320  renced by nodes 
-00043530: 6166 7465 7220 7369 6d70 6c69 6669 6361  after simplifica
-00043540: 7469 6f6e 3b20 6e65 7720 706f 7075 6c61  tion; new popula
-00043550: 7469 6f6e 2049 4473 2061 7265 0a20 2020  tion IDs are.   
-00043560: 2020 2020 2020 2020 2061 6c6c 6f63 6174           allocat
-00043570: 6564 2073 6571 7565 6e74 6961 6c6c 7920  ed sequentially 
-00043580: 6672 6f6d 207a 6572 6f2e 2049 6620 4661  from zero. If Fa
-00043590: 6c73 652c 2074 6865 2070 6f70 756c 6174  lse, the populat
-000435a0: 696f 6e20 7461 626c 6520 7769 6c6c 0a20  ion table will. 
-000435b0: 2020 2020 2020 2020 2020 206e 6f74 2062             not b
-000435c0: 6520 616c 7465 7265 6420 696e 2061 6e79  e altered in any
-000435d0: 2077 6179 2e20 2844 6566 6175 6c74 3a20   way. (Default: 
-000435e0: 4e6f 6e65 2c20 7472 6561 7465 6420 6173  None, treated as
-000435f0: 2054 7275 6529 0a20 2020 2020 2020 203a   True).        :
-00043600: 7061 7261 6d20 626f 6f6c 2066 696c 7465  param bool filte
-00043610: 725f 696e 6469 7669 6475 616c 733a 2049  r_individuals: I
-00043620: 6620 5472 7565 2c20 7265 6d6f 7665 2061  f True, remove a
-00043630: 6e79 2069 6e64 6976 6964 7561 6c73 2074  ny individuals t
-00043640: 6861 7420 6172 650a 2020 2020 2020 2020  hat are.        
-00043650: 2020 2020 6e6f 7420 7265 6665 7265 6e63      not referenc
-00043660: 6564 2062 7920 6e6f 6465 7320 6166 7465  ed by nodes afte
-00043670: 7220 7369 6d70 6c69 6669 6361 7469 6f6e  r simplification
-00043680: 3b20 6e65 7720 696e 6469 7669 6475 616c  ; new individual
-00043690: 2049 4473 2061 7265 0a20 2020 2020 2020   IDs are.       
-000436a0: 2020 2020 2061 6c6c 6f63 6174 6564 2073       allocated s
-000436b0: 6571 7565 6e74 6961 6c6c 7920 6672 6f6d  equentially from
-000436c0: 207a 6572 6f2e 2049 6620 4661 6c73 652c   zero. If False,
-000436d0: 2074 6865 2069 6e64 6976 6964 7561 6c20   the individual 
-000436e0: 7461 626c 6520 7769 6c6c 0a20 2020 2020  table will.     
-000436f0: 2020 2020 2020 206e 6f74 2062 6520 616c         not be al
-00043700: 7465 7265 6420 696e 2061 6e79 2077 6179  tered in any way
-00043710: 2e20 2844 6566 6175 6c74 3a20 4e6f 6e65  . (Default: None
-00043720: 2c20 7472 6561 7465 6420 6173 2054 7275  , treated as Tru
-00043730: 6529 0a20 2020 2020 2020 203a 7061 7261  e).        :para
-00043740: 6d20 626f 6f6c 2066 696c 7465 725f 7369  m bool filter_si
-00043750: 7465 733a 2049 6620 5472 7565 2c20 7265  tes: If True, re
-00043760: 6d6f 7665 2061 6e79 2073 6974 6573 2074  move any sites t
-00043770: 6861 7420 6172 650a 2020 2020 2020 2020  hat are.        
-00043780: 2020 2020 6e6f 7420 7265 6665 7265 6e63      not referenc
-00043790: 6564 2062 7920 6d75 7461 7469 6f6e 7320  ed by mutations 
-000437a0: 6166 7465 7220 7369 6d70 6c69 6669 6361  after simplifica
-000437b0: 7469 6f6e 3b20 6e65 7720 7369 7465 2049  tion; new site I
-000437c0: 4473 2061 7265 0a20 2020 2020 2020 2020  Ds are.         
-000437d0: 2020 2061 6c6c 6f63 6174 6564 2073 6571     allocated seq
-000437e0: 7565 6e74 6961 6c6c 7920 6672 6f6d 207a  uentially from z
-000437f0: 6572 6f2e 2049 6620 4661 6c73 652c 2074  ero. If False, t
-00043800: 6865 2073 6974 6520 7461 626c 6520 7769  he site table wi
-00043810: 6c6c 206e 6f74 0a20 2020 2020 2020 2020  ll not.         
-00043820: 2020 2062 6520 616c 7465 7265 6420 696e     be altered in
-00043830: 2061 6e79 2077 6179 2e20 2844 6566 6175   any way. (Defau
-00043840: 6c74 3a20 4e6f 6e65 2c20 7472 6561 7465  lt: None, treate
-00043850: 6420 6173 2054 7275 6529 0a20 2020 2020  d as True).     
-00043860: 2020 203a 7061 7261 6d20 626f 6f6c 2066     :param bool f
-00043870: 696c 7465 725f 6e6f 6465 733a 2049 6620  ilter_nodes: If 
-00043880: 5472 7565 2c20 7265 6d6f 7665 2061 6e79  True, remove any
-00043890: 206e 6f64 6573 2074 6861 7420 6172 650a   nodes that are.
-000438a0: 2020 2020 2020 2020 2020 2020 6e6f 7420              not 
-000438b0: 7265 6665 7265 6e63 6564 2062 7920 6564  referenced by ed
-000438c0: 6765 7320 6166 7465 7220 7369 6d70 6c69  ges after simpli
-000438d0: 6669 6361 7469 6f6e 2e20 4966 2046 616c  fication. If Fal
-000438e0: 7365 2c20 7468 6520 6f6e 6c79 0a20 2020  se, the only.   
-000438f0: 2020 2020 2020 2020 2070 6f74 656e 7469           potenti
-00043900: 616c 2063 6861 6e67 6520 746f 2074 6865  al change to the
-00043910: 206e 6f64 6520 7461 626c 6520 6d61 7920   node table may 
-00043920: 6265 2074 6f20 6368 616e 6765 2074 6865  be to change the
-00043930: 206e 6f64 6520 666c 6167 730a 2020 2020   node flags.    
-00043940: 2020 2020 2020 2020 2869 6620 6060 7361          (if ``sa
-00043950: 6d70 6c65 7360 6020 6973 2073 7065 6369  mples`` is speci
-00043960: 6669 6564 2061 6e64 2064 6966 6665 7265  fied and differe
-00043970: 6e74 2066 726f 6d20 7468 6520 6578 6973  nt from the exis
-00043980: 7469 6e67 2073 616d 706c 6573 292e 0a20  ting samples).. 
-00043990: 2020 2020 2020 2020 2020 2028 4465 6661             (Defa
-000439a0: 756c 743a 204e 6f6e 652c 2074 7265 6174  ult: None, treat
-000439b0: 6564 2061 7320 5472 7565 290a 2020 2020  ed as True).    
-000439c0: 2020 2020 3a70 6172 616d 2062 6f6f 6c20      :param bool 
-000439d0: 7570 6461 7465 5f73 616d 706c 655f 666c  update_sample_fl
-000439e0: 6167 733a 2049 6620 5472 7565 2c20 7570  ags: If True, up
-000439f0: 6461 7465 206e 6f64 6520 666c 6167 7320  date node flags 
-00043a00: 746f 2073 6f20 7468 6174 0a20 2020 2020  to so that.     
-00043a10: 2020 2020 2020 206e 6f64 6573 2069 6e20         nodes in 
-00043a20: 7468 6520 7370 6563 6966 6965 6420 6c69  the specified li
-00043a30: 7374 206f 6620 7361 6d70 6c65 7320 6861  st of samples ha
-00043a40: 7665 2074 6865 204e 4f44 455f 4953 5f53  ve the NODE_IS_S
-00043a50: 414d 504c 450a 2020 2020 2020 2020 2020  AMPLE.          
-00043a60: 2020 666c 6167 2061 6674 6572 2073 696d    flag after sim
-00043a70: 706c 6966 6963 6174 696f 6e2c 2061 6e64  plification, and
-00043a80: 206e 6f64 6573 2074 6861 7420 6172 6520   nodes that are 
-00043a90: 6e6f 7420 696e 2074 6869 7320 6c69 7374  not in this list
-00043aa0: 0a20 2020 2020 2020 2020 2020 2064 6f20  .            do 
-00043ab0: 6e6f 742e 2028 4465 6661 756c 743a 204e  not. (Default: N
-00043ac0: 6f6e 652c 2074 7265 6174 6564 2061 7320  one, treated as 
-00043ad0: 5472 7565 290a 2020 2020 2020 2020 3a70  True).        :p
-00043ae0: 6172 616d 2062 6f6f 6c20 6b65 6570 5f75  aram bool keep_u
-00043af0: 6e61 7279 3a20 4966 2054 7275 652c 2070  nary: If True, p
-00043b00: 7265 7365 7276 6520 756e 6172 7920 6e6f  reserve unary no
-00043b10: 6465 7320 2869 2e65 2e2c 206e 6f64 6573  des (i.e., nodes
-00043b20: 2077 6974 680a 2020 2020 2020 2020 2020   with.          
-00043b30: 2020 6578 6163 746c 7920 6f6e 6520 6368    exactly one ch
-00043b40: 696c 6429 2074 6861 7420 6578 6973 7420  ild) that exist 
-00043b50: 6f6e 2074 6865 2070 6174 6820 6672 6f6d  on the path from
-00043b60: 2073 616d 706c 6573 2074 6f20 726f 6f74   samples to root
-00043b70: 2e0a 2020 2020 2020 2020 2020 2020 2844  ..            (D
-00043b80: 6566 6175 6c74 3a20 4661 6c73 6529 0a20  efault: False). 
-00043b90: 2020 2020 2020 203a 7061 7261 6d20 626f         :param bo
-00043ba0: 6f6c 206b 6565 705f 756e 6172 795f 696e  ol keep_unary_in
-00043bb0: 5f69 6e64 6976 6964 7561 6c73 3a20 4966  _individuals: If
-00043bc0: 2054 7275 652c 2070 7265 7365 7276 6520   True, preserve 
-00043bd0: 756e 6172 7920 6e6f 6465 730a 2020 2020  unary nodes.    
-00043be0: 2020 2020 2020 2020 7468 6174 2065 7869          that exi
-00043bf0: 7374 206f 6e20 7468 6520 7061 7468 2066  st on the path f
-00043c00: 726f 6d20 7361 6d70 6c65 7320 746f 2072  rom samples to r
-00043c10: 6f6f 742c 2062 7574 206f 6e6c 7920 6966  oot, but only if
-00043c20: 2074 6865 7920 6172 650a 2020 2020 2020   they are.      
-00043c30: 2020 2020 2020 6173 736f 6369 6174 6564        associated
-00043c40: 2077 6974 6820 616e 2069 6e64 6976 6964   with an individ
-00043c50: 7561 6c20 696e 2074 6865 2069 6e64 6976  ual in the indiv
-00043c60: 6964 7561 6c73 2074 6162 6c65 2e20 4361  iduals table. Ca
-00043c70: 6e6e 6f74 2062 650a 2020 2020 2020 2020  nnot be.        
-00043c80: 2020 2020 7370 6563 6966 6965 6420 6174      specified at
-00043c90: 2074 6865 2073 616d 6520 7469 6d65 2061   the same time a
-00043ca0: 7320 6060 6b65 6570 5f75 6e61 7279 6060  s ``keep_unary``
-00043cb0: 2e20 2844 6566 6175 6c74 3a20 6060 4e6f  . (Default: ``No
-00043cc0: 6e65 6060 2c0a 2020 2020 2020 2020 2020  ne``,.          
-00043cd0: 2020 6571 7569 7661 6c65 6e74 2074 6f20    equivalent to 
-00043ce0: 4661 6c73 6529 0a20 2020 2020 2020 203a  False).        :
-00043cf0: 7061 7261 6d20 626f 6f6c 206b 6565 705f  param bool keep_
-00043d00: 696e 7075 745f 726f 6f74 733a 2057 6865  input_roots: Whe
-00043d10: 7468 6572 2074 6f20 7265 7461 696e 2068  ther to retain h
-00043d20: 6973 746f 7279 2061 6e63 6573 7472 616c  istory ancestral
-00043d30: 2074 6f20 7468 650a 2020 2020 2020 2020   to the.        
-00043d40: 2020 2020 4d52 4341 206f 6620 7468 6520      MRCA of the 
-00043d50: 7361 6d70 6c65 732e 2049 6620 6060 4661  samples. If ``Fa
-00043d60: 6c73 6560 602c 206e 6f20 746f 706f 6c6f  lse``, no topolo
-00043d70: 6779 206f 6c64 6572 2074 6861 6e20 7468  gy older than th
-00043d80: 6520 4d52 4341 7320 6f66 2074 6865 0a20  e MRCAs of the. 
-00043d90: 2020 2020 2020 2020 2020 2073 616d 706c             sampl
-00043da0: 6573 2077 696c 6c20 6265 2069 6e63 6c75  es will be inclu
-00043db0: 6465 642e 2049 6620 6060 5472 7565 6060  ded. If ``True``
-00043dc0: 2074 6865 2072 6f6f 7473 206f 6620 616c   the roots of al
-00043dd0: 6c20 7472 6565 7320 696e 2074 6865 2072  l trees in the r
-00043de0: 6574 7572 6e65 640a 2020 2020 2020 2020  eturned.        
-00043df0: 2020 2020 7472 6565 2073 6571 7565 6e63      tree sequenc
-00043e00: 6520 7769 6c6c 2062 6520 7468 6520 7361  e will be the sa
-00043e10: 6d65 2072 6f6f 7473 2061 7320 696e 2074  me roots as in t
-00043e20: 6865 206f 7269 6769 6e61 6c20 7472 6565  he original tree
-00043e30: 2073 6571 7565 6e63 652e 0a20 2020 2020   sequence..     
-00043e40: 2020 2020 2020 2028 4465 6661 756c 743a         (Default:
-00043e50: 2046 616c 7365 290a 2020 2020 2020 2020   False).        
-00043e60: 3a70 6172 616d 2062 6f6f 6c20 7265 636f  :param bool reco
-00043e70: 7264 5f70 726f 7665 6e61 6e63 653a 2049  rd_provenance: I
-00043e80: 6620 5472 7565 2c20 7265 636f 7264 2064  f True, record d
-00043e90: 6574 6169 6c73 206f 6620 7468 6973 2063  etails of this c
-00043ea0: 616c 6c20 746f 0a20 2020 2020 2020 2020  all to.         
-00043eb0: 2020 2073 696d 706c 6966 7920 696e 2074     simplify in t
-00043ec0: 6865 2072 6574 7572 6e65 6420 7472 6565  he returned tree
-00043ed0: 2073 6571 7565 6e63 6527 7320 7072 6f76   sequence's prov
-00043ee0: 656e 616e 6365 2069 6e66 6f72 6d61 7469  enance informati
-00043ef0: 6f6e 0a20 2020 2020 2020 2020 2020 2028  on.            (
-00043f00: 4465 6661 756c 743a 2054 7275 6529 2e0a  Default: True)..
-00043f10: 2020 2020 2020 2020 3a70 6172 616d 2062          :param b
-00043f20: 6f6f 6c20 6669 6c74 6572 5f7a 6572 6f5f  ool filter_zero_
-00043f30: 6d75 7461 7469 6f6e 5f73 6974 6573 3a20  mutation_sites: 
-00043f40: 4465 7072 6563 6174 6564 2061 6c69 6173  Deprecated alias
-00043f50: 2066 6f72 2060 6066 696c 7465 725f 7369   for ``filter_si
-00043f60: 7465 7360 602e 0a20 2020 2020 2020 203a  tes``..        :
-00043f70: 7265 7475 726e 3a20 5468 6520 7369 6d70  return: The simp
-00043f80: 6c69 6669 6564 2074 7265 6520 7365 7175  lified tree sequ
-00043f90: 656e 6365 2c20 6f72 2028 6966 2060 606d  ence, or (if ``m
-00043fa0: 6170 5f6e 6f64 6573 6060 2069 7320 5472  ap_nodes`` is Tr
-00043fb0: 7565 290a 2020 2020 2020 2020 2020 2020  ue).            
-00043fc0: 6120 7475 706c 6520 636f 6e73 6973 7469  a tuple consisti
-00043fd0: 6e67 206f 6620 7468 6520 7369 6d70 6c69  ng of the simpli
-00043fe0: 6669 6564 2074 7265 6520 7365 7175 656e  fied tree sequen
-00043ff0: 6365 2061 6e64 2061 206e 756d 7079 2061  ce and a numpy a
-00044000: 7272 6179 0a20 2020 2020 2020 2020 2020  rray.           
-00044010: 206d 6170 7069 6e67 2073 6f75 7263 6520   mapping source 
-00044020: 6e6f 6465 2049 4473 2074 6f20 7468 6569  node IDs to thei
-00044030: 7220 636f 7272 6573 706f 6e64 696e 6720  r corresponding 
-00044040: 4944 7320 696e 2074 6865 206e 6577 2074  IDs in the new t
-00044050: 7265 650a 2020 2020 2020 2020 2020 2020  ree.            
-00044060: 7365 7175 656e 6365 2e0a 2020 2020 2020  sequence..      
-00044070: 2020 3a72 7479 7065 3a20 7473 6b69 742e    :rtype: tskit.
-00044080: 5472 6565 5365 7175 656e 6365 206f 7220  TreeSequence or 
-00044090: 2874 736b 6974 2e54 7265 6553 6571 7565  (tskit.TreeSeque
-000440a0: 6e63 652c 206e 756d 7079 2e6e 6461 7272  nce, numpy.ndarr
-000440b0: 6179 290a 2020 2020 2020 2020 2222 220a  ay).        """.
-000440c0: 2020 2020 2020 2020 7461 626c 6573 203d          tables =
-000440d0: 2073 656c 662e 6475 6d70 5f74 6162 6c65   self.dump_table
-000440e0: 7328 290a 2020 2020 2020 2020 6173 7365  s().        asse
-000440f0: 7274 2074 6162 6c65 732e 7365 7175 656e  rt tables.sequen
-00044100: 6365 5f6c 656e 6774 6820 3d3d 2073 656c  ce_length == sel
-00044110: 662e 7365 7175 656e 6365 5f6c 656e 6774  f.sequence_lengt
-00044120: 680a 2020 2020 2020 2020 6e6f 6465 5f6d  h.        node_m
-00044130: 6170 203d 2074 6162 6c65 732e 7369 6d70  ap = tables.simp
-00044140: 6c69 6679 280a 2020 2020 2020 2020 2020  lify(.          
-00044150: 2020 7361 6d70 6c65 733d 7361 6d70 6c65    samples=sample
-00044160: 732c 0a20 2020 2020 2020 2020 2020 2072  s,.            r
-00044170: 6564 7563 655f 746f 5f73 6974 655f 746f  educe_to_site_to
-00044180: 706f 6c6f 6779 3d72 6564 7563 655f 746f  pology=reduce_to
-00044190: 5f73 6974 655f 746f 706f 6c6f 6779 2c0a  _site_topology,.
-000441a0: 2020 2020 2020 2020 2020 2020 6669 6c74              filt
-000441b0: 6572 5f70 6f70 756c 6174 696f 6e73 3d66  er_populations=f
-000441c0: 696c 7465 725f 706f 7075 6c61 7469 6f6e  ilter_population
-000441d0: 732c 0a20 2020 2020 2020 2020 2020 2066  s,.            f
-000441e0: 696c 7465 725f 696e 6469 7669 6475 616c  ilter_individual
-000441f0: 733d 6669 6c74 6572 5f69 6e64 6976 6964  s=filter_individ
-00044200: 7561 6c73 2c0a 2020 2020 2020 2020 2020  uals,.          
-00044210: 2020 6669 6c74 6572 5f73 6974 6573 3d66    filter_sites=f
-00044220: 696c 7465 725f 7369 7465 732c 0a20 2020  ilter_sites,.   
-00044230: 2020 2020 2020 2020 2066 696c 7465 725f           filter_
-00044240: 6e6f 6465 733d 6669 6c74 6572 5f6e 6f64  nodes=filter_nod
-00044250: 6573 2c0a 2020 2020 2020 2020 2020 2020  es,.            
-00044260: 7570 6461 7465 5f73 616d 706c 655f 666c  update_sample_fl
-00044270: 6167 733d 7570 6461 7465 5f73 616d 706c  ags=update_sampl
-00044280: 655f 666c 6167 732c 0a20 2020 2020 2020  e_flags,.       
-00044290: 2020 2020 206b 6565 705f 756e 6172 793d       keep_unary=
-000442a0: 6b65 6570 5f75 6e61 7279 2c0a 2020 2020  keep_unary,.    
-000442b0: 2020 2020 2020 2020 6b65 6570 5f75 6e61          keep_una
-000442c0: 7279 5f69 6e5f 696e 6469 7669 6475 616c  ry_in_individual
-000442d0: 733d 6b65 6570 5f75 6e61 7279 5f69 6e5f  s=keep_unary_in_
-000442e0: 696e 6469 7669 6475 616c 732c 0a20 2020  individuals,.   
-000442f0: 2020 2020 2020 2020 206b 6565 705f 696e           keep_in
-00044300: 7075 745f 726f 6f74 733d 6b65 6570 5f69  put_roots=keep_i
-00044310: 6e70 7574 5f72 6f6f 7473 2c0a 2020 2020  nput_roots,.    
-00044320: 2020 2020 2020 2020 7265 636f 7264 5f70          record_p
-00044330: 726f 7665 6e61 6e63 653d 7265 636f 7264  rovenance=record
-00044340: 5f70 726f 7665 6e61 6e63 652c 0a20 2020  _provenance,.   
-00044350: 2020 2020 2020 2020 2066 696c 7465 725f           filter_
-00044360: 7a65 726f 5f6d 7574 6174 696f 6e5f 7369  zero_mutation_si
-00044370: 7465 733d 6669 6c74 6572 5f7a 6572 6f5f  tes=filter_zero_
-00044380: 6d75 7461 7469 6f6e 5f73 6974 6573 2c0a  mutation_sites,.
-00044390: 2020 2020 2020 2020 290a 2020 2020 2020          ).      
-000443a0: 2020 6e65 775f 7473 203d 2074 6162 6c65    new_ts = table
-000443b0: 732e 7472 6565 5f73 6571 7565 6e63 6528  s.tree_sequence(
-000443c0: 290a 2020 2020 2020 2020 6173 7365 7274  ).        assert
-000443d0: 206e 6577 5f74 732e 7365 7175 656e 6365   new_ts.sequence
-000443e0: 5f6c 656e 6774 6820 3d3d 2073 656c 662e  _length == self.
-000443f0: 7365 7175 656e 6365 5f6c 656e 6774 680a  sequence_length.
-00044400: 2020 2020 2020 2020 6966 206d 6170 5f6e          if map_n
-00044410: 6f64 6573 3a0a 2020 2020 2020 2020 2020  odes:.          
-00044420: 2020 7265 7475 726e 206e 6577 5f74 732c    return new_ts,
-00044430: 206e 6f64 655f 6d61 700a 2020 2020 2020   node_map.      
-00044440: 2020 656c 7365 3a0a 2020 2020 2020 2020    else:.        
-00044450: 2020 2020 7265 7475 726e 206e 6577 5f74      return new_t
-00044460: 730a 0a20 2020 2064 6566 2064 656c 6574  s..    def delet
-00044470: 655f 7369 7465 7328 7365 6c66 2c20 7369  e_sites(self, si
-00044480: 7465 5f69 6473 2c20 7265 636f 7264 5f70  te_ids, record_p
-00044490: 726f 7665 6e61 6e63 653d 5472 7565 293a  rovenance=True):
-000444a0: 0a20 2020 2020 2020 2022 2222 0a20 2020  .        """.   
-000444b0: 2020 2020 2052 6574 7572 6e73 2061 2063       Returns a c
-000444c0: 6f70 7920 6f66 2074 6869 7320 7472 6565  opy of this tree
-000444d0: 2073 6571 7565 6e63 6520 7769 7468 2074   sequence with t
-000444e0: 6865 2073 7065 6369 6669 6564 2073 6974  he specified sit
-000444f0: 6573 2028 616e 6420 7468 6569 720a 2020  es (and their.  
-00044500: 2020 2020 2020 6173 736f 6369 6174 6564        associated
-00044510: 206d 7574 6174 696f 6e73 2920 656e 7469   mutations) enti
-00044520: 7265 6c79 2072 656d 6f76 6564 2e20 5468  rely removed. Th
-00044530: 6520 7369 7465 2049 4473 2064 6f20 6e6f  e site IDs do no
-00044540: 7420 6e65 6564 2074 6f20 6265 2069 6e20  t need to be in 
-00044550: 616e 790a 2020 2020 2020 2020 7061 7274  any.        part
-00044560: 6963 756c 6172 206f 7264 6572 2c20 616e  icular order, an
-00044570: 6420 7370 6563 6966 7969 6e67 2074 6865  d specifying the
-00044580: 2073 616d 6520 4944 206d 756c 7469 706c   same ID multipl
-00044590: 6520 7469 6d65 7320 646f 6573 206e 6f74  e times does not
-000445a0: 2068 6176 6520 616e 790a 2020 2020 2020   have any.      
-000445b0: 2020 6566 6665 6374 2028 692e 652e 2c20    effect (i.e., 
-000445c0: 6361 6c6c 696e 6720 6060 7472 6565 5f73  calling ``tree_s
-000445d0: 6571 7565 6e63 652e 6465 6c65 7465 5f73  equence.delete_s
-000445e0: 6974 6573 285b 302c 2031 2c20 315d 2960  ites([0, 1, 1])`
-000445f0: 6020 6861 7320 7468 6520 7361 6d65 0a20  ` has the same. 
-00044600: 2020 2020 2020 2065 6666 6563 7420 6173         effect as
-00044610: 2063 616c 6c69 6e67 2060 6074 7265 655f   calling ``tree_
-00044620: 7365 7175 656e 6365 2e64 656c 6574 655f  sequence.delete_
-00044630: 7369 7465 7328 5b30 2c20 315d 2960 602e  sites([0, 1])``.
-00044640: 0a0a 2020 2020 2020 2020 3a70 6172 616d  ..        :param
-00044650: 206c 6973 745b 696e 745d 2073 6974 655f   list[int] site_
-00044660: 6964 733a 2041 206c 6973 7420 6f66 2073  ids: A list of s
-00044670: 6974 6520 4944 7320 7370 6563 6966 7969  ite IDs specifyi
-00044680: 6e67 2074 6865 2073 6974 6573 2074 6f20  ng the sites to 
-00044690: 7265 6d6f 7665 2e0a 2020 2020 2020 2020  remove..        
-000446a0: 3a70 6172 616d 2062 6f6f 6c20 7265 636f  :param bool reco
-000446b0: 7264 5f70 726f 7665 6e61 6e63 653a 2049  rd_provenance: I
-000446c0: 6620 6060 5472 7565 6060 2c20 6164 6420  f ``True``, add 
-000446d0: 6465 7461 696c 7320 6f66 2074 6869 7320  details of this 
-000446e0: 6f70 6572 6174 696f 6e20 746f 2074 6865  operation to the
-000446f0: 0a20 2020 2020 2020 2020 2020 2070 726f  .            pro
-00044700: 7665 6e61 6e63 6520 696e 666f 726d 6174  venance informat
-00044710: 696f 6e20 6f66 2074 6865 2072 6574 7572  ion of the retur
-00044720: 6e65 6420 7472 6565 2073 6571 7565 6e63  ned tree sequenc
-00044730: 652e 2028 4465 6661 756c 743a 2060 6054  e. (Default: ``T
-00044740: 7275 6560 6029 2e0a 2020 2020 2020 2020  rue``)..        
-00044750: 2222 220a 2020 2020 2020 2020 7461 626c  """.        tabl
-00044760: 6573 203d 2073 656c 662e 6475 6d70 5f74  es = self.dump_t
-00044770: 6162 6c65 7328 290a 2020 2020 2020 2020  ables().        
-00044780: 7461 626c 6573 2e64 656c 6574 655f 7369  tables.delete_si
-00044790: 7465 7328 7369 7465 5f69 6473 2c20 7265  tes(site_ids, re
-000447a0: 636f 7264 5f70 726f 7665 6e61 6e63 6529  cord_provenance)
-000447b0: 0a20 2020 2020 2020 2072 6574 7572 6e20  .        return 
-000447c0: 7461 626c 6573 2e74 7265 655f 7365 7175  tables.tree_sequ
-000447d0: 656e 6365 2829 0a0a 2020 2020 6465 6620  ence()..    def 
-000447e0: 6465 6c65 7465 5f69 6e74 6572 7661 6c73  delete_intervals
-000447f0: 2873 656c 662c 2069 6e74 6572 7661 6c73  (self, intervals
-00044800: 2c20 7369 6d70 6c69 6679 3d54 7275 652c  , simplify=True,
-00044810: 2072 6563 6f72 645f 7072 6f76 656e 616e   record_provenan
-00044820: 6365 3d54 7275 6529 3a0a 2020 2020 2020  ce=True):.      
-00044830: 2020 2222 220a 2020 2020 2020 2020 5265    """.        Re
-00044840: 7475 726e 7320 6120 636f 7079 206f 6620  turns a copy of 
-00044850: 7468 6973 2074 7265 6520 7365 7175 656e  this tree sequen
-00044860: 6365 2066 6f72 2077 6869 6368 2069 6e66  ce for which inf
-00044870: 6f72 6d61 7469 6f6e 2069 6e20 7468 650a  ormation in the.
-00044880: 2020 2020 2020 2020 7370 6563 6966 6965          specifie
-00044890: 6420 6c69 7374 206f 6620 6765 6e6f 6d69  d list of genomi
-000448a0: 6320 696e 7465 7276 616c 7320 6861 7320  c intervals has 
-000448b0: 6265 656e 2064 656c 6574 6564 2e20 4564  been deleted. Ed
-000448c0: 6765 7320 7370 616e 6e69 6e67 2074 6865  ges spanning the
-000448d0: 7365 0a20 2020 2020 2020 2069 6e74 6572  se.        inter
-000448e0: 7661 6c73 2061 7265 2074 7275 6e63 6174  vals are truncat
-000448f0: 6564 206f 7220 6465 6c65 7465 642c 2061  ed or deleted, a
-00044900: 6e64 2073 6974 6573 2061 6e64 206d 7574  nd sites and mut
-00044910: 6174 696f 6e73 2066 616c 6c69 6e67 2077  ations falling w
-00044920: 6974 6869 6e0a 2020 2020 2020 2020 7468  ithin.        th
-00044930: 656d 2061 7265 2064 6973 6361 7264 6564  em are discarded
-00044940: 2e20 4e6f 7465 2074 6861 7420 6974 2069  . Note that it i
-00044950: 7320 7468 6520 696e 666f 726d 6174 696f  s the informatio
-00044960: 6e20 696e 2074 6865 2069 6e74 6572 7661  n in the interva
-00044970: 6c73 2074 6861 740a 2020 2020 2020 2020  ls that.        
-00044980: 6973 2064 656c 6574 6564 2c20 6e6f 7420  is deleted, not 
-00044990: 7468 6520 696e 7465 7276 616c 7320 7468  the intervals th
-000449a0: 656d 7365 6c76 6573 2c20 736f 2069 6e20  emselves, so in 
-000449b0: 7061 7274 6963 756c 6172 2c20 616c 6c20  particular, all 
-000449c0: 7361 6d70 6c65 730a 2020 2020 2020 2020  samples.        
-000449d0: 7769 6c6c 2062 6520 6973 6f6c 6174 6564  will be isolated
-000449e0: 2069 6e20 7468 6520 6465 6c65 7465 6420   in the deleted 
-000449f0: 696e 7465 7276 616c 732e 0a0a 2020 2020  intervals...    
-00044a00: 2020 2020 4e6f 7465 2074 6861 7420 6e6f      Note that no
-00044a10: 6465 2049 4473 206d 6179 2063 6861 6e67  de IDs may chang
-00044a20: 6520 6173 2061 2072 6573 756c 7420 6f66  e as a result of
-00044a30: 2074 6869 7320 6f70 6572 6174 696f 6e2c   this operation,
-00044a40: 0a20 2020 2020 2020 2061 7320 6279 2064  .        as by d
-00044a50: 6566 6175 6c74 203a 6d65 7468 3a60 2e73  efault :meth:`.s
-00044a60: 696d 706c 6966 7960 2069 7320 6361 6c6c  implify` is call
-00044a70: 6564 206f 6e20 7468 6520 7265 7475 726e  ed on the return
-00044a80: 6564 2074 7265 6520 7365 7175 656e 6365  ed tree sequence
-00044a90: 0a20 2020 2020 2020 2074 6f20 7265 6d6f  .        to remo
-00044aa0: 7665 2072 6564 756e 6461 6e74 206e 6f64  ve redundant nod
-00044ab0: 6573 2e20 4966 2079 6f75 2077 6973 6820  es. If you wish 
-00044ac0: 746f 206d 6170 206e 6f64 6520 4944 7320  to map node IDs 
-00044ad0: 6f6e 746f 2074 6865 2073 616d 650a 2020  onto the same.  
-00044ae0: 2020 2020 2020 6e6f 6465 7320 6265 666f        nodes befo
-00044af0: 7265 2061 6e64 2061 6674 6572 2074 6869  re and after thi
-00044b00: 7320 6d65 7468 6f64 2068 6173 2062 6565  s method has bee
-00044b10: 6e20 6361 6c6c 6564 2c20 7370 6563 6966  n called, specif
-00044b20: 7920 6060 7369 6d70 6c69 6679 3d46 616c  y ``simplify=Fal
-00044b30: 7365 6060 2e0a 0a20 2020 2020 2020 2053  se``...        S
-00044b40: 6565 2061 6c73 6f20 3a6d 6574 683a 602e  ee also :meth:`.
-00044b50: 6b65 6570 5f69 6e74 6572 7661 6c73 602c  keep_intervals`,
-00044b60: 203a 6d65 7468 3a60 2e6c 7472 696d 602c   :meth:`.ltrim`,
-00044b70: 203a 6d65 7468 3a60 2e72 7472 696d 602c   :meth:`.rtrim`,
-00044b80: 2061 6e64 0a20 2020 2020 2020 203a 7265   and.        :re
-00044b90: 663a 606d 6973 7369 6e67 2064 6174 613c  f:`missing data<
-00044ba0: 7365 635f 6461 7461 5f6d 6f64 656c 5f6d  sec_data_model_m
-00044bb0: 6973 7369 6e67 5f64 6174 613e 602e 0a0a  issing_data>`...
-00044bc0: 2020 2020 2020 2020 3a70 6172 616d 2061          :param a
-00044bd0: 7272 6179 5f6c 696b 6520 696e 7465 7276  rray_like interv
-00044be0: 616c 733a 2041 206c 6973 7420 2873 7461  als: A list (sta
-00044bf0: 7274 2c20 656e 6429 2070 6169 7273 2064  rt, end) pairs d
-00044c00: 6573 6372 6962 696e 6720 7468 650a 2020  escribing the.  
-00044c10: 2020 2020 2020 2020 2020 6765 6e6f 6d69            genomi
-00044c20: 6320 696e 7465 7276 616c 7320 746f 2064  c intervals to d
-00044c30: 656c 6574 652e 2049 6e74 6572 7661 6c73  elete. Intervals
-00044c40: 206d 7573 7420 6265 206e 6f6e 2d6f 7665   must be non-ove
-00044c50: 726c 6170 7069 6e67 2061 6e64 0a20 2020  rlapping and.   
-00044c60: 2020 2020 2020 2020 2069 6e20 696e 6372           in incr
-00044c70: 6561 7369 6e67 206f 7264 6572 2e20 5468  easing order. Th
-00044c80: 6520 6c69 7374 206f 6620 696e 7465 7276  e list of interv
-00044c90: 616c 7320 6d75 7374 2062 6520 696e 7465  als must be inte
-00044ca0: 7270 7265 7461 626c 6520 6173 2061 0a20  rpretable as a. 
-00044cb0: 2020 2020 2020 2020 2020 2032 4420 6e75             2D nu
-00044cc0: 6d70 7920 6172 7261 7920 7769 7468 2073  mpy array with s
-00044cd0: 6861 7065 2028 4e2c 2032 292c 2077 6865  hape (N, 2), whe
-00044ce0: 7265 204e 2069 7320 7468 6520 6e75 6d62  re N is the numb
-00044cf0: 6572 206f 6620 696e 7465 7276 616c 732e  er of intervals.
-00044d00: 0a20 2020 2020 2020 203a 7061 7261 6d20  .        :param 
-00044d10: 626f 6f6c 2073 696d 706c 6966 793a 2049  bool simplify: I
-00044d20: 6620 5472 7565 2c20 7265 7475 726e 2061  f True, return a
-00044d30: 2073 696d 706c 6966 6965 6420 7472 6565   simplified tree
-00044d40: 2073 6571 7565 6e63 6520 7768 6572 6520   sequence where 
-00044d50: 6e6f 6465 730a 2020 2020 2020 2020 2020  nodes.          
-00044d60: 2020 6e6f 206c 6f6e 6765 7220 7573 6564    no longer used
-00044d70: 2061 7265 2064 6973 6361 7264 6564 2e20   are discarded. 
-00044d80: 2844 6566 6175 6c74 3a20 5472 7565 292e  (Default: True).
-00044d90: 0a20 2020 2020 2020 203a 7061 7261 6d20  .        :param 
-00044da0: 626f 6f6c 2072 6563 6f72 645f 7072 6f76  bool record_prov
-00044db0: 656e 616e 6365 3a20 4966 2060 6054 7275  enance: If ``Tru
-00044dc0: 6560 602c 2061 6464 2064 6574 6169 6c73  e``, add details
-00044dd0: 206f 6620 7468 6973 206f 7065 7261 7469   of this operati
-00044de0: 6f6e 2074 6f20 7468 650a 2020 2020 2020  on to the.      
-00044df0: 2020 2020 2020 7072 6f76 656e 616e 6365        provenance
-00044e00: 2069 6e66 6f72 6d61 7469 6f6e 206f 6620   information of 
-00044e10: 7468 6520 7265 7475 726e 6564 2074 7265  the returned tre
-00044e20: 6520 7365 7175 656e 6365 2e20 2844 6566  e sequence. (Def
-00044e30: 6175 6c74 3a20 6060 5472 7565 6060 292e  ault: ``True``).
-00044e40: 0a20 2020 2020 2020 203a 7274 7970 653a  .        :rtype:
-00044e50: 2074 736b 6974 2e54 7265 6553 6571 7565   tskit.TreeSeque
-00044e60: 6e63 650a 2020 2020 2020 2020 2222 220a  nce.        """.
-00044e70: 2020 2020 2020 2020 7461 626c 6573 203d          tables =
-00044e80: 2073 656c 662e 6475 6d70 5f74 6162 6c65   self.dump_table
-00044e90: 7328 290a 2020 2020 2020 2020 7461 626c  s().        tabl
-00044ea0: 6573 2e64 656c 6574 655f 696e 7465 7276  es.delete_interv
-00044eb0: 616c 7328 696e 7465 7276 616c 732c 2073  als(intervals, s
-00044ec0: 696d 706c 6966 792c 2072 6563 6f72 645f  implify, record_
-00044ed0: 7072 6f76 656e 616e 6365 290a 2020 2020  provenance).    
-00044ee0: 2020 2020 7265 7475 726e 2074 6162 6c65      return table
-00044ef0: 732e 7472 6565 5f73 6571 7565 6e63 6528  s.tree_sequence(
-00044f00: 290a 0a20 2020 2064 6566 206b 6565 705f  )..    def keep_
-00044f10: 696e 7465 7276 616c 7328 7365 6c66 2c20  intervals(self, 
-00044f20: 696e 7465 7276 616c 732c 2073 696d 706c  intervals, simpl
-00044f30: 6966 793d 5472 7565 2c20 7265 636f 7264  ify=True, record
-00044f40: 5f70 726f 7665 6e61 6e63 653d 5472 7565  _provenance=True
-00044f50: 293a 0a20 2020 2020 2020 2022 2222 0a20  ):.        """. 
-00044f60: 2020 2020 2020 2052 6574 7572 6e73 2061         Returns a
-00044f70: 2063 6f70 7920 6f66 2074 6869 7320 7472   copy of this tr
-00044f80: 6565 2073 6571 7565 6e63 6520 7768 6963  ee sequence whic
-00044f90: 6820 696e 636c 7564 6573 206f 6e6c 7920  h includes only 
-00044fa0: 696e 666f 726d 6174 696f 6e20 696e 0a20  information in. 
-00044fb0: 2020 2020 2020 2074 6865 2073 7065 6369         the speci
-00044fc0: 6669 6564 206c 6973 7420 6f66 2067 656e  fied list of gen
-00044fd0: 6f6d 6963 2069 6e74 6572 7661 6c73 2e20  omic intervals. 
-00044fe0: 4564 6765 7320 6172 6520 7472 756e 6361  Edges are trunca
-00044ff0: 7465 6420 746f 206c 6965 2077 6974 6869  ted to lie withi
-00045000: 6e0a 2020 2020 2020 2020 7468 6573 6520  n.        these 
-00045010: 696e 7465 7276 616c 732c 2061 6e64 2073  intervals, and s
-00045020: 6974 6573 2061 6e64 206d 7574 6174 696f  ites and mutatio
-00045030: 6e73 2066 616c 6c69 6e67 206f 7574 7369  ns falling outsi
-00045040: 6465 2074 6865 7365 2069 6e74 6572 7661  de these interva
-00045050: 6c73 0a20 2020 2020 2020 2061 7265 2064  ls.        are d
-00045060: 6973 6361 7264 6564 2e20 204e 6f74 6520  iscarded.  Note 
-00045070: 7468 6174 2069 7420 6973 2074 6865 2069  that it is the i
-00045080: 6e66 6f72 6d61 7469 6f6e 206f 7574 7369  nformation outsi
-00045090: 6465 2074 6865 2069 6e74 6572 7661 6c73  de the intervals
-000450a0: 2074 6861 740a 2020 2020 2020 2020 6973   that.        is
-000450b0: 2064 656c 6574 6564 2c20 6e6f 7420 7468   deleted, not th
-000450c0: 6520 696e 7465 7276 616c 7320 7468 656d  e intervals them
-000450d0: 7365 6c76 6573 2c20 736f 2069 6e20 7061  selves, so in pa
-000450e0: 7274 6963 756c 6172 2c20 616c 6c20 7361  rticular, all sa
-000450f0: 6d70 6c65 730a 2020 2020 2020 2020 7769  mples.        wi
-00045100: 6c6c 2062 6520 6973 6f6c 6174 6564 206f  ll be isolated o
-00045110: 7574 7369 6465 206f 6620 7468 6520 7265  utside of the re
-00045120: 7461 696e 6564 2069 6e74 6572 7661 6c73  tained intervals
-00045130: 2e0a 0a20 2020 2020 2020 204e 6f74 6520  ...        Note 
-00045140: 7468 6174 206e 6f64 6520 4944 7320 6d61  that node IDs ma
-00045150: 7920 6368 616e 6765 2061 7320 6120 7265  y change as a re
-00045160: 7375 6c74 206f 6620 7468 6973 206f 7065  sult of this ope
-00045170: 7261 7469 6f6e 2c0a 2020 2020 2020 2020  ration,.        
-00045180: 6173 2062 7920 6465 6661 756c 7420 3a6d  as by default :m
-00045190: 6574 683a 602e 7369 6d70 6c69 6679 6020  eth:`.simplify` 
-000451a0: 6973 2063 616c 6c65 6420 6f6e 2074 6865  is called on the
-000451b0: 2072 6574 7572 6e65 6420 7472 6565 2073   returned tree s
-000451c0: 6571 7565 6e63 650a 2020 2020 2020 2020  equence.        
-000451d0: 746f 2072 656d 6f76 6520 7265 6475 6e64  to remove redund
-000451e0: 616e 7420 6e6f 6465 732e 2049 6620 796f  ant nodes. If yo
-000451f0: 7520 7769 7368 2074 6f20 6d61 7020 6e6f  u wish to map no
-00045200: 6465 2049 4473 206f 6e74 6f20 7468 6520  de IDs onto the 
-00045210: 7361 6d65 0a20 2020 2020 2020 206e 6f64  same.        nod
-00045220: 6573 2062 6566 6f72 6520 616e 6420 6166  es before and af
-00045230: 7465 7220 7468 6973 206d 6574 686f 6420  ter this method 
-00045240: 6861 7320 6265 656e 2063 616c 6c65 642c  has been called,
-00045250: 2073 7065 6369 6679 2060 6073 696d 706c   specify ``simpl
-00045260: 6966 793d 4661 6c73 6560 602e 0a0a 2020  ify=False``...  
-00045270: 2020 2020 2020 5365 6520 616c 736f 203a        See also :
-00045280: 6d65 7468 3a60 2e6b 6565 705f 696e 7465  meth:`.keep_inte
-00045290: 7276 616c 7360 2c20 3a6d 6574 683a 602e  rvals`, :meth:`.
-000452a0: 6c74 7269 6d60 2c20 3a6d 6574 683a 602e  ltrim`, :meth:`.
-000452b0: 7274 7269 6d60 2c20 616e 640a 2020 2020  rtrim`, and.    
-000452c0: 2020 2020 3a72 6566 3a60 6d69 7373 696e      :ref:`missin
-000452d0: 6720 6461 7461 3c73 6563 5f64 6174 615f  g data<sec_data_
-000452e0: 6d6f 6465 6c5f 6d69 7373 696e 675f 6461  model_missing_da
-000452f0: 7461 3e60 2e0a 0a20 2020 2020 2020 203a  ta>`...        :
-00045300: 7061 7261 6d20 6172 7261 795f 6c69 6b65  param array_like
-00045310: 2069 6e74 6572 7661 6c73 3a20 4120 6c69   intervals: A li
-00045320: 7374 2028 7374 6172 742c 2065 6e64 2920  st (start, end) 
-00045330: 7061 6972 7320 6465 7363 7269 6269 6e67  pairs describing
-00045340: 2074 6865 0a20 2020 2020 2020 2020 2020   the.           
-00045350: 2067 656e 6f6d 6963 2069 6e74 6572 7661   genomic interva
-00045360: 6c73 2074 6f20 6b65 6570 2e20 496e 7465  ls to keep. Inte
-00045370: 7276 616c 7320 6d75 7374 2062 6520 6e6f  rvals must be no
-00045380: 6e2d 6f76 6572 6c61 7070 696e 6720 616e  n-overlapping an
-00045390: 640a 2020 2020 2020 2020 2020 2020 696e  d.            in
-000453a0: 2069 6e63 7265 6173 696e 6720 6f72 6465   increasing orde
-000453b0: 722e 2054 6865 206c 6973 7420 6f66 2069  r. The list of i
-000453c0: 6e74 6572 7661 6c73 206d 7573 7420 6265  ntervals must be
-000453d0: 2069 6e74 6572 7072 6574 6162 6c65 2061   interpretable a
-000453e0: 7320 610a 2020 2020 2020 2020 2020 2020  s a.            
-000453f0: 3244 206e 756d 7079 2061 7272 6179 2077  2D numpy array w
-00045400: 6974 6820 7368 6170 6520 284e 2c20 3229  ith shape (N, 2)
-00045410: 2c20 7768 6572 6520 4e20 6973 2074 6865  , where N is the
-00045420: 206e 756d 6265 7220 6f66 2069 6e74 6572   number of inter
-00045430: 7661 6c73 2e0a 2020 2020 2020 2020 3a70  vals..        :p
-00045440: 6172 616d 2062 6f6f 6c20 7369 6d70 6c69  aram bool simpli
-00045450: 6679 3a20 4966 2054 7275 652c 2072 6574  fy: If True, ret
-00045460: 7572 6e20 6120 7369 6d70 6c69 6669 6564  urn a simplified
-00045470: 2074 7265 6520 7365 7175 656e 6365 2077   tree sequence w
-00045480: 6865 7265 206e 6f64 6573 0a20 2020 2020  here nodes.     
-00045490: 2020 2020 2020 206e 6f20 6c6f 6e67 6572         no longer
-000454a0: 2075 7365 6420 6172 6520 6469 7363 6172   used are discar
-000454b0: 6465 642e 2028 4465 6661 756c 743a 2054  ded. (Default: T
-000454c0: 7275 6529 2e0a 2020 2020 2020 2020 3a70  rue)..        :p
-000454d0: 6172 616d 2062 6f6f 6c20 7265 636f 7264  aram bool record
-000454e0: 5f70 726f 7665 6e61 6e63 653a 2049 6620  _provenance: If 
-000454f0: 5472 7565 2c20 6164 6420 6465 7461 696c  True, add detail
-00045500: 7320 6f66 2074 6869 7320 6f70 6572 6174  s of this operat
-00045510: 696f 6e20 746f 2074 6865 0a20 2020 2020  ion to the.     
-00045520: 2020 2020 2020 2070 726f 7665 6e61 6e63         provenanc
-00045530: 6520 696e 666f 726d 6174 696f 6e20 6f66  e information of
-00045540: 2074 6865 2072 6574 7572 6e65 6420 7472   the returned tr
-00045550: 6565 2073 6571 7565 6e63 652e 0a20 2020  ee sequence..   
-00045560: 2020 2020 2020 2020 2028 4465 6661 756c           (Defaul
-00045570: 743a 2054 7275 6529 2e0a 2020 2020 2020  t: True)..      
-00045580: 2020 3a72 7479 7065 3a20 7473 6b69 742e    :rtype: tskit.
-00045590: 5472 6565 5365 7175 656e 6365 0a20 2020  TreeSequence.   
-000455a0: 2020 2020 2022 2222 0a20 2020 2020 2020       """.       
-000455b0: 2074 6162 6c65 7320 3d20 7365 6c66 2e64   tables = self.d
-000455c0: 756d 705f 7461 626c 6573 2829 0a20 2020  ump_tables().   
-000455d0: 2020 2020 2074 6162 6c65 732e 6b65 6570       tables.keep
-000455e0: 5f69 6e74 6572 7661 6c73 2869 6e74 6572  _intervals(inter
-000455f0: 7661 6c73 2c20 7369 6d70 6c69 6679 2c20  vals, simplify, 
-00045600: 7265 636f 7264 5f70 726f 7665 6e61 6e63  record_provenanc
-00045610: 6529 0a20 2020 2020 2020 2072 6574 7572  e).        retur
-00045620: 6e20 7461 626c 6573 2e74 7265 655f 7365  n tables.tree_se
-00045630: 7175 656e 6365 2829 0a0a 2020 2020 6465  quence()..    de
-00045640: 6620 6c74 7269 6d28 7365 6c66 2c20 7265  f ltrim(self, re
-00045650: 636f 7264 5f70 726f 7665 6e61 6e63 653d  cord_provenance=
-00045660: 5472 7565 293a 0a20 2020 2020 2020 2022  True):.        "
-00045670: 2222 0a20 2020 2020 2020 2052 6574 7572  "".        Retur
-00045680: 6e73 2061 2063 6f70 7920 6f66 2074 6869  ns a copy of thi
-00045690: 7320 7472 6565 2073 6571 7565 6e63 6520  s tree sequence 
-000456a0: 7769 7468 2061 2070 6f74 656e 7469 616c  with a potential
-000456b0: 6c79 2063 6861 6e67 6564 2063 6f6f 7264  ly changed coord
-000456c0: 696e 6174 650a 2020 2020 2020 2020 7379  inate.        sy
-000456d0: 7374 656d 2c20 7375 6368 2074 6861 7420  stem, such that 
-000456e0: 656d 7074 7920 7265 6769 6f6e 7320 2869  empty regions (i
-000456f0: 2e65 2e2c 2074 686f 7365 206e 6f74 2063  .e., those not c
-00045700: 6f76 6572 6564 2062 7920 616e 7920 6564  overed by any ed
-00045710: 6765 2920 6174 2074 6865 0a20 2020 2020  ge) at the.     
-00045720: 2020 2073 7461 7274 206f 6620 7468 6520     start of the 
-00045730: 7472 6565 2073 6571 7565 6e63 6520 6172  tree sequence ar
-00045740: 6520 7472 696d 6d65 6420 6177 6179 2c20  e trimmed away, 
-00045750: 616e 6420 7468 6520 6c65 6674 6d6f 7374  and the leftmost
-00045760: 2065 6467 6520 7374 6172 7473 2061 740a   edge starts at.
-00045770: 2020 2020 2020 2020 706f 7369 7469 6f6e          position
-00045780: 2030 2e20 5468 6973 2061 6666 6563 7473   0. This affects
-00045790: 2074 6865 2072 6570 6f72 7465 6420 706f   the reported po
-000457a0: 7369 7469 6f6e 206f 6620 7369 7465 7320  sition of sites 
-000457b0: 616e 640a 2020 2020 2020 2020 6564 6765  and.        edge
-000457c0: 732e 2041 6464 6974 696f 6e61 6c6c 792c  s. Additionally,
-000457d0: 2073 6974 6573 2061 6e64 2074 6865 6972   sites and their
-000457e0: 2061 7373 6f63 6961 7465 6420 6d75 7461   associated muta
-000457f0: 7469 6f6e 7320 746f 2074 6865 206c 6566  tions to the lef
-00045800: 7420 6f66 0a20 2020 2020 2020 2074 6865  t of.        the
-00045810: 206e 6577 207a 6572 6f20 706f 696e 7420   new zero point 
-00045820: 6172 6520 7468 726f 776e 2061 7761 792e  are thrown away.
-00045830: 0a0a 2020 2020 2020 2020 3a70 6172 616d  ..        :param
-00045840: 2062 6f6f 6c20 7265 636f 7264 5f70 726f   bool record_pro
-00045850: 7665 6e61 6e63 653a 2049 6620 5472 7565  venance: If True
-00045860: 2c20 6164 6420 6465 7461 696c 7320 6f66  , add details of
-00045870: 2074 6869 7320 6f70 6572 6174 696f 6e20   this operation 
-00045880: 746f 2074 6865 0a20 2020 2020 2020 2020  to the.         
-00045890: 2020 2070 726f 7665 6e61 6e63 6520 696e     provenance in
-000458a0: 666f 726d 6174 696f 6e20 6f66 2074 6865  formation of the
-000458b0: 2072 6574 7572 6e65 6420 7472 6565 2073   returned tree s
-000458c0: 6571 7565 6e63 652e 2028 4465 6661 756c  equence. (Defaul
-000458d0: 743a 2054 7275 6529 2e0a 2020 2020 2020  t: True)..      
-000458e0: 2020 2222 220a 2020 2020 2020 2020 7461    """.        ta
-000458f0: 626c 6573 203d 2073 656c 662e 6475 6d70  bles = self.dump
-00045900: 5f74 6162 6c65 7328 290a 2020 2020 2020  _tables().      
-00045910: 2020 7461 626c 6573 2e6c 7472 696d 2872    tables.ltrim(r
-00045920: 6563 6f72 645f 7072 6f76 656e 616e 6365  ecord_provenance
-00045930: 290a 2020 2020 2020 2020 7265 7475 726e  ).        return
-00045940: 2074 6162 6c65 732e 7472 6565 5f73 6571   tables.tree_seq
-00045950: 7565 6e63 6528 290a 0a20 2020 2064 6566  uence()..    def
-00045960: 2072 7472 696d 2873 656c 662c 2072 6563   rtrim(self, rec
-00045970: 6f72 645f 7072 6f76 656e 616e 6365 3d54  ord_provenance=T
-00045980: 7275 6529 3a0a 2020 2020 2020 2020 2222  rue):.        ""
-00045990: 220a 2020 2020 2020 2020 5265 7475 726e  ".        Return
-000459a0: 7320 6120 636f 7079 206f 6620 7468 6973  s a copy of this
-000459b0: 2074 7265 6520 7365 7175 656e 6365 2077   tree sequence w
-000459c0: 6974 6820 7468 6520 6060 7365 7175 656e  ith the ``sequen
-000459d0: 6365 5f6c 656e 6774 6860 6020 7072 6f70  ce_length`` prop
-000459e0: 6572 7479 2072 6573 6574 0a20 2020 2020  erty reset.     
-000459f0: 2020 2073 6f20 7468 6174 2074 6865 2073     so that the s
-00045a00: 6571 7565 6e63 6520 656e 6473 2061 7420  equence ends at 
-00045a10: 7468 6520 656e 6420 6f66 2074 6865 2072  the end of the r
-00045a20: 6967 6874 6d6f 7374 2065 6467 652e 2041  ightmost edge. A
-00045a30: 6464 6974 696f 6e61 6c6c 792c 2073 6974  dditionally, sit
-00045a40: 6573 0a20 2020 2020 2020 2061 6e64 2074  es.        and t
-00045a50: 6865 6972 2061 7373 6f63 6961 7465 6420  heir associated 
-00045a60: 6d75 7461 7469 6f6e 7320 6174 2070 6f73  mutations at pos
-00045a70: 6974 696f 6e73 2067 7265 6174 6572 2074  itions greater t
-00045a80: 6861 6e20 7468 6520 6e65 770a 2020 2020  han the new.    
-00045a90: 2020 2020 6060 7365 7175 656e 6365 5f6c      ``sequence_l
-00045aa0: 656e 6774 6860 6020 6172 6520 7468 726f  ength`` are thro
-00045ab0: 776e 2061 7761 792e 0a0a 2020 2020 2020  wn away...      
-00045ac0: 2020 3a70 6172 616d 2062 6f6f 6c20 7265    :param bool re
-00045ad0: 636f 7264 5f70 726f 7665 6e61 6e63 653a  cord_provenance:
-00045ae0: 2049 6620 5472 7565 2c20 6164 6420 6465   If True, add de
-00045af0: 7461 696c 7320 6f66 2074 6869 7320 6f70  tails of this op
-00045b00: 6572 6174 696f 6e20 746f 2074 6865 0a20  eration to the. 
-00045b10: 2020 2020 2020 2020 2020 2070 726f 7665             prove
-00045b20: 6e61 6e63 6520 696e 666f 726d 6174 696f  nance informatio
-00045b30: 6e20 6f66 2074 6865 2072 6574 7572 6e65  n of the returne
-00045b40: 6420 7472 6565 2073 6571 7565 6e63 652e  d tree sequence.
-00045b50: 2028 4465 6661 756c 743a 2054 7275 6529   (Default: True)
-00045b60: 2e0a 2020 2020 2020 2020 2222 220a 2020  ..        """.  
-00045b70: 2020 2020 2020 7461 626c 6573 203d 2073        tables = s
-00045b80: 656c 662e 6475 6d70 5f74 6162 6c65 7328  elf.dump_tables(
-00045b90: 290a 2020 2020 2020 2020 7461 626c 6573  ).        tables
-00045ba0: 2e72 7472 696d 2872 6563 6f72 645f 7072  .rtrim(record_pr
-00045bb0: 6f76 656e 616e 6365 290a 2020 2020 2020  ovenance).      
-00045bc0: 2020 7265 7475 726e 2074 6162 6c65 732e    return tables.
-00045bd0: 7472 6565 5f73 6571 7565 6e63 6528 290a  tree_sequence().
-00045be0: 0a20 2020 2064 6566 2074 7269 6d28 7365  .    def trim(se
-00045bf0: 6c66 2c20 7265 636f 7264 5f70 726f 7665  lf, record_prove
-00045c00: 6e61 6e63 653d 5472 7565 293a 0a20 2020  nance=True):.   
-00045c10: 2020 2020 2022 2222 0a20 2020 2020 2020       """.       
-00045c20: 2052 6574 7572 6e73 2061 2063 6f70 7920   Returns a copy 
-00045c30: 6f66 2074 6869 7320 7472 6565 2073 6571  of this tree seq
-00045c40: 7565 6e63 6520 7769 7468 2061 6e79 2065  uence with any e
-00045c50: 6d70 7479 2072 6567 696f 6e73 2028 692e  mpty regions (i.
-00045c60: 652e 2c20 7468 6f73 6520 6e6f 740a 2020  e., those not.  
-00045c70: 2020 2020 2020 636f 7665 7265 6420 6279        covered by
-00045c80: 2061 6e79 2065 6467 6529 206f 6e20 7468   any edge) on th
-00045c90: 6520 7269 6768 7420 616e 6420 6c65 6674  e right and left
-00045ca0: 2074 7269 6d6d 6564 2061 7761 792e 2054   trimmed away. T
-00045cb0: 6869 7320 6d61 7920 7265 7365 7420 626f  his may reset bo
-00045cc0: 7468 2074 6865 0a20 2020 2020 2020 2063  th the.        c
-00045cd0: 6f6f 7264 696e 6174 6520 7379 7374 656d  oordinate system
-00045ce0: 2061 6e64 2074 6865 2060 6073 6571 7565   and the ``seque
-00045cf0: 6e63 655f 6c65 6e67 7468 6060 2070 726f  nce_length`` pro
-00045d00: 7065 7274 792e 2049 7420 6973 2066 756e  perty. It is fun
-00045d10: 6374 696f 6e61 6c6c 790a 2020 2020 2020  ctionally.      
-00045d20: 2020 6571 7569 7661 6c65 6e74 2074 6f20    equivalent to 
-00045d30: 3a6d 6574 683a 602e 7274 7269 6d60 2066  :meth:`.rtrim` f
-00045d40: 6f6c 6c6f 7765 6420 6279 203a 6d65 7468  ollowed by :meth
-00045d50: 3a60 2e6c 7472 696d 602e 2053 6974 6573  :`.ltrim`. Sites
-00045d60: 2061 6e64 2074 6865 6972 0a20 2020 2020   and their.     
-00045d70: 2020 2061 7373 6f63 6961 7465 6420 6d75     associated mu
-00045d80: 7461 7469 6f6e 7320 696e 2074 6865 2065  tations in the e
-00045d90: 6d70 7479 2072 6567 696f 6e73 2061 7265  mpty regions are
-00045da0: 2074 6872 6f77 6e20 6177 6179 2e0a 0a20   thrown away... 
-00045db0: 2020 2020 2020 203a 7061 7261 6d20 626f         :param bo
-00045dc0: 6f6c 2072 6563 6f72 645f 7072 6f76 656e  ol record_proven
-00045dd0: 616e 6365 3a20 4966 2054 7275 652c 2061  ance: If True, a
-00045de0: 6464 2064 6574 6169 6c73 206f 6620 7468  dd details of th
-00045df0: 6973 206f 7065 7261 7469 6f6e 2074 6f20  is operation to 
-00045e00: 7468 650a 2020 2020 2020 2020 2020 2020  the.            
-00045e10: 7072 6f76 656e 616e 6365 2069 6e66 6f72  provenance infor
-00045e20: 6d61 7469 6f6e 206f 6620 7468 6520 7265  mation of the re
-00045e30: 7475 726e 6564 2074 7265 6520 7365 7175  turned tree sequ
-00045e40: 656e 6365 2e20 2844 6566 6175 6c74 3a20  ence. (Default: 
-00045e50: 5472 7565 292e 0a20 2020 2020 2020 2022  True)..        "
-00045e60: 2222 0a20 2020 2020 2020 2074 6162 6c65  "".        table
-00045e70: 7320 3d20 7365 6c66 2e64 756d 705f 7461  s = self.dump_ta
-00045e80: 626c 6573 2829 0a20 2020 2020 2020 2074  bles().        t
-00045e90: 6162 6c65 732e 7472 696d 2872 6563 6f72  ables.trim(recor
-00045ea0: 645f 7072 6f76 656e 616e 6365 290a 2020  d_provenance).  
-00045eb0: 2020 2020 2020 7265 7475 726e 2074 6162        return tab
-00045ec0: 6c65 732e 7472 6565 5f73 6571 7565 6e63  les.tree_sequenc
-00045ed0: 6528 290a 0a20 2020 2064 6566 2073 706c  e()..    def spl
-00045ee0: 6974 5f65 6467 6573 2873 656c 662c 2074  it_edges(self, t
-00045ef0: 696d 652c 202a 2c20 666c 6167 733d 4e6f  ime, *, flags=No
-00045f00: 6e65 2c20 706f 7075 6c61 7469 6f6e 3d4e  ne, population=N
-00045f10: 6f6e 652c 206d 6574 6164 6174 613d 4e6f  one, metadata=No
-00045f20: 6e65 293a 0a20 2020 2020 2020 2022 2222  ne):.        """
-00045f30: 0a20 2020 2020 2020 2052 6574 7572 6e73  .        Returns
-00045f40: 2061 2063 6f70 7920 6f66 2074 6869 7320   a copy of this 
-00045f50: 7472 6565 2073 6571 7565 6e63 6520 696e  tree sequence in
-00045f60: 2077 6869 6368 2077 6520 7265 706c 6163   which we replac
-00045f70: 6520 616e 790a 2020 2020 2020 2020 6564  e any.        ed
-00045f80: 6765 2060 6028 6c65 6674 2c20 7269 6768  ge ``(left, righ
-00045f90: 742c 2070 6172 656e 742c 2063 6869 6c64  t, parent, child
-00045fa0: 2960 6020 696e 2077 6869 6368 0a20 2020  )`` in which.   
-00045fb0: 2020 2020 2060 606e 6f64 655f 7469 6d65       ``node_time
-00045fc0: 5b63 6869 6c64 5d20 3c20 7469 6d65 203c  [child] < time <
-00045fd0: 206e 6f64 655f 7469 6d65 5b70 6172 656e   node_time[paren
-00045fe0: 745d 6060 2077 6974 6820 7477 6f20 6564  t]`` with two ed
-00045ff0: 6765 730a 2020 2020 2020 2020 6060 286c  ges.        ``(l
-00046000: 6566 742c 2072 6967 6874 2c20 7061 7265  eft, right, pare
-00046010: 6e74 2c20 7529 6060 2061 6e64 2060 6028  nt, u)`` and ``(
-00046020: 6c65 6674 2c20 7269 6768 742c 2075 2c20  left, right, u, 
-00046030: 6368 696c 6429 6060 2c0a 2020 2020 2020  child)``,.      
-00046040: 2020 7768 6572 6520 6060 7560 6020 6973    where ``u`` is
-00046050: 2061 206e 6577 6c79 2061 6464 6564 206e   a newly added n
-00046060: 6f64 6520 666f 7220 6561 6368 2069 6e74  ode for each int
-00046070: 6572 7365 6374 696e 6720 6564 6765 2e0a  ersecting edge..
-00046080: 0a20 2020 2020 2020 2049 6620 6060 6d65  .        If ``me
-00046090: 7461 6461 7461 6060 2c20 6060 666c 6167  tadata``, ``flag
-000460a0: 7360 602c 206f 7220 6060 706f 7075 6c61  s``, or ``popula
-000460b0: 7469 6f6e 6060 2061 7265 2073 7065 6369  tion`` are speci
-000460c0: 6669 6564 2c20 6e65 776c 790a 2020 2020  fied, newly.    
-000460d0: 2020 2020 6164 6465 6420 6e6f 6465 7320      added nodes 
-000460e0: 7769 6c6c 2062 6520 6173 7369 676e 6564  will be assigned
-000460f0: 2074 6865 7365 2076 616c 7565 732e 204f   these values. O
-00046100: 7468 6572 7769 7365 2c20 6465 6661 756c  therwise, defaul
-00046110: 7420 7661 6c75 6573 0a20 2020 2020 2020  t values.       
-00046120: 2077 696c 6c20 6265 2075 7365 642e 2054   will be used. T
-00046130: 6865 2064 6566 6175 6c74 206d 6574 6164  he default metad
-00046140: 6174 6120 6973 2061 6e20 656d 7074 7920  ata is an empty 
-00046150: 6469 6374 696f 6e61 7279 2069 6620 6120  dictionary if a 
-00046160: 6d65 7461 6461 7461 0a20 2020 2020 2020  metadata.       
-00046170: 2073 6368 656d 6120 6973 2064 6566 696e   schema is defin
-00046180: 6564 2066 6f72 2074 6865 206e 6f64 6520  ed for the node 
-00046190: 7461 626c 652c 2061 6e64 2069 7320 616e  table, and is an
-000461a0: 2065 6d70 7479 2062 7974 6520 7374 7269   empty byte stri
-000461b0: 6e67 0a20 2020 2020 2020 206f 7468 6572  ng.        other
-000461c0: 7769 7365 2e20 5468 6520 6465 6661 756c  wise. The defaul
-000461d0: 7420 706f 7075 6c61 7469 6f6e 2066 6f72  t population for
-000461e0: 2074 6865 206e 6577 206e 6f64 6520 6973   the new node is
-000461f0: 0a20 2020 2020 2020 203a 6461 7461 3a60  .        :data:`
-00046200: 7473 6b69 742e 4e55 4c4c 602e 204e 6577  tskit.NULL`. New
-00046210: 6c79 2061 6464 6564 2068 6176 6520 6120  ly added have a 
-00046220: 6465 6661 756c 7420 6060 666c 6167 7360  default ``flags`
-00046230: 6020 7661 6c75 6520 6f66 2030 2e0a 0a20  ` value of 0... 
-00046240: 2020 2020 2020 2041 6e79 206d 6574 6164         Any metad
-00046250: 6174 6120 6173 736f 6369 6174 6564 2077  ata associated w
-00046260: 6974 6820 6120 7370 6c69 7420 6564 6765  ith a split edge
-00046270: 2077 696c 6c20 6265 2063 6f70 6965 6420   will be copied 
-00046280: 746f 2074 6865 206e 6577 2065 6467 652e  to the new edge.
-00046290: 0a0a 2020 2020 2020 2020 2e2e 2077 6172  ..        .. war
-000462a0: 6e69 6e67 3a3a 2054 6869 7320 6d65 7468  ning:: This meth
-000462b0: 6f64 2063 7572 7265 6e74 6c79 2064 6f65  od currently doe
-000462c0: 7320 6e6f 7420 7375 7070 6f72 7420 6d69  s not support mi
-000462d0: 6772 6174 696f 6e73 0a20 2020 2020 2020  grations.       
-000462e0: 2020 2020 2061 6e64 2061 2065 7272 6f72       and a error
-000462f0: 2077 696c 6c20 6265 2072 6169 7365 6420   will be raised 
-00046300: 6966 2074 6865 206d 6967 7261 7469 6f6e  if the migration
-00046310: 2074 6162 6c65 2069 7320 6e6f 740a 2020   table is not.  
-00046320: 2020 2020 2020 2020 2020 656d 7074 792e            empty.
-00046330: 2046 7574 7572 6520 7665 7273 696f 6e73   Future versions
-00046340: 206d 6179 2074 616b 6520 6d69 6772 6174   may take migrat
-00046350: 696f 6e73 2074 6861 7420 696e 7465 7273  ions that inters
-00046360: 6563 7420 7769 7468 2074 6865 0a20 2020  ect with the.   
-00046370: 2020 2020 2020 2020 2065 6467 6520 696e           edge in
-00046380: 746f 2061 6363 6f75 6e74 2077 6865 6e20  to account when 
-00046390: 6465 7465 726d 696e 696e 6720 7468 6520  determining the 
-000463a0: 6465 6661 756c 7420 706f 7075 6c61 7469  default populati
-000463b0: 6f6e 0a20 2020 2020 2020 2020 2020 2061  on.            a
-000463c0: 7373 6967 6e6d 656e 7473 2066 6f72 206e  ssignments for n
-000463d0: 6577 206e 6f64 6573 2e0a 0a20 2020 2020  ew nodes...     
-000463e0: 2020 2041 6e79 206d 7574 6174 696f 6e73     Any mutations
-000463f0: 206c 7969 6e67 206f 6e20 7468 6520 6564   lying on the ed
-00046400: 6765 2077 686f 7365 2074 696d 6520 6973  ge whose time is
-00046410: 203e 3d20 6060 7469 6d65 6060 2077 696c   >= ``time`` wil
-00046420: 6c20 6861 7665 0a20 2020 2020 2020 2074  l have.        t
-00046430: 6865 6972 206e 6f64 6520 7661 6c75 6520  heir node value 
-00046440: 7365 7420 746f 2060 6075 6060 2e20 4e6f  set to ``u``. No
-00046450: 7465 2074 6861 7420 7468 6520 7469 6d65  te that the time
-00046460: 206f 6620 7468 6520 6d75 7461 7469 6f6e   of the mutation
-00046470: 2069 730a 2020 2020 2020 2020 6465 6669   is.        defi
-00046480: 6e65 6420 6173 2074 6865 2074 696d 6520  ned as the time 
-00046490: 6f66 2074 6865 2063 6869 6c64 206e 6f64  of the child nod
-000464a0: 6520 6966 2074 6865 206d 7574 6174 696f  e if the mutatio
-000464b0: 6e27 7320 7469 6d65 2069 730a 2020 2020  n's time is.    
-000464c0: 2020 2020 756e 6b6e 6f77 6e2e 0a0a 2020      unknown...  
-000464d0: 2020 2020 2020 3a70 6172 616d 2066 6c6f        :param flo
-000464e0: 6174 2074 696d 653a 2054 6865 2063 7574  at time: The cut
-000464f0: 6f66 6620 7469 6d65 2e0a 2020 2020 2020  off time..      
-00046500: 2020 3a70 6172 616d 2069 6e74 2066 6c61    :param int fla
-00046510: 6773 3a20 5468 6520 666c 6167 7320 7661  gs: The flags va
-00046520: 6c75 6520 666f 7220 6e65 776c 792d 696e  lue for newly-in
-00046530: 7365 7274 6564 206e 6f64 6573 2e20 2844  serted nodes. (D
-00046540: 6566 6175 6c74 203d 2030 290a 2020 2020  efault = 0).    
-00046550: 2020 2020 3a70 6172 616d 2069 6e74 2070      :param int p
-00046560: 6f70 756c 6174 696f 6e3a 2054 6865 2070  opulation: The p
-00046570: 6f70 756c 6174 696f 6e20 7661 6c75 6520  opulation value 
-00046580: 666f 7220 6e65 776c 7920 696e 7365 7274  for newly insert
-00046590: 6564 206e 6f64 6573 2e0a 2020 2020 2020  ed nodes..      
-000465a0: 2020 2020 2020 4465 6661 756c 7473 2074        Defaults t
-000465b0: 6f20 6060 7473 6b69 742e 4e55 4c4c 6060  o ``tskit.NULL``
-000465c0: 2069 6620 6e6f 7420 7370 6563 6966 6965   if not specifie
-000465d0: 642e 0a20 2020 2020 2020 203a 7061 7261  d..        :para
-000465e0: 6d20 6d65 7461 6461 7461 3a20 5468 6520  m metadata: The 
-000465f0: 6d65 7461 6461 7461 2066 6f72 2061 6e79  metadata for any
-00046600: 206e 6577 6c79 2069 6e73 6572 7465 6420   newly inserted 
-00046610: 6e6f 6465 732e 2053 6565 0a20 2020 2020  nodes. See.     
-00046620: 2020 2020 2020 203a 6d65 7468 3a60 2e4e         :meth:`.N
-00046630: 6f64 6554 6162 6c65 2e61 6464 5f72 6f77  odeTable.add_row
-00046640: 6020 666f 7220 6465 7461 696c 7320 6f6e  ` for details on
-00046650: 2068 6f77 2064 6566 6175 6c74 206d 6574   how default met
-00046660: 6164 6174 610a 2020 2020 2020 2020 2020  adata.          
-00046670: 2020 6973 2070 726f 6475 6365 6420 666f    is produced fo
-00046680: 7220 6120 6769 7665 6e20 7363 6865 6d61  r a given schema
-00046690: 2028 6f72 206e 6f6e 6529 2e0a 2020 2020   (or none)..    
-000466a0: 2020 2020 3a72 6574 7572 6e3a 2041 2063      :return: A c
-000466b0: 6f70 7920 6f66 2074 6869 7320 7472 6565  opy of this tree
-000466c0: 2073 6571 7565 6e63 6520 7769 7468 2065   sequence with e
-000466d0: 6467 6573 2073 706c 6974 2061 7420 7468  dges split at th
-000466e0: 6520 7370 6563 6966 6965 6420 7469 6d65  e specified time
-000466f0: 2e0a 2020 2020 2020 2020 3a72 7479 7065  ..        :rtype
-00046700: 3a20 7473 6b69 742e 5472 6565 5365 7175  : tskit.TreeSequ
-00046710: 656e 6365 0a20 2020 2020 2020 2022 2222  ence.        """
-00046720: 0a20 2020 2020 2020 2070 6f70 756c 6174  .        populat
-00046730: 696f 6e20 3d20 7473 6b69 742e 4e55 4c4c  ion = tskit.NULL
-00046740: 2069 6620 706f 7075 6c61 7469 6f6e 2069   if population i
-00046750: 7320 4e6f 6e65 2065 6c73 6520 706f 7075  s None else popu
-00046760: 6c61 7469 6f6e 0a20 2020 2020 2020 2066  lation.        f
-00046770: 6c61 6773 203d 2030 2069 6620 666c 6167  lags = 0 if flag
-00046780: 7320 6973 204e 6f6e 6520 656c 7365 2066  s is None else f
-00046790: 6c61 6773 0a20 2020 2020 2020 2073 6368  lags.        sch
-000467a0: 656d 6120 3d20 7365 6c66 2e74 6162 6c65  ema = self.table
-000467b0: 5f6d 6574 6164 6174 615f 7363 6865 6d61  _metadata_schema
-000467c0: 732e 6e6f 6465 0a20 2020 2020 2020 2069  s.node.        i
-000467d0: 6620 6d65 7461 6461 7461 2069 7320 4e6f  f metadata is No
-000467e0: 6e65 3a0a 2020 2020 2020 2020 2020 2020  ne:.            
-000467f0: 6d65 7461 6461 7461 203d 2073 6368 656d  metadata = schem
-00046800: 612e 656d 7074 795f 7661 6c75 650a 2020  a.empty_value.  
-00046810: 2020 2020 2020 6d65 7461 6461 7461 203d        metadata =
-00046820: 2073 6368 656d 612e 7661 6c69 6461 7465   schema.validate
-00046830: 5f61 6e64 5f65 6e63 6f64 655f 726f 7728  _and_encode_row(
-00046840: 6d65 7461 6461 7461 290a 2020 2020 2020  metadata).      
-00046850: 2020 6c6c 5f74 7320 3d20 7365 6c66 2e5f    ll_ts = self._
-00046860: 6c6c 5f74 7265 655f 7365 7175 656e 6365  ll_tree_sequence
-00046870: 2e73 706c 6974 5f65 6467 6573 280a 2020  .split_edges(.  
-00046880: 2020 2020 2020 2020 2020 7469 6d65 3d74            time=t
-00046890: 696d 652c 0a20 2020 2020 2020 2020 2020  ime,.           
-000468a0: 2066 6c61 6773 3d66 6c61 6773 2c0a 2020   flags=flags,.  
-000468b0: 2020 2020 2020 2020 2020 706f 7075 6c61            popula
-000468c0: 7469 6f6e 3d70 6f70 756c 6174 696f 6e2c  tion=population,
-000468d0: 0a20 2020 2020 2020 2020 2020 206d 6574  .            met
-000468e0: 6164 6174 613d 6d65 7461 6461 7461 2c0a  adata=metadata,.
-000468f0: 2020 2020 2020 2020 290a 2020 2020 2020          ).      
-00046900: 2020 7265 7475 726e 2054 7265 6553 6571    return TreeSeq
-00046910: 7565 6e63 6528 6c6c 5f74 7329 0a0a 2020  uence(ll_ts)..  
-00046920: 2020 6465 6620 6465 6361 7069 7461 7465    def decapitate
-00046930: 2873 656c 662c 2074 696d 652c 202a 2c20  (self, time, *, 
-00046940: 666c 6167 733d 4e6f 6e65 2c20 706f 7075  flags=None, popu
-00046950: 6c61 7469 6f6e 3d4e 6f6e 652c 206d 6574  lation=None, met
-00046960: 6164 6174 613d 4e6f 6e65 293a 0a20 2020  adata=None):.   
-00046970: 2020 2020 2022 2222 0a20 2020 2020 2020       """.       
-00046980: 2044 656c 6574 6520 616c 6c20 6564 6765   Delete all edge
-00046990: 2074 6f70 6f6c 6f67 7920 616e 6420 6d75   topology and mu
-000469a0: 7461 7469 6f6e 616c 2069 6e66 6f72 6d61  tational informa
-000469b0: 7469 6f6e 2061 7420 6c65 6173 7420 6173  tion at least as
-000469c0: 206f 6c64 0a20 2020 2020 2020 2061 7320   old.        as 
-000469d0: 7468 6520 7370 6563 6966 6965 6420 7469  the specified ti
-000469e0: 6d65 2066 726f 6d20 7468 6973 2074 7265  me from this tre
-000469f0: 6520 7365 7175 656e 6365 2e0a 0a20 2020  e sequence...   
-00046a00: 2020 2020 2052 656d 6f76 6573 2061 6c6c       Removes all
-00046a10: 2065 6467 6573 2069 6e20 7768 6963 6820   edges in which 
-00046a20: 7468 6520 7469 6d65 206f 6620 7468 6520  the time of the 
-00046a30: 6368 696c 6420 6973 203e 3d20 7468 6520  child is >= the 
-00046a40: 7370 6563 6966 6965 640a 2020 2020 2020  specified.      
-00046a50: 2020 7469 6d65 2060 6074 6060 2c20 616e    time ``t``, an
-00046a60: 6420 6272 6561 6b73 2065 6467 6573 2074  d breaks edges t
-00046a70: 6861 7420 696e 7465 7273 6563 7420 7769  hat intersect wi
-00046a80: 7468 2060 6074 6060 2e20 466f 7220 6561  th ``t``. For ea
-00046a90: 6368 2065 6467 650a 2020 2020 2020 2020  ch edge.        
-00046aa0: 696e 7465 7273 6563 7469 6e67 2077 6974  intersecting wit
-00046ab0: 6820 6060 7460 6020 7765 2063 7265 6174  h ``t`` we creat
-00046ac0: 6520 6120 6e65 7720 6e6f 6465 2077 6974  e a new node wit
-00046ad0: 6820 7469 6d65 2065 7175 616c 2074 6f20  h time equal to 
-00046ae0: 6060 7460 602c 0a20 2020 2020 2020 2061  ``t``,.        a
-00046af0: 6e64 2073 6574 2074 6865 2070 6172 656e  nd set the paren
-00046b00: 7420 6f66 2074 6865 2065 6467 6520 746f  t of the edge to
-00046b10: 2074 6869 7320 6e65 7720 6e6f 6465 2e20   this new node. 
-00046b20: 5468 6520 6e6f 6465 2074 6162 6c65 0a20  The node table. 
-00046b30: 2020 2020 2020 2069 7320 6e6f 7420 616c         is not al
-00046b40: 7465 7265 6420 696e 2061 6e79 206f 7468  tered in any oth
-00046b50: 6572 2077 6179 2e20 4e65 776c 7920 6164  er way. Newly ad
-00046b60: 6465 6420 6e6f 6465 7320 6861 7665 2076  ded nodes have v
-00046b70: 616c 7565 730a 2020 2020 2020 2020 666f  alues.        fo
-00046b80: 7220 6060 666c 6167 7360 602c 2060 6070  r ``flags``, ``p
-00046b90: 6f70 756c 6174 696f 6e60 6020 616e 6420  opulation`` and 
-00046ba0: 6060 6d65 7461 6461 7461 6060 2063 6f6e  ``metadata`` con
-00046bb0: 7472 6f6c 6c65 6420 6279 2070 6172 616d  trolled by param
-00046bc0: 6574 6572 730a 2020 2020 2020 2020 746f  eters.        to
-00046bd0: 2074 6869 7320 6675 6e63 7469 6f6e 2069   this function i
-00046be0: 6e20 7468 6520 7361 6d65 2077 6179 2061  n the same way a
-00046bf0: 7320 3a6d 6574 683a 602e 7370 6c69 745f  s :meth:`.split_
-00046c00: 6564 6765 7360 2e0a 0a20 2020 2020 2020  edges`...       
-00046c10: 202e 2e20 6e6f 7465 3a3a 0a20 2020 2020   .. note::.     
-00046c20: 2020 2020 2020 204e 6f74 6520 7468 6174         Note that
-00046c30: 2065 6163 6820 6564 6765 2069 7320 7472   each edge is tr
-00046c40: 6561 7465 6420 696e 6465 7065 6e64 656e  eated independen
-00046c50: 746c 792c 2073 6f20 7468 6174 2065 7665  tly, so that eve
-00046c60: 6e20 6966 2074 776f 0a20 2020 2020 2020  n if two.       
-00046c70: 2020 2020 2065 6467 6573 2074 6861 7420       edges that 
-00046c80: 6172 6520 6272 6f6b 656e 2062 7920 7468  are broken by th
-00046c90: 6973 206f 7065 7261 7469 6f6e 2073 6861  is operation sha
-00046ca0: 7265 2074 6865 2073 616d 6520 7061 7265  re the same pare
-00046cb0: 6e74 2061 6e64 0a20 2020 2020 2020 2020  nt and.         
-00046cc0: 2020 2063 6869 6c64 206e 6f64 6573 2c20     child nodes, 
-00046cd0: 7468 6572 6520 7769 6c6c 2062 6520 7477  there will be tw
-00046ce0: 6f20 6469 6666 6572 656e 7420 6e65 7720  o different new 
-00046cf0: 7061 7265 6e74 206e 6f64 6573 2069 6e73  parent nodes ins
-00046d00: 6572 7465 642e 0a0a 2020 2020 2020 2020  erted...        
-00046d10: 416e 7920 6d75 7461 7469 6f6e 2077 686f  Any mutation who
-00046d20: 7365 2074 696d 6520 6973 203e 3d20 6060  se time is >= ``
-00046d30: 7460 6020 7769 6c6c 2062 6520 7265 6d6f  t`` will be remo
-00046d40: 7665 642e 2041 206d 7574 6174 696f 6e27  ved. A mutation'
-00046d50: 7320 7469 6d65 0a20 2020 2020 2020 2069  s time.        i
-00046d60: 7320 6974 7320 6173 736f 6369 6174 6564  s its associated
-00046d70: 2060 6074 696d 6560 6020 7661 6c75 652c   ``time`` value,
-00046d80: 206f 7220 7468 6520 7469 6d65 206f 6620   or the time of 
-00046d90: 6974 7320 6e6f 6465 2069 6620 7468 650a  its node if the.
-00046da0: 2020 2020 2020 2020 6d75 7461 7469 6f6e          mutation
-00046db0: 2773 2074 696d 6520 7761 7320 6d61 726b  's time was mark
-00046dc0: 6564 2061 7320 756e 6b6e 6f77 6e20 283a  ed as unknown (:
-00046dd0: 6461 7461 3a60 554e 4b4e 4f57 4e5f 5449  data:`UNKNOWN_TI
-00046de0: 4d45 6029 2e0a 0a20 2020 2020 2020 204d  ME`)...        M
-00046df0: 6967 7261 7469 6f6e 7320 6172 6520 6e6f  igrations are no
-00046e00: 7420 7375 7070 6f72 7465 642c 2061 6e64  t supported, and
-00046e10: 2061 204c 6962 7261 7279 4572 726f 7220   a LibraryError 
-00046e20: 7769 6c6c 2062 6520 7261 6973 6520 6966  will be raise if
-00046e30: 0a20 2020 2020 2020 2063 616c 6c65 6420  .        called 
-00046e40: 6f6e 2061 2074 7265 6520 7365 7175 656e  on a tree sequen
-00046e50: 6365 2063 6f6e 7461 696e 696e 6720 6d69  ce containing mi
-00046e60: 6772 6174 696f 6e20 696e 666f 726d 6174  gration informat
-00046e70: 696f 6e2e 0a0a 2020 2020 2020 2020 2e2e  ion...        ..
-00046e80: 2073 6565 616c 736f 3a3a 2054 6869 7320   seealso:: This 
-00046e90: 6d65 7468 6f64 2069 7320 696d 706c 656d  method is implem
-00046ea0: 656e 7465 6420 7573 696e 6720 7468 6520  ented using the 
-00046eb0: 3a6d 6574 683a 602e 7370 6c69 745f 6564  :meth:`.split_ed
-00046ec0: 6765 7360 0a20 2020 2020 2020 2020 2020  ges`.           
-00046ed0: 2061 6e64 203a 6d65 7468 3a60 5461 626c   and :meth:`Tabl
-00046ee0: 6543 6f6c 6c65 6374 696f 6e2e 6465 6c65  eCollection.dele
-00046ef0: 7465 5f6f 6c64 6572 6020 6675 6e63 7469  te_older` functi
-00046f00: 6f6e 732e 0a0a 2020 2020 2020 2020 3a70  ons...        :p
-00046f10: 6172 616d 2066 6c6f 6174 2074 696d 653a  aram float time:
-00046f20: 2054 6865 2063 7574 6f66 6620 7469 6d65   The cutoff time
-00046f30: 2e0a 2020 2020 2020 2020 3a70 6172 616d  ..        :param
-00046f40: 2069 6e74 2066 6c61 6773 3a20 5468 6520   int flags: The 
-00046f50: 666c 6167 7320 7661 6c75 6520 666f 7220  flags value for 
-00046f60: 6e65 776c 792d 696e 7365 7274 6564 206e  newly-inserted n
-00046f70: 6f64 6573 2e20 2844 6566 6175 6c74 203d  odes. (Default =
-00046f80: 2030 290a 2020 2020 2020 2020 3a70 6172   0).        :par
-00046f90: 616d 2069 6e74 2070 6f70 756c 6174 696f  am int populatio
-00046fa0: 6e3a 2054 6865 2070 6f70 756c 6174 696f  n: The populatio
-00046fb0: 6e20 7661 6c75 6520 666f 7220 6e65 776c  n value for newl
-00046fc0: 7920 696e 7365 7274 6564 206e 6f64 6573  y inserted nodes
-00046fd0: 2e0a 2020 2020 2020 2020 2020 2020 4465  ..            De
-00046fe0: 6661 756c 7473 2074 6f20 6060 7473 6b69  faults to ``tski
-00046ff0: 742e 4e55 4c4c 6060 2069 6620 6e6f 7420  t.NULL`` if not 
-00047000: 7370 6563 6966 6965 642e 0a20 2020 2020  specified..     
-00047010: 2020 203a 7061 7261 6d20 6d65 7461 6461     :param metada
-00047020: 7461 3a20 5468 6520 6d65 7461 6461 7461  ta: The metadata
-00047030: 2066 6f72 2061 6e79 206e 6577 6c79 2069   for any newly i
-00047040: 6e73 6572 7465 6420 6e6f 6465 732e 2053  nserted nodes. S
-00047050: 6565 0a20 2020 2020 2020 2020 2020 203a  ee.            :
-00047060: 6d65 7468 3a60 2e4e 6f64 6554 6162 6c65  meth:`.NodeTable
-00047070: 2e61 6464 5f72 6f77 6020 666f 7220 6465  .add_row` for de
-00047080: 7461 696c 7320 6f6e 2068 6f77 2064 6566  tails on how def
-00047090: 6175 6c74 206d 6574 6164 6174 610a 2020  ault metadata.  
-000470a0: 2020 2020 2020 2020 2020 6973 2070 726f            is pro
-000470b0: 6475 6365 6420 666f 7220 6120 6769 7665  duced for a give
-000470c0: 6e20 7363 6865 6d61 2028 6f72 206e 6f6e  n schema (or non
-000470d0: 6529 2e0a 2020 2020 2020 2020 3a72 6574  e)..        :ret
-000470e0: 7572 6e3a 2041 2063 6f70 7920 6f66 2074  urn: A copy of t
-000470f0: 6869 7320 7472 6565 2073 6571 7565 6e63  his tree sequenc
-00047100: 6520 7769 7468 2065 6467 6573 2073 706c  e with edges spl
-00047110: 6974 2061 7420 7468 6520 7370 6563 6966  it at the specif
-00047120: 6965 6420 7469 6d65 2e0a 2020 2020 2020  ied time..      
-00047130: 2020 3a72 7479 7065 3a20 7473 6b69 742e    :rtype: tskit.
-00047140: 5472 6565 5365 7175 656e 6365 0a20 2020  TreeSequence.   
-00047150: 2020 2020 2022 2222 0a20 2020 2020 2020       """.       
-00047160: 2073 706c 6974 5f74 7320 3d20 7365 6c66   split_ts = self
-00047170: 2e73 706c 6974 5f65 6467 6573 280a 2020  .split_edges(.  
-00047180: 2020 2020 2020 2020 2020 7469 6d65 2c20            time, 
-00047190: 666c 6167 733d 666c 6167 732c 2070 6f70  flags=flags, pop
-000471a0: 756c 6174 696f 6e3d 706f 7075 6c61 7469  ulation=populati
-000471b0: 6f6e 2c20 6d65 7461 6461 7461 3d6d 6574  on, metadata=met
-000471c0: 6164 6174 610a 2020 2020 2020 2020 290a  adata.        ).
-000471d0: 2020 2020 2020 2020 7461 626c 6573 203d          tables =
-000471e0: 2073 706c 6974 5f74 732e 6475 6d70 5f74   split_ts.dump_t
-000471f0: 6162 6c65 7328 290a 2020 2020 2020 2020  ables().        
-00047200: 6465 6c20 7370 6c69 745f 7473 0a20 2020  del split_ts.   
-00047210: 2020 2020 2074 6162 6c65 732e 6465 6c65       tables.dele
-00047220: 7465 5f6f 6c64 6572 2874 696d 6529 0a20  te_older(time). 
-00047230: 2020 2020 2020 2072 6574 7572 6e20 7461         return ta
-00047240: 626c 6573 2e74 7265 655f 7365 7175 656e  bles.tree_sequen
-00047250: 6365 2829 0a0a 2020 2020 6465 6620 7375  ce()..    def su
-00047260: 6273 6574 280a 2020 2020 2020 2020 7365  bset(.        se
-00047270: 6c66 2c0a 2020 2020 2020 2020 6e6f 6465  lf,.        node
-00047280: 732c 0a20 2020 2020 2020 2072 6563 6f72  s,.        recor
-00047290: 645f 7072 6f76 656e 616e 6365 3d54 7275  d_provenance=Tru
-000472a0: 652c 0a20 2020 2020 2020 2072 656f 7264  e,.        reord
-000472b0: 6572 5f70 6f70 756c 6174 696f 6e73 3d54  er_populations=T
-000472c0: 7275 652c 0a20 2020 2020 2020 2072 656d  rue,.        rem
-000472d0: 6f76 655f 756e 7265 6665 7265 6e63 6564  ove_unreferenced
-000472e0: 3d54 7275 652c 0a20 2020 2029 3a0a 2020  =True,.    ):.  
-000472f0: 2020 2020 2020 2222 220a 2020 2020 2020        """.      
-00047300: 2020 5265 7475 726e 7320 6120 7472 6565    Returns a tree
-00047310: 2073 6571 7565 6e63 6520 636f 6e74 6169   sequence contai
-00047320: 6e69 6e67 206f 6e6c 7920 696e 666f 726d  ning only inform
-00047330: 6174 696f 6e20 6469 7265 6374 6c79 0a20  ation directly. 
-00047340: 2020 2020 2020 2072 6566 6572 656e 6369         referenci
-00047350: 6e67 2074 6865 2070 726f 7669 6465 6420  ng the provided 
-00047360: 6c69 7374 206f 6620 6e6f 6465 7320 746f  list of nodes to
-00047370: 2072 6574 6169 6e2e 2020 5468 6520 7265   retain.  The re
-00047380: 7375 6c74 2077 696c 6c0a 2020 2020 2020  sult will.      
-00047390: 2020 7265 7461 696e 206f 6e6c 7920 7468    retain only th
-000473a0: 6520 6e6f 6465 7320 7768 6f73 6520 4944  e nodes whose ID
-000473b0: 7320 6172 6520 6c69 7374 6564 2069 6e20  s are listed in 
-000473c0: 6060 6e6f 6465 7360 602c 206f 6e6c 7920  ``nodes``, only 
-000473d0: 6564 6765 7320 666f 720a 2020 2020 2020  edges for.      
-000473e0: 2020 7768 6963 6820 626f 7468 2070 6172    which both par
-000473f0: 656e 7420 616e 6420 6368 696c 6420 6172  ent and child ar
-00047400: 6520 696e 2060 606e 6f64 6573 6060 602c  e in ``nodes```,
-00047410: 206f 6e6c 7920 6d75 7461 7469 6f6e 7320   only mutations 
-00047420: 7768 6f73 650a 2020 2020 2020 2020 6e6f  whose.        no
-00047430: 6465 2069 7320 696e 2060 606e 6f64 6573  de is in ``nodes
-00047440: 6060 2c20 616e 6420 6f6e 6c79 2069 6e64  ``, and only ind
-00047450: 6976 6964 7561 6c73 2074 6861 7420 6172  ividuals that ar
-00047460: 6520 7265 6665 7272 6564 2074 6f20 6279  e referred to by
-00047470: 206f 6e65 0a20 2020 2020 2020 206f 6620   one.        of 
-00047480: 7468 6520 7265 7461 696e 6564 206e 6f64  the retained nod
-00047490: 6573 2e20 204e 6f74 6520 7468 6174 2074  es.  Note that t
-000474a0: 6869 7320 646f 6573 202a 6e6f 742a 2072  his does *not* r
-000474b0: 6574 6169 6e0a 2020 2020 2020 2020 7468  etain.        th
-000474c0: 6520 616e 6365 7374 7279 206f 6620 7468  e ancestry of th
-000474d0: 6573 6520 6e6f 6465 7320 2d20 666f 7220  ese nodes - for 
-000474e0: 7468 6174 2c20 7365 6520 3a6d 6574 683a  that, see :meth:
-000474f0: 602e 7369 6d70 6c69 6679 602e 0a0a 2020  `.simplify`...  
-00047500: 2020 2020 2020 5468 6973 2068 6173 2074        This has t
-00047510: 6865 2073 6964 6520 6566 6665 6374 2074  he side effect t
-00047520: 6861 7420 6974 206d 6179 2063 6861 6e67  hat it may chang
-00047530: 6520 7468 6520 6f72 6465 7220 6f66 2074  e the order of t
-00047540: 6865 206e 6f64 6573 2c0a 2020 2020 2020  he nodes,.      
-00047550: 2020 696e 6469 7669 6475 616c 732c 2070    individuals, p
-00047560: 6f70 756c 6174 696f 6e73 2c20 616e 6420  opulations, and 
-00047570: 6d69 6772 6174 696f 6e73 2069 6e20 7468  migrations in th
-00047580: 6520 7472 6565 2073 6571 7565 6e63 653a  e tree sequence:
-00047590: 2074 6865 206e 6f64 6573 0a20 2020 2020   the nodes.     
-000475a0: 2020 2069 6e20 7468 6520 6e65 7720 7472     in the new tr
-000475b0: 6565 2073 6571 7565 6e63 6520 7769 6c6c  ee sequence will
-000475c0: 2062 6520 696e 2074 6865 206f 7264 6572   be in the order
-000475d0: 2070 726f 7669 6465 6420 696e 2060 606e   provided in ``n
-000475e0: 6f64 6573 6060 2c20 616e 640a 2020 2020  odes``, and.    
-000475f0: 2020 2020 626f 7468 2069 6e64 6976 6964      both individ
-00047600: 7561 6c73 2061 6e64 2070 6f70 756c 6174  uals and populat
-00047610: 696f 6e73 2077 696c 6c20 6265 206f 7264  ions will be ord
-00047620: 6572 6564 2062 7920 7468 6520 6561 726c  ered by the earl
-00047630: 6965 7374 2072 6574 6169 6e65 640a 2020  iest retained.  
-00047640: 2020 2020 2020 6e6f 6465 2074 6861 7420        node that 
-00047650: 7265 6665 7273 2074 6f20 7468 656d 2e20  refers to them. 
-00047660: 2848 6f77 6576 6572 2c20 6060 7265 6f72  (However, ``reor
-00047670: 6465 725f 706f 7075 6c61 7469 6f6e 7360  der_populations`
-00047680: 6020 6d61 7920 6265 2073 6574 2074 6f0a  ` may be set to.
-00047690: 2020 2020 2020 2020 4661 6c73 6520 746f          False to
-000476a0: 206b 6565 7020 7468 6520 706f 7075 6c61   keep the popula
-000476b0: 7469 6f6e 2074 6162 6c65 2075 6e63 6861  tion table uncha
-000476c0: 6e67 6564 2e29 0a0a 2020 2020 2020 2020  nged.)..        
-000476d0: 4279 2064 6566 6175 6c74 2c20 7468 6520  By default, the 
-000476e0: 6d65 7468 6f64 2072 656d 6f76 6573 2061  method removes a
-000476f0: 6c6c 2069 6e64 6976 6964 7561 6c73 2061  ll individuals a
-00047700: 6e64 2070 6f70 756c 6174 696f 6e73 206e  nd populations n
-00047710: 6f74 0a20 2020 2020 2020 2072 6566 6572  ot.        refer
-00047720: 656e 6365 6420 6279 2061 6e79 206e 6f64  enced by any nod
-00047730: 6573 2c20 616e 6420 616c 6c20 7369 7465  es, and all site
-00047740: 7320 6e6f 7420 7265 6665 7265 6e63 6564  s not referenced
-00047750: 2062 7920 616e 7920 6d75 7461 7469 6f6e   by any mutation
-00047760: 732e 0a20 2020 2020 2020 2054 6f20 7265  s..        To re
-00047770: 7461 696e 2074 6865 7365 2075 6e72 6566  tain these unref
-00047780: 6572 656e 6365 6420 696e 6469 7669 6475  erenced individu
-00047790: 616c 732c 2070 6f70 756c 6174 696f 6e73  als, populations
-000477a0: 2c20 616e 6420 7369 7465 732c 2070 6173  , and sites, pas
-000477b0: 730a 2020 2020 2020 2020 6060 7265 6d6f  s.        ``remo
-000477c0: 7665 5f75 6e72 6566 6572 656e 6365 643d  ve_unreferenced=
-000477d0: 4661 6c73 6560 602e 2049 6620 7468 6973  False``. If this
-000477e0: 2069 7320 646f 6e65 2c20 7468 6520 7369   is done, the si
-000477f0: 7465 2074 6162 6c65 2077 696c 6c0a 2020  te table will.  
-00047800: 2020 2020 2020 7265 6d61 696e 2075 6e63        remain unc
-00047810: 6861 6e67 6564 2c20 756e 7265 6665 7265  hanged, unrefere
-00047820: 6e63 6564 2069 6e64 6976 6964 7561 6c73  nced individuals
-00047830: 2077 696c 6c20 6170 7065 6172 2061 7420   will appear at 
-00047840: 7468 6520 656e 6420 6f66 0a20 2020 2020  the end of.     
-00047850: 2020 2074 6865 2069 6e64 6976 6964 7561     the individua
-00047860: 6c73 2074 6162 6c65 2028 616e 6420 696e  ls table (and in
-00047870: 2074 6865 6972 206f 7269 6769 6e61 6c20   their original 
-00047880: 6f72 6465 7229 2c20 616e 6420 756e 7265  order), and unre
-00047890: 6665 7265 6e63 6564 0a20 2020 2020 2020  ferenced.       
-000478a0: 2070 6f70 756c 6174 696f 6e73 2077 696c   populations wil
-000478b0: 6c20 6170 7065 6172 2061 7420 7468 6520  l appear at the 
-000478c0: 656e 6420 6f66 2074 6865 2070 6f70 756c  end of the popul
-000478d0: 6174 696f 6e20 7461 626c 6520 2875 6e6c  ation table (unl
-000478e0: 6573 730a 2020 2020 2020 2020 6060 7265  ess.        ``re
-000478f0: 6f72 6465 725f 706f 7075 6c61 7469 6f6e  order_population
-00047900: 733d 4661 6c73 6560 6029 2e0a 0a20 2020  s=False``)...   
-00047910: 2020 2020 202e 2e20 7365 6561 6c73 6f3a       .. seealso:
-00047920: 3a0a 0a20 2020 2020 2020 2020 2020 203a  :..            :
-00047930: 6d65 7468 3a60 2e6b 6565 705f 696e 7465  meth:`.keep_inte
-00047940: 7276 616c 7360 2066 6f72 2073 7562 7365  rvals` for subse
-00047950: 7474 696e 6720 6120 6769 7665 6e20 706f  tting a given po
-00047960: 7274 696f 6e20 6f66 2074 6865 2067 656e  rtion of the gen
-00047970: 6f6d 653b 0a20 2020 2020 2020 2020 2020  ome;.           
-00047980: 203a 6d65 7468 3a60 2e73 696d 706c 6966   :meth:`.simplif
-00047990: 7960 2066 6f72 2072 6574 6169 6e69 6e67  y` for retaining
-000479a0: 2074 6865 2061 6e63 6573 7472 7920 6f66   the ancestry of
-000479b0: 2061 2073 7562 7365 7420 6f66 206e 6f64   a subset of nod
-000479c0: 6573 2e0a 0a20 2020 2020 2020 203a 7061  es...        :pa
-000479d0: 7261 6d20 6c69 7374 206e 6f64 6573 3a20  ram list nodes: 
-000479e0: 5468 6520 6c69 7374 206f 6620 6e6f 6465  The list of node
-000479f0: 7320 666f 7220 7768 6963 6820 746f 2072  s for which to r
-00047a00: 6574 6169 6e20 696e 666f 726d 6174 696f  etain informatio
-00047a10: 6e2e 2054 6869 730a 2020 2020 2020 2020  n. This.        
-00047a20: 2020 2020 6d61 7920 6265 2061 206e 756d      may be a num
-00047a30: 7079 2061 7272 6179 2028 6f72 2061 7272  py array (or arr
-00047a40: 6179 2d6c 696b 6529 206f 626a 6563 7420  ay-like) object 
-00047a50: 2864 7479 7065 3d6e 702e 696e 7433 3229  (dtype=np.int32)
-00047a60: 2e0a 2020 2020 2020 2020 3a70 6172 616d  ..        :param
-00047a70: 2062 6f6f 6c20 7265 636f 7264 5f70 726f   bool record_pro
-00047a80: 7665 6e61 6e63 653a 2057 6865 7468 6572  venance: Whether
-00047a90: 2074 6f20 7265 636f 7264 2061 2070 726f   to record a pro
-00047aa0: 7665 6e61 6e63 6520 656e 7472 790a 2020  venance entry.  
-00047ab0: 2020 2020 2020 2020 2020 696e 2074 6865            in the
-00047ac0: 2070 726f 7665 6e61 6e63 6520 7461 626c   provenance tabl
-00047ad0: 6520 666f 7220 7468 6973 206f 7065 7261  e for this opera
-00047ae0: 7469 6f6e 2e0a 2020 2020 2020 2020 3a70  tion..        :p
-00047af0: 6172 616d 2062 6f6f 6c20 7265 6f72 6465  aram bool reorde
-00047b00: 725f 706f 7075 6c61 7469 6f6e 733a 2057  r_populations: W
-00047b10: 6865 7468 6572 2074 6f20 7265 6f72 6465  hether to reorde
-00047b20: 7220 706f 7075 6c61 7469 6f6e 730a 2020  r populations.  
-00047b30: 2020 2020 2020 2020 2020 2864 6566 6175            (defau
-00047b40: 6c74 3a20 5472 7565 292e 2020 4966 2046  lt: True).  If F
-00047b50: 616c 7365 2c20 7468 6520 706f 7075 6c61  alse, the popula
-00047b60: 7469 6f6e 2074 6162 6c65 2077 696c 6c20  tion table will 
-00047b70: 6e6f 7420 6265 2061 6c74 6572 6564 2069  not be altered i
-00047b80: 6e0a 2020 2020 2020 2020 2020 2020 616e  n.            an
-00047b90: 7920 7761 792e 0a20 2020 2020 2020 203a  y way..        :
-00047ba0: 7061 7261 6d20 626f 6f6c 2072 656d 6f76  param bool remov
-00047bb0: 655f 756e 7265 6665 7265 6e63 6564 3a20  e_unreferenced: 
-00047bc0: 5768 6574 6865 7220 7369 7465 732c 2069  Whether sites, i
-00047bd0: 6e64 6976 6964 7561 6c73 2c20 616e 6420  ndividuals, and 
-00047be0: 706f 7075 6c61 7469 6f6e 730a 2020 2020  populations.    
-00047bf0: 2020 2020 2020 2020 7468 6174 2061 7265          that are
-00047c00: 206e 6f74 2072 6566 6572 7265 6420 746f   not referred to
-00047c10: 2062 7920 616e 7920 7265 7461 696e 6564   by any retained
-00047c20: 2065 6e74 7269 6573 2069 6e20 7468 6520   entries in the 
-00047c30: 7461 626c 6573 2073 686f 756c 640a 2020  tables should.  
-00047c40: 2020 2020 2020 2020 2020 6265 2072 656d            be rem
-00047c50: 6f76 6564 2028 6465 6661 756c 743a 2054  oved (default: T
-00047c60: 7275 6529 2e20 5365 6520 7468 6520 6465  rue). See the de
-00047c70: 7363 7269 7074 696f 6e20 666f 7220 6465  scription for de
-00047c80: 7461 696c 732e 0a20 2020 2020 2020 203a  tails..        :
-00047c90: 7274 7970 653a 2074 736b 6974 2e54 7265  rtype: tskit.Tre
-00047ca0: 6553 6571 7565 6e63 650a 2020 2020 2020  eSequence.      
-00047cb0: 2020 2222 220a 2020 2020 2020 2020 7461    """.        ta
-00047cc0: 626c 6573 203d 2073 656c 662e 6475 6d70  bles = self.dump
-00047cd0: 5f74 6162 6c65 7328 290a 2020 2020 2020  _tables().      
-00047ce0: 2020 7461 626c 6573 2e73 7562 7365 7428    tables.subset(
-00047cf0: 0a20 2020 2020 2020 2020 2020 206e 6f64  .            nod
-00047d00: 6573 2c0a 2020 2020 2020 2020 2020 2020  es,.            
-00047d10: 7265 636f 7264 5f70 726f 7665 6e61 6e63  record_provenanc
-00047d20: 653d 7265 636f 7264 5f70 726f 7665 6e61  e=record_provena
-00047d30: 6e63 652c 0a20 2020 2020 2020 2020 2020  nce,.           
-00047d40: 2072 656f 7264 6572 5f70 6f70 756c 6174   reorder_populat
-00047d50: 696f 6e73 3d72 656f 7264 6572 5f70 6f70  ions=reorder_pop
-00047d60: 756c 6174 696f 6e73 2c0a 2020 2020 2020  ulations,.      
-00047d70: 2020 2020 2020 7265 6d6f 7665 5f75 6e72        remove_unr
-00047d80: 6566 6572 656e 6365 643d 7265 6d6f 7665  eferenced=remove
-00047d90: 5f75 6e72 6566 6572 656e 6365 642c 0a20  _unreferenced,. 
-00047da0: 2020 2020 2020 2029 0a20 2020 2020 2020         ).       
-00047db0: 2072 6574 7572 6e20 7461 626c 6573 2e74   return tables.t
-00047dc0: 7265 655f 7365 7175 656e 6365 2829 0a0a  ree_sequence()..
-00047dd0: 2020 2020 6465 6620 756e 696f 6e28 0a20      def union(. 
-00047de0: 2020 2020 2020 2073 656c 662c 0a20 2020         self,.   
-00047df0: 2020 2020 206f 7468 6572 2c0a 2020 2020       other,.    
-00047e00: 2020 2020 6e6f 6465 5f6d 6170 7069 6e67      node_mapping
-00047e10: 2c0a 2020 2020 2020 2020 6368 6563 6b5f  ,.        check_
-00047e20: 7368 6172 6564 5f65 7175 616c 6974 793d  shared_equality=
-00047e30: 5472 7565 2c0a 2020 2020 2020 2020 6164  True,.        ad
-00047e40: 645f 706f 7075 6c61 7469 6f6e 733d 5472  d_populations=Tr
-00047e50: 7565 2c0a 2020 2020 2020 2020 7265 636f  ue,.        reco
-00047e60: 7264 5f70 726f 7665 6e61 6e63 653d 5472  rd_provenance=Tr
-00047e70: 7565 2c0a 2020 2020 293a 0a20 2020 2020  ue,.    ):.     
-00047e80: 2020 2022 2222 0a20 2020 2020 2020 2052     """.        R
-00047e90: 6574 7572 6e73 2061 6e20 6578 7061 6e64  eturns an expand
-00047ea0: 6564 2074 7265 6520 7365 7175 656e 6365  ed tree sequence
-00047eb0: 2077 6869 6368 2063 6f6e 7461 696e 7320   which contains 
-00047ec0: 7468 6520 6e6f 6465 2d77 6973 6520 756e  the node-wise un
-00047ed0: 696f 6e20 6f66 0a20 2020 2020 2020 2060  ion of.        `
-00047ee0: 6073 656c 6660 6020 616e 6420 6060 6f74  `self`` and ``ot
-00047ef0: 6865 7260 602c 206f 6274 6169 6e65 6420  her``, obtained 
-00047f00: 6279 2061 6464 696e 6720 7468 6520 6e6f  by adding the no
-00047f10: 6e2d 7368 6172 6564 2070 6f72 7469 6f6e  n-shared portion
-00047f20: 7320 6f66 0a20 2020 2020 2020 2060 606f  s of.        ``o
-00047f30: 7468 6572 6060 206f 6e74 6f20 6060 7365  ther`` onto ``se
-00047f40: 6c66 6060 2e20 5468 6520 2273 6861 7265  lf``. The "share
-00047f50: 6422 2070 6f72 7469 6f6e 7320 6172 6520  d" portions are 
-00047f60: 7370 6563 6966 6965 6420 7573 696e 6720  specified using 
-00047f70: 610a 2020 2020 2020 2020 6d61 7020 7468  a.        map th
-00047f80: 6174 2073 7065 6369 6669 6573 2077 6869  at specifies whi
-00047f90: 6368 206e 6f64 6573 2069 6e20 6060 6f74  ch nodes in ``ot
-00047fa0: 6865 7260 6020 6172 6520 6571 7569 7661  her`` are equiva
-00047fb0: 6c65 6e74 2074 6f20 7468 6f73 6520 696e  lent to those in
-00047fc0: 0a20 2020 2020 2020 2060 6073 656c 6660  .        ``self`
-00047fd0: 603a 2074 6865 2060 606e 6f64 655f 6d61  `: the ``node_ma
-00047fe0: 7070 696e 6760 6020 6172 6775 6d65 6e74  pping`` argument
-00047ff0: 2073 686f 756c 6420 6265 2061 6e20 6172   should be an ar
-00048000: 7261 7920 6f66 206c 656e 6774 680a 2020  ray of length.  
-00048010: 2020 2020 2020 6571 7561 6c20 746f 2074        equal to t
-00048020: 6865 206e 756d 6265 7220 6f66 206e 6f64  he number of nod
-00048030: 6573 2069 6e20 6060 6f74 6865 7260 6020  es in ``other`` 
-00048040: 616e 6420 7768 6f73 6520 656e 7472 6965  and whose entrie
-00048050: 7320 6172 6520 7468 6520 4944 0a20 2020  s are the ID.   
-00048060: 2020 2020 206f 6620 7468 6520 6d61 7463       of the matc
-00048070: 6869 6e67 206e 6f64 6520 696e 2060 6073  hing node in ``s
-00048080: 656c 6660 602c 206f 7220 6060 7473 6b69  elf``, or ``tski
-00048090: 742e 4e55 4c4c 6060 2069 6620 7468 6572  t.NULL`` if ther
-000480a0: 6520 6973 206e 6f0a 2020 2020 2020 2020  e is no.        
-000480b0: 6d61 7463 6869 6e67 206e 6f64 652e 2054  matching node. T
-000480c0: 686f 7365 206e 6f64 6573 2069 6e20 6060  hose nodes in ``
-000480d0: 6f74 6865 7260 6020 7468 6174 206d 6170  other`` that map
-000480e0: 2074 6f20 6060 7473 6b69 742e 4e55 4c4c   to ``tskit.NULL
-000480f0: 6060 2077 696c 6c0a 2020 2020 2020 2020  `` will.        
-00048100: 6265 2061 6464 6564 2074 6f20 6060 7365  be added to ``se
-00048110: 6c66 6060 2c20 616c 6f6e 6720 7769 7468  lf``, along with
-00048120: 3a0a 0a20 2020 2020 2020 2031 2e20 496e  :..        1. In
-00048130: 6469 7669 6475 616c 7320 7768 6f73 6520  dividuals whose 
-00048140: 6e6f 6465 7320 6172 6520 6e65 7720 746f  nodes are new to
-00048150: 2060 6073 656c 6660 602e 0a20 2020 2020   ``self``..     
-00048160: 2020 2032 2e20 4564 6765 7320 7768 6f73     2. Edges whos
-00048170: 6520 7061 7265 6e74 206f 7220 6368 696c  e parent or chil
-00048180: 6420 6172 6520 6e65 7720 746f 2060 6073  d are new to ``s
-00048190: 656c 6660 602e 0a20 2020 2020 2020 2033  elf``..        3
-000481a0: 2e20 4d75 7461 7469 6f6e 7320 7768 6f73  . Mutations whos
-000481b0: 6520 6e6f 6465 7320 6172 6520 6e65 7720  e nodes are new 
-000481c0: 746f 2060 6073 656c 6660 602e 0a20 2020  to ``self``..   
-000481d0: 2020 2020 2034 2e20 5369 7465 7320 7768       4. Sites wh
-000481e0: 6963 6820 7765 7265 206e 6f74 2070 7265  ich were not pre
-000481f0: 7365 6e74 2069 6e20 6060 7365 6c66 6060  sent in ``self``
-00048200: 2c20 6966 2074 6865 2073 6974 6520 636f  , if the site co
-00048210: 6e74 6169 6e73 2061 206e 6577 6c79 0a20  ntains a newly. 
-00048220: 2020 2020 2020 2020 2020 6164 6465 6420            added 
-00048230: 6d75 7461 7469 6f6e 2e0a 0a20 2020 2020  mutation...     
-00048240: 2020 2042 7920 6465 6661 756c 742c 2070     By default, p
-00048250: 6f70 756c 6174 696f 6e73 206f 6620 6e65  opulations of ne
-00048260: 776c 7920 6164 6465 6420 6e6f 6465 7320  wly added nodes 
-00048270: 6172 6520 6173 7375 6d65 6420 746f 2062  are assumed to b
-00048280: 6520 6e65 770a 2020 2020 2020 2020 706f  e new.        po
-00048290: 7075 6c61 7469 6f6e 732c 2061 6e64 2061  pulations, and a
-000482a0: 6464 6564 2074 6f20 7468 6520 706f 7075  dded to the popu
-000482b0: 6c61 7469 6f6e 2074 6162 6c65 2061 7320  lation table as 
-000482c0: 7765 6c6c 2e0a 0a20 2020 2020 2020 204e  well...        N
-000482d0: 6f74 6520 7468 6174 2074 6869 7320 6f70  ote that this op
-000482e0: 6572 6174 696f 6e20 616c 736f 2073 6f72  eration also sor
-000482f0: 7473 2074 6865 2072 6573 756c 7469 6e67  ts the resulting
-00048300: 2074 6162 6c65 732c 2073 6f20 7468 650a   tables, so the.
-00048310: 2020 2020 2020 2020 7265 7375 6c74 696e          resultin
-00048320: 6720 7472 6565 2073 6571 7565 6e63 6520  g tree sequence 
-00048330: 6d61 7920 6e6f 7420 6265 2065 7175 616c  may not be equal
-00048340: 2074 6f20 6060 7365 6c66 6060 2065 7665   to ``self`` eve
-00048350: 6e20 6966 206e 6f74 6869 6e67 0a20 2020  n if nothing.   
-00048360: 2020 2020 206e 6577 2077 6173 2061 6464       new was add
-00048370: 6564 2028 616c 7468 6f75 6768 2069 7420  ed (although it 
-00048380: 776f 756c 6420 6469 6666 6572 206f 6e6c  would differ onl
-00048390: 7920 696e 206f 7264 6572 696e 6720 6f66  y in ordering of
-000483a0: 2074 6865 2074 6162 6c65 7329 2e0a 0a20   the tables)... 
-000483b0: 2020 2020 2020 203a 7061 7261 6d20 5461         :param Ta
-000483c0: 626c 6543 6f6c 6c65 6374 696f 6e20 6f74  bleCollection ot
-000483d0: 6865 723a 2041 6e6f 7468 6572 2074 6162  her: Another tab
-000483e0: 6c65 2063 6f6c 6c65 6374 696f 6e2e 0a20  le collection.. 
-000483f0: 2020 2020 2020 203a 7061 7261 6d20 6c69         :param li
-00048400: 7374 206e 6f64 655f 6d61 7070 696e 673a  st node_mapping:
-00048410: 2041 6e20 6172 7261 7920 6f66 206e 6f64   An array of nod
-00048420: 6520 4944 7320 7468 6174 2072 656c 6174  e IDs that relat
-00048430: 6520 6e6f 6465 7320 696e 0a20 2020 2020  e nodes in.     
-00048440: 2020 2020 2020 2060 606f 7468 6572 6060         ``other``
-00048450: 2074 6f20 6e6f 6465 7320 696e 2060 6073   to nodes in ``s
-00048460: 656c 6660 602e 0a20 2020 2020 2020 203a  elf``..        :
-00048470: 7061 7261 6d20 626f 6f6c 2063 6865 636b  param bool check
-00048480: 5f73 6861 7265 645f 6571 7561 6c69 7479  _shared_equality
-00048490: 3a20 4966 2054 7275 652c 2074 6865 2073  : If True, the s
-000484a0: 6861 7265 6420 706f 7274 696f 6e73 206f  hared portions o
-000484b0: 6620 7468 650a 2020 2020 2020 2020 2020  f the.          
-000484c0: 2020 7472 6565 2073 6571 7565 6e63 6573    tree sequences
-000484d0: 2077 696c 6c20 6265 2063 6865 636b 6564   will be checked
-000484e0: 2066 6f72 2065 7175 616c 6974 792e 2049   for equality. I
-000484f0: 7420 646f 6573 2073 6f20 6279 0a20 2020  t does so by.   
-00048500: 2020 2020 2020 2020 2073 7562 7365 7474           subsett
-00048510: 696e 6720 626f 7468 2060 6073 656c 6660  ing both ``self`
-00048520: 6020 616e 6420 6060 6f74 6865 7260 6020  ` and ``other`` 
-00048530: 6f6e 2074 6865 2065 7175 6976 616c 656e  on the equivalen
-00048540: 7420 6e6f 6465 730a 2020 2020 2020 2020  t nodes.        
-00048550: 2020 2020 7370 6563 6966 6965 6420 696e      specified in
-00048560: 2060 606e 6f64 655f 6d61 7070 696e 6760   ``node_mapping`
-00048570: 602c 2061 6e64 2074 6865 6e20 6368 6563  `, and then chec
-00048580: 6b69 6e67 2066 6f72 2065 7175 616c 6974  king for equalit
-00048590: 7920 6f66 0a20 2020 2020 2020 2020 2020  y of.           
-000485a0: 2074 6865 2073 7562 7365 7473 2e0a 2020   the subsets..  
-000485b0: 2020 2020 2020 3a70 6172 616d 2062 6f6f        :param boo
-000485c0: 6c20 6164 645f 706f 7075 6c61 7469 6f6e  l add_population
-000485d0: 733a 2049 6620 5472 7565 2c20 6e6f 6465  s: If True, node
-000485e0: 7320 6e65 7720 746f 2060 6073 656c 6660  s new to ``self`
-000485f0: 6020 7769 6c6c 2062 650a 2020 2020 2020  ` will be.      
-00048600: 2020 2020 2020 6173 7369 676e 6564 206e        assigned n
-00048610: 6577 2070 6f70 756c 6174 696f 6e20 4944  ew population ID
-00048620: 732e 0a20 2020 2020 2020 203a 7061 7261  s..        :para
-00048630: 6d20 626f 6f6c 2072 6563 6f72 645f 7072  m bool record_pr
-00048640: 6f76 656e 616e 6365 3a20 5768 6574 6865  ovenance: Whethe
-00048650: 7220 746f 2072 6563 6f72 6420 6120 7072  r to record a pr
-00048660: 6f76 656e 616e 6365 2065 6e74 7279 0a20  ovenance entry. 
-00048670: 2020 2020 2020 2020 2020 2069 6e20 7468             in th
-00048680: 6520 7072 6f76 656e 616e 6365 2074 6162  e provenance tab
-00048690: 6c65 2066 6f72 2074 6869 7320 6f70 6572  le for this oper
-000486a0: 6174 696f 6e2e 0a20 2020 2020 2020 2022  ation..        "
-000486b0: 2222 0a20 2020 2020 2020 2074 6162 6c65  "".        table
-000486c0: 7320 3d20 7365 6c66 2e64 756d 705f 7461  s = self.dump_ta
-000486d0: 626c 6573 2829 0a20 2020 2020 2020 206f  bles().        o
-000486e0: 7468 6572 5f74 6162 6c65 7320 3d20 6f74  ther_tables = ot
-000486f0: 6865 722e 6475 6d70 5f74 6162 6c65 7328  her.dump_tables(
-00048700: 290a 2020 2020 2020 2020 7461 626c 6573  ).        tables
-00048710: 2e75 6e69 6f6e 280a 2020 2020 2020 2020  .union(.        
-00048720: 2020 2020 6f74 6865 725f 7461 626c 6573      other_tables
-00048730: 2c0a 2020 2020 2020 2020 2020 2020 6e6f  ,.            no
-00048740: 6465 5f6d 6170 7069 6e67 2c0a 2020 2020  de_mapping,.    
-00048750: 2020 2020 2020 2020 6368 6563 6b5f 7368          check_sh
-00048760: 6172 6564 5f65 7175 616c 6974 793d 6368  ared_equality=ch
-00048770: 6563 6b5f 7368 6172 6564 5f65 7175 616c  eck_shared_equal
-00048780: 6974 792c 0a20 2020 2020 2020 2020 2020  ity,.           
-00048790: 2061 6464 5f70 6f70 756c 6174 696f 6e73   add_populations
-000487a0: 3d61 6464 5f70 6f70 756c 6174 696f 6e73  =add_populations
-000487b0: 2c0a 2020 2020 2020 2020 2020 2020 7265  ,.            re
-000487c0: 636f 7264 5f70 726f 7665 6e61 6e63 653d  cord_provenance=
-000487d0: 7265 636f 7264 5f70 726f 7665 6e61 6e63  record_provenanc
-000487e0: 652c 0a20 2020 2020 2020 2029 0a20 2020  e,.        ).   
-000487f0: 2020 2020 2072 6574 7572 6e20 7461 626c       return tabl
-00048800: 6573 2e74 7265 655f 7365 7175 656e 6365  es.tree_sequence
-00048810: 2829 0a0a 2020 2020 6465 6620 6472 6177  ()..    def draw
-00048820: 5f73 7667 280a 2020 2020 2020 2020 7365  _svg(.        se
-00048830: 6c66 2c0a 2020 2020 2020 2020 7061 7468  lf,.        path
-00048840: 3d4e 6f6e 652c 0a20 2020 2020 2020 202a  =None,.        *
-00048850: 2c0a 2020 2020 2020 2020 7369 7a65 3d4e  ,.        size=N
-00048860: 6f6e 652c 0a20 2020 2020 2020 2078 5f73  one,.        x_s
-00048870: 6361 6c65 3d4e 6f6e 652c 0a20 2020 2020  cale=None,.     
-00048880: 2020 2074 696d 655f 7363 616c 653d 4e6f     time_scale=No
-00048890: 6e65 2c0a 2020 2020 2020 2020 7472 6565  ne,.        tree
-000488a0: 5f68 6569 6768 745f 7363 616c 653d 4e6f  _height_scale=No
-000488b0: 6e65 2c0a 2020 2020 2020 2020 6e6f 6465  ne,.        node
-000488c0: 5f6c 6162 656c 733d 4e6f 6e65 2c0a 2020  _labels=None,.  
-000488d0: 2020 2020 2020 6d75 7461 7469 6f6e 5f6c        mutation_l
-000488e0: 6162 656c 733d 4e6f 6e65 2c0a 2020 2020  abels=None,.    
-000488f0: 2020 2020 726f 6f74 5f73 7667 5f61 7474      root_svg_att
-00048900: 7269 6275 7465 733d 4e6f 6e65 2c0a 2020  ributes=None,.  
-00048910: 2020 2020 2020 7374 796c 653d 4e6f 6e65        style=None
-00048920: 2c0a 2020 2020 2020 2020 6f72 6465 723d  ,.        order=
-00048930: 4e6f 6e65 2c0a 2020 2020 2020 2020 666f  None,.        fo
-00048940: 7263 655f 726f 6f74 5f62 7261 6e63 683d  rce_root_branch=
-00048950: 4e6f 6e65 2c0a 2020 2020 2020 2020 7379  None,.        sy
-00048960: 6d62 6f6c 5f73 697a 653d 4e6f 6e65 2c0a  mbol_size=None,.
-00048970: 2020 2020 2020 2020 785f 6178 6973 3d4e          x_axis=N
-00048980: 6f6e 652c 0a20 2020 2020 2020 2078 5f6c  one,.        x_l
-00048990: 6162 656c 3d4e 6f6e 652c 0a20 2020 2020  abel=None,.     
-000489a0: 2020 2078 5f6c 696d 3d4e 6f6e 652c 0a20     x_lim=None,. 
-000489b0: 2020 2020 2020 2079 5f61 7869 733d 4e6f         y_axis=No
-000489c0: 6e65 2c0a 2020 2020 2020 2020 795f 6c61  ne,.        y_la
-000489d0: 6265 6c3d 4e6f 6e65 2c0a 2020 2020 2020  bel=None,.      
-000489e0: 2020 795f 7469 636b 733d 4e6f 6e65 2c0a    y_ticks=None,.
-000489f0: 2020 2020 2020 2020 795f 6772 6964 6c69          y_gridli
-00048a00: 6e65 733d 4e6f 6e65 2c0a 2020 2020 2020  nes=None,.      
-00048a10: 2020 6f6d 6974 5f73 6974 6573 3d4e 6f6e    omit_sites=Non
-00048a20: 652c 0a20 2020 2020 2020 2063 616e 7661  e,.        canva
-00048a30: 735f 7369 7a65 3d4e 6f6e 652c 0a20 2020  s_size=None,.   
-00048a40: 2020 2020 206d 6178 5f6e 756d 5f74 7265       max_num_tre
-00048a50: 6573 3d4e 6f6e 652c 0a20 2020 2020 2020  es=None,.       
-00048a60: 202a 2a6b 7761 7267 732c 0a20 2020 2029   **kwargs,.    )
-00048a70: 3a0a 2020 2020 2020 2020 2222 220a 2020  :.        """.  
-00048a80: 2020 2020 2020 5265 7475 726e 2061 6e20        Return an 
-00048a90: 5356 4720 7265 7072 6573 656e 7461 7469  SVG representati
-00048aa0: 6f6e 206f 6620 6120 7472 6565 2073 6571  on of a tree seq
-00048ab0: 7565 6e63 652e 2053 6565 2074 6865 0a20  uence. See the. 
-00048ac0: 2020 2020 2020 203a 7265 663a 6076 6973         :ref:`vis
-00048ad0: 7561 6c69 7a61 7469 6f6e 2074 7574 6f72  ualization tutor
-00048ae0: 6961 6c3c 7475 746f 7269 616c 733a 7365  ial<tutorials:se
-00048af0: 635f 7473 6b69 745f 7669 7a3e 6020 666f  c_tskit_viz>` fo
-00048b00: 7220 6d6f 7265 2064 6574 6169 6c73 2e0a  r more details..
-00048b10: 0a20 2020 2020 2020 203a 7061 7261 6d20  .        :param 
-00048b20: 7374 7220 7061 7468 3a20 5468 6520 7061  str path: The pa
-00048b30: 7468 2074 6f20 7468 6520 6669 6c65 2074  th to the file t
-00048b40: 6f20 7772 6974 6520 7468 6520 6f75 7470  o write the outp
-00048b50: 7574 2e20 4966 204e 6f6e 652c 2064 6f20  ut. If None, do 
-00048b60: 6e6f 7420 7772 6974 650a 2020 2020 2020  not write.      
-00048b70: 2020 2020 2020 746f 2066 696c 652e 0a20        to file.. 
-00048b80: 2020 2020 2020 203a 7061 7261 6d20 7475         :param tu
-00048b90: 706c 6528 696e 742c 2069 6e74 2920 7369  ple(int, int) si
-00048ba0: 7a65 3a20 4120 7475 706c 6520 6f66 2028  ze: A tuple of (
-00048bb0: 7769 6474 682c 2068 6569 6768 7429 2073  width, height) s
-00048bc0: 7065 6369 6679 696e 6720 6120 7461 7267  pecifying a targ
-00048bd0: 6574 0a20 2020 2020 2020 2020 2020 2064  et.            d
-00048be0: 7261 7769 6e67 2073 697a 6520 696e 2061  rawing size in a
-00048bf0: 6273 7472 6163 7420 7573 6572 2075 6e69  bstract user uni
-00048c00: 7473 2028 7573 7561 6c6c 7920 696e 7465  ts (usually inte
-00048c10: 7270 7265 7465 6420 6173 2070 6978 656c  rpreted as pixel
-00048c20: 7320 6f6e 0a20 2020 2020 2020 2020 2020  s on.           
-00048c30: 2069 6e69 7469 616c 2064 6973 706c 6179   initial display
-00048c40: 292e 2043 6f6d 706f 6e65 6e74 7320 6f66  ). Components of
-00048c50: 2074 6865 2064 7261 7769 6e67 2077 696c   the drawing wil
-00048c60: 6c20 6265 2073 6361 6c65 6420 736f 2074  l be scaled so t
-00048c70: 6861 7420 7468 6520 746f 7461 6c0a 2020  hat the total.  
-00048c80: 2020 2020 2020 2020 2020 706c 6f74 2069            plot i
-00048c90: 6e63 6c75 6469 6e67 206c 6162 656c 7320  ncluding labels 
-00048ca0: 6574 632e 206e 6f72 6d61 6c6c 7920 6669  etc. normally fi
-00048cb0: 7473 206f 6e74 6f20 6120 6361 6e76 6173  ts onto a canvas
-00048cc0: 206f 6620 7468 6973 2073 697a 6520 2873   of this size (s
-00048cd0: 6565 0a20 2020 2020 2020 2020 2020 2060  ee.            `
-00048ce0: 6063 616e 7661 735f 7369 7a65 6060 2062  `canvas_size`` b
-00048cf0: 656c 6f77 292e 2049 6620 6060 4e6f 6e65  elow). If ``None
-00048d00: 6060 2c20 6368 6f73 6520 7661 6c75 6573  ``, chose values
-00048d10: 2073 7563 6820 7468 6174 2065 6163 6820   such that each 
-00048d20: 7472 6565 2069 730a 2020 2020 2020 2020  tree is.        
-00048d30: 2020 2020 6472 6177 6e20 6174 2061 2073      drawn at a s
-00048d40: 697a 6520 6170 7072 6f70 7269 6174 6520  ize appropriate 
-00048d50: 666f 7220 6120 7265 6173 6f6e 6162 6c79  for a reasonably
-00048d60: 2073 6d61 6c6c 2073 6574 206f 6620 7361   small set of sa
-00048d70: 6d70 6c65 7320 2874 6869 7320 7769 6c6c  mples (this will
-00048d80: 0a20 2020 2020 2020 2020 2020 206e 6576  .            nev
-00048d90: 6572 7468 656c 6573 7320 7265 7375 6c74  ertheless result
-00048da0: 2069 6e20 6120 7665 7279 2077 6964 6520   in a very wide 
-00048db0: 6472 6177 696e 6720 6966 2074 6865 7265  drawing if there
-00048dc0: 2061 7265 206d 616e 7920 7472 6565 7320   are many trees 
-00048dd0: 746f 0a20 2020 2020 2020 2020 2020 2064  to.            d
-00048de0: 6973 706c 6179 292e 2044 6566 6175 6c74  isplay). Default
-00048df0: 3a20 6060 4e6f 6e65 6060 0a20 2020 2020  : ``None``.     
-00048e00: 2020 203a 7061 7261 6d20 7374 7220 785f     :param str x_
-00048e10: 7363 616c 653a 2043 6f6e 7472 6f6c 2068  scale: Control h
-00048e20: 6f77 2074 6865 2058 2061 7869 7320 6973  ow the X axis is
-00048e30: 2064 7261 776e 2e20 4966 2022 7068 7973   drawn. If "phys
-00048e40: 6963 616c 2220 2874 6865 2064 6566 6175  ical" (the defau
-00048e50: 6c74 290a 2020 2020 2020 2020 2020 2020  lt).            
-00048e60: 7468 6520 6178 6973 2073 6361 6c65 7320  the axis scales 
-00048e70: 6c69 6e65 6172 6c79 2077 6974 6820 7068  linearly with ph
-00048e80: 7973 6963 616c 2064 6973 7461 6e63 6520  ysical distance 
-00048e90: 616c 6f6e 6720 7468 6520 7365 7175 656e  along the sequen
-00048ea0: 6365 2c0a 2020 2020 2020 2020 2020 2020  ce,.            
-00048eb0: 6261 636b 6772 6f75 6e64 2073 6861 6469  background shadi
-00048ec0: 6e67 2069 7320 7573 6564 2074 6f20 696e  ng is used to in
-00048ed0: 6469 6361 7465 2074 6865 2070 6f73 6974  dicate the posit
-00048ee0: 696f 6e20 6f66 2074 6865 2074 7265 6573  ion of the trees
-00048ef0: 2061 6c6f 6e67 2074 6865 0a20 2020 2020   along the.     
-00048f00: 2020 2020 2020 2058 2061 7869 732c 2061         X axis, a
-00048f10: 6e64 2073 6974 6573 2028 7769 7468 2061  nd sites (with a
-00048f20: 7373 6f63 6961 7465 6420 6d75 7461 7469  ssociated mutati
-00048f30: 6f6e 7329 2061 7265 206d 6172 6b65 6420  ons) are marked 
-00048f40: 6174 2074 6865 0a20 2020 2020 2020 2020  at the.         
-00048f50: 2020 2061 7070 726f 7072 6961 7465 2070     appropriate p
-00048f60: 6879 7369 6361 6c20 706f 7369 7469 6f6e  hysical position
-00048f70: 206f 6e20 6178 6973 206c 696e 652e 2049   on axis line. I
-00048f80: 6620 2274 7265 6577 6973 6522 2c20 6561  f "treewise", ea
-00048f90: 6368 2061 7869 7320 7469 636b 0a20 2020  ch axis tick.   
-00048fa0: 2020 2020 2020 2020 2063 6f72 7265 7370           corresp
-00048fb0: 6f6e 6473 2074 6f20 6120 7472 6565 2062  onds to a tree b
-00048fc0: 6f75 6e64 6172 792c 2077 6869 6368 2061  oundary, which a
-00048fd0: 7265 2070 6f73 6974 696f 6e65 6420 6576  re positioned ev
-00048fe0: 656e 6c79 2061 6c6f 6e67 2074 6865 2061  enly along the a
-00048ff0: 7869 732c 0a20 2020 2020 2020 2020 2020  xis,.           
-00049000: 2073 6f20 7468 6174 2074 6865 2058 2061   so that the X a
-00049010: 7869 7320 6973 206f 6620 7661 7269 6162  xis is of variab
-00049020: 6c65 2073 6361 6c65 2c20 6e6f 2062 6163  le scale, no bac
-00049030: 6b67 726f 756e 6420 7363 616c 696e 6720  kground scaling 
-00049040: 6973 2072 6571 7569 7265 642c 0a20 2020  is required,.   
-00049050: 2020 2020 2020 2020 2061 6e64 2073 6974           and sit
-00049060: 6520 706f 7369 7469 6f6e 7320 6172 6520  e positions are 
-00049070: 6e6f 7420 6d61 726b 6564 206f 6e20 7468  not marked on th
-00049080: 6520 6178 6973 2e0a 2020 2020 2020 2020  e axis..        
-00049090: 3a70 6172 616d 2073 7472 2074 696d 655f  :param str time_
-000490a0: 7363 616c 653a 2043 6f6e 7472 6f6c 2068  scale: Control h
-000490b0: 6f77 2068 6569 6768 7420 7661 6c75 6573  ow height values
-000490c0: 2066 6f72 206e 6f64 6573 2061 7265 2063   for nodes are c
-000490d0: 6f6d 7075 7465 642e 0a20 2020 2020 2020  omputed..       
-000490e0: 2020 2020 2049 6620 7468 6973 2069 7320       If this is 
-000490f0: 6571 7561 6c20 746f 2060 6022 7469 6d65  equal to ``"time
-00049100: 2260 602c 206e 6f64 6520 6865 6967 6874  "``, node height
-00049110: 7320 6172 6520 7072 6f70 6f72 7469 6f6e  s are proportion
-00049120: 616c 2074 6f20 7468 6569 7220 7469 6d65  al to their time
-00049130: 0a20 2020 2020 2020 2020 2020 2076 616c  .            val
-00049140: 7565 7320 2874 6869 7320 6973 2074 6865  ues (this is the
-00049150: 2064 6566 6175 6c74 292e 2049 6620 7468   default). If th
-00049160: 6973 2069 7320 6571 7561 6c20 746f 2060  is is equal to `
-00049170: 6022 6c6f 675f 7469 6d65 2260 602c 206e  `"log_time"``, n
-00049180: 6f64 650a 2020 2020 2020 2020 2020 2020  ode.            
-00049190: 6865 6967 6874 7320 6172 6520 7072 6f70  heights are prop
-000491a0: 6f72 7469 6f6e 616c 2074 6f20 7468 6569  ortional to thei
-000491b0: 7220 6c6f 6728 7469 6d65 2920 7661 6c75  r log(time) valu
-000491c0: 6573 2e20 4966 2069 7420 6973 2065 7175  es. If it is equ
-000491d0: 616c 2074 6f0a 2020 2020 2020 2020 2020  al to.          
-000491e0: 2020 6060 2272 616e 6b22 6060 2c20 6e6f    ``"rank"``, no
-000491f0: 6465 2068 6569 6768 7473 2061 7265 2073  de heights are s
-00049200: 7061 6365 6420 6571 7561 6c6c 7920 6163  paced equally ac
-00049210: 636f 7264 696e 6720 746f 2074 6865 6972  cording to their
-00049220: 2072 616e 6b65 6420 7469 6d65 732e 0a20   ranked times.. 
-00049230: 2020 2020 2020 203a 7061 7261 6d20 7374         :param st
-00049240: 7220 7472 6565 5f68 6569 6768 745f 7363  r tree_height_sc
-00049250: 616c 653a 2044 6570 7265 6361 7465 6420  ale: Deprecated 
-00049260: 616c 6961 7320 666f 7220 7469 6d65 5f73  alias for time_s
-00049270: 6361 6c65 2e20 2844 6570 7265 6361 7465  cale. (Deprecate
-00049280: 6420 696e 0a20 2020 2020 2020 2020 2020  d in.           
-00049290: 2030 2e33 2e36 290a 2020 2020 2020 2020   0.3.6).        
-000492a0: 3a70 6172 616d 206e 6f64 655f 6c61 6265  :param node_labe
-000492b0: 6c73 3a20 4966 2073 7065 6369 6669 6564  ls: If specified
-000492c0: 2c20 7368 6f77 2063 7573 746f 6d20 6c61  , show custom la
-000492d0: 6265 6c73 2066 6f72 2074 6865 206e 6f64  bels for the nod
-000492e0: 6573 0a20 2020 2020 2020 2020 2020 2028  es.            (
-000492f0: 7370 6563 6966 6965 6420 6279 2049 4429  specified by ID)
-00049300: 2074 6861 7420 6172 6520 7072 6573 656e   that are presen
-00049310: 7420 696e 2074 6869 7320 6d61 703b 2061  t in this map; a
-00049320: 6e79 206e 6f64 6573 206e 6f74 2070 7265  ny nodes not pre
-00049330: 7365 6e74 2077 696c 6c0a 2020 2020 2020  sent will.      
-00049340: 2020 2020 2020 6e6f 7420 6861 7665 2061        not have a
-00049350: 206c 6162 656c 2e0a 2020 2020 2020 2020   label..        
-00049360: 3a74 7970 6520 6e6f 6465 5f6c 6162 656c  :type node_label
-00049370: 733a 2064 6963 7428 696e 742c 2073 7472  s: dict(int, str
-00049380: 290a 2020 2020 2020 2020 3a70 6172 616d  ).        :param
-00049390: 206d 7574 6174 696f 6e5f 6c61 6265 6c73   mutation_labels
-000493a0: 3a20 4966 2073 7065 6369 6669 6564 2c20  : If specified, 
-000493b0: 7368 6f77 2063 7573 746f 6d20 6c61 6265  show custom labe
-000493c0: 6c73 2066 6f72 2074 6865 0a20 2020 2020  ls for the.     
-000493d0: 2020 2020 2020 206d 7574 6174 696f 6e73         mutations
-000493e0: 2028 7370 6563 6966 6965 6420 6279 2049   (specified by I
-000493f0: 4429 2074 6861 7420 6172 6520 7072 6573  D) that are pres
-00049400: 656e 7420 696e 2074 6865 206d 6170 3b20  ent in the map; 
-00049410: 616e 7920 6d75 7461 7469 6f6e 730a 2020  any mutations.  
-00049420: 2020 2020 2020 2020 2020 6e6f 7420 7072            not pr
-00049430: 6573 656e 7420 7769 6c6c 206e 6f74 2068  esent will not h
-00049440: 6176 6520 6120 6c61 6265 6c2e 0a20 2020  ave a label..   
-00049450: 2020 2020 203a 7479 7065 206d 7574 6174       :type mutat
-00049460: 696f 6e5f 6c61 6265 6c73 3a20 6469 6374  ion_labels: dict
-00049470: 2869 6e74 2c20 7374 7229 0a20 2020 2020  (int, str).     
-00049480: 2020 203a 7061 7261 6d20 6469 6374 2072     :param dict r
-00049490: 6f6f 745f 7376 675f 6174 7472 6962 7574  oot_svg_attribut
-000494a0: 6573 3a20 4164 6469 7469 6f6e 616c 2061  es: Additional a
-000494b0: 7474 7269 6275 7465 732c 2073 7563 6820  ttributes, such 
-000494c0: 6173 2061 6e20 6964 2c20 7468 6174 2077  as an id, that w
-000494d0: 696c 6c0a 2020 2020 2020 2020 2020 2020  ill.            
-000494e0: 6265 2065 6d62 6564 6465 6420 696e 2074  be embedded in t
-000494f0: 6865 2072 6f6f 7420 6060 3c73 7667 3e60  he root ``<svg>`
-00049500: 6020 7461 6720 6f66 2074 6865 2067 656e  ` tag of the gen
-00049510: 6572 6174 6564 2064 7261 7769 6e67 2e0a  erated drawing..
-00049520: 2020 2020 2020 2020 3a70 6172 616d 2073          :param s
-00049530: 7472 2073 7479 6c65 3a20 4120 6063 7373  tr style: A `css
-00049540: 2073 7472 696e 6720 3c68 7474 7073 3a2f   string <https:/
-00049550: 2f77 7777 2e77 332e 6f72 672f 5452 2f43  /www.w3.org/TR/C
-00049560: 5353 3231 2f73 796e 6461 7461 2e68 746d  SS21/syndata.htm
-00049570: 3e60 5f0a 2020 2020 2020 2020 2020 2020  >`_.            
-00049580: 7468 6174 2077 696c 6c20 6265 2069 6e63  that will be inc
-00049590: 6c75 6465 6420 696e 2074 6865 2060 603c  luded in the ``<
-000495a0: 7374 796c 653e 6060 2074 6167 206f 6620  style>`` tag of 
-000495b0: 7468 6520 6765 6e65 7261 7465 6420 7376  the generated sv
-000495c0: 672e 0a20 2020 2020 2020 203a 7061 7261  g..        :para
-000495d0: 6d20 7374 7220 6f72 6465 723a 2054 6865  m str order: The
-000495e0: 206c 6566 742d 746f 2d72 6967 6874 206f   left-to-right o
-000495f0: 7264 6572 696e 6720 6f66 2063 6869 6c64  rdering of child
-00049600: 206e 6f64 6573 2069 6e20 6561 6368 2064   nodes in each d
-00049610: 7261 776e 2074 7265 652e 0a20 2020 2020  rawn tree..     
-00049620: 2020 2020 2020 2054 6869 7320 6361 6e20         This can 
-00049630: 6265 2065 6974 6865 723a 2060 6022 6d69  be either: ``"mi
-00049640: 6e6c 6578 2260 602c 2077 6869 6368 206d  nlex"``, which m
-00049650: 696e 696d 6973 6573 2074 6865 2064 6966  inimises the dif
-00049660: 6665 7265 6e63 6573 0a20 2020 2020 2020  ferences.       
-00049670: 2020 2020 2062 6574 7765 656e 2061 646a       between adj
-00049680: 6163 656e 7420 7472 6565 7320 2873 6565  acent trees (see
-00049690: 2061 6c73 6f20 7468 6520 6060 226d 696e   also the ``"min
-000496a0: 6c65 785f 706f 7374 6f72 6465 7222 6060  lex_postorder"``
-000496b0: 2074 7261 7665 7273 616c 0a20 2020 2020   traversal.     
-000496c0: 2020 2020 2020 206f 7264 6572 2066 6f72         order for
-000496d0: 2074 6865 203a 6d65 7468 3a60 2e54 7265   the :meth:`.Tre
-000496e0: 652e 6e6f 6465 7360 206d 6574 686f 6429  e.nodes` method)
-000496f0: 3b20 6f72 2060 6022 7472 6565 2260 6020  ; or ``"tree"`` 
-00049700: 7768 6963 6820 6472 6177 7320 7472 6565  which draws tree
-00049710: 730a 2020 2020 2020 2020 2020 2020 696e  s.            in
-00049720: 2074 6865 206c 6566 742d 746f 2d72 6967   the left-to-rig
-00049730: 6874 206f 7264 6572 2064 6566 696e 6564  ht order defined
-00049740: 2062 7920 7468 650a 2020 2020 2020 2020   by the.        
-00049750: 2020 2020 3a72 6566 3a60 7175 696e 7475      :ref:`quintu
-00049760: 706c 7920 6c69 6e6b 6564 2074 7265 6520  ply linked tree 
-00049770: 7374 7275 6374 7572 6520 3c73 6563 5f64  structure <sec_d
-00049780: 6174 615f 6d6f 6465 6c5f 7472 6565 5f73  ata_model_tree_s
-00049790: 7472 7563 7475 7265 3e60 2e0a 2020 2020  tructure>`..    
-000497a0: 2020 2020 2020 2020 4966 206e 6f74 2073          If not s
-000497b0: 7065 6369 6669 6564 206f 7220 4e6f 6e65  pecified or None
-000497c0: 2c20 7468 6973 2064 6566 6175 6c74 7320  , this defaults 
-000497d0: 746f 2060 6022 6d69 6e6c 6578 2260 602e  to ``"minlex"``.
-000497e0: 0a20 2020 2020 2020 203a 7061 7261 6d20  .        :param 
-000497f0: 626f 6f6c 2066 6f72 6365 5f72 6f6f 745f  bool force_root_
-00049800: 6272 616e 6368 3a20 4966 2060 6054 7275  branch: If ``Tru
-00049810: 6560 6020 706c 6f74 2061 2062 7261 6e63  e`` plot a branc
-00049820: 6820 2865 6467 6529 2061 626f 7665 2065  h (edge) above e
-00049830: 7665 7279 2074 7265 650a 2020 2020 2020  very tree.      
-00049840: 2020 2020 2020 726f 6f74 2069 6e20 7468        root in th
-00049850: 6520 7472 6565 2073 6571 7565 6e63 652e  e tree sequence.
-00049860: 2049 6620 6060 4e6f 6e65 6060 2028 6465   If ``None`` (de
-00049870: 6661 756c 7429 2074 6865 6e20 6f6e 6c79  fault) then only
-00049880: 2070 6c6f 7420 7375 6368 0a20 2020 2020   plot such.     
-00049890: 2020 2020 2020 2072 6f6f 7420 6272 616e         root bran
-000498a0: 6368 6573 2069 6620 616e 7920 726f 6f74  ches if any root
-000498b0: 2069 6e20 7468 6520 7472 6565 2073 6571   in the tree seq
-000498c0: 7565 6e63 6520 6861 7320 6120 6d75 7461  uence has a muta
-000498d0: 7469 6f6e 2061 626f 7665 2069 742e 0a20  tion above it.. 
-000498e0: 2020 2020 2020 203a 7061 7261 6d20 666c         :param fl
-000498f0: 6f61 7420 7379 6d62 6f6c 5f73 697a 653a  oat symbol_size:
-00049900: 2043 6861 6e67 6520 7468 6520 6465 6661   Change the defa
-00049910: 756c 7420 7369 7a65 206f 6620 7468 6520  ult size of the 
-00049920: 6e6f 6465 2061 6e64 206d 7574 6174 696f  node and mutatio
-00049930: 6e0a 2020 2020 2020 2020 2020 2020 706c  n.            pl
-00049940: 6f74 7469 6e67 2073 796d 626f 6c73 2e20  otting symbols. 
-00049950: 4966 2060 604e 6f6e 6560 6020 2864 6566  If ``None`` (def
-00049960: 6175 6c74 2920 7573 6520 6120 7374 616e  ault) use a stan
-00049970: 6461 7264 2073 697a 652e 0a20 2020 2020  dard size..     
-00049980: 2020 203a 7061 7261 6d20 626f 6f6c 2078     :param bool x
-00049990: 5f61 7869 733a 2053 686f 756c 6420 7468  _axis: Should th
-000499a0: 6520 706c 6f74 2068 6176 6520 616e 2058  e plot have an X
-000499b0: 2061 7869 7320 6c69 6e65 2c20 7368 6f77   axis line, show
-000499c0: 696e 6720 7468 6520 706f 7369 7469 6f6e  ing the position
-000499d0: 730a 2020 2020 2020 2020 2020 2020 6f66  s.            of
-000499e0: 2074 7265 6573 2061 6c6f 6e67 2074 6865   trees along the
-000499f0: 2067 656e 6f6d 652e 2054 6865 2073 6361   genome. The sca
-00049a00: 6c65 2075 7365 6420 6973 2064 6574 6572  le used is deter
-00049a10: 6d69 6e65 6420 6279 2074 6865 2060 6078  mined by the ``x
-00049a20: 5f73 6361 6c65 6060 0a20 2020 2020 2020  _scale``.       
-00049a30: 2020 2020 2070 6172 616d 6574 6572 2e20       parameter. 
-00049a40: 4966 2060 604e 6f6e 6560 6020 2864 6566  If ``None`` (def
-00049a50: 6175 6c74 2920 706c 6f74 2061 6e20 5820  ault) plot an X 
-00049a60: 6178 6973 2e0a 2020 2020 2020 2020 3a70  axis..        :p
-00049a70: 6172 616d 2073 7472 2078 5f6c 6162 656c  aram str x_label
-00049a80: 3a20 506c 6163 6520 6120 6c61 6265 6c20  : Place a label 
-00049a90: 756e 6465 7220 7468 6520 706c 6f74 2e20  under the plot. 
-00049aa0: 4966 2060 604e 6f6e 6560 6020 2864 6566  If ``None`` (def
-00049ab0: 6175 6c74 2920 616e 640a 2020 2020 2020  ault) and.      
-00049ac0: 2020 2020 2020 7468 6572 6520 6973 2061        there is a
-00049ad0: 6e20 5820 6178 6973 2c20 6372 6561 7465  n X axis, create
-00049ae0: 2061 6e64 2070 6c61 6365 2061 6e20 6170   and place an ap
-00049af0: 7072 6f70 7269 6174 6520 6c61 6265 6c2e  propriate label.
-00049b00: 0a20 2020 2020 2020 203a 7061 7261 6d20  .        :param 
-00049b10: 6c69 7374 2078 5f6c 696d 3a20 4120 6c69  list x_lim: A li
-00049b20: 7374 206f 6620 7369 7a65 2074 776f 2067  st of size two g
-00049b30: 6976 696e 6720 7468 6520 6765 6e6f 6d69  iving the genomi
-00049b40: 6320 706f 7369 7469 6f6e 7320 6265 7477  c positions betw
-00049b50: 6565 6e20 7768 6963 680a 2020 2020 2020  een which.      
-00049b60: 2020 2020 2020 7472 6565 7320 7368 6f75        trees shou
-00049b70: 6c64 2062 6520 706c 6f74 7465 642e 2049  ld be plotted. I
-00049b80: 6620 7468 6520 6669 7273 7420 6973 2060  f the first is `
-00049b90: 604e 6f6e 6560 602c 2074 6865 6e20 706c  `None``, then pl
-00049ba0: 6f74 2066 726f 6d20 7468 6520 6669 7273  ot from the firs
-00049bb0: 740a 2020 2020 2020 2020 2020 2020 6e6f  t.            no
-00049bc0: 6e2d 656d 7074 7920 7265 6769 6f6e 206f  n-empty region o
-00049bd0: 6620 7468 6520 7472 6565 2073 6571 7565  f the tree seque
-00049be0: 6e63 652e 2049 6620 7468 6520 7365 636f  nce. If the seco
-00049bf0: 6e64 2069 7320 6060 4e6f 6e65 6060 2c20  nd is ``None``, 
-00049c00: 7468 656e 2070 6c6f 740a 2020 2020 2020  then plot.      
-00049c10: 2020 2020 2020 7570 2074 6f20 7468 6520        up to the 
-00049c20: 656e 6420 6f66 2074 6865 206c 6173 7420  end of the last 
-00049c30: 6e6f 6e2d 656d 7074 7920 7265 6769 6f6e  non-empty region
-00049c40: 206f 6620 7468 6520 7472 6565 2073 6571   of the tree seq
-00049c50: 7565 6e63 652e 2054 6865 2064 6566 6175  uence. The defau
-00049c60: 6c74 0a20 2020 2020 2020 2020 2020 2076  lt.            v
-00049c70: 616c 7565 2060 6078 5f6c 696d 3d4e 6f6e  alue ``x_lim=Non
-00049c80: 6560 6020 6973 2073 686f 7274 6861 6e64  e`` is shorthand
-00049c90: 2066 6f72 2074 6865 206c 6973 7420 5b60   for the list [`
-00049ca0: 604e 6f6e 6560 602c 2060 604e 6f6e 6560  `None``, ``None`
-00049cb0: 605d 2e20 4966 0a20 2020 2020 2020 2020  `]. If.         
-00049cc0: 2020 206e 756d 6572 6963 616c 2076 616c     numerical val
-00049cd0: 7565 7320 6172 6520 6769 7665 6e2c 2074  ues are given, t
-00049ce0: 6865 6e20 7265 6769 6f6e 7320 6f75 7473  hen regions outs
-00049cf0: 6964 6520 7468 6520 696e 7465 7276 616c  ide the interval
-00049d00: 2068 6176 6520 616c 6c0a 2020 2020 2020   have all.      
-00049d10: 2020 2020 2020 696e 666f 726d 6174 696f        informatio
-00049d20: 6e20 6469 7363 6172 6465 643a 2074 6869  n discarded: thi
-00049d30: 7320 6d65 616e 7320 7468 6174 206d 7574  s means that mut
-00049d40: 6174 696f 6e73 206f 7574 7369 6465 2074  ations outside t
-00049d50: 6865 2069 6e74 6572 7661 6c20 7769 6c6c  he interval will
-00049d60: 0a20 2020 2020 2020 2020 2020 206e 6f74  .            not
-00049d70: 2062 6520 7368 6f77 6e2e 2054 6f20 666f   be shown. To fo
-00049d80: 7263 6520 6469 7370 6c61 7920 6f66 2074  rce display of t
-00049d90: 6865 2065 6e74 6972 6520 7472 6565 2073  he entire tree s
-00049da0: 6571 7565 6e63 652c 2069 6e63 6c75 6469  equence, includi
-00049db0: 6e67 2065 6d70 7479 0a20 2020 2020 2020  ng empty.       
-00049dc0: 2020 2020 2066 6c61 6e6b 696e 6720 7265       flanking re
-00049dd0: 6769 6f6e 732c 2073 7065 6369 6679 2060  gions, specify `
-00049de0: 6078 5f6c 696d 3d5b 302c 2074 732e 7365  `x_lim=[0, ts.se
-00049df0: 7175 656e 6365 5f6c 656e 6774 685d 6060  quence_length]``
-00049e00: 2e0a 2020 2020 2020 2020 3a70 6172 616d  ..        :param
-00049e10: 2062 6f6f 6c20 795f 6178 6973 3a20 5368   bool y_axis: Sh
-00049e20: 6f75 6c64 2074 6865 2070 6c6f 7420 6861  ould the plot ha
-00049e30: 7665 2061 6e20 5920 6178 6973 206c 696e  ve an Y axis lin
-00049e40: 652c 2073 686f 7769 6e67 2074 696d 6520  e, showing time 
-00049e50: 286f 720a 2020 2020 2020 2020 2020 2020  (or.            
-00049e60: 7261 6e6b 6564 206e 6f64 6520 7469 6d65  ranked node time
-00049e70: 2069 6620 6060 7469 6d65 5f73 6361 6c65   if ``time_scale
-00049e80: 3d22 7261 6e6b 2260 602e 2049 6620 6060  ="rank"``. If ``
-00049e90: 4e6f 6e65 6060 2028 6465 6661 756c 7429  None`` (default)
-00049ea0: 0a20 2020 2020 2020 2020 2020 2064 6f20  .            do 
-00049eb0: 6e6f 7420 706c 6f74 2061 2059 2061 7869  not plot a Y axi
-00049ec0: 732e 0a20 2020 2020 2020 203a 7061 7261  s..        :para
-00049ed0: 6d20 7374 7220 795f 6c61 6265 6c3a 2050  m str y_label: P
-00049ee0: 6c61 6365 2061 206c 6162 656c 2074 6f20  lace a label to 
-00049ef0: 7468 6520 6c65 6674 206f 6620 7468 6520  the left of the 
-00049f00: 706c 6f74 2e20 4966 2060 604e 6f6e 6560  plot. If ``None`
-00049f10: 6020 2864 6566 6175 6c74 290a 2020 2020  ` (default).    
-00049f20: 2020 2020 2020 2020 616e 6420 7468 6572          and ther
-00049f30: 6520 6973 2061 2059 2061 7869 732c 2063  e is a Y axis, c
-00049f40: 7265 6174 6520 616e 6420 706c 6163 6520  reate and place 
-00049f50: 616e 2061 7070 726f 7072 6961 7465 206c  an appropriate l
-00049f60: 6162 656c 2e0a 2020 2020 2020 2020 3a70  abel..        :p
-00049f70: 6172 616d 206c 6973 7420 795f 7469 636b  aram list y_tick
-00049f80: 733a 2041 206c 6973 7420 6f66 2059 2076  s: A list of Y v
-00049f90: 616c 7565 7320 6174 2077 6869 6368 2074  alues at which t
-00049fa0: 6f20 706c 6f74 2074 6963 6b6d 6172 6b73  o plot tickmarks
-00049fb0: 2028 6060 5b5d 6060 0a20 2020 2020 2020   (``[]``.       
-00049fc0: 2020 2020 2067 6976 6573 206e 6f20 7469       gives no ti
-00049fd0: 636b 6d61 726b 7329 2e20 4966 2060 604e  ckmarks). If ``N
-00049fe0: 6f6e 6560 602c 2070 6c6f 7420 6f6e 6520  one``, plot one 
-00049ff0: 7469 636b 6d61 726b 2066 6f72 2065 6163  tickmark for eac
-0004a000: 6820 756e 6971 7565 0a20 2020 2020 2020  h unique.       
-0004a010: 2020 2020 206e 6f64 6520 7661 6c75 652e       node value.
-0004a020: 0a20 2020 2020 2020 203a 7061 7261 6d20  .        :param 
-0004a030: 626f 6f6c 2079 5f67 7269 646c 696e 6573  bool y_gridlines
-0004a040: 3a20 5768 6574 6865 7220 746f 2070 6c6f  : Whether to plo
-0004a050: 7420 686f 7269 7a6f 6e74 616c 206c 696e  t horizontal lin
-0004a060: 6573 2062 6568 696e 6420 7468 6520 7472  es behind the tr
-0004a070: 6565 0a20 2020 2020 2020 2020 2020 2061  ee.            a
-0004a080: 7420 6561 6368 2079 2074 6963 6b6d 6172  t each y tickmar
-0004a090: 6b2e 0a20 2020 2020 2020 203a 7061 7261  k..        :para
-0004a0a0: 6d20 626f 6f6c 206f 6d69 745f 7369 7465  m bool omit_site
-0004a0b0: 733a 2049 6620 5472 7565 2c20 6f6d 6974  s: If True, omit
-0004a0c0: 2073 6974 6573 2061 6e64 206d 7574 6174   sites and mutat
-0004a0d0: 696f 6e73 2066 726f 6d20 7468 6520 6472  ions from the dr
-0004a0e0: 6177 696e 672e 0a20 2020 2020 2020 2020  awing..         
-0004a0f0: 2020 2044 6566 6175 6c74 3a20 4661 6c73     Default: Fals
-0004a100: 650a 2020 2020 2020 2020 3a70 6172 616d  e.        :param
-0004a110: 2074 7570 6c65 2869 6e74 2c20 696e 7429   tuple(int, int)
-0004a120: 2063 616e 7661 735f 7369 7a65 3a20 5468   canvas_size: Th
-0004a130: 6520 2877 6964 7468 2c20 6865 6967 6874  e (width, height
-0004a140: 2920 6f66 2074 6865 2053 5647 2063 616e  ) of the SVG can
-0004a150: 7661 732e 0a20 2020 2020 2020 2020 2020  vas..           
-0004a160: 2054 6869 7320 7769 6c6c 2063 6861 6e67   This will chang
-0004a170: 6520 7468 6520 5356 4720 7769 6474 6820  e the SVG width 
-0004a180: 616e 6420 6865 6967 6874 2077 6974 686f  and height witho
-0004a190: 7574 2072 6573 6361 6c69 6e67 2067 7261  ut rescaling gra
-0004a1a0: 7068 6963 616c 0a20 2020 2020 2020 2020  phical.         
-0004a1b0: 2020 2065 6c65 6d65 6e74 732c 2061 6c6c     elements, all
-0004a1c0: 6f77 696e 6720 6578 7472 6120 726f 6f6d  owing extra room
-0004a1d0: 2065 2e67 2e20 666f 7220 756e 7573 7561   e.g. for unusua
-0004a1e0: 6c6c 7920 6c6f 6e67 206c 6162 656c 732e  lly long labels.
-0004a1f0: 2049 6620 6060 4e6f 6e65 6060 0a20 2020   If ``None``.   
-0004a200: 2020 2020 2020 2020 2074 616b 6520 7468           take th
-0004a210: 6520 6361 6e76 6173 2073 697a 6520 746f  e canvas size to
-0004a220: 2062 6520 7468 6520 7361 6d65 2061 7320   be the same as 
-0004a230: 7468 6520 7461 7267 6574 2064 7261 7769  the target drawi
-0004a240: 6e67 2073 697a 6520 2873 6565 0a20 2020  ng size (see.   
-0004a250: 2020 2020 2020 2020 2060 6073 697a 6560           ``size`
-0004a260: 602c 2061 626f 7665 292e 2044 6566 6175  `, above). Defau
-0004a270: 6c74 3a20 4e6f 6e65 0a20 2020 2020 2020  lt: None.       
-0004a280: 203a 7061 7261 6d20 696e 7420 6d61 785f   :param int max_
-0004a290: 6e75 6d5f 7472 6565 733a 2054 6865 206d  num_trees: The m
-0004a2a0: 6178 696d 756d 206e 756d 6265 7220 6f66  aximum number of
-0004a2b0: 2074 7265 6573 2074 6f20 706c 6f74 2e20   trees to plot. 
-0004a2c0: 4966 2074 6865 7265 2061 7265 0a20 2020  If there are.   
-0004a2d0: 2020 2020 2020 2020 206d 6f72 6520 7472           more tr
-0004a2e0: 6565 7320 7468 616e 2074 6869 7320 696e  ees than this in
-0004a2f0: 2074 6865 2074 7265 6520 7365 7175 656e   the tree sequen
-0004a300: 6365 2c20 7468 6520 6d69 6464 6c65 2074  ce, the middle t
-0004a310: 7265 6573 2077 696c 6c20 6265 2073 6b69  rees will be ski
-0004a320: 7070 6564 0a20 2020 2020 2020 2020 2020  pped.           
-0004a330: 2066 726f 6d20 7468 6520 706c 6f74 2061   from the plot a
-0004a340: 6e64 2061 206d 6573 7361 6765 2022 5858  nd a message "XX
-0004a350: 2074 7265 6573 2073 6b69 7070 6564 2220   trees skipped" 
-0004a360: 6469 7370 6c61 7965 6420 696e 2074 6865  displayed in the
-0004a370: 6972 2070 6c61 6365 2e0a 2020 2020 2020  ir place..      
-0004a380: 2020 2020 2020 4966 2060 604e 6f6e 6560        If ``None`
-0004a390: 602c 2061 6c6c 2074 6865 2074 7265 6573  `, all the trees
-0004a3a0: 2077 696c 6c20 6265 2070 6c6f 7474 6564   will be plotted
-0004a3b0: 3a20 7468 6973 2063 616e 2070 726f 6475  : this can produ
-0004a3c0: 6365 2061 2076 6572 7920 7769 6465 0a20  ce a very wide. 
-0004a3d0: 2020 2020 2020 2020 2020 2070 6c6f 7420             plot 
-0004a3e0: 6966 2074 6865 7265 2061 7265 206d 616e  if there are man
-0004a3f0: 7920 7472 6565 7320 696e 2074 6865 2074  y trees in the t
-0004a400: 7265 6520 7365 7175 656e 6365 2e20 4465  ree sequence. De
-0004a410: 6661 756c 743a 204e 6f6e 650a 0a20 2020  fault: None..   
-0004a420: 2020 2020 203a 7265 7475 726e 3a20 416e       :return: An
-0004a430: 2053 5647 2072 6570 7265 7365 6e74 6174   SVG representat
-0004a440: 696f 6e20 6f66 2061 2074 7265 6520 7365  ion of a tree se
-0004a450: 7175 656e 6365 2e0a 2020 2020 2020 2020  quence..        
-0004a460: 3a72 7479 7065 3a20 5356 4753 7472 696e  :rtype: SVGStrin
-0004a470: 670a 0a20 2020 2020 2020 202e 2e20 6e6f  g..        .. no
-0004a480: 7465 3a3a 0a20 2020 2020 2020 2020 2020  te::.           
-0004a490: 2054 6563 686e 6963 616c 6c79 2c20 785f   Technically, x_
-0004a4a0: 6c69 6d5b 305d 2073 7065 6369 6669 6573  lim[0] specifies
-0004a4b0: 2061 202a 6d69 6e69 6d75 6d2a 2076 616c   a *minimum* val
-0004a4c0: 7565 2066 6f72 2074 6865 2073 7461 7274  ue for the start
-0004a4d0: 206f 6620 7468 6520 580a 2020 2020 2020   of the X.      
-0004a4e0: 2020 2020 2020 6178 6973 2c20 616e 6420        axis, and 
-0004a4f0: 785f 6c69 6d5b 315d 2073 7065 6369 6669  x_lim[1] specifi
-0004a500: 6573 2061 202a 6d61 7869 6d75 6d2a 2076  es a *maximum* v
-0004a510: 616c 7565 2066 6f72 2074 6865 2065 6e64  alue for the end
-0004a520: 2e20 5468 6973 2069 7320 6f6e 6c79 0a20  . This is only. 
-0004a530: 2020 2020 2020 2020 2020 2072 656c 6576             relev
-0004a540: 616e 7420 6966 2074 6865 2074 7265 6520  ant if the tree 
-0004a550: 7365 7175 656e 6365 2063 6f6e 7461 696e  sequence contain
-0004a560: 7320 2265 6d70 7479 2220 7265 6769 6f6e  s "empty" region
-0004a570: 7320 7769 7468 206e 6f20 6564 6765 7320  s with no edges 
-0004a580: 6f72 0a20 2020 2020 2020 2020 2020 206d  or.            m
-0004a590: 7574 6174 696f 6e73 2e20 496e 2074 6869  utations. In thi
-0004a5a0: 7320 6361 7365 2069 6620 785f 6c69 6d5b  s case if x_lim[
-0004a5b0: 305d 206c 6965 7320 7374 7269 6374 6c79  0] lies strictly
-0004a5c0: 2077 6974 6869 6e20 616e 2065 6d70 7479   within an empty
-0004a5d0: 2072 6567 696f 6e0a 2020 2020 2020 2020   region.        
-0004a5e0: 2020 2020 2869 2e65 2e2c 2060 6065 6d70      (i.e., ``emp
-0004a5f0: 7479 5f74 7265 652e 696e 7465 7276 616c  ty_tree.interval
-0004a600: 2e6c 6566 7420 3c20 785f 6c69 6d5b 305d  .left < x_lim[0]
-0004a610: 203c 2065 6d70 7479 5f74 7265 652e 696e   < empty_tree.in
-0004a620: 7465 7276 616c 2e72 6967 6874 6060 290a  terval.right``).
-0004a630: 2020 2020 2020 2020 2020 2020 7468 656e              then
-0004a640: 2074 6861 7420 7472 6565 2077 696c 6c20   that tree will 
-0004a650: 6e6f 7420 6265 2070 6c6f 7474 6564 206f  not be plotted o
-0004a660: 6e20 7468 6520 6c65 6674 2068 616e 6420  n the left hand 
-0004a670: 7369 6465 2c20 616e 6420 7468 6520 5820  side, and the X 
-0004a680: 6178 6973 0a20 2020 2020 2020 2020 2020  axis.           
-0004a690: 2077 696c 6c20 7374 6172 7420 6174 2060   will start at `
-0004a6a0: 6065 6d70 7479 5f74 7265 652e 696e 7465  `empty_tree.inte
-0004a6b0: 7276 616c 2e72 6967 6874 6060 2e20 5369  rval.right``. Si
-0004a6c0: 6d69 6c61 726c 792c 2069 6620 785f 6c69  milarly, if x_li
-0004a6d0: 6d5b 315d 206c 6965 730a 2020 2020 2020  m[1] lies.      
-0004a6e0: 2020 2020 2020 7374 7269 6374 6c79 2077        strictly w
-0004a6f0: 6974 6869 6e20 616e 2065 6d70 7479 2072  ithin an empty r
-0004a700: 6567 696f 6e20 7468 656e 2074 6861 7420  egion then that 
-0004a710: 7472 6565 2077 696c 6c20 6e6f 7420 6265  tree will not be
-0004a720: 2070 6c6f 7474 6564 206f 6e20 7468 650a   plotted on the.
-0004a730: 2020 2020 2020 2020 2020 2020 7269 6768              righ
-0004a740: 7420 6861 6e64 2073 6964 652c 2061 6e64  t hand side, and
-0004a750: 2074 6865 2058 2061 7869 7320 7769 6c6c   the X axis will
-0004a760: 2065 6e64 2061 7420 6060 656d 7074 795f   end at ``empty_
-0004a770: 7472 6565 2e69 6e74 6572 7661 6c2e 6c65  tree.interval.le
-0004a780: 6674 6060 0a20 2020 2020 2020 2022 2222  ft``.        """
-0004a790: 0a20 2020 2020 2020 2064 7261 7720 3d20  .        draw = 
-0004a7a0: 6472 6177 696e 672e 5376 6754 7265 6553  drawing.SvgTreeS
-0004a7b0: 6571 7565 6e63 6528 0a20 2020 2020 2020  equence(.       
-0004a7c0: 2020 2020 2073 656c 662c 0a20 2020 2020       self,.     
-0004a7d0: 2020 2020 2020 2073 697a 652c 0a20 2020         size,.   
-0004a7e0: 2020 2020 2020 2020 2078 5f73 6361 6c65           x_scale
-0004a7f0: 3d78 5f73 6361 6c65 2c0a 2020 2020 2020  =x_scale,.      
-0004a800: 2020 2020 2020 7469 6d65 5f73 6361 6c65        time_scale
-0004a810: 3d74 696d 655f 7363 616c 652c 0a20 2020  =time_scale,.   
-0004a820: 2020 2020 2020 2020 2074 7265 655f 6865           tree_he
-0004a830: 6967 6874 5f73 6361 6c65 3d74 7265 655f  ight_scale=tree_
-0004a840: 6865 6967 6874 5f73 6361 6c65 2c0a 2020  height_scale,.  
-0004a850: 2020 2020 2020 2020 2020 6e6f 6465 5f6c            node_l
-0004a860: 6162 656c 733d 6e6f 6465 5f6c 6162 656c  abels=node_label
-0004a870: 732c 0a20 2020 2020 2020 2020 2020 206d  s,.            m
-0004a880: 7574 6174 696f 6e5f 6c61 6265 6c73 3d6d  utation_labels=m
-0004a890: 7574 6174 696f 6e5f 6c61 6265 6c73 2c0a  utation_labels,.
-0004a8a0: 2020 2020 2020 2020 2020 2020 726f 6f74              root
-0004a8b0: 5f73 7667 5f61 7474 7269 6275 7465 733d  _svg_attributes=
-0004a8c0: 726f 6f74 5f73 7667 5f61 7474 7269 6275  root_svg_attribu
-0004a8d0: 7465 732c 0a20 2020 2020 2020 2020 2020  tes,.           
-0004a8e0: 2073 7479 6c65 3d73 7479 6c65 2c0a 2020   style=style,.  
-0004a8f0: 2020 2020 2020 2020 2020 6f72 6465 723d            order=
-0004a900: 6f72 6465 722c 0a20 2020 2020 2020 2020  order,.         
-0004a910: 2020 2066 6f72 6365 5f72 6f6f 745f 6272     force_root_br
-0004a920: 616e 6368 3d66 6f72 6365 5f72 6f6f 745f  anch=force_root_
-0004a930: 6272 616e 6368 2c0a 2020 2020 2020 2020  branch,.        
-0004a940: 2020 2020 7379 6d62 6f6c 5f73 697a 653d      symbol_size=
-0004a950: 7379 6d62 6f6c 5f73 697a 652c 0a20 2020  symbol_size,.   
-0004a960: 2020 2020 2020 2020 2078 5f61 7869 733d           x_axis=
-0004a970: 785f 6178 6973 2c0a 2020 2020 2020 2020  x_axis,.        
-0004a980: 2020 2020 785f 6c61 6265 6c3d 785f 6c61      x_label=x_la
-0004a990: 6265 6c2c 0a20 2020 2020 2020 2020 2020  bel,.           
-0004a9a0: 2078 5f6c 696d 3d78 5f6c 696d 2c0a 2020   x_lim=x_lim,.  
-0004a9b0: 2020 2020 2020 2020 2020 795f 6178 6973            y_axis
-0004a9c0: 3d79 5f61 7869 732c 0a20 2020 2020 2020  =y_axis,.       
-0004a9d0: 2020 2020 2079 5f6c 6162 656c 3d79 5f6c       y_label=y_l
-0004a9e0: 6162 656c 2c0a 2020 2020 2020 2020 2020  abel,.          
-0004a9f0: 2020 795f 7469 636b 733d 795f 7469 636b    y_ticks=y_tick
-0004aa00: 732c 0a20 2020 2020 2020 2020 2020 2079  s,.            y
-0004aa10: 5f67 7269 646c 696e 6573 3d79 5f67 7269  _gridlines=y_gri
-0004aa20: 646c 696e 6573 2c0a 2020 2020 2020 2020  dlines,.        
-0004aa30: 2020 2020 6f6d 6974 5f73 6974 6573 3d6f      omit_sites=o
-0004aa40: 6d69 745f 7369 7465 732c 0a20 2020 2020  mit_sites,.     
-0004aa50: 2020 2020 2020 2063 616e 7661 735f 7369         canvas_si
-0004aa60: 7a65 3d63 616e 7661 735f 7369 7a65 2c0a  ze=canvas_size,.
-0004aa70: 2020 2020 2020 2020 2020 2020 6d61 785f              max_
-0004aa80: 6e75 6d5f 7472 6565 733d 6d61 785f 6e75  num_trees=max_nu
-0004aa90: 6d5f 7472 6565 732c 0a20 2020 2020 2020  m_trees,.       
-0004aaa0: 2020 2020 202a 2a6b 7761 7267 732c 0a20       **kwargs,. 
-0004aab0: 2020 2020 2020 2029 0a20 2020 2020 2020         ).       
-0004aac0: 206f 7574 7075 7420 3d20 6472 6177 2e64   output = draw.d
-0004aad0: 7261 7769 6e67 2e74 6f73 7472 696e 6728  rawing.tostring(
-0004aae0: 290a 2020 2020 2020 2020 6966 2070 6174  ).        if pat
-0004aaf0: 6820 6973 206e 6f74 204e 6f6e 653a 0a20  h is not None:. 
-0004ab00: 2020 2020 2020 2020 2020 2023 2054 4f44             # TOD
-0004ab10: 4f20 7265 6d6f 7665 2074 6865 2027 7072  O remove the 'pr
-0004ab20: 6574 7479 2720 7768 656e 2077 6520 6172  etty' when we ar
-0004ab30: 6520 646f 6e65 2064 6562 7567 6769 6e67  e done debugging
-0004ab40: 2074 6869 732e 0a20 2020 2020 2020 2020   this..         
-0004ab50: 2020 2064 7261 772e 6472 6177 696e 672e     draw.drawing.
-0004ab60: 7361 7665 6173 2870 6174 682c 2070 7265  saveas(path, pre
-0004ab70: 7474 793d 5472 7565 290a 2020 2020 2020  tty=True).      
-0004ab80: 2020 7265 7475 726e 2064 7261 7769 6e67    return drawing
-0004ab90: 2e53 5647 5374 7269 6e67 286f 7574 7075  .SVGString(outpu
-0004aba0: 7429 0a0a 2020 2020 6465 6620 6472 6177  t)..    def draw
-0004abb0: 5f74 6578 7428 0a20 2020 2020 2020 2073  _text(.        s
-0004abc0: 656c 662c 0a20 2020 2020 2020 202a 2c0a  elf,.        *,.
-0004abd0: 2020 2020 2020 2020 6e6f 6465 5f6c 6162          node_lab
-0004abe0: 656c 733d 4e6f 6e65 2c0a 2020 2020 2020  els=None,.      
-0004abf0: 2020 7573 655f 6173 6369 693d 4661 6c73    use_ascii=Fals
-0004ac00: 652c 0a20 2020 2020 2020 2074 696d 655f  e,.        time_
-0004ac10: 6c61 6265 6c5f 666f 726d 6174 3d4e 6f6e  label_format=Non
-0004ac20: 652c 0a20 2020 2020 2020 2070 6f73 6974  e,.        posit
-0004ac30: 696f 6e5f 6c61 6265 6c5f 666f 726d 6174  ion_label_format
-0004ac40: 3d4e 6f6e 652c 0a20 2020 2020 2020 206f  =None,.        o
-0004ac50: 7264 6572 3d4e 6f6e 652c 0a20 2020 2020  rder=None,.     
-0004ac60: 2020 202a 2a6b 7761 7267 732c 0a20 2020     **kwargs,.   
-0004ac70: 2029 3a0a 2020 2020 2020 2020 2222 220a   ):.        """.
-0004ac80: 2020 2020 2020 2020 4372 6561 7465 2061          Create a
-0004ac90: 2074 6578 7420 7265 7072 6573 656e 7461   text representa
-0004aca0: 7469 6f6e 206f 6620 6120 7472 6565 2073  tion of a tree s
-0004acb0: 6571 7565 6e63 652e 0a0a 2020 2020 2020  equence...      
-0004acc0: 2020 3a70 6172 616d 2064 6963 7420 6e6f    :param dict no
-0004acd0: 6465 5f6c 6162 656c 733a 2049 6620 7370  de_labels: If sp
-0004ace0: 6563 6966 6965 642c 2073 686f 7720 6375  ecified, show cu
-0004acf0: 7374 6f6d 206c 6162 656c 7320 666f 7220  stom labels for 
-0004ad00: 7468 6520 6e6f 6465 730a 2020 2020 2020  the nodes.      
-0004ad10: 2020 2020 2020 7468 6174 2061 7265 2070        that are p
-0004ad20: 7265 7365 6e74 2069 6e20 7468 6520 6d61  resent in the ma
-0004ad30: 702e 2041 6e79 206e 6f64 6573 206e 6f74  p. Any nodes not
-0004ad40: 2073 7065 6369 6669 6564 2069 6e20 7468   specified in th
-0004ad50: 6520 6d61 7020 7769 6c6c 0a20 2020 2020  e map will.     
-0004ad60: 2020 2020 2020 206e 6f74 2068 6176 6520         not have 
-0004ad70: 6120 6e6f 6465 206c 6162 656c 2e0a 2020  a node label..  
-0004ad80: 2020 2020 2020 3a70 6172 616d 2062 6f6f        :param boo
-0004ad90: 6c20 7573 655f 6173 6369 693a 2049 6620  l use_ascii: If 
-0004ada0: 6060 4661 6c73 6560 6020 2864 6566 6175  ``False`` (defau
-0004adb0: 6c74 2920 7468 656e 2075 7365 2075 6e69  lt) then use uni
-0004adc0: 636f 6465 0a20 2020 2020 2020 2020 2020  code.           
-0004add0: 2060 626f 7820 6472 6177 696e 6720 6368   `box drawing ch
-0004ade0: 6172 6163 7465 7273 205c 0a3c 6874 7470  aracters \.<http
-0004adf0: 733a 2f2f 656e 2e77 696b 6970 6564 6961  s://en.wikipedia
-0004ae00: 2e6f 7267 2f77 696b 692f 426f 782d 6472  .org/wiki/Box-dr
-0004ae10: 6177 696e 675f 6368 6172 6163 7465 723e  awing_character>
-0004ae20: 605f 0a20 2020 2020 2020 2020 2020 2074  `_.            t
-0004ae30: 6f20 7265 6e64 6572 2074 6865 2074 7265  o render the tre
-0004ae40: 652e 2049 6620 6060 5472 7565 6060 2c20  e. If ``True``, 
-0004ae50: 7573 6520 706c 6169 6e20 6173 6369 6920  use plain ascii 
-0004ae60: 6368 6172 6163 7465 7273 2c20 7768 6963  characters, whic
-0004ae70: 6820 6c6f 6f6b 0a20 2020 2020 2020 2020  h look.         
-0004ae80: 2020 2063 7275 6465 7220 6275 7420 6172     cruder but ar
-0004ae90: 6520 6c65 7373 2073 7573 6365 7074 6962  e less susceptib
-0004aea0: 6c65 2074 6f20 6d69 7361 6c69 676e 6d65  le to misalignme
-0004aeb0: 6e74 206f 7220 666f 6e74 2073 7562 7374  nt or font subst
-0004aec0: 6974 7574 696f 6e2e 0a20 2020 2020 2020  itution..       
-0004aed0: 2020 2020 2041 6c74 6572 6e61 7469 7665       Alternative
-0004aee0: 6c79 2c20 6966 2079 6f75 2061 7265 2068  ly, if you are h
-0004aef0: 6176 696e 6720 616c 6967 6e6d 656e 7420  aving alignment 
-0004af00: 7072 6f62 6c65 6d73 2077 6974 6820 556e  problems with Un
-0004af10: 6963 6f64 652c 2079 6f75 2063 616e 2074  icode, you can t
-0004af20: 7279 0a20 2020 2020 2020 2020 2020 206f  ry.            o
-0004af30: 7574 2074 6865 2073 6f6c 7574 696f 6e20  ut the solution 
-0004af40: 646f 6375 6d65 6e74 6564 2060 6865 7265  documented `here
-0004af50: 205c 0a3c 6874 7470 733a 2f2f 6769 7468   \.<https://gith
-0004af60: 7562 2e63 6f6d 2f74 736b 6974 2d64 6576  ub.com/tskit-dev
-0004af70: 2f74 736b 6974 2f69 7373 7565 732f 3138  /tskit/issues/18
-0004af80: 3923 6973 7375 6563 6f6d 6d65 6e74 2d34  9#issuecomment-4
-0004af90: 3939 3131 3438 3131 3e60 5f2e 0a20 2020  99114811>`_..   
-0004afa0: 2020 2020 203a 7061 7261 6d20 7374 7220       :param str 
-0004afb0: 7469 6d65 5f6c 6162 656c 5f66 6f72 6d61  time_label_forma
-0004afc0: 743a 2041 2070 7974 686f 6e20 666f 726d  t: A python form
-0004afd0: 6174 2073 7472 696e 6720 7370 6563 6966  at string specif
-0004afe0: 7969 6e67 2074 6865 2066 6f72 6d61 7420  ying the format 
-0004aff0: 2865 2e67 2e0a 2020 2020 2020 2020 2020  (e.g..          
-0004b000: 2020 6e75 6d62 6572 206f 6620 6465 6369    number of deci
-0004b010: 6d61 6c20 706c 6163 6573 206f 7220 7369  mal places or si
-0004b020: 676e 6966 6963 616e 7420 6669 6775 7265  gnificant figure
-0004b030: 7329 2075 7365 6420 746f 2070 7269 6e74  s) used to print
-0004b040: 2074 6865 206e 756d 6572 6963 616c 0a20   the numerical. 
-0004b050: 2020 2020 2020 2020 2020 2074 696d 6520             time 
-0004b060: 7661 6c75 6573 206f 6e20 7468 6520 7469  values on the ti
-0004b070: 6d65 2061 7869 732e 2049 6620 6060 4e6f  me axis. If ``No
-0004b080: 6e65 6060 2c20 7468 6973 2064 6566 6175  ne``, this defau
-0004b090: 6c74 7320 746f 2060 6022 7b3a 2e32 667d  lts to ``"{:.2f}
-0004b0a0: 2260 602e 0a20 2020 2020 2020 203a 7061  "``..        :pa
-0004b0b0: 7261 6d20 7374 7220 706f 7369 7469 6f6e  ram str position
-0004b0c0: 5f6c 6162 656c 5f66 6f72 6d61 743a 2041  _label_format: A
-0004b0d0: 2070 7974 686f 6e20 666f 726d 6174 2073   python format s
-0004b0e0: 7472 696e 6720 7370 6563 6966 7969 6e67  tring specifying
-0004b0f0: 2074 6865 2066 6f72 6d61 740a 2020 2020   the format.    
-0004b100: 2020 2020 2020 2020 2865 2e67 2e20 6e75          (e.g. nu
-0004b110: 6d62 6572 206f 6620 6465 6369 6d61 6c20  mber of decimal 
-0004b120: 706c 6163 6573 206f 7220 7369 676e 6966  places or signif
-0004b130: 6963 616e 7420 6669 6775 7265 7329 2075  icant figures) u
-0004b140: 7365 6420 746f 2070 7269 6e74 2067 656e  sed to print gen
-0004b150: 6f6d 6963 0a20 2020 2020 2020 2020 2020  omic.           
-0004b160: 2070 6f73 6974 696f 6e73 2e20 4966 2060   positions. If `
-0004b170: 604e 6f6e 6560 602c 2074 6869 7320 6465  `None``, this de
-0004b180: 6661 756c 7473 2074 6f20 6060 227b 3a2e  faults to ``"{:.
-0004b190: 3266 7d22 6060 2e0a 2020 2020 2020 2020  2f}"``..        
-0004b1a0: 3a70 6172 616d 2073 7472 206f 7264 6572  :param str order
-0004b1b0: 3a20 5468 6520 6c65 6674 2d74 6f2d 7269  : The left-to-ri
-0004b1c0: 6768 7420 6f72 6465 7269 6e67 206f 6620  ght ordering of 
-0004b1d0: 6368 696c 6420 6e6f 6465 7320 696e 2074  child nodes in t
-0004b1e0: 6865 2064 7261 776e 2074 7265 652e 0a20  he drawn tree.. 
-0004b1f0: 2020 2020 2020 2020 2020 2054 6869 7320             This 
-0004b200: 6361 6e20 6265 2065 6974 6865 723a 2060  can be either: `
-0004b210: 6022 6d69 6e6c 6578 2260 602c 2077 6869  `"minlex"``, whi
-0004b220: 6368 206d 696e 696d 6973 6573 2074 6865  ch minimises the
-0004b230: 2064 6966 6665 7265 6e63 6573 0a20 2020   differences.   
-0004b240: 2020 2020 2020 2020 2062 6574 7765 656e           between
-0004b250: 2061 646a 6163 656e 7420 7472 6565 7320   adjacent trees 
-0004b260: 2873 6565 2061 6c73 6f20 7468 6520 6060  (see also the ``
-0004b270: 226d 696e 6c65 785f 706f 7374 6f72 6465  "minlex_postorde
-0004b280: 7222 6060 2074 7261 7665 7273 616c 0a20  r"`` traversal. 
-0004b290: 2020 2020 2020 2020 2020 206f 7264 6572             order
-0004b2a0: 2066 6f72 2074 6865 203a 6d65 7468 3a60   for the :meth:`
-0004b2b0: 2e54 7265 652e 6e6f 6465 7360 206d 6574  .Tree.nodes` met
-0004b2c0: 686f 6429 3b20 6f72 2060 6022 7472 6565  hod); or ``"tree
-0004b2d0: 2260 6020 7768 6963 6820 6472 6177 7320  "`` which draws 
-0004b2e0: 7472 6565 730a 2020 2020 2020 2020 2020  trees.          
-0004b2f0: 2020 696e 2074 6865 206c 6566 742d 746f    in the left-to
-0004b300: 2d72 6967 6874 206f 7264 6572 2064 6566  -right order def
-0004b310: 696e 6564 2062 7920 7468 650a 2020 2020  ined by the.    
-0004b320: 2020 2020 2020 2020 3a72 6566 3a60 7175          :ref:`qu
-0004b330: 696e 7475 706c 7920 6c69 6e6b 6564 2074  intuply linked t
-0004b340: 7265 6520 7374 7275 6374 7572 6520 3c73  ree structure <s
-0004b350: 6563 5f64 6174 615f 6d6f 6465 6c5f 7472  ec_data_model_tr
-0004b360: 6565 5f73 7472 7563 7475 7265 3e60 2e0a  ee_structure>`..
-0004b370: 2020 2020 2020 2020 2020 2020 4966 206e              If n
-0004b380: 6f74 2073 7065 6369 6669 6564 206f 7220  ot specified or 
-0004b390: 4e6f 6e65 2c20 7468 6973 2064 6566 6175  None, this defau
-0004b3a0: 6c74 7320 746f 2060 6022 6d69 6e6c 6578  lts to ``"minlex
-0004b3b0: 2260 602e 0a0a 2020 2020 2020 2020 3a72  "``...        :r
-0004b3c0: 6574 7572 6e3a 2041 2074 6578 7420 7265  eturn: A text re
-0004b3d0: 7072 6573 656e 7461 7469 6f6e 206f 6620  presentation of 
-0004b3e0: 6120 7472 6565 2073 6571 7565 6e63 652e  a tree sequence.
-0004b3f0: 0a20 2020 2020 2020 203a 7274 7970 653a  .        :rtype:
-0004b400: 2073 7472 0a20 2020 2020 2020 2022 2222   str.        """
-0004b410: 0a20 2020 2020 2020 2072 6574 7572 6e20  .        return 
-0004b420: 7374 7228 0a20 2020 2020 2020 2020 2020  str(.           
-0004b430: 2064 7261 7769 6e67 2e54 6578 7454 7265   drawing.TextTre
-0004b440: 6553 6571 7565 6e63 6528 0a20 2020 2020  eSequence(.     
-0004b450: 2020 2020 2020 2020 2020 2073 656c 662c             self,
-0004b460: 0a20 2020 2020 2020 2020 2020 2020 2020  .               
-0004b470: 206e 6f64 655f 6c61 6265 6c73 3d6e 6f64   node_labels=nod
-0004b480: 655f 6c61 6265 6c73 2c0a 2020 2020 2020  e_labels,.      
-0004b490: 2020 2020 2020 2020 2020 7573 655f 6173            use_as
-0004b4a0: 6369 693d 7573 655f 6173 6369 692c 0a20  cii=use_ascii,. 
-0004b4b0: 2020 2020 2020 2020 2020 2020 2020 2074                 t
-0004b4c0: 696d 655f 6c61 6265 6c5f 666f 726d 6174  ime_label_format
-0004b4d0: 3d74 696d 655f 6c61 6265 6c5f 666f 726d  =time_label_form
-0004b4e0: 6174 2c0a 2020 2020 2020 2020 2020 2020  at,.            
-0004b4f0: 2020 2020 706f 7369 7469 6f6e 5f6c 6162      position_lab
-0004b500: 656c 5f66 6f72 6d61 743d 706f 7369 7469  el_format=positi
-0004b510: 6f6e 5f6c 6162 656c 5f66 6f72 6d61 742c  on_label_format,
-0004b520: 0a20 2020 2020 2020 2020 2020 2020 2020  .               
-0004b530: 206f 7264 6572 3d6f 7264 6572 2c0a 2020   order=order,.  
-0004b540: 2020 2020 2020 2020 2020 290a 2020 2020            ).    
-0004b550: 2020 2020 290a 0a20 2020 2023 2323 2323      )..    #####
-0004b560: 2323 2323 2323 2323 2323 2323 2323 2323  ################
-0004b570: 2323 2323 2323 2323 2323 2323 2323 2323  ################
-0004b580: 2323 2323 2323 230a 2020 2020 230a 2020  #######.    #.  
-0004b590: 2020 2320 5374 6174 6973 7469 6373 2063    # Statistics c
-0004b5a0: 6f6d 7075 7461 7469 6f6e 0a20 2020 2023  omputation.    #
-0004b5b0: 0a20 2020 2023 2323 2323 2323 2323 2323  .    ###########
-0004b5c0: 2323 2323 2323 2323 2323 2323 2323 2323  ################
-0004b5d0: 2323 2323 2323 2323 2323 2323 2323 2323  ################
-0004b5e0: 230a 0a20 2020 2064 6566 2067 656e 6572  #..    def gener
-0004b5f0: 616c 5f73 7461 7428 0a20 2020 2020 2020  al_stat(.       
-0004b600: 2073 656c 662c 0a20 2020 2020 2020 2057   self,.        W
-0004b610: 2c0a 2020 2020 2020 2020 662c 0a20 2020  ,.        f,.   
-0004b620: 2020 2020 206f 7574 7075 745f 6469 6d2c       output_dim,
-0004b630: 0a20 2020 2020 2020 2077 696e 646f 7773  .        windows
-0004b640: 3d4e 6f6e 652c 0a20 2020 2020 2020 2070  =None,.        p
-0004b650: 6f6c 6172 6973 6564 3d46 616c 7365 2c0a  olarised=False,.
-0004b660: 2020 2020 2020 2020 6d6f 6465 3d4e 6f6e          mode=Non
-0004b670: 652c 0a20 2020 2020 2020 2073 7061 6e5f  e,.        span_
-0004b680: 6e6f 726d 616c 6973 653d 5472 7565 2c0a  normalise=True,.
-0004b690: 2020 2020 2020 2020 7374 7269 6374 3d54          strict=T
-0004b6a0: 7275 652c 0a20 2020 2029 3a0a 2020 2020  rue,.    ):.    
-0004b6b0: 2020 2020 2222 220a 2020 2020 2020 2020      """.        
-0004b6c0: 436f 6d70 7574 6520 6120 7769 6e64 6f77  Compute a window
-0004b6d0: 6564 2073 7461 7469 7374 6963 2066 726f  ed statistic fro
-0004b6e0: 6d20 7765 6967 6874 7320 616e 6420 6120  m weights and a 
-0004b6f0: 7375 6d6d 6172 7920 6675 6e63 7469 6f6e  summary function
-0004b700: 2e0a 2020 2020 2020 2020 5365 6520 7468  ..        See th
-0004b710: 6520 3a72 6566 3a60 7374 6174 6973 7469  e :ref:`statisti
-0004b720: 6373 2069 6e74 6572 6661 6365 203c 7365  cs interface <se
-0004b730: 635f 7374 6174 735f 696e 7465 7266 6163  c_stats_interfac
-0004b740: 653e 6020 7365 6374 696f 6e20 666f 7220  e>` section for 
-0004b750: 6465 7461 696c 7320 6f6e 0a20 2020 2020  details on.     
-0004b760: 2020 203a 7265 663a 6077 696e 646f 7773     :ref:`windows
-0004b770: 203c 7365 635f 7374 6174 735f 7769 6e64   <sec_stats_wind
-0004b780: 6f77 733e 602c 0a20 2020 2020 2020 203a  ows>`,.        :
-0004b790: 7265 663a 606d 6f64 6520 3c73 6563 5f73  ref:`mode <sec_s
-0004b7a0: 7461 7473 5f6d 6f64 653e 602c 0a20 2020  tats_mode>`,.   
-0004b7b0: 2020 2020 203a 7265 663a 6073 7061 6e20       :ref:`span 
-0004b7c0: 6e6f 726d 616c 6973 6520 3c73 6563 5f73  normalise <sec_s
-0004b7d0: 7461 7473 5f73 7061 6e5f 6e6f 726d 616c  tats_span_normal
-0004b7e0: 6973 653e 602c 0a20 2020 2020 2020 2061  ise>`,.        a
-0004b7f0: 6e64 203a 7265 663a 6072 6574 7572 6e20  nd :ref:`return 
-0004b800: 7661 6c75 6520 3c73 6563 5f73 7461 7473  value <sec_stats
-0004b810: 5f6f 7574 7075 745f 666f 726d 6174 3e60  _output_format>`
-0004b820: 2e0a 2020 2020 2020 2020 4f6e 2065 6163  ..        On eac
-0004b830: 6820 7472 6565 2c20 7468 6973 0a20 2020  h tree, this.   
-0004b840: 2020 2020 2070 726f 7061 6761 7465 7320       propagates 
-0004b850: 7468 6520 7765 6967 6874 7320 6060 5760  the weights ``W`
-0004b860: 6020 7570 2074 6865 2074 7265 652c 2073  ` up the tree, s
-0004b870: 6f20 7468 6174 2074 6865 2022 7765 6967  o that the "weig
-0004b880: 6874 2220 6f66 2065 6163 680a 2020 2020  ht" of each.    
-0004b890: 2020 2020 6e6f 6465 2069 7320 7468 6520      node is the 
-0004b8a0: 7375 6d20 6f66 2074 6865 2077 6569 6768  sum of the weigh
-0004b8b0: 7473 206f 6620 616c 6c20 7361 6d70 6c65  ts of all sample
-0004b8c0: 7320 6174 206f 7220 6265 6c6f 7720 7468  s at or below th
-0004b8d0: 6520 6e6f 6465 2e0a 2020 2020 2020 2020  e node..        
-0004b8e0: 5468 656e 2074 6865 2073 756d 6d61 7279  Then the summary
-0004b8f0: 2066 756e 6374 696f 6e20 6060 6660 6020   function ``f`` 
-0004b900: 6973 2061 7070 6c69 6564 2074 6f20 7468  is applied to th
-0004b910: 6520 7765 6967 6874 732c 2067 6976 696e  e weights, givin
-0004b920: 6720 610a 2020 2020 2020 2020 7375 6d6d  g a.        summ
-0004b930: 6172 7920 666f 7220 6561 6368 206e 6f64  ary for each nod
-0004b940: 6520 696e 2065 6163 6820 7472 6565 2e20  e in each tree. 
-0004b950: 486f 7720 7468 6973 2069 7320 7468 656e  How this is then
-0004b960: 2061 6767 7265 6761 7465 6420 6465 7065   aggregated depe
-0004b970: 6e64 730a 2020 2020 2020 2020 6f6e 2060  nds.        on `
-0004b980: 606d 6f64 6560 603a 0a0a 2020 2020 2020  `mode``:..      
-0004b990: 2020 2273 6974 6522 0a20 2020 2020 2020    "site".       
-0004b9a0: 2020 2020 2041 6464 7320 746f 6765 7468       Adds togeth
-0004b9b0: 6572 2074 6865 2074 6f74 616c 2073 756d  er the total sum
-0004b9c0: 6d61 7279 2076 616c 7565 2061 6372 6f73  mary value acros
-0004b9d0: 7320 616c 6c20 616c 6c65 6c65 7320 696e  s all alleles in
-0004b9e0: 2065 6163 6820 7769 6e64 6f77 2e0a 0a20   each window... 
-0004b9f0: 2020 2020 2020 2022 6272 616e 6368 220a         "branch".
-0004ba00: 2020 2020 2020 2020 2020 2020 4164 6473              Adds
-0004ba10: 2074 6f67 6574 6865 7220 7468 6520 7375   together the su
-0004ba20: 6d6d 6172 7920 7661 6c75 6520 666f 7220  mmary value for 
-0004ba30: 6561 6368 206e 6f64 652c 206d 756c 7469  each node, multi
-0004ba40: 706c 6965 6420 6279 2074 6865 0a20 2020  plied by the.   
-0004ba50: 2020 2020 2020 2020 206c 656e 6774 6820           length 
-0004ba60: 6f66 2074 6865 2062 7261 6e63 6820 6162  of the branch ab
-0004ba70: 6f76 6520 7468 6520 6e6f 6465 2061 6e64  ove the node and
-0004ba80: 2074 6865 2073 7061 6e20 6f66 2074 6865   the span of the
-0004ba90: 2074 7265 652e 0a0a 2020 2020 2020 2020   tree...        
-0004baa0: 226e 6f64 6522 0a20 2020 2020 2020 2020  "node".         
-0004bab0: 2020 2052 6574 7572 6e73 2065 6163 6820     Returns each 
-0004bac0: 6e6f 6465 2773 2073 756d 6d61 7279 2076  node's summary v
-0004bad0: 616c 7565 2061 6464 6564 2061 6372 6f73  alue added acros
-0004bae0: 7320 7472 6565 7320 616e 6420 6d75 6c74  s trees and mult
-0004baf0: 6970 6c69 6564 0a20 2020 2020 2020 2020  iplied.         
-0004bb00: 2020 2062 7920 7468 6520 7370 616e 206f     by the span o
-0004bb10: 6620 7468 6520 7472 6565 2e0a 0a20 2020  f the tree...   
-0004bb20: 2020 2020 2042 6f74 6820 7468 6520 7765       Both the we
-0004bb30: 6967 6874 7320 616e 6420 7468 6520 7375  ights and the su
-0004bb40: 6d6d 6172 7920 6361 6e20 6265 206d 756c  mmary can be mul
-0004bb50: 7469 6469 6d65 6e73 696f 6e61 6c3a 2069  tidimensional: i
-0004bb60: 6620 6060 5760 6020 6861 7320 6060 6b60  f ``W`` has ``k`
-0004bb70: 600a 2020 2020 2020 2020 636f 6c75 6d6e  `.        column
-0004bb80: 732c 2061 6e64 2060 6066 6060 2074 616b  s, and ``f`` tak
-0004bb90: 6573 2061 2060 606b 6060 2d76 6563 746f  es a ``k``-vecto
-0004bba0: 7220 616e 6420 7265 7475 726e 7320 616e  r and returns an
-0004bbb0: 2060 606d 6060 2d76 6563 746f 722c 0a20   ``m``-vector,. 
-0004bbc0: 2020 2020 2020 2074 6865 6e20 7468 6520         then the 
-0004bbd0: 6f75 7470 7574 2077 696c 6c20 6265 2060  output will be `
-0004bbe0: 606d 6060 2d64 696d 656e 7369 6f6e 616c  `m``-dimensional
-0004bbf0: 2066 6f72 2065 6163 6820 6e6f 6465 206f   for each node o
-0004bc00: 7220 7769 6e64 6f77 2028 6465 7065 6e64  r window (depend
-0004bc10: 696e 670a 2020 2020 2020 2020 6f6e 2022  ing.        on "
-0004bc20: 6d6f 6465 2229 2e0a 0a20 2020 2020 2020  mode")...       
-0004bc30: 202e 2e20 6e6f 7465 3a3a 0a20 2020 2020   .. note::.     
-0004bc40: 2020 2020 2020 2054 6865 2073 756d 6d61         The summa
-0004bc50: 7279 2066 756e 6374 696f 6e20 6060 6660  ry function ``f`
-0004bc60: 6020 7368 6f75 6c64 2072 6574 7572 6e20  ` should return 
-0004bc70: 7a65 726f 2077 6865 6e20 6769 7665 6e20  zero when given 
-0004bc80: 626f 7468 2030 2061 6e64 0a20 2020 2020  both 0 and.     
-0004bc90: 2020 2020 2020 2074 6865 2074 6f74 616c         the total
-0004bca0: 2077 6569 6768 7420 2869 2e65 2e2c 2060   weight (i.e., `
-0004bcb0: 6066 2830 2920 3d20 3060 6020 616e 6420  `f(0) = 0`` and 
-0004bcc0: 6060 6628 6e70 2e73 756d 2857 2c20 6178  ``f(np.sum(W, ax
-0004bcd0: 6973 3d30 2929 203d 2030 6060 292c 0a20  is=0)) = 0``),. 
-0004bce0: 2020 2020 2020 2020 2020 2075 6e6c 6573             unles
-0004bcf0: 7320 6060 7374 7269 6374 3d46 616c 7365  s ``strict=False
-0004bd00: 6060 2e20 2054 6869 7320 6973 206e 6563  ``.  This is nec
-0004bd10: 6573 7361 7279 2066 6f72 2074 6865 2073  essary for the s
-0004bd20: 7461 7469 7374 6963 2074 6f20 6265 0a20  tatistic to be. 
-0004bd30: 2020 2020 2020 2020 2020 2075 6e61 6666             unaff
-0004bd40: 6563 7465 6420 6279 2070 6172 7473 206f  ected by parts o
-0004bd50: 6620 7468 6520 7472 6565 2073 6571 7565  f the tree seque
-0004bd60: 6e63 6520 616e 6365 7374 7261 6c20 746f  nce ancestral to
-0004bd70: 206e 6f6e 6520 6f72 2061 6c6c 0a20 2020   none or all.   
-0004bd80: 2020 2020 2020 2020 206f 6620 7468 6520           of the 
-0004bd90: 7361 6d70 6c65 732c 2072 6573 7065 6374  samples, respect
-0004bda0: 6976 656c 792e 0a0a 2020 2020 2020 2020  ively...        
-0004bdb0: 3a70 6172 616d 206e 756d 7079 2e6e 6461  :param numpy.nda
-0004bdc0: 7272 6179 2057 3a20 416e 2061 7272 6179  rray W: An array
-0004bdd0: 206f 6620 7661 6c75 6573 2077 6974 6820   of values with 
-0004bde0: 6f6e 6520 726f 7720 666f 7220 6561 6368  one row for each
-0004bdf0: 2073 616d 706c 6520 616e 6420 6f6e 650a   sample and one.
-0004be00: 2020 2020 2020 2020 2020 2020 636f 6c75              colu
-0004be10: 6d6e 2066 6f72 2065 6163 6820 7765 6967  mn for each weig
-0004be20: 6874 2e0a 2020 2020 2020 2020 3a70 6172  ht..        :par
-0004be30: 616d 2066 3a20 4120 6675 6e63 7469 6f6e  am f: A function
-0004be40: 2074 6861 7420 7461 6b65 7320 6120 6f6e   that takes a on
-0004be50: 652d 6469 6d65 6e73 696f 6e61 6c20 6172  e-dimensional ar
-0004be60: 7261 7920 6f66 206c 656e 6774 680a 2020  ray of length.  
-0004be70: 2020 2020 2020 2020 2020 6571 7561 6c20            equal 
-0004be80: 746f 2074 6865 206e 756d 6265 7220 6f66  to the number of
-0004be90: 2063 6f6c 756d 6e73 206f 6620 6060 5760   columns of ``W`
-0004bea0: 6020 616e 6420 7265 7475 726e 7320 6120  ` and returns a 
-0004beb0: 6f6e 652d 6469 6d65 6e73 696f 6e61 6c0a  one-dimensional.
-0004bec0: 2020 2020 2020 2020 2020 2020 6172 7261              arra
-0004bed0: 792e 0a20 2020 2020 2020 203a 7061 7261  y..        :para
-0004bee0: 6d20 696e 7420 6f75 7470 7574 5f64 696d  m int output_dim
-0004bef0: 3a20 5468 6520 6c65 6e67 7468 206f 6620  : The length of 
-0004bf00: 6060 6660 6027 7320 7265 7475 726e 2076  ``f``'s return v
-0004bf10: 616c 7565 2e0a 2020 2020 2020 2020 3a70  alue..        :p
-0004bf20: 6172 616d 206c 6973 7420 7769 6e64 6f77  aram list window
-0004bf30: 733a 2041 6e20 696e 6372 6561 7369 6e67  s: An increasing
-0004bf40: 206c 6973 7420 6f66 2062 7265 616b 706f   list of breakpo
-0004bf50: 696e 7473 2062 6574 7765 656e 2074 6865  ints between the
-0004bf60: 2077 696e 646f 7773 0a20 2020 2020 2020   windows.       
-0004bf70: 2020 2020 2074 6f20 636f 6d70 7574 6520       to compute 
-0004bf80: 7468 6520 7374 6174 6973 7469 6320 696e  the statistic in
-0004bf90: 2e0a 2020 2020 2020 2020 3a70 6172 616d  ..        :param
-0004bfa0: 2062 6f6f 6c20 706f 6c61 7269 7365 643a   bool polarised:
-0004bfb0: 2057 6865 7468 6572 2074 6f20 6c65 6176   Whether to leav
-0004bfc0: 6520 7468 6520 616e 6365 7374 7261 6c20  e the ancestral 
-0004bfd0: 7374 6174 6520 6f75 7420 6f66 2063 6f6d  state out of com
-0004bfe0: 7075 7461 7469 6f6e 733a 0a20 2020 2020  putations:.     
-0004bff0: 2020 2020 2020 2073 6565 203a 7265 663a         see :ref:
-0004c000: 6073 6563 5f73 7461 7473 6020 666f 7220  `sec_stats` for 
-0004c010: 6d6f 7265 2064 6574 6169 6c73 2e0a 2020  more details..  
-0004c020: 2020 2020 2020 3a70 6172 616d 2073 7472        :param str
-0004c030: 206d 6f64 653a 2041 2073 7472 696e 6720   mode: A string 
-0004c040: 6769 7669 6e67 2074 6865 2022 7479 7065  giving the "type
-0004c050: 2220 6f66 2074 6865 2073 7461 7469 7374  " of the statist
-0004c060: 6963 2074 6f20 6265 2063 6f6d 7075 7465  ic to be compute
-0004c070: 640a 2020 2020 2020 2020 2020 2020 2864  d.            (d
-0004c080: 6566 6175 6c74 7320 746f 2022 7369 7465  efaults to "site
-0004c090: 2229 2e0a 2020 2020 2020 2020 3a70 6172  ")..        :par
-0004c0a0: 616d 2062 6f6f 6c20 7370 616e 5f6e 6f72  am bool span_nor
-0004c0b0: 6d61 6c69 7365 3a20 5768 6574 6865 7220  malise: Whether 
-0004c0c0: 746f 2064 6976 6964 6520 7468 6520 7265  to divide the re
-0004c0d0: 7375 6c74 2062 7920 7468 6520 7370 616e  sult by the span
-0004c0e0: 206f 6620 7468 650a 2020 2020 2020 2020   of the.        
-0004c0f0: 2020 2020 7769 6e64 6f77 2028 6465 6661      window (defa
-0004c100: 756c 7473 2074 6f20 5472 7565 292e 0a20  ults to True).. 
-0004c110: 2020 2020 2020 203a 7061 7261 6d20 626f         :param bo
-0004c120: 6f6c 2073 7472 6963 743a 2057 6865 7468  ol strict: Wheth
-0004c130: 6572 2074 6f20 6368 6563 6b20 7468 6174  er to check that
-0004c140: 2066 2830 2920 616e 6420 6628 746f 7461   f(0) and f(tota
-0004c150: 6c20 7765 6967 6874 2920 6172 6520 7a65  l weight) are ze
-0004c160: 726f 2e0a 2020 2020 2020 2020 3a72 6574  ro..        :ret
-0004c170: 7572 6e3a 2041 206e 6461 7272 6179 2077  urn: A ndarray w
-0004c180: 6974 6820 7368 6170 6520 6571 7561 6c20  ith shape equal 
-0004c190: 746f 2028 6e75 6d20 7769 6e64 6f77 732c  to (num windows,
-0004c1a0: 206e 756d 2073 7461 7469 7374 6963 7329   num statistics)
-0004c1b0: 2e0a 2020 2020 2020 2020 2222 220a 2020  ..        """.  
-0004c1c0: 2020 2020 2020 6966 206d 6f64 6520 6973        if mode is
-0004c1d0: 204e 6f6e 653a 0a20 2020 2020 2020 2020   None:.         
-0004c1e0: 2020 206d 6f64 6520 3d20 2273 6974 6522     mode = "site"
-0004c1f0: 0a20 2020 2020 2020 2069 6620 7374 7269  .        if stri
-0004c200: 6374 3a0a 2020 2020 2020 2020 2020 2020  ct:.            
-0004c210: 746f 7461 6c5f 7765 6967 6874 7320 3d20  total_weights = 
-0004c220: 6e70 2e73 756d 2857 2c20 6178 6973 3d30  np.sum(W, axis=0
-0004c230: 290a 2020 2020 2020 2020 2020 2020 666f  ).            fo
-0004c240: 7220 7820 696e 205b 746f 7461 6c5f 7765  r x in [total_we
-0004c250: 6967 6874 732c 2074 6f74 616c 5f77 6569  ights, total_wei
-0004c260: 6768 7473 202a 2030 2e30 5d3a 0a20 2020  ghts * 0.0]:.   
-0004c270: 2020 2020 2020 2020 2020 2020 2077 6974               wit
-0004c280: 6820 6e70 2e65 7272 7374 6174 6528 696e  h np.errstate(in
-0004c290: 7661 6c69 643d 2269 676e 6f72 6522 2c20  valid="ignore", 
-0004c2a0: 6469 7669 6465 3d22 6967 6e6f 7265 2229  divide="ignore")
-0004c2b0: 3a0a 2020 2020 2020 2020 2020 2020 2020  :.              
-0004c2c0: 2020 2020 2020 6678 203d 206e 702e 6172        fx = np.ar
-0004c2d0: 7261 7928 6628 7829 290a 2020 2020 2020  ray(f(x)).      
-0004c2e0: 2020 2020 2020 2020 2020 6678 5b6e 702e            fx[np.
-0004c2f0: 6973 6e61 6e28 6678 295d 203d 2030 2e30  isnan(fx)] = 0.0
-0004c300: 0a20 2020 2020 2020 2020 2020 2020 2020  .               
-0004c310: 2069 6620 6e6f 7420 6e70 2e61 6c6c 636c   if not np.allcl
-0004c320: 6f73 6528 6678 2c20 6e70 2e7a 6572 6f73  ose(fx, np.zeros
-0004c330: 2828 6f75 7470 7574 5f64 696d 2c29 2929  ((output_dim,)))
-0004c340: 3a0a 2020 2020 2020 2020 2020 2020 2020  :.              
-0004c350: 2020 2020 2020 7261 6973 6520 5661 6c75        raise Valu
-0004c360: 6545 7272 6f72 280a 2020 2020 2020 2020  eError(.        
-0004c370: 2020 2020 2020 2020 2020 2020 2020 2020                  
-0004c380: 2253 756d 6d61 7279 2066 756e 6374 696f  "Summary functio
-0004c390: 6e20 646f 6573 206e 6f74 2072 6574 7572  n does not retur
-0004c3a0: 6e20 7a65 726f 2066 6f72 2062 6f74 6820  n zero for both 
-0004c3b0: 220a 2020 2020 2020 2020 2020 2020 2020  ".              
-0004c3c0: 2020 2020 2020 2020 2020 227a 6572 6f20            "zero 
-0004c3d0: 7765 6967 6874 2061 6e64 2074 6f74 616c  weight and total
-0004c3e0: 2077 6569 6768 742e 220a 2020 2020 2020   weight.".      
-0004c3f0: 2020 2020 2020 2020 2020 2020 2020 290a                ).
-0004c400: 2020 2020 2020 2020 7265 7475 726e 2073          return s
-0004c410: 656c 662e 5f5f 7275 6e5f 7769 6e64 6f77  elf.__run_window
-0004c420: 6564 5f73 7461 7428 0a20 2020 2020 2020  ed_stat(.       
-0004c430: 2020 2020 2077 696e 646f 7773 2c0a 2020       windows,.  
-0004c440: 2020 2020 2020 2020 2020 7365 6c66 2e6c            self.l
-0004c450: 6c5f 7472 6565 5f73 6571 7565 6e63 652e  l_tree_sequence.
-0004c460: 6765 6e65 7261 6c5f 7374 6174 2c0a 2020  general_stat,.  
-0004c470: 2020 2020 2020 2020 2020 572c 0a20 2020            W,.   
-0004c480: 2020 2020 2020 2020 2066 2c0a 2020 2020           f,.    
-0004c490: 2020 2020 2020 2020 6f75 7470 7574 5f64          output_d
-0004c4a0: 696d 2c0a 2020 2020 2020 2020 2020 2020  im,.            
-0004c4b0: 706f 6c61 7269 7365 643d 706f 6c61 7269  polarised=polari
-0004c4c0: 7365 642c 0a20 2020 2020 2020 2020 2020  sed,.           
-0004c4d0: 2073 7061 6e5f 6e6f 726d 616c 6973 653d   span_normalise=
-0004c4e0: 7370 616e 5f6e 6f72 6d61 6c69 7365 2c0a  span_normalise,.
-0004c4f0: 2020 2020 2020 2020 2020 2020 6d6f 6465              mode
-0004c500: 3d6d 6f64 652c 0a20 2020 2020 2020 2029  =mode,.        )
-0004c510: 0a0a 2020 2020 6465 6620 7361 6d70 6c65  ..    def sample
-0004c520: 5f63 6f75 6e74 5f73 7461 7428 0a20 2020  _count_stat(.   
-0004c530: 2020 2020 2073 656c 662c 0a20 2020 2020       self,.     
-0004c540: 2020 2073 616d 706c 655f 7365 7473 2c0a     sample_sets,.
-0004c550: 2020 2020 2020 2020 662c 0a20 2020 2020          f,.     
-0004c560: 2020 206f 7574 7075 745f 6469 6d2c 0a20     output_dim,. 
-0004c570: 2020 2020 2020 2077 696e 646f 7773 3d4e         windows=N
-0004c580: 6f6e 652c 0a20 2020 2020 2020 2070 6f6c  one,.        pol
-0004c590: 6172 6973 6564 3d46 616c 7365 2c0a 2020  arised=False,.  
-0004c5a0: 2020 2020 2020 6d6f 6465 3d4e 6f6e 652c        mode=None,
-0004c5b0: 0a20 2020 2020 2020 2073 7061 6e5f 6e6f  .        span_no
-0004c5c0: 726d 616c 6973 653d 5472 7565 2c0a 2020  rmalise=True,.  
-0004c5d0: 2020 2020 2020 7374 7269 6374 3d54 7275        strict=Tru
-0004c5e0: 652c 0a20 2020 2029 3a0a 2020 2020 2020  e,.    ):.      
-0004c5f0: 2020 2222 220a 2020 2020 2020 2020 436f    """.        Co
-0004c600: 6d70 7574 6520 6120 7769 6e64 6f77 6564  mpute a windowed
-0004c610: 2073 7461 7469 7374 6963 2066 726f 6d20   statistic from 
-0004c620: 7361 6d70 6c65 2063 6f75 6e74 7320 616e  sample counts an
-0004c630: 6420 6120 7375 6d6d 6172 7920 6675 6e63  d a summary func
-0004c640: 7469 6f6e 2e0a 2020 2020 2020 2020 5468  tion..        Th
-0004c650: 6973 2069 7320 6120 7772 6170 7065 7220  is is a wrapper 
-0004c660: 6172 6f75 6e64 203a 6d65 7468 3a60 2e67  around :meth:`.g
-0004c670: 656e 6572 616c 5f73 7461 7460 2066 6f72  eneral_stat` for
-0004c680: 2074 6865 2063 6f6d 6d6f 6e20 6361 7365   the common case
-0004c690: 2069 6e0a 2020 2020 2020 2020 7768 6963   in.        whic
-0004c6a0: 6820 7468 6520 7765 6967 6874 7320 6172  h the weights ar
-0004c6b0: 6520 616c 6c20 6569 7468 6572 2031 206f  e all either 1 o
-0004c6c0: 7220 302c 2069 2e65 2e2c 2066 756e 6374  r 0, i.e., funct
-0004c6d0: 696f 6e73 206f 6620 7468 6520 6a6f 696e  ions of the join
-0004c6e0: 740a 2020 2020 2020 2020 616c 6c65 6c65  t.        allele
-0004c6f0: 2066 7265 7175 656e 6379 2073 7065 6374   frequency spect
-0004c700: 7275 6d2e 0a20 2020 2020 2020 2053 6565  rum..        See
-0004c710: 2074 6865 203a 7265 663a 6073 7461 7469   the :ref:`stati
-0004c720: 7374 6963 7320 696e 7465 7266 6163 6520  stics interface 
-0004c730: 3c73 6563 5f73 7461 7473 5f69 6e74 6572  <sec_stats_inter
-0004c740: 6661 6365 3e60 2073 6563 7469 6f6e 2066  face>` section f
-0004c750: 6f72 2064 6574 6169 6c73 206f 6e0a 2020  or details on.  
-0004c760: 2020 2020 2020 3a72 6566 3a60 7361 6d70        :ref:`samp
-0004c770: 6c65 2073 6574 7320 3c73 6563 5f73 7461  le sets <sec_sta
-0004c780: 7473 5f73 616d 706c 655f 7365 7473 3e60  ts_sample_sets>`
-0004c790: 2c0a 2020 2020 2020 2020 3a72 6566 3a60  ,.        :ref:`
-0004c7a0: 7769 6e64 6f77 7320 3c73 6563 5f73 7461  windows <sec_sta
-0004c7b0: 7473 5f77 696e 646f 7773 3e60 2c0a 2020  ts_windows>`,.  
-0004c7c0: 2020 2020 2020 3a72 6566 3a60 6d6f 6465        :ref:`mode
-0004c7d0: 203c 7365 635f 7374 6174 735f 6d6f 6465   <sec_stats_mode
-0004c7e0: 3e60 2c0a 2020 2020 2020 2020 3a72 6566  >`,.        :ref
-0004c7f0: 3a60 7370 616e 206e 6f72 6d61 6c69 7365  :`span normalise
-0004c800: 203c 7365 635f 7374 6174 735f 7370 616e   <sec_stats_span
-0004c810: 5f6e 6f72 6d61 6c69 7365 3e60 2c0a 2020  _normalise>`,.  
-0004c820: 2020 2020 2020 616e 6420 3a72 6566 3a60        and :ref:`
-0004c830: 7265 7475 726e 2076 616c 7565 203c 7365  return value <se
-0004c840: 635f 7374 6174 735f 6f75 7470 7574 5f66  c_stats_output_f
-0004c850: 6f72 6d61 743e 602e 0a20 2020 2020 2020  ormat>`..       
-0004c860: 2049 6620 6060 7361 6d70 6c65 5f73 6574   If ``sample_set
-0004c870: 7360 6020 6973 2061 206c 6973 7420 6f66  s`` is a list of
-0004c880: 2060 606b 6060 2073 6574 7320 6f66 2073   ``k`` sets of s
-0004c890: 616d 706c 6573 2c20 7468 656e 0a20 2020  amples, then.   
-0004c8a0: 2020 2020 2060 6066 6060 2073 686f 756c       ``f`` shoul
-0004c8b0: 6420 6265 2061 2066 756e 6374 696f 6e20  d be a function 
-0004c8c0: 7468 6174 2074 616b 6573 2061 6e20 6172  that takes an ar
-0004c8d0: 6775 6d65 6e74 206f 6620 6c65 6e67 7468  gument of length
-0004c8e0: 2060 606b 6060 2061 6e64 0a20 2020 2020   ``k`` and.     
-0004c8f0: 2020 2072 6574 7572 6e73 2061 206f 6e65     returns a one
-0004c900: 2d64 696d 656e 7369 6f6e 616c 2061 7272  -dimensional arr
-0004c910: 6179 2e20 5468 6520 6060 6a60 602d 7468  ay. The ``j``-th
-0004c920: 2065 6c65 6d65 6e74 206f 6620 7468 6520   element of the 
-0004c930: 6172 6775 6d65 6e74 0a20 2020 2020 2020  argument.       
-0004c940: 2074 6f20 6060 6660 6020 7769 6c6c 2062   to ``f`` will b
-0004c950: 6520 7468 6520 6e75 6d62 6572 206f 6620  e the number of 
-0004c960: 7361 6d70 6c65 7320 696e 2060 6073 616d  samples in ``sam
-0004c970: 706c 655f 7365 7473 5b6a 5d60 6020 7468  ple_sets[j]`` th
-0004c980: 6174 206c 6965 0a20 2020 2020 2020 2062  at lie.        b
-0004c990: 656c 6f77 2074 6865 206e 6f64 6520 7468  elow the node th
-0004c9a0: 6174 2060 6066 6060 2069 7320 6265 696e  at ``f`` is bein
-0004c9b0: 6720 6576 616c 7561 7465 6420 666f 722e  g evaluated for.
-0004c9c0: 2053 6565 0a20 2020 2020 2020 203a 6d65   See.        :me
-0004c9d0: 7468 3a60 2e67 656e 6572 616c 5f73 7461  th:`.general_sta
-0004c9e0: 7460 2020 666f 7220 6d6f 7265 2064 6574  t`  for more det
-0004c9f0: 6169 6c73 2e0a 0a20 2020 2020 2020 2048  ails...        H
-0004ca00: 6572 6520 6973 2061 2063 6f6e 7472 6976  ere is a contriv
-0004ca10: 6564 2065 7861 6d70 6c65 3a20 7375 7070  ed example: supp
-0004ca20: 6f73 6520 7468 6174 2060 6041 6060 2061  ose that ``A`` a
-0004ca30: 6e64 2060 6042 6060 2061 7265 2074 776f  nd ``B`` are two
-0004ca40: 2073 6574 730a 2020 2020 2020 2020 6f66   sets.        of
-0004ca50: 2073 616d 706c 6573 2077 6974 6820 6060   samples with ``
-0004ca60: 6e41 6060 2061 6e64 2060 606e 4260 6020  nA`` and ``nB`` 
-0004ca70: 656c 656d 656e 7473 2c20 7265 7370 6563  elements, respec
-0004ca80: 7469 7665 6c79 2e20 5061 7373 696e 6720  tively. Passing 
-0004ca90: 7468 6573 650a 2020 2020 2020 2020 6173  these.        as
-0004caa0: 2073 616d 706c 6520 7365 7473 2077 696c   sample sets wil
-0004cab0: 6c20 6769 7665 2060 6066 6060 2061 6e20  l give ``f`` an 
-0004cac0: 6172 6775 6d65 6e74 206f 6620 6c65 6e67  argument of leng
-0004cad0: 7468 2074 776f 2c20 6769 7669 6e67 2074  th two, giving t
-0004cae0: 6865 206e 756d 6265 720a 2020 2020 2020  he number.      
-0004caf0: 2020 6f66 2073 616d 706c 6573 2069 6e20    of samples in 
-0004cb00: 6060 4160 6020 616e 6420 6060 4260 6020  ``A`` and ``B`` 
-0004cb10: 6265 6c6f 7720 7468 6520 6e6f 6465 2069  below the node i
-0004cb20: 6e20 7175 6573 7469 6f6e 2e20 536f 2c20  n question. So, 
-0004cb30: 6966 2077 6520 6465 6669 6e65 0a0a 0a20  if we define... 
-0004cb40: 2020 2020 2020 202e 2e20 636f 6465 2d62         .. code-b
-0004cb50: 6c6f 636b 3a3a 2070 7974 686f 6e0a 0a20  lock:: python.. 
-0004cb60: 2020 2020 2020 2020 2020 2064 6566 2066             def f
-0004cb70: 2878 293a 0a20 2020 2020 2020 2020 2020  (x):.           
-0004cb80: 2020 2020 2070 4120 3d20 785b 305d 202f       pA = x[0] /
-0004cb90: 206e 410a 2020 2020 2020 2020 2020 2020   nA.            
-0004cba0: 2020 2020 7042 203d 2078 5b31 5d20 2f20      pB = x[1] / 
-0004cbb0: 6e42 0a20 2020 2020 2020 2020 2020 2020  nB.             
-0004cbc0: 2020 2072 6574 7572 6e20 6e70 2e61 7272     return np.arr
-0004cbd0: 6179 285b 7041 202a 2070 425d 290a 0a20  ay([pA * pB]).. 
-0004cbe0: 2020 2020 2020 2074 6865 6e20 6966 2061         then if a
-0004cbf0: 6c6c 2073 6974 6573 2061 7265 2062 6961  ll sites are bia
-0004cc00: 6c6c 656c 6963 2c0a 0a20 2020 2020 2020  llelic,..       
-0004cc10: 202e 2e20 636f 6465 2d62 6c6f 636b 3a3a   .. code-block::
-0004cc20: 2070 7974 686f 6e0a 0a20 2020 2020 2020   python..       
-0004cc30: 2020 2020 2074 732e 7361 6d70 6c65 5f63       ts.sample_c
-0004cc40: 6f75 6e74 5f73 7461 7428 5b41 2c20 425d  ount_stat([A, B]
-0004cc50: 2c20 662c 2031 2c20 7769 6e64 6f77 733d  , f, 1, windows=
-0004cc60: 2273 6974 6573 222c 2070 6f6c 6172 6973  "sites", polaris
-0004cc70: 6564 3d46 616c 7365 2c20 6d6f 6465 3d22  ed=False, mode="
-0004cc80: 7369 7465 2229 0a0a 2020 2020 2020 2020  site")..        
-0004cc90: 776f 756c 6420 636f 6d70 7574 652c 2066  would compute, f
-0004cca0: 6f72 2065 6163 6820 7369 7465 2c20 7468  or each site, th
-0004ccb0: 6520 7072 6f64 7563 7420 6f66 2074 6865  e product of the
-0004ccc0: 2064 6572 6976 6564 2061 6c6c 656c 650a   derived allele.
-0004ccd0: 2020 2020 2020 2020 6672 6571 7565 6e63          frequenc
-0004cce0: 6965 7320 696e 2074 6865 2074 776f 2073  ies in the two s
-0004ccf0: 616d 706c 6520 7365 7473 2c20 696e 2061  ample sets, in a
-0004cd00: 2028 6e75 6d20 7369 7465 732c 2031 2920   (num sites, 1) 
-0004cd10: 6172 7261 792e 2020 4966 0a20 2020 2020  array.  If.     
-0004cd20: 2020 2069 6e73 7465 6164 2060 6066 6060     instead ``f``
-0004cd30: 2072 6574 7572 6e73 2060 606e 702e 6172   returns ``np.ar
-0004cd40: 7261 7928 5b70 412c 2070 422c 2070 4120  ray([pA, pB, pA 
-0004cd50: 2a20 7042 5d29 6060 2c20 7468 656e 2074  * pB])``, then t
-0004cd60: 6865 0a20 2020 2020 2020 206f 7574 7075  he.        outpu
-0004cd70: 7420 776f 756c 6420 6265 2061 2028 6e75  t would be a (nu
-0004cd80: 6d20 7369 7465 732c 2033 2920 6172 7261  m sites, 3) arra
-0004cd90: 792c 2077 6974 6820 7468 6520 6669 7273  y, with the firs
-0004cda0: 7420 7477 6f20 636f 6c75 6d6e 730a 2020  t two columns.  
-0004cdb0: 2020 2020 2020 6769 7669 6e67 2074 6865        giving the
-0004cdc0: 2061 6c6c 656c 6520 6672 6571 7565 6e63   allele frequenc
-0004cdd0: 6965 7320 696e 2060 6041 6060 2061 6e64  ies in ``A`` and
-0004cde0: 2060 6042 6060 2c20 7265 7370 6563 7469   ``B``, respecti
-0004cdf0: 7665 6c79 2e0a 0a20 2020 2020 2020 202e  vely...        .
-0004ce00: 2e20 6e6f 7465 3a3a 0a20 2020 2020 2020  . note::.       
-0004ce10: 2020 2020 2054 6865 2073 756d 6d61 7279       The summary
-0004ce20: 2066 756e 6374 696f 6e20 6060 6660 6020   function ``f`` 
-0004ce30: 7368 6f75 6c64 2072 6574 7572 6e20 7a65  should return ze
-0004ce40: 726f 2077 6865 6e20 6769 7665 6e20 626f  ro when given bo
-0004ce50: 7468 2030 2061 6e64 0a20 2020 2020 2020  th 0 and.       
-0004ce60: 2020 2020 2074 6865 2073 616d 706c 6520       the sample 
-0004ce70: 7369 7a65 2028 692e 652e 2c20 6060 6628  size (i.e., ``f(
-0004ce80: 3029 203d 2030 6060 2061 6e64 0a20 2020  0) = 0`` and.   
-0004ce90: 2020 2020 2020 2020 2060 6066 286e 702e           ``f(np.
-0004cea0: 6172 7261 7928 5b6c 656e 2878 2920 666f  array([len(x) fo
-0004ceb0: 7220 7820 696e 2073 616d 706c 655f 7365  r x in sample_se
-0004cec0: 7473 5d29 2920 3d20 3060 6029 2e20 2054  ts])) = 0``).  T
-0004ced0: 6869 7320 6973 0a20 2020 2020 2020 2020  his is.         
-0004cee0: 2020 206e 6563 6573 7361 7279 2066 6f72     necessary for
-0004cef0: 2074 6865 2073 7461 7469 7374 6963 2074   the statistic t
-0004cf00: 6f20 6265 2075 6e61 6666 6563 7465 6420  o be unaffected 
-0004cf10: 6279 2070 6172 7473 206f 6620 7468 6520  by parts of the 
-0004cf20: 7472 6565 0a20 2020 2020 2020 2020 2020  tree.           
-0004cf30: 2073 6571 7565 6e63 6520 616e 6365 7374   sequence ancest
-0004cf40: 7261 6c20 746f 206e 6f6e 6520 6f72 2061  ral to none or a
-0004cf50: 6c6c 206f 6620 7468 6520 7361 6d70 6c65  ll of the sample
-0004cf60: 732c 2072 6573 7065 6374 6976 656c 792e  s, respectively.
-0004cf70: 0a0a 2020 2020 2020 2020 3a70 6172 616d  ..        :param
-0004cf80: 206c 6973 7420 7361 6d70 6c65 5f73 6574   list sample_set
-0004cf90: 733a 2041 206c 6973 7420 6f66 206c 6973  s: A list of lis
-0004cfa0: 7473 206f 6620 4e6f 6465 2049 4473 2c20  ts of Node IDs, 
-0004cfb0: 7370 6563 6966 7969 6e67 2074 6865 0a20  specifying the. 
-0004cfc0: 2020 2020 2020 2020 2020 2067 726f 7570             group
-0004cfd0: 7320 6f66 206e 6f64 6573 2074 6f20 636f  s of nodes to co
-0004cfe0: 6d70 7574 6520 7468 6520 7374 6174 6973  mpute the statis
-0004cff0: 7469 6320 7769 7468 2e0a 2020 2020 2020  tic with..      
-0004d000: 2020 3a70 6172 616d 2066 3a20 4120 6675    :param f: A fu
-0004d010: 6e63 7469 6f6e 2074 6861 7420 7461 6b65  nction that take
-0004d020: 7320 6120 6f6e 652d 6469 6d65 6e73 696f  s a one-dimensio
-0004d030: 6e61 6c20 6172 7261 7920 6f66 206c 656e  nal array of len
-0004d040: 6774 680a 2020 2020 2020 2020 2020 2020  gth.            
-0004d050: 6571 7561 6c20 746f 2074 6865 206e 756d  equal to the num
-0004d060: 6265 7220 6f66 2073 616d 706c 6520 7365  ber of sample se
-0004d070: 7473 2061 6e64 2072 6574 7572 6e73 2061  ts and returns a
-0004d080: 206f 6e65 2d64 696d 656e 7369 6f6e 616c   one-dimensional
-0004d090: 2061 7272 6179 2e0a 2020 2020 2020 2020   array..        
-0004d0a0: 3a70 6172 616d 2069 6e74 206f 7574 7075  :param int outpu
-0004d0b0: 745f 6469 6d3a 2054 6865 206c 656e 6774  t_dim: The lengt
-0004d0c0: 6820 6f66 2060 6066 6060 2773 2072 6574  h of ``f``'s ret
-0004d0d0: 7572 6e20 7661 6c75 652e 0a20 2020 2020  urn value..     
-0004d0e0: 2020 203a 7061 7261 6d20 6c69 7374 2077     :param list w
-0004d0f0: 696e 646f 7773 3a20 416e 2069 6e63 7265  indows: An incre
-0004d100: 6173 696e 6720 6c69 7374 206f 6620 6272  asing list of br
-0004d110: 6561 6b70 6f69 6e74 7320 6265 7477 6565  eakpoints betwee
-0004d120: 6e20 7468 6520 7769 6e64 6f77 730a 2020  n the windows.  
-0004d130: 2020 2020 2020 2020 2020 746f 2063 6f6d            to com
-0004d140: 7075 7465 2074 6865 2073 7461 7469 7374  pute the statist
-0004d150: 6963 2069 6e2e 0a20 2020 2020 2020 203a  ic in..        :
-0004d160: 7061 7261 6d20 626f 6f6c 2070 6f6c 6172  param bool polar
-0004d170: 6973 6564 3a20 5768 6574 6865 7220 746f  ised: Whether to
-0004d180: 206c 6561 7665 2074 6865 2061 6e63 6573   leave the ances
-0004d190: 7472 616c 2073 7461 7465 206f 7574 206f  tral state out o
-0004d1a0: 6620 636f 6d70 7574 6174 696f 6e73 3a0a  f computations:.
-0004d1b0: 2020 2020 2020 2020 2020 2020 7365 6520              see 
-0004d1c0: 3a72 6566 3a60 7365 635f 7374 6174 7360  :ref:`sec_stats`
-0004d1d0: 2066 6f72 206d 6f72 6520 6465 7461 696c   for more detail
-0004d1e0: 732e 0a20 2020 2020 2020 203a 7061 7261  s..        :para
-0004d1f0: 6d20 7374 7220 6d6f 6465 3a20 4120 7374  m str mode: A st
-0004d200: 7269 6e67 2067 6976 696e 6720 7468 6520  ring giving the 
-0004d210: 2274 7970 6522 206f 6620 7468 6520 7374  "type" of the st
-0004d220: 6174 6973 7469 6320 746f 2062 6520 636f  atistic to be co
-0004d230: 6d70 7574 6564 0a20 2020 2020 2020 2020  mputed.         
-0004d240: 2020 2028 6465 6661 756c 7473 2074 6f20     (defaults to 
-0004d250: 2273 6974 6522 292e 0a20 2020 2020 2020  "site")..       
-0004d260: 203a 7061 7261 6d20 626f 6f6c 2073 7061   :param bool spa
-0004d270: 6e5f 6e6f 726d 616c 6973 653a 2057 6865  n_normalise: Whe
-0004d280: 7468 6572 2074 6f20 6469 7669 6465 2074  ther to divide t
-0004d290: 6865 2072 6573 756c 7420 6279 2074 6865  he result by the
-0004d2a0: 2073 7061 6e20 6f66 2074 6865 0a20 2020   span of the.   
-0004d2b0: 2020 2020 2020 2020 2077 696e 646f 7720           window 
-0004d2c0: 2864 6566 6175 6c74 7320 746f 2054 7275  (defaults to Tru
-0004d2d0: 6529 2e0a 2020 2020 2020 2020 3a70 6172  e)..        :par
-0004d2e0: 616d 2062 6f6f 6c20 7374 7269 6374 3a20  am bool strict: 
-0004d2f0: 5768 6574 6865 7220 746f 2063 6865 636b  Whether to check
-0004d300: 2074 6861 7420 6628 3029 2061 6e64 2066   that f(0) and f
-0004d310: 2874 6f74 616c 2077 6569 6768 7429 2061  (total weight) a
-0004d320: 7265 207a 6572 6f2e 0a20 2020 2020 2020  re zero..       
-0004d330: 203a 7265 7475 726e 3a20 4120 6e64 6172   :return: A ndar
-0004d340: 7261 7920 7769 7468 2073 6861 7065 2065  ray with shape e
-0004d350: 7175 616c 2074 6f20 286e 756d 2077 696e  qual to (num win
-0004d360: 646f 7773 2c20 6e75 6d20 7374 6174 6973  dows, num statis
-0004d370: 7469 6373 292e 0a20 2020 2020 2020 2022  tics)..        "
-0004d380: 2222 2020 2320 6e6f 7161 3a20 4239 3530  ""  # noqa: B950
-0004d390: 0a20 2020 2020 2020 2023 2068 656c 7065  .        # helpe
-0004d3a0: 7220 6675 6e63 7469 6f6e 2066 6f72 2063  r function for c
-0004d3b0: 6f6d 6d6f 6e20 6361 7365 2077 6865 7265  ommon case where
-0004d3c0: 2077 6569 6768 7473 2061 7265 2069 6e64   weights are ind
-0004d3d0: 6963 6174 6f72 7320 6f66 2073 616d 706c  icators of sampl
-0004d3e0: 6520 7365 7473 0a20 2020 2020 2020 2066  e sets.        f
-0004d3f0: 6f72 2055 2069 6e20 7361 6d70 6c65 5f73  or U in sample_s
-0004d400: 6574 733a 0a20 2020 2020 2020 2020 2020  ets:.           
-0004d410: 2069 6620 6c65 6e28 5529 2021 3d20 6c65   if len(U) != le
-0004d420: 6e28 7365 7428 5529 293a 0a20 2020 2020  n(set(U)):.     
-0004d430: 2020 2020 2020 2020 2020 2072 6169 7365             raise
-0004d440: 2056 616c 7565 4572 726f 7228 0a20 2020   ValueError(.   
-0004d450: 2020 2020 2020 2020 2020 2020 2020 2020                  
-0004d460: 2022 456c 656d 656e 7473 206f 6620 7361   "Elements of sa
-0004d470: 6d70 6c65 5f73 6574 7320 6d75 7374 2062  mple_sets must b
-0004d480: 6520 6c69 7374 7320 7769 7468 6f75 7420  e lists without 
-0004d490: 7265 7065 6174 6564 2065 6c65 6d65 6e74  repeated element
-0004d4a0: 732e 220a 2020 2020 2020 2020 2020 2020  s.".            
-0004d4b0: 2020 2020 290a 2020 2020 2020 2020 2020      ).          
-0004d4c0: 2020 6966 206c 656e 2855 2920 3d3d 2030    if len(U) == 0
-0004d4d0: 3a0a 2020 2020 2020 2020 2020 2020 2020  :.              
-0004d4e0: 2020 7261 6973 6520 5661 6c75 6545 7272    raise ValueErr
-0004d4f0: 6f72 2822 456c 656d 656e 7473 206f 6620  or("Elements of 
-0004d500: 7361 6d70 6c65 5f73 6574 7320 6361 6e6e  sample_sets cann
-0004d510: 6f74 2062 6520 656d 7074 792e 2229 0a20  ot be empty."). 
-0004d520: 2020 2020 2020 2020 2020 2066 6f72 2075             for u
-0004d530: 2069 6e20 553a 0a20 2020 2020 2020 2020   in U:.         
-0004d540: 2020 2020 2020 2069 6620 6e6f 7420 7365         if not se
-0004d550: 6c66 2e6e 6f64 6528 7529 2e69 735f 7361  lf.node(u).is_sa
-0004d560: 6d70 6c65 2829 3a0a 2020 2020 2020 2020  mple():.        
-0004d570: 2020 2020 2020 2020 2020 2020 7261 6973              rais
-0004d580: 6520 5661 6c75 6545 7272 6f72 2822 4e6f  e ValueError("No
-0004d590: 7420 616c 6c20 656c 656d 656e 7473 206f  t all elements o
-0004d5a0: 6620 7361 6d70 6c65 5f73 6574 7320 6172  f sample_sets ar
-0004d5b0: 6520 7361 6d70 6c65 732e 2229 0a0a 2020  e samples.")..  
-0004d5c0: 2020 2020 2020 5720 3d20 6e70 2e61 7272        W = np.arr
-0004d5d0: 6179 285b 5b66 6c6f 6174 2875 2069 6e20  ay([[float(u in 
-0004d5e0: 4129 2066 6f72 2041 2069 6e20 7361 6d70  A) for A in samp
-0004d5f0: 6c65 5f73 6574 735d 2066 6f72 2075 2069  le_sets] for u i
-0004d600: 6e20 7365 6c66 2e73 616d 706c 6573 2829  n self.samples()
-0004d610: 5d29 0a20 2020 2020 2020 2072 6574 7572  ]).        retur
-0004d620: 6e20 7365 6c66 2e67 656e 6572 616c 5f73  n self.general_s
-0004d630: 7461 7428 0a20 2020 2020 2020 2020 2020  tat(.           
-0004d640: 2057 2c0a 2020 2020 2020 2020 2020 2020   W,.            
-0004d650: 662c 0a20 2020 2020 2020 2020 2020 206f  f,.            o
-0004d660: 7574 7075 745f 6469 6d2c 0a20 2020 2020  utput_dim,.     
-0004d670: 2020 2020 2020 2077 696e 646f 7773 3d77         windows=w
-0004d680: 696e 646f 7773 2c0a 2020 2020 2020 2020  indows,.        
-0004d690: 2020 2020 706f 6c61 7269 7365 643d 706f      polarised=po
-0004d6a0: 6c61 7269 7365 642c 0a20 2020 2020 2020  larised,.       
-0004d6b0: 2020 2020 206d 6f64 653d 6d6f 6465 2c0a       mode=mode,.
-0004d6c0: 2020 2020 2020 2020 2020 2020 7370 616e              span
-0004d6d0: 5f6e 6f72 6d61 6c69 7365 3d73 7061 6e5f  _normalise=span_
-0004d6e0: 6e6f 726d 616c 6973 652c 0a20 2020 2020  normalise,.     
-0004d6f0: 2020 2020 2020 2073 7472 6963 743d 7374         strict=st
-0004d700: 7269 6374 2c0a 2020 2020 2020 2020 290a  rict,.        ).
-0004d710: 0a20 2020 2064 6566 2070 6172 7365 5f77  .    def parse_w
-0004d720: 696e 646f 7773 2873 656c 662c 2077 696e  indows(self, win
-0004d730: 646f 7773 293a 0a20 2020 2020 2020 2023  dows):.        #
-0004d740: 204e 6f74 653a 206e 6565 6420 746f 206d   Note: need to m
-0004d750: 616b 6520 7375 7265 2077 696e 646f 7773  ake sure windows
-0004d760: 2069 7320 6120 7374 7269 6e67 206f 7220   is a string or 
-0004d770: 7765 2074 7279 2074 6f20 636f 6d70 6172  we try to compar
-0004d780: 6520 7468 650a 2020 2020 2020 2020 2320  e the.        # 
-0004d790: 7461 7267 6574 2077 6974 6820 6120 6e75  target with a nu
-0004d7a0: 6d70 7920 6172 7261 7920 656c 656d 656e  mpy array elemen
-0004d7b0: 7477 6973 652e 0a20 2020 2020 2020 2069  twise..        i
-0004d7c0: 6620 7769 6e64 6f77 7320 6973 204e 6f6e  f windows is Non
-0004d7d0: 653a 0a20 2020 2020 2020 2020 2020 2077  e:.            w
-0004d7e0: 696e 646f 7773 203d 205b 302e 302c 2073  indows = [0.0, s
-0004d7f0: 656c 662e 7365 7175 656e 6365 5f6c 656e  elf.sequence_len
-0004d800: 6774 685d 0a20 2020 2020 2020 2065 6c69  gth].        eli
-0004d810: 6620 6973 696e 7374 616e 6365 2877 696e  f isinstance(win
-0004d820: 646f 7773 2c20 7374 7229 3a0a 2020 2020  dows, str):.    
-0004d830: 2020 2020 2020 2020 6966 2077 696e 646f          if windo
-0004d840: 7773 203d 3d20 2274 7265 6573 223a 0a20  ws == "trees":. 
-0004d850: 2020 2020 2020 2020 2020 2020 2020 2077                 w
-0004d860: 696e 646f 7773 203d 2073 656c 662e 6272  indows = self.br
-0004d870: 6561 6b70 6f69 6e74 7328 6173 5f61 7272  eakpoints(as_arr
-0004d880: 6179 3d54 7275 6529 0a20 2020 2020 2020  ay=True).       
-0004d890: 2020 2020 2065 6c69 6620 7769 6e64 6f77       elif window
-0004d8a0: 7320 3d3d 2022 7369 7465 7322 3a0a 2020  s == "sites":.  
-0004d8b0: 2020 2020 2020 2020 2020 2020 2020 2320                # 
-0004d8c0: 6272 6561 6b70 6f69 6e74 7320 6172 6520  breakpoints are 
-0004d8d0: 6174 2030 2e30 2061 6e64 2061 7420 7468  at 0.0 and at th
-0004d8e0: 6520 7369 7465 7320 616e 6420 6174 2074  e sites and at t
-0004d8f0: 6865 2065 6e64 0a20 2020 2020 2020 2020  he end.         
-0004d900: 2020 2020 2020 2077 696e 646f 7773 203d         windows =
-0004d910: 206e 702e 636f 6e63 6174 656e 6174 6528   np.concatenate(
-0004d920: 0a20 2020 2020 2020 2020 2020 2020 2020  .               
-0004d930: 2020 2020 205b 0a20 2020 2020 2020 2020       [.         
-0004d940: 2020 2020 2020 2020 2020 2020 2020 205b                 [
-0004d950: 5d20 6966 2073 656c 662e 6e75 6d5f 7369  ] if self.num_si
-0004d960: 7465 7320 3e20 3020 656c 7365 205b 302e  tes > 0 else [0.
-0004d970: 305d 2c0a 2020 2020 2020 2020 2020 2020  0],.            
-0004d980: 2020 2020 2020 2020 2020 2020 7365 6c66              self
-0004d990: 2e73 6974 6573 5f70 6f73 6974 696f 6e2c  .sites_position,
-0004d9a0: 0a20 2020 2020 2020 2020 2020 2020 2020  .               
-0004d9b0: 2020 2020 2020 2020 205b 7365 6c66 2e73           [self.s
-0004d9c0: 6571 7565 6e63 655f 6c65 6e67 7468 5d2c  equence_length],
-0004d9d0: 0a20 2020 2020 2020 2020 2020 2020 2020  .               
-0004d9e0: 2020 2020 205d 0a20 2020 2020 2020 2020       ].         
-0004d9f0: 2020 2020 2020 2029 0a20 2020 2020 2020         ).       
-0004da00: 2020 2020 2020 2020 2077 696e 646f 7773           windows
-0004da10: 5b30 5d20 3d20 302e 300a 2020 2020 2020  [0] = 0.0.      
-0004da20: 2020 2020 2020 656c 7365 3a0a 2020 2020        else:.    
-0004da30: 2020 2020 2020 2020 2020 2020 7261 6973              rais
-0004da40: 6520 5661 6c75 6545 7272 6f72 280a 2020  e ValueError(.  
-0004da50: 2020 2020 2020 2020 2020 2020 2020 2020                  
-0004da60: 2020 6622 556e 7265 636f 676e 697a 6564    f"Unrecognized
-0004da70: 2077 696e 646f 7720 7370 6563 6966 6963   window specific
-0004da80: 6174 696f 6e20 7b77 696e 646f 7773 7d3a  ation {windows}:
-0004da90: 222c 0a20 2020 2020 2020 2020 2020 2020  ",.             
-0004daa0: 2020 2020 2020 2022 7468 6520 6f6e 6c79         "the only
-0004dab0: 2061 6c6c 6f77 6564 2073 7472 696e 6773   allowed strings
-0004dac0: 2061 7265 2027 7369 7465 7327 206f 7220   are 'sites' or 
-0004dad0: 2774 7265 6573 2722 2c0a 2020 2020 2020  'trees'",.      
-0004dae0: 2020 2020 2020 2020 2020 290a 2020 2020            ).    
-0004daf0: 2020 2020 7265 7475 726e 206e 702e 6172      return np.ar
-0004db00: 7261 7928 7769 6e64 6f77 7329 0a0a 2020  ray(windows)..  
-0004db10: 2020 6465 6620 5f5f 7275 6e5f 7769 6e64    def __run_wind
-0004db20: 6f77 6564 5f73 7461 7428 7365 6c66 2c20  owed_stat(self, 
-0004db30: 7769 6e64 6f77 732c 206d 6574 686f 642c  windows, method,
-0004db40: 202a 6172 6773 2c20 2a2a 6b77 6172 6773   *args, **kwargs
-0004db50: 293a 0a20 2020 2020 2020 2073 7472 6970  ):.        strip
-0004db60: 5f64 696d 203d 2077 696e 646f 7773 2069  _dim = windows i
-0004db70: 7320 4e6f 6e65 0a20 2020 2020 2020 2077  s None.        w
-0004db80: 696e 646f 7773 203d 2073 656c 662e 7061  indows = self.pa
-0004db90: 7273 655f 7769 6e64 6f77 7328 7769 6e64  rse_windows(wind
-0004dba0: 6f77 7329 0a20 2020 2020 2020 2073 7461  ows).        sta
-0004dbb0: 7420 3d20 6d65 7468 6f64 282a 6172 6773  t = method(*args
-0004dbc0: 2c20 2a2a 6b77 6172 6773 2c20 7769 6e64  , **kwargs, wind
-0004dbd0: 6f77 733d 7769 6e64 6f77 7329 0a20 2020  ows=windows).   
-0004dbe0: 2020 2020 2069 6620 7374 7269 705f 6469       if strip_di
-0004dbf0: 6d3a 0a20 2020 2020 2020 2020 2020 2073  m:.            s
-0004dc00: 7461 7420 3d20 7374 6174 5b30 5d0a 2020  tat = stat[0].  
-0004dc10: 2020 2020 2020 7265 7475 726e 2073 7461        return sta
-0004dc20: 740a 0a20 2020 2064 6566 205f 5f6f 6e65  t..    def __one
-0004dc30: 5f77 6179 5f73 616d 706c 655f 7365 745f  _way_sample_set_
-0004dc40: 7374 6174 280a 2020 2020 2020 2020 7365  stat(.        se
-0004dc50: 6c66 2c0a 2020 2020 2020 2020 6c6c 5f6d  lf,.        ll_m
-0004dc60: 6574 686f 642c 0a20 2020 2020 2020 2073  ethod,.        s
-0004dc70: 616d 706c 655f 7365 7473 2c0a 2020 2020  ample_sets,.    
-0004dc80: 2020 2020 7769 6e64 6f77 733d 4e6f 6e65      windows=None
-0004dc90: 2c0a 2020 2020 2020 2020 6d6f 6465 3d4e  ,.        mode=N
-0004dca0: 6f6e 652c 0a20 2020 2020 2020 2073 7061  one,.        spa
-0004dcb0: 6e5f 6e6f 726d 616c 6973 653d 5472 7565  n_normalise=True
-0004dcc0: 2c0a 2020 2020 2020 2020 706f 6c61 7269  ,.        polari
-0004dcd0: 7365 643d 4661 6c73 652c 0a20 2020 2029  sed=False,.    )
-0004dce0: 3a0a 2020 2020 2020 2020 6966 2073 616d  :.        if sam
-0004dcf0: 706c 655f 7365 7473 2069 7320 4e6f 6e65  ple_sets is None
-0004dd00: 3a0a 2020 2020 2020 2020 2020 2020 7361  :.            sa
-0004dd10: 6d70 6c65 5f73 6574 7320 3d20 7365 6c66  mple_sets = self
-0004dd20: 2e73 616d 706c 6573 2829 0a0a 2020 2020  .samples()..    
-0004dd30: 2020 2020 2320 4669 7273 7420 7472 7920      # First try 
-0004dd40: 746f 2063 6f6e 7665 7274 2074 6f20 6120  to convert to a 
-0004dd50: 3144 206e 756d 7079 2061 7272 6179 2e20  1D numpy array. 
-0004dd60: 4966 2069 7420 6973 2c20 7468 656e 2077  If it is, then w
-0004dd70: 6520 7374 7269 7020 6f66 660a 2020 2020  e strip off.    
-0004dd80: 2020 2020 2320 7468 6520 636f 7272 6573      # the corres
-0004dd90: 706f 6e64 696e 6720 6469 6d65 6e73 696f  ponding dimensio
-0004dda0: 6e20 6672 6f6d 2074 6865 206f 7574 7075  n from the outpu
-0004ddb0: 742e 0a20 2020 2020 2020 2064 726f 705f  t..        drop_
-0004ddc0: 6469 6d65 6e73 696f 6e20 3d20 4661 6c73  dimension = Fals
-0004ddd0: 650a 2020 2020 2020 2020 7472 793a 0a20  e.        try:. 
-0004dde0: 2020 2020 2020 2020 2020 2073 616d 706c             sampl
-0004ddf0: 655f 7365 7473 203d 206e 702e 6172 7261  e_sets = np.arra
-0004de00: 7928 7361 6d70 6c65 5f73 6574 732c 2064  y(sample_sets, d
-0004de10: 7479 7065 3d6e 702e 7569 6e74 3634 290a  type=np.uint64).
-0004de20: 2020 2020 2020 2020 6578 6365 7074 2056          except V
-0004de30: 616c 7565 4572 726f 723a 0a20 2020 2020  alueError:.     
-0004de40: 2020 2020 2020 2070 6173 730a 2020 2020         pass.    
-0004de50: 2020 2020 656c 7365 3a0a 2020 2020 2020      else:.      
-0004de60: 2020 2020 2020 2320 4966 2077 6527 7665        # If we've
-0004de70: 2073 7563 6365 7373 6675 6c6c 7920 636f   successfully co
-0004de80: 6e76 6572 7465 6420 7361 6d70 6c65 5f73  nverted sample_s
-0004de90: 6574 7320 746f 2061 2031 4420 6e75 6d70  ets to a 1D nump
-0004dea0: 7920 6172 7261 790a 2020 2020 2020 2020  y array.        
-0004deb0: 2020 2020 2320 6f66 2069 6e74 6567 6572      # of integer
-0004dec0: 7320 7468 656e 2064 726f 7020 7468 6520  s then drop the 
-0004ded0: 6469 6d65 6e73 696f 6e0a 2020 2020 2020  dimension.      
-0004dee0: 2020 2020 2020 6966 206c 656e 2873 616d        if len(sam
-0004def0: 706c 655f 7365 7473 2e73 6861 7065 2920  ple_sets.shape) 
-0004df00: 3d3d 2031 3a0a 2020 2020 2020 2020 2020  == 1:.          
-0004df10: 2020 2020 2020 7361 6d70 6c65 5f73 6574        sample_set
-0004df20: 7320 3d20 5b73 616d 706c 655f 7365 7473  s = [sample_sets
-0004df30: 5d0a 2020 2020 2020 2020 2020 2020 2020  ].              
-0004df40: 2020 6472 6f70 5f64 696d 656e 7369 6f6e    drop_dimension
-0004df50: 203d 2054 7275 650a 0a20 2020 2020 2020   = True..       
-0004df60: 2073 616d 706c 655f 7365 745f 7369 7a65   sample_set_size
-0004df70: 7320 3d20 6e70 2e61 7272 6179 280a 2020  s = np.array(.  
-0004df80: 2020 2020 2020 2020 2020 5b6c 656e 2873            [len(s
-0004df90: 616d 706c 655f 7365 7429 2066 6f72 2073  ample_set) for s
-0004dfa0: 616d 706c 655f 7365 7420 696e 2073 616d  ample_set in sam
-0004dfb0: 706c 655f 7365 7473 5d2c 2064 7479 7065  ple_sets], dtype
-0004dfc0: 3d6e 702e 7569 6e74 3332 0a20 2020 2020  =np.uint32.     
-0004dfd0: 2020 2029 0a20 2020 2020 2020 2069 6620     ).        if 
-0004dfe0: 6e70 2e61 6e79 2873 616d 706c 655f 7365  np.any(sample_se
-0004dff0: 745f 7369 7a65 7320 3d3d 2030 293a 0a20  t_sizes == 0):. 
-0004e000: 2020 2020 2020 2020 2020 2072 6169 7365             raise
-0004e010: 2056 616c 7565 4572 726f 7228 2253 616d   ValueError("Sam
-0004e020: 706c 6520 7365 7473 206d 7573 7420 636f  ple sets must co
-0004e030: 6e74 6169 6e20 6174 206c 6561 7374 206f  ntain at least o
-0004e040: 6e65 2065 6c65 6d65 6e74 2229 0a0a 2020  ne element")..  
-0004e050: 2020 2020 2020 666c 6174 7465 6e65 6420        flattened 
-0004e060: 3d20 7574 696c 2e73 6166 655f 6e70 5f69  = util.safe_np_i
-0004e070: 6e74 5f63 6173 7428 6e70 2e68 7374 6163  nt_cast(np.hstac
-0004e080: 6b28 7361 6d70 6c65 5f73 6574 7329 2c20  k(sample_sets), 
-0004e090: 6e70 2e69 6e74 3332 290a 2020 2020 2020  np.int32).      
-0004e0a0: 2020 7374 6174 203d 2073 656c 662e 5f5f    stat = self.__
-0004e0b0: 7275 6e5f 7769 6e64 6f77 6564 5f73 7461  run_windowed_sta
-0004e0c0: 7428 0a20 2020 2020 2020 2020 2020 2077  t(.            w
-0004e0d0: 696e 646f 7773 2c0a 2020 2020 2020 2020  indows,.        
-0004e0e0: 2020 2020 6c6c 5f6d 6574 686f 642c 0a20      ll_method,. 
-0004e0f0: 2020 2020 2020 2020 2020 2073 616d 706c             sampl
-0004e100: 655f 7365 745f 7369 7a65 732c 0a20 2020  e_set_sizes,.   
-0004e110: 2020 2020 2020 2020 2066 6c61 7474 656e           flatten
-0004e120: 6564 2c0a 2020 2020 2020 2020 2020 2020  ed,.            
-0004e130: 6d6f 6465 3d6d 6f64 652c 0a20 2020 2020  mode=mode,.     
-0004e140: 2020 2020 2020 2073 7061 6e5f 6e6f 726d         span_norm
-0004e150: 616c 6973 653d 7370 616e 5f6e 6f72 6d61  alise=span_norma
-0004e160: 6c69 7365 2c0a 2020 2020 2020 2020 2020  lise,.          
-0004e170: 2020 706f 6c61 7269 7365 643d 706f 6c61    polarised=pola
-0004e180: 7269 7365 642c 0a20 2020 2020 2020 2029  rised,.        )
-0004e190: 0a20 2020 2020 2020 2069 6620 6472 6f70  .        if drop
-0004e1a0: 5f64 696d 656e 7369 6f6e 3a0a 2020 2020  _dimension:.    
-0004e1b0: 2020 2020 2020 2020 7374 6174 203d 2073          stat = s
-0004e1c0: 7461 742e 7265 7368 6170 6528 7374 6174  tat.reshape(stat
-0004e1d0: 2e73 6861 7065 5b3a 2d31 5d29 0a20 2020  .shape[:-1]).   
-0004e1e0: 2020 2020 2020 2020 2069 6620 7374 6174           if stat
-0004e1f0: 2e73 6861 7065 203d 3d20 2829 2061 6e64  .shape == () and
-0004e200: 2077 696e 646f 7773 2069 7320 4e6f 6e65   windows is None
-0004e210: 3a0a 2020 2020 2020 2020 2020 2020 2020  :.              
-0004e220: 2020 7374 6174 203d 2073 7461 745b 2829    stat = stat[()
-0004e230: 5d0a 2020 2020 2020 2020 7265 7475 726e  ].        return
-0004e240: 2073 7461 740a 0a20 2020 2064 6566 205f   stat..    def _
-0004e250: 5f6b 5f77 6179 5f73 616d 706c 655f 7365  _k_way_sample_se
-0004e260: 745f 7374 6174 280a 2020 2020 2020 2020  t_stat(.        
-0004e270: 7365 6c66 2c0a 2020 2020 2020 2020 6c6c  self,.        ll
-0004e280: 5f6d 6574 686f 642c 0a20 2020 2020 2020  _method,.       
-0004e290: 206b 2c0a 2020 2020 2020 2020 7361 6d70   k,.        samp
-0004e2a0: 6c65 5f73 6574 732c 0a20 2020 2020 2020  le_sets,.       
-0004e2b0: 2069 6e64 6578 6573 3d4e 6f6e 652c 0a20   indexes=None,. 
-0004e2c0: 2020 2020 2020 2077 696e 646f 7773 3d4e         windows=N
-0004e2d0: 6f6e 652c 0a20 2020 2020 2020 206d 6f64  one,.        mod
-0004e2e0: 653d 4e6f 6e65 2c0a 2020 2020 2020 2020  e=None,.        
-0004e2f0: 7370 616e 5f6e 6f72 6d61 6c69 7365 3d54  span_normalise=T
-0004e300: 7275 652c 0a20 2020 2020 2020 2070 6f6c  rue,.        pol
-0004e310: 6172 6973 6564 3d46 616c 7365 2c0a 2020  arised=False,.  
-0004e320: 2020 293a 0a20 2020 2020 2020 2073 616d    ):.        sam
-0004e330: 706c 655f 7365 745f 7369 7a65 7320 3d20  ple_set_sizes = 
-0004e340: 6e70 2e61 7272 6179 280a 2020 2020 2020  np.array(.      
-0004e350: 2020 2020 2020 5b6c 656e 2873 616d 706c        [len(sampl
-0004e360: 655f 7365 7429 2066 6f72 2073 616d 706c  e_set) for sampl
-0004e370: 655f 7365 7420 696e 2073 616d 706c 655f  e_set in sample_
-0004e380: 7365 7473 5d2c 2064 7479 7065 3d6e 702e  sets], dtype=np.
-0004e390: 7569 6e74 3332 0a20 2020 2020 2020 2029  uint32.        )
-0004e3a0: 0a20 2020 2020 2020 2069 6620 6e70 2e61  .        if np.a
-0004e3b0: 6e79 2873 616d 706c 655f 7365 745f 7369  ny(sample_set_si
-0004e3c0: 7a65 7320 3d3d 2030 293a 0a20 2020 2020  zes == 0):.     
-0004e3d0: 2020 2020 2020 2072 6169 7365 2056 616c         raise Val
-0004e3e0: 7565 4572 726f 7228 2253 616d 706c 6520  ueError("Sample 
-0004e3f0: 7365 7473 206d 7573 7420 636f 6e74 6169  sets must contai
-0004e400: 6e20 6174 206c 6561 7374 206f 6e65 2065  n at least one e
-0004e410: 6c65 6d65 6e74 2229 0a20 2020 2020 2020  lement").       
-0004e420: 2066 6c61 7474 656e 6564 203d 2075 7469   flattened = uti
-0004e430: 6c2e 7361 6665 5f6e 705f 696e 745f 6361  l.safe_np_int_ca
-0004e440: 7374 286e 702e 6873 7461 636b 2873 616d  st(np.hstack(sam
-0004e450: 706c 655f 7365 7473 292c 206e 702e 696e  ple_sets), np.in
-0004e460: 7433 3229 0a20 2020 2020 2020 2064 726f  t32).        dro
-0004e470: 705f 6261 7365 645f 6f6e 5f69 6e64 6578  p_based_on_index
-0004e480: 203d 2046 616c 7365 0a20 2020 2020 2020   = False.       
-0004e490: 2069 6620 696e 6465 7865 7320 6973 204e   if indexes is N
-0004e4a0: 6f6e 653a 0a20 2020 2020 2020 2020 2020  one:.           
-0004e4b0: 2064 726f 705f 6261 7365 645f 6f6e 5f69   drop_based_on_i
-0004e4c0: 6e64 6578 203d 2054 7275 650a 2020 2020  ndex = True.    
-0004e4d0: 2020 2020 2020 2020 6966 206c 656e 2873          if len(s
-0004e4e0: 616d 706c 655f 7365 7473 2920 213d 206b  ample_sets) != k
-0004e4f0: 3a0a 2020 2020 2020 2020 2020 2020 2020  :.              
-0004e500: 2020 7261 6973 6520 5661 6c75 6545 7272    raise ValueErr
-0004e510: 6f72 280a 2020 2020 2020 2020 2020 2020  or(.            
-0004e520: 2020 2020 2020 2020 224d 7573 7420 7370          "Must sp
-0004e530: 6563 6966 7920 696e 6465 7865 7320 6966  ecify indexes if
-0004e540: 2074 6865 7265 2061 7265 206e 6f74 2065   there are not e
-0004e550: 7861 6374 6c79 207b 7d20 7361 6d70 6c65  xactly {} sample
-0004e560: 2022 0a20 2020 2020 2020 2020 2020 2020   ".             
-0004e570: 2020 2020 2020 2022 7365 7473 2e22 2e66         "sets.".f
-0004e580: 6f72 6d61 7428 6b29 0a20 2020 2020 2020  ormat(k).       
-0004e590: 2020 2020 2020 2020 2029 0a20 2020 2020           ).     
-0004e5a0: 2020 2020 2020 2069 6e64 6578 6573 203d         indexes =
-0004e5b0: 206e 702e 6172 616e 6765 286b 2c20 6474   np.arange(k, dt
-0004e5c0: 7970 653d 6e70 2e69 6e74 3332 290a 2020  ype=np.int32).  
-0004e5d0: 2020 2020 2020 6472 6f70 5f64 696d 656e        drop_dimen
-0004e5e0: 7369 6f6e 203d 2046 616c 7365 0a20 2020  sion = False.   
-0004e5f0: 2020 2020 2069 6e64 6578 6573 203d 2075       indexes = u
-0004e600: 7469 6c2e 7361 6665 5f6e 705f 696e 745f  til.safe_np_int_
-0004e610: 6361 7374 2869 6e64 6578 6573 2c20 6e70  cast(indexes, np
-0004e620: 2e69 6e74 3332 290a 2020 2020 2020 2020  .int32).        
-0004e630: 6966 206c 656e 2869 6e64 6578 6573 2e73  if len(indexes.s
-0004e640: 6861 7065 2920 3d3d 2031 3a0a 2020 2020  hape) == 1:.    
-0004e650: 2020 2020 2020 2020 696e 6465 7865 7320          indexes 
-0004e660: 3d20 696e 6465 7865 732e 7265 7368 6170  = indexes.reshap
-0004e670: 6528 2831 2c20 696e 6465 7865 732e 7368  e((1, indexes.sh
-0004e680: 6170 655b 305d 2929 0a20 2020 2020 2020  ape[0])).       
-0004e690: 2020 2020 2064 726f 705f 6469 6d65 6e73       drop_dimens
-0004e6a0: 696f 6e20 3d20 5472 7565 0a20 2020 2020  ion = True.     
-0004e6b0: 2020 2069 6620 6c65 6e28 696e 6465 7865     if len(indexe
-0004e6c0: 732e 7368 6170 6529 2021 3d20 3220 6f72  s.shape) != 2 or
-0004e6d0: 2069 6e64 6578 6573 2e73 6861 7065 5b31   indexes.shape[1
-0004e6e0: 5d20 213d 206b 3a0a 2020 2020 2020 2020  ] != k:.        
-0004e6f0: 2020 2020 7261 6973 6520 5661 6c75 6545      raise ValueE
-0004e700: 7272 6f72 280a 2020 2020 2020 2020 2020  rror(.          
-0004e710: 2020 2020 2020 2249 6e64 6578 6573 206d        "Indexes m
-0004e720: 7573 7420 6265 2063 6f6e 7665 7274 6162  ust be convertab
-0004e730: 6c65 2074 6f20 6120 3244 206e 756d 7079  le to a 2D numpy
-0004e740: 2061 7272 6179 2077 6974 6820 7b7d 2022   array with {} "
-0004e750: 0a20 2020 2020 2020 2020 2020 2020 2020  .               
-0004e760: 2022 636f 6c75 6d6e 7322 2e66 6f72 6d61   "columns".forma
-0004e770: 7428 6b29 0a20 2020 2020 2020 2020 2020  t(k).           
-0004e780: 2029 0a20 2020 2020 2020 2073 7461 7420   ).        stat 
-0004e790: 3d20 7365 6c66 2e5f 5f72 756e 5f77 696e  = self.__run_win
-0004e7a0: 646f 7765 645f 7374 6174 280a 2020 2020  dowed_stat(.    
-0004e7b0: 2020 2020 2020 2020 7769 6e64 6f77 732c          windows,
-0004e7c0: 0a20 2020 2020 2020 2020 2020 206c 6c5f  .            ll_
-0004e7d0: 6d65 7468 6f64 2c0a 2020 2020 2020 2020  method,.        
-0004e7e0: 2020 2020 7361 6d70 6c65 5f73 6574 5f73      sample_set_s
-0004e7f0: 697a 6573 2c0a 2020 2020 2020 2020 2020  izes,.          
-0004e800: 2020 666c 6174 7465 6e65 642c 0a20 2020    flattened,.   
-0004e810: 2020 2020 2020 2020 2069 6e64 6578 6573           indexes
-0004e820: 2c0a 2020 2020 2020 2020 2020 2020 6d6f  ,.            mo
-0004e830: 6465 3d6d 6f64 652c 0a20 2020 2020 2020  de=mode,.       
-0004e840: 2020 2020 2073 7061 6e5f 6e6f 726d 616c       span_normal
-0004e850: 6973 653d 7370 616e 5f6e 6f72 6d61 6c69  ise=span_normali
-0004e860: 7365 2c0a 2020 2020 2020 2020 2020 2020  se,.            
-0004e870: 706f 6c61 7269 7365 643d 706f 6c61 7269  polarised=polari
-0004e880: 7365 642c 0a20 2020 2020 2020 2029 0a20  sed,.        ). 
-0004e890: 2020 2020 2020 2069 6620 6472 6f70 5f64         if drop_d
-0004e8a0: 696d 656e 7369 6f6e 3a0a 2020 2020 2020  imension:.      
-0004e8b0: 2020 2020 2020 7374 6174 203d 2073 7461        stat = sta
-0004e8c0: 742e 7265 7368 6170 6528 7374 6174 2e73  t.reshape(stat.s
-0004e8d0: 6861 7065 5b3a 2d31 5d29 0a20 2020 2020  hape[:-1]).     
-0004e8e0: 2020 2020 2020 2069 6620 7374 6174 2e73         if stat.s
-0004e8f0: 6861 7065 203d 3d20 2829 2061 6e64 2077  hape == () and w
-0004e900: 696e 646f 7773 2069 7320 4e6f 6e65 2061  indows is None a
-0004e910: 6e64 2064 726f 705f 6261 7365 645f 6f6e  nd drop_based_on
-0004e920: 5f69 6e64 6578 3a0a 2020 2020 2020 2020  _index:.        
-0004e930: 2020 2020 2020 2020 7374 6174 203d 2073          stat = s
-0004e940: 7461 745b 2829 5d0a 2020 2020 2020 2020  tat[()].        
-0004e950: 7265 7475 726e 2073 7461 740a 0a20 2020  return stat..   
-0004e960: 2023 2323 2323 2323 2323 2323 2323 2323   ###############
-0004e970: 2323 2323 2323 2323 2323 2323 2323 2323  ################
-0004e980: 2323 2323 2323 2323 2323 2323 230a 2020  #############.  
-0004e990: 2020 2320 5374 6174 6973 7469 6373 2064    # Statistics d
-0004e9a0: 6566 696e 6974 696f 6e73 0a20 2020 2023  efinitions.    #
+00032d00: 2020 2020 2020 2020 2020 2029 0a20 2020             ).   
+00032d10: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00032d20: 2020 2020 2029 0a20 2020 2020 2020 2020       ).         
+00032d30: 2020 2020 2020 2020 2020 2061 6c6c 656c             allel
+00032d40: 6573 5b69 5d20 3d20 616c 6c65 6c65 5f69  es[i] = allele_i
+00032d50: 6e74 380a 2020 2020 2020 2020 2020 2020  nt8.            
+00032d60: 485b 3a2c 2076 6172 2e73 6974 652e 6964  H[:, var.site.id
+00032d70: 202d 2073 7461 7274 5f73 6974 655d 203d   - start_site] =
+00032d80: 2061 6c6c 656c 6573 5b76 6172 2e67 656e   alleles[var.gen
+00032d90: 6f74 7970 6573 5d0a 2020 2020 2020 2020  otypes].        
+00032da0: 7265 7475 726e 2048 2c20 2873 7461 7274  return H, (start
+00032db0: 5f73 6974 652c 2073 746f 705f 7369 7465  _site, stop_site
+00032dc0: 202d 2031 290a 0a20 2020 2064 6566 2068   - 1)..    def h
+00032dd0: 6170 6c6f 7479 7065 7328 0a20 2020 2020  aplotypes(.     
+00032de0: 2020 2073 656c 662c 0a20 2020 2020 2020     self,.       
+00032df0: 202a 2c0a 2020 2020 2020 2020 6973 6f6c   *,.        isol
+00032e00: 6174 6564 5f61 735f 6d69 7373 696e 673d  ated_as_missing=
+00032e10: 4e6f 6e65 2c0a 2020 2020 2020 2020 6d69  None,.        mi
+00032e20: 7373 696e 675f 6461 7461 5f63 6861 7261  ssing_data_chara
+00032e30: 6374 6572 3d4e 6f6e 652c 0a20 2020 2020  cter=None,.     
+00032e40: 2020 2073 616d 706c 6573 3d4e 6f6e 652c     samples=None,
+00032e50: 0a20 2020 2020 2020 206c 6566 743d 4e6f  .        left=No
+00032e60: 6e65 2c0a 2020 2020 2020 2020 7269 6768  ne,.        righ
+00032e70: 743d 4e6f 6e65 2c0a 2020 2020 2020 2020  t=None,.        
+00032e80: 696d 7075 7465 5f6d 6973 7369 6e67 5f64  impute_missing_d
+00032e90: 6174 613d 4e6f 6e65 2c0a 2020 2020 293a  ata=None,.    ):
+00032ea0: 0a20 2020 2020 2020 2022 2222 0a20 2020  .        """.   
+00032eb0: 2020 2020 2052 6574 7572 6e73 2061 6e20       Returns an 
+00032ec0: 6974 6572 6174 6f72 206f 7665 7220 7468  iterator over th
+00032ed0: 6520 7374 7269 6e67 7320 6f66 2068 6170  e strings of hap
+00032ee0: 6c6f 7479 7065 7320 7468 6174 2072 6573  lotypes that res
+00032ef0: 756c 7420 6672 6f6d 0a20 2020 2020 2020  ult from.       
+00032f00: 2074 6865 2074 7265 6573 2061 6e64 206d   the trees and m
+00032f10: 7574 6174 696f 6e73 2069 6e20 7468 6973  utations in this
+00032f20: 2074 7265 6520 7365 7175 656e 6365 2e20   tree sequence. 
+00032f30: 4561 6368 2068 6170 6c6f 7479 7065 2073  Each haplotype s
+00032f40: 7472 696e 670a 2020 2020 2020 2020 6973  tring.        is
+00032f50: 2067 7561 7261 6e74 6565 6420 746f 2062   guaranteed to b
+00032f60: 6520 6f66 2074 6865 2073 616d 6520 6c65  e of the same le
+00032f70: 6e67 7468 2e20 4120 7472 6565 2073 6571  ngth. A tree seq
+00032f80: 7565 6e63 6520 7769 7468 0a20 2020 2020  uence with.     
+00032f90: 2020 203a 6d61 7468 3a60 6e60 2073 616d     :math:`n` sam
+00032fa0: 706c 6573 2061 6e64 2077 6974 6820 3a6d  ples and with :m
+00032fb0: 6174 683a 6073 6020 7369 7465 7320 6c79  ath:`s` sites ly
+00032fc0: 696e 6720 6265 7477 6565 6e20 6060 6c65  ing between ``le
+00032fd0: 6674 6060 2061 6e64 0a20 2020 2020 2020  ft`` and.       
+00032fe0: 2060 6072 6967 6874 6060 2077 696c 6c20   ``right`` will 
+00032ff0: 7265 7475 726e 2061 2074 6f74 616c 206f  return a total o
+00033000: 6620 3a6d 6174 683a 606e 600a 2020 2020  f :math:`n`.    
+00033010: 2020 2020 7374 7269 6e67 7320 6f66 203a      strings of :
+00033020: 6d61 7468 3a60 7360 2061 6c6c 656c 6573  math:`s` alleles
+00033030: 2063 6f6e 6361 7465 6e61 7465 6420 746f   concatenated to
+00033040: 6765 7468 6572 2c20 7768 6572 6520 616e  gether, where an
+00033050: 2061 6c6c 656c 650a 2020 2020 2020 2020   allele.        
+00033060: 636f 6e73 6973 7473 206f 6620 6120 7369  consists of a si
+00033070: 6e67 6c65 2061 7363 6969 2063 6861 7261  ngle ascii chara
+00033080: 6374 6572 2028 7472 6565 2073 6571 7565  cter (tree seque
+00033090: 6e63 6573 2074 6861 7420 696e 636c 7564  nces that includ
+000330a0: 6520 616c 6c65 6c65 730a 2020 2020 2020  e alleles.      
+000330b0: 2020 7768 6963 6820 6172 6520 6e6f 7420    which are not 
+000330c0: 6120 7369 6e67 6c65 2063 6861 7261 6374  a single charact
+000330d0: 6572 2069 6e20 6c65 6e67 7468 2c20 6f72  er in length, or
+000330e0: 2077 6865 7265 2074 6865 2063 6861 7261   where the chara
+000330f0: 6374 6572 2069 730a 2020 2020 2020 2020  cter is.        
+00033100: 6e6f 6e2d 6173 6369 692c 2077 696c 6c20  non-ascii, will 
+00033110: 7261 6973 6520 616e 2065 7272 6f72 292e  raise an error).
+00033120: 2054 6865 2066 6972 7374 2073 7472 696e   The first strin
+00033130: 6720 7265 7475 726e 6564 2069 7320 7468  g returned is th
+00033140: 650a 2020 2020 2020 2020 6861 706c 6f74  e.        haplot
+00033150: 7970 6520 666f 7220 7468 6520 6669 7273  ype for the firs
+00033160: 7420 7265 7175 6573 7465 6420 7361 6d70  t requested samp
+00033170: 6c65 2c20 616e 6420 736f 206f 6e2e 0a0a  le, and so on...
+00033180: 2020 2020 2020 2020 5468 6520 616c 6c65          The alle
+00033190: 6c65 7320 6174 2065 6163 6820 7369 7465  les at each site
+000331a0: 206d 7573 7420 6265 2072 6570 7265 7365   must be represe
+000331b0: 6e74 6564 2062 7920 7369 6e67 6c65 2062  nted by single b
+000331c0: 7974 6520 6368 6172 6163 7465 7273 2c0a  yte characters,.
+000331d0: 2020 2020 2020 2020 2869 2e65 2e2c 2076          (i.e., v
+000331e0: 6172 6961 6e74 7320 6d75 7374 2062 6520  ariants must be 
+000331f0: 7369 6e67 6c65 206e 7563 6c65 6f74 6964  single nucleotid
+00033200: 6520 706f 6c79 6d6f 7270 6869 736d 732c  e polymorphisms,
+00033210: 206f 7220 534e 5073 292c 2068 656e 6365   or SNPs), hence
+00033220: 0a20 2020 2020 2020 2074 6865 2073 7472  .        the str
+00033230: 696e 6773 2072 6574 7572 6e65 6420 7769  ings returned wi
+00033240: 6c6c 2061 6c6c 2062 6520 6f66 206c 656e  ll all be of len
+00033250: 6774 6820 3a6d 6174 683a 6073 602e 2049  gth :math:`s`. I
+00033260: 6620 7468 6520 6060 6c65 6674 6060 0a20  f the ``left``. 
+00033270: 2020 2020 2020 2070 6f73 6974 696f 6e20         position 
+00033280: 6973 206c 6573 7320 7468 616e 206f 7220  is less than or 
+00033290: 6571 7561 6c20 746f 2074 6865 2070 6f73  equal to the pos
+000332a0: 6974 696f 6e20 6f66 2074 6865 2066 6972  ition of the fir
+000332b0: 7374 2073 6974 652c 2066 6f72 2061 0a20  st site, for a. 
+000332c0: 2020 2020 2020 2068 6170 6c6f 7479 7065         haplotype
+000332d0: 2060 6068 6060 2c20 7468 6520 7661 6c75   ``h``, the valu
+000332e0: 6520 6f66 2060 6068 5b6a 5d60 6020 7769  e of ``h[j]`` wi
+000332f0: 6c6c 2074 6865 7265 666f 7265 2062 6520  ll therefore be 
+00033300: 7468 6520 6f62 7365 7276 6564 0a20 2020  the observed.   
+00033310: 2020 2020 2061 6c6c 656c 6963 2073 7461       allelic sta
+00033320: 7465 2061 7420 7369 7465 2060 606a 6060  te at site ``j``
+00033330: 2e0a 0a20 2020 2020 2020 2049 6620 6060  ...        If ``
+00033340: 6973 6f6c 6174 6564 5f61 735f 6d69 7373  isolated_as_miss
+00033350: 696e 6760 6020 6973 2054 7275 6520 2874  ing`` is True (t
+00033360: 6865 2064 6566 6175 6c74 292c 2069 736f  he default), iso
+00033370: 6c61 7465 6420 7361 6d70 6c65 7320 7769  lated samples wi
+00033380: 7468 6f75 740a 2020 2020 2020 2020 6d75  thout.        mu
+00033390: 7461 7469 6f6e 7320 6469 7265 6374 6c79  tations directly
+000333a0: 2061 626f 7665 2074 6865 6d20 7769 6c6c   above them will
+000333b0: 2062 6520 7472 6561 7465 6420 6173 0a20   be treated as. 
+000333c0: 2020 2020 2020 203a 7265 663a 606d 6973         :ref:`mis
+000333d0: 7369 6e67 2064 6174 613c 7365 635f 6461  sing data<sec_da
+000333e0: 7461 5f6d 6f64 656c 5f6d 6973 7369 6e67  ta_model_missing
+000333f0: 5f64 6174 613e 6020 616e 6420 7769 6c6c  _data>` and will
+00033400: 2062 650a 2020 2020 2020 2020 7265 7072   be.        repr
+00033410: 6573 656e 7465 6420 696e 2074 6865 2073  esented in the s
+00033420: 7472 696e 6720 6279 2074 6865 2060 606d  tring by the ``m
+00033430: 6973 7369 6e67 5f64 6174 615f 6368 6172  issing_data_char
+00033440: 6163 7465 7260 602e 2049 660a 2020 2020  acter``. If.    
+00033450: 2020 2020 696e 7374 6561 6420 6974 2069      instead it i
+00033460: 7320 7365 7420 746f 2046 616c 7365 2c20  s set to False, 
+00033470: 6d69 7373 696e 6720 6461 7461 2077 696c  missing data wil
+00033480: 6c20 6265 2061 7373 6967 6e65 6420 7468  l be assigned th
+00033490: 6520 616e 6365 7374 7261 6c20 7374 6174  e ancestral stat
+000334a0: 650a 2020 2020 2020 2020 2875 6e6c 6573  e.        (unles
+000334b0: 7320 7468 6579 2068 6176 6520 6d75 7461  s they have muta
+000334c0: 7469 6f6e 7320 6469 7265 6374 6c79 2061  tions directly a
+000334d0: 626f 7665 2074 6865 6d2c 2069 6e20 7768  bove them, in wh
+000334e0: 6963 6820 6361 7365 2074 6865 7920 7769  ich case they wi
+000334f0: 6c6c 2074 616b 650a 2020 2020 2020 2020  ll take.        
+00033500: 7468 6520 6d6f 7374 2072 6563 656e 7420  the most recent 
+00033510: 6465 7269 7665 6420 6d75 7461 7469 6f6e  derived mutation
+00033520: 616c 2073 7461 7465 2066 6f72 2074 6861  al state for tha
+00033530: 7420 6e6f 6465 292e 2054 6869 7320 7761  t node). This wa
+00033540: 7320 7468 6520 6465 6661 756c 740a 2020  s the default.  
+00033550: 2020 2020 2020 6265 6861 7669 6f75 7220        behaviour 
+00033560: 696e 2076 6572 7369 6f6e 7320 7072 696f  in versions prio
+00033570: 7220 746f 2030 2e32 2e30 2e20 5072 696f  r to 0.2.0. Prio
+00033580: 7220 746f 2030 2e33 2e30 2074 6865 2060  r to 0.3.0 the `
+00033590: 696d 7075 7465 5f6d 6973 7369 6e67 5f64  impute_missing_d
+000335a0: 6174 6160 0a20 2020 2020 2020 2061 7267  ata`.        arg
+000335b0: 756d 656e 7420 636f 6e74 726f 6c6c 6564  ument controlled
+000335c0: 2074 6869 7320 6265 6861 7669 6f75 722e   this behaviour.
+000335d0: 0a0a 2020 2020 2020 2020 5365 6520 616c  ..        See al
+000335e0: 736f 2074 6865 203a 6d65 7468 3a60 2e76  so the :meth:`.v
+000335f0: 6172 6961 6e74 7360 2069 7465 7261 746f  ariants` iterato
+00033600: 7220 666f 7220 7369 7465 2d63 656e 7472  r for site-centr
+00033610: 6963 2061 6363 6573 730a 2020 2020 2020  ic access.      
+00033620: 2020 746f 2073 616d 706c 6520 6765 6e6f    to sample geno
+00033630: 7479 7065 732e 0a0a 2020 2020 2020 2020  types...        
+00033640: 2e2e 2077 6172 6e69 6e67 3a3a 0a20 2020  .. warning::.   
+00033650: 2020 2020 2020 2020 2046 6f72 206c 6172           For lar
+00033660: 6765 2064 6174 6173 6574 732c 2074 6869  ge datasets, thi
+00033670: 7320 6d65 7468 6f64 2063 616e 2063 6f6e  s method can con
+00033680: 7375 6d65 2061 202a 2a76 6572 7920 6c61  sume a **very la
+00033690: 7267 652a 2a20 616d 6f75 6e74 206f 660a  rge** amount of.
+000336a0: 2020 2020 2020 2020 2020 2020 6d65 6d6f              memo
+000336b0: 7279 2120 546f 206f 7574 7075 7420 616c  ry! To output al
+000336c0: 6c20 7468 6520 7361 6d70 6c65 2064 6174  l the sample dat
+000336d0: 612c 2069 7420 6973 206d 6f72 6520 6566  a, it is more ef
+000336e0: 6669 6369 656e 7420 746f 2069 7465 7261  ficient to itera
+000336f0: 7465 0a20 2020 2020 2020 2020 2020 206f  te.            o
+00033700: 7665 7220 7369 7465 7320 7261 7468 6572  ver sites rather
+00033710: 2074 6861 6e20 6f76 6572 2073 616d 706c   than over sampl
+00033720: 6573 2e0a 0a20 2020 2020 2020 203a 7265  es...        :re
+00033730: 7475 726e 3a20 416e 2069 7465 7261 746f  turn: An iterato
+00033740: 7220 6f76 6572 2074 6865 2068 6170 6c6f  r over the haplo
+00033750: 7479 7065 2073 7472 696e 6773 2066 6f72  type strings for
+00033760: 2074 6865 2073 616d 706c 6573 2069 6e0a   the samples in.
+00033770: 2020 2020 2020 2020 2020 2020 7468 6973              this
+00033780: 2074 7265 6520 7365 7175 656e 6365 2e0a   tree sequence..
+00033790: 2020 2020 2020 2020 3a70 6172 616d 2062          :param b
+000337a0: 6f6f 6c20 6973 6f6c 6174 6564 5f61 735f  ool isolated_as_
+000337b0: 6d69 7373 696e 673a 2049 6620 5472 7565  missing: If True
+000337c0: 2c20 7468 6520 616c 6c65 6c65 2061 7373  , the allele ass
+000337d0: 6967 6e65 6420 746f 0a20 2020 2020 2020  igned to.       
+000337e0: 2020 2020 206d 6973 7369 6e67 2073 616d       missing sam
+000337f0: 706c 6573 2028 692e 652e 2c20 6973 6f6c  ples (i.e., isol
+00033800: 6174 6564 2073 616d 706c 6573 2077 6974  ated samples wit
+00033810: 686f 7574 206d 7574 6174 696f 6e73 2920  hout mutations) 
+00033820: 6973 0a20 2020 2020 2020 2020 2020 2074  is.            t
+00033830: 6865 2060 606d 6973 7369 6e67 5f64 6174  he ``missing_dat
+00033840: 615f 6368 6172 6163 7465 7260 602e 2049  a_character``. I
+00033850: 6620 4661 6c73 652c 0a20 2020 2020 2020  f False,.       
+00033860: 2020 2020 206d 6973 7369 6e67 2073 616d       missing sam
+00033870: 706c 6573 2077 696c 6c20 6265 2061 7373  ples will be ass
+00033880: 6967 6e65 6420 7468 6520 616e 6365 7374  igned the ancest
+00033890: 7261 6c20 7374 6174 652e 0a20 2020 2020  ral state..     
+000338a0: 2020 2020 2020 2044 6566 6175 6c74 3a20         Default: 
+000338b0: 5472 7565 2e0a 2020 2020 2020 2020 3a70  True..        :p
+000338c0: 6172 616d 2073 7472 206d 6973 7369 6e67  aram str missing
+000338d0: 5f64 6174 615f 6368 6172 6163 7465 723a  _data_character:
+000338e0: 2041 2073 696e 676c 6520 6173 6369 6920   A single ascii 
+000338f0: 6368 6172 6163 7465 7220 7468 6174 2077  character that w
+00033900: 696c 6c0a 2020 2020 2020 2020 2020 2020  ill.            
+00033910: 6265 2075 7365 6420 746f 2072 6570 7265  be used to repre
+00033920: 7365 6e74 206d 6973 7369 6e67 2064 6174  sent missing dat
+00033930: 612e 0a20 2020 2020 2020 2020 2020 2049  a..            I
+00033940: 6620 616e 7920 6e6f 726d 616c 2061 6c6c  f any normal all
+00033950: 656c 6520 636f 6e74 6169 6e73 2074 6869  ele contains thi
+00033960: 7320 6368 6172 6163 7465 722c 2061 6e20  s character, an 
+00033970: 6572 726f 7220 6973 2072 6169 7365 642e  error is raised.
+00033980: 0a20 2020 2020 2020 2020 2020 2044 6566  .            Def
+00033990: 6175 6c74 3a20 274e 272e 0a20 2020 2020  ault: 'N'..     
+000339a0: 2020 203a 7061 7261 6d20 6c69 7374 5b69     :param list[i
+000339b0: 6e74 5d20 7361 6d70 6c65 733a 2054 6865  nt] samples: The
+000339c0: 2073 616d 706c 6573 2066 6f72 2077 6869   samples for whi
+000339d0: 6368 2074 6f20 6f75 7470 7574 2068 6170  ch to output hap
+000339e0: 6c6f 7479 7065 732e 2049 660a 2020 2020  lotypes. If.    
+000339f0: 2020 2020 2020 2020 6060 4e6f 6e65 6060          ``None``
+00033a00: 2028 6465 6661 756c 7429 2c20 7265 7475   (default), retu
+00033a10: 726e 2068 6170 6c6f 7479 7065 7320 666f  rn haplotypes fo
+00033a20: 7220 616c 6c20 7468 6520 7361 6d70 6c65  r all the sample
+00033a30: 7320 696e 2074 6865 2074 7265 650a 2020  s in the tree.  
+00033a40: 2020 2020 2020 2020 2020 7365 7175 656e            sequen
+00033a50: 6365 2c20 696e 2074 6865 206f 7264 6572  ce, in the order
+00033a60: 2067 6976 656e 2062 7920 7468 6520 3a6d   given by the :m
+00033a70: 6574 683a 602e 7361 6d70 6c65 7360 206d  eth:`.samples` m
+00033a80: 6574 686f 642e 0a20 2020 2020 2020 203a  ethod..        :
+00033a90: 7061 7261 6d20 696e 7420 6c65 6674 3a20  param int left: 
+00033aa0: 4861 706c 6f74 7970 6520 7374 7269 6e67  Haplotype string
+00033ab0: 7320 7769 6c6c 2073 7461 7274 2077 6974  s will start wit
+00033ac0: 6820 7468 6520 6669 7273 7420 7369 7465  h the first site
+00033ad0: 2061 7420 6f72 2061 6674 6572 0a20 2020   at or after.   
+00033ae0: 2020 2020 2020 2020 2074 6869 7320 6765           this ge
+00033af0: 6e6f 6d69 6320 706f 7369 7469 6f6e 2e20  nomic position. 
+00033b00: 4966 2060 604e 6f6e 6560 6020 2864 6566  If ``None`` (def
+00033b10: 6175 6c74 2920 7374 6172 7420 6174 2074  ault) start at t
+00033b20: 6865 2066 6972 7374 2073 6974 652e 0a20  he first site.. 
+00033b30: 2020 2020 2020 203a 7061 7261 6d20 696e         :param in
+00033b40: 7420 7269 6768 743a 2048 6170 6c6f 7479  t right: Haploty
+00033b50: 7065 2073 7472 696e 6773 2077 696c 6c20  pe strings will 
+00033b60: 656e 6420 7769 7468 2074 6865 206c 6173  end with the las
+00033b70: 7420 7369 7465 2062 6566 6f72 6520 7468  t site before th
+00033b80: 6973 0a20 2020 2020 2020 2020 2020 2070  is.            p
+00033b90: 6f73 6974 696f 6e2e 2049 6620 6060 4e6f  osition. If ``No
+00033ba0: 6e65 6060 2028 6465 6661 756c 7429 2061  ne`` (default) a
+00033bb0: 7373 756d 6520 6060 7269 6768 7460 6020  ssume ``right`` 
+00033bc0: 6973 2074 6865 2073 6571 7565 6e63 6520  is the sequence 
+00033bd0: 6c65 6e67 7468 0a20 2020 2020 2020 2020  length.         
+00033be0: 2020 2028 692e 652e 2074 6865 206c 6173     (i.e. the las
+00033bf0: 7420 6368 6172 6163 7465 7220 696e 2074  t character in t
+00033c00: 6865 2073 7472 696e 6720 7769 6c6c 2062  he string will b
+00033c10: 6520 7468 6520 6c61 7374 2073 6974 6520  e the last site 
+00033c20: 696e 2074 6865 2074 7265 650a 2020 2020  in the tree.    
+00033c30: 2020 2020 2020 2020 7365 7175 656e 6365          sequence
+00033c40: 292e 0a20 2020 2020 2020 203a 7061 7261  )..        :para
+00033c50: 6d20 626f 6f6c 2069 6d70 7574 655f 6d69  m bool impute_mi
+00033c60: 7373 696e 675f 6461 7461 3a0a 2020 2020  ssing_data:.    
+00033c70: 2020 2020 2020 2020 2a44 6570 7265 6361          *Depreca
+00033c80: 7465 6420 696e 2030 2e33 2e30 2e20 5573  ted in 0.3.0. Us
+00033c90: 6520 6060 6973 6f6c 6174 6564 5f61 735f  e ``isolated_as_
+00033ca0: 6d69 7373 696e 6760 602c 2062 7574 2069  missing``, but i
+00033cb0: 6e76 6572 7469 6e67 2076 616c 7565 2e0a  nverting value..
+00033cc0: 2020 2020 2020 2020 2020 2020 5769 6c6c              Will
+00033cd0: 2062 6520 7265 6d6f 7665 6420 696e 2061   be removed in a
+00033ce0: 2066 7574 7572 6520 7665 7273 696f 6e2a   future version*
+00033cf0: 0a20 2020 2020 2020 203a 7274 7970 653a  .        :rtype:
+00033d00: 2063 6f6c 6c65 6374 696f 6e73 2e61 6263   collections.abc
+00033d10: 2e49 7465 7261 626c 650a 2020 2020 2020  .Iterable.      
+00033d20: 2020 3a72 6169 7365 733a 2054 7970 6545    :raises: TypeE
+00033d30: 7272 6f72 2069 6620 7468 6520 6060 6d69  rror if the ``mi
+00033d40: 7373 696e 675f 6461 7461 5f63 6861 7261  ssing_data_chara
+00033d50: 6374 6572 6060 206f 7220 616e 7920 6f66  cter`` or any of
+00033d60: 2074 6865 2061 6c6c 656c 6573 0a20 2020   the alleles.   
+00033d70: 2020 2020 2020 2020 2061 7420 6120 7369           at a si
+00033d80: 7465 2061 7265 206e 6f74 2061 2073 696e  te are not a sin
+00033d90: 676c 6520 6173 6369 6920 6368 6172 6163  gle ascii charac
+00033da0: 7465 722e 0a20 2020 2020 2020 203a 7261  ter..        :ra
+00033db0: 6973 6573 3a20 5661 6c75 6545 7272 6f72  ises: ValueError
+00033dc0: 0a20 2020 2020 2020 2020 2020 2069 6620  .            if 
+00033dd0: 7468 6520 6060 6d69 7373 696e 675f 6461  the ``missing_da
+00033de0: 7461 5f63 6861 7261 6374 6572 6060 2065  ta_character`` e
+00033df0: 7869 7374 7320 696e 206f 6e65 206f 6620  xists in one of 
+00033e00: 7468 6520 616c 6c65 6c65 730a 2020 2020  the alleles.    
+00033e10: 2020 2020 2222 220a 2020 2020 2020 2020      """.        
+00033e20: 6966 2069 6d70 7574 655f 6d69 7373 696e  if impute_missin
+00033e30: 675f 6461 7461 2069 7320 6e6f 7420 4e6f  g_data is not No
+00033e40: 6e65 3a0a 2020 2020 2020 2020 2020 2020  ne:.            
+00033e50: 7761 726e 696e 6773 2e77 6172 6e28 0a20  warnings.warn(. 
+00033e60: 2020 2020 2020 2020 2020 2020 2020 2022                 "
+00033e70: 5468 6520 696d 7075 7465 5f6d 6973 7369  The impute_missi
+00033e80: 6e67 5f64 6174 6120 7061 7261 6d65 7465  ng_data paramete
+00033e90: 7220 7761 7320 6465 7072 6563 6174 6564  r was deprecated
+00033ea0: 2069 6e20 302e 332e 3020 616e 6420 7769   in 0.3.0 and wi
+00033eb0: 6c6c 220a 2020 2020 2020 2020 2020 2020  ll".            
+00033ec0: 2020 2020 2220 6265 2072 656d 6f76 6564      " be removed
+00033ed0: 2e20 5573 6520 6060 6973 6f6c 6174 6564  . Use ``isolated
+00033ee0: 5f61 735f 6d69 7373 696e 673d 4661 6c73  _as_missing=Fals
+00033ef0: 6560 6020 696e 7374 6561 6420 6f66 220a  e`` instead of".
+00033f00: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00033f10: 2260 6069 6d70 7574 655f 6d69 7373 696e  "``impute_missin
+00033f20: 675f 6461 7461 3d54 7275 6560 602e 222c  g_data=True``.",
+00033f30: 0a20 2020 2020 2020 2020 2020 2020 2020  .               
+00033f40: 2046 7574 7572 6557 6172 6e69 6e67 2c0a   FutureWarning,.
+00033f50: 2020 2020 2020 2020 2020 2020 290a 2020              ).  
+00033f60: 2020 2020 2020 2320 4f6e 6c79 2075 7365        # Only use
+00033f70: 2069 6d70 7574 655f 6d69 7373 696e 675f   impute_missing_
+00033f80: 6461 7461 2069 6620 6973 6f6c 6174 6564  data if isolated
+00033f90: 5f61 735f 6d69 7373 696e 6720 6861 7320  _as_missing has 
+00033fa0: 7468 6520 6465 6661 756c 7420 7661 6c75  the default valu
+00033fb0: 650a 2020 2020 2020 2020 6966 2069 736f  e.        if iso
+00033fc0: 6c61 7465 645f 6173 5f6d 6973 7369 6e67  lated_as_missing
+00033fd0: 2069 7320 4e6f 6e65 3a0a 2020 2020 2020   is None:.      
+00033fe0: 2020 2020 2020 6973 6f6c 6174 6564 5f61        isolated_a
+00033ff0: 735f 6d69 7373 696e 6720 3d20 6e6f 7420  s_missing = not 
+00034000: 696d 7075 7465 5f6d 6973 7369 6e67 5f64  impute_missing_d
+00034010: 6174 610a 2020 2020 2020 2020 696e 7465  ata.        inte
+00034020: 7276 616c 203d 2073 656c 662e 5f63 6865  rval = self._che
+00034030: 636b 5f67 656e 6f6d 6963 5f72 616e 6765  ck_genomic_range
+00034040: 286c 6566 742c 2072 6967 6874 290a 2020  (left, right).  
+00034050: 2020 2020 2020 482c 205f 203d 2073 656c        H, _ = sel
+00034060: 662e 5f68 6170 6c6f 7479 7065 735f 6172  f._haplotypes_ar
+00034070: 7261 7928 0a20 2020 2020 2020 2020 2020  ray(.           
+00034080: 2069 6e74 6572 7661 6c3d 696e 7465 7276   interval=interv
+00034090: 616c 2c0a 2020 2020 2020 2020 2020 2020  al,.            
+000340a0: 6973 6f6c 6174 6564 5f61 735f 6d69 7373  isolated_as_miss
+000340b0: 696e 673d 6973 6f6c 6174 6564 5f61 735f  ing=isolated_as_
+000340c0: 6d69 7373 696e 672c 0a20 2020 2020 2020  missing,.       
+000340d0: 2020 2020 206d 6973 7369 6e67 5f64 6174       missing_dat
+000340e0: 615f 6368 6172 6163 7465 723d 6d69 7373  a_character=miss
+000340f0: 696e 675f 6461 7461 5f63 6861 7261 6374  ing_data_charact
+00034100: 6572 2c0a 2020 2020 2020 2020 2020 2020  er,.            
+00034110: 7361 6d70 6c65 733d 7361 6d70 6c65 732c  samples=samples,
+00034120: 0a20 2020 2020 2020 2029 0a20 2020 2020  .        ).     
+00034130: 2020 2066 6f72 2068 2069 6e20 483a 0a20     for h in H:. 
+00034140: 2020 2020 2020 2020 2020 2079 6965 6c64             yield
+00034150: 2068 2e74 6f62 7974 6573 2829 2e64 6563   h.tobytes().dec
+00034160: 6f64 6528 2261 7363 6969 2229 0a0a 2020  ode("ascii")..  
+00034170: 2020 6465 6620 7661 7269 616e 7473 280a    def variants(.
+00034180: 2020 2020 2020 2020 7365 6c66 2c0a 2020          self,.  
+00034190: 2020 2020 2020 2a2c 0a20 2020 2020 2020        *,.       
+000341a0: 2073 616d 706c 6573 3d4e 6f6e 652c 0a20   samples=None,. 
+000341b0: 2020 2020 2020 2069 736f 6c61 7465 645f         isolated_
+000341c0: 6173 5f6d 6973 7369 6e67 3d4e 6f6e 652c  as_missing=None,
+000341d0: 0a20 2020 2020 2020 2061 6c6c 656c 6573  .        alleles
+000341e0: 3d4e 6f6e 652c 0a20 2020 2020 2020 2069  =None,.        i
+000341f0: 6d70 7574 655f 6d69 7373 696e 675f 6461  mpute_missing_da
+00034200: 7461 3d4e 6f6e 652c 0a20 2020 2020 2020  ta=None,.       
+00034210: 2063 6f70 793d 4e6f 6e65 2c0a 2020 2020   copy=None,.    
+00034220: 2020 2020 6c65 6674 3d4e 6f6e 652c 0a20      left=None,. 
+00034230: 2020 2020 2020 2072 6967 6874 3d4e 6f6e         right=Non
+00034240: 652c 0a20 2020 2029 3a0a 2020 2020 2020  e,.    ):.      
+00034250: 2020 2222 220a 2020 2020 2020 2020 5265    """.        Re
+00034260: 7475 726e 7320 616e 2069 7465 7261 746f  turns an iterato
+00034270: 7220 6f76 6572 2074 6865 2076 6172 6961  r over the varia
+00034280: 6e74 7320 6265 7477 6565 6e20 7468 6520  nts between the 
+00034290: 6060 6c65 6674 6060 2028 696e 636c 7573  ``left`` (inclus
+000342a0: 6976 6529 0a20 2020 2020 2020 2061 6e64  ive).        and
+000342b0: 2060 6072 6967 6874 6060 2028 6578 636c   ``right`` (excl
+000342c0: 7573 6976 6529 2067 656e 6f6d 6963 2070  usive) genomic p
+000342d0: 6f73 6974 696f 6e73 2069 6e20 7468 6973  ositions in this
+000342e0: 2074 7265 6520 7365 7175 656e 6365 2e20   tree sequence. 
+000342f0: 4561 6368 0a20 2020 2020 2020 2072 6574  Each.        ret
+00034300: 7572 6e65 6420 3a63 6c61 7373 3a60 5661  urned :class:`Va
+00034310: 7269 616e 7460 206f 626a 6563 7420 6861  riant` object ha
+00034320: 7320 6120 7369 7465 2c20 6120 6c69 7374  s a site, a list
+00034330: 206f 6620 706f 7373 6962 6c65 2061 6c6c   of possible all
+00034340: 656c 6963 0a20 2020 2020 2020 2073 7461  elic.        sta
+00034350: 7465 7320 616e 6420 616e 2061 7272 6179  tes and an array
+00034360: 206f 6620 6765 6e6f 7479 7065 7320 666f   of genotypes fo
+00034370: 7220 7468 6520 7370 6563 6966 6965 6420  r the specified 
+00034380: 6060 7361 6d70 6c65 7360 602e 2054 6865  ``samples``. The
+00034390: 0a20 2020 2020 2020 2060 6067 656e 6f74  .        ``genot
+000343a0: 7970 6573 6060 2076 616c 7565 2069 7320  ypes`` value is 
+000343b0: 6120 6e75 6d70 7920 6172 7261 7920 636f  a numpy array co
+000343c0: 6e74 6169 6e69 6e67 2069 6e64 6578 6573  ntaining indexes
+000343d0: 2069 6e74 6f20 7468 650a 2020 2020 2020   into the.      
+000343e0: 2020 6060 616c 6c65 6c65 7360 6020 6c69    ``alleles`` li
+000343f0: 7374 2e20 4279 2064 6566 6175 6c74 2c20  st. By default, 
+00034400: 7468 6973 206c 6973 7420 6973 2067 656e  this list is gen
+00034410: 6572 6174 6564 2061 7574 6f6d 6174 6963  erated automatic
+00034420: 616c 6c79 2066 6f72 0a20 2020 2020 2020  ally for.       
+00034430: 2065 6163 6820 7369 7465 2073 7563 6820   each site such 
+00034440: 7468 6174 2074 6865 2066 6972 7374 2065  that the first e
+00034450: 6e74 7279 2c20 6060 616c 6c65 6c65 735b  ntry, ``alleles[
+00034460: 305d 6060 2c20 6973 2074 6865 2061 6e63  0]``, is the anc
+00034470: 6573 7472 616c 0a20 2020 2020 2020 2073  estral.        s
+00034480: 7461 7465 2061 6e64 2073 7562 7365 7175  tate and subsequ
+00034490: 656e 7420 616c 6c65 6c65 7320 6172 6520  ent alleles are 
+000344a0: 6c69 7374 6564 2069 6e20 6e6f 0a20 2020  listed in no.   
+000344b0: 2020 2020 2070 6172 7469 6375 6c61 7220       particular 
+000344c0: 6f72 6465 722e 2054 6869 7320 6d65 616e  order. This mean
+000344d0: 7320 7468 6174 2074 6865 2065 6e63 6f64  s that the encod
+000344e0: 696e 6720 6f66 2061 6c6c 656c 6573 2069  ing of alleles i
+000344f0: 6e0a 2020 2020 2020 2020 7465 726d 7320  n.        terms 
+00034500: 6f66 2067 656e 6f74 7970 6520 7661 6c75  of genotype valu
+00034510: 6573 2063 616e 2076 6172 7920 6672 6f6d  es can vary from
+00034520: 2073 6974 652d 746f 2d73 6974 652c 2077   site-to-site, w
+00034530: 6869 6368 2069 730a 2020 2020 2020 2020  hich is.        
+00034540: 736f 6d65 7469 6d65 7320 696e 636f 6e76  sometimes inconv
+00034550: 656e 6965 6e74 2e20 4974 2069 7320 706f  enient. It is po
+00034560: 7373 6962 6c65 2074 6f20 7370 6563 6966  ssible to specif
+00034570: 7920 6120 6669 7865 6420 6d61 7070 696e  y a fixed mappin
+00034580: 670a 2020 2020 2020 2020 6672 6f6d 2061  g.        from a
+00034590: 6c6c 656c 6520 7374 7269 6e67 7320 746f  llele strings to
+000345a0: 2067 656e 6f74 7970 6520 7661 6c75 6573   genotype values
+000345b0: 2075 7369 6e67 2074 6865 2060 6061 6c6c   using the ``all
+000345c0: 656c 6573 6060 0a20 2020 2020 2020 2070  eles``.        p
+000345d0: 6172 616d 6574 6572 2e20 466f 7220 6578  arameter. For ex
+000345e0: 616d 706c 652c 2069 6620 7765 2073 6574  ample, if we set
+000345f0: 2060 6061 6c6c 656c 6573 3d28 2241 222c   ``alleles=("A",
+00034600: 2022 4322 2c20 2247 222c 2022 5422 2960   "C", "G", "T")`
+00034610: 602c 0a20 2020 2020 2020 2074 6869 7320  `,.        this 
+00034620: 7769 6c6c 206d 6170 2061 6c6c 656c 6520  will map allele 
+00034630: 2241 2220 746f 2030 2c20 2243 2220 746f  "A" to 0, "C" to
+00034640: 2031 2061 6e64 2073 6f20 6f6e 2028 7468   1 and so on (th
+00034650: 650a 2020 2020 2020 2020 3a64 6174 613a  e.        :data:
+00034660: 6041 4c4c 454c 4553 5f41 4347 5460 2063  `ALLELES_ACGT` c
+00034670: 6f6e 7374 616e 7420 7072 6f76 6964 6573  onstant provides
+00034680: 2061 2073 686f 7274 6375 7420 666f 7220   a shortcut for 
+00034690: 7468 6973 0a20 2020 2020 2020 2063 6f6d  this.        com
+000346a0: 6d6f 6e20 6d61 7070 696e 6729 2e0a 0a20  mon mapping)... 
+000346b0: 2020 2020 2020 2042 7920 6465 6661 756c         By defaul
+000346c0: 742c 2067 656e 6f74 7970 6573 2061 7265  t, genotypes are
+000346d0: 2067 656e 6572 6174 6564 2066 6f72 2061   generated for a
+000346e0: 6c6c 2073 616d 706c 6573 2e20 5468 6520  ll samples. The 
+000346f0: 6060 7361 6d70 6c65 7360 600a 2020 2020  ``samples``.    
+00034700: 2020 2020 7061 7261 6d65 7465 7220 616c      parameter al
+00034710: 6c6f 7773 2075 7320 746f 2073 7065 6369  lows us to speci
+00034720: 6679 2074 6865 206e 6f64 6573 2066 6f72  fy the nodes for
+00034730: 2077 6869 6368 2067 656e 6f74 7970 6573   which genotypes
+00034740: 2061 7265 0a20 2020 2020 2020 2067 656e   are.        gen
+00034750: 6572 6174 6564 3b20 6f75 7470 7574 206f  erated; output o
+00034760: 7264 6572 206f 6620 6765 6e6f 7479 7065  rder of genotype
+00034770: 7320 696e 2074 6865 2072 6574 7572 6e65  s in the returne
+00034780: 6420 7661 7269 616e 7473 0a20 2020 2020  d variants.     
+00034790: 2020 2063 6f72 7265 7370 6f6e 6473 2074     corresponds t
+000347a0: 6f20 7468 6520 6f72 6465 7220 6f66 2074  o the order of t
+000347b0: 6865 2073 616d 706c 6573 2069 6e20 7468  he samples in th
+000347c0: 6973 206c 6973 742e 2049 7420 6973 2061  is list. It is a
+000347d0: 6c73 6f0a 2020 2020 2020 2020 706f 7373  lso.        poss
+000347e0: 6962 6c65 2074 6f20 7072 6f76 6964 6520  ible to provide 
+000347f0: 2a2a 6e6f 6e2d 7361 6d70 6c65 2a2a 206e  **non-sample** n
+00034800: 6f64 6573 2061 7320 616e 2061 7267 756d  odes as an argum
+00034810: 656e 7420 6865 7265 2c20 6966 2079 6f75  ent here, if you
+00034820: 0a20 2020 2020 2020 2077 6973 6820 746f  .        wish to
+00034830: 2067 656e 6572 6174 6520 6765 6e6f 7479   generate genoty
+00034840: 7065 7320 666f 7220 2865 2e67 2e29 2069  pes for (e.g.) i
+00034850: 6e74 6572 6e61 6c20 6e6f 6465 732e 2048  nternal nodes. H
+00034860: 6f77 6576 6572 2c0a 2020 2020 2020 2020  owever,.        
+00034870: 6060 6973 6f6c 6174 6564 5f61 735f 6d69  ``isolated_as_mi
+00034880: 7373 696e 6760 6020 6d75 7374 2062 6520  ssing`` must be 
+00034890: 4661 6c73 6520 696e 2074 6869 7320 6361  False in this ca
+000348a0: 7365 2c20 6173 2069 7420 6973 206e 6f74  se, as it is not
+000348b0: 0a20 2020 2020 2020 2070 6f73 7369 626c  .        possibl
+000348c0: 6520 746f 2064 6574 6563 7420 6d69 7373  e to detect miss
+000348d0: 696e 6720 6461 7461 2066 6f72 206e 6f6e  ing data for non
+000348e0: 2d73 616d 706c 6520 6e6f 6465 732e 0a0a  -sample nodes...
+000348f0: 2020 2020 2020 2020 4966 2069 736f 6c61          If isola
+00034900: 7465 6420 7361 6d70 6c65 7320 6172 6520  ted samples are 
+00034910: 7072 6573 656e 7420 6174 2061 2067 6976  present at a giv
+00034920: 656e 2073 6974 6520 7769 7468 6f75 7420  en site without 
+00034930: 6d75 7461 7469 6f6e 7320 6162 6f76 6520  mutations above 
+00034940: 7468 656d 2c0a 2020 2020 2020 2020 7468  them,.        th
+00034950: 6579 2061 7265 2069 6e74 6572 7072 6574  ey are interpret
+00034960: 6564 2062 7920 6465 6661 756c 7420 6173  ed by default as
+00034970: 0a20 2020 2020 2020 203a 7265 663a 606d  .        :ref:`m
+00034980: 6973 7369 6e67 2064 6174 613c 7365 635f  issing data<sec_
+00034990: 6461 7461 5f6d 6f64 656c 5f6d 6973 7369  data_model_missi
+000349a0: 6e67 5f64 6174 613e 602c 2061 6e64 2074  ng_data>`, and t
+000349b0: 6865 2067 656e 6f74 7970 6573 2061 7272  he genotypes arr
+000349c0: 6179 0a20 2020 2020 2020 2077 696c 6c20  ay.        will 
+000349d0: 636f 6e74 6169 6e20 6120 7370 6563 6961  contain a specia
+000349e0: 6c20 7661 6c75 6520 3a64 6174 613a 604d  l value :data:`M
+000349f0: 4953 5349 4e47 5f44 4154 4160 2028 2d31  ISSING_DATA` (-1
+00034a00: 2920 746f 2069 6465 6e74 6966 7920 7468  ) to identify th
+00034a10: 656d 0a20 2020 2020 2020 2077 6869 6c65  em.        while
+00034a20: 2074 6865 2060 6061 6c6c 656c 6573 6060   the ``alleles``
+00034a30: 2074 7570 6c65 2077 696c 6c20 656e 6420   tuple will end 
+00034a40: 7769 7468 2074 6865 2076 616c 7565 2060  with the value `
+00034a50: 604e 6f6e 6560 6020 286e 6f74 6520 7468  `None`` (note th
+00034a60: 6174 2074 6869 730a 2020 2020 2020 2020  at this.        
+00034a70: 7769 6c6c 2062 6520 7468 6520 6361 7365  will be the case
+00034a80: 2077 6865 7468 6572 206f 7220 6e6f 7420   whether or not 
+00034a90: 7765 2073 7065 6369 6679 2061 2066 6978  we specify a fix
+00034aa0: 6564 206d 6170 7069 6e67 2075 7369 6e67  ed mapping using
+00034ab0: 2074 6865 0a20 2020 2020 2020 2060 6061   the.        ``a
+00034ac0: 6c6c 656c 6573 6060 2070 6172 616d 6574  lleles`` paramet
+00034ad0: 6572 3b20 7365 6520 7468 6520 3a63 6c61  er; see the :cla
+00034ae0: 7373 3a60 5661 7269 616e 7460 2063 6c61  ss:`Variant` cla
+00034af0: 7373 2066 6f72 206d 6f72 6520 6465 7461  ss for more deta
+00034b00: 696c 7329 2e0a 2020 2020 2020 2020 416c  ils)..        Al
+00034b10: 7465 726e 6174 6976 656c 792c 2069 6620  ternatively, if 
+00034b20: 6060 6973 6f6c 6174 6564 5f61 735f 6d69  ``isolated_as_mi
+00034b30: 7373 696e 6760 6020 6973 2073 6574 2074  ssing`` is set t
+00034b40: 6f20 746f 2046 616c 7365 2c20 7375 6368  o to False, such
+00034b50: 2069 736f 6c61 7465 640a 2020 2020 2020   isolated.      
+00034b60: 2020 7361 6d70 6c65 7320 7769 6c6c 206e    samples will n
+00034b70: 6f74 2062 6520 7472 6561 7465 6420 6173  ot be treated as
+00034b80: 206d 6973 7369 6e67 2c20 616e 6420 696e   missing, and in
+00034b90: 7374 6561 6420 6173 7369 676e 6564 2074  stead assigned t
+00034ba0: 6865 2061 6e63 6573 7472 616c 0a20 2020  he ancestral.   
+00034bb0: 2020 2020 2073 7461 7465 2028 7468 6973       state (this
+00034bc0: 2077 6173 2074 6865 2064 6566 6175 6c74   was the default
+00034bd0: 2062 6568 6176 696f 7572 2069 6e20 7665   behaviour in ve
+00034be0: 7273 696f 6e73 2070 7269 6f72 2074 6f20  rsions prior to 
+00034bf0: 302e 322e 3029 2e20 5072 696f 7220 746f  0.2.0). Prior to
+00034c00: 0a20 2020 2020 2020 2030 2e33 2e30 2074  .        0.3.0 t
+00034c10: 6865 2060 696d 7075 7465 5f6d 6973 7369  he `impute_missi
+00034c20: 6e67 5f64 6174 6160 2061 7267 756d 656e  ng_data` argumen
+00034c30: 7420 636f 6e74 726f 6c6c 6564 2074 6869  t controlled thi
+00034c40: 7320 6265 6861 7669 6f75 722e 0a0a 2020  s behaviour...  
+00034c50: 2020 2020 2020 3a70 6172 616d 2061 7272        :param arr
+00034c60: 6179 5f6c 696b 6520 7361 6d70 6c65 733a  ay_like samples:
+00034c70: 2041 6e20 6172 7261 7920 6f66 206e 6f64   An array of nod
+00034c80: 6520 4944 7320 666f 7220 7768 6963 6820  e IDs for which 
+00034c90: 746f 2067 656e 6572 6174 650a 2020 2020  to generate.    
+00034ca0: 2020 2020 2020 2020 6765 6e6f 7479 7065          genotype
+00034cb0: 732c 206f 7220 4e6f 6e65 2066 6f72 2061  s, or None for a
+00034cc0: 6c6c 2073 616d 706c 6520 6e6f 6465 732e  ll sample nodes.
+00034cd0: 2044 6566 6175 6c74 3a20 4e6f 6e65 2e0a   Default: None..
+00034ce0: 2020 2020 2020 2020 3a70 6172 616d 2062          :param b
+00034cf0: 6f6f 6c20 6973 6f6c 6174 6564 5f61 735f  ool isolated_as_
+00034d00: 6d69 7373 696e 673a 2049 6620 5472 7565  missing: If True
+00034d10: 2c20 7468 6520 6765 6e6f 7479 7065 2076  , the genotype v
+00034d20: 616c 7565 2061 7373 6967 6e65 6420 746f  alue assigned to
+00034d30: 0a20 2020 2020 2020 2020 2020 206d 6973  .            mis
+00034d40: 7369 6e67 2073 616d 706c 6573 2028 692e  sing samples (i.
+00034d50: 652e 2c20 6973 6f6c 6174 6564 2073 616d  e., isolated sam
+00034d60: 706c 6573 2077 6974 686f 7574 206d 7574  ples without mut
+00034d70: 6174 696f 6e73 2920 6973 0a20 2020 2020  ations) is.     
+00034d80: 2020 2020 2020 203a 6461 7461 3a60 2e4d         :data:`.M
+00034d90: 4953 5349 4e47 5f44 4154 4160 2028 2d31  ISSING_DATA` (-1
+00034da0: 292e 2049 6620 4661 6c73 652c 206d 6973  ). If False, mis
+00034db0: 7369 6e67 2073 616d 706c 6573 2077 696c  sing samples wil
+00034dc0: 6c20 6265 0a20 2020 2020 2020 2020 2020  l be.           
+00034dd0: 2061 7373 6967 6e65 6420 7468 6520 616c   assigned the al
+00034de0: 6c65 6c65 2069 6e64 6578 2066 6f72 2074  lele index for t
+00034df0: 6865 2061 6e63 6573 7472 616c 2073 7461  he ancestral sta
+00034e00: 7465 2e0a 2020 2020 2020 2020 2020 2020  te..            
+00034e10: 4465 6661 756c 743a 2054 7275 652e 0a20  Default: True.. 
+00034e20: 2020 2020 2020 203a 7061 7261 6d20 7475         :param tu
+00034e30: 706c 6520 616c 6c65 6c65 733a 2041 2074  ple alleles: A t
+00034e40: 7570 6c65 206f 6620 7374 7269 6e67 7320  uple of strings 
+00034e50: 6465 6669 6e69 6e67 2074 6865 2065 6e63  defining the enc
+00034e60: 6f64 696e 6720 6f66 0a20 2020 2020 2020  oding of.       
+00034e70: 2020 2020 2061 6c6c 656c 6573 2061 7320       alleles as 
+00034e80: 696e 7465 6765 7220 6765 6e6f 7479 7065  integer genotype
+00034e90: 2076 616c 7565 732e 2041 7420 6c65 6173   values. At leas
+00034ea0: 7420 6f6e 6520 616c 6c65 6c65 206d 7573  t one allele mus
+00034eb0: 7420 6265 2070 726f 7669 6465 642e 0a20  t be provided.. 
+00034ec0: 2020 2020 2020 2020 2020 2049 6620 6475             If du
+00034ed0: 706c 6963 6174 6520 616c 6c65 6c65 7320  plicate alleles 
+00034ee0: 6172 6520 7072 6f76 6964 6564 2c20 6f75  are provided, ou
+00034ef0: 7470 7574 2067 656e 6f74 7970 6573 2077  tput genotypes w
+00034f00: 696c 6c20 616c 7761 7973 2062 650a 2020  ill always be.  
+00034f10: 2020 2020 2020 2020 2020 656e 636f 6465            encode
+00034f20: 6420 6173 2074 6865 2066 6972 7374 206f  d as the first o
+00034f30: 6363 7572 7265 6e63 6520 6f66 2074 6865  ccurrence of the
+00034f40: 2061 6c6c 656c 652e 2049 6620 4e6f 6e65   allele. If None
+00034f50: 2028 7468 6520 6465 6661 756c 7429 2c0a   (the default),.
+00034f60: 2020 2020 2020 2020 2020 2020 7468 6520              the 
+00034f70: 616c 6c65 6c65 7320 6172 6520 656e 636f  alleles are enco
+00034f80: 6465 6420 6173 2074 6865 7920 6172 6520  ded as they are 
+00034f90: 656e 636f 756e 7465 7265 6420 6475 7269  encountered duri
+00034fa0: 6e67 2067 656e 6f74 7970 650a 2020 2020  ng genotype.    
+00034fb0: 2020 2020 2020 2020 6765 6e65 7261 7469          generati
+00034fc0: 6f6e 2e0a 2020 2020 2020 2020 3a70 6172  on..        :par
+00034fd0: 616d 2062 6f6f 6c20 696d 7075 7465 5f6d  am bool impute_m
+00034fe0: 6973 7369 6e67 5f64 6174 613a 0a20 2020  issing_data:.   
+00034ff0: 2020 2020 2020 2020 202a 4465 7072 6563           *Deprec
+00035000: 6174 6564 2069 6e20 302e 332e 302e 2055  ated in 0.3.0. U
+00035010: 7365 2060 6069 736f 6c61 7465 645f 6173  se ``isolated_as
+00035020: 5f6d 6973 7369 6e67 6060 2c20 6275 7420  _missing``, but 
+00035030: 696e 7665 7274 696e 6720 7661 6c75 652e  inverting value.
+00035040: 0a20 2020 2020 2020 2020 2020 2057 696c  .            Wil
+00035050: 6c20 6265 2072 656d 6f76 6564 2069 6e20  l be removed in 
+00035060: 6120 6675 7475 7265 2076 6572 7369 6f6e  a future version
+00035070: 2a0a 2020 2020 2020 2020 3a70 6172 616d  *.        :param
+00035080: 2062 6f6f 6c20 636f 7079 3a0a 2020 2020   bool copy:.    
+00035090: 2020 2020 2020 2020 4966 2046 616c 7365          If False
+000350a0: 2072 652d 7573 6520 7468 6520 7361 6d65   re-use the same
+000350b0: 2056 6172 6961 6e74 206f 626a 6563 7420   Variant object 
+000350c0: 666f 7220 6561 6368 2073 6974 6520 7375  for each site su
+000350d0: 6368 2074 6861 7420 616e 790a 2020 2020  ch that any.    
+000350e0: 2020 2020 2020 2020 7265 6665 7265 6e63          referenc
+000350f0: 6573 2068 656c 6420 746f 2069 7420 6172  es held to it ar
+00035100: 6520 6f76 6572 7772 6974 7465 6e20 7768  e overwritten wh
+00035110: 656e 2074 6865 206e 6578 7420 7369 7465  en the next site
+00035120: 2069 7320 7669 7369 7465 642e 0a20 2020   is visited..   
+00035130: 2020 2020 2020 2020 2049 6620 5472 7565           If True
+00035140: 2072 6574 7572 6e20 6120 6672 6573 6820   return a fresh 
+00035150: 3a63 6c61 7373 3a60 5661 7269 616e 7460  :class:`Variant`
+00035160: 2066 6f72 2065 6163 6820 7369 7465 2e20   for each site. 
+00035170: 4465 6661 756c 743a 2054 7275 652e 0a20  Default: True.. 
+00035180: 2020 2020 2020 203a 7061 7261 6d20 696e         :param in
+00035190: 7420 6c65 6674 3a20 5374 6172 7420 7769  t left: Start wi
+000351a0: 7468 2074 6865 2066 6972 7374 2073 6974  th the first sit
+000351b0: 6520 6174 206f 7220 6166 7465 720a 2020  e at or after.  
+000351c0: 2020 2020 2020 2020 2020 7468 6973 2067            this g
+000351d0: 656e 6f6d 6963 2070 6f73 6974 696f 6e2e  enomic position.
+000351e0: 2049 6620 6060 4e6f 6e65 6060 2028 6465   If ``None`` (de
+000351f0: 6661 756c 7429 2073 7461 7274 2061 7420  fault) start at 
+00035200: 7468 6520 6669 7273 7420 7369 7465 2e0a  the first site..
+00035210: 2020 2020 2020 2020 3a70 6172 616d 2069          :param i
+00035220: 6e74 2072 6967 6874 3a20 456e 6420 7769  nt right: End wi
+00035230: 7468 2074 6865 206c 6173 7420 7369 7465  th the last site
+00035240: 2062 6566 6f72 6520 7468 6973 2070 6f73   before this pos
+00035250: 6974 696f 6e2e 2049 6620 6060 4e6f 6e65  ition. If ``None
+00035260: 6060 0a20 2020 2020 2020 2020 2020 2028  ``.            (
+00035270: 6465 6661 756c 7429 2061 7373 756d 6520  default) assume 
+00035280: 6060 7269 6768 7460 6020 6973 2074 6865  ``right`` is the
+00035290: 2073 6571 7565 6e63 6520 6c65 6e67 7468   sequence length
+000352a0: 2c20 736f 2074 6861 7420 7468 6520 6c61  , so that the la
+000352b0: 7374 0a20 2020 2020 2020 2020 2020 2076  st.            v
+000352c0: 6172 6961 6e74 2063 6f72 7265 7370 6f6e  ariant correspon
+000352d0: 6473 2074 6f20 7468 6520 6c61 7374 2073  ds to the last s
+000352e0: 6974 6520 696e 2074 6865 2074 7265 6520  ite in the tree 
+000352f0: 7365 7175 656e 6365 2e0a 2020 2020 2020  sequence..      
+00035300: 2020 3a72 6574 7572 6e3a 2041 6e20 6974    :return: An it
+00035310: 6572 6174 6f72 206f 7665 7220 616c 6c20  erator over all 
+00035320: 7661 7269 616e 7473 2069 6e20 7468 6973  variants in this
+00035330: 2074 7265 6520 7365 7175 656e 6365 2e0a   tree sequence..
+00035340: 2020 2020 2020 2020 3a72 7479 7065 3a20          :rtype: 
+00035350: 6974 6572 283a 636c 6173 733a 6056 6172  iter(:class:`Var
+00035360: 6961 6e74 6029 0a20 2020 2020 2020 2022  iant`).        "
+00035370: 2222 0a20 2020 2020 2020 2069 6e74 6572  "".        inter
+00035380: 7661 6c20 3d20 7365 6c66 2e5f 6368 6563  val = self._chec
+00035390: 6b5f 6765 6e6f 6d69 635f 7261 6e67 6528  k_genomic_range(
+000353a0: 6c65 6674 2c20 7269 6768 7429 0a20 2020  left, right).   
+000353b0: 2020 2020 2069 6620 696d 7075 7465 5f6d       if impute_m
+000353c0: 6973 7369 6e67 5f64 6174 6120 6973 206e  issing_data is n
+000353d0: 6f74 204e 6f6e 653a 0a20 2020 2020 2020  ot None:.       
+000353e0: 2020 2020 2077 6172 6e69 6e67 732e 7761       warnings.wa
+000353f0: 726e 280a 2020 2020 2020 2020 2020 2020  rn(.            
+00035400: 2020 2020 2254 6865 2069 6d70 7574 655f      "The impute_
+00035410: 6d69 7373 696e 675f 6461 7461 2070 6172  missing_data par
+00035420: 616d 6574 6572 2077 6173 2064 6570 7265  ameter was depre
+00035430: 6361 7465 6420 696e 2030 2e33 2e30 2061  cated in 0.3.0 a
+00035440: 6e64 2077 696c 6c22 0a20 2020 2020 2020  nd will".       
+00035450: 2020 2020 2020 2020 2022 2062 6520 7265           " be re
+00035460: 6d6f 7665 642e 2055 7365 2060 6069 736f  moved. Use ``iso
+00035470: 6c61 7465 645f 6173 5f6d 6973 7369 6e67  lated_as_missing
+00035480: 3d46 616c 7365 6060 2069 6e73 7465 6164  =False`` instead
+00035490: 206f 6622 0a20 2020 2020 2020 2020 2020   of".           
+000354a0: 2020 2020 2022 6060 696d 7075 7465 5f6d       "``impute_m
+000354b0: 6973 7369 6e67 5f64 6174 613d 5472 7565  issing_data=True
+000354c0: 6060 2e22 2c0a 2020 2020 2020 2020 2020  ``.",.          
+000354d0: 2020 2020 2020 4675 7475 7265 5761 726e        FutureWarn
+000354e0: 696e 672c 0a20 2020 2020 2020 2020 2020  ing,.           
+000354f0: 2029 0a20 2020 2020 2020 2023 204f 6e6c   ).        # Onl
+00035500: 7920 7573 6520 696d 7075 7465 5f6d 6973  y use impute_mis
+00035510: 7369 6e67 5f64 6174 6120 6966 2069 736f  sing_data if iso
+00035520: 6c61 7465 645f 6173 5f6d 6973 7369 6e67  lated_as_missing
+00035530: 2068 6173 2074 6865 2064 6566 6175 6c74   has the default
+00035540: 2076 616c 7565 0a20 2020 2020 2020 2069   value.        i
+00035550: 6620 6973 6f6c 6174 6564 5f61 735f 6d69  f isolated_as_mi
+00035560: 7373 696e 6720 6973 204e 6f6e 653a 0a20  ssing is None:. 
+00035570: 2020 2020 2020 2020 2020 2069 736f 6c61             isola
+00035580: 7465 645f 6173 5f6d 6973 7369 6e67 203d  ted_as_missing =
+00035590: 206e 6f74 2069 6d70 7574 655f 6d69 7373   not impute_miss
+000355a0: 696e 675f 6461 7461 0a20 2020 2020 2020  ing_data.       
+000355b0: 2069 6620 636f 7079 2069 7320 4e6f 6e65   if copy is None
+000355c0: 3a0a 2020 2020 2020 2020 2020 2020 636f  :.            co
+000355d0: 7079 203d 2054 7275 650a 2020 2020 2020  py = True.      
+000355e0: 2020 2320 5365 6520 636f 6d6d 656e 7473    # See comments
+000355f0: 2066 6f72 2074 6865 2056 6172 6961 6e74   for the Variant
+00035600: 2074 7970 6520 666f 7220 6469 7363 7573   type for discus
+00035610: 7369 6f6e 206f 6e20 7768 7920 7468 650a  sion on why the.
+00035620: 2020 2020 2020 2020 2320 7072 6573 656e          # presen
+00035630: 7420 666f 726d 2077 6173 2063 686f 7365  t form was chose
+00035640: 6e2e 0a20 2020 2020 2020 2076 6172 6961  n..        varia
+00035650: 6e74 203d 2074 736b 6974 2e56 6172 6961  nt = tskit.Varia
+00035660: 6e74 280a 2020 2020 2020 2020 2020 2020  nt(.            
+00035670: 7365 6c66 2c0a 2020 2020 2020 2020 2020  self,.          
+00035680: 2020 7361 6d70 6c65 733d 7361 6d70 6c65    samples=sample
+00035690: 732c 0a20 2020 2020 2020 2020 2020 2069  s,.            i
+000356a0: 736f 6c61 7465 645f 6173 5f6d 6973 7369  solated_as_missi
+000356b0: 6e67 3d69 736f 6c61 7465 645f 6173 5f6d  ng=isolated_as_m
+000356c0: 6973 7369 6e67 2c0a 2020 2020 2020 2020  issing,.        
+000356d0: 2020 2020 616c 6c65 6c65 733d 616c 6c65      alleles=alle
+000356e0: 6c65 732c 0a20 2020 2020 2020 2029 0a20  les,.        ). 
+000356f0: 2020 2020 2020 2069 6620 6c65 6674 203d         if left =
+00035700: 3d20 3020 616e 6420 7269 6768 7420 3d3d  = 0 and right ==
+00035710: 2073 656c 662e 7365 7175 656e 6365 5f6c   self.sequence_l
+00035720: 656e 6774 683a 0a20 2020 2020 2020 2020  ength:.         
+00035730: 2020 2073 7461 7274 203d 2030 0a20 2020     start = 0.   
+00035740: 2020 2020 2020 2020 2073 746f 7020 3d20           stop = 
+00035750: 7365 6c66 2e6e 756d 5f73 6974 6573 0a20  self.num_sites. 
+00035760: 2020 2020 2020 2065 6c73 653a 0a20 2020         else:.   
+00035770: 2020 2020 2020 2020 2073 7461 7274 2c20           start, 
+00035780: 7374 6f70 203d 206e 702e 7365 6172 6368  stop = np.search
+00035790: 736f 7274 6564 2873 656c 662e 7369 7465  sorted(self.site
+000357a0: 735f 706f 7369 7469 6f6e 2c20 696e 7465  s_position, inte
+000357b0: 7276 616c 290a 0a20 2020 2020 2020 2069  rval)..        i
+000357c0: 6620 636f 7079 3a0a 2020 2020 2020 2020  f copy:.        
+000357d0: 2020 2020 666f 7220 7369 7465 5f69 6420      for site_id 
+000357e0: 696e 2072 616e 6765 2873 7461 7274 2c20  in range(start, 
+000357f0: 7374 6f70 293a 0a20 2020 2020 2020 2020  stop):.         
+00035800: 2020 2020 2020 2076 6172 6961 6e74 2e64         variant.d
+00035810: 6563 6f64 6528 7369 7465 5f69 6429 0a20  ecode(site_id). 
+00035820: 2020 2020 2020 2020 2020 2020 2020 2079                 y
+00035830: 6965 6c64 2076 6172 6961 6e74 2e63 6f70  ield variant.cop
+00035840: 7928 290a 2020 2020 2020 2020 656c 7365  y().        else
+00035850: 3a0a 2020 2020 2020 2020 2020 2020 666f  :.            fo
+00035860: 7220 7369 7465 5f69 6420 696e 2072 616e  r site_id in ran
+00035870: 6765 2873 7461 7274 2c20 7374 6f70 293a  ge(start, stop):
+00035880: 0a20 2020 2020 2020 2020 2020 2020 2020  .               
+00035890: 2076 6172 6961 6e74 2e64 6563 6f64 6528   variant.decode(
+000358a0: 7369 7465 5f69 6429 0a20 2020 2020 2020  site_id).       
+000358b0: 2020 2020 2020 2020 2079 6965 6c64 2076           yield v
+000358c0: 6172 6961 6e74 0a0a 2020 2020 6465 6620  ariant..    def 
+000358d0: 6765 6e6f 7479 7065 5f6d 6174 7269 7828  genotype_matrix(
+000358e0: 0a20 2020 2020 2020 2073 656c 662c 0a20  .        self,. 
+000358f0: 2020 2020 2020 202a 2c0a 2020 2020 2020         *,.      
+00035900: 2020 7361 6d70 6c65 733d 4e6f 6e65 2c0a    samples=None,.
+00035910: 2020 2020 2020 2020 6973 6f6c 6174 6564          isolated
+00035920: 5f61 735f 6d69 7373 696e 673d 4e6f 6e65  _as_missing=None
+00035930: 2c0a 2020 2020 2020 2020 616c 6c65 6c65  ,.        allele
+00035940: 733d 4e6f 6e65 2c0a 2020 2020 2020 2020  s=None,.        
+00035950: 696d 7075 7465 5f6d 6973 7369 6e67 5f64  impute_missing_d
+00035960: 6174 613d 4e6f 6e65 2c0a 2020 2020 293a  ata=None,.    ):
+00035970: 0a20 2020 2020 2020 2022 2222 0a20 2020  .        """.   
+00035980: 2020 2020 2052 6574 7572 6e73 2061 6e20       Returns an 
+00035990: 3a6d 6174 683a 606d 205c 5c74 696d 6573  :math:`m \\times
+000359a0: 206e 6020 6e75 6d70 7920 6172 7261 7920   n` numpy array 
+000359b0: 6f66 2074 6865 2067 656e 6f74 7970 6573  of the genotypes
+000359c0: 2069 6e20 7468 6973 0a20 2020 2020 2020   in this.       
+000359d0: 2074 7265 6520 7365 7175 656e 6365 2c20   tree sequence, 
+000359e0: 7768 6572 6520 3a6d 6174 683a 606d 6020  where :math:`m` 
+000359f0: 6973 2074 6865 206e 756d 6265 7220 6f66  is the number of
+00035a00: 2073 6974 6573 2061 6e64 203a 6d61 7468   sites and :math
+00035a10: 3a60 6e60 0a20 2020 2020 2020 2074 6865  :`n`.        the
+00035a20: 206e 756d 6265 7220 6f66 2073 616d 706c   number of sampl
+00035a30: 6573 2e20 5468 6520 6765 6e6f 7479 7065  es. The genotype
+00035a40: 7320 6172 6520 7468 6520 696e 6465 7865  s are the indexe
+00035a50: 7320 696e 746f 2074 6865 2061 7272 6179  s into the array
+00035a60: 0a20 2020 2020 2020 206f 6620 6060 616c  .        of ``al
+00035a70: 6c65 6c65 7360 602c 2061 7320 6465 7363  leles``, as desc
+00035a80: 7269 6265 6420 666f 7220 7468 6520 3a63  ribed for the :c
+00035a90: 6c61 7373 3a60 5661 7269 616e 7460 2063  lass:`Variant` c
+00035aa0: 6c61 7373 2e0a 0a20 2020 2020 2020 2049  lass...        I
+00035ab0: 6620 6973 6f6c 6174 6564 2073 616d 706c  f isolated sampl
+00035ac0: 6573 2061 7265 2070 7265 7365 6e74 2061  es are present a
+00035ad0: 7420 6120 6769 7665 6e20 7369 7465 2077  t a given site w
+00035ae0: 6974 686f 7574 206d 7574 6174 696f 6e73  ithout mutations
+00035af0: 2061 626f 7665 2074 6865 6d2c 0a20 2020   above them,.   
+00035b00: 2020 2020 2074 6865 7920 7769 6c6c 2062       they will b
+00035b10: 6520 696e 7465 7270 7265 7465 6420 6173  e interpreted as
+00035b20: 203a 7265 663a 606d 6973 7369 6e67 2064   :ref:`missing d
+00035b30: 6174 613c 7365 635f 6461 7461 5f6d 6f64  ata<sec_data_mod
+00035b40: 656c 5f6d 6973 7369 6e67 5f64 6174 613e  el_missing_data>
+00035b50: 600a 2020 2020 2020 2020 7468 6520 6765  `.        the ge
+00035b60: 6e6f 7479 7065 7320 6172 7261 7920 7769  notypes array wi
+00035b70: 6c6c 2063 6f6e 7461 696e 2061 2073 7065  ll contain a spe
+00035b80: 6369 616c 2076 616c 7565 203a 6461 7461  cial value :data
+00035b90: 3a60 4d49 5353 494e 475f 4441 5441 600a  :`MISSING_DATA`.
+00035ba0: 2020 2020 2020 2020 282d 3129 2074 6f20          (-1) to 
+00035bb0: 6964 656e 7469 6679 2074 6865 7365 206d  identify these m
+00035bc0: 6973 7369 6e67 2073 616d 706c 6573 2e0a  issing samples..
+00035bd0: 0a20 2020 2020 2020 2053 7563 6820 7361  .        Such sa
+00035be0: 6d70 6c65 7320 6172 6520 7472 6561 7465  mples are treate
+00035bf0: 6420 6173 206d 6973 7369 6e67 2064 6174  d as missing dat
+00035c00: 6120 6279 2064 6566 6175 6c74 2c20 6275  a by default, bu
+00035c10: 7420 6966 0a20 2020 2020 2020 2060 6069  t if.        ``i
+00035c20: 736f 6c61 7465 645f 6173 5f6d 6973 7369  solated_as_missi
+00035c30: 6e67 6060 2069 7320 7365 7420 746f 2074  ng`` is set to t
+00035c40: 6f20 4661 6c73 652c 2074 6865 7920 7769  o False, they wi
+00035c50: 6c6c 206e 6f74 2062 6520 7472 6561 7465  ll not be treate
+00035c60: 6420 6173 206d 6973 7369 6e67 2c0a 2020  d as missing,.  
+00035c70: 2020 2020 2020 616e 6420 736f 2061 7373        and so ass
+00035c80: 6967 6e65 6420 7468 6520 616e 6365 7374  igned the ancest
+00035c90: 7261 6c20 7374 6174 652e 2054 6869 7320  ral state. This 
+00035ca0: 7761 7320 7468 6520 6465 6661 756c 7420  was the default 
+00035cb0: 6265 6861 7669 6f75 7220 696e 0a20 2020  behaviour in.   
+00035cc0: 2020 2020 2076 6572 7369 6f6e 7320 7072       versions pr
+00035cd0: 696f 7220 746f 2030 2e32 2e30 2e20 5072  ior to 0.2.0. Pr
+00035ce0: 696f 7220 746f 2030 2e33 2e30 2074 6865  ior to 0.3.0 the
+00035cf0: 2060 696d 7075 7465 5f6d 6973 7369 6e67   `impute_missing
+00035d00: 5f64 6174 6160 0a20 2020 2020 2020 2061  _data`.        a
+00035d10: 7267 756d 656e 7420 636f 6e74 726f 6c6c  rgument controll
+00035d20: 6564 2074 6869 7320 6265 6861 7669 6f75  ed this behaviou
+00035d30: 722e 0a0a 2020 2020 2020 2020 2e2e 2077  r...        .. w
+00035d40: 6172 6e69 6e67 3a3a 0a20 2020 2020 2020  arning::.       
+00035d50: 2020 2020 2054 6869 7320 6d65 7468 6f64       This method
+00035d60: 2063 616e 2063 6f6e 7375 6d65 2061 202a   can consume a *
+00035d70: 2a76 6572 7920 6c61 7267 652a 2a20 616d  *very large** am
+00035d80: 6f75 6e74 206f 6620 6d65 6d6f 7279 2120  ount of memory! 
+00035d90: 4966 0a20 2020 2020 2020 2020 2020 2061  If.            a
+00035da0: 6c6c 2067 656e 6f74 7970 6573 2061 7265  ll genotypes are
+00035db0: 206e 6f74 206e 6565 6465 6420 6174 206f   not needed at o
+00035dc0: 6e63 652c 2069 7420 6973 2075 7375 616c  nce, it is usual
+00035dd0: 6c79 2062 6574 7465 7220 746f 0a20 2020  ly better to.   
+00035de0: 2020 2020 2020 2020 2061 6363 6573 7320           access 
+00035df0: 7468 656d 2073 6571 7565 6e74 6961 6c6c  them sequentiall
+00035e00: 7920 7573 696e 6720 7468 6520 3a6d 6574  y using the :met
+00035e10: 683a 602e 7661 7269 616e 7473 6020 6974  h:`.variants` it
+00035e20: 6572 6174 6f72 2e0a 0a20 2020 2020 2020  erator...       
+00035e30: 203a 7061 7261 6d20 6172 7261 795f 6c69   :param array_li
+00035e40: 6b65 2073 616d 706c 6573 3a20 416e 2061  ke samples: An a
+00035e50: 7272 6179 206f 6620 6e6f 6465 2049 4473  rray of node IDs
+00035e60: 2066 6f72 2077 6869 6368 2074 6f20 6765   for which to ge
+00035e70: 6e65 7261 7465 0a20 2020 2020 2020 2020  nerate.         
+00035e80: 2020 2067 656e 6f74 7970 6573 2c20 6f72     genotypes, or
+00035e90: 204e 6f6e 6520 666f 7220 616c 6c20 7361   None for all sa
+00035ea0: 6d70 6c65 206e 6f64 6573 2e20 4465 6661  mple nodes. Defa
+00035eb0: 756c 743a 204e 6f6e 652e 0a20 2020 2020  ult: None..     
+00035ec0: 2020 203a 7061 7261 6d20 626f 6f6c 2069     :param bool i
+00035ed0: 736f 6c61 7465 645f 6173 5f6d 6973 7369  solated_as_missi
+00035ee0: 6e67 3a20 4966 2054 7275 652c 2074 6865  ng: If True, the
+00035ef0: 2067 656e 6f74 7970 6520 7661 6c75 6520   genotype value 
+00035f00: 6173 7369 676e 6564 2074 6f0a 2020 2020  assigned to.    
+00035f10: 2020 2020 2020 2020 6d69 7373 696e 6720          missing 
+00035f20: 7361 6d70 6c65 7320 2869 2e65 2e2c 2069  samples (i.e., i
+00035f30: 736f 6c61 7465 6420 7361 6d70 6c65 7320  solated samples 
+00035f40: 7769 7468 6f75 7420 6d75 7461 7469 6f6e  without mutation
+00035f50: 7329 2069 730a 2020 2020 2020 2020 2020  s) is.          
+00035f60: 2020 3a64 6174 613a 602e 4d49 5353 494e    :data:`.MISSIN
+00035f70: 475f 4441 5441 6020 282d 3129 2e20 4966  G_DATA` (-1). If
+00035f80: 2046 616c 7365 2c20 6d69 7373 696e 6720   False, missing 
+00035f90: 7361 6d70 6c65 7320 7769 6c6c 2062 650a  samples will be.
+00035fa0: 2020 2020 2020 2020 2020 2020 6173 7369              assi
+00035fb0: 676e 6564 2074 6865 2061 6c6c 656c 6520  gned the allele 
+00035fc0: 696e 6465 7820 666f 7220 7468 6520 616e  index for the an
+00035fd0: 6365 7374 7261 6c20 7374 6174 652e 0a20  cestral state.. 
+00035fe0: 2020 2020 2020 2020 2020 2044 6566 6175             Defau
+00035ff0: 6c74 3a20 5472 7565 2e0a 2020 2020 2020  lt: True..      
+00036000: 2020 3a70 6172 616d 2074 7570 6c65 2061    :param tuple a
+00036010: 6c6c 656c 6573 3a20 4120 7475 706c 6520  lleles: A tuple 
+00036020: 6f66 2073 7472 696e 6773 2064 6573 6372  of strings descr
+00036030: 6962 696e 6720 7468 6520 656e 636f 6469  ibing the encodi
+00036040: 6e67 206f 660a 2020 2020 2020 2020 2020  ng of.          
+00036050: 2020 616c 6c65 6c65 7320 746f 2067 656e    alleles to gen
+00036060: 6f74 7970 6520 7661 6c75 6573 2e20 4174  otype values. At
+00036070: 206c 6561 7374 206f 6e65 2061 6c6c 656c   least one allel
+00036080: 6520 6d75 7374 2062 6520 7072 6f76 6964  e must be provid
+00036090: 6564 2e0a 2020 2020 2020 2020 2020 2020  ed..            
+000360a0: 4966 2064 7570 6c69 6361 7465 2061 6c6c  If duplicate all
+000360b0: 656c 6573 2061 7265 2070 726f 7669 6465  eles are provide
+000360c0: 642c 206f 7574 7075 7420 6765 6e6f 7479  d, output genoty
+000360d0: 7065 7320 7769 6c6c 2061 6c77 6179 7320  pes will always 
+000360e0: 6265 0a20 2020 2020 2020 2020 2020 2065  be.            e
+000360f0: 6e63 6f64 6564 2061 7320 7468 6520 6669  ncoded as the fi
+00036100: 7273 7420 6f63 6375 7272 656e 6365 206f  rst occurrence o
+00036110: 6620 7468 6520 616c 6c65 6c65 2e20 4966  f the allele. If
+00036120: 204e 6f6e 6520 2874 6865 2064 6566 6175   None (the defau
+00036130: 6c74 292c 0a20 2020 2020 2020 2020 2020  lt),.           
+00036140: 2074 6865 2061 6c6c 656c 6573 2061 7265   the alleles are
+00036150: 2065 6e63 6f64 6564 2061 7320 7468 6579   encoded as they
+00036160: 2061 7265 2065 6e63 6f75 6e74 6572 6564   are encountered
+00036170: 2064 7572 696e 6720 6765 6e6f 7479 7065   during genotype
+00036180: 0a20 2020 2020 2020 2020 2020 2067 656e  .            gen
+00036190: 6572 6174 696f 6e2e 0a20 2020 2020 2020  eration..       
+000361a0: 203a 7061 7261 6d20 626f 6f6c 2069 6d70   :param bool imp
+000361b0: 7574 655f 6d69 7373 696e 675f 6461 7461  ute_missing_data
+000361c0: 3a0a 2020 2020 2020 2020 2020 2020 2a44  :.            *D
+000361d0: 6570 7265 6361 7465 6420 696e 2030 2e33  eprecated in 0.3
+000361e0: 2e30 2e20 5573 6520 6060 6973 6f6c 6174  .0. Use ``isolat
+000361f0: 6564 5f61 735f 6d69 7373 696e 6760 602c  ed_as_missing``,
+00036200: 2062 7574 2069 6e76 6572 7469 6e67 2076   but inverting v
+00036210: 616c 7565 2e0a 2020 2020 2020 2020 2020  alue..          
+00036220: 2020 5769 6c6c 2062 6520 7265 6d6f 7665    Will be remove
+00036230: 6420 696e 2061 2066 7574 7572 6520 7665  d in a future ve
+00036240: 7273 696f 6e2a 0a0a 2020 2020 2020 2020  rsion*..        
+00036250: 3a72 6574 7572 6e3a 2054 6865 2066 756c  :return: The ful
+00036260: 6c20 6d61 7472 6978 206f 6620 6765 6e6f  l matrix of geno
+00036270: 7479 7065 732e 0a20 2020 2020 2020 203a  types..        :
+00036280: 7274 7970 653a 206e 756d 7079 2e6e 6461  rtype: numpy.nda
+00036290: 7272 6179 2028 6474 7970 653d 6e70 2e69  rray (dtype=np.i
+000362a0: 6e74 3332 290a 2020 2020 2020 2020 2222  nt32).        ""
+000362b0: 220a 2020 2020 2020 2020 6966 2069 6d70  ".        if imp
+000362c0: 7574 655f 6d69 7373 696e 675f 6461 7461  ute_missing_data
+000362d0: 2069 7320 6e6f 7420 4e6f 6e65 3a0a 2020   is not None:.  
+000362e0: 2020 2020 2020 2020 2020 7761 726e 696e            warnin
+000362f0: 6773 2e77 6172 6e28 0a20 2020 2020 2020  gs.warn(.       
+00036300: 2020 2020 2020 2020 2022 5468 6520 696d           "The im
+00036310: 7075 7465 5f6d 6973 7369 6e67 5f64 6174  pute_missing_dat
+00036320: 6120 7061 7261 6d65 7465 7220 7761 7320  a parameter was 
+00036330: 6465 7072 6563 6174 6564 2069 6e20 302e  deprecated in 0.
+00036340: 332e 3020 616e 6420 7769 6c6c 220a 2020  3.0 and will".  
+00036350: 2020 2020 2020 2020 2020 2020 2020 2220                " 
+00036360: 6265 2072 656d 6f76 6564 2e20 5573 6520  be removed. Use 
+00036370: 6060 6973 6f6c 6174 6564 5f61 735f 6d69  ``isolated_as_mi
+00036380: 7373 696e 673d 4661 6c73 6560 6020 696e  ssing=False`` in
+00036390: 7374 6561 6420 6f66 220a 2020 2020 2020  stead of".      
+000363a0: 2020 2020 2020 2020 2020 2260 6069 6d70            "``imp
+000363b0: 7574 655f 6d69 7373 696e 675f 6461 7461  ute_missing_data
+000363c0: 3d54 7275 6560 602e 222c 0a20 2020 2020  =True``.",.     
+000363d0: 2020 2020 2020 2020 2020 2046 7574 7572             Futur
+000363e0: 6557 6172 6e69 6e67 2c0a 2020 2020 2020  eWarning,.      
+000363f0: 2020 2020 2020 290a 2020 2020 2020 2020        ).        
+00036400: 2320 4f6e 6c79 2075 7365 2069 6d70 7574  # Only use imput
+00036410: 655f 6d69 7373 696e 675f 6461 7461 2069  e_missing_data i
+00036420: 6620 6973 6f6c 6174 6564 5f61 735f 6d69  f isolated_as_mi
+00036430: 7373 696e 6720 6861 7320 7468 6520 6465  ssing has the de
+00036440: 6661 756c 7420 7661 6c75 650a 2020 2020  fault value.    
+00036450: 2020 2020 6966 2069 736f 6c61 7465 645f      if isolated_
+00036460: 6173 5f6d 6973 7369 6e67 2069 7320 4e6f  as_missing is No
+00036470: 6e65 3a0a 2020 2020 2020 2020 2020 2020  ne:.            
+00036480: 6973 6f6c 6174 6564 5f61 735f 6d69 7373  isolated_as_miss
+00036490: 696e 6720 3d20 6e6f 7420 696d 7075 7465  ing = not impute
+000364a0: 5f6d 6973 7369 6e67 5f64 6174 610a 0a20  _missing_data.. 
+000364b0: 2020 2020 2020 2076 6172 6961 6e74 203d         variant =
+000364c0: 2074 736b 6974 2e56 6172 6961 6e74 280a   tskit.Variant(.
+000364d0: 2020 2020 2020 2020 2020 2020 7365 6c66              self
+000364e0: 2c0a 2020 2020 2020 2020 2020 2020 7361  ,.            sa
+000364f0: 6d70 6c65 733d 7361 6d70 6c65 732c 0a20  mples=samples,. 
+00036500: 2020 2020 2020 2020 2020 2069 736f 6c61             isola
+00036510: 7465 645f 6173 5f6d 6973 7369 6e67 3d69  ted_as_missing=i
+00036520: 736f 6c61 7465 645f 6173 5f6d 6973 7369  solated_as_missi
+00036530: 6e67 2c0a 2020 2020 2020 2020 2020 2020  ng,.            
+00036540: 616c 6c65 6c65 733d 616c 6c65 6c65 732c  alleles=alleles,
+00036550: 0a20 2020 2020 2020 2029 0a0a 2020 2020  .        )..    
+00036560: 2020 2020 6e75 6d5f 7361 6d70 6c65 7320      num_samples 
+00036570: 3d20 7365 6c66 2e6e 756d 5f73 616d 706c  = self.num_sampl
+00036580: 6573 2069 6620 7361 6d70 6c65 7320 6973  es if samples is
+00036590: 204e 6f6e 6520 656c 7365 206c 656e 2873   None else len(s
+000365a0: 616d 706c 6573 290a 2020 2020 2020 2020  amples).        
+000365b0: 7265 7420 3d20 6e70 2e7a 6572 6f73 2873  ret = np.zeros(s
+000365c0: 6861 7065 3d28 7365 6c66 2e6e 756d 5f73  hape=(self.num_s
+000365d0: 6974 6573 2c20 6e75 6d5f 7361 6d70 6c65  ites, num_sample
+000365e0: 7329 2c20 6474 7970 653d 6e70 2e69 6e74  s), dtype=np.int
+000365f0: 3332 290a 0a20 2020 2020 2020 2066 6f72  32)..        for
+00036600: 2073 6974 655f 6964 2069 6e20 7261 6e67   site_id in rang
+00036610: 6528 7365 6c66 2e6e 756d 5f73 6974 6573  e(self.num_sites
+00036620: 293a 0a20 2020 2020 2020 2020 2020 2076  ):.            v
+00036630: 6172 6961 6e74 2e64 6563 6f64 6528 7369  ariant.decode(si
+00036640: 7465 5f69 6429 0a20 2020 2020 2020 2020  te_id).         
+00036650: 2020 2072 6574 5b73 6974 655f 6964 2c20     ret[site_id, 
+00036660: 3a5d 203d 2076 6172 6961 6e74 2e67 656e  :] = variant.gen
+00036670: 6f74 7970 6573 0a0a 2020 2020 2020 2020  otypes..        
+00036680: 7265 7475 726e 2072 6574 0a0a 2020 2020  return ret..    
+00036690: 6465 6620 616c 6967 6e6d 656e 7473 280a  def alignments(.
+000366a0: 2020 2020 2020 2020 7365 6c66 2c0a 2020          self,.  
+000366b0: 2020 2020 2020 2a2c 0a20 2020 2020 2020        *,.       
+000366c0: 2072 6566 6572 656e 6365 5f73 6571 7565   reference_seque
+000366d0: 6e63 653d 4e6f 6e65 2c0a 2020 2020 2020  nce=None,.      
+000366e0: 2020 6d69 7373 696e 675f 6461 7461 5f63    missing_data_c
+000366f0: 6861 7261 6374 6572 3d4e 6f6e 652c 0a20  haracter=None,. 
+00036700: 2020 2020 2020 2073 616d 706c 6573 3d4e         samples=N
+00036710: 6f6e 652c 0a20 2020 2020 2020 206c 6566  one,.        lef
+00036720: 743d 4e6f 6e65 2c0a 2020 2020 2020 2020  t=None,.        
+00036730: 7269 6768 743d 4e6f 6e65 2c0a 2020 2020  right=None,.    
+00036740: 293a 0a20 2020 2020 2020 2022 2222 0a20  ):.        """. 
+00036750: 2020 2020 2020 2052 6574 7572 6e73 2061         Returns a
+00036760: 6e20 6974 6572 6174 6f72 206f 7665 7220  n iterator over 
+00036770: 7468 6520 6675 6c6c 2073 6571 7565 6e63  the full sequenc
+00036780: 6520 616c 6967 6e6d 656e 7473 2066 6f72  e alignments for
+00036790: 2074 6865 2064 6566 696e 6564 2073 616d   the defined sam
+000367a0: 706c 6573 0a20 2020 2020 2020 2069 6e20  ples.        in 
+000367b0: 7468 6973 2074 7265 6520 7365 7175 656e  this tree sequen
+000367c0: 6365 2e20 4561 6368 2061 6c69 676e 6d65  ce. Each alignme
+000367d0: 6e74 2060 6061 6060 2069 7320 6120 7374  nt ``a`` is a st
+000367e0: 7269 6e67 206f 6620 6c65 6e67 7468 2060  ring of length `
+000367f0: 604c 6060 2077 6865 7265 0a20 2020 2020  `L`` where.     
+00036800: 2020 2074 6865 2066 6972 7374 2063 6861     the first cha
+00036810: 7261 6374 6572 2069 7320 7468 6520 6765  racter is the ge
+00036820: 6e6f 6d69 6320 7365 7175 656e 6365 2061  nomic sequence a
+00036830: 7420 7468 6520 6060 7374 6172 7460 6020  t the ``start`` 
+00036840: 706f 7369 7469 6f6e 2069 6e20 7468 650a  position in the.
+00036850: 2020 2020 2020 2020 6765 6e6f 6d65 2028          genome (
+00036860: 6465 6661 756c 7469 6e67 2074 6f20 3029  defaulting to 0)
+00036870: 2061 6e64 2074 6865 206c 6173 7420 6368   and the last ch
+00036880: 6172 6163 7465 7220 6973 2074 6865 2067  aracter is the g
+00036890: 656e 6f6d 6963 2073 6571 7565 6e63 6520  enomic sequence 
+000368a0: 6f6e 650a 2020 2020 2020 2020 706f 7369  one.        posi
+000368b0: 7469 6f6e 2062 6566 6f72 6520 7468 6520  tion before the 
+000368c0: 6060 7374 6f70 6060 2076 616c 7565 2028  ``stop`` value (
+000368d0: 6465 6661 756c 7469 6e67 2074 6f20 7468  defaulting to th
+000368e0: 6520 3a61 7474 723a 602e 7365 7175 656e  e :attr:`.sequen
+000368f0: 6365 5f6c 656e 6774 6860 0a20 2020 2020  ce_length`.     
+00036900: 2020 206f 6620 7468 6973 2074 7265 6520     of this tree 
+00036910: 7365 7175 656e 6365 2c20 7768 6963 6820  sequence, which 
+00036920: 6d75 7374 2068 6176 6520 3a61 7474 723a  must have :attr:
+00036930: 602e 6469 7363 7265 7465 5f67 656e 6f6d  `.discrete_genom
+00036940: 6560 2065 7175 616c 2074 6f20 5472 7565  e` equal to True
+00036950: 292e 0a20 2020 2020 2020 2042 7920 6465  )..        By de
+00036960: 6661 756c 7420 6060 4c60 6020 6973 2074  fault ``L`` is t
+00036970: 6865 7265 666f 7265 2065 7175 616c 2074  herefore equal t
+00036980: 6f20 7468 6520 3a61 7474 723a 602e 7365  o the :attr:`.se
+00036990: 7175 656e 6365 5f6c 656e 6774 6860 2c0a  quence_length`,.
+000369a0: 2020 2020 2020 2020 616e 6420 6060 615b          and ``a[
+000369b0: 6a5d 6060 2069 7320 7468 6520 6e75 636c  j]`` is the nucl
+000369c0: 656f 7469 6465 2076 616c 7565 2061 7420  eotide value at 
+000369d0: 6765 6e6f 6d69 6320 706f 7369 7469 6f6e  genomic position
+000369e0: 2060 606a 6060 2e0a 0a20 2020 2020 2020   ``j``...       
+000369f0: 202e 2e20 6e6f 7465 3a3a 2054 6869 7320   .. note:: This 
+00036a00: 6973 2069 6e68 6572 656e 746c 7920 6120  is inherently a 
+00036a10: 2a2a 7a65 726f 2d62 6173 6564 2a2a 2072  **zero-based** r
+00036a20: 6570 7265 7365 6e74 6174 696f 6e20 6f66  epresentation of
+00036a30: 2074 6865 2073 6571 7565 6e63 650a 2020   the sequence.  
+00036a40: 2020 2020 2020 2020 2020 636f 6f72 6469            coordi
+00036a50: 6e61 7465 2073 7061 6365 2e20 4361 7265  nate space. Care
+00036a60: 2077 696c 6c20 6265 206e 6565 6465 6420   will be needed 
+00036a70: 7768 656e 2069 6e74 6572 6163 7469 6e67  when interacting
+00036a80: 2077 6974 6820 6f74 6865 720a 2020 2020   with other.    
+00036a90: 2020 2020 2020 2020 6c69 6272 6172 6965          librarie
+00036aa0: 7320 616e 6420 7570 7374 7265 616d 2063  s and upstream c
+00036ab0: 6f6f 7264 696e 6174 6520 7370 6163 6573  oordinate spaces
+00036ac0: 2e0a 0a0a 2020 2020 2020 2020 5468 6520  ....        The 
+00036ad0: 3a72 6566 3a60 7369 7465 733c 7365 635f  :ref:`sites<sec_
+00036ae0: 6461 7461 5f6d 6f64 656c 5f64 6566 696e  data_model_defin
+00036af0: 6974 696f 6e73 5f73 6974 653e 6020 696e  itions_site>` in
+00036b00: 2061 2074 7265 6520 7365 7175 656e 6365   a tree sequence
+00036b10: 2077 696c 6c0a 2020 2020 2020 2020 7573   will.        us
+00036b20: 7561 6c6c 7920 6f6e 6c79 2064 6566 696e  ually only defin
+00036b30: 6520 7468 6520 7661 7269 6174 696f 6e20  e the variation 
+00036b40: 666f 7220 6120 7375 6273 6574 206f 6620  for a subset of 
+00036b50: 7468 6520 6060 4c60 6020 6e75 636c 656f  the ``L`` nucleo
+00036b60: 7469 6465 0a20 2020 2020 2020 2070 6f73  tide.        pos
+00036b70: 6974 696f 6e73 2061 6c6f 6e67 2074 6865  itions along the
+00036b80: 2067 656e 6f6d 652c 2061 6e64 2074 6865   genome, and the
+00036b90: 2072 656d 6169 6e69 6e67 2070 6f73 6974   remaining posit
+00036ba0: 696f 6e73 2061 7265 2066 696c 6c65 6420  ions are filled 
+00036bb0: 7573 696e 670a 2020 2020 2020 2020 6120  using.        a 
+00036bc0: 3a72 6566 3a60 7265 6665 7265 6e63 6520  :ref:`reference 
+00036bd0: 7365 7175 656e 6365 203c 7365 635f 6461  sequence <sec_da
+00036be0: 7461 5f6d 6f64 656c 5f72 6566 6572 656e  ta_model_referen
+00036bf0: 6365 5f73 6571 7565 6e63 653e 602e 0a20  ce_sequence>`.. 
+00036c00: 2020 2020 2020 2054 6865 2072 6566 6572         The refer
+00036c10: 656e 6365 2073 6571 7565 6e63 6520 6461  ence sequence da
+00036c20: 7461 2069 7320 6465 6669 6e65 6420 6569  ta is defined ei
+00036c30: 7468 6572 2076 6961 2074 6865 0a20 2020  ther via the.   
+00036c40: 2020 2020 2060 6072 6566 6572 656e 6365       ``reference
+00036c50: 5f73 6571 7565 6e63 6560 6020 7061 7261  _sequence`` para
+00036c60: 6d65 7465 7220 746f 2074 6869 7320 6d65  meter to this me
+00036c70: 7468 6f64 2c20 6f72 2065 6d62 6564 6465  thod, or embedde
+00036c80: 6420 7769 7468 696e 0a20 2020 2020 2020  d within.       
+00036c90: 2077 6974 6820 7468 6520 7472 6565 2073   with the tree s
+00036ca0: 6571 7565 6e63 6520 6974 7365 6c66 2076  equence itself v
+00036cb0: 6961 2074 6865 203a 6174 7472 3a60 2e54  ia the :attr:`.T
+00036cc0: 7265 6553 6571 7565 6e63 652e 7265 6665  reeSequence.refe
+00036cd0: 7265 6e63 655f 7365 7175 656e 6365 602e  rence_sequence`.
+00036ce0: 0a0a 2020 2020 2020 2020 5369 7465 2069  ..        Site i
+00036cf0: 6e66 6f72 6d61 7469 6f6e 2066 726f 6d20  nformation from 
+00036d00: 7468 6520 7472 6565 2073 6571 7565 6e63  the tree sequenc
+00036d10: 6520 7461 6b65 7320 7072 6563 6564 656e  e takes preceden
+00036d20: 6365 206f 7665 7220 7468 6520 7265 6665  ce over the refe
+00036d30: 7265 6e63 650a 2020 2020 2020 2020 7365  rence.        se
+00036d40: 7175 656e 6365 2073 6f20 7468 6174 2c20  quence so that, 
+00036d50: 666f 7220 6578 616d 706c 652c 2061 7420  for example, at 
+00036d60: 6120 7369 7465 2077 6974 6820 6e6f 206d  a site with no m
+00036d70: 7574 6174 696f 6e73 2061 6c6c 2073 616d  utations all sam
+00036d80: 706c 6573 0a20 2020 2020 2020 2077 696c  ples.        wil
+00036d90: 6c20 6861 7665 2074 6865 2073 6974 6527  l have the site'
+00036da0: 7320 616e 6365 7374 7261 6c20 7374 6174  s ancestral stat
+00036db0: 652e 0a0a 2020 2020 2020 2020 5468 6520  e...        The 
+00036dc0: 7265 6665 7265 6e63 6520 7365 7175 656e  reference sequen
+00036dd0: 6365 2062 6173 6573 2061 7265 2064 6574  ce bases are det
+00036de0: 6572 6d69 6e65 6420 696e 2074 6865 2066  ermined in the f
+00036df0: 6f6c 6c6f 7769 6e67 2077 6179 3a0a 0a20  ollowing way:.. 
+00036e00: 2020 2020 2020 202d 2049 6620 7468 6520         - If the 
+00036e10: 6060 7265 6665 7265 6e63 655f 7365 7175  ``reference_sequ
+00036e20: 656e 6365 6060 2070 6172 616d 6574 6572  ence`` parameter
+00036e30: 2069 7320 7375 7070 6c69 6564 2074 6869   is supplied thi
+00036e40: 7320 7769 6c6c 2062 650a 2020 2020 2020  s will be.      
+00036e50: 2020 2020 7573 6564 2c20 7265 6761 7264      used, regard
+00036e60: 6c65 7373 206f 6620 7768 6574 6865 7220  less of whether 
+00036e70: 7468 6520 7472 6565 2073 6571 7565 6e63  the tree sequenc
+00036e80: 6520 6861 7320 616e 2065 6d62 6564 6465  e has an embedde
+00036e90: 640a 2020 2020 2020 2020 2020 7265 6665  d.          refe
+00036ea0: 7265 6e63 6520 7365 7175 656e 6365 2e0a  rence sequence..
+00036eb0: 2020 2020 2020 2020 2d20 4f74 6865 7277          - Otherw
+00036ec0: 6973 652c 2069 6620 7468 6520 7472 6565  ise, if the tree
+00036ed0: 2073 6571 7565 6e63 6520 6861 7320 616e   sequence has an
+00036ee0: 2065 6d62 6564 6465 6420 7265 6665 7265   embedded refere
+00036ef0: 6e63 6520 7365 7175 656e 6365 2c0a 2020  nce sequence,.  
+00036f00: 2020 2020 2020 2020 7468 6973 2077 696c          this wil
+00036f10: 6c20 6265 2075 7365 642e 0a20 2020 2020  l be used..     
+00036f20: 2020 202d 2049 6620 7468 6520 6060 7265     - If the ``re
+00036f30: 6665 7265 6e63 655f 7365 7175 656e 6365  ference_sequence
+00036f40: 6060 2070 6172 616d 6574 6572 2069 7320  `` parameter is 
+00036f50: 6e6f 7420 7370 6563 6966 6965 6420 616e  not specified an
+00036f60: 640a 2020 2020 2020 2020 2020 7468 6572  d.          ther
+00036f70: 6520 6973 206e 6f20 656d 6265 6464 6564  e is no embedded
+00036f80: 2072 6566 6572 656e 6365 2073 6571 7565   reference seque
+00036f90: 6e63 652c 2060 604c 6060 2063 6f70 6965  nce, ``L`` copie
+00036fa0: 7320 6f66 2074 6865 0a20 2020 2020 2020  s of the.       
+00036fb0: 2020 2060 606d 6973 7369 6e67 5f64 6174     ``missing_dat
+00036fc0: 615f 6368 6172 6163 7465 7260 6020 2877  a_character`` (w
+00036fd0: 6869 6368 2064 6566 6175 6c74 7320 746f  hich defaults to
+00036fe0: 2027 4e27 2920 6172 6520 7573 6564 0a20   'N') are used. 
+00036ff0: 2020 2020 2020 2020 2069 6e73 7465 6164           instead
+00037000: 2e0a 0a20 2020 2020 2020 202e 2e20 7761  ...        .. wa
+00037010: 726e 696e 673a 3a20 5468 6520 3a63 6c61  rning:: The :cla
+00037020: 7373 3a60 2e52 6566 6572 656e 6365 5365  ss:`.ReferenceSe
+00037030: 7175 656e 6365 6020 4150 4920 6973 2070  quence` API is p
+00037040: 7265 6c69 6d69 6e61 7279 2061 6e64 0a20  reliminary and. 
+00037050: 2020 2020 2020 2020 2020 736f 6d65 2062            some b
+00037060: 6568 6176 696f 7572 7320 6d61 7920 6368  ehaviours may ch
+00037070: 616e 6765 2069 6e20 7468 6520 6675 7475  ange in the futu
+00037080: 7265 2e20 496e 2070 6172 7469 6375 6c61  re. In particula
+00037090: 722c 2061 0a20 2020 2020 2020 2020 2020  r, a.           
+000370a0: 7472 6565 2073 6571 7565 6e63 6520 6973  tree sequence is
+000370b0: 2063 7572 7265 6e74 6c79 2072 6567 6172   currently regar
+000370c0: 6465 6420 6173 2068 6176 696e 6720 616e  ded as having an
+000370d0: 2065 6d62 6564 6465 6420 7265 6665 7265   embedded refere
+000370e0: 6e63 650a 2020 2020 2020 2020 2020 2073  nce.           s
+000370f0: 6571 7565 6e63 6520 6576 656e 2069 6620  equence even if 
+00037100: 6974 206f 6e6c 7920 6861 7320 736f 6d65  it only has some
+00037110: 206d 6574 6164 6174 6120 6465 6669 6e65   metadata define
+00037120: 642e 2049 6e20 7468 6973 2063 6173 650a  d. In this case.
+00037130: 2020 2020 2020 2020 2020 2074 6865 2060             the `
+00037140: 6072 6566 6572 656e 6365 5f73 6571 7565  `reference_seque
+00037150: 6e63 6560 6020 7061 7261 6d65 7465 7220  nce`` parameter 
+00037160: 7769 6c6c 206e 6565 6420 746f 2062 6520  will need to be 
+00037170: 6578 706c 6963 6974 6c79 2073 6574 2e0a  explicitly set..
+00037180: 0a20 2020 2020 2020 202e 2e20 6e6f 7465  .        .. note
+00037190: 3a3a 0a20 2020 2020 2020 2020 2020 2054  ::.            T
+000371a0: 776f 2063 6f6d 6d6f 6e20 6f70 7469 6f6e  wo common option
+000371b0: 7320 666f 7220 7365 7474 696e 6720 6120  s for setting a 
+000371c0: 7265 6665 7265 6e63 6520 7365 7175 656e  reference sequen
+000371d0: 6365 2061 7265 3a0a 0a20 2020 2020 2020  ce are:..       
+000371e0: 2020 2020 202d 204d 6172 6b20 7468 656d       - Mark them
+000371f0: 2061 7320 6d69 7373 696e 6720 6461 7461   as missing data
+00037200: 2c20 6279 2073 6574 7469 6e67 0a20 2020  , by setting.   
+00037210: 2020 2020 2020 2020 2020 2060 6072 6566             ``ref
+00037220: 6572 656e 6365 5f73 6571 7565 6e63 653d  erence_sequence=
+00037230: 224e 2220 2a20 696e 7428 7473 2e73 6571  "N" * int(ts.seq
+00037240: 7565 6e63 655f 6c65 6e67 7468 2960 600a  uence_length)``.
+00037250: 2020 2020 2020 2020 2020 2020 2d20 4669              - Fi
+00037260: 6c6c 2074 6865 2067 6170 7320 7769 7468  ll the gaps with
+00037270: 2072 616e 646f 6d20 6e75 636c 656f 7469   random nucleoti
+00037280: 6465 732c 2062 7920 7365 7474 696e 670a  des, by setting.
+00037290: 2020 2020 2020 2020 2020 2020 2020 6060                ``
+000372a0: 7265 6665 7265 6e63 655f 7365 7175 656e  reference_sequen
+000372b0: 6365 3d74 736b 6974 2e72 616e 646f 6d5f  ce=tskit.random_
+000372c0: 6e75 636c 656f 7469 6465 7328 7473 2e73  nucleotides(ts.s
+000372d0: 6571 7565 6e63 655f 6c65 6e67 7468 2960  equence_length)`
+000372e0: 602e 0a20 2020 2020 2020 2020 2020 2020  `..             
+000372f0: 2053 6565 2074 6865 203a 6675 6e63 3a60   See the :func:`
+00037300: 2e72 616e 646f 6d5f 6e75 636c 656f 7469  .random_nucleoti
+00037310: 6465 7360 2066 756e 6374 696f 6e20 666f  des` function fo
+00037320: 7220 6d6f 7265 2069 6e66 6f72 6d61 7469  r more informati
+00037330: 6f6e 2e0a 0a20 2020 2020 2020 202e 2e20  on...        .. 
+00037340: 7761 726e 696e 673a 3a20 496e 7365 7274  warning:: Insert
+00037350: 696f 6e73 2061 6e64 2064 656c 6574 696f  ions and deletio
+00037360: 6e73 2061 7265 206e 6f74 2063 7572 7265  ns are not curre
+00037370: 6e74 6c79 2073 7570 706f 7274 6564 2061  ntly supported a
+00037380: 6e64 0a20 2020 2020 2020 2020 2020 7468  nd.           th
+00037390: 6520 616c 6c65 6c65 7320 6174 2065 6163  e alleles at eac
+000373a0: 6820 7369 7465 206d 7573 7420 6265 2072  h site must be r
+000373b0: 6570 7265 7365 6e74 6564 2062 790a 2020  epresented by.  
+000373c0: 2020 2020 2020 2020 2073 696e 676c 6520           single 
+000373d0: 6279 7465 2063 6861 7261 6374 6572 732c  byte characters,
+000373e0: 2028 692e 652e 2c20 7661 7269 616e 7473   (i.e., variants
+000373f0: 206d 7573 7420 6265 2073 696e 676c 6520   must be single 
+00037400: 6e75 636c 656f 7469 6465 0a20 2020 2020  nucleotide.     
+00037410: 2020 2020 2020 706f 6c79 6d6f 7270 6869        polymorphi
+00037420: 736d 732c 206f 7220 534e 5073 292e 0a0a  sms, or SNPs)...
+00037430: 2020 2020 2020 2020 2e2e 2077 6172 6e69          .. warni
+00037440: 6e67 3a3a 203a 7265 663a 604d 6973 7369  ng:: :ref:`Missi
+00037450: 6e67 2064 6174 613c 7365 635f 6461 7461  ng data<sec_data
+00037460: 5f6d 6f64 656c 5f6d 6973 7369 6e67 5f64  _model_missing_d
+00037470: 6174 613e 6020 6973 206e 6f74 0a20 2020  ata>` is not.   
+00037480: 2020 2020 2020 2020 6375 7272 656e 746c          currentl
+00037490: 7920 7375 7070 6f72 7465 6420 6279 2074  y supported by t
+000374a0: 6869 7320 6d65 7468 6f64 2061 6e64 2069  his method and i
+000374b0: 7420 7769 6c6c 2072 6169 7365 2061 2056  t will raise a V
+000374c0: 616c 7565 4572 726f 720a 2020 2020 2020  alueError.      
+000374d0: 2020 2020 2069 6620 6361 6c6c 6564 206f       if called o
+000374e0: 6e20 7472 6565 2073 6571 7565 6e63 6573  n tree sequences
+000374f0: 2063 6f6e 7461 696e 696e 6720 6973 6f6c   containing isol
+00037500: 6174 6564 2073 616d 706c 6573 2e0a 2020  ated samples..  
+00037510: 2020 2020 2020 2020 2053 6565 2068 7474           See htt
+00037520: 7073 3a2f 2f67 6974 6875 622e 636f 6d2f  ps://github.com/
+00037530: 7473 6b69 742d 6465 762f 7473 6b69 742f  tskit-dev/tskit/
+00037540: 6973 7375 6573 2f31 3839 3620 666f 7220  issues/1896 for 
+00037550: 6d6f 7265 0a20 2020 2020 2020 2020 2020  more.           
+00037560: 696e 666f 726d 6174 696f 6e2e 0a0a 2020  information...  
+00037570: 2020 2020 2020 5365 6520 616c 736f 2074        See also t
+00037580: 6865 203a 6d65 7468 3a60 2e76 6172 6961  he :meth:`.varia
+00037590: 6e74 7360 2069 7465 7261 746f 7220 666f  nts` iterator fo
+000375a0: 7220 7369 7465 2d63 656e 7472 6963 2061  r site-centric a
+000375b0: 6363 6573 730a 2020 2020 2020 2020 746f  ccess.        to
+000375c0: 2073 616d 706c 6520 6765 6e6f 7479 7065   sample genotype
+000375d0: 7320 616e 6420 3a6d 6574 683a 602e 6861  s and :meth:`.ha
+000375e0: 706c 6f74 7970 6573 6020 666f 7220 6163  plotypes` for ac
+000375f0: 6365 7373 2074 6f20 7361 6d70 6c65 2073  cess to sample s
+00037600: 6571 7565 6e63 6573 0a20 2020 2020 2020  equences.       
+00037610: 2061 7420 6a75 7374 2074 6865 2073 6974   at just the sit
+00037620: 6573 2069 6e20 7468 6520 7472 6565 2073  es in the tree s
+00037630: 6571 7565 6e63 652e 0a0a 2020 2020 2020  equence...      
+00037640: 2020 3a70 6172 616d 2073 7472 2072 6566    :param str ref
+00037650: 6572 656e 6365 5f73 6571 7565 6e63 653a  erence_sequence:
+00037660: 2054 6865 2072 6566 6572 656e 6365 2073   The reference s
+00037670: 6571 7565 6e63 6520 746f 2066 696c 6c20  equence to fill 
+00037680: 696e 0a20 2020 2020 2020 2020 2020 2067  in.            g
+00037690: 6170 7320 6265 7477 6565 6e20 7369 7465  aps between site
+000376a0: 7320 696e 2074 6865 2061 6c69 676e 6d65  s in the alignme
+000376b0: 6e74 732e 0a20 2020 2020 2020 203a 7061  nts..        :pa
+000376c0: 7261 6d20 7374 7220 6d69 7373 696e 675f  ram str missing_
+000376d0: 6461 7461 5f63 6861 7261 6374 6572 3a20  data_character: 
+000376e0: 4120 7369 6e67 6c65 2061 7363 6969 2063  A single ascii c
+000376f0: 6861 7261 6374 6572 2074 6861 7420 7769  haracter that wi
+00037700: 6c6c 0a20 2020 2020 2020 2020 2020 2062  ll.            b
+00037710: 6520 7573 6564 2074 6f20 7265 7072 6573  e used to repres
+00037720: 656e 7420 6d69 7373 696e 6720 6461 7461  ent missing data
+00037730: 2e0a 2020 2020 2020 2020 2020 2020 4966  ..            If
+00037740: 2061 6e79 206e 6f72 6d61 6c20 616c 6c65   any normal alle
+00037750: 6c65 2063 6f6e 7461 696e 7320 7468 6973  le contains this
+00037760: 2063 6861 7261 6374 6572 2c20 616e 2065   character, an e
+00037770: 7272 6f72 2069 7320 7261 6973 6564 2e0a  rror is raised..
+00037780: 2020 2020 2020 2020 2020 2020 4465 6661              Defa
+00037790: 756c 743a 2027 4e27 2e0a 2020 2020 2020  ult: 'N'..      
+000377a0: 2020 3a70 6172 616d 206c 6973 745b 696e    :param list[in
+000377b0: 745d 2073 616d 706c 6573 3a20 5468 6520  t] samples: The 
+000377c0: 7361 6d70 6c65 7320 666f 7220 7768 6963  samples for whic
+000377d0: 6820 746f 206f 7574 7075 7420 616c 6967  h to output alig
+000377e0: 6e6d 656e 7473 2e20 4966 0a20 2020 2020  nments. If.     
+000377f0: 2020 2020 2020 2060 604e 6f6e 6560 6020         ``None`` 
+00037800: 2864 6566 6175 6c74 292c 2072 6574 7572  (default), retur
+00037810: 6e20 616c 6967 6e6d 656e 7473 2066 6f72  n alignments for
+00037820: 2061 6c6c 2074 6865 2073 616d 706c 6573   all the samples
+00037830: 2069 6e20 7468 6520 7472 6565 0a20 2020   in the tree.   
+00037840: 2020 2020 2020 2020 2073 6571 7565 6e63           sequenc
+00037850: 652c 2069 6e20 7468 6520 6f72 6465 7220  e, in the order 
+00037860: 6769 7665 6e20 6279 2074 6865 203a 6d65  given by the :me
+00037870: 7468 3a60 2e73 616d 706c 6573 6020 6d65  th:`.samples` me
+00037880: 7468 6f64 2e0a 2020 2020 2020 2020 3a70  thod..        :p
+00037890: 6172 616d 2069 6e74 206c 6566 743a 2041  aram int left: A
+000378a0: 6c69 676e 6d65 6e74 7320 7769 6c6c 2073  lignments will s
+000378b0: 7461 7274 2061 7420 7468 6973 2067 656e  tart at this gen
+000378c0: 6f6d 6963 2070 6f73 6974 696f 6e2e 2049  omic position. I
+000378d0: 6620 6060 4e6f 6e65 6060 0a20 2020 2020  f ``None``.     
+000378e0: 2020 2020 2020 2028 6465 6661 756c 7429         (default)
+000378f0: 2061 6c69 676e 6d65 6e74 7320 7374 6172   alignments star
+00037900: 7420 6174 2030 2e0a 2020 2020 2020 2020  t at 0..        
+00037910: 3a70 6172 616d 2069 6e74 2072 6967 6874  :param int right
+00037920: 3a20 416c 6967 6e6d 656e 7473 2077 696c  : Alignments wil
+00037930: 6c20 7374 6f70 2062 6566 6f72 6520 7468  l stop before th
+00037940: 6973 2067 656e 6f6d 6963 2070 6f73 6974  is genomic posit
+00037950: 696f 6e2e 2049 6620 6060 4e6f 6e65 6060  ion. If ``None``
+00037960: 0a20 2020 2020 2020 2020 2020 2028 6465  .            (de
+00037970: 6661 756c 7429 2061 6c69 676e 6d65 6e74  fault) alignment
+00037980: 7320 7769 6c6c 2063 6f6e 7469 6e75 6520  s will continue 
+00037990: 756e 7469 6c20 7468 6520 656e 6420 6f66  until the end of
+000379a0: 2074 6865 2074 7265 6520 7365 7175 656e   the tree sequen
+000379b0: 6365 2e0a 2020 2020 2020 2020 3a72 6574  ce..        :ret
+000379c0: 7572 6e3a 2041 6e20 6974 6572 6174 6f72  urn: An iterator
+000379d0: 206f 7665 7220 7468 6520 616c 6967 6e6d   over the alignm
+000379e0: 656e 7420 7374 7269 6e67 7320 666f 7220  ent strings for 
+000379f0: 7370 6563 6966 6965 6420 7361 6d70 6c65  specified sample
+00037a00: 7320 696e 0a20 2020 2020 2020 2020 2020  s in.           
+00037a10: 2074 6869 7320 7472 6565 2073 6571 7565   this tree seque
+00037a20: 6e63 652c 2069 6e20 7468 6520 6f72 6465  nce, in the orde
+00037a30: 7220 6769 7665 6e20 696e 2060 6073 616d  r given in ``sam
+00037a40: 706c 6573 6060 2e0a 2020 2020 2020 2020  ples``..        
+00037a50: 3a72 7479 7065 3a20 636f 6c6c 6563 7469  :rtype: collecti
+00037a60: 6f6e 732e 6162 632e 4974 6572 6162 6c65  ons.abc.Iterable
+00037a70: 0a20 2020 2020 2020 203a 7261 6973 6573  .        :raises
+00037a80: 3a20 5661 6c75 6545 7272 6f72 0a20 2020  : ValueError.   
+00037a90: 2020 2020 2020 2020 2069 6620 616e 7920           if any 
+00037aa0: 6765 6e6f 6d65 2063 6f6f 7264 696e 6174  genome coordinat
+00037ab0: 6520 696e 2074 6869 7320 7472 6565 2073  e in this tree s
+00037ac0: 6571 7565 6e63 6520 6973 206e 6f74 2064  equence is not d
+00037ad0: 6973 6372 6574 652c 0a20 2020 2020 2020  iscrete,.       
+00037ae0: 2020 2020 206f 7220 6966 2074 6865 2060       or if the `
+00037af0: 6072 6566 6572 656e 6365 5f73 6571 7565  `reference_seque
+00037b00: 6e63 6560 6020 6973 206e 6f74 206f 6620  nce`` is not of 
+00037b10: 7468 6520 636f 7272 6563 7420 6c65 6e67  the correct leng
+00037b20: 7468 2e0a 2020 2020 2020 2020 3a72 6169  th..        :rai
+00037b30: 7365 733a 2054 7970 6545 7272 6f72 2069  ses: TypeError i
+00037b40: 6620 616e 7920 6f66 2074 6865 2061 6c6c  f any of the all
+00037b50: 656c 6573 2061 7420 6120 7369 7465 2061  eles at a site a
+00037b60: 7265 206e 6f74 2061 0a20 2020 2020 2020  re not a.       
+00037b70: 2020 2020 2073 696e 676c 6520 6173 6369       single asci
+00037b80: 6920 6368 6172 6163 7465 722e 0a20 2020  i character..   
+00037b90: 2020 2020 2022 2222 0a20 2020 2020 2020       """.       
+00037ba0: 2069 6620 6e6f 7420 7365 6c66 2e64 6973   if not self.dis
+00037bb0: 6372 6574 655f 6765 6e6f 6d65 3a0a 2020  crete_genome:.  
+00037bc0: 2020 2020 2020 2020 2020 7261 6973 6520            raise 
+00037bd0: 5661 6c75 6545 7272 6f72 2822 7365 7175  ValueError("sequ
+00037be0: 656e 6365 2061 6c69 676e 6d65 6e74 7320  ence alignments 
+00037bf0: 6f6e 6c79 2064 6566 696e 6564 2066 6f72  only defined for
+00037c00: 2064 6973 6372 6574 6520 6765 6e6f 6d65   discrete genome
+00037c10: 7322 290a 2020 2020 2020 2020 696e 7465  s").        inte
+00037c20: 7276 616c 203d 2073 656c 662e 5f63 6865  rval = self._che
+00037c30: 636b 5f67 656e 6f6d 6963 5f72 616e 6765  ck_genomic_range
+00037c40: 286c 6566 742c 2072 6967 6874 2c20 656e  (left, right, en
+00037c50: 7375 7265 5f69 6e74 6567 6572 3d54 7275  sure_integer=Tru
+00037c60: 6529 0a20 2020 2020 2020 206d 6973 7369  e).        missi
+00037c70: 6e67 5f64 6174 615f 6368 6172 6163 7465  ng_data_characte
+00037c80: 7220 3d20 280a 2020 2020 2020 2020 2020  r = (.          
+00037c90: 2020 224e 2220 6966 206d 6973 7369 6e67    "N" if missing
+00037ca0: 5f64 6174 615f 6368 6172 6163 7465 7220  _data_character 
+00037cb0: 6973 204e 6f6e 6520 656c 7365 206d 6973  is None else mis
+00037cc0: 7369 6e67 5f64 6174 615f 6368 6172 6163  sing_data_charac
+00037cd0: 7465 720a 2020 2020 2020 2020 290a 0a20  ter.        ).. 
+00037ce0: 2020 2020 2020 204c 203d 2069 6e74 6572         L = inter
+00037cf0: 7661 6c2e 7370 616e 0a20 2020 2020 2020  val.span.       
+00037d00: 2061 203d 206e 702e 656d 7074 7928 4c2c   a = np.empty(L,
+00037d10: 2064 7479 7065 3d6e 702e 696e 7438 290a   dtype=np.int8).
+00037d20: 2020 2020 2020 2020 6966 2072 6566 6572          if refer
+00037d30: 656e 6365 5f73 6571 7565 6e63 6520 6973  ence_sequence is
+00037d40: 204e 6f6e 653a 0a20 2020 2020 2020 2020   None:.         
+00037d50: 2020 2069 6620 7365 6c66 2e68 6173 5f72     if self.has_r
+00037d60: 6566 6572 656e 6365 5f73 6571 7565 6e63  eference_sequenc
+00037d70: 6528 293a 0a20 2020 2020 2020 2020 2020  e():.           
+00037d80: 2020 2020 2023 2054 6869 7320 6d61 7920       # This may 
+00037d90: 6265 2069 6e65 6666 6963 6965 6e74 202d  be inefficient -
+00037da0: 2073 6565 2023 3139 3839 2e20 486f 7765   see #1989. Howe
+00037db0: 7665 722c 2073 696e 6365 2077 6527 7265  ver, since we're
+00037dc0: 0a20 2020 2020 2020 2020 2020 2020 2020  .               
+00037dd0: 2023 206e 2063 6f70 6965 7320 6f66 2074   # n copies of t
+00037de0: 6865 2072 6566 6572 656e 6365 2073 6571  he reference seq
+00037df0: 7565 6e63 6520 616e 7977 6179 2c20 7468  uence anyway, th
+00037e00: 6973 2069 7320 6120 7265 6c61 7469 7665  is is a relative
+00037e10: 6c79 0a20 2020 2020 2020 2020 2020 2020  ly.             
+00037e20: 2020 2023 206d 696e 6f72 2074 7765 616b     # minor tweak
+00037e30: 2e20 5765 206d 6179 2061 6c73 6f20 7761  . We may also wa
+00037e40: 6e74 2074 6f20 7265 636f 6465 2074 6865  nt to recode the
+00037e50: 2062 656c 6f77 206e 6f74 2074 6f20 7573   below not to us
+00037e60: 6520 6469 7265 6374 0a20 2020 2020 2020  e direct.       
+00037e70: 2020 2020 2020 2020 2023 2061 6363 6573           # acces
+00037e80: 7320 746f 2074 6865 202e 6461 7461 2061  s to the .data a
+00037e90: 7474 7269 6275 7465 2c20 652e 672e 2069  ttribute, e.g. i
+00037ea0: 6620 7765 2061 6c6c 6f77 2072 6566 6572  f we allow refer
+00037eb0: 656e 6365 2073 6571 7565 6e63 6573 0a20  ence sequences. 
+00037ec0: 2020 2020 2020 2020 2020 2020 2020 2023                 #
+00037ed0: 2074 6f20 7374 6172 7420 6174 206e 6f6e   to start at non
+00037ee0: 2d7a 6572 6f20 706f 7369 7469 6f6e 730a  -zero positions.
+00037ef0: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00037f00: 7265 6665 7265 6e63 655f 7365 7175 656e  reference_sequen
+00037f10: 6365 203d 2073 656c 662e 7265 6665 7265  ce = self.refere
+00037f20: 6e63 655f 7365 7175 656e 6365 2e64 6174  nce_sequence.dat
+00037f30: 615b 0a20 2020 2020 2020 2020 2020 2020  a[.             
+00037f40: 2020 2020 2020 2069 6e74 6572 7661 6c2e         interval.
+00037f50: 6c65 6674 203a 2069 6e74 6572 7661 6c2e  left : interval.
+00037f60: 7269 6768 740a 2020 2020 2020 2020 2020  right.          
+00037f70: 2020 2020 2020 5d0a 2020 2020 2020 2020        ].        
+00037f80: 2020 2020 656c 7365 3a0a 2020 2020 2020      else:.      
+00037f90: 2020 2020 2020 2020 2020 7265 6665 7265            refere
+00037fa0: 6e63 655f 7365 7175 656e 6365 203d 206d  nce_sequence = m
+00037fb0: 6973 7369 6e67 5f64 6174 615f 6368 6172  issing_data_char
+00037fc0: 6163 7465 7220 2a20 4c0a 0a20 2020 2020  acter * L..     
+00037fd0: 2020 2069 6620 6c65 6e28 7265 6665 7265     if len(refere
+00037fe0: 6e63 655f 7365 7175 656e 6365 2920 213d  nce_sequence) !=
+00037ff0: 204c 3a0a 2020 2020 2020 2020 2020 2020   L:.            
+00038000: 6966 2069 6e74 6572 7661 6c2e 7269 6768  if interval.righ
+00038010: 7420 3d3d 2069 6e74 2873 656c 662e 7365  t == int(self.se
+00038020: 7175 656e 6365 5f6c 656e 6774 6829 3a0a  quence_length):.
+00038030: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00038040: 7261 6973 6520 5661 6c75 6545 7272 6f72  raise ValueError
+00038050: 280a 2020 2020 2020 2020 2020 2020 2020  (.              
+00038060: 2020 2020 2020 2254 6865 2072 6566 6572        "The refer
+00038070: 656e 6365 2073 6571 7565 6e63 6520 6973  ence sequence is
+00038080: 2073 686f 7274 6572 2074 6861 6e20 7468   shorter than th
+00038090: 6520 7472 6565 2073 6571 7565 6e63 6520  e tree sequence 
+000380a0: 6c65 6e67 7468 220a 2020 2020 2020 2020  length".        
+000380b0: 2020 2020 2020 2020 290a 2020 2020 2020          ).      
+000380c0: 2020 2020 2020 656c 7365 3a0a 2020 2020        else:.    
+000380d0: 2020 2020 2020 2020 2020 2020 7261 6973              rais
+000380e0: 6520 5661 6c75 6545 7272 6f72 280a 2020  e ValueError(.  
+000380f0: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00038100: 2020 2254 6865 2072 6566 6572 656e 6365    "The reference
+00038110: 2073 6571 7565 6e63 6520 656e 6473 2062   sequence ends b
+00038120: 6566 6f72 6520 7468 6520 7265 7175 6573  efore the reques
+00038130: 7465 6420 7374 6f70 2070 6f73 6974 696f  ted stop positio
+00038140: 6e22 0a20 2020 2020 2020 2020 2020 2020  n".             
+00038150: 2020 2029 0a20 2020 2020 2020 2072 6566     ).        ref
+00038160: 5f62 7974 6573 203d 2072 6566 6572 656e  _bytes = referen
+00038170: 6365 5f73 6571 7565 6e63 652e 656e 636f  ce_sequence.enco
+00038180: 6465 2822 6173 6369 6922 290a 2020 2020  de("ascii").    
+00038190: 2020 2020 615b 3a5d 203d 206e 702e 6672      a[:] = np.fr
+000381a0: 6f6d 6275 6666 6572 2872 6566 5f62 7974  ombuffer(ref_byt
+000381b0: 6573 2c20 6474 7970 653d 6e70 2e69 6e74  es, dtype=np.int
+000381c0: 3829 0a0a 2020 2020 2020 2020 2320 546f  8)..        # To
+000381d0: 2064 6f20 7468 6973 2070 726f 7065 726c   do this properl
+000381e0: 7920 7765 276c 6c20 6861 7665 2074 6f20  y we'll have to 
+000381f0: 6465 7465 6374 2074 6865 206d 6973 7369  detect the missi
+00038200: 6e67 2064 6174 6120 6173 0a20 2020 2020  ng data as.     
+00038210: 2020 2023 2070 6172 7420 6f66 2061 2066     # part of a f
+00038220: 756c 6c20 696d 706c 656d 656e 7461 7469  ull implementati
+00038230: 6f6e 206f 6620 616c 6967 6e6d 656e 7473  on of alignments
+00038240: 2069 6e20 432e 2054 6865 2063 7572 7265   in C. The curre
+00038250: 6e74 0a20 2020 2020 2020 2023 2064 6566  nt.        # def
+00038260: 696e 6974 696f 6e20 6d69 6768 7420 6e6f  inition might no
+00038270: 7420 6265 2063 616c 6c69 6e67 2073 6f6d  t be calling som
+00038280: 6520 6465 6765 6e65 7261 7465 2063 6173  e degenerate cas
+00038290: 6573 2063 6f72 7265 6374 6c79 3b0a 2020  es correctly;.  
+000382a0: 2020 2020 2020 2320 7365 6520 6874 7470        # see http
+000382b0: 733a 2f2f 6769 7468 7562 2e63 6f6d 2f74  s://github.com/t
+000382c0: 736b 6974 2d64 6576 2f74 736b 6974 2f69  skit-dev/tskit/i
+000382d0: 7373 7565 732f 3139 3038 0a20 2020 2020  ssues/1908.     
+000382e0: 2020 2023 0a20 2020 2020 2020 2023 204e     #.        # N
+000382f0: 6f74 6520 616c 736f 2074 6861 7420 7468  ote also that th
+00038300: 6973 2077 696c 6c20 6361 6c6c 2074 6865  is will call the
+00038310: 2070 7265 7365 6e63 6520 6f66 206d 6973   presence of mis
+00038320: 7369 6e67 2064 6174 610a 2020 2020 2020  sing data.      
+00038330: 2020 2320 696e 636f 7272 6563 746c 7920    # incorrectly 
+00038340: 6966 2068 6176 6520 6120 7361 6d70 6c65  if have a sample
+00038350: 2069 736f 6c61 7465 6420 6f76 6572 2074   isolated over t
+00038360: 6865 2072 6567 696f 6e20 2861 2c20 625d  he region (a, b]
+00038370: 2c0a 2020 2020 2020 2020 2320 616e 6420  ,.        # and 
+00038380: 6966 2077 6520 6861 7665 2073 6974 6573  if we have sites
+00038390: 2061 7420 6561 6368 2070 6f73 6974 696f   at each positio
+000383a0: 6e20 6672 6f6d 2061 2074 6f20 622c 2061  n from a to b, a
+000383b0: 6e64 2061 740a 2020 2020 2020 2020 2320  nd at.        # 
+000383c0: 6561 6368 2073 6974 6520 7468 6572 6520  each site there 
+000383d0: 6973 2061 206d 7574 6174 696f 6e20 6f76  is a mutation ov
+000383e0: 6572 2074 6865 2069 736f 6c61 7465 6420  er the isolated 
+000383f0: 7361 6d70 6c65 2e0a 2020 2020 2020 2020  sample..        
+00038400: 6966 2061 6e79 2874 7265 652e 5f68 6173  if any(tree._has
+00038410: 5f69 736f 6c61 7465 645f 7361 6d70 6c65  _isolated_sample
+00038420: 7328 2920 666f 7220 7472 6565 2069 6e20  s() for tree in 
+00038430: 7365 6c66 2e74 7265 6573 2829 293a 0a20  self.trees()):. 
+00038440: 2020 2020 2020 2020 2020 2072 6169 7365             raise
+00038450: 2056 616c 7565 4572 726f 7228 0a20 2020   ValueError(.   
+00038460: 2020 2020 2020 2020 2020 2020 2022 4d69               "Mi
+00038470: 7373 696e 6720 6461 7461 206e 6f74 2063  ssing data not c
+00038480: 7572 7265 6e74 6c79 2073 7570 706f 7274  urrently support
+00038490: 6564 2069 6e20 616c 6967 6e6d 656e 7473  ed in alignments
+000384a0: 3b20 7365 6520 220a 2020 2020 2020 2020  ; see ".        
+000384b0: 2020 2020 2020 2020 2268 7474 7073 3a2f          "https:/
+000384c0: 2f67 6974 6875 622e 636f 6d2f 7473 6b69  /github.com/tski
+000384d0: 742d 6465 762f 7473 6b69 742f 6973 7375  t-dev/tskit/issu
+000384e0: 6573 2f31 3839 3620 666f 7220 6465 7461  es/1896 for deta
+000384f0: 696c 732e 220a 2020 2020 2020 2020 2020  ils.".          
+00038500: 2020 2020 2020 2254 6865 2063 7572 7265        "The curre
+00038510: 6e74 2069 6d70 6c65 6d65 6e74 6174 696f  nt implementatio
+00038520: 6e20 6d61 7920 616c 736f 2069 6e63 6f72  n may also incor
+00038530: 7265 6374 6c79 2069 6465 6e74 6966 7920  rectly identify 
+00038540: 616e 2022 0a20 2020 2020 2020 2020 2020  an ".           
+00038550: 2020 2020 2022 696e 7075 7420 7472 6565       "input tree
+00038560: 2073 6571 7565 6e63 6520 6861 7320 6861   sequence has ha
+00038570: 7669 6e67 206d 6973 7369 6e67 2064 6174  ving missing dat
+00038580: 612e 220a 2020 2020 2020 2020 2020 2020  a.".            
+00038590: 290a 2020 2020 2020 2020 482c 2028 6669  ).        H, (fi
+000385a0: 7273 745f 7369 7465 5f69 642c 206c 6173  rst_site_id, las
+000385b0: 745f 7369 7465 5f69 6429 203d 2073 656c  t_site_id) = sel
+000385c0: 662e 5f68 6170 6c6f 7479 7065 735f 6172  f._haplotypes_ar
+000385d0: 7261 7928 0a20 2020 2020 2020 2020 2020  ray(.           
+000385e0: 2069 6e74 6572 7661 6c3d 696e 7465 7276   interval=interv
+000385f0: 616c 2c0a 2020 2020 2020 2020 2020 2020  al,.            
+00038600: 6d69 7373 696e 675f 6461 7461 5f63 6861  missing_data_cha
+00038610: 7261 6374 6572 3d6d 6973 7369 6e67 5f64  racter=missing_d
+00038620: 6174 615f 6368 6172 6163 7465 722c 0a20  ata_character,. 
+00038630: 2020 2020 2020 2020 2020 2073 616d 706c             sampl
+00038640: 6573 3d73 616d 706c 6573 2c0a 2020 2020  es=samples,.    
+00038650: 2020 2020 290a 2020 2020 2020 2020 7369      ).        si
+00038660: 7465 5f70 6f73 203d 2073 656c 662e 7369  te_pos = self.si
+00038670: 7465 735f 706f 7369 7469 6f6e 2e61 7374  tes_position.ast
+00038680: 7970 6528 6e70 2e69 6e74 3634 295b 0a20  ype(np.int64)[. 
+00038690: 2020 2020 2020 2020 2020 2066 6972 7374             first
+000386a0: 5f73 6974 655f 6964 203a 206c 6173 745f  _site_id : last_
+000386b0: 7369 7465 5f69 6420 2b20 310a 2020 2020  site_id + 1.    
+000386c0: 2020 2020 5d0a 2020 2020 2020 2020 666f      ].        fo
+000386d0: 7220 6820 696e 2048 3a0a 2020 2020 2020  r h in H:.      
+000386e0: 2020 2020 2020 615b 7369 7465 5f70 6f73        a[site_pos
+000386f0: 202d 2069 6e74 6572 7661 6c2e 6c65 6674   - interval.left
+00038700: 5d20 3d20 680a 2020 2020 2020 2020 2020  ] = h.          
+00038710: 2020 7969 656c 6420 612e 746f 6279 7465    yield a.tobyte
+00038720: 7328 292e 6465 636f 6465 2822 6173 6369  s().decode("asci
+00038730: 6922 290a 0a20 2020 2040 7072 6f70 6572  i")..    @proper
+00038740: 7479 0a20 2020 2064 6566 2069 6e64 6976  ty.    def indiv
+00038750: 6964 7561 6c73 5f70 6f70 756c 6174 696f  iduals_populatio
+00038760: 6e28 7365 6c66 293a 0a20 2020 2020 2020  n(self):.       
+00038770: 2022 2222 0a20 2020 2020 2020 2052 6574   """.        Ret
+00038780: 7572 6e73 2074 6865 206c 656e 6774 682d  urns the length-
+00038790: 6060 6e75 6d5f 696e 6469 7669 6475 616c  ``num_individual
+000387a0: 7360 6020 6172 7261 7920 636f 6e74 6169  s`` array contai
+000387b0: 6e69 6e67 2c20 666f 7220 6561 6368 0a20  ning, for each. 
+000387c0: 2020 2020 2020 2069 6e64 6976 6964 7561         individua
+000387d0: 6c2c 2074 6865 2060 6070 6f70 756c 6174  l, the ``populat
+000387e0: 696f 6e60 6020 6174 7472 6962 7574 6520  ion`` attribute 
+000387f0: 6f66 2074 6865 6972 206e 6f64 6573 2c20  of their nodes, 
+00038800: 6f72 0a20 2020 2020 2020 2060 6074 736b  or.        ``tsk
+00038810: 6974 2e4e 554c 4c60 6020 666f 7220 696e  it.NULL`` for in
+00038820: 6469 7669 6475 616c 7320 7769 7468 206e  dividuals with n
+00038830: 6f20 6e6f 6465 732e 2045 7272 6f72 7320  o nodes. Errors 
+00038840: 6966 2061 6e79 2069 6e64 6976 6964 7561  if any individua
+00038850: 6c0a 2020 2020 2020 2020 6861 7320 6e6f  l.        has no
+00038860: 6465 7320 7769 7468 2069 6e63 6f6e 7369  des with inconsi
+00038870: 7374 656e 7420 6e6f 6e2d 4e55 4c4c 2070  stent non-NULL p
+00038880: 6f70 756c 6174 696f 6e73 2e0a 2020 2020  opulations..    
+00038890: 2020 2020 2222 220a 2020 2020 2020 2020      """.        
+000388a0: 6966 2073 656c 662e 5f69 6e64 6976 6964  if self._individ
+000388b0: 7561 6c73 5f70 6f70 756c 6174 696f 6e20  uals_population 
+000388c0: 6973 204e 6f6e 653a 0a20 2020 2020 2020  is None:.       
+000388d0: 2020 2020 2073 656c 662e 5f69 6e64 6976       self._indiv
+000388e0: 6964 7561 6c73 5f70 6f70 756c 6174 696f  iduals_populatio
+000388f0: 6e20 3d20 280a 2020 2020 2020 2020 2020  n = (.          
+00038900: 2020 2020 2020 7365 6c66 2e5f 6c6c 5f74        self._ll_t
+00038910: 7265 655f 7365 7175 656e 6365 2e67 6574  ree_sequence.get
+00038920: 5f69 6e64 6976 6964 7561 6c73 5f70 6f70  _individuals_pop
+00038930: 756c 6174 696f 6e28 290a 2020 2020 2020  ulation().      
+00038940: 2020 2020 2020 290a 2020 2020 2020 2020        ).        
+00038950: 7265 7475 726e 2073 656c 662e 5f69 6e64  return self._ind
+00038960: 6976 6964 7561 6c73 5f70 6f70 756c 6174  ividuals_populat
+00038970: 696f 6e0a 0a20 2020 2040 7072 6f70 6572  ion..    @proper
+00038980: 7479 0a20 2020 2064 6566 2069 6e64 6976  ty.    def indiv
+00038990: 6964 7561 6c5f 706f 7075 6c61 7469 6f6e  idual_population
+000389a0: 7328 7365 6c66 293a 0a20 2020 2020 2020  s(self):.       
+000389b0: 2023 2055 6e64 6f63 756d 656e 7465 6420   # Undocumented 
+000389c0: 616c 6961 7320 666f 7220 696e 6469 7669  alias for indivi
+000389d0: 6475 616c 735f 706f 7075 6c61 7469 6f6e  duals_population
+000389e0: 2074 6f20 6176 6f69 6420 6272 6561 6b69   to avoid breaki
+000389f0: 6e67 0a20 2020 2020 2020 2023 2070 7265  ng.        # pre
+00038a00: 2d31 2e30 2070 7973 6c69 6d20 636f 6465  -1.0 pyslim code
+00038a10: 0a20 2020 2020 2020 2072 6574 7572 6e20  .        return 
+00038a20: 7365 6c66 2e69 6e64 6976 6964 7561 6c73  self.individuals
+00038a30: 5f70 6f70 756c 6174 696f 6e0a 0a20 2020  _population..   
+00038a40: 2040 7072 6f70 6572 7479 0a20 2020 2064   @property.    d
+00038a50: 6566 2069 6e64 6976 6964 7561 6c73 5f74  ef individuals_t
+00038a60: 696d 6528 7365 6c66 293a 0a20 2020 2020  ime(self):.     
+00038a70: 2020 2022 2222 0a20 2020 2020 2020 2052     """.        R
+00038a80: 6574 7572 6e73 2074 6865 206c 656e 6774  eturns the lengt
+00038a90: 682d 6060 6e75 6d5f 696e 6469 7669 6475  h-``num_individu
+00038aa0: 616c 7360 6020 6172 7261 7920 636f 6e74  als`` array cont
+00038ab0: 6169 6e69 6e67 2c20 666f 7220 6561 6368  aining, for each
+00038ac0: 0a20 2020 2020 2020 2069 6e64 6976 6964  .        individ
+00038ad0: 7561 6c2c 2074 6865 2060 6074 696d 6560  ual, the ``time`
+00038ae0: 6020 6174 7472 6962 7574 6520 6f66 2074  ` attribute of t
+00038af0: 6865 6972 206e 6f64 6573 206f 7220 6060  heir nodes or ``
+00038b00: 6e70 2e6e 616e 6060 2066 6f72 0a20 2020  np.nan`` for.   
+00038b10: 2020 2020 2069 6e64 6976 6964 7561 6c73       individuals
+00038b20: 2077 6974 6820 6e6f 206e 6f64 6573 2e20   with no nodes. 
+00038b30: 4572 726f 7273 2069 6620 616e 7920 696e  Errors if any in
+00038b40: 6469 7669 6475 616c 2068 6173 206e 6f64  dividual has nod
+00038b50: 6573 2077 6974 680a 2020 2020 2020 2020  es with.        
+00038b60: 696e 636f 6e73 6973 7465 6e74 2074 696d  inconsistent tim
+00038b70: 6573 2e0a 2020 2020 2020 2020 2222 220a  es..        """.
+00038b80: 2020 2020 2020 2020 6966 2073 656c 662e          if self.
+00038b90: 5f69 6e64 6976 6964 7561 6c73 5f74 696d  _individuals_tim
+00038ba0: 6520 6973 204e 6f6e 653a 0a20 2020 2020  e is None:.     
+00038bb0: 2020 2020 2020 2073 656c 662e 5f69 6e64         self._ind
+00038bc0: 6976 6964 7561 6c73 5f74 696d 6520 3d20  ividuals_time = 
+00038bd0: 7365 6c66 2e5f 6c6c 5f74 7265 655f 7365  self._ll_tree_se
+00038be0: 7175 656e 6365 2e67 6574 5f69 6e64 6976  quence.get_indiv
+00038bf0: 6964 7561 6c73 5f74 696d 6528 290a 2020  iduals_time().  
+00038c00: 2020 2020 2020 7265 7475 726e 2073 656c        return sel
+00038c10: 662e 5f69 6e64 6976 6964 7561 6c73 5f74  f._individuals_t
+00038c20: 696d 650a 0a20 2020 2040 7072 6f70 6572  ime..    @proper
+00038c30: 7479 0a20 2020 2064 6566 2069 6e64 6976  ty.    def indiv
+00038c40: 6964 7561 6c5f 7469 6d65 7328 7365 6c66  idual_times(self
+00038c50: 293a 0a20 2020 2020 2020 2023 2055 6e64  ):.        # Und
+00038c60: 6f63 756d 656e 7465 6420 616c 6961 7320  ocumented alias 
+00038c70: 666f 7220 696e 6469 7669 6475 616c 735f  for individuals_
+00038c80: 7469 6d65 2074 6f20 6176 6f69 6420 6272  time to avoid br
+00038c90: 6561 6b69 6e67 0a20 2020 2020 2020 2023  eaking.        #
+00038ca0: 2070 7265 2d31 2e30 2070 7973 6c69 6d20   pre-1.0 pyslim 
+00038cb0: 636f 6465 0a20 2020 2020 2020 2072 6574  code.        ret
+00038cc0: 7572 6e20 7365 6c66 2e69 6e64 6976 6964  urn self.individ
+00038cd0: 7561 6c73 5f74 696d 650a 0a20 2020 2040  uals_time..    @
+00038ce0: 7072 6f70 6572 7479 0a20 2020 2064 6566  property.    def
+00038cf0: 2069 6e64 6976 6964 7561 6c73 5f6c 6f63   individuals_loc
+00038d00: 6174 696f 6e28 7365 6c66 293a 0a20 2020  ation(self):.   
+00038d10: 2020 2020 2022 2222 0a20 2020 2020 2020       """.       
+00038d20: 2043 6f6e 7665 6e69 656e 6365 206d 6574   Convenience met
+00038d30: 686f 6420 7265 7475 726e 696e 6720 7468  hod returning th
+00038d40: 6520 6060 6e75 6d5f 696e 6469 7669 6475  e ``num_individu
+00038d50: 616c 7320 7820 6e60 6020 6172 7261 790a  als x n`` array.
+00038d60: 2020 2020 2020 2020 7768 6f73 6520 726f          whose ro
+00038d70: 7720 6b2d 7468 2072 6f77 2063 6f6e 7461  w k-th row conta
+00038d80: 696e 7320 7468 6520 6060 6c6f 6361 7469  ins the ``locati
+00038d90: 6f6e 6060 2070 726f 7065 7274 7920 6f66  on`` property of
+00038da0: 2074 6865 206b 2d74 680a 2020 2020 2020   the k-th.      
+00038db0: 2020 696e 6469 7669 6475 616c 2e20 5468    individual. Th
+00038dc0: 6520 6d65 7468 6f64 206f 6e6c 7920 776f  e method only wo
+00038dd0: 726b 7320 6966 2061 6c6c 2069 6e64 6976  rks if all indiv
+00038de0: 6964 7561 6c73 2720 6c6f 6361 7469 6f6e  iduals' location
+00038df0: 730a 2020 2020 2020 2020 6861 7665 2074  s.        have t
+00038e00: 6865 2073 616d 6520 6c65 6e67 7468 2028  he same length (
+00038e10: 7768 6963 6820 6973 2060 606e 6060 292c  which is ``n``),
+00038e20: 2061 6e64 2065 7272 6f72 7320 6f74 6865   and errors othe
+00038e30: 7277 6973 652e 0a20 2020 2020 2020 2022  rwise..        "
+00038e40: 2222 0a20 2020 2020 2020 2069 6620 7365  "".        if se
+00038e50: 6c66 2e5f 696e 6469 7669 6475 616c 735f  lf._individuals_
+00038e60: 6c6f 6361 7469 6f6e 2069 7320 4e6f 6e65  location is None
+00038e70: 3a0a 2020 2020 2020 2020 2020 2020 696e  :.            in
+00038e80: 6469 7669 6475 616c 7320 3d20 7365 6c66  dividuals = self
+00038e90: 2e74 6162 6c65 732e 696e 6469 7669 6475  .tables.individu
+00038ea0: 616c 730a 2020 2020 2020 2020 2020 2020  als.            
+00038eb0: 6e20 3d20 300a 2020 2020 2020 2020 2020  n = 0.          
+00038ec0: 2020 6c65 6e73 203d 206e 702e 756e 6971    lens = np.uniq
+00038ed0: 7565 286e 702e 6469 6666 2869 6e64 6976  ue(np.diff(indiv
+00038ee0: 6964 7561 6c73 2e6c 6f63 6174 696f 6e5f  iduals.location_
+00038ef0: 6f66 6673 6574 2929 0a20 2020 2020 2020  offset)).       
+00038f00: 2020 2020 2069 6620 6c65 6e28 6c65 6e73       if len(lens
+00038f10: 2920 3e20 313a 0a20 2020 2020 2020 2020  ) > 1:.         
+00038f20: 2020 2020 2020 2072 6169 7365 2056 616c         raise Val
+00038f30: 7565 4572 726f 7228 2249 6e64 6976 6964  ueError("Individ
+00038f40: 7561 6c20 6c6f 6361 7469 6f6e 7320 6172  ual locations ar
+00038f50: 6520 6e6f 7420 616c 6c20 7468 6520 7361  e not all the sa
+00038f60: 6d65 206c 656e 6774 682e 2229 0a20 2020  me length.").   
+00038f70: 2020 2020 2020 2020 2069 6620 6c65 6e28           if len(
+00038f80: 6c65 6e73 2920 3e20 303a 0a20 2020 2020  lens) > 0:.     
+00038f90: 2020 2020 2020 2020 2020 206e 203d 206c             n = l
+00038fa0: 656e 735b 305d 0a20 2020 2020 2020 2020  ens[0].         
+00038fb0: 2020 2073 656c 662e 5f69 6e64 6976 6964     self._individ
+00038fc0: 7561 6c73 5f6c 6f63 6174 696f 6e20 3d20  uals_location = 
+00038fd0: 696e 6469 7669 6475 616c 732e 6c6f 6361  individuals.loca
+00038fe0: 7469 6f6e 2e72 6573 6861 7065 280a 2020  tion.reshape(.  
+00038ff0: 2020 2020 2020 2020 2020 2020 2020 2873                (s
+00039000: 656c 662e 6e75 6d5f 696e 6469 7669 6475  elf.num_individu
+00039010: 616c 732c 206e 290a 2020 2020 2020 2020  als, n).        
+00039020: 2020 2020 290a 2020 2020 2020 2020 7265      ).        re
+00039030: 7475 726e 2073 656c 662e 5f69 6e64 6976  turn self._indiv
+00039040: 6964 7561 6c73 5f6c 6f63 6174 696f 6e0a  iduals_location.
+00039050: 0a20 2020 2040 7072 6f70 6572 7479 0a20  .    @property. 
+00039060: 2020 2064 6566 2069 6e64 6976 6964 7561     def individua
+00039070: 6c5f 6c6f 6361 7469 6f6e 7328 7365 6c66  l_locations(self
+00039080: 293a 0a20 2020 2020 2020 2023 2055 6e64  ):.        # Und
+00039090: 6f63 756d 656e 7465 6420 616c 6961 7320  ocumented alias 
+000390a0: 666f 7220 696e 6469 7669 6475 616c 735f  for individuals_
+000390b0: 7469 6d65 2074 6f20 6176 6f69 6420 6272  time to avoid br
+000390c0: 6561 6b69 6e67 0a20 2020 2020 2020 2023  eaking.        #
+000390d0: 2070 7265 2d31 2e30 2070 7973 6c69 6d20   pre-1.0 pyslim 
+000390e0: 636f 6465 0a20 2020 2020 2020 2072 6574  code.        ret
+000390f0: 7572 6e20 7365 6c66 2e69 6e64 6976 6964  urn self.individ
+00039100: 7561 6c73 5f6c 6f63 6174 696f 6e0a 0a20  uals_location.. 
+00039110: 2020 2040 7072 6f70 6572 7479 0a20 2020     @property.   
+00039120: 2064 6566 2069 6e64 6976 6964 7561 6c73   def individuals
+00039130: 5f66 6c61 6773 2873 656c 6629 3a0a 2020  _flags(self):.  
+00039140: 2020 2020 2020 2222 220a 2020 2020 2020        """.      
+00039150: 2020 4566 6669 6369 656e 7420 6163 6365    Efficient acce
+00039160: 7373 2074 6f20 7468 6520 6060 666c 6167  ss to the ``flag
+00039170: 7360 6020 636f 6c75 6d6e 2069 6e20 7468  s`` column in th
+00039180: 650a 2020 2020 2020 2020 3a72 6566 3a60  e.        :ref:`
+00039190: 7365 635f 696e 6469 7669 6475 616c 5f74  sec_individual_t
+000391a0: 6162 6c65 5f64 6566 696e 6974 696f 6e60  able_definition`
+000391b0: 2061 7320 6120 6e75 6d70 7920 6172 7261   as a numpy arra
+000391c0: 7920 2864 7479 7065 3d6e 702e 7569 6e74  y (dtype=np.uint
+000391d0: 3332 292e 0a20 2020 2020 2020 2045 7175  32)..        Equ
+000391e0: 6976 616c 656e 7420 746f 2060 6074 732e  ivalent to ``ts.
+000391f0: 7461 626c 6573 2e69 6e64 6976 6964 7561  tables.individua
+00039200: 6c73 2e66 6c61 6773 6060 2028 6275 7420  ls.flags`` (but 
+00039210: 6176 6f69 6469 6e67 2074 6865 2066 756c  avoiding the ful
+00039220: 6c20 636f 7079 0a20 2020 2020 2020 206f  l copy.        o
+00039230: 6620 7468 6520 7461 626c 6520 6461 7461  f the table data
+00039240: 2074 6861 7420 6163 6365 7373 696e 6720   that accessing 
+00039250: 6060 7473 2e74 6162 6c65 7360 6020 6375  ``ts.tables`` cu
+00039260: 7272 656e 746c 7920 656e 7461 696c 7329  rrently entails)
+00039270: 2e0a 2020 2020 2020 2020 2222 220a 2020  ..        """.  
+00039280: 2020 2020 2020 7265 7475 726e 2073 656c        return sel
+00039290: 662e 5f69 6e64 6976 6964 7561 6c73 5f66  f._individuals_f
+000392a0: 6c61 6773 0a0a 2020 2020 4070 726f 7065  lags..    @prope
+000392b0: 7274 790a 2020 2020 6465 6620 6e6f 6465  rty.    def node
+000392c0: 735f 7469 6d65 2873 656c 6629 3a0a 2020  s_time(self):.  
+000392d0: 2020 2020 2020 2222 220a 2020 2020 2020        """.      
+000392e0: 2020 4566 6669 6369 656e 7420 6163 6365    Efficient acce
+000392f0: 7373 2074 6f20 7468 6520 6060 7469 6d65  ss to the ``time
+00039300: 6060 2063 6f6c 756d 6e20 696e 2074 6865  `` column in the
+00039310: 0a20 2020 2020 2020 203a 7265 663a 6073  .        :ref:`s
+00039320: 6563 5f6e 6f64 655f 7461 626c 655f 6465  ec_node_table_de
+00039330: 6669 6e69 7469 6f6e 6020 6173 2061 206e  finition` as a n
+00039340: 756d 7079 2061 7272 6179 2028 6474 7970  umpy array (dtyp
+00039350: 653d 6e70 2e66 6c6f 6174 3634 292e 0a20  e=np.float64).. 
+00039360: 2020 2020 2020 2045 7175 6976 616c 656e         Equivalen
+00039370: 7420 746f 2060 6074 732e 7461 626c 6573  t to ``ts.tables
+00039380: 2e6e 6f64 6573 2e74 696d 6560 6020 2862  .nodes.time`` (b
+00039390: 7574 2061 766f 6964 696e 6720 7468 6520  ut avoiding the 
+000393a0: 6675 6c6c 2063 6f70 790a 2020 2020 2020  full copy.      
+000393b0: 2020 6f66 2074 6865 2074 6162 6c65 2064    of the table d
+000393c0: 6174 6120 7468 6174 2061 6363 6573 7369  ata that accessi
+000393d0: 6e67 2060 6074 732e 7461 626c 6573 6060  ng ``ts.tables``
+000393e0: 2063 7572 7265 6e74 6c79 2065 6e74 6169   currently entai
+000393f0: 6c73 292e 0a20 2020 2020 2020 2022 2222  ls)..        """
+00039400: 0a20 2020 2020 2020 2072 6574 7572 6e20  .        return 
+00039410: 7365 6c66 2e5f 6e6f 6465 735f 7469 6d65  self._nodes_time
+00039420: 0a0a 2020 2020 4070 726f 7065 7274 790a  ..    @property.
+00039430: 2020 2020 6465 6620 6e6f 6465 735f 666c      def nodes_fl
+00039440: 6167 7328 7365 6c66 293a 0a20 2020 2020  ags(self):.     
+00039450: 2020 2022 2222 0a20 2020 2020 2020 2045     """.        E
+00039460: 6666 6963 6965 6e74 2061 6363 6573 7320  fficient access 
+00039470: 746f 2074 6865 2060 6066 6c61 6773 6060  to the ``flags``
+00039480: 2063 6f6c 756d 6e20 696e 2074 6865 0a20   column in the. 
+00039490: 2020 2020 2020 203a 7265 663a 6073 6563         :ref:`sec
+000394a0: 5f6e 6f64 655f 7461 626c 655f 6465 6669  _node_table_defi
+000394b0: 6e69 7469 6f6e 6020 6173 2061 206e 756d  nition` as a num
+000394c0: 7079 2061 7272 6179 2028 6474 7970 653d  py array (dtype=
+000394d0: 6e70 2e75 696e 7433 3229 2e0a 2020 2020  np.uint32)..    
+000394e0: 2020 2020 4571 7569 7661 6c65 6e74 2074      Equivalent t
+000394f0: 6f20 6060 7473 2e74 6162 6c65 732e 6e6f  o ``ts.tables.no
+00039500: 6465 732e 666c 6167 7360 6020 2862 7574  des.flags`` (but
+00039510: 2061 766f 6964 696e 6720 7468 6520 6675   avoiding the fu
+00039520: 6c6c 2063 6f70 790a 2020 2020 2020 2020  ll copy.        
+00039530: 6f66 2074 6865 2074 6162 6c65 2064 6174  of the table dat
+00039540: 6120 7468 6174 2061 6363 6573 7369 6e67  a that accessing
+00039550: 2060 6074 732e 7461 626c 6573 6060 2063   ``ts.tables`` c
+00039560: 7572 7265 6e74 6c79 2065 6e74 6169 6c73  urrently entails
+00039570: 292e 0a20 2020 2020 2020 2022 2222 0a20  )..        """. 
+00039580: 2020 2020 2020 2072 6574 7572 6e20 7365         return se
+00039590: 6c66 2e5f 6e6f 6465 735f 666c 6167 730a  lf._nodes_flags.
+000395a0: 0a20 2020 2040 7072 6f70 6572 7479 0a20  .    @property. 
+000395b0: 2020 2064 6566 206e 6f64 6573 5f70 6f70     def nodes_pop
+000395c0: 756c 6174 696f 6e28 7365 6c66 293a 0a20  ulation(self):. 
+000395d0: 2020 2020 2020 2022 2222 0a20 2020 2020         """.     
+000395e0: 2020 2045 6666 6963 6965 6e74 2061 6363     Efficient acc
+000395f0: 6573 7320 746f 2074 6865 2060 6070 6f70  ess to the ``pop
+00039600: 756c 6174 696f 6e60 6020 636f 6c75 6d6e  ulation`` column
+00039610: 2069 6e20 7468 650a 2020 2020 2020 2020   in the.        
+00039620: 3a72 6566 3a60 7365 635f 6e6f 6465 5f74  :ref:`sec_node_t
+00039630: 6162 6c65 5f64 6566 696e 6974 696f 6e60  able_definition`
+00039640: 2061 7320 6120 6e75 6d70 7920 6172 7261   as a numpy arra
+00039650: 7920 2864 7479 7065 3d6e 702e 696e 7433  y (dtype=np.int3
+00039660: 3229 2e0a 2020 2020 2020 2020 4571 7569  2)..        Equi
+00039670: 7661 6c65 6e74 2074 6f20 6060 7473 2e74  valent to ``ts.t
+00039680: 6162 6c65 732e 6e6f 6465 732e 706f 7075  ables.nodes.popu
+00039690: 6c61 7469 6f6e 6060 2028 6275 7420 6176  lation`` (but av
+000396a0: 6f69 6469 6e67 2074 6865 2066 756c 6c20  oiding the full 
+000396b0: 636f 7079 0a20 2020 2020 2020 206f 6620  copy.        of 
+000396c0: 7468 6520 7461 626c 6520 6461 7461 2074  the table data t
+000396d0: 6861 7420 6163 6365 7373 696e 6720 6060  hat accessing ``
+000396e0: 7473 2e74 6162 6c65 7360 6020 6375 7272  ts.tables`` curr
+000396f0: 656e 746c 7920 656e 7461 696c 7329 2e0a  ently entails)..
+00039700: 2020 2020 2020 2020 2222 220a 2020 2020          """.    
+00039710: 2020 2020 7265 7475 726e 2073 656c 662e      return self.
+00039720: 5f6e 6f64 6573 5f70 6f70 756c 6174 696f  _nodes_populatio
+00039730: 6e0a 0a20 2020 2040 7072 6f70 6572 7479  n..    @property
+00039740: 0a20 2020 2064 6566 206e 6f64 6573 5f69  .    def nodes_i
+00039750: 6e64 6976 6964 7561 6c28 7365 6c66 293a  ndividual(self):
+00039760: 0a20 2020 2020 2020 2022 2222 0a20 2020  .        """.   
+00039770: 2020 2020 2045 6666 6963 6965 6e74 2061       Efficient a
+00039780: 6363 6573 7320 746f 2074 6865 2060 6069  ccess to the ``i
+00039790: 6e64 6976 6964 7561 6c60 6020 636f 6c75  ndividual`` colu
+000397a0: 6d6e 2069 6e20 7468 650a 2020 2020 2020  mn in the.      
+000397b0: 2020 3a72 6566 3a60 7365 635f 6e6f 6465    :ref:`sec_node
+000397c0: 5f74 6162 6c65 5f64 6566 696e 6974 696f  _table_definitio
+000397d0: 6e60 2061 7320 6120 6e75 6d70 7920 6172  n` as a numpy ar
+000397e0: 7261 7920 2864 7479 7065 3d6e 702e 696e  ray (dtype=np.in
+000397f0: 7433 3229 2e0a 2020 2020 2020 2020 4571  t32)..        Eq
+00039800: 7569 7661 6c65 6e74 2074 6f20 6060 7473  uivalent to ``ts
+00039810: 2e74 6162 6c65 732e 6e6f 6465 732e 696e  .tables.nodes.in
+00039820: 6469 7669 6475 616c 6060 2028 6275 7420  dividual`` (but 
+00039830: 6176 6f69 6469 6e67 2074 6865 2066 756c  avoiding the ful
+00039840: 6c20 636f 7079 0a20 2020 2020 2020 206f  l copy.        o
+00039850: 6620 7468 6520 7461 626c 6520 6461 7461  f the table data
+00039860: 2074 6861 7420 6163 6365 7373 696e 6720   that accessing 
+00039870: 6060 7473 2e74 6162 6c65 7360 6020 6375  ``ts.tables`` cu
+00039880: 7272 656e 746c 7920 656e 7461 696c 7329  rrently entails)
+00039890: 2e0a 2020 2020 2020 2020 2222 220a 2020  ..        """.  
+000398a0: 2020 2020 2020 7265 7475 726e 2073 656c        return sel
+000398b0: 662e 5f6e 6f64 6573 5f69 6e64 6976 6964  f._nodes_individ
+000398c0: 7561 6c0a 0a20 2020 2040 7072 6f70 6572  ual..    @proper
+000398d0: 7479 0a20 2020 2064 6566 2065 6467 6573  ty.    def edges
+000398e0: 5f6c 6566 7428 7365 6c66 293a 0a20 2020  _left(self):.   
+000398f0: 2020 2020 2022 2222 0a20 2020 2020 2020       """.       
+00039900: 2045 6666 6963 6965 6e74 2061 6363 6573   Efficient acces
+00039910: 7320 746f 2074 6865 2060 606c 6566 7460  s to the ``left`
+00039920: 6020 636f 6c75 6d6e 2069 6e20 7468 650a  ` column in the.
+00039930: 2020 2020 2020 2020 3a72 6566 3a60 7365          :ref:`se
+00039940: 635f 6564 6765 5f74 6162 6c65 5f64 6566  c_edge_table_def
+00039950: 696e 6974 696f 6e60 2061 7320 6120 6e75  inition` as a nu
+00039960: 6d70 7920 6172 7261 7920 2864 7479 7065  mpy array (dtype
+00039970: 3d6e 702e 666c 6f61 7436 3429 2e0a 2020  =np.float64)..  
+00039980: 2020 2020 2020 4571 7569 7661 6c65 6e74        Equivalent
+00039990: 2074 6f20 6060 7473 2e74 6162 6c65 732e   to ``ts.tables.
+000399a0: 6564 6765 732e 6c65 6674 6060 2028 6275  edges.left`` (bu
+000399b0: 7420 6176 6f69 6469 6e67 2074 6865 2066  t avoiding the f
+000399c0: 756c 6c20 636f 7079 0a20 2020 2020 2020  ull copy.       
+000399d0: 206f 6620 7468 6520 7461 626c 6520 6461   of the table da
+000399e0: 7461 2074 6861 7420 6163 6365 7373 696e  ta that accessin
+000399f0: 6720 6060 7473 2e74 6162 6c65 7360 6020  g ``ts.tables`` 
+00039a00: 6375 7272 656e 746c 7920 656e 7461 696c  currently entail
+00039a10: 7329 2e0a 2020 2020 2020 2020 2222 220a  s)..        """.
+00039a20: 2020 2020 2020 2020 7265 7475 726e 2073          return s
+00039a30: 656c 662e 5f65 6467 6573 5f6c 6566 740a  elf._edges_left.
+00039a40: 0a20 2020 2040 7072 6f70 6572 7479 0a20  .    @property. 
+00039a50: 2020 2064 6566 2065 6467 6573 5f72 6967     def edges_rig
+00039a60: 6874 2873 656c 6629 3a0a 2020 2020 2020  ht(self):.      
+00039a70: 2020 2222 220a 2020 2020 2020 2020 4566    """.        Ef
+00039a80: 6669 6369 656e 7420 6163 6365 7373 2074  ficient access t
+00039a90: 6f20 7468 6520 6060 7269 6768 7460 6020  o the ``right`` 
+00039aa0: 636f 6c75 6d6e 2069 6e20 7468 650a 2020  column in the.  
+00039ab0: 2020 2020 2020 3a72 6566 3a60 7365 635f        :ref:`sec_
+00039ac0: 6564 6765 5f74 6162 6c65 5f64 6566 696e  edge_table_defin
+00039ad0: 6974 696f 6e60 2061 7320 6120 6e75 6d70  ition` as a nump
+00039ae0: 7920 6172 7261 7920 2864 7479 7065 3d6e  y array (dtype=n
+00039af0: 702e 666c 6f61 7436 3429 2e0a 2020 2020  p.float64)..    
+00039b00: 2020 2020 4571 7569 7661 6c65 6e74 2074      Equivalent t
+00039b10: 6f20 6060 7473 2e74 6162 6c65 732e 6564  o ``ts.tables.ed
+00039b20: 6765 732e 7269 6768 7460 6020 2862 7574  ges.right`` (but
+00039b30: 2061 766f 6964 696e 6720 7468 6520 6675   avoiding the fu
+00039b40: 6c6c 2063 6f70 790a 2020 2020 2020 2020  ll copy.        
+00039b50: 6f66 2074 6865 2074 6162 6c65 2064 6174  of the table dat
+00039b60: 6120 7468 6174 2061 6363 6573 7369 6e67  a that accessing
+00039b70: 2060 6074 732e 7461 626c 6573 6060 2063   ``ts.tables`` c
+00039b80: 7572 7265 6e74 6c79 2065 6e74 6169 6c73  urrently entails
+00039b90: 292e 0a20 2020 2020 2020 2022 2222 0a20  )..        """. 
+00039ba0: 2020 2020 2020 2072 6574 7572 6e20 7365         return se
+00039bb0: 6c66 2e5f 6564 6765 735f 7269 6768 740a  lf._edges_right.
+00039bc0: 0a20 2020 2040 7072 6f70 6572 7479 0a20  .    @property. 
+00039bd0: 2020 2064 6566 2065 6467 6573 5f70 6172     def edges_par
+00039be0: 656e 7428 7365 6c66 293a 0a20 2020 2020  ent(self):.     
+00039bf0: 2020 2022 2222 0a20 2020 2020 2020 2045     """.        E
+00039c00: 6666 6963 6965 6e74 2061 6363 6573 7320  fficient access 
+00039c10: 746f 2074 6865 2060 6070 6172 656e 7460  to the ``parent`
+00039c20: 6020 636f 6c75 6d6e 2069 6e20 7468 650a  ` column in the.
+00039c30: 2020 2020 2020 2020 3a72 6566 3a60 7365          :ref:`se
+00039c40: 635f 6564 6765 5f74 6162 6c65 5f64 6566  c_edge_table_def
+00039c50: 696e 6974 696f 6e60 2061 7320 6120 6e75  inition` as a nu
+00039c60: 6d70 7920 6172 7261 7920 2864 7479 7065  mpy array (dtype
+00039c70: 3d6e 702e 696e 7433 3229 2e0a 2020 2020  =np.int32)..    
+00039c80: 2020 2020 4571 7569 7661 6c65 6e74 2074      Equivalent t
+00039c90: 6f20 6060 7473 2e74 6162 6c65 732e 6564  o ``ts.tables.ed
+00039ca0: 6765 732e 7061 7265 6e74 6060 2028 6275  ges.parent`` (bu
+00039cb0: 7420 6176 6f69 6469 6e67 2074 6865 2066  t avoiding the f
+00039cc0: 756c 6c20 636f 7079 0a20 2020 2020 2020  ull copy.       
+00039cd0: 206f 6620 7468 6520 7461 626c 6520 6461   of the table da
+00039ce0: 7461 2074 6861 7420 6163 6365 7373 696e  ta that accessin
+00039cf0: 6720 6060 7473 2e74 6162 6c65 7360 6020  g ``ts.tables`` 
+00039d00: 6375 7272 656e 746c 7920 656e 7461 696c  currently entail
+00039d10: 7329 2e0a 2020 2020 2020 2020 2222 220a  s)..        """.
+00039d20: 2020 2020 2020 2020 7265 7475 726e 2073          return s
+00039d30: 656c 662e 5f65 6467 6573 5f70 6172 656e  elf._edges_paren
+00039d40: 740a 0a20 2020 2040 7072 6f70 6572 7479  t..    @property
+00039d50: 0a20 2020 2064 6566 2065 6467 6573 5f63  .    def edges_c
+00039d60: 6869 6c64 2873 656c 6629 3a0a 2020 2020  hild(self):.    
+00039d70: 2020 2020 2222 220a 2020 2020 2020 2020      """.        
+00039d80: 4566 6669 6369 656e 7420 6163 6365 7373  Efficient access
+00039d90: 2074 6f20 7468 6520 6060 6368 696c 6460   to the ``child`
+00039da0: 6020 636f 6c75 6d6e 2069 6e20 7468 650a  ` column in the.
+00039db0: 2020 2020 2020 2020 3a72 6566 3a60 7365          :ref:`se
+00039dc0: 635f 6564 6765 5f74 6162 6c65 5f64 6566  c_edge_table_def
+00039dd0: 696e 6974 696f 6e60 2061 7320 6120 6e75  inition` as a nu
+00039de0: 6d70 7920 6172 7261 7920 2864 7479 7065  mpy array (dtype
+00039df0: 3d6e 702e 696e 7433 3229 2e0a 2020 2020  =np.int32)..    
+00039e00: 2020 2020 4571 7569 7661 6c65 6e74 2074      Equivalent t
+00039e10: 6f20 6060 7473 2e74 6162 6c65 732e 6564  o ``ts.tables.ed
+00039e20: 6765 732e 6368 696c 6460 6020 2862 7574  ges.child`` (but
+00039e30: 2061 766f 6964 696e 6720 7468 6520 6675   avoiding the fu
+00039e40: 6c6c 2063 6f70 790a 2020 2020 2020 2020  ll copy.        
+00039e50: 6f66 2074 6865 2074 6162 6c65 2064 6174  of the table dat
+00039e60: 6120 7468 6174 2061 6363 6573 7369 6e67  a that accessing
+00039e70: 2060 6074 732e 7461 626c 6573 6060 2063   ``ts.tables`` c
+00039e80: 7572 7265 6e74 6c79 2065 6e74 6169 6c73  urrently entails
+00039e90: 292e 0a20 2020 2020 2020 2022 2222 0a20  )..        """. 
+00039ea0: 2020 2020 2020 2072 6574 7572 6e20 7365         return se
+00039eb0: 6c66 2e5f 6564 6765 735f 6368 696c 640a  lf._edges_child.
+00039ec0: 0a20 2020 2040 7072 6f70 6572 7479 0a20  .    @property. 
+00039ed0: 2020 2064 6566 2073 6974 6573 5f70 6f73     def sites_pos
+00039ee0: 6974 696f 6e28 7365 6c66 293a 0a20 2020  ition(self):.   
+00039ef0: 2020 2020 2022 2222 0a20 2020 2020 2020       """.       
+00039f00: 2045 6666 6963 6965 6e74 2061 6363 6573   Efficient acces
+00039f10: 7320 746f 2074 6865 2060 6070 6f73 6974  s to the ``posit
+00039f20: 696f 6e60 6020 636f 6c75 6d6e 2069 6e20  ion`` column in 
+00039f30: 7468 650a 2020 2020 2020 2020 3a72 6566  the.        :ref
+00039f40: 3a60 7365 635f 7369 7465 5f74 6162 6c65  :`sec_site_table
+00039f50: 5f64 6566 696e 6974 696f 6e60 2061 7320  _definition` as 
+00039f60: 6120 6e75 6d70 7920 6172 7261 7920 2864  a numpy array (d
+00039f70: 7479 7065 3d6e 702e 666c 6f61 7436 3429  type=np.float64)
+00039f80: 2e0a 2020 2020 2020 2020 4571 7569 7661  ..        Equiva
+00039f90: 6c65 6e74 2074 6f20 6060 7473 2e74 6162  lent to ``ts.tab
+00039fa0: 6c65 732e 7369 7465 732e 706f 7369 7469  les.sites.positi
+00039fb0: 6f6e 6060 2028 6275 7420 6176 6f69 6469  on`` (but avoidi
+00039fc0: 6e67 2074 6865 2066 756c 6c20 636f 7079  ng the full copy
+00039fd0: 0a20 2020 2020 2020 206f 6620 7468 6520  .        of the 
+00039fe0: 7461 626c 6520 6461 7461 2074 6861 7420  table data that 
+00039ff0: 6163 6365 7373 696e 6720 6060 7473 2e74  accessing ``ts.t
+0003a000: 6162 6c65 7360 6020 6375 7272 656e 746c  ables`` currentl
+0003a010: 7920 656e 7461 696c 7329 2e0a 2020 2020  y entails)..    
+0003a020: 2020 2020 2222 220a 2020 2020 2020 2020      """.        
+0003a030: 7265 7475 726e 2073 656c 662e 5f73 6974  return self._sit
+0003a040: 6573 5f70 6f73 6974 696f 6e0a 0a20 2020  es_position..   
+0003a050: 2040 7072 6f70 6572 7479 0a20 2020 2064   @property.    d
+0003a060: 6566 206d 7574 6174 696f 6e73 5f73 6974  ef mutations_sit
+0003a070: 6528 7365 6c66 293a 0a20 2020 2020 2020  e(self):.       
+0003a080: 2022 2222 0a20 2020 2020 2020 2045 6666   """.        Eff
+0003a090: 6963 6965 6e74 2061 6363 6573 7320 746f  icient access to
+0003a0a0: 2074 6865 2060 6073 6974 6560 6020 636f   the ``site`` co
+0003a0b0: 6c75 6d6e 2069 6e20 7468 650a 2020 2020  lumn in the.    
+0003a0c0: 2020 2020 3a72 6566 3a60 7365 635f 6d75      :ref:`sec_mu
+0003a0d0: 7461 7469 6f6e 5f74 6162 6c65 5f64 6566  tation_table_def
+0003a0e0: 696e 6974 696f 6e60 2061 7320 6120 6e75  inition` as a nu
+0003a0f0: 6d70 7920 6172 7261 7920 2864 7479 7065  mpy array (dtype
+0003a100: 3d6e 702e 696e 7433 3229 2e0a 2020 2020  =np.int32)..    
+0003a110: 2020 2020 4571 7569 7661 6c65 6e74 2074      Equivalent t
+0003a120: 6f20 6060 7473 2e74 6162 6c65 732e 6d75  o ``ts.tables.mu
+0003a130: 7461 7469 6f6e 732e 7369 7465 6060 2028  tations.site`` (
+0003a140: 6275 7420 6176 6f69 6469 6e67 2074 6865  but avoiding the
+0003a150: 2066 756c 6c20 636f 7079 0a20 2020 2020   full copy.     
+0003a160: 2020 206f 6620 7468 6520 7461 626c 6520     of the table 
+0003a170: 6461 7461 2074 6861 7420 6163 6365 7373  data that access
+0003a180: 696e 6720 6060 7473 2e74 6162 6c65 7360  ing ``ts.tables`
+0003a190: 6020 6375 7272 656e 746c 7920 656e 7461  ` currently enta
+0003a1a0: 696c 7329 2e0a 2020 2020 2020 2020 2222  ils)..        ""
+0003a1b0: 220a 2020 2020 2020 2020 7265 7475 726e  ".        return
+0003a1c0: 2073 656c 662e 5f6d 7574 6174 696f 6e73   self._mutations
+0003a1d0: 5f73 6974 650a 0a20 2020 2040 7072 6f70  _site..    @prop
+0003a1e0: 6572 7479 0a20 2020 2064 6566 206d 7574  erty.    def mut
+0003a1f0: 6174 696f 6e73 5f6e 6f64 6528 7365 6c66  ations_node(self
+0003a200: 293a 0a20 2020 2020 2020 2022 2222 0a20  ):.        """. 
+0003a210: 2020 2020 2020 2045 6666 6963 6965 6e74         Efficient
+0003a220: 2061 6363 6573 7320 746f 2074 6865 2060   access to the `
+0003a230: 606e 6f64 6560 6020 636f 6c75 6d6e 2069  `node`` column i
+0003a240: 6e20 7468 650a 2020 2020 2020 2020 3a72  n the.        :r
+0003a250: 6566 3a60 7365 635f 6d75 7461 7469 6f6e  ef:`sec_mutation
+0003a260: 5f74 6162 6c65 5f64 6566 696e 6974 696f  _table_definitio
+0003a270: 6e60 2061 7320 6120 6e75 6d70 7920 6172  n` as a numpy ar
+0003a280: 7261 7920 2864 7479 7065 3d6e 702e 696e  ray (dtype=np.in
+0003a290: 7433 3229 2e0a 2020 2020 2020 2020 4571  t32)..        Eq
+0003a2a0: 7569 7661 6c65 6e74 2074 6f20 6060 7473  uivalent to ``ts
+0003a2b0: 2e74 6162 6c65 732e 6d75 7461 7469 6f6e  .tables.mutation
+0003a2c0: 732e 6e6f 6465 6060 2028 6275 7420 6176  s.node`` (but av
+0003a2d0: 6f69 6469 6e67 2074 6865 2066 756c 6c20  oiding the full 
+0003a2e0: 636f 7079 0a20 2020 2020 2020 206f 6620  copy.        of 
+0003a2f0: 7468 6520 7461 626c 6520 6461 7461 2074  the table data t
+0003a300: 6861 7420 6163 6365 7373 696e 6720 6060  hat accessing ``
+0003a310: 7473 2e74 6162 6c65 7360 6020 6375 7272  ts.tables`` curr
+0003a320: 656e 746c 7920 656e 7461 696c 7329 2e0a  ently entails)..
+0003a330: 2020 2020 2020 2020 2222 220a 2020 2020          """.    
+0003a340: 2020 2020 7265 7475 726e 2073 656c 662e      return self.
+0003a350: 5f6d 7574 6174 696f 6e73 5f6e 6f64 650a  _mutations_node.
+0003a360: 0a20 2020 2040 7072 6f70 6572 7479 0a20  .    @property. 
+0003a370: 2020 2064 6566 206d 7574 6174 696f 6e73     def mutations
+0003a380: 5f70 6172 656e 7428 7365 6c66 293a 0a20  _parent(self):. 
+0003a390: 2020 2020 2020 2022 2222 0a20 2020 2020         """.     
+0003a3a0: 2020 2045 6666 6963 6965 6e74 2061 6363     Efficient acc
+0003a3b0: 6573 7320 746f 2074 6865 2060 6070 6172  ess to the ``par
+0003a3c0: 656e 7460 6020 636f 6c75 6d6e 2069 6e20  ent`` column in 
+0003a3d0: 7468 650a 2020 2020 2020 2020 3a72 6566  the.        :ref
+0003a3e0: 3a60 7365 635f 6d75 7461 7469 6f6e 5f74  :`sec_mutation_t
+0003a3f0: 6162 6c65 5f64 6566 696e 6974 696f 6e60  able_definition`
+0003a400: 2061 7320 6120 6e75 6d70 7920 6172 7261   as a numpy arra
+0003a410: 7920 2864 7479 7065 3d6e 702e 696e 7433  y (dtype=np.int3
+0003a420: 3229 2e0a 2020 2020 2020 2020 4571 7569  2)..        Equi
+0003a430: 7661 6c65 6e74 2074 6f20 6060 7473 2e74  valent to ``ts.t
+0003a440: 6162 6c65 732e 6d75 7461 7469 6f6e 732e  ables.mutations.
+0003a450: 7061 7265 6e74 6060 2028 6275 7420 6176  parent`` (but av
+0003a460: 6f69 6469 6e67 2074 6865 2066 756c 6c20  oiding the full 
+0003a470: 636f 7079 0a20 2020 2020 2020 206f 6620  copy.        of 
+0003a480: 7468 6520 7461 626c 6520 6461 7461 2074  the table data t
+0003a490: 6861 7420 6163 6365 7373 696e 6720 6060  hat accessing ``
+0003a4a0: 7473 2e74 6162 6c65 7360 6020 6375 7272  ts.tables`` curr
+0003a4b0: 656e 746c 7920 656e 7461 696c 7329 2e0a  ently entails)..
+0003a4c0: 2020 2020 2020 2020 2222 220a 2020 2020          """.    
+0003a4d0: 2020 2020 7265 7475 726e 2073 656c 662e      return self.
+0003a4e0: 5f6d 7574 6174 696f 6e73 5f70 6172 656e  _mutations_paren
+0003a4f0: 740a 0a20 2020 2040 7072 6f70 6572 7479  t..    @property
+0003a500: 0a20 2020 2064 6566 206d 7574 6174 696f  .    def mutatio
+0003a510: 6e73 5f74 696d 6528 7365 6c66 293a 0a20  ns_time(self):. 
+0003a520: 2020 2020 2020 2022 2222 0a20 2020 2020         """.     
+0003a530: 2020 2045 6666 6963 6965 6e74 2061 6363     Efficient acc
+0003a540: 6573 7320 746f 2074 6865 2060 6074 696d  ess to the ``tim
+0003a550: 6560 6020 636f 6c75 6d6e 2069 6e20 7468  e`` column in th
+0003a560: 650a 2020 2020 2020 2020 3a72 6566 3a60  e.        :ref:`
+0003a570: 7365 635f 6d75 7461 7469 6f6e 5f74 6162  sec_mutation_tab
+0003a580: 6c65 5f64 6566 696e 6974 696f 6e60 2061  le_definition` a
+0003a590: 7320 6120 6e75 6d70 7920 6172 7261 7920  s a numpy array 
+0003a5a0: 2864 7479 7065 3d6e 702e 666c 6f61 7436  (dtype=np.float6
+0003a5b0: 3429 2e0a 2020 2020 2020 2020 4571 7569  4)..        Equi
+0003a5c0: 7661 6c65 6e74 2074 6f20 6060 7473 2e74  valent to ``ts.t
+0003a5d0: 6162 6c65 732e 6d75 7461 7469 6f6e 732e  ables.mutations.
+0003a5e0: 7469 6d65 6060 2028 6275 7420 6176 6f69  time`` (but avoi
+0003a5f0: 6469 6e67 2074 6865 2066 756c 6c20 636f  ding the full co
+0003a600: 7079 0a20 2020 2020 2020 206f 6620 7468  py.        of th
+0003a610: 6520 7461 626c 6520 6461 7461 2074 6861  e table data tha
+0003a620: 7420 6163 6365 7373 696e 6720 6060 7473  t accessing ``ts
+0003a630: 2e74 6162 6c65 7360 6020 6375 7272 656e  .tables`` curren
+0003a640: 746c 7920 656e 7461 696c 7329 2e0a 2020  tly entails)..  
+0003a650: 2020 2020 2020 2222 220a 2020 2020 2020        """.      
+0003a660: 2020 7265 7475 726e 2073 656c 662e 5f6d    return self._m
+0003a670: 7574 6174 696f 6e73 5f74 696d 650a 0a20  utations_time.. 
+0003a680: 2020 2040 7072 6f70 6572 7479 0a20 2020     @property.   
+0003a690: 2064 6566 206d 6967 7261 7469 6f6e 735f   def migrations_
+0003a6a0: 6c65 6674 2873 656c 6629 3a0a 2020 2020  left(self):.    
+0003a6b0: 2020 2020 2222 220a 2020 2020 2020 2020      """.        
+0003a6c0: 4566 6669 6369 656e 7420 6163 6365 7373  Efficient access
+0003a6d0: 2074 6f20 7468 6520 6060 6c65 6674 6060   to the ``left``
+0003a6e0: 2063 6f6c 756d 6e20 696e 2074 6865 0a20   column in the. 
+0003a6f0: 2020 2020 2020 203a 7265 663a 6073 6563         :ref:`sec
+0003a700: 5f6d 6967 7261 7469 6f6e 5f74 6162 6c65  _migration_table
+0003a710: 5f64 6566 696e 6974 696f 6e60 2061 7320  _definition` as 
+0003a720: 6120 6e75 6d70 7920 6172 7261 7920 2864  a numpy array (d
+0003a730: 7479 7065 3d6e 702e 666c 6f61 7436 3429  type=np.float64)
+0003a740: 2e0a 2020 2020 2020 2020 4571 7569 7661  ..        Equiva
+0003a750: 6c65 6e74 2074 6f20 6060 7473 2e74 6162  lent to ``ts.tab
+0003a760: 6c65 732e 6d69 6772 6174 696f 6e73 2e6c  les.migrations.l
+0003a770: 6566 7460 6020 2862 7574 2061 766f 6964  eft`` (but avoid
+0003a780: 696e 6720 7468 6520 6675 6c6c 2063 6f70  ing the full cop
+0003a790: 790a 2020 2020 2020 2020 6f66 2074 6865  y.        of the
+0003a7a0: 2074 6162 6c65 2064 6174 6120 7468 6174   table data that
+0003a7b0: 2061 6363 6573 7369 6e67 2060 6074 732e   accessing ``ts.
+0003a7c0: 7461 626c 6573 6060 2063 7572 7265 6e74  tables`` current
+0003a7d0: 6c79 2065 6e74 6169 6c73 292e 0a20 2020  ly entails)..   
+0003a7e0: 2020 2020 2022 2222 0a20 2020 2020 2020       """.       
+0003a7f0: 2072 6574 7572 6e20 7365 6c66 2e5f 6d69   return self._mi
+0003a800: 6772 6174 696f 6e73 5f6c 6566 740a 0a20  grations_left.. 
+0003a810: 2020 2040 7072 6f70 6572 7479 0a20 2020     @property.   
+0003a820: 2064 6566 206d 6967 7261 7469 6f6e 735f   def migrations_
+0003a830: 7269 6768 7428 7365 6c66 293a 0a20 2020  right(self):.   
+0003a840: 2020 2020 2022 2222 0a20 2020 2020 2020       """.       
+0003a850: 2045 6666 6963 6965 6e74 2061 6363 6573   Efficient acces
+0003a860: 7320 746f 2074 6865 2060 6072 6967 6874  s to the ``right
+0003a870: 6060 2063 6f6c 756d 6e20 696e 2074 6865  `` column in the
+0003a880: 0a20 2020 2020 2020 203a 7265 663a 6073  .        :ref:`s
+0003a890: 6563 5f6d 6967 7261 7469 6f6e 5f74 6162  ec_migration_tab
+0003a8a0: 6c65 5f64 6566 696e 6974 696f 6e60 2061  le_definition` a
+0003a8b0: 7320 6120 6e75 6d70 7920 6172 7261 7920  s a numpy array 
+0003a8c0: 2864 7479 7065 3d6e 702e 666c 6f61 7436  (dtype=np.float6
+0003a8d0: 3429 2e0a 2020 2020 2020 2020 4571 7569  4)..        Equi
+0003a8e0: 7661 6c65 6e74 2074 6f20 6060 7473 2e74  valent to ``ts.t
+0003a8f0: 6162 6c65 732e 6d69 6772 6174 696f 6e73  ables.migrations
+0003a900: 2e72 6967 6874 6060 2028 6275 7420 6176  .right`` (but av
+0003a910: 6f69 6469 6e67 2074 6865 2066 756c 6c20  oiding the full 
+0003a920: 636f 7079 0a20 2020 2020 2020 206f 6620  copy.        of 
+0003a930: 7468 6520 7461 626c 6520 6461 7461 2074  the table data t
+0003a940: 6861 7420 6163 6365 7373 696e 6720 6060  hat accessing ``
+0003a950: 7473 2e74 6162 6c65 7360 6020 6375 7272  ts.tables`` curr
+0003a960: 656e 746c 7920 656e 7461 696c 7329 2e0a  ently entails)..
+0003a970: 2020 2020 2020 2020 2222 220a 2020 2020          """.    
+0003a980: 2020 2020 7265 7475 726e 2073 656c 662e      return self.
+0003a990: 5f6d 6967 7261 7469 6f6e 735f 7269 6768  _migrations_righ
+0003a9a0: 740a 0a20 2020 2040 7072 6f70 6572 7479  t..    @property
+0003a9b0: 0a20 2020 2064 6566 206d 6967 7261 7469  .    def migrati
+0003a9c0: 6f6e 735f 6e6f 6465 2873 656c 6629 3a0a  ons_node(self):.
+0003a9d0: 2020 2020 2020 2020 2222 220a 2020 2020          """.    
+0003a9e0: 2020 2020 4566 6669 6369 656e 7420 6163      Efficient ac
+0003a9f0: 6365 7373 2074 6f20 7468 6520 6060 6e6f  cess to the ``no
+0003aa00: 6465 6060 2063 6f6c 756d 6e20 696e 2074  de`` column in t
+0003aa10: 6865 0a20 2020 2020 2020 203a 7265 663a  he.        :ref:
+0003aa20: 6073 6563 5f6d 6967 7261 7469 6f6e 5f74  `sec_migration_t
+0003aa30: 6162 6c65 5f64 6566 696e 6974 696f 6e60  able_definition`
+0003aa40: 2061 7320 6120 6e75 6d70 7920 6172 7261   as a numpy arra
+0003aa50: 7920 2864 7479 7065 3d6e 702e 696e 7433  y (dtype=np.int3
+0003aa60: 3229 2e0a 2020 2020 2020 2020 4571 7569  2)..        Equi
+0003aa70: 7661 6c65 6e74 2074 6f20 6060 7473 2e74  valent to ``ts.t
+0003aa80: 6162 6c65 732e 6d69 6772 6174 696f 6e73  ables.migrations
+0003aa90: 2e6e 6f64 6560 6020 2862 7574 2061 766f  .node`` (but avo
+0003aaa0: 6964 696e 6720 7468 6520 6675 6c6c 2063  iding the full c
+0003aab0: 6f70 790a 2020 2020 2020 2020 6f66 2074  opy.        of t
+0003aac0: 6865 2074 6162 6c65 2064 6174 6120 7468  he table data th
+0003aad0: 6174 2061 6363 6573 7369 6e67 2060 6074  at accessing ``t
+0003aae0: 732e 7461 626c 6573 6060 2063 7572 7265  s.tables`` curre
+0003aaf0: 6e74 6c79 2065 6e74 6169 6c73 292e 0a20  ntly entails).. 
+0003ab00: 2020 2020 2020 2022 2222 0a20 2020 2020         """.     
+0003ab10: 2020 2072 6574 7572 6e20 7365 6c66 2e5f     return self._
+0003ab20: 6d69 6772 6174 696f 6e73 5f6e 6f64 650a  migrations_node.
+0003ab30: 0a20 2020 2040 7072 6f70 6572 7479 0a20  .    @property. 
+0003ab40: 2020 2064 6566 206d 6967 7261 7469 6f6e     def migration
+0003ab50: 735f 736f 7572 6365 2873 656c 6629 3a0a  s_source(self):.
+0003ab60: 2020 2020 2020 2020 2222 220a 2020 2020          """.    
+0003ab70: 2020 2020 4566 6669 6369 656e 7420 6163      Efficient ac
+0003ab80: 6365 7373 2074 6f20 7468 6520 6060 736f  cess to the ``so
+0003ab90: 7572 6365 6060 2063 6f6c 756d 6e20 696e  urce`` column in
+0003aba0: 2074 6865 0a20 2020 2020 2020 203a 7265   the.        :re
+0003abb0: 663a 6073 6563 5f6d 6967 7261 7469 6f6e  f:`sec_migration
+0003abc0: 5f74 6162 6c65 5f64 6566 696e 6974 696f  _table_definitio
+0003abd0: 6e60 2061 7320 6120 6e75 6d70 7920 6172  n` as a numpy ar
+0003abe0: 7261 7920 2864 7479 7065 3d6e 702e 696e  ray (dtype=np.in
+0003abf0: 7433 3229 2e0a 2020 2020 2020 2020 4571  t32)..        Eq
+0003ac00: 7569 7661 6c65 6e74 2074 6f20 6060 7473  uivalent to ``ts
+0003ac10: 2e74 6162 6c65 732e 6d69 6772 6174 696f  .tables.migratio
+0003ac20: 6e73 2e73 6f75 7263 6560 6020 2862 7574  ns.source`` (but
+0003ac30: 2061 766f 6964 696e 6720 7468 6520 6675   avoiding the fu
+0003ac40: 6c6c 2063 6f70 790a 2020 2020 2020 2020  ll copy.        
+0003ac50: 6f66 2074 6865 2074 6162 6c65 2064 6174  of the table dat
+0003ac60: 6120 7468 6174 2061 6363 6573 7369 6e67  a that accessing
+0003ac70: 2060 6074 732e 7461 626c 6573 6060 2063   ``ts.tables`` c
+0003ac80: 7572 7265 6e74 6c79 2065 6e74 6169 6c73  urrently entails
+0003ac90: 292e 0a20 2020 2020 2020 2022 2222 0a20  )..        """. 
+0003aca0: 2020 2020 2020 2072 6574 7572 6e20 7365         return se
+0003acb0: 6c66 2e5f 6d69 6772 6174 696f 6e73 5f73  lf._migrations_s
+0003acc0: 6f75 7263 650a 0a20 2020 2040 7072 6f70  ource..    @prop
+0003acd0: 6572 7479 0a20 2020 2064 6566 206d 6967  erty.    def mig
+0003ace0: 7261 7469 6f6e 735f 6465 7374 2873 656c  rations_dest(sel
+0003acf0: 6629 3a0a 2020 2020 2020 2020 2222 220a  f):.        """.
+0003ad00: 2020 2020 2020 2020 4566 6669 6369 656e          Efficien
+0003ad10: 7420 6163 6365 7373 2074 6f20 7468 6520  t access to the 
+0003ad20: 6060 6465 7374 6060 2063 6f6c 756d 6e20  ``dest`` column 
+0003ad30: 696e 2074 6865 0a20 2020 2020 2020 203a  in the.        :
+0003ad40: 7265 663a 6073 6563 5f6d 6967 7261 7469  ref:`sec_migrati
+0003ad50: 6f6e 5f74 6162 6c65 5f64 6566 696e 6974  on_table_definit
+0003ad60: 696f 6e60 2061 7320 6120 6e75 6d70 7920  ion` as a numpy 
+0003ad70: 6172 7261 7920 2864 7479 7065 3d6e 702e  array (dtype=np.
+0003ad80: 696e 7433 3229 2e0a 2020 2020 2020 2020  int32)..        
+0003ad90: 4571 7569 7661 6c65 6e74 2074 6f20 6060  Equivalent to ``
+0003ada0: 7473 2e74 6162 6c65 732e 6d69 6772 6174  ts.tables.migrat
+0003adb0: 696f 6e73 2e64 6573 7460 6020 2862 7574  ions.dest`` (but
+0003adc0: 2061 766f 6964 696e 6720 7468 6520 6675   avoiding the fu
+0003add0: 6c6c 2063 6f70 790a 2020 2020 2020 2020  ll copy.        
+0003ade0: 6f66 2074 6865 2074 6162 6c65 2064 6174  of the table dat
+0003adf0: 6120 7468 6174 2061 6363 6573 7369 6e67  a that accessing
+0003ae00: 2060 6074 732e 7461 626c 6573 6060 2063   ``ts.tables`` c
+0003ae10: 7572 7265 6e74 6c79 2065 6e74 6169 6c73  urrently entails
+0003ae20: 292e 0a20 2020 2020 2020 2022 2222 0a20  )..        """. 
+0003ae30: 2020 2020 2020 2072 6574 7572 6e20 7365         return se
+0003ae40: 6c66 2e5f 6d69 6772 6174 696f 6e73 5f64  lf._migrations_d
+0003ae50: 6573 740a 0a20 2020 2040 7072 6f70 6572  est..    @proper
+0003ae60: 7479 0a20 2020 2064 6566 206d 6967 7261  ty.    def migra
+0003ae70: 7469 6f6e 735f 7469 6d65 2873 656c 6629  tions_time(self)
+0003ae80: 3a0a 2020 2020 2020 2020 2222 220a 2020  :.        """.  
+0003ae90: 2020 2020 2020 4566 6669 6369 656e 7420        Efficient 
+0003aea0: 6163 6365 7373 2074 6f20 7468 6520 6060  access to the ``
+0003aeb0: 7469 6d65 6060 2063 6f6c 756d 6e20 696e  time`` column in
+0003aec0: 2074 6865 0a20 2020 2020 2020 203a 7265   the.        :re
+0003aed0: 663a 6073 6563 5f6d 6967 7261 7469 6f6e  f:`sec_migration
+0003aee0: 5f74 6162 6c65 5f64 6566 696e 6974 696f  _table_definitio
+0003aef0: 6e60 2061 7320 6120 6e75 6d70 7920 6172  n` as a numpy ar
+0003af00: 7261 7920 2864 7479 7065 3d6e 702e 666c  ray (dtype=np.fl
+0003af10: 6f61 7436 3429 2e0a 2020 2020 2020 2020  oat64)..        
+0003af20: 4571 7569 7661 6c65 6e74 2074 6f20 6060  Equivalent to ``
+0003af30: 7473 2e74 6162 6c65 732e 6d69 6772 6174  ts.tables.migrat
+0003af40: 696f 6e73 2e74 696d 6560 6020 2862 7574  ions.time`` (but
+0003af50: 2061 766f 6964 696e 6720 7468 6520 6675   avoiding the fu
+0003af60: 6c6c 2063 6f70 790a 2020 2020 2020 2020  ll copy.        
+0003af70: 6f66 2074 6865 2074 6162 6c65 2064 6174  of the table dat
+0003af80: 6120 7468 6174 2061 6363 6573 7369 6e67  a that accessing
+0003af90: 2060 6074 732e 7461 626c 6573 6060 2063   ``ts.tables`` c
+0003afa0: 7572 7265 6e74 6c79 2065 6e74 6169 6c73  urrently entails
+0003afb0: 292e 0a20 2020 2020 2020 2022 2222 0a20  )..        """. 
+0003afc0: 2020 2020 2020 2072 6574 7572 6e20 7365         return se
+0003afd0: 6c66 2e5f 6d69 6772 6174 696f 6e73 5f74  lf._migrations_t
+0003afe0: 696d 650a 0a20 2020 2040 7072 6f70 6572  ime..    @proper
+0003aff0: 7479 0a20 2020 2064 6566 2069 6e64 6578  ty.    def index
+0003b000: 6573 5f65 6467 655f 696e 7365 7274 696f  es_edge_insertio
+0003b010: 6e5f 6f72 6465 7228 7365 6c66 293a 0a20  n_order(self):. 
+0003b020: 2020 2020 2020 2022 2222 0a20 2020 2020         """.     
+0003b030: 2020 2045 6666 6963 6965 6e74 2061 6363     Efficient acc
+0003b040: 6573 7320 746f 2074 6865 2060 6065 6467  ess to the ``edg
+0003b050: 655f 696e 7365 7274 696f 6e5f 6f72 6465  e_insertion_orde
+0003b060: 7260 6020 636f 6c75 6d6e 2069 6e20 7468  r`` column in th
+0003b070: 650a 2020 2020 2020 2020 3a72 6566 3a60  e.        :ref:`
+0003b080: 7365 635f 7461 626c 655f 696e 6465 7865  sec_table_indexe
+0003b090: 7360 2061 7320 6120 6e75 6d70 7920 6172  s` as a numpy ar
+0003b0a0: 7261 7920 2864 7479 7065 3d6e 702e 696e  ray (dtype=np.in
+0003b0b0: 7433 3229 2e0a 2020 2020 2020 2020 4571  t32)..        Eq
+0003b0c0: 7569 7661 6c65 6e74 2074 6f20 6060 7473  uivalent to ``ts
+0003b0d0: 2e74 6162 6c65 732e 696e 6465 7865 732e  .tables.indexes.
+0003b0e0: 6564 6765 5f69 6e73 6572 7469 6f6e 5f6f  edge_insertion_o
+0003b0f0: 7264 6572 6060 2028 6275 7420 6176 6f69  rder`` (but avoi
+0003b100: 6469 6e67 0a20 2020 2020 2020 2074 6865  ding.        the
+0003b110: 2066 756c 6c20 636f 7079 206f 6620 7468   full copy of th
+0003b120: 6520 7461 626c 6520 6461 7461 2074 6861  e table data tha
+0003b130: 7420 6163 6365 7373 696e 6720 6060 7473  t accessing ``ts
+0003b140: 2e74 6162 6c65 7360 600a 2020 2020 2020  .tables``.      
+0003b150: 2020 6375 7272 656e 746c 7920 656e 7461    currently enta
+0003b160: 696c 7329 2e0a 2020 2020 2020 2020 2222  ils)..        ""
+0003b170: 220a 2020 2020 2020 2020 7265 7475 726e  ".        return
+0003b180: 2073 656c 662e 5f69 6e64 6578 6573 5f65   self._indexes_e
+0003b190: 6467 655f 696e 7365 7274 696f 6e5f 6f72  dge_insertion_or
+0003b1a0: 6465 720a 0a20 2020 2040 7072 6f70 6572  der..    @proper
+0003b1b0: 7479 0a20 2020 2064 6566 2069 6e64 6578  ty.    def index
+0003b1c0: 6573 5f65 6467 655f 7265 6d6f 7661 6c5f  es_edge_removal_
+0003b1d0: 6f72 6465 7228 7365 6c66 293a 0a20 2020  order(self):.   
+0003b1e0: 2020 2020 2022 2222 0a20 2020 2020 2020       """.       
+0003b1f0: 2045 6666 6963 6965 6e74 2061 6363 6573   Efficient acces
+0003b200: 7320 746f 2074 6865 2060 6065 6467 655f  s to the ``edge_
+0003b210: 7265 6d6f 7661 6c5f 6f72 6465 7260 6020  removal_order`` 
+0003b220: 636f 6c75 6d6e 2069 6e20 7468 650a 2020  column in the.  
+0003b230: 2020 2020 2020 3a72 6566 3a60 7365 635f        :ref:`sec_
+0003b240: 7461 626c 655f 696e 6465 7865 7360 2061  table_indexes` a
+0003b250: 7320 6120 6e75 6d70 7920 6172 7261 7920  s a numpy array 
+0003b260: 2864 7479 7065 3d6e 702e 696e 7433 3229  (dtype=np.int32)
+0003b270: 2e0a 2020 2020 2020 2020 4571 7569 7661  ..        Equiva
+0003b280: 6c65 6e74 2074 6f20 6060 7473 2e74 6162  lent to ``ts.tab
+0003b290: 6c65 732e 696e 6465 7865 732e 6564 6765  les.indexes.edge
+0003b2a0: 5f72 656d 6f76 616c 5f6f 7264 6572 6060  _removal_order``
+0003b2b0: 2028 6275 7420 6176 6f69 6469 6e67 0a20   (but avoiding. 
+0003b2c0: 2020 2020 2020 2074 6865 2066 756c 6c20         the full 
+0003b2d0: 636f 7079 206f 6620 7468 6520 7461 626c  copy of the tabl
+0003b2e0: 6520 6461 7461 2074 6861 7420 6163 6365  e data that acce
+0003b2f0: 7373 696e 6720 6060 7473 2e74 6162 6c65  ssing ``ts.table
+0003b300: 7360 600a 2020 2020 2020 2020 6375 7272  s``.        curr
+0003b310: 656e 746c 7920 656e 7461 696c 7329 2e0a  ently entails)..
+0003b320: 2020 2020 2020 2020 2222 220a 2020 2020          """.    
+0003b330: 2020 2020 7265 7475 726e 2073 656c 662e      return self.
+0003b340: 5f69 6e64 6578 6573 5f65 6467 655f 7265  _indexes_edge_re
+0003b350: 6d6f 7661 6c5f 6f72 6465 720a 0a20 2020  moval_order..   
+0003b360: 2064 6566 2069 6e64 6976 6964 7561 6c28   def individual(
+0003b370: 7365 6c66 2c20 6964 5f29 3a0a 2020 2020  self, id_):.    
+0003b380: 2020 2020 2222 220a 2020 2020 2020 2020      """.        
+0003b390: 5265 7475 726e 7320 7468 6520 3a72 6566  Returns the :ref
+0003b3a0: 3a60 696e 6469 7669 6475 616c 203c 7365  :`individual <se
+0003b3b0: 635f 696e 6469 7669 6475 616c 5f74 6162  c_individual_tab
+0003b3c0: 6c65 5f64 6566 696e 6974 696f 6e3e 600a  le_definition>`.
+0003b3d0: 2020 2020 2020 2020 696e 2074 6869 7320          in this 
+0003b3e0: 7472 6565 2073 6571 7565 6e63 6520 7769  tree sequence wi
+0003b3f0: 7468 2074 6865 2073 7065 6369 6669 6564  th the specified
+0003b400: 2049 442e 2020 4173 2077 6974 6820 7079   ID.  As with py
+0003b410: 7468 6f6e 206c 6973 7473 2c20 6e65 6761  thon lists, nega
+0003b420: 7469 7665 0a20 2020 2020 2020 2049 4473  tive.        IDs
+0003b430: 2063 616e 2062 6520 7573 6564 2074 6f20   can be used to 
+0003b440: 696e 6465 7820 6261 636b 7761 7264 7320  index backwards 
+0003b450: 6672 6f6d 2074 6865 206c 6173 7420 696e  from the last in
+0003b460: 6469 7669 6475 616c 2e0a 0a20 2020 2020  dividual...     
+0003b470: 2020 203a 7274 7970 653a 203a 636c 6173     :rtype: :clas
+0003b480: 733a 6049 6e64 6976 6964 7561 6c60 0a20  s:`Individual`. 
+0003b490: 2020 2020 2020 2022 2222 0a20 2020 2020         """.     
+0003b4a0: 2020 2069 645f 203d 2073 656c 662e 6368     id_ = self.ch
+0003b4b0: 6563 6b5f 696e 6465 7828 6964 5f2c 2073  eck_index(id_, s
+0003b4c0: 656c 662e 6e75 6d5f 696e 6469 7669 6475  elf.num_individu
+0003b4d0: 616c 7329 0a20 2020 2020 2020 2028 0a20  als).        (. 
+0003b4e0: 2020 2020 2020 2020 2020 2066 6c61 6773             flags
+0003b4f0: 2c0a 2020 2020 2020 2020 2020 2020 6c6f  ,.            lo
+0003b500: 6361 7469 6f6e 2c0a 2020 2020 2020 2020  cation,.        
+0003b510: 2020 2020 7061 7265 6e74 732c 0a20 2020      parents,.   
+0003b520: 2020 2020 2020 2020 206d 6574 6164 6174           metadat
+0003b530: 612c 0a20 2020 2020 2020 2020 2020 206e  a,.            n
+0003b540: 6f64 6573 2c0a 2020 2020 2020 2020 2920  odes,.        ) 
+0003b550: 3d20 7365 6c66 2e5f 6c6c 5f74 7265 655f  = self._ll_tree_
+0003b560: 7365 7175 656e 6365 2e67 6574 5f69 6e64  sequence.get_ind
+0003b570: 6976 6964 7561 6c28 6964 5f29 0a20 2020  ividual(id_).   
+0003b580: 2020 2020 2069 6e64 203d 2049 6e64 6976       ind = Indiv
+0003b590: 6964 7561 6c28 0a20 2020 2020 2020 2020  idual(.         
+0003b5a0: 2020 2069 643d 6964 5f2c 0a20 2020 2020     id=id_,.     
+0003b5b0: 2020 2020 2020 2066 6c61 6773 3d66 6c61         flags=fla
+0003b5c0: 6773 2c0a 2020 2020 2020 2020 2020 2020  gs,.            
+0003b5d0: 6c6f 6361 7469 6f6e 3d6c 6f63 6174 696f  location=locatio
+0003b5e0: 6e2c 0a20 2020 2020 2020 2020 2020 2070  n,.            p
+0003b5f0: 6172 656e 7473 3d70 6172 656e 7473 2c0a  arents=parents,.
+0003b600: 2020 2020 2020 2020 2020 2020 6d65 7461              meta
+0003b610: 6461 7461 3d6d 6574 6164 6174 612c 0a20  data=metadata,. 
+0003b620: 2020 2020 2020 2020 2020 206e 6f64 6573             nodes
+0003b630: 3d6e 6f64 6573 2c0a 2020 2020 2020 2020  =nodes,.        
+0003b640: 2020 2020 6d65 7461 6461 7461 5f64 6563      metadata_dec
+0003b650: 6f64 6572 3d73 656c 662e 7461 626c 655f  oder=self.table_
+0003b660: 6d65 7461 6461 7461 5f73 6368 656d 6173  metadata_schemas
+0003b670: 2e69 6e64 6976 6964 7561 6c2e 6465 636f  .individual.deco
+0003b680: 6465 5f72 6f77 2c0a 2020 2020 2020 2020  de_row,.        
+0003b690: 2020 2020 7472 6565 5f73 6571 7565 6e63      tree_sequenc
+0003b6a0: 653d 7365 6c66 2c0a 2020 2020 2020 2020  e=self,.        
+0003b6b0: 290a 2020 2020 2020 2020 7265 7475 726e  ).        return
+0003b6c0: 2069 6e64 0a0a 2020 2020 6465 6620 6e6f   ind..    def no
+0003b6d0: 6465 2873 656c 662c 2069 645f 293a 0a20  de(self, id_):. 
+0003b6e0: 2020 2020 2020 2022 2222 0a20 2020 2020         """.     
+0003b6f0: 2020 2052 6574 7572 6e73 2074 6865 203a     Returns the :
+0003b700: 7265 663a 606e 6f64 6520 3c73 6563 5f6e  ref:`node <sec_n
+0003b710: 6f64 655f 7461 626c 655f 6465 6669 6e69  ode_table_defini
+0003b720: 7469 6f6e 3e60 2069 6e20 7468 6973 2074  tion>` in this t
+0003b730: 7265 6520 7365 7175 656e 6365 0a20 2020  ree sequence.   
+0003b740: 2020 2020 2077 6974 6820 7468 6520 7370       with the sp
+0003b750: 6563 6966 6965 6420 4944 2e20 4173 2077  ecified ID. As w
+0003b760: 6974 6820 7079 7468 6f6e 206c 6973 7473  ith python lists
+0003b770: 2c20 6e65 6761 7469 7665 2049 4473 2063  , negative IDs c
+0003b780: 616e 2062 6520 7573 6564 2074 6f0a 2020  an be used to.  
+0003b790: 2020 2020 2020 696e 6465 7820 6261 636b        index back
+0003b7a0: 7761 7264 7320 6672 6f6d 2074 6865 206c  wards from the l
+0003b7b0: 6173 7420 6e6f 6465 2e0a 0a20 2020 2020  ast node...     
+0003b7c0: 2020 203a 7274 7970 653a 203a 636c 6173     :rtype: :clas
+0003b7d0: 733a 604e 6f64 6560 0a20 2020 2020 2020  s:`Node`.       
+0003b7e0: 2022 2222 0a20 2020 2020 2020 2069 645f   """.        id_
+0003b7f0: 203d 2073 656c 662e 6368 6563 6b5f 696e   = self.check_in
+0003b800: 6465 7828 6964 5f2c 2073 656c 662e 6e75  dex(id_, self.nu
+0003b810: 6d5f 6e6f 6465 7329 0a20 2020 2020 2020  m_nodes).       
+0003b820: 2028 0a20 2020 2020 2020 2020 2020 2066   (.            f
+0003b830: 6c61 6773 2c0a 2020 2020 2020 2020 2020  lags,.          
+0003b840: 2020 7469 6d65 2c0a 2020 2020 2020 2020    time,.        
+0003b850: 2020 2020 706f 7075 6c61 7469 6f6e 2c0a      population,.
+0003b860: 2020 2020 2020 2020 2020 2020 696e 6469              indi
+0003b870: 7669 6475 616c 2c0a 2020 2020 2020 2020  vidual,.        
+0003b880: 2020 2020 6d65 7461 6461 7461 2c0a 2020      metadata,.  
+0003b890: 2020 2020 2020 2920 3d20 7365 6c66 2e5f        ) = self._
+0003b8a0: 6c6c 5f74 7265 655f 7365 7175 656e 6365  ll_tree_sequence
+0003b8b0: 2e67 6574 5f6e 6f64 6528 6964 5f29 0a20  .get_node(id_). 
+0003b8c0: 2020 2020 2020 2072 6574 7572 6e20 4e6f         return No
+0003b8d0: 6465 280a 2020 2020 2020 2020 2020 2020  de(.            
+0003b8e0: 6964 3d69 645f 2c0a 2020 2020 2020 2020  id=id_,.        
+0003b8f0: 2020 2020 666c 6167 733d 666c 6167 732c      flags=flags,
+0003b900: 0a20 2020 2020 2020 2020 2020 2074 696d  .            tim
+0003b910: 653d 7469 6d65 2c0a 2020 2020 2020 2020  e=time,.        
+0003b920: 2020 2020 706f 7075 6c61 7469 6f6e 3d70      population=p
+0003b930: 6f70 756c 6174 696f 6e2c 0a20 2020 2020  opulation,.     
+0003b940: 2020 2020 2020 2069 6e64 6976 6964 7561         individua
+0003b950: 6c3d 696e 6469 7669 6475 616c 2c0a 2020  l=individual,.  
+0003b960: 2020 2020 2020 2020 2020 6d65 7461 6461            metada
+0003b970: 7461 3d6d 6574 6164 6174 612c 0a20 2020  ta=metadata,.   
+0003b980: 2020 2020 2020 2020 206d 6574 6164 6174           metadat
+0003b990: 615f 6465 636f 6465 723d 7365 6c66 2e74  a_decoder=self.t
+0003b9a0: 6162 6c65 5f6d 6574 6164 6174 615f 7363  able_metadata_sc
+0003b9b0: 6865 6d61 732e 6e6f 6465 2e64 6563 6f64  hemas.node.decod
+0003b9c0: 655f 726f 772c 0a20 2020 2020 2020 2029  e_row,.        )
+0003b9d0: 0a0a 2020 2020 4073 7461 7469 636d 6574  ..    @staticmet
+0003b9e0: 686f 640a 2020 2020 6465 6620 6368 6563  hod.    def chec
+0003b9f0: 6b5f 696e 6465 7828 696e 6465 782c 206c  k_index(index, l
+0003ba00: 656e 6774 6829 3a0a 2020 2020 2020 2020  ength):.        
+0003ba10: 6966 206e 6f74 2069 7369 6e73 7461 6e63  if not isinstanc
+0003ba20: 6528 696e 6465 782c 206e 756d 6265 7273  e(index, numbers
+0003ba30: 2e49 6e74 6567 7261 6c29 3a0a 2020 2020  .Integral):.    
+0003ba40: 2020 2020 2020 2020 7261 6973 6520 5479          raise Ty
+0003ba50: 7065 4572 726f 7228 0a20 2020 2020 2020  peError(.       
+0003ba60: 2020 2020 2020 2020 2066 2249 6e64 6578           f"Index
+0003ba70: 206d 7573 7420 6265 206f 6620 696e 7465   must be of inte
+0003ba80: 6765 7220 7479 7065 2c20 6e6f 7420 277b  ger type, not '{
+0003ba90: 7479 7065 2869 6e64 6578 292e 5f5f 6e61  type(index).__na
+0003baa0: 6d65 5f5f 7d27 220a 2020 2020 2020 2020  me__}'".        
+0003bab0: 2020 2020 290a 2020 2020 2020 2020 6966      ).        if
+0003bac0: 2069 6e64 6578 203c 2030 3a0a 2020 2020   index < 0:.    
+0003bad0: 2020 2020 2020 2020 696e 6465 7820 2b3d          index +=
+0003bae0: 206c 656e 6774 680a 2020 2020 2020 2020   length.        
+0003baf0: 6966 2069 6e64 6578 203c 2030 206f 7220  if index < 0 or 
+0003bb00: 696e 6465 7820 3e3d 206c 656e 6774 683a  index >= length:
+0003bb10: 0a20 2020 2020 2020 2020 2020 2072 6169  .            rai
+0003bb20: 7365 2049 6e64 6578 4572 726f 7228 2249  se IndexError("I
+0003bb30: 6e64 6578 206f 7574 206f 6620 626f 756e  ndex out of boun
+0003bb40: 6473 2229 0a20 2020 2020 2020 2072 6574  ds").        ret
+0003bb50: 7572 6e20 696e 6465 780a 0a20 2020 2064  urn index..    d
+0003bb60: 6566 2065 6467 6528 7365 6c66 2c20 6964  ef edge(self, id
+0003bb70: 5f29 3a0a 2020 2020 2020 2020 2222 220a  _):.        """.
+0003bb80: 2020 2020 2020 2020 5265 7475 726e 7320          Returns 
+0003bb90: 7468 6520 3a72 6566 3a60 6564 6765 203c  the :ref:`edge <
+0003bba0: 7365 635f 6564 6765 5f74 6162 6c65 5f64  sec_edge_table_d
+0003bbb0: 6566 696e 6974 696f 6e3e 6020 696e 2074  efinition>` in t
+0003bbc0: 6869 7320 7472 6565 2073 6571 7565 6e63  his tree sequenc
+0003bbd0: 650a 2020 2020 2020 2020 7769 7468 2074  e.        with t
+0003bbe0: 6865 2073 7065 6369 6669 6564 2049 442e  he specified ID.
+0003bbf0: 2041 7320 7769 7468 2070 7974 686f 6e20   As with python 
+0003bc00: 6c69 7374 732c 206e 6567 6174 6976 6520  lists, negative 
+0003bc10: 4944 7320 6361 6e20 6265 2075 7365 6420  IDs can be used 
+0003bc20: 746f 0a20 2020 2020 2020 2069 6e64 6578  to.        index
+0003bc30: 2062 6163 6b77 6172 6473 2066 726f 6d20   backwards from 
+0003bc40: 7468 6520 6c61 7374 2065 6467 652e 0a0a  the last edge...
+0003bc50: 2020 2020 2020 2020 3a72 7479 7065 3a20          :rtype: 
+0003bc60: 3a63 6c61 7373 3a60 4564 6765 600a 2020  :class:`Edge`.  
+0003bc70: 2020 2020 2020 2222 220a 2020 2020 2020        """.      
+0003bc80: 2020 6964 5f20 3d20 7365 6c66 2e63 6865    id_ = self.che
+0003bc90: 636b 5f69 6e64 6578 2869 645f 2c20 7365  ck_index(id_, se
+0003bca0: 6c66 2e6e 756d 5f65 6467 6573 290a 2020  lf.num_edges).  
+0003bcb0: 2020 2020 2020 6c65 6674 2c20 7269 6768        left, righ
+0003bcc0: 742c 2070 6172 656e 742c 2063 6869 6c64  t, parent, child
+0003bcd0: 2c20 6d65 7461 6461 7461 203d 2073 656c  , metadata = sel
+0003bce0: 662e 5f6c 6c5f 7472 6565 5f73 6571 7565  f._ll_tree_seque
+0003bcf0: 6e63 652e 6765 745f 6564 6765 2869 645f  nce.get_edge(id_
+0003bd00: 290a 2020 2020 2020 2020 7265 7475 726e  ).        return
+0003bd10: 2045 6467 6528 0a20 2020 2020 2020 2020   Edge(.         
+0003bd20: 2020 2069 643d 6964 5f2c 0a20 2020 2020     id=id_,.     
+0003bd30: 2020 2020 2020 206c 6566 743d 6c65 6674         left=left
+0003bd40: 2c0a 2020 2020 2020 2020 2020 2020 7269  ,.            ri
+0003bd50: 6768 743d 7269 6768 742c 0a20 2020 2020  ght=right,.     
+0003bd60: 2020 2020 2020 2070 6172 656e 743d 7061         parent=pa
+0003bd70: 7265 6e74 2c0a 2020 2020 2020 2020 2020  rent,.          
+0003bd80: 2020 6368 696c 643d 6368 696c 642c 0a20    child=child,. 
+0003bd90: 2020 2020 2020 2020 2020 206d 6574 6164             metad
+0003bda0: 6174 613d 6d65 7461 6461 7461 2c0a 2020  ata=metadata,.  
+0003bdb0: 2020 2020 2020 2020 2020 6d65 7461 6461            metada
+0003bdc0: 7461 5f64 6563 6f64 6572 3d73 656c 662e  ta_decoder=self.
+0003bdd0: 7461 626c 655f 6d65 7461 6461 7461 5f73  table_metadata_s
+0003bde0: 6368 656d 6173 2e65 6467 652e 6465 636f  chemas.edge.deco
+0003bdf0: 6465 5f72 6f77 2c0a 2020 2020 2020 2020  de_row,.        
+0003be00: 290a 0a20 2020 2064 6566 206d 6967 7261  )..    def migra
+0003be10: 7469 6f6e 2873 656c 662c 2069 645f 293a  tion(self, id_):
+0003be20: 0a20 2020 2020 2020 2022 2222 0a20 2020  .        """.   
+0003be30: 2020 2020 2052 6574 7572 6e73 2074 6865       Returns the
+0003be40: 203a 7265 663a 606d 6967 7261 7469 6f6e   :ref:`migration
+0003be50: 203c 7365 635f 6d69 6772 6174 696f 6e5f   <sec_migration_
+0003be60: 7461 626c 655f 6465 6669 6e69 7469 6f6e  table_definition
+0003be70: 3e60 2069 6e20 7468 6973 2074 7265 650a  >` in this tree.
+0003be80: 2020 2020 2020 2020 7365 7175 656e 6365          sequence
+0003be90: 2077 6974 6820 7468 6520 7370 6563 6966   with the specif
+0003bea0: 6965 6420 4944 2e20 4173 2077 6974 6820  ied ID. As with 
+0003beb0: 7079 7468 6f6e 206c 6973 7473 2c20 6e65  python lists, ne
+0003bec0: 6761 7469 7665 2049 4473 2063 616e 2062  gative IDs can b
+0003bed0: 650a 2020 2020 2020 2020 7573 6564 2074  e.        used t
+0003bee0: 6f20 696e 6465 7820 6261 636b 7761 7264  o index backward
+0003bef0: 7320 6672 6f6d 2074 6865 206c 6173 7420  s from the last 
+0003bf00: 6d69 6772 6174 696f 6e2e 0a0a 2020 2020  migration...    
+0003bf10: 2020 2020 3a72 7479 7065 3a20 3a63 6c61      :rtype: :cla
+0003bf20: 7373 3a60 2e4d 6967 7261 7469 6f6e 600a  ss:`.Migration`.
+0003bf30: 2020 2020 2020 2020 2222 220a 2020 2020          """.    
+0003bf40: 2020 2020 6964 5f20 3d20 7365 6c66 2e63      id_ = self.c
+0003bf50: 6865 636b 5f69 6e64 6578 2869 645f 2c20  heck_index(id_, 
+0003bf60: 7365 6c66 2e6e 756d 5f6d 6967 7261 7469  self.num_migrati
+0003bf70: 6f6e 7329 0a20 2020 2020 2020 2028 0a20  ons).        (. 
+0003bf80: 2020 2020 2020 2020 2020 206c 6566 742c             left,
+0003bf90: 0a20 2020 2020 2020 2020 2020 2072 6967  .            rig
+0003bfa0: 6874 2c0a 2020 2020 2020 2020 2020 2020  ht,.            
+0003bfb0: 6e6f 6465 2c0a 2020 2020 2020 2020 2020  node,.          
+0003bfc0: 2020 736f 7572 6365 2c0a 2020 2020 2020    source,.      
+0003bfd0: 2020 2020 2020 6465 7374 2c0a 2020 2020        dest,.    
+0003bfe0: 2020 2020 2020 2020 7469 6d65 2c0a 2020          time,.  
+0003bff0: 2020 2020 2020 2020 2020 6d65 7461 6461            metada
+0003c000: 7461 2c0a 2020 2020 2020 2020 2920 3d20  ta,.        ) = 
+0003c010: 7365 6c66 2e5f 6c6c 5f74 7265 655f 7365  self._ll_tree_se
+0003c020: 7175 656e 6365 2e67 6574 5f6d 6967 7261  quence.get_migra
+0003c030: 7469 6f6e 2869 645f 290a 2020 2020 2020  tion(id_).      
+0003c040: 2020 7265 7475 726e 204d 6967 7261 7469    return Migrati
+0003c050: 6f6e 280a 2020 2020 2020 2020 2020 2020  on(.            
+0003c060: 6964 3d69 645f 2c0a 2020 2020 2020 2020  id=id_,.        
+0003c070: 2020 2020 6c65 6674 3d6c 6566 742c 0a20      left=left,. 
+0003c080: 2020 2020 2020 2020 2020 2072 6967 6874             right
+0003c090: 3d72 6967 6874 2c0a 2020 2020 2020 2020  =right,.        
+0003c0a0: 2020 2020 6e6f 6465 3d6e 6f64 652c 0a20      node=node,. 
+0003c0b0: 2020 2020 2020 2020 2020 2073 6f75 7263             sourc
+0003c0c0: 653d 736f 7572 6365 2c0a 2020 2020 2020  e=source,.      
+0003c0d0: 2020 2020 2020 6465 7374 3d64 6573 742c        dest=dest,
+0003c0e0: 0a20 2020 2020 2020 2020 2020 2074 696d  .            tim
+0003c0f0: 653d 7469 6d65 2c0a 2020 2020 2020 2020  e=time,.        
+0003c100: 2020 2020 6d65 7461 6461 7461 3d6d 6574      metadata=met
+0003c110: 6164 6174 612c 0a20 2020 2020 2020 2020  adata,.         
+0003c120: 2020 206d 6574 6164 6174 615f 6465 636f     metadata_deco
+0003c130: 6465 723d 7365 6c66 2e74 6162 6c65 5f6d  der=self.table_m
+0003c140: 6574 6164 6174 615f 7363 6865 6d61 732e  etadata_schemas.
+0003c150: 6d69 6772 6174 696f 6e2e 6465 636f 6465  migration.decode
+0003c160: 5f72 6f77 2c0a 2020 2020 2020 2020 290a  _row,.        ).
+0003c170: 0a20 2020 2064 6566 206d 7574 6174 696f  .    def mutatio
+0003c180: 6e28 7365 6c66 2c20 6964 5f29 3a0a 2020  n(self, id_):.  
+0003c190: 2020 2020 2020 2222 220a 2020 2020 2020        """.      
+0003c1a0: 2020 5265 7475 726e 7320 7468 6520 3a72    Returns the :r
+0003c1b0: 6566 3a60 6d75 7461 7469 6f6e 203c 7365  ef:`mutation <se
+0003c1c0: 635f 6d75 7461 7469 6f6e 5f74 6162 6c65  c_mutation_table
+0003c1d0: 5f64 6566 696e 6974 696f 6e3e 6020 696e  _definition>` in
+0003c1e0: 2074 6869 7320 7472 6565 2073 6571 7565   this tree seque
+0003c1f0: 6e63 650a 2020 2020 2020 2020 7769 7468  nce.        with
+0003c200: 2074 6865 2073 7065 6369 6669 6564 2049   the specified I
+0003c210: 442e 2041 7320 7769 7468 2070 7974 686f  D. As with pytho
+0003c220: 6e20 6c69 7374 732c 206e 6567 6174 6976  n lists, negativ
+0003c230: 6520 4944 7320 6361 6e20 6265 2075 7365  e IDs can be use
+0003c240: 6420 746f 0a20 2020 2020 2020 2069 6e64  d to.        ind
+0003c250: 6578 2062 6163 6b77 6172 6473 2066 726f  ex backwards fro
+0003c260: 6d20 7468 6520 6c61 7374 206d 7574 6174  m the last mutat
+0003c270: 696f 6e2e 0a0a 2020 2020 2020 2020 3a72  ion...        :r
+0003c280: 7479 7065 3a20 3a63 6c61 7373 3a60 4d75  type: :class:`Mu
+0003c290: 7461 7469 6f6e 600a 2020 2020 2020 2020  tation`.        
+0003c2a0: 2222 220a 2020 2020 2020 2020 6964 5f20  """.        id_ 
+0003c2b0: 3d20 7365 6c66 2e63 6865 636b 5f69 6e64  = self.check_ind
+0003c2c0: 6578 2869 645f 2c20 7365 6c66 2e6e 756d  ex(id_, self.num
+0003c2d0: 5f6d 7574 6174 696f 6e73 290a 2020 2020  _mutations).    
+0003c2e0: 2020 2020 280a 2020 2020 2020 2020 2020      (.          
+0003c2f0: 2020 7369 7465 2c0a 2020 2020 2020 2020    site,.        
+0003c300: 2020 2020 6e6f 6465 2c0a 2020 2020 2020      node,.      
+0003c310: 2020 2020 2020 6465 7269 7665 645f 7374        derived_st
+0003c320: 6174 652c 0a20 2020 2020 2020 2020 2020  ate,.           
+0003c330: 2070 6172 656e 742c 0a20 2020 2020 2020   parent,.       
+0003c340: 2020 2020 206d 6574 6164 6174 612c 0a20       metadata,. 
+0003c350: 2020 2020 2020 2020 2020 2074 696d 652c             time,
+0003c360: 0a20 2020 2020 2020 2020 2020 2065 6467  .            edg
+0003c370: 652c 0a20 2020 2020 2020 2029 203d 2073  e,.        ) = s
+0003c380: 656c 662e 5f6c 6c5f 7472 6565 5f73 6571  elf._ll_tree_seq
+0003c390: 7565 6e63 652e 6765 745f 6d75 7461 7469  uence.get_mutati
+0003c3a0: 6f6e 2869 645f 290a 2020 2020 2020 2020  on(id_).        
+0003c3b0: 7265 7475 726e 204d 7574 6174 696f 6e28  return Mutation(
+0003c3c0: 0a20 2020 2020 2020 2020 2020 2069 643d  .            id=
+0003c3d0: 6964 5f2c 0a20 2020 2020 2020 2020 2020  id_,.           
+0003c3e0: 2073 6974 653d 7369 7465 2c0a 2020 2020   site=site,.    
+0003c3f0: 2020 2020 2020 2020 6e6f 6465 3d6e 6f64          node=nod
+0003c400: 652c 0a20 2020 2020 2020 2020 2020 2064  e,.            d
+0003c410: 6572 6976 6564 5f73 7461 7465 3d64 6572  erived_state=der
+0003c420: 6976 6564 5f73 7461 7465 2c0a 2020 2020  ived_state,.    
+0003c430: 2020 2020 2020 2020 7061 7265 6e74 3d70          parent=p
+0003c440: 6172 656e 742c 0a20 2020 2020 2020 2020  arent,.         
+0003c450: 2020 206d 6574 6164 6174 613d 6d65 7461     metadata=meta
+0003c460: 6461 7461 2c0a 2020 2020 2020 2020 2020  data,.          
+0003c470: 2020 7469 6d65 3d74 696d 652c 0a20 2020    time=time,.   
+0003c480: 2020 2020 2020 2020 2065 6467 653d 6564           edge=ed
+0003c490: 6765 2c0a 2020 2020 2020 2020 2020 2020  ge,.            
+0003c4a0: 6d65 7461 6461 7461 5f64 6563 6f64 6572  metadata_decoder
+0003c4b0: 3d73 656c 662e 7461 626c 655f 6d65 7461  =self.table_meta
+0003c4c0: 6461 7461 5f73 6368 656d 6173 2e6d 7574  data_schemas.mut
+0003c4d0: 6174 696f 6e2e 6465 636f 6465 5f72 6f77  ation.decode_row
+0003c4e0: 2c0a 2020 2020 2020 2020 290a 0a20 2020  ,.        )..   
+0003c4f0: 2064 6566 2073 6974 6528 7365 6c66 2c20   def site(self, 
+0003c500: 6964 5f3d 4e6f 6e65 2c20 2a2c 2070 6f73  id_=None, *, pos
+0003c510: 6974 696f 6e3d 4e6f 6e65 293a 0a20 2020  ition=None):.   
+0003c520: 2020 2020 2022 2222 0a20 2020 2020 2020       """.       
+0003c530: 2052 6574 7572 6e73 2074 6865 203a 7265   Returns the :re
+0003c540: 663a 6073 6974 6520 3c73 6563 5f73 6974  f:`site <sec_sit
+0003c550: 655f 7461 626c 655f 6465 6669 6e69 7469  e_table_definiti
+0003c560: 6f6e 3e60 2069 6e20 7468 6973 2074 7265  on>` in this tre
+0003c570: 6520 7365 7175 656e 6365 0a20 2020 2020  e sequence.     
+0003c580: 2020 2077 6974 6820 6569 7468 6572 2074     with either t
+0003c590: 6865 2073 7065 6369 6669 6564 2049 4420  he specified ID 
+0003c5a0: 6f72 2070 6f73 6974 696f 6e2e 2041 7320  or position. As 
+0003c5b0: 7769 7468 2070 7974 686f 6e20 6c69 7374  with python list
+0003c5c0: 732c 206e 6567 6174 6976 6520 4944 730a  s, negative IDs.
+0003c5d0: 2020 2020 2020 2020 6361 6e20 6265 2075          can be u
+0003c5e0: 7365 6420 746f 2069 6e64 6578 2062 6163  sed to index bac
+0003c5f0: 6b77 6172 6473 2066 726f 6d20 7468 6520  kwards from the 
+0003c600: 6c61 7374 2073 6974 652e 0a0a 2020 2020  last site...    
+0003c610: 2020 2020 5768 656e 2070 6f73 6974 696f      When positio
+0003c620: 6e20 6973 2073 7065 6369 6669 6564 2069  n is specified i
+0003c630: 6e73 7465 6164 206f 6620 7369 7465 2049  nstead of site I
+0003c640: 442c 2061 2062 696e 6172 7920 7365 6172  D, a binary sear
+0003c650: 6368 2069 7320 646f 6e65 0a20 2020 2020  ch is done.     
+0003c660: 2020 206f 6e20 7468 6520 6c69 7374 206f     on the list o
+0003c670: 6620 706f 7369 7469 6f6e 7320 6f66 2074  f positions of t
+0003c680: 6865 2073 6974 6573 2074 6f20 7472 7920  he sites to try 
+0003c690: 746f 2066 696e 6420 6120 7369 7465 0a20  to find a site. 
+0003c6a0: 2020 2020 2020 2077 6974 6820 7468 6520         with the 
+0003c6b0: 7573 6572 2d73 7065 6369 6669 6564 2070  user-specified p
+0003c6c0: 6f73 6974 696f 6e2e 0a0a 2020 2020 2020  osition...      
+0003c6d0: 2020 3a72 7479 7065 3a20 3a63 6c61 7373    :rtype: :class
+0003c6e0: 3a60 5369 7465 600a 2020 2020 2020 2020  :`Site`.        
+0003c6f0: 2222 220a 2020 2020 2020 2020 6966 2069  """.        if i
+0003c700: 645f 2069 7320 4e6f 6e65 2061 6e64 2070  d_ is None and p
+0003c710: 6f73 6974 696f 6e20 6973 204e 6f6e 653a  osition is None:
+0003c720: 0a20 2020 2020 2020 2020 2020 2072 6169  .            rai
+0003c730: 7365 2054 7970 6545 7272 6f72 2822 5369  se TypeError("Si
+0003c740: 7465 2069 6420 6f72 2070 6f73 6974 696f  te id or positio
+0003c750: 6e20 6d75 7374 2062 6520 7072 6f76 6964  n must be provid
+0003c760: 6564 2e22 290a 2020 2020 2020 2020 656c  ed.").        el
+0003c770: 6966 2069 645f 2069 7320 6e6f 7420 4e6f  if id_ is not No
+0003c780: 6e65 2061 6e64 2070 6f73 6974 696f 6e20  ne and position 
+0003c790: 6973 206e 6f74 204e 6f6e 653a 0a20 2020  is not None:.   
+0003c7a0: 2020 2020 2020 2020 2072 6169 7365 2054           raise T
+0003c7b0: 7970 6545 7272 6f72 2822 4f6e 6c79 206f  ypeError("Only o
+0003c7c0: 6e65 206f 6620 7369 7465 2069 6420 6f72  ne of site id or
+0003c7d0: 2070 6f73 6974 696f 6e20 6e65 6564 7320   position needs 
+0003c7e0: 746f 2062 6520 7072 6f76 6964 6564 2e22  to be provided."
+0003c7f0: 290a 2020 2020 2020 2020 656c 6966 2069  ).        elif i
+0003c800: 645f 2069 7320 4e6f 6e65 3a0a 2020 2020  d_ is None:.    
+0003c810: 2020 2020 2020 2020 706f 7369 7469 6f6e          position
+0003c820: 203d 206e 702e 6172 7261 7928 706f 7369   = np.array(posi
+0003c830: 7469 6f6e 290a 2020 2020 2020 2020 2020  tion).          
+0003c840: 2020 6966 206c 656e 2870 6f73 6974 696f    if len(positio
+0003c850: 6e2e 7368 6170 6529 203e 2030 3a0a 2020  n.shape) > 0:.  
+0003c860: 2020 2020 2020 2020 2020 2020 2020 7261                ra
+0003c870: 6973 6520 5661 6c75 6545 7272 6f72 2822  ise ValueError("
+0003c880: 506f 7369 7469 6f6e 206d 7573 7420 6265  Position must be
+0003c890: 2070 726f 7669 6465 6420 6173 2061 2073   provided as a s
+0003c8a0: 6361 6c61 7220 7661 6c75 652e 2229 0a20  calar value."). 
+0003c8b0: 2020 2020 2020 2020 2020 2069 6620 706f             if po
+0003c8c0: 7369 7469 6f6e 203c 2030 206f 7220 706f  sition < 0 or po
+0003c8d0: 7369 7469 6f6e 203e 3d20 7365 6c66 2e73  sition >= self.s
+0003c8e0: 6571 7565 6e63 655f 6c65 6e67 7468 3a0a  equence_length:.
+0003c8f0: 2020 2020 2020 2020 2020 2020 2020 2020                  
+0003c900: 7261 6973 6520 5661 6c75 6545 7272 6f72  raise ValueError
+0003c910: 280a 2020 2020 2020 2020 2020 2020 2020  (.              
+0003c920: 2020 2020 2020 2250 6f73 6974 696f 6e20        "Position 
+0003c930: 6973 2062 6579 6f6e 6420 7468 6520 636f  is beyond the co
+0003c940: 6f72 6469 6e61 7465 7320 6465 6669 6e65  ordinates define
+0003c950: 6420 6279 2073 6571 7565 6e63 6520 6c65  d by sequence le
+0003c960: 6e67 7468 2e22 0a20 2020 2020 2020 2020  ngth.".         
+0003c970: 2020 2020 2020 2029 0a20 2020 2020 2020         ).       
+0003c980: 2020 2020 2073 6974 655f 706f 7320 3d20       site_pos = 
+0003c990: 7365 6c66 2e73 6974 6573 5f70 6f73 6974  self.sites_posit
+0003c9a0: 696f 6e0a 2020 2020 2020 2020 2020 2020  ion.            
+0003c9b0: 6964 5f20 3d20 7369 7465 5f70 6f73 2e73  id_ = site_pos.s
+0003c9c0: 6561 7263 6873 6f72 7465 6428 706f 7369  earchsorted(posi
+0003c9d0: 7469 6f6e 290a 2020 2020 2020 2020 2020  tion).          
+0003c9e0: 2020 6966 2069 645f 203e 3d20 6c65 6e28    if id_ >= len(
+0003c9f0: 7369 7465 5f70 6f73 2920 6f72 2073 6974  site_pos) or sit
+0003ca00: 655f 706f 735b 6964 5f5d 2021 3d20 706f  e_pos[id_] != po
+0003ca10: 7369 7469 6f6e 3a0a 2020 2020 2020 2020  sition:.        
+0003ca20: 2020 2020 2020 2020 7261 6973 6520 5661          raise Va
+0003ca30: 6c75 6545 7272 6f72 2866 2254 6865 7265  lueError(f"There
+0003ca40: 2069 7320 6e6f 2073 6974 6520 6174 2070   is no site at p
+0003ca50: 6f73 6974 696f 6e20 7b70 6f73 6974 696f  osition {positio
+0003ca60: 6e7d 2e22 290a 2020 2020 2020 2020 656c  n}.").        el
+0003ca70: 7365 3a0a 2020 2020 2020 2020 2020 2020  se:.            
+0003ca80: 6964 5f20 3d20 7365 6c66 2e63 6865 636b  id_ = self.check
+0003ca90: 5f69 6e64 6578 2869 645f 2c20 7365 6c66  _index(id_, self
+0003caa0: 2e6e 756d 5f73 6974 6573 290a 2020 2020  .num_sites).    
+0003cab0: 2020 2020 6c6c 5f73 6974 6520 3d20 7365      ll_site = se
+0003cac0: 6c66 2e5f 6c6c 5f74 7265 655f 7365 7175  lf._ll_tree_sequ
+0003cad0: 656e 6365 2e67 6574 5f73 6974 6528 6964  ence.get_site(id
+0003cae0: 5f29 0a20 2020 2020 2020 2070 6f73 2c20  _).        pos, 
+0003caf0: 616e 6365 7374 7261 6c5f 7374 6174 652c  ancestral_state,
+0003cb00: 206c 6c5f 6d75 7461 7469 6f6e 732c 205f   ll_mutations, _
+0003cb10: 2c20 6d65 7461 6461 7461 203d 206c 6c5f  , metadata = ll_
+0003cb20: 7369 7465 0a20 2020 2020 2020 206d 7574  site.        mut
+0003cb30: 6174 696f 6e73 203d 205b 7365 6c66 2e6d  ations = [self.m
+0003cb40: 7574 6174 696f 6e28 6d75 745f 6964 2920  utation(mut_id) 
+0003cb50: 666f 7220 6d75 745f 6964 2069 6e20 6c6c  for mut_id in ll
+0003cb60: 5f6d 7574 6174 696f 6e73 5d0a 2020 2020  _mutations].    
+0003cb70: 2020 2020 7265 7475 726e 2053 6974 6528      return Site(
+0003cb80: 0a20 2020 2020 2020 2020 2020 2069 643d  .            id=
+0003cb90: 6964 5f2c 0a20 2020 2020 2020 2020 2020  id_,.           
+0003cba0: 2070 6f73 6974 696f 6e3d 706f 732c 0a20   position=pos,. 
+0003cbb0: 2020 2020 2020 2020 2020 2061 6e63 6573             ances
+0003cbc0: 7472 616c 5f73 7461 7465 3d61 6e63 6573  tral_state=ances
+0003cbd0: 7472 616c 5f73 7461 7465 2c0a 2020 2020  tral_state,.    
+0003cbe0: 2020 2020 2020 2020 6d75 7461 7469 6f6e          mutation
+0003cbf0: 733d 6d75 7461 7469 6f6e 732c 0a20 2020  s=mutations,.   
+0003cc00: 2020 2020 2020 2020 206d 6574 6164 6174           metadat
+0003cc10: 613d 6d65 7461 6461 7461 2c0a 2020 2020  a=metadata,.    
+0003cc20: 2020 2020 2020 2020 6d65 7461 6461 7461          metadata
+0003cc30: 5f64 6563 6f64 6572 3d73 656c 662e 7461  _decoder=self.ta
+0003cc40: 626c 655f 6d65 7461 6461 7461 5f73 6368  ble_metadata_sch
+0003cc50: 656d 6173 2e73 6974 652e 6465 636f 6465  emas.site.decode
+0003cc60: 5f72 6f77 2c0a 2020 2020 2020 2020 290a  _row,.        ).
+0003cc70: 0a20 2020 2064 6566 2070 6f70 756c 6174  .    def populat
+0003cc80: 696f 6e28 7365 6c66 2c20 6964 5f29 3a0a  ion(self, id_):.
+0003cc90: 2020 2020 2020 2020 2222 220a 2020 2020          """.    
+0003cca0: 2020 2020 5265 7475 726e 7320 7468 6520      Returns the 
+0003ccb0: 3a72 6566 3a60 706f 7075 6c61 7469 6f6e  :ref:`population
+0003ccc0: 203c 7365 635f 706f 7075 6c61 7469 6f6e   <sec_population
+0003ccd0: 5f74 6162 6c65 5f64 6566 696e 6974 696f  _table_definitio
+0003cce0: 6e3e 600a 2020 2020 2020 2020 696e 2074  n>`.        in t
+0003ccf0: 6869 7320 7472 6565 2073 6571 7565 6e63  his tree sequenc
+0003cd00: 6520 7769 7468 2074 6865 2073 7065 6369  e with the speci
+0003cd10: 6669 6564 2049 442e 2020 4173 2077 6974  fied ID.  As wit
+0003cd20: 6820 7079 7468 6f6e 206c 6973 7473 2c20  h python lists, 
+0003cd30: 6e65 6761 7469 7665 0a20 2020 2020 2020  negative.       
+0003cd40: 2049 4473 2063 616e 2062 6520 7573 6564   IDs can be used
+0003cd50: 2074 6f20 696e 6465 7820 6261 636b 7761   to index backwa
+0003cd60: 7264 7320 6672 6f6d 2074 6865 206c 6173  rds from the las
+0003cd70: 7420 706f 7075 6c61 7469 6f6e 2e0a 0a20  t population... 
+0003cd80: 2020 2020 2020 203a 7274 7970 653a 203a         :rtype: :
+0003cd90: 636c 6173 733a 6050 6f70 756c 6174 696f  class:`Populatio
+0003cda0: 6e60 0a20 2020 2020 2020 2022 2222 0a20  n`.        """. 
+0003cdb0: 2020 2020 2020 2069 645f 203d 2073 656c         id_ = sel
+0003cdc0: 662e 6368 6563 6b5f 696e 6465 7828 6964  f.check_index(id
+0003cdd0: 5f2c 2073 656c 662e 6e75 6d5f 706f 7075  _, self.num_popu
+0003cde0: 6c61 7469 6f6e 7329 0a20 2020 2020 2020  lations).       
+0003cdf0: 2028 6d65 7461 6461 7461 2c29 203d 2073   (metadata,) = s
+0003ce00: 656c 662e 5f6c 6c5f 7472 6565 5f73 6571  elf._ll_tree_seq
+0003ce10: 7565 6e63 652e 6765 745f 706f 7075 6c61  uence.get_popula
+0003ce20: 7469 6f6e 2869 645f 290a 2020 2020 2020  tion(id_).      
+0003ce30: 2020 7265 7475 726e 2050 6f70 756c 6174    return Populat
+0003ce40: 696f 6e28 0a20 2020 2020 2020 2020 2020  ion(.           
+0003ce50: 2069 643d 6964 5f2c 0a20 2020 2020 2020   id=id_,.       
+0003ce60: 2020 2020 206d 6574 6164 6174 613d 6d65       metadata=me
+0003ce70: 7461 6461 7461 2c0a 2020 2020 2020 2020  tadata,.        
+0003ce80: 2020 2020 6d65 7461 6461 7461 5f64 6563      metadata_dec
+0003ce90: 6f64 6572 3d73 656c 662e 7461 626c 655f  oder=self.table_
+0003cea0: 6d65 7461 6461 7461 5f73 6368 656d 6173  metadata_schemas
+0003ceb0: 2e70 6f70 756c 6174 696f 6e2e 6465 636f  .population.deco
+0003cec0: 6465 5f72 6f77 2c0a 2020 2020 2020 2020  de_row,.        
+0003ced0: 290a 0a20 2020 2064 6566 2070 726f 7665  )..    def prove
+0003cee0: 6e61 6e63 6528 7365 6c66 2c20 6964 5f29  nance(self, id_)
+0003cef0: 3a0a 2020 2020 2020 2020 2222 220a 2020  :.        """.  
+0003cf00: 2020 2020 2020 5265 7475 726e 7320 7468        Returns th
+0003cf10: 6520 3a72 6566 3a60 7072 6f76 656e 616e  e :ref:`provenan
+0003cf20: 6365 203c 7365 635f 7072 6f76 656e 616e  ce <sec_provenan
+0003cf30: 6365 5f74 6162 6c65 5f64 6566 696e 6974  ce_table_definit
+0003cf40: 696f 6e3e 600a 2020 2020 2020 2020 696e  ion>`.        in
+0003cf50: 2074 6869 7320 7472 6565 2073 6571 7565   this tree seque
+0003cf60: 6e63 6520 7769 7468 2074 6865 2073 7065  nce with the spe
+0003cf70: 6369 6669 6564 2049 442e 2020 4173 2077  cified ID.  As w
+0003cf80: 6974 6820 7079 7468 6f6e 206c 6973 7473  ith python lists
+0003cf90: 2c0a 2020 2020 2020 2020 6e65 6761 7469  ,.        negati
+0003cfa0: 7665 2049 4473 2063 616e 2062 6520 7573  ve IDs can be us
+0003cfb0: 6564 2074 6f20 696e 6465 7820 6261 636b  ed to index back
+0003cfc0: 7761 7264 7320 6672 6f6d 2074 6865 206c  wards from the l
+0003cfd0: 6173 7420 7072 6f76 656e 616e 6365 2e0a  ast provenance..
+0003cfe0: 2020 2020 2020 2020 2222 220a 2020 2020          """.    
+0003cff0: 2020 2020 6964 5f20 3d20 7365 6c66 2e63      id_ = self.c
+0003d000: 6865 636b 5f69 6e64 6578 2869 645f 2c20  heck_index(id_, 
+0003d010: 7365 6c66 2e6e 756d 5f70 726f 7665 6e61  self.num_provena
+0003d020: 6e63 6573 290a 2020 2020 2020 2020 7469  nces).        ti
+0003d030: 6d65 7374 616d 702c 2072 6563 6f72 6420  mestamp, record 
+0003d040: 3d20 7365 6c66 2e5f 6c6c 5f74 7265 655f  = self._ll_tree_
+0003d050: 7365 7175 656e 6365 2e67 6574 5f70 726f  sequence.get_pro
+0003d060: 7665 6e61 6e63 6528 6964 5f29 0a20 2020  venance(id_).   
+0003d070: 2020 2020 2072 6574 7572 6e20 5072 6f76       return Prov
+0003d080: 656e 616e 6365 2869 643d 6964 5f2c 2074  enance(id=id_, t
+0003d090: 696d 6573 7461 6d70 3d74 696d 6573 7461  imestamp=timesta
+0003d0a0: 6d70 2c20 7265 636f 7264 3d72 6563 6f72  mp, record=recor
+0003d0b0: 6429 0a0a 2020 2020 6465 6620 6765 745f  d)..    def get_
+0003d0c0: 7361 6d70 6c65 7328 7365 6c66 2c20 706f  samples(self, po
+0003d0d0: 7075 6c61 7469 6f6e 5f69 643d 4e6f 6e65  pulation_id=None
+0003d0e0: 293a 0a20 2020 2020 2020 2023 2044 6570  ):.        # Dep
+0003d0f0: 7265 6361 7465 6420 616c 6961 7320 666f  recated alias fo
+0003d100: 7220 7361 6d70 6c65 7328 290a 2020 2020  r samples().    
+0003d110: 2020 2020 7265 7475 726e 2073 656c 662e      return self.
+0003d120: 7361 6d70 6c65 7328 706f 7075 6c61 7469  samples(populati
+0003d130: 6f6e 5f69 6429 0a0a 2020 2020 6465 6620  on_id)..    def 
+0003d140: 7361 6d70 6c65 7328 7365 6c66 2c20 706f  samples(self, po
+0003d150: 7075 6c61 7469 6f6e 3d4e 6f6e 652c 202a  pulation=None, *
+0003d160: 2c20 706f 7075 6c61 7469 6f6e 5f69 643d  , population_id=
+0003d170: 4e6f 6e65 2c20 7469 6d65 3d4e 6f6e 6529  None, time=None)
+0003d180: 3a0a 2020 2020 2020 2020 2222 220a 2020  :.        """.  
+0003d190: 2020 2020 2020 5265 7475 726e 7320 616e        Returns an
+0003d1a0: 2061 7272 6179 206f 6620 7468 6520 7361   array of the sa
+0003d1b0: 6d70 6c65 206e 6f64 6520 4944 7320 696e  mple node IDs in
+0003d1c0: 2074 6869 7320 7472 6565 2073 6571 7565   this tree seque
+0003d1d0: 6e63 652e 2049 660a 2020 2020 2020 2020  nce. If.        
+0003d1e0: 6070 6f70 756c 6174 696f 6e60 2069 7320  `population` is 
+0003d1f0: 7370 6563 6966 6965 642c 206f 6e6c 7920  specified, only 
+0003d200: 7265 7475 726e 2073 616d 706c 6520 4944  return sample ID
+0003d210: 7320 6672 6f6d 2074 6861 7420 706f 7075  s from that popu
+0003d220: 6c61 7469 6f6e 2e0a 2020 2020 2020 2020  lation..        
+0003d230: 4974 2069 7320 616c 736f 2070 6f73 7369  It is also possi
+0003d240: 626c 6520 746f 2072 6573 7472 6963 7420  ble to restrict 
+0003d250: 7361 6d70 6c65 7320 6279 2074 696d 6520  samples by time 
+0003d260: 7573 696e 6720 7468 6520 7061 7261 6d65  using the parame
+0003d270: 7465 720a 2020 2020 2020 2020 6074 696d  ter.        `tim
+0003d280: 6560 2e20 4966 2060 7469 6d65 6020 6973  e`. If `time` is
+0003d290: 2061 206e 756d 6572 6963 2076 616c 7565   a numeric value
+0003d2a0: 2c20 6f6e 6c79 2072 6574 7572 6e20 7361  , only return sa
+0003d2b0: 6d70 6c65 2049 4473 2077 686f 7365 206e  mple IDs whose n
+0003d2c0: 6f64 650a 2020 2020 2020 2020 7469 6d65  ode.        time
+0003d2d0: 2069 7320 6170 7072 6f78 696d 6174 656c   is approximatel
+0003d2e0: 7920 6571 7561 6c20 746f 2074 6865 2073  y equal to the s
+0003d2f0: 7065 6369 6669 6564 2074 696d 652e 2049  pecified time. I
+0003d300: 6620 6074 696d 6560 2069 7320 6120 7061  f `time` is a pa
+0003d310: 6972 0a20 2020 2020 2020 206f 6620 7661  ir.        of va
+0003d320: 6c75 6573 206f 6620 7468 6520 666f 726d  lues of the form
+0003d330: 2060 286d 696e 5f74 696d 652c 206d 6178   `(min_time, max
+0003d340: 5f74 696d 6529 602c 206f 6e6c 7920 7265  _time)`, only re
+0003d350: 7475 726e 2073 616d 706c 6520 4944 730a  turn sample IDs.
+0003d360: 2020 2020 2020 2020 7768 6f73 6520 6e6f          whose no
+0003d370: 6465 2074 696d 6520 6074 6020 6973 2069  de time `t` is i
+0003d380: 6e20 7468 6973 2069 6e74 6572 7661 6c20  n this interval 
+0003d390: 7375 6368 2074 6861 7420 606d 696e 5f74  such that `min_t
+0003d3a0: 696d 6520 3c3d 2074 203c 206d 6178 5f74  ime <= t < max_t
+0003d3b0: 696d 6560 2e0a 0a20 2020 2020 2020 203a  ime`...        :
+0003d3c0: 7061 7261 6d20 696e 7420 706f 7075 6c61  param int popula
+0003d3d0: 7469 6f6e 3a20 5468 6520 706f 7075 6c61  tion: The popula
+0003d3e0: 7469 6f6e 206f 6620 696e 7465 7265 7374  tion of interest
+0003d3f0: 2e20 4966 204e 6f6e 652c 2064 6f20 6e6f  . If None, do no
+0003d400: 740a 2020 2020 2020 2020 2020 2020 6669  t.            fi
+0003d410: 6c74 6572 2073 616d 706c 6573 2062 7920  lter samples by 
+0003d420: 706f 7075 6c61 7469 6f6e 2e0a 2020 2020  population..    
+0003d430: 2020 2020 3a70 6172 616d 2069 6e74 2070      :param int p
+0003d440: 6f70 756c 6174 696f 6e5f 6964 3a20 4465  opulation_id: De
+0003d450: 7072 6563 6174 6564 2061 6c69 6173 2066  precated alias f
+0003d460: 6f72 2060 6070 6f70 756c 6174 696f 6e60  or ``population`
+0003d470: 602e 0a20 2020 2020 2020 203a 7061 7261  `..        :para
+0003d480: 6d20 666c 6f61 742c 7475 706c 6520 7469  m float,tuple ti
+0003d490: 6d65 3a20 5468 6520 7469 6d65 206f 7220  me: The time or 
+0003d4a0: 7469 6d65 2069 6e74 6572 7661 6c20 6f66  time interval of
+0003d4b0: 2069 6e74 6572 6573 742e 2049 660a 2020   interest. If.  
+0003d4c0: 2020 2020 2020 2020 2020 4e6f 6e65 2c20            None, 
+0003d4d0: 646f 206e 6f74 2066 696c 7465 7220 7361  do not filter sa
+0003d4e0: 6d70 6c65 7320 6279 2074 696d 652e 0a20  mples by time.. 
+0003d4f0: 2020 2020 2020 203a 7265 7475 726e 3a20         :return: 
+0003d500: 4120 6e75 6d70 7920 6172 7261 7920 6f66  A numpy array of
+0003d510: 2074 6865 206e 6f64 6520 4944 7320 666f   the node IDs fo
+0003d520: 7220 7468 6520 7361 6d70 6c65 7320 6f66  r the samples of
+0003d530: 2069 6e74 6572 6573 742c 0a20 2020 2020   interest,.     
+0003d540: 2020 2020 2020 206c 6973 7465 6420 696e         listed in
+0003d550: 206e 756d 6572 6963 616c 206f 7264 6572   numerical order
+0003d560: 2e0a 2020 2020 2020 2020 3a72 7479 7065  ..        :rtype
+0003d570: 3a20 6e75 6d70 792e 6e64 6172 7261 7920  : numpy.ndarray 
+0003d580: 2864 7479 7065 3d6e 702e 696e 7433 3229  (dtype=np.int32)
+0003d590: 0a20 2020 2020 2020 2022 2222 0a20 2020  .        """.   
+0003d5a0: 2020 2020 2069 6620 706f 7075 6c61 7469       if populati
+0003d5b0: 6f6e 2069 7320 6e6f 7420 4e6f 6e65 2061  on is not None a
+0003d5c0: 6e64 2070 6f70 756c 6174 696f 6e5f 6964  nd population_id
+0003d5d0: 2069 7320 6e6f 7420 4e6f 6e65 3a0a 2020   is not None:.  
+0003d5e0: 2020 2020 2020 2020 2020 7261 6973 6520            raise 
+0003d5f0: 5661 6c75 6545 7272 6f72 280a 2020 2020  ValueError(.    
+0003d600: 2020 2020 2020 2020 2020 2020 2270 6f70              "pop
+0003d610: 756c 6174 696f 6e5f 6964 2061 6e64 2070  ulation_id and p
+0003d620: 6f70 756c 6174 696f 6e20 6172 6520 616c  opulation are al
+0003d630: 6961 7365 732e 2043 616e 6e6f 7420 7370  iases. Cannot sp
+0003d640: 6563 6966 7920 626f 7468 220a 2020 2020  ecify both".    
+0003d650: 2020 2020 2020 2020 290a 2020 2020 2020          ).      
+0003d660: 2020 6966 2070 6f70 756c 6174 696f 6e5f    if population_
+0003d670: 6964 2069 7320 6e6f 7420 4e6f 6e65 3a0a  id is not None:.
+0003d680: 2020 2020 2020 2020 2020 2020 706f 7075              popu
+0003d690: 6c61 7469 6f6e 203d 2070 6f70 756c 6174  lation = populat
+0003d6a0: 696f 6e5f 6964 0a20 2020 2020 2020 2073  ion_id.        s
+0003d6b0: 616d 706c 6573 203d 2073 656c 662e 5f6c  amples = self._l
+0003d6c0: 6c5f 7472 6565 5f73 6571 7565 6e63 652e  l_tree_sequence.
+0003d6d0: 6765 745f 7361 6d70 6c65 7328 290a 2020  get_samples().  
+0003d6e0: 2020 2020 2020 6b65 6570 203d 206e 702e        keep = np.
+0003d6f0: 6675 6c6c 2873 6861 7065 3d73 616d 706c  full(shape=sampl
+0003d700: 6573 2e73 6861 7065 2c20 6669 6c6c 5f76  es.shape, fill_v
+0003d710: 616c 7565 3d54 7275 6529 0a20 2020 2020  alue=True).     
+0003d720: 2020 2069 6620 706f 7075 6c61 7469 6f6e     if population
+0003d730: 2069 7320 6e6f 7420 4e6f 6e65 3a0a 2020   is not None:.  
+0003d740: 2020 2020 2020 2020 2020 7361 6d70 6c65            sample
+0003d750: 5f70 6f70 756c 6174 696f 6e20 3d20 7365  _population = se
+0003d760: 6c66 2e6e 6f64 6573 5f70 6f70 756c 6174  lf.nodes_populat
+0003d770: 696f 6e5b 7361 6d70 6c65 735d 0a20 2020  ion[samples].   
+0003d780: 2020 2020 2020 2020 206b 6565 7020 3d20           keep = 
+0003d790: 6e70 2e6c 6f67 6963 616c 5f61 6e64 286b  np.logical_and(k
+0003d7a0: 6565 702c 2073 616d 706c 655f 706f 7075  eep, sample_popu
+0003d7b0: 6c61 7469 6f6e 203d 3d20 706f 7075 6c61  lation == popula
+0003d7c0: 7469 6f6e 290a 2020 2020 2020 2020 6966  tion).        if
+0003d7d0: 2074 696d 6520 6973 206e 6f74 204e 6f6e   time is not Non
+0003d7e0: 653a 0a20 2020 2020 2020 2020 2020 2023  e:.            #
+0003d7f0: 206e 646d 696e 2069 7320 7365 7420 736f   ndmin is set so
+0003d800: 2074 6861 7420 7363 616c 6172 7320 6172   that scalars ar
+0003d810: 6520 636f 6e76 6572 7465 6420 696e 746f  e converted into
+0003d820: 2031 6420 6172 7261 7973 0a20 2020 2020   1d arrays.     
+0003d830: 2020 2020 2020 2074 696d 6520 3d20 6e70         time = np
+0003d840: 2e61 7272 6179 2874 696d 652c 206e 646d  .array(time, ndm
+0003d850: 696e 3d31 2c20 6474 7970 653d 666c 6f61  in=1, dtype=floa
+0003d860: 7429 0a20 2020 2020 2020 2020 2020 2073  t).            s
+0003d870: 616d 706c 655f 7469 6d65 7320 3d20 7365  ample_times = se
+0003d880: 6c66 2e6e 6f64 6573 5f74 696d 655b 7361  lf.nodes_time[sa
+0003d890: 6d70 6c65 735d 0a20 2020 2020 2020 2020  mples].         
+0003d8a0: 2020 2069 6620 7469 6d65 2e73 6861 7065     if time.shape
+0003d8b0: 203d 3d20 2831 2c29 3a0a 2020 2020 2020   == (1,):.      
+0003d8c0: 2020 2020 2020 2020 2020 6b65 6570 203d            keep =
+0003d8d0: 206e 702e 6c6f 6769 6361 6c5f 616e 6428   np.logical_and(
+0003d8e0: 6b65 6570 2c20 6e70 2e69 7363 6c6f 7365  keep, np.isclose
+0003d8f0: 2873 616d 706c 655f 7469 6d65 732c 2074  (sample_times, t
+0003d900: 696d 6529 290a 2020 2020 2020 2020 2020  ime)).          
+0003d910: 2020 656c 6966 2074 696d 652e 7368 6170    elif time.shap
+0003d920: 6520 3d3d 2028 322c 293a 0a20 2020 2020  e == (2,):.     
+0003d930: 2020 2020 2020 2020 2020 2069 6620 7469             if ti
+0003d940: 6d65 5b31 5d20 3c3d 2074 696d 655b 305d  me[1] <= time[0]
+0003d950: 3a0a 2020 2020 2020 2020 2020 2020 2020  :.              
+0003d960: 2020 2020 2020 7261 6973 6520 5661 6c75        raise Valu
+0003d970: 6545 7272 6f72 2822 7469 6d65 5f69 6e74  eError("time_int
+0003d980: 6572 7661 6c20 6d61 7820 6973 206c 6573  erval max is les
+0003d990: 7320 7468 616e 206f 7220 6571 7561 6c20  s than or equal 
+0003d9a0: 746f 206d 696e 2e22 290a 2020 2020 2020  to min.").      
+0003d9b0: 2020 2020 2020 2020 2020 6b65 6570 203d            keep =
+0003d9c0: 206e 702e 6c6f 6769 6361 6c5f 616e 6428   np.logical_and(
+0003d9d0: 6b65 6570 2c20 7361 6d70 6c65 5f74 696d  keep, sample_tim
+0003d9e0: 6573 203e 3d20 7469 6d65 5b30 5d29 0a20  es >= time[0]). 
+0003d9f0: 2020 2020 2020 2020 2020 2020 2020 206b                 k
+0003da00: 6565 7020 3d20 6e70 2e6c 6f67 6963 616c  eep = np.logical
+0003da10: 5f61 6e64 286b 6565 702c 2073 616d 706c  _and(keep, sampl
+0003da20: 655f 7469 6d65 7320 3c20 7469 6d65 5b31  e_times < time[1
+0003da30: 5d29 0a20 2020 2020 2020 2020 2020 2065  ]).            e
+0003da40: 6c73 653a 0a20 2020 2020 2020 2020 2020  lse:.           
+0003da50: 2020 2020 2072 6169 7365 2056 616c 7565       raise Value
+0003da60: 4572 726f 7228 0a20 2020 2020 2020 2020  Error(.         
+0003da70: 2020 2020 2020 2020 2020 2022 7469 6d65             "time
+0003da80: 206d 7573 7420 6265 2065 6974 6865 7220   must be either 
+0003da90: 6120 7369 6e67 6c65 2076 616c 7565 206f  a single value o
+0003daa0: 7220 6120 7061 6972 206f 6620 7661 6c75  r a pair of valu
+0003dab0: 6573 2022 0a20 2020 2020 2020 2020 2020  es ".           
+0003dac0: 2020 2020 2020 2020 2022 286d 696e 5f74           "(min_t
+0003dad0: 696d 652c 206d 6178 5f74 696d 6529 2e22  ime, max_time)."
+0003dae0: 0a20 2020 2020 2020 2020 2020 2020 2020  .               
+0003daf0: 2029 0a20 2020 2020 2020 2072 6574 7572   ).        retur
+0003db00: 6e20 7361 6d70 6c65 735b 6b65 6570 5d0a  n samples[keep].
+0003db10: 0a20 2020 2064 6566 2061 735f 7663 6628  .    def as_vcf(
+0003db20: 7365 6c66 2c20 2a61 7267 732c 202a 2a6b  self, *args, **k
+0003db30: 7761 7267 7329 3a0a 2020 2020 2020 2020  wargs):.        
+0003db40: 2222 220a 2020 2020 2020 2020 5265 7475  """.        Retu
+0003db50: 726e 2074 6865 2072 6573 756c 7420 6f66  rn the result of
+0003db60: 203a 6d65 7468 3a60 2e77 7269 7465 5f76   :meth:`.write_v
+0003db70: 6366 6020 6173 2061 2073 7472 696e 672e  cf` as a string.
+0003db80: 0a20 2020 2020 2020 204b 6579 776f 7264  .        Keyword
+0003db90: 2070 6172 616d 6574 6572 7320 6172 6520   parameters are 
+0003dba0: 6173 2064 6566 696e 6564 2069 6e20 3a6d  as defined in :m
+0003dbb0: 6574 683a 602e 7772 6974 655f 7663 6660  eth:`.write_vcf`
+0003dbc0: 2e0a 0a20 2020 2020 2020 203a 7265 7475  ...        :retu
+0003dbd0: 726e 3a20 4120 5643 4620 656e 636f 6469  rn: A VCF encodi
+0003dbe0: 6e67 206f 6620 7468 6520 7661 7269 616e  ng of the varian
+0003dbf0: 7473 2069 6e20 7468 6973 2074 7265 6520  ts in this tree 
+0003dc00: 7365 7175 656e 6365 2061 7320 6120 7374  sequence as a st
+0003dc10: 7269 6e67 2e0a 2020 2020 2020 2020 3a72  ring..        :r
+0003dc20: 7479 7065 3a20 7374 720a 2020 2020 2020  type: str.      
+0003dc30: 2020 2222 220a 2020 2020 2020 2020 6275    """.        bu
+0003dc40: 6666 203d 2069 6f2e 5374 7269 6e67 494f  ff = io.StringIO
+0003dc50: 2829 0a20 2020 2020 2020 2073 656c 662e  ().        self.
+0003dc60: 7772 6974 655f 7663 6628 6275 6666 2c20  write_vcf(buff, 
+0003dc70: 2a61 7267 732c 202a 2a6b 7761 7267 7329  *args, **kwargs)
+0003dc80: 0a20 2020 2020 2020 2072 6574 7572 6e20  .        return 
+0003dc90: 6275 6666 2e67 6574 7661 6c75 6528 290a  buff.getvalue().
+0003dca0: 0a20 2020 2064 6566 2077 7269 7465 5f76  .    def write_v
+0003dcb0: 6366 280a 2020 2020 2020 2020 7365 6c66  cf(.        self
+0003dcc0: 2c0a 2020 2020 2020 2020 6f75 7470 7574  ,.        output
+0003dcd0: 2c0a 2020 2020 2020 2020 706c 6f69 6479  ,.        ploidy
+0003dce0: 3d4e 6f6e 652c 0a20 2020 2020 2020 202a  =None,.        *
+0003dcf0: 2c0a 2020 2020 2020 2020 636f 6e74 6967  ,.        contig
+0003dd00: 5f69 643d 2231 222c 0a20 2020 2020 2020  _id="1",.       
+0003dd10: 2069 6e64 6976 6964 7561 6c73 3d4e 6f6e   individuals=Non
+0003dd20: 652c 0a20 2020 2020 2020 2069 6e64 6976  e,.        indiv
+0003dd30: 6964 7561 6c5f 6e61 6d65 733d 4e6f 6e65  idual_names=None
+0003dd40: 2c0a 2020 2020 2020 2020 706f 7369 7469  ,.        positi
+0003dd50: 6f6e 5f74 7261 6e73 666f 726d 3d4e 6f6e  on_transform=Non
+0003dd60: 652c 0a20 2020 2020 2020 2073 6974 655f  e,.        site_
+0003dd70: 6d61 736b 3d4e 6f6e 652c 0a20 2020 2020  mask=None,.     
+0003dd80: 2020 2073 616d 706c 655f 6d61 736b 3d4e     sample_mask=N
+0003dd90: 6f6e 652c 0a20 2020 2020 2020 2069 736f  one,.        iso
+0003dda0: 6c61 7465 645f 6173 5f6d 6973 7369 6e67  lated_as_missing
+0003ddb0: 3d4e 6f6e 652c 0a20 2020 2029 3a0a 2020  =None,.    ):.  
+0003ddc0: 2020 2020 2020 2222 220a 2020 2020 2020        """.      
+0003ddd0: 2020 436f 6e76 6572 7420 7468 6520 6765    Convert the ge
+0003dde0: 6e65 7469 6320 7661 7269 6174 696f 6e20  netic variation 
+0003ddf0: 6461 7461 2069 6e20 7468 6973 2074 7265  data in this tre
+0003de00: 6520 7365 7175 656e 6365 2074 6f20 5661  e sequence to Va
+0003de10: 7269 616e 740a 2020 2020 2020 2020 4361  riant.        Ca
+0003de20: 6c6c 2046 6f72 6d61 7420 616e 6420 7772  ll Format and wr
+0003de30: 6974 6520 746f 2074 6865 2073 7065 6369  ite to the speci
+0003de40: 6669 6564 2066 696c 652d 6c69 6b65 206f  fied file-like o
+0003de50: 626a 6563 742e 0a0a 2020 2020 2020 2020  bject...        
+0003de60: 2e2e 2073 6565 616c 736f 3a20 5365 6520  .. seealso: See 
+0003de70: 7468 6520 3a72 6566 3a60 7365 635f 6578  the :ref:`sec_ex
+0003de80: 706f 7274 5f76 6366 6020 7365 6374 696f  port_vcf` sectio
+0003de90: 6e20 666f 7220 6578 616d 706c 6573 0a20  n for examples. 
+0003dea0: 2020 2020 2020 2020 2020 2061 6e64 2065             and e
+0003deb0: 7870 6c61 6e61 7469 6f6e 7320 6f66 2068  xplanations of h
+0003dec0: 6f77 2077 6520 6d61 7020 5643 4620 746f  ow we map VCF to
+0003ded0: 2074 6865 2074 736b 6974 2064 6174 6120   the tskit data 
+0003dee0: 6d6f 6465 6c2e 0a0a 2020 2020 2020 2020  model...        
+0003def0: 4d75 6c74 6970 6c6f 6964 2073 616d 706c  Multiploid sampl
+0003df00: 6573 2069 6e20 7468 6520 6f75 7470 7574  es in the output
+0003df10: 2056 4346 2061 7265 2067 656e 6572 6174   VCF are generat
+0003df20: 6564 2065 6974 6865 7220 7573 696e 670a  ed either using.
+0003df30: 2020 2020 2020 2020 696e 6469 7669 6475          individu
+0003df40: 616c 2069 6e66 6f72 6d61 7469 6f6e 2069  al information i
+0003df50: 6e20 7468 6520 6461 7461 206d 6f64 656c  n the data model
+0003df60: 2028 7365 650a 2020 2020 2020 2020 3a72   (see.        :r
+0003df70: 6566 3a60 7365 635f 696e 6469 7669 6475  ef:`sec_individu
+0003df80: 616c 5f74 6162 6c65 5f64 6566 696e 6974  al_table_definit
+0003df90: 696f 6e60 292c 206f 7220 6279 2063 6f6d  ion`), or by com
+0003dfa0: 6269 6e69 6e67 2067 656e 6f74 7970 6573  bining genotypes
+0003dfb0: 2066 6f72 0a20 2020 2020 2020 2061 646a   for.        adj
+0003dfc0: 6163 656e 7420 7361 6d70 6c65 206e 6f64  acent sample nod
+0003dfd0: 6573 2075 7369 6e67 2074 6865 2060 6070  es using the ``p
+0003dfe0: 6c6f 6964 7960 6020 6172 6775 6d65 6e74  loidy`` argument
+0003dff0: 2e20 5365 6520 7468 650a 2020 2020 2020  . See the.      
+0003e000: 2020 3a72 6566 3a60 7365 635f 6578 706f    :ref:`sec_expo
+0003e010: 7274 5f76 6366 5f63 6f6e 7374 7275 6374  rt_vcf_construct
+0003e020: 696e 675f 6774 6020 7365 6374 696f 6e20  ing_gt` section 
+0003e030: 666f 7220 6d6f 7265 2064 6574 6169 6c73  for more details
+0003e040: 0a20 2020 2020 2020 2061 6e64 2065 7861  .        and exa
+0003e050: 6d70 6c65 732e 0a0a 2020 2020 2020 2020  mples...        
+0003e060: 4966 2069 6e64 6976 6964 7561 6c73 2074  If individuals t
+0003e070: 6861 7420 6172 6520 6173 736f 6369 6174  hat are associat
+0003e080: 6564 2077 6974 6820 7361 6d70 6c65 206e  ed with sample n
+0003e090: 6f64 6573 2061 7265 2064 6566 696e 6564  odes are defined
+0003e0a0: 2069 6e20 7468 650a 2020 2020 2020 2020   in the.        
+0003e0b0: 6461 7461 206d 6f64 656c 2028 7365 6520  data model (see 
+0003e0c0: 3a72 6566 3a60 7365 635f 696e 6469 7669  :ref:`sec_indivi
+0003e0d0: 6475 616c 5f74 6162 6c65 5f64 6566 696e  dual_table_defin
+0003e0e0: 6974 696f 6e60 292c 2074 6865 2067 656e  ition`), the gen
+0003e0f0: 6f74 7970 6573 0a20 2020 2020 2020 2066  otypes.        f
+0003e100: 6f72 2065 6163 6820 6f66 2074 6865 2069  or each of the i
+0003e110: 6e64 6976 6964 7561 6c27 7320 7361 6d70  ndividual's samp
+0003e120: 6c65 7320 6172 6520 636f 6d62 696e 6564  les are combined
+0003e130: 2069 6e74 6f20 6120 7068 6173 6564 0a20   into a phased. 
+0003e140: 2020 2020 2020 206d 756c 7469 706c 6f69         multiploi
+0003e150: 6420 7661 6c75 6573 2061 7420 6561 6368  d values at each
+0003e160: 2073 6974 652e 2042 7920 6465 6661 756c   site. By defaul
+0003e170: 742c 2061 6c6c 2069 6e64 6976 6964 7561  t, all individua
+0003e180: 6c73 2061 7373 6f63 6961 7465 640a 2020  ls associated.  
+0003e190: 2020 2020 2020 7769 7468 2073 616d 706c        with sampl
+0003e1a0: 6520 6e6f 6465 7320 6172 6520 696e 636c  e nodes are incl
+0003e1b0: 7564 6564 2069 6e20 696e 6372 6561 7369  uded in increasi
+0003e1c0: 6e67 206f 7264 6572 206f 6620 696e 6469  ng order of indi
+0003e1d0: 7669 6475 616c 2049 442e 0a0a 2020 2020  vidual ID...    
+0003e1e0: 2020 2020 5375 6273 6574 7320 6f72 2070      Subsets or p
+0003e1f0: 6572 6d75 7461 7469 6f6e 7320 6f66 2074  ermutations of t
+0003e200: 6865 2073 616d 706c 6520 696e 6469 7669  he sample indivi
+0003e210: 6475 616c 7320 6d61 7920 6265 2073 7065  duals may be spe
+0003e220: 6369 6669 6564 0a20 2020 2020 2020 2075  cified.        u
+0003e230: 7369 6e67 2074 6865 2060 6069 6e64 6976  sing the ``indiv
+0003e240: 6964 7561 6c73 6060 2061 7267 756d 656e  iduals`` argumen
+0003e250: 742e 2049 7420 6973 2061 6e20 6572 726f  t. It is an erro
+0003e260: 7220 746f 2073 7065 6369 6679 2061 6e79  r to specify any
+0003e270: 0a20 2020 2020 2020 2069 6e64 6976 6964  .        individ
+0003e280: 7561 6c73 2074 6861 7420 6172 6520 6e6f  uals that are no
+0003e290: 7420 6173 736f 6369 6174 6564 2077 6974  t associated wit
+0003e2a0: 6820 616e 7920 6e6f 6465 732c 206f 7220  h any nodes, or 
+0003e2b0: 7768 6f73 650a 2020 2020 2020 2020 6e6f  whose.        no
+0003e2c0: 6465 7320 6172 6520 6e6f 7420 616c 6c20  des are not all 
+0003e2d0: 7361 6d70 6c65 732e 0a0a 2020 2020 2020  samples...      
+0003e2e0: 2020 4d69 7865 642d 7361 6d70 6c65 2069    Mixed-sample i
+0003e2f0: 6e64 6976 6964 7561 6c73 2028 652e 672e  ndividuals (e.g.
+0003e300: 2c20 7468 6f73 6520 6173 736f 6369 6174  , those associat
+0003e310: 6564 2077 6974 6820 6f6e 6520 6e6f 6465  ed with one node
+0003e320: 0a20 2020 2020 2020 2074 6861 7420 6973  .        that is
+0003e330: 2061 2073 616d 706c 6520 616e 6420 616e   a sample and an
+0003e340: 6f74 6865 7220 7468 6174 2069 7320 6e6f  other that is no
+0003e350: 7429 2069 6e20 7468 6520 6461 7461 206d  t) in the data m
+0003e360: 6f64 656c 2077 696c 6c0a 2020 2020 2020  odel will.      
+0003e370: 2020 7265 7375 6c74 2069 6e20 616e 2065    result in an e
+0003e380: 7272 6f72 2062 7920 6465 6661 756c 742e  rror by default.
+0003e390: 2048 6f77 6576 6572 2c20 7375 6368 2069   However, such i
+0003e3a0: 6e64 6976 6964 7561 6c73 2063 616e 2062  ndividuals can b
+0003e3b0: 650a 2020 2020 2020 2020 6578 636c 7564  e.        exclud
+0003e3c0: 6564 2075 7369 6e67 2074 6865 2060 6069  ed using the ``i
+0003e3d0: 6e64 6976 6964 7561 6c73 6060 2061 7267  ndividuals`` arg
+0003e3e0: 756d 656e 742e 0a0a 2020 2020 2020 2020  ument...        
+0003e3f0: 4966 2074 6865 7265 2061 7265 206e 6f20  If there are no 
+0003e400: 696e 6469 7669 6475 616c 7320 696e 2074  individuals in t
+0003e410: 6865 2074 7265 6520 7365 7175 656e 6365  he tree sequence
+0003e420: 2c0a 2020 2020 2020 2020 7379 6e74 6865  ,.        synthe
+0003e430: 7469 6320 696e 6469 7669 6475 616c 7320  tic individuals 
+0003e440: 6172 6520 6372 6561 7465 6420 6279 2063  are created by c
+0003e450: 6f6d 6269 6e69 6e67 2061 646a 6163 656e  ombining adjacen
+0003e460: 7420 7361 6d70 6c65 732c 2061 6e64 0a20  t samples, and. 
+0003e470: 2020 2020 2020 2074 6865 206e 756d 6265         the numbe
+0003e480: 7220 6f66 2073 616d 706c 6573 2063 6f6d  r of samples com
+0003e490: 6269 6e65 6420 6973 2065 7175 616c 2074  bined is equal t
+0003e4a0: 6f20 7468 6520 6060 706c 6f69 6479 6060  o the ``ploidy``
+0003e4b0: 2076 616c 7565 2028 3120 6279 0a20 2020   value (1 by.   
+0003e4c0: 2020 2020 2064 6566 6175 6c74 292e 2046       default). F
+0003e4d0: 6f72 2065 7861 6d70 6c65 2c20 6966 2077  or example, if w
+0003e4e0: 6520 6861 7665 2061 2060 6070 6c6f 6964  e have a ``ploid
+0003e4f0: 7960 6020 6f66 2032 2061 6e64 2036 2073  y`` of 2 and 6 s
+0003e500: 616d 706c 6520 6e6f 6465 732c 0a20 2020  ample nodes,.   
+0003e510: 2020 2020 2074 6865 6e20 7765 2077 696c       then we wil
+0003e520: 6c20 6861 7665 2033 2064 6970 6c6f 6964  l have 3 diploid
+0003e530: 2073 616d 706c 6573 2069 6e20 7468 6520   samples in the 
+0003e540: 5643 462c 2063 6f6e 7369 7374 696e 6720  VCF, consisting 
+0003e550: 6f66 2074 6865 0a20 2020 2020 2020 2063  of the.        c
+0003e560: 6f6d 6269 6e65 6420 6765 6e6f 7479 7065  ombined genotype
+0003e570: 7320 666f 7220 7361 6d70 6c65 7320 5b30  s for samples [0
+0003e580: 2c20 315d 2c20 5b32 2c20 335d 2061 6e64  , 1], [2, 3] and
+0003e590: 205b 342c 2035 5d2e 2049 6620 7765 2068   [4, 5]. If we h
+0003e5a0: 6164 0a20 2020 2020 2020 2067 656e 6f74  ad.        genot
+0003e5b0: 7970 6573 2030 3131 3131 3020 6174 2061  ypes 011110 at a
+0003e5c0: 2070 6172 7469 6375 6c61 7220 7661 7269   particular vari
+0003e5d0: 616e 742c 2074 6865 6e20 7765 2077 6f75  ant, then we wou
+0003e5e0: 6c64 206f 7574 7075 7420 7468 650a 2020  ld output the.  
+0003e5f0: 2020 2020 2020 6469 706c 6f69 6420 6765        diploid ge
+0003e600: 6e6f 7479 7065 7320 307c 312c 2031 7c31  notypes 0|1, 1|1
+0003e610: 2061 6e64 2031 7c30 2069 6e20 5643 462e   and 1|0 in VCF.
+0003e620: 0a0a 2020 2020 2020 2020 4561 6368 2069  ..        Each i
+0003e630: 6e64 6976 6964 7561 6c20 696e 2074 6865  ndividual in the
+0003e640: 206f 7574 7075 7420 6973 2069 6465 6e74   output is ident
+0003e650: 6966 6965 6420 6279 2061 2073 7472 696e  ified by a strin
+0003e660: 673b 2074 6865 7365 2061 7265 2074 6865  g; these are the
+0003e670: 0a20 2020 2020 2020 2056 4346 2022 7361  .        VCF "sa
+0003e680: 6d70 6c65 2220 6e61 6d65 732e 2042 7920  mple" names. By 
+0003e690: 6465 6661 756c 742c 2074 6865 7365 2061  default, these a
+0003e6a0: 7265 206f 6620 7468 6520 666f 726d 2060  re of the form `
+0003e6b0: 6074 736b 5f30 6060 2c0a 2020 2020 2020  `tsk_0``,.      
+0003e6c0: 2020 6060 7473 6b5f 3160 6020 6574 632c    ``tsk_1`` etc,
+0003e6d0: 2075 7020 746f 2074 6865 206e 756d 6265   up to the numbe
+0003e6e0: 7220 6f66 2069 6e64 6976 6964 7561 6c73  r of individuals
+0003e6f0: 2c20 6275 7420 6361 6e20 6265 206d 616e  , but can be man
+0003e700: 7561 6c6c 790a 2020 2020 2020 2020 7370  ually.        sp
+0003e710: 6563 6966 6965 6420 7573 696e 6720 7468  ecified using th
+0003e720: 6520 6060 696e 6469 7669 6475 616c 5f6e  e ``individual_n
+0003e730: 616d 6573 6060 2061 7267 756d 656e 742e  ames`` argument.
+0003e740: 2057 6520 646f 206e 6f74 2063 6865 636b   We do not check
+0003e750: 0a20 2020 2020 2020 2066 6f72 2064 7570  .        for dup
+0003e760: 6c69 6361 7465 7320 696e 2074 6869 7320  licates in this 
+0003e770: 6172 7261 792c 206f 7220 7065 7266 6f72  array, or perfor
+0003e780: 6d20 616e 7920 6368 6563 6b73 2074 6f20  m any checks to 
+0003e790: 656e 7375 7265 2074 6861 740a 2020 2020  ensure that.    
+0003e7a0: 2020 2020 7468 6520 6f75 7470 7574 2056      the output V
+0003e7b0: 4346 2069 7320 7765 6c6c 2d66 6f72 6d65  CF is well-forme
+0003e7c0: 642e 0a0a 2020 2020 2020 2020 2e2e 206e  d...        .. n
+0003e7d0: 6f74 653a 3a0a 2020 2020 2020 2020 2020  ote::.          
+0003e7e0: 2020 5468 6520 6465 6661 756c 7420 696e    The default in
+0003e7f0: 6469 7669 6475 616c 206e 616d 6573 2028  dividual names (
+0003e800: 5643 4620 7361 6d70 6c65 2049 4473 2920  VCF sample IDs) 
+0003e810: 6172 6520 616c 7761 7973 206f 660a 2020  are always of.  
+0003e820: 2020 2020 2020 2020 2020 7468 6520 666f            the fo
+0003e830: 726d 2060 6074 736b 5f30 6060 2c20 6060  rm ``tsk_0``, ``
+0003e840: 7473 6b5f 3160 602c 202e 2e2e 2c20 6060  tsk_1``, ..., ``
+0003e850: 7473 6b5f 7b4e 202d 2031 7d60 602c 2077  tsk_{N - 1}``, w
+0003e860: 6865 7265 0a20 2020 2020 2020 2020 2020  here.           
+0003e870: 204e 2069 7320 7468 6520 6e75 6d62 6572   N is the number
+0003e880: 206f 6620 696e 6469 7669 6475 616c 7320   of individuals 
+0003e890: 7765 206f 7574 7075 742e 2054 6865 7365  we output. These
+0003e8a0: 206e 756d 6265 7273 0a20 2020 2020 2020   numbers.       
+0003e8b0: 2020 2020 2061 7265 202a 2a6e 6f74 2a2a       are **not**
+0003e8c0: 206e 6563 6573 7361 7269 6c79 2074 6865   necessarily the
+0003e8d0: 2069 6e64 6976 6964 7561 6c20 4944 732e   individual IDs.
+0003e8e0: 0a0a 2020 2020 2020 2020 5468 6520 5245  ..        The RE
+0003e8f0: 4620 7661 6c75 6520 696e 2074 6865 206f  F value in the o
+0003e900: 7574 7075 7420 5643 4620 6973 2074 6865  utput VCF is the
+0003e910: 2061 6e63 6573 7472 616c 2061 6c6c 656c   ancestral allel
+0003e920: 6520 666f 7220 6120 7369 7465 0a20 2020  e for a site.   
+0003e930: 2020 2020 2061 6e64 2041 4c54 2076 616c       and ALT val
+0003e940: 7565 7320 6172 6520 7468 6520 7265 6d61  ues are the rema
+0003e950: 696e 696e 6720 616c 6c65 6c65 732e 2049  ining alleles. I
+0003e960: 7420 6973 2069 6d70 6f72 7461 6e74 2074  t is important t
+0003e970: 6f20 6e6f 7465 2c0a 2020 2020 2020 2020  o note,.        
+0003e980: 7468 6572 6566 6f72 652c 2074 6861 7420  therefore, that 
+0003e990: 666f 7220 7265 616c 2064 6174 6120 7468  for real data th
+0003e9a0: 6973 206d 6561 6e73 2074 6861 7420 7468  is means that th
+0003e9b0: 6520 5245 4620 7661 6c75 6520 666f 7220  e REF value for 
+0003e9c0: 6120 6769 7665 6e0a 2020 2020 2020 2020  a given.        
+0003e9d0: 7369 7465 202a 2a6d 6179 206e 6f74 2a2a  site **may not**
+0003e9e0: 2062 6520 6571 7561 6c20 746f 2074 6865   be equal to the
+0003e9f0: 2072 6566 6572 656e 6365 2061 6c6c 656c   reference allel
+0003ea00: 652e 2057 6520 616c 736f 2064 6f20 6e6f  e. We also do no
+0003ea10: 740a 2020 2020 2020 2020 6368 6563 6b20  t.        check 
+0003ea20: 7468 6174 2074 6865 2061 6c6c 656c 6573  that the alleles
+0003ea30: 2072 6573 756c 7420 696e 2061 2076 616c   result in a val
+0003ea40: 6964 2056 4346 2d2d 2d66 6f72 2065 7861  id VCF---for exa
+0003ea50: 6d70 6c65 2c20 6974 2069 7320 706f 7373  mple, it is poss
+0003ea60: 6962 6c65 0a20 2020 2020 2020 2074 6f20  ible.        to 
+0003ea70: 7573 6520 7468 6520 7461 6220 6368 6172  use the tab char
+0003ea80: 6163 7465 7220 6173 2061 6e20 616c 6c65  acter as an alle
+0003ea90: 6c65 2c20 6c65 6164 696e 6720 746f 2061  le, leading to a
+0003eaa0: 2062 726f 6b65 6e20 5643 462e 0a0a 2020   broken VCF...  
+0003eab0: 2020 2020 2020 5468 6520 4944 2076 616c        The ID val
+0003eac0: 7565 2069 6e20 7468 6520 6f75 7470 7574  ue in the output
+0003ead0: 2056 4346 2066 696c 6520 6973 2074 6865   VCF file is the
+0003eae0: 2069 6e74 6567 6572 2049 4420 6f66 2074   integer ID of t
+0003eaf0: 6865 0a20 2020 2020 2020 2063 6f72 7265  he.        corre
+0003eb00: 7370 6f6e 6469 6e67 203a 7265 663a 6073  sponding :ref:`s
+0003eb10: 6974 6520 3c73 6563 5f73 6974 655f 7461  ite <sec_site_ta
+0003eb20: 626c 655f 6465 6669 6e69 7469 6f6e 3e60  ble_definition>`
+0003eb30: 2028 6060 7369 7465 2e69 6460 6029 2e0a   (``site.id``)..
+0003eb40: 2020 2020 2020 2020 5468 6573 6520 4944          These ID
+0003eb50: 2076 616c 7565 7320 6361 6e20 6265 2075   values can be u
+0003eb60: 7469 6c69 7a65 6420 746f 206d 6174 6368  tilized to match
+0003eb70: 2074 6865 2063 6f6e 7465 6e74 7320 6f66   the contents of
+0003eb80: 2074 6865 2056 4346 2066 696c 650a 2020   the VCF file.  
+0003eb90: 2020 2020 2020 746f 2074 6865 2073 6974        to the sit
+0003eba0: 6573 2069 6e20 7468 6520 7472 6565 2073  es in the tree s
+0003ebb0: 6571 7565 6e63 6520 6f62 6a65 6374 2e0a  equence object..
+0003ebc0: 0a20 2020 2020 2020 202e 2e20 6e6f 7465  .        .. note
+0003ebd0: 3a3a 0a20 2020 2020 2020 2020 2020 4f6c  ::.           Ol
+0003ebe0: 6465 7220 636f 6465 206f 6674 656e 2075  der code often u
+0003ebf0: 7365 7320 7468 6520 6060 706c 6f69 6479  ses the ``ploidy
+0003ec00: 3d32 6060 2061 7267 756d 656e 742c 2062  =2`` argument, b
+0003ec10: 6563 6175 7365 206f 6c64 0a20 2020 2020  ecause old.     
+0003ec20: 2020 2020 2020 7665 7273 696f 6e73 206f        versions o
+0003ec30: 6620 6d73 7072 696d 6520 6469 6420 6e6f  f msprime did no
+0003ec40: 7420 6f75 7470 7574 2069 6e64 6976 6964  t output individ
+0003ec50: 7561 6c20 6461 7461 2e20 5370 6563 6966  ual data. Specif
+0003ec60: 7969 6e67 0a20 2020 2020 2020 2020 2020  ying.           
+0003ec70: 696e 6469 7669 6475 616c 7320 696e 2074  individuals in t
+0003ec80: 6865 2074 7265 6520 7365 7175 656e 6365  he tree sequence
+0003ec90: 2069 7320 6d6f 7265 2072 6f62 7573 742c   is more robust,
+0003eca0: 2061 6e64 2073 696e 6365 2074 7265 650a   and since tree.
+0003ecb0: 2020 2020 2020 2020 2020 2073 6571 7565             seque
+0003ecc0: 6e63 6573 206e 6f77 2020 7479 7069 6361  nces now  typica
+0003ecd0: 6c6c 7920 636f 6e74 6169 6e20 696e 6469  lly contain indi
+0003ece0: 7669 6475 616c 7320 2865 2e67 2e2c 2061  viduals (e.g., a
+0003ecf0: 7320 7072 6f64 7563 6564 2062 790a 2020  s produced by.  
+0003ed00: 2020 2020 2020 2020 2060 606d 7370 7269           ``mspri
+0003ed10: 6d65 2e73 696d 5f61 6e63 6573 7472 7928  me.sim_ancestry(
+0003ed20: 2029 6060 292c 2074 6869 7320 6973 206e   )``), this is n
+0003ed30: 6f74 206e 6563 6573 7361 7279 2c20 616e  ot necessary, an
+0003ed40: 6420 7468 650a 2020 2020 2020 2020 2020  d the.          
+0003ed50: 2060 6070 6c6f 6964 7960 6020 6172 6775   ``ploidy`` argu
+0003ed60: 6d65 6e74 2063 616e 2073 6166 656c 7920  ment can safely 
+0003ed70: 6265 2072 656d 6f76 6564 2061 7320 7061  be removed as pa
+0003ed80: 7274 206f 6620 7468 6520 7072 6f63 6573  rt of the proces
+0003ed90: 730a 2020 2020 2020 2020 2020 206f 6620  s.           of 
+0003eda0: 7570 6461 7469 6e67 2066 726f 6d20 7468  updating from th
+0003edb0: 6520 6d73 7072 696d 6520 302e 7820 6c65  e msprime 0.x le
+0003edc0: 6761 6379 2041 5049 2e0a 0a20 2020 2020  gacy API...     
+0003edd0: 2020 203a 7061 7261 6d20 696f 2e49 4f42     :param io.IOB
+0003ede0: 6173 6520 6f75 7470 7574 3a20 5468 6520  ase output: The 
+0003edf0: 6669 6c65 2d6c 696b 6520 6f62 6a65 6374  file-like object
+0003ee00: 2074 6f20 7772 6974 6520 7468 6520 5643   to write the VC
+0003ee10: 4620 6f75 7470 7574 2e0a 2020 2020 2020  F output..      
+0003ee20: 2020 3a70 6172 616d 2069 6e74 2070 6c6f    :param int plo
+0003ee30: 6964 793a 2054 6865 2070 6c6f 6964 7920  idy: The ploidy 
+0003ee40: 6f66 2074 6865 2069 6e64 6976 6964 7561  of the individua
+0003ee50: 6c73 2074 6f20 6265 2077 7269 7474 656e  ls to be written
+0003ee60: 2074 6f0a 2020 2020 2020 2020 2020 2020   to.            
+0003ee70: 5643 462e 2054 6869 7320 7361 6d70 6c65  VCF. This sample
+0003ee80: 2073 697a 6520 6d75 7374 2062 6520 6576   size must be ev
+0003ee90: 656e 6c79 2064 6976 6973 6962 6c65 2062  enly divisible b
+0003eea0: 7920 706c 6f69 6479 2e20 4361 6e6e 6f74  y ploidy. Cannot
+0003eeb0: 2062 650a 2020 2020 2020 2020 2020 2020   be.            
+0003eec0: 7573 6564 2069 6620 7468 6572 6520 6973  used if there is
+0003eed0: 2069 6e64 6976 6964 7561 6c20 6461 7461   individual data
+0003eee0: 2069 6e20 7468 6520 7472 6565 2073 6571   in the tree seq
+0003eef0: 7565 6e63 652e 0a20 2020 2020 2020 203a  uence..        :
+0003ef00: 7061 7261 6d20 7374 7220 636f 6e74 6967  param str contig
+0003ef10: 5f69 643a 2054 6865 2076 616c 7565 206f  _id: The value o
+0003ef20: 6620 7468 6520 4348 524f 4d20 636f 6c75  f the CHROM colu
+0003ef30: 6d6e 2069 6e20 7468 6520 6f75 7470 7574  mn in the output
+0003ef40: 2056 4346 2e0a 2020 2020 2020 2020 3a70   VCF..        :p
+0003ef50: 6172 616d 206c 6973 7428 696e 7429 2069  aram list(int) i
+0003ef60: 6e64 6976 6964 7561 6c73 3a20 4120 6c69  ndividuals: A li
+0003ef70: 7374 2063 6f6e 7461 696e 696e 6720 7468  st containing th
+0003ef80: 6520 696e 6469 7669 6475 616c 2049 4473  e individual IDs
+0003ef90: 2074 6f0a 2020 2020 2020 2020 2020 2020   to.            
+0003efa0: 636f 7272 6573 706f 6e64 696e 6720 746f  corresponding to
+0003efb0: 2074 6865 2056 4346 2073 616d 706c 6573   the VCF samples
+0003efc0: 2e20 4465 6661 756c 7473 2074 6f20 616c  . Defaults to al
+0003efd0: 6c20 696e 6469 7669 6475 616c 730a 2020  l individuals.  
+0003efe0: 2020 2020 2020 2020 2020 6173 736f 6369            associ
+0003eff0: 6174 6564 2077 6974 6820 7361 6d70 6c65  ated with sample
+0003f000: 206e 6f64 6573 2069 6e20 7468 6520 7472   nodes in the tr
+0003f010: 6565 2073 6571 7565 6e63 652e 0a20 2020  ee sequence..   
+0003f020: 2020 2020 2020 2020 2053 6565 2074 6865           See the
+0003f030: 207b 7265 667d 6073 6563 5f65 7870 6f72   {ref}`sec_expor
+0003f040: 745f 7663 665f 636f 6e73 7472 7563 7469  t_vcf_constructi
+0003f050: 6e67 5f67 7460 2073 6563 7469 6f6e 2066  ng_gt` section f
+0003f060: 6f72 206d 6f72 650a 2020 2020 2020 2020  or more.        
+0003f070: 2020 2020 6465 7461 696c 7320 616e 6420      details and 
+0003f080: 6578 616d 706c 6573 2e0a 2020 2020 2020  examples..      
+0003f090: 2020 3a70 6172 616d 206c 6973 7428 7374    :param list(st
+0003f0a0: 7229 2069 6e64 6976 6964 7561 6c5f 6e61  r) individual_na
+0003f0b0: 6d65 733a 2041 206c 6973 7420 6f66 2073  mes: A list of s
+0003f0c0: 7472 696e 6720 6e61 6d65 7320 746f 2069  tring names to i
+0003f0d0: 6465 6e74 6966 790a 2020 2020 2020 2020  dentify.        
+0003f0e0: 2020 2020 696e 6469 7669 6475 616c 2063      individual c
+0003f0f0: 6f6c 756d 6e73 2069 6e20 7468 6520 5643  olumns in the VC
+0003f100: 462e 2049 6e20 5643 4620 6e6f 6d65 6e63  F. In VCF nomenc
+0003f110: 6c61 7475 7265 2c20 7468 6573 6520 6172  lature, these ar
+0003f120: 6520 7468 650a 2020 2020 2020 2020 2020  e the.          
+0003f130: 2020 7361 6d70 6c65 2049 4473 2e20 4966    sample IDs. If
+0003f140: 2073 7065 6369 6669 6564 2c20 7468 6973   specified, this
+0003f150: 206d 7573 7420 6265 2061 206c 6973 7420   must be a list 
+0003f160: 6f66 2073 7472 696e 6773 206f 660a 2020  of strings of.  
+0003f170: 2020 2020 2020 2020 2020 6c65 6e67 7468            length
+0003f180: 2065 7175 616c 2074 6f20 7468 6520 6e75   equal to the nu
+0003f190: 6d62 6572 206f 6620 696e 6469 7669 6475  mber of individu
+0003f1a0: 616c 7320 746f 2062 6520 6f75 7470 7574  als to be output
+0003f1b0: 2e20 4e6f 7465 2074 6861 740a 2020 2020  . Note that.    
+0003f1c0: 2020 2020 2020 2020 7765 2064 6f20 6e6f          we do no
+0003f1d0: 7420 6368 6563 6b20 7468 6520 666f 726d  t check the form
+0003f1e0: 206f 6620 7468 6573 6520 7374 7269 6e67   of these string
+0003f1f0: 7320 696e 2061 6e79 2077 6179 2c20 736f  s in any way, so
+0003f200: 2074 6861 7420 6973 0a20 2020 2020 2020   that is.       
+0003f210: 2020 2020 2069 7320 706f 7373 6962 6c65       is possible
+0003f220: 2074 6f20 6f75 7470 7574 206d 616c 666f   to output malfo
+0003f230: 726d 6564 2056 4346 2028 666f 7220 6578  rmed VCF (for ex
+0003f240: 616d 706c 652c 2062 7920 656d 6265 6464  ample, by embedd
+0003f250: 696e 6720 610a 2020 2020 2020 2020 2020  ing a.          
+0003f260: 2020 7461 6220 6368 6172 6163 7465 7220    tab character 
+0003f270: 7769 7468 696e 206f 6e20 6f66 2074 6865  within on of the
+0003f280: 206e 616d 6573 292e 2054 6865 2064 6566   names). The def
+0003f290: 6175 6c74 2069 7320 746f 206f 7574 7075  ault is to outpu
+0003f2a0: 740a 2020 2020 2020 2020 2020 2020 6060  t.            ``
+0003f2b0: 7473 6b5f 6a60 6020 666f 7220 7468 6520  tsk_j`` for the 
+0003f2c0: 6a74 6820 696e 6469 7669 6475 616c 2e0a  jth individual..
+0003f2d0: 2020 2020 2020 2020 2020 2020 5365 6520              See 
+0003f2e0: 7468 6520 3a72 6566 3a60 7365 635f 6578  the :ref:`sec_ex
+0003f2f0: 706f 7274 5f76 6366 5f69 6e64 6976 6964  port_vcf_individ
+0003f300: 7561 6c5f 6e61 6d65 7360 2066 6f72 2065  ual_names` for e
+0003f310: 7861 6d70 6c65 730a 2020 2020 2020 2020  xamples.        
+0003f320: 2020 2020 616e 6420 6d6f 7265 2069 6e66      and more inf
+0003f330: 6f72 6d61 7469 6f6e 2e0a 2020 2020 2020  ormation..      
+0003f340: 2020 3a70 6172 616d 2070 6f73 6974 696f    :param positio
+0003f350: 6e5f 7472 616e 7366 6f72 6d3a 2041 2063  n_transform: A c
+0003f360: 616c 6c61 626c 6520 7468 6174 2074 7261  allable that tra
+0003f370: 6e73 666f 726d 7320 7468 650a 2020 2020  nsforms the.    
+0003f380: 2020 2020 2020 2020 7369 7465 2070 6f73          site pos
+0003f390: 6974 696f 6e20 7661 6c75 6573 2069 6e74  ition values int
+0003f3a0: 6f20 696e 7465 6765 7220 7661 6c75 6564  o integer valued
+0003f3b0: 2063 6f6f 7264 696e 6174 6573 2073 7569   coordinates sui
+0003f3c0: 7461 626c 6520 666f 720a 2020 2020 2020  table for.      
+0003f3d0: 2020 2020 2020 5643 462e 2054 6865 2066        VCF. The f
+0003f3e0: 756e 6374 696f 6e20 7461 6b65 7320 6120  unction takes a 
+0003f3f0: 7369 6e67 6c65 2070 6f73 6974 696f 6e61  single positiona
+0003f400: 6c20 7061 7261 6d65 7465 7220 7820 616e  l parameter x an
+0003f410: 6420 6d75 7374 0a20 2020 2020 2020 2020  d must.         
+0003f420: 2020 2072 6574 7572 6e20 616e 2069 6e74     return an int
+0003f430: 6567 6572 206e 756d 7079 2061 7272 6179  eger numpy array
+0003f440: 2074 6865 2073 616d 6520 6469 6d65 6e73   the same dimens
+0003f450: 696f 6e20 6173 2078 2e20 4279 2064 6566  ion as x. By def
+0003f460: 6175 6c74 2c0a 2020 2020 2020 2020 2020  ault,.          
+0003f470: 2020 7468 6973 2069 7320 7365 7420 746f    this is set to
+0003f480: 2060 606e 756d 7079 2e72 6f75 6e64 2829   ``numpy.round()
+0003f490: 6060 2077 6869 6368 2077 696c 6c20 726f  `` which will ro
+0003f4a0: 756e 6420 7661 6c75 6573 2074 6f20 7468  und values to th
+0003f4b0: 650a 2020 2020 2020 2020 2020 2020 6e65  e.            ne
+0003f4c0: 6172 6573 7420 696e 7465 6765 722e 2049  arest integer. I
+0003f4d0: 6620 7468 6520 7374 7269 6e67 2022 6c65  f the string "le
+0003f4e0: 6761 6379 2220 6973 2070 726f 7669 6465  gacy" is provide
+0003f4f0: 6420 6865 7265 2c20 7468 650a 2020 2020  d here, the.    
+0003f500: 2020 2020 2020 2020 7072 6520 302e 322e          pre 0.2.
+0003f510: 3020 6c65 6761 6379 2062 6568 6176 696f  0 legacy behavio
+0003f520: 7572 206f 6620 726f 756e 6469 6e67 2076  ur of rounding v
+0003f530: 616c 7565 7320 746f 2074 6865 206e 6561  alues to the nea
+0003f540: 7265 7374 2069 6e74 6567 6572 0a20 2020  rest integer.   
+0003f550: 2020 2020 2020 2020 2028 7374 6172 7469           (starti
+0003f560: 6e67 2066 726f 6d20 3129 2061 6e64 2061  ng from 1) and a
+0003f570: 766f 6964 696e 6720 7468 6520 6f75 7470  voiding the outp
+0003f580: 7574 206f 6620 6964 656e 7469 6361 6c20  ut of identical 
+0003f590: 706f 7369 7469 6f6e 730a 2020 2020 2020  positions.      
+0003f5a0: 2020 2020 2020 6279 2069 6e63 7265 6d65        by increme
+0003f5b0: 6e74 696e 6720 6973 2075 7365 642e 0a20  nting is used.. 
+0003f5c0: 2020 2020 2020 2020 2020 2053 6565 2074             See t
+0003f5d0: 6865 203a 7265 663a 6073 6563 5f65 7870  he :ref:`sec_exp
+0003f5e0: 6f72 745f 7663 665f 6d6f 6469 6679 696e  ort_vcf_modifyin
+0003f5f0: 675f 636f 6f72 6469 6e61 7465 7360 2066  g_coordinates` f
+0003f600: 6f72 2065 7861 6d70 6c65 730a 2020 2020  or examples.    
+0003f610: 2020 2020 2020 2020 616e 6420 6d6f 7265          and more
+0003f620: 2069 6e66 6f72 6d61 7469 6f6e 2e0a 2020   information..  
+0003f630: 2020 2020 2020 3a70 6172 616d 2073 6974        :param sit
+0003f640: 655f 6d61 736b 3a20 4120 6e75 6d70 7920  e_mask: A numpy 
+0003f650: 626f 6f6c 6561 6e20 6172 7261 7920 286f  boolean array (o
+0003f660: 7220 736f 6d65 7468 696e 6720 636f 6e76  r something conv
+0003f670: 6572 7461 626c 6520 746f 0a20 2020 2020  ertable to.     
+0003f680: 2020 2020 2020 2061 206e 756d 7079 2062         a numpy b
+0003f690: 6f6f 6c65 616e 2061 7272 6179 2920 7769  oolean array) wi
+0003f6a0: 7468 206e 756d 5f73 6974 6573 2065 6c65  th num_sites ele
+0003f6b0: 6d65 6e74 732c 2075 7365 6420 746f 206d  ments, used to m
+0003f6c0: 6173 6b20 6f75 740a 2020 2020 2020 2020  ask out.        
+0003f6d0: 2020 2020 7369 7465 7320 696e 2074 6865      sites in the
+0003f6e0: 206f 7574 7075 742e 2049 6620 2060 6073   output. If  ``s
+0003f6f0: 6974 655f 6d61 736b 5b6a 5d60 6020 6973  ite_mask[j]`` is
+0003f700: 2054 7275 652c 2074 6865 6e20 7468 6973   True, then this
+0003f710: 0a20 2020 2020 2020 2020 2020 2073 6974  .            sit
+0003f720: 6520 2869 2e65 2e2c 2074 6865 206c 696e  e (i.e., the lin
+0003f730: 6520 696e 2074 6865 2056 4346 2066 696c  e in the VCF fil
+0003f740: 6529 2077 696c 6c20 6265 206f 6d69 7474  e) will be omitt
+0003f750: 6564 2e0a 2020 2020 2020 2020 2020 2020  ed..            
+0003f760: 5365 6520 7468 6520 3a72 6566 3a60 7365  See the :ref:`se
+0003f770: 635f 6578 706f 7274 5f76 6366 5f6d 6173  c_export_vcf_mas
+0003f780: 6b69 6e67 5f6f 7574 7075 7460 2066 6f72  king_output` for
+0003f790: 2065 7861 6d70 6c65 730a 2020 2020 2020   examples.      
+0003f7a0: 2020 2020 2020 616e 6420 6d6f 7265 2069        and more i
+0003f7b0: 6e66 6f72 6d61 7469 6f6e 2e0a 2020 2020  nformation..    
+0003f7c0: 2020 2020 3a70 6172 616d 2073 616d 706c      :param sampl
+0003f7d0: 655f 6d61 736b 3a20 4120 6e75 6d70 7920  e_mask: A numpy 
+0003f7e0: 626f 6f6c 6561 6e20 6172 7261 7920 286f  boolean array (o
+0003f7f0: 7220 736f 6d65 7468 696e 6720 636f 6e76  r something conv
+0003f800: 6572 7461 626c 6520 746f 0a20 2020 2020  ertable to.     
+0003f810: 2020 2020 2020 2061 206e 756d 7079 2062         a numpy b
+0003f820: 6f6f 6c65 616e 2061 7272 6179 2920 7769  oolean array) wi
+0003f830: 7468 206e 756d 5f73 616d 706c 6573 2065  th num_samples e
+0003f840: 6c65 6d65 6e74 732c 206f 7220 6120 6361  lements, or a ca
+0003f850: 6c6c 6162 6c65 0a20 2020 2020 2020 2020  llable.         
+0003f860: 2020 2074 6861 7420 7265 7475 726e 7320     that returns 
+0003f870: 7375 6368 2061 6e20 6172 7261 792c 2073  such an array, s
+0003f880: 7563 6820 7468 6174 2069 660a 2020 2020  uch that if.    
+0003f890: 2020 2020 2020 2020 6060 7361 6d70 6c65          ``sample
+0003f8a0: 5f6d 6173 6b5b 6a5d 6060 2069 7320 5472  _mask[j]`` is Tr
+0003f8b0: 7565 2c20 7468 656e 2074 6865 2067 656e  ue, then the gen
+0003f8c0: 6f74 7970 6520 666f 7220 7361 6d70 6c65  otype for sample
+0003f8d0: 2060 606a 6060 0a20 2020 2020 2020 2020   ``j``.         
+0003f8e0: 2020 2077 696c 6c20 6265 206d 6172 6b65     will be marke
+0003f8f0: 6420 6173 206d 6973 7369 6e67 2075 7369  d as missing usi
+0003f900: 6e67 2061 2022 2e22 2e20 4966 2060 6073  ng a ".". If ``s
+0003f910: 616d 706c 655f 6d61 736b 6060 2069 7320  ample_mask`` is 
+0003f920: 610a 2020 2020 2020 2020 2020 2020 6361  a.            ca
+0003f930: 6c6c 6162 6c65 2c20 6974 206d 7573 7420  llable, it must 
+0003f940: 7461 6b65 2061 2073 696e 676c 6520 6172  take a single ar
+0003f950: 6775 6d65 6e74 2061 6e64 2072 6574 7572  gument and retur
+0003f960: 6e20 6120 626f 6f6c 6561 6e0a 2020 2020  n a boolean.    
+0003f970: 2020 2020 2020 2020 6e75 6d70 7920 6172          numpy ar
+0003f980: 7261 792e 2054 6869 7320 6675 6e63 7469  ray. This functi
+0003f990: 6f6e 2077 696c 6c20 6265 2063 616c 6c65  on will be calle
+0003f9a0: 6420 666f 7220 6561 6368 2028 756e 6d61  d for each (unma
+0003f9b0: 736b 6564 2920 7369 7465 0a20 2020 2020  sked) site.     
+0003f9c0: 2020 2020 2020 2077 6974 6820 7468 6520         with the 
+0003f9d0: 636f 7272 6573 706f 6e64 696e 6720 3a63  corresponding :c
+0003f9e0: 6c61 7373 3a60 2e56 6172 6961 6e74 6020  lass:`.Variant` 
+0003f9f0: 6f62 6a65 6374 2c20 616c 6c6f 7769 6e67  object, allowing
+0003fa00: 0a20 2020 2020 2020 2020 2020 2066 6f72  .            for
+0003fa10: 2064 796e 616d 6963 206d 6173 6b73 2074   dynamic masks t
+0003fa20: 6f20 6265 2067 656e 6572 6174 6564 2e0a  o be generated..
+0003fa30: 2020 2020 2020 2020 2020 2020 5365 6520              See 
+0003fa40: 7468 6520 3a72 6566 3a60 7365 635f 6578  the :ref:`sec_ex
+0003fa50: 706f 7274 5f76 6366 5f6d 6173 6b69 6e67  port_vcf_masking
+0003fa60: 5f6f 7574 7075 7460 2066 6f72 2065 7861  _output` for exa
+0003fa70: 6d70 6c65 730a 2020 2020 2020 2020 2020  mples.          
+0003fa80: 2020 616e 6420 6d6f 7265 2069 6e66 6f72    and more infor
+0003fa90: 6d61 7469 6f6e 2e0a 2020 2020 2020 2020  mation..        
+0003faa0: 3a70 6172 616d 2062 6f6f 6c20 6973 6f6c  :param bool isol
+0003fab0: 6174 6564 5f61 735f 6d69 7373 696e 673a  ated_as_missing:
+0003fac0: 2049 6620 5472 7565 2c20 7468 6520 6765   If True, the ge
+0003fad0: 6e6f 7479 7065 2076 616c 7565 2061 7373  notype value ass
+0003fae0: 6967 6e65 6420 746f 0a20 2020 2020 2020  igned to.       
+0003faf0: 2020 2020 206d 6973 7369 6e67 2073 616d       missing sam
+0003fb00: 706c 6573 2028 692e 652e 2c20 6973 6f6c  ples (i.e., isol
+0003fb10: 6174 6564 2073 616d 706c 6573 2077 6974  ated samples wit
+0003fb20: 686f 7574 206d 7574 6174 696f 6e73 2920  hout mutations) 
+0003fb30: 6973 2022 2e22 0a20 2020 2020 2020 2020  is ".".         
+0003fb40: 2020 2049 6620 4661 6c73 652c 206d 6973     If False, mis
+0003fb50: 7369 6e67 2073 616d 706c 6573 2077 696c  sing samples wil
+0003fb60: 6c20 6265 2061 7373 6967 6e65 6420 7468  l be assigned th
+0003fb70: 6520 616e 6365 7374 7261 6c20 616c 6c65  e ancestral alle
+0003fb80: 6c65 2e0a 2020 2020 2020 2020 2020 2020  le..            
+0003fb90: 5365 6520 3a6d 6574 683a 602e 7661 7269  See :meth:`.vari
+0003fba0: 616e 7473 6020 666f 7220 6d6f 7265 2069  ants` for more i
+0003fbb0: 6e66 6f72 6d61 7469 6f6e 2e20 4465 6661  nformation. Defa
+0003fbc0: 756c 743a 2054 7275 652e 0a20 2020 2020  ult: True..     
+0003fbd0: 2020 2022 2222 0a20 2020 2020 2020 2077     """.        w
+0003fbe0: 7269 7465 7220 3d20 7663 662e 5663 6657  riter = vcf.VcfW
+0003fbf0: 7269 7465 7228 0a20 2020 2020 2020 2020  riter(.         
+0003fc00: 2020 2073 656c 662c 0a20 2020 2020 2020     self,.       
+0003fc10: 2020 2020 2070 6c6f 6964 793d 706c 6f69       ploidy=ploi
+0003fc20: 6479 2c0a 2020 2020 2020 2020 2020 2020  dy,.            
+0003fc30: 636f 6e74 6967 5f69 643d 636f 6e74 6967  contig_id=contig
+0003fc40: 5f69 642c 0a20 2020 2020 2020 2020 2020  _id,.           
+0003fc50: 2069 6e64 6976 6964 7561 6c73 3d69 6e64   individuals=ind
+0003fc60: 6976 6964 7561 6c73 2c0a 2020 2020 2020  ividuals,.      
+0003fc70: 2020 2020 2020 696e 6469 7669 6475 616c        individual
+0003fc80: 5f6e 616d 6573 3d69 6e64 6976 6964 7561  _names=individua
+0003fc90: 6c5f 6e61 6d65 732c 0a20 2020 2020 2020  l_names,.       
+0003fca0: 2020 2020 2070 6f73 6974 696f 6e5f 7472       position_tr
+0003fcb0: 616e 7366 6f72 6d3d 706f 7369 7469 6f6e  ansform=position
+0003fcc0: 5f74 7261 6e73 666f 726d 2c0a 2020 2020  _transform,.    
+0003fcd0: 2020 2020 2020 2020 7369 7465 5f6d 6173          site_mas
+0003fce0: 6b3d 7369 7465 5f6d 6173 6b2c 0a20 2020  k=site_mask,.   
+0003fcf0: 2020 2020 2020 2020 2073 616d 706c 655f           sample_
+0003fd00: 6d61 736b 3d73 616d 706c 655f 6d61 736b  mask=sample_mask
+0003fd10: 2c0a 2020 2020 2020 2020 2020 2020 6973  ,.            is
+0003fd20: 6f6c 6174 6564 5f61 735f 6d69 7373 696e  olated_as_missin
+0003fd30: 673d 6973 6f6c 6174 6564 5f61 735f 6d69  g=isolated_as_mi
+0003fd40: 7373 696e 672c 0a20 2020 2020 2020 2029  ssing,.        )
+0003fd50: 0a20 2020 2020 2020 2077 7269 7465 722e  .        writer.
+0003fd60: 7772 6974 6528 6f75 7470 7574 290a 0a20  write(output).. 
+0003fd70: 2020 2064 6566 2077 7269 7465 5f66 6173     def write_fas
+0003fd80: 7461 280a 2020 2020 2020 2020 7365 6c66  ta(.        self
+0003fd90: 2c0a 2020 2020 2020 2020 6669 6c65 5f6f  ,.        file_o
+0003fda0: 725f 7061 7468 2c0a 2020 2020 2020 2020  r_path,.        
+0003fdb0: 2a2c 0a20 2020 2020 2020 2077 7261 705f  *,.        wrap_
+0003fdc0: 7769 6474 683d 3630 2c0a 2020 2020 2020  width=60,.      
+0003fdd0: 2020 7265 6665 7265 6e63 655f 7365 7175    reference_sequ
+0003fde0: 656e 6365 3d4e 6f6e 652c 0a20 2020 2020  ence=None,.     
+0003fdf0: 2020 206d 6973 7369 6e67 5f64 6174 615f     missing_data_
+0003fe00: 6368 6172 6163 7465 723d 4e6f 6e65 2c0a  character=None,.
+0003fe10: 2020 2020 293a 0a20 2020 2020 2020 2022      ):.        "
+0003fe20: 2222 0a20 2020 2020 2020 2057 7269 7465  "".        Write
+0003fe30: 7320 7468 6520 3a6d 6574 683a 602e 616c  s the :meth:`.al
+0003fe40: 6967 6e6d 656e 7473 6020 666f 7220 7468  ignments` for th
+0003fe50: 6973 2074 7265 6520 7365 7175 656e 6365  is tree sequence
+0003fe60: 2074 6f20 6669 6c65 2069 6e0a 2020 2020   to file in.    
+0003fe70: 2020 2020 6046 4153 5441 203c 6874 7470      `FASTA <http
+0003fe80: 733a 2f2f 656e 2e77 696b 6970 6564 6961  s://en.wikipedia
+0003fe90: 2e6f 7267 2f77 696b 692f 4641 5354 415f  .org/wiki/FASTA_
+0003fea0: 666f 726d 6174 3e60 5f5f 2066 6f72 6d61  format>`__ forma
+0003feb0: 742e 0a20 2020 2020 2020 2050 6c65 6173  t..        Pleas
+0003fec0: 6520 7365 6520 7468 6520 3a6d 6574 683a  e see the :meth:
+0003fed0: 602e 616c 6967 6e6d 656e 7473 6020 6d65  `.alignments` me
+0003fee0: 7468 6f64 2066 6f72 2064 6574 6169 6c73  thod for details
+0003fef0: 206f 6e20 686f 770a 2020 2020 2020 2020   on how.        
+0003ff00: 7265 6665 7265 6e63 6520 7365 7175 656e  reference sequen
+0003ff10: 6365 7320 6172 6520 6861 6e64 6c65 642e  ces are handled.
+0003ff20: 0a0a 2020 2020 2020 2020 416c 6967 6e6d  ..        Alignm
+0003ff30: 656e 7473 2061 7265 2072 6574 7572 6e65  ents are returne
+0003ff40: 6420 666f 7220 7468 650a 2020 2020 2020  d for the.      
+0003ff50: 2020 3a72 6566 3a60 7361 6d70 6c65 206e    :ref:`sample n
+0003ff60: 6f64 6573 3c73 6563 5f64 6174 615f 6d6f  odes<sec_data_mo
+0003ff70: 6465 6c5f 6465 6669 6e69 7469 6f6e 733e  del_definitions>
+0003ff80: 6020 696e 2074 6869 7320 7472 6565 0a20  ` in this tree. 
+0003ff90: 2020 2020 2020 2073 6571 7565 6e63 652c         sequence,
+0003ffa0: 2061 6e64 2061 2073 616d 706c 6520 7769   and a sample wi
+0003ffb0: 7468 206e 6f64 6520 6964 2060 6075 6060  th node id ``u``
+0003ffc0: 2069 7320 6769 7665 6e20 7468 6520 6c61   is given the la
+0003ffd0: 6265 6c0a 2020 2020 2020 2020 6060 6622  bel.        ``f"
+0003ffe0: 6e7b 757d 2260 602c 2066 6f6c 6c6f 7769  n{u}"``, followi
+0003fff0: 6e67 2074 6865 2073 616d 6520 636f 6e76  ng the same conv
+00040000: 656e 7469 6f6e 2061 7320 7468 650a 2020  ention as the.  
+00040010: 2020 2020 2020 3a6d 6574 683a 602e 7772        :meth:`.wr
+00040020: 6974 655f 6e65 7875 7360 2061 6e64 203a  ite_nexus` and :
+00040030: 6d65 7468 3a60 5472 6565 2e61 735f 6e65  meth:`Tree.as_ne
+00040040: 7769 636b 6020 6d65 7468 6f64 732e 0a0a  wick` methods...
+00040050: 2020 2020 2020 2020 5468 6520 6060 7772          The ``wr
+00040060: 6170 5f77 6964 7468 6060 2070 6172 616d  ap_width`` param
+00040070: 6574 6572 2063 6f6e 7472 6f6c 7320 7468  eter controls th
+00040080: 6520 6d61 7869 6d75 6d20 7769 6474 6820  e maximum width 
+00040090: 6f66 206c 696e 6573 0a20 2020 2020 2020  of lines.       
+000400a0: 206f 6620 7365 7175 656e 6365 2064 6174   of sequence dat
+000400b0: 6120 696e 2074 6865 206f 7574 7075 742e  a in the output.
+000400c0: 2042 7920 6465 6661 756c 7420 7468 6973   By default this
+000400d0: 2069 7320 3630 0a20 2020 2020 2020 2063   is 60.        c
+000400e0: 6861 7261 6374 6572 7320 696e 2061 6363  haracters in acc
+000400f0: 6f72 6461 6e63 6520 7769 7468 2066 6173  ordance with fas
+00040100: 7461 2073 7461 6e64 6172 6420 6f75 7470  ta standard outp
+00040110: 7574 732e 2054 6f20 7475 726e 206f 6666  uts. To turn off
+00040120: 0a20 2020 2020 2020 206c 696e 652d 7772  .        line-wr
+00040130: 6170 7069 6e67 206f 6620 7365 7175 656e  apping of sequen
+00040140: 6365 732c 2073 6574 2060 6077 7261 705f  ces, set ``wrap_
+00040150: 7769 6474 6860 6020 3d20 302e 0a0a 2020  width`` = 0...  
+00040160: 2020 2020 2020 4578 616d 706c 6520 7573        Example us
+00040170: 6167 653a 0a0a 2020 2020 2020 2020 2e2e  age:..        ..
+00040180: 2063 6f64 652d 626c 6f63 6b3a 3a20 7079   code-block:: py
+00040190: 7468 6f6e 0a0a 2020 2020 2020 2020 2020  thon..          
+000401a0: 2020 7473 2e77 7269 7465 5f66 6173 7461    ts.write_fasta
+000401b0: 2822 6f75 7470 7574 2e66 6122 290a 0a20  ("output.fa").. 
+000401c0: 2020 2020 2020 202e 2e20 7761 726e 696e         .. warnin
+000401d0: 673a 3a20 3a72 6566 3a60 4d69 7373 696e  g:: :ref:`Missin
+000401e0: 6720 6461 7461 3c73 6563 5f64 6174 615f  g data<sec_data_
+000401f0: 6d6f 6465 6c5f 6d69 7373 696e 675f 6461  model_missing_da
+00040200: 7461 3e60 2069 7320 6e6f 740a 2020 2020  ta>` is not.    
+00040210: 2020 2020 2020 2020 6375 7272 656e 746c          currentl
+00040220: 7920 7375 7070 6f72 7465 6420 6279 2074  y supported by t
+00040230: 6869 7320 6d65 7468 6f64 2061 6e64 2069  his method and i
+00040240: 7420 7769 6c6c 2072 6169 7365 2061 2056  t will raise a V
+00040250: 616c 7565 4572 726f 720a 2020 2020 2020  alueError.      
+00040260: 2020 2020 2020 6966 2063 616c 6c65 6420        if called 
+00040270: 6f6e 2074 7265 6520 7365 7175 656e 6365  on tree sequence
+00040280: 7320 636f 6e74 6169 6e69 6e67 2069 736f  s containing iso
+00040290: 6c61 7465 6420 7361 6d70 6c65 732e 0a20  lated samples.. 
+000402a0: 2020 2020 2020 2020 2020 2053 6565 2068             See h
+000402b0: 7474 7073 3a2f 2f67 6974 6875 622e 636f  ttps://github.co
+000402c0: 6d2f 7473 6b69 742d 6465 762f 7473 6b69  m/tskit-dev/tski
+000402d0: 742f 6973 7375 6573 2f31 3839 3620 666f  t/issues/1896 fo
+000402e0: 7220 6d6f 7265 0a20 2020 2020 2020 2020  r more.         
+000402f0: 2020 2069 6e66 6f72 6d61 7469 6f6e 2e0a     information..
+00040300: 0a20 2020 2020 2020 203a 7061 7261 6d20  .        :param 
+00040310: 6669 6c65 5f6f 725f 7061 7468 3a20 5468  file_or_path: Th
+00040320: 6520 6669 6c65 206f 626a 6563 7420 6f72  e file object or
+00040330: 2070 6174 6820 746f 2077 7269 7465 2074   path to write t
+00040340: 6865 206f 7574 7075 742e 0a20 2020 2020  he output..     
+00040350: 2020 2020 2020 2050 6174 6873 2063 616e         Paths can
+00040360: 2062 6520 6569 7468 6572 2073 7472 696e   be either strin
+00040370: 6773 206f 7220 3a63 6c61 7373 3a60 7079  gs or :class:`py
+00040380: 7468 6f6e 3a70 6174 686c 6962 2e50 6174  thon:pathlib.Pat
+00040390: 6860 206f 626a 6563 7473 2e0a 2020 2020  h` objects..    
+000403a0: 2020 2020 3a70 6172 616d 2069 6e74 2077      :param int w
+000403b0: 7261 705f 7769 6474 683a 2054 6865 206e  rap_width: The n
+000403c0: 756d 6265 7220 6f66 2073 6571 7565 6e63  umber of sequenc
+000403d0: 650a 2020 2020 2020 2020 2020 2020 6368  e.            ch
+000403e0: 6172 6163 7465 7273 2074 6f20 696e 636c  aracters to incl
+000403f0: 7564 6520 6f6e 2065 6163 6820 6c69 6e65  ude on each line
+00040400: 2069 6e20 7468 6520 6661 7374 6120 6669   in the fasta fi
+00040410: 6c65 2c20 6265 666f 7265 2077 7261 7070  le, before wrapp
+00040420: 696e 670a 2020 2020 2020 2020 2020 2020  ing.            
+00040430: 746f 2074 6865 206e 6578 7420 6c69 6e65  to the next line
+00040440: 2066 6f72 2065 6163 6820 7365 7175 656e   for each sequen
+00040450: 6365 2c20 6f72 2030 2074 6f20 7475 726e  ce, or 0 to turn
+00040460: 206f 6666 206c 696e 6520 7772 6170 7069   off line wrappi
+00040470: 6e67 2e0a 2020 2020 2020 2020 2020 2020  ng..            
+00040480: 2844 6566 6175 6c74 3d36 3029 2e0a 2020  (Default=60)..  
+00040490: 2020 2020 2020 3a70 6172 616d 2073 7472        :param str
+000404a0: 2072 6566 6572 656e 6365 5f73 6571 7565   reference_seque
+000404b0: 6e63 653a 2041 7320 666f 7220 7468 6520  nce: As for the 
+000404c0: 3a6d 6574 683a 602e 616c 6967 6e6d 656e  :meth:`.alignmen
+000404d0: 7473 6020 6d65 7468 6f64 2e0a 2020 2020  ts` method..    
+000404e0: 2020 2020 3a70 6172 616d 2073 7472 206d      :param str m
+000404f0: 6973 7369 6e67 5f64 6174 615f 6368 6172  issing_data_char
+00040500: 6163 7465 723a 2041 7320 666f 7220 7468  acter: As for th
+00040510: 6520 3a6d 6574 683a 602e 616c 6967 6e6d  e :meth:`.alignm
+00040520: 656e 7473 6020 6d65 7468 6f64 2e0a 2020  ents` method..  
+00040530: 2020 2020 2020 2222 220a 2020 2020 2020        """.      
+00040540: 2020 7465 7874 5f66 6f72 6d61 7473 2e77    text_formats.w
+00040550: 7269 7465 5f66 6173 7461 280a 2020 2020  rite_fasta(.    
+00040560: 2020 2020 2020 2020 7365 6c66 2c0a 2020          self,.  
+00040570: 2020 2020 2020 2020 2020 6669 6c65 5f6f            file_o
+00040580: 725f 7061 7468 2c0a 2020 2020 2020 2020  r_path,.        
+00040590: 2020 2020 7772 6170 5f77 6964 7468 3d77      wrap_width=w
+000405a0: 7261 705f 7769 6474 682c 0a20 2020 2020  rap_width,.     
+000405b0: 2020 2020 2020 2072 6566 6572 656e 6365         reference
+000405c0: 5f73 6571 7565 6e63 653d 7265 6665 7265  _sequence=refere
+000405d0: 6e63 655f 7365 7175 656e 6365 2c0a 2020  nce_sequence,.  
+000405e0: 2020 2020 2020 2020 2020 6d69 7373 696e            missin
+000405f0: 675f 6461 7461 5f63 6861 7261 6374 6572  g_data_character
+00040600: 3d6d 6973 7369 6e67 5f64 6174 615f 6368  =missing_data_ch
+00040610: 6172 6163 7465 722c 0a20 2020 2020 2020  aracter,.       
+00040620: 2029 0a0a 2020 2020 6465 6620 6173 5f66   )..    def as_f
+00040630: 6173 7461 2873 656c 662c 202a 2a6b 7761  asta(self, **kwa
+00040640: 7267 7329 3a0a 2020 2020 2020 2020 2222  rgs):.        ""
+00040650: 220a 2020 2020 2020 2020 5265 7475 726e  ".        Return
+00040660: 2074 6865 2072 6573 756c 7420 6f66 203a   the result of :
+00040670: 6d65 7468 3a60 2e77 7269 7465 5f66 6173  meth:`.write_fas
+00040680: 7461 6020 6173 2061 2073 7472 696e 672e  ta` as a string.
+00040690: 0a20 2020 2020 2020 204b 6579 776f 7264  .        Keyword
+000406a0: 2070 6172 616d 6574 6572 7320 6172 6520   parameters are 
+000406b0: 6173 2064 6566 696e 6564 2069 6e20 3a6d  as defined in :m
+000406c0: 6574 683a 602e 7772 6974 655f 6661 7374  eth:`.write_fast
+000406d0: 6160 2e0a 0a20 2020 2020 2020 203a 7265  a`...        :re
+000406e0: 7475 726e 3a20 4120 4641 5354 4120 656e  turn: A FASTA en
+000406f0: 636f 6469 6e67 206f 6620 7468 6520 616c  coding of the al
+00040700: 6967 6e6d 656e 7473 2069 6e20 7468 6973  ignments in this
+00040710: 2074 7265 6520 7365 7175 656e 6365 2061   tree sequence a
+00040720: 7320 6120 7374 7269 6e67 2e0a 2020 2020  s a string..    
+00040730: 2020 2020 3a72 7479 7065 3a20 7374 720a      :rtype: str.
+00040740: 2020 2020 2020 2020 2222 220a 2020 2020          """.    
+00040750: 2020 2020 6275 6666 203d 2069 6f2e 5374      buff = io.St
+00040760: 7269 6e67 494f 2829 0a20 2020 2020 2020  ringIO().       
+00040770: 2073 656c 662e 7772 6974 655f 6661 7374   self.write_fast
+00040780: 6128 6275 6666 2c20 2a2a 6b77 6172 6773  a(buff, **kwargs
+00040790: 290a 2020 2020 2020 2020 7265 7475 726e  ).        return
+000407a0: 2062 7566 662e 6765 7476 616c 7565 2829   buff.getvalue()
+000407b0: 0a0a 2020 2020 6465 6620 7772 6974 655f  ..    def write_
+000407c0: 6e65 7875 7328 0a20 2020 2020 2020 2073  nexus(.        s
+000407d0: 656c 662c 0a20 2020 2020 2020 2066 696c  elf,.        fil
+000407e0: 655f 6f72 5f70 6174 682c 0a20 2020 2020  e_or_path,.     
+000407f0: 2020 202a 2c0a 2020 2020 2020 2020 7072     *,.        pr
+00040800: 6563 6973 696f 6e3d 4e6f 6e65 2c0a 2020  ecision=None,.  
+00040810: 2020 2020 2020 696e 636c 7564 655f 7472        include_tr
+00040820: 6565 733d 4e6f 6e65 2c0a 2020 2020 2020  ees=None,.      
+00040830: 2020 696e 636c 7564 655f 616c 6967 6e6d    include_alignm
+00040840: 656e 7473 3d4e 6f6e 652c 0a20 2020 2020  ents=None,.     
+00040850: 2020 2072 6566 6572 656e 6365 5f73 6571     reference_seq
+00040860: 7565 6e63 653d 4e6f 6e65 2c0a 2020 2020  uence=None,.    
+00040870: 2020 2020 6d69 7373 696e 675f 6461 7461      missing_data
+00040880: 5f63 6861 7261 6374 6572 3d4e 6f6e 652c  _character=None,
+00040890: 0a20 2020 2029 3a0a 2020 2020 2020 2020  .    ):.        
+000408a0: 2222 220a 2020 2020 2020 2020 5265 7475  """.        Retu
+000408b0: 726e 7320 6120 606e 6578 7573 2065 6e63  rns a `nexus enc
+000408c0: 6f64 696e 6720 3c68 7474 7073 3a2f 2f65  oding <https://e
+000408d0: 6e2e 7769 6b69 7065 6469 612e 6f72 672f  n.wikipedia.org/
+000408e0: 7769 6b69 2f4e 6578 7573 5f66 696c 653e  wiki/Nexus_file>
+000408f0: 605f 0a20 2020 2020 2020 206f 6620 7468  `_.        of th
+00040900: 6973 2074 7265 6520 7365 7175 656e 6365  is tree sequence
+00040910: 2e20 4279 2064 6566 6175 6c74 2c20 7472  . By default, tr
+00040920: 6565 2074 6f70 6f6c 6f67 6965 7320 6172  ee topologies ar
+00040930: 6520 696e 636c 7564 6564 0a20 2020 2020  e included.     
+00040940: 2020 2069 6e20 7468 6520 6f75 7470 7574     in the output
+00040950: 2c20 616e 6420 7365 7175 656e 6365 2064  , and sequence d
+00040960: 6174 6120 616c 6967 6e6d 656e 7473 2061  ata alignments a
+00040970: 7265 2069 6e63 6c75 6465 6420 6279 2064  re included by d
+00040980: 6566 6175 6c74 0a20 2020 2020 2020 2069  efault.        i
+00040990: 6620 7468 6973 2074 7265 6520 7365 7175  f this tree sequ
+000409a0: 656e 6365 2068 6173 2064 6973 6372 6574  ence has discret
+000409b0: 6520 6765 6e6f 6d65 2063 6f6f 7264 696e  e genome coordin
+000409c0: 6174 6573 2061 6e64 206f 6e65 206f 720a  ates and one or.
+000409d0: 2020 2020 2020 2020 6d6f 7265 2073 6974          more sit
+000409e0: 6573 2e20 496e 636c 7573 696f 6e20 6f66  es. Inclusion of
+000409f0: 2074 6865 7365 2073 6563 7469 6f6e 7320   these sections 
+00040a00: 6361 6e20 6265 2063 6f6e 7472 6f6c 6c65  can be controlle
+00040a10: 6420 6d61 6e75 616c 6c79 0a20 2020 2020  d manually.     
+00040a20: 2020 2075 7369 6e67 2074 6865 2060 6069     using the ``i
+00040a30: 6e63 6c75 6465 5f74 7265 6573 6060 2061  nclude_trees`` a
+00040a40: 6e64 2060 6069 6e63 6c75 6465 5f61 6c69  nd ``include_ali
+00040a50: 676e 6d65 6e74 7360 6020 7061 7261 6d65  gnments`` parame
+00040a60: 7465 7273 2e0a 0a20 2020 2020 2020 2054  ters...        T
+00040a70: 7265 6520 746f 706f 6c6f 6769 6573 2061  ree topologies a
+00040a80: 6e64 2062 7261 6e63 6820 6c65 6e67 7468  nd branch length
+00040a90: 7320 6172 6520 6c69 7374 6564 0a20 2020  s are listed.   
+00040aa0: 2020 2020 2073 6571 7565 6e74 6961 6c6c       sequentiall
+00040ab0: 7920 696e 2074 6865 2054 5245 4553 2062  y in the TREES b
+00040ac0: 6c6f 636b 2061 6e64 2074 6865 2073 7061  lock and the spa
+00040ad0: 7469 616c 206c 6f63 6174 696f 6e20 6f66  tial location of
+00040ae0: 2065 6163 6820 7472 6565 0a20 2020 2020   each tree.     
+00040af0: 2020 2065 6e63 6f64 6564 2077 6974 6869     encoded withi
+00040b00: 6e20 7468 6520 7472 6565 206e 616d 6520  n the tree name 
+00040b10: 6c61 6265 6c73 2e20 5370 6563 6966 6963  labels. Specific
+00040b20: 616c 6c79 2c20 6120 7472 6565 2073 7061  ally, a tree spa
+00040b30: 6e6e 696e 670a 2020 2020 2020 2020 7468  nning.        th
+00040b40: 6520 696e 7465 7276 616c 203a 6d61 7468  e interval :math
+00040b50: 3a60 5b78 2c20 7929 6060 2069 7320 6769  :`[x, y)`` is gi
+00040b60: 7665 6e20 7468 6520 6e61 6d65 2060 6066  ven the name ``f
+00040b70: 2274 7b78 7d5e 7b79 7d22 6060 0a20 2020  "t{x}^{y}"``.   
+00040b80: 2020 2020 2028 5365 6520 6265 6c6f 7720       (See below 
+00040b90: 666f 7220 6120 6465 7363 7269 7074 696f  for a descriptio
+00040ba0: 6e20 6f66 2074 6865 2070 7265 6369 7369  n of the precisi
+00040bb0: 6f6e 2061 7420 7768 6963 6820 7468 6573  on at which thes
+00040bc0: 6520 7370 6174 6961 6c0a 2020 2020 2020  e spatial.      
+00040bd0: 2020 636f 6f72 6469 6e61 7465 7320 6172    coordinates ar
+00040be0: 6520 7072 696e 7465 6420 6f75 7429 2e0a  e printed out)..
+00040bf0: 0a20 2020 2020 2020 2054 6865 203a 7265  .        The :re
+00040c00: 663a 6073 616d 706c 6520 6e6f 6465 733c  f:`sample nodes<
+00040c10: 7365 635f 6461 7461 5f6d 6f64 656c 5f64  sec_data_model_d
+00040c20: 6566 696e 6974 696f 6e73 3e60 2069 6e20  efinitions>` in 
+00040c30: 7468 6973 2074 7265 650a 2020 2020 2020  this tree.      
+00040c40: 2020 7365 7175 656e 6365 2061 7265 2072    sequence are r
+00040c50: 6567 6172 6465 6420 6173 2074 6178 612c  egarded as taxa,
+00040c60: 2061 6e64 2061 2073 616d 706c 6520 7769   and a sample wi
+00040c70: 7468 206e 6f64 6520 6964 2060 6075 6060  th node id ``u``
+00040c80: 0a20 2020 2020 2020 2069 7320 6769 7665  .        is give
+00040c90: 6e20 7468 6520 6c61 6265 6c20 6060 6622  n the label ``f"
+00040ca0: 6e7b 757d 2260 602c 2066 6f6c 6c6f 7769  n{u}"``, followi
+00040cb0: 6e67 2074 6865 2073 616d 6520 636f 6e76  ng the same conv
+00040cc0: 656e 7469 6f6e 0a20 2020 2020 2020 2061  ention.        a
+00040cd0: 7320 7468 6520 3a6d 6574 683a 6054 7265  s the :meth:`Tre
+00040ce0: 652e 6173 5f6e 6577 6963 6b60 206d 6574  e.as_newick` met
+00040cf0: 686f 642e 0a0a 2020 2020 2020 2020 4279  hod...        By
+00040d00: 2064 6566 6175 6c74 2c20 6765 6e6f 6d65   default, genome
+00040d10: 2070 6f73 6974 696f 6e73 2061 7265 2070   positions are p
+00040d20: 7269 6e74 6564 206f 7574 2077 6974 6820  rinted out with 
+00040d30: 7769 7468 2073 7566 6669 6369 656e 740a  with sufficient.
+00040d40: 2020 2020 2020 2020 7072 6563 6973 696f          precisio
+00040d50: 6e20 666f 7220 7468 656d 2074 6f20 6265  n for them to be
+00040d60: 2072 6563 6f76 6572 6564 2065 7861 6374   recovered exact
+00040d70: 6c79 2069 6e20 646f 7562 6c65 2070 7265  ly in double pre
+00040d80: 6369 7369 6f6e 2e0a 2020 2020 2020 2020  cision..        
+00040d90: 4966 2074 6865 2074 7265 6520 7365 7175  If the tree sequ
+00040da0: 656e 6365 2069 7320 6465 6669 6e65 6420  ence is defined 
+00040db0: 6f6e 2061 203a 6174 7472 3a60 2e64 6973  on a :attr:`.dis
+00040dc0: 6372 6574 655f 6765 6e6f 6d65 602c 0a20  crete_genome`,. 
+00040dd0: 2020 2020 2020 2074 6865 6e20 706f 7369         then posi
+00040de0: 7469 6f6e 7320 6172 6520 7772 6974 7465  tions are writte
+00040df0: 6e20 6f75 7420 6173 2069 6e74 6567 6572  n out as integer
+00040e00: 732e 204f 7468 6572 7769 7365 2c20 3137  s. Otherwise, 17
+00040e10: 2064 6967 6974 730a 2020 2020 2020 2020   digits.        
+00040e20: 6f66 2070 7265 6369 7369 6f6e 2069 7320  of precision is 
+00040e30: 7573 6564 2e20 4272 616e 6368 206c 656e  used. Branch len
+00040e40: 6774 6820 7072 6563 6973 696f 6e20 6465  gth precision de
+00040e50: 6661 756c 7473 2061 7265 2068 616e 646c  faults are handl
+00040e60: 6564 0a20 2020 2020 2020 2069 6e20 7468  ed.        in th
+00040e70: 6520 7361 6d65 2077 6179 2061 7320 3a6d  e same way as :m
+00040e80: 6574 683a 602e 5472 6565 2e61 735f 6e65  eth:`.Tree.as_ne
+00040e90: 7769 636b 602e 0a0a 2020 2020 2020 2020  wick`...        
+00040ea0: 4966 2074 6865 2060 6070 7265 6369 7369  If the ``precisi
+00040eb0: 6f6e 6060 2061 7267 756d 656e 7420 6973  on`` argument is
+00040ec0: 2070 726f 7669 6465 642c 2067 656e 6f6d   provided, genom
+00040ed0: 6520 706f 7369 7469 6f6e 7320 616e 640a  e positions and.
+00040ee0: 2020 2020 2020 2020 6272 616e 6368 206c          branch l
+00040ef0: 656e 6774 6873 2061 7265 2070 7269 6e74  engths are print
+00040f00: 6564 206f 7574 2077 6974 6820 7468 6973  ed out with this
+00040f10: 206d 616e 7920 6469 6769 7473 206f 6620   many digits of 
+00040f20: 7072 6563 6973 696f 6e2e 0a0a 2020 2020  precision...    
+00040f30: 2020 2020 466f 7220 6578 616d 706c 652c      For example,
+00040f40: 2068 6572 6520 6973 2074 6865 206e 6578   here is the nex
+00040f50: 7573 2065 6e63 6f64 696e 6720 6f66 2061  us encoding of a
+00040f60: 2073 696d 706c 6520 7472 6565 2073 6571   simple tree seq
+00040f70: 7565 6e63 650a 2020 2020 2020 2020 7769  uence.        wi
+00040f80: 7468 2069 6e74 6567 6572 2074 696d 6573  th integer times
+00040f90: 2061 6e64 2067 656e 6f6d 6520 636f 6f72   and genome coor
+00040fa0: 6469 6e61 7465 7320 7769 7468 2074 6872  dinates with thr
+00040fb0: 6565 2073 616d 706c 6573 0a20 2020 2020  ee samples.     
+00040fc0: 2020 2061 6e64 2074 776f 2074 7265 6573     and two trees
+00040fd0: 3a3a 0a0a 2020 2020 2020 2020 2020 2020  ::..            
+00040fe0: 234e 4558 5553 0a20 2020 2020 2020 2020  #NEXUS.         
+00040ff0: 2020 2042 4547 494e 2054 4158 413b 0a20     BEGIN TAXA;. 
+00041000: 2020 2020 2020 2020 2020 2020 2044 494d               DIM
+00041010: 454e 5349 4f4e 5320 4e54 4158 3d33 3b0a  ENSIONS NTAX=3;.
+00041020: 2020 2020 2020 2020 2020 2020 2020 5441                TA
+00041030: 584c 4142 454c 5320 6e30 206e 3120 6e32  XLABELS n0 n1 n2
+00041040: 3b0a 2020 2020 2020 2020 2020 2020 454e  ;.            EN
+00041050: 443b 0a20 2020 2020 2020 2020 2020 2042  D;.            B
+00041060: 4547 494e 2054 5245 4553 3b0a 2020 2020  EGIN TREES;.    
+00041070: 2020 2020 2020 2020 2020 5452 4545 2074            TREE t
+00041080: 305e 3220 3d20 5b26 525d 2028 6e30 3a33  0^2 = [&R] (n0:3
+00041090: 2c28 6e31 3a32 2c6e 323a 3229 3a31 293b  ,(n1:2,n2:2):1);
+000410a0: 0a20 2020 2020 2020 2020 2020 2020 2054  .              T
+000410b0: 5245 4520 7432 5e31 3020 3d20 5b26 525d  REE t2^10 = [&R]
+000410c0: 2028 6e31 3a32 2c28 6e30 3a31 2c6e 323a   (n1:2,(n0:1,n2:
+000410d0: 3129 3a31 293b 0a20 2020 2020 2020 2020  1):1);.         
+000410e0: 2020 2045 4e44 3b0a 0a20 2020 2020 2020     END;..       
+000410f0: 2049 6620 7365 7175 656e 6365 2064 6174   If sequence dat
+00041100: 6120 3a6d 6574 683a 602e 616c 6967 6e6d  a :meth:`.alignm
+00041110: 656e 7473 6020 6172 6520 6465 6669 6e65  ents` are define
+00041120: 6420 666f 7220 7468 6973 2074 7265 6520  d for this tree 
+00041130: 7365 7175 656e 6365 0a20 2020 2020 2020  sequence.       
+00041140: 2061 6e64 2074 6865 7265 2069 7320 6174   and there is at
+00041150: 206c 6561 7374 206f 6e65 2073 6974 6520   least one site 
+00041160: 7072 6573 656e 742c 2073 6571 7565 6e63  present, sequenc
+00041170: 6520 616c 6967 6e6d 656e 7420 6461 7461  e alignment data
+00041180: 2077 696c 6c20 616c 736f 0a20 2020 2020   will also.     
+00041190: 2020 2062 6520 696e 636c 7564 6564 2062     be included b
+000411a0: 7920 6465 6661 756c 7420 2874 6869 7320  y default (this 
+000411b0: 6361 6e20 6265 2073 7570 7072 6573 7365  can be suppresse
+000411c0: 6420 6279 2073 6574 7469 6e67 0a20 2020  d by setting.   
+000411d0: 2020 2020 2060 6069 6e63 6c75 6465 5f61       ``include_a
+000411e0: 6c69 676e 6d65 6e74 733d 4661 6c73 6560  lignments=False`
+000411f0: 6029 2e20 466f 7220 6578 616d 706c 652c  `). For example,
+00041200: 2074 6869 7320 7472 6565 2073 6571 7565   this tree seque
+00041210: 6e63 6520 6861 730a 2020 2020 2020 2020  nce has.        
+00041220: 6120 7365 7175 656e 6365 206c 656e 6774  a sequence lengt
+00041230: 6820 6f66 2031 302c 2074 776f 2076 6172  h of 10, two var
+00041240: 6961 626c 6520 7369 7465 7320 616e 6420  iable sites and 
+00041250: 6e6f 0a20 2020 2020 2020 203a 7265 663a  no.        :ref:
+00041260: 6072 6566 6572 656e 6365 2073 6571 7565  `reference seque
+00041270: 6e63 653c 7365 635f 6461 7461 5f6d 6f64  nce<sec_data_mod
+00041280: 656c 5f72 6566 6572 656e 6365 5f73 6571  el_reference_seq
+00041290: 7565 6e63 653e 603a 3a0a 0a20 2020 2020  uence>`::..     
+000412a0: 2020 2020 2020 2023 4e45 5855 530a 2020         #NEXUS.  
+000412b0: 2020 2020 2020 2020 2020 4245 4749 4e20            BEGIN 
+000412c0: 5441 5841 3b0a 2020 2020 2020 2020 2020  TAXA;.          
+000412d0: 2020 2020 4449 4d45 4e53 494f 4e53 204e      DIMENSIONS N
+000412e0: 5441 583d 333b 0a20 2020 2020 2020 2020  TAX=3;.         
+000412f0: 2020 2020 2054 4158 4c41 4245 4c53 206e       TAXLABELS n
+00041300: 3020 6e31 206e 323b 0a20 2020 2020 2020  0 n1 n2;.       
+00041310: 2020 2020 2045 4e44 3b0a 2020 2020 2020       END;.      
+00041320: 2020 2020 2020 4245 4749 4e20 4441 5441        BEGIN DATA
+00041330: 3b0a 2020 2020 2020 2020 2020 2020 2020  ;.              
+00041340: 4449 4d45 4e53 494f 4e53 204e 4348 4152  DIMENSIONS NCHAR
+00041350: 3d31 303b 0a20 2020 2020 2020 2020 2020  =10;.           
+00041360: 2020 2046 4f52 4d41 5420 4441 5441 5459     FORMAT DATATY
+00041370: 5045 3d44 4e41 204d 4953 5349 4e47 3d3f  PE=DNA MISSING=?
+00041380: 3b0a 2020 2020 2020 2020 2020 2020 2020  ;.              
+00041390: 4d41 5452 4958 0a20 2020 2020 2020 2020  MATRIX.         
+000413a0: 2020 2020 2020 206e 3020 3f3f 473f 3f3f         n0 ??G???
+000413b0: 3f3f 3f54 0a20 2020 2020 2020 2020 2020  ???T.           
+000413c0: 2020 2020 206e 3120 3f3f 413f 3f3f 3f3f       n1 ??A?????
+000413d0: 3f43 0a20 2020 2020 2020 2020 2020 2020  ?C.             
+000413e0: 2020 206e 3220 3f3f 413f 3f3f 3f3f 3f43     n2 ??A??????C
+000413f0: 0a20 2020 2020 2020 2020 2020 2020 203b  .              ;
+00041400: 0a20 2020 2020 2020 2020 2020 2045 4e44  .            END
+00041410: 3b0a 2020 2020 2020 2020 2020 2020 4245  ;.            BE
+00041420: 4749 4e20 5452 4545 533b 0a20 2020 2020  GIN TREES;.     
+00041430: 2020 2020 2020 2020 2054 5245 4520 7430           TREE t0
+00041440: 5e31 3020 3d20 5b26 525d 2028 6e30 3a32  ^10 = [&R] (n0:2
+00041450: 2c28 6e31 3a31 2c6e 323a 3129 3a31 293b  ,(n1:1,n2:1):1);
+00041460: 0a20 2020 2020 2020 2020 2020 2045 4e44  .            END
+00041470: 3b0a 0a20 2020 2020 2020 2050 6c65 6173  ;..        Pleas
+00041480: 6520 7365 6520 7468 6520 3a6d 6574 683a  e see the :meth:
+00041490: 602e 616c 6967 6e6d 656e 7473 6020 6d65  `.alignments` me
+000414a0: 7468 6f64 2066 6f72 2064 6574 6169 6c73  thod for details
+000414b0: 206f 6e20 686f 770a 2020 2020 2020 2020   on how.        
+000414c0: 7265 6665 7265 6e63 6520 7365 7175 656e  reference sequen
+000414d0: 6365 7320 6172 6520 6861 6e64 6c65 642e  ces are handled.
+000414e0: 0a0a 2020 2020 2020 2020 2e2e 206e 6f74  ..        .. not
+000414f0: 653a 3a20 4e6f 7465 2074 6865 2064 6566  e:: Note the def
+00041500: 6175 6c74 2060 606d 6973 7369 6e67 5f64  ault ``missing_d
+00041510: 6174 615f 6368 6172 6163 7465 7260 6020  ata_character`` 
+00041520: 666f 7220 7468 6973 206d 6574 686f 640a  for this method.
+00041530: 2020 2020 2020 2020 2020 2020 6973 2022              is "
+00041540: 3f22 2072 6174 6865 7220 7468 656e 2022  ?" rather then "
+00041550: 4e22 2c20 696e 206b 6565 7069 6e67 2077  N", in keeping w
+00041560: 6974 6820 636f 6d6d 6f6e 2063 6f6e 7665  ith common conve
+00041570: 6e74 696f 6e73 2066 6f72 0a20 2020 2020  ntions for.     
+00041580: 2020 2020 2020 206e 6578 7573 2064 6174         nexus dat
+00041590: 612e 2054 6869 7320 6361 6e20 6265 2063  a. This can be c
+000415a0: 6861 6e67 6564 2075 7369 6e67 2074 6865  hanged using the
+000415b0: 2060 606d 6973 7369 6e67 5f64 6174 615f   ``missing_data_
+000415c0: 6368 6172 6163 7465 7260 600a 2020 2020  character``.    
+000415d0: 2020 2020 2020 2020 7061 7261 6d65 7465          paramete
+000415e0: 722e 0a0a 2020 2020 2020 2020 2e2e 2077  r...        .. w
+000415f0: 6172 6e69 6e67 3a3a 203a 7265 663a 604d  arning:: :ref:`M
+00041600: 6973 7369 6e67 2064 6174 613c 7365 635f  issing data<sec_
+00041610: 6461 7461 5f6d 6f64 656c 5f6d 6973 7369  data_model_missi
+00041620: 6e67 5f64 6174 613e 600a 2020 2020 2020  ng_data>`.      
+00041630: 2020 2020 2020 6973 206e 6f74 2073 7570        is not sup
+00041640: 706f 7274 6564 2066 6f72 2065 6e63 6f64  ported for encod
+00041650: 696e 6720 7472 6565 2074 6f70 6f6c 6f67  ing tree topolog
+00041660: 7920 696e 666f 726d 6174 696f 6e0a 2020  y information.  
+00041670: 2020 2020 2020 2020 2020 6173 206f 7572            as our
+00041680: 2063 6f6e 7665 6e74 696f 6e20 6f66 2075   convention of u
+00041690: 7369 6e67 2074 7265 6573 2077 6974 6820  sing trees with 
+000416a0: 6d75 6c74 6970 6c65 2072 6f6f 7473 0a20  multiple roots. 
+000416b0: 2020 2020 2020 2020 2020 2069 7320 6e6f             is no
+000416c0: 7420 6f66 7465 6e20 7375 7070 6f72 7465  t often supporte
+000416d0: 6420 6279 206e 6577 6963 6b20 7061 7273  d by newick pars
+000416e0: 6572 732e 2054 6875 732c 2074 6865 206d  ers. Thus, the m
+000416f0: 6574 686f 640a 2020 2020 2020 2020 2020  ethod.          
+00041700: 2020 7769 6c6c 2072 6169 7365 2061 2056    will raise a V
+00041710: 616c 7565 4572 726f 7220 6966 2077 6520  alueError if we 
+00041720: 7472 7920 746f 206f 7574 7075 7420 7472  try to output tr
+00041730: 6565 7320 7769 7468 0a20 2020 2020 2020  ees with.       
+00041740: 2020 2020 206d 756c 7469 706c 6520 726f       multiple ro
+00041750: 6f74 732e 2041 6464 6974 696f 6e61 6c6c  ots. Additionall
+00041760: 792c 206d 6973 7369 6e67 2064 6174 610a  y, missing data.
+00041770: 2020 2020 2020 2020 2020 2020 6973 206e              is n
+00041780: 6f74 2063 7572 7265 6e74 6c79 2073 7570  ot currently sup
+00041790: 706f 7274 6564 2066 6f72 2061 6c69 676e  ported for align
+000417a0: 6d65 6e74 2064 6174 612e 0a20 2020 2020  ment data..     
+000417b0: 2020 2020 2020 2053 6565 2068 7474 7073         See https
+000417c0: 3a2f 2f67 6974 6875 622e 636f 6d2f 7473  ://github.com/ts
+000417d0: 6b69 742d 6465 762f 7473 6b69 742f 6973  kit-dev/tskit/is
+000417e0: 7375 6573 2f31 3839 3620 666f 7220 6d6f  sues/1896 for mo
+000417f0: 7265 0a20 2020 2020 2020 2020 2020 2069  re.            i
+00041800: 6e66 6f72 6d61 7469 6f6e 2e0a 0a20 2020  nformation...   
+00041810: 2020 2020 202e 2e20 7365 6561 6c73 6f3a       .. seealso:
+00041820: 2053 6565 2061 6c73 6f20 7468 6520 3a6d   See also the :m
+00041830: 6574 683a 602e 6173 5f6e 6578 7573 6020  eth:`.as_nexus` 
+00041840: 6d65 7468 6f64 2077 6869 6368 2077 696c  method which wil
+00041850: 6c0a 2020 2020 2020 2020 2020 2020 7265  l.            re
+00041860: 7475 726e 2074 6869 7320 6e65 7875 7320  turn this nexus 
+00041870: 7265 7072 6573 656e 7461 7469 6f6e 2061  representation a
+00041880: 7320 6120 7374 7269 6e67 2e0a 0a20 2020  s a string...   
+00041890: 2020 2020 203a 7061 7261 6d20 696e 7420       :param int 
+000418a0: 7072 6563 6973 696f 6e3a 2054 6865 206e  precision: The n
+000418b0: 756d 6572 6963 616c 2070 7265 6369 7369  umerical precisi
+000418c0: 6f6e 2077 6974 6820 7768 6963 6820 6272  on with which br
+000418d0: 616e 6368 206c 656e 6774 6873 0a20 2020  anch lengths.   
+000418e0: 2020 2020 2020 2020 2061 6e64 2074 7265           and tre
+000418f0: 6520 706f 7369 7469 6f6e 7320 6172 6520  e positions are 
+00041900: 7072 696e 7465 642e 0a20 2020 2020 2020  printed..       
+00041910: 203a 7061 7261 6d20 626f 6f6c 2069 6e63   :param bool inc
+00041920: 6c75 6465 5f74 7265 6573 3a20 5472 7565  lude_trees: True
+00041930: 2069 6620 7468 6520 7472 6565 2074 6f70   if the tree top
+00041940: 6f6c 6f67 7920 696e 666f 726d 6174 696f  ology informatio
+00041950: 6e20 7368 6f75 6c64 0a20 2020 2020 2020  n should.       
+00041960: 2020 2020 2062 6520 696e 636c 7564 6564       be included
+00041970: 3b20 4661 6c73 6520 6f74 6865 7277 6973  ; False otherwis
+00041980: 6520 2864 6566 6175 6c74 3d54 7275 6529  e (default=True)
+00041990: 2e0a 2020 2020 2020 2020 3a70 6172 616d  ..        :param
+000419a0: 2062 6f6f 6c20 696e 636c 7564 655f 616c   bool include_al
+000419b0: 6967 6e6d 656e 7473 3a20 5472 7565 2069  ignments: True i
+000419c0: 6620 7468 6520 7365 7175 656e 6365 2064  f the sequence d
+000419d0: 6174 6120 616c 6967 6e6d 656e 7420 696e  ata alignment in
+000419e0: 666f 726d 6174 696f 6e0a 2020 2020 2020  formation.      
+000419f0: 2020 2020 2020 7368 6f75 6c64 2062 6520        should be 
+00041a00: 696e 636c 7564 6564 3b20 4661 6c73 6520  included; False 
+00041a10: 6f74 6865 7277 6973 6520 2864 6566 6175  otherwise (defau
+00041a20: 6c74 3d54 7275 6520 6966 2073 6571 7565  lt=True if seque
+00041a30: 6e63 6520 616c 6967 6e6d 656e 7473 0a20  nce alignments. 
+00041a40: 2020 2020 2020 2020 2020 2061 7265 2077             are w
+00041a50: 656c 6c2d 6465 6669 6e65 6420 616e 6420  ell-defined and 
+00041a60: 7468 6520 7472 6565 2073 6571 7565 6e63  the tree sequenc
+00041a70: 6520 636f 6e74 6169 6e73 2061 7420 6c65  e contains at le
+00041a80: 6173 7420 6f6e 6520 7369 7465 292e 0a20  ast one site).. 
+00041a90: 2020 2020 2020 203a 7061 7261 6d20 7374         :param st
+00041aa0: 7220 7265 6665 7265 6e63 655f 7365 7175  r reference_sequ
+00041ab0: 656e 6365 3a20 4173 2066 6f72 2074 6865  ence: As for the
+00041ac0: 203a 6d65 7468 3a60 2e61 6c69 676e 6d65   :meth:`.alignme
+00041ad0: 6e74 7360 206d 6574 686f 642e 0a20 2020  nts` method..   
+00041ae0: 2020 2020 203a 7061 7261 6d20 7374 7220       :param str 
+00041af0: 6d69 7373 696e 675f 6461 7461 5f63 6861  missing_data_cha
+00041b00: 7261 6374 6572 3a20 4173 2066 6f72 2074  racter: As for t
+00041b10: 6865 203a 6d65 7468 3a60 2e61 6c69 676e  he :meth:`.align
+00041b20: 6d65 6e74 7360 206d 6574 686f 642c 0a20  ments` method,. 
+00041b30: 2020 2020 2020 2020 2020 2062 7574 2064             but d
+00041b40: 6566 6175 6c74 7320 746f 2022 3f22 2e0a  efaults to "?"..
+00041b50: 2020 2020 2020 2020 3a72 6574 7572 6e3a          :return:
+00041b60: 2041 206e 6578 7573 2072 6570 7265 7365   A nexus represe
+00041b70: 6e74 6174 696f 6e20 6f66 2074 6869 7320  ntation of this 
+00041b80: 3a63 6c61 7373 3a60 5472 6565 5365 7175  :class:`TreeSequ
+00041b90: 656e 6365 600a 2020 2020 2020 2020 3a72  ence`.        :r
+00041ba0: 7479 7065 3a20 7374 720a 2020 2020 2020  type: str.      
+00041bb0: 2020 2222 220a 2020 2020 2020 2020 7465    """.        te
+00041bc0: 7874 5f66 6f72 6d61 7473 2e77 7269 7465  xt_formats.write
+00041bd0: 5f6e 6578 7573 280a 2020 2020 2020 2020  _nexus(.        
+00041be0: 2020 2020 7365 6c66 2c0a 2020 2020 2020      self,.      
+00041bf0: 2020 2020 2020 6669 6c65 5f6f 725f 7061        file_or_pa
+00041c00: 7468 2c0a 2020 2020 2020 2020 2020 2020  th,.            
+00041c10: 7072 6563 6973 696f 6e3d 7072 6563 6973  precision=precis
+00041c20: 696f 6e2c 0a20 2020 2020 2020 2020 2020  ion,.           
+00041c30: 2069 6e63 6c75 6465 5f74 7265 6573 3d69   include_trees=i
+00041c40: 6e63 6c75 6465 5f74 7265 6573 2c0a 2020  nclude_trees,.  
+00041c50: 2020 2020 2020 2020 2020 696e 636c 7564            includ
+00041c60: 655f 616c 6967 6e6d 656e 7473 3d69 6e63  e_alignments=inc
+00041c70: 6c75 6465 5f61 6c69 676e 6d65 6e74 732c  lude_alignments,
+00041c80: 0a20 2020 2020 2020 2020 2020 2072 6566  .            ref
+00041c90: 6572 656e 6365 5f73 6571 7565 6e63 653d  erence_sequence=
+00041ca0: 7265 6665 7265 6e63 655f 7365 7175 656e  reference_sequen
+00041cb0: 6365 2c0a 2020 2020 2020 2020 2020 2020  ce,.            
+00041cc0: 6d69 7373 696e 675f 6461 7461 5f63 6861  missing_data_cha
+00041cd0: 7261 6374 6572 3d6d 6973 7369 6e67 5f64  racter=missing_d
+00041ce0: 6174 615f 6368 6172 6163 7465 722c 0a20  ata_character,. 
+00041cf0: 2020 2020 2020 2029 0a0a 2020 2020 6465         )..    de
+00041d00: 6620 6173 5f6e 6578 7573 2873 656c 662c  f as_nexus(self,
+00041d10: 202a 2a6b 7761 7267 7329 3a0a 2020 2020   **kwargs):.    
+00041d20: 2020 2020 2222 220a 2020 2020 2020 2020      """.        
+00041d30: 5265 7475 726e 2074 6865 2072 6573 756c  Return the resul
+00041d40: 7420 6f66 203a 6d65 7468 3a60 2e77 7269  t of :meth:`.wri
+00041d50: 7465 5f6e 6578 7573 6020 6173 2061 2073  te_nexus` as a s
+00041d60: 7472 696e 672e 0a20 2020 2020 2020 204b  tring..        K
+00041d70: 6579 776f 7264 2070 6172 616d 6574 6572  eyword parameter
+00041d80: 7320 6172 6520 6173 2064 6566 696e 6564  s are as defined
+00041d90: 2069 6e20 3a6d 6574 683a 602e 7772 6974   in :meth:`.writ
+00041da0: 655f 6e65 7875 7360 2e0a 0a20 2020 2020  e_nexus`...     
+00041db0: 2020 203a 7265 7475 726e 3a20 4120 6e65     :return: A ne
+00041dc0: 7875 7320 656e 636f 6469 6e67 206f 6620  xus encoding of 
+00041dd0: 7468 6520 616c 6967 6e6d 656e 7473 2069  the alignments i
+00041de0: 6e20 7468 6973 2074 7265 6520 7365 7175  n this tree sequ
+00041df0: 656e 6365 2061 7320 6120 7374 7269 6e67  ence as a string
+00041e00: 2e0a 2020 2020 2020 2020 3a72 7479 7065  ..        :rtype
+00041e10: 3a20 7374 720a 2020 2020 2020 2020 2222  : str.        ""
+00041e20: 220a 2020 2020 2020 2020 6275 6666 203d  ".        buff =
+00041e30: 2069 6f2e 5374 7269 6e67 494f 2829 0a20   io.StringIO(). 
+00041e40: 2020 2020 2020 2073 656c 662e 7772 6974         self.writ
+00041e50: 655f 6e65 7875 7328 6275 6666 2c20 2a2a  e_nexus(buff, **
+00041e60: 6b77 6172 6773 290a 2020 2020 2020 2020  kwargs).        
+00041e70: 7265 7475 726e 2062 7566 662e 6765 7476  return buff.getv
+00041e80: 616c 7565 2829 0a0a 2020 2020 2320 544f  alue()..    # TO
+00041e90: 444f 0a20 2020 2023 2028 3129 204d 6f76  DO.    # (1) Mov
+00041ea0: 6520 7468 6520 6465 6669 6e69 7469 6f6e  e the definition
+00041eb0: 2074 6f20 7465 7874 5f66 6f72 6d61 7473   to text_formats
+00041ec0: 2e70 790a 2020 2020 2320 2832 2920 5265  .py.    # (2) Re
+00041ed0: 6e61 6d65 2074 6f20 6173 5f6d 6163 7320  name to as_macs 
+00041ee0: 616e 6420 6b65 6570 2074 6f5f 6d61 6373  and keep to_macs
+00041ef0: 2061 7320 6120 6465 7072 6563 6174 6564   as a deprecated
+00041f00: 2073 796e 6f6e 796d 0a20 2020 2064 6566   synonym.    def
+00041f10: 2074 6f5f 6d61 6373 2873 656c 6629 3a0a   to_macs(self):.
+00041f20: 2020 2020 2020 2020 2222 220a 2020 2020          """.    
+00041f30: 2020 2020 5265 7475 726e 2061 2060 6d61      Return a `ma
+00041f40: 6373 2065 6e63 6f64 696e 6720 3c68 7474  cs encoding <htt
+00041f50: 7073 3a2f 2f67 6974 6875 622e 636f 6d2f  ps://github.com/
+00041f60: 6763 6865 6e39 382f 6d61 6373 3e60 5f0a  gchen98/macs>`_.
+00041f70: 2020 2020 2020 2020 6f66 2074 6869 7320          of this 
+00041f80: 7472 6565 2073 6571 7565 6e63 652e 0a0a  tree sequence...
+00041f90: 2020 2020 2020 2020 3a72 6574 7572 6e3a          :return:
+00041fa0: 2054 6865 206d 6163 7320 7265 7072 6573   The macs repres
+00041fb0: 656e 7461 7469 6f6e 206f 6620 7468 6973  entation of this
+00041fc0: 2054 7265 6553 6571 7565 6e63 6520 6173   TreeSequence as
+00041fd0: 2061 2073 7472 696e 672e 0a20 2020 2020   a string..     
+00041fe0: 2020 203a 7274 7970 653a 2073 7472 0a20     :rtype: str. 
+00041ff0: 2020 2020 2020 2022 2222 0a20 2020 2020         """.     
+00042000: 2020 206e 203d 2073 656c 662e 6765 745f     n = self.get_
+00042010: 7361 6d70 6c65 5f73 697a 6528 290a 2020  sample_size().  
+00042020: 2020 2020 2020 6d20 3d20 7365 6c66 2e67        m = self.g
+00042030: 6574 5f73 6571 7565 6e63 655f 6c65 6e67  et_sequence_leng
+00042040: 7468 2829 0a20 2020 2020 2020 206f 7574  th().        out
+00042050: 7075 7420 3d20 5b66 2243 4f4d 4d41 4e44  put = [f"COMMAND
+00042060: 3a5c 746e 6f74 5f6d 6163 7320 7b6e 7d20  :\tnot_macs {n} 
+00042070: 7b6d 7d22 5d0a 2020 2020 2020 2020 6f75  {m}"].        ou
+00042080: 7470 7574 2e61 7070 656e 6428 2253 4545  tput.append("SEE
+00042090: 443a 5c74 4153 4545 4422 290a 2020 2020  D:\tASEED").    
+000420a0: 2020 2020 666f 7220 7661 7269 616e 7420      for variant 
+000420b0: 696e 2073 656c 662e 7661 7269 616e 7473  in self.variants
+000420c0: 2863 6f70 793d 4661 6c73 6529 3a0a 2020  (copy=False):.  
+000420d0: 2020 2020 2020 2020 2020 6966 2061 6e79            if any
+000420e0: 286c 656e 2861 6c6c 656c 6529 203e 2031  (len(allele) > 1
+000420f0: 2066 6f72 2061 6c6c 656c 6520 696e 2076   for allele in v
+00042100: 6172 6961 6e74 2e61 6c6c 656c 6573 293a  ariant.alleles):
+00042110: 0a20 2020 2020 2020 2020 2020 2020 2020  .               
+00042120: 2072 6169 7365 2056 616c 7565 4572 726f   raise ValueErro
+00042130: 7228 226d 6163 7320 6f75 7470 7574 206f  r("macs output o
+00042140: 6e6c 7920 7375 7070 6f72 7473 2073 696e  nly supports sin
+00042150: 676c 6520 6c65 7474 6572 2061 6c6c 656c  gle letter allel
+00042160: 6573 2229 0a20 2020 2020 2020 2020 2020  es").           
+00042170: 2062 7974 6573 5f67 656e 6f74 7970 6573   bytes_genotypes
+00042180: 203d 206e 702e 656d 7074 7928 7365 6c66   = np.empty(self
+00042190: 2e6e 756d 5f73 616d 706c 6573 2c20 6474  .num_samples, dt
+000421a0: 7970 653d 6e70 2e75 696e 7438 290a 2020  ype=np.uint8).  
+000421b0: 2020 2020 2020 2020 2020 6c6f 6f6b 7570            lookup
+000421c0: 203d 206e 702e 6172 7261 7928 5b6f 7264   = np.array([ord
+000421d0: 2861 5b30 5d29 2066 6f72 2061 2069 6e20  (a[0]) for a in 
+000421e0: 7661 7269 616e 742e 616c 6c65 6c65 735d  variant.alleles]
+000421f0: 2c20 6474 7970 653d 6e70 2e75 696e 7438  , dtype=np.uint8
+00042200: 290a 2020 2020 2020 2020 2020 2020 6279  ).            by
+00042210: 7465 735f 6765 6e6f 7479 7065 735b 3a5d  tes_genotypes[:]
+00042220: 203d 206c 6f6f 6b75 705b 7661 7269 616e   = lookup[varian
+00042230: 742e 6765 6e6f 7479 7065 735d 0a20 2020  t.genotypes].   
+00042240: 2020 2020 2020 2020 2067 656e 6f74 7970           genotyp
+00042250: 6573 203d 2062 7974 6573 5f67 656e 6f74  es = bytes_genot
+00042260: 7970 6573 2e74 6f62 7974 6573 2829 2e64  ypes.tobytes().d
+00042270: 6563 6f64 6528 290a 2020 2020 2020 2020  ecode().        
+00042280: 2020 2020 6f75 7470 7574 2e61 7070 656e      output.appen
+00042290: 6428 0a20 2020 2020 2020 2020 2020 2020  d(.             
+000422a0: 2020 2066 2253 4954 453a 5c74 7b76 6172     f"SITE:\t{var
+000422b0: 6961 6e74 2e69 6e64 6578 7d5c 747b 7661  iant.index}\t{va
+000422c0: 7269 616e 742e 706f 7369 7469 6f6e 202f  riant.position /
+000422d0: 206d 7d5c 7430 2e30 5c74 2220 6622 7b67   m}\t0.0\t" f"{g
+000422e0: 656e 6f74 7970 6573 7d22 0a20 2020 2020  enotypes}".     
+000422f0: 2020 2020 2020 2029 0a20 2020 2020 2020         ).       
+00042300: 2072 6574 7572 6e20 225c 6e22 2e6a 6f69   return "\n".joi
+00042310: 6e28 6f75 7470 7574 2920 2b20 225c 6e22  n(output) + "\n"
+00042320: 0a0a 2020 2020 6465 6620 7369 6d70 6c69  ..    def simpli
+00042330: 6679 280a 2020 2020 2020 2020 7365 6c66  fy(.        self
+00042340: 2c0a 2020 2020 2020 2020 7361 6d70 6c65  ,.        sample
+00042350: 733d 4e6f 6e65 2c0a 2020 2020 2020 2020  s=None,.        
+00042360: 2a2c 0a20 2020 2020 2020 206d 6170 5f6e  *,.        map_n
+00042370: 6f64 6573 3d46 616c 7365 2c0a 2020 2020  odes=False,.    
+00042380: 2020 2020 7265 6475 6365 5f74 6f5f 7369      reduce_to_si
+00042390: 7465 5f74 6f70 6f6c 6f67 793d 4661 6c73  te_topology=Fals
+000423a0: 652c 0a20 2020 2020 2020 2066 696c 7465  e,.        filte
+000423b0: 725f 706f 7075 6c61 7469 6f6e 733d 4e6f  r_populations=No
+000423c0: 6e65 2c0a 2020 2020 2020 2020 6669 6c74  ne,.        filt
+000423d0: 6572 5f69 6e64 6976 6964 7561 6c73 3d4e  er_individuals=N
+000423e0: 6f6e 652c 0a20 2020 2020 2020 2066 696c  one,.        fil
+000423f0: 7465 725f 7369 7465 733d 4e6f 6e65 2c0a  ter_sites=None,.
+00042400: 2020 2020 2020 2020 6669 6c74 6572 5f6e          filter_n
+00042410: 6f64 6573 3d4e 6f6e 652c 0a20 2020 2020  odes=None,.     
+00042420: 2020 2075 7064 6174 655f 7361 6d70 6c65     update_sample
+00042430: 5f66 6c61 6773 3d4e 6f6e 652c 0a20 2020  _flags=None,.   
+00042440: 2020 2020 206b 6565 705f 756e 6172 793d       keep_unary=
+00042450: 4661 6c73 652c 0a20 2020 2020 2020 206b  False,.        k
+00042460: 6565 705f 756e 6172 795f 696e 5f69 6e64  eep_unary_in_ind
+00042470: 6976 6964 7561 6c73 3d4e 6f6e 652c 0a20  ividuals=None,. 
+00042480: 2020 2020 2020 206b 6565 705f 696e 7075         keep_inpu
+00042490: 745f 726f 6f74 733d 4661 6c73 652c 0a20  t_roots=False,. 
+000424a0: 2020 2020 2020 2072 6563 6f72 645f 7072         record_pr
+000424b0: 6f76 656e 616e 6365 3d54 7275 652c 0a20  ovenance=True,. 
+000424c0: 2020 2020 2020 2066 696c 7465 725f 7a65         filter_ze
+000424d0: 726f 5f6d 7574 6174 696f 6e5f 7369 7465  ro_mutation_site
+000424e0: 733d 4e6f 6e65 2c20 2023 2044 6570 7265  s=None,  # Depre
+000424f0: 6361 7465 6420 616c 6961 7320 666f 7220  cated alias for 
+00042500: 6669 6c74 6572 5f73 6974 6573 0a20 2020  filter_sites.   
+00042510: 2029 3a0a 2020 2020 2020 2020 2222 220a   ):.        """.
+00042520: 2020 2020 2020 2020 5265 7475 726e 7320          Returns 
+00042530: 6120 7369 6d70 6c69 6669 6564 2074 7265  a simplified tre
+00042540: 6520 7365 7175 656e 6365 2074 6861 7420  e sequence that 
+00042550: 7265 7461 696e 7320 6f6e 6c79 2074 6865  retains only the
+00042560: 2068 6973 746f 7279 206f 660a 2020 2020   history of.    
+00042570: 2020 2020 7468 6520 6e6f 6465 7320 6769      the nodes gi
+00042580: 7665 6e20 696e 2074 6865 206c 6973 7420  ven in the list 
+00042590: 6060 7361 6d70 6c65 7360 602e 2049 6620  ``samples``. If 
+000425a0: 6060 6d61 705f 6e6f 6465 7360 6020 6973  ``map_nodes`` is
+000425b0: 2074 7275 652c 0a20 2020 2020 2020 2061   true,.        a
+000425c0: 6c73 6f20 7265 7475 726e 2061 206e 756d  lso return a num
+000425d0: 7079 2061 7272 6179 2077 686f 7365 2060  py array whose `
+000425e0: 6075 6060 2d74 6820 656c 656d 656e 7420  `u``-th element 
+000425f0: 6973 2074 6865 2049 4420 6f66 2074 6865  is the ID of the
+00042600: 206e 6f64 650a 2020 2020 2020 2020 696e   node.        in
+00042610: 2074 6865 2073 696d 706c 6966 6965 6420   the simplified 
+00042620: 7472 6565 2073 6571 7565 6e63 6520 7468  tree sequence th
+00042630: 6174 2063 6f72 7265 7370 6f6e 6473 2074  at corresponds t
+00042640: 6f20 6e6f 6465 2060 6075 6060 2069 6e20  o node ``u`` in 
+00042650: 7468 650a 2020 2020 2020 2020 6f72 6967  the.        orig
+00042660: 696e 616c 2074 7265 6520 7365 7175 656e  inal tree sequen
+00042670: 6365 2c20 6f72 203a 6461 7461 3a60 7473  ce, or :data:`ts
+00042680: 6b69 742e 4e55 4c4c 6020 282d 3129 2069  kit.NULL` (-1) i
+00042690: 6620 6060 7560 6020 6973 206e 6f20 6c6f  f ``u`` is no lo
+000426a0: 6e67 6572 0a20 2020 2020 2020 2070 7265  nger.        pre
+000426b0: 7365 6e74 2069 6e20 7468 6520 7369 6d70  sent in the simp
+000426c0: 6c69 6669 6564 2074 7265 6520 7365 7175  lified tree sequ
+000426d0: 656e 6365 2e0a 0a20 2020 2020 2020 202e  ence...        .
+000426e0: 2e20 6e6f 7465 3a3a 0a20 2020 2020 2020  . note::.       
+000426f0: 2020 2020 2049 6620 796f 7520 7769 7368       If you wish
+00042700: 2074 6f20 7369 6d70 6c69 6679 2061 2073   to simplify a s
+00042710: 6574 206f 6620 7461 626c 6573 2074 6861  et of tables tha
+00042720: 7420 646f 206e 6f74 2073 6174 6973 6679  t do not satisfy
+00042730: 2061 6c6c 0a20 2020 2020 2020 2020 2020   all.           
+00042740: 2072 6571 7569 7265 6d65 6e74 7320 666f   requirements fo
+00042750: 7220 6275 696c 6469 6e67 2061 2054 7265  r building a Tre
+00042760: 6553 6571 7565 6e63 652c 2074 6865 6e20  eSequence, then 
+00042770: 7573 650a 2020 2020 2020 2020 2020 2020  use.            
+00042780: 3a6d 6574 683a 6054 6162 6c65 436f 6c6c  :meth:`TableColl
+00042790: 6563 7469 6f6e 2e73 696d 706c 6966 7960  ection.simplify`
+000427a0: 2e0a 0a20 2020 2020 2020 2049 6620 7468  ...        If th
+000427b0: 6520 6060 7265 6475 6365 5f74 6f5f 7369  e ``reduce_to_si
+000427c0: 7465 5f74 6f70 6f6c 6f67 7960 6020 7061  te_topology`` pa
+000427d0: 7261 6d65 7465 7220 6973 2054 7275 652c  rameter is True,
+000427e0: 2074 6865 2072 6574 7572 6e65 6420 7472   the returned tr
+000427f0: 6565 0a20 2020 2020 2020 2073 6571 7565  ee.        seque
+00042800: 6e63 6520 7769 6c6c 2063 6f6e 7461 696e  nce will contain
+00042810: 206f 6e6c 7920 746f 706f 6c6f 6769 6361   only topologica
+00042820: 6c20 696e 666f 726d 6174 696f 6e20 7468  l information th
+00042830: 6174 2069 7320 6e65 6365 7373 6172 7920  at is necessary 
+00042840: 746f 0a20 2020 2020 2020 2072 6570 7265  to.        repre
+00042850: 7365 6e74 2074 6865 2074 7265 6573 2074  sent the trees t
+00042860: 6861 7420 636f 6e74 6169 6e20 7369 7465  hat contain site
+00042870: 732e 2049 6620 7468 6572 6520 6172 6520  s. If there are 
+00042880: 7a65 726f 2073 6974 6573 2069 6e20 7468  zero sites in th
+00042890: 6973 0a20 2020 2020 2020 2074 7265 6520  is.        tree 
+000428a0: 7365 7175 656e 6365 2c20 7468 6973 2077  sequence, this w
+000428b0: 696c 6c20 7265 7375 6c74 2069 6e20 616e  ill result in an
+000428c0: 206f 7574 7075 7420 7472 6565 2073 6571   output tree seq
+000428d0: 7565 6e63 6520 7769 7468 207a 6572 6f20  uence with zero 
+000428e0: 6564 6765 732e 0a20 2020 2020 2020 2057  edges..        W
+000428f0: 6865 6e20 7468 6520 6e75 6d62 6572 206f  hen the number o
+00042900: 6620 7369 7465 7320 6973 2067 7265 6174  f sites is great
+00042910: 6572 2074 6861 6e20 7a65 726f 2c20 6576  er than zero, ev
+00042920: 6572 7920 7472 6565 2069 6e20 7468 6520  ery tree in the 
+00042930: 6f75 7470 7574 0a20 2020 2020 2020 2074  output.        t
+00042940: 7265 6520 7365 7175 656e 6365 2077 696c  ree sequence wil
+00042950: 6c20 636f 6e74 6169 6e20 6174 206c 6561  l contain at lea
+00042960: 7374 206f 6e65 2073 6974 652e 2046 6f72  st one site. For
+00042970: 2061 2067 6976 656e 2073 6974 652c 2074   a given site, t
+00042980: 6865 0a20 2020 2020 2020 2074 6f70 6f6c  he.        topol
+00042990: 6f67 7920 6f66 2074 6865 2074 7265 6520  ogy of the tree 
+000429a0: 636f 6e74 6169 6e69 6e67 2074 6861 7420  containing that 
+000429b0: 7369 7465 2077 696c 6c20 6265 2069 6465  site will be ide
+000429c0: 6e74 6963 616c 0a20 2020 2020 2020 2028  ntical.        (
+000429d0: 7570 2074 6f20 6e6f 6465 2049 4420 7265  up to node ID re
+000429e0: 6d61 7070 696e 6729 2074 6f20 7468 6520  mapping) to the 
+000429f0: 746f 706f 6c6f 6779 206f 6620 7468 6520  topology of the 
+00042a00: 636f 7272 6573 706f 6e64 696e 6720 7472  corresponding tr
+00042a10: 6565 0a20 2020 2020 2020 2069 6e20 7468  ee.        in th
+00042a20: 6520 696e 7075 7420 7472 6565 2073 6571  e input tree seq
+00042a30: 7565 6e63 652e 0a0a 2020 2020 2020 2020  uence...        
+00042a40: 4966 2060 6066 696c 7465 725f 706f 7075  If ``filter_popu
+00042a50: 6c61 7469 6f6e 7360 602c 2060 6066 696c  lations``, ``fil
+00042a60: 7465 725f 696e 6469 7669 6475 616c 7360  ter_individuals`
+00042a70: 602c 2060 6066 696c 7465 725f 7369 7465  `, ``filter_site
+00042a80: 7360 602c 206f 720a 2020 2020 2020 2020  s``, or.        
+00042a90: 6060 6669 6c74 6572 5f6e 6f64 6573 6060  ``filter_nodes``
+00042aa0: 2069 7320 5472 7565 2c20 616e 7920 6f66   is True, any of
+00042ab0: 2074 6865 2063 6f72 7265 7370 6f6e 6469   the correspondi
+00042ac0: 6e67 206f 626a 6563 7473 2074 6861 7420  ng objects that 
+00042ad0: 6172 6520 6e6f 740a 2020 2020 2020 2020  are not.        
+00042ae0: 7265 6665 7265 6e63 6564 2065 6c73 6577  referenced elsew
+00042af0: 6865 7265 2061 7265 2066 696c 7465 7265  here are filtere
+00042b00: 6420 6f75 742e 2041 7320 7468 6973 2069  d out. As this i
+00042b10: 7320 7468 6520 6465 6661 756c 7420 6265  s the default be
+00042b20: 6861 7669 6f75 722c 0a20 2020 2020 2020  haviour,.       
+00042b30: 2069 7420 6973 2069 6d70 6f72 7461 6e74   it is important
+00042b40: 2074 6f20 7265 616c 6973 6520 4944 7320   to realise IDs 
+00042b50: 666f 7220 7468 6573 6520 6f62 6a65 6374  for these object
+00042b60: 7320 6d61 7920 6368 616e 6765 2074 6872  s may change thr
+00042b70: 6f75 6768 0a20 2020 2020 2020 2073 696d  ough.        sim
+00042b80: 706c 6966 6963 6174 696f 6e2e 2042 7920  plification. By 
+00042b90: 7365 7474 696e 6720 7468 6573 6520 7061  setting these pa
+00042ba0: 7261 6d65 7465 7273 2074 6f20 4661 6c73  rameters to Fals
+00042bb0: 652c 2068 6f77 6576 6572 2c20 7468 650a  e, however, the.
+00042bc0: 2020 2020 2020 2020 636f 7272 6573 706f          correspo
+00042bd0: 6e64 696e 6720 7461 626c 6573 2063 616e  nding tables can
+00042be0: 2062 6520 7072 6573 6572 7665 6420 7769   be preserved wi
+00042bf0: 7468 6f75 7420 6368 616e 6765 732e 0a0a  thout changes...
+00042c00: 2020 2020 2020 2020 4966 2060 6066 696c          If ``fil
+00042c10: 7465 725f 6e6f 6465 7360 6020 6973 2046  ter_nodes`` is F
+00042c20: 616c 7365 2c20 7468 656e 2074 6865 206f  alse, then the o
+00042c30: 7574 7075 7420 6e6f 6465 2074 6162 6c65  utput node table
+00042c40: 2077 696c 6c20 6265 0a20 2020 2020 2020   will be.       
+00042c50: 2075 6e63 6861 6e67 6564 2065 7863 6570   unchanged excep
+00042c60: 7420 666f 7220 7570 6461 7469 6e67 2074  t for updating t
+00042c70: 6865 2073 616d 706c 6520 7374 6174 7573  he sample status
+00042c80: 206f 6620 6e6f 6465 7320 616e 6420 616e   of nodes and an
+00042c90: 7920 4944 0a20 2020 2020 2020 2072 656d  y ID.        rem
+00042ca0: 6170 7069 6e67 7320 6361 7573 6564 2062  appings caused b
+00042cb0: 7920 6669 6c74 6572 696e 6720 696e 6469  y filtering indi
+00042cc0: 7669 6475 616c 7320 616e 6420 706f 7075  viduals and popu
+00042cd0: 6c61 7469 6f6e 7320 2869 6620 7468 650a  lations (if the.
+00042ce0: 2020 2020 2020 2020 6060 6669 6c74 6572          ``filter
+00042cf0: 5f69 6e64 6976 6964 7561 6c73 6060 2061  _individuals`` a
+00042d00: 6e64 2060 6066 696c 7465 725f 706f 7075  nd ``filter_popu
+00042d10: 6c61 7469 6f6e 7360 6020 6f70 7469 6f6e  lations`` option
+00042d20: 7320 6172 6520 656e 6162 6c65 6429 2e0a  s are enabled)..
+00042d30: 2020 2020 2020 2020 4e6f 6465 7320 7468          Nodes th
+00042d40: 6174 2061 7265 2069 6e20 7468 6520 7370  at are in the sp
+00042d50: 6563 6966 6965 6420 6c69 7374 206f 6620  ecified list of 
+00042d60: 6060 7361 6d70 6c65 7360 6020 7769 6c6c  ``samples`` will
+00042d70: 2062 6520 6d61 726b 6564 2061 730a 2020   be marked as.  
+00042d80: 2020 2020 2020 7361 6d70 6c65 7320 696e        samples in
+00042d90: 2074 6865 206f 7574 7075 742c 2061 6e64   the output, and
+00042da0: 206e 6f64 6573 2074 6861 7420 6172 6520   nodes that are 
+00042db0: 6375 7272 656e 746c 7920 6d61 726b 6564  currently marked
+00042dc0: 2061 7320 7361 6d70 6c65 730a 2020 2020   as samples.    
+00042dd0: 2020 2020 696e 2074 6865 206e 6f64 6520      in the node 
+00042de0: 7461 626c 6520 6275 7420 6e6f 7420 696e  table but not in
+00042df0: 2074 6865 2073 7065 6369 6669 6564 206c   the specified l
+00042e00: 6973 7420 6f66 2060 6073 616d 706c 6573  ist of ``samples
+00042e10: 6060 2077 696c 6c0a 2020 2020 2020 2020  `` will.        
+00042e20: 6861 7665 2074 6865 6972 203a 6461 7461  have their :data
+00042e30: 3a60 7473 6b69 742e 4e4f 4445 5f49 535f  :`tskit.NODE_IS_
+00042e40: 5341 4d50 4c45 6020 666c 6167 2063 6c65  SAMPLE` flag cle
+00042e50: 6172 6564 2e20 4e6f 7465 2061 6c73 6f20  ared. Note also 
+00042e60: 7468 6174 0a20 2020 2020 2020 2074 6865  that.        the
+00042e70: 206f 7264 6572 206f 6620 7468 6520 6060   order of the ``
+00042e80: 7361 6d70 6c65 7360 6020 6c69 7374 2069  samples`` list i
+00042e90: 7320 6e6f 7420 6d65 616e 696e 6766 756c  s not meaningful
+00042ea0: 2077 6865 6e0a 2020 2020 2020 2020 6060   when.        ``
+00042eb0: 6669 6c74 6572 5f6e 6f64 6573 6060 2069  filter_nodes`` i
+00042ec0: 7320 4661 6c73 652e 2049 6e20 7468 6973  s False. In this
+00042ed0: 2063 6173 652c 2074 6865 2072 6574 7572   case, the retur
+00042ee0: 6e65 6420 6e6f 6465 206d 6170 7069 6e67  ned node mapping
+00042ef0: 2069 730a 2020 2020 2020 2020 616c 7761   is.        alwa
+00042f00: 7973 2074 6865 2069 6465 6e74 6974 7920  ys the identity 
+00042f10: 6d61 7070 696e 672c 2073 7563 6820 7468  mapping, such th
+00042f20: 6174 2060 6061 5b75 5d20 3d3d 2075 6060  at ``a[u] == u``
+00042f30: 2066 6f72 2061 6c6c 206e 6f64 6573 2e0a   for all nodes..
+00042f40: 0a20 2020 2020 2020 2053 6574 7469 6e67  .        Setting
+00042f50: 2074 6865 2060 6075 7064 6174 655f 7361   the ``update_sa
+00042f60: 6d70 6c65 5f66 6c61 6773 6060 2070 6172  mple_flags`` par
+00042f70: 616d 6574 6572 2074 6f20 4661 6c73 6520  ameter to False 
+00042f80: 6469 7361 626c 6573 2074 6865 0a20 2020  disables the.   
+00042f90: 2020 2020 2061 7574 6f6d 6174 6963 2073       automatic s
+00042fa0: 616d 706c 6520 7374 6174 7573 2075 7064  ample status upd
+00042fb0: 6174 6520 6f66 206e 6f64 6573 2028 6465  ate of nodes (de
+00042fc0: 7363 7269 6265 6420 6162 6f76 6529 2066  scribed above) f
+00042fd0: 726f 6d0a 2020 2020 2020 2020 6f63 6375  rom.        occu
+00042fe0: 7269 6e67 2c20 6d61 6b69 6e67 2069 7420  ring, making it 
+00042ff0: 7468 6520 7265 7370 6f6e 7369 6269 6c69  the responsibili
+00043000: 7479 206f 6620 6361 6c6c 696e 6720 636f  ty of calling co
+00043010: 6465 2074 6f20 6b65 6570 2074 7261 636b  de to keep track
+00043020: 206f 660a 2020 2020 2020 2020 7468 6520   of.        the 
+00043030: 756c 7469 6d61 7465 2073 616d 706c 6520  ultimate sample 
+00043040: 7374 6174 7573 206f 6620 6e6f 6465 732e  status of nodes.
+00043050: 2054 6869 7320 6973 2061 6e20 6164 7661   This is an adva
+00043060: 6e63 6564 206f 7074 696f 6e2c 206d 6f73  nced option, mos
+00043070: 746c 790a 2020 2020 2020 2020 6f66 2075  tly.        of u
+00043080: 7365 2077 6865 6e20 636f 6d62 696e 6564  se when combined
+00043090: 2077 6974 6820 7468 6520 6060 6669 6c74   with the ``filt
+000430a0: 6572 5f6e 6f64 6573 3d46 616c 7365 6060  er_nodes=False``
+000430b0: 2c0a 2020 2020 2020 2020 6060 6669 6c74  ,.        ``filt
+000430c0: 6572 5f70 6f70 756c 6174 696f 6e73 3d46  er_populations=F
+000430d0: 616c 7365 6060 2061 6e64 2060 6066 696c  alse`` and ``fil
+000430e0: 7465 725f 696e 6469 7669 6475 616c 733d  ter_individuals=
+000430f0: 4661 6c73 6560 6020 6f70 7469 6f6e 732c  False`` options,
+00043100: 0a20 2020 2020 2020 2077 6869 6368 2074  .        which t
+00043110: 6865 6e20 6775 6172 616e 7465 6573 2074  hen guarantees t
+00043120: 6861 7420 7468 6520 6e6f 6465 2074 6162  hat the node tab
+00043130: 6c65 2077 696c 6c20 6e6f 7420 6265 2061  le will not be a
+00043140: 6c74 6572 6564 2062 790a 2020 2020 2020  ltered by.      
+00043150: 2020 7369 6d70 6c69 6669 6361 7469 6f6e    simplification
+00043160: 2e0a 0a20 2020 2020 2020 203a 7061 7261  ...        :para
+00043170: 6d20 6c69 7374 5b69 6e74 5d20 7361 6d70  m list[int] samp
+00043180: 6c65 733a 2041 206c 6973 7420 6f66 206e  les: A list of n
+00043190: 6f64 6520 4944 7320 746f 2072 6574 6169  ode IDs to retai
+000431a0: 6e20 6173 2073 616d 706c 6573 2e20 5468  n as samples. Th
+000431b0: 6579 0a20 2020 2020 2020 2020 2020 206e  ey.            n
+000431c0: 6565 6420 6e6f 7420 6265 206e 6f64 6573  eed not be nodes
+000431d0: 206d 6172 6b65 6420 6173 2073 616d 706c   marked as sampl
+000431e0: 6573 2069 6e20 7468 6520 6f72 6967 696e  es in the origin
+000431f0: 616c 2074 7265 6520 7365 7175 656e 6365  al tree sequence
+00043200: 2c20 6275 740a 2020 2020 2020 2020 2020  , but.          
+00043210: 2020 7769 6c6c 2063 6f6e 7374 6974 7574    will constitut
+00043220: 6520 7468 6520 656e 7469 7265 2073 6574  e the entire set
+00043230: 206f 6620 7361 6d70 6c65 7320 696e 2074   of samples in t
+00043240: 6865 2072 6574 7572 6e65 6420 7472 6565  he returned tree
+00043250: 2073 6571 7565 6e63 652e 0a20 2020 2020   sequence..     
+00043260: 2020 2020 2020 2049 6620 6e6f 7420 7370         If not sp
+00043270: 6563 6966 6965 6420 6f72 204e 6f6e 652c  ecified or None,
+00043280: 2075 7365 2061 6c6c 206e 6f64 6573 206d   use all nodes m
+00043290: 6172 6b65 6420 7769 7468 2074 6865 2049  arked with the I
+000432a0: 535f 5341 4d50 4c45 2066 6c61 672e 0a20  S_SAMPLE flag.. 
+000432b0: 2020 2020 2020 2020 2020 2054 6865 206c             The l
+000432c0: 6973 7420 6d61 7920 6265 2070 726f 7669  ist may be provi
+000432d0: 6465 6420 6173 2061 206e 756d 7079 2061  ded as a numpy a
+000432e0: 7272 6179 2028 6f72 2061 7272 6179 2d6c  rray (or array-l
+000432f0: 696b 6529 206f 626a 6563 740a 2020 2020  ike) object.    
+00043300: 2020 2020 2020 2020 2864 7479 7065 3d6e          (dtype=n
+00043310: 702e 696e 7433 3229 2e0a 2020 2020 2020  p.int32)..      
+00043320: 2020 3a70 6172 616d 2062 6f6f 6c20 6d61    :param bool ma
+00043330: 705f 6e6f 6465 733a 2049 6620 5472 7565  p_nodes: If True
+00043340: 2c20 7265 7475 726e 2061 2074 7570 6c65  , return a tuple
+00043350: 2063 6f6e 7461 696e 696e 6720 7468 6520   containing the 
+00043360: 7265 7375 6c74 696e 670a 2020 2020 2020  resulting.      
+00043370: 2020 2020 2020 7472 6565 2073 6571 7565        tree seque
+00043380: 6e63 6520 616e 6420 6120 6e75 6d70 7920  nce and a numpy 
+00043390: 6172 7261 7920 6d61 7070 696e 6720 6e6f  array mapping no
+000433a0: 6465 2049 4473 2069 6e20 7468 6520 6375  de IDs in the cu
+000433b0: 7272 656e 7420 7472 6565 0a20 2020 2020  rrent tree.     
+000433c0: 2020 2020 2020 2073 6571 7565 6e63 6520         sequence 
+000433d0: 746f 2074 6865 6972 2063 6f72 7265 7370  to their corresp
+000433e0: 6f6e 6469 6e67 206e 6f64 6520 4944 7320  onding node IDs 
+000433f0: 696e 2074 6865 2072 6574 7572 6e65 6420  in the returned 
+00043400: 7472 6565 2073 6571 7565 6e63 652e 0a20  tree sequence.. 
+00043410: 2020 2020 2020 2020 2020 2049 6620 4661             If Fa
+00043420: 6c73 6520 2874 6865 2064 6566 6175 6c74  lse (the default
+00043430: 292c 2072 6574 7572 6e20 6f6e 6c79 2074  ), return only t
+00043440: 6865 2074 7265 6520 7365 7175 656e 6365  he tree sequence
+00043450: 206f 626a 6563 7420 6974 7365 6c66 2e0a   object itself..
+00043460: 2020 2020 2020 2020 3a70 6172 616d 2062          :param b
+00043470: 6f6f 6c20 7265 6475 6365 5f74 6f5f 7369  ool reduce_to_si
+00043480: 7465 5f74 6f70 6f6c 6f67 793a 2057 6865  te_topology: Whe
+00043490: 7468 6572 2074 6f20 7265 6475 6365 2074  ther to reduce t
+000434a0: 6865 2074 6f70 6f6c 6f67 7920 646f 776e  he topology down
+000434b0: 0a20 2020 2020 2020 2020 2020 2074 6f20  .            to 
+000434c0: 7468 6520 7472 6565 7320 7468 6174 2061  the trees that a
+000434d0: 7265 2070 7265 7365 6e74 2061 7420 7369  re present at si
+000434e0: 7465 732e 2028 4465 6661 756c 743a 2046  tes. (Default: F
+000434f0: 616c 7365 290a 2020 2020 2020 2020 3a70  alse).        :p
+00043500: 6172 616d 2062 6f6f 6c20 6669 6c74 6572  aram bool filter
+00043510: 5f70 6f70 756c 6174 696f 6e73 3a20 4966  _populations: If
+00043520: 2054 7275 652c 2072 656d 6f76 6520 616e   True, remove an
+00043530: 7920 706f 7075 6c61 7469 6f6e 7320 7468  y populations th
+00043540: 6174 2061 7265 0a20 2020 2020 2020 2020  at are.         
+00043550: 2020 206e 6f74 2072 6566 6572 656e 6365     not reference
+00043560: 6420 6279 206e 6f64 6573 2061 6674 6572  d by nodes after
+00043570: 2073 696d 706c 6966 6963 6174 696f 6e3b   simplification;
+00043580: 206e 6577 2070 6f70 756c 6174 696f 6e20   new population 
+00043590: 4944 7320 6172 650a 2020 2020 2020 2020  IDs are.        
+000435a0: 2020 2020 616c 6c6f 6361 7465 6420 7365      allocated se
+000435b0: 7175 656e 7469 616c 6c79 2066 726f 6d20  quentially from 
+000435c0: 7a65 726f 2e20 4966 2046 616c 7365 2c20  zero. If False, 
+000435d0: 7468 6520 706f 7075 6c61 7469 6f6e 2074  the population t
+000435e0: 6162 6c65 2077 696c 6c0a 2020 2020 2020  able will.      
+000435f0: 2020 2020 2020 6e6f 7420 6265 2061 6c74        not be alt
+00043600: 6572 6564 2069 6e20 616e 7920 7761 792e  ered in any way.
+00043610: 2028 4465 6661 756c 743a 204e 6f6e 652c   (Default: None,
+00043620: 2074 7265 6174 6564 2061 7320 5472 7565   treated as True
+00043630: 290a 2020 2020 2020 2020 3a70 6172 616d  ).        :param
+00043640: 2062 6f6f 6c20 6669 6c74 6572 5f69 6e64   bool filter_ind
+00043650: 6976 6964 7561 6c73 3a20 4966 2054 7275  ividuals: If Tru
+00043660: 652c 2072 656d 6f76 6520 616e 7920 696e  e, remove any in
+00043670: 6469 7669 6475 616c 7320 7468 6174 2061  dividuals that a
+00043680: 7265 0a20 2020 2020 2020 2020 2020 206e  re.            n
+00043690: 6f74 2072 6566 6572 656e 6365 6420 6279  ot referenced by
+000436a0: 206e 6f64 6573 2061 6674 6572 2073 696d   nodes after sim
+000436b0: 706c 6966 6963 6174 696f 6e3b 206e 6577  plification; new
+000436c0: 2069 6e64 6976 6964 7561 6c20 4944 7320   individual IDs 
+000436d0: 6172 650a 2020 2020 2020 2020 2020 2020  are.            
+000436e0: 616c 6c6f 6361 7465 6420 7365 7175 656e  allocated sequen
+000436f0: 7469 616c 6c79 2066 726f 6d20 7a65 726f  tially from zero
+00043700: 2e20 4966 2046 616c 7365 2c20 7468 6520  . If False, the 
+00043710: 696e 6469 7669 6475 616c 2074 6162 6c65  individual table
+00043720: 2077 696c 6c0a 2020 2020 2020 2020 2020   will.          
+00043730: 2020 6e6f 7420 6265 2061 6c74 6572 6564    not be altered
+00043740: 2069 6e20 616e 7920 7761 792e 2028 4465   in any way. (De
+00043750: 6661 756c 743a 204e 6f6e 652c 2074 7265  fault: None, tre
+00043760: 6174 6564 2061 7320 5472 7565 290a 2020  ated as True).  
+00043770: 2020 2020 2020 3a70 6172 616d 2062 6f6f        :param boo
+00043780: 6c20 6669 6c74 6572 5f73 6974 6573 3a20  l filter_sites: 
+00043790: 4966 2054 7275 652c 2072 656d 6f76 6520  If True, remove 
+000437a0: 616e 7920 7369 7465 7320 7468 6174 2061  any sites that a
+000437b0: 7265 0a20 2020 2020 2020 2020 2020 206e  re.            n
+000437c0: 6f74 2072 6566 6572 656e 6365 6420 6279  ot referenced by
+000437d0: 206d 7574 6174 696f 6e73 2061 6674 6572   mutations after
+000437e0: 2073 696d 706c 6966 6963 6174 696f 6e3b   simplification;
+000437f0: 206e 6577 2073 6974 6520 4944 7320 6172   new site IDs ar
+00043800: 650a 2020 2020 2020 2020 2020 2020 616c  e.            al
+00043810: 6c6f 6361 7465 6420 7365 7175 656e 7469  located sequenti
+00043820: 616c 6c79 2066 726f 6d20 7a65 726f 2e20  ally from zero. 
+00043830: 4966 2046 616c 7365 2c20 7468 6520 7369  If False, the si
+00043840: 7465 2074 6162 6c65 2077 696c 6c20 6e6f  te table will no
+00043850: 740a 2020 2020 2020 2020 2020 2020 6265  t.            be
+00043860: 2061 6c74 6572 6564 2069 6e20 616e 7920   altered in any 
+00043870: 7761 792e 2028 4465 6661 756c 743a 204e  way. (Default: N
+00043880: 6f6e 652c 2074 7265 6174 6564 2061 7320  one, treated as 
+00043890: 5472 7565 290a 2020 2020 2020 2020 3a70  True).        :p
+000438a0: 6172 616d 2062 6f6f 6c20 6669 6c74 6572  aram bool filter
+000438b0: 5f6e 6f64 6573 3a20 4966 2054 7275 652c  _nodes: If True,
+000438c0: 2072 656d 6f76 6520 616e 7920 6e6f 6465   remove any node
+000438d0: 7320 7468 6174 2061 7265 0a20 2020 2020  s that are.     
+000438e0: 2020 2020 2020 206e 6f74 2072 6566 6572         not refer
+000438f0: 656e 6365 6420 6279 2065 6467 6573 2061  enced by edges a
+00043900: 6674 6572 2073 696d 706c 6966 6963 6174  fter simplificat
+00043910: 696f 6e2e 2049 6620 4661 6c73 652c 2074  ion. If False, t
+00043920: 6865 206f 6e6c 790a 2020 2020 2020 2020  he only.        
+00043930: 2020 2020 706f 7465 6e74 6961 6c20 6368      potential ch
+00043940: 616e 6765 2074 6f20 7468 6520 6e6f 6465  ange to the node
+00043950: 2074 6162 6c65 206d 6179 2062 6520 746f   table may be to
+00043960: 2063 6861 6e67 6520 7468 6520 6e6f 6465   change the node
+00043970: 2066 6c61 6773 0a20 2020 2020 2020 2020   flags.         
+00043980: 2020 2028 6966 2060 6073 616d 706c 6573     (if ``samples
+00043990: 6060 2069 7320 7370 6563 6966 6965 6420  `` is specified 
+000439a0: 616e 6420 6469 6666 6572 656e 7420 6672  and different fr
+000439b0: 6f6d 2074 6865 2065 7869 7374 696e 6720  om the existing 
+000439c0: 7361 6d70 6c65 7329 2e0a 2020 2020 2020  samples)..      
+000439d0: 2020 2020 2020 2844 6566 6175 6c74 3a20        (Default: 
+000439e0: 4e6f 6e65 2c20 7472 6561 7465 6420 6173  None, treated as
+000439f0: 2054 7275 6529 0a20 2020 2020 2020 203a   True).        :
+00043a00: 7061 7261 6d20 626f 6f6c 2075 7064 6174  param bool updat
+00043a10: 655f 7361 6d70 6c65 5f66 6c61 6773 3a20  e_sample_flags: 
+00043a20: 4966 2054 7275 652c 2075 7064 6174 6520  If True, update 
+00043a30: 6e6f 6465 2066 6c61 6773 2074 6f20 736f  node flags to so
+00043a40: 2074 6861 740a 2020 2020 2020 2020 2020   that.          
+00043a50: 2020 6e6f 6465 7320 696e 2074 6865 2073    nodes in the s
+00043a60: 7065 6369 6669 6564 206c 6973 7420 6f66  pecified list of
+00043a70: 2073 616d 706c 6573 2068 6176 6520 7468   samples have th
+00043a80: 6520 4e4f 4445 5f49 535f 5341 4d50 4c45  e NODE_IS_SAMPLE
+00043a90: 0a20 2020 2020 2020 2020 2020 2066 6c61  .            fla
+00043aa0: 6720 6166 7465 7220 7369 6d70 6c69 6669  g after simplifi
+00043ab0: 6361 7469 6f6e 2c20 616e 6420 6e6f 6465  cation, and node
+00043ac0: 7320 7468 6174 2061 7265 206e 6f74 2069  s that are not i
+00043ad0: 6e20 7468 6973 206c 6973 740a 2020 2020  n this list.    
+00043ae0: 2020 2020 2020 2020 646f 206e 6f74 2e20          do not. 
+00043af0: 2844 6566 6175 6c74 3a20 4e6f 6e65 2c20  (Default: None, 
+00043b00: 7472 6561 7465 6420 6173 2054 7275 6529  treated as True)
+00043b10: 0a20 2020 2020 2020 203a 7061 7261 6d20  .        :param 
+00043b20: 626f 6f6c 206b 6565 705f 756e 6172 793a  bool keep_unary:
+00043b30: 2049 6620 5472 7565 2c20 7072 6573 6572   If True, preser
+00043b40: 7665 2075 6e61 7279 206e 6f64 6573 2028  ve unary nodes (
+00043b50: 692e 652e 2c20 6e6f 6465 7320 7769 7468  i.e., nodes with
+00043b60: 0a20 2020 2020 2020 2020 2020 2065 7861  .            exa
+00043b70: 6374 6c79 206f 6e65 2063 6869 6c64 2920  ctly one child) 
+00043b80: 7468 6174 2065 7869 7374 206f 6e20 7468  that exist on th
+00043b90: 6520 7061 7468 2066 726f 6d20 7361 6d70  e path from samp
+00043ba0: 6c65 7320 746f 2072 6f6f 742e 0a20 2020  les to root..   
+00043bb0: 2020 2020 2020 2020 2028 4465 6661 756c           (Defaul
+00043bc0: 743a 2046 616c 7365 290a 2020 2020 2020  t: False).      
+00043bd0: 2020 3a70 6172 616d 2062 6f6f 6c20 6b65    :param bool ke
+00043be0: 6570 5f75 6e61 7279 5f69 6e5f 696e 6469  ep_unary_in_indi
+00043bf0: 7669 6475 616c 733a 2049 6620 5472 7565  viduals: If True
+00043c00: 2c20 7072 6573 6572 7665 2075 6e61 7279  , preserve unary
+00043c10: 206e 6f64 6573 0a20 2020 2020 2020 2020   nodes.         
+00043c20: 2020 2074 6861 7420 6578 6973 7420 6f6e     that exist on
+00043c30: 2074 6865 2070 6174 6820 6672 6f6d 2073   the path from s
+00043c40: 616d 706c 6573 2074 6f20 726f 6f74 2c20  amples to root, 
+00043c50: 6275 7420 6f6e 6c79 2069 6620 7468 6579  but only if they
+00043c60: 2061 7265 0a20 2020 2020 2020 2020 2020   are.           
+00043c70: 2061 7373 6f63 6961 7465 6420 7769 7468   associated with
+00043c80: 2061 6e20 696e 6469 7669 6475 616c 2069   an individual i
+00043c90: 6e20 7468 6520 696e 6469 7669 6475 616c  n the individual
+00043ca0: 7320 7461 626c 652e 2043 616e 6e6f 7420  s table. Cannot 
+00043cb0: 6265 0a20 2020 2020 2020 2020 2020 2073  be.            s
+00043cc0: 7065 6369 6669 6564 2061 7420 7468 6520  pecified at the 
+00043cd0: 7361 6d65 2074 696d 6520 6173 2060 606b  same time as ``k
+00043ce0: 6565 705f 756e 6172 7960 602e 2028 4465  eep_unary``. (De
+00043cf0: 6661 756c 743a 2060 604e 6f6e 6560 602c  fault: ``None``,
+00043d00: 0a20 2020 2020 2020 2020 2020 2065 7175  .            equ
+00043d10: 6976 616c 656e 7420 746f 2046 616c 7365  ivalent to False
+00043d20: 290a 2020 2020 2020 2020 3a70 6172 616d  ).        :param
+00043d30: 2062 6f6f 6c20 6b65 6570 5f69 6e70 7574   bool keep_input
+00043d40: 5f72 6f6f 7473 3a20 5768 6574 6865 7220  _roots: Whether 
+00043d50: 746f 2072 6574 6169 6e20 6869 7374 6f72  to retain histor
+00043d60: 7920 616e 6365 7374 7261 6c20 746f 2074  y ancestral to t
+00043d70: 6865 0a20 2020 2020 2020 2020 2020 204d  he.            M
+00043d80: 5243 4120 6f66 2074 6865 2073 616d 706c  RCA of the sampl
+00043d90: 6573 2e20 4966 2060 6046 616c 7365 6060  es. If ``False``
+00043da0: 2c20 6e6f 2074 6f70 6f6c 6f67 7920 6f6c  , no topology ol
+00043db0: 6465 7220 7468 616e 2074 6865 204d 5243  der than the MRC
+00043dc0: 4173 206f 6620 7468 650a 2020 2020 2020  As of the.      
+00043dd0: 2020 2020 2020 7361 6d70 6c65 7320 7769        samples wi
+00043de0: 6c6c 2062 6520 696e 636c 7564 6564 2e20  ll be included. 
+00043df0: 4966 2060 6054 7275 6560 6020 7468 6520  If ``True`` the 
+00043e00: 726f 6f74 7320 6f66 2061 6c6c 2074 7265  roots of all tre
+00043e10: 6573 2069 6e20 7468 6520 7265 7475 726e  es in the return
+00043e20: 6564 0a20 2020 2020 2020 2020 2020 2074  ed.            t
+00043e30: 7265 6520 7365 7175 656e 6365 2077 696c  ree sequence wil
+00043e40: 6c20 6265 2074 6865 2073 616d 6520 726f  l be the same ro
+00043e50: 6f74 7320 6173 2069 6e20 7468 6520 6f72  ots as in the or
+00043e60: 6967 696e 616c 2074 7265 6520 7365 7175  iginal tree sequ
+00043e70: 656e 6365 2e0a 2020 2020 2020 2020 2020  ence..          
+00043e80: 2020 2844 6566 6175 6c74 3a20 4661 6c73    (Default: Fals
+00043e90: 6529 0a20 2020 2020 2020 203a 7061 7261  e).        :para
+00043ea0: 6d20 626f 6f6c 2072 6563 6f72 645f 7072  m bool record_pr
+00043eb0: 6f76 656e 616e 6365 3a20 4966 2054 7275  ovenance: If Tru
+00043ec0: 652c 2072 6563 6f72 6420 6465 7461 696c  e, record detail
+00043ed0: 7320 6f66 2074 6869 7320 6361 6c6c 2074  s of this call t
+00043ee0: 6f0a 2020 2020 2020 2020 2020 2020 7369  o.            si
+00043ef0: 6d70 6c69 6679 2069 6e20 7468 6520 7265  mplify in the re
+00043f00: 7475 726e 6564 2074 7265 6520 7365 7175  turned tree sequ
+00043f10: 656e 6365 2773 2070 726f 7665 6e61 6e63  ence's provenanc
+00043f20: 6520 696e 666f 726d 6174 696f 6e0a 2020  e information.  
+00043f30: 2020 2020 2020 2020 2020 2844 6566 6175            (Defau
+00043f40: 6c74 3a20 5472 7565 292e 0a20 2020 2020  lt: True)..     
+00043f50: 2020 203a 7061 7261 6d20 626f 6f6c 2066     :param bool f
+00043f60: 696c 7465 725f 7a65 726f 5f6d 7574 6174  ilter_zero_mutat
+00043f70: 696f 6e5f 7369 7465 733a 2044 6570 7265  ion_sites: Depre
+00043f80: 6361 7465 6420 616c 6961 7320 666f 7220  cated alias for 
+00043f90: 6060 6669 6c74 6572 5f73 6974 6573 6060  ``filter_sites``
+00043fa0: 2e0a 2020 2020 2020 2020 3a72 6574 7572  ..        :retur
+00043fb0: 6e3a 2054 6865 2073 696d 706c 6966 6965  n: The simplifie
+00043fc0: 6420 7472 6565 2073 6571 7565 6e63 652c  d tree sequence,
+00043fd0: 206f 7220 2869 6620 6060 6d61 705f 6e6f   or (if ``map_no
+00043fe0: 6465 7360 6020 6973 2054 7275 6529 0a20  des`` is True). 
+00043ff0: 2020 2020 2020 2020 2020 2061 2074 7570             a tup
+00044000: 6c65 2063 6f6e 7369 7374 696e 6720 6f66  le consisting of
+00044010: 2074 6865 2073 696d 706c 6966 6965 6420   the simplified 
+00044020: 7472 6565 2073 6571 7565 6e63 6520 616e  tree sequence an
+00044030: 6420 6120 6e75 6d70 7920 6172 7261 790a  d a numpy array.
+00044040: 2020 2020 2020 2020 2020 2020 6d61 7070              mapp
+00044050: 696e 6720 736f 7572 6365 206e 6f64 6520  ing source node 
+00044060: 4944 7320 746f 2074 6865 6972 2063 6f72  IDs to their cor
+00044070: 7265 7370 6f6e 6469 6e67 2049 4473 2069  responding IDs i
+00044080: 6e20 7468 6520 6e65 7720 7472 6565 0a20  n the new tree. 
+00044090: 2020 2020 2020 2020 2020 2073 6571 7565             seque
+000440a0: 6e63 652e 0a20 2020 2020 2020 203a 7274  nce..        :rt
+000440b0: 7970 653a 2074 736b 6974 2e54 7265 6553  ype: tskit.TreeS
+000440c0: 6571 7565 6e63 6520 6f72 2028 7473 6b69  equence or (tski
+000440d0: 742e 5472 6565 5365 7175 656e 6365 2c20  t.TreeSequence, 
+000440e0: 6e75 6d70 792e 6e64 6172 7261 7929 0a20  numpy.ndarray). 
+000440f0: 2020 2020 2020 2022 2222 0a20 2020 2020         """.     
+00044100: 2020 2074 6162 6c65 7320 3d20 7365 6c66     tables = self
+00044110: 2e64 756d 705f 7461 626c 6573 2829 0a20  .dump_tables(). 
+00044120: 2020 2020 2020 2061 7373 6572 7420 7461         assert ta
+00044130: 626c 6573 2e73 6571 7565 6e63 655f 6c65  bles.sequence_le
+00044140: 6e67 7468 203d 3d20 7365 6c66 2e73 6571  ngth == self.seq
+00044150: 7565 6e63 655f 6c65 6e67 7468 0a20 2020  uence_length.   
+00044160: 2020 2020 206e 6f64 655f 6d61 7020 3d20       node_map = 
+00044170: 7461 626c 6573 2e73 696d 706c 6966 7928  tables.simplify(
+00044180: 0a20 2020 2020 2020 2020 2020 2073 616d  .            sam
+00044190: 706c 6573 3d73 616d 706c 6573 2c0a 2020  ples=samples,.  
+000441a0: 2020 2020 2020 2020 2020 7265 6475 6365            reduce
+000441b0: 5f74 6f5f 7369 7465 5f74 6f70 6f6c 6f67  _to_site_topolog
+000441c0: 793d 7265 6475 6365 5f74 6f5f 7369 7465  y=reduce_to_site
+000441d0: 5f74 6f70 6f6c 6f67 792c 0a20 2020 2020  _topology,.     
+000441e0: 2020 2020 2020 2066 696c 7465 725f 706f         filter_po
+000441f0: 7075 6c61 7469 6f6e 733d 6669 6c74 6572  pulations=filter
+00044200: 5f70 6f70 756c 6174 696f 6e73 2c0a 2020  _populations,.  
+00044210: 2020 2020 2020 2020 2020 6669 6c74 6572            filter
+00044220: 5f69 6e64 6976 6964 7561 6c73 3d66 696c  _individuals=fil
+00044230: 7465 725f 696e 6469 7669 6475 616c 732c  ter_individuals,
+00044240: 0a20 2020 2020 2020 2020 2020 2066 696c  .            fil
+00044250: 7465 725f 7369 7465 733d 6669 6c74 6572  ter_sites=filter
+00044260: 5f73 6974 6573 2c0a 2020 2020 2020 2020  _sites,.        
+00044270: 2020 2020 6669 6c74 6572 5f6e 6f64 6573      filter_nodes
+00044280: 3d66 696c 7465 725f 6e6f 6465 732c 0a20  =filter_nodes,. 
+00044290: 2020 2020 2020 2020 2020 2075 7064 6174             updat
+000442a0: 655f 7361 6d70 6c65 5f66 6c61 6773 3d75  e_sample_flags=u
+000442b0: 7064 6174 655f 7361 6d70 6c65 5f66 6c61  pdate_sample_fla
+000442c0: 6773 2c0a 2020 2020 2020 2020 2020 2020  gs,.            
+000442d0: 6b65 6570 5f75 6e61 7279 3d6b 6565 705f  keep_unary=keep_
+000442e0: 756e 6172 792c 0a20 2020 2020 2020 2020  unary,.         
+000442f0: 2020 206b 6565 705f 756e 6172 795f 696e     keep_unary_in
+00044300: 5f69 6e64 6976 6964 7561 6c73 3d6b 6565  _individuals=kee
+00044310: 705f 756e 6172 795f 696e 5f69 6e64 6976  p_unary_in_indiv
+00044320: 6964 7561 6c73 2c0a 2020 2020 2020 2020  iduals,.        
+00044330: 2020 2020 6b65 6570 5f69 6e70 7574 5f72      keep_input_r
+00044340: 6f6f 7473 3d6b 6565 705f 696e 7075 745f  oots=keep_input_
+00044350: 726f 6f74 732c 0a20 2020 2020 2020 2020  roots,.         
+00044360: 2020 2072 6563 6f72 645f 7072 6f76 656e     record_proven
+00044370: 616e 6365 3d72 6563 6f72 645f 7072 6f76  ance=record_prov
+00044380: 656e 616e 6365 2c0a 2020 2020 2020 2020  enance,.        
+00044390: 2020 2020 6669 6c74 6572 5f7a 6572 6f5f      filter_zero_
+000443a0: 6d75 7461 7469 6f6e 5f73 6974 6573 3d66  mutation_sites=f
+000443b0: 696c 7465 725f 7a65 726f 5f6d 7574 6174  ilter_zero_mutat
+000443c0: 696f 6e5f 7369 7465 732c 0a20 2020 2020  ion_sites,.     
+000443d0: 2020 2029 0a20 2020 2020 2020 206e 6577     ).        new
+000443e0: 5f74 7320 3d20 7461 626c 6573 2e74 7265  _ts = tables.tre
+000443f0: 655f 7365 7175 656e 6365 2829 0a20 2020  e_sequence().   
+00044400: 2020 2020 2061 7373 6572 7420 6e65 775f       assert new_
+00044410: 7473 2e73 6571 7565 6e63 655f 6c65 6e67  ts.sequence_leng
+00044420: 7468 203d 3d20 7365 6c66 2e73 6571 7565  th == self.seque
+00044430: 6e63 655f 6c65 6e67 7468 0a20 2020 2020  nce_length.     
+00044440: 2020 2069 6620 6d61 705f 6e6f 6465 733a     if map_nodes:
+00044450: 0a20 2020 2020 2020 2020 2020 2072 6574  .            ret
+00044460: 7572 6e20 6e65 775f 7473 2c20 6e6f 6465  urn new_ts, node
+00044470: 5f6d 6170 0a20 2020 2020 2020 2065 6c73  _map.        els
+00044480: 653a 0a20 2020 2020 2020 2020 2020 2072  e:.            r
+00044490: 6574 7572 6e20 6e65 775f 7473 0a0a 2020  eturn new_ts..  
+000444a0: 2020 6465 6620 6465 6c65 7465 5f73 6974    def delete_sit
+000444b0: 6573 2873 656c 662c 2073 6974 655f 6964  es(self, site_id
+000444c0: 732c 2072 6563 6f72 645f 7072 6f76 656e  s, record_proven
+000444d0: 616e 6365 3d54 7275 6529 3a0a 2020 2020  ance=True):.    
+000444e0: 2020 2020 2222 220a 2020 2020 2020 2020      """.        
+000444f0: 5265 7475 726e 7320 6120 636f 7079 206f  Returns a copy o
+00044500: 6620 7468 6973 2074 7265 6520 7365 7175  f this tree sequ
+00044510: 656e 6365 2077 6974 6820 7468 6520 7370  ence with the sp
+00044520: 6563 6966 6965 6420 7369 7465 7320 2861  ecified sites (a
+00044530: 6e64 2074 6865 6972 0a20 2020 2020 2020  nd their.       
+00044540: 2061 7373 6f63 6961 7465 6420 6d75 7461   associated muta
+00044550: 7469 6f6e 7329 2065 6e74 6972 656c 7920  tions) entirely 
+00044560: 7265 6d6f 7665 642e 2054 6865 2073 6974  removed. The sit
+00044570: 6520 4944 7320 646f 206e 6f74 206e 6565  e IDs do not nee
+00044580: 6420 746f 2062 6520 696e 2061 6e79 0a20  d to be in any. 
+00044590: 2020 2020 2020 2070 6172 7469 6375 6c61         particula
+000445a0: 7220 6f72 6465 722c 2061 6e64 2073 7065  r order, and spe
+000445b0: 6369 6679 696e 6720 7468 6520 7361 6d65  cifying the same
+000445c0: 2049 4420 6d75 6c74 6970 6c65 2074 696d   ID multiple tim
+000445d0: 6573 2064 6f65 7320 6e6f 7420 6861 7665  es does not have
+000445e0: 2061 6e79 0a20 2020 2020 2020 2065 6666   any.        eff
+000445f0: 6563 7420 2869 2e65 2e2c 2063 616c 6c69  ect (i.e., calli
+00044600: 6e67 2060 6074 7265 655f 7365 7175 656e  ng ``tree_sequen
+00044610: 6365 2e64 656c 6574 655f 7369 7465 7328  ce.delete_sites(
+00044620: 5b30 2c20 312c 2031 5d29 6060 2068 6173  [0, 1, 1])`` has
+00044630: 2074 6865 2073 616d 650a 2020 2020 2020   the same.      
+00044640: 2020 6566 6665 6374 2061 7320 6361 6c6c    effect as call
+00044650: 696e 6720 6060 7472 6565 5f73 6571 7565  ing ``tree_seque
+00044660: 6e63 652e 6465 6c65 7465 5f73 6974 6573  nce.delete_sites
+00044670: 285b 302c 2031 5d29 6060 2e0a 0a20 2020  ([0, 1])``...   
+00044680: 2020 2020 203a 7061 7261 6d20 6c69 7374       :param list
+00044690: 5b69 6e74 5d20 7369 7465 5f69 6473 3a20  [int] site_ids: 
+000446a0: 4120 6c69 7374 206f 6620 7369 7465 2049  A list of site I
+000446b0: 4473 2073 7065 6369 6679 696e 6720 7468  Ds specifying th
+000446c0: 6520 7369 7465 7320 746f 2072 656d 6f76  e sites to remov
+000446d0: 652e 0a20 2020 2020 2020 203a 7061 7261  e..        :para
+000446e0: 6d20 626f 6f6c 2072 6563 6f72 645f 7072  m bool record_pr
+000446f0: 6f76 656e 616e 6365 3a20 4966 2060 6054  ovenance: If ``T
+00044700: 7275 6560 602c 2061 6464 2064 6574 6169  rue``, add detai
+00044710: 6c73 206f 6620 7468 6973 206f 7065 7261  ls of this opera
+00044720: 7469 6f6e 2074 6f20 7468 650a 2020 2020  tion to the.    
+00044730: 2020 2020 2020 2020 7072 6f76 656e 616e          provenan
+00044740: 6365 2069 6e66 6f72 6d61 7469 6f6e 206f  ce information o
+00044750: 6620 7468 6520 7265 7475 726e 6564 2074  f the returned t
+00044760: 7265 6520 7365 7175 656e 6365 2e20 2844  ree sequence. (D
+00044770: 6566 6175 6c74 3a20 6060 5472 7565 6060  efault: ``True``
+00044780: 292e 0a20 2020 2020 2020 2022 2222 0a20  )..        """. 
+00044790: 2020 2020 2020 2074 6162 6c65 7320 3d20         tables = 
+000447a0: 7365 6c66 2e64 756d 705f 7461 626c 6573  self.dump_tables
+000447b0: 2829 0a20 2020 2020 2020 2074 6162 6c65  ().        table
+000447c0: 732e 6465 6c65 7465 5f73 6974 6573 2873  s.delete_sites(s
+000447d0: 6974 655f 6964 732c 2072 6563 6f72 645f  ite_ids, record_
+000447e0: 7072 6f76 656e 616e 6365 290a 2020 2020  provenance).    
+000447f0: 2020 2020 7265 7475 726e 2074 6162 6c65      return table
+00044800: 732e 7472 6565 5f73 6571 7565 6e63 6528  s.tree_sequence(
+00044810: 290a 0a20 2020 2064 6566 2064 656c 6574  )..    def delet
+00044820: 655f 696e 7465 7276 616c 7328 7365 6c66  e_intervals(self
+00044830: 2c20 696e 7465 7276 616c 732c 2073 696d  , intervals, sim
+00044840: 706c 6966 793d 5472 7565 2c20 7265 636f  plify=True, reco
+00044850: 7264 5f70 726f 7665 6e61 6e63 653d 5472  rd_provenance=Tr
+00044860: 7565 293a 0a20 2020 2020 2020 2022 2222  ue):.        """
+00044870: 0a20 2020 2020 2020 2052 6574 7572 6e73  .        Returns
+00044880: 2061 2063 6f70 7920 6f66 2074 6869 7320   a copy of this 
+00044890: 7472 6565 2073 6571 7565 6e63 6520 666f  tree sequence fo
+000448a0: 7220 7768 6963 6820 696e 666f 726d 6174  r which informat
+000448b0: 696f 6e20 696e 2074 6865 0a20 2020 2020  ion in the.     
+000448c0: 2020 2073 7065 6369 6669 6564 206c 6973     specified lis
+000448d0: 7420 6f66 2067 656e 6f6d 6963 2069 6e74  t of genomic int
+000448e0: 6572 7661 6c73 2068 6173 2062 6565 6e20  ervals has been 
+000448f0: 6465 6c65 7465 642e 2045 6467 6573 2073  deleted. Edges s
+00044900: 7061 6e6e 696e 6720 7468 6573 650a 2020  panning these.  
+00044910: 2020 2020 2020 696e 7465 7276 616c 7320        intervals 
+00044920: 6172 6520 7472 756e 6361 7465 6420 6f72  are truncated or
+00044930: 2064 656c 6574 6564 2c20 616e 6420 7369   deleted, and si
+00044940: 7465 7320 616e 6420 6d75 7461 7469 6f6e  tes and mutation
+00044950: 7320 6661 6c6c 696e 6720 7769 7468 696e  s falling within
+00044960: 0a20 2020 2020 2020 2074 6865 6d20 6172  .        them ar
+00044970: 6520 6469 7363 6172 6465 642e 204e 6f74  e discarded. Not
+00044980: 6520 7468 6174 2069 7420 6973 2074 6865  e that it is the
+00044990: 2069 6e66 6f72 6d61 7469 6f6e 2069 6e20   information in 
+000449a0: 7468 6520 696e 7465 7276 616c 7320 7468  the intervals th
+000449b0: 6174 0a20 2020 2020 2020 2069 7320 6465  at.        is de
+000449c0: 6c65 7465 642c 206e 6f74 2074 6865 2069  leted, not the i
+000449d0: 6e74 6572 7661 6c73 2074 6865 6d73 656c  ntervals themsel
+000449e0: 7665 732c 2073 6f20 696e 2070 6172 7469  ves, so in parti
+000449f0: 6375 6c61 722c 2061 6c6c 2073 616d 706c  cular, all sampl
+00044a00: 6573 0a20 2020 2020 2020 2077 696c 6c20  es.        will 
+00044a10: 6265 2069 736f 6c61 7465 6420 696e 2074  be isolated in t
+00044a20: 6865 2064 656c 6574 6564 2069 6e74 6572  he deleted inter
+00044a30: 7661 6c73 2e0a 0a20 2020 2020 2020 204e  vals...        N
+00044a40: 6f74 6520 7468 6174 206e 6f64 6520 4944  ote that node ID
+00044a50: 7320 6d61 7920 6368 616e 6765 2061 7320  s may change as 
+00044a60: 6120 7265 7375 6c74 206f 6620 7468 6973  a result of this
+00044a70: 206f 7065 7261 7469 6f6e 2c0a 2020 2020   operation,.    
+00044a80: 2020 2020 6173 2062 7920 6465 6661 756c      as by defaul
+00044a90: 7420 3a6d 6574 683a 602e 7369 6d70 6c69  t :meth:`.simpli
+00044aa0: 6679 6020 6973 2063 616c 6c65 6420 6f6e  fy` is called on
+00044ab0: 2074 6865 2072 6574 7572 6e65 6420 7472   the returned tr
+00044ac0: 6565 2073 6571 7565 6e63 650a 2020 2020  ee sequence.    
+00044ad0: 2020 2020 746f 2072 656d 6f76 6520 7265      to remove re
+00044ae0: 6475 6e64 616e 7420 6e6f 6465 732e 2049  dundant nodes. I
+00044af0: 6620 796f 7520 7769 7368 2074 6f20 6d61  f you wish to ma
+00044b00: 7020 6e6f 6465 2049 4473 206f 6e74 6f20  p node IDs onto 
+00044b10: 7468 6520 7361 6d65 0a20 2020 2020 2020  the same.       
+00044b20: 206e 6f64 6573 2062 6566 6f72 6520 616e   nodes before an
+00044b30: 6420 6166 7465 7220 7468 6973 206d 6574  d after this met
+00044b40: 686f 6420 6861 7320 6265 656e 2063 616c  hod has been cal
+00044b50: 6c65 642c 2073 7065 6369 6679 2060 6073  led, specify ``s
+00044b60: 696d 706c 6966 793d 4661 6c73 6560 602e  implify=False``.
+00044b70: 0a0a 2020 2020 2020 2020 5365 6520 616c  ..        See al
+00044b80: 736f 203a 6d65 7468 3a60 2e6b 6565 705f  so :meth:`.keep_
+00044b90: 696e 7465 7276 616c 7360 2c20 3a6d 6574  intervals`, :met
+00044ba0: 683a 602e 6c74 7269 6d60 2c20 3a6d 6574  h:`.ltrim`, :met
+00044bb0: 683a 602e 7274 7269 6d60 2c20 616e 640a  h:`.rtrim`, and.
+00044bc0: 2020 2020 2020 2020 3a72 6566 3a60 6d69          :ref:`mi
+00044bd0: 7373 696e 6720 6461 7461 3c73 6563 5f64  ssing data<sec_d
+00044be0: 6174 615f 6d6f 6465 6c5f 6d69 7373 696e  ata_model_missin
+00044bf0: 675f 6461 7461 3e60 2e0a 0a20 2020 2020  g_data>`...     
+00044c00: 2020 203a 7061 7261 6d20 6172 7261 795f     :param array_
+00044c10: 6c69 6b65 2069 6e74 6572 7661 6c73 3a20  like intervals: 
+00044c20: 4120 6c69 7374 2028 7374 6172 742c 2065  A list (start, e
+00044c30: 6e64 2920 7061 6972 7320 6465 7363 7269  nd) pairs descri
+00044c40: 6269 6e67 2074 6865 0a20 2020 2020 2020  bing the.       
+00044c50: 2020 2020 2067 656e 6f6d 6963 2069 6e74       genomic int
+00044c60: 6572 7661 6c73 2074 6f20 6465 6c65 7465  ervals to delete
+00044c70: 2e20 496e 7465 7276 616c 7320 6d75 7374  . Intervals must
+00044c80: 2062 6520 6e6f 6e2d 6f76 6572 6c61 7070   be non-overlapp
+00044c90: 696e 6720 616e 640a 2020 2020 2020 2020  ing and.        
+00044ca0: 2020 2020 696e 2069 6e63 7265 6173 696e      in increasin
+00044cb0: 6720 6f72 6465 722e 2054 6865 206c 6973  g order. The lis
+00044cc0: 7420 6f66 2069 6e74 6572 7661 6c73 206d  t of intervals m
+00044cd0: 7573 7420 6265 2069 6e74 6572 7072 6574  ust be interpret
+00044ce0: 6162 6c65 2061 7320 610a 2020 2020 2020  able as a.      
+00044cf0: 2020 2020 2020 3244 206e 756d 7079 2061        2D numpy a
+00044d00: 7272 6179 2077 6974 6820 7368 6170 6520  rray with shape 
+00044d10: 284e 2c20 3229 2c20 7768 6572 6520 4e20  (N, 2), where N 
+00044d20: 6973 2074 6865 206e 756d 6265 7220 6f66  is the number of
+00044d30: 2069 6e74 6572 7661 6c73 2e0a 2020 2020   intervals..    
+00044d40: 2020 2020 3a70 6172 616d 2062 6f6f 6c20      :param bool 
+00044d50: 7369 6d70 6c69 6679 3a20 4966 2054 7275  simplify: If Tru
+00044d60: 652c 2072 6574 7572 6e20 6120 7369 6d70  e, return a simp
+00044d70: 6c69 6669 6564 2074 7265 6520 7365 7175  lified tree sequ
+00044d80: 656e 6365 2077 6865 7265 206e 6f64 6573  ence where nodes
+00044d90: 0a20 2020 2020 2020 2020 2020 206e 6f20  .            no 
+00044da0: 6c6f 6e67 6572 2075 7365 6420 6172 6520  longer used are 
+00044db0: 6469 7363 6172 6465 642e 2028 4465 6661  discarded. (Defa
+00044dc0: 756c 743a 2054 7275 6529 2e0a 2020 2020  ult: True)..    
+00044dd0: 2020 2020 3a70 6172 616d 2062 6f6f 6c20      :param bool 
+00044de0: 7265 636f 7264 5f70 726f 7665 6e61 6e63  record_provenanc
+00044df0: 653a 2049 6620 6060 5472 7565 6060 2c20  e: If ``True``, 
+00044e00: 6164 6420 6465 7461 696c 7320 6f66 2074  add details of t
+00044e10: 6869 7320 6f70 6572 6174 696f 6e20 746f  his operation to
+00044e20: 2074 6865 0a20 2020 2020 2020 2020 2020   the.           
+00044e30: 2070 726f 7665 6e61 6e63 6520 696e 666f   provenance info
+00044e40: 726d 6174 696f 6e20 6f66 2074 6865 2072  rmation of the r
+00044e50: 6574 7572 6e65 6420 7472 6565 2073 6571  eturned tree seq
+00044e60: 7565 6e63 652e 2028 4465 6661 756c 743a  uence. (Default:
+00044e70: 2060 6054 7275 6560 6029 2e0a 2020 2020   ``True``)..    
+00044e80: 2020 2020 3a72 7479 7065 3a20 7473 6b69      :rtype: tski
+00044e90: 742e 5472 6565 5365 7175 656e 6365 0a20  t.TreeSequence. 
+00044ea0: 2020 2020 2020 2022 2222 0a20 2020 2020         """.     
+00044eb0: 2020 2074 6162 6c65 7320 3d20 7365 6c66     tables = self
+00044ec0: 2e64 756d 705f 7461 626c 6573 2829 0a20  .dump_tables(). 
+00044ed0: 2020 2020 2020 2074 6162 6c65 732e 6465         tables.de
+00044ee0: 6c65 7465 5f69 6e74 6572 7661 6c73 2869  lete_intervals(i
+00044ef0: 6e74 6572 7661 6c73 2c20 7369 6d70 6c69  ntervals, simpli
+00044f00: 6679 2c20 7265 636f 7264 5f70 726f 7665  fy, record_prove
+00044f10: 6e61 6e63 6529 0a20 2020 2020 2020 2072  nance).        r
+00044f20: 6574 7572 6e20 7461 626c 6573 2e74 7265  eturn tables.tre
+00044f30: 655f 7365 7175 656e 6365 2829 0a0a 2020  e_sequence()..  
+00044f40: 2020 6465 6620 6b65 6570 5f69 6e74 6572    def keep_inter
+00044f50: 7661 6c73 2873 656c 662c 2069 6e74 6572  vals(self, inter
+00044f60: 7661 6c73 2c20 7369 6d70 6c69 6679 3d54  vals, simplify=T
+00044f70: 7275 652c 2072 6563 6f72 645f 7072 6f76  rue, record_prov
+00044f80: 656e 616e 6365 3d54 7275 6529 3a0a 2020  enance=True):.  
+00044f90: 2020 2020 2020 2222 220a 2020 2020 2020        """.      
+00044fa0: 2020 5265 7475 726e 7320 6120 636f 7079    Returns a copy
+00044fb0: 206f 6620 7468 6973 2074 7265 6520 7365   of this tree se
+00044fc0: 7175 656e 6365 2077 6869 6368 2069 6e63  quence which inc
+00044fd0: 6c75 6465 7320 6f6e 6c79 2069 6e66 6f72  ludes only infor
+00044fe0: 6d61 7469 6f6e 2069 6e0a 2020 2020 2020  mation in.      
+00044ff0: 2020 7468 6520 7370 6563 6966 6965 6420    the specified 
+00045000: 6c69 7374 206f 6620 6765 6e6f 6d69 6320  list of genomic 
+00045010: 696e 7465 7276 616c 732e 2045 6467 6573  intervals. Edges
+00045020: 2061 7265 2074 7275 6e63 6174 6564 2074   are truncated t
+00045030: 6f20 6c69 6520 7769 7468 696e 0a20 2020  o lie within.   
+00045040: 2020 2020 2074 6865 7365 2069 6e74 6572       these inter
+00045050: 7661 6c73 2c20 616e 6420 7369 7465 7320  vals, and sites 
+00045060: 616e 6420 6d75 7461 7469 6f6e 7320 6661  and mutations fa
+00045070: 6c6c 696e 6720 6f75 7473 6964 6520 7468  lling outside th
+00045080: 6573 6520 696e 7465 7276 616c 730a 2020  ese intervals.  
+00045090: 2020 2020 2020 6172 6520 6469 7363 6172        are discar
+000450a0: 6465 642e 2020 4e6f 7465 2074 6861 7420  ded.  Note that 
+000450b0: 6974 2069 7320 7468 6520 696e 666f 726d  it is the inform
+000450c0: 6174 696f 6e20 6f75 7473 6964 6520 7468  ation outside th
+000450d0: 6520 696e 7465 7276 616c 7320 7468 6174  e intervals that
+000450e0: 0a20 2020 2020 2020 2069 7320 6465 6c65  .        is dele
+000450f0: 7465 642c 206e 6f74 2074 6865 2069 6e74  ted, not the int
+00045100: 6572 7661 6c73 2074 6865 6d73 656c 7665  ervals themselve
+00045110: 732c 2073 6f20 696e 2070 6172 7469 6375  s, so in particu
+00045120: 6c61 722c 2061 6c6c 2073 616d 706c 6573  lar, all samples
+00045130: 0a20 2020 2020 2020 2077 696c 6c20 6265  .        will be
+00045140: 2069 736f 6c61 7465 6420 6f75 7473 6964   isolated outsid
+00045150: 6520 6f66 2074 6865 2072 6574 6169 6e65  e of the retaine
+00045160: 6420 696e 7465 7276 616c 732e 0a0a 2020  d intervals...  
+00045170: 2020 2020 2020 4e6f 7465 2074 6861 7420        Note that 
+00045180: 6e6f 6465 2049 4473 206d 6179 2063 6861  node IDs may cha
+00045190: 6e67 6520 6173 2061 2072 6573 756c 7420  nge as a result 
+000451a0: 6f66 2074 6869 7320 6f70 6572 6174 696f  of this operatio
+000451b0: 6e2c 0a20 2020 2020 2020 2061 7320 6279  n,.        as by
+000451c0: 2064 6566 6175 6c74 203a 6d65 7468 3a60   default :meth:`
+000451d0: 2e73 696d 706c 6966 7960 2069 7320 6361  .simplify` is ca
+000451e0: 6c6c 6564 206f 6e20 7468 6520 7265 7475  lled on the retu
+000451f0: 726e 6564 2074 7265 6520 7365 7175 656e  rned tree sequen
+00045200: 6365 0a20 2020 2020 2020 2074 6f20 7265  ce.        to re
+00045210: 6d6f 7665 2072 6564 756e 6461 6e74 206e  move redundant n
+00045220: 6f64 6573 2e20 4966 2079 6f75 2077 6973  odes. If you wis
+00045230: 6820 746f 206d 6170 206e 6f64 6520 4944  h to map node ID
+00045240: 7320 6f6e 746f 2074 6865 2073 616d 650a  s onto the same.
+00045250: 2020 2020 2020 2020 6e6f 6465 7320 6265          nodes be
+00045260: 666f 7265 2061 6e64 2061 6674 6572 2074  fore and after t
+00045270: 6869 7320 6d65 7468 6f64 2068 6173 2062  his method has b
+00045280: 6565 6e20 6361 6c6c 6564 2c20 7370 6563  een called, spec
+00045290: 6966 7920 6060 7369 6d70 6c69 6679 3d46  ify ``simplify=F
+000452a0: 616c 7365 6060 2e0a 0a20 2020 2020 2020  alse``...       
+000452b0: 2053 6565 2061 6c73 6f20 3a6d 6574 683a   See also :meth:
+000452c0: 602e 6b65 6570 5f69 6e74 6572 7661 6c73  `.keep_intervals
+000452d0: 602c 203a 6d65 7468 3a60 2e6c 7472 696d  `, :meth:`.ltrim
+000452e0: 602c 203a 6d65 7468 3a60 2e72 7472 696d  `, :meth:`.rtrim
+000452f0: 602c 2061 6e64 0a20 2020 2020 2020 203a  `, and.        :
+00045300: 7265 663a 606d 6973 7369 6e67 2064 6174  ref:`missing dat
+00045310: 613c 7365 635f 6461 7461 5f6d 6f64 656c  a<sec_data_model
+00045320: 5f6d 6973 7369 6e67 5f64 6174 613e 602e  _missing_data>`.
+00045330: 0a0a 2020 2020 2020 2020 3a70 6172 616d  ..        :param
+00045340: 2061 7272 6179 5f6c 696b 6520 696e 7465   array_like inte
+00045350: 7276 616c 733a 2041 206c 6973 7420 2873  rvals: A list (s
+00045360: 7461 7274 2c20 656e 6429 2070 6169 7273  tart, end) pairs
+00045370: 2064 6573 6372 6962 696e 6720 7468 650a   describing the.
+00045380: 2020 2020 2020 2020 2020 2020 6765 6e6f              geno
+00045390: 6d69 6320 696e 7465 7276 616c 7320 746f  mic intervals to
+000453a0: 206b 6565 702e 2049 6e74 6572 7661 6c73   keep. Intervals
+000453b0: 206d 7573 7420 6265 206e 6f6e 2d6f 7665   must be non-ove
+000453c0: 726c 6170 7069 6e67 2061 6e64 0a20 2020  rlapping and.   
+000453d0: 2020 2020 2020 2020 2069 6e20 696e 6372           in incr
+000453e0: 6561 7369 6e67 206f 7264 6572 2e20 5468  easing order. Th
+000453f0: 6520 6c69 7374 206f 6620 696e 7465 7276  e list of interv
+00045400: 616c 7320 6d75 7374 2062 6520 696e 7465  als must be inte
+00045410: 7270 7265 7461 626c 6520 6173 2061 0a20  rpretable as a. 
+00045420: 2020 2020 2020 2020 2020 2032 4420 6e75             2D nu
+00045430: 6d70 7920 6172 7261 7920 7769 7468 2073  mpy array with s
+00045440: 6861 7065 2028 4e2c 2032 292c 2077 6865  hape (N, 2), whe
+00045450: 7265 204e 2069 7320 7468 6520 6e75 6d62  re N is the numb
+00045460: 6572 206f 6620 696e 7465 7276 616c 732e  er of intervals.
+00045470: 0a20 2020 2020 2020 203a 7061 7261 6d20  .        :param 
+00045480: 626f 6f6c 2073 696d 706c 6966 793a 2049  bool simplify: I
+00045490: 6620 5472 7565 2c20 7265 7475 726e 2061  f True, return a
+000454a0: 2073 696d 706c 6966 6965 6420 7472 6565   simplified tree
+000454b0: 2073 6571 7565 6e63 6520 7768 6572 6520   sequence where 
+000454c0: 6e6f 6465 730a 2020 2020 2020 2020 2020  nodes.          
+000454d0: 2020 6e6f 206c 6f6e 6765 7220 7573 6564    no longer used
+000454e0: 2061 7265 2064 6973 6361 7264 6564 2e20   are discarded. 
+000454f0: 2844 6566 6175 6c74 3a20 5472 7565 292e  (Default: True).
+00045500: 0a20 2020 2020 2020 203a 7061 7261 6d20  .        :param 
+00045510: 626f 6f6c 2072 6563 6f72 645f 7072 6f76  bool record_prov
+00045520: 656e 616e 6365 3a20 4966 2054 7275 652c  enance: If True,
+00045530: 2061 6464 2064 6574 6169 6c73 206f 6620   add details of 
+00045540: 7468 6973 206f 7065 7261 7469 6f6e 2074  this operation t
+00045550: 6f20 7468 650a 2020 2020 2020 2020 2020  o the.          
+00045560: 2020 7072 6f76 656e 616e 6365 2069 6e66    provenance inf
+00045570: 6f72 6d61 7469 6f6e 206f 6620 7468 6520  ormation of the 
+00045580: 7265 7475 726e 6564 2074 7265 6520 7365  returned tree se
+00045590: 7175 656e 6365 2e0a 2020 2020 2020 2020  quence..        
+000455a0: 2020 2020 2844 6566 6175 6c74 3a20 5472      (Default: Tr
+000455b0: 7565 292e 0a20 2020 2020 2020 203a 7274  ue)..        :rt
+000455c0: 7970 653a 2074 736b 6974 2e54 7265 6553  ype: tskit.TreeS
+000455d0: 6571 7565 6e63 650a 2020 2020 2020 2020  equence.        
+000455e0: 2222 220a 2020 2020 2020 2020 7461 626c  """.        tabl
+000455f0: 6573 203d 2073 656c 662e 6475 6d70 5f74  es = self.dump_t
+00045600: 6162 6c65 7328 290a 2020 2020 2020 2020  ables().        
+00045610: 7461 626c 6573 2e6b 6565 705f 696e 7465  tables.keep_inte
+00045620: 7276 616c 7328 696e 7465 7276 616c 732c  rvals(intervals,
+00045630: 2073 696d 706c 6966 792c 2072 6563 6f72   simplify, recor
+00045640: 645f 7072 6f76 656e 616e 6365 290a 2020  d_provenance).  
+00045650: 2020 2020 2020 7265 7475 726e 2074 6162        return tab
+00045660: 6c65 732e 7472 6565 5f73 6571 7565 6e63  les.tree_sequenc
+00045670: 6528 290a 0a20 2020 2064 6566 206c 7472  e()..    def ltr
+00045680: 696d 2873 656c 662c 2072 6563 6f72 645f  im(self, record_
+00045690: 7072 6f76 656e 616e 6365 3d54 7275 6529  provenance=True)
+000456a0: 3a0a 2020 2020 2020 2020 2222 220a 2020  :.        """.  
+000456b0: 2020 2020 2020 5265 7475 726e 7320 6120        Returns a 
+000456c0: 636f 7079 206f 6620 7468 6973 2074 7265  copy of this tre
+000456d0: 6520 7365 7175 656e 6365 2077 6974 6820  e sequence with 
+000456e0: 6120 706f 7465 6e74 6961 6c6c 7920 6368  a potentially ch
+000456f0: 616e 6765 6420 636f 6f72 6469 6e61 7465  anged coordinate
+00045700: 0a20 2020 2020 2020 2073 7973 7465 6d2c  .        system,
+00045710: 2073 7563 6820 7468 6174 2065 6d70 7479   such that empty
+00045720: 2072 6567 696f 6e73 2028 692e 652e 2c20   regions (i.e., 
+00045730: 7468 6f73 6520 6e6f 7420 636f 7665 7265  those not covere
+00045740: 6420 6279 2061 6e79 2065 6467 6529 2061  d by any edge) a
+00045750: 7420 7468 650a 2020 2020 2020 2020 7374  t the.        st
+00045760: 6172 7420 6f66 2074 6865 2074 7265 6520  art of the tree 
+00045770: 7365 7175 656e 6365 2061 7265 2074 7269  sequence are tri
+00045780: 6d6d 6564 2061 7761 792c 2061 6e64 2074  mmed away, and t
+00045790: 6865 206c 6566 746d 6f73 7420 6564 6765  he leftmost edge
+000457a0: 2073 7461 7274 7320 6174 0a20 2020 2020   starts at.     
+000457b0: 2020 2070 6f73 6974 696f 6e20 302e 2054     position 0. T
+000457c0: 6869 7320 6166 6665 6374 7320 7468 6520  his affects the 
+000457d0: 7265 706f 7274 6564 2070 6f73 6974 696f  reported positio
+000457e0: 6e20 6f66 2073 6974 6573 2061 6e64 0a20  n of sites and. 
+000457f0: 2020 2020 2020 2065 6467 6573 2e20 4164         edges. Ad
+00045800: 6469 7469 6f6e 616c 6c79 2c20 7369 7465  ditionally, site
+00045810: 7320 616e 6420 7468 6569 7220 6173 736f  s and their asso
+00045820: 6369 6174 6564 206d 7574 6174 696f 6e73  ciated mutations
+00045830: 2074 6f20 7468 6520 6c65 6674 206f 660a   to the left of.
+00045840: 2020 2020 2020 2020 7468 6520 6e65 7720          the new 
+00045850: 7a65 726f 2070 6f69 6e74 2061 7265 2074  zero point are t
+00045860: 6872 6f77 6e20 6177 6179 2e0a 0a20 2020  hrown away...   
+00045870: 2020 2020 203a 7061 7261 6d20 626f 6f6c       :param bool
+00045880: 2072 6563 6f72 645f 7072 6f76 656e 616e   record_provenan
+00045890: 6365 3a20 4966 2054 7275 652c 2061 6464  ce: If True, add
+000458a0: 2064 6574 6169 6c73 206f 6620 7468 6973   details of this
+000458b0: 206f 7065 7261 7469 6f6e 2074 6f20 7468   operation to th
+000458c0: 650a 2020 2020 2020 2020 2020 2020 7072  e.            pr
+000458d0: 6f76 656e 616e 6365 2069 6e66 6f72 6d61  ovenance informa
+000458e0: 7469 6f6e 206f 6620 7468 6520 7265 7475  tion of the retu
+000458f0: 726e 6564 2074 7265 6520 7365 7175 656e  rned tree sequen
+00045900: 6365 2e20 2844 6566 6175 6c74 3a20 5472  ce. (Default: Tr
+00045910: 7565 292e 0a20 2020 2020 2020 2022 2222  ue)..        """
+00045920: 0a20 2020 2020 2020 2074 6162 6c65 7320  .        tables 
+00045930: 3d20 7365 6c66 2e64 756d 705f 7461 626c  = self.dump_tabl
+00045940: 6573 2829 0a20 2020 2020 2020 2074 6162  es().        tab
+00045950: 6c65 732e 6c74 7269 6d28 7265 636f 7264  les.ltrim(record
+00045960: 5f70 726f 7665 6e61 6e63 6529 0a20 2020  _provenance).   
+00045970: 2020 2020 2072 6574 7572 6e20 7461 626c       return tabl
+00045980: 6573 2e74 7265 655f 7365 7175 656e 6365  es.tree_sequence
+00045990: 2829 0a0a 2020 2020 6465 6620 7274 7269  ()..    def rtri
+000459a0: 6d28 7365 6c66 2c20 7265 636f 7264 5f70  m(self, record_p
+000459b0: 726f 7665 6e61 6e63 653d 5472 7565 293a  rovenance=True):
+000459c0: 0a20 2020 2020 2020 2022 2222 0a20 2020  .        """.   
+000459d0: 2020 2020 2052 6574 7572 6e73 2061 2063       Returns a c
+000459e0: 6f70 7920 6f66 2074 6869 7320 7472 6565  opy of this tree
+000459f0: 2073 6571 7565 6e63 6520 7769 7468 2074   sequence with t
+00045a00: 6865 2060 6073 6571 7565 6e63 655f 6c65  he ``sequence_le
+00045a10: 6e67 7468 6060 2070 726f 7065 7274 7920  ngth`` property 
+00045a20: 7265 7365 740a 2020 2020 2020 2020 736f  reset.        so
+00045a30: 2074 6861 7420 7468 6520 7365 7175 656e   that the sequen
+00045a40: 6365 2065 6e64 7320 6174 2074 6865 2065  ce ends at the e
+00045a50: 6e64 206f 6620 7468 6520 7269 6768 746d  nd of the rightm
+00045a60: 6f73 7420 6564 6765 2e20 4164 6469 7469  ost edge. Additi
+00045a70: 6f6e 616c 6c79 2c20 7369 7465 730a 2020  onally, sites.  
+00045a80: 2020 2020 2020 616e 6420 7468 6569 7220        and their 
+00045a90: 6173 736f 6369 6174 6564 206d 7574 6174  associated mutat
+00045aa0: 696f 6e73 2061 7420 706f 7369 7469 6f6e  ions at position
+00045ab0: 7320 6772 6561 7465 7220 7468 616e 2074  s greater than t
+00045ac0: 6865 206e 6577 0a20 2020 2020 2020 2060  he new.        `
+00045ad0: 6073 6571 7565 6e63 655f 6c65 6e67 7468  `sequence_length
+00045ae0: 6060 2061 7265 2074 6872 6f77 6e20 6177  `` are thrown aw
+00045af0: 6179 2e0a 0a20 2020 2020 2020 203a 7061  ay...        :pa
+00045b00: 7261 6d20 626f 6f6c 2072 6563 6f72 645f  ram bool record_
+00045b10: 7072 6f76 656e 616e 6365 3a20 4966 2054  provenance: If T
+00045b20: 7275 652c 2061 6464 2064 6574 6169 6c73  rue, add details
+00045b30: 206f 6620 7468 6973 206f 7065 7261 7469   of this operati
+00045b40: 6f6e 2074 6f20 7468 650a 2020 2020 2020  on to the.      
+00045b50: 2020 2020 2020 7072 6f76 656e 616e 6365        provenance
+00045b60: 2069 6e66 6f72 6d61 7469 6f6e 206f 6620   information of 
+00045b70: 7468 6520 7265 7475 726e 6564 2074 7265  the returned tre
+00045b80: 6520 7365 7175 656e 6365 2e20 2844 6566  e sequence. (Def
+00045b90: 6175 6c74 3a20 5472 7565 292e 0a20 2020  ault: True)..   
+00045ba0: 2020 2020 2022 2222 0a20 2020 2020 2020       """.       
+00045bb0: 2074 6162 6c65 7320 3d20 7365 6c66 2e64   tables = self.d
+00045bc0: 756d 705f 7461 626c 6573 2829 0a20 2020  ump_tables().   
+00045bd0: 2020 2020 2074 6162 6c65 732e 7274 7269       tables.rtri
+00045be0: 6d28 7265 636f 7264 5f70 726f 7665 6e61  m(record_provena
+00045bf0: 6e63 6529 0a20 2020 2020 2020 2072 6574  nce).        ret
+00045c00: 7572 6e20 7461 626c 6573 2e74 7265 655f  urn tables.tree_
+00045c10: 7365 7175 656e 6365 2829 0a0a 2020 2020  sequence()..    
+00045c20: 6465 6620 7472 696d 2873 656c 662c 2072  def trim(self, r
+00045c30: 6563 6f72 645f 7072 6f76 656e 616e 6365  ecord_provenance
+00045c40: 3d54 7275 6529 3a0a 2020 2020 2020 2020  =True):.        
+00045c50: 2222 220a 2020 2020 2020 2020 5265 7475  """.        Retu
+00045c60: 726e 7320 6120 636f 7079 206f 6620 7468  rns a copy of th
+00045c70: 6973 2074 7265 6520 7365 7175 656e 6365  is tree sequence
+00045c80: 2077 6974 6820 616e 7920 656d 7074 7920   with any empty 
+00045c90: 7265 6769 6f6e 7320 2869 2e65 2e2c 2074  regions (i.e., t
+00045ca0: 686f 7365 206e 6f74 0a20 2020 2020 2020  hose not.       
+00045cb0: 2063 6f76 6572 6564 2062 7920 616e 7920   covered by any 
+00045cc0: 6564 6765 2920 6f6e 2074 6865 2072 6967  edge) on the rig
+00045cd0: 6874 2061 6e64 206c 6566 7420 7472 696d  ht and left trim
+00045ce0: 6d65 6420 6177 6179 2e20 5468 6973 206d  med away. This m
+00045cf0: 6179 2072 6573 6574 2062 6f74 6820 7468  ay reset both th
+00045d00: 650a 2020 2020 2020 2020 636f 6f72 6469  e.        coordi
+00045d10: 6e61 7465 2073 7973 7465 6d20 616e 6420  nate system and 
+00045d20: 7468 6520 6060 7365 7175 656e 6365 5f6c  the ``sequence_l
+00045d30: 656e 6774 6860 6020 7072 6f70 6572 7479  ength`` property
+00045d40: 2e20 4974 2069 7320 6675 6e63 7469 6f6e  . It is function
+00045d50: 616c 6c79 0a20 2020 2020 2020 2065 7175  ally.        equ
+00045d60: 6976 616c 656e 7420 746f 203a 6d65 7468  ivalent to :meth
+00045d70: 3a60 2e72 7472 696d 6020 666f 6c6c 6f77  :`.rtrim` follow
+00045d80: 6564 2062 7920 3a6d 6574 683a 602e 6c74  ed by :meth:`.lt
+00045d90: 7269 6d60 2e20 5369 7465 7320 616e 6420  rim`. Sites and 
+00045da0: 7468 6569 720a 2020 2020 2020 2020 6173  their.        as
+00045db0: 736f 6369 6174 6564 206d 7574 6174 696f  sociated mutatio
+00045dc0: 6e73 2069 6e20 7468 6520 656d 7074 7920  ns in the empty 
+00045dd0: 7265 6769 6f6e 7320 6172 6520 7468 726f  regions are thro
+00045de0: 776e 2061 7761 792e 0a0a 2020 2020 2020  wn away...      
+00045df0: 2020 3a70 6172 616d 2062 6f6f 6c20 7265    :param bool re
+00045e00: 636f 7264 5f70 726f 7665 6e61 6e63 653a  cord_provenance:
+00045e10: 2049 6620 5472 7565 2c20 6164 6420 6465   If True, add de
+00045e20: 7461 696c 7320 6f66 2074 6869 7320 6f70  tails of this op
+00045e30: 6572 6174 696f 6e20 746f 2074 6865 0a20  eration to the. 
+00045e40: 2020 2020 2020 2020 2020 2070 726f 7665             prove
+00045e50: 6e61 6e63 6520 696e 666f 726d 6174 696f  nance informatio
+00045e60: 6e20 6f66 2074 6865 2072 6574 7572 6e65  n of the returne
+00045e70: 6420 7472 6565 2073 6571 7565 6e63 652e  d tree sequence.
+00045e80: 2028 4465 6661 756c 743a 2054 7275 6529   (Default: True)
+00045e90: 2e0a 2020 2020 2020 2020 2222 220a 2020  ..        """.  
+00045ea0: 2020 2020 2020 7461 626c 6573 203d 2073        tables = s
+00045eb0: 656c 662e 6475 6d70 5f74 6162 6c65 7328  elf.dump_tables(
+00045ec0: 290a 2020 2020 2020 2020 7461 626c 6573  ).        tables
+00045ed0: 2e74 7269 6d28 7265 636f 7264 5f70 726f  .trim(record_pro
+00045ee0: 7665 6e61 6e63 6529 0a20 2020 2020 2020  venance).       
+00045ef0: 2072 6574 7572 6e20 7461 626c 6573 2e74   return tables.t
+00045f00: 7265 655f 7365 7175 656e 6365 2829 0a0a  ree_sequence()..
+00045f10: 2020 2020 6465 6620 7370 6c69 745f 6564      def split_ed
+00045f20: 6765 7328 7365 6c66 2c20 7469 6d65 2c20  ges(self, time, 
+00045f30: 2a2c 2066 6c61 6773 3d4e 6f6e 652c 2070  *, flags=None, p
+00045f40: 6f70 756c 6174 696f 6e3d 4e6f 6e65 2c20  opulation=None, 
+00045f50: 6d65 7461 6461 7461 3d4e 6f6e 6529 3a0a  metadata=None):.
+00045f60: 2020 2020 2020 2020 2222 220a 2020 2020          """.    
+00045f70: 2020 2020 5265 7475 726e 7320 6120 636f      Returns a co
+00045f80: 7079 206f 6620 7468 6973 2074 7265 6520  py of this tree 
+00045f90: 7365 7175 656e 6365 2069 6e20 7768 6963  sequence in whic
+00045fa0: 6820 7765 2072 6570 6c61 6365 2061 6e79  h we replace any
+00045fb0: 0a20 2020 2020 2020 2065 6467 6520 6060  .        edge ``
+00045fc0: 286c 6566 742c 2072 6967 6874 2c20 7061  (left, right, pa
+00045fd0: 7265 6e74 2c20 6368 696c 6429 6060 2069  rent, child)`` i
+00045fe0: 6e20 7768 6963 680a 2020 2020 2020 2020  n which.        
+00045ff0: 6060 6e6f 6465 5f74 696d 655b 6368 696c  ``node_time[chil
+00046000: 645d 203c 2074 696d 6520 3c20 6e6f 6465  d] < time < node
+00046010: 5f74 696d 655b 7061 7265 6e74 5d60 6020  _time[parent]`` 
+00046020: 7769 7468 2074 776f 2065 6467 6573 0a20  with two edges. 
+00046030: 2020 2020 2020 2060 6028 6c65 6674 2c20         ``(left, 
+00046040: 7269 6768 742c 2070 6172 656e 742c 2075  right, parent, u
+00046050: 2960 6020 616e 6420 6060 286c 6566 742c  )`` and ``(left,
+00046060: 2072 6967 6874 2c20 752c 2063 6869 6c64   right, u, child
+00046070: 2960 602c 0a20 2020 2020 2020 2077 6865  )``,.        whe
+00046080: 7265 2060 6075 6060 2069 7320 6120 6e65  re ``u`` is a ne
+00046090: 776c 7920 6164 6465 6420 6e6f 6465 2066  wly added node f
+000460a0: 6f72 2065 6163 6820 696e 7465 7273 6563  or each intersec
+000460b0: 7469 6e67 2065 6467 652e 0a0a 2020 2020  ting edge...    
+000460c0: 2020 2020 4966 2060 606d 6574 6164 6174      If ``metadat
+000460d0: 6160 602c 2060 6066 6c61 6773 6060 2c20  a``, ``flags``, 
+000460e0: 6f72 2060 6070 6f70 756c 6174 696f 6e60  or ``population`
+000460f0: 6020 6172 6520 7370 6563 6966 6965 642c  ` are specified,
+00046100: 206e 6577 6c79 0a20 2020 2020 2020 2061   newly.        a
+00046110: 6464 6564 206e 6f64 6573 2077 696c 6c20  dded nodes will 
+00046120: 6265 2061 7373 6967 6e65 6420 7468 6573  be assigned thes
+00046130: 6520 7661 6c75 6573 2e20 4f74 6865 7277  e values. Otherw
+00046140: 6973 652c 2064 6566 6175 6c74 2076 616c  ise, default val
+00046150: 7565 730a 2020 2020 2020 2020 7769 6c6c  ues.        will
+00046160: 2062 6520 7573 6564 2e20 5468 6520 6465   be used. The de
+00046170: 6661 756c 7420 6d65 7461 6461 7461 2069  fault metadata i
+00046180: 7320 616e 2065 6d70 7479 2064 6963 7469  s an empty dicti
+00046190: 6f6e 6172 7920 6966 2061 206d 6574 6164  onary if a metad
+000461a0: 6174 610a 2020 2020 2020 2020 7363 6865  ata.        sche
+000461b0: 6d61 2069 7320 6465 6669 6e65 6420 666f  ma is defined fo
+000461c0: 7220 7468 6520 6e6f 6465 2074 6162 6c65  r the node table
+000461d0: 2c20 616e 6420 6973 2061 6e20 656d 7074  , and is an empt
+000461e0: 7920 6279 7465 2073 7472 696e 670a 2020  y byte string.  
+000461f0: 2020 2020 2020 6f74 6865 7277 6973 652e        otherwise.
+00046200: 2054 6865 2064 6566 6175 6c74 2070 6f70   The default pop
+00046210: 756c 6174 696f 6e20 666f 7220 7468 6520  ulation for the 
+00046220: 6e65 7720 6e6f 6465 2069 730a 2020 2020  new node is.    
+00046230: 2020 2020 3a64 6174 613a 6074 736b 6974      :data:`tskit
+00046240: 2e4e 554c 4c60 2e20 4e65 776c 7920 6164  .NULL`. Newly ad
+00046250: 6465 6420 6861 7665 2061 2064 6566 6175  ded have a defau
+00046260: 6c74 2060 6066 6c61 6773 6060 2076 616c  lt ``flags`` val
+00046270: 7565 206f 6620 302e 0a0a 2020 2020 2020  ue of 0...      
+00046280: 2020 416e 7920 6d65 7461 6461 7461 2061    Any metadata a
+00046290: 7373 6f63 6961 7465 6420 7769 7468 2061  ssociated with a
+000462a0: 2073 706c 6974 2065 6467 6520 7769 6c6c   split edge will
+000462b0: 2062 6520 636f 7069 6564 2074 6f20 7468   be copied to th
+000462c0: 6520 6e65 7720 6564 6765 2e0a 0a20 2020  e new edge...   
+000462d0: 2020 2020 202e 2e20 7761 726e 696e 673a       .. warning:
+000462e0: 3a20 5468 6973 206d 6574 686f 6420 6375  : This method cu
+000462f0: 7272 656e 746c 7920 646f 6573 206e 6f74  rrently does not
+00046300: 2073 7570 706f 7274 206d 6967 7261 7469   support migrati
+00046310: 6f6e 730a 2020 2020 2020 2020 2020 2020  ons.            
+00046320: 616e 6420 6120 6572 726f 7220 7769 6c6c  and a error will
+00046330: 2062 6520 7261 6973 6564 2069 6620 7468   be raised if th
+00046340: 6520 6d69 6772 6174 696f 6e20 7461 626c  e migration tabl
+00046350: 6520 6973 206e 6f74 0a20 2020 2020 2020  e is not.       
+00046360: 2020 2020 2065 6d70 7479 2e20 4675 7475       empty. Futu
+00046370: 7265 2076 6572 7369 6f6e 7320 6d61 7920  re versions may 
+00046380: 7461 6b65 206d 6967 7261 7469 6f6e 7320  take migrations 
+00046390: 7468 6174 2069 6e74 6572 7365 6374 2077  that intersect w
+000463a0: 6974 6820 7468 650a 2020 2020 2020 2020  ith the.        
+000463b0: 2020 2020 6564 6765 2069 6e74 6f20 6163      edge into ac
+000463c0: 636f 756e 7420 7768 656e 2064 6574 6572  count when deter
+000463d0: 6d69 6e69 6e67 2074 6865 2064 6566 6175  mining the defau
+000463e0: 6c74 2070 6f70 756c 6174 696f 6e0a 2020  lt population.  
+000463f0: 2020 2020 2020 2020 2020 6173 7369 676e            assign
+00046400: 6d65 6e74 7320 666f 7220 6e65 7720 6e6f  ments for new no
+00046410: 6465 732e 0a0a 2020 2020 2020 2020 416e  des...        An
+00046420: 7920 6d75 7461 7469 6f6e 7320 6c79 696e  y mutations lyin
+00046430: 6720 6f6e 2074 6865 2065 6467 6520 7768  g on the edge wh
+00046440: 6f73 6520 7469 6d65 2069 7320 3e3d 2060  ose time is >= `
+00046450: 6074 696d 6560 6020 7769 6c6c 2068 6176  `time`` will hav
+00046460: 650a 2020 2020 2020 2020 7468 6569 7220  e.        their 
+00046470: 6e6f 6465 2076 616c 7565 2073 6574 2074  node value set t
+00046480: 6f20 6060 7560 602e 204e 6f74 6520 7468  o ``u``. Note th
+00046490: 6174 2074 6865 2074 696d 6520 6f66 2074  at the time of t
+000464a0: 6865 206d 7574 6174 696f 6e20 6973 0a20  he mutation is. 
+000464b0: 2020 2020 2020 2064 6566 696e 6564 2061         defined a
+000464c0: 7320 7468 6520 7469 6d65 206f 6620 7468  s the time of th
+000464d0: 6520 6368 696c 6420 6e6f 6465 2069 6620  e child node if 
+000464e0: 7468 6520 6d75 7461 7469 6f6e 2773 2074  the mutation's t
+000464f0: 696d 6520 6973 0a20 2020 2020 2020 2075  ime is.        u
+00046500: 6e6b 6e6f 776e 2e0a 0a20 2020 2020 2020  nknown...       
+00046510: 203a 7061 7261 6d20 666c 6f61 7420 7469   :param float ti
+00046520: 6d65 3a20 5468 6520 6375 746f 6666 2074  me: The cutoff t
+00046530: 696d 652e 0a20 2020 2020 2020 203a 7061  ime..        :pa
+00046540: 7261 6d20 696e 7420 666c 6167 733a 2054  ram int flags: T
+00046550: 6865 2066 6c61 6773 2076 616c 7565 2066  he flags value f
+00046560: 6f72 206e 6577 6c79 2d69 6e73 6572 7465  or newly-inserte
+00046570: 6420 6e6f 6465 732e 2028 4465 6661 756c  d nodes. (Defaul
+00046580: 7420 3d20 3029 0a20 2020 2020 2020 203a  t = 0).        :
+00046590: 7061 7261 6d20 696e 7420 706f 7075 6c61  param int popula
+000465a0: 7469 6f6e 3a20 5468 6520 706f 7075 6c61  tion: The popula
+000465b0: 7469 6f6e 2076 616c 7565 2066 6f72 206e  tion value for n
+000465c0: 6577 6c79 2069 6e73 6572 7465 6420 6e6f  ewly inserted no
+000465d0: 6465 732e 0a20 2020 2020 2020 2020 2020  des..           
+000465e0: 2044 6566 6175 6c74 7320 746f 2060 6074   Defaults to ``t
+000465f0: 736b 6974 2e4e 554c 4c60 6020 6966 206e  skit.NULL`` if n
+00046600: 6f74 2073 7065 6369 6669 6564 2e0a 2020  ot specified..  
+00046610: 2020 2020 2020 3a70 6172 616d 206d 6574        :param met
+00046620: 6164 6174 613a 2054 6865 206d 6574 6164  adata: The metad
+00046630: 6174 6120 666f 7220 616e 7920 6e65 776c  ata for any newl
+00046640: 7920 696e 7365 7274 6564 206e 6f64 6573  y inserted nodes
+00046650: 2e20 5365 650a 2020 2020 2020 2020 2020  . See.          
+00046660: 2020 3a6d 6574 683a 602e 4e6f 6465 5461    :meth:`.NodeTa
+00046670: 626c 652e 6164 645f 726f 7760 2066 6f72  ble.add_row` for
+00046680: 2064 6574 6169 6c73 206f 6e20 686f 7720   details on how 
+00046690: 6465 6661 756c 7420 6d65 7461 6461 7461  default metadata
+000466a0: 0a20 2020 2020 2020 2020 2020 2069 7320  .            is 
+000466b0: 7072 6f64 7563 6564 2066 6f72 2061 2067  produced for a g
+000466c0: 6976 656e 2073 6368 656d 6120 286f 7220  iven schema (or 
+000466d0: 6e6f 6e65 292e 0a20 2020 2020 2020 203a  none)..        :
+000466e0: 7265 7475 726e 3a20 4120 636f 7079 206f  return: A copy o
+000466f0: 6620 7468 6973 2074 7265 6520 7365 7175  f this tree sequ
+00046700: 656e 6365 2077 6974 6820 6564 6765 7320  ence with edges 
+00046710: 7370 6c69 7420 6174 2074 6865 2073 7065  split at the spe
+00046720: 6369 6669 6564 2074 696d 652e 0a20 2020  cified time..   
+00046730: 2020 2020 203a 7274 7970 653a 2074 736b       :rtype: tsk
+00046740: 6974 2e54 7265 6553 6571 7565 6e63 650a  it.TreeSequence.
+00046750: 2020 2020 2020 2020 2222 220a 2020 2020          """.    
+00046760: 2020 2020 706f 7075 6c61 7469 6f6e 203d      population =
+00046770: 2074 736b 6974 2e4e 554c 4c20 6966 2070   tskit.NULL if p
+00046780: 6f70 756c 6174 696f 6e20 6973 204e 6f6e  opulation is Non
+00046790: 6520 656c 7365 2070 6f70 756c 6174 696f  e else populatio
+000467a0: 6e0a 2020 2020 2020 2020 666c 6167 7320  n.        flags 
+000467b0: 3d20 3020 6966 2066 6c61 6773 2069 7320  = 0 if flags is 
+000467c0: 4e6f 6e65 2065 6c73 6520 666c 6167 730a  None else flags.
+000467d0: 2020 2020 2020 2020 7363 6865 6d61 203d          schema =
+000467e0: 2073 656c 662e 7461 626c 655f 6d65 7461   self.table_meta
+000467f0: 6461 7461 5f73 6368 656d 6173 2e6e 6f64  data_schemas.nod
+00046800: 650a 2020 2020 2020 2020 6966 206d 6574  e.        if met
+00046810: 6164 6174 6120 6973 204e 6f6e 653a 0a20  adata is None:. 
+00046820: 2020 2020 2020 2020 2020 206d 6574 6164             metad
+00046830: 6174 6120 3d20 7363 6865 6d61 2e65 6d70  ata = schema.emp
+00046840: 7479 5f76 616c 7565 0a20 2020 2020 2020  ty_value.       
+00046850: 206d 6574 6164 6174 6120 3d20 7363 6865   metadata = sche
+00046860: 6d61 2e76 616c 6964 6174 655f 616e 645f  ma.validate_and_
+00046870: 656e 636f 6465 5f72 6f77 286d 6574 6164  encode_row(metad
+00046880: 6174 6129 0a20 2020 2020 2020 206c 6c5f  ata).        ll_
+00046890: 7473 203d 2073 656c 662e 5f6c 6c5f 7472  ts = self._ll_tr
+000468a0: 6565 5f73 6571 7565 6e63 652e 7370 6c69  ee_sequence.spli
+000468b0: 745f 6564 6765 7328 0a20 2020 2020 2020  t_edges(.       
+000468c0: 2020 2020 2074 696d 653d 7469 6d65 2c0a       time=time,.
+000468d0: 2020 2020 2020 2020 2020 2020 666c 6167              flag
+000468e0: 733d 666c 6167 732c 0a20 2020 2020 2020  s=flags,.       
+000468f0: 2020 2020 2070 6f70 756c 6174 696f 6e3d       population=
+00046900: 706f 7075 6c61 7469 6f6e 2c0a 2020 2020  population,.    
+00046910: 2020 2020 2020 2020 6d65 7461 6461 7461          metadata
+00046920: 3d6d 6574 6164 6174 612c 0a20 2020 2020  =metadata,.     
+00046930: 2020 2029 0a20 2020 2020 2020 2072 6574     ).        ret
+00046940: 7572 6e20 5472 6565 5365 7175 656e 6365  urn TreeSequence
+00046950: 286c 6c5f 7473 290a 0a20 2020 2064 6566  (ll_ts)..    def
+00046960: 2064 6563 6170 6974 6174 6528 7365 6c66   decapitate(self
+00046970: 2c20 7469 6d65 2c20 2a2c 2066 6c61 6773  , time, *, flags
+00046980: 3d4e 6f6e 652c 2070 6f70 756c 6174 696f  =None, populatio
+00046990: 6e3d 4e6f 6e65 2c20 6d65 7461 6461 7461  n=None, metadata
+000469a0: 3d4e 6f6e 6529 3a0a 2020 2020 2020 2020  =None):.        
+000469b0: 2222 220a 2020 2020 2020 2020 4465 6c65  """.        Dele
+000469c0: 7465 2061 6c6c 2065 6467 6520 746f 706f  te all edge topo
+000469d0: 6c6f 6779 2061 6e64 206d 7574 6174 696f  logy and mutatio
+000469e0: 6e61 6c20 696e 666f 726d 6174 696f 6e20  nal information 
+000469f0: 6174 206c 6561 7374 2061 7320 6f6c 640a  at least as old.
+00046a00: 2020 2020 2020 2020 6173 2074 6865 2073          as the s
+00046a10: 7065 6369 6669 6564 2074 696d 6520 6672  pecified time fr
+00046a20: 6f6d 2074 6869 7320 7472 6565 2073 6571  om this tree seq
+00046a30: 7565 6e63 652e 0a0a 2020 2020 2020 2020  uence...        
+00046a40: 5265 6d6f 7665 7320 616c 6c20 6564 6765  Removes all edge
+00046a50: 7320 696e 2077 6869 6368 2074 6865 2074  s in which the t
+00046a60: 696d 6520 6f66 2074 6865 2063 6869 6c64  ime of the child
+00046a70: 2069 7320 3e3d 2074 6865 2073 7065 6369   is >= the speci
+00046a80: 6669 6564 0a20 2020 2020 2020 2074 696d  fied.        tim
+00046a90: 6520 6060 7460 602c 2061 6e64 2062 7265  e ``t``, and bre
+00046aa0: 616b 7320 6564 6765 7320 7468 6174 2069  aks edges that i
+00046ab0: 6e74 6572 7365 6374 2077 6974 6820 6060  ntersect with ``
+00046ac0: 7460 602e 2046 6f72 2065 6163 6820 6564  t``. For each ed
+00046ad0: 6765 0a20 2020 2020 2020 2069 6e74 6572  ge.        inter
+00046ae0: 7365 6374 696e 6720 7769 7468 2060 6074  secting with ``t
+00046af0: 6060 2077 6520 6372 6561 7465 2061 206e  `` we create a n
+00046b00: 6577 206e 6f64 6520 7769 7468 2074 696d  ew node with tim
+00046b10: 6520 6571 7561 6c20 746f 2060 6074 6060  e equal to ``t``
+00046b20: 2c0a 2020 2020 2020 2020 616e 6420 7365  ,.        and se
+00046b30: 7420 7468 6520 7061 7265 6e74 206f 6620  t the parent of 
+00046b40: 7468 6520 6564 6765 2074 6f20 7468 6973  the edge to this
+00046b50: 206e 6577 206e 6f64 652e 2054 6865 206e   new node. The n
+00046b60: 6f64 6520 7461 626c 650a 2020 2020 2020  ode table.      
+00046b70: 2020 6973 206e 6f74 2061 6c74 6572 6564    is not altered
+00046b80: 2069 6e20 616e 7920 6f74 6865 7220 7761   in any other wa
+00046b90: 792e 204e 6577 6c79 2061 6464 6564 206e  y. Newly added n
+00046ba0: 6f64 6573 2068 6176 6520 7661 6c75 6573  odes have values
+00046bb0: 0a20 2020 2020 2020 2066 6f72 2060 6066  .        for ``f
+00046bc0: 6c61 6773 6060 2c20 6060 706f 7075 6c61  lags``, ``popula
+00046bd0: 7469 6f6e 6060 2061 6e64 2060 606d 6574  tion`` and ``met
+00046be0: 6164 6174 6160 6020 636f 6e74 726f 6c6c  adata`` controll
+00046bf0: 6564 2062 7920 7061 7261 6d65 7465 7273  ed by parameters
+00046c00: 0a20 2020 2020 2020 2074 6f20 7468 6973  .        to this
+00046c10: 2066 756e 6374 696f 6e20 696e 2074 6865   function in the
+00046c20: 2073 616d 6520 7761 7920 6173 203a 6d65   same way as :me
+00046c30: 7468 3a60 2e73 706c 6974 5f65 6467 6573  th:`.split_edges
+00046c40: 602e 0a0a 2020 2020 2020 2020 2e2e 206e  `...        .. n
+00046c50: 6f74 653a 3a0a 2020 2020 2020 2020 2020  ote::.          
+00046c60: 2020 4e6f 7465 2074 6861 7420 6561 6368    Note that each
+00046c70: 2065 6467 6520 6973 2074 7265 6174 6564   edge is treated
+00046c80: 2069 6e64 6570 656e 6465 6e74 6c79 2c20   independently, 
+00046c90: 736f 2074 6861 7420 6576 656e 2069 6620  so that even if 
+00046ca0: 7477 6f0a 2020 2020 2020 2020 2020 2020  two.            
+00046cb0: 6564 6765 7320 7468 6174 2061 7265 2062  edges that are b
+00046cc0: 726f 6b65 6e20 6279 2074 6869 7320 6f70  roken by this op
+00046cd0: 6572 6174 696f 6e20 7368 6172 6520 7468  eration share th
+00046ce0: 6520 7361 6d65 2070 6172 656e 7420 616e  e same parent an
+00046cf0: 640a 2020 2020 2020 2020 2020 2020 6368  d.            ch
+00046d00: 696c 6420 6e6f 6465 732c 2074 6865 7265  ild nodes, there
+00046d10: 2077 696c 6c20 6265 2074 776f 2064 6966   will be two dif
+00046d20: 6665 7265 6e74 206e 6577 2070 6172 656e  ferent new paren
+00046d30: 7420 6e6f 6465 7320 696e 7365 7274 6564  t nodes inserted
+00046d40: 2e0a 0a20 2020 2020 2020 2041 6e79 206d  ...        Any m
+00046d50: 7574 6174 696f 6e20 7768 6f73 6520 7469  utation whose ti
+00046d60: 6d65 2069 7320 3e3d 2060 6074 6060 2077  me is >= ``t`` w
+00046d70: 696c 6c20 6265 2072 656d 6f76 6564 2e20  ill be removed. 
+00046d80: 4120 6d75 7461 7469 6f6e 2773 2074 696d  A mutation's tim
+00046d90: 650a 2020 2020 2020 2020 6973 2069 7473  e.        is its
+00046da0: 2061 7373 6f63 6961 7465 6420 6060 7469   associated ``ti
+00046db0: 6d65 6060 2076 616c 7565 2c20 6f72 2074  me`` value, or t
+00046dc0: 6865 2074 696d 6520 6f66 2069 7473 206e  he time of its n
+00046dd0: 6f64 6520 6966 2074 6865 0a20 2020 2020  ode if the.     
+00046de0: 2020 206d 7574 6174 696f 6e27 7320 7469     mutation's ti
+00046df0: 6d65 2077 6173 206d 6172 6b65 6420 6173  me was marked as
+00046e00: 2075 6e6b 6e6f 776e 2028 3a64 6174 613a   unknown (:data:
+00046e10: 6055 4e4b 4e4f 574e 5f54 494d 4560 292e  `UNKNOWN_TIME`).
+00046e20: 0a0a 2020 2020 2020 2020 4d69 6772 6174  ..        Migrat
+00046e30: 696f 6e73 2061 7265 206e 6f74 2073 7570  ions are not sup
+00046e40: 706f 7274 6564 2c20 616e 6420 6120 4c69  ported, and a Li
+00046e50: 6272 6172 7945 7272 6f72 2077 696c 6c20  braryError will 
+00046e60: 6265 2072 6169 7365 2069 660a 2020 2020  be raise if.    
+00046e70: 2020 2020 6361 6c6c 6564 206f 6e20 6120      called on a 
+00046e80: 7472 6565 2073 6571 7565 6e63 6520 636f  tree sequence co
+00046e90: 6e74 6169 6e69 6e67 206d 6967 7261 7469  ntaining migrati
+00046ea0: 6f6e 2069 6e66 6f72 6d61 7469 6f6e 2e0a  on information..
+00046eb0: 0a20 2020 2020 2020 202e 2e20 7365 6561  .        .. seea
+00046ec0: 6c73 6f3a 3a20 5468 6973 206d 6574 686f  lso:: This metho
+00046ed0: 6420 6973 2069 6d70 6c65 6d65 6e74 6564  d is implemented
+00046ee0: 2075 7369 6e67 2074 6865 203a 6d65 7468   using the :meth
+00046ef0: 3a60 2e73 706c 6974 5f65 6467 6573 600a  :`.split_edges`.
+00046f00: 2020 2020 2020 2020 2020 2020 616e 6420              and 
+00046f10: 3a6d 6574 683a 6054 6162 6c65 436f 6c6c  :meth:`TableColl
+00046f20: 6563 7469 6f6e 2e64 656c 6574 655f 6f6c  ection.delete_ol
+00046f30: 6465 7260 2066 756e 6374 696f 6e73 2e0a  der` functions..
+00046f40: 0a20 2020 2020 2020 203a 7061 7261 6d20  .        :param 
+00046f50: 666c 6f61 7420 7469 6d65 3a20 5468 6520  float time: The 
+00046f60: 6375 746f 6666 2074 696d 652e 0a20 2020  cutoff time..   
+00046f70: 2020 2020 203a 7061 7261 6d20 696e 7420       :param int 
+00046f80: 666c 6167 733a 2054 6865 2066 6c61 6773  flags: The flags
+00046f90: 2076 616c 7565 2066 6f72 206e 6577 6c79   value for newly
+00046fa0: 2d69 6e73 6572 7465 6420 6e6f 6465 732e  -inserted nodes.
+00046fb0: 2028 4465 6661 756c 7420 3d20 3029 0a20   (Default = 0). 
+00046fc0: 2020 2020 2020 203a 7061 7261 6d20 696e         :param in
+00046fd0: 7420 706f 7075 6c61 7469 6f6e 3a20 5468  t population: Th
+00046fe0: 6520 706f 7075 6c61 7469 6f6e 2076 616c  e population val
+00046ff0: 7565 2066 6f72 206e 6577 6c79 2069 6e73  ue for newly ins
+00047000: 6572 7465 6420 6e6f 6465 732e 0a20 2020  erted nodes..   
+00047010: 2020 2020 2020 2020 2044 6566 6175 6c74           Default
+00047020: 7320 746f 2060 6074 736b 6974 2e4e 554c  s to ``tskit.NUL
+00047030: 4c60 6020 6966 206e 6f74 2073 7065 6369  L`` if not speci
+00047040: 6669 6564 2e0a 2020 2020 2020 2020 3a70  fied..        :p
+00047050: 6172 616d 206d 6574 6164 6174 613a 2054  aram metadata: T
+00047060: 6865 206d 6574 6164 6174 6120 666f 7220  he metadata for 
+00047070: 616e 7920 6e65 776c 7920 696e 7365 7274  any newly insert
+00047080: 6564 206e 6f64 6573 2e20 5365 650a 2020  ed nodes. See.  
+00047090: 2020 2020 2020 2020 2020 3a6d 6574 683a            :meth:
+000470a0: 602e 4e6f 6465 5461 626c 652e 6164 645f  `.NodeTable.add_
+000470b0: 726f 7760 2066 6f72 2064 6574 6169 6c73  row` for details
+000470c0: 206f 6e20 686f 7720 6465 6661 756c 7420   on how default 
+000470d0: 6d65 7461 6461 7461 0a20 2020 2020 2020  metadata.       
+000470e0: 2020 2020 2069 7320 7072 6f64 7563 6564       is produced
+000470f0: 2066 6f72 2061 2067 6976 656e 2073 6368   for a given sch
+00047100: 656d 6120 286f 7220 6e6f 6e65 292e 0a20  ema (or none).. 
+00047110: 2020 2020 2020 203a 7265 7475 726e 3a20         :return: 
+00047120: 4120 636f 7079 206f 6620 7468 6973 2074  A copy of this t
+00047130: 7265 6520 7365 7175 656e 6365 2077 6974  ree sequence wit
+00047140: 6820 6564 6765 7320 7370 6c69 7420 6174  h edges split at
+00047150: 2074 6865 2073 7065 6369 6669 6564 2074   the specified t
+00047160: 696d 652e 0a20 2020 2020 2020 203a 7274  ime..        :rt
+00047170: 7970 653a 2074 736b 6974 2e54 7265 6553  ype: tskit.TreeS
+00047180: 6571 7565 6e63 650a 2020 2020 2020 2020  equence.        
+00047190: 2222 220a 2020 2020 2020 2020 7370 6c69  """.        spli
+000471a0: 745f 7473 203d 2073 656c 662e 7370 6c69  t_ts = self.spli
+000471b0: 745f 6564 6765 7328 0a20 2020 2020 2020  t_edges(.       
+000471c0: 2020 2020 2074 696d 652c 2066 6c61 6773       time, flags
+000471d0: 3d66 6c61 6773 2c20 706f 7075 6c61 7469  =flags, populati
+000471e0: 6f6e 3d70 6f70 756c 6174 696f 6e2c 206d  on=population, m
+000471f0: 6574 6164 6174 613d 6d65 7461 6461 7461  etadata=metadata
+00047200: 0a20 2020 2020 2020 2029 0a20 2020 2020  .        ).     
+00047210: 2020 2074 6162 6c65 7320 3d20 7370 6c69     tables = spli
+00047220: 745f 7473 2e64 756d 705f 7461 626c 6573  t_ts.dump_tables
+00047230: 2829 0a20 2020 2020 2020 2064 656c 2073  ().        del s
+00047240: 706c 6974 5f74 730a 2020 2020 2020 2020  plit_ts.        
+00047250: 7461 626c 6573 2e64 656c 6574 655f 6f6c  tables.delete_ol
+00047260: 6465 7228 7469 6d65 290a 2020 2020 2020  der(time).      
+00047270: 2020 7265 7475 726e 2074 6162 6c65 732e    return tables.
+00047280: 7472 6565 5f73 6571 7565 6e63 6528 290a  tree_sequence().
+00047290: 0a20 2020 2064 6566 2073 7562 7365 7428  .    def subset(
+000472a0: 0a20 2020 2020 2020 2073 656c 662c 0a20  .        self,. 
+000472b0: 2020 2020 2020 206e 6f64 6573 2c0a 2020         nodes,.  
+000472c0: 2020 2020 2020 7265 636f 7264 5f70 726f        record_pro
+000472d0: 7665 6e61 6e63 653d 5472 7565 2c0a 2020  venance=True,.  
+000472e0: 2020 2020 2020 7265 6f72 6465 725f 706f        reorder_po
+000472f0: 7075 6c61 7469 6f6e 733d 5472 7565 2c0a  pulations=True,.
+00047300: 2020 2020 2020 2020 7265 6d6f 7665 5f75          remove_u
+00047310: 6e72 6566 6572 656e 6365 643d 5472 7565  nreferenced=True
+00047320: 2c0a 2020 2020 293a 0a20 2020 2020 2020  ,.    ):.       
+00047330: 2022 2222 0a20 2020 2020 2020 2052 6574   """.        Ret
+00047340: 7572 6e73 2061 2074 7265 6520 7365 7175  urns a tree sequ
+00047350: 656e 6365 2063 6f6e 7461 696e 696e 6720  ence containing 
+00047360: 6f6e 6c79 2069 6e66 6f72 6d61 7469 6f6e  only information
+00047370: 2064 6972 6563 746c 790a 2020 2020 2020   directly.      
+00047380: 2020 7265 6665 7265 6e63 696e 6720 7468    referencing th
+00047390: 6520 7072 6f76 6964 6564 206c 6973 7420  e provided list 
+000473a0: 6f66 206e 6f64 6573 2074 6f20 7265 7461  of nodes to reta
+000473b0: 696e 2e20 2054 6865 2072 6573 756c 7420  in.  The result 
+000473c0: 7769 6c6c 0a20 2020 2020 2020 2072 6574  will.        ret
+000473d0: 6169 6e20 6f6e 6c79 2074 6865 206e 6f64  ain only the nod
+000473e0: 6573 2077 686f 7365 2049 4473 2061 7265  es whose IDs are
+000473f0: 206c 6973 7465 6420 696e 2060 606e 6f64   listed in ``nod
+00047400: 6573 6060 2c20 6f6e 6c79 2065 6467 6573  es``, only edges
+00047410: 2066 6f72 0a20 2020 2020 2020 2077 6869   for.        whi
+00047420: 6368 2062 6f74 6820 7061 7265 6e74 2061  ch both parent a
+00047430: 6e64 2063 6869 6c64 2061 7265 2069 6e20  nd child are in 
+00047440: 6060 6e6f 6465 7360 6060 2c20 6f6e 6c79  ``nodes```, only
+00047450: 206d 7574 6174 696f 6e73 2077 686f 7365   mutations whose
+00047460: 0a20 2020 2020 2020 206e 6f64 6520 6973  .        node is
+00047470: 2069 6e20 6060 6e6f 6465 7360 602c 2061   in ``nodes``, a
+00047480: 6e64 206f 6e6c 7920 696e 6469 7669 6475  nd only individu
+00047490: 616c 7320 7468 6174 2061 7265 2072 6566  als that are ref
+000474a0: 6572 7265 6420 746f 2062 7920 6f6e 650a  erred to by one.
+000474b0: 2020 2020 2020 2020 6f66 2074 6865 2072          of the r
+000474c0: 6574 6169 6e65 6420 6e6f 6465 732e 2020  etained nodes.  
+000474d0: 4e6f 7465 2074 6861 7420 7468 6973 2064  Note that this d
+000474e0: 6f65 7320 2a6e 6f74 2a20 7265 7461 696e  oes *not* retain
+000474f0: 0a20 2020 2020 2020 2074 6865 2061 6e63  .        the anc
+00047500: 6573 7472 7920 6f66 2074 6865 7365 206e  estry of these n
+00047510: 6f64 6573 202d 2066 6f72 2074 6861 742c  odes - for that,
+00047520: 2073 6565 203a 6d65 7468 3a60 2e73 696d   see :meth:`.sim
+00047530: 706c 6966 7960 2e0a 0a20 2020 2020 2020  plify`...       
+00047540: 2054 6869 7320 6861 7320 7468 6520 7369   This has the si
+00047550: 6465 2065 6666 6563 7420 7468 6174 2069  de effect that i
+00047560: 7420 6d61 7920 6368 616e 6765 2074 6865  t may change the
+00047570: 206f 7264 6572 206f 6620 7468 6520 6e6f   order of the no
+00047580: 6465 732c 0a20 2020 2020 2020 2069 6e64  des,.        ind
+00047590: 6976 6964 7561 6c73 2c20 706f 7075 6c61  ividuals, popula
+000475a0: 7469 6f6e 732c 2061 6e64 206d 6967 7261  tions, and migra
+000475b0: 7469 6f6e 7320 696e 2074 6865 2074 7265  tions in the tre
+000475c0: 6520 7365 7175 656e 6365 3a20 7468 6520  e sequence: the 
+000475d0: 6e6f 6465 730a 2020 2020 2020 2020 696e  nodes.        in
+000475e0: 2074 6865 206e 6577 2074 7265 6520 7365   the new tree se
+000475f0: 7175 656e 6365 2077 696c 6c20 6265 2069  quence will be i
+00047600: 6e20 7468 6520 6f72 6465 7220 7072 6f76  n the order prov
+00047610: 6964 6564 2069 6e20 6060 6e6f 6465 7360  ided in ``nodes`
+00047620: 602c 2061 6e64 0a20 2020 2020 2020 2062  `, and.        b
+00047630: 6f74 6820 696e 6469 7669 6475 616c 7320  oth individuals 
+00047640: 616e 6420 706f 7075 6c61 7469 6f6e 7320  and populations 
+00047650: 7769 6c6c 2062 6520 6f72 6465 7265 6420  will be ordered 
+00047660: 6279 2074 6865 2065 6172 6c69 6573 7420  by the earliest 
+00047670: 7265 7461 696e 6564 0a20 2020 2020 2020  retained.       
+00047680: 206e 6f64 6520 7468 6174 2072 6566 6572   node that refer
+00047690: 7320 746f 2074 6865 6d2e 2028 486f 7765  s to them. (Howe
+000476a0: 7665 722c 2060 6072 656f 7264 6572 5f70  ver, ``reorder_p
+000476b0: 6f70 756c 6174 696f 6e73 6060 206d 6179  opulations`` may
+000476c0: 2062 6520 7365 7420 746f 0a20 2020 2020   be set to.     
+000476d0: 2020 2046 616c 7365 2074 6f20 6b65 6570     False to keep
+000476e0: 2074 6865 2070 6f70 756c 6174 696f 6e20   the population 
+000476f0: 7461 626c 6520 756e 6368 616e 6765 642e  table unchanged.
+00047700: 290a 0a20 2020 2020 2020 2042 7920 6465  )..        By de
+00047710: 6661 756c 742c 2074 6865 206d 6574 686f  fault, the metho
+00047720: 6420 7265 6d6f 7665 7320 616c 6c20 696e  d removes all in
+00047730: 6469 7669 6475 616c 7320 616e 6420 706f  dividuals and po
+00047740: 7075 6c61 7469 6f6e 7320 6e6f 740a 2020  pulations not.  
+00047750: 2020 2020 2020 7265 6665 7265 6e63 6564        referenced
+00047760: 2062 7920 616e 7920 6e6f 6465 732c 2061   by any nodes, a
+00047770: 6e64 2061 6c6c 2073 6974 6573 206e 6f74  nd all sites not
+00047780: 2072 6566 6572 656e 6365 6420 6279 2061   referenced by a
+00047790: 6e79 206d 7574 6174 696f 6e73 2e0a 2020  ny mutations..  
+000477a0: 2020 2020 2020 546f 2072 6574 6169 6e20        To retain 
+000477b0: 7468 6573 6520 756e 7265 6665 7265 6e63  these unreferenc
+000477c0: 6564 2069 6e64 6976 6964 7561 6c73 2c20  ed individuals, 
+000477d0: 706f 7075 6c61 7469 6f6e 732c 2061 6e64  populations, and
+000477e0: 2073 6974 6573 2c20 7061 7373 0a20 2020   sites, pass.   
+000477f0: 2020 2020 2060 6072 656d 6f76 655f 756e       ``remove_un
+00047800: 7265 6665 7265 6e63 6564 3d46 616c 7365  referenced=False
+00047810: 6060 2e20 4966 2074 6869 7320 6973 2064  ``. If this is d
+00047820: 6f6e 652c 2074 6865 2073 6974 6520 7461  one, the site ta
+00047830: 626c 6520 7769 6c6c 0a20 2020 2020 2020  ble will.       
+00047840: 2072 656d 6169 6e20 756e 6368 616e 6765   remain unchange
+00047850: 642c 2075 6e72 6566 6572 656e 6365 6420  d, unreferenced 
+00047860: 696e 6469 7669 6475 616c 7320 7769 6c6c  individuals will
+00047870: 2061 7070 6561 7220 6174 2074 6865 2065   appear at the e
+00047880: 6e64 206f 660a 2020 2020 2020 2020 7468  nd of.        th
+00047890: 6520 696e 6469 7669 6475 616c 7320 7461  e individuals ta
+000478a0: 626c 6520 2861 6e64 2069 6e20 7468 6569  ble (and in thei
+000478b0: 7220 6f72 6967 696e 616c 206f 7264 6572  r original order
+000478c0: 292c 2061 6e64 2075 6e72 6566 6572 656e  ), and unreferen
+000478d0: 6365 640a 2020 2020 2020 2020 706f 7075  ced.        popu
+000478e0: 6c61 7469 6f6e 7320 7769 6c6c 2061 7070  lations will app
+000478f0: 6561 7220 6174 2074 6865 2065 6e64 206f  ear at the end o
+00047900: 6620 7468 6520 706f 7075 6c61 7469 6f6e  f the population
+00047910: 2074 6162 6c65 2028 756e 6c65 7373 0a20   table (unless. 
+00047920: 2020 2020 2020 2060 6072 656f 7264 6572         ``reorder
+00047930: 5f70 6f70 756c 6174 696f 6e73 3d46 616c  _populations=Fal
+00047940: 7365 6060 292e 0a0a 2020 2020 2020 2020  se``)...        
+00047950: 2e2e 2073 6565 616c 736f 3a3a 0a0a 2020  .. seealso::..  
+00047960: 2020 2020 2020 2020 2020 3a6d 6574 683a            :meth:
+00047970: 602e 6b65 6570 5f69 6e74 6572 7661 6c73  `.keep_intervals
+00047980: 6020 666f 7220 7375 6273 6574 7469 6e67  ` for subsetting
+00047990: 2061 2067 6976 656e 2070 6f72 7469 6f6e   a given portion
+000479a0: 206f 6620 7468 6520 6765 6e6f 6d65 3b0a   of the genome;.
+000479b0: 2020 2020 2020 2020 2020 2020 3a6d 6574              :met
+000479c0: 683a 602e 7369 6d70 6c69 6679 6020 666f  h:`.simplify` fo
+000479d0: 7220 7265 7461 696e 696e 6720 7468 6520  r retaining the 
+000479e0: 616e 6365 7374 7279 206f 6620 6120 7375  ancestry of a su
+000479f0: 6273 6574 206f 6620 6e6f 6465 732e 0a0a  bset of nodes...
+00047a00: 2020 2020 2020 2020 3a70 6172 616d 206c          :param l
+00047a10: 6973 7420 6e6f 6465 733a 2054 6865 206c  ist nodes: The l
+00047a20: 6973 7420 6f66 206e 6f64 6573 2066 6f72  ist of nodes for
+00047a30: 2077 6869 6368 2074 6f20 7265 7461 696e   which to retain
+00047a40: 2069 6e66 6f72 6d61 7469 6f6e 2e20 5468   information. Th
+00047a50: 6973 0a20 2020 2020 2020 2020 2020 206d  is.            m
+00047a60: 6179 2062 6520 6120 6e75 6d70 7920 6172  ay be a numpy ar
+00047a70: 7261 7920 286f 7220 6172 7261 792d 6c69  ray (or array-li
+00047a80: 6b65 2920 6f62 6a65 6374 2028 6474 7970  ke) object (dtyp
+00047a90: 653d 6e70 2e69 6e74 3332 292e 0a20 2020  e=np.int32)..   
+00047aa0: 2020 2020 203a 7061 7261 6d20 626f 6f6c       :param bool
+00047ab0: 2072 6563 6f72 645f 7072 6f76 656e 616e   record_provenan
+00047ac0: 6365 3a20 5768 6574 6865 7220 746f 2072  ce: Whether to r
+00047ad0: 6563 6f72 6420 6120 7072 6f76 656e 616e  ecord a provenan
+00047ae0: 6365 2065 6e74 7279 0a20 2020 2020 2020  ce entry.       
+00047af0: 2020 2020 2069 6e20 7468 6520 7072 6f76       in the prov
+00047b00: 656e 616e 6365 2074 6162 6c65 2066 6f72  enance table for
+00047b10: 2074 6869 7320 6f70 6572 6174 696f 6e2e   this operation.
+00047b20: 0a20 2020 2020 2020 203a 7061 7261 6d20  .        :param 
+00047b30: 626f 6f6c 2072 656f 7264 6572 5f70 6f70  bool reorder_pop
+00047b40: 756c 6174 696f 6e73 3a20 5768 6574 6865  ulations: Whethe
+00047b50: 7220 746f 2072 656f 7264 6572 2070 6f70  r to reorder pop
+00047b60: 756c 6174 696f 6e73 0a20 2020 2020 2020  ulations.       
+00047b70: 2020 2020 2028 6465 6661 756c 743a 2054       (default: T
+00047b80: 7275 6529 2e20 2049 6620 4661 6c73 652c  rue).  If False,
+00047b90: 2074 6865 2070 6f70 756c 6174 696f 6e20   the population 
+00047ba0: 7461 626c 6520 7769 6c6c 206e 6f74 2062  table will not b
+00047bb0: 6520 616c 7465 7265 6420 696e 0a20 2020  e altered in.   
+00047bc0: 2020 2020 2020 2020 2061 6e79 2077 6179           any way
+00047bd0: 2e0a 2020 2020 2020 2020 3a70 6172 616d  ..        :param
+00047be0: 2062 6f6f 6c20 7265 6d6f 7665 5f75 6e72   bool remove_unr
+00047bf0: 6566 6572 656e 6365 643a 2057 6865 7468  eferenced: Wheth
+00047c00: 6572 2073 6974 6573 2c20 696e 6469 7669  er sites, indivi
+00047c10: 6475 616c 732c 2061 6e64 2070 6f70 756c  duals, and popul
+00047c20: 6174 696f 6e73 0a20 2020 2020 2020 2020  ations.         
+00047c30: 2020 2074 6861 7420 6172 6520 6e6f 7420     that are not 
+00047c40: 7265 6665 7272 6564 2074 6f20 6279 2061  referred to by a
+00047c50: 6e79 2072 6574 6169 6e65 6420 656e 7472  ny retained entr
+00047c60: 6965 7320 696e 2074 6865 2074 6162 6c65  ies in the table
+00047c70: 7320 7368 6f75 6c64 0a20 2020 2020 2020  s should.       
+00047c80: 2020 2020 2062 6520 7265 6d6f 7665 6420       be removed 
+00047c90: 2864 6566 6175 6c74 3a20 5472 7565 292e  (default: True).
+00047ca0: 2053 6565 2074 6865 2064 6573 6372 6970   See the descrip
+00047cb0: 7469 6f6e 2066 6f72 2064 6574 6169 6c73  tion for details
+00047cc0: 2e0a 2020 2020 2020 2020 3a72 7479 7065  ..        :rtype
+00047cd0: 3a20 7473 6b69 742e 5472 6565 5365 7175  : tskit.TreeSequ
+00047ce0: 656e 6365 0a20 2020 2020 2020 2022 2222  ence.        """
+00047cf0: 0a20 2020 2020 2020 2074 6162 6c65 7320  .        tables 
+00047d00: 3d20 7365 6c66 2e64 756d 705f 7461 626c  = self.dump_tabl
+00047d10: 6573 2829 0a20 2020 2020 2020 2074 6162  es().        tab
+00047d20: 6c65 732e 7375 6273 6574 280a 2020 2020  les.subset(.    
+00047d30: 2020 2020 2020 2020 6e6f 6465 732c 0a20          nodes,. 
+00047d40: 2020 2020 2020 2020 2020 2072 6563 6f72             recor
+00047d50: 645f 7072 6f76 656e 616e 6365 3d72 6563  d_provenance=rec
+00047d60: 6f72 645f 7072 6f76 656e 616e 6365 2c0a  ord_provenance,.
+00047d70: 2020 2020 2020 2020 2020 2020 7265 6f72              reor
+00047d80: 6465 725f 706f 7075 6c61 7469 6f6e 733d  der_populations=
+00047d90: 7265 6f72 6465 725f 706f 7075 6c61 7469  reorder_populati
+00047da0: 6f6e 732c 0a20 2020 2020 2020 2020 2020  ons,.           
+00047db0: 2072 656d 6f76 655f 756e 7265 6665 7265   remove_unrefere
+00047dc0: 6e63 6564 3d72 656d 6f76 655f 756e 7265  nced=remove_unre
+00047dd0: 6665 7265 6e63 6564 2c0a 2020 2020 2020  ferenced,.      
+00047de0: 2020 290a 2020 2020 2020 2020 7265 7475    ).        retu
+00047df0: 726e 2074 6162 6c65 732e 7472 6565 5f73  rn tables.tree_s
+00047e00: 6571 7565 6e63 6528 290a 0a20 2020 2064  equence()..    d
+00047e10: 6566 2075 6e69 6f6e 280a 2020 2020 2020  ef union(.      
+00047e20: 2020 7365 6c66 2c0a 2020 2020 2020 2020    self,.        
+00047e30: 6f74 6865 722c 0a20 2020 2020 2020 206e  other,.        n
+00047e40: 6f64 655f 6d61 7070 696e 672c 0a20 2020  ode_mapping,.   
+00047e50: 2020 2020 2063 6865 636b 5f73 6861 7265       check_share
+00047e60: 645f 6571 7561 6c69 7479 3d54 7275 652c  d_equality=True,
+00047e70: 0a20 2020 2020 2020 2061 6464 5f70 6f70  .        add_pop
+00047e80: 756c 6174 696f 6e73 3d54 7275 652c 0a20  ulations=True,. 
+00047e90: 2020 2020 2020 2072 6563 6f72 645f 7072         record_pr
+00047ea0: 6f76 656e 616e 6365 3d54 7275 652c 0a20  ovenance=True,. 
+00047eb0: 2020 2029 3a0a 2020 2020 2020 2020 2222     ):.        ""
+00047ec0: 220a 2020 2020 2020 2020 5265 7475 726e  ".        Return
+00047ed0: 7320 616e 2065 7870 616e 6465 6420 7472  s an expanded tr
+00047ee0: 6565 2073 6571 7565 6e63 6520 7768 6963  ee sequence whic
+00047ef0: 6820 636f 6e74 6169 6e73 2074 6865 206e  h contains the n
+00047f00: 6f64 652d 7769 7365 2075 6e69 6f6e 206f  ode-wise union o
+00047f10: 660a 2020 2020 2020 2020 6060 7365 6c66  f.        ``self
+00047f20: 6060 2061 6e64 2060 606f 7468 6572 6060  `` and ``other``
+00047f30: 2c20 6f62 7461 696e 6564 2062 7920 6164  , obtained by ad
+00047f40: 6469 6e67 2074 6865 206e 6f6e 2d73 6861  ding the non-sha
+00047f50: 7265 6420 706f 7274 696f 6e73 206f 660a  red portions of.
+00047f60: 2020 2020 2020 2020 6060 6f74 6865 7260          ``other`
+00047f70: 6020 6f6e 746f 2060 6073 656c 6660 602e  ` onto ``self``.
+00047f80: 2054 6865 2022 7368 6172 6564 2220 706f   The "shared" po
+00047f90: 7274 696f 6e73 2061 7265 2073 7065 6369  rtions are speci
+00047fa0: 6669 6564 2075 7369 6e67 2061 0a20 2020  fied using a.   
+00047fb0: 2020 2020 206d 6170 2074 6861 7420 7370       map that sp
+00047fc0: 6563 6966 6965 7320 7768 6963 6820 6e6f  ecifies which no
+00047fd0: 6465 7320 696e 2060 606f 7468 6572 6060  des in ``other``
+00047fe0: 2061 7265 2065 7175 6976 616c 656e 7420   are equivalent 
+00047ff0: 746f 2074 686f 7365 2069 6e0a 2020 2020  to those in.    
+00048000: 2020 2020 6060 7365 6c66 6060 3a20 7468      ``self``: th
+00048010: 6520 6060 6e6f 6465 5f6d 6170 7069 6e67  e ``node_mapping
+00048020: 6060 2061 7267 756d 656e 7420 7368 6f75  `` argument shou
+00048030: 6c64 2062 6520 616e 2061 7272 6179 206f  ld be an array o
+00048040: 6620 6c65 6e67 7468 0a20 2020 2020 2020  f length.       
+00048050: 2065 7175 616c 2074 6f20 7468 6520 6e75   equal to the nu
+00048060: 6d62 6572 206f 6620 6e6f 6465 7320 696e  mber of nodes in
+00048070: 2060 606f 7468 6572 6060 2061 6e64 2077   ``other`` and w
+00048080: 686f 7365 2065 6e74 7269 6573 2061 7265  hose entries are
+00048090: 2074 6865 2049 440a 2020 2020 2020 2020   the ID.        
+000480a0: 6f66 2074 6865 206d 6174 6368 696e 6720  of the matching 
+000480b0: 6e6f 6465 2069 6e20 6060 7365 6c66 6060  node in ``self``
+000480c0: 2c20 6f72 2060 6074 736b 6974 2e4e 554c  , or ``tskit.NUL
+000480d0: 4c60 6020 6966 2074 6865 7265 2069 7320  L`` if there is 
+000480e0: 6e6f 0a20 2020 2020 2020 206d 6174 6368  no.        match
+000480f0: 696e 6720 6e6f 6465 2e20 5468 6f73 6520  ing node. Those 
+00048100: 6e6f 6465 7320 696e 2060 606f 7468 6572  nodes in ``other
+00048110: 6060 2074 6861 7420 6d61 7020 746f 2060  `` that map to `
+00048120: 6074 736b 6974 2e4e 554c 4c60 6020 7769  `tskit.NULL`` wi
+00048130: 6c6c 0a20 2020 2020 2020 2062 6520 6164  ll.        be ad
+00048140: 6465 6420 746f 2060 6073 656c 6660 602c  ded to ``self``,
+00048150: 2061 6c6f 6e67 2077 6974 683a 0a0a 2020   along with:..  
+00048160: 2020 2020 2020 312e 2049 6e64 6976 6964        1. Individ
+00048170: 7561 6c73 2077 686f 7365 206e 6f64 6573  uals whose nodes
+00048180: 2061 7265 206e 6577 2074 6f20 6060 7365   are new to ``se
+00048190: 6c66 6060 2e0a 2020 2020 2020 2020 322e  lf``..        2.
+000481a0: 2045 6467 6573 2077 686f 7365 2070 6172   Edges whose par
+000481b0: 656e 7420 6f72 2063 6869 6c64 2061 7265  ent or child are
+000481c0: 206e 6577 2074 6f20 6060 7365 6c66 6060   new to ``self``
+000481d0: 2e0a 2020 2020 2020 2020 332e 204d 7574  ..        3. Mut
+000481e0: 6174 696f 6e73 2077 686f 7365 206e 6f64  ations whose nod
+000481f0: 6573 2061 7265 206e 6577 2074 6f20 6060  es are new to ``
+00048200: 7365 6c66 6060 2e0a 2020 2020 2020 2020  self``..        
+00048210: 342e 2053 6974 6573 2077 6869 6368 2077  4. Sites which w
+00048220: 6572 6520 6e6f 7420 7072 6573 656e 7420  ere not present 
+00048230: 696e 2060 6073 656c 6660 602c 2069 6620  in ``self``, if 
+00048240: 7468 6520 7369 7465 2063 6f6e 7461 696e  the site contain
+00048250: 7320 6120 6e65 776c 790a 2020 2020 2020  s a newly.      
+00048260: 2020 2020 2061 6464 6564 206d 7574 6174       added mutat
+00048270: 696f 6e2e 0a0a 2020 2020 2020 2020 4279  ion...        By
+00048280: 2064 6566 6175 6c74 2c20 706f 7075 6c61   default, popula
+00048290: 7469 6f6e 7320 6f66 206e 6577 6c79 2061  tions of newly a
+000482a0: 6464 6564 206e 6f64 6573 2061 7265 2061  dded nodes are a
+000482b0: 7373 756d 6564 2074 6f20 6265 206e 6577  ssumed to be new
+000482c0: 0a20 2020 2020 2020 2070 6f70 756c 6174  .        populat
+000482d0: 696f 6e73 2c20 616e 6420 6164 6465 6420  ions, and added 
+000482e0: 746f 2074 6865 2070 6f70 756c 6174 696f  to the populatio
+000482f0: 6e20 7461 626c 6520 6173 2077 656c 6c2e  n table as well.
+00048300: 0a0a 2020 2020 2020 2020 4e6f 7465 2074  ..        Note t
+00048310: 6861 7420 7468 6973 206f 7065 7261 7469  hat this operati
+00048320: 6f6e 2061 6c73 6f20 736f 7274 7320 7468  on also sorts th
+00048330: 6520 7265 7375 6c74 696e 6720 7461 626c  e resulting tabl
+00048340: 6573 2c20 736f 2074 6865 0a20 2020 2020  es, so the.     
+00048350: 2020 2072 6573 756c 7469 6e67 2074 7265     resulting tre
+00048360: 6520 7365 7175 656e 6365 206d 6179 206e  e sequence may n
+00048370: 6f74 2062 6520 6571 7561 6c20 746f 2060  ot be equal to `
+00048380: 6073 656c 6660 6020 6576 656e 2069 6620  `self`` even if 
+00048390: 6e6f 7468 696e 670a 2020 2020 2020 2020  nothing.        
+000483a0: 6e65 7720 7761 7320 6164 6465 6420 2861  new was added (a
+000483b0: 6c74 686f 7567 6820 6974 2077 6f75 6c64  lthough it would
+000483c0: 2064 6966 6665 7220 6f6e 6c79 2069 6e20   differ only in 
+000483d0: 6f72 6465 7269 6e67 206f 6620 7468 6520  ordering of the 
+000483e0: 7461 626c 6573 292e 0a0a 2020 2020 2020  tables)...      
+000483f0: 2020 3a70 6172 616d 2054 6162 6c65 436f    :param TableCo
+00048400: 6c6c 6563 7469 6f6e 206f 7468 6572 3a20  llection other: 
+00048410: 416e 6f74 6865 7220 7461 626c 6520 636f  Another table co
+00048420: 6c6c 6563 7469 6f6e 2e0a 2020 2020 2020  llection..      
+00048430: 2020 3a70 6172 616d 206c 6973 7420 6e6f    :param list no
+00048440: 6465 5f6d 6170 7069 6e67 3a20 416e 2061  de_mapping: An a
+00048450: 7272 6179 206f 6620 6e6f 6465 2049 4473  rray of node IDs
+00048460: 2074 6861 7420 7265 6c61 7465 206e 6f64   that relate nod
+00048470: 6573 2069 6e0a 2020 2020 2020 2020 2020  es in.          
+00048480: 2020 6060 6f74 6865 7260 6020 746f 206e    ``other`` to n
+00048490: 6f64 6573 2069 6e20 6060 7365 6c66 6060  odes in ``self``
+000484a0: 2e0a 2020 2020 2020 2020 3a70 6172 616d  ..        :param
+000484b0: 2062 6f6f 6c20 6368 6563 6b5f 7368 6172   bool check_shar
+000484c0: 6564 5f65 7175 616c 6974 793a 2049 6620  ed_equality: If 
+000484d0: 5472 7565 2c20 7468 6520 7368 6172 6564  True, the shared
+000484e0: 2070 6f72 7469 6f6e 7320 6f66 2074 6865   portions of the
+000484f0: 0a20 2020 2020 2020 2020 2020 2074 7265  .            tre
+00048500: 6520 7365 7175 656e 6365 7320 7769 6c6c  e sequences will
+00048510: 2062 6520 6368 6563 6b65 6420 666f 7220   be checked for 
+00048520: 6571 7561 6c69 7479 2e20 4974 2064 6f65  equality. It doe
+00048530: 7320 736f 2062 790a 2020 2020 2020 2020  s so by.        
+00048540: 2020 2020 7375 6273 6574 7469 6e67 2062      subsetting b
+00048550: 6f74 6820 6060 7365 6c66 6060 2061 6e64  oth ``self`` and
+00048560: 2060 606f 7468 6572 6060 206f 6e20 7468   ``other`` on th
+00048570: 6520 6571 7569 7661 6c65 6e74 206e 6f64  e equivalent nod
+00048580: 6573 0a20 2020 2020 2020 2020 2020 2073  es.            s
+00048590: 7065 6369 6669 6564 2069 6e20 6060 6e6f  pecified in ``no
+000485a0: 6465 5f6d 6170 7069 6e67 6060 2c20 616e  de_mapping``, an
+000485b0: 6420 7468 656e 2063 6865 636b 696e 6720  d then checking 
+000485c0: 666f 7220 6571 7561 6c69 7479 206f 660a  for equality of.
+000485d0: 2020 2020 2020 2020 2020 2020 7468 6520              the 
+000485e0: 7375 6273 6574 732e 0a20 2020 2020 2020  subsets..       
+000485f0: 203a 7061 7261 6d20 626f 6f6c 2061 6464   :param bool add
+00048600: 5f70 6f70 756c 6174 696f 6e73 3a20 4966  _populations: If
+00048610: 2054 7275 652c 206e 6f64 6573 206e 6577   True, nodes new
+00048620: 2074 6f20 6060 7365 6c66 6060 2077 696c   to ``self`` wil
+00048630: 6c20 6265 0a20 2020 2020 2020 2020 2020  l be.           
+00048640: 2061 7373 6967 6e65 6420 6e65 7720 706f   assigned new po
+00048650: 7075 6c61 7469 6f6e 2049 4473 2e0a 2020  pulation IDs..  
+00048660: 2020 2020 2020 3a70 6172 616d 2062 6f6f        :param boo
+00048670: 6c20 7265 636f 7264 5f70 726f 7665 6e61  l record_provena
+00048680: 6e63 653a 2057 6865 7468 6572 2074 6f20  nce: Whether to 
+00048690: 7265 636f 7264 2061 2070 726f 7665 6e61  record a provena
+000486a0: 6e63 6520 656e 7472 790a 2020 2020 2020  nce entry.      
+000486b0: 2020 2020 2020 696e 2074 6865 2070 726f        in the pro
+000486c0: 7665 6e61 6e63 6520 7461 626c 6520 666f  venance table fo
+000486d0: 7220 7468 6973 206f 7065 7261 7469 6f6e  r this operation
+000486e0: 2e0a 2020 2020 2020 2020 2222 220a 2020  ..        """.  
+000486f0: 2020 2020 2020 7461 626c 6573 203d 2073        tables = s
+00048700: 656c 662e 6475 6d70 5f74 6162 6c65 7328  elf.dump_tables(
+00048710: 290a 2020 2020 2020 2020 6f74 6865 725f  ).        other_
+00048720: 7461 626c 6573 203d 206f 7468 6572 2e64  tables = other.d
+00048730: 756d 705f 7461 626c 6573 2829 0a20 2020  ump_tables().   
+00048740: 2020 2020 2074 6162 6c65 732e 756e 696f       tables.unio
+00048750: 6e28 0a20 2020 2020 2020 2020 2020 206f  n(.            o
+00048760: 7468 6572 5f74 6162 6c65 732c 0a20 2020  ther_tables,.   
+00048770: 2020 2020 2020 2020 206e 6f64 655f 6d61           node_ma
+00048780: 7070 696e 672c 0a20 2020 2020 2020 2020  pping,.         
+00048790: 2020 2063 6865 636b 5f73 6861 7265 645f     check_shared_
+000487a0: 6571 7561 6c69 7479 3d63 6865 636b 5f73  equality=check_s
+000487b0: 6861 7265 645f 6571 7561 6c69 7479 2c0a  hared_equality,.
+000487c0: 2020 2020 2020 2020 2020 2020 6164 645f              add_
+000487d0: 706f 7075 6c61 7469 6f6e 733d 6164 645f  populations=add_
+000487e0: 706f 7075 6c61 7469 6f6e 732c 0a20 2020  populations,.   
+000487f0: 2020 2020 2020 2020 2072 6563 6f72 645f           record_
+00048800: 7072 6f76 656e 616e 6365 3d72 6563 6f72  provenance=recor
+00048810: 645f 7072 6f76 656e 616e 6365 2c0a 2020  d_provenance,.  
+00048820: 2020 2020 2020 290a 2020 2020 2020 2020        ).        
+00048830: 7265 7475 726e 2074 6162 6c65 732e 7472  return tables.tr
+00048840: 6565 5f73 6571 7565 6e63 6528 290a 0a20  ee_sequence().. 
+00048850: 2020 2064 6566 2064 7261 775f 7376 6728     def draw_svg(
+00048860: 0a20 2020 2020 2020 2073 656c 662c 0a20  .        self,. 
+00048870: 2020 2020 2020 2070 6174 683d 4e6f 6e65         path=None
+00048880: 2c0a 2020 2020 2020 2020 2a2c 0a20 2020  ,.        *,.   
+00048890: 2020 2020 2073 697a 653d 4e6f 6e65 2c0a       size=None,.
+000488a0: 2020 2020 2020 2020 785f 7363 616c 653d          x_scale=
+000488b0: 4e6f 6e65 2c0a 2020 2020 2020 2020 7469  None,.        ti
+000488c0: 6d65 5f73 6361 6c65 3d4e 6f6e 652c 0a20  me_scale=None,. 
+000488d0: 2020 2020 2020 2074 7265 655f 6865 6967         tree_heig
+000488e0: 6874 5f73 6361 6c65 3d4e 6f6e 652c 0a20  ht_scale=None,. 
+000488f0: 2020 2020 2020 206e 6f64 655f 6c61 6265         node_labe
+00048900: 6c73 3d4e 6f6e 652c 0a20 2020 2020 2020  ls=None,.       
+00048910: 206d 7574 6174 696f 6e5f 6c61 6265 6c73   mutation_labels
+00048920: 3d4e 6f6e 652c 0a20 2020 2020 2020 2072  =None,.        r
+00048930: 6f6f 745f 7376 675f 6174 7472 6962 7574  oot_svg_attribut
+00048940: 6573 3d4e 6f6e 652c 0a20 2020 2020 2020  es=None,.       
+00048950: 2073 7479 6c65 3d4e 6f6e 652c 0a20 2020   style=None,.   
+00048960: 2020 2020 206f 7264 6572 3d4e 6f6e 652c       order=None,
+00048970: 0a20 2020 2020 2020 2066 6f72 6365 5f72  .        force_r
+00048980: 6f6f 745f 6272 616e 6368 3d4e 6f6e 652c  oot_branch=None,
+00048990: 0a20 2020 2020 2020 2073 796d 626f 6c5f  .        symbol_
+000489a0: 7369 7a65 3d4e 6f6e 652c 0a20 2020 2020  size=None,.     
+000489b0: 2020 2078 5f61 7869 733d 4e6f 6e65 2c0a     x_axis=None,.
+000489c0: 2020 2020 2020 2020 785f 6c61 6265 6c3d          x_label=
+000489d0: 4e6f 6e65 2c0a 2020 2020 2020 2020 785f  None,.        x_
+000489e0: 6c69 6d3d 4e6f 6e65 2c0a 2020 2020 2020  lim=None,.      
+000489f0: 2020 795f 6178 6973 3d4e 6f6e 652c 0a20    y_axis=None,. 
+00048a00: 2020 2020 2020 2079 5f6c 6162 656c 3d4e         y_label=N
+00048a10: 6f6e 652c 0a20 2020 2020 2020 2079 5f74  one,.        y_t
+00048a20: 6963 6b73 3d4e 6f6e 652c 0a20 2020 2020  icks=None,.     
+00048a30: 2020 2079 5f67 7269 646c 696e 6573 3d4e     y_gridlines=N
+00048a40: 6f6e 652c 0a20 2020 2020 2020 206f 6d69  one,.        omi
+00048a50: 745f 7369 7465 733d 4e6f 6e65 2c0a 2020  t_sites=None,.  
+00048a60: 2020 2020 2020 6361 6e76 6173 5f73 697a        canvas_siz
+00048a70: 653d 4e6f 6e65 2c0a 2020 2020 2020 2020  e=None,.        
+00048a80: 6d61 785f 6e75 6d5f 7472 6565 733d 4e6f  max_num_trees=No
+00048a90: 6e65 2c0a 2020 2020 2020 2020 2a2a 6b77  ne,.        **kw
+00048aa0: 6172 6773 2c0a 2020 2020 293a 0a20 2020  args,.    ):.   
+00048ab0: 2020 2020 2022 2222 0a20 2020 2020 2020       """.       
+00048ac0: 2052 6574 7572 6e20 616e 2053 5647 2072   Return an SVG r
+00048ad0: 6570 7265 7365 6e74 6174 696f 6e20 6f66  epresentation of
+00048ae0: 2061 2074 7265 6520 7365 7175 656e 6365   a tree sequence
+00048af0: 2e20 5365 6520 7468 650a 2020 2020 2020  . See the.      
+00048b00: 2020 3a72 6566 3a60 7669 7375 616c 697a    :ref:`visualiz
+00048b10: 6174 696f 6e20 7475 746f 7269 616c 3c74  ation tutorial<t
+00048b20: 7574 6f72 6961 6c73 3a73 6563 5f74 736b  utorials:sec_tsk
+00048b30: 6974 5f76 697a 3e60 2066 6f72 206d 6f72  it_viz>` for mor
+00048b40: 6520 6465 7461 696c 732e 0a0a 2020 2020  e details...    
+00048b50: 2020 2020 3a70 6172 616d 2073 7472 2070      :param str p
+00048b60: 6174 683a 2054 6865 2070 6174 6820 746f  ath: The path to
+00048b70: 2074 6865 2066 696c 6520 746f 2077 7269   the file to wri
+00048b80: 7465 2074 6865 206f 7574 7075 742e 2049  te the output. I
+00048b90: 6620 4e6f 6e65 2c20 646f 206e 6f74 2077  f None, do not w
+00048ba0: 7269 7465 0a20 2020 2020 2020 2020 2020  rite.           
+00048bb0: 2074 6f20 6669 6c65 2e0a 2020 2020 2020   to file..      
+00048bc0: 2020 3a70 6172 616d 2074 7570 6c65 2869    :param tuple(i
+00048bd0: 6e74 2c20 696e 7429 2073 697a 653a 2041  nt, int) size: A
+00048be0: 2074 7570 6c65 206f 6620 2877 6964 7468   tuple of (width
+00048bf0: 2c20 6865 6967 6874 2920 7370 6563 6966  , height) specif
+00048c00: 7969 6e67 2061 2074 6172 6765 740a 2020  ying a target.  
+00048c10: 2020 2020 2020 2020 2020 6472 6177 696e            drawin
+00048c20: 6720 7369 7a65 2069 6e20 6162 7374 7261  g size in abstra
+00048c30: 6374 2075 7365 7220 756e 6974 7320 2875  ct user units (u
+00048c40: 7375 616c 6c79 2069 6e74 6572 7072 6574  sually interpret
+00048c50: 6564 2061 7320 7069 7865 6c73 206f 6e0a  ed as pixels on.
+00048c60: 2020 2020 2020 2020 2020 2020 696e 6974              init
+00048c70: 6961 6c20 6469 7370 6c61 7929 2e20 436f  ial display). Co
+00048c80: 6d70 6f6e 656e 7473 206f 6620 7468 6520  mponents of the 
+00048c90: 6472 6177 696e 6720 7769 6c6c 2062 6520  drawing will be 
+00048ca0: 7363 616c 6564 2073 6f20 7468 6174 2074  scaled so that t
+00048cb0: 6865 2074 6f74 616c 0a20 2020 2020 2020  he total.       
+00048cc0: 2020 2020 2070 6c6f 7420 696e 636c 7564       plot includ
+00048cd0: 696e 6720 6c61 6265 6c73 2065 7463 2e20  ing labels etc. 
+00048ce0: 6e6f 726d 616c 6c79 2066 6974 7320 6f6e  normally fits on
+00048cf0: 746f 2061 2063 616e 7661 7320 6f66 2074  to a canvas of t
+00048d00: 6869 7320 7369 7a65 2028 7365 650a 2020  his size (see.  
+00048d10: 2020 2020 2020 2020 2020 6060 6361 6e76            ``canv
+00048d20: 6173 5f73 697a 6560 6020 6265 6c6f 7729  as_size`` below)
+00048d30: 2e20 4966 2060 604e 6f6e 6560 602c 2063  . If ``None``, c
+00048d40: 686f 7365 2076 616c 7565 7320 7375 6368  hose values such
+00048d50: 2074 6861 7420 6561 6368 2074 7265 6520   that each tree 
+00048d60: 6973 0a20 2020 2020 2020 2020 2020 2064  is.            d
+00048d70: 7261 776e 2061 7420 6120 7369 7a65 2061  rawn at a size a
+00048d80: 7070 726f 7072 6961 7465 2066 6f72 2061  ppropriate for a
+00048d90: 2072 6561 736f 6e61 626c 7920 736d 616c   reasonably smal
+00048da0: 6c20 7365 7420 6f66 2073 616d 706c 6573  l set of samples
+00048db0: 2028 7468 6973 2077 696c 6c0a 2020 2020   (this will.    
+00048dc0: 2020 2020 2020 2020 6e65 7665 7274 6865          neverthe
+00048dd0: 6c65 7373 2072 6573 756c 7420 696e 2061  less result in a
+00048de0: 2076 6572 7920 7769 6465 2064 7261 7769   very wide drawi
+00048df0: 6e67 2069 6620 7468 6572 6520 6172 6520  ng if there are 
+00048e00: 6d61 6e79 2074 7265 6573 2074 6f0a 2020  many trees to.  
+00048e10: 2020 2020 2020 2020 2020 6469 7370 6c61            displa
+00048e20: 7929 2e20 4465 6661 756c 743a 2060 604e  y). Default: ``N
+00048e30: 6f6e 6560 600a 2020 2020 2020 2020 3a70  one``.        :p
+00048e40: 6172 616d 2073 7472 2078 5f73 6361 6c65  aram str x_scale
+00048e50: 3a20 436f 6e74 726f 6c20 686f 7720 7468  : Control how th
+00048e60: 6520 5820 6178 6973 2069 7320 6472 6177  e X axis is draw
+00048e70: 6e2e 2049 6620 2270 6879 7369 6361 6c22  n. If "physical"
+00048e80: 2028 7468 6520 6465 6661 756c 7429 0a20   (the default). 
+00048e90: 2020 2020 2020 2020 2020 2074 6865 2061             the a
+00048ea0: 7869 7320 7363 616c 6573 206c 696e 6561  xis scales linea
+00048eb0: 726c 7920 7769 7468 2070 6879 7369 6361  rly with physica
+00048ec0: 6c20 6469 7374 616e 6365 2061 6c6f 6e67  l distance along
+00048ed0: 2074 6865 2073 6571 7565 6e63 652c 0a20   the sequence,. 
+00048ee0: 2020 2020 2020 2020 2020 2062 6163 6b67             backg
+00048ef0: 726f 756e 6420 7368 6164 696e 6720 6973  round shading is
+00048f00: 2075 7365 6420 746f 2069 6e64 6963 6174   used to indicat
+00048f10: 6520 7468 6520 706f 7369 7469 6f6e 206f  e the position o
+00048f20: 6620 7468 6520 7472 6565 7320 616c 6f6e  f the trees alon
+00048f30: 6720 7468 650a 2020 2020 2020 2020 2020  g the.          
+00048f40: 2020 5820 6178 6973 2c20 616e 6420 7369    X axis, and si
+00048f50: 7465 7320 2877 6974 6820 6173 736f 6369  tes (with associ
+00048f60: 6174 6564 206d 7574 6174 696f 6e73 2920  ated mutations) 
+00048f70: 6172 6520 6d61 726b 6564 2061 7420 7468  are marked at th
+00048f80: 650a 2020 2020 2020 2020 2020 2020 6170  e.            ap
+00048f90: 7072 6f70 7269 6174 6520 7068 7973 6963  propriate physic
+00048fa0: 616c 2070 6f73 6974 696f 6e20 6f6e 2061  al position on a
+00048fb0: 7869 7320 6c69 6e65 2e20 4966 2022 7472  xis line. If "tr
+00048fc0: 6565 7769 7365 222c 2065 6163 6820 6178  eewise", each ax
+00048fd0: 6973 2074 6963 6b0a 2020 2020 2020 2020  is tick.        
+00048fe0: 2020 2020 636f 7272 6573 706f 6e64 7320      corresponds 
+00048ff0: 746f 2061 2074 7265 6520 626f 756e 6461  to a tree bounda
+00049000: 7279 2c20 7768 6963 6820 6172 6520 706f  ry, which are po
+00049010: 7369 7469 6f6e 6564 2065 7665 6e6c 7920  sitioned evenly 
+00049020: 616c 6f6e 6720 7468 6520 6178 6973 2c0a  along the axis,.
+00049030: 2020 2020 2020 2020 2020 2020 736f 2074              so t
+00049040: 6861 7420 7468 6520 5820 6178 6973 2069  hat the X axis i
+00049050: 7320 6f66 2076 6172 6961 626c 6520 7363  s of variable sc
+00049060: 616c 652c 206e 6f20 6261 636b 6772 6f75  ale, no backgrou
+00049070: 6e64 2073 6361 6c69 6e67 2069 7320 7265  nd scaling is re
+00049080: 7175 6972 6564 2c0a 2020 2020 2020 2020  quired,.        
+00049090: 2020 2020 616e 6420 7369 7465 2070 6f73      and site pos
+000490a0: 6974 696f 6e73 2061 7265 206e 6f74 206d  itions are not m
+000490b0: 6172 6b65 6420 6f6e 2074 6865 2061 7869  arked on the axi
+000490c0: 732e 0a20 2020 2020 2020 203a 7061 7261  s..        :para
+000490d0: 6d20 7374 7220 7469 6d65 5f73 6361 6c65  m str time_scale
+000490e0: 3a20 436f 6e74 726f 6c20 686f 7720 6865  : Control how he
+000490f0: 6967 6874 2076 616c 7565 7320 666f 7220  ight values for 
+00049100: 6e6f 6465 7320 6172 6520 636f 6d70 7574  nodes are comput
+00049110: 6564 2e0a 2020 2020 2020 2020 2020 2020  ed..            
+00049120: 4966 2074 6869 7320 6973 2065 7175 616c  If this is equal
+00049130: 2074 6f20 6060 2274 696d 6522 6060 2c20   to ``"time"``, 
+00049140: 6e6f 6465 2068 6569 6768 7473 2061 7265  node heights are
+00049150: 2070 726f 706f 7274 696f 6e61 6c20 746f   proportional to
+00049160: 2074 6865 6972 2074 696d 650a 2020 2020   their time.    
+00049170: 2020 2020 2020 2020 7661 6c75 6573 2028          values (
+00049180: 7468 6973 2069 7320 7468 6520 6465 6661  this is the defa
+00049190: 756c 7429 2e20 4966 2074 6869 7320 6973  ult). If this is
+000491a0: 2065 7175 616c 2074 6f20 6060 226c 6f67   equal to ``"log
+000491b0: 5f74 696d 6522 6060 2c20 6e6f 6465 0a20  _time"``, node. 
+000491c0: 2020 2020 2020 2020 2020 2068 6569 6768             heigh
+000491d0: 7473 2061 7265 2070 726f 706f 7274 696f  ts are proportio
+000491e0: 6e61 6c20 746f 2074 6865 6972 206c 6f67  nal to their log
+000491f0: 2874 696d 6529 2076 616c 7565 732e 2049  (time) values. I
+00049200: 6620 6974 2069 7320 6571 7561 6c20 746f  f it is equal to
+00049210: 0a20 2020 2020 2020 2020 2020 2060 6022  .            ``"
+00049220: 7261 6e6b 2260 602c 206e 6f64 6520 6865  rank"``, node he
+00049230: 6967 6874 7320 6172 6520 7370 6163 6564  ights are spaced
+00049240: 2065 7175 616c 6c79 2061 6363 6f72 6469   equally accordi
+00049250: 6e67 2074 6f20 7468 6569 7220 7261 6e6b  ng to their rank
+00049260: 6564 2074 696d 6573 2e0a 2020 2020 2020  ed times..      
+00049270: 2020 3a70 6172 616d 2073 7472 2074 7265    :param str tre
+00049280: 655f 6865 6967 6874 5f73 6361 6c65 3a20  e_height_scale: 
+00049290: 4465 7072 6563 6174 6564 2061 6c69 6173  Deprecated alias
+000492a0: 2066 6f72 2074 696d 655f 7363 616c 652e   for time_scale.
+000492b0: 2028 4465 7072 6563 6174 6564 2069 6e0a   (Deprecated in.
+000492c0: 2020 2020 2020 2020 2020 2020 302e 332e              0.3.
+000492d0: 3629 0a20 2020 2020 2020 203a 7061 7261  6).        :para
+000492e0: 6d20 6e6f 6465 5f6c 6162 656c 733a 2049  m node_labels: I
+000492f0: 6620 7370 6563 6966 6965 642c 2073 686f  f specified, sho
+00049300: 7720 6375 7374 6f6d 206c 6162 656c 7320  w custom labels 
+00049310: 666f 7220 7468 6520 6e6f 6465 730a 2020  for the nodes.  
+00049320: 2020 2020 2020 2020 2020 2873 7065 6369            (speci
+00049330: 6669 6564 2062 7920 4944 2920 7468 6174  fied by ID) that
+00049340: 2061 7265 2070 7265 7365 6e74 2069 6e20   are present in 
+00049350: 7468 6973 206d 6170 3b20 616e 7920 6e6f  this map; any no
+00049360: 6465 7320 6e6f 7420 7072 6573 656e 7420  des not present 
+00049370: 7769 6c6c 0a20 2020 2020 2020 2020 2020  will.           
+00049380: 206e 6f74 2068 6176 6520 6120 6c61 6265   not have a labe
+00049390: 6c2e 0a20 2020 2020 2020 203a 7479 7065  l..        :type
+000493a0: 206e 6f64 655f 6c61 6265 6c73 3a20 6469   node_labels: di
+000493b0: 6374 2869 6e74 2c20 7374 7229 0a20 2020  ct(int, str).   
+000493c0: 2020 2020 203a 7061 7261 6d20 6d75 7461       :param muta
+000493d0: 7469 6f6e 5f6c 6162 656c 733a 2049 6620  tion_labels: If 
+000493e0: 7370 6563 6966 6965 642c 2073 686f 7720  specified, show 
+000493f0: 6375 7374 6f6d 206c 6162 656c 7320 666f  custom labels fo
+00049400: 7220 7468 650a 2020 2020 2020 2020 2020  r the.          
+00049410: 2020 6d75 7461 7469 6f6e 7320 2873 7065    mutations (spe
+00049420: 6369 6669 6564 2062 7920 4944 2920 7468  cified by ID) th
+00049430: 6174 2061 7265 2070 7265 7365 6e74 2069  at are present i
+00049440: 6e20 7468 6520 6d61 703b 2061 6e79 206d  n the map; any m
+00049450: 7574 6174 696f 6e73 0a20 2020 2020 2020  utations.       
+00049460: 2020 2020 206e 6f74 2070 7265 7365 6e74       not present
+00049470: 2077 696c 6c20 6e6f 7420 6861 7665 2061   will not have a
+00049480: 206c 6162 656c 2e0a 2020 2020 2020 2020   label..        
+00049490: 3a74 7970 6520 6d75 7461 7469 6f6e 5f6c  :type mutation_l
+000494a0: 6162 656c 733a 2064 6963 7428 696e 742c  abels: dict(int,
+000494b0: 2073 7472 290a 2020 2020 2020 2020 3a70   str).        :p
+000494c0: 6172 616d 2064 6963 7420 726f 6f74 5f73  aram dict root_s
+000494d0: 7667 5f61 7474 7269 6275 7465 733a 2041  vg_attributes: A
+000494e0: 6464 6974 696f 6e61 6c20 6174 7472 6962  dditional attrib
+000494f0: 7574 6573 2c20 7375 6368 2061 7320 616e  utes, such as an
+00049500: 2069 642c 2074 6861 7420 7769 6c6c 0a20   id, that will. 
+00049510: 2020 2020 2020 2020 2020 2062 6520 656d             be em
+00049520: 6265 6464 6564 2069 6e20 7468 6520 726f  bedded in the ro
+00049530: 6f74 2060 603c 7376 673e 6060 2074 6167  ot ``<svg>`` tag
+00049540: 206f 6620 7468 6520 6765 6e65 7261 7465   of the generate
+00049550: 6420 6472 6177 696e 672e 0a20 2020 2020  d drawing..     
+00049560: 2020 203a 7061 7261 6d20 7374 7220 7374     :param str st
+00049570: 796c 653a 2041 2060 6373 7320 7374 7269  yle: A `css stri
+00049580: 6e67 203c 6874 7470 733a 2f2f 7777 772e  ng <https://www.
+00049590: 7733 2e6f 7267 2f54 522f 4353 5332 312f  w3.org/TR/CSS21/
+000495a0: 7379 6e64 6174 612e 6874 6d3e 605f 0a20  syndata.htm>`_. 
+000495b0: 2020 2020 2020 2020 2020 2074 6861 7420             that 
+000495c0: 7769 6c6c 2062 6520 696e 636c 7564 6564  will be included
+000495d0: 2069 6e20 7468 6520 6060 3c73 7479 6c65   in the ``<style
+000495e0: 3e60 6020 7461 6720 6f66 2074 6865 2067  >`` tag of the g
+000495f0: 656e 6572 6174 6564 2073 7667 2e0a 2020  enerated svg..  
+00049600: 2020 2020 2020 3a70 6172 616d 2073 7472        :param str
+00049610: 206f 7264 6572 3a20 5468 6520 6c65 6674   order: The left
+00049620: 2d74 6f2d 7269 6768 7420 6f72 6465 7269  -to-right orderi
+00049630: 6e67 206f 6620 6368 696c 6420 6e6f 6465  ng of child node
+00049640: 7320 696e 2065 6163 6820 6472 6177 6e20  s in each drawn 
+00049650: 7472 6565 2e0a 2020 2020 2020 2020 2020  tree..          
+00049660: 2020 5468 6973 2063 616e 2062 6520 6569    This can be ei
+00049670: 7468 6572 3a20 6060 226d 696e 6c65 7822  ther: ``"minlex"
+00049680: 6060 2c20 7768 6963 6820 6d69 6e69 6d69  ``, which minimi
+00049690: 7365 7320 7468 6520 6469 6666 6572 656e  ses the differen
+000496a0: 6365 730a 2020 2020 2020 2020 2020 2020  ces.            
+000496b0: 6265 7477 6565 6e20 6164 6a61 6365 6e74  between adjacent
+000496c0: 2074 7265 6573 2028 7365 6520 616c 736f   trees (see also
+000496d0: 2074 6865 2060 6022 6d69 6e6c 6578 5f70   the ``"minlex_p
+000496e0: 6f73 746f 7264 6572 2260 6020 7472 6176  ostorder"`` trav
+000496f0: 6572 7361 6c0a 2020 2020 2020 2020 2020  ersal.          
+00049700: 2020 6f72 6465 7220 666f 7220 7468 6520    order for the 
+00049710: 3a6d 6574 683a 602e 5472 6565 2e6e 6f64  :meth:`.Tree.nod
+00049720: 6573 6020 6d65 7468 6f64 293b 206f 7220  es` method); or 
+00049730: 6060 2274 7265 6522 6060 2077 6869 6368  ``"tree"`` which
+00049740: 2064 7261 7773 2074 7265 6573 0a20 2020   draws trees.   
+00049750: 2020 2020 2020 2020 2069 6e20 7468 6520           in the 
+00049760: 6c65 6674 2d74 6f2d 7269 6768 7420 6f72  left-to-right or
+00049770: 6465 7220 6465 6669 6e65 6420 6279 2074  der defined by t
+00049780: 6865 0a20 2020 2020 2020 2020 2020 203a  he.            :
+00049790: 7265 663a 6071 7569 6e74 7570 6c79 206c  ref:`quintuply l
+000497a0: 696e 6b65 6420 7472 6565 2073 7472 7563  inked tree struc
+000497b0: 7475 7265 203c 7365 635f 6461 7461 5f6d  ture <sec_data_m
+000497c0: 6f64 656c 5f74 7265 655f 7374 7275 6374  odel_tree_struct
+000497d0: 7572 653e 602e 0a20 2020 2020 2020 2020  ure>`..         
+000497e0: 2020 2049 6620 6e6f 7420 7370 6563 6966     If not specif
+000497f0: 6965 6420 6f72 204e 6f6e 652c 2074 6869  ied or None, thi
+00049800: 7320 6465 6661 756c 7473 2074 6f20 6060  s defaults to ``
+00049810: 226d 696e 6c65 7822 6060 2e0a 2020 2020  "minlex"``..    
+00049820: 2020 2020 3a70 6172 616d 2062 6f6f 6c20      :param bool 
+00049830: 666f 7263 655f 726f 6f74 5f62 7261 6e63  force_root_branc
+00049840: 683a 2049 6620 6060 5472 7565 6060 2070  h: If ``True`` p
+00049850: 6c6f 7420 6120 6272 616e 6368 2028 6564  lot a branch (ed
+00049860: 6765 2920 6162 6f76 6520 6576 6572 7920  ge) above every 
+00049870: 7472 6565 0a20 2020 2020 2020 2020 2020  tree.           
+00049880: 2072 6f6f 7420 696e 2074 6865 2074 7265   root in the tre
+00049890: 6520 7365 7175 656e 6365 2e20 4966 2060  e sequence. If `
+000498a0: 604e 6f6e 6560 6020 2864 6566 6175 6c74  `None`` (default
+000498b0: 2920 7468 656e 206f 6e6c 7920 706c 6f74  ) then only plot
+000498c0: 2073 7563 680a 2020 2020 2020 2020 2020   such.          
+000498d0: 2020 726f 6f74 2062 7261 6e63 6865 7320    root branches 
+000498e0: 6966 2061 6e79 2072 6f6f 7420 696e 2074  if any root in t
+000498f0: 6865 2074 7265 6520 7365 7175 656e 6365  he tree sequence
+00049900: 2068 6173 2061 206d 7574 6174 696f 6e20   has a mutation 
+00049910: 6162 6f76 6520 6974 2e0a 2020 2020 2020  above it..      
+00049920: 2020 3a70 6172 616d 2066 6c6f 6174 2073    :param float s
+00049930: 796d 626f 6c5f 7369 7a65 3a20 4368 616e  ymbol_size: Chan
+00049940: 6765 2074 6865 2064 6566 6175 6c74 2073  ge the default s
+00049950: 697a 6520 6f66 2074 6865 206e 6f64 6520  ize of the node 
+00049960: 616e 6420 6d75 7461 7469 6f6e 0a20 2020  and mutation.   
+00049970: 2020 2020 2020 2020 2070 6c6f 7474 696e           plottin
+00049980: 6720 7379 6d62 6f6c 732e 2049 6620 6060  g symbols. If ``
+00049990: 4e6f 6e65 6060 2028 6465 6661 756c 7429  None`` (default)
+000499a0: 2075 7365 2061 2073 7461 6e64 6172 6420   use a standard 
+000499b0: 7369 7a65 2e0a 2020 2020 2020 2020 3a70  size..        :p
+000499c0: 6172 616d 2062 6f6f 6c20 785f 6178 6973  aram bool x_axis
+000499d0: 3a20 5368 6f75 6c64 2074 6865 2070 6c6f  : Should the plo
+000499e0: 7420 6861 7665 2061 6e20 5820 6178 6973  t have an X axis
+000499f0: 206c 696e 652c 2073 686f 7769 6e67 2074   line, showing t
+00049a00: 6865 2070 6f73 6974 696f 6e73 0a20 2020  he positions.   
+00049a10: 2020 2020 2020 2020 206f 6620 7472 6565           of tree
+00049a20: 7320 616c 6f6e 6720 7468 6520 6765 6e6f  s along the geno
+00049a30: 6d65 2e20 5468 6520 7363 616c 6520 7573  me. The scale us
+00049a40: 6564 2069 7320 6465 7465 726d 696e 6564  ed is determined
+00049a50: 2062 7920 7468 6520 6060 785f 7363 616c   by the ``x_scal
+00049a60: 6560 600a 2020 2020 2020 2020 2020 2020  e``.            
+00049a70: 7061 7261 6d65 7465 722e 2049 6620 6060  parameter. If ``
+00049a80: 4e6f 6e65 6060 2028 6465 6661 756c 7429  None`` (default)
+00049a90: 2070 6c6f 7420 616e 2058 2061 7869 732e   plot an X axis.
+00049aa0: 0a20 2020 2020 2020 203a 7061 7261 6d20  .        :param 
+00049ab0: 7374 7220 785f 6c61 6265 6c3a 2050 6c61  str x_label: Pla
+00049ac0: 6365 2061 206c 6162 656c 2075 6e64 6572  ce a label under
+00049ad0: 2074 6865 2070 6c6f 742e 2049 6620 6060   the plot. If ``
+00049ae0: 4e6f 6e65 6060 2028 6465 6661 756c 7429  None`` (default)
+00049af0: 2061 6e64 0a20 2020 2020 2020 2020 2020   and.           
+00049b00: 2074 6865 7265 2069 7320 616e 2058 2061   there is an X a
+00049b10: 7869 732c 2063 7265 6174 6520 616e 6420  xis, create and 
+00049b20: 706c 6163 6520 616e 2061 7070 726f 7072  place an appropr
+00049b30: 6961 7465 206c 6162 656c 2e0a 2020 2020  iate label..    
+00049b40: 2020 2020 3a70 6172 616d 206c 6973 7420      :param list 
+00049b50: 785f 6c69 6d3a 2041 206c 6973 7420 6f66  x_lim: A list of
+00049b60: 2073 697a 6520 7477 6f20 6769 7669 6e67   size two giving
+00049b70: 2074 6865 2067 656e 6f6d 6963 2070 6f73   the genomic pos
+00049b80: 6974 696f 6e73 2062 6574 7765 656e 2077  itions between w
+00049b90: 6869 6368 0a20 2020 2020 2020 2020 2020  hich.           
+00049ba0: 2074 7265 6573 2073 686f 756c 6420 6265   trees should be
+00049bb0: 2070 6c6f 7474 6564 2e20 4966 2074 6865   plotted. If the
+00049bc0: 2066 6972 7374 2069 7320 6060 4e6f 6e65   first is ``None
+00049bd0: 6060 2c20 7468 656e 2070 6c6f 7420 6672  ``, then plot fr
+00049be0: 6f6d 2074 6865 2066 6972 7374 0a20 2020  om the first.   
+00049bf0: 2020 2020 2020 2020 206e 6f6e 2d65 6d70           non-emp
+00049c00: 7479 2072 6567 696f 6e20 6f66 2074 6865  ty region of the
+00049c10: 2074 7265 6520 7365 7175 656e 6365 2e20   tree sequence. 
+00049c20: 4966 2074 6865 2073 6563 6f6e 6420 6973  If the second is
+00049c30: 2060 604e 6f6e 6560 602c 2074 6865 6e20   ``None``, then 
+00049c40: 706c 6f74 0a20 2020 2020 2020 2020 2020  plot.           
+00049c50: 2075 7020 746f 2074 6865 2065 6e64 206f   up to the end o
+00049c60: 6620 7468 6520 6c61 7374 206e 6f6e 2d65  f the last non-e
+00049c70: 6d70 7479 2072 6567 696f 6e20 6f66 2074  mpty region of t
+00049c80: 6865 2074 7265 6520 7365 7175 656e 6365  he tree sequence
+00049c90: 2e20 5468 6520 6465 6661 756c 740a 2020  . The default.  
+00049ca0: 2020 2020 2020 2020 2020 7661 6c75 6520            value 
+00049cb0: 6060 785f 6c69 6d3d 4e6f 6e65 6060 2069  ``x_lim=None`` i
+00049cc0: 7320 7368 6f72 7468 616e 6420 666f 7220  s shorthand for 
+00049cd0: 7468 6520 6c69 7374 205b 6060 4e6f 6e65  the list [``None
+00049ce0: 6060 2c20 6060 4e6f 6e65 6060 5d2e 2049  ``, ``None``]. I
+00049cf0: 660a 2020 2020 2020 2020 2020 2020 6e75  f.            nu
+00049d00: 6d65 7269 6361 6c20 7661 6c75 6573 2061  merical values a
+00049d10: 7265 2067 6976 656e 2c20 7468 656e 2072  re given, then r
+00049d20: 6567 696f 6e73 206f 7574 7369 6465 2074  egions outside t
+00049d30: 6865 2069 6e74 6572 7661 6c20 6861 7665  he interval have
+00049d40: 2061 6c6c 0a20 2020 2020 2020 2020 2020   all.           
+00049d50: 2069 6e66 6f72 6d61 7469 6f6e 2064 6973   information dis
+00049d60: 6361 7264 6564 3a20 7468 6973 206d 6561  carded: this mea
+00049d70: 6e73 2074 6861 7420 6d75 7461 7469 6f6e  ns that mutation
+00049d80: 7320 6f75 7473 6964 6520 7468 6520 696e  s outside the in
+00049d90: 7465 7276 616c 2077 696c 6c0a 2020 2020  terval will.    
+00049da0: 2020 2020 2020 2020 6e6f 7420 6265 2073          not be s
+00049db0: 686f 776e 2e20 546f 2066 6f72 6365 2064  hown. To force d
+00049dc0: 6973 706c 6179 206f 6620 7468 6520 656e  isplay of the en
+00049dd0: 7469 7265 2074 7265 6520 7365 7175 656e  tire tree sequen
+00049de0: 6365 2c20 696e 636c 7564 696e 6720 656d  ce, including em
+00049df0: 7074 790a 2020 2020 2020 2020 2020 2020  pty.            
+00049e00: 666c 616e 6b69 6e67 2072 6567 696f 6e73  flanking regions
+00049e10: 2c20 7370 6563 6966 7920 6060 785f 6c69  , specify ``x_li
+00049e20: 6d3d 5b30 2c20 7473 2e73 6571 7565 6e63  m=[0, ts.sequenc
+00049e30: 655f 6c65 6e67 7468 5d60 602e 0a20 2020  e_length]``..   
+00049e40: 2020 2020 203a 7061 7261 6d20 626f 6f6c       :param bool
+00049e50: 2079 5f61 7869 733a 2053 686f 756c 6420   y_axis: Should 
+00049e60: 7468 6520 706c 6f74 2068 6176 6520 616e  the plot have an
+00049e70: 2059 2061 7869 7320 6c69 6e65 2c20 7368   Y axis line, sh
+00049e80: 6f77 696e 6720 7469 6d65 2028 6f72 0a20  owing time (or. 
+00049e90: 2020 2020 2020 2020 2020 2072 616e 6b65             ranke
+00049ea0: 6420 6e6f 6465 2074 696d 6520 6966 2060  d node time if `
+00049eb0: 6074 696d 655f 7363 616c 653d 2272 616e  `time_scale="ran
+00049ec0: 6b22 6060 2e20 4966 2060 604e 6f6e 6560  k"``. If ``None`
+00049ed0: 6020 2864 6566 6175 6c74 290a 2020 2020  ` (default).    
+00049ee0: 2020 2020 2020 2020 646f 206e 6f74 2070          do not p
+00049ef0: 6c6f 7420 6120 5920 6178 6973 2e0a 2020  lot a Y axis..  
+00049f00: 2020 2020 2020 3a70 6172 616d 2073 7472        :param str
+00049f10: 2079 5f6c 6162 656c 3a20 506c 6163 6520   y_label: Place 
+00049f20: 6120 6c61 6265 6c20 746f 2074 6865 206c  a label to the l
+00049f30: 6566 7420 6f66 2074 6865 2070 6c6f 742e  eft of the plot.
+00049f40: 2049 6620 6060 4e6f 6e65 6060 2028 6465   If ``None`` (de
+00049f50: 6661 756c 7429 0a20 2020 2020 2020 2020  fault).         
+00049f60: 2020 2061 6e64 2074 6865 7265 2069 7320     and there is 
+00049f70: 6120 5920 6178 6973 2c20 6372 6561 7465  a Y axis, create
+00049f80: 2061 6e64 2070 6c61 6365 2061 6e20 6170   and place an ap
+00049f90: 7072 6f70 7269 6174 6520 6c61 6265 6c2e  propriate label.
+00049fa0: 0a20 2020 2020 2020 203a 7061 7261 6d20  .        :param 
+00049fb0: 6c69 7374 2079 5f74 6963 6b73 3a20 4120  list y_ticks: A 
+00049fc0: 6c69 7374 206f 6620 5920 7661 6c75 6573  list of Y values
+00049fd0: 2061 7420 7768 6963 6820 746f 2070 6c6f   at which to plo
+00049fe0: 7420 7469 636b 6d61 726b 7320 2860 605b  t tickmarks (``[
+00049ff0: 5d60 600a 2020 2020 2020 2020 2020 2020  ]``.            
+0004a000: 6769 7665 7320 6e6f 2074 6963 6b6d 6172  gives no tickmar
+0004a010: 6b73 292e 2049 6620 6060 4e6f 6e65 6060  ks). If ``None``
+0004a020: 2c20 706c 6f74 206f 6e65 2074 6963 6b6d  , plot one tickm
+0004a030: 6172 6b20 666f 7220 6561 6368 2075 6e69  ark for each uni
+0004a040: 7175 650a 2020 2020 2020 2020 2020 2020  que.            
+0004a050: 6e6f 6465 2076 616c 7565 2e0a 2020 2020  node value..    
+0004a060: 2020 2020 3a70 6172 616d 2062 6f6f 6c20      :param bool 
+0004a070: 795f 6772 6964 6c69 6e65 733a 2057 6865  y_gridlines: Whe
+0004a080: 7468 6572 2074 6f20 706c 6f74 2068 6f72  ther to plot hor
+0004a090: 697a 6f6e 7461 6c20 6c69 6e65 7320 6265  izontal lines be
+0004a0a0: 6869 6e64 2074 6865 2074 7265 650a 2020  hind the tree.  
+0004a0b0: 2020 2020 2020 2020 2020 6174 2065 6163            at eac
+0004a0c0: 6820 7920 7469 636b 6d61 726b 2e0a 2020  h y tickmark..  
+0004a0d0: 2020 2020 2020 3a70 6172 616d 2062 6f6f        :param boo
+0004a0e0: 6c20 6f6d 6974 5f73 6974 6573 3a20 4966  l omit_sites: If
+0004a0f0: 2054 7275 652c 206f 6d69 7420 7369 7465   True, omit site
+0004a100: 7320 616e 6420 6d75 7461 7469 6f6e 7320  s and mutations 
+0004a110: 6672 6f6d 2074 6865 2064 7261 7769 6e67  from the drawing
+0004a120: 2e0a 2020 2020 2020 2020 2020 2020 4465  ..            De
+0004a130: 6661 756c 743a 2046 616c 7365 0a20 2020  fault: False.   
+0004a140: 2020 2020 203a 7061 7261 6d20 7475 706c       :param tupl
+0004a150: 6528 696e 742c 2069 6e74 2920 6361 6e76  e(int, int) canv
+0004a160: 6173 5f73 697a 653a 2054 6865 2028 7769  as_size: The (wi
+0004a170: 6474 682c 2068 6569 6768 7429 206f 6620  dth, height) of 
+0004a180: 7468 6520 5356 4720 6361 6e76 6173 2e0a  the SVG canvas..
+0004a190: 2020 2020 2020 2020 2020 2020 5468 6973              This
+0004a1a0: 2077 696c 6c20 6368 616e 6765 2074 6865   will change the
+0004a1b0: 2053 5647 2077 6964 7468 2061 6e64 2068   SVG width and h
+0004a1c0: 6569 6768 7420 7769 7468 6f75 7420 7265  eight without re
+0004a1d0: 7363 616c 696e 6720 6772 6170 6869 6361  scaling graphica
+0004a1e0: 6c0a 2020 2020 2020 2020 2020 2020 656c  l.            el
+0004a1f0: 656d 656e 7473 2c20 616c 6c6f 7769 6e67  ements, allowing
+0004a200: 2065 7874 7261 2072 6f6f 6d20 652e 672e   extra room e.g.
+0004a210: 2066 6f72 2075 6e75 7375 616c 6c79 206c   for unusually l
+0004a220: 6f6e 6720 6c61 6265 6c73 2e20 4966 2060  ong labels. If `
+0004a230: 604e 6f6e 6560 600a 2020 2020 2020 2020  `None``.        
+0004a240: 2020 2020 7461 6b65 2074 6865 2063 616e      take the can
+0004a250: 7661 7320 7369 7a65 2074 6f20 6265 2074  vas size to be t
+0004a260: 6865 2073 616d 6520 6173 2074 6865 2074  he same as the t
+0004a270: 6172 6765 7420 6472 6177 696e 6720 7369  arget drawing si
+0004a280: 7a65 2028 7365 650a 2020 2020 2020 2020  ze (see.        
+0004a290: 2020 2020 6060 7369 7a65 6060 2c20 6162      ``size``, ab
+0004a2a0: 6f76 6529 2e20 4465 6661 756c 743a 204e  ove). Default: N
+0004a2b0: 6f6e 650a 2020 2020 2020 2020 3a70 6172  one.        :par
+0004a2c0: 616d 2069 6e74 206d 6178 5f6e 756d 5f74  am int max_num_t
+0004a2d0: 7265 6573 3a20 5468 6520 6d61 7869 6d75  rees: The maximu
+0004a2e0: 6d20 6e75 6d62 6572 206f 6620 7472 6565  m number of tree
+0004a2f0: 7320 746f 2070 6c6f 742e 2049 6620 7468  s to plot. If th
+0004a300: 6572 6520 6172 650a 2020 2020 2020 2020  ere are.        
+0004a310: 2020 2020 6d6f 7265 2074 7265 6573 2074      more trees t
+0004a320: 6861 6e20 7468 6973 2069 6e20 7468 6520  han this in the 
+0004a330: 7472 6565 2073 6571 7565 6e63 652c 2074  tree sequence, t
+0004a340: 6865 206d 6964 646c 6520 7472 6565 7320  he middle trees 
+0004a350: 7769 6c6c 2062 6520 736b 6970 7065 640a  will be skipped.
+0004a360: 2020 2020 2020 2020 2020 2020 6672 6f6d              from
+0004a370: 2074 6865 2070 6c6f 7420 616e 6420 6120   the plot and a 
+0004a380: 6d65 7373 6167 6520 2258 5820 7472 6565  message "XX tree
+0004a390: 7320 736b 6970 7065 6422 2064 6973 706c  s skipped" displ
+0004a3a0: 6179 6564 2069 6e20 7468 6569 7220 706c  ayed in their pl
+0004a3b0: 6163 652e 0a20 2020 2020 2020 2020 2020  ace..           
+0004a3c0: 2049 6620 6060 4e6f 6e65 6060 2c20 616c   If ``None``, al
+0004a3d0: 6c20 7468 6520 7472 6565 7320 7769 6c6c  l the trees will
+0004a3e0: 2062 6520 706c 6f74 7465 643a 2074 6869   be plotted: thi
+0004a3f0: 7320 6361 6e20 7072 6f64 7563 6520 6120  s can produce a 
+0004a400: 7665 7279 2077 6964 650a 2020 2020 2020  very wide.      
+0004a410: 2020 2020 2020 706c 6f74 2069 6620 7468        plot if th
+0004a420: 6572 6520 6172 6520 6d61 6e79 2074 7265  ere are many tre
+0004a430: 6573 2069 6e20 7468 6520 7472 6565 2073  es in the tree s
+0004a440: 6571 7565 6e63 652e 2044 6566 6175 6c74  equence. Default
+0004a450: 3a20 4e6f 6e65 0a0a 2020 2020 2020 2020  : None..        
+0004a460: 3a72 6574 7572 6e3a 2041 6e20 5356 4720  :return: An SVG 
+0004a470: 7265 7072 6573 656e 7461 7469 6f6e 206f  representation o
+0004a480: 6620 6120 7472 6565 2073 6571 7565 6e63  f a tree sequenc
+0004a490: 652e 0a20 2020 2020 2020 203a 7274 7970  e..        :rtyp
+0004a4a0: 653a 2053 5647 5374 7269 6e67 0a0a 2020  e: SVGString..  
+0004a4b0: 2020 2020 2020 2e2e 206e 6f74 653a 3a0a        .. note::.
+0004a4c0: 2020 2020 2020 2020 2020 2020 5465 6368              Tech
+0004a4d0: 6e69 6361 6c6c 792c 2078 5f6c 696d 5b30  nically, x_lim[0
+0004a4e0: 5d20 7370 6563 6966 6965 7320 6120 2a6d  ] specifies a *m
+0004a4f0: 696e 696d 756d 2a20 7661 6c75 6520 666f  inimum* value fo
+0004a500: 7220 7468 6520 7374 6172 7420 6f66 2074  r the start of t
+0004a510: 6865 2058 0a20 2020 2020 2020 2020 2020  he X.           
+0004a520: 2061 7869 732c 2061 6e64 2078 5f6c 696d   axis, and x_lim
+0004a530: 5b31 5d20 7370 6563 6966 6965 7320 6120  [1] specifies a 
+0004a540: 2a6d 6178 696d 756d 2a20 7661 6c75 6520  *maximum* value 
+0004a550: 666f 7220 7468 6520 656e 642e 2054 6869  for the end. Thi
+0004a560: 7320 6973 206f 6e6c 790a 2020 2020 2020  s is only.      
+0004a570: 2020 2020 2020 7265 6c65 7661 6e74 2069        relevant i
+0004a580: 6620 7468 6520 7472 6565 2073 6571 7565  f the tree seque
+0004a590: 6e63 6520 636f 6e74 6169 6e73 2022 656d  nce contains "em
+0004a5a0: 7074 7922 2072 6567 696f 6e73 2077 6974  pty" regions wit
+0004a5b0: 6820 6e6f 2065 6467 6573 206f 720a 2020  h no edges or.  
+0004a5c0: 2020 2020 2020 2020 2020 6d75 7461 7469            mutati
+0004a5d0: 6f6e 732e 2049 6e20 7468 6973 2063 6173  ons. In this cas
+0004a5e0: 6520 6966 2078 5f6c 696d 5b30 5d20 6c69  e if x_lim[0] li
+0004a5f0: 6573 2073 7472 6963 746c 7920 7769 7468  es strictly with
+0004a600: 696e 2061 6e20 656d 7074 7920 7265 6769  in an empty regi
+0004a610: 6f6e 0a20 2020 2020 2020 2020 2020 2028  on.            (
+0004a620: 692e 652e 2c20 6060 656d 7074 795f 7472  i.e., ``empty_tr
+0004a630: 6565 2e69 6e74 6572 7661 6c2e 6c65 6674  ee.interval.left
+0004a640: 203c 2078 5f6c 696d 5b30 5d20 3c20 656d   < x_lim[0] < em
+0004a650: 7074 795f 7472 6565 2e69 6e74 6572 7661  pty_tree.interva
+0004a660: 6c2e 7269 6768 7460 6029 0a20 2020 2020  l.right``).     
+0004a670: 2020 2020 2020 2074 6865 6e20 7468 6174         then that
+0004a680: 2074 7265 6520 7769 6c6c 206e 6f74 2062   tree will not b
+0004a690: 6520 706c 6f74 7465 6420 6f6e 2074 6865  e plotted on the
+0004a6a0: 206c 6566 7420 6861 6e64 2073 6964 652c   left hand side,
+0004a6b0: 2061 6e64 2074 6865 2058 2061 7869 730a   and the X axis.
+0004a6c0: 2020 2020 2020 2020 2020 2020 7769 6c6c              will
+0004a6d0: 2073 7461 7274 2061 7420 6060 656d 7074   start at ``empt
+0004a6e0: 795f 7472 6565 2e69 6e74 6572 7661 6c2e  y_tree.interval.
+0004a6f0: 7269 6768 7460 602e 2053 696d 696c 6172  right``. Similar
+0004a700: 6c79 2c20 6966 2078 5f6c 696d 5b31 5d20  ly, if x_lim[1] 
+0004a710: 6c69 6573 0a20 2020 2020 2020 2020 2020  lies.           
+0004a720: 2073 7472 6963 746c 7920 7769 7468 696e   strictly within
+0004a730: 2061 6e20 656d 7074 7920 7265 6769 6f6e   an empty region
+0004a740: 2074 6865 6e20 7468 6174 2074 7265 6520   then that tree 
+0004a750: 7769 6c6c 206e 6f74 2062 6520 706c 6f74  will not be plot
+0004a760: 7465 6420 6f6e 2074 6865 0a20 2020 2020  ted on the.     
+0004a770: 2020 2020 2020 2072 6967 6874 2068 616e         right han
+0004a780: 6420 7369 6465 2c20 616e 6420 7468 6520  d side, and the 
+0004a790: 5820 6178 6973 2077 696c 6c20 656e 6420  X axis will end 
+0004a7a0: 6174 2060 6065 6d70 7479 5f74 7265 652e  at ``empty_tree.
+0004a7b0: 696e 7465 7276 616c 2e6c 6566 7460 600a  interval.left``.
+0004a7c0: 2020 2020 2020 2020 2222 220a 2020 2020          """.    
+0004a7d0: 2020 2020 6472 6177 203d 2064 7261 7769      draw = drawi
+0004a7e0: 6e67 2e53 7667 5472 6565 5365 7175 656e  ng.SvgTreeSequen
+0004a7f0: 6365 280a 2020 2020 2020 2020 2020 2020  ce(.            
+0004a800: 7365 6c66 2c0a 2020 2020 2020 2020 2020  self,.          
+0004a810: 2020 7369 7a65 2c0a 2020 2020 2020 2020    size,.        
+0004a820: 2020 2020 785f 7363 616c 653d 785f 7363      x_scale=x_sc
+0004a830: 616c 652c 0a20 2020 2020 2020 2020 2020  ale,.           
+0004a840: 2074 696d 655f 7363 616c 653d 7469 6d65   time_scale=time
+0004a850: 5f73 6361 6c65 2c0a 2020 2020 2020 2020  _scale,.        
+0004a860: 2020 2020 7472 6565 5f68 6569 6768 745f      tree_height_
+0004a870: 7363 616c 653d 7472 6565 5f68 6569 6768  scale=tree_heigh
+0004a880: 745f 7363 616c 652c 0a20 2020 2020 2020  t_scale,.       
+0004a890: 2020 2020 206e 6f64 655f 6c61 6265 6c73       node_labels
+0004a8a0: 3d6e 6f64 655f 6c61 6265 6c73 2c0a 2020  =node_labels,.  
+0004a8b0: 2020 2020 2020 2020 2020 6d75 7461 7469            mutati
+0004a8c0: 6f6e 5f6c 6162 656c 733d 6d75 7461 7469  on_labels=mutati
+0004a8d0: 6f6e 5f6c 6162 656c 732c 0a20 2020 2020  on_labels,.     
+0004a8e0: 2020 2020 2020 2072 6f6f 745f 7376 675f         root_svg_
+0004a8f0: 6174 7472 6962 7574 6573 3d72 6f6f 745f  attributes=root_
+0004a900: 7376 675f 6174 7472 6962 7574 6573 2c0a  svg_attributes,.
+0004a910: 2020 2020 2020 2020 2020 2020 7374 796c              styl
+0004a920: 653d 7374 796c 652c 0a20 2020 2020 2020  e=style,.       
+0004a930: 2020 2020 206f 7264 6572 3d6f 7264 6572       order=order
+0004a940: 2c0a 2020 2020 2020 2020 2020 2020 666f  ,.            fo
+0004a950: 7263 655f 726f 6f74 5f62 7261 6e63 683d  rce_root_branch=
+0004a960: 666f 7263 655f 726f 6f74 5f62 7261 6e63  force_root_branc
+0004a970: 682c 0a20 2020 2020 2020 2020 2020 2073  h,.            s
+0004a980: 796d 626f 6c5f 7369 7a65 3d73 796d 626f  ymbol_size=symbo
+0004a990: 6c5f 7369 7a65 2c0a 2020 2020 2020 2020  l_size,.        
+0004a9a0: 2020 2020 785f 6178 6973 3d78 5f61 7869      x_axis=x_axi
+0004a9b0: 732c 0a20 2020 2020 2020 2020 2020 2078  s,.            x
+0004a9c0: 5f6c 6162 656c 3d78 5f6c 6162 656c 2c0a  _label=x_label,.
+0004a9d0: 2020 2020 2020 2020 2020 2020 785f 6c69              x_li
+0004a9e0: 6d3d 785f 6c69 6d2c 0a20 2020 2020 2020  m=x_lim,.       
+0004a9f0: 2020 2020 2079 5f61 7869 733d 795f 6178       y_axis=y_ax
+0004aa00: 6973 2c0a 2020 2020 2020 2020 2020 2020  is,.            
+0004aa10: 795f 6c61 6265 6c3d 795f 6c61 6265 6c2c  y_label=y_label,
+0004aa20: 0a20 2020 2020 2020 2020 2020 2079 5f74  .            y_t
+0004aa30: 6963 6b73 3d79 5f74 6963 6b73 2c0a 2020  icks=y_ticks,.  
+0004aa40: 2020 2020 2020 2020 2020 795f 6772 6964            y_grid
+0004aa50: 6c69 6e65 733d 795f 6772 6964 6c69 6e65  lines=y_gridline
+0004aa60: 732c 0a20 2020 2020 2020 2020 2020 206f  s,.            o
+0004aa70: 6d69 745f 7369 7465 733d 6f6d 6974 5f73  mit_sites=omit_s
+0004aa80: 6974 6573 2c0a 2020 2020 2020 2020 2020  ites,.          
+0004aa90: 2020 6361 6e76 6173 5f73 697a 653d 6361    canvas_size=ca
+0004aaa0: 6e76 6173 5f73 697a 652c 0a20 2020 2020  nvas_size,.     
+0004aab0: 2020 2020 2020 206d 6178 5f6e 756d 5f74         max_num_t
+0004aac0: 7265 6573 3d6d 6178 5f6e 756d 5f74 7265  rees=max_num_tre
+0004aad0: 6573 2c0a 2020 2020 2020 2020 2020 2020  es,.            
+0004aae0: 2a2a 6b77 6172 6773 2c0a 2020 2020 2020  **kwargs,.      
+0004aaf0: 2020 290a 2020 2020 2020 2020 6f75 7470    ).        outp
+0004ab00: 7574 203d 2064 7261 772e 6472 6177 696e  ut = draw.drawin
+0004ab10: 672e 746f 7374 7269 6e67 2829 0a20 2020  g.tostring().   
+0004ab20: 2020 2020 2069 6620 7061 7468 2069 7320       if path is 
+0004ab30: 6e6f 7420 4e6f 6e65 3a0a 2020 2020 2020  not None:.      
+0004ab40: 2020 2020 2020 2320 544f 444f 2072 656d        # TODO rem
+0004ab50: 6f76 6520 7468 6520 2770 7265 7474 7927  ove the 'pretty'
+0004ab60: 2077 6865 6e20 7765 2061 7265 2064 6f6e   when we are don
+0004ab70: 6520 6465 6275 6767 696e 6720 7468 6973  e debugging this
+0004ab80: 2e0a 2020 2020 2020 2020 2020 2020 6472  ..            dr
+0004ab90: 6177 2e64 7261 7769 6e67 2e73 6176 6561  aw.drawing.savea
+0004aba0: 7328 7061 7468 2c20 7072 6574 7479 3d54  s(path, pretty=T
+0004abb0: 7275 6529 0a20 2020 2020 2020 2072 6574  rue).        ret
+0004abc0: 7572 6e20 6472 6177 696e 672e 5356 4753  urn drawing.SVGS
+0004abd0: 7472 696e 6728 6f75 7470 7574 290a 0a20  tring(output).. 
+0004abe0: 2020 2064 6566 2064 7261 775f 7465 7874     def draw_text
+0004abf0: 280a 2020 2020 2020 2020 7365 6c66 2c0a  (.        self,.
+0004ac00: 2020 2020 2020 2020 2a2c 0a20 2020 2020          *,.     
+0004ac10: 2020 206e 6f64 655f 6c61 6265 6c73 3d4e     node_labels=N
+0004ac20: 6f6e 652c 0a20 2020 2020 2020 2075 7365  one,.        use
+0004ac30: 5f61 7363 6969 3d46 616c 7365 2c0a 2020  _ascii=False,.  
+0004ac40: 2020 2020 2020 7469 6d65 5f6c 6162 656c        time_label
+0004ac50: 5f66 6f72 6d61 743d 4e6f 6e65 2c0a 2020  _format=None,.  
+0004ac60: 2020 2020 2020 706f 7369 7469 6f6e 5f6c        position_l
+0004ac70: 6162 656c 5f66 6f72 6d61 743d 4e6f 6e65  abel_format=None
+0004ac80: 2c0a 2020 2020 2020 2020 6f72 6465 723d  ,.        order=
+0004ac90: 4e6f 6e65 2c0a 2020 2020 2020 2020 2a2a  None,.        **
+0004aca0: 6b77 6172 6773 2c0a 2020 2020 293a 0a20  kwargs,.    ):. 
+0004acb0: 2020 2020 2020 2022 2222 0a20 2020 2020         """.     
+0004acc0: 2020 2043 7265 6174 6520 6120 7465 7874     Create a text
+0004acd0: 2072 6570 7265 7365 6e74 6174 696f 6e20   representation 
+0004ace0: 6f66 2061 2074 7265 6520 7365 7175 656e  of a tree sequen
+0004acf0: 6365 2e0a 0a20 2020 2020 2020 203a 7061  ce...        :pa
+0004ad00: 7261 6d20 6469 6374 206e 6f64 655f 6c61  ram dict node_la
+0004ad10: 6265 6c73 3a20 4966 2073 7065 6369 6669  bels: If specifi
+0004ad20: 6564 2c20 7368 6f77 2063 7573 746f 6d20  ed, show custom 
+0004ad30: 6c61 6265 6c73 2066 6f72 2074 6865 206e  labels for the n
+0004ad40: 6f64 6573 0a20 2020 2020 2020 2020 2020  odes.           
+0004ad50: 2074 6861 7420 6172 6520 7072 6573 656e   that are presen
+0004ad60: 7420 696e 2074 6865 206d 6170 2e20 416e  t in the map. An
+0004ad70: 7920 6e6f 6465 7320 6e6f 7420 7370 6563  y nodes not spec
+0004ad80: 6966 6965 6420 696e 2074 6865 206d 6170  ified in the map
+0004ad90: 2077 696c 6c0a 2020 2020 2020 2020 2020   will.          
+0004ada0: 2020 6e6f 7420 6861 7665 2061 206e 6f64    not have a nod
+0004adb0: 6520 6c61 6265 6c2e 0a20 2020 2020 2020  e label..       
+0004adc0: 203a 7061 7261 6d20 626f 6f6c 2075 7365   :param bool use
+0004add0: 5f61 7363 6969 3a20 4966 2060 6046 616c  _ascii: If ``Fal
+0004ade0: 7365 6060 2028 6465 6661 756c 7429 2074  se`` (default) t
+0004adf0: 6865 6e20 7573 6520 756e 6963 6f64 650a  hen use unicode.
+0004ae00: 2020 2020 2020 2020 2020 2020 6062 6f78              `box
+0004ae10: 2064 7261 7769 6e67 2063 6861 7261 6374   drawing charact
+0004ae20: 6572 7320 5c0a 3c68 7474 7073 3a2f 2f65  ers \.<https://e
+0004ae30: 6e2e 7769 6b69 7065 6469 612e 6f72 672f  n.wikipedia.org/
+0004ae40: 7769 6b69 2f42 6f78 2d64 7261 7769 6e67  wiki/Box-drawing
+0004ae50: 5f63 6861 7261 6374 6572 3e60 5f0a 2020  _character>`_.  
+0004ae60: 2020 2020 2020 2020 2020 746f 2072 656e            to ren
+0004ae70: 6465 7220 7468 6520 7472 6565 2e20 4966  der the tree. If
+0004ae80: 2060 6054 7275 6560 602c 2075 7365 2070   ``True``, use p
+0004ae90: 6c61 696e 2061 7363 6969 2063 6861 7261  lain ascii chara
+0004aea0: 6374 6572 732c 2077 6869 6368 206c 6f6f  cters, which loo
+0004aeb0: 6b0a 2020 2020 2020 2020 2020 2020 6372  k.            cr
+0004aec0: 7564 6572 2062 7574 2061 7265 206c 6573  uder but are les
+0004aed0: 7320 7375 7363 6570 7469 626c 6520 746f  s susceptible to
+0004aee0: 206d 6973 616c 6967 6e6d 656e 7420 6f72   misalignment or
+0004aef0: 2066 6f6e 7420 7375 6273 7469 7475 7469   font substituti
+0004af00: 6f6e 2e0a 2020 2020 2020 2020 2020 2020  on..            
+0004af10: 416c 7465 726e 6174 6976 656c 792c 2069  Alternatively, i
+0004af20: 6620 796f 7520 6172 6520 6861 7669 6e67  f you are having
+0004af30: 2061 6c69 676e 6d65 6e74 2070 726f 626c   alignment probl
+0004af40: 656d 7320 7769 7468 2055 6e69 636f 6465  ems with Unicode
+0004af50: 2c20 796f 7520 6361 6e20 7472 790a 2020  , you can try.  
+0004af60: 2020 2020 2020 2020 2020 6f75 7420 7468            out th
+0004af70: 6520 736f 6c75 7469 6f6e 2064 6f63 756d  e solution docum
+0004af80: 656e 7465 6420 6068 6572 6520 5c0a 3c68  ented `here \.<h
+0004af90: 7474 7073 3a2f 2f67 6974 6875 622e 636f  ttps://github.co
+0004afa0: 6d2f 7473 6b69 742d 6465 762f 7473 6b69  m/tskit-dev/tski
+0004afb0: 742f 6973 7375 6573 2f31 3839 2369 7373  t/issues/189#iss
+0004afc0: 7565 636f 6d6d 656e 742d 3439 3931 3134  uecomment-499114
+0004afd0: 3831 313e 605f 2e0a 2020 2020 2020 2020  811>`_..        
+0004afe0: 3a70 6172 616d 2073 7472 2074 696d 655f  :param str time_
+0004aff0: 6c61 6265 6c5f 666f 726d 6174 3a20 4120  label_format: A 
+0004b000: 7079 7468 6f6e 2066 6f72 6d61 7420 7374  python format st
+0004b010: 7269 6e67 2073 7065 6369 6679 696e 6720  ring specifying 
+0004b020: 7468 6520 666f 726d 6174 2028 652e 672e  the format (e.g.
+0004b030: 0a20 2020 2020 2020 2020 2020 206e 756d  .            num
+0004b040: 6265 7220 6f66 2064 6563 696d 616c 2070  ber of decimal p
+0004b050: 6c61 6365 7320 6f72 2073 6967 6e69 6669  laces or signifi
+0004b060: 6361 6e74 2066 6967 7572 6573 2920 7573  cant figures) us
+0004b070: 6564 2074 6f20 7072 696e 7420 7468 6520  ed to print the 
+0004b080: 6e75 6d65 7269 6361 6c0a 2020 2020 2020  numerical.      
+0004b090: 2020 2020 2020 7469 6d65 2076 616c 7565        time value
+0004b0a0: 7320 6f6e 2074 6865 2074 696d 6520 6178  s on the time ax
+0004b0b0: 6973 2e20 4966 2060 604e 6f6e 6560 602c  is. If ``None``,
+0004b0c0: 2074 6869 7320 6465 6661 756c 7473 2074   this defaults t
+0004b0d0: 6f20 6060 227b 3a2e 3266 7d22 6060 2e0a  o ``"{:.2f}"``..
+0004b0e0: 2020 2020 2020 2020 3a70 6172 616d 2073          :param s
+0004b0f0: 7472 2070 6f73 6974 696f 6e5f 6c61 6265  tr position_labe
+0004b100: 6c5f 666f 726d 6174 3a20 4120 7079 7468  l_format: A pyth
+0004b110: 6f6e 2066 6f72 6d61 7420 7374 7269 6e67  on format string
+0004b120: 2073 7065 6369 6679 696e 6720 7468 6520   specifying the 
+0004b130: 666f 726d 6174 0a20 2020 2020 2020 2020  format.         
+0004b140: 2020 2028 652e 672e 206e 756d 6265 7220     (e.g. number 
+0004b150: 6f66 2064 6563 696d 616c 2070 6c61 6365  of decimal place
+0004b160: 7320 6f72 2073 6967 6e69 6669 6361 6e74  s or significant
+0004b170: 2066 6967 7572 6573 2920 7573 6564 2074   figures) used t
+0004b180: 6f20 7072 696e 7420 6765 6e6f 6d69 630a  o print genomic.
+0004b190: 2020 2020 2020 2020 2020 2020 706f 7369              posi
+0004b1a0: 7469 6f6e 732e 2049 6620 6060 4e6f 6e65  tions. If ``None
+0004b1b0: 6060 2c20 7468 6973 2064 6566 6175 6c74  ``, this default
+0004b1c0: 7320 746f 2060 6022 7b3a 2e32 667d 2260  s to ``"{:.2f}"`
+0004b1d0: 602e 0a20 2020 2020 2020 203a 7061 7261  `..        :para
+0004b1e0: 6d20 7374 7220 6f72 6465 723a 2054 6865  m str order: The
+0004b1f0: 206c 6566 742d 746f 2d72 6967 6874 206f   left-to-right o
+0004b200: 7264 6572 696e 6720 6f66 2063 6869 6c64  rdering of child
+0004b210: 206e 6f64 6573 2069 6e20 7468 6520 6472   nodes in the dr
+0004b220: 6177 6e20 7472 6565 2e0a 2020 2020 2020  awn tree..      
+0004b230: 2020 2020 2020 5468 6973 2063 616e 2062        This can b
+0004b240: 6520 6569 7468 6572 3a20 6060 226d 696e  e either: ``"min
+0004b250: 6c65 7822 6060 2c20 7768 6963 6820 6d69  lex"``, which mi
+0004b260: 6e69 6d69 7365 7320 7468 6520 6469 6666  nimises the diff
+0004b270: 6572 656e 6365 730a 2020 2020 2020 2020  erences.        
+0004b280: 2020 2020 6265 7477 6565 6e20 6164 6a61      between adja
+0004b290: 6365 6e74 2074 7265 6573 2028 7365 6520  cent trees (see 
+0004b2a0: 616c 736f 2074 6865 2060 6022 6d69 6e6c  also the ``"minl
+0004b2b0: 6578 5f70 6f73 746f 7264 6572 2260 6020  ex_postorder"`` 
+0004b2c0: 7472 6176 6572 7361 6c0a 2020 2020 2020  traversal.      
+0004b2d0: 2020 2020 2020 6f72 6465 7220 666f 7220        order for 
+0004b2e0: 7468 6520 3a6d 6574 683a 602e 5472 6565  the :meth:`.Tree
+0004b2f0: 2e6e 6f64 6573 6020 6d65 7468 6f64 293b  .nodes` method);
+0004b300: 206f 7220 6060 2274 7265 6522 6060 2077   or ``"tree"`` w
+0004b310: 6869 6368 2064 7261 7773 2074 7265 6573  hich draws trees
+0004b320: 0a20 2020 2020 2020 2020 2020 2069 6e20  .            in 
+0004b330: 7468 6520 6c65 6674 2d74 6f2d 7269 6768  the left-to-righ
+0004b340: 7420 6f72 6465 7220 6465 6669 6e65 6420  t order defined 
+0004b350: 6279 2074 6865 0a20 2020 2020 2020 2020  by the.         
+0004b360: 2020 203a 7265 663a 6071 7569 6e74 7570     :ref:`quintup
+0004b370: 6c79 206c 696e 6b65 6420 7472 6565 2073  ly linked tree s
+0004b380: 7472 7563 7475 7265 203c 7365 635f 6461  tructure <sec_da
+0004b390: 7461 5f6d 6f64 656c 5f74 7265 655f 7374  ta_model_tree_st
+0004b3a0: 7275 6374 7572 653e 602e 0a20 2020 2020  ructure>`..     
+0004b3b0: 2020 2020 2020 2049 6620 6e6f 7420 7370         If not sp
+0004b3c0: 6563 6966 6965 6420 6f72 204e 6f6e 652c  ecified or None,
+0004b3d0: 2074 6869 7320 6465 6661 756c 7473 2074   this defaults t
+0004b3e0: 6f20 6060 226d 696e 6c65 7822 6060 2e0a  o ``"minlex"``..
+0004b3f0: 0a20 2020 2020 2020 203a 7265 7475 726e  .        :return
+0004b400: 3a20 4120 7465 7874 2072 6570 7265 7365  : A text represe
+0004b410: 6e74 6174 696f 6e20 6f66 2061 2074 7265  ntation of a tre
+0004b420: 6520 7365 7175 656e 6365 2e0a 2020 2020  e sequence..    
+0004b430: 2020 2020 3a72 7479 7065 3a20 7374 720a      :rtype: str.
+0004b440: 2020 2020 2020 2020 2222 220a 2020 2020          """.    
+0004b450: 2020 2020 7265 7475 726e 2073 7472 280a      return str(.
+0004b460: 2020 2020 2020 2020 2020 2020 6472 6177              draw
+0004b470: 696e 672e 5465 7874 5472 6565 5365 7175  ing.TextTreeSequ
+0004b480: 656e 6365 280a 2020 2020 2020 2020 2020  ence(.          
+0004b490: 2020 2020 2020 7365 6c66 2c0a 2020 2020        self,.    
+0004b4a0: 2020 2020 2020 2020 2020 2020 6e6f 6465              node
+0004b4b0: 5f6c 6162 656c 733d 6e6f 6465 5f6c 6162  _labels=node_lab
+0004b4c0: 656c 732c 0a20 2020 2020 2020 2020 2020  els,.           
+0004b4d0: 2020 2020 2075 7365 5f61 7363 6969 3d75       use_ascii=u
+0004b4e0: 7365 5f61 7363 6969 2c0a 2020 2020 2020  se_ascii,.      
+0004b4f0: 2020 2020 2020 2020 2020 7469 6d65 5f6c            time_l
+0004b500: 6162 656c 5f66 6f72 6d61 743d 7469 6d65  abel_format=time
+0004b510: 5f6c 6162 656c 5f66 6f72 6d61 742c 0a20  _label_format,. 
+0004b520: 2020 2020 2020 2020 2020 2020 2020 2070                 p
+0004b530: 6f73 6974 696f 6e5f 6c61 6265 6c5f 666f  osition_label_fo
+0004b540: 726d 6174 3d70 6f73 6974 696f 6e5f 6c61  rmat=position_la
+0004b550: 6265 6c5f 666f 726d 6174 2c0a 2020 2020  bel_format,.    
+0004b560: 2020 2020 2020 2020 2020 2020 6f72 6465              orde
+0004b570: 723d 6f72 6465 722c 0a20 2020 2020 2020  r=order,.       
+0004b580: 2020 2020 2029 0a20 2020 2020 2020 2029       ).        )
+0004b590: 0a0a 2020 2020 2323 2323 2323 2323 2323  ..    ##########
+0004b5a0: 2323 2323 2323 2323 2323 2323 2323 2323  ################
+0004b5b0: 2323 2323 2323 2323 2323 2323 2323 2323  ################
+0004b5c0: 2323 0a20 2020 2023 0a20 2020 2023 2053  ##.    #.    # S
+0004b5d0: 7461 7469 7374 6963 7320 636f 6d70 7574  tatistics comput
+0004b5e0: 6174 696f 6e0a 2020 2020 230a 2020 2020  ation.    #.    
+0004b5f0: 2323 2323 2323 2323 2323 2323 2323 2323  ################
+0004b600: 2323 2323 2323 2323 2323 2323 2323 2323  ################
+0004b610: 2323 2323 2323 2323 2323 2323 0a0a 2020  ############..  
+0004b620: 2020 6465 6620 6765 6e65 7261 6c5f 7374    def general_st
+0004b630: 6174 280a 2020 2020 2020 2020 7365 6c66  at(.        self
+0004b640: 2c0a 2020 2020 2020 2020 572c 0a20 2020  ,.        W,.   
+0004b650: 2020 2020 2066 2c0a 2020 2020 2020 2020       f,.        
+0004b660: 6f75 7470 7574 5f64 696d 2c0a 2020 2020  output_dim,.    
+0004b670: 2020 2020 7769 6e64 6f77 733d 4e6f 6e65      windows=None
+0004b680: 2c0a 2020 2020 2020 2020 706f 6c61 7269  ,.        polari
+0004b690: 7365 643d 4661 6c73 652c 0a20 2020 2020  sed=False,.     
+0004b6a0: 2020 206d 6f64 653d 4e6f 6e65 2c0a 2020     mode=None,.  
+0004b6b0: 2020 2020 2020 7370 616e 5f6e 6f72 6d61        span_norma
+0004b6c0: 6c69 7365 3d54 7275 652c 0a20 2020 2020  lise=True,.     
+0004b6d0: 2020 2073 7472 6963 743d 5472 7565 2c0a     strict=True,.
+0004b6e0: 2020 2020 293a 0a20 2020 2020 2020 2022      ):.        "
+0004b6f0: 2222 0a20 2020 2020 2020 2043 6f6d 7075  "".        Compu
+0004b700: 7465 2061 2077 696e 646f 7765 6420 7374  te a windowed st
+0004b710: 6174 6973 7469 6320 6672 6f6d 2077 6569  atistic from wei
+0004b720: 6768 7473 2061 6e64 2061 2073 756d 6d61  ghts and a summa
+0004b730: 7279 2066 756e 6374 696f 6e2e 0a20 2020  ry function..   
+0004b740: 2020 2020 2053 6565 2074 6865 203a 7265       See the :re
+0004b750: 663a 6073 7461 7469 7374 6963 7320 696e  f:`statistics in
+0004b760: 7465 7266 6163 6520 3c73 6563 5f73 7461  terface <sec_sta
+0004b770: 7473 5f69 6e74 6572 6661 6365 3e60 2073  ts_interface>` s
+0004b780: 6563 7469 6f6e 2066 6f72 2064 6574 6169  ection for detai
+0004b790: 6c73 206f 6e0a 2020 2020 2020 2020 3a72  ls on.        :r
+0004b7a0: 6566 3a60 7769 6e64 6f77 7320 3c73 6563  ef:`windows <sec
+0004b7b0: 5f73 7461 7473 5f77 696e 646f 7773 3e60  _stats_windows>`
+0004b7c0: 2c0a 2020 2020 2020 2020 3a72 6566 3a60  ,.        :ref:`
+0004b7d0: 6d6f 6465 203c 7365 635f 7374 6174 735f  mode <sec_stats_
+0004b7e0: 6d6f 6465 3e60 2c0a 2020 2020 2020 2020  mode>`,.        
+0004b7f0: 3a72 6566 3a60 7370 616e 206e 6f72 6d61  :ref:`span norma
+0004b800: 6c69 7365 203c 7365 635f 7374 6174 735f  lise <sec_stats_
+0004b810: 7370 616e 5f6e 6f72 6d61 6c69 7365 3e60  span_normalise>`
+0004b820: 2c0a 2020 2020 2020 2020 616e 6420 3a72  ,.        and :r
+0004b830: 6566 3a60 7265 7475 726e 2076 616c 7565  ef:`return value
+0004b840: 203c 7365 635f 7374 6174 735f 6f75 7470   <sec_stats_outp
+0004b850: 7574 5f66 6f72 6d61 743e 602e 0a20 2020  ut_format>`..   
+0004b860: 2020 2020 204f 6e20 6561 6368 2074 7265       On each tre
+0004b870: 652c 2074 6869 730a 2020 2020 2020 2020  e, this.        
+0004b880: 7072 6f70 6167 6174 6573 2074 6865 2077  propagates the w
+0004b890: 6569 6768 7473 2060 6057 6060 2075 7020  eights ``W`` up 
+0004b8a0: 7468 6520 7472 6565 2c20 736f 2074 6861  the tree, so tha
+0004b8b0: 7420 7468 6520 2277 6569 6768 7422 206f  t the "weight" o
+0004b8c0: 6620 6561 6368 0a20 2020 2020 2020 206e  f each.        n
+0004b8d0: 6f64 6520 6973 2074 6865 2073 756d 206f  ode is the sum o
+0004b8e0: 6620 7468 6520 7765 6967 6874 7320 6f66  f the weights of
+0004b8f0: 2061 6c6c 2073 616d 706c 6573 2061 7420   all samples at 
+0004b900: 6f72 2062 656c 6f77 2074 6865 206e 6f64  or below the nod
+0004b910: 652e 0a20 2020 2020 2020 2054 6865 6e20  e..        Then 
+0004b920: 7468 6520 7375 6d6d 6172 7920 6675 6e63  the summary func
+0004b930: 7469 6f6e 2060 6066 6060 2069 7320 6170  tion ``f`` is ap
+0004b940: 706c 6965 6420 746f 2074 6865 2077 6569  plied to the wei
+0004b950: 6768 7473 2c20 6769 7669 6e67 2061 0a20  ghts, giving a. 
+0004b960: 2020 2020 2020 2073 756d 6d61 7279 2066         summary f
+0004b970: 6f72 2065 6163 6820 6e6f 6465 2069 6e20  or each node in 
+0004b980: 6561 6368 2074 7265 652e 2048 6f77 2074  each tree. How t
+0004b990: 6869 7320 6973 2074 6865 6e20 6167 6772  his is then aggr
+0004b9a0: 6567 6174 6564 2064 6570 656e 6473 0a20  egated depends. 
+0004b9b0: 2020 2020 2020 206f 6e20 6060 6d6f 6465         on ``mode
+0004b9c0: 6060 3a0a 0a20 2020 2020 2020 2022 7369  ``:..        "si
+0004b9d0: 7465 220a 2020 2020 2020 2020 2020 2020  te".            
+0004b9e0: 4164 6473 2074 6f67 6574 6865 7220 7468  Adds together th
+0004b9f0: 6520 746f 7461 6c20 7375 6d6d 6172 7920  e total summary 
+0004ba00: 7661 6c75 6520 6163 726f 7373 2061 6c6c  value across all
+0004ba10: 2061 6c6c 656c 6573 2069 6e20 6561 6368   alleles in each
+0004ba20: 2077 696e 646f 772e 0a0a 2020 2020 2020   window...      
+0004ba30: 2020 2262 7261 6e63 6822 0a20 2020 2020    "branch".     
+0004ba40: 2020 2020 2020 2041 6464 7320 746f 6765         Adds toge
+0004ba50: 7468 6572 2074 6865 2073 756d 6d61 7279  ther the summary
+0004ba60: 2076 616c 7565 2066 6f72 2065 6163 6820   value for each 
+0004ba70: 6e6f 6465 2c20 6d75 6c74 6970 6c69 6564  node, multiplied
+0004ba80: 2062 7920 7468 650a 2020 2020 2020 2020   by the.        
+0004ba90: 2020 2020 6c65 6e67 7468 206f 6620 7468      length of th
+0004baa0: 6520 6272 616e 6368 2061 626f 7665 2074  e branch above t
+0004bab0: 6865 206e 6f64 6520 616e 6420 7468 6520  he node and the 
+0004bac0: 7370 616e 206f 6620 7468 6520 7472 6565  span of the tree
+0004bad0: 2e0a 0a20 2020 2020 2020 2022 6e6f 6465  ...        "node
+0004bae0: 220a 2020 2020 2020 2020 2020 2020 5265  ".            Re
+0004baf0: 7475 726e 7320 6561 6368 206e 6f64 6527  turns each node'
+0004bb00: 7320 7375 6d6d 6172 7920 7661 6c75 6520  s summary value 
+0004bb10: 6164 6465 6420 6163 726f 7373 2074 7265  added across tre
+0004bb20: 6573 2061 6e64 206d 756c 7469 706c 6965  es and multiplie
+0004bb30: 640a 2020 2020 2020 2020 2020 2020 6279  d.            by
+0004bb40: 2074 6865 2073 7061 6e20 6f66 2074 6865   the span of the
+0004bb50: 2074 7265 652e 0a0a 2020 2020 2020 2020   tree...        
+0004bb60: 426f 7468 2074 6865 2077 6569 6768 7473  Both the weights
+0004bb70: 2061 6e64 2074 6865 2073 756d 6d61 7279   and the summary
+0004bb80: 2063 616e 2062 6520 6d75 6c74 6964 696d   can be multidim
+0004bb90: 656e 7369 6f6e 616c 3a20 6966 2060 6057  ensional: if ``W
+0004bba0: 6060 2068 6173 2060 606b 6060 0a20 2020  `` has ``k``.   
+0004bbb0: 2020 2020 2063 6f6c 756d 6e73 2c20 616e       columns, an
+0004bbc0: 6420 6060 6660 6020 7461 6b65 7320 6120  d ``f`` takes a 
+0004bbd0: 6060 6b60 602d 7665 6374 6f72 2061 6e64  ``k``-vector and
+0004bbe0: 2072 6574 7572 6e73 2061 6e20 6060 6d60   returns an ``m`
+0004bbf0: 602d 7665 6374 6f72 2c0a 2020 2020 2020  `-vector,.      
+0004bc00: 2020 7468 656e 2074 6865 206f 7574 7075    then the outpu
+0004bc10: 7420 7769 6c6c 2062 6520 6060 6d60 602d  t will be ``m``-
+0004bc20: 6469 6d65 6e73 696f 6e61 6c20 666f 7220  dimensional for 
+0004bc30: 6561 6368 206e 6f64 6520 6f72 2077 696e  each node or win
+0004bc40: 646f 7720 2864 6570 656e 6469 6e67 0a20  dow (depending. 
+0004bc50: 2020 2020 2020 206f 6e20 226d 6f64 6522         on "mode"
+0004bc60: 292e 0a0a 2020 2020 2020 2020 2e2e 206e  )...        .. n
+0004bc70: 6f74 653a 3a0a 2020 2020 2020 2020 2020  ote::.          
+0004bc80: 2020 5468 6520 7375 6d6d 6172 7920 6675    The summary fu
+0004bc90: 6e63 7469 6f6e 2060 6066 6060 2073 686f  nction ``f`` sho
+0004bca0: 756c 6420 7265 7475 726e 207a 6572 6f20  uld return zero 
+0004bcb0: 7768 656e 2067 6976 656e 2062 6f74 6820  when given both 
+0004bcc0: 3020 616e 640a 2020 2020 2020 2020 2020  0 and.          
+0004bcd0: 2020 7468 6520 746f 7461 6c20 7765 6967    the total weig
+0004bce0: 6874 2028 692e 652e 2c20 6060 6628 3029  ht (i.e., ``f(0)
+0004bcf0: 203d 2030 6060 2061 6e64 2060 6066 286e   = 0`` and ``f(n
+0004bd00: 702e 7375 6d28 572c 2061 7869 733d 3029  p.sum(W, axis=0)
+0004bd10: 2920 3d20 3060 6029 2c0a 2020 2020 2020  ) = 0``),.      
+0004bd20: 2020 2020 2020 756e 6c65 7373 2060 6073        unless ``s
+0004bd30: 7472 6963 743d 4661 6c73 6560 602e 2020  trict=False``.  
+0004bd40: 5468 6973 2069 7320 6e65 6365 7373 6172  This is necessar
+0004bd50: 7920 666f 7220 7468 6520 7374 6174 6973  y for the statis
+0004bd60: 7469 6320 746f 2062 650a 2020 2020 2020  tic to be.      
+0004bd70: 2020 2020 2020 756e 6166 6665 6374 6564        unaffected
+0004bd80: 2062 7920 7061 7274 7320 6f66 2074 6865   by parts of the
+0004bd90: 2074 7265 6520 7365 7175 656e 6365 2061   tree sequence a
+0004bda0: 6e63 6573 7472 616c 2074 6f20 6e6f 6e65  ncestral to none
+0004bdb0: 206f 7220 616c 6c0a 2020 2020 2020 2020   or all.        
+0004bdc0: 2020 2020 6f66 2074 6865 2073 616d 706c      of the sampl
+0004bdd0: 6573 2c20 7265 7370 6563 7469 7665 6c79  es, respectively
+0004bde0: 2e0a 0a20 2020 2020 2020 203a 7061 7261  ...        :para
+0004bdf0: 6d20 6e75 6d70 792e 6e64 6172 7261 7920  m numpy.ndarray 
+0004be00: 573a 2041 6e20 6172 7261 7920 6f66 2076  W: An array of v
+0004be10: 616c 7565 7320 7769 7468 206f 6e65 2072  alues with one r
+0004be20: 6f77 2066 6f72 2065 6163 6820 7361 6d70  ow for each samp
+0004be30: 6c65 2061 6e64 206f 6e65 0a20 2020 2020  le and one.     
+0004be40: 2020 2020 2020 2063 6f6c 756d 6e20 666f         column fo
+0004be50: 7220 6561 6368 2077 6569 6768 742e 0a20  r each weight.. 
+0004be60: 2020 2020 2020 203a 7061 7261 6d20 663a         :param f:
+0004be70: 2041 2066 756e 6374 696f 6e20 7468 6174   A function that
+0004be80: 2074 616b 6573 2061 206f 6e65 2d64 696d   takes a one-dim
+0004be90: 656e 7369 6f6e 616c 2061 7272 6179 206f  ensional array o
+0004bea0: 6620 6c65 6e67 7468 0a20 2020 2020 2020  f length.       
+0004beb0: 2020 2020 2065 7175 616c 2074 6f20 7468       equal to th
+0004bec0: 6520 6e75 6d62 6572 206f 6620 636f 6c75  e number of colu
+0004bed0: 6d6e 7320 6f66 2060 6057 6060 2061 6e64  mns of ``W`` and
+0004bee0: 2072 6574 7572 6e73 2061 206f 6e65 2d64   returns a one-d
+0004bef0: 696d 656e 7369 6f6e 616c 0a20 2020 2020  imensional.     
+0004bf00: 2020 2020 2020 2061 7272 6179 2e0a 2020         array..  
+0004bf10: 2020 2020 2020 3a70 6172 616d 2069 6e74        :param int
+0004bf20: 206f 7574 7075 745f 6469 6d3a 2054 6865   output_dim: The
+0004bf30: 206c 656e 6774 6820 6f66 2060 6066 6060   length of ``f``
+0004bf40: 2773 2072 6574 7572 6e20 7661 6c75 652e  's return value.
+0004bf50: 0a20 2020 2020 2020 203a 7061 7261 6d20  .        :param 
+0004bf60: 6c69 7374 2077 696e 646f 7773 3a20 416e  list windows: An
+0004bf70: 2069 6e63 7265 6173 696e 6720 6c69 7374   increasing list
+0004bf80: 206f 6620 6272 6561 6b70 6f69 6e74 7320   of breakpoints 
+0004bf90: 6265 7477 6565 6e20 7468 6520 7769 6e64  between the wind
+0004bfa0: 6f77 730a 2020 2020 2020 2020 2020 2020  ows.            
+0004bfb0: 746f 2063 6f6d 7075 7465 2074 6865 2073  to compute the s
+0004bfc0: 7461 7469 7374 6963 2069 6e2e 0a20 2020  tatistic in..   
+0004bfd0: 2020 2020 203a 7061 7261 6d20 626f 6f6c       :param bool
+0004bfe0: 2070 6f6c 6172 6973 6564 3a20 5768 6574   polarised: Whet
+0004bff0: 6865 7220 746f 206c 6561 7665 2074 6865  her to leave the
+0004c000: 2061 6e63 6573 7472 616c 2073 7461 7465   ancestral state
+0004c010: 206f 7574 206f 6620 636f 6d70 7574 6174   out of computat
+0004c020: 696f 6e73 3a0a 2020 2020 2020 2020 2020  ions:.          
+0004c030: 2020 7365 6520 3a72 6566 3a60 7365 635f    see :ref:`sec_
+0004c040: 7374 6174 7360 2066 6f72 206d 6f72 6520  stats` for more 
+0004c050: 6465 7461 696c 732e 0a20 2020 2020 2020  details..       
+0004c060: 203a 7061 7261 6d20 7374 7220 6d6f 6465   :param str mode
+0004c070: 3a20 4120 7374 7269 6e67 2067 6976 696e  : A string givin
+0004c080: 6720 7468 6520 2274 7970 6522 206f 6620  g the "type" of 
+0004c090: 7468 6520 7374 6174 6973 7469 6320 746f  the statistic to
+0004c0a0: 2062 6520 636f 6d70 7574 6564 0a20 2020   be computed.   
+0004c0b0: 2020 2020 2020 2020 2028 6465 6661 756c           (defaul
+0004c0c0: 7473 2074 6f20 2273 6974 6522 292e 0a20  ts to "site").. 
+0004c0d0: 2020 2020 2020 203a 7061 7261 6d20 626f         :param bo
+0004c0e0: 6f6c 2073 7061 6e5f 6e6f 726d 616c 6973  ol span_normalis
+0004c0f0: 653a 2057 6865 7468 6572 2074 6f20 6469  e: Whether to di
+0004c100: 7669 6465 2074 6865 2072 6573 756c 7420  vide the result 
+0004c110: 6279 2074 6865 2073 7061 6e20 6f66 2074  by the span of t
+0004c120: 6865 0a20 2020 2020 2020 2020 2020 2077  he.            w
+0004c130: 696e 646f 7720 2864 6566 6175 6c74 7320  indow (defaults 
+0004c140: 746f 2054 7275 6529 2e0a 2020 2020 2020  to True)..      
+0004c150: 2020 3a70 6172 616d 2062 6f6f 6c20 7374    :param bool st
+0004c160: 7269 6374 3a20 5768 6574 6865 7220 746f  rict: Whether to
+0004c170: 2063 6865 636b 2074 6861 7420 6628 3029   check that f(0)
+0004c180: 2061 6e64 2066 2874 6f74 616c 2077 6569   and f(total wei
+0004c190: 6768 7429 2061 7265 207a 6572 6f2e 0a20  ght) are zero.. 
+0004c1a0: 2020 2020 2020 203a 7265 7475 726e 3a20         :return: 
+0004c1b0: 4120 6e64 6172 7261 7920 7769 7468 2073  A ndarray with s
+0004c1c0: 6861 7065 2065 7175 616c 2074 6f20 286e  hape equal to (n
+0004c1d0: 756d 2077 696e 646f 7773 2c20 6e75 6d20  um windows, num 
+0004c1e0: 7374 6174 6973 7469 6373 292e 0a20 2020  statistics)..   
+0004c1f0: 2020 2020 2022 2222 0a20 2020 2020 2020       """.       
+0004c200: 2069 6620 6d6f 6465 2069 7320 4e6f 6e65   if mode is None
+0004c210: 3a0a 2020 2020 2020 2020 2020 2020 6d6f  :.            mo
+0004c220: 6465 203d 2022 7369 7465 220a 2020 2020  de = "site".    
+0004c230: 2020 2020 6966 2073 7472 6963 743a 0a20      if strict:. 
+0004c240: 2020 2020 2020 2020 2020 2074 6f74 616c             total
+0004c250: 5f77 6569 6768 7473 203d 206e 702e 7375  _weights = np.su
+0004c260: 6d28 572c 2061 7869 733d 3029 0a20 2020  m(W, axis=0).   
+0004c270: 2020 2020 2020 2020 2066 6f72 2078 2069           for x i
+0004c280: 6e20 5b74 6f74 616c 5f77 6569 6768 7473  n [total_weights
+0004c290: 2c20 746f 7461 6c5f 7765 6967 6874 7320  , total_weights 
+0004c2a0: 2a20 302e 305d 3a0a 2020 2020 2020 2020  * 0.0]:.        
+0004c2b0: 2020 2020 2020 2020 7769 7468 206e 702e          with np.
+0004c2c0: 6572 7273 7461 7465 2869 6e76 616c 6964  errstate(invalid
+0004c2d0: 3d22 6967 6e6f 7265 222c 2064 6976 6964  ="ignore", divid
+0004c2e0: 653d 2269 676e 6f72 6522 293a 0a20 2020  e="ignore"):.   
+0004c2f0: 2020 2020 2020 2020 2020 2020 2020 2020                  
+0004c300: 2066 7820 3d20 6e70 2e61 7272 6179 2866   fx = np.array(f
+0004c310: 2878 2929 0a20 2020 2020 2020 2020 2020  (x)).           
+0004c320: 2020 2020 2066 785b 6e70 2e69 736e 616e       fx[np.isnan
+0004c330: 2866 7829 5d20 3d20 302e 300a 2020 2020  (fx)] = 0.0.    
+0004c340: 2020 2020 2020 2020 2020 2020 6966 206e              if n
+0004c350: 6f74 206e 702e 616c 6c63 6c6f 7365 2866  ot np.allclose(f
+0004c360: 782c 206e 702e 7a65 726f 7328 286f 7574  x, np.zeros((out
+0004c370: 7075 745f 6469 6d2c 2929 293a 0a20 2020  put_dim,))):.   
+0004c380: 2020 2020 2020 2020 2020 2020 2020 2020                  
+0004c390: 2072 6169 7365 2056 616c 7565 4572 726f   raise ValueErro
+0004c3a0: 7228 0a20 2020 2020 2020 2020 2020 2020  r(.             
+0004c3b0: 2020 2020 2020 2020 2020 2022 5375 6d6d             "Summ
+0004c3c0: 6172 7920 6675 6e63 7469 6f6e 2064 6f65  ary function doe
+0004c3d0: 7320 6e6f 7420 7265 7475 726e 207a 6572  s not return zer
+0004c3e0: 6f20 666f 7220 626f 7468 2022 0a20 2020  o for both ".   
+0004c3f0: 2020 2020 2020 2020 2020 2020 2020 2020                  
+0004c400: 2020 2020 2022 7a65 726f 2077 6569 6768       "zero weigh
+0004c410: 7420 616e 6420 746f 7461 6c20 7765 6967  t and total weig
+0004c420: 6874 2e22 0a20 2020 2020 2020 2020 2020  ht.".           
+0004c430: 2020 2020 2020 2020 2029 0a20 2020 2020           ).     
+0004c440: 2020 2072 6574 7572 6e20 7365 6c66 2e5f     return self._
+0004c450: 5f72 756e 5f77 696e 646f 7765 645f 7374  _run_windowed_st
+0004c460: 6174 280a 2020 2020 2020 2020 2020 2020  at(.            
+0004c470: 7769 6e64 6f77 732c 0a20 2020 2020 2020  windows,.       
+0004c480: 2020 2020 2073 656c 662e 6c6c 5f74 7265       self.ll_tre
+0004c490: 655f 7365 7175 656e 6365 2e67 656e 6572  e_sequence.gener
+0004c4a0: 616c 5f73 7461 742c 0a20 2020 2020 2020  al_stat,.       
+0004c4b0: 2020 2020 2057 2c0a 2020 2020 2020 2020       W,.        
+0004c4c0: 2020 2020 662c 0a20 2020 2020 2020 2020      f,.         
+0004c4d0: 2020 206f 7574 7075 745f 6469 6d2c 0a20     output_dim,. 
+0004c4e0: 2020 2020 2020 2020 2020 2070 6f6c 6172             polar
+0004c4f0: 6973 6564 3d70 6f6c 6172 6973 6564 2c0a  ised=polarised,.
+0004c500: 2020 2020 2020 2020 2020 2020 7370 616e              span
+0004c510: 5f6e 6f72 6d61 6c69 7365 3d73 7061 6e5f  _normalise=span_
+0004c520: 6e6f 726d 616c 6973 652c 0a20 2020 2020  normalise,.     
+0004c530: 2020 2020 2020 206d 6f64 653d 6d6f 6465         mode=mode
+0004c540: 2c0a 2020 2020 2020 2020 290a 0a20 2020  ,.        )..   
+0004c550: 2064 6566 2073 616d 706c 655f 636f 756e   def sample_coun
+0004c560: 745f 7374 6174 280a 2020 2020 2020 2020  t_stat(.        
+0004c570: 7365 6c66 2c0a 2020 2020 2020 2020 7361  self,.        sa
+0004c580: 6d70 6c65 5f73 6574 732c 0a20 2020 2020  mple_sets,.     
+0004c590: 2020 2066 2c0a 2020 2020 2020 2020 6f75     f,.        ou
+0004c5a0: 7470 7574 5f64 696d 2c0a 2020 2020 2020  tput_dim,.      
+0004c5b0: 2020 7769 6e64 6f77 733d 4e6f 6e65 2c0a    windows=None,.
+0004c5c0: 2020 2020 2020 2020 706f 6c61 7269 7365          polarise
+0004c5d0: 643d 4661 6c73 652c 0a20 2020 2020 2020  d=False,.       
+0004c5e0: 206d 6f64 653d 4e6f 6e65 2c0a 2020 2020   mode=None,.    
+0004c5f0: 2020 2020 7370 616e 5f6e 6f72 6d61 6c69      span_normali
+0004c600: 7365 3d54 7275 652c 0a20 2020 2020 2020  se=True,.       
+0004c610: 2073 7472 6963 743d 5472 7565 2c0a 2020   strict=True,.  
+0004c620: 2020 293a 0a20 2020 2020 2020 2022 2222    ):.        """
+0004c630: 0a20 2020 2020 2020 2043 6f6d 7075 7465  .        Compute
+0004c640: 2061 2077 696e 646f 7765 6420 7374 6174   a windowed stat
+0004c650: 6973 7469 6320 6672 6f6d 2073 616d 706c  istic from sampl
+0004c660: 6520 636f 756e 7473 2061 6e64 2061 2073  e counts and a s
+0004c670: 756d 6d61 7279 2066 756e 6374 696f 6e2e  ummary function.
+0004c680: 0a20 2020 2020 2020 2054 6869 7320 6973  .        This is
+0004c690: 2061 2077 7261 7070 6572 2061 726f 756e   a wrapper aroun
+0004c6a0: 6420 3a6d 6574 683a 602e 6765 6e65 7261  d :meth:`.genera
+0004c6b0: 6c5f 7374 6174 6020 666f 7220 7468 6520  l_stat` for the 
+0004c6c0: 636f 6d6d 6f6e 2063 6173 6520 696e 0a20  common case in. 
+0004c6d0: 2020 2020 2020 2077 6869 6368 2074 6865         which the
+0004c6e0: 2077 6569 6768 7473 2061 7265 2061 6c6c   weights are all
+0004c6f0: 2065 6974 6865 7220 3120 6f72 2030 2c20   either 1 or 0, 
+0004c700: 692e 652e 2c20 6675 6e63 7469 6f6e 7320  i.e., functions 
+0004c710: 6f66 2074 6865 206a 6f69 6e74 0a20 2020  of the joint.   
+0004c720: 2020 2020 2061 6c6c 656c 6520 6672 6571       allele freq
+0004c730: 7565 6e63 7920 7370 6563 7472 756d 2e0a  uency spectrum..
+0004c740: 2020 2020 2020 2020 5365 6520 7468 6520          See the 
+0004c750: 3a72 6566 3a60 7374 6174 6973 7469 6373  :ref:`statistics
+0004c760: 2069 6e74 6572 6661 6365 203c 7365 635f   interface <sec_
+0004c770: 7374 6174 735f 696e 7465 7266 6163 653e  stats_interface>
+0004c780: 6020 7365 6374 696f 6e20 666f 7220 6465  ` section for de
+0004c790: 7461 696c 7320 6f6e 0a20 2020 2020 2020  tails on.       
+0004c7a0: 203a 7265 663a 6073 616d 706c 6520 7365   :ref:`sample se
+0004c7b0: 7473 203c 7365 635f 7374 6174 735f 7361  ts <sec_stats_sa
+0004c7c0: 6d70 6c65 5f73 6574 733e 602c 0a20 2020  mple_sets>`,.   
+0004c7d0: 2020 2020 203a 7265 663a 6077 696e 646f       :ref:`windo
+0004c7e0: 7773 203c 7365 635f 7374 6174 735f 7769  ws <sec_stats_wi
+0004c7f0: 6e64 6f77 733e 602c 0a20 2020 2020 2020  ndows>`,.       
+0004c800: 203a 7265 663a 606d 6f64 6520 3c73 6563   :ref:`mode <sec
+0004c810: 5f73 7461 7473 5f6d 6f64 653e 602c 0a20  _stats_mode>`,. 
+0004c820: 2020 2020 2020 203a 7265 663a 6073 7061         :ref:`spa
+0004c830: 6e20 6e6f 726d 616c 6973 6520 3c73 6563  n normalise <sec
+0004c840: 5f73 7461 7473 5f73 7061 6e5f 6e6f 726d  _stats_span_norm
+0004c850: 616c 6973 653e 602c 0a20 2020 2020 2020  alise>`,.       
+0004c860: 2061 6e64 203a 7265 663a 6072 6574 7572   and :ref:`retur
+0004c870: 6e20 7661 6c75 6520 3c73 6563 5f73 7461  n value <sec_sta
+0004c880: 7473 5f6f 7574 7075 745f 666f 726d 6174  ts_output_format
+0004c890: 3e60 2e0a 2020 2020 2020 2020 4966 2060  >`..        If `
+0004c8a0: 6073 616d 706c 655f 7365 7473 6060 2069  `sample_sets`` i
+0004c8b0: 7320 6120 6c69 7374 206f 6620 6060 6b60  s a list of ``k`
+0004c8c0: 6020 7365 7473 206f 6620 7361 6d70 6c65  ` sets of sample
+0004c8d0: 732c 2074 6865 6e0a 2020 2020 2020 2020  s, then.        
+0004c8e0: 6060 6660 6020 7368 6f75 6c64 2062 6520  ``f`` should be 
+0004c8f0: 6120 6675 6e63 7469 6f6e 2074 6861 7420  a function that 
+0004c900: 7461 6b65 7320 616e 2061 7267 756d 656e  takes an argumen
+0004c910: 7420 6f66 206c 656e 6774 6820 6060 6b60  t of length ``k`
+0004c920: 6020 616e 640a 2020 2020 2020 2020 7265  ` and.        re
+0004c930: 7475 726e 7320 6120 6f6e 652d 6469 6d65  turns a one-dime
+0004c940: 6e73 696f 6e61 6c20 6172 7261 792e 2054  nsional array. T
+0004c950: 6865 2060 606a 6060 2d74 6820 656c 656d  he ``j``-th elem
+0004c960: 656e 7420 6f66 2074 6865 2061 7267 756d  ent of the argum
+0004c970: 656e 740a 2020 2020 2020 2020 746f 2060  ent.        to `
+0004c980: 6066 6060 2077 696c 6c20 6265 2074 6865  `f`` will be the
+0004c990: 206e 756d 6265 7220 6f66 2073 616d 706c   number of sampl
+0004c9a0: 6573 2069 6e20 6060 7361 6d70 6c65 5f73  es in ``sample_s
+0004c9b0: 6574 735b 6a5d 6060 2074 6861 7420 6c69  ets[j]`` that li
+0004c9c0: 650a 2020 2020 2020 2020 6265 6c6f 7720  e.        below 
+0004c9d0: 7468 6520 6e6f 6465 2074 6861 7420 6060  the node that ``
+0004c9e0: 6660 6020 6973 2062 6569 6e67 2065 7661  f`` is being eva
+0004c9f0: 6c75 6174 6564 2066 6f72 2e20 5365 650a  luated for. See.
+0004ca00: 2020 2020 2020 2020 3a6d 6574 683a 602e          :meth:`.
+0004ca10: 6765 6e65 7261 6c5f 7374 6174 6020 2066  general_stat`  f
+0004ca20: 6f72 206d 6f72 6520 6465 7461 696c 732e  or more details.
+0004ca30: 0a0a 2020 2020 2020 2020 4865 7265 2069  ..        Here i
+0004ca40: 7320 6120 636f 6e74 7269 7665 6420 6578  s a contrived ex
+0004ca50: 616d 706c 653a 2073 7570 706f 7365 2074  ample: suppose t
+0004ca60: 6861 7420 6060 4160 6020 616e 6420 6060  hat ``A`` and ``
+0004ca70: 4260 6020 6172 6520 7477 6f20 7365 7473  B`` are two sets
+0004ca80: 0a20 2020 2020 2020 206f 6620 7361 6d70  .        of samp
+0004ca90: 6c65 7320 7769 7468 2060 606e 4160 6020  les with ``nA`` 
+0004caa0: 616e 6420 6060 6e42 6060 2065 6c65 6d65  and ``nB`` eleme
+0004cab0: 6e74 732c 2072 6573 7065 6374 6976 656c  nts, respectivel
+0004cac0: 792e 2050 6173 7369 6e67 2074 6865 7365  y. Passing these
+0004cad0: 0a20 2020 2020 2020 2061 7320 7361 6d70  .        as samp
+0004cae0: 6c65 2073 6574 7320 7769 6c6c 2067 6976  le sets will giv
+0004caf0: 6520 6060 6660 6020 616e 2061 7267 756d  e ``f`` an argum
+0004cb00: 656e 7420 6f66 206c 656e 6774 6820 7477  ent of length tw
+0004cb10: 6f2c 2067 6976 696e 6720 7468 6520 6e75  o, giving the nu
+0004cb20: 6d62 6572 0a20 2020 2020 2020 206f 6620  mber.        of 
+0004cb30: 7361 6d70 6c65 7320 696e 2060 6041 6060  samples in ``A``
+0004cb40: 2061 6e64 2060 6042 6060 2062 656c 6f77   and ``B`` below
+0004cb50: 2074 6865 206e 6f64 6520 696e 2071 7565   the node in que
+0004cb60: 7374 696f 6e2e 2053 6f2c 2069 6620 7765  stion. So, if we
+0004cb70: 2064 6566 696e 650a 0a0a 2020 2020 2020   define...      
+0004cb80: 2020 2e2e 2063 6f64 652d 626c 6f63 6b3a    .. code-block:
+0004cb90: 3a20 7079 7468 6f6e 0a0a 2020 2020 2020  : python..      
+0004cba0: 2020 2020 2020 6465 6620 6628 7829 3a0a        def f(x):.
+0004cbb0: 2020 2020 2020 2020 2020 2020 2020 2020                  
+0004cbc0: 7041 203d 2078 5b30 5d20 2f20 6e41 0a20  pA = x[0] / nA. 
+0004cbd0: 2020 2020 2020 2020 2020 2020 2020 2070                 p
+0004cbe0: 4220 3d20 785b 315d 202f 206e 420a 2020  B = x[1] / nB.  
+0004cbf0: 2020 2020 2020 2020 2020 2020 2020 7265                re
+0004cc00: 7475 726e 206e 702e 6172 7261 7928 5b70  turn np.array([p
+0004cc10: 4120 2a20 7042 5d29 0a0a 2020 2020 2020  A * pB])..      
+0004cc20: 2020 7468 656e 2069 6620 616c 6c20 7369    then if all si
+0004cc30: 7465 7320 6172 6520 6269 616c 6c65 6c69  tes are bialleli
+0004cc40: 632c 0a0a 2020 2020 2020 2020 2e2e 2063  c,..        .. c
+0004cc50: 6f64 652d 626c 6f63 6b3a 3a20 7079 7468  ode-block:: pyth
+0004cc60: 6f6e 0a0a 2020 2020 2020 2020 2020 2020  on..            
+0004cc70: 7473 2e73 616d 706c 655f 636f 756e 745f  ts.sample_count_
+0004cc80: 7374 6174 285b 412c 2042 5d2c 2066 2c20  stat([A, B], f, 
+0004cc90: 312c 2077 696e 646f 7773 3d22 7369 7465  1, windows="site
+0004cca0: 7322 2c20 706f 6c61 7269 7365 643d 4661  s", polarised=Fa
+0004ccb0: 6c73 652c 206d 6f64 653d 2273 6974 6522  lse, mode="site"
+0004ccc0: 290a 0a20 2020 2020 2020 2077 6f75 6c64  )..        would
+0004ccd0: 2063 6f6d 7075 7465 2c20 666f 7220 6561   compute, for ea
+0004cce0: 6368 2073 6974 652c 2074 6865 2070 726f  ch site, the pro
+0004ccf0: 6475 6374 206f 6620 7468 6520 6465 7269  duct of the deri
+0004cd00: 7665 6420 616c 6c65 6c65 0a20 2020 2020  ved allele.     
+0004cd10: 2020 2066 7265 7175 656e 6369 6573 2069     frequencies i
+0004cd20: 6e20 7468 6520 7477 6f20 7361 6d70 6c65  n the two sample
+0004cd30: 2073 6574 732c 2069 6e20 6120 286e 756d   sets, in a (num
+0004cd40: 2073 6974 6573 2c20 3129 2061 7272 6179   sites, 1) array
+0004cd50: 2e20 2049 660a 2020 2020 2020 2020 696e  .  If.        in
+0004cd60: 7374 6561 6420 6060 6660 6020 7265 7475  stead ``f`` retu
+0004cd70: 726e 7320 6060 6e70 2e61 7272 6179 285b  rns ``np.array([
+0004cd80: 7041 2c20 7042 2c20 7041 202a 2070 425d  pA, pB, pA * pB]
+0004cd90: 2960 602c 2074 6865 6e20 7468 650a 2020  )``, then the.  
+0004cda0: 2020 2020 2020 6f75 7470 7574 2077 6f75        output wou
+0004cdb0: 6c64 2062 6520 6120 286e 756d 2073 6974  ld be a (num sit
+0004cdc0: 6573 2c20 3329 2061 7272 6179 2c20 7769  es, 3) array, wi
+0004cdd0: 7468 2074 6865 2066 6972 7374 2074 776f  th the first two
+0004cde0: 2063 6f6c 756d 6e73 0a20 2020 2020 2020   columns.       
+0004cdf0: 2067 6976 696e 6720 7468 6520 616c 6c65   giving the alle
+0004ce00: 6c65 2066 7265 7175 656e 6369 6573 2069  le frequencies i
+0004ce10: 6e20 6060 4160 6020 616e 6420 6060 4260  n ``A`` and ``B`
+0004ce20: 602c 2072 6573 7065 6374 6976 656c 792e  `, respectively.
+0004ce30: 0a0a 2020 2020 2020 2020 2e2e 206e 6f74  ..        .. not
+0004ce40: 653a 3a0a 2020 2020 2020 2020 2020 2020  e::.            
+0004ce50: 5468 6520 7375 6d6d 6172 7920 6675 6e63  The summary func
+0004ce60: 7469 6f6e 2060 6066 6060 2073 686f 756c  tion ``f`` shoul
+0004ce70: 6420 7265 7475 726e 207a 6572 6f20 7768  d return zero wh
+0004ce80: 656e 2067 6976 656e 2062 6f74 6820 3020  en given both 0 
+0004ce90: 616e 640a 2020 2020 2020 2020 2020 2020  and.            
+0004cea0: 7468 6520 7361 6d70 6c65 2073 697a 6520  the sample size 
+0004ceb0: 2869 2e65 2e2c 2060 6066 2830 2920 3d20  (i.e., ``f(0) = 
+0004cec0: 3060 6020 616e 640a 2020 2020 2020 2020  0`` and.        
+0004ced0: 2020 2020 6060 6628 6e70 2e61 7272 6179      ``f(np.array
+0004cee0: 285b 6c65 6e28 7829 2066 6f72 2078 2069  ([len(x) for x i
+0004cef0: 6e20 7361 6d70 6c65 5f73 6574 735d 2929  n sample_sets]))
+0004cf00: 203d 2030 6060 292e 2020 5468 6973 2069   = 0``).  This i
+0004cf10: 730a 2020 2020 2020 2020 2020 2020 6e65  s.            ne
+0004cf20: 6365 7373 6172 7920 666f 7220 7468 6520  cessary for the 
+0004cf30: 7374 6174 6973 7469 6320 746f 2062 6520  statistic to be 
+0004cf40: 756e 6166 6665 6374 6564 2062 7920 7061  unaffected by pa
+0004cf50: 7274 7320 6f66 2074 6865 2074 7265 650a  rts of the tree.
+0004cf60: 2020 2020 2020 2020 2020 2020 7365 7175              sequ
+0004cf70: 656e 6365 2061 6e63 6573 7472 616c 2074  ence ancestral t
+0004cf80: 6f20 6e6f 6e65 206f 7220 616c 6c20 6f66  o none or all of
+0004cf90: 2074 6865 2073 616d 706c 6573 2c20 7265   the samples, re
+0004cfa0: 7370 6563 7469 7665 6c79 2e0a 0a20 2020  spectively...   
+0004cfb0: 2020 2020 203a 7061 7261 6d20 6c69 7374       :param list
+0004cfc0: 2073 616d 706c 655f 7365 7473 3a20 4120   sample_sets: A 
+0004cfd0: 6c69 7374 206f 6620 6c69 7374 7320 6f66  list of lists of
+0004cfe0: 204e 6f64 6520 4944 732c 2073 7065 6369   Node IDs, speci
+0004cff0: 6679 696e 6720 7468 650a 2020 2020 2020  fying the.      
+0004d000: 2020 2020 2020 6772 6f75 7073 206f 6620        groups of 
+0004d010: 6e6f 6465 7320 746f 2063 6f6d 7075 7465  nodes to compute
+0004d020: 2074 6865 2073 7461 7469 7374 6963 2077   the statistic w
+0004d030: 6974 682e 0a20 2020 2020 2020 203a 7061  ith..        :pa
+0004d040: 7261 6d20 663a 2041 2066 756e 6374 696f  ram f: A functio
+0004d050: 6e20 7468 6174 2074 616b 6573 2061 206f  n that takes a o
+0004d060: 6e65 2d64 696d 656e 7369 6f6e 616c 2061  ne-dimensional a
+0004d070: 7272 6179 206f 6620 6c65 6e67 7468 0a20  rray of length. 
+0004d080: 2020 2020 2020 2020 2020 2065 7175 616c             equal
+0004d090: 2074 6f20 7468 6520 6e75 6d62 6572 206f   to the number o
+0004d0a0: 6620 7361 6d70 6c65 2073 6574 7320 616e  f sample sets an
+0004d0b0: 6420 7265 7475 726e 7320 6120 6f6e 652d  d returns a one-
+0004d0c0: 6469 6d65 6e73 696f 6e61 6c20 6172 7261  dimensional arra
+0004d0d0: 792e 0a20 2020 2020 2020 203a 7061 7261  y..        :para
+0004d0e0: 6d20 696e 7420 6f75 7470 7574 5f64 696d  m int output_dim
+0004d0f0: 3a20 5468 6520 6c65 6e67 7468 206f 6620  : The length of 
+0004d100: 6060 6660 6027 7320 7265 7475 726e 2076  ``f``'s return v
+0004d110: 616c 7565 2e0a 2020 2020 2020 2020 3a70  alue..        :p
+0004d120: 6172 616d 206c 6973 7420 7769 6e64 6f77  aram list window
+0004d130: 733a 2041 6e20 696e 6372 6561 7369 6e67  s: An increasing
+0004d140: 206c 6973 7420 6f66 2062 7265 616b 706f   list of breakpo
+0004d150: 696e 7473 2062 6574 7765 656e 2074 6865  ints between the
+0004d160: 2077 696e 646f 7773 0a20 2020 2020 2020   windows.       
+0004d170: 2020 2020 2074 6f20 636f 6d70 7574 6520       to compute 
+0004d180: 7468 6520 7374 6174 6973 7469 6320 696e  the statistic in
+0004d190: 2e0a 2020 2020 2020 2020 3a70 6172 616d  ..        :param
+0004d1a0: 2062 6f6f 6c20 706f 6c61 7269 7365 643a   bool polarised:
+0004d1b0: 2057 6865 7468 6572 2074 6f20 6c65 6176   Whether to leav
+0004d1c0: 6520 7468 6520 616e 6365 7374 7261 6c20  e the ancestral 
+0004d1d0: 7374 6174 6520 6f75 7420 6f66 2063 6f6d  state out of com
+0004d1e0: 7075 7461 7469 6f6e 733a 0a20 2020 2020  putations:.     
+0004d1f0: 2020 2020 2020 2073 6565 203a 7265 663a         see :ref:
+0004d200: 6073 6563 5f73 7461 7473 6020 666f 7220  `sec_stats` for 
+0004d210: 6d6f 7265 2064 6574 6169 6c73 2e0a 2020  more details..  
+0004d220: 2020 2020 2020 3a70 6172 616d 2073 7472        :param str
+0004d230: 206d 6f64 653a 2041 2073 7472 696e 6720   mode: A string 
+0004d240: 6769 7669 6e67 2074 6865 2022 7479 7065  giving the "type
+0004d250: 2220 6f66 2074 6865 2073 7461 7469 7374  " of the statist
+0004d260: 6963 2074 6f20 6265 2063 6f6d 7075 7465  ic to be compute
+0004d270: 640a 2020 2020 2020 2020 2020 2020 2864  d.            (d
+0004d280: 6566 6175 6c74 7320 746f 2022 7369 7465  efaults to "site
+0004d290: 2229 2e0a 2020 2020 2020 2020 3a70 6172  ")..        :par
+0004d2a0: 616d 2062 6f6f 6c20 7370 616e 5f6e 6f72  am bool span_nor
+0004d2b0: 6d61 6c69 7365 3a20 5768 6574 6865 7220  malise: Whether 
+0004d2c0: 746f 2064 6976 6964 6520 7468 6520 7265  to divide the re
+0004d2d0: 7375 6c74 2062 7920 7468 6520 7370 616e  sult by the span
+0004d2e0: 206f 6620 7468 650a 2020 2020 2020 2020   of the.        
+0004d2f0: 2020 2020 7769 6e64 6f77 2028 6465 6661      window (defa
+0004d300: 756c 7473 2074 6f20 5472 7565 292e 0a20  ults to True).. 
+0004d310: 2020 2020 2020 203a 7061 7261 6d20 626f         :param bo
+0004d320: 6f6c 2073 7472 6963 743a 2057 6865 7468  ol strict: Wheth
+0004d330: 6572 2074 6f20 6368 6563 6b20 7468 6174  er to check that
+0004d340: 2066 2830 2920 616e 6420 6628 746f 7461   f(0) and f(tota
+0004d350: 6c20 7765 6967 6874 2920 6172 6520 7a65  l weight) are ze
+0004d360: 726f 2e0a 2020 2020 2020 2020 3a72 6574  ro..        :ret
+0004d370: 7572 6e3a 2041 206e 6461 7272 6179 2077  urn: A ndarray w
+0004d380: 6974 6820 7368 6170 6520 6571 7561 6c20  ith shape equal 
+0004d390: 746f 2028 6e75 6d20 7769 6e64 6f77 732c  to (num windows,
+0004d3a0: 206e 756d 2073 7461 7469 7374 6963 7329   num statistics)
+0004d3b0: 2e0a 2020 2020 2020 2020 2222 2220 2023  ..        """  #
+0004d3c0: 206e 6f71 613a 2042 3935 300a 2020 2020   noqa: B950.    
+0004d3d0: 2020 2020 2320 6865 6c70 6572 2066 756e      # helper fun
+0004d3e0: 6374 696f 6e20 666f 7220 636f 6d6d 6f6e  ction for common
+0004d3f0: 2063 6173 6520 7768 6572 6520 7765 6967   case where weig
+0004d400: 6874 7320 6172 6520 696e 6469 6361 746f  hts are indicato
+0004d410: 7273 206f 6620 7361 6d70 6c65 2073 6574  rs of sample set
+0004d420: 730a 2020 2020 2020 2020 666f 7220 5520  s.        for U 
+0004d430: 696e 2073 616d 706c 655f 7365 7473 3a0a  in sample_sets:.
+0004d440: 2020 2020 2020 2020 2020 2020 6966 206c              if l
+0004d450: 656e 2855 2920 213d 206c 656e 2873 6574  en(U) != len(set
+0004d460: 2855 2929 3a0a 2020 2020 2020 2020 2020  (U)):.          
+0004d470: 2020 2020 2020 7261 6973 6520 5661 6c75        raise Valu
+0004d480: 6545 7272 6f72 280a 2020 2020 2020 2020  eError(.        
+0004d490: 2020 2020 2020 2020 2020 2020 2245 6c65              "Ele
+0004d4a0: 6d65 6e74 7320 6f66 2073 616d 706c 655f  ments of sample_
+0004d4b0: 7365 7473 206d 7573 7420 6265 206c 6973  sets must be lis
+0004d4c0: 7473 2077 6974 686f 7574 2072 6570 6561  ts without repea
+0004d4d0: 7465 6420 656c 656d 656e 7473 2e22 0a20  ted elements.". 
+0004d4e0: 2020 2020 2020 2020 2020 2020 2020 2029                 )
+0004d4f0: 0a20 2020 2020 2020 2020 2020 2069 6620  .            if 
+0004d500: 6c65 6e28 5529 203d 3d20 303a 0a20 2020  len(U) == 0:.   
+0004d510: 2020 2020 2020 2020 2020 2020 2072 6169               rai
+0004d520: 7365 2056 616c 7565 4572 726f 7228 2245  se ValueError("E
+0004d530: 6c65 6d65 6e74 7320 6f66 2073 616d 706c  lements of sampl
+0004d540: 655f 7365 7473 2063 616e 6e6f 7420 6265  e_sets cannot be
+0004d550: 2065 6d70 7479 2e22 290a 2020 2020 2020   empty.").      
+0004d560: 2020 2020 2020 666f 7220 7520 696e 2055        for u in U
+0004d570: 3a0a 2020 2020 2020 2020 2020 2020 2020  :.              
+0004d580: 2020 6966 206e 6f74 2073 656c 662e 6e6f    if not self.no
+0004d590: 6465 2875 292e 6973 5f73 616d 706c 6528  de(u).is_sample(
+0004d5a0: 293a 0a20 2020 2020 2020 2020 2020 2020  ):.             
+0004d5b0: 2020 2020 2020 2072 6169 7365 2056 616c         raise Val
+0004d5c0: 7565 4572 726f 7228 224e 6f74 2061 6c6c  ueError("Not all
+0004d5d0: 2065 6c65 6d65 6e74 7320 6f66 2073 616d   elements of sam
+0004d5e0: 706c 655f 7365 7473 2061 7265 2073 616d  ple_sets are sam
+0004d5f0: 706c 6573 2e22 290a 0a20 2020 2020 2020  ples.")..       
+0004d600: 2057 203d 206e 702e 6172 7261 7928 5b5b   W = np.array([[
+0004d610: 666c 6f61 7428 7520 696e 2041 2920 666f  float(u in A) fo
+0004d620: 7220 4120 696e 2073 616d 706c 655f 7365  r A in sample_se
+0004d630: 7473 5d20 666f 7220 7520 696e 2073 656c  ts] for u in sel
+0004d640: 662e 7361 6d70 6c65 7328 295d 290a 2020  f.samples()]).  
+0004d650: 2020 2020 2020 7265 7475 726e 2073 656c        return sel
+0004d660: 662e 6765 6e65 7261 6c5f 7374 6174 280a  f.general_stat(.
+0004d670: 2020 2020 2020 2020 2020 2020 572c 0a20              W,. 
+0004d680: 2020 2020 2020 2020 2020 2066 2c0a 2020             f,.  
+0004d690: 2020 2020 2020 2020 2020 6f75 7470 7574            output
+0004d6a0: 5f64 696d 2c0a 2020 2020 2020 2020 2020  _dim,.          
+0004d6b0: 2020 7769 6e64 6f77 733d 7769 6e64 6f77    windows=window
+0004d6c0: 732c 0a20 2020 2020 2020 2020 2020 2070  s,.            p
+0004d6d0: 6f6c 6172 6973 6564 3d70 6f6c 6172 6973  olarised=polaris
+0004d6e0: 6564 2c0a 2020 2020 2020 2020 2020 2020  ed,.            
+0004d6f0: 6d6f 6465 3d6d 6f64 652c 0a20 2020 2020  mode=mode,.     
+0004d700: 2020 2020 2020 2073 7061 6e5f 6e6f 726d         span_norm
+0004d710: 616c 6973 653d 7370 616e 5f6e 6f72 6d61  alise=span_norma
+0004d720: 6c69 7365 2c0a 2020 2020 2020 2020 2020  lise,.          
+0004d730: 2020 7374 7269 6374 3d73 7472 6963 742c    strict=strict,
+0004d740: 0a20 2020 2020 2020 2029 0a0a 2020 2020  .        )..    
+0004d750: 6465 6620 7061 7273 655f 7769 6e64 6f77  def parse_window
+0004d760: 7328 7365 6c66 2c20 7769 6e64 6f77 7329  s(self, windows)
+0004d770: 3a0a 2020 2020 2020 2020 2320 4e6f 7465  :.        # Note
+0004d780: 3a20 6e65 6564 2074 6f20 6d61 6b65 2073  : need to make s
+0004d790: 7572 6520 7769 6e64 6f77 7320 6973 2061  ure windows is a
+0004d7a0: 2073 7472 696e 6720 6f72 2077 6520 7472   string or we tr
+0004d7b0: 7920 746f 2063 6f6d 7061 7265 2074 6865  y to compare the
+0004d7c0: 0a20 2020 2020 2020 2023 2074 6172 6765  .        # targe
+0004d7d0: 7420 7769 7468 2061 206e 756d 7079 2061  t with a numpy a
+0004d7e0: 7272 6179 2065 6c65 6d65 6e74 7769 7365  rray elementwise
+0004d7f0: 2e0a 2020 2020 2020 2020 6966 2077 696e  ..        if win
+0004d800: 646f 7773 2069 7320 4e6f 6e65 3a0a 2020  dows is None:.  
+0004d810: 2020 2020 2020 2020 2020 7769 6e64 6f77            window
+0004d820: 7320 3d20 5b30 2e30 2c20 7365 6c66 2e73  s = [0.0, self.s
+0004d830: 6571 7565 6e63 655f 6c65 6e67 7468 5d0a  equence_length].
+0004d840: 2020 2020 2020 2020 656c 6966 2069 7369          elif isi
+0004d850: 6e73 7461 6e63 6528 7769 6e64 6f77 732c  nstance(windows,
+0004d860: 2073 7472 293a 0a20 2020 2020 2020 2020   str):.         
+0004d870: 2020 2069 6620 7769 6e64 6f77 7320 3d3d     if windows ==
+0004d880: 2022 7472 6565 7322 3a0a 2020 2020 2020   "trees":.      
+0004d890: 2020 2020 2020 2020 2020 7769 6e64 6f77            window
+0004d8a0: 7320 3d20 7365 6c66 2e62 7265 616b 706f  s = self.breakpo
+0004d8b0: 696e 7473 2861 735f 6172 7261 793d 5472  ints(as_array=Tr
+0004d8c0: 7565 290a 2020 2020 2020 2020 2020 2020  ue).            
+0004d8d0: 656c 6966 2077 696e 646f 7773 203d 3d20  elif windows == 
+0004d8e0: 2273 6974 6573 223a 0a20 2020 2020 2020  "sites":.       
+0004d8f0: 2020 2020 2020 2020 2023 2062 7265 616b           # break
+0004d900: 706f 696e 7473 2061 7265 2061 7420 302e  points are at 0.
+0004d910: 3020 616e 6420 6174 2074 6865 2073 6974  0 and at the sit
+0004d920: 6573 2061 6e64 2061 7420 7468 6520 656e  es and at the en
+0004d930: 640a 2020 2020 2020 2020 2020 2020 2020  d.              
+0004d940: 2020 7769 6e64 6f77 7320 3d20 6e70 2e63    windows = np.c
+0004d950: 6f6e 6361 7465 6e61 7465 280a 2020 2020  oncatenate(.    
+0004d960: 2020 2020 2020 2020 2020 2020 2020 2020                  
+0004d970: 5b0a 2020 2020 2020 2020 2020 2020 2020  [.              
+0004d980: 2020 2020 2020 2020 2020 5b5d 2069 6620            [] if 
+0004d990: 7365 6c66 2e6e 756d 5f73 6974 6573 203e  self.num_sites >
+0004d9a0: 2030 2065 6c73 6520 5b30 2e30 5d2c 0a20   0 else [0.0],. 
+0004d9b0: 2020 2020 2020 2020 2020 2020 2020 2020                  
+0004d9c0: 2020 2020 2020 2073 656c 662e 7369 7465         self.site
+0004d9d0: 735f 706f 7369 7469 6f6e 2c0a 2020 2020  s_position,.    
+0004d9e0: 2020 2020 2020 2020 2020 2020 2020 2020                  
+0004d9f0: 2020 2020 5b73 656c 662e 7365 7175 656e      [self.sequen
+0004da00: 6365 5f6c 656e 6774 685d 2c0a 2020 2020  ce_length],.    
+0004da10: 2020 2020 2020 2020 2020 2020 2020 2020                  
+0004da20: 5d0a 2020 2020 2020 2020 2020 2020 2020  ].              
+0004da30: 2020 290a 2020 2020 2020 2020 2020 2020    ).            
+0004da40: 2020 2020 7769 6e64 6f77 735b 305d 203d      windows[0] =
+0004da50: 2030 2e30 0a20 2020 2020 2020 2020 2020   0.0.           
+0004da60: 2065 6c73 653a 0a20 2020 2020 2020 2020   else:.         
+0004da70: 2020 2020 2020 2072 6169 7365 2056 616c         raise Val
+0004da80: 7565 4572 726f 7228 0a20 2020 2020 2020  ueError(.       
+0004da90: 2020 2020 2020 2020 2020 2020 2066 2255               f"U
+0004daa0: 6e72 6563 6f67 6e69 7a65 6420 7769 6e64  nrecognized wind
+0004dab0: 6f77 2073 7065 6369 6669 6361 7469 6f6e  ow specification
+0004dac0: 207b 7769 6e64 6f77 737d 3a22 2c0a 2020   {windows}:",.  
+0004dad0: 2020 2020 2020 2020 2020 2020 2020 2020                  
+0004dae0: 2020 2274 6865 206f 6e6c 7920 616c 6c6f    "the only allo
+0004daf0: 7765 6420 7374 7269 6e67 7320 6172 6520  wed strings are 
+0004db00: 2773 6974 6573 2720 6f72 2027 7472 6565  'sites' or 'tree
+0004db10: 7327 222c 0a20 2020 2020 2020 2020 2020  s'",.           
+0004db20: 2020 2020 2029 0a20 2020 2020 2020 2072       ).        r
+0004db30: 6574 7572 6e20 6e70 2e61 7272 6179 2877  eturn np.array(w
+0004db40: 696e 646f 7773 290a 0a20 2020 2064 6566  indows)..    def
+0004db50: 205f 5f72 756e 5f77 696e 646f 7765 645f   __run_windowed_
+0004db60: 7374 6174 2873 656c 662c 2077 696e 646f  stat(self, windo
+0004db70: 7773 2c20 6d65 7468 6f64 2c20 2a61 7267  ws, method, *arg
+0004db80: 732c 202a 2a6b 7761 7267 7329 3a0a 2020  s, **kwargs):.  
+0004db90: 2020 2020 2020 7374 7269 705f 6469 6d20        strip_dim 
+0004dba0: 3d20 7769 6e64 6f77 7320 6973 204e 6f6e  = windows is Non
+0004dbb0: 650a 2020 2020 2020 2020 7769 6e64 6f77  e.        window
+0004dbc0: 7320 3d20 7365 6c66 2e70 6172 7365 5f77  s = self.parse_w
+0004dbd0: 696e 646f 7773 2877 696e 646f 7773 290a  indows(windows).
+0004dbe0: 2020 2020 2020 2020 7374 6174 203d 206d          stat = m
+0004dbf0: 6574 686f 6428 2a61 7267 732c 202a 2a6b  ethod(*args, **k
+0004dc00: 7761 7267 732c 2077 696e 646f 7773 3d77  wargs, windows=w
+0004dc10: 696e 646f 7773 290a 2020 2020 2020 2020  indows).        
+0004dc20: 6966 2073 7472 6970 5f64 696d 3a0a 2020  if strip_dim:.  
+0004dc30: 2020 2020 2020 2020 2020 7374 6174 203d            stat =
+0004dc40: 2073 7461 745b 305d 0a20 2020 2020 2020   stat[0].       
+0004dc50: 2072 6574 7572 6e20 7374 6174 0a0a 2020   return stat..  
+0004dc60: 2020 6465 6620 5f5f 6f6e 655f 7761 795f    def __one_way_
+0004dc70: 7361 6d70 6c65 5f73 6574 5f73 7461 7428  sample_set_stat(
+0004dc80: 0a20 2020 2020 2020 2073 656c 662c 0a20  .        self,. 
+0004dc90: 2020 2020 2020 206c 6c5f 6d65 7468 6f64         ll_method
+0004dca0: 2c0a 2020 2020 2020 2020 7361 6d70 6c65  ,.        sample
+0004dcb0: 5f73 6574 732c 0a20 2020 2020 2020 2077  _sets,.        w
+0004dcc0: 696e 646f 7773 3d4e 6f6e 652c 0a20 2020  indows=None,.   
+0004dcd0: 2020 2020 206d 6f64 653d 4e6f 6e65 2c0a       mode=None,.
+0004dce0: 2020 2020 2020 2020 7370 616e 5f6e 6f72          span_nor
+0004dcf0: 6d61 6c69 7365 3d54 7275 652c 0a20 2020  malise=True,.   
+0004dd00: 2020 2020 2070 6f6c 6172 6973 6564 3d46       polarised=F
+0004dd10: 616c 7365 2c0a 2020 2020 293a 0a20 2020  alse,.    ):.   
+0004dd20: 2020 2020 2069 6620 7361 6d70 6c65 5f73       if sample_s
+0004dd30: 6574 7320 6973 204e 6f6e 653a 0a20 2020  ets is None:.   
+0004dd40: 2020 2020 2020 2020 2073 616d 706c 655f           sample_
+0004dd50: 7365 7473 203d 2073 656c 662e 7361 6d70  sets = self.samp
+0004dd60: 6c65 7328 290a 0a20 2020 2020 2020 2023  les()..        #
+0004dd70: 2046 6972 7374 2074 7279 2074 6f20 636f   First try to co
+0004dd80: 6e76 6572 7420 746f 2061 2031 4420 6e75  nvert to a 1D nu
+0004dd90: 6d70 7920 6172 7261 792e 2049 6620 6974  mpy array. If it
+0004dda0: 2069 732c 2074 6865 6e20 7765 2073 7472   is, then we str
+0004ddb0: 6970 206f 6666 0a20 2020 2020 2020 2023  ip off.        #
+0004ddc0: 2074 6865 2063 6f72 7265 7370 6f6e 6469   the correspondi
+0004ddd0: 6e67 2064 696d 656e 7369 6f6e 2066 726f  ng dimension fro
+0004dde0: 6d20 7468 6520 6f75 7470 7574 2e0a 2020  m the output..  
+0004ddf0: 2020 2020 2020 6472 6f70 5f64 696d 656e        drop_dimen
+0004de00: 7369 6f6e 203d 2046 616c 7365 0a20 2020  sion = False.   
+0004de10: 2020 2020 2074 7279 3a0a 2020 2020 2020       try:.      
+0004de20: 2020 2020 2020 7361 6d70 6c65 5f73 6574        sample_set
+0004de30: 7320 3d20 6e70 2e61 7272 6179 2873 616d  s = np.array(sam
+0004de40: 706c 655f 7365 7473 2c20 6474 7970 653d  ple_sets, dtype=
+0004de50: 6e70 2e75 696e 7436 3429 0a20 2020 2020  np.uint64).     
+0004de60: 2020 2065 7863 6570 7420 5661 6c75 6545     except ValueE
+0004de70: 7272 6f72 3a0a 2020 2020 2020 2020 2020  rror:.          
+0004de80: 2020 7061 7373 0a20 2020 2020 2020 2065    pass.        e
+0004de90: 6c73 653a 0a20 2020 2020 2020 2020 2020  lse:.           
+0004dea0: 2023 2049 6620 7765 2776 6520 7375 6363   # If we've succ
+0004deb0: 6573 7366 756c 6c79 2063 6f6e 7665 7274  essfully convert
+0004dec0: 6564 2073 616d 706c 655f 7365 7473 2074  ed sample_sets t
+0004ded0: 6f20 6120 3144 206e 756d 7079 2061 7272  o a 1D numpy arr
+0004dee0: 6179 0a20 2020 2020 2020 2020 2020 2023  ay.            #
+0004def0: 206f 6620 696e 7465 6765 7273 2074 6865   of integers the
+0004df00: 6e20 6472 6f70 2074 6865 2064 696d 656e  n drop the dimen
+0004df10: 7369 6f6e 0a20 2020 2020 2020 2020 2020  sion.           
+0004df20: 2069 6620 6c65 6e28 7361 6d70 6c65 5f73   if len(sample_s
+0004df30: 6574 732e 7368 6170 6529 203d 3d20 313a  ets.shape) == 1:
+0004df40: 0a20 2020 2020 2020 2020 2020 2020 2020  .               
+0004df50: 2073 616d 706c 655f 7365 7473 203d 205b   sample_sets = [
+0004df60: 7361 6d70 6c65 5f73 6574 735d 0a20 2020  sample_sets].   
+0004df70: 2020 2020 2020 2020 2020 2020 2064 726f               dro
+0004df80: 705f 6469 6d65 6e73 696f 6e20 3d20 5472  p_dimension = Tr
+0004df90: 7565 0a0a 2020 2020 2020 2020 7361 6d70  ue..        samp
+0004dfa0: 6c65 5f73 6574 5f73 697a 6573 203d 206e  le_set_sizes = n
+0004dfb0: 702e 6172 7261 7928 0a20 2020 2020 2020  p.array(.       
+0004dfc0: 2020 2020 205b 6c65 6e28 7361 6d70 6c65       [len(sample
+0004dfd0: 5f73 6574 2920 666f 7220 7361 6d70 6c65  _set) for sample
+0004dfe0: 5f73 6574 2069 6e20 7361 6d70 6c65 5f73  _set in sample_s
+0004dff0: 6574 735d 2c20 6474 7970 653d 6e70 2e75  ets], dtype=np.u
+0004e000: 696e 7433 320a 2020 2020 2020 2020 290a  int32.        ).
+0004e010: 2020 2020 2020 2020 6966 206e 702e 616e          if np.an
+0004e020: 7928 7361 6d70 6c65 5f73 6574 5f73 697a  y(sample_set_siz
+0004e030: 6573 203d 3d20 3029 3a0a 2020 2020 2020  es == 0):.      
+0004e040: 2020 2020 2020 7261 6973 6520 5661 6c75        raise Valu
+0004e050: 6545 7272 6f72 2822 5361 6d70 6c65 2073  eError("Sample s
+0004e060: 6574 7320 6d75 7374 2063 6f6e 7461 696e  ets must contain
+0004e070: 2061 7420 6c65 6173 7420 6f6e 6520 656c   at least one el
+0004e080: 656d 656e 7422 290a 0a20 2020 2020 2020  ement")..       
+0004e090: 2066 6c61 7474 656e 6564 203d 2075 7469   flattened = uti
+0004e0a0: 6c2e 7361 6665 5f6e 705f 696e 745f 6361  l.safe_np_int_ca
+0004e0b0: 7374 286e 702e 6873 7461 636b 2873 616d  st(np.hstack(sam
+0004e0c0: 706c 655f 7365 7473 292c 206e 702e 696e  ple_sets), np.in
+0004e0d0: 7433 3229 0a20 2020 2020 2020 2073 7461  t32).        sta
+0004e0e0: 7420 3d20 7365 6c66 2e5f 5f72 756e 5f77  t = self.__run_w
+0004e0f0: 696e 646f 7765 645f 7374 6174 280a 2020  indowed_stat(.  
+0004e100: 2020 2020 2020 2020 2020 7769 6e64 6f77            window
+0004e110: 732c 0a20 2020 2020 2020 2020 2020 206c  s,.            l
+0004e120: 6c5f 6d65 7468 6f64 2c0a 2020 2020 2020  l_method,.      
+0004e130: 2020 2020 2020 7361 6d70 6c65 5f73 6574        sample_set
+0004e140: 5f73 697a 6573 2c0a 2020 2020 2020 2020  _sizes,.        
+0004e150: 2020 2020 666c 6174 7465 6e65 642c 0a20      flattened,. 
+0004e160: 2020 2020 2020 2020 2020 206d 6f64 653d             mode=
+0004e170: 6d6f 6465 2c0a 2020 2020 2020 2020 2020  mode,.          
+0004e180: 2020 7370 616e 5f6e 6f72 6d61 6c69 7365    span_normalise
+0004e190: 3d73 7061 6e5f 6e6f 726d 616c 6973 652c  =span_normalise,
+0004e1a0: 0a20 2020 2020 2020 2020 2020 2070 6f6c  .            pol
+0004e1b0: 6172 6973 6564 3d70 6f6c 6172 6973 6564  arised=polarised
+0004e1c0: 2c0a 2020 2020 2020 2020 290a 2020 2020  ,.        ).    
+0004e1d0: 2020 2020 6966 2064 726f 705f 6469 6d65      if drop_dime
+0004e1e0: 6e73 696f 6e3a 0a20 2020 2020 2020 2020  nsion:.         
+0004e1f0: 2020 2073 7461 7420 3d20 7374 6174 2e72     stat = stat.r
+0004e200: 6573 6861 7065 2873 7461 742e 7368 6170  eshape(stat.shap
+0004e210: 655b 3a2d 315d 290a 2020 2020 2020 2020  e[:-1]).        
+0004e220: 2020 2020 6966 2073 7461 742e 7368 6170      if stat.shap
+0004e230: 6520 3d3d 2028 2920 616e 6420 7769 6e64  e == () and wind
+0004e240: 6f77 7320 6973 204e 6f6e 653a 0a20 2020  ows is None:.   
+0004e250: 2020 2020 2020 2020 2020 2020 2073 7461               sta
+0004e260: 7420 3d20 7374 6174 5b28 295d 0a20 2020  t = stat[()].   
+0004e270: 2020 2020 2072 6574 7572 6e20 7374 6174       return stat
+0004e280: 0a0a 2020 2020 6465 6620 5f5f 6b5f 7761  ..    def __k_wa
+0004e290: 795f 7361 6d70 6c65 5f73 6574 5f73 7461  y_sample_set_sta
+0004e2a0: 7428 0a20 2020 2020 2020 2073 656c 662c  t(.        self,
+0004e2b0: 0a20 2020 2020 2020 206c 6c5f 6d65 7468  .        ll_meth
+0004e2c0: 6f64 2c0a 2020 2020 2020 2020 6b2c 0a20  od,.        k,. 
+0004e2d0: 2020 2020 2020 2073 616d 706c 655f 7365         sample_se
+0004e2e0: 7473 2c0a 2020 2020 2020 2020 696e 6465  ts,.        inde
+0004e2f0: 7865 733d 4e6f 6e65 2c0a 2020 2020 2020  xes=None,.      
+0004e300: 2020 7769 6e64 6f77 733d 4e6f 6e65 2c0a    windows=None,.
+0004e310: 2020 2020 2020 2020 6d6f 6465 3d4e 6f6e          mode=Non
+0004e320: 652c 0a20 2020 2020 2020 2073 7061 6e5f  e,.        span_
+0004e330: 6e6f 726d 616c 6973 653d 5472 7565 2c0a  normalise=True,.
+0004e340: 2020 2020 2020 2020 706f 6c61 7269 7365          polarise
+0004e350: 643d 4661 6c73 652c 0a20 2020 2029 3a0a  d=False,.    ):.
+0004e360: 2020 2020 2020 2020 7361 6d70 6c65 5f73          sample_s
+0004e370: 6574 5f73 697a 6573 203d 206e 702e 6172  et_sizes = np.ar
+0004e380: 7261 7928 0a20 2020 2020 2020 2020 2020  ray(.           
+0004e390: 205b 6c65 6e28 7361 6d70 6c65 5f73 6574   [len(sample_set
+0004e3a0: 2920 666f 7220 7361 6d70 6c65 5f73 6574  ) for sample_set
+0004e3b0: 2069 6e20 7361 6d70 6c65 5f73 6574 735d   in sample_sets]
+0004e3c0: 2c20 6474 7970 653d 6e70 2e75 696e 7433  , dtype=np.uint3
+0004e3d0: 320a 2020 2020 2020 2020 290a 2020 2020  2.        ).    
+0004e3e0: 2020 2020 6966 206e 702e 616e 7928 7361      if np.any(sa
+0004e3f0: 6d70 6c65 5f73 6574 5f73 697a 6573 203d  mple_set_sizes =
+0004e400: 3d20 3029 3a0a 2020 2020 2020 2020 2020  = 0):.          
+0004e410: 2020 7261 6973 6520 5661 6c75 6545 7272    raise ValueErr
+0004e420: 6f72 2822 5361 6d70 6c65 2073 6574 7320  or("Sample sets 
+0004e430: 6d75 7374 2063 6f6e 7461 696e 2061 7420  must contain at 
+0004e440: 6c65 6173 7420 6f6e 6520 656c 656d 656e  least one elemen
+0004e450: 7422 290a 2020 2020 2020 2020 666c 6174  t").        flat
+0004e460: 7465 6e65 6420 3d20 7574 696c 2e73 6166  tened = util.saf
+0004e470: 655f 6e70 5f69 6e74 5f63 6173 7428 6e70  e_np_int_cast(np
+0004e480: 2e68 7374 6163 6b28 7361 6d70 6c65 5f73  .hstack(sample_s
+0004e490: 6574 7329 2c20 6e70 2e69 6e74 3332 290a  ets), np.int32).
+0004e4a0: 2020 2020 2020 2020 6472 6f70 5f62 6173          drop_bas
+0004e4b0: 6564 5f6f 6e5f 696e 6465 7820 3d20 4661  ed_on_index = Fa
+0004e4c0: 6c73 650a 2020 2020 2020 2020 6966 2069  lse.        if i
+0004e4d0: 6e64 6578 6573 2069 7320 4e6f 6e65 3a0a  ndexes is None:.
+0004e4e0: 2020 2020 2020 2020 2020 2020 6472 6f70              drop
+0004e4f0: 5f62 6173 6564 5f6f 6e5f 696e 6465 7820  _based_on_index 
+0004e500: 3d20 5472 7565 0a20 2020 2020 2020 2020  = True.         
+0004e510: 2020 2069 6620 6c65 6e28 7361 6d70 6c65     if len(sample
+0004e520: 5f73 6574 7329 2021 3d20 6b3a 0a20 2020  _sets) != k:.   
+0004e530: 2020 2020 2020 2020 2020 2020 2072 6169               rai
+0004e540: 7365 2056 616c 7565 4572 726f 7228 0a20  se ValueError(. 
+0004e550: 2020 2020 2020 2020 2020 2020 2020 2020                  
+0004e560: 2020 2022 4d75 7374 2073 7065 6369 6679     "Must specify
+0004e570: 2069 6e64 6578 6573 2069 6620 7468 6572   indexes if ther
+0004e580: 6520 6172 6520 6e6f 7420 6578 6163 746c  e are not exactl
+0004e590: 7920 7b7d 2073 616d 706c 6520 220a 2020  y {} sample ".  
+0004e5a0: 2020 2020 2020 2020 2020 2020 2020 2020                  
+0004e5b0: 2020 2273 6574 732e 222e 666f 726d 6174    "sets.".format
+0004e5c0: 286b 290a 2020 2020 2020 2020 2020 2020  (k).            
+0004e5d0: 2020 2020 290a 2020 2020 2020 2020 2020      ).          
+0004e5e0: 2020 696e 6465 7865 7320 3d20 6e70 2e61    indexes = np.a
+0004e5f0: 7261 6e67 6528 6b2c 2064 7479 7065 3d6e  range(k, dtype=n
+0004e600: 702e 696e 7433 3229 0a20 2020 2020 2020  p.int32).       
+0004e610: 2064 726f 705f 6469 6d65 6e73 696f 6e20   drop_dimension 
+0004e620: 3d20 4661 6c73 650a 2020 2020 2020 2020  = False.        
+0004e630: 696e 6465 7865 7320 3d20 7574 696c 2e73  indexes = util.s
+0004e640: 6166 655f 6e70 5f69 6e74 5f63 6173 7428  afe_np_int_cast(
+0004e650: 696e 6465 7865 732c 206e 702e 696e 7433  indexes, np.int3
+0004e660: 3229 0a20 2020 2020 2020 2069 6620 6c65  2).        if le
+0004e670: 6e28 696e 6465 7865 732e 7368 6170 6529  n(indexes.shape)
+0004e680: 203d 3d20 313a 0a20 2020 2020 2020 2020   == 1:.         
+0004e690: 2020 2069 6e64 6578 6573 203d 2069 6e64     indexes = ind
+0004e6a0: 6578 6573 2e72 6573 6861 7065 2828 312c  exes.reshape((1,
+0004e6b0: 2069 6e64 6578 6573 2e73 6861 7065 5b30   indexes.shape[0
+0004e6c0: 5d29 290a 2020 2020 2020 2020 2020 2020  ])).            
+0004e6d0: 6472 6f70 5f64 696d 656e 7369 6f6e 203d  drop_dimension =
+0004e6e0: 2054 7275 650a 2020 2020 2020 2020 6966   True.        if
+0004e6f0: 206c 656e 2869 6e64 6578 6573 2e73 6861   len(indexes.sha
+0004e700: 7065 2920 213d 2032 206f 7220 696e 6465  pe) != 2 or inde
+0004e710: 7865 732e 7368 6170 655b 315d 2021 3d20  xes.shape[1] != 
+0004e720: 6b3a 0a20 2020 2020 2020 2020 2020 2072  k:.            r
+0004e730: 6169 7365 2056 616c 7565 4572 726f 7228  aise ValueError(
+0004e740: 0a20 2020 2020 2020 2020 2020 2020 2020  .               
+0004e750: 2022 496e 6465 7865 7320 6d75 7374 2062   "Indexes must b
+0004e760: 6520 636f 6e76 6572 7461 626c 6520 746f  e convertable to
+0004e770: 2061 2032 4420 6e75 6d70 7920 6172 7261   a 2D numpy arra
+0004e780: 7920 7769 7468 207b 7d20 220a 2020 2020  y with {} ".    
+0004e790: 2020 2020 2020 2020 2020 2020 2263 6f6c              "col
+0004e7a0: 756d 6e73 222e 666f 726d 6174 286b 290a  umns".format(k).
+0004e7b0: 2020 2020 2020 2020 2020 2020 290a 2020              ).  
+0004e7c0: 2020 2020 2020 7374 6174 203d 2073 656c        stat = sel
+0004e7d0: 662e 5f5f 7275 6e5f 7769 6e64 6f77 6564  f.__run_windowed
+0004e7e0: 5f73 7461 7428 0a20 2020 2020 2020 2020  _stat(.         
+0004e7f0: 2020 2077 696e 646f 7773 2c0a 2020 2020     windows,.    
+0004e800: 2020 2020 2020 2020 6c6c 5f6d 6574 686f          ll_metho
+0004e810: 642c 0a20 2020 2020 2020 2020 2020 2073  d,.            s
+0004e820: 616d 706c 655f 7365 745f 7369 7a65 732c  ample_set_sizes,
+0004e830: 0a20 2020 2020 2020 2020 2020 2066 6c61  .            fla
+0004e840: 7474 656e 6564 2c0a 2020 2020 2020 2020  ttened,.        
+0004e850: 2020 2020 696e 6465 7865 732c 0a20 2020      indexes,.   
+0004e860: 2020 2020 2020 2020 206d 6f64 653d 6d6f           mode=mo
+0004e870: 6465 2c0a 2020 2020 2020 2020 2020 2020  de,.            
+0004e880: 7370 616e 5f6e 6f72 6d61 6c69 7365 3d73  span_normalise=s
+0004e890: 7061 6e5f 6e6f 726d 616c 6973 652c 0a20  pan_normalise,. 
+0004e8a0: 2020 2020 2020 2020 2020 2070 6f6c 6172             polar
+0004e8b0: 6973 6564 3d70 6f6c 6172 6973 6564 2c0a  ised=polarised,.
+0004e8c0: 2020 2020 2020 2020 290a 2020 2020 2020          ).      
+0004e8d0: 2020 6966 2064 726f 705f 6469 6d65 6e73    if drop_dimens
+0004e8e0: 696f 6e3a 0a20 2020 2020 2020 2020 2020  ion:.           
+0004e8f0: 2073 7461 7420 3d20 7374 6174 2e72 6573   stat = stat.res
+0004e900: 6861 7065 2873 7461 742e 7368 6170 655b  hape(stat.shape[
+0004e910: 3a2d 315d 290a 2020 2020 2020 2020 2020  :-1]).          
+0004e920: 2020 6966 2073 7461 742e 7368 6170 6520    if stat.shape 
+0004e930: 3d3d 2028 2920 616e 6420 7769 6e64 6f77  == () and window
+0004e940: 7320 6973 204e 6f6e 6520 616e 6420 6472  s is None and dr
+0004e950: 6f70 5f62 6173 6564 5f6f 6e5f 696e 6465  op_based_on_inde
+0004e960: 783a 0a20 2020 2020 2020 2020 2020 2020  x:.             
+0004e970: 2020 2073 7461 7420 3d20 7374 6174 5b28     stat = stat[(
+0004e980: 295d 0a20 2020 2020 2020 2072 6574 7572  )].        retur
+0004e990: 6e20 7374 6174 0a0a 2020 2020 2323 2323  n stat..    ####
+0004e9a0: 2323 2323 2323 2323 2323 2323 2323 2323  ################
 0004e9b0: 2323 2323 2323 2323 2323 2323 2323 2323  ################
-0004e9c0: 2323 2323 2323 2323 2323 2323 2323 2323  ################
-0004e9d0: 2323 2323 2323 2323 2323 230a 0a20 2020  ###########..   
-0004e9e0: 2064 6566 2064 6976 6572 7369 7479 280a   def diversity(.
-0004e9f0: 2020 2020 2020 2020 7365 6c66 2c20 7361          self, sa
-0004ea00: 6d70 6c65 5f73 6574 733d 4e6f 6e65 2c20  mple_sets=None, 
-0004ea10: 7769 6e64 6f77 733d 4e6f 6e65 2c20 6d6f  windows=None, mo
-0004ea20: 6465 3d22 7369 7465 222c 2073 7061 6e5f  de="site", span_
-0004ea30: 6e6f 726d 616c 6973 653d 5472 7565 0a20  normalise=True. 
-0004ea40: 2020 2029 3a0a 2020 2020 2020 2020 2222     ):.        ""
-0004ea50: 220a 2020 2020 2020 2020 436f 6d70 7574  ".        Comput
-0004ea60: 6573 206d 6561 6e20 6765 6e65 7469 6320  es mean genetic 
-0004ea70: 6469 7665 7273 6974 7920 2861 6c73 6f20  diversity (also 
-0004ea80: 6b6e 6f77 6e20 6173 2022 7069 2229 2069  known as "pi") i
-0004ea90: 6e20 6561 6368 206f 6620 7468 650a 2020  n each of the.  
-0004eaa0: 2020 2020 2020 7365 7473 206f 6620 6e6f        sets of no
-0004eab0: 6465 7320 6672 6f6d 2060 6073 616d 706c  des from ``sampl
-0004eac0: 655f 7365 7473 6060 2e20 2054 6865 2073  e_sets``.  The s
-0004ead0: 7461 7469 7374 6963 2069 7320 616c 736f  tatistic is also
-0004eae0: 206b 6e6f 776e 2061 730a 2020 2020 2020   known as.      
-0004eaf0: 2020 2273 616d 706c 6520 6865 7465 726f    "sample hetero
-0004eb00: 7a79 676f 7369 7479 223b 2061 2063 6f6d  zygosity"; a com
-0004eb10: 6d6f 6e20 6369 7461 7469 6f6e 2066 6f72  mon citation for
-0004eb20: 2074 6865 2064 6566 696e 6974 696f 6e20   the definition 
-0004eb30: 6973 0a20 2020 2020 2020 2060 4e65 6920  is.        `Nei 
-0004eb40: 616e 6420 4c69 2028 3139 3739 2920 3c68  and Li (1979) <h
-0004eb50: 7474 7073 3a2f 2f64 6f69 2e6f 7267 2f31  ttps://doi.org/1
-0004eb60: 302e 3130 3733 2f70 6e61 732e 3736 2e31  0.1073/pnas.76.1
-0004eb70: 302e 3532 3639 3e60 5f0a 2020 2020 2020  0.5269>`_.      
-0004eb80: 2020 2865 7175 6174 696f 6e20 3232 292c    (equation 22),
-0004eb90: 2073 6f20 6974 2069 7320 736f 6d65 7469   so it is someti
-0004eba0: 6d65 7320 6361 6c6c 6564 2063 616c 6c65  mes called calle
-0004ebb0: 6420 224e 6569 2773 2070 6922 0a20 2020  d "Nei's pi".   
-0004ebc0: 2020 2020 2028 6275 7420 616c 736f 2073       (but also s
-0004ebd0: 6f6d 6574 696d 6573 2022 5461 6a69 6d61  ometimes "Tajima
-0004ebe0: 2773 2070 6922 292e 0a0a 2020 2020 2020  's pi")...      
-0004ebf0: 2020 506c 6561 7365 2073 6565 2074 6865    Please see the
-0004ec00: 203a 7265 663a 606f 6e65 2d77 6179 2073   :ref:`one-way s
-0004ec10: 7461 7469 7374 6963 7320 3c73 6563 5f73  tatistics <sec_s
-0004ec20: 7461 7473 5f73 616d 706c 655f 7365 7473  tats_sample_sets
-0004ec30: 5f6f 6e65 5f77 6179 3e60 0a20 2020 2020  _one_way>`.     
-0004ec40: 2020 2073 6563 7469 6f6e 2066 6f72 2064     section for d
-0004ec50: 6574 6169 6c73 206f 6e20 686f 7720 7468  etails on how th
-0004ec60: 6520 6060 7361 6d70 6c65 5f73 6574 7360  e ``sample_sets`
-0004ec70: 6020 6172 6775 6d65 6e74 2069 7320 696e  ` argument is in
-0004ec80: 7465 7270 7265 7465 640a 2020 2020 2020  terpreted.      
-0004ec90: 2020 616e 6420 686f 7720 6974 2069 6e74    and how it int
-0004eca0: 6572 6163 7473 2077 6974 6820 7468 6520  eracts with the 
-0004ecb0: 6469 6d65 6e73 696f 6e73 206f 6620 7468  dimensions of th
-0004ecc0: 6520 6f75 7470 7574 2061 7272 6179 2e0a  e output array..
-0004ecd0: 2020 2020 2020 2020 5365 6520 7468 6520          See the 
-0004ece0: 3a72 6566 3a60 7374 6174 6973 7469 6373  :ref:`statistics
-0004ecf0: 2069 6e74 6572 6661 6365 203c 7365 635f   interface <sec_
-0004ed00: 7374 6174 735f 696e 7465 7266 6163 653e  stats_interface>
-0004ed10: 6020 7365 6374 696f 6e20 666f 7220 6465  ` section for de
-0004ed20: 7461 696c 7320 6f6e 0a20 2020 2020 2020  tails on.       
-0004ed30: 203a 7265 663a 6077 696e 646f 7773 203c   :ref:`windows <
-0004ed40: 7365 635f 7374 6174 735f 7769 6e64 6f77  sec_stats_window
-0004ed50: 733e 602c 0a20 2020 2020 2020 203a 7265  s>`,.        :re
-0004ed60: 663a 606d 6f64 6520 3c73 6563 5f73 7461  f:`mode <sec_sta
-0004ed70: 7473 5f6d 6f64 653e 602c 0a20 2020 2020  ts_mode>`,.     
-0004ed80: 2020 203a 7265 663a 6073 7061 6e20 6e6f     :ref:`span no
-0004ed90: 726d 616c 6973 6520 3c73 6563 5f73 7461  rmalise <sec_sta
-0004eda0: 7473 5f73 7061 6e5f 6e6f 726d 616c 6973  ts_span_normalis
-0004edb0: 653e 602c 0a20 2020 2020 2020 2061 6e64  e>`,.        and
-0004edc0: 203a 7265 663a 6072 6574 7572 6e20 7661   :ref:`return va
-0004edd0: 6c75 6520 3c73 6563 5f73 7461 7473 5f6f  lue <sec_stats_o
-0004ede0: 7574 7075 745f 666f 726d 6174 3e60 2e0a  utput_format>`..
-0004edf0: 0a20 2020 2020 2020 204e 6f74 6520 7468  .        Note th
-0004ee00: 6174 2074 6869 7320 7175 616e 7469 7479  at this quantity
-0004ee10: 2063 616e 2061 6c73 6f20 6265 2063 6f6d   can also be com
-0004ee20: 7075 7465 6420 6279 2074 6865 0a20 2020  puted by the.   
-0004ee30: 2020 2020 203a 6d65 7468 3a60 6469 7665       :meth:`dive
-0004ee40: 7267 656e 6365 203c 2e54 7265 6553 6571  rgence <.TreeSeq
-0004ee50: 7565 6e63 652e 6469 7665 7267 656e 6365  uence.divergence
-0004ee60: 3e60 206d 6574 686f 642e 0a0a 2020 2020  >` method...    
-0004ee70: 2020 2020 5768 6174 2069 7320 636f 6d70      What is comp
-0004ee80: 7574 6564 2064 6570 656e 6473 206f 6e20  uted depends on 
-0004ee90: 6060 6d6f 6465 6060 3a0a 0a20 2020 2020  ``mode``:..     
-0004eea0: 2020 2022 7369 7465 220a 2020 2020 2020     "site".      
-0004eeb0: 2020 2020 2020 4d65 616e 2070 6169 7277        Mean pairw
-0004eec0: 6973 6520 6765 6e65 7469 6320 6469 7665  ise genetic dive
-0004eed0: 7273 6974 793a 2074 6865 2061 7665 7261  rsity: the avera
-0004eee0: 6765 206f 7665 7220 616c 6c20 6e20 6368  ge over all n ch
-0004eef0: 6f6f 7365 2032 2070 6169 7273 206f 660a  oose 2 pairs of.
-0004ef00: 2020 2020 2020 2020 2020 2020 7361 6d70              samp
-0004ef10: 6c65 206e 6f64 6573 2c20 6f66 2074 6865  le nodes, of the
-0004ef20: 2064 656e 7369 7479 206f 6620 7369 7465   density of site
-0004ef30: 7320 6174 0a20 2020 2020 2020 2020 2020  s at.           
-0004ef40: 2077 6869 6368 2074 6865 2074 776f 2063   which the two c
-0004ef50: 6172 7279 2064 6966 6665 7265 6e74 2061  arry different a
-0004ef60: 6c6c 656c 6573 2c20 7065 7220 756e 6974  lleles, per unit
-0004ef70: 206f 6620 6368 726f 6d6f 736f 6d65 206c   of chromosome l
-0004ef80: 656e 6774 682e 0a0a 2020 2020 2020 2020  ength...        
-0004ef90: 2262 7261 6e63 6822 0a20 2020 2020 2020  "branch".       
-0004efa0: 2020 2020 204d 6561 6e20 6469 7374 616e       Mean distan
-0004efb0: 6365 2069 6e20 7468 6520 7472 6565 3a20  ce in the tree: 
-0004efc0: 7468 6520 6176 6572 6167 6520 6163 726f  the average acro
-0004efd0: 7373 206f 7665 7220 616c 6c20 6e20 6368  ss over all n ch
-0004efe0: 6f6f 7365 2032 2070 6169 7273 206f 660a  oose 2 pairs of.
-0004eff0: 2020 2020 2020 2020 2020 2020 7361 6d70              samp
-0004f000: 6c65 206e 6f64 6573 2061 6e64 206c 6f63  le nodes and loc
-0004f010: 6174 696f 6e73 2069 6e20 7468 6520 7769  ations in the wi
-0004f020: 6e64 6f77 2c20 6f66 2074 6865 206d 6561  ndow, of the mea
-0004f030: 6e20 6469 7374 616e 6365 2069 6e0a 2020  n distance in.  
-0004f040: 2020 2020 2020 2020 2020 7468 6520 7472            the tr
-0004f050: 6565 2062 6574 7765 656e 2074 6865 2074  ee between the t
-0004f060: 776f 2073 616d 706c 6573 2028 696e 2075  wo samples (in u
-0004f070: 6e69 7473 206f 6620 7469 6d65 292e 0a0a  nits of time)...
-0004f080: 2020 2020 2020 2020 226e 6f64 6522 0a20          "node". 
-0004f090: 2020 2020 2020 2020 2020 2046 6f72 2065             For e
-0004f0a0: 6163 6820 6e6f 6465 2c20 7468 6520 7072  ach node, the pr
-0004f0b0: 6f70 6f72 7469 6f6e 206f 6620 6765 6e6f  oportion of geno
-0004f0c0: 6d65 206f 6e20 7768 6963 6820 7468 6520  me on which the 
-0004f0d0: 6e6f 6465 2069 7320 616e 2061 6e63 6573  node is an ances
-0004f0e0: 746f 7220 746f 0a20 2020 2020 2020 2020  tor to.         
-0004f0f0: 2020 206f 6e6c 7920 6f6e 6520 6f66 2061     only one of a
-0004f100: 2070 6169 7220 6f66 2073 616d 706c 6520   pair of sample 
-0004f110: 6e6f 6465 7320 6672 6f6d 2074 6865 2073  nodes from the s
-0004f120: 616d 706c 6520 7365 742c 2061 7665 7261  ample set, avera
-0004f130: 6765 640a 2020 2020 2020 2020 2020 2020  ged.            
-0004f140: 6f76 6572 206f 7665 7220 616c 6c20 6e20  over over all n 
-0004f150: 6368 6f6f 7365 2032 2070 6169 7273 206f  choose 2 pairs o
-0004f160: 6620 7361 6d70 6c65 206e 6f64 6573 2e0a  f sample nodes..
-0004f170: 0a20 2020 2020 2020 203a 7061 7261 6d20  .        :param 
-0004f180: 6c69 7374 2073 616d 706c 655f 7365 7473  list sample_sets
-0004f190: 3a20 4120 6c69 7374 206f 6620 6c69 7374  : A list of list
-0004f1a0: 7320 6f66 204e 6f64 6520 4944 732c 2073  s of Node IDs, s
-0004f1b0: 7065 6369 6679 696e 6720 7468 650a 2020  pecifying the.  
-0004f1c0: 2020 2020 2020 2020 2020 6772 6f75 7073            groups
-0004f1d0: 206f 6620 6e6f 6465 7320 666f 7220 7768   of nodes for wh
-0004f1e0: 6963 6820 7468 6520 7374 6174 6973 7469  ich the statisti
-0004f1f0: 6320 6973 2063 6f6d 7075 7465 642e 2049  c is computed. I
-0004f200: 6620 616e 7920 6f66 2074 6865 0a20 2020  f any of the.   
-0004f210: 2020 2020 2020 2020 2073 616d 706c 6520           sample 
-0004f220: 7365 7473 2063 6f6e 7461 696e 206f 6e6c  sets contain onl
-0004f230: 7920 6120 7369 6e67 6c65 206e 6f64 652c  y a single node,
-0004f240: 2074 6865 2072 6574 7572 6e65 6420 6469   the returned di
-0004f250: 7665 7273 6974 7920 7769 6c6c 2062 650a  versity will be.
-0004f260: 2020 2020 2020 2020 2020 2020 4e61 4e2e              NaN.
-0004f270: 2049 6620 6060 4e6f 6e65 6060 2028 6465   If ``None`` (de
-0004f280: 6661 756c 7429 2c20 6176 6572 6167 6520  fault), average 
-0004f290: 6f76 6572 2061 6c6c 206e 2063 686f 6f73  over all n choos
-0004f2a0: 6520 3220 7061 6972 7320 6f66 2064 6973  e 2 pairs of dis
-0004f2b0: 7469 6e63 740a 2020 2020 2020 2020 2020  tinct.          
-0004f2c0: 2020 7361 6d70 6c65 206e 6f64 6573 2069    sample nodes i
-0004f2d0: 6e20 7468 6520 7472 6565 2073 6571 7565  n the tree seque
-0004f2e0: 6e63 652e 0a20 2020 2020 2020 203a 7061  nce..        :pa
-0004f2f0: 7261 6d20 6c69 7374 2077 696e 646f 7773  ram list windows
-0004f300: 3a20 416e 2069 6e63 7265 6173 696e 6720  : An increasing 
-0004f310: 6c69 7374 206f 6620 6272 6561 6b70 6f69  list of breakpoi
-0004f320: 6e74 7320 6265 7477 6565 6e20 7468 6520  nts between the 
-0004f330: 7769 6e64 6f77 730a 2020 2020 2020 2020  windows.        
-0004f340: 2020 2020 746f 2063 6f6d 7075 7465 2074      to compute t
-0004f350: 6865 2073 7461 7469 7374 6963 2069 6e2e  he statistic in.
-0004f360: 0a20 2020 2020 2020 203a 7061 7261 6d20  .        :param 
-0004f370: 7374 7220 6d6f 6465 3a20 4120 7374 7269  str mode: A stri
-0004f380: 6e67 2067 6976 696e 6720 7468 6520 2274  ng giving the "t
-0004f390: 7970 6522 206f 6620 7468 6520 7374 6174  ype" of the stat
-0004f3a0: 6973 7469 6320 746f 2062 6520 636f 6d70  istic to be comp
-0004f3b0: 7574 6564 0a20 2020 2020 2020 2020 2020  uted.           
-0004f3c0: 2028 6465 6661 756c 7473 2074 6f20 2273   (defaults to "s
-0004f3d0: 6974 6522 292e 0a20 2020 2020 2020 203a  ite")..        :
-0004f3e0: 7061 7261 6d20 626f 6f6c 2073 7061 6e5f  param bool span_
-0004f3f0: 6e6f 726d 616c 6973 653a 2057 6865 7468  normalise: Wheth
-0004f400: 6572 2074 6f20 6469 7669 6465 2074 6865  er to divide the
-0004f410: 2072 6573 756c 7420 6279 2074 6865 2073   result by the s
-0004f420: 7061 6e20 6f66 2074 6865 0a20 2020 2020  pan of the.     
-0004f430: 2020 2020 2020 2077 696e 646f 7720 2864         window (d
-0004f440: 6566 6175 6c74 7320 746f 2054 7275 6529  efaults to True)
-0004f450: 2e0a 2020 2020 2020 2020 3a72 6574 7572  ..        :retur
-0004f460: 6e3a 2041 206e 756d 7079 2061 7272 6179  n: A numpy array
-0004f470: 2077 686f 7365 206c 656e 6774 6820 6973   whose length is
-0004f480: 2065 7175 616c 2074 6f20 7468 6520 6e75   equal to the nu
-0004f490: 6d62 6572 206f 6620 7361 6d70 6c65 2073  mber of sample s
-0004f4a0: 6574 732e 0a20 2020 2020 2020 2020 2020  ets..           
-0004f4b0: 2049 6620 7468 6572 6520 6973 206f 6e65   If there is one
-0004f4c0: 2073 616d 706c 6520 7365 7420 616e 6420   sample set and 
-0004f4d0: 7769 6e64 6f77 733d 4e6f 6e65 2c20 6120  windows=None, a 
-0004f4e0: 6e75 6d70 7920 7363 616c 6172 2069 7320  numpy scalar is 
-0004f4f0: 7265 7475 726e 6564 2e0a 2020 2020 2020  returned..      
-0004f500: 2020 2222 220a 2020 2020 2020 2020 7265    """.        re
-0004f510: 7475 726e 2073 656c 662e 5f5f 6f6e 655f  turn self.__one_
-0004f520: 7761 795f 7361 6d70 6c65 5f73 6574 5f73  way_sample_set_s
-0004f530: 7461 7428 0a20 2020 2020 2020 2020 2020  tat(.           
-0004f540: 2073 656c 662e 5f6c 6c5f 7472 6565 5f73   self._ll_tree_s
-0004f550: 6571 7565 6e63 652e 6469 7665 7273 6974  equence.diversit
-0004f560: 792c 0a20 2020 2020 2020 2020 2020 2073  y,.            s
-0004f570: 616d 706c 655f 7365 7473 2c0a 2020 2020  ample_sets,.    
-0004f580: 2020 2020 2020 2020 7769 6e64 6f77 733d          windows=
-0004f590: 7769 6e64 6f77 732c 0a20 2020 2020 2020  windows,.       
-0004f5a0: 2020 2020 206d 6f64 653d 6d6f 6465 2c0a       mode=mode,.
-0004f5b0: 2020 2020 2020 2020 2020 2020 7370 616e              span
-0004f5c0: 5f6e 6f72 6d61 6c69 7365 3d73 7061 6e5f  _normalise=span_
-0004f5d0: 6e6f 726d 616c 6973 652c 0a20 2020 2020  normalise,.     
-0004f5e0: 2020 2029 0a0a 2020 2020 6465 6620 6469     )..    def di
-0004f5f0: 7665 7267 656e 6365 280a 2020 2020 2020  vergence(.      
-0004f600: 2020 7365 6c66 2c20 7361 6d70 6c65 5f73    self, sample_s
-0004f610: 6574 732c 2069 6e64 6578 6573 3d4e 6f6e  ets, indexes=Non
-0004f620: 652c 2077 696e 646f 7773 3d4e 6f6e 652c  e, windows=None,
-0004f630: 206d 6f64 653d 2273 6974 6522 2c20 7370   mode="site", sp
-0004f640: 616e 5f6e 6f72 6d61 6c69 7365 3d54 7275  an_normalise=Tru
-0004f650: 650a 2020 2020 293a 0a20 2020 2020 2020  e.    ):.       
-0004f660: 2072 2222 220a 2020 2020 2020 2020 436f   r""".        Co
-0004f670: 6d70 7574 6573 206d 6561 6e20 6765 6e65  mputes mean gene
-0004f680: 7469 6320 6469 7665 7267 656e 6365 2062  tic divergence b
-0004f690: 6574 7765 656e 2028 616e 6420 7769 7468  etween (and with
-0004f6a0: 696e 2920 7061 6972 7320 6f66 0a20 2020  in) pairs of.   
-0004f6b0: 2020 2020 2073 6574 7320 6f66 206e 6f64       sets of nod
-0004f6c0: 6573 2066 726f 6d20 6060 7361 6d70 6c65  es from ``sample
-0004f6d0: 5f73 6574 7360 602e 0a20 2020 2020 2020  _sets``..       
-0004f6e0: 2054 6869 7320 6973 2074 6865 2022 6176   This is the "av
-0004f6f0: 6572 6167 6520 6e75 6d62 6572 206f 6620  erage number of 
-0004f700: 6469 6666 6572 656e 6365 7322 2c20 7573  differences", us
-0004f710: 7561 6c6c 7920 7265 6665 7272 6564 2074  ually referred t
-0004f720: 6f20 6173 2022 6478 7922 3b0a 2020 2020  o as "dxy";.    
-0004f730: 2020 2020 6120 636f 6d6d 6f6e 2063 6974      a common cit
-0004f740: 6174 696f 6e20 666f 7220 7468 6973 2064  ation for this d
-0004f750: 6566 696e 6974 696f 6e20 6973 204e 6569  efinition is Nei
-0004f760: 2061 6e64 204c 6920 2831 3937 3929 2c20   and Li (1979), 
-0004f770: 7768 6f20 6361 6c6c 6564 2069 740a 2020  who called it.  
-0004f780: 2020 2020 2020 3a6d 6174 683a 605c 7069        :math:`\pi
-0004f790: 5f7b 5859 7d60 2e20 4e6f 7465 2074 6861  _{XY}`. Note tha
-0004f7a0: 7420 7468 6520 6d65 616e 2070 6169 7277  t the mean pairw
-0004f7b0: 6973 6520 6e75 636c 656f 7469 6465 2064  ise nucleotide d
-0004f7c0: 6976 6572 7369 7479 206f 6620 610a 2020  iversity of a.  
-0004f7d0: 2020 2020 2020 7361 6d70 6c65 2073 6574        sample set
-0004f7e0: 2074 6f20 6974 7365 6c66 2028 636f 6d70   to itself (comp
-0004f7f0: 7574 6564 2062 7920 7061 7373 696e 6720  uted by passing 
-0004f800: 616e 2069 6e64 6578 206f 6620 7468 6520  an index of the 
-0004f810: 666f 726d 2028 6a2c 6a29 290a 2020 2020  form (j,j)).    
-0004f820: 2020 2020 6973 2069 7473 203a 6d65 7468      is its :meth
-0004f830: 3a60 6469 7665 7273 6974 7920 3c2e 5472  :`diversity <.Tr
-0004f840: 6565 5365 7175 656e 6365 2e64 6976 6572  eeSequence.diver
-0004f850: 7369 7479 3e60 2028 7365 6520 7468 6520  sity>` (see the 
-0004f860: 6e6f 7465 2062 656c 6f77 292e 0a0a 2020  note below)...  
-0004f870: 2020 2020 2020 4f70 6572 6174 6573 206f        Operates o
-0004f880: 6e20 6060 6b20 3d20 3260 6020 7361 6d70  n ``k = 2`` samp
-0004f890: 6c65 2073 6574 7320 6174 2061 2074 696d  le sets at a tim
-0004f8a0: 653b 2070 6c65 6173 6520 7365 6520 7468  e; please see th
-0004f8b0: 650a 2020 2020 2020 2020 3a72 6566 3a60  e.        :ref:`
-0004f8c0: 6d75 6c74 692d 7761 7920 7374 6174 6973  multi-way statis
-0004f8d0: 7469 6373 203c 7365 635f 7374 6174 735f  tics <sec_stats_
-0004f8e0: 7361 6d70 6c65 5f73 6574 735f 6d75 6c74  sample_sets_mult
-0004f8f0: 695f 7761 793e 600a 2020 2020 2020 2020  i_way>`.        
-0004f900: 7365 6374 696f 6e20 666f 7220 6465 7461  section for deta
-0004f910: 696c 7320 6f6e 2068 6f77 2074 6865 2060  ils on how the `
-0004f920: 6073 616d 706c 655f 7365 7473 6060 2061  `sample_sets`` a
-0004f930: 6e64 2060 6069 6e64 6578 6573 6060 2061  nd ``indexes`` a
-0004f940: 7267 756d 656e 7473 2061 7265 0a20 2020  rguments are.   
-0004f950: 2020 2020 2069 6e74 6572 7072 6574 6564       interpreted
-0004f960: 2061 6e64 2068 6f77 2074 6865 7920 696e   and how they in
-0004f970: 7465 7261 6374 2077 6974 6820 7468 6520  teract with the 
-0004f980: 6469 6d65 6e73 696f 6e73 206f 6620 7468  dimensions of th
-0004f990: 6520 6f75 7470 7574 2061 7272 6179 2e0a  e output array..
-0004f9a0: 2020 2020 2020 2020 5365 6520 7468 6520          See the 
-0004f9b0: 3a72 6566 3a60 7374 6174 6973 7469 6373  :ref:`statistics
-0004f9c0: 2069 6e74 6572 6661 6365 203c 7365 635f   interface <sec_
-0004f9d0: 7374 6174 735f 696e 7465 7266 6163 653e  stats_interface>
-0004f9e0: 6020 7365 6374 696f 6e20 666f 7220 6465  ` section for de
-0004f9f0: 7461 696c 7320 6f6e 0a20 2020 2020 2020  tails on.       
-0004fa00: 203a 7265 663a 6077 696e 646f 7773 203c   :ref:`windows <
-0004fa10: 7365 635f 7374 6174 735f 7769 6e64 6f77  sec_stats_window
-0004fa20: 733e 602c 0a20 2020 2020 2020 203a 7265  s>`,.        :re
-0004fa30: 663a 606d 6f64 6520 3c73 6563 5f73 7461  f:`mode <sec_sta
-0004fa40: 7473 5f6d 6f64 653e 602c 0a20 2020 2020  ts_mode>`,.     
-0004fa50: 2020 203a 7265 663a 6073 7061 6e20 6e6f     :ref:`span no
-0004fa60: 726d 616c 6973 6520 3c73 6563 5f73 7461  rmalise <sec_sta
-0004fa70: 7473 5f73 7061 6e5f 6e6f 726d 616c 6973  ts_span_normalis
-0004fa80: 653e 602c 0a20 2020 2020 2020 2061 6e64  e>`,.        and
-0004fa90: 203a 7265 663a 6072 6574 7572 6e20 7661   :ref:`return va
-0004faa0: 6c75 6520 3c73 6563 5f73 7461 7473 5f6f  lue <sec_stats_o
-0004fab0: 7574 7075 745f 666f 726d 6174 3e60 2e0a  utput_format>`..
-0004fac0: 0a20 2020 2020 2020 202e 2e20 6e6f 7465  .        .. note
-0004fad0: 3a3a 0a20 2020 2020 2020 2020 2020 2054  ::.            T
-0004fae0: 6f20 6176 6f69 6420 756e 6578 7065 6374  o avoid unexpect
-0004faf0: 6564 2072 6573 756c 7473 2c20 7361 6d70  ed results, samp
-0004fb00: 6c65 2073 6574 7320 7368 6f75 6c64 2062  le sets should b
-0004fb10: 6520 6e6f 6e6f 7665 726c 6170 7069 6e67  e nonoverlapping
-0004fb20: 2c0a 2020 2020 2020 2020 2020 2020 7369  ,.            si
-0004fb30: 6e63 6520 636f 6d70 6172 6973 6f6e 7320  nce comparisons 
-0004fb40: 6f66 2069 6e64 6976 6964 7561 6c73 2074  of individuals t
-0004fb50: 6f20 7468 656d 7365 6c76 6573 2061 7265  o themselves are
-0004fb60: 206e 6f74 2072 656d 6f76 6564 2077 6865   not removed whe
-0004fb70: 6e20 636f 6d70 7574 696e 670a 2020 2020  n computing.    
-0004fb80: 2020 2020 2020 2020 6469 7665 7267 656e          divergen
-0004fb90: 6365 2062 6574 7765 656e 2064 6973 7469  ce between disti
-0004fba0: 6e63 7420 7361 6d70 6c65 2073 6574 732e  nct sample sets.
-0004fbb0: 2028 486f 7765 7665 722c 2073 7065 6369   (However, speci
-0004fbc0: 6679 696e 6720 616e 2069 6e64 6578 0a20  fying an index. 
-0004fbd0: 2020 2020 2020 2020 2020 2060 6028 6a2c             ``(j,
-0004fbe0: 206a 2960 6020 636f 6d70 7574 6573 2074   j)`` computes t
-0004fbf0: 6865 203a 6d65 7468 3a60 6469 7665 7273  he :meth:`divers
-0004fc00: 6974 7920 3c2e 5472 6565 5365 7175 656e  ity <.TreeSequen
-0004fc10: 6365 2e64 6976 6572 7369 7479 3e60 0a20  ce.diversity>`. 
-0004fc20: 2020 2020 2020 2020 2020 206f 6620 6060             of ``
-0004fc30: 7361 6d70 6c65 5f73 6574 5b6a 5d60 602c  sample_set[j]``,
-0004fc40: 2077 6869 6368 2072 656d 6f76 6573 2073   which removes s
-0004fc50: 656c 6620 636f 6d70 6172 6973 6f6e 7320  elf comparisons 
-0004fc60: 746f 2070 726f 7669 6465 0a20 2020 2020  to provide.     
-0004fc70: 2020 2020 2020 2061 6e20 756e 6269 6173         an unbias
-0004fc80: 6564 2065 7374 696d 6174 652e 290a 0a20  ed estimate.).. 
-0004fc90: 2020 2020 2020 2057 6861 7420 6973 2063         What is c
-0004fca0: 6f6d 7075 7465 6420 6465 7065 6e64 7320  omputed depends 
-0004fcb0: 6f6e 2060 606d 6f64 6560 603a 0a0a 2020  on ``mode``:..  
-0004fcc0: 2020 2020 2020 2273 6974 6522 0a20 2020        "site".   
-0004fcd0: 2020 2020 2020 2020 204d 6561 6e20 7061           Mean pa
-0004fce0: 6972 7769 7365 2067 656e 6574 6963 2064  irwise genetic d
-0004fcf0: 6976 6572 6765 6e63 653a 2074 6865 2061  ivergence: the a
-0004fd00: 7665 7261 6765 2061 6372 6f73 7320 6576  verage across ev
-0004fd10: 6572 7920 706f 7373 6962 6c65 2070 6169  ery possible pai
-0004fd20: 7220 6f66 0a20 2020 2020 2020 2020 2020  r of.           
-0004fd30: 2063 6872 6f6d 6f73 6f6d 6573 2028 6f6e   chromosomes (on
-0004fd40: 6520 6672 6f6d 2065 6163 6820 7361 6d70  e from each samp
-0004fd50: 6c65 2073 6574 292c 206f 6620 7468 6520  le set), of the 
-0004fd60: 6465 6e73 6974 7920 6f66 2073 6974 6573  density of sites
-0004fd70: 2061 7420 7768 6963 680a 2020 2020 2020   at which.      
-0004fd80: 2020 2020 2020 7468 6520 7477 6f20 6361        the two ca
-0004fd90: 7272 7920 6469 6666 6572 656e 7420 616c  rry different al
-0004fda0: 6c65 6c65 732c 2070 6572 2075 6e69 7420  leles, per unit 
-0004fdb0: 6f66 2063 6872 6f6d 6f73 6f6d 6520 6c65  of chromosome le
-0004fdc0: 6e67 7468 2e0a 0a20 2020 2020 2020 2022  ngth...        "
-0004fdd0: 6272 616e 6368 220a 2020 2020 2020 2020  branch".        
-0004fde0: 2020 2020 4d65 616e 2064 6973 7461 6e63      Mean distanc
-0004fdf0: 6520 696e 2074 6865 2074 7265 653a 2074  e in the tree: t
-0004fe00: 6865 2061 7665 7261 6765 2061 6372 6f73  he average acros
-0004fe10: 7320 6576 6572 7920 706f 7373 6962 6c65  s every possible
-0004fe20: 2070 6169 7220 6f66 0a20 2020 2020 2020   pair of.       
-0004fe30: 2020 2020 2063 6872 6f6d 6f73 6f6d 6573       chromosomes
-0004fe40: 2028 6f6e 6520 6672 6f6d 2065 6163 6820   (one from each 
-0004fe50: 7361 6d70 6c65 2073 6574 2920 616e 6420  sample set) and 
-0004fe60: 6c6f 6361 7469 6f6e 7320 696e 2074 6865  locations in the
-0004fe70: 2077 696e 646f 772c 206f 660a 2020 2020   window, of.    
-0004fe80: 2020 2020 2020 2020 7468 6520 6d65 616e          the mean
-0004fe90: 2064 6973 7461 6e63 6520 696e 2074 6865   distance in the
-0004fea0: 2074 7265 6520 6265 7477 6565 6e20 7468   tree between th
-0004feb0: 6520 7477 6f20 7361 6d70 6c65 7320 2869  e two samples (i
-0004fec0: 6e20 756e 6974 7320 6f66 2074 696d 6529  n units of time)
-0004fed0: 2e0a 0a20 2020 2020 2020 2022 6e6f 6465  ...        "node
-0004fee0: 220a 2020 2020 2020 2020 2020 2020 466f  ".            Fo
-0004fef0: 7220 6561 6368 206e 6f64 652c 2074 6865  r each node, the
-0004ff00: 2070 726f 706f 7274 696f 6e20 6f66 2067   proportion of g
-0004ff10: 656e 6f6d 6520 6f6e 2077 6869 6368 2074  enome on which t
-0004ff20: 6865 206e 6f64 6520 6973 2061 6e20 616e  he node is an an
-0004ff30: 6365 7374 6f72 2074 6f0a 2020 2020 2020  cestor to.      
-0004ff40: 2020 2020 2020 6f6e 6c79 206f 6e65 206f        only one o
-0004ff50: 6620 6120 7061 6972 206f 6620 6368 726f  f a pair of chro
-0004ff60: 6d6f 736f 6d65 7320 6672 6f6d 2074 6865  mosomes from the
-0004ff70: 2073 616d 706c 6520 7365 742c 2061 7665   sample set, ave
-0004ff80: 7261 6765 640a 2020 2020 2020 2020 2020  raged.          
-0004ff90: 2020 6f76 6572 2061 6c6c 2070 6f73 7369    over all possi
-0004ffa0: 626c 6520 7061 6972 732e 0a0a 2020 2020  ble pairs...    
-0004ffb0: 2020 2020 3a70 6172 616d 206c 6973 7420      :param list 
-0004ffc0: 7361 6d70 6c65 5f73 6574 733a 2041 206c  sample_sets: A l
-0004ffd0: 6973 7420 6f66 206c 6973 7473 206f 6620  ist of lists of 
-0004ffe0: 4e6f 6465 2049 4473 2c20 7370 6563 6966  Node IDs, specif
-0004fff0: 7969 6e67 2074 6865 0a20 2020 2020 2020  ying the.       
-00050000: 2020 2020 2067 726f 7570 7320 6f66 206e       groups of n
-00050010: 6f64 6573 2074 6f20 636f 6d70 7574 6520  odes to compute 
-00050020: 7468 6520 7374 6174 6973 7469 6320 7769  the statistic wi
-00050030: 7468 2e0a 2020 2020 2020 2020 3a70 6172  th..        :par
-00050040: 616d 206c 6973 7420 696e 6465 7865 733a  am list indexes:
-00050050: 2041 206c 6973 7420 6f66 2032 2d74 7570   A list of 2-tup
-00050060: 6c65 732c 206f 7220 4e6f 6e65 2e0a 2020  les, or None..  
-00050070: 2020 2020 2020 3a70 6172 616d 206c 6973        :param lis
-00050080: 7420 7769 6e64 6f77 733a 2041 6e20 696e  t windows: An in
-00050090: 6372 6561 7369 6e67 206c 6973 7420 6f66  creasing list of
-000500a0: 2062 7265 616b 706f 696e 7473 2062 6574   breakpoints bet
-000500b0: 7765 656e 2074 6865 2077 696e 646f 7773  ween the windows
-000500c0: 0a20 2020 2020 2020 2020 2020 2074 6f20  .            to 
-000500d0: 636f 6d70 7574 6520 7468 6520 7374 6174  compute the stat
-000500e0: 6973 7469 6320 696e 2e0a 2020 2020 2020  istic in..      
-000500f0: 2020 3a70 6172 616d 2073 7472 206d 6f64    :param str mod
-00050100: 653a 2041 2073 7472 696e 6720 6769 7669  e: A string givi
-00050110: 6e67 2074 6865 2022 7479 7065 2220 6f66  ng the "type" of
-00050120: 2074 6865 2073 7461 7469 7374 6963 2074   the statistic t
-00050130: 6f20 6265 2063 6f6d 7075 7465 640a 2020  o be computed.  
-00050140: 2020 2020 2020 2020 2020 2864 6566 6175            (defau
-00050150: 6c74 7320 746f 2022 7369 7465 2229 2e0a  lts to "site")..
-00050160: 2020 2020 2020 2020 3a70 6172 616d 2062          :param b
-00050170: 6f6f 6c20 7370 616e 5f6e 6f72 6d61 6c69  ool span_normali
-00050180: 7365 3a20 5768 6574 6865 7220 746f 2064  se: Whether to d
-00050190: 6976 6964 6520 7468 6520 7265 7375 6c74  ivide the result
-000501a0: 2062 7920 7468 6520 7370 616e 206f 6620   by the span of 
-000501b0: 7468 650a 2020 2020 2020 2020 2020 2020  the.            
-000501c0: 7769 6e64 6f77 2028 6465 6661 756c 7473  window (defaults
-000501d0: 2074 6f20 5472 7565 292e 0a20 2020 2020   to True)..     
-000501e0: 2020 203a 7265 7475 726e 3a20 4120 6e64     :return: A nd
-000501f0: 6172 7261 7920 7769 7468 2073 6861 7065  array with shape
-00050200: 2065 7175 616c 2074 6f20 286e 756d 2077   equal to (num w
-00050210: 696e 646f 7773 2c20 6e75 6d20 7374 6174  indows, num stat
-00050220: 6973 7469 6373 292e 0a20 2020 2020 2020  istics)..       
-00050230: 2020 2020 2049 6620 7468 6572 6520 6973       If there is
-00050240: 206f 6e65 2070 6169 7220 6f66 2073 616d   one pair of sam
-00050250: 706c 6520 7365 7473 2061 6e64 2077 696e  ple sets and win
-00050260: 646f 7773 3d4e 6f6e 652c 2061 206e 756d  dows=None, a num
-00050270: 7079 2073 6361 6c61 7220 6973 0a20 2020  py scalar is.   
-00050280: 2020 2020 2020 2020 2072 6574 7572 6e65           returne
-00050290: 642e 0a0a 2020 2020 2020 2020 2222 220a  d...        """.
-000502a0: 2020 2020 2020 2020 7265 7475 726e 2073          return s
-000502b0: 656c 662e 5f5f 6b5f 7761 795f 7361 6d70  elf.__k_way_samp
-000502c0: 6c65 5f73 6574 5f73 7461 7428 0a20 2020  le_set_stat(.   
-000502d0: 2020 2020 2020 2020 2073 656c 662e 5f6c           self._l
-000502e0: 6c5f 7472 6565 5f73 6571 7565 6e63 652e  l_tree_sequence.
-000502f0: 6469 7665 7267 656e 6365 2c0a 2020 2020  divergence,.    
-00050300: 2020 2020 2020 2020 322c 0a20 2020 2020          2,.     
-00050310: 2020 2020 2020 2073 616d 706c 655f 7365         sample_se
-00050320: 7473 2c0a 2020 2020 2020 2020 2020 2020  ts,.            
-00050330: 696e 6465 7865 733d 696e 6465 7865 732c  indexes=indexes,
-00050340: 0a20 2020 2020 2020 2020 2020 2077 696e  .            win
-00050350: 646f 7773 3d77 696e 646f 7773 2c0a 2020  dows=windows,.  
-00050360: 2020 2020 2020 2020 2020 6d6f 6465 3d6d            mode=m
-00050370: 6f64 652c 0a20 2020 2020 2020 2020 2020  ode,.           
-00050380: 2073 7061 6e5f 6e6f 726d 616c 6973 653d   span_normalise=
-00050390: 7370 616e 5f6e 6f72 6d61 6c69 7365 2c0a  span_normalise,.
-000503a0: 2020 2020 2020 2020 290a 0a20 2020 2023          )..    #
-000503b0: 204a 4b3a 2063 6f6d 6d65 6e74 696e 6720   JK: commenting 
-000503c0: 7468 6973 206f 7574 2066 6f72 206e 6f77  this out for now
-000503d0: 2074 6f20 6765 7420 7468 6520 6f74 6865   to get the othe
-000503e0: 7220 6d65 7468 6f64 7320 7765 6c6c 2074  r methods well t
-000503f0: 6573 7465 642e 0a20 2020 2023 2049 7373  ested..    # Iss
-00050400: 7565 3a20 6874 7470 733a 2f2f 6769 7468  ue: https://gith
-00050410: 7562 2e63 6f6d 2f74 736b 6974 2d64 6576  ub.com/tskit-dev
-00050420: 2f74 736b 6974 2f69 7373 7565 732f 3230  /tskit/issues/20
-00050430: 310a 2020 2020 2320 6465 6620 6469 7665  1.    # def dive
-00050440: 7267 656e 6365 5f6d 6174 7269 7828 7365  rgence_matrix(se
-00050450: 6c66 2c20 7361 6d70 6c65 5f73 6574 732c  lf, sample_sets,
-00050460: 2077 696e 646f 7773 3d4e 6f6e 652c 206d   windows=None, m
-00050470: 6f64 653d 2273 6974 6522 293a 0a20 2020  ode="site"):.   
-00050480: 2023 2020 2020 2022 2222 0a20 2020 2023   #     """.    #
-00050490: 2020 2020 2046 696e 6473 2074 6865 206d       Finds the m
-000504a0: 6561 6e20 6469 7665 7267 656e 6365 2020  ean divergence  
-000504b0: 6265 7477 6565 6e20 7061 6972 7320 6f66  between pairs of
-000504c0: 2073 616d 706c 6573 2066 726f 6d20 6561   samples from ea
-000504d0: 6368 2073 6574 206f 660a 2020 2020 2320  ch set of.    # 
-000504e0: 2020 2020 7361 6d70 6c65 7320 616e 6420      samples and 
-000504f0: 696e 2065 6163 6820 7769 6e64 6f77 2e20  in each window. 
-00050500: 5265 7475 726e 7320 6120 6e75 6d70 7920  Returns a numpy 
-00050510: 6172 7261 7920 696e 6465 7865 6420 6279  array indexed by
-00050520: 2028 7769 6e64 6f77 2c0a 2020 2020 2320   (window,.    # 
-00050530: 2020 2020 7361 6d70 6c65 5f73 6574 2c20      sample_set, 
-00050540: 7361 6d70 6c65 5f73 6574 292e 2020 4469  sample_set).  Di
-00050550: 6167 6f6e 616c 2065 6e74 7269 6573 2061  agonal entries a
-00050560: 7265 2063 6f72 7265 6374 6564 2073 6f20  re corrected so 
-00050570: 7468 6174 2074 6865 0a20 2020 2023 2020  that the.    #  
-00050580: 2020 2076 616c 7565 2067 6976 6573 2074     value gives t
-00050590: 6865 206d 6561 6e20 6469 7665 7267 656e  he mean divergen
-000505a0: 6365 2066 6f72 202a 6469 7374 696e 6374  ce for *distinct
-000505b0: 2a20 7361 6d70 6c65 732c 2062 7574 2069  * samples, but i
-000505c0: 7420 6973 206e 6f74 0a20 2020 2023 2020  t is not.    #  
-000505d0: 2020 2063 6865 636b 6564 2077 6865 7468     checked wheth
-000505e0: 6572 2074 6865 2073 616d 706c 655f 7365  er the sample_se
-000505f0: 7473 2061 7265 2064 6973 6a6f 696e 7420  ts are disjoint 
-00050600: 2873 6f20 6f66 6664 6961 676f 6e61 6c73  (so offdiagonals
-00050610: 2061 7265 206e 6f74 0a20 2020 2023 2020   are not.    #  
-00050620: 2020 2063 6f72 7265 6374 6564 292e 2020     corrected).  
-00050630: 466f 7220 7468 6973 2072 6561 736f 6e2c  For this reason,
-00050640: 2069 6620 616e 2065 6c65 6d65 6e74 206f   if an element o
-00050650: 6620 6073 616d 706c 655f 7365 7473 6020  f `sample_sets` 
-00050660: 6861 7320 6f6e 6c79 0a20 2020 2023 2020  has only.    #  
-00050670: 2020 206f 6e65 2065 6c65 6d65 6e74 2c20     one element, 
-00050680: 7468 6520 636f 7272 6573 706f 6e64 696e  the correspondin
-00050690: 6720 6469 6167 6f6e 616c 2077 696c 6c20  g diagonal will 
-000506a0: 6265 204e 614e 2e0a 0a20 2020 2023 2020  be NaN...    #  
-000506b0: 2020 2054 6865 206d 6561 6e20 6469 7665     The mean dive
-000506c0: 7267 656e 6365 2062 6574 7765 656e 2074  rgence between t
-000506d0: 776f 2073 616d 706c 6573 2069 7320 6465  wo samples is de
-000506e0: 6669 6e65 6420 746f 2062 6520 7468 6520  fined to be the 
-000506f0: 6d65 616e 3a20 2861 730a 2020 2020 2320  mean: (as.    # 
-00050700: 2020 2020 6120 5472 6565 5374 6174 2920      a TreeStat) 
-00050710: 6c65 6e67 7468 206f 6620 616c 6c20 6564  length of all ed
-00050720: 6765 7320 7365 7061 7261 7469 6e67 2074  ges separating t
-00050730: 6865 6d20 696e 2074 6865 2074 7265 652c  hem in the tree,
-00050740: 206f 7220 2861 7320 610a 2020 2020 2320   or (as a.    # 
-00050750: 2020 2020 5369 7465 5374 6174 2920 6465      SiteStat) de
-00050760: 6e73 6974 7920 6f66 2073 6567 7265 6761  nsity of segrega
-00050770: 7469 6e67 2073 6974 6573 2c20 6174 2061  ting sites, at a
-00050780: 2075 6e69 666f 726d 6c79 2063 686f 7365   uniformly chose
-00050790: 6e20 706f 7369 7469 6f6e 0a20 2020 2023  n position.    #
-000507a0: 2020 2020 206f 6e20 7468 6520 6765 6e6f       on the geno
-000507b0: 6d65 2e0a 0a20 2020 2023 2020 2020 203a  me...    #     :
-000507c0: 7061 7261 6d20 6c69 7374 2073 616d 706c  param list sampl
-000507d0: 655f 7365 7473 3a20 4120 6c69 7374 206f  e_sets: A list o
-000507e0: 6620 7365 7473 206f 6620 4944 7320 6f66  f sets of IDs of
-000507f0: 2073 616d 706c 6573 2e0a 2020 2020 2320   samples..    # 
-00050800: 2020 2020 3a70 6172 616d 2069 7465 7261      :param itera
-00050810: 626c 6520 7769 6e64 6f77 733a 2054 6865  ble windows: The
-00050820: 2062 7265 616b 706f 696e 7473 206f 6620   breakpoints of 
-00050830: 7468 6520 7769 6e64 6f77 7320 2869 6e63  the windows (inc
-00050840: 6c75 6469 6e67 2073 7461 7274 0a20 2020  luding start.   
-00050850: 2023 2020 2020 2020 2020 2061 6e64 2065   #         and e
-00050860: 6e64 2c20 736f 2068 6173 206f 6e65 206d  nd, so has one m
-00050870: 6f72 6520 656e 7472 7920 7468 616e 206e  ore entry than n
-00050880: 756d 6265 7220 6f66 2077 696e 646f 7773  umber of windows
-00050890: 292e 0a20 2020 2023 2020 2020 203a 7265  )..    #     :re
-000508a0: 7475 726e 3a20 4120 6c69 7374 206f 6620  turn: A list of 
-000508b0: 7468 6520 7570 7065 7220 7472 6961 6e67  the upper triang
-000508c0: 6c65 206f 6620 6d65 616e 2054 4d52 4341  le of mean TMRCA
-000508d0: 2076 616c 7565 7320 696e 2072 6f77 2d6d   values in row-m
-000508e0: 616a 6f72 0a20 2020 2023 2020 2020 2020  ajor.    #      
-000508f0: 2020 206f 7264 6572 2c20 696e 636c 7564     order, includ
-00050900: 696e 6720 7468 6520 6469 6167 6f6e 616c  ing the diagonal
-00050910: 2e0a 2020 2020 2320 2020 2020 2222 220a  ..    #     """.
-00050920: 2020 2020 2320 2020 2020 6e73 203d 206c      #     ns = l
-00050930: 656e 2873 616d 706c 655f 7365 7473 290a  en(sample_sets).
-00050940: 2020 2020 2320 2020 2020 696e 6465 7865      #     indexe
-00050950: 7320 3d20 5b28 692c 206a 2920 666f 7220  s = [(i, j) for 
-00050960: 6920 696e 2072 616e 6765 286e 7329 2066  i in range(ns) f
-00050970: 6f72 206a 2069 6e20 7261 6e67 6528 692c  or j in range(i,
-00050980: 206e 7329 5d0a 2020 2020 2320 2020 2020   ns)].    #     
-00050990: 7820 3d20 7365 6c66 2e64 6976 6572 6765  x = self.diverge
-000509a0: 6e63 6528 7361 6d70 6c65 5f73 6574 732c  nce(sample_sets,
-000509b0: 2069 6e64 6578 6573 2c20 7769 6e64 6f77   indexes, window
-000509c0: 732c 206d 6f64 653d 6d6f 6465 290a 2020  s, mode=mode).  
-000509d0: 2020 2320 2020 2020 6e77 203d 206c 656e    #     nw = len
-000509e0: 2877 696e 646f 7773 2920 2d20 310a 2020  (windows) - 1.  
-000509f0: 2020 2320 2020 2020 4120 3d20 6e70 2e6f    #     A = np.o
-00050a00: 6e65 7328 286e 772c 206e 732c 206e 7329  nes((nw, ns, ns)
-00050a10: 2c20 6474 7970 653d 666c 6f61 7429 0a20  , dtype=float). 
-00050a20: 2020 2023 2020 2020 2066 6f72 2077 2069     #     for w i
-00050a30: 6e20 7261 6e67 6528 6e77 293a 0a20 2020  n range(nw):.   
-00050a40: 2023 2020 2020 2020 2020 206b 203d 2030   #         k = 0
-00050a50: 0a20 2020 2023 2020 2020 2020 2020 2066  .    #         f
-00050a60: 6f72 2069 2069 6e20 7261 6e67 6528 6e73  or i in range(ns
-00050a70: 293a 0a20 2020 2023 2020 2020 2020 2020  ):.    #        
-00050a80: 2020 2020 2066 6f72 206a 2069 6e20 7261       for j in ra
-00050a90: 6e67 6528 692c 206e 7329 3a0a 2020 2020  nge(i, ns):.    
-00050aa0: 2320 2020 2020 2020 2020 2020 2020 2020  #               
-00050ab0: 2020 415b 772c 2069 2c20 6a5d 203d 2041    A[w, i, j] = A
-00050ac0: 5b77 2c20 6a2c 2069 5d20 3d20 785b 775d  [w, j, i] = x[w]
-00050ad0: 5b6b 5d0a 2020 2020 2320 2020 2020 2020  [k].    #       
-00050ae0: 2020 2020 2020 2020 2020 6b20 2b3d 2031            k += 1
-00050af0: 0a20 2020 2023 2020 2020 2072 6574 7572  .    #     retur
-00050b00: 6e20 410a 0a20 2020 2064 6566 2067 656e  n A..    def gen
-00050b10: 6574 6963 5f72 656c 6174 6564 6e65 7373  etic_relatedness
-00050b20: 280a 2020 2020 2020 2020 7365 6c66 2c0a  (.        self,.
-00050b30: 2020 2020 2020 2020 7361 6d70 6c65 5f73          sample_s
-00050b40: 6574 732c 0a20 2020 2020 2020 2069 6e64  ets,.        ind
-00050b50: 6578 6573 3d4e 6f6e 652c 0a20 2020 2020  exes=None,.     
-00050b60: 2020 2077 696e 646f 7773 3d4e 6f6e 652c     windows=None,
-00050b70: 0a20 2020 2020 2020 206d 6f64 653d 2273  .        mode="s
-00050b80: 6974 6522 2c0a 2020 2020 2020 2020 7370  ite",.        sp
-00050b90: 616e 5f6e 6f72 6d61 6c69 7365 3d54 7275  an_normalise=Tru
-00050ba0: 652c 0a20 2020 2020 2020 2070 6f6c 6172  e,.        polar
-00050bb0: 6973 6564 3d46 616c 7365 2c0a 2020 2020  ised=False,.    
-00050bc0: 2020 2020 7072 6f70 6f72 7469 6f6e 3d54      proportion=T
-00050bd0: 7275 652c 0a20 2020 2029 3a0a 2020 2020  rue,.    ):.    
-00050be0: 2020 2020 2222 220a 2020 2020 2020 2020      """.        
-00050bf0: 436f 6d70 7574 6573 2067 656e 6574 6963  Computes genetic
-00050c00: 2072 656c 6174 6564 6e65 7373 2062 6574   relatedness bet
-00050c10: 7765 656e 2028 616e 6420 7769 7468 696e  ween (and within
-00050c20: 2920 7061 6972 7320 6f66 0a20 2020 2020  ) pairs of.     
-00050c30: 2020 2073 6574 7320 6f66 206e 6f64 6573     sets of nodes
-00050c40: 2066 726f 6d20 6060 7361 6d70 6c65 5f73   from ``sample_s
-00050c50: 6574 7360 602e 0a20 2020 2020 2020 204f  ets``..        O
-00050c60: 7065 7261 7465 7320 6f6e 2060 606b 203d  perates on ``k =
-00050c70: 2032 6060 2073 616d 706c 6520 7365 7473   2`` sample sets
-00050c80: 2061 7420 6120 7469 6d65 3b20 706c 6561   at a time; plea
-00050c90: 7365 2073 6565 2074 6865 0a20 2020 2020  se see the.     
-00050ca0: 2020 203a 7265 663a 606d 756c 7469 2d77     :ref:`multi-w
-00050cb0: 6179 2073 7461 7469 7374 6963 7320 3c73  ay statistics <s
-00050cc0: 6563 5f73 7461 7473 5f73 616d 706c 655f  ec_stats_sample_
-00050cd0: 7365 7473 5f6d 756c 7469 5f77 6179 3e60  sets_multi_way>`
-00050ce0: 0a20 2020 2020 2020 2073 6563 7469 6f6e  .        section
-00050cf0: 2066 6f72 2064 6574 6169 6c73 206f 6e20   for details on 
-00050d00: 686f 7720 7468 6520 6060 7361 6d70 6c65  how the ``sample
-00050d10: 5f73 6574 7360 6020 616e 6420 6060 696e  _sets`` and ``in
-00050d20: 6465 7865 7360 6020 6172 6775 6d65 6e74  dexes`` argument
-00050d30: 7320 6172 650a 2020 2020 2020 2020 696e  s are.        in
-00050d40: 7465 7270 7265 7465 6420 616e 6420 686f  terpreted and ho
-00050d50: 7720 7468 6579 2069 6e74 6572 6163 7420  w they interact 
-00050d60: 7769 7468 2074 6865 2064 696d 656e 7369  with the dimensi
-00050d70: 6f6e 7320 6f66 2074 6865 206f 7574 7075  ons of the outpu
-00050d80: 7420 6172 7261 792e 0a20 2020 2020 2020  t array..       
-00050d90: 2053 6565 2074 6865 203a 7265 663a 6073   See the :ref:`s
-00050da0: 7461 7469 7374 6963 7320 696e 7465 7266  tatistics interf
-00050db0: 6163 6520 3c73 6563 5f73 7461 7473 5f69  ace <sec_stats_i
-00050dc0: 6e74 6572 6661 6365 3e60 2073 6563 7469  nterface>` secti
-00050dd0: 6f6e 2066 6f72 2064 6574 6169 6c73 206f  on for details o
-00050de0: 6e0a 2020 2020 2020 2020 3a72 6566 3a60  n.        :ref:`
-00050df0: 7769 6e64 6f77 7320 3c73 6563 5f73 7461  windows <sec_sta
-00050e00: 7473 5f77 696e 646f 7773 3e60 2c0a 2020  ts_windows>`,.  
-00050e10: 2020 2020 2020 3a72 6566 3a60 6d6f 6465        :ref:`mode
-00050e20: 203c 7365 635f 7374 6174 735f 6d6f 6465   <sec_stats_mode
-00050e30: 3e60 2c0a 2020 2020 2020 2020 3a72 6566  >`,.        :ref
-00050e40: 3a60 7370 616e 206e 6f72 6d61 6c69 7365  :`span normalise
-00050e50: 203c 7365 635f 7374 6174 735f 7370 616e   <sec_stats_span
-00050e60: 5f6e 6f72 6d61 6c69 7365 3e60 2c0a 2020  _normalise>`,.  
-00050e70: 2020 2020 2020 3a72 6566 3a60 706f 6c61        :ref:`pola
-00050e80: 7269 7365 6420 3c73 6563 5f73 7461 7473  rised <sec_stats
-00050e90: 5f70 6f6c 6172 6973 6174 696f 6e3e 602c  _polarisation>`,
-00050ea0: 0a20 2020 2020 2020 2061 6e64 203a 7265  .        and :re
-00050eb0: 663a 6072 6574 7572 6e20 7661 6c75 6520  f:`return value 
-00050ec0: 3c73 6563 5f73 7461 7473 5f6f 7574 7075  <sec_stats_outpu
-00050ed0: 745f 666f 726d 6174 3e60 2e0a 0a20 2020  t_format>`...   
-00050ee0: 2020 2020 2057 6861 7420 6973 2063 6f6d       What is com
-00050ef0: 7075 7465 6420 6465 7065 6e64 7320 6f6e  puted depends on
-00050f00: 2060 606d 6f64 6560 603a 0a0a 2020 2020   ``mode``:..    
-00050f10: 2020 2020 2273 6974 6522 0a20 2020 2020      "site".     
-00050f20: 2020 2020 2020 204e 756d 6265 7220 6f66         Number of
-00050f30: 2070 6169 7277 6973 6520 616c 6c65 6c69   pairwise alleli
-00050f40: 6320 6d61 7463 6865 7320 696e 2074 6865  c matches in the
-00050f50: 2077 696e 646f 7720 6265 7477 6565 6e20   window between 
-00050f60: 7477 6f0a 2020 2020 2020 2020 2020 2020  two.            
-00050f70: 7361 6d70 6c65 2073 6574 7320 7265 6c61  sample sets rela
-00050f80: 7469 7665 2074 6f20 7468 6520 7265 7374  tive to the rest
-00050f90: 206f 6620 7468 6520 7361 6d70 6c65 2073   of the sample s
-00050fa0: 6574 732e 2054 6f20 6265 2070 7265 6369  ets. To be preci
-00050fb0: 7365 2c0a 2020 2020 2020 2020 2020 2020  se,.            
-00050fc0: 6c65 7420 606d 2875 2c76 2960 2064 656e  let `m(u,v)` den
-00050fd0: 6f74 6520 7468 6520 746f 7461 6c20 6e75  ote the total nu
-00050fe0: 6d62 6572 206f 6620 616c 6c65 6c65 7320  mber of alleles 
-00050ff0: 7368 6172 6564 2062 6574 7765 656e 0a20  shared between. 
-00051000: 2020 2020 2020 2020 2020 206e 6f64 6573             nodes
-00051010: 2060 7560 2061 6e64 2060 7660 2c20 616e   `u` and `v`, an
-00051020: 6420 6c65 7420 606d 2849 2c4a 2960 2062  d let `m(I,J)` b
-00051030: 6520 7468 6520 7375 6d20 6f66 2060 6d28  e the sum of `m(
-00051040: 752c 7629 6020 6f76 6572 2061 6c6c 0a20  u,v)` over all. 
-00051050: 2020 2020 2020 2020 2020 206e 6f64 6573             nodes
-00051060: 2060 7560 2069 6e20 7361 6d70 6c65 2073   `u` in sample s
-00051070: 6574 2060 4960 2061 6e64 2060 7660 2069  et `I` and `v` i
-00051080: 6e20 7361 6d70 6c65 2073 6574 2060 4a60  n sample set `J`
-00051090: 2e20 4c65 7420 6053 6020 616e 640a 2020  . Let `S` and.  
-000510a0: 2020 2020 2020 2020 2020 6054 6020 6265            `T` be
-000510b0: 2069 6e64 6570 656e 6465 6e74 6c79 2063   independently c
-000510c0: 686f 7365 6e20 7361 6d70 6c65 2073 6574  hosen sample set
-000510d0: 732e 2054 6865 6e2c 2066 6f72 2073 616d  s. Then, for sam
-000510e0: 706c 6520 7365 7473 2060 4960 0a20 2020  ple sets `I`.   
-000510f0: 2020 2020 2020 2020 2061 6e64 2060 4a60           and `J`
-00051100: 2c20 7468 6973 2063 6f6d 7075 7465 7320  , this computes 
-00051110: 6045 5b6d 2849 2c4a 2920 2d20 6d28 492c  `E[m(I,J) - m(I,
-00051120: 5329 202d 206d 284a 2c54 2920 2b20 6d28  S) - m(J,T) + m(
-00051130: 532c 5429 5d60 2e0a 2020 2020 2020 2020  S,T)]`..        
-00051140: 2020 2020 5468 6973 2063 616e 2061 6c73      This can als
-00051150: 6f20 6265 2073 6565 6e20 6173 2074 6865  o be seen as the
-00051160: 2063 6f76 6172 6961 6e63 6520 6f66 2061   covariance of a
-00051170: 2071 7561 6e74 6974 6174 6976 6520 7472   quantitative tr
-00051180: 6169 740a 2020 2020 2020 2020 2020 2020  ait.            
-00051190: 6465 7465 726d 696e 6564 2062 7920 6164  determined by ad
-000511a0: 6469 7469 7665 2063 6f6e 7472 6962 7574  ditive contribut
-000511b0: 696f 6e73 2066 726f 6d20 7468 6520 6765  ions from the ge
-000511c0: 6e6f 6d65 7320 696e 2065 6163 680a 2020  nomes in each.  
-000511d0: 2020 2020 2020 2020 2020 7361 6d70 6c65            sample
-000511e0: 2073 6574 2e20 4c65 7420 6561 6368 2061   set. Let each a
-000511f0: 6c6c 656c 6520 6265 2061 7373 6f63 6961  llele be associa
-00051200: 7465 6420 7769 7468 2061 6e20 6566 6665  ted with an effe
-00051210: 6374 2064 7261 776e 2066 726f 6d0a 2020  ct drawn from.  
-00051220: 2020 2020 2020 2020 2020 6120 604e 2830            a `N(0
-00051230: 2c31 2f32 2960 2064 6973 7472 6962 7574  ,1/2)` distribut
-00051240: 696f 6e2c 2061 6e64 206c 6574 2074 6865  ion, and let the
-00051250: 2074 7261 6974 2076 616c 7565 206f 6620   trait value of 
-00051260: 6120 7361 6d70 6c65 2073 6574 0a20 2020  a sample set.   
-00051270: 2020 2020 2020 2020 2062 6520 7468 6520           be the 
-00051280: 7375 6d20 6f66 2069 7473 2061 6c6c 656c  sum of its allel
-00051290: 6520 6566 6665 6374 732e 2054 6865 6e2c  e effects. Then,
-000512a0: 2074 6869 7320 636f 6d70 7574 6573 2074   this computes t
-000512b0: 6865 2063 6f76 6172 6961 6e63 650a 2020  he covariance.  
-000512c0: 2020 2020 2020 2020 2020 6265 7477 6565            betwee
-000512d0: 6e20 7468 6520 7472 6169 7420 7661 6c75  n the trait valu
-000512e0: 6573 206f 6620 7477 6f20 7361 6d70 6c65  es of two sample
-000512f0: 2073 6574 732e 2046 6f72 2065 7861 6d70   sets. For examp
-00051300: 6c65 2c20 746f 0a20 2020 2020 2020 2020  le, to.         
-00051310: 2020 2063 6f6d 7075 7465 2063 6f76 6172     compute covar
-00051320: 6961 6e63 6520 6265 7477 6565 6e20 7468  iance between th
-00051330: 6520 7472 6169 7473 206f 6620 6469 706c  e traits of dipl
-00051340: 6f69 6420 696e 6469 7669 6475 616c 732c  oid individuals,
-00051350: 2065 6163 680a 2020 2020 2020 2020 2020   each.          
-00051360: 2020 7361 6d70 6c65 2073 6574 2077 6f75    sample set wou
-00051370: 6c64 2062 6520 7468 6520 7061 6972 206f  ld be the pair o
-00051380: 6620 6765 6e6f 6d65 7320 6f66 2065 6163  f genomes of eac
-00051390: 6820 696e 6469 7669 6475 616c 3b20 6966  h individual; if
-000513a0: 0a20 2020 2020 2020 2020 2020 2060 6070  .            ``p
-000513b0: 726f 706f 7274 696f 6e3d 5472 7565 6060  roportion=True``
-000513c0: 2c20 7468 6973 2074 6865 6e20 636f 7272  , this then corr
-000513d0: 6573 706f 6e64 7320 746f 203a 6d61 7468  esponds to :math
-000513e0: 3a60 4b5f 7b63 307d 6020 696e 0a20 2020  :`K_{c0}` in.   
-000513f0: 2020 2020 2020 2020 2060 5370 6565 6420           `Speed 
-00051400: 2620 4261 6c64 696e 6720 2832 3031 3429  & Balding (2014)
-00051410: 203c 6874 7470 733a 2f2f 7777 772e 6e61   <https://www.na
-00051420: 7475 7265 2e63 6f6d 2f61 7274 6963 6c65  ture.com/article
-00051430: 732f 6e72 6733 3832 313e 605f 2e0a 0a20  s/nrg3821>`_... 
-00051440: 2020 2020 2020 2022 6272 616e 6368 220a         "branch".
-00051450: 2020 2020 2020 2020 2020 2020 546f 7461              Tota
-00051460: 6c20 6172 6561 206f 6620 6272 616e 6368  l area of branch
-00051470: 6573 2069 6e20 7468 6520 7769 6e64 6f77  es in the window
-00051480: 2061 6e63 6573 7472 616c 2074 6f20 7061   ancestral to pa
-00051490: 6972 7320 6f66 2073 616d 706c 6573 0a20  irs of samples. 
-000514a0: 2020 2020 2020 2020 2020 2069 6e20 7477             in tw
-000514b0: 6f20 7361 6d70 6c65 2073 6574 7320 7265  o sample sets re
-000514c0: 6c61 7469 7665 2074 6f20 7468 6520 7265  lative to the re
-000514d0: 7374 206f 6620 7468 6520 7361 6d70 6c65  st of the sample
-000514e0: 2073 6574 732e 2054 6f20 6265 0a20 2020   sets. To be.   
-000514f0: 2020 2020 2020 2020 2070 7265 6369 7365           precise
-00051500: 2c20 6c65 7420 6042 2875 2c76 2960 2064  , let `B(u,v)` d
-00051510: 656e 6f74 6520 7468 6520 746f 7461 6c20  enote the total 
-00051520: 6172 6561 206f 6620 616c 6c20 6272 616e  area of all bran
-00051530: 6368 6573 0a20 2020 2020 2020 2020 2020  ches.           
-00051540: 2061 6e63 6573 7472 616c 2074 6f20 6e6f   ancestral to no
-00051550: 6465 7320 6075 6020 616e 6420 6076 602c  des `u` and `v`,
-00051560: 2061 6e64 206c 6574 2060 4228 492c 4a29   and let `B(I,J)
-00051570: 6020 6265 2074 6865 2073 756d 206f 660a  ` be the sum of.
-00051580: 2020 2020 2020 2020 2020 2020 6042 2875              `B(u
-00051590: 2c76 2960 206f 7665 7220 616c 6c20 6e6f  ,v)` over all no
-000515a0: 6465 7320 6075 6020 696e 2073 616d 706c  des `u` in sampl
-000515b0: 6520 7365 7420 6049 6020 616e 6420 6076  e set `I` and `v
-000515c0: 6020 696e 2073 616d 706c 6520 7365 740a  ` in sample set.
-000515d0: 2020 2020 2020 2020 2020 2020 604a 602e              `J`.
-000515e0: 204c 6574 2060 5360 2061 6e64 2060 5460   Let `S` and `T`
-000515f0: 2062 6520 7477 6f20 696e 6465 7065 6e64   be two independ
-00051600: 656e 746c 7920 6368 6f73 656e 2073 616d  ently chosen sam
-00051610: 706c 6520 7365 7473 2e20 5468 656e 0a20  ple sets. Then. 
-00051620: 2020 2020 2020 2020 2020 2066 6f72 2073             for s
-00051630: 616d 706c 6520 7365 7473 2060 4960 2061  ample sets `I` a
-00051640: 6e64 2060 4a60 2c20 7468 6973 2063 6f6d  nd `J`, this com
-00051650: 7075 7465 730a 2020 2020 2020 2020 2020  putes.          
-00051660: 2020 6045 5b42 2849 2c4a 2920 2d20 4228    `E[B(I,J) - B(
-00051670: 492c 5329 202d 2042 284a 2c54 2920 2b20  I,S) - B(J,T) + 
-00051680: 4228 532c 5429 5d60 2e0a 0a20 2020 2020  B(S,T)]`...     
-00051690: 2020 2022 6e6f 6465 220a 2020 2020 2020     "node".      
-000516a0: 2020 2020 2020 466f 7220 6561 6368 206e        For each n
-000516b0: 6f64 652c 2074 6865 2070 726f 706f 7274  ode, the proport
-000516c0: 696f 6e20 6f66 2074 6865 2077 696e 646f  ion of the windo
-000516d0: 7720 6f76 6572 2077 6869 6368 2070 6169  w over which pai
-000516e0: 7273 206f 660a 2020 2020 2020 2020 2020  rs of.          
-000516f0: 2020 7361 6d70 6c65 7320 696e 2074 776f    samples in two
-00051700: 2073 616d 706c 6520 7365 7473 2061 7265   sample sets are
-00051710: 2064 6573 6365 6e64 616e 7473 2c20 7265   descendants, re
-00051720: 6c61 7469 7665 2074 6f20 7468 6520 7265  lative to the re
-00051730: 7374 206f 660a 2020 2020 2020 2020 2020  st of.          
-00051740: 2020 7468 6520 7361 6d70 6c65 2073 6574    the sample set
-00051750: 732e 2054 6f20 6265 2070 7265 6369 7365  s. To be precise
-00051760: 2c20 666f 7220 6561 6368 206e 6f64 6520  , for each node 
-00051770: 606e 602c 206c 6574 2060 4e28 752c 7629  `n`, let `N(u,v)
-00051780: 600a 2020 2020 2020 2020 2020 2020 6465  `.            de
-00051790: 6e6f 7465 2074 6865 2070 726f 706f 7274  note the proport
-000517a0: 696f 6e20 6f66 2074 6865 2077 696e 646f  ion of the windo
-000517b0: 7720 6f76 6572 2077 6869 6368 2073 616d  w over which sam
-000517c0: 706c 6573 2060 7560 2061 6e64 2060 7660  ples `u` and `v`
-000517d0: 0a20 2020 2020 2020 2020 2020 2061 7265  .            are
-000517e0: 2064 6573 6365 6e64 616e 7473 206f 6620   descendants of 
-000517f0: 606e 602c 2061 6e64 206c 6574 2061 6e64  `n`, and let and
-00051800: 206c 6574 2060 4e28 492c 4a29 6020 6265   let `N(I,J)` be
-00051810: 2074 6865 2073 756d 206f 660a 2020 2020   the sum of.    
-00051820: 2020 2020 2020 2020 604e 2875 2c76 2960          `N(u,v)`
-00051830: 206f 7665 7220 616c 6c20 6e6f 6465 7320   over all nodes 
-00051840: 6075 6020 696e 2073 616d 706c 6520 7365  `u` in sample se
-00051850: 7420 6049 6020 616e 6420 6076 6020 696e  t `I` and `v` in
-00051860: 2073 616d 706c 6520 7365 740a 2020 2020   sample set.    
-00051870: 2020 2020 2020 2020 604a 602e 204c 6574          `J`. Let
-00051880: 2060 5360 2061 6e64 2060 5460 2062 6520   `S` and `T` be 
-00051890: 7477 6f20 696e 6465 7065 6e64 656e 746c  two independentl
-000518a0: 7920 6368 6f73 656e 2073 616d 706c 6520  y chosen sample 
-000518b0: 7365 7473 2e20 5468 656e 0a20 2020 2020  sets. Then.     
-000518c0: 2020 2020 2020 2066 6f72 2073 616d 706c         for sampl
-000518d0: 6520 7365 7473 2060 4960 2061 6e64 2060  e sets `I` and `
-000518e0: 4a60 2c20 7468 6973 2063 6f6d 7075 7465  J`, this compute
-000518f0: 730a 2020 2020 2020 2020 2020 2020 6045  s.            `E
-00051900: 5b4e 2849 2c4a 2920 2d20 4e28 492c 5329  [N(I,J) - N(I,S)
-00051910: 202d 204e 284a 2c54 2920 2b20 4e28 532c   - N(J,T) + N(S,
-00051920: 5429 5d60 2e0a 0a20 2020 2020 2020 203a  T)]`...        :
-00051930: 7061 7261 6d20 6c69 7374 2073 616d 706c  param list sampl
-00051940: 655f 7365 7473 3a20 4120 6c69 7374 206f  e_sets: A list o
-00051950: 6620 6c69 7374 7320 6f66 204e 6f64 6520  f lists of Node 
-00051960: 4944 732c 2073 7065 6369 6679 696e 6720  IDs, specifying 
-00051970: 7468 650a 2020 2020 2020 2020 2020 2020  the.            
-00051980: 6772 6f75 7073 206f 6620 6e6f 6465 7320  groups of nodes 
-00051990: 746f 2063 6f6d 7075 7465 2074 6865 2073  to compute the s
-000519a0: 7461 7469 7374 6963 2077 6974 682e 0a20  tatistic with.. 
-000519b0: 2020 2020 2020 203a 7061 7261 6d20 6c69         :param li
-000519c0: 7374 2069 6e64 6578 6573 3a20 4120 6c69  st indexes: A li
-000519d0: 7374 206f 6620 322d 7475 706c 6573 2c20  st of 2-tuples, 
-000519e0: 6f72 204e 6f6e 652e 0a20 2020 2020 2020  or None..       
-000519f0: 203a 7061 7261 6d20 6c69 7374 2077 696e   :param list win
-00051a00: 646f 7773 3a20 416e 2069 6e63 7265 6173  dows: An increas
-00051a10: 696e 6720 6c69 7374 206f 6620 6272 6561  ing list of brea
-00051a20: 6b70 6f69 6e74 7320 6265 7477 6565 6e20  kpoints between 
-00051a30: 7468 6520 7769 6e64 6f77 730a 2020 2020  the windows.    
-00051a40: 2020 2020 2020 2020 746f 2063 6f6d 7075          to compu
-00051a50: 7465 2074 6865 2073 7461 7469 7374 6963  te the statistic
-00051a60: 2069 6e2e 0a20 2020 2020 2020 203a 7061   in..        :pa
-00051a70: 7261 6d20 7374 7220 6d6f 6465 3a20 4120  ram str mode: A 
-00051a80: 7374 7269 6e67 2067 6976 696e 6720 7468  string giving th
-00051a90: 6520 2274 7970 6522 206f 6620 7468 6520  e "type" of the 
-00051aa0: 7374 6174 6973 7469 6320 746f 2062 6520  statistic to be 
-00051ab0: 636f 6d70 7574 6564 0a20 2020 2020 2020  computed.       
-00051ac0: 2020 2020 2028 6465 6661 756c 7473 2074       (defaults t
-00051ad0: 6f20 2273 6974 6522 292e 0a20 2020 2020  o "site")..     
-00051ae0: 2020 203a 7061 7261 6d20 626f 6f6c 2073     :param bool s
-00051af0: 7061 6e5f 6e6f 726d 616c 6973 653a 2057  pan_normalise: W
-00051b00: 6865 7468 6572 2074 6f20 6469 7669 6465  hether to divide
-00051b10: 2074 6865 2072 6573 756c 7420 6279 2074   the result by t
-00051b20: 6865 2073 7061 6e20 6f66 2074 6865 0a20  he span of the. 
-00051b30: 2020 2020 2020 2020 2020 2077 696e 646f             windo
-00051b40: 7720 2864 6566 6175 6c74 7320 746f 2054  w (defaults to T
-00051b50: 7275 6529 2e20 4861 7320 6e6f 2065 6666  rue). Has no eff
-00051b60: 6563 7420 6966 2060 6070 726f 706f 7274  ect if ``proport
-00051b70: 696f 6e60 6020 6973 2054 7275 652e 0a20  ion`` is True.. 
-00051b80: 2020 2020 2020 203a 7061 7261 6d20 626f         :param bo
-00051b90: 6f6c 2070 726f 706f 7274 696f 6e3a 2044  ol proportion: D
-00051ba0: 6566 6175 6c74 7320 746f 2054 7275 652e  efaults to True.
-00051bb0: 2020 5768 6574 6865 7220 746f 2064 6976    Whether to div
-00051bc0: 6964 6520 7468 6520 7265 7375 6c74 2062  ide the result b
-00051bd0: 790a 2020 2020 2020 2020 2020 2020 3a6d  y.            :m
-00051be0: 6574 683a 602e 7365 6772 6567 6174 696e  eth:`.segregatin
-00051bf0: 675f 7369 7465 7360 2c20 6361 6c6c 6564  g_sites`, called
-00051c00: 2077 6974 6820 7468 6520 7361 6d65 2060   with the same `
-00051c10: 6077 696e 646f 7773 6060 2c0a 2020 2020  `windows``,.    
-00051c20: 2020 2020 2020 2020 6060 6d6f 6465 6060          ``mode``
-00051c30: 2c20 616e 6420 6060 7370 616e 5f6e 6f72  , and ``span_nor
-00051c40: 6d61 6c69 7365 6060 2e20 4e6f 7465 2074  malise``. Note t
-00051c50: 6861 7420 7468 6973 2063 6f75 6e74 7320  hat this counts 
-00051c60: 7369 7465 730a 2020 2020 2020 2020 2020  sites.          
-00051c70: 2020 7468 6174 2061 7265 2073 6567 7265    that are segre
-00051c80: 6761 7469 6e67 2062 6574 7765 656e 202a  gating between *
-00051c90: 616e 792a 206f 6620 7468 6520 7361 6d70  any* of the samp
-00051ca0: 6c65 7320 6f66 202a 616e 792a 206f 6620  les of *any* of 
-00051cb0: 7468 650a 2020 2020 2020 2020 2020 2020  the.            
-00051cc0: 7361 6d70 6c65 2073 6574 7320 2872 6174  sample sets (rat
-00051cd0: 6865 7220 7468 616e 2073 6567 7265 6761  her than segrega
-00051ce0: 7469 6e67 2062 6574 7765 656e 2061 6c6c  ting between all
-00051cf0: 206f 6620 7468 6520 7361 6d70 6c65 7320   of the samples 
-00051d00: 6f66 0a20 2020 2020 2020 2020 2020 2074  of.            t
-00051d10: 6865 2074 7265 6520 7365 7175 656e 6365  he tree sequence
-00051d20: 292e 0a20 2020 2020 2020 203a 7265 7475  )..        :retu
-00051d30: 726e 3a20 4120 6e64 6172 7261 7920 7769  rn: A ndarray wi
-00051d40: 7468 2073 6861 7065 2065 7175 616c 2074  th shape equal t
-00051d50: 6f20 286e 756d 2077 696e 646f 7773 2c20  o (num windows, 
-00051d60: 6e75 6d20 7374 6174 6973 7469 6373 292e  num statistics).
-00051d70: 0a20 2020 2020 2020 2020 2020 2049 6620  .            If 
-00051d80: 7468 6572 6520 6973 206f 6e65 2070 6169  there is one pai
-00051d90: 7220 6f66 2073 616d 706c 6520 7365 7473  r of sample sets
-00051da0: 2061 6e64 2077 696e 646f 7773 3d4e 6f6e   and windows=Non
-00051db0: 652c 2061 206e 756d 7079 2073 6361 6c61  e, a numpy scala
-00051dc0: 7220 6973 0a20 2020 2020 2020 2020 2020  r is.           
-00051dd0: 2072 6574 7572 6e65 642e 0a20 2020 2020   returned..     
-00051de0: 2020 2022 2222 0a20 2020 2020 2020 2069     """.        i
-00051df0: 6620 7072 6f70 6f72 7469 6f6e 3a0a 2020  f proportion:.  
-00051e00: 2020 2020 2020 2020 2020 2320 544f 444f            # TODO
-00051e10: 2074 6869 7320 7368 6f75 6c64 2062 6520   this should be 
-00051e20: 646f 6e65 2069 6e20 4320 616c 736f 0a20  done in C also. 
-00051e30: 2020 2020 2020 2020 2020 2061 6c6c 5f73             all_s
-00051e40: 616d 706c 6573 203d 206c 6973 7428 7b75  amples = list({u
-00051e50: 2066 6f72 2073 2069 6e20 7361 6d70 6c65   for s in sample
-00051e60: 5f73 6574 7320 666f 7220 7520 696e 2073  _sets for u in s
-00051e70: 7d29 0a20 2020 2020 2020 2020 2020 2064  }).            d
-00051e80: 656e 6f6d 696e 6174 6f72 203d 2073 656c  enominator = sel
-00051e90: 662e 7365 6772 6567 6174 696e 675f 7369  f.segregating_si
-00051ea0: 7465 7328 0a20 2020 2020 2020 2020 2020  tes(.           
-00051eb0: 2020 2020 2073 616d 706c 655f 7365 7473       sample_sets
-00051ec0: 3d5b 616c 6c5f 7361 6d70 6c65 735d 2c0a  =[all_samples],.
-00051ed0: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00051ee0: 7769 6e64 6f77 733d 7769 6e64 6f77 732c  windows=windows,
-00051ef0: 0a20 2020 2020 2020 2020 2020 2020 2020  .               
-00051f00: 206d 6f64 653d 6d6f 6465 2c0a 2020 2020   mode=mode,.    
-00051f10: 2020 2020 2020 2020 2020 2020 7370 616e              span
-00051f20: 5f6e 6f72 6d61 6c69 7365 3d73 7061 6e5f  _normalise=span_
-00051f30: 6e6f 726d 616c 6973 652c 0a20 2020 2020  normalise,.     
-00051f40: 2020 2020 2020 2029 0a20 2020 2020 2020         ).       
-00051f50: 2065 6c73 653a 0a20 2020 2020 2020 2020   else:.         
-00051f60: 2020 2064 656e 6f6d 696e 6174 6f72 203d     denominator =
-00051f70: 2031 0a0a 2020 2020 2020 2020 6e75 6d65   1..        nume
-00051f80: 7261 746f 7220 3d20 7365 6c66 2e5f 5f6b  rator = self.__k
-00051f90: 5f77 6179 5f73 616d 706c 655f 7365 745f  _way_sample_set_
-00051fa0: 7374 6174 280a 2020 2020 2020 2020 2020  stat(.          
-00051fb0: 2020 7365 6c66 2e5f 6c6c 5f74 7265 655f    self._ll_tree_
-00051fc0: 7365 7175 656e 6365 2e67 656e 6574 6963  sequence.genetic
-00051fd0: 5f72 656c 6174 6564 6e65 7373 2c0a 2020  _relatedness,.  
-00051fe0: 2020 2020 2020 2020 2020 322c 0a20 2020            2,.   
-00051ff0: 2020 2020 2020 2020 2073 616d 706c 655f           sample_
-00052000: 7365 7473 2c0a 2020 2020 2020 2020 2020  sets,.          
-00052010: 2020 696e 6465 7865 733d 696e 6465 7865    indexes=indexe
-00052020: 732c 0a20 2020 2020 2020 2020 2020 2077  s,.            w
-00052030: 696e 646f 7773 3d77 696e 646f 7773 2c0a  indows=windows,.
-00052040: 2020 2020 2020 2020 2020 2020 6d6f 6465              mode
-00052050: 3d6d 6f64 652c 0a20 2020 2020 2020 2020  =mode,.         
-00052060: 2020 2073 7061 6e5f 6e6f 726d 616c 6973     span_normalis
-00052070: 653d 7370 616e 5f6e 6f72 6d61 6c69 7365  e=span_normalise
-00052080: 2c0a 2020 2020 2020 2020 2020 2020 706f  ,.            po
-00052090: 6c61 7269 7365 643d 706f 6c61 7269 7365  larised=polarise
-000520a0: 642c 0a20 2020 2020 2020 2029 0a20 2020  d,.        ).   
-000520b0: 2020 2020 2077 6974 6820 6e70 2e65 7272       with np.err
-000520c0: 7374 6174 6528 6469 7669 6465 3d22 6967  state(divide="ig
-000520d0: 6e6f 7265 222c 2069 6e76 616c 6964 3d22  nore", invalid="
-000520e0: 6967 6e6f 7265 2229 3a0a 2020 2020 2020  ignore"):.      
-000520f0: 2020 2020 2020 6f75 7420 3d20 6e75 6d65        out = nume
-00052100: 7261 746f 7220 2f20 6465 6e6f 6d69 6e61  rator / denomina
-00052110: 746f 720a 0a20 2020 2020 2020 2072 6574  tor..        ret
-00052120: 7572 6e20 6f75 740a 0a20 2020 2064 6566  urn out..    def
-00052130: 2074 7261 6974 5f63 6f76 6172 6961 6e63   trait_covarianc
-00052140: 6528 7365 6c66 2c20 572c 2077 696e 646f  e(self, W, windo
-00052150: 7773 3d4e 6f6e 652c 206d 6f64 653d 2273  ws=None, mode="s
-00052160: 6974 6522 2c20 7370 616e 5f6e 6f72 6d61  ite", span_norma
-00052170: 6c69 7365 3d54 7275 6529 3a0a 2020 2020  lise=True):.    
-00052180: 2020 2020 2222 220a 2020 2020 2020 2020      """.        
-00052190: 436f 6d70 7574 6573 2074 6865 206d 6561  Computes the mea
-000521a0: 6e20 7371 7561 7265 6420 636f 7661 7269  n squared covari
-000521b0: 616e 6365 7320 6265 7477 6565 6e20 6561  ances between ea
-000521c0: 6368 206f 6620 7468 6520 636f 6c75 6d6e  ch of the column
-000521d0: 7320 6f66 2060 6057 6060 0a20 2020 2020  s of ``W``.     
-000521e0: 2020 2028 7468 6520 2270 6865 6e6f 7479     (the "phenoty
-000521f0: 7065 7322 2920 616e 6420 696e 6865 7269  pes") and inheri
-00052200: 7461 6e63 6520 616c 6f6e 6720 7468 6520  tance along the 
-00052210: 7472 6565 2073 6571 7565 6e63 652e 0a20  tree sequence.. 
-00052220: 2020 2020 2020 2053 6565 2074 6865 203a         See the :
-00052230: 7265 663a 6073 7461 7469 7374 6963 7320  ref:`statistics 
-00052240: 696e 7465 7266 6163 6520 3c73 6563 5f73  interface <sec_s
-00052250: 7461 7473 5f69 6e74 6572 6661 6365 3e60  tats_interface>`
-00052260: 2073 6563 7469 6f6e 2066 6f72 2064 6574   section for det
-00052270: 6169 6c73 206f 6e0a 2020 2020 2020 2020  ails on.        
-00052280: 3a72 6566 3a60 7769 6e64 6f77 7320 3c73  :ref:`windows <s
-00052290: 6563 5f73 7461 7473 5f77 696e 646f 7773  ec_stats_windows
-000522a0: 3e60 2c0a 2020 2020 2020 2020 3a72 6566  >`,.        :ref
-000522b0: 3a60 6d6f 6465 203c 7365 635f 7374 6174  :`mode <sec_stat
-000522c0: 735f 6d6f 6465 3e60 2c0a 2020 2020 2020  s_mode>`,.      
-000522d0: 2020 3a72 6566 3a60 7370 616e 206e 6f72    :ref:`span nor
-000522e0: 6d61 6c69 7365 203c 7365 635f 7374 6174  malise <sec_stat
-000522f0: 735f 7370 616e 5f6e 6f72 6d61 6c69 7365  s_span_normalise
-00052300: 3e60 2c0a 2020 2020 2020 2020 616e 6420  >`,.        and 
-00052310: 3a72 6566 3a60 7265 7475 726e 2076 616c  :ref:`return val
-00052320: 7565 203c 7365 635f 7374 6174 735f 6f75  ue <sec_stats_ou
-00052330: 7470 7574 5f66 6f72 6d61 743e 602e 0a20  tput_format>`.. 
-00052340: 2020 2020 2020 204f 7065 7261 7465 7320         Operates 
-00052350: 6f6e 2061 6c6c 2073 616d 706c 6573 2069  on all samples i
-00052360: 6e20 7468 6520 7472 6565 2073 6571 7565  n the tree seque
-00052370: 6e63 652e 0a0a 2020 2020 2020 2020 436f  nce...        Co
-00052380: 6e63 7265 7465 6c79 2c20 6966 2060 6760  ncretely, if `g`
-00052390: 2069 7320 6120 6269 6e61 7279 2076 6563   is a binary vec
-000523a0: 746f 7220 7468 6174 2069 6e64 6963 6174  tor that indicat
-000523b0: 6573 2069 6e68 6572 6974 616e 6365 2066  es inheritance f
-000523c0: 726f 6d20 616e 2061 6c6c 656c 652c 0a20  rom an allele,. 
-000523d0: 2020 2020 2020 2062 7261 6e63 682c 206f         branch, o
-000523e0: 7220 6e6f 6465 2061 6e64 2060 7760 2069  r node and `w` i
-000523f0: 7320 6120 636f 6c75 6d6e 206f 6620 572c  s a column of W,
-00052400: 206e 6f72 6d61 6c69 7365 6420 746f 2068   normalised to h
-00052410: 6176 6520 6d65 616e 207a 6572 6f2c 0a20  ave mean zero,. 
-00052420: 2020 2020 2020 2074 6865 6e20 7468 6520         then the 
-00052430: 636f 7661 7269 616e 6365 206f 6620 6067  covariance of `g
-00052440: 6020 616e 6420 6077 6020 6973 203a 6d61  ` and `w` is :ma
-00052450: 7468 3a60 5c5c 7375 6d5f 6920 675f 6920  th:`\\sum_i g_i 
-00052460: 775f 6960 2c20 7468 6520 7375 6d20 6f66  w_i`, the sum of
-00052470: 2074 6865 0a20 2020 2020 2020 2077 6569   the.        wei
-00052480: 6768 7473 2063 6f72 7265 7370 6f6e 6469  ghts correspondi
-00052490: 6e67 2074 6f20 656e 7472 6965 7320 6f66  ng to entries of
-000524a0: 2060 6760 2074 6861 7420 6172 6520 6031   `g` that are `1
-000524b0: 602e 2053 696e 6365 2077 6569 6768 7473  `. Since weights
-000524c0: 2073 756d 2074 6f0a 2020 2020 2020 2020   sum to.        
-000524d0: 7a65 726f 2c20 7468 6973 2069 7320 616c  zero, this is al
-000524e0: 736f 2065 7175 616c 2074 6f20 7468 6520  so equal to the 
-000524f0: 7375 6d20 6f66 2077 6569 6768 7473 2077  sum of weights w
-00052500: 686f 7365 2065 6e74 7269 6573 206f 6620  hose entries of 
-00052510: 6067 6020 6172 6520 302e 0a20 2020 2020  `g` are 0..     
-00052520: 2020 2053 6f2c 203a 6d61 7468 3a60 636f     So, :math:`co
-00052530: 7628 672c 7729 5e32 203d 2028 285c 5c73  v(g,w)^2 = ((\\s
-00052540: 756d 5f69 2067 5f69 2077 5f69 295e 3220  um_i g_i w_i)^2 
-00052550: 2b20 285c 5c73 756d 5f69 2028 312d 675f  + (\\sum_i (1-g_
-00052560: 6929 2077 5f69 295e 3229 2f32 602e 0a0a  i) w_i)^2)/2`...
-00052570: 2020 2020 2020 2020 5768 6174 2069 7320          What is 
-00052580: 636f 6d70 7574 6564 2064 6570 656e 6473  computed depends
-00052590: 206f 6e20 6060 6d6f 6465 6060 3a0a 0a20   on ``mode``:.. 
-000525a0: 2020 2020 2020 2022 7369 7465 220a 2020         "site".  
-000525b0: 2020 2020 2020 2020 2020 5468 6520 7375            The su
-000525c0: 6d20 6f66 2073 7175 6172 6564 2063 6f76  m of squared cov
-000525d0: 6172 6961 6e63 6573 2062 6574 7765 656e  ariances between
-000525e0: 2070 7265 7365 6e63 652f 6162 7365 6e63   presence/absenc
-000525f0: 6520 6f66 2065 6163 6820 616c 6c65 6c65  e of each allele
-00052600: 2061 6e64 0a20 2020 2020 2020 2020 2020   and.           
-00052610: 2070 6865 6e6f 7479 7065 732c 2064 6976   phenotypes, div
-00052620: 6964 6564 2062 7920 6c65 6e67 7468 206f  ided by length o
-00052630: 6620 7468 6520 7769 6e64 6f77 2028 6966  f the window (if
-00052640: 2060 6073 7061 6e5f 6e6f 726d 616c 6973   ``span_normalis
-00052650: 653d 5472 7565 6060 292e 0a20 2020 2020  e=True``)..     
-00052660: 2020 2020 2020 2054 6869 7320 6973 2063         This is c
-00052670: 6f6d 7075 7465 6420 6173 2073 756d 5f61  omputed as sum_a
-00052680: 2028 7375 6d28 775b 615d 295e 3220 2f20   (sum(w[a])^2 / 
-00052690: 3229 2c20 7768 6572 650a 2020 2020 2020  2), where.      
-000526a0: 2020 2020 2020 7720 6973 2061 2063 6f6c        w is a col
-000526b0: 756d 6e20 6f66 2057 2077 6974 6820 7468  umn of W with th
-000526c0: 6520 6176 6572 6167 6520 7375 6274 7261  e average subtra
-000526d0: 6374 6564 206f 6666 2c0a 2020 2020 2020  cted off,.      
-000526e0: 2020 2020 2020 616e 6420 775b 615d 2069        and w[a] i
-000526f0: 7320 7468 6520 7375 6d20 6f66 2061 6c6c  s the sum of all
-00052700: 2065 6e74 7269 6573 206f 6620 7720 636f   entries of w co
-00052710: 7272 6573 706f 6e64 696e 6720 746f 2073  rresponding to s
-00052720: 616d 706c 6573 0a20 2020 2020 2020 2020  amples.         
-00052730: 2020 2063 6172 7279 696e 6720 616c 6c65     carrying alle
-00052740: 6c65 2022 6122 2c20 616e 6420 7468 6520  le "a", and the 
-00052750: 6669 7273 7420 7375 6d20 6973 206f 7665  first sum is ove
-00052760: 7220 616c 6c20 616c 6c65 6c65 732e 0a0a  r all alleles...
-00052770: 2020 2020 2020 2020 2262 7261 6e63 6822          "branch"
-00052780: 0a20 2020 2020 2020 2020 2020 2054 6865  .            The
-00052790: 2073 756d 206f 6620 7371 7561 7265 6420   sum of squared 
-000527a0: 636f 7661 7269 616e 6365 7320 6265 7477  covariances betw
-000527b0: 6565 6e20 7468 6520 7370 6c69 7420 696e  een the split in
-000527c0: 6475 6365 6420 6279 2065 6163 6820 6272  duced by each br
-000527d0: 616e 6368 2061 6e64 0a20 2020 2020 2020  anch and.       
-000527e0: 2020 2020 2070 6865 6e6f 7479 7065 732c       phenotypes,
-000527f0: 206d 756c 7469 706c 6965 6420 6279 2062   multiplied by b
-00052800: 7261 6e63 6820 6c65 6e67 7468 2c20 6176  ranch length, av
-00052810: 6572 6167 6564 2061 6372 6f73 7320 7472  eraged across tr
-00052820: 6565 7320 696e 0a20 2020 2020 2020 2020  ees in.         
-00052830: 2020 2074 6865 2077 696e 646f 772e 2054     the window. T
-00052840: 6869 7320 6973 2063 6f6d 7075 7465 6420  his is computed 
-00052850: 6173 2061 626f 7665 3a20 6120 6272 616e  as above: a bran
-00052860: 6368 2077 6974 6820 746f 7461 6c20 7765  ch with total we
-00052870: 6967 6874 0a20 2020 2020 2020 2020 2020  ight.           
-00052880: 2077 5b62 5d20 6265 6c6f 7720 6220 636f   w[b] below b co
-00052890: 6e74 7269 6275 7465 7320 2862 7261 6e63  ntributes (branc
-000528a0: 6820 6c65 6e67 7468 2920 2a20 775b 625d  h length) * w[b]
-000528b0: 5e32 2074 6f20 7468 6520 746f 7461 6c0a  ^2 to the total.
-000528c0: 2020 2020 2020 2020 2020 2020 7661 6c75              valu
-000528d0: 6520 666f 7220 6120 7472 6565 2e20 2853  e for a tree. (S
-000528e0: 696e 6365 2074 6865 2073 756d 206f 6620  ince the sum of 
-000528f0: 7720 6973 207a 6572 6f2c 2074 6865 2074  w is zero, the t
-00052900: 6f74 616c 2077 6569 6768 740a 2020 2020  otal weight.    
-00052910: 2020 2020 2020 2020 6265 6c6f 7720 6220          below b 
-00052920: 616e 6420 6e6f 7420 6265 6c6f 7720 6220  and not below b 
-00052930: 6172 6520 6571 7561 6c2c 2063 616e 6365  are equal, cance
-00052940: 6c69 6e67 2074 6865 2066 6163 746f 7220  ling the factor 
-00052950: 6f66 2032 0a20 2020 2020 2020 2020 2020  of 2.           
-00052960: 2061 626f 7665 2e29 0a0a 2020 2020 2020   above.)..      
-00052970: 2020 226e 6f64 6522 0a20 2020 2020 2020    "node".       
-00052980: 2020 2020 2046 6f72 2065 6163 6820 6e6f       For each no
-00052990: 6465 2c20 7468 6520 7371 7561 7265 6420  de, the squared 
-000529a0: 636f 7661 7269 616e 6365 2062 6574 7765  covariance betwe
-000529b0: 656e 2074 6865 2070 726f 7065 7274 7920  en the property 
-000529c0: 6f66 0a20 2020 2020 2020 2020 2020 2069  of.            i
-000529d0: 6e68 6572 6974 696e 6720 6672 6f6d 2074  nheriting from t
-000529e0: 6869 7320 6e6f 6465 2061 6e64 2070 6865  his node and phe
-000529f0: 6e6f 7479 7065 732c 2063 6f6d 7075 7465  notypes, compute
-00052a00: 6420 6173 2069 6e20 2262 7261 6e63 6822  d as in "branch"
-00052a10: 2e0a 0a20 2020 2020 2020 203a 7061 7261  ...        :para
-00052a20: 6d20 6e75 6d70 792e 6e64 6172 7261 7920  m numpy.ndarray 
-00052a30: 573a 2041 6e20 6172 7261 7920 6f66 2076  W: An array of v
-00052a40: 616c 7565 7320 7769 7468 206f 6e65 2072  alues with one r
-00052a50: 6f77 2066 6f72 2065 6163 6820 7361 6d70  ow for each samp
-00052a60: 6c65 2061 6e64 206f 6e65 0a20 2020 2020  le and one.     
-00052a70: 2020 2020 2020 2063 6f6c 756d 6e20 666f         column fo
-00052a80: 7220 6561 6368 2022 7068 656e 6f74 7970  r each "phenotyp
-00052a90: 6522 2e0a 2020 2020 2020 2020 3a70 6172  e"..        :par
-00052aa0: 616d 206c 6973 7420 7769 6e64 6f77 733a  am list windows:
-00052ab0: 2041 6e20 696e 6372 6561 7369 6e67 206c   An increasing l
-00052ac0: 6973 7420 6f66 2062 7265 616b 706f 696e  ist of breakpoin
-00052ad0: 7473 2062 6574 7765 656e 2074 6865 2077  ts between the w
-00052ae0: 696e 646f 7773 0a20 2020 2020 2020 2020  indows.         
-00052af0: 2020 2074 6f20 636f 6d70 7574 6520 7468     to compute th
-00052b00: 6520 7374 6174 6973 7469 6320 696e 2e0a  e statistic in..
-00052b10: 2020 2020 2020 2020 3a70 6172 616d 2073          :param s
-00052b20: 7472 206d 6f64 653a 2041 2073 7472 696e  tr mode: A strin
-00052b30: 6720 6769 7669 6e67 2074 6865 2022 7479  g giving the "ty
-00052b40: 7065 2220 6f66 2074 6865 2073 7461 7469  pe" of the stati
-00052b50: 7374 6963 2074 6f20 6265 2063 6f6d 7075  stic to be compu
-00052b60: 7465 640a 2020 2020 2020 2020 2020 2020  ted.            
-00052b70: 2864 6566 6175 6c74 7320 746f 2022 7369  (defaults to "si
-00052b80: 7465 2229 2e0a 2020 2020 2020 2020 3a70  te")..        :p
-00052b90: 6172 616d 2062 6f6f 6c20 7370 616e 5f6e  aram bool span_n
-00052ba0: 6f72 6d61 6c69 7365 3a20 5768 6574 6865  ormalise: Whethe
-00052bb0: 7220 746f 2064 6976 6964 6520 7468 6520  r to divide the 
-00052bc0: 7265 7375 6c74 2062 7920 7468 6520 7370  result by the sp
-00052bd0: 616e 206f 6620 7468 650a 2020 2020 2020  an of the.      
-00052be0: 2020 2020 2020 7769 6e64 6f77 2028 6465        window (de
-00052bf0: 6661 756c 7473 2074 6f20 5472 7565 292e  faults to True).
-00052c00: 0a20 2020 2020 2020 203a 7265 7475 726e  .        :return
-00052c10: 3a20 4120 6e64 6172 7261 7920 7769 7468  : A ndarray with
-00052c20: 2073 6861 7065 2065 7175 616c 2074 6f20   shape equal to 
-00052c30: 286e 756d 2077 696e 646f 7773 2c20 6e75  (num windows, nu
-00052c40: 6d20 7374 6174 6973 7469 6373 292e 0a20  m statistics).. 
-00052c50: 2020 2020 2020 2020 2020 2049 6620 7769             If wi
-00052c60: 6e64 6f77 733d 4e6f 6e65 2061 6e64 2057  ndows=None and W
-00052c70: 2069 7320 6120 7369 6e67 6c65 2063 6f6c   is a single col
-00052c80: 756d 6e2c 2061 206e 756d 7079 2073 6361  umn, a numpy sca
-00052c90: 6c61 7220 6973 2072 6574 7572 6e65 642e  lar is returned.
-00052ca0: 0a20 2020 2020 2020 2022 2222 0a20 2020  .        """.   
-00052cb0: 2020 2020 2069 6620 572e 7368 6170 655b       if W.shape[
-00052cc0: 305d 2021 3d20 7365 6c66 2e6e 756d 5f73  0] != self.num_s
-00052cd0: 616d 706c 6573 3a0a 2020 2020 2020 2020  amples:.        
-00052ce0: 2020 2020 7261 6973 6520 5661 6c75 6545      raise ValueE
-00052cf0: 7272 6f72 280a 2020 2020 2020 2020 2020  rror(.          
-00052d00: 2020 2020 2020 2246 6972 7374 2074 7261        "First tra
-00052d10: 6974 2064 696d 656e 7369 6f6e 206d 7573  it dimension mus
-00052d20: 7420 6265 2065 7175 616c 2074 6f20 6e75  t be equal to nu
-00052d30: 6d62 6572 206f 6620 7361 6d70 6c65 732e  mber of samples.
-00052d40: 220a 2020 2020 2020 2020 2020 2020 290a  ".            ).
-00052d50: 2020 2020 2020 2020 7265 7475 726e 2073          return s
-00052d60: 656c 662e 5f5f 7275 6e5f 7769 6e64 6f77  elf.__run_window
-00052d70: 6564 5f73 7461 7428 0a20 2020 2020 2020  ed_stat(.       
-00052d80: 2020 2020 2077 696e 646f 7773 2c0a 2020       windows,.  
-00052d90: 2020 2020 2020 2020 2020 7365 6c66 2e5f            self._
-00052da0: 6c6c 5f74 7265 655f 7365 7175 656e 6365  ll_tree_sequence
-00052db0: 2e74 7261 6974 5f63 6f76 6172 6961 6e63  .trait_covarianc
-00052dc0: 652c 0a20 2020 2020 2020 2020 2020 2057  e,.            W
-00052dd0: 2c0a 2020 2020 2020 2020 2020 2020 6d6f  ,.            mo
-00052de0: 6465 3d6d 6f64 652c 0a20 2020 2020 2020  de=mode,.       
-00052df0: 2020 2020 2073 7061 6e5f 6e6f 726d 616c       span_normal
-00052e00: 6973 653d 7370 616e 5f6e 6f72 6d61 6c69  ise=span_normali
-00052e10: 7365 2c0a 2020 2020 2020 2020 290a 0a20  se,.        ).. 
-00052e20: 2020 2064 6566 2074 7261 6974 5f63 6f72     def trait_cor
-00052e30: 7265 6c61 7469 6f6e 2873 656c 662c 2057  relation(self, W
-00052e40: 2c20 7769 6e64 6f77 733d 4e6f 6e65 2c20  , windows=None, 
-00052e50: 6d6f 6465 3d22 7369 7465 222c 2073 7061  mode="site", spa
-00052e60: 6e5f 6e6f 726d 616c 6973 653d 5472 7565  n_normalise=True
-00052e70: 293a 0a20 2020 2020 2020 2022 2222 0a20  ):.        """. 
-00052e80: 2020 2020 2020 2043 6f6d 7075 7465 7320         Computes 
-00052e90: 7468 6520 6d65 616e 2073 7175 6172 6564  the mean squared
-00052ea0: 2063 6f72 7265 6c61 7469 6f6e 7320 6265   correlations be
-00052eb0: 7477 6565 6e20 6561 6368 206f 6620 7468  tween each of th
-00052ec0: 6520 636f 6c75 6d6e 7320 6f66 2060 6057  e columns of ``W
-00052ed0: 6060 0a20 2020 2020 2020 2028 7468 6520  ``.        (the 
-00052ee0: 2270 6865 6e6f 7479 7065 7322 2920 616e  "phenotypes") an
-00052ef0: 6420 696e 6865 7269 7461 6e63 6520 616c  d inheritance al
-00052f00: 6f6e 6720 7468 6520 7472 6565 2073 6571  ong the tree seq
-00052f10: 7565 6e63 652e 0a20 2020 2020 2020 2053  uence..        S
-00052f20: 6565 2074 6865 203a 7265 663a 6073 7461  ee the :ref:`sta
-00052f30: 7469 7374 6963 7320 696e 7465 7266 6163  tistics interfac
-00052f40: 6520 3c73 6563 5f73 7461 7473 5f69 6e74  e <sec_stats_int
-00052f50: 6572 6661 6365 3e60 2073 6563 7469 6f6e  erface>` section
-00052f60: 2066 6f72 2064 6574 6169 6c73 206f 6e0a   for details on.
-00052f70: 2020 2020 2020 2020 3a72 6566 3a60 7769          :ref:`wi
-00052f80: 6e64 6f77 7320 3c73 6563 5f73 7461 7473  ndows <sec_stats
-00052f90: 5f77 696e 646f 7773 3e60 2c0a 2020 2020  _windows>`,.    
-00052fa0: 2020 2020 3a72 6566 3a60 6d6f 6465 203c      :ref:`mode <
-00052fb0: 7365 635f 7374 6174 735f 6d6f 6465 3e60  sec_stats_mode>`
-00052fc0: 2c0a 2020 2020 2020 2020 3a72 6566 3a60  ,.        :ref:`
-00052fd0: 7370 616e 206e 6f72 6d61 6c69 7365 203c  span normalise <
-00052fe0: 7365 635f 7374 6174 735f 7370 616e 5f6e  sec_stats_span_n
-00052ff0: 6f72 6d61 6c69 7365 3e60 2c0a 2020 2020  ormalise>`,.    
-00053000: 2020 2020 616e 6420 3a72 6566 3a60 7265      and :ref:`re
-00053010: 7475 726e 2076 616c 7565 203c 7365 635f  turn value <sec_
-00053020: 7374 6174 735f 6f75 7470 7574 5f66 6f72  stats_output_for
-00053030: 6d61 743e 602e 0a20 2020 2020 2020 204f  mat>`..        O
-00053040: 7065 7261 7465 7320 6f6e 2061 6c6c 2073  perates on all s
-00053050: 616d 706c 6573 2069 6e20 7468 6520 7472  amples in the tr
-00053060: 6565 2073 6571 7565 6e63 652e 0a0a 2020  ee sequence...  
-00053070: 2020 2020 2020 5468 6973 2069 7320 636f        This is co
-00053080: 6d70 7574 6564 2061 7320 7371 7561 7265  mputed as square
-00053090: 6420 636f 7661 7269 616e 6365 2069 6e0a  d covariance in.
-000530a0: 2020 2020 2020 2020 3a6d 6574 683a 6074          :meth:`t
-000530b0: 7261 6974 5f63 6f76 6172 6961 6e63 6520  rait_covariance 
-000530c0: 3c2e 5472 6565 5365 7175 656e 6365 2e74  <.TreeSequence.t
-000530d0: 7261 6974 5f63 6f76 6172 6961 6e63 653e  rait_covariance>
-000530e0: 602c 0a20 2020 2020 2020 2062 7574 2064  `,.        but d
-000530f0: 6976 6964 6564 2062 7920 3a6d 6174 683a  ivided by :math:
-00053100: 6070 2028 312d 7029 602c 2077 6865 7265  `p (1-p)`, where
-00053110: 2060 7060 2069 7320 7468 6520 7072 6f70   `p` is the prop
-00053120: 6f72 7469 6f6e 206f 6620 7361 6d70 6c65  ortion of sample
-00053130: 730a 2020 2020 2020 2020 696e 6865 7269  s.        inheri
-00053140: 7469 6e67 2066 726f 6d20 7468 6520 616c  ting from the al
-00053150: 6c65 6c65 2c20 6272 616e 6368 2c20 6f72  lele, branch, or
-00053160: 206e 6f64 6520 696e 2071 7565 7374 696f   node in questio
-00053170: 6e2e 0a0a 2020 2020 2020 2020 5768 6174  n...        What
-00053180: 2069 7320 636f 6d70 7574 6564 2064 6570   is computed dep
-00053190: 656e 6473 206f 6e20 6060 6d6f 6465 6060  ends on ``mode``
-000531a0: 3a0a 0a20 2020 2020 2020 2022 7369 7465  :..        "site
-000531b0: 220a 2020 2020 2020 2020 2020 2020 5468  ".            Th
-000531c0: 6520 7375 6d20 6f66 2073 7175 6172 6564  e sum of squared
-000531d0: 2063 6f72 7265 6c61 7469 6f6e 7320 6265   correlations be
-000531e0: 7477 6565 6e20 7072 6573 656e 6365 2f61  tween presence/a
-000531f0: 6273 656e 6365 206f 6620 6561 6368 2061  bsence of each a
-00053200: 6c6c 656c 6520 616e 640a 2020 2020 2020  llele and.      
-00053210: 2020 2020 2020 7068 656e 6f74 7970 6573        phenotypes
-00053220: 2c20 6469 7669 6465 6420 6279 206c 656e  , divided by len
-00053230: 6774 6820 6f66 2074 6865 2077 696e 646f  gth of the windo
-00053240: 7720 2869 6620 6060 7370 616e 5f6e 6f72  w (if ``span_nor
-00053250: 6d61 6c69 7365 3d54 7275 6560 6029 2e0a  malise=True``)..
-00053260: 2020 2020 2020 2020 2020 2020 5468 6973              This
-00053270: 2069 7320 636f 6d70 7574 6564 2061 7320   is computed as 
-00053280: 7468 650a 2020 2020 2020 2020 2020 2020  the.            
-00053290: 3a6d 6574 683a 6074 7261 6974 5f63 6f76  :meth:`trait_cov
-000532a0: 6172 6961 6e63 6520 3c2e 5472 6565 5365  ariance <.TreeSe
-000532b0: 7175 656e 6365 2e74 7261 6974 5f63 6f76  quence.trait_cov
-000532c0: 6172 6961 6e63 653e 600a 2020 2020 2020  ariance>`.      
-000532d0: 2020 2020 2020 6469 7669 6465 6420 6279        divided by
-000532e0: 2074 6865 2076 6172 6961 6e63 6520 6f66   the variance of
-000532f0: 2074 6865 2072 656c 6576 616e 7420 636f   the relevant co
-00053300: 6c75 6d6e 206f 6620 570a 2020 2020 2020  lumn of W.      
-00053310: 2020 2020 2020 616e 6420 6279 203a 6d61        and by :ma
-00053320: 7468 3a60 7020 2a20 2831 202d 2070 2960  th:`p * (1 - p)`
-00053330: 2c20 7768 6572 6520 3a6d 6174 683a 6070  , where :math:`p
-00053340: 6020 6973 2074 6865 2061 6c6c 656c 6520  ` is the allele 
-00053350: 6672 6571 7565 6e63 792e 0a0a 2020 2020  frequency...    
-00053360: 2020 2020 2262 7261 6e63 6822 0a20 2020      "branch".   
-00053370: 2020 2020 2020 2020 2054 6865 2073 756d           The sum
-00053380: 206f 6620 7371 7561 7265 6420 636f 7272   of squared corr
-00053390: 656c 6174 696f 6e73 2062 6574 7765 656e  elations between
-000533a0: 2074 6865 2073 706c 6974 2069 6e64 7563   the split induc
-000533b0: 6564 2062 7920 6561 6368 2062 7261 6e63  ed by each branc
-000533c0: 6820 616e 640a 2020 2020 2020 2020 2020  h and.          
-000533d0: 2020 7068 656e 6f74 7970 6573 2c20 6d75    phenotypes, mu
-000533e0: 6c74 6970 6c69 6564 2062 7920 6272 616e  ltiplied by bran
-000533f0: 6368 206c 656e 6774 682c 2061 7665 7261  ch length, avera
-00053400: 6765 6420 6163 726f 7373 2074 7265 6573  ged across trees
-00053410: 2069 6e0a 2020 2020 2020 2020 2020 2020   in.            
-00053420: 7468 6520 7769 6e64 6f77 2e20 5468 6973  the window. This
-00053430: 2069 7320 636f 6d70 7574 6564 2061 7320   is computed as 
-00053440: 7468 650a 2020 2020 2020 2020 2020 2020  the.            
-00053450: 3a6d 6574 683a 6074 7261 6974 5f63 6f76  :meth:`trait_cov
-00053460: 6172 6961 6e63 6520 3c2e 5472 6565 5365  ariance <.TreeSe
-00053470: 7175 656e 6365 2e74 7261 6974 5f63 6f76  quence.trait_cov
-00053480: 6172 6961 6e63 653e 602c 0a20 2020 2020  ariance>`,.     
-00053490: 2020 2020 2020 2064 6976 6964 6564 2062         divided b
-000534a0: 7920 7468 6520 7661 7269 616e 6365 206f  y the variance o
-000534b0: 6620 7468 6520 636f 6c75 6d6e 206f 6620  f the column of 
-000534c0: 770a 2020 2020 2020 2020 2020 2020 616e  w.            an
-000534d0: 6420 6279 203a 6d61 7468 3a60 7020 2a20  d by :math:`p * 
-000534e0: 2831 202d 2070 2960 2c20 7768 6572 6520  (1 - p)`, where 
-000534f0: 3a6d 6174 683a 6070 6020 6973 2074 6865  :math:`p` is the
-00053500: 2070 726f 706f 7274 696f 6e20 6f66 0a20   proportion of. 
-00053510: 2020 2020 2020 2020 2020 2074 6865 2073             the s
-00053520: 616d 706c 6573 206c 7969 6e67 2062 656c  amples lying bel
-00053530: 6f77 2074 6865 2062 7261 6e63 682e 0a0a  ow the branch...
-00053540: 2020 2020 2020 2020 226e 6f64 6522 0a20          "node". 
-00053550: 2020 2020 2020 2020 2020 2046 6f72 2065             For e
-00053560: 6163 6820 6e6f 6465 2c20 7468 6520 7371  ach node, the sq
-00053570: 7561 7265 6420 636f 7272 656c 6174 696f  uared correlatio
-00053580: 6e20 6265 7477 6565 6e20 7468 6520 7072  n between the pr
-00053590: 6f70 6572 7479 206f 660a 2020 2020 2020  operty of.      
-000535a0: 2020 2020 2020 696e 6865 7269 7469 6e67        inheriting
-000535b0: 2066 726f 6d20 7468 6973 206e 6f64 6520   from this node 
-000535c0: 616e 6420 7068 656e 6f74 7970 6573 2c20  and phenotypes, 
-000535d0: 636f 6d70 7574 6564 2061 7320 696e 2022  computed as in "
-000535e0: 6272 616e 6368 222e 0a0a 2020 2020 2020  branch"...      
-000535f0: 2020 4e6f 7465 2074 6861 7420 6162 6f76    Note that abov
-00053600: 6520 7765 2064 6976 6964 6520 6279 2074  e we divide by t
-00053610: 6865 202a 2a73 616d 706c 652a 2a20 7661  he **sample** va
-00053620: 7269 616e 6365 2c20 7768 6963 6820 666f  riance, which fo
-00053630: 7220 610a 2020 2020 2020 2020 7665 6374  r a.        vect
-00053640: 6f72 2078 206f 6620 6c65 6e67 7468 206e  or x of length n
-00053650: 2069 7320 6060 6e70 2e76 6172 2878 2920   is ``np.var(x) 
-00053660: 2a20 6e20 2f20 286e 2d31 2960 602e 0a0a  * n / (n-1)``...
-00053670: 2020 2020 2020 2020 3a70 6172 616d 206e          :param n
-00053680: 756d 7079 2e6e 6461 7272 6179 2057 3a20  umpy.ndarray W: 
-00053690: 416e 2061 7272 6179 206f 6620 7661 6c75  An array of valu
-000536a0: 6573 2077 6974 6820 6f6e 6520 726f 7720  es with one row 
-000536b0: 666f 7220 6561 6368 2073 616d 706c 6520  for each sample 
-000536c0: 616e 6420 6f6e 650a 2020 2020 2020 2020  and one.        
-000536d0: 2020 2020 636f 6c75 6d6e 2066 6f72 2065      column for e
-000536e0: 6163 6820 2270 6865 6e6f 7479 7065 222e  ach "phenotype".
-000536f0: 2045 6163 6820 636f 6c75 6d6e 206d 7573   Each column mus
-00053700: 7420 6861 7665 2070 6f73 6974 6976 6520  t have positive 
-00053710: 7374 616e 6461 7264 0a20 2020 2020 2020  standard.       
-00053720: 2020 2020 2064 6576 6961 7469 6f6e 2e0a       deviation..
-00053730: 2020 2020 2020 2020 3a70 6172 616d 206c          :param l
-00053740: 6973 7420 7769 6e64 6f77 733a 2041 6e20  ist windows: An 
-00053750: 696e 6372 6561 7369 6e67 206c 6973 7420  increasing list 
-00053760: 6f66 2062 7265 616b 706f 696e 7473 2062  of breakpoints b
-00053770: 6574 7765 656e 2074 6865 2077 696e 646f  etween the windo
-00053780: 7773 0a20 2020 2020 2020 2020 2020 2074  ws.            t
-00053790: 6f20 636f 6d70 7574 6520 7468 6520 7374  o compute the st
-000537a0: 6174 6973 7469 6320 696e 2e0a 2020 2020  atistic in..    
-000537b0: 2020 2020 3a70 6172 616d 2073 7472 206d      :param str m
-000537c0: 6f64 653a 2041 2073 7472 696e 6720 6769  ode: A string gi
-000537d0: 7669 6e67 2074 6865 2022 7479 7065 2220  ving the "type" 
-000537e0: 6f66 2074 6865 2073 7461 7469 7374 6963  of the statistic
-000537f0: 2074 6f20 6265 2063 6f6d 7075 7465 640a   to be computed.
-00053800: 2020 2020 2020 2020 2020 2020 2864 6566              (def
-00053810: 6175 6c74 7320 746f 2022 7369 7465 2229  aults to "site")
-00053820: 2e0a 2020 2020 2020 2020 3a70 6172 616d  ..        :param
-00053830: 2062 6f6f 6c20 7370 616e 5f6e 6f72 6d61   bool span_norma
-00053840: 6c69 7365 3a20 5768 6574 6865 7220 746f  lise: Whether to
-00053850: 2064 6976 6964 6520 7468 6520 7265 7375   divide the resu
-00053860: 6c74 2062 7920 7468 6520 7370 616e 206f  lt by the span o
-00053870: 6620 7468 650a 2020 2020 2020 2020 2020  f the.          
-00053880: 2020 7769 6e64 6f77 2028 6465 6661 756c    window (defaul
-00053890: 7473 2074 6f20 5472 7565 292e 0a20 2020  ts to True)..   
-000538a0: 2020 2020 203a 7265 7475 726e 3a20 4120       :return: A 
-000538b0: 6e64 6172 7261 7920 7769 7468 2073 6861  ndarray with sha
-000538c0: 7065 2065 7175 616c 2074 6f20 286e 756d  pe equal to (num
-000538d0: 2077 696e 646f 7773 2c20 6e75 6d20 7374   windows, num st
-000538e0: 6174 6973 7469 6373 292e 0a20 2020 2020  atistics)..     
-000538f0: 2020 2020 2020 2049 6620 7769 6e64 6f77         If window
-00053900: 733d 4e6f 6e65 2061 6e64 2057 2069 7320  s=None and W is 
-00053910: 6120 7369 6e67 6c65 2063 6f6c 756d 6e2c  a single column,
-00053920: 2061 206e 756d 7079 2073 6361 6c61 7220   a numpy scalar 
-00053930: 6973 2072 6574 7572 6e65 642e 0a20 2020  is returned..   
-00053940: 2020 2020 2022 2222 0a20 2020 2020 2020       """.       
-00053950: 2069 6620 572e 7368 6170 655b 305d 2021   if W.shape[0] !
-00053960: 3d20 7365 6c66 2e6e 756d 5f73 616d 706c  = self.num_sampl
-00053970: 6573 3a0a 2020 2020 2020 2020 2020 2020  es:.            
-00053980: 7261 6973 6520 5661 6c75 6545 7272 6f72  raise ValueError
-00053990: 280a 2020 2020 2020 2020 2020 2020 2020  (.              
-000539a0: 2020 2246 6972 7374 2074 7261 6974 2064    "First trait d
-000539b0: 696d 656e 7369 6f6e 206d 7573 7420 6265  imension must be
-000539c0: 2065 7175 616c 2074 6f20 6e75 6d62 6572   equal to number
-000539d0: 206f 6620 7361 6d70 6c65 732e 220a 2020   of samples.".  
-000539e0: 2020 2020 2020 2020 2020 290a 2020 2020            ).    
-000539f0: 2020 2020 7364 7320 3d20 6e70 2e73 7464      sds = np.std
-00053a00: 2857 2c20 6178 6973 3d30 290a 2020 2020  (W, axis=0).    
-00053a10: 2020 2020 6966 206e 702e 616e 7928 7364      if np.any(sd
-00053a20: 7320 3d3d 2030 293a 0a20 2020 2020 2020  s == 0):.       
-00053a30: 2020 2020 2072 6169 7365 2056 616c 7565       raise Value
-00053a40: 4572 726f 7228 0a20 2020 2020 2020 2020  Error(.         
-00053a50: 2020 2020 2020 2022 5765 6967 6874 2063         "Weight c
-00053a60: 6f6c 756d 6e73 206d 7573 7420 6861 7665  olumns must have
-00053a70: 2070 6f73 6974 6976 6520 7661 7269 616e   positive varian
-00053a80: 6365 222c 2022 746f 2063 6f6d 7075 7465  ce", "to compute
-00053a90: 2063 6f72 7265 6c61 7469 6f6e 2e22 0a20   correlation.". 
-00053aa0: 2020 2020 2020 2020 2020 2029 0a20 2020             ).   
-00053ab0: 2020 2020 2072 6574 7572 6e20 7365 6c66       return self
-00053ac0: 2e5f 5f72 756e 5f77 696e 646f 7765 645f  .__run_windowed_
-00053ad0: 7374 6174 280a 2020 2020 2020 2020 2020  stat(.          
-00053ae0: 2020 7769 6e64 6f77 732c 0a20 2020 2020    windows,.     
-00053af0: 2020 2020 2020 2073 656c 662e 5f6c 6c5f         self._ll_
-00053b00: 7472 6565 5f73 6571 7565 6e63 652e 7472  tree_sequence.tr
-00053b10: 6169 745f 636f 7272 656c 6174 696f 6e2c  ait_correlation,
-00053b20: 0a20 2020 2020 2020 2020 2020 2057 2c0a  .            W,.
-00053b30: 2020 2020 2020 2020 2020 2020 6d6f 6465              mode
-00053b40: 3d6d 6f64 652c 0a20 2020 2020 2020 2020  =mode,.         
-00053b50: 2020 2073 7061 6e5f 6e6f 726d 616c 6973     span_normalis
-00053b60: 653d 7370 616e 5f6e 6f72 6d61 6c69 7365  e=span_normalise
-00053b70: 2c0a 2020 2020 2020 2020 290a 0a20 2020  ,.        )..   
-00053b80: 2064 6566 2074 7261 6974 5f72 6567 7265   def trait_regre
-00053b90: 7373 696f 6e28 7365 6c66 2c20 2a61 7267  ssion(self, *arg
-00053ba0: 732c 202a 2a6b 7761 7267 7329 3a0a 2020  s, **kwargs):.  
-00053bb0: 2020 2020 2020 2222 220a 2020 2020 2020        """.      
-00053bc0: 2020 4465 7072 6563 6174 6564 2073 796e    Deprecated syn
-00053bd0: 6f6e 796d 2066 6f72 0a20 2020 2020 2020  onym for.       
-00053be0: 203a 6d65 7468 3a60 7472 6169 745f 6c69   :meth:`trait_li
-00053bf0: 6e65 6172 5f6d 6f64 656c 203c 2e54 7265  near_model <.Tre
-00053c00: 6553 6571 7565 6e63 652e 7472 6169 745f  eSequence.trait_
-00053c10: 6c69 6e65 6172 5f6d 6f64 656c 3e60 2e0a  linear_model>`..
-00053c20: 2020 2020 2020 2020 2222 220a 2020 2020          """.    
-00053c30: 2020 2020 7761 726e 696e 6773 2e77 6172      warnings.war
-00053c40: 6e28 0a20 2020 2020 2020 2020 2020 2022  n(.            "
-00053c50: 5468 6973 2069 7320 6465 7072 6563 6174  This is deprecat
-00053c60: 6564 3a20 706c 6561 7365 2075 7365 2074  ed: please use t
-00053c70: 7261 6974 5f6c 696e 6561 725f 6d6f 6465  rait_linear_mode
-00053c80: 6c28 2029 2069 6e73 7465 6164 2e22 2c0a  l( ) instead.",.
-00053c90: 2020 2020 2020 2020 2020 2020 4675 7475              Futu
-00053ca0: 7265 5761 726e 696e 672c 0a20 2020 2020  reWarning,.     
-00053cb0: 2020 2029 0a20 2020 2020 2020 2072 6574     ).        ret
-00053cc0: 7572 6e20 7365 6c66 2e74 7261 6974 5f6c  urn self.trait_l
-00053cd0: 696e 6561 725f 6d6f 6465 6c28 2a61 7267  inear_model(*arg
-00053ce0: 732c 202a 2a6b 7761 7267 7329 0a0a 2020  s, **kwargs)..  
-00053cf0: 2020 6465 6620 7472 6169 745f 6c69 6e65    def trait_line
-00053d00: 6172 5f6d 6f64 656c 280a 2020 2020 2020  ar_model(.      
-00053d10: 2020 7365 6c66 2c20 572c 205a 3d4e 6f6e    self, W, Z=Non
-00053d20: 652c 2077 696e 646f 7773 3d4e 6f6e 652c  e, windows=None,
-00053d30: 206d 6f64 653d 2273 6974 6522 2c20 7370   mode="site", sp
-00053d40: 616e 5f6e 6f72 6d61 6c69 7365 3d54 7275  an_normalise=Tru
-00053d50: 650a 2020 2020 293a 0a20 2020 2020 2020  e.    ):.       
-00053d60: 2022 2222 0a20 2020 2020 2020 2046 696e   """.        Fin
-00053d70: 6473 2074 6865 2072 656c 6174 696f 6e73  ds the relations
-00053d80: 6869 7020 6265 7477 6565 6e20 7472 6169  hip between trai
-00053d90: 7420 616e 6420 6765 6e6f 7479 7065 2061  t and genotype a
-00053da0: 6674 6572 2061 6363 6f75 6e74 696e 6720  fter accounting 
-00053db0: 666f 720a 2020 2020 2020 2020 636f 7661  for.        cova
-00053dc0: 7269 6174 6573 2e20 2043 6f6e 6372 6574  riates.  Concret
-00053dd0: 656c 792c 2066 6f72 2065 6163 6820 7472  ely, for each tr
-00053de0: 6169 7420 7720 2869 2e65 2e2c 2065 6163  ait w (i.e., eac
-00053df0: 6820 636f 6c75 6d6e 206f 6620 5729 2c0a  h column of W),.
-00053e00: 2020 2020 2020 2020 7468 6973 2064 6f65          this doe
-00053e10: 7320 6120 6c65 6173 742d 7371 7561 7265  s a least-square
-00053e20: 7320 6669 7420 6f66 2074 6865 206c 696e  s fit of the lin
-00053e30: 6561 7220 6d6f 6465 6c20 3a6d 6174 683a  ear model :math:
-00053e40: 6077 205c 5c73 696d 2067 202b 205a 602c  `w \\sim g + Z`,
-00053e50: 0a20 2020 2020 2020 2077 6865 7265 203a  .        where :
-00053e60: 6d61 7468 3a60 6760 2069 7320 696e 6865  math:`g` is inhe
-00053e70: 7269 7461 6e63 6520 696e 2074 6865 2074  ritance in the t
-00053e80: 7265 6520 7365 7175 656e 6365 2028 652e  ree sequence (e.
-00053e90: 672e 2c20 6765 6e6f 7479 7065 290a 2020  g., genotype).  
-00053ea0: 2020 2020 2020 616e 6420 7468 6520 636f        and the co
-00053eb0: 6c75 6d6e 7320 6f66 203a 6d61 7468 3a60  lumns of :math:`
-00053ec0: 5a60 2061 7265 2063 6f76 6172 6961 7465  Z` are covariate
-00053ed0: 732c 2061 6e64 2072 6574 7572 6e73 2074  s, and returns t
-00053ee0: 6865 2073 7175 6172 6564 0a20 2020 2020  he squared.     
-00053ef0: 2020 2063 6f65 6666 6963 6965 6e74 206f     coefficient o
-00053f00: 6620 3a6d 6174 683a 6067 6020 696e 2074  f :math:`g` in t
-00053f10: 6869 7320 6c69 6e65 6172 206d 6f64 656c  his linear model
-00053f20: 2e0a 2020 2020 2020 2020 5365 6520 7468  ..        See th
-00053f30: 6520 3a72 6566 3a60 7374 6174 6973 7469  e :ref:`statisti
-00053f40: 6373 2069 6e74 6572 6661 6365 203c 7365  cs interface <se
-00053f50: 635f 7374 6174 735f 696e 7465 7266 6163  c_stats_interfac
-00053f60: 653e 6020 7365 6374 696f 6e20 666f 7220  e>` section for 
-00053f70: 6465 7461 696c 7320 6f6e 0a20 2020 2020  details on.     
-00053f80: 2020 203a 7265 663a 6077 696e 646f 7773     :ref:`windows
-00053f90: 203c 7365 635f 7374 6174 735f 7769 6e64   <sec_stats_wind
-00053fa0: 6f77 733e 602c 0a20 2020 2020 2020 203a  ows>`,.        :
-00053fb0: 7265 663a 606d 6f64 6520 3c73 6563 5f73  ref:`mode <sec_s
-00053fc0: 7461 7473 5f6d 6f64 653e 602c 0a20 2020  tats_mode>`,.   
-00053fd0: 2020 2020 203a 7265 663a 6073 7061 6e20       :ref:`span 
-00053fe0: 6e6f 726d 616c 6973 6520 3c73 6563 5f73  normalise <sec_s
-00053ff0: 7461 7473 5f73 7061 6e5f 6e6f 726d 616c  tats_span_normal
-00054000: 6973 653e 602c 0a20 2020 2020 2020 2061  ise>`,.        a
-00054010: 6e64 203a 7265 663a 6072 6574 7572 6e20  nd :ref:`return 
-00054020: 7661 6c75 6520 3c73 6563 5f73 7461 7473  value <sec_stats
-00054030: 5f6f 7574 7075 745f 666f 726d 6174 3e60  _output_format>`
-00054040: 2e0a 2020 2020 2020 2020 4f70 6572 6174  ..        Operat
-00054050: 6573 206f 6e20 616c 6c20 7361 6d70 6c65  es on all sample
-00054060: 7320 696e 2074 6865 2074 7265 6520 7365  s in the tree se
-00054070: 7175 656e 6365 2e0a 0a20 2020 2020 2020  quence...       
-00054080: 2054 6f20 646f 2074 6869 732c 2069 6620   To do this, if 
-00054090: 6067 6020 6973 2061 2062 696e 6172 7920  `g` is a binary 
-000540a0: 7665 6374 6f72 2074 6861 7420 696e 6469  vector that indi
-000540b0: 6361 7465 7320 696e 6865 7269 7461 6e63  cates inheritanc
-000540c0: 6520 6672 6f6d 2061 6e20 616c 6c65 6c65  e from an allele
-000540d0: 2c0a 2020 2020 2020 2020 6272 616e 6368  ,.        branch
-000540e0: 2c20 6f72 206e 6f64 6520 616e 6420 6077  , or node and `w
-000540f0: 6020 6973 2061 2063 6f6c 756d 6e20 6f66  ` is a column of
-00054100: 2057 2c20 7468 6572 6520 6172 6520 3a6d   W, there are :m
-00054110: 6174 683a 606b 6020 636f 6c75 6d6e 7320  ath:`k` columns 
-00054120: 6f66 0a20 2020 2020 2020 203a 6d61 7468  of.        :math
-00054130: 3a60 5a60 2c20 616e 6420 7468 6520 3a6d  :`Z`, and the :m
-00054140: 6174 683a 606b 2b32 602d 7665 6374 6f72  ath:`k+2`-vector
-00054150: 203a 6d61 7468 3a60 6260 206d 696e 696d   :math:`b` minim
-00054160: 6973 6573 0a20 2020 2020 2020 203a 6d61  ises.        :ma
-00054170: 7468 3a60 5c5c 7375 6d5f 6920 2877 5f69  th:`\\sum_i (w_i
-00054180: 202d 2062 5f30 202d 2062 5f31 2067 5f69   - b_0 - b_1 g_i
-00054190: 202d 2062 5f32 207a 5f7b 322c 697d 202d   - b_2 z_{2,i} -
-000541a0: 202e 2e2e 2062 5f7b 6b2b 327d 207a 5f7b   ... b_{k+2} z_{
-000541b0: 6b2b 322c 697d 295e 3260 0a20 2020 2020  k+2,i})^2`.     
-000541c0: 2020 2074 6865 6e20 7468 6973 2072 6574     then this ret
-000541d0: 7572 6e73 2074 6865 206e 756d 6265 7220  urns the number 
-000541e0: 3a6d 6174 683a 6062 5f31 5e32 602e 2049  :math:`b_1^2`. I
-000541f0: 6620 3a6d 6174 683a 6067 6020 6c69 6573  f :math:`g` lies
-00054200: 2069 6e20 7468 6520 6c69 6e65 6172 2073   in the linear s
-00054210: 7061 6e0a 2020 2020 2020 2020 6f66 2074  pan.        of t
-00054220: 6865 2063 6f6c 756d 6e73 206f 6620 3a6d  he columns of :m
-00054230: 6174 683a 605a 602c 2074 6865 6e20 3a6d  ath:`Z`, then :m
-00054240: 6174 683a 6062 5f31 6020 6973 2073 6574  ath:`b_1` is set
-00054250: 2074 6f20 302e 2054 6f20 6669 7420 7468   to 0. To fit th
-00054260: 650a 2020 2020 2020 2020 6c69 6e65 6172  e.        linear
-00054270: 206d 6f64 656c 2077 6974 686f 7574 2063   model without c
-00054280: 6f76 6172 6961 7465 7320 286f 6e6c 7920  ovariates (only 
-00054290: 7468 6520 696e 7465 7263 6570 7429 2c20  the intercept), 
-000542a0: 7365 7420 605a 203d 204e 6f6e 6560 2e0a  set `Z = None`..
-000542b0: 0a20 2020 2020 2020 2057 6861 7420 6973  .        What is
-000542c0: 2063 6f6d 7075 7465 6420 6465 7065 6e64   computed depend
-000542d0: 7320 6f6e 2060 606d 6f64 6560 603a 0a0a  s on ``mode``:..
-000542e0: 2020 2020 2020 2020 2273 6974 6522 0a20          "site". 
-000542f0: 2020 2020 2020 2020 2020 2043 6f6d 7075             Compu
-00054300: 7465 7320 7468 6520 7375 6d20 6f66 203a  tes the sum of :
-00054310: 6d61 7468 3a60 625f 315e 322f 3260 2066  math:`b_1^2/2` f
-00054320: 6f72 2065 6163 6820 616c 6c65 6c65 2069  or each allele i
-00054330: 6e20 7468 6520 7769 6e64 6f77 2c0a 2020  n the window,.  
-00054340: 2020 2020 2020 2020 2020 6173 2061 626f            as abo
-00054350: 7665 2077 6974 6820 3a6d 6174 683a 6067  ve with :math:`g
-00054360: 6020 696e 6469 6361 7469 6e67 2070 7265  ` indicating pre
-00054370: 7365 6e63 652f 6162 7365 6e63 6520 6f66  sence/absence of
-00054380: 2074 6865 2061 6c6c 656c 652c 0a20 2020   the allele,.   
-00054390: 2020 2020 2020 2020 2074 6865 6e20 6469           then di
-000543a0: 7669 6465 6420 6279 2074 6865 206c 656e  vided by the len
-000543b0: 6774 6820 6f66 2074 6865 2077 696e 646f  gth of the windo
-000543c0: 7720 6966 2060 6073 7061 6e5f 6e6f 726d  w if ``span_norm
-000543d0: 616c 6973 653d 5472 7565 6060 2e0a 2020  alise=True``..  
-000543e0: 2020 2020 2020 2020 2020 2846 6f72 2062            (For b
-000543f0: 6961 6c6c 656c 6963 206c 6f63 692c 2074  iallelic loci, t
-00054400: 6869 7320 6e75 6d62 6572 2069 7320 7468  his number is th
-00054410: 6520 7361 6d65 2066 6f72 2062 6f74 6820  e same for both 
-00054420: 616c 6c65 6c65 732c 2061 6e64 2073 6f20  alleles, and so 
-00054430: 7375 6d6d 696e 670a 2020 2020 2020 2020  summing.        
-00054440: 2020 2020 6f76 6572 2065 6163 6820 6361      over each ca
-00054450: 6e63 656c 7320 7468 6520 6661 6374 6f72  ncels the factor
-00054460: 206f 6620 7477 6f2e 290a 0a20 2020 2020   of two.)..     
-00054470: 2020 2022 6272 616e 6368 220a 2020 2020     "branch".    
-00054480: 2020 2020 2020 2020 5468 6520 7371 7561          The squa
-00054490: 7265 6420 636f 6566 6669 6369 656e 7420  red coefficient 
-000544a0: 3a6d 6174 683a 6062 5f31 5e32 602c 2063  :math:`b_1^2`, c
-000544b0: 6f6d 7075 7465 6420 666f 7220 7468 6520  omputed for the 
-000544c0: 7370 6c69 7420 696e 6475 6365 6420 6279  split induced by
-000544d0: 2065 6163 680a 2020 2020 2020 2020 2020   each.          
-000544e0: 2020 6272 616e 6368 2028 692e 652e 2c20    branch (i.e., 
-000544f0: 7769 7468 203a 6d61 7468 3a60 6760 2069  with :math:`g` i
-00054500: 6e64 6963 6174 696e 6720 696e 6865 7269  ndicating inheri
-00054510: 7461 6e63 6520 6672 6f6d 2074 6861 7420  tance from that 
-00054520: 6272 616e 6368 292c 0a20 2020 2020 2020  branch),.       
-00054530: 2020 2020 206d 756c 7469 706c 6965 6420       multiplied 
-00054540: 6279 2062 7261 6e63 6820 6c65 6e67 7468  by branch length
-00054550: 2061 6e64 2074 7265 6520 7370 616e 2c20   and tree span, 
-00054560: 7375 6d6d 6564 206f 7665 7220 616c 6c20  summed over all 
-00054570: 7472 6565 730a 2020 2020 2020 2020 2020  trees.          
-00054580: 2020 696e 2074 6865 2077 696e 646f 772c    in the window,
-00054590: 2061 6e64 2064 6976 6964 6564 2062 7920   and divided by 
-000545a0: 7468 6520 6c65 6e67 7468 206f 6620 7468  the length of th
-000545b0: 6520 7769 6e64 6f77 2069 660a 2020 2020  e window if.    
-000545c0: 2020 2020 2020 2020 6060 7370 616e 5f6e          ``span_n
-000545d0: 6f72 6d61 6c69 7365 3d54 7275 6560 602e  ormalise=True``.
-000545e0: 0a0a 2020 2020 2020 2020 226e 6f64 6522  ..        "node"
-000545f0: 0a20 2020 2020 2020 2020 2020 2046 6f72  .            For
-00054600: 2065 6163 6820 6e6f 6465 2c20 7468 6520   each node, the 
-00054610: 7371 7561 7265 6420 636f 6566 6669 6369  squared coeffici
-00054620: 656e 7420 3a6d 6174 683a 6062 5f31 5e32  ent :math:`b_1^2
-00054630: 602c 2063 6f6d 7075 7465 6420 666f 720a  `, computed for.
-00054640: 2020 2020 2020 2020 2020 2020 7468 6520              the 
-00054650: 7072 6f70 6572 7479 206f 6620 696e 6865  property of inhe
-00054660: 7269 7469 6e67 2066 726f 6d20 7468 6973  riting from this
-00054670: 206e 6f64 652c 2061 7320 696e 2022 6272   node, as in "br
-00054680: 616e 6368 222e 0a0a 2020 2020 2020 2020  anch"...        
-00054690: 3a70 6172 616d 206e 756d 7079 2e6e 6461  :param numpy.nda
-000546a0: 7272 6179 2057 3a20 416e 2061 7272 6179  rray W: An array
-000546b0: 206f 6620 7661 6c75 6573 2077 6974 6820   of values with 
-000546c0: 6f6e 6520 726f 7720 666f 7220 6561 6368  one row for each
-000546d0: 2073 616d 706c 6520 616e 6420 6f6e 650a   sample and one.
-000546e0: 2020 2020 2020 2020 2020 2020 636f 6c75              colu
-000546f0: 6d6e 2066 6f72 2065 6163 6820 2270 6865  mn for each "phe
-00054700: 6e6f 7479 7065 222e 0a20 2020 2020 2020  notype"..       
-00054710: 203a 7061 7261 6d20 6e75 6d70 792e 6e64   :param numpy.nd
-00054720: 6172 7261 7920 5a3a 2041 6e20 6172 7261  array Z: An arra
-00054730: 7920 6f66 2076 616c 7565 7320 7769 7468  y of values with
-00054740: 206f 6e65 2072 6f77 2066 6f72 2065 6163   one row for eac
-00054750: 6820 7361 6d70 6c65 2061 6e64 206f 6e65  h sample and one
-00054760: 0a20 2020 2020 2020 2020 2020 2063 6f6c  .            col
-00054770: 756d 6e20 666f 7220 6561 6368 2022 636f  umn for each "co
-00054780: 7661 7269 6174 6522 2c20 6f72 2060 4e6f  variate", or `No
-00054790: 6e65 602e 2043 6f6c 756d 6e73 206f 6620  ne`. Columns of 
-000547a0: 605a 6020 6d75 7374 2062 6520 6c69 6e65  `Z` must be line
-000547b0: 6172 6c79 0a20 2020 2020 2020 2020 2020  arly.           
-000547c0: 2069 6e64 6570 656e 6465 6e74 2e0a 2020   independent..  
-000547d0: 2020 2020 2020 3a70 6172 616d 206c 6973        :param lis
-000547e0: 7420 7769 6e64 6f77 733a 2041 6e20 696e  t windows: An in
-000547f0: 6372 6561 7369 6e67 206c 6973 7420 6f66  creasing list of
-00054800: 2062 7265 616b 706f 696e 7473 2062 6574   breakpoints bet
-00054810: 7765 656e 2074 6865 2077 696e 646f 7773  ween the windows
-00054820: 0a20 2020 2020 2020 2020 2020 2074 6f20  .            to 
-00054830: 636f 6d70 7574 6520 7468 6520 7374 6174  compute the stat
-00054840: 6973 7469 6320 696e 2e0a 2020 2020 2020  istic in..      
-00054850: 2020 3a70 6172 616d 2073 7472 206d 6f64    :param str mod
-00054860: 653a 2041 2073 7472 696e 6720 6769 7669  e: A string givi
-00054870: 6e67 2074 6865 2022 7479 7065 2220 6f66  ng the "type" of
-00054880: 2074 6865 2073 7461 7469 7374 6963 2074   the statistic t
-00054890: 6f20 6265 2063 6f6d 7075 7465 640a 2020  o be computed.  
-000548a0: 2020 2020 2020 2020 2020 2864 6566 6175            (defau
-000548b0: 6c74 7320 746f 2022 7369 7465 2229 2e0a  lts to "site")..
-000548c0: 2020 2020 2020 2020 3a70 6172 616d 2062          :param b
-000548d0: 6f6f 6c20 7370 616e 5f6e 6f72 6d61 6c69  ool span_normali
-000548e0: 7365 3a20 5768 6574 6865 7220 746f 2064  se: Whether to d
-000548f0: 6976 6964 6520 7468 6520 7265 7375 6c74  ivide the result
-00054900: 2062 7920 7468 6520 7370 616e 206f 6620   by the span of 
-00054910: 7468 650a 2020 2020 2020 2020 2020 2020  the.            
-00054920: 7769 6e64 6f77 2028 6465 6661 756c 7473  window (defaults
-00054930: 2074 6f20 5472 7565 292e 0a20 2020 2020   to True)..     
-00054940: 2020 203a 7265 7475 726e 3a20 4120 6e64     :return: A nd
-00054950: 6172 7261 7920 7769 7468 2073 6861 7065  array with shape
-00054960: 2065 7175 616c 2074 6f20 286e 756d 2077   equal to (num w
-00054970: 696e 646f 7773 2c20 6e75 6d20 7374 6174  indows, num stat
-00054980: 6973 7469 6373 292e 0a20 2020 2020 2020  istics)..       
-00054990: 2020 2020 2049 6620 7769 6e64 6f77 733d       If windows=
-000549a0: 4e6f 6e65 2061 6e64 2057 2069 7320 6120  None and W is a 
-000549b0: 7369 6e67 6c65 2063 6f6c 756d 6e2c 2061  single column, a
-000549c0: 206e 756d 7079 2073 6361 6c61 7220 6973   numpy scalar is
-000549d0: 2072 6574 7572 6e65 642e 0a20 2020 2020   returned..     
-000549e0: 2020 2022 2222 0a20 2020 2020 2020 2069     """.        i
-000549f0: 6620 572e 7368 6170 655b 305d 2021 3d20  f W.shape[0] != 
-00054a00: 7365 6c66 2e6e 756d 5f73 616d 706c 6573  self.num_samples
-00054a10: 3a0a 2020 2020 2020 2020 2020 2020 7261  :.            ra
-00054a20: 6973 6520 5661 6c75 6545 7272 6f72 280a  ise ValueError(.
-00054a30: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00054a40: 2246 6972 7374 2074 7261 6974 2064 696d  "First trait dim
-00054a50: 656e 7369 6f6e 206d 7573 7420 6265 2065  ension must be e
-00054a60: 7175 616c 2074 6f20 6e75 6d62 6572 206f  qual to number o
-00054a70: 6620 7361 6d70 6c65 732e 220a 2020 2020  f samples.".    
-00054a80: 2020 2020 2020 2020 290a 2020 2020 2020          ).      
-00054a90: 2020 6966 205a 2069 7320 4e6f 6e65 3a0a    if Z is None:.
-00054aa0: 2020 2020 2020 2020 2020 2020 5a20 3d20              Z = 
-00054ab0: 6e70 2e6f 6e65 7328 2873 656c 662e 6e75  np.ones((self.nu
-00054ac0: 6d5f 7361 6d70 6c65 732c 2031 2929 0a20  m_samples, 1)). 
-00054ad0: 2020 2020 2020 2065 6c73 653a 0a20 2020         else:.   
-00054ae0: 2020 2020 2020 2020 2074 5a20 3d20 6e70           tZ = np
-00054af0: 2e63 6f6c 756d 6e5f 7374 6163 6b28 5b5a  .column_stack([Z
-00054b00: 2c20 6e70 2e6f 6e65 7328 285a 2e73 6861  , np.ones((Z.sha
-00054b10: 7065 5b30 5d2c 2031 2929 5d29 0a20 2020  pe[0], 1))]).   
-00054b20: 2020 2020 2020 2020 2069 6620 6e70 2e6c           if np.l
-00054b30: 696e 616c 672e 6d61 7472 6978 5f72 616e  inalg.matrix_ran
-00054b40: 6b28 745a 2920 3d3d 2074 5a2e 7368 6170  k(tZ) == tZ.shap
-00054b50: 655b 315d 3a0a 2020 2020 2020 2020 2020  e[1]:.          
-00054b60: 2020 2020 2020 5a20 3d20 745a 0a20 2020        Z = tZ.   
-00054b70: 2020 2020 2069 6620 5a2e 7368 6170 655b       if Z.shape[
-00054b80: 305d 2021 3d20 7365 6c66 2e6e 756d 5f73  0] != self.num_s
-00054b90: 616d 706c 6573 3a0a 2020 2020 2020 2020  amples:.        
-00054ba0: 2020 2020 7261 6973 6520 5661 6c75 6545      raise ValueE
-00054bb0: 7272 6f72 2822 4669 7273 7420 6469 6d65  rror("First dime
-00054bc0: 6e73 696f 6e20 6f66 205a 206d 7573 7420  nsion of Z must 
-00054bd0: 6571 7561 6c20 7468 6520 6e75 6d62 6572  equal the number
-00054be0: 206f 6620 7361 6d70 6c65 732e 2229 0a20   of samples."). 
-00054bf0: 2020 2020 2020 2069 6620 6e70 2e6c 696e         if np.lin
-00054c00: 616c 672e 6d61 7472 6978 5f72 616e 6b28  alg.matrix_rank(
-00054c10: 5a29 203c 205a 2e73 6861 7065 5b31 5d3a  Z) < Z.shape[1]:
-00054c20: 0a20 2020 2020 2020 2020 2020 2072 6169  .            rai
-00054c30: 7365 2056 616c 7565 4572 726f 7228 224d  se ValueError("M
-00054c40: 6174 7269 7820 6f66 2063 6f76 6172 6961  atrix of covaria
-00054c50: 7465 7320 6973 2063 6f6d 7075 7461 7469  tes is computati
-00054c60: 6f6e 616c 6c79 2073 696e 6775 6c61 722e  onally singular.
-00054c70: 2229 0a20 2020 2020 2020 2023 206e 756d  ").        # num
-00054c80: 7079 2072 6574 7572 6e73 2061 206c 6f77  py returns a low
-00054c90: 6572 2d74 7269 616e 6775 6c61 7220 6368  er-triangular ch
-00054ca0: 6f6c 6573 6b79 0a20 2020 2020 2020 204b  olesky.        K
-00054cb0: 203d 206e 702e 6c69 6e61 6c67 2e63 686f   = np.linalg.cho
-00054cc0: 6c65 736b 7928 6e70 2e6d 6174 6d75 6c28  lesky(np.matmul(
-00054cd0: 5a2e 542c 205a 2929 2e54 0a20 2020 2020  Z.T, Z)).T.     
-00054ce0: 2020 205a 203d 206e 702e 6d61 746d 756c     Z = np.matmul
-00054cf0: 285a 2c20 6e70 2e6c 696e 616c 672e 696e  (Z, np.linalg.in
-00054d00: 7628 4b29 290a 2020 2020 2020 2020 7265  v(K)).        re
-00054d10: 7475 726e 2073 656c 662e 5f5f 7275 6e5f  turn self.__run_
-00054d20: 7769 6e64 6f77 6564 5f73 7461 7428 0a20  windowed_stat(. 
-00054d30: 2020 2020 2020 2020 2020 2077 696e 646f             windo
-00054d40: 7773 2c0a 2020 2020 2020 2020 2020 2020  ws,.            
-00054d50: 7365 6c66 2e5f 6c6c 5f74 7265 655f 7365  self._ll_tree_se
-00054d60: 7175 656e 6365 2e74 7261 6974 5f6c 696e  quence.trait_lin
-00054d70: 6561 725f 6d6f 6465 6c2c 0a20 2020 2020  ear_model,.     
-00054d80: 2020 2020 2020 2057 2c0a 2020 2020 2020         W,.      
-00054d90: 2020 2020 2020 5a2c 0a20 2020 2020 2020        Z,.       
-00054da0: 2020 2020 206d 6f64 653d 6d6f 6465 2c0a       mode=mode,.
-00054db0: 2020 2020 2020 2020 2020 2020 7370 616e              span
-00054dc0: 5f6e 6f72 6d61 6c69 7365 3d73 7061 6e5f  _normalise=span_
-00054dd0: 6e6f 726d 616c 6973 652c 0a20 2020 2020  normalise,.     
-00054de0: 2020 2029 0a0a 2020 2020 6465 6620 7365     )..    def se
-00054df0: 6772 6567 6174 696e 675f 7369 7465 7328  gregating_sites(
-00054e00: 0a20 2020 2020 2020 2073 656c 662c 2073  .        self, s
-00054e10: 616d 706c 655f 7365 7473 3d4e 6f6e 652c  ample_sets=None,
-00054e20: 2077 696e 646f 7773 3d4e 6f6e 652c 206d   windows=None, m
-00054e30: 6f64 653d 2273 6974 6522 2c20 7370 616e  ode="site", span
-00054e40: 5f6e 6f72 6d61 6c69 7365 3d54 7275 650a  _normalise=True.
-00054e50: 2020 2020 293a 0a20 2020 2020 2020 2022      ):.        "
-00054e60: 2222 0a20 2020 2020 2020 2043 6f6d 7075  "".        Compu
-00054e70: 7465 7320 7468 6520 6465 6e73 6974 7920  tes the density 
-00054e80: 6f66 2073 6567 7265 6761 7469 6e67 2073  of segregating s
-00054e90: 6974 6573 2066 6f72 2065 6163 6820 6f66  ites for each of
-00054ea0: 2074 6865 2073 6574 7320 6f66 206e 6f64   the sets of nod
-00054eb0: 6573 0a20 2020 2020 2020 2066 726f 6d20  es.        from 
-00054ec0: 6060 7361 6d70 6c65 5f73 6574 7360 602c  ``sample_sets``,
-00054ed0: 2061 6e64 2072 656c 6174 6564 2071 7561   and related qua
-00054ee0: 6e74 6974 6965 732e 0a20 2020 2020 2020  ntities..       
-00054ef0: 2050 6c65 6173 6520 7365 6520 7468 6520   Please see the 
-00054f00: 3a72 6566 3a60 6f6e 652d 7761 7920 7374  :ref:`one-way st
-00054f10: 6174 6973 7469 6373 203c 7365 635f 7374  atistics <sec_st
-00054f20: 6174 735f 7361 6d70 6c65 5f73 6574 735f  ats_sample_sets_
-00054f30: 6f6e 655f 7761 793e 600a 2020 2020 2020  one_way>`.      
-00054f40: 2020 7365 6374 696f 6e20 666f 7220 6465    section for de
-00054f50: 7461 696c 7320 6f6e 2068 6f77 2074 6865  tails on how the
-00054f60: 2060 6073 616d 706c 655f 7365 7473 6060   ``sample_sets``
-00054f70: 2061 7267 756d 656e 7420 6973 2069 6e74   argument is int
-00054f80: 6572 7072 6574 6564 0a20 2020 2020 2020  erpreted.       
-00054f90: 2061 6e64 2068 6f77 2069 7420 696e 7465   and how it inte
-00054fa0: 7261 6374 7320 7769 7468 2074 6865 2064  racts with the d
-00054fb0: 696d 656e 7369 6f6e 7320 6f66 2074 6865  imensions of the
-00054fc0: 206f 7574 7075 7420 6172 7261 792e 0a20   output array.. 
-00054fd0: 2020 2020 2020 2053 6565 2074 6865 203a         See the :
-00054fe0: 7265 663a 6073 7461 7469 7374 6963 7320  ref:`statistics 
-00054ff0: 696e 7465 7266 6163 6520 3c73 6563 5f73  interface <sec_s
-00055000: 7461 7473 5f69 6e74 6572 6661 6365 3e60  tats_interface>`
-00055010: 2073 6563 7469 6f6e 2066 6f72 2064 6574   section for det
-00055020: 6169 6c73 206f 6e0a 2020 2020 2020 2020  ails on.        
-00055030: 3a72 6566 3a60 7769 6e64 6f77 7320 3c73  :ref:`windows <s
-00055040: 6563 5f73 7461 7473 5f77 696e 646f 7773  ec_stats_windows
-00055050: 3e60 2c20 3a72 6566 3a60 6d6f 6465 203c  >`, :ref:`mode <
-00055060: 7365 635f 7374 6174 735f 6d6f 6465 3e60  sec_stats_mode>`
-00055070: 2c0a 2020 2020 2020 2020 3a72 6566 3a60  ,.        :ref:`
-00055080: 7370 616e 206e 6f72 6d61 6c69 7365 203c  span normalise <
-00055090: 7365 635f 7374 6174 735f 7370 616e 5f6e  sec_stats_span_n
-000550a0: 6f72 6d61 6c69 7365 3e60 2c0a 2020 2020  ormalise>`,.    
-000550b0: 2020 2020 616e 6420 3a72 6566 3a60 7265      and :ref:`re
-000550c0: 7475 726e 2076 616c 7565 203c 7365 635f  turn value <sec_
-000550d0: 7374 6174 735f 6f75 7470 7574 5f66 6f72  stats_output_for
-000550e0: 6d61 743e 602e 0a0a 2020 2020 2020 2020  mat>`...        
-000550f0: 5768 6174 2069 7320 636f 6d70 7574 6564  What is computed
-00055100: 2064 6570 656e 6473 206f 6e20 6060 6d6f   depends on ``mo
-00055110: 6465 6060 2e20 466f 7220 6120 7361 6d70  de``. For a samp
-00055120: 6c65 2073 6574 2060 6041 6060 2c20 636f  le set ``A``, co
-00055130: 6d70 7574 6573 3a0a 0a20 2020 2020 2020  mputes:..       
-00055140: 2022 7369 7465 220a 2020 2020 2020 2020   "site".        
-00055150: 2020 2020 5468 6520 7375 6d20 6f76 6572      The sum over
-00055160: 2073 6974 6573 206f 6620 7468 6520 6e75   sites of the nu
-00055170: 6d62 6572 206f 6620 616c 6c65 6c65 7320  mber of alleles 
-00055180: 666f 756e 6420 696e 2060 6041 6060 2061  found in ``A`` a
-00055190: 7420 6561 6368 2073 6974 650a 2020 2020  t each site.    
-000551a0: 2020 2020 2020 2020 6d69 6e75 7320 6f6e          minus on
-000551b0: 652c 2070 6572 2075 6e69 7420 6f66 2063  e, per unit of c
-000551c0: 6872 6f6d 6f73 6f6d 6520 6c65 6e67 7468  hromosome length
-000551d0: 2e0a 2020 2020 2020 2020 2020 2020 4966  ..            If
-000551e0: 2061 6c6c 2073 6974 6573 2068 6176 6520   all sites have 
-000551f0: 6174 206d 6f73 7420 7477 6f20 616c 6c65  at most two alle
-00055200: 6c65 732c 2074 6869 7320 6973 2074 6865  les, this is the
-00055210: 2064 656e 7369 7479 206f 6620 7369 7465   density of site
-00055220: 730a 2020 2020 2020 2020 2020 2020 7468  s.            th
-00055230: 6174 2061 7265 2070 6f6c 796d 6f72 7068  at are polymorph
-00055240: 6963 2069 6e20 6060 4160 602e 2054 6f20  ic in ``A``. To 
-00055250: 6765 7420 7468 6520 2a2a 6e75 6d62 6572  get the **number
-00055260: 2a2a 206f 6620 7365 6772 6567 6174 696e  ** of segregatin
-00055270: 6720 6d69 6e6f 720a 2020 2020 2020 2020  g minor.        
-00055280: 2020 2020 616c 6c65 6c65 7320 7065 7220      alleles per 
-00055290: 7769 6e64 6f77 2c20 7061 7373 2060 6073  window, pass ``s
-000552a0: 7061 6e5f 6e6f 726d 616c 6973 653d 4661  pan_normalise=Fa
-000552b0: 6c73 6560 602e 0a0a 2020 2020 2020 2020  lse``...        
-000552c0: 2262 7261 6e63 6822 0a20 2020 2020 2020  "branch".       
-000552d0: 2020 2020 2054 6865 2074 6f74 616c 206c       The total l
-000552e0: 656e 6774 6820 6f66 2061 6c6c 2062 7261  ength of all bra
-000552f0: 6e63 6865 7320 696e 2074 6865 2074 7265  nches in the tre
-00055300: 6520 7375 6274 656e 6465 6420 6279 2074  e subtended by t
-00055310: 6865 2073 616d 706c 6573 2069 6e0a 2020  he samples in.  
-00055320: 2020 2020 2020 2020 2020 6060 4160 602c            ``A``,
-00055330: 2061 7665 7261 6765 6420 6163 726f 7373   averaged across
-00055340: 2074 6865 2077 696e 646f 772e 0a0a 2020   the window...  
-00055350: 2020 2020 2020 226e 6f64 6522 0a20 2020        "node".   
-00055360: 2020 2020 2020 2020 2054 6865 2070 726f           The pro
-00055370: 706f 7274 696f 6e20 6f66 2074 6865 2077  portion of the w
-00055380: 696e 646f 7720 6f6e 2077 6869 6368 2074  indow on which t
-00055390: 6865 206e 6f64 6520 6973 2061 6e63 6573  he node is ances
-000553a0: 7472 616c 2074 6f20 736f 6d65 2c0a 2020  tral to some,.  
-000553b0: 2020 2020 2020 2020 2020 6275 7420 6e6f            but no
-000553c0: 7420 616c 6c2c 206f 6620 7468 6520 7361  t all, of the sa
-000553d0: 6d70 6c65 7320 696e 2060 6041 6060 2e0a  mples in ``A``..
-000553e0: 0a20 2020 2020 2020 203a 7061 7261 6d20  .        :param 
-000553f0: 6c69 7374 2073 616d 706c 655f 7365 7473  list sample_sets
-00055400: 3a20 4120 6c69 7374 206f 6620 6c69 7374  : A list of list
-00055410: 7320 6f66 204e 6f64 6520 4944 732c 2073  s of Node IDs, s
-00055420: 7065 6369 6679 696e 6720 7468 650a 2020  pecifying the.  
-00055430: 2020 2020 2020 2020 2020 6772 6f75 7073            groups
-00055440: 206f 6620 6e6f 6465 7320 746f 2063 6f6d   of nodes to com
-00055450: 7075 7465 2074 6865 2073 7461 7469 7374  pute the statist
-00055460: 6963 2077 6974 682e 0a20 2020 2020 2020  ic with..       
-00055470: 203a 7061 7261 6d20 6c69 7374 2077 696e   :param list win
-00055480: 646f 7773 3a20 416e 2069 6e63 7265 6173  dows: An increas
-00055490: 696e 6720 6c69 7374 206f 6620 6272 6561  ing list of brea
-000554a0: 6b70 6f69 6e74 7320 6265 7477 6565 6e20  kpoints between 
-000554b0: 7468 6520 7769 6e64 6f77 730a 2020 2020  the windows.    
-000554c0: 2020 2020 2020 2020 746f 2063 6f6d 7075          to compu
-000554d0: 7465 2074 6865 2073 7461 7469 7374 6963  te the statistic
-000554e0: 2069 6e2e 0a20 2020 2020 2020 203a 7061   in..        :pa
-000554f0: 7261 6d20 7374 7220 6d6f 6465 3a20 4120  ram str mode: A 
-00055500: 7374 7269 6e67 2067 6976 696e 6720 7468  string giving th
-00055510: 6520 2274 7970 6522 206f 6620 7468 6520  e "type" of the 
-00055520: 7374 6174 6973 7469 6320 746f 2062 6520  statistic to be 
-00055530: 636f 6d70 7574 6564 0a20 2020 2020 2020  computed.       
-00055540: 2020 2020 2028 6465 6661 756c 7473 2074       (defaults t
-00055550: 6f20 2273 6974 6522 292e 0a20 2020 2020  o "site")..     
-00055560: 2020 203a 7061 7261 6d20 626f 6f6c 2073     :param bool s
-00055570: 7061 6e5f 6e6f 726d 616c 6973 653a 2057  pan_normalise: W
-00055580: 6865 7468 6572 2074 6f20 6469 7669 6465  hether to divide
-00055590: 2074 6865 2072 6573 756c 7420 6279 2074   the result by t
-000555a0: 6865 2073 7061 6e20 6f66 2074 6865 0a20  he span of the. 
-000555b0: 2020 2020 2020 2020 2020 2077 696e 646f             windo
-000555c0: 7720 2864 6566 6175 6c74 7320 746f 2054  w (defaults to T
-000555d0: 7275 6529 2e0a 2020 2020 2020 2020 3a72  rue)..        :r
-000555e0: 6574 7572 6e3a 2041 206e 6461 7272 6179  eturn: A ndarray
-000555f0: 2077 6974 6820 7368 6170 6520 6571 7561   with shape equa
-00055600: 6c20 746f 2028 6e75 6d20 7769 6e64 6f77  l to (num window
-00055610: 732c 206e 756d 2073 7461 7469 7374 6963  s, num statistic
-00055620: 7329 2e0a 2020 2020 2020 2020 2020 2020  s)..            
-00055630: 4966 2074 6865 7265 2069 7320 6f6e 6520  If there is one 
-00055640: 7361 6d70 6c65 2073 6574 2061 6e64 2077  sample set and w
-00055650: 696e 646f 7773 3d4e 6f6e 652c 2061 206e  indows=None, a n
-00055660: 756d 7079 2073 6361 6c61 7220 6973 2072  umpy scalar is r
-00055670: 6574 7572 6e65 642e 0a20 2020 2020 2020  eturned..       
-00055680: 2022 2222 0a20 2020 2020 2020 2072 6574   """.        ret
-00055690: 7572 6e20 7365 6c66 2e5f 5f6f 6e65 5f77  urn self.__one_w
-000556a0: 6179 5f73 616d 706c 655f 7365 745f 7374  ay_sample_set_st
-000556b0: 6174 280a 2020 2020 2020 2020 2020 2020  at(.            
-000556c0: 7365 6c66 2e5f 6c6c 5f74 7265 655f 7365  self._ll_tree_se
-000556d0: 7175 656e 6365 2e73 6567 7265 6761 7469  quence.segregati
-000556e0: 6e67 5f73 6974 6573 2c0a 2020 2020 2020  ng_sites,.      
-000556f0: 2020 2020 2020 7361 6d70 6c65 5f73 6574        sample_set
-00055700: 732c 0a20 2020 2020 2020 2020 2020 2077  s,.            w
-00055710: 696e 646f 7773 3d77 696e 646f 7773 2c0a  indows=windows,.
-00055720: 2020 2020 2020 2020 2020 2020 6d6f 6465              mode
-00055730: 3d6d 6f64 652c 0a20 2020 2020 2020 2020  =mode,.         
-00055740: 2020 2073 7061 6e5f 6e6f 726d 616c 6973     span_normalis
-00055750: 653d 7370 616e 5f6e 6f72 6d61 6c69 7365  e=span_normalise
-00055760: 2c0a 2020 2020 2020 2020 290a 0a20 2020  ,.        )..   
-00055770: 2064 6566 2061 6c6c 656c 655f 6672 6571   def allele_freq
-00055780: 7565 6e63 795f 7370 6563 7472 756d 280a  uency_spectrum(.
-00055790: 2020 2020 2020 2020 7365 6c66 2c0a 2020          self,.  
-000557a0: 2020 2020 2020 7361 6d70 6c65 5f73 6574        sample_set
-000557b0: 733d 4e6f 6e65 2c0a 2020 2020 2020 2020  s=None,.        
-000557c0: 7769 6e64 6f77 733d 4e6f 6e65 2c0a 2020  windows=None,.  
-000557d0: 2020 2020 2020 6d6f 6465 3d22 7369 7465        mode="site
-000557e0: 222c 0a20 2020 2020 2020 2073 7061 6e5f  ",.        span_
-000557f0: 6e6f 726d 616c 6973 653d 5472 7565 2c0a  normalise=True,.
-00055800: 2020 2020 2020 2020 706f 6c61 7269 7365          polarise
-00055810: 643d 4661 6c73 652c 0a20 2020 2029 3a0a  d=False,.    ):.
-00055820: 2020 2020 2020 2020 2222 220a 2020 2020          """.    
-00055830: 2020 2020 436f 6d70 7574 6573 2074 6865      Computes the
-00055840: 2061 6c6c 656c 6520 6672 6571 7565 6e63   allele frequenc
-00055850: 7920 7370 6563 7472 756d 2028 4146 5329  y spectrum (AFS)
-00055860: 2069 6e20 7769 6e64 6f77 7320 6163 726f   in windows acro
-00055870: 7373 2074 6865 2067 656e 6f6d 6520 666f  ss the genome fo
-00055880: 720a 2020 2020 2020 2020 7769 7468 2072  r.        with r
-00055890: 6573 7065 6374 2074 6f20 7468 6520 7370  espect to the sp
-000558a0: 6563 6966 6965 6420 6060 7361 6d70 6c65  ecified ``sample
-000558b0: 5f73 6574 7360 602e 0a20 2020 2020 2020  _sets``..       
-000558c0: 2053 6565 2074 6865 203a 7265 663a 6073   See the :ref:`s
-000558d0: 7461 7469 7374 6963 7320 696e 7465 7266  tatistics interf
-000558e0: 6163 6520 3c73 6563 5f73 7461 7473 5f69  ace <sec_stats_i
-000558f0: 6e74 6572 6661 6365 3e60 2073 6563 7469  nterface>` secti
-00055900: 6f6e 2066 6f72 2064 6574 6169 6c73 206f  on for details o
-00055910: 6e0a 2020 2020 2020 2020 3a72 6566 3a60  n.        :ref:`
-00055920: 7361 6d70 6c65 2073 6574 7320 3c73 6563  sample sets <sec
-00055930: 5f73 7461 7473 5f73 616d 706c 655f 7365  _stats_sample_se
-00055940: 7473 3e60 2c0a 2020 2020 2020 2020 3a72  ts>`,.        :r
-00055950: 6566 3a60 7769 6e64 6f77 7320 3c73 6563  ef:`windows <sec
-00055960: 5f73 7461 7473 5f77 696e 646f 7773 3e60  _stats_windows>`
-00055970: 2c0a 2020 2020 2020 2020 3a72 6566 3a60  ,.        :ref:`
-00055980: 6d6f 6465 203c 7365 635f 7374 6174 735f  mode <sec_stats_
-00055990: 6d6f 6465 3e60 2c0a 2020 2020 2020 2020  mode>`,.        
-000559a0: 3a72 6566 3a60 7370 616e 206e 6f72 6d61  :ref:`span norma
-000559b0: 6c69 7365 203c 7365 635f 7374 6174 735f  lise <sec_stats_
-000559c0: 7370 616e 5f6e 6f72 6d61 6c69 7365 3e60  span_normalise>`
-000559d0: 2c0a 2020 2020 2020 2020 3a72 6566 3a60  ,.        :ref:`
-000559e0: 706f 6c61 7269 7365 6420 3c73 6563 5f73  polarised <sec_s
-000559f0: 7461 7473 5f70 6f6c 6172 6973 6174 696f  tats_polarisatio
-00055a00: 6e3e 602c 0a20 2020 2020 2020 2061 6e64  n>`,.        and
-00055a10: 203a 7265 663a 6072 6574 7572 6e20 7661   :ref:`return va
-00055a20: 6c75 6520 3c73 6563 5f73 7461 7473 5f6f  lue <sec_stats_o
-00055a30: 7574 7075 745f 666f 726d 6174 3e60 2e0a  utput_format>`..
-00055a40: 2020 2020 2020 2020 616e 6420 7365 6520          and see 
-00055a50: 3a72 6566 3a60 7365 635f 7475 746f 7269  :ref:`sec_tutori
-00055a60: 616c 5f61 6673 6020 666f 7220 6578 616d  al_afs` for exam
-00055a70: 706c 6573 206f 6620 686f 7720 746f 2075  ples of how to u
-00055a80: 7365 2074 6869 7320 6d65 7468 6f64 2e0a  se this method..
-00055a90: 0a20 2020 2020 2020 2053 696d 696c 6172  .        Similar
-00055aa0: 2074 6f20 6f74 6865 7220 7769 6e64 6f77   to other window
-00055ab0: 6564 2073 7461 7473 2c20 7468 6520 6669  ed stats, the fi
-00055ac0: 7273 7420 6469 6d65 6e73 696f 6e20 696e  rst dimension in
-00055ad0: 2074 6865 2072 6574 7572 6e65 6420 6172   the returned ar
-00055ae0: 7261 790a 2020 2020 2020 2020 636f 7272  ray.        corr
-00055af0: 6573 706f 6e64 7320 746f 2077 696e 646f  esponds to windo
-00055b00: 7773 2c20 7375 6368 2074 6861 7420 6060  ws, such that ``
-00055b10: 7265 7375 6c74 5b69 5d60 6020 6973 2074  result[i]`` is t
-00055b20: 6865 2041 4653 2069 6e20 7468 6520 6974  he AFS in the it
-00055b30: 680a 2020 2020 2020 2020 7769 6e64 6f77  h.        window
-00055b40: 2e20 5468 6520 4146 5320 696e 2065 6163  . The AFS in eac
-00055b50: 6820 7769 6e64 6f77 2069 7320 6120 6b2d  h window is a k-
-00055b60: 6469 6d65 6e73 696f 6e61 6c20 6e75 6d70  dimensional nump
-00055b70: 7920 6172 7261 792c 2077 6865 7265 206b  y array, where k
-00055b80: 2069 730a 2020 2020 2020 2020 7468 6520   is.        the 
-00055b90: 6e75 6d62 6572 206f 6620 696e 7075 7420  number of input 
-00055ba0: 7361 6d70 6c65 2073 6574 732c 2073 7563  sample sets, suc
-00055bb0: 6820 7468 6174 2060 6072 6573 756c 745b  h that ``result[
-00055bc0: 692c 206a 302c 206a 312c 202e 2e2e 5d60  i, j0, j1, ...]`
-00055bd0: 6020 6973 2074 6865 0a20 2020 2020 2020  ` is the.       
-00055be0: 2076 616c 7565 2061 7373 6f63 6961 7465   value associate
-00055bf0: 6420 7769 7468 2066 7265 7175 656e 6379  d with frequency
-00055c00: 2060 606a 3060 6020 696e 2060 6073 616d   ``j0`` in ``sam
-00055c10: 706c 655f 7365 7473 5b30 5d60 602c 2060  ple_sets[0]``, `
-00055c20: 606a 3160 6020 696e 0a20 2020 2020 2020  `j1`` in.       
-00055c30: 2060 6073 616d 706c 655f 7365 7473 5b31   ``sample_sets[1
-00055c40: 5d60 602c 2065 7463 2c20 696e 2077 696e  ]``, etc, in win
-00055c50: 646f 7720 6060 6960 602e 2046 726f 6d20  dow ``i``. From 
-00055c60: 6865 7265 2c20 7765 2077 696c 6c20 6173  here, we will as
-00055c70: 7375 6d65 2074 6861 740a 2020 2020 2020  sume that.      
-00055c80: 2020 6060 6166 7360 6020 636f 7272 6573    ``afs`` corres
-00055c90: 706f 6e64 7320 746f 2074 6865 2072 6573  ponds to the res
-00055ca0: 756c 7420 696e 2061 2073 696e 676c 6520  ult in a single 
-00055cb0: 7769 6e64 6f77 2c20 692e 652e 2c0a 2020  window, i.e.,.  
-00055cc0: 2020 2020 2020 6060 6166 7320 3d20 7265        ``afs = re
-00055cd0: 7375 6c74 5b69 5d60 602e 0a0a 2020 2020  sult[i]``...    
-00055ce0: 2020 2020 4966 2061 2073 696e 676c 6520      If a single 
-00055cf0: 7361 6d70 6c65 2073 6574 2069 7320 7370  sample set is sp
-00055d00: 6563 6966 6965 642c 2074 6865 2061 6c6c  ecified, the all
-00055d10: 656c 6520 6672 6571 7565 6e63 7920 7370  ele frequency sp
-00055d20: 6563 7472 756d 2077 6974 6869 6e0a 2020  ectrum within.  
-00055d30: 2020 2020 2020 7468 6973 2073 6574 2069        this set i
-00055d40: 7320 7265 7475 726e 6564 2c20 7375 6368  s returned, such
-00055d50: 2074 6861 7420 6060 6166 735b 6a5d 6060   that ``afs[j]``
-00055d60: 2069 7320 7468 6520 7661 6c75 6520 6173   is the value as
-00055d70: 736f 6369 6174 6564 2077 6974 680a 2020  sociated with.  
-00055d80: 2020 2020 2020 6672 6571 7565 6e63 7920        frequency 
-00055d90: 6060 6a60 602e 2054 6875 732c 2073 696e  ``j``. Thus, sin
-00055da0: 676c 6574 6f6e 7320 6172 6520 636f 756e  gletons are coun
-00055db0: 7465 6420 696e 2060 6061 6673 5b31 5d60  ted in ``afs[1]`
-00055dc0: 602c 2064 6f75 626c 6574 6f6e 7320 696e  `, doubletons in
-00055dd0: 0a20 2020 2020 2020 2060 6061 6673 5b32  .        ``afs[2
-00055de0: 5d60 602c 2061 6e64 2073 6f20 6f6e 2e20  ]``, and so on. 
-00055df0: 5468 6520 7a65 726f 7468 2065 6e74 7279  The zeroth entry
-00055e00: 2063 6f75 6e74 7320 616c 6c65 6c65 7320   counts alleles 
-00055e10: 6f72 2062 7261 6e63 6865 7320 6e6f 740a  or branches not.
-00055e20: 2020 2020 2020 2020 7365 656e 2069 6e20          seen in 
-00055e30: 7468 6520 7361 6d70 6c65 7320 6275 7420  the samples but 
-00055e40: 7468 6174 2061 7265 2070 6f6c 796d 6f72  that are polymor
-00055e50: 7068 6963 2061 6d6f 6e67 2074 6865 2072  phic among the r
-00055e60: 6573 7420 6f66 2074 6865 2073 616d 706c  est of the sampl
-00055e70: 6573 0a20 2020 2020 2020 206f 6620 7468  es.        of th
-00055e80: 6520 7472 6565 2073 6571 7565 6e63 653b  e tree sequence;
-00055e90: 206c 696b 6577 6973 652c 2074 6865 206c   likewise, the l
-00055ea0: 6173 7420 656e 7472 7920 636f 756e 7473  ast entry counts
-00055eb0: 2061 6c6c 656c 6573 2066 6978 6564 2069   alleles fixed i
-00055ec0: 6e0a 2020 2020 2020 2020 7468 6520 7361  n.        the sa
-00055ed0: 6d70 6c65 2073 6574 2062 7574 2070 6f6c  mple set but pol
-00055ee0: 796d 6f72 7068 6963 2069 6e20 7468 6520  ymorphic in the 
-00055ef0: 656e 7469 7265 2073 6574 206f 6620 7361  entire set of sa
-00055f00: 6d70 6c65 732e 2050 6c65 6173 6520 7365  mples. Please se
-00055f10: 650a 2020 2020 2020 2020 7468 6520 3a72  e.        the :r
-00055f20: 6566 3a60 7365 635f 7475 746f 7269 616c  ef:`sec_tutorial
-00055f30: 5f61 6673 5f7a 6572 6f74 685f 656e 7472  _afs_zeroth_entr
-00055f40: 7960 2066 6f72 2061 6e20 696c 6c75 7374  y` for an illust
-00055f50: 7261 7469 6f6e 2e0a 0a20 2020 2020 2020  ration...       
-00055f60: 202e 2e20 7761 726e 696e 673a 3a20 506c   .. warning:: Pl
-00055f70: 6561 7365 206e 6f74 6520 7468 6174 2073  ease note that s
-00055f80: 696e 676c 6574 6f6e 7320 6172 6520 2a2a  ingletons are **
-00055f90: 6e6f 742a 2a20 636f 756e 7465 6420 696e  not** counted in
-00055fa0: 2074 6865 2069 6e69 7469 616c 0a20 2020   the initial.   
-00055fb0: 2020 2020 2020 2020 2065 6e74 7279 2069           entry i
-00055fc0: 6e20 6561 6368 2041 4653 2061 7272 6179  n each AFS array
-00055fd0: 2028 692e 652e 2c20 6060 6166 735b 305d   (i.e., ``afs[0]
-00055fe0: 6060 292c 2062 7574 2069 6e20 6060 6166  ``), but in ``af
-00055ff0: 735b 315d 6060 2e0a 0a20 2020 2020 2020  s[1]``...       
-00056000: 2049 6620 6060 7361 6d70 6c65 5f73 6574   If ``sample_set
-00056010: 7360 6020 6973 204e 6f6e 6520 2874 6865  s`` is None (the
-00056020: 2064 6566 6175 6c74 292c 2074 6865 2061   default), the a
-00056030: 6c6c 656c 6520 6672 6571 7565 6e63 7920  llele frequency 
-00056040: 7370 6563 7472 756d 0a20 2020 2020 2020  spectrum.       
-00056050: 2066 6f72 2061 6c6c 2073 616d 706c 6573   for all samples
-00056060: 2069 6e20 7468 6520 7472 6565 2073 6571   in the tree seq
-00056070: 7565 6e63 6520 6973 2072 6574 7572 6e65  uence is returne
-00056080: 642e 0a0a 2020 2020 2020 2020 4966 206d  d...        If m
-00056090: 6f72 6520 7468 616e 206f 6e65 2073 616d  ore than one sam
-000560a0: 706c 6520 7365 7420 6973 2073 7065 6369  ple set is speci
-000560b0: 6669 6564 2c20 7468 6520 2a2a 6a6f 696e  fied, the **join
-000560c0: 742a 2a20 616c 6c65 6c65 2066 7265 7175  t** allele frequ
-000560d0: 656e 6379 0a20 2020 2020 2020 2073 7065  ency.        spe
-000560e0: 6374 7275 6d20 7769 7468 696e 2077 696e  ctrum within win
-000560f0: 646f 7773 2069 7320 7265 7475 726e 6564  dows is returned
-00056100: 2e20 466f 7220 6578 616d 706c 652c 2069  . For example, i
-00056110: 6620 7765 2073 6574 0a20 2020 2020 2020  f we set.       
-00056120: 2060 6073 616d 706c 655f 7365 7473 203d   ``sample_sets =
-00056130: 205b 5330 2c20 5331 5d60 602c 2074 6865   [S0, S1]``, the
-00056140: 6e20 6166 735b 312c 2032 5d20 636f 756e  n afs[1, 2] coun
-00056150: 7473 2074 6865 206e 756d 6265 7220 6f66  ts the number of
-00056160: 2073 6974 6573 2074 6861 740a 2020 2020   sites that.    
-00056170: 2020 2020 6172 6520 7369 6e67 6c65 746f      are singleto
-00056180: 6e73 2077 6974 6869 6e20 5330 2061 6e64  ns within S0 and
-00056190: 2064 6f75 626c 6574 6f6e 7320 696e 2053   doubletons in S
-000561a0: 312e 2054 6865 2064 696d 656e 7369 6f6e  1. The dimension
-000561b0: 7320 6f66 2074 6865 0a20 2020 2020 2020  s of the.       
-000561c0: 206f 7574 7075 7420 6172 7261 7920 7769   output array wi
-000561d0: 6c6c 2062 6520 6060 5b6e 756d 5f77 696e  ll be ``[num_win
-000561e0: 646f 7773 5d20 2b20 5b31 202b 206c 656e  dows] + [1 + len
-000561f0: 2853 2920 666f 7220 5320 696e 2073 616d  (S) for S in sam
-00056200: 706c 655f 7365 7473 5d60 602e 0a0a 2020  ple_sets]``...  
-00056210: 2020 2020 2020 4966 2060 6070 6f6c 6172        If ``polar
-00056220: 6973 6564 6060 2069 7320 4661 6c73 6520  ised`` is False 
-00056230: 2874 6865 2064 6566 6175 6c74 2920 7468  (the default) th
-00056240: 6520 4146 5320 7769 6c6c 2062 6520 2a66  e AFS will be *f
-00056250: 6f6c 6465 642a 2c20 736f 2074 6861 740a  olded*, so that.
-00056260: 2020 2020 2020 2020 7468 6520 636f 756e          the coun
-00056270: 7473 2064 6f20 6e6f 7420 6465 7065 6e64  ts do not depend
-00056280: 206f 6e20 6b6e 6f77 696e 6720 7768 6963   on knowing whic
-00056290: 6820 616c 6c65 6c65 2069 7320 616e 6365  h allele is ance
-000562a0: 7374 7261 6c2e 2049 6620 666f 6c64 6564  stral. If folded
-000562b0: 2c0a 2020 2020 2020 2020 7468 6520 6672  ,.        the fr
-000562c0: 6571 7565 6e63 7920 7370 6563 7472 756d  equency spectrum
-000562d0: 2066 6f72 2061 2073 696e 676c 6520 7361   for a single sa
-000562e0: 6d70 6c65 2073 6574 2060 6053 6060 2068  mple set ``S`` h
-000562f0: 6173 2060 6061 6673 5b6a 5d20 3d20 3060  as ``afs[j] = 0`
-00056300: 6020 666f 720a 2020 2020 2020 2020 616c  ` for.        al
-00056310: 6c20 6060 6a20 3e20 6c65 6e28 5329 202f  l ``j > len(S) /
-00056320: 2032 6060 2c20 736f 2074 6861 7420 616c   2``, so that al
-00056330: 6c65 6c65 7320 6174 2066 7265 7175 656e  leles at frequen
-00056340: 6379 2060 606a 6060 2061 6e64 2060 606c  cy ``j`` and ``l
-00056350: 656e 2853 2920 2d20 6a60 600a 2020 2020  en(S) - j``.    
-00056360: 2020 2020 626f 7468 2061 6464 2074 6f20      both add to 
-00056370: 7468 6520 7361 6d65 2065 6e74 7279 2e20  the same entry. 
-00056380: 4966 2074 6865 7265 2069 7320 6d6f 7265  If there is more
-00056390: 2074 6861 6e20 6f6e 6520 7361 6d70 6c65   than one sample
-000563a0: 2073 6574 2c20 7468 650a 2020 2020 2020   set, the.      
-000563b0: 2020 7265 7475 726e 6564 2061 7272 6179    returned array
-000563c0: 2069 7320 226c 6f77 6572 2074 7269 616e   is "lower trian
-000563d0: 6775 6c61 7222 2069 6e20 6120 7369 6d69  gular" in a simi
-000563e0: 6c61 7220 7761 792e 2046 6f72 206d 6f72  lar way. For mor
-000563f0: 6520 6465 7461 696c 732c 0a20 2020 2020  e details,.     
-00056400: 2020 2065 7370 6563 6961 6c6c 7920 6162     especially ab
-00056410: 6f75 7420 6861 6e64 6c69 6e67 206f 6620  out handling of 
-00056420: 6d75 6c74 6961 6c6c 656c 6963 2073 6974  multiallelic sit
-00056430: 6573 2c20 7365 6520 3a72 6566 3a60 7365  es, see :ref:`se
-00056440: 635f 7374 6174 735f 6e6f 7465 735f 6166  c_stats_notes_af
-00056450: 7360 2e0a 0a20 2020 2020 2020 2057 6861  s`...        Wha
-00056460: 7420 6973 2063 6f6d 7075 7465 6420 6465  t is computed de
-00056470: 7065 6e64 7320 6f6e 2060 606d 6f64 6560  pends on ``mode`
-00056480: 603a 0a0a 2020 2020 2020 2020 2273 6974  `:..        "sit
-00056490: 6522 0a20 2020 2020 2020 2020 2020 2054  e".            T
-000564a0: 6865 206e 756d 6265 7220 6f66 2061 6c6c  he number of all
-000564b0: 656c 6573 2061 7420 6120 6769 7665 6e20  eles at a given 
-000564c0: 6672 6571 7565 6e63 7920 7769 7468 696e  frequency within
-000564d0: 2074 6865 2073 7065 6369 6669 6564 2073   the specified s
-000564e0: 616d 706c 650a 2020 2020 2020 2020 2020  ample.          
-000564f0: 2020 7365 7473 2066 6f72 2065 6163 6820    sets for each 
-00056500: 7769 6e64 6f77 2c20 7065 7220 756e 6974  window, per unit
-00056510: 206f 6620 7365 7175 656e 6365 206c 656e   of sequence len
-00056520: 6774 682e 2054 6f20 6f62 7461 696e 2074  gth. To obtain t
-00056530: 6865 2074 6f74 616c 0a20 2020 2020 2020  he total.       
-00056540: 2020 2020 206e 756d 6265 7220 6f66 2061       number of a
-00056550: 6c6c 656c 6573 2c20 7365 7420 6060 7370  lleles, set ``sp
-00056560: 616e 5f6e 6f72 6d61 6c69 7365 6060 2074  an_normalise`` t
-00056570: 6f20 4661 6c73 652e 0a0a 2020 2020 2020  o False...      
-00056580: 2020 2262 7261 6e63 6822 0a20 2020 2020    "branch".     
-00056590: 2020 2020 2020 2054 6865 2074 6f74 616c         The total
-000565a0: 206c 656e 6774 6820 6f66 2062 7261 6e63   length of branc
-000565b0: 6865 7320 696e 2074 6865 2074 7265 6573  hes in the trees
-000565c0: 2073 7562 7465 6e64 6564 2062 7920 7375   subtended by su
-000565d0: 6273 6574 7320 6f66 2074 6865 0a20 2020  bsets of the.   
-000565e0: 2020 2020 2020 2020 2073 7065 6369 6669           specifi
-000565f0: 6564 2073 616d 706c 6520 7365 7473 2c20  ed sample sets, 
-00056600: 7065 7220 756e 6974 206f 6620 7365 7175  per unit of sequ
-00056610: 656e 6365 206c 656e 6774 682e 2054 6f20  ence length. To 
-00056620: 6f62 7461 696e 2074 6865 0a20 2020 2020  obtain the.     
-00056630: 2020 2020 2020 2074 6f74 616c 2c20 7365         total, se
-00056640: 7420 6060 7370 616e 5f6e 6f72 6d61 6c69  t ``span_normali
-00056650: 7365 6060 2074 6f20 4661 6c73 652e 0a0a  se`` to False...
-00056660: 2020 2020 2020 2020 226e 6f64 6522 0a20          "node". 
-00056670: 2020 2020 2020 2020 2020 204e 6f74 2073             Not s
-00056680: 7570 706f 7274 6564 2066 6f72 2074 6869  upported for thi
-00056690: 7320 6d65 7468 6f64 2028 7261 6973 6573  s method (raises
-000566a0: 2061 2056 616c 7565 4572 726f 7229 2e0a   a ValueError)..
-000566b0: 0a20 2020 2020 2020 2046 6f72 2065 7861  .        For exa
-000566c0: 6d70 6c65 2c20 7375 7070 6f73 6520 7468  mple, suppose th
-000566d0: 6174 2060 5330 6020 6973 2061 206c 6973  at `S0` is a lis
-000566e0: 7420 6f66 2035 2073 616d 706c 6520 4944  t of 5 sample ID
-000566f0: 732c 2061 6e64 2060 5331 6020 6973 0a20  s, and `S1` is. 
-00056700: 2020 2020 2020 2061 206c 6973 7420 6f66         a list of
-00056710: 2033 206f 7468 6572 2073 616d 706c 6520   3 other sample 
-00056720: 4944 732e 2054 6865 6e20 6061 6673 203d  IDs. Then `afs =
-00056730: 2074 732e 616c 6c65 6c65 5f66 7265 7175   ts.allele_frequ
-00056740: 656e 6379 5f73 7065 6374 7275 6d28 5b53  ency_spectrum([S
-00056750: 302c 2053 315d 2c0a 2020 2020 2020 2020  0, S1],.        
-00056760: 6d6f 6465 3d22 7369 7465 222c 2073 7061  mode="site", spa
-00056770: 6e5f 6e6f 726d 616c 6973 653d 4661 6c73  n_normalise=Fals
-00056780: 6529 6020 7769 6c6c 2062 6520 6120 3578  e)` will be a 5x
-00056790: 3320 6e75 6d70 7920 6172 7261 792c 2061  3 numpy array, a
-000567a0: 6e64 2069 660a 2020 2020 2020 2020 7468  nd if.        th
-000567b0: 6572 6520 6172 6520 7369 7820 616c 6c65  ere are six alle
-000567c0: 6c65 7320 7468 6174 2061 7265 2070 7265  les that are pre
-000567d0: 7365 6e74 2069 6e20 6f6e 6c79 206f 6e65  sent in only one
-000567e0: 2073 616d 706c 6520 6f66 2060 5330 6020   sample of `S0` 
-000567f0: 6275 740a 2020 2020 2020 2020 7477 6f20  but.        two 
-00056800: 7361 6d70 6c65 7320 6f66 2060 5331 602c  samples of `S1`,
-00056810: 2074 6865 6e20 6061 6673 5b31 2c32 5d60   then `afs[1,2]`
-00056820: 2077 696c 6c20 6265 2065 7175 616c 2074   will be equal t
-00056830: 6f20 362e 2020 5369 6d69 6c61 726c 792c  o 6.  Similarly,
-00056840: 0a20 2020 2020 2020 2060 6272 616e 6368  .        `branch
-00056850: 5f61 6673 203d 2074 732e 616c 6c65 6c65  _afs = ts.allele
-00056860: 5f66 7265 7175 656e 6379 5f73 7065 6374  _frequency_spect
-00056870: 7275 6d28 5b53 302c 2053 315d 2c20 6d6f  rum([S0, S1], mo
-00056880: 6465 3d22 6272 616e 6368 222c 0a20 2020  de="branch",.   
-00056890: 2020 2020 2073 7061 6e5f 6e6f 726d 616c       span_normal
-000568a0: 6973 653d 4661 6c73 6529 6020 7769 6c6c  ise=False)` will
-000568b0: 2061 6c73 6f20 6265 2061 2035 7833 2061   also be a 5x3 a
-000568c0: 7272 6179 2c20 616e 6420 6062 7261 6e63  rray, and `branc
-000568d0: 685f 6166 735b 312c 325d 600a 2020 2020  h_afs[1,2]`.    
-000568e0: 2020 2020 7769 6c6c 2062 6520 7468 6520      will be the 
-000568f0: 746f 7461 6c20 6172 6561 2028 692e 652e  total area (i.e.
-00056900: 2c20 6c65 6e67 7468 2074 696d 6573 2073  , length times s
-00056910: 7061 6e29 206f 6620 616c 6c20 6272 616e  pan) of all bran
-00056920: 6368 6573 2074 6861 740a 2020 2020 2020  ches that.      
-00056930: 2020 6172 6520 6162 6f76 6520 6578 6163    are above exac
-00056940: 746c 7920 6f6e 6520 7361 6d70 6c65 206f  tly one sample o
-00056950: 6620 6053 3060 2061 6e64 2074 776f 2073  f `S0` and two s
-00056960: 616d 706c 6573 206f 6620 6053 3160 2e0a  amples of `S1`..
-00056970: 0a20 2020 2020 2020 203a 7061 7261 6d20  .        :param 
-00056980: 6c69 7374 2073 616d 706c 655f 7365 7473  list sample_sets
-00056990: 3a20 4120 6c69 7374 206f 6620 6c69 7374  : A list of list
-000569a0: 7320 6f66 204e 6f64 6520 4944 732c 2073  s of Node IDs, s
-000569b0: 7065 6369 6679 696e 6720 7468 650a 2020  pecifying the.  
-000569c0: 2020 2020 2020 2020 2020 6772 6f75 7073            groups
-000569d0: 206f 6620 7361 6d70 6c65 7320 746f 2063   of samples to c
-000569e0: 6f6d 7075 7465 2074 6865 206a 6f69 6e74  ompute the joint
-000569f0: 2061 6c6c 656c 6520 6672 6571 7565 6e63   allele frequenc
-00056a00: 790a 2020 2020 2020 2020 3a70 6172 616d  y.        :param
-00056a10: 206c 6973 7420 7769 6e64 6f77 733a 2041   list windows: A
-00056a20: 6e20 696e 6372 6561 7369 6e67 206c 6973  n increasing lis
-00056a30: 7420 6f66 2062 7265 616b 706f 696e 7473  t of breakpoints
-00056a40: 2062 6574 7765 656e 2077 696e 646f 7773   between windows
-00056a50: 0a20 2020 2020 2020 2020 2020 2061 6c6f  .            alo
-00056a60: 6e67 2074 6865 2067 656e 6f6d 652e 0a20  ng the genome.. 
-00056a70: 2020 2020 2020 203a 7061 7261 6d20 7374         :param st
-00056a80: 7220 6d6f 6465 3a20 4120 7374 7269 6e67  r mode: A string
-00056a90: 2067 6976 696e 6720 7468 6520 2274 7970   giving the "typ
-00056aa0: 6522 206f 6620 7468 6520 7374 6174 6973  e" of the statis
-00056ab0: 7469 6320 746f 2062 6520 636f 6d70 7574  tic to be comput
-00056ac0: 6564 0a20 2020 2020 2020 2020 2020 2028  ed.            (
-00056ad0: 6465 6661 756c 7473 2074 6f20 2273 6974  defaults to "sit
-00056ae0: 6522 292e 0a20 2020 2020 2020 203a 7061  e")..        :pa
-00056af0: 7261 6d20 626f 6f6c 2073 7061 6e5f 6e6f  ram bool span_no
-00056b00: 726d 616c 6973 653a 2057 6865 7468 6572  rmalise: Whether
-00056b10: 2074 6f20 6469 7669 6465 2074 6865 2072   to divide the r
-00056b20: 6573 756c 7420 6279 2074 6865 2073 7061  esult by the spa
-00056b30: 6e20 6f66 2074 6865 0a20 2020 2020 2020  n of the.       
-00056b40: 2020 2020 2077 696e 646f 7720 2864 6566       window (def
-00056b50: 6175 6c74 7320 746f 2054 7275 6529 2e0a  aults to True)..
-00056b60: 2020 2020 2020 2020 3a72 6574 7572 6e3a          :return:
-00056b70: 2041 2028 6b20 2b20 3129 2064 696d 656e   A (k + 1) dimen
-00056b80: 7369 6f6e 616c 206e 756d 7079 2061 7272  sional numpy arr
-00056b90: 6179 2c20 7768 6572 6520 6b20 6973 2074  ay, where k is t
-00056ba0: 6865 206e 756d 6265 7220 6f66 2073 616d  he number of sam
-00056bb0: 706c 650a 2020 2020 2020 2020 2020 2020  ple.            
-00056bc0: 7365 7473 2073 7065 6369 6669 6564 2e0a  sets specified..
-00056bd0: 2020 2020 2020 2020 2020 2020 4966 2074              If t
-00056be0: 6865 7265 2069 7320 6f6e 6520 7361 6d70  here is one samp
-00056bf0: 6c65 2073 6574 2061 6e64 2077 696e 646f  le set and windo
-00056c00: 7773 3d4e 6f6e 652c 2061 2031 2064 696d  ws=None, a 1 dim
-00056c10: 656e 7369 6f6e 616c 2061 7272 6179 2069  ensional array i
-00056c20: 730a 2020 2020 2020 2020 2020 2020 7265  s.            re
-00056c30: 7475 726e 6564 2e0a 2020 2020 2020 2020  turned..        
-00056c40: 2222 220a 2020 2020 2020 2020 6966 2073  """.        if s
-00056c50: 616d 706c 655f 7365 7473 2069 7320 4e6f  ample_sets is No
-00056c60: 6e65 3a0a 2020 2020 2020 2020 2020 2020  ne:.            
-00056c70: 7361 6d70 6c65 5f73 6574 7320 3d20 5b73  sample_sets = [s
-00056c80: 656c 662e 7361 6d70 6c65 7328 295d 0a20  elf.samples()]. 
-00056c90: 2020 2020 2020 2072 6574 7572 6e20 7365         return se
-00056ca0: 6c66 2e5f 5f6f 6e65 5f77 6179 5f73 616d  lf.__one_way_sam
-00056cb0: 706c 655f 7365 745f 7374 6174 280a 2020  ple_set_stat(.  
-00056cc0: 2020 2020 2020 2020 2020 7365 6c66 2e5f            self._
-00056cd0: 6c6c 5f74 7265 655f 7365 7175 656e 6365  ll_tree_sequence
-00056ce0: 2e61 6c6c 656c 655f 6672 6571 7565 6e63  .allele_frequenc
-00056cf0: 795f 7370 6563 7472 756d 2c0a 2020 2020  y_spectrum,.    
-00056d00: 2020 2020 2020 2020 7361 6d70 6c65 5f73          sample_s
-00056d10: 6574 732c 0a20 2020 2020 2020 2020 2020  ets,.           
-00056d20: 2077 696e 646f 7773 3d77 696e 646f 7773   windows=windows
-00056d30: 2c0a 2020 2020 2020 2020 2020 2020 6d6f  ,.            mo
-00056d40: 6465 3d6d 6f64 652c 0a20 2020 2020 2020  de=mode,.       
-00056d50: 2020 2020 2073 7061 6e5f 6e6f 726d 616c       span_normal
-00056d60: 6973 653d 7370 616e 5f6e 6f72 6d61 6c69  ise=span_normali
-00056d70: 7365 2c0a 2020 2020 2020 2020 2020 2020  se,.            
-00056d80: 706f 6c61 7269 7365 643d 706f 6c61 7269  polarised=polari
-00056d90: 7365 642c 0a20 2020 2020 2020 2029 0a0a  sed,.        )..
-00056da0: 2020 2020 6465 6620 5461 6a69 6d61 735f      def Tajimas_
-00056db0: 4428 7365 6c66 2c20 7361 6d70 6c65 5f73  D(self, sample_s
-00056dc0: 6574 733d 4e6f 6e65 2c20 7769 6e64 6f77  ets=None, window
-00056dd0: 733d 4e6f 6e65 2c20 6d6f 6465 3d22 7369  s=None, mode="si
-00056de0: 7465 2229 3a0a 2020 2020 2020 2020 2222  te"):.        ""
-00056df0: 220a 2020 2020 2020 2020 436f 6d70 7574  ".        Comput
-00056e00: 6573 2054 616a 696d 6127 7320 4420 6f66  es Tajima's D of
-00056e10: 2073 6574 7320 6f66 206e 6f64 6573 2066   sets of nodes f
-00056e20: 726f 6d20 6060 7361 6d70 6c65 5f73 6574  rom ``sample_set
-00056e30: 7360 6020 696e 2077 696e 646f 7773 2e0a  s`` in windows..
-00056e40: 2020 2020 2020 2020 506c 6561 7365 2073          Please s
-00056e50: 6565 2074 6865 203a 7265 663a 606f 6e65  ee the :ref:`one
-00056e60: 2d77 6179 2073 7461 7469 7374 6963 7320  -way statistics 
-00056e70: 3c73 6563 5f73 7461 7473 5f73 616d 706c  <sec_stats_sampl
-00056e80: 655f 7365 7473 5f6f 6e65 5f77 6179 3e60  e_sets_one_way>`
-00056e90: 0a20 2020 2020 2020 2073 6563 7469 6f6e  .        section
-00056ea0: 2066 6f72 2064 6574 6169 6c73 206f 6e20   for details on 
-00056eb0: 686f 7720 7468 6520 6060 7361 6d70 6c65  how the ``sample
-00056ec0: 5f73 6574 7360 6020 6172 6775 6d65 6e74  _sets`` argument
-00056ed0: 2069 7320 696e 7465 7270 7265 7465 640a   is interpreted.
-00056ee0: 2020 2020 2020 2020 616e 6420 686f 7720          and how 
-00056ef0: 6974 2069 6e74 6572 6163 7473 2077 6974  it interacts wit
-00056f00: 6820 7468 6520 6469 6d65 6e73 696f 6e73  h the dimensions
-00056f10: 206f 6620 7468 6520 6f75 7470 7574 2061   of the output a
-00056f20: 7272 6179 2e0a 2020 2020 2020 2020 5365  rray..        Se
-00056f30: 6520 7468 6520 3a72 6566 3a60 7374 6174  e the :ref:`stat
-00056f40: 6973 7469 6373 2069 6e74 6572 6661 6365  istics interface
-00056f50: 203c 7365 635f 7374 6174 735f 696e 7465   <sec_stats_inte
-00056f60: 7266 6163 653e 6020 7365 6374 696f 6e20  rface>` section 
-00056f70: 666f 7220 6465 7461 696c 7320 6f6e 0a20  for details on. 
-00056f80: 2020 2020 2020 203a 7265 663a 6077 696e         :ref:`win
-00056f90: 646f 7773 203c 7365 635f 7374 6174 735f  dows <sec_stats_
-00056fa0: 7769 6e64 6f77 733e 602c 203a 7265 663a  windows>`, :ref:
-00056fb0: 606d 6f64 6520 3c73 6563 5f73 7461 7473  `mode <sec_stats
-00056fc0: 5f6d 6f64 653e 602c 0a20 2020 2020 2020  _mode>`,.       
-00056fd0: 2061 6e64 203a 7265 663a 6072 6574 7572   and :ref:`retur
-00056fe0: 6e20 7661 6c75 6520 3c73 6563 5f73 7461  n value <sec_sta
-00056ff0: 7473 5f6f 7574 7075 745f 666f 726d 6174  ts_output_format
-00057000: 3e60 2e0a 2020 2020 2020 2020 4f70 6572  >`..        Oper
-00057010: 6174 6573 206f 6e20 6060 6b20 3d20 3160  ates on ``k = 1`
-00057020: 6020 7361 6d70 6c65 2073 6574 7320 6174  ` sample sets at
-00057030: 2061 0a20 2020 2020 2020 2074 696d 652e   a.        time.
-00057040: 2046 6f72 2061 2073 616d 706c 6520 7365   For a sample se
-00057050: 7420 6060 5860 6020 6f66 2060 606e 6060  t ``X`` of ``n``
-00057060: 206e 6f64 6573 2c20 6966 2061 6e64 2060   nodes, if and `
-00057070: 6054 6060 2069 7320 7468 6520 6d65 616e  `T`` is the mean
-00057080: 0a20 2020 2020 2020 206e 756d 6265 7220  .        number 
-00057090: 6f66 2070 6169 7277 6973 6520 6469 6666  of pairwise diff
-000570a0: 6572 696e 6720 7369 7465 7320 696e 2060  ering sites in `
-000570b0: 6058 6060 2061 6e64 2060 6053 6060 2069  `X`` and ``S`` i
-000570c0: 7320 7468 6520 6e75 6d62 6572 206f 660a  s the number of.
-000570d0: 2020 2020 2020 2020 7369 7465 7320 7365          sites se
-000570e0: 6772 6567 6174 696e 6720 696e 2060 6058  gregating in ``X
-000570f0: 6060 2028 636f 6d70 7574 6564 2077 6974  `` (computed wit
-00057100: 6820 3a6d 6574 683a 6064 6976 6572 7369  h :meth:`diversi
-00057110: 7479 0a20 2020 2020 2020 203c 2e54 7265  ty.        <.Tre
-00057120: 6553 6571 7565 6e63 652e 6469 7665 7273  eSequence.divers
-00057130: 6974 793e 6020 616e 6420 3a6d 6574 683a  ity>` and :meth:
-00057140: 6073 6567 7265 6761 7469 6e67 2073 6974  `segregating sit
-00057150: 6573 0a20 2020 2020 2020 203c 2e54 7265  es.        <.Tre
-00057160: 6553 6571 7565 6e63 652e 7365 6772 6567  eSequence.segreg
-00057170: 6174 696e 675f 7369 7465 733e 602c 2072  ating_sites>`, r
-00057180: 6573 7065 6374 6976 656c 792c 2062 6f74  espectively, bot
-00057190: 6820 6e6f 7420 7370 616e 0a20 2020 2020  h not span.     
-000571a0: 2020 206e 6f72 6d61 6c69 7365 6429 2c20     normalised), 
-000571b0: 7468 656e 2054 616a 696d 6127 7320 4420  then Tajima's D 
-000571c0: 6973 0a0a 2020 2020 2020 2020 2e2e 2063  is..        .. c
-000571d0: 6f64 652d 626c 6f63 6b3a 3a20 7079 7468  ode-block:: pyth
-000571e0: 6f6e 0a0a 2020 2020 2020 2020 2020 2020  on..            
-000571f0: 4420 3d20 2854 202d 2053 202f 2068 2920  D = (T - S / h) 
-00057200: 2f20 7371 7274 2861 202a 2053 202b 2028  / sqrt(a * S + (
-00057210: 6220 2f20 6329 202a 2053 202a 2028 5320  b / c) * S * (S 
-00057220: 2d20 3129 290a 2020 2020 2020 2020 2020  - 1)).          
-00057230: 2020 6820 3d20 3120 2b20 3120 2f20 3220    h = 1 + 1 / 2 
-00057240: 2b20 2e2e 2e20 2b20 3120 2f20 286e 202d  + ... + 1 / (n -
-00057250: 2031 290a 2020 2020 2020 2020 2020 2020   1).            
-00057260: 6720 3d20 3120 2b20 3120 2f20 322a 2a32  g = 1 + 1 / 2**2
-00057270: 202b 202e 2e2e 202b 2031 202f 2028 6e20   + ... + 1 / (n 
-00057280: 2d20 3129 202a 2a20 320a 2020 2020 2020  - 1) ** 2.      
-00057290: 2020 2020 2020 6120 3d20 286e 202b 2031        a = (n + 1
-000572a0: 2920 2f20 2833 202a 2028 6e20 2d20 3129  ) / (3 * (n - 1)
-000572b0: 202a 2068 2920 2d20 3120 2f20 682a 2a32   * h) - 1 / h**2
-000572c0: 0a20 2020 2020 2020 2020 2020 2062 203d  .            b =
-000572d0: 2032 202a 2028 6e2a 2a32 202b 206e 202b   2 * (n**2 + n +
-000572e0: 2033 2920 2f20 2839 202a 206e 202a 2028   3) / (9 * n * (
-000572f0: 6e20 2d20 3129 2920 2d20 286e 202b 2032  n - 1)) - (n + 2
-00057300: 2920 2f20 2868 202a 206e 2920 2b20 6720  ) / (h * n) + g 
-00057310: 2f20 682a 2a32 0a20 2020 2020 2020 2020  / h**2.         
-00057320: 2020 2063 203d 2068 2a2a 3220 2b20 670a     c = h**2 + g.
-00057330: 0a20 2020 2020 2020 2057 6861 7420 6973  .        What is
-00057340: 2063 6f6d 7075 7465 6420 666f 7220 6469   computed for di
-00057350: 7665 7273 6974 7920 616e 6420 6469 7665  versity and dive
-00057360: 7267 656e 6365 2064 6570 656e 6473 206f  rgence depends o
-00057370: 6e20 6060 6d6f 6465 6060 3b0a 2020 2020  n ``mode``;.    
-00057380: 2020 2020 7365 6520 7468 6f73 6520 6675      see those fu
-00057390: 6e63 7469 6f6e 7320 666f 7220 6d6f 7265  nctions for more
-000573a0: 2064 6574 6169 6c73 2e0a 0a20 2020 2020   details...     
-000573b0: 2020 203a 7061 7261 6d20 6c69 7374 2073     :param list s
-000573c0: 616d 706c 655f 7365 7473 3a20 4120 6c69  ample_sets: A li
-000573d0: 7374 206f 6620 6c69 7374 7320 6f66 204e  st of lists of N
-000573e0: 6f64 6520 4944 732c 2073 7065 6369 6679  ode IDs, specify
-000573f0: 696e 6720 7468 650a 2020 2020 2020 2020  ing the.        
-00057400: 2020 2020 6772 6f75 7073 206f 6620 6e6f      groups of no
-00057410: 6465 7320 746f 2063 6f6d 7075 7465 2074  des to compute t
-00057420: 6865 2073 7461 7469 7374 6963 2077 6974  he statistic wit
-00057430: 682e 0a20 2020 2020 2020 203a 7061 7261  h..        :para
-00057440: 6d20 6c69 7374 2069 6e64 6578 6573 3a20  m list indexes: 
-00057450: 4120 6c69 7374 206f 6620 322d 7475 706c  A list of 2-tupl
-00057460: 6573 2c20 6f72 204e 6f6e 652e 0a20 2020  es, or None..   
-00057470: 2020 2020 203a 7061 7261 6d20 6c69 7374       :param list
-00057480: 2077 696e 646f 7773 3a20 416e 2069 6e63   windows: An inc
-00057490: 7265 6173 696e 6720 6c69 7374 206f 6620  reasing list of 
-000574a0: 6272 6561 6b70 6f69 6e74 7320 6265 7477  breakpoints betw
-000574b0: 6565 6e20 7468 6520 7769 6e64 6f77 730a  een the windows.
-000574c0: 2020 2020 2020 2020 2020 2020 746f 2063              to c
-000574d0: 6f6d 7075 7465 2074 6865 2073 7461 7469  ompute the stati
-000574e0: 7374 6963 2069 6e2e 0a20 2020 2020 2020  stic in..       
-000574f0: 203a 7061 7261 6d20 7374 7220 6d6f 6465   :param str mode
-00057500: 3a20 4120 7374 7269 6e67 2067 6976 696e  : A string givin
-00057510: 6720 7468 6520 2274 7970 6522 206f 6620  g the "type" of 
-00057520: 7468 6520 7374 6174 6973 7469 6320 746f  the statistic to
-00057530: 2062 6520 636f 6d70 7574 6564 0a20 2020   be computed.   
-00057540: 2020 2020 2020 2020 2028 6465 6661 756c           (defaul
-00057550: 7473 2074 6f20 2273 6974 6522 292e 0a20  ts to "site").. 
-00057560: 2020 2020 2020 203a 7265 7475 726e 3a20         :return: 
-00057570: 4120 6e64 6172 7261 7920 7769 7468 2073  A ndarray with s
-00057580: 6861 7065 2065 7175 616c 2074 6f20 286e  hape equal to (n
-00057590: 756d 2077 696e 646f 7773 2c20 6e75 6d20  um windows, num 
-000575a0: 7374 6174 6973 7469 6373 292e 0a20 2020  statistics)..   
-000575b0: 2020 2020 2020 2020 2049 6620 7468 6572           If ther
-000575c0: 6520 6973 206f 6e65 2073 616d 706c 6520  e is one sample 
-000575d0: 7365 7420 616e 6420 7769 6e64 6f77 733d  set and windows=
-000575e0: 4e6f 6e65 2c20 6120 6e75 6d70 7920 7363  None, a numpy sc
-000575f0: 616c 6172 2069 7320 7265 7475 726e 6564  alar is returned
-00057600: 2e0a 2020 2020 2020 2020 2222 220a 2020  ..        """.  
-00057610: 2020 2020 2020 2320 544f 444f 2074 6869        # TODO thi
-00057620: 7320 7368 6f75 6c64 2062 6520 646f 6e65  s should be done
-00057630: 2069 6e20 4320 6173 2077 6527 6c6c 2077   in C as we'll w
-00057640: 616e 7420 746f 2073 7570 706f 7274 2074  ant to support t
-00057650: 6869 7320 6d65 7468 6f64 2074 6865 7265  his method there
-00057660: 2e0a 2020 2020 2020 2020 6465 6620 746a  ..        def tj
-00057670: 645f 6675 6e63 2873 616d 706c 655f 7365  d_func(sample_se
-00057680: 745f 7369 7a65 732c 2066 6c61 7474 656e  t_sizes, flatten
-00057690: 6564 2c20 2a2a 6b77 6172 6773 293a 0a20  ed, **kwargs):. 
-000576a0: 2020 2020 2020 2020 2020 206e 203d 2073             n = s
-000576b0: 616d 706c 655f 7365 745f 7369 7a65 730a  ample_set_sizes.
-000576c0: 2020 2020 2020 2020 2020 2020 5420 3d20              T = 
-000576d0: 7365 6c66 2e6c 6c5f 7472 6565 5f73 6571  self.ll_tree_seq
-000576e0: 7565 6e63 652e 6469 7665 7273 6974 7928  uence.diversity(
-000576f0: 6e2c 2066 6c61 7474 656e 6564 2c20 2a2a  n, flattened, **
-00057700: 6b77 6172 6773 290a 2020 2020 2020 2020  kwargs).        
-00057710: 2020 2020 5320 3d20 7365 6c66 2e6c 6c5f      S = self.ll_
-00057720: 7472 6565 5f73 6571 7565 6e63 652e 7365  tree_sequence.se
-00057730: 6772 6567 6174 696e 675f 7369 7465 7328  gregating_sites(
-00057740: 6e2c 2066 6c61 7474 656e 6564 2c20 2a2a  n, flattened, **
-00057750: 6b77 6172 6773 290a 2020 2020 2020 2020  kwargs).        
-00057760: 2020 2020 6820 3d20 6e70 2e61 7272 6179      h = np.array
-00057770: 285b 6e70 2e73 756d 2831 202f 206e 702e  ([np.sum(1 / np.
-00057780: 6172 616e 6765 2831 2c20 6e6e 2929 2066  arange(1, nn)) f
-00057790: 6f72 206e 6e20 696e 206e 5d29 0a20 2020  or nn in n]).   
-000577a0: 2020 2020 2020 2020 2067 203d 206e 702e           g = np.
-000577b0: 6172 7261 7928 5b6e 702e 7375 6d28 3120  array([np.sum(1 
-000577c0: 2f20 6e70 2e61 7261 6e67 6528 312c 206e  / np.arange(1, n
-000577d0: 6e29 202a 2a20 3229 2066 6f72 206e 6e20  n) ** 2) for nn 
-000577e0: 696e 206e 5d29 0a20 2020 2020 2020 2020  in n]).         
-000577f0: 2020 2077 6974 6820 6e70 2e65 7272 7374     with np.errst
-00057800: 6174 6528 696e 7661 6c69 643d 2269 676e  ate(invalid="ign
-00057810: 6f72 6522 2c20 6469 7669 6465 3d22 6967  ore", divide="ig
-00057820: 6e6f 7265 2229 3a0a 2020 2020 2020 2020  nore"):.        
-00057830: 2020 2020 2020 2020 6120 3d20 286e 202b          a = (n +
-00057840: 2031 2920 2f20 2833 202a 2028 6e20 2d20   1) / (3 * (n - 
-00057850: 3129 202a 2068 2920 2d20 3120 2f20 682a  1) * h) - 1 / h*
-00057860: 2a32 0a20 2020 2020 2020 2020 2020 2020  *2.             
-00057870: 2020 2062 203d 2028 0a20 2020 2020 2020     b = (.       
-00057880: 2020 2020 2020 2020 2020 2020 2032 202a               2 *
-00057890: 2028 6e2a 2a32 202b 206e 202b 2033 2920   (n**2 + n + 3) 
-000578a0: 2f20 2839 202a 206e 202a 2028 6e20 2d20  / (9 * n * (n - 
-000578b0: 3129 290a 2020 2020 2020 2020 2020 2020  1)).            
-000578c0: 2020 2020 2020 2020 2d20 286e 202b 2032          - (n + 2
-000578d0: 2920 2f20 2868 202a 206e 290a 2020 2020  ) / (h * n).    
-000578e0: 2020 2020 2020 2020 2020 2020 2020 2020                  
-000578f0: 2b20 6720 2f20 682a 2a32 0a20 2020 2020  + g / h**2.     
-00057900: 2020 2020 2020 2020 2020 2029 0a20 2020             ).   
-00057910: 2020 2020 2020 2020 2020 2020 2044 203d               D =
-00057920: 2028 5420 2d20 5320 2f20 6829 202f 206e   (T - S / h) / n
-00057930: 702e 7371 7274 2861 202a 2053 202b 2028  p.sqrt(a * S + (
-00057940: 6220 2f20 2868 2a2a 3220 2b20 6729 2920  b / (h**2 + g)) 
-00057950: 2a20 5320 2a20 2853 202d 2031 2929 0a20  * S * (S - 1)). 
-00057960: 2020 2020 2020 2020 2020 2072 6574 7572             retur
-00057970: 6e20 440a 0a20 2020 2020 2020 2072 6574  n D..        ret
-00057980: 7572 6e20 7365 6c66 2e5f 5f6f 6e65 5f77  urn self.__one_w
-00057990: 6179 5f73 616d 706c 655f 7365 745f 7374  ay_sample_set_st
-000579a0: 6174 280a 2020 2020 2020 2020 2020 2020  at(.            
-000579b0: 746a 645f 6675 6e63 2c20 7361 6d70 6c65  tjd_func, sample
-000579c0: 5f73 6574 732c 2077 696e 646f 7773 3d77  _sets, windows=w
-000579d0: 696e 646f 7773 2c20 6d6f 6465 3d6d 6f64  indows, mode=mod
-000579e0: 652c 2073 7061 6e5f 6e6f 726d 616c 6973  e, span_normalis
-000579f0: 653d 4661 6c73 650a 2020 2020 2020 2020  e=False.        
-00057a00: 290a 0a20 2020 2064 6566 2046 7374 280a  )..    def Fst(.
-00057a10: 2020 2020 2020 2020 7365 6c66 2c20 7361          self, sa
-00057a20: 6d70 6c65 5f73 6574 732c 2069 6e64 6578  mple_sets, index
-00057a30: 6573 3d4e 6f6e 652c 2077 696e 646f 7773  es=None, windows
-00057a40: 3d4e 6f6e 652c 206d 6f64 653d 2273 6974  =None, mode="sit
-00057a50: 6522 2c20 7370 616e 5f6e 6f72 6d61 6c69  e", span_normali
-00057a60: 7365 3d54 7275 650a 2020 2020 293a 0a20  se=True.    ):. 
-00057a70: 2020 2020 2020 2022 2222 0a20 2020 2020         """.     
-00057a80: 2020 2043 6f6d 7075 7465 7320 2277 696e     Computes "win
-00057a90: 646f 7765 6422 2046 7374 2062 6574 7765  dowed" Fst betwe
-00057aa0: 656e 2070 6169 7273 206f 6620 7365 7473  en pairs of sets
-00057ab0: 206f 6620 6e6f 6465 7320 6672 6f6d 2060   of nodes from `
-00057ac0: 6073 616d 706c 655f 7365 7473 6060 2e0a  `sample_sets``..
-00057ad0: 2020 2020 2020 2020 4f70 6572 6174 6573          Operates
-00057ae0: 206f 6e20 6060 6b20 3d20 3260 6020 7361   on ``k = 2`` sa
-00057af0: 6d70 6c65 2073 6574 7320 6174 2061 2074  mple sets at a t
-00057b00: 696d 653b 2070 6c65 6173 6520 7365 6520  ime; please see 
-00057b10: 7468 650a 2020 2020 2020 2020 3a72 6566  the.        :ref
-00057b20: 3a60 6d75 6c74 692d 7761 7920 7374 6174  :`multi-way stat
-00057b30: 6973 7469 6373 203c 7365 635f 7374 6174  istics <sec_stat
-00057b40: 735f 7361 6d70 6c65 5f73 6574 735f 6d75  s_sample_sets_mu
-00057b50: 6c74 695f 7761 793e 600a 2020 2020 2020  lti_way>`.      
-00057b60: 2020 7365 6374 696f 6e20 666f 7220 6465    section for de
-00057b70: 7461 696c 7320 6f6e 2068 6f77 2074 6865  tails on how the
-00057b80: 2060 6073 616d 706c 655f 7365 7473 6060   ``sample_sets``
-00057b90: 2061 6e64 2060 6069 6e64 6578 6573 6060   and ``indexes``
-00057ba0: 2061 7267 756d 656e 7473 2061 7265 0a20   arguments are. 
-00057bb0: 2020 2020 2020 2069 6e74 6572 7072 6574         interpret
-00057bc0: 6564 2061 6e64 2068 6f77 2074 6865 7920  ed and how they 
-00057bd0: 696e 7465 7261 6374 2077 6974 6820 7468  interact with th
-00057be0: 6520 6469 6d65 6e73 696f 6e73 206f 6620  e dimensions of 
-00057bf0: 7468 6520 6f75 7470 7574 2061 7272 6179  the output array
-00057c00: 2e0a 2020 2020 2020 2020 5365 6520 7468  ..        See th
-00057c10: 6520 3a72 6566 3a60 7374 6174 6973 7469  e :ref:`statisti
-00057c20: 6373 2069 6e74 6572 6661 6365 203c 7365  cs interface <se
-00057c30: 635f 7374 6174 735f 696e 7465 7266 6163  c_stats_interfac
-00057c40: 653e 6020 7365 6374 696f 6e20 666f 7220  e>` section for 
-00057c50: 6465 7461 696c 7320 6f6e 0a20 2020 2020  details on.     
-00057c60: 2020 203a 7265 663a 6077 696e 646f 7773     :ref:`windows
-00057c70: 203c 7365 635f 7374 6174 735f 7769 6e64   <sec_stats_wind
-00057c80: 6f77 733e 602c 0a20 2020 2020 2020 203a  ows>`,.        :
-00057c90: 7265 663a 606d 6f64 6520 3c73 6563 5f73  ref:`mode <sec_s
-00057ca0: 7461 7473 5f6d 6f64 653e 602c 0a20 2020  tats_mode>`,.   
-00057cb0: 2020 2020 203a 7265 663a 6073 7061 6e20       :ref:`span 
-00057cc0: 6e6f 726d 616c 6973 6520 3c73 6563 5f73  normalise <sec_s
-00057cd0: 7461 7473 5f73 7061 6e5f 6e6f 726d 616c  tats_span_normal
-00057ce0: 6973 653e 602c 0a20 2020 2020 2020 2061  ise>`,.        a
-00057cf0: 6e64 203a 7265 663a 6072 6574 7572 6e20  nd :ref:`return 
-00057d00: 7661 6c75 6520 3c73 6563 5f73 7461 7473  value <sec_stats
-00057d10: 5f6f 7574 7075 745f 666f 726d 6174 3e60  _output_format>`
-00057d20: 2e0a 0a20 2020 2020 2020 2046 6f72 2073  ...        For s
-00057d30: 616d 706c 6520 7365 7473 2060 6058 6060  ample sets ``X``
-00057d40: 2061 6e64 2060 6059 6060 2c20 6966 2060   and ``Y``, if `
-00057d50: 6064 2858 2c20 5929 6060 2069 7320 7468  `d(X, Y)`` is th
-00057d60: 650a 2020 2020 2020 2020 3a6d 6574 683a  e.        :meth:
-00057d70: 6064 6976 6572 6765 6e63 6520 3c2e 5472  `divergence <.Tr
-00057d80: 6565 5365 7175 656e 6365 2e64 6976 6572  eeSequence.diver
-00057d90: 6765 6e63 653e 600a 2020 2020 2020 2020  gence>`.        
-00057da0: 6265 7477 6565 6e20 6060 5860 6020 616e  between ``X`` an
-00057db0: 6420 6060 5960 602c 2061 6e64 2060 6064  d ``Y``, and ``d
-00057dc0: 2858 2960 6020 6973 2074 6865 0a20 2020  (X)`` is the.   
-00057dd0: 2020 2020 203a 6d65 7468 3a60 6469 7665       :meth:`dive
-00057de0: 7273 6974 7920 3c2e 5472 6565 5365 7175  rsity <.TreeSequ
-00057df0: 656e 6365 2e64 6976 6572 7369 7479 3e60  ence.diversity>`
-00057e00: 206f 6620 6060 5860 602c 2074 6865 6e20   of ``X``, then 
-00057e10: 7768 6174 2069 730a 2020 2020 2020 2020  what is.        
-00057e20: 636f 6d70 7574 6564 2069 730a 0a20 2020  computed is..   
-00057e30: 2020 2020 202e 2e20 636f 6465 2d62 6c6f       .. code-blo
-00057e40: 636b 3a3a 2070 7974 686f 6e0a 0a20 2020  ck:: python..   
-00057e50: 2020 2020 2020 2020 2046 7374 203d 2031           Fst = 1
-00057e60: 202d 2032 202a 2028 6428 5829 202b 2064   - 2 * (d(X) + d
-00057e70: 2859 2929 202f 2028 6428 5829 202b 2032  (Y)) / (d(X) + 2
-00057e80: 202a 2064 2858 2c20 5929 202b 2064 2859   * d(X, Y) + d(Y
-00057e90: 2929 0a0a 2020 2020 2020 2020 5768 6174  ))..        What
-00057ea0: 2069 7320 636f 6d70 7574 6564 2066 6f72   is computed for
-00057eb0: 2064 6976 6572 7369 7479 2061 6e64 2064   diversity and d
-00057ec0: 6976 6572 6765 6e63 6520 6465 7065 6e64  ivergence depend
-00057ed0: 7320 6f6e 2060 606d 6f64 6560 603b 0a20  s on ``mode``;. 
-00057ee0: 2020 2020 2020 2073 6565 2074 686f 7365         see those
-00057ef0: 2066 756e 6374 696f 6e73 2066 6f72 206d   functions for m
-00057f00: 6f72 6520 6465 7461 696c 732e 0a0a 2020  ore details...  
-00057f10: 2020 2020 2020 3a70 6172 616d 206c 6973        :param lis
-00057f20: 7420 7361 6d70 6c65 5f73 6574 733a 2041  t sample_sets: A
-00057f30: 206c 6973 7420 6f66 206c 6973 7473 206f   list of lists o
-00057f40: 6620 4e6f 6465 2049 4473 2c20 7370 6563  f Node IDs, spec
-00057f50: 6966 7969 6e67 2074 6865 0a20 2020 2020  ifying the.     
-00057f60: 2020 2020 2020 2067 726f 7570 7320 6f66         groups of
-00057f70: 206e 6f64 6573 2074 6f20 636f 6d70 7574   nodes to comput
-00057f80: 6520 7468 6520 7374 6174 6973 7469 6320  e the statistic 
-00057f90: 7769 7468 2e0a 2020 2020 2020 2020 3a70  with..        :p
-00057fa0: 6172 616d 206c 6973 7420 696e 6465 7865  aram list indexe
-00057fb0: 733a 2041 206c 6973 7420 6f66 2032 2d74  s: A list of 2-t
-00057fc0: 7570 6c65 732e 0a20 2020 2020 2020 203a  uples..        :
-00057fd0: 7061 7261 6d20 6c69 7374 2077 696e 646f  param list windo
-00057fe0: 7773 3a20 416e 2069 6e63 7265 6173 696e  ws: An increasin
-00057ff0: 6720 6c69 7374 206f 6620 6272 6561 6b70  g list of breakp
-00058000: 6f69 6e74 7320 6265 7477 6565 6e20 7468  oints between th
-00058010: 6520 7769 6e64 6f77 730a 2020 2020 2020  e windows.      
-00058020: 2020 2020 2020 746f 2063 6f6d 7075 7465        to compute
-00058030: 2074 6865 2073 7461 7469 7374 6963 2069   the statistic i
-00058040: 6e2e 0a20 2020 2020 2020 203a 7061 7261  n..        :para
-00058050: 6d20 7374 7220 6d6f 6465 3a20 4120 7374  m str mode: A st
-00058060: 7269 6e67 2067 6976 696e 6720 7468 6520  ring giving the 
-00058070: 2274 7970 6522 206f 6620 7468 6520 7374  "type" of the st
-00058080: 6174 6973 7469 6320 746f 2062 6520 636f  atistic to be co
-00058090: 6d70 7574 6564 0a20 2020 2020 2020 2020  mputed.         
-000580a0: 2020 2028 6465 6661 756c 7473 2074 6f20     (defaults to 
-000580b0: 2273 6974 6522 292e 0a20 2020 2020 2020  "site")..       
-000580c0: 203a 7061 7261 6d20 626f 6f6c 2073 7061   :param bool spa
-000580d0: 6e5f 6e6f 726d 616c 6973 653a 2057 6865  n_normalise: Whe
-000580e0: 7468 6572 2074 6f20 6469 7669 6465 2074  ther to divide t
-000580f0: 6865 2072 6573 756c 7420 6279 2074 6865  he result by the
-00058100: 2073 7061 6e20 6f66 2074 6865 0a20 2020   span of the.   
-00058110: 2020 2020 2020 2020 2077 696e 646f 7720           window 
-00058120: 2864 6566 6175 6c74 7320 746f 2054 7275  (defaults to Tru
-00058130: 6529 2e0a 2020 2020 2020 2020 3a72 6574  e)..        :ret
-00058140: 7572 6e3a 2041 206e 6461 7272 6179 2077  urn: A ndarray w
-00058150: 6974 6820 7368 6170 6520 6571 7561 6c20  ith shape equal 
-00058160: 746f 2028 6e75 6d20 7769 6e64 6f77 732c  to (num windows,
-00058170: 206e 756d 2073 7461 7469 7374 6963 7329   num statistics)
-00058180: 2e0a 2020 2020 2020 2020 2020 2020 4966  ..            If
-00058190: 2074 6865 7265 2069 7320 6f6e 6520 7061   there is one pa
-000581a0: 6972 206f 6620 7361 6d70 6c65 2073 6574  ir of sample set
-000581b0: 7320 616e 6420 7769 6e64 6f77 733d 4e6f  s and windows=No
-000581c0: 6e65 2c20 6120 6e75 6d70 7920 7363 616c  ne, a numpy scal
-000581d0: 6172 2069 730a 2020 2020 2020 2020 2020  ar is.          
-000581e0: 2020 7265 7475 726e 6564 2e0a 2020 2020    returned..    
-000581f0: 2020 2020 2222 220a 2020 2020 2020 2020      """.        
-00058200: 2320 544f 444f 2074 6869 7320 7368 6f75  # TODO this shou
-00058210: 6c64 2072 6561 6c6c 7920 6265 2069 6d70  ld really be imp
-00058220: 6c65 6d65 6e74 6564 2069 6e20 4320 2870  lemented in C (p
-00058230: 7265 7375 6d61 626c 7920 4320 7072 6f67  resumably C prog
-00058240: 7261 6d6d 6572 7320 7769 6c6c 2077 616e  rammers will wan
-00058250: 740a 2020 2020 2020 2020 2320 746f 2063  t.        # to c
-00058260: 6f6d 7075 7465 2046 7374 2074 6f6f 292c  ompute Fst too),
-00058270: 2062 7574 2069 6e20 7468 6520 6d65 616e   but in the mean
-00058280: 2074 696d 6520 696d 706c 656d 656e 7469   time implementi
-00058290: 6e67 2075 7369 6e67 2074 6865 206c 6f77  ng using the low
-000582a0: 2d6c 6576 656c 0a20 2020 2020 2020 2023  -level.        #
-000582b0: 2063 616c 6c73 2068 6173 2074 776f 2061   calls has two a
-000582c0: 6476 616e 7461 6765 733a 2028 6129 2077  dvantages: (a) w
-000582d0: 6520 6175 746f 6d61 7469 6361 6c6c 7920  e automatically 
-000582e0: 6368 616e 6765 2064 696d 656e 7369 6f6e  change dimension
-000582f0: 7320 6c69 6b65 2074 6865 206f 7468 6572  s like the other
-00058300: 0a20 2020 2020 2020 2023 2074 776f 2d77  .        # two-w
-00058310: 6179 2073 7461 7473 2061 6e64 2028 6229  ay stats and (b)
-00058320: 2069 7427 7320 6120 6269 7420 6d6f 7265   it's a bit more
-00058330: 2065 6666 6963 6965 6e74 2062 6563 6175   efficient becau
-00058340: 7365 2077 6527 7265 206e 6f74 206d 6573  se we're not mes
-00058350: 7369 6e67 0a20 2020 2020 2020 2023 2061  sing.        # a
-00058360: 726f 756e 6420 7769 7468 2069 6e64 6578  round with index
-00058370: 6573 2061 6e64 2073 616d 706c 6573 2073  es and samples s
-00058380: 6574 7320 7477 6963 652e 0a0a 2020 2020  ets twice...    
-00058390: 2020 2020 6465 6620 6673 745f 6675 6e63      def fst_func
-000583a0: 2873 616d 706c 655f 7365 745f 7369 7a65  (sample_set_size
-000583b0: 732c 2066 6c61 7474 656e 6564 2c20 696e  s, flattened, in
-000583c0: 6465 7865 732c 202a 2a6b 7761 7267 7329  dexes, **kwargs)
-000583d0: 3a0a 2020 2020 2020 2020 2020 2020 6469  :.            di
-000583e0: 7665 7273 6974 6965 7320 3d20 7365 6c66  versities = self
-000583f0: 2e5f 6c6c 5f74 7265 655f 7365 7175 656e  ._ll_tree_sequen
-00058400: 6365 2e64 6976 6572 7369 7479 280a 2020  ce.diversity(.  
-00058410: 2020 2020 2020 2020 2020 2020 2020 7361                sa
-00058420: 6d70 6c65 5f73 6574 5f73 697a 6573 2c20  mple_set_sizes, 
-00058430: 666c 6174 7465 6e65 642c 202a 2a6b 7761  flattened, **kwa
-00058440: 7267 730a 2020 2020 2020 2020 2020 2020  rgs.            
-00058450: 290a 2020 2020 2020 2020 2020 2020 6469  ).            di
-00058460: 7665 7267 656e 6365 7320 3d20 7365 6c66  vergences = self
-00058470: 2e5f 6c6c 5f74 7265 655f 7365 7175 656e  ._ll_tree_sequen
-00058480: 6365 2e64 6976 6572 6765 6e63 6528 0a20  ce.divergence(. 
-00058490: 2020 2020 2020 2020 2020 2020 2020 2073                 s
-000584a0: 616d 706c 655f 7365 745f 7369 7a65 732c  ample_set_sizes,
-000584b0: 2066 6c61 7474 656e 6564 2c20 696e 6465   flattened, inde
-000584c0: 7865 732c 202a 2a6b 7761 7267 730a 2020  xes, **kwargs.  
-000584d0: 2020 2020 2020 2020 2020 290a 0a20 2020            )..   
-000584e0: 2020 2020 2020 2020 206f 7269 675f 7368           orig_sh
-000584f0: 6170 6520 3d20 6469 7665 7267 656e 6365  ape = divergence
-00058500: 732e 7368 6170 650a 2020 2020 2020 2020  s.shape.        
-00058510: 2020 2020 2320 226e 6f64 6522 2073 7461      # "node" sta
-00058520: 7469 7374 6963 7320 7072 6f64 7563 6520  tistics produce 
-00058530: 6120 3344 2061 7272 6179 0a20 2020 2020  a 3D array.     
-00058540: 2020 2020 2020 2069 6620 6c65 6e28 6469         if len(di
-00058550: 7665 7267 656e 6365 732e 7368 6170 6529  vergences.shape)
-00058560: 203d 3d20 323a 0a20 2020 2020 2020 2020   == 2:.         
-00058570: 2020 2020 2020 2064 6976 6572 6765 6e63         divergenc
-00058580: 6573 2e73 6861 7065 203d 2028 6469 7665  es.shape = (dive
-00058590: 7267 656e 6365 732e 7368 6170 655b 305d  rgences.shape[0]
-000585a0: 2c20 312c 2064 6976 6572 6765 6e63 6573  , 1, divergences
-000585b0: 2e73 6861 7065 5b31 5d29 0a20 2020 2020  .shape[1]).     
-000585c0: 2020 2020 2020 2020 2020 2064 6976 6572             diver
-000585d0: 7369 7469 6573 2e73 6861 7065 203d 2028  sities.shape = (
-000585e0: 6469 7665 7273 6974 6965 732e 7368 6170  diversities.shap
-000585f0: 655b 305d 2c20 312c 2064 6976 6572 7369  e[0], 1, diversi
-00058600: 7469 6573 2e73 6861 7065 5b31 5d29 0a0a  ties.shape[1])..
-00058610: 2020 2020 2020 2020 2020 2020 6673 7420              fst 
-00058620: 3d20 6e70 2e72 6570 6561 7428 312e 302c  = np.repeat(1.0,
-00058630: 206e 702e 7072 6f64 7563 7428 6469 7665   np.product(dive
-00058640: 7267 656e 6365 732e 7368 6170 6529 290a  rgences.shape)).
-00058650: 2020 2020 2020 2020 2020 2020 6673 742e              fst.
-00058660: 7368 6170 6520 3d20 6469 7665 7267 656e  shape = divergen
-00058670: 6365 732e 7368 6170 650a 2020 2020 2020  ces.shape.      
-00058680: 2020 2020 2020 666f 7220 692c 2028 752c        for i, (u,
-00058690: 2076 2920 696e 2065 6e75 6d65 7261 7465   v) in enumerate
-000586a0: 2869 6e64 6578 6573 293a 0a20 2020 2020  (indexes):.     
-000586b0: 2020 2020 2020 2020 2020 2064 656e 6f6d             denom
-000586c0: 203d 2028 0a20 2020 2020 2020 2020 2020   = (.           
-000586d0: 2020 2020 2020 2020 2064 6976 6572 7369           diversi
-000586e0: 7469 6573 5b3a 2c20 3a2c 2075 5d0a 2020  ties[:, :, u].  
-000586f0: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00058700: 2020 2b20 6469 7665 7273 6974 6965 735b    + diversities[
-00058710: 3a2c 203a 2c20 765d 0a20 2020 2020 2020  :, :, v].       
-00058720: 2020 2020 2020 2020 2020 2020 202b 2032               + 2
-00058730: 202a 2064 6976 6572 6765 6e63 6573 5b3a   * divergences[:
-00058740: 2c20 3a2c 2069 5d0a 2020 2020 2020 2020  , :, i].        
-00058750: 2020 2020 2020 2020 290a 2020 2020 2020          ).      
-00058760: 2020 2020 2020 2020 2020 7769 7468 206e            with n
-00058770: 702e 6572 7273 7461 7465 2864 6976 6964  p.errstate(divid
-00058780: 653d 2269 676e 6f72 6522 2c20 696e 7661  e="ignore", inva
-00058790: 6c69 643d 2269 676e 6f72 6522 293a 0a20  lid="ignore"):. 
-000587a0: 2020 2020 2020 2020 2020 2020 2020 2020                  
-000587b0: 2020 2066 7374 5b3a 2c20 3a2c 2069 5d20     fst[:, :, i] 
-000587c0: 2d3d 2028 0a20 2020 2020 2020 2020 2020  -= (.           
-000587d0: 2020 2020 2020 2020 2020 2020 2032 202a               2 *
-000587e0: 2028 6469 7665 7273 6974 6965 735b 3a2c   (diversities[:,
-000587f0: 203a 2c20 755d 202b 2064 6976 6572 7369   :, u] + diversi
-00058800: 7469 6573 5b3a 2c20 3a2c 2076 5d29 202f  ties[:, :, v]) /
-00058810: 2064 656e 6f6d 0a20 2020 2020 2020 2020   denom.         
-00058820: 2020 2020 2020 2020 2020 2029 0a20 2020             ).   
-00058830: 2020 2020 2020 2020 2066 7374 2e73 6861           fst.sha
-00058840: 7065 203d 206f 7269 675f 7368 6170 650a  pe = orig_shape.
-00058850: 2020 2020 2020 2020 2020 2020 7265 7475              retu
-00058860: 726e 2066 7374 0a0a 2020 2020 2020 2020  rn fst..        
-00058870: 7265 7475 726e 2073 656c 662e 5f5f 6b5f  return self.__k_
-00058880: 7761 795f 7361 6d70 6c65 5f73 6574 5f73  way_sample_set_s
-00058890: 7461 7428 0a20 2020 2020 2020 2020 2020  tat(.           
-000588a0: 2066 7374 5f66 756e 632c 0a20 2020 2020   fst_func,.     
-000588b0: 2020 2020 2020 2032 2c0a 2020 2020 2020         2,.      
-000588c0: 2020 2020 2020 7361 6d70 6c65 5f73 6574        sample_set
-000588d0: 732c 0a20 2020 2020 2020 2020 2020 2069  s,.            i
-000588e0: 6e64 6578 6573 3d69 6e64 6578 6573 2c0a  ndexes=indexes,.
-000588f0: 2020 2020 2020 2020 2020 2020 7769 6e64              wind
-00058900: 6f77 733d 7769 6e64 6f77 732c 0a20 2020  ows=windows,.   
-00058910: 2020 2020 2020 2020 206d 6f64 653d 6d6f           mode=mo
-00058920: 6465 2c0a 2020 2020 2020 2020 2020 2020  de,.            
-00058930: 7370 616e 5f6e 6f72 6d61 6c69 7365 3d73  span_normalise=s
-00058940: 7061 6e5f 6e6f 726d 616c 6973 652c 0a20  pan_normalise,. 
-00058950: 2020 2020 2020 2029 0a0a 2020 2020 6465         )..    de
-00058960: 6620 5933 280a 2020 2020 2020 2020 7365  f Y3(.        se
-00058970: 6c66 2c20 7361 6d70 6c65 5f73 6574 732c  lf, sample_sets,
-00058980: 2069 6e64 6578 6573 3d4e 6f6e 652c 2077   indexes=None, w
-00058990: 696e 646f 7773 3d4e 6f6e 652c 206d 6f64  indows=None, mod
-000589a0: 653d 2273 6974 6522 2c20 7370 616e 5f6e  e="site", span_n
-000589b0: 6f72 6d61 6c69 7365 3d54 7275 650a 2020  ormalise=True.  
-000589c0: 2020 293a 0a20 2020 2020 2020 2022 2222    ):.        """
-000589d0: 0a20 2020 2020 2020 2043 6f6d 7075 7465  .        Compute
-000589e0: 7320 7468 6520 2759 2720 7374 6174 6973  s the 'Y' statis
-000589f0: 7469 6320 6265 7477 6565 6e20 7472 6970  tic between trip
-00058a00: 6c65 7320 6f66 2073 6574 7320 6f66 206e  les of sets of n
-00058a10: 6f64 6573 2066 726f 6d20 6060 7361 6d70  odes from ``samp
-00058a20: 6c65 5f73 6574 7360 602e 0a20 2020 2020  le_sets``..     
-00058a30: 2020 204f 7065 7261 7465 7320 6f6e 2060     Operates on `
-00058a40: 606b 203d 2033 6060 2073 616d 706c 6520  `k = 3`` sample 
-00058a50: 7365 7473 2061 7420 6120 7469 6d65 3b20  sets at a time; 
-00058a60: 706c 6561 7365 2073 6565 2074 6865 0a20  please see the. 
-00058a70: 2020 2020 2020 203a 7265 663a 606d 756c         :ref:`mul
-00058a80: 7469 2d77 6179 2073 7461 7469 7374 6963  ti-way statistic
-00058a90: 7320 3c73 6563 5f73 7461 7473 5f73 616d  s <sec_stats_sam
-00058aa0: 706c 655f 7365 7473 5f6d 756c 7469 5f77  ple_sets_multi_w
-00058ab0: 6179 3e60 0a20 2020 2020 2020 2073 6563  ay>`.        sec
-00058ac0: 7469 6f6e 2066 6f72 2064 6574 6169 6c73  tion for details
-00058ad0: 206f 6e20 686f 7720 7468 6520 6060 7361   on how the ``sa
-00058ae0: 6d70 6c65 5f73 6574 7360 6020 616e 6420  mple_sets`` and 
-00058af0: 6060 696e 6465 7865 7360 6020 6172 6775  ``indexes`` argu
-00058b00: 6d65 6e74 7320 6172 650a 2020 2020 2020  ments are.      
-00058b10: 2020 696e 7465 7270 7265 7465 6420 616e    interpreted an
-00058b20: 6420 686f 7720 7468 6579 2069 6e74 6572  d how they inter
-00058b30: 6163 7420 7769 7468 2074 6865 2064 696d  act with the dim
-00058b40: 656e 7369 6f6e 7320 6f66 2074 6865 206f  ensions of the o
-00058b50: 7574 7075 7420 6172 7261 792e 0a20 2020  utput array..   
-00058b60: 2020 2020 2053 6565 2074 6865 203a 7265       See the :re
-00058b70: 663a 6073 7461 7469 7374 6963 7320 696e  f:`statistics in
-00058b80: 7465 7266 6163 6520 3c73 6563 5f73 7461  terface <sec_sta
-00058b90: 7473 5f69 6e74 6572 6661 6365 3e60 2073  ts_interface>` s
-00058ba0: 6563 7469 6f6e 2066 6f72 2064 6574 6169  ection for detai
-00058bb0: 6c73 206f 6e0a 2020 2020 2020 2020 3a72  ls on.        :r
-00058bc0: 6566 3a60 7769 6e64 6f77 7320 3c73 6563  ef:`windows <sec
-00058bd0: 5f73 7461 7473 5f77 696e 646f 7773 3e60  _stats_windows>`
-00058be0: 2c0a 2020 2020 2020 2020 3a72 6566 3a60  ,.        :ref:`
-00058bf0: 6d6f 6465 203c 7365 635f 7374 6174 735f  mode <sec_stats_
-00058c00: 6d6f 6465 3e60 2c0a 2020 2020 2020 2020  mode>`,.        
-00058c10: 3a72 6566 3a60 7370 616e 206e 6f72 6d61  :ref:`span norma
-00058c20: 6c69 7365 203c 7365 635f 7374 6174 735f  lise <sec_stats_
-00058c30: 7370 616e 5f6e 6f72 6d61 6c69 7365 3e60  span_normalise>`
-00058c40: 2c0a 2020 2020 2020 2020 616e 6420 3a72  ,.        and :r
-00058c50: 6566 3a60 7265 7475 726e 2076 616c 7565  ef:`return value
-00058c60: 203c 7365 635f 7374 6174 735f 6f75 7470   <sec_stats_outp
-00058c70: 7574 5f66 6f72 6d61 743e 602e 0a0a 2020  ut_format>`...  
-00058c80: 2020 2020 2020 5768 6174 2069 7320 636f        What is co
-00058c90: 6d70 7574 6564 2064 6570 656e 6473 206f  mputed depends o
-00058ca0: 6e20 6060 6d6f 6465 6060 2e20 4561 6368  n ``mode``. Each
-00058cb0: 2069 7320 616e 2061 7665 7261 6765 2061   is an average a
-00058cc0: 6372 6f73 7320 6576 6572 790a 2020 2020  cross every.    
-00058cd0: 2020 2020 636f 6d62 696e 6174 696f 6e20      combination 
-00058ce0: 6f66 2074 7269 6f73 206f 6620 7361 6d70  of trios of samp
-00058cf0: 6c65 7320 6060 2861 2c20 622c 2063 2960  les ``(a, b, c)`
-00058d00: 602c 206f 6e65 2063 686f 7365 6e20 6672  `, one chosen fr
-00058d10: 6f6d 2065 6163 6820 7361 6d70 6c65 2073  om each sample s
-00058d20: 6574 3a0a 0a20 2020 2020 2020 2022 7369  et:..        "si
-00058d30: 7465 220a 2020 2020 2020 2020 2020 2020  te".            
-00058d40: 5468 6520 6176 6572 6167 6520 6465 6e73  The average dens
-00058d50: 6974 7920 6f66 2073 6974 6573 2061 7420  ity of sites at 
-00058d60: 7768 6963 6820 6060 6160 6020 6469 6666  which ``a`` diff
-00058d70: 6572 7320 6672 6f6d 2060 6062 6060 2061  ers from ``b`` a
-00058d80: 6e64 0a20 2020 2020 2020 2020 2020 2060  nd.            `
-00058d90: 6063 6060 2c20 7065 7220 756e 6974 206f  `c``, per unit o
-00058da0: 6620 6368 726f 6d6f 736f 6d65 206c 656e  f chromosome len
-00058db0: 6774 682e 0a0a 2020 2020 2020 2020 2262  gth...        "b
-00058dc0: 7261 6e63 6822 0a20 2020 2020 2020 2020  ranch".         
-00058dd0: 2020 2054 6865 2061 7665 7261 6765 206c     The average l
-00058de0: 656e 6774 6820 6f66 2061 6c6c 2062 7261  ength of all bra
-00058df0: 6e63 6865 7320 7468 6174 2073 6570 6172  nches that separ
-00058e00: 6174 6520 6060 6160 6020 6672 6f6d 2060  ate ``a`` from `
-00058e10: 6062 6060 0a20 2020 2020 2020 2020 2020  `b``.           
-00058e20: 2061 6e64 2060 6063 6060 2028 696e 2075   and ``c`` (in u
-00058e30: 6e69 7473 206f 6620 7469 6d65 292e 0a0a  nits of time)...
-00058e40: 2020 2020 2020 2020 226e 6f64 6522 0a20          "node". 
-00058e50: 2020 2020 2020 2020 2020 2046 6f72 2065             For e
-00058e60: 6163 6820 6e6f 6465 2c20 7468 6520 6176  ach node, the av
-00058e70: 6572 6167 6520 7072 6f70 6f72 7469 6f6e  erage proportion
-00058e80: 206f 6620 7468 6520 7769 6e64 6f77 206f   of the window o
-00058e90: 6e20 7768 6963 6820 6060 6160 600a 2020  n which ``a``.  
-00058ea0: 2020 2020 2020 2020 2020 696e 6865 7269            inheri
-00058eb0: 7473 2066 726f 6d20 7468 6174 206e 6f64  ts from that nod
-00058ec0: 6520 6275 7420 6060 6260 6020 616e 6420  e but ``b`` and 
-00058ed0: 6060 6360 6020 646f 206e 6f74 2c20 6f72  ``c`` do not, or
-00058ee0: 2076 6963 652d 7665 7273 612e 0a0a 2020   vice-versa...  
-00058ef0: 2020 2020 2020 3a70 6172 616d 206c 6973        :param lis
-00058f00: 7420 7361 6d70 6c65 5f73 6574 733a 2041  t sample_sets: A
-00058f10: 206c 6973 7420 6f66 206c 6973 7473 206f   list of lists o
-00058f20: 6620 4e6f 6465 2049 4473 2c20 7370 6563  f Node IDs, spec
-00058f30: 6966 7969 6e67 2074 6865 0a20 2020 2020  ifying the.     
-00058f40: 2020 2020 2020 2067 726f 7570 7320 6f66         groups of
-00058f50: 206e 6f64 6573 2074 6f20 636f 6d70 7574   nodes to comput
-00058f60: 6520 7468 6520 7374 6174 6973 7469 6320  e the statistic 
-00058f70: 7769 7468 2e0a 2020 2020 2020 2020 3a70  with..        :p
-00058f80: 6172 616d 206c 6973 7420 696e 6465 7865  aram list indexe
-00058f90: 733a 2041 206c 6973 7420 6f66 2033 2d74  s: A list of 3-t
-00058fa0: 7570 6c65 732c 206f 7220 4e6f 6e65 2e0a  uples, or None..
-00058fb0: 2020 2020 2020 2020 3a70 6172 616d 206c          :param l
-00058fc0: 6973 7420 7769 6e64 6f77 733a 2041 6e20  ist windows: An 
-00058fd0: 696e 6372 6561 7369 6e67 206c 6973 7420  increasing list 
-00058fe0: 6f66 2062 7265 616b 706f 696e 7473 2062  of breakpoints b
-00058ff0: 6574 7765 656e 2074 6865 2077 696e 646f  etween the windo
-00059000: 7773 0a20 2020 2020 2020 2020 2020 2074  ws.            t
-00059010: 6f20 636f 6d70 7574 6520 7468 6520 7374  o compute the st
-00059020: 6174 6973 7469 6320 696e 2e0a 2020 2020  atistic in..    
-00059030: 2020 2020 3a70 6172 616d 2073 7472 206d      :param str m
-00059040: 6f64 653a 2041 2073 7472 696e 6720 6769  ode: A string gi
-00059050: 7669 6e67 2074 6865 2022 7479 7065 2220  ving the "type" 
-00059060: 6f66 2074 6865 2073 7461 7469 7374 6963  of the statistic
-00059070: 2074 6f20 6265 2063 6f6d 7075 7465 640a   to be computed.
-00059080: 2020 2020 2020 2020 2020 2020 2864 6566              (def
-00059090: 6175 6c74 7320 746f 2022 7369 7465 2229  aults to "site")
-000590a0: 2e0a 2020 2020 2020 2020 3a70 6172 616d  ..        :param
-000590b0: 2062 6f6f 6c20 7370 616e 5f6e 6f72 6d61   bool span_norma
-000590c0: 6c69 7365 3a20 5768 6574 6865 7220 746f  lise: Whether to
-000590d0: 2064 6976 6964 6520 7468 6520 7265 7375   divide the resu
-000590e0: 6c74 2062 7920 7468 6520 7370 616e 206f  lt by the span o
-000590f0: 6620 7468 650a 2020 2020 2020 2020 2020  f the.          
-00059100: 2020 7769 6e64 6f77 2028 6465 6661 756c    window (defaul
-00059110: 7473 2074 6f20 5472 7565 292e 0a20 2020  ts to True)..   
-00059120: 2020 2020 203a 7265 7475 726e 3a20 4120       :return: A 
-00059130: 6e64 6172 7261 7920 7769 7468 2073 6861  ndarray with sha
-00059140: 7065 2065 7175 616c 2074 6f20 286e 756d  pe equal to (num
-00059150: 2077 696e 646f 7773 2c20 6e75 6d20 7374   windows, num st
-00059160: 6174 6973 7469 6373 292e 0a20 2020 2020  atistics)..     
-00059170: 2020 2020 2020 2049 6620 7468 6572 6520         If there 
-00059180: 6973 206f 6e65 2074 7269 706c 6520 6f66  is one triple of
-00059190: 2073 616d 706c 6520 7365 7473 2061 6e64   sample sets and
-000591a0: 2077 696e 646f 7773 3d4e 6f6e 652c 2061   windows=None, a
-000591b0: 206e 756d 7079 2073 6361 6c61 7220 6973   numpy scalar is
-000591c0: 0a20 2020 2020 2020 2020 2020 2072 6574  .            ret
-000591d0: 7572 6e65 642e 0a20 2020 2020 2020 2022  urned..        "
-000591e0: 2222 0a20 2020 2020 2020 2072 6574 7572  "".        retur
-000591f0: 6e20 7365 6c66 2e5f 5f6b 5f77 6179 5f73  n self.__k_way_s
-00059200: 616d 706c 655f 7365 745f 7374 6174 280a  ample_set_stat(.
-00059210: 2020 2020 2020 2020 2020 2020 7365 6c66              self
-00059220: 2e5f 6c6c 5f74 7265 655f 7365 7175 656e  ._ll_tree_sequen
-00059230: 6365 2e59 332c 0a20 2020 2020 2020 2020  ce.Y3,.         
-00059240: 2020 2033 2c0a 2020 2020 2020 2020 2020     3,.          
-00059250: 2020 7361 6d70 6c65 5f73 6574 732c 0a20    sample_sets,. 
-00059260: 2020 2020 2020 2020 2020 2069 6e64 6578             index
-00059270: 6573 3d69 6e64 6578 6573 2c0a 2020 2020  es=indexes,.    
-00059280: 2020 2020 2020 2020 7769 6e64 6f77 733d          windows=
-00059290: 7769 6e64 6f77 732c 0a20 2020 2020 2020  windows,.       
-000592a0: 2020 2020 206d 6f64 653d 6d6f 6465 2c0a       mode=mode,.
-000592b0: 2020 2020 2020 2020 2020 2020 7370 616e              span
-000592c0: 5f6e 6f72 6d61 6c69 7365 3d73 7061 6e5f  _normalise=span_
-000592d0: 6e6f 726d 616c 6973 652c 0a20 2020 2020  normalise,.     
-000592e0: 2020 2029 0a0a 2020 2020 6465 6620 5932     )..    def Y2
-000592f0: 280a 2020 2020 2020 2020 7365 6c66 2c20  (.        self, 
-00059300: 7361 6d70 6c65 5f73 6574 732c 2069 6e64  sample_sets, ind
-00059310: 6578 6573 3d4e 6f6e 652c 2077 696e 646f  exes=None, windo
-00059320: 7773 3d4e 6f6e 652c 206d 6f64 653d 2273  ws=None, mode="s
-00059330: 6974 6522 2c20 7370 616e 5f6e 6f72 6d61  ite", span_norma
-00059340: 6c69 7365 3d54 7275 650a 2020 2020 293a  lise=True.    ):
-00059350: 0a20 2020 2020 2020 2022 2222 0a20 2020  .        """.   
-00059360: 2020 2020 2043 6f6d 7075 7465 7320 7468       Computes th
-00059370: 6520 2759 3227 2073 7461 7469 7374 6963  e 'Y2' statistic
-00059380: 2062 6574 7765 656e 2070 6169 7273 206f   between pairs o
-00059390: 6620 7365 7473 206f 6620 6e6f 6465 7320  f sets of nodes 
-000593a0: 6672 6f6d 2060 6073 616d 706c 655f 7365  from ``sample_se
-000593b0: 7473 6060 2e0a 2020 2020 2020 2020 4f70  ts``..        Op
-000593c0: 6572 6174 6573 206f 6e20 6060 6b20 3d20  erates on ``k = 
-000593d0: 3260 6020 7361 6d70 6c65 2073 6574 7320  2`` sample sets 
-000593e0: 6174 2061 2074 696d 653b 2070 6c65 6173  at a time; pleas
-000593f0: 6520 7365 6520 7468 650a 2020 2020 2020  e see the.      
-00059400: 2020 3a72 6566 3a60 6d75 6c74 692d 7761    :ref:`multi-wa
-00059410: 7920 7374 6174 6973 7469 6373 203c 7365  y statistics <se
-00059420: 635f 7374 6174 735f 7361 6d70 6c65 5f73  c_stats_sample_s
-00059430: 6574 735f 6d75 6c74 695f 7761 793e 600a  ets_multi_way>`.
-00059440: 2020 2020 2020 2020 7365 6374 696f 6e20          section 
-00059450: 666f 7220 6465 7461 696c 7320 6f6e 2068  for details on h
-00059460: 6f77 2074 6865 2060 6073 616d 706c 655f  ow the ``sample_
-00059470: 7365 7473 6060 2061 6e64 2060 6069 6e64  sets`` and ``ind
-00059480: 6578 6573 6060 2061 7267 756d 656e 7473  exes`` arguments
-00059490: 2061 7265 0a20 2020 2020 2020 2069 6e74   are.        int
-000594a0: 6572 7072 6574 6564 2061 6e64 2068 6f77  erpreted and how
-000594b0: 2074 6865 7920 696e 7465 7261 6374 2077   they interact w
-000594c0: 6974 6820 7468 6520 6469 6d65 6e73 696f  ith the dimensio
-000594d0: 6e73 206f 6620 7468 6520 6f75 7470 7574  ns of the output
-000594e0: 2061 7272 6179 2e0a 2020 2020 2020 2020   array..        
-000594f0: 5365 6520 7468 6520 3a72 6566 3a60 7374  See the :ref:`st
-00059500: 6174 6973 7469 6373 2069 6e74 6572 6661  atistics interfa
-00059510: 6365 203c 7365 635f 7374 6174 735f 696e  ce <sec_stats_in
-00059520: 7465 7266 6163 653e 6020 7365 6374 696f  terface>` sectio
-00059530: 6e20 666f 7220 6465 7461 696c 7320 6f6e  n for details on
-00059540: 0a20 2020 2020 2020 203a 7265 663a 6077  .        :ref:`w
-00059550: 696e 646f 7773 203c 7365 635f 7374 6174  indows <sec_stat
-00059560: 735f 7769 6e64 6f77 733e 602c 0a20 2020  s_windows>`,.   
-00059570: 2020 2020 203a 7265 663a 606d 6f64 6520       :ref:`mode 
-00059580: 3c73 6563 5f73 7461 7473 5f6d 6f64 653e  <sec_stats_mode>
-00059590: 602c 0a20 2020 2020 2020 203a 7265 663a  `,.        :ref:
-000595a0: 6073 7061 6e20 6e6f 726d 616c 6973 6520  `span normalise 
-000595b0: 3c73 6563 5f73 7461 7473 5f73 7061 6e5f  <sec_stats_span_
-000595c0: 6e6f 726d 616c 6973 653e 602c 0a20 2020  normalise>`,.   
-000595d0: 2020 2020 2061 6e64 203a 7265 663a 6072       and :ref:`r
-000595e0: 6574 7572 6e20 7661 6c75 6520 3c73 6563  eturn value <sec
-000595f0: 5f73 7461 7473 5f6f 7574 7075 745f 666f  _stats_output_fo
-00059600: 726d 6174 3e60 2e0a 0a20 2020 2020 2020  rmat>`...       
-00059610: 2057 6861 7420 6973 2063 6f6d 7075 7465   What is compute
-00059620: 6420 6465 7065 6e64 7320 6f6e 2060 606d  d depends on ``m
-00059630: 6f64 6560 602e 2045 6163 6820 6973 2063  ode``. Each is c
-00059640: 6f6d 7075 7465 6420 6578 6163 746c 7920  omputed exactly 
-00059650: 6173 0a20 2020 2020 2020 2060 6059 3360  as.        ``Y3`
-00059660: 602c 2065 7863 6570 7420 7468 6174 2074  `, except that t
-00059670: 6865 2061 7665 7261 6765 2069 7320 6163  he average is ac
-00059680: 726f 7373 2065 7665 7279 2070 6f73 7369  ross every possi
-00059690: 626c 6520 7472 696f 206f 6620 7361 6d70  ble trio of samp
-000596a0: 6c65 730a 2020 2020 2020 2020 6060 2861  les.        ``(a
-000596b0: 2c20 6231 2c20 6232 2960 602c 2077 6865  , b1, b2)``, whe
-000596c0: 7265 2060 6061 6060 2069 7320 6368 6f73  re ``a`` is chos
-000596d0: 656e 2066 726f 6d20 7468 6520 6669 7273  en from the firs
-000596e0: 7420 7361 6d70 6c65 2073 6574 2c20 616e  t sample set, an
-000596f0: 640a 2020 2020 2020 2020 6060 6231 2c20  d.        ``b1, 
-00059700: 6232 6060 2061 7265 2063 686f 7365 6e20  b2`` are chosen 
-00059710: 2877 6974 686f 7574 2072 6570 6c61 6365  (without replace
-00059720: 6d65 6e74 2920 6672 6f6d 2074 6865 2073  ment) from the s
-00059730: 6563 6f6e 6420 7361 6d70 6c65 2073 6574  econd sample set
-00059740: 2e0a 2020 2020 2020 2020 5365 6520 3a6d  ..        See :m
-00059750: 6574 683a 6059 3320 3c2e 5472 6565 5365  eth:`Y3 <.TreeSe
-00059760: 7175 656e 6365 2e59 333e 6020 666f 7220  quence.Y3>` for 
-00059770: 6d6f 7265 2064 6574 6169 6c73 2e0a 0a20  more details... 
-00059780: 2020 2020 2020 203a 7061 7261 6d20 6c69         :param li
-00059790: 7374 2073 616d 706c 655f 7365 7473 3a20  st sample_sets: 
-000597a0: 4120 6c69 7374 206f 6620 6c69 7374 7320  A list of lists 
-000597b0: 6f66 204e 6f64 6520 4944 732c 2073 7065  of Node IDs, spe
-000597c0: 6369 6679 696e 6720 7468 650a 2020 2020  cifying the.    
-000597d0: 2020 2020 2020 2020 6772 6f75 7073 206f          groups o
-000597e0: 6620 6e6f 6465 7320 746f 2063 6f6d 7075  f nodes to compu
-000597f0: 7465 2074 6865 2073 7461 7469 7374 6963  te the statistic
-00059800: 2077 6974 682e 0a20 2020 2020 2020 203a   with..        :
-00059810: 7061 7261 6d20 6c69 7374 2069 6e64 6578  param list index
-00059820: 6573 3a20 4120 6c69 7374 206f 6620 322d  es: A list of 2-
-00059830: 7475 706c 6573 2c20 6f72 204e 6f6e 652e  tuples, or None.
-00059840: 0a20 2020 2020 2020 203a 7061 7261 6d20  .        :param 
-00059850: 6c69 7374 2077 696e 646f 7773 3a20 416e  list windows: An
-00059860: 2069 6e63 7265 6173 696e 6720 6c69 7374   increasing list
-00059870: 206f 6620 6272 6561 6b70 6f69 6e74 7320   of breakpoints 
-00059880: 6265 7477 6565 6e20 7468 6520 7769 6e64  between the wind
-00059890: 6f77 730a 2020 2020 2020 2020 2020 2020  ows.            
-000598a0: 746f 2063 6f6d 7075 7465 2074 6865 2073  to compute the s
-000598b0: 7461 7469 7374 6963 2069 6e2e 0a20 2020  tatistic in..   
-000598c0: 2020 2020 203a 7061 7261 6d20 7374 7220       :param str 
-000598d0: 6d6f 6465 3a20 4120 7374 7269 6e67 2067  mode: A string g
-000598e0: 6976 696e 6720 7468 6520 2274 7970 6522  iving the "type"
-000598f0: 206f 6620 7468 6520 7374 6174 6973 7469   of the statisti
-00059900: 6320 746f 2062 6520 636f 6d70 7574 6564  c to be computed
-00059910: 0a20 2020 2020 2020 2020 2020 2028 6465  .            (de
-00059920: 6661 756c 7473 2074 6f20 2273 6974 6522  faults to "site"
-00059930: 292e 0a20 2020 2020 2020 203a 7061 7261  )..        :para
-00059940: 6d20 626f 6f6c 2073 7061 6e5f 6e6f 726d  m bool span_norm
-00059950: 616c 6973 653a 2057 6865 7468 6572 2074  alise: Whether t
-00059960: 6f20 6469 7669 6465 2074 6865 2072 6573  o divide the res
-00059970: 756c 7420 6279 2074 6865 2073 7061 6e20  ult by the span 
-00059980: 6f66 2074 6865 0a20 2020 2020 2020 2020  of the.         
-00059990: 2020 2077 696e 646f 7720 2864 6566 6175     window (defau
-000599a0: 6c74 7320 746f 2054 7275 6529 2e0a 2020  lts to True)..  
-000599b0: 2020 2020 2020 3a72 6574 7572 6e3a 2041        :return: A
-000599c0: 206e 6461 7272 6179 2077 6974 6820 7368   ndarray with sh
-000599d0: 6170 6520 6571 7561 6c20 746f 2028 6e75  ape equal to (nu
-000599e0: 6d20 7769 6e64 6f77 732c 206e 756d 2073  m windows, num s
-000599f0: 7461 7469 7374 6963 7329 2e0a 2020 2020  tatistics)..    
-00059a00: 2020 2020 2020 2020 4966 2074 6865 7265          If there
-00059a10: 2069 7320 6f6e 6520 7061 6972 206f 6620   is one pair of 
-00059a20: 7361 6d70 6c65 2073 6574 7320 616e 6420  sample sets and 
-00059a30: 7769 6e64 6f77 733d 4e6f 6e65 2c20 6120  windows=None, a 
-00059a40: 6e75 6d70 7920 7363 616c 6172 2069 730a  numpy scalar is.
-00059a50: 2020 2020 2020 2020 2020 2020 7265 7475              retu
-00059a60: 726e 6564 2e0a 2020 2020 2020 2020 2222  rned..        ""
-00059a70: 220a 2020 2020 2020 2020 7265 7475 726e  ".        return
-00059a80: 2073 656c 662e 5f5f 6b5f 7761 795f 7361   self.__k_way_sa
-00059a90: 6d70 6c65 5f73 6574 5f73 7461 7428 0a20  mple_set_stat(. 
-00059aa0: 2020 2020 2020 2020 2020 2073 656c 662e             self.
-00059ab0: 5f6c 6c5f 7472 6565 5f73 6571 7565 6e63  _ll_tree_sequenc
-00059ac0: 652e 5932 2c0a 2020 2020 2020 2020 2020  e.Y2,.          
-00059ad0: 2020 322c 0a20 2020 2020 2020 2020 2020    2,.           
-00059ae0: 2073 616d 706c 655f 7365 7473 2c0a 2020   sample_sets,.  
-00059af0: 2020 2020 2020 2020 2020 696e 6465 7865            indexe
-00059b00: 733d 696e 6465 7865 732c 0a20 2020 2020  s=indexes,.     
-00059b10: 2020 2020 2020 2077 696e 646f 7773 3d77         windows=w
-00059b20: 696e 646f 7773 2c0a 2020 2020 2020 2020  indows,.        
-00059b30: 2020 2020 6d6f 6465 3d6d 6f64 652c 0a20      mode=mode,. 
-00059b40: 2020 2020 2020 2020 2020 2073 7061 6e5f             span_
-00059b50: 6e6f 726d 616c 6973 653d 7370 616e 5f6e  normalise=span_n
-00059b60: 6f72 6d61 6c69 7365 2c0a 2020 2020 2020  ormalise,.      
-00059b70: 2020 290a 0a20 2020 2064 6566 2059 3128    )..    def Y1(
-00059b80: 7365 6c66 2c20 7361 6d70 6c65 5f73 6574  self, sample_set
-00059b90: 732c 2077 696e 646f 7773 3d4e 6f6e 652c  s, windows=None,
-00059ba0: 206d 6f64 653d 2273 6974 6522 2c20 7370   mode="site", sp
-00059bb0: 616e 5f6e 6f72 6d61 6c69 7365 3d54 7275  an_normalise=Tru
-00059bc0: 6529 3a0a 2020 2020 2020 2020 2222 220a  e):.        """.
-00059bd0: 2020 2020 2020 2020 436f 6d70 7574 6573          Computes
-00059be0: 2074 6865 2027 5931 2720 7374 6174 6973   the 'Y1' statis
-00059bf0: 7469 6320 7769 7468 696e 2065 6163 6820  tic within each 
-00059c00: 6f66 2074 6865 2073 6574 7320 6f66 206e  of the sets of n
-00059c10: 6f64 6573 2067 6976 656e 2062 790a 2020  odes given by.  
-00059c20: 2020 2020 2020 6060 7361 6d70 6c65 5f73        ``sample_s
-00059c30: 6574 7360 602e 0a20 2020 2020 2020 2050  ets``..        P
-00059c40: 6c65 6173 6520 7365 6520 7468 6520 3a72  lease see the :r
-00059c50: 6566 3a60 6f6e 652d 7761 7920 7374 6174  ef:`one-way stat
-00059c60: 6973 7469 6373 203c 7365 635f 7374 6174  istics <sec_stat
-00059c70: 735f 7361 6d70 6c65 5f73 6574 735f 6f6e  s_sample_sets_on
-00059c80: 655f 7761 793e 600a 2020 2020 2020 2020  e_way>`.        
-00059c90: 7365 6374 696f 6e20 666f 7220 6465 7461  section for deta
-00059ca0: 696c 7320 6f6e 2068 6f77 2074 6865 2060  ils on how the `
-00059cb0: 6073 616d 706c 655f 7365 7473 6060 2061  `sample_sets`` a
-00059cc0: 7267 756d 656e 7420 6973 2069 6e74 6572  rgument is inter
-00059cd0: 7072 6574 6564 0a20 2020 2020 2020 2061  preted.        a
-00059ce0: 6e64 2068 6f77 2069 7420 696e 7465 7261  nd how it intera
-00059cf0: 6374 7320 7769 7468 2074 6865 2064 696d  cts with the dim
-00059d00: 656e 7369 6f6e 7320 6f66 2074 6865 206f  ensions of the o
-00059d10: 7574 7075 7420 6172 7261 792e 0a20 2020  utput array..   
-00059d20: 2020 2020 2053 6565 2074 6865 203a 7265       See the :re
-00059d30: 663a 6073 7461 7469 7374 6963 7320 696e  f:`statistics in
-00059d40: 7465 7266 6163 6520 3c73 6563 5f73 7461  terface <sec_sta
-00059d50: 7473 5f69 6e74 6572 6661 6365 3e60 2073  ts_interface>` s
-00059d60: 6563 7469 6f6e 2066 6f72 2064 6574 6169  ection for detai
-00059d70: 6c73 206f 6e0a 2020 2020 2020 2020 3a72  ls on.        :r
-00059d80: 6566 3a60 7769 6e64 6f77 7320 3c73 6563  ef:`windows <sec
-00059d90: 5f73 7461 7473 5f77 696e 646f 7773 3e60  _stats_windows>`
-00059da0: 2c20 3a72 6566 3a60 6d6f 6465 203c 7365  , :ref:`mode <se
-00059db0: 635f 7374 6174 735f 6d6f 6465 3e60 2c0a  c_stats_mode>`,.
-00059dc0: 2020 2020 2020 2020 3a72 6566 3a60 7370          :ref:`sp
-00059dd0: 616e 206e 6f72 6d61 6c69 7365 203c 7365  an normalise <se
-00059de0: 635f 7374 6174 735f 7370 616e 5f6e 6f72  c_stats_span_nor
-00059df0: 6d61 6c69 7365 3e60 2c0a 2020 2020 2020  malise>`,.      
-00059e00: 2020 616e 6420 3a72 6566 3a60 7265 7475    and :ref:`retu
-00059e10: 726e 2076 616c 7565 203c 7365 635f 7374  rn value <sec_st
-00059e20: 6174 735f 6f75 7470 7574 5f66 6f72 6d61  ats_output_forma
-00059e30: 743e 602e 0a20 2020 2020 2020 204f 7065  t>`..        Ope
-00059e40: 7261 7465 7320 6f6e 2060 606b 203d 2031  rates on ``k = 1
-00059e50: 6060 2073 616d 706c 6520 7365 7420 6174  `` sample set at
-00059e60: 2061 2074 696d 652e 0a0a 2020 2020 2020   a time...      
-00059e70: 2020 5768 6174 2069 7320 636f 6d70 7574    What is comput
-00059e80: 6564 2064 6570 656e 6473 206f 6e20 6060  ed depends on ``
-00059e90: 6d6f 6465 6060 2e20 4561 6368 2069 7320  mode``. Each is 
-00059ea0: 636f 6d70 7574 6564 2065 7861 6374 6c79  computed exactly
-00059eb0: 2061 730a 2020 2020 2020 2020 6060 5933   as.        ``Y3
-00059ec0: 6060 2c20 6578 6365 7074 2074 6861 7420  ``, except that 
-00059ed0: 7468 6520 6176 6572 6167 6520 6973 2061  the average is a
-00059ee0: 6372 6f73 7320 6576 6572 7920 706f 7373  cross every poss
-00059ef0: 6962 6c65 2074 7269 6f20 6f66 2073 616d  ible trio of sam
-00059f00: 706c 6573 0a20 2020 2020 2020 2073 616d  ples.        sam
-00059f10: 706c 6573 2060 6028 6131 2c20 6132 2c20  ples ``(a1, a2, 
-00059f20: 6133 2960 6020 616c 6c20 6368 6f73 656e  a3)`` all chosen
-00059f30: 2077 6974 686f 7574 2072 6570 6c61 6365   without replace
-00059f40: 6d65 6e74 2066 726f 6d20 7468 6520 7361  ment from the sa
-00059f50: 6d65 0a20 2020 2020 2020 2073 616d 706c  me.        sampl
-00059f60: 6520 7365 742e 2053 6565 203a 6d65 7468  e set. See :meth
-00059f70: 3a60 5933 203c 2e54 7265 6553 6571 7565  :`Y3 <.TreeSeque
-00059f80: 6e63 652e 5933 3e60 2066 6f72 206d 6f72  nce.Y3>` for mor
-00059f90: 6520 6465 7461 696c 732e 0a0a 2020 2020  e details...    
-00059fa0: 2020 2020 3a70 6172 616d 206c 6973 7420      :param list 
-00059fb0: 7361 6d70 6c65 5f73 6574 733a 2041 206c  sample_sets: A l
-00059fc0: 6973 7420 6f66 206c 6973 7473 206f 6620  ist of lists of 
-00059fd0: 4e6f 6465 2049 4473 2c20 7370 6563 6966  Node IDs, specif
-00059fe0: 7969 6e67 2074 6865 0a20 2020 2020 2020  ying the.       
-00059ff0: 2020 2020 2067 726f 7570 7320 6f66 206e       groups of n
-0005a000: 6f64 6573 2074 6f20 636f 6d70 7574 6520  odes to compute 
-0005a010: 7468 6520 7374 6174 6973 7469 6320 7769  the statistic wi
-0005a020: 7468 2e0a 2020 2020 2020 2020 3a70 6172  th..        :par
-0005a030: 616d 206c 6973 7420 7769 6e64 6f77 733a  am list windows:
-0005a040: 2041 6e20 696e 6372 6561 7369 6e67 206c   An increasing l
-0005a050: 6973 7420 6f66 2062 7265 616b 706f 696e  ist of breakpoin
-0005a060: 7473 2062 6574 7765 656e 2074 6865 2077  ts between the w
-0005a070: 696e 646f 7773 0a20 2020 2020 2020 2020  indows.         
-0005a080: 2020 2074 6f20 636f 6d70 7574 6520 7468     to compute th
-0005a090: 6520 7374 6174 6973 7469 6320 696e 2e0a  e statistic in..
-0005a0a0: 2020 2020 2020 2020 3a70 6172 616d 2073          :param s
-0005a0b0: 7472 206d 6f64 653a 2041 2073 7472 696e  tr mode: A strin
-0005a0c0: 6720 6769 7669 6e67 2074 6865 2022 7479  g giving the "ty
-0005a0d0: 7065 2220 6f66 2074 6865 2073 7461 7469  pe" of the stati
-0005a0e0: 7374 6963 2074 6f20 6265 2063 6f6d 7075  stic to be compu
-0005a0f0: 7465 640a 2020 2020 2020 2020 2020 2020  ted.            
-0005a100: 2864 6566 6175 6c74 7320 746f 2022 7369  (defaults to "si
-0005a110: 7465 2229 2e0a 2020 2020 2020 2020 3a70  te")..        :p
-0005a120: 6172 616d 2062 6f6f 6c20 7370 616e 5f6e  aram bool span_n
-0005a130: 6f72 6d61 6c69 7365 3a20 5768 6574 6865  ormalise: Whethe
-0005a140: 7220 746f 2064 6976 6964 6520 7468 6520  r to divide the 
-0005a150: 7265 7375 6c74 2062 7920 7468 6520 7370  result by the sp
-0005a160: 616e 206f 6620 7468 650a 2020 2020 2020  an of the.      
-0005a170: 2020 2020 2020 7769 6e64 6f77 2028 6465        window (de
-0005a180: 6661 756c 7473 2074 6f20 5472 7565 292e  faults to True).
-0005a190: 0a20 2020 2020 2020 203a 7265 7475 726e  .        :return
-0005a1a0: 3a20 4120 6e64 6172 7261 7920 7769 7468  : A ndarray with
-0005a1b0: 2073 6861 7065 2065 7175 616c 2074 6f20   shape equal to 
-0005a1c0: 286e 756d 2077 696e 646f 7773 2c20 6e75  (num windows, nu
-0005a1d0: 6d20 7374 6174 6973 7469 6373 292e 0a20  m statistics).. 
-0005a1e0: 2020 2020 2020 2020 2020 2049 6620 7468             If th
-0005a1f0: 6572 6520 6973 206f 6e65 2073 616d 706c  ere is one sampl
-0005a200: 6520 7365 7420 616e 6420 7769 6e64 6f77  e set and window
-0005a210: 733d 4e6f 6e65 2c20 6120 6e75 6d70 7920  s=None, a numpy 
-0005a220: 7363 616c 6172 2069 7320 7265 7475 726e  scalar is return
-0005a230: 6564 2e0a 2020 2020 2020 2020 2222 220a  ed..        """.
-0005a240: 2020 2020 2020 2020 7265 7475 726e 2073          return s
-0005a250: 656c 662e 5f5f 6f6e 655f 7761 795f 7361  elf.__one_way_sa
-0005a260: 6d70 6c65 5f73 6574 5f73 7461 7428 0a20  mple_set_stat(. 
-0005a270: 2020 2020 2020 2020 2020 2073 656c 662e             self.
-0005a280: 5f6c 6c5f 7472 6565 5f73 6571 7565 6e63  _ll_tree_sequenc
-0005a290: 652e 5931 2c0a 2020 2020 2020 2020 2020  e.Y1,.          
-0005a2a0: 2020 7361 6d70 6c65 5f73 6574 732c 0a20    sample_sets,. 
-0005a2b0: 2020 2020 2020 2020 2020 2077 696e 646f             windo
-0005a2c0: 7773 3d77 696e 646f 7773 2c0a 2020 2020  ws=windows,.    
-0005a2d0: 2020 2020 2020 2020 6d6f 6465 3d6d 6f64          mode=mod
-0005a2e0: 652c 0a20 2020 2020 2020 2020 2020 2073  e,.            s
-0005a2f0: 7061 6e5f 6e6f 726d 616c 6973 653d 7370  pan_normalise=sp
-0005a300: 616e 5f6e 6f72 6d61 6c69 7365 2c0a 2020  an_normalise,.  
-0005a310: 2020 2020 2020 290a 0a20 2020 2064 6566        )..    def
-0005a320: 2066 3428 0a20 2020 2020 2020 2073 656c   f4(.        sel
-0005a330: 662c 2073 616d 706c 655f 7365 7473 2c20  f, sample_sets, 
-0005a340: 696e 6465 7865 733d 4e6f 6e65 2c20 7769  indexes=None, wi
-0005a350: 6e64 6f77 733d 4e6f 6e65 2c20 6d6f 6465  ndows=None, mode
-0005a360: 3d22 7369 7465 222c 2073 7061 6e5f 6e6f  ="site", span_no
-0005a370: 726d 616c 6973 653d 5472 7565 0a20 2020  rmalise=True.   
-0005a380: 2029 3a0a 2020 2020 2020 2020 2222 220a   ):.        """.
-0005a390: 2020 2020 2020 2020 436f 6d70 7574 6573          Computes
-0005a3a0: 2050 6174 7465 7273 6f6e 2773 2066 3420   Patterson's f4 
-0005a3b0: 7374 6174 6973 7469 6320 6265 7477 6565  statistic betwee
-0005a3c0: 6e20 666f 7572 2067 726f 7570 7320 6f66  n four groups of
-0005a3d0: 206e 6f64 6573 2066 726f 6d0a 2020 2020   nodes from.    
-0005a3e0: 2020 2020 6060 7361 6d70 6c65 5f73 6574      ``sample_set
-0005a3f0: 7360 602e 0a20 2020 2020 2020 204f 7065  s``..        Ope
-0005a400: 7261 7465 7320 6f6e 2060 606b 203d 2034  rates on ``k = 4
-0005a410: 6060 2073 616d 706c 6520 7365 7473 2061  `` sample sets a
-0005a420: 7420 6120 7469 6d65 3b20 706c 6561 7365  t a time; please
-0005a430: 2073 6565 2074 6865 0a20 2020 2020 2020   see the.       
-0005a440: 203a 7265 663a 606d 756c 7469 2d77 6179   :ref:`multi-way
-0005a450: 2073 7461 7469 7374 6963 7320 3c73 6563   statistics <sec
-0005a460: 5f73 7461 7473 5f73 616d 706c 655f 7365  _stats_sample_se
-0005a470: 7473 5f6d 756c 7469 5f77 6179 3e60 0a20  ts_multi_way>`. 
-0005a480: 2020 2020 2020 2073 6563 7469 6f6e 2066         section f
-0005a490: 6f72 2064 6574 6169 6c73 206f 6e20 686f  or details on ho
-0005a4a0: 7720 7468 6520 6060 7361 6d70 6c65 5f73  w the ``sample_s
-0005a4b0: 6574 7360 6020 616e 6420 6060 696e 6465  ets`` and ``inde
-0005a4c0: 7865 7360 6020 6172 6775 6d65 6e74 7320  xes`` arguments 
-0005a4d0: 6172 650a 2020 2020 2020 2020 696e 7465  are.        inte
-0005a4e0: 7270 7265 7465 6420 616e 6420 686f 7720  rpreted and how 
-0005a4f0: 7468 6579 2069 6e74 6572 6163 7420 7769  they interact wi
-0005a500: 7468 2074 6865 2064 696d 656e 7369 6f6e  th the dimension
-0005a510: 7320 6f66 2074 6865 206f 7574 7075 7420  s of the output 
-0005a520: 6172 7261 792e 0a20 2020 2020 2020 2053  array..        S
-0005a530: 6565 2074 6865 203a 7265 663a 6073 7461  ee the :ref:`sta
-0005a540: 7469 7374 6963 7320 696e 7465 7266 6163  tistics interfac
-0005a550: 6520 3c73 6563 5f73 7461 7473 5f69 6e74  e <sec_stats_int
-0005a560: 6572 6661 6365 3e60 2073 6563 7469 6f6e  erface>` section
-0005a570: 2066 6f72 2064 6574 6169 6c73 206f 6e0a   for details on.
-0005a580: 2020 2020 2020 2020 3a72 6566 3a60 7769          :ref:`wi
-0005a590: 6e64 6f77 7320 3c73 6563 5f73 7461 7473  ndows <sec_stats
-0005a5a0: 5f77 696e 646f 7773 3e60 2c0a 2020 2020  _windows>`,.    
-0005a5b0: 2020 2020 3a72 6566 3a60 6d6f 6465 203c      :ref:`mode <
-0005a5c0: 7365 635f 7374 6174 735f 6d6f 6465 3e60  sec_stats_mode>`
-0005a5d0: 2c0a 2020 2020 2020 2020 3a72 6566 3a60  ,.        :ref:`
-0005a5e0: 7370 616e 206e 6f72 6d61 6c69 7365 203c  span normalise <
-0005a5f0: 7365 635f 7374 6174 735f 7370 616e 5f6e  sec_stats_span_n
-0005a600: 6f72 6d61 6c69 7365 3e60 2c0a 2020 2020  ormalise>`,.    
-0005a610: 2020 2020 616e 6420 3a72 6566 3a60 7265      and :ref:`re
-0005a620: 7475 726e 2076 616c 7565 203c 7365 635f  turn value <sec_
-0005a630: 7374 6174 735f 6f75 7470 7574 5f66 6f72  stats_output_for
-0005a640: 6d61 743e 602e 0a0a 2020 2020 2020 2020  mat>`...        
-0005a650: 5768 6174 2069 7320 636f 6d70 7574 6564  What is computed
-0005a660: 2064 6570 656e 6473 206f 6e20 6060 6d6f   depends on ``mo
-0005a670: 6465 6060 2e20 4561 6368 2069 7320 616e  de``. Each is an
-0005a680: 2061 7665 7261 6765 2061 6372 6f73 7320   average across 
-0005a690: 6576 6572 7920 706f 7373 6962 6c65 0a20  every possible. 
-0005a6a0: 2020 2020 2020 2063 6f6d 6269 6e61 7469         combinati
-0005a6b0: 6f6e 206f 6620 666f 7572 2073 616d 706c  on of four sampl
-0005a6c0: 6573 2060 6028 612c 2062 3b20 632c 2064  es ``(a, b; c, d
-0005a6d0: 2960 602c 206f 6e65 2063 686f 7365 6e20  )``, one chosen 
-0005a6e0: 6672 6f6d 2065 6163 6820 7361 6d70 6c65  from each sample
-0005a6f0: 2073 6574 3a0a 0a20 2020 2020 2020 2022   set:..        "
-0005a700: 7369 7465 220a 2020 2020 2020 2020 2020  site".          
-0005a710: 2020 5468 6520 6176 6572 6167 6520 6465    The average de
-0005a720: 6e73 6974 7920 6f66 2073 6974 6573 2061  nsity of sites a
-0005a730: 7420 7768 6963 6820 6060 6160 6020 616e  t which ``a`` an
-0005a740: 6420 6060 6360 6020 6167 7265 6520 6275  d ``c`` agree bu
-0005a750: 740a 2020 2020 2020 2020 2020 2020 6469  t.            di
-0005a760: 6666 6572 7320 6672 6f6d 2060 6062 6060  ffers from ``b``
-0005a770: 2061 6e64 2060 6064 6060 2c20 6d69 6e75   and ``d``, minu
-0005a780: 7320 7468 6520 6176 6572 6167 6520 6465  s the average de
-0005a790: 6e73 6974 7920 6f66 2073 6974 6573 2061  nsity of sites a
-0005a7a0: 740a 2020 2020 2020 2020 2020 2020 7768  t.            wh
-0005a7b0: 6963 6820 6060 6160 6020 616e 6420 6060  ich ``a`` and ``
-0005a7c0: 6460 6020 6167 7265 6520 6275 7420 6469  d`` agree but di
-0005a7d0: 6666 6572 7320 6672 6f6d 2060 6062 6060  ffers from ``b``
-0005a7e0: 2061 6e64 2060 6063 6060 2c20 7065 720a   and ``c``, per.
-0005a7f0: 2020 2020 2020 2020 2020 2020 756e 6974              unit
-0005a800: 206f 6620 6368 726f 6d6f 736f 6d65 206c   of chromosome l
-0005a810: 656e 6774 682e 0a0a 2020 2020 2020 2020  ength...        
-0005a820: 2262 7261 6e63 6822 0a20 2020 2020 2020  "branch".       
-0005a830: 2020 2020 2054 6865 2061 7665 7261 6765       The average
-0005a840: 206c 656e 6774 6820 6f66 2061 6c6c 2062   length of all b
-0005a850: 7261 6e63 6865 7320 7468 6174 2073 6570  ranches that sep
-0005a860: 6172 6174 6520 6060 6160 6020 616e 6420  arate ``a`` and 
-0005a870: 6060 6360 600a 2020 2020 2020 2020 2020  ``c``.          
-0005a880: 2020 6672 6f6d 2060 6062 6060 2061 6e64    from ``b`` and
-0005a890: 2060 6064 6060 2c20 6d69 6e75 7320 7468   ``d``, minus th
-0005a8a0: 6520 6176 6572 6167 6520 6c65 6e67 7468  e average length
-0005a8b0: 206f 6620 616c 6c20 6272 616e 6368 6573   of all branches
-0005a8c0: 2074 6861 740a 2020 2020 2020 2020 2020   that.          
-0005a8d0: 2020 7365 7061 7261 7465 2060 6061 6060    separate ``a``
-0005a8e0: 2061 6e64 2060 6064 6060 2066 726f 6d20   and ``d`` from 
-0005a8f0: 6060 6260 6020 616e 6420 6060 6360 6020  ``b`` and ``c`` 
-0005a900: 2869 6e20 756e 6974 7320 6f66 2074 696d  (in units of tim
-0005a910: 6529 2e0a 0a20 2020 2020 2020 2022 6e6f  e)...        "no
-0005a920: 6465 220a 2020 2020 2020 2020 2020 2020  de".            
-0005a930: 466f 7220 6561 6368 206e 6f64 652c 2074  For each node, t
-0005a940: 6865 2061 7665 7261 6765 2070 726f 706f  he average propo
-0005a950: 7274 696f 6e20 6f66 2074 6865 2077 696e  rtion of the win
-0005a960: 646f 7720 6f6e 2077 6869 6368 2060 6061  dow on which ``a
-0005a970: 6060 2061 6e64 2060 6063 6060 0a20 2020  `` and ``c``.   
-0005a980: 2020 2020 2020 2020 2069 6e68 6572 6974           inherit
-0005a990: 2066 726f 6d20 7468 6174 206e 6f64 6520   from that node 
-0005a9a0: 6275 7420 6060 6260 6020 616e 6420 6060  but ``b`` and ``
-0005a9b0: 6460 6020 646f 206e 6f74 2c20 6f72 2076  d`` do not, or v
-0005a9c0: 6963 652d 7665 7273 612c 0a20 2020 2020  ice-versa,.     
-0005a9d0: 2020 2020 2020 206d 696e 7573 2074 6865         minus the
-0005a9e0: 2061 7665 7261 6765 2070 726f 706f 7274   average proport
-0005a9f0: 696f 6e20 6f66 2074 6865 2077 696e 646f  ion of the windo
-0005aa00: 7720 6f6e 2077 6869 6368 2060 6061 6060  w on which ``a``
-0005aa10: 2061 6e64 2060 6064 6060 0a20 2020 2020   and ``d``.     
-0005aa20: 2020 2020 2020 2069 6e68 6572 6974 2066         inherit f
-0005aa30: 726f 6d20 7468 6174 206e 6f64 6520 6275  rom that node bu
-0005aa40: 7420 6060 6260 6020 616e 6420 6060 6360  t ``b`` and ``c`
-0005aa50: 6020 646f 206e 6f74 2c20 6f72 2076 6963  ` do not, or vic
-0005aa60: 652d 7665 7273 612e 0a0a 2020 2020 2020  e-versa...      
-0005aa70: 2020 3a70 6172 616d 206c 6973 7420 7361    :param list sa
-0005aa80: 6d70 6c65 5f73 6574 733a 2041 206c 6973  mple_sets: A lis
-0005aa90: 7420 6f66 206c 6973 7473 206f 6620 4e6f  t of lists of No
-0005aaa0: 6465 2049 4473 2c20 7370 6563 6966 7969  de IDs, specifyi
-0005aab0: 6e67 2074 6865 0a20 2020 2020 2020 2020  ng the.         
-0005aac0: 2020 2067 726f 7570 7320 6f66 206e 6f64     groups of nod
-0005aad0: 6573 2074 6f20 636f 6d70 7574 6520 7468  es to compute th
-0005aae0: 6520 7374 6174 6973 7469 6320 7769 7468  e statistic with
-0005aaf0: 2e0a 2020 2020 2020 2020 3a70 6172 616d  ..        :param
-0005ab00: 206c 6973 7420 696e 6465 7865 733a 2041   list indexes: A
-0005ab10: 206c 6973 7420 6f66 2034 2d74 7570 6c65   list of 4-tuple
-0005ab20: 732c 206f 7220 4e6f 6e65 2e0a 2020 2020  s, or None..    
-0005ab30: 2020 2020 3a70 6172 616d 206c 6973 7420      :param list 
-0005ab40: 7769 6e64 6f77 733a 2041 6e20 696e 6372  windows: An incr
-0005ab50: 6561 7369 6e67 206c 6973 7420 6f66 2062  easing list of b
-0005ab60: 7265 616b 706f 696e 7473 2062 6574 7765  reakpoints betwe
-0005ab70: 656e 2074 6865 2077 696e 646f 7773 0a20  en the windows. 
-0005ab80: 2020 2020 2020 2020 2020 2074 6f20 636f             to co
-0005ab90: 6d70 7574 6520 7468 6520 7374 6174 6973  mpute the statis
-0005aba0: 7469 6320 696e 2e0a 2020 2020 2020 2020  tic in..        
-0005abb0: 3a70 6172 616d 2073 7472 206d 6f64 653a  :param str mode:
-0005abc0: 2041 2073 7472 696e 6720 6769 7669 6e67   A string giving
-0005abd0: 2074 6865 2022 7479 7065 2220 6f66 2074   the "type" of t
-0005abe0: 6865 2073 7461 7469 7374 6963 2074 6f20  he statistic to 
-0005abf0: 6265 2063 6f6d 7075 7465 640a 2020 2020  be computed.    
-0005ac00: 2020 2020 2020 2020 2864 6566 6175 6c74          (default
-0005ac10: 7320 746f 2022 7369 7465 2229 2e0a 2020  s to "site")..  
-0005ac20: 2020 2020 2020 3a70 6172 616d 2062 6f6f        :param boo
-0005ac30: 6c20 7370 616e 5f6e 6f72 6d61 6c69 7365  l span_normalise
-0005ac40: 3a20 5768 6574 6865 7220 746f 2064 6976  : Whether to div
-0005ac50: 6964 6520 7468 6520 7265 7375 6c74 2062  ide the result b
-0005ac60: 7920 7468 6520 7370 616e 206f 6620 7468  y the span of th
-0005ac70: 650a 2020 2020 2020 2020 2020 2020 7769  e.            wi
-0005ac80: 6e64 6f77 2028 6465 6661 756c 7473 2074  ndow (defaults t
-0005ac90: 6f20 5472 7565 292e 0a20 2020 2020 2020  o True)..       
-0005aca0: 203a 7265 7475 726e 3a20 4120 6e64 6172   :return: A ndar
-0005acb0: 7261 7920 7769 7468 2073 6861 7065 2065  ray with shape e
-0005acc0: 7175 616c 2074 6f20 286e 756d 2077 696e  qual to (num win
-0005acd0: 646f 7773 2c20 6e75 6d20 7374 6174 6973  dows, num statis
-0005ace0: 7469 6373 292e 0a20 2020 2020 2020 2020  tics)..         
-0005acf0: 2020 2049 6620 7468 6572 6520 6172 6520     If there are 
-0005ad00: 666f 7572 2073 616d 706c 6520 7365 7473  four sample sets
-0005ad10: 2061 6e64 2077 696e 646f 7773 3d4e 6f6e   and windows=Non
-0005ad20: 652c 2061 206e 756d 7079 2073 6361 6c61  e, a numpy scala
-0005ad30: 7220 6973 2072 6574 7572 6e65 642e 0a20  r is returned.. 
-0005ad40: 2020 2020 2020 2022 2222 0a20 2020 2020         """.     
-0005ad50: 2020 2072 6574 7572 6e20 7365 6c66 2e5f     return self._
-0005ad60: 5f6b 5f77 6179 5f73 616d 706c 655f 7365  _k_way_sample_se
-0005ad70: 745f 7374 6174 280a 2020 2020 2020 2020  t_stat(.        
-0005ad80: 2020 2020 7365 6c66 2e5f 6c6c 5f74 7265      self._ll_tre
-0005ad90: 655f 7365 7175 656e 6365 2e66 342c 0a20  e_sequence.f4,. 
-0005ada0: 2020 2020 2020 2020 2020 2034 2c0a 2020             4,.  
-0005adb0: 2020 2020 2020 2020 2020 7361 6d70 6c65            sample
-0005adc0: 5f73 6574 732c 0a20 2020 2020 2020 2020  _sets,.         
-0005add0: 2020 2069 6e64 6578 6573 3d69 6e64 6578     indexes=index
-0005ade0: 6573 2c0a 2020 2020 2020 2020 2020 2020  es,.            
-0005adf0: 7769 6e64 6f77 733d 7769 6e64 6f77 732c  windows=windows,
-0005ae00: 0a20 2020 2020 2020 2020 2020 206d 6f64  .            mod
-0005ae10: 653d 6d6f 6465 2c0a 2020 2020 2020 2020  e=mode,.        
-0005ae20: 2020 2020 7370 616e 5f6e 6f72 6d61 6c69      span_normali
-0005ae30: 7365 3d73 7061 6e5f 6e6f 726d 616c 6973  se=span_normalis
-0005ae40: 652c 0a20 2020 2020 2020 2029 0a0a 2020  e,.        )..  
-0005ae50: 2020 6465 6620 6633 280a 2020 2020 2020    def f3(.      
-0005ae60: 2020 7365 6c66 2c20 7361 6d70 6c65 5f73    self, sample_s
-0005ae70: 6574 732c 2069 6e64 6578 6573 3d4e 6f6e  ets, indexes=Non
-0005ae80: 652c 2077 696e 646f 7773 3d4e 6f6e 652c  e, windows=None,
-0005ae90: 206d 6f64 653d 2273 6974 6522 2c20 7370   mode="site", sp
-0005aea0: 616e 5f6e 6f72 6d61 6c69 7365 3d54 7275  an_normalise=Tru
-0005aeb0: 650a 2020 2020 293a 0a20 2020 2020 2020  e.    ):.       
-0005aec0: 2072 2222 220a 2020 2020 2020 2020 436f   r""".        Co
-0005aed0: 6d70 7574 6573 2050 6174 7465 7273 6f6e  mputes Patterson
-0005aee0: 2773 2066 3320 7374 6174 6973 7469 6320  's f3 statistic 
-0005aef0: 6265 7477 6565 6e20 7468 7265 6520 6772  between three gr
-0005af00: 6f75 7073 206f 6620 6e6f 6465 7320 6672  oups of nodes fr
-0005af10: 6f6d 0a20 2020 2020 2020 2060 6073 616d  om.        ``sam
-0005af20: 706c 655f 7365 7473 6060 2e0a 2020 2020  ple_sets``..    
-0005af30: 2020 2020 4e6f 7465 2074 6861 7420 7468      Note that th
-0005af40: 6520 6f72 6465 7220 6f66 2074 6865 2061  e order of the a
-0005af50: 7267 756d 656e 7473 206f 6620 6633 2064  rguments of f3 d
-0005af60: 6966 6665 7273 2061 6372 6f73 7320 7468  iffers across th
-0005af70: 6520 6c69 7465 7261 7475 7265 3a0a 2020  e literature:.  
-0005af80: 2020 2020 2020 6865 7265 2c20 6060 6633        here, ``f3
-0005af90: 285b 412c 2042 2c20 435d 2960 6020 666f  ([A, B, C])`` fo
-0005afa0: 7220 7361 6d70 6c65 2073 6574 7320 6060  r sample sets ``
-0005afb0: 4160 602c 2060 6042 6060 2c20 616e 6420  A``, ``B``, and 
-0005afc0: 6060 4360 600a 2020 2020 2020 2020 7769  ``C``.        wi
-0005afd0: 6c6c 2065 7374 696d 6174 650a 2020 2020  ll estimate.    
-0005afe0: 2020 2020 3a6d 6174 683a 6066 5f33 2841      :math:`f_3(A
-0005aff0: 3b20 422c 2043 2920 3d20 5c6d 6174 6862  ; B, C) = \mathb
-0005b000: 627b 457d 5b28 705f 4120 2d20 705f 4229  b{E}[(p_A - p_B)
-0005b010: 2028 705f 4120 2d20 705f 4329 5d60 2c0a   (p_A - p_C)]`,.
-0005b020: 2020 2020 2020 2020 7768 6572 6520 3a6d          where :m
-0005b030: 6174 683a 6070 5f41 6020 6973 2074 6865  ath:`p_A` is the
-0005b040: 2061 6c6c 656c 6520 6672 6571 7565 6e63   allele frequenc
-0005b050: 7920 696e 2060 6041 6060 2e0a 2020 2020  y in ``A``..    
-0005b060: 2020 2020 5768 656e 2075 7365 6420 6173      When used as
-0005b070: 2061 2074 6573 7420 666f 7220 6164 6d69   a test for admi
-0005b080: 7874 7572 652c 2074 6865 2070 7574 6174  xture, the putat
-0005b090: 6976 656c 7920 6164 6d69 7865 6420 706f  ively admixed po
-0005b0a0: 7075 6c61 7469 6f6e 0a20 2020 2020 2020  pulation.       
-0005b0b0: 2069 7320 7573 7561 6c6c 7920 706c 6163   is usually plac
-0005b0c0: 6564 2061 7320 706f 7075 6c61 7469 6f6e  ed as population
-0005b0d0: 2060 6041 6060 2028 7365 650a 2020 2020   ``A`` (see.    
-0005b0e0: 2020 2020 6050 6574 6572 2028 3230 3136      `Peter (2016
-0005b0f0: 2920 3c68 7474 7073 3a2f 2f64 6f69 2e6f  ) <https://doi.o
-0005b100: 7267 2f31 302e 3135 3334 2f67 656e 6574  rg/10.1534/genet
-0005b110: 6963 732e 3131 352e 3138 3339 3133 3e60  ics.115.183913>`
-0005b120: 5f0a 2020 2020 2020 2020 666f 7220 6d6f  _.        for mo
-0005b130: 7265 2064 6973 6375 7373 696f 6e29 2e0a  re discussion)..
-0005b140: 0a20 2020 2020 2020 204f 7065 7261 7465  .        Operate
-0005b150: 7320 6f6e 2060 606b 203d 2033 6060 2073  s on ``k = 3`` s
-0005b160: 616d 706c 6520 7365 7473 2061 7420 6120  ample sets at a 
-0005b170: 7469 6d65 3b20 706c 6561 7365 2073 6565  time; please see
-0005b180: 2074 6865 0a20 2020 2020 2020 203a 7265   the.        :re
-0005b190: 663a 606d 756c 7469 2d77 6179 2073 7461  f:`multi-way sta
-0005b1a0: 7469 7374 6963 7320 3c73 6563 5f73 7461  tistics <sec_sta
-0005b1b0: 7473 5f73 616d 706c 655f 7365 7473 5f6d  ts_sample_sets_m
-0005b1c0: 756c 7469 5f77 6179 3e60 0a20 2020 2020  ulti_way>`.     
-0005b1d0: 2020 2073 6563 7469 6f6e 2066 6f72 2064     section for d
-0005b1e0: 6574 6169 6c73 206f 6e20 686f 7720 7468  etails on how th
-0005b1f0: 6520 6060 7361 6d70 6c65 5f73 6574 7360  e ``sample_sets`
-0005b200: 6020 616e 6420 6060 696e 6465 7865 7360  ` and ``indexes`
-0005b210: 6020 6172 6775 6d65 6e74 7320 6172 650a  ` arguments are.
-0005b220: 2020 2020 2020 2020 696e 7465 7270 7265          interpre
-0005b230: 7465 6420 616e 6420 686f 7720 7468 6579  ted and how they
-0005b240: 2069 6e74 6572 6163 7420 7769 7468 2074   interact with t
-0005b250: 6865 2064 696d 656e 7369 6f6e 7320 6f66  he dimensions of
-0005b260: 2074 6865 206f 7574 7075 7420 6172 7261   the output arra
-0005b270: 792e 0a20 2020 2020 2020 2053 6565 2074  y..        See t
-0005b280: 6865 203a 7265 663a 6073 7461 7469 7374  he :ref:`statist
-0005b290: 6963 7320 696e 7465 7266 6163 6520 3c73  ics interface <s
-0005b2a0: 6563 5f73 7461 7473 5f69 6e74 6572 6661  ec_stats_interfa
-0005b2b0: 6365 3e60 2073 6563 7469 6f6e 2066 6f72  ce>` section for
-0005b2c0: 2064 6574 6169 6c73 206f 6e0a 2020 2020   details on.    
-0005b2d0: 2020 2020 3a72 6566 3a60 7769 6e64 6f77      :ref:`window
-0005b2e0: 7320 3c73 6563 5f73 7461 7473 5f77 696e  s <sec_stats_win
-0005b2f0: 646f 7773 3e60 2c0a 2020 2020 2020 2020  dows>`,.        
-0005b300: 3a72 6566 3a60 6d6f 6465 203c 7365 635f  :ref:`mode <sec_
-0005b310: 7374 6174 735f 6d6f 6465 3e60 2c0a 2020  stats_mode>`,.  
-0005b320: 2020 2020 2020 3a72 6566 3a60 7370 616e        :ref:`span
-0005b330: 206e 6f72 6d61 6c69 7365 203c 7365 635f   normalise <sec_
-0005b340: 7374 6174 735f 7370 616e 5f6e 6f72 6d61  stats_span_norma
-0005b350: 6c69 7365 3e60 2c0a 2020 2020 2020 2020  lise>`,.        
-0005b360: 616e 6420 3a72 6566 3a60 7265 7475 726e  and :ref:`return
-0005b370: 2076 616c 7565 203c 7365 635f 7374 6174   value <sec_stat
-0005b380: 735f 6f75 7470 7574 5f66 6f72 6d61 743e  s_output_format>
-0005b390: 602e 0a0a 2020 2020 2020 2020 5768 6174  `...        What
-0005b3a0: 2069 7320 636f 6d70 7574 6564 2064 6570   is computed dep
-0005b3b0: 656e 6473 206f 6e20 6060 6d6f 6465 6060  ends on ``mode``
-0005b3c0: 2e20 4561 6368 2077 6f72 6b73 2065 7861  . Each works exa
-0005b3d0: 6374 6c79 2061 730a 2020 2020 2020 2020  ctly as.        
-0005b3e0: 3a6d 6574 683a 6066 3420 3c2e 5472 6565  :meth:`f4 <.Tree
-0005b3f0: 5365 7175 656e 6365 2e66 343e 602c 2065  Sequence.f4>`, e
-0005b400: 7863 6570 7420 7468 6520 6176 6572 6167  xcept the averag
-0005b410: 6520 6973 2061 6372 6f73 7320 6576 6572  e is across ever
-0005b420: 7920 706f 7373 6962 6c65 0a20 2020 2020  y possible.     
-0005b430: 2020 2063 6f6d 6269 6e61 7469 6f6e 206f     combination o
-0005b440: 6620 666f 7572 2073 616d 706c 6573 2060  f four samples `
-0005b450: 6028 6131 2c20 623b 2061 322c 2063 2960  `(a1, b; a2, c)`
-0005b460: 6020 7768 6572 6520 6061 3160 2061 6e64  ` where `a1` and
-0005b470: 2060 6132 6020 6861 7665 2062 6f74 680a   `a2` have both.
-0005b480: 2020 2020 2020 2020 6265 656e 2063 686f          been cho
-0005b490: 7365 6e20 2877 6974 686f 7574 2072 6570  sen (without rep
-0005b4a0: 6c61 6365 6d65 6e74 2920 6672 6f6d 2074  lacement) from t
-0005b4b0: 6865 2066 6972 7374 2073 616d 706c 6520  he first sample 
-0005b4c0: 7365 742e 2053 6565 0a20 2020 2020 2020  set. See.       
-0005b4d0: 203a 6d65 7468 3a60 6634 203c 2e54 7265   :meth:`f4 <.Tre
-0005b4e0: 6553 6571 7565 6e63 652e 6634 3e60 2066  eSequence.f4>` f
-0005b4f0: 6f72 206d 6f72 6520 6465 7461 696c 732e  or more details.
-0005b500: 0a0a 2020 2020 2020 2020 3a70 6172 616d  ..        :param
-0005b510: 206c 6973 7420 7361 6d70 6c65 5f73 6574   list sample_set
-0005b520: 733a 2041 206c 6973 7420 6f66 206c 6973  s: A list of lis
-0005b530: 7473 206f 6620 4e6f 6465 2049 4473 2c20  ts of Node IDs, 
-0005b540: 7370 6563 6966 7969 6e67 2074 6865 0a20  specifying the. 
-0005b550: 2020 2020 2020 2020 2020 2067 726f 7570             group
-0005b560: 7320 6f66 206e 6f64 6573 2074 6f20 636f  s of nodes to co
-0005b570: 6d70 7574 6520 7468 6520 7374 6174 6973  mpute the statis
-0005b580: 7469 6320 7769 7468 2e0a 2020 2020 2020  tic with..      
-0005b590: 2020 3a70 6172 616d 206c 6973 7420 696e    :param list in
-0005b5a0: 6465 7865 733a 2041 206c 6973 7420 6f66  dexes: A list of
-0005b5b0: 2033 2d74 7570 6c65 732c 206f 7220 4e6f   3-tuples, or No
-0005b5c0: 6e65 2e0a 2020 2020 2020 2020 3a70 6172  ne..        :par
-0005b5d0: 616d 206c 6973 7420 7769 6e64 6f77 733a  am list windows:
-0005b5e0: 2041 6e20 696e 6372 6561 7369 6e67 206c   An increasing l
-0005b5f0: 6973 7420 6f66 2062 7265 616b 706f 696e  ist of breakpoin
-0005b600: 7473 2062 6574 7765 656e 2074 6865 2077  ts between the w
-0005b610: 696e 646f 7773 0a20 2020 2020 2020 2020  indows.         
-0005b620: 2020 2074 6f20 636f 6d70 7574 6520 7468     to compute th
-0005b630: 6520 7374 6174 6973 7469 6320 696e 2e0a  e statistic in..
-0005b640: 2020 2020 2020 2020 3a70 6172 616d 2073          :param s
-0005b650: 7472 206d 6f64 653a 2041 2073 7472 696e  tr mode: A strin
-0005b660: 6720 6769 7669 6e67 2074 6865 2022 7479  g giving the "ty
-0005b670: 7065 2220 6f66 2074 6865 2073 7461 7469  pe" of the stati
-0005b680: 7374 6963 2074 6f20 6265 2063 6f6d 7075  stic to be compu
-0005b690: 7465 640a 2020 2020 2020 2020 2020 2020  ted.            
-0005b6a0: 2864 6566 6175 6c74 7320 746f 2022 7369  (defaults to "si
-0005b6b0: 7465 2229 2e0a 2020 2020 2020 2020 3a70  te")..        :p
-0005b6c0: 6172 616d 2062 6f6f 6c20 7370 616e 5f6e  aram bool span_n
-0005b6d0: 6f72 6d61 6c69 7365 3a20 5768 6574 6865  ormalise: Whethe
-0005b6e0: 7220 746f 2064 6976 6964 6520 7468 6520  r to divide the 
-0005b6f0: 7265 7375 6c74 2062 7920 7468 6520 7370  result by the sp
-0005b700: 616e 206f 6620 7468 650a 2020 2020 2020  an of the.      
-0005b710: 2020 2020 2020 7769 6e64 6f77 2028 6465        window (de
-0005b720: 6661 756c 7473 2074 6f20 5472 7565 292e  faults to True).
-0005b730: 0a20 2020 2020 2020 203a 7265 7475 726e  .        :return
-0005b740: 3a20 4120 6e64 6172 7261 7920 7769 7468  : A ndarray with
-0005b750: 2073 6861 7065 2065 7175 616c 2074 6f20   shape equal to 
-0005b760: 286e 756d 2077 696e 646f 7773 2c20 6e75  (num windows, nu
-0005b770: 6d20 7374 6174 6973 7469 6373 292e 0a20  m statistics).. 
-0005b780: 2020 2020 2020 2020 2020 2049 6620 7468             If th
-0005b790: 6572 6520 6172 6520 7468 7265 6520 7361  ere are three sa
-0005b7a0: 6d70 6c65 2073 6574 7320 616e 6420 7769  mple sets and wi
-0005b7b0: 6e64 6f77 733d 4e6f 6e65 2c20 6120 6e75  ndows=None, a nu
-0005b7c0: 6d70 7920 7363 616c 6172 2069 7320 7265  mpy scalar is re
-0005b7d0: 7475 726e 6564 2e0a 2020 2020 2020 2020  turned..        
-0005b7e0: 2222 220a 2020 2020 2020 2020 7265 7475  """.        retu
-0005b7f0: 726e 2073 656c 662e 5f5f 6b5f 7761 795f  rn self.__k_way_
-0005b800: 7361 6d70 6c65 5f73 6574 5f73 7461 7428  sample_set_stat(
-0005b810: 0a20 2020 2020 2020 2020 2020 2073 656c  .            sel
-0005b820: 662e 5f6c 6c5f 7472 6565 5f73 6571 7565  f._ll_tree_seque
-0005b830: 6e63 652e 6633 2c0a 2020 2020 2020 2020  nce.f3,.        
-0005b840: 2020 2020 332c 0a20 2020 2020 2020 2020      3,.         
-0005b850: 2020 2073 616d 706c 655f 7365 7473 2c0a     sample_sets,.
-0005b860: 2020 2020 2020 2020 2020 2020 696e 6465              inde
-0005b870: 7865 733d 696e 6465 7865 732c 0a20 2020  xes=indexes,.   
-0005b880: 2020 2020 2020 2020 2077 696e 646f 7773           windows
-0005b890: 3d77 696e 646f 7773 2c0a 2020 2020 2020  =windows,.      
-0005b8a0: 2020 2020 2020 6d6f 6465 3d6d 6f64 652c        mode=mode,
-0005b8b0: 0a20 2020 2020 2020 2020 2020 2073 7061  .            spa
-0005b8c0: 6e5f 6e6f 726d 616c 6973 653d 7370 616e  n_normalise=span
-0005b8d0: 5f6e 6f72 6d61 6c69 7365 2c0a 2020 2020  _normalise,.    
-0005b8e0: 2020 2020 290a 0a20 2020 2064 6566 2066      )..    def f
-0005b8f0: 3228 0a20 2020 2020 2020 2073 656c 662c  2(.        self,
-0005b900: 2073 616d 706c 655f 7365 7473 2c20 696e   sample_sets, in
-0005b910: 6465 7865 733d 4e6f 6e65 2c20 7769 6e64  dexes=None, wind
-0005b920: 6f77 733d 4e6f 6e65 2c20 6d6f 6465 3d22  ows=None, mode="
-0005b930: 7369 7465 222c 2073 7061 6e5f 6e6f 726d  site", span_norm
-0005b940: 616c 6973 653d 5472 7565 0a20 2020 2029  alise=True.    )
-0005b950: 3a0a 2020 2020 2020 2020 2222 220a 2020  :.        """.  
-0005b960: 2020 2020 2020 436f 6d70 7574 6573 2050        Computes P
-0005b970: 6174 7465 7273 6f6e 2773 2066 3220 7374  atterson's f2 st
-0005b980: 6174 6973 7469 6320 6265 7477 6565 6e20  atistic between 
-0005b990: 7477 6f20 6772 6f75 7073 206f 6620 6e6f  two groups of no
-0005b9a0: 6465 7320 6672 6f6d 0a20 2020 2020 2020  des from.       
-0005b9b0: 2060 6073 616d 706c 655f 7365 7473 6060   ``sample_sets``
-0005b9c0: 2e0a 2020 2020 2020 2020 4f70 6572 6174  ..        Operat
-0005b9d0: 6573 206f 6e20 6060 6b20 3d20 3260 6020  es on ``k = 2`` 
-0005b9e0: 7361 6d70 6c65 2073 6574 7320 6174 2061  sample sets at a
-0005b9f0: 2074 696d 653b 2070 6c65 6173 6520 7365   time; please se
-0005ba00: 6520 7468 650a 2020 2020 2020 2020 3a72  e the.        :r
-0005ba10: 6566 3a60 6d75 6c74 692d 7761 7920 7374  ef:`multi-way st
-0005ba20: 6174 6973 7469 6373 203c 7365 635f 7374  atistics <sec_st
-0005ba30: 6174 735f 7361 6d70 6c65 5f73 6574 735f  ats_sample_sets_
-0005ba40: 6d75 6c74 695f 7761 793e 600a 2020 2020  multi_way>`.    
-0005ba50: 2020 2020 7365 6374 696f 6e20 666f 7220      section for 
-0005ba60: 6465 7461 696c 7320 6f6e 2068 6f77 2074  details on how t
-0005ba70: 6865 2060 6073 616d 706c 655f 7365 7473  he ``sample_sets
-0005ba80: 6060 2061 6e64 2060 6069 6e64 6578 6573  `` and ``indexes
-0005ba90: 6060 2061 7267 756d 656e 7473 2061 7265  `` arguments are
-0005baa0: 0a20 2020 2020 2020 2069 6e74 6572 7072  .        interpr
-0005bab0: 6574 6564 2061 6e64 2068 6f77 2074 6865  eted and how the
-0005bac0: 7920 696e 7465 7261 6374 2077 6974 6820  y interact with 
-0005bad0: 7468 6520 6469 6d65 6e73 696f 6e73 206f  the dimensions o
-0005bae0: 6620 7468 6520 6f75 7470 7574 2061 7272  f the output arr
-0005baf0: 6179 2e0a 2020 2020 2020 2020 5365 6520  ay..        See 
-0005bb00: 7468 6520 3a72 6566 3a60 7374 6174 6973  the :ref:`statis
-0005bb10: 7469 6373 2069 6e74 6572 6661 6365 203c  tics interface <
-0005bb20: 7365 635f 7374 6174 735f 696e 7465 7266  sec_stats_interf
-0005bb30: 6163 653e 6020 7365 6374 696f 6e20 666f  ace>` section fo
-0005bb40: 7220 6465 7461 696c 7320 6f6e 0a20 2020  r details on.   
-0005bb50: 2020 2020 203a 7265 663a 6077 696e 646f       :ref:`windo
-0005bb60: 7773 203c 7365 635f 7374 6174 735f 7769  ws <sec_stats_wi
-0005bb70: 6e64 6f77 733e 602c 0a20 2020 2020 2020  ndows>`,.       
-0005bb80: 203a 7265 663a 606d 6f64 6520 3c73 6563   :ref:`mode <sec
-0005bb90: 5f73 7461 7473 5f6d 6f64 653e 602c 0a20  _stats_mode>`,. 
-0005bba0: 2020 2020 2020 203a 7265 663a 6073 7061         :ref:`spa
-0005bbb0: 6e20 6e6f 726d 616c 6973 6520 3c73 6563  n normalise <sec
-0005bbc0: 5f73 7461 7473 5f73 7061 6e5f 6e6f 726d  _stats_span_norm
-0005bbd0: 616c 6973 653e 602c 0a20 2020 2020 2020  alise>`,.       
-0005bbe0: 2061 6e64 203a 7265 663a 6072 6574 7572   and :ref:`retur
-0005bbf0: 6e20 7661 6c75 6520 3c73 6563 5f73 7461  n value <sec_sta
-0005bc00: 7473 5f6f 7574 7075 745f 666f 726d 6174  ts_output_format
-0005bc10: 3e60 2e0a 0a20 2020 2020 2020 2057 6861  >`...        Wha
-0005bc20: 7420 6973 2063 6f6d 7075 7465 6420 6465  t is computed de
-0005bc30: 7065 6e64 7320 6f6e 2060 606d 6f64 6560  pends on ``mode`
-0005bc40: 602e 2045 6163 6820 776f 726b 7320 6578  `. Each works ex
-0005bc50: 6163 746c 7920 6173 0a20 2020 2020 2020  actly as.       
-0005bc60: 203a 6d65 7468 3a60 6634 203c 2e54 7265   :meth:`f4 <.Tre
-0005bc70: 6553 6571 7565 6e63 652e 6634 3e60 2c20  eSequence.f4>`, 
-0005bc80: 6578 6365 7074 2074 6865 2061 7665 7261  except the avera
-0005bc90: 6765 2069 7320 6163 726f 7373 2065 7665  ge is across eve
-0005bca0: 7279 2070 6f73 7369 626c 650a 2020 2020  ry possible.    
-0005bcb0: 2020 2020 636f 6d62 696e 6174 696f 6e20      combination 
-0005bcc0: 6f66 2066 6f75 7220 7361 6d70 6c65 7320  of four samples 
-0005bcd0: 6060 2861 312c 2062 313b 2061 322c 2062  ``(a1, b1; a2, b
-0005bce0: 3229 6060 2077 6865 7265 2060 6131 6020  2)`` where `a1` 
-0005bcf0: 616e 6420 6061 3260 2068 6176 650a 2020  and `a2` have.  
-0005bd00: 2020 2020 2020 626f 7468 2062 6565 6e20        both been 
-0005bd10: 6368 6f73 656e 2028 7769 7468 6f75 7420  chosen (without 
-0005bd20: 7265 706c 6163 656d 656e 7429 2066 726f  replacement) fro
-0005bd30: 6d20 7468 6520 6669 7273 7420 7361 6d70  m the first samp
-0005bd40: 6c65 2073 6574 2c20 616e 6420 6060 6231  le set, and ``b1
-0005bd50: 6060 0a20 2020 2020 2020 2061 6e64 2060  ``.        and `
-0005bd60: 6062 3260 6020 6861 7665 2062 6f74 6820  `b2`` have both 
-0005bd70: 6265 656e 2063 686f 7365 6e20 2877 6974  been chosen (wit
-0005bd80: 686f 7574 2072 6570 6c61 6365 6d65 6e74  hout replacement
-0005bd90: 2920 6672 6f6d 2074 6865 2073 6563 6f6e  ) from the secon
-0005bda0: 640a 2020 2020 2020 2020 7361 6d70 6c65  d.        sample
-0005bdb0: 2073 6574 2e20 5365 6520 3a6d 6574 683a   set. See :meth:
-0005bdc0: 6066 3420 3c2e 5472 6565 5365 7175 656e  `f4 <.TreeSequen
-0005bdd0: 6365 2e66 343e 6020 666f 7220 6d6f 7265  ce.f4>` for more
-0005bde0: 2064 6574 6169 6c73 2e0a 0a20 2020 2020   details...     
-0005bdf0: 2020 203a 7061 7261 6d20 6c69 7374 2073     :param list s
-0005be00: 616d 706c 655f 7365 7473 3a20 4120 6c69  ample_sets: A li
-0005be10: 7374 206f 6620 6c69 7374 7320 6f66 204e  st of lists of N
-0005be20: 6f64 6520 4944 732c 2073 7065 6369 6679  ode IDs, specify
-0005be30: 696e 6720 7468 650a 2020 2020 2020 2020  ing the.        
-0005be40: 2020 2020 6772 6f75 7073 206f 6620 6e6f      groups of no
-0005be50: 6465 7320 746f 2063 6f6d 7075 7465 2074  des to compute t
-0005be60: 6865 2073 7461 7469 7374 6963 2077 6974  he statistic wit
-0005be70: 682e 0a20 2020 2020 2020 203a 7061 7261  h..        :para
-0005be80: 6d20 6c69 7374 2069 6e64 6578 6573 3a20  m list indexes: 
-0005be90: 4120 6c69 7374 206f 6620 322d 7475 706c  A list of 2-tupl
-0005bea0: 6573 2c20 6f72 204e 6f6e 652e 0a20 2020  es, or None..   
-0005beb0: 2020 2020 203a 7061 7261 6d20 6c69 7374       :param list
-0005bec0: 2077 696e 646f 7773 3a20 416e 2069 6e63   windows: An inc
-0005bed0: 7265 6173 696e 6720 6c69 7374 206f 6620  reasing list of 
-0005bee0: 6272 6561 6b70 6f69 6e74 7320 6265 7477  breakpoints betw
-0005bef0: 6565 6e20 7468 6520 7769 6e64 6f77 730a  een the windows.
-0005bf00: 2020 2020 2020 2020 2020 2020 746f 2063              to c
-0005bf10: 6f6d 7075 7465 2074 6865 2073 7461 7469  ompute the stati
-0005bf20: 7374 6963 2069 6e2e 0a20 2020 2020 2020  stic in..       
-0005bf30: 203a 7061 7261 6d20 7374 7220 6d6f 6465   :param str mode
-0005bf40: 3a20 4120 7374 7269 6e67 2067 6976 696e  : A string givin
-0005bf50: 6720 7468 6520 2274 7970 6522 206f 6620  g the "type" of 
-0005bf60: 7468 6520 7374 6174 6973 7469 6320 746f  the statistic to
-0005bf70: 2062 6520 636f 6d70 7574 6564 0a20 2020   be computed.   
-0005bf80: 2020 2020 2020 2020 2028 6465 6661 756c           (defaul
-0005bf90: 7473 2074 6f20 2273 6974 6522 292e 0a20  ts to "site").. 
-0005bfa0: 2020 2020 2020 203a 7061 7261 6d20 626f         :param bo
-0005bfb0: 6f6c 2073 7061 6e5f 6e6f 726d 616c 6973  ol span_normalis
-0005bfc0: 653a 2057 6865 7468 6572 2074 6f20 6469  e: Whether to di
-0005bfd0: 7669 6465 2074 6865 2072 6573 756c 7420  vide the result 
-0005bfe0: 6279 2074 6865 2073 7061 6e20 6f66 2074  by the span of t
-0005bff0: 6865 0a20 2020 2020 2020 2020 2020 2077  he.            w
-0005c000: 696e 646f 7720 2864 6566 6175 6c74 7320  indow (defaults 
-0005c010: 746f 2054 7275 6529 2e0a 2020 2020 2020  to True)..      
-0005c020: 2020 3a72 6574 7572 6e3a 2041 206e 6461    :return: A nda
-0005c030: 7272 6179 2077 6974 6820 7368 6170 6520  rray with shape 
-0005c040: 6571 7561 6c20 746f 2028 6e75 6d20 7769  equal to (num wi
-0005c050: 6e64 6f77 732c 206e 756d 2073 7461 7469  ndows, num stati
-0005c060: 7374 6963 7329 2e0a 2020 2020 2020 2020  stics)..        
-0005c070: 2020 2020 4966 2074 6865 7265 2069 7320      If there is 
-0005c080: 6f6e 6520 7061 6972 206f 6620 7361 6d70  one pair of samp
-0005c090: 6c65 2073 6574 7320 616e 6420 7769 6e64  le sets and wind
-0005c0a0: 6f77 733d 4e6f 6e65 2c20 6120 6e75 6d70  ows=None, a nump
-0005c0b0: 7920 7363 616c 6172 2069 730a 2020 2020  y scalar is.    
-0005c0c0: 2020 2020 2020 2020 7265 7475 726e 6564          returned
-0005c0d0: 2e0a 2020 2020 2020 2020 2222 220a 2020  ..        """.  
-0005c0e0: 2020 2020 2020 7265 7475 726e 2073 656c        return sel
-0005c0f0: 662e 5f5f 6b5f 7761 795f 7361 6d70 6c65  f.__k_way_sample
-0005c100: 5f73 6574 5f73 7461 7428 0a20 2020 2020  _set_stat(.     
-0005c110: 2020 2020 2020 2073 656c 662e 5f6c 6c5f         self._ll_
-0005c120: 7472 6565 5f73 6571 7565 6e63 652e 6632  tree_sequence.f2
-0005c130: 2c0a 2020 2020 2020 2020 2020 2020 322c  ,.            2,
-0005c140: 0a20 2020 2020 2020 2020 2020 2073 616d  .            sam
-0005c150: 706c 655f 7365 7473 2c0a 2020 2020 2020  ple_sets,.      
-0005c160: 2020 2020 2020 696e 6465 7865 733d 696e        indexes=in
-0005c170: 6465 7865 732c 0a20 2020 2020 2020 2020  dexes,.         
-0005c180: 2020 2077 696e 646f 7773 3d77 696e 646f     windows=windo
-0005c190: 7773 2c0a 2020 2020 2020 2020 2020 2020  ws,.            
-0005c1a0: 6d6f 6465 3d6d 6f64 652c 0a20 2020 2020  mode=mode,.     
-0005c1b0: 2020 2020 2020 2073 7061 6e5f 6e6f 726d         span_norm
-0005c1c0: 616c 6973 653d 7370 616e 5f6e 6f72 6d61  alise=span_norma
-0005c1d0: 6c69 7365 2c0a 2020 2020 2020 2020 290a  lise,.        ).
-0005c1e0: 0a20 2020 2064 6566 206d 6561 6e5f 6465  .    def mean_de
-0005c1f0: 7363 656e 6461 6e74 7328 7365 6c66 2c20  scendants(self, 
-0005c200: 7361 6d70 6c65 5f73 6574 7329 3a0a 2020  sample_sets):.  
-0005c210: 2020 2020 2020 2222 220a 2020 2020 2020        """.      
-0005c220: 2020 436f 6d70 7574 6573 2066 6f72 2065    Computes for e
-0005c230: 7665 7279 206e 6f64 6520 7468 6520 6d65  very node the me
-0005c240: 616e 206e 756d 6265 7220 6f66 2073 616d  an number of sam
-0005c250: 706c 6573 2069 6e20 6561 6368 206f 6620  ples in each of 
-0005c260: 7468 650a 2020 2020 2020 2020 6073 616d  the.        `sam
-0005c270: 706c 655f 7365 7473 6020 7468 6174 2064  ple_sets` that d
-0005c280: 6573 6365 6e64 2066 726f 6d20 7468 6174  escend from that
-0005c290: 206e 6f64 652c 2061 7665 7261 6765 6420   node, averaged 
-0005c2a0: 6f76 6572 2074 6865 0a20 2020 2020 2020  over the.       
-0005c2b0: 2070 6f72 7469 6f6e 7320 6f66 2074 6865   portions of the
-0005c2c0: 2067 656e 6f6d 6520 666f 7220 7768 6963   genome for whic
-0005c2d0: 6820 7468 6520 6e6f 6465 2069 7320 616e  h the node is an
-0005c2e0: 6365 7374 7261 6c20 746f 202a 616e 792a  cestral to *any*
-0005c2f0: 2073 616d 706c 652e 0a20 2020 2020 2020   sample..       
-0005c300: 2054 6865 206f 7574 7075 7420 6973 2061   The output is a
-0005c310: 6e20 6172 7261 792c 2060 435b 6e6f 6465  n array, `C[node
-0005c320: 2c20 6a5d 602c 2077 6869 6368 2072 6570  , j]`, which rep
-0005c330: 6f72 7473 2074 6865 2074 6f74 616c 2073  orts the total s
-0005c340: 7061 6e20 6f66 0a20 2020 2020 2020 2061  pan of.        a
-0005c350: 6c6c 2067 656e 6f6d 6573 2069 6e20 6073  ll genomes in `s
-0005c360: 616d 706c 655f 7365 7473 5b6a 5d60 2074  ample_sets[j]` t
-0005c370: 6861 7420 696e 6865 7269 7420 6672 6f6d  hat inherit from
-0005c380: 2060 6e6f 6465 602c 2064 6976 6964 6564   `node`, divided
-0005c390: 2062 790a 2020 2020 2020 2020 7468 6520   by.        the 
-0005c3a0: 746f 7461 6c20 7370 616e 206f 6620 7468  total span of th
-0005c3b0: 6520 6765 6e6f 6d65 206f 6e20 7768 6963  e genome on whic
-0005c3c0: 6820 606e 6f64 6560 2069 7320 616e 2061  h `node` is an a
-0005c3d0: 6e63 6573 746f 7220 746f 2061 6e79 0a20  ncestor to any. 
-0005c3e0: 2020 2020 2020 2073 616d 706c 6520 696e         sample in
-0005c3f0: 2074 6865 2074 7265 6520 7365 7175 656e   the tree sequen
-0005c400: 6365 2e0a 0a20 2020 2020 2020 202e 2e20  ce...        .. 
-0005c410: 7761 726e 696e 673a 3a20 5468 6520 696e  warning:: The in
-0005c420: 7465 7266 6163 6520 666f 7220 7468 6973  terface for this
-0005c430: 206d 6574 686f 6420 6973 2070 7265 6c69   method is preli
-0005c440: 6d69 6e61 7279 2061 6e64 206d 6179 2062  minary and may b
-0005c450: 6520 7375 626a 6563 7420 746f 0a20 2020  e subject to.   
-0005c460: 2020 2020 2020 2020 2062 6163 6b77 6172           backwar
-0005c470: 6473 2069 6e63 6f6d 7061 7469 626c 6520  ds incompatible 
-0005c480: 6368 616e 6765 7320 696e 2074 6865 206e  changes in the n
-0005c490: 6561 7220 6675 7475 7265 2e20 5468 6520  ear future. The 
-0005c4a0: 6c6f 6e67 2d74 6572 6d20 7374 6162 6c65  long-term stable
-0005c4b0: 0a20 2020 2020 2020 2020 2020 2041 5049  .            API
-0005c4c0: 2066 6f72 2074 6869 7320 6d65 7468 6f64   for this method
-0005c4d0: 2077 696c 6c20 6265 2063 6f6e 7369 7374   will be consist
-0005c4e0: 656e 7420 7769 7468 206f 7468 6572 203a  ent with other :
-0005c4f0: 7265 663a 6073 6563 5f73 7461 7473 602e  ref:`sec_stats`.
-0005c500: 0a20 2020 2020 2020 2020 2020 2049 6e20  .            In 
-0005c510: 7061 7274 6963 756c 6172 2c20 7468 6520  particular, the 
-0005c520: 6e6f 726d 616c 697a 6174 696f 6e20 6279  normalization by
-0005c530: 2070 726f 706f 7274 696f 6e20 6f66 2074   proportion of t
-0005c540: 6865 2067 656e 6f6d 6520 7468 6174 2060  he genome that `
-0005c550: 6e6f 6465 600a 2020 2020 2020 2020 2020  node`.          
-0005c560: 2020 6973 2061 6e20 616e 6365 7374 6f72    is an ancestor
-0005c570: 2074 6f20 616e 796f 6e65 206d 6179 206e   to anyone may n
-0005c580: 6f74 2062 6520 7468 6520 6465 6661 756c  ot be the defaul
-0005c590: 7420 6265 6861 7669 6f75 7220 696e 2074  t behaviour in t
-0005c5a0: 6865 2066 7574 7572 652e 0a0a 2020 2020  he future...    
-0005c5b0: 2020 2020 3a70 6172 616d 206c 6973 7420      :param list 
-0005c5c0: 7361 6d70 6c65 5f73 6574 733a 2041 206c  sample_sets: A l
-0005c5d0: 6973 7420 6f66 206c 6973 7473 206f 6620  ist of lists of 
-0005c5e0: 6e6f 6465 2049 4473 2e0a 2020 2020 2020  node IDs..      
-0005c5f0: 2020 3a72 6574 7572 6e3a 2041 6e20 6172    :return: An ar
-0005c600: 7261 7920 7769 7468 2064 696d 656e 7369  ray with dimensi
-0005c610: 6f6e 7320 286e 756d 6265 7220 6f66 206e  ons (number of n
-0005c620: 6f64 6573 2069 6e20 7468 6520 7472 6565  odes in the tree
-0005c630: 2073 6571 7565 6e63 652c 0a20 2020 2020   sequence,.     
-0005c640: 2020 2020 2020 206e 756d 6265 7220 6f66         number of
-0005c650: 2072 6566 6572 656e 6365 2073 6574 7329   reference sets)
-0005c660: 0a20 2020 2020 2020 2022 2222 0a20 2020  .        """.   
-0005c670: 2020 2020 2072 6574 7572 6e20 7365 6c66       return self
-0005c680: 2e5f 6c6c 5f74 7265 655f 7365 7175 656e  ._ll_tree_sequen
-0005c690: 6365 2e6d 6561 6e5f 6465 7363 656e 6461  ce.mean_descenda
-0005c6a0: 6e74 7328 7361 6d70 6c65 5f73 6574 7329  nts(sample_sets)
-0005c6b0: 0a0a 2020 2020 6465 6620 6765 6e65 616c  ..    def geneal
-0005c6c0: 6f67 6963 616c 5f6e 6561 7265 7374 5f6e  ogical_nearest_n
-0005c6d0: 6569 6768 626f 7572 7328 7365 6c66 2c20  eighbours(self, 
-0005c6e0: 666f 6361 6c2c 2073 616d 706c 655f 7365  focal, sample_se
-0005c6f0: 7473 2c20 6e75 6d5f 7468 7265 6164 733d  ts, num_threads=
-0005c700: 3029 3a0a 2020 2020 2020 2020 2222 220a  0):.        """.
-0005c710: 2020 2020 2020 2020 5265 7475 726e 2074          Return t
-0005c720: 6865 2067 656e 6561 6c6f 6769 6361 6c20  he genealogical 
-0005c730: 6e65 6172 6573 7420 6e65 6967 6862 6f75  nearest neighbou
-0005c740: 7273 2028 474e 4e29 2070 726f 706f 7274  rs (GNN) proport
-0005c750: 696f 6e73 2066 6f72 2074 6865 2067 6976  ions for the giv
-0005c760: 656e 0a20 2020 2020 2020 2066 6f63 616c  en.        focal
-0005c770: 206e 6f64 6573 2c20 7769 7468 2072 6566   nodes, with ref
-0005c780: 6572 656e 6365 2074 6f20 7477 6f20 6f72  erence to two or
-0005c790: 206d 6f72 6520 7365 7473 206f 6620 696e   more sets of in
-0005c7a0: 7465 7265 7374 2c20 6176 6572 6167 6564  terest, averaged
-0005c7b0: 206f 7665 7220 616c 6c0a 2020 2020 2020   over all.      
-0005c7c0: 2020 7472 6565 7320 696e 2074 6865 2074    trees in the t
-0005c7d0: 7265 6520 7365 7175 656e 6365 2e0a 0a20  ree sequence... 
-0005c7e0: 2020 2020 2020 2054 6865 2047 4e4e 2070         The GNN p
-0005c7f0: 726f 706f 7274 696f 6e73 2066 6f72 2061  roportions for a
-0005c800: 2066 6f63 616c 206e 6f64 6520 696e 2061   focal node in a
-0005c810: 2073 696e 676c 6520 7472 6565 2061 7265   single tree are
-0005c820: 2067 6976 656e 2062 7920 6669 7273 7420   given by first 
-0005c830: 6669 6e64 696e 670a 2020 2020 2020 2020  finding.        
-0005c840: 7468 6520 6d6f 7374 2072 6563 656e 7420  the most recent 
-0005c850: 636f 6d6d 6f6e 2061 6e63 6573 7472 616c  common ancestral
-0005c860: 206e 6f64 6520 3a6d 6174 683a 6061 6020   node :math:`a` 
-0005c870: 6265 7477 6565 6e20 7468 6520 666f 6361  between the foca
-0005c880: 6c20 6e6f 6465 2061 6e64 2061 6e79 0a20  l node and any. 
-0005c890: 2020 2020 2020 206f 7468 6572 206e 6f64         other nod
-0005c8a0: 6520 7072 6573 656e 7420 696e 2074 6865  e present in the
-0005c8b0: 2072 6566 6572 656e 6365 2073 6574 732e   reference sets.
-0005c8c0: 2054 6865 2047 4e4e 2070 726f 706f 7274   The GNN proport
-0005c8d0: 696f 6e20 666f 7220 6120 7370 6563 6966  ion for a specif
-0005c8e0: 6963 0a20 2020 2020 2020 2072 6566 6572  ic.        refer
-0005c8f0: 656e 6365 2073 6574 2c20 3a6d 6174 683a  ence set, :math:
-0005c900: 6053 6020 6973 2074 6865 206e 756d 6265  `S` is the numbe
-0005c910: 7220 6f66 206e 6f64 6573 2069 6e20 3a6d  r of nodes in :m
-0005c920: 6174 683a 6053 6020 7468 6174 2064 6573  ath:`S` that des
-0005c930: 6365 6e64 2066 726f 6d0a 2020 2020 2020  cend from.      
-0005c940: 2020 3a6d 6174 683a 6061 602c 2061 7320    :math:`a`, as 
-0005c950: 6120 7072 6f70 6f72 7469 6f6e 206f 6620  a proportion of 
-0005c960: 7468 6520 746f 7461 6c20 6e75 6d62 6572  the total number
-0005c970: 206f 6620 6465 7363 656e 6461 6e74 206e   of descendant n
-0005c980: 6f64 6573 2069 6e20 616e 7920 6f66 2074  odes in any of t
-0005c990: 6865 0a20 2020 2020 2020 2072 6566 6572  he.        refer
-0005c9a0: 656e 6365 2073 6574 732e 0a0a 2020 2020  ence sets...    
-0005c9b0: 2020 2020 466f 7220 6578 616d 706c 652c      For example,
-0005c9c0: 2063 6f6e 7369 6465 7220 6120 6361 7365   consider a case
-0005c9d0: 2077 6974 6820 3220 7361 6d70 6c65 2073   with 2 sample s
-0005c9e0: 6574 732c 203a 6d61 7468 3a60 535f 3160  ets, :math:`S_1`
-0005c9f0: 2061 6e64 203a 6d61 7468 3a60 535f 3260   and :math:`S_2`
-0005ca00: 2e0a 2020 2020 2020 2020 466f 7220 6120  ..        For a 
-0005ca10: 6769 7665 6e20 7472 6565 2c20 3a6d 6174  given tree, :mat
-0005ca20: 683a 6061 6020 6973 2074 6865 206e 6f64  h:`a` is the nod
-0005ca30: 6520 7468 6174 2069 6e63 6c75 6465 7320  e that includes 
-0005ca40: 6174 206c 6561 7374 206f 6e65 2064 6573  at least one des
-0005ca50: 6365 6e64 616e 7420 696e 0a20 2020 2020  cendant in.     
-0005ca60: 2020 203a 6d61 7468 3a60 535f 3160 206f     :math:`S_1` o
-0005ca70: 7220 3a6d 6174 683a 6053 5f32 6020 286e  r :math:`S_2` (n
-0005ca80: 6f74 2069 6e63 6c75 6469 6e67 2074 6865  ot including the
-0005ca90: 2066 6f63 616c 206e 6f64 6529 2e20 4966   focal node). If
-0005caa0: 2074 6865 2064 6573 6365 6e64 616e 7473   the descendants
-0005cab0: 206f 660a 2020 2020 2020 2020 3a6d 6174   of.        :mat
-0005cac0: 683a 6061 6020 696e 636c 7564 6520 736f  h:`a` include so
-0005cad0: 6d65 206e 6f64 6573 2069 6e20 3a6d 6174  me nodes in :mat
-0005cae0: 683a 6053 5f31 6020 6275 7420 6e6f 206e  h:`S_1` but no n
-0005caf0: 6f64 6573 2069 6e20 3a6d 6174 683a 6053  odes in :math:`S
-0005cb00: 5f32 602c 2074 6865 6e20 7468 650a 2020  _2`, then the.  
-0005cb10: 2020 2020 2020 474e 4e20 7072 6f70 6f72        GNN propor
-0005cb20: 7469 6f6e 7320 666f 7220 7468 6174 2074  tions for that t
-0005cb30: 7265 6520 7769 6c6c 2062 6520 3130 3025  ree will be 100%
-0005cb40: 203a 6d61 7468 3a60 535f 3160 2061 6e64   :math:`S_1` and
-0005cb50: 2030 2520 3a6d 6174 683a 6053 5f32 602c   0% :math:`S_2`,
-0005cb60: 206f 720a 2020 2020 2020 2020 3a6d 6174   or.        :mat
-0005cb70: 683a 605b 312e 302c 2030 2e30 5d60 2e0a  h:`[1.0, 0.0]`..
-0005cb80: 0a20 2020 2020 2020 2046 6f72 2061 2067  .        For a g
-0005cb90: 6976 656e 2066 6f63 616c 206e 6f64 652c  iven focal node,
-0005cba0: 2074 6865 2047 4e4e 2070 726f 706f 7274   the GNN proport
-0005cbb0: 696f 6e73 2072 6574 7572 6e65 6420 6279  ions returned by
-0005cbc0: 2074 6869 7320 6675 6e63 7469 6f6e 2061   this function a
-0005cbd0: 7265 2061 6e0a 2020 2020 2020 2020 6176  re an.        av
-0005cbe0: 6572 6167 6520 6f66 2074 6865 2047 4e4e  erage of the GNN
-0005cbf0: 7320 666f 7220 6561 6368 2074 7265 652c  s for each tree,
-0005cc00: 2077 6569 6768 7465 6420 6279 2074 6865   weighted by the
-0005cc10: 2067 656e 6f6d 6963 2064 6973 7461 6e63   genomic distanc
-0005cc20: 6520 7370 616e 6e65 6420 6279 0a20 2020  e spanned by.   
-0005cc30: 2020 2020 2074 6861 7420 7472 6565 2e0a       that tree..
-0005cc40: 0a20 2020 2020 2020 2046 6f72 2061 6e20  .        For an 
-0005cc50: 7072 6563 6973 6520 6d61 7468 656d 6174  precise mathemat
-0005cc60: 6963 616c 2064 6566 696e 6974 696f 6e20  ical definition 
-0005cc70: 6f66 2047 4e4e 2c20 7365 6520 6874 7470  of GNN, see http
-0005cc80: 733a 2f2f 646f 692e 6f72 672f 3130 2e31  s://doi.org/10.1
-0005cc90: 3130 312f 3435 3830 3637 0a0a 2020 2020  101/458067..    
-0005cca0: 2020 2020 2e2e 206e 6f74 653a 3a20 5468      .. note:: Th
-0005ccb0: 6520 7265 6665 7265 6e63 6520 7365 7473  e reference sets
-0005ccc0: 206e 6565 6420 6e6f 7420 696e 636c 7564   need not includ
-0005ccd0: 6520 616c 6c20 7468 6520 7361 6d70 6c65  e all the sample
-0005cce0: 732c 2068 656e 6365 2074 6865 206d 6f73  s, hence the mos
-0005ccf0: 740a 2020 2020 2020 2020 2020 2020 7265  t.            re
-0005cd00: 6365 6e74 2063 6f6d 6d6f 6e20 616e 6365  cent common ance
-0005cd10: 7374 7261 6c20 6e6f 6465 206f 6620 7468  stral node of th
-0005cd20: 6520 7265 6665 7265 6e63 6520 7365 7473  e reference sets
-0005cd30: 2c20 3a6d 6174 683a 6061 602c 206e 6565  , :math:`a`, nee
-0005cd40: 6420 6e6f 7420 6265 0a20 2020 2020 2020  d not be.       
-0005cd50: 2020 2020 2074 6865 2069 6d6d 6564 6961       the immedia
-0005cd60: 7465 2061 6e63 6573 746f 7220 6f66 2074  te ancestor of t
-0005cd70: 6865 2066 6f63 616c 206e 6f64 652e 2049  he focal node. I
-0005cd80: 6620 7468 6520 7265 6665 7265 6e63 6520  f the reference 
-0005cd90: 7365 7473 206f 6e6c 7920 636f 6d70 7269  sets only compri
-0005cda0: 7365 0a20 2020 2020 2020 2020 2020 2073  se.            s
-0005cdb0: 6571 7565 6e63 6573 2066 726f 6d20 7265  equences from re
-0005cdc0: 6c61 7469 7665 6c79 2064 6973 7461 6e74  latively distant
-0005cdd0: 2069 6e64 6976 6964 7561 6c73 2c20 7468   individuals, th
-0005cde0: 6520 474e 4e20 7374 6174 6973 7469 6320  e GNN statistic 
-0005cdf0: 6d61 7920 656e 6420 7570 0a20 2020 2020  may end up.     
-0005ce00: 2020 2020 2020 2061 7320 6120 6d65 6173         as a meas
-0005ce10: 7572 6520 6f66 2063 6f6d 7061 7261 7469  ure of comparati
-0005ce20: 7665 6c79 2064 6973 7461 6e74 2061 6e63  vely distant anc
-0005ce30: 6573 7472 792c 2065 7665 6e20 666f 7220  estry, even for 
-0005ce40: 7472 6565 2073 6571 7565 6e63 6573 2074  tree sequences t
-0005ce50: 6861 740a 2020 2020 2020 2020 2020 2020  hat.            
-0005ce60: 636f 6e74 6169 6e20 6d61 6e79 2063 6c6f  contain many clo
-0005ce70: 7365 6c79 2072 656c 6174 6564 2069 6e64  sely related ind
-0005ce80: 6976 6964 7561 6c73 2e0a 0a20 2020 2020  ividuals...     
-0005ce90: 2020 202e 2e20 7761 726e 696e 673a 3a20     .. warning:: 
-0005cea0: 5468 6520 696e 7465 7266 6163 6520 666f  The interface fo
-0005ceb0: 7220 7468 6973 206d 6574 686f 6420 6973  r this method is
-0005cec0: 2070 7265 6c69 6d69 6e61 7279 2061 6e64   preliminary and
-0005ced0: 206d 6179 2062 6520 7375 626a 6563 7420   may be subject 
-0005cee0: 746f 0a20 2020 2020 2020 2020 2020 2062  to.            b
-0005cef0: 6163 6b77 6172 6473 2069 6e63 6f6d 7061  ackwards incompa
-0005cf00: 7469 626c 6520 6368 616e 6765 7320 696e  tible changes in
-0005cf10: 2074 6865 206e 6561 7220 6675 7475 7265   the near future
-0005cf20: 2e20 5468 6520 6c6f 6e67 2d74 6572 6d20  . The long-term 
-0005cf30: 7374 6162 6c65 0a20 2020 2020 2020 2020  stable.         
-0005cf40: 2020 2041 5049 2066 6f72 2074 6869 7320     API for this 
-0005cf50: 6d65 7468 6f64 2077 696c 6c20 6265 2063  method will be c
-0005cf60: 6f6e 7369 7374 656e 7420 7769 7468 206f  onsistent with o
-0005cf70: 7468 6572 203a 7265 663a 6073 6563 5f73  ther :ref:`sec_s
-0005cf80: 7461 7473 602e 0a0a 2020 2020 2020 2020  tats`...        
-0005cf90: 3a70 6172 616d 206c 6973 7420 666f 6361  :param list foca
-0005cfa0: 6c3a 2041 206c 6973 7420 6f66 203a 6d61  l: A list of :ma
-0005cfb0: 7468 3a60 6e60 206e 6f64 6573 2077 686f  th:`n` nodes who
-0005cfc0: 7365 2047 4e4e 7320 7368 6f75 6c64 2062  se GNNs should b
-0005cfd0: 6520 6361 6c63 756c 6174 6564 2e0a 2020  e calculated..  
-0005cfe0: 2020 2020 2020 3a70 6172 616d 206c 6973        :param lis
-0005cff0: 7420 7361 6d70 6c65 5f73 6574 733a 2041  t sample_sets: A
-0005d000: 206c 6973 7420 6f66 203a 6d61 7468 3a60   list of :math:`
-0005d010: 6d60 206c 6973 7473 206f 6620 6e6f 6465  m` lists of node
-0005d020: 2049 4473 2e0a 2020 2020 2020 2020 3a72   IDs..        :r
-0005d030: 6574 7572 6e3a 2041 6e20 3a6d 6174 683a  eturn: An :math:
-0005d040: 606e 6020 2062 7920 3a6d 6174 683a 606d  `n`  by :math:`m
-0005d050: 6020 6172 7261 7920 6f66 2066 6f63 616c  ` array of focal
-0005d060: 206e 6f64 6573 2062 7920 474e 4e20 7072   nodes by GNN pr
-0005d070: 6f70 6f72 7469 6f6e 732e 0a20 2020 2020  oportions..     
-0005d080: 2020 2020 2020 2045 7665 7279 2066 6f63         Every foc
-0005d090: 616c 206e 6f64 6520 636f 7272 6573 706f  al node correspo
-0005d0a0: 6e64 7320 746f 2061 2072 6f77 2e20 5468  nds to a row. Th
-0005d0b0: 6520 6e75 6d62 6572 7320 696e 2065 6163  e numbers in eac
-0005d0c0: 680a 2020 2020 2020 2020 2020 2020 726f  h.            ro
-0005d0d0: 7720 636f 7272 6573 706f 6e64 696e 6720  w corresponding 
-0005d0e0: 746f 2074 6865 2047 4e4e 2070 726f 706f  to the GNN propo
-0005d0f0: 7274 696f 6e20 666f 7220 6561 6368 206f  rtion for each o
-0005d100: 6620 7468 6520 7061 7373 6564 2d69 6e20  f the passed-in 
-0005d110: 7265 6665 7265 6e63 650a 2020 2020 2020  reference.      
-0005d120: 2020 2020 2020 7365 7473 2e20 526f 7773        sets. Rows
-0005d130: 2074 6865 7265 666f 7265 2073 756d 2074   therefore sum t
-0005d140: 6f20 6f6e 652e 0a20 2020 2020 2020 203a  o one..        :
-0005d150: 7274 7970 653a 206e 756d 7079 2e6e 6461  rtype: numpy.nda
-0005d160: 7272 6179 0a20 2020 2020 2020 2022 2222  rray.        """
-0005d170: 0a20 2020 2020 2020 2023 2054 4f44 4f20  .        # TODO 
-0005d180: 6164 6420 7769 6e64 6f77 733d 4e6f 6e65  add windows=None
-0005d190: 206f 7074 696f 6e3a 2068 7474 7073 3a2f   option: https:/
-0005d1a0: 2f67 6974 6875 622e 636f 6d2f 7473 6b69  /github.com/tski
-0005d1b0: 742d 6465 762f 7473 6b69 742f 6973 7375  t-dev/tskit/issu
-0005d1c0: 6573 2f31 3933 0a20 2020 2020 2020 2069  es/193.        i
-0005d1d0: 6620 6e75 6d5f 7468 7265 6164 7320 3c3d  f num_threads <=
-0005d1e0: 2030 3a0a 2020 2020 2020 2020 2020 2020   0:.            
-0005d1f0: 7265 7475 726e 2073 656c 662e 5f6c 6c5f  return self._ll_
-0005d200: 7472 6565 5f73 6571 7565 6e63 652e 6765  tree_sequence.ge
-0005d210: 6e65 616c 6f67 6963 616c 5f6e 6561 7265  nealogical_neare
-0005d220: 7374 5f6e 6569 6768 626f 7572 7328 0a20  st_neighbours(. 
-0005d230: 2020 2020 2020 2020 2020 2020 2020 2066                 f
-0005d240: 6f63 616c 2c20 7361 6d70 6c65 5f73 6574  ocal, sample_set
-0005d250: 730a 2020 2020 2020 2020 2020 2020 290a  s.            ).
-0005d260: 2020 2020 2020 2020 656c 7365 3a0a 2020          else:.  
-0005d270: 2020 2020 2020 2020 2020 776f 726b 6572            worker
-0005d280: 203d 2066 756e 6374 6f6f 6c73 2e70 6172   = functools.par
-0005d290: 7469 616c 280a 2020 2020 2020 2020 2020  tial(.          
-0005d2a0: 2020 2020 2020 7365 6c66 2e5f 6c6c 5f74        self._ll_t
-0005d2b0: 7265 655f 7365 7175 656e 6365 2e67 656e  ree_sequence.gen
-0005d2c0: 6561 6c6f 6769 6361 6c5f 6e65 6172 6573  ealogical_neares
-0005d2d0: 745f 6e65 6967 6862 6f75 7273 2c0a 2020  t_neighbours,.  
-0005d2e0: 2020 2020 2020 2020 2020 2020 2020 7265                re
-0005d2f0: 6665 7265 6e63 655f 7365 7473 3d73 616d  ference_sets=sam
-0005d300: 706c 655f 7365 7473 2c0a 2020 2020 2020  ple_sets,.      
-0005d310: 2020 2020 2020 290a 2020 2020 2020 2020        ).        
-0005d320: 2020 2020 666f 6361 6c20 3d20 7574 696c      focal = util
-0005d330: 2e73 6166 655f 6e70 5f69 6e74 5f63 6173  .safe_np_int_cas
-0005d340: 7428 666f 6361 6c2c 206e 702e 696e 7433  t(focal, np.int3
-0005d350: 3229 0a20 2020 2020 2020 2020 2020 2073  2).            s
-0005d360: 706c 6974 7320 3d20 6e70 2e61 7272 6179  plits = np.array
-0005d370: 5f73 706c 6974 2866 6f63 616c 2c20 6e75  _split(focal, nu
-0005d380: 6d5f 7468 7265 6164 7329 0a20 2020 2020  m_threads).     
-0005d390: 2020 2020 2020 2077 6974 6820 636f 6e63         with conc
-0005d3a0: 7572 7265 6e74 2e66 7574 7572 6573 2e54  urrent.futures.T
-0005d3b0: 6872 6561 6450 6f6f 6c45 7865 6375 746f  hreadPoolExecuto
-0005d3c0: 7228 6d61 785f 776f 726b 6572 733d 6e75  r(max_workers=nu
-0005d3d0: 6d5f 7468 7265 6164 7329 2061 7320 706f  m_threads) as po
-0005d3e0: 6f6c 3a0a 2020 2020 2020 2020 2020 2020  ol:.            
-0005d3f0: 2020 2020 6172 7261 7973 203d 2070 6f6f      arrays = poo
-0005d400: 6c2e 6d61 7028 776f 726b 6572 2c20 7370  l.map(worker, sp
-0005d410: 6c69 7473 290a 2020 2020 2020 2020 2020  lits).          
-0005d420: 2020 7265 7475 726e 206e 702e 7673 7461    return np.vsta
-0005d430: 636b 286c 6973 7428 6172 7261 7973 2929  ck(list(arrays))
-0005d440: 0a0a 2020 2020 6465 6620 6b63 5f64 6973  ..    def kc_dis
-0005d450: 7461 6e63 6528 7365 6c66 2c20 6f74 6865  tance(self, othe
-0005d460: 722c 206c 616d 6264 615f 3d30 2e30 293a  r, lambda_=0.0):
-0005d470: 0a20 2020 2020 2020 2022 2222 0a20 2020  .        """.   
-0005d480: 2020 2020 2052 6574 7572 6e73 2074 6865       Returns the
-0005d490: 2061 7665 7261 6765 203a 6d65 7468 3a60   average :meth:`
-0005d4a0: 5472 6565 2e6b 635f 6469 7374 616e 6365  Tree.kc_distance
-0005d4b0: 6020 6265 7477 6565 6e20 7061 6972 7320  ` between pairs 
-0005d4c0: 6f66 2074 7265 6573 2061 6c6f 6e67 0a20  of trees along. 
-0005d4d0: 2020 2020 2020 2074 6865 2073 6571 7565         the seque
-0005d4e0: 6e63 6520 7768 6f73 6520 696e 7465 7276  nce whose interv
-0005d4f0: 616c 7320 6f76 6572 6c61 702e 2054 6865  als overlap. The
-0005d500: 2061 7665 7261 6765 2069 7320 7765 6967   average is weig
-0005d510: 6874 6564 2062 7920 7468 650a 2020 2020  hted by the.    
-0005d520: 2020 2020 6672 6163 7469 6f6e 206f 6620      fraction of 
-0005d530: 7468 6520 7365 7175 656e 6365 206f 6e20  the sequence on 
-0005d540: 7768 6963 6820 6561 6368 2070 6169 7220  which each pair 
-0005d550: 6f66 2074 7265 6573 206f 7665 726c 6170  of trees overlap
-0005d560: 2e0a 0a20 2020 2020 2020 203a 7061 7261  ...        :para
-0005d570: 6d20 5472 6565 5365 7175 656e 6365 206f  m TreeSequence o
-0005d580: 7468 6572 3a20 5468 6520 6f74 6865 7220  ther: The other 
-0005d590: 7472 6565 2073 6571 7565 6e63 6520 746f  tree sequence to
-0005d5a0: 2063 6f6d 7061 7265 2074 6f2e 0a20 2020   compare to..   
-0005d5b0: 2020 2020 203a 7061 7261 6d20 666c 6f61       :param floa
-0005d5c0: 7420 6c61 6d62 6461 5f3a 2054 6865 204b  t lambda_: The K
-0005d5d0: 4320 6d65 7472 6963 206c 616d 6264 6120  C metric lambda 
-0005d5e0: 7061 7261 6d65 7465 7220 6465 7465 726d  parameter determ
-0005d5f0: 696e 696e 6720 7468 650a 2020 2020 2020  ining the.      
-0005d600: 2020 2020 2020 7265 6c61 7469 7665 2077        relative w
-0005d610: 6569 6768 7420 6f66 2074 6f70 6f6c 6f67  eight of topolog
-0005d620: 7920 616e 6420 6272 616e 6368 206c 656e  y and branch len
-0005d630: 6774 682e 0a20 2020 2020 2020 203a 7265  gth..        :re
-0005d640: 7475 726e 3a20 5468 6520 636f 6d70 7574  turn: The comput
-0005d650: 6564 204b 4320 6469 7374 616e 6365 2062  ed KC distance b
-0005d660: 6574 7765 656e 2074 6869 7320 7472 6565  etween this tree
-0005d670: 2073 6571 7565 6e63 6520 616e 6420 6f74   sequence and ot
-0005d680: 6865 722e 0a20 2020 2020 2020 203a 7274  her..        :rt
-0005d690: 7970 653a 2066 6c6f 6174 0a20 2020 2020  ype: float.     
-0005d6a0: 2020 2022 2222 0a20 2020 2020 2020 2072     """.        r
-0005d6b0: 6574 7572 6e20 7365 6c66 2e5f 6c6c 5f74  eturn self._ll_t
-0005d6c0: 7265 655f 7365 7175 656e 6365 2e67 6574  ree_sequence.get
-0005d6d0: 5f6b 635f 6469 7374 616e 6365 286f 7468  _kc_distance(oth
-0005d6e0: 6572 2e5f 6c6c 5f74 7265 655f 7365 7175  er._ll_tree_sequ
-0005d6f0: 656e 6365 2c20 6c61 6d62 6461 5f29 0a0a  ence, lambda_)..
-0005d700: 2020 2020 6465 6620 636f 756e 745f 746f      def count_to
-0005d710: 706f 6c6f 6769 6573 2873 656c 662c 2073  pologies(self, s
-0005d720: 616d 706c 655f 7365 7473 3d4e 6f6e 6529  ample_sets=None)
-0005d730: 3a0a 2020 2020 2020 2020 2222 220a 2020  :.        """.  
-0005d740: 2020 2020 2020 5265 7475 726e 7320 6120        Returns a 
-0005d750: 6765 6e65 7261 746f 7220 7468 6174 2070  generator that p
-0005d760: 726f 6475 6365 7320 7468 6520 7361 6d65  roduces the same
-0005d770: 2064 6973 7472 6962 7574 696f 6e20 6f66   distribution of
-0005d780: 2074 6f70 6f6c 6f67 6965 7320 6173 0a20   topologies as. 
-0005d790: 2020 2020 2020 203a 6d65 7468 3a60 5472         :meth:`Tr
-0005d7a0: 6565 2e63 6f75 6e74 5f74 6f70 6f6c 6f67  ee.count_topolog
-0005d7b0: 6965 7360 2062 7574 2073 6571 7565 6e74  ies` but sequent
-0005d7c0: 6961 6c6c 7920 666f 7220 6576 6572 7920  ially for every 
-0005d7d0: 7472 6565 2069 6e20 6120 7472 6565 0a20  tree in a tree. 
-0005d7e0: 2020 2020 2020 2073 6571 7565 6e63 652e         sequence.
-0005d7f0: 2046 6f72 2075 7365 206f 6e20 6120 7472   For use on a tr
-0005d800: 6565 2073 6571 7565 6e63 6520 7468 6973  ee sequence this
-0005d810: 206d 6574 686f 6420 6973 206d 7563 6820   method is much 
-0005d820: 6661 7374 6572 2074 6861 6e0a 2020 2020  faster than.    
-0005d830: 2020 2020 636f 6d70 7574 696e 6720 7468      computing th
-0005d840: 6520 7265 7375 6c74 2069 6e64 6570 656e  e result indepen
-0005d850: 6465 6e74 6c79 2070 6572 2074 7265 652e  dently per tree.
-0005d860: 0a0a 2020 2020 2020 2020 2e2e 2077 6172  ..        .. war
-0005d870: 6e69 6e67 3a3a 2054 6865 2069 6e74 6572  ning:: The inter
-0005d880: 6661 6365 2066 6f72 2074 6869 7320 6d65  face for this me
-0005d890: 7468 6f64 2069 7320 7072 656c 696d 696e  thod is prelimin
-0005d8a0: 6172 7920 616e 6420 6d61 7920 6265 2073  ary and may be s
-0005d8b0: 7562 6a65 6374 2074 6f0a 2020 2020 2020  ubject to.      
-0005d8c0: 2020 2020 2020 6261 636b 7761 7264 7320        backwards 
-0005d8d0: 696e 636f 6d70 6174 6962 6c65 2063 6861  incompatible cha
-0005d8e0: 6e67 6573 2069 6e20 7468 6520 6e65 6172  nges in the near
-0005d8f0: 2066 7574 7572 652e 0a0a 2020 2020 2020   future...      
-0005d900: 2020 3a70 6172 616d 206c 6973 7420 7361    :param list sa
-0005d910: 6d70 6c65 5f73 6574 733a 2041 206c 6973  mple_sets: A lis
-0005d920: 7420 6f66 206c 6973 7473 206f 6620 4e6f  t of lists of No
-0005d930: 6465 2049 4473 2c20 7370 6563 6966 7969  de IDs, specifyi
-0005d940: 6e67 2074 6865 0a20 2020 2020 2020 2020  ng the.         
-0005d950: 2020 2067 726f 7570 7320 6f66 206e 6f64     groups of nod
-0005d960: 6573 2074 6f20 636f 6d70 7574 6520 7468  es to compute th
-0005d970: 6520 7374 6174 6973 7469 6320 7769 7468  e statistic with
-0005d980: 2e0a 2020 2020 2020 2020 3a72 7479 7065  ..        :rtype
-0005d990: 3a20 6974 6572 283a 636c 6173 733a 6074  : iter(:class:`t
-0005d9a0: 736b 6974 2e54 6f70 6f6c 6f67 7943 6f75  skit.TopologyCou
-0005d9b0: 6e74 6572 6029 0a20 2020 2020 2020 203a  nter`).        :
-0005d9c0: 7261 6973 6573 2056 616c 7565 4572 726f  raises ValueErro
-0005d9d0: 723a 2049 6620 6e6f 6465 7320 696e 2060  r: If nodes in `
-0005d9e0: 6073 616d 706c 655f 7365 7473 6060 2061  `sample_sets`` a
-0005d9f0: 7265 2069 6e76 616c 6964 206f 7220 6172  re invalid or ar
-0005da00: 650a 2020 2020 2020 2020 2020 2020 696e  e.            in
-0005da10: 7465 726e 616c 2073 616d 706c 6573 2e0a  ternal samples..
-0005da20: 2020 2020 2020 2020 2222 220a 2020 2020          """.    
-0005da30: 2020 2020 6966 2073 616d 706c 655f 7365      if sample_se
-0005da40: 7473 2069 7320 4e6f 6e65 3a0a 2020 2020  ts is None:.    
-0005da50: 2020 2020 2020 2020 7361 6d70 6c65 5f73          sample_s
-0005da60: 6574 7320 3d20 5b0a 2020 2020 2020 2020  ets = [.        
-0005da70: 2020 2020 2020 2020 7365 6c66 2e73 616d          self.sam
-0005da80: 706c 6573 2870 6f70 756c 6174 696f 6e3d  ples(population=
-0005da90: 706f 702e 6964 2920 666f 7220 706f 7020  pop.id) for pop 
-0005daa0: 696e 2073 656c 662e 706f 7075 6c61 7469  in self.populati
-0005dab0: 6f6e 7328 290a 2020 2020 2020 2020 2020  ons().          
-0005dac0: 2020 5d0a 0a20 2020 2020 2020 2079 6965    ]..        yie
-0005dad0: 6c64 2066 726f 6d20 636f 6d62 696e 6174  ld from combinat
-0005dae0: 6f72 6963 732e 7472 6565 7365 715f 636f  orics.treeseq_co
-0005daf0: 756e 745f 746f 706f 6c6f 6769 6573 2873  unt_topologies(s
-0005db00: 656c 662c 2073 616d 706c 655f 7365 7473  elf, sample_sets
-0005db10: 290a 0a20 2020 2064 6566 2069 6264 5f73  )..    def ibd_s
-0005db20: 6567 6d65 6e74 7328 0a20 2020 2020 2020  egments(.       
-0005db30: 2073 656c 662c 0a20 2020 2020 2020 202a   self,.        *
-0005db40: 2c0a 2020 2020 2020 2020 7769 7468 696e  ,.        within
-0005db50: 3d4e 6f6e 652c 0a20 2020 2020 2020 2062  =None,.        b
-0005db60: 6574 7765 656e 3d4e 6f6e 652c 0a20 2020  etween=None,.   
-0005db70: 2020 2020 206d 6178 5f74 696d 653d 4e6f       max_time=No
-0005db80: 6e65 2c0a 2020 2020 2020 2020 6d69 6e5f  ne,.        min_
-0005db90: 7370 616e 3d4e 6f6e 652c 0a20 2020 2020  span=None,.     
-0005dba0: 2020 2073 746f 7265 5f70 6169 7273 3d4e     store_pairs=N
-0005dbb0: 6f6e 652c 0a20 2020 2020 2020 2073 746f  one,.        sto
-0005dbc0: 7265 5f73 6567 6d65 6e74 733d 4e6f 6e65  re_segments=None
-0005dbd0: 2c0a 2020 2020 293a 0a20 2020 2020 2020  ,.    ):.       
-0005dbe0: 2022 2222 0a20 2020 2020 2020 2046 696e   """.        Fin
-0005dbf0: 6473 2070 6169 7273 206f 6620 7361 6d70  ds pairs of samp
-0005dc00: 6c65 7320 7468 6174 2061 7265 2069 6465  les that are ide
-0005dc10: 6e74 6963 616c 2062 7920 6465 7363 656e  ntical by descen
-0005dc20: 7420 2849 4244 2920 616e 6420 7265 7475  t (IBD) and retu
-0005dc30: 726e 730a 2020 2020 2020 2020 7468 6520  rns.        the 
-0005dc40: 7265 7375 6c74 2061 7320 616e 203a 636c  result as an :cl
-0005dc50: 6173 733a 602e 4964 656e 7469 7479 5365  ass:`.IdentitySe
-0005dc60: 676d 656e 7473 6020 696e 7374 616e 6365  gments` instance
-0005dc70: 2e20 5468 6520 696e 666f 726d 6174 696f  . The informatio
-0005dc80: 6e0a 2020 2020 2020 2020 7374 6f72 6564  n.        stored
-0005dc90: 2069 6e20 7468 6973 206f 626a 6563 7420   in this object 
-0005dca0: 6973 2063 6f6e 7472 6f6c 6c65 6420 6279  is controlled by
-0005dcb0: 2074 6865 2060 6073 746f 7265 5f70 6169   the ``store_pai
-0005dcc0: 7273 6060 2061 6e64 0a20 2020 2020 2020  rs`` and.       
-0005dcd0: 2060 6073 746f 7265 5f73 6567 6d65 6e74   ``store_segment
-0005dce0: 7360 6020 7061 7261 6d65 7465 7273 2e20  s`` parameters. 
-0005dcf0: 4279 2064 6566 6175 6c74 206f 6e6c 7920  By default only 
-0005dd00: 746f 7461 6c20 636f 756e 7473 2061 6e64  total counts and
-0005dd10: 206f 7468 6572 0a20 2020 2020 2020 2073   other.        s
-0005dd20: 7461 7469 7374 6963 7320 6f66 2074 6865  tatistics of the
-0005dd30: 2049 4244 2073 6567 6d65 6e74 7320 6172   IBD segments ar
-0005dd40: 6520 7374 6f72 6564 2028 692e 652e 2c0a  e stored (i.e.,.
-0005dd50: 2020 2020 2020 2020 6060 7374 6f72 655f          ``store_
-0005dd60: 7061 6972 733d 4661 6c73 6560 6029 2c20  pairs=False``), 
-0005dd70: 7369 6e63 6520 7374 6f72 696e 6720 7061  since storing pa
-0005dd80: 6972 7320 616e 6420 7365 676d 656e 7473  irs and segments
-0005dd90: 2068 6173 2061 0a20 2020 2020 2020 2073   has a.        s
-0005dda0: 7562 7374 616e 7469 616c 2043 5055 2061  ubstantial CPU a
-0005ddb0: 6e64 206d 656d 6f72 7920 6f76 6572 6865  nd memory overhe
-0005ddc0: 6164 2e20 506c 6561 7365 2073 6565 2074  ad. Please see t
-0005ddd0: 6865 0a20 2020 2020 2020 203a 7265 663a  he.        :ref:
-0005dde0: 6073 6563 5f69 6465 6e74 6974 7960 2073  `sec_identity` s
-0005ddf0: 6563 7469 6f6e 2066 6f72 206d 6f72 6520  ection for more 
-0005de00: 6465 7461 696c 7320 6f6e 2068 6f77 2074  details on how t
-0005de10: 6f20 6163 6365 7373 2074 6865 0a20 2020  o access the.   
-0005de20: 2020 2020 2069 6e66 6f72 6d61 7469 6f6e       information
-0005de30: 2073 746f 7265 6420 696e 2074 6865 203a   stored in the :
-0005de40: 636c 6173 733a 602e 4964 656e 7469 7479  class:`.Identity
-0005de50: 5365 676d 656e 7473 602e 0a0a 2020 2020  Segments`...    
-0005de60: 2020 2020 4966 2060 6077 6974 6869 6e60      If ``within`
-0005de70: 6020 6973 2073 7065 6369 6669 6564 2c20  ` is specified, 
-0005de80: 6f6e 6c79 2049 4244 2073 6567 6d65 6e74  only IBD segment
-0005de90: 7320 666f 7220 7061 6972 7320 6f66 206e  s for pairs of n
-0005dea0: 6f64 6573 2077 6974 6869 6e0a 2020 2020  odes within.    
-0005deb0: 2020 2020 7468 6174 2073 6574 2077 696c      that set wil
-0005dec0: 6c20 6265 2072 6563 6f72 6465 642e 2049  l be recorded. I
-0005ded0: 6620 6060 6265 7477 6565 6e60 6020 6973  f ``between`` is
-0005dee0: 2073 7065 6369 6669 6564 2c20 6f6e 6c79   specified, only
-0005def0: 2049 4244 0a20 2020 2020 2020 2073 6567   IBD.        seg
-0005df00: 6d65 6e74 7320 6672 6f6d 2070 6169 7273  ments from pairs
-0005df10: 2074 6861 7420 6172 6520 696e 206f 6e65   that are in one
-0005df20: 206f 7220 6f74 6865 7220 6f66 2074 6865   or other of the
-0005df30: 2073 7065 6369 6669 6564 2073 616d 706c   specified sampl
-0005df40: 650a 2020 2020 2020 2020 7365 7473 2077  e.        sets w
-0005df50: 696c 6c20 6265 2072 6570 6f72 7465 642e  ill be reported.
-0005df60: 204e 6f74 6520 7468 6174 2060 6077 6974   Note that ``wit
-0005df70: 6869 6e60 6020 616e 6420 6060 6265 7477  hin`` and ``betw
-0005df80: 6565 6e60 6020 6172 650a 2020 2020 2020  een`` are.      
-0005df90: 2020 6d75 7475 616c 6c79 2065 7863 6c75    mutually exclu
-0005dfa0: 7369 7665 2e0a 0a20 2020 2020 2020 2041  sive...        A
-0005dfb0: 2070 6169 7220 6f66 206e 6f64 6573 2060   pair of nodes `
-0005dfc0: 6028 752c 2076 2960 6020 6861 7320 616e  `(u, v)`` has an
-0005dfd0: 2049 4244 2073 6567 6d65 6e74 2077 6974   IBD segment wit
-0005dfe0: 6820 6120 6c65 6674 2061 6e64 2072 6967  h a left and rig
-0005dff0: 6874 0a20 2020 2020 2020 2063 6f6f 7264  ht.        coord
-0005e000: 696e 6174 6520 6060 5b6c 6566 742c 2072  inate ``[left, r
-0005e010: 6967 6874 2960 6020 616e 6420 616e 6365  ight)`` and ance
-0005e020: 7374 7261 6c20 6e6f 6465 2060 6061 6060  stral node ``a``
-0005e030: 2069 6666 2074 6865 206d 6f73 740a 2020   iff the most.  
-0005e040: 2020 2020 2020 7265 6365 6e74 2063 6f6d        recent com
-0005e050: 6d6f 6e20 616e 6365 7374 6f72 206f 6620  mon ancestor of 
-0005e060: 7468 6520 7365 676d 656e 7420 6060 5b6c  the segment ``[l
-0005e070: 6566 742c 2072 6967 6874 2960 6020 696e  eft, right)`` in
-0005e080: 206e 6f64 6573 2060 6075 6060 0a20 2020   nodes ``u``.   
-0005e090: 2020 2020 2061 6e64 2060 6076 6060 2069       and ``v`` i
-0005e0a0: 7320 6060 6160 602c 2061 6e64 2074 6865  s ``a``, and the
-0005e0b0: 2073 6567 6d65 6e74 2068 6173 2062 6565   segment has bee
-0005e0c0: 6e20 696e 6865 7269 7465 6420 616c 6f6e  n inherited alon
-0005e0d0: 6720 7468 6520 7361 6d65 0a20 2020 2020  g the same.     
-0005e0e0: 2020 2067 656e 6561 6c6f 6769 6361 6c20     genealogical 
-0005e0f0: 7061 7468 2028 6965 2e20 6974 2068 6173  path (ie. it has
-0005e100: 206e 6f74 2062 6565 6e20 6272 6f6b 656e   not been broken
-0005e110: 2062 7920 7265 636f 6d62 696e 6174 696f   by recombinatio
-0005e120: 6e29 2e20 5468 650a 2020 2020 2020 2020  n). The.        
-0005e130: 7365 676d 656e 7473 2072 6574 7572 6e65  segments returne
-0005e140: 6420 6172 6520 7468 6520 6c6f 6e67 6573  d are the longes
-0005e150: 7420 706f 7373 6962 6c65 206f 6e65 732e  t possible ones.
-0005e160: 0a0a 2020 2020 2020 2020 4e6f 7465 2074  ..        Note t
-0005e170: 6861 7420 7468 6973 2064 6566 696e 6974  hat this definit
-0005e180: 696f 6e20 6973 2070 7572 656c 7920 6765  ion is purely ge
-0005e190: 6e65 616c 6f67 6963 616c 202d 2d2d 2061  nealogical --- a
-0005e1a0: 6c6c 656c 6963 2073 7461 7465 730a 2020  llelic states.  
-0005e1b0: 2020 2020 2020 2a61 7265 206e 6f74 2a20        *are not* 
-0005e1c0: 636f 6e73 6964 6572 6564 2068 6572 652e  considered here.
-0005e1d0: 2049 6620 7573 6564 2077 6974 686f 7574   If used without
-0005e1e0: 2074 696d 6520 6f72 206c 656e 6774 6820   time or length 
-0005e1f0: 7468 7265 7368 6f6c 6473 2c20 7468 650a  thresholds, the.
-0005e200: 2020 2020 2020 2020 7365 676d 656e 7473          segments
-0005e210: 2072 6574 7572 6e65 6420 666f 7220 6120   returned for a 
-0005e220: 6769 7665 6e20 7061 6972 2077 696c 6c20  given pair will 
-0005e230: 7061 7274 6974 696f 6e20 7468 6520 7370  partition the sp
-0005e240: 616e 206f 6620 7468 6520 636f 6e74 6967  an of the contig
-0005e250: 0a20 2020 2020 2020 2072 6570 7265 7365  .        represe
-0005e260: 6e74 6564 2062 7920 7468 6520 7472 6565  nted by the tree
-0005e270: 2073 6571 7565 6e63 652e 0a0a 2020 2020   sequence...    
-0005e280: 2020 2020 3a70 6172 616d 206c 6973 7420      :param list 
-0005e290: 7769 7468 696e 3a20 4120 6c69 7374 206f  within: A list o
-0005e2a0: 6620 6e6f 6465 2049 4473 2064 6566 696e  f node IDs defin
-0005e2b0: 696e 6720 7365 7420 6f66 206e 6f64 6573  ing set of nodes
-0005e2c0: 2074 6861 740a 2020 2020 2020 2020 2020   that.          
-0005e2d0: 2020 7765 2066 696e 6469 6e67 2049 4244    we finding IBD
-0005e2e0: 2073 6567 6d65 6e74 7320 666f 722e 2049   segments for. I
-0005e2f0: 6620 6e6f 7420 7370 6563 6966 6965 642c  f not specified,
-0005e300: 2074 6869 7320 6465 6661 756c 7473 2074   this defaults t
-0005e310: 6f0a 2020 2020 2020 2020 2020 2020 616c  o.            al
-0005e320: 6c20 7361 6d70 6c65 7320 696e 2074 6865  l samples in the
-0005e330: 2074 7265 6520 7365 7175 656e 6365 2e0a   tree sequence..
-0005e340: 2020 2020 2020 2020 3a70 6172 616d 206c          :param l
-0005e350: 6973 745b 6c69 7374 5d20 6265 7477 6565  ist[list] betwee
-0005e360: 6e3a 2041 206c 6973 7420 6f66 206c 6973  n: A list of lis
-0005e370: 7473 206f 6620 7361 6d70 6c65 206e 6f64  ts of sample nod
-0005e380: 6520 4944 732e 2047 6976 656e 0a20 2020  e IDs. Given.   
-0005e390: 2020 2020 2020 2020 2074 776f 2073 616d           two sam
-0005e3a0: 706c 6520 7365 7473 2041 2061 6e64 2042  ple sets A and B
-0005e3b0: 2c20 6f6e 6c79 2049 4244 2073 6567 6d65  , only IBD segme
-0005e3c0: 6e74 7320 7769 6c6c 2062 6520 7265 7475  nts will be retu
-0005e3d0: 726e 6564 2073 7563 680a 2020 2020 2020  rned such.      
-0005e3e0: 2020 2020 2020 7468 6174 206f 6e65 206f        that one o
-0005e3f0: 6620 7468 6520 7361 6d70 6c65 7320 6973  f the samples is
-0005e400: 2061 6e20 656c 656d 656e 7420 6f66 2041   an element of A
-0005e410: 2061 6e64 2074 6865 206f 7468 6572 2069   and the other i
-0005e420: 730a 2020 2020 2020 2020 2020 2020 616e  s.            an
-0005e430: 2065 6c65 6d65 6e74 206f 6620 422e 2043   element of B. C
-0005e440: 616e 6e6f 7420 6265 2073 7065 6369 6669  annot be specifi
-0005e450: 6564 2077 6974 6820 6060 7769 7468 696e  ed with ``within
-0005e460: 6060 2e0a 2020 2020 2020 2020 3a70 6172  ``..        :par
-0005e470: 616d 2066 6c6f 6174 206d 6178 5f74 696d  am float max_tim
-0005e480: 653a 204f 6e6c 7920 7365 676d 656e 7473  e: Only segments
-0005e490: 2069 6e68 6572 6974 6564 2066 726f 6d20   inherited from 
-0005e4a0: 636f 6d6d 6f6e 0a20 2020 2020 2020 2020  common.         
-0005e4b0: 2020 2061 6e63 6573 746f 7273 2077 686f     ancestors who
-0005e4c0: 7365 206e 6f64 6520 7469 6d65 7320 6172  se node times ar
-0005e4d0: 6520 6d6f 7265 2072 6563 656e 7420 7468  e more recent th
-0005e4e0: 616e 2074 6865 2073 7065 6369 6669 6564  an the specified
-0005e4f0: 2074 696d 650a 2020 2020 2020 2020 2020   time.          
-0005e500: 2020 7769 6c6c 2062 6520 7265 7475 726e    will be return
-0005e510: 6564 2e20 5370 6563 6966 7969 6e67 2061  ed. Specifying a
-0005e520: 206d 6178 696d 756d 2074 696d 6520 6973   maximum time is
-0005e530: 2073 7472 6f6e 676c 7920 7265 636f 6d6d   strongly recomm
-0005e540: 656e 6465 6420 7768 656e 0a20 2020 2020  ended when.     
-0005e550: 2020 2020 2020 2077 6f72 6b69 6e67 2077         working w
-0005e560: 6974 6820 6c61 7267 6520 7472 6565 2073  ith large tree s
-0005e570: 6571 7565 6e63 6573 2e0a 2020 2020 2020  equences..      
-0005e580: 2020 3a70 6172 616d 2066 6c6f 6174 206d    :param float m
-0005e590: 696e 5f73 7061 6e3a 204f 6e6c 7920 7365  in_span: Only se
-0005e5a0: 676d 656e 7473 2069 6e20 7768 6963 6820  gments in which 
-0005e5b0: 7468 6520 6469 6666 6572 656e 6365 2062  the difference b
-0005e5c0: 6574 7765 656e 0a20 2020 2020 2020 2020  etween.         
-0005e5d0: 2020 2074 6865 2072 6967 6874 2061 6e64     the right and
-0005e5e0: 206c 6566 7420 6765 6e6f 6d65 2063 6f6f   left genome coo
-0005e5f0: 7264 696e 6174 6573 2028 692e 652e 2c20  rdinates (i.e., 
-0005e600: 7468 6520 7370 616e 206f 6620 7468 650a  the span of the.
-0005e610: 2020 2020 2020 2020 2020 2020 7365 676d              segm
-0005e620: 656e 7429 2069 7320 6772 6561 7465 7220  ent) is greater 
-0005e630: 7468 616e 2074 6869 7320 7661 6c75 6520  than this value 
-0005e640: 7769 6c6c 2062 6520 696e 636c 7564 6564  will be included
-0005e650: 2e20 2844 6566 6175 6c74 3d30 290a 2020  . (Default=0).  
-0005e660: 2020 2020 2020 3a70 6172 616d 2062 6f6f        :param boo
-0005e670: 6c20 7374 6f72 655f 7061 6972 733a 2049  l store_pairs: I
-0005e680: 6620 5472 7565 2073 746f 7265 2069 6e66  f True store inf
-0005e690: 6f72 6d61 7469 6f6e 2073 6570 6172 6174  ormation separat
-0005e6a0: 656c 7920 666f 7220 6561 6368 0a20 2020  ely for each.   
-0005e6b0: 2020 2020 2020 2020 2070 6169 7220 6f66           pair of
-0005e6c0: 2073 616d 706c 6573 2060 6028 612c 2062   samples ``(a, b
-0005e6d0: 2960 6020 7468 6174 2061 7265 2066 6f75  )`` that are fou
-0005e6e0: 6e64 2074 6f20 6265 2049 4244 2e20 4f74  nd to be IBD. Ot
-0005e6f0: 6865 7277 6973 650a 2020 2020 2020 2020  herwise.        
-0005e700: 2020 2020 7374 6f72 6520 7375 6d6d 6172      store summar
-0005e710: 7920 696e 666f 726d 6174 696f 6e20 6162  y information ab
-0005e720: 6f75 7420 616c 6c20 7361 6d70 6c65 2061  out all sample a
-0005e730: 7069 7273 2e20 2844 6566 6175 6c74 3d46  pirs. (Default=F
-0005e740: 616c 7365 290a 2020 2020 2020 2020 3a70  alse).        :p
-0005e750: 6172 616d 2062 6f6f 6c20 7374 6f72 655f  aram bool store_
-0005e760: 7365 676d 656e 7473 3a20 4966 2054 7275  segments: If Tru
-0005e770: 6520 7374 6f72 6520 6561 6368 2049 4244  e store each IBD
-0005e780: 2073 6567 6d65 6e74 0a20 2020 2020 2020   segment.       
-0005e790: 2020 2020 2060 6028 6c65 6674 2c20 7269       ``(left, ri
-0005e7a0: 6768 742c 2063 2960 6020 616e 6420 6173  ght, c)`` and as
-0005e7b0: 736f 6369 6174 6520 6974 2077 6974 6820  sociate it with 
-0005e7c0: 7468 6520 636f 7272 6573 706f 6e64 696e  the correspondin
-0005e7d0: 670a 2020 2020 2020 2020 2020 2020 7361  g.            sa
-0005e7e0: 6d70 6c65 2070 6169 7220 6060 2861 2c20  mple pair ``(a, 
-0005e7f0: 6229 6060 2e20 4966 2054 7275 652c 2069  b)``. If True, i
-0005e800: 6d70 6c69 6573 2060 6073 746f 7265 5f70  mplies ``store_p
-0005e810: 6169 7273 6060 2e0a 2020 2020 2020 2020  airs``..        
-0005e820: 2020 2020 2844 6566 6175 6c74 3d46 616c      (Default=Fal
-0005e830: 7365 292e 0a20 2020 2020 2020 203a 7265  se)..        :re
-0005e840: 7475 726e 3a20 416e 203a 636c 6173 733a  turn: An :class:
-0005e850: 602e 4964 656e 7469 7479 5365 676d 656e  `.IdentitySegmen
-0005e860: 7473 6020 6f62 6a65 6374 2063 6f6e 7461  ts` object conta
-0005e870: 696e 696e 6720 7468 6520 7265 636f 7264  ining the record
-0005e880: 6564 0a20 2020 2020 2020 2020 2020 2049  ed.            I
-0005e890: 4244 2069 6e66 6f72 6d61 7469 6f6e 2e0a  BD information..
-0005e8a0: 2020 2020 2020 2020 3a72 7479 7065 3a20          :rtype: 
-0005e8b0: 4964 656e 7469 7479 5365 676d 656e 7473  IdentitySegments
-0005e8c0: 0a20 2020 2020 2020 2022 2222 0a20 2020  .        """.   
-0005e8d0: 2020 2020 2072 6574 7572 6e20 7365 6c66       return self
-0005e8e0: 2e74 6162 6c65 732e 6962 645f 7365 676d  .tables.ibd_segm
-0005e8f0: 656e 7473 280a 2020 2020 2020 2020 2020  ents(.          
-0005e900: 2020 7769 7468 696e 3d77 6974 6869 6e2c    within=within,
-0005e910: 0a20 2020 2020 2020 2020 2020 2062 6574  .            bet
-0005e920: 7765 656e 3d62 6574 7765 656e 2c0a 2020  ween=between,.  
-0005e930: 2020 2020 2020 2020 2020 6d61 785f 7469            max_ti
-0005e940: 6d65 3d6d 6178 5f74 696d 652c 0a20 2020  me=max_time,.   
-0005e950: 2020 2020 2020 2020 206d 696e 5f73 7061           min_spa
-0005e960: 6e3d 6d69 6e5f 7370 616e 2c0a 2020 2020  n=min_span,.    
-0005e970: 2020 2020 2020 2020 7374 6f72 655f 7365          store_se
-0005e980: 676d 656e 7473 3d73 746f 7265 5f73 6567  gments=store_seg
-0005e990: 6d65 6e74 732c 0a20 2020 2020 2020 2020  ments,.         
-0005e9a0: 2020 2073 746f 7265 5f70 6169 7273 3d73     store_pairs=s
-0005e9b0: 746f 7265 5f70 6169 7273 2c0a 2020 2020  tore_pairs,.    
-0005e9c0: 2020 2020 290a 0a20 2020 2064 6566 2063      )..    def c
-0005e9d0: 6f61 6c65 7363 656e 6365 5f74 696d 655f  oalescence_time_
-0005e9e0: 6469 7374 7269 6275 7469 6f6e 280a 2020  distribution(.  
-0005e9f0: 2020 2020 2020 7365 6c66 2c0a 2020 2020        self,.    
-0005ea00: 2020 2020 2a2c 0a20 2020 2020 2020 2073      *,.        s
-0005ea10: 616d 706c 655f 7365 7473 3d4e 6f6e 652c  ample_sets=None,
-0005ea20: 0a20 2020 2020 2020 2077 6569 6768 745f  .        weight_
-0005ea30: 6675 6e63 3d4e 6f6e 652c 0a20 2020 2020  func=None,.     
-0005ea40: 2020 2077 696e 646f 775f 6272 6561 6b73     window_breaks
-0005ea50: 3d4e 6f6e 652c 0a20 2020 2020 2020 2062  =None,.        b
-0005ea60: 6c6f 636b 735f 7065 725f 7769 6e64 6f77  locks_per_window
-0005ea70: 3d4e 6f6e 652c 0a20 2020 2020 2020 2073  =None,.        s
-0005ea80: 7061 6e5f 6e6f 726d 616c 6973 653d 4661  pan_normalise=Fa
-0005ea90: 6c73 652c 0a20 2020 2029 3a0a 2020 2020  lse,.    ):.    
-0005eaa0: 2020 2020 2320 544f 444f 2064 6f63 7374      # TODO docst
-0005eab0: 7269 6e67 2c20 6e6f 7420 7965 7420 696e  ring, not yet in
-0005eac0: 2041 5049 0a0a 2020 2020 2020 2020 7265   API..        re
-0005ead0: 7475 726e 2073 7461 7473 2e43 6f61 6c65  turn stats.Coale
-0005eae0: 7363 656e 6365 5469 6d65 4469 7374 7269  scenceTimeDistri
-0005eaf0: 6275 7469 6f6e 280a 2020 2020 2020 2020  bution(.        
-0005eb00: 2020 2020 7365 6c66 2c0a 2020 2020 2020      self,.      
-0005eb10: 2020 2020 2020 7361 6d70 6c65 5f73 6574        sample_set
-0005eb20: 733d 7361 6d70 6c65 5f73 6574 732c 0a20  s=sample_sets,. 
-0005eb30: 2020 2020 2020 2020 2020 2077 6569 6768             weigh
-0005eb40: 745f 6675 6e63 3d77 6569 6768 745f 6675  t_func=weight_fu
-0005eb50: 6e63 2c0a 2020 2020 2020 2020 2020 2020  nc,.            
-0005eb60: 7769 6e64 6f77 5f62 7265 616b 733d 7769  window_breaks=wi
-0005eb70: 6e64 6f77 5f62 7265 616b 732c 0a20 2020  ndow_breaks,.   
-0005eb80: 2020 2020 2020 2020 2062 6c6f 636b 735f           blocks_
-0005eb90: 7065 725f 7769 6e64 6f77 3d62 6c6f 636b  per_window=block
-0005eba0: 735f 7065 725f 7769 6e64 6f77 2c0a 2020  s_per_window,.  
-0005ebb0: 2020 2020 2020 2020 2020 7370 616e 5f6e            span_n
-0005ebc0: 6f72 6d61 6c69 7365 3d73 7061 6e5f 6e6f  ormalise=span_no
-0005ebd0: 726d 616c 6973 652c 0a20 2020 2020 2020  rmalise,.       
-0005ebe0: 2029 0a0a 2020 2020 2323 2323 2323 2323   )..    ########
-0005ebf0: 2323 2323 2323 2323 2323 2323 2323 2323  ################
-0005ec00: 2323 2323 2323 2323 2323 2323 2323 2323  ################
-0005ec10: 2323 2323 0a20 2020 2023 0a20 2020 2023  ####.    #.    #
-0005ec20: 2044 6570 7265 6361 7465 6420 4150 4973   Deprecated APIs
-0005ec30: 2e20 5468 6573 6520 6172 6520 6569 7468  . These are eith
-0005ec40: 6572 2061 6c72 6561 6479 2075 6e73 7570  er already unsup
-0005ec50: 706f 7274 6564 2c20 6f72 2077 696c 6c20  ported, or will 
-0005ec60: 6265 2075 6e73 7570 706f 7274 6564 2069  be unsupported i
-0005ec70: 6e20 610a 2020 2020 2320 6c61 7465 7220  n a.    # later 
-0005ec80: 7265 6c65 6173 652e 0a20 2020 2023 0a20  release..    #. 
-0005ec90: 2020 2023 2323 2323 2323 2323 2323 2323     #############
-0005eca0: 2323 2323 2323 2323 2323 2323 2323 2323  ################
-0005ecb0: 2323 2323 2323 2323 2323 2323 2323 230a  ###############.
-0005ecc0: 0a20 2020 2064 6566 2067 6574 5f70 6169  .    def get_pai
-0005ecd0: 7277 6973 655f 6469 7665 7273 6974 7928  rwise_diversity(
-0005ece0: 7365 6c66 2c20 7361 6d70 6c65 733d 4e6f  self, samples=No
-0005ecf0: 6e65 293a 0a20 2020 2020 2020 2023 2044  ne):.        # D
-0005ed00: 6570 7265 6361 7465 6420 616c 6961 7320  eprecated alias 
-0005ed10: 666f 7220 7365 6c66 2e70 6169 7277 6973  for self.pairwis
-0005ed20: 655f 6469 7665 7273 6974 790a 2020 2020  e_diversity.    
-0005ed30: 2020 2020 7265 7475 726e 2073 656c 662e      return self.
-0005ed40: 7061 6972 7769 7365 5f64 6976 6572 7369  pairwise_diversi
-0005ed50: 7479 2873 616d 706c 6573 290a 0a20 2020  ty(samples)..   
-0005ed60: 2064 6566 2070 6169 7277 6973 655f 6469   def pairwise_di
-0005ed70: 7665 7273 6974 7928 7365 6c66 2c20 7361  versity(self, sa
-0005ed80: 6d70 6c65 733d 4e6f 6e65 293a 0a20 2020  mples=None):.   
-0005ed90: 2020 2020 2022 2222 0a20 2020 2020 2020       """.       
-0005eda0: 2052 6574 7572 6e73 2074 6865 2070 6169   Returns the pai
-0005edb0: 7277 6973 6520 6e75 636c 656f 7469 6465  rwise nucleotide
-0005edc0: 2073 6974 6520 6469 7665 7273 6974 792c   site diversity,
-0005edd0: 2074 6865 2061 7665 7261 6765 206e 756d   the average num
-0005ede0: 6265 7220 6f66 2073 6974 6573 0a20 2020  ber of sites.   
-0005edf0: 2020 2020 2074 6861 7420 6469 6666 6572       that differ
-0005ee00: 2062 6574 7765 656e 2061 2065 7665 7279   between a every
-0005ee10: 2070 6f73 7369 626c 6520 7061 6972 206f   possible pair o
-0005ee20: 6620 6469 7374 696e 6374 2073 616d 706c  f distinct sampl
-0005ee30: 6573 2e20 2049 6620 6073 616d 706c 6573  es.  If `samples
-0005ee40: 6020 6973 0a20 2020 2020 2020 2073 7065  ` is.        spe
-0005ee50: 6369 6669 6564 2c20 6361 6c63 756c 6174  cified, calculat
-0005ee60: 6520 7468 6520 6469 7665 7273 6974 7920  e the diversity 
-0005ee70: 7769 7468 696e 2074 6869 7320 7365 742e  within this set.
-0005ee80: 0a0a 2020 2020 2020 2020 202e 2e20 6465  ..         .. de
-0005ee90: 7072 6563 6174 6564 3a3a 2030 2e32 2e30  precated:: 0.2.0
-0005eea0: 0a20 2020 2020 2020 2020 2020 2020 706c  .             pl
-0005eeb0: 6561 7365 2075 7365 203a 6d65 7468 3a60  ease use :meth:`
-0005eec0: 2e64 6976 6572 7369 7479 6020 696e 7374  .diversity` inst
-0005eed0: 6561 642e 2053 696e 6365 2076 6572 7369  ead. Since versi
-0005eee0: 6f6e 2030 2e32 2e30 2074 6865 2065 7272  on 0.2.0 the err
-0005eef0: 6f72 0a20 2020 2020 2020 2020 2020 2020  or.             
-0005ef00: 7365 6d61 6e74 6963 7320 6861 7665 2061  semantics have a
-0005ef10: 6c73 6f20 6368 616e 6765 6420 736c 6967  lso changed slig
-0005ef20: 6874 6c79 2e20 4974 2069 7320 6e6f 206c  htly. It is no l
-0005ef30: 6f6e 6765 7220 616e 2065 7272 6f72 0a20  onger an error. 
-0005ef40: 2020 2020 2020 2020 2020 2020 7768 656e              when
-0005ef50: 2074 6865 7265 2069 7320 6f6e 6520 7361   there is one sa
-0005ef60: 6d70 6c65 2061 6e64 2061 2074 736b 6974  mple and a tskit
-0005ef70: 2e4c 6962 7261 7279 4572 726f 7220 6973  .LibraryError is
-0005ef80: 2072 6169 7365 640a 2020 2020 2020 2020   raised.        
-0005ef90: 2020 2020 2077 6865 6e20 6e6f 6e2d 7361       when non-sa
-0005efa0: 6d70 6c65 2049 4473 2061 7265 2070 726f  mple IDs are pro
-0005efb0: 7669 6465 6420 7261 7468 6572 2074 6861  vided rather tha
-0005efc0: 6e20 6120 5661 6c75 6545 7272 6f72 2e20  n a ValueError. 
-0005efd0: 4974 2069 730a 2020 2020 2020 2020 2020  It is.          
-0005efe0: 2020 2061 6c73 6f20 6e6f 206c 6f6e 6765     also no longe
-0005eff0: 7220 616e 2065 7272 6f72 2074 6f20 636f  r an error to co
-0005f000: 6d70 7574 6520 7061 6972 7769 7365 2064  mpute pairwise d
-0005f010: 6976 6572 7369 7479 2061 7420 7369 7465  iversity at site
-0005f020: 730a 2020 2020 2020 2020 2020 2020 2077  s.             w
-0005f030: 6974 6820 6d75 6c74 6970 6c65 206d 7574  ith multiple mut
-0005f040: 6174 696f 6e73 2e0a 0a20 2020 2020 2020  ations...       
-0005f050: 203a 7061 7261 6d20 6c69 7374 2073 616d   :param list sam
-0005f060: 706c 6573 3a20 5468 6520 7365 7420 6f66  ples: The set of
-0005f070: 2073 616d 706c 6573 2077 6974 6869 6e20   samples within 
-0005f080: 7768 6963 6820 7765 2063 616c 6375 6c61  which we calcula
-0005f090: 7465 0a20 2020 2020 2020 2020 2020 2074  te.            t
-0005f0a0: 6865 2064 6976 6572 7369 7479 2e20 4966  he diversity. If
-0005f0b0: 204e 6f6e 652c 2063 616c 6375 6c61 7465   None, calculate
-0005f0c0: 2064 6976 6572 7369 7479 2077 6974 6869   diversity withi
-0005f0d0: 6e20 7468 6520 656e 7469 7265 2073 616d  n the entire sam
-0005f0e0: 706c 652e 0a20 2020 2020 2020 203a 7265  ple..        :re
-0005f0f0: 7475 726e 3a20 5468 6520 7061 6972 7769  turn: The pairwi
-0005f100: 7365 206e 7563 6c65 6f74 6964 6520 7369  se nucleotide si
-0005f110: 7465 2064 6976 6572 7369 7479 2e0a 2020  te diversity..  
-0005f120: 2020 2020 2020 3a72 7479 7065 3a20 666c        :rtype: fl
-0005f130: 6f61 740a 2020 2020 2020 2020 2222 220a  oat.        """.
-0005f140: 2020 2020 2020 2020 6966 2073 616d 706c          if sampl
-0005f150: 6573 2069 7320 4e6f 6e65 3a0a 2020 2020  es is None:.    
-0005f160: 2020 2020 2020 2020 7361 6d70 6c65 7320          samples 
-0005f170: 3d20 7365 6c66 2e73 616d 706c 6573 2829  = self.samples()
-0005f180: 0a20 2020 2020 2020 2072 6574 7572 6e20  .        return 
-0005f190: 666c 6f61 7428 0a20 2020 2020 2020 2020  float(.         
-0005f1a0: 2020 2073 656c 662e 6469 7665 7273 6974     self.diversit
-0005f1b0: 7928 0a20 2020 2020 2020 2020 2020 2020  y(.             
-0005f1c0: 2020 205b 7361 6d70 6c65 735d 2c20 7769     [samples], wi
-0005f1d0: 6e64 6f77 733d 5b30 2c20 7365 6c66 2e73  ndows=[0, self.s
-0005f1e0: 6571 7565 6e63 655f 6c65 6e67 7468 5d2c  equence_length],
-0005f1f0: 2073 7061 6e5f 6e6f 726d 616c 6973 653d   span_normalise=
-0005f200: 4661 6c73 650a 2020 2020 2020 2020 2020  False.          
-0005f210: 2020 295b 305d 0a20 2020 2020 2020 2029    )[0].        )
-0005f220: 0a0a 2020 2020 6465 6620 6765 745f 7469  ..    def get_ti
-0005f230: 6d65 2873 656c 662c 2075 293a 0a20 2020  me(self, u):.   
-0005f240: 2020 2020 2023 2044 6570 7265 6361 7465       # Deprecate
-0005f250: 642e 2055 7365 2074 732e 6e6f 6465 2875  d. Use ts.node(u
-0005f260: 292e 7469 6d65 0a20 2020 2020 2020 2069  ).time.        i
-0005f270: 6620 7520 3c20 3020 6f72 2075 203e 3d20  f u < 0 or u >= 
-0005f280: 7365 6c66 2e67 6574 5f6e 756d 5f6e 6f64  self.get_num_nod
-0005f290: 6573 2829 3a0a 2020 2020 2020 2020 2020  es():.          
-0005f2a0: 2020 7261 6973 6520 5661 6c75 6545 7272    raise ValueErr
-0005f2b0: 6f72 2822 4944 206f 7574 206f 6620 626f  or("ID out of bo
-0005f2c0: 756e 6473 2229 0a20 2020 2020 2020 206e  unds").        n
-0005f2d0: 6f64 6520 3d20 7365 6c66 2e6e 6f64 6528  ode = self.node(
-0005f2e0: 7529 0a20 2020 2020 2020 2072 6574 7572  u).        retur
-0005f2f0: 6e20 6e6f 6465 2e74 696d 650a 0a20 2020  n node.time..   
-0005f300: 2064 6566 2067 6574 5f70 6f70 756c 6174   def get_populat
-0005f310: 696f 6e28 7365 6c66 2c20 7529 3a0a 2020  ion(self, u):.  
-0005f320: 2020 2020 2020 2320 4465 7072 6563 6174        # Deprecat
-0005f330: 6564 2e20 5573 6520 7473 2e6e 6f64 6528  ed. Use ts.node(
-0005f340: 7529 2e70 6f70 756c 6174 696f 6e0a 2020  u).population.  
-0005f350: 2020 2020 2020 6966 2075 203c 2030 206f        if u < 0 o
-0005f360: 7220 7520 3e3d 2073 656c 662e 6765 745f  r u >= self.get_
-0005f370: 6e75 6d5f 6e6f 6465 7328 293a 0a20 2020  num_nodes():.   
-0005f380: 2020 2020 2020 2020 2072 6169 7365 2056           raise V
-0005f390: 616c 7565 4572 726f 7228 2249 4420 6f75  alueError("ID ou
-0005f3a0: 7420 6f66 2062 6f75 6e64 7322 290a 2020  t of bounds").  
-0005f3b0: 2020 2020 2020 6e6f 6465 203d 2073 656c        node = sel
-0005f3c0: 662e 6e6f 6465 2875 290a 2020 2020 2020  f.node(u).      
-0005f3d0: 2020 7265 7475 726e 206e 6f64 652e 706f    return node.po
-0005f3e0: 7075 6c61 7469 6f6e 0a0a 2020 2020 6465  pulation..    de
-0005f3f0: 6620 7265 636f 7264 7328 7365 6c66 293a  f records(self):
-0005f400: 0a20 2020 2020 2020 2023 2044 6570 7265  .        # Depre
-0005f410: 6361 7465 642e 2055 7365 2065 6974 6865  cated. Use eithe
-0005f420: 7220 7473 2e65 6467 6573 2829 206f 7220  r ts.edges() or 
-0005f430: 7473 2e65 6467 6573 6574 7328 292e 0a20  ts.edgesets().. 
-0005f440: 2020 2020 2020 2074 203d 205b 6e6f 6465         t = [node
-0005f450: 2e74 696d 6520 666f 7220 6e6f 6465 2069  .time for node i
-0005f460: 6e20 7365 6c66 2e6e 6f64 6573 2829 5d0a  n self.nodes()].
-0005f470: 2020 2020 2020 2020 706f 7020 3d20 5b6e          pop = [n
-0005f480: 6f64 652e 706f 7075 6c61 7469 6f6e 2066  ode.population f
-0005f490: 6f72 206e 6f64 6520 696e 2073 656c 662e  or node in self.
-0005f4a0: 6e6f 6465 7328 295d 0a20 2020 2020 2020  nodes()].       
-0005f4b0: 2066 6f72 2065 2069 6e20 7365 6c66 2e65   for e in self.e
-0005f4c0: 6467 6573 6574 7328 293a 0a20 2020 2020  dgesets():.     
-0005f4d0: 2020 2020 2020 2079 6965 6c64 2043 6f61         yield Coa
-0005f4e0: 6c65 7363 656e 6365 5265 636f 7264 280a  lescenceRecord(.
-0005f4f0: 2020 2020 2020 2020 2020 2020 2020 2020                  
-0005f500: 652e 6c65 6674 2c20 652e 7269 6768 742c  e.left, e.right,
-0005f510: 2065 2e70 6172 656e 742c 2065 2e63 6869   e.parent, e.chi
-0005f520: 6c64 7265 6e2c 2074 5b65 2e70 6172 656e  ldren, t[e.paren
-0005f530: 745d 2c20 706f 705b 652e 7061 7265 6e74  t], pop[e.parent
-0005f540: 5d0a 2020 2020 2020 2020 2020 2020 290a  ].            ).
-0005f550: 0a20 2020 2023 2055 6e73 7570 706f 7274  .    # Unsupport
-0005f560: 6564 206f 6c64 206d 6574 686f 6473 2e0a  ed old methods..
-0005f570: 0a20 2020 2064 6566 2067 6574 5f6e 756d  .    def get_num
-0005f580: 5f72 6563 6f72 6473 2873 656c 6629 3a0a  _records(self):.
-0005f590: 2020 2020 2020 2020 7261 6973 6520 4e6f          raise No
-0005f5a0: 7449 6d70 6c65 6d65 6e74 6564 4572 726f  tImplementedErro
-0005f5b0: 7228 0a20 2020 2020 2020 2020 2020 2022  r(.            "
-0005f5c0: 5468 6973 206d 6574 686f 6420 6973 206e  This method is n
-0005f5d0: 6f20 6c6f 6e67 6572 2073 7570 706f 7274  o longer support
-0005f5e0: 6564 2e20 506c 6561 7365 2075 7365 2074  ed. Please use t
-0005f5f0: 6865 2022 0a20 2020 2020 2020 2020 2020  he ".           
-0005f600: 2022 5472 6565 5365 7175 656e 6365 2e6e   "TreeSequence.n
-0005f610: 756d 5f65 6467 6573 2069 6620 706f 7373  um_edges if poss
-0005f620: 6962 6c65 2074 6f20 776f 726b 2077 6974  ible to work wit
-0005f630: 6820 6564 6765 7320 7261 7468 6572 2022  h edges rather "
-0005f640: 0a20 2020 2020 2020 2020 2020 2022 7468  .            "th
-0005f650: 616e 2063 6f61 6c65 7363 656e 6365 2072  an coalescence r
-0005f660: 6563 6f72 6473 2e20 4966 206e 6f74 2c20  ecords. If not, 
-0005f670: 706c 6561 7365 2075 7365 206c 656e 286c  please use len(l
-0005f680: 6973 7428 7473 2e65 6467 6573 6574 7328  ist(ts.edgesets(
-0005f690: 2929 2920 220a 2020 2020 2020 2020 2020  ))) ".          
-0005f6a0: 2020 2277 6869 6368 2073 686f 756c 6420    "which should 
-0005f6b0: 7265 7475 726e 2074 6865 206e 756d 6265  return the numbe
-0005f6c0: 7220 6f66 2063 6f61 6c65 7363 656e 6365  r of coalescence
-0005f6d0: 2072 6563 6f72 6473 2c20 6173 2070 7265   records, as pre
-0005f6e0: 7669 6f75 736c 7920 220a 2020 2020 2020  viously ".      
-0005f6f0: 2020 2020 2020 2264 6566 696e 6564 2e20        "defined. 
-0005f700: 506c 6561 7365 206f 7065 6e20 616e 2069  Please open an i
-0005f710: 7373 7565 206f 6e20 4769 7448 7562 2069  ssue on GitHub i
-0005f720: 6620 7468 6973 2069 7320 220a 2020 2020  f this is ".    
-0005f730: 2020 2020 2020 2020 2269 6d70 6f72 7461          "importa
-0005f740: 6e74 2066 6f72 2079 6f75 7220 776f 726b  nt for your work
-0005f750: 666c 6f77 2e22 0a20 2020 2020 2020 2029  flow.".        )
-0005f760: 0a0a 2020 2020 6465 6620 6469 6666 7328  ..    def diffs(
-0005f770: 7365 6c66 293a 0a20 2020 2020 2020 2072  self):.        r
-0005f780: 6169 7365 204e 6f74 496d 706c 656d 656e  aise NotImplemen
-0005f790: 7465 6445 7272 6f72 280a 2020 2020 2020  tedError(.      
-0005f7a0: 2020 2020 2020 2254 6869 7320 6d65 7468        "This meth
-0005f7b0: 6f64 2069 7320 6e6f 206c 6f6e 6765 7220  od is no longer 
-0005f7c0: 7375 7070 6f72 7465 642e 2050 6c65 6173  supported. Pleas
-0005f7d0: 6520 7573 6520 7468 6520 220a 2020 2020  e use the ".    
-0005f7e0: 2020 2020 2020 2020 2254 7265 6553 6571          "TreeSeq
-0005f7f0: 7565 6e63 652e 6564 6765 5f64 6966 6673  uence.edge_diffs
-0005f800: 2829 206d 6574 686f 6420 696e 7374 6561  () method instea
-0005f810: 6422 0a20 2020 2020 2020 2029 0a0a 2020  d".        )..  
-0005f820: 2020 6465 6620 6e65 7769 636b 5f74 7265    def newick_tre
-0005f830: 6573 2873 656c 662c 2070 7265 6369 7369  es(self, precisi
-0005f840: 6f6e 3d33 2c20 6272 6561 6b70 6f69 6e74  on=3, breakpoint
-0005f850: 733d 4e6f 6e65 2c20 4e65 3d31 293a 0a20  s=None, Ne=1):. 
-0005f860: 2020 2020 2020 2072 6169 7365 204e 6f74         raise Not
-0005f870: 496d 706c 656d 656e 7465 6445 7272 6f72  ImplementedError
-0005f880: 280a 2020 2020 2020 2020 2020 2020 2254  (.            "T
-0005f890: 6869 7320 6d65 7468 6f64 2069 7320 6e6f  his method is no
-0005f8a0: 206c 6f6e 6765 7220 7375 7070 6f72 7465   longer supporte
-0005f8b0: 642e 2050 6c65 6173 6520 7573 6520 7468  d. Please use th
-0005f8c0: 6520 5472 6565 2e6e 6577 6963 6b22 0a20  e Tree.newick". 
-0005f8d0: 2020 2020 2020 2020 2020 2022 206d 6574             " met
-0005f8e0: 686f 6420 696e 7374 6561 6422 0a20 2020  hod instead".   
-0005f8f0: 2020 2020 2029 0a0a 2020 2020 6465 6620       )..    def 
-0005f900: 746f 5f6e 6578 7573 2873 656c 662c 2070  to_nexus(self, p
-0005f910: 7265 6369 7369 6f6e 3d31 3429 3a0a 2020  recision=14):.  
-0005f920: 2020 2020 2020 7261 6973 6520 4e6f 7449        raise NotI
-0005f930: 6d70 6c65 6d65 6e74 6564 4572 726f 7228  mplementedError(
-0005f940: 0a20 2020 2020 2020 2020 2020 2022 5468  .            "Th
-0005f950: 6973 206d 6574 686f 6420 6973 206e 6f20  is method is no 
-0005f960: 6c6f 6e67 6572 2073 7570 706f 7274 6564  longer supported
-0005f970: 2073 696e 6365 2030 2e34 2e30 2e20 506c   since 0.4.0. Pl
-0005f980: 6561 7365 2075 7365 2074 6865 2061 735f  ease use the as_
-0005f990: 6e65 7875 7320 220a 2020 2020 2020 2020  nexus ".        
-0005f9a0: 2020 2020 226f 7220 7772 6974 655f 6e65      "or write_ne
-0005f9b0: 7875 7320 6d65 7468 6f64 7320 696e 7374  xus methods inst
-0005f9c0: 6561 6422 0a20 2020 2020 2020 2029 0a0a  ead".        )..
-0005f9d0: 0a23 2054 4f44 4f20 6d6f 7665 2074 6f20  .# TODO move to 
-0005f9e0: 2274 6578 745f 666f 726d 6174 732e 7079  "text_formats.py
-0005f9f0: 220a 6465 6620 7772 6974 655f 6d73 280a  ".def write_ms(.
-0005fa00: 2020 2020 7472 6565 5f73 6571 7565 6e63      tree_sequenc
-0005fa10: 652c 0a20 2020 206f 7574 7075 742c 0a20  e,.    output,. 
-0005fa20: 2020 2070 7269 6e74 5f74 7265 6573 3d46     print_trees=F
-0005fa30: 616c 7365 2c0a 2020 2020 7072 6563 6973  alse,.    precis
-0005fa40: 696f 6e3d 342c 0a20 2020 206e 756d 5f72  ion=4,.    num_r
-0005fa50: 6570 6c69 6361 7465 733d 312c 0a20 2020  eplicates=1,.   
-0005fa60: 2077 7269 7465 5f68 6561 6465 723d 5472   write_header=Tr
-0005fa70: 7565 2c0a 293a 0a20 2020 2022 2222 0a20  ue,.):.    """. 
-0005fa80: 2020 2057 7269 7465 2060 606d 7360 6020     Write ``ms`` 
-0005fa90: 666f 726d 6174 7465 6420 6f75 7470 7574  formatted output
-0005faa0: 2066 726f 6d20 7468 6520 6765 6e6f 7479   from the genoty
-0005fab0: 7065 7320 6f66 2061 2074 7265 6520 7365  pes of a tree se
-0005fac0: 7175 656e 6365 0a20 2020 206f 7220 616e  quence.    or an
-0005fad0: 2069 7465 7261 746f 7220 6f76 6572 2074   iterator over t
-0005fae0: 7265 6520 7365 7175 656e 6365 732e 2055  ree sequences. U
-0005faf0: 7361 6765 3a0a 0a20 2020 202e 2e20 636f  sage:..    .. co
-0005fb00: 6465 2d62 6c6f 636b 3a3a 2070 7974 686f  de-block:: pytho
-0005fb10: 6e0a 0a20 2020 2020 2020 2069 6d70 6f72  n..        impor
-0005fb20: 7420 7473 6b69 7420 6173 2074 730a 0a20  t tskit as ts.. 
-0005fb30: 2020 2020 2020 2074 7265 655f 7365 7175         tree_sequ
-0005fb40: 656e 6365 203d 206d 7370 7269 6d65 2e73  ence = msprime.s
-0005fb50: 696d 756c 6174 6528 0a20 2020 2020 2020  imulate(.       
-0005fb60: 2020 2020 2073 616d 706c 655f 7369 7a65       sample_size
-0005fb70: 3d73 616d 706c 655f 7369 7a65 2c0a 2020  =sample_size,.  
-0005fb80: 2020 2020 2020 2020 2020 4e65 3d4e 652c            Ne=Ne,
-0005fb90: 0a20 2020 2020 2020 2020 2020 206c 656e  .            len
-0005fba0: 6774 683d 6c65 6e67 7468 2c0a 2020 2020  gth=length,.    
-0005fbb0: 2020 2020 2020 2020 6d75 7461 7469 6f6e          mutation
-0005fbc0: 5f72 6174 653d 6d75 7461 7469 6f6e 5f72  _rate=mutation_r
-0005fbd0: 6174 652c 0a20 2020 2020 2020 2020 2020  ate,.           
-0005fbe0: 2072 6563 6f6d 6269 6e61 7469 6f6e 5f72   recombination_r
-0005fbf0: 6174 653d 7265 636f 6d62 696e 6174 696f  ate=recombinatio
-0005fc00: 6e5f 7261 7465 2c0a 2020 2020 2020 2020  n_rate,.        
-0005fc10: 2020 2020 7261 6e64 6f6d 5f73 6565 643d      random_seed=
-0005fc20: 7261 6e64 6f6d 5f73 6565 642c 0a20 2020  random_seed,.   
-0005fc30: 2020 2020 2020 2020 206e 756d 5f72 6570           num_rep
-0005fc40: 6c69 6361 7465 733d 6e75 6d5f 7265 706c  licates=num_repl
-0005fc50: 6963 6174 6573 2c0a 2020 2020 2020 2020  icates,.        
-0005fc60: 290a 2020 2020 2020 2020 7769 7468 206f  ).        with o
-0005fc70: 7065 6e28 226f 7574 7075 742e 6d73 222c  pen("output.ms",
-0005fc80: 2022 7722 2920 6173 206d 735f 6669 6c65   "w") as ms_file
-0005fc90: 3a0a 2020 2020 2020 2020 2020 2020 7473  :.            ts
-0005fca0: 2e77 7269 7465 5f6d 7328 7472 6565 5f73  .write_ms(tree_s
-0005fcb0: 6571 7565 6e63 652c 206d 735f 6669 6c65  equence, ms_file
-0005fcc0: 290a 0a20 2020 203a 7061 7261 6d20 7473  )..    :param ts
-0005fcd0: 2074 7265 655f 7365 7175 656e 6365 3a20   tree_sequence: 
-0005fce0: 5468 6520 7472 6565 2073 6571 7565 6e63  The tree sequenc
-0005fcf0: 6520 286f 7220 6974 6572 6174 6f72 206f  e (or iterator o
-0005fd00: 7665 7220 7472 6565 2073 6571 7565 6e63  ver tree sequenc
-0005fd10: 6573 2920 746f 0a20 2020 2020 2020 2077  es) to.        w
-0005fd20: 7269 7465 2074 6f20 6d73 2066 696c 650a  rite to ms file.
-0005fd30: 2020 2020 3a70 6172 616d 2069 6f2e 494f      :param io.IO
-0005fd40: 4261 7365 206f 7574 7075 743a 2054 6865  Base output: The
-0005fd50: 2066 696c 652d 6c69 6b65 206f 626a 6563   file-like objec
-0005fd60: 7420 746f 2077 7269 7465 2074 6865 206d  t to write the m
-0005fd70: 732d 7374 796c 6520 6f75 7470 7574 0a20  s-style output. 
-0005fd80: 2020 203a 7061 7261 6d20 626f 6f6c 2070     :param bool p
-0005fd90: 7269 6e74 5f74 7265 6573 3a20 426f 6f6c  rint_trees: Bool
-0005fda0: 6561 6e20 7061 7261 6d65 7465 7220 746f  ean parameter to
-0005fdb0: 2077 7269 7465 206f 7574 206e 6577 6963   write out newic
-0005fdc0: 6b20 666f 726d 6174 2074 7265 6573 0a20  k format trees. 
-0005fdd0: 2020 2020 2020 2074 6f20 6f75 7470 7574         to output
-0005fde0: 205b 6f70 7469 6f6e 616c 5d0a 2020 2020   [optional].    
-0005fdf0: 3a70 6172 616d 2069 6e74 2070 7265 6369  :param int preci
-0005fe00: 7369 6f6e 3a20 4e75 6d65 7269 6361 6c20  sion: Numerical 
-0005fe10: 7072 6563 6973 696f 6e20 7769 7468 2077  precision with w
-0005fe20: 6869 6368 2074 6f20 7772 6974 6520 7468  hich to write th
-0005fe30: 6520 6d73 0a20 2020 2020 2020 206f 7574  e ms.        out
-0005fe40: 7075 7420 5b6f 7074 696f 6e61 6c5d 0a20  put [optional]. 
-0005fe50: 2020 203a 7061 7261 6d20 626f 6f6c 2077     :param bool w
-0005fe60: 7269 7465 5f68 6561 6465 723a 2042 6f6f  rite_header: Boo
-0005fe70: 6c65 616e 2070 6172 616d 6574 6572 2074  lean parameter t
-0005fe80: 6f20 7772 6974 6520 6f75 7420 7468 6520  o write out the 
-0005fe90: 6865 6164 6572 2e20 5b6f 7074 696f 6e61  header. [optiona
-0005fea0: 6c5d 0a20 2020 203a 7061 7261 6d20 696e  l].    :param in
-0005feb0: 7420 6e75 6d5f 7265 706c 6963 6174 6573  t num_replicates
-0005fec0: 3a20 4e75 6d62 6572 206f 6620 7265 706c  : Number of repl
-0005fed0: 6963 6174 6573 2073 696d 756c 6174 6564  icates simulated
-0005fee0: 205b 7265 7175 6972 6564 2069 660a 2020   [required if.  
-0005fef0: 2020 2020 2020 6e75 6d5f 7265 706c 6963        num_replic
-0005ff00: 6174 6573 2075 7365 6420 696e 2073 696d  ates used in sim
-0005ff10: 756c 6174 696f 6e5d 0a0a 2020 2020 5468  ulation]..    Th
-0005ff20: 6520 6669 7273 7420 6c69 6e65 206f 6620  e first line of 
-0005ff30: 7468 6973 206d 732d 7374 796c 6520 6f75  this ms-style ou
-0005ff40: 7470 7574 2066 696c 6520 7772 6974 7465  tput file writte
-0005ff50: 6e20 6861 7320 7477 6f20 6172 6775 6d65  n has two argume
-0005ff60: 6e74 7320 7768 6963 680a 2020 2020 6172  nts which.    ar
-0005ff70: 6520 7361 6d70 6c65 2073 697a 6520 616e  e sample size an
-0005ff80: 6420 6e75 6d62 6572 206f 6620 7265 706c  d number of repl
-0005ff90: 6963 6174 6573 2e20 5468 6520 7365 636f  icates. The seco
-0005ffa0: 6e64 206c 696e 6520 6861 7320 6120 3020  nd line has a 0 
-0005ffb0: 6173 2061 2073 7562 7374 6974 7574 650a  as a substitute.
-0005ffc0: 2020 2020 666f 7220 7468 6520 7261 6e64      for the rand
-0005ffd0: 6f6d 2073 6565 642e 0a20 2020 2022 2222  om seed..    """
-0005ffe0: 0a20 2020 2069 6620 6e6f 7420 6973 696e  .    if not isin
-0005fff0: 7374 616e 6365 2874 7265 655f 7365 7175  stance(tree_sequ
-00060000: 656e 6365 2c20 636f 6c6c 6563 7469 6f6e  ence, collection
-00060010: 732e 6162 632e 4974 6572 6162 6c65 293a  s.abc.Iterable):
-00060020: 0a20 2020 2020 2020 2074 7265 655f 7365  .        tree_se
-00060030: 7175 656e 6365 203d 205b 7472 6565 5f73  quence = [tree_s
-00060040: 6571 7565 6e63 655d 0a0a 2020 2020 6920  equence]..    i 
-00060050: 3d20 300a 2020 2020 666f 7220 7472 6565  = 0.    for tree
-00060060: 5f73 6571 2069 6e20 7472 6565 5f73 6571  _seq in tree_seq
-00060070: 7565 6e63 653a 0a20 2020 2020 2020 2069  uence:.        i
-00060080: 6620 6920 3e20 303a 0a20 2020 2020 2020  f i > 0:.       
-00060090: 2020 2020 2077 7269 7465 5f68 6561 6465       write_heade
-000600a0: 7220 3d20 4661 6c73 650a 2020 2020 2020  r = False.      
-000600b0: 2020 6920 3d20 6920 2b20 310a 0a20 2020    i = i + 1..   
-000600c0: 2020 2020 2069 6620 7772 6974 655f 6865       if write_he
-000600d0: 6164 6572 2069 7320 5472 7565 3a0a 2020  ader is True:.  
-000600e0: 2020 2020 2020 2020 2020 7072 696e 7428            print(
-000600f0: 0a20 2020 2020 2020 2020 2020 2020 2020  .               
-00060100: 2066 226d 7320 7b74 7265 655f 7365 712e   f"ms {tree_seq.
-00060110: 7361 6d70 6c65 5f73 697a 657d 207b 6e75  sample_size} {nu
-00060120: 6d5f 7265 706c 6963 6174 6573 7d22 2c0a  m_replicates}",.
-00060130: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00060140: 6669 6c65 3d6f 7574 7075 742c 0a20 2020  file=output,.   
-00060150: 2020 2020 2020 2020 2029 0a20 2020 2020           ).     
-00060160: 2020 2020 2020 2070 7269 6e74 2822 3022         print("0"
-00060170: 2c20 6669 6c65 3d6f 7574 7075 7429 0a0a  , file=output)..
-00060180: 2020 2020 2020 2020 7072 696e 7428 6669          print(fi
-00060190: 6c65 3d6f 7574 7075 7429 0a20 2020 2020  le=output).     
-000601a0: 2020 2070 7269 6e74 2822 2f2f 222c 2066     print("//", f
-000601b0: 696c 653d 6f75 7470 7574 290a 2020 2020  ile=output).    
-000601c0: 2020 2020 6966 2070 7269 6e74 5f74 7265      if print_tre
-000601d0: 6573 2069 7320 5472 7565 3a0a 2020 2020  es is True:.    
-000601e0: 2020 2020 2020 2020 2222 220a 2020 2020          """.    
-000601f0: 2020 2020 2020 2020 5072 696e 7420 6f75          Print ou
-00060200: 7420 7468 6520 7472 6565 7320 696e 206d  t the trees in m
-00060210: 732d 666f 726d 6174 2066 726f 6d20 7468  s-format from th
-00060220: 6520 7370 6563 6966 6965 6420 7472 6565  e specified tree
-00060230: 2073 6571 7565 6e63 652e 0a20 2020 2020   sequence..     
-00060240: 2020 2020 2020 2022 2222 0a20 2020 2020         """.     
-00060250: 2020 2020 2020 2069 6620 6c65 6e28 7472         if len(tr
-00060260: 6565 5f73 6571 2e74 7265 6573 2829 2920  ee_seq.trees()) 
-00060270: 3d3d 2031 3a0a 2020 2020 2020 2020 2020  == 1:.          
-00060280: 2020 2020 2020 7472 6565 203d 206e 6578        tree = nex
-00060290: 7428 7472 6565 5f73 6571 2e74 7265 6573  t(tree_seq.trees
-000602a0: 2829 290a 2020 2020 2020 2020 2020 2020  ()).            
-000602b0: 2020 2020 6e65 7769 636b 203d 2074 7265      newick = tre
-000602c0: 652e 6e65 7769 636b 2870 7265 6369 7369  e.newick(precisi
-000602d0: 6f6e 3d70 7265 6369 7369 6f6e 290a 2020  on=precision).  
-000602e0: 2020 2020 2020 2020 2020 2020 2020 7072                pr
-000602f0: 696e 7428 6e65 7769 636b 2c20 6669 6c65  int(newick, file
-00060300: 3d6f 7574 7075 7429 0a20 2020 2020 2020  =output).       
-00060310: 2020 2020 2065 6c73 653a 0a20 2020 2020       else:.     
-00060320: 2020 2020 2020 2020 2020 2066 6f72 2074             for t
-00060330: 7265 6520 696e 2074 7265 655f 7365 712e  ree in tree_seq.
-00060340: 7472 6565 7328 293a 0a20 2020 2020 2020  trees():.       
-00060350: 2020 2020 2020 2020 2020 2020 206e 6577               new
-00060360: 6963 6b20 3d20 7472 6565 2e6e 6577 6963  ick = tree.newic
-00060370: 6b28 7072 6563 6973 696f 6e3d 7072 6563  k(precision=prec
-00060380: 6973 696f 6e29 0a20 2020 2020 2020 2020  ision).         
-00060390: 2020 2020 2020 2020 2020 2070 7269 6e74             print
-000603a0: 2866 225b 7b74 7265 652e 7370 616e 3a2e  (f"[{tree.span:.
-000603b0: 7b70 7265 6369 7369 6f6e 7d66 7d5d 222c  {precision}f}]",
-000603c0: 206e 6577 6963 6b2c 2066 696c 653d 6f75   newick, file=ou
-000603d0: 7470 7574 290a 0a20 2020 2020 2020 2065  tput)..        e
-000603e0: 6c73 653a 0a20 2020 2020 2020 2020 2020  lse:.           
-000603f0: 2073 203d 2074 7265 655f 7365 712e 6765   s = tree_seq.ge
-00060400: 745f 6e75 6d5f 7369 7465 7328 290a 2020  t_num_sites().  
-00060410: 2020 2020 2020 2020 2020 7072 696e 7428            print(
-00060420: 2273 6567 7369 7465 733a 222c 2073 2c20  "segsites:", s, 
-00060430: 6669 6c65 3d6f 7574 7075 7429 0a20 2020  file=output).   
-00060440: 2020 2020 2020 2020 2069 6620 7320 213d           if s !=
-00060450: 2030 3a0a 2020 2020 2020 2020 2020 2020   0:.            
-00060460: 2020 2020 7072 696e 7428 2270 6f73 6974      print("posit
-00060470: 696f 6e73 3a20 222c 2065 6e64 3d22 222c  ions: ", end="",
-00060480: 2066 696c 653d 6f75 7470 7574 290a 2020   file=output).  
-00060490: 2020 2020 2020 2020 2020 2020 2020 706f                po
-000604a0: 7369 7469 6f6e 7320 3d20 5b0a 2020 2020  sitions = [.    
-000604b0: 2020 2020 2020 2020 2020 2020 2020 2020                  
-000604c0: 7661 7269 616e 742e 706f 7369 7469 6f6e  variant.position
-000604d0: 202f 2028 7472 6565 5f73 6571 2e73 6571   / (tree_seq.seq
-000604e0: 7565 6e63 655f 6c65 6e67 7468 290a 2020  uence_length).  
-000604f0: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00060500: 2020 666f 7220 7661 7269 616e 7420 696e    for variant in
-00060510: 2074 7265 655f 7365 712e 7661 7269 616e   tree_seq.varian
-00060520: 7473 2829 0a20 2020 2020 2020 2020 2020  ts().           
-00060530: 2020 2020 205d 0a20 2020 2020 2020 2020       ].         
-00060540: 2020 2020 2020 2066 6f72 2070 6f73 6974         for posit
-00060550: 696f 6e20 696e 2070 6f73 6974 696f 6e73  ion in positions
-00060560: 3a0a 2020 2020 2020 2020 2020 2020 2020  :.              
-00060570: 2020 2020 2020 7072 696e 7428 0a20 2020        print(.   
-00060580: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00060590: 2020 2020 2066 227b 706f 7369 7469 6f6e       f"{position
-000605a0: 3a2e 7b70 7265 6369 7369 6f6e 7d66 7d22  :.{precision}f}"
-000605b0: 2c0a 2020 2020 2020 2020 2020 2020 2020  ,.              
-000605c0: 2020 2020 2020 2020 2020 656e 643d 2220            end=" 
-000605d0: 222c 0a20 2020 2020 2020 2020 2020 2020  ",.             
-000605e0: 2020 2020 2020 2020 2020 2066 696c 653d             file=
-000605f0: 6f75 7470 7574 2c0a 2020 2020 2020 2020  output,.        
-00060600: 2020 2020 2020 2020 2020 2020 290a 2020              ).  
-00060610: 2020 2020 2020 2020 2020 2020 2020 7072                pr
-00060620: 696e 7428 6669 6c65 3d6f 7574 7075 7429  int(file=output)
-00060630: 0a0a 2020 2020 2020 2020 2020 2020 2020  ..              
-00060640: 2020 6765 6e6f 7479 7065 7320 3d20 7472    genotypes = tr
-00060650: 6565 5f73 6571 2e67 656e 6f74 7970 655f  ee_seq.genotype_
-00060660: 6d61 7472 6978 2829 0a20 2020 2020 2020  matrix().       
-00060670: 2020 2020 2020 2020 2066 6f72 206b 2069           for k i
-00060680: 6e20 7261 6e67 6528 7472 6565 5f73 6571  n range(tree_seq
-00060690: 2e6e 756d 5f73 616d 706c 6573 293a 0a20  .num_samples):. 
-000606a0: 2020 2020 2020 2020 2020 2020 2020 2020                  
-000606b0: 2020 2074 6d70 5f73 7472 203d 2022 222e     tmp_str = "".
-000606c0: 6a6f 696e 286d 6170 2873 7472 2c20 6765  join(map(str, ge
-000606d0: 6e6f 7479 7065 735b 3a2c 206b 5d29 290a  notypes[:, k])).
-000606e0: 2020 2020 2020 2020 2020 2020 2020 2020                  
-000606f0: 2020 2020 6966 2073 6574 2874 6d70 5f73      if set(tmp_s
-00060700: 7472 292e 6973 7375 6273 6574 287b 2230  tr).issubset({"0
-00060710: 222c 2022 3122 2c20 222d 227d 293a 0a20  ", "1", "-"}):. 
-00060720: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00060730: 2020 2020 2020 2070 7269 6e74 2874 6d70         print(tmp
-00060740: 5f73 7472 2c20 6669 6c65 3d6f 7574 7075  _str, file=outpu
-00060750: 7429 0a20 2020 2020 2020 2020 2020 2020  t).             
-00060760: 2020 2020 2020 2065 6c73 653a 0a20 2020         else:.   
-00060770: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00060780: 2020 2020 2072 6169 7365 2056 616c 7565       raise Value
-00060790: 4572 726f 7228 0a20 2020 2020 2020 2020  Error(.         
-000607a0: 2020 2020 2020 2020 2020 2020 2020 2020                  
-000607b0: 2020 2022 5468 6973 2074 7265 6520 7365     "This tree se
-000607c0: 7175 656e 6365 2063 6f6e 7461 696e 7320  quence contains 
-000607d0: 6e6f 6e2d 6269 616c 6c65 6c69 6322 0a20  non-biallelic". 
-000607e0: 2020 2020 2020 2020 2020 2020 2020 2020                  
-000607f0: 2020 2020 2020 2020 2020 2022 534e 5073             "SNPs
-00060800: 2061 6e64 2069 7320 696e 636f 6d70 6174   and is incompat
-00060810: 6962 6c65 2077 6974 6820 7468 6520 6d73  ible with the ms
-00060820: 2066 6f72 6d61 7421 220a 2020 2020 2020   format!".      
-00060830: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00060840: 2020 290a 2020 2020 2020 2020 2020 2020    ).            
-00060850: 656c 7365 3a0a 2020 2020 2020 2020 2020  else:.          
-00060860: 2020 2020 2020 7072 696e 7428 6669 6c65        print(file
-00060870: 3d6f 7574 7075 7429 0a                   =output).
+0004e9c0: 2323 2323 2323 2323 0a20 2020 2023 2053  ########.    # S
+0004e9d0: 7461 7469 7374 6963 7320 6465 6669 6e69  tatistics defini
+0004e9e0: 7469 6f6e 730a 2020 2020 2323 2323 2323  tions.    ######
+0004e9f0: 2323 2323 2323 2323 2323 2323 2323 2323  ################
+0004ea00: 2323 2323 2323 2323 2323 2323 2323 2323  ################
+0004ea10: 2323 2323 2323 0a0a 2020 2020 6465 6620  ######..    def 
+0004ea20: 6469 7665 7273 6974 7928 0a20 2020 2020  diversity(.     
+0004ea30: 2020 2073 656c 662c 2073 616d 706c 655f     self, sample_
+0004ea40: 7365 7473 3d4e 6f6e 652c 2077 696e 646f  sets=None, windo
+0004ea50: 7773 3d4e 6f6e 652c 206d 6f64 653d 2273  ws=None, mode="s
+0004ea60: 6974 6522 2c20 7370 616e 5f6e 6f72 6d61  ite", span_norma
+0004ea70: 6c69 7365 3d54 7275 650a 2020 2020 293a  lise=True.    ):
+0004ea80: 0a20 2020 2020 2020 2022 2222 0a20 2020  .        """.   
+0004ea90: 2020 2020 2043 6f6d 7075 7465 7320 6d65       Computes me
+0004eaa0: 616e 2067 656e 6574 6963 2064 6976 6572  an genetic diver
+0004eab0: 7369 7479 2028 616c 736f 206b 6e6f 776e  sity (also known
+0004eac0: 2061 7320 2270 6922 2920 696e 2065 6163   as "pi") in eac
+0004ead0: 6820 6f66 2074 6865 0a20 2020 2020 2020  h of the.       
+0004eae0: 2073 6574 7320 6f66 206e 6f64 6573 2066   sets of nodes f
+0004eaf0: 726f 6d20 6060 7361 6d70 6c65 5f73 6574  rom ``sample_set
+0004eb00: 7360 602e 2020 5468 6520 7374 6174 6973  s``.  The statis
+0004eb10: 7469 6320 6973 2061 6c73 6f20 6b6e 6f77  tic is also know
+0004eb20: 6e20 6173 0a20 2020 2020 2020 2022 7361  n as.        "sa
+0004eb30: 6d70 6c65 2068 6574 6572 6f7a 7967 6f73  mple heterozygos
+0004eb40: 6974 7922 3b20 6120 636f 6d6d 6f6e 2063  ity"; a common c
+0004eb50: 6974 6174 696f 6e20 666f 7220 7468 6520  itation for the 
+0004eb60: 6465 6669 6e69 7469 6f6e 2069 730a 2020  definition is.  
+0004eb70: 2020 2020 2020 604e 6569 2061 6e64 204c        `Nei and L
+0004eb80: 6920 2831 3937 3929 203c 6874 7470 733a  i (1979) <https:
+0004eb90: 2f2f 646f 692e 6f72 672f 3130 2e31 3037  //doi.org/10.107
+0004eba0: 332f 706e 6173 2e37 362e 3130 2e35 3236  3/pnas.76.10.526
+0004ebb0: 393e 605f 0a20 2020 2020 2020 2028 6571  9>`_.        (eq
+0004ebc0: 7561 7469 6f6e 2032 3229 2c20 736f 2069  uation 22), so i
+0004ebd0: 7420 6973 2073 6f6d 6574 696d 6573 2063  t is sometimes c
+0004ebe0: 616c 6c65 6420 6361 6c6c 6564 2022 4e65  alled called "Ne
+0004ebf0: 6927 7320 7069 220a 2020 2020 2020 2020  i's pi".        
+0004ec00: 2862 7574 2061 6c73 6f20 736f 6d65 7469  (but also someti
+0004ec10: 6d65 7320 2254 616a 696d 6127 7320 7069  mes "Tajima's pi
+0004ec20: 2229 2e0a 0a20 2020 2020 2020 2050 6c65  ")...        Ple
+0004ec30: 6173 6520 7365 6520 7468 6520 3a72 6566  ase see the :ref
+0004ec40: 3a60 6f6e 652d 7761 7920 7374 6174 6973  :`one-way statis
+0004ec50: 7469 6373 203c 7365 635f 7374 6174 735f  tics <sec_stats_
+0004ec60: 7361 6d70 6c65 5f73 6574 735f 6f6e 655f  sample_sets_one_
+0004ec70: 7761 793e 600a 2020 2020 2020 2020 7365  way>`.        se
+0004ec80: 6374 696f 6e20 666f 7220 6465 7461 696c  ction for detail
+0004ec90: 7320 6f6e 2068 6f77 2074 6865 2060 6073  s on how the ``s
+0004eca0: 616d 706c 655f 7365 7473 6060 2061 7267  ample_sets`` arg
+0004ecb0: 756d 656e 7420 6973 2069 6e74 6572 7072  ument is interpr
+0004ecc0: 6574 6564 0a20 2020 2020 2020 2061 6e64  eted.        and
+0004ecd0: 2068 6f77 2069 7420 696e 7465 7261 6374   how it interact
+0004ece0: 7320 7769 7468 2074 6865 2064 696d 656e  s with the dimen
+0004ecf0: 7369 6f6e 7320 6f66 2074 6865 206f 7574  sions of the out
+0004ed00: 7075 7420 6172 7261 792e 0a20 2020 2020  put array..     
+0004ed10: 2020 2053 6565 2074 6865 203a 7265 663a     See the :ref:
+0004ed20: 6073 7461 7469 7374 6963 7320 696e 7465  `statistics inte
+0004ed30: 7266 6163 6520 3c73 6563 5f73 7461 7473  rface <sec_stats
+0004ed40: 5f69 6e74 6572 6661 6365 3e60 2073 6563  _interface>` sec
+0004ed50: 7469 6f6e 2066 6f72 2064 6574 6169 6c73  tion for details
+0004ed60: 206f 6e0a 2020 2020 2020 2020 3a72 6566   on.        :ref
+0004ed70: 3a60 7769 6e64 6f77 7320 3c73 6563 5f73  :`windows <sec_s
+0004ed80: 7461 7473 5f77 696e 646f 7773 3e60 2c0a  tats_windows>`,.
+0004ed90: 2020 2020 2020 2020 3a72 6566 3a60 6d6f          :ref:`mo
+0004eda0: 6465 203c 7365 635f 7374 6174 735f 6d6f  de <sec_stats_mo
+0004edb0: 6465 3e60 2c0a 2020 2020 2020 2020 3a72  de>`,.        :r
+0004edc0: 6566 3a60 7370 616e 206e 6f72 6d61 6c69  ef:`span normali
+0004edd0: 7365 203c 7365 635f 7374 6174 735f 7370  se <sec_stats_sp
+0004ede0: 616e 5f6e 6f72 6d61 6c69 7365 3e60 2c0a  an_normalise>`,.
+0004edf0: 2020 2020 2020 2020 616e 6420 3a72 6566          and :ref
+0004ee00: 3a60 7265 7475 726e 2076 616c 7565 203c  :`return value <
+0004ee10: 7365 635f 7374 6174 735f 6f75 7470 7574  sec_stats_output
+0004ee20: 5f66 6f72 6d61 743e 602e 0a0a 2020 2020  _format>`...    
+0004ee30: 2020 2020 4e6f 7465 2074 6861 7420 7468      Note that th
+0004ee40: 6973 2071 7561 6e74 6974 7920 6361 6e20  is quantity can 
+0004ee50: 616c 736f 2062 6520 636f 6d70 7574 6564  also be computed
+0004ee60: 2062 7920 7468 650a 2020 2020 2020 2020   by the.        
+0004ee70: 3a6d 6574 683a 6064 6976 6572 6765 6e63  :meth:`divergenc
+0004ee80: 6520 3c2e 5472 6565 5365 7175 656e 6365  e <.TreeSequence
+0004ee90: 2e64 6976 6572 6765 6e63 653e 6020 6d65  .divergence>` me
+0004eea0: 7468 6f64 2e0a 0a20 2020 2020 2020 2057  thod...        W
+0004eeb0: 6861 7420 6973 2063 6f6d 7075 7465 6420  hat is computed 
+0004eec0: 6465 7065 6e64 7320 6f6e 2060 606d 6f64  depends on ``mod
+0004eed0: 6560 603a 0a0a 2020 2020 2020 2020 2273  e``:..        "s
+0004eee0: 6974 6522 0a20 2020 2020 2020 2020 2020  ite".           
+0004eef0: 204d 6561 6e20 7061 6972 7769 7365 2067   Mean pairwise g
+0004ef00: 656e 6574 6963 2064 6976 6572 7369 7479  enetic diversity
+0004ef10: 3a20 7468 6520 6176 6572 6167 6520 6f76  : the average ov
+0004ef20: 6572 2061 6c6c 206e 2063 686f 6f73 6520  er all n choose 
+0004ef30: 3220 7061 6972 7320 6f66 0a20 2020 2020  2 pairs of.     
+0004ef40: 2020 2020 2020 2073 616d 706c 6520 6e6f         sample no
+0004ef50: 6465 732c 206f 6620 7468 6520 6465 6e73  des, of the dens
+0004ef60: 6974 7920 6f66 2073 6974 6573 2061 740a  ity of sites at.
+0004ef70: 2020 2020 2020 2020 2020 2020 7768 6963              whic
+0004ef80: 6820 7468 6520 7477 6f20 6361 7272 7920  h the two carry 
+0004ef90: 6469 6666 6572 656e 7420 616c 6c65 6c65  different allele
+0004efa0: 732c 2070 6572 2075 6e69 7420 6f66 2063  s, per unit of c
+0004efb0: 6872 6f6d 6f73 6f6d 6520 6c65 6e67 7468  hromosome length
+0004efc0: 2e0a 0a20 2020 2020 2020 2022 6272 616e  ...        "bran
+0004efd0: 6368 220a 2020 2020 2020 2020 2020 2020  ch".            
+0004efe0: 4d65 616e 2064 6973 7461 6e63 6520 696e  Mean distance in
+0004eff0: 2074 6865 2074 7265 653a 2074 6865 2061   the tree: the a
+0004f000: 7665 7261 6765 2061 6372 6f73 7320 6f76  verage across ov
+0004f010: 6572 2061 6c6c 206e 2063 686f 6f73 6520  er all n choose 
+0004f020: 3220 7061 6972 7320 6f66 0a20 2020 2020  2 pairs of.     
+0004f030: 2020 2020 2020 2073 616d 706c 6520 6e6f         sample no
+0004f040: 6465 7320 616e 6420 6c6f 6361 7469 6f6e  des and location
+0004f050: 7320 696e 2074 6865 2077 696e 646f 772c  s in the window,
+0004f060: 206f 6620 7468 6520 6d65 616e 2064 6973   of the mean dis
+0004f070: 7461 6e63 6520 696e 0a20 2020 2020 2020  tance in.       
+0004f080: 2020 2020 2074 6865 2074 7265 6520 6265       the tree be
+0004f090: 7477 6565 6e20 7468 6520 7477 6f20 7361  tween the two sa
+0004f0a0: 6d70 6c65 7320 2869 6e20 756e 6974 7320  mples (in units 
+0004f0b0: 6f66 2074 696d 6529 2e0a 0a20 2020 2020  of time)...     
+0004f0c0: 2020 2022 6e6f 6465 220a 2020 2020 2020     "node".      
+0004f0d0: 2020 2020 2020 466f 7220 6561 6368 206e        For each n
+0004f0e0: 6f64 652c 2074 6865 2070 726f 706f 7274  ode, the proport
+0004f0f0: 696f 6e20 6f66 2067 656e 6f6d 6520 6f6e  ion of genome on
+0004f100: 2077 6869 6368 2074 6865 206e 6f64 6520   which the node 
+0004f110: 6973 2061 6e20 616e 6365 7374 6f72 2074  is an ancestor t
+0004f120: 6f0a 2020 2020 2020 2020 2020 2020 6f6e  o.            on
+0004f130: 6c79 206f 6e65 206f 6620 6120 7061 6972  ly one of a pair
+0004f140: 206f 6620 7361 6d70 6c65 206e 6f64 6573   of sample nodes
+0004f150: 2066 726f 6d20 7468 6520 7361 6d70 6c65   from the sample
+0004f160: 2073 6574 2c20 6176 6572 6167 6564 0a20   set, averaged. 
+0004f170: 2020 2020 2020 2020 2020 206f 7665 7220             over 
+0004f180: 6f76 6572 2061 6c6c 206e 2063 686f 6f73  over all n choos
+0004f190: 6520 3220 7061 6972 7320 6f66 2073 616d  e 2 pairs of sam
+0004f1a0: 706c 6520 6e6f 6465 732e 0a0a 2020 2020  ple nodes...    
+0004f1b0: 2020 2020 3a70 6172 616d 206c 6973 7420      :param list 
+0004f1c0: 7361 6d70 6c65 5f73 6574 733a 2041 206c  sample_sets: A l
+0004f1d0: 6973 7420 6f66 206c 6973 7473 206f 6620  ist of lists of 
+0004f1e0: 4e6f 6465 2049 4473 2c20 7370 6563 6966  Node IDs, specif
+0004f1f0: 7969 6e67 2074 6865 0a20 2020 2020 2020  ying the.       
+0004f200: 2020 2020 2067 726f 7570 7320 6f66 206e       groups of n
+0004f210: 6f64 6573 2066 6f72 2077 6869 6368 2074  odes for which t
+0004f220: 6865 2073 7461 7469 7374 6963 2069 7320  he statistic is 
+0004f230: 636f 6d70 7574 6564 2e20 4966 2061 6e79  computed. If any
+0004f240: 206f 6620 7468 650a 2020 2020 2020 2020   of the.        
+0004f250: 2020 2020 7361 6d70 6c65 2073 6574 7320      sample sets 
+0004f260: 636f 6e74 6169 6e20 6f6e 6c79 2061 2073  contain only a s
+0004f270: 696e 676c 6520 6e6f 6465 2c20 7468 6520  ingle node, the 
+0004f280: 7265 7475 726e 6564 2064 6976 6572 7369  returned diversi
+0004f290: 7479 2077 696c 6c20 6265 0a20 2020 2020  ty will be.     
+0004f2a0: 2020 2020 2020 204e 614e 2e20 4966 2060         NaN. If `
+0004f2b0: 604e 6f6e 6560 6020 2864 6566 6175 6c74  `None`` (default
+0004f2c0: 292c 2061 7665 7261 6765 206f 7665 7220  ), average over 
+0004f2d0: 616c 6c20 6e20 6368 6f6f 7365 2032 2070  all n choose 2 p
+0004f2e0: 6169 7273 206f 6620 6469 7374 696e 6374  airs of distinct
+0004f2f0: 0a20 2020 2020 2020 2020 2020 2073 616d  .            sam
+0004f300: 706c 6520 6e6f 6465 7320 696e 2074 6865  ple nodes in the
+0004f310: 2074 7265 6520 7365 7175 656e 6365 2e0a   tree sequence..
+0004f320: 2020 2020 2020 2020 3a70 6172 616d 206c          :param l
+0004f330: 6973 7420 7769 6e64 6f77 733a 2041 6e20  ist windows: An 
+0004f340: 696e 6372 6561 7369 6e67 206c 6973 7420  increasing list 
+0004f350: 6f66 2062 7265 616b 706f 696e 7473 2062  of breakpoints b
+0004f360: 6574 7765 656e 2074 6865 2077 696e 646f  etween the windo
+0004f370: 7773 0a20 2020 2020 2020 2020 2020 2074  ws.            t
+0004f380: 6f20 636f 6d70 7574 6520 7468 6520 7374  o compute the st
+0004f390: 6174 6973 7469 6320 696e 2e0a 2020 2020  atistic in..    
+0004f3a0: 2020 2020 3a70 6172 616d 2073 7472 206d      :param str m
+0004f3b0: 6f64 653a 2041 2073 7472 696e 6720 6769  ode: A string gi
+0004f3c0: 7669 6e67 2074 6865 2022 7479 7065 2220  ving the "type" 
+0004f3d0: 6f66 2074 6865 2073 7461 7469 7374 6963  of the statistic
+0004f3e0: 2074 6f20 6265 2063 6f6d 7075 7465 640a   to be computed.
+0004f3f0: 2020 2020 2020 2020 2020 2020 2864 6566              (def
+0004f400: 6175 6c74 7320 746f 2022 7369 7465 2229  aults to "site")
+0004f410: 2e0a 2020 2020 2020 2020 3a70 6172 616d  ..        :param
+0004f420: 2062 6f6f 6c20 7370 616e 5f6e 6f72 6d61   bool span_norma
+0004f430: 6c69 7365 3a20 5768 6574 6865 7220 746f  lise: Whether to
+0004f440: 2064 6976 6964 6520 7468 6520 7265 7375   divide the resu
+0004f450: 6c74 2062 7920 7468 6520 7370 616e 206f  lt by the span o
+0004f460: 6620 7468 650a 2020 2020 2020 2020 2020  f the.          
+0004f470: 2020 7769 6e64 6f77 2028 6465 6661 756c    window (defaul
+0004f480: 7473 2074 6f20 5472 7565 292e 0a20 2020  ts to True)..   
+0004f490: 2020 2020 203a 7265 7475 726e 3a20 4120       :return: A 
+0004f4a0: 6e75 6d70 7920 6172 7261 7920 7768 6f73  numpy array whos
+0004f4b0: 6520 6c65 6e67 7468 2069 7320 6571 7561  e length is equa
+0004f4c0: 6c20 746f 2074 6865 206e 756d 6265 7220  l to the number 
+0004f4d0: 6f66 2073 616d 706c 6520 7365 7473 2e0a  of sample sets..
+0004f4e0: 2020 2020 2020 2020 2020 2020 4966 2074              If t
+0004f4f0: 6865 7265 2069 7320 6f6e 6520 7361 6d70  here is one samp
+0004f500: 6c65 2073 6574 2061 6e64 2077 696e 646f  le set and windo
+0004f510: 7773 3d4e 6f6e 652c 2061 206e 756d 7079  ws=None, a numpy
+0004f520: 2073 6361 6c61 7220 6973 2072 6574 7572   scalar is retur
+0004f530: 6e65 642e 0a20 2020 2020 2020 2022 2222  ned..        """
+0004f540: 0a20 2020 2020 2020 2072 6574 7572 6e20  .        return 
+0004f550: 7365 6c66 2e5f 5f6f 6e65 5f77 6179 5f73  self.__one_way_s
+0004f560: 616d 706c 655f 7365 745f 7374 6174 280a  ample_set_stat(.
+0004f570: 2020 2020 2020 2020 2020 2020 7365 6c66              self
+0004f580: 2e5f 6c6c 5f74 7265 655f 7365 7175 656e  ._ll_tree_sequen
+0004f590: 6365 2e64 6976 6572 7369 7479 2c0a 2020  ce.diversity,.  
+0004f5a0: 2020 2020 2020 2020 2020 7361 6d70 6c65            sample
+0004f5b0: 5f73 6574 732c 0a20 2020 2020 2020 2020  _sets,.         
+0004f5c0: 2020 2077 696e 646f 7773 3d77 696e 646f     windows=windo
+0004f5d0: 7773 2c0a 2020 2020 2020 2020 2020 2020  ws,.            
+0004f5e0: 6d6f 6465 3d6d 6f64 652c 0a20 2020 2020  mode=mode,.     
+0004f5f0: 2020 2020 2020 2073 7061 6e5f 6e6f 726d         span_norm
+0004f600: 616c 6973 653d 7370 616e 5f6e 6f72 6d61  alise=span_norma
+0004f610: 6c69 7365 2c0a 2020 2020 2020 2020 290a  lise,.        ).
+0004f620: 0a20 2020 2064 6566 2064 6976 6572 6765  .    def diverge
+0004f630: 6e63 6528 0a20 2020 2020 2020 2073 656c  nce(.        sel
+0004f640: 662c 2073 616d 706c 655f 7365 7473 2c20  f, sample_sets, 
+0004f650: 696e 6465 7865 733d 4e6f 6e65 2c20 7769  indexes=None, wi
+0004f660: 6e64 6f77 733d 4e6f 6e65 2c20 6d6f 6465  ndows=None, mode
+0004f670: 3d22 7369 7465 222c 2073 7061 6e5f 6e6f  ="site", span_no
+0004f680: 726d 616c 6973 653d 5472 7565 0a20 2020  rmalise=True.   
+0004f690: 2029 3a0a 2020 2020 2020 2020 7222 2222   ):.        r"""
+0004f6a0: 0a20 2020 2020 2020 2043 6f6d 7075 7465  .        Compute
+0004f6b0: 7320 6d65 616e 2067 656e 6574 6963 2064  s mean genetic d
+0004f6c0: 6976 6572 6765 6e63 6520 6265 7477 6565  ivergence betwee
+0004f6d0: 6e20 2861 6e64 2077 6974 6869 6e29 2070  n (and within) p
+0004f6e0: 6169 7273 206f 660a 2020 2020 2020 2020  airs of.        
+0004f6f0: 7365 7473 206f 6620 6e6f 6465 7320 6672  sets of nodes fr
+0004f700: 6f6d 2060 6073 616d 706c 655f 7365 7473  om ``sample_sets
+0004f710: 6060 2e0a 2020 2020 2020 2020 5468 6973  ``..        This
+0004f720: 2069 7320 7468 6520 2261 7665 7261 6765   is the "average
+0004f730: 206e 756d 6265 7220 6f66 2064 6966 6665   number of diffe
+0004f740: 7265 6e63 6573 222c 2075 7375 616c 6c79  rences", usually
+0004f750: 2072 6566 6572 7265 6420 746f 2061 7320   referred to as 
+0004f760: 2264 7879 223b 0a20 2020 2020 2020 2061  "dxy";.        a
+0004f770: 2063 6f6d 6d6f 6e20 6369 7461 7469 6f6e   common citation
+0004f780: 2066 6f72 2074 6869 7320 6465 6669 6e69   for this defini
+0004f790: 7469 6f6e 2069 7320 4e65 6920 616e 6420  tion is Nei and 
+0004f7a0: 4c69 2028 3139 3739 292c 2077 686f 2063  Li (1979), who c
+0004f7b0: 616c 6c65 6420 6974 0a20 2020 2020 2020  alled it.       
+0004f7c0: 203a 6d61 7468 3a60 5c70 695f 7b58 597d   :math:`\pi_{XY}
+0004f7d0: 602e 204e 6f74 6520 7468 6174 2074 6865  `. Note that the
+0004f7e0: 206d 6561 6e20 7061 6972 7769 7365 206e   mean pairwise n
+0004f7f0: 7563 6c65 6f74 6964 6520 6469 7665 7273  ucleotide divers
+0004f800: 6974 7920 6f66 2061 0a20 2020 2020 2020  ity of a.       
+0004f810: 2073 616d 706c 6520 7365 7420 746f 2069   sample set to i
+0004f820: 7473 656c 6620 2863 6f6d 7075 7465 6420  tself (computed 
+0004f830: 6279 2070 6173 7369 6e67 2061 6e20 696e  by passing an in
+0004f840: 6465 7820 6f66 2074 6865 2066 6f72 6d20  dex of the form 
+0004f850: 286a 2c6a 2929 0a20 2020 2020 2020 2069  (j,j)).        i
+0004f860: 7320 6974 7320 3a6d 6574 683a 6064 6976  s its :meth:`div
+0004f870: 6572 7369 7479 203c 2e54 7265 6553 6571  ersity <.TreeSeq
+0004f880: 7565 6e63 652e 6469 7665 7273 6974 793e  uence.diversity>
+0004f890: 6020 2873 6565 2074 6865 206e 6f74 6520  ` (see the note 
+0004f8a0: 6265 6c6f 7729 2e0a 0a20 2020 2020 2020  below)...       
+0004f8b0: 204f 7065 7261 7465 7320 6f6e 2060 606b   Operates on ``k
+0004f8c0: 203d 2032 6060 2073 616d 706c 6520 7365   = 2`` sample se
+0004f8d0: 7473 2061 7420 6120 7469 6d65 3b20 706c  ts at a time; pl
+0004f8e0: 6561 7365 2073 6565 2074 6865 0a20 2020  ease see the.   
+0004f8f0: 2020 2020 203a 7265 663a 606d 756c 7469       :ref:`multi
+0004f900: 2d77 6179 2073 7461 7469 7374 6963 7320  -way statistics 
+0004f910: 3c73 6563 5f73 7461 7473 5f73 616d 706c  <sec_stats_sampl
+0004f920: 655f 7365 7473 5f6d 756c 7469 5f77 6179  e_sets_multi_way
+0004f930: 3e60 0a20 2020 2020 2020 2073 6563 7469  >`.        secti
+0004f940: 6f6e 2066 6f72 2064 6574 6169 6c73 206f  on for details o
+0004f950: 6e20 686f 7720 7468 6520 6060 7361 6d70  n how the ``samp
+0004f960: 6c65 5f73 6574 7360 6020 616e 6420 6060  le_sets`` and ``
+0004f970: 696e 6465 7865 7360 6020 6172 6775 6d65  indexes`` argume
+0004f980: 6e74 7320 6172 650a 2020 2020 2020 2020  nts are.        
+0004f990: 696e 7465 7270 7265 7465 6420 616e 6420  interpreted and 
+0004f9a0: 686f 7720 7468 6579 2069 6e74 6572 6163  how they interac
+0004f9b0: 7420 7769 7468 2074 6865 2064 696d 656e  t with the dimen
+0004f9c0: 7369 6f6e 7320 6f66 2074 6865 206f 7574  sions of the out
+0004f9d0: 7075 7420 6172 7261 792e 0a20 2020 2020  put array..     
+0004f9e0: 2020 2053 6565 2074 6865 203a 7265 663a     See the :ref:
+0004f9f0: 6073 7461 7469 7374 6963 7320 696e 7465  `statistics inte
+0004fa00: 7266 6163 6520 3c73 6563 5f73 7461 7473  rface <sec_stats
+0004fa10: 5f69 6e74 6572 6661 6365 3e60 2073 6563  _interface>` sec
+0004fa20: 7469 6f6e 2066 6f72 2064 6574 6169 6c73  tion for details
+0004fa30: 206f 6e0a 2020 2020 2020 2020 3a72 6566   on.        :ref
+0004fa40: 3a60 7769 6e64 6f77 7320 3c73 6563 5f73  :`windows <sec_s
+0004fa50: 7461 7473 5f77 696e 646f 7773 3e60 2c0a  tats_windows>`,.
+0004fa60: 2020 2020 2020 2020 3a72 6566 3a60 6d6f          :ref:`mo
+0004fa70: 6465 203c 7365 635f 7374 6174 735f 6d6f  de <sec_stats_mo
+0004fa80: 6465 3e60 2c0a 2020 2020 2020 2020 3a72  de>`,.        :r
+0004fa90: 6566 3a60 7370 616e 206e 6f72 6d61 6c69  ef:`span normali
+0004faa0: 7365 203c 7365 635f 7374 6174 735f 7370  se <sec_stats_sp
+0004fab0: 616e 5f6e 6f72 6d61 6c69 7365 3e60 2c0a  an_normalise>`,.
+0004fac0: 2020 2020 2020 2020 616e 6420 3a72 6566          and :ref
+0004fad0: 3a60 7265 7475 726e 2076 616c 7565 203c  :`return value <
+0004fae0: 7365 635f 7374 6174 735f 6f75 7470 7574  sec_stats_output
+0004faf0: 5f66 6f72 6d61 743e 602e 0a0a 2020 2020  _format>`...    
+0004fb00: 2020 2020 2e2e 206e 6f74 653a 3a0a 2020      .. note::.  
+0004fb10: 2020 2020 2020 2020 2020 546f 2061 766f            To avo
+0004fb20: 6964 2075 6e65 7870 6563 7465 6420 7265  id unexpected re
+0004fb30: 7375 6c74 732c 2073 616d 706c 6520 7365  sults, sample se
+0004fb40: 7473 2073 686f 756c 6420 6265 206e 6f6e  ts should be non
+0004fb50: 6f76 6572 6c61 7070 696e 672c 0a20 2020  overlapping,.   
+0004fb60: 2020 2020 2020 2020 2073 696e 6365 2063           since c
+0004fb70: 6f6d 7061 7269 736f 6e73 206f 6620 696e  omparisons of in
+0004fb80: 6469 7669 6475 616c 7320 746f 2074 6865  dividuals to the
+0004fb90: 6d73 656c 7665 7320 6172 6520 6e6f 7420  mselves are not 
+0004fba0: 7265 6d6f 7665 6420 7768 656e 2063 6f6d  removed when com
+0004fbb0: 7075 7469 6e67 0a20 2020 2020 2020 2020  puting.         
+0004fbc0: 2020 2064 6976 6572 6765 6e63 6520 6265     divergence be
+0004fbd0: 7477 6565 6e20 6469 7374 696e 6374 2073  tween distinct s
+0004fbe0: 616d 706c 6520 7365 7473 2e20 2848 6f77  ample sets. (How
+0004fbf0: 6576 6572 2c20 7370 6563 6966 7969 6e67  ever, specifying
+0004fc00: 2061 6e20 696e 6465 780a 2020 2020 2020   an index.      
+0004fc10: 2020 2020 2020 6060 286a 2c20 6a29 6060        ``(j, j)``
+0004fc20: 2063 6f6d 7075 7465 7320 7468 6520 3a6d   computes the :m
+0004fc30: 6574 683a 6064 6976 6572 7369 7479 203c  eth:`diversity <
+0004fc40: 2e54 7265 6553 6571 7565 6e63 652e 6469  .TreeSequence.di
+0004fc50: 7665 7273 6974 793e 600a 2020 2020 2020  versity>`.      
+0004fc60: 2020 2020 2020 6f66 2060 6073 616d 706c        of ``sampl
+0004fc70: 655f 7365 745b 6a5d 6060 2c20 7768 6963  e_set[j]``, whic
+0004fc80: 6820 7265 6d6f 7665 7320 7365 6c66 2063  h removes self c
+0004fc90: 6f6d 7061 7269 736f 6e73 2074 6f20 7072  omparisons to pr
+0004fca0: 6f76 6964 650a 2020 2020 2020 2020 2020  ovide.          
+0004fcb0: 2020 616e 2075 6e62 6961 7365 6420 6573    an unbiased es
+0004fcc0: 7469 6d61 7465 2e29 0a0a 2020 2020 2020  timate.)..      
+0004fcd0: 2020 5768 6174 2069 7320 636f 6d70 7574    What is comput
+0004fce0: 6564 2064 6570 656e 6473 206f 6e20 6060  ed depends on ``
+0004fcf0: 6d6f 6465 6060 3a0a 0a20 2020 2020 2020  mode``:..       
+0004fd00: 2022 7369 7465 220a 2020 2020 2020 2020   "site".        
+0004fd10: 2020 2020 4d65 616e 2070 6169 7277 6973      Mean pairwis
+0004fd20: 6520 6765 6e65 7469 6320 6469 7665 7267  e genetic diverg
+0004fd30: 656e 6365 3a20 7468 6520 6176 6572 6167  ence: the averag
+0004fd40: 6520 6163 726f 7373 2065 7665 7279 2070  e across every p
+0004fd50: 6f73 7369 626c 6520 7061 6972 206f 660a  ossible pair of.
+0004fd60: 2020 2020 2020 2020 2020 2020 6368 726f              chro
+0004fd70: 6d6f 736f 6d65 7320 286f 6e65 2066 726f  mosomes (one fro
+0004fd80: 6d20 6561 6368 2073 616d 706c 6520 7365  m each sample se
+0004fd90: 7429 2c20 6f66 2074 6865 2064 656e 7369  t), of the densi
+0004fda0: 7479 206f 6620 7369 7465 7320 6174 2077  ty of sites at w
+0004fdb0: 6869 6368 0a20 2020 2020 2020 2020 2020  hich.           
+0004fdc0: 2074 6865 2074 776f 2063 6172 7279 2064   the two carry d
+0004fdd0: 6966 6665 7265 6e74 2061 6c6c 656c 6573  ifferent alleles
+0004fde0: 2c20 7065 7220 756e 6974 206f 6620 6368  , per unit of ch
+0004fdf0: 726f 6d6f 736f 6d65 206c 656e 6774 682e  romosome length.
+0004fe00: 0a0a 2020 2020 2020 2020 2262 7261 6e63  ..        "branc
+0004fe10: 6822 0a20 2020 2020 2020 2020 2020 204d  h".            M
+0004fe20: 6561 6e20 6469 7374 616e 6365 2069 6e20  ean distance in 
+0004fe30: 7468 6520 7472 6565 3a20 7468 6520 6176  the tree: the av
+0004fe40: 6572 6167 6520 6163 726f 7373 2065 7665  erage across eve
+0004fe50: 7279 2070 6f73 7369 626c 6520 7061 6972  ry possible pair
+0004fe60: 206f 660a 2020 2020 2020 2020 2020 2020   of.            
+0004fe70: 6368 726f 6d6f 736f 6d65 7320 286f 6e65  chromosomes (one
+0004fe80: 2066 726f 6d20 6561 6368 2073 616d 706c   from each sampl
+0004fe90: 6520 7365 7429 2061 6e64 206c 6f63 6174  e set) and locat
+0004fea0: 696f 6e73 2069 6e20 7468 6520 7769 6e64  ions in the wind
+0004feb0: 6f77 2c20 6f66 0a20 2020 2020 2020 2020  ow, of.         
+0004fec0: 2020 2074 6865 206d 6561 6e20 6469 7374     the mean dist
+0004fed0: 616e 6365 2069 6e20 7468 6520 7472 6565  ance in the tree
+0004fee0: 2062 6574 7765 656e 2074 6865 2074 776f   between the two
+0004fef0: 2073 616d 706c 6573 2028 696e 2075 6e69   samples (in uni
+0004ff00: 7473 206f 6620 7469 6d65 292e 0a0a 2020  ts of time)...  
+0004ff10: 2020 2020 2020 226e 6f64 6522 0a20 2020        "node".   
+0004ff20: 2020 2020 2020 2020 2046 6f72 2065 6163           For eac
+0004ff30: 6820 6e6f 6465 2c20 7468 6520 7072 6f70  h node, the prop
+0004ff40: 6f72 7469 6f6e 206f 6620 6765 6e6f 6d65  ortion of genome
+0004ff50: 206f 6e20 7768 6963 6820 7468 6520 6e6f   on which the no
+0004ff60: 6465 2069 7320 616e 2061 6e63 6573 746f  de is an ancesto
+0004ff70: 7220 746f 0a20 2020 2020 2020 2020 2020  r to.           
+0004ff80: 206f 6e6c 7920 6f6e 6520 6f66 2061 2070   only one of a p
+0004ff90: 6169 7220 6f66 2063 6872 6f6d 6f73 6f6d  air of chromosom
+0004ffa0: 6573 2066 726f 6d20 7468 6520 7361 6d70  es from the samp
+0004ffb0: 6c65 2073 6574 2c20 6176 6572 6167 6564  le set, averaged
+0004ffc0: 0a20 2020 2020 2020 2020 2020 206f 7665  .            ove
+0004ffd0: 7220 616c 6c20 706f 7373 6962 6c65 2070  r all possible p
+0004ffe0: 6169 7273 2e0a 0a20 2020 2020 2020 203a  airs...        :
+0004fff0: 7061 7261 6d20 6c69 7374 2073 616d 706c  param list sampl
+00050000: 655f 7365 7473 3a20 4120 6c69 7374 206f  e_sets: A list o
+00050010: 6620 6c69 7374 7320 6f66 204e 6f64 6520  f lists of Node 
+00050020: 4944 732c 2073 7065 6369 6679 696e 6720  IDs, specifying 
+00050030: 7468 650a 2020 2020 2020 2020 2020 2020  the.            
+00050040: 6772 6f75 7073 206f 6620 6e6f 6465 7320  groups of nodes 
+00050050: 746f 2063 6f6d 7075 7465 2074 6865 2073  to compute the s
+00050060: 7461 7469 7374 6963 2077 6974 682e 0a20  tatistic with.. 
+00050070: 2020 2020 2020 203a 7061 7261 6d20 6c69         :param li
+00050080: 7374 2069 6e64 6578 6573 3a20 4120 6c69  st indexes: A li
+00050090: 7374 206f 6620 322d 7475 706c 6573 2c20  st of 2-tuples, 
+000500a0: 6f72 204e 6f6e 652e 0a20 2020 2020 2020  or None..       
+000500b0: 203a 7061 7261 6d20 6c69 7374 2077 696e   :param list win
+000500c0: 646f 7773 3a20 416e 2069 6e63 7265 6173  dows: An increas
+000500d0: 696e 6720 6c69 7374 206f 6620 6272 6561  ing list of brea
+000500e0: 6b70 6f69 6e74 7320 6265 7477 6565 6e20  kpoints between 
+000500f0: 7468 6520 7769 6e64 6f77 730a 2020 2020  the windows.    
+00050100: 2020 2020 2020 2020 746f 2063 6f6d 7075          to compu
+00050110: 7465 2074 6865 2073 7461 7469 7374 6963  te the statistic
+00050120: 2069 6e2e 0a20 2020 2020 2020 203a 7061   in..        :pa
+00050130: 7261 6d20 7374 7220 6d6f 6465 3a20 4120  ram str mode: A 
+00050140: 7374 7269 6e67 2067 6976 696e 6720 7468  string giving th
+00050150: 6520 2274 7970 6522 206f 6620 7468 6520  e "type" of the 
+00050160: 7374 6174 6973 7469 6320 746f 2062 6520  statistic to be 
+00050170: 636f 6d70 7574 6564 0a20 2020 2020 2020  computed.       
+00050180: 2020 2020 2028 6465 6661 756c 7473 2074       (defaults t
+00050190: 6f20 2273 6974 6522 292e 0a20 2020 2020  o "site")..     
+000501a0: 2020 203a 7061 7261 6d20 626f 6f6c 2073     :param bool s
+000501b0: 7061 6e5f 6e6f 726d 616c 6973 653a 2057  pan_normalise: W
+000501c0: 6865 7468 6572 2074 6f20 6469 7669 6465  hether to divide
+000501d0: 2074 6865 2072 6573 756c 7420 6279 2074   the result by t
+000501e0: 6865 2073 7061 6e20 6f66 2074 6865 0a20  he span of the. 
+000501f0: 2020 2020 2020 2020 2020 2077 696e 646f             windo
+00050200: 7720 2864 6566 6175 6c74 7320 746f 2054  w (defaults to T
+00050210: 7275 6529 2e0a 2020 2020 2020 2020 3a72  rue)..        :r
+00050220: 6574 7572 6e3a 2041 206e 6461 7272 6179  eturn: A ndarray
+00050230: 2077 6974 6820 7368 6170 6520 6571 7561   with shape equa
+00050240: 6c20 746f 2028 6e75 6d20 7769 6e64 6f77  l to (num window
+00050250: 732c 206e 756d 2073 7461 7469 7374 6963  s, num statistic
+00050260: 7329 2e0a 2020 2020 2020 2020 2020 2020  s)..            
+00050270: 4966 2074 6865 7265 2069 7320 6f6e 6520  If there is one 
+00050280: 7061 6972 206f 6620 7361 6d70 6c65 2073  pair of sample s
+00050290: 6574 7320 616e 6420 7769 6e64 6f77 733d  ets and windows=
+000502a0: 4e6f 6e65 2c20 6120 6e75 6d70 7920 7363  None, a numpy sc
+000502b0: 616c 6172 2069 730a 2020 2020 2020 2020  alar is.        
+000502c0: 2020 2020 7265 7475 726e 6564 2e0a 0a20      returned... 
+000502d0: 2020 2020 2020 2022 2222 0a20 2020 2020         """.     
+000502e0: 2020 2072 6574 7572 6e20 7365 6c66 2e5f     return self._
+000502f0: 5f6b 5f77 6179 5f73 616d 706c 655f 7365  _k_way_sample_se
+00050300: 745f 7374 6174 280a 2020 2020 2020 2020  t_stat(.        
+00050310: 2020 2020 7365 6c66 2e5f 6c6c 5f74 7265      self._ll_tre
+00050320: 655f 7365 7175 656e 6365 2e64 6976 6572  e_sequence.diver
+00050330: 6765 6e63 652c 0a20 2020 2020 2020 2020  gence,.         
+00050340: 2020 2032 2c0a 2020 2020 2020 2020 2020     2,.          
+00050350: 2020 7361 6d70 6c65 5f73 6574 732c 0a20    sample_sets,. 
+00050360: 2020 2020 2020 2020 2020 2069 6e64 6578             index
+00050370: 6573 3d69 6e64 6578 6573 2c0a 2020 2020  es=indexes,.    
+00050380: 2020 2020 2020 2020 7769 6e64 6f77 733d          windows=
+00050390: 7769 6e64 6f77 732c 0a20 2020 2020 2020  windows,.       
+000503a0: 2020 2020 206d 6f64 653d 6d6f 6465 2c0a       mode=mode,.
+000503b0: 2020 2020 2020 2020 2020 2020 7370 616e              span
+000503c0: 5f6e 6f72 6d61 6c69 7365 3d73 7061 6e5f  _normalise=span_
+000503d0: 6e6f 726d 616c 6973 652c 0a20 2020 2020  normalise,.     
+000503e0: 2020 2029 0a0a 2020 2020 2320 4a4b 3a20     )..    # JK: 
+000503f0: 636f 6d6d 656e 7469 6e67 2074 6869 7320  commenting this 
+00050400: 6f75 7420 666f 7220 6e6f 7720 746f 2067  out for now to g
+00050410: 6574 2074 6865 206f 7468 6572 206d 6574  et the other met
+00050420: 686f 6473 2077 656c 6c20 7465 7374 6564  hods well tested
+00050430: 2e0a 2020 2020 2320 4973 7375 653a 2068  ..    # Issue: h
+00050440: 7474 7073 3a2f 2f67 6974 6875 622e 636f  ttps://github.co
+00050450: 6d2f 7473 6b69 742d 6465 762f 7473 6b69  m/tskit-dev/tski
+00050460: 742f 6973 7375 6573 2f32 3031 0a20 2020  t/issues/201.   
+00050470: 2023 2064 6566 2064 6976 6572 6765 6e63   # def divergenc
+00050480: 655f 6d61 7472 6978 2873 656c 662c 2073  e_matrix(self, s
+00050490: 616d 706c 655f 7365 7473 2c20 7769 6e64  ample_sets, wind
+000504a0: 6f77 733d 4e6f 6e65 2c20 6d6f 6465 3d22  ows=None, mode="
+000504b0: 7369 7465 2229 3a0a 2020 2020 2320 2020  site"):.    #   
+000504c0: 2020 2222 220a 2020 2020 2320 2020 2020    """.    #     
+000504d0: 4669 6e64 7320 7468 6520 6d65 616e 2064  Finds the mean d
+000504e0: 6976 6572 6765 6e63 6520 2062 6574 7765  ivergence  betwe
+000504f0: 656e 2070 6169 7273 206f 6620 7361 6d70  en pairs of samp
+00050500: 6c65 7320 6672 6f6d 2065 6163 6820 7365  les from each se
+00050510: 7420 6f66 0a20 2020 2023 2020 2020 2073  t of.    #     s
+00050520: 616d 706c 6573 2061 6e64 2069 6e20 6561  amples and in ea
+00050530: 6368 2077 696e 646f 772e 2052 6574 7572  ch window. Retur
+00050540: 6e73 2061 206e 756d 7079 2061 7272 6179  ns a numpy array
+00050550: 2069 6e64 6578 6564 2062 7920 2877 696e   indexed by (win
+00050560: 646f 772c 0a20 2020 2023 2020 2020 2073  dow,.    #     s
+00050570: 616d 706c 655f 7365 742c 2073 616d 706c  ample_set, sampl
+00050580: 655f 7365 7429 2e20 2044 6961 676f 6e61  e_set).  Diagona
+00050590: 6c20 656e 7472 6965 7320 6172 6520 636f  l entries are co
+000505a0: 7272 6563 7465 6420 736f 2074 6861 7420  rrected so that 
+000505b0: 7468 650a 2020 2020 2320 2020 2020 7661  the.    #     va
+000505c0: 6c75 6520 6769 7665 7320 7468 6520 6d65  lue gives the me
+000505d0: 616e 2064 6976 6572 6765 6e63 6520 666f  an divergence fo
+000505e0: 7220 2a64 6973 7469 6e63 742a 2073 616d  r *distinct* sam
+000505f0: 706c 6573 2c20 6275 7420 6974 2069 7320  ples, but it is 
+00050600: 6e6f 740a 2020 2020 2320 2020 2020 6368  not.    #     ch
+00050610: 6563 6b65 6420 7768 6574 6865 7220 7468  ecked whether th
+00050620: 6520 7361 6d70 6c65 5f73 6574 7320 6172  e sample_sets ar
+00050630: 6520 6469 736a 6f69 6e74 2028 736f 206f  e disjoint (so o
+00050640: 6666 6469 6167 6f6e 616c 7320 6172 6520  ffdiagonals are 
+00050650: 6e6f 740a 2020 2020 2320 2020 2020 636f  not.    #     co
+00050660: 7272 6563 7465 6429 2e20 2046 6f72 2074  rrected).  For t
+00050670: 6869 7320 7265 6173 6f6e 2c20 6966 2061  his reason, if a
+00050680: 6e20 656c 656d 656e 7420 6f66 2060 7361  n element of `sa
+00050690: 6d70 6c65 5f73 6574 7360 2068 6173 206f  mple_sets` has o
+000506a0: 6e6c 790a 2020 2020 2320 2020 2020 6f6e  nly.    #     on
+000506b0: 6520 656c 656d 656e 742c 2074 6865 2063  e element, the c
+000506c0: 6f72 7265 7370 6f6e 6469 6e67 2064 6961  orresponding dia
+000506d0: 676f 6e61 6c20 7769 6c6c 2062 6520 4e61  gonal will be Na
+000506e0: 4e2e 0a0a 2020 2020 2320 2020 2020 5468  N...    #     Th
+000506f0: 6520 6d65 616e 2064 6976 6572 6765 6e63  e mean divergenc
+00050700: 6520 6265 7477 6565 6e20 7477 6f20 7361  e between two sa
+00050710: 6d70 6c65 7320 6973 2064 6566 696e 6564  mples is defined
+00050720: 2074 6f20 6265 2074 6865 206d 6561 6e3a   to be the mean:
+00050730: 2028 6173 0a20 2020 2023 2020 2020 2061   (as.    #     a
+00050740: 2054 7265 6553 7461 7429 206c 656e 6774   TreeStat) lengt
+00050750: 6820 6f66 2061 6c6c 2065 6467 6573 2073  h of all edges s
+00050760: 6570 6172 6174 696e 6720 7468 656d 2069  eparating them i
+00050770: 6e20 7468 6520 7472 6565 2c20 6f72 2028  n the tree, or (
+00050780: 6173 2061 0a20 2020 2023 2020 2020 2053  as a.    #     S
+00050790: 6974 6553 7461 7429 2064 656e 7369 7479  iteStat) density
+000507a0: 206f 6620 7365 6772 6567 6174 696e 6720   of segregating 
+000507b0: 7369 7465 732c 2061 7420 6120 756e 6966  sites, at a unif
+000507c0: 6f72 6d6c 7920 6368 6f73 656e 2070 6f73  ormly chosen pos
+000507d0: 6974 696f 6e0a 2020 2020 2320 2020 2020  ition.    #     
+000507e0: 6f6e 2074 6865 2067 656e 6f6d 652e 0a0a  on the genome...
+000507f0: 2020 2020 2320 2020 2020 3a70 6172 616d      #     :param
+00050800: 206c 6973 7420 7361 6d70 6c65 5f73 6574   list sample_set
+00050810: 733a 2041 206c 6973 7420 6f66 2073 6574  s: A list of set
+00050820: 7320 6f66 2049 4473 206f 6620 7361 6d70  s of IDs of samp
+00050830: 6c65 732e 0a20 2020 2023 2020 2020 203a  les..    #     :
+00050840: 7061 7261 6d20 6974 6572 6162 6c65 2077  param iterable w
+00050850: 696e 646f 7773 3a20 5468 6520 6272 6561  indows: The brea
+00050860: 6b70 6f69 6e74 7320 6f66 2074 6865 2077  kpoints of the w
+00050870: 696e 646f 7773 2028 696e 636c 7564 696e  indows (includin
+00050880: 6720 7374 6172 740a 2020 2020 2320 2020  g start.    #   
+00050890: 2020 2020 2020 616e 6420 656e 642c 2073        and end, s
+000508a0: 6f20 6861 7320 6f6e 6520 6d6f 7265 2065  o has one more e
+000508b0: 6e74 7279 2074 6861 6e20 6e75 6d62 6572  ntry than number
+000508c0: 206f 6620 7769 6e64 6f77 7329 2e0a 2020   of windows)..  
+000508d0: 2020 2320 2020 2020 3a72 6574 7572 6e3a    #     :return:
+000508e0: 2041 206c 6973 7420 6f66 2074 6865 2075   A list of the u
+000508f0: 7070 6572 2074 7269 616e 676c 6520 6f66  pper triangle of
+00050900: 206d 6561 6e20 544d 5243 4120 7661 6c75   mean TMRCA valu
+00050910: 6573 2069 6e20 726f 772d 6d61 6a6f 720a  es in row-major.
+00050920: 2020 2020 2320 2020 2020 2020 2020 6f72      #         or
+00050930: 6465 722c 2069 6e63 6c75 6469 6e67 2074  der, including t
+00050940: 6865 2064 6961 676f 6e61 6c2e 0a20 2020  he diagonal..   
+00050950: 2023 2020 2020 2022 2222 0a20 2020 2023   #     """.    #
+00050960: 2020 2020 206e 7320 3d20 6c65 6e28 7361       ns = len(sa
+00050970: 6d70 6c65 5f73 6574 7329 0a20 2020 2023  mple_sets).    #
+00050980: 2020 2020 2069 6e64 6578 6573 203d 205b       indexes = [
+00050990: 2869 2c20 6a29 2066 6f72 2069 2069 6e20  (i, j) for i in 
+000509a0: 7261 6e67 6528 6e73 2920 666f 7220 6a20  range(ns) for j 
+000509b0: 696e 2072 616e 6765 2869 2c20 6e73 295d  in range(i, ns)]
+000509c0: 0a20 2020 2023 2020 2020 2078 203d 2073  .    #     x = s
+000509d0: 656c 662e 6469 7665 7267 656e 6365 2873  elf.divergence(s
+000509e0: 616d 706c 655f 7365 7473 2c20 696e 6465  ample_sets, inde
+000509f0: 7865 732c 2077 696e 646f 7773 2c20 6d6f  xes, windows, mo
+00050a00: 6465 3d6d 6f64 6529 0a20 2020 2023 2020  de=mode).    #  
+00050a10: 2020 206e 7720 3d20 6c65 6e28 7769 6e64     nw = len(wind
+00050a20: 6f77 7329 202d 2031 0a20 2020 2023 2020  ows) - 1.    #  
+00050a30: 2020 2041 203d 206e 702e 6f6e 6573 2828     A = np.ones((
+00050a40: 6e77 2c20 6e73 2c20 6e73 292c 2064 7479  nw, ns, ns), dty
+00050a50: 7065 3d66 6c6f 6174 290a 2020 2020 2320  pe=float).    # 
+00050a60: 2020 2020 666f 7220 7720 696e 2072 616e      for w in ran
+00050a70: 6765 286e 7729 3a0a 2020 2020 2320 2020  ge(nw):.    #   
+00050a80: 2020 2020 2020 6b20 3d20 300a 2020 2020        k = 0.    
+00050a90: 2320 2020 2020 2020 2020 666f 7220 6920  #         for i 
+00050aa0: 696e 2072 616e 6765 286e 7329 3a0a 2020  in range(ns):.  
+00050ab0: 2020 2320 2020 2020 2020 2020 2020 2020    #             
+00050ac0: 666f 7220 6a20 696e 2072 616e 6765 2869  for j in range(i
+00050ad0: 2c20 6e73 293a 0a20 2020 2023 2020 2020  , ns):.    #    
+00050ae0: 2020 2020 2020 2020 2020 2020 2041 5b77               A[w
+00050af0: 2c20 692c 206a 5d20 3d20 415b 772c 206a  , i, j] = A[w, j
+00050b00: 2c20 695d 203d 2078 5b77 5d5b 6b5d 0a20  , i] = x[w][k]. 
+00050b10: 2020 2023 2020 2020 2020 2020 2020 2020     #            
+00050b20: 2020 2020 206b 202b 3d20 310a 2020 2020       k += 1.    
+00050b30: 2320 2020 2020 7265 7475 726e 2041 0a0a  #     return A..
+00050b40: 2020 2020 6465 6620 6765 6e65 7469 635f      def genetic_
+00050b50: 7265 6c61 7465 646e 6573 7328 0a20 2020  relatedness(.   
+00050b60: 2020 2020 2073 656c 662c 0a20 2020 2020       self,.     
+00050b70: 2020 2073 616d 706c 655f 7365 7473 2c0a     sample_sets,.
+00050b80: 2020 2020 2020 2020 696e 6465 7865 733d          indexes=
+00050b90: 4e6f 6e65 2c0a 2020 2020 2020 2020 7769  None,.        wi
+00050ba0: 6e64 6f77 733d 4e6f 6e65 2c0a 2020 2020  ndows=None,.    
+00050bb0: 2020 2020 6d6f 6465 3d22 7369 7465 222c      mode="site",
+00050bc0: 0a20 2020 2020 2020 2073 7061 6e5f 6e6f  .        span_no
+00050bd0: 726d 616c 6973 653d 5472 7565 2c0a 2020  rmalise=True,.  
+00050be0: 2020 2020 2020 706f 6c61 7269 7365 643d        polarised=
+00050bf0: 4661 6c73 652c 0a20 2020 2020 2020 2070  False,.        p
+00050c00: 726f 706f 7274 696f 6e3d 5472 7565 2c0a  roportion=True,.
+00050c10: 2020 2020 293a 0a20 2020 2020 2020 2022      ):.        "
+00050c20: 2222 0a20 2020 2020 2020 2043 6f6d 7075  "".        Compu
+00050c30: 7465 7320 6765 6e65 7469 6320 7265 6c61  tes genetic rela
+00050c40: 7465 646e 6573 7320 6265 7477 6565 6e20  tedness between 
+00050c50: 2861 6e64 2077 6974 6869 6e29 2070 6169  (and within) pai
+00050c60: 7273 206f 660a 2020 2020 2020 2020 7365  rs of.        se
+00050c70: 7473 206f 6620 6e6f 6465 7320 6672 6f6d  ts of nodes from
+00050c80: 2060 6073 616d 706c 655f 7365 7473 6060   ``sample_sets``
+00050c90: 2e0a 2020 2020 2020 2020 4f70 6572 6174  ..        Operat
+00050ca0: 6573 206f 6e20 6060 6b20 3d20 3260 6020  es on ``k = 2`` 
+00050cb0: 7361 6d70 6c65 2073 6574 7320 6174 2061  sample sets at a
+00050cc0: 2074 696d 653b 2070 6c65 6173 6520 7365   time; please se
+00050cd0: 6520 7468 650a 2020 2020 2020 2020 3a72  e the.        :r
+00050ce0: 6566 3a60 6d75 6c74 692d 7761 7920 7374  ef:`multi-way st
+00050cf0: 6174 6973 7469 6373 203c 7365 635f 7374  atistics <sec_st
+00050d00: 6174 735f 7361 6d70 6c65 5f73 6574 735f  ats_sample_sets_
+00050d10: 6d75 6c74 695f 7761 793e 600a 2020 2020  multi_way>`.    
+00050d20: 2020 2020 7365 6374 696f 6e20 666f 7220      section for 
+00050d30: 6465 7461 696c 7320 6f6e 2068 6f77 2074  details on how t
+00050d40: 6865 2060 6073 616d 706c 655f 7365 7473  he ``sample_sets
+00050d50: 6060 2061 6e64 2060 6069 6e64 6578 6573  `` and ``indexes
+00050d60: 6060 2061 7267 756d 656e 7473 2061 7265  `` arguments are
+00050d70: 0a20 2020 2020 2020 2069 6e74 6572 7072  .        interpr
+00050d80: 6574 6564 2061 6e64 2068 6f77 2074 6865  eted and how the
+00050d90: 7920 696e 7465 7261 6374 2077 6974 6820  y interact with 
+00050da0: 7468 6520 6469 6d65 6e73 696f 6e73 206f  the dimensions o
+00050db0: 6620 7468 6520 6f75 7470 7574 2061 7272  f the output arr
+00050dc0: 6179 2e0a 2020 2020 2020 2020 5365 6520  ay..        See 
+00050dd0: 7468 6520 3a72 6566 3a60 7374 6174 6973  the :ref:`statis
+00050de0: 7469 6373 2069 6e74 6572 6661 6365 203c  tics interface <
+00050df0: 7365 635f 7374 6174 735f 696e 7465 7266  sec_stats_interf
+00050e00: 6163 653e 6020 7365 6374 696f 6e20 666f  ace>` section fo
+00050e10: 7220 6465 7461 696c 7320 6f6e 0a20 2020  r details on.   
+00050e20: 2020 2020 203a 7265 663a 6077 696e 646f       :ref:`windo
+00050e30: 7773 203c 7365 635f 7374 6174 735f 7769  ws <sec_stats_wi
+00050e40: 6e64 6f77 733e 602c 0a20 2020 2020 2020  ndows>`,.       
+00050e50: 203a 7265 663a 606d 6f64 6520 3c73 6563   :ref:`mode <sec
+00050e60: 5f73 7461 7473 5f6d 6f64 653e 602c 0a20  _stats_mode>`,. 
+00050e70: 2020 2020 2020 203a 7265 663a 6073 7061         :ref:`spa
+00050e80: 6e20 6e6f 726d 616c 6973 6520 3c73 6563  n normalise <sec
+00050e90: 5f73 7461 7473 5f73 7061 6e5f 6e6f 726d  _stats_span_norm
+00050ea0: 616c 6973 653e 602c 0a20 2020 2020 2020  alise>`,.       
+00050eb0: 203a 7265 663a 6070 6f6c 6172 6973 6564   :ref:`polarised
+00050ec0: 203c 7365 635f 7374 6174 735f 706f 6c61   <sec_stats_pola
+00050ed0: 7269 7361 7469 6f6e 3e60 2c0a 2020 2020  risation>`,.    
+00050ee0: 2020 2020 616e 6420 3a72 6566 3a60 7265      and :ref:`re
+00050ef0: 7475 726e 2076 616c 7565 203c 7365 635f  turn value <sec_
+00050f00: 7374 6174 735f 6f75 7470 7574 5f66 6f72  stats_output_for
+00050f10: 6d61 743e 602e 0a0a 2020 2020 2020 2020  mat>`...        
+00050f20: 5768 6174 2069 7320 636f 6d70 7574 6564  What is computed
+00050f30: 2064 6570 656e 6473 206f 6e20 6060 6d6f   depends on ``mo
+00050f40: 6465 6060 3a0a 0a20 2020 2020 2020 2022  de``:..        "
+00050f50: 7369 7465 220a 2020 2020 2020 2020 2020  site".          
+00050f60: 2020 4e75 6d62 6572 206f 6620 7061 6972    Number of pair
+00050f70: 7769 7365 2061 6c6c 656c 6963 206d 6174  wise allelic mat
+00050f80: 6368 6573 2069 6e20 7468 6520 7769 6e64  ches in the wind
+00050f90: 6f77 2062 6574 7765 656e 2074 776f 0a20  ow between two. 
+00050fa0: 2020 2020 2020 2020 2020 2073 616d 706c             sampl
+00050fb0: 6520 7365 7473 2072 656c 6174 6976 6520  e sets relative 
+00050fc0: 746f 2074 6865 2072 6573 7420 6f66 2074  to the rest of t
+00050fd0: 6865 2073 616d 706c 6520 7365 7473 2e20  he sample sets. 
+00050fe0: 546f 2062 6520 7072 6563 6973 652c 0a20  To be precise,. 
+00050ff0: 2020 2020 2020 2020 2020 206c 6574 2060             let `
+00051000: 6d28 752c 7629 6020 6465 6e6f 7465 2074  m(u,v)` denote t
+00051010: 6865 2074 6f74 616c 206e 756d 6265 7220  he total number 
+00051020: 6f66 2061 6c6c 656c 6573 2073 6861 7265  of alleles share
+00051030: 6420 6265 7477 6565 6e0a 2020 2020 2020  d between.      
+00051040: 2020 2020 2020 6e6f 6465 7320 6075 6020        nodes `u` 
+00051050: 616e 6420 6076 602c 2061 6e64 206c 6574  and `v`, and let
+00051060: 2060 6d28 492c 4a29 6020 6265 2074 6865   `m(I,J)` be the
+00051070: 2073 756d 206f 6620 606d 2875 2c76 2960   sum of `m(u,v)`
+00051080: 206f 7665 7220 616c 6c0a 2020 2020 2020   over all.      
+00051090: 2020 2020 2020 6e6f 6465 7320 6075 6020        nodes `u` 
+000510a0: 696e 2073 616d 706c 6520 7365 7420 6049  in sample set `I
+000510b0: 6020 616e 6420 6076 6020 696e 2073 616d  ` and `v` in sam
+000510c0: 706c 6520 7365 7420 604a 602e 204c 6574  ple set `J`. Let
+000510d0: 2060 5360 2061 6e64 0a20 2020 2020 2020   `S` and.       
+000510e0: 2020 2020 2060 5460 2062 6520 696e 6465       `T` be inde
+000510f0: 7065 6e64 656e 746c 7920 6368 6f73 656e  pendently chosen
+00051100: 2073 616d 706c 6520 7365 7473 2e20 5468   sample sets. Th
+00051110: 656e 2c20 666f 7220 7361 6d70 6c65 2073  en, for sample s
+00051120: 6574 7320 6049 600a 2020 2020 2020 2020  ets `I`.        
+00051130: 2020 2020 616e 6420 604a 602c 2074 6869      and `J`, thi
+00051140: 7320 636f 6d70 7574 6573 2060 455b 6d28  s computes `E[m(
+00051150: 492c 4a29 202d 206d 2849 2c53 2920 2d20  I,J) - m(I,S) - 
+00051160: 6d28 4a2c 5429 202b 206d 2853 2c54 295d  m(J,T) + m(S,T)]
+00051170: 602e 0a20 2020 2020 2020 2020 2020 2054  `..            T
+00051180: 6869 7320 6361 6e20 616c 736f 2062 6520  his can also be 
+00051190: 7365 656e 2061 7320 7468 6520 636f 7661  seen as the cova
+000511a0: 7269 616e 6365 206f 6620 6120 7175 616e  riance of a quan
+000511b0: 7469 7461 7469 7665 2074 7261 6974 0a20  titative trait. 
+000511c0: 2020 2020 2020 2020 2020 2064 6574 6572             deter
+000511d0: 6d69 6e65 6420 6279 2061 6464 6974 6976  mined by additiv
+000511e0: 6520 636f 6e74 7269 6275 7469 6f6e 7320  e contributions 
+000511f0: 6672 6f6d 2074 6865 2067 656e 6f6d 6573  from the genomes
+00051200: 2069 6e20 6561 6368 0a20 2020 2020 2020   in each.       
+00051210: 2020 2020 2073 616d 706c 6520 7365 742e       sample set.
+00051220: 204c 6574 2065 6163 6820 616c 6c65 6c65   Let each allele
+00051230: 2062 6520 6173 736f 6369 6174 6564 2077   be associated w
+00051240: 6974 6820 616e 2065 6666 6563 7420 6472  ith an effect dr
+00051250: 6177 6e20 6672 6f6d 0a20 2020 2020 2020  awn from.       
+00051260: 2020 2020 2061 2060 4e28 302c 312f 3229       a `N(0,1/2)
+00051270: 6020 6469 7374 7269 6275 7469 6f6e 2c20  ` distribution, 
+00051280: 616e 6420 6c65 7420 7468 6520 7472 6169  and let the trai
+00051290: 7420 7661 6c75 6520 6f66 2061 2073 616d  t value of a sam
+000512a0: 706c 6520 7365 740a 2020 2020 2020 2020  ple set.        
+000512b0: 2020 2020 6265 2074 6865 2073 756d 206f      be the sum o
+000512c0: 6620 6974 7320 616c 6c65 6c65 2065 6666  f its allele eff
+000512d0: 6563 7473 2e20 5468 656e 2c20 7468 6973  ects. Then, this
+000512e0: 2063 6f6d 7075 7465 7320 7468 6520 636f   computes the co
+000512f0: 7661 7269 616e 6365 0a20 2020 2020 2020  variance.       
+00051300: 2020 2020 2062 6574 7765 656e 2074 6865       between the
+00051310: 2074 7261 6974 2076 616c 7565 7320 6f66   trait values of
+00051320: 2074 776f 2073 616d 706c 6520 7365 7473   two sample sets
+00051330: 2e20 466f 7220 6578 616d 706c 652c 2074  . For example, t
+00051340: 6f0a 2020 2020 2020 2020 2020 2020 636f  o.            co
+00051350: 6d70 7574 6520 636f 7661 7269 616e 6365  mpute covariance
+00051360: 2062 6574 7765 656e 2074 6865 2074 7261   between the tra
+00051370: 6974 7320 6f66 2064 6970 6c6f 6964 2069  its of diploid i
+00051380: 6e64 6976 6964 7561 6c73 2c20 6561 6368  ndividuals, each
+00051390: 0a20 2020 2020 2020 2020 2020 2073 616d  .            sam
+000513a0: 706c 6520 7365 7420 776f 756c 6420 6265  ple set would be
+000513b0: 2074 6865 2070 6169 7220 6f66 2067 656e   the pair of gen
+000513c0: 6f6d 6573 206f 6620 6561 6368 2069 6e64  omes of each ind
+000513d0: 6976 6964 7561 6c3b 2069 660a 2020 2020  ividual; if.    
+000513e0: 2020 2020 2020 2020 6060 7072 6f70 6f72          ``propor
+000513f0: 7469 6f6e 3d54 7275 6560 602c 2074 6869  tion=True``, thi
+00051400: 7320 7468 656e 2063 6f72 7265 7370 6f6e  s then correspon
+00051410: 6473 2074 6f20 3a6d 6174 683a 604b 5f7b  ds to :math:`K_{
+00051420: 6330 7d60 2069 6e0a 2020 2020 2020 2020  c0}` in.        
+00051430: 2020 2020 6053 7065 6564 2026 2042 616c      `Speed & Bal
+00051440: 6469 6e67 2028 3230 3134 2920 3c68 7474  ding (2014) <htt
+00051450: 7073 3a2f 2f77 7777 2e6e 6174 7572 652e  ps://www.nature.
+00051460: 636f 6d2f 6172 7469 636c 6573 2f6e 7267  com/articles/nrg
+00051470: 3338 3231 3e60 5f2e 0a0a 2020 2020 2020  3821>`_...      
+00051480: 2020 2262 7261 6e63 6822 0a20 2020 2020    "branch".     
+00051490: 2020 2020 2020 2054 6f74 616c 2061 7265         Total are
+000514a0: 6120 6f66 2062 7261 6e63 6865 7320 696e  a of branches in
+000514b0: 2074 6865 2077 696e 646f 7720 616e 6365   the window ance
+000514c0: 7374 7261 6c20 746f 2070 6169 7273 206f  stral to pairs o
+000514d0: 6620 7361 6d70 6c65 730a 2020 2020 2020  f samples.      
+000514e0: 2020 2020 2020 696e 2074 776f 2073 616d        in two sam
+000514f0: 706c 6520 7365 7473 2072 656c 6174 6976  ple sets relativ
+00051500: 6520 746f 2074 6865 2072 6573 7420 6f66  e to the rest of
+00051510: 2074 6865 2073 616d 706c 6520 7365 7473   the sample sets
+00051520: 2e20 546f 2062 650a 2020 2020 2020 2020  . To be.        
+00051530: 2020 2020 7072 6563 6973 652c 206c 6574      precise, let
+00051540: 2060 4228 752c 7629 6020 6465 6e6f 7465   `B(u,v)` denote
+00051550: 2074 6865 2074 6f74 616c 2061 7265 6120   the total area 
+00051560: 6f66 2061 6c6c 2062 7261 6e63 6865 730a  of all branches.
+00051570: 2020 2020 2020 2020 2020 2020 616e 6365              ance
+00051580: 7374 7261 6c20 746f 206e 6f64 6573 2060  stral to nodes `
+00051590: 7560 2061 6e64 2060 7660 2c20 616e 6420  u` and `v`, and 
+000515a0: 6c65 7420 6042 2849 2c4a 2960 2062 6520  let `B(I,J)` be 
+000515b0: 7468 6520 7375 6d20 6f66 0a20 2020 2020  the sum of.     
+000515c0: 2020 2020 2020 2060 4228 752c 7629 6020         `B(u,v)` 
+000515d0: 6f76 6572 2061 6c6c 206e 6f64 6573 2060  over all nodes `
+000515e0: 7560 2069 6e20 7361 6d70 6c65 2073 6574  u` in sample set
+000515f0: 2060 4960 2061 6e64 2060 7660 2069 6e20   `I` and `v` in 
+00051600: 7361 6d70 6c65 2073 6574 0a20 2020 2020  sample set.     
+00051610: 2020 2020 2020 2060 4a60 2e20 4c65 7420         `J`. Let 
+00051620: 6053 6020 616e 6420 6054 6020 6265 2074  `S` and `T` be t
+00051630: 776f 2069 6e64 6570 656e 6465 6e74 6c79  wo independently
+00051640: 2063 686f 7365 6e20 7361 6d70 6c65 2073   chosen sample s
+00051650: 6574 732e 2054 6865 6e0a 2020 2020 2020  ets. Then.      
+00051660: 2020 2020 2020 666f 7220 7361 6d70 6c65        for sample
+00051670: 2073 6574 7320 6049 6020 616e 6420 604a   sets `I` and `J
+00051680: 602c 2074 6869 7320 636f 6d70 7574 6573  `, this computes
+00051690: 0a20 2020 2020 2020 2020 2020 2060 455b  .            `E[
+000516a0: 4228 492c 4a29 202d 2042 2849 2c53 2920  B(I,J) - B(I,S) 
+000516b0: 2d20 4228 4a2c 5429 202b 2042 2853 2c54  - B(J,T) + B(S,T
+000516c0: 295d 602e 0a0a 2020 2020 2020 2020 226e  )]`...        "n
+000516d0: 6f64 6522 0a20 2020 2020 2020 2020 2020  ode".           
+000516e0: 2046 6f72 2065 6163 6820 6e6f 6465 2c20   For each node, 
+000516f0: 7468 6520 7072 6f70 6f72 7469 6f6e 206f  the proportion o
+00051700: 6620 7468 6520 7769 6e64 6f77 206f 7665  f the window ove
+00051710: 7220 7768 6963 6820 7061 6972 7320 6f66  r which pairs of
+00051720: 0a20 2020 2020 2020 2020 2020 2073 616d  .            sam
+00051730: 706c 6573 2069 6e20 7477 6f20 7361 6d70  ples in two samp
+00051740: 6c65 2073 6574 7320 6172 6520 6465 7363  le sets are desc
+00051750: 656e 6461 6e74 732c 2072 656c 6174 6976  endants, relativ
+00051760: 6520 746f 2074 6865 2072 6573 7420 6f66  e to the rest of
+00051770: 0a20 2020 2020 2020 2020 2020 2074 6865  .            the
+00051780: 2073 616d 706c 6520 7365 7473 2e20 546f   sample sets. To
+00051790: 2062 6520 7072 6563 6973 652c 2066 6f72   be precise, for
+000517a0: 2065 6163 6820 6e6f 6465 2060 6e60 2c20   each node `n`, 
+000517b0: 6c65 7420 604e 2875 2c76 2960 0a20 2020  let `N(u,v)`.   
+000517c0: 2020 2020 2020 2020 2064 656e 6f74 6520           denote 
+000517d0: 7468 6520 7072 6f70 6f72 7469 6f6e 206f  the proportion o
+000517e0: 6620 7468 6520 7769 6e64 6f77 206f 7665  f the window ove
+000517f0: 7220 7768 6963 6820 7361 6d70 6c65 7320  r which samples 
+00051800: 6075 6020 616e 6420 6076 600a 2020 2020  `u` and `v`.    
+00051810: 2020 2020 2020 2020 6172 6520 6465 7363          are desc
+00051820: 656e 6461 6e74 7320 6f66 2060 6e60 2c20  endants of `n`, 
+00051830: 616e 6420 6c65 7420 616e 6420 6c65 7420  and let and let 
+00051840: 604e 2849 2c4a 2960 2062 6520 7468 6520  `N(I,J)` be the 
+00051850: 7375 6d20 6f66 0a20 2020 2020 2020 2020  sum of.         
+00051860: 2020 2060 4e28 752c 7629 6020 6f76 6572     `N(u,v)` over
+00051870: 2061 6c6c 206e 6f64 6573 2060 7560 2069   all nodes `u` i
+00051880: 6e20 7361 6d70 6c65 2073 6574 2060 4960  n sample set `I`
+00051890: 2061 6e64 2060 7660 2069 6e20 7361 6d70   and `v` in samp
+000518a0: 6c65 2073 6574 0a20 2020 2020 2020 2020  le set.         
+000518b0: 2020 2060 4a60 2e20 4c65 7420 6053 6020     `J`. Let `S` 
+000518c0: 616e 6420 6054 6020 6265 2074 776f 2069  and `T` be two i
+000518d0: 6e64 6570 656e 6465 6e74 6c79 2063 686f  ndependently cho
+000518e0: 7365 6e20 7361 6d70 6c65 2073 6574 732e  sen sample sets.
+000518f0: 2054 6865 6e0a 2020 2020 2020 2020 2020   Then.          
+00051900: 2020 666f 7220 7361 6d70 6c65 2073 6574    for sample set
+00051910: 7320 6049 6020 616e 6420 604a 602c 2074  s `I` and `J`, t
+00051920: 6869 7320 636f 6d70 7574 6573 0a20 2020  his computes.   
+00051930: 2020 2020 2020 2020 2060 455b 4e28 492c           `E[N(I,
+00051940: 4a29 202d 204e 2849 2c53 2920 2d20 4e28  J) - N(I,S) - N(
+00051950: 4a2c 5429 202b 204e 2853 2c54 295d 602e  J,T) + N(S,T)]`.
+00051960: 0a0a 2020 2020 2020 2020 3a70 6172 616d  ..        :param
+00051970: 206c 6973 7420 7361 6d70 6c65 5f73 6574   list sample_set
+00051980: 733a 2041 206c 6973 7420 6f66 206c 6973  s: A list of lis
+00051990: 7473 206f 6620 4e6f 6465 2049 4473 2c20  ts of Node IDs, 
+000519a0: 7370 6563 6966 7969 6e67 2074 6865 0a20  specifying the. 
+000519b0: 2020 2020 2020 2020 2020 2067 726f 7570             group
+000519c0: 7320 6f66 206e 6f64 6573 2074 6f20 636f  s of nodes to co
+000519d0: 6d70 7574 6520 7468 6520 7374 6174 6973  mpute the statis
+000519e0: 7469 6320 7769 7468 2e0a 2020 2020 2020  tic with..      
+000519f0: 2020 3a70 6172 616d 206c 6973 7420 696e    :param list in
+00051a00: 6465 7865 733a 2041 206c 6973 7420 6f66  dexes: A list of
+00051a10: 2032 2d74 7570 6c65 732c 206f 7220 4e6f   2-tuples, or No
+00051a20: 6e65 2e0a 2020 2020 2020 2020 3a70 6172  ne..        :par
+00051a30: 616d 206c 6973 7420 7769 6e64 6f77 733a  am list windows:
+00051a40: 2041 6e20 696e 6372 6561 7369 6e67 206c   An increasing l
+00051a50: 6973 7420 6f66 2062 7265 616b 706f 696e  ist of breakpoin
+00051a60: 7473 2062 6574 7765 656e 2074 6865 2077  ts between the w
+00051a70: 696e 646f 7773 0a20 2020 2020 2020 2020  indows.         
+00051a80: 2020 2074 6f20 636f 6d70 7574 6520 7468     to compute th
+00051a90: 6520 7374 6174 6973 7469 6320 696e 2e0a  e statistic in..
+00051aa0: 2020 2020 2020 2020 3a70 6172 616d 2073          :param s
+00051ab0: 7472 206d 6f64 653a 2041 2073 7472 696e  tr mode: A strin
+00051ac0: 6720 6769 7669 6e67 2074 6865 2022 7479  g giving the "ty
+00051ad0: 7065 2220 6f66 2074 6865 2073 7461 7469  pe" of the stati
+00051ae0: 7374 6963 2074 6f20 6265 2063 6f6d 7075  stic to be compu
+00051af0: 7465 640a 2020 2020 2020 2020 2020 2020  ted.            
+00051b00: 2864 6566 6175 6c74 7320 746f 2022 7369  (defaults to "si
+00051b10: 7465 2229 2e0a 2020 2020 2020 2020 3a70  te")..        :p
+00051b20: 6172 616d 2062 6f6f 6c20 7370 616e 5f6e  aram bool span_n
+00051b30: 6f72 6d61 6c69 7365 3a20 5768 6574 6865  ormalise: Whethe
+00051b40: 7220 746f 2064 6976 6964 6520 7468 6520  r to divide the 
+00051b50: 7265 7375 6c74 2062 7920 7468 6520 7370  result by the sp
+00051b60: 616e 206f 6620 7468 650a 2020 2020 2020  an of the.      
+00051b70: 2020 2020 2020 7769 6e64 6f77 2028 6465        window (de
+00051b80: 6661 756c 7473 2074 6f20 5472 7565 292e  faults to True).
+00051b90: 2048 6173 206e 6f20 6566 6665 6374 2069   Has no effect i
+00051ba0: 6620 6060 7072 6f70 6f72 7469 6f6e 6060  f ``proportion``
+00051bb0: 2069 7320 5472 7565 2e0a 2020 2020 2020   is True..      
+00051bc0: 2020 3a70 6172 616d 2062 6f6f 6c20 7072    :param bool pr
+00051bd0: 6f70 6f72 7469 6f6e 3a20 4465 6661 756c  oportion: Defaul
+00051be0: 7473 2074 6f20 5472 7565 2e20 2057 6865  ts to True.  Whe
+00051bf0: 7468 6572 2074 6f20 6469 7669 6465 2074  ther to divide t
+00051c00: 6865 2072 6573 756c 7420 6279 0a20 2020  he result by.   
+00051c10: 2020 2020 2020 2020 203a 6d65 7468 3a60           :meth:`
+00051c20: 2e73 6567 7265 6761 7469 6e67 5f73 6974  .segregating_sit
+00051c30: 6573 602c 2063 616c 6c65 6420 7769 7468  es`, called with
+00051c40: 2074 6865 2073 616d 6520 6060 7769 6e64   the same ``wind
+00051c50: 6f77 7360 602c 0a20 2020 2020 2020 2020  ows``,.         
+00051c60: 2020 2060 606d 6f64 6560 602c 2061 6e64     ``mode``, and
+00051c70: 2060 6073 7061 6e5f 6e6f 726d 616c 6973   ``span_normalis
+00051c80: 6560 602e 204e 6f74 6520 7468 6174 2074  e``. Note that t
+00051c90: 6869 7320 636f 756e 7473 2073 6974 6573  his counts sites
+00051ca0: 0a20 2020 2020 2020 2020 2020 2074 6861  .            tha
+00051cb0: 7420 6172 6520 7365 6772 6567 6174 696e  t are segregatin
+00051cc0: 6720 6265 7477 6565 6e20 2a61 6e79 2a20  g between *any* 
+00051cd0: 6f66 2074 6865 2073 616d 706c 6573 206f  of the samples o
+00051ce0: 6620 2a61 6e79 2a20 6f66 2074 6865 0a20  f *any* of the. 
+00051cf0: 2020 2020 2020 2020 2020 2073 616d 706c             sampl
+00051d00: 6520 7365 7473 2028 7261 7468 6572 2074  e sets (rather t
+00051d10: 6861 6e20 7365 6772 6567 6174 696e 6720  han segregating 
+00051d20: 6265 7477 6565 6e20 616c 6c20 6f66 2074  between all of t
+00051d30: 6865 2073 616d 706c 6573 206f 660a 2020  he samples of.  
+00051d40: 2020 2020 2020 2020 2020 7468 6520 7472            the tr
+00051d50: 6565 2073 6571 7565 6e63 6529 2e0a 2020  ee sequence)..  
+00051d60: 2020 2020 2020 3a72 6574 7572 6e3a 2041        :return: A
+00051d70: 206e 6461 7272 6179 2077 6974 6820 7368   ndarray with sh
+00051d80: 6170 6520 6571 7561 6c20 746f 2028 6e75  ape equal to (nu
+00051d90: 6d20 7769 6e64 6f77 732c 206e 756d 2073  m windows, num s
+00051da0: 7461 7469 7374 6963 7329 2e0a 2020 2020  tatistics)..    
+00051db0: 2020 2020 2020 2020 4966 2074 6865 7265          If there
+00051dc0: 2069 7320 6f6e 6520 7061 6972 206f 6620   is one pair of 
+00051dd0: 7361 6d70 6c65 2073 6574 7320 616e 6420  sample sets and 
+00051de0: 7769 6e64 6f77 733d 4e6f 6e65 2c20 6120  windows=None, a 
+00051df0: 6e75 6d70 7920 7363 616c 6172 2069 730a  numpy scalar is.
+00051e00: 2020 2020 2020 2020 2020 2020 7265 7475              retu
+00051e10: 726e 6564 2e0a 2020 2020 2020 2020 2222  rned..        ""
+00051e20: 220a 2020 2020 2020 2020 6966 2070 726f  ".        if pro
+00051e30: 706f 7274 696f 6e3a 0a20 2020 2020 2020  portion:.       
+00051e40: 2020 2020 2023 2054 4f44 4f20 7468 6973       # TODO this
+00051e50: 2073 686f 756c 6420 6265 2064 6f6e 6520   should be done 
+00051e60: 696e 2043 2061 6c73 6f0a 2020 2020 2020  in C also.      
+00051e70: 2020 2020 2020 616c 6c5f 7361 6d70 6c65        all_sample
+00051e80: 7320 3d20 6c69 7374 287b 7520 666f 7220  s = list({u for 
+00051e90: 7320 696e 2073 616d 706c 655f 7365 7473  s in sample_sets
+00051ea0: 2066 6f72 2075 2069 6e20 737d 290a 2020   for u in s}).  
+00051eb0: 2020 2020 2020 2020 2020 6465 6e6f 6d69            denomi
+00051ec0: 6e61 746f 7220 3d20 7365 6c66 2e73 6567  nator = self.seg
+00051ed0: 7265 6761 7469 6e67 5f73 6974 6573 280a  regating_sites(.
+00051ee0: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00051ef0: 7361 6d70 6c65 5f73 6574 733d 5b61 6c6c  sample_sets=[all
+00051f00: 5f73 616d 706c 6573 5d2c 0a20 2020 2020  _samples],.     
+00051f10: 2020 2020 2020 2020 2020 2077 696e 646f             windo
+00051f20: 7773 3d77 696e 646f 7773 2c0a 2020 2020  ws=windows,.    
+00051f30: 2020 2020 2020 2020 2020 2020 6d6f 6465              mode
+00051f40: 3d6d 6f64 652c 0a20 2020 2020 2020 2020  =mode,.         
+00051f50: 2020 2020 2020 2073 7061 6e5f 6e6f 726d         span_norm
+00051f60: 616c 6973 653d 7370 616e 5f6e 6f72 6d61  alise=span_norma
+00051f70: 6c69 7365 2c0a 2020 2020 2020 2020 2020  lise,.          
+00051f80: 2020 290a 2020 2020 2020 2020 656c 7365    ).        else
+00051f90: 3a0a 2020 2020 2020 2020 2020 2020 6465  :.            de
+00051fa0: 6e6f 6d69 6e61 746f 7220 3d20 310a 0a20  nominator = 1.. 
+00051fb0: 2020 2020 2020 206e 756d 6572 6174 6f72         numerator
+00051fc0: 203d 2073 656c 662e 5f5f 6b5f 7761 795f   = self.__k_way_
+00051fd0: 7361 6d70 6c65 5f73 6574 5f73 7461 7428  sample_set_stat(
+00051fe0: 0a20 2020 2020 2020 2020 2020 2073 656c  .            sel
+00051ff0: 662e 5f6c 6c5f 7472 6565 5f73 6571 7565  f._ll_tree_seque
+00052000: 6e63 652e 6765 6e65 7469 635f 7265 6c61  nce.genetic_rela
+00052010: 7465 646e 6573 732c 0a20 2020 2020 2020  tedness,.       
+00052020: 2020 2020 2032 2c0a 2020 2020 2020 2020       2,.        
+00052030: 2020 2020 7361 6d70 6c65 5f73 6574 732c      sample_sets,
+00052040: 0a20 2020 2020 2020 2020 2020 2069 6e64  .            ind
+00052050: 6578 6573 3d69 6e64 6578 6573 2c0a 2020  exes=indexes,.  
+00052060: 2020 2020 2020 2020 2020 7769 6e64 6f77            window
+00052070: 733d 7769 6e64 6f77 732c 0a20 2020 2020  s=windows,.     
+00052080: 2020 2020 2020 206d 6f64 653d 6d6f 6465         mode=mode
+00052090: 2c0a 2020 2020 2020 2020 2020 2020 7370  ,.            sp
+000520a0: 616e 5f6e 6f72 6d61 6c69 7365 3d73 7061  an_normalise=spa
+000520b0: 6e5f 6e6f 726d 616c 6973 652c 0a20 2020  n_normalise,.   
+000520c0: 2020 2020 2020 2020 2070 6f6c 6172 6973           polaris
+000520d0: 6564 3d70 6f6c 6172 6973 6564 2c0a 2020  ed=polarised,.  
+000520e0: 2020 2020 2020 290a 2020 2020 2020 2020        ).        
+000520f0: 7769 7468 206e 702e 6572 7273 7461 7465  with np.errstate
+00052100: 2864 6976 6964 653d 2269 676e 6f72 6522  (divide="ignore"
+00052110: 2c20 696e 7661 6c69 643d 2269 676e 6f72  , invalid="ignor
+00052120: 6522 293a 0a20 2020 2020 2020 2020 2020  e"):.           
+00052130: 206f 7574 203d 206e 756d 6572 6174 6f72   out = numerator
+00052140: 202f 2064 656e 6f6d 696e 6174 6f72 0a0a   / denominator..
+00052150: 2020 2020 2020 2020 7265 7475 726e 206f          return o
+00052160: 7574 0a0a 2020 2020 6465 6620 7472 6169  ut..    def trai
+00052170: 745f 636f 7661 7269 616e 6365 2873 656c  t_covariance(sel
+00052180: 662c 2057 2c20 7769 6e64 6f77 733d 4e6f  f, W, windows=No
+00052190: 6e65 2c20 6d6f 6465 3d22 7369 7465 222c  ne, mode="site",
+000521a0: 2073 7061 6e5f 6e6f 726d 616c 6973 653d   span_normalise=
+000521b0: 5472 7565 293a 0a20 2020 2020 2020 2022  True):.        "
+000521c0: 2222 0a20 2020 2020 2020 2043 6f6d 7075  "".        Compu
+000521d0: 7465 7320 7468 6520 6d65 616e 2073 7175  tes the mean squ
+000521e0: 6172 6564 2063 6f76 6172 6961 6e63 6573  ared covariances
+000521f0: 2062 6574 7765 656e 2065 6163 6820 6f66   between each of
+00052200: 2074 6865 2063 6f6c 756d 6e73 206f 6620   the columns of 
+00052210: 6060 5760 600a 2020 2020 2020 2020 2874  ``W``.        (t
+00052220: 6865 2022 7068 656e 6f74 7970 6573 2229  he "phenotypes")
+00052230: 2061 6e64 2069 6e68 6572 6974 616e 6365   and inheritance
+00052240: 2061 6c6f 6e67 2074 6865 2074 7265 6520   along the tree 
+00052250: 7365 7175 656e 6365 2e0a 2020 2020 2020  sequence..      
+00052260: 2020 5365 6520 7468 6520 3a72 6566 3a60    See the :ref:`
+00052270: 7374 6174 6973 7469 6373 2069 6e74 6572  statistics inter
+00052280: 6661 6365 203c 7365 635f 7374 6174 735f  face <sec_stats_
+00052290: 696e 7465 7266 6163 653e 6020 7365 6374  interface>` sect
+000522a0: 696f 6e20 666f 7220 6465 7461 696c 7320  ion for details 
+000522b0: 6f6e 0a20 2020 2020 2020 203a 7265 663a  on.        :ref:
+000522c0: 6077 696e 646f 7773 203c 7365 635f 7374  `windows <sec_st
+000522d0: 6174 735f 7769 6e64 6f77 733e 602c 0a20  ats_windows>`,. 
+000522e0: 2020 2020 2020 203a 7265 663a 606d 6f64         :ref:`mod
+000522f0: 6520 3c73 6563 5f73 7461 7473 5f6d 6f64  e <sec_stats_mod
+00052300: 653e 602c 0a20 2020 2020 2020 203a 7265  e>`,.        :re
+00052310: 663a 6073 7061 6e20 6e6f 726d 616c 6973  f:`span normalis
+00052320: 6520 3c73 6563 5f73 7461 7473 5f73 7061  e <sec_stats_spa
+00052330: 6e5f 6e6f 726d 616c 6973 653e 602c 0a20  n_normalise>`,. 
+00052340: 2020 2020 2020 2061 6e64 203a 7265 663a         and :ref:
+00052350: 6072 6574 7572 6e20 7661 6c75 6520 3c73  `return value <s
+00052360: 6563 5f73 7461 7473 5f6f 7574 7075 745f  ec_stats_output_
+00052370: 666f 726d 6174 3e60 2e0a 2020 2020 2020  format>`..      
+00052380: 2020 4f70 6572 6174 6573 206f 6e20 616c    Operates on al
+00052390: 6c20 7361 6d70 6c65 7320 696e 2074 6865  l samples in the
+000523a0: 2074 7265 6520 7365 7175 656e 6365 2e0a   tree sequence..
+000523b0: 0a20 2020 2020 2020 2043 6f6e 6372 6574  .        Concret
+000523c0: 656c 792c 2069 6620 6067 6020 6973 2061  ely, if `g` is a
+000523d0: 2062 696e 6172 7920 7665 6374 6f72 2074   binary vector t
+000523e0: 6861 7420 696e 6469 6361 7465 7320 696e  hat indicates in
+000523f0: 6865 7269 7461 6e63 6520 6672 6f6d 2061  heritance from a
+00052400: 6e20 616c 6c65 6c65 2c0a 2020 2020 2020  n allele,.      
+00052410: 2020 6272 616e 6368 2c20 6f72 206e 6f64    branch, or nod
+00052420: 6520 616e 6420 6077 6020 6973 2061 2063  e and `w` is a c
+00052430: 6f6c 756d 6e20 6f66 2057 2c20 6e6f 726d  olumn of W, norm
+00052440: 616c 6973 6564 2074 6f20 6861 7665 206d  alised to have m
+00052450: 6561 6e20 7a65 726f 2c0a 2020 2020 2020  ean zero,.      
+00052460: 2020 7468 656e 2074 6865 2063 6f76 6172    then the covar
+00052470: 6961 6e63 6520 6f66 2060 6760 2061 6e64  iance of `g` and
+00052480: 2060 7760 2069 7320 3a6d 6174 683a 605c   `w` is :math:`\
+00052490: 5c73 756d 5f69 2067 5f69 2077 5f69 602c  \sum_i g_i w_i`,
+000524a0: 2074 6865 2073 756d 206f 6620 7468 650a   the sum of the.
+000524b0: 2020 2020 2020 2020 7765 6967 6874 7320          weights 
+000524c0: 636f 7272 6573 706f 6e64 696e 6720 746f  corresponding to
+000524d0: 2065 6e74 7269 6573 206f 6620 6067 6020   entries of `g` 
+000524e0: 7468 6174 2061 7265 2060 3160 2e20 5369  that are `1`. Si
+000524f0: 6e63 6520 7765 6967 6874 7320 7375 6d20  nce weights sum 
+00052500: 746f 0a20 2020 2020 2020 207a 6572 6f2c  to.        zero,
+00052510: 2074 6869 7320 6973 2061 6c73 6f20 6571   this is also eq
+00052520: 7561 6c20 746f 2074 6865 2073 756d 206f  ual to the sum o
+00052530: 6620 7765 6967 6874 7320 7768 6f73 6520  f weights whose 
+00052540: 656e 7472 6965 7320 6f66 2060 6760 2061  entries of `g` a
+00052550: 7265 2030 2e0a 2020 2020 2020 2020 536f  re 0..        So
+00052560: 2c20 3a6d 6174 683a 6063 6f76 2867 2c77  , :math:`cov(g,w
+00052570: 295e 3220 3d20 2828 5c5c 7375 6d5f 6920  )^2 = ((\\sum_i 
+00052580: 675f 6920 775f 6929 5e32 202b 2028 5c5c  g_i w_i)^2 + (\\
+00052590: 7375 6d5f 6920 2831 2d67 5f69 2920 775f  sum_i (1-g_i) w_
+000525a0: 6929 5e32 292f 3260 2e0a 0a20 2020 2020  i)^2)/2`...     
+000525b0: 2020 2057 6861 7420 6973 2063 6f6d 7075     What is compu
+000525c0: 7465 6420 6465 7065 6e64 7320 6f6e 2060  ted depends on `
+000525d0: 606d 6f64 6560 603a 0a0a 2020 2020 2020  `mode``:..      
+000525e0: 2020 2273 6974 6522 0a20 2020 2020 2020    "site".       
+000525f0: 2020 2020 2054 6865 2073 756d 206f 6620       The sum of 
+00052600: 7371 7561 7265 6420 636f 7661 7269 616e  squared covarian
+00052610: 6365 7320 6265 7477 6565 6e20 7072 6573  ces between pres
+00052620: 656e 6365 2f61 6273 656e 6365 206f 6620  ence/absence of 
+00052630: 6561 6368 2061 6c6c 656c 6520 616e 640a  each allele and.
+00052640: 2020 2020 2020 2020 2020 2020 7068 656e              phen
+00052650: 6f74 7970 6573 2c20 6469 7669 6465 6420  otypes, divided 
+00052660: 6279 206c 656e 6774 6820 6f66 2074 6865  by length of the
+00052670: 2077 696e 646f 7720 2869 6620 6060 7370   window (if ``sp
+00052680: 616e 5f6e 6f72 6d61 6c69 7365 3d54 7275  an_normalise=Tru
+00052690: 6560 6029 2e0a 2020 2020 2020 2020 2020  e``)..          
+000526a0: 2020 5468 6973 2069 7320 636f 6d70 7574    This is comput
+000526b0: 6564 2061 7320 7375 6d5f 6120 2873 756d  ed as sum_a (sum
+000526c0: 2877 5b61 5d29 5e32 202f 2032 292c 2077  (w[a])^2 / 2), w
+000526d0: 6865 7265 0a20 2020 2020 2020 2020 2020  here.           
+000526e0: 2077 2069 7320 6120 636f 6c75 6d6e 206f   w is a column o
+000526f0: 6620 5720 7769 7468 2074 6865 2061 7665  f W with the ave
+00052700: 7261 6765 2073 7562 7472 6163 7465 6420  rage subtracted 
+00052710: 6f66 662c 0a20 2020 2020 2020 2020 2020  off,.           
+00052720: 2061 6e64 2077 5b61 5d20 6973 2074 6865   and w[a] is the
+00052730: 2073 756d 206f 6620 616c 6c20 656e 7472   sum of all entr
+00052740: 6965 7320 6f66 2077 2063 6f72 7265 7370  ies of w corresp
+00052750: 6f6e 6469 6e67 2074 6f20 7361 6d70 6c65  onding to sample
+00052760: 730a 2020 2020 2020 2020 2020 2020 6361  s.            ca
+00052770: 7272 7969 6e67 2061 6c6c 656c 6520 2261  rrying allele "a
+00052780: 222c 2061 6e64 2074 6865 2066 6972 7374  ", and the first
+00052790: 2073 756d 2069 7320 6f76 6572 2061 6c6c   sum is over all
+000527a0: 2061 6c6c 656c 6573 2e0a 0a20 2020 2020   alleles...     
+000527b0: 2020 2022 6272 616e 6368 220a 2020 2020     "branch".    
+000527c0: 2020 2020 2020 2020 5468 6520 7375 6d20          The sum 
+000527d0: 6f66 2073 7175 6172 6564 2063 6f76 6172  of squared covar
+000527e0: 6961 6e63 6573 2062 6574 7765 656e 2074  iances between t
+000527f0: 6865 2073 706c 6974 2069 6e64 7563 6564  he split induced
+00052800: 2062 7920 6561 6368 2062 7261 6e63 6820   by each branch 
+00052810: 616e 640a 2020 2020 2020 2020 2020 2020  and.            
+00052820: 7068 656e 6f74 7970 6573 2c20 6d75 6c74  phenotypes, mult
+00052830: 6970 6c69 6564 2062 7920 6272 616e 6368  iplied by branch
+00052840: 206c 656e 6774 682c 2061 7665 7261 6765   length, average
+00052850: 6420 6163 726f 7373 2074 7265 6573 2069  d across trees i
+00052860: 6e0a 2020 2020 2020 2020 2020 2020 7468  n.            th
+00052870: 6520 7769 6e64 6f77 2e20 5468 6973 2069  e window. This i
+00052880: 7320 636f 6d70 7574 6564 2061 7320 6162  s computed as ab
+00052890: 6f76 653a 2061 2062 7261 6e63 6820 7769  ove: a branch wi
+000528a0: 7468 2074 6f74 616c 2077 6569 6768 740a  th total weight.
+000528b0: 2020 2020 2020 2020 2020 2020 775b 625d              w[b]
+000528c0: 2062 656c 6f77 2062 2063 6f6e 7472 6962   below b contrib
+000528d0: 7574 6573 2028 6272 616e 6368 206c 656e  utes (branch len
+000528e0: 6774 6829 202a 2077 5b62 5d5e 3220 746f  gth) * w[b]^2 to
+000528f0: 2074 6865 2074 6f74 616c 0a20 2020 2020   the total.     
+00052900: 2020 2020 2020 2076 616c 7565 2066 6f72         value for
+00052910: 2061 2074 7265 652e 2028 5369 6e63 6520   a tree. (Since 
+00052920: 7468 6520 7375 6d20 6f66 2077 2069 7320  the sum of w is 
+00052930: 7a65 726f 2c20 7468 6520 746f 7461 6c20  zero, the total 
+00052940: 7765 6967 6874 0a20 2020 2020 2020 2020  weight.         
+00052950: 2020 2062 656c 6f77 2062 2061 6e64 206e     below b and n
+00052960: 6f74 2062 656c 6f77 2062 2061 7265 2065  ot below b are e
+00052970: 7175 616c 2c20 6361 6e63 656c 696e 6720  qual, canceling 
+00052980: 7468 6520 6661 6374 6f72 206f 6620 320a  the factor of 2.
+00052990: 2020 2020 2020 2020 2020 2020 6162 6f76              abov
+000529a0: 652e 290a 0a20 2020 2020 2020 2022 6e6f  e.)..        "no
+000529b0: 6465 220a 2020 2020 2020 2020 2020 2020  de".            
+000529c0: 466f 7220 6561 6368 206e 6f64 652c 2074  For each node, t
+000529d0: 6865 2073 7175 6172 6564 2063 6f76 6172  he squared covar
+000529e0: 6961 6e63 6520 6265 7477 6565 6e20 7468  iance between th
+000529f0: 6520 7072 6f70 6572 7479 206f 660a 2020  e property of.  
+00052a00: 2020 2020 2020 2020 2020 696e 6865 7269            inheri
+00052a10: 7469 6e67 2066 726f 6d20 7468 6973 206e  ting from this n
+00052a20: 6f64 6520 616e 6420 7068 656e 6f74 7970  ode and phenotyp
+00052a30: 6573 2c20 636f 6d70 7574 6564 2061 7320  es, computed as 
+00052a40: 696e 2022 6272 616e 6368 222e 0a0a 2020  in "branch"...  
+00052a50: 2020 2020 2020 3a70 6172 616d 206e 756d        :param num
+00052a60: 7079 2e6e 6461 7272 6179 2057 3a20 416e  py.ndarray W: An
+00052a70: 2061 7272 6179 206f 6620 7661 6c75 6573   array of values
+00052a80: 2077 6974 6820 6f6e 6520 726f 7720 666f   with one row fo
+00052a90: 7220 6561 6368 2073 616d 706c 6520 616e  r each sample an
+00052aa0: 6420 6f6e 650a 2020 2020 2020 2020 2020  d one.          
+00052ab0: 2020 636f 6c75 6d6e 2066 6f72 2065 6163    column for eac
+00052ac0: 6820 2270 6865 6e6f 7479 7065 222e 0a20  h "phenotype".. 
+00052ad0: 2020 2020 2020 203a 7061 7261 6d20 6c69         :param li
+00052ae0: 7374 2077 696e 646f 7773 3a20 416e 2069  st windows: An i
+00052af0: 6e63 7265 6173 696e 6720 6c69 7374 206f  ncreasing list o
+00052b00: 6620 6272 6561 6b70 6f69 6e74 7320 6265  f breakpoints be
+00052b10: 7477 6565 6e20 7468 6520 7769 6e64 6f77  tween the window
+00052b20: 730a 2020 2020 2020 2020 2020 2020 746f  s.            to
+00052b30: 2063 6f6d 7075 7465 2074 6865 2073 7461   compute the sta
+00052b40: 7469 7374 6963 2069 6e2e 0a20 2020 2020  tistic in..     
+00052b50: 2020 203a 7061 7261 6d20 7374 7220 6d6f     :param str mo
+00052b60: 6465 3a20 4120 7374 7269 6e67 2067 6976  de: A string giv
+00052b70: 696e 6720 7468 6520 2274 7970 6522 206f  ing the "type" o
+00052b80: 6620 7468 6520 7374 6174 6973 7469 6320  f the statistic 
+00052b90: 746f 2062 6520 636f 6d70 7574 6564 0a20  to be computed. 
+00052ba0: 2020 2020 2020 2020 2020 2028 6465 6661             (defa
+00052bb0: 756c 7473 2074 6f20 2273 6974 6522 292e  ults to "site").
+00052bc0: 0a20 2020 2020 2020 203a 7061 7261 6d20  .        :param 
+00052bd0: 626f 6f6c 2073 7061 6e5f 6e6f 726d 616c  bool span_normal
+00052be0: 6973 653a 2057 6865 7468 6572 2074 6f20  ise: Whether to 
+00052bf0: 6469 7669 6465 2074 6865 2072 6573 756c  divide the resul
+00052c00: 7420 6279 2074 6865 2073 7061 6e20 6f66  t by the span of
+00052c10: 2074 6865 0a20 2020 2020 2020 2020 2020   the.           
+00052c20: 2077 696e 646f 7720 2864 6566 6175 6c74   window (default
+00052c30: 7320 746f 2054 7275 6529 2e0a 2020 2020  s to True)..    
+00052c40: 2020 2020 3a72 6574 7572 6e3a 2041 206e      :return: A n
+00052c50: 6461 7272 6179 2077 6974 6820 7368 6170  darray with shap
+00052c60: 6520 6571 7561 6c20 746f 2028 6e75 6d20  e equal to (num 
+00052c70: 7769 6e64 6f77 732c 206e 756d 2073 7461  windows, num sta
+00052c80: 7469 7374 6963 7329 2e0a 2020 2020 2020  tistics)..      
+00052c90: 2020 2020 2020 4966 2077 696e 646f 7773        If windows
+00052ca0: 3d4e 6f6e 6520 616e 6420 5720 6973 2061  =None and W is a
+00052cb0: 2073 696e 676c 6520 636f 6c75 6d6e 2c20   single column, 
+00052cc0: 6120 6e75 6d70 7920 7363 616c 6172 2069  a numpy scalar i
+00052cd0: 7320 7265 7475 726e 6564 2e0a 2020 2020  s returned..    
+00052ce0: 2020 2020 2222 220a 2020 2020 2020 2020      """.        
+00052cf0: 6966 2057 2e73 6861 7065 5b30 5d20 213d  if W.shape[0] !=
+00052d00: 2073 656c 662e 6e75 6d5f 7361 6d70 6c65   self.num_sample
+00052d10: 733a 0a20 2020 2020 2020 2020 2020 2072  s:.            r
+00052d20: 6169 7365 2056 616c 7565 4572 726f 7228  aise ValueError(
+00052d30: 0a20 2020 2020 2020 2020 2020 2020 2020  .               
+00052d40: 2022 4669 7273 7420 7472 6169 7420 6469   "First trait di
+00052d50: 6d65 6e73 696f 6e20 6d75 7374 2062 6520  mension must be 
+00052d60: 6571 7561 6c20 746f 206e 756d 6265 7220  equal to number 
+00052d70: 6f66 2073 616d 706c 6573 2e22 0a20 2020  of samples.".   
+00052d80: 2020 2020 2020 2020 2029 0a20 2020 2020           ).     
+00052d90: 2020 2072 6574 7572 6e20 7365 6c66 2e5f     return self._
+00052da0: 5f72 756e 5f77 696e 646f 7765 645f 7374  _run_windowed_st
+00052db0: 6174 280a 2020 2020 2020 2020 2020 2020  at(.            
+00052dc0: 7769 6e64 6f77 732c 0a20 2020 2020 2020  windows,.       
+00052dd0: 2020 2020 2073 656c 662e 5f6c 6c5f 7472       self._ll_tr
+00052de0: 6565 5f73 6571 7565 6e63 652e 7472 6169  ee_sequence.trai
+00052df0: 745f 636f 7661 7269 616e 6365 2c0a 2020  t_covariance,.  
+00052e00: 2020 2020 2020 2020 2020 572c 0a20 2020            W,.   
+00052e10: 2020 2020 2020 2020 206d 6f64 653d 6d6f           mode=mo
+00052e20: 6465 2c0a 2020 2020 2020 2020 2020 2020  de,.            
+00052e30: 7370 616e 5f6e 6f72 6d61 6c69 7365 3d73  span_normalise=s
+00052e40: 7061 6e5f 6e6f 726d 616c 6973 652c 0a20  pan_normalise,. 
+00052e50: 2020 2020 2020 2029 0a0a 2020 2020 6465         )..    de
+00052e60: 6620 7472 6169 745f 636f 7272 656c 6174  f trait_correlat
+00052e70: 696f 6e28 7365 6c66 2c20 572c 2077 696e  ion(self, W, win
+00052e80: 646f 7773 3d4e 6f6e 652c 206d 6f64 653d  dows=None, mode=
+00052e90: 2273 6974 6522 2c20 7370 616e 5f6e 6f72  "site", span_nor
+00052ea0: 6d61 6c69 7365 3d54 7275 6529 3a0a 2020  malise=True):.  
+00052eb0: 2020 2020 2020 2222 220a 2020 2020 2020        """.      
+00052ec0: 2020 436f 6d70 7574 6573 2074 6865 206d    Computes the m
+00052ed0: 6561 6e20 7371 7561 7265 6420 636f 7272  ean squared corr
+00052ee0: 656c 6174 696f 6e73 2062 6574 7765 656e  elations between
+00052ef0: 2065 6163 6820 6f66 2074 6865 2063 6f6c   each of the col
+00052f00: 756d 6e73 206f 6620 6060 5760 600a 2020  umns of ``W``.  
+00052f10: 2020 2020 2020 2874 6865 2022 7068 656e        (the "phen
+00052f20: 6f74 7970 6573 2229 2061 6e64 2069 6e68  otypes") and inh
+00052f30: 6572 6974 616e 6365 2061 6c6f 6e67 2074  eritance along t
+00052f40: 6865 2074 7265 6520 7365 7175 656e 6365  he tree sequence
+00052f50: 2e0a 2020 2020 2020 2020 5365 6520 7468  ..        See th
+00052f60: 6520 3a72 6566 3a60 7374 6174 6973 7469  e :ref:`statisti
+00052f70: 6373 2069 6e74 6572 6661 6365 203c 7365  cs interface <se
+00052f80: 635f 7374 6174 735f 696e 7465 7266 6163  c_stats_interfac
+00052f90: 653e 6020 7365 6374 696f 6e20 666f 7220  e>` section for 
+00052fa0: 6465 7461 696c 7320 6f6e 0a20 2020 2020  details on.     
+00052fb0: 2020 203a 7265 663a 6077 696e 646f 7773     :ref:`windows
+00052fc0: 203c 7365 635f 7374 6174 735f 7769 6e64   <sec_stats_wind
+00052fd0: 6f77 733e 602c 0a20 2020 2020 2020 203a  ows>`,.        :
+00052fe0: 7265 663a 606d 6f64 6520 3c73 6563 5f73  ref:`mode <sec_s
+00052ff0: 7461 7473 5f6d 6f64 653e 602c 0a20 2020  tats_mode>`,.   
+00053000: 2020 2020 203a 7265 663a 6073 7061 6e20       :ref:`span 
+00053010: 6e6f 726d 616c 6973 6520 3c73 6563 5f73  normalise <sec_s
+00053020: 7461 7473 5f73 7061 6e5f 6e6f 726d 616c  tats_span_normal
+00053030: 6973 653e 602c 0a20 2020 2020 2020 2061  ise>`,.        a
+00053040: 6e64 203a 7265 663a 6072 6574 7572 6e20  nd :ref:`return 
+00053050: 7661 6c75 6520 3c73 6563 5f73 7461 7473  value <sec_stats
+00053060: 5f6f 7574 7075 745f 666f 726d 6174 3e60  _output_format>`
+00053070: 2e0a 2020 2020 2020 2020 4f70 6572 6174  ..        Operat
+00053080: 6573 206f 6e20 616c 6c20 7361 6d70 6c65  es on all sample
+00053090: 7320 696e 2074 6865 2074 7265 6520 7365  s in the tree se
+000530a0: 7175 656e 6365 2e0a 0a20 2020 2020 2020  quence...       
+000530b0: 2054 6869 7320 6973 2063 6f6d 7075 7465   This is compute
+000530c0: 6420 6173 2073 7175 6172 6564 2063 6f76  d as squared cov
+000530d0: 6172 6961 6e63 6520 696e 0a20 2020 2020  ariance in.     
+000530e0: 2020 203a 6d65 7468 3a60 7472 6169 745f     :meth:`trait_
+000530f0: 636f 7661 7269 616e 6365 203c 2e54 7265  covariance <.Tre
+00053100: 6553 6571 7565 6e63 652e 7472 6169 745f  eSequence.trait_
+00053110: 636f 7661 7269 616e 6365 3e60 2c0a 2020  covariance>`,.  
+00053120: 2020 2020 2020 6275 7420 6469 7669 6465        but divide
+00053130: 6420 6279 203a 6d61 7468 3a60 7020 2831  d by :math:`p (1
+00053140: 2d70 2960 2c20 7768 6572 6520 6070 6020  -p)`, where `p` 
+00053150: 6973 2074 6865 2070 726f 706f 7274 696f  is the proportio
+00053160: 6e20 6f66 2073 616d 706c 6573 0a20 2020  n of samples.   
+00053170: 2020 2020 2069 6e68 6572 6974 696e 6720       inheriting 
+00053180: 6672 6f6d 2074 6865 2061 6c6c 656c 652c  from the allele,
+00053190: 2062 7261 6e63 682c 206f 7220 6e6f 6465   branch, or node
+000531a0: 2069 6e20 7175 6573 7469 6f6e 2e0a 0a20   in question... 
+000531b0: 2020 2020 2020 2057 6861 7420 6973 2063         What is c
+000531c0: 6f6d 7075 7465 6420 6465 7065 6e64 7320  omputed depends 
+000531d0: 6f6e 2060 606d 6f64 6560 603a 0a0a 2020  on ``mode``:..  
+000531e0: 2020 2020 2020 2273 6974 6522 0a20 2020        "site".   
+000531f0: 2020 2020 2020 2020 2054 6865 2073 756d           The sum
+00053200: 206f 6620 7371 7561 7265 6420 636f 7272   of squared corr
+00053210: 656c 6174 696f 6e73 2062 6574 7765 656e  elations between
+00053220: 2070 7265 7365 6e63 652f 6162 7365 6e63   presence/absenc
+00053230: 6520 6f66 2065 6163 6820 616c 6c65 6c65  e of each allele
+00053240: 2061 6e64 0a20 2020 2020 2020 2020 2020   and.           
+00053250: 2070 6865 6e6f 7479 7065 732c 2064 6976   phenotypes, div
+00053260: 6964 6564 2062 7920 6c65 6e67 7468 206f  ided by length o
+00053270: 6620 7468 6520 7769 6e64 6f77 2028 6966  f the window (if
+00053280: 2060 6073 7061 6e5f 6e6f 726d 616c 6973   ``span_normalis
+00053290: 653d 5472 7565 6060 292e 0a20 2020 2020  e=True``)..     
+000532a0: 2020 2020 2020 2054 6869 7320 6973 2063         This is c
+000532b0: 6f6d 7075 7465 6420 6173 2074 6865 0a20  omputed as the. 
+000532c0: 2020 2020 2020 2020 2020 203a 6d65 7468             :meth
+000532d0: 3a60 7472 6169 745f 636f 7661 7269 616e  :`trait_covarian
+000532e0: 6365 203c 2e54 7265 6553 6571 7565 6e63  ce <.TreeSequenc
+000532f0: 652e 7472 6169 745f 636f 7661 7269 616e  e.trait_covarian
+00053300: 6365 3e60 0a20 2020 2020 2020 2020 2020  ce>`.           
+00053310: 2064 6976 6964 6564 2062 7920 7468 6520   divided by the 
+00053320: 7661 7269 616e 6365 206f 6620 7468 6520  variance of the 
+00053330: 7265 6c65 7661 6e74 2063 6f6c 756d 6e20  relevant column 
+00053340: 6f66 2057 0a20 2020 2020 2020 2020 2020  of W.           
+00053350: 2061 6e64 2062 7920 3a6d 6174 683a 6070   and by :math:`p
+00053360: 202a 2028 3120 2d20 7029 602c 2077 6865   * (1 - p)`, whe
+00053370: 7265 203a 6d61 7468 3a60 7060 2069 7320  re :math:`p` is 
+00053380: 7468 6520 616c 6c65 6c65 2066 7265 7175  the allele frequ
+00053390: 656e 6379 2e0a 0a20 2020 2020 2020 2022  ency...        "
+000533a0: 6272 616e 6368 220a 2020 2020 2020 2020  branch".        
+000533b0: 2020 2020 5468 6520 7375 6d20 6f66 2073      The sum of s
+000533c0: 7175 6172 6564 2063 6f72 7265 6c61 7469  quared correlati
+000533d0: 6f6e 7320 6265 7477 6565 6e20 7468 6520  ons between the 
+000533e0: 7370 6c69 7420 696e 6475 6365 6420 6279  split induced by
+000533f0: 2065 6163 6820 6272 616e 6368 2061 6e64   each branch and
+00053400: 0a20 2020 2020 2020 2020 2020 2070 6865  .            phe
+00053410: 6e6f 7479 7065 732c 206d 756c 7469 706c  notypes, multipl
+00053420: 6965 6420 6279 2062 7261 6e63 6820 6c65  ied by branch le
+00053430: 6e67 7468 2c20 6176 6572 6167 6564 2061  ngth, averaged a
+00053440: 6372 6f73 7320 7472 6565 7320 696e 0a20  cross trees in. 
+00053450: 2020 2020 2020 2020 2020 2074 6865 2077             the w
+00053460: 696e 646f 772e 2054 6869 7320 6973 2063  indow. This is c
+00053470: 6f6d 7075 7465 6420 6173 2074 6865 0a20  omputed as the. 
+00053480: 2020 2020 2020 2020 2020 203a 6d65 7468             :meth
+00053490: 3a60 7472 6169 745f 636f 7661 7269 616e  :`trait_covarian
+000534a0: 6365 203c 2e54 7265 6553 6571 7565 6e63  ce <.TreeSequenc
+000534b0: 652e 7472 6169 745f 636f 7661 7269 616e  e.trait_covarian
+000534c0: 6365 3e60 2c0a 2020 2020 2020 2020 2020  ce>`,.          
+000534d0: 2020 6469 7669 6465 6420 6279 2074 6865    divided by the
+000534e0: 2076 6172 6961 6e63 6520 6f66 2074 6865   variance of the
+000534f0: 2063 6f6c 756d 6e20 6f66 2077 0a20 2020   column of w.   
+00053500: 2020 2020 2020 2020 2061 6e64 2062 7920           and by 
+00053510: 3a6d 6174 683a 6070 202a 2028 3120 2d20  :math:`p * (1 - 
+00053520: 7029 602c 2077 6865 7265 203a 6d61 7468  p)`, where :math
+00053530: 3a60 7060 2069 7320 7468 6520 7072 6f70  :`p` is the prop
+00053540: 6f72 7469 6f6e 206f 660a 2020 2020 2020  ortion of.      
+00053550: 2020 2020 2020 7468 6520 7361 6d70 6c65        the sample
+00053560: 7320 6c79 696e 6720 6265 6c6f 7720 7468  s lying below th
+00053570: 6520 6272 616e 6368 2e0a 0a20 2020 2020  e branch...     
+00053580: 2020 2022 6e6f 6465 220a 2020 2020 2020     "node".      
+00053590: 2020 2020 2020 466f 7220 6561 6368 206e        For each n
+000535a0: 6f64 652c 2074 6865 2073 7175 6172 6564  ode, the squared
+000535b0: 2063 6f72 7265 6c61 7469 6f6e 2062 6574   correlation bet
+000535c0: 7765 656e 2074 6865 2070 726f 7065 7274  ween the propert
+000535d0: 7920 6f66 0a20 2020 2020 2020 2020 2020  y of.           
+000535e0: 2069 6e68 6572 6974 696e 6720 6672 6f6d   inheriting from
+000535f0: 2074 6869 7320 6e6f 6465 2061 6e64 2070   this node and p
+00053600: 6865 6e6f 7479 7065 732c 2063 6f6d 7075  henotypes, compu
+00053610: 7465 6420 6173 2069 6e20 2262 7261 6e63  ted as in "branc
+00053620: 6822 2e0a 0a20 2020 2020 2020 204e 6f74  h"...        Not
+00053630: 6520 7468 6174 2061 626f 7665 2077 6520  e that above we 
+00053640: 6469 7669 6465 2062 7920 7468 6520 2a2a  divide by the **
+00053650: 7361 6d70 6c65 2a2a 2076 6172 6961 6e63  sample** varianc
+00053660: 652c 2077 6869 6368 2066 6f72 2061 0a20  e, which for a. 
+00053670: 2020 2020 2020 2076 6563 746f 7220 7820         vector x 
+00053680: 6f66 206c 656e 6774 6820 6e20 6973 2060  of length n is `
+00053690: 606e 702e 7661 7228 7829 202a 206e 202f  `np.var(x) * n /
+000536a0: 2028 6e2d 3129 6060 2e0a 0a20 2020 2020   (n-1)``...     
+000536b0: 2020 203a 7061 7261 6d20 6e75 6d70 792e     :param numpy.
+000536c0: 6e64 6172 7261 7920 573a 2041 6e20 6172  ndarray W: An ar
+000536d0: 7261 7920 6f66 2076 616c 7565 7320 7769  ray of values wi
+000536e0: 7468 206f 6e65 2072 6f77 2066 6f72 2065  th one row for e
+000536f0: 6163 6820 7361 6d70 6c65 2061 6e64 206f  ach sample and o
+00053700: 6e65 0a20 2020 2020 2020 2020 2020 2063  ne.            c
+00053710: 6f6c 756d 6e20 666f 7220 6561 6368 2022  olumn for each "
+00053720: 7068 656e 6f74 7970 6522 2e20 4561 6368  phenotype". Each
+00053730: 2063 6f6c 756d 6e20 6d75 7374 2068 6176   column must hav
+00053740: 6520 706f 7369 7469 7665 2073 7461 6e64  e positive stand
+00053750: 6172 640a 2020 2020 2020 2020 2020 2020  ard.            
+00053760: 6465 7669 6174 696f 6e2e 0a20 2020 2020  deviation..     
+00053770: 2020 203a 7061 7261 6d20 6c69 7374 2077     :param list w
+00053780: 696e 646f 7773 3a20 416e 2069 6e63 7265  indows: An incre
+00053790: 6173 696e 6720 6c69 7374 206f 6620 6272  asing list of br
+000537a0: 6561 6b70 6f69 6e74 7320 6265 7477 6565  eakpoints betwee
+000537b0: 6e20 7468 6520 7769 6e64 6f77 730a 2020  n the windows.  
+000537c0: 2020 2020 2020 2020 2020 746f 2063 6f6d            to com
+000537d0: 7075 7465 2074 6865 2073 7461 7469 7374  pute the statist
+000537e0: 6963 2069 6e2e 0a20 2020 2020 2020 203a  ic in..        :
+000537f0: 7061 7261 6d20 7374 7220 6d6f 6465 3a20  param str mode: 
+00053800: 4120 7374 7269 6e67 2067 6976 696e 6720  A string giving 
+00053810: 7468 6520 2274 7970 6522 206f 6620 7468  the "type" of th
+00053820: 6520 7374 6174 6973 7469 6320 746f 2062  e statistic to b
+00053830: 6520 636f 6d70 7574 6564 0a20 2020 2020  e computed.     
+00053840: 2020 2020 2020 2028 6465 6661 756c 7473         (defaults
+00053850: 2074 6f20 2273 6974 6522 292e 0a20 2020   to "site")..   
+00053860: 2020 2020 203a 7061 7261 6d20 626f 6f6c       :param bool
+00053870: 2073 7061 6e5f 6e6f 726d 616c 6973 653a   span_normalise:
+00053880: 2057 6865 7468 6572 2074 6f20 6469 7669   Whether to divi
+00053890: 6465 2074 6865 2072 6573 756c 7420 6279  de the result by
+000538a0: 2074 6865 2073 7061 6e20 6f66 2074 6865   the span of the
+000538b0: 0a20 2020 2020 2020 2020 2020 2077 696e  .            win
+000538c0: 646f 7720 2864 6566 6175 6c74 7320 746f  dow (defaults to
+000538d0: 2054 7275 6529 2e0a 2020 2020 2020 2020   True)..        
+000538e0: 3a72 6574 7572 6e3a 2041 206e 6461 7272  :return: A ndarr
+000538f0: 6179 2077 6974 6820 7368 6170 6520 6571  ay with shape eq
+00053900: 7561 6c20 746f 2028 6e75 6d20 7769 6e64  ual to (num wind
+00053910: 6f77 732c 206e 756d 2073 7461 7469 7374  ows, num statist
+00053920: 6963 7329 2e0a 2020 2020 2020 2020 2020  ics)..          
+00053930: 2020 4966 2077 696e 646f 7773 3d4e 6f6e    If windows=Non
+00053940: 6520 616e 6420 5720 6973 2061 2073 696e  e and W is a sin
+00053950: 676c 6520 636f 6c75 6d6e 2c20 6120 6e75  gle column, a nu
+00053960: 6d70 7920 7363 616c 6172 2069 7320 7265  mpy scalar is re
+00053970: 7475 726e 6564 2e0a 2020 2020 2020 2020  turned..        
+00053980: 2222 220a 2020 2020 2020 2020 6966 2057  """.        if W
+00053990: 2e73 6861 7065 5b30 5d20 213d 2073 656c  .shape[0] != sel
+000539a0: 662e 6e75 6d5f 7361 6d70 6c65 733a 0a20  f.num_samples:. 
+000539b0: 2020 2020 2020 2020 2020 2072 6169 7365             raise
+000539c0: 2056 616c 7565 4572 726f 7228 0a20 2020   ValueError(.   
+000539d0: 2020 2020 2020 2020 2020 2020 2022 4669               "Fi
+000539e0: 7273 7420 7472 6169 7420 6469 6d65 6e73  rst trait dimens
+000539f0: 696f 6e20 6d75 7374 2062 6520 6571 7561  ion must be equa
+00053a00: 6c20 746f 206e 756d 6265 7220 6f66 2073  l to number of s
+00053a10: 616d 706c 6573 2e22 0a20 2020 2020 2020  amples.".       
+00053a20: 2020 2020 2029 0a20 2020 2020 2020 2073       ).        s
+00053a30: 6473 203d 206e 702e 7374 6428 572c 2061  ds = np.std(W, a
+00053a40: 7869 733d 3029 0a20 2020 2020 2020 2069  xis=0).        i
+00053a50: 6620 6e70 2e61 6e79 2873 6473 203d 3d20  f np.any(sds == 
+00053a60: 3029 3a0a 2020 2020 2020 2020 2020 2020  0):.            
+00053a70: 7261 6973 6520 5661 6c75 6545 7272 6f72  raise ValueError
+00053a80: 280a 2020 2020 2020 2020 2020 2020 2020  (.              
+00053a90: 2020 2257 6569 6768 7420 636f 6c75 6d6e    "Weight column
+00053aa0: 7320 6d75 7374 2068 6176 6520 706f 7369  s must have posi
+00053ab0: 7469 7665 2076 6172 6961 6e63 6522 2c20  tive variance", 
+00053ac0: 2274 6f20 636f 6d70 7574 6520 636f 7272  "to compute corr
+00053ad0: 656c 6174 696f 6e2e 220a 2020 2020 2020  elation.".      
+00053ae0: 2020 2020 2020 290a 2020 2020 2020 2020        ).        
+00053af0: 7265 7475 726e 2073 656c 662e 5f5f 7275  return self.__ru
+00053b00: 6e5f 7769 6e64 6f77 6564 5f73 7461 7428  n_windowed_stat(
+00053b10: 0a20 2020 2020 2020 2020 2020 2077 696e  .            win
+00053b20: 646f 7773 2c0a 2020 2020 2020 2020 2020  dows,.          
+00053b30: 2020 7365 6c66 2e5f 6c6c 5f74 7265 655f    self._ll_tree_
+00053b40: 7365 7175 656e 6365 2e74 7261 6974 5f63  sequence.trait_c
+00053b50: 6f72 7265 6c61 7469 6f6e 2c0a 2020 2020  orrelation,.    
+00053b60: 2020 2020 2020 2020 572c 0a20 2020 2020          W,.     
+00053b70: 2020 2020 2020 206d 6f64 653d 6d6f 6465         mode=mode
+00053b80: 2c0a 2020 2020 2020 2020 2020 2020 7370  ,.            sp
+00053b90: 616e 5f6e 6f72 6d61 6c69 7365 3d73 7061  an_normalise=spa
+00053ba0: 6e5f 6e6f 726d 616c 6973 652c 0a20 2020  n_normalise,.   
+00053bb0: 2020 2020 2029 0a0a 2020 2020 6465 6620       )..    def 
+00053bc0: 7472 6169 745f 7265 6772 6573 7369 6f6e  trait_regression
+00053bd0: 2873 656c 662c 202a 6172 6773 2c20 2a2a  (self, *args, **
+00053be0: 6b77 6172 6773 293a 0a20 2020 2020 2020  kwargs):.       
+00053bf0: 2022 2222 0a20 2020 2020 2020 2044 6570   """.        Dep
+00053c00: 7265 6361 7465 6420 7379 6e6f 6e79 6d20  recated synonym 
+00053c10: 666f 720a 2020 2020 2020 2020 3a6d 6574  for.        :met
+00053c20: 683a 6074 7261 6974 5f6c 696e 6561 725f  h:`trait_linear_
+00053c30: 6d6f 6465 6c20 3c2e 5472 6565 5365 7175  model <.TreeSequ
+00053c40: 656e 6365 2e74 7261 6974 5f6c 696e 6561  ence.trait_linea
+00053c50: 725f 6d6f 6465 6c3e 602e 0a20 2020 2020  r_model>`..     
+00053c60: 2020 2022 2222 0a20 2020 2020 2020 2077     """.        w
+00053c70: 6172 6e69 6e67 732e 7761 726e 280a 2020  arnings.warn(.  
+00053c80: 2020 2020 2020 2020 2020 2254 6869 7320            "This 
+00053c90: 6973 2064 6570 7265 6361 7465 643a 2070  is deprecated: p
+00053ca0: 6c65 6173 6520 7573 6520 7472 6169 745f  lease use trait_
+00053cb0: 6c69 6e65 6172 5f6d 6f64 656c 2820 2920  linear_model( ) 
+00053cc0: 696e 7374 6561 642e 222c 0a20 2020 2020  instead.",.     
+00053cd0: 2020 2020 2020 2046 7574 7572 6557 6172         FutureWar
+00053ce0: 6e69 6e67 2c0a 2020 2020 2020 2020 290a  ning,.        ).
+00053cf0: 2020 2020 2020 2020 7265 7475 726e 2073          return s
+00053d00: 656c 662e 7472 6169 745f 6c69 6e65 6172  elf.trait_linear
+00053d10: 5f6d 6f64 656c 282a 6172 6773 2c20 2a2a  _model(*args, **
+00053d20: 6b77 6172 6773 290a 0a20 2020 2064 6566  kwargs)..    def
+00053d30: 2074 7261 6974 5f6c 696e 6561 725f 6d6f   trait_linear_mo
+00053d40: 6465 6c28 0a20 2020 2020 2020 2073 656c  del(.        sel
+00053d50: 662c 2057 2c20 5a3d 4e6f 6e65 2c20 7769  f, W, Z=None, wi
+00053d60: 6e64 6f77 733d 4e6f 6e65 2c20 6d6f 6465  ndows=None, mode
+00053d70: 3d22 7369 7465 222c 2073 7061 6e5f 6e6f  ="site", span_no
+00053d80: 726d 616c 6973 653d 5472 7565 0a20 2020  rmalise=True.   
+00053d90: 2029 3a0a 2020 2020 2020 2020 2222 220a   ):.        """.
+00053da0: 2020 2020 2020 2020 4669 6e64 7320 7468          Finds th
+00053db0: 6520 7265 6c61 7469 6f6e 7368 6970 2062  e relationship b
+00053dc0: 6574 7765 656e 2074 7261 6974 2061 6e64  etween trait and
+00053dd0: 2067 656e 6f74 7970 6520 6166 7465 7220   genotype after 
+00053de0: 6163 636f 756e 7469 6e67 2066 6f72 0a20  accounting for. 
+00053df0: 2020 2020 2020 2063 6f76 6172 6961 7465         covariate
+00053e00: 732e 2020 436f 6e63 7265 7465 6c79 2c20  s.  Concretely, 
+00053e10: 666f 7220 6561 6368 2074 7261 6974 2077  for each trait w
+00053e20: 2028 692e 652e 2c20 6561 6368 2063 6f6c   (i.e., each col
+00053e30: 756d 6e20 6f66 2057 292c 0a20 2020 2020  umn of W),.     
+00053e40: 2020 2074 6869 7320 646f 6573 2061 206c     this does a l
+00053e50: 6561 7374 2d73 7175 6172 6573 2066 6974  east-squares fit
+00053e60: 206f 6620 7468 6520 6c69 6e65 6172 206d   of the linear m
+00053e70: 6f64 656c 203a 6d61 7468 3a60 7720 5c5c  odel :math:`w \\
+00053e80: 7369 6d20 6720 2b20 5a60 2c0a 2020 2020  sim g + Z`,.    
+00053e90: 2020 2020 7768 6572 6520 3a6d 6174 683a      where :math:
+00053ea0: 6067 6020 6973 2069 6e68 6572 6974 616e  `g` is inheritan
+00053eb0: 6365 2069 6e20 7468 6520 7472 6565 2073  ce in the tree s
+00053ec0: 6571 7565 6e63 6520 2865 2e67 2e2c 2067  equence (e.g., g
+00053ed0: 656e 6f74 7970 6529 0a20 2020 2020 2020  enotype).       
+00053ee0: 2061 6e64 2074 6865 2063 6f6c 756d 6e73   and the columns
+00053ef0: 206f 6620 3a6d 6174 683a 605a 6020 6172   of :math:`Z` ar
+00053f00: 6520 636f 7661 7269 6174 6573 2c20 616e  e covariates, an
+00053f10: 6420 7265 7475 726e 7320 7468 6520 7371  d returns the sq
+00053f20: 7561 7265 640a 2020 2020 2020 2020 636f  uared.        co
+00053f30: 6566 6669 6369 656e 7420 6f66 203a 6d61  efficient of :ma
+00053f40: 7468 3a60 6760 2069 6e20 7468 6973 206c  th:`g` in this l
+00053f50: 696e 6561 7220 6d6f 6465 6c2e 0a20 2020  inear model..   
+00053f60: 2020 2020 2053 6565 2074 6865 203a 7265       See the :re
+00053f70: 663a 6073 7461 7469 7374 6963 7320 696e  f:`statistics in
+00053f80: 7465 7266 6163 6520 3c73 6563 5f73 7461  terface <sec_sta
+00053f90: 7473 5f69 6e74 6572 6661 6365 3e60 2073  ts_interface>` s
+00053fa0: 6563 7469 6f6e 2066 6f72 2064 6574 6169  ection for detai
+00053fb0: 6c73 206f 6e0a 2020 2020 2020 2020 3a72  ls on.        :r
+00053fc0: 6566 3a60 7769 6e64 6f77 7320 3c73 6563  ef:`windows <sec
+00053fd0: 5f73 7461 7473 5f77 696e 646f 7773 3e60  _stats_windows>`
+00053fe0: 2c0a 2020 2020 2020 2020 3a72 6566 3a60  ,.        :ref:`
+00053ff0: 6d6f 6465 203c 7365 635f 7374 6174 735f  mode <sec_stats_
+00054000: 6d6f 6465 3e60 2c0a 2020 2020 2020 2020  mode>`,.        
+00054010: 3a72 6566 3a60 7370 616e 206e 6f72 6d61  :ref:`span norma
+00054020: 6c69 7365 203c 7365 635f 7374 6174 735f  lise <sec_stats_
+00054030: 7370 616e 5f6e 6f72 6d61 6c69 7365 3e60  span_normalise>`
+00054040: 2c0a 2020 2020 2020 2020 616e 6420 3a72  ,.        and :r
+00054050: 6566 3a60 7265 7475 726e 2076 616c 7565  ef:`return value
+00054060: 203c 7365 635f 7374 6174 735f 6f75 7470   <sec_stats_outp
+00054070: 7574 5f66 6f72 6d61 743e 602e 0a20 2020  ut_format>`..   
+00054080: 2020 2020 204f 7065 7261 7465 7320 6f6e       Operates on
+00054090: 2061 6c6c 2073 616d 706c 6573 2069 6e20   all samples in 
+000540a0: 7468 6520 7472 6565 2073 6571 7565 6e63  the tree sequenc
+000540b0: 652e 0a0a 2020 2020 2020 2020 546f 2064  e...        To d
+000540c0: 6f20 7468 6973 2c20 6966 2060 6760 2069  o this, if `g` i
+000540d0: 7320 6120 6269 6e61 7279 2076 6563 746f  s a binary vecto
+000540e0: 7220 7468 6174 2069 6e64 6963 6174 6573  r that indicates
+000540f0: 2069 6e68 6572 6974 616e 6365 2066 726f   inheritance fro
+00054100: 6d20 616e 2061 6c6c 656c 652c 0a20 2020  m an allele,.   
+00054110: 2020 2020 2062 7261 6e63 682c 206f 7220       branch, or 
+00054120: 6e6f 6465 2061 6e64 2060 7760 2069 7320  node and `w` is 
+00054130: 6120 636f 6c75 6d6e 206f 6620 572c 2074  a column of W, t
+00054140: 6865 7265 2061 7265 203a 6d61 7468 3a60  here are :math:`
+00054150: 6b60 2063 6f6c 756d 6e73 206f 660a 2020  k` columns of.  
+00054160: 2020 2020 2020 3a6d 6174 683a 605a 602c        :math:`Z`,
+00054170: 2061 6e64 2074 6865 203a 6d61 7468 3a60   and the :math:`
+00054180: 6b2b 3260 2d76 6563 746f 7220 3a6d 6174  k+2`-vector :mat
+00054190: 683a 6062 6020 6d69 6e69 6d69 7365 730a  h:`b` minimises.
+000541a0: 2020 2020 2020 2020 3a6d 6174 683a 605c          :math:`\
+000541b0: 5c73 756d 5f69 2028 775f 6920 2d20 625f  \sum_i (w_i - b_
+000541c0: 3020 2d20 625f 3120 675f 6920 2d20 625f  0 - b_1 g_i - b_
+000541d0: 3220 7a5f 7b32 2c69 7d20 2d20 2e2e 2e20  2 z_{2,i} - ... 
+000541e0: 625f 7b6b 2b32 7d20 7a5f 7b6b 2b32 2c69  b_{k+2} z_{k+2,i
+000541f0: 7d29 5e32 600a 2020 2020 2020 2020 7468  })^2`.        th
+00054200: 656e 2074 6869 7320 7265 7475 726e 7320  en this returns 
+00054210: 7468 6520 6e75 6d62 6572 203a 6d61 7468  the number :math
+00054220: 3a60 625f 315e 3260 2e20 4966 203a 6d61  :`b_1^2`. If :ma
+00054230: 7468 3a60 6760 206c 6965 7320 696e 2074  th:`g` lies in t
+00054240: 6865 206c 696e 6561 7220 7370 616e 0a20  he linear span. 
+00054250: 2020 2020 2020 206f 6620 7468 6520 636f         of the co
+00054260: 6c75 6d6e 7320 6f66 203a 6d61 7468 3a60  lumns of :math:`
+00054270: 5a60 2c20 7468 656e 203a 6d61 7468 3a60  Z`, then :math:`
+00054280: 625f 3160 2069 7320 7365 7420 746f 2030  b_1` is set to 0
+00054290: 2e20 546f 2066 6974 2074 6865 0a20 2020  . To fit the.   
+000542a0: 2020 2020 206c 696e 6561 7220 6d6f 6465       linear mode
+000542b0: 6c20 7769 7468 6f75 7420 636f 7661 7269  l without covari
+000542c0: 6174 6573 2028 6f6e 6c79 2074 6865 2069  ates (only the i
+000542d0: 6e74 6572 6365 7074 292c 2073 6574 2060  ntercept), set `
+000542e0: 5a20 3d20 4e6f 6e65 602e 0a0a 2020 2020  Z = None`...    
+000542f0: 2020 2020 5768 6174 2069 7320 636f 6d70      What is comp
+00054300: 7574 6564 2064 6570 656e 6473 206f 6e20  uted depends on 
+00054310: 6060 6d6f 6465 6060 3a0a 0a20 2020 2020  ``mode``:..     
+00054320: 2020 2022 7369 7465 220a 2020 2020 2020     "site".      
+00054330: 2020 2020 2020 436f 6d70 7574 6573 2074        Computes t
+00054340: 6865 2073 756d 206f 6620 3a6d 6174 683a  he sum of :math:
+00054350: 6062 5f31 5e32 2f32 6020 666f 7220 6561  `b_1^2/2` for ea
+00054360: 6368 2061 6c6c 656c 6520 696e 2074 6865  ch allele in the
+00054370: 2077 696e 646f 772c 0a20 2020 2020 2020   window,.       
+00054380: 2020 2020 2061 7320 6162 6f76 6520 7769       as above wi
+00054390: 7468 203a 6d61 7468 3a60 6760 2069 6e64  th :math:`g` ind
+000543a0: 6963 6174 696e 6720 7072 6573 656e 6365  icating presence
+000543b0: 2f61 6273 656e 6365 206f 6620 7468 6520  /absence of the 
+000543c0: 616c 6c65 6c65 2c0a 2020 2020 2020 2020  allele,.        
+000543d0: 2020 2020 7468 656e 2064 6976 6964 6564      then divided
+000543e0: 2062 7920 7468 6520 6c65 6e67 7468 206f   by the length o
+000543f0: 6620 7468 6520 7769 6e64 6f77 2069 6620  f the window if 
+00054400: 6060 7370 616e 5f6e 6f72 6d61 6c69 7365  ``span_normalise
+00054410: 3d54 7275 6560 602e 0a20 2020 2020 2020  =True``..       
+00054420: 2020 2020 2028 466f 7220 6269 616c 6c65       (For bialle
+00054430: 6c69 6320 6c6f 6369 2c20 7468 6973 206e  lic loci, this n
+00054440: 756d 6265 7220 6973 2074 6865 2073 616d  umber is the sam
+00054450: 6520 666f 7220 626f 7468 2061 6c6c 656c  e for both allel
+00054460: 6573 2c20 616e 6420 736f 2073 756d 6d69  es, and so summi
+00054470: 6e67 0a20 2020 2020 2020 2020 2020 206f  ng.            o
+00054480: 7665 7220 6561 6368 2063 616e 6365 6c73  ver each cancels
+00054490: 2074 6865 2066 6163 746f 7220 6f66 2074   the factor of t
+000544a0: 776f 2e29 0a0a 2020 2020 2020 2020 2262  wo.)..        "b
+000544b0: 7261 6e63 6822 0a20 2020 2020 2020 2020  ranch".         
+000544c0: 2020 2054 6865 2073 7175 6172 6564 2063     The squared c
+000544d0: 6f65 6666 6963 6965 6e74 203a 6d61 7468  oefficient :math
+000544e0: 3a60 625f 315e 3260 2c20 636f 6d70 7574  :`b_1^2`, comput
+000544f0: 6564 2066 6f72 2074 6865 2073 706c 6974  ed for the split
+00054500: 2069 6e64 7563 6564 2062 7920 6561 6368   induced by each
+00054510: 0a20 2020 2020 2020 2020 2020 2062 7261  .            bra
+00054520: 6e63 6820 2869 2e65 2e2c 2077 6974 6820  nch (i.e., with 
+00054530: 3a6d 6174 683a 6067 6020 696e 6469 6361  :math:`g` indica
+00054540: 7469 6e67 2069 6e68 6572 6974 616e 6365  ting inheritance
+00054550: 2066 726f 6d20 7468 6174 2062 7261 6e63   from that branc
+00054560: 6829 2c0a 2020 2020 2020 2020 2020 2020  h),.            
+00054570: 6d75 6c74 6970 6c69 6564 2062 7920 6272  multiplied by br
+00054580: 616e 6368 206c 656e 6774 6820 616e 6420  anch length and 
+00054590: 7472 6565 2073 7061 6e2c 2073 756d 6d65  tree span, summe
+000545a0: 6420 6f76 6572 2061 6c6c 2074 7265 6573  d over all trees
+000545b0: 0a20 2020 2020 2020 2020 2020 2069 6e20  .            in 
+000545c0: 7468 6520 7769 6e64 6f77 2c20 616e 6420  the window, and 
+000545d0: 6469 7669 6465 6420 6279 2074 6865 206c  divided by the l
+000545e0: 656e 6774 6820 6f66 2074 6865 2077 696e  ength of the win
+000545f0: 646f 7720 6966 0a20 2020 2020 2020 2020  dow if.         
+00054600: 2020 2060 6073 7061 6e5f 6e6f 726d 616c     ``span_normal
+00054610: 6973 653d 5472 7565 6060 2e0a 0a20 2020  ise=True``...   
+00054620: 2020 2020 2022 6e6f 6465 220a 2020 2020       "node".    
+00054630: 2020 2020 2020 2020 466f 7220 6561 6368          For each
+00054640: 206e 6f64 652c 2074 6865 2073 7175 6172   node, the squar
+00054650: 6564 2063 6f65 6666 6963 6965 6e74 203a  ed coefficient :
+00054660: 6d61 7468 3a60 625f 315e 3260 2c20 636f  math:`b_1^2`, co
+00054670: 6d70 7574 6564 2066 6f72 0a20 2020 2020  mputed for.     
+00054680: 2020 2020 2020 2074 6865 2070 726f 7065         the prope
+00054690: 7274 7920 6f66 2069 6e68 6572 6974 696e  rty of inheritin
+000546a0: 6720 6672 6f6d 2074 6869 7320 6e6f 6465  g from this node
+000546b0: 2c20 6173 2069 6e20 2262 7261 6e63 6822  , as in "branch"
+000546c0: 2e0a 0a20 2020 2020 2020 203a 7061 7261  ...        :para
+000546d0: 6d20 6e75 6d70 792e 6e64 6172 7261 7920  m numpy.ndarray 
+000546e0: 573a 2041 6e20 6172 7261 7920 6f66 2076  W: An array of v
+000546f0: 616c 7565 7320 7769 7468 206f 6e65 2072  alues with one r
+00054700: 6f77 2066 6f72 2065 6163 6820 7361 6d70  ow for each samp
+00054710: 6c65 2061 6e64 206f 6e65 0a20 2020 2020  le and one.     
+00054720: 2020 2020 2020 2063 6f6c 756d 6e20 666f         column fo
+00054730: 7220 6561 6368 2022 7068 656e 6f74 7970  r each "phenotyp
+00054740: 6522 2e0a 2020 2020 2020 2020 3a70 6172  e"..        :par
+00054750: 616d 206e 756d 7079 2e6e 6461 7272 6179  am numpy.ndarray
+00054760: 205a 3a20 416e 2061 7272 6179 206f 6620   Z: An array of 
+00054770: 7661 6c75 6573 2077 6974 6820 6f6e 6520  values with one 
+00054780: 726f 7720 666f 7220 6561 6368 2073 616d  row for each sam
+00054790: 706c 6520 616e 6420 6f6e 650a 2020 2020  ple and one.    
+000547a0: 2020 2020 2020 2020 636f 6c75 6d6e 2066          column f
+000547b0: 6f72 2065 6163 6820 2263 6f76 6172 6961  or each "covaria
+000547c0: 7465 222c 206f 7220 604e 6f6e 6560 2e20  te", or `None`. 
+000547d0: 436f 6c75 6d6e 7320 6f66 2060 5a60 206d  Columns of `Z` m
+000547e0: 7573 7420 6265 206c 696e 6561 726c 790a  ust be linearly.
+000547f0: 2020 2020 2020 2020 2020 2020 696e 6465              inde
+00054800: 7065 6e64 656e 742e 0a20 2020 2020 2020  pendent..       
+00054810: 203a 7061 7261 6d20 6c69 7374 2077 696e   :param list win
+00054820: 646f 7773 3a20 416e 2069 6e63 7265 6173  dows: An increas
+00054830: 696e 6720 6c69 7374 206f 6620 6272 6561  ing list of brea
+00054840: 6b70 6f69 6e74 7320 6265 7477 6565 6e20  kpoints between 
+00054850: 7468 6520 7769 6e64 6f77 730a 2020 2020  the windows.    
+00054860: 2020 2020 2020 2020 746f 2063 6f6d 7075          to compu
+00054870: 7465 2074 6865 2073 7461 7469 7374 6963  te the statistic
+00054880: 2069 6e2e 0a20 2020 2020 2020 203a 7061   in..        :pa
+00054890: 7261 6d20 7374 7220 6d6f 6465 3a20 4120  ram str mode: A 
+000548a0: 7374 7269 6e67 2067 6976 696e 6720 7468  string giving th
+000548b0: 6520 2274 7970 6522 206f 6620 7468 6520  e "type" of the 
+000548c0: 7374 6174 6973 7469 6320 746f 2062 6520  statistic to be 
+000548d0: 636f 6d70 7574 6564 0a20 2020 2020 2020  computed.       
+000548e0: 2020 2020 2028 6465 6661 756c 7473 2074       (defaults t
+000548f0: 6f20 2273 6974 6522 292e 0a20 2020 2020  o "site")..     
+00054900: 2020 203a 7061 7261 6d20 626f 6f6c 2073     :param bool s
+00054910: 7061 6e5f 6e6f 726d 616c 6973 653a 2057  pan_normalise: W
+00054920: 6865 7468 6572 2074 6f20 6469 7669 6465  hether to divide
+00054930: 2074 6865 2072 6573 756c 7420 6279 2074   the result by t
+00054940: 6865 2073 7061 6e20 6f66 2074 6865 0a20  he span of the. 
+00054950: 2020 2020 2020 2020 2020 2077 696e 646f             windo
+00054960: 7720 2864 6566 6175 6c74 7320 746f 2054  w (defaults to T
+00054970: 7275 6529 2e0a 2020 2020 2020 2020 3a72  rue)..        :r
+00054980: 6574 7572 6e3a 2041 206e 6461 7272 6179  eturn: A ndarray
+00054990: 2077 6974 6820 7368 6170 6520 6571 7561   with shape equa
+000549a0: 6c20 746f 2028 6e75 6d20 7769 6e64 6f77  l to (num window
+000549b0: 732c 206e 756d 2073 7461 7469 7374 6963  s, num statistic
+000549c0: 7329 2e0a 2020 2020 2020 2020 2020 2020  s)..            
+000549d0: 4966 2077 696e 646f 7773 3d4e 6f6e 6520  If windows=None 
+000549e0: 616e 6420 5720 6973 2061 2073 696e 676c  and W is a singl
+000549f0: 6520 636f 6c75 6d6e 2c20 6120 6e75 6d70  e column, a nump
+00054a00: 7920 7363 616c 6172 2069 7320 7265 7475  y scalar is retu
+00054a10: 726e 6564 2e0a 2020 2020 2020 2020 2222  rned..        ""
+00054a20: 220a 2020 2020 2020 2020 6966 2057 2e73  ".        if W.s
+00054a30: 6861 7065 5b30 5d20 213d 2073 656c 662e  hape[0] != self.
+00054a40: 6e75 6d5f 7361 6d70 6c65 733a 0a20 2020  num_samples:.   
+00054a50: 2020 2020 2020 2020 2072 6169 7365 2056           raise V
+00054a60: 616c 7565 4572 726f 7228 0a20 2020 2020  alueError(.     
+00054a70: 2020 2020 2020 2020 2020 2022 4669 7273             "Firs
+00054a80: 7420 7472 6169 7420 6469 6d65 6e73 696f  t trait dimensio
+00054a90: 6e20 6d75 7374 2062 6520 6571 7561 6c20  n must be equal 
+00054aa0: 746f 206e 756d 6265 7220 6f66 2073 616d  to number of sam
+00054ab0: 706c 6573 2e22 0a20 2020 2020 2020 2020  ples.".         
+00054ac0: 2020 2029 0a20 2020 2020 2020 2069 6620     ).        if 
+00054ad0: 5a20 6973 204e 6f6e 653a 0a20 2020 2020  Z is None:.     
+00054ae0: 2020 2020 2020 205a 203d 206e 702e 6f6e         Z = np.on
+00054af0: 6573 2828 7365 6c66 2e6e 756d 5f73 616d  es((self.num_sam
+00054b00: 706c 6573 2c20 3129 290a 2020 2020 2020  ples, 1)).      
+00054b10: 2020 656c 7365 3a0a 2020 2020 2020 2020    else:.        
+00054b20: 2020 2020 745a 203d 206e 702e 636f 6c75      tZ = np.colu
+00054b30: 6d6e 5f73 7461 636b 285b 5a2c 206e 702e  mn_stack([Z, np.
+00054b40: 6f6e 6573 2828 5a2e 7368 6170 655b 305d  ones((Z.shape[0]
+00054b50: 2c20 3129 295d 290a 2020 2020 2020 2020  , 1))]).        
+00054b60: 2020 2020 6966 206e 702e 6c69 6e61 6c67      if np.linalg
+00054b70: 2e6d 6174 7269 785f 7261 6e6b 2874 5a29  .matrix_rank(tZ)
+00054b80: 203d 3d20 745a 2e73 6861 7065 5b31 5d3a   == tZ.shape[1]:
+00054b90: 0a20 2020 2020 2020 2020 2020 2020 2020  .               
+00054ba0: 205a 203d 2074 5a0a 2020 2020 2020 2020   Z = tZ.        
+00054bb0: 6966 205a 2e73 6861 7065 5b30 5d20 213d  if Z.shape[0] !=
+00054bc0: 2073 656c 662e 6e75 6d5f 7361 6d70 6c65   self.num_sample
+00054bd0: 733a 0a20 2020 2020 2020 2020 2020 2072  s:.            r
+00054be0: 6169 7365 2056 616c 7565 4572 726f 7228  aise ValueError(
+00054bf0: 2246 6972 7374 2064 696d 656e 7369 6f6e  "First dimension
+00054c00: 206f 6620 5a20 6d75 7374 2065 7175 616c   of Z must equal
+00054c10: 2074 6865 206e 756d 6265 7220 6f66 2073   the number of s
+00054c20: 616d 706c 6573 2e22 290a 2020 2020 2020  amples.").      
+00054c30: 2020 6966 206e 702e 6c69 6e61 6c67 2e6d    if np.linalg.m
+00054c40: 6174 7269 785f 7261 6e6b 285a 2920 3c20  atrix_rank(Z) < 
+00054c50: 5a2e 7368 6170 655b 315d 3a0a 2020 2020  Z.shape[1]:.    
+00054c60: 2020 2020 2020 2020 7261 6973 6520 5661          raise Va
+00054c70: 6c75 6545 7272 6f72 2822 4d61 7472 6978  lueError("Matrix
+00054c80: 206f 6620 636f 7661 7269 6174 6573 2069   of covariates i
+00054c90: 7320 636f 6d70 7574 6174 696f 6e61 6c6c  s computationall
+00054ca0: 7920 7369 6e67 756c 6172 2e22 290a 2020  y singular.").  
+00054cb0: 2020 2020 2020 2320 6e75 6d70 7920 7265        # numpy re
+00054cc0: 7475 726e 7320 6120 6c6f 7765 722d 7472  turns a lower-tr
+00054cd0: 6961 6e67 756c 6172 2063 686f 6c65 736b  iangular cholesk
+00054ce0: 790a 2020 2020 2020 2020 4b20 3d20 6e70  y.        K = np
+00054cf0: 2e6c 696e 616c 672e 6368 6f6c 6573 6b79  .linalg.cholesky
+00054d00: 286e 702e 6d61 746d 756c 285a 2e54 2c20  (np.matmul(Z.T, 
+00054d10: 5a29 292e 540a 2020 2020 2020 2020 5a20  Z)).T.        Z 
+00054d20: 3d20 6e70 2e6d 6174 6d75 6c28 5a2c 206e  = np.matmul(Z, n
+00054d30: 702e 6c69 6e61 6c67 2e69 6e76 284b 2929  p.linalg.inv(K))
+00054d40: 0a20 2020 2020 2020 2072 6574 7572 6e20  .        return 
+00054d50: 7365 6c66 2e5f 5f72 756e 5f77 696e 646f  self.__run_windo
+00054d60: 7765 645f 7374 6174 280a 2020 2020 2020  wed_stat(.      
+00054d70: 2020 2020 2020 7769 6e64 6f77 732c 0a20        windows,. 
+00054d80: 2020 2020 2020 2020 2020 2073 656c 662e             self.
+00054d90: 5f6c 6c5f 7472 6565 5f73 6571 7565 6e63  _ll_tree_sequenc
+00054da0: 652e 7472 6169 745f 6c69 6e65 6172 5f6d  e.trait_linear_m
+00054db0: 6f64 656c 2c0a 2020 2020 2020 2020 2020  odel,.          
+00054dc0: 2020 572c 0a20 2020 2020 2020 2020 2020    W,.           
+00054dd0: 205a 2c0a 2020 2020 2020 2020 2020 2020   Z,.            
+00054de0: 6d6f 6465 3d6d 6f64 652c 0a20 2020 2020  mode=mode,.     
+00054df0: 2020 2020 2020 2073 7061 6e5f 6e6f 726d         span_norm
+00054e00: 616c 6973 653d 7370 616e 5f6e 6f72 6d61  alise=span_norma
+00054e10: 6c69 7365 2c0a 2020 2020 2020 2020 290a  lise,.        ).
+00054e20: 0a20 2020 2064 6566 2073 6567 7265 6761  .    def segrega
+00054e30: 7469 6e67 5f73 6974 6573 280a 2020 2020  ting_sites(.    
+00054e40: 2020 2020 7365 6c66 2c20 7361 6d70 6c65      self, sample
+00054e50: 5f73 6574 733d 4e6f 6e65 2c20 7769 6e64  _sets=None, wind
+00054e60: 6f77 733d 4e6f 6e65 2c20 6d6f 6465 3d22  ows=None, mode="
+00054e70: 7369 7465 222c 2073 7061 6e5f 6e6f 726d  site", span_norm
+00054e80: 616c 6973 653d 5472 7565 0a20 2020 2029  alise=True.    )
+00054e90: 3a0a 2020 2020 2020 2020 2222 220a 2020  :.        """.  
+00054ea0: 2020 2020 2020 436f 6d70 7574 6573 2074        Computes t
+00054eb0: 6865 2064 656e 7369 7479 206f 6620 7365  he density of se
+00054ec0: 6772 6567 6174 696e 6720 7369 7465 7320  gregating sites 
+00054ed0: 666f 7220 6561 6368 206f 6620 7468 6520  for each of the 
+00054ee0: 7365 7473 206f 6620 6e6f 6465 730a 2020  sets of nodes.  
+00054ef0: 2020 2020 2020 6672 6f6d 2060 6073 616d        from ``sam
+00054f00: 706c 655f 7365 7473 6060 2c20 616e 6420  ple_sets``, and 
+00054f10: 7265 6c61 7465 6420 7175 616e 7469 7469  related quantiti
+00054f20: 6573 2e0a 2020 2020 2020 2020 506c 6561  es..        Plea
+00054f30: 7365 2073 6565 2074 6865 203a 7265 663a  se see the :ref:
+00054f40: 606f 6e65 2d77 6179 2073 7461 7469 7374  `one-way statist
+00054f50: 6963 7320 3c73 6563 5f73 7461 7473 5f73  ics <sec_stats_s
+00054f60: 616d 706c 655f 7365 7473 5f6f 6e65 5f77  ample_sets_one_w
+00054f70: 6179 3e60 0a20 2020 2020 2020 2073 6563  ay>`.        sec
+00054f80: 7469 6f6e 2066 6f72 2064 6574 6169 6c73  tion for details
+00054f90: 206f 6e20 686f 7720 7468 6520 6060 7361   on how the ``sa
+00054fa0: 6d70 6c65 5f73 6574 7360 6020 6172 6775  mple_sets`` argu
+00054fb0: 6d65 6e74 2069 7320 696e 7465 7270 7265  ment is interpre
+00054fc0: 7465 640a 2020 2020 2020 2020 616e 6420  ted.        and 
+00054fd0: 686f 7720 6974 2069 6e74 6572 6163 7473  how it interacts
+00054fe0: 2077 6974 6820 7468 6520 6469 6d65 6e73   with the dimens
+00054ff0: 696f 6e73 206f 6620 7468 6520 6f75 7470  ions of the outp
+00055000: 7574 2061 7272 6179 2e0a 2020 2020 2020  ut array..      
+00055010: 2020 5365 6520 7468 6520 3a72 6566 3a60    See the :ref:`
+00055020: 7374 6174 6973 7469 6373 2069 6e74 6572  statistics inter
+00055030: 6661 6365 203c 7365 635f 7374 6174 735f  face <sec_stats_
+00055040: 696e 7465 7266 6163 653e 6020 7365 6374  interface>` sect
+00055050: 696f 6e20 666f 7220 6465 7461 696c 7320  ion for details 
+00055060: 6f6e 0a20 2020 2020 2020 203a 7265 663a  on.        :ref:
+00055070: 6077 696e 646f 7773 203c 7365 635f 7374  `windows <sec_st
+00055080: 6174 735f 7769 6e64 6f77 733e 602c 203a  ats_windows>`, :
+00055090: 7265 663a 606d 6f64 6520 3c73 6563 5f73  ref:`mode <sec_s
+000550a0: 7461 7473 5f6d 6f64 653e 602c 0a20 2020  tats_mode>`,.   
+000550b0: 2020 2020 203a 7265 663a 6073 7061 6e20       :ref:`span 
+000550c0: 6e6f 726d 616c 6973 6520 3c73 6563 5f73  normalise <sec_s
+000550d0: 7461 7473 5f73 7061 6e5f 6e6f 726d 616c  tats_span_normal
+000550e0: 6973 653e 602c 0a20 2020 2020 2020 2061  ise>`,.        a
+000550f0: 6e64 203a 7265 663a 6072 6574 7572 6e20  nd :ref:`return 
+00055100: 7661 6c75 6520 3c73 6563 5f73 7461 7473  value <sec_stats
+00055110: 5f6f 7574 7075 745f 666f 726d 6174 3e60  _output_format>`
+00055120: 2e0a 0a20 2020 2020 2020 2057 6861 7420  ...        What 
+00055130: 6973 2063 6f6d 7075 7465 6420 6465 7065  is computed depe
+00055140: 6e64 7320 6f6e 2060 606d 6f64 6560 602e  nds on ``mode``.
+00055150: 2046 6f72 2061 2073 616d 706c 6520 7365   For a sample se
+00055160: 7420 6060 4160 602c 2063 6f6d 7075 7465  t ``A``, compute
+00055170: 733a 0a0a 2020 2020 2020 2020 2273 6974  s:..        "sit
+00055180: 6522 0a20 2020 2020 2020 2020 2020 2054  e".            T
+00055190: 6865 2073 756d 206f 7665 7220 7369 7465  he sum over site
+000551a0: 7320 6f66 2074 6865 206e 756d 6265 7220  s of the number 
+000551b0: 6f66 2061 6c6c 656c 6573 2066 6f75 6e64  of alleles found
+000551c0: 2069 6e20 6060 4160 6020 6174 2065 6163   in ``A`` at eac
+000551d0: 6820 7369 7465 0a20 2020 2020 2020 2020  h site.         
+000551e0: 2020 206d 696e 7573 206f 6e65 2c20 7065     minus one, pe
+000551f0: 7220 756e 6974 206f 6620 6368 726f 6d6f  r unit of chromo
+00055200: 736f 6d65 206c 656e 6774 682e 0a20 2020  some length..   
+00055210: 2020 2020 2020 2020 2049 6620 616c 6c20           If all 
+00055220: 7369 7465 7320 6861 7665 2061 7420 6d6f  sites have at mo
+00055230: 7374 2074 776f 2061 6c6c 656c 6573 2c20  st two alleles, 
+00055240: 7468 6973 2069 7320 7468 6520 6465 6e73  this is the dens
+00055250: 6974 7920 6f66 2073 6974 6573 0a20 2020  ity of sites.   
+00055260: 2020 2020 2020 2020 2074 6861 7420 6172           that ar
+00055270: 6520 706f 6c79 6d6f 7270 6869 6320 696e  e polymorphic in
+00055280: 2060 6041 6060 2e20 546f 2067 6574 2074   ``A``. To get t
+00055290: 6865 202a 2a6e 756d 6265 722a 2a20 6f66  he **number** of
+000552a0: 2073 6567 7265 6761 7469 6e67 206d 696e   segregating min
+000552b0: 6f72 0a20 2020 2020 2020 2020 2020 2061  or.            a
+000552c0: 6c6c 656c 6573 2070 6572 2077 696e 646f  lleles per windo
+000552d0: 772c 2070 6173 7320 6060 7370 616e 5f6e  w, pass ``span_n
+000552e0: 6f72 6d61 6c69 7365 3d46 616c 7365 6060  ormalise=False``
+000552f0: 2e0a 0a20 2020 2020 2020 2022 6272 616e  ...        "bran
+00055300: 6368 220a 2020 2020 2020 2020 2020 2020  ch".            
+00055310: 5468 6520 746f 7461 6c20 6c65 6e67 7468  The total length
+00055320: 206f 6620 616c 6c20 6272 616e 6368 6573   of all branches
+00055330: 2069 6e20 7468 6520 7472 6565 2073 7562   in the tree sub
+00055340: 7465 6e64 6564 2062 7920 7468 6520 7361  tended by the sa
+00055350: 6d70 6c65 7320 696e 0a20 2020 2020 2020  mples in.       
+00055360: 2020 2020 2060 6041 6060 2c20 6176 6572       ``A``, aver
+00055370: 6167 6564 2061 6372 6f73 7320 7468 6520  aged across the 
+00055380: 7769 6e64 6f77 2e0a 0a20 2020 2020 2020  window...       
+00055390: 2022 6e6f 6465 220a 2020 2020 2020 2020   "node".        
+000553a0: 2020 2020 5468 6520 7072 6f70 6f72 7469      The proporti
+000553b0: 6f6e 206f 6620 7468 6520 7769 6e64 6f77  on of the window
+000553c0: 206f 6e20 7768 6963 6820 7468 6520 6e6f   on which the no
+000553d0: 6465 2069 7320 616e 6365 7374 7261 6c20  de is ancestral 
+000553e0: 746f 2073 6f6d 652c 0a20 2020 2020 2020  to some,.       
+000553f0: 2020 2020 2062 7574 206e 6f74 2061 6c6c       but not all
+00055400: 2c20 6f66 2074 6865 2073 616d 706c 6573  , of the samples
+00055410: 2069 6e20 6060 4160 602e 0a0a 2020 2020   in ``A``...    
+00055420: 2020 2020 3a70 6172 616d 206c 6973 7420      :param list 
+00055430: 7361 6d70 6c65 5f73 6574 733a 2041 206c  sample_sets: A l
+00055440: 6973 7420 6f66 206c 6973 7473 206f 6620  ist of lists of 
+00055450: 4e6f 6465 2049 4473 2c20 7370 6563 6966  Node IDs, specif
+00055460: 7969 6e67 2074 6865 0a20 2020 2020 2020  ying the.       
+00055470: 2020 2020 2067 726f 7570 7320 6f66 206e       groups of n
+00055480: 6f64 6573 2074 6f20 636f 6d70 7574 6520  odes to compute 
+00055490: 7468 6520 7374 6174 6973 7469 6320 7769  the statistic wi
+000554a0: 7468 2e0a 2020 2020 2020 2020 3a70 6172  th..        :par
+000554b0: 616d 206c 6973 7420 7769 6e64 6f77 733a  am list windows:
+000554c0: 2041 6e20 696e 6372 6561 7369 6e67 206c   An increasing l
+000554d0: 6973 7420 6f66 2062 7265 616b 706f 696e  ist of breakpoin
+000554e0: 7473 2062 6574 7765 656e 2074 6865 2077  ts between the w
+000554f0: 696e 646f 7773 0a20 2020 2020 2020 2020  indows.         
+00055500: 2020 2074 6f20 636f 6d70 7574 6520 7468     to compute th
+00055510: 6520 7374 6174 6973 7469 6320 696e 2e0a  e statistic in..
+00055520: 2020 2020 2020 2020 3a70 6172 616d 2073          :param s
+00055530: 7472 206d 6f64 653a 2041 2073 7472 696e  tr mode: A strin
+00055540: 6720 6769 7669 6e67 2074 6865 2022 7479  g giving the "ty
+00055550: 7065 2220 6f66 2074 6865 2073 7461 7469  pe" of the stati
+00055560: 7374 6963 2074 6f20 6265 2063 6f6d 7075  stic to be compu
+00055570: 7465 640a 2020 2020 2020 2020 2020 2020  ted.            
+00055580: 2864 6566 6175 6c74 7320 746f 2022 7369  (defaults to "si
+00055590: 7465 2229 2e0a 2020 2020 2020 2020 3a70  te")..        :p
+000555a0: 6172 616d 2062 6f6f 6c20 7370 616e 5f6e  aram bool span_n
+000555b0: 6f72 6d61 6c69 7365 3a20 5768 6574 6865  ormalise: Whethe
+000555c0: 7220 746f 2064 6976 6964 6520 7468 6520  r to divide the 
+000555d0: 7265 7375 6c74 2062 7920 7468 6520 7370  result by the sp
+000555e0: 616e 206f 6620 7468 650a 2020 2020 2020  an of the.      
+000555f0: 2020 2020 2020 7769 6e64 6f77 2028 6465        window (de
+00055600: 6661 756c 7473 2074 6f20 5472 7565 292e  faults to True).
+00055610: 0a20 2020 2020 2020 203a 7265 7475 726e  .        :return
+00055620: 3a20 4120 6e64 6172 7261 7920 7769 7468  : A ndarray with
+00055630: 2073 6861 7065 2065 7175 616c 2074 6f20   shape equal to 
+00055640: 286e 756d 2077 696e 646f 7773 2c20 6e75  (num windows, nu
+00055650: 6d20 7374 6174 6973 7469 6373 292e 0a20  m statistics).. 
+00055660: 2020 2020 2020 2020 2020 2049 6620 7468             If th
+00055670: 6572 6520 6973 206f 6e65 2073 616d 706c  ere is one sampl
+00055680: 6520 7365 7420 616e 6420 7769 6e64 6f77  e set and window
+00055690: 733d 4e6f 6e65 2c20 6120 6e75 6d70 7920  s=None, a numpy 
+000556a0: 7363 616c 6172 2069 7320 7265 7475 726e  scalar is return
+000556b0: 6564 2e0a 2020 2020 2020 2020 2222 220a  ed..        """.
+000556c0: 2020 2020 2020 2020 7265 7475 726e 2073          return s
+000556d0: 656c 662e 5f5f 6f6e 655f 7761 795f 7361  elf.__one_way_sa
+000556e0: 6d70 6c65 5f73 6574 5f73 7461 7428 0a20  mple_set_stat(. 
+000556f0: 2020 2020 2020 2020 2020 2073 656c 662e             self.
+00055700: 5f6c 6c5f 7472 6565 5f73 6571 7565 6e63  _ll_tree_sequenc
+00055710: 652e 7365 6772 6567 6174 696e 675f 7369  e.segregating_si
+00055720: 7465 732c 0a20 2020 2020 2020 2020 2020  tes,.           
+00055730: 2073 616d 706c 655f 7365 7473 2c0a 2020   sample_sets,.  
+00055740: 2020 2020 2020 2020 2020 7769 6e64 6f77            window
+00055750: 733d 7769 6e64 6f77 732c 0a20 2020 2020  s=windows,.     
+00055760: 2020 2020 2020 206d 6f64 653d 6d6f 6465         mode=mode
+00055770: 2c0a 2020 2020 2020 2020 2020 2020 7370  ,.            sp
+00055780: 616e 5f6e 6f72 6d61 6c69 7365 3d73 7061  an_normalise=spa
+00055790: 6e5f 6e6f 726d 616c 6973 652c 0a20 2020  n_normalise,.   
+000557a0: 2020 2020 2029 0a0a 2020 2020 6465 6620       )..    def 
+000557b0: 616c 6c65 6c65 5f66 7265 7175 656e 6379  allele_frequency
+000557c0: 5f73 7065 6374 7275 6d28 0a20 2020 2020  _spectrum(.     
+000557d0: 2020 2073 656c 662c 0a20 2020 2020 2020     self,.       
+000557e0: 2073 616d 706c 655f 7365 7473 3d4e 6f6e   sample_sets=Non
+000557f0: 652c 0a20 2020 2020 2020 2077 696e 646f  e,.        windo
+00055800: 7773 3d4e 6f6e 652c 0a20 2020 2020 2020  ws=None,.       
+00055810: 206d 6f64 653d 2273 6974 6522 2c0a 2020   mode="site",.  
+00055820: 2020 2020 2020 7370 616e 5f6e 6f72 6d61        span_norma
+00055830: 6c69 7365 3d54 7275 652c 0a20 2020 2020  lise=True,.     
+00055840: 2020 2070 6f6c 6172 6973 6564 3d46 616c     polarised=Fal
+00055850: 7365 2c0a 2020 2020 293a 0a20 2020 2020  se,.    ):.     
+00055860: 2020 2022 2222 0a20 2020 2020 2020 2043     """.        C
+00055870: 6f6d 7075 7465 7320 7468 6520 616c 6c65  omputes the alle
+00055880: 6c65 2066 7265 7175 656e 6379 2073 7065  le frequency spe
+00055890: 6374 7275 6d20 2841 4653 2920 696e 2077  ctrum (AFS) in w
+000558a0: 696e 646f 7773 2061 6372 6f73 7320 7468  indows across th
+000558b0: 6520 6765 6e6f 6d65 2066 6f72 0a20 2020  e genome for.   
+000558c0: 2020 2020 2077 6974 6820 7265 7370 6563       with respec
+000558d0: 7420 746f 2074 6865 2073 7065 6369 6669  t to the specifi
+000558e0: 6564 2060 6073 616d 706c 655f 7365 7473  ed ``sample_sets
+000558f0: 6060 2e0a 2020 2020 2020 2020 5365 6520  ``..        See 
+00055900: 7468 6520 3a72 6566 3a60 7374 6174 6973  the :ref:`statis
+00055910: 7469 6373 2069 6e74 6572 6661 6365 203c  tics interface <
+00055920: 7365 635f 7374 6174 735f 696e 7465 7266  sec_stats_interf
+00055930: 6163 653e 6020 7365 6374 696f 6e20 666f  ace>` section fo
+00055940: 7220 6465 7461 696c 7320 6f6e 0a20 2020  r details on.   
+00055950: 2020 2020 203a 7265 663a 6073 616d 706c       :ref:`sampl
+00055960: 6520 7365 7473 203c 7365 635f 7374 6174  e sets <sec_stat
+00055970: 735f 7361 6d70 6c65 5f73 6574 733e 602c  s_sample_sets>`,
+00055980: 0a20 2020 2020 2020 203a 7265 663a 6077  .        :ref:`w
+00055990: 696e 646f 7773 203c 7365 635f 7374 6174  indows <sec_stat
+000559a0: 735f 7769 6e64 6f77 733e 602c 0a20 2020  s_windows>`,.   
+000559b0: 2020 2020 203a 7265 663a 606d 6f64 6520       :ref:`mode 
+000559c0: 3c73 6563 5f73 7461 7473 5f6d 6f64 653e  <sec_stats_mode>
+000559d0: 602c 0a20 2020 2020 2020 203a 7265 663a  `,.        :ref:
+000559e0: 6073 7061 6e20 6e6f 726d 616c 6973 6520  `span normalise 
+000559f0: 3c73 6563 5f73 7461 7473 5f73 7061 6e5f  <sec_stats_span_
+00055a00: 6e6f 726d 616c 6973 653e 602c 0a20 2020  normalise>`,.   
+00055a10: 2020 2020 203a 7265 663a 6070 6f6c 6172       :ref:`polar
+00055a20: 6973 6564 203c 7365 635f 7374 6174 735f  ised <sec_stats_
+00055a30: 706f 6c61 7269 7361 7469 6f6e 3e60 2c0a  polarisation>`,.
+00055a40: 2020 2020 2020 2020 616e 6420 3a72 6566          and :ref
+00055a50: 3a60 7265 7475 726e 2076 616c 7565 203c  :`return value <
+00055a60: 7365 635f 7374 6174 735f 6f75 7470 7574  sec_stats_output
+00055a70: 5f66 6f72 6d61 743e 602e 0a20 2020 2020  _format>`..     
+00055a80: 2020 2061 6e64 2073 6565 203a 7265 663a     and see :ref:
+00055a90: 6073 6563 5f74 7574 6f72 6961 6c5f 6166  `sec_tutorial_af
+00055aa0: 7360 2066 6f72 2065 7861 6d70 6c65 7320  s` for examples 
+00055ab0: 6f66 2068 6f77 2074 6f20 7573 6520 7468  of how to use th
+00055ac0: 6973 206d 6574 686f 642e 0a0a 2020 2020  is method...    
+00055ad0: 2020 2020 5369 6d69 6c61 7220 746f 206f      Similar to o
+00055ae0: 7468 6572 2077 696e 646f 7765 6420 7374  ther windowed st
+00055af0: 6174 732c 2074 6865 2066 6972 7374 2064  ats, the first d
+00055b00: 696d 656e 7369 6f6e 2069 6e20 7468 6520  imension in the 
+00055b10: 7265 7475 726e 6564 2061 7272 6179 0a20  returned array. 
+00055b20: 2020 2020 2020 2063 6f72 7265 7370 6f6e         correspon
+00055b30: 6473 2074 6f20 7769 6e64 6f77 732c 2073  ds to windows, s
+00055b40: 7563 6820 7468 6174 2060 6072 6573 756c  uch that ``resul
+00055b50: 745b 695d 6060 2069 7320 7468 6520 4146  t[i]`` is the AF
+00055b60: 5320 696e 2074 6865 2069 7468 0a20 2020  S in the ith.   
+00055b70: 2020 2020 2077 696e 646f 772e 2054 6865       window. The
+00055b80: 2041 4653 2069 6e20 6561 6368 2077 696e   AFS in each win
+00055b90: 646f 7720 6973 2061 206b 2d64 696d 656e  dow is a k-dimen
+00055ba0: 7369 6f6e 616c 206e 756d 7079 2061 7272  sional numpy arr
+00055bb0: 6179 2c20 7768 6572 6520 6b20 6973 0a20  ay, where k is. 
+00055bc0: 2020 2020 2020 2074 6865 206e 756d 6265         the numbe
+00055bd0: 7220 6f66 2069 6e70 7574 2073 616d 706c  r of input sampl
+00055be0: 6520 7365 7473 2c20 7375 6368 2074 6861  e sets, such tha
+00055bf0: 7420 6060 7265 7375 6c74 5b69 2c20 6a30  t ``result[i, j0
+00055c00: 2c20 6a31 2c20 2e2e 2e5d 6060 2069 7320  , j1, ...]`` is 
+00055c10: 7468 650a 2020 2020 2020 2020 7661 6c75  the.        valu
+00055c20: 6520 6173 736f 6369 6174 6564 2077 6974  e associated wit
+00055c30: 6820 6672 6571 7565 6e63 7920 6060 6a30  h frequency ``j0
+00055c40: 6060 2069 6e20 6060 7361 6d70 6c65 5f73  `` in ``sample_s
+00055c50: 6574 735b 305d 6060 2c20 6060 6a31 6060  ets[0]``, ``j1``
+00055c60: 2069 6e0a 2020 2020 2020 2020 6060 7361   in.        ``sa
+00055c70: 6d70 6c65 5f73 6574 735b 315d 6060 2c20  mple_sets[1]``, 
+00055c80: 6574 632c 2069 6e20 7769 6e64 6f77 2060  etc, in window `
+00055c90: 6069 6060 2e20 4672 6f6d 2068 6572 652c  `i``. From here,
+00055ca0: 2077 6520 7769 6c6c 2061 7373 756d 6520   we will assume 
+00055cb0: 7468 6174 0a20 2020 2020 2020 2060 6061  that.        ``a
+00055cc0: 6673 6060 2063 6f72 7265 7370 6f6e 6473  fs`` corresponds
+00055cd0: 2074 6f20 7468 6520 7265 7375 6c74 2069   to the result i
+00055ce0: 6e20 6120 7369 6e67 6c65 2077 696e 646f  n a single windo
+00055cf0: 772c 2069 2e65 2e2c 0a20 2020 2020 2020  w, i.e.,.       
+00055d00: 2060 6061 6673 203d 2072 6573 756c 745b   ``afs = result[
+00055d10: 695d 6060 2e0a 0a20 2020 2020 2020 2049  i]``...        I
+00055d20: 6620 6120 7369 6e67 6c65 2073 616d 706c  f a single sampl
+00055d30: 6520 7365 7420 6973 2073 7065 6369 6669  e set is specifi
+00055d40: 6564 2c20 7468 6520 616c 6c65 6c65 2066  ed, the allele f
+00055d50: 7265 7175 656e 6379 2073 7065 6374 7275  requency spectru
+00055d60: 6d20 7769 7468 696e 0a20 2020 2020 2020  m within.       
+00055d70: 2074 6869 7320 7365 7420 6973 2072 6574   this set is ret
+00055d80: 7572 6e65 642c 2073 7563 6820 7468 6174  urned, such that
+00055d90: 2060 6061 6673 5b6a 5d60 6020 6973 2074   ``afs[j]`` is t
+00055da0: 6865 2076 616c 7565 2061 7373 6f63 6961  he value associa
+00055db0: 7465 6420 7769 7468 0a20 2020 2020 2020  ted with.       
+00055dc0: 2066 7265 7175 656e 6379 2060 606a 6060   frequency ``j``
+00055dd0: 2e20 5468 7573 2c20 7369 6e67 6c65 746f  . Thus, singleto
+00055de0: 6e73 2061 7265 2063 6f75 6e74 6564 2069  ns are counted i
+00055df0: 6e20 6060 6166 735b 315d 6060 2c20 646f  n ``afs[1]``, do
+00055e00: 7562 6c65 746f 6e73 2069 6e0a 2020 2020  ubletons in.    
+00055e10: 2020 2020 6060 6166 735b 325d 6060 2c20      ``afs[2]``, 
+00055e20: 616e 6420 736f 206f 6e2e 2054 6865 207a  and so on. The z
+00055e30: 6572 6f74 6820 656e 7472 7920 636f 756e  eroth entry coun
+00055e40: 7473 2061 6c6c 656c 6573 206f 7220 6272  ts alleles or br
+00055e50: 616e 6368 6573 206e 6f74 0a20 2020 2020  anches not.     
+00055e60: 2020 2073 6565 6e20 696e 2074 6865 2073     seen in the s
+00055e70: 616d 706c 6573 2062 7574 2074 6861 7420  amples but that 
+00055e80: 6172 6520 706f 6c79 6d6f 7270 6869 6320  are polymorphic 
+00055e90: 616d 6f6e 6720 7468 6520 7265 7374 206f  among the rest o
+00055ea0: 6620 7468 6520 7361 6d70 6c65 730a 2020  f the samples.  
+00055eb0: 2020 2020 2020 6f66 2074 6865 2074 7265        of the tre
+00055ec0: 6520 7365 7175 656e 6365 3b20 6c69 6b65  e sequence; like
+00055ed0: 7769 7365 2c20 7468 6520 6c61 7374 2065  wise, the last e
+00055ee0: 6e74 7279 2063 6f75 6e74 7320 616c 6c65  ntry counts alle
+00055ef0: 6c65 7320 6669 7865 6420 696e 0a20 2020  les fixed in.   
+00055f00: 2020 2020 2074 6865 2073 616d 706c 6520       the sample 
+00055f10: 7365 7420 6275 7420 706f 6c79 6d6f 7270  set but polymorp
+00055f20: 6869 6320 696e 2074 6865 2065 6e74 6972  hic in the entir
+00055f30: 6520 7365 7420 6f66 2073 616d 706c 6573  e set of samples
+00055f40: 2e20 506c 6561 7365 2073 6565 0a20 2020  . Please see.   
+00055f50: 2020 2020 2074 6865 203a 7265 663a 6073       the :ref:`s
+00055f60: 6563 5f74 7574 6f72 6961 6c5f 6166 735f  ec_tutorial_afs_
+00055f70: 7a65 726f 7468 5f65 6e74 7279 6020 666f  zeroth_entry` fo
+00055f80: 7220 616e 2069 6c6c 7573 7472 6174 696f  r an illustratio
+00055f90: 6e2e 0a0a 2020 2020 2020 2020 2e2e 2077  n...        .. w
+00055fa0: 6172 6e69 6e67 3a3a 2050 6c65 6173 6520  arning:: Please 
+00055fb0: 6e6f 7465 2074 6861 7420 7369 6e67 6c65  note that single
+00055fc0: 746f 6e73 2061 7265 202a 2a6e 6f74 2a2a  tons are **not**
+00055fd0: 2063 6f75 6e74 6564 2069 6e20 7468 6520   counted in the 
+00055fe0: 696e 6974 6961 6c0a 2020 2020 2020 2020  initial.        
+00055ff0: 2020 2020 656e 7472 7920 696e 2065 6163      entry in eac
+00056000: 6820 4146 5320 6172 7261 7920 2869 2e65  h AFS array (i.e
+00056010: 2e2c 2060 6061 6673 5b30 5d60 6029 2c20  ., ``afs[0]``), 
+00056020: 6275 7420 696e 2060 6061 6673 5b31 5d60  but in ``afs[1]`
+00056030: 602e 0a0a 2020 2020 2020 2020 4966 2060  `...        If `
+00056040: 6073 616d 706c 655f 7365 7473 6060 2069  `sample_sets`` i
+00056050: 7320 4e6f 6e65 2028 7468 6520 6465 6661  s None (the defa
+00056060: 756c 7429 2c20 7468 6520 616c 6c65 6c65  ult), the allele
+00056070: 2066 7265 7175 656e 6379 2073 7065 6374   frequency spect
+00056080: 7275 6d0a 2020 2020 2020 2020 666f 7220  rum.        for 
+00056090: 616c 6c20 7361 6d70 6c65 7320 696e 2074  all samples in t
+000560a0: 6865 2074 7265 6520 7365 7175 656e 6365  he tree sequence
+000560b0: 2069 7320 7265 7475 726e 6564 2e0a 0a20   is returned... 
+000560c0: 2020 2020 2020 2049 6620 6d6f 7265 2074         If more t
+000560d0: 6861 6e20 6f6e 6520 7361 6d70 6c65 2073  han one sample s
+000560e0: 6574 2069 7320 7370 6563 6966 6965 642c  et is specified,
+000560f0: 2074 6865 202a 2a6a 6f69 6e74 2a2a 2061   the **joint** a
+00056100: 6c6c 656c 6520 6672 6571 7565 6e63 790a  llele frequency.
+00056110: 2020 2020 2020 2020 7370 6563 7472 756d          spectrum
+00056120: 2077 6974 6869 6e20 7769 6e64 6f77 7320   within windows 
+00056130: 6973 2072 6574 7572 6e65 642e 2046 6f72  is returned. For
+00056140: 2065 7861 6d70 6c65 2c20 6966 2077 6520   example, if we 
+00056150: 7365 740a 2020 2020 2020 2020 6060 7361  set.        ``sa
+00056160: 6d70 6c65 5f73 6574 7320 3d20 5b53 302c  mple_sets = [S0,
+00056170: 2053 315d 6060 2c20 7468 656e 2061 6673   S1]``, then afs
+00056180: 5b31 2c20 325d 2063 6f75 6e74 7320 7468  [1, 2] counts th
+00056190: 6520 6e75 6d62 6572 206f 6620 7369 7465  e number of site
+000561a0: 7320 7468 6174 0a20 2020 2020 2020 2061  s that.        a
+000561b0: 7265 2073 696e 676c 6574 6f6e 7320 7769  re singletons wi
+000561c0: 7468 696e 2053 3020 616e 6420 646f 7562  thin S0 and doub
+000561d0: 6c65 746f 6e73 2069 6e20 5331 2e20 5468  letons in S1. Th
+000561e0: 6520 6469 6d65 6e73 696f 6e73 206f 6620  e dimensions of 
+000561f0: 7468 650a 2020 2020 2020 2020 6f75 7470  the.        outp
+00056200: 7574 2061 7272 6179 2077 696c 6c20 6265  ut array will be
+00056210: 2060 605b 6e75 6d5f 7769 6e64 6f77 735d   ``[num_windows]
+00056220: 202b 205b 3120 2b20 6c65 6e28 5329 2066   + [1 + len(S) f
+00056230: 6f72 2053 2069 6e20 7361 6d70 6c65 5f73  or S in sample_s
+00056240: 6574 735d 6060 2e0a 0a20 2020 2020 2020  ets]``...       
+00056250: 2049 6620 6060 706f 6c61 7269 7365 6460   If ``polarised`
+00056260: 6020 6973 2046 616c 7365 2028 7468 6520  ` is False (the 
+00056270: 6465 6661 756c 7429 2074 6865 2041 4653  default) the AFS
+00056280: 2077 696c 6c20 6265 202a 666f 6c64 6564   will be *folded
+00056290: 2a2c 2073 6f20 7468 6174 0a20 2020 2020  *, so that.     
+000562a0: 2020 2074 6865 2063 6f75 6e74 7320 646f     the counts do
+000562b0: 206e 6f74 2064 6570 656e 6420 6f6e 206b   not depend on k
+000562c0: 6e6f 7769 6e67 2077 6869 6368 2061 6c6c  nowing which all
+000562d0: 656c 6520 6973 2061 6e63 6573 7472 616c  ele is ancestral
+000562e0: 2e20 4966 2066 6f6c 6465 642c 0a20 2020  . If folded,.   
+000562f0: 2020 2020 2074 6865 2066 7265 7175 656e       the frequen
+00056300: 6379 2073 7065 6374 7275 6d20 666f 7220  cy spectrum for 
+00056310: 6120 7369 6e67 6c65 2073 616d 706c 6520  a single sample 
+00056320: 7365 7420 6060 5360 6020 6861 7320 6060  set ``S`` has ``
+00056330: 6166 735b 6a5d 203d 2030 6060 2066 6f72  afs[j] = 0`` for
+00056340: 0a20 2020 2020 2020 2061 6c6c 2060 606a  .        all ``j
+00056350: 203e 206c 656e 2853 2920 2f20 3260 602c   > len(S) / 2``,
+00056360: 2073 6f20 7468 6174 2061 6c6c 656c 6573   so that alleles
+00056370: 2061 7420 6672 6571 7565 6e63 7920 6060   at frequency ``
+00056380: 6a60 6020 616e 6420 6060 6c65 6e28 5329  j`` and ``len(S)
+00056390: 202d 206a 6060 0a20 2020 2020 2020 2062   - j``.        b
+000563a0: 6f74 6820 6164 6420 746f 2074 6865 2073  oth add to the s
+000563b0: 616d 6520 656e 7472 792e 2049 6620 7468  ame entry. If th
+000563c0: 6572 6520 6973 206d 6f72 6520 7468 616e  ere is more than
+000563d0: 206f 6e65 2073 616d 706c 6520 7365 742c   one sample set,
+000563e0: 2074 6865 0a20 2020 2020 2020 2072 6574   the.        ret
+000563f0: 7572 6e65 6420 6172 7261 7920 6973 2022  urned array is "
+00056400: 6c6f 7765 7220 7472 6961 6e67 756c 6172  lower triangular
+00056410: 2220 696e 2061 2073 696d 696c 6172 2077  " in a similar w
+00056420: 6179 2e20 466f 7220 6d6f 7265 2064 6574  ay. For more det
+00056430: 6169 6c73 2c0a 2020 2020 2020 2020 6573  ails,.        es
+00056440: 7065 6369 616c 6c79 2061 626f 7574 2068  pecially about h
+00056450: 616e 646c 696e 6720 6f66 206d 756c 7469  andling of multi
+00056460: 616c 6c65 6c69 6320 7369 7465 732c 2073  allelic sites, s
+00056470: 6565 203a 7265 663a 6073 6563 5f73 7461  ee :ref:`sec_sta
+00056480: 7473 5f6e 6f74 6573 5f61 6673 602e 0a0a  ts_notes_afs`...
+00056490: 2020 2020 2020 2020 5768 6174 2069 7320          What is 
+000564a0: 636f 6d70 7574 6564 2064 6570 656e 6473  computed depends
+000564b0: 206f 6e20 6060 6d6f 6465 6060 3a0a 0a20   on ``mode``:.. 
+000564c0: 2020 2020 2020 2022 7369 7465 220a 2020         "site".  
+000564d0: 2020 2020 2020 2020 2020 5468 6520 6e75            The nu
+000564e0: 6d62 6572 206f 6620 616c 6c65 6c65 7320  mber of alleles 
+000564f0: 6174 2061 2067 6976 656e 2066 7265 7175  at a given frequ
+00056500: 656e 6379 2077 6974 6869 6e20 7468 6520  ency within the 
+00056510: 7370 6563 6966 6965 6420 7361 6d70 6c65  specified sample
+00056520: 0a20 2020 2020 2020 2020 2020 2073 6574  .            set
+00056530: 7320 666f 7220 6561 6368 2077 696e 646f  s for each windo
+00056540: 772c 2070 6572 2075 6e69 7420 6f66 2073  w, per unit of s
+00056550: 6571 7565 6e63 6520 6c65 6e67 7468 2e20  equence length. 
+00056560: 546f 206f 6274 6169 6e20 7468 6520 746f  To obtain the to
+00056570: 7461 6c0a 2020 2020 2020 2020 2020 2020  tal.            
+00056580: 6e75 6d62 6572 206f 6620 616c 6c65 6c65  number of allele
+00056590: 732c 2073 6574 2060 6073 7061 6e5f 6e6f  s, set ``span_no
+000565a0: 726d 616c 6973 6560 6020 746f 2046 616c  rmalise`` to Fal
+000565b0: 7365 2e0a 0a20 2020 2020 2020 2022 6272  se...        "br
+000565c0: 616e 6368 220a 2020 2020 2020 2020 2020  anch".          
+000565d0: 2020 5468 6520 746f 7461 6c20 6c65 6e67    The total leng
+000565e0: 7468 206f 6620 6272 616e 6368 6573 2069  th of branches i
+000565f0: 6e20 7468 6520 7472 6565 7320 7375 6274  n the trees subt
+00056600: 656e 6465 6420 6279 2073 7562 7365 7473  ended by subsets
+00056610: 206f 6620 7468 650a 2020 2020 2020 2020   of the.        
+00056620: 2020 2020 7370 6563 6966 6965 6420 7361      specified sa
+00056630: 6d70 6c65 2073 6574 732c 2070 6572 2075  mple sets, per u
+00056640: 6e69 7420 6f66 2073 6571 7565 6e63 6520  nit of sequence 
+00056650: 6c65 6e67 7468 2e20 546f 206f 6274 6169  length. To obtai
+00056660: 6e20 7468 650a 2020 2020 2020 2020 2020  n the.          
+00056670: 2020 746f 7461 6c2c 2073 6574 2060 6073    total, set ``s
+00056680: 7061 6e5f 6e6f 726d 616c 6973 6560 6020  pan_normalise`` 
+00056690: 746f 2046 616c 7365 2e0a 0a20 2020 2020  to False...     
+000566a0: 2020 2022 6e6f 6465 220a 2020 2020 2020     "node".      
+000566b0: 2020 2020 2020 4e6f 7420 7375 7070 6f72        Not suppor
+000566c0: 7465 6420 666f 7220 7468 6973 206d 6574  ted for this met
+000566d0: 686f 6420 2872 6169 7365 7320 6120 5661  hod (raises a Va
+000566e0: 6c75 6545 7272 6f72 292e 0a0a 2020 2020  lueError)...    
+000566f0: 2020 2020 466f 7220 6578 616d 706c 652c      For example,
+00056700: 2073 7570 706f 7365 2074 6861 7420 6053   suppose that `S
+00056710: 3060 2069 7320 6120 6c69 7374 206f 6620  0` is a list of 
+00056720: 3520 7361 6d70 6c65 2049 4473 2c20 616e  5 sample IDs, an
+00056730: 6420 6053 3160 2069 730a 2020 2020 2020  d `S1` is.      
+00056740: 2020 6120 6c69 7374 206f 6620 3320 6f74    a list of 3 ot
+00056750: 6865 7220 7361 6d70 6c65 2049 4473 2e20  her sample IDs. 
+00056760: 5468 656e 2060 6166 7320 3d20 7473 2e61  Then `afs = ts.a
+00056770: 6c6c 656c 655f 6672 6571 7565 6e63 795f  llele_frequency_
+00056780: 7370 6563 7472 756d 285b 5330 2c20 5331  spectrum([S0, S1
+00056790: 5d2c 0a20 2020 2020 2020 206d 6f64 653d  ],.        mode=
+000567a0: 2273 6974 6522 2c20 7370 616e 5f6e 6f72  "site", span_nor
+000567b0: 6d61 6c69 7365 3d46 616c 7365 2960 2077  malise=False)` w
+000567c0: 696c 6c20 6265 2061 2035 7833 206e 756d  ill be a 5x3 num
+000567d0: 7079 2061 7272 6179 2c20 616e 6420 6966  py array, and if
+000567e0: 0a20 2020 2020 2020 2074 6865 7265 2061  .        there a
+000567f0: 7265 2073 6978 2061 6c6c 656c 6573 2074  re six alleles t
+00056800: 6861 7420 6172 6520 7072 6573 656e 7420  hat are present 
+00056810: 696e 206f 6e6c 7920 6f6e 6520 7361 6d70  in only one samp
+00056820: 6c65 206f 6620 6053 3060 2062 7574 0a20  le of `S0` but. 
+00056830: 2020 2020 2020 2074 776f 2073 616d 706c         two sampl
+00056840: 6573 206f 6620 6053 3160 2c20 7468 656e  es of `S1`, then
+00056850: 2060 6166 735b 312c 325d 6020 7769 6c6c   `afs[1,2]` will
+00056860: 2062 6520 6571 7561 6c20 746f 2036 2e20   be equal to 6. 
+00056870: 2053 696d 696c 6172 6c79 2c0a 2020 2020   Similarly,.    
+00056880: 2020 2020 6062 7261 6e63 685f 6166 7320      `branch_afs 
+00056890: 3d20 7473 2e61 6c6c 656c 655f 6672 6571  = ts.allele_freq
+000568a0: 7565 6e63 795f 7370 6563 7472 756d 285b  uency_spectrum([
+000568b0: 5330 2c20 5331 5d2c 206d 6f64 653d 2262  S0, S1], mode="b
+000568c0: 7261 6e63 6822 2c0a 2020 2020 2020 2020  ranch",.        
+000568d0: 7370 616e 5f6e 6f72 6d61 6c69 7365 3d46  span_normalise=F
+000568e0: 616c 7365 2960 2077 696c 6c20 616c 736f  alse)` will also
+000568f0: 2062 6520 6120 3578 3320 6172 7261 792c   be a 5x3 array,
+00056900: 2061 6e64 2060 6272 616e 6368 5f61 6673   and `branch_afs
+00056910: 5b31 2c32 5d60 0a20 2020 2020 2020 2077  [1,2]`.        w
+00056920: 696c 6c20 6265 2074 6865 2074 6f74 616c  ill be the total
+00056930: 2061 7265 6120 2869 2e65 2e2c 206c 656e   area (i.e., len
+00056940: 6774 6820 7469 6d65 7320 7370 616e 2920  gth times span) 
+00056950: 6f66 2061 6c6c 2062 7261 6e63 6865 7320  of all branches 
+00056960: 7468 6174 0a20 2020 2020 2020 2061 7265  that.        are
+00056970: 2061 626f 7665 2065 7861 6374 6c79 206f   above exactly o
+00056980: 6e65 2073 616d 706c 6520 6f66 2060 5330  ne sample of `S0
+00056990: 6020 616e 6420 7477 6f20 7361 6d70 6c65  ` and two sample
+000569a0: 7320 6f66 2060 5331 602e 0a0a 2020 2020  s of `S1`...    
+000569b0: 2020 2020 3a70 6172 616d 206c 6973 7420      :param list 
+000569c0: 7361 6d70 6c65 5f73 6574 733a 2041 206c  sample_sets: A l
+000569d0: 6973 7420 6f66 206c 6973 7473 206f 6620  ist of lists of 
+000569e0: 4e6f 6465 2049 4473 2c20 7370 6563 6966  Node IDs, specif
+000569f0: 7969 6e67 2074 6865 0a20 2020 2020 2020  ying the.       
+00056a00: 2020 2020 2067 726f 7570 7320 6f66 2073       groups of s
+00056a10: 616d 706c 6573 2074 6f20 636f 6d70 7574  amples to comput
+00056a20: 6520 7468 6520 6a6f 696e 7420 616c 6c65  e the joint alle
+00056a30: 6c65 2066 7265 7175 656e 6379 0a20 2020  le frequency.   
+00056a40: 2020 2020 203a 7061 7261 6d20 6c69 7374       :param list
+00056a50: 2077 696e 646f 7773 3a20 416e 2069 6e63   windows: An inc
+00056a60: 7265 6173 696e 6720 6c69 7374 206f 6620  reasing list of 
+00056a70: 6272 6561 6b70 6f69 6e74 7320 6265 7477  breakpoints betw
+00056a80: 6565 6e20 7769 6e64 6f77 730a 2020 2020  een windows.    
+00056a90: 2020 2020 2020 2020 616c 6f6e 6720 7468          along th
+00056aa0: 6520 6765 6e6f 6d65 2e0a 2020 2020 2020  e genome..      
+00056ab0: 2020 3a70 6172 616d 2073 7472 206d 6f64    :param str mod
+00056ac0: 653a 2041 2073 7472 696e 6720 6769 7669  e: A string givi
+00056ad0: 6e67 2074 6865 2022 7479 7065 2220 6f66  ng the "type" of
+00056ae0: 2074 6865 2073 7461 7469 7374 6963 2074   the statistic t
+00056af0: 6f20 6265 2063 6f6d 7075 7465 640a 2020  o be computed.  
+00056b00: 2020 2020 2020 2020 2020 2864 6566 6175            (defau
+00056b10: 6c74 7320 746f 2022 7369 7465 2229 2e0a  lts to "site")..
+00056b20: 2020 2020 2020 2020 3a70 6172 616d 2062          :param b
+00056b30: 6f6f 6c20 7370 616e 5f6e 6f72 6d61 6c69  ool span_normali
+00056b40: 7365 3a20 5768 6574 6865 7220 746f 2064  se: Whether to d
+00056b50: 6976 6964 6520 7468 6520 7265 7375 6c74  ivide the result
+00056b60: 2062 7920 7468 6520 7370 616e 206f 6620   by the span of 
+00056b70: 7468 650a 2020 2020 2020 2020 2020 2020  the.            
+00056b80: 7769 6e64 6f77 2028 6465 6661 756c 7473  window (defaults
+00056b90: 2074 6f20 5472 7565 292e 0a20 2020 2020   to True)..     
+00056ba0: 2020 203a 7265 7475 726e 3a20 4120 286b     :return: A (k
+00056bb0: 202b 2031 2920 6469 6d65 6e73 696f 6e61   + 1) dimensiona
+00056bc0: 6c20 6e75 6d70 7920 6172 7261 792c 2077  l numpy array, w
+00056bd0: 6865 7265 206b 2069 7320 7468 6520 6e75  here k is the nu
+00056be0: 6d62 6572 206f 6620 7361 6d70 6c65 0a20  mber of sample. 
+00056bf0: 2020 2020 2020 2020 2020 2073 6574 7320             sets 
+00056c00: 7370 6563 6966 6965 642e 0a20 2020 2020  specified..     
+00056c10: 2020 2020 2020 2049 6620 7468 6572 6520         If there 
+00056c20: 6973 206f 6e65 2073 616d 706c 6520 7365  is one sample se
+00056c30: 7420 616e 6420 7769 6e64 6f77 733d 4e6f  t and windows=No
+00056c40: 6e65 2c20 6120 3120 6469 6d65 6e73 696f  ne, a 1 dimensio
+00056c50: 6e61 6c20 6172 7261 7920 6973 0a20 2020  nal array is.   
+00056c60: 2020 2020 2020 2020 2072 6574 7572 6e65           returne
+00056c70: 642e 0a20 2020 2020 2020 2022 2222 0a20  d..        """. 
+00056c80: 2020 2020 2020 2069 6620 7361 6d70 6c65         if sample
+00056c90: 5f73 6574 7320 6973 204e 6f6e 653a 0a20  _sets is None:. 
+00056ca0: 2020 2020 2020 2020 2020 2073 616d 706c             sampl
+00056cb0: 655f 7365 7473 203d 205b 7365 6c66 2e73  e_sets = [self.s
+00056cc0: 616d 706c 6573 2829 5d0a 2020 2020 2020  amples()].      
+00056cd0: 2020 7265 7475 726e 2073 656c 662e 5f5f    return self.__
+00056ce0: 6f6e 655f 7761 795f 7361 6d70 6c65 5f73  one_way_sample_s
+00056cf0: 6574 5f73 7461 7428 0a20 2020 2020 2020  et_stat(.       
+00056d00: 2020 2020 2073 656c 662e 5f6c 6c5f 7472       self._ll_tr
+00056d10: 6565 5f73 6571 7565 6e63 652e 616c 6c65  ee_sequence.alle
+00056d20: 6c65 5f66 7265 7175 656e 6379 5f73 7065  le_frequency_spe
+00056d30: 6374 7275 6d2c 0a20 2020 2020 2020 2020  ctrum,.         
+00056d40: 2020 2073 616d 706c 655f 7365 7473 2c0a     sample_sets,.
+00056d50: 2020 2020 2020 2020 2020 2020 7769 6e64              wind
+00056d60: 6f77 733d 7769 6e64 6f77 732c 0a20 2020  ows=windows,.   
+00056d70: 2020 2020 2020 2020 206d 6f64 653d 6d6f           mode=mo
+00056d80: 6465 2c0a 2020 2020 2020 2020 2020 2020  de,.            
+00056d90: 7370 616e 5f6e 6f72 6d61 6c69 7365 3d73  span_normalise=s
+00056da0: 7061 6e5f 6e6f 726d 616c 6973 652c 0a20  pan_normalise,. 
+00056db0: 2020 2020 2020 2020 2020 2070 6f6c 6172             polar
+00056dc0: 6973 6564 3d70 6f6c 6172 6973 6564 2c0a  ised=polarised,.
+00056dd0: 2020 2020 2020 2020 290a 0a20 2020 2064          )..    d
+00056de0: 6566 2054 616a 696d 6173 5f44 2873 656c  ef Tajimas_D(sel
+00056df0: 662c 2073 616d 706c 655f 7365 7473 3d4e  f, sample_sets=N
+00056e00: 6f6e 652c 2077 696e 646f 7773 3d4e 6f6e  one, windows=Non
+00056e10: 652c 206d 6f64 653d 2273 6974 6522 293a  e, mode="site"):
+00056e20: 0a20 2020 2020 2020 2022 2222 0a20 2020  .        """.   
+00056e30: 2020 2020 2043 6f6d 7075 7465 7320 5461       Computes Ta
+00056e40: 6a69 6d61 2773 2044 206f 6620 7365 7473  jima's D of sets
+00056e50: 206f 6620 6e6f 6465 7320 6672 6f6d 2060   of nodes from `
+00056e60: 6073 616d 706c 655f 7365 7473 6060 2069  `sample_sets`` i
+00056e70: 6e20 7769 6e64 6f77 732e 0a20 2020 2020  n windows..     
+00056e80: 2020 2050 6c65 6173 6520 7365 6520 7468     Please see th
+00056e90: 6520 3a72 6566 3a60 6f6e 652d 7761 7920  e :ref:`one-way 
+00056ea0: 7374 6174 6973 7469 6373 203c 7365 635f  statistics <sec_
+00056eb0: 7374 6174 735f 7361 6d70 6c65 5f73 6574  stats_sample_set
+00056ec0: 735f 6f6e 655f 7761 793e 600a 2020 2020  s_one_way>`.    
+00056ed0: 2020 2020 7365 6374 696f 6e20 666f 7220      section for 
+00056ee0: 6465 7461 696c 7320 6f6e 2068 6f77 2074  details on how t
+00056ef0: 6865 2060 6073 616d 706c 655f 7365 7473  he ``sample_sets
+00056f00: 6060 2061 7267 756d 656e 7420 6973 2069  `` argument is i
+00056f10: 6e74 6572 7072 6574 6564 0a20 2020 2020  nterpreted.     
+00056f20: 2020 2061 6e64 2068 6f77 2069 7420 696e     and how it in
+00056f30: 7465 7261 6374 7320 7769 7468 2074 6865  teracts with the
+00056f40: 2064 696d 656e 7369 6f6e 7320 6f66 2074   dimensions of t
+00056f50: 6865 206f 7574 7075 7420 6172 7261 792e  he output array.
+00056f60: 0a20 2020 2020 2020 2053 6565 2074 6865  .        See the
+00056f70: 203a 7265 663a 6073 7461 7469 7374 6963   :ref:`statistic
+00056f80: 7320 696e 7465 7266 6163 6520 3c73 6563  s interface <sec
+00056f90: 5f73 7461 7473 5f69 6e74 6572 6661 6365  _stats_interface
+00056fa0: 3e60 2073 6563 7469 6f6e 2066 6f72 2064  >` section for d
+00056fb0: 6574 6169 6c73 206f 6e0a 2020 2020 2020  etails on.      
+00056fc0: 2020 3a72 6566 3a60 7769 6e64 6f77 7320    :ref:`windows 
+00056fd0: 3c73 6563 5f73 7461 7473 5f77 696e 646f  <sec_stats_windo
+00056fe0: 7773 3e60 2c20 3a72 6566 3a60 6d6f 6465  ws>`, :ref:`mode
+00056ff0: 203c 7365 635f 7374 6174 735f 6d6f 6465   <sec_stats_mode
+00057000: 3e60 2c0a 2020 2020 2020 2020 616e 6420  >`,.        and 
+00057010: 3a72 6566 3a60 7265 7475 726e 2076 616c  :ref:`return val
+00057020: 7565 203c 7365 635f 7374 6174 735f 6f75  ue <sec_stats_ou
+00057030: 7470 7574 5f66 6f72 6d61 743e 602e 0a20  tput_format>`.. 
+00057040: 2020 2020 2020 204f 7065 7261 7465 7320         Operates 
+00057050: 6f6e 2060 606b 203d 2031 6060 2073 616d  on ``k = 1`` sam
+00057060: 706c 6520 7365 7473 2061 7420 610a 2020  ple sets at a.  
+00057070: 2020 2020 2020 7469 6d65 2e20 466f 7220        time. For 
+00057080: 6120 7361 6d70 6c65 2073 6574 2060 6058  a sample set ``X
+00057090: 6060 206f 6620 6060 6e60 6020 6e6f 6465  `` of ``n`` node
+000570a0: 732c 2069 6620 616e 6420 6060 5460 6020  s, if and ``T`` 
+000570b0: 6973 2074 6865 206d 6561 6e0a 2020 2020  is the mean.    
+000570c0: 2020 2020 6e75 6d62 6572 206f 6620 7061      number of pa
+000570d0: 6972 7769 7365 2064 6966 6665 7269 6e67  irwise differing
+000570e0: 2073 6974 6573 2069 6e20 6060 5860 6020   sites in ``X`` 
+000570f0: 616e 6420 6060 5360 6020 6973 2074 6865  and ``S`` is the
+00057100: 206e 756d 6265 7220 6f66 0a20 2020 2020   number of.     
+00057110: 2020 2073 6974 6573 2073 6567 7265 6761     sites segrega
+00057120: 7469 6e67 2069 6e20 6060 5860 6020 2863  ting in ``X`` (c
+00057130: 6f6d 7075 7465 6420 7769 7468 203a 6d65  omputed with :me
+00057140: 7468 3a60 6469 7665 7273 6974 790a 2020  th:`diversity.  
+00057150: 2020 2020 2020 3c2e 5472 6565 5365 7175        <.TreeSequ
+00057160: 656e 6365 2e64 6976 6572 7369 7479 3e60  ence.diversity>`
+00057170: 2061 6e64 203a 6d65 7468 3a60 7365 6772   and :meth:`segr
+00057180: 6567 6174 696e 6720 7369 7465 730a 2020  egating sites.  
+00057190: 2020 2020 2020 3c2e 5472 6565 5365 7175        <.TreeSequ
+000571a0: 656e 6365 2e73 6567 7265 6761 7469 6e67  ence.segregating
+000571b0: 5f73 6974 6573 3e60 2c20 7265 7370 6563  _sites>`, respec
+000571c0: 7469 7665 6c79 2c20 626f 7468 206e 6f74  tively, both not
+000571d0: 2073 7061 6e0a 2020 2020 2020 2020 6e6f   span.        no
+000571e0: 726d 616c 6973 6564 292c 2074 6865 6e20  rmalised), then 
+000571f0: 5461 6a69 6d61 2773 2044 2069 730a 0a20  Tajima's D is.. 
+00057200: 2020 2020 2020 202e 2e20 636f 6465 2d62         .. code-b
+00057210: 6c6f 636b 3a3a 2070 7974 686f 6e0a 0a20  lock:: python.. 
+00057220: 2020 2020 2020 2020 2020 2044 203d 2028             D = (
+00057230: 5420 2d20 5320 2f20 6829 202f 2073 7172  T - S / h) / sqr
+00057240: 7428 6120 2a20 5320 2b20 2862 202f 2063  t(a * S + (b / c
+00057250: 2920 2a20 5320 2a20 2853 202d 2031 2929  ) * S * (S - 1))
+00057260: 0a20 2020 2020 2020 2020 2020 2068 203d  .            h =
+00057270: 2031 202b 2031 202f 2032 202b 202e 2e2e   1 + 1 / 2 + ...
+00057280: 202b 2031 202f 2028 6e20 2d20 3129 0a20   + 1 / (n - 1). 
+00057290: 2020 2020 2020 2020 2020 2067 203d 2031             g = 1
+000572a0: 202b 2031 202f 2032 2a2a 3220 2b20 2e2e   + 1 / 2**2 + ..
+000572b0: 2e20 2b20 3120 2f20 286e 202d 2031 2920  . + 1 / (n - 1) 
+000572c0: 2a2a 2032 0a20 2020 2020 2020 2020 2020  ** 2.           
+000572d0: 2061 203d 2028 6e20 2b20 3129 202f 2028   a = (n + 1) / (
+000572e0: 3320 2a20 286e 202d 2031 2920 2a20 6829  3 * (n - 1) * h)
+000572f0: 202d 2031 202f 2068 2a2a 320a 2020 2020   - 1 / h**2.    
+00057300: 2020 2020 2020 2020 6220 3d20 3220 2a20          b = 2 * 
+00057310: 286e 2a2a 3220 2b20 6e20 2b20 3329 202f  (n**2 + n + 3) /
+00057320: 2028 3920 2a20 6e20 2a20 286e 202d 2031   (9 * n * (n - 1
+00057330: 2929 202d 2028 6e20 2b20 3229 202f 2028  )) - (n + 2) / (
+00057340: 6820 2a20 6e29 202b 2067 202f 2068 2a2a  h * n) + g / h**
+00057350: 320a 2020 2020 2020 2020 2020 2020 6320  2.            c 
+00057360: 3d20 682a 2a32 202b 2067 0a0a 2020 2020  = h**2 + g..    
+00057370: 2020 2020 5768 6174 2069 7320 636f 6d70      What is comp
+00057380: 7574 6564 2066 6f72 2064 6976 6572 7369  uted for diversi
+00057390: 7479 2061 6e64 2064 6976 6572 6765 6e63  ty and divergenc
+000573a0: 6520 6465 7065 6e64 7320 6f6e 2060 606d  e depends on ``m
+000573b0: 6f64 6560 603b 0a20 2020 2020 2020 2073  ode``;.        s
+000573c0: 6565 2074 686f 7365 2066 756e 6374 696f  ee those functio
+000573d0: 6e73 2066 6f72 206d 6f72 6520 6465 7461  ns for more deta
+000573e0: 696c 732e 0a0a 2020 2020 2020 2020 3a70  ils...        :p
+000573f0: 6172 616d 206c 6973 7420 7361 6d70 6c65  aram list sample
+00057400: 5f73 6574 733a 2041 206c 6973 7420 6f66  _sets: A list of
+00057410: 206c 6973 7473 206f 6620 4e6f 6465 2049   lists of Node I
+00057420: 4473 2c20 7370 6563 6966 7969 6e67 2074  Ds, specifying t
+00057430: 6865 0a20 2020 2020 2020 2020 2020 2067  he.            g
+00057440: 726f 7570 7320 6f66 206e 6f64 6573 2074  roups of nodes t
+00057450: 6f20 636f 6d70 7574 6520 7468 6520 7374  o compute the st
+00057460: 6174 6973 7469 6320 7769 7468 2e0a 2020  atistic with..  
+00057470: 2020 2020 2020 3a70 6172 616d 206c 6973        :param lis
+00057480: 7420 696e 6465 7865 733a 2041 206c 6973  t indexes: A lis
+00057490: 7420 6f66 2032 2d74 7570 6c65 732c 206f  t of 2-tuples, o
+000574a0: 7220 4e6f 6e65 2e0a 2020 2020 2020 2020  r None..        
+000574b0: 3a70 6172 616d 206c 6973 7420 7769 6e64  :param list wind
+000574c0: 6f77 733a 2041 6e20 696e 6372 6561 7369  ows: An increasi
+000574d0: 6e67 206c 6973 7420 6f66 2062 7265 616b  ng list of break
+000574e0: 706f 696e 7473 2062 6574 7765 656e 2074  points between t
+000574f0: 6865 2077 696e 646f 7773 0a20 2020 2020  he windows.     
+00057500: 2020 2020 2020 2074 6f20 636f 6d70 7574         to comput
+00057510: 6520 7468 6520 7374 6174 6973 7469 6320  e the statistic 
+00057520: 696e 2e0a 2020 2020 2020 2020 3a70 6172  in..        :par
+00057530: 616d 2073 7472 206d 6f64 653a 2041 2073  am str mode: A s
+00057540: 7472 696e 6720 6769 7669 6e67 2074 6865  tring giving the
+00057550: 2022 7479 7065 2220 6f66 2074 6865 2073   "type" of the s
+00057560: 7461 7469 7374 6963 2074 6f20 6265 2063  tatistic to be c
+00057570: 6f6d 7075 7465 640a 2020 2020 2020 2020  omputed.        
+00057580: 2020 2020 2864 6566 6175 6c74 7320 746f      (defaults to
+00057590: 2022 7369 7465 2229 2e0a 2020 2020 2020   "site")..      
+000575a0: 2020 3a72 6574 7572 6e3a 2041 206e 6461    :return: A nda
+000575b0: 7272 6179 2077 6974 6820 7368 6170 6520  rray with shape 
+000575c0: 6571 7561 6c20 746f 2028 6e75 6d20 7769  equal to (num wi
+000575d0: 6e64 6f77 732c 206e 756d 2073 7461 7469  ndows, num stati
+000575e0: 7374 6963 7329 2e0a 2020 2020 2020 2020  stics)..        
+000575f0: 2020 2020 4966 2074 6865 7265 2069 7320      If there is 
+00057600: 6f6e 6520 7361 6d70 6c65 2073 6574 2061  one sample set a
+00057610: 6e64 2077 696e 646f 7773 3d4e 6f6e 652c  nd windows=None,
+00057620: 2061 206e 756d 7079 2073 6361 6c61 7220   a numpy scalar 
+00057630: 6973 2072 6574 7572 6e65 642e 0a20 2020  is returned..   
+00057640: 2020 2020 2022 2222 0a20 2020 2020 2020       """.       
+00057650: 2023 2054 4f44 4f20 7468 6973 2073 686f   # TODO this sho
+00057660: 756c 6420 6265 2064 6f6e 6520 696e 2043  uld be done in C
+00057670: 2061 7320 7765 276c 6c20 7761 6e74 2074   as we'll want t
+00057680: 6f20 7375 7070 6f72 7420 7468 6973 206d  o support this m
+00057690: 6574 686f 6420 7468 6572 652e 0a20 2020  ethod there..   
+000576a0: 2020 2020 2064 6566 2074 6a64 5f66 756e       def tjd_fun
+000576b0: 6328 7361 6d70 6c65 5f73 6574 5f73 697a  c(sample_set_siz
+000576c0: 6573 2c20 666c 6174 7465 6e65 642c 202a  es, flattened, *
+000576d0: 2a6b 7761 7267 7329 3a0a 2020 2020 2020  *kwargs):.      
+000576e0: 2020 2020 2020 6e20 3d20 7361 6d70 6c65        n = sample
+000576f0: 5f73 6574 5f73 697a 6573 0a20 2020 2020  _set_sizes.     
+00057700: 2020 2020 2020 2054 203d 2073 656c 662e         T = self.
+00057710: 6c6c 5f74 7265 655f 7365 7175 656e 6365  ll_tree_sequence
+00057720: 2e64 6976 6572 7369 7479 286e 2c20 666c  .diversity(n, fl
+00057730: 6174 7465 6e65 642c 202a 2a6b 7761 7267  attened, **kwarg
+00057740: 7329 0a20 2020 2020 2020 2020 2020 2053  s).            S
+00057750: 203d 2073 656c 662e 6c6c 5f74 7265 655f   = self.ll_tree_
+00057760: 7365 7175 656e 6365 2e73 6567 7265 6761  sequence.segrega
+00057770: 7469 6e67 5f73 6974 6573 286e 2c20 666c  ting_sites(n, fl
+00057780: 6174 7465 6e65 642c 202a 2a6b 7761 7267  attened, **kwarg
+00057790: 7329 0a20 2020 2020 2020 2020 2020 2068  s).            h
+000577a0: 203d 206e 702e 6172 7261 7928 5b6e 702e   = np.array([np.
+000577b0: 7375 6d28 3120 2f20 6e70 2e61 7261 6e67  sum(1 / np.arang
+000577c0: 6528 312c 206e 6e29 2920 666f 7220 6e6e  e(1, nn)) for nn
+000577d0: 2069 6e20 6e5d 290a 2020 2020 2020 2020   in n]).        
+000577e0: 2020 2020 6720 3d20 6e70 2e61 7272 6179      g = np.array
+000577f0: 285b 6e70 2e73 756d 2831 202f 206e 702e  ([np.sum(1 / np.
+00057800: 6172 616e 6765 2831 2c20 6e6e 2920 2a2a  arange(1, nn) **
+00057810: 2032 2920 666f 7220 6e6e 2069 6e20 6e5d   2) for nn in n]
+00057820: 290a 2020 2020 2020 2020 2020 2020 7769  ).            wi
+00057830: 7468 206e 702e 6572 7273 7461 7465 2869  th np.errstate(i
+00057840: 6e76 616c 6964 3d22 6967 6e6f 7265 222c  nvalid="ignore",
+00057850: 2064 6976 6964 653d 2269 676e 6f72 6522   divide="ignore"
+00057860: 293a 0a20 2020 2020 2020 2020 2020 2020  ):.             
+00057870: 2020 2061 203d 2028 6e20 2b20 3129 202f     a = (n + 1) /
+00057880: 2028 3320 2a20 286e 202d 2031 2920 2a20   (3 * (n - 1) * 
+00057890: 6829 202d 2031 202f 2068 2a2a 320a 2020  h) - 1 / h**2.  
+000578a0: 2020 2020 2020 2020 2020 2020 2020 6220                b 
+000578b0: 3d20 280a 2020 2020 2020 2020 2020 2020  = (.            
+000578c0: 2020 2020 2020 2020 3220 2a20 286e 2a2a          2 * (n**
+000578d0: 3220 2b20 6e20 2b20 3329 202f 2028 3920  2 + n + 3) / (9 
+000578e0: 2a20 6e20 2a20 286e 202d 2031 2929 0a20  * n * (n - 1)). 
+000578f0: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00057900: 2020 202d 2028 6e20 2b20 3229 202f 2028     - (n + 2) / (
+00057910: 6820 2a20 6e29 0a20 2020 2020 2020 2020  h * n).         
+00057920: 2020 2020 2020 2020 2020 202b 2067 202f             + g /
+00057930: 2068 2a2a 320a 2020 2020 2020 2020 2020   h**2.          
+00057940: 2020 2020 2020 290a 2020 2020 2020 2020        ).        
+00057950: 2020 2020 2020 2020 4420 3d20 2854 202d          D = (T -
+00057960: 2053 202f 2068 2920 2f20 6e70 2e73 7172   S / h) / np.sqr
+00057970: 7428 6120 2a20 5320 2b20 2862 202f 2028  t(a * S + (b / (
+00057980: 682a 2a32 202b 2067 2929 202a 2053 202a  h**2 + g)) * S *
+00057990: 2028 5320 2d20 3129 290a 2020 2020 2020   (S - 1)).      
+000579a0: 2020 2020 2020 7265 7475 726e 2044 0a0a        return D..
+000579b0: 2020 2020 2020 2020 7265 7475 726e 2073          return s
+000579c0: 656c 662e 5f5f 6f6e 655f 7761 795f 7361  elf.__one_way_sa
+000579d0: 6d70 6c65 5f73 6574 5f73 7461 7428 0a20  mple_set_stat(. 
+000579e0: 2020 2020 2020 2020 2020 2074 6a64 5f66             tjd_f
+000579f0: 756e 632c 2073 616d 706c 655f 7365 7473  unc, sample_sets
+00057a00: 2c20 7769 6e64 6f77 733d 7769 6e64 6f77  , windows=window
+00057a10: 732c 206d 6f64 653d 6d6f 6465 2c20 7370  s, mode=mode, sp
+00057a20: 616e 5f6e 6f72 6d61 6c69 7365 3d46 616c  an_normalise=Fal
+00057a30: 7365 0a20 2020 2020 2020 2029 0a0a 2020  se.        )..  
+00057a40: 2020 6465 6620 4673 7428 0a20 2020 2020    def Fst(.     
+00057a50: 2020 2073 656c 662c 2073 616d 706c 655f     self, sample_
+00057a60: 7365 7473 2c20 696e 6465 7865 733d 4e6f  sets, indexes=No
+00057a70: 6e65 2c20 7769 6e64 6f77 733d 4e6f 6e65  ne, windows=None
+00057a80: 2c20 6d6f 6465 3d22 7369 7465 222c 2073  , mode="site", s
+00057a90: 7061 6e5f 6e6f 726d 616c 6973 653d 5472  pan_normalise=Tr
+00057aa0: 7565 0a20 2020 2029 3a0a 2020 2020 2020  ue.    ):.      
+00057ab0: 2020 2222 220a 2020 2020 2020 2020 436f    """.        Co
+00057ac0: 6d70 7574 6573 2022 7769 6e64 6f77 6564  mputes "windowed
+00057ad0: 2220 4673 7420 6265 7477 6565 6e20 7061  " Fst between pa
+00057ae0: 6972 7320 6f66 2073 6574 7320 6f66 206e  irs of sets of n
+00057af0: 6f64 6573 2066 726f 6d20 6060 7361 6d70  odes from ``samp
+00057b00: 6c65 5f73 6574 7360 602e 0a20 2020 2020  le_sets``..     
+00057b10: 2020 204f 7065 7261 7465 7320 6f6e 2060     Operates on `
+00057b20: 606b 203d 2032 6060 2073 616d 706c 6520  `k = 2`` sample 
+00057b30: 7365 7473 2061 7420 6120 7469 6d65 3b20  sets at a time; 
+00057b40: 706c 6561 7365 2073 6565 2074 6865 0a20  please see the. 
+00057b50: 2020 2020 2020 203a 7265 663a 606d 756c         :ref:`mul
+00057b60: 7469 2d77 6179 2073 7461 7469 7374 6963  ti-way statistic
+00057b70: 7320 3c73 6563 5f73 7461 7473 5f73 616d  s <sec_stats_sam
+00057b80: 706c 655f 7365 7473 5f6d 756c 7469 5f77  ple_sets_multi_w
+00057b90: 6179 3e60 0a20 2020 2020 2020 2073 6563  ay>`.        sec
+00057ba0: 7469 6f6e 2066 6f72 2064 6574 6169 6c73  tion for details
+00057bb0: 206f 6e20 686f 7720 7468 6520 6060 7361   on how the ``sa
+00057bc0: 6d70 6c65 5f73 6574 7360 6020 616e 6420  mple_sets`` and 
+00057bd0: 6060 696e 6465 7865 7360 6020 6172 6775  ``indexes`` argu
+00057be0: 6d65 6e74 7320 6172 650a 2020 2020 2020  ments are.      
+00057bf0: 2020 696e 7465 7270 7265 7465 6420 616e    interpreted an
+00057c00: 6420 686f 7720 7468 6579 2069 6e74 6572  d how they inter
+00057c10: 6163 7420 7769 7468 2074 6865 2064 696d  act with the dim
+00057c20: 656e 7369 6f6e 7320 6f66 2074 6865 206f  ensions of the o
+00057c30: 7574 7075 7420 6172 7261 792e 0a20 2020  utput array..   
+00057c40: 2020 2020 2053 6565 2074 6865 203a 7265       See the :re
+00057c50: 663a 6073 7461 7469 7374 6963 7320 696e  f:`statistics in
+00057c60: 7465 7266 6163 6520 3c73 6563 5f73 7461  terface <sec_sta
+00057c70: 7473 5f69 6e74 6572 6661 6365 3e60 2073  ts_interface>` s
+00057c80: 6563 7469 6f6e 2066 6f72 2064 6574 6169  ection for detai
+00057c90: 6c73 206f 6e0a 2020 2020 2020 2020 3a72  ls on.        :r
+00057ca0: 6566 3a60 7769 6e64 6f77 7320 3c73 6563  ef:`windows <sec
+00057cb0: 5f73 7461 7473 5f77 696e 646f 7773 3e60  _stats_windows>`
+00057cc0: 2c0a 2020 2020 2020 2020 3a72 6566 3a60  ,.        :ref:`
+00057cd0: 6d6f 6465 203c 7365 635f 7374 6174 735f  mode <sec_stats_
+00057ce0: 6d6f 6465 3e60 2c0a 2020 2020 2020 2020  mode>`,.        
+00057cf0: 3a72 6566 3a60 7370 616e 206e 6f72 6d61  :ref:`span norma
+00057d00: 6c69 7365 203c 7365 635f 7374 6174 735f  lise <sec_stats_
+00057d10: 7370 616e 5f6e 6f72 6d61 6c69 7365 3e60  span_normalise>`
+00057d20: 2c0a 2020 2020 2020 2020 616e 6420 3a72  ,.        and :r
+00057d30: 6566 3a60 7265 7475 726e 2076 616c 7565  ef:`return value
+00057d40: 203c 7365 635f 7374 6174 735f 6f75 7470   <sec_stats_outp
+00057d50: 7574 5f66 6f72 6d61 743e 602e 0a0a 2020  ut_format>`...  
+00057d60: 2020 2020 2020 466f 7220 7361 6d70 6c65        For sample
+00057d70: 2073 6574 7320 6060 5860 6020 616e 6420   sets ``X`` and 
+00057d80: 6060 5960 602c 2069 6620 6060 6428 582c  ``Y``, if ``d(X,
+00057d90: 2059 2960 6020 6973 2074 6865 0a20 2020   Y)`` is the.   
+00057da0: 2020 2020 203a 6d65 7468 3a60 6469 7665       :meth:`dive
+00057db0: 7267 656e 6365 203c 2e54 7265 6553 6571  rgence <.TreeSeq
+00057dc0: 7565 6e63 652e 6469 7665 7267 656e 6365  uence.divergence
+00057dd0: 3e60 0a20 2020 2020 2020 2062 6574 7765  >`.        betwe
+00057de0: 656e 2060 6058 6060 2061 6e64 2060 6059  en ``X`` and ``Y
+00057df0: 6060 2c20 616e 6420 6060 6428 5829 6060  ``, and ``d(X)``
+00057e00: 2069 7320 7468 650a 2020 2020 2020 2020   is the.        
+00057e10: 3a6d 6574 683a 6064 6976 6572 7369 7479  :meth:`diversity
+00057e20: 203c 2e54 7265 6553 6571 7565 6e63 652e   <.TreeSequence.
+00057e30: 6469 7665 7273 6974 793e 6020 6f66 2060  diversity>` of `
+00057e40: 6058 6060 2c20 7468 656e 2077 6861 7420  `X``, then what 
+00057e50: 6973 0a20 2020 2020 2020 2063 6f6d 7075  is.        compu
+00057e60: 7465 6420 6973 0a0a 2020 2020 2020 2020  ted is..        
+00057e70: 2e2e 2063 6f64 652d 626c 6f63 6b3a 3a20  .. code-block:: 
+00057e80: 7079 7468 6f6e 0a0a 2020 2020 2020 2020  python..        
+00057e90: 2020 2020 4673 7420 3d20 3120 2d20 3220      Fst = 1 - 2 
+00057ea0: 2a20 2864 2858 2920 2b20 6428 5929 2920  * (d(X) + d(Y)) 
+00057eb0: 2f20 2864 2858 2920 2b20 3220 2a20 6428  / (d(X) + 2 * d(
+00057ec0: 582c 2059 2920 2b20 6428 5929 290a 0a20  X, Y) + d(Y)).. 
+00057ed0: 2020 2020 2020 2057 6861 7420 6973 2063         What is c
+00057ee0: 6f6d 7075 7465 6420 666f 7220 6469 7665  omputed for dive
+00057ef0: 7273 6974 7920 616e 6420 6469 7665 7267  rsity and diverg
+00057f00: 656e 6365 2064 6570 656e 6473 206f 6e20  ence depends on 
+00057f10: 6060 6d6f 6465 6060 3b0a 2020 2020 2020  ``mode``;.      
+00057f20: 2020 7365 6520 7468 6f73 6520 6675 6e63    see those func
+00057f30: 7469 6f6e 7320 666f 7220 6d6f 7265 2064  tions for more d
+00057f40: 6574 6169 6c73 2e0a 0a20 2020 2020 2020  etails...       
+00057f50: 203a 7061 7261 6d20 6c69 7374 2073 616d   :param list sam
+00057f60: 706c 655f 7365 7473 3a20 4120 6c69 7374  ple_sets: A list
+00057f70: 206f 6620 6c69 7374 7320 6f66 204e 6f64   of lists of Nod
+00057f80: 6520 4944 732c 2073 7065 6369 6679 696e  e IDs, specifyin
+00057f90: 6720 7468 650a 2020 2020 2020 2020 2020  g the.          
+00057fa0: 2020 6772 6f75 7073 206f 6620 6e6f 6465    groups of node
+00057fb0: 7320 746f 2063 6f6d 7075 7465 2074 6865  s to compute the
+00057fc0: 2073 7461 7469 7374 6963 2077 6974 682e   statistic with.
+00057fd0: 0a20 2020 2020 2020 203a 7061 7261 6d20  .        :param 
+00057fe0: 6c69 7374 2069 6e64 6578 6573 3a20 4120  list indexes: A 
+00057ff0: 6c69 7374 206f 6620 322d 7475 706c 6573  list of 2-tuples
+00058000: 2e0a 2020 2020 2020 2020 3a70 6172 616d  ..        :param
+00058010: 206c 6973 7420 7769 6e64 6f77 733a 2041   list windows: A
+00058020: 6e20 696e 6372 6561 7369 6e67 206c 6973  n increasing lis
+00058030: 7420 6f66 2062 7265 616b 706f 696e 7473  t of breakpoints
+00058040: 2062 6574 7765 656e 2074 6865 2077 696e   between the win
+00058050: 646f 7773 0a20 2020 2020 2020 2020 2020  dows.           
+00058060: 2074 6f20 636f 6d70 7574 6520 7468 6520   to compute the 
+00058070: 7374 6174 6973 7469 6320 696e 2e0a 2020  statistic in..  
+00058080: 2020 2020 2020 3a70 6172 616d 2073 7472        :param str
+00058090: 206d 6f64 653a 2041 2073 7472 696e 6720   mode: A string 
+000580a0: 6769 7669 6e67 2074 6865 2022 7479 7065  giving the "type
+000580b0: 2220 6f66 2074 6865 2073 7461 7469 7374  " of the statist
+000580c0: 6963 2074 6f20 6265 2063 6f6d 7075 7465  ic to be compute
+000580d0: 640a 2020 2020 2020 2020 2020 2020 2864  d.            (d
+000580e0: 6566 6175 6c74 7320 746f 2022 7369 7465  efaults to "site
+000580f0: 2229 2e0a 2020 2020 2020 2020 3a70 6172  ")..        :par
+00058100: 616d 2062 6f6f 6c20 7370 616e 5f6e 6f72  am bool span_nor
+00058110: 6d61 6c69 7365 3a20 5768 6574 6865 7220  malise: Whether 
+00058120: 746f 2064 6976 6964 6520 7468 6520 7265  to divide the re
+00058130: 7375 6c74 2062 7920 7468 6520 7370 616e  sult by the span
+00058140: 206f 6620 7468 650a 2020 2020 2020 2020   of the.        
+00058150: 2020 2020 7769 6e64 6f77 2028 6465 6661      window (defa
+00058160: 756c 7473 2074 6f20 5472 7565 292e 0a20  ults to True).. 
+00058170: 2020 2020 2020 203a 7265 7475 726e 3a20         :return: 
+00058180: 4120 6e64 6172 7261 7920 7769 7468 2073  A ndarray with s
+00058190: 6861 7065 2065 7175 616c 2074 6f20 286e  hape equal to (n
+000581a0: 756d 2077 696e 646f 7773 2c20 6e75 6d20  um windows, num 
+000581b0: 7374 6174 6973 7469 6373 292e 0a20 2020  statistics)..   
+000581c0: 2020 2020 2020 2020 2049 6620 7468 6572           If ther
+000581d0: 6520 6973 206f 6e65 2070 6169 7220 6f66  e is one pair of
+000581e0: 2073 616d 706c 6520 7365 7473 2061 6e64   sample sets and
+000581f0: 2077 696e 646f 7773 3d4e 6f6e 652c 2061   windows=None, a
+00058200: 206e 756d 7079 2073 6361 6c61 7220 6973   numpy scalar is
+00058210: 0a20 2020 2020 2020 2020 2020 2072 6574  .            ret
+00058220: 7572 6e65 642e 0a20 2020 2020 2020 2022  urned..        "
+00058230: 2222 0a20 2020 2020 2020 2023 2054 4f44  "".        # TOD
+00058240: 4f20 7468 6973 2073 686f 756c 6420 7265  O this should re
+00058250: 616c 6c79 2062 6520 696d 706c 656d 656e  ally be implemen
+00058260: 7465 6420 696e 2043 2028 7072 6573 756d  ted in C (presum
+00058270: 6162 6c79 2043 2070 726f 6772 616d 6d65  ably C programme
+00058280: 7273 2077 696c 6c20 7761 6e74 0a20 2020  rs will want.   
+00058290: 2020 2020 2023 2074 6f20 636f 6d70 7574       # to comput
+000582a0: 6520 4673 7420 746f 6f29 2c20 6275 7420  e Fst too), but 
+000582b0: 696e 2074 6865 206d 6561 6e20 7469 6d65  in the mean time
+000582c0: 2069 6d70 6c65 6d65 6e74 696e 6720 7573   implementing us
+000582d0: 696e 6720 7468 6520 6c6f 772d 6c65 7665  ing the low-leve
+000582e0: 6c0a 2020 2020 2020 2020 2320 6361 6c6c  l.        # call
+000582f0: 7320 6861 7320 7477 6f20 6164 7661 6e74  s has two advant
+00058300: 6167 6573 3a20 2861 2920 7765 2061 7574  ages: (a) we aut
+00058310: 6f6d 6174 6963 616c 6c79 2063 6861 6e67  omatically chang
+00058320: 6520 6469 6d65 6e73 696f 6e73 206c 696b  e dimensions lik
+00058330: 6520 7468 6520 6f74 6865 720a 2020 2020  e the other.    
+00058340: 2020 2020 2320 7477 6f2d 7761 7920 7374      # two-way st
+00058350: 6174 7320 616e 6420 2862 2920 6974 2773  ats and (b) it's
+00058360: 2061 2062 6974 206d 6f72 6520 6566 6669   a bit more effi
+00058370: 6369 656e 7420 6265 6361 7573 6520 7765  cient because we
+00058380: 2772 6520 6e6f 7420 6d65 7373 696e 670a  're not messing.
+00058390: 2020 2020 2020 2020 2320 6172 6f75 6e64          # around
+000583a0: 2077 6974 6820 696e 6465 7865 7320 616e   with indexes an
+000583b0: 6420 7361 6d70 6c65 7320 7365 7473 2074  d samples sets t
+000583c0: 7769 6365 2e0a 0a20 2020 2020 2020 2064  wice...        d
+000583d0: 6566 2066 7374 5f66 756e 6328 7361 6d70  ef fst_func(samp
+000583e0: 6c65 5f73 6574 5f73 697a 6573 2c20 666c  le_set_sizes, fl
+000583f0: 6174 7465 6e65 642c 2069 6e64 6578 6573  attened, indexes
+00058400: 2c20 2a2a 6b77 6172 6773 293a 0a20 2020  , **kwargs):.   
+00058410: 2020 2020 2020 2020 2064 6976 6572 7369           diversi
+00058420: 7469 6573 203d 2073 656c 662e 5f6c 6c5f  ties = self._ll_
+00058430: 7472 6565 5f73 6571 7565 6e63 652e 6469  tree_sequence.di
+00058440: 7665 7273 6974 7928 0a20 2020 2020 2020  versity(.       
+00058450: 2020 2020 2020 2020 2073 616d 706c 655f           sample_
+00058460: 7365 745f 7369 7a65 732c 2066 6c61 7474  set_sizes, flatt
+00058470: 656e 6564 2c20 2a2a 6b77 6172 6773 0a20  ened, **kwargs. 
+00058480: 2020 2020 2020 2020 2020 2029 0a20 2020             ).   
+00058490: 2020 2020 2020 2020 2064 6976 6572 6765           diverge
+000584a0: 6e63 6573 203d 2073 656c 662e 5f6c 6c5f  nces = self._ll_
+000584b0: 7472 6565 5f73 6571 7565 6e63 652e 6469  tree_sequence.di
+000584c0: 7665 7267 656e 6365 280a 2020 2020 2020  vergence(.      
+000584d0: 2020 2020 2020 2020 2020 7361 6d70 6c65            sample
+000584e0: 5f73 6574 5f73 697a 6573 2c20 666c 6174  _set_sizes, flat
+000584f0: 7465 6e65 642c 2069 6e64 6578 6573 2c20  tened, indexes, 
+00058500: 2a2a 6b77 6172 6773 0a20 2020 2020 2020  **kwargs.       
+00058510: 2020 2020 2029 0a0a 2020 2020 2020 2020       )..        
+00058520: 2020 2020 6f72 6967 5f73 6861 7065 203d      orig_shape =
+00058530: 2064 6976 6572 6765 6e63 6573 2e73 6861   divergences.sha
+00058540: 7065 0a20 2020 2020 2020 2020 2020 2023  pe.            #
+00058550: 2022 6e6f 6465 2220 7374 6174 6973 7469   "node" statisti
+00058560: 6373 2070 726f 6475 6365 2061 2033 4420  cs produce a 3D 
+00058570: 6172 7261 790a 2020 2020 2020 2020 2020  array.          
+00058580: 2020 6966 206c 656e 2864 6976 6572 6765    if len(diverge
+00058590: 6e63 6573 2e73 6861 7065 2920 3d3d 2032  nces.shape) == 2
+000585a0: 3a0a 2020 2020 2020 2020 2020 2020 2020  :.              
+000585b0: 2020 6469 7665 7267 656e 6365 732e 7368    divergences.sh
+000585c0: 6170 6520 3d20 2864 6976 6572 6765 6e63  ape = (divergenc
+000585d0: 6573 2e73 6861 7065 5b30 5d2c 2031 2c20  es.shape[0], 1, 
+000585e0: 6469 7665 7267 656e 6365 732e 7368 6170  divergences.shap
+000585f0: 655b 315d 290a 2020 2020 2020 2020 2020  e[1]).          
+00058600: 2020 2020 2020 6469 7665 7273 6974 6965        diversitie
+00058610: 732e 7368 6170 6520 3d20 2864 6976 6572  s.shape = (diver
+00058620: 7369 7469 6573 2e73 6861 7065 5b30 5d2c  sities.shape[0],
+00058630: 2031 2c20 6469 7665 7273 6974 6965 732e   1, diversities.
+00058640: 7368 6170 655b 315d 290a 0a20 2020 2020  shape[1])..     
+00058650: 2020 2020 2020 2066 7374 203d 206e 702e         fst = np.
+00058660: 7265 7065 6174 2831 2e30 2c20 6e70 2e70  repeat(1.0, np.p
+00058670: 726f 6475 6374 2864 6976 6572 6765 6e63  roduct(divergenc
+00058680: 6573 2e73 6861 7065 2929 0a20 2020 2020  es.shape)).     
+00058690: 2020 2020 2020 2066 7374 2e73 6861 7065         fst.shape
+000586a0: 203d 2064 6976 6572 6765 6e63 6573 2e73   = divergences.s
+000586b0: 6861 7065 0a20 2020 2020 2020 2020 2020  hape.           
+000586c0: 2066 6f72 2069 2c20 2875 2c20 7629 2069   for i, (u, v) i
+000586d0: 6e20 656e 756d 6572 6174 6528 696e 6465  n enumerate(inde
+000586e0: 7865 7329 3a0a 2020 2020 2020 2020 2020  xes):.          
+000586f0: 2020 2020 2020 6465 6e6f 6d20 3d20 280a        denom = (.
+00058700: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00058710: 2020 2020 6469 7665 7273 6974 6965 735b      diversities[
+00058720: 3a2c 203a 2c20 755d 0a20 2020 2020 2020  :, :, u].       
+00058730: 2020 2020 2020 2020 2020 2020 202b 2064               + d
+00058740: 6976 6572 7369 7469 6573 5b3a 2c20 3a2c  iversities[:, :,
+00058750: 2076 5d0a 2020 2020 2020 2020 2020 2020   v].            
+00058760: 2020 2020 2020 2020 2b20 3220 2a20 6469          + 2 * di
+00058770: 7665 7267 656e 6365 735b 3a2c 203a 2c20  vergences[:, :, 
+00058780: 695d 0a20 2020 2020 2020 2020 2020 2020  i].             
+00058790: 2020 2029 0a20 2020 2020 2020 2020 2020     ).           
+000587a0: 2020 2020 2077 6974 6820 6e70 2e65 7272       with np.err
+000587b0: 7374 6174 6528 6469 7669 6465 3d22 6967  state(divide="ig
+000587c0: 6e6f 7265 222c 2069 6e76 616c 6964 3d22  nore", invalid="
+000587d0: 6967 6e6f 7265 2229 3a0a 2020 2020 2020  ignore"):.      
+000587e0: 2020 2020 2020 2020 2020 2020 2020 6673                fs
+000587f0: 745b 3a2c 203a 2c20 695d 202d 3d20 280a  t[:, :, i] -= (.
+00058800: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00058810: 2020 2020 2020 2020 3220 2a20 2864 6976          2 * (div
+00058820: 6572 7369 7469 6573 5b3a 2c20 3a2c 2075  ersities[:, :, u
+00058830: 5d20 2b20 6469 7665 7273 6974 6965 735b  ] + diversities[
+00058840: 3a2c 203a 2c20 765d 2920 2f20 6465 6e6f  :, :, v]) / deno
+00058850: 6d0a 2020 2020 2020 2020 2020 2020 2020  m.              
+00058860: 2020 2020 2020 290a 2020 2020 2020 2020        ).        
+00058870: 2020 2020 6673 742e 7368 6170 6520 3d20      fst.shape = 
+00058880: 6f72 6967 5f73 6861 7065 0a20 2020 2020  orig_shape.     
+00058890: 2020 2020 2020 2072 6574 7572 6e20 6673         return fs
+000588a0: 740a 0a20 2020 2020 2020 2072 6574 7572  t..        retur
+000588b0: 6e20 7365 6c66 2e5f 5f6b 5f77 6179 5f73  n self.__k_way_s
+000588c0: 616d 706c 655f 7365 745f 7374 6174 280a  ample_set_stat(.
+000588d0: 2020 2020 2020 2020 2020 2020 6673 745f              fst_
+000588e0: 6675 6e63 2c0a 2020 2020 2020 2020 2020  func,.          
+000588f0: 2020 322c 0a20 2020 2020 2020 2020 2020    2,.           
+00058900: 2073 616d 706c 655f 7365 7473 2c0a 2020   sample_sets,.  
+00058910: 2020 2020 2020 2020 2020 696e 6465 7865            indexe
+00058920: 733d 696e 6465 7865 732c 0a20 2020 2020  s=indexes,.     
+00058930: 2020 2020 2020 2077 696e 646f 7773 3d77         windows=w
+00058940: 696e 646f 7773 2c0a 2020 2020 2020 2020  indows,.        
+00058950: 2020 2020 6d6f 6465 3d6d 6f64 652c 0a20      mode=mode,. 
+00058960: 2020 2020 2020 2020 2020 2073 7061 6e5f             span_
+00058970: 6e6f 726d 616c 6973 653d 7370 616e 5f6e  normalise=span_n
+00058980: 6f72 6d61 6c69 7365 2c0a 2020 2020 2020  ormalise,.      
+00058990: 2020 290a 0a20 2020 2064 6566 2059 3328    )..    def Y3(
+000589a0: 0a20 2020 2020 2020 2073 656c 662c 2073  .        self, s
+000589b0: 616d 706c 655f 7365 7473 2c20 696e 6465  ample_sets, inde
+000589c0: 7865 733d 4e6f 6e65 2c20 7769 6e64 6f77  xes=None, window
+000589d0: 733d 4e6f 6e65 2c20 6d6f 6465 3d22 7369  s=None, mode="si
+000589e0: 7465 222c 2073 7061 6e5f 6e6f 726d 616c  te", span_normal
+000589f0: 6973 653d 5472 7565 0a20 2020 2029 3a0a  ise=True.    ):.
+00058a00: 2020 2020 2020 2020 2222 220a 2020 2020          """.    
+00058a10: 2020 2020 436f 6d70 7574 6573 2074 6865      Computes the
+00058a20: 2027 5927 2073 7461 7469 7374 6963 2062   'Y' statistic b
+00058a30: 6574 7765 656e 2074 7269 706c 6573 206f  etween triples o
+00058a40: 6620 7365 7473 206f 6620 6e6f 6465 7320  f sets of nodes 
+00058a50: 6672 6f6d 2060 6073 616d 706c 655f 7365  from ``sample_se
+00058a60: 7473 6060 2e0a 2020 2020 2020 2020 4f70  ts``..        Op
+00058a70: 6572 6174 6573 206f 6e20 6060 6b20 3d20  erates on ``k = 
+00058a80: 3360 6020 7361 6d70 6c65 2073 6574 7320  3`` sample sets 
+00058a90: 6174 2061 2074 696d 653b 2070 6c65 6173  at a time; pleas
+00058aa0: 6520 7365 6520 7468 650a 2020 2020 2020  e see the.      
+00058ab0: 2020 3a72 6566 3a60 6d75 6c74 692d 7761    :ref:`multi-wa
+00058ac0: 7920 7374 6174 6973 7469 6373 203c 7365  y statistics <se
+00058ad0: 635f 7374 6174 735f 7361 6d70 6c65 5f73  c_stats_sample_s
+00058ae0: 6574 735f 6d75 6c74 695f 7761 793e 600a  ets_multi_way>`.
+00058af0: 2020 2020 2020 2020 7365 6374 696f 6e20          section 
+00058b00: 666f 7220 6465 7461 696c 7320 6f6e 2068  for details on h
+00058b10: 6f77 2074 6865 2060 6073 616d 706c 655f  ow the ``sample_
+00058b20: 7365 7473 6060 2061 6e64 2060 6069 6e64  sets`` and ``ind
+00058b30: 6578 6573 6060 2061 7267 756d 656e 7473  exes`` arguments
+00058b40: 2061 7265 0a20 2020 2020 2020 2069 6e74   are.        int
+00058b50: 6572 7072 6574 6564 2061 6e64 2068 6f77  erpreted and how
+00058b60: 2074 6865 7920 696e 7465 7261 6374 2077   they interact w
+00058b70: 6974 6820 7468 6520 6469 6d65 6e73 696f  ith the dimensio
+00058b80: 6e73 206f 6620 7468 6520 6f75 7470 7574  ns of the output
+00058b90: 2061 7272 6179 2e0a 2020 2020 2020 2020   array..        
+00058ba0: 5365 6520 7468 6520 3a72 6566 3a60 7374  See the :ref:`st
+00058bb0: 6174 6973 7469 6373 2069 6e74 6572 6661  atistics interfa
+00058bc0: 6365 203c 7365 635f 7374 6174 735f 696e  ce <sec_stats_in
+00058bd0: 7465 7266 6163 653e 6020 7365 6374 696f  terface>` sectio
+00058be0: 6e20 666f 7220 6465 7461 696c 7320 6f6e  n for details on
+00058bf0: 0a20 2020 2020 2020 203a 7265 663a 6077  .        :ref:`w
+00058c00: 696e 646f 7773 203c 7365 635f 7374 6174  indows <sec_stat
+00058c10: 735f 7769 6e64 6f77 733e 602c 0a20 2020  s_windows>`,.   
+00058c20: 2020 2020 203a 7265 663a 606d 6f64 6520       :ref:`mode 
+00058c30: 3c73 6563 5f73 7461 7473 5f6d 6f64 653e  <sec_stats_mode>
+00058c40: 602c 0a20 2020 2020 2020 203a 7265 663a  `,.        :ref:
+00058c50: 6073 7061 6e20 6e6f 726d 616c 6973 6520  `span normalise 
+00058c60: 3c73 6563 5f73 7461 7473 5f73 7061 6e5f  <sec_stats_span_
+00058c70: 6e6f 726d 616c 6973 653e 602c 0a20 2020  normalise>`,.   
+00058c80: 2020 2020 2061 6e64 203a 7265 663a 6072       and :ref:`r
+00058c90: 6574 7572 6e20 7661 6c75 6520 3c73 6563  eturn value <sec
+00058ca0: 5f73 7461 7473 5f6f 7574 7075 745f 666f  _stats_output_fo
+00058cb0: 726d 6174 3e60 2e0a 0a20 2020 2020 2020  rmat>`...       
+00058cc0: 2057 6861 7420 6973 2063 6f6d 7075 7465   What is compute
+00058cd0: 6420 6465 7065 6e64 7320 6f6e 2060 606d  d depends on ``m
+00058ce0: 6f64 6560 602e 2045 6163 6820 6973 2061  ode``. Each is a
+00058cf0: 6e20 6176 6572 6167 6520 6163 726f 7373  n average across
+00058d00: 2065 7665 7279 0a20 2020 2020 2020 2063   every.        c
+00058d10: 6f6d 6269 6e61 7469 6f6e 206f 6620 7472  ombination of tr
+00058d20: 696f 7320 6f66 2073 616d 706c 6573 2060  ios of samples `
+00058d30: 6028 612c 2062 2c20 6329 6060 2c20 6f6e  `(a, b, c)``, on
+00058d40: 6520 6368 6f73 656e 2066 726f 6d20 6561  e chosen from ea
+00058d50: 6368 2073 616d 706c 6520 7365 743a 0a0a  ch sample set:..
+00058d60: 2020 2020 2020 2020 2273 6974 6522 0a20          "site". 
+00058d70: 2020 2020 2020 2020 2020 2054 6865 2061             The a
+00058d80: 7665 7261 6765 2064 656e 7369 7479 206f  verage density o
+00058d90: 6620 7369 7465 7320 6174 2077 6869 6368  f sites at which
+00058da0: 2060 6061 6060 2064 6966 6665 7273 2066   ``a`` differs f
+00058db0: 726f 6d20 6060 6260 6020 616e 640a 2020  rom ``b`` and.  
+00058dc0: 2020 2020 2020 2020 2020 6060 6360 602c            ``c``,
+00058dd0: 2070 6572 2075 6e69 7420 6f66 2063 6872   per unit of chr
+00058de0: 6f6d 6f73 6f6d 6520 6c65 6e67 7468 2e0a  omosome length..
+00058df0: 0a20 2020 2020 2020 2022 6272 616e 6368  .        "branch
+00058e00: 220a 2020 2020 2020 2020 2020 2020 5468  ".            Th
+00058e10: 6520 6176 6572 6167 6520 6c65 6e67 7468  e average length
+00058e20: 206f 6620 616c 6c20 6272 616e 6368 6573   of all branches
+00058e30: 2074 6861 7420 7365 7061 7261 7465 2060   that separate `
+00058e40: 6061 6060 2066 726f 6d20 6060 6260 600a  `a`` from ``b``.
+00058e50: 2020 2020 2020 2020 2020 2020 616e 6420              and 
+00058e60: 6060 6360 6020 2869 6e20 756e 6974 7320  ``c`` (in units 
+00058e70: 6f66 2074 696d 6529 2e0a 0a20 2020 2020  of time)...     
+00058e80: 2020 2022 6e6f 6465 220a 2020 2020 2020     "node".      
+00058e90: 2020 2020 2020 466f 7220 6561 6368 206e        For each n
+00058ea0: 6f64 652c 2074 6865 2061 7665 7261 6765  ode, the average
+00058eb0: 2070 726f 706f 7274 696f 6e20 6f66 2074   proportion of t
+00058ec0: 6865 2077 696e 646f 7720 6f6e 2077 6869  he window on whi
+00058ed0: 6368 2060 6061 6060 0a20 2020 2020 2020  ch ``a``.       
+00058ee0: 2020 2020 2069 6e68 6572 6974 7320 6672       inherits fr
+00058ef0: 6f6d 2074 6861 7420 6e6f 6465 2062 7574  om that node but
+00058f00: 2060 6062 6060 2061 6e64 2060 6063 6060   ``b`` and ``c``
+00058f10: 2064 6f20 6e6f 742c 206f 7220 7669 6365   do not, or vice
+00058f20: 2d76 6572 7361 2e0a 0a20 2020 2020 2020  -versa...       
+00058f30: 203a 7061 7261 6d20 6c69 7374 2073 616d   :param list sam
+00058f40: 706c 655f 7365 7473 3a20 4120 6c69 7374  ple_sets: A list
+00058f50: 206f 6620 6c69 7374 7320 6f66 204e 6f64   of lists of Nod
+00058f60: 6520 4944 732c 2073 7065 6369 6679 696e  e IDs, specifyin
+00058f70: 6720 7468 650a 2020 2020 2020 2020 2020  g the.          
+00058f80: 2020 6772 6f75 7073 206f 6620 6e6f 6465    groups of node
+00058f90: 7320 746f 2063 6f6d 7075 7465 2074 6865  s to compute the
+00058fa0: 2073 7461 7469 7374 6963 2077 6974 682e   statistic with.
+00058fb0: 0a20 2020 2020 2020 203a 7061 7261 6d20  .        :param 
+00058fc0: 6c69 7374 2069 6e64 6578 6573 3a20 4120  list indexes: A 
+00058fd0: 6c69 7374 206f 6620 332d 7475 706c 6573  list of 3-tuples
+00058fe0: 2c20 6f72 204e 6f6e 652e 0a20 2020 2020  , or None..     
+00058ff0: 2020 203a 7061 7261 6d20 6c69 7374 2077     :param list w
+00059000: 696e 646f 7773 3a20 416e 2069 6e63 7265  indows: An incre
+00059010: 6173 696e 6720 6c69 7374 206f 6620 6272  asing list of br
+00059020: 6561 6b70 6f69 6e74 7320 6265 7477 6565  eakpoints betwee
+00059030: 6e20 7468 6520 7769 6e64 6f77 730a 2020  n the windows.  
+00059040: 2020 2020 2020 2020 2020 746f 2063 6f6d            to com
+00059050: 7075 7465 2074 6865 2073 7461 7469 7374  pute the statist
+00059060: 6963 2069 6e2e 0a20 2020 2020 2020 203a  ic in..        :
+00059070: 7061 7261 6d20 7374 7220 6d6f 6465 3a20  param str mode: 
+00059080: 4120 7374 7269 6e67 2067 6976 696e 6720  A string giving 
+00059090: 7468 6520 2274 7970 6522 206f 6620 7468  the "type" of th
+000590a0: 6520 7374 6174 6973 7469 6320 746f 2062  e statistic to b
+000590b0: 6520 636f 6d70 7574 6564 0a20 2020 2020  e computed.     
+000590c0: 2020 2020 2020 2028 6465 6661 756c 7473         (defaults
+000590d0: 2074 6f20 2273 6974 6522 292e 0a20 2020   to "site")..   
+000590e0: 2020 2020 203a 7061 7261 6d20 626f 6f6c       :param bool
+000590f0: 2073 7061 6e5f 6e6f 726d 616c 6973 653a   span_normalise:
+00059100: 2057 6865 7468 6572 2074 6f20 6469 7669   Whether to divi
+00059110: 6465 2074 6865 2072 6573 756c 7420 6279  de the result by
+00059120: 2074 6865 2073 7061 6e20 6f66 2074 6865   the span of the
+00059130: 0a20 2020 2020 2020 2020 2020 2077 696e  .            win
+00059140: 646f 7720 2864 6566 6175 6c74 7320 746f  dow (defaults to
+00059150: 2054 7275 6529 2e0a 2020 2020 2020 2020   True)..        
+00059160: 3a72 6574 7572 6e3a 2041 206e 6461 7272  :return: A ndarr
+00059170: 6179 2077 6974 6820 7368 6170 6520 6571  ay with shape eq
+00059180: 7561 6c20 746f 2028 6e75 6d20 7769 6e64  ual to (num wind
+00059190: 6f77 732c 206e 756d 2073 7461 7469 7374  ows, num statist
+000591a0: 6963 7329 2e0a 2020 2020 2020 2020 2020  ics)..          
+000591b0: 2020 4966 2074 6865 7265 2069 7320 6f6e    If there is on
+000591c0: 6520 7472 6970 6c65 206f 6620 7361 6d70  e triple of samp
+000591d0: 6c65 2073 6574 7320 616e 6420 7769 6e64  le sets and wind
+000591e0: 6f77 733d 4e6f 6e65 2c20 6120 6e75 6d70  ows=None, a nump
+000591f0: 7920 7363 616c 6172 2069 730a 2020 2020  y scalar is.    
+00059200: 2020 2020 2020 2020 7265 7475 726e 6564          returned
+00059210: 2e0a 2020 2020 2020 2020 2222 220a 2020  ..        """.  
+00059220: 2020 2020 2020 7265 7475 726e 2073 656c        return sel
+00059230: 662e 5f5f 6b5f 7761 795f 7361 6d70 6c65  f.__k_way_sample
+00059240: 5f73 6574 5f73 7461 7428 0a20 2020 2020  _set_stat(.     
+00059250: 2020 2020 2020 2073 656c 662e 5f6c 6c5f         self._ll_
+00059260: 7472 6565 5f73 6571 7565 6e63 652e 5933  tree_sequence.Y3
+00059270: 2c0a 2020 2020 2020 2020 2020 2020 332c  ,.            3,
+00059280: 0a20 2020 2020 2020 2020 2020 2073 616d  .            sam
+00059290: 706c 655f 7365 7473 2c0a 2020 2020 2020  ple_sets,.      
+000592a0: 2020 2020 2020 696e 6465 7865 733d 696e        indexes=in
+000592b0: 6465 7865 732c 0a20 2020 2020 2020 2020  dexes,.         
+000592c0: 2020 2077 696e 646f 7773 3d77 696e 646f     windows=windo
+000592d0: 7773 2c0a 2020 2020 2020 2020 2020 2020  ws,.            
+000592e0: 6d6f 6465 3d6d 6f64 652c 0a20 2020 2020  mode=mode,.     
+000592f0: 2020 2020 2020 2073 7061 6e5f 6e6f 726d         span_norm
+00059300: 616c 6973 653d 7370 616e 5f6e 6f72 6d61  alise=span_norma
+00059310: 6c69 7365 2c0a 2020 2020 2020 2020 290a  lise,.        ).
+00059320: 0a20 2020 2064 6566 2059 3228 0a20 2020  .    def Y2(.   
+00059330: 2020 2020 2073 656c 662c 2073 616d 706c       self, sampl
+00059340: 655f 7365 7473 2c20 696e 6465 7865 733d  e_sets, indexes=
+00059350: 4e6f 6e65 2c20 7769 6e64 6f77 733d 4e6f  None, windows=No
+00059360: 6e65 2c20 6d6f 6465 3d22 7369 7465 222c  ne, mode="site",
+00059370: 2073 7061 6e5f 6e6f 726d 616c 6973 653d   span_normalise=
+00059380: 5472 7565 0a20 2020 2029 3a0a 2020 2020  True.    ):.    
+00059390: 2020 2020 2222 220a 2020 2020 2020 2020      """.        
+000593a0: 436f 6d70 7574 6573 2074 6865 2027 5932  Computes the 'Y2
+000593b0: 2720 7374 6174 6973 7469 6320 6265 7477  ' statistic betw
+000593c0: 6565 6e20 7061 6972 7320 6f66 2073 6574  een pairs of set
+000593d0: 7320 6f66 206e 6f64 6573 2066 726f 6d20  s of nodes from 
+000593e0: 6060 7361 6d70 6c65 5f73 6574 7360 602e  ``sample_sets``.
+000593f0: 0a20 2020 2020 2020 204f 7065 7261 7465  .        Operate
+00059400: 7320 6f6e 2060 606b 203d 2032 6060 2073  s on ``k = 2`` s
+00059410: 616d 706c 6520 7365 7473 2061 7420 6120  ample sets at a 
+00059420: 7469 6d65 3b20 706c 6561 7365 2073 6565  time; please see
+00059430: 2074 6865 0a20 2020 2020 2020 203a 7265   the.        :re
+00059440: 663a 606d 756c 7469 2d77 6179 2073 7461  f:`multi-way sta
+00059450: 7469 7374 6963 7320 3c73 6563 5f73 7461  tistics <sec_sta
+00059460: 7473 5f73 616d 706c 655f 7365 7473 5f6d  ts_sample_sets_m
+00059470: 756c 7469 5f77 6179 3e60 0a20 2020 2020  ulti_way>`.     
+00059480: 2020 2073 6563 7469 6f6e 2066 6f72 2064     section for d
+00059490: 6574 6169 6c73 206f 6e20 686f 7720 7468  etails on how th
+000594a0: 6520 6060 7361 6d70 6c65 5f73 6574 7360  e ``sample_sets`
+000594b0: 6020 616e 6420 6060 696e 6465 7865 7360  ` and ``indexes`
+000594c0: 6020 6172 6775 6d65 6e74 7320 6172 650a  ` arguments are.
+000594d0: 2020 2020 2020 2020 696e 7465 7270 7265          interpre
+000594e0: 7465 6420 616e 6420 686f 7720 7468 6579  ted and how they
+000594f0: 2069 6e74 6572 6163 7420 7769 7468 2074   interact with t
+00059500: 6865 2064 696d 656e 7369 6f6e 7320 6f66  he dimensions of
+00059510: 2074 6865 206f 7574 7075 7420 6172 7261   the output arra
+00059520: 792e 0a20 2020 2020 2020 2053 6565 2074  y..        See t
+00059530: 6865 203a 7265 663a 6073 7461 7469 7374  he :ref:`statist
+00059540: 6963 7320 696e 7465 7266 6163 6520 3c73  ics interface <s
+00059550: 6563 5f73 7461 7473 5f69 6e74 6572 6661  ec_stats_interfa
+00059560: 6365 3e60 2073 6563 7469 6f6e 2066 6f72  ce>` section for
+00059570: 2064 6574 6169 6c73 206f 6e0a 2020 2020   details on.    
+00059580: 2020 2020 3a72 6566 3a60 7769 6e64 6f77      :ref:`window
+00059590: 7320 3c73 6563 5f73 7461 7473 5f77 696e  s <sec_stats_win
+000595a0: 646f 7773 3e60 2c0a 2020 2020 2020 2020  dows>`,.        
+000595b0: 3a72 6566 3a60 6d6f 6465 203c 7365 635f  :ref:`mode <sec_
+000595c0: 7374 6174 735f 6d6f 6465 3e60 2c0a 2020  stats_mode>`,.  
+000595d0: 2020 2020 2020 3a72 6566 3a60 7370 616e        :ref:`span
+000595e0: 206e 6f72 6d61 6c69 7365 203c 7365 635f   normalise <sec_
+000595f0: 7374 6174 735f 7370 616e 5f6e 6f72 6d61  stats_span_norma
+00059600: 6c69 7365 3e60 2c0a 2020 2020 2020 2020  lise>`,.        
+00059610: 616e 6420 3a72 6566 3a60 7265 7475 726e  and :ref:`return
+00059620: 2076 616c 7565 203c 7365 635f 7374 6174   value <sec_stat
+00059630: 735f 6f75 7470 7574 5f66 6f72 6d61 743e  s_output_format>
+00059640: 602e 0a0a 2020 2020 2020 2020 5768 6174  `...        What
+00059650: 2069 7320 636f 6d70 7574 6564 2064 6570   is computed dep
+00059660: 656e 6473 206f 6e20 6060 6d6f 6465 6060  ends on ``mode``
+00059670: 2e20 4561 6368 2069 7320 636f 6d70 7574  . Each is comput
+00059680: 6564 2065 7861 6374 6c79 2061 730a 2020  ed exactly as.  
+00059690: 2020 2020 2020 6060 5933 6060 2c20 6578        ``Y3``, ex
+000596a0: 6365 7074 2074 6861 7420 7468 6520 6176  cept that the av
+000596b0: 6572 6167 6520 6973 2061 6372 6f73 7320  erage is across 
+000596c0: 6576 6572 7920 706f 7373 6962 6c65 2074  every possible t
+000596d0: 7269 6f20 6f66 2073 616d 706c 6573 0a20  rio of samples. 
+000596e0: 2020 2020 2020 2060 6028 612c 2062 312c         ``(a, b1,
+000596f0: 2062 3229 6060 2c20 7768 6572 6520 6060   b2)``, where ``
+00059700: 6160 6020 6973 2063 686f 7365 6e20 6672  a`` is chosen fr
+00059710: 6f6d 2074 6865 2066 6972 7374 2073 616d  om the first sam
+00059720: 706c 6520 7365 742c 2061 6e64 0a20 2020  ple set, and.   
+00059730: 2020 2020 2060 6062 312c 2062 3260 6020       ``b1, b2`` 
+00059740: 6172 6520 6368 6f73 656e 2028 7769 7468  are chosen (with
+00059750: 6f75 7420 7265 706c 6163 656d 656e 7429  out replacement)
+00059760: 2066 726f 6d20 7468 6520 7365 636f 6e64   from the second
+00059770: 2073 616d 706c 6520 7365 742e 0a20 2020   sample set..   
+00059780: 2020 2020 2053 6565 203a 6d65 7468 3a60       See :meth:`
+00059790: 5933 203c 2e54 7265 6553 6571 7565 6e63  Y3 <.TreeSequenc
+000597a0: 652e 5933 3e60 2066 6f72 206d 6f72 6520  e.Y3>` for more 
+000597b0: 6465 7461 696c 732e 0a0a 2020 2020 2020  details...      
+000597c0: 2020 3a70 6172 616d 206c 6973 7420 7361    :param list sa
+000597d0: 6d70 6c65 5f73 6574 733a 2041 206c 6973  mple_sets: A lis
+000597e0: 7420 6f66 206c 6973 7473 206f 6620 4e6f  t of lists of No
+000597f0: 6465 2049 4473 2c20 7370 6563 6966 7969  de IDs, specifyi
+00059800: 6e67 2074 6865 0a20 2020 2020 2020 2020  ng the.         
+00059810: 2020 2067 726f 7570 7320 6f66 206e 6f64     groups of nod
+00059820: 6573 2074 6f20 636f 6d70 7574 6520 7468  es to compute th
+00059830: 6520 7374 6174 6973 7469 6320 7769 7468  e statistic with
+00059840: 2e0a 2020 2020 2020 2020 3a70 6172 616d  ..        :param
+00059850: 206c 6973 7420 696e 6465 7865 733a 2041   list indexes: A
+00059860: 206c 6973 7420 6f66 2032 2d74 7570 6c65   list of 2-tuple
+00059870: 732c 206f 7220 4e6f 6e65 2e0a 2020 2020  s, or None..    
+00059880: 2020 2020 3a70 6172 616d 206c 6973 7420      :param list 
+00059890: 7769 6e64 6f77 733a 2041 6e20 696e 6372  windows: An incr
+000598a0: 6561 7369 6e67 206c 6973 7420 6f66 2062  easing list of b
+000598b0: 7265 616b 706f 696e 7473 2062 6574 7765  reakpoints betwe
+000598c0: 656e 2074 6865 2077 696e 646f 7773 0a20  en the windows. 
+000598d0: 2020 2020 2020 2020 2020 2074 6f20 636f             to co
+000598e0: 6d70 7574 6520 7468 6520 7374 6174 6973  mpute the statis
+000598f0: 7469 6320 696e 2e0a 2020 2020 2020 2020  tic in..        
+00059900: 3a70 6172 616d 2073 7472 206d 6f64 653a  :param str mode:
+00059910: 2041 2073 7472 696e 6720 6769 7669 6e67   A string giving
+00059920: 2074 6865 2022 7479 7065 2220 6f66 2074   the "type" of t
+00059930: 6865 2073 7461 7469 7374 6963 2074 6f20  he statistic to 
+00059940: 6265 2063 6f6d 7075 7465 640a 2020 2020  be computed.    
+00059950: 2020 2020 2020 2020 2864 6566 6175 6c74          (default
+00059960: 7320 746f 2022 7369 7465 2229 2e0a 2020  s to "site")..  
+00059970: 2020 2020 2020 3a70 6172 616d 2062 6f6f        :param boo
+00059980: 6c20 7370 616e 5f6e 6f72 6d61 6c69 7365  l span_normalise
+00059990: 3a20 5768 6574 6865 7220 746f 2064 6976  : Whether to div
+000599a0: 6964 6520 7468 6520 7265 7375 6c74 2062  ide the result b
+000599b0: 7920 7468 6520 7370 616e 206f 6620 7468  y the span of th
+000599c0: 650a 2020 2020 2020 2020 2020 2020 7769  e.            wi
+000599d0: 6e64 6f77 2028 6465 6661 756c 7473 2074  ndow (defaults t
+000599e0: 6f20 5472 7565 292e 0a20 2020 2020 2020  o True)..       
+000599f0: 203a 7265 7475 726e 3a20 4120 6e64 6172   :return: A ndar
+00059a00: 7261 7920 7769 7468 2073 6861 7065 2065  ray with shape e
+00059a10: 7175 616c 2074 6f20 286e 756d 2077 696e  qual to (num win
+00059a20: 646f 7773 2c20 6e75 6d20 7374 6174 6973  dows, num statis
+00059a30: 7469 6373 292e 0a20 2020 2020 2020 2020  tics)..         
+00059a40: 2020 2049 6620 7468 6572 6520 6973 206f     If there is o
+00059a50: 6e65 2070 6169 7220 6f66 2073 616d 706c  ne pair of sampl
+00059a60: 6520 7365 7473 2061 6e64 2077 696e 646f  e sets and windo
+00059a70: 7773 3d4e 6f6e 652c 2061 206e 756d 7079  ws=None, a numpy
+00059a80: 2073 6361 6c61 7220 6973 0a20 2020 2020   scalar is.     
+00059a90: 2020 2020 2020 2072 6574 7572 6e65 642e         returned.
+00059aa0: 0a20 2020 2020 2020 2022 2222 0a20 2020  .        """.   
+00059ab0: 2020 2020 2072 6574 7572 6e20 7365 6c66       return self
+00059ac0: 2e5f 5f6b 5f77 6179 5f73 616d 706c 655f  .__k_way_sample_
+00059ad0: 7365 745f 7374 6174 280a 2020 2020 2020  set_stat(.      
+00059ae0: 2020 2020 2020 7365 6c66 2e5f 6c6c 5f74        self._ll_t
+00059af0: 7265 655f 7365 7175 656e 6365 2e59 322c  ree_sequence.Y2,
+00059b00: 0a20 2020 2020 2020 2020 2020 2032 2c0a  .            2,.
+00059b10: 2020 2020 2020 2020 2020 2020 7361 6d70              samp
+00059b20: 6c65 5f73 6574 732c 0a20 2020 2020 2020  le_sets,.       
+00059b30: 2020 2020 2069 6e64 6578 6573 3d69 6e64       indexes=ind
+00059b40: 6578 6573 2c0a 2020 2020 2020 2020 2020  exes,.          
+00059b50: 2020 7769 6e64 6f77 733d 7769 6e64 6f77    windows=window
+00059b60: 732c 0a20 2020 2020 2020 2020 2020 206d  s,.            m
+00059b70: 6f64 653d 6d6f 6465 2c0a 2020 2020 2020  ode=mode,.      
+00059b80: 2020 2020 2020 7370 616e 5f6e 6f72 6d61        span_norma
+00059b90: 6c69 7365 3d73 7061 6e5f 6e6f 726d 616c  lise=span_normal
+00059ba0: 6973 652c 0a20 2020 2020 2020 2029 0a0a  ise,.        )..
+00059bb0: 2020 2020 6465 6620 5931 2873 656c 662c      def Y1(self,
+00059bc0: 2073 616d 706c 655f 7365 7473 2c20 7769   sample_sets, wi
+00059bd0: 6e64 6f77 733d 4e6f 6e65 2c20 6d6f 6465  ndows=None, mode
+00059be0: 3d22 7369 7465 222c 2073 7061 6e5f 6e6f  ="site", span_no
+00059bf0: 726d 616c 6973 653d 5472 7565 293a 0a20  rmalise=True):. 
+00059c00: 2020 2020 2020 2022 2222 0a20 2020 2020         """.     
+00059c10: 2020 2043 6f6d 7075 7465 7320 7468 6520     Computes the 
+00059c20: 2759 3127 2073 7461 7469 7374 6963 2077  'Y1' statistic w
+00059c30: 6974 6869 6e20 6561 6368 206f 6620 7468  ithin each of th
+00059c40: 6520 7365 7473 206f 6620 6e6f 6465 7320  e sets of nodes 
+00059c50: 6769 7665 6e20 6279 0a20 2020 2020 2020  given by.       
+00059c60: 2060 6073 616d 706c 655f 7365 7473 6060   ``sample_sets``
+00059c70: 2e0a 2020 2020 2020 2020 506c 6561 7365  ..        Please
+00059c80: 2073 6565 2074 6865 203a 7265 663a 606f   see the :ref:`o
+00059c90: 6e65 2d77 6179 2073 7461 7469 7374 6963  ne-way statistic
+00059ca0: 7320 3c73 6563 5f73 7461 7473 5f73 616d  s <sec_stats_sam
+00059cb0: 706c 655f 7365 7473 5f6f 6e65 5f77 6179  ple_sets_one_way
+00059cc0: 3e60 0a20 2020 2020 2020 2073 6563 7469  >`.        secti
+00059cd0: 6f6e 2066 6f72 2064 6574 6169 6c73 206f  on for details o
+00059ce0: 6e20 686f 7720 7468 6520 6060 7361 6d70  n how the ``samp
+00059cf0: 6c65 5f73 6574 7360 6020 6172 6775 6d65  le_sets`` argume
+00059d00: 6e74 2069 7320 696e 7465 7270 7265 7465  nt is interprete
+00059d10: 640a 2020 2020 2020 2020 616e 6420 686f  d.        and ho
+00059d20: 7720 6974 2069 6e74 6572 6163 7473 2077  w it interacts w
+00059d30: 6974 6820 7468 6520 6469 6d65 6e73 696f  ith the dimensio
+00059d40: 6e73 206f 6620 7468 6520 6f75 7470 7574  ns of the output
+00059d50: 2061 7272 6179 2e0a 2020 2020 2020 2020   array..        
+00059d60: 5365 6520 7468 6520 3a72 6566 3a60 7374  See the :ref:`st
+00059d70: 6174 6973 7469 6373 2069 6e74 6572 6661  atistics interfa
+00059d80: 6365 203c 7365 635f 7374 6174 735f 696e  ce <sec_stats_in
+00059d90: 7465 7266 6163 653e 6020 7365 6374 696f  terface>` sectio
+00059da0: 6e20 666f 7220 6465 7461 696c 7320 6f6e  n for details on
+00059db0: 0a20 2020 2020 2020 203a 7265 663a 6077  .        :ref:`w
+00059dc0: 696e 646f 7773 203c 7365 635f 7374 6174  indows <sec_stat
+00059dd0: 735f 7769 6e64 6f77 733e 602c 203a 7265  s_windows>`, :re
+00059de0: 663a 606d 6f64 6520 3c73 6563 5f73 7461  f:`mode <sec_sta
+00059df0: 7473 5f6d 6f64 653e 602c 0a20 2020 2020  ts_mode>`,.     
+00059e00: 2020 203a 7265 663a 6073 7061 6e20 6e6f     :ref:`span no
+00059e10: 726d 616c 6973 6520 3c73 6563 5f73 7461  rmalise <sec_sta
+00059e20: 7473 5f73 7061 6e5f 6e6f 726d 616c 6973  ts_span_normalis
+00059e30: 653e 602c 0a20 2020 2020 2020 2061 6e64  e>`,.        and
+00059e40: 203a 7265 663a 6072 6574 7572 6e20 7661   :ref:`return va
+00059e50: 6c75 6520 3c73 6563 5f73 7461 7473 5f6f  lue <sec_stats_o
+00059e60: 7574 7075 745f 666f 726d 6174 3e60 2e0a  utput_format>`..
+00059e70: 2020 2020 2020 2020 4f70 6572 6174 6573          Operates
+00059e80: 206f 6e20 6060 6b20 3d20 3160 6020 7361   on ``k = 1`` sa
+00059e90: 6d70 6c65 2073 6574 2061 7420 6120 7469  mple set at a ti
+00059ea0: 6d65 2e0a 0a20 2020 2020 2020 2057 6861  me...        Wha
+00059eb0: 7420 6973 2063 6f6d 7075 7465 6420 6465  t is computed de
+00059ec0: 7065 6e64 7320 6f6e 2060 606d 6f64 6560  pends on ``mode`
+00059ed0: 602e 2045 6163 6820 6973 2063 6f6d 7075  `. Each is compu
+00059ee0: 7465 6420 6578 6163 746c 7920 6173 0a20  ted exactly as. 
+00059ef0: 2020 2020 2020 2060 6059 3360 602c 2065         ``Y3``, e
+00059f00: 7863 6570 7420 7468 6174 2074 6865 2061  xcept that the a
+00059f10: 7665 7261 6765 2069 7320 6163 726f 7373  verage is across
+00059f20: 2065 7665 7279 2070 6f73 7369 626c 6520   every possible 
+00059f30: 7472 696f 206f 6620 7361 6d70 6c65 730a  trio of samples.
+00059f40: 2020 2020 2020 2020 7361 6d70 6c65 7320          samples 
+00059f50: 6060 2861 312c 2061 322c 2061 3329 6060  ``(a1, a2, a3)``
+00059f60: 2061 6c6c 2063 686f 7365 6e20 7769 7468   all chosen with
+00059f70: 6f75 7420 7265 706c 6163 656d 656e 7420  out replacement 
+00059f80: 6672 6f6d 2074 6865 2073 616d 650a 2020  from the same.  
+00059f90: 2020 2020 2020 7361 6d70 6c65 2073 6574        sample set
+00059fa0: 2e20 5365 6520 3a6d 6574 683a 6059 3320  . See :meth:`Y3 
+00059fb0: 3c2e 5472 6565 5365 7175 656e 6365 2e59  <.TreeSequence.Y
+00059fc0: 333e 6020 666f 7220 6d6f 7265 2064 6574  3>` for more det
+00059fd0: 6169 6c73 2e0a 0a20 2020 2020 2020 203a  ails...        :
+00059fe0: 7061 7261 6d20 6c69 7374 2073 616d 706c  param list sampl
+00059ff0: 655f 7365 7473 3a20 4120 6c69 7374 206f  e_sets: A list o
+0005a000: 6620 6c69 7374 7320 6f66 204e 6f64 6520  f lists of Node 
+0005a010: 4944 732c 2073 7065 6369 6679 696e 6720  IDs, specifying 
+0005a020: 7468 650a 2020 2020 2020 2020 2020 2020  the.            
+0005a030: 6772 6f75 7073 206f 6620 6e6f 6465 7320  groups of nodes 
+0005a040: 746f 2063 6f6d 7075 7465 2074 6865 2073  to compute the s
+0005a050: 7461 7469 7374 6963 2077 6974 682e 0a20  tatistic with.. 
+0005a060: 2020 2020 2020 203a 7061 7261 6d20 6c69         :param li
+0005a070: 7374 2077 696e 646f 7773 3a20 416e 2069  st windows: An i
+0005a080: 6e63 7265 6173 696e 6720 6c69 7374 206f  ncreasing list o
+0005a090: 6620 6272 6561 6b70 6f69 6e74 7320 6265  f breakpoints be
+0005a0a0: 7477 6565 6e20 7468 6520 7769 6e64 6f77  tween the window
+0005a0b0: 730a 2020 2020 2020 2020 2020 2020 746f  s.            to
+0005a0c0: 2063 6f6d 7075 7465 2074 6865 2073 7461   compute the sta
+0005a0d0: 7469 7374 6963 2069 6e2e 0a20 2020 2020  tistic in..     
+0005a0e0: 2020 203a 7061 7261 6d20 7374 7220 6d6f     :param str mo
+0005a0f0: 6465 3a20 4120 7374 7269 6e67 2067 6976  de: A string giv
+0005a100: 696e 6720 7468 6520 2274 7970 6522 206f  ing the "type" o
+0005a110: 6620 7468 6520 7374 6174 6973 7469 6320  f the statistic 
+0005a120: 746f 2062 6520 636f 6d70 7574 6564 0a20  to be computed. 
+0005a130: 2020 2020 2020 2020 2020 2028 6465 6661             (defa
+0005a140: 756c 7473 2074 6f20 2273 6974 6522 292e  ults to "site").
+0005a150: 0a20 2020 2020 2020 203a 7061 7261 6d20  .        :param 
+0005a160: 626f 6f6c 2073 7061 6e5f 6e6f 726d 616c  bool span_normal
+0005a170: 6973 653a 2057 6865 7468 6572 2074 6f20  ise: Whether to 
+0005a180: 6469 7669 6465 2074 6865 2072 6573 756c  divide the resul
+0005a190: 7420 6279 2074 6865 2073 7061 6e20 6f66  t by the span of
+0005a1a0: 2074 6865 0a20 2020 2020 2020 2020 2020   the.           
+0005a1b0: 2077 696e 646f 7720 2864 6566 6175 6c74   window (default
+0005a1c0: 7320 746f 2054 7275 6529 2e0a 2020 2020  s to True)..    
+0005a1d0: 2020 2020 3a72 6574 7572 6e3a 2041 206e      :return: A n
+0005a1e0: 6461 7272 6179 2077 6974 6820 7368 6170  darray with shap
+0005a1f0: 6520 6571 7561 6c20 746f 2028 6e75 6d20  e equal to (num 
+0005a200: 7769 6e64 6f77 732c 206e 756d 2073 7461  windows, num sta
+0005a210: 7469 7374 6963 7329 2e0a 2020 2020 2020  tistics)..      
+0005a220: 2020 2020 2020 4966 2074 6865 7265 2069        If there i
+0005a230: 7320 6f6e 6520 7361 6d70 6c65 2073 6574  s one sample set
+0005a240: 2061 6e64 2077 696e 646f 7773 3d4e 6f6e   and windows=Non
+0005a250: 652c 2061 206e 756d 7079 2073 6361 6c61  e, a numpy scala
+0005a260: 7220 6973 2072 6574 7572 6e65 642e 0a20  r is returned.. 
+0005a270: 2020 2020 2020 2022 2222 0a20 2020 2020         """.     
+0005a280: 2020 2072 6574 7572 6e20 7365 6c66 2e5f     return self._
+0005a290: 5f6f 6e65 5f77 6179 5f73 616d 706c 655f  _one_way_sample_
+0005a2a0: 7365 745f 7374 6174 280a 2020 2020 2020  set_stat(.      
+0005a2b0: 2020 2020 2020 7365 6c66 2e5f 6c6c 5f74        self._ll_t
+0005a2c0: 7265 655f 7365 7175 656e 6365 2e59 312c  ree_sequence.Y1,
+0005a2d0: 0a20 2020 2020 2020 2020 2020 2073 616d  .            sam
+0005a2e0: 706c 655f 7365 7473 2c0a 2020 2020 2020  ple_sets,.      
+0005a2f0: 2020 2020 2020 7769 6e64 6f77 733d 7769        windows=wi
+0005a300: 6e64 6f77 732c 0a20 2020 2020 2020 2020  ndows,.         
+0005a310: 2020 206d 6f64 653d 6d6f 6465 2c0a 2020     mode=mode,.  
+0005a320: 2020 2020 2020 2020 2020 7370 616e 5f6e            span_n
+0005a330: 6f72 6d61 6c69 7365 3d73 7061 6e5f 6e6f  ormalise=span_no
+0005a340: 726d 616c 6973 652c 0a20 2020 2020 2020  rmalise,.       
+0005a350: 2029 0a0a 2020 2020 6465 6620 6634 280a   )..    def f4(.
+0005a360: 2020 2020 2020 2020 7365 6c66 2c20 7361          self, sa
+0005a370: 6d70 6c65 5f73 6574 732c 2069 6e64 6578  mple_sets, index
+0005a380: 6573 3d4e 6f6e 652c 2077 696e 646f 7773  es=None, windows
+0005a390: 3d4e 6f6e 652c 206d 6f64 653d 2273 6974  =None, mode="sit
+0005a3a0: 6522 2c20 7370 616e 5f6e 6f72 6d61 6c69  e", span_normali
+0005a3b0: 7365 3d54 7275 650a 2020 2020 293a 0a20  se=True.    ):. 
+0005a3c0: 2020 2020 2020 2022 2222 0a20 2020 2020         """.     
+0005a3d0: 2020 2043 6f6d 7075 7465 7320 5061 7474     Computes Patt
+0005a3e0: 6572 736f 6e27 7320 6634 2073 7461 7469  erson's f4 stati
+0005a3f0: 7374 6963 2062 6574 7765 656e 2066 6f75  stic between fou
+0005a400: 7220 6772 6f75 7073 206f 6620 6e6f 6465  r groups of node
+0005a410: 7320 6672 6f6d 0a20 2020 2020 2020 2060  s from.        `
+0005a420: 6073 616d 706c 655f 7365 7473 6060 2e0a  `sample_sets``..
+0005a430: 2020 2020 2020 2020 4f70 6572 6174 6573          Operates
+0005a440: 206f 6e20 6060 6b20 3d20 3460 6020 7361   on ``k = 4`` sa
+0005a450: 6d70 6c65 2073 6574 7320 6174 2061 2074  mple sets at a t
+0005a460: 696d 653b 2070 6c65 6173 6520 7365 6520  ime; please see 
+0005a470: 7468 650a 2020 2020 2020 2020 3a72 6566  the.        :ref
+0005a480: 3a60 6d75 6c74 692d 7761 7920 7374 6174  :`multi-way stat
+0005a490: 6973 7469 6373 203c 7365 635f 7374 6174  istics <sec_stat
+0005a4a0: 735f 7361 6d70 6c65 5f73 6574 735f 6d75  s_sample_sets_mu
+0005a4b0: 6c74 695f 7761 793e 600a 2020 2020 2020  lti_way>`.      
+0005a4c0: 2020 7365 6374 696f 6e20 666f 7220 6465    section for de
+0005a4d0: 7461 696c 7320 6f6e 2068 6f77 2074 6865  tails on how the
+0005a4e0: 2060 6073 616d 706c 655f 7365 7473 6060   ``sample_sets``
+0005a4f0: 2061 6e64 2060 6069 6e64 6578 6573 6060   and ``indexes``
+0005a500: 2061 7267 756d 656e 7473 2061 7265 0a20   arguments are. 
+0005a510: 2020 2020 2020 2069 6e74 6572 7072 6574         interpret
+0005a520: 6564 2061 6e64 2068 6f77 2074 6865 7920  ed and how they 
+0005a530: 696e 7465 7261 6374 2077 6974 6820 7468  interact with th
+0005a540: 6520 6469 6d65 6e73 696f 6e73 206f 6620  e dimensions of 
+0005a550: 7468 6520 6f75 7470 7574 2061 7272 6179  the output array
+0005a560: 2e0a 2020 2020 2020 2020 5365 6520 7468  ..        See th
+0005a570: 6520 3a72 6566 3a60 7374 6174 6973 7469  e :ref:`statisti
+0005a580: 6373 2069 6e74 6572 6661 6365 203c 7365  cs interface <se
+0005a590: 635f 7374 6174 735f 696e 7465 7266 6163  c_stats_interfac
+0005a5a0: 653e 6020 7365 6374 696f 6e20 666f 7220  e>` section for 
+0005a5b0: 6465 7461 696c 7320 6f6e 0a20 2020 2020  details on.     
+0005a5c0: 2020 203a 7265 663a 6077 696e 646f 7773     :ref:`windows
+0005a5d0: 203c 7365 635f 7374 6174 735f 7769 6e64   <sec_stats_wind
+0005a5e0: 6f77 733e 602c 0a20 2020 2020 2020 203a  ows>`,.        :
+0005a5f0: 7265 663a 606d 6f64 6520 3c73 6563 5f73  ref:`mode <sec_s
+0005a600: 7461 7473 5f6d 6f64 653e 602c 0a20 2020  tats_mode>`,.   
+0005a610: 2020 2020 203a 7265 663a 6073 7061 6e20       :ref:`span 
+0005a620: 6e6f 726d 616c 6973 6520 3c73 6563 5f73  normalise <sec_s
+0005a630: 7461 7473 5f73 7061 6e5f 6e6f 726d 616c  tats_span_normal
+0005a640: 6973 653e 602c 0a20 2020 2020 2020 2061  ise>`,.        a
+0005a650: 6e64 203a 7265 663a 6072 6574 7572 6e20  nd :ref:`return 
+0005a660: 7661 6c75 6520 3c73 6563 5f73 7461 7473  value <sec_stats
+0005a670: 5f6f 7574 7075 745f 666f 726d 6174 3e60  _output_format>`
+0005a680: 2e0a 0a20 2020 2020 2020 2057 6861 7420  ...        What 
+0005a690: 6973 2063 6f6d 7075 7465 6420 6465 7065  is computed depe
+0005a6a0: 6e64 7320 6f6e 2060 606d 6f64 6560 602e  nds on ``mode``.
+0005a6b0: 2045 6163 6820 6973 2061 6e20 6176 6572   Each is an aver
+0005a6c0: 6167 6520 6163 726f 7373 2065 7665 7279  age across every
+0005a6d0: 2070 6f73 7369 626c 650a 2020 2020 2020   possible.      
+0005a6e0: 2020 636f 6d62 696e 6174 696f 6e20 6f66    combination of
+0005a6f0: 2066 6f75 7220 7361 6d70 6c65 7320 6060   four samples ``
+0005a700: 2861 2c20 623b 2063 2c20 6429 6060 2c20  (a, b; c, d)``, 
+0005a710: 6f6e 6520 6368 6f73 656e 2066 726f 6d20  one chosen from 
+0005a720: 6561 6368 2073 616d 706c 6520 7365 743a  each sample set:
+0005a730: 0a0a 2020 2020 2020 2020 2273 6974 6522  ..        "site"
+0005a740: 0a20 2020 2020 2020 2020 2020 2054 6865  .            The
+0005a750: 2061 7665 7261 6765 2064 656e 7369 7479   average density
+0005a760: 206f 6620 7369 7465 7320 6174 2077 6869   of sites at whi
+0005a770: 6368 2060 6061 6060 2061 6e64 2060 6063  ch ``a`` and ``c
+0005a780: 6060 2061 6772 6565 2062 7574 0a20 2020  `` agree but.   
+0005a790: 2020 2020 2020 2020 2064 6966 6665 7273           differs
+0005a7a0: 2066 726f 6d20 6060 6260 6020 616e 6420   from ``b`` and 
+0005a7b0: 6060 6460 602c 206d 696e 7573 2074 6865  ``d``, minus the
+0005a7c0: 2061 7665 7261 6765 2064 656e 7369 7479   average density
+0005a7d0: 206f 6620 7369 7465 7320 6174 0a20 2020   of sites at.   
+0005a7e0: 2020 2020 2020 2020 2077 6869 6368 2060           which `
+0005a7f0: 6061 6060 2061 6e64 2060 6064 6060 2061  `a`` and ``d`` a
+0005a800: 6772 6565 2062 7574 2064 6966 6665 7273  gree but differs
+0005a810: 2066 726f 6d20 6060 6260 6020 616e 6420   from ``b`` and 
+0005a820: 6060 6360 602c 2070 6572 0a20 2020 2020  ``c``, per.     
+0005a830: 2020 2020 2020 2075 6e69 7420 6f66 2063         unit of c
+0005a840: 6872 6f6d 6f73 6f6d 6520 6c65 6e67 7468  hromosome length
+0005a850: 2e0a 0a20 2020 2020 2020 2022 6272 616e  ...        "bran
+0005a860: 6368 220a 2020 2020 2020 2020 2020 2020  ch".            
+0005a870: 5468 6520 6176 6572 6167 6520 6c65 6e67  The average leng
+0005a880: 7468 206f 6620 616c 6c20 6272 616e 6368  th of all branch
+0005a890: 6573 2074 6861 7420 7365 7061 7261 7465  es that separate
+0005a8a0: 2060 6061 6060 2061 6e64 2060 6063 6060   ``a`` and ``c``
+0005a8b0: 0a20 2020 2020 2020 2020 2020 2066 726f  .            fro
+0005a8c0: 6d20 6060 6260 6020 616e 6420 6060 6460  m ``b`` and ``d`
+0005a8d0: 602c 206d 696e 7573 2074 6865 2061 7665  `, minus the ave
+0005a8e0: 7261 6765 206c 656e 6774 6820 6f66 2061  rage length of a
+0005a8f0: 6c6c 2062 7261 6e63 6865 7320 7468 6174  ll branches that
+0005a900: 0a20 2020 2020 2020 2020 2020 2073 6570  .            sep
+0005a910: 6172 6174 6520 6060 6160 6020 616e 6420  arate ``a`` and 
+0005a920: 6060 6460 6020 6672 6f6d 2060 6062 6060  ``d`` from ``b``
+0005a930: 2061 6e64 2060 6063 6060 2028 696e 2075   and ``c`` (in u
+0005a940: 6e69 7473 206f 6620 7469 6d65 292e 0a0a  nits of time)...
+0005a950: 2020 2020 2020 2020 226e 6f64 6522 0a20          "node". 
+0005a960: 2020 2020 2020 2020 2020 2046 6f72 2065             For e
+0005a970: 6163 6820 6e6f 6465 2c20 7468 6520 6176  ach node, the av
+0005a980: 6572 6167 6520 7072 6f70 6f72 7469 6f6e  erage proportion
+0005a990: 206f 6620 7468 6520 7769 6e64 6f77 206f   of the window o
+0005a9a0: 6e20 7768 6963 6820 6060 6160 6020 616e  n which ``a`` an
+0005a9b0: 6420 6060 6360 600a 2020 2020 2020 2020  d ``c``.        
+0005a9c0: 2020 2020 696e 6865 7269 7420 6672 6f6d      inherit from
+0005a9d0: 2074 6861 7420 6e6f 6465 2062 7574 2060   that node but `
+0005a9e0: 6062 6060 2061 6e64 2060 6064 6060 2064  `b`` and ``d`` d
+0005a9f0: 6f20 6e6f 742c 206f 7220 7669 6365 2d76  o not, or vice-v
+0005aa00: 6572 7361 2c0a 2020 2020 2020 2020 2020  ersa,.          
+0005aa10: 2020 6d69 6e75 7320 7468 6520 6176 6572    minus the aver
+0005aa20: 6167 6520 7072 6f70 6f72 7469 6f6e 206f  age proportion o
+0005aa30: 6620 7468 6520 7769 6e64 6f77 206f 6e20  f the window on 
+0005aa40: 7768 6963 6820 6060 6160 6020 616e 6420  which ``a`` and 
+0005aa50: 6060 6460 600a 2020 2020 2020 2020 2020  ``d``.          
+0005aa60: 2020 696e 6865 7269 7420 6672 6f6d 2074    inherit from t
+0005aa70: 6861 7420 6e6f 6465 2062 7574 2060 6062  hat node but ``b
+0005aa80: 6060 2061 6e64 2060 6063 6060 2064 6f20  `` and ``c`` do 
+0005aa90: 6e6f 742c 206f 7220 7669 6365 2d76 6572  not, or vice-ver
+0005aaa0: 7361 2e0a 0a20 2020 2020 2020 203a 7061  sa...        :pa
+0005aab0: 7261 6d20 6c69 7374 2073 616d 706c 655f  ram list sample_
+0005aac0: 7365 7473 3a20 4120 6c69 7374 206f 6620  sets: A list of 
+0005aad0: 6c69 7374 7320 6f66 204e 6f64 6520 4944  lists of Node ID
+0005aae0: 732c 2073 7065 6369 6679 696e 6720 7468  s, specifying th
+0005aaf0: 650a 2020 2020 2020 2020 2020 2020 6772  e.            gr
+0005ab00: 6f75 7073 206f 6620 6e6f 6465 7320 746f  oups of nodes to
+0005ab10: 2063 6f6d 7075 7465 2074 6865 2073 7461   compute the sta
+0005ab20: 7469 7374 6963 2077 6974 682e 0a20 2020  tistic with..   
+0005ab30: 2020 2020 203a 7061 7261 6d20 6c69 7374       :param list
+0005ab40: 2069 6e64 6578 6573 3a20 4120 6c69 7374   indexes: A list
+0005ab50: 206f 6620 342d 7475 706c 6573 2c20 6f72   of 4-tuples, or
+0005ab60: 204e 6f6e 652e 0a20 2020 2020 2020 203a   None..        :
+0005ab70: 7061 7261 6d20 6c69 7374 2077 696e 646f  param list windo
+0005ab80: 7773 3a20 416e 2069 6e63 7265 6173 696e  ws: An increasin
+0005ab90: 6720 6c69 7374 206f 6620 6272 6561 6b70  g list of breakp
+0005aba0: 6f69 6e74 7320 6265 7477 6565 6e20 7468  oints between th
+0005abb0: 6520 7769 6e64 6f77 730a 2020 2020 2020  e windows.      
+0005abc0: 2020 2020 2020 746f 2063 6f6d 7075 7465        to compute
+0005abd0: 2074 6865 2073 7461 7469 7374 6963 2069   the statistic i
+0005abe0: 6e2e 0a20 2020 2020 2020 203a 7061 7261  n..        :para
+0005abf0: 6d20 7374 7220 6d6f 6465 3a20 4120 7374  m str mode: A st
+0005ac00: 7269 6e67 2067 6976 696e 6720 7468 6520  ring giving the 
+0005ac10: 2274 7970 6522 206f 6620 7468 6520 7374  "type" of the st
+0005ac20: 6174 6973 7469 6320 746f 2062 6520 636f  atistic to be co
+0005ac30: 6d70 7574 6564 0a20 2020 2020 2020 2020  mputed.         
+0005ac40: 2020 2028 6465 6661 756c 7473 2074 6f20     (defaults to 
+0005ac50: 2273 6974 6522 292e 0a20 2020 2020 2020  "site")..       
+0005ac60: 203a 7061 7261 6d20 626f 6f6c 2073 7061   :param bool spa
+0005ac70: 6e5f 6e6f 726d 616c 6973 653a 2057 6865  n_normalise: Whe
+0005ac80: 7468 6572 2074 6f20 6469 7669 6465 2074  ther to divide t
+0005ac90: 6865 2072 6573 756c 7420 6279 2074 6865  he result by the
+0005aca0: 2073 7061 6e20 6f66 2074 6865 0a20 2020   span of the.   
+0005acb0: 2020 2020 2020 2020 2077 696e 646f 7720           window 
+0005acc0: 2864 6566 6175 6c74 7320 746f 2054 7275  (defaults to Tru
+0005acd0: 6529 2e0a 2020 2020 2020 2020 3a72 6574  e)..        :ret
+0005ace0: 7572 6e3a 2041 206e 6461 7272 6179 2077  urn: A ndarray w
+0005acf0: 6974 6820 7368 6170 6520 6571 7561 6c20  ith shape equal 
+0005ad00: 746f 2028 6e75 6d20 7769 6e64 6f77 732c  to (num windows,
+0005ad10: 206e 756d 2073 7461 7469 7374 6963 7329   num statistics)
+0005ad20: 2e0a 2020 2020 2020 2020 2020 2020 4966  ..            If
+0005ad30: 2074 6865 7265 2061 7265 2066 6f75 7220   there are four 
+0005ad40: 7361 6d70 6c65 2073 6574 7320 616e 6420  sample sets and 
+0005ad50: 7769 6e64 6f77 733d 4e6f 6e65 2c20 6120  windows=None, a 
+0005ad60: 6e75 6d70 7920 7363 616c 6172 2069 7320  numpy scalar is 
+0005ad70: 7265 7475 726e 6564 2e0a 2020 2020 2020  returned..      
+0005ad80: 2020 2222 220a 2020 2020 2020 2020 7265    """.        re
+0005ad90: 7475 726e 2073 656c 662e 5f5f 6b5f 7761  turn self.__k_wa
+0005ada0: 795f 7361 6d70 6c65 5f73 6574 5f73 7461  y_sample_set_sta
+0005adb0: 7428 0a20 2020 2020 2020 2020 2020 2073  t(.            s
+0005adc0: 656c 662e 5f6c 6c5f 7472 6565 5f73 6571  elf._ll_tree_seq
+0005add0: 7565 6e63 652e 6634 2c0a 2020 2020 2020  uence.f4,.      
+0005ade0: 2020 2020 2020 342c 0a20 2020 2020 2020        4,.       
+0005adf0: 2020 2020 2073 616d 706c 655f 7365 7473       sample_sets
+0005ae00: 2c0a 2020 2020 2020 2020 2020 2020 696e  ,.            in
+0005ae10: 6465 7865 733d 696e 6465 7865 732c 0a20  dexes=indexes,. 
+0005ae20: 2020 2020 2020 2020 2020 2077 696e 646f             windo
+0005ae30: 7773 3d77 696e 646f 7773 2c0a 2020 2020  ws=windows,.    
+0005ae40: 2020 2020 2020 2020 6d6f 6465 3d6d 6f64          mode=mod
+0005ae50: 652c 0a20 2020 2020 2020 2020 2020 2073  e,.            s
+0005ae60: 7061 6e5f 6e6f 726d 616c 6973 653d 7370  pan_normalise=sp
+0005ae70: 616e 5f6e 6f72 6d61 6c69 7365 2c0a 2020  an_normalise,.  
+0005ae80: 2020 2020 2020 290a 0a20 2020 2064 6566        )..    def
+0005ae90: 2066 3328 0a20 2020 2020 2020 2073 656c   f3(.        sel
+0005aea0: 662c 2073 616d 706c 655f 7365 7473 2c20  f, sample_sets, 
+0005aeb0: 696e 6465 7865 733d 4e6f 6e65 2c20 7769  indexes=None, wi
+0005aec0: 6e64 6f77 733d 4e6f 6e65 2c20 6d6f 6465  ndows=None, mode
+0005aed0: 3d22 7369 7465 222c 2073 7061 6e5f 6e6f  ="site", span_no
+0005aee0: 726d 616c 6973 653d 5472 7565 0a20 2020  rmalise=True.   
+0005aef0: 2029 3a0a 2020 2020 2020 2020 7222 2222   ):.        r"""
+0005af00: 0a20 2020 2020 2020 2043 6f6d 7075 7465  .        Compute
+0005af10: 7320 5061 7474 6572 736f 6e27 7320 6633  s Patterson's f3
+0005af20: 2073 7461 7469 7374 6963 2062 6574 7765   statistic betwe
+0005af30: 656e 2074 6872 6565 2067 726f 7570 7320  en three groups 
+0005af40: 6f66 206e 6f64 6573 2066 726f 6d0a 2020  of nodes from.  
+0005af50: 2020 2020 2020 6060 7361 6d70 6c65 5f73        ``sample_s
+0005af60: 6574 7360 602e 0a20 2020 2020 2020 204e  ets``..        N
+0005af70: 6f74 6520 7468 6174 2074 6865 206f 7264  ote that the ord
+0005af80: 6572 206f 6620 7468 6520 6172 6775 6d65  er of the argume
+0005af90: 6e74 7320 6f66 2066 3320 6469 6666 6572  nts of f3 differ
+0005afa0: 7320 6163 726f 7373 2074 6865 206c 6974  s across the lit
+0005afb0: 6572 6174 7572 653a 0a20 2020 2020 2020  erature:.       
+0005afc0: 2068 6572 652c 2060 6066 3328 5b41 2c20   here, ``f3([A, 
+0005afd0: 422c 2043 5d29 6060 2066 6f72 2073 616d  B, C])`` for sam
+0005afe0: 706c 6520 7365 7473 2060 6041 6060 2c20  ple sets ``A``, 
+0005aff0: 6060 4260 602c 2061 6e64 2060 6043 6060  ``B``, and ``C``
+0005b000: 0a20 2020 2020 2020 2077 696c 6c20 6573  .        will es
+0005b010: 7469 6d61 7465 0a20 2020 2020 2020 203a  timate.        :
+0005b020: 6d61 7468 3a60 665f 3328 413b 2042 2c20  math:`f_3(A; B, 
+0005b030: 4329 203d 205c 6d61 7468 6262 7b45 7d5b  C) = \mathbb{E}[
+0005b040: 2870 5f41 202d 2070 5f42 2920 2870 5f41  (p_A - p_B) (p_A
+0005b050: 202d 2070 5f43 295d 602c 0a20 2020 2020   - p_C)]`,.     
+0005b060: 2020 2077 6865 7265 203a 6d61 7468 3a60     where :math:`
+0005b070: 705f 4160 2069 7320 7468 6520 616c 6c65  p_A` is the alle
+0005b080: 6c65 2066 7265 7175 656e 6379 2069 6e20  le frequency in 
+0005b090: 6060 4160 602e 0a20 2020 2020 2020 2057  ``A``..        W
+0005b0a0: 6865 6e20 7573 6564 2061 7320 6120 7465  hen used as a te
+0005b0b0: 7374 2066 6f72 2061 646d 6978 7475 7265  st for admixture
+0005b0c0: 2c20 7468 6520 7075 7461 7469 7665 6c79  , the putatively
+0005b0d0: 2061 646d 6978 6564 2070 6f70 756c 6174   admixed populat
+0005b0e0: 696f 6e0a 2020 2020 2020 2020 6973 2075  ion.        is u
+0005b0f0: 7375 616c 6c79 2070 6c61 6365 6420 6173  sually placed as
+0005b100: 2070 6f70 756c 6174 696f 6e20 6060 4160   population ``A`
+0005b110: 6020 2873 6565 0a20 2020 2020 2020 2060  ` (see.        `
+0005b120: 5065 7465 7220 2832 3031 3629 203c 6874  Peter (2016) <ht
+0005b130: 7470 733a 2f2f 646f 692e 6f72 672f 3130  tps://doi.org/10
+0005b140: 2e31 3533 342f 6765 6e65 7469 6373 2e31  .1534/genetics.1
+0005b150: 3135 2e31 3833 3931 333e 605f 0a20 2020  15.183913>`_.   
+0005b160: 2020 2020 2066 6f72 206d 6f72 6520 6469       for more di
+0005b170: 7363 7573 7369 6f6e 292e 0a0a 2020 2020  scussion)...    
+0005b180: 2020 2020 4f70 6572 6174 6573 206f 6e20      Operates on 
+0005b190: 6060 6b20 3d20 3360 6020 7361 6d70 6c65  ``k = 3`` sample
+0005b1a0: 2073 6574 7320 6174 2061 2074 696d 653b   sets at a time;
+0005b1b0: 2070 6c65 6173 6520 7365 6520 7468 650a   please see the.
+0005b1c0: 2020 2020 2020 2020 3a72 6566 3a60 6d75          :ref:`mu
+0005b1d0: 6c74 692d 7761 7920 7374 6174 6973 7469  lti-way statisti
+0005b1e0: 6373 203c 7365 635f 7374 6174 735f 7361  cs <sec_stats_sa
+0005b1f0: 6d70 6c65 5f73 6574 735f 6d75 6c74 695f  mple_sets_multi_
+0005b200: 7761 793e 600a 2020 2020 2020 2020 7365  way>`.        se
+0005b210: 6374 696f 6e20 666f 7220 6465 7461 696c  ction for detail
+0005b220: 7320 6f6e 2068 6f77 2074 6865 2060 6073  s on how the ``s
+0005b230: 616d 706c 655f 7365 7473 6060 2061 6e64  ample_sets`` and
+0005b240: 2060 6069 6e64 6578 6573 6060 2061 7267   ``indexes`` arg
+0005b250: 756d 656e 7473 2061 7265 0a20 2020 2020  uments are.     
+0005b260: 2020 2069 6e74 6572 7072 6574 6564 2061     interpreted a
+0005b270: 6e64 2068 6f77 2074 6865 7920 696e 7465  nd how they inte
+0005b280: 7261 6374 2077 6974 6820 7468 6520 6469  ract with the di
+0005b290: 6d65 6e73 696f 6e73 206f 6620 7468 6520  mensions of the 
+0005b2a0: 6f75 7470 7574 2061 7272 6179 2e0a 2020  output array..  
+0005b2b0: 2020 2020 2020 5365 6520 7468 6520 3a72        See the :r
+0005b2c0: 6566 3a60 7374 6174 6973 7469 6373 2069  ef:`statistics i
+0005b2d0: 6e74 6572 6661 6365 203c 7365 635f 7374  nterface <sec_st
+0005b2e0: 6174 735f 696e 7465 7266 6163 653e 6020  ats_interface>` 
+0005b2f0: 7365 6374 696f 6e20 666f 7220 6465 7461  section for deta
+0005b300: 696c 7320 6f6e 0a20 2020 2020 2020 203a  ils on.        :
+0005b310: 7265 663a 6077 696e 646f 7773 203c 7365  ref:`windows <se
+0005b320: 635f 7374 6174 735f 7769 6e64 6f77 733e  c_stats_windows>
+0005b330: 602c 0a20 2020 2020 2020 203a 7265 663a  `,.        :ref:
+0005b340: 606d 6f64 6520 3c73 6563 5f73 7461 7473  `mode <sec_stats
+0005b350: 5f6d 6f64 653e 602c 0a20 2020 2020 2020  _mode>`,.       
+0005b360: 203a 7265 663a 6073 7061 6e20 6e6f 726d   :ref:`span norm
+0005b370: 616c 6973 6520 3c73 6563 5f73 7461 7473  alise <sec_stats
+0005b380: 5f73 7061 6e5f 6e6f 726d 616c 6973 653e  _span_normalise>
+0005b390: 602c 0a20 2020 2020 2020 2061 6e64 203a  `,.        and :
+0005b3a0: 7265 663a 6072 6574 7572 6e20 7661 6c75  ref:`return valu
+0005b3b0: 6520 3c73 6563 5f73 7461 7473 5f6f 7574  e <sec_stats_out
+0005b3c0: 7075 745f 666f 726d 6174 3e60 2e0a 0a20  put_format>`... 
+0005b3d0: 2020 2020 2020 2057 6861 7420 6973 2063         What is c
+0005b3e0: 6f6d 7075 7465 6420 6465 7065 6e64 7320  omputed depends 
+0005b3f0: 6f6e 2060 606d 6f64 6560 602e 2045 6163  on ``mode``. Eac
+0005b400: 6820 776f 726b 7320 6578 6163 746c 7920  h works exactly 
+0005b410: 6173 0a20 2020 2020 2020 203a 6d65 7468  as.        :meth
+0005b420: 3a60 6634 203c 2e54 7265 6553 6571 7565  :`f4 <.TreeSeque
+0005b430: 6e63 652e 6634 3e60 2c20 6578 6365 7074  nce.f4>`, except
+0005b440: 2074 6865 2061 7665 7261 6765 2069 7320   the average is 
+0005b450: 6163 726f 7373 2065 7665 7279 2070 6f73  across every pos
+0005b460: 7369 626c 650a 2020 2020 2020 2020 636f  sible.        co
+0005b470: 6d62 696e 6174 696f 6e20 6f66 2066 6f75  mbination of fou
+0005b480: 7220 7361 6d70 6c65 7320 6060 2861 312c  r samples ``(a1,
+0005b490: 2062 3b20 6132 2c20 6329 6060 2077 6865   b; a2, c)`` whe
+0005b4a0: 7265 2060 6131 6020 616e 6420 6061 3260  re `a1` and `a2`
+0005b4b0: 2068 6176 6520 626f 7468 0a20 2020 2020   have both.     
+0005b4c0: 2020 2062 6565 6e20 6368 6f73 656e 2028     been chosen (
+0005b4d0: 7769 7468 6f75 7420 7265 706c 6163 656d  without replacem
+0005b4e0: 656e 7429 2066 726f 6d20 7468 6520 6669  ent) from the fi
+0005b4f0: 7273 7420 7361 6d70 6c65 2073 6574 2e20  rst sample set. 
+0005b500: 5365 650a 2020 2020 2020 2020 3a6d 6574  See.        :met
+0005b510: 683a 6066 3420 3c2e 5472 6565 5365 7175  h:`f4 <.TreeSequ
+0005b520: 656e 6365 2e66 343e 6020 666f 7220 6d6f  ence.f4>` for mo
+0005b530: 7265 2064 6574 6169 6c73 2e0a 0a20 2020  re details...   
+0005b540: 2020 2020 203a 7061 7261 6d20 6c69 7374       :param list
+0005b550: 2073 616d 706c 655f 7365 7473 3a20 4120   sample_sets: A 
+0005b560: 6c69 7374 206f 6620 6c69 7374 7320 6f66  list of lists of
+0005b570: 204e 6f64 6520 4944 732c 2073 7065 6369   Node IDs, speci
+0005b580: 6679 696e 6720 7468 650a 2020 2020 2020  fying the.      
+0005b590: 2020 2020 2020 6772 6f75 7073 206f 6620        groups of 
+0005b5a0: 6e6f 6465 7320 746f 2063 6f6d 7075 7465  nodes to compute
+0005b5b0: 2074 6865 2073 7461 7469 7374 6963 2077   the statistic w
+0005b5c0: 6974 682e 0a20 2020 2020 2020 203a 7061  ith..        :pa
+0005b5d0: 7261 6d20 6c69 7374 2069 6e64 6578 6573  ram list indexes
+0005b5e0: 3a20 4120 6c69 7374 206f 6620 332d 7475  : A list of 3-tu
+0005b5f0: 706c 6573 2c20 6f72 204e 6f6e 652e 0a20  ples, or None.. 
+0005b600: 2020 2020 2020 203a 7061 7261 6d20 6c69         :param li
+0005b610: 7374 2077 696e 646f 7773 3a20 416e 2069  st windows: An i
+0005b620: 6e63 7265 6173 696e 6720 6c69 7374 206f  ncreasing list o
+0005b630: 6620 6272 6561 6b70 6f69 6e74 7320 6265  f breakpoints be
+0005b640: 7477 6565 6e20 7468 6520 7769 6e64 6f77  tween the window
+0005b650: 730a 2020 2020 2020 2020 2020 2020 746f  s.            to
+0005b660: 2063 6f6d 7075 7465 2074 6865 2073 7461   compute the sta
+0005b670: 7469 7374 6963 2069 6e2e 0a20 2020 2020  tistic in..     
+0005b680: 2020 203a 7061 7261 6d20 7374 7220 6d6f     :param str mo
+0005b690: 6465 3a20 4120 7374 7269 6e67 2067 6976  de: A string giv
+0005b6a0: 696e 6720 7468 6520 2274 7970 6522 206f  ing the "type" o
+0005b6b0: 6620 7468 6520 7374 6174 6973 7469 6320  f the statistic 
+0005b6c0: 746f 2062 6520 636f 6d70 7574 6564 0a20  to be computed. 
+0005b6d0: 2020 2020 2020 2020 2020 2028 6465 6661             (defa
+0005b6e0: 756c 7473 2074 6f20 2273 6974 6522 292e  ults to "site").
+0005b6f0: 0a20 2020 2020 2020 203a 7061 7261 6d20  .        :param 
+0005b700: 626f 6f6c 2073 7061 6e5f 6e6f 726d 616c  bool span_normal
+0005b710: 6973 653a 2057 6865 7468 6572 2074 6f20  ise: Whether to 
+0005b720: 6469 7669 6465 2074 6865 2072 6573 756c  divide the resul
+0005b730: 7420 6279 2074 6865 2073 7061 6e20 6f66  t by the span of
+0005b740: 2074 6865 0a20 2020 2020 2020 2020 2020   the.           
+0005b750: 2077 696e 646f 7720 2864 6566 6175 6c74   window (default
+0005b760: 7320 746f 2054 7275 6529 2e0a 2020 2020  s to True)..    
+0005b770: 2020 2020 3a72 6574 7572 6e3a 2041 206e      :return: A n
+0005b780: 6461 7272 6179 2077 6974 6820 7368 6170  darray with shap
+0005b790: 6520 6571 7561 6c20 746f 2028 6e75 6d20  e equal to (num 
+0005b7a0: 7769 6e64 6f77 732c 206e 756d 2073 7461  windows, num sta
+0005b7b0: 7469 7374 6963 7329 2e0a 2020 2020 2020  tistics)..      
+0005b7c0: 2020 2020 2020 4966 2074 6865 7265 2061        If there a
+0005b7d0: 7265 2074 6872 6565 2073 616d 706c 6520  re three sample 
+0005b7e0: 7365 7473 2061 6e64 2077 696e 646f 7773  sets and windows
+0005b7f0: 3d4e 6f6e 652c 2061 206e 756d 7079 2073  =None, a numpy s
+0005b800: 6361 6c61 7220 6973 2072 6574 7572 6e65  calar is returne
+0005b810: 642e 0a20 2020 2020 2020 2022 2222 0a20  d..        """. 
+0005b820: 2020 2020 2020 2072 6574 7572 6e20 7365         return se
+0005b830: 6c66 2e5f 5f6b 5f77 6179 5f73 616d 706c  lf.__k_way_sampl
+0005b840: 655f 7365 745f 7374 6174 280a 2020 2020  e_set_stat(.    
+0005b850: 2020 2020 2020 2020 7365 6c66 2e5f 6c6c          self._ll
+0005b860: 5f74 7265 655f 7365 7175 656e 6365 2e66  _tree_sequence.f
+0005b870: 332c 0a20 2020 2020 2020 2020 2020 2033  3,.            3
+0005b880: 2c0a 2020 2020 2020 2020 2020 2020 7361  ,.            sa
+0005b890: 6d70 6c65 5f73 6574 732c 0a20 2020 2020  mple_sets,.     
+0005b8a0: 2020 2020 2020 2069 6e64 6578 6573 3d69         indexes=i
+0005b8b0: 6e64 6578 6573 2c0a 2020 2020 2020 2020  ndexes,.        
+0005b8c0: 2020 2020 7769 6e64 6f77 733d 7769 6e64      windows=wind
+0005b8d0: 6f77 732c 0a20 2020 2020 2020 2020 2020  ows,.           
+0005b8e0: 206d 6f64 653d 6d6f 6465 2c0a 2020 2020   mode=mode,.    
+0005b8f0: 2020 2020 2020 2020 7370 616e 5f6e 6f72          span_nor
+0005b900: 6d61 6c69 7365 3d73 7061 6e5f 6e6f 726d  malise=span_norm
+0005b910: 616c 6973 652c 0a20 2020 2020 2020 2029  alise,.        )
+0005b920: 0a0a 2020 2020 6465 6620 6632 280a 2020  ..    def f2(.  
+0005b930: 2020 2020 2020 7365 6c66 2c20 7361 6d70        self, samp
+0005b940: 6c65 5f73 6574 732c 2069 6e64 6578 6573  le_sets, indexes
+0005b950: 3d4e 6f6e 652c 2077 696e 646f 7773 3d4e  =None, windows=N
+0005b960: 6f6e 652c 206d 6f64 653d 2273 6974 6522  one, mode="site"
+0005b970: 2c20 7370 616e 5f6e 6f72 6d61 6c69 7365  , span_normalise
+0005b980: 3d54 7275 650a 2020 2020 293a 0a20 2020  =True.    ):.   
+0005b990: 2020 2020 2022 2222 0a20 2020 2020 2020       """.       
+0005b9a0: 2043 6f6d 7075 7465 7320 5061 7474 6572   Computes Patter
+0005b9b0: 736f 6e27 7320 6632 2073 7461 7469 7374  son's f2 statist
+0005b9c0: 6963 2062 6574 7765 656e 2074 776f 2067  ic between two g
+0005b9d0: 726f 7570 7320 6f66 206e 6f64 6573 2066  roups of nodes f
+0005b9e0: 726f 6d0a 2020 2020 2020 2020 6060 7361  rom.        ``sa
+0005b9f0: 6d70 6c65 5f73 6574 7360 602e 0a20 2020  mple_sets``..   
+0005ba00: 2020 2020 204f 7065 7261 7465 7320 6f6e       Operates on
+0005ba10: 2060 606b 203d 2032 6060 2073 616d 706c   ``k = 2`` sampl
+0005ba20: 6520 7365 7473 2061 7420 6120 7469 6d65  e sets at a time
+0005ba30: 3b20 706c 6561 7365 2073 6565 2074 6865  ; please see the
+0005ba40: 0a20 2020 2020 2020 203a 7265 663a 606d  .        :ref:`m
+0005ba50: 756c 7469 2d77 6179 2073 7461 7469 7374  ulti-way statist
+0005ba60: 6963 7320 3c73 6563 5f73 7461 7473 5f73  ics <sec_stats_s
+0005ba70: 616d 706c 655f 7365 7473 5f6d 756c 7469  ample_sets_multi
+0005ba80: 5f77 6179 3e60 0a20 2020 2020 2020 2073  _way>`.        s
+0005ba90: 6563 7469 6f6e 2066 6f72 2064 6574 6169  ection for detai
+0005baa0: 6c73 206f 6e20 686f 7720 7468 6520 6060  ls on how the ``
+0005bab0: 7361 6d70 6c65 5f73 6574 7360 6020 616e  sample_sets`` an
+0005bac0: 6420 6060 696e 6465 7865 7360 6020 6172  d ``indexes`` ar
+0005bad0: 6775 6d65 6e74 7320 6172 650a 2020 2020  guments are.    
+0005bae0: 2020 2020 696e 7465 7270 7265 7465 6420      interpreted 
+0005baf0: 616e 6420 686f 7720 7468 6579 2069 6e74  and how they int
+0005bb00: 6572 6163 7420 7769 7468 2074 6865 2064  eract with the d
+0005bb10: 696d 656e 7369 6f6e 7320 6f66 2074 6865  imensions of the
+0005bb20: 206f 7574 7075 7420 6172 7261 792e 0a20   output array.. 
+0005bb30: 2020 2020 2020 2053 6565 2074 6865 203a         See the :
+0005bb40: 7265 663a 6073 7461 7469 7374 6963 7320  ref:`statistics 
+0005bb50: 696e 7465 7266 6163 6520 3c73 6563 5f73  interface <sec_s
+0005bb60: 7461 7473 5f69 6e74 6572 6661 6365 3e60  tats_interface>`
+0005bb70: 2073 6563 7469 6f6e 2066 6f72 2064 6574   section for det
+0005bb80: 6169 6c73 206f 6e0a 2020 2020 2020 2020  ails on.        
+0005bb90: 3a72 6566 3a60 7769 6e64 6f77 7320 3c73  :ref:`windows <s
+0005bba0: 6563 5f73 7461 7473 5f77 696e 646f 7773  ec_stats_windows
+0005bbb0: 3e60 2c0a 2020 2020 2020 2020 3a72 6566  >`,.        :ref
+0005bbc0: 3a60 6d6f 6465 203c 7365 635f 7374 6174  :`mode <sec_stat
+0005bbd0: 735f 6d6f 6465 3e60 2c0a 2020 2020 2020  s_mode>`,.      
+0005bbe0: 2020 3a72 6566 3a60 7370 616e 206e 6f72    :ref:`span nor
+0005bbf0: 6d61 6c69 7365 203c 7365 635f 7374 6174  malise <sec_stat
+0005bc00: 735f 7370 616e 5f6e 6f72 6d61 6c69 7365  s_span_normalise
+0005bc10: 3e60 2c0a 2020 2020 2020 2020 616e 6420  >`,.        and 
+0005bc20: 3a72 6566 3a60 7265 7475 726e 2076 616c  :ref:`return val
+0005bc30: 7565 203c 7365 635f 7374 6174 735f 6f75  ue <sec_stats_ou
+0005bc40: 7470 7574 5f66 6f72 6d61 743e 602e 0a0a  tput_format>`...
+0005bc50: 2020 2020 2020 2020 5768 6174 2069 7320          What is 
+0005bc60: 636f 6d70 7574 6564 2064 6570 656e 6473  computed depends
+0005bc70: 206f 6e20 6060 6d6f 6465 6060 2e20 4561   on ``mode``. Ea
+0005bc80: 6368 2077 6f72 6b73 2065 7861 6374 6c79  ch works exactly
+0005bc90: 2061 730a 2020 2020 2020 2020 3a6d 6574   as.        :met
+0005bca0: 683a 6066 3420 3c2e 5472 6565 5365 7175  h:`f4 <.TreeSequ
+0005bcb0: 656e 6365 2e66 343e 602c 2065 7863 6570  ence.f4>`, excep
+0005bcc0: 7420 7468 6520 6176 6572 6167 6520 6973  t the average is
+0005bcd0: 2061 6372 6f73 7320 6576 6572 7920 706f   across every po
+0005bce0: 7373 6962 6c65 0a20 2020 2020 2020 2063  ssible.        c
+0005bcf0: 6f6d 6269 6e61 7469 6f6e 206f 6620 666f  ombination of fo
+0005bd00: 7572 2073 616d 706c 6573 2060 6028 6131  ur samples ``(a1
+0005bd10: 2c20 6231 3b20 6132 2c20 6232 2960 6020  , b1; a2, b2)`` 
+0005bd20: 7768 6572 6520 6061 3160 2061 6e64 2060  where `a1` and `
+0005bd30: 6132 6020 6861 7665 0a20 2020 2020 2020  a2` have.       
+0005bd40: 2062 6f74 6820 6265 656e 2063 686f 7365   both been chose
+0005bd50: 6e20 2877 6974 686f 7574 2072 6570 6c61  n (without repla
+0005bd60: 6365 6d65 6e74 2920 6672 6f6d 2074 6865  cement) from the
+0005bd70: 2066 6972 7374 2073 616d 706c 6520 7365   first sample se
+0005bd80: 742c 2061 6e64 2060 6062 3160 600a 2020  t, and ``b1``.  
+0005bd90: 2020 2020 2020 616e 6420 6060 6232 6060        and ``b2``
+0005bda0: 2068 6176 6520 626f 7468 2062 6565 6e20   have both been 
+0005bdb0: 6368 6f73 656e 2028 7769 7468 6f75 7420  chosen (without 
+0005bdc0: 7265 706c 6163 656d 656e 7429 2066 726f  replacement) fro
+0005bdd0: 6d20 7468 6520 7365 636f 6e64 0a20 2020  m the second.   
+0005bde0: 2020 2020 2073 616d 706c 6520 7365 742e       sample set.
+0005bdf0: 2053 6565 203a 6d65 7468 3a60 6634 203c   See :meth:`f4 <
+0005be00: 2e54 7265 6553 6571 7565 6e63 652e 6634  .TreeSequence.f4
+0005be10: 3e60 2066 6f72 206d 6f72 6520 6465 7461  >` for more deta
+0005be20: 696c 732e 0a0a 2020 2020 2020 2020 3a70  ils...        :p
+0005be30: 6172 616d 206c 6973 7420 7361 6d70 6c65  aram list sample
+0005be40: 5f73 6574 733a 2041 206c 6973 7420 6f66  _sets: A list of
+0005be50: 206c 6973 7473 206f 6620 4e6f 6465 2049   lists of Node I
+0005be60: 4473 2c20 7370 6563 6966 7969 6e67 2074  Ds, specifying t
+0005be70: 6865 0a20 2020 2020 2020 2020 2020 2067  he.            g
+0005be80: 726f 7570 7320 6f66 206e 6f64 6573 2074  roups of nodes t
+0005be90: 6f20 636f 6d70 7574 6520 7468 6520 7374  o compute the st
+0005bea0: 6174 6973 7469 6320 7769 7468 2e0a 2020  atistic with..  
+0005beb0: 2020 2020 2020 3a70 6172 616d 206c 6973        :param lis
+0005bec0: 7420 696e 6465 7865 733a 2041 206c 6973  t indexes: A lis
+0005bed0: 7420 6f66 2032 2d74 7570 6c65 732c 206f  t of 2-tuples, o
+0005bee0: 7220 4e6f 6e65 2e0a 2020 2020 2020 2020  r None..        
+0005bef0: 3a70 6172 616d 206c 6973 7420 7769 6e64  :param list wind
+0005bf00: 6f77 733a 2041 6e20 696e 6372 6561 7369  ows: An increasi
+0005bf10: 6e67 206c 6973 7420 6f66 2062 7265 616b  ng list of break
+0005bf20: 706f 696e 7473 2062 6574 7765 656e 2074  points between t
+0005bf30: 6865 2077 696e 646f 7773 0a20 2020 2020  he windows.     
+0005bf40: 2020 2020 2020 2074 6f20 636f 6d70 7574         to comput
+0005bf50: 6520 7468 6520 7374 6174 6973 7469 6320  e the statistic 
+0005bf60: 696e 2e0a 2020 2020 2020 2020 3a70 6172  in..        :par
+0005bf70: 616d 2073 7472 206d 6f64 653a 2041 2073  am str mode: A s
+0005bf80: 7472 696e 6720 6769 7669 6e67 2074 6865  tring giving the
+0005bf90: 2022 7479 7065 2220 6f66 2074 6865 2073   "type" of the s
+0005bfa0: 7461 7469 7374 6963 2074 6f20 6265 2063  tatistic to be c
+0005bfb0: 6f6d 7075 7465 640a 2020 2020 2020 2020  omputed.        
+0005bfc0: 2020 2020 2864 6566 6175 6c74 7320 746f      (defaults to
+0005bfd0: 2022 7369 7465 2229 2e0a 2020 2020 2020   "site")..      
+0005bfe0: 2020 3a70 6172 616d 2062 6f6f 6c20 7370    :param bool sp
+0005bff0: 616e 5f6e 6f72 6d61 6c69 7365 3a20 5768  an_normalise: Wh
+0005c000: 6574 6865 7220 746f 2064 6976 6964 6520  ether to divide 
+0005c010: 7468 6520 7265 7375 6c74 2062 7920 7468  the result by th
+0005c020: 6520 7370 616e 206f 6620 7468 650a 2020  e span of the.  
+0005c030: 2020 2020 2020 2020 2020 7769 6e64 6f77            window
+0005c040: 2028 6465 6661 756c 7473 2074 6f20 5472   (defaults to Tr
+0005c050: 7565 292e 0a20 2020 2020 2020 203a 7265  ue)..        :re
+0005c060: 7475 726e 3a20 4120 6e64 6172 7261 7920  turn: A ndarray 
+0005c070: 7769 7468 2073 6861 7065 2065 7175 616c  with shape equal
+0005c080: 2074 6f20 286e 756d 2077 696e 646f 7773   to (num windows
+0005c090: 2c20 6e75 6d20 7374 6174 6973 7469 6373  , num statistics
+0005c0a0: 292e 0a20 2020 2020 2020 2020 2020 2049  )..            I
+0005c0b0: 6620 7468 6572 6520 6973 206f 6e65 2070  f there is one p
+0005c0c0: 6169 7220 6f66 2073 616d 706c 6520 7365  air of sample se
+0005c0d0: 7473 2061 6e64 2077 696e 646f 7773 3d4e  ts and windows=N
+0005c0e0: 6f6e 652c 2061 206e 756d 7079 2073 6361  one, a numpy sca
+0005c0f0: 6c61 7220 6973 0a20 2020 2020 2020 2020  lar is.         
+0005c100: 2020 2072 6574 7572 6e65 642e 0a20 2020     returned..   
+0005c110: 2020 2020 2022 2222 0a20 2020 2020 2020       """.       
+0005c120: 2072 6574 7572 6e20 7365 6c66 2e5f 5f6b   return self.__k
+0005c130: 5f77 6179 5f73 616d 706c 655f 7365 745f  _way_sample_set_
+0005c140: 7374 6174 280a 2020 2020 2020 2020 2020  stat(.          
+0005c150: 2020 7365 6c66 2e5f 6c6c 5f74 7265 655f    self._ll_tree_
+0005c160: 7365 7175 656e 6365 2e66 322c 0a20 2020  sequence.f2,.   
+0005c170: 2020 2020 2020 2020 2032 2c0a 2020 2020           2,.    
+0005c180: 2020 2020 2020 2020 7361 6d70 6c65 5f73          sample_s
+0005c190: 6574 732c 0a20 2020 2020 2020 2020 2020  ets,.           
+0005c1a0: 2069 6e64 6578 6573 3d69 6e64 6578 6573   indexes=indexes
+0005c1b0: 2c0a 2020 2020 2020 2020 2020 2020 7769  ,.            wi
+0005c1c0: 6e64 6f77 733d 7769 6e64 6f77 732c 0a20  ndows=windows,. 
+0005c1d0: 2020 2020 2020 2020 2020 206d 6f64 653d             mode=
+0005c1e0: 6d6f 6465 2c0a 2020 2020 2020 2020 2020  mode,.          
+0005c1f0: 2020 7370 616e 5f6e 6f72 6d61 6c69 7365    span_normalise
+0005c200: 3d73 7061 6e5f 6e6f 726d 616c 6973 652c  =span_normalise,
+0005c210: 0a20 2020 2020 2020 2029 0a0a 2020 2020  .        )..    
+0005c220: 6465 6620 6d65 616e 5f64 6573 6365 6e64  def mean_descend
+0005c230: 616e 7473 2873 656c 662c 2073 616d 706c  ants(self, sampl
+0005c240: 655f 7365 7473 293a 0a20 2020 2020 2020  e_sets):.       
+0005c250: 2022 2222 0a20 2020 2020 2020 2043 6f6d   """.        Com
+0005c260: 7075 7465 7320 666f 7220 6576 6572 7920  putes for every 
+0005c270: 6e6f 6465 2074 6865 206d 6561 6e20 6e75  node the mean nu
+0005c280: 6d62 6572 206f 6620 7361 6d70 6c65 7320  mber of samples 
+0005c290: 696e 2065 6163 6820 6f66 2074 6865 0a20  in each of the. 
+0005c2a0: 2020 2020 2020 2060 7361 6d70 6c65 5f73         `sample_s
+0005c2b0: 6574 7360 2074 6861 7420 6465 7363 656e  ets` that descen
+0005c2c0: 6420 6672 6f6d 2074 6861 7420 6e6f 6465  d from that node
+0005c2d0: 2c20 6176 6572 6167 6564 206f 7665 7220  , averaged over 
+0005c2e0: 7468 650a 2020 2020 2020 2020 706f 7274  the.        port
+0005c2f0: 696f 6e73 206f 6620 7468 6520 6765 6e6f  ions of the geno
+0005c300: 6d65 2066 6f72 2077 6869 6368 2074 6865  me for which the
+0005c310: 206e 6f64 6520 6973 2061 6e63 6573 7472   node is ancestr
+0005c320: 616c 2074 6f20 2a61 6e79 2a20 7361 6d70  al to *any* samp
+0005c330: 6c65 2e0a 2020 2020 2020 2020 5468 6520  le..        The 
+0005c340: 6f75 7470 7574 2069 7320 616e 2061 7272  output is an arr
+0005c350: 6179 2c20 6043 5b6e 6f64 652c 206a 5d60  ay, `C[node, j]`
+0005c360: 2c20 7768 6963 6820 7265 706f 7274 7320  , which reports 
+0005c370: 7468 6520 746f 7461 6c20 7370 616e 206f  the total span o
+0005c380: 660a 2020 2020 2020 2020 616c 6c20 6765  f.        all ge
+0005c390: 6e6f 6d65 7320 696e 2060 7361 6d70 6c65  nomes in `sample
+0005c3a0: 5f73 6574 735b 6a5d 6020 7468 6174 2069  _sets[j]` that i
+0005c3b0: 6e68 6572 6974 2066 726f 6d20 606e 6f64  nherit from `nod
+0005c3c0: 6560 2c20 6469 7669 6465 6420 6279 0a20  e`, divided by. 
+0005c3d0: 2020 2020 2020 2074 6865 2074 6f74 616c         the total
+0005c3e0: 2073 7061 6e20 6f66 2074 6865 2067 656e   span of the gen
+0005c3f0: 6f6d 6520 6f6e 2077 6869 6368 2060 6e6f  ome on which `no
+0005c400: 6465 6020 6973 2061 6e20 616e 6365 7374  de` is an ancest
+0005c410: 6f72 2074 6f20 616e 790a 2020 2020 2020  or to any.      
+0005c420: 2020 7361 6d70 6c65 2069 6e20 7468 6520    sample in the 
+0005c430: 7472 6565 2073 6571 7565 6e63 652e 0a0a  tree sequence...
+0005c440: 2020 2020 2020 2020 2e2e 2077 6172 6e69          .. warni
+0005c450: 6e67 3a3a 2054 6865 2069 6e74 6572 6661  ng:: The interfa
+0005c460: 6365 2066 6f72 2074 6869 7320 6d65 7468  ce for this meth
+0005c470: 6f64 2069 7320 7072 656c 696d 696e 6172  od is preliminar
+0005c480: 7920 616e 6420 6d61 7920 6265 2073 7562  y and may be sub
+0005c490: 6a65 6374 2074 6f0a 2020 2020 2020 2020  ject to.        
+0005c4a0: 2020 2020 6261 636b 7761 7264 7320 696e      backwards in
+0005c4b0: 636f 6d70 6174 6962 6c65 2063 6861 6e67  compatible chang
+0005c4c0: 6573 2069 6e20 7468 6520 6e65 6172 2066  es in the near f
+0005c4d0: 7574 7572 652e 2054 6865 206c 6f6e 672d  uture. The long-
+0005c4e0: 7465 726d 2073 7461 626c 650a 2020 2020  term stable.    
+0005c4f0: 2020 2020 2020 2020 4150 4920 666f 7220          API for 
+0005c500: 7468 6973 206d 6574 686f 6420 7769 6c6c  this method will
+0005c510: 2062 6520 636f 6e73 6973 7465 6e74 2077   be consistent w
+0005c520: 6974 6820 6f74 6865 7220 3a72 6566 3a60  ith other :ref:`
+0005c530: 7365 635f 7374 6174 7360 2e0a 2020 2020  sec_stats`..    
+0005c540: 2020 2020 2020 2020 496e 2070 6172 7469          In parti
+0005c550: 6375 6c61 722c 2074 6865 206e 6f72 6d61  cular, the norma
+0005c560: 6c69 7a61 7469 6f6e 2062 7920 7072 6f70  lization by prop
+0005c570: 6f72 7469 6f6e 206f 6620 7468 6520 6765  ortion of the ge
+0005c580: 6e6f 6d65 2074 6861 7420 606e 6f64 6560  nome that `node`
+0005c590: 0a20 2020 2020 2020 2020 2020 2069 7320  .            is 
+0005c5a0: 616e 2061 6e63 6573 746f 7220 746f 2061  an ancestor to a
+0005c5b0: 6e79 6f6e 6520 6d61 7920 6e6f 7420 6265  nyone may not be
+0005c5c0: 2074 6865 2064 6566 6175 6c74 2062 6568   the default beh
+0005c5d0: 6176 696f 7572 2069 6e20 7468 6520 6675  aviour in the fu
+0005c5e0: 7475 7265 2e0a 0a20 2020 2020 2020 203a  ture...        :
+0005c5f0: 7061 7261 6d20 6c69 7374 2073 616d 706c  param list sampl
+0005c600: 655f 7365 7473 3a20 4120 6c69 7374 206f  e_sets: A list o
+0005c610: 6620 6c69 7374 7320 6f66 206e 6f64 6520  f lists of node 
+0005c620: 4944 732e 0a20 2020 2020 2020 203a 7265  IDs..        :re
+0005c630: 7475 726e 3a20 416e 2061 7272 6179 2077  turn: An array w
+0005c640: 6974 6820 6469 6d65 6e73 696f 6e73 2028  ith dimensions (
+0005c650: 6e75 6d62 6572 206f 6620 6e6f 6465 7320  number of nodes 
+0005c660: 696e 2074 6865 2074 7265 6520 7365 7175  in the tree sequ
+0005c670: 656e 6365 2c0a 2020 2020 2020 2020 2020  ence,.          
+0005c680: 2020 6e75 6d62 6572 206f 6620 7265 6665    number of refe
+0005c690: 7265 6e63 6520 7365 7473 290a 2020 2020  rence sets).    
+0005c6a0: 2020 2020 2222 220a 2020 2020 2020 2020      """.        
+0005c6b0: 7265 7475 726e 2073 656c 662e 5f6c 6c5f  return self._ll_
+0005c6c0: 7472 6565 5f73 6571 7565 6e63 652e 6d65  tree_sequence.me
+0005c6d0: 616e 5f64 6573 6365 6e64 616e 7473 2873  an_descendants(s
+0005c6e0: 616d 706c 655f 7365 7473 290a 0a20 2020  ample_sets)..   
+0005c6f0: 2064 6566 2067 656e 6561 6c6f 6769 6361   def genealogica
+0005c700: 6c5f 6e65 6172 6573 745f 6e65 6967 6862  l_nearest_neighb
+0005c710: 6f75 7273 2873 656c 662c 2066 6f63 616c  ours(self, focal
+0005c720: 2c20 7361 6d70 6c65 5f73 6574 732c 206e  , sample_sets, n
+0005c730: 756d 5f74 6872 6561 6473 3d30 293a 0a20  um_threads=0):. 
+0005c740: 2020 2020 2020 2022 2222 0a20 2020 2020         """.     
+0005c750: 2020 2052 6574 7572 6e20 7468 6520 6765     Return the ge
+0005c760: 6e65 616c 6f67 6963 616c 206e 6561 7265  nealogical neare
+0005c770: 7374 206e 6569 6768 626f 7572 7320 2847  st neighbours (G
+0005c780: 4e4e 2920 7072 6f70 6f72 7469 6f6e 7320  NN) proportions 
+0005c790: 666f 7220 7468 6520 6769 7665 6e0a 2020  for the given.  
+0005c7a0: 2020 2020 2020 666f 6361 6c20 6e6f 6465        focal node
+0005c7b0: 732c 2077 6974 6820 7265 6665 7265 6e63  s, with referenc
+0005c7c0: 6520 746f 2074 776f 206f 7220 6d6f 7265  e to two or more
+0005c7d0: 2073 6574 7320 6f66 2069 6e74 6572 6573   sets of interes
+0005c7e0: 742c 2061 7665 7261 6765 6420 6f76 6572  t, averaged over
+0005c7f0: 2061 6c6c 0a20 2020 2020 2020 2074 7265   all.        tre
+0005c800: 6573 2069 6e20 7468 6520 7472 6565 2073  es in the tree s
+0005c810: 6571 7565 6e63 652e 0a0a 2020 2020 2020  equence...      
+0005c820: 2020 5468 6520 474e 4e20 7072 6f70 6f72    The GNN propor
+0005c830: 7469 6f6e 7320 666f 7220 6120 666f 6361  tions for a foca
+0005c840: 6c20 6e6f 6465 2069 6e20 6120 7369 6e67  l node in a sing
+0005c850: 6c65 2074 7265 6520 6172 6520 6769 7665  le tree are give
+0005c860: 6e20 6279 2066 6972 7374 2066 696e 6469  n by first findi
+0005c870: 6e67 0a20 2020 2020 2020 2074 6865 206d  ng.        the m
+0005c880: 6f73 7420 7265 6365 6e74 2063 6f6d 6d6f  ost recent commo
+0005c890: 6e20 616e 6365 7374 7261 6c20 6e6f 6465  n ancestral node
+0005c8a0: 203a 6d61 7468 3a60 6160 2062 6574 7765   :math:`a` betwe
+0005c8b0: 656e 2074 6865 2066 6f63 616c 206e 6f64  en the focal nod
+0005c8c0: 6520 616e 6420 616e 790a 2020 2020 2020  e and any.      
+0005c8d0: 2020 6f74 6865 7220 6e6f 6465 2070 7265    other node pre
+0005c8e0: 7365 6e74 2069 6e20 7468 6520 7265 6665  sent in the refe
+0005c8f0: 7265 6e63 6520 7365 7473 2e20 5468 6520  rence sets. The 
+0005c900: 474e 4e20 7072 6f70 6f72 7469 6f6e 2066  GNN proportion f
+0005c910: 6f72 2061 2073 7065 6369 6669 630a 2020  or a specific.  
+0005c920: 2020 2020 2020 7265 6665 7265 6e63 6520        reference 
+0005c930: 7365 742c 203a 6d61 7468 3a60 5360 2069  set, :math:`S` i
+0005c940: 7320 7468 6520 6e75 6d62 6572 206f 6620  s the number of 
+0005c950: 6e6f 6465 7320 696e 203a 6d61 7468 3a60  nodes in :math:`
+0005c960: 5360 2074 6861 7420 6465 7363 656e 6420  S` that descend 
+0005c970: 6672 6f6d 0a20 2020 2020 2020 203a 6d61  from.        :ma
+0005c980: 7468 3a60 6160 2c20 6173 2061 2070 726f  th:`a`, as a pro
+0005c990: 706f 7274 696f 6e20 6f66 2074 6865 2074  portion of the t
+0005c9a0: 6f74 616c 206e 756d 6265 7220 6f66 2064  otal number of d
+0005c9b0: 6573 6365 6e64 616e 7420 6e6f 6465 7320  escendant nodes 
+0005c9c0: 696e 2061 6e79 206f 6620 7468 650a 2020  in any of the.  
+0005c9d0: 2020 2020 2020 7265 6665 7265 6e63 6520        reference 
+0005c9e0: 7365 7473 2e0a 0a20 2020 2020 2020 2046  sets...        F
+0005c9f0: 6f72 2065 7861 6d70 6c65 2c20 636f 6e73  or example, cons
+0005ca00: 6964 6572 2061 2063 6173 6520 7769 7468  ider a case with
+0005ca10: 2032 2073 616d 706c 6520 7365 7473 2c20   2 sample sets, 
+0005ca20: 3a6d 6174 683a 6053 5f31 6020 616e 6420  :math:`S_1` and 
+0005ca30: 3a6d 6174 683a 6053 5f32 602e 0a20 2020  :math:`S_2`..   
+0005ca40: 2020 2020 2046 6f72 2061 2067 6976 656e       For a given
+0005ca50: 2074 7265 652c 203a 6d61 7468 3a60 6160   tree, :math:`a`
+0005ca60: 2069 7320 7468 6520 6e6f 6465 2074 6861   is the node tha
+0005ca70: 7420 696e 636c 7564 6573 2061 7420 6c65  t includes at le
+0005ca80: 6173 7420 6f6e 6520 6465 7363 656e 6461  ast one descenda
+0005ca90: 6e74 2069 6e0a 2020 2020 2020 2020 3a6d  nt in.        :m
+0005caa0: 6174 683a 6053 5f31 6020 6f72 203a 6d61  ath:`S_1` or :ma
+0005cab0: 7468 3a60 535f 3260 2028 6e6f 7420 696e  th:`S_2` (not in
+0005cac0: 636c 7564 696e 6720 7468 6520 666f 6361  cluding the foca
+0005cad0: 6c20 6e6f 6465 292e 2049 6620 7468 6520  l node). If the 
+0005cae0: 6465 7363 656e 6461 6e74 7320 6f66 0a20  descendants of. 
+0005caf0: 2020 2020 2020 203a 6d61 7468 3a60 6160         :math:`a`
+0005cb00: 2069 6e63 6c75 6465 2073 6f6d 6520 6e6f   include some no
+0005cb10: 6465 7320 696e 203a 6d61 7468 3a60 535f  des in :math:`S_
+0005cb20: 3160 2062 7574 206e 6f20 6e6f 6465 7320  1` but no nodes 
+0005cb30: 696e 203a 6d61 7468 3a60 535f 3260 2c20  in :math:`S_2`, 
+0005cb40: 7468 656e 2074 6865 0a20 2020 2020 2020  then the.       
+0005cb50: 2047 4e4e 2070 726f 706f 7274 696f 6e73   GNN proportions
+0005cb60: 2066 6f72 2074 6861 7420 7472 6565 2077   for that tree w
+0005cb70: 696c 6c20 6265 2031 3030 2520 3a6d 6174  ill be 100% :mat
+0005cb80: 683a 6053 5f31 6020 616e 6420 3025 203a  h:`S_1` and 0% :
+0005cb90: 6d61 7468 3a60 535f 3260 2c20 6f72 0a20  math:`S_2`, or. 
+0005cba0: 2020 2020 2020 203a 6d61 7468 3a60 5b31         :math:`[1
+0005cbb0: 2e30 2c20 302e 305d 602e 0a0a 2020 2020  .0, 0.0]`...    
+0005cbc0: 2020 2020 466f 7220 6120 6769 7665 6e20      For a given 
+0005cbd0: 666f 6361 6c20 6e6f 6465 2c20 7468 6520  focal node, the 
+0005cbe0: 474e 4e20 7072 6f70 6f72 7469 6f6e 7320  GNN proportions 
+0005cbf0: 7265 7475 726e 6564 2062 7920 7468 6973  returned by this
+0005cc00: 2066 756e 6374 696f 6e20 6172 6520 616e   function are an
+0005cc10: 0a20 2020 2020 2020 2061 7665 7261 6765  .        average
+0005cc20: 206f 6620 7468 6520 474e 4e73 2066 6f72   of the GNNs for
+0005cc30: 2065 6163 6820 7472 6565 2c20 7765 6967   each tree, weig
+0005cc40: 6874 6564 2062 7920 7468 6520 6765 6e6f  hted by the geno
+0005cc50: 6d69 6320 6469 7374 616e 6365 2073 7061  mic distance spa
+0005cc60: 6e6e 6564 2062 790a 2020 2020 2020 2020  nned by.        
+0005cc70: 7468 6174 2074 7265 652e 0a0a 2020 2020  that tree...    
+0005cc80: 2020 2020 466f 7220 616e 2070 7265 6369      For an preci
+0005cc90: 7365 206d 6174 6865 6d61 7469 6361 6c20  se mathematical 
+0005cca0: 6465 6669 6e69 7469 6f6e 206f 6620 474e  definition of GN
+0005ccb0: 4e2c 2073 6565 2068 7474 7073 3a2f 2f64  N, see https://d
+0005ccc0: 6f69 2e6f 7267 2f31 302e 3131 3031 2f34  oi.org/10.1101/4
+0005ccd0: 3538 3036 370a 0a20 2020 2020 2020 202e  58067..        .
+0005cce0: 2e20 6e6f 7465 3a3a 2054 6865 2072 6566  . note:: The ref
+0005ccf0: 6572 656e 6365 2073 6574 7320 6e65 6564  erence sets need
+0005cd00: 206e 6f74 2069 6e63 6c75 6465 2061 6c6c   not include all
+0005cd10: 2074 6865 2073 616d 706c 6573 2c20 6865   the samples, he
+0005cd20: 6e63 6520 7468 6520 6d6f 7374 0a20 2020  nce the most.   
+0005cd30: 2020 2020 2020 2020 2072 6563 656e 7420           recent 
+0005cd40: 636f 6d6d 6f6e 2061 6e63 6573 7472 616c  common ancestral
+0005cd50: 206e 6f64 6520 6f66 2074 6865 2072 6566   node of the ref
+0005cd60: 6572 656e 6365 2073 6574 732c 203a 6d61  erence sets, :ma
+0005cd70: 7468 3a60 6160 2c20 6e65 6564 206e 6f74  th:`a`, need not
+0005cd80: 2062 650a 2020 2020 2020 2020 2020 2020   be.            
+0005cd90: 7468 6520 696d 6d65 6469 6174 6520 616e  the immediate an
+0005cda0: 6365 7374 6f72 206f 6620 7468 6520 666f  cestor of the fo
+0005cdb0: 6361 6c20 6e6f 6465 2e20 4966 2074 6865  cal node. If the
+0005cdc0: 2072 6566 6572 656e 6365 2073 6574 7320   reference sets 
+0005cdd0: 6f6e 6c79 2063 6f6d 7072 6973 650a 2020  only comprise.  
+0005cde0: 2020 2020 2020 2020 2020 7365 7175 656e            sequen
+0005cdf0: 6365 7320 6672 6f6d 2072 656c 6174 6976  ces from relativ
+0005ce00: 656c 7920 6469 7374 616e 7420 696e 6469  ely distant indi
+0005ce10: 7669 6475 616c 732c 2074 6865 2047 4e4e  viduals, the GNN
+0005ce20: 2073 7461 7469 7374 6963 206d 6179 2065   statistic may e
+0005ce30: 6e64 2075 700a 2020 2020 2020 2020 2020  nd up.          
+0005ce40: 2020 6173 2061 206d 6561 7375 7265 206f    as a measure o
+0005ce50: 6620 636f 6d70 6172 6174 6976 656c 7920  f comparatively 
+0005ce60: 6469 7374 616e 7420 616e 6365 7374 7279  distant ancestry
+0005ce70: 2c20 6576 656e 2066 6f72 2074 7265 6520  , even for tree 
+0005ce80: 7365 7175 656e 6365 7320 7468 6174 0a20  sequences that. 
+0005ce90: 2020 2020 2020 2020 2020 2063 6f6e 7461             conta
+0005cea0: 696e 206d 616e 7920 636c 6f73 656c 7920  in many closely 
+0005ceb0: 7265 6c61 7465 6420 696e 6469 7669 6475  related individu
+0005cec0: 616c 732e 0a0a 2020 2020 2020 2020 2e2e  als...        ..
+0005ced0: 2077 6172 6e69 6e67 3a3a 2054 6865 2069   warning:: The i
+0005cee0: 6e74 6572 6661 6365 2066 6f72 2074 6869  nterface for thi
+0005cef0: 7320 6d65 7468 6f64 2069 7320 7072 656c  s method is prel
+0005cf00: 696d 696e 6172 7920 616e 6420 6d61 7920  iminary and may 
+0005cf10: 6265 2073 7562 6a65 6374 2074 6f0a 2020  be subject to.  
+0005cf20: 2020 2020 2020 2020 2020 6261 636b 7761            backwa
+0005cf30: 7264 7320 696e 636f 6d70 6174 6962 6c65  rds incompatible
+0005cf40: 2063 6861 6e67 6573 2069 6e20 7468 6520   changes in the 
+0005cf50: 6e65 6172 2066 7574 7572 652e 2054 6865  near future. The
+0005cf60: 206c 6f6e 672d 7465 726d 2073 7461 626c   long-term stabl
+0005cf70: 650a 2020 2020 2020 2020 2020 2020 4150  e.            AP
+0005cf80: 4920 666f 7220 7468 6973 206d 6574 686f  I for this metho
+0005cf90: 6420 7769 6c6c 2062 6520 636f 6e73 6973  d will be consis
+0005cfa0: 7465 6e74 2077 6974 6820 6f74 6865 7220  tent with other 
+0005cfb0: 3a72 6566 3a60 7365 635f 7374 6174 7360  :ref:`sec_stats`
+0005cfc0: 2e0a 0a20 2020 2020 2020 203a 7061 7261  ...        :para
+0005cfd0: 6d20 6c69 7374 2066 6f63 616c 3a20 4120  m list focal: A 
+0005cfe0: 6c69 7374 206f 6620 3a6d 6174 683a 606e  list of :math:`n
+0005cff0: 6020 6e6f 6465 7320 7768 6f73 6520 474e  ` nodes whose GN
+0005d000: 4e73 2073 686f 756c 6420 6265 2063 616c  Ns should be cal
+0005d010: 6375 6c61 7465 642e 0a20 2020 2020 2020  culated..       
+0005d020: 203a 7061 7261 6d20 6c69 7374 2073 616d   :param list sam
+0005d030: 706c 655f 7365 7473 3a20 4120 6c69 7374  ple_sets: A list
+0005d040: 206f 6620 3a6d 6174 683a 606d 6020 6c69   of :math:`m` li
+0005d050: 7374 7320 6f66 206e 6f64 6520 4944 732e  sts of node IDs.
+0005d060: 0a20 2020 2020 2020 203a 7265 7475 726e  .        :return
+0005d070: 3a20 416e 203a 6d61 7468 3a60 6e60 2020  : An :math:`n`  
+0005d080: 6279 203a 6d61 7468 3a60 6d60 2061 7272  by :math:`m` arr
+0005d090: 6179 206f 6620 666f 6361 6c20 6e6f 6465  ay of focal node
+0005d0a0: 7320 6279 2047 4e4e 2070 726f 706f 7274  s by GNN proport
+0005d0b0: 696f 6e73 2e0a 2020 2020 2020 2020 2020  ions..          
+0005d0c0: 2020 4576 6572 7920 666f 6361 6c20 6e6f    Every focal no
+0005d0d0: 6465 2063 6f72 7265 7370 6f6e 6473 2074  de corresponds t
+0005d0e0: 6f20 6120 726f 772e 2054 6865 206e 756d  o a row. The num
+0005d0f0: 6265 7273 2069 6e20 6561 6368 0a20 2020  bers in each.   
+0005d100: 2020 2020 2020 2020 2072 6f77 2063 6f72           row cor
+0005d110: 7265 7370 6f6e 6469 6e67 2074 6f20 7468  responding to th
+0005d120: 6520 474e 4e20 7072 6f70 6f72 7469 6f6e  e GNN proportion
+0005d130: 2066 6f72 2065 6163 6820 6f66 2074 6865   for each of the
+0005d140: 2070 6173 7365 642d 696e 2072 6566 6572   passed-in refer
+0005d150: 656e 6365 0a20 2020 2020 2020 2020 2020  ence.           
+0005d160: 2073 6574 732e 2052 6f77 7320 7468 6572   sets. Rows ther
+0005d170: 6566 6f72 6520 7375 6d20 746f 206f 6e65  efore sum to one
+0005d180: 2e0a 2020 2020 2020 2020 3a72 7479 7065  ..        :rtype
+0005d190: 3a20 6e75 6d70 792e 6e64 6172 7261 790a  : numpy.ndarray.
+0005d1a0: 2020 2020 2020 2020 2222 220a 2020 2020          """.    
+0005d1b0: 2020 2020 2320 544f 444f 2061 6464 2077      # TODO add w
+0005d1c0: 696e 646f 7773 3d4e 6f6e 6520 6f70 7469  indows=None opti
+0005d1d0: 6f6e 3a20 6874 7470 733a 2f2f 6769 7468  on: https://gith
+0005d1e0: 7562 2e63 6f6d 2f74 736b 6974 2d64 6576  ub.com/tskit-dev
+0005d1f0: 2f74 736b 6974 2f69 7373 7565 732f 3139  /tskit/issues/19
+0005d200: 330a 2020 2020 2020 2020 6966 206e 756d  3.        if num
+0005d210: 5f74 6872 6561 6473 203c 3d20 303a 0a20  _threads <= 0:. 
+0005d220: 2020 2020 2020 2020 2020 2072 6574 7572             retur
+0005d230: 6e20 7365 6c66 2e5f 6c6c 5f74 7265 655f  n self._ll_tree_
+0005d240: 7365 7175 656e 6365 2e67 656e 6561 6c6f  sequence.genealo
+0005d250: 6769 6361 6c5f 6e65 6172 6573 745f 6e65  gical_nearest_ne
+0005d260: 6967 6862 6f75 7273 280a 2020 2020 2020  ighbours(.      
+0005d270: 2020 2020 2020 2020 2020 666f 6361 6c2c            focal,
+0005d280: 2073 616d 706c 655f 7365 7473 0a20 2020   sample_sets.   
+0005d290: 2020 2020 2020 2020 2029 0a20 2020 2020           ).     
+0005d2a0: 2020 2065 6c73 653a 0a20 2020 2020 2020     else:.       
+0005d2b0: 2020 2020 2077 6f72 6b65 7220 3d20 6675       worker = fu
+0005d2c0: 6e63 746f 6f6c 732e 7061 7274 6961 6c28  nctools.partial(
+0005d2d0: 0a20 2020 2020 2020 2020 2020 2020 2020  .               
+0005d2e0: 2073 656c 662e 5f6c 6c5f 7472 6565 5f73   self._ll_tree_s
+0005d2f0: 6571 7565 6e63 652e 6765 6e65 616c 6f67  equence.genealog
+0005d300: 6963 616c 5f6e 6561 7265 7374 5f6e 6569  ical_nearest_nei
+0005d310: 6768 626f 7572 732c 0a20 2020 2020 2020  ghbours,.       
+0005d320: 2020 2020 2020 2020 2072 6566 6572 656e           referen
+0005d330: 6365 5f73 6574 733d 7361 6d70 6c65 5f73  ce_sets=sample_s
+0005d340: 6574 732c 0a20 2020 2020 2020 2020 2020  ets,.           
+0005d350: 2029 0a20 2020 2020 2020 2020 2020 2066   ).            f
+0005d360: 6f63 616c 203d 2075 7469 6c2e 7361 6665  ocal = util.safe
+0005d370: 5f6e 705f 696e 745f 6361 7374 2866 6f63  _np_int_cast(foc
+0005d380: 616c 2c20 6e70 2e69 6e74 3332 290a 2020  al, np.int32).  
+0005d390: 2020 2020 2020 2020 2020 7370 6c69 7473            splits
+0005d3a0: 203d 206e 702e 6172 7261 795f 7370 6c69   = np.array_spli
+0005d3b0: 7428 666f 6361 6c2c 206e 756d 5f74 6872  t(focal, num_thr
+0005d3c0: 6561 6473 290a 2020 2020 2020 2020 2020  eads).          
+0005d3d0: 2020 7769 7468 2063 6f6e 6375 7272 656e    with concurren
+0005d3e0: 742e 6675 7475 7265 732e 5468 7265 6164  t.futures.Thread
+0005d3f0: 506f 6f6c 4578 6563 7574 6f72 286d 6178  PoolExecutor(max
+0005d400: 5f77 6f72 6b65 7273 3d6e 756d 5f74 6872  _workers=num_thr
+0005d410: 6561 6473 2920 6173 2070 6f6f 6c3a 0a20  eads) as pool:. 
+0005d420: 2020 2020 2020 2020 2020 2020 2020 2061                 a
+0005d430: 7272 6179 7320 3d20 706f 6f6c 2e6d 6170  rrays = pool.map
+0005d440: 2877 6f72 6b65 722c 2073 706c 6974 7329  (worker, splits)
+0005d450: 0a20 2020 2020 2020 2020 2020 2072 6574  .            ret
+0005d460: 7572 6e20 6e70 2e76 7374 6163 6b28 6c69  urn np.vstack(li
+0005d470: 7374 2861 7272 6179 7329 290a 0a20 2020  st(arrays))..   
+0005d480: 2064 6566 206b 635f 6469 7374 616e 6365   def kc_distance
+0005d490: 2873 656c 662c 206f 7468 6572 2c20 6c61  (self, other, la
+0005d4a0: 6d62 6461 5f3d 302e 3029 3a0a 2020 2020  mbda_=0.0):.    
+0005d4b0: 2020 2020 2222 220a 2020 2020 2020 2020      """.        
+0005d4c0: 5265 7475 726e 7320 7468 6520 6176 6572  Returns the aver
+0005d4d0: 6167 6520 3a6d 6574 683a 6054 7265 652e  age :meth:`Tree.
+0005d4e0: 6b63 5f64 6973 7461 6e63 6560 2062 6574  kc_distance` bet
+0005d4f0: 7765 656e 2070 6169 7273 206f 6620 7472  ween pairs of tr
+0005d500: 6565 7320 616c 6f6e 670a 2020 2020 2020  ees along.      
+0005d510: 2020 7468 6520 7365 7175 656e 6365 2077    the sequence w
+0005d520: 686f 7365 2069 6e74 6572 7661 6c73 206f  hose intervals o
+0005d530: 7665 726c 6170 2e20 5468 6520 6176 6572  verlap. The aver
+0005d540: 6167 6520 6973 2077 6569 6768 7465 6420  age is weighted 
+0005d550: 6279 2074 6865 0a20 2020 2020 2020 2066  by the.        f
+0005d560: 7261 6374 696f 6e20 6f66 2074 6865 2073  raction of the s
+0005d570: 6571 7565 6e63 6520 6f6e 2077 6869 6368  equence on which
+0005d580: 2065 6163 6820 7061 6972 206f 6620 7472   each pair of tr
+0005d590: 6565 7320 6f76 6572 6c61 702e 0a0a 2020  ees overlap...  
+0005d5a0: 2020 2020 2020 3a70 6172 616d 2054 7265        :param Tre
+0005d5b0: 6553 6571 7565 6e63 6520 6f74 6865 723a  eSequence other:
+0005d5c0: 2054 6865 206f 7468 6572 2074 7265 6520   The other tree 
+0005d5d0: 7365 7175 656e 6365 2074 6f20 636f 6d70  sequence to comp
+0005d5e0: 6172 6520 746f 2e0a 2020 2020 2020 2020  are to..        
+0005d5f0: 3a70 6172 616d 2066 6c6f 6174 206c 616d  :param float lam
+0005d600: 6264 615f 3a20 5468 6520 4b43 206d 6574  bda_: The KC met
+0005d610: 7269 6320 6c61 6d62 6461 2070 6172 616d  ric lambda param
+0005d620: 6574 6572 2064 6574 6572 6d69 6e69 6e67  eter determining
+0005d630: 2074 6865 0a20 2020 2020 2020 2020 2020   the.           
+0005d640: 2072 656c 6174 6976 6520 7765 6967 6874   relative weight
+0005d650: 206f 6620 746f 706f 6c6f 6779 2061 6e64   of topology and
+0005d660: 2062 7261 6e63 6820 6c65 6e67 7468 2e0a   branch length..
+0005d670: 2020 2020 2020 2020 3a72 6574 7572 6e3a          :return:
+0005d680: 2054 6865 2063 6f6d 7075 7465 6420 4b43   The computed KC
+0005d690: 2064 6973 7461 6e63 6520 6265 7477 6565   distance betwee
+0005d6a0: 6e20 7468 6973 2074 7265 6520 7365 7175  n this tree sequ
+0005d6b0: 656e 6365 2061 6e64 206f 7468 6572 2e0a  ence and other..
+0005d6c0: 2020 2020 2020 2020 3a72 7479 7065 3a20          :rtype: 
+0005d6d0: 666c 6f61 740a 2020 2020 2020 2020 2222  float.        ""
+0005d6e0: 220a 2020 2020 2020 2020 7265 7475 726e  ".        return
+0005d6f0: 2073 656c 662e 5f6c 6c5f 7472 6565 5f73   self._ll_tree_s
+0005d700: 6571 7565 6e63 652e 6765 745f 6b63 5f64  equence.get_kc_d
+0005d710: 6973 7461 6e63 6528 6f74 6865 722e 5f6c  istance(other._l
+0005d720: 6c5f 7472 6565 5f73 6571 7565 6e63 652c  l_tree_sequence,
+0005d730: 206c 616d 6264 615f 290a 0a20 2020 2064   lambda_)..    d
+0005d740: 6566 2063 6f75 6e74 5f74 6f70 6f6c 6f67  ef count_topolog
+0005d750: 6965 7328 7365 6c66 2c20 7361 6d70 6c65  ies(self, sample
+0005d760: 5f73 6574 733d 4e6f 6e65 293a 0a20 2020  _sets=None):.   
+0005d770: 2020 2020 2022 2222 0a20 2020 2020 2020       """.       
+0005d780: 2052 6574 7572 6e73 2061 2067 656e 6572   Returns a gener
+0005d790: 6174 6f72 2074 6861 7420 7072 6f64 7563  ator that produc
+0005d7a0: 6573 2074 6865 2073 616d 6520 6469 7374  es the same dist
+0005d7b0: 7269 6275 7469 6f6e 206f 6620 746f 706f  ribution of topo
+0005d7c0: 6c6f 6769 6573 2061 730a 2020 2020 2020  logies as.      
+0005d7d0: 2020 3a6d 6574 683a 6054 7265 652e 636f    :meth:`Tree.co
+0005d7e0: 756e 745f 746f 706f 6c6f 6769 6573 6020  unt_topologies` 
+0005d7f0: 6275 7420 7365 7175 656e 7469 616c 6c79  but sequentially
+0005d800: 2066 6f72 2065 7665 7279 2074 7265 6520   for every tree 
+0005d810: 696e 2061 2074 7265 650a 2020 2020 2020  in a tree.      
+0005d820: 2020 7365 7175 656e 6365 2e20 466f 7220    sequence. For 
+0005d830: 7573 6520 6f6e 2061 2074 7265 6520 7365  use on a tree se
+0005d840: 7175 656e 6365 2074 6869 7320 6d65 7468  quence this meth
+0005d850: 6f64 2069 7320 6d75 6368 2066 6173 7465  od is much faste
+0005d860: 7220 7468 616e 0a20 2020 2020 2020 2063  r than.        c
+0005d870: 6f6d 7075 7469 6e67 2074 6865 2072 6573  omputing the res
+0005d880: 756c 7420 696e 6465 7065 6e64 656e 746c  ult independentl
+0005d890: 7920 7065 7220 7472 6565 2e0a 0a20 2020  y per tree...   
+0005d8a0: 2020 2020 202e 2e20 7761 726e 696e 673a       .. warning:
+0005d8b0: 3a20 5468 6520 696e 7465 7266 6163 6520  : The interface 
+0005d8c0: 666f 7220 7468 6973 206d 6574 686f 6420  for this method 
+0005d8d0: 6973 2070 7265 6c69 6d69 6e61 7279 2061  is preliminary a
+0005d8e0: 6e64 206d 6179 2062 6520 7375 626a 6563  nd may be subjec
+0005d8f0: 7420 746f 0a20 2020 2020 2020 2020 2020  t to.           
+0005d900: 2062 6163 6b77 6172 6473 2069 6e63 6f6d   backwards incom
+0005d910: 7061 7469 626c 6520 6368 616e 6765 7320  patible changes 
+0005d920: 696e 2074 6865 206e 6561 7220 6675 7475  in the near futu
+0005d930: 7265 2e0a 0a20 2020 2020 2020 203a 7061  re...        :pa
+0005d940: 7261 6d20 6c69 7374 2073 616d 706c 655f  ram list sample_
+0005d950: 7365 7473 3a20 4120 6c69 7374 206f 6620  sets: A list of 
+0005d960: 6c69 7374 7320 6f66 204e 6f64 6520 4944  lists of Node ID
+0005d970: 732c 2073 7065 6369 6679 696e 6720 7468  s, specifying th
+0005d980: 650a 2020 2020 2020 2020 2020 2020 6772  e.            gr
+0005d990: 6f75 7073 206f 6620 6e6f 6465 7320 746f  oups of nodes to
+0005d9a0: 2063 6f6d 7075 7465 2074 6865 2073 7461   compute the sta
+0005d9b0: 7469 7374 6963 2077 6974 682e 0a20 2020  tistic with..   
+0005d9c0: 2020 2020 203a 7274 7970 653a 2069 7465       :rtype: ite
+0005d9d0: 7228 3a63 6c61 7373 3a60 7473 6b69 742e  r(:class:`tskit.
+0005d9e0: 546f 706f 6c6f 6779 436f 756e 7465 7260  TopologyCounter`
+0005d9f0: 290a 2020 2020 2020 2020 3a72 6169 7365  ).        :raise
+0005da00: 7320 5661 6c75 6545 7272 6f72 3a20 4966  s ValueError: If
+0005da10: 206e 6f64 6573 2069 6e20 6060 7361 6d70   nodes in ``samp
+0005da20: 6c65 5f73 6574 7360 6020 6172 6520 696e  le_sets`` are in
+0005da30: 7661 6c69 6420 6f72 2061 7265 0a20 2020  valid or are.   
+0005da40: 2020 2020 2020 2020 2069 6e74 6572 6e61           interna
+0005da50: 6c20 7361 6d70 6c65 732e 0a20 2020 2020  l samples..     
+0005da60: 2020 2022 2222 0a20 2020 2020 2020 2069     """.        i
+0005da70: 6620 7361 6d70 6c65 5f73 6574 7320 6973  f sample_sets is
+0005da80: 204e 6f6e 653a 0a20 2020 2020 2020 2020   None:.         
+0005da90: 2020 2073 616d 706c 655f 7365 7473 203d     sample_sets =
+0005daa0: 205b 0a20 2020 2020 2020 2020 2020 2020   [.             
+0005dab0: 2020 2073 656c 662e 7361 6d70 6c65 7328     self.samples(
+0005dac0: 706f 7075 6c61 7469 6f6e 3d70 6f70 2e69  population=pop.i
+0005dad0: 6429 2066 6f72 2070 6f70 2069 6e20 7365  d) for pop in se
+0005dae0: 6c66 2e70 6f70 756c 6174 696f 6e73 2829  lf.populations()
+0005daf0: 0a20 2020 2020 2020 2020 2020 205d 0a0a  .            ]..
+0005db00: 2020 2020 2020 2020 7969 656c 6420 6672          yield fr
+0005db10: 6f6d 2063 6f6d 6269 6e61 746f 7269 6373  om combinatorics
+0005db20: 2e74 7265 6573 6571 5f63 6f75 6e74 5f74  .treeseq_count_t
+0005db30: 6f70 6f6c 6f67 6965 7328 7365 6c66 2c20  opologies(self, 
+0005db40: 7361 6d70 6c65 5f73 6574 7329 0a0a 2020  sample_sets)..  
+0005db50: 2020 6465 6620 6962 645f 7365 676d 656e    def ibd_segmen
+0005db60: 7473 280a 2020 2020 2020 2020 7365 6c66  ts(.        self
+0005db70: 2c0a 2020 2020 2020 2020 2a2c 0a20 2020  ,.        *,.   
+0005db80: 2020 2020 2077 6974 6869 6e3d 4e6f 6e65       within=None
+0005db90: 2c0a 2020 2020 2020 2020 6265 7477 6565  ,.        betwee
+0005dba0: 6e3d 4e6f 6e65 2c0a 2020 2020 2020 2020  n=None,.        
+0005dbb0: 6d61 785f 7469 6d65 3d4e 6f6e 652c 0a20  max_time=None,. 
+0005dbc0: 2020 2020 2020 206d 696e 5f73 7061 6e3d         min_span=
+0005dbd0: 4e6f 6e65 2c0a 2020 2020 2020 2020 7374  None,.        st
+0005dbe0: 6f72 655f 7061 6972 733d 4e6f 6e65 2c0a  ore_pairs=None,.
+0005dbf0: 2020 2020 2020 2020 7374 6f72 655f 7365          store_se
+0005dc00: 676d 656e 7473 3d4e 6f6e 652c 0a20 2020  gments=None,.   
+0005dc10: 2029 3a0a 2020 2020 2020 2020 2222 220a   ):.        """.
+0005dc20: 2020 2020 2020 2020 4669 6e64 7320 7061          Finds pa
+0005dc30: 6972 7320 6f66 2073 616d 706c 6573 2074  irs of samples t
+0005dc40: 6861 7420 6172 6520 6964 656e 7469 6361  hat are identica
+0005dc50: 6c20 6279 2064 6573 6365 6e74 2028 4942  l by descent (IB
+0005dc60: 4429 2061 6e64 2072 6574 7572 6e73 0a20  D) and returns. 
+0005dc70: 2020 2020 2020 2074 6865 2072 6573 756c         the resul
+0005dc80: 7420 6173 2061 6e20 3a63 6c61 7373 3a60  t as an :class:`
+0005dc90: 2e49 6465 6e74 6974 7953 6567 6d65 6e74  .IdentitySegment
+0005dca0: 7360 2069 6e73 7461 6e63 652e 2054 6865  s` instance. The
+0005dcb0: 2069 6e66 6f72 6d61 7469 6f6e 0a20 2020   information.   
+0005dcc0: 2020 2020 2073 746f 7265 6420 696e 2074       stored in t
+0005dcd0: 6869 7320 6f62 6a65 6374 2069 7320 636f  his object is co
+0005dce0: 6e74 726f 6c6c 6564 2062 7920 7468 6520  ntrolled by the 
+0005dcf0: 6060 7374 6f72 655f 7061 6972 7360 6020  ``store_pairs`` 
+0005dd00: 616e 640a 2020 2020 2020 2020 6060 7374  and.        ``st
+0005dd10: 6f72 655f 7365 676d 656e 7473 6060 2070  ore_segments`` p
+0005dd20: 6172 616d 6574 6572 732e 2042 7920 6465  arameters. By de
+0005dd30: 6661 756c 7420 6f6e 6c79 2074 6f74 616c  fault only total
+0005dd40: 2063 6f75 6e74 7320 616e 6420 6f74 6865   counts and othe
+0005dd50: 720a 2020 2020 2020 2020 7374 6174 6973  r.        statis
+0005dd60: 7469 6373 206f 6620 7468 6520 4942 4420  tics of the IBD 
+0005dd70: 7365 676d 656e 7473 2061 7265 2073 746f  segments are sto
+0005dd80: 7265 6420 2869 2e65 2e2c 0a20 2020 2020  red (i.e.,.     
+0005dd90: 2020 2060 6073 746f 7265 5f70 6169 7273     ``store_pairs
+0005dda0: 3d46 616c 7365 6060 292c 2073 696e 6365  =False``), since
+0005ddb0: 2073 746f 7269 6e67 2070 6169 7273 2061   storing pairs a
+0005ddc0: 6e64 2073 6567 6d65 6e74 7320 6861 7320  nd segments has 
+0005ddd0: 610a 2020 2020 2020 2020 7375 6273 7461  a.        substa
+0005dde0: 6e74 6961 6c20 4350 5520 616e 6420 6d65  ntial CPU and me
+0005ddf0: 6d6f 7279 206f 7665 7268 6561 642e 2050  mory overhead. P
+0005de00: 6c65 6173 6520 7365 6520 7468 650a 2020  lease see the.  
+0005de10: 2020 2020 2020 3a72 6566 3a60 7365 635f        :ref:`sec_
+0005de20: 6964 656e 7469 7479 6020 7365 6374 696f  identity` sectio
+0005de30: 6e20 666f 7220 6d6f 7265 2064 6574 6169  n for more detai
+0005de40: 6c73 206f 6e20 686f 7720 746f 2061 6363  ls on how to acc
+0005de50: 6573 7320 7468 650a 2020 2020 2020 2020  ess the.        
+0005de60: 696e 666f 726d 6174 696f 6e20 7374 6f72  information stor
+0005de70: 6564 2069 6e20 7468 6520 3a63 6c61 7373  ed in the :class
+0005de80: 3a60 2e49 6465 6e74 6974 7953 6567 6d65  :`.IdentitySegme
+0005de90: 6e74 7360 2e0a 0a20 2020 2020 2020 2049  nts`...        I
+0005dea0: 6620 6060 7769 7468 696e 6060 2069 7320  f ``within`` is 
+0005deb0: 7370 6563 6966 6965 642c 206f 6e6c 7920  specified, only 
+0005dec0: 4942 4420 7365 676d 656e 7473 2066 6f72  IBD segments for
+0005ded0: 2070 6169 7273 206f 6620 6e6f 6465 7320   pairs of nodes 
+0005dee0: 7769 7468 696e 0a20 2020 2020 2020 2074  within.        t
+0005def0: 6861 7420 7365 7420 7769 6c6c 2062 6520  hat set will be 
+0005df00: 7265 636f 7264 6564 2e20 4966 2060 6062  recorded. If ``b
+0005df10: 6574 7765 656e 6060 2069 7320 7370 6563  etween`` is spec
+0005df20: 6966 6965 642c 206f 6e6c 7920 4942 440a  ified, only IBD.
+0005df30: 2020 2020 2020 2020 7365 676d 656e 7473          segments
+0005df40: 2066 726f 6d20 7061 6972 7320 7468 6174   from pairs that
+0005df50: 2061 7265 2069 6e20 6f6e 6520 6f72 206f   are in one or o
+0005df60: 7468 6572 206f 6620 7468 6520 7370 6563  ther of the spec
+0005df70: 6966 6965 6420 7361 6d70 6c65 0a20 2020  ified sample.   
+0005df80: 2020 2020 2073 6574 7320 7769 6c6c 2062       sets will b
+0005df90: 6520 7265 706f 7274 6564 2e20 4e6f 7465  e reported. Note
+0005dfa0: 2074 6861 7420 6060 7769 7468 696e 6060   that ``within``
+0005dfb0: 2061 6e64 2060 6062 6574 7765 656e 6060   and ``between``
+0005dfc0: 2061 7265 0a20 2020 2020 2020 206d 7574   are.        mut
+0005dfd0: 7561 6c6c 7920 6578 636c 7573 6976 652e  ually exclusive.
+0005dfe0: 0a0a 2020 2020 2020 2020 4120 7061 6972  ..        A pair
+0005dff0: 206f 6620 6e6f 6465 7320 6060 2875 2c20   of nodes ``(u, 
+0005e000: 7629 6060 2068 6173 2061 6e20 4942 4420  v)`` has an IBD 
+0005e010: 7365 676d 656e 7420 7769 7468 2061 206c  segment with a l
+0005e020: 6566 7420 616e 6420 7269 6768 740a 2020  eft and right.  
+0005e030: 2020 2020 2020 636f 6f72 6469 6e61 7465        coordinate
+0005e040: 2060 605b 6c65 6674 2c20 7269 6768 7429   ``[left, right)
+0005e050: 6060 2061 6e64 2061 6e63 6573 7472 616c  `` and ancestral
+0005e060: 206e 6f64 6520 6060 6160 6020 6966 6620   node ``a`` iff 
+0005e070: 7468 6520 6d6f 7374 0a20 2020 2020 2020  the most.       
+0005e080: 2072 6563 656e 7420 636f 6d6d 6f6e 2061   recent common a
+0005e090: 6e63 6573 746f 7220 6f66 2074 6865 2073  ncestor of the s
+0005e0a0: 6567 6d65 6e74 2060 605b 6c65 6674 2c20  egment ``[left, 
+0005e0b0: 7269 6768 7429 6060 2069 6e20 6e6f 6465  right)`` in node
+0005e0c0: 7320 6060 7560 600a 2020 2020 2020 2020  s ``u``.        
+0005e0d0: 616e 6420 6060 7660 6020 6973 2060 6061  and ``v`` is ``a
+0005e0e0: 6060 2c20 616e 6420 7468 6520 7365 676d  ``, and the segm
+0005e0f0: 656e 7420 6861 7320 6265 656e 2069 6e68  ent has been inh
+0005e100: 6572 6974 6564 2061 6c6f 6e67 2074 6865  erited along the
+0005e110: 2073 616d 650a 2020 2020 2020 2020 6765   same.        ge
+0005e120: 6e65 616c 6f67 6963 616c 2070 6174 6820  nealogical path 
+0005e130: 2869 652e 2069 7420 6861 7320 6e6f 7420  (ie. it has not 
+0005e140: 6265 656e 2062 726f 6b65 6e20 6279 2072  been broken by r
+0005e150: 6563 6f6d 6269 6e61 7469 6f6e 292e 2054  ecombination). T
+0005e160: 6865 0a20 2020 2020 2020 2073 6567 6d65  he.        segme
+0005e170: 6e74 7320 7265 7475 726e 6564 2061 7265  nts returned are
+0005e180: 2074 6865 206c 6f6e 6765 7374 2070 6f73   the longest pos
+0005e190: 7369 626c 6520 6f6e 6573 2e0a 0a20 2020  sible ones...   
+0005e1a0: 2020 2020 204e 6f74 6520 7468 6174 2074       Note that t
+0005e1b0: 6869 7320 6465 6669 6e69 7469 6f6e 2069  his definition i
+0005e1c0: 7320 7075 7265 6c79 2067 656e 6561 6c6f  s purely genealo
+0005e1d0: 6769 6361 6c20 2d2d 2d20 616c 6c65 6c69  gical --- alleli
+0005e1e0: 6320 7374 6174 6573 0a20 2020 2020 2020  c states.       
+0005e1f0: 202a 6172 6520 6e6f 742a 2063 6f6e 7369   *are not* consi
+0005e200: 6465 7265 6420 6865 7265 2e20 4966 2075  dered here. If u
+0005e210: 7365 6420 7769 7468 6f75 7420 7469 6d65  sed without time
+0005e220: 206f 7220 6c65 6e67 7468 2074 6872 6573   or length thres
+0005e230: 686f 6c64 732c 2074 6865 0a20 2020 2020  holds, the.     
+0005e240: 2020 2073 6567 6d65 6e74 7320 7265 7475     segments retu
+0005e250: 726e 6564 2066 6f72 2061 2067 6976 656e  rned for a given
+0005e260: 2070 6169 7220 7769 6c6c 2070 6172 7469   pair will parti
+0005e270: 7469 6f6e 2074 6865 2073 7061 6e20 6f66  tion the span of
+0005e280: 2074 6865 2063 6f6e 7469 670a 2020 2020   the contig.    
+0005e290: 2020 2020 7265 7072 6573 656e 7465 6420      represented 
+0005e2a0: 6279 2074 6865 2074 7265 6520 7365 7175  by the tree sequ
+0005e2b0: 656e 6365 2e0a 0a20 2020 2020 2020 203a  ence...        :
+0005e2c0: 7061 7261 6d20 6c69 7374 2077 6974 6869  param list withi
+0005e2d0: 6e3a 2041 206c 6973 7420 6f66 206e 6f64  n: A list of nod
+0005e2e0: 6520 4944 7320 6465 6669 6e69 6e67 2073  e IDs defining s
+0005e2f0: 6574 206f 6620 6e6f 6465 7320 7468 6174  et of nodes that
+0005e300: 0a20 2020 2020 2020 2020 2020 2077 6520  .            we 
+0005e310: 6669 6e64 696e 6720 4942 4420 7365 676d  finding IBD segm
+0005e320: 656e 7473 2066 6f72 2e20 4966 206e 6f74  ents for. If not
+0005e330: 2073 7065 6369 6669 6564 2c20 7468 6973   specified, this
+0005e340: 2064 6566 6175 6c74 7320 746f 0a20 2020   defaults to.   
+0005e350: 2020 2020 2020 2020 2061 6c6c 2073 616d           all sam
+0005e360: 706c 6573 2069 6e20 7468 6520 7472 6565  ples in the tree
+0005e370: 2073 6571 7565 6e63 652e 0a20 2020 2020   sequence..     
+0005e380: 2020 203a 7061 7261 6d20 6c69 7374 5b6c     :param list[l
+0005e390: 6973 745d 2062 6574 7765 656e 3a20 4120  ist] between: A 
+0005e3a0: 6c69 7374 206f 6620 6c69 7374 7320 6f66  list of lists of
+0005e3b0: 2073 616d 706c 6520 6e6f 6465 2049 4473   sample node IDs
+0005e3c0: 2e20 4769 7665 6e0a 2020 2020 2020 2020  . Given.        
+0005e3d0: 2020 2020 7477 6f20 7361 6d70 6c65 2073      two sample s
+0005e3e0: 6574 7320 4120 616e 6420 422c 206f 6e6c  ets A and B, onl
+0005e3f0: 7920 4942 4420 7365 676d 656e 7473 2077  y IBD segments w
+0005e400: 696c 6c20 6265 2072 6574 7572 6e65 6420  ill be returned 
+0005e410: 7375 6368 0a20 2020 2020 2020 2020 2020  such.           
+0005e420: 2074 6861 7420 6f6e 6520 6f66 2074 6865   that one of the
+0005e430: 2073 616d 706c 6573 2069 7320 616e 2065   samples is an e
+0005e440: 6c65 6d65 6e74 206f 6620 4120 616e 6420  lement of A and 
+0005e450: 7468 6520 6f74 6865 7220 6973 0a20 2020  the other is.   
+0005e460: 2020 2020 2020 2020 2061 6e20 656c 656d           an elem
+0005e470: 656e 7420 6f66 2042 2e20 4361 6e6e 6f74  ent of B. Cannot
+0005e480: 2062 6520 7370 6563 6966 6965 6420 7769   be specified wi
+0005e490: 7468 2060 6077 6974 6869 6e60 602e 0a20  th ``within``.. 
+0005e4a0: 2020 2020 2020 203a 7061 7261 6d20 666c         :param fl
+0005e4b0: 6f61 7420 6d61 785f 7469 6d65 3a20 4f6e  oat max_time: On
+0005e4c0: 6c79 2073 6567 6d65 6e74 7320 696e 6865  ly segments inhe
+0005e4d0: 7269 7465 6420 6672 6f6d 2063 6f6d 6d6f  rited from commo
+0005e4e0: 6e0a 2020 2020 2020 2020 2020 2020 616e  n.            an
+0005e4f0: 6365 7374 6f72 7320 7768 6f73 6520 6e6f  cestors whose no
+0005e500: 6465 2074 696d 6573 2061 7265 206d 6f72  de times are mor
+0005e510: 6520 7265 6365 6e74 2074 6861 6e20 7468  e recent than th
+0005e520: 6520 7370 6563 6966 6965 6420 7469 6d65  e specified time
+0005e530: 0a20 2020 2020 2020 2020 2020 2077 696c  .            wil
+0005e540: 6c20 6265 2072 6574 7572 6e65 642e 2053  l be returned. S
+0005e550: 7065 6369 6679 696e 6720 6120 6d61 7869  pecifying a maxi
+0005e560: 6d75 6d20 7469 6d65 2069 7320 7374 726f  mum time is stro
+0005e570: 6e67 6c79 2072 6563 6f6d 6d65 6e64 6564  ngly recommended
+0005e580: 2077 6865 6e0a 2020 2020 2020 2020 2020   when.          
+0005e590: 2020 776f 726b 696e 6720 7769 7468 206c    working with l
+0005e5a0: 6172 6765 2074 7265 6520 7365 7175 656e  arge tree sequen
+0005e5b0: 6365 732e 0a20 2020 2020 2020 203a 7061  ces..        :pa
+0005e5c0: 7261 6d20 666c 6f61 7420 6d69 6e5f 7370  ram float min_sp
+0005e5d0: 616e 3a20 4f6e 6c79 2073 6567 6d65 6e74  an: Only segment
+0005e5e0: 7320 696e 2077 6869 6368 2074 6865 2064  s in which the d
+0005e5f0: 6966 6665 7265 6e63 6520 6265 7477 6565  ifference betwee
+0005e600: 6e0a 2020 2020 2020 2020 2020 2020 7468  n.            th
+0005e610: 6520 7269 6768 7420 616e 6420 6c65 6674  e right and left
+0005e620: 2067 656e 6f6d 6520 636f 6f72 6469 6e61   genome coordina
+0005e630: 7465 7320 2869 2e65 2e2c 2074 6865 2073  tes (i.e., the s
+0005e640: 7061 6e20 6f66 2074 6865 0a20 2020 2020  pan of the.     
+0005e650: 2020 2020 2020 2073 6567 6d65 6e74 2920         segment) 
+0005e660: 6973 2067 7265 6174 6572 2074 6861 6e20  is greater than 
+0005e670: 7468 6973 2076 616c 7565 2077 696c 6c20  this value will 
+0005e680: 6265 2069 6e63 6c75 6465 642e 2028 4465  be included. (De
+0005e690: 6661 756c 743d 3029 0a20 2020 2020 2020  fault=0).       
+0005e6a0: 203a 7061 7261 6d20 626f 6f6c 2073 746f   :param bool sto
+0005e6b0: 7265 5f70 6169 7273 3a20 4966 2054 7275  re_pairs: If Tru
+0005e6c0: 6520 7374 6f72 6520 696e 666f 726d 6174  e store informat
+0005e6d0: 696f 6e20 7365 7061 7261 7465 6c79 2066  ion separately f
+0005e6e0: 6f72 2065 6163 680a 2020 2020 2020 2020  or each.        
+0005e6f0: 2020 2020 7061 6972 206f 6620 7361 6d70      pair of samp
+0005e700: 6c65 7320 6060 2861 2c20 6229 6060 2074  les ``(a, b)`` t
+0005e710: 6861 7420 6172 6520 666f 756e 6420 746f  hat are found to
+0005e720: 2062 6520 4942 442e 204f 7468 6572 7769   be IBD. Otherwi
+0005e730: 7365 0a20 2020 2020 2020 2020 2020 2073  se.            s
+0005e740: 746f 7265 2073 756d 6d61 7279 2069 6e66  tore summary inf
+0005e750: 6f72 6d61 7469 6f6e 2061 626f 7574 2061  ormation about a
+0005e760: 6c6c 2073 616d 706c 6520 6170 6972 732e  ll sample apirs.
+0005e770: 2028 4465 6661 756c 743d 4661 6c73 6529   (Default=False)
+0005e780: 0a20 2020 2020 2020 203a 7061 7261 6d20  .        :param 
+0005e790: 626f 6f6c 2073 746f 7265 5f73 6567 6d65  bool store_segme
+0005e7a0: 6e74 733a 2049 6620 5472 7565 2073 746f  nts: If True sto
+0005e7b0: 7265 2065 6163 6820 4942 4420 7365 676d  re each IBD segm
+0005e7c0: 656e 740a 2020 2020 2020 2020 2020 2020  ent.            
+0005e7d0: 6060 286c 6566 742c 2072 6967 6874 2c20  ``(left, right, 
+0005e7e0: 6329 6060 2061 6e64 2061 7373 6f63 6961  c)`` and associa
+0005e7f0: 7465 2069 7420 7769 7468 2074 6865 2063  te it with the c
+0005e800: 6f72 7265 7370 6f6e 6469 6e67 0a20 2020  orresponding.   
+0005e810: 2020 2020 2020 2020 2073 616d 706c 6520           sample 
+0005e820: 7061 6972 2060 6028 612c 2062 2960 602e  pair ``(a, b)``.
+0005e830: 2049 6620 5472 7565 2c20 696d 706c 6965   If True, implie
+0005e840: 7320 6060 7374 6f72 655f 7061 6972 7360  s ``store_pairs`
+0005e850: 602e 0a20 2020 2020 2020 2020 2020 2028  `..            (
+0005e860: 4465 6661 756c 743d 4661 6c73 6529 2e0a  Default=False)..
+0005e870: 2020 2020 2020 2020 3a72 6574 7572 6e3a          :return:
+0005e880: 2041 6e20 3a63 6c61 7373 3a60 2e49 6465   An :class:`.Ide
+0005e890: 6e74 6974 7953 6567 6d65 6e74 7360 206f  ntitySegments` o
+0005e8a0: 626a 6563 7420 636f 6e74 6169 6e69 6e67  bject containing
+0005e8b0: 2074 6865 2072 6563 6f72 6465 640a 2020   the recorded.  
+0005e8c0: 2020 2020 2020 2020 2020 4942 4420 696e            IBD in
+0005e8d0: 666f 726d 6174 696f 6e2e 0a20 2020 2020  formation..     
+0005e8e0: 2020 203a 7274 7970 653a 2049 6465 6e74     :rtype: Ident
+0005e8f0: 6974 7953 6567 6d65 6e74 730a 2020 2020  itySegments.    
+0005e900: 2020 2020 2222 220a 2020 2020 2020 2020      """.        
+0005e910: 7265 7475 726e 2073 656c 662e 7461 626c  return self.tabl
+0005e920: 6573 2e69 6264 5f73 6567 6d65 6e74 7328  es.ibd_segments(
+0005e930: 0a20 2020 2020 2020 2020 2020 2077 6974  .            wit
+0005e940: 6869 6e3d 7769 7468 696e 2c0a 2020 2020  hin=within,.    
+0005e950: 2020 2020 2020 2020 6265 7477 6565 6e3d          between=
+0005e960: 6265 7477 6565 6e2c 0a20 2020 2020 2020  between,.       
+0005e970: 2020 2020 206d 6178 5f74 696d 653d 6d61       max_time=ma
+0005e980: 785f 7469 6d65 2c0a 2020 2020 2020 2020  x_time,.        
+0005e990: 2020 2020 6d69 6e5f 7370 616e 3d6d 696e      min_span=min
+0005e9a0: 5f73 7061 6e2c 0a20 2020 2020 2020 2020  _span,.         
+0005e9b0: 2020 2073 746f 7265 5f73 6567 6d65 6e74     store_segment
+0005e9c0: 733d 7374 6f72 655f 7365 676d 656e 7473  s=store_segments
+0005e9d0: 2c0a 2020 2020 2020 2020 2020 2020 7374  ,.            st
+0005e9e0: 6f72 655f 7061 6972 733d 7374 6f72 655f  ore_pairs=store_
+0005e9f0: 7061 6972 732c 0a20 2020 2020 2020 2029  pairs,.        )
+0005ea00: 0a0a 2020 2020 6465 6620 636f 616c 6573  ..    def coales
+0005ea10: 6365 6e63 655f 7469 6d65 5f64 6973 7472  cence_time_distr
+0005ea20: 6962 7574 696f 6e28 0a20 2020 2020 2020  ibution(.       
+0005ea30: 2073 656c 662c 0a20 2020 2020 2020 202a   self,.        *
+0005ea40: 2c0a 2020 2020 2020 2020 7361 6d70 6c65  ,.        sample
+0005ea50: 5f73 6574 733d 4e6f 6e65 2c0a 2020 2020  _sets=None,.    
+0005ea60: 2020 2020 7765 6967 6874 5f66 756e 633d      weight_func=
+0005ea70: 4e6f 6e65 2c0a 2020 2020 2020 2020 7769  None,.        wi
+0005ea80: 6e64 6f77 5f62 7265 616b 733d 4e6f 6e65  ndow_breaks=None
+0005ea90: 2c0a 2020 2020 2020 2020 626c 6f63 6b73  ,.        blocks
+0005eaa0: 5f70 6572 5f77 696e 646f 773d 4e6f 6e65  _per_window=None
+0005eab0: 2c0a 2020 2020 2020 2020 7370 616e 5f6e  ,.        span_n
+0005eac0: 6f72 6d61 6c69 7365 3d46 616c 7365 2c0a  ormalise=False,.
+0005ead0: 2020 2020 293a 0a20 2020 2020 2020 2023      ):.        #
+0005eae0: 2054 4f44 4f20 646f 6373 7472 696e 672c   TODO docstring,
+0005eaf0: 206e 6f74 2079 6574 2069 6e20 4150 490a   not yet in API.
+0005eb00: 0a20 2020 2020 2020 2072 6574 7572 6e20  .        return 
+0005eb10: 7374 6174 732e 436f 616c 6573 6365 6e63  stats.Coalescenc
+0005eb20: 6554 696d 6544 6973 7472 6962 7574 696f  eTimeDistributio
+0005eb30: 6e28 0a20 2020 2020 2020 2020 2020 2073  n(.            s
+0005eb40: 656c 662c 0a20 2020 2020 2020 2020 2020  elf,.           
+0005eb50: 2073 616d 706c 655f 7365 7473 3d73 616d   sample_sets=sam
+0005eb60: 706c 655f 7365 7473 2c0a 2020 2020 2020  ple_sets,.      
+0005eb70: 2020 2020 2020 7765 6967 6874 5f66 756e        weight_fun
+0005eb80: 633d 7765 6967 6874 5f66 756e 632c 0a20  c=weight_func,. 
+0005eb90: 2020 2020 2020 2020 2020 2077 696e 646f             windo
+0005eba0: 775f 6272 6561 6b73 3d77 696e 646f 775f  w_breaks=window_
+0005ebb0: 6272 6561 6b73 2c0a 2020 2020 2020 2020  breaks,.        
+0005ebc0: 2020 2020 626c 6f63 6b73 5f70 6572 5f77      blocks_per_w
+0005ebd0: 696e 646f 773d 626c 6f63 6b73 5f70 6572  indow=blocks_per
+0005ebe0: 5f77 696e 646f 772c 0a20 2020 2020 2020  _window,.       
+0005ebf0: 2020 2020 2073 7061 6e5f 6e6f 726d 616c       span_normal
+0005ec00: 6973 653d 7370 616e 5f6e 6f72 6d61 6c69  ise=span_normali
+0005ec10: 7365 2c0a 2020 2020 2020 2020 290a 0a20  se,.        ).. 
+0005ec20: 2020 2023 2323 2323 2323 2323 2323 2323     #############
+0005ec30: 2323 2323 2323 2323 2323 2323 2323 2323  ################
+0005ec40: 2323 2323 2323 2323 2323 2323 2323 230a  ###############.
+0005ec50: 2020 2020 230a 2020 2020 2320 4465 7072      #.    # Depr
+0005ec60: 6563 6174 6564 2041 5049 732e 2054 6865  ecated APIs. The
+0005ec70: 7365 2061 7265 2065 6974 6865 7220 616c  se are either al
+0005ec80: 7265 6164 7920 756e 7375 7070 6f72 7465  ready unsupporte
+0005ec90: 642c 206f 7220 7769 6c6c 2062 6520 756e  d, or will be un
+0005eca0: 7375 7070 6f72 7465 6420 696e 2061 0a20  supported in a. 
+0005ecb0: 2020 2023 206c 6174 6572 2072 656c 6561     # later relea
+0005ecc0: 7365 2e0a 2020 2020 230a 2020 2020 2323  se..    #.    ##
+0005ecd0: 2323 2323 2323 2323 2323 2323 2323 2323  ################
+0005ece0: 2323 2323 2323 2323 2323 2323 2323 2323  ################
+0005ecf0: 2323 2323 2323 2323 2323 0a0a 2020 2020  ##########..    
+0005ed00: 6465 6620 6765 745f 7061 6972 7769 7365  def get_pairwise
+0005ed10: 5f64 6976 6572 7369 7479 2873 656c 662c  _diversity(self,
+0005ed20: 2073 616d 706c 6573 3d4e 6f6e 6529 3a0a   samples=None):.
+0005ed30: 2020 2020 2020 2020 2320 4465 7072 6563          # Deprec
+0005ed40: 6174 6564 2061 6c69 6173 2066 6f72 2073  ated alias for s
+0005ed50: 656c 662e 7061 6972 7769 7365 5f64 6976  elf.pairwise_div
+0005ed60: 6572 7369 7479 0a20 2020 2020 2020 2072  ersity.        r
+0005ed70: 6574 7572 6e20 7365 6c66 2e70 6169 7277  eturn self.pairw
+0005ed80: 6973 655f 6469 7665 7273 6974 7928 7361  ise_diversity(sa
+0005ed90: 6d70 6c65 7329 0a0a 2020 2020 6465 6620  mples)..    def 
+0005eda0: 7061 6972 7769 7365 5f64 6976 6572 7369  pairwise_diversi
+0005edb0: 7479 2873 656c 662c 2073 616d 706c 6573  ty(self, samples
+0005edc0: 3d4e 6f6e 6529 3a0a 2020 2020 2020 2020  =None):.        
+0005edd0: 2222 220a 2020 2020 2020 2020 5265 7475  """.        Retu
+0005ede0: 726e 7320 7468 6520 7061 6972 7769 7365  rns the pairwise
+0005edf0: 206e 7563 6c65 6f74 6964 6520 7369 7465   nucleotide site
+0005ee00: 2064 6976 6572 7369 7479 2c20 7468 6520   diversity, the 
+0005ee10: 6176 6572 6167 6520 6e75 6d62 6572 206f  average number o
+0005ee20: 6620 7369 7465 730a 2020 2020 2020 2020  f sites.        
+0005ee30: 7468 6174 2064 6966 6665 7220 6265 7477  that differ betw
+0005ee40: 6565 6e20 6120 6576 6572 7920 706f 7373  een a every poss
+0005ee50: 6962 6c65 2070 6169 7220 6f66 2064 6973  ible pair of dis
+0005ee60: 7469 6e63 7420 7361 6d70 6c65 732e 2020  tinct samples.  
+0005ee70: 4966 2060 7361 6d70 6c65 7360 2069 730a  If `samples` is.
+0005ee80: 2020 2020 2020 2020 7370 6563 6966 6965          specifie
+0005ee90: 642c 2063 616c 6375 6c61 7465 2074 6865  d, calculate the
+0005eea0: 2064 6976 6572 7369 7479 2077 6974 6869   diversity withi
+0005eeb0: 6e20 7468 6973 2073 6574 2e0a 0a20 2020  n this set...   
+0005eec0: 2020 2020 2020 2e2e 2064 6570 7265 6361        .. depreca
+0005eed0: 7465 643a 3a20 302e 322e 300a 2020 2020  ted:: 0.2.0.    
+0005eee0: 2020 2020 2020 2020 2070 6c65 6173 6520           please 
+0005eef0: 7573 6520 3a6d 6574 683a 602e 6469 7665  use :meth:`.dive
+0005ef00: 7273 6974 7960 2069 6e73 7465 6164 2e20  rsity` instead. 
+0005ef10: 5369 6e63 6520 7665 7273 696f 6e20 302e  Since version 0.
+0005ef20: 322e 3020 7468 6520 6572 726f 720a 2020  2.0 the error.  
+0005ef30: 2020 2020 2020 2020 2020 2073 656d 616e             seman
+0005ef40: 7469 6373 2068 6176 6520 616c 736f 2063  tics have also c
+0005ef50: 6861 6e67 6564 2073 6c69 6768 746c 792e  hanged slightly.
+0005ef60: 2049 7420 6973 206e 6f20 6c6f 6e67 6572   It is no longer
+0005ef70: 2061 6e20 6572 726f 720a 2020 2020 2020   an error.      
+0005ef80: 2020 2020 2020 2077 6865 6e20 7468 6572         when ther
+0005ef90: 6520 6973 206f 6e65 2073 616d 706c 6520  e is one sample 
+0005efa0: 616e 6420 6120 7473 6b69 742e 4c69 6272  and a tskit.Libr
+0005efb0: 6172 7945 7272 6f72 2069 7320 7261 6973  aryError is rais
+0005efc0: 6564 0a20 2020 2020 2020 2020 2020 2020  ed.             
+0005efd0: 7768 656e 206e 6f6e 2d73 616d 706c 6520  when non-sample 
+0005efe0: 4944 7320 6172 6520 7072 6f76 6964 6564  IDs are provided
+0005eff0: 2072 6174 6865 7220 7468 616e 2061 2056   rather than a V
+0005f000: 616c 7565 4572 726f 722e 2049 7420 6973  alueError. It is
+0005f010: 0a20 2020 2020 2020 2020 2020 2020 616c  .             al
+0005f020: 736f 206e 6f20 6c6f 6e67 6572 2061 6e20  so no longer an 
+0005f030: 6572 726f 7220 746f 2063 6f6d 7075 7465  error to compute
+0005f040: 2070 6169 7277 6973 6520 6469 7665 7273   pairwise divers
+0005f050: 6974 7920 6174 2073 6974 6573 0a20 2020  ity at sites.   
+0005f060: 2020 2020 2020 2020 2020 7769 7468 206d            with m
+0005f070: 756c 7469 706c 6520 6d75 7461 7469 6f6e  ultiple mutation
+0005f080: 732e 0a0a 2020 2020 2020 2020 3a70 6172  s...        :par
+0005f090: 616d 206c 6973 7420 7361 6d70 6c65 733a  am list samples:
+0005f0a0: 2054 6865 2073 6574 206f 6620 7361 6d70   The set of samp
+0005f0b0: 6c65 7320 7769 7468 696e 2077 6869 6368  les within which
+0005f0c0: 2077 6520 6361 6c63 756c 6174 650a 2020   we calculate.  
+0005f0d0: 2020 2020 2020 2020 2020 7468 6520 6469            the di
+0005f0e0: 7665 7273 6974 792e 2049 6620 4e6f 6e65  versity. If None
+0005f0f0: 2c20 6361 6c63 756c 6174 6520 6469 7665  , calculate dive
+0005f100: 7273 6974 7920 7769 7468 696e 2074 6865  rsity within the
+0005f110: 2065 6e74 6972 6520 7361 6d70 6c65 2e0a   entire sample..
+0005f120: 2020 2020 2020 2020 3a72 6574 7572 6e3a          :return:
+0005f130: 2054 6865 2070 6169 7277 6973 6520 6e75   The pairwise nu
+0005f140: 636c 656f 7469 6465 2073 6974 6520 6469  cleotide site di
+0005f150: 7665 7273 6974 792e 0a20 2020 2020 2020  versity..       
+0005f160: 203a 7274 7970 653a 2066 6c6f 6174 0a20   :rtype: float. 
+0005f170: 2020 2020 2020 2022 2222 0a20 2020 2020         """.     
+0005f180: 2020 2069 6620 7361 6d70 6c65 7320 6973     if samples is
+0005f190: 204e 6f6e 653a 0a20 2020 2020 2020 2020   None:.         
+0005f1a0: 2020 2073 616d 706c 6573 203d 2073 656c     samples = sel
+0005f1b0: 662e 7361 6d70 6c65 7328 290a 2020 2020  f.samples().    
+0005f1c0: 2020 2020 7265 7475 726e 2066 6c6f 6174      return float
+0005f1d0: 280a 2020 2020 2020 2020 2020 2020 7365  (.            se
+0005f1e0: 6c66 2e64 6976 6572 7369 7479 280a 2020  lf.diversity(.  
+0005f1f0: 2020 2020 2020 2020 2020 2020 2020 5b73                [s
+0005f200: 616d 706c 6573 5d2c 2077 696e 646f 7773  amples], windows
+0005f210: 3d5b 302c 2073 656c 662e 7365 7175 656e  =[0, self.sequen
+0005f220: 6365 5f6c 656e 6774 685d 2c20 7370 616e  ce_length], span
+0005f230: 5f6e 6f72 6d61 6c69 7365 3d46 616c 7365  _normalise=False
+0005f240: 0a20 2020 2020 2020 2020 2020 2029 5b30  .            )[0
+0005f250: 5d0a 2020 2020 2020 2020 290a 0a20 2020  ].        )..   
+0005f260: 2064 6566 2067 6574 5f74 696d 6528 7365   def get_time(se
+0005f270: 6c66 2c20 7529 3a0a 2020 2020 2020 2020  lf, u):.        
+0005f280: 2320 4465 7072 6563 6174 6564 2e20 5573  # Deprecated. Us
+0005f290: 6520 7473 2e6e 6f64 6528 7529 2e74 696d  e ts.node(u).tim
+0005f2a0: 650a 2020 2020 2020 2020 6966 2075 203c  e.        if u <
+0005f2b0: 2030 206f 7220 7520 3e3d 2073 656c 662e   0 or u >= self.
+0005f2c0: 6765 745f 6e75 6d5f 6e6f 6465 7328 293a  get_num_nodes():
+0005f2d0: 0a20 2020 2020 2020 2020 2020 2072 6169  .            rai
+0005f2e0: 7365 2056 616c 7565 4572 726f 7228 2249  se ValueError("I
+0005f2f0: 4420 6f75 7420 6f66 2062 6f75 6e64 7322  D out of bounds"
+0005f300: 290a 2020 2020 2020 2020 6e6f 6465 203d  ).        node =
+0005f310: 2073 656c 662e 6e6f 6465 2875 290a 2020   self.node(u).  
+0005f320: 2020 2020 2020 7265 7475 726e 206e 6f64        return nod
+0005f330: 652e 7469 6d65 0a0a 2020 2020 6465 6620  e.time..    def 
+0005f340: 6765 745f 706f 7075 6c61 7469 6f6e 2873  get_population(s
+0005f350: 656c 662c 2075 293a 0a20 2020 2020 2020  elf, u):.       
+0005f360: 2023 2044 6570 7265 6361 7465 642e 2055   # Deprecated. U
+0005f370: 7365 2074 732e 6e6f 6465 2875 292e 706f  se ts.node(u).po
+0005f380: 7075 6c61 7469 6f6e 0a20 2020 2020 2020  pulation.       
+0005f390: 2069 6620 7520 3c20 3020 6f72 2075 203e   if u < 0 or u >
+0005f3a0: 3d20 7365 6c66 2e67 6574 5f6e 756d 5f6e  = self.get_num_n
+0005f3b0: 6f64 6573 2829 3a0a 2020 2020 2020 2020  odes():.        
+0005f3c0: 2020 2020 7261 6973 6520 5661 6c75 6545      raise ValueE
+0005f3d0: 7272 6f72 2822 4944 206f 7574 206f 6620  rror("ID out of 
+0005f3e0: 626f 756e 6473 2229 0a20 2020 2020 2020  bounds").       
+0005f3f0: 206e 6f64 6520 3d20 7365 6c66 2e6e 6f64   node = self.nod
+0005f400: 6528 7529 0a20 2020 2020 2020 2072 6574  e(u).        ret
+0005f410: 7572 6e20 6e6f 6465 2e70 6f70 756c 6174  urn node.populat
+0005f420: 696f 6e0a 0a20 2020 2064 6566 2072 6563  ion..    def rec
+0005f430: 6f72 6473 2873 656c 6629 3a0a 2020 2020  ords(self):.    
+0005f440: 2020 2020 2320 4465 7072 6563 6174 6564      # Deprecated
+0005f450: 2e20 5573 6520 6569 7468 6572 2074 732e  . Use either ts.
+0005f460: 6564 6765 7328 2920 6f72 2074 732e 6564  edges() or ts.ed
+0005f470: 6765 7365 7473 2829 2e0a 2020 2020 2020  gesets()..      
+0005f480: 2020 7420 3d20 5b6e 6f64 652e 7469 6d65    t = [node.time
+0005f490: 2066 6f72 206e 6f64 6520 696e 2073 656c   for node in sel
+0005f4a0: 662e 6e6f 6465 7328 295d 0a20 2020 2020  f.nodes()].     
+0005f4b0: 2020 2070 6f70 203d 205b 6e6f 6465 2e70     pop = [node.p
+0005f4c0: 6f70 756c 6174 696f 6e20 666f 7220 6e6f  opulation for no
+0005f4d0: 6465 2069 6e20 7365 6c66 2e6e 6f64 6573  de in self.nodes
+0005f4e0: 2829 5d0a 2020 2020 2020 2020 666f 7220  ()].        for 
+0005f4f0: 6520 696e 2073 656c 662e 6564 6765 7365  e in self.edgese
+0005f500: 7473 2829 3a0a 2020 2020 2020 2020 2020  ts():.          
+0005f510: 2020 7969 656c 6420 436f 616c 6573 6365    yield Coalesce
+0005f520: 6e63 6552 6563 6f72 6428 0a20 2020 2020  nceRecord(.     
+0005f530: 2020 2020 2020 2020 2020 2065 2e6c 6566             e.lef
+0005f540: 742c 2065 2e72 6967 6874 2c20 652e 7061  t, e.right, e.pa
+0005f550: 7265 6e74 2c20 652e 6368 696c 6472 656e  rent, e.children
+0005f560: 2c20 745b 652e 7061 7265 6e74 5d2c 2070  , t[e.parent], p
+0005f570: 6f70 5b65 2e70 6172 656e 745d 0a20 2020  op[e.parent].   
+0005f580: 2020 2020 2020 2020 2029 0a0a 2020 2020           )..    
+0005f590: 2320 556e 7375 7070 6f72 7465 6420 6f6c  # Unsupported ol
+0005f5a0: 6420 6d65 7468 6f64 732e 0a0a 2020 2020  d methods...    
+0005f5b0: 6465 6620 6765 745f 6e75 6d5f 7265 636f  def get_num_reco
+0005f5c0: 7264 7328 7365 6c66 293a 0a20 2020 2020  rds(self):.     
+0005f5d0: 2020 2072 6169 7365 204e 6f74 496d 706c     raise NotImpl
+0005f5e0: 656d 656e 7465 6445 7272 6f72 280a 2020  ementedError(.  
+0005f5f0: 2020 2020 2020 2020 2020 2254 6869 7320            "This 
+0005f600: 6d65 7468 6f64 2069 7320 6e6f 206c 6f6e  method is no lon
+0005f610: 6765 7220 7375 7070 6f72 7465 642e 2050  ger supported. P
+0005f620: 6c65 6173 6520 7573 6520 7468 6520 220a  lease use the ".
+0005f630: 2020 2020 2020 2020 2020 2020 2254 7265              "Tre
+0005f640: 6553 6571 7565 6e63 652e 6e75 6d5f 6564  eSequence.num_ed
+0005f650: 6765 7320 6966 2070 6f73 7369 626c 6520  ges if possible 
+0005f660: 746f 2077 6f72 6b20 7769 7468 2065 6467  to work with edg
+0005f670: 6573 2072 6174 6865 7220 220a 2020 2020  es rather ".    
+0005f680: 2020 2020 2020 2020 2274 6861 6e20 636f          "than co
+0005f690: 616c 6573 6365 6e63 6520 7265 636f 7264  alescence record
+0005f6a0: 732e 2049 6620 6e6f 742c 2070 6c65 6173  s. If not, pleas
+0005f6b0: 6520 7573 6520 6c65 6e28 6c69 7374 2874  e use len(list(t
+0005f6c0: 732e 6564 6765 7365 7473 2829 2929 2022  s.edgesets())) "
+0005f6d0: 0a20 2020 2020 2020 2020 2020 2022 7768  .            "wh
+0005f6e0: 6963 6820 7368 6f75 6c64 2072 6574 7572  ich should retur
+0005f6f0: 6e20 7468 6520 6e75 6d62 6572 206f 6620  n the number of 
+0005f700: 636f 616c 6573 6365 6e63 6520 7265 636f  coalescence reco
+0005f710: 7264 732c 2061 7320 7072 6576 696f 7573  rds, as previous
+0005f720: 6c79 2022 0a20 2020 2020 2020 2020 2020  ly ".           
+0005f730: 2022 6465 6669 6e65 642e 2050 6c65 6173   "defined. Pleas
+0005f740: 6520 6f70 656e 2061 6e20 6973 7375 6520  e open an issue 
+0005f750: 6f6e 2047 6974 4875 6220 6966 2074 6869  on GitHub if thi
+0005f760: 7320 6973 2022 0a20 2020 2020 2020 2020  s is ".         
+0005f770: 2020 2022 696d 706f 7274 616e 7420 666f     "important fo
+0005f780: 7220 796f 7572 2077 6f72 6b66 6c6f 772e  r your workflow.
+0005f790: 220a 2020 2020 2020 2020 290a 0a20 2020  ".        )..   
+0005f7a0: 2064 6566 2064 6966 6673 2873 656c 6629   def diffs(self)
+0005f7b0: 3a0a 2020 2020 2020 2020 7261 6973 6520  :.        raise 
+0005f7c0: 4e6f 7449 6d70 6c65 6d65 6e74 6564 4572  NotImplementedEr
+0005f7d0: 726f 7228 0a20 2020 2020 2020 2020 2020  ror(.           
+0005f7e0: 2022 5468 6973 206d 6574 686f 6420 6973   "This method is
+0005f7f0: 206e 6f20 6c6f 6e67 6572 2073 7570 706f   no longer suppo
+0005f800: 7274 6564 2e20 506c 6561 7365 2075 7365  rted. Please use
+0005f810: 2074 6865 2022 0a20 2020 2020 2020 2020   the ".         
+0005f820: 2020 2022 5472 6565 5365 7175 656e 6365     "TreeSequence
+0005f830: 2e65 6467 655f 6469 6666 7328 2920 6d65  .edge_diffs() me
+0005f840: 7468 6f64 2069 6e73 7465 6164 220a 2020  thod instead".  
+0005f850: 2020 2020 2020 290a 0a20 2020 2064 6566        )..    def
+0005f860: 206e 6577 6963 6b5f 7472 6565 7328 7365   newick_trees(se
+0005f870: 6c66 2c20 7072 6563 6973 696f 6e3d 332c  lf, precision=3,
+0005f880: 2062 7265 616b 706f 696e 7473 3d4e 6f6e   breakpoints=Non
+0005f890: 652c 204e 653d 3129 3a0a 2020 2020 2020  e, Ne=1):.      
+0005f8a0: 2020 7261 6973 6520 4e6f 7449 6d70 6c65    raise NotImple
+0005f8b0: 6d65 6e74 6564 4572 726f 7228 0a20 2020  mentedError(.   
+0005f8c0: 2020 2020 2020 2020 2022 5468 6973 206d           "This m
+0005f8d0: 6574 686f 6420 6973 206e 6f20 6c6f 6e67  ethod is no long
+0005f8e0: 6572 2073 7570 706f 7274 6564 2e20 506c  er supported. Pl
+0005f8f0: 6561 7365 2075 7365 2074 6865 2054 7265  ease use the Tre
+0005f900: 652e 6e65 7769 636b 220a 2020 2020 2020  e.newick".      
+0005f910: 2020 2020 2020 2220 6d65 7468 6f64 2069        " method i
+0005f920: 6e73 7465 6164 220a 2020 2020 2020 2020  nstead".        
+0005f930: 290a 0a20 2020 2064 6566 2074 6f5f 6e65  )..    def to_ne
+0005f940: 7875 7328 7365 6c66 2c20 7072 6563 6973  xus(self, precis
+0005f950: 696f 6e3d 3134 293a 0a20 2020 2020 2020  ion=14):.       
+0005f960: 2072 6169 7365 204e 6f74 496d 706c 656d   raise NotImplem
+0005f970: 656e 7465 6445 7272 6f72 280a 2020 2020  entedError(.    
+0005f980: 2020 2020 2020 2020 2254 6869 7320 6d65          "This me
+0005f990: 7468 6f64 2069 7320 6e6f 206c 6f6e 6765  thod is no longe
+0005f9a0: 7220 7375 7070 6f72 7465 6420 7369 6e63  r supported sinc
+0005f9b0: 6520 302e 342e 302e 2050 6c65 6173 6520  e 0.4.0. Please 
+0005f9c0: 7573 6520 7468 6520 6173 5f6e 6578 7573  use the as_nexus
+0005f9d0: 2022 0a20 2020 2020 2020 2020 2020 2022   ".            "
+0005f9e0: 6f72 2077 7269 7465 5f6e 6578 7573 206d  or write_nexus m
+0005f9f0: 6574 686f 6473 2069 6e73 7465 6164 220a  ethods instead".
+0005fa00: 2020 2020 2020 2020 290a 0a0a 2320 544f          )...# TO
+0005fa10: 444f 206d 6f76 6520 746f 2022 7465 7874  DO move to "text
+0005fa20: 5f66 6f72 6d61 7473 2e70 7922 0a64 6566  _formats.py".def
+0005fa30: 2077 7269 7465 5f6d 7328 0a20 2020 2074   write_ms(.    t
+0005fa40: 7265 655f 7365 7175 656e 6365 2c0a 2020  ree_sequence,.  
+0005fa50: 2020 6f75 7470 7574 2c0a 2020 2020 7072    output,.    pr
+0005fa60: 696e 745f 7472 6565 733d 4661 6c73 652c  int_trees=False,
+0005fa70: 0a20 2020 2070 7265 6369 7369 6f6e 3d34  .    precision=4
+0005fa80: 2c0a 2020 2020 6e75 6d5f 7265 706c 6963  ,.    num_replic
+0005fa90: 6174 6573 3d31 2c0a 2020 2020 7772 6974  ates=1,.    writ
+0005faa0: 655f 6865 6164 6572 3d54 7275 652c 0a29  e_header=True,.)
+0005fab0: 3a0a 2020 2020 2222 220a 2020 2020 5772  :.    """.    Wr
+0005fac0: 6974 6520 6060 6d73 6060 2066 6f72 6d61  ite ``ms`` forma
+0005fad0: 7474 6564 206f 7574 7075 7420 6672 6f6d  tted output from
+0005fae0: 2074 6865 2067 656e 6f74 7970 6573 206f   the genotypes o
+0005faf0: 6620 6120 7472 6565 2073 6571 7565 6e63  f a tree sequenc
+0005fb00: 650a 2020 2020 6f72 2061 6e20 6974 6572  e.    or an iter
+0005fb10: 6174 6f72 206f 7665 7220 7472 6565 2073  ator over tree s
+0005fb20: 6571 7565 6e63 6573 2e20 5573 6167 653a  equences. Usage:
+0005fb30: 0a0a 2020 2020 2e2e 2063 6f64 652d 626c  ..    .. code-bl
+0005fb40: 6f63 6b3a 3a20 7079 7468 6f6e 0a0a 2020  ock:: python..  
+0005fb50: 2020 2020 2020 696d 706f 7274 2074 736b        import tsk
+0005fb60: 6974 2061 7320 7473 0a0a 2020 2020 2020  it as ts..      
+0005fb70: 2020 7472 6565 5f73 6571 7565 6e63 6520    tree_sequence 
+0005fb80: 3d20 6d73 7072 696d 652e 7369 6d75 6c61  = msprime.simula
+0005fb90: 7465 280a 2020 2020 2020 2020 2020 2020  te(.            
+0005fba0: 7361 6d70 6c65 5f73 697a 653d 7361 6d70  sample_size=samp
+0005fbb0: 6c65 5f73 697a 652c 0a20 2020 2020 2020  le_size,.       
+0005fbc0: 2020 2020 204e 653d 4e65 2c0a 2020 2020       Ne=Ne,.    
+0005fbd0: 2020 2020 2020 2020 6c65 6e67 7468 3d6c          length=l
+0005fbe0: 656e 6774 682c 0a20 2020 2020 2020 2020  ength,.         
+0005fbf0: 2020 206d 7574 6174 696f 6e5f 7261 7465     mutation_rate
+0005fc00: 3d6d 7574 6174 696f 6e5f 7261 7465 2c0a  =mutation_rate,.
+0005fc10: 2020 2020 2020 2020 2020 2020 7265 636f              reco
+0005fc20: 6d62 696e 6174 696f 6e5f 7261 7465 3d72  mbination_rate=r
+0005fc30: 6563 6f6d 6269 6e61 7469 6f6e 5f72 6174  ecombination_rat
+0005fc40: 652c 0a20 2020 2020 2020 2020 2020 2072  e,.            r
+0005fc50: 616e 646f 6d5f 7365 6564 3d72 616e 646f  andom_seed=rando
+0005fc60: 6d5f 7365 6564 2c0a 2020 2020 2020 2020  m_seed,.        
+0005fc70: 2020 2020 6e75 6d5f 7265 706c 6963 6174      num_replicat
+0005fc80: 6573 3d6e 756d 5f72 6570 6c69 6361 7465  es=num_replicate
+0005fc90: 732c 0a20 2020 2020 2020 2029 0a20 2020  s,.        ).   
+0005fca0: 2020 2020 2077 6974 6820 6f70 656e 2822       with open("
+0005fcb0: 6f75 7470 7574 2e6d 7322 2c20 2277 2229  output.ms", "w")
+0005fcc0: 2061 7320 6d73 5f66 696c 653a 0a20 2020   as ms_file:.   
+0005fcd0: 2020 2020 2020 2020 2074 732e 7772 6974           ts.writ
+0005fce0: 655f 6d73 2874 7265 655f 7365 7175 656e  e_ms(tree_sequen
+0005fcf0: 6365 2c20 6d73 5f66 696c 6529 0a0a 2020  ce, ms_file)..  
+0005fd00: 2020 3a70 6172 616d 2074 7320 7472 6565    :param ts tree
+0005fd10: 5f73 6571 7565 6e63 653a 2054 6865 2074  _sequence: The t
+0005fd20: 7265 6520 7365 7175 656e 6365 2028 6f72  ree sequence (or
+0005fd30: 2069 7465 7261 746f 7220 6f76 6572 2074   iterator over t
+0005fd40: 7265 6520 7365 7175 656e 6365 7329 2074  ree sequences) t
+0005fd50: 6f0a 2020 2020 2020 2020 7772 6974 6520  o.        write 
+0005fd60: 746f 206d 7320 6669 6c65 0a20 2020 203a  to ms file.    :
+0005fd70: 7061 7261 6d20 696f 2e49 4f42 6173 6520  param io.IOBase 
+0005fd80: 6f75 7470 7574 3a20 5468 6520 6669 6c65  output: The file
+0005fd90: 2d6c 696b 6520 6f62 6a65 6374 2074 6f20  -like object to 
+0005fda0: 7772 6974 6520 7468 6520 6d73 2d73 7479  write the ms-sty
+0005fdb0: 6c65 206f 7574 7075 740a 2020 2020 3a70  le output.    :p
+0005fdc0: 6172 616d 2062 6f6f 6c20 7072 696e 745f  aram bool print_
+0005fdd0: 7472 6565 733a 2042 6f6f 6c65 616e 2070  trees: Boolean p
+0005fde0: 6172 616d 6574 6572 2074 6f20 7772 6974  arameter to writ
+0005fdf0: 6520 6f75 7420 6e65 7769 636b 2066 6f72  e out newick for
+0005fe00: 6d61 7420 7472 6565 730a 2020 2020 2020  mat trees.      
+0005fe10: 2020 746f 206f 7574 7075 7420 5b6f 7074    to output [opt
+0005fe20: 696f 6e61 6c5d 0a20 2020 203a 7061 7261  ional].    :para
+0005fe30: 6d20 696e 7420 7072 6563 6973 696f 6e3a  m int precision:
+0005fe40: 204e 756d 6572 6963 616c 2070 7265 6369   Numerical preci
+0005fe50: 7369 6f6e 2077 6974 6820 7768 6963 6820  sion with which 
+0005fe60: 746f 2077 7269 7465 2074 6865 206d 730a  to write the ms.
+0005fe70: 2020 2020 2020 2020 6f75 7470 7574 205b          output [
+0005fe80: 6f70 7469 6f6e 616c 5d0a 2020 2020 3a70  optional].    :p
+0005fe90: 6172 616d 2062 6f6f 6c20 7772 6974 655f  aram bool write_
+0005fea0: 6865 6164 6572 3a20 426f 6f6c 6561 6e20  header: Boolean 
+0005feb0: 7061 7261 6d65 7465 7220 746f 2077 7269  parameter to wri
+0005fec0: 7465 206f 7574 2074 6865 2068 6561 6465  te out the heade
+0005fed0: 722e 205b 6f70 7469 6f6e 616c 5d0a 2020  r. [optional].  
+0005fee0: 2020 3a70 6172 616d 2069 6e74 206e 756d    :param int num
+0005fef0: 5f72 6570 6c69 6361 7465 733a 204e 756d  _replicates: Num
+0005ff00: 6265 7220 6f66 2072 6570 6c69 6361 7465  ber of replicate
+0005ff10: 7320 7369 6d75 6c61 7465 6420 5b72 6571  s simulated [req
+0005ff20: 7569 7265 6420 6966 0a20 2020 2020 2020  uired if.       
+0005ff30: 206e 756d 5f72 6570 6c69 6361 7465 7320   num_replicates 
+0005ff40: 7573 6564 2069 6e20 7369 6d75 6c61 7469  used in simulati
+0005ff50: 6f6e 5d0a 0a20 2020 2054 6865 2066 6972  on]..    The fir
+0005ff60: 7374 206c 696e 6520 6f66 2074 6869 7320  st line of this 
+0005ff70: 6d73 2d73 7479 6c65 206f 7574 7075 7420  ms-style output 
+0005ff80: 6669 6c65 2077 7269 7474 656e 2068 6173  file written has
+0005ff90: 2074 776f 2061 7267 756d 656e 7473 2077   two arguments w
+0005ffa0: 6869 6368 0a20 2020 2061 7265 2073 616d  hich.    are sam
+0005ffb0: 706c 6520 7369 7a65 2061 6e64 206e 756d  ple size and num
+0005ffc0: 6265 7220 6f66 2072 6570 6c69 6361 7465  ber of replicate
+0005ffd0: 732e 2054 6865 2073 6563 6f6e 6420 6c69  s. The second li
+0005ffe0: 6e65 2068 6173 2061 2030 2061 7320 6120  ne has a 0 as a 
+0005fff0: 7375 6273 7469 7475 7465 0a20 2020 2066  substitute.    f
+00060000: 6f72 2074 6865 2072 616e 646f 6d20 7365  or the random se
+00060010: 6564 2e0a 2020 2020 2222 220a 2020 2020  ed..    """.    
+00060020: 6966 206e 6f74 2069 7369 6e73 7461 6e63  if not isinstanc
+00060030: 6528 7472 6565 5f73 6571 7565 6e63 652c  e(tree_sequence,
+00060040: 2063 6f6c 6c65 6374 696f 6e73 2e61 6263   collections.abc
+00060050: 2e49 7465 7261 626c 6529 3a0a 2020 2020  .Iterable):.    
+00060060: 2020 2020 7472 6565 5f73 6571 7565 6e63      tree_sequenc
+00060070: 6520 3d20 5b74 7265 655f 7365 7175 656e  e = [tree_sequen
+00060080: 6365 5d0a 0a20 2020 2069 203d 2030 0a20  ce]..    i = 0. 
+00060090: 2020 2066 6f72 2074 7265 655f 7365 7120     for tree_seq 
+000600a0: 696e 2074 7265 655f 7365 7175 656e 6365  in tree_sequence
+000600b0: 3a0a 2020 2020 2020 2020 6966 2069 203e  :.        if i >
+000600c0: 2030 3a0a 2020 2020 2020 2020 2020 2020   0:.            
+000600d0: 7772 6974 655f 6865 6164 6572 203d 2046  write_header = F
+000600e0: 616c 7365 0a20 2020 2020 2020 2069 203d  alse.        i =
+000600f0: 2069 202b 2031 0a0a 2020 2020 2020 2020   i + 1..        
+00060100: 6966 2077 7269 7465 5f68 6561 6465 7220  if write_header 
+00060110: 6973 2054 7275 653a 0a20 2020 2020 2020  is True:.       
+00060120: 2020 2020 2070 7269 6e74 280a 2020 2020       print(.    
+00060130: 2020 2020 2020 2020 2020 2020 6622 6d73              f"ms
+00060140: 207b 7472 6565 5f73 6571 2e73 616d 706c   {tree_seq.sampl
+00060150: 655f 7369 7a65 7d20 7b6e 756d 5f72 6570  e_size} {num_rep
+00060160: 6c69 6361 7465 737d 222c 0a20 2020 2020  licates}",.     
+00060170: 2020 2020 2020 2020 2020 2066 696c 653d             file=
+00060180: 6f75 7470 7574 2c0a 2020 2020 2020 2020  output,.        
+00060190: 2020 2020 290a 2020 2020 2020 2020 2020      ).          
+000601a0: 2020 7072 696e 7428 2230 222c 2066 696c    print("0", fil
+000601b0: 653d 6f75 7470 7574 290a 0a20 2020 2020  e=output)..     
+000601c0: 2020 2070 7269 6e74 2866 696c 653d 6f75     print(file=ou
+000601d0: 7470 7574 290a 2020 2020 2020 2020 7072  tput).        pr
+000601e0: 696e 7428 222f 2f22 2c20 6669 6c65 3d6f  int("//", file=o
+000601f0: 7574 7075 7429 0a20 2020 2020 2020 2069  utput).        i
+00060200: 6620 7072 696e 745f 7472 6565 7320 6973  f print_trees is
+00060210: 2054 7275 653a 0a20 2020 2020 2020 2020   True:.         
+00060220: 2020 2022 2222 0a20 2020 2020 2020 2020     """.         
+00060230: 2020 2050 7269 6e74 206f 7574 2074 6865     Print out the
+00060240: 2074 7265 6573 2069 6e20 6d73 2d66 6f72   trees in ms-for
+00060250: 6d61 7420 6672 6f6d 2074 6865 2073 7065  mat from the spe
+00060260: 6369 6669 6564 2074 7265 6520 7365 7175  cified tree sequ
+00060270: 656e 6365 2e0a 2020 2020 2020 2020 2020  ence..          
+00060280: 2020 2222 220a 2020 2020 2020 2020 2020    """.          
+00060290: 2020 6966 206c 656e 2874 7265 655f 7365    if len(tree_se
+000602a0: 712e 7472 6565 7328 2929 203d 3d20 313a  q.trees()) == 1:
+000602b0: 0a20 2020 2020 2020 2020 2020 2020 2020  .               
+000602c0: 2074 7265 6520 3d20 6e65 7874 2874 7265   tree = next(tre
+000602d0: 655f 7365 712e 7472 6565 7328 2929 0a20  e_seq.trees()). 
+000602e0: 2020 2020 2020 2020 2020 2020 2020 206e                 n
+000602f0: 6577 6963 6b20 3d20 7472 6565 2e6e 6577  ewick = tree.new
+00060300: 6963 6b28 7072 6563 6973 696f 6e3d 7072  ick(precision=pr
+00060310: 6563 6973 696f 6e29 0a20 2020 2020 2020  ecision).       
+00060320: 2020 2020 2020 2020 2070 7269 6e74 286e           print(n
+00060330: 6577 6963 6b2c 2066 696c 653d 6f75 7470  ewick, file=outp
+00060340: 7574 290a 2020 2020 2020 2020 2020 2020  ut).            
+00060350: 656c 7365 3a0a 2020 2020 2020 2020 2020  else:.          
+00060360: 2020 2020 2020 666f 7220 7472 6565 2069        for tree i
+00060370: 6e20 7472 6565 5f73 6571 2e74 7265 6573  n tree_seq.trees
+00060380: 2829 3a0a 2020 2020 2020 2020 2020 2020  ():.            
+00060390: 2020 2020 2020 2020 6e65 7769 636b 203d          newick =
+000603a0: 2074 7265 652e 6e65 7769 636b 2870 7265   tree.newick(pre
+000603b0: 6369 7369 6f6e 3d70 7265 6369 7369 6f6e  cision=precision
+000603c0: 290a 2020 2020 2020 2020 2020 2020 2020  ).              
+000603d0: 2020 2020 2020 7072 696e 7428 6622 5b7b        print(f"[{
+000603e0: 7472 6565 2e73 7061 6e3a 2e7b 7072 6563  tree.span:.{prec
+000603f0: 6973 696f 6e7d 667d 5d22 2c20 6e65 7769  ision}f}]", newi
+00060400: 636b 2c20 6669 6c65 3d6f 7574 7075 7429  ck, file=output)
+00060410: 0a0a 2020 2020 2020 2020 656c 7365 3a0a  ..        else:.
+00060420: 2020 2020 2020 2020 2020 2020 7320 3d20              s = 
+00060430: 7472 6565 5f73 6571 2e67 6574 5f6e 756d  tree_seq.get_num
+00060440: 5f73 6974 6573 2829 0a20 2020 2020 2020  _sites().       
+00060450: 2020 2020 2070 7269 6e74 2822 7365 6773       print("segs
+00060460: 6974 6573 3a22 2c20 732c 2066 696c 653d  ites:", s, file=
+00060470: 6f75 7470 7574 290a 2020 2020 2020 2020  output).        
+00060480: 2020 2020 6966 2073 2021 3d20 303a 0a20      if s != 0:. 
+00060490: 2020 2020 2020 2020 2020 2020 2020 2070                 p
+000604a0: 7269 6e74 2822 706f 7369 7469 6f6e 733a  rint("positions:
+000604b0: 2022 2c20 656e 643d 2222 2c20 6669 6c65   ", end="", file
+000604c0: 3d6f 7574 7075 7429 0a20 2020 2020 2020  =output).       
+000604d0: 2020 2020 2020 2020 2070 6f73 6974 696f           positio
+000604e0: 6e73 203d 205b 0a20 2020 2020 2020 2020  ns = [.         
+000604f0: 2020 2020 2020 2020 2020 2076 6172 6961             varia
+00060500: 6e74 2e70 6f73 6974 696f 6e20 2f20 2874  nt.position / (t
+00060510: 7265 655f 7365 712e 7365 7175 656e 6365  ree_seq.sequence
+00060520: 5f6c 656e 6774 6829 0a20 2020 2020 2020  _length).       
+00060530: 2020 2020 2020 2020 2020 2020 2066 6f72               for
+00060540: 2076 6172 6961 6e74 2069 6e20 7472 6565   variant in tree
+00060550: 5f73 6571 2e76 6172 6961 6e74 7328 290a  _seq.variants().
+00060560: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00060570: 5d0a 2020 2020 2020 2020 2020 2020 2020  ].              
+00060580: 2020 666f 7220 706f 7369 7469 6f6e 2069    for position i
+00060590: 6e20 706f 7369 7469 6f6e 733a 0a20 2020  n positions:.   
+000605a0: 2020 2020 2020 2020 2020 2020 2020 2020                  
+000605b0: 2070 7269 6e74 280a 2020 2020 2020 2020   print(.        
+000605c0: 2020 2020 2020 2020 2020 2020 2020 2020                  
+000605d0: 6622 7b70 6f73 6974 696f 6e3a 2e7b 7072  f"{position:.{pr
+000605e0: 6563 6973 696f 6e7d 667d 222c 0a20 2020  ecision}f}",.   
+000605f0: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00060600: 2020 2020 2065 6e64 3d22 2022 2c0a 2020       end=" ",.  
+00060610: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00060620: 2020 2020 2020 6669 6c65 3d6f 7574 7075        file=outpu
+00060630: 742c 0a20 2020 2020 2020 2020 2020 2020  t,.             
+00060640: 2020 2020 2020 2029 0a20 2020 2020 2020         ).       
+00060650: 2020 2020 2020 2020 2070 7269 6e74 2866           print(f
+00060660: 696c 653d 6f75 7470 7574 290a 0a20 2020  ile=output)..   
+00060670: 2020 2020 2020 2020 2020 2020 2067 656e               gen
+00060680: 6f74 7970 6573 203d 2074 7265 655f 7365  otypes = tree_se
+00060690: 712e 6765 6e6f 7479 7065 5f6d 6174 7269  q.genotype_matri
+000606a0: 7828 290a 2020 2020 2020 2020 2020 2020  x().            
+000606b0: 2020 2020 666f 7220 6b20 696e 2072 616e      for k in ran
+000606c0: 6765 2874 7265 655f 7365 712e 6e75 6d5f  ge(tree_seq.num_
+000606d0: 7361 6d70 6c65 7329 3a0a 2020 2020 2020  samples):.      
+000606e0: 2020 2020 2020 2020 2020 2020 2020 746d                tm
+000606f0: 705f 7374 7220 3d20 2222 2e6a 6f69 6e28  p_str = "".join(
+00060700: 6d61 7028 7374 722c 2067 656e 6f74 7970  map(str, genotyp
+00060710: 6573 5b3a 2c20 6b5d 2929 0a20 2020 2020  es[:, k])).     
+00060720: 2020 2020 2020 2020 2020 2020 2020 2069                 i
+00060730: 6620 7365 7428 746d 705f 7374 7229 2e69  f set(tmp_str).i
+00060740: 7373 7562 7365 7428 7b22 3022 2c20 2231  ssubset({"0", "1
+00060750: 222c 2022 2d22 7d29 3a0a 2020 2020 2020  ", "-"}):.      
+00060760: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00060770: 2020 7072 696e 7428 746d 705f 7374 722c    print(tmp_str,
+00060780: 2066 696c 653d 6f75 7470 7574 290a 2020   file=output).  
+00060790: 2020 2020 2020 2020 2020 2020 2020 2020                  
+000607a0: 2020 656c 7365 3a0a 2020 2020 2020 2020    else:.        
+000607b0: 2020 2020 2020 2020 2020 2020 2020 2020                  
+000607c0: 7261 6973 6520 5661 6c75 6545 7272 6f72  raise ValueError
+000607d0: 280a 2020 2020 2020 2020 2020 2020 2020  (.              
+000607e0: 2020 2020 2020 2020 2020 2020 2020 2254                "T
+000607f0: 6869 7320 7472 6565 2073 6571 7565 6e63  his tree sequenc
+00060800: 6520 636f 6e74 6169 6e73 206e 6f6e 2d62  e contains non-b
+00060810: 6961 6c6c 656c 6963 220a 2020 2020 2020  iallelic".      
+00060820: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00060830: 2020 2020 2020 2253 4e50 7320 616e 6420        "SNPs and 
+00060840: 6973 2069 6e63 6f6d 7061 7469 626c 6520  is incompatible 
+00060850: 7769 7468 2074 6865 206d 7320 666f 726d  with the ms form
+00060860: 6174 2122 0a20 2020 2020 2020 2020 2020  at!".           
+00060870: 2020 2020 2020 2020 2020 2020 2029 0a20               ). 
+00060880: 2020 2020 2020 2020 2020 2065 6c73 653a             else:
+00060890: 0a20 2020 2020 2020 2020 2020 2020 2020  .               
+000608a0: 2070 7269 6e74 2866 696c 653d 6f75 7470   print(file=outp
+000608b0: 7574 290a                                ut).
```

### Comparing `tskit-0.5.4/tskit/util.py` & `tskit-0.5.5/tskit/util.py`

 * *Files identical despite different names*

### Comparing `tskit-0.5.4/tskit/vcf.py` & `tskit-0.5.5/tskit/vcf.py`

 * *Files identical despite different names*

### Comparing `tskit-0.5.4/tskit.egg-info/PKG-INFO` & `tskit-0.5.5/tskit.egg-info/PKG-INFO`

 * *Files 0% similar despite different names*

```diff
@@ -1,10 +1,10 @@
 Metadata-Version: 2.1
 Name: tskit
-Version: 0.5.4
+Version: 0.5.5
 Summary: The tree sequence toolkit.
 Home-page: https://tskit.dev/tskit
 Author: Tskit Developers
 Author-email: admin@tskit.dev
 License: MIT
 Project-URL: Documentation, https://tskit.dev/tskit/docs/stable
 Project-URL: Changelog, https://tskit.dev/tskit/docs/stable/changelogs.html
```

### Comparing `tskit-0.5.4/tskit.egg-info/SOURCES.txt` & `tskit-0.5.5/tskit.egg-info/SOURCES.txt`

 * *Files identical despite different names*

