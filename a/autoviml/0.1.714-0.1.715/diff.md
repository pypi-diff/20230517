# Comparing `tmp/autoviml-0.1.714.tar.gz` & `tmp/autoviml-0.1.715.tar.gz`

## filetype from file(1)

```diff
@@ -1 +1 @@
-gzip compressed data, was "autoviml-0.1.714.tar", last modified: Wed Apr 19 11:32:58 2023, max compression
+gzip compressed data, was "autoviml-0.1.715.tar", last modified: Wed May 17 13:03:35 2023, max compression
```

## Comparing `autoviml-0.1.714.tar` & `autoviml-0.1.715.tar`

 * *Command `'html2text {}'` failed with exit code 1. (No output)*

```diff
@@ -2,16 +2,16 @@
 00000010: 0000 0000 0000 0000 0000 0000 0000 0000  ................
 00000020: 0000 0000 0000 0000 0000 0000 0000 0000  ................
 00000030: 0000 0000 0000 0000 0000 0000 0000 0000  ................
 00000040: 0000 0000 0000 0000 0000 0000 0000 0000  ................
 00000050: 0000 0000 0000 0000 0000 0000 0000 0000  ................
 00000060: 0000 0000 3030 3030 3030 3000 3030 3030  ....0000000.0000
 00000070: 3030 3000 3030 3030 3030 3000 3030 3030  000.0000000.0000
-00000080: 3030 3030 3033 3300 3030 3030 3030 3030  0000033.00000000
-00000090: 3030 3000 3031 3134 3531 0020 7800 0000  000.011451. x...
+00000080: 3030 3030 3033 3400 3030 3030 3030 3030  0000034.00000000
+00000090: 3030 3000 3031 3134 3532 0020 7800 0000  000.011452. x...
 000000a0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
 000000b0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
 000000c0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
 000000d0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
 000000e0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
 000000f0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
 00000100: 0075 7374 6172 0030 3000 0000 0000 0000  .ustar.00.......
@@ -26,16 +26,16 @@
 00000190: 0000 0000 0000 0000 0000 0000 0000 0000  ................
 000001a0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
 000001b0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
 000001c0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
 000001d0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
 000001e0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
 000001f0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-00000200: 3237 206d 7469 6d65 3d31 3638 3139 3033  27 mtime=1681903
-00000210: 3937 382e 3731 3039 3932 0a00 0000 0000  978.710992......
+00000200: 3238 206d 7469 6d65 3d31 3638 3433 3238  28 mtime=1684328
+00000210: 3631 352e 3839 3532 3238 390a 0000 0000  615.8952289.....
 00000220: 0000 0000 0000 0000 0000 0000 0000 0000  ................
 00000230: 0000 0000 0000 0000 0000 0000 0000 0000  ................
 00000240: 0000 0000 0000 0000 0000 0000 0000 0000  ................
 00000250: 0000 0000 0000 0000 0000 0000 0000 0000  ................
 00000260: 0000 0000 0000 0000 0000 0000 0000 0000  ................
 00000270: 0000 0000 0000 0000 0000 0000 0000 0000  ................
 00000280: 0000 0000 0000 0000 0000 0000 0000 0000  ................
@@ -58,24 +58,24 @@
 00000390: 0000 0000 0000 0000 0000 0000 0000 0000  ................
 000003a0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
 000003b0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
 000003c0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
 000003d0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
 000003e0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
 000003f0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-00000400: 6175 746f 7669 6d6c 2d30 2e31 2e37 3134  autoviml-0.1.714
+00000400: 6175 746f 7669 6d6c 2d30 2e31 2e37 3135  autoviml-0.1.715
 00000410: 2f00 0000 0000 0000 0000 0000 0000 0000  /...............
 00000420: 0000 0000 0000 0000 0000 0000 0000 0000  ................
 00000430: 0000 0000 0000 0000 0000 0000 0000 0000  ................
 00000440: 0000 0000 0000 0000 0000 0000 0000 0000  ................
 00000450: 0000 0000 0000 0000 0000 0000 0000 0000  ................
 00000460: 0000 0000 3030 3030 3737 3700 3030 3031  ....0000777.0001
 00000470: 3735 3000 3030 3031 3735 3000 3030 3030  750.0001750.0000
 00000480: 3030 3030 3030 3000 3030 3030 3030 3030  0000000.00000000
-00000490: 3030 3000 3031 3331 3131 0020 3500 0000  000.013111. 5...
+00000490: 3030 3000 3031 3331 3132 0020 3500 0000  000.013112. 5...
 000004a0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
 000004b0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
 000004c0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
 000004d0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
 000004e0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
 000004f0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
 00000500: 0075 7374 6172 0030 3072 616d 0000 0000  .ustar.00ram....
@@ -122,16 +122,16 @@
 00000790: 0000 0000 0000 0000 0000 0000 0000 0000  ................
 000007a0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
 000007b0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
 000007c0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
 000007d0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
 000007e0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
 000007f0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-00000800: 3238 206d 7469 6d65 3d31 3638 3139 3033  28 mtime=1681903
-00000810: 3937 382e 3731 3339 3933 380a 0000 0000  978.7139938.....
+00000800: 3238 206d 7469 6d65 3d31 3638 3433 3238  28 mtime=1684328
+00000810: 3631 352e 3839 3532 3238 390a 0000 0000  615.8952289.....
 00000820: 0000 0000 0000 0000 0000 0000 0000 0000  ................
 00000830: 0000 0000 0000 0000 0000 0000 0000 0000  ................
 00000840: 0000 0000 0000 0000 0000 0000 0000 0000  ................
 00000850: 0000 0000 0000 0000 0000 0000 0000 0000  ................
 00000860: 0000 0000 0000 0000 0000 0000 0000 0000  ................
 00000870: 0000 0000 0000 0000 0000 0000 0000 0000  ................
 00000880: 0000 0000 0000 0000 0000 0000 0000 0000  ................
@@ -154,24 +154,24 @@
 00000990: 0000 0000 0000 0000 0000 0000 0000 0000  ................
 000009a0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
 000009b0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
 000009c0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
 000009d0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
 000009e0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
 000009f0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-00000a00: 6175 746f 7669 6d6c 2d30 2e31 2e37 3134  autoviml-0.1.714
+00000a00: 6175 746f 7669 6d6c 2d30 2e31 2e37 3135  autoviml-0.1.715
 00000a10: 2f50 4b47 2d49 4e46 4f00 0000 0000 0000  /PKG-INFO.......
 00000a20: 0000 0000 0000 0000 0000 0000 0000 0000  ................
 00000a30: 0000 0000 0000 0000 0000 0000 0000 0000  ................
 00000a40: 0000 0000 0000 0000 0000 0000 0000 0000  ................
 00000a50: 0000 0000 0000 0000 0000 0000 0000 0000  ................
 00000a60: 0000 0000 3030 3030 3737 3700 3030 3031  ....0000777.0001
 00000a70: 3735 3000 3030 3031 3735 3000 3030 3030  750.0001750.0000
 00000a80: 3030 3335 3137 3400 3030 3030 3030 3030  0035174.00000000
-00000a90: 3030 3000 3031 3432 3233 0020 3000 0000  000.014223. 0...
+00000a90: 3030 3000 3031 3432 3234 0020 3000 0000  000.014224. 0...
 00000aa0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
 00000ab0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
 00000ac0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
 00000ad0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
 00000ae0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
 00000af0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
 00000b00: 0075 7374 6172 0030 3072 616d 0000 0000  .ustar.00ram....
@@ -189,15 +189,15 @@
 00000bc0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
 00000bd0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
 00000be0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
 00000bf0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
 00000c00: 4d65 7461 6461 7461 2d56 6572 7369 6f6e  Metadata-Version
 00000c10: 3a20 322e 310a 4e61 6d65 3a20 6175 746f  : 2.1.Name: auto
 00000c20: 7669 6d6c 0a56 6572 7369 6f6e 3a20 302e  viml.Version: 0.
-00000c30: 312e 3731 340a 5375 6d6d 6172 793a 2041  1.714.Summary: A
+00000c30: 312e 3731 350a 5375 6d6d 6172 793a 2041  1.715.Summary: A
 00000c40: 7574 6f6d 6174 6963 616c 6c79 2042 7569  utomatically Bui
 00000c50: 6c64 2056 6172 6961 6e74 2049 6e74 6572  ld Variant Inter
 00000c60: 7072 6574 6162 6c65 204d 4c20 6d6f 6465  pretable ML mode
 00000c70: 6c73 2066 6173 7420 2d20 6e6f 7720 7769  ls fast - now wi
 00000c80: 7468 2043 6174 426f 6f73 7421 0a48 6f6d  th CatBoost!.Hom
 00000c90: 652d 7061 6765 3a20 6874 7470 733a 2f2f  e-page: https://
 00000ca0: 6769 7468 7562 2e63 6f6d 2f41 7574 6f56  github.com/AutoV
@@ -1210,24 +1210,24 @@
 00004b90: 0000 0000 0000 0000 0000 0000 0000 0000  ................
 00004ba0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
 00004bb0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
 00004bc0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
 00004bd0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
 00004be0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
 00004bf0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-00004c00: 6175 746f 7669 6d6c 2d30 2e31 2e37 3134  autoviml-0.1.714
+00004c00: 6175 746f 7669 6d6c 2d30 2e31 2e37 3135  autoviml-0.1.715
 00004c10: 2f52 4541 444d 452e 6d64 0000 0000 0000  /README.md......
 00004c20: 0000 0000 0000 0000 0000 0000 0000 0000  ................
 00004c30: 0000 0000 0000 0000 0000 0000 0000 0000  ................
 00004c40: 0000 0000 0000 0000 0000 0000 0000 0000  ................
 00004c50: 0000 0000 0000 0000 0000 0000 0000 0000  ................
 00004c60: 0000 0000 3030 3030 3737 3700 3030 3031  ....0000777.0001
 00004c70: 3735 3000 3030 3031 3735 3000 3030 3030  750.0001750.0000
 00004c80: 3030 3331 3535 3600 3030 3030 3030 3030  0031556.00000000
-00004c90: 3030 3000 3031 3434 3035 0020 3000 0000  000.014405. 0...
+00004c90: 3030 3000 3031 3434 3036 0020 3000 0000  000.014406. 0...
 00004ca0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
 00004cb0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
 00004cc0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
 00004cd0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
 00004ce0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
 00004cf0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
 00004d00: 0075 7374 6172 0030 3072 616d 0000 0000  .ustar.00ram....
@@ -2082,16 +2082,16 @@
 00008210: 0000 0000 0000 0000 0000 0000 0000 0000  ................
 00008220: 0000 0000 0000 0000 0000 0000 0000 0000  ................
 00008230: 0000 0000 0000 0000 0000 0000 0000 0000  ................
 00008240: 0000 0000 0000 0000 0000 0000 0000 0000  ................
 00008250: 0000 0000 0000 0000 0000 0000 0000 0000  ................
 00008260: 0000 0000 3030 3030 3030 3000 3030 3030  ....0000000.0000
 00008270: 3030 3000 3030 3030 3030 3000 3030 3030  000.0000000.0000
-00008280: 3030 3030 3033 3400 3030 3030 3030 3030  0000034.00000000
-00008290: 3030 3000 3031 3134 3532 0020 7800 0000  000.011452. x...
+00008280: 3030 3030 3033 3300 3030 3030 3030 3030  0000033.00000000
+00008290: 3030 3000 3031 3134 3531 0020 7800 0000  000.011451. x...
 000082a0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
 000082b0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
 000082c0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
 000082d0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
 000082e0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
 000082f0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
 00008300: 0075 7374 6172 0030 3000 0000 0000 0000  .ustar.00.......
@@ -2106,16 +2106,16 @@
 00008390: 0000 0000 0000 0000 0000 0000 0000 0000  ................
 000083a0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
 000083b0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
 000083c0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
 000083d0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
 000083e0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
 000083f0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-00008400: 3238 206d 7469 6d65 3d31 3638 3139 3033  28 mtime=1681903
-00008410: 3937 382e 3531 3230 3730 370a 0000 0000  978.5120707.....
+00008400: 3237 206d 7469 6d65 3d31 3638 3433 3238  27 mtime=1684328
+00008410: 3631 352e 3732 3539 3638 0a00 0000 0000  615.725968......
 00008420: 0000 0000 0000 0000 0000 0000 0000 0000  ................
 00008430: 0000 0000 0000 0000 0000 0000 0000 0000  ................
 00008440: 0000 0000 0000 0000 0000 0000 0000 0000  ................
 00008450: 0000 0000 0000 0000 0000 0000 0000 0000  ................
 00008460: 0000 0000 0000 0000 0000 0000 0000 0000  ................
 00008470: 0000 0000 0000 0000 0000 0000 0000 0000  ................
 00008480: 0000 0000 0000 0000 0000 0000 0000 0000  ................
@@ -2138,24 +2138,24 @@
 00008590: 0000 0000 0000 0000 0000 0000 0000 0000  ................
 000085a0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
 000085b0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
 000085c0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
 000085d0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
 000085e0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
 000085f0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-00008600: 6175 746f 7669 6d6c 2d30 2e31 2e37 3134  autoviml-0.1.714
+00008600: 6175 746f 7669 6d6c 2d30 2e31 2e37 3135  autoviml-0.1.715
 00008610: 2f61 7574 6f76 696d 6c2f 0000 0000 0000  /autoviml/......
 00008620: 0000 0000 0000 0000 0000 0000 0000 0000  ................
 00008630: 0000 0000 0000 0000 0000 0000 0000 0000  ................
 00008640: 0000 0000 0000 0000 0000 0000 0000 0000  ................
 00008650: 0000 0000 0000 0000 0000 0000 0000 0000  ................
 00008660: 0000 0000 3030 3030 3737 3700 3030 3031  ....0000777.0001
 00008670: 3735 3000 3030 3031 3735 3000 3030 3030  750.0001750.0000
 00008680: 3030 3030 3030 3000 3030 3030 3030 3030  0000000.00000000
-00008690: 3030 3000 3031 3437 3531 0020 3500 0000  000.014751. 5...
+00008690: 3030 3000 3031 3437 3532 0020 3500 0000  000.014752. 5...
 000086a0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
 000086b0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
 000086c0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
 000086d0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
 000086e0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
 000086f0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
 00008700: 0075 7374 6172 0030 3072 616d 0000 0000  .ustar.00ram....
@@ -2234,24 +2234,24 @@
 00008b90: 0000 0000 0000 0000 0000 0000 0000 0000  ................
 00008ba0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
 00008bb0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
 00008bc0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
 00008bd0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
 00008be0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
 00008bf0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-00008c00: 6175 746f 7669 6d6c 2d30 2e31 2e37 3134  autoviml-0.1.714
+00008c00: 6175 746f 7669 6d6c 2d30 2e31 2e37 3135  autoviml-0.1.715
 00008c10: 2f61 7574 6f76 696d 6c2f 4175 746f 5f4e  /autoviml/Auto_N
 00008c20: 4c50 2e70 7900 0000 0000 0000 0000 0000  LP.py...........
 00008c30: 0000 0000 0000 0000 0000 0000 0000 0000  ................
 00008c40: 0000 0000 0000 0000 0000 0000 0000 0000  ................
 00008c50: 0000 0000 0000 0000 0000 0000 0000 0000  ................
 00008c60: 0000 0000 3030 3030 3737 3700 3030 3031  ....0000777.0001
 00008c70: 3735 3000 3030 3031 3735 3000 3030 3030  750.0001750.0000
 00008c80: 3033 3232 3137 3200 3030 3030 3030 3030  0322172.00000000
-00008c90: 3030 3000 3031 3637 3536 0020 3000 0000  000.016756. 0...
+00008c90: 3030 3000 3031 3637 3537 0020 3000 0000  000.016757. 0...
 00008ca0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
 00008cb0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
 00008cc0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
 00008cd0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
 00008ce0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
 00008cf0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
 00008d00: 0075 7374 6172 0030 3072 616d 0000 0000  .ustar.00ram....
@@ -9050,16 +9050,16 @@
 00023590: 0000 0000 0000 0000 0000 0000 0000 0000  ................
 000235a0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
 000235b0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
 000235c0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
 000235d0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
 000235e0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
 000235f0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-00023600: 3232 206d 7469 6d65 3d31 3638 3139 3033  22 mtime=1681903
-00023610: 3736 332e 300a 0000 0000 0000 0000 0000  763.0...........
+00023600: 3232 206d 7469 6d65 3d31 3638 3433 3238  22 mtime=1684328
+00023610: 3334 382e 300a 0000 0000 0000 0000 0000  348.0...........
 00023620: 0000 0000 0000 0000 0000 0000 0000 0000  ................
 00023630: 0000 0000 0000 0000 0000 0000 0000 0000  ................
 00023640: 0000 0000 0000 0000 0000 0000 0000 0000  ................
 00023650: 0000 0000 0000 0000 0000 0000 0000 0000  ................
 00023660: 0000 0000 0000 0000 0000 0000 0000 0000  ................
 00023670: 0000 0000 0000 0000 0000 0000 0000 0000  ................
 00023680: 0000 0000 0000 0000 0000 0000 0000 0000  ................
@@ -9082,24 +9082,24 @@
 00023790: 0000 0000 0000 0000 0000 0000 0000 0000  ................
 000237a0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
 000237b0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
 000237c0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
 000237d0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
 000237e0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
 000237f0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-00023800: 6175 746f 7669 6d6c 2d30 2e31 2e37 3134  autoviml-0.1.714
+00023800: 6175 746f 7669 6d6c 2d30 2e31 2e37 3135  autoviml-0.1.715
 00023810: 2f61 7574 6f76 696d 6c2f 4175 746f 5f56  /autoviml/Auto_V
 00023820: 694d 4c2e 7079 0000 0000 0000 0000 0000  iML.py..........
 00023830: 0000 0000 0000 0000 0000 0000 0000 0000  ................
 00023840: 0000 0000 0000 0000 0000 0000 0000 0000  ................
 00023850: 0000 0000 0000 0000 0000 0000 0000 0000  ................
 00023860: 0000 0000 3030 3030 3737 3700 3030 3031  ....0000777.0001
 00023870: 3735 3000 3030 3031 3735 3000 3030 3030  750.0001750.0000
-00023880: 3132 3230 3630 3500 3030 3030 3030 3030  1220605.00000000
-00023890: 3030 3000 3031 3731 3333 0020 3000 0000  000.017133. 0...
+00023880: 3132 3234 3431 3600 3030 3030 3030 3030  1224416.00000000
+00023890: 3030 3000 3031 3731 3430 0020 3000 0000  000.017140. 0...
 000238a0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
 000238b0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
 000238c0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
 000238d0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
 000238e0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
 000238f0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
 00023900: 0075 7374 6172 0030 3072 616d 0000 0000  .ustar.00ram....
@@ -24585,8249 +24585,8249 @@
 00060080: 6d6f 6465 6c20 696d 706f 7274 204c 6173  model import Las
 00060090: 736f 0d0a 6672 6f6d 2073 6b6c 6561 726e  so..from sklearn
 000600a0: 2e70 7265 7072 6f63 6573 7369 6e67 2069  .preprocessing i
 000600b0: 6d70 6f72 7420 506f 6c79 6e6f 6d69 616c  mport Polynomial
 000600c0: 4665 6174 7572 6573 0d0a 6672 6f6d 2073  Features..from s
 000600d0: 6b6c 6561 726e 2e6d 6f64 656c 5f73 656c  klearn.model_sel
 000600e0: 6563 7469 6f6e 2069 6d70 6f72 7420 4772  ection import Gr
-000600f0: 6964 5365 6172 6368 4356 0d0a 0d0a 6465  idSearchCV....de
-00060100: 6620 6164 645f 706f 6c79 5f76 6172 735f  f add_poly_vars_
-00060110: 7365 6c65 6374 2864 6174 612c 6e75 6d76  select(data,numv
-00060120: 6172 732c 7461 7267 6574 7661 722c 6d6f  ars,targetvar,mo
-00060130: 6465 6c74 7970 652c 706f 6c79 5f64 6567  deltype,poly_deg
-00060140: 7265 653d 322c 4164 645f 506f 6c79 3d32  ree=2,Add_Poly=2
-00060150: 2c6d 643d 2727 2c0d 0a20 2020 2020 2020  ,md='',..       
-00060160: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00060170: 2020 2020 2063 6f72 725f 6c69 6d69 743d       corr_limit=
-00060180: 302e 3730 2c73 6361 6c69 6e67 3d54 7275  0.70,scaling=Tru
-00060190: 652c 2066 6974 5f66 6c61 673d 4661 6c73  e, fit_flag=Fals
-000601a0: 652c 2076 6572 626f 7365 3d30 293a 0d0a  e, verbose=0):..
-000601b0: 2020 2020 2222 220d 0a20 2020 2023 2323      """..    ###
-000601c0: 2320 5468 6973 2061 6464 7320 506f 6c79  # This adds Poly
-000601d0: 6e6f 6d69 616c 2061 6e64 2049 6e74 6572  nomial and Inter
-000601e0: 6163 7469 6f6e 2056 6172 6961 626c 6573  action Variables
-000601f0: 206f 6620 616e 7920 5369 7a65 2074 6f20   of any Size to 
-00060200: 6120 6461 7461 2073 6574 2061 6e64 2072  a data set and r
-00060210: 6574 7572 6e73 2074 6865 2062 6573 7420  eturns the best 
-00060220: 7661 7273 0d0a 2020 2020 616d 6f6e 6720  vars..    among 
-00060230: 7468 6f73 6520 706f 6c79 2061 6e64 2069  those poly and i
-00060240: 6e74 6572 6163 7469 6f6e 2076 6172 6961  nteraction varia
-00060250: 626c 6573 2e20 4e6f 7469 6365 2079 6f75  bles. Notice you
-00060260: 2077 696c 6c20 6765 7420 6120 6c69 7374   will get a list
-00060270: 206f 6620 7661 7269 6162 6c65 7320 6173   of variables as
-00060280: 2077 656c 6c20 6173 2074 6865 206d 6f64   well as the mod
-00060290: 6966 6965 640d 0a20 2020 2064 6174 6120  ified..    data 
-000602a0: 7365 7420 7769 7468 2074 6865 206f 6c64  set with the old
-000602b0: 2061 6e64 206e 6577 2028 6164 6465 6429   and new (added)
-000602c0: 2076 6172 6961 626c 6573 2e20 5665 7279   variables. Very
-000602d0: 2043 6f6e 7665 6e69 656e 7420 7768 656e   Convenient when
-000602e0: 2079 6f75 2077 616e 7420 746f 2064 6f20   you want to do 
-000602f0: 7175 6963 6b20 7465 7374 696e 672e 0d0a  quick testing...
-00060300: 2020 2020 5468 6572 6520 6172 6520 3320      There are 3 
-00060310: 7365 7474 696e 6773 2066 6f72 2041 6464  settings for Add
-00060320: 5f50 6f6c 7920 666c 6167 3a20 3020 3d3e  _Poly flag: 0 =>
-00060330: 204e 6f20 706f 6c79 206f 7220 696e 7478   No poly or intx
-00060340: 6e20 7661 7269 6162 6c65 7320 6164 6465  n variables adde
-00060350: 642e 2031 3d3e 204f 6e6c 7920 696e 7478  d. 1=> Only intx
-00060360: 6e20 7661 7273 0d0a 2020 2020 6164 6465  n vars..    adde
-00060370: 642e 2032 3d3e 206f 6e6c 7920 706f 6c79  d. 2=> only poly
-00060380: 6e6f 6d69 616c 2064 6567 7265 6520 2873  nomial degree (s
-00060390: 7175 6172 6564 2920 7661 7273 2061 6464  quared) vars add
-000603a0: 6564 2e20 333d 3e20 626f 7468 2073 7175  ed. 3=> both squ
-000603b0: 6172 6564 2061 6e64 2069 6e74 786e 2076  ared and intxn v
-000603c0: 6172 7320 6164 6465 642e 0d0a 2020 2020  ars added...    
-000603d0: 4966 2046 6974 5f46 6c61 673d 5472 7565  If Fit_Flag=True
-000603e0: 2c20 7468 656e 2069 7420 6973 2061 7373  , then it is ass
-000603f0: 756d 6564 2074 6861 7420 6974 2069 7320  umed that it is 
-00060400: 5472 6169 6e69 6e67 2064 6174 6120 616e  Training data an
-00060410: 6420 6865 6e63 6520 7661 7269 6162 6c65  d hence variable
-00060420: 7320 6172 6520 7365 6c65 6374 6564 0d0a  s are selected..
-00060430: 2020 2020 4966 2046 6974 5f46 6c61 673d      If Fit_Flag=
-00060440: 4661 6c73 652c 2074 6865 6e20 6974 2069  False, then it i
-00060450: 7320 6173 7375 6d65 6420 6974 2069 7320  s assumed it is 
-00060460: 5465 7374 2064 6174 6120 616e 6420 6e6f  Test data and no
-00060470: 2076 6172 6961 626c 6573 2061 7265 2063   variables are c
-00060480: 686f 7365 6e20 6275 7420 7765 206b 6565  hosen but we kee
-00060490: 7020 7472 6169 6e69 6e67 206f 6e65 732e  p training ones.
-000604a0: 0d0a 2020 2020 2222 220d 0a20 2020 2064  ..    """..    d
-000604b0: 6174 6120 3d20 636f 7079 2e64 6565 7063  ata = copy.deepc
-000604c0: 6f70 7928 6461 7461 290d 0a20 2020 206e  opy(data)..    n
-000604d0: 756d 7661 7273 203d 2063 6f70 792e 6465  umvars = copy.de
-000604e0: 6570 636f 7079 286e 756d 7661 7273 290d  epcopy(numvars).
-000604f0: 0a20 2020 2074 6f6c 6572 616e 6365 203d  .    tolerance =
-00060500: 2030 2e30 310d 0a20 2020 206f 7269 675f   0.01..    orig_
-00060510: 6461 7461 5f69 6e64 6578 203d 2064 6174  data_index = dat
-00060520: 612e 696e 6465 780d 0a20 2020 2069 6620  a.index..    if 
-00060530: 6d6f 6465 6c74 7970 6520 3d3d 2027 5265  modeltype == 'Re
-00060540: 6772 6573 7369 6f6e 273a 0d0a 2020 2020  gression':..    
-00060550: 2020 2020 6c6d 203d 204c 6173 736f 2861      lm = Lasso(a
-00060560: 6c70 6861 3d30 2e30 3031 2c20 6d61 785f  lpha=0.001, max_
-00060570: 6974 6572 3d32 3030 302c 0d0a 2020 2020  iter=2000,..    
-00060580: 2020 2020 2020 2020 2020 2020 2066 6974               fit
-00060590: 5f69 6e74 6572 6365 7074 3d54 7275 652c  _intercept=True,
-000605a0: 206e 6f72 6d61 6c69 7a65 3d46 616c 7365   normalize=False
-000605b0: 290d 0a20 2020 2065 6c73 653a 0d0a 2020  )..    else:..  
-000605c0: 2020 2020 2020 6966 206d 6f64 656c 7479        if modelty
-000605d0: 7065 203d 3d20 2742 696e 6172 795f 436c  pe == 'Binary_Cl
-000605e0: 6173 7369 6669 6361 7469 6f6e 273a 0d0a  assification':..
-000605f0: 2020 2020 2020 2020 2020 2020 6c6d 203d              lm =
-00060600: 204c 6f67 6973 7469 6352 6567 7265 7373   LogisticRegress
-00060610: 696f 6e28 433d 302e 3031 2c66 6974 5f69  ion(C=0.01,fit_i
-00060620: 6e74 6572 6365 7074 3d54 7275 652c 746f  ntercept=True,to
-00060630: 6c3d 746f 6c65 7261 6e63 652c 0d0a 2020  l=tolerance,..  
-00060640: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00060650: 2020 2020 2020 2020 2020 2020 2020 6d61                ma
-00060660: 785f 6974 6572 3d32 3030 302c 736f 6c76  x_iter=2000,solv
-00060670: 6572 3d27 6c69 626c 696e 6561 7227 2c6e  er='liblinear',n
-00060680: 5f6a 6f62 733d 2d31 2c0d 0a20 2020 2020  _jobs=-1,..     
-00060690: 2020 2020 2020 2020 2020 2020 2020 2020                  
-000606a0: 2020 2020 2020 2020 2070 656e 616c 7479           penalty
-000606b0: 3d27 6c32 272c 6475 616c 3d46 616c 7365  ='l2',dual=False
-000606c0: 2c20 7261 6e64 6f6d 5f73 7461 7465 3d30  , random_state=0
-000606d0: 290d 0a20 2020 2020 2020 2065 6c73 653a  )..        else:
-000606e0: 0d0a 2020 2020 2020 2020 2020 2020 6c6d  ..            lm
-000606f0: 203d 204c 6f67 6973 7469 6352 6567 7265   = LogisticRegre
-00060700: 7373 696f 6e28 6d75 6c74 695f 636c 6173  ssion(multi_clas
-00060710: 733d 276f 7672 272c 206d 6178 5f69 7465  s='ovr', max_ite
-00060720: 723d 3130 3030 3029 2023 2320 6c6f 6769  r=10000) ## logi
-00060730: 7374 6963 2073 6565 6d73 2062 6573 7420  stic seems best 
-00060740: 616d 6f6e 6720 616c 6c0d 0a20 2020 2070  among all..    p
-00060750: 7265 6469 6374 6f72 7320 3d20 636f 7079  redictors = copy
-00060760: 2e64 6565 7063 6f70 7928 6e75 6d76 6172  .deepcopy(numvar
-00060770: 7329 0d0a 2020 2020 2323 2323 206e 756d  s)..    #### num
-00060780: 6265 7220 6f66 206f 7269 6769 6e61 6c20  ber of original 
-00060790: 6665 6174 7572 6573 2069 6e20 6461 7461  features in data
-000607a0: 2073 6574 2023 2323 230d 0a20 2020 206e   set ####..    n
-000607b0: 5f6f 7269 675f 6665 6174 7572 6573 203d  _orig_features =
-000607c0: 206c 656e 2870 7265 6469 6374 6f72 7329   len(predictors)
-000607d0: 0d0a 2020 2020 7365 6c65 6374 6564 203d  ..    selected =
-000607e0: 205b 5d0d 0a20 2020 2058 5f64 6174 6120   []..    X_data 
-000607f0: 3d20 6461 7461 5b70 7265 6469 6374 6f72  = data[predictor
-00060800: 735d 0d0a 2020 2020 2323 2323 2323 2320  s]..    ####### 
-00060810: 2049 6e69 7469 616c 204d 6f64 656c 2077   Initial Model w
-00060820: 6974 6820 616c 6c20 696e 7075 7420 7661  ith all input va
-00060830: 7269 6162 6c65 7320 2323 2323 2323 0d0a  riables ######..
-00060840: 2020 2020 6966 2073 6361 6c69 6e67 203d      if scaling =
-00060850: 3d20 2753 7461 6e64 6172 6427 3a0d 0a20  = 'Standard':.. 
-00060860: 2020 2020 2020 2058 5320 3d20 5374 616e         XS = Stan
-00060870: 6461 7264 5363 616c 6572 2829 2e66 6974  dardScaler().fit
-00060880: 5f74 7261 6e73 666f 726d 2858 5f64 6174  _transform(X_dat
-00060890: 6129 0d0a 2020 2020 656c 6966 2073 6361  a)..    elif sca
-000608a0: 6c69 6e67 203d 3d20 274d 696e 4d61 7827  ling == 'MinMax'
-000608b0: 3a0d 0a20 2020 2020 2020 2058 5320 3d20  :..        XS = 
-000608c0: 4d69 6e4d 6178 5363 616c 6572 2829 2e66  MinMaxScaler().f
-000608d0: 6974 5f74 7261 6e73 666f 726d 2858 5f64  it_transform(X_d
-000608e0: 6174 6129 0d0a 2020 2020 2323 2320 206f  ata)..    ###  o
-000608f0: 7220 796f 7520 6361 6e20 7573 6520 4365  r you can use Ce
-00060900: 6e74 6572 696e 6720 7768 6963 6820 7369  ntering which si
-00060910: 6d70 6c79 2073 7562 7472 6163 7473 2074  mply subtracts t
-00060920: 6865 204d 6561 6e3a 0d0a 2020 2020 656c  he Mean:..    el
-00060930: 6966 2073 6361 6c69 6e67 203d 3d20 2743  if scaling == 'C
-00060940: 656e 7465 7269 6e67 273a 0d0a 2020 2020  entering':..    
-00060950: 2020 2020 5853 203d 2028 585f 6461 7461      XS = (X_data
-00060960: 2d58 5f64 6174 612e 6d65 616e 2829 290d  -X_data.mean()).
-00060970: 0a20 2020 2065 6c73 653a 0d0a 2020 2020  .    else:..    
-00060980: 2020 2020 5853 203d 2063 6f70 792e 6465      XS = copy.de
-00060990: 6570 636f 7079 2858 5f64 6174 6129 0d0a  epcopy(X_data)..
-000609a0: 2020 2020 2358 532e 636f 6c75 6d6e 733d      #XS.columns=
-000609b0: 7072 6564 6963 746f 7273 0d0a 2020 2020  predictors..    
-000609c0: 5820 3d20 636f 7079 2e64 6565 7063 6f70  X = copy.deepcop
-000609d0: 7928 5853 290d 0a20 2020 2023 2323 2323  y(XS)..    #####
-000609e0: 2323 2323 2323 2323 2323 2323 2320 4669  ############# Fi
-000609f0: 7420 7468 6520 6d6f 6465 6c20 6166 7465  t the model afte
-00060a00: 7220 7363 616c 696e 6720 6461 7461 2023  r scaling data #
-00060a10: 2323 2323 2323 2323 2323 2323 2323 0d0a  ##############..
-00060a20: 2020 2020 6966 2066 6974 5f66 6c61 673a      if fit_flag:
-00060a30: 0d0a 2020 2020 2020 2020 5920 3d20 6461  ..        Y = da
-00060a40: 7461 5b74 6172 6765 7476 6172 5d0d 0a20  ta[targetvar].. 
-00060a50: 2020 2020 2020 2070 7269 6e74 2827 4275         print('Bu
-00060a60: 696c 6469 6e67 2049 6e69 7461 6c20 4d6f  ilding Inital Mo
-00060a70: 6465 6c20 7769 7468 2067 6976 656e 2076  del with given v
-00060a80: 6172 6961 626c 6573 2e2e 2e27 290d 0a20  ariables...').. 
-00060a90: 2020 2020 2020 2070 7269 6e74 5f6d 6f64         print_mod
-00060aa0: 656c 5f6d 6574 7269 6373 286d 6f64 656c  el_metrics(model
-00060ab0: 7479 7065 2c6c 6d2c 582c 592c 4661 6c73  type,lm,X,Y,Fals
-00060ac0: 6529 0d0a 2020 2020 2323 2323 2323 2323  e)..    ########
-00060ad0: 2048 6572 6520 6973 2077 6865 7265 2074   Here is where t
-00060ae0: 6865 2049 6e74 6572 6163 7469 6f6e 2076  he Interaction v
-00060af0: 6172 6961 626c 6520 7365 6c65 6374 696f  ariable selectio
-00060b00: 6e20 6265 6769 6e73 2023 2323 2323 2323  n begins #######
-00060b10: 2323 2323 230d 0a20 2020 2023 7072 696e  #####..    #prin
-00060b20: 7428 2741 6464 696e 6720 506f 6c79 6e6f  t('Adding Polyno
-00060b30: 6d69 616c 2025 732d 6465 6772 6565 2061  mial %s-degree a
-00060b40: 6e64 2049 6e74 6572 6163 7469 6f6e 2076  nd Interaction v
-00060b50: 6172 6961 626c 6573 2e2e 2e27 2025 706f  ariables...' %po
-00060b60: 6c79 5f64 6567 7265 6529 0d0a 2020 2020  ly_degree)..    
-00060b70: 6966 2041 6464 5f50 6f6c 7920 3d3d 2031  if Add_Poly == 1
-00060b80: 3a0d 0a20 2020 2020 2020 2023 2323 2049  :..        ### I
-00060b90: 6620 6974 2069 7320 312c 2061 6464 206f  f it is 1, add o
-00060ba0: 6e6c 7920 496e 7465 7261 6374 696f 6e20  nly Interaction 
-00060bb0: 7661 7269 6162 6c65 732e 0d0a 2020 2020  variables...    
-00060bc0: 2020 2020 706f 6c79 203d 2050 6f6c 796e      poly = Polyn
-00060bd0: 6f6d 6961 6c46 6561 7475 7265 7328 6465  omialFeatures(de
-00060be0: 6772 6565 3d70 6f6c 795f 6465 6772 6565  gree=poly_degree
-00060bf0: 2c20 696e 636c 7564 655f 6269 6173 203d  , include_bias =
-00060c00: 2046 616c 7365 2c20 696e 7465 7261 6374   False, interact
-00060c10: 696f 6e5f 6f6e 6c79 3d54 7275 6529 0d0a  ion_only=True)..
-00060c20: 2020 2020 656c 6966 2041 6464 5f50 6f6c      elif Add_Pol
-00060c30: 7920 3d3d 2032 3a0d 0a20 2020 2020 2020  y == 2:..       
-00060c40: 2023 2323 2320 4966 2069 7420 6973 2032   #### If it is 2
-00060c50: 206f 7220 3320 6164 6420 626f 7468 2053   or 3 add both S
-00060c60: 7175 6172 6564 2061 6e64 2049 6e74 6572  quared and Inter
-00060c70: 6163 7469 6f6e 2076 6172 6961 626c 6573  action variables
-00060c80: 2e20 5765 2077 696c 6c20 7265 6d6f 7665  . We will remove
-00060c90: 2069 6e74 6572 6163 7469 6f6e 0d0a 2020   interaction..  
-00060ca0: 2020 2020 2020 2323 2320 2020 2020 2020        ###       
-00060cb0: 7661 7269 6162 6c65 7320 6c61 7465 7220  variables later 
-00060cc0: 696e 2074 6869 7320 7072 6f67 7261 6d2e  in this program.
-00060cd0: 2046 6f72 206e 6f77 2069 6e63 6c75 6465   For now include
-00060ce0: 2062 6f74 6821 0d0a 2020 2020 2020 2020   both!..        
-00060cf0: 706f 6c79 203d 2050 6f6c 796e 6f6d 6961  poly = Polynomia
-00060d00: 6c46 6561 7475 7265 7328 6465 6772 6565  lFeatures(degree
-00060d10: 3d70 6f6c 795f 6465 6772 6565 2c20 696e  =poly_degree, in
-00060d20: 636c 7564 655f 6269 6173 203d 2046 616c  clude_bias = Fal
-00060d30: 7365 2c20 696e 7465 7261 6374 696f 6e5f  se, interaction_
-00060d40: 6f6e 6c79 3d46 616c 7365 290d 0a20 2020  only=False)..   
-00060d50: 2065 6c69 6620 4164 645f 506f 6c79 203d   elif Add_Poly =
-00060d60: 3d20 333a 0d0a 2020 2020 2020 2020 2323  = 3:..        ##
-00060d70: 2323 2049 6620 6974 2069 7320 3220 6f72  ## If it is 2 or
-00060d80: 2033 2061 6464 2062 6f74 6820 5371 7561   3 add both Squa
-00060d90: 7265 6420 616e 6420 496e 7465 7261 6374  red and Interact
-00060da0: 696f 6e20 7661 7269 6162 6c65 732e 2057  ion variables. W
-00060db0: 6520 7769 6c6c 2072 656d 6f76 6520 696e  e will remove in
-00060dc0: 7465 7261 6374 696f 6e0d 0a20 2020 2020  teraction..     
-00060dd0: 2020 2023 2323 2020 2020 2020 2076 6172     ###       var
-00060de0: 6961 626c 6573 206c 6174 6572 2069 6e20  iables later in 
-00060df0: 7468 6973 2070 726f 6772 616d 2e20 466f  this program. Fo
-00060e00: 7220 6e6f 7720 696e 636c 7564 6520 626f  r now include bo
-00060e10: 7468 210d 0a20 2020 2020 2020 2070 6f6c  th!..        pol
-00060e20: 7920 3d20 506f 6c79 6e6f 6d69 616c 4665  y = PolynomialFe
-00060e30: 6174 7572 6573 2864 6567 7265 653d 706f  atures(degree=po
-00060e40: 6c79 5f64 6567 7265 652c 2069 6e63 6c75  ly_degree, inclu
-00060e50: 6465 5f62 6961 7320 3d20 4661 6c73 652c  de_bias = False,
-00060e60: 2069 6e74 6572 6163 7469 6f6e 5f6f 6e6c   interaction_onl
-00060e70: 793d 4661 6c73 6529 0d0a 2020 2020 6966  y=False)..    if
-00060e80: 2066 6974 5f66 6c61 673a 0d0a 2020 2020   fit_flag:..    
-00060e90: 2020 2020 6d64 203d 2070 6f6c 792e 6669      md = poly.fi
-00060ea0: 7428 5829 2023 2323 2320 5468 6973 2064  t(X) #### This d
-00060eb0: 6566 696e 6573 2074 6865 2050 6f6c 796e  efines the Polyn
-00060ec0: 6f6d 6961 6c20 6665 6174 7572 6520 6578  omial feature ex
-00060ed0: 7472 6163 7469 6f6e 0d0a 2020 2020 7472  traction..    tr
-00060ee0: 793a 0d0a 2020 2020 2020 2020 5850 203d  y:..        XP =
-00060ef0: 206d 642e 7472 616e 7366 6f72 6d28 5829   md.transform(X)
-00060f00: 2023 2323 2320 5468 6973 2074 7261 6e73   #### This trans
-00060f10: 666f 726d 7320 5820 696e 746f 2061 2050  forms X into a P
-00060f20: 6f6c 796e 6f6d 6961 6c20 4f72 6465 720d  olynomial Order.
-00060f30: 0a20 2020 2065 7863 6570 7420 4d65 6d6f  .    except Memo
-00060f40: 7279 4572 726f 723a 0d0a 2020 2020 2020  ryError:..      
-00060f50: 2020 7265 7475 726e 2070 7265 6469 6374    return predict
-00060f60: 6f72 732c 2027 272c 2058 2c20 6d64 2c20  ors, '', X, md, 
-00060f70: 5b5d 2c20 6469 6374 2829 0d0a 2020 2020  [], dict()..    
-00060f80: 2323 2323 2323 2323 2323 2323 2323 2323  ################
-00060f90: 2323 2323 2323 2323 2323 2323 2323 2323  ################
-00060fa0: 2323 2323 2323 2323 2323 2323 2323 2323  ################
+000600f0: 6964 5365 6172 6368 4356 0d0a 696d 706f  idSearchCV..impo
+00060100: 7274 2073 6b6c 6561 726e 0d0a 6672 6f6d  rt sklearn..from
+00060110: 2064 6973 7475 7469 6c73 2e76 6572 7369   distutils.versi
+00060120: 6f6e 2069 6d70 6f72 7420 4c6f 6f73 6556  on import LooseV
+00060130: 6572 7369 6f6e 0d0a 0d0a 6465 6620 6164  ersion....def ad
+00060140: 645f 706f 6c79 5f76 6172 735f 7365 6c65  d_poly_vars_sele
+00060150: 6374 2864 6174 612c 6e75 6d76 6172 732c  ct(data,numvars,
+00060160: 7461 7267 6574 7661 722c 6d6f 6465 6c74  targetvar,modelt
+00060170: 7970 652c 706f 6c79 5f64 6567 7265 653d  ype,poly_degree=
+00060180: 322c 4164 645f 506f 6c79 3d32 2c6d 643d  2,Add_Poly=2,md=
+00060190: 2727 2c0d 0a20 2020 2020 2020 2020 2020  '',..           
+000601a0: 2020 2020 2020 2020 2020 2020 2020 2020                  
+000601b0: 2063 6f72 725f 6c69 6d69 743d 302e 3730   corr_limit=0.70
+000601c0: 2c73 6361 6c69 6e67 3d54 7275 652c 2066  ,scaling=True, f
+000601d0: 6974 5f66 6c61 673d 4661 6c73 652c 2076  it_flag=False, v
+000601e0: 6572 626f 7365 3d30 293a 0d0a 2020 2020  erbose=0):..    
+000601f0: 2222 220d 0a20 2020 2023 2323 2320 5468  """..    #### Th
+00060200: 6973 2061 6464 7320 506f 6c79 6e6f 6d69  is adds Polynomi
+00060210: 616c 2061 6e64 2049 6e74 6572 6163 7469  al and Interacti
+00060220: 6f6e 2056 6172 6961 626c 6573 206f 6620  on Variables of 
+00060230: 616e 7920 5369 7a65 2074 6f20 6120 6461  any Size to a da
+00060240: 7461 2073 6574 2061 6e64 2072 6574 7572  ta set and retur
+00060250: 6e73 2074 6865 2062 6573 7420 7661 7273  ns the best vars
+00060260: 0d0a 2020 2020 616d 6f6e 6720 7468 6f73  ..    among thos
+00060270: 6520 706f 6c79 2061 6e64 2069 6e74 6572  e poly and inter
+00060280: 6163 7469 6f6e 2076 6172 6961 626c 6573  action variables
+00060290: 2e20 4e6f 7469 6365 2079 6f75 2077 696c  . Notice you wil
+000602a0: 6c20 6765 7420 6120 6c69 7374 206f 6620  l get a list of 
+000602b0: 7661 7269 6162 6c65 7320 6173 2077 656c  variables as wel
+000602c0: 6c20 6173 2074 6865 206d 6f64 6966 6965  l as the modifie
+000602d0: 640d 0a20 2020 2064 6174 6120 7365 7420  d..    data set 
+000602e0: 7769 7468 2074 6865 206f 6c64 2061 6e64  with the old and
+000602f0: 206e 6577 2028 6164 6465 6429 2076 6172   new (added) var
+00060300: 6961 626c 6573 2e20 5665 7279 2043 6f6e  iables. Very Con
+00060310: 7665 6e69 656e 7420 7768 656e 2079 6f75  venient when you
+00060320: 2077 616e 7420 746f 2064 6f20 7175 6963   want to do quic
+00060330: 6b20 7465 7374 696e 672e 0d0a 2020 2020  k testing...    
+00060340: 5468 6572 6520 6172 6520 3320 7365 7474  There are 3 sett
+00060350: 696e 6773 2066 6f72 2041 6464 5f50 6f6c  ings for Add_Pol
+00060360: 7920 666c 6167 3a20 3020 3d3e 204e 6f20  y flag: 0 => No 
+00060370: 706f 6c79 206f 7220 696e 7478 6e20 7661  poly or intxn va
+00060380: 7269 6162 6c65 7320 6164 6465 642e 2031  riables added. 1
+00060390: 3d3e 204f 6e6c 7920 696e 7478 6e20 7661  => Only intxn va
+000603a0: 7273 0d0a 2020 2020 6164 6465 642e 2032  rs..    added. 2
+000603b0: 3d3e 206f 6e6c 7920 706f 6c79 6e6f 6d69  => only polynomi
+000603c0: 616c 2064 6567 7265 6520 2873 7175 6172  al degree (squar
+000603d0: 6564 2920 7661 7273 2061 6464 6564 2e20  ed) vars added. 
+000603e0: 333d 3e20 626f 7468 2073 7175 6172 6564  3=> both squared
+000603f0: 2061 6e64 2069 6e74 786e 2076 6172 7320   and intxn vars 
+00060400: 6164 6465 642e 0d0a 2020 2020 4966 2046  added...    If F
+00060410: 6974 5f46 6c61 673d 5472 7565 2c20 7468  it_Flag=True, th
+00060420: 656e 2069 7420 6973 2061 7373 756d 6564  en it is assumed
+00060430: 2074 6861 7420 6974 2069 7320 5472 6169   that it is Trai
+00060440: 6e69 6e67 2064 6174 6120 616e 6420 6865  ning data and he
+00060450: 6e63 6520 7661 7269 6162 6c65 7320 6172  nce variables ar
+00060460: 6520 7365 6c65 6374 6564 0d0a 2020 2020  e selected..    
+00060470: 4966 2046 6974 5f46 6c61 673d 4661 6c73  If Fit_Flag=Fals
+00060480: 652c 2074 6865 6e20 6974 2069 7320 6173  e, then it is as
+00060490: 7375 6d65 6420 6974 2069 7320 5465 7374  sumed it is Test
+000604a0: 2064 6174 6120 616e 6420 6e6f 2076 6172   data and no var
+000604b0: 6961 626c 6573 2061 7265 2063 686f 7365  iables are chose
+000604c0: 6e20 6275 7420 7765 206b 6565 7020 7472  n but we keep tr
+000604d0: 6169 6e69 6e67 206f 6e65 732e 0d0a 2020  aining ones...  
+000604e0: 2020 2222 220d 0a20 2020 2064 6174 6120    """..    data 
+000604f0: 3d20 636f 7079 2e64 6565 7063 6f70 7928  = copy.deepcopy(
+00060500: 6461 7461 290d 0a20 2020 206e 756d 7661  data)..    numva
+00060510: 7273 203d 2063 6f70 792e 6465 6570 636f  rs = copy.deepco
+00060520: 7079 286e 756d 7661 7273 290d 0a20 2020  py(numvars)..   
+00060530: 2074 6f6c 6572 616e 6365 203d 2030 2e30   tolerance = 0.0
+00060540: 310d 0a20 2020 206f 7269 675f 6461 7461  1..    orig_data
+00060550: 5f69 6e64 6578 203d 2064 6174 612e 696e  _index = data.in
+00060560: 6465 780d 0a20 2020 2069 6620 6d6f 6465  dex..    if mode
+00060570: 6c74 7970 6520 3d3d 2027 5265 6772 6573  ltype == 'Regres
+00060580: 7369 6f6e 273a 0d0a 2020 2020 2020 2020  sion':..        
+00060590: 6c6d 203d 204c 6173 736f 2861 6c70 6861  lm = Lasso(alpha
+000605a0: 3d30 2e30 3031 2c20 6d61 785f 6974 6572  =0.001, max_iter
+000605b0: 3d32 3030 302c 0d0a 2020 2020 2020 2020  =2000,..        
+000605c0: 2020 2020 2020 2020 2066 6974 5f69 6e74           fit_int
+000605d0: 6572 6365 7074 3d54 7275 6529 0d0a 2020  ercept=True)..  
+000605e0: 2020 656c 7365 3a0d 0a20 2020 2020 2020    else:..       
+000605f0: 2069 6620 6d6f 6465 6c74 7970 6520 3d3d   if modeltype ==
+00060600: 2027 4269 6e61 7279 5f43 6c61 7373 6966   'Binary_Classif
+00060610: 6963 6174 696f 6e27 3a0d 0a20 2020 2020  ication':..     
+00060620: 2020 2020 2020 206c 6d20 3d20 4c6f 6769         lm = Logi
+00060630: 7374 6963 5265 6772 6573 7369 6f6e 2843  sticRegression(C
+00060640: 3d30 2e30 312c 6669 745f 696e 7465 7263  =0.01,fit_interc
+00060650: 6570 743d 5472 7565 2c74 6f6c 3d74 6f6c  ept=True,tol=tol
+00060660: 6572 616e 6365 2c0d 0a20 2020 2020 2020  erance,..       
+00060670: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00060680: 2020 2020 2020 2020 206d 6178 5f69 7465           max_ite
+00060690: 723d 3230 3030 2c73 6f6c 7665 723d 276c  r=2000,solver='l
+000606a0: 6962 6c69 6e65 6172 272c 6e5f 6a6f 6273  iblinear',n_jobs
+000606b0: 3d2d 312c 0d0a 2020 2020 2020 2020 2020  =-1,..          
+000606c0: 2020 2020 2020 2020 2020 2020 2020 2020                  
+000606d0: 2020 2020 7065 6e61 6c74 793d 276c 3227      penalty='l2'
+000606e0: 2c64 7561 6c3d 4661 6c73 652c 2072 616e  ,dual=False, ran
+000606f0: 646f 6d5f 7374 6174 653d 3029 0d0a 2020  dom_state=0)..  
+00060700: 2020 2020 2020 656c 7365 3a0d 0a20 2020        else:..   
+00060710: 2020 2020 2020 2020 206c 6d20 3d20 4c6f           lm = Lo
+00060720: 6769 7374 6963 5265 6772 6573 7369 6f6e  gisticRegression
+00060730: 286d 756c 7469 5f63 6c61 7373 3d27 6f76  (multi_class='ov
+00060740: 7227 2c20 6d61 785f 6974 6572 3d31 3030  r', max_iter=100
+00060750: 3030 2920 2323 206c 6f67 6973 7469 6320  00) ## logistic 
+00060760: 7365 656d 7320 6265 7374 2061 6d6f 6e67  seems best among
+00060770: 2061 6c6c 0d0a 2020 2020 7072 6564 6963   all..    predic
+00060780: 746f 7273 203d 2063 6f70 792e 6465 6570  tors = copy.deep
+00060790: 636f 7079 286e 756d 7661 7273 290d 0a20  copy(numvars).. 
+000607a0: 2020 2023 2323 2320 6e75 6d62 6572 206f     #### number o
+000607b0: 6620 6f72 6967 696e 616c 2066 6561 7475  f original featu
+000607c0: 7265 7320 696e 2064 6174 6120 7365 7420  res in data set 
+000607d0: 2323 2323 0d0a 2020 2020 6e5f 6f72 6967  ####..    n_orig
+000607e0: 5f66 6561 7475 7265 7320 3d20 6c65 6e28  _features = len(
+000607f0: 7072 6564 6963 746f 7273 290d 0a20 2020  predictors)..   
+00060800: 2073 656c 6563 7465 6420 3d20 5b5d 0d0a   selected = []..
+00060810: 2020 2020 585f 6461 7461 203d 2064 6174      X_data = dat
+00060820: 615b 7072 6564 6963 746f 7273 5d0d 0a20  a[predictors].. 
+00060830: 2020 2023 2323 2323 2323 2020 496e 6974     #######  Init
+00060840: 6961 6c20 4d6f 6465 6c20 7769 7468 2061  ial Model with a
+00060850: 6c6c 2069 6e70 7574 2076 6172 6961 626c  ll input variabl
+00060860: 6573 2023 2323 2323 230d 0a20 2020 2069  es ######..    i
+00060870: 6620 7363 616c 696e 6720 3d3d 2027 5374  f scaling == 'St
+00060880: 616e 6461 7264 273a 0d0a 2020 2020 2020  andard':..      
+00060890: 2020 5853 203d 2053 7461 6e64 6172 6453    XS = StandardS
+000608a0: 6361 6c65 7228 292e 6669 745f 7472 616e  caler().fit_tran
+000608b0: 7366 6f72 6d28 585f 6461 7461 290d 0a20  sform(X_data).. 
+000608c0: 2020 2065 6c69 6620 7363 616c 696e 6720     elif scaling 
+000608d0: 3d3d 2027 4d69 6e4d 6178 273a 0d0a 2020  == 'MinMax':..  
+000608e0: 2020 2020 2020 5853 203d 204d 696e 4d61        XS = MinMa
+000608f0: 7853 6361 6c65 7228 292e 6669 745f 7472  xScaler().fit_tr
+00060900: 616e 7366 6f72 6d28 585f 6461 7461 290d  ansform(X_data).
+00060910: 0a20 2020 2023 2323 2020 6f72 2079 6f75  .    ###  or you
+00060920: 2063 616e 2075 7365 2043 656e 7465 7269   can use Centeri
+00060930: 6e67 2077 6869 6368 2073 696d 706c 7920  ng which simply 
+00060940: 7375 6274 7261 6374 7320 7468 6520 4d65  subtracts the Me
+00060950: 616e 3a0d 0a20 2020 2065 6c69 6620 7363  an:..    elif sc
+00060960: 616c 696e 6720 3d3d 2027 4365 6e74 6572  aling == 'Center
+00060970: 696e 6727 3a0d 0a20 2020 2020 2020 2058  ing':..        X
+00060980: 5320 3d20 2858 5f64 6174 612d 585f 6461  S = (X_data-X_da
+00060990: 7461 2e6d 6561 6e28 2929 0d0a 2020 2020  ta.mean())..    
+000609a0: 656c 7365 3a0d 0a20 2020 2020 2020 2058  else:..        X
+000609b0: 5320 3d20 636f 7079 2e64 6565 7063 6f70  S = copy.deepcop
+000609c0: 7928 585f 6461 7461 290d 0a20 2020 2023  y(X_data)..    #
+000609d0: 5853 2e63 6f6c 756d 6e73 3d70 7265 6469  XS.columns=predi
+000609e0: 6374 6f72 730d 0a20 2020 2058 203d 2063  ctors..    X = c
+000609f0: 6f70 792e 6465 6570 636f 7079 2858 5329  opy.deepcopy(XS)
+00060a00: 0d0a 2020 2020 2323 2323 2323 2323 2323  ..    ##########
+00060a10: 2323 2323 2323 2323 2046 6974 2074 6865  ######## Fit the
+00060a20: 206d 6f64 656c 2061 6674 6572 2073 6361   model after sca
+00060a30: 6c69 6e67 2064 6174 6120 2323 2323 2323  ling data ######
+00060a40: 2323 2323 2323 2323 230d 0a20 2020 2069  #########..    i
+00060a50: 6620 6669 745f 666c 6167 3a0d 0a20 2020  f fit_flag:..   
+00060a60: 2020 2020 2059 203d 2064 6174 615b 7461       Y = data[ta
+00060a70: 7267 6574 7661 725d 0d0a 2020 2020 2020  rgetvar]..      
+00060a80: 2020 7072 696e 7428 2742 7569 6c64 696e    print('Buildin
+00060a90: 6720 496e 6974 616c 204d 6f64 656c 2077  g Inital Model w
+00060aa0: 6974 6820 6769 7665 6e20 7661 7269 6162  ith given variab
+00060ab0: 6c65 732e 2e2e 2729 0d0a 2020 2020 2020  les...')..      
+00060ac0: 2020 7072 696e 745f 6d6f 6465 6c5f 6d65    print_model_me
+00060ad0: 7472 6963 7328 6d6f 6465 6c74 7970 652c  trics(modeltype,
+00060ae0: 6c6d 2c58 2c59 2c46 616c 7365 290d 0a20  lm,X,Y,False).. 
+00060af0: 2020 2023 2323 2323 2323 2320 4865 7265     ######## Here
+00060b00: 2069 7320 7768 6572 6520 7468 6520 496e   is where the In
+00060b10: 7465 7261 6374 696f 6e20 7661 7269 6162  teraction variab
+00060b20: 6c65 2073 656c 6563 7469 6f6e 2062 6567  le selection beg
+00060b30: 696e 7320 2323 2323 2323 2323 2323 2323  ins ############
+00060b40: 0d0a 2020 2020 2370 7269 6e74 2827 4164  ..    #print('Ad
+00060b50: 6469 6e67 2050 6f6c 796e 6f6d 6961 6c20  ding Polynomial 
+00060b60: 2573 2d64 6567 7265 6520 616e 6420 496e  %s-degree and In
+00060b70: 7465 7261 6374 696f 6e20 7661 7269 6162  teraction variab
+00060b80: 6c65 732e 2e2e 2720 2570 6f6c 795f 6465  les...' %poly_de
+00060b90: 6772 6565 290d 0a20 2020 2069 6620 4164  gree)..    if Ad
+00060ba0: 645f 506f 6c79 203d 3d20 313a 0d0a 2020  d_Poly == 1:..  
+00060bb0: 2020 2020 2020 2323 2320 4966 2069 7420        ### If it 
+00060bc0: 6973 2031 2c20 6164 6420 6f6e 6c79 2049  is 1, add only I
+00060bd0: 6e74 6572 6163 7469 6f6e 2076 6172 6961  nteraction varia
+00060be0: 626c 6573 2e0d 0a20 2020 2020 2020 2070  bles...        p
+00060bf0: 6f6c 7920 3d20 506f 6c79 6e6f 6d69 616c  oly = Polynomial
+00060c00: 4665 6174 7572 6573 2864 6567 7265 653d  Features(degree=
+00060c10: 706f 6c79 5f64 6567 7265 652c 2069 6e63  poly_degree, inc
+00060c20: 6c75 6465 5f62 6961 7320 3d20 4661 6c73  lude_bias = Fals
+00060c30: 652c 2069 6e74 6572 6163 7469 6f6e 5f6f  e, interaction_o
+00060c40: 6e6c 793d 5472 7565 290d 0a20 2020 2065  nly=True)..    e
+00060c50: 6c69 6620 4164 645f 506f 6c79 203d 3d20  lif Add_Poly == 
+00060c60: 323a 0d0a 2020 2020 2020 2020 2323 2323  2:..        ####
+00060c70: 2049 6620 6974 2069 7320 3220 6f72 2033   If it is 2 or 3
+00060c80: 2061 6464 2062 6f74 6820 5371 7561 7265   add both Square
+00060c90: 6420 616e 6420 496e 7465 7261 6374 696f  d and Interactio
+00060ca0: 6e20 7661 7269 6162 6c65 732e 2057 6520  n variables. We 
+00060cb0: 7769 6c6c 2072 656d 6f76 6520 696e 7465  will remove inte
+00060cc0: 7261 6374 696f 6e0d 0a20 2020 2020 2020  raction..       
+00060cd0: 2023 2323 2020 2020 2020 2076 6172 6961   ###       varia
+00060ce0: 626c 6573 206c 6174 6572 2069 6e20 7468  bles later in th
+00060cf0: 6973 2070 726f 6772 616d 2e20 466f 7220  is program. For 
+00060d00: 6e6f 7720 696e 636c 7564 6520 626f 7468  now include both
+00060d10: 210d 0a20 2020 2020 2020 2070 6f6c 7920  !..        poly 
+00060d20: 3d20 506f 6c79 6e6f 6d69 616c 4665 6174  = PolynomialFeat
+00060d30: 7572 6573 2864 6567 7265 653d 706f 6c79  ures(degree=poly
+00060d40: 5f64 6567 7265 652c 2069 6e63 6c75 6465  _degree, include
+00060d50: 5f62 6961 7320 3d20 4661 6c73 652c 2069  _bias = False, i
+00060d60: 6e74 6572 6163 7469 6f6e 5f6f 6e6c 793d  nteraction_only=
+00060d70: 4661 6c73 6529 0d0a 2020 2020 656c 6966  False)..    elif
+00060d80: 2041 6464 5f50 6f6c 7920 3d3d 2033 3a0d   Add_Poly == 3:.
+00060d90: 0a20 2020 2020 2020 2023 2323 2320 4966  .        #### If
+00060da0: 2069 7420 6973 2032 206f 7220 3320 6164   it is 2 or 3 ad
+00060db0: 6420 626f 7468 2053 7175 6172 6564 2061  d both Squared a
+00060dc0: 6e64 2049 6e74 6572 6163 7469 6f6e 2076  nd Interaction v
+00060dd0: 6172 6961 626c 6573 2e20 5765 2077 696c  ariables. We wil
+00060de0: 6c20 7265 6d6f 7665 2069 6e74 6572 6163  l remove interac
+00060df0: 7469 6f6e 0d0a 2020 2020 2020 2020 2323  tion..        ##
+00060e00: 2320 2020 2020 2020 7661 7269 6162 6c65  #       variable
+00060e10: 7320 6c61 7465 7220 696e 2074 6869 7320  s later in this 
+00060e20: 7072 6f67 7261 6d2e 2046 6f72 206e 6f77  program. For now
+00060e30: 2069 6e63 6c75 6465 2062 6f74 6821 0d0a   include both!..
+00060e40: 2020 2020 2020 2020 706f 6c79 203d 2050          poly = P
+00060e50: 6f6c 796e 6f6d 6961 6c46 6561 7475 7265  olynomialFeature
+00060e60: 7328 6465 6772 6565 3d70 6f6c 795f 6465  s(degree=poly_de
+00060e70: 6772 6565 2c20 696e 636c 7564 655f 6269  gree, include_bi
+00060e80: 6173 203d 2046 616c 7365 2c20 696e 7465  as = False, inte
+00060e90: 7261 6374 696f 6e5f 6f6e 6c79 3d46 616c  raction_only=Fal
+00060ea0: 7365 290d 0a20 2020 2069 6620 6669 745f  se)..    if fit_
+00060eb0: 666c 6167 3a0d 0a20 2020 2020 2020 206d  flag:..        m
+00060ec0: 6420 3d20 706f 6c79 2e66 6974 2858 2920  d = poly.fit(X) 
+00060ed0: 2323 2323 2054 6869 7320 6465 6669 6e65  #### This define
+00060ee0: 7320 7468 6520 506f 6c79 6e6f 6d69 616c  s the Polynomial
+00060ef0: 2066 6561 7475 7265 2065 7874 7261 6374   feature extract
+00060f00: 696f 6e0d 0a20 2020 2074 7279 3a0d 0a20  ion..    try:.. 
+00060f10: 2020 2020 2020 2058 5020 3d20 6d64 2e74         XP = md.t
+00060f20: 7261 6e73 666f 726d 2858 2920 2323 2323  ransform(X) ####
+00060f30: 2054 6869 7320 7472 616e 7366 6f72 6d73   This transforms
+00060f40: 2058 2069 6e74 6f20 6120 506f 6c79 6e6f   X into a Polyno
+00060f50: 6d69 616c 204f 7264 6572 0d0a 2020 2020  mial Order..    
+00060f60: 6578 6365 7074 204d 656d 6f72 7945 7272  except MemoryErr
+00060f70: 6f72 3a0d 0a20 2020 2020 2020 2072 6574  or:..        ret
+00060f80: 7572 6e20 7072 6564 6963 746f 7273 2c20  urn predictors, 
+00060f90: 2727 2c20 582c 206d 642c 205b 5d2c 2064  '', X, md, [], d
+00060fa0: 6963 7428 290d 0a20 2020 2023 2323 2323  ict()..    #####
 00060fb0: 2323 2323 2323 2323 2323 2323 2323 2323  ################
 00060fc0: 2323 2323 2323 2323 2323 2323 2323 2323  ################
-00060fd0: 230d 0a20 2020 2023 2323 2323 2020 2043  #..    #####   C
-00060fe0: 4f4e 5645 5254 2058 2d56 4152 4941 424c  ONVERT X-VARIABL
-00060ff0: 4553 2046 524f 4d20 504f 4c59 2041 4e44  ES FROM POLY AND
-00061000: 2049 4e54 4552 4143 5449 4f4e 2049 4e54   INTERACTION INT
-00061010: 4f20 4f52 4947 494e 414c 2056 4152 4941  O ORIGINAL VARIA
-00061020: 424c 4553 2023 2323 0d0a 2020 2020 2323  BLES ###..    ##
-00061030: 2323 2323 2323 2323 2323 2323 2323 2323  ################
-00061040: 2323 2323 2323 2323 2323 2323 2323 2323  ################
-00061050: 2323 2323 2323 2323 2323 2323 2323 2323  ################
+00060fd0: 2323 2323 2323 2323 2323 2323 2323 2323  ################
+00060fe0: 2323 2323 2323 2323 2323 2323 2323 2323  ################
+00060ff0: 2323 2323 2323 2323 2323 2323 0d0a 2020  ############..  
+00061000: 2020 2323 2323 2320 2020 434f 4e56 4552    #####   CONVER
+00061010: 5420 582d 5641 5249 4142 4c45 5320 4652  T X-VARIABLES FR
+00061020: 4f4d 2050 4f4c 5920 414e 4420 494e 5445  OM POLY AND INTE
+00061030: 5241 4354 494f 4e20 494e 544f 204f 5249  RACTION INTO ORI
+00061040: 4749 4e41 4c20 5641 5249 4142 4c45 5320  GINAL VARIABLES 
+00061050: 2323 230d 0a20 2020 2023 2323 2323 2323  ###..    #######
 00061060: 2323 2323 2323 2323 2323 2323 2323 2323  ################
-00061070: 2323 2323 2323 2323 2323 2323 2323 230d  ###############.
-00061080: 0a20 2020 2078 6e61 6d65 7320 3d20 6d64  .    xnames = md
-00061090: 2e67 6574 5f66 6561 7475 7265 5f6e 616d  .get_feature_nam
-000610a0: 6573 2829 2023 2323 2078 6e61 6d65 7320  es() ### xnames 
-000610b0: 636f 6e74 6169 6e73 2061 6c6c 2078 2d6f  contains all x-o
-000610c0: 6e6c 792c 2050 6f6c 7920 616e 6420 496e  nly, Poly and In
-000610d0: 7478 6e20 7661 7269 6162 6c65 7320 696e  txn variables in
-000610e0: 2078 2d66 6f72 6d61 740d 0a20 2020 2069   x-format..    i
-000610f0: 6620 6c65 6e28 786e 616d 6573 2920 3e20  f len(xnames) > 
-00061100: 3330 303a 0d0a 2020 2020 2020 2020 6d61  300:..        ma
-00061110: 785f 6974 6572 203d 2035 3030 300d 0a20  x_iter = 5000.. 
-00061120: 2020 2065 6c73 653a 0d0a 2020 2020 2020     else:..      
-00061130: 2020 6d61 785f 6974 6572 203d 2032 3030    max_iter = 200
-00061140: 300d 0a20 2020 2023 2323 2323 2320 4255  0..    ###### BU
-00061150: 494c 4449 4e47 2043 4f4d 5041 5249 534f  ILDING COMPARISO
-00061160: 4e20 4d4f 4445 4c20 5749 5448 2049 4e54  N MODEL WITH INT
-00061170: 4552 4143 5449 4f4e 2056 4152 4941 424c  ERACTION VARIABL
-00061180: 4553 2023 2323 2323 2323 2323 2323 2323  ES #############
-00061190: 2323 2323 2323 2323 2323 230d 0a20 2020  ###########..   
-000611a0: 2073 7461 7274 5f74 696d 6520 3d20 7469   start_time = ti
-000611b0: 6d65 2e74 696d 6528 290d 0a20 2020 2069  me.time()..    i
-000611c0: 6620 6d6f 6465 6c74 7970 6520 3d3d 2027  f modeltype == '
-000611d0: 5265 6772 6573 7369 6f6e 273a 0d0a 2020  Regression':..  
-000611e0: 2020 2020 2020 6c6d 203d 204c 6173 736f        lm = Lasso
-000611f0: 2861 6c70 6861 3d30 2e30 3031 2c20 6d61  (alpha=0.001, ma
-00061200: 785f 6974 6572 3d6d 6178 5f69 7465 722c  x_iter=max_iter,
-00061210: 0d0a 2020 2020 2020 2020 2020 2020 2020  ..              
-00061220: 2020 2066 6974 5f69 6e74 6572 6365 7074     fit_intercept
-00061230: 3d54 7275 652c 206e 6f72 6d61 6c69 7a65  =True, normalize
-00061240: 3d46 616c 7365 290d 0a20 2020 2065 6c73  =False)..    els
-00061250: 653a 0d0a 2020 2020 2020 2020 6966 206d  e:..        if m
-00061260: 6f64 656c 7479 7065 203d 3d20 2742 696e  odeltype == 'Bin
-00061270: 6172 795f 436c 6173 7369 6669 6361 7469  ary_Classificati
-00061280: 6f6e 273a 0d0a 2020 2020 2020 2020 2020  on':..          
-00061290: 2020 6c6d 203d 204c 6f67 6973 7469 6352    lm = LogisticR
-000612a0: 6567 7265 7373 696f 6e28 433d 302e 3031  egression(C=0.01
-000612b0: 2c66 6974 5f69 6e74 6572 6365 7074 3d54  ,fit_intercept=T
-000612c0: 7275 652c 2074 6f6c 3d74 6f6c 6572 616e  rue, tol=toleran
-000612d0: 6365 2c0d 0a20 2020 2020 2020 2020 2020  ce,..           
-000612e0: 2020 2020 2020 2020 2020 2020 2020 2020                  
-000612f0: 206d 6178 5f69 7465 723d 6d61 785f 6974   max_iter=max_it
-00061300: 6572 2c73 6f6c 7665 723d 276c 6962 6c69  er,solver='libli
-00061310: 6e65 6172 272c 6e5f 6a6f 6273 3d2d 312c  near',n_jobs=-1,
-00061320: 0d0a 2020 2020 2020 2020 2020 2020 2020  ..              
-00061330: 2020 2020 2020 2020 2020 2020 7065 6e61              pena
-00061340: 6c74 793d 276c 3227 2c64 7561 6c3d 4661  lty='l2',dual=Fa
-00061350: 6c73 652c 2072 616e 646f 6d5f 7374 6174  lse, random_stat
-00061360: 653d 3029 0d0a 2020 2020 2020 2020 656c  e=0)..        el
-00061370: 7365 3a0d 0a20 2020 2020 2020 2020 2020  se:..           
-00061380: 206c 6d20 3d20 4c6f 6769 7374 6963 5265   lm = LogisticRe
-00061390: 6772 6573 7369 6f6e 286d 756c 7469 5f63  gression(multi_c
-000613a0: 6c61 7373 3d27 6f76 7227 2c20 6d61 785f  lass='ovr', max_
-000613b0: 6974 6572 3d31 3030 3030 2920 2323 206c  iter=10000) ## l
-000613c0: 6f67 6973 7469 6320 7365 656d 7320 6265  ogistic seems be
-000613d0: 7374 2061 6d6f 6e67 2061 6c6c 0d0a 2020  st among all..  
-000613e0: 2020 2323 2323 2323 2323 2323 2320 4865    ########### He
-000613f0: 7265 2073 7461 7274 7320 7468 6520 636f  re starts the co
-00061400: 6e76 6572 7369 6f6e 206f 6620 5820 7661  nversion of X va
-00061410: 7269 6162 6c65 7320 696e 746f 2054 6578  riables into Tex
-00061420: 7420 6665 6174 7572 6520 7661 7269 6162  t feature variab
-00061430: 6c65 206e 616d 6573 2023 2323 2323 2323  le names #######
-00061440: 2323 2323 2323 2323 2323 2323 2323 0d0a  ##############..
-00061450: 2020 2020 5850 3120 3d20 7064 2e44 6174      XP1 = pd.Dat
-00061460: 6146 7261 6d65 2858 502c 696e 6465 783d  aFrame(XP,index=
-00061470: 6f72 6967 5f64 6174 615f 696e 6465 782c  orig_data_index,
-00061480: 2063 6f6c 756d 6e73 3d78 6e61 6d65 7329   columns=xnames)
-00061490: 2023 2320 5850 3120 6861 7320 616c 6c20   ## XP1 has all 
-000614a0: 7468 6520 5876 6172 733a 696e 636c 206f  the Xvars:incl o
-000614b0: 7269 672b 706f 6c79 2b69 6e74 786e 2076  rig+poly+intxn v
-000614c0: 6172 730d 0a20 2020 2078 5f76 6172 7320  ars..    x_vars 
-000614d0: 3d20 786e 616d 6573 5b3a 6e5f 6f72 6967  = xnames[:n_orig
-000614e0: 5f66 6561 7475 7265 735d 2020 2323 2320  _features]  ### 
-000614f0: 785f 7661 7273 2063 6f6e 7461 696e 2078  x_vars contain x
-00061500: 5f76 6172 6961 626c 6573 2073 7563 6820  _variables such 
-00061510: 6173 2027 7831 270d 0a20 2020 2023 2323  as 'x1'..    ###
-00061520: 2320 4665 6174 7572 655f 7876 6172 5f64  # Feature_xvar_d
-00061530: 6963 7420 7769 6c6c 206d 6170 2074 6865  ict will map the
-00061540: 2058 5f76 6172 732c 2053 7175 6172 6564   X_vars, Squared
-00061550: 5f76 6172 7320 616e 6420 496e 7478 6e5f  _vars and Intxn_
-00061560: 7661 7273 2062 6163 6b20 746f 2020 5465  vars back to  Te
-00061570: 7874 2076 6172 7320 696e 206f 6e65 2076  xt vars in one v
-00061580: 6172 6961 626c 650d 0a20 2020 2066 6561  ariable..    fea
-00061590: 7475 7265 5f78 7661 725f 6469 6374 203d  ture_xvar_dict =
-000615a0: 2064 6963 7428 7a69 7028 785f 7661 7273   dict(zip(x_vars
-000615b0: 2c70 7265 6469 6374 6f72 7329 2920 2323  ,predictors)) ##
-000615c0: 230d 0a20 2020 2069 6620 6669 745f 666c  #..    if fit_fl
-000615d0: 6167 3a0d 0a20 2020 2020 2020 2023 2323  ag:..        ###
-000615e0: 2320 4966 2074 6865 7265 2069 7320 6669  # If there is fi
-000615f0: 7474 696e 6720 746f 2062 6520 646f 6e65  tting to be done
-00061600: 2c20 7468 656e 2079 6f75 206d 7573 7420  , then you must 
-00061610: 646f 2074 6869 7320 2323 230d 0a20 2020  do this ###..   
-00061620: 2020 2020 2069 6620 4164 645f 506f 6c79       if Add_Poly
-00061630: 203d 3d20 313a 2023 2323 2320 5468 6973   == 1: #### This
-00061640: 2061 6464 7320 6f6e 6c79 2049 6e74 6572   adds only Inter
-00061650: 6163 7469 6f6e 2076 6172 6961 626c 6573  action variables
-00061660: 203d 3e20 6e6f 2050 6f6c 796e 6f6d 6961   => no Polynomia
-00061670: 6c73 210d 0a20 2020 2020 2020 2020 2020  ls!..           
-00061680: 2073 715f 7661 7273 203d 205b 5d20 2020   sq_vars = []   
-00061690: 2023 2323 2073 715f 7661 7273 2063 6f6e   ### sq_vars con
-000616a0: 7461 696e 206f 6e6c 7920 782d 7371 7561  tain only x-squa
-000616b0: 7265 6420 7661 7269 6162 6c65 7320 7375  red variables su
-000616c0: 6368 2061 7320 2778 5e32 270d 0a20 2020  ch as 'x^2'..   
-000616d0: 2020 2020 2020 2020 2069 6e74 786e 5f76           intxn_v
-000616e0: 6172 7320 3d20 6c65 6674 5f73 7562 7472  ars = left_subtr
-000616f0: 6163 7428 786e 616d 6573 2c20 7371 5f76  act(xnames, sq_v
-00061700: 6172 732b 785f 7661 7273 2920 2323 2320  ars+x_vars) ### 
-00061710: 696e 7478 6e5f 7661 7273 2063 6f6e 7461  intxn_vars conta
-00061720: 696e 2069 6e74 6572 6163 7469 6f6e 2076  in interaction v
-00061730: 6172 7320 7375 6368 2061 7320 2778 3120  ars such as 'x1 
-00061740: 7832 270d 0a20 2020 2020 2020 2065 6c69  x2'..        eli
-00061750: 6620 4164 645f 506f 6c79 203d 3d20 323a  f Add_Poly == 2:
-00061760: 2023 2323 2320 5468 6973 2061 6464 7320   #### This adds 
-00061770: 6f6e 6c79 2050 6f6c 796e 6f6d 6961 6c20  only Polynomial 
-00061780: 7661 7269 6162 6c65 7320 3d3e 206e 6f20  variables => no 
-00061790: 496e 7465 7261 6374 696f 6e73 210d 0a20  Interactions!.. 
-000617a0: 2020 2020 2020 2020 2020 2073 715f 7661             sq_va
-000617b0: 7273 203d 205b 7820 666f 7220 7820 696e  rs = [x for x in
-000617c0: 2078 6e61 6d65 7320 6966 2027 5e32 2720   xnames if '^2' 
-000617d0: 696e 2078 5d20 2020 2023 2323 2073 715f  in x]    ### sq_
-000617e0: 7661 7273 2063 6f6e 7461 696e 206f 6e6c  vars contain onl
-000617f0: 7920 782d 7371 7561 7265 6420 7661 7269  y x-squared vari
-00061800: 6162 6c65 7320 7375 6368 2061 7320 2778  ables such as 'x
-00061810: 5e32 270d 0a20 2020 2020 2020 2020 2020  ^2'..           
-00061820: 2069 6e74 786e 5f76 6172 7320 3d20 5b5d   intxn_vars = []
-00061830: 2023 2323 2069 6e74 786e 5f76 6172 7320   ### intxn_vars 
-00061840: 636f 6e74 6169 6e20 696e 7465 7261 6374  contain interact
-00061850: 696f 6e20 7661 7273 2073 7563 6820 6173  ion vars such as
-00061860: 2027 7831 2078 3227 0d0a 2020 2020 2020   'x1 x2'..      
-00061870: 2020 656c 6966 2041 6464 5f50 6f6c 7920    elif Add_Poly 
-00061880: 3d3d 2033 3a20 2323 2323 2054 6869 7320  == 3: #### This 
-00061890: 6164 6473 2042 6f74 6820 496e 7465 7261  adds Both Intera
-000618a0: 6374 696f 6e20 616e 6420 506f 6c79 6e6f  ction and Polyno
-000618b0: 6d69 616c 2076 6172 6961 626c 6573 203d  mial variables =
-000618c0: 3e20 4265 7374 206f 6620 426f 7468 2077  > Best of Both w
-000618d0: 6f72 6c64 7321 0d0a 2020 2020 2020 2020  orlds!..        
-000618e0: 2020 2020 7371 5f76 6172 7320 3d20 5b78      sq_vars = [x
-000618f0: 2066 6f72 2078 2069 6e20 786e 616d 6573   for x in xnames
-00061900: 2069 6620 275e 3227 2069 6e20 785d 2020   if '^2' in x]  
-00061910: 2020 2323 2320 7371 5f76 6172 7320 636f    ### sq_vars co
-00061920: 6e74 6169 6e20 6f6e 6c79 2078 2d73 7175  ntain only x-squ
-00061930: 6172 6564 2076 6172 6961 626c 6573 2073  ared variables s
-00061940: 7563 6820 6173 2027 785e 3227 0d0a 2020  uch as 'x^2'..  
-00061950: 2020 2020 2020 2020 2020 696e 7478 6e5f            intxn_
-00061960: 7661 7273 203d 206c 6566 745f 7375 6274  vars = left_subt
-00061970: 7261 6374 2878 6e61 6d65 732c 2073 715f  ract(xnames, sq_
-00061980: 7661 7273 2b78 5f76 6172 7329 2023 2323  vars+x_vars) ###
-00061990: 2069 6e74 786e 5f76 6172 7320 636f 6e74   intxn_vars cont
-000619a0: 6169 6e20 696e 7465 7261 6374 696f 6e20  ain interaction 
-000619b0: 7661 7273 2073 7563 6820 6173 2027 7831  vars such as 'x1
-000619c0: 2078 3227 0d0a 2020 2020 2020 2020 2323   x2'..        ##
-000619d0: 2323 2020 4974 2069 7320 6e6f 7720 7469  ##  It is now ti
-000619e0: 6d65 2074 6f20 6375 7420 646f 776e 2074  me to cut down t
-000619f0: 6865 206f 7269 6769 6e61 6c20 785f 7661  he original x_va
-00061a00: 7269 6162 6c65 7320 746f 206a 7573 7420  riables to just 
-00061a10: 7371 7561 7265 6420 7661 7269 6162 6c65  squared variable
-00061a20: 7320 616e 6420 6f72 6967 696e 616c 7320  s and originals 
-00061a30: 6865 7265 2023 2323 230d 0a20 2020 2020  here ####..     
-00061a40: 2020 2064 6963 745f 7661 7273 203d 2064     dict_vars = d
-00061a50: 6963 7428 7a69 7028 7072 6564 6963 746f  ict(zip(predicto
-00061a60: 7273 2c78 5f76 6172 7329 2920 2323 2320  rs,x_vars)) ### 
-00061a70: 7468 6973 2069 7320 6120 6469 6374 696f  this is a dictio
-00061a80: 6e61 7279 206d 6170 7069 6e67 206f 7269  nary mapping ori
-00061a90: 6769 6e61 6c20 7661 7269 6162 6c65 7320  ginal variables 
-00061aa0: 616e 6420 7468 6569 7220 782d 7661 7269  and their x-vari
-00061ab0: 6162 6c65 730d 0a20 2020 2020 2020 2072  ables..        r
-00061ac0: 6576 6572 7365 5f64 6963 745f 7661 7273  everse_dict_vars
-00061ad0: 203d 2064 6963 7428 5b28 792c 7829 2066   = dict([(y,x) f
-00061ae0: 6f72 2028 782c 7929 2069 6e20 6469 6374  or (x,y) in dict
-00061af0: 5f76 6172 732e 6974 656d 7328 295d 2920  _vars.items()]) 
-00061b00: 2323 2320 7468 6973 206d 6170 7320 7468  ### this maps th
-00061b10: 6520 782d 7661 7273 2074 6f20 6f72 6967  e x-vars to orig
-00061b20: 696e 616c 2076 6172 730d 0a20 2020 2020  inal vars..     
-00061b30: 2020 2023 2323 2323 204e 6f77 206c 6574     ##### Now let
-00061b40: 2773 2063 6f6e 7665 7274 2049 6e74 6572  's convert Inter
-00061b50: 6163 7469 6f6e 2078 5f76 6172 6961 626c  action x_variabl
-00061b60: 6573 2069 6e74 6f20 7468 6569 7220 636f  es into their co
-00061b70: 7272 6573 706f 6e64 696e 6720 7465 7874  rresponding text
-00061b80: 2076 6172 6961 626c 6573 0d0a 2020 2020   variables..    
-00061b90: 2020 2020 696e 7478 6e5f 7465 7874 5f76      intxn_text_v
-00061ba0: 6172 7320 3d20 5b5d 0d0a 2020 2020 2020  ars = []..      
-00061bb0: 2020 666f 7220 6561 6368 5f69 7465 6d20    for each_item 
-00061bc0: 696e 2069 6e74 786e 5f76 6172 733a 0d0a  in intxn_vars:..
-00061bd0: 2020 2020 2020 2020 2020 2020 6966 206c              if l
-00061be0: 656e 2865 6163 685f 6974 656d 2e73 706c  en(each_item.spl
-00061bf0: 6974 2822 2022 2929 203d 3d20 313a 0d0a  it(" ")) == 1:..
-00061c00: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00061c10: 696e 7478 6e5f 7465 7874 5f76 6172 732e  intxn_text_vars.
-00061c20: 6170 7065 6e64 2872 6576 6572 7365 5f64  append(reverse_d
-00061c30: 6963 745f 7661 7273 5b65 6163 685f 6974  ict_vars[each_it
-00061c40: 656d 5d29 0d0a 2020 2020 2020 2020 2020  em])..          
-00061c50: 2020 2020 2020 6665 6174 7572 655f 7876        feature_xv
-00061c60: 6172 5f64 6963 745b 6561 6368 5f69 7465  ar_dict[each_ite
-00061c70: 6d5d 203d 2072 6576 6572 7365 5f64 6963  m] = reverse_dic
-00061c80: 745f 7661 7273 5b65 6163 685f 6974 656d  t_vars[each_item
-00061c90: 5d0d 0a20 2020 2020 2020 2020 2020 2065  ]..            e
-00061ca0: 6c69 6620 6c65 6e28 6561 6368 5f69 7465  lif len(each_ite
-00061cb0: 6d2e 7370 6c69 7428 2220 2229 2920 3d3d  m.split(" ")) ==
-00061cc0: 2032 3a0d 0a20 2020 2020 2020 2020 2020   2:..           
-00061cd0: 2020 2020 2074 776f 5f69 7465 6d73 5f6c       two_items_l
-00061ce0: 6973 7420 3d20 6561 6368 5f69 7465 6d2e  ist = each_item.
-00061cf0: 7370 6c69 7428 2220 2229 0d0a 2020 2020  split(" ")..    
-00061d00: 2020 2020 2020 2020 2020 2020 6675 6c6c              full
-00061d10: 5f69 6e74 786e 5f6e 616d 6520 3d20 7265  _intxn_name = re
-00061d20: 7665 7273 655f 6469 6374 5f76 6172 735b  verse_dict_vars[
-00061d30: 7477 6f5f 6974 656d 735f 6c69 7374 5b30  two_items_list[0
-00061d40: 5d5d 202b 2220 222b 2072 6576 6572 7365  ]] +" "+ reverse
-00061d50: 5f64 6963 745f 7661 7273 5b74 776f 5f69  _dict_vars[two_i
-00061d60: 7465 6d73 5f6c 6973 745b 315d 5d0d 0a20  tems_list[1]].. 
-00061d70: 2020 2020 2020 2020 2020 2020 2020 2069                 i
-00061d80: 6e74 786e 5f74 6578 745f 7661 7273 2e61  ntxn_text_vars.a
-00061d90: 7070 656e 6428 6675 6c6c 5f69 6e74 786e  ppend(full_intxn
-00061da0: 5f6e 616d 6529 0d0a 2020 2020 2020 2020  _name)..        
-00061db0: 2020 2020 2020 2020 6665 6174 7572 655f          feature_
-00061dc0: 7876 6172 5f64 6963 745b 6561 6368 5f69  xvar_dict[each_i
-00061dd0: 7465 6d5d 203d 2066 756c 6c5f 696e 7478  tem] = full_intx
-00061de0: 6e5f 6e61 6d65 0d0a 2020 2020 2020 2020  n_name..        
-00061df0: 2020 2020 656c 7365 3a0d 0a20 2020 2020      else:..     
-00061e00: 2020 2020 2020 2020 2020 2070 6173 730d             pass.
-00061e10: 0a20 2020 2020 2020 2023 2323 2323 204e  .        ##### N
-00061e20: 6f77 206c 6574 2773 2063 6f6e 7665 7274  ow let's convert
-00061e30: 2053 7175 6172 6564 2078 5f76 6172 6961   Squared x_varia
-00061e40: 626c 6573 2069 6e74 6f20 7468 6569 7220  bles into their 
-00061e50: 636f 7272 6573 706f 6e64 696e 6720 7465  corresponding te
-00061e60: 7874 2076 6172 6961 626c 6573 0d0a 2020  xt variables..  
-00061e70: 2020 2020 2020 7371 5f74 6578 745f 7661        sq_text_va
-00061e80: 7273 203d 205b 5d0d 0a20 2020 2020 2020  rs = []..       
-00061e90: 2066 6f72 2065 6163 685f 7371 5f69 7465   for each_sq_ite
-00061ea0: 6d20 696e 2073 715f 7661 7273 3a0d 0a20  m in sq_vars:.. 
-00061eb0: 2020 2020 2020 2020 2020 2069 6620 6c65             if le
-00061ec0: 6e28 6561 6368 5f73 715f 6974 656d 2e73  n(each_sq_item.s
-00061ed0: 706c 6974 2822 5e22 2929 203d 3d20 323a  plit("^")) == 2:
-00061ee0: 0d0a 2020 2020 2020 2020 2020 2020 2020  ..              
-00061ef0: 2020 7477 6f5f 6974 656d 5f6c 6973 7420    two_item_list 
-00061f00: 3d20 6561 6368 5f73 715f 6974 656d 2e73  = each_sq_item.s
-00061f10: 706c 6974 2822 5e22 290d 0a20 2020 2020  plit("^")..     
-00061f20: 2020 2020 2020 2020 2020 2066 756c 6c5f             full_
-00061f30: 7371 5f6e 616d 6520 3d20 7265 7665 7273  sq_name = revers
-00061f40: 655f 6469 6374 5f76 6172 735b 7477 6f5f  e_dict_vars[two_
-00061f50: 6974 656d 5f6c 6973 745b 305d 5d20 2b22  item_list[0]] +"
-00061f60: 5e32 220d 0a20 2020 2020 2020 2020 2020  ^2"..           
-00061f70: 2020 2020 2073 715f 7465 7874 5f76 6172       sq_text_var
-00061f80: 732e 6170 7065 6e64 2866 756c 6c5f 7371  s.append(full_sq
-00061f90: 5f6e 616d 6529 0d0a 2020 2020 2020 2020  _name)..        
-00061fa0: 2020 2020 2020 2020 6665 6174 7572 655f          feature_
-00061fb0: 7876 6172 5f64 6963 745b 6561 6368 5f73  xvar_dict[each_s
-00061fc0: 715f 6974 656d 5d20 3d20 6675 6c6c 5f73  q_item] = full_s
-00061fd0: 715f 6e61 6d65 0d0a 2020 2020 2020 2020  q_name..        
-00061fe0: 2020 2020 656c 7365 3a0d 0a20 2020 2020      else:..     
-00061ff0: 2020 2020 2020 2020 2020 2070 6173 730d             pass.
-00062000: 0a20 2020 2020 2020 2023 2323 2320 4e6f  .        #### No
-00062010: 7720 7765 206e 6565 6420 746f 2063 6f6d  w we need to com
-00062020: 6269 6e65 2074 6865 2078 5f76 6172 732c  bine the x_vars,
-00062030: 2053 7175 6172 6564 5f76 6172 7320 616e   Squared_vars an
-00062040: 6420 7468 6520 496e 7478 6e5f 7661 7273  d the Intxn_vars
-00062050: 2074 6f67 6574 6865 7220 6173 2054 6578   together as Tex
-00062060: 7420 7661 7273 2069 6e20 6f6e 6520 7661  t vars in one va
-00062070: 7269 6162 6c65 0d0a 2020 2020 2020 2020  riable..        
-00062080: 6675 6c6c 5f78 5f76 6172 7320 3d20 785f  full_x_vars = x_
-00062090: 7661 7273 202b 2073 715f 7661 7273 202b  vars + sq_vars +
-000620a0: 2069 6e74 786e 5f76 6172 730d 0a20 2020   intxn_vars..   
-000620b0: 2020 2020 2074 6578 745f 7661 7273 203d       text_vars =
-000620c0: 2070 7265 6469 6374 6f72 7320 2b20 7371   predictors + sq
-000620d0: 5f74 6578 745f 7661 7273 202b 2069 6e74  _text_vars + int
-000620e0: 786e 5f74 6578 745f 7661 7273 2023 2323  xn_text_vars ###
-000620f0: 2320 7465 7874 5f76 6172 7320 6e6f 7720  # text_vars now 
-00062100: 636f 6e74 6169 6e73 2061 6c6c 2074 6865  contains all the
-00062110: 2074 6578 7420 7665 7273 696f 6e20 6f66   text version of
-00062120: 2078 2d76 6172 6961 626c 6573 0d0a 2020   x-variables..  
-00062130: 2020 2020 2020 6966 206c 656e 2874 6578        if len(tex
-00062140: 745f 7661 7273 2920 3d3d 206c 656e 2866  t_vars) == len(f
-00062150: 756c 6c5f 785f 7661 7273 293a 0d0a 2020  ull_x_vars):..  
-00062160: 2020 2020 2020 2020 2020 7072 696e 7428            print(
-00062170: 2753 7563 6365 7373 6675 6c6c 7920 7472  'Successfully tr
-00062180: 616e 7366 6f72 6d65 6420 782d 7661 7269  ansformed x-vari
-00062190: 6162 6c65 7320 696e 746f 2074 6578 742d  ables into text-
-000621a0: 7661 7269 6162 6c65 7320 6166 7465 7220  variables after 
-000621b0: 506f 6c79 6e6f 6d69 616c 2074 7261 6e73  Polynomial trans
-000621c0: 666f 726d 6174 696f 6e73 2729 0d0a 2020  formations')..  
-000621d0: 2020 2020 2020 656c 7365 3a0d 0a20 2020        else:..   
-000621e0: 2020 2020 2020 2020 2070 7269 6e74 2827           print('
-000621f0: 4572 726f 723a 204e 6f74 2061 626c 6520  Error: Not able 
-00062200: 746f 2074 7261 6e73 666f 726d 2078 2d76  to transform x-v
-00062210: 6172 6961 626c 6573 2069 6e74 6f20 7465  ariables into te
-00062220: 7874 2d76 6172 6961 626c 6573 2e20 436f  xt-variables. Co
-00062230: 6e74 696e 7569 6e67 2077 6974 686f 7574  ntinuing without
-00062240: 2050 6f6c 7920 7661 7273 2e2e 2e27 290d   Poly vars...').
-00062250: 0a20 2020 2020 2020 2020 2020 2072 6574  .            ret
-00062260: 7572 6e20 7072 6564 6963 746f 7273 2c20  urn predictors, 
-00062270: 6c6d 2c20 5850 312c 206d 642c 2078 5f76  lm, XP1, md, x_v
-00062280: 6172 732c 6665 6174 7572 655f 7876 6172  ars,feature_xvar
-00062290: 5f64 6963 740d 0a20 2020 2020 2020 2066  _dict..        f
-000622a0: 6561 7475 7265 5f74 6578 7476 6172 5f64  eature_textvar_d
-000622b0: 6963 7420 203d 2064 6963 7428 5b28 792c  ict  = dict([(y,
-000622c0: 7829 2066 6f72 2028 782c 7929 2069 6e20  x) for (x,y) in 
-000622d0: 6665 6174 7572 655f 7876 6172 5f64 6963  feature_xvar_dic
-000622e0: 742e 6974 656d 7328 295d 290d 0a20 2020  t.items()])..   
-000622f0: 2020 2020 2023 2323 2320 4e6f 7720 4275       #### Now Bu
-00062300: 696c 6420 6120 4461 7461 2046 7261 6d65  ild a Data Frame
-00062310: 2063 6f6e 7461 696e 696e 6720 636f 6e74   containing cont
-00062320: 6169 6e69 6e67 2061 6464 6974 696f 6e61  aining additiona
-00062330: 6c20 506f 6c79 2061 6e64 2049 6e74 786e  l Poly and Intxn
-00062340: 2076 6172 6961 626c 6573 2069 6e20 782d   variables in x-
-00062350: 666f 726d 6174 2068 6572 6520 2323 2323  format here ####
-00062360: 0d0a 2020 2020 2020 2020 6e65 775f 6164  ..        new_ad
-00062370: 6478 5f76 6172 7320 3d20 7371 5f76 6172  dx_vars = sq_var
-00062380: 732b 696e 7478 6e5f 7661 7273 0d0a 2020  s+intxn_vars..  
-00062390: 2020 2020 2020 6966 206c 656e 286e 6577        if len(new
-000623a0: 5f61 6464 785f 7661 7273 2920 3d3d 2030  _addx_vars) == 0
+00061070: 2323 2323 2323 2323 2323 2323 2323 2323  ################
+00061080: 2323 2323 2323 2323 2323 2323 2323 2323  ################
+00061090: 2323 2323 2323 2323 2323 2323 2323 2323  ################
+000610a0: 2323 2323 2323 2323 2323 0d0a 2020 2020  ##########..    
+000610b0: 6966 204c 6f6f 7365 5665 7273 696f 6e28  if LooseVersion(
+000610c0: 736b 6c65 6172 6e2e 5f5f 7665 7273 696f  sklearn.__versio
+000610d0: 6e5f 5f29 203c 204c 6f6f 7365 5665 7273  n__) < LooseVers
+000610e0: 696f 6e28 2730 2e32 342e 3227 293a 0d0a  ion('0.24.2'):..
+000610f0: 2020 2020 2020 2020 2320 5065 7266 6f72          # Perfor
+00061100: 6d20 6163 7469 6f6e 2066 6f72 2073 6369  m action for sci
+00061110: 6b69 742d 6c65 6172 6e20 7665 7273 696f  kit-learn versio
+00061120: 6e20 6265 6c6f 7720 302e 3234 2e32 0d0a  n below 0.24.2..
+00061130: 2020 2020 2020 2020 7072 696e 7428 2250          print("P
+00061140: 6572 666f 726d 696e 6720 6163 7469 6f6e  erforming action
+00061150: 2066 6f72 2073 6369 6b69 742d 6c65 6172   for scikit-lear
+00061160: 6e20 7665 7273 696f 6e20 6265 6c6f 7720  n version below 
+00061170: 302e 3234 2e32 2229 0d0a 2020 2020 2020  0.24.2")..      
+00061180: 2020 2320 4164 6420 796f 7572 2063 6f64    # Add your cod
+00061190: 6520 6865 7265 2066 6f72 2073 6369 6b69  e here for sciki
+000611a0: 742d 6c65 6172 6e20 7665 7273 696f 6e20  t-learn version 
+000611b0: 6265 6c6f 7720 302e 3234 2e32 0d0a 2020  below 0.24.2..  
+000611c0: 2020 2020 2020 786e 616d 6573 203d 206d        xnames = m
+000611d0: 642e 6765 745f 6665 6174 7572 655f 6e61  d.get_feature_na
+000611e0: 6d65 7328 290d 0a20 2020 2065 6c73 653a  mes()..    else:
+000611f0: 0d0a 2020 2020 2020 2020 2320 5065 7266  ..        # Perf
+00061200: 6f72 6d20 6163 7469 6f6e 2066 6f72 2073  orm action for s
+00061210: 6369 6b69 742d 6c65 6172 6e20 7665 7273  cikit-learn vers
+00061220: 696f 6e20 302e 3234 2e32 2061 6e64 2061  ion 0.24.2 and a
+00061230: 626f 7665 0d0a 2020 2020 2020 2020 7072  bove..        pr
+00061240: 696e 7428 2250 6572 666f 726d 696e 6720  int("Performing 
+00061250: 6163 7469 6f6e 2066 6f72 2073 6369 6b69  action for sciki
+00061260: 742d 6c65 6172 6e20 7665 7273 696f 6e20  t-learn version 
+00061270: 302e 3234 2e32 2061 6e64 2061 626f 7665  0.24.2 and above
+00061280: 2229 0d0a 2020 2020 2020 2020 2320 4164  ")..        # Ad
+00061290: 6420 796f 7572 2063 6f64 6520 6865 7265  d your code here
+000612a0: 2066 6f72 2073 6369 6b69 742d 6c65 6172   for scikit-lear
+000612b0: 6e20 7665 7273 696f 6e20 302e 3234 2e32  n version 0.24.2
+000612c0: 2061 6e64 2061 626f 7665 0d0a 2020 2020   and above..    
+000612d0: 2020 2020 786e 616d 6573 203d 206d 642e      xnames = md.
+000612e0: 6765 745f 6665 6174 7572 655f 6e61 6d65  get_feature_name
+000612f0: 735f 6f75 7428 292e 746f 6c69 7374 2829  s_out().tolist()
+00061300: 2023 2323 2078 6e61 6d65 7320 636f 6e74   ### xnames cont
+00061310: 6169 6e73 2061 6c6c 2078 2d6f 6e6c 792c  ains all x-only,
+00061320: 2050 6f6c 7920 616e 6420 496e 7478 6e20   Poly and Intxn 
+00061330: 7661 7269 6162 6c65 7320 696e 2078 2d66  variables in x-f
+00061340: 6f72 6d61 740d 0a20 2020 2020 2020 200d  ormat..        .
+00061350: 0a20 2020 2069 6620 6c65 6e28 786e 616d  .    if len(xnam
+00061360: 6573 2920 3e20 3330 303a 0d0a 2020 2020  es) > 300:..    
+00061370: 2020 2020 6d61 785f 6974 6572 203d 2035      max_iter = 5
+00061380: 3030 300d 0a20 2020 2065 6c73 653a 0d0a  000..    else:..
+00061390: 2020 2020 2020 2020 6d61 785f 6974 6572          max_iter
+000613a0: 203d 2032 3030 300d 0a20 2020 2023 2323   = 2000..    ###
+000613b0: 2323 2320 4255 494c 4449 4e47 2043 4f4d  ### BUILDING COM
+000613c0: 5041 5249 534f 4e20 4d4f 4445 4c20 5749  PARISON MODEL WI
+000613d0: 5448 2049 4e54 4552 4143 5449 4f4e 2056  TH INTERACTION V
+000613e0: 4152 4941 424c 4553 2023 2323 2323 2323  ARIABLES #######
+000613f0: 2323 2323 2323 2323 2323 2323 2323 2323  ################
+00061400: 230d 0a20 2020 2073 7461 7274 5f74 696d  #..    start_tim
+00061410: 6520 3d20 7469 6d65 2e74 696d 6528 290d  e = time.time().
+00061420: 0a20 2020 2069 6620 6d6f 6465 6c74 7970  .    if modeltyp
+00061430: 6520 3d3d 2027 5265 6772 6573 7369 6f6e  e == 'Regression
+00061440: 273a 0d0a 2020 2020 2020 2020 6c6d 203d  ':..        lm =
+00061450: 204c 6173 736f 2861 6c70 6861 3d30 2e30   Lasso(alpha=0.0
+00061460: 3031 2c20 6d61 785f 6974 6572 3d6d 6178  01, max_iter=max
+00061470: 5f69 7465 722c 0d0a 2020 2020 2020 2020  _iter,..        
+00061480: 2020 2020 2020 2020 2066 6974 5f69 6e74           fit_int
+00061490: 6572 6365 7074 3d54 7275 6529 0d0a 2020  ercept=True)..  
+000614a0: 2020 656c 7365 3a0d 0a20 2020 2020 2020    else:..       
+000614b0: 2069 6620 6d6f 6465 6c74 7970 6520 3d3d   if modeltype ==
+000614c0: 2027 4269 6e61 7279 5f43 6c61 7373 6966   'Binary_Classif
+000614d0: 6963 6174 696f 6e27 3a0d 0a20 2020 2020  ication':..     
+000614e0: 2020 2020 2020 206c 6d20 3d20 4c6f 6769         lm = Logi
+000614f0: 7374 6963 5265 6772 6573 7369 6f6e 2843  sticRegression(C
+00061500: 3d30 2e30 312c 6669 745f 696e 7465 7263  =0.01,fit_interc
+00061510: 6570 743d 5472 7565 2c20 746f 6c3d 746f  ept=True, tol=to
+00061520: 6c65 7261 6e63 652c 0d0a 2020 2020 2020  lerance,..      
+00061530: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00061540: 2020 2020 2020 6d61 785f 6974 6572 3d6d        max_iter=m
+00061550: 6178 5f69 7465 722c 736f 6c76 6572 3d27  ax_iter,solver='
+00061560: 6c69 626c 696e 6561 7227 2c6e 5f6a 6f62  liblinear',n_job
+00061570: 733d 2d31 2c0d 0a20 2020 2020 2020 2020  s=-1,..         
+00061580: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00061590: 2070 656e 616c 7479 3d27 6c32 272c 6475   penalty='l2',du
+000615a0: 616c 3d46 616c 7365 2c20 7261 6e64 6f6d  al=False, random
+000615b0: 5f73 7461 7465 3d30 290d 0a20 2020 2020  _state=0)..     
+000615c0: 2020 2065 6c73 653a 0d0a 2020 2020 2020     else:..      
+000615d0: 2020 2020 2020 6c6d 203d 204c 6f67 6973        lm = Logis
+000615e0: 7469 6352 6567 7265 7373 696f 6e28 6d75  ticRegression(mu
+000615f0: 6c74 695f 636c 6173 733d 276f 7672 272c  lti_class='ovr',
+00061600: 206d 6178 5f69 7465 723d 3130 3030 3029   max_iter=10000)
+00061610: 2023 2320 6c6f 6769 7374 6963 2073 6565   ## logistic see
+00061620: 6d73 2062 6573 7420 616d 6f6e 6720 616c  ms best among al
+00061630: 6c0d 0a20 2020 2023 2323 2323 2323 2323  l..    #########
+00061640: 2323 2048 6572 6520 7374 6172 7473 2074  ## Here starts t
+00061650: 6865 2063 6f6e 7665 7273 696f 6e20 6f66  he conversion of
+00061660: 2058 2076 6172 6961 626c 6573 2069 6e74   X variables int
+00061670: 6f20 5465 7874 2066 6561 7475 7265 2076  o Text feature v
+00061680: 6172 6961 626c 6520 6e61 6d65 7320 2323  ariable names ##
+00061690: 2323 2323 2323 2323 2323 2323 2323 2323  ################
+000616a0: 2323 230d 0a20 2020 2058 5031 203d 2070  ###..    XP1 = p
+000616b0: 642e 4461 7461 4672 616d 6528 5850 2c69  d.DataFrame(XP,i
+000616c0: 6e64 6578 3d6f 7269 675f 6461 7461 5f69  ndex=orig_data_i
+000616d0: 6e64 6578 2c20 636f 6c75 6d6e 733d 786e  ndex, columns=xn
+000616e0: 616d 6573 2920 2323 2058 5031 2068 6173  ames) ## XP1 has
+000616f0: 2061 6c6c 2074 6865 2058 7661 7273 3a69   all the Xvars:i
+00061700: 6e63 6c20 6f72 6967 2b70 6f6c 792b 696e  ncl orig+poly+in
+00061710: 7478 6e20 7661 7273 0d0a 2020 2020 785f  txn vars..    x_
+00061720: 7661 7273 203d 2078 6e61 6d65 735b 3a6e  vars = xnames[:n
+00061730: 5f6f 7269 675f 6665 6174 7572 6573 5d20  _orig_features] 
+00061740: 2023 2323 2078 5f76 6172 7320 636f 6e74   ### x_vars cont
+00061750: 6169 6e20 785f 7661 7269 6162 6c65 7320  ain x_variables 
+00061760: 7375 6368 2061 7320 2778 3127 0d0a 2020  such as 'x1'..  
+00061770: 2020 2323 2323 2046 6561 7475 7265 5f78    #### Feature_x
+00061780: 7661 725f 6469 6374 2077 696c 6c20 6d61  var_dict will ma
+00061790: 7020 7468 6520 585f 7661 7273 2c20 5371  p the X_vars, Sq
+000617a0: 7561 7265 645f 7661 7273 2061 6e64 2049  uared_vars and I
+000617b0: 6e74 786e 5f76 6172 7320 6261 636b 2074  ntxn_vars back t
+000617c0: 6f20 2054 6578 7420 7661 7273 2069 6e20  o  Text vars in 
+000617d0: 6f6e 6520 7661 7269 6162 6c65 0d0a 2020  one variable..  
+000617e0: 2020 6665 6174 7572 655f 7876 6172 5f64    feature_xvar_d
+000617f0: 6963 7420 3d20 6469 6374 287a 6970 2878  ict = dict(zip(x
+00061800: 5f76 6172 732c 7072 6564 6963 746f 7273  _vars,predictors
+00061810: 2929 2023 2323 0d0a 2020 2020 6966 2066  )) ###..    if f
+00061820: 6974 5f66 6c61 673a 0d0a 2020 2020 2020  it_flag:..      
+00061830: 2020 2323 2323 2049 6620 7468 6572 6520    #### If there 
+00061840: 6973 2066 6974 7469 6e67 2074 6f20 6265  is fitting to be
+00061850: 2064 6f6e 652c 2074 6865 6e20 796f 7520   done, then you 
+00061860: 6d75 7374 2064 6f20 7468 6973 2023 2323  must do this ###
+00061870: 0d0a 2020 2020 2020 2020 6966 2041 6464  ..        if Add
+00061880: 5f50 6f6c 7920 3d3d 2031 3a20 2323 2323  _Poly == 1: ####
+00061890: 2054 6869 7320 6164 6473 206f 6e6c 7920   This adds only 
+000618a0: 496e 7465 7261 6374 696f 6e20 7661 7269  Interaction vari
+000618b0: 6162 6c65 7320 3d3e 206e 6f20 506f 6c79  ables => no Poly
+000618c0: 6e6f 6d69 616c 7321 0d0a 2020 2020 2020  nomials!..      
+000618d0: 2020 2020 2020 7371 5f76 6172 7320 3d20        sq_vars = 
+000618e0: 5b5d 2020 2020 2323 2320 7371 5f76 6172  []    ### sq_var
+000618f0: 7320 636f 6e74 6169 6e20 6f6e 6c79 2078  s contain only x
+00061900: 2d73 7175 6172 6564 2076 6172 6961 626c  -squared variabl
+00061910: 6573 2073 7563 6820 6173 2027 785e 3227  es such as 'x^2'
+00061920: 0d0a 2020 2020 2020 2020 2020 2020 696e  ..            in
+00061930: 7478 6e5f 7661 7273 203d 206c 6566 745f  txn_vars = left_
+00061940: 7375 6274 7261 6374 2878 6e61 6d65 732c  subtract(xnames,
+00061950: 2073 715f 7661 7273 2b78 5f76 6172 7329   sq_vars+x_vars)
+00061960: 2023 2323 2069 6e74 786e 5f76 6172 7320   ### intxn_vars 
+00061970: 636f 6e74 6169 6e20 696e 7465 7261 6374  contain interact
+00061980: 696f 6e20 7661 7273 2073 7563 6820 6173  ion vars such as
+00061990: 2027 7831 2078 3227 0d0a 2020 2020 2020   'x1 x2'..      
+000619a0: 2020 656c 6966 2041 6464 5f50 6f6c 7920    elif Add_Poly 
+000619b0: 3d3d 2032 3a20 2323 2323 2054 6869 7320  == 2: #### This 
+000619c0: 6164 6473 206f 6e6c 7920 506f 6c79 6e6f  adds only Polyno
+000619d0: 6d69 616c 2076 6172 6961 626c 6573 203d  mial variables =
+000619e0: 3e20 6e6f 2049 6e74 6572 6163 7469 6f6e  > no Interaction
+000619f0: 7321 0d0a 2020 2020 2020 2020 2020 2020  s!..            
+00061a00: 7371 5f76 6172 7320 3d20 5b78 2066 6f72  sq_vars = [x for
+00061a10: 2078 2069 6e20 786e 616d 6573 2069 6620   x in xnames if 
+00061a20: 275e 3227 2069 6e20 785d 2020 2020 2323  '^2' in x]    ##
+00061a30: 2320 7371 5f76 6172 7320 636f 6e74 6169  # sq_vars contai
+00061a40: 6e20 6f6e 6c79 2078 2d73 7175 6172 6564  n only x-squared
+00061a50: 2076 6172 6961 626c 6573 2073 7563 6820   variables such 
+00061a60: 6173 2027 785e 3227 0d0a 2020 2020 2020  as 'x^2'..      
+00061a70: 2020 2020 2020 696e 7478 6e5f 7661 7273        intxn_vars
+00061a80: 203d 205b 5d20 2323 2320 696e 7478 6e5f   = [] ### intxn_
+00061a90: 7661 7273 2063 6f6e 7461 696e 2069 6e74  vars contain int
+00061aa0: 6572 6163 7469 6f6e 2076 6172 7320 7375  eraction vars su
+00061ab0: 6368 2061 7320 2778 3120 7832 270d 0a20  ch as 'x1 x2'.. 
+00061ac0: 2020 2020 2020 2065 6c69 6620 4164 645f         elif Add_
+00061ad0: 506f 6c79 203d 3d20 333a 2023 2323 2320  Poly == 3: #### 
+00061ae0: 5468 6973 2061 6464 7320 426f 7468 2049  This adds Both I
+00061af0: 6e74 6572 6163 7469 6f6e 2061 6e64 2050  nteraction and P
+00061b00: 6f6c 796e 6f6d 6961 6c20 7661 7269 6162  olynomial variab
+00061b10: 6c65 7320 3d3e 2042 6573 7420 6f66 2042  les => Best of B
+00061b20: 6f74 6820 776f 726c 6473 210d 0a20 2020  oth worlds!..   
+00061b30: 2020 2020 2020 2020 2073 715f 7661 7273           sq_vars
+00061b40: 203d 205b 7820 666f 7220 7820 696e 2078   = [x for x in x
+00061b50: 6e61 6d65 7320 6966 2027 5e32 2720 696e  names if '^2' in
+00061b60: 2078 5d20 2020 2023 2323 2073 715f 7661   x]    ### sq_va
+00061b70: 7273 2063 6f6e 7461 696e 206f 6e6c 7920  rs contain only 
+00061b80: 782d 7371 7561 7265 6420 7661 7269 6162  x-squared variab
+00061b90: 6c65 7320 7375 6368 2061 7320 2778 5e32  les such as 'x^2
+00061ba0: 270d 0a20 2020 2020 2020 2020 2020 2069  '..            i
+00061bb0: 6e74 786e 5f76 6172 7320 3d20 6c65 6674  ntxn_vars = left
+00061bc0: 5f73 7562 7472 6163 7428 786e 616d 6573  _subtract(xnames
+00061bd0: 2c20 7371 5f76 6172 732b 785f 7661 7273  , sq_vars+x_vars
+00061be0: 2920 2323 2320 696e 7478 6e5f 7661 7273  ) ### intxn_vars
+00061bf0: 2063 6f6e 7461 696e 2069 6e74 6572 6163   contain interac
+00061c00: 7469 6f6e 2076 6172 7320 7375 6368 2061  tion vars such a
+00061c10: 7320 2778 3120 7832 270d 0a20 2020 2020  s 'x1 x2'..     
+00061c20: 2020 2023 2323 2320 2049 7420 6973 206e     ####  It is n
+00061c30: 6f77 2074 696d 6520 746f 2063 7574 2064  ow time to cut d
+00061c40: 6f77 6e20 7468 6520 6f72 6967 696e 616c  own the original
+00061c50: 2078 5f76 6172 6961 626c 6573 2074 6f20   x_variables to 
+00061c60: 6a75 7374 2073 7175 6172 6564 2076 6172  just squared var
+00061c70: 6961 626c 6573 2061 6e64 206f 7269 6769  iables and origi
+00061c80: 6e61 6c73 2068 6572 6520 2323 2323 0d0a  nals here ####..
+00061c90: 2020 2020 2020 2020 6469 6374 5f76 6172          dict_var
+00061ca0: 7320 3d20 6469 6374 287a 6970 2870 7265  s = dict(zip(pre
+00061cb0: 6469 6374 6f72 732c 785f 7661 7273 2929  dictors,x_vars))
+00061cc0: 2023 2323 2074 6869 7320 6973 2061 2064   ### this is a d
+00061cd0: 6963 7469 6f6e 6172 7920 6d61 7070 696e  ictionary mappin
+00061ce0: 6720 6f72 6967 696e 616c 2076 6172 6961  g original varia
+00061cf0: 626c 6573 2061 6e64 2074 6865 6972 2078  bles and their x
+00061d00: 2d76 6172 6961 626c 6573 0d0a 2020 2020  -variables..    
+00061d10: 2020 2020 7265 7665 7273 655f 6469 6374      reverse_dict
+00061d20: 5f76 6172 7320 3d20 6469 6374 285b 2879  _vars = dict([(y
+00061d30: 2c78 2920 666f 7220 2878 2c79 2920 696e  ,x) for (x,y) in
+00061d40: 2064 6963 745f 7661 7273 2e69 7465 6d73   dict_vars.items
+00061d50: 2829 5d29 2023 2323 2074 6869 7320 6d61  ()]) ### this ma
+00061d60: 7073 2074 6865 2078 2d76 6172 7320 746f  ps the x-vars to
+00061d70: 206f 7269 6769 6e61 6c20 7661 7273 0d0a   original vars..
+00061d80: 2020 2020 2020 2020 2323 2323 2320 4e6f          ##### No
+00061d90: 7720 6c65 7427 7320 636f 6e76 6572 7420  w let's convert 
+00061da0: 496e 7465 7261 6374 696f 6e20 785f 7661  Interaction x_va
+00061db0: 7269 6162 6c65 7320 696e 746f 2074 6865  riables into the
+00061dc0: 6972 2063 6f72 7265 7370 6f6e 6469 6e67  ir corresponding
+00061dd0: 2074 6578 7420 7661 7269 6162 6c65 730d   text variables.
+00061de0: 0a20 2020 2020 2020 2069 6e74 786e 5f74  .        intxn_t
+00061df0: 6578 745f 7661 7273 203d 205b 5d0d 0a20  ext_vars = [].. 
+00061e00: 2020 2020 2020 2066 6f72 2065 6163 685f         for each_
+00061e10: 6974 656d 2069 6e20 696e 7478 6e5f 7661  item in intxn_va
+00061e20: 7273 3a0d 0a20 2020 2020 2020 2020 2020  rs:..           
+00061e30: 2069 6620 6c65 6e28 6561 6368 5f69 7465   if len(each_ite
+00061e40: 6d2e 7370 6c69 7428 2220 2229 2920 3d3d  m.split(" ")) ==
+00061e50: 2031 3a0d 0a20 2020 2020 2020 2020 2020   1:..           
+00061e60: 2020 2020 2069 6e74 786e 5f74 6578 745f       intxn_text_
+00061e70: 7661 7273 2e61 7070 656e 6428 7265 7665  vars.append(reve
+00061e80: 7273 655f 6469 6374 5f76 6172 735b 6561  rse_dict_vars[ea
+00061e90: 6368 5f69 7465 6d5d 290d 0a20 2020 2020  ch_item])..     
+00061ea0: 2020 2020 2020 2020 2020 2066 6561 7475             featu
+00061eb0: 7265 5f78 7661 725f 6469 6374 5b65 6163  re_xvar_dict[eac
+00061ec0: 685f 6974 656d 5d20 3d20 7265 7665 7273  h_item] = revers
+00061ed0: 655f 6469 6374 5f76 6172 735b 6561 6368  e_dict_vars[each
+00061ee0: 5f69 7465 6d5d 0d0a 2020 2020 2020 2020  _item]..        
+00061ef0: 2020 2020 656c 6966 206c 656e 2865 6163      elif len(eac
+00061f00: 685f 6974 656d 2e73 706c 6974 2822 2022  h_item.split(" "
+00061f10: 2929 203d 3d20 323a 0d0a 2020 2020 2020  )) == 2:..      
+00061f20: 2020 2020 2020 2020 2020 7477 6f5f 6974            two_it
+00061f30: 656d 735f 6c69 7374 203d 2065 6163 685f  ems_list = each_
+00061f40: 6974 656d 2e73 706c 6974 2822 2022 290d  item.split(" ").
+00061f50: 0a20 2020 2020 2020 2020 2020 2020 2020  .               
+00061f60: 2066 756c 6c5f 696e 7478 6e5f 6e61 6d65   full_intxn_name
+00061f70: 203d 2072 6576 6572 7365 5f64 6963 745f   = reverse_dict_
+00061f80: 7661 7273 5b74 776f 5f69 7465 6d73 5f6c  vars[two_items_l
+00061f90: 6973 745b 305d 5d20 2b22 2022 2b20 7265  ist[0]] +" "+ re
+00061fa0: 7665 7273 655f 6469 6374 5f76 6172 735b  verse_dict_vars[
+00061fb0: 7477 6f5f 6974 656d 735f 6c69 7374 5b31  two_items_list[1
+00061fc0: 5d5d 0d0a 2020 2020 2020 2020 2020 2020  ]]..            
+00061fd0: 2020 2020 696e 7478 6e5f 7465 7874 5f76      intxn_text_v
+00061fe0: 6172 732e 6170 7065 6e64 2866 756c 6c5f  ars.append(full_
+00061ff0: 696e 7478 6e5f 6e61 6d65 290d 0a20 2020  intxn_name)..   
+00062000: 2020 2020 2020 2020 2020 2020 2066 6561               fea
+00062010: 7475 7265 5f78 7661 725f 6469 6374 5b65  ture_xvar_dict[e
+00062020: 6163 685f 6974 656d 5d20 3d20 6675 6c6c  ach_item] = full
+00062030: 5f69 6e74 786e 5f6e 616d 650d 0a20 2020  _intxn_name..   
+00062040: 2020 2020 2020 2020 2065 6c73 653a 0d0a           else:..
+00062050: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00062060: 7061 7373 0d0a 2020 2020 2020 2020 2323  pass..        ##
+00062070: 2323 2320 4e6f 7720 6c65 7427 7320 636f  ### Now let's co
+00062080: 6e76 6572 7420 5371 7561 7265 6420 785f  nvert Squared x_
+00062090: 7661 7269 6162 6c65 7320 696e 746f 2074  variables into t
+000620a0: 6865 6972 2063 6f72 7265 7370 6f6e 6469  heir correspondi
+000620b0: 6e67 2074 6578 7420 7661 7269 6162 6c65  ng text variable
+000620c0: 730d 0a20 2020 2020 2020 2073 715f 7465  s..        sq_te
+000620d0: 7874 5f76 6172 7320 3d20 5b5d 0d0a 2020  xt_vars = []..  
+000620e0: 2020 2020 2020 666f 7220 6561 6368 5f73        for each_s
+000620f0: 715f 6974 656d 2069 6e20 7371 5f76 6172  q_item in sq_var
+00062100: 733a 0d0a 2020 2020 2020 2020 2020 2020  s:..            
+00062110: 6966 206c 656e 2865 6163 685f 7371 5f69  if len(each_sq_i
+00062120: 7465 6d2e 7370 6c69 7428 225e 2229 2920  tem.split("^")) 
+00062130: 3d3d 2032 3a0d 0a20 2020 2020 2020 2020  == 2:..         
+00062140: 2020 2020 2020 2074 776f 5f69 7465 6d5f         two_item_
+00062150: 6c69 7374 203d 2065 6163 685f 7371 5f69  list = each_sq_i
+00062160: 7465 6d2e 7370 6c69 7428 225e 2229 0d0a  tem.split("^")..
+00062170: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00062180: 6675 6c6c 5f73 715f 6e61 6d65 203d 2072  full_sq_name = r
+00062190: 6576 6572 7365 5f64 6963 745f 7661 7273  everse_dict_vars
+000621a0: 5b74 776f 5f69 7465 6d5f 6c69 7374 5b30  [two_item_list[0
+000621b0: 5d5d 202b 225e 3222 0d0a 2020 2020 2020  ]] +"^2"..      
+000621c0: 2020 2020 2020 2020 2020 7371 5f74 6578            sq_tex
+000621d0: 745f 7661 7273 2e61 7070 656e 6428 6675  t_vars.append(fu
+000621e0: 6c6c 5f73 715f 6e61 6d65 290d 0a20 2020  ll_sq_name)..   
+000621f0: 2020 2020 2020 2020 2020 2020 2066 6561               fea
+00062200: 7475 7265 5f78 7661 725f 6469 6374 5b65  ture_xvar_dict[e
+00062210: 6163 685f 7371 5f69 7465 6d5d 203d 2066  ach_sq_item] = f
+00062220: 756c 6c5f 7371 5f6e 616d 650d 0a20 2020  ull_sq_name..   
+00062230: 2020 2020 2020 2020 2065 6c73 653a 0d0a           else:..
+00062240: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00062250: 7061 7373 0d0a 2020 2020 2020 2020 2323  pass..        ##
+00062260: 2323 204e 6f77 2077 6520 6e65 6564 2074  ## Now we need t
+00062270: 6f20 636f 6d62 696e 6520 7468 6520 785f  o combine the x_
+00062280: 7661 7273 2c20 5371 7561 7265 645f 7661  vars, Squared_va
+00062290: 7273 2061 6e64 2074 6865 2049 6e74 786e  rs and the Intxn
+000622a0: 5f76 6172 7320 746f 6765 7468 6572 2061  _vars together a
+000622b0: 7320 5465 7874 2076 6172 7320 696e 206f  s Text vars in o
+000622c0: 6e65 2076 6172 6961 626c 650d 0a20 2020  ne variable..   
+000622d0: 2020 2020 2066 756c 6c5f 785f 7661 7273       full_x_vars
+000622e0: 203d 2078 5f76 6172 7320 2b20 7371 5f76   = x_vars + sq_v
+000622f0: 6172 7320 2b20 696e 7478 6e5f 7661 7273  ars + intxn_vars
+00062300: 0d0a 2020 2020 2020 2020 7465 7874 5f76  ..        text_v
+00062310: 6172 7320 3d20 7072 6564 6963 746f 7273  ars = predictors
+00062320: 202b 2073 715f 7465 7874 5f76 6172 7320   + sq_text_vars 
+00062330: 2b20 696e 7478 6e5f 7465 7874 5f76 6172  + intxn_text_var
+00062340: 7320 2323 2323 2074 6578 745f 7661 7273  s #### text_vars
+00062350: 206e 6f77 2063 6f6e 7461 696e 7320 616c   now contains al
+00062360: 6c20 7468 6520 7465 7874 2076 6572 7369  l the text versi
+00062370: 6f6e 206f 6620 782d 7661 7269 6162 6c65  on of x-variable
+00062380: 730d 0a20 2020 2020 2020 2069 6620 6c65  s..        if le
+00062390: 6e28 7465 7874 5f76 6172 7329 203d 3d20  n(text_vars) == 
+000623a0: 6c65 6e28 6675 6c6c 5f78 5f76 6172 7329  len(full_x_vars)
 000623b0: 3a0d 0a20 2020 2020 2020 2020 2020 2070  :..            p
-000623c0: 7269 6e74 2827 4572 726f 723a 2054 6865  rint('Error: The
-000623d0: 7265 2061 7265 206e 6f20 7371 7561 7265  re are no square
-000623e0: 6420 6f72 2069 6e74 6572 6163 7469 6f6e  d or interaction
-000623f0: 2076 6172 7320 746f 2061 6464 2e20 436f   vars to add. Co
-00062400: 6e74 696e 7569 6e67 2077 6974 686f 7574  ntinuing without
-00062410: 2050 6f6c 7920 7661 7273 2e2e 2e27 290d   Poly vars...').
-00062420: 0a20 2020 2020 2020 2020 2020 2072 6574  .            ret
-00062430: 7572 6e20 7072 6564 6963 746f 7273 2c20  urn predictors, 
-00062440: 6c6d 2c20 5850 312c 206d 642c 2078 5f76  lm, XP1, md, x_v
-00062450: 6172 732c 6665 6174 7572 655f 7876 6172  ars,feature_xvar
-00062460: 5f64 6963 740d 0a20 2020 2020 2020 2023  _dict..        #
-00062470: 2323 2320 2057 6520 6465 6669 6e65 2032  ###  We define 2
-00062480: 2064 6174 6120 6672 616d 6573 3a20 6f6e   data frames: on
-00062490: 6520 666f 7220 7265 6d6f 7669 6e67 2068  e for removing h
-000624a0: 6967 686c 7920 636f 7272 656c 6174 6564  ighly correlated
-000624b0: 2076 6172 7320 616e 6420 6f74 6865 7220   vars and other 
-000624c0: 666f 7220 4c61 7373 6f20 7365 6c65 6374  for Lasso select
-000624d0: 696f 6e0d 0a20 2020 2020 2020 2058 5032  ion..        XP2
-000624e0: 203d 2058 5031 5b6e 6577 5f61 6464 785f   = XP1[new_addx_
-000624f0: 7661 7273 5d2e 6a6f 696e 2859 290d 0a20  vars].join(Y).. 
-00062500: 2020 2020 2020 2058 5031 5820 3d20 5850         XP1X = XP
-00062510: 315b 6e65 775f 6164 6478 5f76 6172 735d  1[new_addx_vars]
-00062520: 0d0a 2020 2020 2020 2020 6e65 775f 6164  ..        new_ad
-00062530: 6474 6578 745f 7661 7273 203d 205b 6665  dtext_vars = [fe
-00062540: 6174 7572 655f 7876 6172 5f64 6963 745b  ature_xvar_dict[
-00062550: 785d 2066 6f72 2078 2069 6e20 6e65 775f  x] for x in new_
-00062560: 6164 6478 5f76 6172 735d 0d0a 2020 2020  addx_vars]..    
-00062570: 2020 2020 5850 322e 636f 6c75 6d6e 7320      XP2.columns 
-00062580: 3d20 6e65 775f 6164 6474 6578 745f 7661  = new_addtext_va
-00062590: 7273 2b5b 7461 7267 6574 7661 725d 0d0a  rs+[targetvar]..
-000625a0: 2020 2020 2020 2020 5850 3158 2e63 6f6c          XP1X.col
-000625b0: 756d 6e73 203d 206e 6577 5f61 6464 7465  umns = new_addte
-000625c0: 7874 5f76 6172 730d 0a20 2020 2020 2020  xt_vars..       
-000625d0: 2023 2323 2323 2323 2323 2323 2323 2323   ###############
-000625e0: 2323 2323 2323 2323 2323 2323 2323 2323  ################
-000625f0: 2323 2323 2323 2323 2323 2323 2323 2323  ################
-00062600: 2323 2323 2323 2323 2323 2323 2323 2323  ################
-00062610: 2323 2323 2323 2323 2323 2323 2323 2323  ################
-00062620: 2323 2323 0d0a 2020 2020 2020 2020 2323  ####..        ##
-00062630: 2323 2020 2020 4641 5354 2046 4541 5455  ##    FAST FEATU
-00062640: 5245 2052 4544 5543 5449 4f4e 2055 5349  RE REDUCTION USI
-00062650: 4e47 204c 3120 5245 4755 4c41 5249 5a41  NG L1 REGULARIZA
-00062660: 5449 4f4e 2046 4f52 204c 4152 4745 2044  TION FOR LARGE D
-00062670: 4154 4120 5345 5453 2020 2023 2323 2323  ATA SETS   #####
-00062680: 230d 0a20 2020 2020 2020 2023 2323 2320  #..        #### 
-00062690: 2020 5573 6520 4c61 7373 6f43 5620 6f72    Use LassoCV or
-000626a0: 204c 6f67 6973 7469 6352 6567 7265 7373   LogisticRegress
-000626b0: 696f 6e43 5620 746f 2052 6564 7563 6520  ionCV to Reduce 
-000626c0: 5661 7269 6162 6c65 7320 7573 696e 6720  Variables using 
-000626d0: 5265 6775 6c61 7269 7a61 7469 6f6e 0d0a  Regularization..
-000626e0: 2020 2020 2020 2020 2323 2323 2323 2323          ########
-000626f0: 2323 2323 2323 2323 2323 2323 2323 2323  ################
-00062700: 2323 2323 2323 2323 2323 2323 2323 2323  ################
-00062710: 2323 2323 2323 2323 2323 2323 2323 2323  ################
-00062720: 2323 2323 2323 2323 2323 2323 2323 2323  ################
-00062730: 2323 2323 2323 2323 2323 230d 0a20 2020  ###########..   
-00062740: 2020 2020 2070 7269 6e74 2827 4275 696c       print('Buil
-00062750: 6469 6e67 2043 6f6d 7061 7269 736f 6e20  ding Comparison 
-00062760: 4d6f 6465 6c20 7769 7468 206f 6e6c 7920  Model with only 
-00062770: 506f 6c79 2061 6e64 2049 6e74 6572 6163  Poly and Interac
-00062780: 7469 6f6e 2076 6172 6961 626c 6573 2e2e  tion variables..
-00062790: 2e27 290d 0a20 2020 2020 2020 206c 6d5f  .')..        lm_
-000627a0: 702c 205f 203d 2070 7269 6e74 5f6d 6f64  p, _ = print_mod
-000627b0: 656c 5f6d 6574 7269 6373 286d 6f64 656c  el_metrics(model
-000627c0: 7479 7065 2c6c 6d2c 5850 3158 2c59 2c54  type,lm,XP1X,Y,T
-000627d0: 7275 6529 0d0a 2020 2020 2020 2020 7072  rue)..        pr
-000627e0: 696e 7428 2720 2020 2054 696d 6520 5461  int('    Time Ta
-000627f0: 6b65 6e3a 2025 302e 3066 2028 696e 2073  ken: %0.0f (in s
-00062800: 6563 6f6e 6473 2927 2025 2874 696d 652e  econds)' %(time.
-00062810: 7469 6d65 2829 2d73 7461 7274 5f74 696d  time()-start_tim
-00062820: 6529 290d 0a20 2020 2020 2020 2023 2323  e))..        ###
-00062830: 2320 2057 6520 6e65 6564 2074 6f20 6275  #  We need to bu
-00062840: 696c 6420 6120 6461 7461 6672 616d 6520  ild a dataframe 
-00062850: 746f 2068 6f6c 6420 636f 6566 6669 6369  to hold coeffici
-00062860: 656e 7473 2066 726f 6d20 7468 6520 6d6f  ents from the mo
-00062870: 6465 6c20 666f 7220 6561 6368 2076 6172  del for each var
-00062880: 6961 626c 6520 2323 230d 0a20 2020 2020  iable ###..     
-00062890: 2020 2064 6678 203d 2070 642e 4461 7461     dfx = pd.Data
-000628a0: 4672 616d 6528 5b6e 6577 5f61 6464 785f  Frame([new_addx_
-000628b0: 7661 7273 2c20 6e65 775f 6164 6474 6578  vars, new_addtex
-000628c0: 745f 7661 7273 5d29 0d0a 2020 2020 2020  t_vars])..      
-000628d0: 2020 6466 203d 2064 6678 2e54 0d0a 2020    df = dfx.T..  
-000628e0: 2020 2020 2020 6466 2e63 6f6c 756d 6e73        df.columns
-000628f0: 3d5b 2758 204e 616d 6573 272c 2749 6e74  =['X Names','Int
-00062900: 6572 6163 7469 6f6e 2056 6172 6961 626c  eraction Variabl
-00062910: 6520 4e61 6d65 7327 5d0d 0a20 2020 2020  e Names']..     
-00062920: 2020 2023 2323 2323 2323 2323 2320 204e     ##########  N
-00062930: 204f 2057 2020 2042 2055 2049 204c 2044   O W   B U I L D
-00062940: 2020 5420 4820 4520 204d 204f 2044 2045    T H E  M O D E
-00062950: 204c 2023 2323 2323 2323 2323 2323 2323   L #############
+000623c0: 7269 6e74 2827 5375 6363 6573 7366 756c  rint('Successful
+000623d0: 6c79 2074 7261 6e73 666f 726d 6564 2078  ly transformed x
+000623e0: 2d76 6172 6961 626c 6573 2069 6e74 6f20  -variables into 
+000623f0: 7465 7874 2d76 6172 6961 626c 6573 2061  text-variables a
+00062400: 6674 6572 2050 6f6c 796e 6f6d 6961 6c20  fter Polynomial 
+00062410: 7472 616e 7366 6f72 6d61 7469 6f6e 7327  transformations'
+00062420: 290d 0a20 2020 2020 2020 2065 6c73 653a  )..        else:
+00062430: 0d0a 2020 2020 2020 2020 2020 2020 7072  ..            pr
+00062440: 696e 7428 2745 7272 6f72 3a20 4e6f 7420  int('Error: Not 
+00062450: 6162 6c65 2074 6f20 7472 616e 7366 6f72  able to transfor
+00062460: 6d20 782d 7661 7269 6162 6c65 7320 696e  m x-variables in
+00062470: 746f 2074 6578 742d 7661 7269 6162 6c65  to text-variable
+00062480: 732e 2043 6f6e 7469 6e75 696e 6720 7769  s. Continuing wi
+00062490: 7468 6f75 7420 506f 6c79 2076 6172 732e  thout Poly vars.
+000624a0: 2e2e 2729 0d0a 2020 2020 2020 2020 2020  ..')..          
+000624b0: 2020 7265 7475 726e 2070 7265 6469 6374    return predict
+000624c0: 6f72 732c 206c 6d2c 2058 5031 2c20 6d64  ors, lm, XP1, md
+000624d0: 2c20 785f 7661 7273 2c66 6561 7475 7265  , x_vars,feature
+000624e0: 5f78 7661 725f 6469 6374 0d0a 2020 2020  _xvar_dict..    
+000624f0: 2020 2020 6665 6174 7572 655f 7465 7874      feature_text
+00062500: 7661 725f 6469 6374 2020 3d20 6469 6374  var_dict  = dict
+00062510: 285b 2879 2c78 2920 666f 7220 2878 2c79  ([(y,x) for (x,y
+00062520: 2920 696e 2066 6561 7475 7265 5f78 7661  ) in feature_xva
+00062530: 725f 6469 6374 2e69 7465 6d73 2829 5d29  r_dict.items()])
+00062540: 0d0a 2020 2020 2020 2020 2323 2323 204e  ..        #### N
+00062550: 6f77 2042 7569 6c64 2061 2044 6174 6120  ow Build a Data 
+00062560: 4672 616d 6520 636f 6e74 6169 6e69 6e67  Frame containing
+00062570: 2063 6f6e 7461 696e 696e 6720 6164 6469   containing addi
+00062580: 7469 6f6e 616c 2050 6f6c 7920 616e 6420  tional Poly and 
+00062590: 496e 7478 6e20 7661 7269 6162 6c65 7320  Intxn variables 
+000625a0: 696e 2078 2d66 6f72 6d61 7420 6865 7265  in x-format here
+000625b0: 2023 2323 230d 0a20 2020 2020 2020 206e   ####..        n
+000625c0: 6577 5f61 6464 785f 7661 7273 203d 2073  ew_addx_vars = s
+000625d0: 715f 7661 7273 2b69 6e74 786e 5f76 6172  q_vars+intxn_var
+000625e0: 730d 0a20 2020 2020 2020 2069 6620 6c65  s..        if le
+000625f0: 6e28 6e65 775f 6164 6478 5f76 6172 7329  n(new_addx_vars)
+00062600: 203d 3d20 303a 0d0a 2020 2020 2020 2020   == 0:..        
+00062610: 2020 2020 7072 696e 7428 2745 7272 6f72      print('Error
+00062620: 3a20 5468 6572 6520 6172 6520 6e6f 2073  : There are no s
+00062630: 7175 6172 6564 206f 7220 696e 7465 7261  quared or intera
+00062640: 6374 696f 6e20 7661 7273 2074 6f20 6164  ction vars to ad
+00062650: 642e 2043 6f6e 7469 6e75 696e 6720 7769  d. Continuing wi
+00062660: 7468 6f75 7420 506f 6c79 2076 6172 732e  thout Poly vars.
+00062670: 2e2e 2729 0d0a 2020 2020 2020 2020 2020  ..')..          
+00062680: 2020 7265 7475 726e 2070 7265 6469 6374    return predict
+00062690: 6f72 732c 206c 6d2c 2058 5031 2c20 6d64  ors, lm, XP1, md
+000626a0: 2c20 785f 7661 7273 2c66 6561 7475 7265  , x_vars,feature
+000626b0: 5f78 7661 725f 6469 6374 0d0a 2020 2020  _xvar_dict..    
+000626c0: 2020 2020 2323 2323 2020 5765 2064 6566      ####  We def
+000626d0: 696e 6520 3220 6461 7461 2066 7261 6d65  ine 2 data frame
+000626e0: 733a 206f 6e65 2066 6f72 2072 656d 6f76  s: one for remov
+000626f0: 696e 6720 6869 6768 6c79 2063 6f72 7265  ing highly corre
+00062700: 6c61 7465 6420 7661 7273 2061 6e64 206f  lated vars and o
+00062710: 7468 6572 2066 6f72 204c 6173 736f 2073  ther for Lasso s
+00062720: 656c 6563 7469 6f6e 0d0a 2020 2020 2020  election..      
+00062730: 2020 5850 3220 3d20 5850 315b 6e65 775f    XP2 = XP1[new_
+00062740: 6164 6478 5f76 6172 735d 2e6a 6f69 6e28  addx_vars].join(
+00062750: 5929 0d0a 2020 2020 2020 2020 5850 3158  Y)..        XP1X
+00062760: 203d 2058 5031 5b6e 6577 5f61 6464 785f   = XP1[new_addx_
+00062770: 7661 7273 5d0d 0a20 2020 2020 2020 206e  vars]..        n
+00062780: 6577 5f61 6464 7465 7874 5f76 6172 7320  ew_addtext_vars 
+00062790: 3d20 5b66 6561 7475 7265 5f78 7661 725f  = [feature_xvar_
+000627a0: 6469 6374 5b78 5d20 666f 7220 7820 696e  dict[x] for x in
+000627b0: 206e 6577 5f61 6464 785f 7661 7273 5d0d   new_addx_vars].
+000627c0: 0a20 2020 2020 2020 2058 5032 2e63 6f6c  .        XP2.col
+000627d0: 756d 6e73 203d 206e 6577 5f61 6464 7465  umns = new_addte
+000627e0: 7874 5f76 6172 732b 5b74 6172 6765 7476  xt_vars+[targetv
+000627f0: 6172 5d0d 0a20 2020 2020 2020 2058 5031  ar]..        XP1
+00062800: 582e 636f 6c75 6d6e 7320 3d20 6e65 775f  X.columns = new_
+00062810: 6164 6474 6578 745f 7661 7273 0d0a 2020  addtext_vars..  
+00062820: 2020 2020 2020 2323 2323 2323 2323 2323        ##########
+00062830: 2323 2323 2323 2323 2323 2323 2323 2323  ################
+00062840: 2323 2323 2323 2323 2323 2323 2323 2323  ################
+00062850: 2323 2323 2323 2323 2323 2323 2323 2323  ################
+00062860: 2323 2323 2323 2323 2323 2323 2323 2323  ################
+00062870: 2323 2323 2323 2323 230d 0a20 2020 2020  #########..     
+00062880: 2020 2023 2323 2320 2020 2046 4153 5420     ####    FAST 
+00062890: 4645 4154 5552 4520 5245 4455 4354 494f  FEATURE REDUCTIO
+000628a0: 4e20 5553 494e 4720 4c31 2052 4547 554c  N USING L1 REGUL
+000628b0: 4152 495a 4154 494f 4e20 464f 5220 4c41  ARIZATION FOR LA
+000628c0: 5247 4520 4441 5441 2053 4554 5320 2020  RGE DATA SETS   
+000628d0: 2323 2323 2323 0d0a 2020 2020 2020 2020  ######..        
+000628e0: 2323 2323 2020 2055 7365 204c 6173 736f  ####   Use Lasso
+000628f0: 4356 206f 7220 4c6f 6769 7374 6963 5265  CV or LogisticRe
+00062900: 6772 6573 7369 6f6e 4356 2074 6f20 5265  gressionCV to Re
+00062910: 6475 6365 2056 6172 6961 626c 6573 2075  duce Variables u
+00062920: 7369 6e67 2052 6567 756c 6172 697a 6174  sing Regularizat
+00062930: 696f 6e0d 0a20 2020 2020 2020 2023 2323  ion..        ###
+00062940: 2323 2323 2323 2323 2323 2323 2323 2323  ################
+00062950: 2323 2323 2323 2323 2323 2323 2323 2323  ################
 00062960: 2323 2323 2323 2323 2323 2323 2323 2323  ################
-00062970: 2323 2323 230d 0a20 2020 2020 2020 2069  #####..        i
-00062980: 6620 6d6f 6465 6c74 7970 6520 3d3d 2027  f modeltype == '
-00062990: 5265 6772 6573 7369 6f6e 273a 0d0a 2020  Regression':..  
-000629a0: 2020 2020 2020 2020 2020 6466 5b27 436f            df['Co
-000629b0: 6566 6669 6369 656e 7420 5661 6c75 6573  efficient Values
-000629c0: 275d 203d 206c 6d5f 702e 636f 6566 5f0d  '] = lm_p.coef_.
-000629d0: 0a20 2020 2020 2020 2065 6c73 653a 0d0a  .        else:..
-000629e0: 2020 2020 2020 2020 2020 2020 6466 5b27              df['
-000629f0: 436f 6566 6669 6369 656e 7420 5661 6c75  Coefficient Valu
-00062a00: 6573 275d 203d 206c 6d5f 702e 636f 6566  es'] = lm_p.coef
-00062a10: 5f5b 305d 0d0a 2020 2020 2020 2020 2323  _[0]..        ##
-00062a20: 2323 2054 6869 7320 7061 7274 2073 656c  ## This part sel
-00062a30: 6563 7473 2074 6865 2074 6f70 2031 3025  ects the top 10%
-00062a40: 206f 6620 696e 7465 7261 6374 696f 6e20   of interaction 
-00062a50: 7661 7269 6162 6c65 7320 6372 6561 7465  variables create
-00062a60: 6420 7573 696e 6720 6c69 6e65 6172 206d  d using linear m
-00062a70: 6f64 656c 696e 672e 0d0a 2020 2020 2020  odeling...      
-00062a80: 2020 2323 2320 2020 4974 2069 7320 7665    ###   It is ve
-00062a90: 7279 2069 6d70 6f72 7461 6e74 2074 6f20  ry important to 
-00062aa0: 6c65 6176 6520 7468 6520 6e65 7874 206c  leave the next l
-00062ab0: 696e 6520 6173 2069 7320 7369 6e63 6520  ine as is since 
-00062ac0: 3e20 7379 6d62 6f6c 2069 7320 6265 7474  > symbol is bett
-00062ad0: 6572 2074 6861 6e20 3e3d 0d0a 2020 2020  er than >=..    
-00062ae0: 2020 2020 6c69 6d20 3d20 6162 7328 6466      lim = abs(df
-00062af0: 5b27 436f 6566 6669 6369 656e 7420 5661  ['Coefficient Va
-00062b00: 6c75 6573 275d 292e 7175 616e 7469 6c65  lues']).quantile
-00062b10: 2830 2e39 290d 0a20 2020 2020 2020 2064  (0.9)..        d
-00062b20: 6639 3020 3d20 6466 5b61 6273 2864 665b  f90 = df[abs(df[
-00062b30: 2743 6f65 6666 6963 6965 6e74 2056 616c  'Coefficient Val
-00062b40: 7565 7327 5d29 3e6c 696d 5d2e 736f 7274  ues'])>lim].sort
-00062b50: 5f76 616c 7565 7328 2743 6f65 6666 6963  _values('Coeffic
-00062b60: 6965 6e74 2056 616c 7565 7327 2c61 7363  ient Values',asc
-00062b70: 656e 6469 6e67 3d46 616c 7365 290d 0a20  ending=False).. 
-00062b80: 2020 2020 2020 2069 6620 6466 5b27 436f         if df['Co
-00062b90: 6566 6669 6369 656e 7420 5661 6c75 6573  efficient Values
-00062ba0: 275d 2e73 756d 2829 3d3d 302e 3020 6f72  '].sum()==0.0 or
-00062bb0: 2064 6639 305b 2743 6f65 6666 6963 6965   df90['Coefficie
-00062bc0: 6e74 2056 616c 7565 7327 5d2e 7375 6d28  nt Values'].sum(
-00062bd0: 293d 3d30 2e30 3a0d 0a20 2020 2020 2020  )==0.0:..       
-00062be0: 2020 2020 2023 2323 2054 6865 7265 2069       ### There i
-00062bf0: 7320 6e6f 2063 6f65 6666 6963 6965 6e74  s no coefficient
-00062c00: 2074 6861 7420 6973 2067 7265 6174 6572   that is greater
-00062c10: 2074 6861 6e20 3020 6865 7265 2e20 536f   than 0 here. So
-00062c20: 2072 656a 6563 7420 616c 6c20 7661 7269   reject all vari
-00062c30: 6162 6c65 7321 0d0a 2020 2020 2020 2020  ables!..        
-00062c40: 2020 2020 7365 6c5f 785f 7661 7273 203d      sel_x_vars =
-00062c50: 205b 5d0d 0a20 2020 2020 2020 2020 2020   []..           
-00062c60: 2070 7269 6e74 2827 5a65 726f 2049 6e74   print('Zero Int
-00062c70: 6572 6163 7469 6f6e 2061 6e64 2050 6f6c  eraction and Pol
-00062c80: 796e 6f6d 6961 6c20 7661 7269 6162 6c65  ynomial variable
-00062c90: 2873 2920 7365 6c65 6374 6564 2e2e 2e27  (s) selected...'
-00062ca0: 290d 0a20 2020 2020 2020 2065 6c69 6620  )..        elif 
-00062cb0: 6466 5b27 436f 6566 6669 6369 656e 7420  df['Coefficient 
-00062cc0: 5661 6c75 6573 275d 2e73 6861 7065 5b30  Values'].shape[0
-00062cd0: 5d20 3d3d 2064 6639 305b 2743 6f65 6666  ] == df90['Coeff
-00062ce0: 6963 6965 6e74 2056 616c 7565 7327 5d2e  icient Values'].
-00062cf0: 7368 6170 655b 305d 3a0d 0a20 2020 2020  shape[0]:..     
-00062d00: 2020 2020 2020 2023 2323 2054 6865 7265         ### There
-00062d10: 2069 7320 6e6f 2063 6f65 6666 6963 6965   is no coefficie
-00062d20: 6e74 2074 6861 7420 6973 2067 7265 6174  nt that is great
-00062d30: 6572 2074 6861 6e20 3020 6865 7265 2e20  er than 0 here. 
-00062d40: 536f 2072 656a 6563 7420 616c 6c20 7661  So reject all va
-00062d50: 7269 6162 6c65 7321 0d0a 2020 2020 2020  riables!..      
-00062d60: 2020 2020 2020 7365 6c5f 785f 7661 7273        sel_x_vars
-00062d70: 203d 205b 5d0d 0a20 2020 2020 2020 2020   = []..         
-00062d80: 2020 2070 7269 6e74 2827 5a65 726f 2049     print('Zero I
-00062d90: 6e74 6572 6163 7469 6f6e 2061 6e64 2050  nteraction and P
-00062da0: 6f6c 796e 6f6d 6961 6c20 7661 7269 6162  olynomial variab
-00062db0: 6c65 2873 2920 7365 6c65 6374 6564 2e2e  le(s) selected..
-00062dc0: 2e27 290d 0a20 2020 2020 2020 2065 6c73  .')..        els
-00062dd0: 653a 0d0a 2020 2020 2020 2020 2020 2020  e:..            
-00062de0: 2323 2323 2074 6865 7265 2069 7320 736f  #### there is so
-00062df0: 6d65 2063 6f65 6666 6963 6965 6e74 7320  me coefficients 
-00062e00: 6174 206c 6561 7374 2074 6861 7420 6172  at least that ar
-00062e10: 6520 6e6f 6e2d 7a65 726f 2061 6e64 2068  e non-zero and h
-00062e20: 656e 6365 2063 616e 2062 6520 7472 7573  ence can be trus
-00062e30: 7465 6421 0d0a 2020 2020 2020 2020 2020  ted!..          
-00062e40: 2020 6966 2076 6572 626f 7365 203e 3d20    if verbose >= 
-00062e50: 313a 0d0a 2020 2020 2020 2020 2020 2020  1:..            
-00062e60: 2020 2020 6466 3930 2e73 6f72 745f 7661      df90.sort_va
-00062e70: 6c75 6573 2827 436f 6566 6669 6369 656e  lues('Coefficien
-00062e80: 7420 5661 6c75 6573 272c 6173 6365 6e64  t Values',ascend
-00062e90: 696e 673d 4661 6c73 6529 5b3a 3130 5d2e  ing=False)[:10].
-00062ea0: 706c 6f74 280d 0a20 2020 2020 2020 2020  plot(..         
-00062eb0: 2020 2020 2020 2020 2020 206b 696e 643d             kind=
-00062ec0: 2762 6172 272c 783d 2749 6e74 6572 6163  'bar',x='Interac
-00062ed0: 7469 6f6e 2056 6172 6961 626c 6520 4e61  tion Variable Na
-00062ee0: 6d65 7327 2c79 3d27 436f 6566 6669 6369  mes',y='Coeffici
-00062ef0: 656e 7420 5661 6c75 6573 272c 0d0a 2020  ent Values',..  
-00062f00: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00062f10: 2020 7469 746c 653d 2754 6f70 2031 3025    title='Top 10%
-00062f20: 2056 6172 6961 626c 6520 496e 7465 7261   Variable Intera
-00062f30: 6374 696f 6e73 2061 6e64 2074 6865 6972  ctions and their
-00062f40: 2043 6f65 6666 6963 6965 6e74 7320 2729   Coefficients ')
-00062f50: 0d0a 2020 2020 2020 2020 2020 2020 656c  ..            el
-00062f60: 6966 2076 6572 626f 7365 203d 3d20 323a  if verbose == 2:
-00062f70: 0d0a 2020 2020 2020 2020 2020 2020 2020  ..              
-00062f80: 2020 6466 3930 2e73 6f72 745f 7661 6c75    df90.sort_valu
-00062f90: 6573 2827 436f 6566 6669 6369 656e 7420  es('Coefficient 
-00062fa0: 5661 6c75 6573 272c 6173 6365 6e64 696e  Values',ascendin
-00062fb0: 673d 4661 6c73 6529 2e70 6c6f 7428 0d0a  g=False).plot(..
-00062fc0: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00062fd0: 2020 2020 6b69 6e64 3d27 6261 7227 2c78      kind='bar',x
-00062fe0: 3d27 496e 7465 7261 6374 696f 6e20 5661  ='Interaction Va
-00062ff0: 7269 6162 6c65 204e 616d 6573 272c 793d  riable Names',y=
-00063000: 2743 6f65 6666 6963 6965 6e74 2056 616c  'Coefficient Val
-00063010: 7565 7327 2c0d 0a20 2020 2020 2020 2020  ues',..         
-00063020: 2020 2020 2020 2020 2020 2020 2020 2074                 t
-00063030: 6974 6c65 3d27 416c 6c20 5661 7269 6162  itle='All Variab
-00063040: 6c65 2049 6e74 6572 6163 7469 6f6e 7320  le Interactions 
-00063050: 616e 6420 7468 6569 7220 436f 6566 6669  and their Coeffi
-00063060: 6369 656e 7473 272c 6669 6773 697a 653d  cients',figsize=
-00063070: 2832 302c 3130 2929 0d0a 2020 2020 2020  (20,10))..      
-00063080: 2020 2020 2020 696e 7465 7261 6374 696f        interactio
-00063090: 6e73 203d 2064 6639 305b 2749 6e74 6572  ns = df90['Inter
-000630a0: 6163 7469 6f6e 2056 6172 6961 626c 6520  action Variable 
-000630b0: 4e61 6d65 7327 5d2e 7661 6c75 6573 2e74  Names'].values.t
-000630c0: 6f6c 6973 7428 290d 0a20 2020 2020 2020  olist()..       
-000630d0: 2020 2020 2073 656c 5f78 5f76 6172 7320       sel_x_vars 
-000630e0: 3d20 6466 3930 5b22 5820 4e61 6d65 7322  = df90["X Names"
-000630f0: 5d2e 7661 6c75 6573 2e74 6f6c 6973 7428  ].values.tolist(
-00063100: 290d 0a20 2020 2020 2020 2023 2323 2323  )..        #####
-00063110: 2323 204e 6f77 2077 6520 6861 7665 2074  ## Now we have t
-00063120: 6f20 7075 7420 7468 6520 6675 6c6c 2064  o put the full d
-00063130: 6174 6166 7261 6d65 2074 6f67 6574 6865  ataframe togethe
-00063140: 7220 7769 7468 2073 656c 6563 7465 6420  r with selected 
-00063150: 7661 7269 6162 6c65 7320 616e 6420 6f72  variables and or
-00063160: 6967 696e 616c 2070 7265 6469 6374 6f72  iginal predictor
-00063170: 7321 0d0a 2020 2020 2020 2020 2323 2323  s!..        ####
-00063180: 2044 4f20 4e4f 5420 4348 414e 4745 2054   DO NOT CHANGE T
-00063190: 4845 204e 4558 5420 4c49 4e45 2045 5645  HE NEXT LINE EVE
-000631a0: 4e20 5448 4f55 4748 2049 5420 4d49 4748  N THOUGH IT MIGH
-000631b0: 5420 4245 2054 454d 5054 494e 4720 544f  T BE TEMPTING TO
-000631c0: 2044 4f20 534f 2120 4974 2069 7320 636f   DO SO! It is co
-000631d0: 7272 6563 7421 0d0a 2020 2020 2020 2020  rrect!..        
-000631e0: 6669 6e61 6c5f 785f 7661 7273 203d 2078  final_x_vars = x
-000631f0: 5f76 6172 7320 2b20 7365 6c5f 785f 7661  _vars + sel_x_va
-00063200: 7273 0d0a 2020 2020 2020 2020 7365 6c5f  rs..        sel_
-00063210: 7465 7874 5f76 6172 7320 3d20 5b66 6561  text_vars = [fea
-00063220: 7475 7265 5f78 7661 725f 6469 6374 5b78  ture_xvar_dict[x
-00063230: 5d20 666f 7220 7820 696e 2073 656c 5f78  ] for x in sel_x
-00063240: 5f76 6172 735d 0d0a 2020 2020 2020 2020  _vars]..        
-00063250: 7072 696e 7428 2749 6e69 7469 616c 6c79  print('Initially
-00063260: 2061 6464 696e 6720 2564 2076 6172 6961   adding %d varia
-00063270: 626c 6528 7329 2064 7565 2074 6f20 4164  ble(s) due to Ad
-00063280: 645f 506f 6c79 203d 2025 7320 7365 7474  d_Poly = %s sett
-00063290: 696e 6727 2025 286c 656e 2873 656c 5f74  ing' %(len(sel_t
-000632a0: 6578 745f 7661 7273 292c 4164 645f 506f  ext_vars),Add_Po
-000632b0: 6c79 2929 0d0a 2020 2020 2020 2020 6966  ly))..        if
-000632c0: 2076 6572 626f 7365 203e 2031 3a0d 0a20   verbose > 1:.. 
-000632d0: 2020 2020 2020 2020 2020 2069 6620 6c65             if le
-000632e0: 6e28 7365 6c5f 7465 7874 5f76 6172 7329  n(sel_text_vars)
-000632f0: 203c 3d20 3330 3a0d 0a20 2020 2020 2020   <= 30:..       
-00063300: 2020 2020 2020 2020 2070 7269 6e74 2827           print('
-00063310: 2020 2020 4164 6465 6420 7661 7269 6162      Added variab
-00063320: 6c65 733a 2025 7327 2025 7365 6c5f 7465  les: %s' %sel_te
-00063330: 7874 5f76 6172 7329 0d0a 2020 2020 2020  xt_vars)..      
-00063340: 2020 6669 6e61 6c5f 7465 7874 5f76 6172    final_text_var
-00063350: 7320 3d20 5b66 6561 7475 7265 5f78 7661  s = [feature_xva
-00063360: 725f 6469 6374 5b78 5d20 666f 7220 7820  r_dict[x] for x 
-00063370: 696e 2066 696e 616c 5f78 5f76 6172 735d  in final_x_vars]
-00063380: 0d0a 2020 2020 2020 2020 2323 2323 2323  ..        ######
-00063390: 2323 2323 2323 2323 2323 2323 2323 2323  ################
-000633a0: 2323 2323 2323 2323 2323 2323 2323 2323  ################
-000633b0: 2323 2323 2323 2323 2323 2323 2323 2323  ################
-000633c0: 2323 2323 2323 2323 2323 2323 2323 2323  ################
-000633d0: 2323 2323 2323 2323 2323 2323 2323 2323  ################
-000633e0: 2323 2323 0d0a 2020 2020 2020 2020 6669  ####..        fi
-000633f0: 6e61 6c5f 6466 203d 206d 642e 7472 616e  nal_df = md.tran
-00063400: 7366 6f72 6d28 6461 7461 5b70 7265 6469  sform(data[predi
-00063410: 6374 6f72 735d 290d 0a20 2020 2020 2020  ctors])..       
-00063420: 2078 6e61 6d65 7320 3d20 6d64 2e67 6574   xnames = md.get
-00063430: 5f66 6561 7475 7265 5f6e 616d 6573 2829  _feature_names()
-00063440: 0d0a 2020 2020 2020 2020 6669 6e61 6c5f  ..        final_
-00063450: 6466 203d 2070 642e 4461 7461 4672 616d  df = pd.DataFram
-00063460: 6528 6669 6e61 6c5f 6466 2c69 6e64 6578  e(final_df,index
-00063470: 3d6f 7269 675f 6461 7461 5f69 6e64 6578  =orig_data_index
-00063480: 2c20 636f 6c75 6d6e 733d 786e 616d 6573  , columns=xnames
-00063490: 290d 0a20 2020 2020 2020 2066 696e 616c  )..        final
-000634a0: 5f64 6620 3d20 6669 6e61 6c5f 6466 5b66  _df = final_df[f
-000634b0: 696e 616c 5f78 5f76 6172 735d 0d0a 2020  inal_x_vars]..  
-000634c0: 2020 2020 2020 6669 6e61 6c5f 6466 2e63        final_df.c
-000634d0: 6f6c 756d 6e73 203d 2066 696e 616c 5f74  olumns = final_t
-000634e0: 6578 745f 7661 7273 0d0a 2020 2020 2020  ext_vars..      
-000634f0: 2020 636f 7079 5f70 7265 6473 203d 2063    copy_preds = c
-00063500: 6f70 792e 6465 6570 636f 7079 2870 7265  opy.deepcopy(pre
-00063510: 6469 6374 6f72 7329 0d0a 2020 2020 2020  dictors)..      
-00063520: 2020 2323 2323 2323 2320 4966 2074 6865    ####### If the
-00063530: 206f 7269 6769 6e61 6c20 636f 6c75 6d6e   original column
-00063540: 2773 2064 7479 7065 2077 6173 2069 6e74  's dtype was int
-00063550: 6567 6572 2c20 7075 7420 6974 2062 6163  eger, put it bac
-00063560: 6b20 6173 2069 6e74 6567 6572 2023 2323  k as integer ###
-00063570: 0d0a 2020 2020 2020 2020 666f 7220 6561  ..        for ea
-00063580: 6368 5f70 7265 6420 696e 2063 6f70 795f  ch_pred in copy_
-00063590: 7072 6564 733a 0d0a 2020 2020 2020 2020  preds:..        
-000635a0: 2020 2020 6966 2064 6174 615b 6561 6368      if data[each
-000635b0: 5f70 7265 645d 2e64 7479 7065 203d 3d20  _pred].dtype == 
-000635c0: 696e 743a 0d0a 2020 2020 2020 2020 2020  int:..          
-000635d0: 2020 2020 2020 6669 6e61 6c5f 6466 5b65        final_df[e
-000635e0: 6163 685f 7072 6564 5d20 3d20 6669 6e61  ach_pred] = fina
-000635f0: 6c5f 6466 5b65 6163 685f 7072 6564 5d2e  l_df[each_pred].
-00063600: 6173 7479 7065 2869 6e74 290d 0a20 2020  astype(int)..   
-00063610: 2020 2020 2066 696e 616c 5f64 665b 7461       final_df[ta
-00063620: 7267 6574 7661 725d 203d 2064 6174 615b  rgetvar] = data[
-00063630: 7461 7267 6574 7661 725d 2e76 616c 7565  targetvar].value
-00063640: 730d 0a20 2020 2020 2020 2023 2323 2323  s..        #####
-00063650: 2323 2323 2323 2323 2323 2323 2323 2323  ################
-00063660: 2323 2323 2323 2323 2323 2323 2323 2323  ################
-00063670: 2323 2323 2323 2323 2323 2323 2323 2323  ################
-00063680: 0d0a 2020 2020 2020 2020 7265 7475 726e  ..        return
-00063690: 2066 696e 616c 5f74 6578 745f 7661 7273   final_text_vars
-000636a0: 2c20 6c6d 5f70 2c20 6669 6e61 6c5f 6466  , lm_p, final_df
-000636b0: 2c20 6d64 2c20 6669 6e61 6c5f 785f 7661  , md, final_x_va
-000636c0: 7273 2c66 6561 7475 7265 5f78 7661 725f  rs,feature_xvar_
-000636d0: 6469 6374 0d0a 2020 2020 656c 7365 3a0d  dict..    else:.
-000636e0: 0a20 2020 2020 2020 2023 2323 2320 4a75  .        #### Ju
-000636f0: 7374 2072 6574 7572 6e20 7468 6520 7472  st return the tr
-00063700: 616e 7366 6f72 6d65 6420 6461 7461 6672  ansformed datafr
-00063710: 616d 6520 7769 7468 2061 6c6c 206f 7269  ame with all ori
-00063720: 672b 706f 6c79 2b69 6e74 786e 2076 6172  g+poly+intxn var
-00063730: 730d 0a20 2020 2020 2020 2066 696e 616c  s..        final
-00063740: 5f64 6620 3d20 6d64 2e74 7261 6e73 666f  _df = md.transfo
-00063750: 726d 2864 6174 615b 7072 6564 6963 746f  rm(data[predicto
-00063760: 7273 5d29 0d0a 2020 2020 2020 2020 786e  rs])..        xn
-00063770: 616d 6573 203d 206d 642e 6765 745f 6665  ames = md.get_fe
-00063780: 6174 7572 655f 6e61 6d65 7328 290d 0a20  ature_names().. 
-00063790: 2020 2020 2020 2066 696e 616c 5f64 6620         final_df 
-000637a0: 3d20 7064 2e44 6174 6146 7261 6d65 2866  = pd.DataFrame(f
-000637b0: 696e 616c 5f64 662c 696e 6465 783d 6f72  inal_df,index=or
-000637c0: 6967 5f64 6174 615f 696e 6465 782c 2063  ig_data_index, c
-000637d0: 6f6c 756d 6e73 3d78 6e61 6d65 7329 0d0a  olumns=xnames)..
-000637e0: 2020 2020 2020 2020 7265 7475 726e 2070          return p
-000637f0: 7265 6469 6374 6f72 732c 206c 6d2c 2066  redictors, lm, f
-00063800: 696e 616c 5f64 662c 206d 642c 2078 6e61  inal_df, md, xna
-00063810: 6d65 732c 2022 220d 0a23 2323 2323 2323  mes, ""..#######
-00063820: 2323 2323 2323 2323 2323 2323 2323 2323  ################
-00063830: 2323 2323 2323 2323 2323 2323 2323 2323  ################
-00063840: 2323 2323 2323 2323 2323 2323 2323 2323  ################
-00063850: 2323 2323 2323 2323 2323 2323 2323 2323  ################
-00063860: 2323 2323 2323 2323 2323 230d 0a23 2320  ###########..## 
-00063870: 496d 706f 7274 2073 6b6c 6561 726e 0d0a  Import sklearn..
-00063880: 6672 6f6d 2073 6b6c 6561 726e 2e6d 6f64  from sklearn.mod
-00063890: 656c 5f73 656c 6563 7469 6f6e 2069 6d70  el_selection imp
-000638a0: 6f72 7420 6372 6f73 735f 7661 6c5f 7363  ort cross_val_sc
-000638b0: 6f72 652c 4b46 6f6c 642c 2053 7472 6174  ore,KFold, Strat
-000638c0: 6966 6965 644b 466f 6c64 0d0a 6465 6620  ifiedKFold..def 
-000638d0: 7072 696e 745f 6d6f 6465 6c5f 6d65 7472  print_model_metr
-000638e0: 6963 7328 6d6f 6465 6c74 7970 652c 7265  ics(modeltype,re
-000638f0: 672c 582c 792c 6669 745f 666c 6167 3d46  g,X,y,fit_flag=F
-00063900: 616c 7365 2c76 6572 626f 7365 3d31 293a  alse,verbose=1):
-00063910: 0d0a 2020 2020 2323 2320 4966 2066 6974  ..    ### If fit
-00063920: 5f66 6c61 6720 6973 2073 6574 2074 6f20  _flag is set to 
-00063930: 5472 7565 2c20 7468 656e 2079 6f75 206d  True, then you m
-00063940: 7573 7420 7265 7475 726e 2061 2066 6974  ust return a fit
-00063950: 7465 6420 6d6f 6465 6c20 2323 230d 0a20  ted model ###.. 
-00063960: 2020 2023 2323 2020 2045 6c73 6520 796f     ###   Else yo
-00063970: 7520 6d75 7374 2072 6574 7572 6e20 7468  u must return th
-00063980: 6520 6376 5f73 636f 7265 732e 6d65 616e  e cv_scores.mean
-00063990: 206f 6e6c 7920 2323 2323 0d0a 2020 2020   only ####..    
-000639a0: 6e5f 7370 6c69 7473 203d 2035 0d0a 2020  n_splits = 5..  
-000639b0: 2020 6966 2076 6572 626f 7365 3e30 3a0d    if verbose>0:.
-000639c0: 0a20 2020 2020 2020 2070 7269 6e74 2822  .        print("
-000639d0: 4d6f 6465 6c20 5265 706f 7274 203a 2229  Model Report :")
-000639e0: 0d0a 2020 2020 2020 2020 7072 696e 7428  ..        print(
-000639f0: 2720 2020 204e 756d 6265 7220 6f66 2056  '    Number of V
-00063a00: 6172 6961 626c 6573 203d 2027 2c58 2e73  ariables = ',X.s
-00063a10: 6861 7065 5b31 5d29 0d0a 2020 2020 6966  hape[1])..    if
-00063a20: 206d 6f64 656c 7479 7065 203d 3d20 2752   modeltype == 'R
-00063a30: 6567 7265 7373 696f 6e27 3a0d 0a20 2020  egression':..   
-00063a40: 2020 2020 2073 6376 203d 204b 466f 6c64       scv = KFold
-00063a50: 286e 5f73 706c 6974 733d 6e5f 7370 6c69  (n_splits=n_spli
-00063a60: 7473 290d 0a20 2020 2020 2020 2023 7065  ts)..        #pe
-00063a70: 7266 6f72 6d73 2063 726f 7373 2076 616c  rforms cross val
-00063a80: 6964 6174 696f 6e0d 0a20 2020 2020 2020  idation..       
-00063a90: 2063 765f 7363 6f72 6573 203d 2063 726f   cv_scores = cro
-00063aa0: 7373 5f76 616c 5f73 636f 7265 2872 6567  ss_val_score(reg
-00063ab0: 2c58 2c79 2e76 616c 7565 732e 7261 7665  ,X,y.values.rave
-00063ac0: 6c28 292c 6376 3d73 6376 2c73 636f 7269  l(),cv=scv,scori
-00063ad0: 6e67 3d27 6e65 675f 6d65 616e 5f73 7175  ng='neg_mean_squ
-00063ae0: 6172 6564 5f65 7272 6f72 2729 0d0a 2020  ared_error')..  
-00063af0: 2020 2020 2020 6376 5f73 636f 7265 7320        cv_scores 
-00063b00: 3d20 6e70 2e73 7172 7428 6e70 2e61 6273  = np.sqrt(np.abs
-00063b10: 2863 765f 7363 6f72 6573 2929 0d0a 2020  (cv_scores))..  
-00063b20: 2020 2020 2020 6966 2076 6572 626f 7365        if verbose
-00063b30: 3a0d 0a20 2020 2020 2020 2020 2020 2070  :..            p
-00063b40: 7269 6e74 2822 2020 2020 4356 2052 4d53  rint("    CV RMS
-00063b50: 4520 5363 6f72 6520 3a20 252e 3467 202b  E Score : %.4g +
-00063b60: 2f2d 2025 2e34 6720 7c20 4d69 6e20 3d20  /- %.4g | Min = 
-00063b70: 252e 3467 207c 204d 6178 203d 2025 2e34  %.4g | Max = %.4
-00063b80: 6722 2025 280d 0a20 2020 2020 2020 2020  g" %(..         
-00063b90: 2020 2020 2020 206e 702e 6d65 616e 2863         np.mean(c
-00063ba0: 765f 7363 6f72 6573 292c 6e70 2e73 7464  v_scores),np.std
-00063bb0: 2863 765f 7363 6f72 6573 292c 0d0a 2020  (cv_scores),..  
-00063bc0: 2020 2020 2020 2020 2020 2020 2020 206e                 n
-00063bd0: 702e 6d69 6e28 6376 5f73 636f 7265 7329  p.min(cv_scores)
-00063be0: 2c6e 702e 6d61 7828 6376 5f73 636f 7265  ,np.max(cv_score
-00063bf0: 7329 2929 0d0a 2020 2020 656c 7365 3a0d  s)))..    else:.
-00063c00: 0a20 2020 2020 2020 2073 6376 203d 2053  .        scv = S
-00063c10: 7472 6174 6966 6965 644b 466f 6c64 286e  tratifiedKFold(n
-00063c20: 5f73 706c 6974 733d 6e5f 7370 6c69 7473  _splits=n_splits
-00063c30: 2c20 7261 6e64 6f6d 5f73 7461 7465 3d30  , random_state=0
-00063c40: 2c20 7368 7566 666c 653d 5472 7565 290d  , shuffle=True).
-00063c50: 0a20 2020 2020 2020 2023 2323 2075 7365  .        ### use
-00063c60: 2046 3120 7765 6967 6874 6564 2073 696e   F1 weighted sin
-00063c70: 6365 2069 7420 776f 726b 7320 6f6e 206d  ce it works on m
-00063c80: 756c 7469 706c 6520 636c 6173 7365 7320  ultiple classes 
-00063c90: 6173 2077 656c 6c20 6173 2062 696e 6172  as well as binar
-00063ca0: 7920 2323 0d0a 2020 2020 2020 2020 6376  y ##..        cv
-00063cb0: 5f73 636f 7265 7320 3d20 6372 6f73 735f  _scores = cross_
-00063cc0: 7661 6c5f 7363 6f72 6528 7265 672c 582c  val_score(reg,X,
-00063cd0: 792e 7661 6c75 6573 2e72 6176 656c 2829  y.values.ravel()
-00063ce0: 2c63 763d 7363 762c 7363 6f72 696e 673d  ,cv=scv,scoring=
-00063cf0: 2766 315f 7765 6967 6874 6564 2729 0d0a  'f1_weighted')..
-00063d00: 2020 2020 2020 2020 6966 2076 6572 626f          if verbo
-00063d10: 7365 3e30 3a0d 0a20 2020 2020 2020 2020  se>0:..         
-00063d20: 2020 2070 7269 6e74 2822 2020 2020 4356     print("    CV
-00063d30: 2057 6569 6768 7465 6420 4631 2053 636f   Weighted F1 Sco
-00063d40: 7265 203a 2025 2e34 6720 2b2f 2d20 252e  re : %.4g +/- %.
-00063d50: 3467 207c 204d 696e 203d 2025 2e34 6720  4g | Min = %.4g 
-00063d60: 7c20 4d61 7820 3d20 252e 3467 2220 2520  | Max = %.4g" % 
-00063d70: 280d 0a20 2020 2020 2020 2020 2020 2020  (..             
-00063d80: 2020 206e 702e 6d65 616e 2863 765f 7363     np.mean(cv_sc
-00063d90: 6f72 6573 292c 6e70 2e73 7464 2863 765f  ores),np.std(cv_
-00063da0: 7363 6f72 6573 292c 0d0a 2020 2020 2020  scores),..      
-00063db0: 2020 2020 2020 2020 2020 206e 702e 6d69             np.mi
-00063dc0: 6e28 6376 5f73 636f 7265 7329 2c6e 702e  n(cv_scores),np.
-00063dd0: 6d61 7828 6376 5f73 636f 7265 7329 2929  max(cv_scores)))
-00063de0: 0d0a 2020 2020 6966 2066 6974 5f66 6c61  ..    if fit_fla
-00063df0: 673a 0d0a 2020 2020 2020 2020 7265 7475  g:..        retu
-00063e00: 726e 2072 6567 2e66 6974 2858 2c79 292c  rn reg.fit(X,y),
-00063e10: 2020 6376 5f73 636f 7265 732e 6d65 616e    cv_scores.mean
-00063e20: 2829 0d0a 2020 2020 656c 7365 3a0d 0a20  ()..    else:.. 
-00063e30: 2020 2020 2020 2072 6574 7572 6e20 2063         return  c
-00063e40: 765f 7363 6f72 6573 2e6d 6561 6e28 290d  v_scores.mean().
-00063e50: 0a23 2323 2323 2323 2323 2323 2323 2323  .###############
-00063e60: 2323 2323 2323 2323 2323 2323 2323 2323  ################
-00063e70: 2323 2323 2323 2323 2323 2323 2323 2323  ################
-00063e80: 2323 2323 2323 2323 2323 2323 2323 2323  ################
-00063e90: 2323 2323 2323 2323 2323 2323 2323 2323  ################
-00063ea0: 2323 2323 2323 2323 2323 2323 2323 230d  ###############.
-00063eb0: 0a64 6566 2073 656c 6563 745f 6265 7374  .def select_best
-00063ec0: 5f76 6172 6961 626c 6573 286d 642c 2072  _variables(md, r
-00063ed0: 6567 2c20 6466 2c6e 616d 6573 2c6e 5f6f  eg, df,names,n_o
-00063ee0: 7269 675f 6665 6174 7572 6573 2c41 6464  rig_features,Add
-00063ef0: 5f50 6f6c 792c 7665 7262 6f73 653d 3029  _Poly,verbose=0)
-00063f00: 3a0d 0a20 2020 2022 2222 0d0a 2020 2020  :..    """..    
-00063f10: 5468 6973 2070 726f 6772 616d 2073 656c  This program sel
-00063f20: 6563 7473 2074 6865 2074 6f70 2031 3025  ects the top 10%
-00063f30: 206f 6620 696e 7465 7261 6374 696f 6e20   of interaction 
-00063f40: 7661 7269 6162 6c65 7320 6372 6561 7465  variables create
-00063f50: 6420 7573 696e 6720 6c69 6e65 6172 206d  d using linear m
-00063f60: 6f64 656c 696e 672e 0d0a 2020 2020 2222  odeling...    ""
-00063f70: 220d 0a20 2020 2064 6639 3020 3d20 6466  "..    df90 = df
-00063f80: 5b61 6273 2864 665b 2743 6f65 6666 6963  [abs(df['Coeffic
-00063f90: 6965 6e74 2056 616c 7565 7327 5d29 3e3d  ient Values'])>=
-00063fa0: 6466 5b27 436f 6566 6669 6369 656e 7420  df['Coefficient 
-00063fb0: 5661 6c75 6573 275d 2e71 7561 6e74 696c  Values'].quantil
-00063fc0: 6528 302e 3930 295d 0d0a 2020 2020 6966  e(0.90)]..    if
-00063fd0: 2076 6572 626f 7365 203e 3d20 313a 0d0a   verbose >= 1:..
-00063fe0: 2020 2020 2020 2020 6466 3930 2e70 6c6f          df90.plo
-00063ff0: 7428 0d0a 2020 2020 2020 2020 2020 2020  t(..            
-00064000: 6b69 6e64 3d27 6261 7227 2c78 3d27 496e  kind='bar',x='In
-00064010: 7465 7261 6374 696f 6e20 5661 7269 6162  teraction Variab
-00064020: 6c65 204e 616d 6573 272c 793d 2743 6f65  le Names',y='Coe
-00064030: 6666 6963 6965 6e74 2056 616c 7565 7327  fficient Values'
-00064040: 2c0d 0a20 2020 2020 2020 2020 2020 2074  ,..            t
-00064050: 6974 6c65 3d27 546f 7020 3130 2520 5661  itle='Top 10% Va
-00064060: 7269 6162 6c65 2049 6e74 6572 6163 7469  riable Interacti
-00064070: 6f6e 7320 616e 6420 7468 6569 7220 436f  ons and their Co
-00064080: 6566 6669 6369 656e 7473 2027 290d 0a20  efficients ').. 
-00064090: 2020 2069 6620 7665 7262 6f73 6520 3e3d     if verbose >=
-000640a0: 2031 3a0d 0a20 2020 2020 2020 2064 662e   1:..        df.
-000640b0: 706c 6f74 286b 696e 643d 2762 6172 272c  plot(kind='bar',
-000640c0: 783d 2749 6e74 6572 6163 7469 6f6e 2056  x='Interaction V
-000640d0: 6172 6961 626c 6520 4e61 6d65 7327 2c79  ariable Names',y
-000640e0: 3d27 436f 6566 6669 6369 656e 7420 5661  ='Coefficient Va
-000640f0: 6c75 6573 272c 0d0a 2020 2020 2020 2020  lues',..        
-00064100: 2020 2020 2020 2020 7469 746c 653d 2741          title='A
-00064110: 6c6c 2056 6172 6961 626c 6520 496e 7465  ll Variable Inte
-00064120: 7261 6374 696f 6e73 2061 6e64 2074 6865  ractions and the
-00064130: 6972 2043 6f65 6666 6963 6965 6e74 7327  ir Coefficients'
-00064140: 2c66 6967 7369 7a65 3d28 3230 2c31 3029  ,figsize=(20,10)
-00064150: 290d 0a20 2020 2069 6e74 6572 6163 7469  )..    interacti
-00064160: 6f6e 7320 3d20 6466 3930 5b27 496e 7465  ons = df90['Inte
-00064170: 7261 6374 696f 6e20 5661 7269 6162 6c65  raction Variable
-00064180: 204e 616d 6573 275d 2e76 616c 7565 732e   Names'].values.
-00064190: 746f 6c69 7374 2829 0d0a 2020 2020 7072  tolist()..    pr
-000641a0: 696e 7428 2725 6420 496e 7465 7261 6374  int('%d Interact
-000641b0: 696f 6e20 616e 6420 506f 6c79 6e6f 6d69  ion and Polynomi
-000641c0: 616c 2076 6172 6961 626c 6528 7329 2073  al variable(s) s
-000641d0: 656c 6563 7465 642e 2e2e 5c6e 2720 256c  elected...\n' %l
-000641e0: 656e 2869 6e74 6572 6163 7469 6f6e 7329  en(interactions)
-000641f0: 290d 0a20 2020 2066 696e 616c 7661 7273  )..    finalvars
-00064200: 203d 206e 616d 6573 202b 2069 6e74 6572   = names + inter
-00064210: 6163 7469 6f6e 730d 0a20 2020 2023 6669  actions..    #fi
-00064220: 6e61 6c76 6172 735f 696e 6465 7820 3d20  nalvars_index = 
-00064230: 5b64 665b 6466 5b27 496e 7465 7261 6374  [df[df['Interact
-00064240: 696f 6e20 5661 7269 6162 6c65 204e 616d  ion Variable Nam
-00064250: 6573 275d 3d3d 785d 2e69 6e64 6578 5b30  es']==x].index[0
-00064260: 5d20 666f 7220 7820 696e 2066 696e 616c  ] for x in final
-00064270: 7661 7273 5d0d 0a20 2020 2072 6574 7572  vars]..    retur
-00064280: 6e20 6669 6e61 6c76 6172 730d 0a23 2323  n finalvars..###
-00064290: 2323 2323 2323 2323 2323 2323 2323 2323  ################
-000642a0: 2323 2323 2323 2323 2323 2323 2323 2323  ################
-000642b0: 2323 2323 2323 2323 2323 2323 2323 2323  ################
-000642c0: 2323 2323 2323 2323 2323 2323 2323 2323  ################
-000642d0: 2323 2323 2323 2323 2323 2323 2323 2323  ################
-000642e0: 2323 2323 2323 2323 2323 230d 0a66 726f  ###########..fro
-000642f0: 6d20 736b 6c65 6172 6e2e 6d65 7472 6963  m sklearn.metric
-00064300: 7320 696d 706f 7274 2072 6f63 5f63 7572  s import roc_cur
-00064310: 7665 2c20 6175 630d 0a66 726f 6d20 7363  ve, auc..from sc
-00064320: 6970 7920 696d 706f 7274 2069 6e74 6572  ipy import inter
-00064330: 700d 0a69 6d70 6f72 7420 7061 6e64 6173  p..import pandas
-00064340: 2061 7320 7064 0d0a 6465 6620 4472 6177   as pd..def Draw
-00064350: 5f52 4f43 5f4d 435f 4d4c 286d 6f64 656c  _ROC_MC_ML(model
-00064360: 2c20 585f 7465 7374 2c20 795f 7472 7565  , X_test, y_true
-00064370: 2c20 7461 7267 6574 2c20 6d6f 6465 6c5f  , target, model_
-00064380: 6e61 6d65 2c20 7665 7262 6f73 653d 3029  name, verbose=0)
-00064390: 3a0d 0a20 2020 2066 6967 7369 7a65 203d  :..    figsize =
-000643a0: 2028 3130 2c20 3629 0d0a 2020 2020 795f   (10, 6)..    y_
-000643b0: 7072 6f62 6120 3d20 6d6f 6465 6c2e 7072  proba = model.pr
-000643c0: 6564 6963 745f 7072 6f62 6128 585f 7465  edict_proba(X_te
-000643d0: 7374 290d 0a20 2020 2070 7265 6469 6374  st)..    predict
-000643e0: 6564 203d 2063 6f70 792e 6465 6570 636f  ed = copy.deepco
-000643f0: 7079 2879 5f70 726f 6261 290d 0a20 2020  py(y_proba)..   
-00064400: 2074 6872 6573 686f 6c64 203d 2030 2e35   threshold = 0.5
-00064410: 300d 0a20 2020 2079 5f70 7265 6420 3d20  0..    y_pred = 
-00064420: 6d6f 6465 6c2e 7072 6564 6963 7428 585f  model.predict(X_
-00064430: 7465 7374 290d 0a20 2020 2066 7072 203d  test)..    fpr =
-00064440: 2064 6963 7428 290d 0a20 2020 2074 7072   dict()..    tpr
-00064450: 203d 2064 6963 7428 290d 0a20 2020 2072   = dict()..    r
-00064460: 6f63 5f61 7563 203d 2064 6963 7428 290d  oc_auc = dict().
-00064470: 0a20 2020 2069 7465 7261 7469 6f6e 7320  .    iterations 
-00064480: 3d20 300d 0a20 2020 2072 6172 655f 636c  = 0..    rare_cl
-00064490: 6173 7320 3d20 6669 6e64 5f72 6172 655f  ass = find_rare_
-000644a0: 636c 6173 7328 795f 7472 7565 290d 0a20  class(y_true).. 
-000644b0: 2020 2069 6620 6973 696e 7374 616e 6365     if isinstance
-000644c0: 2874 6172 6765 742c 7374 7229 3a0d 0a20  (target,str):.. 
-000644d0: 2020 2020 2020 2074 6172 6765 7420 3d20         target = 
-000644e0: 5b74 6172 6765 745d 0d0a 2020 2020 666f  [target]..    fo
-000644f0: 7220 7461 7267 2069 6e20 7461 7267 6574  r targ in target
-00064500: 3a0d 0a20 2020 2020 2020 2069 6620 6c65  :..        if le
-00064510: 6e28 6c65 6674 5f73 7562 7472 6163 7428  n(left_subtract(
-00064520: 6e70 2e75 6e69 7175 6528 795f 7472 7565  np.unique(y_true
-00064530: 292c 6e70 2e75 6e69 7175 6528 795f 7072  ),np.unique(y_pr
-00064540: 6564 2929 2920 3d3d 2030 3a0d 0a20 2020  ed))) == 0:..   
-00064550: 2020 2020 2020 2020 2063 6c61 7373 6573           classes
-00064560: 203d 206c 6973 7428 7261 6e67 6528 6c65   = list(range(le
-00064570: 6e28 6e70 2e75 6e69 7175 6528 795f 7472  n(np.unique(y_tr
-00064580: 7565 2929 2929 0d0a 2020 2020 2020 2020  ue))))..        
-00064590: 656c 7365 3a0d 0a20 2020 2020 2020 2020  else:..         
-000645a0: 2020 2063 6c61 7373 6573 203d 206c 6973     classes = lis
-000645b0: 7428 7261 6e67 6528 6c65 6e28 6e70 2e75  t(range(len(np.u
-000645c0: 6e69 7175 6528 795f 7072 6564 2929 2929  nique(y_pred))))
-000645d0: 0d0a 2020 2020 2020 2020 6e5f 636c 6173  ..        n_clas
-000645e0: 7365 7320 3d20 6c65 6e28 636c 6173 7365  ses = len(classe
-000645f0: 7329 0d0a 2020 2020 2020 2020 6966 206d  s)..        if m
-00064600: 6f64 656c 5f6e 616d 652e 6c6f 7765 7228  odel_name.lower(
-00064610: 2920 3d3d 2027 6361 7462 6f6f 7374 273a  ) == 'catboost':
-00064620: 0d0a 2020 2020 2020 2020 2020 2020 7472  ..            tr
-00064630: 793a 0d0a 2020 2020 2020 2020 2020 2020  y:..            
-00064640: 2020 2020 795f 7072 6564 203d 2028 795f      y_pred = (y_
-00064650: 7072 6f62 613e 302e 3529 2e61 7374 7970  proba>0.5).astyp
-00064660: 6528 696e 7429 2e64 6f74 2863 6c61 7373  e(int).dot(class
-00064670: 6573 290d 0a20 2020 2020 2020 2020 2020  es)..           
-00064680: 2065 7863 6570 743a 0d0a 2020 2020 2020   except:..      
-00064690: 2020 2020 2020 2020 2020 7061 7373 0d0a            pass..
-000646a0: 2020 2020 2020 2020 6966 206e 5f63 6c61          if n_cla
-000646b0: 7373 6573 203d 3d20 323a 0d0a 2020 2020  sses == 2:..    
-000646c0: 2020 2020 2020 2020 2323 2320 416c 7761          ### Alwa
-000646d0: 7973 2073 6574 2072 6172 655f 636c 6173  ys set rare_clas
-000646e0: 7320 746f 2031 2077 6865 6e20 7468 6572  s to 1 when ther
-000646f0: 6520 6172 6520 6f6e 6c79 2032 2063 6c61  e are only 2 cla
-00064700: 7373 6573 2066 6f72 2064 7261 7769 6e67  sses for drawing
-00064710: 2052 4f43 2043 7572 7665 210d 0a20 2020   ROC Curve!..   
-00064720: 2020 2020 2020 2020 2079 5f74 6573 7420           y_test 
-00064730: 3d20 636f 7079 2e64 6565 7063 6f70 7928  = copy.deepcopy(
-00064740: 795f 7472 7565 290d 0a20 2020 2020 2020  y_true)..       
-00064750: 2020 2020 2070 7265 6469 6374 6564 205b       predicted [
-00064760: 3a2c 305d 203d 2028 7072 6564 6963 7465  :,0] = (predicte
-00064770: 6420 5b3a 2c30 5d20 3e3d 2028 312d 6d5f  d [:,0] >= (1-m_
-00064780: 7468 7265 7368 2929 2e61 7374 7970 6528  thresh)).astype(
-00064790: 2769 6e74 2729 0d0a 2020 2020 2020 2020  'int')..        
-000647a0: 2020 2020 7072 6564 6963 7465 6420 5b3a      predicted [:
-000647b0: 2c31 5d20 3d20 2870 7265 6469 6374 6564  ,1] = (predicted
-000647c0: 205b 3a2c 315d 203e 2074 6872 6573 686f   [:,1] > thresho
-000647d0: 6c64 292e 6173 7479 7065 2827 696e 7427  ld).astype('int'
-000647e0: 290d 0a20 2020 2020 2020 2020 2020 2079  )..            y
-000647f0: 5f70 7265 6420 3d20 7072 6564 6963 7465  _pred = predicte
-00064800: 645b 3a2c 7261 7265 5f63 6c61 7373 5d0d  d[:,rare_class].
-00064810: 0a20 2020 2020 2020 2065 6c73 653a 0d0a  .        else:..
-00064820: 2020 2020 2020 2020 2020 2020 795f 7465              y_te
-00064830: 7374 203d 206c 6162 656c 5f62 696e 6172  st = label_binar
-00064840: 697a 6528 795f 7472 7565 2c20 636c 6173  ize(y_true, clas
-00064850: 7365 7329 0d0a 2020 2020 2020 2020 7472  ses)..        tr
-00064860: 793a 0d0a 2020 2020 2020 2020 2020 2020  y:..            
-00064870: 6966 206e 5f63 6c61 7373 6573 203e 2032  if n_classes > 2
-00064880: 3a0d 0a20 2020 2020 2020 2020 2020 2020  :..             
-00064890: 2020 2069 6620 795f 7465 7374 2e73 6861     if y_test.sha
-000648a0: 7065 5b31 5d20 3d3d 2079 5f70 726f 6261  pe[1] == y_proba
-000648b0: 2e73 6861 7065 5b31 5d3a 0d0a 2020 2020  .shape[1]:..    
-000648c0: 2020 2020 2020 2020 2020 2020 2020 2020                  
-000648d0: 636c 6173 7365 7320 3d20 6c69 7374 2872  classes = list(r
-000648e0: 616e 6765 2879 5f74 6573 742e 7368 6170  ange(y_test.shap
-000648f0: 655b 315d 2929 0d0a 2020 2020 2020 2020  e[1]))..        
-00064900: 2020 2020 2020 2020 656c 7365 3a0d 0a20          else:.. 
-00064910: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00064920: 2020 2069 6620 795f 7072 6f62 612e 7368     if y_proba.sh
-00064930: 6170 655b 315d 203e 2079 5f74 6573 742e  ape[1] > y_test.
-00064940: 7368 6170 655b 315d 3a0d 0a20 2020 2020  shape[1]:..     
-00064950: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00064960: 2020 2063 6c61 7373 6573 203d 206c 6973     classes = lis
-00064970: 7428 7261 6e67 6528 795f 7072 6f62 612e  t(range(y_proba.
-00064980: 7368 6170 655b 315d 2929 0d0a 2020 2020  shape[1]))..    
-00064990: 2020 2020 2020 2020 2020 2020 2020 2020                  
-000649a0: 656c 7365 3a0d 0a20 2020 2020 2020 2020  else:..         
-000649b0: 2020 2020 2020 2020 2020 2020 2020 2063                 c
-000649c0: 6c61 7373 6573 203d 206c 6973 7428 7261  lasses = list(ra
-000649d0: 6e67 6528 795f 7465 7374 2e73 6861 7065  nge(y_test.shape
-000649e0: 5b31 5d29 290d 0a20 2020 2020 2020 2065  [1]))..        e
-000649f0: 7863 6570 743a 0d0a 2020 2020 2020 2020  xcept:..        
-00064a00: 2020 2020 7061 7373 0d0a 2020 2020 2020      pass..      
-00064a10: 2020 6966 206e 5f63 6c61 7373 6573 203d    if n_classes =
-00064a20: 3d20 323a 0d0a 2020 2020 2020 2020 2020  = 2:..          
-00064a30: 2020 6974 6572 6174 696f 6e73 203d 2031    iterations = 1
-00064a40: 0d0a 2020 2020 2020 2020 656c 7365 3a0d  ..        else:.
-00064a50: 0a20 2020 2020 2020 2020 2020 2069 7465  .            ite
-00064a60: 7261 7469 6f6e 7320 3d20 636f 7079 2e64  rations = copy.d
-00064a70: 6565 7063 6f70 7928 6e5f 636c 6173 7365  eepcopy(n_classe
-00064a80: 7329 0d0a 2020 2020 2020 2020 2323 2323  s)..        ####
-00064a90: 2323 2323 2323 2323 2323 2323 2323 2323  ################
-00064aa0: 2320 2020 5468 6973 2069 7320 7768 6572  #   This is wher
-00064ab0: 6520 796f 7520 6361 6c63 756c 6174 6520  e you calculate 
-00064ac0: 524f 435f 4155 4320 666f 7220 616c 6c20  ROC_AUC for all 
-00064ad0: 636c 6173 7365 7320 2323 2323 2323 2323  classes ########
-00064ae0: 230d 0a20 2020 2020 2020 2066 6f72 2069  #..        for i
-00064af0: 2069 6e20 7261 6e67 6528 6974 6572 6174   in range(iterat
-00064b00: 696f 6e73 293a 0d0a 2020 2020 2020 2020  ions):..        
-00064b10: 2020 2020 6966 206e 5f63 6c61 7373 6573      if n_classes
-00064b20: 3d3d 323a 0d0a 2020 2020 2020 2020 2020  ==2:..          
-00064b30: 2020 2020 2020 6670 725b 7261 7265 5f63        fpr[rare_c
-00064b40: 6c61 7373 5d2c 2074 7072 5b72 6172 655f  lass], tpr[rare_
-00064b50: 636c 6173 735d 2c20 5f20 3d20 726f 635f  class], _ = roc_
-00064b60: 6375 7276 6528 795f 7465 7374 2e72 6176  curve(y_test.rav
-00064b70: 656c 2829 2c20 795f 7072 6f62 615b 3a2c  el(), y_proba[:,
-00064b80: 7261 7265 5f63 6c61 7373 5d29 0d0a 2020  rare_class])..  
-00064b90: 2020 2020 2020 2020 2020 2020 2020 726f                ro
-00064ba0: 635f 6175 635b 7261 7265 5f63 6c61 7373  c_auc[rare_class
-00064bb0: 5d20 3d20 6175 6328 6670 725b 7261 7265  ] = auc(fpr[rare
-00064bc0: 5f63 6c61 7373 5d2c 2074 7072 5b72 6172  _class], tpr[rar
-00064bd0: 655f 636c 6173 735d 290d 0a20 2020 2020  e_class])..     
-00064be0: 2020 2020 2020 2065 6c73 653a 0d0a 2020         else:..  
-00064bf0: 2020 2020 2020 2020 2020 2020 2020 6670                fp
-00064c00: 725b 695d 2c20 7470 725b 695d 2c20 5f20  r[i], tpr[i], _ 
-00064c10: 3d20 726f 635f 6375 7276 6528 795f 7465  = roc_curve(y_te
-00064c20: 7374 5b3a 2c69 5d2c 2079 5f70 726f 6261  st[:,i], y_proba
-00064c30: 5b3a 2c69 5d29 0d0a 2020 2020 2020 2020  [:,i])..        
-00064c40: 2020 2020 2020 2020 726f 635f 6175 635b          roc_auc[
-00064c50: 695d 203d 2061 7563 2866 7072 5b69 5d2c  i] = auc(fpr[i],
-00064c60: 2074 7072 5b69 5d29 0d0a 2020 2020 2020   tpr[i])..      
-00064c70: 2020 2323 2320 436f 6d70 7574 6520 4d69    ### Compute Mi
-00064c80: 6372 6f20 4176 6572 6167 6520 7768 6963  cro Average whic
-00064c90: 6820 6973 2061 2072 6f77 2d62 792d 726f  h is a row-by-ro
-00064ca0: 7720 7363 6f72 6520 2323 2323 2323 2323  w score ########
-00064cb0: 2323 230d 0a20 2020 2020 2020 2074 7279  ###..        try
-00064cc0: 3a0d 0a20 2020 2020 2020 2020 2020 2069  :..            i
-00064cd0: 6620 6e5f 636c 6173 7365 7320 3d3d 2032  f n_classes == 2
-00064ce0: 3a0d 0a20 2020 2020 2020 2020 2020 2020  :..             
-00064cf0: 2020 2066 7072 5b22 6d69 6372 6f22 5d2c     fpr["micro"],
-00064d00: 2074 7072 5b22 6d69 6372 6f22 5d2c 205f   tpr["micro"], _
-00064d10: 203d 2072 6f63 5f63 7572 7665 2879 5f74   = roc_curve(y_t
-00064d20: 6573 742e 7261 7665 6c28 292c 2079 5f70  est.ravel(), y_p
-00064d30: 7265 642e 7261 7665 6c28 2929 0d0a 2020  red.ravel())..  
-00064d40: 2020 2020 2020 2020 2020 656c 7365 3a0d            else:.
-00064d50: 0a20 2020 2020 2020 2020 2020 2020 2020  .               
-00064d60: 2066 7072 5b22 6d69 6372 6f22 5d2c 2074   fpr["micro"], t
-00064d70: 7072 5b22 6d69 6372 6f22 5d2c 205f 203d  pr["micro"], _ =
-00064d80: 2072 6f63 5f63 7572 7665 2879 5f74 6573   roc_curve(y_tes
-00064d90: 742e 7261 7665 6c28 292c 6c61 6265 6c5f  t.ravel(),label_
-00064da0: 6269 6e61 7269 7a65 2879 5f70 7265 642c  binarize(y_pred,
-00064db0: 2063 6c61 7373 6573 292e 7261 7665 6c28   classes).ravel(
-00064dc0: 2929 0d0a 2020 2020 2020 2020 6578 6365  ))..        exce
-00064dd0: 7074 3a0d 0a20 2020 2020 2020 2020 2020  pt:..           
-00064de0: 2069 6620 795f 7465 7374 2e72 6176 656c   if y_test.ravel
-00064df0: 2829 2e73 6861 7065 5b30 5d20 213d 2079  ().shape[0] != y
-00064e00: 5f70 7265 642e 7261 7665 6c28 292e 7368  _pred.ravel().sh
-00064e10: 6170 655b 305d 3a0d 0a20 2020 2020 2020  ape[0]:..       
-00064e20: 2020 2020 2020 2020 2066 7072 5b22 6d69           fpr["mi
-00064e30: 6372 6f22 5d2c 2074 7072 5b22 6d69 6372  cro"], tpr["micr
-00064e40: 6f22 5d2c 205f 203d 2072 6f63 5f63 7572  o"], _ = roc_cur
-00064e50: 7665 2879 5f74 6573 745b 3a2c 3a6e 5f63  ve(y_test[:,:n_c
-00064e60: 6c61 7373 6573 5d2e 7261 7665 6c28 292c  lasses].ravel(),
-00064e70: 2079 5f70 726f 6261 5b3a 2c3a 6e5f 636c   y_proba[:,:n_cl
-00064e80: 6173 7365 735d 2e72 6176 656c 2829 290d  asses].ravel()).
-00064e90: 0a20 2020 2020 2020 2020 2020 2065 6c73  .            els
-00064ea0: 653a 0d0a 2020 2020 2020 2020 2020 2020  e:..            
-00064eb0: 2020 2020 6670 725b 226d 6963 726f 225d      fpr["micro"]
-00064ec0: 2c20 7470 725b 226d 6963 726f 225d 2c20  , tpr["micro"], 
-00064ed0: 5f20 3d20 726f 635f 6375 7276 6528 795f  _ = roc_curve(y_
-00064ee0: 7465 7374 2e72 6176 656c 2829 2c20 795f  test.ravel(), y_
-00064ef0: 7072 6f62 615b 3a2c 7261 7265 5f63 6c61  proba[:,rare_cla
-00064f00: 7373 5d2e 7261 7665 6c28 2929 0d0a 2020  ss].ravel())..  
-00064f10: 2020 2020 2020 7472 793a 0d0a 2020 2020        try:..    
-00064f20: 2020 2020 2020 2020 726f 635f 6175 635b          roc_auc[
-00064f30: 226d 6963 726f 225d 203d 2061 7563 2866  "micro"] = auc(f
-00064f40: 7072 5b22 6d69 6372 6f22 5d2c 2074 7072  pr["micro"], tpr
-00064f50: 5b22 6d69 6372 6f22 5d29 0d0a 2020 2020  ["micro"])..    
-00064f60: 2020 2020 6578 6365 7074 3a0d 0a20 2020      except:..   
-00064f70: 2020 2020 2020 2020 2070 6173 730d 0a20           pass.. 
-00064f80: 2020 2020 2020 2023 206d 6963 726f 2d61         # micro-a
-00064f90: 7665 7261 6765 2052 4f43 2063 7572 7665  verage ROC curve
-00064fa0: 2061 6e64 2052 4f43 2061 7265 6120 6861   and ROC area ha
-00064fb0: 7320 6265 656e 2063 6f6d 7075 7465 640d  s been computed.
-00064fc0: 0a20 2020 2020 2020 206c 6162 656c 7320  .        labels 
-00064fd0: 3d20 5b5d 0d0a 2020 2020 2020 2020 6966  = []..        if
-00064fe0: 206e 5f63 6c61 7373 6573 203c 3d20 323a   n_classes <= 2:
-00064ff0: 0d0a 2020 2020 2020 2020 2020 2020 2323  ..            ##
-00065000: 2323 2323 2323 2323 2323 2323 2323 2323  ################
-00065010: 2323 2323 2323 2323 2323 2323 2323 2323  ################
-00065020: 2323 2323 2323 2323 2323 2323 2323 2323  ################
-00065030: 2323 2323 2323 2323 2323 2323 2323 2323  ################
-00065040: 2323 2323 2323 2323 2323 2323 0d0a 2020  ############..  
-00065050: 2020 2020 2020 2020 2020 2320 506c 6f74            # Plot
-00065060: 206f 6620 6120 524f 4320 6375 7276 6520   of a ROC curve 
-00065070: 666f 7220 6f6e 6520 636c 6173 730d 0a20  for one class.. 
-00065080: 2020 2020 2020 2020 2020 2070 6c74 2e66             plt.f
-00065090: 6967 7572 6528 6669 6773 697a 653d 6669  igure(figsize=fi
-000650a0: 6773 697a 6529 0d0a 2020 2020 2020 2020  gsize)..        
-000650b0: 2020 2020 706c 742e 706c 6f74 2866 7072      plt.plot(fpr
-000650c0: 5b72 6172 655f 636c 6173 735d 2c20 7470  [rare_class], tp
-000650d0: 725b 7261 7265 5f63 6c61 7373 5d2c 206c  r[rare_class], l
-000650e0: 6162 656c 3d27 524f 4320 6375 7276 6520  abel='ROC curve 
-000650f0: 2841 5543 203d 2025 302e 3566 2927 2025  (AUC = %0.5f)' %
-00065100: 2072 6f63 5f61 7563 5b72 6172 655f 636c   roc_auc[rare_cl
-00065110: 6173 735d 290d 0a20 2020 2020 2020 2020  ass])..         
-00065120: 2020 2070 6c74 2e70 6c6f 7428 5b30 2c20     plt.plot([0, 
-00065130: 315d 2c20 5b30 2c20 315d 2c20 276b 2d2d  1], [0, 1], 'k--
-00065140: 2729 0d0a 2020 2020 2020 2020 2020 2020  ')..            
-00065150: 706c 742e 786c 696d 285b 302e 302c 2031  plt.xlim([0.0, 1
-00065160: 2e30 5d29 0d0a 2020 2020 2020 2020 2020  .0])..          
-00065170: 2020 706c 742e 796c 696d 285b 302e 302c    plt.ylim([0.0,
-00065180: 2031 2e30 355d 290d 0a20 2020 2020 2020   1.05])..       
-00065190: 2020 2020 2070 6c74 2e78 6c61 6265 6c28       plt.xlabel(
-000651a0: 2746 616c 7365 2050 6f73 6974 6976 6520  'False Positive 
-000651b0: 5261 7465 2729 0d0a 2020 2020 2020 2020  Rate')..        
-000651c0: 2020 2020 706c 742e 796c 6162 656c 2827      plt.ylabel('
-000651d0: 5472 7565 2050 6f73 6974 6976 6520 5261  True Positive Ra
-000651e0: 7465 2729 0d0a 2020 2020 2020 2020 2020  te')..          
-000651f0: 2020 706c 742e 7469 746c 6528 2752 4f43    plt.title('ROC
-00065200: 2043 7572 7665 2066 6f72 2050 7265 6469   Curve for Predi
-00065210: 6374 696f 6e73 206f 6e20 6865 6c64 206f  ctions on held o
-00065220: 7574 2064 6174 6120 666f 7220 7461 7267  ut data for targ
-00065230: 6574 3a20 2573 2720 2574 6172 6729 0d0a  et: %s' %targ)..
-00065240: 2020 2020 2020 2020 2020 2020 706c 742e              plt.
-00065250: 6c65 6765 6e64 286c 6f63 3d22 6c6f 7765  legend(loc="lowe
-00065260: 7220 7269 6768 7422 290d 0a20 2020 2020  r right")..     
-00065270: 2020 2020 2020 2070 6c74 2e73 686f 7728         plt.show(
-00065280: 293b 0d0a 2020 2020 2020 2020 656c 7365  );..        else
-00065290: 3a0d 0a20 2020 2020 2020 2023 2043 6f6d  :..        # Com
-000652a0: 7075 7465 206d 6163 726f 2d61 7665 7261  pute macro-avera
-000652b0: 6765 2052 4f43 2063 7572 7665 2061 6e64  ge ROC curve and
-000652c0: 2052 4f43 2061 7265 610d 0a20 2020 2020   ROC area..     
-000652d0: 2020 2020 2020 2066 6967 2c20 6178 203d         fig, ax =
-000652e0: 2070 6c74 2e73 7562 706c 6f74 7328 6669   plt.subplots(fi
-000652f0: 6773 697a 653d 6669 6773 697a 6529 0d0a  gsize=figsize)..
-00065300: 2020 2020 2020 2020 2020 2020 636f 6c6f              colo
-00065310: 7273 203d 2063 7963 6c65 2827 6279 7263  rs = cycle('byrc
-00065320: 6d67 6b62 7972 636d 676b 6279 7263 6d67  mgkbyrcmgkbyrcmg
-00065330: 6b62 7972 636d 676b 2729 0d0a 2020 2020  kbyrcmgk')..    
-00065340: 2020 2020 2020 2020 666f 7220 6920 696e          for i in
-00065350: 2072 616e 6765 2869 7465 7261 7469 6f6e   range(iteration
-00065360: 7329 3a0d 0a0d 0a20 2020 2020 2020 2020  s):....         
-00065370: 2020 2020 2020 2023 2046 6972 7374 2061         # First a
-00065380: 6767 7265 6761 7465 2061 6c6c 2066 616c  ggregate all fal
-00065390: 7365 2070 6f73 6974 6976 6520 7261 7465  se positive rate
-000653a0: 730d 0a20 2020 2020 2020 2020 2020 2020  s..             
-000653b0: 2020 2061 6c6c 5f66 7072 203d 206e 702e     all_fpr = np.
-000653c0: 756e 6971 7565 286e 702e 636f 6e63 6174  unique(np.concat
-000653d0: 656e 6174 6528 5b66 7072 5b69 5d20 666f  enate([fpr[i] fo
-000653e0: 7220 6920 696e 2072 616e 6765 286e 5f63  r i in range(n_c
-000653f0: 6c61 7373 6573 295d 2929 0d0a 0d0a 2020  lasses)]))....  
-00065400: 2020 2020 2020 2020 2020 2020 2020 2320                # 
-00065410: 5468 656e 2069 6e74 6572 706f 6c61 7465  Then interpolate
-00065420: 2061 6c6c 2052 4f43 2063 7572 7665 7320   all ROC curves 
-00065430: 6174 2074 6869 7320 706f 696e 7473 0d0a  at this points..
-00065440: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00065450: 6d65 616e 5f74 7072 203d 206e 702e 7a65  mean_tpr = np.ze
-00065460: 726f 735f 6c69 6b65 2861 6c6c 5f66 7072  ros_like(all_fpr
-00065470: 290d 0a20 2020 2020 2020 2020 2020 2020  )..             
-00065480: 2020 2066 6f72 206a 2069 6e20 7261 6e67     for j in rang
-00065490: 6528 6e5f 636c 6173 7365 7329 3a0d 0a20  e(n_classes):.. 
-000654a0: 2020 2020 2020 2020 2020 2020 2020 2020                  
-000654b0: 2020 206d 6561 6e5f 7470 7220 2b3d 2069     mean_tpr += i
-000654c0: 6e74 6572 7028 616c 6c5f 6670 722c 2066  nterp(all_fpr, f
-000654d0: 7072 5b6a 5d2c 2074 7072 5b6a 5d29 0d0a  pr[j], tpr[j])..
-000654e0: 0d0a 2020 2020 2020 2020 2020 2020 2020  ..              
-000654f0: 2020 2320 4669 6e61 6c6c 7920 6176 6572    # Finally aver
-00065500: 6167 6520 6974 2061 6e64 2063 6f6d 7075  age it and compu
-00065510: 7465 2041 5543 0d0a 2020 2020 2020 2020  te AUC..        
-00065520: 2020 2020 2020 2020 6d65 616e 5f74 7072          mean_tpr
-00065530: 202f 3d20 6e5f 636c 6173 7365 730d 0a0d   /= n_classes...
-00065540: 0a20 2020 2020 2020 2020 2020 2020 2020  .               
-00065550: 2066 7072 5b22 6d61 6372 6f22 5d20 3d20   fpr["macro"] = 
-00065560: 616c 6c5f 6670 720d 0a20 2020 2020 2020  all_fpr..       
-00065570: 2020 2020 2020 2020 2074 7072 5b22 6d61           tpr["ma
-00065580: 6372 6f22 5d20 3d20 6d65 616e 5f74 7072  cro"] = mean_tpr
-00065590: 0d0a 2020 2020 2020 2020 2020 2020 2020  ..              
-000655a0: 2020 726f 635f 6175 635b 226d 6163 726f    roc_auc["macro
-000655b0: 225d 203d 2061 7563 2866 7072 5b22 6d61  "] = auc(fpr["ma
-000655c0: 6372 6f22 5d2c 2074 7072 5b22 6d61 6372  cro"], tpr["macr
-000655d0: 6f22 5d29 0d0a 0d0a 2020 2020 2020 2020  o"])....        
-000655e0: 2020 2020 2020 2020 2320 506c 6f74 2061          # Plot a
-000655f0: 6c6c 2052 4f43 2063 7572 7665 730d 0a20  ll ROC curves.. 
-00065600: 2020 2020 2020 2020 2020 2020 2020 206c                 l
-00065610: 7720 3d20 320d 0a20 2020 2020 2020 2020  w = 2..         
-00065620: 2020 2020 2020 2063 6f6c 6f72 203d 206e         color = n
-00065630: 6578 7428 636f 6c6f 7273 290d 0a20 2020  ext(colors)..   
-00065640: 2020 2020 2020 2020 2020 2020 2061 782e               ax.
-00065650: 706c 6f74 2866 7072 5b69 5d2c 2074 7072  plot(fpr[i], tpr
-00065660: 5b69 5d2c 2063 6f6c 6f72 3d63 6f6c 6f72  [i], color=color
-00065670: 2c20 6c77 3d6c 7729 0d0a 2020 2020 2020  , lw=lw)..      
-00065680: 2020 2020 2020 2020 2020 6c61 6265 6c73            labels
-00065690: 2e61 7070 656e 6428 2752 4f43 2063 7572  .append('ROC cur
-000656a0: 7665 206f 6620 636c 6173 7320 2564 2028  ve of class %d (
-000656b0: 6172 6561 203d 2025 302e 3266 2927 2025  area = %0.2f)' %
-000656c0: 2869 2c20 726f 635f 6175 635b 695d 2929  (i, roc_auc[i]))
-000656d0: 0d0a 2020 2020 2020 2020 2020 2020 7472  ..            tr
-000656e0: 793a 0d0a 2020 2020 2020 2020 2020 2020  y:..            
-000656f0: 2020 2020 6c61 6265 6c73 2e61 7070 656e      labels.appen
-00065700: 6428 276d 6963 726f 2d61 7665 7261 6765  d('micro-average
-00065710: 2052 4f43 2063 7572 7665 2028 6172 6561   ROC curve (area
-00065720: 203d 207b 303a 302e 3266 7d29 270d 0a20   = {0:0.2f})'.. 
-00065730: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00065740: 2020 2020 2020 2020 2020 2020 2020 2727                ''
-00065750: 2e66 6f72 6d61 7428 726f 635f 6175 635b  .format(roc_auc[
-00065760: 226d 6963 726f 225d 2929 0d0a 2020 2020  "micro"]))..    
-00065770: 2020 2020 2020 2020 2020 2020 6178 2e70              ax.p
-00065780: 6c6f 7428 6670 725b 226d 6963 726f 225d  lot(fpr["micro"]
-00065790: 2c20 7470 725b 226d 6963 726f 225d 2c0d  , tpr["micro"],.
-000657a0: 0a20 2020 2020 2020 2020 2020 2020 2020  .               
-000657b0: 2020 2020 2020 2020 2020 636f 6c6f 723d            color=
-000657c0: 2764 6565 7070 696e 6b27 2c20 6c69 6e65  'deeppink', line
-000657d0: 7374 796c 653d 273a 272c 206c 696e 6577  style=':', linew
-000657e0: 6964 7468 3d34 290d 0a20 2020 2020 2020  idth=4)..       
-000657f0: 2020 2020 2065 7863 6570 743a 0d0a 2020       except:..  
-00065800: 2020 2020 2020 2020 2020 2020 2020 7061                pa
-00065810: 7373 0d0a 2020 2020 2020 2020 2020 2020  ss..            
-00065820: 7472 793a 0d0a 2020 2020 2020 2020 2020  try:..          
-00065830: 2020 2020 2020 6c61 6265 6c73 2e61 7070        labels.app
-00065840: 656e 6428 276d 6163 726f 2d61 7665 7261  end('macro-avera
-00065850: 6765 2052 4f43 2063 7572 7665 2028 6172  ge ROC curve (ar
-00065860: 6561 203d 207b 303a 302e 3266 7d29 270d  ea = {0:0.2f})'.
-00065870: 0a20 2020 2020 2020 2020 2020 2020 2020  .               
-00065880: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00065890: 2727 2e66 6f72 6d61 7428 726f 635f 6175  ''.format(roc_au
-000658a0: 635b 226d 6163 726f 225d 2929 0d0a 2020  c["macro"]))..  
-000658b0: 2020 2020 2020 2020 2020 2020 2020 6178                ax
-000658c0: 2e70 6c6f 7428 6670 725b 226d 6163 726f  .plot(fpr["macro
-000658d0: 225d 2c20 7470 725b 226d 6163 726f 225d  "], tpr["macro"]
-000658e0: 2c0d 0a20 2020 2020 2020 2020 2020 2020  ,..             
-000658f0: 2020 2020 2020 2020 2020 2020 636f 6c6f              colo
-00065900: 723d 276e 6176 7927 2c20 6c69 6e65 7374  r='navy', linest
-00065910: 796c 653d 273a 272c 206c 696e 6577 6964  yle=':', linewid
-00065920: 7468 3d34 290d 0a20 2020 2020 2020 2020  th=4)..         
-00065930: 2020 2065 7863 6570 743a 0d0a 2020 2020     except:..    
-00065940: 2020 2020 2020 2020 2020 2020 7061 7373              pass
-00065950: 0d0a 2020 2020 2020 2020 2020 2020 6178  ..            ax
-00065960: 2e70 6c6f 7428 5b30 2c20 315d 2c20 5b30  .plot([0, 1], [0
-00065970: 2c20 315d 2c20 276b 2d2d 272c 206c 773d  , 1], 'k--', lw=
-00065980: 6c77 290d 0a20 2020 2020 2020 2020 2020  lw)..           
-00065990: 2061 782e 7365 745f 786c 696d 285b 302e   ax.set_xlim([0.
-000659a0: 302c 2031 2e30 5d29 0d0a 2020 2020 2020  0, 1.0])..      
-000659b0: 2020 2020 2020 6178 2e73 6574 5f79 6c69        ax.set_yli
-000659c0: 6d28 5b30 2e30 2c20 312e 3035 5d29 0d0a  m([0.0, 1.05])..
-000659d0: 2020 2020 2020 2020 2020 2020 6178 2e73              ax.s
-000659e0: 6574 5f78 6c61 6265 6c28 2746 616c 7365  et_xlabel('False
-000659f0: 2050 6f73 6974 6976 6520 5261 7465 2729   Positive Rate')
-00065a00: 0d0a 2020 2020 2020 2020 2020 2020 6178  ..            ax
-00065a10: 2e73 6574 5f79 6c61 6265 6c28 2754 7275  .set_ylabel('Tru
-00065a20: 6520 506f 7369 7469 7665 2052 6174 6527  e Positive Rate'
-00065a30: 290d 0a20 2020 2020 2020 2020 2020 2061  )..            a
-00065a40: 782e 7365 745f 7469 746c 6528 2752 4f43  x.set_title('ROC
-00065a50: 2043 7572 7665 2066 6f72 2050 7265 6469   Curve for Predi
-00065a60: 6374 696f 6e73 206f 6e20 6865 6c64 206f  ctions on held o
-00065a70: 7574 2064 6174 6120 666f 7220 7461 7267  ut data for targ
-00065a80: 6574 3a20 2573 2720 2574 6172 6729 0d0a  et: %s' %targ)..
-00065a90: 2020 2020 2020 2020 2020 2020 706c 742e              plt.
-00065aa0: 6c65 6765 6e64 286c 6162 656c 732c 6c6f  legend(labels,lo
-00065ab0: 633d 226c 6f77 6572 2072 6967 6874 2229  c="lower right")
-00065ac0: 0d0a 2020 2020 2020 2020 2020 2020 706c  ..            pl
-00065ad0: 742e 7368 6f77 2829 3b0d 0a0d 0a23 2323  t.show();....###
-00065ae0: 2323 2323 2323 2323 2323 2323 2323 2323  ################
-00065af0: 2323 2323 2323 2323 2323 2323 2323 2323  ################
-00065b00: 2323 2323 2323 2323 2323 2323 2323 2323  ################
-00065b10: 2323 2323 2323 2323 2323 2323 2323 2323  ################
-00065b20: 2323 2323 2323 2323 2323 2323 2323 2323  ################
-00065b30: 0d0a 2320 5265 6d6f 7665 7320 6475 706c  ..# Removes dupl
-00065b40: 6963 6174 6573 2066 726f 6d20 6120 6c69  icates from a li
-00065b50: 7374 2074 6f20 7265 7475 726e 2075 6e69  st to return uni
-00065b60: 7175 6520 7661 6c75 6573 202d 2055 5345  que values - USE
-00065b70: 4420 4f4e 4c59 4f4e 4345 0d0a 6465 6620  D ONLYONCE..def 
-00065b80: 6669 6e64 5f72 656d 6f76 655f 6475 706c  find_remove_dupl
-00065b90: 6963 6174 6573 2876 616c 7565 7329 3a0d  icates(values):.
-00065ba0: 0a20 2020 206f 7574 7075 7420 3d20 5b5d  .    output = []
-00065bb0: 0d0a 2020 2020 7365 656e 203d 2073 6574  ..    seen = set
-00065bc0: 2829 0d0a 2020 2020 666f 7220 7661 6c75  ()..    for valu
-00065bd0: 6520 696e 2076 616c 7565 733a 0d0a 2020  e in values:..  
-00065be0: 2020 2020 2020 6966 2076 616c 7565 206e        if value n
-00065bf0: 6f74 2069 6e20 7365 656e 3a0d 0a20 2020  ot in seen:..   
-00065c00: 2020 2020 2020 2020 206f 7574 7075 742e           output.
-00065c10: 6170 7065 6e64 2876 616c 7565 290d 0a20  append(value).. 
-00065c20: 2020 2020 2020 2020 2020 2073 6565 6e2e             seen.
-00065c30: 6164 6428 7661 6c75 6529 0d0a 2020 2020  add(value)..    
-00065c40: 7265 7475 726e 206f 7574 7075 740d 0a23  return output..#
-00065c50: 2323 2323 2323 2323 2323 2323 2323 2323  ################
-00065c60: 2323 2323 2323 2323 2323 2323 2323 2323  ################
-00065c70: 2323 2323 2323 2323 2323 2323 2323 2323  ################
-00065c80: 2323 2323 2323 2323 2323 2323 2323 2323  ################
-00065c90: 2323 2323 2323 2323 2323 2323 2323 2323  ################
-00065ca0: 2323 0d0a 6465 6620 7370 6c69 745f 6461  ##..def split_da
-00065cb0: 7461 5f6e 6577 2874 7261 696e 6669 6c65  ta_new(trainfile
-00065cc0: 2c20 7465 7374 6669 6c65 2c20 7461 7267  , testfile, targ
-00065cd0: 6574 2c73 6570 2c20 6d6f 6465 6c74 7970  et,sep, modeltyp
-00065ce0: 653d 2752 6567 7265 7373 696f 6e27 2c20  e='Regression', 
-00065cf0: 7261 6e64 6f6d 7374 6174 653d 3029 3a0d  randomstate=0):.
-00065d00: 0a20 2020 2022 2222 0d0a 2020 2020 5370  .    """..    Sp
-00065d10: 6c69 7420 796f 7572 2066 696c 6520 6f72  lit your file or
-00065d20: 2064 6174 6120 6672 616d 6520 696e 746f   data frame into
-00065d30: 2032 206f 7220 3320 7370 6c69 7473 2e20   2 or 3 splits. 
-00065d40: 5374 7261 7469 6669 6564 2062 7920 436c  Stratified by Cl
-00065d50: 6173 7320 6175 746f 6d61 7469 6361 6c6c  ass automaticall
-00065d60: 792e 0d0a 2020 2020 4164 6469 7469 6f6e  y...    Addition
-00065d70: 616c 6c79 2c20 6974 2077 696c 6c20 7374  ally, it will st
-00065d80: 7269 7020 6f75 7420 6e6f 6e2d 6e75 6d65  rip out non-nume
-00065d90: 7269 6320 636f 6c73 2069 6e20 796f 7572  ric cols in your
-00065da0: 2064 6174 6120 6966 2079 6f75 206e 6565   data if you nee
-00065db0: 6420 6974 2e0d 0a20 2020 2022 2222 0d0a  d it...    """..
-00065dc0: 2020 2020 7261 6e64 6f6d 7374 6174 6520      randomstate 
-00065dd0: 3d20 3939 0d0a 2020 2020 2323 2323 2323  = 99..    ######
-00065de0: 2320 436f 6465 735f 6c69 7374 2063 6f6e  # Codes_list con
-00065df0: 7461 696e 7320 6d75 6c74 6970 6c65 2065  tains multiple e
-00065e00: 6e63 6f64 6572 7320 7468 6174 2061 7265  ncoders that are
-00065e10: 2075 7365 6420 746f 206f 7065 6e20 6120   used to open a 
-00065e20: 4353 5620 6669 6c65 0d0a 2020 2020 636f  CSV file..    co
-00065e30: 6465 735f 6c69 7374 203d 205b 2775 7466  des_list = ['utf
-00065e40: 2d38 272c 2769 736f 2d38 3835 392d 3127  -8','iso-8859-1'
-00065e50: 2c27 6370 3132 3532 272c 276c 6174 696e  ,'cp1252','latin
-00065e60: 3127 5d0d 0a20 2020 2073 6565 6420 3d20  1']..    seed = 
-00065e70: 3939 0d0a 2020 2020 6966 2074 7970 6528  99..    if type(
-00065e80: 7472 6169 6e66 696c 6529 203d 3d20 7374  trainfile) == st
-00065e90: 723a 0d0a 2020 2020 2020 2020 6966 2074  r:..        if t
-00065ea0: 7261 696e 6669 6c65 2021 3d20 2727 3a0d  rainfile != '':.
-00065eb0: 0a20 2020 2020 2020 2020 2020 2023 2323  .            ###
-00065ec0: 2320 4669 7273 7420 6c6f 6164 2074 6865  # First load the
-00065ed0: 2054 7261 696e 2066 696c 6520 6966 2069   Train file if i
-00065ee0: 7420 6973 2061 7661 696c 6162 6c65 2023  t is available #
-00065ef0: 2323 2323 2323 2323 230d 0a20 2020 2020  #########..     
-00065f00: 2020 2020 2020 2066 6f72 2063 6f64 6578         for codex
-00065f10: 2069 6e20 636f 6465 735f 6c69 7374 3a0d   in codes_list:.
-00065f20: 0a20 2020 2020 2020 2020 2020 2020 2020  .               
-00065f30: 2074 7279 3a0d 0a20 2020 2020 2020 2020   try:..         
-00065f40: 2020 2020 2020 2020 2020 2074 7261 696e             train
-00065f50: 6466 203d 2070 642e 7265 6164 5f63 7376  df = pd.read_csv
-00065f60: 2874 7261 696e 6669 6c65 2c73 6570 3d73  (trainfile,sep=s
-00065f70: 6570 2c65 6e63 6f64 696e 673d 636f 6465  ep,encoding=code
-00065f80: 782c 696e 6465 785f 636f 6c3d 4e6f 6e65  x,index_col=None
-00065f90: 290d 0a20 2020 2020 2020 2020 2020 2020  )..             
-00065fa0: 2020 2020 2020 2062 7265 616b 0d0a 2020         break..  
-00065fb0: 2020 2020 2020 2020 2020 2020 2020 6578                ex
-00065fc0: 6365 7074 3a0d 0a20 2020 2020 2020 2020  cept:..         
-00065fd0: 2020 2020 2020 2020 2020 2063 6f6e 7469             conti
-00065fe0: 6e75 650d 0a20 2020 2020 2020 2020 2020  nue..           
-00065ff0: 2070 7269 6e74 2827 5472 6169 6e20 6461   print('Train da
-00066000: 7461 2067 6976 656e 2e20 5368 6170 6520  ta given. Shape 
-00066010: 3d20 2573 2720 2528 7472 6169 6e64 662e  = %s' %(traindf.
-00066020: 7368 6170 652c 2929 0d0a 2020 2020 2020  shape,))..      
-00066030: 2020 2020 2020 7072 696e 7428 2754 6172        print('Tar
-00066040: 6765 7420 526f 7773 2054 7261 696e 203d  get Rows Train =
-00066050: 2025 6427 2025 6c65 6e28 7472 6169 6e64   %d' %len(traind
-00066060: 665b 7472 6169 6e64 665b 7461 7267 6574  f[traindf[target
-00066070: 5d3d 3d31 5d29 290d 0a20 2020 2020 2020  ]==1]))..       
-00066080: 2065 6c73 653a 0d0a 2020 2020 2020 2020   else:..        
-00066090: 2020 2020 7072 696e 7428 2754 7261 696e      print('Train
-000660a0: 6669 6c65 2069 7320 6e6f 7420 666f 756e  file is not foun
-000660b0: 642e 2043 6865 636b 2079 6f75 7220 696e  d. Check your in
-000660c0: 7075 7420 6f72 2066 696c 6520 6465 7374  put or file dest
-000660d0: 696e 6174 696f 6e27 290d 0a20 2020 2020  ination')..     
-000660e0: 2020 2020 2020 2072 6574 7572 6e0d 0a20         return.. 
-000660f0: 2020 2020 2020 2069 6620 2074 7970 6528         if  type(
-00066100: 7465 7374 6669 6c65 2920 3d3d 2073 7472  testfile) == str
-00066110: 3a0d 0a20 2020 2020 2020 2020 2020 2069  :..            i
-00066120: 6620 7465 7374 6669 6c65 2021 3d20 2727  f testfile != ''
-00066130: 3a0d 0a20 2020 2020 2020 2020 2020 2020  :..             
-00066140: 2020 2070 7269 6e74 2827 5472 6169 6e20     print('Train 
-00066150: 6669 6c65 2061 6e64 2054 6573 7420 6669  file and Test fi
-00066160: 6c65 2067 6976 656e 2e27 290d 0a20 2020  le given.')..   
-00066170: 2020 2020 2020 2020 2020 2020 2023 2323               ###
-00066180: 2323 2320 4966 2074 6573 7466 696c 6520  ### If testfile 
-00066190: 6973 2061 7661 696c 6162 6c65 2c20 796f  is available, yo
-000661a0: 7520 6e65 6564 2074 6f20 636f 6d62 696e  u need to combin
-000661b0: 6520 7472 6169 6e20 616e 6420 7465 7374  e train and test
-000661c0: 2064 6174 6173 6574 730d 0a20 2020 2020   datasets..     
-000661d0: 2020 2020 2020 2020 2020 2070 7269 6e74             print
-000661e0: 2827 5472 6169 6e20 4461 7461 4672 616d  ('Train DataFram
-000661f0: 6520 616e 6420 5465 7374 6669 6c65 2067  e and Testfile g
-00066200: 6976 656e 2e27 290d 0a20 2020 2020 2020  iven.')..       
-00066210: 2020 2020 2020 2020 2066 6f72 2063 6f64           for cod
-00066220: 6578 2069 6e20 636f 6465 735f 6c69 7374  ex in codes_list
-00066230: 3a0d 0a20 2020 2020 2020 2020 2020 2020  :..             
-00066240: 2020 2020 2020 2074 7279 3a0d 0a20 2020         try:..   
-00066250: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00066260: 2020 2020 2074 6573 7464 6620 3d20 7064       testdf = pd
-00066270: 2e72 6561 645f 6373 7628 7465 7374 6669  .read_csv(testfi
-00066280: 6c65 2c73 6570 3d73 6570 2c65 6e63 6f64  le,sep=sep,encod
-00066290: 696e 673d 636f 6465 782c 696e 6465 785f  ing=codex,index_
-000662a0: 636f 6c3d 4e6f 6e65 290d 0a20 2020 2020  col=None)..     
-000662b0: 2020 2020 2020 2020 2020 2020 2020 2020                  
-000662c0: 2020 2062 7265 616b 0d0a 2020 2020 2020     break..      
-000662d0: 2020 2020 2020 2020 2020 2020 2020 6578                ex
-000662e0: 6365 7074 3a0d 0a20 2020 2020 2020 2020  cept:..         
-000662f0: 2020 2020 2020 2020 2020 2020 2020 2063                 c
-00066300: 6f6e 7469 6e75 650d 0a20 2020 2020 2020  ontinue..       
-00066310: 2020 2020 2020 2020 2070 7269 6e74 2827           print('
-00066320: 5465 7374 2064 6174 6120 6769 7665 6e2e  Test data given.
-00066330: 2053 6861 7065 203d 2025 7327 2025 2874   Shape = %s' %(t
-00066340: 6573 7464 662e 7368 6170 652c 2929 0d0a  estdf.shape,))..
-00066350: 2020 2020 2020 2020 2020 2020 656c 7365              else
-00066360: 3a0d 0a20 2020 2020 2020 2020 2020 2020  :..             
-00066370: 2020 2070 7269 6e74 2827 5465 7374 6669     print('Testfi
-00066380: 6c65 2069 7320 6e6f 7420 6769 7665 6e2e  le is not given.
-00066390: 2043 6f6e 7469 6e75 696e 6727 290d 0a20   Continuing').. 
-000663a0: 2020 2020 2020 2020 2020 2020 2020 2074                 t
-000663b0: 6573 7464 6620 3d20 2727 0d0a 2020 2020  estdf = ''..    
-000663c0: 2020 2020 656c 6966 2074 7970 6528 7465      elif type(te
-000663d0: 7374 6669 6c65 2920 3d3d 2070 642e 4461  stfile) == pd.Da
-000663e0: 7461 4672 616d 653a 0d0a 2020 2020 2020  taFrame:..      
-000663f0: 2020 2020 2020 7072 696e 7428 2754 7261        print('Tra
-00066400: 696e 2066 696c 6520 616e 6420 5465 7374  in file and Test
-00066410: 2064 6174 6166 7261 6d65 2067 6976 656e   dataframe given
-00066420: 2e27 290d 0a20 2020 2020 2020 2020 2020  .')..           
-00066430: 2074 6573 7464 6620 3d20 7465 7374 6669   testdf = testfi
-00066440: 6c65 5b3a 5d0d 0a20 2020 2020 2020 2065  le[:]..        e
-00066450: 6c73 653a 0d0a 2020 2020 2020 2020 2020  lse:..          
-00066460: 2020 7072 696e 7428 2754 6573 7466 696c    print('Testfil
-00066470: 6520 6973 2075 6e6b 6e6f 776e 2074 7970  e is unknown typ
-00066480: 652e 2729 0d0a 2020 2020 2020 2020 2020  e.')..          
-00066490: 2020 7465 7374 6466 203d 2027 270d 0a20    testdf = ''.. 
-000664a0: 2020 2065 6c69 6620 7479 7065 2874 7261     elif type(tra
-000664b0: 696e 6669 6c65 2920 3d3d 2070 642e 4461  infile) == pd.Da
-000664c0: 7461 4672 616d 653a 0d0a 2020 2020 2020  taFrame:..      
-000664d0: 2020 7472 6169 6e64 6620 3d20 7472 6169    traindf = trai
-000664e0: 6e66 696c 655b 3a5d 0d0a 2020 2020 2020  nfile[:]..      
-000664f0: 2020 6966 2020 7479 7065 2874 6573 7466    if  type(testf
-00066500: 696c 6529 203d 3d20 7374 723a 0d0a 2020  ile) == str:..  
-00066510: 2020 2020 2020 2020 2020 6966 2074 6573            if tes
-00066520: 7466 696c 6520 213d 2027 273a 0d0a 2020  tfile != '':..  
-00066530: 2020 2020 2020 2020 2020 2020 2020 7072                pr
-00066540: 696e 7428 2754 7261 696e 2044 6174 6146  int('Train DataF
-00066550: 7261 6d65 2061 6e64 2054 6573 7420 6669  rame and Test fi
-00066560: 6c65 2067 6976 656e 2e27 290d 0a20 2020  le given.')..   
-00066570: 2020 2020 2020 2020 2020 2020 2023 2323               ###
-00066580: 2323 2320 4966 2074 6573 7466 696c 6520  ### If testfile 
-00066590: 6973 2061 7661 696c 6162 6c65 2c20 796f  is available, yo
-000665a0: 7520 6e65 6564 2074 6f20 636f 6d62 696e  u need to combin
-000665b0: 6520 7472 6169 6e20 616e 6420 7465 7374  e train and test
-000665c0: 2064 6174 6173 6574 730d 0a20 2020 2020   datasets..     
-000665d0: 2020 2020 2020 2020 2020 2070 7269 6e74             print
-000665e0: 2827 5472 6169 6e20 4461 7461 4672 616d  ('Train DataFram
-000665f0: 6520 616e 6420 5465 7374 6669 6c65 2067  e and Testfile g
-00066600: 6976 656e 2e27 290d 0a20 2020 2020 2020  iven.')..       
-00066610: 2020 2020 2020 2020 2066 6f72 2063 6f64           for cod
-00066620: 6578 2069 6e20 636f 6465 735f 6c69 7374  ex in codes_list
-00066630: 3a0d 0a20 2020 2020 2020 2020 2020 2020  :..             
-00066640: 2020 2020 2020 2074 7279 3a0d 0a20 2020         try:..   
-00066650: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00066660: 2020 2020 2074 6573 7464 6620 3d20 7064       testdf = pd
-00066670: 2e72 6561 645f 6373 7628 7465 7374 6669  .read_csv(testfi
-00066680: 6c65 2c73 6570 3d73 6570 2c65 6e63 6f64  le,sep=sep,encod
-00066690: 696e 673d 636f 6465 782c 696e 6465 785f  ing=codex,index_
-000666a0: 636f 6c3d 4e6f 6e65 290d 0a20 2020 2020  col=None)..     
-000666b0: 2020 2020 2020 2020 2020 2020 2020 2020                  
-000666c0: 2020 2062 7265 616b 0d0a 2020 2020 2020     break..      
-000666d0: 2020 2020 2020 2020 2020 2020 2020 6578                ex
-000666e0: 6365 7074 3a0d 0a20 2020 2020 2020 2020  cept:..         
-000666f0: 2020 2020 2020 2020 2020 2020 2020 2063                 c
-00066700: 6f6e 7469 6e75 650d 0a20 2020 2020 2020  ontinue..       
-00066710: 2020 2020 2020 2020 2070 7269 6e74 2827           print('
-00066720: 5472 6169 6e20 5368 6170 653a 2573 2054  Train Shape:%s T
-00066730: 6573 7420 5368 6170 653a 2025 7327 2025  est Shape: %s' %
-00066740: 2874 7261 696e 6466 2e73 6861 7065 2c74  (traindf.shape,t
-00066750: 6573 7464 662e 7368 6170 6529 290d 0a20  estdf.shape)).. 
-00066760: 2020 2020 2020 2020 2020 2065 6c73 653a             else:
-00066770: 0d0a 2020 2020 2020 2020 2020 2020 2020  ..              
-00066780: 2020 7072 696e 7428 274e 6f20 7465 7374    print('No test
-00066790: 6669 6c65 2e20 5472 6169 6e20 5368 6170  file. Train Shap
-000667a0: 653a 2573 2720 2528 7472 6169 6e64 662e  e:%s' %(traindf.
-000667b0: 7368 6170 652c 2929 0d0a 2020 2020 2020  shape,))..      
-000667c0: 2020 2020 2020 2020 2020 7465 7374 6466            testdf
-000667d0: 203d 2027 270d 0a20 2020 2020 2020 2065   = ''..        e
-000667e0: 6c69 6620 7479 7065 2874 6573 7466 696c  lif type(testfil
-000667f0: 6529 203d 3d20 7064 2e44 6174 6146 7261  e) == pd.DataFra
-00066800: 6d65 3a0d 0a20 2020 2020 2020 2020 2020  me:..           
-00066810: 2070 7269 6e74 2827 5472 6169 6e20 4461   print('Train Da
-00066820: 7461 4672 616d 6520 616e 6420 5465 7374  taFrame and Test
-00066830: 2044 6174 6146 7261 6d65 2067 6976 656e   DataFrame given
-00066840: 2e27 290d 0a20 2020 2020 2020 2020 2020  .')..           
-00066850: 2074 6573 7464 6620 3d20 7465 7374 6669   testdf = testfi
-00066860: 6c65 5b3a 5d0d 0a20 2020 2065 6c73 653a  le[:]..    else:
-00066870: 0d0a 2020 2020 2020 2020 7072 696e 7428  ..        print(
-00066880: 274e 6f20 5472 6169 6e20 6f72 2054 6573  'No Train or Tes
-00066890: 7420 6669 6c65 2070 726f 7669 6465 642e  t file provided.
-000668a0: 2045 6e64 2e2e 2e27 290d 0a20 2020 2020   End...')..     
-000668b0: 2020 2072 6574 7572 6e0d 0a20 2020 2023     return..    #
-000668c0: 2323 2323 2323 2320 5468 6973 2069 7320  ####### This is 
-000668d0: 7768 6572 6520 7468 6520 7370 6c69 7474  where the splitt
-000668e0: 696e 6720 6265 6769 6e73 2023 2323 2323  ing begins #####
-000668f0: 2323 2323 2323 2323 2323 2323 0d0a 2020  ############..  
-00066900: 2020 6966 2074 6172 6765 7420 3d3d 2027    if target == '
-00066910: 273a 0d0a 2020 2020 2020 2020 7072 696e  ':..        prin
-00066920: 7428 274e 6f20 7461 7267 6574 2076 6172  t('No target var
-00066930: 6961 626c 6520 7072 6f76 6964 6564 2e20  iable provided. 
-00066940: 506c 6561 7365 2070 726f 7669 6465 2074  Please provide t
-00066950: 6172 6765 7420 7661 7269 6162 6c65 2729  arget variable')
-00066960: 0d0a 2020 2020 2020 2020 7265 7475 726e  ..        return
-00066970: 2074 7261 696e 6466 2c20 4e6f 6e65 2c20   traindf, None, 
-00066980: 4e6f 6e65 0d0a 2020 2020 656c 7365 3a0d  None..    else:.
-00066990: 0a20 2020 2020 2020 2079 203d 2074 7261  .        y = tra
-000669a0: 696e 6466 5b74 6172 6765 745d 0d0a 2020  indf[target]..  
-000669b0: 2020 6966 206d 6f64 656c 7479 7065 203d    if modeltype =
-000669c0: 3d20 2743 6c61 7373 6966 6963 6174 696f  = 'Classificatio
-000669d0: 6e27 3a0d 0a20 2020 2020 2020 2069 6620  n':..        if 
-000669e0: 7472 6169 6e64 662e 7368 6170 655b 305d  traindf.shape[0]
-000669f0: 203c 3d20 3130 3030 3a0d 0a20 2020 2020   <= 1000:..     
-00066a00: 2020 2020 2020 2073 7373 203d 2053 7472         sss = Str
-00066a10: 6174 6966 6965 6453 6875 6666 6c65 5370  atifiedShuffleSp
-00066a20: 6c69 7428 6e5f 7370 6c69 7473 3d32 2c20  lit(n_splits=2, 
-00066a30: 7465 7374 5f73 697a 653d 302e 3330 2c20  test_size=0.30, 
-00066a40: 7261 6e64 6f6d 5f73 7461 7465 3d72 616e  random_state=ran
-00066a50: 646f 6d73 7461 7465 290d 0a20 2020 2020  domstate)..     
-00066a60: 2020 2065 6c73 653a 0d0a 2020 2020 2020     else:..      
-00066a70: 2020 2020 2020 7373 7320 3d20 5374 7261        sss = Stra
-00066a80: 7469 6669 6564 5368 7566 666c 6553 706c  tifiedShuffleSpl
-00066a90: 6974 286e 5f73 706c 6974 733d 322c 2074  it(n_splits=2, t
-00066aa0: 6573 745f 7369 7a65 3d30 2e32 302c 2072  est_size=0.20, r
-00066ab0: 616e 646f 6d5f 7374 6174 653d 7261 6e64  andom_state=rand
-00066ac0: 6f6d 7374 6174 6529 0d0a 2020 2020 656c  omstate)..    el
-00066ad0: 7365 3a0d 0a20 2020 2020 2020 2069 6e64  se:..        ind
-00066ae0: 6963 6573 203d 206e 702e 7261 6e64 6f6d  ices = np.random
-00066af0: 2e70 6572 6d75 7461 7469 6f6e 2874 7261  .permutation(tra
-00066b00: 696e 6466 2e73 6861 7065 5b30 5d29 0d0a  indf.shape[0])..
-00066b10: 2020 2020 2020 2020 7472 6169 6e5f 726f          train_ro
-00066b20: 7773 203d 2069 6e74 2830 2e38 2a74 7261  ws = int(0.8*tra
-00066b30: 696e 6466 2e73 6861 7065 5b30 5d29 0d0a  indf.shape[0])..
-00066b40: 2020 2020 7072 6564 6963 746f 7273 203d      predictors =
-00066b50: 205b 7820 666f 7220 7820 696e 2074 7261   [x for x in tra
-00066b60: 696e 6466 2069 6620 7820 6e6f 7420 696e  indf if x not in
-00066b70: 2074 6172 6765 745d 0d0a 2020 2020 2323   target]..    ##
-00066b80: 2323 2320 7365 6c65 6374 206f 6e6c 7920  ### select only 
-00066b90: 7374 7269 6e67 2063 6f6c 756d 6e73 2066  string columns f
-00066ba0: 726f 6d20 7468 6520 7472 6169 6e20 6461  rom the train da
-00066bb0: 7461 0d0a 2020 2020 636f 6c73 203d 2063  ta..    cols = c
-00066bc0: 6f70 792e 6465 6570 636f 7079 2870 7265  opy.deepcopy(pre
-00066bd0: 6469 6374 6f72 7329 0d0a 2020 2020 2363  dictors)..    #c
-00066be0: 6f6c 7320 3d20 7365 6c65 6374 5f6e 756d  ols = select_num
-00066bf0: 5f63 6f6c 756d 6e73 2874 7261 696e 6466  _columns(traindf
-00066c00: 5b70 7265 6469 6374 6f72 735d 292e 636f  [predictors]).co
-00066c10: 6c75 6d6e 732e 746f 6c69 7374 2829 0d0a  lumns.tolist()..
-00066c20: 2020 2020 7472 6169 6e64 6620 3d20 7472      traindf = tr
-00066c30: 6169 6e64 665b 636f 6c73 2b5b 7461 7267  aindf[cols+[targ
-00066c40: 6574 5d5d 0d0a 2020 2020 5820 3d20 7472  et]]..    X = tr
-00066c50: 6169 6e64 665b 636f 6c73 5d0d 0a20 2020  aindf[cols]..   
-00066c60: 2069 6620 7479 7065 2874 6573 7464 6629   if type(testdf)
-00066c70: 203d 3d20 7374 723a 0d0a 2020 2020 2020   == str:..      
-00066c80: 2020 2323 2323 2049 6620 6e6f 2074 6573    #### If no tes
-00066c90: 7420 4461 7461 4672 616d 6520 6973 2067  t DataFrame is g
-00066ca0: 6976 656e 2c20 7468 656e 2073 706c 6974  iven, then split
-00066cb0: 2074 6865 2074 7261 696e 2064 6174 6120   the train data 
-00066cc0: 696e 746f 2074 7261 696e 2c20 6376 2061  into train, cv a
-00066cd0: 6e64 2074 6573 7420 6461 7461 2023 2323  nd test data ###
-00066ce0: 2323 2323 0d0a 2020 2020 2020 2020 6966  ####..        if
-00066cf0: 206d 6f64 656c 7479 7065 203d 3d20 2743   modeltype == 'C
-00066d00: 6c61 7373 6966 6963 6174 696f 6e27 3a0d  lassification':.
-00066d10: 0a20 2020 2020 2020 2020 2020 2074 7261  .            tra
-00066d20: 696e 696e 6465 782c 2074 6573 7469 6e64  inindex, testind
-00066d30: 6578 203d 2073 7373 2e73 706c 6974 2858  ex = sss.split(X
-00066d40: 2c20 7929 0d0a 2020 2020 2020 2020 2020  , y)..          
-00066d50: 2020 7472 6164 6174 6120 3d20 7472 6169    tradata = trai
-00066d60: 6e64 662e 696c 6f63 5b74 7261 696e 696e  ndf.iloc[trainin
-00066d70: 6465 785b 305d 5d0d 0a20 2020 2020 2020  dex[0]]..       
-00066d80: 2020 2020 2074 7364 6174 6120 3d20 7472       tsdata = tr
-00066d90: 6169 6e64 662e 696c 6f63 5b74 7261 696e  aindf.iloc[train
-00066da0: 696e 6465 785b 315d 5d0d 0a20 2020 2020  index[1]]..     
-00066db0: 2020 2065 6c73 653a 0d0a 2020 2020 2020     else:..      
-00066dc0: 2020 2020 2020 7472 6169 6e69 6e67 5f69        training_i
-00066dd0: 6478 2c20 7465 7374 5f69 6478 203d 2069  dx, test_idx = i
-00066de0: 6e64 6963 6573 5b3a 7472 6169 6e5f 726f  ndices[:train_ro
-00066df0: 7773 5d2c 2069 6e64 6963 6573 5b74 7261  ws], indices[tra
-00066e00: 696e 5f72 6f77 733a 5d0d 0a20 2020 2020  in_rows:]..     
-00066e10: 2020 2020 2020 2074 7261 6461 7461 2c20         tradata, 
-00066e20: 7473 6461 7461 203d 2074 7261 696e 6466  tsdata = traindf
-00066e30: 2e69 6c6f 635b 7472 6169 6e69 6e67 5f69  .iloc[training_i
-00066e40: 6478 5d2c 2074 7261 696e 6466 2e69 6c6f  dx], traindf.ilo
-00066e50: 635b 7465 7374 5f69 6478 5d0d 0a20 2020  c[test_idx]..   
-00066e60: 2020 2020 2023 2323 2323 2323 2323 2323       ###########
-00066e70: 2323 2323 2323 2323 2323 2020 2020 4352  ##########    CR
-00066e80: 4f53 5320 5641 4c49 4441 5449 4f4e 2050  OSS VALIDATION P
-00066e90: 4f52 5449 4f4e 2020 2323 2323 2323 2323  ORTION  ########
-00066ea0: 2323 2323 2323 2323 2323 2323 2323 230d  ###############.
-00066eb0: 0a20 2020 2020 2020 2058 203d 2074 7364  .        X = tsd
-00066ec0: 6174 615b 636f 6c73 5d0d 0a20 2020 2020  ata[cols]..     
-00066ed0: 2020 2079 203d 2074 7364 6174 615b 7461     y = tsdata[ta
-00066ee0: 7267 6574 5d0d 0a20 2020 2020 2020 2069  rget]..        i
-00066ef0: 6620 6d6f 6465 6c74 7970 6520 3d3d 2027  f modeltype == '
-00066f00: 436c 6173 7369 6669 6361 7469 6f6e 273a  Classification':
-00066f10: 0d0a 2020 2020 2020 2020 2020 2020 7373  ..            ss
-00066f20: 7320 3d20 5374 7261 7469 6669 6564 5368  s = StratifiedSh
-00066f30: 7566 666c 6553 706c 6974 286e 5f73 706c  uffleSplit(n_spl
-00066f40: 6974 733d 322c 2074 6573 745f 7369 7a65  its=2, test_size
-00066f50: 3d30 2e34 302c 2072 616e 646f 6d5f 7374  =0.40, random_st
-00066f60: 6174 653d 7261 6e64 6f6d 7374 6174 6529  ate=randomstate)
-00066f70: 0d0a 2020 2020 2020 2020 2020 2020 6376  ..            cv
-00066f80: 696e 6465 782c 2074 735f 696e 6465 7820  index, ts_index 
-00066f90: 3d20 7373 732e 7370 6c69 7428 582c 2079  = sss.split(X, y
-00066fa0: 290d 0a20 2020 2020 2020 2020 2020 2063  )..            c
-00066fb0: 7664 6174 6120 3d20 7473 6461 7461 2e69  vdata = tsdata.i
-00066fc0: 6c6f 635b 6376 696e 6465 785b 305d 5d0d  loc[cvindex[0]].
-00066fd0: 0a20 2020 2020 2020 2020 2020 2074 7364  .            tsd
-00066fe0: 6174 6120 3d20 7473 6461 7461 2e69 6c6f  ata = tsdata.ilo
-00066ff0: 635b 6376 696e 6465 785b 315d 5d0d 0a20  c[cvindex[1]].. 
-00067000: 2020 2020 2020 2065 6c73 653a 0d0a 2020         else:..  
-00067010: 2020 2020 2020 2020 2020 696e 6469 6365            indice
-00067020: 7320 3d20 6e70 2e72 616e 646f 6d2e 7065  s = np.random.pe
-00067030: 726d 7574 6174 696f 6e28 7473 6461 7461  rmutation(tsdata
-00067040: 2e73 6861 7065 5b30 5d29 0d0a 2020 2020  .shape[0])..    
-00067050: 2020 2020 2020 2020 7472 6169 6e5f 726f          train_ro
-00067060: 7773 203d 2069 6e74 2830 2e34 2a74 7364  ws = int(0.4*tsd
-00067070: 6174 612e 7368 6170 655b 305d 290d 0a20  ata.shape[0]).. 
-00067080: 2020 2020 2020 2020 2020 2074 7261 696e             train
-00067090: 696e 675f 6964 782c 2074 6573 745f 6964  ing_idx, test_id
-000670a0: 7820 3d20 696e 6469 6365 735b 3a74 7261  x = indices[:tra
-000670b0: 696e 5f72 6f77 735d 2c20 696e 6469 6365  in_rows], indice
-000670c0: 735b 7472 6169 6e5f 726f 7773 3a5d 0d0a  s[train_rows:]..
-000670d0: 2020 2020 2020 2020 2020 2020 6376 6461              cvda
-000670e0: 7461 2c20 7473 6461 7461 203d 2074 7364  ta, tsdata = tsd
-000670f0: 6174 612e 696c 6f63 5b74 7261 696e 696e  ata.iloc[trainin
-00067100: 675f 6964 785d 2c20 7473 6461 7461 2e69  g_idx], tsdata.i
-00067110: 6c6f 635b 7465 7374 5f69 6478 5d0d 0a20  loc[test_idx].. 
-00067120: 2020 2020 2020 2072 6574 7572 6e20 7472         return tr
-00067130: 6164 6174 612c 2063 7664 6174 612c 2074  adata, cvdata, t
-00067140: 7364 6174 612c 2063 6f6c 730d 0a20 2020  sdata, cols..   
-00067150: 2065 6c73 653a 0d0a 2020 2020 2020 2020   else:..        
-00067160: 2323 2323 2323 2320 4966 2054 6573 7420  ####### If Test 
-00067170: 4461 7461 4672 616d 6520 6973 2067 6976  DataFrame is giv
-00067180: 656e 2074 6865 6e20 6b65 6570 2074 6861  en then keep tha
-00067190: 7420 6173 2074 7364 6174 6120 2323 2323  t as tsdata ####
-000671a0: 2323 2323 0d0a 2020 2020 2020 2020 6966  ####..        if
-000671b0: 206d 6f64 656c 7479 7065 203d 3d20 2743   modeltype == 'C
-000671c0: 6c61 7373 6966 6963 6174 696f 6e27 3a0d  lassification':.
-000671d0: 0a20 2020 2020 2020 2020 2020 2074 7261  .            tra
-000671e0: 696e 696e 6465 782c 2074 6573 7469 6e64  inindex, testind
-000671f0: 6578 203d 2073 7373 2e73 706c 6974 2858  ex = sss.split(X
-00067200: 2c20 7929 0d0a 2020 2020 2020 2020 2020  , y)..          
-00067210: 2020 7472 6164 6174 6120 3d20 7472 6169    tradata = trai
-00067220: 6e64 662e 696c 6f63 5b74 7261 696e 696e  ndf.iloc[trainin
-00067230: 6465 785b 305d 5d0d 0a20 2020 2020 2020  dex[0]]..       
-00067240: 2020 2020 2063 7664 6174 6120 3d20 7472       cvdata = tr
-00067250: 6169 6e64 662e 696c 6f63 5b74 7261 696e  aindf.iloc[train
-00067260: 696e 6465 785b 315d 5d0d 0a20 2020 2020  index[1]]..     
-00067270: 2020 2020 2020 2074 7279 3a0d 0a20 2020         try:..   
-00067280: 2020 2020 2020 2020 2020 2020 2069 6620               if 
-00067290: 6c65 6e28 7465 7374 6466 5b74 6172 6765  len(testdf[targe
-000672a0: 745d 2e76 616c 7565 5f63 6f75 6e74 7328  t].value_counts(
-000672b0: 2920 3e3d 2032 293a 0d0a 2020 2020 2020  ) >= 2):..      
-000672c0: 2020 2020 2020 2020 2020 2020 2020 7072                pr
-000672d0: 696e 7428 2720 2020 204e 756d 6265 7220  int('    Number 
-000672e0: 6f66 2054 6172 6765 7420 526f 7773 2069  of Target Rows i
-000672f0: 6e20 5465 7374 2044 6174 613a 2025 6427  n Test Data: %d'
-00067300: 2025 6c65 6e28 7465 7374 6466 5b74 6573   %len(testdf[tes
-00067310: 7464 665b 7461 7267 6574 5d3d 3d31 5d29  tdf[target]==1])
-00067320: 290d 0a20 2020 2020 2020 2020 2020 2020  )..             
-00067330: 2020 2020 2020 2074 7364 6174 6120 3d20         tsdata = 
-00067340: 7465 7374 6466 5b3a 5d0d 0a20 2020 2020  testdf[:]..     
-00067350: 2020 2020 2020 2020 2020 2065 6c73 653a             else:
-00067360: 0d0a 2020 2020 2020 2020 2020 2020 2020  ..              
-00067370: 2020 2020 2020 7072 696e 7428 2720 2020        print('   
-00067380: 2054 6573 7420 6461 7461 2068 6173 2073   Test data has s
-00067390: 696e 676c 6520 636c 6173 732e 204f 7665  ingle class. Ove
-000673a0: 7277 7269 7469 6e67 2070 7265 6469 6374  rwriting predict
-000673b0: 696f 6e73 206f 6e20 5465 7374 2054 6172  ions on Test Tar
-000673c0: 6765 7420 636f 6c75 6d6e 2e27 290d 0a20  get column.').. 
-000673d0: 2020 2020 2020 2020 2020 2020 2020 2020                  
-000673e0: 2020 2070 7265 6469 6374 6f72 7320 3d20     predictors = 
-000673f0: 5b78 2066 6f72 2078 2069 6e20 6c69 7374  [x for x in list
-00067400: 2874 7261 696e 6466 2920 6966 2078 206e  (traindf) if x n
-00067410: 6f74 2069 6e20 7461 7267 6574 5d0d 0a20  ot in target].. 
-00067420: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00067430: 2020 2074 7364 6174 6120 3d20 7465 7374     tsdata = test
-00067440: 6466 5b3a 5d0d 0a20 2020 2020 2020 2020  df[:]..         
-00067450: 2020 2065 7863 6570 743a 0d0a 2020 2020     except:..    
-00067460: 2020 2020 2020 2020 2020 2020 7072 696e              prin
-00067470: 7428 2720 2020 204e 6f20 5461 7267 6574  t('    No Target
-00067480: 2063 6f6c 756d 6e20 696e 2054 6573 7420   column in Test 
-00067490: 6461 7461 2729 0d0a 2020 2020 2020 2020  data')..        
-000674a0: 2020 2020 2020 2020 7465 7374 6466 5b74          testdf[t
-000674b0: 6172 6765 745d 203d 2030 0d0a 2020 2020  arget] = 0..    
-000674c0: 2020 2020 2020 2020 2020 2020 7473 6461              tsda
-000674d0: 7461 203d 2074 6573 7464 665b 636f 6c73  ta = testdf[cols
-000674e0: 2b5b 7461 7267 6574 5d5d 0d0a 2020 2020  +[target]]..    
-000674f0: 2020 2020 656c 7365 3a0d 0a20 2020 2020      else:..     
-00067500: 2020 2020 2020 2069 6e64 6963 6573 203d         indices =
-00067510: 206e 702e 7261 6e64 6f6d 2e70 6572 6d75   np.random.permu
-00067520: 7461 7469 6f6e 2874 7261 696e 6466 2e73  tation(traindf.s
-00067530: 6861 7065 5b30 5d29 0d0a 2020 2020 2020  hape[0])..      
-00067540: 2020 2020 2020 7472 6169 6e5f 726f 7773        train_rows
-00067550: 203d 2069 6e74 2830 2e38 2a74 7261 696e   = int(0.8*train
-00067560: 6466 2e73 6861 7065 5b30 5d29 0d0a 2020  df.shape[0])..  
-00067570: 2020 2020 2020 2020 2020 7472 6169 6e69            traini
-00067580: 6e67 5f69 6478 2c20 7465 7374 5f69 6478  ng_idx, test_idx
-00067590: 203d 2069 6e64 6963 6573 5b3a 7472 6169   = indices[:trai
-000675a0: 6e5f 726f 7773 5d2c 2069 6e64 6963 6573  n_rows], indices
-000675b0: 5b74 7261 696e 5f72 6f77 733a 5d0d 0a20  [train_rows:].. 
-000675c0: 2020 2020 2020 2020 2020 2074 7261 6461             trada
-000675d0: 7461 2c20 6376 6461 7461 203d 2074 7261  ta, cvdata = tra
-000675e0: 696e 6466 2e69 6c6f 635b 7472 6169 6e69  indf.iloc[traini
-000675f0: 6e67 5f69 6478 5d2c 2074 7261 696e 6466  ng_idx], traindf
-00067600: 2e69 6c6f 635b 7465 7374 5f69 6478 5d0d  .iloc[test_idx].
-00067610: 0a20 2020 2020 2020 2020 2020 2074 7364  .            tsd
-00067620: 6174 6120 3d20 7465 7374 6466 5b3a 5d0d  ata = testdf[:].
-00067630: 0a20 2020 2020 2020 2072 6574 7572 6e20  .        return 
-00067640: 7472 6164 6174 612c 2063 7664 6174 612c  tradata, cvdata,
-00067650: 2074 7364 6174 612c 2063 6f6c 730d 0a23   tsdata, cols..#
-00067660: 2323 2323 2323 2323 2323 2323 2323 2323  ################
-00067670: 2323 2323 2323 2323 2323 2323 2323 2323  ################
-00067680: 2323 2323 2323 2323 2323 2323 2323 2323  ################
-00067690: 2323 2323 2323 2323 2323 2323 2323 2323  ################
-000676a0: 2323 2323 2323 2323 2323 230d 0a64 6566  ###########..def
-000676b0: 2066 696c 6c69 6e67 5f6d 6973 7369 6e67   filling_missing
-000676c0: 5f76 616c 7565 735f 7369 6d70 6c65 2874  _values_simple(t
-000676d0: 7261 696e 2c20 7465 7374 2c20 6361 7473  rain, test, cats
-000676e0: 2c20 6e75 6d73 293a 0d0a 2020 2020 2323  , nums):..    ##
-000676f0: 2323 2069 6620 796f 7520 7761 6e74 2074  ## if you want t
-00067700: 6f20 6669 6c6c 206d 6973 7369 6e67 2076  o fill missing v
-00067710: 616c 7565 7320 7573 696e 6720 6d65 616e  alues using mean
-00067720: 2c20 6d65 6469 616e 206d 6f64 652c 2067  , median mode, g
-00067730: 6f20 6168 6561 6421 0d0a 2020 2020 2323  o ahead!..    ##
-00067740: 2323 2020 4920 646f 6e27 7420 7265 636f  ##  I don't reco
-00067750: 6d6d 656e 6420 4275 7420 736f 6d65 2070  mmend But some p
-00067760: 656f 706c 6520 7365 656d 2074 6f20 6c69  eople seem to li
-00067770: 6b65 2069 742e 2023 2323 2323 0d0a 2020  ke it. #####..  
-00067780: 2020 666f 7220 7661 726d 2069 6e20 6361    for varm in ca
-00067790: 7473 3a0d 0a20 2020 2020 2020 2069 6620  ts:..        if 
-000677a0: 7472 6169 6e5b 7661 726d 5d2e 6973 6e75  train[varm].isnu
-000677b0: 6c6c 2829 2e73 756d 2829 203e 2030 3a0d  ll().sum() > 0:.
-000677c0: 0a20 2020 2020 2020 2020 2020 2066 696c  .            fil
-000677d0: 6c6e 756d 203d 2074 7261 696e 5b76 6172  lnum = train[var
-000677e0: 6d5d 2e6d 6f64 6528 295b 305d 0d0a 2020  m].mode()[0]..  
-000677f0: 2020 2020 2020 2020 2020 2323 2320 5265            ### Re
-00067800: 6d65 6d62 6572 2074 6861 7420 6669 6c6c  member that fill
-00067810: 6e61 206f 6e6c 7920 776f 726b 7320 6174  na only works at
-00067820: 2064 6174 6166 7261 6d65 206c 6576 656c   dataframe level
-00067830: 2120 2323 230d 0a20 2020 2020 2020 2020  ! ###..         
-00067840: 2020 2074 7261 696e 5b5b 7661 726d 5d5d     train[[varm]]
-00067850: 203d 2074 7261 696e 5b5b 7661 726d 5d5d   = train[[varm]]
-00067860: 2e66 696c 6c6e 6128 6669 6c6c 6e75 6d29  .fillna(fillnum)
-00067870: 0d0a 2020 2020 2020 2020 2020 2020 6966  ..            if
-00067880: 206e 6f74 2069 7369 6e73 7461 6e63 6528   not isinstance(
-00067890: 7465 7374 2c20 7374 7229 3a0d 0a20 2020  test, str):..   
-000678a0: 2020 2020 2020 2020 2020 2020 2069 6620               if 
-000678b0: 7465 7374 5b76 6172 6d5d 2e69 736e 756c  test[varm].isnul
-000678c0: 6c28 292e 7375 6d28 2920 3e20 303a 0d0a  l().sum() > 0:..
-000678d0: 2020 2020 2020 2020 2020 2020 2020 2020                  
-000678e0: 2020 2020 2323 2320 5265 6d65 6d62 6572      ### Remember
-000678f0: 2074 6861 7420 6669 6c6c 6e61 206f 6e6c   that fillna onl
-00067900: 7920 776f 726b 7320 6174 2064 6174 6166  y works at dataf
-00067910: 7261 6d65 206c 6576 656c 2120 2323 230d  rame level! ###.
-00067920: 0a20 2020 2020 2020 2020 2020 2020 2020  .               
-00067930: 2020 2020 2074 6573 745b 5b76 6172 6d5d       test[[varm]
-00067940: 5d20 3d20 7465 7374 5b5b 7661 726d 5d5d  ] = test[[varm]]
-00067950: 2e66 696c 6c6e 6128 6669 6c6c 6e75 6d29  .fillna(fillnum)
-00067960: 0d0a 2020 2020 666f 7220 6e75 6d20 696e  ..    for num in
-00067970: 206e 756d 733a 0d0a 2020 2020 2020 2020   nums:..        
-00067980: 6966 2074 7261 696e 5b76 6172 6d5d 2e69  if train[varm].i
-00067990: 736e 756c 6c28 292e 7375 6d28 2920 3e20  snull().sum() > 
-000679a0: 303a 0d0a 2020 2020 2020 2020 2020 2020  0:..            
-000679b0: 6669 6c6c 6e75 6d20 3d20 7472 6169 6e5b  fillnum = train[
-000679c0: 6e75 6d5d 2e6d 6561 6e28 290d 0a20 2020  num].mean()..   
-000679d0: 2020 2020 2020 2020 2023 2323 2052 656d           ### Rem
-000679e0: 656d 6265 7220 7468 6174 2066 696c 6c6e  ember that filln
-000679f0: 6120 6f6e 6c79 2077 6f72 6b73 2061 7420  a only works at 
-00067a00: 6461 7461 6672 616d 6520 6c65 7665 6c21  dataframe level!
-00067a10: 2023 2323 0d0a 2020 2020 2020 2020 2020   ###..          
-00067a20: 2020 7472 6169 6e5b 5b6e 756d 5d5d 203d    train[[num]] =
-00067a30: 2074 7261 696e 5b5b 6e75 6d5d 5d2e 6669   train[[num]].fi
-00067a40: 6c6c 6e61 2866 696c 6c6e 756d 290d 0a20  llna(fillnum).. 
-00067a50: 2020 2020 2020 2020 2020 2069 6620 6e6f             if no
-00067a60: 7420 6973 696e 7374 616e 6365 2874 6573  t isinstance(tes
-00067a70: 742c 2073 7472 293a 0d0a 2020 2020 2020  t, str):..      
-00067a80: 2020 2020 2020 2020 2020 6966 2074 6573            if tes
-00067a90: 745b 7661 726d 5d2e 6973 6e75 6c6c 2829  t[varm].isnull()
-00067aa0: 2e73 756d 2829 203e 2030 3a0d 0a20 2020  .sum() > 0:..   
+00062970: 2323 2323 2323 2323 2323 2323 2323 2323  ################
+00062980: 2323 2323 2323 2323 2323 2323 2323 2323  ################
+00062990: 0d0a 2020 2020 2020 2020 7072 696e 7428  ..        print(
+000629a0: 2742 7569 6c64 696e 6720 436f 6d70 6172  'Building Compar
+000629b0: 6973 6f6e 204d 6f64 656c 2077 6974 6820  ison Model with 
+000629c0: 6f6e 6c79 2050 6f6c 7920 616e 6420 496e  only Poly and In
+000629d0: 7465 7261 6374 696f 6e20 7661 7269 6162  teraction variab
+000629e0: 6c65 732e 2e2e 2729 0d0a 2020 2020 2020  les...')..      
+000629f0: 2020 6c6d 5f70 2c20 5f20 3d20 7072 696e    lm_p, _ = prin
+00062a00: 745f 6d6f 6465 6c5f 6d65 7472 6963 7328  t_model_metrics(
+00062a10: 6d6f 6465 6c74 7970 652c 6c6d 2c58 5031  modeltype,lm,XP1
+00062a20: 582c 592c 5472 7565 290d 0a20 2020 2020  X,Y,True)..     
+00062a30: 2020 2070 7269 6e74 2827 2020 2020 5469     print('    Ti
+00062a40: 6d65 2054 616b 656e 3a20 2530 2e30 6620  me Taken: %0.0f 
+00062a50: 2869 6e20 7365 636f 6e64 7329 2720 2528  (in seconds)' %(
+00062a60: 7469 6d65 2e74 696d 6528 292d 7374 6172  time.time()-star
+00062a70: 745f 7469 6d65 2929 0d0a 2020 2020 2020  t_time))..      
+00062a80: 2020 2323 2323 2020 5765 206e 6565 6420    ####  We need 
+00062a90: 746f 2062 7569 6c64 2061 2064 6174 6166  to build a dataf
+00062aa0: 7261 6d65 2074 6f20 686f 6c64 2063 6f65  rame to hold coe
+00062ab0: 6666 6963 6965 6e74 7320 6672 6f6d 2074  fficients from t
+00062ac0: 6865 206d 6f64 656c 2066 6f72 2065 6163  he model for eac
+00062ad0: 6820 7661 7269 6162 6c65 2023 2323 0d0a  h variable ###..
+00062ae0: 2020 2020 2020 2020 6466 7820 3d20 7064          dfx = pd
+00062af0: 2e44 6174 6146 7261 6d65 285b 6e65 775f  .DataFrame([new_
+00062b00: 6164 6478 5f76 6172 732c 206e 6577 5f61  addx_vars, new_a
+00062b10: 6464 7465 7874 5f76 6172 735d 290d 0a20  ddtext_vars]).. 
+00062b20: 2020 2020 2020 2064 6620 3d20 6466 782e         df = dfx.
+00062b30: 540d 0a20 2020 2020 2020 2064 662e 636f  T..        df.co
+00062b40: 6c75 6d6e 733d 5b27 5820 4e61 6d65 7327  lumns=['X Names'
+00062b50: 2c27 496e 7465 7261 6374 696f 6e20 5661  ,'Interaction Va
+00062b60: 7269 6162 6c65 204e 616d 6573 275d 0d0a  riable Names']..
+00062b70: 2020 2020 2020 2020 2323 2323 2323 2323          ########
+00062b80: 2323 2020 4e20 4f20 5720 2020 4220 5520  ##  N O W   B U 
+00062b90: 4920 4c20 4420 2054 2048 2045 2020 4d20  I L D  T H E  M 
+00062ba0: 4f20 4420 4520 4c20 2323 2323 2323 2323  O D E L ########
+00062bb0: 2323 2323 2323 2323 2323 2323 2323 2323  ################
+00062bc0: 2323 2323 2323 2323 2323 0d0a 2020 2020  ##########..    
+00062bd0: 2020 2020 6966 206d 6f64 656c 7479 7065      if modeltype
+00062be0: 203d 3d20 2752 6567 7265 7373 696f 6e27   == 'Regression'
+00062bf0: 3a0d 0a20 2020 2020 2020 2020 2020 2064  :..            d
+00062c00: 665b 2743 6f65 6666 6963 6965 6e74 2056  f['Coefficient V
+00062c10: 616c 7565 7327 5d20 3d20 6c6d 5f70 2e63  alues'] = lm_p.c
+00062c20: 6f65 665f 0d0a 2020 2020 2020 2020 656c  oef_..        el
+00062c30: 7365 3a0d 0a20 2020 2020 2020 2020 2020  se:..           
+00062c40: 2064 665b 2743 6f65 6666 6963 6965 6e74   df['Coefficient
+00062c50: 2056 616c 7565 7327 5d20 3d20 6c6d 5f70   Values'] = lm_p
+00062c60: 2e63 6f65 665f 5b30 5d0d 0a20 2020 2020  .coef_[0]..     
+00062c70: 2020 2023 2323 2320 5468 6973 2070 6172     #### This par
+00062c80: 7420 7365 6c65 6374 7320 7468 6520 746f  t selects the to
+00062c90: 7020 3130 2520 6f66 2069 6e74 6572 6163  p 10% of interac
+00062ca0: 7469 6f6e 2076 6172 6961 626c 6573 2063  tion variables c
+00062cb0: 7265 6174 6564 2075 7369 6e67 206c 696e  reated using lin
+00062cc0: 6561 7220 6d6f 6465 6c69 6e67 2e0d 0a20  ear modeling... 
+00062cd0: 2020 2020 2020 2023 2323 2020 2049 7420         ###   It 
+00062ce0: 6973 2076 6572 7920 696d 706f 7274 616e  is very importan
+00062cf0: 7420 746f 206c 6561 7665 2074 6865 206e  t to leave the n
+00062d00: 6578 7420 6c69 6e65 2061 7320 6973 2073  ext line as is s
+00062d10: 696e 6365 203e 2073 796d 626f 6c20 6973  ince > symbol is
+00062d20: 2062 6574 7465 7220 7468 616e 203e 3d0d   better than >=.
+00062d30: 0a20 2020 2020 2020 206c 696d 203d 2061  .        lim = a
+00062d40: 6273 2864 665b 2743 6f65 6666 6963 6965  bs(df['Coefficie
+00062d50: 6e74 2056 616c 7565 7327 5d29 2e71 7561  nt Values']).qua
+00062d60: 6e74 696c 6528 302e 3929 0d0a 2020 2020  ntile(0.9)..    
+00062d70: 2020 2020 6466 3930 203d 2064 665b 6162      df90 = df[ab
+00062d80: 7328 6466 5b27 436f 6566 6669 6369 656e  s(df['Coefficien
+00062d90: 7420 5661 6c75 6573 275d 293e 6c69 6d5d  t Values'])>lim]
+00062da0: 2e73 6f72 745f 7661 6c75 6573 2827 436f  .sort_values('Co
+00062db0: 6566 6669 6369 656e 7420 5661 6c75 6573  efficient Values
+00062dc0: 272c 6173 6365 6e64 696e 673d 4661 6c73  ',ascending=Fals
+00062dd0: 6529 0d0a 2020 2020 2020 2020 6966 2064  e)..        if d
+00062de0: 665b 2743 6f65 6666 6963 6965 6e74 2056  f['Coefficient V
+00062df0: 616c 7565 7327 5d2e 7375 6d28 293d 3d30  alues'].sum()==0
+00062e00: 2e30 206f 7220 6466 3930 5b27 436f 6566  .0 or df90['Coef
+00062e10: 6669 6369 656e 7420 5661 6c75 6573 275d  ficient Values']
+00062e20: 2e73 756d 2829 3d3d 302e 303a 0d0a 2020  .sum()==0.0:..  
+00062e30: 2020 2020 2020 2020 2020 2323 2320 5468            ### Th
+00062e40: 6572 6520 6973 206e 6f20 636f 6566 6669  ere is no coeffi
+00062e50: 6369 656e 7420 7468 6174 2069 7320 6772  cient that is gr
+00062e60: 6561 7465 7220 7468 616e 2030 2068 6572  eater than 0 her
+00062e70: 652e 2053 6f20 7265 6a65 6374 2061 6c6c  e. So reject all
+00062e80: 2076 6172 6961 626c 6573 210d 0a20 2020   variables!..   
+00062e90: 2020 2020 2020 2020 2073 656c 5f78 5f76           sel_x_v
+00062ea0: 6172 7320 3d20 5b5d 0d0a 2020 2020 2020  ars = []..      
+00062eb0: 2020 2020 2020 7072 696e 7428 275a 6572        print('Zer
+00062ec0: 6f20 496e 7465 7261 6374 696f 6e20 616e  o Interaction an
+00062ed0: 6420 506f 6c79 6e6f 6d69 616c 2076 6172  d Polynomial var
+00062ee0: 6961 626c 6528 7329 2073 656c 6563 7465  iable(s) selecte
+00062ef0: 642e 2e2e 2729 0d0a 2020 2020 2020 2020  d...')..        
+00062f00: 656c 6966 2064 665b 2743 6f65 6666 6963  elif df['Coeffic
+00062f10: 6965 6e74 2056 616c 7565 7327 5d2e 7368  ient Values'].sh
+00062f20: 6170 655b 305d 203d 3d20 6466 3930 5b27  ape[0] == df90['
+00062f30: 436f 6566 6669 6369 656e 7420 5661 6c75  Coefficient Valu
+00062f40: 6573 275d 2e73 6861 7065 5b30 5d3a 0d0a  es'].shape[0]:..
+00062f50: 2020 2020 2020 2020 2020 2020 2323 2320              ### 
+00062f60: 5468 6572 6520 6973 206e 6f20 636f 6566  There is no coef
+00062f70: 6669 6369 656e 7420 7468 6174 2069 7320  ficient that is 
+00062f80: 6772 6561 7465 7220 7468 616e 2030 2068  greater than 0 h
+00062f90: 6572 652e 2053 6f20 7265 6a65 6374 2061  ere. So reject a
+00062fa0: 6c6c 2076 6172 6961 626c 6573 210d 0a20  ll variables!.. 
+00062fb0: 2020 2020 2020 2020 2020 2073 656c 5f78             sel_x
+00062fc0: 5f76 6172 7320 3d20 5b5d 0d0a 2020 2020  _vars = []..    
+00062fd0: 2020 2020 2020 2020 7072 696e 7428 275a          print('Z
+00062fe0: 6572 6f20 496e 7465 7261 6374 696f 6e20  ero Interaction 
+00062ff0: 616e 6420 506f 6c79 6e6f 6d69 616c 2076  and Polynomial v
+00063000: 6172 6961 626c 6528 7329 2073 656c 6563  ariable(s) selec
+00063010: 7465 642e 2e2e 2729 0d0a 2020 2020 2020  ted...')..      
+00063020: 2020 656c 7365 3a0d 0a20 2020 2020 2020    else:..       
+00063030: 2020 2020 2023 2323 2320 7468 6572 6520       #### there 
+00063040: 6973 2073 6f6d 6520 636f 6566 6669 6369  is some coeffici
+00063050: 656e 7473 2061 7420 6c65 6173 7420 7468  ents at least th
+00063060: 6174 2061 7265 206e 6f6e 2d7a 6572 6f20  at are non-zero 
+00063070: 616e 6420 6865 6e63 6520 6361 6e20 6265  and hence can be
+00063080: 2074 7275 7374 6564 210d 0a20 2020 2020   trusted!..     
+00063090: 2020 2020 2020 2069 6620 7665 7262 6f73         if verbos
+000630a0: 6520 3e3d 2031 3a0d 0a20 2020 2020 2020  e >= 1:..       
+000630b0: 2020 2020 2020 2020 2064 6639 302e 736f           df90.so
+000630c0: 7274 5f76 616c 7565 7328 2743 6f65 6666  rt_values('Coeff
+000630d0: 6963 6965 6e74 2056 616c 7565 7327 2c61  icient Values',a
+000630e0: 7363 656e 6469 6e67 3d46 616c 7365 295b  scending=False)[
+000630f0: 3a31 305d 2e70 6c6f 7428 0d0a 2020 2020  :10].plot(..    
+00063100: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00063110: 6b69 6e64 3d27 6261 7227 2c78 3d27 496e  kind='bar',x='In
+00063120: 7465 7261 6374 696f 6e20 5661 7269 6162  teraction Variab
+00063130: 6c65 204e 616d 6573 272c 793d 2743 6f65  le Names',y='Coe
+00063140: 6666 6963 6965 6e74 2056 616c 7565 7327  fficient Values'
+00063150: 2c0d 0a20 2020 2020 2020 2020 2020 2020  ,..             
+00063160: 2020 2020 2020 2074 6974 6c65 3d27 546f         title='To
+00063170: 7020 3130 2520 5661 7269 6162 6c65 2049  p 10% Variable I
+00063180: 6e74 6572 6163 7469 6f6e 7320 616e 6420  nteractions and 
+00063190: 7468 6569 7220 436f 6566 6669 6369 656e  their Coefficien
+000631a0: 7473 2027 290d 0a20 2020 2020 2020 2020  ts ')..         
+000631b0: 2020 2065 6c69 6620 7665 7262 6f73 6520     elif verbose 
+000631c0: 3d3d 2032 3a0d 0a20 2020 2020 2020 2020  == 2:..         
+000631d0: 2020 2020 2020 2064 6639 302e 736f 7274         df90.sort
+000631e0: 5f76 616c 7565 7328 2743 6f65 6666 6963  _values('Coeffic
+000631f0: 6965 6e74 2056 616c 7565 7327 2c61 7363  ient Values',asc
+00063200: 656e 6469 6e67 3d46 616c 7365 292e 706c  ending=False).pl
+00063210: 6f74 280d 0a20 2020 2020 2020 2020 2020  ot(..           
+00063220: 2020 2020 2020 2020 206b 696e 643d 2762           kind='b
+00063230: 6172 272c 783d 2749 6e74 6572 6163 7469  ar',x='Interacti
+00063240: 6f6e 2056 6172 6961 626c 6520 4e61 6d65  on Variable Name
+00063250: 7327 2c79 3d27 436f 6566 6669 6369 656e  s',y='Coefficien
+00063260: 7420 5661 6c75 6573 272c 0d0a 2020 2020  t Values',..    
+00063270: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00063280: 2020 2020 7469 746c 653d 2741 6c6c 2056      title='All V
+00063290: 6172 6961 626c 6520 496e 7465 7261 6374  ariable Interact
+000632a0: 696f 6e73 2061 6e64 2074 6865 6972 2043  ions and their C
+000632b0: 6f65 6666 6963 6965 6e74 7327 2c66 6967  oefficients',fig
+000632c0: 7369 7a65 3d28 3230 2c31 3029 290d 0a20  size=(20,10)).. 
+000632d0: 2020 2020 2020 2020 2020 2069 6e74 6572             inter
+000632e0: 6163 7469 6f6e 7320 3d20 6466 3930 5b27  actions = df90['
+000632f0: 496e 7465 7261 6374 696f 6e20 5661 7269  Interaction Vari
+00063300: 6162 6c65 204e 616d 6573 275d 2e76 616c  able Names'].val
+00063310: 7565 732e 746f 6c69 7374 2829 0d0a 2020  ues.tolist()..  
+00063320: 2020 2020 2020 2020 2020 7365 6c5f 785f            sel_x_
+00063330: 7661 7273 203d 2064 6639 305b 2258 204e  vars = df90["X N
+00063340: 616d 6573 225d 2e76 616c 7565 732e 746f  ames"].values.to
+00063350: 6c69 7374 2829 0d0a 2020 2020 2020 2020  list()..        
+00063360: 2323 2323 2323 2320 4e6f 7720 7765 2068  ####### Now we h
+00063370: 6176 6520 746f 2070 7574 2074 6865 2066  ave to put the f
+00063380: 756c 6c20 6461 7461 6672 616d 6520 746f  ull dataframe to
+00063390: 6765 7468 6572 2077 6974 6820 7365 6c65  gether with sele
+000633a0: 6374 6564 2076 6172 6961 626c 6573 2061  cted variables a
+000633b0: 6e64 206f 7269 6769 6e61 6c20 7072 6564  nd original pred
+000633c0: 6963 746f 7273 210d 0a20 2020 2020 2020  ictors!..       
+000633d0: 2023 2323 2320 444f 204e 4f54 2043 4841   #### DO NOT CHA
+000633e0: 4e47 4520 5448 4520 4e45 5854 204c 494e  NGE THE NEXT LIN
+000633f0: 4520 4556 454e 2054 484f 5547 4820 4954  E EVEN THOUGH IT
+00063400: 204d 4947 4854 2042 4520 5445 4d50 5449   MIGHT BE TEMPTI
+00063410: 4e47 2054 4f20 444f 2053 4f21 2049 7420  NG TO DO SO! It 
+00063420: 6973 2063 6f72 7265 6374 210d 0a20 2020  is correct!..   
+00063430: 2020 2020 2066 696e 616c 5f78 5f76 6172       final_x_var
+00063440: 7320 3d20 785f 7661 7273 202b 2073 656c  s = x_vars + sel
+00063450: 5f78 5f76 6172 730d 0a20 2020 2020 2020  _x_vars..       
+00063460: 2073 656c 5f74 6578 745f 7661 7273 203d   sel_text_vars =
+00063470: 205b 6665 6174 7572 655f 7876 6172 5f64   [feature_xvar_d
+00063480: 6963 745b 785d 2066 6f72 2078 2069 6e20  ict[x] for x in 
+00063490: 7365 6c5f 785f 7661 7273 5d0d 0a20 2020  sel_x_vars]..   
+000634a0: 2020 2020 2070 7269 6e74 2827 496e 6974       print('Init
+000634b0: 6961 6c6c 7920 6164 6469 6e67 2025 6420  ially adding %d 
+000634c0: 7661 7269 6162 6c65 2873 2920 6475 6520  variable(s) due 
+000634d0: 746f 2041 6464 5f50 6f6c 7920 3d20 2573  to Add_Poly = %s
+000634e0: 2073 6574 7469 6e67 2720 2528 6c65 6e28   setting' %(len(
+000634f0: 7365 6c5f 7465 7874 5f76 6172 7329 2c41  sel_text_vars),A
+00063500: 6464 5f50 6f6c 7929 290d 0a20 2020 2020  dd_Poly))..     
+00063510: 2020 2069 6620 7665 7262 6f73 6520 3e20     if verbose > 
+00063520: 313a 0d0a 2020 2020 2020 2020 2020 2020  1:..            
+00063530: 6966 206c 656e 2873 656c 5f74 6578 745f  if len(sel_text_
+00063540: 7661 7273 2920 3c3d 2033 303a 0d0a 2020  vars) <= 30:..  
+00063550: 2020 2020 2020 2020 2020 2020 2020 7072                pr
+00063560: 696e 7428 2720 2020 2041 6464 6564 2076  int('    Added v
+00063570: 6172 6961 626c 6573 3a20 2573 2720 2573  ariables: %s' %s
+00063580: 656c 5f74 6578 745f 7661 7273 290d 0a20  el_text_vars).. 
+00063590: 2020 2020 2020 2066 696e 616c 5f74 6578         final_tex
+000635a0: 745f 7661 7273 203d 205b 6665 6174 7572  t_vars = [featur
+000635b0: 655f 7876 6172 5f64 6963 745b 785d 2066  e_xvar_dict[x] f
+000635c0: 6f72 2078 2069 6e20 6669 6e61 6c5f 785f  or x in final_x_
+000635d0: 7661 7273 5d0d 0a20 2020 2020 2020 2023  vars]..        #
+000635e0: 2323 2323 2323 2323 2323 2323 2323 2323  ################
+000635f0: 2323 2323 2323 2323 2323 2323 2323 2323  ################
+00063600: 2323 2323 2323 2323 2323 2323 2323 2323  ################
+00063610: 2323 2323 2323 2323 2323 2323 2323 2323  ################
+00063620: 2323 2323 2323 2323 2323 2323 2323 2323  ################
+00063630: 2323 2323 2323 2323 230d 0a20 2020 2020  #########..     
+00063640: 2020 2066 696e 616c 5f64 6620 3d20 6d64     final_df = md
+00063650: 2e74 7261 6e73 666f 726d 2864 6174 615b  .transform(data[
+00063660: 7072 6564 6963 746f 7273 5d29 0d0a 2020  predictors])..  
+00063670: 2020 2020 2020 6966 204c 6f6f 7365 5665        if LooseVe
+00063680: 7273 696f 6e28 736b 6c65 6172 6e2e 5f5f  rsion(sklearn.__
+00063690: 7665 7273 696f 6e5f 5f29 203c 204c 6f6f  version__) < Loo
+000636a0: 7365 5665 7273 696f 6e28 2730 2e32 342e  seVersion('0.24.
+000636b0: 3227 293a 0d0a 2020 2020 2020 2020 2020  2'):..          
+000636c0: 2020 2320 5065 7266 6f72 6d20 6163 7469    # Perform acti
+000636d0: 6f6e 2066 6f72 2073 6369 6b69 742d 6c65  on for scikit-le
+000636e0: 6172 6e20 7665 7273 696f 6e20 6265 6c6f  arn version belo
+000636f0: 7720 302e 3234 2e32 0d0a 2020 2020 2020  w 0.24.2..      
+00063700: 2020 2020 2020 7072 696e 7428 2250 6572        print("Per
+00063710: 666f 726d 696e 6720 6163 7469 6f6e 2066  forming action f
+00063720: 6f72 2073 6369 6b69 742d 6c65 6172 6e20  or scikit-learn 
+00063730: 7665 7273 696f 6e20 6265 6c6f 7720 302e  version below 0.
+00063740: 3234 2e32 2229 0d0a 2020 2020 2020 2020  24.2")..        
+00063750: 2020 2020 2320 4164 6420 796f 7572 2063      # Add your c
+00063760: 6f64 6520 6865 7265 2066 6f72 2073 6369  ode here for sci
+00063770: 6b69 742d 6c65 6172 6e20 7665 7273 696f  kit-learn versio
+00063780: 6e20 6265 6c6f 7720 302e 3234 2e32 0d0a  n below 0.24.2..
+00063790: 2020 2020 2020 2020 2020 2020 786e 616d              xnam
+000637a0: 6573 203d 206d 642e 6765 745f 6665 6174  es = md.get_feat
+000637b0: 7572 655f 6e61 6d65 7328 290d 0a20 2020  ure_names()..   
+000637c0: 2020 2020 2065 6c73 653a 0d0a 2020 2020       else:..    
+000637d0: 2020 2020 2020 2020 2320 5065 7266 6f72          # Perfor
+000637e0: 6d20 6163 7469 6f6e 2066 6f72 2073 6369  m action for sci
+000637f0: 6b69 742d 6c65 6172 6e20 7665 7273 696f  kit-learn versio
+00063800: 6e20 302e 3234 2e32 2061 6e64 2061 626f  n 0.24.2 and abo
+00063810: 7665 0d0a 2020 2020 2020 2020 2020 2020  ve..            
+00063820: 7072 696e 7428 2250 6572 666f 726d 696e  print("Performin
+00063830: 6720 6163 7469 6f6e 2066 6f72 2073 6369  g action for sci
+00063840: 6b69 742d 6c65 6172 6e20 7665 7273 696f  kit-learn versio
+00063850: 6e20 302e 3234 2e32 2061 6e64 2061 626f  n 0.24.2 and abo
+00063860: 7665 2229 0d0a 2020 2020 2020 2020 2020  ve")..          
+00063870: 2020 2320 4164 6420 796f 7572 2063 6f64    # Add your cod
+00063880: 6520 6865 7265 2066 6f72 2073 6369 6b69  e here for sciki
+00063890: 742d 6c65 6172 6e20 7665 7273 696f 6e20  t-learn version 
+000638a0: 302e 3234 2e32 2061 6e64 2061 626f 7665  0.24.2 and above
+000638b0: 0d0a 2020 2020 2020 2020 2020 2020 786e  ..            xn
+000638c0: 616d 6573 203d 206d 642e 6765 745f 6665  ames = md.get_fe
+000638d0: 6174 7572 655f 6e61 6d65 735f 6f75 7428  ature_names_out(
+000638e0: 292e 746f 6c69 7374 2829 2023 2323 2078  ).tolist() ### x
+000638f0: 6e61 6d65 7320 636f 6e74 6169 6e73 2061  names contains a
+00063900: 6c6c 2078 2d6f 6e6c 792c 2050 6f6c 7920  ll x-only, Poly 
+00063910: 616e 6420 496e 7478 6e20 7661 7269 6162  and Intxn variab
+00063920: 6c65 7320 696e 2078 2d66 6f72 6d61 740d  les in x-format.
+00063930: 0a20 2020 2020 2020 2066 696e 616c 5f64  .        final_d
+00063940: 6620 3d20 7064 2e44 6174 6146 7261 6d65  f = pd.DataFrame
+00063950: 2866 696e 616c 5f64 662c 696e 6465 783d  (final_df,index=
+00063960: 6f72 6967 5f64 6174 615f 696e 6465 782c  orig_data_index,
+00063970: 2063 6f6c 756d 6e73 3d78 6e61 6d65 7329   columns=xnames)
+00063980: 0d0a 2020 2020 2020 2020 6669 6e61 6c5f  ..        final_
+00063990: 6466 203d 2066 696e 616c 5f64 665b 6669  df = final_df[fi
+000639a0: 6e61 6c5f 785f 7661 7273 5d0d 0a20 2020  nal_x_vars]..   
+000639b0: 2020 2020 2066 696e 616c 5f64 662e 636f       final_df.co
+000639c0: 6c75 6d6e 7320 3d20 6669 6e61 6c5f 7465  lumns = final_te
+000639d0: 7874 5f76 6172 730d 0a20 2020 2020 2020  xt_vars..       
+000639e0: 2063 6f70 795f 7072 6564 7320 3d20 636f   copy_preds = co
+000639f0: 7079 2e64 6565 7063 6f70 7928 7072 6564  py.deepcopy(pred
+00063a00: 6963 746f 7273 290d 0a20 2020 2020 2020  ictors)..       
+00063a10: 2023 2323 2323 2323 2049 6620 7468 6520   ####### If the 
+00063a20: 6f72 6967 696e 616c 2063 6f6c 756d 6e27  original column'
+00063a30: 7320 6474 7970 6520 7761 7320 696e 7465  s dtype was inte
+00063a40: 6765 722c 2070 7574 2069 7420 6261 636b  ger, put it back
+00063a50: 2061 7320 696e 7465 6765 7220 2323 230d   as integer ###.
+00063a60: 0a20 2020 2020 2020 2066 6f72 2065 6163  .        for eac
+00063a70: 685f 7072 6564 2069 6e20 636f 7079 5f70  h_pred in copy_p
+00063a80: 7265 6473 3a0d 0a20 2020 2020 2020 2020  reds:..         
+00063a90: 2020 2069 6620 6461 7461 5b65 6163 685f     if data[each_
+00063aa0: 7072 6564 5d2e 6474 7970 6520 3d3d 2069  pred].dtype == i
+00063ab0: 6e74 3a0d 0a20 2020 2020 2020 2020 2020  nt:..           
+00063ac0: 2020 2020 2066 696e 616c 5f64 665b 6561       final_df[ea
+00063ad0: 6368 5f70 7265 645d 203d 2066 696e 616c  ch_pred] = final
+00063ae0: 5f64 665b 6561 6368 5f70 7265 645d 2e61  _df[each_pred].a
+00063af0: 7374 7970 6528 696e 7429 0d0a 2020 2020  stype(int)..    
+00063b00: 2020 2020 6669 6e61 6c5f 6466 5b74 6172      final_df[tar
+00063b10: 6765 7476 6172 5d20 3d20 6461 7461 5b74  getvar] = data[t
+00063b20: 6172 6765 7476 6172 5d2e 7661 6c75 6573  argetvar].values
+00063b30: 0d0a 2020 2020 2020 2020 2323 2323 2323  ..        ######
+00063b40: 2323 2323 2323 2323 2323 2323 2323 2323  ################
+00063b50: 2323 2323 2323 2323 2323 2323 2323 2323  ################
+00063b60: 2323 2323 2323 2323 2323 2323 2323 230d  ###############.
+00063b70: 0a20 2020 2020 2020 2072 6574 7572 6e20  .        return 
+00063b80: 6669 6e61 6c5f 7465 7874 5f76 6172 732c  final_text_vars,
+00063b90: 206c 6d5f 702c 2066 696e 616c 5f64 662c   lm_p, final_df,
+00063ba0: 206d 642c 2066 696e 616c 5f78 5f76 6172   md, final_x_var
+00063bb0: 732c 6665 6174 7572 655f 7876 6172 5f64  s,feature_xvar_d
+00063bc0: 6963 740d 0a20 2020 2065 6c73 653a 0d0a  ict..    else:..
+00063bd0: 2020 2020 2020 2020 2323 2323 204a 7573          #### Jus
+00063be0: 7420 7265 7475 726e 2074 6865 2074 7261  t return the tra
+00063bf0: 6e73 666f 726d 6564 2064 6174 6166 7261  nsformed datafra
+00063c00: 6d65 2077 6974 6820 616c 6c20 6f72 6967  me with all orig
+00063c10: 2b70 6f6c 792b 696e 7478 6e20 7661 7273  +poly+intxn vars
+00063c20: 0d0a 2020 2020 2020 2020 6669 6e61 6c5f  ..        final_
+00063c30: 6466 203d 206d 642e 7472 616e 7366 6f72  df = md.transfor
+00063c40: 6d28 6461 7461 5b70 7265 6469 6374 6f72  m(data[predictor
+00063c50: 735d 290d 0a20 2020 2020 2020 2069 6620  s])..        if 
+00063c60: 4c6f 6f73 6556 6572 7369 6f6e 2873 6b6c  LooseVersion(skl
+00063c70: 6561 726e 2e5f 5f76 6572 7369 6f6e 5f5f  earn.__version__
+00063c80: 2920 3c20 4c6f 6f73 6556 6572 7369 6f6e  ) < LooseVersion
+00063c90: 2827 302e 3234 2e32 2729 3a0d 0a20 2020  ('0.24.2'):..   
+00063ca0: 2020 2020 2020 2020 2023 2050 6572 666f           # Perfo
+00063cb0: 726d 2061 6374 696f 6e20 666f 7220 7363  rm action for sc
+00063cc0: 696b 6974 2d6c 6561 726e 2076 6572 7369  ikit-learn versi
+00063cd0: 6f6e 2062 656c 6f77 2030 2e32 342e 320d  on below 0.24.2.
+00063ce0: 0a20 2020 2020 2020 2020 2020 2070 7269  .            pri
+00063cf0: 6e74 2822 5065 7266 6f72 6d69 6e67 2061  nt("Performing a
+00063d00: 6374 696f 6e20 666f 7220 7363 696b 6974  ction for scikit
+00063d10: 2d6c 6561 726e 2076 6572 7369 6f6e 2062  -learn version b
+00063d20: 656c 6f77 2030 2e32 342e 3222 290d 0a20  elow 0.24.2").. 
+00063d30: 2020 2020 2020 2020 2020 2023 2041 6464             # Add
+00063d40: 2079 6f75 7220 636f 6465 2068 6572 6520   your code here 
+00063d50: 666f 7220 7363 696b 6974 2d6c 6561 726e  for scikit-learn
+00063d60: 2076 6572 7369 6f6e 2062 656c 6f77 2030   version below 0
+00063d70: 2e32 342e 320d 0a20 2020 2020 2020 2020  .24.2..         
+00063d80: 2020 2078 6e61 6d65 7320 3d20 6d64 2e67     xnames = md.g
+00063d90: 6574 5f66 6561 7475 7265 5f6e 616d 6573  et_feature_names
+00063da0: 2829 0d0a 2020 2020 2020 2020 656c 7365  ()..        else
+00063db0: 3a0d 0a20 2020 2020 2020 2020 2020 2023  :..            #
+00063dc0: 2050 6572 666f 726d 2061 6374 696f 6e20   Perform action 
+00063dd0: 666f 7220 7363 696b 6974 2d6c 6561 726e  for scikit-learn
+00063de0: 2076 6572 7369 6f6e 2030 2e32 342e 3220   version 0.24.2 
+00063df0: 616e 6420 6162 6f76 650d 0a20 2020 2020  and above..     
+00063e00: 2020 2020 2020 2070 7269 6e74 2822 5065         print("Pe
+00063e10: 7266 6f72 6d69 6e67 2061 6374 696f 6e20  rforming action 
+00063e20: 666f 7220 7363 696b 6974 2d6c 6561 726e  for scikit-learn
+00063e30: 2076 6572 7369 6f6e 2030 2e32 342e 3220   version 0.24.2 
+00063e40: 616e 6420 6162 6f76 6522 290d 0a20 2020  and above")..   
+00063e50: 2020 2020 2020 2020 2023 2041 6464 2079           # Add y
+00063e60: 6f75 7220 636f 6465 2068 6572 6520 666f  our code here fo
+00063e70: 7220 7363 696b 6974 2d6c 6561 726e 2076  r scikit-learn v
+00063e80: 6572 7369 6f6e 2030 2e32 342e 3220 616e  ersion 0.24.2 an
+00063e90: 6420 6162 6f76 650d 0a20 2020 2020 2020  d above..       
+00063ea0: 2020 2020 2078 6e61 6d65 7320 3d20 6d64       xnames = md
+00063eb0: 2e67 6574 5f66 6561 7475 7265 5f6e 616d  .get_feature_nam
+00063ec0: 6573 5f6f 7574 2829 2e74 6f6c 6973 7428  es_out().tolist(
+00063ed0: 2920 2323 2320 786e 616d 6573 2063 6f6e  ) ### xnames con
+00063ee0: 7461 696e 7320 616c 6c20 782d 6f6e 6c79  tains all x-only
+00063ef0: 2c20 506f 6c79 2061 6e64 2049 6e74 786e  , Poly and Intxn
+00063f00: 2076 6172 6961 626c 6573 2069 6e20 782d   variables in x-
+00063f10: 666f 726d 6174 0d0a 2020 2020 2020 2020  format..        
+00063f20: 6669 6e61 6c5f 6466 203d 2070 642e 4461  final_df = pd.Da
+00063f30: 7461 4672 616d 6528 6669 6e61 6c5f 6466  taFrame(final_df
+00063f40: 2c69 6e64 6578 3d6f 7269 675f 6461 7461  ,index=orig_data
+00063f50: 5f69 6e64 6578 2c20 636f 6c75 6d6e 733d  _index, columns=
+00063f60: 786e 616d 6573 290d 0a20 2020 2020 2020  xnames)..       
+00063f70: 2072 6574 7572 6e20 7072 6564 6963 746f   return predicto
+00063f80: 7273 2c20 6c6d 2c20 6669 6e61 6c5f 6466  rs, lm, final_df
+00063f90: 2c20 6d64 2c20 786e 616d 6573 2c20 2222  , md, xnames, ""
+00063fa0: 0d0a 2323 2323 2323 2323 2323 2323 2323  ..##############
+00063fb0: 2323 2323 2323 2323 2323 2323 2323 2323  ################
+00063fc0: 2323 2323 2323 2323 2323 2323 2323 2323  ################
+00063fd0: 2323 2323 2323 2323 2323 2323 2323 2323  ################
+00063fe0: 2323 2323 2323 2323 2323 2323 2323 2323  ################
+00063ff0: 2323 2323 0d0a 2323 2049 6d70 6f72 7420  ####..## Import 
+00064000: 736b 6c65 6172 6e0d 0a66 726f 6d20 736b  sklearn..from sk
+00064010: 6c65 6172 6e2e 6d6f 6465 6c5f 7365 6c65  learn.model_sele
+00064020: 6374 696f 6e20 696d 706f 7274 2063 726f  ction import cro
+00064030: 7373 5f76 616c 5f73 636f 7265 2c4b 466f  ss_val_score,KFo
+00064040: 6c64 2c20 5374 7261 7469 6669 6564 4b46  ld, StratifiedKF
+00064050: 6f6c 640d 0a64 6566 2070 7269 6e74 5f6d  old..def print_m
+00064060: 6f64 656c 5f6d 6574 7269 6373 286d 6f64  odel_metrics(mod
+00064070: 656c 7479 7065 2c72 6567 2c58 2c79 2c66  eltype,reg,X,y,f
+00064080: 6974 5f66 6c61 673d 4661 6c73 652c 7665  it_flag=False,ve
+00064090: 7262 6f73 653d 3129 3a0d 0a20 2020 2023  rbose=1):..    #
+000640a0: 2323 2049 6620 6669 745f 666c 6167 2069  ## If fit_flag i
+000640b0: 7320 7365 7420 746f 2054 7275 652c 2074  s set to True, t
+000640c0: 6865 6e20 796f 7520 6d75 7374 2072 6574  hen you must ret
+000640d0: 7572 6e20 6120 6669 7474 6564 206d 6f64  urn a fitted mod
+000640e0: 656c 2023 2323 0d0a 2020 2020 2323 2320  el ###..    ### 
+000640f0: 2020 456c 7365 2079 6f75 206d 7573 7420    Else you must 
+00064100: 7265 7475 726e 2074 6865 2063 765f 7363  return the cv_sc
+00064110: 6f72 6573 2e6d 6561 6e20 6f6e 6c79 2023  ores.mean only #
+00064120: 2323 230d 0a20 2020 206e 5f73 706c 6974  ###..    n_split
+00064130: 7320 3d20 350d 0a20 2020 2069 6620 7665  s = 5..    if ve
+00064140: 7262 6f73 653e 303a 0d0a 2020 2020 2020  rbose>0:..      
+00064150: 2020 7072 696e 7428 224d 6f64 656c 2052    print("Model R
+00064160: 6570 6f72 7420 3a22 290d 0a20 2020 2020  eport :")..     
+00064170: 2020 2070 7269 6e74 2827 2020 2020 4e75     print('    Nu
+00064180: 6d62 6572 206f 6620 5661 7269 6162 6c65  mber of Variable
+00064190: 7320 3d20 272c 582e 7368 6170 655b 315d  s = ',X.shape[1]
+000641a0: 290d 0a20 2020 2069 6620 6d6f 6465 6c74  )..    if modelt
+000641b0: 7970 6520 3d3d 2027 5265 6772 6573 7369  ype == 'Regressi
+000641c0: 6f6e 273a 0d0a 2020 2020 2020 2020 7363  on':..        sc
+000641d0: 7620 3d20 4b46 6f6c 6428 6e5f 7370 6c69  v = KFold(n_spli
+000641e0: 7473 3d6e 5f73 706c 6974 7329 0d0a 2020  ts=n_splits)..  
+000641f0: 2020 2020 2020 2370 6572 666f 726d 7320        #performs 
+00064200: 6372 6f73 7320 7661 6c69 6461 7469 6f6e  cross validation
+00064210: 0d0a 2020 2020 2020 2020 6376 5f73 636f  ..        cv_sco
+00064220: 7265 7320 3d20 6372 6f73 735f 7661 6c5f  res = cross_val_
+00064230: 7363 6f72 6528 7265 672c 582c 792e 7661  score(reg,X,y.va
+00064240: 6c75 6573 2e72 6176 656c 2829 2c63 763d  lues.ravel(),cv=
+00064250: 7363 762c 7363 6f72 696e 673d 276e 6567  scv,scoring='neg
+00064260: 5f6d 6561 6e5f 7371 7561 7265 645f 6572  _mean_squared_er
+00064270: 726f 7227 290d 0a20 2020 2020 2020 2063  ror')..        c
+00064280: 765f 7363 6f72 6573 203d 206e 702e 7371  v_scores = np.sq
+00064290: 7274 286e 702e 6162 7328 6376 5f73 636f  rt(np.abs(cv_sco
+000642a0: 7265 7329 290d 0a20 2020 2020 2020 2069  res))..        i
+000642b0: 6620 7665 7262 6f73 653a 0d0a 2020 2020  f verbose:..    
+000642c0: 2020 2020 2020 2020 7072 696e 7428 2220          print(" 
+000642d0: 2020 2043 5620 524d 5345 2053 636f 7265     CV RMSE Score
+000642e0: 203a 2025 2e34 6720 2b2f 2d20 252e 3467   : %.4g +/- %.4g
+000642f0: 207c 204d 696e 203d 2025 2e34 6720 7c20   | Min = %.4g | 
+00064300: 4d61 7820 3d20 252e 3467 2220 2528 0d0a  Max = %.4g" %(..
+00064310: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00064320: 6e70 2e6d 6561 6e28 6376 5f73 636f 7265  np.mean(cv_score
+00064330: 7329 2c6e 702e 7374 6428 6376 5f73 636f  s),np.std(cv_sco
+00064340: 7265 7329 2c0d 0a20 2020 2020 2020 2020  res),..         
+00064350: 2020 2020 2020 2020 6e70 2e6d 696e 2863          np.min(c
+00064360: 765f 7363 6f72 6573 292c 6e70 2e6d 6178  v_scores),np.max
+00064370: 2863 765f 7363 6f72 6573 2929 290d 0a20  (cv_scores))).. 
+00064380: 2020 2065 6c73 653a 0d0a 2020 2020 2020     else:..      
+00064390: 2020 7363 7620 3d20 5374 7261 7469 6669    scv = Stratifi
+000643a0: 6564 4b46 6f6c 6428 6e5f 7370 6c69 7473  edKFold(n_splits
+000643b0: 3d6e 5f73 706c 6974 732c 2072 616e 646f  =n_splits, rando
+000643c0: 6d5f 7374 6174 653d 302c 2073 6875 6666  m_state=0, shuff
+000643d0: 6c65 3d54 7275 6529 0d0a 2020 2020 2020  le=True)..      
+000643e0: 2020 2323 2320 7573 6520 4631 2077 6569    ### use F1 wei
+000643f0: 6768 7465 6420 7369 6e63 6520 6974 2077  ghted since it w
+00064400: 6f72 6b73 206f 6e20 6d75 6c74 6970 6c65  orks on multiple
+00064410: 2063 6c61 7373 6573 2061 7320 7765 6c6c   classes as well
+00064420: 2061 7320 6269 6e61 7279 2023 230d 0a20   as binary ##.. 
+00064430: 2020 2020 2020 2063 765f 7363 6f72 6573         cv_scores
+00064440: 203d 2063 726f 7373 5f76 616c 5f73 636f   = cross_val_sco
+00064450: 7265 2872 6567 2c58 2c79 2e76 616c 7565  re(reg,X,y.value
+00064460: 732e 7261 7665 6c28 292c 6376 3d73 6376  s.ravel(),cv=scv
+00064470: 2c73 636f 7269 6e67 3d27 6631 5f77 6569  ,scoring='f1_wei
+00064480: 6768 7465 6427 290d 0a20 2020 2020 2020  ghted')..       
+00064490: 2069 6620 7665 7262 6f73 653e 303a 0d0a   if verbose>0:..
+000644a0: 2020 2020 2020 2020 2020 2020 7072 696e              prin
+000644b0: 7428 2220 2020 2043 5620 5765 6967 6874  t("    CV Weight
+000644c0: 6564 2046 3120 5363 6f72 6520 3a20 252e  ed F1 Score : %.
+000644d0: 3467 202b 2f2d 2025 2e34 6720 7c20 4d69  4g +/- %.4g | Mi
+000644e0: 6e20 3d20 252e 3467 207c 204d 6178 203d  n = %.4g | Max =
+000644f0: 2025 2e34 6722 2025 2028 0d0a 2020 2020   %.4g" % (..    
+00064500: 2020 2020 2020 2020 2020 2020 6e70 2e6d              np.m
+00064510: 6561 6e28 6376 5f73 636f 7265 7329 2c6e  ean(cv_scores),n
+00064520: 702e 7374 6428 6376 5f73 636f 7265 7329  p.std(cv_scores)
+00064530: 2c0d 0a20 2020 2020 2020 2020 2020 2020  ,..             
+00064540: 2020 2020 6e70 2e6d 696e 2863 765f 7363      np.min(cv_sc
+00064550: 6f72 6573 292c 6e70 2e6d 6178 2863 765f  ores),np.max(cv_
+00064560: 7363 6f72 6573 2929 290d 0a20 2020 2069  scores)))..    i
+00064570: 6620 6669 745f 666c 6167 3a0d 0a20 2020  f fit_flag:..   
+00064580: 2020 2020 2072 6574 7572 6e20 7265 672e       return reg.
+00064590: 6669 7428 582c 7929 2c20 2063 765f 7363  fit(X,y),  cv_sc
+000645a0: 6f72 6573 2e6d 6561 6e28 290d 0a20 2020  ores.mean()..   
+000645b0: 2065 6c73 653a 0d0a 2020 2020 2020 2020   else:..        
+000645c0: 7265 7475 726e 2020 6376 5f73 636f 7265  return  cv_score
+000645d0: 732e 6d65 616e 2829 0d0a 2323 2323 2323  s.mean()..######
+000645e0: 2323 2323 2323 2323 2323 2323 2323 2323  ################
+000645f0: 2323 2323 2323 2323 2323 2323 2323 2323  ################
+00064600: 2323 2323 2323 2323 2323 2323 2323 2323  ################
+00064610: 2323 2323 2323 2323 2323 2323 2323 2323  ################
+00064620: 2323 2323 2323 2323 2323 2323 2323 2323  ################
+00064630: 2323 2323 2323 2323 0d0a 6465 6620 7365  ########..def se
+00064640: 6c65 6374 5f62 6573 745f 7661 7269 6162  lect_best_variab
+00064650: 6c65 7328 6d64 2c20 7265 672c 2064 662c  les(md, reg, df,
+00064660: 6e61 6d65 732c 6e5f 6f72 6967 5f66 6561  names,n_orig_fea
+00064670: 7475 7265 732c 4164 645f 506f 6c79 2c76  tures,Add_Poly,v
+00064680: 6572 626f 7365 3d30 293a 0d0a 2020 2020  erbose=0):..    
+00064690: 2222 220d 0a20 2020 2054 6869 7320 7072  """..    This pr
+000646a0: 6f67 7261 6d20 7365 6c65 6374 7320 7468  ogram selects th
+000646b0: 6520 746f 7020 3130 2520 6f66 2069 6e74  e top 10% of int
+000646c0: 6572 6163 7469 6f6e 2076 6172 6961 626c  eraction variabl
+000646d0: 6573 2063 7265 6174 6564 2075 7369 6e67  es created using
+000646e0: 206c 696e 6561 7220 6d6f 6465 6c69 6e67   linear modeling
+000646f0: 2e0d 0a20 2020 2022 2222 0d0a 2020 2020  ...    """..    
+00064700: 6466 3930 203d 2064 665b 6162 7328 6466  df90 = df[abs(df
+00064710: 5b27 436f 6566 6669 6369 656e 7420 5661  ['Coefficient Va
+00064720: 6c75 6573 275d 293e 3d64 665b 2743 6f65  lues'])>=df['Coe
+00064730: 6666 6963 6965 6e74 2056 616c 7565 7327  fficient Values'
+00064740: 5d2e 7175 616e 7469 6c65 2830 2e39 3029  ].quantile(0.90)
+00064750: 5d0d 0a20 2020 2069 6620 7665 7262 6f73  ]..    if verbos
+00064760: 6520 3e3d 2031 3a0d 0a20 2020 2020 2020  e >= 1:..       
+00064770: 2064 6639 302e 706c 6f74 280d 0a20 2020   df90.plot(..   
+00064780: 2020 2020 2020 2020 206b 696e 643d 2762           kind='b
+00064790: 6172 272c 783d 2749 6e74 6572 6163 7469  ar',x='Interacti
+000647a0: 6f6e 2056 6172 6961 626c 6520 4e61 6d65  on Variable Name
+000647b0: 7327 2c79 3d27 436f 6566 6669 6369 656e  s',y='Coefficien
+000647c0: 7420 5661 6c75 6573 272c 0d0a 2020 2020  t Values',..    
+000647d0: 2020 2020 2020 2020 7469 746c 653d 2754          title='T
+000647e0: 6f70 2031 3025 2056 6172 6961 626c 6520  op 10% Variable 
+000647f0: 496e 7465 7261 6374 696f 6e73 2061 6e64  Interactions and
+00064800: 2074 6865 6972 2043 6f65 6666 6963 6965   their Coefficie
+00064810: 6e74 7320 2729 0d0a 2020 2020 6966 2076  nts ')..    if v
+00064820: 6572 626f 7365 203e 3d20 313a 0d0a 2020  erbose >= 1:..  
+00064830: 2020 2020 2020 6466 2e70 6c6f 7428 6b69        df.plot(ki
+00064840: 6e64 3d27 6261 7227 2c78 3d27 496e 7465  nd='bar',x='Inte
+00064850: 7261 6374 696f 6e20 5661 7269 6162 6c65  raction Variable
+00064860: 204e 616d 6573 272c 793d 2743 6f65 6666   Names',y='Coeff
+00064870: 6963 6965 6e74 2056 616c 7565 7327 2c0d  icient Values',.
+00064880: 0a20 2020 2020 2020 2020 2020 2020 2020  .               
+00064890: 2074 6974 6c65 3d27 416c 6c20 5661 7269   title='All Vari
+000648a0: 6162 6c65 2049 6e74 6572 6163 7469 6f6e  able Interaction
+000648b0: 7320 616e 6420 7468 6569 7220 436f 6566  s and their Coef
+000648c0: 6669 6369 656e 7473 272c 6669 6773 697a  ficients',figsiz
+000648d0: 653d 2832 302c 3130 2929 0d0a 2020 2020  e=(20,10))..    
+000648e0: 696e 7465 7261 6374 696f 6e73 203d 2064  interactions = d
+000648f0: 6639 305b 2749 6e74 6572 6163 7469 6f6e  f90['Interaction
+00064900: 2056 6172 6961 626c 6520 4e61 6d65 7327   Variable Names'
+00064910: 5d2e 7661 6c75 6573 2e74 6f6c 6973 7428  ].values.tolist(
+00064920: 290d 0a20 2020 2070 7269 6e74 2827 2564  )..    print('%d
+00064930: 2049 6e74 6572 6163 7469 6f6e 2061 6e64   Interaction and
+00064940: 2050 6f6c 796e 6f6d 6961 6c20 7661 7269   Polynomial vari
+00064950: 6162 6c65 2873 2920 7365 6c65 6374 6564  able(s) selected
+00064960: 2e2e 2e5c 6e27 2025 6c65 6e28 696e 7465  ...\n' %len(inte
+00064970: 7261 6374 696f 6e73 2929 0d0a 2020 2020  ractions))..    
+00064980: 6669 6e61 6c76 6172 7320 3d20 6e61 6d65  finalvars = name
+00064990: 7320 2b20 696e 7465 7261 6374 696f 6e73  s + interactions
+000649a0: 0d0a 2020 2020 2366 696e 616c 7661 7273  ..    #finalvars
+000649b0: 5f69 6e64 6578 203d 205b 6466 5b64 665b  _index = [df[df[
+000649c0: 2749 6e74 6572 6163 7469 6f6e 2056 6172  'Interaction Var
+000649d0: 6961 626c 6520 4e61 6d65 7327 5d3d 3d78  iable Names']==x
+000649e0: 5d2e 696e 6465 785b 305d 2066 6f72 2078  ].index[0] for x
+000649f0: 2069 6e20 6669 6e61 6c76 6172 735d 0d0a   in finalvars]..
+00064a00: 2020 2020 7265 7475 726e 2066 696e 616c      return final
+00064a10: 7661 7273 0d0a 2323 2323 2323 2323 2323  vars..##########
+00064a20: 2323 2323 2323 2323 2323 2323 2323 2323  ################
+00064a30: 2323 2323 2323 2323 2323 2323 2323 2323  ################
+00064a40: 2323 2323 2323 2323 2323 2323 2323 2323  ################
+00064a50: 2323 2323 2323 2323 2323 2323 2323 2323  ################
+00064a60: 2323 2323 2323 2323 2323 2323 2323 2323  ################
+00064a70: 2323 2323 0d0a 6672 6f6d 2073 6b6c 6561  ####..from sklea
+00064a80: 726e 2e6d 6574 7269 6373 2069 6d70 6f72  rn.metrics impor
+00064a90: 7420 726f 635f 6375 7276 652c 2061 7563  t roc_curve, auc
+00064aa0: 0d0a 6672 6f6d 2073 6369 7079 2069 6d70  ..from scipy imp
+00064ab0: 6f72 7420 696e 7465 7270 0d0a 696d 706f  ort interp..impo
+00064ac0: 7274 2070 616e 6461 7320 6173 2070 640d  rt pandas as pd.
+00064ad0: 0a64 6566 2044 7261 775f 524f 435f 4d43  .def Draw_ROC_MC
+00064ae0: 5f4d 4c28 6d6f 6465 6c2c 2058 5f74 6573  _ML(model, X_tes
+00064af0: 742c 2079 5f74 7275 652c 2074 6172 6765  t, y_true, targe
+00064b00: 742c 206d 6f64 656c 5f6e 616d 652c 2076  t, model_name, v
+00064b10: 6572 626f 7365 3d30 293a 0d0a 2020 2020  erbose=0):..    
+00064b20: 6669 6773 697a 6520 3d20 2831 302c 2036  figsize = (10, 6
+00064b30: 290d 0a20 2020 2079 5f70 726f 6261 203d  )..    y_proba =
+00064b40: 206d 6f64 656c 2e70 7265 6469 6374 5f70   model.predict_p
+00064b50: 726f 6261 2858 5f74 6573 7429 0d0a 2020  roba(X_test)..  
+00064b60: 2020 7072 6564 6963 7465 6420 3d20 636f    predicted = co
+00064b70: 7079 2e64 6565 7063 6f70 7928 795f 7072  py.deepcopy(y_pr
+00064b80: 6f62 6129 0d0a 2020 2020 7468 7265 7368  oba)..    thresh
+00064b90: 6f6c 6420 3d20 302e 3530 0d0a 2020 2020  old = 0.50..    
+00064ba0: 795f 7072 6564 203d 206d 6f64 656c 2e70  y_pred = model.p
+00064bb0: 7265 6469 6374 2858 5f74 6573 7429 0d0a  redict(X_test)..
+00064bc0: 2020 2020 6670 7220 3d20 6469 6374 2829      fpr = dict()
+00064bd0: 0d0a 2020 2020 7470 7220 3d20 6469 6374  ..    tpr = dict
+00064be0: 2829 0d0a 2020 2020 726f 635f 6175 6320  ()..    roc_auc 
+00064bf0: 3d20 6469 6374 2829 0d0a 2020 2020 6974  = dict()..    it
+00064c00: 6572 6174 696f 6e73 203d 2030 0d0a 2020  erations = 0..  
+00064c10: 2020 7261 7265 5f63 6c61 7373 203d 2066    rare_class = f
+00064c20: 696e 645f 7261 7265 5f63 6c61 7373 2879  ind_rare_class(y
+00064c30: 5f74 7275 6529 0d0a 2020 2020 6966 2069  _true)..    if i
+00064c40: 7369 6e73 7461 6e63 6528 7461 7267 6574  sinstance(target
+00064c50: 2c73 7472 293a 0d0a 2020 2020 2020 2020  ,str):..        
+00064c60: 7461 7267 6574 203d 205b 7461 7267 6574  target = [target
+00064c70: 5d0d 0a20 2020 2066 6f72 2074 6172 6720  ]..    for targ 
+00064c80: 696e 2074 6172 6765 743a 0d0a 2020 2020  in target:..    
+00064c90: 2020 2020 6966 206c 656e 286c 6566 745f      if len(left_
+00064ca0: 7375 6274 7261 6374 286e 702e 756e 6971  subtract(np.uniq
+00064cb0: 7565 2879 5f74 7275 6529 2c6e 702e 756e  ue(y_true),np.un
+00064cc0: 6971 7565 2879 5f70 7265 6429 2929 203d  ique(y_pred))) =
+00064cd0: 3d20 303a 0d0a 2020 2020 2020 2020 2020  = 0:..          
+00064ce0: 2020 636c 6173 7365 7320 3d20 6c69 7374    classes = list
+00064cf0: 2872 616e 6765 286c 656e 286e 702e 756e  (range(len(np.un
+00064d00: 6971 7565 2879 5f74 7275 6529 2929 290d  ique(y_true)))).
+00064d10: 0a20 2020 2020 2020 2065 6c73 653a 0d0a  .        else:..
+00064d20: 2020 2020 2020 2020 2020 2020 636c 6173              clas
+00064d30: 7365 7320 3d20 6c69 7374 2872 616e 6765  ses = list(range
+00064d40: 286c 656e 286e 702e 756e 6971 7565 2879  (len(np.unique(y
+00064d50: 5f70 7265 6429 2929 290d 0a20 2020 2020  _pred))))..     
+00064d60: 2020 206e 5f63 6c61 7373 6573 203d 206c     n_classes = l
+00064d70: 656e 2863 6c61 7373 6573 290d 0a20 2020  en(classes)..   
+00064d80: 2020 2020 2069 6620 6d6f 6465 6c5f 6e61       if model_na
+00064d90: 6d65 2e6c 6f77 6572 2829 203d 3d20 2763  me.lower() == 'c
+00064da0: 6174 626f 6f73 7427 3a0d 0a20 2020 2020  atboost':..     
+00064db0: 2020 2020 2020 2074 7279 3a0d 0a20 2020         try:..   
+00064dc0: 2020 2020 2020 2020 2020 2020 2079 5f70               y_p
+00064dd0: 7265 6420 3d20 2879 5f70 726f 6261 3e30  red = (y_proba>0
+00064de0: 2e35 292e 6173 7479 7065 2869 6e74 292e  .5).astype(int).
+00064df0: 646f 7428 636c 6173 7365 7329 0d0a 2020  dot(classes)..  
+00064e00: 2020 2020 2020 2020 2020 6578 6365 7074            except
+00064e10: 3a0d 0a20 2020 2020 2020 2020 2020 2020  :..             
+00064e20: 2020 2070 6173 730d 0a20 2020 2020 2020     pass..       
+00064e30: 2069 6620 6e5f 636c 6173 7365 7320 3d3d   if n_classes ==
+00064e40: 2032 3a0d 0a20 2020 2020 2020 2020 2020   2:..           
+00064e50: 2023 2323 2041 6c77 6179 7320 7365 7420   ### Always set 
+00064e60: 7261 7265 5f63 6c61 7373 2074 6f20 3120  rare_class to 1 
+00064e70: 7768 656e 2074 6865 7265 2061 7265 206f  when there are o
+00064e80: 6e6c 7920 3220 636c 6173 7365 7320 666f  nly 2 classes fo
+00064e90: 7220 6472 6177 696e 6720 524f 4320 4375  r drawing ROC Cu
+00064ea0: 7276 6521 0d0a 2020 2020 2020 2020 2020  rve!..          
+00064eb0: 2020 795f 7465 7374 203d 2063 6f70 792e    y_test = copy.
+00064ec0: 6465 6570 636f 7079 2879 5f74 7275 6529  deepcopy(y_true)
+00064ed0: 0d0a 2020 2020 2020 2020 2020 2020 7072  ..            pr
+00064ee0: 6564 6963 7465 6420 5b3a 2c30 5d20 3d20  edicted [:,0] = 
+00064ef0: 2870 7265 6469 6374 6564 205b 3a2c 305d  (predicted [:,0]
+00064f00: 203e 3d20 2831 2d6d 5f74 6872 6573 6829   >= (1-m_thresh)
+00064f10: 292e 6173 7479 7065 2827 696e 7427 290d  ).astype('int').
+00064f20: 0a20 2020 2020 2020 2020 2020 2070 7265  .            pre
+00064f30: 6469 6374 6564 205b 3a2c 315d 203d 2028  dicted [:,1] = (
+00064f40: 7072 6564 6963 7465 6420 5b3a 2c31 5d20  predicted [:,1] 
+00064f50: 3e20 7468 7265 7368 6f6c 6429 2e61 7374  > threshold).ast
+00064f60: 7970 6528 2769 6e74 2729 0d0a 2020 2020  ype('int')..    
+00064f70: 2020 2020 2020 2020 795f 7072 6564 203d          y_pred =
+00064f80: 2070 7265 6469 6374 6564 5b3a 2c72 6172   predicted[:,rar
+00064f90: 655f 636c 6173 735d 0d0a 2020 2020 2020  e_class]..      
+00064fa0: 2020 656c 7365 3a0d 0a20 2020 2020 2020    else:..       
+00064fb0: 2020 2020 2079 5f74 6573 7420 3d20 6c61       y_test = la
+00064fc0: 6265 6c5f 6269 6e61 7269 7a65 2879 5f74  bel_binarize(y_t
+00064fd0: 7275 652c 2063 6c61 7373 6573 290d 0a20  rue, classes).. 
+00064fe0: 2020 2020 2020 2074 7279 3a0d 0a20 2020         try:..   
+00064ff0: 2020 2020 2020 2020 2069 6620 6e5f 636c           if n_cl
+00065000: 6173 7365 7320 3e20 323a 0d0a 2020 2020  asses > 2:..    
+00065010: 2020 2020 2020 2020 2020 2020 6966 2079              if y
+00065020: 5f74 6573 742e 7368 6170 655b 315d 203d  _test.shape[1] =
+00065030: 3d20 795f 7072 6f62 612e 7368 6170 655b  = y_proba.shape[
+00065040: 315d 3a0d 0a20 2020 2020 2020 2020 2020  1]:..           
+00065050: 2020 2020 2020 2020 2063 6c61 7373 6573           classes
+00065060: 203d 206c 6973 7428 7261 6e67 6528 795f   = list(range(y_
+00065070: 7465 7374 2e73 6861 7065 5b31 5d29 290d  test.shape[1])).
+00065080: 0a20 2020 2020 2020 2020 2020 2020 2020  .               
+00065090: 2065 6c73 653a 0d0a 2020 2020 2020 2020   else:..        
+000650a0: 2020 2020 2020 2020 2020 2020 6966 2079              if y
+000650b0: 5f70 726f 6261 2e73 6861 7065 5b31 5d20  _proba.shape[1] 
+000650c0: 3e20 795f 7465 7374 2e73 6861 7065 5b31  > y_test.shape[1
+000650d0: 5d3a 0d0a 2020 2020 2020 2020 2020 2020  ]:..            
+000650e0: 2020 2020 2020 2020 2020 2020 636c 6173              clas
+000650f0: 7365 7320 3d20 6c69 7374 2872 616e 6765  ses = list(range
+00065100: 2879 5f70 726f 6261 2e73 6861 7065 5b31  (y_proba.shape[1
+00065110: 5d29 290d 0a20 2020 2020 2020 2020 2020  ]))..           
+00065120: 2020 2020 2020 2020 2065 6c73 653a 0d0a           else:..
+00065130: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00065140: 2020 2020 2020 2020 636c 6173 7365 7320          classes 
+00065150: 3d20 6c69 7374 2872 616e 6765 2879 5f74  = list(range(y_t
+00065160: 6573 742e 7368 6170 655b 315d 2929 0d0a  est.shape[1]))..
+00065170: 2020 2020 2020 2020 6578 6365 7074 3a0d          except:.
+00065180: 0a20 2020 2020 2020 2020 2020 2070 6173  .            pas
+00065190: 730d 0a20 2020 2020 2020 2069 6620 6e5f  s..        if n_
+000651a0: 636c 6173 7365 7320 3d3d 2032 3a0d 0a20  classes == 2:.. 
+000651b0: 2020 2020 2020 2020 2020 2069 7465 7261             itera
+000651c0: 7469 6f6e 7320 3d20 310d 0a20 2020 2020  tions = 1..     
+000651d0: 2020 2065 6c73 653a 0d0a 2020 2020 2020     else:..      
+000651e0: 2020 2020 2020 6974 6572 6174 696f 6e73        iterations
+000651f0: 203d 2063 6f70 792e 6465 6570 636f 7079   = copy.deepcopy
+00065200: 286e 5f63 6c61 7373 6573 290d 0a20 2020  (n_classes)..   
+00065210: 2020 2020 2023 2323 2323 2323 2323 2323       ###########
+00065220: 2323 2323 2323 2323 2323 2020 2054 6869  ##########   Thi
+00065230: 7320 6973 2077 6865 7265 2079 6f75 2063  s is where you c
+00065240: 616c 6375 6c61 7465 2052 4f43 5f41 5543  alculate ROC_AUC
+00065250: 2066 6f72 2061 6c6c 2063 6c61 7373 6573   for all classes
+00065260: 2023 2323 2323 2323 2323 0d0a 2020 2020   #########..    
+00065270: 2020 2020 666f 7220 6920 696e 2072 616e      for i in ran
+00065280: 6765 2869 7465 7261 7469 6f6e 7329 3a0d  ge(iterations):.
+00065290: 0a20 2020 2020 2020 2020 2020 2069 6620  .            if 
+000652a0: 6e5f 636c 6173 7365 733d 3d32 3a0d 0a20  n_classes==2:.. 
+000652b0: 2020 2020 2020 2020 2020 2020 2020 2066                 f
+000652c0: 7072 5b72 6172 655f 636c 6173 735d 2c20  pr[rare_class], 
+000652d0: 7470 725b 7261 7265 5f63 6c61 7373 5d2c  tpr[rare_class],
+000652e0: 205f 203d 2072 6f63 5f63 7572 7665 2879   _ = roc_curve(y
+000652f0: 5f74 6573 742e 7261 7665 6c28 292c 2079  _test.ravel(), y
+00065300: 5f70 726f 6261 5b3a 2c72 6172 655f 636c  _proba[:,rare_cl
+00065310: 6173 735d 290d 0a20 2020 2020 2020 2020  ass])..         
+00065320: 2020 2020 2020 2072 6f63 5f61 7563 5b72         roc_auc[r
+00065330: 6172 655f 636c 6173 735d 203d 2061 7563  are_class] = auc
+00065340: 2866 7072 5b72 6172 655f 636c 6173 735d  (fpr[rare_class]
+00065350: 2c20 7470 725b 7261 7265 5f63 6c61 7373  , tpr[rare_class
+00065360: 5d29 0d0a 2020 2020 2020 2020 2020 2020  ])..            
+00065370: 656c 7365 3a0d 0a20 2020 2020 2020 2020  else:..         
+00065380: 2020 2020 2020 2066 7072 5b69 5d2c 2074         fpr[i], t
+00065390: 7072 5b69 5d2c 205f 203d 2072 6f63 5f63  pr[i], _ = roc_c
+000653a0: 7572 7665 2879 5f74 6573 745b 3a2c 695d  urve(y_test[:,i]
+000653b0: 2c20 795f 7072 6f62 615b 3a2c 695d 290d  , y_proba[:,i]).
+000653c0: 0a20 2020 2020 2020 2020 2020 2020 2020  .               
+000653d0: 2072 6f63 5f61 7563 5b69 5d20 3d20 6175   roc_auc[i] = au
+000653e0: 6328 6670 725b 695d 2c20 7470 725b 695d  c(fpr[i], tpr[i]
+000653f0: 290d 0a20 2020 2020 2020 2023 2323 2043  )..        ### C
+00065400: 6f6d 7075 7465 204d 6963 726f 2041 7665  ompute Micro Ave
+00065410: 7261 6765 2077 6869 6368 2069 7320 6120  rage which is a 
+00065420: 726f 772d 6279 2d72 6f77 2073 636f 7265  row-by-row score
+00065430: 2023 2323 2323 2323 2323 2323 0d0a 2020   ###########..  
+00065440: 2020 2020 2020 7472 793a 0d0a 2020 2020        try:..    
+00065450: 2020 2020 2020 2020 6966 206e 5f63 6c61          if n_cla
+00065460: 7373 6573 203d 3d20 323a 0d0a 2020 2020  sses == 2:..    
+00065470: 2020 2020 2020 2020 2020 2020 6670 725b              fpr[
+00065480: 226d 6963 726f 225d 2c20 7470 725b 226d  "micro"], tpr["m
+00065490: 6963 726f 225d 2c20 5f20 3d20 726f 635f  icro"], _ = roc_
+000654a0: 6375 7276 6528 795f 7465 7374 2e72 6176  curve(y_test.rav
+000654b0: 656c 2829 2c20 795f 7072 6564 2e72 6176  el(), y_pred.rav
+000654c0: 656c 2829 290d 0a20 2020 2020 2020 2020  el())..         
+000654d0: 2020 2065 6c73 653a 0d0a 2020 2020 2020     else:..      
+000654e0: 2020 2020 2020 2020 2020 6670 725b 226d            fpr["m
+000654f0: 6963 726f 225d 2c20 7470 725b 226d 6963  icro"], tpr["mic
+00065500: 726f 225d 2c20 5f20 3d20 726f 635f 6375  ro"], _ = roc_cu
+00065510: 7276 6528 795f 7465 7374 2e72 6176 656c  rve(y_test.ravel
+00065520: 2829 2c6c 6162 656c 5f62 696e 6172 697a  (),label_binariz
+00065530: 6528 795f 7072 6564 2c20 636c 6173 7365  e(y_pred, classe
+00065540: 7329 2e72 6176 656c 2829 290d 0a20 2020  s).ravel())..   
+00065550: 2020 2020 2065 7863 6570 743a 0d0a 2020       except:..  
+00065560: 2020 2020 2020 2020 2020 6966 2079 5f74            if y_t
+00065570: 6573 742e 7261 7665 6c28 292e 7368 6170  est.ravel().shap
+00065580: 655b 305d 2021 3d20 795f 7072 6564 2e72  e[0] != y_pred.r
+00065590: 6176 656c 2829 2e73 6861 7065 5b30 5d3a  avel().shape[0]:
+000655a0: 0d0a 2020 2020 2020 2020 2020 2020 2020  ..              
+000655b0: 2020 6670 725b 226d 6963 726f 225d 2c20    fpr["micro"], 
+000655c0: 7470 725b 226d 6963 726f 225d 2c20 5f20  tpr["micro"], _ 
+000655d0: 3d20 726f 635f 6375 7276 6528 795f 7465  = roc_curve(y_te
+000655e0: 7374 5b3a 2c3a 6e5f 636c 6173 7365 735d  st[:,:n_classes]
+000655f0: 2e72 6176 656c 2829 2c20 795f 7072 6f62  .ravel(), y_prob
+00065600: 615b 3a2c 3a6e 5f63 6c61 7373 6573 5d2e  a[:,:n_classes].
+00065610: 7261 7665 6c28 2929 0d0a 2020 2020 2020  ravel())..      
+00065620: 2020 2020 2020 656c 7365 3a0d 0a20 2020        else:..   
+00065630: 2020 2020 2020 2020 2020 2020 2066 7072               fpr
+00065640: 5b22 6d69 6372 6f22 5d2c 2074 7072 5b22  ["micro"], tpr["
+00065650: 6d69 6372 6f22 5d2c 205f 203d 2072 6f63  micro"], _ = roc
+00065660: 5f63 7572 7665 2879 5f74 6573 742e 7261  _curve(y_test.ra
+00065670: 7665 6c28 292c 2079 5f70 726f 6261 5b3a  vel(), y_proba[:
+00065680: 2c72 6172 655f 636c 6173 735d 2e72 6176  ,rare_class].rav
+00065690: 656c 2829 290d 0a20 2020 2020 2020 2074  el())..        t
+000656a0: 7279 3a0d 0a20 2020 2020 2020 2020 2020  ry:..           
+000656b0: 2072 6f63 5f61 7563 5b22 6d69 6372 6f22   roc_auc["micro"
+000656c0: 5d20 3d20 6175 6328 6670 725b 226d 6963  ] = auc(fpr["mic
+000656d0: 726f 225d 2c20 7470 725b 226d 6963 726f  ro"], tpr["micro
+000656e0: 225d 290d 0a20 2020 2020 2020 2065 7863  "])..        exc
+000656f0: 6570 743a 0d0a 2020 2020 2020 2020 2020  ept:..          
+00065700: 2020 7061 7373 0d0a 2020 2020 2020 2020    pass..        
+00065710: 2320 6d69 6372 6f2d 6176 6572 6167 6520  # micro-average 
+00065720: 524f 4320 6375 7276 6520 616e 6420 524f  ROC curve and RO
+00065730: 4320 6172 6561 2068 6173 2062 6565 6e20  C area has been 
+00065740: 636f 6d70 7574 6564 0d0a 2020 2020 2020  computed..      
+00065750: 2020 6c61 6265 6c73 203d 205b 5d0d 0a20    labels = [].. 
+00065760: 2020 2020 2020 2069 6620 6e5f 636c 6173         if n_clas
+00065770: 7365 7320 3c3d 2032 3a0d 0a20 2020 2020  ses <= 2:..     
+00065780: 2020 2020 2020 2023 2323 2323 2323 2323         #########
+00065790: 2323 2323 2323 2323 2323 2323 2323 2323  ################
+000657a0: 2323 2323 2323 2323 2323 2323 2323 2323  ################
+000657b0: 2323 2323 2323 2323 2323 2323 2323 2323  ################
+000657c0: 2323 2323 2323 2323 2323 2323 2323 2323  ################
+000657d0: 2323 2323 230d 0a20 2020 2020 2020 2020  #####..         
+000657e0: 2020 2023 2050 6c6f 7420 6f66 2061 2052     # Plot of a R
+000657f0: 4f43 2063 7572 7665 2066 6f72 206f 6e65  OC curve for one
+00065800: 2063 6c61 7373 0d0a 2020 2020 2020 2020   class..        
+00065810: 2020 2020 706c 742e 6669 6775 7265 2866      plt.figure(f
+00065820: 6967 7369 7a65 3d66 6967 7369 7a65 290d  igsize=figsize).
+00065830: 0a20 2020 2020 2020 2020 2020 2070 6c74  .            plt
+00065840: 2e70 6c6f 7428 6670 725b 7261 7265 5f63  .plot(fpr[rare_c
+00065850: 6c61 7373 5d2c 2074 7072 5b72 6172 655f  lass], tpr[rare_
+00065860: 636c 6173 735d 2c20 6c61 6265 6c3d 2752  class], label='R
+00065870: 4f43 2063 7572 7665 2028 4155 4320 3d20  OC curve (AUC = 
+00065880: 2530 2e35 6629 2720 2520 726f 635f 6175  %0.5f)' % roc_au
+00065890: 635b 7261 7265 5f63 6c61 7373 5d29 0d0a  c[rare_class])..
+000658a0: 2020 2020 2020 2020 2020 2020 706c 742e              plt.
+000658b0: 706c 6f74 285b 302c 2031 5d2c 205b 302c  plot([0, 1], [0,
+000658c0: 2031 5d2c 2027 6b2d 2d27 290d 0a20 2020   1], 'k--')..   
+000658d0: 2020 2020 2020 2020 2070 6c74 2e78 6c69           plt.xli
+000658e0: 6d28 5b30 2e30 2c20 312e 305d 290d 0a20  m([0.0, 1.0]).. 
+000658f0: 2020 2020 2020 2020 2020 2070 6c74 2e79             plt.y
+00065900: 6c69 6d28 5b30 2e30 2c20 312e 3035 5d29  lim([0.0, 1.05])
+00065910: 0d0a 2020 2020 2020 2020 2020 2020 706c  ..            pl
+00065920: 742e 786c 6162 656c 2827 4661 6c73 6520  t.xlabel('False 
+00065930: 506f 7369 7469 7665 2052 6174 6527 290d  Positive Rate').
+00065940: 0a20 2020 2020 2020 2020 2020 2070 6c74  .            plt
+00065950: 2e79 6c61 6265 6c28 2754 7275 6520 506f  .ylabel('True Po
+00065960: 7369 7469 7665 2052 6174 6527 290d 0a20  sitive Rate').. 
+00065970: 2020 2020 2020 2020 2020 2070 6c74 2e74             plt.t
+00065980: 6974 6c65 2827 524f 4320 4375 7276 6520  itle('ROC Curve 
+00065990: 666f 7220 5072 6564 6963 7469 6f6e 7320  for Predictions 
+000659a0: 6f6e 2068 656c 6420 6f75 7420 6461 7461  on held out data
+000659b0: 2066 6f72 2074 6172 6765 743a 2025 7327   for target: %s'
+000659c0: 2025 7461 7267 290d 0a20 2020 2020 2020   %targ)..       
+000659d0: 2020 2020 2070 6c74 2e6c 6567 656e 6428       plt.legend(
+000659e0: 6c6f 633d 226c 6f77 6572 2072 6967 6874  loc="lower right
+000659f0: 2229 0d0a 2020 2020 2020 2020 2020 2020  ")..            
+00065a00: 706c 742e 7368 6f77 2829 3b0d 0a20 2020  plt.show();..   
+00065a10: 2020 2020 2065 6c73 653a 0d0a 2020 2020       else:..    
+00065a20: 2020 2020 2320 436f 6d70 7574 6520 6d61      # Compute ma
+00065a30: 6372 6f2d 6176 6572 6167 6520 524f 4320  cro-average ROC 
+00065a40: 6375 7276 6520 616e 6420 524f 4320 6172  curve and ROC ar
+00065a50: 6561 0d0a 2020 2020 2020 2020 2020 2020  ea..            
+00065a60: 6669 672c 2061 7820 3d20 706c 742e 7375  fig, ax = plt.su
+00065a70: 6270 6c6f 7473 2866 6967 7369 7a65 3d66  bplots(figsize=f
+00065a80: 6967 7369 7a65 290d 0a20 2020 2020 2020  igsize)..       
+00065a90: 2020 2020 2063 6f6c 6f72 7320 3d20 6379       colors = cy
+00065aa0: 636c 6528 2762 7972 636d 676b 6279 7263  cle('byrcmgkbyrc
+00065ab0: 6d67 6b62 7972 636d 676b 6279 7263 6d67  mgkbyrcmgkbyrcmg
+00065ac0: 6b27 290d 0a20 2020 2020 2020 2020 2020  k')..           
+00065ad0: 2066 6f72 2069 2069 6e20 7261 6e67 6528   for i in range(
+00065ae0: 6974 6572 6174 696f 6e73 293a 0d0a 0d0a  iterations):....
+00065af0: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00065b00: 2320 4669 7273 7420 6167 6772 6567 6174  # First aggregat
+00065b10: 6520 616c 6c20 6661 6c73 6520 706f 7369  e all false posi
+00065b20: 7469 7665 2072 6174 6573 0d0a 2020 2020  tive rates..    
+00065b30: 2020 2020 2020 2020 2020 2020 616c 6c5f              all_
+00065b40: 6670 7220 3d20 6e70 2e75 6e69 7175 6528  fpr = np.unique(
+00065b50: 6e70 2e63 6f6e 6361 7465 6e61 7465 285b  np.concatenate([
+00065b60: 6670 725b 695d 2066 6f72 2069 2069 6e20  fpr[i] for i in 
+00065b70: 7261 6e67 6528 6e5f 636c 6173 7365 7329  range(n_classes)
+00065b80: 5d29 290d 0a0d 0a20 2020 2020 2020 2020  ]))....         
+00065b90: 2020 2020 2020 2023 2054 6865 6e20 696e         # Then in
+00065ba0: 7465 7270 6f6c 6174 6520 616c 6c20 524f  terpolate all RO
+00065bb0: 4320 6375 7276 6573 2061 7420 7468 6973  C curves at this
+00065bc0: 2070 6f69 6e74 730d 0a20 2020 2020 2020   points..       
+00065bd0: 2020 2020 2020 2020 206d 6561 6e5f 7470           mean_tp
+00065be0: 7220 3d20 6e70 2e7a 6572 6f73 5f6c 696b  r = np.zeros_lik
+00065bf0: 6528 616c 6c5f 6670 7229 0d0a 2020 2020  e(all_fpr)..    
+00065c00: 2020 2020 2020 2020 2020 2020 666f 7220              for 
+00065c10: 6a20 696e 2072 616e 6765 286e 5f63 6c61  j in range(n_cla
+00065c20: 7373 6573 293a 0d0a 2020 2020 2020 2020  sses):..        
+00065c30: 2020 2020 2020 2020 2020 2020 6d65 616e              mean
+00065c40: 5f74 7072 202b 3d20 696e 7465 7270 2861  _tpr += interp(a
+00065c50: 6c6c 5f66 7072 2c20 6670 725b 6a5d 2c20  ll_fpr, fpr[j], 
+00065c60: 7470 725b 6a5d 290d 0a0d 0a20 2020 2020  tpr[j])....     
+00065c70: 2020 2020 2020 2020 2020 2023 2046 696e             # Fin
+00065c80: 616c 6c79 2061 7665 7261 6765 2069 7420  ally average it 
+00065c90: 616e 6420 636f 6d70 7574 6520 4155 430d  and compute AUC.
+00065ca0: 0a20 2020 2020 2020 2020 2020 2020 2020  .               
+00065cb0: 206d 6561 6e5f 7470 7220 2f3d 206e 5f63   mean_tpr /= n_c
+00065cc0: 6c61 7373 6573 0d0a 0d0a 2020 2020 2020  lasses....      
+00065cd0: 2020 2020 2020 2020 2020 6670 725b 226d            fpr["m
+00065ce0: 6163 726f 225d 203d 2061 6c6c 5f66 7072  acro"] = all_fpr
+00065cf0: 0d0a 2020 2020 2020 2020 2020 2020 2020  ..              
+00065d00: 2020 7470 725b 226d 6163 726f 225d 203d    tpr["macro"] =
+00065d10: 206d 6561 6e5f 7470 720d 0a20 2020 2020   mean_tpr..     
+00065d20: 2020 2020 2020 2020 2020 2072 6f63 5f61             roc_a
+00065d30: 7563 5b22 6d61 6372 6f22 5d20 3d20 6175  uc["macro"] = au
+00065d40: 6328 6670 725b 226d 6163 726f 225d 2c20  c(fpr["macro"], 
+00065d50: 7470 725b 226d 6163 726f 225d 290d 0a0d  tpr["macro"])...
+00065d60: 0a20 2020 2020 2020 2020 2020 2020 2020  .               
+00065d70: 2023 2050 6c6f 7420 616c 6c20 524f 4320   # Plot all ROC 
+00065d80: 6375 7276 6573 0d0a 2020 2020 2020 2020  curves..        
+00065d90: 2020 2020 2020 2020 6c77 203d 2032 0d0a          lw = 2..
+00065da0: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00065db0: 636f 6c6f 7220 3d20 6e65 7874 2863 6f6c  color = next(col
+00065dc0: 6f72 7329 0d0a 2020 2020 2020 2020 2020  ors)..          
+00065dd0: 2020 2020 2020 6178 2e70 6c6f 7428 6670        ax.plot(fp
+00065de0: 725b 695d 2c20 7470 725b 695d 2c20 636f  r[i], tpr[i], co
+00065df0: 6c6f 723d 636f 6c6f 722c 206c 773d 6c77  lor=color, lw=lw
+00065e00: 290d 0a20 2020 2020 2020 2020 2020 2020  )..             
+00065e10: 2020 206c 6162 656c 732e 6170 7065 6e64     labels.append
+00065e20: 2827 524f 4320 6375 7276 6520 6f66 2063  ('ROC curve of c
+00065e30: 6c61 7373 2025 6420 2861 7265 6120 3d20  lass %d (area = 
+00065e40: 2530 2e32 6629 2720 2528 692c 2072 6f63  %0.2f)' %(i, roc
+00065e50: 5f61 7563 5b69 5d29 290d 0a20 2020 2020  _auc[i]))..     
+00065e60: 2020 2020 2020 2074 7279 3a0d 0a20 2020         try:..   
+00065e70: 2020 2020 2020 2020 2020 2020 206c 6162               lab
+00065e80: 656c 732e 6170 7065 6e64 2827 6d69 6372  els.append('micr
+00065e90: 6f2d 6176 6572 6167 6520 524f 4320 6375  o-average ROC cu
+00065ea0: 7276 6520 2861 7265 6120 3d20 7b30 3a30  rve (area = {0:0
+00065eb0: 2e32 667d 2927 0d0a 2020 2020 2020 2020  .2f})'..        
+00065ec0: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00065ed0: 2020 2020 2020 2027 272e 666f 726d 6174         ''.format
+00065ee0: 2872 6f63 5f61 7563 5b22 6d69 6372 6f22  (roc_auc["micro"
+00065ef0: 5d29 290d 0a20 2020 2020 2020 2020 2020  ]))..           
+00065f00: 2020 2020 2061 782e 706c 6f74 2866 7072       ax.plot(fpr
+00065f10: 5b22 6d69 6372 6f22 5d2c 2074 7072 5b22  ["micro"], tpr["
+00065f20: 6d69 6372 6f22 5d2c 0d0a 2020 2020 2020  micro"],..      
+00065f30: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00065f40: 2020 2063 6f6c 6f72 3d27 6465 6570 7069     color='deeppi
+00065f50: 6e6b 272c 206c 696e 6573 7479 6c65 3d27  nk', linestyle='
+00065f60: 3a27 2c20 6c69 6e65 7769 6474 683d 3429  :', linewidth=4)
+00065f70: 0d0a 2020 2020 2020 2020 2020 2020 6578  ..            ex
+00065f80: 6365 7074 3a0d 0a20 2020 2020 2020 2020  cept:..         
+00065f90: 2020 2020 2020 2070 6173 730d 0a20 2020         pass..   
+00065fa0: 2020 2020 2020 2020 2074 7279 3a0d 0a20           try:.. 
+00065fb0: 2020 2020 2020 2020 2020 2020 2020 206c                 l
+00065fc0: 6162 656c 732e 6170 7065 6e64 2827 6d61  abels.append('ma
+00065fd0: 6372 6f2d 6176 6572 6167 6520 524f 4320  cro-average ROC 
+00065fe0: 6375 7276 6520 2861 7265 6120 3d20 7b30  curve (area = {0
+00065ff0: 3a30 2e32 667d 2927 0d0a 2020 2020 2020  :0.2f})'..      
+00066000: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00066010: 2020 2020 2020 2020 2027 272e 666f 726d           ''.form
+00066020: 6174 2872 6f63 5f61 7563 5b22 6d61 6372  at(roc_auc["macr
+00066030: 6f22 5d29 290d 0a20 2020 2020 2020 2020  o"]))..         
+00066040: 2020 2020 2020 2061 782e 706c 6f74 2866         ax.plot(f
+00066050: 7072 5b22 6d61 6372 6f22 5d2c 2074 7072  pr["macro"], tpr
+00066060: 5b22 6d61 6372 6f22 5d2c 0d0a 2020 2020  ["macro"],..    
+00066070: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00066080: 2020 2020 2063 6f6c 6f72 3d27 6e61 7679       color='navy
+00066090: 272c 206c 696e 6573 7479 6c65 3d27 3a27  ', linestyle=':'
+000660a0: 2c20 6c69 6e65 7769 6474 683d 3429 0d0a  , linewidth=4)..
+000660b0: 2020 2020 2020 2020 2020 2020 6578 6365              exce
+000660c0: 7074 3a0d 0a20 2020 2020 2020 2020 2020  pt:..           
+000660d0: 2020 2020 2070 6173 730d 0a20 2020 2020       pass..     
+000660e0: 2020 2020 2020 2061 782e 706c 6f74 285b         ax.plot([
+000660f0: 302c 2031 5d2c 205b 302c 2031 5d2c 2027  0, 1], [0, 1], '
+00066100: 6b2d 2d27 2c20 6c77 3d6c 7729 0d0a 2020  k--', lw=lw)..  
+00066110: 2020 2020 2020 2020 2020 6178 2e73 6574            ax.set
+00066120: 5f78 6c69 6d28 5b30 2e30 2c20 312e 305d  _xlim([0.0, 1.0]
+00066130: 290d 0a20 2020 2020 2020 2020 2020 2061  )..            a
+00066140: 782e 7365 745f 796c 696d 285b 302e 302c  x.set_ylim([0.0,
+00066150: 2031 2e30 355d 290d 0a20 2020 2020 2020   1.05])..       
+00066160: 2020 2020 2061 782e 7365 745f 786c 6162       ax.set_xlab
+00066170: 656c 2827 4661 6c73 6520 506f 7369 7469  el('False Positi
+00066180: 7665 2052 6174 6527 290d 0a20 2020 2020  ve Rate')..     
+00066190: 2020 2020 2020 2061 782e 7365 745f 796c         ax.set_yl
+000661a0: 6162 656c 2827 5472 7565 2050 6f73 6974  abel('True Posit
+000661b0: 6976 6520 5261 7465 2729 0d0a 2020 2020  ive Rate')..    
+000661c0: 2020 2020 2020 2020 6178 2e73 6574 5f74          ax.set_t
+000661d0: 6974 6c65 2827 524f 4320 4375 7276 6520  itle('ROC Curve 
+000661e0: 666f 7220 5072 6564 6963 7469 6f6e 7320  for Predictions 
+000661f0: 6f6e 2068 656c 6420 6f75 7420 6461 7461  on held out data
+00066200: 2066 6f72 2074 6172 6765 743a 2025 7327   for target: %s'
+00066210: 2025 7461 7267 290d 0a20 2020 2020 2020   %targ)..       
+00066220: 2020 2020 2070 6c74 2e6c 6567 656e 6428       plt.legend(
+00066230: 6c61 6265 6c73 2c6c 6f63 3d22 6c6f 7765  labels,loc="lowe
+00066240: 7220 7269 6768 7422 290d 0a20 2020 2020  r right")..     
+00066250: 2020 2020 2020 2070 6c74 2e73 686f 7728         plt.show(
+00066260: 293b 0d0a 0d0a 2323 2323 2323 2323 2323  );....##########
+00066270: 2323 2323 2323 2323 2323 2323 2323 2323  ################
+00066280: 2323 2323 2323 2323 2323 2323 2323 2323  ################
+00066290: 2323 2323 2323 2323 2323 2323 2323 2323  ################
+000662a0: 2323 2323 2323 2323 2323 2323 2323 2323  ################
+000662b0: 2323 2323 2323 2323 230d 0a23 2052 656d  #########..# Rem
+000662c0: 6f76 6573 2064 7570 6c69 6361 7465 7320  oves duplicates 
+000662d0: 6672 6f6d 2061 206c 6973 7420 746f 2072  from a list to r
+000662e0: 6574 7572 6e20 756e 6971 7565 2076 616c  eturn unique val
+000662f0: 7565 7320 2d20 5553 4544 204f 4e4c 594f  ues - USED ONLYO
+00066300: 4e43 450d 0a64 6566 2066 696e 645f 7265  NCE..def find_re
+00066310: 6d6f 7665 5f64 7570 6c69 6361 7465 7328  move_duplicates(
+00066320: 7661 6c75 6573 293a 0d0a 2020 2020 6f75  values):..    ou
+00066330: 7470 7574 203d 205b 5d0d 0a20 2020 2073  tput = []..    s
+00066340: 6565 6e20 3d20 7365 7428 290d 0a20 2020  een = set()..   
+00066350: 2066 6f72 2076 616c 7565 2069 6e20 7661   for value in va
+00066360: 6c75 6573 3a0d 0a20 2020 2020 2020 2069  lues:..        i
+00066370: 6620 7661 6c75 6520 6e6f 7420 696e 2073  f value not in s
+00066380: 6565 6e3a 0d0a 2020 2020 2020 2020 2020  een:..          
+00066390: 2020 6f75 7470 7574 2e61 7070 656e 6428    output.append(
+000663a0: 7661 6c75 6529 0d0a 2020 2020 2020 2020  value)..        
+000663b0: 2020 2020 7365 656e 2e61 6464 2876 616c      seen.add(val
+000663c0: 7565 290d 0a20 2020 2072 6574 7572 6e20  ue)..    return 
+000663d0: 6f75 7470 7574 0d0a 2323 2323 2323 2323  output..########
+000663e0: 2323 2323 2323 2323 2323 2323 2323 2323  ################
+000663f0: 2323 2323 2323 2323 2323 2323 2323 2323  ################
+00066400: 2323 2323 2323 2323 2323 2323 2323 2323  ################
+00066410: 2323 2323 2323 2323 2323 2323 2323 2323  ################
+00066420: 2323 2323 2323 2323 2323 230d 0a64 6566  ###########..def
+00066430: 2073 706c 6974 5f64 6174 615f 6e65 7728   split_data_new(
+00066440: 7472 6169 6e66 696c 652c 2074 6573 7466  trainfile, testf
+00066450: 696c 652c 2074 6172 6765 742c 7365 702c  ile, target,sep,
+00066460: 206d 6f64 656c 7479 7065 3d27 5265 6772   modeltype='Regr
+00066470: 6573 7369 6f6e 272c 2072 616e 646f 6d73  ession', randoms
+00066480: 7461 7465 3d30 293a 0d0a 2020 2020 2222  tate=0):..    ""
+00066490: 220d 0a20 2020 2053 706c 6974 2079 6f75  "..    Split you
+000664a0: 7220 6669 6c65 206f 7220 6461 7461 2066  r file or data f
+000664b0: 7261 6d65 2069 6e74 6f20 3220 6f72 2033  rame into 2 or 3
+000664c0: 2073 706c 6974 732e 2053 7472 6174 6966   splits. Stratif
+000664d0: 6965 6420 6279 2043 6c61 7373 2061 7574  ied by Class aut
+000664e0: 6f6d 6174 6963 616c 6c79 2e0d 0a20 2020  omatically...   
+000664f0: 2041 6464 6974 696f 6e61 6c6c 792c 2069   Additionally, i
+00066500: 7420 7769 6c6c 2073 7472 6970 206f 7574  t will strip out
+00066510: 206e 6f6e 2d6e 756d 6572 6963 2063 6f6c   non-numeric col
+00066520: 7320 696e 2079 6f75 7220 6461 7461 2069  s in your data i
+00066530: 6620 796f 7520 6e65 6564 2069 742e 0d0a  f you need it...
+00066540: 2020 2020 2222 220d 0a20 2020 2072 616e      """..    ran
+00066550: 646f 6d73 7461 7465 203d 2039 390d 0a20  domstate = 99.. 
+00066560: 2020 2023 2323 2323 2323 2043 6f64 6573     ####### Codes
+00066570: 5f6c 6973 7420 636f 6e74 6169 6e73 206d  _list contains m
+00066580: 756c 7469 706c 6520 656e 636f 6465 7273  ultiple encoders
+00066590: 2074 6861 7420 6172 6520 7573 6564 2074   that are used t
+000665a0: 6f20 6f70 656e 2061 2043 5356 2066 696c  o open a CSV fil
+000665b0: 650d 0a20 2020 2063 6f64 6573 5f6c 6973  e..    codes_lis
+000665c0: 7420 3d20 5b27 7574 662d 3827 2c27 6973  t = ['utf-8','is
+000665d0: 6f2d 3838 3539 2d31 272c 2763 7031 3235  o-8859-1','cp125
+000665e0: 3227 2c27 6c61 7469 6e31 275d 0d0a 2020  2','latin1']..  
+000665f0: 2020 7365 6564 203d 2039 390d 0a20 2020    seed = 99..   
+00066600: 2069 6620 7479 7065 2874 7261 696e 6669   if type(trainfi
+00066610: 6c65 2920 3d3d 2073 7472 3a0d 0a20 2020  le) == str:..   
+00066620: 2020 2020 2069 6620 7472 6169 6e66 696c       if trainfil
+00066630: 6520 213d 2027 273a 0d0a 2020 2020 2020  e != '':..      
+00066640: 2020 2020 2020 2323 2323 2046 6972 7374        #### First
+00066650: 206c 6f61 6420 7468 6520 5472 6169 6e20   load the Train 
+00066660: 6669 6c65 2069 6620 6974 2069 7320 6176  file if it is av
+00066670: 6169 6c61 626c 6520 2323 2323 2323 2323  ailable ########
+00066680: 2323 0d0a 2020 2020 2020 2020 2020 2020  ##..            
+00066690: 666f 7220 636f 6465 7820 696e 2063 6f64  for codex in cod
+000666a0: 6573 5f6c 6973 743a 0d0a 2020 2020 2020  es_list:..      
+000666b0: 2020 2020 2020 2020 2020 7472 793a 0d0a            try:..
+000666c0: 2020 2020 2020 2020 2020 2020 2020 2020                  
+000666d0: 2020 2020 7472 6169 6e64 6620 3d20 7064      traindf = pd
+000666e0: 2e72 6561 645f 6373 7628 7472 6169 6e66  .read_csv(trainf
+000666f0: 696c 652c 7365 703d 7365 702c 656e 636f  ile,sep=sep,enco
+00066700: 6469 6e67 3d63 6f64 6578 2c69 6e64 6578  ding=codex,index
+00066710: 5f63 6f6c 3d4e 6f6e 6529 0d0a 2020 2020  _col=None)..    
+00066720: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00066730: 6272 6561 6b0d 0a20 2020 2020 2020 2020  break..         
+00066740: 2020 2020 2020 2065 7863 6570 743a 0d0a         except:..
+00066750: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00066760: 2020 2020 636f 6e74 696e 7565 0d0a 2020      continue..  
+00066770: 2020 2020 2020 2020 2020 7072 696e 7428            print(
+00066780: 2754 7261 696e 2064 6174 6120 6769 7665  'Train data give
+00066790: 6e2e 2053 6861 7065 203d 2025 7327 2025  n. Shape = %s' %
+000667a0: 2874 7261 696e 6466 2e73 6861 7065 2c29  (traindf.shape,)
+000667b0: 290d 0a20 2020 2020 2020 2020 2020 2070  )..            p
+000667c0: 7269 6e74 2827 5461 7267 6574 2052 6f77  rint('Target Row
+000667d0: 7320 5472 6169 6e20 3d20 2564 2720 256c  s Train = %d' %l
+000667e0: 656e 2874 7261 696e 6466 5b74 7261 696e  en(traindf[train
+000667f0: 6466 5b74 6172 6765 745d 3d3d 315d 2929  df[target]==1]))
+00066800: 0d0a 2020 2020 2020 2020 656c 7365 3a0d  ..        else:.
+00066810: 0a20 2020 2020 2020 2020 2020 2070 7269  .            pri
+00066820: 6e74 2827 5472 6169 6e66 696c 6520 6973  nt('Trainfile is
+00066830: 206e 6f74 2066 6f75 6e64 2e20 4368 6563   not found. Chec
+00066840: 6b20 796f 7572 2069 6e70 7574 206f 7220  k your input or 
+00066850: 6669 6c65 2064 6573 7469 6e61 7469 6f6e  file destination
+00066860: 2729 0d0a 2020 2020 2020 2020 2020 2020  ')..            
+00066870: 7265 7475 726e 0d0a 2020 2020 2020 2020  return..        
+00066880: 6966 2020 7479 7065 2874 6573 7466 696c  if  type(testfil
+00066890: 6529 203d 3d20 7374 723a 0d0a 2020 2020  e) == str:..    
+000668a0: 2020 2020 2020 2020 6966 2074 6573 7466          if testf
+000668b0: 696c 6520 213d 2027 273a 0d0a 2020 2020  ile != '':..    
+000668c0: 2020 2020 2020 2020 2020 2020 7072 696e              prin
+000668d0: 7428 2754 7261 696e 2066 696c 6520 616e  t('Train file an
+000668e0: 6420 5465 7374 2066 696c 6520 6769 7665  d Test file give
+000668f0: 6e2e 2729 0d0a 2020 2020 2020 2020 2020  n.')..          
+00066900: 2020 2020 2020 2323 2323 2323 2049 6620        ###### If 
+00066910: 7465 7374 6669 6c65 2069 7320 6176 6169  testfile is avai
+00066920: 6c61 626c 652c 2079 6f75 206e 6565 6420  lable, you need 
+00066930: 746f 2063 6f6d 6269 6e65 2074 7261 696e  to combine train
+00066940: 2061 6e64 2074 6573 7420 6461 7461 7365   and test datase
+00066950: 7473 0d0a 2020 2020 2020 2020 2020 2020  ts..            
+00066960: 2020 2020 7072 696e 7428 2754 7261 696e      print('Train
+00066970: 2044 6174 6146 7261 6d65 2061 6e64 2054   DataFrame and T
+00066980: 6573 7466 696c 6520 6769 7665 6e2e 2729  estfile given.')
+00066990: 0d0a 2020 2020 2020 2020 2020 2020 2020  ..              
+000669a0: 2020 666f 7220 636f 6465 7820 696e 2063    for codex in c
+000669b0: 6f64 6573 5f6c 6973 743a 0d0a 2020 2020  odes_list:..    
+000669c0: 2020 2020 2020 2020 2020 2020 2020 2020                  
+000669d0: 7472 793a 0d0a 2020 2020 2020 2020 2020  try:..          
+000669e0: 2020 2020 2020 2020 2020 2020 2020 7465                te
+000669f0: 7374 6466 203d 2070 642e 7265 6164 5f63  stdf = pd.read_c
+00066a00: 7376 2874 6573 7466 696c 652c 7365 703d  sv(testfile,sep=
+00066a10: 7365 702c 656e 636f 6469 6e67 3d63 6f64  sep,encoding=cod
+00066a20: 6578 2c69 6e64 6578 5f63 6f6c 3d4e 6f6e  ex,index_col=Non
+00066a30: 6529 0d0a 2020 2020 2020 2020 2020 2020  e)..            
+00066a40: 2020 2020 2020 2020 2020 2020 6272 6561              brea
+00066a50: 6b0d 0a20 2020 2020 2020 2020 2020 2020  k..             
+00066a60: 2020 2020 2020 2065 7863 6570 743a 0d0a         except:..
+00066a70: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00066a80: 2020 2020 2020 2020 636f 6e74 696e 7565          continue
+00066a90: 0d0a 2020 2020 2020 2020 2020 2020 2020  ..              
+00066aa0: 2020 7072 696e 7428 2754 6573 7420 6461    print('Test da
+00066ab0: 7461 2067 6976 656e 2e20 5368 6170 6520  ta given. Shape 
+00066ac0: 3d20 2573 2720 2528 7465 7374 6466 2e73  = %s' %(testdf.s
+00066ad0: 6861 7065 2c29 290d 0a20 2020 2020 2020  hape,))..       
+00066ae0: 2020 2020 2065 6c73 653a 0d0a 2020 2020       else:..    
+00066af0: 2020 2020 2020 2020 2020 2020 7072 696e              prin
+00066b00: 7428 2754 6573 7466 696c 6520 6973 206e  t('Testfile is n
+00066b10: 6f74 2067 6976 656e 2e20 436f 6e74 696e  ot given. Contin
+00066b20: 7569 6e67 2729 0d0a 2020 2020 2020 2020  uing')..        
+00066b30: 2020 2020 2020 2020 7465 7374 6466 203d          testdf =
+00066b40: 2027 270d 0a20 2020 2020 2020 2065 6c69   ''..        eli
+00066b50: 6620 7479 7065 2874 6573 7466 696c 6529  f type(testfile)
+00066b60: 203d 3d20 7064 2e44 6174 6146 7261 6d65   == pd.DataFrame
+00066b70: 3a0d 0a20 2020 2020 2020 2020 2020 2070  :..            p
+00066b80: 7269 6e74 2827 5472 6169 6e20 6669 6c65  rint('Train file
+00066b90: 2061 6e64 2054 6573 7420 6461 7461 6672   and Test datafr
+00066ba0: 616d 6520 6769 7665 6e2e 2729 0d0a 2020  ame given.')..  
+00066bb0: 2020 2020 2020 2020 2020 7465 7374 6466            testdf
+00066bc0: 203d 2074 6573 7466 696c 655b 3a5d 0d0a   = testfile[:]..
+00066bd0: 2020 2020 2020 2020 656c 7365 3a0d 0a20          else:.. 
+00066be0: 2020 2020 2020 2020 2020 2070 7269 6e74             print
+00066bf0: 2827 5465 7374 6669 6c65 2069 7320 756e  ('Testfile is un
+00066c00: 6b6e 6f77 6e20 7479 7065 2e27 290d 0a20  known type.').. 
+00066c10: 2020 2020 2020 2020 2020 2074 6573 7464             testd
+00066c20: 6620 3d20 2727 0d0a 2020 2020 656c 6966  f = ''..    elif
+00066c30: 2074 7970 6528 7472 6169 6e66 696c 6529   type(trainfile)
+00066c40: 203d 3d20 7064 2e44 6174 6146 7261 6d65   == pd.DataFrame
+00066c50: 3a0d 0a20 2020 2020 2020 2074 7261 696e  :..        train
+00066c60: 6466 203d 2074 7261 696e 6669 6c65 5b3a  df = trainfile[:
+00066c70: 5d0d 0a20 2020 2020 2020 2069 6620 2074  ]..        if  t
+00066c80: 7970 6528 7465 7374 6669 6c65 2920 3d3d  ype(testfile) ==
+00066c90: 2073 7472 3a0d 0a20 2020 2020 2020 2020   str:..         
+00066ca0: 2020 2069 6620 7465 7374 6669 6c65 2021     if testfile !
+00066cb0: 3d20 2727 3a0d 0a20 2020 2020 2020 2020  = '':..         
+00066cc0: 2020 2020 2020 2070 7269 6e74 2827 5472         print('Tr
+00066cd0: 6169 6e20 4461 7461 4672 616d 6520 616e  ain DataFrame an
+00066ce0: 6420 5465 7374 2066 696c 6520 6769 7665  d Test file give
+00066cf0: 6e2e 2729 0d0a 2020 2020 2020 2020 2020  n.')..          
+00066d00: 2020 2020 2020 2323 2323 2323 2049 6620        ###### If 
+00066d10: 7465 7374 6669 6c65 2069 7320 6176 6169  testfile is avai
+00066d20: 6c61 626c 652c 2079 6f75 206e 6565 6420  lable, you need 
+00066d30: 746f 2063 6f6d 6269 6e65 2074 7261 696e  to combine train
+00066d40: 2061 6e64 2074 6573 7420 6461 7461 7365   and test datase
+00066d50: 7473 0d0a 2020 2020 2020 2020 2020 2020  ts..            
+00066d60: 2020 2020 7072 696e 7428 2754 7261 696e      print('Train
+00066d70: 2044 6174 6146 7261 6d65 2061 6e64 2054   DataFrame and T
+00066d80: 6573 7466 696c 6520 6769 7665 6e2e 2729  estfile given.')
+00066d90: 0d0a 2020 2020 2020 2020 2020 2020 2020  ..              
+00066da0: 2020 666f 7220 636f 6465 7820 696e 2063    for codex in c
+00066db0: 6f64 6573 5f6c 6973 743a 0d0a 2020 2020  odes_list:..    
+00066dc0: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00066dd0: 7472 793a 0d0a 2020 2020 2020 2020 2020  try:..          
+00066de0: 2020 2020 2020 2020 2020 2020 2020 7465                te
+00066df0: 7374 6466 203d 2070 642e 7265 6164 5f63  stdf = pd.read_c
+00066e00: 7376 2874 6573 7466 696c 652c 7365 703d  sv(testfile,sep=
+00066e10: 7365 702c 656e 636f 6469 6e67 3d63 6f64  sep,encoding=cod
+00066e20: 6578 2c69 6e64 6578 5f63 6f6c 3d4e 6f6e  ex,index_col=Non
+00066e30: 6529 0d0a 2020 2020 2020 2020 2020 2020  e)..            
+00066e40: 2020 2020 2020 2020 2020 2020 6272 6561              brea
+00066e50: 6b0d 0a20 2020 2020 2020 2020 2020 2020  k..             
+00066e60: 2020 2020 2020 2065 7863 6570 743a 0d0a         except:..
+00066e70: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00066e80: 2020 2020 2020 2020 636f 6e74 696e 7565          continue
+00066e90: 0d0a 2020 2020 2020 2020 2020 2020 2020  ..              
+00066ea0: 2020 7072 696e 7428 2754 7261 696e 2053    print('Train S
+00066eb0: 6861 7065 3a25 7320 5465 7374 2053 6861  hape:%s Test Sha
+00066ec0: 7065 3a20 2573 2720 2528 7472 6169 6e64  pe: %s' %(traind
+00066ed0: 662e 7368 6170 652c 7465 7374 6466 2e73  f.shape,testdf.s
+00066ee0: 6861 7065 2929 0d0a 2020 2020 2020 2020  hape))..        
+00066ef0: 2020 2020 656c 7365 3a0d 0a20 2020 2020      else:..     
+00066f00: 2020 2020 2020 2020 2020 2070 7269 6e74             print
+00066f10: 2827 4e6f 2074 6573 7466 696c 652e 2054  ('No testfile. T
+00066f20: 7261 696e 2053 6861 7065 3a25 7327 2025  rain Shape:%s' %
+00066f30: 2874 7261 696e 6466 2e73 6861 7065 2c29  (traindf.shape,)
+00066f40: 290d 0a20 2020 2020 2020 2020 2020 2020  )..             
+00066f50: 2020 2074 6573 7464 6620 3d20 2727 0d0a     testdf = ''..
+00066f60: 2020 2020 2020 2020 656c 6966 2074 7970          elif typ
+00066f70: 6528 7465 7374 6669 6c65 2920 3d3d 2070  e(testfile) == p
+00066f80: 642e 4461 7461 4672 616d 653a 0d0a 2020  d.DataFrame:..  
+00066f90: 2020 2020 2020 2020 2020 7072 696e 7428            print(
+00066fa0: 2754 7261 696e 2044 6174 6146 7261 6d65  'Train DataFrame
+00066fb0: 2061 6e64 2054 6573 7420 4461 7461 4672   and Test DataFr
+00066fc0: 616d 6520 6769 7665 6e2e 2729 0d0a 2020  ame given.')..  
+00066fd0: 2020 2020 2020 2020 2020 7465 7374 6466            testdf
+00066fe0: 203d 2074 6573 7466 696c 655b 3a5d 0d0a   = testfile[:]..
+00066ff0: 2020 2020 656c 7365 3a0d 0a20 2020 2020      else:..     
+00067000: 2020 2070 7269 6e74 2827 4e6f 2054 7261     print('No Tra
+00067010: 696e 206f 7220 5465 7374 2066 696c 6520  in or Test file 
+00067020: 7072 6f76 6964 6564 2e20 456e 642e 2e2e  provided. End...
+00067030: 2729 0d0a 2020 2020 2020 2020 7265 7475  ')..        retu
+00067040: 726e 0d0a 2020 2020 2323 2323 2323 2323  rn..    ########
+00067050: 2054 6869 7320 6973 2077 6865 7265 2074   This is where t
+00067060: 6865 2073 706c 6974 7469 6e67 2062 6567  he splitting beg
+00067070: 696e 7320 2323 2323 2323 2323 2323 2323  ins ############
+00067080: 2323 2323 230d 0a20 2020 2069 6620 7461  #####..    if ta
+00067090: 7267 6574 203d 3d20 2727 3a0d 0a20 2020  rget == '':..   
+000670a0: 2020 2020 2070 7269 6e74 2827 4e6f 2074       print('No t
+000670b0: 6172 6765 7420 7661 7269 6162 6c65 2070  arget variable p
+000670c0: 726f 7669 6465 642e 2050 6c65 6173 6520  rovided. Please 
+000670d0: 7072 6f76 6964 6520 7461 7267 6574 2076  provide target v
+000670e0: 6172 6961 626c 6527 290d 0a20 2020 2020  ariable')..     
+000670f0: 2020 2072 6574 7572 6e20 7472 6169 6e64     return traind
+00067100: 662c 204e 6f6e 652c 204e 6f6e 650d 0a20  f, None, None.. 
+00067110: 2020 2065 6c73 653a 0d0a 2020 2020 2020     else:..      
+00067120: 2020 7920 3d20 7472 6169 6e64 665b 7461    y = traindf[ta
+00067130: 7267 6574 5d0d 0a20 2020 2069 6620 6d6f  rget]..    if mo
+00067140: 6465 6c74 7970 6520 3d3d 2027 436c 6173  deltype == 'Clas
+00067150: 7369 6669 6361 7469 6f6e 273a 0d0a 2020  sification':..  
+00067160: 2020 2020 2020 6966 2074 7261 696e 6466        if traindf
+00067170: 2e73 6861 7065 5b30 5d20 3c3d 2031 3030  .shape[0] <= 100
+00067180: 303a 0d0a 2020 2020 2020 2020 2020 2020  0:..            
+00067190: 7373 7320 3d20 5374 7261 7469 6669 6564  sss = Stratified
+000671a0: 5368 7566 666c 6553 706c 6974 286e 5f73  ShuffleSplit(n_s
+000671b0: 706c 6974 733d 322c 2074 6573 745f 7369  plits=2, test_si
+000671c0: 7a65 3d30 2e33 302c 2072 616e 646f 6d5f  ze=0.30, random_
+000671d0: 7374 6174 653d 7261 6e64 6f6d 7374 6174  state=randomstat
+000671e0: 6529 0d0a 2020 2020 2020 2020 656c 7365  e)..        else
+000671f0: 3a0d 0a20 2020 2020 2020 2020 2020 2073  :..            s
+00067200: 7373 203d 2053 7472 6174 6966 6965 6453  ss = StratifiedS
+00067210: 6875 6666 6c65 5370 6c69 7428 6e5f 7370  huffleSplit(n_sp
+00067220: 6c69 7473 3d32 2c20 7465 7374 5f73 697a  lits=2, test_siz
+00067230: 653d 302e 3230 2c20 7261 6e64 6f6d 5f73  e=0.20, random_s
+00067240: 7461 7465 3d72 616e 646f 6d73 7461 7465  tate=randomstate
+00067250: 290d 0a20 2020 2065 6c73 653a 0d0a 2020  )..    else:..  
+00067260: 2020 2020 2020 696e 6469 6365 7320 3d20        indices = 
+00067270: 6e70 2e72 616e 646f 6d2e 7065 726d 7574  np.random.permut
+00067280: 6174 696f 6e28 7472 6169 6e64 662e 7368  ation(traindf.sh
+00067290: 6170 655b 305d 290d 0a20 2020 2020 2020  ape[0])..       
+000672a0: 2074 7261 696e 5f72 6f77 7320 3d20 696e   train_rows = in
+000672b0: 7428 302e 382a 7472 6169 6e64 662e 7368  t(0.8*traindf.sh
+000672c0: 6170 655b 305d 290d 0a20 2020 2070 7265  ape[0])..    pre
+000672d0: 6469 6374 6f72 7320 3d20 5b78 2066 6f72  dictors = [x for
+000672e0: 2078 2069 6e20 7472 6169 6e64 6620 6966   x in traindf if
+000672f0: 2078 206e 6f74 2069 6e20 7461 7267 6574   x not in target
+00067300: 5d0d 0a20 2020 2023 2323 2323 2073 656c  ]..    ##### sel
+00067310: 6563 7420 6f6e 6c79 2073 7472 696e 6720  ect only string 
+00067320: 636f 6c75 6d6e 7320 6672 6f6d 2074 6865  columns from the
+00067330: 2074 7261 696e 2064 6174 610d 0a20 2020   train data..   
+00067340: 2063 6f6c 7320 3d20 636f 7079 2e64 6565   cols = copy.dee
+00067350: 7063 6f70 7928 7072 6564 6963 746f 7273  pcopy(predictors
+00067360: 290d 0a20 2020 2023 636f 6c73 203d 2073  )..    #cols = s
+00067370: 656c 6563 745f 6e75 6d5f 636f 6c75 6d6e  elect_num_column
+00067380: 7328 7472 6169 6e64 665b 7072 6564 6963  s(traindf[predic
+00067390: 746f 7273 5d29 2e63 6f6c 756d 6e73 2e74  tors]).columns.t
+000673a0: 6f6c 6973 7428 290d 0a20 2020 2074 7261  olist()..    tra
+000673b0: 696e 6466 203d 2074 7261 696e 6466 5b63  indf = traindf[c
+000673c0: 6f6c 732b 5b74 6172 6765 745d 5d0d 0a20  ols+[target]].. 
+000673d0: 2020 2058 203d 2074 7261 696e 6466 5b63     X = traindf[c
+000673e0: 6f6c 735d 0d0a 2020 2020 6966 2074 7970  ols]..    if typ
+000673f0: 6528 7465 7374 6466 2920 3d3d 2073 7472  e(testdf) == str
+00067400: 3a0d 0a20 2020 2020 2020 2023 2323 2320  :..        #### 
+00067410: 4966 206e 6f20 7465 7374 2044 6174 6146  If no test DataF
+00067420: 7261 6d65 2069 7320 6769 7665 6e2c 2074  rame is given, t
+00067430: 6865 6e20 7370 6c69 7420 7468 6520 7472  hen split the tr
+00067440: 6169 6e20 6461 7461 2069 6e74 6f20 7472  ain data into tr
+00067450: 6169 6e2c 2063 7620 616e 6420 7465 7374  ain, cv and test
+00067460: 2064 6174 6120 2323 2323 2323 230d 0a20   data #######.. 
+00067470: 2020 2020 2020 2069 6620 6d6f 6465 6c74         if modelt
+00067480: 7970 6520 3d3d 2027 436c 6173 7369 6669  ype == 'Classifi
+00067490: 6361 7469 6f6e 273a 0d0a 2020 2020 2020  cation':..      
+000674a0: 2020 2020 2020 7472 6169 6e69 6e64 6578        trainindex
+000674b0: 2c20 7465 7374 696e 6465 7820 3d20 7373  , testindex = ss
+000674c0: 732e 7370 6c69 7428 582c 2079 290d 0a20  s.split(X, y).. 
+000674d0: 2020 2020 2020 2020 2020 2074 7261 6461             trada
+000674e0: 7461 203d 2074 7261 696e 6466 2e69 6c6f  ta = traindf.ilo
+000674f0: 635b 7472 6169 6e69 6e64 6578 5b30 5d5d  c[trainindex[0]]
+00067500: 0d0a 2020 2020 2020 2020 2020 2020 7473  ..            ts
+00067510: 6461 7461 203d 2074 7261 696e 6466 2e69  data = traindf.i
+00067520: 6c6f 635b 7472 6169 6e69 6e64 6578 5b31  loc[trainindex[1
+00067530: 5d5d 0d0a 2020 2020 2020 2020 656c 7365  ]]..        else
+00067540: 3a0d 0a20 2020 2020 2020 2020 2020 2074  :..            t
+00067550: 7261 696e 696e 675f 6964 782c 2074 6573  raining_idx, tes
+00067560: 745f 6964 7820 3d20 696e 6469 6365 735b  t_idx = indices[
+00067570: 3a74 7261 696e 5f72 6f77 735d 2c20 696e  :train_rows], in
+00067580: 6469 6365 735b 7472 6169 6e5f 726f 7773  dices[train_rows
+00067590: 3a5d 0d0a 2020 2020 2020 2020 2020 2020  :]..            
+000675a0: 7472 6164 6174 612c 2074 7364 6174 6120  tradata, tsdata 
+000675b0: 3d20 7472 6169 6e64 662e 696c 6f63 5b74  = traindf.iloc[t
+000675c0: 7261 696e 696e 675f 6964 785d 2c20 7472  raining_idx], tr
+000675d0: 6169 6e64 662e 696c 6f63 5b74 6573 745f  aindf.iloc[test_
+000675e0: 6964 785d 0d0a 2020 2020 2020 2020 2323  idx]..        ##
+000675f0: 2323 2323 2323 2323 2323 2323 2323 2323  ################
+00067600: 2323 2320 2020 2043 524f 5353 2056 414c  ###    CROSS VAL
+00067610: 4944 4154 494f 4e20 504f 5254 494f 4e20  IDATION PORTION 
+00067620: 2023 2323 2323 2323 2323 2323 2323 2323   ###############
+00067630: 2323 2323 2323 2323 0d0a 2020 2020 2020  ########..      
+00067640: 2020 5820 3d20 7473 6461 7461 5b63 6f6c    X = tsdata[col
+00067650: 735d 0d0a 2020 2020 2020 2020 7920 3d20  s]..        y = 
+00067660: 7473 6461 7461 5b74 6172 6765 745d 0d0a  tsdata[target]..
+00067670: 2020 2020 2020 2020 6966 206d 6f64 656c          if model
+00067680: 7479 7065 203d 3d20 2743 6c61 7373 6966  type == 'Classif
+00067690: 6963 6174 696f 6e27 3a0d 0a20 2020 2020  ication':..     
+000676a0: 2020 2020 2020 2073 7373 203d 2053 7472         sss = Str
+000676b0: 6174 6966 6965 6453 6875 6666 6c65 5370  atifiedShuffleSp
+000676c0: 6c69 7428 6e5f 7370 6c69 7473 3d32 2c20  lit(n_splits=2, 
+000676d0: 7465 7374 5f73 697a 653d 302e 3430 2c20  test_size=0.40, 
+000676e0: 7261 6e64 6f6d 5f73 7461 7465 3d72 616e  random_state=ran
+000676f0: 646f 6d73 7461 7465 290d 0a20 2020 2020  domstate)..     
+00067700: 2020 2020 2020 2063 7669 6e64 6578 2c20         cvindex, 
+00067710: 7473 5f69 6e64 6578 203d 2073 7373 2e73  ts_index = sss.s
+00067720: 706c 6974 2858 2c20 7929 0d0a 2020 2020  plit(X, y)..    
+00067730: 2020 2020 2020 2020 6376 6461 7461 203d          cvdata =
+00067740: 2074 7364 6174 612e 696c 6f63 5b63 7669   tsdata.iloc[cvi
+00067750: 6e64 6578 5b30 5d5d 0d0a 2020 2020 2020  ndex[0]]..      
+00067760: 2020 2020 2020 7473 6461 7461 203d 2074        tsdata = t
+00067770: 7364 6174 612e 696c 6f63 5b63 7669 6e64  sdata.iloc[cvind
+00067780: 6578 5b31 5d5d 0d0a 2020 2020 2020 2020  ex[1]]..        
+00067790: 656c 7365 3a0d 0a20 2020 2020 2020 2020  else:..         
+000677a0: 2020 2069 6e64 6963 6573 203d 206e 702e     indices = np.
+000677b0: 7261 6e64 6f6d 2e70 6572 6d75 7461 7469  random.permutati
+000677c0: 6f6e 2874 7364 6174 612e 7368 6170 655b  on(tsdata.shape[
+000677d0: 305d 290d 0a20 2020 2020 2020 2020 2020  0])..           
+000677e0: 2074 7261 696e 5f72 6f77 7320 3d20 696e   train_rows = in
+000677f0: 7428 302e 342a 7473 6461 7461 2e73 6861  t(0.4*tsdata.sha
+00067800: 7065 5b30 5d29 0d0a 2020 2020 2020 2020  pe[0])..        
+00067810: 2020 2020 7472 6169 6e69 6e67 5f69 6478      training_idx
+00067820: 2c20 7465 7374 5f69 6478 203d 2069 6e64  , test_idx = ind
+00067830: 6963 6573 5b3a 7472 6169 6e5f 726f 7773  ices[:train_rows
+00067840: 5d2c 2069 6e64 6963 6573 5b74 7261 696e  ], indices[train
+00067850: 5f72 6f77 733a 5d0d 0a20 2020 2020 2020  _rows:]..       
+00067860: 2020 2020 2063 7664 6174 612c 2074 7364       cvdata, tsd
+00067870: 6174 6120 3d20 7473 6461 7461 2e69 6c6f  ata = tsdata.ilo
+00067880: 635b 7472 6169 6e69 6e67 5f69 6478 5d2c  c[training_idx],
+00067890: 2074 7364 6174 612e 696c 6f63 5b74 6573   tsdata.iloc[tes
+000678a0: 745f 6964 785d 0d0a 2020 2020 2020 2020  t_idx]..        
+000678b0: 7265 7475 726e 2074 7261 6461 7461 2c20  return tradata, 
+000678c0: 6376 6461 7461 2c20 7473 6461 7461 2c20  cvdata, tsdata, 
+000678d0: 636f 6c73 0d0a 2020 2020 656c 7365 3a0d  cols..    else:.
+000678e0: 0a20 2020 2020 2020 2023 2323 2323 2323  .        #######
+000678f0: 2049 6620 5465 7374 2044 6174 6146 7261   If Test DataFra
+00067900: 6d65 2069 7320 6769 7665 6e20 7468 656e  me is given then
+00067910: 206b 6565 7020 7468 6174 2061 7320 7473   keep that as ts
+00067920: 6461 7461 2023 2323 2323 2323 230d 0a20  data ########.. 
+00067930: 2020 2020 2020 2069 6620 6d6f 6465 6c74         if modelt
+00067940: 7970 6520 3d3d 2027 436c 6173 7369 6669  ype == 'Classifi
+00067950: 6361 7469 6f6e 273a 0d0a 2020 2020 2020  cation':..      
+00067960: 2020 2020 2020 7472 6169 6e69 6e64 6578        trainindex
+00067970: 2c20 7465 7374 696e 6465 7820 3d20 7373  , testindex = ss
+00067980: 732e 7370 6c69 7428 582c 2079 290d 0a20  s.split(X, y).. 
+00067990: 2020 2020 2020 2020 2020 2074 7261 6461             trada
+000679a0: 7461 203d 2074 7261 696e 6466 2e69 6c6f  ta = traindf.ilo
+000679b0: 635b 7472 6169 6e69 6e64 6578 5b30 5d5d  c[trainindex[0]]
+000679c0: 0d0a 2020 2020 2020 2020 2020 2020 6376  ..            cv
+000679d0: 6461 7461 203d 2074 7261 696e 6466 2e69  data = traindf.i
+000679e0: 6c6f 635b 7472 6169 6e69 6e64 6578 5b31  loc[trainindex[1
+000679f0: 5d5d 0d0a 2020 2020 2020 2020 2020 2020  ]]..            
+00067a00: 7472 793a 0d0a 2020 2020 2020 2020 2020  try:..          
+00067a10: 2020 2020 2020 6966 206c 656e 2874 6573        if len(tes
+00067a20: 7464 665b 7461 7267 6574 5d2e 7661 6c75  tdf[target].valu
+00067a30: 655f 636f 756e 7473 2829 203e 3d20 3229  e_counts() >= 2)
+00067a40: 3a0d 0a20 2020 2020 2020 2020 2020 2020  :..             
+00067a50: 2020 2020 2020 2070 7269 6e74 2827 2020         print('  
+00067a60: 2020 4e75 6d62 6572 206f 6620 5461 7267    Number of Targ
+00067a70: 6574 2052 6f77 7320 696e 2054 6573 7420  et Rows in Test 
+00067a80: 4461 7461 3a20 2564 2720 256c 656e 2874  Data: %d' %len(t
+00067a90: 6573 7464 665b 7465 7374 6466 5b74 6172  estdf[testdf[tar
+00067aa0: 6765 745d 3d3d 315d 2929 0d0a 2020 2020  get]==1]))..    
 00067ab0: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00067ac0: 2023 2323 2052 656d 656d 6265 7220 7468   ### Remember th
-00067ad0: 6174 2066 696c 6c6e 6120 6f6e 6c79 2077  at fillna only w
-00067ae0: 6f72 6b73 2061 7420 6461 7461 6672 616d  orks at datafram
-00067af0: 6520 6c65 7665 6c21 2023 2323 0d0a 2020  e level! ###..  
-00067b00: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00067b10: 2020 7465 7374 5b5b 6e75 6d5d 5d20 3d20    test[[num]] = 
-00067b20: 7465 7374 5b5b 6e75 6d5d 5d2e 6669 6c6c  test[[num]].fill
-00067b30: 6e61 2866 696c 6c6e 756d 290d 0a20 2020  na(fillnum)..   
-00067b40: 2023 2323 2054 6869 7320 6973 2061 2073   ### This is a s
-00067b50: 696d 706c 6520 6c6f 6720 7472 616e 7366  imple log transf
-00067b60: 6f72 6d20 666f 7220 7665 7279 206c 6172  orm for very lar
-00067b70: 6765 206e 756d 6572 6963 2076 616c 7565  ge numeric value
-00067b80: 7320 3d3e 2068 6967 686c 7920 7265 636f  s => highly reco
-00067b90: 6d6d 656e 6465 6421 0d0a 2020 2020 666f  mmended!..    fo
-00067ba0: 7220 6e75 6d20 696e 206e 756d 733a 0d0a  r num in nums:..
-00067bb0: 2020 2020 2020 2020 6d61 736b 203d 2074          mask = t
-00067bc0: 7261 696e 5b6e 756d 5d3d 3d30 0d0a 2020  rain[num]==0..  
-00067bd0: 2020 2020 2020 6669 6c6c 6e75 6d20 3d20        fillnum = 
-00067be0: 3130 652d 350d 0a20 2020 2020 2020 2074  10e-5..        t
-00067bf0: 7261 696e 2e69 785b 6d61 736b 2c6e 756d  rain.ix[mask,num
-00067c00: 5d20 3d20 6669 6c6c 6e75 6d0d 0a20 2020  ] = fillnum..   
-00067c10: 2020 2020 2023 2323 2052 656d 656d 6265       ### Remembe
-00067c20: 7220 7468 6174 2066 696c 6c6e 6120 6f6e  r that fillna on
-00067c30: 6c79 2077 6f72 6b73 2061 7420 6461 7461  ly works at data
-00067c40: 6672 616d 6520 6c65 7665 6c21 2023 2323  frame level! ###
-00067c50: 0d0a 2020 2020 2020 2020 7472 6169 6e5b  ..        train[
-00067c60: 5b6e 756d 2b27 5f6c 6f67 275d 5d20 3d20  [num+'_log']] = 
-00067c70: 6e70 2e6c 6f67 3130 2874 7261 696e 5b5b  np.log10(train[[
-00067c80: 6e75 6d5d 5d29 2e66 696c 6c6e 6128 3029  num]]).fillna(0)
-00067c90: 0d0a 2020 2020 2020 2020 6966 206e 6f74  ..        if not
-00067ca0: 2069 7369 6e73 7461 6e63 6528 7465 7374   isinstance(test
-00067cb0: 2c20 7374 7229 3a0d 0a20 2020 2020 2020  , str):..       
-00067cc0: 2020 2020 206d 6173 6b20 3d20 7465 7374       mask = test
-00067cd0: 5b6e 756d 5d3d 3d30 0d0a 2020 2020 2020  [num]==0..      
-00067ce0: 2020 2020 2020 7465 7374 2e69 785b 6d61        test.ix[ma
-00067cf0: 736b 2c6e 756d 5d20 3d20 6669 6c6c 6e75  sk,num] = fillnu
-00067d00: 6d0d 0a20 2020 2020 2020 2020 2020 2023  m..            #
-00067d10: 2323 2052 656d 656d 6265 7220 7468 6174  ## Remember that
-00067d20: 2066 696c 6c6e 6120 6f6e 6c79 2077 6f72   fillna only wor
-00067d30: 6b73 2061 7420 6461 7461 6672 616d 6520  ks at dataframe 
-00067d40: 6c65 7665 6c21 2023 2323 0d0a 2020 2020  level! ###..    
-00067d50: 2020 2020 2020 2020 7465 7374 5b5b 6e75          test[[nu
-00067d60: 6d2b 275f 6c6f 6727 5d5d 203d 206e 702e  m+'_log']] = np.
-00067d70: 6c6f 6731 3028 7465 7374 5b5b 6e75 6d5d  log10(test[[num]
-00067d80: 5d29 2e66 696c 6c6e 6128 3029 0d0a 2020  ]).fillna(0)..  
-00067d90: 2020 7265 7475 726e 2074 7261 696e 2c20    return train, 
-00067da0: 7465 7374 0d0a 2323 2323 2323 2323 2323  test..##########
-00067db0: 2323 2323 2323 2323 2323 2323 2323 2323  ################
-00067dc0: 2323 2323 2323 2323 2323 2323 2323 2323  ################
-00067dd0: 2323 2323 2323 2323 2323 2323 2323 2323  ################
-00067de0: 2323 0d0a 696d 706f 7274 206f 730d 0a64  ##..import os..d
-00067df0: 6566 2077 7269 7465 5f66 696c 655f 746f  ef write_file_to
-00067e00: 5f66 6f6c 6465 7228 6466 2c20 6561 6368  _folder(df, each
-00067e10: 5f74 6172 6765 742c 2062 6173 655f 6669  _target, base_fi
-00067e20: 6c65 6e61 6d65 2c20 7665 7262 6f73 653d  lename, verbose=
-00067e30: 3129 3a0d 0a20 2020 2069 6620 6973 696e  1):..    if isin
-00067e40: 7374 616e 6365 2865 6163 685f 7461 7267  stance(each_targ
-00067e50: 6574 2c20 7374 7229 3a0d 0a20 2020 2020  et, str):..     
-00067e60: 2020 2064 6972 5f6e 616d 6520 3d20 636f     dir_name = co
-00067e70: 7079 2e64 6565 7063 6f70 7928 6561 6368  py.deepcopy(each
-00067e80: 5f74 6172 6765 7429 0d0a 2020 2020 656c  _target)..    el
-00067e90: 7365 3a0d 0a20 2020 2020 2020 2064 6972  se:..        dir
-00067ea0: 5f6e 616d 6520 3d20 7374 7228 6561 6368  _name = str(each
-00067eb0: 5f74 6172 6765 7429 0d0a 2020 2020 6669  _target)..    fi
-00067ec0: 6c65 6e61 6d65 203d 206f 732e 7061 7468  lename = os.path
-00067ed0: 2e6a 6f69 6e28 6469 725f 6e61 6d65 2c20  .join(dir_name, 
-00067ee0: 6261 7365 5f66 696c 656e 616d 6529 0d0a  base_filename)..
-00067ef0: 2020 2020 6966 2076 6572 626f 7365 203e      if verbose >
-00067f00: 3d20 313a 0d0a 2020 2020 2020 2020 6966  = 1:..        if
-00067f10: 206f 732e 6e61 6d65 203d 3d20 276e 7427   os.name == 'nt'
-00067f20: 3a0d 0a20 2020 2020 2020 2020 2020 2070  :..            p
-00067f30: 7269 6e74 2827 2020 2020 5361 7669 6e67  rint('    Saving
-00067f40: 2070 7265 6469 6374 696f 6e73 2074 6f20   predictions to 
-00067f50: 2e5c 2573 2720 2566 696c 656e 616d 6529  .\%s' %filename)
-00067f60: 0d0a 2020 2020 2020 2020 656c 7365 3a0d  ..        else:.
-00067f70: 0a20 2020 2020 2020 2020 2020 2070 7269  .            pri
-00067f80: 6e74 2827 2020 2020 5361 7669 6e67 2070  nt('    Saving p
-00067f90: 7265 6469 6374 696f 6e73 2074 6f20 2e2f  redictions to ./
-00067fa0: 2573 2720 2566 696c 656e 616d 6529 0d0a  %s' %filename)..
-00067fb0: 2020 2020 2020 2020 6966 206e 6f74 206f          if not o
-00067fc0: 732e 7061 7468 2e69 7364 6972 2864 6972  s.path.isdir(dir
-00067fd0: 5f6e 616d 6529 3a0d 0a20 2020 2020 2020  _name):..       
-00067fe0: 2020 2020 206f 732e 6d6b 6469 7228 6469       os.mkdir(di
-00067ff0: 725f 6e61 6d65 290d 0a20 2020 2020 2020  r_name)..       
-00068000: 2064 662e 746f 5f63 7376 2866 696c 656e   df.to_csv(filen
-00068010: 616d 652c 696e 6465 783d 4661 6c73 6529  ame,index=False)
-00068020: 0d0a 2323 2323 2323 2323 2323 2323 2323  ..##############
-00068030: 2323 2323 2323 2323 2323 2323 2323 2323  ################
-00068040: 2323 2323 2323 2323 2323 2323 2323 2323  ################
-00068050: 2323 2323 2323 2323 2323 2323 2323 2323  ################
-00068060: 0d0a 6465 6620 6372 6561 7465 5f74 735f  ..def create_ts_
-00068070: 6665 6174 7572 6573 2864 662c 2074 7363  features(df, tsc
-00068080: 6f6c 293a 0d0a 2020 2020 2222 220d 0a20  ol):..    """.. 
-00068090: 2020 2054 6869 7320 7461 6b65 7320 696e     This takes in
-000680a0: 2069 6e70 7574 2061 2064 6174 6166 7261   input a datafra
-000680b0: 6d65 2061 6e64 2061 2064 6174 6520 7661  me and a date va
-000680c0: 7269 6162 6c65 2e0d 0a20 2020 2049 7420  riable...    It 
-000680d0: 7468 656e 2063 7265 6174 6573 2074 696d  then creates tim
-000680e0: 6520 7365 7269 6573 2066 6561 7475 7265  e series feature
-000680f0: 7320 7573 696e 6720 7468 6520 7061 6e64  s using the pand
-00068100: 6173 202e 6474 2e77 6565 6b64 6179 206b  as .dt.weekday k
-00068110: 696e 6420 6f66 2073 796e 7461 782e 0d0a  ind of syntax...
-00068120: 2020 2020 4974 2061 6c73 6f20 7265 7475      It also retu
-00068130: 726e 7320 7468 6520 6461 7461 2066 7261  rns the data fra
-00068140: 6d65 206f 6620 6164 6465 6420 6665 6174  me of added feat
-00068150: 7572 6573 2077 6974 6820 6561 6368 2076  ures with each v
-00068160: 6172 6961 626c 6520 6173 2061 6e20 696e  ariable as an in
-00068170: 7465 6765 7220 7661 7269 6162 6c65 2e0d  teger variable..
-00068180: 0a20 2020 2022 2222 0d0a 2020 2020 6466  .    """..    df
-00068190: 203d 2063 6f70 792e 6465 6570 636f 7079   = copy.deepcopy
-000681a0: 2864 6629 0d0a 2020 2020 6474 5f61 6464  (df)..    dt_add
-000681b0: 7320 3d20 5b5d 0d0a 2020 2020 7472 793a  s = []..    try:
-000681c0: 0d0a 2020 2020 2020 2020 6466 5b74 7363  ..        df[tsc
-000681d0: 6f6c 2b27 5f68 6f75 7227 5d20 3d20 6466  ol+'_hour'] = df
-000681e0: 5b74 7363 6f6c 5d2e 6474 2e68 6f75 722e  [tscol].dt.hour.
-000681f0: 6669 6c6c 6e61 2830 292e 6173 7479 7065  fillna(0).astype
-00068200: 2869 6e74 290d 0a20 2020 2020 2020 2064  (int)..        d
-00068210: 665b 7473 636f 6c2b 275f 6d69 6e75 7465  f[tscol+'_minute
-00068220: 275d 203d 2064 665b 7473 636f 6c5d 2e64  '] = df[tscol].d
-00068230: 742e 6d69 6e75 7465 2e66 696c 6c6e 6128  t.minute.fillna(
-00068240: 3029 2e61 7374 7970 6528 696e 7429 0d0a  0).astype(int)..
-00068250: 2020 2020 2020 2020 6474 5f61 6464 732e          dt_adds.
-00068260: 6170 7065 6e64 2874 7363 6f6c 2b27 5f68  append(tscol+'_h
-00068270: 6f75 7227 290d 0a20 2020 2020 2020 2064  our')..        d
-00068280: 745f 6164 6473 2e61 7070 656e 6428 7473  t_adds.append(ts
-00068290: 636f 6c2b 275f 6d69 6e75 7465 2729 0d0a  col+'_minute')..
-000682a0: 2020 2020 6578 6365 7074 3a0d 0a20 2020      except:..   
-000682b0: 2020 2020 2070 7269 6e74 2827 2020 2020       print('    
-000682c0: 4572 726f 7220 696e 2063 7265 6174 696e  Error in creatin
-000682d0: 6720 686f 7572 2d73 6563 6f6e 6420 6465  g hour-second de
-000682e0: 7269 7665 6420 6665 6174 7572 6573 2e20  rived features. 
-000682f0: 436f 6e74 696e 7569 6e67 2e2e 2e27 290d  Continuing...').
-00068300: 0a20 2020 2074 7279 3a0d 0a20 2020 2020  .    try:..     
-00068310: 2020 2064 665b 7473 636f 6c2b 275f 6461     df[tscol+'_da
-00068320: 796f 6677 6565 6b27 5d20 3d20 6466 5b74  yofweek'] = df[t
-00068330: 7363 6f6c 5d2e 6474 2e64 6179 6f66 7765  scol].dt.dayofwe
-00068340: 656b 2e66 696c 6c6e 6128 3029 2e61 7374  ek.fillna(0).ast
-00068350: 7970 6528 696e 7429 0d0a 2020 2020 2020  ype(int)..      
-00068360: 2020 6474 5f61 6464 732e 6170 7065 6e64    dt_adds.append
-00068370: 2874 7363 6f6c 2b27 5f64 6179 6f66 7765  (tscol+'_dayofwe
-00068380: 656b 2729 0d0a 2020 2020 2020 2020 6966  ek')..        if
-00068390: 2074 7363 6f6c 2b27 5f68 6f75 7227 2069   tscol+'_hour' i
-000683a0: 6e20 6474 5f61 6464 733a 0d0a 2020 2020  n dt_adds:..    
-000683b0: 2020 2020 2020 2020 4441 5953 203d 2064          DAYS = d
-000683c0: 6963 7428 7a69 7028 7261 6e67 6528 3729  ict(zip(range(7)
-000683d0: 2c5b 2753 756e 272c 2027 4d6f 6e27 2c20  ,['Sun', 'Mon', 
-000683e0: 2754 7565 272c 2027 5765 6427 2c20 2754  'Tue', 'Wed', 'T
-000683f0: 6875 272c 2027 4672 6927 2c20 2753 6174  hu', 'Fri', 'Sat
-00068400: 275d 2929 0d0a 2020 2020 2020 2020 2020  ']))..          
-00068410: 2020 6466 5b74 7363 6f6c 2b27 5f64 6179    df[tscol+'_day
-00068420: 6f66 7765 656b 275d 203d 2064 665b 7473  ofweek'] = df[ts
-00068430: 636f 6c2b 275f 6461 796f 6677 6565 6b27  col+'_dayofweek'
-00068440: 5d2e 6d61 7028 4441 5953 290d 0a20 2020  ].map(DAYS)..   
-00068450: 2020 2020 2020 2020 2064 662e 6c6f 635b           df.loc[
-00068460: 3a2c 7473 636f 6c2b 275f 6461 796f 6677  :,tscol+'_dayofw
-00068470: 6565 6b5f 686f 7572 5f63 726f 7373 275d  eek_hour_cross']
-00068480: 203d 2064 665b 7473 636f 6c2b 275f 6461   = df[tscol+'_da
-00068490: 796f 6677 6565 6b27 5d20 2b22 2022 2b20  yofweek'] +" "+ 
-000684a0: 6466 5b74 7363 6f6c 2b27 5f68 6f75 7227  df[tscol+'_hour'
-000684b0: 5d2e 6173 7479 7065 2873 7472 290d 0a20  ].astype(str).. 
-000684c0: 2020 2020 2020 2020 2020 2064 745f 6164             dt_ad
-000684d0: 6473 2e61 7070 656e 6428 7473 636f 6c2b  ds.append(tscol+
-000684e0: 275f 6461 796f 6677 6565 6b5f 686f 7572  '_dayofweek_hour
-000684f0: 5f63 726f 7373 2729 0d0a 2020 2020 2020  _cross')..      
-00068500: 2020 6466 5b74 7363 6f6c 2b27 5f71 7561    df[tscol+'_qua
-00068510: 7274 6572 275d 203d 2064 665b 7473 636f  rter'] = df[tsco
-00068520: 6c5d 2e64 742e 7175 6172 7465 722e 6669  l].dt.quarter.fi
-00068530: 6c6c 6e61 2830 292e 6173 7479 7065 2869  llna(0).astype(i
-00068540: 6e74 290d 0a20 2020 2020 2020 2064 745f  nt)..        dt_
-00068550: 6164 6473 2e61 7070 656e 6428 7473 636f  adds.append(tsco
-00068560: 6c2b 275f 7175 6172 7465 7227 290d 0a20  l+'_quarter').. 
-00068570: 2020 2020 2020 2064 665b 7473 636f 6c2b         df[tscol+
-00068580: 275f 6d6f 6e74 6827 5d20 3d20 6466 5b74  '_month'] = df[t
-00068590: 7363 6f6c 5d2e 6474 2e6d 6f6e 7468 2e66  scol].dt.month.f
-000685a0: 696c 6c6e 6128 3029 2e61 7374 7970 6528  illna(0).astype(
-000685b0: 696e 7429 0d0a 2020 2020 2020 2020 4d4f  int)..        MO
-000685c0: 4e54 4853 203d 2064 6963 7428 7a69 7028  NTHS = dict(zip(
-000685d0: 7261 6e67 6528 312c 3133 292c 5b27 4a61  range(1,13),['Ja
-000685e0: 6e27 2c20 2746 6562 272c 2027 4d61 7227  n', 'Feb', 'Mar'
-000685f0: 2c20 2741 7072 272c 2027 4d61 7927 2c20  , 'Apr', 'May', 
-00068600: 274a 756e 272c 2027 4a75 6c27 2c0d 0a20  'Jun', 'Jul',.. 
-00068610: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00068620: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00068630: 2020 2027 4175 6727 2c20 2753 6570 272c     'Aug', 'Sep',
-00068640: 2027 4f63 7427 2c20 274e 6f76 272c 2027   'Oct', 'Nov', '
-00068650: 4465 6327 5d29 290d 0a20 2020 2020 2020  Dec']))..       
-00068660: 2064 665b 7473 636f 6c2b 275f 6d6f 6e74   df[tscol+'_mont
-00068670: 6827 5d20 3d20 6466 5b74 7363 6f6c 2b27  h'] = df[tscol+'
-00068680: 5f6d 6f6e 7468 275d 2e6d 6170 284d 4f4e  _month'].map(MON
-00068690: 5448 5329 0d0a 2020 2020 2020 2020 6474  THS)..        dt
-000686a0: 5f61 6464 732e 6170 7065 6e64 2874 7363  _adds.append(tsc
-000686b0: 6f6c 2b27 5f6d 6f6e 7468 2729 0d0a 2020  ol+'_month')..  
-000686c0: 2020 2020 2020 2323 2323 2041 6464 2073        #### Add s
-000686d0: 6f6d 6520 6665 6174 7572 6573 2066 6f72  ome features for
-000686e0: 206d 6f6e 7468 7320 2323 2323 2323 2323   months ########
-000686f0: 2323 2323 2323 2323 2323 2323 2323 2323  ################
-00068700: 2323 2323 2323 2323 2323 2323 2323 2323  ################
-00068710: 0d0a 2020 2020 2020 2020 6665 7374 6976  ..        festiv
-00068720: 6573 203d 205b 274f 6374 272c 274e 6f76  es = ['Oct','Nov
-00068730: 272c 2744 6563 275d 0d0a 2020 2020 2020  ','Dec']..      
-00068740: 2020 6e61 6d65 5f63 6f6c 203d 2074 7363    name_col = tsc
-00068750: 6f6c 2b22 5f69 735f 6665 7374 6976 6522  ol+"_is_festive"
-00068760: 0d0a 2020 2020 2020 2020 6466 5b6e 616d  ..        df[nam
-00068770: 655f 636f 6c5d 203d 2030 0d0a 2020 2020  e_col] = 0..    
-00068780: 2020 2020 6466 5b6e 616d 655f 636f 6c5d      df[name_col]
-00068790: 203d 2064 665b 7473 636f 6c2b 275f 6d6f   = df[tscol+'_mo
-000687a0: 6e74 6827 5d2e 6d61 7028 6c61 6d62 6461  nth'].map(lambda
-000687b0: 2078 3a20 3120 6966 2078 2069 6e20 6665   x: 1 if x in fe
-000687c0: 7374 6976 6573 2065 6c73 6520 3029 2e76  stives else 0).v
-000687d0: 616c 7565 730d 0a20 2020 2020 2020 2023  alues..        #
-000687e0: 2323 2052 656d 656d 6265 7220 7468 6174  ## Remember that
-000687f0: 2066 696c 6c6e 6120 6f6e 6c79 2077 6f72   fillna only wor
-00068800: 6b73 2061 7420 6461 7461 6672 616d 6520  ks at dataframe 
-00068810: 6c65 7665 6c21 2023 2323 0d0a 2020 2020  level! ###..    
-00068820: 2020 2020 6466 5b5b 6e61 6d65 5f63 6f6c      df[[name_col
-00068830: 5d5d 203d 2064 665b 5b6e 616d 655f 636f  ]] = df[[name_co
-00068840: 6c5d 5d2e 6669 6c6c 6e61 2830 290d 0a20  l]].fillna(0).. 
-00068850: 2020 2020 2020 2064 745f 6164 6473 2e61         dt_adds.a
-00068860: 7070 656e 6428 6e61 6d65 5f63 6f6c 290d  ppend(name_col).
-00068870: 0a20 2020 2020 2020 2073 756d 6d65 7220  .        summer 
-00068880: 3d20 5b27 4a75 6e27 2c27 4a75 6c27 2c27  = ['Jun','Jul','
-00068890: 4175 6727 5d0d 0a20 2020 2020 2020 206e  Aug']..        n
-000688a0: 616d 655f 636f 6c20 3d20 7473 636f 6c2b  ame_col = tscol+
-000688b0: 225f 6973 5f73 756d 6d65 7222 0d0a 2020  "_is_summer"..  
-000688c0: 2020 2020 2020 6466 5b6e 616d 655f 636f        df[name_co
-000688d0: 6c5d 203d 2030 0d0a 2020 2020 2020 2020  l] = 0..        
-000688e0: 6466 5b6e 616d 655f 636f 6c5d 203d 2064  df[name_col] = d
-000688f0: 665b 7473 636f 6c2b 275f 6d6f 6e74 6827  f[tscol+'_month'
-00068900: 5d2e 6d61 7028 6c61 6d62 6461 2078 3a20  ].map(lambda x: 
-00068910: 3120 6966 2078 2069 6e20 7375 6d6d 6572  1 if x in summer
-00068920: 2065 6c73 6520 3029 2e76 616c 7565 730d   else 0).values.
-00068930: 0a20 2020 2020 2020 2023 2323 2052 656d  .        ### Rem
-00068940: 656d 6265 7220 7468 6174 2066 696c 6c6e  ember that filln
-00068950: 6120 6f6e 6c79 2077 6f72 6b73 2061 7420  a only works at 
-00068960: 6461 7461 6672 616d 6520 6c65 7665 6c21  dataframe level!
-00068970: 2023 2323 0d0a 2020 2020 2020 2020 6466   ###..        df
-00068980: 5b5b 6e61 6d65 5f63 6f6c 5d5d 203d 2064  [[name_col]] = d
-00068990: 665b 5b6e 616d 655f 636f 6c5d 5d2e 6669  f[[name_col]].fi
-000689a0: 6c6c 6e61 2830 290d 0a20 2020 2020 2020  llna(0)..       
-000689b0: 2064 745f 6164 6473 2e61 7070 656e 6428   dt_adds.append(
-000689c0: 6e61 6d65 5f63 6f6c 290d 0a20 2020 2020  name_col)..     
-000689d0: 2020 2077 696e 7465 7220 3d20 5b27 4465     winter = ['De
-000689e0: 6327 2c27 4a61 6e27 2c27 4665 6227 5d0d  c','Jan','Feb'].
-000689f0: 0a20 2020 2020 2020 206e 616d 655f 636f  .        name_co
-00068a00: 6c20 3d20 7473 636f 6c2b 225f 6973 5f77  l = tscol+"_is_w
-00068a10: 696e 7465 7222 0d0a 2020 2020 2020 2020  inter"..        
-00068a20: 6466 5b6e 616d 655f 636f 6c5d 203d 2030  df[name_col] = 0
-00068a30: 0d0a 2020 2020 2020 2020 6466 5b6e 616d  ..        df[nam
-00068a40: 655f 636f 6c5d 203d 2064 665b 7473 636f  e_col] = df[tsco
-00068a50: 6c2b 275f 6d6f 6e74 6827 5d2e 6d61 7028  l+'_month'].map(
-00068a60: 6c61 6d62 6461 2078 3a20 3120 6966 2078  lambda x: 1 if x
-00068a70: 2069 6e20 7769 6e74 6572 2065 6c73 6520   in winter else 
-00068a80: 3029 2e76 616c 7565 730d 0a20 2020 2020  0).values..     
-00068a90: 2020 2023 2323 2052 656d 656d 6265 7220     ### Remember 
-00068aa0: 7468 6174 2066 696c 6c6e 6120 6f6e 6c79  that fillna only
-00068ab0: 2077 6f72 6b73 2061 7420 6461 7461 6672   works at datafr
-00068ac0: 616d 6520 6c65 7665 6c21 2023 2323 0d0a  ame level! ###..
-00068ad0: 2020 2020 2020 2020 6466 5b5b 6e61 6d65          df[[name
-00068ae0: 5f63 6f6c 5d5d 203d 2064 665b 5b6e 616d  _col]] = df[[nam
-00068af0: 655f 636f 6c5d 5d2e 6669 6c6c 6e61 2830  e_col]].fillna(0
-00068b00: 290d 0a20 2020 2020 2020 2064 745f 6164  )..        dt_ad
-00068b10: 6473 2e61 7070 656e 6428 6e61 6d65 5f63  ds.append(name_c
-00068b20: 6f6c 290d 0a20 2020 2020 2020 2063 6f6c  ol)..        col
-00068b30: 6420 3d20 5b27 4f63 7427 2c27 4e6f 7627  d = ['Oct','Nov'
-00068b40: 2c27 4465 6327 2c27 4a61 6e27 2c27 4665  ,'Dec','Jan','Fe
-00068b50: 6227 2c27 4d61 7227 5d0d 0a20 2020 2020  b','Mar']..     
-00068b60: 2020 206e 616d 655f 636f 6c20 3d20 7473     name_col = ts
-00068b70: 636f 6c2b 225f 6973 5f63 6f6c 6422 0d0a  col+"_is_cold"..
-00068b80: 2020 2020 2020 2020 6466 5b6e 616d 655f          df[name_
-00068b90: 636f 6c5d 203d 2030 0d0a 2020 2020 2020  col] = 0..      
-00068ba0: 2020 6466 5b6e 616d 655f 636f 6c5d 203d    df[name_col] =
-00068bb0: 2064 665b 7473 636f 6c2b 275f 6d6f 6e74   df[tscol+'_mont
-00068bc0: 6827 5d2e 6d61 7028 6c61 6d62 6461 2078  h'].map(lambda x
-00068bd0: 3a20 3120 6966 2078 2069 6e20 636f 6c64  : 1 if x in cold
-00068be0: 2065 6c73 6520 3029 2e76 616c 7565 730d   else 0).values.
-00068bf0: 0a20 2020 2020 2020 2023 2323 2052 656d  .        ### Rem
-00068c00: 656d 6265 7220 7468 6174 2066 696c 6c6e  ember that filln
-00068c10: 6120 6f6e 6c79 2077 6f72 6b73 2061 7420  a only works at 
-00068c20: 6461 7461 6672 616d 6520 6c65 7665 6c21  dataframe level!
-00068c30: 2023 2323 0d0a 2020 2020 2020 2020 6466   ###..        df
-00068c40: 5b5b 6e61 6d65 5f63 6f6c 5d5d 203d 2064  [[name_col]] = d
-00068c50: 665b 5b6e 616d 655f 636f 6c5d 5d2e 6669  f[[name_col]].fi
-00068c60: 6c6c 6e61 2830 290d 0a20 2020 2020 2020  llna(0)..       
-00068c70: 2064 745f 6164 6473 2e61 7070 656e 6428   dt_adds.append(
-00068c80: 6e61 6d65 5f63 6f6c 290d 0a20 2020 2020  name_col)..     
-00068c90: 2020 2077 6172 6d20 3d20 5b27 4170 7227     warm = ['Apr'
-00068ca0: 2c27 4d61 7927 2c27 4a75 6e27 2c27 4a75  ,'May','Jun','Ju
-00068cb0: 6c27 2c27 4175 6727 2c27 5365 7027 5d0d  l','Aug','Sep'].
-00068cc0: 0a20 2020 2020 2020 206e 616d 655f 636f  .        name_co
-00068cd0: 6c20 3d20 7473 636f 6c2b 225f 6973 5f77  l = tscol+"_is_w
-00068ce0: 6172 6d22 0d0a 2020 2020 2020 2020 6466  arm"..        df
-00068cf0: 5b6e 616d 655f 636f 6c5d 203d 2030 0d0a  [name_col] = 0..
-00068d00: 2020 2020 2020 2020 6466 5b6e 616d 655f          df[name_
-00068d10: 636f 6c5d 203d 2064 665b 7473 636f 6c2b  col] = df[tscol+
-00068d20: 275f 6d6f 6e74 6827 5d2e 6d61 7028 6c61  '_month'].map(la
-00068d30: 6d62 6461 2078 3a20 3120 6966 2078 2069  mbda x: 1 if x i
-00068d40: 6e20 7761 726d 2065 6c73 6520 3029 2e76  n warm else 0).v
-00068d50: 616c 7565 730d 0a20 2020 2020 2020 2064  alues..        d
-00068d60: 665b 5b6e 616d 655f 636f 6c5d 5d20 3d20  f[[name_col]] = 
-00068d70: 6466 5b5b 6e61 6d65 5f63 6f6c 5d5d 2e66  df[[name_col]].f
-00068d80: 696c 6c6e 6128 3029 0d0a 2020 2020 2020  illna(0)..      
-00068d90: 2020 6474 5f61 6464 732e 6170 7065 6e64    dt_adds.append
-00068da0: 286e 616d 655f 636f 6c29 0d0a 2020 2020  (name_col)..    
-00068db0: 2020 2020 2323 2323 2323 2323 2323 2323      ############
-00068dc0: 2323 2323 2323 2323 2323 2323 2323 2323  ################
-00068dd0: 2323 2323 2323 2323 2323 2323 2323 2323  ################
-00068de0: 2323 2323 2323 2323 2323 2323 2323 2323  ################
-00068df0: 2323 2323 2323 2323 2323 2323 230d 0a20  #############.. 
-00068e00: 2020 2020 2020 2069 6620 7473 636f 6c2b         if tscol+
-00068e10: 275f 6461 796f 6677 6565 6b27 2069 6e20  '_dayofweek' in 
-00068e20: 6474 5f61 6464 733a 0d0a 2020 2020 2020  dt_adds:..      
-00068e30: 2020 2020 2020 6466 2e6c 6f63 5b3a 2c74        df.loc[:,t
-00068e40: 7363 6f6c 2b27 5f6d 6f6e 7468 5f64 6179  scol+'_month_day
-00068e50: 6f66 7765 656b 5f63 726f 7373 275d 203d  ofweek_cross'] =
-00068e60: 2064 665b 7473 636f 6c2b 275f 6d6f 6e74   df[tscol+'_mont
-00068e70: 6827 5d20 2b22 2022 2b20 6466 5b74 7363  h'] +" "+ df[tsc
-00068e80: 6f6c 2b27 5f64 6179 6f66 7765 656b 275d  ol+'_dayofweek']
-00068e90: 0d0a 2020 2020 2020 2020 2020 2020 6474  ..            dt
-00068ea0: 5f61 6464 732e 6170 7065 6e64 2874 7363  _adds.append(tsc
-00068eb0: 6f6c 2b27 5f6d 6f6e 7468 5f64 6179 6f66  ol+'_month_dayof
-00068ec0: 7765 656b 5f63 726f 7373 2729 0d0a 2020  week_cross')..  
-00068ed0: 2020 2020 2020 6466 5b74 7363 6f6c 2b27        df[tscol+'
-00068ee0: 5f79 6561 7227 5d20 3d20 6466 5b74 7363  _year'] = df[tsc
-00068ef0: 6f6c 5d2e 6474 2e79 6561 722e 6669 6c6c  ol].dt.year.fill
-00068f00: 6e61 2830 292e 6173 7479 7065 2869 6e74  na(0).astype(int
-00068f10: 290d 0a20 2020 2020 2020 2064 745f 6164  )..        dt_ad
-00068f20: 6473 2e61 7070 656e 6428 7473 636f 6c2b  ds.append(tscol+
-00068f30: 275f 7965 6172 2729 0d0a 2020 2020 2020  '_year')..      
-00068f40: 2020 746f 6461 7920 3d20 6461 7465 2e74    today = date.t
-00068f50: 6f64 6179 2829 0d0a 2020 2020 2020 2020  oday()..        
-00068f60: 6466 5b74 7363 6f6c 2b27 5f61 6765 5f69  df[tscol+'_age_i
-00068f70: 6e5f 7965 6172 7327 5d20 3d20 746f 6461  n_years'] = toda
-00068f80: 792e 7965 6172 202d 2064 665b 7473 636f  y.year - df[tsco
-00068f90: 6c5d 2e64 742e 7965 6172 2e66 696c 6c6e  l].dt.year.filln
-00068fa0: 6128 3029 2e61 7374 7970 6528 696e 7429  a(0).astype(int)
-00068fb0: 0d0a 2020 2020 2020 2020 6474 5f61 6464  ..        dt_add
-00068fc0: 732e 6170 7065 6e64 2874 7363 6f6c 2b27  s.append(tscol+'
-00068fd0: 5f61 6765 5f69 6e5f 7965 6172 7327 290d  _age_in_years').
-00068fe0: 0a20 2020 2020 2020 2064 665b 7473 636f  .        df[tsco
-00068ff0: 6c2b 275f 6461 796f 6679 6561 7227 5d20  l+'_dayofyear'] 
-00069000: 3d20 6466 5b74 7363 6f6c 5d2e 6474 2e64  = df[tscol].dt.d
-00069010: 6179 6f66 7965 6172 2e66 696c 6c6e 6128  ayofyear.fillna(
-00069020: 3029 2e61 7374 7970 6528 696e 7429 0d0a  0).astype(int)..
-00069030: 2020 2020 2020 2020 6474 5f61 6464 732e          dt_adds.
-00069040: 6170 7065 6e64 2874 7363 6f6c 2b27 5f64  append(tscol+'_d
-00069050: 6179 6f66 7965 6172 2729 0d0a 2020 2020  ayofyear')..    
-00069060: 2020 2020 6466 5b74 7363 6f6c 2b27 5f64      df[tscol+'_d
-00069070: 6179 6f66 6d6f 6e74 6827 5d20 3d20 6466  ayofmonth'] = df
-00069080: 5b74 7363 6f6c 5d2e 6474 2e64 6179 2e66  [tscol].dt.day.f
-00069090: 696c 6c6e 6128 3029 2e61 7374 7970 6528  illna(0).astype(
-000690a0: 696e 7429 0d0a 2020 2020 2020 2020 6474  int)..        dt
-000690b0: 5f61 6464 732e 6170 7065 6e64 2874 7363  _adds.append(tsc
-000690c0: 6f6c 2b27 5f64 6179 6f66 6d6f 6e74 6827  ol+'_dayofmonth'
-000690d0: 290d 0a20 2020 2020 2020 2064 665b 7473  )..        df[ts
-000690e0: 636f 6c2b 275f 7765 656b 6f66 7965 6172  col+'_weekofyear
-000690f0: 275d 203d 2064 665b 7473 636f 6c5d 2e64  '] = df[tscol].d
-00069100: 742e 7765 656b 6f66 7965 6172 2e66 696c  t.weekofyear.fil
-00069110: 6c6e 6128 3029 2e61 7374 7970 6528 696e  lna(0).astype(in
-00069120: 7429 0d0a 2020 2020 2020 2020 6474 5f61  t)..        dt_a
-00069130: 6464 732e 6170 7065 6e64 2874 7363 6f6c  dds.append(tscol
-00069140: 2b27 5f77 6565 6b6f 6679 6561 7227 290d  +'_weekofyear').
-00069150: 0a20 2020 2020 2020 2077 6565 6b65 6e64  .        weekend
-00069160: 7320 3d20 2864 665b 7473 636f 6c2b 275f  s = (df[tscol+'_
-00069170: 6461 796f 6677 6565 6b27 5d20 3d3d 2027  dayofweek'] == '
-00069180: 5361 7427 2920 7c20 2864 665b 7473 636f  Sat') | (df[tsco
-00069190: 6c2b 275f 6461 796f 6677 6565 6b27 5d20  l+'_dayofweek'] 
-000691a0: 3d3d 2027 5375 6e27 290d 0a20 2020 2020  == 'Sun')..     
-000691b0: 2020 2064 665b 7473 636f 6c2b 275f 7479     df[tscol+'_ty
-000691c0: 7065 6f66 6461 7927 5d20 3d20 2777 6565  peofday'] = 'wee
-000691d0: 6b64 6179 270d 0a20 2020 2020 2020 2064  kday'..        d
-000691e0: 662e 6c6f 635b 7765 656b 656e 6473 2c20  f.loc[weekends, 
-000691f0: 7473 636f 6c2b 275f 7479 7065 6f66 6461  tscol+'_typeofda
-00069200: 7927 5d20 3d20 2777 6565 6b65 6e64 270d  y'] = 'weekend'.
-00069210: 0a20 2020 2020 2020 2064 745f 6164 6473  .        dt_adds
-00069220: 2e61 7070 656e 6428 7473 636f 6c2b 275f  .append(tscol+'_
-00069230: 7479 7065 6f66 6461 7927 290d 0a20 2020  typeofday')..   
-00069240: 2020 2020 2069 6620 7473 636f 6c2b 275f       if tscol+'_
-00069250: 7479 7065 6f66 6461 7927 2069 6e20 6474  typeofday' in dt
-00069260: 5f61 6464 733a 0d0a 2020 2020 2020 2020  _adds:..        
-00069270: 2020 2020 6466 2e6c 6f63 5b3a 2c74 7363      df.loc[:,tsc
-00069280: 6f6c 2b27 5f6d 6f6e 7468 5f74 7970 656f  ol+'_month_typeo
-00069290: 6664 6179 5f63 726f 7373 275d 203d 2064  fday_cross'] = d
-000692a0: 665b 7473 636f 6c2b 275f 6d6f 6e74 6827  f[tscol+'_month'
-000692b0: 5d20 2b22 2022 2b20 6466 5b74 7363 6f6c  ] +" "+ df[tscol
-000692c0: 2b27 5f74 7970 656f 6664 6179 275d 0d0a  +'_typeofday']..
-000692d0: 2020 2020 2020 2020 2020 2020 6474 5f61              dt_a
-000692e0: 6464 732e 6170 7065 6e64 2874 7363 6f6c  dds.append(tscol
-000692f0: 2b27 5f6d 6f6e 7468 5f74 7970 656f 6664  +'_month_typeofd
-00069300: 6179 5f63 726f 7373 2729 0d0a 2020 2020  ay_cross')..    
-00069310: 6578 6365 7074 3a0d 0a20 2020 2020 2020  except:..       
-00069320: 2070 7269 6e74 2827 2020 2020 4572 726f   print('    Erro
-00069330: 7220 696e 2063 7265 6174 696e 6720 6461  r in creating da
-00069340: 7465 2074 696d 6520 6465 7269 7665 6420  te time derived 
-00069350: 6665 6174 7572 6573 2e20 436f 6e74 696e  features. Contin
-00069360: 7569 6e67 2e2e 2e27 290d 0a20 2020 2070  uing...')..    p
-00069370: 7269 6e74 2827 2020 2020 4164 6465 6420  rint('    Added 
-00069380: 2564 2063 6f6c 756d 6e73 2066 726f 6d20  %d columns from 
-00069390: 2573 2063 6f6c 756d 6e27 2025 286c 656e  %s column' %(len
-000693a0: 2864 745f 6164 6473 292c 7473 636f 6c29  (dt_adds),tscol)
-000693b0: 290d 0a20 2020 2064 6620 3d20 6466 5b64  )..    df = df[d
-000693c0: 745f 6164 6473 5d0d 0a20 2020 2072 6574  t_adds]..    ret
-000693d0: 7572 6e20 6466 0d0a 2323 2323 2323 2323  urn df..########
-000693e0: 2323 2323 2323 2323 2323 2323 2323 2323  ################
-000693f0: 2323 2323 2323 2323 2323 2323 2323 2323  ################
-00069400: 2323 2323 2323 2323 2323 2323 2323 2323  ################
-00069410: 2323 2323 2323 2323 0d0a 6672 6f6d 2064  ########..from d
-00069420: 6174 6575 7469 6c2e 7265 6c61 7469 7665  ateutil.relative
-00069430: 6465 6c74 6120 696d 706f 7274 2072 656c  delta import rel
-00069440: 6174 6976 6564 656c 7461 0d0a 6672 6f6d  ativedelta..from
-00069450: 2064 6174 6574 696d 6520 696d 706f 7274   datetime import
-00069460: 2064 6174 650d 0a23 2323 2323 2054 6869   date..##### Thi
-00069470: 7320 6973 2061 206c 6974 746c 6520 7574  s is a little ut
-00069480: 696c 6974 7920 7468 6174 2063 6f6d 7075  ility that compu
-00069490: 7465 7320 6167 6520 6672 6f6d 2079 6561  tes age from yea
-000694a0: 7220 2323 2323 0d0a 6465 6620 636f 6d70  r ####..def comp
-000694b0: 7574 655f 6167 6528 7965 6172 5f73 7472  ute_age(year_str
-000694c0: 696e 6729 3a0d 0a20 2020 2074 6f64 6179  ing):..    today
-000694d0: 203d 2064 6174 652e 746f 6461 7928 290d   = date.today().
-000694e0: 0a20 2020 2061 6765 203d 2072 656c 6174  .    age = relat
-000694f0: 6976 6564 656c 7461 2874 6f64 6179 2c20  ivedelta(today, 
-00069500: 7965 6172 5f73 7472 696e 6729 0d0a 2020  year_string)..  
-00069510: 2020 7265 7475 726e 2061 6765 2e79 6561    return age.yea
-00069520: 7273 0d0a 2323 2323 2323 2323 2323 2323  rs..############
-00069530: 2323 2323 2323 2323 2323 2323 2323 2323  ################
+00067ac0: 7473 6461 7461 203d 2074 6573 7464 665b  tsdata = testdf[
+00067ad0: 3a5d 0d0a 2020 2020 2020 2020 2020 2020  :]..            
+00067ae0: 2020 2020 656c 7365 3a0d 0a20 2020 2020      else:..     
+00067af0: 2020 2020 2020 2020 2020 2020 2020 2070                 p
+00067b00: 7269 6e74 2827 2020 2020 5465 7374 2064  rint('    Test d
+00067b10: 6174 6120 6861 7320 7369 6e67 6c65 2063  ata has single c
+00067b20: 6c61 7373 2e20 4f76 6572 7772 6974 696e  lass. Overwritin
+00067b30: 6720 7072 6564 6963 7469 6f6e 7320 6f6e  g predictions on
+00067b40: 2054 6573 7420 5461 7267 6574 2063 6f6c   Test Target col
+00067b50: 756d 6e2e 2729 0d0a 2020 2020 2020 2020  umn.')..        
+00067b60: 2020 2020 2020 2020 2020 2020 7072 6564              pred
+00067b70: 6963 746f 7273 203d 205b 7820 666f 7220  ictors = [x for 
+00067b80: 7820 696e 206c 6973 7428 7472 6169 6e64  x in list(traind
+00067b90: 6629 2069 6620 7820 6e6f 7420 696e 2074  f) if x not in t
+00067ba0: 6172 6765 745d 0d0a 2020 2020 2020 2020  arget]..        
+00067bb0: 2020 2020 2020 2020 2020 2020 7473 6461              tsda
+00067bc0: 7461 203d 2074 6573 7464 665b 3a5d 0d0a  ta = testdf[:]..
+00067bd0: 2020 2020 2020 2020 2020 2020 6578 6365              exce
+00067be0: 7074 3a0d 0a20 2020 2020 2020 2020 2020  pt:..           
+00067bf0: 2020 2020 2070 7269 6e74 2827 2020 2020       print('    
+00067c00: 4e6f 2054 6172 6765 7420 636f 6c75 6d6e  No Target column
+00067c10: 2069 6e20 5465 7374 2064 6174 6127 290d   in Test data').
+00067c20: 0a20 2020 2020 2020 2020 2020 2020 2020  .               
+00067c30: 2074 6573 7464 665b 7461 7267 6574 5d20   testdf[target] 
+00067c40: 3d20 300d 0a20 2020 2020 2020 2020 2020  = 0..           
+00067c50: 2020 2020 2074 7364 6174 6120 3d20 7465       tsdata = te
+00067c60: 7374 6466 5b63 6f6c 732b 5b74 6172 6765  stdf[cols+[targe
+00067c70: 745d 5d0d 0a20 2020 2020 2020 2065 6c73  t]]..        els
+00067c80: 653a 0d0a 2020 2020 2020 2020 2020 2020  e:..            
+00067c90: 696e 6469 6365 7320 3d20 6e70 2e72 616e  indices = np.ran
+00067ca0: 646f 6d2e 7065 726d 7574 6174 696f 6e28  dom.permutation(
+00067cb0: 7472 6169 6e64 662e 7368 6170 655b 305d  traindf.shape[0]
+00067cc0: 290d 0a20 2020 2020 2020 2020 2020 2074  )..            t
+00067cd0: 7261 696e 5f72 6f77 7320 3d20 696e 7428  rain_rows = int(
+00067ce0: 302e 382a 7472 6169 6e64 662e 7368 6170  0.8*traindf.shap
+00067cf0: 655b 305d 290d 0a20 2020 2020 2020 2020  e[0])..         
+00067d00: 2020 2074 7261 696e 696e 675f 6964 782c     training_idx,
+00067d10: 2074 6573 745f 6964 7820 3d20 696e 6469   test_idx = indi
+00067d20: 6365 735b 3a74 7261 696e 5f72 6f77 735d  ces[:train_rows]
+00067d30: 2c20 696e 6469 6365 735b 7472 6169 6e5f  , indices[train_
+00067d40: 726f 7773 3a5d 0d0a 2020 2020 2020 2020  rows:]..        
+00067d50: 2020 2020 7472 6164 6174 612c 2063 7664      tradata, cvd
+00067d60: 6174 6120 3d20 7472 6169 6e64 662e 696c  ata = traindf.il
+00067d70: 6f63 5b74 7261 696e 696e 675f 6964 785d  oc[training_idx]
+00067d80: 2c20 7472 6169 6e64 662e 696c 6f63 5b74  , traindf.iloc[t
+00067d90: 6573 745f 6964 785d 0d0a 2020 2020 2020  est_idx]..      
+00067da0: 2020 2020 2020 7473 6461 7461 203d 2074        tsdata = t
+00067db0: 6573 7464 665b 3a5d 0d0a 2020 2020 2020  estdf[:]..      
+00067dc0: 2020 7265 7475 726e 2074 7261 6461 7461    return tradata
+00067dd0: 2c20 6376 6461 7461 2c20 7473 6461 7461  , cvdata, tsdata
+00067de0: 2c20 636f 6c73 0d0a 2323 2323 2323 2323  , cols..########
+00067df0: 2323 2323 2323 2323 2323 2323 2323 2323  ################
+00067e00: 2323 2323 2323 2323 2323 2323 2323 2323  ################
+00067e10: 2323 2323 2323 2323 2323 2323 2323 2323  ################
+00067e20: 2323 2323 2323 2323 2323 2323 2323 2323  ################
+00067e30: 2323 2323 0d0a 6465 6620 6669 6c6c 696e  ####..def fillin
+00067e40: 675f 6d69 7373 696e 675f 7661 6c75 6573  g_missing_values
+00067e50: 5f73 696d 706c 6528 7472 6169 6e2c 2074  _simple(train, t
+00067e60: 6573 742c 2063 6174 732c 206e 756d 7329  est, cats, nums)
+00067e70: 3a0d 0a20 2020 2023 2323 2320 6966 2079  :..    #### if y
+00067e80: 6f75 2077 616e 7420 746f 2066 696c 6c20  ou want to fill 
+00067e90: 6d69 7373 696e 6720 7661 6c75 6573 2075  missing values u
+00067ea0: 7369 6e67 206d 6561 6e2c 206d 6564 6961  sing mean, media
+00067eb0: 6e20 6d6f 6465 2c20 676f 2061 6865 6164  n mode, go ahead
+00067ec0: 210d 0a20 2020 2023 2323 2320 2049 2064  !..    ####  I d
+00067ed0: 6f6e 2774 2072 6563 6f6d 6d65 6e64 2042  on't recommend B
+00067ee0: 7574 2073 6f6d 6520 7065 6f70 6c65 2073  ut some people s
+00067ef0: 6565 6d20 746f 206c 696b 6520 6974 2e20  eem to like it. 
+00067f00: 2323 2323 230d 0a20 2020 2066 6f72 2076  #####..    for v
+00067f10: 6172 6d20 696e 2063 6174 733a 0d0a 2020  arm in cats:..  
+00067f20: 2020 2020 2020 6966 2074 7261 696e 5b76        if train[v
+00067f30: 6172 6d5d 2e69 736e 756c 6c28 292e 7375  arm].isnull().su
+00067f40: 6d28 2920 3e20 303a 0d0a 2020 2020 2020  m() > 0:..      
+00067f50: 2020 2020 2020 6669 6c6c 6e75 6d20 3d20        fillnum = 
+00067f60: 7472 6169 6e5b 7661 726d 5d2e 6d6f 6465  train[varm].mode
+00067f70: 2829 5b30 5d0d 0a20 2020 2020 2020 2020  ()[0]..         
+00067f80: 2020 2023 2323 2052 656d 656d 6265 7220     ### Remember 
+00067f90: 7468 6174 2066 696c 6c6e 6120 6f6e 6c79  that fillna only
+00067fa0: 2077 6f72 6b73 2061 7420 6461 7461 6672   works at datafr
+00067fb0: 616d 6520 6c65 7665 6c21 2023 2323 0d0a  ame level! ###..
+00067fc0: 2020 2020 2020 2020 2020 2020 7472 6169              trai
+00067fd0: 6e5b 5b76 6172 6d5d 5d20 3d20 7472 6169  n[[varm]] = trai
+00067fe0: 6e5b 5b76 6172 6d5d 5d2e 6669 6c6c 6e61  n[[varm]].fillna
+00067ff0: 2866 696c 6c6e 756d 290d 0a20 2020 2020  (fillnum)..     
+00068000: 2020 2020 2020 2069 6620 6e6f 7420 6973         if not is
+00068010: 696e 7374 616e 6365 2874 6573 742c 2073  instance(test, s
+00068020: 7472 293a 0d0a 2020 2020 2020 2020 2020  tr):..          
+00068030: 2020 2020 2020 6966 2074 6573 745b 7661        if test[va
+00068040: 726d 5d2e 6973 6e75 6c6c 2829 2e73 756d  rm].isnull().sum
+00068050: 2829 203e 2030 3a0d 0a20 2020 2020 2020  () > 0:..       
+00068060: 2020 2020 2020 2020 2020 2020 2023 2323               ###
+00068070: 2052 656d 656d 6265 7220 7468 6174 2066   Remember that f
+00068080: 696c 6c6e 6120 6f6e 6c79 2077 6f72 6b73  illna only works
+00068090: 2061 7420 6461 7461 6672 616d 6520 6c65   at dataframe le
+000680a0: 7665 6c21 2023 2323 0d0a 2020 2020 2020  vel! ###..      
+000680b0: 2020 2020 2020 2020 2020 2020 2020 7465                te
+000680c0: 7374 5b5b 7661 726d 5d5d 203d 2074 6573  st[[varm]] = tes
+000680d0: 745b 5b76 6172 6d5d 5d2e 6669 6c6c 6e61  t[[varm]].fillna
+000680e0: 2866 696c 6c6e 756d 290d 0a20 2020 2066  (fillnum)..    f
+000680f0: 6f72 206e 756d 2069 6e20 6e75 6d73 3a0d  or num in nums:.
+00068100: 0a20 2020 2020 2020 2069 6620 7472 6169  .        if trai
+00068110: 6e5b 7661 726d 5d2e 6973 6e75 6c6c 2829  n[varm].isnull()
+00068120: 2e73 756d 2829 203e 2030 3a0d 0a20 2020  .sum() > 0:..   
+00068130: 2020 2020 2020 2020 2066 696c 6c6e 756d           fillnum
+00068140: 203d 2074 7261 696e 5b6e 756d 5d2e 6d65   = train[num].me
+00068150: 616e 2829 0d0a 2020 2020 2020 2020 2020  an()..          
+00068160: 2020 2323 2320 5265 6d65 6d62 6572 2074    ### Remember t
+00068170: 6861 7420 6669 6c6c 6e61 206f 6e6c 7920  hat fillna only 
+00068180: 776f 726b 7320 6174 2064 6174 6166 7261  works at datafra
+00068190: 6d65 206c 6576 656c 2120 2323 230d 0a20  me level! ###.. 
+000681a0: 2020 2020 2020 2020 2020 2074 7261 696e             train
+000681b0: 5b5b 6e75 6d5d 5d20 3d20 7472 6169 6e5b  [[num]] = train[
+000681c0: 5b6e 756d 5d5d 2e66 696c 6c6e 6128 6669  [num]].fillna(fi
+000681d0: 6c6c 6e75 6d29 0d0a 2020 2020 2020 2020  llnum)..        
+000681e0: 2020 2020 6966 206e 6f74 2069 7369 6e73      if not isins
+000681f0: 7461 6e63 6528 7465 7374 2c20 7374 7229  tance(test, str)
+00068200: 3a0d 0a20 2020 2020 2020 2020 2020 2020  :..             
+00068210: 2020 2069 6620 7465 7374 5b76 6172 6d5d     if test[varm]
+00068220: 2e69 736e 756c 6c28 292e 7375 6d28 2920  .isnull().sum() 
+00068230: 3e20 303a 0d0a 2020 2020 2020 2020 2020  > 0:..          
+00068240: 2020 2020 2020 2020 2020 2323 2320 5265            ### Re
+00068250: 6d65 6d62 6572 2074 6861 7420 6669 6c6c  member that fill
+00068260: 6e61 206f 6e6c 7920 776f 726b 7320 6174  na only works at
+00068270: 2064 6174 6166 7261 6d65 206c 6576 656c   dataframe level
+00068280: 2120 2323 230d 0a20 2020 2020 2020 2020  ! ###..         
+00068290: 2020 2020 2020 2020 2020 2074 6573 745b             test[
+000682a0: 5b6e 756d 5d5d 203d 2074 6573 745b 5b6e  [num]] = test[[n
+000682b0: 756d 5d5d 2e66 696c 6c6e 6128 6669 6c6c  um]].fillna(fill
+000682c0: 6e75 6d29 0d0a 2020 2020 2323 2320 5468  num)..    ### Th
+000682d0: 6973 2069 7320 6120 7369 6d70 6c65 206c  is is a simple l
+000682e0: 6f67 2074 7261 6e73 666f 726d 2066 6f72  og transform for
+000682f0: 2076 6572 7920 6c61 7267 6520 6e75 6d65   very large nume
+00068300: 7269 6320 7661 6c75 6573 203d 3e20 6869  ric values => hi
+00068310: 6768 6c79 2072 6563 6f6d 6d65 6e64 6564  ghly recommended
+00068320: 210d 0a20 2020 2066 6f72 206e 756d 2069  !..    for num i
+00068330: 6e20 6e75 6d73 3a0d 0a20 2020 2020 2020  n nums:..       
+00068340: 206d 6173 6b20 3d20 7472 6169 6e5b 6e75   mask = train[nu
+00068350: 6d5d 3d3d 300d 0a20 2020 2020 2020 2066  m]==0..        f
+00068360: 696c 6c6e 756d 203d 2031 3065 2d35 0d0a  illnum = 10e-5..
+00068370: 2020 2020 2020 2020 7472 6169 6e2e 6978          train.ix
+00068380: 5b6d 6173 6b2c 6e75 6d5d 203d 2066 696c  [mask,num] = fil
+00068390: 6c6e 756d 0d0a 2020 2020 2020 2020 2323  lnum..        ##
+000683a0: 2320 5265 6d65 6d62 6572 2074 6861 7420  # Remember that 
+000683b0: 6669 6c6c 6e61 206f 6e6c 7920 776f 726b  fillna only work
+000683c0: 7320 6174 2064 6174 6166 7261 6d65 206c  s at dataframe l
+000683d0: 6576 656c 2120 2323 230d 0a20 2020 2020  evel! ###..     
+000683e0: 2020 2074 7261 696e 5b5b 6e75 6d2b 275f     train[[num+'_
+000683f0: 6c6f 6727 5d5d 203d 206e 702e 6c6f 6731  log']] = np.log1
+00068400: 3028 7472 6169 6e5b 5b6e 756d 5d5d 292e  0(train[[num]]).
+00068410: 6669 6c6c 6e61 2830 290d 0a20 2020 2020  fillna(0)..     
+00068420: 2020 2069 6620 6e6f 7420 6973 696e 7374     if not isinst
+00068430: 616e 6365 2874 6573 742c 2073 7472 293a  ance(test, str):
+00068440: 0d0a 2020 2020 2020 2020 2020 2020 6d61  ..            ma
+00068450: 736b 203d 2074 6573 745b 6e75 6d5d 3d3d  sk = test[num]==
+00068460: 300d 0a20 2020 2020 2020 2020 2020 2074  0..            t
+00068470: 6573 742e 6978 5b6d 6173 6b2c 6e75 6d5d  est.ix[mask,num]
+00068480: 203d 2066 696c 6c6e 756d 0d0a 2020 2020   = fillnum..    
+00068490: 2020 2020 2020 2020 2323 2320 5265 6d65          ### Reme
+000684a0: 6d62 6572 2074 6861 7420 6669 6c6c 6e61  mber that fillna
+000684b0: 206f 6e6c 7920 776f 726b 7320 6174 2064   only works at d
+000684c0: 6174 6166 7261 6d65 206c 6576 656c 2120  ataframe level! 
+000684d0: 2323 230d 0a20 2020 2020 2020 2020 2020  ###..           
+000684e0: 2074 6573 745b 5b6e 756d 2b27 5f6c 6f67   test[[num+'_log
+000684f0: 275d 5d20 3d20 6e70 2e6c 6f67 3130 2874  ']] = np.log10(t
+00068500: 6573 745b 5b6e 756d 5d5d 292e 6669 6c6c  est[[num]]).fill
+00068510: 6e61 2830 290d 0a20 2020 2072 6574 7572  na(0)..    retur
+00068520: 6e20 7472 6169 6e2c 2074 6573 740d 0a23  n train, test..#
+00068530: 2323 2323 2323 2323 2323 2323 2323 2323  ################
+00068540: 2323 2323 2323 2323 2323 2323 2323 2323  ################
+00068550: 2323 2323 2323 2323 2323 2323 2323 2323  ################
+00068560: 2323 2323 2323 2323 2323 230d 0a69 6d70  ###########..imp
+00068570: 6f72 7420 6f73 0d0a 6465 6620 7772 6974  ort os..def writ
+00068580: 655f 6669 6c65 5f74 6f5f 666f 6c64 6572  e_file_to_folder
+00068590: 2864 662c 2065 6163 685f 7461 7267 6574  (df, each_target
+000685a0: 2c20 6261 7365 5f66 696c 656e 616d 652c  , base_filename,
+000685b0: 2076 6572 626f 7365 3d31 293a 0d0a 2020   verbose=1):..  
+000685c0: 2020 6966 2069 7369 6e73 7461 6e63 6528    if isinstance(
+000685d0: 6561 6368 5f74 6172 6765 742c 2073 7472  each_target, str
+000685e0: 293a 0d0a 2020 2020 2020 2020 6469 725f  ):..        dir_
+000685f0: 6e61 6d65 203d 2063 6f70 792e 6465 6570  name = copy.deep
+00068600: 636f 7079 2865 6163 685f 7461 7267 6574  copy(each_target
+00068610: 290d 0a20 2020 2065 6c73 653a 0d0a 2020  )..    else:..  
+00068620: 2020 2020 2020 6469 725f 6e61 6d65 203d        dir_name =
+00068630: 2073 7472 2865 6163 685f 7461 7267 6574   str(each_target
+00068640: 290d 0a20 2020 2066 696c 656e 616d 6520  )..    filename 
+00068650: 3d20 6f73 2e70 6174 682e 6a6f 696e 2864  = os.path.join(d
+00068660: 6972 5f6e 616d 652c 2062 6173 655f 6669  ir_name, base_fi
+00068670: 6c65 6e61 6d65 290d 0a20 2020 2069 6620  lename)..    if 
+00068680: 7665 7262 6f73 6520 3e3d 2031 3a0d 0a20  verbose >= 1:.. 
+00068690: 2020 2020 2020 2069 6620 6f73 2e6e 616d         if os.nam
+000686a0: 6520 3d3d 2027 6e74 273a 0d0a 2020 2020  e == 'nt':..    
+000686b0: 2020 2020 2020 2020 7072 696e 7428 2720          print(' 
+000686c0: 2020 2053 6176 696e 6720 7072 6564 6963     Saving predic
+000686d0: 7469 6f6e 7320 746f 202e 5c25 7327 2025  tions to .\%s' %
+000686e0: 6669 6c65 6e61 6d65 290d 0a20 2020 2020  filename)..     
+000686f0: 2020 2065 6c73 653a 0d0a 2020 2020 2020     else:..      
+00068700: 2020 2020 2020 7072 696e 7428 2720 2020        print('   
+00068710: 2053 6176 696e 6720 7072 6564 6963 7469   Saving predicti
+00068720: 6f6e 7320 746f 202e 2f25 7327 2025 6669  ons to ./%s' %fi
+00068730: 6c65 6e61 6d65 290d 0a20 2020 2020 2020  lename)..       
+00068740: 2069 6620 6e6f 7420 6f73 2e70 6174 682e   if not os.path.
+00068750: 6973 6469 7228 6469 725f 6e61 6d65 293a  isdir(dir_name):
+00068760: 0d0a 2020 2020 2020 2020 2020 2020 6f73  ..            os
+00068770: 2e6d 6b64 6972 2864 6972 5f6e 616d 6529  .mkdir(dir_name)
+00068780: 0d0a 2020 2020 2020 2020 6466 2e74 6f5f  ..        df.to_
+00068790: 6373 7628 6669 6c65 6e61 6d65 2c69 6e64  csv(filename,ind
+000687a0: 6578 3d46 616c 7365 290d 0a23 2323 2323  ex=False)..#####
+000687b0: 2323 2323 2323 2323 2323 2323 2323 2323  ################
+000687c0: 2323 2323 2323 2323 2323 2323 2323 2323  ################
+000687d0: 2323 2323 2323 2323 2323 2323 2323 2323  ################
+000687e0: 2323 2323 2323 2323 230d 0a64 6566 2063  #########..def c
+000687f0: 7265 6174 655f 7473 5f66 6561 7475 7265  reate_ts_feature
+00068800: 7328 6466 2c20 7473 636f 6c29 3a0d 0a20  s(df, tscol):.. 
+00068810: 2020 2022 2222 0d0a 2020 2020 5468 6973     """..    This
+00068820: 2074 616b 6573 2069 6e20 696e 7075 7420   takes in input 
+00068830: 6120 6461 7461 6672 616d 6520 616e 6420  a dataframe and 
+00068840: 6120 6461 7465 2076 6172 6961 626c 652e  a date variable.
+00068850: 0d0a 2020 2020 4974 2074 6865 6e20 6372  ..    It then cr
+00068860: 6561 7465 7320 7469 6d65 2073 6572 6965  eates time serie
+00068870: 7320 6665 6174 7572 6573 2075 7369 6e67  s features using
+00068880: 2074 6865 2070 616e 6461 7320 2e64 742e   the pandas .dt.
+00068890: 7765 656b 6461 7920 6b69 6e64 206f 6620  weekday kind of 
+000688a0: 7379 6e74 6178 2e0d 0a20 2020 2049 7420  syntax...    It 
+000688b0: 616c 736f 2072 6574 7572 6e73 2074 6865  also returns the
+000688c0: 2064 6174 6120 6672 616d 6520 6f66 2061   data frame of a
+000688d0: 6464 6564 2066 6561 7475 7265 7320 7769  dded features wi
+000688e0: 7468 2065 6163 6820 7661 7269 6162 6c65  th each variable
+000688f0: 2061 7320 616e 2069 6e74 6567 6572 2076   as an integer v
+00068900: 6172 6961 626c 652e 0d0a 2020 2020 2222  ariable...    ""
+00068910: 220d 0a20 2020 2064 6620 3d20 636f 7079  "..    df = copy
+00068920: 2e64 6565 7063 6f70 7928 6466 290d 0a20  .deepcopy(df).. 
+00068930: 2020 2064 745f 6164 6473 203d 205b 5d0d     dt_adds = [].
+00068940: 0a20 2020 2074 7279 3a0d 0a20 2020 2020  .    try:..     
+00068950: 2020 2064 665b 7473 636f 6c2b 275f 686f     df[tscol+'_ho
+00068960: 7572 275d 203d 2064 665b 7473 636f 6c5d  ur'] = df[tscol]
+00068970: 2e64 742e 686f 7572 2e66 696c 6c6e 6128  .dt.hour.fillna(
+00068980: 3029 2e61 7374 7970 6528 696e 7429 0d0a  0).astype(int)..
+00068990: 2020 2020 2020 2020 6466 5b74 7363 6f6c          df[tscol
+000689a0: 2b27 5f6d 696e 7574 6527 5d20 3d20 6466  +'_minute'] = df
+000689b0: 5b74 7363 6f6c 5d2e 6474 2e6d 696e 7574  [tscol].dt.minut
+000689c0: 652e 6669 6c6c 6e61 2830 292e 6173 7479  e.fillna(0).asty
+000689d0: 7065 2869 6e74 290d 0a20 2020 2020 2020  pe(int)..       
+000689e0: 2064 745f 6164 6473 2e61 7070 656e 6428   dt_adds.append(
+000689f0: 7473 636f 6c2b 275f 686f 7572 2729 0d0a  tscol+'_hour')..
+00068a00: 2020 2020 2020 2020 6474 5f61 6464 732e          dt_adds.
+00068a10: 6170 7065 6e64 2874 7363 6f6c 2b27 5f6d  append(tscol+'_m
+00068a20: 696e 7574 6527 290d 0a20 2020 2065 7863  inute')..    exc
+00068a30: 6570 743a 0d0a 2020 2020 2020 2020 7072  ept:..        pr
+00068a40: 696e 7428 2720 2020 2045 7272 6f72 2069  int('    Error i
+00068a50: 6e20 6372 6561 7469 6e67 2068 6f75 722d  n creating hour-
+00068a60: 7365 636f 6e64 2064 6572 6976 6564 2066  second derived f
+00068a70: 6561 7475 7265 732e 2043 6f6e 7469 6e75  eatures. Continu
+00068a80: 696e 672e 2e2e 2729 0d0a 2020 2020 7472  ing...')..    tr
+00068a90: 793a 0d0a 2020 2020 2020 2020 6466 5b74  y:..        df[t
+00068aa0: 7363 6f6c 2b27 5f64 6179 6f66 7765 656b  scol+'_dayofweek
+00068ab0: 275d 203d 2064 665b 7473 636f 6c5d 2e64  '] = df[tscol].d
+00068ac0: 742e 6461 796f 6677 6565 6b2e 6669 6c6c  t.dayofweek.fill
+00068ad0: 6e61 2830 292e 6173 7479 7065 2869 6e74  na(0).astype(int
+00068ae0: 290d 0a20 2020 2020 2020 2064 745f 6164  )..        dt_ad
+00068af0: 6473 2e61 7070 656e 6428 7473 636f 6c2b  ds.append(tscol+
+00068b00: 275f 6461 796f 6677 6565 6b27 290d 0a20  '_dayofweek').. 
+00068b10: 2020 2020 2020 2069 6620 7473 636f 6c2b         if tscol+
+00068b20: 275f 686f 7572 2720 696e 2064 745f 6164  '_hour' in dt_ad
+00068b30: 6473 3a0d 0a20 2020 2020 2020 2020 2020  ds:..           
+00068b40: 2044 4159 5320 3d20 6469 6374 287a 6970   DAYS = dict(zip
+00068b50: 2872 616e 6765 2837 292c 5b27 5375 6e27  (range(7),['Sun'
+00068b60: 2c20 274d 6f6e 272c 2027 5475 6527 2c20  , 'Mon', 'Tue', 
+00068b70: 2757 6564 272c 2027 5468 7527 2c20 2746  'Wed', 'Thu', 'F
+00068b80: 7269 272c 2027 5361 7427 5d29 290d 0a20  ri', 'Sat'])).. 
+00068b90: 2020 2020 2020 2020 2020 2064 665b 7473             df[ts
+00068ba0: 636f 6c2b 275f 6461 796f 6677 6565 6b27  col+'_dayofweek'
+00068bb0: 5d20 3d20 6466 5b74 7363 6f6c 2b27 5f64  ] = df[tscol+'_d
+00068bc0: 6179 6f66 7765 656b 275d 2e6d 6170 2844  ayofweek'].map(D
+00068bd0: 4159 5329 0d0a 2020 2020 2020 2020 2020  AYS)..          
+00068be0: 2020 6466 2e6c 6f63 5b3a 2c74 7363 6f6c    df.loc[:,tscol
+00068bf0: 2b27 5f64 6179 6f66 7765 656b 5f68 6f75  +'_dayofweek_hou
+00068c00: 725f 6372 6f73 7327 5d20 3d20 6466 5b74  r_cross'] = df[t
+00068c10: 7363 6f6c 2b27 5f64 6179 6f66 7765 656b  scol+'_dayofweek
+00068c20: 275d 202b 2220 222b 2064 665b 7473 636f  '] +" "+ df[tsco
+00068c30: 6c2b 275f 686f 7572 275d 2e61 7374 7970  l+'_hour'].astyp
+00068c40: 6528 7374 7229 0d0a 2020 2020 2020 2020  e(str)..        
+00068c50: 2020 2020 6474 5f61 6464 732e 6170 7065      dt_adds.appe
+00068c60: 6e64 2874 7363 6f6c 2b27 5f64 6179 6f66  nd(tscol+'_dayof
+00068c70: 7765 656b 5f68 6f75 725f 6372 6f73 7327  week_hour_cross'
+00068c80: 290d 0a20 2020 2020 2020 2064 665b 7473  )..        df[ts
+00068c90: 636f 6c2b 275f 7175 6172 7465 7227 5d20  col+'_quarter'] 
+00068ca0: 3d20 6466 5b74 7363 6f6c 5d2e 6474 2e71  = df[tscol].dt.q
+00068cb0: 7561 7274 6572 2e66 696c 6c6e 6128 3029  uarter.fillna(0)
+00068cc0: 2e61 7374 7970 6528 696e 7429 0d0a 2020  .astype(int)..  
+00068cd0: 2020 2020 2020 6474 5f61 6464 732e 6170        dt_adds.ap
+00068ce0: 7065 6e64 2874 7363 6f6c 2b27 5f71 7561  pend(tscol+'_qua
+00068cf0: 7274 6572 2729 0d0a 2020 2020 2020 2020  rter')..        
+00068d00: 6466 5b74 7363 6f6c 2b27 5f6d 6f6e 7468  df[tscol+'_month
+00068d10: 275d 203d 2064 665b 7473 636f 6c5d 2e64  '] = df[tscol].d
+00068d20: 742e 6d6f 6e74 682e 6669 6c6c 6e61 2830  t.month.fillna(0
+00068d30: 292e 6173 7479 7065 2869 6e74 290d 0a20  ).astype(int).. 
+00068d40: 2020 2020 2020 204d 4f4e 5448 5320 3d20         MONTHS = 
+00068d50: 6469 6374 287a 6970 2872 616e 6765 2831  dict(zip(range(1
+00068d60: 2c31 3329 2c5b 274a 616e 272c 2027 4665  ,13),['Jan', 'Fe
+00068d70: 6227 2c20 274d 6172 272c 2027 4170 7227  b', 'Mar', 'Apr'
+00068d80: 2c20 274d 6179 272c 2027 4a75 6e27 2c20  , 'May', 'Jun', 
+00068d90: 274a 756c 272c 0d0a 2020 2020 2020 2020  'Jul',..        
+00068da0: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00068db0: 2020 2020 2020 2020 2020 2020 2741 7567              'Aug
+00068dc0: 272c 2027 5365 7027 2c20 274f 6374 272c  ', 'Sep', 'Oct',
+00068dd0: 2027 4e6f 7627 2c20 2744 6563 275d 2929   'Nov', 'Dec']))
+00068de0: 0d0a 2020 2020 2020 2020 6466 5b74 7363  ..        df[tsc
+00068df0: 6f6c 2b27 5f6d 6f6e 7468 275d 203d 2064  ol+'_month'] = d
+00068e00: 665b 7473 636f 6c2b 275f 6d6f 6e74 6827  f[tscol+'_month'
+00068e10: 5d2e 6d61 7028 4d4f 4e54 4853 290d 0a20  ].map(MONTHS).. 
+00068e20: 2020 2020 2020 2064 745f 6164 6473 2e61         dt_adds.a
+00068e30: 7070 656e 6428 7473 636f 6c2b 275f 6d6f  ppend(tscol+'_mo
+00068e40: 6e74 6827 290d 0a20 2020 2020 2020 2023  nth')..        #
+00068e50: 2323 2320 4164 6420 736f 6d65 2066 6561  ### Add some fea
+00068e60: 7475 7265 7320 666f 7220 6d6f 6e74 6873  tures for months
+00068e70: 2023 2323 2323 2323 2323 2323 2323 2323   ###############
+00068e80: 2323 2323 2323 2323 2323 2323 2323 2323  ################
+00068e90: 2323 2323 2323 2323 230d 0a20 2020 2020  #########..     
+00068ea0: 2020 2066 6573 7469 7665 7320 3d20 5b27     festives = ['
+00068eb0: 4f63 7427 2c27 4e6f 7627 2c27 4465 6327  Oct','Nov','Dec'
+00068ec0: 5d0d 0a20 2020 2020 2020 206e 616d 655f  ]..        name_
+00068ed0: 636f 6c20 3d20 7473 636f 6c2b 225f 6973  col = tscol+"_is
+00068ee0: 5f66 6573 7469 7665 220d 0a20 2020 2020  _festive"..     
+00068ef0: 2020 2064 665b 6e61 6d65 5f63 6f6c 5d20     df[name_col] 
+00068f00: 3d20 300d 0a20 2020 2020 2020 2064 665b  = 0..        df[
+00068f10: 6e61 6d65 5f63 6f6c 5d20 3d20 6466 5b74  name_col] = df[t
+00068f20: 7363 6f6c 2b27 5f6d 6f6e 7468 275d 2e6d  scol+'_month'].m
+00068f30: 6170 286c 616d 6264 6120 783a 2031 2069  ap(lambda x: 1 i
+00068f40: 6620 7820 696e 2066 6573 7469 7665 7320  f x in festives 
+00068f50: 656c 7365 2030 292e 7661 6c75 6573 0d0a  else 0).values..
+00068f60: 2020 2020 2020 2020 2323 2320 5265 6d65          ### Reme
+00068f70: 6d62 6572 2074 6861 7420 6669 6c6c 6e61  mber that fillna
+00068f80: 206f 6e6c 7920 776f 726b 7320 6174 2064   only works at d
+00068f90: 6174 6166 7261 6d65 206c 6576 656c 2120  ataframe level! 
+00068fa0: 2323 230d 0a20 2020 2020 2020 2064 665b  ###..        df[
+00068fb0: 5b6e 616d 655f 636f 6c5d 5d20 3d20 6466  [name_col]] = df
+00068fc0: 5b5b 6e61 6d65 5f63 6f6c 5d5d 2e66 696c  [[name_col]].fil
+00068fd0: 6c6e 6128 3029 0d0a 2020 2020 2020 2020  lna(0)..        
+00068fe0: 6474 5f61 6464 732e 6170 7065 6e64 286e  dt_adds.append(n
+00068ff0: 616d 655f 636f 6c29 0d0a 2020 2020 2020  ame_col)..      
+00069000: 2020 7375 6d6d 6572 203d 205b 274a 756e    summer = ['Jun
+00069010: 272c 274a 756c 272c 2741 7567 275d 0d0a  ','Jul','Aug']..
+00069020: 2020 2020 2020 2020 6e61 6d65 5f63 6f6c          name_col
+00069030: 203d 2074 7363 6f6c 2b22 5f69 735f 7375   = tscol+"_is_su
+00069040: 6d6d 6572 220d 0a20 2020 2020 2020 2064  mmer"..        d
+00069050: 665b 6e61 6d65 5f63 6f6c 5d20 3d20 300d  f[name_col] = 0.
+00069060: 0a20 2020 2020 2020 2064 665b 6e61 6d65  .        df[name
+00069070: 5f63 6f6c 5d20 3d20 6466 5b74 7363 6f6c  _col] = df[tscol
+00069080: 2b27 5f6d 6f6e 7468 275d 2e6d 6170 286c  +'_month'].map(l
+00069090: 616d 6264 6120 783a 2031 2069 6620 7820  ambda x: 1 if x 
+000690a0: 696e 2073 756d 6d65 7220 656c 7365 2030  in summer else 0
+000690b0: 292e 7661 6c75 6573 0d0a 2020 2020 2020  ).values..      
+000690c0: 2020 2323 2320 5265 6d65 6d62 6572 2074    ### Remember t
+000690d0: 6861 7420 6669 6c6c 6e61 206f 6e6c 7920  hat fillna only 
+000690e0: 776f 726b 7320 6174 2064 6174 6166 7261  works at datafra
+000690f0: 6d65 206c 6576 656c 2120 2323 230d 0a20  me level! ###.. 
+00069100: 2020 2020 2020 2064 665b 5b6e 616d 655f         df[[name_
+00069110: 636f 6c5d 5d20 3d20 6466 5b5b 6e61 6d65  col]] = df[[name
+00069120: 5f63 6f6c 5d5d 2e66 696c 6c6e 6128 3029  _col]].fillna(0)
+00069130: 0d0a 2020 2020 2020 2020 6474 5f61 6464  ..        dt_add
+00069140: 732e 6170 7065 6e64 286e 616d 655f 636f  s.append(name_co
+00069150: 6c29 0d0a 2020 2020 2020 2020 7769 6e74  l)..        wint
+00069160: 6572 203d 205b 2744 6563 272c 274a 616e  er = ['Dec','Jan
+00069170: 272c 2746 6562 275d 0d0a 2020 2020 2020  ','Feb']..      
+00069180: 2020 6e61 6d65 5f63 6f6c 203d 2074 7363    name_col = tsc
+00069190: 6f6c 2b22 5f69 735f 7769 6e74 6572 220d  ol+"_is_winter".
+000691a0: 0a20 2020 2020 2020 2064 665b 6e61 6d65  .        df[name
+000691b0: 5f63 6f6c 5d20 3d20 300d 0a20 2020 2020  _col] = 0..     
+000691c0: 2020 2064 665b 6e61 6d65 5f63 6f6c 5d20     df[name_col] 
+000691d0: 3d20 6466 5b74 7363 6f6c 2b27 5f6d 6f6e  = df[tscol+'_mon
+000691e0: 7468 275d 2e6d 6170 286c 616d 6264 6120  th'].map(lambda 
+000691f0: 783a 2031 2069 6620 7820 696e 2077 696e  x: 1 if x in win
+00069200: 7465 7220 656c 7365 2030 292e 7661 6c75  ter else 0).valu
+00069210: 6573 0d0a 2020 2020 2020 2020 2323 2320  es..        ### 
+00069220: 5265 6d65 6d62 6572 2074 6861 7420 6669  Remember that fi
+00069230: 6c6c 6e61 206f 6e6c 7920 776f 726b 7320  llna only works 
+00069240: 6174 2064 6174 6166 7261 6d65 206c 6576  at dataframe lev
+00069250: 656c 2120 2323 230d 0a20 2020 2020 2020  el! ###..       
+00069260: 2064 665b 5b6e 616d 655f 636f 6c5d 5d20   df[[name_col]] 
+00069270: 3d20 6466 5b5b 6e61 6d65 5f63 6f6c 5d5d  = df[[name_col]]
+00069280: 2e66 696c 6c6e 6128 3029 0d0a 2020 2020  .fillna(0)..    
+00069290: 2020 2020 6474 5f61 6464 732e 6170 7065      dt_adds.appe
+000692a0: 6e64 286e 616d 655f 636f 6c29 0d0a 2020  nd(name_col)..  
+000692b0: 2020 2020 2020 636f 6c64 203d 205b 274f        cold = ['O
+000692c0: 6374 272c 274e 6f76 272c 2744 6563 272c  ct','Nov','Dec',
+000692d0: 274a 616e 272c 2746 6562 272c 274d 6172  'Jan','Feb','Mar
+000692e0: 275d 0d0a 2020 2020 2020 2020 6e61 6d65  ']..        name
+000692f0: 5f63 6f6c 203d 2074 7363 6f6c 2b22 5f69  _col = tscol+"_i
+00069300: 735f 636f 6c64 220d 0a20 2020 2020 2020  s_cold"..       
+00069310: 2064 665b 6e61 6d65 5f63 6f6c 5d20 3d20   df[name_col] = 
+00069320: 300d 0a20 2020 2020 2020 2064 665b 6e61  0..        df[na
+00069330: 6d65 5f63 6f6c 5d20 3d20 6466 5b74 7363  me_col] = df[tsc
+00069340: 6f6c 2b27 5f6d 6f6e 7468 275d 2e6d 6170  ol+'_month'].map
+00069350: 286c 616d 6264 6120 783a 2031 2069 6620  (lambda x: 1 if 
+00069360: 7820 696e 2063 6f6c 6420 656c 7365 2030  x in cold else 0
+00069370: 292e 7661 6c75 6573 0d0a 2020 2020 2020  ).values..      
+00069380: 2020 2323 2320 5265 6d65 6d62 6572 2074    ### Remember t
+00069390: 6861 7420 6669 6c6c 6e61 206f 6e6c 7920  hat fillna only 
+000693a0: 776f 726b 7320 6174 2064 6174 6166 7261  works at datafra
+000693b0: 6d65 206c 6576 656c 2120 2323 230d 0a20  me level! ###.. 
+000693c0: 2020 2020 2020 2064 665b 5b6e 616d 655f         df[[name_
+000693d0: 636f 6c5d 5d20 3d20 6466 5b5b 6e61 6d65  col]] = df[[name
+000693e0: 5f63 6f6c 5d5d 2e66 696c 6c6e 6128 3029  _col]].fillna(0)
+000693f0: 0d0a 2020 2020 2020 2020 6474 5f61 6464  ..        dt_add
+00069400: 732e 6170 7065 6e64 286e 616d 655f 636f  s.append(name_co
+00069410: 6c29 0d0a 2020 2020 2020 2020 7761 726d  l)..        warm
+00069420: 203d 205b 2741 7072 272c 274d 6179 272c   = ['Apr','May',
+00069430: 274a 756e 272c 274a 756c 272c 2741 7567  'Jun','Jul','Aug
+00069440: 272c 2753 6570 275d 0d0a 2020 2020 2020  ','Sep']..      
+00069450: 2020 6e61 6d65 5f63 6f6c 203d 2074 7363    name_col = tsc
+00069460: 6f6c 2b22 5f69 735f 7761 726d 220d 0a20  ol+"_is_warm".. 
+00069470: 2020 2020 2020 2064 665b 6e61 6d65 5f63         df[name_c
+00069480: 6f6c 5d20 3d20 300d 0a20 2020 2020 2020  ol] = 0..       
+00069490: 2064 665b 6e61 6d65 5f63 6f6c 5d20 3d20   df[name_col] = 
+000694a0: 6466 5b74 7363 6f6c 2b27 5f6d 6f6e 7468  df[tscol+'_month
+000694b0: 275d 2e6d 6170 286c 616d 6264 6120 783a  '].map(lambda x:
+000694c0: 2031 2069 6620 7820 696e 2077 6172 6d20   1 if x in warm 
+000694d0: 656c 7365 2030 292e 7661 6c75 6573 0d0a  else 0).values..
+000694e0: 2020 2020 2020 2020 6466 5b5b 6e61 6d65          df[[name
+000694f0: 5f63 6f6c 5d5d 203d 2064 665b 5b6e 616d  _col]] = df[[nam
+00069500: 655f 636f 6c5d 5d2e 6669 6c6c 6e61 2830  e_col]].fillna(0
+00069510: 290d 0a20 2020 2020 2020 2064 745f 6164  )..        dt_ad
+00069520: 6473 2e61 7070 656e 6428 6e61 6d65 5f63  ds.append(name_c
+00069530: 6f6c 290d 0a20 2020 2020 2020 2023 2323  ol)..        ###
 00069540: 2323 2323 2323 2323 2323 2323 2323 2323  ################
 00069550: 2323 2323 2323 2323 2323 2323 2323 2323  ################
-00069560: 2323 2323 230d 0a64 6566 2063 7265 6174  #####..def creat
-00069570: 655f 7469 6d65 5f73 6572 6965 735f 6665  e_time_series_fe
-00069580: 6174 7572 6573 2864 7466 2c20 7473 5f63  atures(dtf, ts_c
-00069590: 6f6c 756d 6e29 3a0d 0a20 2020 2022 2222  olumn):..    """
-000695a0: 0d0a 2020 2020 5468 6973 2063 7265 6174  ..    This creat
-000695b0: 6573 2062 6574 7765 656e 2038 2061 6e64  es between 8 and
-000695c0: 2031 3020 6461 7465 2074 696d 6520 6665   10 date time fe
-000695d0: 6174 7572 6573 2066 6f72 2065 6163 6820  atures for each 
-000695e0: 6461 7465 2076 6172 6961 626c 652e 2054  date variable. T
-000695f0: 6865 206e 756d 6265 7220 6f66 2066 6561  he number of fea
-00069600: 7475 7265 730d 0a20 2020 2064 6570 656e  tures..    depen
-00069610: 6473 206f 6e20 7768 6574 6865 7220 6974  ds on whether it
-00069620: 2069 7320 6a75 7374 2061 2079 6561 7220   is just a year 
-00069630: 7661 7269 6162 6c65 206f 7220 6120 7965  variable or a ye
-00069640: 6172 2b6d 6f6e 7468 2b64 6179 2061 6e64  ar+month+day and
-00069650: 2077 6865 7468 6572 2069 7420 6861 7320   whether it has 
-00069660: 686f 7572 7320 616e 6420 6d69 6e73 2b73  hours and mins+s
-00069670: 6563 732e 0d0a 2020 2020 536f 2074 6869  ecs...    So thi
-00069680: 7320 6361 6e20 6372 6561 7465 2061 6c6c  s can create all
-00069690: 2074 6865 7365 2066 6561 7475 7265 7320   these features 
-000696a0: 7573 696e 6720 6a75 7374 2074 6865 2064  using just the d
-000696b0: 6174 6520 7469 6d65 2063 6f6c 756d 6e20  ate time column 
-000696c0: 7468 6174 2079 6f75 2073 656e 6420 696e  that you send in
-000696d0: 2e0d 0a20 2020 2049 7420 7265 7475 726e  ...    It return
-000696e0: 7320 7468 6520 656e 7469 7265 2064 6174  s the entire dat
-000696f0: 6166 7261 6d65 2077 6974 6820 6164 6465  aframe with adde
-00069700: 6420 7661 7269 6162 6c65 7320 6173 206f  d variables as o
-00069710: 7574 7075 742e 0d0a 2020 2020 2222 220d  utput...    """.
-00069720: 0a20 2020 2064 7466 203d 2063 6f70 792e  .    dtf = copy.
-00069730: 6465 6570 636f 7079 2864 7466 290d 0a20  deepcopy(dtf).. 
-00069740: 2020 2023 2323 2320 4966 2066 6f72 2073     #### If for s
-00069750: 6f6d 6520 7265 6173 6f6e 2074 735f 636f  ome reason ts_co
-00069760: 6c75 6d6e 2069 7320 6a75 7374 2061 206e  lumn is just a n
-00069770: 756d 6265 722c 206d 616b 6520 7375 7265  umber, make sure
-00069780: 2069 7420 6973 2061 2073 7472 696e 6720   it is a string 
-00069790: 736f 2069 7420 646f 6573 206e 6f74 2062  so it does not b
-000697a0: 6c6f 7720 7570 2061 6e64 2063 6f6e 6361  low up and conca
-000697b0: 7465 6e61 7465 640d 0a20 2020 2069 6620  tenated..    if 
-000697c0: 6e6f 7420 6973 696e 7374 616e 6365 2874  not isinstance(t
-000697d0: 735f 636f 6c75 6d6e 2c73 7472 293a 0d0a  s_column,str):..
-000697e0: 2020 2020 2020 2020 7473 5f63 6f6c 756d          ts_colum
-000697f0: 6e20 3d20 7374 7228 7473 5f63 6f6c 756d  n = str(ts_colum
-00069800: 6e29 0d0a 2020 2020 7472 793a 0d0a 2020  n)..    try:..  
-00069810: 2020 2020 2020 2323 2320 496e 2073 6f6d        ### In som
-00069820: 6520 6578 7472 656d 6520 6361 7365 732c  e extreme cases,
-00069830: 2064 6174 6520 7469 6d65 2076 6172 7320   date time vars 
-00069840: 6172 6520 6e6f 7420 7072 6f63 6573 7365  are not processe
-00069850: 6420 7965 7420 616e 6420 6865 6e63 6520  d yet and hence 
-00069860: 7765 206d 7573 7420 6669 6c6c 206d 6973  we must fill mis
-00069870: 7369 6e67 2076 616c 7565 7320 6865 7265  sing values here
-00069880: 210d 0a20 2020 2020 2020 2069 6620 6474  !..        if dt
-00069890: 665b 7473 5f63 6f6c 756d 6e5d 2e69 736e  f[ts_column].isn
-000698a0: 756c 6c28 292e 7375 6d28 2920 3e20 303a  ull().sum() > 0:
-000698b0: 0d0a 2020 2020 2020 2020 2020 2020 6d69  ..            mi
-000698c0: 7373 696e 675f 666c 6167 203d 2054 7275  ssing_flag = Tru
-000698d0: 650d 0a20 2020 2020 2020 2020 2020 206e  e..            n
-000698e0: 6577 5f6d 6973 7369 6e67 5f63 6f6c 203d  ew_missing_col =
-000698f0: 2074 735f 636f 6c75 6d6e 202b 2027 5f4d   ts_column + '_M
-00069900: 6973 7369 6e67 5f46 6c61 6727 0d0a 2020  issing_Flag'..  
-00069910: 2020 2020 2020 2020 2020 6474 665b 6e65            dtf[ne
-00069920: 775f 6d69 7373 696e 675f 636f 6c5d 203d  w_missing_col] =
-00069930: 2030 0d0a 2020 2020 2020 2020 2020 2020   0..            
-00069940: 6474 662e 6c6f 635b 6474 665b 7473 5f63  dtf.loc[dtf[ts_c
-00069950: 6f6c 756d 6e5d 2e69 736e 756c 6c28 292c  olumn].isnull(),
-00069960: 6e65 775f 6d69 7373 696e 675f 636f 6c5d  new_missing_col]
-00069970: 3d31 0d0a 2020 2020 2020 2020 2020 2020  =1..            
-00069980: 2323 2320 5265 6d65 6d62 6572 2074 6861  ### Remember tha
-00069990: 7420 6669 6c6c 6e61 206f 6e6c 7920 776f  t fillna only wo
-000699a0: 726b 7320 6174 2074 6865 2064 6174 6166  rks at the dataf
-000699b0: 7261 6d65 206c 6576 656c 210d 0a20 2020  rame level!..   
-000699c0: 2020 2020 2020 2020 2064 7466 5b5b 7473           dtf[[ts
-000699d0: 5f63 6f6c 756d 6e5d 5d20 3d20 6474 665b  _column]] = dtf[
-000699e0: 5b74 735f 636f 6c75 6d6e 5d5d 2e66 696c  [ts_column]].fil
-000699f0: 6c6e 6128 6d65 7468 6f64 3d27 6666 696c  lna(method='ffil
-00069a00: 6c27 290d 0a20 2020 2020 2020 2069 6620  l')..        if 
-00069a10: 6474 665b 7473 5f63 6f6c 756d 6e5d 2e64  dtf[ts_column].d
-00069a20: 7479 7065 2069 6e20 5b6e 702e 666c 6f61  type in [np.floa
-00069a30: 7436 342c 6e70 2e66 6c6f 6174 3332 2c6e  t64,np.float32,n
-00069a40: 702e 666c 6f61 7431 365d 3a0d 0a20 2020  p.float16]:..   
-00069a50: 2020 2020 2020 2020 2064 7466 5b74 735f           dtf[ts_
-00069a60: 636f 6c75 6d6e 5d20 3d20 6474 665b 7473  column] = dtf[ts
-00069a70: 5f63 6f6c 756d 6e5d 2e61 7374 7970 6528  _column].astype(
-00069a80: 696e 7429 0d0a 2020 2020 2020 2020 2323  int)..        ##
-00069a90: 2320 6966 2077 6520 6861 7665 2061 6c72  # if we have alr
-00069aa0: 6561 6479 2066 6f75 6e64 2074 6861 7420  eady found that 
-00069ab0: 6974 2077 6173 2061 2064 6174 6520 7469  it was a date ti
-00069ac0: 6d65 2076 6172 2c20 7468 656e 206c 6561  me var, then lea
-00069ad0: 7665 2069 7420 6173 2069 7420 6973 2e20  ve it as it is. 
-00069ae0: 5468 6174 7320 676f 6f64 2065 6e6f 7567  Thats good enoug
-00069af0: 6821 0d0a 2020 2020 2020 2020 6461 7465  h!..        date
-00069b00: 5f69 7465 6d73 203d 2064 7466 5b74 735f  _items = dtf[ts_
-00069b10: 636f 6c75 6d6e 5d2e 6170 706c 7928 7374  column].apply(st
-00069b20: 7229 2e61 7070 6c79 286c 656e 292e 7661  r).apply(len).va
-00069b30: 6c75 6573 0d0a 2020 2020 2020 2020 2323  lues..        ##
-00069b40: 2323 2049 6e20 736f 6d65 2065 7874 7265  ## In some extre
-00069b50: 6d65 2063 6173 6573 2c0d 0a20 2020 2020  me cases,..     
-00069b60: 2020 2069 6620 616c 6c28 6461 7465 5f69     if all(date_i
-00069b70: 7465 6d73 5b30 5d20 3d3d 2069 7465 6d20  tems[0] == item 
-00069b80: 666f 7220 6974 656d 2069 6e20 6461 7465  for item in date
-00069b90: 5f69 7465 6d73 293a 0d0a 2020 2020 2020  _items):..      
-00069ba0: 2020 2020 2020 6966 2064 6174 655f 6974        if date_it
-00069bb0: 656d 735b 305d 203d 3d20 343a 0d0a 2020  ems[0] == 4:..  
-00069bc0: 2020 2020 2020 2020 2020 2020 2020 2323                ##
-00069bd0: 2320 4966 2069 7420 6973 206a 7573 7420  # If it is just 
-00069be0: 6120 7965 6172 2076 6172 6961 626c 6520  a year variable 
-00069bf0: 616c 6f6e 652c 2079 6f75 2073 686f 756c  alone, you shoul
-00069c00: 6420 6c65 6176 6520 6974 2061 7320 6a75  d leave it as ju
-00069c10: 7374 2061 2079 6561 7221 0d0a 2020 2020  st a year!..    
-00069c20: 2020 2020 2020 2020 2020 2020 6167 655f              age_
-00069c30: 636f 6c20 3d20 7473 5f63 6f6c 756d 6e2b  col = ts_column+
-00069c40: 275f 6167 655f 696e 5f79 6561 7273 270d  '_age_in_years'.
-00069c50: 0a20 2020 2020 2020 2020 2020 2020 2020  .               
-00069c60: 2064 7466 5b61 6765 5f63 6f6c 5d20 3d20   dtf[age_col] = 
-00069c70: 6474 665b 7473 5f63 6f6c 756d 6e5d 2e6d  dtf[ts_column].m
-00069c80: 6170 286c 616d 6264 6120 783a 2070 642e  ap(lambda x: pd.
-00069c90: 746f 5f64 6174 6574 696d 6528 782c 666f  to_datetime(x,fo
-00069ca0: 726d 6174 3d27 2559 2729 292e 6170 706c  rmat='%Y')).appl
-00069cb0: 7928 636f 6d70 7574 655f 6167 6529 2e76  y(compute_age).v
-00069cc0: 616c 7565 730d 0a20 2020 2020 2020 2020  alues..         
-00069cd0: 2020 2020 2020 2072 6574 7572 6e20 6474         return dt
-00069ce0: 665b 5b74 735f 636f 6c75 6d6e 2c61 6765  f[[ts_column,age
-00069cf0: 5f63 6f6c 5d5d 0d0a 2020 2020 2020 2020  _col]]..        
-00069d00: 2020 2020 656c 7365 3a0d 0a20 2020 2020      else:..     
-00069d10: 2020 2020 2020 2020 2020 2023 2323 2069             ### i
-00069d20: 6620 6974 2069 7320 6e6f 7420 6120 7965  f it is not a ye
-00069d30: 6172 2061 6c6f 6e65 2c20 7468 656e 2063  ar alone, then c
-00069d40: 6f6e 7665 7274 2069 7420 696e 746f 2061  onvert it into a
-00069d50: 2064 6174 6520 7469 6d65 2076 6172 6961   date time varia
-00069d60: 626c 650d 0a20 2020 2020 2020 2020 2020  ble..           
-00069d70: 2020 2020 2064 7466 5b74 735f 636f 6c75       dtf[ts_colu
-00069d80: 6d6e 5d20 3d20 7064 2e74 6f5f 6461 7465  mn] = pd.to_date
-00069d90: 7469 6d65 2864 7466 5b74 735f 636f 6c75  time(dtf[ts_colu
-00069da0: 6d6e 5d2c 2069 6e66 6572 5f64 6174 6574  mn], infer_datet
-00069db0: 696d 655f 666f 726d 6174 3d54 7275 6529  ime_format=True)
-00069dc0: 0d0a 2020 2020 2020 2020 656c 7365 3a0d  ..        else:.
-00069dd0: 0a20 2020 2020 2020 2020 2020 2064 7466  .            dtf
-00069de0: 5b74 735f 636f 6c75 6d6e 5d20 3d20 7064  [ts_column] = pd
-00069df0: 2e74 6f5f 6461 7465 7469 6d65 2864 7466  .to_datetime(dtf
-00069e00: 5b74 735f 636f 6c75 6d6e 5d2c 2069 6e66  [ts_column], inf
-00069e10: 6572 5f64 6174 6574 696d 655f 666f 726d  er_datetime_form
-00069e20: 6174 3d54 7275 6529 0d0a 2020 2020 2020  at=True)..      
-00069e30: 2020 6474 6620 3d20 6372 6561 7465 5f74    dtf = create_t
-00069e40: 735f 6665 6174 7572 6573 2864 7466 2c74  s_features(dtf,t
-00069e50: 735f 636f 6c75 6d6e 290d 0a20 2020 2065  s_column)..    e
-00069e60: 7863 6570 743a 0d0a 2020 2020 2020 2020  xcept:..        
-00069e70: 7072 696e 7428 2745 7272 6f72 2069 6e20  print('Error in 
-00069e80: 5072 6f63 6573 7369 6e67 2025 7320 636f  Processing %s co
-00069e90: 6c75 6d6e 2066 6f72 2064 6174 6520 7469  lumn for date ti
-00069ea0: 6d65 2066 6561 7475 7265 732e 2043 6f6e  me features. Con
-00069eb0: 7469 6e75 696e 672e 2e2e 2720 2574 735f  tinuing...' %ts_
-00069ec0: 636f 6c75 6d6e 290d 0a20 2020 2072 6574  column)..    ret
-00069ed0: 7572 6e20 6474 660d 0a23 2323 2323 2323  urn dtf..#######
-00069ee0: 2323 2323 2323 2323 2323 2323 2323 2323  ################
-00069ef0: 2323 2323 2323 2323 2323 2323 2323 2323  ################
-00069f00: 230d 0a66 726f 6d20 636f 6c6c 6563 7469  #..from collecti
-00069f10: 6f6e 7320 696d 706f 7274 2043 6f75 6e74  ons import Count
-00069f20: 6572 0d0a 696d 706f 7274 2074 696d 650d  er..import time.
-00069f30: 0a23 2323 2323 2323 2323 2323 2323 2323  .###############
-00069f40: 2323 2323 2323 2323 2323 2323 2323 2323  ################
-00069f50: 2323 2323 2323 2323 230d 0a69 6d70 6f72  #########..impor
-00069f60: 7420 7761 726e 696e 6773 0d0a 7761 726e  t warnings..warn
-00069f70: 696e 6773 2e66 696c 7465 7277 6172 6e69  ings.filterwarni
-00069f80: 6e67 7328 2269 676e 6f72 6522 290d 0a66  ngs("ignore")..f
-00069f90: 726f 6d20 736b 6c65 6172 6e2e 6578 6365  rom sklearn.exce
-00069fa0: 7074 696f 6e73 2069 6d70 6f72 7420 4461  ptions import Da
-00069fb0: 7461 436f 6e76 6572 7369 6f6e 5761 726e  taConversionWarn
-00069fc0: 696e 670d 0a77 6172 6e69 6e67 732e 6669  ing..warnings.fi
-00069fd0: 6c74 6572 7761 726e 696e 6773 2861 6374  lterwarnings(act
-00069fe0: 696f 6e3d 2769 676e 6f72 6527 2c20 6361  ion='ignore', ca
-00069ff0: 7465 676f 7279 3d44 6174 6143 6f6e 7665  tegory=DataConve
-0006a000: 7273 696f 6e57 6172 6e69 6e67 290d 0a23  rsionWarning)..#
-0006a010: 2323 2323 2323 2323 2323 2323 2323 2323  ################
-0006a020: 2323 2323 2323 2323 2323 2323 2323 2323  ################
-0006a030: 2323 2323 2323 2323 2323 2323 2323 2323  ################
-0006a040: 2323 2323 2323 2323 2323 2323 2323 2323  ################
-0006a050: 2323 2323 2323 2323 2323 2323 2323 2323  ################
-0006a060: 2323 230d 0a66 726f 6d20 736b 6c65 6172  ###..from sklear
-0006a070: 6e2e 7574 696c 732e 636c 6173 735f 7765  n.utils.class_we
-0006a080: 6967 6874 2069 6d70 6f72 7420 636f 6d70  ight import comp
-0006a090: 7574 655f 636c 6173 735f 7765 6967 6874  ute_class_weight
-0006a0a0: 0d0a 6672 6f6d 2069 6d62 6c65 6172 6e2e  ..from imblearn.
-0006a0b0: 6f76 6572 5f73 616d 706c 696e 6720 696d  over_sampling im
-0006a0c0: 706f 7274 2053 4d4f 5445 2c20 534d 4f54  port SMOTE, SMOT
-0006a0d0: 454e 430d 0a66 726f 6d20 636f 6c6c 6563  ENC..from collec
-0006a0e0: 7469 6f6e 7320 696d 706f 7274 2043 6f75  tions import Cou
-0006a0f0: 6e74 6572 0d0a 696d 706f 7274 2063 6f70  nter..import cop
-0006a100: 790d 0a69 6d70 6f72 7420 7064 620d 0a23  y..import pdb..#
-0006a110: 2323 2323 2323 2323 2323 2323 2323 2323  ################
-0006a120: 2323 2323 2323 2323 2323 2323 2323 2323  ################
-0006a130: 2323 2323 2323 2323 2323 2323 2323 2323  ################
-0006a140: 2323 2323 2323 2323 2323 2323 2323 2323  ################
-0006a150: 2323 2323 2323 2323 2323 2323 2323 2323  ################
-0006a160: 2323 2323 2323 0d0a 2323 2320 5265 6772  ######..### Regr
-0006a170: 6573 7369 6f6e 5f52 6573 616d 706c 6572  ession_Resampler
-0006a180: 2069 7320 6120 6e65 6174 206c 6962 7261   is a neat libra
-0006a190: 7279 2074 6861 7420 7265 7475 726e 7320  ry that returns 
-0006a1a0: 6120 6e75 6d70 7920 6c69 7374 206f 6620  a numpy list of 
-0006a1b0: 636c 6173 7365 7320 666f 7220 6561 6368  classes for each
-0006a1c0: 0d0a 2323 2320 2063 6f72 7265 7370 6f6e  ..###  correspon
-0006a1d0: 6469 6e67 2073 616d 706c 652e 2066 726f  ding sample. fro
-0006a1e0: 6d20 7461 7267 6574 2064 6174 612e 2049  m target data. I
-0006a1f0: 7420 656e 6162 6c65 7320 7265 6772 6573  t enables regres
-0006a200: 6973 6f6e 2070 726f 626c 656d 7320 746f  ison problems to
-0006a210: 2075 7365 2053 4d4f 5445 2e0d 0a23 2323   use SMOTE...###
-0006a220: 2020 4920 6861 7665 2075 7365 6420 6120    I have used a 
-0006a230: 7369 6d69 6c61 7220 636f 6e63 6570 7420  similar concept 
-0006a240: 6275 7420 696d 706c 656d 656e 7465 6420  but implemented 
-0006a250: 6974 206d 7920 7761 7920 7573 696e 6720  it my way using 
-0006a260: 4b2d 4d65 616e 7320 616c 676f 7269 7468  K-Means algorith
-0006a270: 6d2e 0d0a 2323 2320 204d 7920 7369 6e63  m...###  My sinc
-0006a280: 6572 6520 7468 616e 6b73 2074 6f20 7468  ere thanks to th
-0006a290: 6520 6372 6561 746f 7273 206f 6620 7468  e creators of th
-0006a2a0: 6520 6c69 6272 6172 793a 0d0a 2323 2320  e library:..### 
-0006a2b0: 2020 2020 6874 7470 733a 2f2f 6769 7468      https://gith
-0006a2c0: 7562 2e63 6f6d 2f61 7469 662d 6861 7373  ub.com/atif-hass
-0006a2d0: 616e 2f52 6567 7265 7373 696f 6e5f 5265  an/Regression_Re
-0006a2e0: 5361 6d70 6c69 6e67 2f0d 0a23 2323 2323  Sampling/..#####
-0006a2f0: 2323 2323 2323 2323 2323 2323 2323 2323  ################
-0006a300: 2323 2323 2323 2323 2323 2323 2323 2323  ################
-0006a310: 2323 2323 2323 2323 2323 2323 2323 2323  ################
-0006a320: 2323 2323 2323 2323 2323 2323 2323 2323  ################
-0006a330: 2323 2323 2323 2323 2323 2323 2323 2323  ################
-0006a340: 2323 0d0a 6465 6620 7472 6169 6e69 6e67  ##..def training
-0006a350: 5f77 6974 685f 534d 4f54 4528 585f 6466  _with_SMOTE(X_df
-0006a360: 2c79 5f64 662c 7461 7267 6574 2c65 7661  ,y_df,target,eva
-0006a370: 6c5f 7365 742c 6d6f 6465 6c5f 696e 7075  l_set,model_inpu
-0006a380: 742c 426f 6f73 7469 6e67 5f46 6c61 672c  t,Boosting_Flag,
-0006a390: 6576 616c 5f6d 6574 7269 632c 0d0a 2020  eval_metric,..  
-0006a3a0: 2020 2020 2020 2020 2020 2020 2020 2020                  
-0006a3b0: 2020 2020 2020 2020 2020 2020 2020 2020                  
-0006a3c0: 2020 2020 2020 6d6f 6465 6c74 7970 652c        modeltype,
-0006a3d0: 206d 6f64 656c 5f6e 616d 652c 0d0a 2020   model_name,..  
-0006a3e0: 2020 2020 2020 2020 2020 2020 2020 2020                  
-0006a3f0: 2020 2020 2020 2020 2020 2020 2020 2020                  
-0006a400: 2020 2074 7261 696e 696e 673d 5472 7565     training=True
-0006a410: 2c6d 696e 6f72 6974 795f 636c 6173 733d  ,minority_class=
-0006a420: 312c 696d 705f 6361 7473 3d5b 5d2c 0d0a  1,imp_cats=[],..
-0006a430: 2020 2020 2020 2020 2020 2020 2020 2020                  
-0006a440: 2020 2020 2020 2020 2020 2020 2020 2020                  
-0006a450: 2020 2020 2063 616c 6962 7261 746f 725f       calibrator_
-0006a460: 666c 6167 3d46 616c 7365 2c0d 0a20 2020  flag=False,..   
-0006a470: 2020 2020 2020 2020 2020 2020 2020 2020                  
-0006a480: 2020 2020 2020 2020 2020 2020 2020 2020                  
-0006a490: 2020 4750 555f 6578 6973 7473 3d46 616c    GPU_exists=Fal
-0006a4a0: 7365 2c20 7061 7261 6d73 3d7b 7d2c 0d0a  se, params={},..
-0006a4b0: 2020 2020 2020 2020 2020 2020 2020 2020                  
-0006a4c0: 2020 2020 2020 2020 2020 2020 2020 2020                  
-0006a4d0: 2020 2020 206d 6f64 656c 5f6c 6162 656c       model_label
-0006a4e0: 3d27 5369 6e67 6c65 5f4c 6162 656c 272c  ='Single_Label',
-0006a4f0: 2076 6572 626f 7365 3d30 293a 0d0a 2020   verbose=0):..  
-0006a500: 2020 2222 220d 0a20 2020 2023 2323 2323    """..    #####
-0006a510: 2323 2323 2020 2020 4f56 4552 5341 4d50  ####    OVERSAMP
-0006a520: 4c49 4e47 204f 4620 4d49 4e4f 5249 5459  LING OF MINORITY
-0006a530: 2043 4c41 5353 2041 4e44 2054 5241 494e   CLASS AND TRAIN
-0006a540: 494e 4720 2053 495a 4553 2020 2323 2323  ING  SIZES  ####
-0006a550: 2323 2323 2323 2323 2323 230d 0a20 2020  ###########..   
-0006a560: 2023 2323 2320 2053 4d4f 5445 2028 5379   ####  SMOTE (Sy
-0006a570: 6e74 6865 7469 6320 4d69 6e6f 7269 7479  nthetic Minority
-0006a580: 204f 7665 7273 616d 706c 696e 6720 5465   Oversampling Te
-0006a590: 6368 6e69 7175 6529 2077 6f72 6b73 2077  chnique) works w
-0006a5a0: 656c 6c20 7769 7468 2069 6d62 616c 616e  ell with imbalan
-0006a5b0: 6365 6420 636c 6173 7365 732e 0d0a 2020  ced classes...  
-0006a5c0: 2020 2323 2323 2020 5468 6973 2069 7320    ####  This is 
-0006a5d0: 6120 6772 6561 7420 7761 7920 746f 2074  a great way to t
-0006a5e0: 7261 696e 2061 206d 6f64 656c 2069 6e20  rain a model in 
-0006a5f0: 7375 6368 2063 6173 6573 2077 6974 6820  such cases with 
-0006a600: 7265 7065 6174 6564 2073 616d 706c 6573  repeated samples
-0006a610: 206f 6620 7261 7265 2d63 6c61 7373 0d0a   of rare-class..
-0006a620: 2020 2020 2323 2323 2020 616c 6f6e 6720      ####  along 
-0006a630: 7769 7468 2062 6174 6368 6573 206f 6620  with batches of 
-0006a640: 6d61 6a6f 7269 7479 2063 6c61 7373 2061  majority class a
-0006a650: 6e64 2067 6574 2074 6865 206d 6f64 656c  nd get the model
-0006a660: 2074 6f20 6469 6666 6572 656e 7469 6174   to differentiat
-0006a670: 6520 6265 7477 6565 6e20 3220 636c 6173  e between 2 clas
-0006a680: 7365 732e 0d0a 2020 2020 2323 2323 2020  ses...    ####  
-0006a690: 5468 6973 2063 616e 2061 6c73 6f20 6265  This can also be
-0006a6a0: 2075 7365 6420 666f 7220 5265 6772 6573   used for Regres
-0006a6b0: 7369 6f6e 2070 726f 626c 656d 7320 6279  sion problems by
-0006a6c0: 2075 7369 6e67 2074 6865 206e 756d 6572   using the numer
-0006a6d0: 6963 2074 6172 6765 7420 7661 6c75 6573  ic target values
-0006a6e0: 2063 6f6e 7665 7274 6564 0d0a 2020 2020   converted..    
-0006a6f0: 2323 2323 2020 746f 2063 6c75 7374 6572  ####  to cluster
-0006a700: 206c 6162 656c 7320 7573 696e 6720 4b4d   labels using KM
-0006a710: 6561 6e73 2e20 596f 7520 6361 6e20 7468  eans. You can th
-0006a720: 656e 2075 7365 2074 6865 2063 6c75 7374  en use the clust
-0006a730: 6572 206c 6162 656c 7320 746f 2061 6464  er labels to add
-0006a740: 206d 6f72 6520 7361 6d70 6c65 732e 0d0a   more samples...
-0006a750: 2020 2020 2323 2323 2323 2323 2320 2020      #########   
-0006a760: 204d 414b 4520 5355 5245 2059 4f55 2054   MAKE SURE YOU T
-0006a770: 554e 4520 5448 4520 4445 4641 554c 5453  UNE THE DEFAULTS
-0006a780: 2047 4956 454e 2048 4552 4521 2020 2323   GIVEN HERE!  ##
-0006a790: 2323 2323 2323 2323 2323 2323 230d 0a20  #############.. 
-0006a7a0: 2020 2022 2222 0d0a 2020 2020 585f 6466     """..    X_df
-0006a7b0: 203d 2063 6f70 792e 6465 6570 636f 7079   = copy.deepcopy
-0006a7c0: 2858 5f64 6629 0d0a 2020 2020 795f 6466  (X_df)..    y_df
-0006a7d0: 203d 2063 6f70 792e 6465 6570 636f 7079   = copy.deepcopy
-0006a7e0: 2879 5f64 6629 0d0a 2020 2020 6d6f 6465  (y_df)..    mode
-0006a7f0: 6c5f 636f 7079 203d 2063 6f70 792e 6465  l_copy = copy.de
-0006a800: 6570 636f 7079 286d 6f64 656c 5f69 6e70  epcopy(model_inp
-0006a810: 7574 290d 0a20 2020 206d 6f64 656c 203d  ut)..    model =
-0006a820: 2063 6f70 792e 6465 6570 636f 7079 286d   copy.deepcopy(m
-0006a830: 6f64 656c 5f63 6f70 7929 0d0a 2020 2020  odel_copy)..    
-0006a840: 7374 6172 745f 7469 6d65 203d 2074 696d  start_time = tim
-0006a850: 652e 7469 6d65 2829 0d0a 2020 2020 2323  e.time()..    ##
-0006a860: 2323 2320 4e6f 7720 7765 2077 696c 6c20  ### Now we will 
-0006a870: 7374 6172 7420 7573 696e 6720 5265 7361  start using Resa
-0006a880: 6d70 6c69 6e67 204c 6962 7261 7279 2074  mpling Library t
-0006a890: 6f20 6d61 6b65 2064 6174 6120 6d6f 7265  o make data more
-0006a8a0: 2062 616c 616e 6365 6420 2323 230d 0a20   balanced ###.. 
-0006a8b0: 2020 2069 6620 6d6f 6465 6c74 7970 6520     if modeltype 
-0006a8c0: 3d3d 2027 5265 6772 6573 7369 6f6e 273a  == 'Regression':
-0006a8d0: 0d0a 2020 2020 2020 2020 7072 696e 7428  ..        print(
-0006a8e0: 2255 7369 6e67 2052 6567 7265 7373 696f  "Using Regressio
-0006a8f0: 6e20 5265 7361 6d70 6c65 7220 6c69 6272  n Resampler libr
-0006a900: 6172 7920 746f 206d 616b 6520 736b 6577  ary to make skew
-0006a910: 6564 2074 6172 6765 7420 7661 7269 6162  ed target variab
-0006a920: 6c65 206d 6f72 6520 6261 6c61 6e63 6564  le more balanced
-0006a930: 2e2e 2e22 290d 0a20 2020 2065 6c73 653a  ...")..    else:
-0006a940: 0d0a 2020 2020 2020 2020 2370 7269 6e74  ..        #print
-0006a950: 2822 5573 696e 6720 534d 4f54 4527 7320  ("Using SMOTE's 
-0006a960: 6f76 6572 2d73 616d 706c 696e 6720 7465  over-sampling te
-0006a970: 6368 6e69 7175 6573 2074 6f20 6d61 6b65  chniques to make
-0006a980: 2074 6865 2025 6420 636c 6173 7365 7320   the %d classes 
-0006a990: 6261 6c61 6e63 6564 2e2e 2e22 2025 6c65  balanced..." %le
-0006a9a0: 6e28 6e70 2e75 6e69 7175 6528 795f 6466  n(np.unique(y_df
-0006a9b0: 2929 290d 0a20 2020 2020 2020 2069 6620  )))..        if 
-0006a9c0: 6d6f 6465 6c74 7970 6520 3d3d 2027 4269  modeltype == 'Bi
-0006a9d0: 6e61 7279 5f43 6c61 7373 6966 6963 6174  nary_Classificat
-0006a9e0: 696f 6e27 3a0d 0a20 2020 2020 2020 2020  ion':..         
-0006a9f0: 2020 2070 7269 6e74 2827 5573 696e 6720     print('Using 
-0006aa00: 5365 6c66 2d50 6163 6564 2045 6e73 656d  Self-Paced Ensem
-0006aa10: 626c 6520 436c 6173 7369 6669 6572 2074  ble Classifier t
-0006aa20: 6f20 6861 6e64 6c65 2074 6869 7320 496d  o handle this Im
-0006aa30: 6261 6c61 6e63 6564 2064 6174 6173 6574  balanced dataset
-0006aa40: 2e2e 2e27 290d 0a20 2020 2020 2020 2065  ...')..        e
-0006aa50: 6c73 653a 0d0a 2020 2020 2020 2020 2020  lse:..          
-0006aa60: 2020 7072 696e 7428 2755 7369 6e67 204f    print('Using O
-0006aa70: 6e65 5673 5265 7374 2b53 656c 662d 5061  neVsRest+Self-Pa
-0006aa80: 6365 6420 456e 7365 6d62 6c65 2043 6c61  ced Ensemble Cla
-0006aa90: 7373 6966 6965 7220 746f 2068 616e 646c  ssifier to handl
-0006aaa0: 6520 7468 6973 2049 6d62 616c 616e 6365  e this Imbalance
-0006aab0: 6420 6461 7461 7365 742e 2e2e 2729 0d0a  d dataset...')..
-0006aac0: 2020 2020 7472 793a 0d0a 2020 2020 2020      try:..      
-0006aad0: 2020 2323 2323 2323 2323 2323 2323 2323    ##############
-0006aae0: 2323 2323 2323 2323 2323 2323 2323 2323  ################
-0006aaf0: 2323 2323 2323 2323 2323 2323 2323 2323  ################
-0006ab00: 2323 2323 2323 2323 2323 2323 2323 2323  ################
-0006ab10: 2323 2323 2323 2323 230d 0a20 2020 2020  #########..     
-0006ab20: 2020 2023 2049 6e69 7469 616c 697a 6520     # Initialize 
-0006ab30: 7468 6520 7265 7361 6d70 6c65 7220 6f62  the resampler ob
-0006ab40: 6a65 6374 0d0a 2020 2020 2020 2020 6466  ject..        df
-0006ab50: 5f74 7261 696e 203d 2058 5f64 662e 6a6f  _train = X_df.jo
-0006ab60: 696e 2879 5f64 6629 0d0a 2020 2020 2020  in(y_df)..      
-0006ab70: 2020 2320 4765 6e65 7261 7465 2063 6c61    # Generate cla
-0006ab80: 7373 6573 0d0a 2020 2020 2020 2020 2323  sses..        ##
-0006ab90: 2323 2053 656c 6563 7420 7468 6520 7269  ## Select the ri
-0006aba0: 6768 7420 534d 4f54 4520 616c 676f 7269  ght SMOTE algori
-0006abb0: 7468 6d20 6261 7365 6420 6f6e 2077 6865  thm based on whe
-0006abc0: 7468 6572 2074 6865 7265 2061 7265 2061  ther there are a
-0006abd0: 6e79 2069 6d70 5f63 6174 7320 696e 2064  ny imp_cats in d
-0006abe0: 6174 610d 0a20 2020 2020 2020 2063 6174  ata..        cat
-0006abf0: 5f76 6172 735f 696e 6465 7820 3d20 5b69  _vars_index = [i
-0006ac00: 2066 6f72 2069 2c20 6a20 696e 2065 6e75   for i, j in enu
-0006ac10: 6d65 7261 7465 2858 5f64 662e 636f 6c75  merate(X_df.colu
-0006ac20: 6d6e 7329 2069 6620 6a20 696e 2069 6d70  mns) if j in imp
-0006ac30: 5f63 6174 735d 0d0a 2020 2020 2020 2020  _cats]..        
-0006ac40: 2323 2320 6765 7420 7468 6520 6e75 6d62  ### get the numb
-0006ac50: 6572 206f 6620 4b5f 4e65 6967 6862 6f72  er of K_Neighbor
-0006ac60: 7320 7573 696e 6720 7468 6973 2063 616c  s using this cal
-0006ac70: 6375 6c61 7469 6f6e 0d0a 2020 2020 2020  culation..      
-0006ac80: 2020 7261 7265 5f73 616d 706c 6573 203d    rare_samples =
-0006ac90: 2070 642e 5365 7269 6573 2843 6f75 6e74   pd.Series(Count
-0006aca0: 6572 2879 5f64 6629 292e 6d69 6e28 290d  er(y_df)).min().
-0006acb0: 0a20 2020 2020 2020 2023 7072 696e 7428  .        #print(
-0006acc0: 2720 2020 204e 756d 6265 7220 6f66 2052  '    Number of R
-0006acd0: 6172 6520 436c 6173 7320 7361 6d70 6c65  are Class sample
-0006ace0: 7320 3d20 2564 2720 2572 6172 655f 7361  s = %d' %rare_sa
-0006acf0: 6d70 6c65 7329 0d0a 2020 2020 2020 2020  mples)..        
-0006ad00: 7261 7265 5f70 6374 203d 2072 6172 655f  rare_pct = rare_
-0006ad10: 7361 6d70 6c65 732f 795f 6466 2e73 6861  samples/y_df.sha
-0006ad20: 7065 5b30 5d0d 0a20 2020 2020 2020 2073  pe[0]..        s
-0006ad30: 6d61 6c6c 6573 745f 6b6e 203d 2020 7261  mallest_kn =  ra
-0006ad40: 7265 5f73 616d 706c 6573 202d 2031 0d0a  re_samples - 1..
-0006ad50: 2020 2020 2020 2020 6966 2073 6d61 6c6c          if small
-0006ad60: 6573 745f 6b6e 203e 2035 3a0d 0a20 2020  est_kn > 5:..   
-0006ad70: 2020 2020 2020 2020 2073 6d61 6c6c 6573           smalles
-0006ad80: 745f 6b6e 203d 2035 0d0a 2020 2020 2020  t_kn = 5..      
-0006ad90: 2020 656c 6966 2073 6d61 6c6c 6573 745f    elif smallest_
-0006ada0: 6b6e 203e 2032 2061 6e64 2073 6d61 6c6c  kn > 2 and small
-0006adb0: 6573 745f 6b6e 203c 2035 3a0d 0a20 2020  est_kn < 5:..   
-0006adc0: 2020 2020 2020 2020 2073 6d61 6c6c 6573           smalles
-0006add0: 745f 6b6e 203d 2032 0d0a 2020 2020 2020  t_kn = 2..      
-0006ade0: 2020 656c 7365 203a 0d0a 2020 2020 2020    else :..      
-0006adf0: 2020 2020 2020 736d 616c 6c65 7374 5f6b        smallest_k
-0006ae00: 6e20 3d20 310d 0a20 2020 2020 2020 2023  n = 1..        #
-0006ae10: 7072 696e 7428 2720 2020 204e 756d 6265  print('    Numbe
-0006ae20: 7220 6f66 204b 204e 6569 6768 626f 7273  r of K Neighbors
-0006ae30: 2073 656c 6563 7465 6420 666f 7220 534d   selected for SM
-0006ae40: 4f54 4520 3d20 2564 2720 2573 6d61 6c6c  OTE = %d' %small
-0006ae50: 6573 745f 6b6e 290d 0a20 2020 2020 2020  est_kn)..       
-0006ae60: 2023 7072 696e 7428 2720 2020 2050 6374   #print('    Pct
-0006ae70: 206f 6620 5261 7265 2043 6c61 7373 2069   of Rare Class i
-0006ae80: 6e20 6461 7461 203d 2025 302e 3266 2525  n data = %0.2f%%
-0006ae90: 2720 2528 7261 7265 5f70 6374 2a31 3030  ' %(rare_pct*100
-0006aea0: 2929 0d0a 2020 2020 2020 2020 6966 2072  ))..        if r
-0006aeb0: 6172 655f 7063 7420 3e20 302e 3130 3a0d  are_pct > 0.10:.
-0006aec0: 0a20 2020 2020 2020 2020 2020 2070 7269  .            pri
-0006aed0: 6e74 2827 2020 2020 5468 6973 2069 7320  nt('    This is 
-0006aee0: 6e6f 7420 616e 2049 6d62 616c 616e 6365  not an Imbalance
-0006aef0: 6420 6461 7461 2073 6574 2e20 4e6f 206e  d data set. No n
-0006af00: 6565 6420 746f 2075 7365 2053 4d4f 5445  eed to use SMOTE
-0006af10: 2062 7574 2063 6f6e 7469 6e75 696e 672e   but continuing.
-0006af20: 2e2e 2729 0d0a 2020 2020 6578 6365 7074  ..')..    except
-0006af30: 3a0d 0a20 2020 2020 2020 2070 7269 6e74  :..        print
-0006af40: 2827 2020 2020 534d 4f54 4520 6973 2065  ('    SMOTE is e
-0006af50: 7272 6f72 696e 672e 2043 6f6e 7469 6e75  rroring. Continu
-0006af60: 696e 6720 7769 7468 6f75 7420 534d 4f54  ing without SMOT
-0006af70: 452e 2e2e 2729 0d0a 2020 2020 2020 2020  E...')..        
-0006af80: 7265 7475 726e 206d 6f64 656c 0d0a 2020  return model..  
-0006af90: 2020 2020 2020 2323 2323 2323 2323 2323        ##########
-0006afa0: 2323 2323 2323 2323 2323 2323 2323 2323  ################
-0006afb0: 2323 2323 2323 2323 2323 2323 2323 2323  ################
-0006afc0: 2323 2323 2323 2323 2323 2323 2323 2323  ################
-0006afd0: 2323 2323 2323 2323 2323 2323 230d 0a20  #############.. 
-0006afe0: 2020 2023 2323 206e 6f77 2074 7261 696e     ### now train
-0006aff0: 2074 6865 206d 6f64 656c 206f 6e20 6675   the model on fu
-0006b000: 6c6c 2074 7261 696e 2064 6174 6120 2323  ll train data ##
-0006b010: 2323 2323 2323 2323 2323 2323 2323 2323  ################
-0006b020: 2323 2323 2323 2323 2323 2323 2323 0d0a  ##############..
-0006b030: 2020 2020 6966 206d 6f64 656c 7479 7065      if modeltype
-0006b040: 203d 3d20 2752 6567 7265 7373 696f 6e27   == 'Regression'
-0006b050: 3a0d 0a20 2020 2020 2020 2023 2052 6567  :..        # Reg
-0006b060: 7265 7373 696f 6e20 7072 6f62 6c65 6d20  ression problem 
-0006b070: 7475 726e 6564 2069 6e74 6f20 436c 6173  turned into Clas
-0006b080: 7369 6669 6361 7469 6f6e 2070 726f 626c  sification probl
-0006b090: 656d 0d0a 2020 2020 2020 2020 6e5f 636c  em..        n_cl
-0006b0a0: 7573 7465 7273 203d 206d 6178 2833 2c20  usters = max(3, 
-0006b0b0: 696e 7428 6e70 2e6c 6f67 3130 286c 656e  int(np.log10(len
-0006b0c0: 2879 5f64 6629 2929 202b 2031 290d 0a20  (y_df))) + 1).. 
-0006b0d0: 2020 2020 2020 2023 2055 7365 204b 4d65         # Use KMe
-0006b0e0: 616e 7320 746f 2066 696e 6420 6e61 7475  ans to find natu
-0006b0f0: 7261 6c20 636c 7573 7465 7273 2069 6e20  ral clusters in 
-0006b100: 796f 7572 2064 6174 610d 0a20 2020 2020  your data..     
-0006b110: 2020 206b 6d5f 6d6f 6465 6c20 3d20 4b4d     km_model = KM
-0006b120: 6561 6e73 286e 5f63 6c75 7374 6572 733d  eans(n_clusters=
-0006b130: 6e5f 636c 7573 7465 7273 2c0d 0a20 2020  n_clusters,..   
-0006b140: 2020 2020 2020 2020 2020 2020 2020 2020                  
-0006b150: 2020 2020 2020 206e 5f69 6e69 743d 352c         n_init=5,
-0006b160: 0d0a 2020 2020 2020 2020 2020 2020 2020  ..              
-0006b170: 2020 2020 2020 2020 2020 2020 7261 6e64              rand
-0006b180: 6f6d 5f73 7461 7465 3d39 3929 0d0a 2020  om_state=99)..  
-0006b190: 2020 2020 2020 2323 2323 2072 656d 656d        #### remem
-0006b1a0: 6265 7220 796f 7520 6d75 7374 2070 7265  ber you must pre
-0006b1b0: 6469 6374 2075 7369 6e67 206f 6e6c 7920  dict using only 
-0006b1c0: 7072 6564 6963 746f 7220 7661 7269 6162  predictor variab
-0006b1d0: 6c65 7321 0d0a 2020 2020 2020 2020 595f  les!..        Y_
-0006b1e0: 636c 6173 7365 7320 3d20 6b6d 5f6d 6f64  classes = km_mod
-0006b1f0: 656c 2e66 6974 5f70 7265 6469 6374 2858  el.fit_predict(X
-0006b200: 5f64 6629 0d0a 2020 2020 656c 7365 3a0d  _df)..    else:.
-0006b210: 0a20 2020 2020 2020 2059 5f63 6c61 7373  .        Y_class
-0006b220: 6573 203d 2063 6f70 792e 6465 6570 636f  es = copy.deepco
-0006b230: 7079 2879 5f64 6629 0d0a 2020 2020 2323  py(y_df)..    ##
-0006b240: 2323 2053 4d4f 5445 2077 6f72 6b73 206f  ## SMOTE works o
-0006b250: 6e6c 7920 666f 7220 5369 6e67 6c65 204c  nly for Single L
-0006b260: 6162 656c 2070 726f 626c 656d 7320 2323  abel problems ##
-0006b270: 2323 0d0a 2020 2020 6966 206d 6f64 656c  ##..    if model
-0006b280: 5f6c 6162 656c 203d 3d20 2753 696e 676c  _label == 'Singl
-0006b290: 655f 4c61 6265 6c27 3a0d 0a20 2020 2020  e_Label':..     
-0006b2a0: 2020 2063 6c61 7373 5f77 6569 6768 7465     class_weighte
-0006b2b0: 645f 726f 7773 203d 2067 6574 5f63 6c61  d_rows = get_cla
-0006b2c0: 7373 5f64 6973 7472 6962 7574 696f 6e28  ss_distribution(
-0006b2d0: 595f 636c 6173 7365 7329 0d0a 2020 2020  Y_classes)..    
-0006b2e0: 2020 2020 6966 206c 656e 2869 6d70 5f63      if len(imp_c
-0006b2f0: 6174 7329 203e 2030 3a0d 0a20 2020 2020  ats) > 0:..     
-0006b300: 2020 2020 2020 2023 2059 6f75 7220 6661         # Your fa
-0006b310: 766f 7572 6974 6520 6f76 6572 7361 6d70  vourite oversamp
-0006b320: 6c65 7220 3d20 534d 4f54 454e 4320 6973  ler = SMOTENC is
-0006b330: 2062 6574 7465 7220 7468 616e 2053 4d4f   better than SMO
-0006b340: 5445 2069 6e20 6d6f 7374 2063 6173 6573  TE in most cases
-0006b350: 210d 0a20 2020 2020 2020 2020 2020 2073  !..            s
-0006b360: 6d6f 7465 203d 2053 4d4f 5445 4e43 2863  mote = SMOTENC(c
-0006b370: 6174 6567 6f72 6963 616c 5f66 6561 7475  ategorical_featu
-0006b380: 7265 733d 6361 745f 7661 7273 5f69 6e64  res=cat_vars_ind
-0006b390: 6578 2c0d 0a20 2020 2020 2020 2020 2020  ex,..           
-0006b3a0: 2020 2020 2020 2020 2020 2020 2073 616d               sam
-0006b3b0: 706c 696e 675f 7374 7261 7465 6779 3d63  pling_strategy=c
-0006b3c0: 6c61 7373 5f77 6569 6768 7465 645f 726f  lass_weighted_ro
-0006b3d0: 7773 2c0d 0a20 2020 2020 2020 2020 2020  ws,..           
-0006b3e0: 2020 2020 2020 2020 2020 2020 2072 616e               ran
-0006b3f0: 646f 6d5f 7374 6174 653d 3432 2c20 6b5f  dom_state=42, k_
-0006b400: 6e65 6967 6862 6f72 733d 736d 616c 6c65  neighbors=smalle
-0006b410: 7374 5f6b 6e2c 206e 5f6a 6f62 733d 2d31  st_kn, n_jobs=-1
-0006b420: 290d 0a20 2020 2020 2020 2065 6c73 653a  )..        else:
-0006b430: 0d0a 2020 2020 2020 2020 2020 2020 2320  ..            # 
-0006b440: 596f 7572 2066 6176 6f75 7269 7465 206f  Your favourite o
-0006b450: 7665 7273 616d 706c 6572 203d 2053 4d4f  versampler = SMO
-0006b460: 5445 2069 7320 6265 7474 6572 2074 6861  TE is better tha
-0006b470: 6e20 534d 4f54 4545 4e4e 2069 6e20 6d6f  n SMOTEENN in mo
-0006b480: 7374 2063 6173 6573 210d 0a20 2020 2020  st cases!..     
-0006b490: 2020 2020 2020 2073 6d6f 7465 203d 2053         smote = S
-0006b4a0: 4d4f 5445 2872 616e 646f 6d5f 7374 6174  MOTE(random_stat
-0006b4b0: 653d 3237 2c20 7361 6d70 6c69 6e67 5f73  e=27, sampling_s
-0006b4c0: 7472 6174 6567 793d 636c 6173 735f 7765  trategy=class_we
-0006b4d0: 6967 6874 6564 5f72 6f77 732c 206e 5f6a  ighted_rows, n_j
-0006b4e0: 6f62 733d 2d31 290d 0a20 2020 2023 2323  obs=-1)..    ###
-0006b4f0: 2323 2323 2323 2323 2323 2323 2323 2323  ################
-0006b500: 2323 2323 2320 2020 2052 6567 7265 7373  #####    Regress
-0006b510: 696f 6e20 5265 7361 6d70 6c65 7220 2020  ion Resampler   
-0006b520: 2023 2323 2323 2323 2323 2323 2323 2323   ###############
-0006b530: 2323 2323 2323 2323 2323 0d0a 2020 2020  ##########..    
-0006b540: 7472 793a 0d0a 2020 2020 2020 2020 6966  try:..        if
-0006b550: 206d 6f64 656c 7479 7065 203d 3d20 2752   modeltype == 'R
-0006b560: 6567 7265 7373 696f 6e27 3a0d 0a20 2020  egression':..   
-0006b570: 2020 2020 2020 2020 2023 2323 2320 5573           #### Us
-0006b580: 696e 6720 7265 6720 7265 7361 6d70 6c65  ing reg resample
-0006b590: 7220 7769 6c6c 206e 6565 6420 7461 7267  r will need targ
-0006b5a0: 6574 2063 6f6c 756d 6e20 696e 2064 665f  et column in df_
-0006b5b0: 7472 6169 6e20 7472 6169 6e20 2d20 646f  train train - do
-0006b5c0: 6e27 7420 666f 7267 6574 210d 0a20 2020  n't forget!..   
-0006b5d0: 2020 2020 2020 2020 2058 5f64 665f 7265           X_df_re
-0006b5e0: 732c 2079 5f64 665f 7265 7320 3d20 6b6d  s, y_df_res = km
-0006b5f0: 6561 6e73 5f72 6573 616d 706c 6572 2858  eans_resampler(X
-0006b600: 5f64 662c 2079 5f64 662c 2074 6172 6765  _df, y_df, targe
-0006b610: 742c 2073 6d6f 7465 2c20 7665 7262 6f73  t, smote, verbos
-0006b620: 6529 0d0a 2020 2020 2020 2020 2020 2020  e)..            
-0006b630: 2323 2320 7468 6520 785f 6466 5f72 6573  ### the x_df_res
-0006b640: 206f 7574 7075 7420 6f66 2072 6573 616d   output of resam
-0006b650: 706c 6572 2077 696c 6c20 6e6f 7420 6861  pler will not ha
-0006b660: 7665 2074 6865 2074 6172 6765 7420 7369  ve the target si
-0006b670: 6e63 6520 6974 2077 696c 6c20 6861 7665  nce it will have
-0006b680: 2062 6565 6e20 7265 6d6f 7665 6421 0d0a   been removed!..
-0006b690: 2020 2020 2020 2020 2020 2020 2323 2320              ### 
-0006b6a0: 795f 6466 5f72 6573 2077 696c 6c20 6861  y_df_res will ha
-0006b6b0: 7665 2074 6865 2074 6172 6765 7420 636f  ve the target co
-0006b6c0: 6c75 6d6e 2077 6974 6820 6e6f 7720 6578  lumn with now ex
-0006b6d0: 7472 6120 726f 7773 2066 6f72 2072 6567  tra rows for reg
-0006b6e0: 7265 7373 696f 6e20 7472 6169 6e69 6e67  ression training
-0006b6f0: 210d 0a20 2020 2020 2020 2065 6c73 653a  !..        else:
-0006b700: 0d0a 2020 2020 2020 2020 2020 2020 2323  ..            ##
-0006b710: 2323 2046 6f72 2063 6c61 7373 6966 6963  ## For classific
-0006b720: 6174 696f 6e20 7072 6f62 6c65 6d73 2073  ation problems s
-0006b730: 696d 706c 7920 7573 696e 6720 7468 6520  imply using the 
-0006b740: 6f72 6967 696e 616c 2064 6174 6120 7769  original data wi
-0006b750: 6c6c 2064 6f0d 0a20 2020 2020 2020 2020  ll do..         
-0006b760: 2020 2023 585f 6466 5f72 6573 2c20 795f     #X_df_res, y_
-0006b770: 6466 5f72 6573 203d 2073 6d6f 7465 2e66  df_res = smote.f
-0006b780: 6974 5f72 6573 616d 706c 6528 585f 6466  it_resample(X_df
-0006b790: 2c20 795f 6466 290d 0a20 2020 2020 2020  , y_df)..       
-0006b7a0: 2020 2020 2023 2323 2046 6f72 2063 6c61       ### For cla
-0006b7b0: 7373 6966 6963 6174 696f 6e20 7072 6f62  ssification prob
-0006b7c0: 6c65 6d73 2077 6520 6172 6520 676f 696e  lems we are goin
-0006b7d0: 6720 746f 2075 7365 2053 5045 2066 726f  g to use SPE fro
-0006b7e0: 6d20 6e6f 7720 6f6e 0d0a 2020 2020 2020  m now on..      
-0006b7f0: 2020 2020 2020 6966 206d 6f64 656c 7479        if modelty
-0006b800: 7065 203d 3d20 2742 696e 6172 795f 436c  pe == 'Binary_Cl
-0006b810: 6173 7369 6669 6361 7469 6f6e 273a 0d0a  assification':..
-0006b820: 2020 2020 2020 2020 2020 2020 2020 2020                  
-0006b830: 2323 2320 466f 7220 4269 6e61 7279 2063  ### For Binary c
-0006b840: 6c61 7373 2c20 5350 4520 6d6f 6465 6c20  lass, SPE model 
-0006b850: 6973 2062 6574 7465 7220 2323 2323 2323  is better ######
-0006b860: 2323 2323 2323 0d0a 2020 2020 2020 2020  ######..        
-0006b870: 2020 2020 2020 2020 7266 203d 2052 616e          rf = Ran
-0006b880: 646f 6d46 6f72 6573 7443 6c61 7373 6966  domForestClassif
-0006b890: 6965 7228 6e5f 6573 7469 6d61 746f 7273  ier(n_estimators
-0006b8a0: 3d31 3030 2c20 7261 6e64 6f6d 5f73 7461  =100, random_sta
-0006b8b0: 7465 3d39 3929 0d0a 2020 2020 2020 2020  te=99)..        
-0006b8c0: 2020 2020 2020 2020 7370 6520 3d20 5365          spe = Se
-0006b8d0: 6c66 5061 6365 6445 6e73 656d 626c 6543  lfPacedEnsembleC
-0006b8e0: 6c61 7373 6966 6965 7228 6573 7469 6d61  lassifier(estima
-0006b8f0: 746f 723d 7266 2c20 6e5f 6a6f 6273 3d2d  tor=rf, n_jobs=-
-0006b900: 312c 2073 6f66 745f 7265 7361 6d70 6c65  1, soft_resample
-0006b910: 5f66 6c61 673d 4661 6c73 6529 0d0a 2020  _flag=False)..  
-0006b920: 2020 2020 2020 2020 2020 656c 7365 3a0d            else:.
-0006b930: 0a20 2020 2020 2020 2020 2020 2020 2020  .               
-0006b940: 2023 2320 466f 7220 6d75 6c74 692d 636c   ## For multi-cl
-0006b950: 6173 7320 4f6e 6576 7352 6573 7420 6d6f  ass OnevsRest mo
-0006b960: 6465 6c20 6973 2062 6574 7465 7220 2023  del is better  #
-0006b970: 2323 2323 2323 2323 2323 0d0a 2020 2020  ##########..    
-0006b980: 2020 2020 2020 2020 2020 2020 7266 203d              rf =
-0006b990: 2052 616e 646f 6d46 6f72 6573 7443 6c61   RandomForestCla
-0006b9a0: 7373 6966 6965 7228 6e5f 6573 7469 6d61  ssifier(n_estima
-0006b9b0: 746f 7273 3d31 3030 2c20 7261 6e64 6f6d  tors=100, random
-0006b9c0: 5f73 7461 7465 3d39 3929 0d0a 2020 2020  _state=99)..    
-0006b9d0: 2020 2020 2020 2020 2020 2020 7370 6520              spe 
-0006b9e0: 3d20 5365 6c66 5061 6365 6445 6e73 656d  = SelfPacedEnsem
-0006b9f0: 626c 6543 6c61 7373 6966 6965 7228 6573  bleClassifier(es
-0006ba00: 7469 6d61 746f 723d 7266 2c20 6e5f 6a6f  timator=rf, n_jo
-0006ba10: 6273 3d2d 312c 2073 6f66 745f 7265 7361  bs=-1, soft_resa
-0006ba20: 6d70 6c65 5f66 6c61 673d 4661 6c73 6529  mple_flag=False)
-0006ba30: 0d0a 2020 2020 2020 2020 2020 2020 2020  ..              
-0006ba40: 2020 7370 6520 3d20 4f6e 6556 7352 6573    spe = OneVsRes
-0006ba50: 7443 6c61 7373 6966 6965 7228 6573 7469  tClassifier(esti
-0006ba60: 6d61 746f 723d 7370 6529 0d0a 2020 2020  mator=spe)..    
-0006ba70: 2020 2020 2020 2020 7370 652e 6669 7428          spe.fit(
-0006ba80: 585f 6466 2c20 795f 6466 290d 0a20 2020  X_df, y_df)..   
-0006ba90: 2020 2020 2020 2020 2072 6574 7572 6e20           return 
-0006baa0: 7370 650d 0a20 2020 2065 7863 6570 743a  spe..    except:
-0006bab0: 0d0a 2020 2020 2020 2020 7072 696e 7428  ..        print(
-0006bac0: 2753 4d4f 5445 206f 7220 5265 6772 6573  'SMOTE or Regres
-0006bad0: 7369 6f6e 2d72 6573 616d 706c 6572 2069  sion-resampler i
-0006bae0: 7320 6572 726f 7269 6e67 2e20 436f 6e74  s erroring. Cont
-0006baf0: 696e 7569 6e67 2e2e 2e27 290d 0a20 2020  inuing...')..   
-0006bb00: 2020 2020 206d 6f64 656c 203d 206d 6f64       model = mod
-0006bb10: 656c 5f74 7261 696e 696e 675f 736d 6f74  el_training_smot
-0006bb20: 6528 6d6f 6465 6c2c 2058 5f64 662c 2079  e(model, X_df, y
-0006bb30: 5f64 662c 2065 7661 6c5f 7365 742c 2065  _df, eval_set, e
-0006bb40: 7661 6c5f 6d65 7472 6963 2c0d 0a20 2020  val_metric,..   
-0006bb50: 2020 2020 2020 2020 2020 2020 2020 2020                  
-0006bb60: 2020 2020 2020 2020 2020 7061 7261 6d73            params
-0006bb70: 2c20 696d 705f 6361 7473 2c20 6d6f 6465  , imp_cats, mode
-0006bb80: 6c74 7970 652c 0d0a 2020 2020 2020 2020  ltype,..        
-0006bb90: 2020 2020 2020 2020 2020 2020 2020 2020                  
-0006bba0: 2020 2020 6361 6c69 6272 6174 6f72 5f66      calibrator_f
-0006bbb0: 6c61 672c 206d 6f64 656c 5f6e 616d 652c  lag, model_name,
-0006bbc0: 2042 6f6f 7374 696e 675f 466c 6167 2c20   Boosting_Flag, 
-0006bbd0: 6d6f 6465 6c5f 6c61 6265 6c2c 0d0a 2020  model_label,..  
-0006bbe0: 2020 2020 2020 2020 2020 2020 2020 2020                  
-0006bbf0: 2020 2020 2020 2020 2020 2047 5055 5f65             GPU_e
-0006bc00: 7869 7374 7329 0d0a 2020 2020 2020 2020  xists)..        
-0006bc10: 7072 696e 7428 2720 2020 204d 6f64 656c  print('    Model
-0006bc20: 2054 7261 696e 696e 6720 7469 6d65 2074   Training time t
-0006bc30: 616b 656e 203d 2025 302e 3066 2073 6563  aken = %0.0f sec
-0006bc40: 6f6e 6473 2720 2528 7469 6d65 2e74 696d  onds' %(time.tim
-0006bc50: 6528 292d 7374 6172 745f 7469 6d65 2929  e()-start_time))
-0006bc60: 0d0a 2020 2020 2020 2020 7265 7475 726e  ..        return
-0006bc70: 2073 7065 0d0a 2020 2020 7072 696e 7428   spe..    print(
-0006bc80: 2754 7261 696e 696e 6720 6d6f 6465 6c20  'Training model 
-0006bc90: 6e6f 7720 6f6e 2072 6573 616d 706c 6564  now on resampled
-0006bca0: 2074 7261 696e 2064 6174 613a 2025 732e   train data: %s.
-0006bcb0: 2054 6869 7320 7769 6c6c 2074 616b 6520   This will take 
-0006bcc0: 7469 6d65 2e2e 2e27 2025 2858 5f64 665f  time...' %(X_df_
-0006bcd0: 7265 732e 7368 6170 652c 2929 0d0a 2020  res.shape,))..  
-0006bce0: 2020 2320 4669 7420 7468 6520 6d6f 6465    # Fit the mode
-0006bcf0: 6c20 7573 696e 6720 785f 7472 6169 6e20  l using x_train 
-0006bd00: 616e 6420 795f 7472 6169 6e20 6675 6c6c  and y_train full
-0006bd10: 2064 6174 6120 7365 6e74 2069 6e0d 0a20   data sent in.. 
-0006bd20: 2020 206d 6f64 656c 203d 206d 6f64 656c     model = model
-0006bd30: 5f74 7261 696e 696e 675f 736d 6f74 6528  _training_smote(
-0006bd40: 6d6f 6465 6c2c 2058 5f64 665f 7265 732c  model, X_df_res,
-0006bd50: 2079 5f64 665f 7265 732c 2065 7661 6c5f   y_df_res, eval_
-0006bd60: 7365 742c 2065 7661 6c5f 6d65 7472 6963  set, eval_metric
-0006bd70: 2c0d 0a20 2020 2020 2020 2020 2020 2020  ,..             
-0006bd80: 2020 2020 2020 2020 2020 2020 7061 7261              para
-0006bd90: 6d73 2c20 696d 705f 6361 7473 2c20 6d6f  ms, imp_cats, mo
-0006bda0: 6465 6c74 7970 652c 0d0a 2020 2020 2020  deltype,..      
-0006bdb0: 2020 2020 2020 2020 2020 2020 2020 2020                  
-0006bdc0: 2020 6361 6c69 6272 6174 6f72 5f66 6c61    calibrator_fla
-0006bdd0: 672c 206d 6f64 656c 5f6e 616d 652c 2042  g, model_name, B
-0006bde0: 6f6f 7374 696e 675f 466c 6167 2c20 6d6f  oosting_Flag, mo
-0006bdf0: 6465 6c5f 6c61 6265 6c2c 0d0a 2020 2020  del_label,..    
-0006be00: 2020 2020 2020 2020 2020 2020 2020 2020                  
-0006be10: 2020 2020 2047 5055 5f65 7869 7374 7329       GPU_exists)
-0006be20: 0d0a 2020 2020 7072 696e 7428 2720 2020  ..    print('   
-0006be30: 2052 6573 616d 706c 6564 2064 6174 6120   Resampled data 
-0006be40: 5472 6169 6e69 6e67 2074 696d 6520 7461  Training time ta
-0006be50: 6b65 6e20 3d20 2530 2e30 6620 7365 636f  ken = %0.0f seco
-0006be60: 6e64 7327 2025 2874 696d 652e 7469 6d65  nds' %(time.time
-0006be70: 2829 2d73 7461 7274 5f74 696d 6529 290d  ()-start_time)).
-0006be80: 0a20 2020 2023 4e6f 7720 6d61 6b65 2070  .    #Now make p
-0006be90: 7265 6469 6374 696f 6e73 206f 6e20 6865  redictions on he
-0006bea0: 6c64 206f 7574 2064 6174 610d 0a20 2020  ld out data..   
-0006beb0: 206d 6f64 656c 5f73 7472 203d 2073 7472   model_str = str
-0006bec0: 286d 6f64 656c 292e 7370 6c69 7428 2228  (model).split("(
-0006bed0: 2229 5b30 5d0d 0a20 2020 2069 6620 7472  ")[0]..    if tr
-0006bee0: 6169 6e69 6e67 3a0d 0a20 2020 2020 2020  aining:..       
-0006bef0: 2078 5f74 6573 7420 3d20 6576 616c 5f73   x_test = eval_s
-0006bf00: 6574 5b30 5d5b 305d 0d0a 2020 2020 2020  et[0][0]..      
-0006bf10: 2020 795f 7465 7374 203d 2065 7661 6c5f    y_test = eval_
-0006bf20: 7365 745b 305d 5b31 5d0d 0a20 2020 2020  set[0][1]..     
-0006bf30: 2020 2023 2043 6865 636b 2074 6865 2073     # Check the s
-0006bf40: 636f 7265 0d0a 2020 2020 2020 2020 7072  core..        pr
-0006bf50: 696e 7428 2723 2323 2323 2323 2323 2323  int('###########
-0006bf60: 2323 2323 2323 2323 2323 2323 2323 2323  ################
-0006bf70: 2323 2323 2323 2323 2323 2323 2323 2323  ################
-0006bf80: 2323 2323 2323 2323 2323 2323 2327 290d  #############').
-0006bf90: 0a20 2020 2020 2020 2070 7269 6e74 2827  .        print('
-0006bfa0: 5265 7361 6d70 6c65 6420 6d6f 6465 6c20  Resampled model 
-0006bfb0: 7265 7375 6c74 7320 6f6e 2048 656c 6420  results on Held 
-0006bfc0: 6f75 7420 5661 6c69 6461 7469 6f6e 2064  out Validation d
-0006bfd0: 6174 613a 2729 0d0a 2020 2020 2020 2020  ata:')..        
-0006bfe0: 6966 206d 6f64 656c 7479 7065 203d 3d20  if modeltype == 
-0006bff0: 2752 6567 7265 7373 696f 6e27 3a0d 0a20  'Regression':.. 
-0006c000: 2020 2020 2020 2020 2020 2070 7269 6e74             print
-0006c010: 5f72 6567 7265 7373 696f 6e5f 6d65 7472  _regression_metr
-0006c020: 6963 7328 795f 7465 7374 2c20 6d6f 6465  ics(y_test, mode
-0006c030: 6c2e 7072 6564 6963 7428 785f 7465 7374  l.predict(x_test
-0006c040: 2929 0d0a 2020 2020 2020 2020 656c 7365  ))..        else
-0006c050: 3a0d 0a20 2020 2020 2020 2020 2020 2070  :..            p
-0006c060: 7269 6e74 2863 6c61 7373 6966 6963 6174  rint(classificat
-0006c070: 696f 6e5f 7265 706f 7274 2879 5f74 6573  ion_report(y_tes
-0006c080: 742c 206d 6f64 656c 2e70 7265 6469 6374  t, model.predict
-0006c090: 2878 5f74 6573 7429 2929 0d0a 2020 2020  (x_test)))..    
-0006c0a0: 2020 2020 7072 696e 7428 2723 2323 2323      print('#####
-0006c0b0: 2323 2323 2323 2323 2323 2323 2320 2043  #############  C
-0006c0c0: 6f6d 706c 6574 6564 2049 6d62 616c 616e  ompleted Imbalan
-0006c0d0: 6365 6420 5472 6169 6e69 6e67 2075 7369  ced Training usi
-0006c0e0: 6e67 2025 7320 2323 2323 2323 2323 2323  ng %s ##########
-0006c0f0: 2323 2323 2323 2720 256d 6f64 656c 5f73  ######' %model_s
-0006c100: 7472 290d 0a20 2020 2065 6c73 653a 0d0a  tr)..    else:..
-0006c110: 2020 2020 2020 2020 6966 2076 6572 626f          if verbo
-0006c120: 7365 203e 3d20 313a 0d0a 2020 2020 2020  se >= 1:..      
-0006c130: 2020 2020 2020 6669 672c 2028 6178 312c        fig, (ax1,
-0006c140: 2061 7832 2920 3d20 706c 742e 7375 6270   ax2) = plt.subp
-0006c150: 6c6f 7473 2831 2c20 322c 2073 6861 7265  lots(1, 2, share
-0006c160: 793d 5472 7565 2c66 6967 7369 7a65 3d28  y=True,figsize=(
-0006c170: 3132 2c35 2929 0d0a 2020 2020 2020 2020  12,5))..        
-0006c180: 2020 2020 6966 206d 6f64 656c 7479 7065      if modeltype
-0006c190: 203d 3d20 2752 6567 7265 7373 696f 6e27   == 'Regression'
-0006c1a0: 3a0d 0a20 2020 2020 2020 2020 2020 2020  :..             
-0006c1b0: 2020 2079 5f64 662e 706c 6f74 286b 696e     y_df.plot(kin
-0006c1c0: 643d 2768 6973 7427 2c74 6974 6c65 3d27  d='hist',title='
-0006c1d0: 4469 7374 2e20 6f66 2074 6172 6765 7420  Dist. of target 
-0006c1e0: 6265 666f 7265 2052 6567 7265 7373 696f  before Regressio
-0006c1f0: 6e20 5265 7361 6d70 6c65 7227 2c20 6178  n Resampler', ax
-0006c200: 3d61 7831 2c20 636f 6c6f 723d 2772 2729  =ax1, color='r')
-0006c210: 0d0a 2020 2020 2020 2020 2020 2020 2020  ..              
-0006c220: 2020 7064 2e44 6174 6146 7261 6d65 2879    pd.DataFrame(y
-0006c230: 5f64 665f 7265 7329 2e70 6c6f 7428 6b69  _df_res).plot(ki
-0006c240: 6e64 3d27 6869 7374 272c 7469 746c 653d  nd='hist',title=
-0006c250: 2744 6973 742e 206f 6620 7461 7267 6574  'Dist. of target
-0006c260: 2061 6674 6572 2052 6567 7265 7373 696f   after Regressio
-0006c270: 6e20 5265 7361 6d70 6c65 7227 2c20 6178  n Resampler', ax
-0006c280: 3d61 7832 2c20 636f 6c6f 723d 2762 2729  =ax2, color='b')
-0006c290: 0d0a 2020 2020 2020 2020 2020 2020 656c  ..            el
-0006c2a0: 7365 3a0d 0a20 2020 2020 2020 2020 2020  se:..           
-0006c2b0: 2020 2020 2079 5f64 662e 7661 6c75 655f       y_df.value_
-0006c2c0: 636f 756e 7473 2831 292e 706c 6f74 286b  counts(1).plot(k
-0006c2d0: 696e 643d 2762 6172 272c 7469 746c 653d  ind='bar',title=
-0006c2e0: 2744 6973 7472 6962 7574 696f 6e20 6f66  'Distribution of
-0006c2f0: 2063 6c61 7373 6573 2062 6566 6f72 6520   classes before 
-0006c300: 534d 4f54 4527 2c20 6178 3d61 7831 2c20  SMOTE', ax=ax1, 
-0006c310: 636f 6c6f 723d 2772 2729 0d0a 2020 2020  color='r')..    
-0006c320: 2020 2020 2020 2020 2020 2020 795f 6466              y_df
-0006c330: 5f72 6573 2e76 616c 7565 5f63 6f75 6e74  _res.value_count
-0006c340: 7328 3129 2e70 6c6f 7428 6b69 6e64 3d27  s(1).plot(kind='
-0006c350: 6261 7227 2c74 6974 6c65 3d27 4469 7374  bar',title='Dist
-0006c360: 7269 6275 7469 6f6e 206f 6620 636c 6173  ribution of clas
-0006c370: 7365 7320 6166 7465 7220 534d 4f54 4527  ses after SMOTE'
-0006c380: 2c20 6178 3d61 7832 2c20 636f 6c6f 723d  , ax=ax2, color=
-0006c390: 2762 2729 0d0a 2020 2020 7265 7475 726e  'b')..    return
-0006c3a0: 206d 6f64 656c 0d0a 2323 2323 2323 2323   model..########
-0006c3b0: 2323 2323 2323 2323 2323 2323 2323 2323  ################
-0006c3c0: 2323 2323 2323 2323 2323 2323 2323 2323  ################
-0006c3d0: 2323 2323 2323 2323 2323 2323 2323 2323  ################
-0006c3e0: 2323 2323 2323 2323 2323 2323 2323 2323  ################
-0006c3f0: 2323 2323 2323 2323 2323 2323 2323 2323  ################
-0006c400: 2323 2323 2323 0d0a 6465 6620 6d6f 6465  ######..def mode
-0006c410: 6c5f 7472 6169 6e69 6e67 5f73 6d6f 7465  l_training_smote
-0006c420: 286d 6f64 656c 2c20 785f 7472 6169 6e2c  (model, x_train,
-0006c430: 2079 5f74 7261 696e 2c20 6576 616c 5f73   y_train, eval_s
-0006c440: 6574 2c20 6576 616c 5f6d 6574 7269 632c  et, eval_metric,
-0006c450: 0d0a 2020 2020 2020 2020 2020 2020 2020  ..              
-0006c460: 2020 2020 2020 2020 2020 2070 6172 616d             param
-0006c470: 732c 2069 6d70 5f63 6174 732c 206d 6f64  s, imp_cats, mod
-0006c480: 656c 7479 7065 2c0d 0a20 2020 2020 2020  eltype,..       
-0006c490: 2020 2020 2020 2020 2020 2020 2020 2020                  
-0006c4a0: 2063 616c 6962 7261 746f 725f 666c 6167   calibrator_flag
-0006c4b0: 2c20 6d6f 6465 6c5f 6e61 6d65 2c20 426f  , model_name, Bo
-0006c4c0: 6f73 7469 6e67 5f46 6c61 672c 206d 6f64  osting_Flag, mod
-0006c4d0: 656c 5f6c 6162 656c 2c0d 0a20 2020 2020  el_label,..     
-0006c4e0: 2020 2020 2020 2020 2020 2020 2020 2020                  
-0006c4f0: 2020 2020 4750 555f 6578 6973 7473 293a      GPU_exists):
-0006c500: 0d0a 2020 2020 2323 2323 2054 6869 7320  ..    #### This 
-0006c510: 6d6f 6465 6c20 7472 6169 6e69 6e67 2076  model training v
-0006c520: 6961 2053 4d4f 5445 2068 6173 2074 6f20  ia SMOTE has to 
-0006c530: 6265 206d 6f64 6966 6965 6420 6c61 7465  be modified late
-0006c540: 7220 2323 2323 2323 2323 2323 2323 2323  r ##############
-0006c550: 2323 2323 2323 0d0a 2020 2020 6561 726c  ######..    earl
-0006c560: 795f 7374 6f70 7069 6e67 203d 2035 0d0a  y_stopping = 5..
-0006c570: 2020 2020 6966 206d 6f64 656c 5f6c 6162      if model_lab
-0006c580: 656c 203d 3d20 2753 696e 676c 655f 4c61  el == 'Single_La
-0006c590: 6265 6c27 3a0d 0a20 2020 2020 2020 2069  bel':..        i
-0006c5a0: 6620 426f 6f73 7469 6e67 5f46 6c61 673a  f Boosting_Flag:
-0006c5b0: 0d0a 2020 2020 2020 2020 2020 2020 6966  ..            if
-0006c5c0: 206d 6f64 656c 5f6e 616d 6520 3d3d 2027   model_name == '
-0006c5d0: 5847 426f 6f73 7427 3a0d 0a20 2020 2020  XGBoost':..     
-0006c5e0: 2020 2020 2020 2020 2020 2074 7279 3a0d             try:.
-0006c5f0: 0a20 2020 2020 2020 2020 2020 2020 2020  .               
-0006c600: 2020 2020 2069 6620 6361 6c69 6272 6174       if calibrat
-0006c610: 6f72 5f66 6c61 673a 0d0a 2020 2020 2020  or_flag:..      
-0006c620: 2020 2020 2020 2020 2020 2020 2020 2020                  
-0006c630: 2020 6d6f 6465 6c2e 6669 7428 785f 7472    model.fit(x_tr
-0006c640: 6169 6e2c 2079 5f74 7261 696e 290d 0a20  ain, y_train).. 
-0006c650: 2020 2020 2020 2020 2020 2020 2020 2020                  
-0006c660: 2020 2065 6c73 653a 0d0a 2020 2020 2020     else:..      
-0006c670: 2020 2020 2020 2020 2020 2020 2020 2020                  
-0006c680: 2020 6966 2065 7661 6c5f 7365 743d 3d5b    if eval_set==[
-0006c690: 2829 5d20 6f72 206d 6f64 656c 7479 7065  ()] or modeltype
-0006c6a0: 203d 3d20 274d 756c 7469 5f43 6c61 7373   == 'Multi_Class
-0006c6b0: 6966 6963 6174 696f 6e27 3a0d 0a20 2020  ification':..   
-0006c6c0: 2020 2020 2020 2020 2020 2020 2020 2020                  
-0006c6d0: 2020 2020 2020 2020 206d 6f64 656c 2e66           model.f
-0006c6e0: 6974 2878 5f74 7261 696e 2c20 795f 7472  it(x_train, y_tr
-0006c6f0: 6169 6e29 0d0a 2020 2020 2020 2020 2020  ain)..          
-0006c700: 2020 2020 2020 2020 2020 2020 2020 656c                el
-0006c710: 7365 3a0d 0a20 2020 2020 2020 2020 2020  se:..           
-0006c720: 2020 2020 2020 2020 2020 2020 2020 2020                  
-0006c730: 206d 6f64 656c 2e66 6974 2878 5f74 7261   model.fit(x_tra
-0006c740: 696e 2c20 795f 7472 6169 6e2c 6561 726c  in, y_train,earl
-0006c750: 795f 7374 6f70 7069 6e67 5f72 6f75 6e64  y_stopping_round
-0006c760: 733d 6561 726c 795f 7374 6f70 7069 6e67  s=early_stopping
-0006c770: 2c0d 0a20 2020 2020 2020 2020 2020 2020  ,..             
-0006c780: 2020 2020 2020 2020 2020 2020 2020 2020                  
-0006c790: 2020 2065 7661 6c5f 6d65 7472 6963 3d65     eval_metric=e
-0006c7a0: 7661 6c5f 6d65 7472 6963 2c65 7661 6c5f  val_metric,eval_
-0006c7b0: 7365 743d 6576 616c 5f73 6574 2c76 6572  set=eval_set,ver
-0006c7c0: 626f 7365 3d46 616c 7365 290d 0a20 2020  bose=False)..   
-0006c7d0: 2020 2020 2020 2020 2020 2020 2065 7863               exc
-0006c7e0: 6570 743a 0d0a 2020 2020 2020 2020 2020  ept:..          
-0006c7f0: 2020 2020 2020 2020 2020 2323 2323 204f            #### O
-0006c800: 6e20 436f 6c61 622c 2065 7665 6e20 7468  n Colab, even th
-0006c810: 6f75 6768 2047 5055 2065 7869 7374 732c  ough GPU exists,
-0006c820: 206d 616e 7920 7065 6f70 6c65 2064 6f6e   many people don
-0006c830: 2774 2074 7572 6e20 6974 206f 6e2e 0d0a  't turn it on...
-0006c840: 2020 2020 2020 2020 2020 2020 2020 2020                  
-0006c850: 2020 2020 2323 2323 2020 496e 2074 6861      ####  In tha
-0006c860: 7420 6361 7365 2c20 5847 426f 6f73 7420  t case, XGBoost 
-0006c870: 626c 6f77 7320 7570 2077 6865 6e20 6770  blows up when gp
-0006c880: 755f 7072 6564 6963 746f 7220 6973 2075  u_predictor is u
-0006c890: 7365 642e 0d0a 2020 2020 2020 2020 2020  sed...          
-0006c8a0: 2020 2020 2020 2020 2020 2323 2323 2020            ####  
-0006c8b0: 5468 6973 2069 7320 746f 2074 7572 6e20  This is to turn 
-0006c8c0: 6974 2062 6163 6b20 746f 2063 7075 5f70  it back to cpu_p
-0006c8d0: 7265 6469 6374 6f72 2069 6e20 6361 7365  redictor in case
-0006c8e0: 2047 5055 2065 7272 6f72 7321 0d0a 2020   GPU errors!..  
-0006c8f0: 2020 2020 2020 2020 2020 2020 2020 2020                  
-0006c900: 2020 6966 2047 5055 5f65 7869 7374 733a    if GPU_exists:
-0006c910: 0d0a 2020 2020 2020 2020 2020 2020 2020  ..              
-0006c920: 2020 2020 2020 2020 2020 7072 696e 7428            print(
-0006c930: 2757 6172 6e69 6e67 3a20 4750 5520 6578  'Warning: GPU ex
-0006c940: 6973 7473 2062 7574 2069 7420 6973 206e  ists but it is n
-0006c950: 6f74 2074 7572 6e65 6420 6f6e 2e20 5573  ot turned on. Us
-0006c960: 696e 6720 4350 5520 666f 7220 7072 6564  ing CPU for pred
-0006c970: 6963 7469 6f6e 732e 2e2e 2729 0d0a 2020  ictions...')..  
-0006c980: 2020 2020 2020 2020 2020 2020 2020 2020                  
-0006c990: 2020 2020 2020 6966 2063 616c 6962 7261        if calibra
-0006c9a0: 746f 725f 666c 6167 3a0d 0a20 2020 2020  tor_flag:..     
-0006c9b0: 2020 2020 2020 2020 2020 2020 2020 2020                  
-0006c9c0: 2020 2020 2020 206d 6f64 656c 2e62 6173         model.bas
-0006c9d0: 655f 6573 7469 6d61 746f 722e 7365 745f  e_estimator.set_
-0006c9e0: 7061 7261 6d73 282a 2a70 6172 616d 7329  params(**params)
-0006c9f0: 0d0a 2020 2020 2020 2020 2020 2020 2020  ..              
-0006ca00: 2020 2020 2020 2020 2020 2020 2020 6d6f                mo
-0006ca10: 6465 6c2e 6669 7428 785f 7472 6169 6e2c  del.fit(x_train,
-0006ca20: 2079 5f74 7261 696e 290d 0a20 2020 2020   y_train)..     
-0006ca30: 2020 2020 2020 2020 2020 2020 2020 2020                  
-0006ca40: 2020 2065 6c73 653a 0d0a 2020 2020 2020     else:..      
-0006ca50: 2020 2020 2020 2020 2020 2020 2020 2020                  
-0006ca60: 2020 2020 2020 6d6f 6465 6c2e 6573 7469        model.esti
-0006ca70: 6d61 746f 722e 7365 745f 7061 7261 6d73  mator.set_params
-0006ca80: 282a 2a70 6172 616d 7329 0d0a 2020 2020  (**params)..    
-0006ca90: 2020 2020 2020 2020 2020 2020 2020 2020                  
-0006caa0: 2020 2020 2020 2020 6d6f 6465 6c2e 6669          model.fi
-0006cab0: 7428 785f 7472 6169 6e2c 2079 5f74 7261  t(x_train, y_tra
-0006cac0: 696e 290d 0a20 2020 2020 2020 2020 2020  in)..           
-0006cad0: 2020 2020 2020 2020 2065 6c73 653a 0d0a           else:..
-0006cae0: 2020 2020 2020 2020 2020 2020 2020 2020                  
-0006caf0: 2020 2020 2020 2020 6966 2065 7661 6c5f          if eval_
-0006cb00: 7365 743d 3d5b 2829 5d20 6f72 206d 6f64  set==[()] or mod
-0006cb10: 656c 7479 7065 203d 3d20 274d 756c 7469  eltype == 'Multi
-0006cb20: 5f43 6c61 7373 6966 6963 6174 696f 6e27  _Classification'
-0006cb30: 3a0d 0a20 2020 2020 2020 2020 2020 2020  :..             
-0006cb40: 2020 2020 2020 2020 2020 2020 2020 206d                 m
-0006cb50: 6f64 656c 2e66 6974 2878 5f74 7261 696e  odel.fit(x_train
-0006cb60: 2c20 795f 7472 6169 6e29 0d0a 2020 2020  , y_train)..    
-0006cb70: 2020 2020 2020 2020 2020 2020 2020 2020                  
-0006cb80: 2020 2020 656c 7365 3a0d 0a20 2020 2020      else:..     
-0006cb90: 2020 2020 2020 2020 2020 2020 2020 2020                  
-0006cba0: 2020 2020 2020 206d 6f64 656c 2e66 6974         model.fit
-0006cbb0: 2878 5f74 7261 696e 2c20 795f 7472 6169  (x_train, y_trai
-0006cbc0: 6e2c 2065 6172 6c79 5f73 746f 7070 696e  n, early_stoppin
-0006cbd0: 675f 726f 756e 6473 3d65 6172 6c79 5f73  g_rounds=early_s
-0006cbe0: 746f 7070 696e 672c 0d0a 2020 2020 2020  topping,..      
-0006cbf0: 2020 2020 2020 2020 2020 2020 2020 2020                  
-0006cc00: 2020 2020 2020 2020 2020 6576 616c 5f6d            eval_m
-0006cc10: 6574 7269 633d 6576 616c 5f6d 6574 7269  etric=eval_metri
-0006cc20: 632c 6576 616c 5f73 6574 3d65 7661 6c5f  c,eval_set=eval_
-0006cc30: 7365 742c 7665 7262 6f73 653d 4661 6c73  set,verbose=Fals
-0006cc40: 6529 0d0a 2020 2020 2020 2020 2020 2020  e)..            
-0006cc50: 656c 7365 3a0d 0a20 2020 2020 2020 2020  else:..         
-0006cc60: 2020 2020 2020 2065 6172 6c79 5f73 746f         early_sto
-0006cc70: 7070 696e 6720 3d20 3230 0d0a 2020 2020  pping = 20..    
-0006cc80: 2020 2020 2020 2020 2020 2020 6966 2065              if e
-0006cc90: 7661 6c5f 7365 7420 3d3d 205b 2829 5d3a  val_set == [()]:
-0006cca0: 0d0a 2020 2020 2020 2020 2020 2020 2020  ..              
-0006ccb0: 2020 2020 2020 6d6f 6465 6c2e 6669 7428        model.fit(
-0006ccc0: 785f 7472 6169 6e2c 2079 5f74 7261 696e  x_train, y_train
-0006ccd0: 2c20 6361 745f 6665 6174 7572 6573 3d69  , cat_features=i
-0006cce0: 6d70 5f63 6174 732c 706c 6f74 3d46 616c  mp_cats,plot=Fal
-0006ccf0: 7365 2c20 7665 7262 6f73 653d 3129 0d0a  se, verbose=1)..
-0006cd00: 2020 2020 2020 2020 2020 2020 2020 2020                  
-0006cd10: 656c 7365 3a0d 0a20 2020 2020 2020 2020  else:..         
-0006cd20: 2020 2020 2020 2020 2020 206d 6f64 656c             model
-0006cd30: 2e66 6974 2878 5f74 7261 696e 2c20 795f  .fit(x_train, y_
-0006cd40: 7472 6169 6e2c 2063 6174 5f66 6561 7475  train, cat_featu
-0006cd50: 7265 733d 696d 705f 6361 7473 2c20 7665  res=imp_cats, ve
-0006cd60: 7262 6f73 653d 312c 0d0a 2020 2020 2020  rbose=1,..      
-0006cd70: 2020 2020 2020 2020 2020 2020 2020 2020                  
-0006cd80: 2020 2020 2020 2020 2020 6576 616c 5f73            eval_s
-0006cd90: 6574 3d65 7661 6c5f 7365 742c 2075 7365  et=eval_set, use
-0006cda0: 5f62 6573 745f 6d6f 6465 6c3d 5472 7565  _best_model=True
-0006cdb0: 2c20 706c 6f74 3d46 616c 7365 290d 0a20  , plot=False).. 
-0006cdc0: 2020 2020 2020 2065 6c73 653a 0d0a 2020         else:..  
-0006cdd0: 2020 2020 2020 2020 2020 6d6f 6465 6c2e            model.
-0006cde0: 6669 7428 785f 7472 6169 6e2c 2079 5f74  fit(x_train, y_t
-0006cdf0: 7261 696e 290d 0a20 2020 2065 6c73 653a  rain)..    else:
-0006ce00: 0d0a 2020 2020 2020 2020 6d6f 6465 6c2e  ..        model.
-0006ce10: 6669 7428 785f 7472 6169 6e2c 2079 5f74  fit(x_train, y_t
-0006ce20: 7261 696e 290d 0a20 2020 2072 6574 7572  rain)..    retur
-0006ce30: 6e20 6d6f 6465 6c0d 0a23 2323 2323 2323  n model..#######
-0006ce40: 2323 2323 2323 2323 2323 2323 2323 2323  ################
-0006ce50: 2323 2323 2323 2323 2323 2323 2323 2323  ################
-0006ce60: 2323 2323 2323 2323 2323 2323 2323 2323  ################
-0006ce70: 2323 2323 2323 2323 2323 2323 2323 2323  ################
-0006ce80: 2323 2323 2323 2323 2323 0d0a 6672 6f6d  ##########..from
-0006ce90: 2073 6b6c 6561 726e 2e6d 6f64 656c 5f73   sklearn.model_s
-0006cea0: 656c 6563 7469 6f6e 2069 6d70 6f72 7420  election import 
-0006ceb0: 7472 6169 6e5f 7465 7374 5f73 706c 6974  train_test_split
-0006cec0: 0d0a 696d 706f 7274 206e 756d 7079 2061  ..import numpy a
-0006ced0: 7320 6e70 0d0a 6672 6f6d 2073 6b6c 6561  s np..from sklea
-0006cee0: 726e 2e6d 6574 7269 6373 2069 6d70 6f72  rn.metrics impor
-0006cef0: 7420 6631 5f73 636f 7265 0d0a 696d 706f  t f1_score..impo
-0006cf00: 7274 2063 6f70 790d 0a69 6d70 6f72 7420  rt copy..import 
-0006cf10: 6d61 7470 6c6f 746c 6962 2e70 7970 6c6f  matplotlib.pyplo
-0006cf20: 7420 6173 2070 6c74 0d0a 6672 6f6d 2069  t as plt..from i
-0006cf30: 6e73 7065 6374 2069 6d70 6f72 7420 7369  nspect import si
-0006cf40: 676e 6174 7572 650d 0a66 726f 6d20 736b  gnature..from sk
-0006cf50: 6c65 6172 6e2e 7072 6570 726f 6365 7373  learn.preprocess
-0006cf60: 696e 6720 696d 706f 7274 206c 6162 656c  ing import label
-0006cf70: 5f62 696e 6172 697a 650d 0a66 726f 6d20  _binarize..from 
-0006cf80: 736b 6c65 6172 6e2e 6d65 7472 6963 7320  sklearn.metrics 
-0006cf90: 696d 706f 7274 2070 7265 6369 7369 6f6e  import precision
-0006cfa0: 5f72 6563 616c 6c5f 6375 7276 650d 0a66  _recall_curve..f
-0006cfb0: 726f 6d20 736b 6c65 6172 6e2e 6d65 7472  rom sklearn.metr
-0006cfc0: 6963 7320 696d 706f 7274 2061 7665 7261  ics import avera
-0006cfd0: 6765 5f70 7265 6369 7369 6f6e 5f73 636f  ge_precision_sco
-0006cfe0: 7265 0d0a 6672 6f6d 2069 7465 7274 6f6f  re..from itertoo
-0006cff0: 6c73 2069 6d70 6f72 7420 6379 636c 650d  ls import cycle.
-0006d000: 0a23 2323 2323 2323 2323 2323 2323 2323  .###############
-0006d010: 2323 2323 2323 2323 2323 2323 2323 2323  ################
-0006d020: 2323 2323 2323 2323 2323 2323 2323 2323  ################
-0006d030: 2323 2323 2323 2323 2323 2323 2323 2323  ################
-0006d040: 2323 2323 2323 2323 2323 2323 2323 2323  ################
-0006d050: 2323 2323 2323 2323 2323 2323 2323 0d0a  ##############..
-0006d060: 6465 6620 6d75 6c74 695f 6631 2874 7275  def multi_f1(tru
-0006d070: 7468 2c20 7072 6564 6963 7469 6f6e 7329  th, predictions)
-0006d080: 3a0d 0a20 2020 2072 6574 7572 6e20 6631  :..    return f1
-0006d090: 5f73 636f 7265 2874 7275 7468 2c20 7072  _score(truth, pr
-0006d0a0: 6564 6963 7469 6f6e 732c 6176 6572 6167  edictions,averag
-0006d0b0: 653d 4e6f 6e65 290d 0a64 6566 206d 756c  e=None)..def mul
-0006d0c0: 7469 5f70 7265 6369 7369 6f6e 2874 7275  ti_precision(tru
-0006d0d0: 7468 2c20 7072 6564 6963 7469 6f6e 7329  th, predictions)
-0006d0e0: 3a0d 0a20 2020 2072 6574 7572 6e20 7072  :..    return pr
-0006d0f0: 6563 6973 696f 6e5f 7363 6f72 6528 7472  ecision_score(tr
-0006d100: 7574 682c 2070 7265 6469 6374 696f 6e73  uth, predictions
-0006d110: 2c61 7665 7261 6765 3d4e 6f6e 6529 0d0a  ,average=None)..
-0006d120: 2323 2323 2323 2323 2323 2323 2323 2323  ################
-0006d130: 2323 2323 2323 2323 2323 2323 2323 2323  ################
-0006d140: 2323 2323 2323 2323 2323 2323 2323 2323  ################
-0006d150: 2323 2323 2323 2323 2323 2323 2323 2323  ################
-0006d160: 2323 2323 2323 2323 2323 2323 2323 2323  ################
-0006d170: 2323 2323 2323 2323 2323 2323 2323 0d0a  ##############..
-0006d180: 6465 6620 4472 6177 5f4d 435f 4d4c 5f50  def Draw_MC_ML_P
-0006d190: 525f 524f 435f 4375 7276 6573 2863 6c61  R_ROC_Curves(cla
-0006d1a0: 7373 6966 6965 722c 585f 7465 7374 2c79  ssifier,X_test,y
-0006d1b0: 5f74 6573 7429 3a0d 0a20 2020 2022 2222  _test):..    """
-0006d1c0: 0d0a 2020 2020 3d3d 3d3d 3d3d 3d3d 3d3d  ..    ==========
-0006d1d0: 3d3d 3d3d 3d3d 3d3d 3d3d 3d3d 3d3d 3d3d  ================
-0006d1e0: 3d3d 3d3d 3d3d 3d3d 3d3d 3d3d 3d3d 3d3d  ================
-0006d1f0: 3d3d 3d3d 3d3d 3d3d 3d3d 3d3d 3d3d 3d3d  ================
-0006d200: 3d3d 3d3d 3d3d 3d3d 3d3d 3d3d 3d3d 3d3d  ================
-0006d210: 3d3d 3d3d 3d3d 3d3d 3d3d 3d3d 3d3d 0d0a  ==============..
-0006d220: 2020 2020 5072 6563 6973 696f 6e2d 5265      Precision-Re
-0006d230: 6361 6c6c 2043 7572 7665 733a 2045 7874  call Curves: Ext
-0006d240: 656e 7369 6f6e 206f 6620 4f72 6967 696e  ension of Origin
-0006d250: 616c 2056 6572 7369 6f6e 2069 6e20 534b  al Version in SK
-0006d260: 4c65 6172 6e27 7320 446f 6375 6d65 6e74  Learn's Document
-0006d270: 6174 696f 6e20 5061 6765 3a0d 0a20 2020  ation Page:..   
-0006d280: 2068 7474 7073 3a2f 2f73 6369 6b69 742d   https://scikit-
-0006d290: 6c65 6172 6e2e 6f72 672f 7374 6162 6c65  learn.org/stable
-0006d2a0: 2f61 7574 6f5f 6578 616d 706c 6573 2f6d  /auto_examples/m
-0006d2b0: 6f64 656c 5f73 656c 6563 7469 6f6e 2f70  odel_selection/p
-0006d2c0: 6c6f 745f 7072 6563 6973 696f 6e5f 7265  lot_precision_re
-0006d2d0: 6361 6c6c 2e68 746d 6c0d 0a20 2020 203d  call.html..    =
-0006d2e0: 3d3d 3d3d 3d3d 3d3d 3d3d 3d3d 3d3d 3d3d  ================
-0006d2f0: 3d3d 3d3d 3d3d 3d3d 3d3d 3d3d 3d3d 3d3d  ================
-0006d300: 3d3d 3d3d 3d3d 3d3d 3d3d 3d3d 3d3d 3d3d  ================
-0006d310: 3d3d 3d3d 3d3d 3d3d 3d3d 3d3d 3d3d 3d3d  ================
-0006d320: 3d3d 3d3d 3d3d 3d3d 3d3d 3d3d 3d3d 3d3d  ================
-0006d330: 3d3d 3d3d 3d3d 3d0d 0a20 2020 2022 2222  =======..    """
-0006d340: 0d0a 2020 2020 6669 6773 697a 6520 3d20  ..    figsize = 
-0006d350: 2831 302c 2036 290d 0a20 2020 2023 2323  (10, 6)..    ###
-0006d360: 2323 2323 2323 2323 2323 2323 2323 2323  ################
-0006d370: 2323 2323 2323 2323 2323 2323 2323 2323  ################
-0006d380: 2323 2323 2323 2323 2323 2323 2323 2323  ################
-0006d390: 2323 2323 2323 2323 2323 2323 2323 2323  ################
-0006d3a0: 2323 2323 2323 2323 2323 2323 0d0a 2020  ############..  
-0006d3b0: 2020 2320 496e 2062 696e 6172 7920 636c    # In binary cl
-0006d3c0: 6173 7369 6669 6361 7469 6f6e 2073 6574  assification set
-0006d3d0: 7469 6e67 730d 0a20 2020 2023 2043 6f6d  tings..    # Com
-0006d3e0: 7075 7465 2074 6865 2061 7665 7261 6765  pute the average
-0006d3f0: 2070 7265 6369 7369 6f6e 2073 636f 7265   precision score
-0006d400: 2066 6f72 2042 696e 6172 7920 436c 6173   for Binary Clas
-0006d410: 7365 730d 0a20 2020 2023 2323 2323 2323  ses..    #######
-0006d420: 2323 2323 2323 2323 2323 2323 2323 2323  ################
-0006d430: 2323 2323 2323 2323 2323 2323 2323 2323  ################
-0006d440: 2323 2323 2323 2323 2323 2323 2323 2323  ################
-0006d450: 2323 2323 2323 2323 2323 2323 2323 2323  ################
-0006d460: 2323 2323 2323 2323 0d0a 2020 2020 795f  ########..    y_
-0006d470: 7072 6564 203d 2063 6c61 7373 6966 6965  pred = classifie
-0006d480: 722e 7072 6564 6963 7428 585f 7465 7374  r.predict(X_test
-0006d490: 290d 0a20 2020 2069 6620 6c65 6e28 6c65  )..    if len(le
-0006d4a0: 6674 5f73 7562 7472 6163 7428 6e70 2e75  ft_subtract(np.u
-0006d4b0: 6e69 7175 6528 795f 7465 7374 292c 6e70  nique(y_test),np
-0006d4c0: 2e75 6e69 7175 6528 795f 7072 6564 2929  .unique(y_pred))
-0006d4d0: 2920 3d3d 2030 3a0d 0a20 2020 2020 2020  ) == 0:..       
-0006d4e0: 2063 6c61 7373 6573 203d 206c 6973 7428   classes = list(
-0006d4f0: 7261 6e67 6528 6c65 6e28 6e70 2e75 6e69  range(len(np.uni
-0006d500: 7175 6528 795f 7465 7374 2929 2929 0d0a  que(y_test))))..
-0006d510: 2020 2020 656c 7365 3a0d 0a20 2020 2020      else:..     
-0006d520: 2020 2063 6c61 7373 6573 203d 206c 6973     classes = lis
-0006d530: 7428 7261 6e67 6528 6c65 6e28 6e70 2e75  t(range(len(np.u
-0006d540: 6e69 7175 6528 795f 7072 6564 2929 2929  nique(y_pred))))
-0006d550: 0d0a 2020 2020 2363 6c61 7373 6573 203d  ..    #classes =
-0006d560: 206c 6973 7428 7261 6e67 6528 6c65 6e28   list(range(len(
-0006d570: 6e70 2e75 6e69 7175 6528 795f 7465 7374  np.unique(y_test
-0006d580: 2929 2929 0d0a 2020 2020 6e5f 636c 6173  ))))..    n_clas
-0006d590: 7365 7320 3d20 6c65 6e28 636c 6173 7365  ses = len(classe
-0006d5a0: 7329 0d0a 2020 2020 6966 206e 5f63 6c61  s)..    if n_cla
-0006d5b0: 7373 6573 203d 3d20 323a 0d0a 2020 2020  sses == 2:..    
-0006d5c0: 2020 2020 7472 793a 0d0a 2020 2020 2020      try:..      
-0006d5d0: 2020 2020 2020 795f 7363 6f72 6520 3d20        y_score = 
-0006d5e0: 636c 6173 7369 6669 6572 2e64 6563 6973  classifier.decis
-0006d5f0: 696f 6e5f 6675 6e63 7469 6f6e 2858 5f74  ion_function(X_t
-0006d600: 6573 7429 0d0a 2020 2020 2020 2020 6578  est)..        ex
-0006d610: 6365 7074 3a0d 0a20 2020 2020 2020 2020  cept:..         
-0006d620: 2020 2079 5f73 636f 7265 203d 2063 6c61     y_score = cla
-0006d630: 7373 6966 6965 722e 7072 6564 6963 745f  ssifier.predict_
-0006d640: 7072 6f62 6128 585f 7465 7374 290d 0a20  proba(X_test).. 
-0006d650: 2020 2020 2020 2074 7279 3a0d 0a20 2020         try:..   
-0006d660: 2020 2020 2020 2020 2061 7665 7261 6765           average
-0006d670: 5f70 7265 6369 7369 6f6e 203d 2061 7665  _precision = ave
-0006d680: 7261 6765 5f70 7265 6369 7369 6f6e 5f73  rage_precision_s
-0006d690: 636f 7265 2879 5f74 6573 742c 2079 5f73  core(y_test, y_s
-0006d6a0: 636f 7265 290d 0a20 2020 2020 2020 2065  core)..        e
-0006d6b0: 7863 6570 743a 0d0a 2020 2020 2020 2020  xcept:..        
-0006d6c0: 2020 2020 6176 6572 6167 655f 7072 6563      average_prec
-0006d6d0: 6973 696f 6e20 3d20 6d75 6c74 695f 7072  ision = multi_pr
-0006d6e0: 6563 6973 696f 6e28 795f 7465 7374 2c20  ecision(y_test, 
-0006d6f0: 636c 6173 7369 6669 6572 2e70 7265 6469  classifier.predi
-0006d700: 6374 2858 5f74 6573 7429 292e 6d65 616e  ct(X_test)).mean
-0006d710: 2829 0d0a 2020 2020 2020 2020 7072 696e  ()..        prin
-0006d720: 7428 2741 7665 7261 6765 2070 7265 6369  t('Average preci
-0006d730: 7369 6f6e 2d72 6563 616c 6c20 7363 6f72  sion-recall scor
-0006d740: 653a 207b 303a 302e 3266 7d27 2e66 6f72  e: {0:0.2f}'.for
-0006d750: 6d61 7428 0d0a 2020 2020 2020 2020 2020  mat(..          
-0006d760: 2020 2020 6176 6572 6167 655f 7072 6563      average_prec
-0006d770: 6973 696f 6e29 290d 0a20 2020 2020 2020  ision))..       
-0006d780: 2066 5f73 636f 7265 7320 3d20 6d75 6c74   f_scores = mult
-0006d790: 695f 6631 2879 5f74 6573 742c 636c 6173  i_f1(y_test,clas
-0006d7a0: 7369 6669 6572 2e70 7265 6469 6374 2858  sifier.predict(X
-0006d7b0: 5f74 6573 7429 290d 0a20 2020 2020 2020  _test))..       
-0006d7c0: 2070 7269 6e74 2827 4d61 6372 6f20 4631   print('Macro F1
-0006d7d0: 2073 636f 7265 2c20 6176 6572 6167 6564   score, averaged
-0006d7e0: 206f 7665 7220 616c 6c20 636c 6173 7365   over all classe
-0006d7f0: 733a 207b 303a 302e 3266 7d27 0d0a 2020  s: {0:0.2f}'..  
-0006d800: 2020 2020 2020 2020 2020 2020 2e66 6f72              .for
-0006d810: 6d61 7428 665f 7363 6f72 6573 2e6d 6561  mat(f_scores.mea
-0006d820: 6e28 2929 290d 0a20 2020 2020 2020 2023  n()))..        #
-0006d830: 2323 2323 2323 2323 2323 2323 2323 2323  ################
-0006d840: 2323 2323 2323 2323 2323 2323 2323 2323  ################
-0006d850: 2323 2323 2323 2323 2323 2323 2323 2323  ################
-0006d860: 2323 2323 2323 2323 2323 2323 2323 2323  ################
-0006d870: 2323 2323 2323 2323 2323 2323 2323 0d0a  ##############..
-0006d880: 2020 2020 2020 2020 2320 506c 6f74 2074          # Plot t
-0006d890: 6865 2050 7265 6369 7369 6f6e 2d52 6563  he Precision-Rec
-0006d8a0: 616c 6c20 6375 7276 650d 0a20 2020 2020  all curve..     
-0006d8b0: 2020 2023 202e 2e2e 2e2e 2e2e 2e2e 2e2e     # ...........
-0006d8c0: 2e2e 2e2e 2e2e 2e2e 2e2e 2e2e 2e2e 2e2e  ................
-0006d8d0: 2e2e 2e2e 2e0d 0a20 2020 2020 2020 2070  .......        p
-0006d8e0: 6c74 2e66 6967 7572 6528 6669 6773 697a  lt.figure(figsiz
-0006d8f0: 653d 6669 6773 697a 6529 0d0a 2020 2020  e=figsize)..    
-0006d900: 2020 2020 7472 793a 0d0a 2020 2020 2020      try:..      
-0006d910: 2020 2020 2020 2323 2320 5468 6973 2077        ### This w
-0006d920: 6f72 6b73 2066 6f72 204c 6f67 6973 7469  orks for Logisti
-0006d930: 6320 5265 6772 6573 7369 6f6e 2061 6e64  c Regression and
-0006d940: 206f 7468 6572 204c 696e 6561 7220 4d6f   other Linear Mo
-0006d950: 6465 6c73 2023 2323 230d 0a20 2020 2020  dels ####..     
-0006d960: 2020 2020 2020 2070 7265 6369 7369 6f6e         precision
-0006d970: 2c20 7265 6361 6c6c 2c20 5f20 3d20 7072  , recall, _ = pr
-0006d980: 6563 6973 696f 6e5f 7265 6361 6c6c 5f63  ecision_recall_c
-0006d990: 7572 7665 2879 5f74 6573 742c 2079 5f73  urve(y_test, y_s
-0006d9a0: 636f 7265 290d 0a20 2020 2020 2020 2065  core)..        e
-0006d9b0: 7863 6570 743a 0d0a 2020 2020 2020 2020  xcept:..        
-0006d9c0: 2020 2020 2323 2320 5468 6973 2077 6f72      ### This wor
-0006d9d0: 6b73 2066 6f72 204e 6f6e 204c 696e 6561  ks for Non Linea
-0006d9e0: 7220 4d6f 6465 6c73 2073 7563 6820 6173  r Models such as
-0006d9f0: 2046 6f72 6573 7473 2061 6e64 2058 4742   Forests and XGB
-0006da00: 6f6f 7374 2023 2323 2323 0d0a 2020 2020  oost #####..    
-0006da10: 2020 2020 2020 2020 7072 6563 6973 696f          precisio
-0006da20: 6e2c 2072 6563 616c 6c2c 205f 203d 2070  n, recall, _ = p
-0006da30: 7265 6369 7369 6f6e 5f72 6563 616c 6c5f  recision_recall_
-0006da40: 6375 7276 6528 795f 7465 7374 2c20 795f  curve(y_test, y_
-0006da50: 7363 6f72 655b 3a2c 315d 290d 0a0d 0a20  score[:,1]).... 
-0006da60: 2020 2020 2020 2023 2049 6e20 6d61 7470         # In matp
-0006da70: 6c6f 746c 6962 203c 2031 2e35 2c20 706c  lotlib < 1.5, pl
-0006da80: 742e 6669 6c6c 5f62 6574 7765 656e 2064  t.fill_between d
-0006da90: 6f65 7320 6e6f 7420 6861 7665 2061 2027  oes not have a '
-0006daa0: 7374 6570 2720 6172 6775 6d65 6e74 0d0a  step' argument..
-0006dab0: 2020 2020 2020 2020 7374 6570 5f6b 7761          step_kwa
-0006dac0: 7267 7320 3d20 287b 2773 7465 7027 3a20  rgs = ({'step': 
-0006dad0: 2770 6f73 7427 7d0d 0a20 2020 2020 2020  'post'}..       
-0006dae0: 2020 2020 2020 2020 2020 2020 2020 2020                  
-0006daf0: 6966 2027 7374 6570 2720 696e 2073 6967  if 'step' in sig
-0006db00: 6e61 7475 7265 2870 6c74 2e66 696c 6c5f  nature(plt.fill_
-0006db10: 6265 7477 6565 6e29 2e70 6172 616d 6574  between).paramet
-0006db20: 6572 730d 0a20 2020 2020 2020 2020 2020  ers..           
-0006db30: 2020 2020 2020 2020 2020 2020 656c 7365              else
-0006db40: 207b 7d29 0d0a 2020 2020 2020 2020 706c   {})..        pl
-0006db50: 742e 7374 6570 2872 6563 616c 6c2c 2070  t.step(recall, p
-0006db60: 7265 6369 7369 6f6e 2c20 636f 6c6f 723d  recision, color=
-0006db70: 2767 272c 2061 6c70 6861 3d30 2e32 2c0d  'g', alpha=0.2,.
-0006db80: 0a20 2020 2020 2020 2020 2020 2020 2020  .               
-0006db90: 2020 7768 6572 653d 2770 6f73 7427 290d    where='post').
-0006dba0: 0a20 2020 2020 2020 2070 6c74 2e66 696c  .        plt.fil
-0006dbb0: 6c5f 6265 7477 6565 6e28 7265 6361 6c6c  l_between(recall
-0006dbc0: 2c20 7072 6563 6973 696f 6e2c 2061 6c70  , precision, alp
-0006dbd0: 6861 3d30 2e32 2c20 636f 6c6f 723d 2767  ha=0.2, color='g
-0006dbe0: 272c 202a 2a73 7465 705f 6b77 6172 6773  ', **step_kwargs
-0006dbf0: 290d 0a0d 0a20 2020 2020 2020 2070 6c74  )....        plt
-0006dc00: 2e78 6c61 6265 6c28 2752 6563 616c 6c27  .xlabel('Recall'
-0006dc10: 290d 0a20 2020 2020 2020 2070 6c74 2e79  )..        plt.y
-0006dc20: 6c61 6265 6c28 2750 7265 6369 7369 6f6e  label('Precision
-0006dc30: 2729 0d0a 2020 2020 2020 2020 706c 742e  ')..        plt.
-0006dc40: 796c 696d 285b 302e 302c 2031 2e30 355d  ylim([0.0, 1.05]
-0006dc50: 290d 0a20 2020 2020 2020 2070 6c74 2e78  )..        plt.x
-0006dc60: 6c69 6d28 5b30 2e30 2c20 312e 305d 290d  lim([0.0, 1.0]).
-0006dc70: 0a20 2020 2020 2020 2070 6c74 2e74 6974  .        plt.tit
-0006dc80: 6c65 2827 5072 6563 6973 696f 6e2d 5265  le('Precision-Re
-0006dc90: 6361 6c6c 2063 7572 7665 3a20 4176 672e  call curve: Avg.
-0006dca0: 5072 6563 6973 696f 6e3d 7b30 3a30 2e32  Precision={0:0.2
-0006dcb0: 667d 2c20 4176 6720 4631 3d7b 313a 302e  f}, Avg F1={1:0.
-0006dcc0: 3266 7d27 2e66 6f72 6d61 7428 0d0a 2020  2f}'.format(..  
-0006dcd0: 2020 2020 2020 2020 2020 2020 2020 2020                  
-0006dce0: 6176 6572 6167 655f 7072 6563 6973 696f  average_precisio
-0006dcf0: 6e2c 665f 7363 6f72 6573 2e6d 6561 6e28  n,f_scores.mean(
-0006dd00: 2929 290d 0a20 2020 2020 2020 2070 6c74  )))..        plt
-0006dd10: 2e73 686f 7728 293b 0d0a 2020 2020 2020  .show();..      
-0006dd20: 2020 2323 2323 2323 2323 2323 2323 2323    ##############
-0006dd30: 2323 2323 2323 2323 2323 2323 2323 2323  ################
-0006dd40: 2323 2323 2323 2323 2323 2323 2323 2323  ################
-0006dd50: 2323 2323 2323 2323 2323 2323 2323 2323  ################
-0006dd60: 2323 2323 2323 2323 2323 2323 2323 2323  ################
-0006dd70: 230d 0a20 2020 2065 6c73 653a 0d0a 2020  #..    else:..  
-0006dd80: 2020 2020 2020 2320 496e 206d 756c 7469        # In multi
-0006dd90: 2d6c 6162 656c 2073 6574 7469 6e67 730d  -label settings.
-0006dda0: 0a20 2020 2020 2020 2023 202d 2d2d 2d2d  .        # -----
-0006ddb0: 2d2d 2d2d 2d2d 2d2d 2d2d 2d2d 2d2d 2d2d  ----------------
-0006ddc0: 2d2d 2d0d 0a20 2020 2020 2020 2023 0d0a  ---..        #..
-0006ddd0: 2020 2020 2020 2020 2320 4372 6561 7465          # Create
-0006dde0: 206d 756c 7469 2d6c 6162 656c 2064 6174   multi-label dat
-0006ddf0: 612c 2066 6974 2c20 616e 6420 7072 6564  a, fit, and pred
-0006de00: 6963 740d 0a20 2020 2020 2020 2023 202e  ict..        # .
-0006de10: 2e2e 2e2e 2e2e 2e2e 2e2e 2e2e 2e2e 2e2e  ................
-0006de20: 2e2e 2e2e 2e2e 2e2e 2e2e 2e2e 2e2e 2e2e  ................
-0006de30: 2e2e 2e2e 2e2e 2e2e 2e2e 0d0a 2020 2020  ............    
-0006de40: 2020 2020 230d 0a20 2020 2020 2020 2023      #..        #
-0006de50: 2057 6520 6372 6561 7465 2061 206d 756c   We create a mul
-0006de60: 7469 2d6c 6162 656c 2064 6174 6173 6574  ti-label dataset
-0006de70: 2c20 746f 2069 6c6c 7573 7472 6174 6520  , to illustrate 
-0006de80: 7468 6520 7072 6563 6973 696f 6e2d 7265  the precision-re
-0006de90: 6361 6c6c 2069 6e0d 0a20 2020 2020 2020  call in..       
-0006dea0: 2023 206d 756c 7469 2d6c 6162 656c 2073   # multi-label s
-0006deb0: 6574 7469 6e67 730d 0a0d 0a20 2020 2020  ettings....     
-0006dec0: 2020 2023 2055 7365 206c 6162 656c 5f62     # Use label_b
-0006ded0: 696e 6172 697a 6520 746f 2062 6520 6d75  inarize to be mu
-0006dee0: 6c74 692d 6c61 6265 6c20 6c69 6b65 2073  lti-label like s
-0006def0: 6574 7469 6e67 730d 0a20 2020 2020 2020  ettings..       
-0006df00: 2059 203d 206c 6162 656c 5f62 696e 6172   Y = label_binar
-0006df10: 697a 6528 795f 7465 7374 2c20 636c 6173  ize(y_test, clas
-0006df20: 7365 7329 0d0a 2020 2020 2020 2020 6e5f  ses)..        n_
-0006df30: 636c 6173 7365 7320 3d20 592e 7368 6170  classes = Y.shap
-0006df40: 655b 315d 0d0a 2020 2020 2020 2020 595f  e[1]..        Y_
-0006df50: 7465 7374 203d 2063 6f70 792e 6465 6570  test = copy.deep
-0006df60: 636f 7079 2859 290d 0a20 2020 2020 2020  copy(Y)..       
-0006df70: 2074 7279 3a0d 0a20 2020 2020 2020 2020   try:..         
-0006df80: 2020 2079 5f73 636f 7265 203d 2063 6c61     y_score = cla
-0006df90: 7373 6966 6965 722e 6465 6369 7369 6f6e  ssifier.decision
-0006dfa0: 5f66 756e 6374 696f 6e28 585f 7465 7374  _function(X_test
-0006dfb0: 290d 0a20 2020 2020 2020 2065 7863 6570  )..        excep
-0006dfc0: 743a 0d0a 2020 2020 2020 2020 2020 2020  t:..            
-0006dfd0: 795f 7363 6f72 6520 3d20 636c 6173 7369  y_score = classi
-0006dfe0: 6669 6572 2e70 7265 6469 6374 5f70 726f  fier.predict_pro
-0006dff0: 6261 2858 5f74 6573 7429 0d0a 0d0a 2020  ba(X_test)....  
-0006e000: 2020 2020 2020 2323 2323 2323 2323 2323        ##########
-0006e010: 2323 2323 2323 2323 2323 2323 2323 2323  ################
-0006e020: 2323 2323 2323 2323 2323 2323 2323 2323  ################
-0006e030: 2323 2323 2323 2323 2323 2323 2323 2323  ################
-0006e040: 2323 2323 2323 2323 2323 2323 2323 2323  ################
-0006e050: 2323 2323 230d 0a20 2020 2020 2020 2023  #####..        #
-0006e060: 2054 6865 2061 7665 7261 6765 2070 7265   The average pre
-0006e070: 6369 7369 6f6e 2073 636f 7265 2069 6e20  cision score in 
-0006e080: 6d75 6c74 692d 6c61 6265 6c20 7365 7474  multi-label sett
-0006e090: 696e 6773 0d0a 2020 2020 2020 2020 2320  ings..        # 
-0006e0a0: 2e2e 2e2e 2e2e 2e2e 2e2e 2e2e 2e2e 2e2e  ................
-0006e0b0: 2e2e 2e2e 2e2e 2e2e 2e2e 2e2e 2e2e 2e2e  ................
-0006e0c0: 2e2e 2e2e 2e2e 2e2e 2e2e 2e2e 2e2e 2e2e  ................
-0006e0d0: 2e2e 2e2e 0d0a 0d0a 2020 2020 2020 2020  ........        
-0006e0e0: 2320 466f 7220 6561 6368 2063 6c61 7373  # For each class
-0006e0f0: 0d0a 2020 2020 2020 2020 7072 6563 6973  ..        precis
-0006e100: 696f 6e20 3d20 6469 6374 2829 0d0a 2020  ion = dict()..  
-0006e110: 2020 2020 2020 7265 6361 6c6c 203d 2064        recall = d
-0006e120: 6963 7428 290d 0a20 2020 2020 2020 2061  ict()..        a
-0006e130: 7665 7261 6765 5f70 7265 6369 7369 6f6e  verage_precision
-0006e140: 203d 2064 6963 7428 290d 0a20 2020 2020   = dict()..     
-0006e150: 2020 2066 6f72 2069 2069 6e20 7261 6e67     for i in rang
-0006e160: 6528 6e5f 636c 6173 7365 7329 3a0d 0a20  e(n_classes):.. 
-0006e170: 2020 2020 2020 2020 2020 2070 7265 6369             preci
-0006e180: 7369 6f6e 5b69 5d2c 2072 6563 616c 6c5b  sion[i], recall[
-0006e190: 695d 2c20 5f20 3d20 7072 6563 6973 696f  i], _ = precisio
-0006e1a0: 6e5f 7265 6361 6c6c 5f63 7572 7665 2859  n_recall_curve(Y
-0006e1b0: 5f74 6573 745b 3a2c 2069 5d2c 0d0a 2020  _test[:, i],..  
-0006e1c0: 2020 2020 2020 2020 2020 2020 2020 2020                  
-0006e1d0: 2020 2020 2020 2020 2020 2020 2020 2020                  
-0006e1e0: 2020 2020 2020 2020 2020 2020 2020 2020                  
-0006e1f0: 2020 2020 2020 2020 2020 2020 2020 795f                y_
-0006e200: 7363 6f72 655b 3a2c 2069 5d29 0d0a 2020  score[:, i])..  
-0006e210: 2020 2020 2020 2020 2020 6176 6572 6167            averag
-0006e220: 655f 7072 6563 6973 696f 6e5b 695d 203d  e_precision[i] =
-0006e230: 2061 7665 7261 6765 5f70 7265 6369 7369   average_precisi
-0006e240: 6f6e 5f73 636f 7265 2859 5f74 6573 745b  on_score(Y_test[
-0006e250: 3a2c 2069 5d2c 2079 5f73 636f 7265 5b3a  :, i], y_score[:
-0006e260: 2c20 695d 290d 0a0d 0a20 2020 2020 2020  , i])....       
-0006e270: 2023 2041 2022 6d69 6372 6f2d 6176 6572   # A "micro-aver
-0006e280: 6167 6522 3a20 7175 616e 7469 6679 696e  age": quantifyin
-0006e290: 6720 7363 6f72 6520 6f6e 2061 6c6c 2063  g score on all c
-0006e2a0: 6c61 7373 6573 206a 6f69 6e74 6c79 0d0a  lasses jointly..
-0006e2b0: 2020 2020 2020 2020 7072 6563 6973 696f          precisio
-0006e2c0: 6e5b 226d 6963 726f 225d 2c20 7265 6361  n["micro"], reca
-0006e2d0: 6c6c 5b22 6d69 6372 6f22 5d2c 205f 203d  ll["micro"], _ =
-0006e2e0: 2070 7265 6369 7369 6f6e 5f72 6563 616c   precision_recal
-0006e2f0: 6c5f 6375 7276 6528 595f 7465 7374 5b0d  l_curve(Y_test[.
-0006e300: 0a20 2020 2020 2020 2020 2020 2020 2020  .               
-0006e310: 2020 2020 2020 2020 203a 2c3a 6e5f 636c           :,:n_cl
-0006e320: 6173 7365 735d 2e72 6176 656c 2829 2c79  asses].ravel(),y
-0006e330: 5f73 636f 7265 5b3a 2c3a 6e5f 636c 6173  _score[:,:n_clas
-0006e340: 7365 735d 2e72 6176 656c 2829 290d 0a20  ses].ravel()).. 
-0006e350: 2020 2020 2020 2061 7665 7261 6765 5f70         average_p
-0006e360: 7265 6369 7369 6f6e 5b22 6d69 6372 6f22  recision["micro"
-0006e370: 5d20 3d20 6176 6572 6167 655f 7072 6563  ] = average_prec
-0006e380: 6973 696f 6e5f 7363 6f72 6528 595f 7465  ision_score(Y_te
-0006e390: 7374 5b0d 0a20 2020 2020 2020 2020 2020  st[..           
-0006e3a0: 2020 2020 2020 2020 2020 2020 203a 2c3a               :,:
-0006e3b0: 6e5f 636c 6173 7365 735d 2c20 795f 7363  n_classes], y_sc
-0006e3c0: 6f72 655b 3a2c 3a6e 5f63 6c61 7373 6573  ore[:,:n_classes
-0006e3d0: 5d2c 6176 6572 6167 653d 226d 6963 726f  ],average="micro
-0006e3e0: 2229 0d0a 2020 2020 2020 2020 7072 696e  ")..        prin
-0006e3f0: 7428 2741 7665 7261 6765 2070 7265 6369  t('Average preci
-0006e400: 7369 6f6e 2073 636f 7265 2c20 6d69 6372  sion score, micr
-0006e410: 6f2d 6176 6572 6167 6564 206f 7665 7220  o-averaged over 
-0006e420: 616c 6c20 636c 6173 7365 733a 207b 303a  all classes: {0:
-0006e430: 302e 3266 7d27 0d0a 2020 2020 2020 2020  0.2f}'..        
-0006e440: 2020 2020 2020 2e66 6f72 6d61 7428 6176        .format(av
-0006e450: 6572 6167 655f 7072 6563 6973 696f 6e5b  erage_precision[
-0006e460: 226d 6963 726f 225d 2929 0d0a 0d0a 2020  "micro"]))....  
-0006e470: 2020 2020 2020 2323 2323 2323 2323 2323        ##########
-0006e480: 2323 2323 2323 2323 2323 2323 2323 2323  ################
-0006e490: 2323 2323 2323 2323 2323 2323 2323 2323  ################
-0006e4a0: 2323 2323 2323 2323 2323 2323 2323 2323  ################
+00069560: 2323 2323 2323 2323 2323 2323 2323 2323  ################
+00069570: 2323 2323 2323 2323 2323 2323 2323 2323  ################
+00069580: 2323 2323 2323 0d0a 2020 2020 2020 2020  ######..        
+00069590: 6966 2074 7363 6f6c 2b27 5f64 6179 6f66  if tscol+'_dayof
+000695a0: 7765 656b 2720 696e 2064 745f 6164 6473  week' in dt_adds
+000695b0: 3a0d 0a20 2020 2020 2020 2020 2020 2064  :..            d
+000695c0: 662e 6c6f 635b 3a2c 7473 636f 6c2b 275f  f.loc[:,tscol+'_
+000695d0: 6d6f 6e74 685f 6461 796f 6677 6565 6b5f  month_dayofweek_
+000695e0: 6372 6f73 7327 5d20 3d20 6466 5b74 7363  cross'] = df[tsc
+000695f0: 6f6c 2b27 5f6d 6f6e 7468 275d 202b 2220  ol+'_month'] +" 
+00069600: 222b 2064 665b 7473 636f 6c2b 275f 6461  "+ df[tscol+'_da
+00069610: 796f 6677 6565 6b27 5d0d 0a20 2020 2020  yofweek']..     
+00069620: 2020 2020 2020 2064 745f 6164 6473 2e61         dt_adds.a
+00069630: 7070 656e 6428 7473 636f 6c2b 275f 6d6f  ppend(tscol+'_mo
+00069640: 6e74 685f 6461 796f 6677 6565 6b5f 6372  nth_dayofweek_cr
+00069650: 6f73 7327 290d 0a20 2020 2020 2020 2064  oss')..        d
+00069660: 665b 7473 636f 6c2b 275f 7965 6172 275d  f[tscol+'_year']
+00069670: 203d 2064 665b 7473 636f 6c5d 2e64 742e   = df[tscol].dt.
+00069680: 7965 6172 2e66 696c 6c6e 6128 3029 2e61  year.fillna(0).a
+00069690: 7374 7970 6528 696e 7429 0d0a 2020 2020  stype(int)..    
+000696a0: 2020 2020 6474 5f61 6464 732e 6170 7065      dt_adds.appe
+000696b0: 6e64 2874 7363 6f6c 2b27 5f79 6561 7227  nd(tscol+'_year'
+000696c0: 290d 0a20 2020 2020 2020 2074 6f64 6179  )..        today
+000696d0: 203d 2064 6174 652e 746f 6461 7928 290d   = date.today().
+000696e0: 0a20 2020 2020 2020 2064 665b 7473 636f  .        df[tsco
+000696f0: 6c2b 275f 6167 655f 696e 5f79 6561 7273  l+'_age_in_years
+00069700: 275d 203d 2074 6f64 6179 2e79 6561 7220  '] = today.year 
+00069710: 2d20 6466 5b74 7363 6f6c 5d2e 6474 2e79  - df[tscol].dt.y
+00069720: 6561 722e 6669 6c6c 6e61 2830 292e 6173  ear.fillna(0).as
+00069730: 7479 7065 2869 6e74 290d 0a20 2020 2020  type(int)..     
+00069740: 2020 2064 745f 6164 6473 2e61 7070 656e     dt_adds.appen
+00069750: 6428 7473 636f 6c2b 275f 6167 655f 696e  d(tscol+'_age_in
+00069760: 5f79 6561 7273 2729 0d0a 2020 2020 2020  _years')..      
+00069770: 2020 6466 5b74 7363 6f6c 2b27 5f64 6179    df[tscol+'_day
+00069780: 6f66 7965 6172 275d 203d 2064 665b 7473  ofyear'] = df[ts
+00069790: 636f 6c5d 2e64 742e 6461 796f 6679 6561  col].dt.dayofyea
+000697a0: 722e 6669 6c6c 6e61 2830 292e 6173 7479  r.fillna(0).asty
+000697b0: 7065 2869 6e74 290d 0a20 2020 2020 2020  pe(int)..       
+000697c0: 2064 745f 6164 6473 2e61 7070 656e 6428   dt_adds.append(
+000697d0: 7473 636f 6c2b 275f 6461 796f 6679 6561  tscol+'_dayofyea
+000697e0: 7227 290d 0a20 2020 2020 2020 2064 665b  r')..        df[
+000697f0: 7473 636f 6c2b 275f 6461 796f 666d 6f6e  tscol+'_dayofmon
+00069800: 7468 275d 203d 2064 665b 7473 636f 6c5d  th'] = df[tscol]
+00069810: 2e64 742e 6461 792e 6669 6c6c 6e61 2830  .dt.day.fillna(0
+00069820: 292e 6173 7479 7065 2869 6e74 290d 0a20  ).astype(int).. 
+00069830: 2020 2020 2020 2064 745f 6164 6473 2e61         dt_adds.a
+00069840: 7070 656e 6428 7473 636f 6c2b 275f 6461  ppend(tscol+'_da
+00069850: 796f 666d 6f6e 7468 2729 0d0a 2020 2020  yofmonth')..    
+00069860: 2020 2020 6466 5b74 7363 6f6c 2b27 5f77      df[tscol+'_w
+00069870: 6565 6b6f 6679 6561 7227 5d20 3d20 6466  eekofyear'] = df
+00069880: 5b74 7363 6f6c 5d2e 6474 2e77 6565 6b6f  [tscol].dt.weeko
+00069890: 6679 6561 722e 6669 6c6c 6e61 2830 292e  fyear.fillna(0).
+000698a0: 6173 7479 7065 2869 6e74 290d 0a20 2020  astype(int)..   
+000698b0: 2020 2020 2064 745f 6164 6473 2e61 7070       dt_adds.app
+000698c0: 656e 6428 7473 636f 6c2b 275f 7765 656b  end(tscol+'_week
+000698d0: 6f66 7965 6172 2729 0d0a 2020 2020 2020  ofyear')..      
+000698e0: 2020 7765 656b 656e 6473 203d 2028 6466    weekends = (df
+000698f0: 5b74 7363 6f6c 2b27 5f64 6179 6f66 7765  [tscol+'_dayofwe
+00069900: 656b 275d 203d 3d20 2753 6174 2729 207c  ek'] == 'Sat') |
+00069910: 2028 6466 5b74 7363 6f6c 2b27 5f64 6179   (df[tscol+'_day
+00069920: 6f66 7765 656b 275d 203d 3d20 2753 756e  ofweek'] == 'Sun
+00069930: 2729 0d0a 2020 2020 2020 2020 6466 5b74  ')..        df[t
+00069940: 7363 6f6c 2b27 5f74 7970 656f 6664 6179  scol+'_typeofday
+00069950: 275d 203d 2027 7765 656b 6461 7927 0d0a  '] = 'weekday'..
+00069960: 2020 2020 2020 2020 6466 2e6c 6f63 5b77          df.loc[w
+00069970: 6565 6b65 6e64 732c 2074 7363 6f6c 2b27  eekends, tscol+'
+00069980: 5f74 7970 656f 6664 6179 275d 203d 2027  _typeofday'] = '
+00069990: 7765 656b 656e 6427 0d0a 2020 2020 2020  weekend'..      
+000699a0: 2020 6474 5f61 6464 732e 6170 7065 6e64    dt_adds.append
+000699b0: 2874 7363 6f6c 2b27 5f74 7970 656f 6664  (tscol+'_typeofd
+000699c0: 6179 2729 0d0a 2020 2020 2020 2020 6966  ay')..        if
+000699d0: 2074 7363 6f6c 2b27 5f74 7970 656f 6664   tscol+'_typeofd
+000699e0: 6179 2720 696e 2064 745f 6164 6473 3a0d  ay' in dt_adds:.
+000699f0: 0a20 2020 2020 2020 2020 2020 2064 662e  .            df.
+00069a00: 6c6f 635b 3a2c 7473 636f 6c2b 275f 6d6f  loc[:,tscol+'_mo
+00069a10: 6e74 685f 7479 7065 6f66 6461 795f 6372  nth_typeofday_cr
+00069a20: 6f73 7327 5d20 3d20 6466 5b74 7363 6f6c  oss'] = df[tscol
+00069a30: 2b27 5f6d 6f6e 7468 275d 202b 2220 222b  +'_month'] +" "+
+00069a40: 2064 665b 7473 636f 6c2b 275f 7479 7065   df[tscol+'_type
+00069a50: 6f66 6461 7927 5d0d 0a20 2020 2020 2020  ofday']..       
+00069a60: 2020 2020 2064 745f 6164 6473 2e61 7070       dt_adds.app
+00069a70: 656e 6428 7473 636f 6c2b 275f 6d6f 6e74  end(tscol+'_mont
+00069a80: 685f 7479 7065 6f66 6461 795f 6372 6f73  h_typeofday_cros
+00069a90: 7327 290d 0a20 2020 2065 7863 6570 743a  s')..    except:
+00069aa0: 0d0a 2020 2020 2020 2020 7072 696e 7428  ..        print(
+00069ab0: 2720 2020 2045 7272 6f72 2069 6e20 6372  '    Error in cr
+00069ac0: 6561 7469 6e67 2064 6174 6520 7469 6d65  eating date time
+00069ad0: 2064 6572 6976 6564 2066 6561 7475 7265   derived feature
+00069ae0: 732e 2043 6f6e 7469 6e75 696e 672e 2e2e  s. Continuing...
+00069af0: 2729 0d0a 2020 2020 7072 696e 7428 2720  ')..    print(' 
+00069b00: 2020 2041 6464 6564 2025 6420 636f 6c75     Added %d colu
+00069b10: 6d6e 7320 6672 6f6d 2025 7320 636f 6c75  mns from %s colu
+00069b20: 6d6e 2720 2528 6c65 6e28 6474 5f61 6464  mn' %(len(dt_add
+00069b30: 7329 2c74 7363 6f6c 2929 0d0a 2020 2020  s),tscol))..    
+00069b40: 6466 203d 2064 665b 6474 5f61 6464 735d  df = df[dt_adds]
+00069b50: 0d0a 2020 2020 7265 7475 726e 2064 660d  ..    return df.
+00069b60: 0a23 2323 2323 2323 2323 2323 2323 2323  .###############
+00069b70: 2323 2323 2323 2323 2323 2323 2323 2323  ################
+00069b80: 2323 2323 2323 2323 2323 2323 2323 2323  ################
+00069b90: 2323 2323 2323 2323 2323 2323 2323 2323  ################
+00069ba0: 230d 0a66 726f 6d20 6461 7465 7574 696c  #..from dateutil
+00069bb0: 2e72 656c 6174 6976 6564 656c 7461 2069  .relativedelta i
+00069bc0: 6d70 6f72 7420 7265 6c61 7469 7665 6465  mport relativede
+00069bd0: 6c74 610d 0a66 726f 6d20 6461 7465 7469  lta..from dateti
+00069be0: 6d65 2069 6d70 6f72 7420 6461 7465 0d0a  me import date..
+00069bf0: 2323 2323 2320 5468 6973 2069 7320 6120  ##### This is a 
+00069c00: 6c69 7474 6c65 2075 7469 6c69 7479 2074  little utility t
+00069c10: 6861 7420 636f 6d70 7574 6573 2061 6765  hat computes age
+00069c20: 2066 726f 6d20 7965 6172 2023 2323 230d   from year ####.
+00069c30: 0a64 6566 2063 6f6d 7075 7465 5f61 6765  .def compute_age
+00069c40: 2879 6561 725f 7374 7269 6e67 293a 0d0a  (year_string):..
+00069c50: 2020 2020 746f 6461 7920 3d20 6461 7465      today = date
+00069c60: 2e74 6f64 6179 2829 0d0a 2020 2020 6167  .today()..    ag
+00069c70: 6520 3d20 7265 6c61 7469 7665 6465 6c74  e = relativedelt
+00069c80: 6128 746f 6461 792c 2079 6561 725f 7374  a(today, year_st
+00069c90: 7269 6e67 290d 0a20 2020 2072 6574 7572  ring)..    retur
+00069ca0: 6e20 6167 652e 7965 6172 730d 0a23 2323  n age.years..###
+00069cb0: 2323 2323 2323 2323 2323 2323 2323 2323  ################
+00069cc0: 2323 2323 2323 2323 2323 2323 2323 2323  ################
+00069cd0: 2323 2323 2323 2323 2323 2323 2323 2323  ################
+00069ce0: 2323 2323 2323 2323 2323 2323 2323 0d0a  ##############..
+00069cf0: 6465 6620 6372 6561 7465 5f74 696d 655f  def create_time_
+00069d00: 7365 7269 6573 5f66 6561 7475 7265 7328  series_features(
+00069d10: 6474 662c 2074 735f 636f 6c75 6d6e 293a  dtf, ts_column):
+00069d20: 0d0a 2020 2020 2222 220d 0a20 2020 2054  ..    """..    T
+00069d30: 6869 7320 6372 6561 7465 7320 6265 7477  his creates betw
+00069d40: 6565 6e20 3820 616e 6420 3130 2064 6174  een 8 and 10 dat
+00069d50: 6520 7469 6d65 2066 6561 7475 7265 7320  e time features 
+00069d60: 666f 7220 6561 6368 2064 6174 6520 7661  for each date va
+00069d70: 7269 6162 6c65 2e20 5468 6520 6e75 6d62  riable. The numb
+00069d80: 6572 206f 6620 6665 6174 7572 6573 0d0a  er of features..
+00069d90: 2020 2020 6465 7065 6e64 7320 6f6e 2077      depends on w
+00069da0: 6865 7468 6572 2069 7420 6973 206a 7573  hether it is jus
+00069db0: 7420 6120 7965 6172 2076 6172 6961 626c  t a year variabl
+00069dc0: 6520 6f72 2061 2079 6561 722b 6d6f 6e74  e or a year+mont
+00069dd0: 682b 6461 7920 616e 6420 7768 6574 6865  h+day and whethe
+00069de0: 7220 6974 2068 6173 2068 6f75 7273 2061  r it has hours a
+00069df0: 6e64 206d 696e 732b 7365 6373 2e0d 0a20  nd mins+secs... 
+00069e00: 2020 2053 6f20 7468 6973 2063 616e 2063     So this can c
+00069e10: 7265 6174 6520 616c 6c20 7468 6573 6520  reate all these 
+00069e20: 6665 6174 7572 6573 2075 7369 6e67 206a  features using j
+00069e30: 7573 7420 7468 6520 6461 7465 2074 696d  ust the date tim
+00069e40: 6520 636f 6c75 6d6e 2074 6861 7420 796f  e column that yo
+00069e50: 7520 7365 6e64 2069 6e2e 0d0a 2020 2020  u send in...    
+00069e60: 4974 2072 6574 7572 6e73 2074 6865 2065  It returns the e
+00069e70: 6e74 6972 6520 6461 7461 6672 616d 6520  ntire dataframe 
+00069e80: 7769 7468 2061 6464 6564 2076 6172 6961  with added varia
+00069e90: 626c 6573 2061 7320 6f75 7470 7574 2e0d  bles as output..
+00069ea0: 0a20 2020 2022 2222 0d0a 2020 2020 6474  .    """..    dt
+00069eb0: 6620 3d20 636f 7079 2e64 6565 7063 6f70  f = copy.deepcop
+00069ec0: 7928 6474 6629 0d0a 2020 2020 2323 2323  y(dtf)..    ####
+00069ed0: 2049 6620 666f 7220 736f 6d65 2072 6561   If for some rea
+00069ee0: 736f 6e20 7473 5f63 6f6c 756d 6e20 6973  son ts_column is
+00069ef0: 206a 7573 7420 6120 6e75 6d62 6572 2c20   just a number, 
+00069f00: 6d61 6b65 2073 7572 6520 6974 2069 7320  make sure it is 
+00069f10: 6120 7374 7269 6e67 2073 6f20 6974 2064  a string so it d
+00069f20: 6f65 7320 6e6f 7420 626c 6f77 2075 7020  oes not blow up 
+00069f30: 616e 6420 636f 6e63 6174 656e 6174 6564  and concatenated
+00069f40: 0d0a 2020 2020 6966 206e 6f74 2069 7369  ..    if not isi
+00069f50: 6e73 7461 6e63 6528 7473 5f63 6f6c 756d  nstance(ts_colum
+00069f60: 6e2c 7374 7229 3a0d 0a20 2020 2020 2020  n,str):..       
+00069f70: 2074 735f 636f 6c75 6d6e 203d 2073 7472   ts_column = str
+00069f80: 2874 735f 636f 6c75 6d6e 290d 0a20 2020  (ts_column)..   
+00069f90: 2074 7279 3a0d 0a20 2020 2020 2020 2023   try:..        #
+00069fa0: 2323 2049 6e20 736f 6d65 2065 7874 7265  ## In some extre
+00069fb0: 6d65 2063 6173 6573 2c20 6461 7465 2074  me cases, date t
+00069fc0: 696d 6520 7661 7273 2061 7265 206e 6f74  ime vars are not
+00069fd0: 2070 726f 6365 7373 6564 2079 6574 2061   processed yet a
+00069fe0: 6e64 2068 656e 6365 2077 6520 6d75 7374  nd hence we must
+00069ff0: 2066 696c 6c20 6d69 7373 696e 6720 7661   fill missing va
+0006a000: 6c75 6573 2068 6572 6521 0d0a 2020 2020  lues here!..    
+0006a010: 2020 2020 6966 2064 7466 5b74 735f 636f      if dtf[ts_co
+0006a020: 6c75 6d6e 5d2e 6973 6e75 6c6c 2829 2e73  lumn].isnull().s
+0006a030: 756d 2829 203e 2030 3a0d 0a20 2020 2020  um() > 0:..     
+0006a040: 2020 2020 2020 206d 6973 7369 6e67 5f66         missing_f
+0006a050: 6c61 6720 3d20 5472 7565 0d0a 2020 2020  lag = True..    
+0006a060: 2020 2020 2020 2020 6e65 775f 6d69 7373          new_miss
+0006a070: 696e 675f 636f 6c20 3d20 7473 5f63 6f6c  ing_col = ts_col
+0006a080: 756d 6e20 2b20 275f 4d69 7373 696e 675f  umn + '_Missing_
+0006a090: 466c 6167 270d 0a20 2020 2020 2020 2020  Flag'..         
+0006a0a0: 2020 2064 7466 5b6e 6577 5f6d 6973 7369     dtf[new_missi
+0006a0b0: 6e67 5f63 6f6c 5d20 3d20 300d 0a20 2020  ng_col] = 0..   
+0006a0c0: 2020 2020 2020 2020 2064 7466 2e6c 6f63           dtf.loc
+0006a0d0: 5b64 7466 5b74 735f 636f 6c75 6d6e 5d2e  [dtf[ts_column].
+0006a0e0: 6973 6e75 6c6c 2829 2c6e 6577 5f6d 6973  isnull(),new_mis
+0006a0f0: 7369 6e67 5f63 6f6c 5d3d 310d 0a20 2020  sing_col]=1..   
+0006a100: 2020 2020 2020 2020 2023 2323 2052 656d           ### Rem
+0006a110: 656d 6265 7220 7468 6174 2066 696c 6c6e  ember that filln
+0006a120: 6120 6f6e 6c79 2077 6f72 6b73 2061 7420  a only works at 
+0006a130: 7468 6520 6461 7461 6672 616d 6520 6c65  the dataframe le
+0006a140: 7665 6c21 0d0a 2020 2020 2020 2020 2020  vel!..          
+0006a150: 2020 6474 665b 5b74 735f 636f 6c75 6d6e    dtf[[ts_column
+0006a160: 5d5d 203d 2064 7466 5b5b 7473 5f63 6f6c  ]] = dtf[[ts_col
+0006a170: 756d 6e5d 5d2e 6669 6c6c 6e61 286d 6574  umn]].fillna(met
+0006a180: 686f 643d 2766 6669 6c6c 2729 0d0a 2020  hod='ffill')..  
+0006a190: 2020 2020 2020 6966 2064 7466 5b74 735f        if dtf[ts_
+0006a1a0: 636f 6c75 6d6e 5d2e 6474 7970 6520 696e  column].dtype in
+0006a1b0: 205b 6e70 2e66 6c6f 6174 3634 2c6e 702e   [np.float64,np.
+0006a1c0: 666c 6f61 7433 322c 6e70 2e66 6c6f 6174  float32,np.float
+0006a1d0: 3136 5d3a 0d0a 2020 2020 2020 2020 2020  16]:..          
+0006a1e0: 2020 6474 665b 7473 5f63 6f6c 756d 6e5d    dtf[ts_column]
+0006a1f0: 203d 2064 7466 5b74 735f 636f 6c75 6d6e   = dtf[ts_column
+0006a200: 5d2e 6173 7479 7065 2869 6e74 290d 0a20  ].astype(int).. 
+0006a210: 2020 2020 2020 2023 2323 2069 6620 7765         ### if we
+0006a220: 2068 6176 6520 616c 7265 6164 7920 666f   have already fo
+0006a230: 756e 6420 7468 6174 2069 7420 7761 7320  und that it was 
+0006a240: 6120 6461 7465 2074 696d 6520 7661 722c  a date time var,
+0006a250: 2074 6865 6e20 6c65 6176 6520 6974 2061   then leave it a
+0006a260: 7320 6974 2069 732e 2054 6861 7473 2067  s it is. Thats g
+0006a270: 6f6f 6420 656e 6f75 6768 210d 0a20 2020  ood enough!..   
+0006a280: 2020 2020 2064 6174 655f 6974 656d 7320       date_items 
+0006a290: 3d20 6474 665b 7473 5f63 6f6c 756d 6e5d  = dtf[ts_column]
+0006a2a0: 2e61 7070 6c79 2873 7472 292e 6170 706c  .apply(str).appl
+0006a2b0: 7928 6c65 6e29 2e76 616c 7565 730d 0a20  y(len).values.. 
+0006a2c0: 2020 2020 2020 2023 2323 2320 496e 2073         #### In s
+0006a2d0: 6f6d 6520 6578 7472 656d 6520 6361 7365  ome extreme case
+0006a2e0: 732c 0d0a 2020 2020 2020 2020 6966 2061  s,..        if a
+0006a2f0: 6c6c 2864 6174 655f 6974 656d 735b 305d  ll(date_items[0]
+0006a300: 203d 3d20 6974 656d 2066 6f72 2069 7465   == item for ite
+0006a310: 6d20 696e 2064 6174 655f 6974 656d 7329  m in date_items)
+0006a320: 3a0d 0a20 2020 2020 2020 2020 2020 2069  :..            i
+0006a330: 6620 6461 7465 5f69 7465 6d73 5b30 5d20  f date_items[0] 
+0006a340: 3d3d 2034 3a0d 0a20 2020 2020 2020 2020  == 4:..         
+0006a350: 2020 2020 2020 2023 2323 2049 6620 6974         ### If it
+0006a360: 2069 7320 6a75 7374 2061 2079 6561 7220   is just a year 
+0006a370: 7661 7269 6162 6c65 2061 6c6f 6e65 2c20  variable alone, 
+0006a380: 796f 7520 7368 6f75 6c64 206c 6561 7665  you should leave
+0006a390: 2069 7420 6173 206a 7573 7420 6120 7965   it as just a ye
+0006a3a0: 6172 210d 0a20 2020 2020 2020 2020 2020  ar!..           
+0006a3b0: 2020 2020 2061 6765 5f63 6f6c 203d 2074       age_col = t
+0006a3c0: 735f 636f 6c75 6d6e 2b27 5f61 6765 5f69  s_column+'_age_i
+0006a3d0: 6e5f 7965 6172 7327 0d0a 2020 2020 2020  n_years'..      
+0006a3e0: 2020 2020 2020 2020 2020 6474 665b 6167            dtf[ag
+0006a3f0: 655f 636f 6c5d 203d 2064 7466 5b74 735f  e_col] = dtf[ts_
+0006a400: 636f 6c75 6d6e 5d2e 6d61 7028 6c61 6d62  column].map(lamb
+0006a410: 6461 2078 3a20 7064 2e74 6f5f 6461 7465  da x: pd.to_date
+0006a420: 7469 6d65 2878 2c66 6f72 6d61 743d 2725  time(x,format='%
+0006a430: 5927 2929 2e61 7070 6c79 2863 6f6d 7075  Y')).apply(compu
+0006a440: 7465 5f61 6765 292e 7661 6c75 6573 0d0a  te_age).values..
+0006a450: 2020 2020 2020 2020 2020 2020 2020 2020                  
+0006a460: 7265 7475 726e 2064 7466 5b5b 7473 5f63  return dtf[[ts_c
+0006a470: 6f6c 756d 6e2c 6167 655f 636f 6c5d 5d0d  olumn,age_col]].
+0006a480: 0a20 2020 2020 2020 2020 2020 2065 6c73  .            els
+0006a490: 653a 0d0a 2020 2020 2020 2020 2020 2020  e:..            
+0006a4a0: 2020 2020 2323 2320 6966 2069 7420 6973      ### if it is
+0006a4b0: 206e 6f74 2061 2079 6561 7220 616c 6f6e   not a year alon
+0006a4c0: 652c 2074 6865 6e20 636f 6e76 6572 7420  e, then convert 
+0006a4d0: 6974 2069 6e74 6f20 6120 6461 7465 2074  it into a date t
+0006a4e0: 696d 6520 7661 7269 6162 6c65 0d0a 2020  ime variable..  
+0006a4f0: 2020 2020 2020 2020 2020 2020 2020 6474                dt
+0006a500: 665b 7473 5f63 6f6c 756d 6e5d 203d 2070  f[ts_column] = p
+0006a510: 642e 746f 5f64 6174 6574 696d 6528 6474  d.to_datetime(dt
+0006a520: 665b 7473 5f63 6f6c 756d 6e5d 2c20 696e  f[ts_column], in
+0006a530: 6665 725f 6461 7465 7469 6d65 5f66 6f72  fer_datetime_for
+0006a540: 6d61 743d 5472 7565 290d 0a20 2020 2020  mat=True)..     
+0006a550: 2020 2065 6c73 653a 0d0a 2020 2020 2020     else:..      
+0006a560: 2020 2020 2020 6474 665b 7473 5f63 6f6c        dtf[ts_col
+0006a570: 756d 6e5d 203d 2070 642e 746f 5f64 6174  umn] = pd.to_dat
+0006a580: 6574 696d 6528 6474 665b 7473 5f63 6f6c  etime(dtf[ts_col
+0006a590: 756d 6e5d 2c20 696e 6665 725f 6461 7465  umn], infer_date
+0006a5a0: 7469 6d65 5f66 6f72 6d61 743d 5472 7565  time_format=True
+0006a5b0: 290d 0a20 2020 2020 2020 2064 7466 203d  )..        dtf =
+0006a5c0: 2063 7265 6174 655f 7473 5f66 6561 7475   create_ts_featu
+0006a5d0: 7265 7328 6474 662c 7473 5f63 6f6c 756d  res(dtf,ts_colum
+0006a5e0: 6e29 0d0a 2020 2020 6578 6365 7074 3a0d  n)..    except:.
+0006a5f0: 0a20 2020 2020 2020 2070 7269 6e74 2827  .        print('
+0006a600: 4572 726f 7220 696e 2050 726f 6365 7373  Error in Process
+0006a610: 696e 6720 2573 2063 6f6c 756d 6e20 666f  ing %s column fo
+0006a620: 7220 6461 7465 2074 696d 6520 6665 6174  r date time feat
+0006a630: 7572 6573 2e20 436f 6e74 696e 7569 6e67  ures. Continuing
+0006a640: 2e2e 2e27 2025 7473 5f63 6f6c 756d 6e29  ...' %ts_column)
+0006a650: 0d0a 2020 2020 7265 7475 726e 2064 7466  ..    return dtf
+0006a660: 0d0a 2323 2323 2323 2323 2323 2323 2323  ..##############
+0006a670: 2323 2323 2323 2323 2323 2323 2323 2323  ################
+0006a680: 2323 2323 2323 2323 2323 0d0a 6672 6f6d  ##########..from
+0006a690: 2063 6f6c 6c65 6374 696f 6e73 2069 6d70   collections imp
+0006a6a0: 6f72 7420 436f 756e 7465 720d 0a69 6d70  ort Counter..imp
+0006a6b0: 6f72 7420 7469 6d65 0d0a 2323 2323 2323  ort time..######
+0006a6c0: 2323 2323 2323 2323 2323 2323 2323 2323  ################
+0006a6d0: 2323 2323 2323 2323 2323 2323 2323 2323  ################
+0006a6e0: 2323 0d0a 696d 706f 7274 2077 6172 6e69  ##..import warni
+0006a6f0: 6e67 730d 0a77 6172 6e69 6e67 732e 6669  ngs..warnings.fi
+0006a700: 6c74 6572 7761 726e 696e 6773 2822 6967  lterwarnings("ig
+0006a710: 6e6f 7265 2229 0d0a 6672 6f6d 2073 6b6c  nore")..from skl
+0006a720: 6561 726e 2e65 7863 6570 7469 6f6e 7320  earn.exceptions 
+0006a730: 696d 706f 7274 2044 6174 6143 6f6e 7665  import DataConve
+0006a740: 7273 696f 6e57 6172 6e69 6e67 0d0a 7761  rsionWarning..wa
+0006a750: 726e 696e 6773 2e66 696c 7465 7277 6172  rnings.filterwar
+0006a760: 6e69 6e67 7328 6163 7469 6f6e 3d27 6967  nings(action='ig
+0006a770: 6e6f 7265 272c 2063 6174 6567 6f72 793d  nore', category=
+0006a780: 4461 7461 436f 6e76 6572 7369 6f6e 5761  DataConversionWa
+0006a790: 726e 696e 6729 0d0a 2323 2323 2323 2323  rning)..########
+0006a7a0: 2323 2323 2323 2323 2323 2323 2323 2323  ################
+0006a7b0: 2323 2323 2323 2323 2323 2323 2323 2323  ################
+0006a7c0: 2323 2323 2323 2323 2323 2323 2323 2323  ################
+0006a7d0: 2323 2323 2323 2323 2323 2323 2323 2323  ################
+0006a7e0: 2323 2323 2323 2323 2323 2323 0d0a 6672  ############..fr
+0006a7f0: 6f6d 2073 6b6c 6561 726e 2e75 7469 6c73  om sklearn.utils
+0006a800: 2e63 6c61 7373 5f77 6569 6768 7420 696d  .class_weight im
+0006a810: 706f 7274 2063 6f6d 7075 7465 5f63 6c61  port compute_cla
+0006a820: 7373 5f77 6569 6768 740d 0a66 726f 6d20  ss_weight..from 
+0006a830: 696d 626c 6561 726e 2e6f 7665 725f 7361  imblearn.over_sa
+0006a840: 6d70 6c69 6e67 2069 6d70 6f72 7420 534d  mpling import SM
+0006a850: 4f54 452c 2053 4d4f 5445 4e43 0d0a 6672  OTE, SMOTENC..fr
+0006a860: 6f6d 2063 6f6c 6c65 6374 696f 6e73 2069  om collections i
+0006a870: 6d70 6f72 7420 436f 756e 7465 720d 0a69  mport Counter..i
+0006a880: 6d70 6f72 7420 636f 7079 0d0a 696d 706f  mport copy..impo
+0006a890: 7274 2070 6462 0d0a 2323 2323 2323 2323  rt pdb..########
+0006a8a0: 2323 2323 2323 2323 2323 2323 2323 2323  ################
+0006a8b0: 2323 2323 2323 2323 2323 2323 2323 2323  ################
+0006a8c0: 2323 2323 2323 2323 2323 2323 2323 2323  ################
+0006a8d0: 2323 2323 2323 2323 2323 2323 2323 2323  ################
+0006a8e0: 2323 2323 2323 2323 2323 2323 2323 230d  ###############.
+0006a8f0: 0a23 2323 2052 6567 7265 7373 696f 6e5f  .### Regression_
+0006a900: 5265 7361 6d70 6c65 7220 6973 2061 206e  Resampler is a n
+0006a910: 6561 7420 6c69 6272 6172 7920 7468 6174  eat library that
+0006a920: 2072 6574 7572 6e73 2061 206e 756d 7079   returns a numpy
+0006a930: 206c 6973 7420 6f66 2063 6c61 7373 6573   list of classes
+0006a940: 2066 6f72 2065 6163 680d 0a23 2323 2020   for each..###  
+0006a950: 636f 7272 6573 706f 6e64 696e 6720 7361  corresponding sa
+0006a960: 6d70 6c65 2e20 6672 6f6d 2074 6172 6765  mple. from targe
+0006a970: 7420 6461 7461 2e20 4974 2065 6e61 626c  t data. It enabl
+0006a980: 6573 2072 6567 7265 7369 736f 6e20 7072  es regresison pr
+0006a990: 6f62 6c65 6d73 2074 6f20 7573 6520 534d  oblems to use SM
+0006a9a0: 4f54 452e 0d0a 2323 2320 2049 2068 6176  OTE...###  I hav
+0006a9b0: 6520 7573 6564 2061 2073 696d 696c 6172  e used a similar
+0006a9c0: 2063 6f6e 6365 7074 2062 7574 2069 6d70   concept but imp
+0006a9d0: 6c65 6d65 6e74 6564 2069 7420 6d79 2077  lemented it my w
+0006a9e0: 6179 2075 7369 6e67 204b 2d4d 6561 6e73  ay using K-Means
+0006a9f0: 2061 6c67 6f72 6974 686d 2e0d 0a23 2323   algorithm...###
+0006aa00: 2020 4d79 2073 696e 6365 7265 2074 6861    My sincere tha
+0006aa10: 6e6b 7320 746f 2074 6865 2063 7265 6174  nks to the creat
+0006aa20: 6f72 7320 6f66 2074 6865 206c 6962 7261  ors of the libra
+0006aa30: 7279 3a0d 0a23 2323 2020 2020 2068 7474  ry:..###     htt
+0006aa40: 7073 3a2f 2f67 6974 6875 622e 636f 6d2f  ps://github.com/
+0006aa50: 6174 6966 2d68 6173 7361 6e2f 5265 6772  atif-hassan/Regr
+0006aa60: 6573 7369 6f6e 5f52 6553 616d 706c 696e  ession_ReSamplin
+0006aa70: 672f 0d0a 2323 2323 2323 2323 2323 2323  g/..############
+0006aa80: 2323 2323 2323 2323 2323 2323 2323 2323  ################
+0006aa90: 2323 2323 2323 2323 2323 2323 2323 2323  ################
+0006aaa0: 2323 2323 2323 2323 2323 2323 2323 2323  ################
+0006aab0: 2323 2323 2323 2323 2323 2323 2323 2323  ################
+0006aac0: 2323 2323 2323 2323 2323 230d 0a64 6566  ###########..def
+0006aad0: 2074 7261 696e 696e 675f 7769 7468 5f53   training_with_S
+0006aae0: 4d4f 5445 2858 5f64 662c 795f 6466 2c74  MOTE(X_df,y_df,t
+0006aaf0: 6172 6765 742c 6576 616c 5f73 6574 2c6d  arget,eval_set,m
+0006ab00: 6f64 656c 5f69 6e70 7574 2c42 6f6f 7374  odel_input,Boost
+0006ab10: 696e 675f 466c 6167 2c65 7661 6c5f 6d65  ing_Flag,eval_me
+0006ab20: 7472 6963 2c0d 0a20 2020 2020 2020 2020  tric,..         
+0006ab30: 2020 2020 2020 2020 2020 2020 2020 2020                  
+0006ab40: 2020 2020 2020 2020 2020 2020 2020 206d                 m
+0006ab50: 6f64 656c 7479 7065 2c20 6d6f 6465 6c5f  odeltype, model_
+0006ab60: 6e61 6d65 2c0d 0a20 2020 2020 2020 2020  name,..         
+0006ab70: 2020 2020 2020 2020 2020 2020 2020 2020                  
+0006ab80: 2020 2020 2020 2020 2020 2020 7472 6169              trai
+0006ab90: 6e69 6e67 3d54 7275 652c 6d69 6e6f 7269  ning=True,minori
+0006aba0: 7479 5f63 6c61 7373 3d31 2c69 6d70 5f63  ty_class=1,imp_c
+0006abb0: 6174 733d 5b5d 2c0d 0a20 2020 2020 2020  ats=[],..       
+0006abc0: 2020 2020 2020 2020 2020 2020 2020 2020                  
+0006abd0: 2020 2020 2020 2020 2020 2020 2020 6361                ca
+0006abe0: 6c69 6272 6174 6f72 5f66 6c61 673d 4661  librator_flag=Fa
+0006abf0: 6c73 652c 0d0a 2020 2020 2020 2020 2020  lse,..          
+0006ac00: 2020 2020 2020 2020 2020 2020 2020 2020                  
+0006ac10: 2020 2020 2020 2020 2020 2047 5055 5f65             GPU_e
+0006ac20: 7869 7374 733d 4661 6c73 652c 2070 6172  xists=False, par
+0006ac30: 616d 733d 7b7d 2c0d 0a20 2020 2020 2020  ams={},..       
+0006ac40: 2020 2020 2020 2020 2020 2020 2020 2020                  
+0006ac50: 2020 2020 2020 2020 2020 2020 2020 6d6f                mo
+0006ac60: 6465 6c5f 6c61 6265 6c3d 2753 696e 676c  del_label='Singl
+0006ac70: 655f 4c61 6265 6c27 2c20 7665 7262 6f73  e_Label', verbos
+0006ac80: 653d 3029 3a0d 0a20 2020 2022 2222 0d0a  e=0):..    """..
+0006ac90: 2020 2020 2323 2323 2323 2323 2320 2020      #########   
+0006aca0: 204f 5645 5253 414d 504c 494e 4720 4f46   OVERSAMPLING OF
+0006acb0: 204d 494e 4f52 4954 5920 434c 4153 5320   MINORITY CLASS 
+0006acc0: 414e 4420 5452 4149 4e49 4e47 2020 5349  AND TRAINING  SI
+0006acd0: 5a45 5320 2023 2323 2323 2323 2323 2323  ZES  ###########
+0006ace0: 2323 2323 0d0a 2020 2020 2323 2323 2020  ####..    ####  
+0006acf0: 534d 4f54 4520 2853 796e 7468 6574 6963  SMOTE (Synthetic
+0006ad00: 204d 696e 6f72 6974 7920 4f76 6572 7361   Minority Oversa
+0006ad10: 6d70 6c69 6e67 2054 6563 686e 6971 7565  mpling Technique
+0006ad20: 2920 776f 726b 7320 7765 6c6c 2077 6974  ) works well wit
+0006ad30: 6820 696d 6261 6c61 6e63 6564 2063 6c61  h imbalanced cla
+0006ad40: 7373 6573 2e0d 0a20 2020 2023 2323 2320  sses...    #### 
+0006ad50: 2054 6869 7320 6973 2061 2067 7265 6174   This is a great
+0006ad60: 2077 6179 2074 6f20 7472 6169 6e20 6120   way to train a 
+0006ad70: 6d6f 6465 6c20 696e 2073 7563 6820 6361  model in such ca
+0006ad80: 7365 7320 7769 7468 2072 6570 6561 7465  ses with repeate
+0006ad90: 6420 7361 6d70 6c65 7320 6f66 2072 6172  d samples of rar
+0006ada0: 652d 636c 6173 730d 0a20 2020 2023 2323  e-class..    ###
+0006adb0: 2320 2061 6c6f 6e67 2077 6974 6820 6261  #  along with ba
+0006adc0: 7463 6865 7320 6f66 206d 616a 6f72 6974  tches of majorit
+0006add0: 7920 636c 6173 7320 616e 6420 6765 7420  y class and get 
+0006ade0: 7468 6520 6d6f 6465 6c20 746f 2064 6966  the model to dif
+0006adf0: 6665 7265 6e74 6961 7465 2062 6574 7765  ferentiate betwe
+0006ae00: 656e 2032 2063 6c61 7373 6573 2e0d 0a20  en 2 classes... 
+0006ae10: 2020 2023 2323 2320 2054 6869 7320 6361     ####  This ca
+0006ae20: 6e20 616c 736f 2062 6520 7573 6564 2066  n also be used f
+0006ae30: 6f72 2052 6567 7265 7373 696f 6e20 7072  or Regression pr
+0006ae40: 6f62 6c65 6d73 2062 7920 7573 696e 6720  oblems by using 
+0006ae50: 7468 6520 6e75 6d65 7269 6320 7461 7267  the numeric targ
+0006ae60: 6574 2076 616c 7565 7320 636f 6e76 6572  et values conver
+0006ae70: 7465 640d 0a20 2020 2023 2323 2320 2074  ted..    ####  t
+0006ae80: 6f20 636c 7573 7465 7220 6c61 6265 6c73  o cluster labels
+0006ae90: 2075 7369 6e67 204b 4d65 616e 732e 2059   using KMeans. Y
+0006aea0: 6f75 2063 616e 2074 6865 6e20 7573 6520  ou can then use 
+0006aeb0: 7468 6520 636c 7573 7465 7220 6c61 6265  the cluster labe
+0006aec0: 6c73 2074 6f20 6164 6420 6d6f 7265 2073  ls to add more s
+0006aed0: 616d 706c 6573 2e0d 0a20 2020 2023 2323  amples...    ###
+0006aee0: 2323 2323 2323 2020 2020 4d41 4b45 2053  ######    MAKE S
+0006aef0: 5552 4520 594f 5520 5455 4e45 2054 4845  URE YOU TUNE THE
+0006af00: 2044 4546 4155 4c54 5320 4749 5645 4e20   DEFAULTS GIVEN 
+0006af10: 4845 5245 2120 2023 2323 2323 2323 2323  HERE!  #########
+0006af20: 2323 2323 2323 0d0a 2020 2020 2222 220d  ######..    """.
+0006af30: 0a20 2020 2058 5f64 6620 3d20 636f 7079  .    X_df = copy
+0006af40: 2e64 6565 7063 6f70 7928 585f 6466 290d  .deepcopy(X_df).
+0006af50: 0a20 2020 2079 5f64 6620 3d20 636f 7079  .    y_df = copy
+0006af60: 2e64 6565 7063 6f70 7928 795f 6466 290d  .deepcopy(y_df).
+0006af70: 0a20 2020 206d 6f64 656c 5f63 6f70 7920  .    model_copy 
+0006af80: 3d20 636f 7079 2e64 6565 7063 6f70 7928  = copy.deepcopy(
+0006af90: 6d6f 6465 6c5f 696e 7075 7429 0d0a 2020  model_input)..  
+0006afa0: 2020 6d6f 6465 6c20 3d20 636f 7079 2e64    model = copy.d
+0006afb0: 6565 7063 6f70 7928 6d6f 6465 6c5f 636f  eepcopy(model_co
+0006afc0: 7079 290d 0a20 2020 2073 7461 7274 5f74  py)..    start_t
+0006afd0: 696d 6520 3d20 7469 6d65 2e74 696d 6528  ime = time.time(
+0006afe0: 290d 0a20 2020 2023 2323 2323 204e 6f77  )..    ##### Now
+0006aff0: 2077 6520 7769 6c6c 2073 7461 7274 2075   we will start u
+0006b000: 7369 6e67 2052 6573 616d 706c 696e 6720  sing Resampling 
+0006b010: 4c69 6272 6172 7920 746f 206d 616b 6520  Library to make 
+0006b020: 6461 7461 206d 6f72 6520 6261 6c61 6e63  data more balanc
+0006b030: 6564 2023 2323 0d0a 2020 2020 6966 206d  ed ###..    if m
+0006b040: 6f64 656c 7479 7065 203d 3d20 2752 6567  odeltype == 'Reg
+0006b050: 7265 7373 696f 6e27 3a0d 0a20 2020 2020  ression':..     
+0006b060: 2020 2070 7269 6e74 2822 5573 696e 6720     print("Using 
+0006b070: 5265 6772 6573 7369 6f6e 2052 6573 616d  Regression Resam
+0006b080: 706c 6572 206c 6962 7261 7279 2074 6f20  pler library to 
+0006b090: 6d61 6b65 2073 6b65 7765 6420 7461 7267  make skewed targ
+0006b0a0: 6574 2076 6172 6961 626c 6520 6d6f 7265  et variable more
+0006b0b0: 2062 616c 616e 6365 642e 2e2e 2229 0d0a   balanced...")..
+0006b0c0: 2020 2020 656c 7365 3a0d 0a20 2020 2020      else:..     
+0006b0d0: 2020 2023 7072 696e 7428 2255 7369 6e67     #print("Using
+0006b0e0: 2053 4d4f 5445 2773 206f 7665 722d 7361   SMOTE's over-sa
+0006b0f0: 6d70 6c69 6e67 2074 6563 686e 6971 7565  mpling technique
+0006b100: 7320 746f 206d 616b 6520 7468 6520 2564  s to make the %d
+0006b110: 2063 6c61 7373 6573 2062 616c 616e 6365   classes balance
+0006b120: 642e 2e2e 2220 256c 656e 286e 702e 756e  d..." %len(np.un
+0006b130: 6971 7565 2879 5f64 6629 2929 0d0a 2020  ique(y_df)))..  
+0006b140: 2020 2020 2020 6966 206d 6f64 656c 7479        if modelty
+0006b150: 7065 203d 3d20 2742 696e 6172 795f 436c  pe == 'Binary_Cl
+0006b160: 6173 7369 6669 6361 7469 6f6e 273a 0d0a  assification':..
+0006b170: 2020 2020 2020 2020 2020 2020 7072 696e              prin
+0006b180: 7428 2755 7369 6e67 2053 656c 662d 5061  t('Using Self-Pa
+0006b190: 6365 6420 456e 7365 6d62 6c65 2043 6c61  ced Ensemble Cla
+0006b1a0: 7373 6966 6965 7220 746f 2068 616e 646c  ssifier to handl
+0006b1b0: 6520 7468 6973 2049 6d62 616c 616e 6365  e this Imbalance
+0006b1c0: 6420 6461 7461 7365 742e 2e2e 2729 0d0a  d dataset...')..
+0006b1d0: 2020 2020 2020 2020 656c 7365 3a0d 0a20          else:.. 
+0006b1e0: 2020 2020 2020 2020 2020 2070 7269 6e74             print
+0006b1f0: 2827 5573 696e 6720 4f6e 6556 7352 6573  ('Using OneVsRes
+0006b200: 742b 5365 6c66 2d50 6163 6564 2045 6e73  t+Self-Paced Ens
+0006b210: 656d 626c 6520 436c 6173 7369 6669 6572  emble Classifier
+0006b220: 2074 6f20 6861 6e64 6c65 2074 6869 7320   to handle this 
+0006b230: 496d 6261 6c61 6e63 6564 2064 6174 6173  Imbalanced datas
+0006b240: 6574 2e2e 2e27 290d 0a20 2020 2074 7279  et...')..    try
+0006b250: 3a0d 0a20 2020 2020 2020 2023 2323 2323  :..        #####
+0006b260: 2323 2323 2323 2323 2323 2323 2323 2323  ################
+0006b270: 2323 2323 2323 2323 2323 2323 2323 2323  ################
+0006b280: 2323 2323 2323 2323 2323 2323 2323 2323  ################
+0006b290: 2323 2323 2323 2323 2323 2323 2323 2323  ################
+0006b2a0: 2323 0d0a 2020 2020 2020 2020 2320 496e  ##..        # In
+0006b2b0: 6974 6961 6c69 7a65 2074 6865 2072 6573  itialize the res
+0006b2c0: 616d 706c 6572 206f 626a 6563 740d 0a20  ampler object.. 
+0006b2d0: 2020 2020 2020 2064 665f 7472 6169 6e20         df_train 
+0006b2e0: 3d20 585f 6466 2e6a 6f69 6e28 795f 6466  = X_df.join(y_df
+0006b2f0: 290d 0a20 2020 2020 2020 2023 2047 656e  )..        # Gen
+0006b300: 6572 6174 6520 636c 6173 7365 730d 0a20  erate classes.. 
+0006b310: 2020 2020 2020 2023 2323 2320 5365 6c65         #### Sele
+0006b320: 6374 2074 6865 2072 6967 6874 2053 4d4f  ct the right SMO
+0006b330: 5445 2061 6c67 6f72 6974 686d 2062 6173  TE algorithm bas
+0006b340: 6564 206f 6e20 7768 6574 6865 7220 7468  ed on whether th
+0006b350: 6572 6520 6172 6520 616e 7920 696d 705f  ere are any imp_
+0006b360: 6361 7473 2069 6e20 6461 7461 0d0a 2020  cats in data..  
+0006b370: 2020 2020 2020 6361 745f 7661 7273 5f69        cat_vars_i
+0006b380: 6e64 6578 203d 205b 6920 666f 7220 692c  ndex = [i for i,
+0006b390: 206a 2069 6e20 656e 756d 6572 6174 6528   j in enumerate(
+0006b3a0: 585f 6466 2e63 6f6c 756d 6e73 2920 6966  X_df.columns) if
+0006b3b0: 206a 2069 6e20 696d 705f 6361 7473 5d0d   j in imp_cats].
+0006b3c0: 0a20 2020 2020 2020 2023 2323 2067 6574  .        ### get
+0006b3d0: 2074 6865 206e 756d 6265 7220 6f66 204b   the number of K
+0006b3e0: 5f4e 6569 6768 626f 7273 2075 7369 6e67  _Neighbors using
+0006b3f0: 2074 6869 7320 6361 6c63 756c 6174 696f   this calculatio
+0006b400: 6e0d 0a20 2020 2020 2020 2072 6172 655f  n..        rare_
+0006b410: 7361 6d70 6c65 7320 3d20 7064 2e53 6572  samples = pd.Ser
+0006b420: 6965 7328 436f 756e 7465 7228 795f 6466  ies(Counter(y_df
+0006b430: 2929 2e6d 696e 2829 0d0a 2020 2020 2020  )).min()..      
+0006b440: 2020 2370 7269 6e74 2827 2020 2020 4e75    #print('    Nu
+0006b450: 6d62 6572 206f 6620 5261 7265 2043 6c61  mber of Rare Cla
+0006b460: 7373 2073 616d 706c 6573 203d 2025 6427  ss samples = %d'
+0006b470: 2025 7261 7265 5f73 616d 706c 6573 290d   %rare_samples).
+0006b480: 0a20 2020 2020 2020 2072 6172 655f 7063  .        rare_pc
+0006b490: 7420 3d20 7261 7265 5f73 616d 706c 6573  t = rare_samples
+0006b4a0: 2f79 5f64 662e 7368 6170 655b 305d 0d0a  /y_df.shape[0]..
+0006b4b0: 2020 2020 2020 2020 736d 616c 6c65 7374          smallest
+0006b4c0: 5f6b 6e20 3d20 2072 6172 655f 7361 6d70  _kn =  rare_samp
+0006b4d0: 6c65 7320 2d20 310d 0a20 2020 2020 2020  les - 1..       
+0006b4e0: 2069 6620 736d 616c 6c65 7374 5f6b 6e20   if smallest_kn 
+0006b4f0: 3e20 353a 0d0a 2020 2020 2020 2020 2020  > 5:..          
+0006b500: 2020 736d 616c 6c65 7374 5f6b 6e20 3d20    smallest_kn = 
+0006b510: 350d 0a20 2020 2020 2020 2065 6c69 6620  5..        elif 
+0006b520: 736d 616c 6c65 7374 5f6b 6e20 3e20 3220  smallest_kn > 2 
+0006b530: 616e 6420 736d 616c 6c65 7374 5f6b 6e20  and smallest_kn 
+0006b540: 3c20 353a 0d0a 2020 2020 2020 2020 2020  < 5:..          
+0006b550: 2020 736d 616c 6c65 7374 5f6b 6e20 3d20    smallest_kn = 
+0006b560: 320d 0a20 2020 2020 2020 2065 6c73 6520  2..        else 
+0006b570: 3a0d 0a20 2020 2020 2020 2020 2020 2073  :..            s
+0006b580: 6d61 6c6c 6573 745f 6b6e 203d 2031 0d0a  mallest_kn = 1..
+0006b590: 2020 2020 2020 2020 2370 7269 6e74 2827          #print('
+0006b5a0: 2020 2020 4e75 6d62 6572 206f 6620 4b20      Number of K 
+0006b5b0: 4e65 6967 6862 6f72 7320 7365 6c65 6374  Neighbors select
+0006b5c0: 6564 2066 6f72 2053 4d4f 5445 203d 2025  ed for SMOTE = %
+0006b5d0: 6427 2025 736d 616c 6c65 7374 5f6b 6e29  d' %smallest_kn)
+0006b5e0: 0d0a 2020 2020 2020 2020 2370 7269 6e74  ..        #print
+0006b5f0: 2827 2020 2020 5063 7420 6f66 2052 6172  ('    Pct of Rar
+0006b600: 6520 436c 6173 7320 696e 2064 6174 6120  e Class in data 
+0006b610: 3d20 2530 2e32 6625 2527 2025 2872 6172  = %0.2f%%' %(rar
+0006b620: 655f 7063 742a 3130 3029 290d 0a20 2020  e_pct*100))..   
+0006b630: 2020 2020 2069 6620 7261 7265 5f70 6374       if rare_pct
+0006b640: 203e 2030 2e31 303a 0d0a 2020 2020 2020   > 0.10:..      
+0006b650: 2020 2020 2020 7072 696e 7428 2720 2020        print('   
+0006b660: 2054 6869 7320 6973 206e 6f74 2061 6e20   This is not an 
+0006b670: 496d 6261 6c61 6e63 6564 2064 6174 6120  Imbalanced data 
+0006b680: 7365 742e 204e 6f20 6e65 6564 2074 6f20  set. No need to 
+0006b690: 7573 6520 534d 4f54 4520 6275 7420 636f  use SMOTE but co
+0006b6a0: 6e74 696e 7569 6e67 2e2e 2e27 290d 0a20  ntinuing...').. 
+0006b6b0: 2020 2065 7863 6570 743a 0d0a 2020 2020     except:..    
+0006b6c0: 2020 2020 7072 696e 7428 2720 2020 2053      print('    S
+0006b6d0: 4d4f 5445 2069 7320 6572 726f 7269 6e67  MOTE is erroring
+0006b6e0: 2e20 436f 6e74 696e 7569 6e67 2077 6974  . Continuing wit
+0006b6f0: 686f 7574 2053 4d4f 5445 2e2e 2e27 290d  hout SMOTE...').
+0006b700: 0a20 2020 2020 2020 2072 6574 7572 6e20  .        return 
+0006b710: 6d6f 6465 6c0d 0a20 2020 2020 2020 2023  model..        #
+0006b720: 2323 2323 2323 2323 2323 2323 2323 2323  ################
+0006b730: 2323 2323 2323 2323 2323 2323 2323 2323  ################
+0006b740: 2323 2323 2323 2323 2323 2323 2323 2323  ################
+0006b750: 2323 2323 2323 2323 2323 2323 2323 2323  ################
+0006b760: 2323 2323 2323 0d0a 2020 2020 2323 2320  ######..    ### 
+0006b770: 6e6f 7720 7472 6169 6e20 7468 6520 6d6f  now train the mo
+0006b780: 6465 6c20 6f6e 2066 756c 6c20 7472 6169  del on full trai
+0006b790: 6e20 6461 7461 2023 2323 2323 2323 2323  n data #########
+0006b7a0: 2323 2323 2323 2323 2323 2323 2323 2323  ################
+0006b7b0: 2323 2323 2323 230d 0a20 2020 2069 6620  #######..    if 
+0006b7c0: 6d6f 6465 6c74 7970 6520 3d3d 2027 5265  modeltype == 'Re
+0006b7d0: 6772 6573 7369 6f6e 273a 0d0a 2020 2020  gression':..    
+0006b7e0: 2020 2020 2320 5265 6772 6573 7369 6f6e      # Regression
+0006b7f0: 2070 726f 626c 656d 2074 7572 6e65 6420   problem turned 
+0006b800: 696e 746f 2043 6c61 7373 6966 6963 6174  into Classificat
+0006b810: 696f 6e20 7072 6f62 6c65 6d0d 0a20 2020  ion problem..   
+0006b820: 2020 2020 206e 5f63 6c75 7374 6572 7320       n_clusters 
+0006b830: 3d20 6d61 7828 332c 2069 6e74 286e 702e  = max(3, int(np.
+0006b840: 6c6f 6731 3028 6c65 6e28 795f 6466 2929  log10(len(y_df))
+0006b850: 2920 2b20 3129 0d0a 2020 2020 2020 2020  ) + 1)..        
+0006b860: 2320 5573 6520 4b4d 6561 6e73 2074 6f20  # Use KMeans to 
+0006b870: 6669 6e64 206e 6174 7572 616c 2063 6c75  find natural clu
+0006b880: 7374 6572 7320 696e 2079 6f75 7220 6461  sters in your da
+0006b890: 7461 0d0a 2020 2020 2020 2020 6b6d 5f6d  ta..        km_m
+0006b8a0: 6f64 656c 203d 204b 4d65 616e 7328 6e5f  odel = KMeans(n_
+0006b8b0: 636c 7573 7465 7273 3d6e 5f63 6c75 7374  clusters=n_clust
+0006b8c0: 6572 732c 0d0a 2020 2020 2020 2020 2020  ers,..          
+0006b8d0: 2020 2020 2020 2020 2020 2020 2020 2020                  
+0006b8e0: 6e5f 696e 6974 3d35 2c0d 0a20 2020 2020  n_init=5,..     
+0006b8f0: 2020 2020 2020 2020 2020 2020 2020 2020                  
+0006b900: 2020 2020 2072 616e 646f 6d5f 7374 6174       random_stat
+0006b910: 653d 3939 290d 0a20 2020 2020 2020 2023  e=99)..        #
+0006b920: 2323 2320 7265 6d65 6d62 6572 2079 6f75  ### remember you
+0006b930: 206d 7573 7420 7072 6564 6963 7420 7573   must predict us
+0006b940: 696e 6720 6f6e 6c79 2070 7265 6469 6374  ing only predict
+0006b950: 6f72 2076 6172 6961 626c 6573 210d 0a20  or variables!.. 
+0006b960: 2020 2020 2020 2059 5f63 6c61 7373 6573         Y_classes
+0006b970: 203d 206b 6d5f 6d6f 6465 6c2e 6669 745f   = km_model.fit_
+0006b980: 7072 6564 6963 7428 585f 6466 290d 0a20  predict(X_df).. 
+0006b990: 2020 2065 6c73 653a 0d0a 2020 2020 2020     else:..      
+0006b9a0: 2020 595f 636c 6173 7365 7320 3d20 636f    Y_classes = co
+0006b9b0: 7079 2e64 6565 7063 6f70 7928 795f 6466  py.deepcopy(y_df
+0006b9c0: 290d 0a20 2020 2023 2323 2320 534d 4f54  )..    #### SMOT
+0006b9d0: 4520 776f 726b 7320 6f6e 6c79 2066 6f72  E works only for
+0006b9e0: 2053 696e 676c 6520 4c61 6265 6c20 7072   Single Label pr
+0006b9f0: 6f62 6c65 6d73 2023 2323 230d 0a20 2020  oblems ####..   
+0006ba00: 2069 6620 6d6f 6465 6c5f 6c61 6265 6c20   if model_label 
+0006ba10: 3d3d 2027 5369 6e67 6c65 5f4c 6162 656c  == 'Single_Label
+0006ba20: 273a 0d0a 2020 2020 2020 2020 636c 6173  ':..        clas
+0006ba30: 735f 7765 6967 6874 6564 5f72 6f77 7320  s_weighted_rows 
+0006ba40: 3d20 6765 745f 636c 6173 735f 6469 7374  = get_class_dist
+0006ba50: 7269 6275 7469 6f6e 2859 5f63 6c61 7373  ribution(Y_class
+0006ba60: 6573 290d 0a20 2020 2020 2020 2069 6620  es)..        if 
+0006ba70: 6c65 6e28 696d 705f 6361 7473 2920 3e20  len(imp_cats) > 
+0006ba80: 303a 0d0a 2020 2020 2020 2020 2020 2020  0:..            
+0006ba90: 2320 596f 7572 2066 6176 6f75 7269 7465  # Your favourite
+0006baa0: 206f 7665 7273 616d 706c 6572 203d 2053   oversampler = S
+0006bab0: 4d4f 5445 4e43 2069 7320 6265 7474 6572  MOTENC is better
+0006bac0: 2074 6861 6e20 534d 4f54 4520 696e 206d   than SMOTE in m
+0006bad0: 6f73 7420 6361 7365 7321 0d0a 2020 2020  ost cases!..    
+0006bae0: 2020 2020 2020 2020 736d 6f74 6520 3d20          smote = 
+0006baf0: 534d 4f54 454e 4328 6361 7465 676f 7269  SMOTENC(categori
+0006bb00: 6361 6c5f 6665 6174 7572 6573 3d63 6174  cal_features=cat
+0006bb10: 5f76 6172 735f 696e 6465 782c 0d0a 2020  _vars_index,..  
+0006bb20: 2020 2020 2020 2020 2020 2020 2020 2020                  
+0006bb30: 2020 2020 2020 7361 6d70 6c69 6e67 5f73        sampling_s
+0006bb40: 7472 6174 6567 793d 636c 6173 735f 7765  trategy=class_we
+0006bb50: 6967 6874 6564 5f72 6f77 732c 0d0a 2020  ighted_rows,..  
+0006bb60: 2020 2020 2020 2020 2020 2020 2020 2020                  
+0006bb70: 2020 2020 2020 7261 6e64 6f6d 5f73 7461        random_sta
+0006bb80: 7465 3d34 322c 206b 5f6e 6569 6768 626f  te=42, k_neighbo
+0006bb90: 7273 3d73 6d61 6c6c 6573 745f 6b6e 2c20  rs=smallest_kn, 
+0006bba0: 6e5f 6a6f 6273 3d2d 3129 0d0a 2020 2020  n_jobs=-1)..    
+0006bbb0: 2020 2020 656c 7365 3a0d 0a20 2020 2020      else:..     
+0006bbc0: 2020 2020 2020 2023 2059 6f75 7220 6661         # Your fa
+0006bbd0: 766f 7572 6974 6520 6f76 6572 7361 6d70  vourite oversamp
+0006bbe0: 6c65 7220 3d20 534d 4f54 4520 6973 2062  ler = SMOTE is b
+0006bbf0: 6574 7465 7220 7468 616e 2053 4d4f 5445  etter than SMOTE
+0006bc00: 454e 4e20 696e 206d 6f73 7420 6361 7365  ENN in most case
+0006bc10: 7321 0d0a 2020 2020 2020 2020 2020 2020  s!..            
+0006bc20: 736d 6f74 6520 3d20 534d 4f54 4528 7261  smote = SMOTE(ra
+0006bc30: 6e64 6f6d 5f73 7461 7465 3d32 372c 2073  ndom_state=27, s
+0006bc40: 616d 706c 696e 675f 7374 7261 7465 6779  ampling_strategy
+0006bc50: 3d63 6c61 7373 5f77 6569 6768 7465 645f  =class_weighted_
+0006bc60: 726f 7773 2c20 6e5f 6a6f 6273 3d2d 3129  rows, n_jobs=-1)
+0006bc70: 0d0a 2020 2020 2323 2323 2323 2323 2323  ..    ##########
+0006bc80: 2323 2323 2323 2323 2323 2323 2323 2020  ##############  
+0006bc90: 2020 5265 6772 6573 7369 6f6e 2052 6573    Regression Res
+0006bca0: 616d 706c 6572 2020 2020 2323 2323 2323  ampler    ######
+0006bcb0: 2323 2323 2323 2323 2323 2323 2323 2323  ################
+0006bcc0: 2323 230d 0a20 2020 2074 7279 3a0d 0a20  ###..    try:.. 
+0006bcd0: 2020 2020 2020 2069 6620 6d6f 6465 6c74         if modelt
+0006bce0: 7970 6520 3d3d 2027 5265 6772 6573 7369  ype == 'Regressi
+0006bcf0: 6f6e 273a 0d0a 2020 2020 2020 2020 2020  on':..          
+0006bd00: 2020 2323 2323 2055 7369 6e67 2072 6567    #### Using reg
+0006bd10: 2072 6573 616d 706c 6572 2077 696c 6c20   resampler will 
+0006bd20: 6e65 6564 2074 6172 6765 7420 636f 6c75  need target colu
+0006bd30: 6d6e 2069 6e20 6466 5f74 7261 696e 2074  mn in df_train t
+0006bd40: 7261 696e 202d 2064 6f6e 2774 2066 6f72  rain - don't for
+0006bd50: 6765 7421 0d0a 2020 2020 2020 2020 2020  get!..          
+0006bd60: 2020 585f 6466 5f72 6573 2c20 795f 6466    X_df_res, y_df
+0006bd70: 5f72 6573 203d 206b 6d65 616e 735f 7265  _res = kmeans_re
+0006bd80: 7361 6d70 6c65 7228 585f 6466 2c20 795f  sampler(X_df, y_
+0006bd90: 6466 2c20 7461 7267 6574 2c20 736d 6f74  df, target, smot
+0006bda0: 652c 2076 6572 626f 7365 290d 0a20 2020  e, verbose)..   
+0006bdb0: 2020 2020 2020 2020 2023 2323 2074 6865           ### the
+0006bdc0: 2078 5f64 665f 7265 7320 6f75 7470 7574   x_df_res output
+0006bdd0: 206f 6620 7265 7361 6d70 6c65 7220 7769   of resampler wi
+0006bde0: 6c6c 206e 6f74 2068 6176 6520 7468 6520  ll not have the 
+0006bdf0: 7461 7267 6574 2073 696e 6365 2069 7420  target since it 
+0006be00: 7769 6c6c 2068 6176 6520 6265 656e 2072  will have been r
+0006be10: 656d 6f76 6564 210d 0a20 2020 2020 2020  emoved!..       
+0006be20: 2020 2020 2023 2323 2079 5f64 665f 7265       ### y_df_re
+0006be30: 7320 7769 6c6c 2068 6176 6520 7468 6520  s will have the 
+0006be40: 7461 7267 6574 2063 6f6c 756d 6e20 7769  target column wi
+0006be50: 7468 206e 6f77 2065 7874 7261 2072 6f77  th now extra row
+0006be60: 7320 666f 7220 7265 6772 6573 7369 6f6e  s for regression
+0006be70: 2074 7261 696e 696e 6721 0d0a 2020 2020   training!..    
+0006be80: 2020 2020 656c 7365 3a0d 0a20 2020 2020      else:..     
+0006be90: 2020 2020 2020 2023 2323 2320 466f 7220         #### For 
+0006bea0: 636c 6173 7369 6669 6361 7469 6f6e 2070  classification p
+0006beb0: 726f 626c 656d 7320 7369 6d70 6c79 2075  roblems simply u
+0006bec0: 7369 6e67 2074 6865 206f 7269 6769 6e61  sing the origina
+0006bed0: 6c20 6461 7461 2077 696c 6c20 646f 0d0a  l data will do..
+0006bee0: 2020 2020 2020 2020 2020 2020 2358 5f64              #X_d
+0006bef0: 665f 7265 732c 2079 5f64 665f 7265 7320  f_res, y_df_res 
+0006bf00: 3d20 736d 6f74 652e 6669 745f 7265 7361  = smote.fit_resa
+0006bf10: 6d70 6c65 2858 5f64 662c 2079 5f64 6629  mple(X_df, y_df)
+0006bf20: 0d0a 2020 2020 2020 2020 2020 2020 2323  ..            ##
+0006bf30: 2320 466f 7220 636c 6173 7369 6669 6361  # For classifica
+0006bf40: 7469 6f6e 2070 726f 626c 656d 7320 7765  tion problems we
+0006bf50: 2061 7265 2067 6f69 6e67 2074 6f20 7573   are going to us
+0006bf60: 6520 5350 4520 6672 6f6d 206e 6f77 206f  e SPE from now o
+0006bf70: 6e0d 0a20 2020 2020 2020 2020 2020 2069  n..            i
+0006bf80: 6620 6d6f 6465 6c74 7970 6520 3d3d 2027  f modeltype == '
+0006bf90: 4269 6e61 7279 5f43 6c61 7373 6966 6963  Binary_Classific
+0006bfa0: 6174 696f 6e27 3a0d 0a20 2020 2020 2020  ation':..       
+0006bfb0: 2020 2020 2020 2020 2023 2323 2046 6f72           ### For
+0006bfc0: 2042 696e 6172 7920 636c 6173 732c 2053   Binary class, S
+0006bfd0: 5045 206d 6f64 656c 2069 7320 6265 7474  PE model is bett
+0006bfe0: 6572 2023 2323 2323 2323 2323 2323 230d  er ############.
+0006bff0: 0a20 2020 2020 2020 2020 2020 2020 2020  .               
+0006c000: 2072 6620 3d20 5261 6e64 6f6d 466f 7265   rf = RandomFore
+0006c010: 7374 436c 6173 7369 6669 6572 286e 5f65  stClassifier(n_e
+0006c020: 7374 696d 6174 6f72 733d 3130 302c 2072  stimators=100, r
+0006c030: 616e 646f 6d5f 7374 6174 653d 3939 290d  andom_state=99).
+0006c040: 0a20 2020 2020 2020 2020 2020 2020 2020  .               
+0006c050: 2073 7065 203d 2053 656c 6650 6163 6564   spe = SelfPaced
+0006c060: 456e 7365 6d62 6c65 436c 6173 7369 6669  EnsembleClassifi
+0006c070: 6572 2865 7374 696d 6174 6f72 3d72 662c  er(estimator=rf,
+0006c080: 206e 5f6a 6f62 733d 2d31 2c20 736f 6674   n_jobs=-1, soft
+0006c090: 5f72 6573 616d 706c 655f 666c 6167 3d46  _resample_flag=F
+0006c0a0: 616c 7365 290d 0a20 2020 2020 2020 2020  alse)..         
+0006c0b0: 2020 2065 6c73 653a 0d0a 2020 2020 2020     else:..      
+0006c0c0: 2020 2020 2020 2020 2020 2323 2046 6f72            ## For
+0006c0d0: 206d 756c 7469 2d63 6c61 7373 204f 6e65   multi-class One
+0006c0e0: 7673 5265 7374 206d 6f64 656c 2069 7320  vsRest model is 
+0006c0f0: 6265 7474 6572 2020 2323 2323 2323 2323  better  ########
+0006c100: 2323 230d 0a20 2020 2020 2020 2020 2020  ###..           
+0006c110: 2020 2020 2072 6620 3d20 5261 6e64 6f6d       rf = Random
+0006c120: 466f 7265 7374 436c 6173 7369 6669 6572  ForestClassifier
+0006c130: 286e 5f65 7374 696d 6174 6f72 733d 3130  (n_estimators=10
+0006c140: 302c 2072 616e 646f 6d5f 7374 6174 653d  0, random_state=
+0006c150: 3939 290d 0a20 2020 2020 2020 2020 2020  99)..           
+0006c160: 2020 2020 2073 7065 203d 2053 656c 6650       spe = SelfP
+0006c170: 6163 6564 456e 7365 6d62 6c65 436c 6173  acedEnsembleClas
+0006c180: 7369 6669 6572 2865 7374 696d 6174 6f72  sifier(estimator
+0006c190: 3d72 662c 206e 5f6a 6f62 733d 2d31 2c20  =rf, n_jobs=-1, 
+0006c1a0: 736f 6674 5f72 6573 616d 706c 655f 666c  soft_resample_fl
+0006c1b0: 6167 3d46 616c 7365 290d 0a20 2020 2020  ag=False)..     
+0006c1c0: 2020 2020 2020 2020 2020 2073 7065 203d             spe =
+0006c1d0: 204f 6e65 5673 5265 7374 436c 6173 7369   OneVsRestClassi
+0006c1e0: 6669 6572 2865 7374 696d 6174 6f72 3d73  fier(estimator=s
+0006c1f0: 7065 290d 0a20 2020 2020 2020 2020 2020  pe)..           
+0006c200: 2073 7065 2e66 6974 2858 5f64 662c 2079   spe.fit(X_df, y
+0006c210: 5f64 6629 0d0a 2020 2020 2020 2020 2020  _df)..          
+0006c220: 2020 7265 7475 726e 2073 7065 0d0a 2020    return spe..  
+0006c230: 2020 6578 6365 7074 3a0d 0a20 2020 2020    except:..     
+0006c240: 2020 2070 7269 6e74 2827 534d 4f54 4520     print('SMOTE 
+0006c250: 6f72 2052 6567 7265 7373 696f 6e2d 7265  or Regression-re
+0006c260: 7361 6d70 6c65 7220 6973 2065 7272 6f72  sampler is error
+0006c270: 696e 672e 2043 6f6e 7469 6e75 696e 672e  ing. Continuing.
+0006c280: 2e2e 2729 0d0a 2020 2020 2020 2020 6d6f  ..')..        mo
+0006c290: 6465 6c20 3d20 6d6f 6465 6c5f 7472 6169  del = model_trai
+0006c2a0: 6e69 6e67 5f73 6d6f 7465 286d 6f64 656c  ning_smote(model
+0006c2b0: 2c20 585f 6466 2c20 795f 6466 2c20 6576  , X_df, y_df, ev
+0006c2c0: 616c 5f73 6574 2c20 6576 616c 5f6d 6574  al_set, eval_met
+0006c2d0: 7269 632c 0d0a 2020 2020 2020 2020 2020  ric,..          
+0006c2e0: 2020 2020 2020 2020 2020 2020 2020 2020                  
+0006c2f0: 2020 2070 6172 616d 732c 2069 6d70 5f63     params, imp_c
+0006c300: 6174 732c 206d 6f64 656c 7479 7065 2c0d  ats, modeltype,.
+0006c310: 0a20 2020 2020 2020 2020 2020 2020 2020  .               
+0006c320: 2020 2020 2020 2020 2020 2020 2063 616c               cal
+0006c330: 6962 7261 746f 725f 666c 6167 2c20 6d6f  ibrator_flag, mo
+0006c340: 6465 6c5f 6e61 6d65 2c20 426f 6f73 7469  del_name, Boosti
+0006c350: 6e67 5f46 6c61 672c 206d 6f64 656c 5f6c  ng_Flag, model_l
+0006c360: 6162 656c 2c0d 0a20 2020 2020 2020 2020  abel,..         
+0006c370: 2020 2020 2020 2020 2020 2020 2020 2020                  
+0006c380: 2020 2020 4750 555f 6578 6973 7473 290d      GPU_exists).
+0006c390: 0a20 2020 2020 2020 2070 7269 6e74 2827  .        print('
+0006c3a0: 2020 2020 4d6f 6465 6c20 5472 6169 6e69      Model Traini
+0006c3b0: 6e67 2074 696d 6520 7461 6b65 6e20 3d20  ng time taken = 
+0006c3c0: 2530 2e30 6620 7365 636f 6e64 7327 2025  %0.0f seconds' %
+0006c3d0: 2874 696d 652e 7469 6d65 2829 2d73 7461  (time.time()-sta
+0006c3e0: 7274 5f74 696d 6529 290d 0a20 2020 2020  rt_time))..     
+0006c3f0: 2020 2072 6574 7572 6e20 7370 650d 0a20     return spe.. 
+0006c400: 2020 2070 7269 6e74 2827 5472 6169 6e69     print('Traini
+0006c410: 6e67 206d 6f64 656c 206e 6f77 206f 6e20  ng model now on 
+0006c420: 7265 7361 6d70 6c65 6420 7472 6169 6e20  resampled train 
+0006c430: 6461 7461 3a20 2573 2e20 5468 6973 2077  data: %s. This w
+0006c440: 696c 6c20 7461 6b65 2074 696d 652e 2e2e  ill take time...
+0006c450: 2720 2528 585f 6466 5f72 6573 2e73 6861  ' %(X_df_res.sha
+0006c460: 7065 2c29 290d 0a20 2020 2023 2046 6974  pe,))..    # Fit
+0006c470: 2074 6865 206d 6f64 656c 2075 7369 6e67   the model using
+0006c480: 2078 5f74 7261 696e 2061 6e64 2079 5f74   x_train and y_t
+0006c490: 7261 696e 2066 756c 6c20 6461 7461 2073  rain full data s
+0006c4a0: 656e 7420 696e 0d0a 2020 2020 6d6f 6465  ent in..    mode
+0006c4b0: 6c20 3d20 6d6f 6465 6c5f 7472 6169 6e69  l = model_traini
+0006c4c0: 6e67 5f73 6d6f 7465 286d 6f64 656c 2c20  ng_smote(model, 
+0006c4d0: 585f 6466 5f72 6573 2c20 795f 6466 5f72  X_df_res, y_df_r
+0006c4e0: 6573 2c20 6576 616c 5f73 6574 2c20 6576  es, eval_set, ev
+0006c4f0: 616c 5f6d 6574 7269 632c 0d0a 2020 2020  al_metric,..    
+0006c500: 2020 2020 2020 2020 2020 2020 2020 2020                  
+0006c510: 2020 2020 2070 6172 616d 732c 2069 6d70       params, imp
+0006c520: 5f63 6174 732c 206d 6f64 656c 7479 7065  _cats, modeltype
+0006c530: 2c0d 0a20 2020 2020 2020 2020 2020 2020  ,..             
+0006c540: 2020 2020 2020 2020 2020 2063 616c 6962             calib
+0006c550: 7261 746f 725f 666c 6167 2c20 6d6f 6465  rator_flag, mode
+0006c560: 6c5f 6e61 6d65 2c20 426f 6f73 7469 6e67  l_name, Boosting
+0006c570: 5f46 6c61 672c 206d 6f64 656c 5f6c 6162  _Flag, model_lab
+0006c580: 656c 2c0d 0a20 2020 2020 2020 2020 2020  el,..           
+0006c590: 2020 2020 2020 2020 2020 2020 2020 4750                GP
+0006c5a0: 555f 6578 6973 7473 290d 0a20 2020 2070  U_exists)..    p
+0006c5b0: 7269 6e74 2827 2020 2020 5265 7361 6d70  rint('    Resamp
+0006c5c0: 6c65 6420 6461 7461 2054 7261 696e 696e  led data Trainin
+0006c5d0: 6720 7469 6d65 2074 616b 656e 203d 2025  g time taken = %
+0006c5e0: 302e 3066 2073 6563 6f6e 6473 2720 2528  0.0f seconds' %(
+0006c5f0: 7469 6d65 2e74 696d 6528 292d 7374 6172  time.time()-star
+0006c600: 745f 7469 6d65 2929 0d0a 2020 2020 234e  t_time))..    #N
+0006c610: 6f77 206d 616b 6520 7072 6564 6963 7469  ow make predicti
+0006c620: 6f6e 7320 6f6e 2068 656c 6420 6f75 7420  ons on held out 
+0006c630: 6461 7461 0d0a 2020 2020 6d6f 6465 6c5f  data..    model_
+0006c640: 7374 7220 3d20 7374 7228 6d6f 6465 6c29  str = str(model)
+0006c650: 2e73 706c 6974 2822 2822 295b 305d 0d0a  .split("(")[0]..
+0006c660: 2020 2020 6966 2074 7261 696e 696e 673a      if training:
+0006c670: 0d0a 2020 2020 2020 2020 785f 7465 7374  ..        x_test
+0006c680: 203d 2065 7661 6c5f 7365 745b 305d 5b30   = eval_set[0][0
+0006c690: 5d0d 0a20 2020 2020 2020 2079 5f74 6573  ]..        y_tes
+0006c6a0: 7420 3d20 6576 616c 5f73 6574 5b30 5d5b  t = eval_set[0][
+0006c6b0: 315d 0d0a 2020 2020 2020 2020 2320 4368  1]..        # Ch
+0006c6c0: 6563 6b20 7468 6520 7363 6f72 650d 0a20  eck the score.. 
+0006c6d0: 2020 2020 2020 2070 7269 6e74 2827 2323         print('##
+0006c6e0: 2323 2323 2323 2323 2323 2323 2323 2323  ################
+0006c6f0: 2323 2323 2323 2323 2323 2323 2323 2323  ################
+0006c700: 2323 2323 2323 2323 2323 2323 2323 2323  ################
+0006c710: 2323 2323 2323 2729 0d0a 2020 2020 2020  ######')..      
+0006c720: 2020 7072 696e 7428 2752 6573 616d 706c    print('Resampl
+0006c730: 6564 206d 6f64 656c 2072 6573 756c 7473  ed model results
+0006c740: 206f 6e20 4865 6c64 206f 7574 2056 616c   on Held out Val
+0006c750: 6964 6174 696f 6e20 6461 7461 3a27 290d  idation data:').
+0006c760: 0a20 2020 2020 2020 2069 6620 6d6f 6465  .        if mode
+0006c770: 6c74 7970 6520 3d3d 2027 5265 6772 6573  ltype == 'Regres
+0006c780: 7369 6f6e 273a 0d0a 2020 2020 2020 2020  sion':..        
+0006c790: 2020 2020 7072 696e 745f 7265 6772 6573      print_regres
+0006c7a0: 7369 6f6e 5f6d 6574 7269 6373 2879 5f74  sion_metrics(y_t
+0006c7b0: 6573 742c 206d 6f64 656c 2e70 7265 6469  est, model.predi
+0006c7c0: 6374 2878 5f74 6573 7429 290d 0a20 2020  ct(x_test))..   
+0006c7d0: 2020 2020 2065 6c73 653a 0d0a 2020 2020       else:..    
+0006c7e0: 2020 2020 2020 2020 7072 696e 7428 636c          print(cl
+0006c7f0: 6173 7369 6669 6361 7469 6f6e 5f72 6570  assification_rep
+0006c800: 6f72 7428 795f 7465 7374 2c20 6d6f 6465  ort(y_test, mode
+0006c810: 6c2e 7072 6564 6963 7428 785f 7465 7374  l.predict(x_test
+0006c820: 2929 290d 0a20 2020 2020 2020 2070 7269  )))..        pri
+0006c830: 6e74 2827 2323 2323 2323 2323 2323 2323  nt('############
+0006c840: 2323 2323 2323 2020 436f 6d70 6c65 7465  ######  Complete
+0006c850: 6420 496d 6261 6c61 6e63 6564 2054 7261  d Imbalanced Tra
+0006c860: 696e 696e 6720 7573 696e 6720 2573 2023  ining using %s #
+0006c870: 2323 2323 2323 2323 2323 2323 2323 2327  ###############'
+0006c880: 2025 6d6f 6465 6c5f 7374 7229 0d0a 2020   %model_str)..  
+0006c890: 2020 656c 7365 3a0d 0a20 2020 2020 2020    else:..       
+0006c8a0: 2069 6620 7665 7262 6f73 6520 3e3d 2031   if verbose >= 1
+0006c8b0: 3a0d 0a20 2020 2020 2020 2020 2020 2066  :..            f
+0006c8c0: 6967 2c20 2861 7831 2c20 6178 3229 203d  ig, (ax1, ax2) =
+0006c8d0: 2070 6c74 2e73 7562 706c 6f74 7328 312c   plt.subplots(1,
+0006c8e0: 2032 2c20 7368 6172 6579 3d54 7275 652c   2, sharey=True,
+0006c8f0: 6669 6773 697a 653d 2831 322c 3529 290d  figsize=(12,5)).
+0006c900: 0a20 2020 2020 2020 2020 2020 2069 6620  .            if 
+0006c910: 6d6f 6465 6c74 7970 6520 3d3d 2027 5265  modeltype == 'Re
+0006c920: 6772 6573 7369 6f6e 273a 0d0a 2020 2020  gression':..    
+0006c930: 2020 2020 2020 2020 2020 2020 795f 6466              y_df
+0006c940: 2e70 6c6f 7428 6b69 6e64 3d27 6869 7374  .plot(kind='hist
+0006c950: 272c 7469 746c 653d 2744 6973 742e 206f  ',title='Dist. o
+0006c960: 6620 7461 7267 6574 2062 6566 6f72 6520  f target before 
+0006c970: 5265 6772 6573 7369 6f6e 2052 6573 616d  Regression Resam
+0006c980: 706c 6572 272c 2061 783d 6178 312c 2063  pler', ax=ax1, c
+0006c990: 6f6c 6f72 3d27 7227 290d 0a20 2020 2020  olor='r')..     
+0006c9a0: 2020 2020 2020 2020 2020 2070 642e 4461             pd.Da
+0006c9b0: 7461 4672 616d 6528 795f 6466 5f72 6573  taFrame(y_df_res
+0006c9c0: 292e 706c 6f74 286b 696e 643d 2768 6973  ).plot(kind='his
+0006c9d0: 7427 2c74 6974 6c65 3d27 4469 7374 2e20  t',title='Dist. 
+0006c9e0: 6f66 2074 6172 6765 7420 6166 7465 7220  of target after 
+0006c9f0: 5265 6772 6573 7369 6f6e 2052 6573 616d  Regression Resam
+0006ca00: 706c 6572 272c 2061 783d 6178 322c 2063  pler', ax=ax2, c
+0006ca10: 6f6c 6f72 3d27 6227 290d 0a20 2020 2020  olor='b')..     
+0006ca20: 2020 2020 2020 2065 6c73 653a 0d0a 2020         else:..  
+0006ca30: 2020 2020 2020 2020 2020 2020 2020 795f                y_
+0006ca40: 6466 2e76 616c 7565 5f63 6f75 6e74 7328  df.value_counts(
+0006ca50: 3129 2e70 6c6f 7428 6b69 6e64 3d27 6261  1).plot(kind='ba
+0006ca60: 7227 2c74 6974 6c65 3d27 4469 7374 7269  r',title='Distri
+0006ca70: 6275 7469 6f6e 206f 6620 636c 6173 7365  bution of classe
+0006ca80: 7320 6265 666f 7265 2053 4d4f 5445 272c  s before SMOTE',
+0006ca90: 2061 783d 6178 312c 2063 6f6c 6f72 3d27   ax=ax1, color='
+0006caa0: 7227 290d 0a20 2020 2020 2020 2020 2020  r')..           
+0006cab0: 2020 2020 2079 5f64 665f 7265 732e 7661       y_df_res.va
+0006cac0: 6c75 655f 636f 756e 7473 2831 292e 706c  lue_counts(1).pl
+0006cad0: 6f74 286b 696e 643d 2762 6172 272c 7469  ot(kind='bar',ti
+0006cae0: 746c 653d 2744 6973 7472 6962 7574 696f  tle='Distributio
+0006caf0: 6e20 6f66 2063 6c61 7373 6573 2061 6674  n of classes aft
+0006cb00: 6572 2053 4d4f 5445 272c 2061 783d 6178  er SMOTE', ax=ax
+0006cb10: 322c 2063 6f6c 6f72 3d27 6227 290d 0a20  2, color='b').. 
+0006cb20: 2020 2072 6574 7572 6e20 6d6f 6465 6c0d     return model.
+0006cb30: 0a23 2323 2323 2323 2323 2323 2323 2323  .###############
+0006cb40: 2323 2323 2323 2323 2323 2323 2323 2323  ################
+0006cb50: 2323 2323 2323 2323 2323 2323 2323 2323  ################
+0006cb60: 2323 2323 2323 2323 2323 2323 2323 2323  ################
+0006cb70: 2323 2323 2323 2323 2323 2323 2323 2323  ################
+0006cb80: 2323 2323 2323 2323 2323 2323 2323 230d  ###############.
+0006cb90: 0a64 6566 206d 6f64 656c 5f74 7261 696e  .def model_train
+0006cba0: 696e 675f 736d 6f74 6528 6d6f 6465 6c2c  ing_smote(model,
+0006cbb0: 2078 5f74 7261 696e 2c20 795f 7472 6169   x_train, y_trai
+0006cbc0: 6e2c 2065 7661 6c5f 7365 742c 2065 7661  n, eval_set, eva
+0006cbd0: 6c5f 6d65 7472 6963 2c0d 0a20 2020 2020  l_metric,..     
+0006cbe0: 2020 2020 2020 2020 2020 2020 2020 2020                  
+0006cbf0: 2020 2020 7061 7261 6d73 2c20 696d 705f      params, imp_
+0006cc00: 6361 7473 2c20 6d6f 6465 6c74 7970 652c  cats, modeltype,
+0006cc10: 0d0a 2020 2020 2020 2020 2020 2020 2020  ..              
+0006cc20: 2020 2020 2020 2020 2020 6361 6c69 6272            calibr
+0006cc30: 6174 6f72 5f66 6c61 672c 206d 6f64 656c  ator_flag, model
+0006cc40: 5f6e 616d 652c 2042 6f6f 7374 696e 675f  _name, Boosting_
+0006cc50: 466c 6167 2c20 6d6f 6465 6c5f 6c61 6265  Flag, model_labe
+0006cc60: 6c2c 0d0a 2020 2020 2020 2020 2020 2020  l,..            
+0006cc70: 2020 2020 2020 2020 2020 2020 2047 5055               GPU
+0006cc80: 5f65 7869 7374 7329 3a0d 0a20 2020 2023  _exists):..    #
+0006cc90: 2323 2320 5468 6973 206d 6f64 656c 2074  ### This model t
+0006cca0: 7261 696e 696e 6720 7669 6120 534d 4f54  raining via SMOT
+0006ccb0: 4520 6861 7320 746f 2062 6520 6d6f 6469  E has to be modi
+0006ccc0: 6669 6564 206c 6174 6572 2023 2323 2323  fied later #####
+0006ccd0: 2323 2323 2323 2323 2323 2323 2323 230d  ###############.
+0006cce0: 0a20 2020 2065 6172 6c79 5f73 746f 7070  .    early_stopp
+0006ccf0: 696e 6720 3d20 350d 0a20 2020 2069 6620  ing = 5..    if 
+0006cd00: 6d6f 6465 6c5f 6c61 6265 6c20 3d3d 2027  model_label == '
+0006cd10: 5369 6e67 6c65 5f4c 6162 656c 273a 0d0a  Single_Label':..
+0006cd20: 2020 2020 2020 2020 6966 2042 6f6f 7374          if Boost
+0006cd30: 696e 675f 466c 6167 3a0d 0a20 2020 2020  ing_Flag:..     
+0006cd40: 2020 2020 2020 2069 6620 6d6f 6465 6c5f         if model_
+0006cd50: 6e61 6d65 203d 3d20 2758 4742 6f6f 7374  name == 'XGBoost
+0006cd60: 273a 0d0a 2020 2020 2020 2020 2020 2020  ':..            
+0006cd70: 2020 2020 7472 793a 0d0a 2020 2020 2020      try:..      
+0006cd80: 2020 2020 2020 2020 2020 2020 2020 6966                if
+0006cd90: 2063 616c 6962 7261 746f 725f 666c 6167   calibrator_flag
+0006cda0: 3a0d 0a20 2020 2020 2020 2020 2020 2020  :..             
+0006cdb0: 2020 2020 2020 2020 2020 206d 6f64 656c             model
+0006cdc0: 2e66 6974 2878 5f74 7261 696e 2c20 795f  .fit(x_train, y_
+0006cdd0: 7472 6169 6e29 0d0a 2020 2020 2020 2020  train)..        
+0006cde0: 2020 2020 2020 2020 2020 2020 656c 7365              else
+0006cdf0: 3a0d 0a20 2020 2020 2020 2020 2020 2020  :..             
+0006ce00: 2020 2020 2020 2020 2020 2069 6620 6576             if ev
+0006ce10: 616c 5f73 6574 3d3d 5b28 295d 206f 7220  al_set==[()] or 
+0006ce20: 6d6f 6465 6c74 7970 6520 3d3d 2027 4d75  modeltype == 'Mu
+0006ce30: 6c74 695f 436c 6173 7369 6669 6361 7469  lti_Classificati
+0006ce40: 6f6e 273a 0d0a 2020 2020 2020 2020 2020  on':..          
+0006ce50: 2020 2020 2020 2020 2020 2020 2020 2020                  
+0006ce60: 2020 6d6f 6465 6c2e 6669 7428 785f 7472    model.fit(x_tr
+0006ce70: 6169 6e2c 2079 5f74 7261 696e 290d 0a20  ain, y_train).. 
+0006ce80: 2020 2020 2020 2020 2020 2020 2020 2020                  
+0006ce90: 2020 2020 2020 2065 6c73 653a 0d0a 2020         else:..  
+0006cea0: 2020 2020 2020 2020 2020 2020 2020 2020                  
+0006ceb0: 2020 2020 2020 2020 2020 6d6f 6465 6c2e            model.
+0006cec0: 6669 7428 785f 7472 6169 6e2c 2079 5f74  fit(x_train, y_t
+0006ced0: 7261 696e 2c65 6172 6c79 5f73 746f 7070  rain,early_stopp
+0006cee0: 696e 675f 726f 756e 6473 3d65 6172 6c79  ing_rounds=early
+0006cef0: 5f73 746f 7070 696e 672c 0d0a 2020 2020  _stopping,..    
+0006cf00: 2020 2020 2020 2020 2020 2020 2020 2020                  
+0006cf10: 2020 2020 2020 2020 2020 2020 6576 616c              eval
+0006cf20: 5f6d 6574 7269 633d 6576 616c 5f6d 6574  _metric=eval_met
+0006cf30: 7269 632c 6576 616c 5f73 6574 3d65 7661  ric,eval_set=eva
+0006cf40: 6c5f 7365 742c 7665 7262 6f73 653d 4661  l_set,verbose=Fa
+0006cf50: 6c73 6529 0d0a 2020 2020 2020 2020 2020  lse)..          
+0006cf60: 2020 2020 2020 6578 6365 7074 3a0d 0a20        except:.. 
+0006cf70: 2020 2020 2020 2020 2020 2020 2020 2020                  
+0006cf80: 2020 2023 2323 2320 4f6e 2043 6f6c 6162     #### On Colab
+0006cf90: 2c20 6576 656e 2074 686f 7567 6820 4750  , even though GP
+0006cfa0: 5520 6578 6973 7473 2c20 6d61 6e79 2070  U exists, many p
+0006cfb0: 656f 706c 6520 646f 6e27 7420 7475 726e  eople don't turn
+0006cfc0: 2069 7420 6f6e 2e0d 0a20 2020 2020 2020   it on...       
+0006cfd0: 2020 2020 2020 2020 2020 2020 2023 2323               ###
+0006cfe0: 2320 2049 6e20 7468 6174 2063 6173 652c  #  In that case,
+0006cff0: 2058 4742 6f6f 7374 2062 6c6f 7773 2075   XGBoost blows u
+0006d000: 7020 7768 656e 2067 7075 5f70 7265 6469  p when gpu_predi
+0006d010: 6374 6f72 2069 7320 7573 6564 2e0d 0a20  ctor is used... 
+0006d020: 2020 2020 2020 2020 2020 2020 2020 2020                  
+0006d030: 2020 2023 2323 2320 2054 6869 7320 6973     ####  This is
+0006d040: 2074 6f20 7475 726e 2069 7420 6261 636b   to turn it back
+0006d050: 2074 6f20 6370 755f 7072 6564 6963 746f   to cpu_predicto
+0006d060: 7220 696e 2063 6173 6520 4750 5520 6572  r in case GPU er
+0006d070: 726f 7273 210d 0a20 2020 2020 2020 2020  rors!..         
+0006d080: 2020 2020 2020 2020 2020 2069 6620 4750             if GP
+0006d090: 555f 6578 6973 7473 3a0d 0a20 2020 2020  U_exists:..     
+0006d0a0: 2020 2020 2020 2020 2020 2020 2020 2020                  
+0006d0b0: 2020 2070 7269 6e74 2827 5761 726e 696e     print('Warnin
+0006d0c0: 673a 2047 5055 2065 7869 7374 7320 6275  g: GPU exists bu
+0006d0d0: 7420 6974 2069 7320 6e6f 7420 7475 726e  t it is not turn
+0006d0e0: 6564 206f 6e2e 2055 7369 6e67 2043 5055  ed on. Using CPU
+0006d0f0: 2066 6f72 2070 7265 6469 6374 696f 6e73   for predictions
+0006d100: 2e2e 2e27 290d 0a20 2020 2020 2020 2020  ...')..         
+0006d110: 2020 2020 2020 2020 2020 2020 2020 2069                 i
+0006d120: 6620 6361 6c69 6272 6174 6f72 5f66 6c61  f calibrator_fla
+0006d130: 673a 0d0a 2020 2020 2020 2020 2020 2020  g:..            
+0006d140: 2020 2020 2020 2020 2020 2020 2020 2020                  
+0006d150: 6d6f 6465 6c2e 6261 7365 5f65 7374 696d  model.base_estim
+0006d160: 6174 6f72 2e73 6574 5f70 6172 616d 7328  ator.set_params(
+0006d170: 2a2a 7061 7261 6d73 290d 0a20 2020 2020  **params)..     
+0006d180: 2020 2020 2020 2020 2020 2020 2020 2020                  
+0006d190: 2020 2020 2020 206d 6f64 656c 2e66 6974         model.fit
+0006d1a0: 2878 5f74 7261 696e 2c20 795f 7472 6169  (x_train, y_trai
+0006d1b0: 6e29 0d0a 2020 2020 2020 2020 2020 2020  n)..            
+0006d1c0: 2020 2020 2020 2020 2020 2020 656c 7365              else
+0006d1d0: 3a0d 0a20 2020 2020 2020 2020 2020 2020  :..             
+0006d1e0: 2020 2020 2020 2020 2020 2020 2020 206d                 m
+0006d1f0: 6f64 656c 2e65 7374 696d 6174 6f72 2e73  odel.estimator.s
+0006d200: 6574 5f70 6172 616d 7328 2a2a 7061 7261  et_params(**para
+0006d210: 6d73 290d 0a20 2020 2020 2020 2020 2020  ms)..           
+0006d220: 2020 2020 2020 2020 2020 2020 2020 2020                  
+0006d230: 206d 6f64 656c 2e66 6974 2878 5f74 7261   model.fit(x_tra
+0006d240: 696e 2c20 795f 7472 6169 6e29 0d0a 2020  in, y_train)..  
+0006d250: 2020 2020 2020 2020 2020 2020 2020 2020                  
+0006d260: 2020 656c 7365 3a0d 0a20 2020 2020 2020    else:..       
+0006d270: 2020 2020 2020 2020 2020 2020 2020 2020                  
+0006d280: 2069 6620 6576 616c 5f73 6574 3d3d 5b28   if eval_set==[(
+0006d290: 295d 206f 7220 6d6f 6465 6c74 7970 6520  )] or modeltype 
+0006d2a0: 3d3d 2027 4d75 6c74 695f 436c 6173 7369  == 'Multi_Classi
+0006d2b0: 6669 6361 7469 6f6e 273a 0d0a 2020 2020  fication':..    
+0006d2c0: 2020 2020 2020 2020 2020 2020 2020 2020                  
+0006d2d0: 2020 2020 2020 2020 6d6f 6465 6c2e 6669          model.fi
+0006d2e0: 7428 785f 7472 6169 6e2c 2079 5f74 7261  t(x_train, y_tra
+0006d2f0: 696e 290d 0a20 2020 2020 2020 2020 2020  in)..           
+0006d300: 2020 2020 2020 2020 2020 2020 2065 6c73               els
+0006d310: 653a 0d0a 2020 2020 2020 2020 2020 2020  e:..            
+0006d320: 2020 2020 2020 2020 2020 2020 2020 2020                  
+0006d330: 6d6f 6465 6c2e 6669 7428 785f 7472 6169  model.fit(x_trai
+0006d340: 6e2c 2079 5f74 7261 696e 2c20 6561 726c  n, y_train, earl
+0006d350: 795f 7374 6f70 7069 6e67 5f72 6f75 6e64  y_stopping_round
+0006d360: 733d 6561 726c 795f 7374 6f70 7069 6e67  s=early_stopping
+0006d370: 2c0d 0a20 2020 2020 2020 2020 2020 2020  ,..             
+0006d380: 2020 2020 2020 2020 2020 2020 2020 2020                  
+0006d390: 2020 2065 7661 6c5f 6d65 7472 6963 3d65     eval_metric=e
+0006d3a0: 7661 6c5f 6d65 7472 6963 2c65 7661 6c5f  val_metric,eval_
+0006d3b0: 7365 743d 6576 616c 5f73 6574 2c76 6572  set=eval_set,ver
+0006d3c0: 626f 7365 3d46 616c 7365 290d 0a20 2020  bose=False)..   
+0006d3d0: 2020 2020 2020 2020 2065 6c73 653a 0d0a           else:..
+0006d3e0: 2020 2020 2020 2020 2020 2020 2020 2020                  
+0006d3f0: 6561 726c 795f 7374 6f70 7069 6e67 203d  early_stopping =
+0006d400: 2032 300d 0a20 2020 2020 2020 2020 2020   20..           
+0006d410: 2020 2020 2069 6620 6576 616c 5f73 6574       if eval_set
+0006d420: 203d 3d20 5b28 295d 3a0d 0a20 2020 2020   == [()]:..     
+0006d430: 2020 2020 2020 2020 2020 2020 2020 206d                 m
+0006d440: 6f64 656c 2e66 6974 2878 5f74 7261 696e  odel.fit(x_train
+0006d450: 2c20 795f 7472 6169 6e2c 2063 6174 5f66  , y_train, cat_f
+0006d460: 6561 7475 7265 733d 696d 705f 6361 7473  eatures=imp_cats
+0006d470: 2c70 6c6f 743d 4661 6c73 652c 2076 6572  ,plot=False, ver
+0006d480: 626f 7365 3d31 290d 0a20 2020 2020 2020  bose=1)..       
+0006d490: 2020 2020 2020 2020 2065 6c73 653a 0d0a           else:..
+0006d4a0: 2020 2020 2020 2020 2020 2020 2020 2020                  
+0006d4b0: 2020 2020 6d6f 6465 6c2e 6669 7428 785f      model.fit(x_
+0006d4c0: 7472 6169 6e2c 2079 5f74 7261 696e 2c20  train, y_train, 
+0006d4d0: 6361 745f 6665 6174 7572 6573 3d69 6d70  cat_features=imp
+0006d4e0: 5f63 6174 732c 2076 6572 626f 7365 3d31  _cats, verbose=1
+0006d4f0: 2c0d 0a20 2020 2020 2020 2020 2020 2020  ,..             
+0006d500: 2020 2020 2020 2020 2020 2020 2020 2020                  
+0006d510: 2020 2065 7661 6c5f 7365 743d 6576 616c     eval_set=eval
+0006d520: 5f73 6574 2c20 7573 655f 6265 7374 5f6d  _set, use_best_m
+0006d530: 6f64 656c 3d54 7275 652c 2070 6c6f 743d  odel=True, plot=
+0006d540: 4661 6c73 6529 0d0a 2020 2020 2020 2020  False)..        
+0006d550: 656c 7365 3a0d 0a20 2020 2020 2020 2020  else:..         
+0006d560: 2020 206d 6f64 656c 2e66 6974 2878 5f74     model.fit(x_t
+0006d570: 7261 696e 2c20 795f 7472 6169 6e29 0d0a  rain, y_train)..
+0006d580: 2020 2020 656c 7365 3a0d 0a20 2020 2020      else:..     
+0006d590: 2020 206d 6f64 656c 2e66 6974 2878 5f74     model.fit(x_t
+0006d5a0: 7261 696e 2c20 795f 7472 6169 6e29 0d0a  rain, y_train)..
+0006d5b0: 2020 2020 7265 7475 726e 206d 6f64 656c      return model
+0006d5c0: 0d0a 2323 2323 2323 2323 2323 2323 2323  ..##############
+0006d5d0: 2323 2323 2323 2323 2323 2323 2323 2323  ################
+0006d5e0: 2323 2323 2323 2323 2323 2323 2323 2323  ################
+0006d5f0: 2323 2323 2323 2323 2323 2323 2323 2323  ################
+0006d600: 2323 2323 2323 2323 2323 2323 2323 2323  ################
+0006d610: 2323 230d 0a66 726f 6d20 736b 6c65 6172  ###..from sklear
+0006d620: 6e2e 6d6f 6465 6c5f 7365 6c65 6374 696f  n.model_selectio
+0006d630: 6e20 696d 706f 7274 2074 7261 696e 5f74  n import train_t
+0006d640: 6573 745f 7370 6c69 740d 0a69 6d70 6f72  est_split..impor
+0006d650: 7420 6e75 6d70 7920 6173 206e 700d 0a66  t numpy as np..f
+0006d660: 726f 6d20 736b 6c65 6172 6e2e 6d65 7472  rom sklearn.metr
+0006d670: 6963 7320 696d 706f 7274 2066 315f 7363  ics import f1_sc
+0006d680: 6f72 650d 0a69 6d70 6f72 7420 636f 7079  ore..import copy
+0006d690: 0d0a 696d 706f 7274 206d 6174 706c 6f74  ..import matplot
+0006d6a0: 6c69 622e 7079 706c 6f74 2061 7320 706c  lib.pyplot as pl
+0006d6b0: 740d 0a66 726f 6d20 696e 7370 6563 7420  t..from inspect 
+0006d6c0: 696d 706f 7274 2073 6967 6e61 7475 7265  import signature
+0006d6d0: 0d0a 6672 6f6d 2073 6b6c 6561 726e 2e70  ..from sklearn.p
+0006d6e0: 7265 7072 6f63 6573 7369 6e67 2069 6d70  reprocessing imp
+0006d6f0: 6f72 7420 6c61 6265 6c5f 6269 6e61 7269  ort label_binari
+0006d700: 7a65 0d0a 6672 6f6d 2073 6b6c 6561 726e  ze..from sklearn
+0006d710: 2e6d 6574 7269 6373 2069 6d70 6f72 7420  .metrics import 
+0006d720: 7072 6563 6973 696f 6e5f 7265 6361 6c6c  precision_recall
+0006d730: 5f63 7572 7665 0d0a 6672 6f6d 2073 6b6c  _curve..from skl
+0006d740: 6561 726e 2e6d 6574 7269 6373 2069 6d70  earn.metrics imp
+0006d750: 6f72 7420 6176 6572 6167 655f 7072 6563  ort average_prec
+0006d760: 6973 696f 6e5f 7363 6f72 650d 0a66 726f  ision_score..fro
+0006d770: 6d20 6974 6572 746f 6f6c 7320 696d 706f  m itertools impo
+0006d780: 7274 2063 7963 6c65 0d0a 2323 2323 2323  rt cycle..######
+0006d790: 2323 2323 2323 2323 2323 2323 2323 2323  ################
+0006d7a0: 2323 2323 2323 2323 2323 2323 2323 2323  ################
+0006d7b0: 2323 2323 2323 2323 2323 2323 2323 2323  ################
+0006d7c0: 2323 2323 2323 2323 2323 2323 2323 2323  ################
+0006d7d0: 2323 2323 2323 2323 2323 2323 2323 2323  ################
+0006d7e0: 2323 2323 2323 230d 0a64 6566 206d 756c  #######..def mul
+0006d7f0: 7469 5f66 3128 7472 7574 682c 2070 7265  ti_f1(truth, pre
+0006d800: 6469 6374 696f 6e73 293a 0d0a 2020 2020  dictions):..    
+0006d810: 7265 7475 726e 2066 315f 7363 6f72 6528  return f1_score(
+0006d820: 7472 7574 682c 2070 7265 6469 6374 696f  truth, predictio
+0006d830: 6e73 2c61 7665 7261 6765 3d4e 6f6e 6529  ns,average=None)
+0006d840: 0d0a 6465 6620 6d75 6c74 695f 7072 6563  ..def multi_prec
+0006d850: 6973 696f 6e28 7472 7574 682c 2070 7265  ision(truth, pre
+0006d860: 6469 6374 696f 6e73 293a 0d0a 2020 2020  dictions):..    
+0006d870: 7265 7475 726e 2070 7265 6369 7369 6f6e  return precision
+0006d880: 5f73 636f 7265 2874 7275 7468 2c20 7072  _score(truth, pr
+0006d890: 6564 6963 7469 6f6e 732c 6176 6572 6167  edictions,averag
+0006d8a0: 653d 4e6f 6e65 290d 0a23 2323 2323 2323  e=None)..#######
+0006d8b0: 2323 2323 2323 2323 2323 2323 2323 2323  ################
+0006d8c0: 2323 2323 2323 2323 2323 2323 2323 2323  ################
+0006d8d0: 2323 2323 2323 2323 2323 2323 2323 2323  ################
+0006d8e0: 2323 2323 2323 2323 2323 2323 2323 2323  ################
+0006d8f0: 2323 2323 2323 2323 2323 2323 2323 2323  ################
+0006d900: 2323 2323 2323 230d 0a64 6566 2044 7261  #######..def Dra
+0006d910: 775f 4d43 5f4d 4c5f 5052 5f52 4f43 5f43  w_MC_ML_PR_ROC_C
+0006d920: 7572 7665 7328 636c 6173 7369 6669 6572  urves(classifier
+0006d930: 2c58 5f74 6573 742c 795f 7465 7374 293a  ,X_test,y_test):
+0006d940: 0d0a 2020 2020 2222 220d 0a20 2020 203d  ..    """..    =
+0006d950: 3d3d 3d3d 3d3d 3d3d 3d3d 3d3d 3d3d 3d3d  ================
+0006d960: 3d3d 3d3d 3d3d 3d3d 3d3d 3d3d 3d3d 3d3d  ================
+0006d970: 3d3d 3d3d 3d3d 3d3d 3d3d 3d3d 3d3d 3d3d  ================
+0006d980: 3d3d 3d3d 3d3d 3d3d 3d3d 3d3d 3d3d 3d3d  ================
+0006d990: 3d3d 3d3d 3d3d 3d3d 3d3d 3d3d 3d3d 3d3d  ================
+0006d9a0: 3d3d 3d3d 3d3d 3d0d 0a20 2020 2050 7265  =======..    Pre
+0006d9b0: 6369 7369 6f6e 2d52 6563 616c 6c20 4375  cision-Recall Cu
+0006d9c0: 7276 6573 3a20 4578 7465 6e73 696f 6e20  rves: Extension 
+0006d9d0: 6f66 204f 7269 6769 6e61 6c20 5665 7273  of Original Vers
+0006d9e0: 696f 6e20 696e 2053 4b4c 6561 726e 2773  ion in SKLearn's
+0006d9f0: 2044 6f63 756d 656e 7461 7469 6f6e 2050   Documentation P
+0006da00: 6167 653a 0d0a 2020 2020 6874 7470 733a  age:..    https:
+0006da10: 2f2f 7363 696b 6974 2d6c 6561 726e 2e6f  //scikit-learn.o
+0006da20: 7267 2f73 7461 626c 652f 6175 746f 5f65  rg/stable/auto_e
+0006da30: 7861 6d70 6c65 732f 6d6f 6465 6c5f 7365  xamples/model_se
+0006da40: 6c65 6374 696f 6e2f 706c 6f74 5f70 7265  lection/plot_pre
+0006da50: 6369 7369 6f6e 5f72 6563 616c 6c2e 6874  cision_recall.ht
+0006da60: 6d6c 0d0a 2020 2020 3d3d 3d3d 3d3d 3d3d  ml..    ========
+0006da70: 3d3d 3d3d 3d3d 3d3d 3d3d 3d3d 3d3d 3d3d  ================
+0006da80: 3d3d 3d3d 3d3d 3d3d 3d3d 3d3d 3d3d 3d3d  ================
+0006da90: 3d3d 3d3d 3d3d 3d3d 3d3d 3d3d 3d3d 3d3d  ================
+0006daa0: 3d3d 3d3d 3d3d 3d3d 3d3d 3d3d 3d3d 3d3d  ================
+0006dab0: 3d3d 3d3d 3d3d 3d3d 3d3d 3d3d 3d3d 3d3d  ================
+0006dac0: 0d0a 2020 2020 2222 220d 0a20 2020 2066  ..    """..    f
+0006dad0: 6967 7369 7a65 203d 2028 3130 2c20 3629  igsize = (10, 6)
+0006dae0: 0d0a 2020 2020 2323 2323 2323 2323 2323  ..    ##########
+0006daf0: 2323 2323 2323 2323 2323 2323 2323 2323  ################
+0006db00: 2323 2323 2323 2323 2323 2323 2323 2323  ################
+0006db10: 2323 2323 2323 2323 2323 2323 2323 2323  ################
+0006db20: 2323 2323 2323 2323 2323 2323 2323 2323  ################
+0006db30: 2323 2323 230d 0a20 2020 2023 2049 6e20  #####..    # In 
+0006db40: 6269 6e61 7279 2063 6c61 7373 6966 6963  binary classific
+0006db50: 6174 696f 6e20 7365 7474 696e 6773 0d0a  ation settings..
+0006db60: 2020 2020 2320 436f 6d70 7574 6520 7468      # Compute th
+0006db70: 6520 6176 6572 6167 6520 7072 6563 6973  e average precis
+0006db80: 696f 6e20 7363 6f72 6520 666f 7220 4269  ion score for Bi
+0006db90: 6e61 7279 2043 6c61 7373 6573 0d0a 2020  nary Classes..  
+0006dba0: 2020 2323 2323 2323 2323 2323 2323 2323    ##############
+0006dbb0: 2323 2323 2323 2323 2323 2323 2323 2323  ################
+0006dbc0: 2323 2323 2323 2323 2323 2323 2323 2323  ################
+0006dbd0: 2323 2323 2323 2323 2323 2323 2323 2323  ################
+0006dbe0: 2323 2323 2323 2323 2323 2323 2323 2323  ################
+0006dbf0: 230d 0a20 2020 2079 5f70 7265 6420 3d20  #..    y_pred = 
+0006dc00: 636c 6173 7369 6669 6572 2e70 7265 6469  classifier.predi
+0006dc10: 6374 2858 5f74 6573 7429 0d0a 2020 2020  ct(X_test)..    
+0006dc20: 6966 206c 656e 286c 6566 745f 7375 6274  if len(left_subt
+0006dc30: 7261 6374 286e 702e 756e 6971 7565 2879  ract(np.unique(y
+0006dc40: 5f74 6573 7429 2c6e 702e 756e 6971 7565  _test),np.unique
+0006dc50: 2879 5f70 7265 6429 2929 203d 3d20 303a  (y_pred))) == 0:
+0006dc60: 0d0a 2020 2020 2020 2020 636c 6173 7365  ..        classe
+0006dc70: 7320 3d20 6c69 7374 2872 616e 6765 286c  s = list(range(l
+0006dc80: 656e 286e 702e 756e 6971 7565 2879 5f74  en(np.unique(y_t
+0006dc90: 6573 7429 2929 290d 0a20 2020 2065 6c73  est))))..    els
+0006dca0: 653a 0d0a 2020 2020 2020 2020 636c 6173  e:..        clas
+0006dcb0: 7365 7320 3d20 6c69 7374 2872 616e 6765  ses = list(range
+0006dcc0: 286c 656e 286e 702e 756e 6971 7565 2879  (len(np.unique(y
+0006dcd0: 5f70 7265 6429 2929 290d 0a20 2020 2023  _pred))))..    #
+0006dce0: 636c 6173 7365 7320 3d20 6c69 7374 2872  classes = list(r
+0006dcf0: 616e 6765 286c 656e 286e 702e 756e 6971  ange(len(np.uniq
+0006dd00: 7565 2879 5f74 6573 7429 2929 290d 0a20  ue(y_test)))).. 
+0006dd10: 2020 206e 5f63 6c61 7373 6573 203d 206c     n_classes = l
+0006dd20: 656e 2863 6c61 7373 6573 290d 0a20 2020  en(classes)..   
+0006dd30: 2069 6620 6e5f 636c 6173 7365 7320 3d3d   if n_classes ==
+0006dd40: 2032 3a0d 0a20 2020 2020 2020 2074 7279   2:..        try
+0006dd50: 3a0d 0a20 2020 2020 2020 2020 2020 2079  :..            y
+0006dd60: 5f73 636f 7265 203d 2063 6c61 7373 6966  _score = classif
+0006dd70: 6965 722e 6465 6369 7369 6f6e 5f66 756e  ier.decision_fun
+0006dd80: 6374 696f 6e28 585f 7465 7374 290d 0a20  ction(X_test).. 
+0006dd90: 2020 2020 2020 2065 7863 6570 743a 0d0a         except:..
+0006dda0: 2020 2020 2020 2020 2020 2020 795f 7363              y_sc
+0006ddb0: 6f72 6520 3d20 636c 6173 7369 6669 6572  ore = classifier
+0006ddc0: 2e70 7265 6469 6374 5f70 726f 6261 2858  .predict_proba(X
+0006ddd0: 5f74 6573 7429 0d0a 2020 2020 2020 2020  _test)..        
+0006dde0: 7472 793a 0d0a 2020 2020 2020 2020 2020  try:..          
+0006ddf0: 2020 6176 6572 6167 655f 7072 6563 6973    average_precis
+0006de00: 696f 6e20 3d20 6176 6572 6167 655f 7072  ion = average_pr
+0006de10: 6563 6973 696f 6e5f 7363 6f72 6528 795f  ecision_score(y_
+0006de20: 7465 7374 2c20 795f 7363 6f72 6529 0d0a  test, y_score)..
+0006de30: 2020 2020 2020 2020 6578 6365 7074 3a0d          except:.
+0006de40: 0a20 2020 2020 2020 2020 2020 2061 7665  .            ave
+0006de50: 7261 6765 5f70 7265 6369 7369 6f6e 203d  rage_precision =
+0006de60: 206d 756c 7469 5f70 7265 6369 7369 6f6e   multi_precision
+0006de70: 2879 5f74 6573 742c 2063 6c61 7373 6966  (y_test, classif
+0006de80: 6965 722e 7072 6564 6963 7428 585f 7465  ier.predict(X_te
+0006de90: 7374 2929 2e6d 6561 6e28 290d 0a20 2020  st)).mean()..   
+0006dea0: 2020 2020 2070 7269 6e74 2827 4176 6572       print('Aver
+0006deb0: 6167 6520 7072 6563 6973 696f 6e2d 7265  age precision-re
+0006dec0: 6361 6c6c 2073 636f 7265 3a20 7b30 3a30  call score: {0:0
+0006ded0: 2e32 667d 272e 666f 726d 6174 280d 0a20  .2f}'.format(.. 
+0006dee0: 2020 2020 2020 2020 2020 2020 2061 7665               ave
+0006def0: 7261 6765 5f70 7265 6369 7369 6f6e 2929  rage_precision))
+0006df00: 0d0a 2020 2020 2020 2020 665f 7363 6f72  ..        f_scor
+0006df10: 6573 203d 206d 756c 7469 5f66 3128 795f  es = multi_f1(y_
+0006df20: 7465 7374 2c63 6c61 7373 6966 6965 722e  test,classifier.
+0006df30: 7072 6564 6963 7428 585f 7465 7374 2929  predict(X_test))
+0006df40: 0d0a 2020 2020 2020 2020 7072 696e 7428  ..        print(
+0006df50: 274d 6163 726f 2046 3120 7363 6f72 652c  'Macro F1 score,
+0006df60: 2061 7665 7261 6765 6420 6f76 6572 2061   averaged over a
+0006df70: 6c6c 2063 6c61 7373 6573 3a20 7b30 3a30  ll classes: {0:0
+0006df80: 2e32 667d 270d 0a20 2020 2020 2020 2020  .2f}'..         
+0006df90: 2020 2020 202e 666f 726d 6174 2866 5f73       .format(f_s
+0006dfa0: 636f 7265 732e 6d65 616e 2829 2929 0d0a  cores.mean()))..
+0006dfb0: 2020 2020 2020 2020 2323 2323 2323 2323          ########
+0006dfc0: 2323 2323 2323 2323 2323 2323 2323 2323  ################
+0006dfd0: 2323 2323 2323 2323 2323 2323 2323 2323  ################
+0006dfe0: 2323 2323 2323 2323 2323 2323 2323 2323  ################
+0006dff0: 2323 2323 2323 2323 2323 2323 2323 2323  ################
+0006e000: 2323 2323 2323 230d 0a20 2020 2020 2020  #######..       
+0006e010: 2023 2050 6c6f 7420 7468 6520 5072 6563   # Plot the Prec
+0006e020: 6973 696f 6e2d 5265 6361 6c6c 2063 7572  ision-Recall cur
+0006e030: 7665 0d0a 2020 2020 2020 2020 2320 2e2e  ve..        # ..
+0006e040: 2e2e 2e2e 2e2e 2e2e 2e2e 2e2e 2e2e 2e2e  ................
+0006e050: 2e2e 2e2e 2e2e 2e2e 2e2e 2e2e 2e2e 0d0a  ................
+0006e060: 2020 2020 2020 2020 706c 742e 6669 6775          plt.figu
+0006e070: 7265 2866 6967 7369 7a65 3d66 6967 7369  re(figsize=figsi
+0006e080: 7a65 290d 0a20 2020 2020 2020 2074 7279  ze)..        try
+0006e090: 3a0d 0a20 2020 2020 2020 2020 2020 2023  :..            #
+0006e0a0: 2323 2054 6869 7320 776f 726b 7320 666f  ## This works fo
+0006e0b0: 7220 4c6f 6769 7374 6963 2052 6567 7265  r Logistic Regre
+0006e0c0: 7373 696f 6e20 616e 6420 6f74 6865 7220  ssion and other 
+0006e0d0: 4c69 6e65 6172 204d 6f64 656c 7320 2323  Linear Models ##
+0006e0e0: 2323 0d0a 2020 2020 2020 2020 2020 2020  ##..            
+0006e0f0: 7072 6563 6973 696f 6e2c 2072 6563 616c  precision, recal
+0006e100: 6c2c 205f 203d 2070 7265 6369 7369 6f6e  l, _ = precision
+0006e110: 5f72 6563 616c 6c5f 6375 7276 6528 795f  _recall_curve(y_
+0006e120: 7465 7374 2c20 795f 7363 6f72 6529 0d0a  test, y_score)..
+0006e130: 2020 2020 2020 2020 6578 6365 7074 3a0d          except:.
+0006e140: 0a20 2020 2020 2020 2020 2020 2023 2323  .            ###
+0006e150: 2054 6869 7320 776f 726b 7320 666f 7220   This works for 
+0006e160: 4e6f 6e20 4c69 6e65 6172 204d 6f64 656c  Non Linear Model
+0006e170: 7320 7375 6368 2061 7320 466f 7265 7374  s such as Forest
+0006e180: 7320 616e 6420 5847 426f 6f73 7420 2323  s and XGBoost ##
+0006e190: 2323 230d 0a20 2020 2020 2020 2020 2020  ###..           
+0006e1a0: 2070 7265 6369 7369 6f6e 2c20 7265 6361   precision, reca
+0006e1b0: 6c6c 2c20 5f20 3d20 7072 6563 6973 696f  ll, _ = precisio
+0006e1c0: 6e5f 7265 6361 6c6c 5f63 7572 7665 2879  n_recall_curve(y
+0006e1d0: 5f74 6573 742c 2079 5f73 636f 7265 5b3a  _test, y_score[:
+0006e1e0: 2c31 5d29 0d0a 0d0a 2020 2020 2020 2020  ,1])....        
+0006e1f0: 2320 496e 206d 6174 706c 6f74 6c69 6220  # In matplotlib 
+0006e200: 3c20 312e 352c 2070 6c74 2e66 696c 6c5f  < 1.5, plt.fill_
+0006e210: 6265 7477 6565 6e20 646f 6573 206e 6f74  between does not
+0006e220: 2068 6176 6520 6120 2773 7465 7027 2061   have a 'step' a
+0006e230: 7267 756d 656e 740d 0a20 2020 2020 2020  rgument..       
+0006e240: 2073 7465 705f 6b77 6172 6773 203d 2028   step_kwargs = (
+0006e250: 7b27 7374 6570 273a 2027 706f 7374 277d  {'step': 'post'}
+0006e260: 0d0a 2020 2020 2020 2020 2020 2020 2020  ..              
+0006e270: 2020 2020 2020 2020 2069 6620 2773 7465           if 'ste
+0006e280: 7027 2069 6e20 7369 676e 6174 7572 6528  p' in signature(
+0006e290: 706c 742e 6669 6c6c 5f62 6574 7765 656e  plt.fill_between
+0006e2a0: 292e 7061 7261 6d65 7465 7273 0d0a 2020  ).parameters..  
+0006e2b0: 2020 2020 2020 2020 2020 2020 2020 2020                  
+0006e2c0: 2020 2020 2065 6c73 6520 7b7d 290d 0a20       else {}).. 
+0006e2d0: 2020 2020 2020 2070 6c74 2e73 7465 7028         plt.step(
+0006e2e0: 7265 6361 6c6c 2c20 7072 6563 6973 696f  recall, precisio
+0006e2f0: 6e2c 2063 6f6c 6f72 3d27 6727 2c20 616c  n, color='g', al
+0006e300: 7068 613d 302e 322c 0d0a 2020 2020 2020  pha=0.2,..      
+0006e310: 2020 2020 2020 2020 2020 2077 6865 7265             where
+0006e320: 3d27 706f 7374 2729 0d0a 2020 2020 2020  ='post')..      
+0006e330: 2020 706c 742e 6669 6c6c 5f62 6574 7765    plt.fill_betwe
+0006e340: 656e 2872 6563 616c 6c2c 2070 7265 6369  en(recall, preci
+0006e350: 7369 6f6e 2c20 616c 7068 613d 302e 322c  sion, alpha=0.2,
+0006e360: 2063 6f6c 6f72 3d27 6727 2c20 2a2a 7374   color='g', **st
+0006e370: 6570 5f6b 7761 7267 7329 0d0a 0d0a 2020  ep_kwargs)....  
+0006e380: 2020 2020 2020 706c 742e 786c 6162 656c        plt.xlabel
+0006e390: 2827 5265 6361 6c6c 2729 0d0a 2020 2020  ('Recall')..    
+0006e3a0: 2020 2020 706c 742e 796c 6162 656c 2827      plt.ylabel('
+0006e3b0: 5072 6563 6973 696f 6e27 290d 0a20 2020  Precision')..   
+0006e3c0: 2020 2020 2070 6c74 2e79 6c69 6d28 5b30       plt.ylim([0
+0006e3d0: 2e30 2c20 312e 3035 5d29 0d0a 2020 2020  .0, 1.05])..    
+0006e3e0: 2020 2020 706c 742e 786c 696d 285b 302e      plt.xlim([0.
+0006e3f0: 302c 2031 2e30 5d29 0d0a 2020 2020 2020  0, 1.0])..      
+0006e400: 2020 706c 742e 7469 746c 6528 2750 7265    plt.title('Pre
+0006e410: 6369 7369 6f6e 2d52 6563 616c 6c20 6375  cision-Recall cu
+0006e420: 7276 653a 2041 7667 2e50 7265 6369 7369  rve: Avg.Precisi
+0006e430: 6f6e 3d7b 303a 302e 3266 7d2c 2041 7667  on={0:0.2f}, Avg
+0006e440: 2046 313d 7b31 3a30 2e32 667d 272e 666f   F1={1:0.2f}'.fo
+0006e450: 726d 6174 280d 0a20 2020 2020 2020 2020  rmat(..         
+0006e460: 2020 2020 2020 2020 2061 7665 7261 6765           average
+0006e470: 5f70 7265 6369 7369 6f6e 2c66 5f73 636f  _precision,f_sco
+0006e480: 7265 732e 6d65 616e 2829 2929 0d0a 2020  res.mean()))..  
+0006e490: 2020 2020 2020 706c 742e 7368 6f77 2829        plt.show()
+0006e4a0: 3b0d 0a20 2020 2020 2020 2023 2323 2323  ;..        #####
 0006e4b0: 2323 2323 2323 2323 2323 2323 2323 2323  ################
-0006e4c0: 2323 2323 230d 0a20 2020 2020 2020 2023  #####..        #
-0006e4d0: 2050 6c6f 7420 5072 6563 6973 696f 6e2d   Plot Precision-
-0006e4e0: 5265 6361 6c6c 2063 7572 7665 2066 6f72  Recall curve for
-0006e4f0: 2065 6163 6820 636c 6173 7320 616e 6420   each class and 
-0006e500: 6973 6f2d 6631 2063 7572 7665 730d 0a20  iso-f1 curves.. 
-0006e510: 2020 2020 2020 2023 2050 6c6f 7420 7468         # Plot th
-0006e520: 6520 6d69 6372 6f2d 6176 6572 6167 6564  e micro-averaged
-0006e530: 2050 7265 6369 7369 6f6e 2d52 6563 616c   Precision-Recal
-0006e540: 6c20 6375 7276 650d 0a20 2020 2020 2020  l curve..       
-0006e550: 2023 2323 2323 2323 2323 2323 2323 2323   ###############
-0006e560: 2323 2323 2323 2323 2323 2323 2323 2323  ################
-0006e570: 2323 2323 2323 2323 2323 2323 2323 2323  ################
-0006e580: 2323 2323 2323 2323 2323 2323 2323 2323  ################
-0006e590: 2323 2323 2323 2323 2323 2323 2323 2323  ################
-0006e5a0: 0d0a 2020 2020 2020 2020 2320 2e2e 2e2e  ..        # ....
+0006e4c0: 2323 2323 2323 2323 2323 2323 2323 2323  ################
+0006e4d0: 2323 2323 2323 2323 2323 2323 2323 2323  ################
+0006e4e0: 2323 2323 2323 2323 2323 2323 2323 2323  ################
+0006e4f0: 2323 2323 2323 2323 2323 0d0a 2020 2020  ##########..    
+0006e500: 656c 7365 3a0d 0a20 2020 2020 2020 2023  else:..        #
+0006e510: 2049 6e20 6d75 6c74 692d 6c61 6265 6c20   In multi-label 
+0006e520: 7365 7474 696e 6773 0d0a 2020 2020 2020  settings..      
+0006e530: 2020 2320 2d2d 2d2d 2d2d 2d2d 2d2d 2d2d    # ------------
+0006e540: 2d2d 2d2d 2d2d 2d2d 2d2d 2d2d 0d0a 2020  ------------..  
+0006e550: 2020 2020 2020 230d 0a20 2020 2020 2020        #..       
+0006e560: 2023 2043 7265 6174 6520 6d75 6c74 692d   # Create multi-
+0006e570: 6c61 6265 6c20 6461 7461 2c20 6669 742c  label data, fit,
+0006e580: 2061 6e64 2070 7265 6469 6374 0d0a 2020   and predict..  
+0006e590: 2020 2020 2020 2320 2e2e 2e2e 2e2e 2e2e        # ........
+0006e5a0: 2e2e 2e2e 2e2e 2e2e 2e2e 2e2e 2e2e 2e2e  ................
 0006e5b0: 2e2e 2e2e 2e2e 2e2e 2e2e 2e2e 2e2e 2e2e  ................
-0006e5c0: 2e2e 2e2e 2e2e 2e2e 2e2e 2e2e 2e2e 2e2e  ................
-0006e5d0: 2e2e 2e2e 2e2e 2e2e 2e2e 2e2e 2e2e 2e2e  ................
-0006e5e0: 2e2e 2e2e 2e2e 2e2e 2e0d 0a20 2020 2020  ...........     
-0006e5f0: 2020 2023 0d0a 2020 2020 2020 2020 2320     #..        # 
-0006e600: 7365 7475 7020 706c 6f74 2064 6574 6169  setup plot detai
-0006e610: 6c73 0d0a 2020 2020 2020 2020 636f 6c6f  ls..        colo
-0006e620: 7273 203d 2063 7963 6c65 2827 6279 7263  rs = cycle('byrc
-0006e630: 6d67 6b62 7972 636d 676b 6279 7263 6d67  mgkbyrcmgkbyrcmg
-0006e640: 6b62 7972 636d 676b 2729 0d0a 0d0a 2020  kbyrcmgk')....  
-0006e650: 2020 2020 2020 706c 742e 6669 6775 7265        plt.figure
-0006e660: 2866 6967 7369 7a65 3d66 6967 7369 7a65  (figsize=figsize
-0006e670: 290d 0a20 2020 2020 2020 2066 5f73 636f  )..        f_sco
-0006e680: 7265 7320 3d20 6d75 6c74 695f 6631 2879  res = multi_f1(y
-0006e690: 5f74 6573 742c 636c 6173 7369 6669 6572  _test,classifier
-0006e6a0: 2e70 7265 6469 6374 2858 5f74 6573 7429  .predict(X_test)
-0006e6b0: 290d 0a20 2020 2020 2020 2070 7269 6e74  )..        print
-0006e6c0: 2827 4d61 6372 6f20 4631 2073 636f 7265  ('Macro F1 score
-0006e6d0: 2c20 6176 6572 6167 6564 206f 7665 7220  , averaged over 
-0006e6e0: 616c 6c20 636c 6173 7365 733a 207b 303a  all classes: {0:
-0006e6f0: 302e 3266 7d27 0d0a 2020 2020 2020 2020  0.2f}'..        
-0006e700: 2020 2020 2020 2e66 6f72 6d61 7428 665f        .format(f_
-0006e710: 7363 6f72 6573 2e6d 6561 6e28 2929 290d  scores.mean())).
-0006e720: 0a20 2020 2020 2020 206c 696e 6573 203d  .        lines =
-0006e730: 205b 5d0d 0a20 2020 2020 2020 206c 6162   []..        lab
-0006e740: 656c 7320 3d20 5b5d 0d0a 2020 2020 2020  els = []..      
-0006e750: 2020 666f 7220 665f 7363 6f72 6520 696e    for f_score in
-0006e760: 2066 5f73 636f 7265 733a 0d0a 2020 2020   f_scores:..    
-0006e770: 2020 2020 2020 2020 7820 3d20 6e70 2e6c          x = np.l
-0006e780: 696e 7370 6163 6528 302e 3031 2c20 3129  inspace(0.01, 1)
-0006e790: 0d0a 2020 2020 2020 2020 2020 2020 7920  ..            y 
-0006e7a0: 3d20 665f 7363 6f72 6520 2a20 7820 2f20  = f_score * x / 
-0006e7b0: 2832 202a 2078 202d 2066 5f73 636f 7265  (2 * x - f_score
-0006e7c0: 290d 0a20 2020 2020 2020 2020 2020 206c  )..            l
-0006e7d0: 2c20 3d20 706c 742e 706c 6f74 2878 5b79  , = plt.plot(x[y
-0006e7e0: 203e 3d20 305d 2c20 795b 7920 3e3d 2030   >= 0], y[y >= 0
-0006e7f0: 5d2c 2063 6f6c 6f72 3d27 6772 6179 272c  ], color='gray',
-0006e800: 2061 6c70 6861 3d30 2e32 290d 0a20 2020   alpha=0.2)..   
-0006e810: 2020 2020 2020 2020 2070 6c74 2e61 6e6e           plt.ann
-0006e820: 6f74 6174 6528 2766 313d 7b30 3a30 2e32  otate('f1={0:0.2
-0006e830: 667d 272e 666f 726d 6174 2866 5f73 636f  f}'.format(f_sco
-0006e840: 7265 292c 2078 793d 2830 2e39 2c20 795b  re), xy=(0.9, y[
-0006e850: 3435 5d20 2b20 302e 3032 2929 0d0a 0d0a  45] + 0.02))....
-0006e860: 2020 2020 2020 2020 6c69 6e65 732e 6170          lines.ap
-0006e870: 7065 6e64 286c 290d 0a20 2020 2020 2020  pend(l)..       
-0006e880: 206c 6162 656c 732e 6170 7065 6e64 2827   labels.append('
-0006e890: 6973 6f2d 6631 2063 7572 7665 7327 290d  iso-f1 curves').
-0006e8a0: 0a20 2020 2020 2020 206c 2c20 3d20 706c  .        l, = pl
-0006e8b0: 742e 706c 6f74 2872 6563 616c 6c5b 226d  t.plot(recall["m
-0006e8c0: 6963 726f 225d 2c20 7072 6563 6973 696f  icro"], precisio
-0006e8d0: 6e5b 226d 6963 726f 225d 2c20 636f 6c6f  n["micro"], colo
-0006e8e0: 723d 2767 6f6c 6427 2c20 6c77 3d32 290d  r='gold', lw=2).
-0006e8f0: 0a20 2020 2020 2020 206c 696e 6573 2e61  .        lines.a
-0006e900: 7070 656e 6428 6c29 0d0a 2020 2020 2020  ppend(l)..      
-0006e910: 2020 6c61 6265 6c73 2e61 7070 656e 6428    labels.append(
-0006e920: 276d 6963 726f 2d61 7665 7261 6765 2050  'micro-average P
-0006e930: 7265 6369 7369 6f6e 2d72 6563 616c 6c20  recision-recall 
-0006e940: 2861 7265 6120 3d20 7b30 3a30 2e32 667d  (area = {0:0.2f}
-0006e950: 2927 0d0a 2020 2020 2020 2020 2020 2020  )'..            
-0006e960: 2020 2020 2020 2020 2020 2727 2e66 6f72            ''.for
-0006e970: 6d61 7428 6176 6572 6167 655f 7072 6563  mat(average_prec
-0006e980: 6973 696f 6e5b 226d 6963 726f 225d 2929  ision["micro"]))
-0006e990: 0d0a 0d0a 2020 2020 2020 2020 666f 7220  ....        for 
-0006e9a0: 692c 2063 6f6c 6f72 2069 6e20 7a69 7028  i, color in zip(
-0006e9b0: 7261 6e67 6528 6e5f 636c 6173 7365 7329  range(n_classes)
-0006e9c0: 2c20 636f 6c6f 7273 293a 0d0a 2020 2020  , colors):..    
-0006e9d0: 2020 2020 2020 2020 6c2c 203d 2070 6c74          l, = plt
-0006e9e0: 2e70 6c6f 7428 7265 6361 6c6c 5b69 5d2c  .plot(recall[i],
-0006e9f0: 2070 7265 6369 7369 6f6e 5b69 5d2c 2063   precision[i], c
-0006ea00: 6f6c 6f72 3d63 6f6c 6f72 2c20 6c77 3d31  olor=color, lw=1
-0006ea10: 290d 0a20 2020 2020 2020 2020 2020 206c  )..            l
-0006ea20: 696e 6573 2e61 7070 656e 6428 6c29 0d0a  ines.append(l)..
-0006ea30: 2020 2020 2020 2020 2020 2020 6c61 6265              labe
-0006ea40: 6c73 2e61 7070 656e 6428 2750 7265 6369  ls.append('Preci
-0006ea50: 7369 6f6e 2d72 6563 616c 6c20 666f 7220  sion-recall for 
-0006ea60: 636c 6173 7320 7b30 7d20 2861 7265 6120  class {0} (area 
-0006ea70: 3d20 7b31 3a30 2e32 667d 2927 0d0a 2020  = {1:0.2f})'..  
-0006ea80: 2020 2020 2020 2020 2020 2020 2020 2020                  
-0006ea90: 2020 2020 2020 2020 2727 2e66 6f72 6d61          ''.forma
-0006eaa0: 7428 692c 2061 7665 7261 6765 5f70 7265  t(i, average_pre
-0006eab0: 6369 7369 6f6e 5b69 5d29 290d 0a0d 0a20  cision[i])).... 
-0006eac0: 2020 2020 2020 2066 6967 203d 2070 6c74         fig = plt
-0006ead0: 2e67 6366 2829 0d0a 2020 2020 2020 2020  .gcf()..        
-0006eae0: 6669 672e 7375 6270 6c6f 7473 5f61 646a  fig.subplots_adj
-0006eaf0: 7573 7428 626f 7474 6f6d 3d30 2e32 3529  ust(bottom=0.25)
-0006eb00: 0d0a 2020 2020 2020 2020 706c 742e 786c  ..        plt.xl
-0006eb10: 696d 285b 302e 302c 2031 2e30 5d29 0d0a  im([0.0, 1.0])..
-0006eb20: 2020 2020 2020 2020 706c 742e 796c 696d          plt.ylim
-0006eb30: 285b 302e 302c 2031 2e30 355d 290d 0a20  ([0.0, 1.05]).. 
-0006eb40: 2020 2020 2020 2070 6c74 2e78 6c61 6265         plt.xlabe
-0006eb50: 6c28 2752 6563 616c 6c27 290d 0a20 2020  l('Recall')..   
-0006eb60: 2020 2020 2070 6c74 2e79 6c61 6265 6c28       plt.ylabel(
-0006eb70: 2750 7265 6369 7369 6f6e 2729 0d0a 2020  'Precision')..  
-0006eb80: 2020 2020 2020 706c 742e 7469 746c 6528        plt.title(
-0006eb90: 274d 6963 726f 2041 7667 2050 7265 6369  'Micro Avg Preci
-0006eba0: 7369 6f6e 2d52 6563 616c 6c20 6375 7276  sion-Recall curv
-0006ebb0: 6520 7769 7468 2069 736f 2d66 3120 6375  e with iso-f1 cu
-0006ebc0: 7276 6573 2729 0d0a 2020 2020 2020 2020  rves')..        
-0006ebd0: 706c 742e 6c65 6765 6e64 286c 696e 6573  plt.legend(lines
-0006ebe0: 2c20 6c61 6265 6c73 2c20 6c6f 633d 276c  , labels, loc='l
-0006ebf0: 6f77 6572 206c 6566 7427 2c20 7072 6f70  ower left', prop
-0006ec00: 3d64 6963 7428 7369 7a65 3d31 3029 290d  =dict(size=10)).
-0006ec10: 0a20 2020 2020 2020 2070 6c74 2e73 686f  .        plt.sho
-0006ec20: 7728 293b 0d0a 2323 2323 2323 2323 2323  w();..##########
+0006e5c0: 2e2e 2e0d 0a20 2020 2020 2020 2023 0d0a  .....        #..
+0006e5d0: 2020 2020 2020 2020 2320 5765 2063 7265          # We cre
+0006e5e0: 6174 6520 6120 6d75 6c74 692d 6c61 6265  ate a multi-labe
+0006e5f0: 6c20 6461 7461 7365 742c 2074 6f20 696c  l dataset, to il
+0006e600: 6c75 7374 7261 7465 2074 6865 2070 7265  lustrate the pre
+0006e610: 6369 7369 6f6e 2d72 6563 616c 6c20 696e  cision-recall in
+0006e620: 0d0a 2020 2020 2020 2020 2320 6d75 6c74  ..        # mult
+0006e630: 692d 6c61 6265 6c20 7365 7474 696e 6773  i-label settings
+0006e640: 0d0a 0d0a 2020 2020 2020 2020 2320 5573  ....        # Us
+0006e650: 6520 6c61 6265 6c5f 6269 6e61 7269 7a65  e label_binarize
+0006e660: 2074 6f20 6265 206d 756c 7469 2d6c 6162   to be multi-lab
+0006e670: 656c 206c 696b 6520 7365 7474 696e 6773  el like settings
+0006e680: 0d0a 2020 2020 2020 2020 5920 3d20 6c61  ..        Y = la
+0006e690: 6265 6c5f 6269 6e61 7269 7a65 2879 5f74  bel_binarize(y_t
+0006e6a0: 6573 742c 2063 6c61 7373 6573 290d 0a20  est, classes).. 
+0006e6b0: 2020 2020 2020 206e 5f63 6c61 7373 6573         n_classes
+0006e6c0: 203d 2059 2e73 6861 7065 5b31 5d0d 0a20   = Y.shape[1].. 
+0006e6d0: 2020 2020 2020 2059 5f74 6573 7420 3d20         Y_test = 
+0006e6e0: 636f 7079 2e64 6565 7063 6f70 7928 5929  copy.deepcopy(Y)
+0006e6f0: 0d0a 2020 2020 2020 2020 7472 793a 0d0a  ..        try:..
+0006e700: 2020 2020 2020 2020 2020 2020 795f 7363              y_sc
+0006e710: 6f72 6520 3d20 636c 6173 7369 6669 6572  ore = classifier
+0006e720: 2e64 6563 6973 696f 6e5f 6675 6e63 7469  .decision_functi
+0006e730: 6f6e 2858 5f74 6573 7429 0d0a 2020 2020  on(X_test)..    
+0006e740: 2020 2020 6578 6365 7074 3a0d 0a20 2020      except:..   
+0006e750: 2020 2020 2020 2020 2079 5f73 636f 7265           y_score
+0006e760: 203d 2063 6c61 7373 6966 6965 722e 7072   = classifier.pr
+0006e770: 6564 6963 745f 7072 6f62 6128 585f 7465  edict_proba(X_te
+0006e780: 7374 290d 0a0d 0a20 2020 2020 2020 2023  st)....        #
+0006e790: 2323 2323 2323 2323 2323 2323 2323 2323  ################
+0006e7a0: 2323 2323 2323 2323 2323 2323 2323 2323  ################
+0006e7b0: 2323 2323 2323 2323 2323 2323 2323 2323  ################
+0006e7c0: 2323 2323 2323 2323 2323 2323 2323 2323  ################
+0006e7d0: 2323 2323 2323 2323 2323 2323 2323 0d0a  ##############..
+0006e7e0: 2020 2020 2020 2020 2320 5468 6520 6176          # The av
+0006e7f0: 6572 6167 6520 7072 6563 6973 696f 6e20  erage precision 
+0006e800: 7363 6f72 6520 696e 206d 756c 7469 2d6c  score in multi-l
+0006e810: 6162 656c 2073 6574 7469 6e67 730d 0a20  abel settings.. 
+0006e820: 2020 2020 2020 2023 202e 2e2e 2e2e 2e2e         # .......
+0006e830: 2e2e 2e2e 2e2e 2e2e 2e2e 2e2e 2e2e 2e2e  ................
+0006e840: 2e2e 2e2e 2e2e 2e2e 2e2e 2e2e 2e2e 2e2e  ................
+0006e850: 2e2e 2e2e 2e2e 2e2e 2e2e 2e2e 2e0d 0a0d  ................
+0006e860: 0a20 2020 2020 2020 2023 2046 6f72 2065  .        # For e
+0006e870: 6163 6820 636c 6173 730d 0a20 2020 2020  ach class..     
+0006e880: 2020 2070 7265 6369 7369 6f6e 203d 2064     precision = d
+0006e890: 6963 7428 290d 0a20 2020 2020 2020 2072  ict()..        r
+0006e8a0: 6563 616c 6c20 3d20 6469 6374 2829 0d0a  ecall = dict()..
+0006e8b0: 2020 2020 2020 2020 6176 6572 6167 655f          average_
+0006e8c0: 7072 6563 6973 696f 6e20 3d20 6469 6374  precision = dict
+0006e8d0: 2829 0d0a 2020 2020 2020 2020 666f 7220  ()..        for 
+0006e8e0: 6920 696e 2072 616e 6765 286e 5f63 6c61  i in range(n_cla
+0006e8f0: 7373 6573 293a 0d0a 2020 2020 2020 2020  sses):..        
+0006e900: 2020 2020 7072 6563 6973 696f 6e5b 695d      precision[i]
+0006e910: 2c20 7265 6361 6c6c 5b69 5d2c 205f 203d  , recall[i], _ =
+0006e920: 2070 7265 6369 7369 6f6e 5f72 6563 616c   precision_recal
+0006e930: 6c5f 6375 7276 6528 595f 7465 7374 5b3a  l_curve(Y_test[:
+0006e940: 2c20 695d 2c0d 0a20 2020 2020 2020 2020  , i],..         
+0006e950: 2020 2020 2020 2020 2020 2020 2020 2020                  
+0006e960: 2020 2020 2020 2020 2020 2020 2020 2020                  
+0006e970: 2020 2020 2020 2020 2020 2020 2020 2020                  
+0006e980: 2020 2020 2020 2079 5f73 636f 7265 5b3a         y_score[:
+0006e990: 2c20 695d 290d 0a20 2020 2020 2020 2020  , i])..         
+0006e9a0: 2020 2061 7665 7261 6765 5f70 7265 6369     average_preci
+0006e9b0: 7369 6f6e 5b69 5d20 3d20 6176 6572 6167  sion[i] = averag
+0006e9c0: 655f 7072 6563 6973 696f 6e5f 7363 6f72  e_precision_scor
+0006e9d0: 6528 595f 7465 7374 5b3a 2c20 695d 2c20  e(Y_test[:, i], 
+0006e9e0: 795f 7363 6f72 655b 3a2c 2069 5d29 0d0a  y_score[:, i])..
+0006e9f0: 0d0a 2020 2020 2020 2020 2320 4120 226d  ..        # A "m
+0006ea00: 6963 726f 2d61 7665 7261 6765 223a 2071  icro-average": q
+0006ea10: 7561 6e74 6966 7969 6e67 2073 636f 7265  uantifying score
+0006ea20: 206f 6e20 616c 6c20 636c 6173 7365 7320   on all classes 
+0006ea30: 6a6f 696e 746c 790d 0a20 2020 2020 2020  jointly..       
+0006ea40: 2070 7265 6369 7369 6f6e 5b22 6d69 6372   precision["micr
+0006ea50: 6f22 5d2c 2072 6563 616c 6c5b 226d 6963  o"], recall["mic
+0006ea60: 726f 225d 2c20 5f20 3d20 7072 6563 6973  ro"], _ = precis
+0006ea70: 696f 6e5f 7265 6361 6c6c 5f63 7572 7665  ion_recall_curve
+0006ea80: 2859 5f74 6573 745b 0d0a 2020 2020 2020  (Y_test[..      
+0006ea90: 2020 2020 2020 2020 2020 2020 2020 2020                  
+0006eaa0: 2020 3a2c 3a6e 5f63 6c61 7373 6573 5d2e    :,:n_classes].
+0006eab0: 7261 7665 6c28 292c 795f 7363 6f72 655b  ravel(),y_score[
+0006eac0: 3a2c 3a6e 5f63 6c61 7373 6573 5d2e 7261  :,:n_classes].ra
+0006ead0: 7665 6c28 2929 0d0a 2020 2020 2020 2020  vel())..        
+0006eae0: 6176 6572 6167 655f 7072 6563 6973 696f  average_precisio
+0006eaf0: 6e5b 226d 6963 726f 225d 203d 2061 7665  n["micro"] = ave
+0006eb00: 7261 6765 5f70 7265 6369 7369 6f6e 5f73  rage_precision_s
+0006eb10: 636f 7265 2859 5f74 6573 745b 0d0a 2020  core(Y_test[..  
+0006eb20: 2020 2020 2020 2020 2020 2020 2020 2020                  
+0006eb30: 2020 2020 2020 3a2c 3a6e 5f63 6c61 7373        :,:n_class
+0006eb40: 6573 5d2c 2079 5f73 636f 7265 5b3a 2c3a  es], y_score[:,:
+0006eb50: 6e5f 636c 6173 7365 735d 2c61 7665 7261  n_classes],avera
+0006eb60: 6765 3d22 6d69 6372 6f22 290d 0a20 2020  ge="micro")..   
+0006eb70: 2020 2020 2070 7269 6e74 2827 4176 6572       print('Aver
+0006eb80: 6167 6520 7072 6563 6973 696f 6e20 7363  age precision sc
+0006eb90: 6f72 652c 206d 6963 726f 2d61 7665 7261  ore, micro-avera
+0006eba0: 6765 6420 6f76 6572 2061 6c6c 2063 6c61  ged over all cla
+0006ebb0: 7373 6573 3a20 7b30 3a30 2e32 667d 270d  sses: {0:0.2f}'.
+0006ebc0: 0a20 2020 2020 2020 2020 2020 2020 202e  .              .
+0006ebd0: 666f 726d 6174 2861 7665 7261 6765 5f70  format(average_p
+0006ebe0: 7265 6369 7369 6f6e 5b22 6d69 6372 6f22  recision["micro"
+0006ebf0: 5d29 290d 0a0d 0a20 2020 2020 2020 2023  ]))....        #
+0006ec00: 2323 2323 2323 2323 2323 2323 2323 2323  ################
+0006ec10: 2323 2323 2323 2323 2323 2323 2323 2323  ################
+0006ec20: 2323 2323 2323 2323 2323 2323 2323 2323  ################
 0006ec30: 2323 2323 2323 2323 2323 2323 2323 2323  ################
-0006ec40: 2323 2323 2323 2323 2323 2323 2323 2323  ################
-0006ec50: 2323 2323 2323 2323 2323 2323 2323 2323  ################
-0006ec60: 2323 2323 2323 2323 2323 2323 2323 2323  ################
-0006ec70: 2323 2323 2323 2323 2323 2323 0d0a 696d  ############..im
-0006ec80: 706f 7274 206d 6174 706c 6f74 6c69 622e  port matplotlib.
-0006ec90: 7079 706c 6f74 2061 7320 706c 740d 0a69  pyplot as plt..i
-0006eca0: 6d70 6f72 7420 7365 6162 6f72 6e20 6173  mport seaborn as
-0006ecb0: 2073 6e73 0d0a 6465 6620 6472 6177 5f63   sns..def draw_c
-0006ecc0: 6f6e 6675 7369 6f6e 5f6d 6178 7472 6978  onfusion_maxtrix
-0006ecd0: 2879 5f74 6573 742c 795f 7072 6564 2c20  (y_test,y_pred, 
-0006ece0: 6d6f 6465 6c5f 6e61 6d65 3d27 4d6f 6465  model_name='Mode
-0006ecf0: 6c27 2c61 783d 2727 293a 0d0a 2020 2020  l',ax=''):..    
-0006ed00: 2222 220d 0a20 2020 2054 6869 7320 706c  """..    This pl
-0006ed10: 6f74 7320 6120 6265 6175 7469 6675 6c20  ots a beautiful 
-0006ed20: 636f 6e66 7573 696f 6e20 6d61 7472 6978  confusion matrix
-0006ed30: 2062 6173 6564 206f 6e20 696e 7075 743a   based on input:
-0006ed40: 2067 726f 756e 6420 7472 7574 6873 2061   ground truths a
-0006ed50: 6e64 2070 7265 6469 6374 696f 6e73 0d0a  nd predictions..
-0006ed60: 2020 2020 2222 220d 0a20 2020 2023 436f      """..    #Co
-0006ed70: 6e66 7573 696f 6e20 4d61 7472 6978 0d0a  nfusion Matrix..
-0006ed80: 2020 2020 2727 2750 6c6f 7474 696e 6720      '''Plotting 
-0006ed90: 434f 4e46 5553 494f 4e20 4d41 5452 4958  CONFUSION MATRIX
-0006eda0: 2727 270d 0a20 2020 2069 6d70 6f72 7420  '''..    import 
-0006edb0: 7365 6162 6f72 6e20 6173 2073 6e73 0d0a  seaborn as sns..
-0006edc0: 2020 2020 736e 732e 7365 745f 7374 796c      sns.set_styl
-0006edd0: 6528 2764 6172 6b67 7269 6427 290d 0a0d  e('darkgrid')...
-0006ede0: 0a20 2020 2027 2727 4469 7370 6c61 7927  .    '''Display'
-0006edf0: 2727 0d0a 2020 2020 6672 6f6d 2049 5079  ''..    from IPy
-0006ee00: 7468 6f6e 2e63 6f72 652e 6469 7370 6c61  thon.core.displa
-0006ee10: 7920 696d 706f 7274 2064 6973 706c 6179  y import display
-0006ee20: 2c20 4854 4d4c 0d0a 2020 2020 6469 7370  , HTML..    disp
-0006ee30: 6c61 7928 4854 4d4c 2822 3c73 7479 6c65  lay(HTML("<style
-0006ee40: 3e2e 636f 6e74 6169 6e65 7220 7b20 7769  >.container { wi
-0006ee50: 6474 683a 3935 2520 2169 6d70 6f72 7461  dth:95% !importa
-0006ee60: 6e74 3b20 7d3c 2f73 7479 6c65 3e22 2929  nt; }</style>"))
-0006ee70: 0d0a 2020 2020 7064 2e6f 7074 696f 6e73  ..    pd.options
-0006ee80: 2e64 6973 706c 6179 2e66 6c6f 6174 5f66  .display.float_f
-0006ee90: 6f72 6d61 7420 3d20 277b 3a2c 2e32 667d  ormat = '{:,.2f}
-0006eea0: 272e 666f 726d 6174 0d0a 0d0a 2020 2020  '.format....    
-0006eeb0: 2347 6574 2074 6865 2063 6f6e 6675 7369  #Get the confusi
-0006eec0: 6f6e 206d 6174 7269 7820 616e 6420 7075  on matrix and pu
-0006eed0: 7420 6974 2069 6e74 6f20 6120 6466 0d0a  t it into a df..
-0006eee0: 2020 2020 6672 6f6d 2073 6b6c 6561 726e      from sklearn
-0006eef0: 2e6d 6574 7269 6373 2069 6d70 6f72 7420  .metrics import 
-0006ef00: 636f 6e66 7573 696f 6e5f 6d61 7472 6978  confusion_matrix
-0006ef10: 2c20 6631 5f73 636f 7265 0d0a 0d0a 2020  , f1_score....  
-0006ef20: 2020 636d 203d 2063 6f6e 6675 7369 6f6e    cm = confusion
-0006ef30: 5f6d 6174 7269 7828 795f 7465 7374 2c20  _matrix(y_test, 
-0006ef40: 795f 7072 6564 290d 0a0d 0a20 2020 2063  y_pred)....    c
-0006ef50: 6d5f 6466 203d 2070 642e 4461 7461 4672  m_df = pd.DataFr
-0006ef60: 616d 6528 636d 2c0d 0a20 2020 2020 2020  ame(cm,..       
-0006ef70: 2020 2020 2020 2020 2020 2020 2020 2020                  
-0006ef80: 2020 696e 6465 7820 3d20 6e70 2e75 6e69    index = np.uni
-0006ef90: 7175 6528 795f 7465 7374 292e 746f 6c69  que(y_test).toli
-0006efa0: 7374 2829 2c0d 0a20 2020 2020 2020 2020  st(),..         
-0006efb0: 2020 2020 2020 2020 2020 2020 2020 2020                  
-0006efc0: 636f 6c75 6d6e 7320 3d20 6e70 2e75 6e69  columns = np.uni
-0006efd0: 7175 6528 795f 7465 7374 292e 746f 6c69  que(y_test).toli
-0006efe0: 7374 2829 2c0d 0a20 2020 2020 2020 2020  st(),..         
-0006eff0: 2020 2020 2020 2020 2020 2020 2020 2029                 )
-0006f000: 0d0a 0d0a 2020 2020 736e 732e 6865 6174  ....    sns.heat
-0006f010: 6d61 7028 636d 5f64 662c 0d0a 2020 2020  map(cm_df,..    
-0006f020: 2020 2020 2020 2020 2020 2020 6365 6e74              cent
-0006f030: 6572 3d30 2c0d 0a20 2020 2020 2020 2020  er=0,..         
-0006f040: 2020 2020 2020 2063 6d61 703d 736e 732e         cmap=sns.
-0006f050: 6469 7665 7267 696e 675f 7061 6c65 7474  diverging_palett
-0006f060: 6528 3232 302c 2031 352c 2061 735f 636d  e(220, 15, as_cm
-0006f070: 6170 3d54 7275 6529 2c0d 0a20 2020 2020  ap=True),..     
-0006f080: 2020 2020 2020 2020 2020 2061 6e6e 6f74             annot
-0006f090: 3d54 7275 652c 0d0a 2020 2020 2020 2020  =True,..        
-0006f0a0: 2020 2020 2020 2020 666d 743d 2767 272c          fmt='g',
-0006f0b0: 0d0a 2020 2020 2020 2020 2020 2020 2020  ..              
-0006f0c0: 2061 783d 6178 290d 0a0d 0a20 2020 2061   ax=ax)....    a
-0006f0d0: 782e 7365 745f 7469 746c 6528 2720 2573  x.set_title(' %s
-0006f0e0: 205c 6e46 3120 5363 6f72 6528 6176 6720   \nF1 Score(avg 
-0006f0f0: 3d20 6d69 6372 6f29 3a20 2530 2e32 6620  = micro): %0.2f 
-0006f100: 5c6e 4631 2053 636f 7265 2861 7667 203d  \nF1 Score(avg =
-0006f110: 206d 6163 726f 293a 2025 302e 3266 2720   macro): %0.2f' 
-0006f120: 2528 0d0a 2020 2020 2020 2020 6d6f 6465  %(..        mode
-0006f130: 6c5f 6e61 6d65 2c66 315f 7363 6f72 6528  l_name,f1_score(
-0006f140: 795f 7465 7374 2c20 795f 7072 6564 2c20  y_test, y_pred, 
-0006f150: 6176 6572 6167 653d 276d 6963 726f 2729  average='micro')
-0006f160: 2c66 315f 7363 6f72 6528 795f 7465 7374  ,f1_score(y_test
-0006f170: 2c20 795f 7072 6564 2c20 6176 6572 6167  , y_pred, averag
-0006f180: 653d 276d 6163 726f 2729 292c 0d0a 2020  e='macro')),..  
-0006f190: 2020 2020 2020 2020 2020 2020 666f 6e74              font
-0006f1a0: 7369 7a65 203d 2031 3329 0d0a 2020 2020  size = 13)..    
-0006f1b0: 6178 2e73 6574 5f79 6c61 6265 6c28 2754  ax.set_ylabel('T
-0006f1c0: 7275 6520 6c61 6265 6c27 2c20 666f 6e74  rue label', font
-0006f1d0: 7369 7a65 203d 2031 3329 0d0a 2020 2020  size = 13)..    
-0006f1e0: 6178 2e73 6574 5f78 6c61 6265 6c28 2750  ax.set_xlabel('P
-0006f1f0: 7265 6469 6374 6564 206c 6162 656c 272c  redicted label',
-0006f200: 2066 6f6e 7473 697a 6520 3d20 3133 290d   fontsize = 13).
-0006f210: 0a23 2323 2323 2323 2323 2323 2323 2323  .###############
-0006f220: 2323 2323 2323 2323 2323 2323 2323 2323  ################
-0006f230: 2323 2323 2323 2323 2323 2323 2323 2323  ################
-0006f240: 2323 2323 2323 2323 2323 2323 2323 2323  ################
-0006f250: 2323 2323 2323 2323 2323 2323 2323 2323  ################
-0006f260: 2323 2323 2323 230d 0a66 726f 6d20 736b  #######..from sk
-0006f270: 6c65 6172 6e2e 6d65 7472 6963 7320 696d  learn.metrics im
-0006f280: 706f 7274 2063 6c61 7373 6966 6963 6174  port classificat
-0006f290: 696f 6e5f 7265 706f 7274 2c20 726f 635f  ion_report, roc_
-0006f2a0: 6375 7276 650d 0a69 6d70 6f72 7420 6d61  curve..import ma
-0006f2b0: 7470 6c6f 746c 6962 2e70 7970 6c6f 7420  tplotlib.pyplot 
-0006f2c0: 6173 2070 6c74 0d0a 696d 706f 7274 2073  as plt..import s
-0006f2d0: 6561 626f 726e 2061 7320 736e 730d 0a0d  eaborn as sns...
-0006f2e0: 0a66 726f 6d20 736b 6c65 6172 6e2e 6d65  .from sklearn.me
-0006f2f0: 7472 6963 7320 696d 706f 7274 2072 6f63  trics import roc
-0006f300: 5f63 7572 7665 2c20 7072 6563 6973 696f  _curve, precisio
-0006f310: 6e5f 7265 6361 6c6c 5f63 7572 7665 0d0a  n_recall_curve..
-0006f320: 0d0a 6465 6620 706c 6f74 5f70 7265 6369  ..def plot_preci
-0006f330: 7369 6f6e 5f72 6563 616c 6c5f 6375 7276  sion_recall_curv
-0006f340: 6528 6d2c 2078 5f74 6573 7463 2c20 795f  e(m, x_testc, y_
-0006f350: 7465 7374 2c20 6178 3d4e 6f6e 6529 3a0d  test, ax=None):.
-0006f360: 0a20 2020 2023 2323 2320 5468 6973 2069  .    #### This i
-0006f370: 7320 6120 7369 6d70 6c65 2077 6179 2074  s a simple way t
-0006f380: 6f20 706c 6f74 2050 5220 6375 7276 6520  o plot PR curve 
-0006f390: 666f 7220 6269 6e61 7279 2063 6c61 7373  for binary class
-0006f3a0: 6573 2023 2323 2323 0d0a 2020 2020 795f  es #####..    y_
-0006f3b0: 7363 6f72 6573 203d 206d 2e70 7265 6469  scores = m.predi
-0006f3c0: 6374 5f70 726f 6261 2878 5f74 6573 7463  ct_proba(x_testc
-0006f3d0: 295b 3a2c 315d 0d0a 2020 2020 2323 2320  )[:,1]..    ### 
-0006f3e0: 6765 6e65 7261 7465 2074 6865 2070 7265  generate the pre
-0006f3f0: 6369 7369 6f6e 2072 6563 616c 6c20 6375  cision recall cu
-0006f400: 7276 6520 2323 2323 2323 2323 2323 0d0a  rve ##########..
-0006f410: 2020 2020 702c 2072 2c20 7468 7265 7368      p, r, thresh
-0006f420: 6f6c 6473 203d 2070 7265 6369 7369 6f6e  olds = precision
-0006f430: 5f72 6563 616c 6c5f 6375 7276 6528 795f  _recall_curve(y_
-0006f440: 7465 7374 2c20 795f 7363 6f72 6573 290d  test, y_scores).
-0006f450: 0a20 2020 2023 2323 2320 706c 6f74 2074  .    #### plot t
-0006f460: 6865 2063 7572 7665 2023 2323 2323 2323  he curve #######
-0006f470: 2323 230d 0a20 2020 2061 782e 7365 745f  ###..    ax.set_
-0006f480: 7469 746c 6528 2250 7265 6369 7369 6f6e  title("Precision
-0006f490: 2052 6563 616c 6c20 4375 7276 6522 290d   Recall Curve").
-0006f4a0: 0a20 2020 2061 782e 706c 6f74 2872 2c20  .    ax.plot(r, 
-0006f4b0: 702c 2063 6f6c 6f72 3d22 7075 7270 6c65  p, color="purple
-0006f4c0: 2229 0d0a 2020 2020 6178 2e73 6574 5f79  ")..    ax.set_y
-0006f4d0: 6c69 6d28 5b30 2e35 2c20 312e 3031 5d29  lim([0.5, 1.01])
-0006f4e0: 0d0a 2020 2020 6178 2e73 6574 5f78 6c69  ..    ax.set_xli
-0006f4f0: 6d28 5b30 2e35 2c20 312e 3031 5d29 0d0a  m([0.5, 1.01])..
-0006f500: 2020 2020 6178 2e73 6574 5f78 6c61 6265      ax.set_xlabe
-0006f510: 6c28 2752 6563 616c 6c27 290d 0a20 2020  l('Recall')..   
-0006f520: 2061 782e 7365 745f 796c 6162 656c 2827   ax.set_ylabel('
-0006f530: 5072 6563 6973 696f 6e27 290d 0a0d 0a64  Precision')....d
-0006f540: 6566 2070 6c6f 745f 726f 635f 6375 7276  ef plot_roc_curv
-0006f550: 6528 6d2c 2078 5f74 6573 7463 2c20 795f  e(m, x_testc, y_
-0006f560: 7465 7374 2c20 6178 3d4e 6f6e 6529 3a0d  test, ax=None):.
-0006f570: 0a20 2020 2023 2323 2320 5468 6973 2069  .    #### This i
-0006f580: 7320 6120 7369 6d70 6c65 2077 6179 2074  s a simple way t
-0006f590: 6f20 706c 6f74 2052 4f43 2063 7572 7665  o plot ROC curve
-0006f5a0: 2066 6f72 2062 696e 6172 7920 636c 6173   for binary clas
-0006f5b0: 7365 7320 2323 2323 230d 0a20 2020 2079  ses #####..    y
-0006f5c0: 5f73 636f 7265 7320 3d20 6d2e 7072 6564  _scores = m.pred
-0006f5d0: 6963 745f 7072 6f62 6128 785f 7465 7374  ict_proba(x_test
-0006f5e0: 6329 5b3a 2c31 5d0d 0a20 2020 2023 2323  c)[:,1]..    ###
-0006f5f0: 2067 656e 6572 6174 6520 7468 6520 7072   generate the pr
-0006f600: 6563 6973 696f 6e20 7265 6361 6c6c 2063  ecision recall c
-0006f610: 7572 7665 2023 2323 2323 2323 2323 230d  urve ##########.
-0006f620: 0a20 2020 2066 7072 2c20 7470 722c 205f  .    fpr, tpr, _
-0006f630: 203d 2072 6f63 5f63 7572 7665 2879 5f74   = roc_curve(y_t
-0006f640: 6573 742c 2020 795f 7363 6f72 6573 290d  est,  y_scores).
-0006f650: 0a20 2020 2023 2323 2320 706c 6f74 2074  .    #### plot t
-0006f660: 6865 2063 7572 7665 2023 2323 2323 2323  he curve #######
-0006f670: 2323 230d 0a20 2020 2061 782e 7365 745f  ###..    ax.set_
-0006f680: 7469 746c 6528 2252 4f43 2041 5543 2043  title("ROC AUC C
-0006f690: 7572 7665 2229 0d0a 2020 2020 6178 2e70  urve")..    ax.p
-0006f6a0: 6c6f 7428 6670 722c 7470 722c 2063 6f6c  lot(fpr,tpr, col
-0006f6b0: 6f72 3d22 7075 7270 6c65 2229 0d0a 2020  or="purple")..  
-0006f6c0: 2020 6178 2e73 6574 5f79 6c69 6d28 5b30    ax.set_ylim([0
-0006f6d0: 2e30 2c20 312e 3031 5d29 0d0a 2020 2020  .0, 1.01])..    
-0006f6e0: 6178 2e73 6574 5f78 6c69 6d28 5b30 2e30  ax.set_xlim([0.0
-0006f6f0: 2c20 312e 3031 5d29 0d0a 2020 2020 6178  , 1.01])..    ax
-0006f700: 2e73 6574 5f78 6c61 6265 6c28 2746 616c  .set_xlabel('Fal
-0006f710: 7365 2050 6f73 6974 6976 6520 5261 7465  se Positive Rate
-0006f720: 2729 0d0a 2020 2020 6178 2e73 6574 5f79  ')..    ax.set_y
-0006f730: 6c61 6265 6c28 2754 7275 6520 506f 7369  label('True Posi
-0006f740: 7469 7665 2052 6174 6527 290d 0a0d 0a0d  tive Rate').....
-0006f750: 0a64 6566 2070 6c6f 745f 636c 6173 7369  .def plot_classi
-0006f760: 6669 6361 7469 6f6e 5f72 6573 756c 7473  fication_results
-0006f770: 286d 2c20 585f 7472 7565 2c20 795f 7472  (m, X_true, y_tr
-0006f780: 7565 2c20 795f 7072 6564 2c20 6c61 6265  ue, y_pred, labe
-0006f790: 6c73 2c20 7461 7267 6574 5f6e 616d 6573  ls, target_names
-0006f7a0: 2c20 6561 6368 5f74 6172 6765 7429 3a0d  , each_target):.
-0006f7b0: 0a20 2020 2023 2323 2320 5468 6573 6520  .    #### These 
-0006f7c0: 706c 6f74 7320 6172 6520 6f6e 6c79 2066  plots are only f
-0006f7d0: 6f72 2062 696e 6172 7920 636c 6173 7365  or binary classe
-0006f7e0: 7320 2323 2323 2323 2323 2323 2323 230d  s #############.
-0006f7f0: 0a20 2020 2074 7279 3a0d 0a20 2020 2020  .    try:..     
-0006f800: 2020 2066 6967 2c20 6178 6573 203d 2070     fig, axes = p
-0006f810: 6c74 2e73 7562 706c 6f74 7328 322c 322c  lt.subplots(2,2,
-0006f820: 6669 6773 697a 653d 2831 352c 3135 2929  figsize=(15,15))
-0006f830: 0d0a 2020 2020 2020 2020 706c 6f74 5f72  ..        plot_r
-0006f840: 6f63 5f63 7572 7665 286d 2c20 585f 7472  oc_curve(m, X_tr
-0006f850: 7565 2c20 795f 7472 7565 2c20 6178 3d61  ue, y_true, ax=a
-0006f860: 7865 735b 302c 315d 290d 0a20 2020 2020  xes[0,1])..     
-0006f870: 2020 2061 7865 735b 302c 315d 2e73 6574     axes[0,1].set
-0006f880: 5f74 6974 6c65 2827 524f 4320 4155 4320  _title('ROC AUC 
-0006f890: 4375 7276 653a 2025 7327 2025 6561 6368  Curve: %s' %each
-0006f8a0: 5f74 6172 6765 7429 0d0a 2020 2020 2020  _target)..      
-0006f8b0: 2020 706c 6f74 5f70 7265 6369 7369 6f6e    plot_precision
-0006f8c0: 5f72 6563 616c 6c5f 6375 7276 6528 6d2c  _recall_curve(m,
-0006f8d0: 2058 5f74 7275 652c 2079 5f74 7275 652c   X_true, y_true,
-0006f8e0: 2061 783d 6178 6573 5b31 2c30 5d29 0d0a   ax=axes[1,0])..
-0006f8f0: 2020 2020 2020 2020 6178 6573 5b31 2c30          axes[1,0
-0006f900: 5d2e 7365 745f 7469 746c 6528 2750 5220  ].set_title('PR 
-0006f910: 4155 4320 4375 7276 6520 666f 723a 2025  AUC Curve for: %
-0006f920: 7327 2025 6561 6368 5f74 6172 6765 7429  s' %each_target)
-0006f930: 0d0a 2020 2020 2020 2020 795f 7072 6564  ..        y_pred
-0006f940: 203d 206d 2e70 7265 6469 6374 2858 5f74   = m.predict(X_t
-0006f950: 7275 6529 0d0a 2020 2020 2020 2020 6472  rue)..        dr
-0006f960: 6177 5f63 6f6e 6675 7369 6f6e 5f6d 6178  aw_confusion_max
-0006f970: 7472 6978 2879 5f74 7275 652c 2079 5f70  trix(y_true, y_p
-0006f980: 7265 642c 2027 436f 6e66 7573 696f 6e20  red, 'Confusion 
-0006f990: 4d61 7472 6978 272c 2061 783d 6178 6573  Matrix', ax=axes
-0006f9a0: 5b30 2c30 5d29 0d0a 2020 2020 2020 2020  [0,0])..        
-0006f9b0: 7472 793a 0d0a 2020 2020 2020 2020 2020  try:..          
-0006f9c0: 2020 636c 665f 7265 706f 7274 203d 2063    clf_report = c
-0006f9d0: 6c61 7373 6966 6963 6174 696f 6e5f 7265  lassification_re
-0006f9e0: 706f 7274 2879 5f74 7275 652c 0d0a 2020  port(y_true,..  
-0006f9f0: 2020 2020 2020 2020 2020 2020 2020 2020                  
-0006fa00: 2020 2020 2020 2020 2020 2020 2020 2020                  
-0006fa10: 2020 2020 2020 2020 2020 2020 2079 5f70               y_p
-0006fa20: 7265 642c 0d0a 2020 2020 2020 2020 2020  red,..          
-0006fa30: 2020 2020 2020 2020 2020 2020 2020 2020                  
-0006fa40: 2020 2020 2020 2020 2020 2020 2020 2020                  
-0006fa50: 2020 2020 206c 6162 656c 733d 6c61 6265       labels=labe
-0006fa60: 6c73 2c0d 0a20 2020 2020 2020 2020 2020  ls,..           
-0006fa70: 2020 2020 2020 2020 2020 2020 2020 2020                  
-0006fa80: 2020 2020 2020 2020 2020 2020 2020 2020                  
-0006fa90: 2020 2020 7461 7267 6574 5f6e 616d 6573      target_names
-0006faa0: 3d74 6172 6765 745f 6e61 6d65 732c 0d0a  =target_names,..
-0006fab0: 2020 2020 2020 2020 2020 2020 2020 2020                  
-0006fac0: 2020 2020 2020 2020 2020 2020 2020 2020                  
-0006fad0: 2020 2020 2020 2020 2020 2020 2020 206f                 o
-0006fae0: 7574 7075 745f 6469 6374 3d54 7275 6529  utput_dict=True)
-0006faf0: 0d0a 2020 2020 2020 2020 6578 6365 7074  ..        except
-0006fb00: 3a0d 0a20 2020 2020 2020 2020 2020 2063  :..            c
-0006fb10: 6c66 5f72 6570 6f72 7420 3d20 636c 6173  lf_report = clas
-0006fb20: 7369 6669 6361 7469 6f6e 5f72 6570 6f72  sification_repor
-0006fb30: 7428 795f 7472 7565 2c79 5f70 7265 642c  t(y_true,y_pred,
-0006fb40: 6c61 6265 6c73 3d74 6172 6765 745f 6e61  labels=target_na
-0006fb50: 6d65 732c 0d0a 2020 2020 2020 2020 2020  mes,..          
-0006fb60: 2020 2020 2020 7461 7267 6574 5f6e 616d        target_nam
-0006fb70: 6573 3d6c 6162 656c 732c 6f75 7470 7574  es=labels,output
-0006fb80: 5f64 6963 743d 5472 7565 290d 0a20 2020  _dict=True)..   
-0006fb90: 2020 2020 2073 6e73 2e68 6561 746d 6170       sns.heatmap
-0006fba0: 2870 642e 4461 7461 4672 616d 6528 636c  (pd.DataFrame(cl
-0006fbb0: 665f 7265 706f 7274 292e 696c 6f63 5b3a  f_report).iloc[:
-0006fbc0: 2c20 3a5d 2e54 2c20 616e 6e6f 743d 5472  , :].T, annot=Tr
-0006fbd0: 7565 2c61 783d 6178 6573 5b31 2c31 5d2c  ue,ax=axes[1,1],
-0006fbe0: 666d 743d 2730 2e32 6627 293b 0d0a 2020  fmt='0.2f');..  
-0006fbf0: 2020 2020 2020 6178 6573 5b31 2c31 5d2e        axes[1,1].
-0006fc00: 7365 745f 7469 746c 6528 2743 6c61 7373  set_title('Class
-0006fc10: 6966 6963 6174 696f 6e20 5265 706f 7274  ification Report
-0006fc20: 3a20 2573 2720 2565 6163 685f 7461 7267  : %s' %each_targ
-0006fc30: 6574 290d 0a20 2020 2065 7863 6570 743a  et)..    except:
-0006fc40: 0d0a 2020 2020 2020 2020 7072 696e 7428  ..        print(
-0006fc50: 2745 7272 6f72 3a20 636f 756c 6420 6e6f  'Error: could no
-0006fc60: 7420 706c 6f74 2063 6c61 7373 6966 6963  t plot classific
-0006fc70: 6174 696f 6e20 7265 7375 6c74 732e 2043  ation results. C
-0006fc80: 6f6e 7469 6e75 696e 672e 2e2e 2729 0d0a  ontinuing...')..
-0006fc90: 0d0a 6672 6f6d 2073 6b6c 6561 726e 2e6d  ..from sklearn.m
-0006fca0: 6574 7269 6373 2069 6d70 6f72 7420 636c  etrics import cl
-0006fcb0: 6173 7369 6669 6361 7469 6f6e 5f72 6570  assification_rep
-0006fcc0: 6f72 742c 2063 6f6e 6675 7369 6f6e 5f6d  ort, confusion_m
-0006fcd0: 6174 7269 780d 0a66 726f 6d20 736b 6c65  atrix..from skle
-0006fce0: 6172 6e2e 6d65 7472 6963 7320 696d 706f  arn.metrics impo
-0006fcf0: 7274 2062 616c 616e 6365 645f 6163 6375  rt balanced_accu
-0006fd00: 7261 6379 5f73 636f 7265 0d0a 6465 6620  racy_score..def 
-0006fd10: 7072 696e 745f 636c 6173 7369 6669 6361  print_classifica
-0006fd20: 7469 6f6e 5f6d 6f64 656c 5f73 7461 7473  tion_model_stats
-0006fd30: 2879 5f74 7275 652c 2070 7265 6469 6374  (y_true, predict
-0006fd40: 6564 2c20 6d5f 7468 7265 7368 3d30 2e35  ed, m_thresh=0.5
-0006fd50: 293a 0d0a 2020 2020 2222 220d 0a20 2020  ):..    """..   
-0006fd60: 2054 6869 7320 7072 696e 7473 2063 6c61   This prints cla
-0006fd70: 7373 6966 6963 6174 696f 6e20 6d65 7472  ssification metr
-0006fd80: 6963 7320 696e 2061 206e 6963 6520 666f  ics in a nice fo
-0006fd90: 726d 6174 206f 6e6c 7920 666f 7220 6269  rmat only for bi
-0006fda0: 6e61 7279 2063 6c61 7373 6573 0d0a 2020  nary classes..  
-0006fdb0: 2020 2222 220d 0a20 2020 2023 2055 7365    """..    # Use
-0006fdc0: 2074 6869 7320 746f 2054 6573 7420 436c   this to Test Cl
-0006fdd0: 6173 7369 6669 6361 7469 6f6e 2050 726f  assification Pro
-0006fde0: 626c 656d 7320 4f6e 6c79 2023 2323 230d  blems Only ####.
-0006fdf0: 0a20 2020 2074 7279 3a0d 0a20 2020 2020  .    try:..     
-0006fe00: 2020 2072 6172 655f 636c 6173 7320 3d20     rare_class = 
-0006fe10: 6669 6e64 5f72 6172 655f 636c 6173 7328  find_rare_class(
-0006fe20: 795f 7472 7565 290d 0a20 2020 2020 2020  y_true)..       
-0006fe30: 2072 6567 5f61 6363 203d 205b 302c 305d   reg_acc = [0,0]
-0006fe40: 0d0a 2020 2020 2020 2020 666f 7220 692c  ..        for i,
-0006fe50: 7468 7265 7368 6f6c 6420 696e 207a 6970  threshold in zip
-0006fe60: 2872 616e 6765 2832 292c 205b 302e 352c  (range(2), [0.5,
-0006fe70: 206d 5f74 6872 6573 685d 293a 0d0a 2020   m_thresh]):..  
-0006fe80: 2020 2020 2020 2020 2020 6966 2074 6872            if thr
-0006fe90: 6573 686f 6c64 2021 3d20 302e 353a 0d0a  eshold != 0.5:..
-0006fea0: 2020 2020 2020 2020 2020 2020 2020 2020                  
-0006feb0: 7072 6564 6963 7465 6420 5b3a 2c30 5d20  predicted [:,0] 
-0006fec0: 3d20 2870 7265 6469 6374 6564 205b 3a2c  = (predicted [:,
-0006fed0: 305d 203e 3d20 2831 2d74 6872 6573 686f  0] >= (1-thresho
-0006fee0: 6c64 2929 2e61 7374 7970 6528 2769 6e74  ld)).astype('int
-0006fef0: 2729 0d0a 2020 2020 2020 2020 2020 2020  ')..            
-0006ff00: 2020 2020 7072 6564 6963 7465 6420 5b3a      predicted [:
-0006ff10: 2c31 5d20 3d20 2870 7265 6469 6374 6564  ,1] = (predicted
-0006ff20: 205b 3a2c 315d 203e 3d20 7468 7265 7368   [:,1] >= thresh
-0006ff30: 6f6c 6429 2e61 7374 7970 6528 2769 6e74  old).astype('int
-0006ff40: 2729 0d0a 2020 2020 2020 2020 2020 2020  ')..            
-0006ff50: 2020 2020 795f 7072 6564 203d 2070 7265      y_pred = pre
-0006ff60: 6469 6374 6564 5b3a 2c72 6172 655f 636c  dicted[:,rare_cl
-0006ff70: 6173 735d 0d0a 2020 2020 2020 2020 2020  ass]..          
-0006ff80: 2020 656c 7365 3a0d 0a20 2020 2020 2020    else:..       
-0006ff90: 2020 2020 2020 2020 2079 5f70 7265 6420           y_pred 
-0006ffa0: 3d20 7072 6564 6963 7465 642e 6172 676d  = predicted.argm
-0006ffb0: 6178 2861 7869 733d 3129 0d0a 2020 2020  ax(axis=1)..    
-0006ffc0: 2020 2020 2020 2020 7072 696e 7428 2742          print('B
-0006ffd0: 616c 616e 6365 6420 4163 6375 7261 6379  alanced Accuracy
-0006ffe0: 203d 2025 302e 3266 2525 2077 6974 6820   = %0.2f%% with 
-0006fff0: 5468 7265 7368 6f6c 6420 3d20 2530 2e32  Threshold = %0.2
-00070000: 6627 2025 280d 0a20 2020 2020 2020 2020  f' %(..         
-00070010: 2020 2020 2020 2031 3030 2a62 616c 616e         100*balan
-00070020: 6365 645f 6163 6375 7261 6379 5f73 636f  ced_accuracy_sco
-00070030: 7265 2879 5f74 7275 652c 2079 5f70 7265  re(y_true, y_pre
-00070040: 6429 2c74 6872 6573 686f 6c64 2929 0d0a  d),threshold))..
-00070050: 2020 2020 2020 2020 2020 2020 7072 696e              prin
-00070060: 7428 2743 6f6e 6675 7369 6f6e 204d 6174  t('Confusion Mat
-00070070: 7269 783a 2729 0d0a 2020 2020 2020 2020  rix:')..        
-00070080: 2020 2020 7072 696e 7428 636f 6e66 7573      print(confus
-00070090: 696f 6e5f 6d61 7472 6978 2879 5f74 7275  ion_matrix(y_tru
-000700a0: 652c 2079 5f70 7265 6429 290d 0a20 2020  e, y_pred))..   
-000700b0: 2020 2020 2020 2020 2070 7269 6e74 2863           print(c
-000700c0: 6c61 7373 6966 6963 6174 696f 6e5f 7265  lassification_re
-000700d0: 706f 7274 2879 5f74 7275 652c 2079 5f70  port(y_true, y_p
-000700e0: 7265 6429 290d 0a20 2020 2020 2020 2020  red))..         
-000700f0: 2020 2072 6567 5f61 6363 5b69 5d20 3d20     reg_acc[i] = 
-00070100: 6261 6c61 6e63 6564 5f61 6363 7572 6163  balanced_accurac
-00070110: 795f 7363 6f72 6528 795f 7472 7565 2c20  y_score(y_true, 
-00070120: 795f 7072 6564 290d 0a20 2020 2020 2020  y_pred)..       
-00070130: 2070 7269 6e74 2827 2323 2323 2323 2323   print('########
-00070140: 2323 2323 2323 2323 2323 2323 2323 2323  ################
-00070150: 2323 2323 2323 2323 2323 2323 2323 2323  ################
-00070160: 2323 2323 2323 2323 2323 2323 2323 2323  ################
-00070170: 2323 2323 2323 2323 2323 2323 2327 290d  #############').
-00070180: 0a20 2020 2020 2020 2069 6620 2072 6567  .        if  reg
-00070190: 5f61 6363 5b30 5d20 3e3d 2072 6567 5f61  _acc[0] >= reg_a
-000701a0: 6363 5b31 5d20 3a0d 0a20 2020 2020 2020  cc[1] :..       
-000701b0: 2020 2020 2070 7269 6e74 2827 5265 6775       print('Regu
-000701c0: 6c61 7220 7468 7265 7368 6f6c 6420 3d20  lar threshold = 
-000701d0: 2530 2e32 6620 6973 2062 6574 7465 7227  %0.2f is better'
-000701e0: 2025 302e 3529 0d0a 2020 2020 2020 2020   %0.5)..        
-000701f0: 2020 2020 7265 7475 726e 2072 6567 5f61      return reg_a
-00070200: 6363 5b30 5d0d 0a20 2020 2020 2020 2065  cc[0]..        e
-00070210: 6c73 653a 0d0a 2020 2020 2020 2020 2020  lse:..          
-00070220: 2020 7072 696e 7428 274d 6f64 6966 6965    print('Modifie
-00070230: 6420 7468 7265 7368 6f6c 6420 3d20 2530  d threshold = %0
-00070240: 2e32 6620 6973 2062 6574 7465 7227 2025  .2f is better' %
-00070250: 6d5f 7468 7265 7368 290d 0a20 2020 2020  m_thresh)..     
-00070260: 2020 2020 2020 2072 6574 7572 6e20 7265         return re
-00070270: 675f 6163 635b 315d 0d0a 2020 2020 6578  g_acc[1]..    ex
-00070280: 6365 7074 3a0d 0a20 2020 2020 2020 2070  cept:..        p
-00070290: 7269 6e74 2827 4572 726f 723a 2070 7269  rint('Error: pri
-000702a0: 6e74 696e 6720 636c 6173 7369 6669 6361  nting classifica
-000702b0: 7469 6f6e 206d 6f64 656c 206d 6574 7269  tion model metri
-000702c0: 6373 2e20 436f 6e74 696e 7569 6e67 2e2e  cs. Continuing..
-000702d0: 2e27 290d 0a20 2020 2020 2020 2072 6574  .')..        ret
-000702e0: 7572 6e20 300d 0a23 2323 2323 2323 2323  urn 0..#########
-000702f0: 2323 2323 2323 2323 2323 2323 2323 2323  ################
-00070300: 2323 2323 2323 2323 2323 2323 2323 2323  ################
-00070310: 2323 2323 2323 2323 2323 2323 2323 2323  ################
-00070320: 2323 2323 2323 2323 2323 2323 0d0a 2323  ############..##
-00070330: 2323 2320 2020 2020 5245 4752 4553 5349  ###     REGRESSI
-00070340: 4f4e 2043 4841 5254 5320 414e 4420 4d45  ON CHARTS AND ME
-00070350: 5452 4943 5320 4152 4520 5052 494e 5445  TRICS ARE PRINTE
-00070360: 4420 504c 4f54 5445 4420 4845 5245 0d0a  D PLOTTED HERE..
-00070370: 2323 2323 2323 2323 2323 2323 2323 2323  ################
-00070380: 2323 2323 2323 2323 2323 2323 2323 2323  ################
-00070390: 2323 2323 2323 2323 2323 2323 2323 2323  ################
-000703a0: 2323 2323 2323 2323 2323 2323 2323 2323  ################
-000703b0: 2323 2323 230d 0a69 6d70 6f72 7420 7469  #####..import ti
-000703c0: 6d65 0d0a 6465 6620 706c 6f74 5f72 6567  me..def plot_reg
-000703d0: 7265 7373 696f 6e5f 7363 6174 7465 7273  ression_scatters
-000703e0: 2864 662c 2064 6632 2c20 6e75 6d5f 7661  (df, df2, num_va
-000703f0: 7273 2c20 6b69 6e64 3d27 7363 6174 7465  rs, kind='scatte
-00070400: 7227 2c20 706c 6f74 5f6e 616d 653d 2727  r', plot_name=''
-00070410: 293a 0d0a 2020 2020 2222 220d 0a20 2020  ):..    """..   
-00070420: 2047 7265 6174 2077 6179 2074 6f20 706c   Great way to pl
-00070430: 6f74 2063 6f6e 7469 6e75 6f75 7320 7661  ot continuous va
-00070440: 7269 6162 6c65 7320 6661 7374 2e20 4a75  riables fast. Ju
-00070450: 7374 2073 656e 7420 7468 656d 2069 6e20  st sent them in 
-00070460: 616e 6420 6974 2077 696c 6c20 7461 6b65  and it will take
-00070470: 2063 6172 6520 6f66 2074 6865 2072 6573   care of the res
-00070480: 7421 0d0a 2020 2020 2222 220d 0a20 2020  t!..    """..   
-00070490: 2066 6967 7369 7a65 203d 2028 3130 2c20   figsize = (10, 
-000704a0: 3130 290d 0a20 2020 2063 6f6c 6f72 7320  10)..    colors 
-000704b0: 3d20 6379 636c 6528 2762 7972 636d 676b  = cycle('byrcmgk
-000704c0: 6279 7263 6d67 6b62 7972 636d 676b 6279  byrcmgkbyrcmgkby
-000704d0: 7263 6d67 6b27 290d 0a20 2020 206e 756d  rcmgk')..    num
-000704e0: 5f76 6172 735f 6c65 6e20 3d20 6c65 6e28  _vars_len = len(
-000704f0: 6e75 6d5f 7661 7273 290d 0a20 2020 2063  num_vars)..    c
-00070500: 6f6c 203d 2032 0d0a 2020 2020 7374 6172  ol = 2..    star
-00070510: 745f 7469 6d65 203d 2074 696d 652e 7469  t_time = time.ti
-00070520: 6d65 2829 0d0a 2020 2020 726f 7720 3d20  me()..    row = 
-00070530: 6c65 6e28 6e75 6d5f 7661 7273 290d 0a20  len(num_vars).. 
-00070540: 2020 2066 6967 2c20 6178 203d 2070 6c74     fig, ax = plt
-00070550: 2e73 7562 706c 6f74 7328 726f 772c 2063  .subplots(row, c
-00070560: 6f6c 290d 0a20 2020 2069 6620 636f 6c20  ol)..    if col 
-00070570: 3c20 323a 0d0a 2020 2020 2020 2020 6669  < 2:..        fi
-00070580: 672e 7365 745f 7369 7a65 5f69 6e63 6865  g.set_size_inche
-00070590: 7328 6d69 6e28 3135 2c38 292c 726f 772a  s(min(15,8),row*
-000705a0: 3529 0d0a 2020 2020 2020 2020 6669 672e  5)..        fig.
-000705b0: 7375 6270 6c6f 7473 5f61 646a 7573 7428  subplots_adjust(
-000705c0: 6873 7061 6365 3d30 2e35 2920 2323 2320  hspace=0.5) ### 
-000705d0: 5468 6973 2063 6f6e 7472 6f6c 7320 7468  This controls th
-000705e0: 6520 7370 6163 6520 6265 7477 656e 2072  e space betwen r
-000705f0: 6f77 730d 0a20 2020 2020 2020 2066 6967  ows..        fig
-00070600: 2e73 7562 706c 6f74 735f 6164 6a75 7374  .subplots_adjust
-00070610: 2877 7370 6163 653d 302e 3329 2023 2323  (wspace=0.3) ###
-00070620: 2054 6869 7320 636f 6e74 726f 6c73 2074   This controls t
-00070630: 6865 2073 7061 6365 2062 6574 7765 656e  he space between
-00070640: 2063 6f6c 756d 6e73 0d0a 2020 2020 656c   columns..    el
-00070650: 7365 3a0d 0a20 2020 2020 2020 2066 6967  se:..        fig
-00070660: 2e73 6574 5f73 697a 655f 696e 6368 6573  .set_size_inches
-00070670: 286d 696e 2863 6f6c 2a31 302c 3230 292c  (min(col*10,20),
-00070680: 726f 772a 3529 0d0a 2020 2020 2020 2020  row*5)..        
-00070690: 6669 672e 7375 6270 6c6f 7473 5f61 646a  fig.subplots_adj
-000706a0: 7573 7428 6873 7061 6365 3d30 2e33 2920  ust(hspace=0.3) 
-000706b0: 2323 2320 5468 6973 2063 6f6e 7472 6f6c  ### This control
-000706c0: 7320 7468 6520 7370 6163 6520 6265 7477  s the space betw
-000706d0: 656e 2072 6f77 730d 0a20 2020 2020 2020  en rows..       
-000706e0: 2066 6967 2e73 7562 706c 6f74 735f 6164   fig.subplots_ad
-000706f0: 6a75 7374 2877 7370 6163 653d 302e 3329  just(wspace=0.3)
-00070700: 2023 2323 2054 6869 7320 636f 6e74 726f   ### This contro
-00070710: 6c73 2074 6865 2073 7061 6365 2062 6574  ls the space bet
-00070720: 7765 656e 2063 6f6c 756d 6e73 0d0a 2020  ween columns..  
-00070730: 2020 6669 672e 7375 7074 6974 6c65 2827    fig.suptitle('
-00070740: 5265 6772 6573 7369 6f6e 204d 6574 7269  Regression Metri
-00070750: 6373 2050 6c6f 7473 2066 6f72 2025 7320  cs Plots for %s 
-00070760: 4d6f 6465 6c27 2025 706c 6f74 5f6e 616d  Model' %plot_nam
-00070770: 652c 2066 6f6e 7473 697a 653d 3230 290d  e, fontsize=20).
-00070780: 0a20 2020 2063 6f75 6e74 6572 203d 2030  .    counter = 0
-00070790: 0d0a 2020 2020 6966 2072 6f77 203d 3d20  ..    if row == 
-000707a0: 313a 0d0a 2020 2020 2020 2020 6178 203d  1:..        ax =
-000707b0: 2061 782e 7265 7368 6170 6528 2d31 2c31   ax.reshape(-1,1
-000707c0: 292e 540d 0a20 2020 2066 6f72 206b 2069  ).T..    for k i
-000707d0: 6e20 6e70 2e61 7261 6e67 6528 726f 7729  n np.arange(row)
-000707e0: 3a0d 0a20 2020 2020 2020 2072 6f77 5f63  :..        row_c
-000707f0: 6f6c 6f72 203d 206e 6578 7428 636f 6c6f  olor = next(colo
-00070800: 7273 290d 0a20 2020 2020 2020 2066 6f72  rs)..        for
-00070810: 206c 2069 6e20 6e70 2e61 7261 6e67 6528   l in np.arange(
-00070820: 636f 6c29 3a0d 0a20 2020 2020 2020 2020  col):..         
-00070830: 2020 2074 7279 3a0d 0a20 2020 2020 2020     try:..       
-00070840: 2020 2020 2020 2020 2069 6620 636f 6c3d           if col=
-00070850: 3d31 3a0d 0a20 2020 2020 2020 2020 2020  =1:..           
-00070860: 2020 2020 2020 2020 2069 6620 726f 7720           if row 
-00070870: 3d3d 2031 3a0d 0a20 2020 2020 2020 2020  == 1:..         
-00070880: 2020 2020 2020 2020 2020 2020 2020 2078                 x
-00070890: 203d 2064 665b 3a5d 0d0a 2020 2020 2020   = df[:]..      
-000708a0: 2020 2020 2020 2020 2020 2020 2020 2020                  
-000708b0: 2020 7920 3d20 6466 325b 3a5d 0d0a 2020    y = df2[:]..  
-000708c0: 2020 2020 2020 2020 2020 2020 2020 2020                  
-000708d0: 2020 656c 7365 3a0d 0a20 2020 2020 2020    else:..       
-000708e0: 2020 2020 2020 2020 2020 2020 2020 2020                  
-000708f0: 2078 203d 2064 665b 3a2c 6b5d 0d0a 2020   x = df[:,k]..  
-00070900: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00070910: 2020 2020 2020 7920 3d20 6466 325b 3a2c        y = df2[:,
-00070920: 6b5d 0d0a 2020 2020 2020 2020 2020 2020  k]..            
-00070930: 2020 2020 2020 2020 6178 3120 3d20 6178          ax1 = ax
-00070940: 5b6b 5d5b 6c5d 0d0a 2020 2020 2020 2020  [k][l]..        
-00070950: 2020 2020 2020 2020 2020 2020 6c69 6e65              line
-00070960: 5374 6172 7420 3d20 782e 6d69 6e28 290d  Start = x.min().
-00070970: 0a20 2020 2020 2020 2020 2020 2020 2020  .               
-00070980: 2020 2020 206c 696e 6545 6e64 203d 2078       lineEnd = x
-00070990: 2e6d 6178 2829 0d0a 2020 2020 2020 2020  .max()..        
-000709a0: 2020 2020 2020 2020 2020 2020 6178 312e              ax1.
-000709b0: 7363 6174 7465 7228 782c 2079 2c20 636f  scatter(x, y, co
-000709c0: 6c6f 723d 726f 775f 636f 6c6f 7229 0d0a  lor=row_color)..
-000709d0: 2020 2020 2020 2020 2020 2020 2020 2020                  
-000709e0: 2020 2020 6178 312e 706c 6f74 285b 6c69      ax1.plot([li
-000709f0: 6e65 5374 6172 742c 206c 696e 6545 6e64  neStart, lineEnd
-00070a00: 5d2c 205b 6c69 6e65 5374 6172 742c 206c  ], [lineStart, l
-00070a10: 696e 6545 6e64 5d2c 2027 6b2d 272c 2063  ineEnd], 'k-', c
-00070a20: 6f6c 6f72 3d72 6f77 5f63 6f6c 6f72 290d  olor=row_color).
-00070a30: 0a20 2020 2020 2020 2020 2020 2020 2020  .               
-00070a40: 2020 2020 2061 7831 2e73 6574 5f78 6c61       ax1.set_xla
-00070a50: 6265 6c28 2741 6374 7561 6c73 2729 0d0a  bel('Actuals')..
-00070a60: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00070a70: 2020 2020 6178 312e 7365 745f 796c 6162      ax1.set_ylab
-00070a80: 656c 2827 5072 6564 6963 7465 6427 290d  el('Predicted').
-00070a90: 0a20 2020 2020 2020 2020 2020 2020 2020  .               
-00070aa0: 2020 2020 2061 7831 2e73 6574 5f74 6974       ax1.set_tit
-00070ab0: 6c65 2827 5072 6564 6963 7465 6420 7673  le('Predicted vs
-00070ac0: 2041 6374 7561 6c73 2050 6c6f 7420 666f   Actuals Plot fo
-00070ad0: 7220 5461 7267 6574 203d 2025 7327 2025  r Target = %s' %
-00070ae0: 6e75 6d5f 7661 7273 5b6b 5d29 0d0a 2020  num_vars[k])..  
-00070af0: 2020 2020 2020 2020 2020 2020 2020 656c                el
-00070b00: 7365 3a0d 0a20 2020 2020 2020 2020 2020  se:..           
-00070b10: 2020 2020 2020 2020 2069 6620 726f 7720           if row 
-00070b20: 3d3d 2031 3a0d 0a20 2020 2020 2020 2020  == 1:..         
-00070b30: 2020 2020 2020 2020 2020 2020 2020 2078                 x
-00070b40: 203d 2064 665b 3a5d 0d0a 2020 2020 2020   = df[:]..      
-00070b50: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00070b60: 2020 7920 3d20 6466 325b 3a5d 0d0a 2020    y = df2[:]..  
-00070b70: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00070b80: 2020 656c 7365 3a0d 0a20 2020 2020 2020    else:..       
-00070b90: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00070ba0: 2078 203d 2064 665b 3a2c 6b5d 0d0a 2020   x = df[:,k]..  
-00070bb0: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00070bc0: 2020 2020 2020 7920 3d20 6466 325b 3a2c        y = df2[:,
-00070bd0: 6b5d 0d0a 2020 2020 2020 2020 2020 2020  k]..            
-00070be0: 2020 2020 2020 2020 6c69 6e65 5374 6172          lineStar
-00070bf0: 7420 3d20 782e 6d69 6e28 290d 0a20 2020  t = x.min()..   
-00070c00: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00070c10: 206c 696e 6545 6e64 203d 2078 2e6d 6178   lineEnd = x.max
-00070c20: 2829 0d0a 2020 2020 2020 2020 2020 2020  ()..            
-00070c30: 2020 2020 2020 2020 6966 206c 203d 3d20          if l == 
-00070c40: 303a 0d0a 2020 2020 2020 2020 2020 2020  0:..            
-00070c50: 2020 2020 2020 2020 2020 2020 6178 3120              ax1 
-00070c60: 3d20 6178 5b6b 5d5b 6c5d 0d0a 2020 2020  = ax[k][l]..    
-00070c70: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00070c80: 2020 2020 6178 312e 7363 6174 7465 7228      ax1.scatter(
-00070c90: 782c 2079 2c20 2063 6f6c 6f72 203d 2072  x, y,  color = r
-00070ca0: 6f77 5f63 6f6c 6f72 290d 0a20 2020 2020  ow_color)..     
-00070cb0: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00070cc0: 2020 2061 7831 2e70 6c6f 7428 5b6c 696e     ax1.plot([lin
-00070cd0: 6553 7461 7274 2c20 6c69 6e65 456e 645d  eStart, lineEnd]
-00070ce0: 2c20 5b6c 696e 6553 7461 7274 2c20 6c69  , [lineStart, li
-00070cf0: 6e65 456e 645d 2c20 276b 2d27 2c20 636f  neEnd], 'k-', co
-00070d00: 6c6f 7220 3d20 726f 775f 636f 6c6f 7229  lor = row_color)
-00070d10: 0d0a 2020 2020 2020 2020 2020 2020 2020  ..              
-00070d20: 2020 2020 2020 2020 2020 6178 312e 7365            ax1.se
-00070d30: 745f 786c 6162 656c 2827 4163 7475 616c  t_xlabel('Actual
-00070d40: 7327 290d 0a20 2020 2020 2020 2020 2020  s')..           
-00070d50: 2020 2020 2020 2020 2020 2020 2061 7831               ax1
-00070d60: 2e73 6574 5f79 6c61 6265 6c28 2750 7265  .set_ylabel('Pre
-00070d70: 6469 6374 6564 2729 0d0a 2020 2020 2020  dicted')..      
-00070d80: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00070d90: 2020 6178 312e 7365 745f 7469 746c 6528    ax1.set_title(
-00070da0: 2750 7265 6469 6374 6564 2076 7320 4163  'Predicted vs Ac
-00070db0: 7475 616c 7320 506c 6f74 2066 6f72 2054  tuals Plot for T
-00070dc0: 6172 6765 7420 3d20 2573 2720 256e 756d  arget = %s' %num
-00070dd0: 5f76 6172 735b 6b5d 290d 0a20 2020 2020  _vars[k])..     
-00070de0: 2020 2020 2020 2020 2020 2020 2020 2065                 e
-00070df0: 6c73 653a 0d0a 2020 2020 2020 2020 2020  lse:..          
-00070e00: 2020 2020 2020 2020 2020 2020 2020 6178                ax
-00070e10: 3120 3d20 6178 5b6b 5d5b 6c5d 0d0a 2020  1 = ax[k][l]..  
-00070e20: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00070e30: 2020 2020 2020 6178 312e 6869 7374 2828        ax1.hist((
-00070e40: 782d 7929 2c20 6465 6e73 6974 793d 5472  x-y), density=Tr
-00070e50: 7565 2c63 6f6c 6f72 203d 2072 6f77 5f63  ue,color = row_c
-00070e60: 6f6c 6f72 290d 0a20 2020 2020 2020 2020  olor)..         
-00070e70: 2020 2020 2020 2020 2020 2020 2020 2061                 a
-00070e80: 7831 2e61 7876 6c69 6e65 2863 6f6c 6f72  x1.axvline(color
-00070e90: 3d27 6b27 290d 0a20 2020 2020 2020 2020  ='k')..         
-00070ea0: 2020 2020 2020 2020 2020 2020 2020 2061                 a
-00070eb0: 7831 2e73 6574 5f74 6974 6c65 2827 5265  x1.set_title('Re
-00070ec0: 7369 6475 616c 7320 506c 6f74 2066 6f72  siduals Plot for
-00070ed0: 2054 6172 6765 7420 3d20 2573 2720 256e   Target = %s' %n
-00070ee0: 756d 5f76 6172 735b 6b5d 290d 0a20 2020  um_vars[k])..   
-00070ef0: 2020 2020 2020 2020 2065 7863 6570 743a           except:
-00070f00: 0d0a 2020 2020 2020 2020 2020 2020 2020  ..              
-00070f10: 2020 6966 2063 6f6c 203d 3d20 313a 0d0a    if col == 1:..
-00070f20: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00070f30: 2020 2020 636f 756e 7465 7220 2b3d 2031      counter += 1
-00070f40: 0d0a 2020 2020 2020 2020 2020 2020 2020  ..              
-00070f50: 2020 656c 7365 3a0d 0a20 2020 2020 2020    else:..       
-00070f60: 2020 2020 2020 2020 2020 2020 2061 785b               ax[
-00070f70: 6b5d 5b6c 5d2e 7365 745f 7469 746c 6528  k][l].set_title(
-00070f80: 274e 6f20 5072 6564 6963 7465 6420 7673  'No Predicted vs
-00070f90: 2041 6374 7561 6c73 2050 6c6f 7420 666f   Actuals Plot fo
-00070fa0: 7220 706c 6f74 2061 7320 2573 2069 7320  r plot as %s is 
-00070fb0: 6e6f 7420 6e75 6d65 7269 6327 2025 6e75  not numeric' %nu
-00070fc0: 6d5f 7661 7273 5b6b 5d29 0d0a 2020 2020  m_vars[k])..    
-00070fd0: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00070fe0: 636f 756e 7465 7220 2b3d 2031 0d0a 2020  counter += 1..  
-00070ff0: 2020 7072 696e 7428 2752 6567 7265 7373    print('Regress
-00071000: 696f 6e20 506c 6f74 7320 636f 6d70 6c65  ion Plots comple
-00071010: 7465 6420 696e 2025 302e 3366 2073 6563  ted in %0.3f sec
-00071020: 6f6e 6473 2720 2528 7469 6d65 2e74 696d  onds' %(time.tim
-00071030: 6528 292d 7374 6172 745f 7469 6d65 2929  e()-start_time))
-00071040: 0d0a 2323 2323 2323 2323 2323 2323 2323  ..##############
-00071050: 2323 2323 2323 2323 2323 2323 2323 2323  ################
-00071060: 2323 2323 2323 2323 2323 2323 2323 2323  ################
-00071070: 2323 2323 2323 2323 2323 2323 2323 2323  ################
-00071080: 2323 2323 2323 2323 2323 2323 2323 2323  ################
-00071090: 2323 0d0a 6465 6620 7072 696e 745f 7265  ##..def print_re
-000710a0: 6772 6573 7369 6f6e 5f6d 6f64 656c 5f73  gression_model_s
-000710b0: 7461 7473 2861 6374 7561 6c73 2c20 7072  tats(actuals, pr
-000710c0: 6564 6963 7465 642c 2074 6172 6765 7473  edicted, targets
-000710d0: 3d27 272c 2070 6c6f 745f 6e61 6d65 3d27  ='', plot_name='
-000710e0: 2729 3a0d 0a20 2020 2022 2222 0d0a 2020  '):..    """..  
-000710f0: 2020 5468 6973 2070 726f 6772 616d 2070    This program p
-00071100: 7269 6e74 7320 616e 6420 7265 7475 726e  rints and return
-00071110: 7320 4d41 452c 2052 4d53 452c 204d 4150  s MAE, RMSE, MAP
-00071120: 452e 0d0a 2020 2020 4966 2079 6f75 206c  E...    If you l
-00071130: 696b 6520 7468 6520 4d41 4520 616e 6420  ike the MAE and 
-00071140: 524d 5345 2074 6f20 6861 7665 2061 2074  RMSE to have a t
-00071150: 6974 6c65 206f 7220 736f 6d65 7468 696e  itle or somethin
-00071160: 672c 206a 7573 7420 6769 7665 2074 6861  g, just give tha
-00071170: 740d 0a20 2020 2069 6e20 7468 6520 696e  t..    in the in
-00071180: 7075 7420 6173 2022 7469 746c 6522 2061  put as "title" a
-00071190: 6e64 2069 7420 7769 6c6c 2070 7269 6e74  nd it will print
-000711a0: 2074 6861 7420 7469 746c 6520 6f6e 2074   that title on t
-000711b0: 6865 204d 4145 2061 6e64 2052 4d53 4520  he MAE and RMSE 
-000711c0: 6173 2061 0d0a 2020 2020 6368 6172 7420  as a..    chart 
-000711d0: 666f 7220 7468 6174 206d 6f64 656c 2e20  for that model. 
-000711e0: 5265 7475 726e 7320 4d41 452c 204d 4145  Returns MAE, MAE
-000711f0: 5f61 735f 7065 7263 656e 7461 6765 2c20  _as_percentage, 
-00071200: 616e 6420 524d 5345 5f61 735f 7065 7263  and RMSE_as_perc
-00071210: 656e 7461 6765 0d0a 2020 2020 2222 220d  entage..    """.
-00071220: 0a20 2020 2069 6620 6973 696e 7374 616e  .    if isinstan
-00071230: 6365 2861 6374 7561 6c73 2c70 642e 5365  ce(actuals,pd.Se
-00071240: 7269 6573 2920 6f72 2069 7369 6e73 7461  ries) or isinsta
-00071250: 6e63 6528 6163 7475 616c 732c 7064 2e44  nce(actuals,pd.D
-00071260: 6174 6146 7261 6d65 293a 0d0a 2020 2020  ataFrame):..    
-00071270: 2020 2020 6163 7475 616c 7320 3d20 6163      actuals = ac
-00071280: 7475 616c 732e 7661 6c75 6573 0d0a 2020  tuals.values..  
-00071290: 2020 6966 2069 7369 6e73 7461 6e63 6528    if isinstance(
-000712a0: 7072 6564 6963 7465 642c 7064 2e53 6572  predicted,pd.Ser
-000712b0: 6965 7329 206f 7220 6973 696e 7374 616e  ies) or isinstan
-000712c0: 6365 2870 7265 6469 6374 6564 2c70 642e  ce(predicted,pd.
-000712d0: 4461 7461 4672 616d 6529 3a0d 0a20 2020  DataFrame):..   
-000712e0: 2020 2020 2070 7265 6469 6374 6564 203d       predicted =
-000712f0: 2070 7265 6469 6374 6564 2e76 616c 7565   predicted.value
-00071300: 730d 0a20 2020 2069 6620 6c65 6e28 6163  s..    if len(ac
-00071310: 7475 616c 7329 2021 3d20 6c65 6e28 7072  tuals) != len(pr
-00071320: 6564 6963 7465 6429 3a0d 0a20 2020 2020  edicted):..     
-00071330: 2020 2070 7269 6e74 2827 4572 726f 723a     print('Error:
-00071340: 204e 756d 6265 7220 6f66 2061 6374 7561   Number of actua
-00071350: 6c73 2061 6e64 2070 7265 6469 6374 6564  ls and predicted
-00071360: 2064 6f6e 7420 6d61 7463 682e 2043 6f6e   dont match. Con
-00071370: 7469 6e75 696e 672e 2e2e 2729 0d0a 2020  tinuing...')..  
-00071380: 2020 6966 2074 6172 6765 7473 203d 3d20    if targets == 
-00071390: 2222 3a0d 0a20 2020 2020 2020 2074 7279  "":..        try
-000713a0: 3a0d 0a20 2020 2020 2020 2020 2020 2023  :..            #
-000713b0: 2323 2054 6869 7320 6973 2066 6f72 204d  ## This is for M
-000713c0: 756c 7469 5f4c 6162 656c 2050 726f 626c  ulti_Label Probl
-000713d0: 656d 7320 2323 230d 0a20 2020 2020 2020  ems ###..       
-000713e0: 2020 2020 2061 7373 6572 7420 6163 7475       assert actu
-000713f0: 616c 732e 7368 6170 655b 315d 0d0a 2020  als.shape[1]..  
-00071400: 2020 2020 2020 2020 2020 6d75 6c74 695f            multi_
-00071410: 6c61 6265 6c20 3d20 5472 7565 0d0a 2020  label = True..  
-00071420: 2020 2020 2020 2020 2020 6966 2069 7369            if isi
-00071430: 6e73 7461 6e63 6528 6163 7475 616c 732c  nstance(actuals,
-00071440: 7064 2e53 6572 6965 7329 3a0d 0a20 2020  pd.Series):..   
-00071450: 2020 2020 2020 2020 2020 2020 2063 6f6c               col
-00071460: 7320 3d20 5b61 6374 7561 6c73 2e6e 616d  s = [actuals.nam
-00071470: 655d 0d0a 2020 2020 2020 2020 2020 2020  e]..            
-00071480: 656c 6966 2069 7369 6e73 7461 6e63 6528  elif isinstance(
-00071490: 6163 7475 616c 732c 7064 2e44 6174 6146  actuals,pd.DataF
-000714a0: 7261 6d65 293a 0d0a 2020 2020 2020 2020  rame):..        
-000714b0: 2020 2020 2020 2020 636f 6c73 203d 2061          cols = a
-000714c0: 6374 7561 6c73 2e63 6f6c 756d 6e73 2e74  ctuals.columns.t
-000714d0: 6f6c 6973 7428 290d 0a20 2020 2020 2020  olist()..       
-000714e0: 2020 2020 2065 6c73 653a 0d0a 2020 2020       else:..    
-000714f0: 2020 2020 2020 2020 2020 2020 636f 6c73              cols
-00071500: 203d 205b 2774 6172 6765 745f 272b 7374   = ['target_'+st
-00071510: 7228 6929 2066 6f72 2069 2069 6e20 7261  r(i) for i in ra
-00071520: 6e67 6528 6163 7475 616c 732e 7368 6170  nge(actuals.shap
-00071530: 655b 315d 295d 0d0a 2020 2020 2020 2020  e[1])]..        
-00071540: 6578 6365 7074 3a0d 0a20 2020 2020 2020  except:..       
-00071550: 2020 2020 2023 2323 2320 5448 6973 2069       #### THis i
-00071560: 7320 666f 7220 5369 6e67 6c65 204c 6162  s for Single Lab
-00071570: 656c 2070 726f 626c 656d 7320 2323 2323  el problems ####
-00071580: 230d 0a20 2020 2020 2020 2020 2020 206d  #..            m
-00071590: 756c 7469 5f6c 6162 656c 203d 2046 616c  ulti_label = Fal
-000715a0: 7365 0d0a 2020 2020 2020 2020 2020 2020  se..            
-000715b0: 6966 2069 7369 6e73 7461 6e63 6528 6163  if isinstance(ac
-000715c0: 7475 616c 732c 7064 2e53 6572 6965 7329  tuals,pd.Series)
-000715d0: 3a0d 0a20 2020 2020 2020 2020 2020 2020  :..             
-000715e0: 2020 2063 6f6c 7320 3d20 5b61 6374 7561     cols = [actua
-000715f0: 6c73 2e6e 616d 655d 0d0a 2020 2020 2020  ls.name]..      
-00071600: 2020 2020 2020 656c 6966 2069 7369 6e73        elif isins
-00071610: 7461 6e63 6528 6163 7475 616c 732c 7064  tance(actuals,pd
-00071620: 2e44 6174 6146 7261 6d65 293a 0d0a 2020  .DataFrame):..  
-00071630: 2020 2020 2020 2020 2020 2020 2020 636f                co
-00071640: 6c73 203d 2061 6374 7561 6c73 2e63 6f6c  ls = actuals.col
-00071650: 756d 6e73 2e74 6f6c 6973 7428 290d 0a20  umns.tolist().. 
-00071660: 2020 2020 2020 2020 2020 2065 6c73 653a             else:
-00071670: 0d0a 2020 2020 2020 2020 2020 2020 2020  ..              
-00071680: 2020 636f 6c73 203d 205b 2774 6172 6765    cols = ['targe
-00071690: 745f 3127 5d0d 0a20 2020 2065 6c73 653a  t_1']..    else:
-000716a0: 0d0a 2020 2020 2020 2020 636f 6c73 203d  ..        cols =
-000716b0: 2063 6f70 792e 6465 6570 636f 7079 2874   copy.deepcopy(t
-000716c0: 6172 6765 7473 290d 0a20 2020 2020 2020  argets)..       
-000716d0: 2069 6620 6973 696e 7374 616e 6365 2874   if isinstance(t
-000716e0: 6172 6765 7473 2c20 7374 7229 3a0d 0a20  argets, str):.. 
-000716f0: 2020 2020 2020 2020 2020 2063 6f6c 7320             cols 
-00071700: 3d20 5b74 6172 6765 7473 5d0d 0a20 2020  = [targets]..   
-00071710: 2020 2020 2069 6620 6c65 6e28 636f 6c73       if len(cols
-00071720: 2920 3d3d 2031 3a0d 0a20 2020 2020 2020  ) == 1:..       
-00071730: 2020 2020 206d 756c 7469 5f6c 6162 656c       multi_label
-00071740: 203d 2046 616c 7365 0d0a 2020 2020 2020   = False..      
-00071750: 2020 656c 7365 3a0d 0a20 2020 2020 2020    else:..       
-00071760: 2020 2020 206d 756c 7469 5f6c 6162 656c       multi_label
-00071770: 203d 2054 7275 650d 0a20 2020 2074 7279   = True..    try
-00071780: 3a0d 0a20 2020 2020 2020 2070 6c6f 745f  :..        plot_
-00071790: 7265 6772 6573 7369 6f6e 5f73 6361 7474  regression_scatt
-000717a0: 6572 7328 6163 7475 616c 732c 7072 6564  ers(actuals,pred
-000717b0: 6963 7465 642c 636f 6c73 2c70 6c6f 745f  icted,cols,plot_
-000717c0: 6e61 6d65 3d70 6c6f 745f 6e61 6d65 290d  name=plot_name).
-000717d0: 0a20 2020 2065 7863 6570 743a 0d0a 2020  .    except:..  
-000717e0: 2020 2020 2020 7072 696e 7428 2743 6f75        print('Cou
-000717f0: 6c64 206e 6f74 2064 7261 7720 7265 6772  ld not draw regr
-00071800: 6573 7369 6f6e 2070 6c6f 7420 6275 7420  ession plot but 
-00071810: 636f 6e74 696e 7569 6e67 2e2e 2e27 290d  continuing...').
-00071820: 0a20 2020 2069 6620 6d75 6c74 695f 6c61  .    if multi_la
-00071830: 6265 6c3a 0d0a 2020 2020 2020 2020 666f  bel:..        fo
-00071840: 7220 6920 696e 2072 616e 6765 2861 6374  r i in range(act
-00071850: 7561 6c73 2e73 6861 7065 5b31 5d29 3a0d  uals.shape[1]):.
-00071860: 0a20 2020 2020 2020 2020 2020 2061 6374  .            act
-00071870: 7561 6c73 5f78 203d 2061 6374 7561 6c73  uals_x = actuals
-00071880: 5b3a 2c69 5d0d 0a20 2020 2020 2020 2020  [:,i]..         
-00071890: 2020 2074 7279 3a0d 0a20 2020 2020 2020     try:..       
-000718a0: 2020 2020 2020 2020 2070 7265 6469 6374           predict
-000718b0: 6564 5f78 203d 2070 7265 6469 6374 6564  ed_x = predicted
-000718c0: 5b3a 2c69 5d0d 0a20 2020 2020 2020 2020  [:,i]..         
-000718d0: 2020 2065 7863 6570 743a 0d0a 2020 2020     except:..    
-000718e0: 2020 2020 2020 2020 2020 2020 7072 6564              pred
-000718f0: 6963 7465 645f 7820 3d20 7072 6564 6963  icted_x = predic
-00071900: 7465 645b 3a5d 0d0a 2020 2020 2020 2020  ted[:]..        
-00071910: 2020 2020 7072 696e 7428 2752 6567 7265      print('Regre
-00071920: 7373 696f 6e20 4d65 7472 6963 7320 666f  ssion Metrics fo
-00071930: 7220 5461 7267 6574 3d25 7327 2025 636f  r Target=%s' %co
-00071940: 6c73 5b69 5d29 0d0a 2020 2020 2020 2020  ls[i])..        
-00071950: 2020 2020 6d61 652c 206d 6165 5f61 7370      mae, mae_asp
-00071960: 2c20 726d 7365 5f61 7370 203d 2070 7269  , rmse_asp = pri
-00071970: 6e74 5f72 6567 7265 7373 696f 6e5f 6d65  nt_regression_me
-00071980: 7472 6963 7328 6163 7475 616c 735f 782c  trics(actuals_x,
-00071990: 2070 7265 6469 6374 6564 5f78 290d 0a20   predicted_x).. 
-000719a0: 2020 2065 6c73 653a 0d0a 2020 2020 2020     else:..      
-000719b0: 2020 6d61 652c 206d 6165 5f61 7370 2c20    mae, mae_asp, 
-000719c0: 726d 7365 5f61 7370 203d 2070 7269 6e74  rmse_asp = print
-000719d0: 5f72 6567 7265 7373 696f 6e5f 6d65 7472  _regression_metr
-000719e0: 6963 7328 6163 7475 616c 732c 2070 7265  ics(actuals, pre
-000719f0: 6469 6374 6564 290d 0a20 2020 2072 6574  dicted)..    ret
-00071a00: 7572 6e20 6d61 652c 206d 6165 5f61 7370  urn mae, mae_asp
-00071a10: 2c20 726d 7365 5f61 7370 0d0a 2323 2323  , rmse_asp..####
-00071a20: 2323 2323 2323 2323 2323 2323 2323 2323  ################
-00071a30: 2323 2323 2323 2323 2323 2323 2323 2323  ################
-00071a40: 2323 2323 2323 2323 2323 2323 2323 2323  ################
-00071a50: 2323 2323 2323 2323 2323 2323 2323 2323  ################
-00071a60: 2323 2323 2323 2323 2323 2323 0d0a 6465  ############..de
-00071a70: 6620 7072 696e 745f 7265 6772 6573 7369  f print_regressi
-00071a80: 6f6e 5f6d 6574 7269 6373 2861 6374 7561  on_metrics(actua
-00071a90: 6c73 2c20 7072 6564 6963 7465 6429 3a0d  ls, predicted):.
-00071aa0: 0a20 2020 206d 6165 203d 206d 6561 6e5f  .    mae = mean_
-00071ab0: 6162 736f 6c75 7465 5f65 7272 6f72 2861  absolute_error(a
-00071ac0: 6374 7561 6c73 2c20 7072 6564 6963 7465  ctuals, predicte
-00071ad0: 6429 0d0a 2020 2020 6d61 655f 6173 7020  d)..    mae_asp 
-00071ae0: 3d20 286d 6561 6e5f 6162 736f 6c75 7465  = (mean_absolute
-00071af0: 5f65 7272 6f72 2861 6374 7561 6c73 2c20  _error(actuals, 
-00071b00: 7072 6564 6963 7465 6429 2f61 6374 7561  predicted)/actua
-00071b10: 6c73 2e73 7464 2829 292a 3130 300d 0a20  ls.std())*100.. 
-00071b20: 2020 2072 6d73 655f 6173 7020 3d20 286e     rmse_asp = (n
-00071b30: 702e 7371 7274 286d 6561 6e5f 7371 7561  p.sqrt(mean_squa
-00071b40: 7265 645f 6572 726f 7228 6163 7475 616c  red_error(actual
-00071b50: 732c 7072 6564 6963 7465 6429 292f 6163  s,predicted))/ac
-00071b60: 7475 616c 732e 7374 6428 2929 2a31 3030  tuals.std())*100
-00071b70: 0d0a 2020 2020 726d 7365 203d 2070 7269  ..    rmse = pri
-00071b80: 6e74 5f72 6d73 6528 6163 7475 616c 732c  nt_rmse(actuals,
-00071b90: 2070 7265 6469 6374 6564 290d 0a20 2020   predicted)..   
-00071ba0: 205f 203d 2070 7269 6e74 5f6d 6170 6528   _ = print_mape(
-00071bb0: 6163 7475 616c 732c 2070 7265 6469 6374  actuals, predict
-00071bc0: 6564 290d 0a20 2020 206d 6170 6520 3d20  ed)..    mape = 
-00071bd0: 7072 696e 745f 6d61 7065 2861 6374 7561  print_mape(actua
-00071be0: 6c73 2c20 7072 6564 6963 7465 6429 0d0a  ls, predicted)..
-00071bf0: 2020 2020 7072 696e 7428 2720 2020 204d      print('    M
-00071c00: 4145 203d 2025 302e 3466 2720 256d 6165  AE = %0.4f' %mae
-00071c10: 290d 0a20 2020 2070 7269 6e74 2822 2020  )..    print("  
-00071c20: 2020 4d41 5045 203d 2025 302e 3066 2525    MAPE = %0.0f%%
-00071c30: 2028 4d41 5045 2077 696c 6c20 6265 2076   (MAPE will be v
-00071c40: 6572 7920 6869 6768 2077 6865 6e20 7a65  ery high when ze
-00071c50: 726f 7320 696e 2061 6374 7561 6c73 2922  ros in actuals)"
-00071c60: 2025 286d 6170 6529 290d 0a20 2020 2070   %(mape))..    p
-00071c70: 7269 6e74 2827 2020 2020 524d 5345 203d  rint('    RMSE =
-00071c80: 2025 302e 3466 2720 2572 6d73 6529 0d0a   %0.4f' %rmse)..
-00071c90: 2020 2020 7072 696e 7428 2720 2020 204e      print('    N
-00071ca0: 6f72 6d61 6c69 7a65 6420 4d41 4520 2861  ormalized MAE (a
-00071cb0: 7320 2525 2073 7464 2064 6576 206f 6620  s %% std dev of 
-00071cc0: 4163 7475 616c 7329 203d 2025 302e 3066  Actuals) = %0.0f
-00071cd0: 2525 2720 2528 6d61 652f 6162 7328 6163  %%' %(mae/abs(ac
-00071ce0: 7475 616c 7329 2e73 7464 2829 2a31 3030  tuals).std()*100
-00071cf0: 2929 0d0a 2020 2020 2320 4e6f 726d 616c  ))..    # Normal
-00071d00: 697a 6564 2052 4d53 4520 7072 696e 7428  ized RMSE print(
-00071d10: 2752 4d53 4520 3d20 7b3a 2c2e 4f66 7d27  'RMSE = {:,.Of}'
-00071d20: 2e66 6f72 6d61 7428 726d 7365 2929 0d0a  .format(rmse))..
-00071d30: 2020 2020 2370 7269 6e74 2827 2020 2020      #print('    
-00071d40: 4e6f 726d 616c 697a 6564 2052 4d53 4520  Normalized RMSE 
-00071d50: 2825 2520 6f66 204d 696e 4d61 7820 6f66  (%% of MinMax of
-00071d60: 2041 6374 7561 6c73 2920 3d20 2530 2e30   Actuals) = %0.0
-00071d70: 6625 2527 2025 2831 3030 2a72 6d73 652f  f%%' %(100*rmse/
-00071d80: 6162 7328 6163 7475 616c 732e 6d61 7828  abs(actuals.max(
-00071d90: 292d 6163 7475 616c 732e 6d69 6e28 2929  )-actuals.min())
-00071da0: 2929 0d0a 2020 2020 7072 696e 7428 2720  ))..    print(' 
-00071db0: 2020 204e 6f72 6d61 6c69 7a65 6420 524d     Normalized RM
-00071dc0: 5345 2028 2525 206f 6620 5374 6420 4465  SE (%% of Std De
-00071dd0: 7620 6f66 2041 6374 7561 6c73 2920 3d20  v of Actuals) = 
-00071de0: 2530 2e30 6625 2527 2025 2831 3030 2a72  %0.0f%%' %(100*r
-00071df0: 6d73 652f 6163 7475 616c 732e 7374 6428  mse/actuals.std(
-00071e00: 2929 290d 0a20 2020 2072 6574 7572 6e20  )))..    return 
-00071e10: 6d61 652c 206d 6165 5f61 7370 2c20 726d  mae, mae_asp, rm
-00071e20: 7365 5f61 7370 0d0a 2323 2323 2323 2323  se_asp..########
-00071e30: 2323 2323 2323 2323 2323 2323 2323 2323  ################
-00071e40: 2323 2323 2323 2323 2323 2323 2323 2323  ################
-00071e50: 2323 2323 2323 2323 2323 2323 2323 2323  ################
-00071e60: 2323 2323 2323 2323 2323 2323 2323 2323  ################
-00071e70: 2323 2323 2323 2323 0d0a 6465 6620 7072  ########..def pr
-00071e80: 696e 745f 7374 6174 6963 5f72 6d73 6528  int_static_rmse(
-00071e90: 6163 7475 616c 2c20 7072 6564 6963 7465  actual, predicte
-00071ea0: 642c 2073 7461 7274 5f66 726f 6d3d 302c  d, start_from=0,
-00071eb0: 7665 7262 6f73 653d 3029 3a0d 0a20 2020  verbose=0):..   
-00071ec0: 2022 2222 0d0a 2020 2020 7468 6973 2063   """..    this c
-00071ed0: 616c 6375 6c61 7465 7320 7468 6520 7261  alculates the ra
-00071ee0: 7469 6f20 6f66 2074 6865 2072 6d73 6520  tio of the rmse 
-00071ef0: 6572 726f 7220 746f 2074 6865 2073 7461  error to the sta
-00071f00: 6e64 6172 6420 6465 7669 6174 696f 6e20  ndard deviation 
-00071f10: 6f66 2074 6865 2061 6374 7561 6c73 2e0d  of the actuals..
-00071f20: 0a20 2020 2054 6869 7320 7261 7469 6f20  .    This ratio 
-00071f30: 7368 6f75 6c64 2062 6520 6265 6c6f 7720  should be below 
-00071f40: 3120 666f 7220 6120 6d6f 6465 6c20 746f  1 for a model to
-00071f50: 2062 6520 636f 6e73 6964 6572 6564 2075   be considered u
-00071f60: 7365 6675 6c2e 0d0a 2020 2020 5468 6520  seful...    The 
-00071f70: 636f 6d70 6172 6973 6f6e 2073 7461 7274  comparison start
-00071f80: 7320 6672 6f6d 2074 6865 2072 6f77 2069  s from the row i
-00071f90: 6e64 6963 6174 6564 2069 6e20 7468 6520  ndicated in the 
-00071fa0: 2273 7461 7274 5f66 726f 6d22 2076 6172  "start_from" var
-00071fb0: 6961 626c 652e 0d0a 2020 2020 2222 220d  iable...    """.
-00071fc0: 0a20 2020 2072 6d73 6520 3d20 6e70 2e73  .    rmse = np.s
-00071fd0: 7172 7428 6d65 616e 5f73 7175 6172 6564  qrt(mean_squared
-00071fe0: 5f65 7272 6f72 2861 6374 7561 6c5b 7374  _error(actual[st
-00071ff0: 6172 745f 6672 6f6d 3a5d 2c70 7265 6469  art_from:],predi
-00072000: 6374 6564 5b73 7461 7274 5f66 726f 6d3a  cted[start_from:
-00072010: 5d29 290d 0a20 2020 2073 7464 5f64 6576  ]))..    std_dev
-00072020: 203d 2061 6374 7561 6c5b 7374 6172 745f   = actual[start_
-00072030: 6672 6f6d 3a5d 2e73 7464 2829 0d0a 2020  from:].std()..  
-00072040: 2020 6966 2076 6572 626f 7365 203e 3d20    if verbose >= 
-00072050: 313a 0d0a 2020 2020 2020 2020 7072 696e  1:..        prin
-00072060: 7428 2720 2020 2052 4d53 4520 3d20 2530  t('    RMSE = %0
-00072070: 2e32 6627 2025 726d 7365 290d 0a20 2020  .2f' %rmse)..   
-00072080: 2020 2020 2070 7269 6e74 2827 2020 2020       print('    
-00072090: 5374 6420 4465 7669 6174 696f 6e20 6f66  Std Deviation of
-000720a0: 2041 6374 7561 6c73 203d 2025 302e 3266   Actuals = %0.2f
-000720b0: 2720 2528 7374 645f 6465 7629 290d 0a20  ' %(std_dev)).. 
-000720c0: 2020 2020 2020 2070 7269 6e74 2827 2020         print('  
-000720d0: 2020 4e6f 726d 616c 697a 6564 2052 4d53    Normalized RMS
-000720e0: 4520 3d20 2530 2e31 6625 2527 2025 2872  E = %0.1f%%' %(r
-000720f0: 6d73 652a 3130 302f 7374 645f 6465 7629  mse*100/std_dev)
-00072100: 290d 0a20 2020 2072 6574 7572 6e20 726d  )..    return rm
-00072110: 7365 2c20 726d 7365 2f73 7464 5f64 6576  se, rmse/std_dev
-00072120: 0d0a 2323 2323 2323 2323 2323 2323 2323  ..##############
-00072130: 2323 2323 2323 2323 2323 2323 2323 2323  ################
-00072140: 2323 2323 2323 2323 2323 2323 2323 2323  ################
-00072150: 2323 2323 2323 2323 2323 2323 2323 2323  ################
-00072160: 2323 2323 2323 2323 2323 2323 2323 2323  ################
-00072170: 2323 0d0a 6672 6f6d 2073 6b6c 6561 726e  ##..from sklearn
-00072180: 2e6d 6574 7269 6373 2069 6d70 6f72 7420  .metrics import 
-00072190: 6d65 616e 5f73 7175 6172 6564 5f65 7272  mean_squared_err
-000721a0: 6f72 2c6d 6561 6e5f 6162 736f 6c75 7465  or,mean_absolute
-000721b0: 5f65 7272 6f72 0d0a 6465 6620 7072 696e  _error..def prin
-000721c0: 745f 726d 7365 2879 2c20 795f 6861 7429  t_rmse(y, y_hat)
-000721d0: 3a0d 0a20 2020 2022 2222 0d0a 2020 2020  :..    """..    
-000721e0: 4361 6c63 756c 6174 696e 6720 526f 6f74  Calculating Root
-000721f0: 204d 6561 6e20 5371 7561 7265 2045 7272   Mean Square Err
-00072200: 6f72 2068 7474 7073 3a2f 2f65 6e2e 7769  or https://en.wi
-00072210: 6b69 7065 6469 612e 6f72 672f 7769 6b69  kipedia.org/wiki
-00072220: 2f52 6f6f 742d 6d65 616e 2d73 7175 6172  /Root-mean-squar
-00072230: 655f 6465 7669 6174 696f 6e0d 0a20 2020  e_deviation..   
-00072240: 2022 2222 0d0a 2020 2020 6d73 6520 3d20   """..    mse = 
-00072250: 6e70 2e6d 6561 6e28 2879 202d 2079 5f68  np.mean((y - y_h
-00072260: 6174 292a 2a32 290d 0a20 2020 2072 6574  at)**2)..    ret
-00072270: 7572 6e20 6e70 2e73 7172 7428 6d73 6529  urn np.sqrt(mse)
-00072280: 0d0a 0d0a 6465 6620 7072 696e 745f 6d61  ....def print_ma
-00072290: 7065 2879 2c20 795f 6861 7429 3a0d 0a20  pe(y, y_hat):.. 
-000722a0: 2020 2022 2222 0d0a 2020 2020 4361 6c63     """..    Calc
-000722b0: 756c 6174 696e 6720 4d65 616e 2041 6273  ulating Mean Abs
-000722c0: 6f6c 7574 6520 5065 7263 656e 7420 4572  olute Percent Er
-000722d0: 726f 7220 6874 7470 733a 2f2f 656e 2e77  ror https://en.w
-000722e0: 696b 6970 6564 6961 2e6f 7267 2f77 696b  ikipedia.org/wik
-000722f0: 692f 4d65 616e 5f61 6273 6f6c 7574 655f  i/Mean_absolute_
-00072300: 7065 7263 656e 7461 6765 5f65 7272 6f72  percentage_error
-00072310: 0d0a 2020 2020 546f 2061 766f 6964 2069  ..    To avoid i
-00072320: 6e66 696e 6974 7920 6475 6520 746f 2064  nfinity due to d
-00072330: 6976 6973 696f 6e20 6279 207a 6572 6f2c  ivision by zero,
-00072340: 2077 6520 7365 6c65 6374 206d 6178 2830   we select max(0
-00072350: 2e30 312c 2061 6273 2861 6374 7561 6c73  .01, abs(actuals
-00072360: 2929 2074 6f20 7368 6f77 204d 4150 452e  )) to show MAPE.
-00072370: 0d0a 2020 2020 2222 220d 0a20 2020 2023  ..    """..    #
-00072380: 2323 2057 6865 7265 7665 7220 7468 6572  ## Wherever ther
-00072390: 6520 6973 207a 6572 6f2c 2072 6570 6c61  e is zero, repla
-000723a0: 6365 2069 7420 7769 7468 2030 2e30 3031  ce it with 0.001
-000723b0: 2073 6f20 6974 2064 6f65 736e 2774 2072   so it doesn't r
-000723c0: 6573 756c 7420 696e 2064 6976 6973 696f  esult in divisio
-000723d0: 6e20 6279 207a 6572 6f0d 0a20 2020 2070  n by zero..    p
-000723e0: 6572 635f 6572 7220 3d20 2831 3030 2a28  erc_err = (100*(
-000723f0: 6e70 2e77 6865 7265 2879 3d3d 302c 302e  np.where(y==0,0.
-00072400: 3030 312c 7929 202d 2079 5f68 6174 2929  001,y) - y_hat))
-00072410: 2f6e 702e 7768 6572 6528 793d 3d30 2c30  /np.where(y==0,0
-00072420: 2e30 3031 2c79 290d 0a20 2020 2072 6574  .001,y)..    ret
-00072430: 7572 6e20 6e70 2e6d 6561 6e28 6162 7328  urn np.mean(abs(
-00072440: 7065 7263 5f65 7272 2929 0d0a 2323 2323  perc_err))..####
-00072450: 2323 2323 2323 2323 2323 2323 2323 2323  ################
-00072460: 2323 2323 2323 2323 2323 2323 2323 2323  ################
-00072470: 2323 2323 2323 2323 2323 2323 2323 2323  ################
-00072480: 2323 2323 2323 2323 2323 2323 2323 2323  ################
-00072490: 2323 2323 2323 2323 2323 2323 0d0a 6672  ############..fr
-000724a0: 6f6d 2073 6b6c 6561 726e 2e6d 6574 7269  om sklearn.metri
-000724b0: 6373 2069 6d70 6f72 7420 6d65 616e 5f61  cs import mean_a
-000724c0: 6273 6f6c 7574 655f 6572 726f 722c 206d  bsolute_error, m
-000724d0: 6561 6e5f 7371 7561 7265 645f 6572 726f  ean_squared_erro
-000724e0: 720d 0a66 726f 6d20 6974 6572 746f 6f6c  r..from itertool
-000724f0: 7320 696d 706f 7274 2063 7963 6c65 0d0a  s import cycle..
-00072500: 696d 706f 7274 206d 6174 706c 6f74 6c69  import matplotli
-00072510: 622e 7079 706c 6f74 2061 7320 706c 740d  b.pyplot as plt.
-00072520: 0a64 6566 2070 6c6f 745f 6466 706c 6f74  .def plot_dfplot
-00072530: 2864 6670 6c6f 742c 706c 6f74 5f74 6974  (dfplot,plot_tit
-00072540: 6c65 3d22 2229 3a0d 0a20 2020 2066 6967  le=""):..    fig
-00072550: 7369 7a65 203d 2028 3130 2c20 3130 290d  size = (10, 10).
-00072560: 0a20 2020 2063 6f6c 6f72 7320 3d20 6379  .    colors = cy
-00072570: 636c 6528 2762 7972 636d 676b 6279 7263  cle('byrcmgkbyrc
-00072580: 6d67 6b62 7972 636d 676b 6279 7263 6d67  mgkbyrcmgkbyrcmg
-00072590: 6b27 290d 0a20 2020 2070 6c74 2e66 6967  k')..    plt.fig
-000725a0: 7572 6528 6669 6773 697a 653d 6669 6773  ure(figsize=figs
-000725b0: 697a 6529 0d0a 2020 2020 6163 7475 616c  ize)..    actual
-000725c0: 7320 3d20 6466 706c 6f74 5b27 4163 7475  s = dfplot['Actu
-000725d0: 616c 7327 5d0d 0a20 2020 2070 7265 6469  als']..    predi
-000725e0: 6374 6564 203d 2020 6466 706c 6f74 5b27  cted =  dfplot['
-000725f0: 5072 6564 6963 7465 6427 5d0d 0a20 2020  Predicted']..   
-00072600: 206c 696e 6553 7461 7274 203d 2061 6374   lineStart = act
-00072610: 7561 6c73 2e6d 696e 2829 0d0a 2020 2020  uals.min()..    
-00072620: 6c69 6e65 456e 6420 3d20 6163 7475 616c  lineEnd = actual
-00072630: 732e 6d61 7828 290d 0a20 2020 2070 6c74  s.max()..    plt
-00072640: 2e73 6361 7474 6572 2861 6374 7561 6c73  .scatter(actuals
-00072650: 2c20 7072 6564 6963 7465 642c 2063 6f6c  , predicted, col
-00072660: 6f72 203d 206e 6578 7428 636f 6c6f 7273  or = next(colors
-00072670: 292c 2061 6c70 6861 3d30 2e35 2c6c 6162  ), alpha=0.5,lab
-00072680: 656c 3d27 5072 6564 6963 7469 6f6e 7327  el='Predictions'
-00072690: 290d 0a20 2020 2070 6c74 2e70 6c6f 7428  )..    plt.plot(
-000726a0: 5b6c 696e 6553 7461 7274 2c20 6c69 6e65  [lineStart, line
-000726b0: 456e 645d 2c20 5b6c 696e 6553 7461 7274  End], [lineStart
-000726c0: 2c20 6c69 6e65 456e 645d 2c20 276b 2d27  , lineEnd], 'k-'
-000726d0: 2c20 636f 6c6f 7220 3d20 6e65 7874 2863  , color = next(c
-000726e0: 6f6c 6f72 7329 290d 0a20 2020 2070 6c74  olors))..    plt
-000726f0: 2e78 6c69 6d28 6c69 6e65 5374 6172 742c  .xlim(lineStart,
-00072700: 206c 696e 6545 6e64 290d 0a20 2020 2070   lineEnd)..    p
-00072710: 6c74 2e79 6c69 6d28 6c69 6e65 5374 6172  lt.ylim(lineStar
-00072720: 742c 206c 696e 6545 6e64 290d 0a20 2020  t, lineEnd)..   
-00072730: 2070 6c74 2e78 6c61 6265 6c28 2741 6374   plt.xlabel('Act
-00072740: 7561 6c27 290d 0a20 2020 2070 6c74 2e79  ual')..    plt.y
-00072750: 6c61 6265 6c28 2750 7265 6469 6374 6564  label('Predicted
-00072760: 2729 0d0a 2020 2020 706c 742e 6c65 6765  ')..    plt.lege
-00072770: 6e64 2829 0d0a 2020 2020 706c 742e 7469  nd()..    plt.ti
-00072780: 746c 6528 2750 7265 6469 6374 6564 2076  tle('Predicted v
-00072790: 7320 4163 7475 616c 7320 666f 7220 5461  s Actuals for Ta
-000727a0: 7267 6574 203d 2025 7327 2025 706c 6f74  rget = %s' %plot
-000727b0: 5f74 6974 6c65 2c20 666f 6e74 7369 7a65  _title, fontsize
-000727c0: 3d31 3229 0d0a 2020 2020 706c 742e 7368  =12)..    plt.sh
-000727d0: 6f77 2829 3b0d 0a23 2323 2323 2323 2323  ow();..#########
-000727e0: 2323 2323 2323 2323 2323 2323 2323 2323  ################
-000727f0: 2323 2323 2323 2323 2323 2323 2323 2323  ################
-00072800: 2323 2323 2323 2323 2323 2323 2323 2323  ################
-00072810: 2323 2323 2323 2323 2323 2323 2323 2323  ################
-00072820: 2323 2323 2323 0d0a 6672 6f6d 2063 6f6c  ######..from col
-00072830: 6c65 6374 696f 6e73 2069 6d70 6f72 7420  lections import 
-00072840: 6465 6661 756c 7464 6963 740d 0a64 6566  defaultdict..def
-00072850: 2072 6574 7572 6e5f 6c69 7374 5f6d 6174   return_list_mat
-00072860: 6368 696e 675f 6b65 7973 2864 6963 746f  ching_keys(dicto
-00072870: 2c6c 6973 745f 6b65 7973 293a 0d0a 2020  ,list_keys):..  
-00072880: 2020 2727 2752 6574 7572 6e20 6120 6c69    '''Return a li
-00072890: 7374 206f 6620 7661 6c75 6573 206d 6174  st of values mat
-000728a0: 6368 696e 6720 6b65 7973 2069 6e20 6120  ching keys in a 
-000728b0: 6469 6374 696f 6e61 7279 0d0a 2020 2020  dictionary..    
-000728c0: 6672 6f6d 2061 206c 6973 7420 6f66 206b  from a list of k
-000728d0: 6579 732e 2052 6574 7572 6e73 2056 616c  eys. Returns Val
-000728e0: 7565 7320 696e 2074 6865 2053 616d 6520  ues in the Same 
-000728f0: 6f72 6465 7220 6173 2074 6865 204c 6973  order as the Lis
-00072900: 7420 4b65 7973 2e0d 0a20 2020 2027 2727  t Keys...    '''
-00072910: 0d0a 2020 2020 7265 7375 6c74 7320 3d20  ..    results = 
-00072920: 5b5d 0d0a 2020 2020 666f 7220 6561 6368  []..    for each
-00072930: 2069 6e20 6c69 7374 5f6b 6579 733a 0d0a   in list_keys:..
-00072940: 2020 2020 2020 2020 7265 7375 6c74 732e          results.
-00072950: 6170 7065 6e64 2864 6963 746f 5b65 6163  append(dicto[eac
-00072960: 685d 290d 0a20 2020 2072 6574 7572 6e20  h])..    return 
-00072970: 7265 7375 6c74 730d 0a23 2323 2323 2323  results..#######
-00072980: 2323 2323 2323 2323 2323 2323 2323 2323  ################
-00072990: 2323 2323 2323 2323 2323 2323 2323 2323  ################
-000729a0: 2323 2323 2323 2323 2323 2323 2323 2323  ################
-000729b0: 2323 2323 2323 2323 2323 2323 2323 2323  ################
-000729c0: 2323 2323 2323 2323 2323 230d 0a64 6566  ###########..def
-000729d0: 2072 656d 6f76 655f 6869 6768 6c79 5f63   remove_highly_c
-000729e0: 6f72 7265 6c61 7465 645f 7661 7273 5f66  orrelated_vars_f
-000729f0: 6173 7428 6466 2c20 636f 7272 5f6c 696d  ast(df, corr_lim
-00072a00: 6974 3d30 2e37 3029 3a0d 0a20 2020 2022  it=0.70):..    "
-00072a10: 2222 0d0a 2020 2020 5468 6973 2069 7320  ""..    This is 
-00072a20: 6120 7369 6d70 6c65 206d 6574 686f 6420  a simple method 
-00072a30: 746f 2072 656d 6f76 6520 6869 6768 6c79  to remove highly
-00072a40: 2063 6f72 7265 6c61 7465 6420 6665 6174   correlated feat
-00072a50: 7572 6573 2066 6173 7420 7573 696e 6720  ures fast using 
-00072a60: 5065 6172 736f 6e27 7320 436f 7272 656c  Pearson's Correl
-00072a70: 6174 696f 6e2e 0d0a 2020 2020 5573 6520  ation...    Use 
-00072a80: 7468 6973 206f 6e6c 7920 666f 7220 666c  this only for fl
-00072a90: 6f61 7420 616e 6420 696e 7465 6765 7220  oat and integer 
-00072aa0: 7661 7269 6162 6c65 732e 2049 7420 7769  variables. It wi
-00072ab0: 6c6c 2061 7574 6f6d 6174 6963 616c 6c79  ll automatically
-00072ac0: 2073 656c 6563 7420 7468 6f73 6520 6f6e   select those on
-00072ad0: 6c79 2e0d 0a20 2020 2049 7420 6361 6e20  ly...    It can 
-00072ae0: 6265 2075 7365 6420 666f 7220 7665 7279  be used for very
-00072af0: 206c 6172 6765 2064 6174 6120 7365 7473   large data sets
-00072b00: 2077 6865 7265 2066 6561 7475 7265 7769   where featurewi
-00072b10: 7a20 6861 7320 7472 6f75 626c 6520 7769  z has trouble wi
-00072b20: 7468 206d 656d 6f72 790d 0a20 2020 2022  th memory..    "
-00072b30: 2222 0d0a 2020 2020 2320 4372 6561 7469  ""..    # Creati
-00072b40: 6e67 2063 6f72 7265 6c61 7469 6f6e 206d  ng correlation m
-00072b50: 6174 7269 780d 0a20 2020 2063 6f72 5f6d  atrix..    cor_m
-00072b60: 6174 7269 7820 3d20 6466 2e63 6f72 7228  atrix = df.corr(
-00072b70: 292e 6162 7328 292e 6173 7479 7065 286e  ).abs().astype(n
-00072b80: 702e 666c 6f61 7431 3629 0d0a 2020 2020  p.float16)..    
-00072b90: 2320 5365 6c65 6374 696e 6720 7570 7065  # Selecting uppe
-00072ba0: 7220 7472 6961 6e67 6c65 206f 6620 636f  r triangle of co
-00072bb0: 7272 656c 6174 696f 6e20 6d61 7472 6978  rrelation matrix
-00072bc0: 0d0a 2020 2020 7570 7065 725f 7472 6920  ..    upper_tri 
-00072bd0: 3d20 636f 725f 6d61 7472 6978 2e77 6865  = cor_matrix.whe
-00072be0: 7265 286e 702e 7472 6975 286e 702e 6f6e  re(np.triu(np.on
-00072bf0: 6573 2863 6f72 5f6d 6174 7269 782e 7368  es(cor_matrix.sh
-00072c00: 6170 6529 2c0d 0a20 2020 2020 2020 2020  ape),..         
-00072c10: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00072c20: 2020 2020 2020 2020 206b 3d31 292e 6173           k=1).as
-00072c30: 7479 7065 286e 702e 626f 6f6c 2929 0d0a  type(np.bool))..
-00072c40: 2020 2020 2320 4669 6e64 696e 6720 696e      # Finding in
-00072c50: 6465 7820 6f66 2066 6561 7475 7265 2063  dex of feature c
-00072c60: 6f6c 756d 6e73 2077 6974 6820 636f 7272  olumns with corr
-00072c70: 656c 6174 696f 6e20 6772 6561 7465 7220  elation greater 
-00072c80: 7468 616e 2030 2e39 350d 0a20 2020 2074  than 0.95..    t
-00072c90: 6f5f 6472 6f70 203d 205b 636f 6c75 6d6e  o_drop = [column
-00072ca0: 2066 6f72 2063 6f6c 756d 6e20 696e 2075   for column in u
-00072cb0: 7070 6572 5f74 7269 2e63 6f6c 756d 6e73  pper_tri.columns
-00072cc0: 2069 6620 616e 7928 7570 7065 725f 7472   if any(upper_tr
-00072cd0: 695b 636f 6c75 6d6e 5d20 3e20 636f 7272  i[column] > corr
-00072ce0: 5f6c 696d 6974 295d 0d0a 2020 2020 7072  _limit)]..    pr
-00072cf0: 696e 7428 293b 0d0a 2020 2020 7072 696e  int();..    prin
-00072d00: 7428 2748 6967 686c 7920 636f 7272 656c  t('Highly correl
-00072d10: 6174 6564 2063 6f6c 756d 6e73 2074 6f20  ated columns to 
-00072d20: 7265 6d6f 7665 3a20 2573 2720 2574 6f5f  remove: %s' %to_
-00072d30: 6472 6f70 290d 0a20 2020 2072 6574 7572  drop)..    retur
-00072d40: 6e20 746f 5f64 726f 700d 0a23 2323 2323  n to_drop..#####
-00072d50: 2323 2323 2323 2323 2323 2323 2323 2323  ################
-00072d60: 2323 2323 2323 2323 2323 2323 2323 2323  ################
-00072d70: 2323 2323 2323 2323 2323 2323 2323 2323  ################
-00072d80: 2323 2323 2323 2323 2323 2323 2323 2323  ################
-00072d90: 2323 2323 2323 2323 2323 2323 2323 2323  ################
-00072da0: 0d0a 6465 6620 6164 645f 656e 7472 6f70  ..def add_entrop
-00072db0: 795f 6269 6e6e 696e 6728 7465 6d70 5f74  y_binning(temp_t
-00072dc0: 7261 696e 2c20 7461 7267 2c20 6e75 6d5f  rain, targ, num_
-00072dd0: 7661 7273 2c20 696d 706f 7274 616e 745f  vars, important_
-00072de0: 6665 6174 7572 6573 2c20 7465 6d70 5f74  features, temp_t
-00072df0: 6573 742c 0d0a 2020 2020 2020 2020 2020  est,..          
-00072e00: 2020 2020 2020 2020 2020 2020 206d 6f64               mod
-00072e10: 656c 7479 7065 2c20 656e 7472 6f70 795f  eltype, entropy_
-00072e20: 6269 6e6e 696e 672c 7665 7262 6f73 653d  binning,verbose=
-00072e30: 3029 3a0d 0a20 2020 2022 2222 0d0a 2020  0):..    """..  
-00072e40: 2020 2020 2020 2323 2323 2323 2020 2054        ######   T
-00072e50: 6869 7320 6973 2077 6865 7265 2077 6520  his is where we 
-00072e60: 646f 2045 4e54 524f 5059 2042 494e 4e49  do ENTROPY BINNI
-00072e70: 4e47 204f 4620 434f 4e54 494e 554f 5553  NG OF CONTINUOUS
-00072e80: 2056 4152 5320 2323 2323 2323 2323 2323   VARS ##########
-00072e90: 230d 0a20 2020 2020 2020 2023 2323 2320  #..        #### 
-00072ea0: 4974 2069 7320 6265 7374 2074 6f20 646f  It is best to do
-00072eb0: 2042 696e 6e69 6e67 206f 6e20 4f4e 4c59   Binning on ONLY
-00072ec0: 206f 6e20 7468 6520 746f 7020 6d6f 7374   on the top most
-00072ed0: 2076 6172 6961 626c 6573 2066 726f 6d20   variables from 
-00072ee0: 496d 706f 7274 616e 745f 4665 6174 7572  Important_Featur
-00072ef0: 6573 210d 0a20 2020 2020 2020 2023 2323  es!..        ###
-00072f00: 2320 4d61 6b65 2073 7572 6520 7468 6174  # Make sure that
-00072f10: 2074 6865 2054 6f70 2032 2d31 3020 7661   the Top 2-10 va
-00072f20: 7273 2061 7265 2061 6c6c 2043 4f4e 5449  rs are all CONTI
-00072f30: 4e55 4f55 5320 5641 5253 2120 4f74 6865  NUOUS VARS! Othe
-00072f40: 7277 6973 6520 4269 6e6e 696e 6720 6973  rwise Binning is
-00072f50: 2057 6173 7465 210d 0a20 2020 2020 2020   Waste!..       
-00072f60: 2023 2323 2320 5468 6973 206d 6574 686f   #### This metho
-00072f70: 6420 656e 7375 7265 7320 796f 7520 6765  d ensures you ge
-00072f80: 7420 7468 6520 4265 7374 2052 6573 756c  t the Best Resul
-00072f90: 7473 2062 7920 6765 6e65 7261 6c69 7a69  ts by generalizi
-00072fa0: 6e67 206f 6e20 7468 6520 746f 7020 6e75  ng on the top nu
-00072fb0: 6d65 7269 6320 7661 7273 210d 0a20 2020  meric vars!..   
-00072fc0: 2022 2222 0d0a 2020 2020 7465 6d70 5f74   """..    temp_t
-00072fd0: 7261 696e 203d 2063 6f70 792e 6465 6570  rain = copy.deep
-00072fe0: 636f 7079 2874 656d 705f 7472 6169 6e29  copy(temp_train)
-00072ff0: 0d0a 2020 2020 7465 6d70 5f74 6573 7420  ..    temp_test 
-00073000: 3d20 636f 7079 2e64 6565 7063 6f70 7928  = copy.deepcopy(
-00073010: 7465 6d70 5f74 6573 7429 0d0a 2020 2020  temp_test)..    
-00073020: 6d61 785f 6465 7074 6820 3d20 3130 0d0a  max_depth = 10..
-00073030: 2020 2020 7365 6564 203d 2039 390d 0a20      seed = 99.. 
-00073040: 2020 206e 756d 5f76 6172 7320 3d20 636f     num_vars = co
-00073050: 7079 2e64 6565 7063 6f70 7928 6e75 6d5f  py.deepcopy(num_
-00073060: 7661 7273 290d 0a20 2020 2063 6f6e 7469  vars)..    conti
-00073070: 6e75 6f75 735f 7661 7273 203d 2063 6f70  nuous_vars = cop
-00073080: 792e 6465 6570 636f 7079 286e 756d 5f76  y.deepcopy(num_v
-00073090: 6172 7329 0d0a 2020 2020 696d 706f 7274  ars)..    import
-000730a0: 616e 745f 6665 6174 7572 6573 203d 2063  ant_features = c
-000730b0: 6f70 792e 6465 6570 636f 7079 2869 6d70  opy.deepcopy(imp
-000730c0: 6f72 7461 6e74 5f66 6561 7475 7265 7329  ortant_features)
-000730d0: 0d0a 2020 2020 7072 696e 7428 2744 6574  ..    print('Det
-000730e0: 6572 6d69 6e69 6e67 2077 6869 6368 206f  ermining which o
-000730f0: 6620 2564 2063 6f6e 7469 6e75 6f75 7320  f %d continuous 
-00073100: 7661 7269 6162 6c65 7320 7368 6f75 6c64  variables should
-00073110: 2062 6520 456e 7472 6f70 7920 4269 6e6e   be Entropy Binn
-00073120: 6564 2e2e 2e27 2025 6c65 6e28 636f 6e74  ed...' %len(cont
-00073130: 696e 756f 7573 5f76 6172 7329 290d 0a20  inuous_vars)).. 
-00073140: 2020 2069 6620 6c65 6e28 636f 6e74 696e     if len(contin
-00073150: 756f 7573 5f76 6172 7329 203e 2030 2061  uous_vars) > 0 a
-00073160: 6e64 206c 656e 2863 6f6e 7469 6e75 6f75  nd len(continuou
-00073170: 735f 7661 7273 2920 3c3d 2032 3a0d 0a20  s_vars) <= 2:.. 
-00073180: 2020 2020 2020 206d 6178 5f64 6570 7468         max_depth
-00073190: 203d 2020 320d 0a20 2020 2020 2020 2063   =  2..        c
-000731a0: 6f6e 7469 6e75 6f75 735f 7661 7273 203d  ontinuous_vars =
-000731b0: 2063 6f6e 7469 6e75 6f75 735f 7661 7273   continuous_vars
-000731c0: 5b3a 5d0d 0a20 2020 2065 6c69 6620 6c65  [:]..    elif le
-000731d0: 6e28 636f 6e74 696e 756f 7573 5f76 6172  n(continuous_var
-000731e0: 7329 203e 2032 2061 6e64 206c 656e 2863  s) > 2 and len(c
-000731f0: 6f6e 7469 6e75 6f75 735f 7661 7273 2920  ontinuous_vars) 
-00073200: 3c3d 2035 3a0d 0a20 2020 2020 2020 206d  <= 5:..        m
-00073210: 6178 5f64 6570 7468 203d 206c 656e 2863  ax_depth = len(c
-00073220: 6f6e 7469 6e75 6f75 735f 7661 7273 2920  ontinuous_vars) 
-00073230: 2d20 320d 0a20 2020 2020 2020 2063 6f6e  - 2..        con
-00073240: 7469 6e75 6f75 735f 7661 7273 203d 2063  tinuous_vars = c
-00073250: 6f6e 7469 6e75 6f75 735f 7661 7273 5b3a  ontinuous_vars[:
-00073260: 325d 0d0a 2020 2020 656c 6966 206c 656e  2]..    elif len
-00073270: 2863 6f6e 7469 6e75 6f75 735f 7661 7273  (continuous_vars
-00073280: 2920 3e20 3520 616e 6420 6c65 6e28 636f  ) > 5 and len(co
-00073290: 6e74 696e 756f 7573 5f76 6172 7329 203c  ntinuous_vars) <
-000732a0: 3d20 3130 3a0d 0a20 2020 2020 2020 206d  = 10:..        m
-000732b0: 6178 5f64 6570 7468 203d 2035 0d0a 2020  ax_depth = 5..  
-000732c0: 2020 2020 2020 636f 6e74 696e 756f 7573        continuous
-000732d0: 5f76 6172 7320 3d20 636f 6e74 696e 756f  _vars = continuo
-000732e0: 7573 5f76 6172 735b 3a35 5d0d 0a20 2020  us_vars[:5]..   
-000732f0: 2065 6c69 6620 6c65 6e28 636f 6e74 696e   elif len(contin
-00073300: 756f 7573 5f76 6172 7329 203e 2031 3020  uous_vars) > 10 
-00073310: 616e 6420 6c65 6e28 636f 6e74 696e 756f  and len(continuo
-00073320: 7573 5f76 6172 7329 203c 3d20 3530 3a0d  us_vars) <= 50:.
-00073330: 0a20 2020 2020 2020 206d 6178 5f64 6570  .        max_dep
-00073340: 7468 203d 206d 6178 5f64 6570 7468 0d0a  th = max_depth..
-00073350: 2020 2020 2020 2020 636f 6e74 696e 756f          continuo
-00073360: 7573 5f76 6172 7320 3d20 636f 6e74 696e  us_vars = contin
-00073370: 756f 7573 5f76 6172 735b 3a31 305d 0d0a  uous_vars[:10]..
-00073380: 2020 2020 656c 7365 3a0d 0a20 2020 2020      else:..     
-00073390: 2020 206d 6178 5f64 6570 7468 203d 206d     max_depth = m
-000733a0: 6178 5f64 6570 7468 0d0a 2020 2020 2020  ax_depth..      
-000733b0: 2020 636f 6e74 696e 756f 7573 5f76 6172    continuous_var
-000733c0: 7320 3d20 636f 6e74 696e 756f 7573 5f76  s = continuous_v
-000733d0: 6172 735b 3a35 305d 0d0a 2020 2020 6e65  ars[:50]..    ne
-000733e0: 775f 6269 6e63 6f6c 7320 3d20 5b5d 0d0a  w_bincols = []..
-000733f0: 2020 2020 2323 2320 2020 5468 6973 2069      ###   This i
-00073400: 7320 616e 2041 7765 736f 6d65 2045 6e74  s an Awesome Ent
-00073410: 726f 7079 2042 6173 6564 2042 696e 6e69  ropy Based Binni
-00073420: 6e67 204d 6574 686f 6420 666f 7220 436f  ng Method for Co
-00073430: 6e74 696e 756f 7573 2056 6172 6961 626c  ntinuous Variabl
-00073440: 6573 2023 2323 2323 2323 2323 2323 0d0a  es ###########..
-00073450: 2020 2020 6672 6f6d 2073 6b6c 6561 726e      from sklearn
-00073460: 2e74 7265 6520 696d 706f 7274 2044 6563  .tree import Dec
-00073470: 6973 696f 6e54 7265 6552 6567 7265 7373  isionTreeRegress
-00073480: 6f72 2c20 4465 6369 7369 6f6e 5472 6565  or, DecisionTree
-00073490: 436c 6173 7369 6669 6572 0d0a 2020 2020  Classifier..    
-000734a0: 6966 206d 6f64 656c 7479 7065 203d 3d20  if modeltype == 
-000734b0: 2752 6567 7265 7373 696f 6e27 3a0d 0a20  'Regression':.. 
-000734c0: 2020 2020 2020 2063 6c66 203d 2044 6563         clf = Dec
-000734d0: 6973 696f 6e54 7265 6552 6567 7265 7373  isionTreeRegress
-000734e0: 6f72 2863 7269 7465 7269 6f6e 3d27 6d73  or(criterion='ms
-000734f0: 6527 2c6d 696e 5f73 616d 706c 6573 5f6c  e',min_samples_l
-00073500: 6561 663d 322c 0d0a 2020 2020 2020 2020  eaf=2,..        
-00073510: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00073520: 2020 2020 2020 2020 2020 2020 6d61 785f              max_
-00073530: 6465 7074 683d 6d61 785f 6465 7074 682c  depth=max_depth,
-00073540: 0d0a 2020 2020 2020 2020 2020 2020 2020  ..              
-00073550: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00073560: 2020 2020 2020 7261 6e64 6f6d 5f73 7461        random_sta
-00073570: 7465 3d73 6565 6429 0d0a 2020 2020 656c  te=seed)..    el
-00073580: 7365 3a0d 0a20 2020 2020 2020 2063 6c66  se:..        clf
-00073590: 203d 2044 6563 6973 696f 6e54 7265 6543   = DecisionTreeC
-000735a0: 6c61 7373 6966 6965 7228 6372 6974 6572  lassifier(criter
-000735b0: 696f 6e3d 2765 6e74 726f 7079 272c 6d69  ion='entropy',mi
-000735c0: 6e5f 7361 6d70 6c65 735f 6c65 6166 3d32  n_samples_leaf=2
-000735d0: 2c0d 0a20 2020 2020 2020 2020 2020 2020  ,..             
-000735e0: 2020 2020 2020 2020 2020 2020 2020 2020                  
-000735f0: 2020 2020 2020 2020 2020 2020 6d61 785f              max_
-00073600: 6465 7074 683d 6d61 785f 6465 7074 682c  depth=max_depth,
-00073610: 0d0a 2020 2020 2020 2020 2020 2020 2020  ..              
-00073620: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00073630: 2020 2020 2020 2020 2020 2072 616e 646f             rando
-00073640: 6d5f 7374 6174 653d 7365 6564 290d 0a20  m_state=seed).. 
-00073650: 2020 2065 6e74 726f 7079 5f74 6872 6573     entropy_thres
-00073660: 686f 6c64 203d 205b 5d0d 0a20 2020 2023  hold = []..    #
-00073670: 2323 2323 2323 2054 6869 7320 6973 2077  ###### This is w
-00073680: 6865 7265 2077 6520 6269 6e20 6561 6368  here we bin each
-00073690: 2076 6172 6961 626c 6520 7468 726f 7567   variable throug
-000736a0: 6820 6120 6d65 7468 6f64 206b 6e6f 776e  h a method known
-000736b0: 2061 7320 456e 7472 6f70 7920 4269 6e6e   as Entropy Binn
-000736c0: 696e 6720 2323 2323 2323 2323 2323 2323  ing ############
-000736d0: 2323 0d0a 2020 2020 666f 7220 6561 6368  ##..    for each
-000736e0: 5f6e 756d 2069 6e20 636f 6e74 696e 756f  _num in continuo
-000736f0: 7573 5f76 6172 733a 0d0a 2020 2020 2020  us_vars:..      
-00073700: 2020 7472 793a 0d0a 2020 2020 2020 2020    try:..        
-00073710: 2020 2020 636c 662e 6669 7428 7465 6d70      clf.fit(temp
-00073720: 5f74 7261 696e 5b65 6163 685f 6e75 6d5d  _train[each_num]
-00073730: 2e76 616c 7565 732e 7265 7368 6170 6528  .values.reshape(
-00073740: 2d31 2c31 292c 7465 6d70 5f74 7261 696e  -1,1),temp_train
-00073750: 5b74 6172 675d 2e76 616c 7565 7329 0d0a  [targ].values)..
-00073760: 2020 2020 2020 2020 2020 2020 656e 7472              entr
-00073770: 6f70 795f 7468 7265 7368 6f6c 6420 3d20  opy_threshold = 
-00073780: 636c 662e 7472 6565 5f2e 7468 7265 7368  clf.tree_.thresh
-00073790: 6f6c 645b 636c 662e 7472 6565 5f2e 7468  old[clf.tree_.th
-000737a0: 7265 7368 6f6c 643e 2d32 5d0d 0a20 2020  reshold>-2]..   
-000737b0: 2020 2020 2020 2020 2065 6e74 726f 7079           entropy
-000737c0: 5f74 6872 6573 686f 6c64 203d 206e 702e  _threshold = np.
-000737d0: 736f 7274 2865 6e74 726f 7079 5f74 6872  sort(entropy_thr
-000737e0: 6573 686f 6c64 290d 0a20 2020 2020 2020  eshold)..       
-000737f0: 2020 2020 2069 6620 6973 696e 7374 616e       if isinstan
-00073800: 6365 2865 6163 685f 6e75 6d2c 2073 7472  ce(each_num, str
-00073810: 293a 0d0a 2020 2020 2020 2020 2020 2020  ):..            
-00073820: 2020 2020 6269 6e63 6f6c 203d 2065 6163      bincol = eac
-00073830: 685f 6e75 6d2b 275f 6269 6e27 0d0a 2020  h_num+'_bin'..  
-00073840: 2020 2020 2020 2020 2020 2020 2020 7465                te
-00073850: 6d70 5f74 7261 696e 5b62 696e 636f 6c5d  mp_train[bincol]
-00073860: 203d 206e 702e 6469 6769 7469 7a65 2874   = np.digitize(t
-00073870: 656d 705f 7472 6169 6e5b 6561 6368 5f6e  emp_train[each_n
-00073880: 756d 5d2e 7661 6c75 6573 2c20 656e 7472  um].values, entr
-00073890: 6f70 795f 7468 7265 7368 6f6c 6429 0d0a  opy_threshold)..
-000738a0: 2020 2020 2020 2020 2020 2020 656c 7365              else
-000738b0: 3a0d 0a20 2020 2020 2020 2020 2020 2020  :..             
-000738c0: 2020 2062 696e 636f 6c20 3d20 2762 696e     bincol = 'bin
-000738d0: 5f27 2b73 7472 2865 6163 685f 6e75 6d29  _'+str(each_num)
-000738e0: 0d0a 2020 2020 2020 2020 2020 2020 2020  ..              
-000738f0: 2020 7465 6d70 5f74 7261 696e 5b62 696e    temp_train[bin
-00073900: 636f 6c5d 203d 206e 702e 6469 6769 7469  col] = np.digiti
-00073910: 7a65 2874 656d 705f 7472 6169 6e5b 6561  ze(temp_train[ea
-00073920: 6368 5f6e 756d 5d2e 7661 6c75 6573 2c20  ch_num].values, 
-00073930: 656e 7472 6f70 795f 7468 7265 7368 6f6c  entropy_threshol
-00073940: 6429 0d0a 2020 2020 2020 2020 2020 2020  d)..            
-00073950: 2323 2323 2057 6520 4472 6f70 2074 6865  #### We Drop the
-00073960: 206f 7269 6769 6e61 6c20 636f 6e74 696e   original contin
-00073970: 756f 7573 2076 6172 6961 626c 6520 6166  uous variable af
-00073980: 7465 7220 796f 7520 6861 7665 2063 7265  ter you have cre
-00073990: 6174 6564 2074 6865 2062 696e 2077 6865  ated the bin whe
-000739a0: 6e20 466c 6167 2069 7320 7472 7565 0d0a  n Flag is true..
-000739b0: 2020 2020 2020 2020 2020 2020 2323 2320              ### 
-000739c0: 5765 2044 6f6e 2774 2064 726f 7020 7468  We Don't drop th
-000739d0: 6573 6520 6f72 6967 696e 616c 206e 756d  ese original num
-000739e0: 6572 6963 2076 6172 7320 7369 6e63 6520  eric vars since 
-000739f0: 7468 6579 2077 696c 6c20 6265 2075 7365  they will be use
-00073a00: 6420 6c61 7465 7220 666f 7220 6675 6c6c  d later for full
-00073a10: 2074 7261 696e 2062 696e 6e69 6e67 0d0a   train binning..
-00073a20: 2020 2020 2020 2020 2020 2020 6966 2074              if t
-00073a30: 7970 6528 7465 6d70 5f74 6573 7429 2021  ype(temp_test) !
-00073a40: 3d20 7374 723a 0d0a 2020 2020 2020 2020  = str:..        
-00073a50: 2020 2020 2020 2020 6966 2069 7369 6e73          if isins
-00073a60: 7461 6e63 6528 6561 6368 5f6e 756d 2c20  tance(each_num, 
-00073a70: 7374 7229 3a0d 0a20 2020 2020 2020 2020  str):..         
-00073a80: 2020 2020 2020 2020 2020 2062 696e 636f             binco
-00073a90: 6c20 3d20 6561 6368 5f6e 756d 2b27 5f62  l = each_num+'_b
-00073aa0: 696e 270d 0a20 2020 2020 2020 2020 2020  in'..           
-00073ab0: 2020 2020 2020 2020 2074 656d 705f 7465           temp_te
-00073ac0: 7374 5b62 696e 636f 6c5d 203d 206e 702e  st[bincol] = np.
-00073ad0: 6469 6769 7469 7a65 2874 656d 705f 7465  digitize(temp_te
-00073ae0: 7374 5b65 6163 685f 6e75 6d5d 2e76 616c  st[each_num].val
-00073af0: 7565 732c 2065 6e74 726f 7079 5f74 6872  ues, entropy_thr
-00073b00: 6573 686f 6c64 290d 0a20 2020 2020 2020  eshold)..       
-00073b10: 2020 2020 2020 2020 2065 6c73 653a 0d0a           else:..
-00073b20: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00073b30: 2020 2020 6269 6e63 6f6c 203d 2027 6269      bincol = 'bi
-00073b40: 6e5f 272b 7374 7228 6561 6368 5f6e 756d  n_'+str(each_num
-00073b50: 290d 0a20 2020 2020 2020 2020 2020 2020  )..             
-00073b60: 2020 2020 2020 2074 656d 705f 7465 7374         temp_test
-00073b70: 5b62 696e 636f 6c5d 203d 206e 702e 6469  [bincol] = np.di
-00073b80: 6769 7469 7a65 2874 656d 705f 7465 7374  gitize(temp_test
-00073b90: 5b65 6163 685f 6e75 6d5d 2e76 616c 7565  [each_num].value
-00073ba0: 732c 2065 6e74 726f 7079 5f74 6872 6573  s, entropy_thres
-00073bb0: 686f 6c64 290d 0a20 2020 2020 2020 2020  hold)..         
-00073bc0: 2020 2020 2020 2023 2323 2320 5765 2044         #### We D
-00073bd0: 726f 7020 7468 6520 6f72 6967 696e 616c  rop the original
-00073be0: 2063 6f6e 7469 6e75 6f75 7320 7661 7269   continuous vari
-00073bf0: 6162 6c65 2061 6674 6572 2079 6f75 2068  able after you h
-00073c00: 6176 6520 6372 6561 7465 6420 7468 6520  ave created the 
-00073c10: 6269 6e20 7768 656e 2046 6c61 6720 6973  bin when Flag is
-00073c20: 2074 7275 650d 0a20 2020 2020 2020 2020   true..         
-00073c30: 2020 2020 2020 2023 2323 2057 6520 446f         ### We Do
-00073c40: 6e27 7420 6472 6f70 2074 6865 7365 206f  n't drop these o
-00073c50: 7269 6769 6e61 6c20 6e75 6d65 7269 6320  riginal numeric 
-00073c60: 7661 7273 2073 696e 6365 2074 6865 7920  vars since they 
-00073c70: 7769 6c6c 2062 6520 7573 6564 206c 6174  will be used lat
-00073c80: 6572 2066 6f72 2066 756c 6c20 7472 6169  er for full trai
-00073c90: 6e20 6269 6e6e 696e 670d 0a20 2020 2020  n binning..     
-00073ca0: 2020 2020 2020 2069 6620 656e 7472 6f70         if entrop
-00073cb0: 795f 6269 6e6e 696e 673a 0d0a 2020 2020  y_binning:..    
-00073cc0: 2020 2020 2020 2020 2020 2020 2323 2320              ### 
-00073cd0: 496e 2074 6865 2073 6563 6f6e 6420 7469  In the second ti
-00073ce0: 6d65 2c20 7765 2064 6f6e 2774 2072 6570  me, we don't rep
-00073cf0: 6561 7420 6164 6469 6e67 2062 696e 6e65  eat adding binne
-00073d00: 6420 7661 7273 2073 696e 6365 2074 6865  d vars since the
-00073d10: 7920 6861 7665 2061 6c72 6561 6479 2062  y have already b
-00073d20: 6565 6e20 6164 6465 6421 0d0a 2020 2020  een added!..    
-00073d30: 2020 2020 2020 2020 2020 2020 2323 2323              ####
-00073d40: 2077 6520 616c 736f 206d 616b 6520 7375   we also make su
-00073d50: 7265 2074 6861 7420 7468 6520 6f72 6967  re that the orig
-00073d60: 206e 756d 2076 6172 7320 7768 6963 6820   num vars which 
-00073d70: 6861 7665 206e 6f77 2062 6565 6e20 6269  have now been bi
-00073d80: 6e6e 6564 2061 7265 2072 656d 6f76 6564  nned are removed
-00073d90: 210d 0a20 2020 2020 2020 2020 2020 2020  !..             
-00073da0: 2020 2074 656d 705f 7472 6169 6e2e 6472     temp_train.dr
-00073db0: 6f70 2865 6163 685f 6e75 6d2c 6178 6973  op(each_num,axis
-00073dc0: 3d31 2c69 6e70 6c61 6365 3d54 7275 6529  =1,inplace=True)
-00073dd0: 0d0a 2020 2020 2020 2020 2020 2020 2020  ..              
-00073de0: 2020 6966 2074 7970 6528 7465 6d70 5f74    if type(temp_t
-00073df0: 6573 7429 2021 3d20 7374 723a 0d0a 2020  est) != str:..  
-00073e00: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00073e10: 2020 7465 6d70 5f74 6573 742e 6472 6f70    temp_test.drop
-00073e20: 2865 6163 685f 6e75 6d2c 6178 6973 3d31  (each_num,axis=1
-00073e30: 2c69 6e70 6c61 6365 3d54 7275 6529 0d0a  ,inplace=True)..
-00073e40: 2020 2020 2020 2020 2020 2020 656c 7365              else
-00073e50: 3a0d 0a20 2020 2020 2020 2020 2020 2020  :..             
-00073e60: 2020 2023 2323 2320 496e 2074 6865 2066     #### In the f
-00073e70: 6972 7374 2074 696d 652c 2077 6520 6164  irst time, we ad
-00073e80: 6420 6269 6e6e 6564 2076 6172 7320 746f  d binned vars to
-00073e90: 2020 696d 706f 7274 616e 745f 6665 6174    important_feat
-00073ea0: 7572 6573 2020 2323 230d 0a20 2020 2020  ures  ###..     
-00073eb0: 2020 2020 2020 2020 2020 2023 2323 2049             ### I
-00073ec0: 6e20 7468 6520 7365 636f 6e64 2074 696d  n the second tim
-00073ed0: 652c 2077 6520 646f 6e27 7420 7265 7065  e, we don't repe
-00073ee0: 6174 2074 6861 7420 7369 6e63 6520 7468  at that since th
-00073ef0: 6579 2068 6176 6520 616c 7265 6164 7920  ey have already 
-00073f00: 6265 656e 2061 6464 6564 210d 0a20 2020  been added!..   
-00073f10: 2020 2020 2020 2020 2020 2020 2069 6d70               imp
-00073f20: 6f72 7461 6e74 5f66 6561 7475 7265 732e  ortant_features.
-00073f30: 6170 7065 6e64 2862 696e 636f 6c29 0d0a  append(bincol)..
-00073f40: 2020 2020 2020 2020 2020 2020 6e75 6d5f              num_
-00073f50: 7661 7273 2e61 7070 656e 6428 6269 6e63  vars.append(binc
-00073f60: 6f6c 290d 0a20 2020 2020 2020 2020 2020  ol)..           
-00073f70: 2069 6d70 6f72 7461 6e74 5f66 6561 7475   important_featu
-00073f80: 7265 732e 7265 6d6f 7665 2865 6163 685f  res.remove(each_
-00073f90: 6e75 6d29 0d0a 2020 2020 2020 2020 2020  num)..          
-00073fa0: 2020 2323 2323 2044 726f 7020 7468 6573    #### Drop thes
-00073fb0: 6520 6f72 6967 696e 616c 2063 6f6e 7469  e original conti
-00073fc0: 6e75 6f75 7320 7661 7269 6162 6c65 2066  nuous variable f
-00073fd0: 726f 6d20 6675 7274 6865 7220 636f 6e73  rom further cons
-00073fe0: 6964 6572 6174 696f 6e20 7468 6174 2773  ideration that's
-00073ff0: 2061 6c6c 2120 2323 230d 0a20 2020 2020   all! ###..     
-00074000: 2020 2020 2020 206e 756d 5f76 6172 732e         num_vars.
-00074010: 7265 6d6f 7665 2865 6163 685f 6e75 6d29  remove(each_num)
-00074020: 0d0a 2020 2020 2020 2020 2020 2020 6e65  ..            ne
-00074030: 775f 6269 6e63 6f6c 732e 6170 7065 6e64  w_bincols.append
-00074040: 2862 696e 636f 6c29 0d0a 2020 2020 2020  (bincol)..      
-00074050: 2020 6578 6365 7074 3a0d 0a20 2020 2020    except:..     
-00074060: 2020 2020 2020 2070 7269 6e74 2827 4572         print('Er
-00074070: 726f 7220 696e 2025 7320 6475 7269 6e67  ror in %s during
-00074080: 2045 6e74 726f 7079 2042 696e 6e69 6e67   Entropy Binning
-00074090: 2720 2565 6163 685f 6e75 6d29 0d0a 2020  ' %each_num)..  
-000740a0: 2020 7072 696e 7428 2720 2020 2053 656c    print('    Sel
-000740b0: 6563 7465 6420 616e 6420 6269 6e6e 6564  ected and binned
-000740c0: 206f 6e6c 7920 746f 7020 2573 2063 6f6e   only top %s con
-000740d0: 7469 6e75 6f75 7320 7661 7269 6162 6c65  tinuous variable
-000740e0: 732e 2720 2528 6c65 6e28 6e65 775f 6269  s.' %(len(new_bi
-000740f0: 6e63 6f6c 7329 2929 0d0a 2020 2020 6966  ncols)))..    if
-00074100: 2076 6572 626f 7365 2061 6e64 206c 656e   verbose and len
-00074110: 286e 6577 5f62 696e 636f 6c73 2920 3c3d  (new_bincols) <=
-00074120: 2033 303a 0d0a 2020 2020 2020 2020 7072   30:..        pr
-00074130: 696e 7428 2720 2020 2025 7327 2025 6e65  int('    %s' %ne
-00074140: 775f 6269 6e63 6f6c 7329 0d0a 2020 2020  w_bincols)..    
-00074150: 7265 7475 726e 2074 656d 705f 7472 6169  return temp_trai
-00074160: 6e2c 206e 756d 5f76 6172 732c 2069 6d70  n, num_vars, imp
-00074170: 6f72 7461 6e74 5f66 6561 7475 7265 732c  ortant_features,
-00074180: 2074 656d 705f 7465 7374 0d0a 2323 2323   temp_test..####
-00074190: 2323 2323 2323 2323 2323 2323 2323 2323  ################
-000741a0: 2323 2323 2323 2323 2323 2323 2323 2323  ################
-000741b0: 2323 2323 2323 2323 2323 2323 2323 2323  ################
-000741c0: 2323 2323 2323 2323 2323 2323 2323 2323  ################
-000741d0: 2323 2323 2323 2323 230d 0a66 726f 6d20  #########..from 
-000741e0: 736b 6c65 6172 6e2e 6261 7365 2069 6d70  sklearn.base imp
-000741f0: 6f72 7420 4261 7365 4573 7469 6d61 746f  ort BaseEstimato
-00074200: 722c 2043 6c61 7373 6966 6965 724d 6978  r, ClassifierMix
-00074210: 696e 2c20 5472 616e 7366 6f72 6d65 724d  in, TransformerM
-00074220: 6978 696e 0d0a 6672 6f6d 2069 6d62 6c65  ixin..from imble
-00074230: 6172 6e2e 6f76 6572 5f73 616d 706c 696e  arn.over_samplin
-00074240: 6720 696d 706f 7274 2053 4d4f 5445 2c20  g import SMOTE, 
-00074250: 5356 4d53 4d4f 5445 0d0a 6672 6f6d 2069  SVMSMOTE..from i
-00074260: 6d62 6c65 6172 6e2e 6f76 6572 5f73 616d  mblearn.over_sam
-00074270: 706c 696e 6720 696d 706f 7274 2041 4441  pling import ADA
-00074280: 5359 4e2c 2053 4d4f 5445 4e43 0d0a 6672  SYN, SMOTENC..fr
-00074290: 6f6d 2073 6b6c 6561 726e 2e63 6c75 7374  om sklearn.clust
-000742a0: 6572 2069 6d70 6f72 7420 4b4d 6561 6e73  er import KMeans
-000742b0: 0d0a 6465 6620 6b6d 6561 6e73 5f72 6573  ..def kmeans_res
-000742c0: 616d 706c 6572 2878 5f74 7261 696e 2c20  ampler(x_train, 
-000742d0: 795f 7472 6169 6e2c 2074 6172 6765 742c  y_train, target,
-000742e0: 2073 6d6f 7465 3d22 222c 2076 6572 626f   smote="", verbo
-000742f0: 7365 3d30 293a 0d0a 2020 2020 2222 220d  se=0):..    """.
-00074300: 0a20 2020 2054 6869 7320 6675 6e63 7469  .    This functi
-00074310: 6f6e 2063 6f6e 7665 7274 7320 6120 5265  on converts a Re
-00074320: 6772 6573 7369 6f6e 2070 726f 626c 656d  gression problem
-00074330: 2069 6e74 6f20 6120 436c 6173 7369 6669   into a Classifi
-00074340: 6361 7469 6f6e 2070 726f 626c 656d 2074  cation problem t
-00074350: 6f20 656e 6162 6c65 2053 4d4f 5445 210d  o enable SMOTE!.
-00074360: 0a20 2020 2049 7420 6973 2061 2076 6572  .    It is a ver
-00074370: 7920 7369 6d70 6c65 2077 6179 2074 6f20  y simple way to 
-00074380: 7365 6e64 2079 6f75 7220 785f 7472 6169  send your x_trai
-00074390: 6e2c 2079 5f74 7261 696e 2069 6e20 616e  n, y_train in an
-000743a0: 6420 6765 7420 6261 636b 2061 6e20 6f76  d get back an ov
-000743b0: 6572 7361 6d70 6c65 6420 785f 7472 6169  ersampled x_trai
-000743c0: 6e2c 2079 5f74 7261 696e 2e0d 0a20 2020  n, y_train...   
-000743d0: 2057 6879 2069 7320 7468 6973 206e 6565   Why is this nee
-000743e0: 6465 6420 696e 204d 6163 6869 6e65 204c  ded in Machine L
-000743f0: 6561 726e 696e 6720 7072 6f62 6c65 6d73  earning problems
-00074400: 3f0d 0a20 2020 2020 2020 2020 496e 2049  ?..         In I
-00074410: 6d62 616c 616e 6365 6420 6461 7461 7365  mbalanced datase
-00074420: 7473 2c20 6573 702e 2073 6b65 7765 6420  ts, esp. skewed 
-00074430: 7265 6772 6573 7369 6f6e 2070 726f 626c  regression probl
-00074440: 656d 7320 7768 6572 6520 7468 6520 7461  ems where the ta
-00074450: 7267 6574 2076 6172 6961 626c 6520 6973  rget variable is
-00074460: 2073 6b65 7765 642c 2074 6869 7320 6973   skewed, this is
-00074470: 206e 6565 6465 642e 0d0a 2020 2020 5472   needed...    Tr
-00074480: 7920 7468 6973 206f 6e20 796f 7572 2073  y this on your s
-00074490: 6b65 7765 6420 5265 6772 6573 7369 6f6e  kewed Regression
-000744a0: 2070 726f 626c 656d 7320 616e 6420 7365   problems and se
-000744b0: 6520 7768 6174 2072 6573 756c 7473 2079  e what results y
-000744c0: 6f75 2067 6574 2e20 4974 2073 686f 756c  ou get. It shoul
-000744d0: 6420 6265 2062 6574 7465 722e 0d0a 2020  d be better...  
-000744e0: 2020 2d2d 2d2d 2d2d 2d2d 2d2d 0d0a 2020    ----------..  
-000744f0: 2020 496e 7075 7473 0d0a 2020 2020 2d2d    Inputs..    --
-00074500: 2d2d 2d2d 2d2d 2d2d 0d0a 2020 2020 785f  --------..    x_
-00074510: 7472 6169 6e20 3a20 7061 6e64 6173 2064  train : pandas d
-00074520: 6174 6166 7261 6d65 3a20 796f 7520 6d75  ataframe: you mu
-00074530: 7374 2073 656e 6420 696e 2074 6865 2064  st send in the d
-00074540: 6174 6120 7769 7468 2070 7265 6469 6374  ata with predict
-00074550: 6f72 7320 6f6e 6c79 2e0d 0a20 2020 206d  ors only...    m
-00074560: 696e 5f6e 5f73 616d 706c 6573 203a 2069  in_n_samples : i
-00074570: 6e74 2c20 6465 6661 756c 743d 353a 206d  nt, default=5: m
-00074580: 696e 206e 756d 6265 7220 6f66 2073 616d  in number of sam
-00074590: 706c 6573 2062 656c 6f77 2077 6869 6368  ples below which
-000745a0: 2079 6f75 2063 6f6d 6269 6e65 2062 696e   you combine bin
-000745b0: 730d 0a20 2020 2062 696e 7320 3a20 696e  s..    bins : in
-000745c0: 742c 2064 6566 6175 6c74 3d33 3a20 686f  t, default=3: ho
-000745d0: 7720 6d61 6e79 2062 696e 7320 796f 7520  w many bins you 
-000745e0: 7761 6e74 2074 6f20 7370 6c69 7420 7461  want to split ta
-000745f0: 7267 6574 2069 6e74 6f0d 0a0d 0a20 2020  rget into....   
-00074600: 204f 7574 7075 7473 0d0a 2020 2020 2d2d   Outputs..    --
-00074610: 2d2d 2d2d 2d2d 2d2d 0d0a 2020 2020 6e5f  --------..    n_
-00074620: 6665 6174 7572 6573 5f20 3a20 696e 740d  features_ : int.
-00074630: 0a20 2020 2020 2020 2054 6865 206e 756d  .        The num
-00074640: 6265 7220 6f66 2066 6561 7475 7265 7320  ber of features 
-00074650: 6f66 2074 6865 2064 6174 6120 7061 7373  of the data pass
-00074660: 6564 2074 6f20 3a6d 6574 683a 6066 6974  ed to :meth:`fit
-00074670: 602e 0d0a 2020 2020 2222 220d 0a20 2020  `...    """..   
-00074680: 2078 5f74 7261 696e 5f63 203d 2063 6f70   x_train_c = cop
-00074690: 792e 6465 6570 636f 7079 2878 5f74 7261  y.deepcopy(x_tra
-000746a0: 696e 290d 0a20 2020 2078 5f74 7261 696e  in)..    x_train
-000746b0: 5f63 5b74 6172 6765 745d 203d 2079 5f74  _c[target] = y_t
-000746c0: 7261 696e 2e76 616c 7565 730d 0a0d 0a20  rain.values.... 
-000746d0: 2020 2023 2052 6567 7265 7373 696f 6e20     # Regression 
-000746e0: 7072 6f62 6c65 6d20 7475 726e 6564 2069  problem turned i
-000746f0: 6e74 6f20 436c 6173 7369 6669 6361 7469  nto Classificati
-00074700: 6f6e 2070 726f 626c 656d 0d0a 2020 2020  on problem..    
-00074710: 6e5f 636c 7573 7465 7273 203d 206d 6178  n_clusters = max
-00074720: 2833 2c20 696e 7428 6e70 2e6c 6f67 3130  (3, int(np.log10
-00074730: 286c 656e 2879 5f74 7261 696e 2929 2920  (len(y_train))) 
-00074740: 2b20 3129 0d0a 2020 2020 2320 5573 6520  + 1)..    # Use 
-00074750: 4b4d 6561 6e73 2074 6f20 6669 6e64 206e  KMeans to find n
-00074760: 6174 7572 616c 2063 6c75 7374 6572 7320  atural clusters 
-00074770: 696e 2079 6f75 7220 6461 7461 0d0a 2020  in your data..  
-00074780: 2020 6b6d 5f6d 6f64 656c 203d 204b 4d65    km_model = KMe
-00074790: 616e 7328 6e5f 636c 7573 7465 7273 3d6e  ans(n_clusters=n
-000747a0: 5f63 6c75 7374 6572 732c 0d0a 2020 2020  _clusters,..    
-000747b0: 2020 2020 2020 2020 2020 2020 2020 2020                  
-000747c0: 2020 6e5f 696e 6974 3d35 2c0d 0a20 2020    n_init=5,..   
-000747d0: 2020 2020 2020 2020 2020 2020 2020 2020                  
-000747e0: 2020 2072 616e 646f 6d5f 7374 6174 653d     random_state=
-000747f0: 3939 290d 0a20 2020 2023 2323 2320 7265  99)..    #### re
-00074800: 6d65 6d62 6572 2079 6f75 206d 7573 7420  member you must 
-00074810: 7072 6564 6963 7420 7573 696e 6720 6f6e  predict using on
-00074820: 6c79 2070 7265 6469 6374 6f72 2076 6172  ly predictor var
-00074830: 6961 626c 6573 210d 0a20 2020 2079 5f74  iables!..    y_t
-00074840: 7261 696e 5f63 203d 206b 6d5f 6d6f 6465  rain_c = km_mode
-00074850: 6c2e 6669 745f 7072 6564 6963 7428 785f  l.fit_predict(x_
-00074860: 7472 6169 6e29 0d0a 0d0a 2020 2020 6966  train)....    if
-00074870: 2076 6572 626f 7365 203e 3d20 313a 0d0a   verbose >= 1:..
-00074880: 2020 2020 2020 2020 7072 696e 7428 2720          print(' 
-00074890: 2020 204e 756d 6265 7220 6f66 2063 6c75     Number of clu
-000748a0: 7374 6572 7320 6372 6561 7465 6420 3d20  sters created = 
-000748b0: 2564 2720 256e 5f63 6c75 7374 6572 7329  %d' %n_clusters)
-000748c0: 0d0a 0d0a 2020 2020 2323 2323 2047 656e  ....    #### Gen
-000748d0: 6572 6174 6520 7468 6520 6f76 6572 2d73  erate the over-s
-000748e0: 616d 706c 6564 2064 6174 610d 0a20 2020  ampled data..   
-000748f0: 2023 2323 2320 4144 4153 594e 202f 2053   #### ADASYN / S
-00074900: 4d4f 5445 206f 7665 7273 616d 706c 696e  MOTE oversamplin
-00074910: 6720 2323 2323 230d 0a20 2020 2069 6620  g #####..    if 
-00074920: 6973 696e 7374 616e 6365 2873 6d6f 7465  isinstance(smote
-00074930: 2c20 7374 7229 3a0d 0a20 2020 2020 2020  , str):..       
-00074940: 2078 5f74 7261 696e 5f65 7874 2c20 5f20   x_train_ext, _ 
-00074950: 3d20 6f76 6572 7361 6d70 6c65 5f53 4d4f  = oversample_SMO
-00074960: 5445 2878 5f74 7261 696e 5f63 2c20 795f  TE(x_train_c, y_
-00074970: 7472 6169 6e5f 6329 0d0a 2020 2020 656c  train_c)..    el
-00074980: 7365 3a0d 0a20 2020 2020 2020 2078 5f74  se:..        x_t
-00074990: 7261 696e 5f65 7874 2c20 5f20 3d20 736d  rain_ext, _ = sm
-000749a0: 6f74 652e 6669 745f 7265 7361 6d70 6c65  ote.fit_resample
-000749b0: 2878 5f74 7261 696e 5f63 2c20 795f 7472  (x_train_c, y_tr
-000749c0: 6169 6e5f 6329 0d0a 2020 2020 795f 7472  ain_c)..    y_tr
-000749d0: 6169 6e5f 6578 7420 3d20 785f 7472 6169  ain_ext = x_trai
-000749e0: 6e5f 6578 745b 7461 7267 6574 5d2e 7661  n_ext[target].va
-000749f0: 6c75 6573 0d0a 2020 2020 785f 7472 6169  lues..    x_trai
-00074a00: 6e5f 6578 742e 6472 6f70 2874 6172 6765  n_ext.drop(targe
-00074a10: 742c 2061 7869 733d 312c 2069 6e70 6c61  t, axis=1, inpla
-00074a20: 6365 3d54 7275 6529 0d0a 2020 2020 7265  ce=True)..    re
-00074a30: 7475 726e 2028 785f 7472 6169 6e5f 6578  turn (x_train_ex
-00074a40: 742c 2079 5f74 7261 696e 5f65 7874 290d  t, y_train_ext).
-00074a50: 0a0d 0a23 2323 2323 2323 2323 2323 2323  ...#############
-00074a60: 2323 2323 2323 2323 2323 2323 2323 2323  ################
-00074a70: 2323 2323 2323 2323 2323 2323 2323 2323  ################
-00074a80: 2323 2323 2323 2323 2323 2323 2323 2323  ################
-00074a90: 2323 2323 2323 2323 2323 2323 2323 2323  ################
-00074aa0: 2323 2323 230d 0a66 726f 6d20 736b 6c65  #####..from skle
-00074ab0: 6172 6e2e 7574 696c 732e 636c 6173 735f  arn.utils.class_
-00074ac0: 7765 6967 6874 2069 6d70 6f72 7420 636f  weight import co
-00074ad0: 6d70 7574 655f 636c 6173 735f 7765 6967  mpute_class_weig
-00074ae0: 6874 0d0a 6465 6620 6765 745f 636c 6173  ht..def get_clas
-00074af0: 735f 6469 7374 7269 6275 7469 6f6e 2879  s_distribution(y
-00074b00: 5f69 6e70 7574 293a 0d0a 2020 2020 795f  _input):..    y_
-00074b10: 696e 7075 7420 3d20 636f 7079 2e64 6565  input = copy.dee
-00074b20: 7063 6f70 7928 795f 696e 7075 7429 0d0a  pcopy(y_input)..
-00074b30: 2020 2020 636c 6173 7365 7320 3d20 6e70      classes = np
-00074b40: 2e75 6e69 7175 6528 795f 696e 7075 7429  .unique(y_input)
-00074b50: 0d0a 2020 2020 7870 203d 2043 6f75 6e74  ..    xp = Count
-00074b60: 6572 2879 5f69 6e70 7574 290d 0a20 2020  er(y_input)..   
-00074b70: 2063 6c61 7373 5f77 6569 6768 7473 203d   class_weights =
-00074b80: 2063 6f6d 7075 7465 5f63 6c61 7373 5f77   compute_class_w
-00074b90: 6569 6768 7428 2762 616c 616e 6365 6427  eight('balanced'
-00074ba0: 2c20 636c 6173 7365 733d 6e70 2e75 6e69  , classes=np.uni
-00074bb0: 7175 6528 795f 696e 7075 7429 2c20 793d  que(y_input), y=
-00074bc0: 795f 696e 7075 7429 0d0a 2020 2020 6966  y_input)..    if
-00074bd0: 206c 656e 2863 6c61 7373 5f77 6569 6768   len(class_weigh
-00074be0: 7473 5b28 636c 6173 735f 7765 6967 6874  ts[(class_weight
-00074bf0: 733e 2031 3029 5d29 203e 2030 3a0d 0a20  s> 10)]) > 0:.. 
-00074c00: 2020 2020 2020 2063 6c61 7373 5f77 6569         class_wei
-00074c10: 6768 7473 203d 2028 636c 6173 735f 7765  ghts = (class_we
-00074c20: 6967 6874 732f 3130 290d 0a20 2020 2065  ights/10)..    e
-00074c30: 6c73 653a 0d0a 2020 2020 2020 2020 636c  lse:..        cl
-00074c40: 6173 735f 7765 6967 6874 7320 3d20 2863  ass_weights = (c
-00074c50: 6c61 7373 5f77 6569 6768 7473 290d 0a20  lass_weights).. 
-00074c60: 2020 2070 7269 6e74 2827 2020 2020 636c     print('    cl
-00074c70: 6173 735f 7765 6967 6874 7320 3d20 2573  ass_weights = %s
-00074c80: 2720 2563 6c61 7373 5f77 6569 6768 7473  ' %class_weights
-00074c90: 290d 0a20 2020 2063 6c61 7373 5f77 6569  )..    class_wei
-00074ca0: 6768 7473 5b28 636c 6173 735f 7765 6967  ghts[(class_weig
-00074cb0: 6874 733c 3129 5d3d 310d 0a20 2020 2063  hts<1)]=1..    c
-00074cc0: 6c61 7373 5f72 6f77 7320 3d20 636c 6173  lass_rows = clas
-00074cd0: 735f 7765 6967 6874 732a 5b78 705b 785d  s_weights*[xp[x]
-00074ce0: 2066 6f72 2078 2069 6e20 636c 6173 7365   for x in classe
-00074cf0: 735d 0d0a 2020 2020 636c 6173 735f 726f  s]..    class_ro
-00074d00: 7773 203d 2063 6c61 7373 5f72 6f77 732e  ws = class_rows.
-00074d10: 6173 7479 7065 2869 6e74 290d 0a20 2020  astype(int)..   
-00074d20: 2063 6c61 7373 5f77 6569 6768 7465 645f   class_weighted_
-00074d30: 726f 7773 203d 2064 6963 7428 7a69 7028  rows = dict(zip(
-00074d40: 636c 6173 7365 732c 636c 6173 735f 726f  classes,class_ro
-00074d50: 7773 2929 0d0a 2020 2020 7072 696e 7428  ws))..    print(
-00074d60: 2720 2020 2063 6c61 7373 5f77 6569 6768  '    class_weigh
-00074d70: 7465 645f 726f 7773 203d 2025 7327 2025  ted_rows = %s' %
-00074d80: 636c 6173 735f 7765 6967 6874 6564 5f72  class_weighted_r
-00074d90: 6f77 7329 0d0a 2020 2020 7265 7475 726e  ows)..    return
-00074da0: 2063 6c61 7373 5f77 6569 6768 7465 645f   class_weighted_
-00074db0: 726f 7773 0d0a 0d0a 6465 6620 6f76 6572  rows....def over
-00074dc0: 7361 6d70 6c65 5f53 4d4f 5445 2858 2c79  sample_SMOTE(X,y
-00074dd0: 293a 0d0a 2020 2020 2369 6e70 7574 2044  ):..    #input D
-00074de0: 6174 6146 7261 6d65 0d0a 2020 2020 2358  ataFrame..    #X
-00074df0: 20e2 8692 496e 6465 7065 6e64 656e 7420   ...Independent 
-00074e00: 5661 7269 6162 6c65 2069 6e20 4461 7461  Variable in Data
-00074e10: 4672 616d 655c 0d0a 2020 2020 2379 20e2  Frame\..    #y .
-00074e20: 8692 6465 7065 6e64 656e 7420 5661 7269  ..dependent Vari
-00074e30: 6162 6c65 2069 6e20 5061 6e64 6173 2044  able in Pandas D
-00074e40: 6174 6146 7261 6d65 2066 6f72 6d61 740d  ataFrame format.
-00074e50: 0a20 2020 2023 2047 6574 2074 6865 2063  .    # Get the c
-00074e60: 6c61 7373 2064 6973 7472 6975 6274 696f  lass distriubtio
-00074e70: 6e20 666f 7220 7065 7266 6f6d 696e 6720  n for perfoming 
-00074e80: 7265 6c61 7469 7665 2073 616d 706c 696e  relative samplin
-00074e90: 6720 696e 2074 6865 206e 6578 7420 6c69  g in the next li
-00074ea0: 6e65 0d0a 2020 2020 636c 6173 735f 7765  ne..    class_we
-00074eb0: 6967 6874 6564 5f72 6f77 7320 3d20 6765  ighted_rows = ge
-00074ec0: 745f 636c 6173 735f 6469 7374 7269 6275  t_class_distribu
-00074ed0: 7469 6f6e 2879 290d 0a20 2020 2073 6d6f  tion(y)..    smo
-00074ee0: 7465 203d 2053 564d 534d 4f54 4528 2072  te = SVMSMOTE( r
-00074ef0: 616e 646f 6d5f 7374 6174 653d 3237 2c0d  andom_state=27,.
-00074f00: 0a20 2020 2020 2020 2020 2020 2020 2020  .               
-00074f10: 2020 2073 616d 706c 696e 675f 7374 7261     sampling_stra
-00074f20: 7465 6779 3d63 6c61 7373 5f77 6569 6768  tegy=class_weigh
-00074f30: 7465 645f 726f 7773 290d 0a20 2020 2058  ted_rows)..    X
-00074f40: 2c20 7920 3d20 736d 6f74 652e 6669 745f  , y = smote.fit_
-00074f50: 7265 7361 6d70 6c65 2858 2c20 7929 0d0a  resample(X, y)..
-00074f60: 2020 2020 7265 7475 726e 2858 2c79 290d      return(X,y).
-00074f70: 0a0d 0a64 6566 206f 7665 7273 616d 706c  ...def oversampl
-00074f80: 655f 4144 4153 594e 2858 2c79 293a 0d0a  e_ADASYN(X,y):..
-00074f90: 2020 2020 2369 6e70 7574 2044 6174 6146      #input DataF
-00074fa0: 7261 6d65 0d0a 2020 2020 2358 20e2 8692  rame..    #X ...
-00074fb0: 496e 6465 7065 6e64 656e 7420 5661 7269  Independent Vari
-00074fc0: 6162 6c65 2069 6e20 4461 7461 4672 616d  able in DataFram
-00074fd0: 655c 0d0a 2020 2020 2379 20e2 8692 6465  e\..    #y ...de
-00074fe0: 7065 6e64 656e 7420 5661 7269 6162 6c65  pendent Variable
-00074ff0: 2069 6e20 5061 6e64 6173 2044 6174 6146   in Pandas DataF
-00075000: 7261 6d65 2066 6f72 6d61 740d 0a20 2020  rame format..   
-00075010: 2023 2047 6574 2074 6865 2063 6c61 7373   # Get the class
-00075020: 2064 6973 7472 6975 6274 696f 6e20 666f   distriubtion fo
-00075030: 7220 7065 7266 6f6d 696e 6720 7265 6c61  r perfoming rela
-00075040: 7469 7665 2073 616d 706c 696e 6720 696e  tive sampling in
-00075050: 2074 6865 206e 6578 7420 6c69 6e65 0d0a   the next line..
-00075060: 2020 2020 636c 6173 735f 7765 6967 6874      class_weight
-00075070: 6564 5f72 6f77 7320 3d20 6765 745f 636c  ed_rows = get_cl
-00075080: 6173 735f 6469 7374 7269 6275 7469 6f6e  ass_distribution
-00075090: 2879 290d 0a20 2020 2023 2059 6f75 7220  (y)..    # Your 
-000750a0: 6661 766f 7572 6974 6520 6f76 6572 7361  favourite oversa
-000750b0: 6d70 6c65 720d 0a20 2020 2073 6d6f 7465  mpler..    smote
-000750c0: 203d 2041 4441 5359 4e28 7261 6e64 6f6d   = ADASYN(random
-000750d0: 5f73 7461 7465 3d32 372c 0d0a 2020 2020  _state=27,..    
-000750e0: 2020 2020 2020 2020 2020 2020 2020 2073                 s
-000750f0: 616d 706c 696e 675f 7374 7261 7465 6779  ampling_strategy
-00075100: 3d63 6c61 7373 5f77 6569 6768 7465 645f  =class_weighted_
-00075110: 726f 7773 290d 0a20 2020 2058 2c20 7920  rows)..    X, y 
-00075120: 3d20 736d 6f74 652e 6669 745f 7265 7361  = smote.fit_resa
-00075130: 6d70 6c65 2858 2c20 7929 0d0a 2020 2020  mple(X, y)..    
-00075140: 7265 7475 726e 2858 2c79 290d 0a23 2323  return(X,y)..###
-00075150: 2323 2323 2323 2323 2323 2323 2323 2323  ################
-00075160: 2323 2323 2323 2323 2323 2323 2323 2323  ################
-00075170: 2323 2323 2323 2323 2323 2323 2323 2323  ################
-00075180: 2323 2323 2323 2323 2323 2323 2323 2323  ################
-00075190: 2323 2323 2323 2323 2323 2323 2323 2323  ################
-000751a0: 2323 2323 2323 2323 0d0a 6465 6620 6d61  ########..def ma
-000751b0: 7274 6861 735f 636f 6c75 6d6e 7328 6461  rthas_columns(da
-000751c0: 7461 2c76 6572 626f 7365 3d30 293a 0d0a  ta,verbose=0):..
-000751d0: 2020 2020 2222 220d 0a20 2020 2054 6869      """..    Thi
-000751e0: 7320 7072 6f67 7261 6d20 6973 206e 616d  s program is nam
-000751f0: 6564 2020 696e 2068 6f6e 6f72 206f 6620  ed  in honor of 
-00075200: 6d79 206f 6e65 206f 6620 7374 7564 656e  my one of studen
-00075210: 7473 2c20 4d61 7274 6861 2c20 7768 6f20  ts, Martha, who 
-00075220: 6361 6d65 2075 7020 7769 7468 2074 6865  came up with the
-00075230: 2069 6465 6120 666f 7220 6974 2e0d 0a20   idea for it... 
-00075240: 2020 2049 7427 7320 6120 6e65 6174 2077     It's a neat w
-00075250: 6179 206f 6620 7072 696e 7469 6e67 2064  ay of printing d
-00075260: 6174 6120 7479 7065 7320 616e 6420 696e  ata types and in
-00075270: 666f 726d 6174 696f 6e20 636f 6d70 6172  formation compar
-00075280: 6564 2074 6f20 7468 6520 626f 7269 6e67  ed to the boring
-00075290: 2064 6573 6372 6962 6528 2920 6675 6e63   describe() func
-000752a0: 7469 6f6e 2069 6e20 5061 6e64 6173 2e0d  tion in Pandas..
-000752b0: 0a20 2020 2022 2222 0d0a 2020 2020 6461  .    """..    da
-000752c0: 7461 203d 2064 6174 615b 3a5d 0d0a 2020  ta = data[:]..  
-000752d0: 2020 7072 696e 7428 2744 6174 6120 5365    print('Data Se
-000752e0: 7420 5368 6170 653a 2025 6420 726f 7773  t Shape: %d rows
-000752f0: 2c20 2564 2063 6f6c 7327 2025 2064 6174  , %d cols' % dat
-00075300: 612e 7368 6170 6529 0d0a 2020 2020 6966  a.shape)..    if
-00075310: 2064 6174 612e 7368 6170 655b 315d 203e   data.shape[1] >
-00075320: 2033 303a 0d0a 2020 2020 2020 2020 7072   30:..        pr
-00075330: 696e 7428 2754 6f6f 206d 616e 7920 636f  int('Too many co
-00075340: 6c75 6d6e 7320 746f 2070 7269 6e74 2729  lumns to print')
-00075350: 0d0a 2020 2020 656c 7365 3a0d 0a20 2020  ..    else:..   
-00075360: 2020 2020 2069 6620 7665 7262 6f73 653d       if verbose=
-00075370: 3d31 3a0d 0a20 2020 2020 2020 2020 2020  =1:..           
-00075380: 2070 7269 6e74 2827 2020 2020 4164 6469   print('    Addi
-00075390: 7469 6f6e 616c 2064 6574 6169 6c73 206f  tional details o
-000753a0: 6e20 636f 6c75 6d6e 733a 2729 0d0a 2020  n columns:')..  
-000753b0: 2020 2020 2020 2020 2020 666f 7220 636f            for co
-000753c0: 6c20 696e 2064 6174 612e 636f 6c75 6d6e  l in data.column
-000753d0: 733a 0d0a 2020 2020 2020 2020 2020 2020  s:..            
-000753e0: 2020 2020 7072 696e 7428 275c 742a 2025      print('\t* %
-000753f0: 733a 5c74 2564 206d 6973 7369 6e67 2c20  s:\t%d missing, 
-00075400: 2564 2075 6e69 7175 6573 2c20 6d6f 7374  %d uniques, most
-00075410: 2063 6f6d 6d6f 6e3a 2025 7327 2025 2028   common: %s' % (
-00075420: 0d0a 2020 2020 2020 2020 2020 2020 2020  ..              
-00075430: 2020 2020 2020 2020 2020 636f 6c2c 0d0a            col,..
-00075440: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00075450: 2020 2020 2020 2020 6461 7461 5b63 6f6c          data[col
-00075460: 5d2e 6973 6e75 6c6c 2829 2e73 756d 2829  ].isnull().sum()
-00075470: 2c0d 0a20 2020 2020 2020 2020 2020 2020  ,..             
-00075480: 2020 2020 2020 2020 2020 2064 6174 615b             data[
-00075490: 636f 6c5d 2e6e 756e 6971 7565 2829 2c0d  col].nunique(),.
-000754a0: 0a20 2020 2020 2020 2020 2020 2020 2020  .               
-000754b0: 2020 2020 2020 2020 2064 6174 615b 636f           data[co
-000754c0: 6c5d 2e76 616c 7565 5f63 6f75 6e74 7328  l].value_counts(
-000754d0: 292e 6865 6164 2832 292e 746f 5f64 6963  ).head(2).to_dic
-000754e0: 7428 290d 0a20 2020 2020 2020 2020 2020  t()..           
-000754f0: 2020 2020 2020 2020 2029 290d 0a20 2020           ))..   
-00075500: 2020 2020 2020 2020 2070 7269 6e74 2827           print('
-00075510: 2d2d 2d2d 2d2d 2d2d 2d2d 2d2d 2d2d 2d2d  ----------------
-00075520: 2d2d 2d2d 2d2d 2d2d 2d2d 2d2d 2d2d 2d2d  ----------------
-00075530: 2d2d 2d2d 2d2d 2d2d 2d2d 2d2d 2d2d 2d2d  ----------------
-00075540: 2d2d 2d2d 2d2d 2d2d 2d2d 2d2d 2d2d 2d2d  ----------------
-00075550: 2d2d 2d2d 2729 0d0a 2323 2323 2323 2323  ----')..########
-00075560: 2323 2323 2323 2323 2323 2323 2323 2323  ################
-00075570: 2323 2323 2323 2323 2323 2323 2323 2323  ################
-00075580: 2323 2323 2323 2323 2323 2323 2323 2323  ################
-00075590: 2323 2323 2323 2323 2323 2323 2323 2323  ################
-000755a0: 2323 2323 2323 2323 2323 0d0a 6465 6620  ##########..def 
-000755b0: 6765 745f 7369 7a65 2862 7974 6573 2c20  get_size(bytes, 
-000755c0: 7375 6666 6978 3d22 4222 293a 0d0a 2020  suffix="B"):..  
-000755d0: 2020 2222 220d 0a20 2020 2053 6361 6c65    """..    Scale
-000755e0: 2062 7974 6573 2074 6f20 6974 7320 7072   bytes to its pr
-000755f0: 6f70 6572 2066 6f72 6d61 740d 0a20 2020  oper format..   
-00075600: 2065 2e67 3a0d 0a20 2020 2020 2020 2031   e.g:..        1
-00075610: 3235 3336 3536 203d 3e20 2731 2e32 304d  253656 => '1.20M
-00075620: 4227 0d0a 2020 2020 2020 2020 3132 3533  B'..        1253
-00075630: 3635 3636 3738 203d 3e20 2731 2e31 3747  656678 => '1.17G
-00075640: 4227 0d0a 2020 2020 2222 220d 0a20 2020  B'..    """..   
-00075650: 2066 6163 746f 7220 3d20 3130 3234 0d0a   factor = 1024..
-00075660: 2020 2020 666f 7220 756e 6974 2069 6e20      for unit in 
-00075670: 5b22 222c 2022 4b22 2c20 224d 222c 2022  ["", "K", "M", "
-00075680: 4722 2c20 2254 222c 2022 5022 5d3a 0d0a  G", "T", "P"]:..
-00075690: 2020 2020 2020 2020 6966 2062 7974 6573          if bytes
-000756a0: 203c 2066 6163 746f 723a 0d0a 2020 2020   < factor:..    
-000756b0: 2020 2020 2020 2020 7265 7475 726e 2066          return f
-000756c0: 227b 6279 7465 733a 2e32 667d 7b75 6e69  "{bytes:.2f}{uni
-000756d0: 747d 7b73 7566 6669 787d 220d 0a20 2020  t}{suffix}"..   
-000756e0: 2020 2020 2062 7974 6573 202f 3d20 6661       bytes /= fa
-000756f0: 6374 6f72 0d0a 0d0a 6465 6620 7072 696e  ctor....def prin
-00075700: 745f 7379 7374 656d 5f69 6e66 6f28 293a  t_system_info():
-00075710: 0d0a 2020 2020 2222 220d 0a20 2020 2054  ..    """..    T
-00075720: 6869 7320 7072 696e 7473 2074 6865 2069  his prints the i
-00075730: 6e66 6f72 6d61 7469 6f6e 206f 6e20 7468  nformation on th
-00075740: 6520 6861 7264 7761 7265 2072 756e 6e69  e hardware runni
-00075750: 6e67 2074 6865 2050 7974 686f 6e20 636f  ng the Python co
-00075760: 6465 200d 0a20 2020 204d 616e 7920 7468  de ..    Many th
-00075770: 616e 6b73 2074 6f3a 2068 7474 7073 3a2f  anks to: https:/
-00075780: 2f77 7777 2e74 6865 7079 7468 6f6e 636f  /www.thepythonco
-00075790: 6465 2e63 6f6d 2f61 7274 6963 6c65 2f67  de.com/article/g
-000757a0: 6574 2d68 6172 6477 6172 652d 7379 7374  et-hardware-syst
-000757b0: 656d 2d69 6e66 6f72 6d61 7469 6f6e 2d70  em-information-p
-000757c0: 7974 686f 6e0d 0a20 2020 2022 2222 0d0a  ython..    """..
-000757d0: 2020 2020 696d 706f 7274 2070 7375 7469      import psuti
-000757e0: 6c0d 0a20 2020 2069 6d70 6f72 7420 706c  l..    import pl
-000757f0: 6174 666f 726d 0d0a 2020 2020 7072 696e  atform..    prin
-00075800: 7428 223d 222a 3230 2c20 2253 7973 7465  t("="*20, "Syste
-00075810: 6d20 496e 666f 726d 6174 696f 6e22 2c20  m Information", 
-00075820: 223d 222a 3230 290d 0a20 2020 2075 6e61  "="*20)..    una
-00075830: 6d65 203d 2070 6c61 7466 6f72 6d2e 756e  me = platform.un
-00075840: 616d 6528 290d 0a20 2020 2070 7269 6e74  ame()..    print
-00075850: 2866 2253 7973 7465 6d3a 207b 756e 616d  (f"System: {unam
-00075860: 652e 7379 7374 656d 7d22 290d 0a20 2020  e.system}")..   
-00075870: 2070 7269 6e74 2866 224e 6f64 6520 4e61   print(f"Node Na
-00075880: 6d65 3a20 7b75 6e61 6d65 2e6e 6f64 657d  me: {uname.node}
-00075890: 2229 0d0a 2020 2020 7072 696e 7428 6622  ")..    print(f"
-000758a0: 5265 6c65 6173 653a 207b 756e 616d 652e  Release: {uname.
-000758b0: 7265 6c65 6173 657d 2229 0d0a 2020 2020  release}")..    
-000758c0: 7072 696e 7428 6622 5665 7273 696f 6e3a  print(f"Version:
-000758d0: 207b 756e 616d 652e 7665 7273 696f 6e7d   {uname.version}
-000758e0: 2229 0d0a 2020 2020 7072 696e 7428 6622  ")..    print(f"
-000758f0: 4d61 6368 696e 653a 207b 756e 616d 652e  Machine: {uname.
-00075900: 6d61 6368 696e 657d 2229 0d0a 2020 2020  machine}")..    
-00075910: 7072 696e 7428 6622 5072 6f63 6573 736f  print(f"Processo
-00075920: 723a 207b 756e 616d 652e 7072 6f63 6573  r: {uname.proces
-00075930: 736f 727d 2229 0d0a 2020 2020 7072 696e  sor}")..    prin
-00075940: 7428 223d 222a 3232 2c20 2243 5055 2049  t("="*22, "CPU I
-00075950: 6e66 6f72 6d61 7469 6f6e 222c 2022 3d22  nformation", "="
-00075960: 2a32 3229 0d0a 2020 2020 2320 6e75 6d62  *22)..    # numb
-00075970: 6572 206f 6620 636f 7265 730d 0a20 2020  er of cores..   
-00075980: 2070 7269 6e74 2822 5068 7973 6963 616c   print("Physical
-00075990: 2063 6f72 6573 3a22 2c20 7073 7574 696c   cores:", psutil
-000759a0: 2e63 7075 5f63 6f75 6e74 286c 6f67 6963  .cpu_count(logic
-000759b0: 616c 3d46 616c 7365 2929 0d0a 2020 2020  al=False))..    
-000759c0: 7072 696e 7428 2254 6f74 616c 2063 6f72  print("Total cor
-000759d0: 6573 3a22 2c20 7073 7574 696c 2e63 7075  es:", psutil.cpu
-000759e0: 5f63 6f75 6e74 286c 6f67 6963 616c 3d54  _count(logical=T
-000759f0: 7275 6529 290d 0a20 2020 2070 7269 6e74  rue))..    print
-00075a00: 2822 3d22 2a32 302c 2022 4d65 6d6f 7279  ("="*20, "Memory
-00075a10: 2049 6e66 6f72 6d61 7469 6f6e 222c 2022   Information", "
-00075a20: 3d22 2a32 3029 0d0a 2020 2020 2320 6765  ="*20)..    # ge
-00075a30: 7420 7468 6520 6d65 6d6f 7279 2064 6574  t the memory det
-00075a40: 6169 6c73 0d0a 2020 2020 7376 6d65 6d20  ails..    svmem 
-00075a50: 3d20 7073 7574 696c 2e76 6972 7475 616c  = psutil.virtual
-00075a60: 5f6d 656d 6f72 7928 290d 0a20 2020 2070  _memory()..    p
-00075a70: 7269 6e74 2866 2254 6f74 616c 3a20 7b67  rint(f"Total: {g
-00075a80: 6574 5f73 697a 6528 7376 6d65 6d2e 746f  et_size(svmem.to
-00075a90: 7461 6c29 7d22 290d 0a20 2020 2070 7269  tal)}")..    pri
-00075aa0: 6e74 2866 2241 7661 696c 6162 6c65 3a20  nt(f"Available: 
-00075ab0: 7b67 6574 5f73 697a 6528 7376 6d65 6d2e  {get_size(svmem.
-00075ac0: 6176 6169 6c61 626c 6529 7d22 290d 0a20  available)}").. 
-00075ad0: 2020 2070 7269 6e74 2866 2255 7365 643a     print(f"Used:
-00075ae0: 207b 6765 745f 7369 7a65 2873 766d 656d   {get_size(svmem
-00075af0: 2e75 7365 6429 7d22 290d 0a20 2020 2070  .used)}")..    p
-00075b00: 7269 6e74 2822 3d22 2a31 382c 2022 5379  rint("="*18, "Sy
-00075b10: 7374 656d 2049 6e66 6f72 6d61 7469 6f6e  stem Information
-00075b20: 2045 6e64 222c 2022 3d22 2a31 3829 0d0a   End", "="*18)..
-00075b30: 2323 2323 2323 2323 2323 2323 2323 2323  ################
-00075b40: 2323 2323 2323 2323 2323 2323 2323 2323  ################
-00075b50: 2323 2323 2323 2323 2323 2323 2323 2323  ################
-00075b60: 2323 2323 2323 2323 2323 2323 2323 2323  ################
-00075b70: 2323 2323 2323 2323 2323 2323 2323 2323  ################
-00075b80: 2323 2323 2300 0000 0000 0000 0000 0000  #####...........
-00075b90: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-00075ba0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-00075bb0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-00075bc0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-00075bd0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-00075be0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-00075bf0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-00075c00: 2e2f 2e2f 4050 6178 4865 6164 6572 0000  ././@PaxHeader..
-00075c10: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-00075c20: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-00075c30: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-00075c40: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-00075c50: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-00075c60: 0000 0000 3030 3030 3030 3000 3030 3030  ....0000000.0000
-00075c70: 3030 3000 3030 3030 3030 3000 3030 3030  000.0000000.0000
-00075c80: 3030 3030 3032 3600 3030 3030 3030 3030  0000026.00000000
-00075c90: 3030 3000 3031 3134 3533 0020 7800 0000  000.011453. x...
-00075ca0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-00075cb0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-00075cc0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-00075cd0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-00075ce0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-00075cf0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-00075d00: 0075 7374 6172 0030 3000 0000 0000 0000  .ustar.00.......
-00075d10: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-00075d20: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-00075d30: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-00075d40: 0000 0000 0000 0000 0030 3030 3030 3030  .........0000000
-00075d50: 0030 3030 3030 3030 0000 0000 0000 0000  .0000000........
-00075d60: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-00075d70: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-00075d80: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-00075d90: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-00075da0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-00075db0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-00075dc0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-00075dd0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-00075de0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-00075df0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-00075e00: 3232 206d 7469 6d65 3d31 3637 3831 3539  22 mtime=1678159
-00075e10: 3732 322e 300a 0000 0000 0000 0000 0000  722.0...........
-00075e20: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-00075e30: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-00075e40: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-00075e50: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-00075e60: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-00075e70: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-00075e80: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-00075e90: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-00075ea0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-00075eb0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-00075ec0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-00075ed0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-00075ee0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-00075ef0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-00075f00: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-00075f10: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-00075f20: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-00075f30: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-00075f40: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-00075f50: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-00075f60: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-00075f70: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-00075f80: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-00075f90: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-00075fa0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-00075fb0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-00075fc0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-00075fd0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-00075fe0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-00075ff0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-00076000: 6175 746f 7669 6d6c 2d30 2e31 2e37 3134  autoviml-0.1.714
-00076010: 2f61 7574 6f76 696d 6c2f 5175 6963 6b4d  /autoviml/QuickM
-00076020: 4c5f 456e 7365 6d62 6c69 6e67 2e70 7900  L_Ensembling.py.
-00076030: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-00076040: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-00076050: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-00076060: 0000 0000 3030 3030 3737 3700 3030 3031  ....0000777.0001
-00076070: 3735 3000 3030 3031 3735 3000 3030 3030  750.0001750.0000
-00076080: 3030 3332 3634 3400 3030 3030 3030 3030  0032644.00000000
-00076090: 3030 3000 3032 3130 3037 0020 3000 0000  000.021007. 0...
-000760a0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-000760b0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-000760c0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-000760d0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-000760e0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-000760f0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-00076100: 0075 7374 6172 0030 3072 616d 0000 0000  .ustar.00ram....
-00076110: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-00076120: 0000 0000 0000 0000 0072 616d 0000 0000  .........ram....
-00076130: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-00076140: 0000 0000 0000 0000 0030 3030 3030 3030  .........0000000
-00076150: 0030 3030 3030 3030 0000 0000 0000 0000  .0000000........
-00076160: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-00076170: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-00076180: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-00076190: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-000761a0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-000761b0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-000761c0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-000761d0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-000761e0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-000761f0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-00076200: 696d 706f 7274 2070 616e 6461 7320 6173  import pandas as
-00076210: 2070 640d 0a69 6d70 6f72 7420 6e75 6d70   pd..import nump
-00076220: 7920 6173 206e 700d 0a69 6d70 6f72 7420  y as np..import 
-00076230: 6d61 7470 6c6f 746c 6962 2e70 7970 6c6f  matplotlib.pyplo
-00076240: 7420 6173 2070 6c74 0d0a 6765 745f 6970  t as plt..get_ip
-00076250: 7974 686f 6e28 292e 6d61 6769 6328 276d  ython().magic('m
-00076260: 6174 706c 6f74 6c69 6220 696e 6c69 6e65  atplotlib inline
-00076270: 2729 0d0a 696d 706f 7274 2073 6561 626f  ')..import seabo
-00076280: 726e 2061 7320 736e 730d 0a73 6e73 2e73  rn as sns..sns.s
-00076290: 6574 2873 7479 6c65 3d22 7768 6974 6522  et(style="white"
-000762a0: 2c20 636f 6c6f 725f 636f 6465 733d 5472  , color_codes=Tr
-000762b0: 7565 290d 0a69 6d70 6f72 7420 7761 726e  ue)..import warn
-000762c0: 696e 6773 0d0a 7761 726e 696e 6773 2e66  ings..warnings.f
-000762d0: 696c 7465 7277 6172 6e69 6e67 7328 2269  ilterwarnings("i
-000762e0: 676e 6f72 6522 290d 0a66 726f 6d20 736b  gnore")..from sk
-000762f0: 6c65 6172 6e2e 6d6f 6465 6c5f 7365 6c65  learn.model_sele
-00076300: 6374 696f 6e20 696d 706f 7274 2063 726f  ction import cro
-00076310: 7373 5f76 616c 5f73 636f 7265 2c20 5374  ss_val_score, St
-00076320: 7261 7469 6669 6564 5368 7566 666c 6553  ratifiedShuffleS
-00076330: 706c 6974 2c20 5469 6d65 5365 7269 6573  plit, TimeSeries
-00076340: 5370 6c69 740d 0a66 726f 6d20 736b 6c65  Split..from skle
-00076350: 6172 6e2e 7376 6d20 696d 706f 7274 204c  arn.svm import L
-00076360: 696e 6561 7253 5643 2c20 4c69 6e65 6172  inearSVC, Linear
-00076370: 5356 520d 0a66 726f 6d20 736b 6c65 6172  SVR..from sklear
-00076380: 6e2e 6c69 6e65 6172 5f6d 6f64 656c 2069  n.linear_model i
-00076390: 6d70 6f72 7420 5347 4452 6567 7265 7373  mport SGDRegress
-000763a0: 6f72 2c20 5347 4443 6c61 7373 6966 6965  or, SGDClassifie
-000763b0: 720d 0a66 726f 6d20 736b 6c65 6172 6e2e  r..from sklearn.
-000763c0: 6d6f 6465 6c5f 7365 6c65 6374 696f 6e20  model_selection 
-000763d0: 696d 706f 7274 2063 726f 7373 5f76 616c  import cross_val
-000763e0: 5f73 636f 7265 2c20 5374 7261 7469 6669  _score, Stratifi
-000763f0: 6564 5368 7566 666c 6553 706c 6974 2c20  edShuffleSplit, 
-00076400: 5469 6d65 5365 7269 6573 5370 6c69 740d  TimeSeriesSplit.
-00076410: 0a66 726f 6d20 736b 6c65 6172 6e2e 6d6f  .from sklearn.mo
-00076420: 6465 6c5f 7365 6c65 6374 696f 6e20 696d  del_selection im
-00076430: 706f 7274 2053 6875 6666 6c65 5370 6c69  port ShuffleSpli
-00076440: 742c 5374 7261 7469 6669 6564 4b46 6f6c  t,StratifiedKFol
-00076450: 642c 4b46 6f6c 640d 0a66 726f 6d20 736b  d,KFold..from sk
-00076460: 6c65 6172 6e2e 6469 7363 7269 6d69 6e61  learn.discrimina
-00076470: 6e74 5f61 6e61 6c79 7369 7320 696d 706f  nt_analysis impo
-00076480: 7274 204c 696e 6561 7244 6973 6372 696d  rt LinearDiscrim
-00076490: 696e 616e 7441 6e61 6c79 7369 730d 0a66  inantAnalysis..f
-000764a0: 726f 6d20 736b 6c65 6172 6e2e 656e 7365  rom sklearn.ense
-000764b0: 6d62 6c65 2069 6d70 6f72 7420 4261 6767  mble import Bagg
-000764c0: 696e 6752 6567 7265 7373 6f72 2c20 5261  ingRegressor, Ra
-000764d0: 6e64 6f6d 466f 7265 7374 436c 6173 7369  ndomForestClassi
-000764e0: 6669 6572 2c20 5261 6e64 6f6d 466f 7265  fier, RandomFore
-000764f0: 7374 5265 6772 6573 736f 720d 0a66 726f  stRegressor..fro
-00076500: 6d20 736b 6c65 6172 6e2e 656e 7365 6d62  m sklearn.ensemb
-00076510: 6c65 2069 6d70 6f72 7420 4578 7472 6154  le import ExtraT
-00076520: 7265 6573 436c 6173 7369 6669 6572 2c45  reesClassifier,E
-00076530: 7874 7261 5472 6565 7352 6567 7265 7373  xtraTreesRegress
-00076540: 6f72 0d0a 6672 6f6d 2073 6b6c 6561 726e  or..from sklearn
-00076550: 2e6c 696e 6561 725f 6d6f 6465 6c20 696d  .linear_model im
-00076560: 706f 7274 204c 6f67 6973 7469 6352 6567  port LogisticReg
-00076570: 7265 7373 696f 6e43 562c 204c 696e 6561  ressionCV, Linea
-00076580: 7252 6567 7265 7373 696f 6e2c 2052 6964  rRegression, Rid
-00076590: 6765 0d0a 6672 6f6d 2073 6b6c 6561 726e  ge..from sklearn
-000765a0: 2e73 766d 2069 6d70 6f72 7420 4c69 6e65  .svm import Line
-000765b0: 6172 5356 432c 2053 5652 2c20 4c69 6e65  arSVC, SVR, Line
-000765c0: 6172 5356 520d 0a66 726f 6d20 736b 6c65  arSVR..from skle
-000765d0: 6172 6e2e 656e 7365 6d62 6c65 2069 6d70  arn.ensemble imp
-000765e0: 6f72 7420 4164 6142 6f6f 7374 436c 6173  ort AdaBoostClas
-000765f0: 7369 6669 6572 2c20 4164 6142 6f6f 7374  sifier, AdaBoost
-00076600: 5265 6772 6573 736f 720d 0a66 726f 6d20  Regressor..from 
-00076610: 736b 6c65 6172 6e2e 7472 6565 2069 6d70  sklearn.tree imp
-00076620: 6f72 7420 4465 6369 7369 6f6e 5472 6565  ort DecisionTree
-00076630: 5265 6772 6573 736f 722c 2044 6563 6973  Regressor, Decis
-00076640: 696f 6e54 7265 6543 6c61 7373 6966 6965  ionTreeClassifie
-00076650: 720d 0a66 726f 6d20 736b 6c65 6172 6e2e  r..from sklearn.
-00076660: 6c69 6e65 6172 5f6d 6f64 656c 2069 6d70  linear_model imp
-00076670: 6f72 7420 4c61 7373 6f2c 204c 6173 736f  ort Lasso, Lasso
-00076680: 4356 2c20 5269 6467 652c 2052 6964 6765  CV, Ridge, Ridge
-00076690: 4356 2c20 4c61 7373 6f4c 6172 7343 560d  CV, LassoLarsCV.
-000766a0: 0a66 726f 6d20 736b 6c65 6172 6e2e 6d6f  .from sklearn.mo
-000766b0: 6465 6c5f 7365 6c65 6374 696f 6e20 696d  del_selection im
-000766c0: 706f 7274 2063 726f 7373 5f76 616c 5f70  port cross_val_p
-000766d0: 7265 6469 6374 0d0a 6672 6f6d 2073 6b6c  redict..from skl
-000766e0: 6561 726e 2e65 6e73 656d 626c 6520 696d  earn.ensemble im
-000766f0: 706f 7274 2045 7874 7261 5472 6565 7352  port ExtraTreesR
-00076700: 6567 7265 7373 6f72 2c20 4578 7472 6154  egressor, ExtraT
-00076710: 7265 6573 436c 6173 7369 6669 6572 0d0a  reesClassifier..
-00076720: 6672 6f6d 2073 6b6c 6561 726e 2e6c 696e  from sklearn.lin
-00076730: 6561 725f 6d6f 6465 6c20 696d 706f 7274  ear_model import
-00076740: 204c 6f67 6973 7469 6352 6567 7265 7373   LogisticRegress
-00076750: 696f 6e2c 204c 6f67 6973 7469 6352 6567  ion, LogisticReg
-00076760: 7265 7373 696f 6e43 562c 204c 696e 6561  ressionCV, Linea
-00076770: 7252 6567 7265 7373 696f 6e0d 0a66 726f  rRegression..fro
-00076780: 6d20 736b 6c65 6172 6e2e 6d6f 6465 6c5f  m sklearn.model_
-00076790: 7365 6c65 6374 696f 6e20 696d 706f 7274  selection import
-000767a0: 2047 7269 6453 6561 7263 6843 562c 5374   GridSearchCV,St
-000767b0: 7261 7469 6669 6564 5368 7566 666c 6553  ratifiedShuffleS
-000767c0: 706c 6974 0d0a 6672 6f6d 2073 6b6c 6561  plit..from sklea
-000767d0: 726e 2e6e 6169 7665 5f62 6179 6573 2069  rn.naive_bayes i
-000767e0: 6d70 6f72 7420 4761 7573 7369 616e 4e42  mport GaussianNB
-000767f0: 2c20 4d75 6c74 696e 6f6d 6961 6c4e 420d  , MultinomialNB.
-00076800: 0a66 726f 6d20 736b 6c65 6172 6e2e 7472  .from sklearn.tr
-00076810: 6565 2069 6d70 6f72 7420 4465 6369 7369  ee import Decisi
-00076820: 6f6e 5472 6565 436c 6173 7369 6669 6572  onTreeClassifier
-00076830: 0d0a 6672 6f6d 2073 6b6c 6561 726e 2e6d  ..from sklearn.m
-00076840: 756c 7469 636c 6173 7320 696d 706f 7274  ulticlass import
-00076850: 204f 6e65 5673 5265 7374 436c 6173 7369   OneVsRestClassi
-00076860: 6669 6572 0d0a 6672 6f6d 2073 6b6c 6561  fier..from sklea
-00076870: 726e 2e6e 6569 6768 626f 7273 2069 6d70  rn.neighbors imp
-00076880: 6f72 7420 4b4e 6569 6768 626f 7273 5265  ort KNeighborsRe
-00076890: 6772 6573 736f 720d 0a69 6d70 6f72 7420  gressor..import 
-000768a0: 7469 6d65 0d0a 696d 706f 7274 2070 6462  time..import pdb
-000768b0: 0d0a 696d 706f 7274 2074 696d 650d 0a69  ..import time..i
-000768c0: 6d70 6f72 7420 636f 7079 0d0a 696d 706f  mport copy..impo
-000768d0: 7274 206f 7065 7261 746f 720d 0a23 2323  rt operator..###
-000768e0: 2323 2323 2323 2323 2323 2323 2323 2323  ################
-000768f0: 2323 2323 2323 2323 2323 2323 2323 2323  ################
-00076900: 2323 2323 2323 2323 2323 2323 2323 2323  ################
-00076910: 2323 2323 2323 0d0a 6465 6620 5175 6963  ######..def Quic
-00076920: 6b4d 4c5f 456e 7365 6d62 6c69 6e67 2858  kML_Ensembling(X
-00076930: 5f74 7261 696e 2c20 795f 7472 6169 6e2c  _train, y_train,
-00076940: 2058 5f74 6573 742c 2079 5f74 6573 743d   X_test, y_test=
-00076950: 2727 2c20 6d6f 6465 6c74 7970 653d 2752  '', modeltype='R
-00076960: 6567 7265 7373 696f 6e27 2c0d 0a20 2020  egression',..   
-00076970: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00076980: 2020 2020 426f 6f73 7469 6e67 5f46 6c61      Boosting_Fla
-00076990: 673d 4661 6c73 652c 0d0a 2020 2020 2020  g=False,..      
-000769a0: 2020 2020 2020 2020 2020 2020 2020 2020                  
-000769b0: 2073 636f 7269 6e67 3d27 272c 2076 6572   scoring='', ver
-000769c0: 626f 7365 3d30 293a 0d0a 2020 2020 2222  bose=0):..    ""
-000769d0: 220d 0a20 2020 2051 7569 636b 6c79 2062  "..    Quickly b
-000769e0: 7569 6c64 7320 616e 6420 7275 6e73 206d  uilds and runs m
-000769f0: 756c 7469 706c 6520 6d6f 6465 6c73 2066  ultiple models f
-00076a00: 6f72 2061 2063 6c65 616e 2064 6174 6120  or a clean data 
-00076a10: 7365 7428 6f6e 6c79 206e 756d 6572 6963  set(only numeric
-00076a20: 7329 2e0d 0a20 2020 2022 2222 0d0a 2020  s)...    """..  
-00076a30: 2020 7374 6172 745f 7469 6d65 203d 2074    start_time = t
-00076a40: 696d 652e 7469 6d65 2829 0d0a 2020 2020  ime.time()..    
-00076a50: 7365 6564 203d 2039 390d 0a20 2020 2046  seed = 99..    F
-00076a60: 4f4c 4453 203d 2035 0d0a 2020 2020 6d6f  OLDS = 5..    mo
-00076a70: 6465 6c5f 6469 6374 203d 207b 7d0d 0a20  del_dict = {}.. 
-00076a80: 2020 206d 6f64 656c 5f74 7570 6c65 7320     model_tuples 
-00076a90: 3d20 5b5d 0d0a 2020 2020 6966 206c 656e  = []..    if len
-00076aa0: 2858 5f74 7261 696e 2920 3c3d 2031 3030  (X_train) <= 100
-00076ab0: 3030 3020 616e 6420 585f 7472 6169 6e2e  000 and X_train.
-00076ac0: 7368 6170 655b 315d 203c 2035 303a 0d0a  shape[1] < 50:..
-00076ad0: 2020 2020 2020 2020 4e55 4d53 203d 2031          NUMS = 1
-00076ae0: 3030 0d0a 2020 2020 656c 7365 3a0d 0a20  00..    else:.. 
-00076af0: 2020 2020 2020 2074 7279 3a0d 0a20 2020         try:..   
-00076b00: 2020 2020 2020 2020 2058 5f74 7261 696e           X_train
-00076b10: 203d 2058 5f74 7261 696e 2e73 616d 706c   = X_train.sampl
-00076b20: 6528 6672 6163 3d30 2e33 302c 7261 6e64  e(frac=0.30,rand
-00076b30: 6f6d 5f73 7461 7465 3d39 3929 0d0a 2020  om_state=99)..  
-00076b40: 2020 2020 2020 2020 2020 795f 7472 6169            y_trai
-00076b50: 6e20 3d20 795f 7472 6169 6e5b 585f 7472  n = y_train[X_tr
-00076b60: 6169 6e2e 696e 6465 785d 0d0a 2020 2020  ain.index]..    
-00076b70: 2020 2020 6578 6365 7074 3a0d 0a20 2020      except:..   
-00076b80: 2020 2020 2020 2020 2070 6173 730d 0a20           pass.. 
-00076b90: 2020 2020 2020 204e 554d 5320 3d20 3230         NUMS = 20
-00076ba0: 300d 0a20 2020 2023 2323 2323 2320 5468  0..    ###### Th
-00076bb0: 6973 2069 7320 7768 6572 6520 7765 2073  is is where we s
-00076bc0: 7461 7274 2070 6572 666f 726d 696e 6720  tart performing 
-00076bd0: 656e 7365 6d62 6c69 6e67 206f 6620 6d75  ensembling of mu
-00076be0: 6c74 6970 6c65 2073 696d 706c 6572 206d  ltiple simpler m
-00076bf0: 6f64 656c 7320 2323 230d 0a20 2020 2069  odels ###..    i
-00076c00: 6620 6d6f 6465 6c74 7970 6520 3d3d 2027  f modeltype == '
-00076c10: 5265 6772 6573 7369 6f6e 273a 0d0a 2020  Regression':..  
-00076c20: 2020 2020 2020 6966 2073 636f 7269 6e67        if scoring
-00076c30: 203d 3d20 2727 3a0d 0a20 2020 2020 2020   == '':..       
-00076c40: 2020 2020 2073 636f 7269 6e67 203d 2027       scoring = '
-00076c50: 6e65 675f 6d65 616e 5f73 7175 6172 6564  neg_mean_squared
-00076c60: 5f65 7272 6f72 270d 0a20 2020 2020 2020  _error'..       
-00076c70: 2023 7363 7620 3d20 5368 7566 666c 6553   #scv = ShuffleS
-00076c80: 706c 6974 286e 5f73 706c 6974 733d 464f  plit(n_splits=FO
-00076c90: 4c44 532c 7261 6e64 6f6d 5f73 7461 7465  LDS,random_state
-00076ca0: 3d73 6565 6429 0d0a 2020 2020 2020 2020  =seed)..        
-00076cb0: 7363 7620 3d20 4b46 6f6c 6428 6e5f 7370  scv = KFold(n_sp
-00076cc0: 6c69 7473 3d46 4f4c 4453 2c20 7368 7566  lits=FOLDS, shuf
-00076cd0: 666c 653d 4661 6c73 6529 0d0a 2020 2020  fle=False)..    
-00076ce0: 2020 2020 6966 2042 6f6f 7374 696e 675f      if Boosting_
-00076cf0: 466c 6167 2069 7320 4e6f 6e65 3a0d 0a20  Flag is None:.. 
-00076d00: 2020 2020 2020 2020 2020 2023 2320 4372             ## Cr
-00076d10: 6561 7465 2061 6e20 656e 7365 6d62 6c65  eate an ensemble
-00076d20: 206d 6f64 656c 2023 2323 230d 0a20 2020   model ####..   
-00076d30: 2020 2020 2020 2020 206d 6f64 656c 3520           model5 
-00076d40: 3d20 4164 6142 6f6f 7374 5265 6772 6573  = AdaBoostRegres
-00076d50: 736f 7228 6261 7365 5f65 7374 696d 6174  sor(base_estimat
-00076d60: 6f72 3d44 6563 6973 696f 6e54 7265 6552  or=DecisionTreeR
-00076d70: 6567 7265 7373 6f72 280d 0a20 2020 2020  egressor(..     
-00076d80: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00076d90: 2020 2020 2020 2020 2020 2020 2020 2072                 r
-00076da0: 616e 646f 6d5f 7374 6174 653d 7365 6564  andom_state=seed
-00076db0: 2c20 6d61 785f 6465 7074 683d 312c 206d  , max_depth=1, m
-00076dc0: 696e 5f73 616d 706c 6573 5f6c 6561 663d  in_samples_leaf=
-00076dd0: 320d 0a20 2020 2020 2020 2020 2020 2020  2..             
-00076de0: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00076df0: 2020 2020 2020 2029 2c20 6e5f 6573 7469         ), n_esti
-00076e00: 6d61 746f 7273 3d4e 554d 532c 2072 616e  mators=NUMS, ran
-00076e10: 646f 6d5f 7374 6174 653d 7365 6564 290d  dom_state=seed).
-00076e20: 0a20 2020 2020 2020 2020 2020 206d 6f64  .            mod
-00076e30: 656c 5f74 7570 6c65 732e 6170 7065 6e64  el_tuples.append
-00076e40: 2828 2741 6461 626f 6f73 7427 2c6d 6f64  (('Adaboost',mod
-00076e50: 656c 3529 290d 0a20 2020 2020 2020 2065  el5))..        e
-00076e60: 6c69 6620 6e6f 7420 426f 6f73 7469 6e67  lif not Boosting
-00076e70: 5f46 6c61 673a 0d0a 2020 2020 2020 2020  _Flag:..        
-00076e80: 2020 2020 6d6f 6465 6c35 203d 204c 6173      model5 = Las
-00076e90: 736f 4c61 7273 4356 2863 763d 7363 7629  soLarsCV(cv=scv)
-00076ea0: 0d0a 2020 2020 2020 2020 2020 2020 6d6f  ..            mo
-00076eb0: 6465 6c5f 7475 706c 6573 2e61 7070 656e  del_tuples.appen
-00076ec0: 6428 2827 4c61 7373 6f4c 6172 7343 5627  d(('LassoLarsCV'
-00076ed0: 2c6d 6f64 656c 3529 290d 0a20 2020 2020  ,model5))..     
-00076ee0: 2020 2065 6c73 653a 0d0a 2020 2020 2020     else:..      
-00076ef0: 2020 2020 2020 6d6f 6465 6c35 203d 204c        model5 = L
-00076f00: 6173 736f 4c61 7273 4356 2863 763d 7363  assoLarsCV(cv=sc
-00076f10: 7629 0d0a 2020 2020 2020 2020 2020 2020  v)..            
-00076f20: 6d6f 6465 6c5f 7475 706c 6573 2e61 7070  model_tuples.app
-00076f30: 656e 6428 2827 4c61 7373 6f4c 6172 7343  end(('LassoLarsC
-00076f40: 5627 2c6d 6f64 656c 3529 290d 0a20 2020  V',model5))..   
-00076f50: 2020 2020 2069 6620 426f 6f73 7469 6e67       if Boosting
-00076f60: 5f46 6c61 6720 6973 204e 6f6e 653a 0d0a  _Flag is None:..
-00076f70: 2020 2020 2020 2020 2020 2020 6d6f 6465              mode
-00076f80: 6c36 203d 2042 6167 6769 6e67 5265 6772  l6 = BaggingRegr
-00076f90: 6573 736f 7228 4465 6369 7369 6f6e 5472  essor(DecisionTr
-00076fa0: 6565 5265 6772 6573 736f 7228 7261 6e64  eeRegressor(rand
-00076fb0: 6f6d 5f73 7461 7465 3d73 6565 6429 2c0d  om_state=seed),.
-00076fc0: 0a20 2020 2020 2020 2020 2020 2020 2020  .               
-00076fd0: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00076fe0: 2020 2020 2020 2020 2020 2020 206e 5f65               n_e
-00076ff0: 7374 696d 6174 6f72 733d 4e55 4d53 2c72  stimators=NUMS,r
-00077000: 616e 646f 6d5f 7374 6174 653d 7365 6564  andom_state=seed
-00077010: 290d 0a20 2020 2020 2020 2020 2020 206d  )..            m
-00077020: 6f64 656c 5f74 7570 6c65 732e 6170 7065  odel_tuples.appe
-00077030: 6e64 2828 2742 6167 6769 6e67 5f52 6567  nd(('Bagging_Reg
-00077040: 7265 7373 6f72 272c 6d6f 6465 6c36 2929  ressor',model6))
-00077050: 0d0a 2020 2020 2020 2020 656c 6966 206e  ..        elif n
-00077060: 6f74 2042 6f6f 7374 696e 675f 466c 6167  ot Boosting_Flag
-00077070: 3a0d 0a20 2020 2020 2020 2020 2020 206d  :..            m
-00077080: 6f64 656c 3620 3d20 4c69 6e65 6172 5356  odel6 = LinearSV
-00077090: 5228 290d 0a20 2020 2020 2020 2020 2020  R()..           
-000770a0: 206d 6f64 656c 5f74 7570 6c65 732e 6170   model_tuples.ap
-000770b0: 7065 6e64 2828 274c 696e 6561 725f 5356  pend(('Linear_SV
-000770c0: 5227 2c6d 6f64 656c 3629 290d 0a20 2020  R',model6))..   
-000770d0: 2020 2020 2065 6c73 653a 0d0a 2020 2020       else:..    
-000770e0: 2020 2020 2020 2020 6d6f 6465 6c36 203d          model6 =
-000770f0: 2044 6563 6973 696f 6e54 7265 6552 6567   DecisionTreeReg
-00077100: 7265 7373 6f72 286d 6178 5f64 6570 7468  ressor(max_depth
-00077110: 3d35 2c6d 696e 5f73 616d 706c 6573 5f6c  =5,min_samples_l
-00077120: 6561 663d 3229 0d0a 2020 2020 2020 2020  eaf=2)..        
-00077130: 2020 2020 6d6f 6465 6c5f 7475 706c 6573      model_tuples
-00077140: 2e61 7070 656e 6428 2827 4465 6369 7369  .append(('Decisi
-00077150: 6f6e 5f54 7265 6527 2c6d 6f64 656c 3629  on_Tree',model6)
-00077160: 290d 0a20 2020 2020 2020 206d 6f64 656c  )..        model
-00077170: 3720 3d20 4b4e 6569 6768 626f 7273 5265  7 = KNeighborsRe
-00077180: 6772 6573 736f 7228 6e5f 6e65 6967 6862  gressor(n_neighb
-00077190: 6f72 733d 3829 0d0a 2020 2020 2020 2020  ors=8)..        
-000771a0: 6d6f 6465 6c5f 7475 706c 6573 2e61 7070  model_tuples.app
-000771b0: 656e 6428 2827 4b4e 4e5f 5265 6772 6573  end(('KNN_Regres
-000771c0: 736f 7227 2c6d 6f64 656c 3729 290d 0a20  sor',model7)).. 
-000771d0: 2020 2020 2020 2069 6620 426f 6f73 7469         if Boosti
-000771e0: 6e67 5f46 6c61 6720 6973 204e 6f6e 653a  ng_Flag is None:
-000771f0: 0d0a 2020 2020 2020 2020 2020 2020 2323  ..            ##
-00077200: 2323 2049 6620 7468 6520 426f 6f73 7469  ## If the Boosti
-00077210: 6e67 5f46 6c61 6720 6973 2054 7275 652c  ng_Flag is True,
-00077220: 2069 7420 6d65 616e 7320 426f 6f73 7469   it means Boosti
-00077230: 6e67 206d 6f64 656c 2069 7320 7072 6573  ng model is pres
-00077240: 656e 742e 0d0a 2020 2020 2020 2020 2020  ent...          
-00077250: 2020 2323 2320 2020 536f 2063 686f 6f73    ###   So choos
-00077260: 6520 6120 6469 6666 6572 656e 7420 6b69  e a different ki
-00077270: 6e64 206f 6620 636c 6173 7369 6669 6572  nd of classifier
-00077280: 2068 6572 650d 0a20 2020 2020 2020 2020   here..         
-00077290: 2020 206d 6f64 656c 3820 3d20 4465 6369     model8 = Deci
-000772a0: 7369 6f6e 5472 6565 5265 6772 6573 736f  sionTreeRegresso
-000772b0: 7228 6d61 785f 6465 7074 683d 352c 6d69  r(max_depth=5,mi
-000772c0: 6e5f 7361 6d70 6c65 735f 6c65 6166 3d32  n_samples_leaf=2
-000772d0: 290d 0a20 2020 2020 2020 2020 2020 206d  )..            m
-000772e0: 6f64 656c 5f74 7570 6c65 732e 6170 7065  odel_tuples.appe
-000772f0: 6e64 2828 2744 6563 6973 696f 6e5f 5472  nd(('Decision_Tr
-00077300: 6565 272c 6d6f 6465 6c38 2929 0d0a 2020  ee',model8))..  
-00077310: 2020 2020 2020 656c 6966 206e 6f74 2042        elif not B
-00077320: 6f6f 7374 696e 675f 466c 6167 3a0d 0a20  oosting_Flag:.. 
-00077330: 2020 2020 2020 2020 2020 2023 2323 2320             #### 
-00077340: 4966 2074 6865 2042 6f6f 7374 696e 675f  If the Boosting_
-00077350: 466c 6167 2069 7320 5472 7565 2c20 6974  Flag is True, it
-00077360: 206d 6561 6e73 2042 6f6f 7374 696e 6720   means Boosting 
-00077370: 6d6f 6465 6c20 6973 2070 7265 7365 6e74  model is present
-00077380: 2e0d 0a20 2020 2020 2020 2020 2020 2023  ...            #
-00077390: 2323 2020 2053 6f20 6368 6f6f 7365 2061  ##   So choose a
-000773a0: 2064 6966 6665 7265 6e74 206b 696e 6420   different kind 
-000773b0: 6f66 2063 6c61 7373 6966 6965 7220 6865  of classifier he
-000773c0: 7265 0d0a 2020 2020 2020 2020 2020 2020  re..            
-000773d0: 6d6f 6465 6c38 203d 2041 6461 426f 6f73  model8 = AdaBoos
-000773e0: 7452 6567 7265 7373 6f72 2862 6173 655f  tRegressor(base_
-000773f0: 6573 7469 6d61 746f 723d 4465 6369 7369  estimator=Decisi
-00077400: 6f6e 5472 6565 5265 6772 6573 736f 7228  onTreeRegressor(
-00077410: 0d0a 2020 2020 2020 2020 2020 2020 2020  ..              
-00077420: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00077430: 2020 2020 2020 7261 6e64 6f6d 5f73 7461        random_sta
-00077440: 7465 3d73 6565 642c 206d 6178 5f64 6570  te=seed, max_dep
-00077450: 7468 3d31 2c20 6d69 6e5f 7361 6d70 6c65  th=1, min_sample
-00077460: 735f 6c65 6166 3d32 0d0a 2020 2020 2020  s_leaf=2..      
-00077470: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00077480: 2020 2020 2020 2020 2020 2020 2020 292c                ),
-00077490: 206e 5f65 7374 696d 6174 6f72 733d 4e55   n_estimators=NU
-000774a0: 4d53 2c20 7261 6e64 6f6d 5f73 7461 7465  MS, random_state
-000774b0: 3d73 6565 6429 0d0a 2020 2020 2020 2020  =seed)..        
-000774c0: 2020 2020 6d6f 6465 6c5f 7475 706c 6573      model_tuples
-000774d0: 2e61 7070 656e 6428 2827 4164 6162 6f6f  .append(('Adaboo
-000774e0: 7374 272c 6d6f 6465 6c38 2929 0d0a 2020  st',model8))..  
-000774f0: 2020 2020 2020 656c 7365 3a0d 0a20 2020        else:..   
-00077500: 2020 2020 2020 2020 206d 6f64 656c 3820           model8 
-00077510: 3d20 5261 6e64 6f6d 466f 7265 7374 5265  = RandomForestRe
-00077520: 6772 6573 736f 7228 626f 6f74 7374 7261  gressor(bootstra
-00077530: 7020 3d20 4661 6c73 652c 0d0a 2020 2020  p = False,..    
-00077540: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00077550: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00077560: 2020 206d 6178 5f64 6570 7468 203d 2031     max_depth = 1
-00077570: 302c 0d0a 2020 2020 2020 2020 2020 2020  0,..            
+0006ec40: 2323 2323 2323 2323 2323 2323 2323 0d0a  ##############..
+0006ec50: 2020 2020 2020 2020 2320 506c 6f74 2050          # Plot P
+0006ec60: 7265 6369 7369 6f6e 2d52 6563 616c 6c20  recision-Recall 
+0006ec70: 6375 7276 6520 666f 7220 6561 6368 2063  curve for each c
+0006ec80: 6c61 7373 2061 6e64 2069 736f 2d66 3120  lass and iso-f1 
+0006ec90: 6375 7276 6573 0d0a 2020 2020 2020 2020  curves..        
+0006eca0: 2320 506c 6f74 2074 6865 206d 6963 726f  # Plot the micro
+0006ecb0: 2d61 7665 7261 6765 6420 5072 6563 6973  -averaged Precis
+0006ecc0: 696f 6e2d 5265 6361 6c6c 2063 7572 7665  ion-Recall curve
+0006ecd0: 0d0a 2020 2020 2020 2020 2323 2323 2323  ..        ######
+0006ece0: 2323 2323 2323 2323 2323 2323 2323 2323  ################
+0006ecf0: 2323 2323 2323 2323 2323 2323 2323 2323  ################
+0006ed00: 2323 2323 2323 2323 2323 2323 2323 2323  ################
+0006ed10: 2323 2323 2323 2323 2323 2323 2323 2323  ################
+0006ed20: 2323 2323 2323 2323 230d 0a20 2020 2020  #########..     
+0006ed30: 2020 2023 202e 2e2e 2e2e 2e2e 2e2e 2e2e     # ...........
+0006ed40: 2e2e 2e2e 2e2e 2e2e 2e2e 2e2e 2e2e 2e2e  ................
+0006ed50: 2e2e 2e2e 2e2e 2e2e 2e2e 2e2e 2e2e 2e2e  ................
+0006ed60: 2e2e 2e2e 2e2e 2e2e 2e2e 2e2e 2e2e 2e2e  ................
+0006ed70: 2e2e 0d0a 2020 2020 2020 2020 230d 0a20  ....        #.. 
+0006ed80: 2020 2020 2020 2023 2073 6574 7570 2070         # setup p
+0006ed90: 6c6f 7420 6465 7461 696c 730d 0a20 2020  lot details..   
+0006eda0: 2020 2020 2063 6f6c 6f72 7320 3d20 6379       colors = cy
+0006edb0: 636c 6528 2762 7972 636d 676b 6279 7263  cle('byrcmgkbyrc
+0006edc0: 6d67 6b62 7972 636d 676b 6279 7263 6d67  mgkbyrcmgkbyrcmg
+0006edd0: 6b27 290d 0a0d 0a20 2020 2020 2020 2070  k')....        p
+0006ede0: 6c74 2e66 6967 7572 6528 6669 6773 697a  lt.figure(figsiz
+0006edf0: 653d 6669 6773 697a 6529 0d0a 2020 2020  e=figsize)..    
+0006ee00: 2020 2020 665f 7363 6f72 6573 203d 206d      f_scores = m
+0006ee10: 756c 7469 5f66 3128 795f 7465 7374 2c63  ulti_f1(y_test,c
+0006ee20: 6c61 7373 6966 6965 722e 7072 6564 6963  lassifier.predic
+0006ee30: 7428 585f 7465 7374 2929 0d0a 2020 2020  t(X_test))..    
+0006ee40: 2020 2020 7072 696e 7428 274d 6163 726f      print('Macro
+0006ee50: 2046 3120 7363 6f72 652c 2061 7665 7261   F1 score, avera
+0006ee60: 6765 6420 6f76 6572 2061 6c6c 2063 6c61  ged over all cla
+0006ee70: 7373 6573 3a20 7b30 3a30 2e32 667d 270d  sses: {0:0.2f}'.
+0006ee80: 0a20 2020 2020 2020 2020 2020 2020 202e  .              .
+0006ee90: 666f 726d 6174 2866 5f73 636f 7265 732e  format(f_scores.
+0006eea0: 6d65 616e 2829 2929 0d0a 2020 2020 2020  mean()))..      
+0006eeb0: 2020 6c69 6e65 7320 3d20 5b5d 0d0a 2020    lines = []..  
+0006eec0: 2020 2020 2020 6c61 6265 6c73 203d 205b        labels = [
+0006eed0: 5d0d 0a20 2020 2020 2020 2066 6f72 2066  ]..        for f
+0006eee0: 5f73 636f 7265 2069 6e20 665f 7363 6f72  _score in f_scor
+0006eef0: 6573 3a0d 0a20 2020 2020 2020 2020 2020  es:..           
+0006ef00: 2078 203d 206e 702e 6c69 6e73 7061 6365   x = np.linspace
+0006ef10: 2830 2e30 312c 2031 290d 0a20 2020 2020  (0.01, 1)..     
+0006ef20: 2020 2020 2020 2079 203d 2066 5f73 636f         y = f_sco
+0006ef30: 7265 202a 2078 202f 2028 3220 2a20 7820  re * x / (2 * x 
+0006ef40: 2d20 665f 7363 6f72 6529 0d0a 2020 2020  - f_score)..    
+0006ef50: 2020 2020 2020 2020 6c2c 203d 2070 6c74          l, = plt
+0006ef60: 2e70 6c6f 7428 785b 7920 3e3d 2030 5d2c  .plot(x[y >= 0],
+0006ef70: 2079 5b79 203e 3d20 305d 2c20 636f 6c6f   y[y >= 0], colo
+0006ef80: 723d 2767 7261 7927 2c20 616c 7068 613d  r='gray', alpha=
+0006ef90: 302e 3229 0d0a 2020 2020 2020 2020 2020  0.2)..          
+0006efa0: 2020 706c 742e 616e 6e6f 7461 7465 2827    plt.annotate('
+0006efb0: 6631 3d7b 303a 302e 3266 7d27 2e66 6f72  f1={0:0.2f}'.for
+0006efc0: 6d61 7428 665f 7363 6f72 6529 2c20 7879  mat(f_score), xy
+0006efd0: 3d28 302e 392c 2079 5b34 355d 202b 2030  =(0.9, y[45] + 0
+0006efe0: 2e30 3229 290d 0a0d 0a20 2020 2020 2020  .02))....       
+0006eff0: 206c 696e 6573 2e61 7070 656e 6428 6c29   lines.append(l)
+0006f000: 0d0a 2020 2020 2020 2020 6c61 6265 6c73  ..        labels
+0006f010: 2e61 7070 656e 6428 2769 736f 2d66 3120  .append('iso-f1 
+0006f020: 6375 7276 6573 2729 0d0a 2020 2020 2020  curves')..      
+0006f030: 2020 6c2c 203d 2070 6c74 2e70 6c6f 7428    l, = plt.plot(
+0006f040: 7265 6361 6c6c 5b22 6d69 6372 6f22 5d2c  recall["micro"],
+0006f050: 2070 7265 6369 7369 6f6e 5b22 6d69 6372   precision["micr
+0006f060: 6f22 5d2c 2063 6f6c 6f72 3d27 676f 6c64  o"], color='gold
+0006f070: 272c 206c 773d 3229 0d0a 2020 2020 2020  ', lw=2)..      
+0006f080: 2020 6c69 6e65 732e 6170 7065 6e64 286c    lines.append(l
+0006f090: 290d 0a20 2020 2020 2020 206c 6162 656c  )..        label
+0006f0a0: 732e 6170 7065 6e64 2827 6d69 6372 6f2d  s.append('micro-
+0006f0b0: 6176 6572 6167 6520 5072 6563 6973 696f  average Precisio
+0006f0c0: 6e2d 7265 6361 6c6c 2028 6172 6561 203d  n-recall (area =
+0006f0d0: 207b 303a 302e 3266 7d29 270d 0a20 2020   {0:0.2f})'..   
+0006f0e0: 2020 2020 2020 2020 2020 2020 2020 2020                  
+0006f0f0: 2020 2027 272e 666f 726d 6174 2861 7665     ''.format(ave
+0006f100: 7261 6765 5f70 7265 6369 7369 6f6e 5b22  rage_precision["
+0006f110: 6d69 6372 6f22 5d29 290d 0a0d 0a20 2020  micro"]))....   
+0006f120: 2020 2020 2066 6f72 2069 2c20 636f 6c6f       for i, colo
+0006f130: 7220 696e 207a 6970 2872 616e 6765 286e  r in zip(range(n
+0006f140: 5f63 6c61 7373 6573 292c 2063 6f6c 6f72  _classes), color
+0006f150: 7329 3a0d 0a20 2020 2020 2020 2020 2020  s):..           
+0006f160: 206c 2c20 3d20 706c 742e 706c 6f74 2872   l, = plt.plot(r
+0006f170: 6563 616c 6c5b 695d 2c20 7072 6563 6973  ecall[i], precis
+0006f180: 696f 6e5b 695d 2c20 636f 6c6f 723d 636f  ion[i], color=co
+0006f190: 6c6f 722c 206c 773d 3129 0d0a 2020 2020  lor, lw=1)..    
+0006f1a0: 2020 2020 2020 2020 6c69 6e65 732e 6170          lines.ap
+0006f1b0: 7065 6e64 286c 290d 0a20 2020 2020 2020  pend(l)..       
+0006f1c0: 2020 2020 206c 6162 656c 732e 6170 7065       labels.appe
+0006f1d0: 6e64 2827 5072 6563 6973 696f 6e2d 7265  nd('Precision-re
+0006f1e0: 6361 6c6c 2066 6f72 2063 6c61 7373 207b  call for class {
+0006f1f0: 307d 2028 6172 6561 203d 207b 313a 302e  0} (area = {1:0.
+0006f200: 3266 7d29 270d 0a20 2020 2020 2020 2020  2f})'..         
+0006f210: 2020 2020 2020 2020 2020 2020 2020 2020                  
+0006f220: 2027 272e 666f 726d 6174 2869 2c20 6176   ''.format(i, av
+0006f230: 6572 6167 655f 7072 6563 6973 696f 6e5b  erage_precision[
+0006f240: 695d 2929 0d0a 0d0a 2020 2020 2020 2020  i]))....        
+0006f250: 6669 6720 3d20 706c 742e 6763 6628 290d  fig = plt.gcf().
+0006f260: 0a20 2020 2020 2020 2066 6967 2e73 7562  .        fig.sub
+0006f270: 706c 6f74 735f 6164 6a75 7374 2862 6f74  plots_adjust(bot
+0006f280: 746f 6d3d 302e 3235 290d 0a20 2020 2020  tom=0.25)..     
+0006f290: 2020 2070 6c74 2e78 6c69 6d28 5b30 2e30     plt.xlim([0.0
+0006f2a0: 2c20 312e 305d 290d 0a20 2020 2020 2020  , 1.0])..       
+0006f2b0: 2070 6c74 2e79 6c69 6d28 5b30 2e30 2c20   plt.ylim([0.0, 
+0006f2c0: 312e 3035 5d29 0d0a 2020 2020 2020 2020  1.05])..        
+0006f2d0: 706c 742e 786c 6162 656c 2827 5265 6361  plt.xlabel('Reca
+0006f2e0: 6c6c 2729 0d0a 2020 2020 2020 2020 706c  ll')..        pl
+0006f2f0: 742e 796c 6162 656c 2827 5072 6563 6973  t.ylabel('Precis
+0006f300: 696f 6e27 290d 0a20 2020 2020 2020 2070  ion')..        p
+0006f310: 6c74 2e74 6974 6c65 2827 4d69 6372 6f20  lt.title('Micro 
+0006f320: 4176 6720 5072 6563 6973 696f 6e2d 5265  Avg Precision-Re
+0006f330: 6361 6c6c 2063 7572 7665 2077 6974 6820  call curve with 
+0006f340: 6973 6f2d 6631 2063 7572 7665 7327 290d  iso-f1 curves').
+0006f350: 0a20 2020 2020 2020 2070 6c74 2e6c 6567  .        plt.leg
+0006f360: 656e 6428 6c69 6e65 732c 206c 6162 656c  end(lines, label
+0006f370: 732c 206c 6f63 3d27 6c6f 7765 7220 6c65  s, loc='lower le
+0006f380: 6674 272c 2070 726f 703d 6469 6374 2873  ft', prop=dict(s
+0006f390: 697a 653d 3130 2929 0d0a 2020 2020 2020  ize=10))..      
+0006f3a0: 2020 706c 742e 7368 6f77 2829 3b0d 0a23    plt.show();..#
+0006f3b0: 2323 2323 2323 2323 2323 2323 2323 2323  ################
+0006f3c0: 2323 2323 2323 2323 2323 2323 2323 2323  ################
+0006f3d0: 2323 2323 2323 2323 2323 2323 2323 2323  ################
+0006f3e0: 2323 2323 2323 2323 2323 2323 2323 2323  ################
+0006f3f0: 2323 2323 2323 2323 2323 2323 2323 2323  ################
+0006f400: 2323 2323 230d 0a69 6d70 6f72 7420 6d61  #####..import ma
+0006f410: 7470 6c6f 746c 6962 2e70 7970 6c6f 7420  tplotlib.pyplot 
+0006f420: 6173 2070 6c74 0d0a 696d 706f 7274 2073  as plt..import s
+0006f430: 6561 626f 726e 2061 7320 736e 730d 0a64  eaborn as sns..d
+0006f440: 6566 2064 7261 775f 636f 6e66 7573 696f  ef draw_confusio
+0006f450: 6e5f 6d61 7874 7269 7828 795f 7465 7374  n_maxtrix(y_test
+0006f460: 2c79 5f70 7265 642c 206d 6f64 656c 5f6e  ,y_pred, model_n
+0006f470: 616d 653d 274d 6f64 656c 272c 6178 3d27  ame='Model',ax='
+0006f480: 2729 3a0d 0a20 2020 2022 2222 0d0a 2020  '):..    """..  
+0006f490: 2020 5468 6973 2070 6c6f 7473 2061 2062    This plots a b
+0006f4a0: 6561 7574 6966 756c 2063 6f6e 6675 7369  eautiful confusi
+0006f4b0: 6f6e 206d 6174 7269 7820 6261 7365 6420  on matrix based 
+0006f4c0: 6f6e 2069 6e70 7574 3a20 6772 6f75 6e64  on input: ground
+0006f4d0: 2074 7275 7468 7320 616e 6420 7072 6564   truths and pred
+0006f4e0: 6963 7469 6f6e 730d 0a20 2020 2022 2222  ictions..    """
+0006f4f0: 0d0a 2020 2020 2343 6f6e 6675 7369 6f6e  ..    #Confusion
+0006f500: 204d 6174 7269 780d 0a20 2020 2027 2727   Matrix..    '''
+0006f510: 506c 6f74 7469 6e67 2043 4f4e 4655 5349  Plotting CONFUSI
+0006f520: 4f4e 204d 4154 5249 5827 2727 0d0a 2020  ON MATRIX'''..  
+0006f530: 2020 696d 706f 7274 2073 6561 626f 726e    import seaborn
+0006f540: 2061 7320 736e 730d 0a20 2020 2073 6e73   as sns..    sns
+0006f550: 2e73 6574 5f73 7479 6c65 2827 6461 726b  .set_style('dark
+0006f560: 6772 6964 2729 0d0a 0d0a 2020 2020 2727  grid')....    ''
+0006f570: 2744 6973 706c 6179 2727 270d 0a20 2020  'Display'''..   
+0006f580: 2066 726f 6d20 4950 7974 686f 6e2e 636f   from IPython.co
+0006f590: 7265 2e64 6973 706c 6179 2069 6d70 6f72  re.display impor
+0006f5a0: 7420 6469 7370 6c61 792c 2048 544d 4c0d  t display, HTML.
+0006f5b0: 0a20 2020 2064 6973 706c 6179 2848 544d  .    display(HTM
+0006f5c0: 4c28 223c 7374 796c 653e 2e63 6f6e 7461  L("<style>.conta
+0006f5d0: 696e 6572 207b 2077 6964 7468 3a39 3525  iner { width:95%
+0006f5e0: 2021 696d 706f 7274 616e 743b 207d 3c2f   !important; }</
+0006f5f0: 7374 796c 653e 2229 290d 0a20 2020 2070  style>"))..    p
+0006f600: 642e 6f70 7469 6f6e 732e 6469 7370 6c61  d.options.displa
+0006f610: 792e 666c 6f61 745f 666f 726d 6174 203d  y.float_format =
+0006f620: 2027 7b3a 2c2e 3266 7d27 2e66 6f72 6d61   '{:,.2f}'.forma
+0006f630: 740d 0a0d 0a20 2020 2023 4765 7420 7468  t....    #Get th
+0006f640: 6520 636f 6e66 7573 696f 6e20 6d61 7472  e confusion matr
+0006f650: 6978 2061 6e64 2070 7574 2069 7420 696e  ix and put it in
+0006f660: 746f 2061 2064 660d 0a20 2020 2066 726f  to a df..    fro
+0006f670: 6d20 736b 6c65 6172 6e2e 6d65 7472 6963  m sklearn.metric
+0006f680: 7320 696d 706f 7274 2063 6f6e 6675 7369  s import confusi
+0006f690: 6f6e 5f6d 6174 7269 782c 2066 315f 7363  on_matrix, f1_sc
+0006f6a0: 6f72 650d 0a0d 0a20 2020 2063 6d20 3d20  ore....    cm = 
+0006f6b0: 636f 6e66 7573 696f 6e5f 6d61 7472 6978  confusion_matrix
+0006f6c0: 2879 5f74 6573 742c 2079 5f70 7265 6429  (y_test, y_pred)
+0006f6d0: 0d0a 0d0a 2020 2020 636d 5f64 6620 3d20  ....    cm_df = 
+0006f6e0: 7064 2e44 6174 6146 7261 6d65 2863 6d2c  pd.DataFrame(cm,
+0006f6f0: 0d0a 2020 2020 2020 2020 2020 2020 2020  ..              
+0006f700: 2020 2020 2020 2020 2020 2069 6e64 6578             index
+0006f710: 203d 206e 702e 756e 6971 7565 2879 5f74   = np.unique(y_t
+0006f720: 6573 7429 2e74 6f6c 6973 7428 292c 0d0a  est).tolist(),..
+0006f730: 2020 2020 2020 2020 2020 2020 2020 2020                  
+0006f740: 2020 2020 2020 2020 2063 6f6c 756d 6e73           columns
+0006f750: 203d 206e 702e 756e 6971 7565 2879 5f74   = np.unique(y_t
+0006f760: 6573 7429 2e74 6f6c 6973 7428 292c 0d0a  est).tolist(),..
+0006f770: 2020 2020 2020 2020 2020 2020 2020 2020                  
+0006f780: 2020 2020 2020 2020 290d 0a0d 0a20 2020          )....   
+0006f790: 2073 6e73 2e68 6561 746d 6170 2863 6d5f   sns.heatmap(cm_
+0006f7a0: 6466 2c0d 0a20 2020 2020 2020 2020 2020  df,..           
+0006f7b0: 2020 2020 2063 656e 7465 723d 302c 0d0a       center=0,..
+0006f7c0: 2020 2020 2020 2020 2020 2020 2020 2020                  
+0006f7d0: 636d 6170 3d73 6e73 2e64 6976 6572 6769  cmap=sns.divergi
+0006f7e0: 6e67 5f70 616c 6574 7465 2832 3230 2c20  ng_palette(220, 
+0006f7f0: 3135 2c20 6173 5f63 6d61 703d 5472 7565  15, as_cmap=True
+0006f800: 292c 0d0a 2020 2020 2020 2020 2020 2020  ),..            
+0006f810: 2020 2020 616e 6e6f 743d 5472 7565 2c0d      annot=True,.
+0006f820: 0a20 2020 2020 2020 2020 2020 2020 2020  .               
+0006f830: 2066 6d74 3d27 6727 2c0d 0a20 2020 2020   fmt='g',..     
+0006f840: 2020 2020 2020 2020 2020 6178 3d61 7829            ax=ax)
+0006f850: 0d0a 0d0a 2020 2020 6178 2e73 6574 5f74  ....    ax.set_t
+0006f860: 6974 6c65 2827 2025 7320 5c6e 4631 2053  itle(' %s \nF1 S
+0006f870: 636f 7265 2861 7667 203d 206d 6963 726f  core(avg = micro
+0006f880: 293a 2025 302e 3266 205c 6e46 3120 5363  ): %0.2f \nF1 Sc
+0006f890: 6f72 6528 6176 6720 3d20 6d61 6372 6f29  ore(avg = macro)
+0006f8a0: 3a20 2530 2e32 6627 2025 280d 0a20 2020  : %0.2f' %(..   
+0006f8b0: 2020 2020 206d 6f64 656c 5f6e 616d 652c       model_name,
+0006f8c0: 6631 5f73 636f 7265 2879 5f74 6573 742c  f1_score(y_test,
+0006f8d0: 2079 5f70 7265 642c 2061 7665 7261 6765   y_pred, average
+0006f8e0: 3d27 6d69 6372 6f27 292c 6631 5f73 636f  ='micro'),f1_sco
+0006f8f0: 7265 2879 5f74 6573 742c 2079 5f70 7265  re(y_test, y_pre
+0006f900: 642c 2061 7665 7261 6765 3d27 6d61 6372  d, average='macr
+0006f910: 6f27 2929 2c0d 0a20 2020 2020 2020 2020  o')),..         
+0006f920: 2020 2020 2066 6f6e 7473 697a 6520 3d20       fontsize = 
+0006f930: 3133 290d 0a20 2020 2061 782e 7365 745f  13)..    ax.set_
+0006f940: 796c 6162 656c 2827 5472 7565 206c 6162  ylabel('True lab
+0006f950: 656c 272c 2066 6f6e 7473 697a 6520 3d20  el', fontsize = 
+0006f960: 3133 290d 0a20 2020 2061 782e 7365 745f  13)..    ax.set_
+0006f970: 786c 6162 656c 2827 5072 6564 6963 7465  xlabel('Predicte
+0006f980: 6420 6c61 6265 6c27 2c20 666f 6e74 7369  d label', fontsi
+0006f990: 7a65 203d 2031 3329 0d0a 2323 2323 2323  ze = 13)..######
+0006f9a0: 2323 2323 2323 2323 2323 2323 2323 2323  ################
+0006f9b0: 2323 2323 2323 2323 2323 2323 2323 2323  ################
+0006f9c0: 2323 2323 2323 2323 2323 2323 2323 2323  ################
+0006f9d0: 2323 2323 2323 2323 2323 2323 2323 2323  ################
+0006f9e0: 2323 2323 2323 2323 2323 2323 2323 2323  ################
+0006f9f0: 0d0a 6672 6f6d 2073 6b6c 6561 726e 2e6d  ..from sklearn.m
+0006fa00: 6574 7269 6373 2069 6d70 6f72 7420 636c  etrics import cl
+0006fa10: 6173 7369 6669 6361 7469 6f6e 5f72 6570  assification_rep
+0006fa20: 6f72 742c 2072 6f63 5f63 7572 7665 0d0a  ort, roc_curve..
+0006fa30: 696d 706f 7274 206d 6174 706c 6f74 6c69  import matplotli
+0006fa40: 622e 7079 706c 6f74 2061 7320 706c 740d  b.pyplot as plt.
+0006fa50: 0a69 6d70 6f72 7420 7365 6162 6f72 6e20  .import seaborn 
+0006fa60: 6173 2073 6e73 0d0a 0d0a 6672 6f6d 2073  as sns....from s
+0006fa70: 6b6c 6561 726e 2e6d 6574 7269 6373 2069  klearn.metrics i
+0006fa80: 6d70 6f72 7420 726f 635f 6375 7276 652c  mport roc_curve,
+0006fa90: 2070 7265 6369 7369 6f6e 5f72 6563 616c   precision_recal
+0006faa0: 6c5f 6375 7276 650d 0a0d 0a64 6566 2070  l_curve....def p
+0006fab0: 6c6f 745f 7072 6563 6973 696f 6e5f 7265  lot_precision_re
+0006fac0: 6361 6c6c 5f63 7572 7665 286d 2c20 785f  call_curve(m, x_
+0006fad0: 7465 7374 632c 2079 5f74 6573 742c 2061  testc, y_test, a
+0006fae0: 783d 4e6f 6e65 293a 0d0a 2020 2020 2323  x=None):..    ##
+0006faf0: 2323 2054 6869 7320 6973 2061 2073 696d  ## This is a sim
+0006fb00: 706c 6520 7761 7920 746f 2070 6c6f 7420  ple way to plot 
+0006fb10: 5052 2063 7572 7665 2066 6f72 2062 696e  PR curve for bin
+0006fb20: 6172 7920 636c 6173 7365 7320 2323 2323  ary classes ####
+0006fb30: 230d 0a20 2020 2079 5f73 636f 7265 7320  #..    y_scores 
+0006fb40: 3d20 6d2e 7072 6564 6963 745f 7072 6f62  = m.predict_prob
+0006fb50: 6128 785f 7465 7374 6329 5b3a 2c31 5d0d  a(x_testc)[:,1].
+0006fb60: 0a20 2020 2023 2323 2067 656e 6572 6174  .    ### generat
+0006fb70: 6520 7468 6520 7072 6563 6973 696f 6e20  e the precision 
+0006fb80: 7265 6361 6c6c 2063 7572 7665 2023 2323  recall curve ###
+0006fb90: 2323 2323 2323 230d 0a20 2020 2070 2c20  #######..    p, 
+0006fba0: 722c 2074 6872 6573 686f 6c64 7320 3d20  r, thresholds = 
+0006fbb0: 7072 6563 6973 696f 6e5f 7265 6361 6c6c  precision_recall
+0006fbc0: 5f63 7572 7665 2879 5f74 6573 742c 2079  _curve(y_test, y
+0006fbd0: 5f73 636f 7265 7329 0d0a 2020 2020 2323  _scores)..    ##
+0006fbe0: 2323 2070 6c6f 7420 7468 6520 6375 7276  ## plot the curv
+0006fbf0: 6520 2323 2323 2323 2323 2323 0d0a 2020  e ##########..  
+0006fc00: 2020 6178 2e73 6574 5f74 6974 6c65 2822    ax.set_title("
+0006fc10: 5072 6563 6973 696f 6e20 5265 6361 6c6c  Precision Recall
+0006fc20: 2043 7572 7665 2229 0d0a 2020 2020 6178   Curve")..    ax
+0006fc30: 2e70 6c6f 7428 722c 2070 2c20 636f 6c6f  .plot(r, p, colo
+0006fc40: 723d 2270 7572 706c 6522 290d 0a20 2020  r="purple")..   
+0006fc50: 2061 782e 7365 745f 796c 696d 285b 302e   ax.set_ylim([0.
+0006fc60: 352c 2031 2e30 315d 290d 0a20 2020 2061  5, 1.01])..    a
+0006fc70: 782e 7365 745f 786c 696d 285b 302e 352c  x.set_xlim([0.5,
+0006fc80: 2031 2e30 315d 290d 0a20 2020 2061 782e   1.01])..    ax.
+0006fc90: 7365 745f 786c 6162 656c 2827 5265 6361  set_xlabel('Reca
+0006fca0: 6c6c 2729 0d0a 2020 2020 6178 2e73 6574  ll')..    ax.set
+0006fcb0: 5f79 6c61 6265 6c28 2750 7265 6369 7369  _ylabel('Precisi
+0006fcc0: 6f6e 2729 0d0a 0d0a 6465 6620 706c 6f74  on')....def plot
+0006fcd0: 5f72 6f63 5f63 7572 7665 286d 2c20 785f  _roc_curve(m, x_
+0006fce0: 7465 7374 632c 2079 5f74 6573 742c 2061  testc, y_test, a
+0006fcf0: 783d 4e6f 6e65 293a 0d0a 2020 2020 2323  x=None):..    ##
+0006fd00: 2323 2054 6869 7320 6973 2061 2073 696d  ## This is a sim
+0006fd10: 706c 6520 7761 7920 746f 2070 6c6f 7420  ple way to plot 
+0006fd20: 524f 4320 6375 7276 6520 666f 7220 6269  ROC curve for bi
+0006fd30: 6e61 7279 2063 6c61 7373 6573 2023 2323  nary classes ###
+0006fd40: 2323 0d0a 2020 2020 795f 7363 6f72 6573  ##..    y_scores
+0006fd50: 203d 206d 2e70 7265 6469 6374 5f70 726f   = m.predict_pro
+0006fd60: 6261 2878 5f74 6573 7463 295b 3a2c 315d  ba(x_testc)[:,1]
+0006fd70: 0d0a 2020 2020 2323 2320 6765 6e65 7261  ..    ### genera
+0006fd80: 7465 2074 6865 2070 7265 6369 7369 6f6e  te the precision
+0006fd90: 2072 6563 616c 6c20 6375 7276 6520 2323   recall curve ##
+0006fda0: 2323 2323 2323 2323 0d0a 2020 2020 6670  ########..    fp
+0006fdb0: 722c 2074 7072 2c20 5f20 3d20 726f 635f  r, tpr, _ = roc_
+0006fdc0: 6375 7276 6528 795f 7465 7374 2c20 2079  curve(y_test,  y
+0006fdd0: 5f73 636f 7265 7329 0d0a 2020 2020 2323  _scores)..    ##
+0006fde0: 2323 2070 6c6f 7420 7468 6520 6375 7276  ## plot the curv
+0006fdf0: 6520 2323 2323 2323 2323 2323 0d0a 2020  e ##########..  
+0006fe00: 2020 6178 2e73 6574 5f74 6974 6c65 2822    ax.set_title("
+0006fe10: 524f 4320 4155 4320 4375 7276 6522 290d  ROC AUC Curve").
+0006fe20: 0a20 2020 2061 782e 706c 6f74 2866 7072  .    ax.plot(fpr
+0006fe30: 2c74 7072 2c20 636f 6c6f 723d 2270 7572  ,tpr, color="pur
+0006fe40: 706c 6522 290d 0a20 2020 2061 782e 7365  ple")..    ax.se
+0006fe50: 745f 796c 696d 285b 302e 302c 2031 2e30  t_ylim([0.0, 1.0
+0006fe60: 315d 290d 0a20 2020 2061 782e 7365 745f  1])..    ax.set_
+0006fe70: 786c 696d 285b 302e 302c 2031 2e30 315d  xlim([0.0, 1.01]
+0006fe80: 290d 0a20 2020 2061 782e 7365 745f 786c  )..    ax.set_xl
+0006fe90: 6162 656c 2827 4661 6c73 6520 506f 7369  abel('False Posi
+0006fea0: 7469 7665 2052 6174 6527 290d 0a20 2020  tive Rate')..   
+0006feb0: 2061 782e 7365 745f 796c 6162 656c 2827   ax.set_ylabel('
+0006fec0: 5472 7565 2050 6f73 6974 6976 6520 5261  True Positive Ra
+0006fed0: 7465 2729 0d0a 0d0a 0d0a 6465 6620 706c  te')......def pl
+0006fee0: 6f74 5f63 6c61 7373 6966 6963 6174 696f  ot_classificatio
+0006fef0: 6e5f 7265 7375 6c74 7328 6d2c 2058 5f74  n_results(m, X_t
+0006ff00: 7275 652c 2079 5f74 7275 652c 2079 5f70  rue, y_true, y_p
+0006ff10: 7265 642c 206c 6162 656c 732c 2074 6172  red, labels, tar
+0006ff20: 6765 745f 6e61 6d65 732c 2065 6163 685f  get_names, each_
+0006ff30: 7461 7267 6574 293a 0d0a 2020 2020 2323  target):..    ##
+0006ff40: 2323 2054 6865 7365 2070 6c6f 7473 2061  ## These plots a
+0006ff50: 7265 206f 6e6c 7920 666f 7220 6269 6e61  re only for bina
+0006ff60: 7279 2063 6c61 7373 6573 2023 2323 2323  ry classes #####
+0006ff70: 2323 2323 2323 2323 0d0a 2020 2020 7472  ########..    tr
+0006ff80: 793a 0d0a 2020 2020 2020 2020 6669 672c  y:..        fig,
+0006ff90: 2061 7865 7320 3d20 706c 742e 7375 6270   axes = plt.subp
+0006ffa0: 6c6f 7473 2832 2c32 2c66 6967 7369 7a65  lots(2,2,figsize
+0006ffb0: 3d28 3135 2c31 3529 290d 0a20 2020 2020  =(15,15))..     
+0006ffc0: 2020 2070 6c6f 745f 726f 635f 6375 7276     plot_roc_curv
+0006ffd0: 6528 6d2c 2058 5f74 7275 652c 2079 5f74  e(m, X_true, y_t
+0006ffe0: 7275 652c 2061 783d 6178 6573 5b30 2c31  rue, ax=axes[0,1
+0006fff0: 5d29 0d0a 2020 2020 2020 2020 6178 6573  ])..        axes
+00070000: 5b30 2c31 5d2e 7365 745f 7469 746c 6528  [0,1].set_title(
+00070010: 2752 4f43 2041 5543 2043 7572 7665 3a20  'ROC AUC Curve: 
+00070020: 2573 2720 2565 6163 685f 7461 7267 6574  %s' %each_target
+00070030: 290d 0a20 2020 2020 2020 2070 6c6f 745f  )..        plot_
+00070040: 7072 6563 6973 696f 6e5f 7265 6361 6c6c  precision_recall
+00070050: 5f63 7572 7665 286d 2c20 585f 7472 7565  _curve(m, X_true
+00070060: 2c20 795f 7472 7565 2c20 6178 3d61 7865  , y_true, ax=axe
+00070070: 735b 312c 305d 290d 0a20 2020 2020 2020  s[1,0])..       
+00070080: 2061 7865 735b 312c 305d 2e73 6574 5f74   axes[1,0].set_t
+00070090: 6974 6c65 2827 5052 2041 5543 2043 7572  itle('PR AUC Cur
+000700a0: 7665 2066 6f72 3a20 2573 2720 2565 6163  ve for: %s' %eac
+000700b0: 685f 7461 7267 6574 290d 0a20 2020 2020  h_target)..     
+000700c0: 2020 2079 5f70 7265 6420 3d20 6d2e 7072     y_pred = m.pr
+000700d0: 6564 6963 7428 585f 7472 7565 290d 0a20  edict(X_true).. 
+000700e0: 2020 2020 2020 2064 7261 775f 636f 6e66         draw_conf
+000700f0: 7573 696f 6e5f 6d61 7874 7269 7828 795f  usion_maxtrix(y_
+00070100: 7472 7565 2c20 795f 7072 6564 2c20 2743  true, y_pred, 'C
+00070110: 6f6e 6675 7369 6f6e 204d 6174 7269 7827  onfusion Matrix'
+00070120: 2c20 6178 3d61 7865 735b 302c 305d 290d  , ax=axes[0,0]).
+00070130: 0a20 2020 2020 2020 2074 7279 3a0d 0a20  .        try:.. 
+00070140: 2020 2020 2020 2020 2020 2063 6c66 5f72             clf_r
+00070150: 6570 6f72 7420 3d20 636c 6173 7369 6669  eport = classifi
+00070160: 6361 7469 6f6e 5f72 6570 6f72 7428 795f  cation_report(y_
+00070170: 7472 7565 2c0d 0a20 2020 2020 2020 2020  true,..         
+00070180: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00070190: 2020 2020 2020 2020 2020 2020 2020 2020                  
+000701a0: 2020 2020 2020 795f 7072 6564 2c0d 0a20        y_pred,.. 
+000701b0: 2020 2020 2020 2020 2020 2020 2020 2020                  
+000701c0: 2020 2020 2020 2020 2020 2020 2020 2020                  
+000701d0: 2020 2020 2020 2020 2020 2020 2020 6c61                la
+000701e0: 6265 6c73 3d6c 6162 656c 732c 0d0a 2020  bels=labels,..  
+000701f0: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00070200: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00070210: 2020 2020 2020 2020 2020 2020 2074 6172               tar
+00070220: 6765 745f 6e61 6d65 733d 7461 7267 6574  get_names=target
+00070230: 5f6e 616d 6573 2c0d 0a20 2020 2020 2020  _names,..       
+00070240: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00070250: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00070260: 2020 2020 2020 2020 6f75 7470 7574 5f64          output_d
+00070270: 6963 743d 5472 7565 290d 0a20 2020 2020  ict=True)..     
+00070280: 2020 2065 7863 6570 743a 0d0a 2020 2020     except:..    
+00070290: 2020 2020 2020 2020 636c 665f 7265 706f          clf_repo
+000702a0: 7274 203d 2063 6c61 7373 6966 6963 6174  rt = classificat
+000702b0: 696f 6e5f 7265 706f 7274 2879 5f74 7275  ion_report(y_tru
+000702c0: 652c 795f 7072 6564 2c6c 6162 656c 733d  e,y_pred,labels=
+000702d0: 7461 7267 6574 5f6e 616d 6573 2c0d 0a20  target_names,.. 
+000702e0: 2020 2020 2020 2020 2020 2020 2020 2074                 t
+000702f0: 6172 6765 745f 6e61 6d65 733d 6c61 6265  arget_names=labe
+00070300: 6c73 2c6f 7574 7075 745f 6469 6374 3d54  ls,output_dict=T
+00070310: 7275 6529 0d0a 2020 2020 2020 2020 736e  rue)..        sn
+00070320: 732e 6865 6174 6d61 7028 7064 2e44 6174  s.heatmap(pd.Dat
+00070330: 6146 7261 6d65 2863 6c66 5f72 6570 6f72  aFrame(clf_repor
+00070340: 7429 2e69 6c6f 635b 3a2c 203a 5d2e 542c  t).iloc[:, :].T,
+00070350: 2061 6e6e 6f74 3d54 7275 652c 6178 3d61   annot=True,ax=a
+00070360: 7865 735b 312c 315d 2c66 6d74 3d27 302e  xes[1,1],fmt='0.
+00070370: 3266 2729 3b0d 0a20 2020 2020 2020 2061  2f');..        a
+00070380: 7865 735b 312c 315d 2e73 6574 5f74 6974  xes[1,1].set_tit
+00070390: 6c65 2827 436c 6173 7369 6669 6361 7469  le('Classificati
+000703a0: 6f6e 2052 6570 6f72 743a 2025 7327 2025  on Report: %s' %
+000703b0: 6561 6368 5f74 6172 6765 7429 0d0a 2020  each_target)..  
+000703c0: 2020 6578 6365 7074 3a0d 0a20 2020 2020    except:..     
+000703d0: 2020 2070 7269 6e74 2827 4572 726f 723a     print('Error:
+000703e0: 2063 6f75 6c64 206e 6f74 2070 6c6f 7420   could not plot 
+000703f0: 636c 6173 7369 6669 6361 7469 6f6e 2072  classification r
+00070400: 6573 756c 7473 2e20 436f 6e74 696e 7569  esults. Continui
+00070410: 6e67 2e2e 2e27 290d 0a0d 0a66 726f 6d20  ng...')....from 
+00070420: 736b 6c65 6172 6e2e 6d65 7472 6963 7320  sklearn.metrics 
+00070430: 696d 706f 7274 2063 6c61 7373 6966 6963  import classific
+00070440: 6174 696f 6e5f 7265 706f 7274 2c20 636f  ation_report, co
+00070450: 6e66 7573 696f 6e5f 6d61 7472 6978 0d0a  nfusion_matrix..
+00070460: 6672 6f6d 2073 6b6c 6561 726e 2e6d 6574  from sklearn.met
+00070470: 7269 6373 2069 6d70 6f72 7420 6261 6c61  rics import bala
+00070480: 6e63 6564 5f61 6363 7572 6163 795f 7363  nced_accuracy_sc
+00070490: 6f72 650d 0a64 6566 2070 7269 6e74 5f63  ore..def print_c
+000704a0: 6c61 7373 6966 6963 6174 696f 6e5f 6d6f  lassification_mo
+000704b0: 6465 6c5f 7374 6174 7328 795f 7472 7565  del_stats(y_true
+000704c0: 2c20 7072 6564 6963 7465 642c 206d 5f74  , predicted, m_t
+000704d0: 6872 6573 683d 302e 3529 3a0d 0a20 2020  hresh=0.5):..   
+000704e0: 2022 2222 0d0a 2020 2020 5468 6973 2070   """..    This p
+000704f0: 7269 6e74 7320 636c 6173 7369 6669 6361  rints classifica
+00070500: 7469 6f6e 206d 6574 7269 6373 2069 6e20  tion metrics in 
+00070510: 6120 6e69 6365 2066 6f72 6d61 7420 6f6e  a nice format on
+00070520: 6c79 2066 6f72 2062 696e 6172 7920 636c  ly for binary cl
+00070530: 6173 7365 730d 0a20 2020 2022 2222 0d0a  asses..    """..
+00070540: 2020 2020 2320 5573 6520 7468 6973 2074      # Use this t
+00070550: 6f20 5465 7374 2043 6c61 7373 6966 6963  o Test Classific
+00070560: 6174 696f 6e20 5072 6f62 6c65 6d73 204f  ation Problems O
+00070570: 6e6c 7920 2323 2323 0d0a 2020 2020 7472  nly ####..    tr
+00070580: 793a 0d0a 2020 2020 2020 2020 7261 7265  y:..        rare
+00070590: 5f63 6c61 7373 203d 2066 696e 645f 7261  _class = find_ra
+000705a0: 7265 5f63 6c61 7373 2879 5f74 7275 6529  re_class(y_true)
+000705b0: 0d0a 2020 2020 2020 2020 7265 675f 6163  ..        reg_ac
+000705c0: 6320 3d20 5b30 2c30 5d0d 0a20 2020 2020  c = [0,0]..     
+000705d0: 2020 2066 6f72 2069 2c74 6872 6573 686f     for i,thresho
+000705e0: 6c64 2069 6e20 7a69 7028 7261 6e67 6528  ld in zip(range(
+000705f0: 3229 2c20 5b30 2e35 2c20 6d5f 7468 7265  2), [0.5, m_thre
+00070600: 7368 5d29 3a0d 0a20 2020 2020 2020 2020  sh]):..         
+00070610: 2020 2069 6620 7468 7265 7368 6f6c 6420     if threshold 
+00070620: 213d 2030 2e35 3a0d 0a20 2020 2020 2020  != 0.5:..       
+00070630: 2020 2020 2020 2020 2070 7265 6469 6374           predict
+00070640: 6564 205b 3a2c 305d 203d 2028 7072 6564  ed [:,0] = (pred
+00070650: 6963 7465 6420 5b3a 2c30 5d20 3e3d 2028  icted [:,0] >= (
+00070660: 312d 7468 7265 7368 6f6c 6429 292e 6173  1-threshold)).as
+00070670: 7479 7065 2827 696e 7427 290d 0a20 2020  type('int')..   
+00070680: 2020 2020 2020 2020 2020 2020 2070 7265               pre
+00070690: 6469 6374 6564 205b 3a2c 315d 203d 2028  dicted [:,1] = (
+000706a0: 7072 6564 6963 7465 6420 5b3a 2c31 5d20  predicted [:,1] 
+000706b0: 3e3d 2074 6872 6573 686f 6c64 292e 6173  >= threshold).as
+000706c0: 7479 7065 2827 696e 7427 290d 0a20 2020  type('int')..   
+000706d0: 2020 2020 2020 2020 2020 2020 2079 5f70               y_p
+000706e0: 7265 6420 3d20 7072 6564 6963 7465 645b  red = predicted[
+000706f0: 3a2c 7261 7265 5f63 6c61 7373 5d0d 0a20  :,rare_class].. 
+00070700: 2020 2020 2020 2020 2020 2065 6c73 653a             else:
+00070710: 0d0a 2020 2020 2020 2020 2020 2020 2020  ..              
+00070720: 2020 795f 7072 6564 203d 2070 7265 6469    y_pred = predi
+00070730: 6374 6564 2e61 7267 6d61 7828 6178 6973  cted.argmax(axis
+00070740: 3d31 290d 0a20 2020 2020 2020 2020 2020  =1)..           
+00070750: 2070 7269 6e74 2827 4261 6c61 6e63 6564   print('Balanced
+00070760: 2041 6363 7572 6163 7920 3d20 2530 2e32   Accuracy = %0.2
+00070770: 6625 2520 7769 7468 2054 6872 6573 686f  f%% with Thresho
+00070780: 6c64 203d 2025 302e 3266 2720 2528 0d0a  ld = %0.2f' %(..
+00070790: 2020 2020 2020 2020 2020 2020 2020 2020                  
+000707a0: 3130 302a 6261 6c61 6e63 6564 5f61 6363  100*balanced_acc
+000707b0: 7572 6163 795f 7363 6f72 6528 795f 7472  uracy_score(y_tr
+000707c0: 7565 2c20 795f 7072 6564 292c 7468 7265  ue, y_pred),thre
+000707d0: 7368 6f6c 6429 290d 0a20 2020 2020 2020  shold))..       
+000707e0: 2020 2020 2070 7269 6e74 2827 436f 6e66       print('Conf
+000707f0: 7573 696f 6e20 4d61 7472 6978 3a27 290d  usion Matrix:').
+00070800: 0a20 2020 2020 2020 2020 2020 2070 7269  .            pri
+00070810: 6e74 2863 6f6e 6675 7369 6f6e 5f6d 6174  nt(confusion_mat
+00070820: 7269 7828 795f 7472 7565 2c20 795f 7072  rix(y_true, y_pr
+00070830: 6564 2929 0d0a 2020 2020 2020 2020 2020  ed))..          
+00070840: 2020 7072 696e 7428 636c 6173 7369 6669    print(classifi
+00070850: 6361 7469 6f6e 5f72 6570 6f72 7428 795f  cation_report(y_
+00070860: 7472 7565 2c20 795f 7072 6564 2929 0d0a  true, y_pred))..
+00070870: 2020 2020 2020 2020 2020 2020 7265 675f              reg_
+00070880: 6163 635b 695d 203d 2062 616c 616e 6365  acc[i] = balance
+00070890: 645f 6163 6375 7261 6379 5f73 636f 7265  d_accuracy_score
+000708a0: 2879 5f74 7275 652c 2079 5f70 7265 6429  (y_true, y_pred)
+000708b0: 0d0a 2020 2020 2020 2020 7072 696e 7428  ..        print(
+000708c0: 2723 2323 2323 2323 2323 2323 2323 2323  '###############
+000708d0: 2323 2323 2323 2323 2323 2323 2323 2323  ################
+000708e0: 2323 2323 2323 2323 2323 2323 2323 2323  ################
+000708f0: 2323 2323 2323 2323 2323 2323 2323 2323  ################
+00070900: 2323 2323 2323 2729 0d0a 2020 2020 2020  ######')..      
+00070910: 2020 6966 2020 7265 675f 6163 635b 305d    if  reg_acc[0]
+00070920: 203e 3d20 7265 675f 6163 635b 315d 203a   >= reg_acc[1] :
+00070930: 0d0a 2020 2020 2020 2020 2020 2020 7072  ..            pr
+00070940: 696e 7428 2752 6567 756c 6172 2074 6872  int('Regular thr
+00070950: 6573 686f 6c64 203d 2025 302e 3266 2069  eshold = %0.2f i
+00070960: 7320 6265 7474 6572 2720 2530 2e35 290d  s better' %0.5).
+00070970: 0a20 2020 2020 2020 2020 2020 2072 6574  .            ret
+00070980: 7572 6e20 7265 675f 6163 635b 305d 0d0a  urn reg_acc[0]..
+00070990: 2020 2020 2020 2020 656c 7365 3a0d 0a20          else:.. 
+000709a0: 2020 2020 2020 2020 2020 2070 7269 6e74             print
+000709b0: 2827 4d6f 6469 6669 6564 2074 6872 6573  ('Modified thres
+000709c0: 686f 6c64 203d 2025 302e 3266 2069 7320  hold = %0.2f is 
+000709d0: 6265 7474 6572 2720 256d 5f74 6872 6573  better' %m_thres
+000709e0: 6829 0d0a 2020 2020 2020 2020 2020 2020  h)..            
+000709f0: 7265 7475 726e 2072 6567 5f61 6363 5b31  return reg_acc[1
+00070a00: 5d0d 0a20 2020 2065 7863 6570 743a 0d0a  ]..    except:..
+00070a10: 2020 2020 2020 2020 7072 696e 7428 2745          print('E
+00070a20: 7272 6f72 3a20 7072 696e 7469 6e67 2063  rror: printing c
+00070a30: 6c61 7373 6966 6963 6174 696f 6e20 6d6f  lassification mo
+00070a40: 6465 6c20 6d65 7472 6963 732e 2043 6f6e  del metrics. Con
+00070a50: 7469 6e75 696e 672e 2e2e 2729 0d0a 2020  tinuing...')..  
+00070a60: 2020 2020 2020 7265 7475 726e 2030 0d0a        return 0..
+00070a70: 2323 2323 2323 2323 2323 2323 2323 2323  ################
+00070a80: 2323 2323 2323 2323 2323 2323 2323 2323  ################
+00070a90: 2323 2323 2323 2323 2323 2323 2323 2323  ################
+00070aa0: 2323 2323 2323 2323 2323 2323 2323 2323  ################
+00070ab0: 2323 2323 230d 0a23 2323 2323 2020 2020  #####..#####    
+00070ac0: 2052 4547 5245 5353 494f 4e20 4348 4152   REGRESSION CHAR
+00070ad0: 5453 2041 4e44 204d 4554 5249 4353 2041  TS AND METRICS A
+00070ae0: 5245 2050 5249 4e54 4544 2050 4c4f 5454  RE PRINTED PLOTT
+00070af0: 4544 2048 4552 450d 0a23 2323 2323 2323  ED HERE..#######
+00070b00: 2323 2323 2323 2323 2323 2323 2323 2323  ################
+00070b10: 2323 2323 2323 2323 2323 2323 2323 2323  ################
+00070b20: 2323 2323 2323 2323 2323 2323 2323 2323  ################
+00070b30: 2323 2323 2323 2323 2323 2323 2323 0d0a  ##############..
+00070b40: 696d 706f 7274 2074 696d 650d 0a64 6566  import time..def
+00070b50: 2070 6c6f 745f 7265 6772 6573 7369 6f6e   plot_regression
+00070b60: 5f73 6361 7474 6572 7328 6466 2c20 6466  _scatters(df, df
+00070b70: 322c 206e 756d 5f76 6172 732c 206b 696e  2, num_vars, kin
+00070b80: 643d 2773 6361 7474 6572 272c 2070 6c6f  d='scatter', plo
+00070b90: 745f 6e61 6d65 3d27 2729 3a0d 0a20 2020  t_name=''):..   
+00070ba0: 2022 2222 0d0a 2020 2020 4772 6561 7420   """..    Great 
+00070bb0: 7761 7920 746f 2070 6c6f 7420 636f 6e74  way to plot cont
+00070bc0: 696e 756f 7573 2076 6172 6961 626c 6573  inuous variables
+00070bd0: 2066 6173 742e 204a 7573 7420 7365 6e74   fast. Just sent
+00070be0: 2074 6865 6d20 696e 2061 6e64 2069 7420   them in and it 
+00070bf0: 7769 6c6c 2074 616b 6520 6361 7265 206f  will take care o
+00070c00: 6620 7468 6520 7265 7374 210d 0a20 2020  f the rest!..   
+00070c10: 2022 2222 0d0a 2020 2020 6669 6773 697a   """..    figsiz
+00070c20: 6520 3d20 2831 302c 2031 3029 0d0a 2020  e = (10, 10)..  
+00070c30: 2020 636f 6c6f 7273 203d 2063 7963 6c65    colors = cycle
+00070c40: 2827 6279 7263 6d67 6b62 7972 636d 676b  ('byrcmgkbyrcmgk
+00070c50: 6279 7263 6d67 6b62 7972 636d 676b 2729  byrcmgkbyrcmgk')
+00070c60: 0d0a 2020 2020 6e75 6d5f 7661 7273 5f6c  ..    num_vars_l
+00070c70: 656e 203d 206c 656e 286e 756d 5f76 6172  en = len(num_var
+00070c80: 7329 0d0a 2020 2020 636f 6c20 3d20 320d  s)..    col = 2.
+00070c90: 0a20 2020 2073 7461 7274 5f74 696d 6520  .    start_time 
+00070ca0: 3d20 7469 6d65 2e74 696d 6528 290d 0a20  = time.time().. 
+00070cb0: 2020 2072 6f77 203d 206c 656e 286e 756d     row = len(num
+00070cc0: 5f76 6172 7329 0d0a 2020 2020 6669 672c  _vars)..    fig,
+00070cd0: 2061 7820 3d20 706c 742e 7375 6270 6c6f   ax = plt.subplo
+00070ce0: 7473 2872 6f77 2c20 636f 6c29 0d0a 2020  ts(row, col)..  
+00070cf0: 2020 6966 2063 6f6c 203c 2032 3a0d 0a20    if col < 2:.. 
+00070d00: 2020 2020 2020 2066 6967 2e73 6574 5f73         fig.set_s
+00070d10: 697a 655f 696e 6368 6573 286d 696e 2831  ize_inches(min(1
+00070d20: 352c 3829 2c72 6f77 2a35 290d 0a20 2020  5,8),row*5)..   
+00070d30: 2020 2020 2066 6967 2e73 7562 706c 6f74       fig.subplot
+00070d40: 735f 6164 6a75 7374 2868 7370 6163 653d  s_adjust(hspace=
+00070d50: 302e 3529 2023 2323 2054 6869 7320 636f  0.5) ### This co
+00070d60: 6e74 726f 6c73 2074 6865 2073 7061 6365  ntrols the space
+00070d70: 2062 6574 7765 6e20 726f 7773 0d0a 2020   betwen rows..  
+00070d80: 2020 2020 2020 6669 672e 7375 6270 6c6f        fig.subplo
+00070d90: 7473 5f61 646a 7573 7428 7773 7061 6365  ts_adjust(wspace
+00070da0: 3d30 2e33 2920 2323 2320 5468 6973 2063  =0.3) ### This c
+00070db0: 6f6e 7472 6f6c 7320 7468 6520 7370 6163  ontrols the spac
+00070dc0: 6520 6265 7477 6565 6e20 636f 6c75 6d6e  e between column
+00070dd0: 730d 0a20 2020 2065 6c73 653a 0d0a 2020  s..    else:..  
+00070de0: 2020 2020 2020 6669 672e 7365 745f 7369        fig.set_si
+00070df0: 7a65 5f69 6e63 6865 7328 6d69 6e28 636f  ze_inches(min(co
+00070e00: 6c2a 3130 2c32 3029 2c72 6f77 2a35 290d  l*10,20),row*5).
+00070e10: 0a20 2020 2020 2020 2066 6967 2e73 7562  .        fig.sub
+00070e20: 706c 6f74 735f 6164 6a75 7374 2868 7370  plots_adjust(hsp
+00070e30: 6163 653d 302e 3329 2023 2323 2054 6869  ace=0.3) ### Thi
+00070e40: 7320 636f 6e74 726f 6c73 2074 6865 2073  s controls the s
+00070e50: 7061 6365 2062 6574 7765 6e20 726f 7773  pace betwen rows
+00070e60: 0d0a 2020 2020 2020 2020 6669 672e 7375  ..        fig.su
+00070e70: 6270 6c6f 7473 5f61 646a 7573 7428 7773  bplots_adjust(ws
+00070e80: 7061 6365 3d30 2e33 2920 2323 2320 5468  pace=0.3) ### Th
+00070e90: 6973 2063 6f6e 7472 6f6c 7320 7468 6520  is controls the 
+00070ea0: 7370 6163 6520 6265 7477 6565 6e20 636f  space between co
+00070eb0: 6c75 6d6e 730d 0a20 2020 2066 6967 2e73  lumns..    fig.s
+00070ec0: 7570 7469 746c 6528 2752 6567 7265 7373  uptitle('Regress
+00070ed0: 696f 6e20 4d65 7472 6963 7320 506c 6f74  ion Metrics Plot
+00070ee0: 7320 666f 7220 2573 204d 6f64 656c 2720  s for %s Model' 
+00070ef0: 2570 6c6f 745f 6e61 6d65 2c20 666f 6e74  %plot_name, font
+00070f00: 7369 7a65 3d32 3029 0d0a 2020 2020 636f  size=20)..    co
+00070f10: 756e 7465 7220 3d20 300d 0a20 2020 2069  unter = 0..    i
+00070f20: 6620 726f 7720 3d3d 2031 3a0d 0a20 2020  f row == 1:..   
+00070f30: 2020 2020 2061 7820 3d20 6178 2e72 6573       ax = ax.res
+00070f40: 6861 7065 282d 312c 3129 2e54 0d0a 2020  hape(-1,1).T..  
+00070f50: 2020 666f 7220 6b20 696e 206e 702e 6172    for k in np.ar
+00070f60: 616e 6765 2872 6f77 293a 0d0a 2020 2020  ange(row):..    
+00070f70: 2020 2020 726f 775f 636f 6c6f 7220 3d20      row_color = 
+00070f80: 6e65 7874 2863 6f6c 6f72 7329 0d0a 2020  next(colors)..  
+00070f90: 2020 2020 2020 666f 7220 6c20 696e 206e        for l in n
+00070fa0: 702e 6172 616e 6765 2863 6f6c 293a 0d0a  p.arange(col):..
+00070fb0: 2020 2020 2020 2020 2020 2020 7472 793a              try:
+00070fc0: 0d0a 2020 2020 2020 2020 2020 2020 2020  ..              
+00070fd0: 2020 6966 2063 6f6c 3d3d 313a 0d0a 2020    if col==1:..  
+00070fe0: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00070ff0: 2020 6966 2072 6f77 203d 3d20 313a 0d0a    if row == 1:..
+00071000: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00071010: 2020 2020 2020 2020 7820 3d20 6466 5b3a          x = df[:
+00071020: 5d0d 0a20 2020 2020 2020 2020 2020 2020  ]..             
+00071030: 2020 2020 2020 2020 2020 2079 203d 2064             y = d
+00071040: 6632 5b3a 5d0d 0a20 2020 2020 2020 2020  f2[:]..         
+00071050: 2020 2020 2020 2020 2020 2065 6c73 653a             else:
+00071060: 0d0a 2020 2020 2020 2020 2020 2020 2020  ..              
+00071070: 2020 2020 2020 2020 2020 7820 3d20 6466            x = df
+00071080: 5b3a 2c6b 5d0d 0a20 2020 2020 2020 2020  [:,k]..         
+00071090: 2020 2020 2020 2020 2020 2020 2020 2079                 y
+000710a0: 203d 2064 6632 5b3a 2c6b 5d0d 0a20 2020   = df2[:,k]..   
+000710b0: 2020 2020 2020 2020 2020 2020 2020 2020                  
+000710c0: 2061 7831 203d 2061 785b 6b5d 5b6c 5d0d   ax1 = ax[k][l].
+000710d0: 0a20 2020 2020 2020 2020 2020 2020 2020  .               
+000710e0: 2020 2020 206c 696e 6553 7461 7274 203d       lineStart =
+000710f0: 2078 2e6d 696e 2829 0d0a 2020 2020 2020   x.min()..      
+00071100: 2020 2020 2020 2020 2020 2020 2020 6c69                li
+00071110: 6e65 456e 6420 3d20 782e 6d61 7828 290d  neEnd = x.max().
+00071120: 0a20 2020 2020 2020 2020 2020 2020 2020  .               
+00071130: 2020 2020 2061 7831 2e73 6361 7474 6572       ax1.scatter
+00071140: 2878 2c20 792c 2063 6f6c 6f72 3d72 6f77  (x, y, color=row
+00071150: 5f63 6f6c 6f72 290d 0a20 2020 2020 2020  _color)..       
+00071160: 2020 2020 2020 2020 2020 2020 2061 7831               ax1
+00071170: 2e70 6c6f 7428 5b6c 696e 6553 7461 7274  .plot([lineStart
+00071180: 2c20 6c69 6e65 456e 645d 2c20 5b6c 696e  , lineEnd], [lin
+00071190: 6553 7461 7274 2c20 6c69 6e65 456e 645d  eStart, lineEnd]
+000711a0: 2c20 276b 2d27 2c20 636f 6c6f 723d 726f  , 'k-', color=ro
+000711b0: 775f 636f 6c6f 7229 0d0a 2020 2020 2020  w_color)..      
+000711c0: 2020 2020 2020 2020 2020 2020 2020 6178                ax
+000711d0: 312e 7365 745f 786c 6162 656c 2827 4163  1.set_xlabel('Ac
+000711e0: 7475 616c 7327 290d 0a20 2020 2020 2020  tuals')..       
+000711f0: 2020 2020 2020 2020 2020 2020 2061 7831               ax1
+00071200: 2e73 6574 5f79 6c61 6265 6c28 2750 7265  .set_ylabel('Pre
+00071210: 6469 6374 6564 2729 0d0a 2020 2020 2020  dicted')..      
+00071220: 2020 2020 2020 2020 2020 2020 2020 6178                ax
+00071230: 312e 7365 745f 7469 746c 6528 2750 7265  1.set_title('Pre
+00071240: 6469 6374 6564 2076 7320 4163 7475 616c  dicted vs Actual
+00071250: 7320 506c 6f74 2066 6f72 2054 6172 6765  s Plot for Targe
+00071260: 7420 3d20 2573 2720 256e 756d 5f76 6172  t = %s' %num_var
+00071270: 735b 6b5d 290d 0a20 2020 2020 2020 2020  s[k])..         
+00071280: 2020 2020 2020 2065 6c73 653a 0d0a 2020         else:..  
+00071290: 2020 2020 2020 2020 2020 2020 2020 2020                  
+000712a0: 2020 6966 2072 6f77 203d 3d20 313a 0d0a    if row == 1:..
+000712b0: 2020 2020 2020 2020 2020 2020 2020 2020                  
+000712c0: 2020 2020 2020 2020 7820 3d20 6466 5b3a          x = df[:
+000712d0: 5d0d 0a20 2020 2020 2020 2020 2020 2020  ]..             
+000712e0: 2020 2020 2020 2020 2020 2079 203d 2064             y = d
+000712f0: 6632 5b3a 5d0d 0a20 2020 2020 2020 2020  f2[:]..         
+00071300: 2020 2020 2020 2020 2020 2065 6c73 653a             else:
+00071310: 0d0a 2020 2020 2020 2020 2020 2020 2020  ..              
+00071320: 2020 2020 2020 2020 2020 7820 3d20 6466            x = df
+00071330: 5b3a 2c6b 5d0d 0a20 2020 2020 2020 2020  [:,k]..         
+00071340: 2020 2020 2020 2020 2020 2020 2020 2079                 y
+00071350: 203d 2064 6632 5b3a 2c6b 5d0d 0a20 2020   = df2[:,k]..   
+00071360: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00071370: 206c 696e 6553 7461 7274 203d 2078 2e6d   lineStart = x.m
+00071380: 696e 2829 0d0a 2020 2020 2020 2020 2020  in()..          
+00071390: 2020 2020 2020 2020 2020 6c69 6e65 456e            lineEn
+000713a0: 6420 3d20 782e 6d61 7828 290d 0a20 2020  d = x.max()..   
+000713b0: 2020 2020 2020 2020 2020 2020 2020 2020                  
+000713c0: 2069 6620 6c20 3d3d 2030 3a0d 0a20 2020   if l == 0:..   
+000713d0: 2020 2020 2020 2020 2020 2020 2020 2020                  
+000713e0: 2020 2020 2061 7831 203d 2061 785b 6b5d       ax1 = ax[k]
+000713f0: 5b6c 5d0d 0a20 2020 2020 2020 2020 2020  [l]..           
+00071400: 2020 2020 2020 2020 2020 2020 2061 7831               ax1
+00071410: 2e73 6361 7474 6572 2878 2c20 792c 2020  .scatter(x, y,  
+00071420: 636f 6c6f 7220 3d20 726f 775f 636f 6c6f  color = row_colo
+00071430: 7229 0d0a 2020 2020 2020 2020 2020 2020  r)..            
+00071440: 2020 2020 2020 2020 2020 2020 6178 312e              ax1.
+00071450: 706c 6f74 285b 6c69 6e65 5374 6172 742c  plot([lineStart,
+00071460: 206c 696e 6545 6e64 5d2c 205b 6c69 6e65   lineEnd], [line
+00071470: 5374 6172 742c 206c 696e 6545 6e64 5d2c  Start, lineEnd],
+00071480: 2027 6b2d 272c 2063 6f6c 6f72 203d 2072   'k-', color = r
+00071490: 6f77 5f63 6f6c 6f72 290d 0a20 2020 2020  ow_color)..     
+000714a0: 2020 2020 2020 2020 2020 2020 2020 2020                  
+000714b0: 2020 2061 7831 2e73 6574 5f78 6c61 6265     ax1.set_xlabe
+000714c0: 6c28 2741 6374 7561 6c73 2729 0d0a 2020  l('Actuals')..  
+000714d0: 2020 2020 2020 2020 2020 2020 2020 2020                  
+000714e0: 2020 2020 2020 6178 312e 7365 745f 796c        ax1.set_yl
+000714f0: 6162 656c 2827 5072 6564 6963 7465 6427  abel('Predicted'
+00071500: 290d 0a20 2020 2020 2020 2020 2020 2020  )..             
+00071510: 2020 2020 2020 2020 2020 2061 7831 2e73             ax1.s
+00071520: 6574 5f74 6974 6c65 2827 5072 6564 6963  et_title('Predic
+00071530: 7465 6420 7673 2041 6374 7561 6c73 2050  ted vs Actuals P
+00071540: 6c6f 7420 666f 7220 5461 7267 6574 203d  lot for Target =
+00071550: 2025 7327 2025 6e75 6d5f 7661 7273 5b6b   %s' %num_vars[k
+00071560: 5d29 0d0a 2020 2020 2020 2020 2020 2020  ])..            
+00071570: 2020 2020 2020 2020 656c 7365 3a0d 0a20          else:.. 
+00071580: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00071590: 2020 2020 2020 2061 7831 203d 2061 785b         ax1 = ax[
+000715a0: 6b5d 5b6c 5d0d 0a20 2020 2020 2020 2020  k][l]..         
+000715b0: 2020 2020 2020 2020 2020 2020 2020 2061                 a
+000715c0: 7831 2e68 6973 7428 2878 2d79 292c 2064  x1.hist((x-y), d
+000715d0: 656e 7369 7479 3d54 7275 652c 636f 6c6f  ensity=True,colo
+000715e0: 7220 3d20 726f 775f 636f 6c6f 7229 0d0a  r = row_color)..
+000715f0: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00071600: 2020 2020 2020 2020 6178 312e 6178 766c          ax1.axvl
+00071610: 696e 6528 636f 6c6f 723d 276b 2729 0d0a  ine(color='k')..
+00071620: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00071630: 2020 2020 2020 2020 6178 312e 7365 745f          ax1.set_
+00071640: 7469 746c 6528 2752 6573 6964 7561 6c73  title('Residuals
+00071650: 2050 6c6f 7420 666f 7220 5461 7267 6574   Plot for Target
+00071660: 203d 2025 7327 2025 6e75 6d5f 7661 7273   = %s' %num_vars
+00071670: 5b6b 5d29 0d0a 2020 2020 2020 2020 2020  [k])..          
+00071680: 2020 6578 6365 7074 3a0d 0a20 2020 2020    except:..     
+00071690: 2020 2020 2020 2020 2020 2069 6620 636f             if co
+000716a0: 6c20 3d3d 2031 3a0d 0a20 2020 2020 2020  l == 1:..       
+000716b0: 2020 2020 2020 2020 2020 2020 2063 6f75               cou
+000716c0: 6e74 6572 202b 3d20 310d 0a20 2020 2020  nter += 1..     
+000716d0: 2020 2020 2020 2020 2020 2065 6c73 653a             else:
+000716e0: 0d0a 2020 2020 2020 2020 2020 2020 2020  ..              
+000716f0: 2020 2020 2020 6178 5b6b 5d5b 6c5d 2e73        ax[k][l].s
+00071700: 6574 5f74 6974 6c65 2827 4e6f 2050 7265  et_title('No Pre
+00071710: 6469 6374 6564 2076 7320 4163 7475 616c  dicted vs Actual
+00071720: 7320 506c 6f74 2066 6f72 2070 6c6f 7420  s Plot for plot 
+00071730: 6173 2025 7320 6973 206e 6f74 206e 756d  as %s is not num
+00071740: 6572 6963 2720 256e 756d 5f76 6172 735b  eric' %num_vars[
+00071750: 6b5d 290d 0a20 2020 2020 2020 2020 2020  k])..           
+00071760: 2020 2020 2020 2020 2063 6f75 6e74 6572           counter
+00071770: 202b 3d20 310d 0a20 2020 2070 7269 6e74   += 1..    print
+00071780: 2827 5265 6772 6573 7369 6f6e 2050 6c6f  ('Regression Plo
+00071790: 7473 2063 6f6d 706c 6574 6564 2069 6e20  ts completed in 
+000717a0: 2530 2e33 6620 7365 636f 6e64 7327 2025  %0.3f seconds' %
+000717b0: 2874 696d 652e 7469 6d65 2829 2d73 7461  (time.time()-sta
+000717c0: 7274 5f74 696d 6529 290d 0a23 2323 2323  rt_time))..#####
+000717d0: 2323 2323 2323 2323 2323 2323 2323 2323  ################
+000717e0: 2323 2323 2323 2323 2323 2323 2323 2323  ################
+000717f0: 2323 2323 2323 2323 2323 2323 2323 2323  ################
+00071800: 2323 2323 2323 2323 2323 2323 2323 2323  ################
+00071810: 2323 2323 2323 2323 2323 230d 0a64 6566  ###########..def
+00071820: 2070 7269 6e74 5f72 6567 7265 7373 696f   print_regressio
+00071830: 6e5f 6d6f 6465 6c5f 7374 6174 7328 6163  n_model_stats(ac
+00071840: 7475 616c 732c 2070 7265 6469 6374 6564  tuals, predicted
+00071850: 2c20 7461 7267 6574 733d 2727 2c20 706c  , targets='', pl
+00071860: 6f74 5f6e 616d 653d 2727 293a 0d0a 2020  ot_name=''):..  
+00071870: 2020 2222 220d 0a20 2020 2054 6869 7320    """..    This 
+00071880: 7072 6f67 7261 6d20 7072 696e 7473 2061  program prints a
+00071890: 6e64 2072 6574 7572 6e73 204d 4145 2c20  nd returns MAE, 
+000718a0: 524d 5345 2c20 4d41 5045 2e0d 0a20 2020  RMSE, MAPE...   
+000718b0: 2049 6620 796f 7520 6c69 6b65 2074 6865   If you like the
+000718c0: 204d 4145 2061 6e64 2052 4d53 4520 746f   MAE and RMSE to
+000718d0: 2068 6176 6520 6120 7469 746c 6520 6f72   have a title or
+000718e0: 2073 6f6d 6574 6869 6e67 2c20 6a75 7374   something, just
+000718f0: 2067 6976 6520 7468 6174 0d0a 2020 2020   give that..    
+00071900: 696e 2074 6865 2069 6e70 7574 2061 7320  in the input as 
+00071910: 2274 6974 6c65 2220 616e 6420 6974 2077  "title" and it w
+00071920: 696c 6c20 7072 696e 7420 7468 6174 2074  ill print that t
+00071930: 6974 6c65 206f 6e20 7468 6520 4d41 4520  itle on the MAE 
+00071940: 616e 6420 524d 5345 2061 7320 610d 0a20  and RMSE as a.. 
+00071950: 2020 2063 6861 7274 2066 6f72 2074 6861     chart for tha
+00071960: 7420 6d6f 6465 6c2e 2052 6574 7572 6e73  t model. Returns
+00071970: 204d 4145 2c20 4d41 455f 6173 5f70 6572   MAE, MAE_as_per
+00071980: 6365 6e74 6167 652c 2061 6e64 2052 4d53  centage, and RMS
+00071990: 455f 6173 5f70 6572 6365 6e74 6167 650d  E_as_percentage.
+000719a0: 0a20 2020 2022 2222 0d0a 2020 2020 6966  .    """..    if
+000719b0: 2069 7369 6e73 7461 6e63 6528 6163 7475   isinstance(actu
+000719c0: 616c 732c 7064 2e53 6572 6965 7329 206f  als,pd.Series) o
+000719d0: 7220 6973 696e 7374 616e 6365 2861 6374  r isinstance(act
+000719e0: 7561 6c73 2c70 642e 4461 7461 4672 616d  uals,pd.DataFram
+000719f0: 6529 3a0d 0a20 2020 2020 2020 2061 6374  e):..        act
+00071a00: 7561 6c73 203d 2061 6374 7561 6c73 2e76  uals = actuals.v
+00071a10: 616c 7565 730d 0a20 2020 2069 6620 6973  alues..    if is
+00071a20: 696e 7374 616e 6365 2870 7265 6469 6374  instance(predict
+00071a30: 6564 2c70 642e 5365 7269 6573 2920 6f72  ed,pd.Series) or
+00071a40: 2069 7369 6e73 7461 6e63 6528 7072 6564   isinstance(pred
+00071a50: 6963 7465 642c 7064 2e44 6174 6146 7261  icted,pd.DataFra
+00071a60: 6d65 293a 0d0a 2020 2020 2020 2020 7072  me):..        pr
+00071a70: 6564 6963 7465 6420 3d20 7072 6564 6963  edicted = predic
+00071a80: 7465 642e 7661 6c75 6573 0d0a 2020 2020  ted.values..    
+00071a90: 6966 206c 656e 2861 6374 7561 6c73 2920  if len(actuals) 
+00071aa0: 213d 206c 656e 2870 7265 6469 6374 6564  != len(predicted
+00071ab0: 293a 0d0a 2020 2020 2020 2020 7072 696e  ):..        prin
+00071ac0: 7428 2745 7272 6f72 3a20 4e75 6d62 6572  t('Error: Number
+00071ad0: 206f 6620 6163 7475 616c 7320 616e 6420   of actuals and 
+00071ae0: 7072 6564 6963 7465 6420 646f 6e74 206d  predicted dont m
+00071af0: 6174 6368 2e20 436f 6e74 696e 7569 6e67  atch. Continuing
+00071b00: 2e2e 2e27 290d 0a20 2020 2069 6620 7461  ...')..    if ta
+00071b10: 7267 6574 7320 3d3d 2022 223a 0d0a 2020  rgets == "":..  
+00071b20: 2020 2020 2020 7472 793a 0d0a 2020 2020        try:..    
+00071b30: 2020 2020 2020 2020 2323 2320 5468 6973          ### This
+00071b40: 2069 7320 666f 7220 4d75 6c74 695f 4c61   is for Multi_La
+00071b50: 6265 6c20 5072 6f62 6c65 6d73 2023 2323  bel Problems ###
+00071b60: 0d0a 2020 2020 2020 2020 2020 2020 6173  ..            as
+00071b70: 7365 7274 2061 6374 7561 6c73 2e73 6861  sert actuals.sha
+00071b80: 7065 5b31 5d0d 0a20 2020 2020 2020 2020  pe[1]..         
+00071b90: 2020 206d 756c 7469 5f6c 6162 656c 203d     multi_label =
+00071ba0: 2054 7275 650d 0a20 2020 2020 2020 2020   True..         
+00071bb0: 2020 2069 6620 6973 696e 7374 616e 6365     if isinstance
+00071bc0: 2861 6374 7561 6c73 2c70 642e 5365 7269  (actuals,pd.Seri
+00071bd0: 6573 293a 0d0a 2020 2020 2020 2020 2020  es):..          
+00071be0: 2020 2020 2020 636f 6c73 203d 205b 6163        cols = [ac
+00071bf0: 7475 616c 732e 6e61 6d65 5d0d 0a20 2020  tuals.name]..   
+00071c00: 2020 2020 2020 2020 2065 6c69 6620 6973           elif is
+00071c10: 696e 7374 616e 6365 2861 6374 7561 6c73  instance(actuals
+00071c20: 2c70 642e 4461 7461 4672 616d 6529 3a0d  ,pd.DataFrame):.
+00071c30: 0a20 2020 2020 2020 2020 2020 2020 2020  .               
+00071c40: 2063 6f6c 7320 3d20 6163 7475 616c 732e   cols = actuals.
+00071c50: 636f 6c75 6d6e 732e 746f 6c69 7374 2829  columns.tolist()
+00071c60: 0d0a 2020 2020 2020 2020 2020 2020 656c  ..            el
+00071c70: 7365 3a0d 0a20 2020 2020 2020 2020 2020  se:..           
+00071c80: 2020 2020 2063 6f6c 7320 3d20 5b27 7461       cols = ['ta
+00071c90: 7267 6574 5f27 2b73 7472 2869 2920 666f  rget_'+str(i) fo
+00071ca0: 7220 6920 696e 2072 616e 6765 2861 6374  r i in range(act
+00071cb0: 7561 6c73 2e73 6861 7065 5b31 5d29 5d0d  uals.shape[1])].
+00071cc0: 0a20 2020 2020 2020 2065 7863 6570 743a  .        except:
+00071cd0: 0d0a 2020 2020 2020 2020 2020 2020 2323  ..            ##
+00071ce0: 2323 2054 4869 7320 6973 2066 6f72 2053  ## THis is for S
+00071cf0: 696e 676c 6520 4c61 6265 6c20 7072 6f62  ingle Label prob
+00071d00: 6c65 6d73 2023 2323 2323 0d0a 2020 2020  lems #####..    
+00071d10: 2020 2020 2020 2020 6d75 6c74 695f 6c61          multi_la
+00071d20: 6265 6c20 3d20 4661 6c73 650d 0a20 2020  bel = False..   
+00071d30: 2020 2020 2020 2020 2069 6620 6973 696e           if isin
+00071d40: 7374 616e 6365 2861 6374 7561 6c73 2c70  stance(actuals,p
+00071d50: 642e 5365 7269 6573 293a 0d0a 2020 2020  d.Series):..    
+00071d60: 2020 2020 2020 2020 2020 2020 636f 6c73              cols
+00071d70: 203d 205b 6163 7475 616c 732e 6e61 6d65   = [actuals.name
+00071d80: 5d0d 0a20 2020 2020 2020 2020 2020 2065  ]..            e
+00071d90: 6c69 6620 6973 696e 7374 616e 6365 2861  lif isinstance(a
+00071da0: 6374 7561 6c73 2c70 642e 4461 7461 4672  ctuals,pd.DataFr
+00071db0: 616d 6529 3a0d 0a20 2020 2020 2020 2020  ame):..         
+00071dc0: 2020 2020 2020 2063 6f6c 7320 3d20 6163         cols = ac
+00071dd0: 7475 616c 732e 636f 6c75 6d6e 732e 746f  tuals.columns.to
+00071de0: 6c69 7374 2829 0d0a 2020 2020 2020 2020  list()..        
+00071df0: 2020 2020 656c 7365 3a0d 0a20 2020 2020      else:..     
+00071e00: 2020 2020 2020 2020 2020 2063 6f6c 7320             cols 
+00071e10: 3d20 5b27 7461 7267 6574 5f31 275d 0d0a  = ['target_1']..
+00071e20: 2020 2020 656c 7365 3a0d 0a20 2020 2020      else:..     
+00071e30: 2020 2063 6f6c 7320 3d20 636f 7079 2e64     cols = copy.d
+00071e40: 6565 7063 6f70 7928 7461 7267 6574 7329  eepcopy(targets)
+00071e50: 0d0a 2020 2020 2020 2020 6966 2069 7369  ..        if isi
+00071e60: 6e73 7461 6e63 6528 7461 7267 6574 732c  nstance(targets,
+00071e70: 2073 7472 293a 0d0a 2020 2020 2020 2020   str):..        
+00071e80: 2020 2020 636f 6c73 203d 205b 7461 7267      cols = [targ
+00071e90: 6574 735d 0d0a 2020 2020 2020 2020 6966  ets]..        if
+00071ea0: 206c 656e 2863 6f6c 7329 203d 3d20 313a   len(cols) == 1:
+00071eb0: 0d0a 2020 2020 2020 2020 2020 2020 6d75  ..            mu
+00071ec0: 6c74 695f 6c61 6265 6c20 3d20 4661 6c73  lti_label = Fals
+00071ed0: 650d 0a20 2020 2020 2020 2065 6c73 653a  e..        else:
+00071ee0: 0d0a 2020 2020 2020 2020 2020 2020 6d75  ..            mu
+00071ef0: 6c74 695f 6c61 6265 6c20 3d20 5472 7565  lti_label = True
+00071f00: 0d0a 2020 2020 7472 793a 0d0a 2020 2020  ..    try:..    
+00071f10: 2020 2020 706c 6f74 5f72 6567 7265 7373      plot_regress
+00071f20: 696f 6e5f 7363 6174 7465 7273 2861 6374  ion_scatters(act
+00071f30: 7561 6c73 2c70 7265 6469 6374 6564 2c63  uals,predicted,c
+00071f40: 6f6c 732c 706c 6f74 5f6e 616d 653d 706c  ols,plot_name=pl
+00071f50: 6f74 5f6e 616d 6529 0d0a 2020 2020 6578  ot_name)..    ex
+00071f60: 6365 7074 3a0d 0a20 2020 2020 2020 2070  cept:..        p
+00071f70: 7269 6e74 2827 436f 756c 6420 6e6f 7420  rint('Could not 
+00071f80: 6472 6177 2072 6567 7265 7373 696f 6e20  draw regression 
+00071f90: 706c 6f74 2062 7574 2063 6f6e 7469 6e75  plot but continu
+00071fa0: 696e 672e 2e2e 2729 0d0a 2020 2020 6966  ing...')..    if
+00071fb0: 206d 756c 7469 5f6c 6162 656c 3a0d 0a20   multi_label:.. 
+00071fc0: 2020 2020 2020 2066 6f72 2069 2069 6e20         for i in 
+00071fd0: 7261 6e67 6528 6163 7475 616c 732e 7368  range(actuals.sh
+00071fe0: 6170 655b 315d 293a 0d0a 2020 2020 2020  ape[1]):..      
+00071ff0: 2020 2020 2020 6163 7475 616c 735f 7820        actuals_x 
+00072000: 3d20 6163 7475 616c 735b 3a2c 695d 0d0a  = actuals[:,i]..
+00072010: 2020 2020 2020 2020 2020 2020 7472 793a              try:
+00072020: 0d0a 2020 2020 2020 2020 2020 2020 2020  ..              
+00072030: 2020 7072 6564 6963 7465 645f 7820 3d20    predicted_x = 
+00072040: 7072 6564 6963 7465 645b 3a2c 695d 0d0a  predicted[:,i]..
+00072050: 2020 2020 2020 2020 2020 2020 6578 6365              exce
+00072060: 7074 3a0d 0a20 2020 2020 2020 2020 2020  pt:..           
+00072070: 2020 2020 2070 7265 6469 6374 6564 5f78       predicted_x
+00072080: 203d 2070 7265 6469 6374 6564 5b3a 5d0d   = predicted[:].
+00072090: 0a20 2020 2020 2020 2020 2020 2070 7269  .            pri
+000720a0: 6e74 2827 5265 6772 6573 7369 6f6e 204d  nt('Regression M
+000720b0: 6574 7269 6373 2066 6f72 2054 6172 6765  etrics for Targe
+000720c0: 743d 2573 2720 2563 6f6c 735b 695d 290d  t=%s' %cols[i]).
+000720d0: 0a20 2020 2020 2020 2020 2020 206d 6165  .            mae
+000720e0: 2c20 6d61 655f 6173 702c 2072 6d73 655f  , mae_asp, rmse_
+000720f0: 6173 7020 3d20 7072 696e 745f 7265 6772  asp = print_regr
+00072100: 6573 7369 6f6e 5f6d 6574 7269 6373 2861  ession_metrics(a
+00072110: 6374 7561 6c73 5f78 2c20 7072 6564 6963  ctuals_x, predic
+00072120: 7465 645f 7829 0d0a 2020 2020 656c 7365  ted_x)..    else
+00072130: 3a0d 0a20 2020 2020 2020 206d 6165 2c20  :..        mae, 
+00072140: 6d61 655f 6173 702c 2072 6d73 655f 6173  mae_asp, rmse_as
+00072150: 7020 3d20 7072 696e 745f 7265 6772 6573  p = print_regres
+00072160: 7369 6f6e 5f6d 6574 7269 6373 2861 6374  sion_metrics(act
+00072170: 7561 6c73 2c20 7072 6564 6963 7465 6429  uals, predicted)
+00072180: 0d0a 2020 2020 7265 7475 726e 206d 6165  ..    return mae
+00072190: 2c20 6d61 655f 6173 702c 2072 6d73 655f  , mae_asp, rmse_
+000721a0: 6173 700d 0a23 2323 2323 2323 2323 2323  asp..###########
+000721b0: 2323 2323 2323 2323 2323 2323 2323 2323  ################
+000721c0: 2323 2323 2323 2323 2323 2323 2323 2323  ################
+000721d0: 2323 2323 2323 2323 2323 2323 2323 2323  ################
+000721e0: 2323 2323 2323 2323 2323 2323 2323 2323  ################
+000721f0: 2323 2323 230d 0a64 6566 2070 7269 6e74  #####..def print
+00072200: 5f72 6567 7265 7373 696f 6e5f 6d65 7472  _regression_metr
+00072210: 6963 7328 6163 7475 616c 732c 2070 7265  ics(actuals, pre
+00072220: 6469 6374 6564 293a 0d0a 2020 2020 6d61  dicted):..    ma
+00072230: 6520 3d20 6d65 616e 5f61 6273 6f6c 7574  e = mean_absolut
+00072240: 655f 6572 726f 7228 6163 7475 616c 732c  e_error(actuals,
+00072250: 2070 7265 6469 6374 6564 290d 0a20 2020   predicted)..   
+00072260: 206d 6165 5f61 7370 203d 2028 6d65 616e   mae_asp = (mean
+00072270: 5f61 6273 6f6c 7574 655f 6572 726f 7228  _absolute_error(
+00072280: 6163 7475 616c 732c 2070 7265 6469 6374  actuals, predict
+00072290: 6564 292f 6163 7475 616c 732e 7374 6428  ed)/actuals.std(
+000722a0: 2929 2a31 3030 0d0a 2020 2020 726d 7365  ))*100..    rmse
+000722b0: 5f61 7370 203d 2028 6e70 2e73 7172 7428  _asp = (np.sqrt(
+000722c0: 6d65 616e 5f73 7175 6172 6564 5f65 7272  mean_squared_err
+000722d0: 6f72 2861 6374 7561 6c73 2c70 7265 6469  or(actuals,predi
+000722e0: 6374 6564 2929 2f61 6374 7561 6c73 2e73  cted))/actuals.s
+000722f0: 7464 2829 292a 3130 300d 0a20 2020 2072  td())*100..    r
+00072300: 6d73 6520 3d20 7072 696e 745f 726d 7365  mse = print_rmse
+00072310: 2861 6374 7561 6c73 2c20 7072 6564 6963  (actuals, predic
+00072320: 7465 6429 0d0a 2020 2020 5f20 3d20 7072  ted)..    _ = pr
+00072330: 696e 745f 6d61 7065 2861 6374 7561 6c73  int_mape(actuals
+00072340: 2c20 7072 6564 6963 7465 6429 0d0a 2020  , predicted)..  
+00072350: 2020 6d61 7065 203d 2070 7269 6e74 5f6d    mape = print_m
+00072360: 6170 6528 6163 7475 616c 732c 2070 7265  ape(actuals, pre
+00072370: 6469 6374 6564 290d 0a20 2020 2070 7269  dicted)..    pri
+00072380: 6e74 2827 2020 2020 4d41 4520 3d20 2530  nt('    MAE = %0
+00072390: 2e34 6627 2025 6d61 6529 0d0a 2020 2020  .4f' %mae)..    
+000723a0: 7072 696e 7428 2220 2020 204d 4150 4520  print("    MAPE 
+000723b0: 3d20 2530 2e30 6625 2520 284d 4150 4520  = %0.0f%% (MAPE 
+000723c0: 7769 6c6c 2062 6520 7665 7279 2068 6967  will be very hig
+000723d0: 6820 7768 656e 207a 6572 6f73 2069 6e20  h when zeros in 
+000723e0: 6163 7475 616c 7329 2220 2528 6d61 7065  actuals)" %(mape
+000723f0: 2929 0d0a 2020 2020 7072 696e 7428 2720  ))..    print(' 
+00072400: 2020 2052 4d53 4520 3d20 2530 2e34 6627     RMSE = %0.4f'
+00072410: 2025 726d 7365 290d 0a20 2020 2070 7269   %rmse)..    pri
+00072420: 6e74 2827 2020 2020 4e6f 726d 616c 697a  nt('    Normaliz
+00072430: 6564 204d 4145 2028 6173 2025 2520 7374  ed MAE (as %% st
+00072440: 6420 6465 7620 6f66 2041 6374 7561 6c73  d dev of Actuals
+00072450: 2920 3d20 2530 2e30 6625 2527 2025 286d  ) = %0.0f%%' %(m
+00072460: 6165 2f61 6273 2861 6374 7561 6c73 292e  ae/abs(actuals).
+00072470: 7374 6428 292a 3130 3029 290d 0a20 2020  std()*100))..   
+00072480: 2023 204e 6f72 6d61 6c69 7a65 6420 524d   # Normalized RM
+00072490: 5345 2070 7269 6e74 2827 524d 5345 203d  SE print('RMSE =
+000724a0: 207b 3a2c 2e4f 667d 272e 666f 726d 6174   {:,.Of}'.format
+000724b0: 2872 6d73 6529 290d 0a20 2020 2023 7072  (rmse))..    #pr
+000724c0: 696e 7428 2720 2020 204e 6f72 6d61 6c69  int('    Normali
+000724d0: 7a65 6420 524d 5345 2028 2525 206f 6620  zed RMSE (%% of 
+000724e0: 4d69 6e4d 6178 206f 6620 4163 7475 616c  MinMax of Actual
+000724f0: 7329 203d 2025 302e 3066 2525 2720 2528  s) = %0.0f%%' %(
+00072500: 3130 302a 726d 7365 2f61 6273 2861 6374  100*rmse/abs(act
+00072510: 7561 6c73 2e6d 6178 2829 2d61 6374 7561  uals.max()-actua
+00072520: 6c73 2e6d 696e 2829 2929 290d 0a20 2020  ls.min())))..   
+00072530: 2070 7269 6e74 2827 2020 2020 4e6f 726d   print('    Norm
+00072540: 616c 697a 6564 2052 4d53 4520 2825 2520  alized RMSE (%% 
+00072550: 6f66 2053 7464 2044 6576 206f 6620 4163  of Std Dev of Ac
+00072560: 7475 616c 7329 203d 2025 302e 3066 2525  tuals) = %0.0f%%
+00072570: 2720 2528 3130 302a 726d 7365 2f61 6374  ' %(100*rmse/act
+00072580: 7561 6c73 2e73 7464 2829 2929 0d0a 2020  uals.std()))..  
+00072590: 2020 7265 7475 726e 206d 6165 2c20 6d61    return mae, ma
+000725a0: 655f 6173 702c 2072 6d73 655f 6173 700d  e_asp, rmse_asp.
+000725b0: 0a23 2323 2323 2323 2323 2323 2323 2323  .###############
+000725c0: 2323 2323 2323 2323 2323 2323 2323 2323  ################
+000725d0: 2323 2323 2323 2323 2323 2323 2323 2323  ################
+000725e0: 2323 2323 2323 2323 2323 2323 2323 2323  ################
+000725f0: 2323 2323 2323 2323 2323 2323 2323 2323  ################
+00072600: 230d 0a64 6566 2070 7269 6e74 5f73 7461  #..def print_sta
+00072610: 7469 635f 726d 7365 2861 6374 7561 6c2c  tic_rmse(actual,
+00072620: 2070 7265 6469 6374 6564 2c20 7374 6172   predicted, star
+00072630: 745f 6672 6f6d 3d30 2c76 6572 626f 7365  t_from=0,verbose
+00072640: 3d30 293a 0d0a 2020 2020 2222 220d 0a20  =0):..    """.. 
+00072650: 2020 2074 6869 7320 6361 6c63 756c 6174     this calculat
+00072660: 6573 2074 6865 2072 6174 696f 206f 6620  es the ratio of 
+00072670: 7468 6520 726d 7365 2065 7272 6f72 2074  the rmse error t
+00072680: 6f20 7468 6520 7374 616e 6461 7264 2064  o the standard d
+00072690: 6576 6961 7469 6f6e 206f 6620 7468 6520  eviation of the 
+000726a0: 6163 7475 616c 732e 0d0a 2020 2020 5468  actuals...    Th
+000726b0: 6973 2072 6174 696f 2073 686f 756c 6420  is ratio should 
+000726c0: 6265 2062 656c 6f77 2031 2066 6f72 2061  be below 1 for a
+000726d0: 206d 6f64 656c 2074 6f20 6265 2063 6f6e   model to be con
+000726e0: 7369 6465 7265 6420 7573 6566 756c 2e0d  sidered useful..
+000726f0: 0a20 2020 2054 6865 2063 6f6d 7061 7269  .    The compari
+00072700: 736f 6e20 7374 6172 7473 2066 726f 6d20  son starts from 
+00072710: 7468 6520 726f 7720 696e 6469 6361 7465  the row indicate
+00072720: 6420 696e 2074 6865 2022 7374 6172 745f  d in the "start_
+00072730: 6672 6f6d 2220 7661 7269 6162 6c65 2e0d  from" variable..
+00072740: 0a20 2020 2022 2222 0d0a 2020 2020 726d  .    """..    rm
+00072750: 7365 203d 206e 702e 7371 7274 286d 6561  se = np.sqrt(mea
+00072760: 6e5f 7371 7561 7265 645f 6572 726f 7228  n_squared_error(
+00072770: 6163 7475 616c 5b73 7461 7274 5f66 726f  actual[start_fro
+00072780: 6d3a 5d2c 7072 6564 6963 7465 645b 7374  m:],predicted[st
+00072790: 6172 745f 6672 6f6d 3a5d 2929 0d0a 2020  art_from:]))..  
+000727a0: 2020 7374 645f 6465 7620 3d20 6163 7475    std_dev = actu
+000727b0: 616c 5b73 7461 7274 5f66 726f 6d3a 5d2e  al[start_from:].
+000727c0: 7374 6428 290d 0a20 2020 2069 6620 7665  std()..    if ve
+000727d0: 7262 6f73 6520 3e3d 2031 3a0d 0a20 2020  rbose >= 1:..   
+000727e0: 2020 2020 2070 7269 6e74 2827 2020 2020       print('    
+000727f0: 524d 5345 203d 2025 302e 3266 2720 2572  RMSE = %0.2f' %r
+00072800: 6d73 6529 0d0a 2020 2020 2020 2020 7072  mse)..        pr
+00072810: 696e 7428 2720 2020 2053 7464 2044 6576  int('    Std Dev
+00072820: 6961 7469 6f6e 206f 6620 4163 7475 616c  iation of Actual
+00072830: 7320 3d20 2530 2e32 6627 2025 2873 7464  s = %0.2f' %(std
+00072840: 5f64 6576 2929 0d0a 2020 2020 2020 2020  _dev))..        
+00072850: 7072 696e 7428 2720 2020 204e 6f72 6d61  print('    Norma
+00072860: 6c69 7a65 6420 524d 5345 203d 2025 302e  lized RMSE = %0.
+00072870: 3166 2525 2720 2528 726d 7365 2a31 3030  1f%%' %(rmse*100
+00072880: 2f73 7464 5f64 6576 2929 0d0a 2020 2020  /std_dev))..    
+00072890: 7265 7475 726e 2072 6d73 652c 2072 6d73  return rmse, rms
+000728a0: 652f 7374 645f 6465 760d 0a23 2323 2323  e/std_dev..#####
+000728b0: 2323 2323 2323 2323 2323 2323 2323 2323  ################
+000728c0: 2323 2323 2323 2323 2323 2323 2323 2323  ################
+000728d0: 2323 2323 2323 2323 2323 2323 2323 2323  ################
+000728e0: 2323 2323 2323 2323 2323 2323 2323 2323  ################
+000728f0: 2323 2323 2323 2323 2323 230d 0a66 726f  ###########..fro
+00072900: 6d20 736b 6c65 6172 6e2e 6d65 7472 6963  m sklearn.metric
+00072910: 7320 696d 706f 7274 206d 6561 6e5f 7371  s import mean_sq
+00072920: 7561 7265 645f 6572 726f 722c 6d65 616e  uared_error,mean
+00072930: 5f61 6273 6f6c 7574 655f 6572 726f 720d  _absolute_error.
+00072940: 0a64 6566 2070 7269 6e74 5f72 6d73 6528  .def print_rmse(
+00072950: 792c 2079 5f68 6174 293a 0d0a 2020 2020  y, y_hat):..    
+00072960: 2222 220d 0a20 2020 2043 616c 6375 6c61  """..    Calcula
+00072970: 7469 6e67 2052 6f6f 7420 4d65 616e 2053  ting Root Mean S
+00072980: 7175 6172 6520 4572 726f 7220 6874 7470  quare Error http
+00072990: 733a 2f2f 656e 2e77 696b 6970 6564 6961  s://en.wikipedia
+000729a0: 2e6f 7267 2f77 696b 692f 526f 6f74 2d6d  .org/wiki/Root-m
+000729b0: 6561 6e2d 7371 7561 7265 5f64 6576 6961  ean-square_devia
+000729c0: 7469 6f6e 0d0a 2020 2020 2222 220d 0a20  tion..    """.. 
+000729d0: 2020 206d 7365 203d 206e 702e 6d65 616e     mse = np.mean
+000729e0: 2828 7920 2d20 795f 6861 7429 2a2a 3229  ((y - y_hat)**2)
+000729f0: 0d0a 2020 2020 7265 7475 726e 206e 702e  ..    return np.
+00072a00: 7371 7274 286d 7365 290d 0a0d 0a64 6566  sqrt(mse)....def
+00072a10: 2070 7269 6e74 5f6d 6170 6528 792c 2079   print_mape(y, y
+00072a20: 5f68 6174 293a 0d0a 2020 2020 2222 220d  _hat):..    """.
+00072a30: 0a20 2020 2043 616c 6375 6c61 7469 6e67  .    Calculating
+00072a40: 204d 6561 6e20 4162 736f 6c75 7465 2050   Mean Absolute P
+00072a50: 6572 6365 6e74 2045 7272 6f72 2068 7474  ercent Error htt
+00072a60: 7073 3a2f 2f65 6e2e 7769 6b69 7065 6469  ps://en.wikipedi
+00072a70: 612e 6f72 672f 7769 6b69 2f4d 6561 6e5f  a.org/wiki/Mean_
+00072a80: 6162 736f 6c75 7465 5f70 6572 6365 6e74  absolute_percent
+00072a90: 6167 655f 6572 726f 720d 0a20 2020 2054  age_error..    T
+00072aa0: 6f20 6176 6f69 6420 696e 6669 6e69 7479  o avoid infinity
+00072ab0: 2064 7565 2074 6f20 6469 7669 7369 6f6e   due to division
+00072ac0: 2062 7920 7a65 726f 2c20 7765 2073 656c   by zero, we sel
+00072ad0: 6563 7420 6d61 7828 302e 3031 2c20 6162  ect max(0.01, ab
+00072ae0: 7328 6163 7475 616c 7329 2920 746f 2073  s(actuals)) to s
+00072af0: 686f 7720 4d41 5045 2e0d 0a20 2020 2022  how MAPE...    "
+00072b00: 2222 0d0a 2020 2020 2323 2320 5768 6572  ""..    ### Wher
+00072b10: 6576 6572 2074 6865 7265 2069 7320 7a65  ever there is ze
+00072b20: 726f 2c20 7265 706c 6163 6520 6974 2077  ro, replace it w
+00072b30: 6974 6820 302e 3030 3120 736f 2069 7420  ith 0.001 so it 
+00072b40: 646f 6573 6e27 7420 7265 7375 6c74 2069  doesn't result i
+00072b50: 6e20 6469 7669 7369 6f6e 2062 7920 7a65  n division by ze
+00072b60: 726f 0d0a 2020 2020 7065 7263 5f65 7272  ro..    perc_err
+00072b70: 203d 2028 3130 302a 286e 702e 7768 6572   = (100*(np.wher
+00072b80: 6528 793d 3d30 2c30 2e30 3031 2c79 2920  e(y==0,0.001,y) 
+00072b90: 2d20 795f 6861 7429 292f 6e70 2e77 6865  - y_hat))/np.whe
+00072ba0: 7265 2879 3d3d 302c 302e 3030 312c 7929  re(y==0,0.001,y)
+00072bb0: 0d0a 2020 2020 7265 7475 726e 206e 702e  ..    return np.
+00072bc0: 6d65 616e 2861 6273 2870 6572 635f 6572  mean(abs(perc_er
+00072bd0: 7229 290d 0a23 2323 2323 2323 2323 2323  r))..###########
+00072be0: 2323 2323 2323 2323 2323 2323 2323 2323  ################
+00072bf0: 2323 2323 2323 2323 2323 2323 2323 2323  ################
+00072c00: 2323 2323 2323 2323 2323 2323 2323 2323  ################
+00072c10: 2323 2323 2323 2323 2323 2323 2323 2323  ################
+00072c20: 2323 2323 230d 0a66 726f 6d20 736b 6c65  #####..from skle
+00072c30: 6172 6e2e 6d65 7472 6963 7320 696d 706f  arn.metrics impo
+00072c40: 7274 206d 6561 6e5f 6162 736f 6c75 7465  rt mean_absolute
+00072c50: 5f65 7272 6f72 2c20 6d65 616e 5f73 7175  _error, mean_squ
+00072c60: 6172 6564 5f65 7272 6f72 0d0a 6672 6f6d  ared_error..from
+00072c70: 2069 7465 7274 6f6f 6c73 2069 6d70 6f72   itertools impor
+00072c80: 7420 6379 636c 650d 0a69 6d70 6f72 7420  t cycle..import 
+00072c90: 6d61 7470 6c6f 746c 6962 2e70 7970 6c6f  matplotlib.pyplo
+00072ca0: 7420 6173 2070 6c74 0d0a 6465 6620 706c  t as plt..def pl
+00072cb0: 6f74 5f64 6670 6c6f 7428 6466 706c 6f74  ot_dfplot(dfplot
+00072cc0: 2c70 6c6f 745f 7469 746c 653d 2222 293a  ,plot_title=""):
+00072cd0: 0d0a 2020 2020 6669 6773 697a 6520 3d20  ..    figsize = 
+00072ce0: 2831 302c 2031 3029 0d0a 2020 2020 636f  (10, 10)..    co
+00072cf0: 6c6f 7273 203d 2063 7963 6c65 2827 6279  lors = cycle('by
+00072d00: 7263 6d67 6b62 7972 636d 676b 6279 7263  rcmgkbyrcmgkbyrc
+00072d10: 6d67 6b62 7972 636d 676b 2729 0d0a 2020  mgkbyrcmgk')..  
+00072d20: 2020 706c 742e 6669 6775 7265 2866 6967    plt.figure(fig
+00072d30: 7369 7a65 3d66 6967 7369 7a65 290d 0a20  size=figsize).. 
+00072d40: 2020 2061 6374 7561 6c73 203d 2064 6670     actuals = dfp
+00072d50: 6c6f 745b 2741 6374 7561 6c73 275d 0d0a  lot['Actuals']..
+00072d60: 2020 2020 7072 6564 6963 7465 6420 3d20      predicted = 
+00072d70: 2064 6670 6c6f 745b 2750 7265 6469 6374   dfplot['Predict
+00072d80: 6564 275d 0d0a 2020 2020 6c69 6e65 5374  ed']..    lineSt
+00072d90: 6172 7420 3d20 6163 7475 616c 732e 6d69  art = actuals.mi
+00072da0: 6e28 290d 0a20 2020 206c 696e 6545 6e64  n()..    lineEnd
+00072db0: 203d 2061 6374 7561 6c73 2e6d 6178 2829   = actuals.max()
+00072dc0: 0d0a 2020 2020 706c 742e 7363 6174 7465  ..    plt.scatte
+00072dd0: 7228 6163 7475 616c 732c 2070 7265 6469  r(actuals, predi
+00072de0: 6374 6564 2c20 636f 6c6f 7220 3d20 6e65  cted, color = ne
+00072df0: 7874 2863 6f6c 6f72 7329 2c20 616c 7068  xt(colors), alph
+00072e00: 613d 302e 352c 6c61 6265 6c3d 2750 7265  a=0.5,label='Pre
+00072e10: 6469 6374 696f 6e73 2729 0d0a 2020 2020  dictions')..    
+00072e20: 706c 742e 706c 6f74 285b 6c69 6e65 5374  plt.plot([lineSt
+00072e30: 6172 742c 206c 696e 6545 6e64 5d2c 205b  art, lineEnd], [
+00072e40: 6c69 6e65 5374 6172 742c 206c 696e 6545  lineStart, lineE
+00072e50: 6e64 5d2c 2027 6b2d 272c 2063 6f6c 6f72  nd], 'k-', color
+00072e60: 203d 206e 6578 7428 636f 6c6f 7273 2929   = next(colors))
+00072e70: 0d0a 2020 2020 706c 742e 786c 696d 286c  ..    plt.xlim(l
+00072e80: 696e 6553 7461 7274 2c20 6c69 6e65 456e  ineStart, lineEn
+00072e90: 6429 0d0a 2020 2020 706c 742e 796c 696d  d)..    plt.ylim
+00072ea0: 286c 696e 6553 7461 7274 2c20 6c69 6e65  (lineStart, line
+00072eb0: 456e 6429 0d0a 2020 2020 706c 742e 786c  End)..    plt.xl
+00072ec0: 6162 656c 2827 4163 7475 616c 2729 0d0a  abel('Actual')..
+00072ed0: 2020 2020 706c 742e 796c 6162 656c 2827      plt.ylabel('
+00072ee0: 5072 6564 6963 7465 6427 290d 0a20 2020  Predicted')..   
+00072ef0: 2070 6c74 2e6c 6567 656e 6428 290d 0a20   plt.legend().. 
+00072f00: 2020 2070 6c74 2e74 6974 6c65 2827 5072     plt.title('Pr
+00072f10: 6564 6963 7465 6420 7673 2041 6374 7561  edicted vs Actua
+00072f20: 6c73 2066 6f72 2054 6172 6765 7420 3d20  ls for Target = 
+00072f30: 2573 2720 2570 6c6f 745f 7469 746c 652c  %s' %plot_title,
+00072f40: 2066 6f6e 7473 697a 653d 3132 290d 0a20   fontsize=12).. 
+00072f50: 2020 2070 6c74 2e73 686f 7728 293b 0d0a     plt.show();..
+00072f60: 2323 2323 2323 2323 2323 2323 2323 2323  ################
+00072f70: 2323 2323 2323 2323 2323 2323 2323 2323  ################
+00072f80: 2323 2323 2323 2323 2323 2323 2323 2323  ################
+00072f90: 2323 2323 2323 2323 2323 2323 2323 2323  ################
+00072fa0: 2323 2323 2323 2323 2323 2323 2323 230d  ###############.
+00072fb0: 0a66 726f 6d20 636f 6c6c 6563 7469 6f6e  .from collection
+00072fc0: 7320 696d 706f 7274 2064 6566 6175 6c74  s import default
+00072fd0: 6469 6374 0d0a 6465 6620 7265 7475 726e  dict..def return
+00072fe0: 5f6c 6973 745f 6d61 7463 6869 6e67 5f6b  _list_matching_k
+00072ff0: 6579 7328 6469 6374 6f2c 6c69 7374 5f6b  eys(dicto,list_k
+00073000: 6579 7329 3a0d 0a20 2020 2027 2727 5265  eys):..    '''Re
+00073010: 7475 726e 2061 206c 6973 7420 6f66 2076  turn a list of v
+00073020: 616c 7565 7320 6d61 7463 6869 6e67 206b  alues matching k
+00073030: 6579 7320 696e 2061 2064 6963 7469 6f6e  eys in a diction
+00073040: 6172 790d 0a20 2020 2066 726f 6d20 6120  ary..    from a 
+00073050: 6c69 7374 206f 6620 6b65 7973 2e20 5265  list of keys. Re
+00073060: 7475 726e 7320 5661 6c75 6573 2069 6e20  turns Values in 
+00073070: 7468 6520 5361 6d65 206f 7264 6572 2061  the Same order a
+00073080: 7320 7468 6520 4c69 7374 204b 6579 732e  s the List Keys.
+00073090: 0d0a 2020 2020 2727 270d 0a20 2020 2072  ..    '''..    r
+000730a0: 6573 756c 7473 203d 205b 5d0d 0a20 2020  esults = []..   
+000730b0: 2066 6f72 2065 6163 6820 696e 206c 6973   for each in lis
+000730c0: 745f 6b65 7973 3a0d 0a20 2020 2020 2020  t_keys:..       
+000730d0: 2072 6573 756c 7473 2e61 7070 656e 6428   results.append(
+000730e0: 6469 6374 6f5b 6561 6368 5d29 0d0a 2020  dicto[each])..  
+000730f0: 2020 7265 7475 726e 2072 6573 756c 7473    return results
+00073100: 0d0a 2323 2323 2323 2323 2323 2323 2323  ..##############
+00073110: 2323 2323 2323 2323 2323 2323 2323 2323  ################
+00073120: 2323 2323 2323 2323 2323 2323 2323 2323  ################
+00073130: 2323 2323 2323 2323 2323 2323 2323 2323  ################
+00073140: 2323 2323 2323 2323 2323 2323 2323 2323  ################
+00073150: 2323 2323 0d0a 6465 6620 7265 6d6f 7665  ####..def remove
+00073160: 5f68 6967 686c 795f 636f 7272 656c 6174  _highly_correlat
+00073170: 6564 5f76 6172 735f 6661 7374 2864 662c  ed_vars_fast(df,
+00073180: 2063 6f72 725f 6c69 6d69 743d 302e 3730   corr_limit=0.70
+00073190: 293a 0d0a 2020 2020 2222 220d 0a20 2020  ):..    """..   
+000731a0: 2054 6869 7320 6973 2061 2073 696d 706c   This is a simpl
+000731b0: 6520 6d65 7468 6f64 2074 6f20 7265 6d6f  e method to remo
+000731c0: 7665 2068 6967 686c 7920 636f 7272 656c  ve highly correl
+000731d0: 6174 6564 2066 6561 7475 7265 7320 6661  ated features fa
+000731e0: 7374 2075 7369 6e67 2050 6561 7273 6f6e  st using Pearson
+000731f0: 2773 2043 6f72 7265 6c61 7469 6f6e 2e0d  's Correlation..
+00073200: 0a20 2020 2055 7365 2074 6869 7320 6f6e  .    Use this on
+00073210: 6c79 2066 6f72 2066 6c6f 6174 2061 6e64  ly for float and
+00073220: 2069 6e74 6567 6572 2076 6172 6961 626c   integer variabl
+00073230: 6573 2e20 4974 2077 696c 6c20 6175 746f  es. It will auto
+00073240: 6d61 7469 6361 6c6c 7920 7365 6c65 6374  matically select
+00073250: 2074 686f 7365 206f 6e6c 792e 0d0a 2020   those only...  
+00073260: 2020 4974 2063 616e 2062 6520 7573 6564    It can be used
+00073270: 2066 6f72 2076 6572 7920 6c61 7267 6520   for very large 
+00073280: 6461 7461 2073 6574 7320 7768 6572 6520  data sets where 
+00073290: 6665 6174 7572 6577 697a 2068 6173 2074  featurewiz has t
+000732a0: 726f 7562 6c65 2077 6974 6820 6d65 6d6f  rouble with memo
+000732b0: 7279 0d0a 2020 2020 2222 220d 0a20 2020  ry..    """..   
+000732c0: 2023 2043 7265 6174 696e 6720 636f 7272   # Creating corr
+000732d0: 656c 6174 696f 6e20 6d61 7472 6978 0d0a  elation matrix..
+000732e0: 2020 2020 636f 725f 6d61 7472 6978 203d      cor_matrix =
+000732f0: 2064 662e 636f 7272 2829 2e61 6273 2829   df.corr().abs()
+00073300: 2e61 7374 7970 6528 6e70 2e66 6c6f 6174  .astype(np.float
+00073310: 3136 290d 0a20 2020 2023 2053 656c 6563  16)..    # Selec
+00073320: 7469 6e67 2075 7070 6572 2074 7269 616e  ting upper trian
+00073330: 676c 6520 6f66 2063 6f72 7265 6c61 7469  gle of correlati
+00073340: 6f6e 206d 6174 7269 780d 0a20 2020 2075  on matrix..    u
+00073350: 7070 6572 5f74 7269 203d 2063 6f72 5f6d  pper_tri = cor_m
+00073360: 6174 7269 782e 7768 6572 6528 6e70 2e74  atrix.where(np.t
+00073370: 7269 7528 6e70 2e6f 6e65 7328 636f 725f  riu(np.ones(cor_
+00073380: 6d61 7472 6978 2e73 6861 7065 292c 0d0a  matrix.shape),..
+00073390: 2020 2020 2020 2020 2020 2020 2020 2020                  
+000733a0: 2020 2020 2020 2020 2020 2020 2020 2020                  
+000733b0: 2020 6b3d 3129 2e61 7374 7970 6528 6e70    k=1).astype(np
+000733c0: 2e62 6f6f 6c29 290d 0a20 2020 2023 2046  .bool))..    # F
+000733d0: 696e 6469 6e67 2069 6e64 6578 206f 6620  inding index of 
+000733e0: 6665 6174 7572 6520 636f 6c75 6d6e 7320  feature columns 
+000733f0: 7769 7468 2063 6f72 7265 6c61 7469 6f6e  with correlation
+00073400: 2067 7265 6174 6572 2074 6861 6e20 302e   greater than 0.
+00073410: 3935 0d0a 2020 2020 746f 5f64 726f 7020  95..    to_drop 
+00073420: 3d20 5b63 6f6c 756d 6e20 666f 7220 636f  = [column for co
+00073430: 6c75 6d6e 2069 6e20 7570 7065 725f 7472  lumn in upper_tr
+00073440: 692e 636f 6c75 6d6e 7320 6966 2061 6e79  i.columns if any
+00073450: 2875 7070 6572 5f74 7269 5b63 6f6c 756d  (upper_tri[colum
+00073460: 6e5d 203e 2063 6f72 725f 6c69 6d69 7429  n] > corr_limit)
+00073470: 5d0d 0a20 2020 2070 7269 6e74 2829 3b0d  ]..    print();.
+00073480: 0a20 2020 2070 7269 6e74 2827 4869 6768  .    print('High
+00073490: 6c79 2063 6f72 7265 6c61 7465 6420 636f  ly correlated co
+000734a0: 6c75 6d6e 7320 746f 2072 656d 6f76 653a  lumns to remove:
+000734b0: 2025 7327 2025 746f 5f64 726f 7029 0d0a   %s' %to_drop)..
+000734c0: 2020 2020 7265 7475 726e 2074 6f5f 6472      return to_dr
+000734d0: 6f70 0d0a 2323 2323 2323 2323 2323 2323  op..############
+000734e0: 2323 2323 2323 2323 2323 2323 2323 2323  ################
+000734f0: 2323 2323 2323 2323 2323 2323 2323 2323  ################
+00073500: 2323 2323 2323 2323 2323 2323 2323 2323  ################
+00073510: 2323 2323 2323 2323 2323 2323 2323 2323  ################
+00073520: 2323 2323 2323 2323 230d 0a64 6566 2061  #########..def a
+00073530: 6464 5f65 6e74 726f 7079 5f62 696e 6e69  dd_entropy_binni
+00073540: 6e67 2874 656d 705f 7472 6169 6e2c 2074  ng(temp_train, t
+00073550: 6172 672c 206e 756d 5f76 6172 732c 2069  arg, num_vars, i
+00073560: 6d70 6f72 7461 6e74 5f66 6561 7475 7265  mportant_feature
+00073570: 732c 2074 656d 705f 7465 7374 2c0d 0a20  s, temp_test,.. 
+00073580: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00073590: 2020 2020 2020 6d6f 6465 6c74 7970 652c        modeltype,
+000735a0: 2065 6e74 726f 7079 5f62 696e 6e69 6e67   entropy_binning
+000735b0: 2c76 6572 626f 7365 3d30 293a 0d0a 2020  ,verbose=0):..  
+000735c0: 2020 2222 220d 0a20 2020 2020 2020 2023    """..        #
+000735d0: 2323 2323 2320 2020 5468 6973 2069 7320  #####   This is 
+000735e0: 7768 6572 6520 7765 2064 6f20 454e 5452  where we do ENTR
+000735f0: 4f50 5920 4249 4e4e 494e 4720 4f46 2043  OPY BINNING OF C
+00073600: 4f4e 5449 4e55 4f55 5320 5641 5253 2023  ONTINUOUS VARS #
+00073610: 2323 2323 2323 2323 2323 0d0a 2020 2020  ##########..    
+00073620: 2020 2020 2323 2323 2049 7420 6973 2062      #### It is b
+00073630: 6573 7420 746f 2064 6f20 4269 6e6e 696e  est to do Binnin
+00073640: 6720 6f6e 204f 4e4c 5920 6f6e 2074 6865  g on ONLY on the
+00073650: 2074 6f70 206d 6f73 7420 7661 7269 6162   top most variab
+00073660: 6c65 7320 6672 6f6d 2049 6d70 6f72 7461  les from Importa
+00073670: 6e74 5f46 6561 7475 7265 7321 0d0a 2020  nt_Features!..  
+00073680: 2020 2020 2020 2323 2323 204d 616b 6520        #### Make 
+00073690: 7375 7265 2074 6861 7420 7468 6520 546f  sure that the To
+000736a0: 7020 322d 3130 2076 6172 7320 6172 6520  p 2-10 vars are 
+000736b0: 616c 6c20 434f 4e54 494e 554f 5553 2056  all CONTINUOUS V
+000736c0: 4152 5321 204f 7468 6572 7769 7365 2042  ARS! Otherwise B
+000736d0: 696e 6e69 6e67 2069 7320 5761 7374 6521  inning is Waste!
+000736e0: 0d0a 2020 2020 2020 2020 2323 2323 2054  ..        #### T
+000736f0: 6869 7320 6d65 7468 6f64 2065 6e73 7572  his method ensur
+00073700: 6573 2079 6f75 2067 6574 2074 6865 2042  es you get the B
+00073710: 6573 7420 5265 7375 6c74 7320 6279 2067  est Results by g
+00073720: 656e 6572 616c 697a 696e 6720 6f6e 2074  eneralizing on t
+00073730: 6865 2074 6f70 206e 756d 6572 6963 2076  he top numeric v
+00073740: 6172 7321 0d0a 2020 2020 2222 220d 0a20  ars!..    """.. 
+00073750: 2020 2074 656d 705f 7472 6169 6e20 3d20     temp_train = 
+00073760: 636f 7079 2e64 6565 7063 6f70 7928 7465  copy.deepcopy(te
+00073770: 6d70 5f74 7261 696e 290d 0a20 2020 2074  mp_train)..    t
+00073780: 656d 705f 7465 7374 203d 2063 6f70 792e  emp_test = copy.
+00073790: 6465 6570 636f 7079 2874 656d 705f 7465  deepcopy(temp_te
+000737a0: 7374 290d 0a20 2020 206d 6178 5f64 6570  st)..    max_dep
+000737b0: 7468 203d 2031 300d 0a20 2020 2073 6565  th = 10..    see
+000737c0: 6420 3d20 3939 0d0a 2020 2020 6e75 6d5f  d = 99..    num_
+000737d0: 7661 7273 203d 2063 6f70 792e 6465 6570  vars = copy.deep
+000737e0: 636f 7079 286e 756d 5f76 6172 7329 0d0a  copy(num_vars)..
+000737f0: 2020 2020 636f 6e74 696e 756f 7573 5f76      continuous_v
+00073800: 6172 7320 3d20 636f 7079 2e64 6565 7063  ars = copy.deepc
+00073810: 6f70 7928 6e75 6d5f 7661 7273 290d 0a20  opy(num_vars).. 
+00073820: 2020 2069 6d70 6f72 7461 6e74 5f66 6561     important_fea
+00073830: 7475 7265 7320 3d20 636f 7079 2e64 6565  tures = copy.dee
+00073840: 7063 6f70 7928 696d 706f 7274 616e 745f  pcopy(important_
+00073850: 6665 6174 7572 6573 290d 0a20 2020 2070  features)..    p
+00073860: 7269 6e74 2827 4465 7465 726d 696e 696e  rint('Determinin
+00073870: 6720 7768 6963 6820 6f66 2025 6420 636f  g which of %d co
+00073880: 6e74 696e 756f 7573 2076 6172 6961 626c  ntinuous variabl
+00073890: 6573 2073 686f 756c 6420 6265 2045 6e74  es should be Ent
+000738a0: 726f 7079 2042 696e 6e65 642e 2e2e 2720  ropy Binned...' 
+000738b0: 256c 656e 2863 6f6e 7469 6e75 6f75 735f  %len(continuous_
+000738c0: 7661 7273 2929 0d0a 2020 2020 6966 206c  vars))..    if l
+000738d0: 656e 2863 6f6e 7469 6e75 6f75 735f 7661  en(continuous_va
+000738e0: 7273 2920 3e20 3020 616e 6420 6c65 6e28  rs) > 0 and len(
+000738f0: 636f 6e74 696e 756f 7573 5f76 6172 7329  continuous_vars)
+00073900: 203c 3d20 323a 0d0a 2020 2020 2020 2020   <= 2:..        
+00073910: 6d61 785f 6465 7074 6820 3d20 2032 0d0a  max_depth =  2..
+00073920: 2020 2020 2020 2020 636f 6e74 696e 756f          continuo
+00073930: 7573 5f76 6172 7320 3d20 636f 6e74 696e  us_vars = contin
+00073940: 756f 7573 5f76 6172 735b 3a5d 0d0a 2020  uous_vars[:]..  
+00073950: 2020 656c 6966 206c 656e 2863 6f6e 7469    elif len(conti
+00073960: 6e75 6f75 735f 7661 7273 2920 3e20 3220  nuous_vars) > 2 
+00073970: 616e 6420 6c65 6e28 636f 6e74 696e 756f  and len(continuo
+00073980: 7573 5f76 6172 7329 203c 3d20 353a 0d0a  us_vars) <= 5:..
+00073990: 2020 2020 2020 2020 6d61 785f 6465 7074          max_dept
+000739a0: 6820 3d20 6c65 6e28 636f 6e74 696e 756f  h = len(continuo
+000739b0: 7573 5f76 6172 7329 202d 2032 0d0a 2020  us_vars) - 2..  
+000739c0: 2020 2020 2020 636f 6e74 696e 756f 7573        continuous
+000739d0: 5f76 6172 7320 3d20 636f 6e74 696e 756f  _vars = continuo
+000739e0: 7573 5f76 6172 735b 3a32 5d0d 0a20 2020  us_vars[:2]..   
+000739f0: 2065 6c69 6620 6c65 6e28 636f 6e74 696e   elif len(contin
+00073a00: 756f 7573 5f76 6172 7329 203e 2035 2061  uous_vars) > 5 a
+00073a10: 6e64 206c 656e 2863 6f6e 7469 6e75 6f75  nd len(continuou
+00073a20: 735f 7661 7273 2920 3c3d 2031 303a 0d0a  s_vars) <= 10:..
+00073a30: 2020 2020 2020 2020 6d61 785f 6465 7074          max_dept
+00073a40: 6820 3d20 350d 0a20 2020 2020 2020 2063  h = 5..        c
+00073a50: 6f6e 7469 6e75 6f75 735f 7661 7273 203d  ontinuous_vars =
+00073a60: 2063 6f6e 7469 6e75 6f75 735f 7661 7273   continuous_vars
+00073a70: 5b3a 355d 0d0a 2020 2020 656c 6966 206c  [:5]..    elif l
+00073a80: 656e 2863 6f6e 7469 6e75 6f75 735f 7661  en(continuous_va
+00073a90: 7273 2920 3e20 3130 2061 6e64 206c 656e  rs) > 10 and len
+00073aa0: 2863 6f6e 7469 6e75 6f75 735f 7661 7273  (continuous_vars
+00073ab0: 2920 3c3d 2035 303a 0d0a 2020 2020 2020  ) <= 50:..      
+00073ac0: 2020 6d61 785f 6465 7074 6820 3d20 6d61    max_depth = ma
+00073ad0: 785f 6465 7074 680d 0a20 2020 2020 2020  x_depth..       
+00073ae0: 2063 6f6e 7469 6e75 6f75 735f 7661 7273   continuous_vars
+00073af0: 203d 2063 6f6e 7469 6e75 6f75 735f 7661   = continuous_va
+00073b00: 7273 5b3a 3130 5d0d 0a20 2020 2065 6c73  rs[:10]..    els
+00073b10: 653a 0d0a 2020 2020 2020 2020 6d61 785f  e:..        max_
+00073b20: 6465 7074 6820 3d20 6d61 785f 6465 7074  depth = max_dept
+00073b30: 680d 0a20 2020 2020 2020 2063 6f6e 7469  h..        conti
+00073b40: 6e75 6f75 735f 7661 7273 203d 2063 6f6e  nuous_vars = con
+00073b50: 7469 6e75 6f75 735f 7661 7273 5b3a 3530  tinuous_vars[:50
+00073b60: 5d0d 0a20 2020 206e 6577 5f62 696e 636f  ]..    new_binco
+00073b70: 6c73 203d 205b 5d0d 0a20 2020 2023 2323  ls = []..    ###
+00073b80: 2020 2054 6869 7320 6973 2061 6e20 4177     This is an Aw
+00073b90: 6573 6f6d 6520 456e 7472 6f70 7920 4261  esome Entropy Ba
+00073ba0: 7365 6420 4269 6e6e 696e 6720 4d65 7468  sed Binning Meth
+00073bb0: 6f64 2066 6f72 2043 6f6e 7469 6e75 6f75  od for Continuou
+00073bc0: 7320 5661 7269 6162 6c65 7320 2323 2323  s Variables ####
+00073bd0: 2323 2323 2323 230d 0a20 2020 2066 726f  #######..    fro
+00073be0: 6d20 736b 6c65 6172 6e2e 7472 6565 2069  m sklearn.tree i
+00073bf0: 6d70 6f72 7420 4465 6369 7369 6f6e 5472  mport DecisionTr
+00073c00: 6565 5265 6772 6573 736f 722c 2044 6563  eeRegressor, Dec
+00073c10: 6973 696f 6e54 7265 6543 6c61 7373 6966  isionTreeClassif
+00073c20: 6965 720d 0a20 2020 2069 6620 6d6f 6465  ier..    if mode
+00073c30: 6c74 7970 6520 3d3d 2027 5265 6772 6573  ltype == 'Regres
+00073c40: 7369 6f6e 273a 0d0a 2020 2020 2020 2020  sion':..        
+00073c50: 636c 6620 3d20 4465 6369 7369 6f6e 5472  clf = DecisionTr
+00073c60: 6565 5265 6772 6573 736f 7228 6372 6974  eeRegressor(crit
+00073c70: 6572 696f 6e3d 276d 7365 272c 6d69 6e5f  erion='mse',min_
+00073c80: 7361 6d70 6c65 735f 6c65 6166 3d32 2c0d  samples_leaf=2,.
+00073c90: 0a20 2020 2020 2020 2020 2020 2020 2020  .               
+00073ca0: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00073cb0: 2020 2020 206d 6178 5f64 6570 7468 3d6d       max_depth=m
+00073cc0: 6178 5f64 6570 7468 2c0d 0a20 2020 2020  ax_depth,..     
+00073cd0: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00073ce0: 2020 2020 2020 2020 2020 2020 2020 2072                 r
+00073cf0: 616e 646f 6d5f 7374 6174 653d 7365 6564  andom_state=seed
+00073d00: 290d 0a20 2020 2065 6c73 653a 0d0a 2020  )..    else:..  
+00073d10: 2020 2020 2020 636c 6620 3d20 4465 6369        clf = Deci
+00073d20: 7369 6f6e 5472 6565 436c 6173 7369 6669  sionTreeClassifi
+00073d30: 6572 2863 7269 7465 7269 6f6e 3d27 656e  er(criterion='en
+00073d40: 7472 6f70 7927 2c6d 696e 5f73 616d 706c  tropy',min_sampl
+00073d50: 6573 5f6c 6561 663d 322c 0d0a 2020 2020  es_leaf=2,..    
+00073d60: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00073d70: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00073d80: 2020 2020 206d 6178 5f64 6570 7468 3d6d       max_depth=m
+00073d90: 6178 5f64 6570 7468 2c0d 0a20 2020 2020  ax_depth,..     
+00073da0: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00073db0: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00073dc0: 2020 2020 7261 6e64 6f6d 5f73 7461 7465      random_state
+00073dd0: 3d73 6565 6429 0d0a 2020 2020 656e 7472  =seed)..    entr
+00073de0: 6f70 795f 7468 7265 7368 6f6c 6420 3d20  opy_threshold = 
+00073df0: 5b5d 0d0a 2020 2020 2323 2323 2323 2320  []..    ####### 
+00073e00: 5468 6973 2069 7320 7768 6572 6520 7765  This is where we
+00073e10: 2062 696e 2065 6163 6820 7661 7269 6162   bin each variab
+00073e20: 6c65 2074 6872 6f75 6768 2061 206d 6574  le through a met
+00073e30: 686f 6420 6b6e 6f77 6e20 6173 2045 6e74  hod known as Ent
+00073e40: 726f 7079 2042 696e 6e69 6e67 2023 2323  ropy Binning ###
+00073e50: 2323 2323 2323 2323 2323 230d 0a20 2020  ###########..   
+00073e60: 2066 6f72 2065 6163 685f 6e75 6d20 696e   for each_num in
+00073e70: 2063 6f6e 7469 6e75 6f75 735f 7661 7273   continuous_vars
+00073e80: 3a0d 0a20 2020 2020 2020 2074 7279 3a0d  :..        try:.
+00073e90: 0a20 2020 2020 2020 2020 2020 2063 6c66  .            clf
+00073ea0: 2e66 6974 2874 656d 705f 7472 6169 6e5b  .fit(temp_train[
+00073eb0: 6561 6368 5f6e 756d 5d2e 7661 6c75 6573  each_num].values
+00073ec0: 2e72 6573 6861 7065 282d 312c 3129 2c74  .reshape(-1,1),t
+00073ed0: 656d 705f 7472 6169 6e5b 7461 7267 5d2e  emp_train[targ].
+00073ee0: 7661 6c75 6573 290d 0a20 2020 2020 2020  values)..       
+00073ef0: 2020 2020 2065 6e74 726f 7079 5f74 6872       entropy_thr
+00073f00: 6573 686f 6c64 203d 2063 6c66 2e74 7265  eshold = clf.tre
+00073f10: 655f 2e74 6872 6573 686f 6c64 5b63 6c66  e_.threshold[clf
+00073f20: 2e74 7265 655f 2e74 6872 6573 686f 6c64  .tree_.threshold
+00073f30: 3e2d 325d 0d0a 2020 2020 2020 2020 2020  >-2]..          
+00073f40: 2020 656e 7472 6f70 795f 7468 7265 7368    entropy_thresh
+00073f50: 6f6c 6420 3d20 6e70 2e73 6f72 7428 656e  old = np.sort(en
+00073f60: 7472 6f70 795f 7468 7265 7368 6f6c 6429  tropy_threshold)
+00073f70: 0d0a 2020 2020 2020 2020 2020 2020 6966  ..            if
+00073f80: 2069 7369 6e73 7461 6e63 6528 6561 6368   isinstance(each
+00073f90: 5f6e 756d 2c20 7374 7229 3a0d 0a20 2020  _num, str):..   
+00073fa0: 2020 2020 2020 2020 2020 2020 2062 696e               bin
+00073fb0: 636f 6c20 3d20 6561 6368 5f6e 756d 2b27  col = each_num+'
+00073fc0: 5f62 696e 270d 0a20 2020 2020 2020 2020  _bin'..         
+00073fd0: 2020 2020 2020 2074 656d 705f 7472 6169         temp_trai
+00073fe0: 6e5b 6269 6e63 6f6c 5d20 3d20 6e70 2e64  n[bincol] = np.d
+00073ff0: 6967 6974 697a 6528 7465 6d70 5f74 7261  igitize(temp_tra
+00074000: 696e 5b65 6163 685f 6e75 6d5d 2e76 616c  in[each_num].val
+00074010: 7565 732c 2065 6e74 726f 7079 5f74 6872  ues, entropy_thr
+00074020: 6573 686f 6c64 290d 0a20 2020 2020 2020  eshold)..       
+00074030: 2020 2020 2065 6c73 653a 0d0a 2020 2020       else:..    
+00074040: 2020 2020 2020 2020 2020 2020 6269 6e63              binc
+00074050: 6f6c 203d 2027 6269 6e5f 272b 7374 7228  ol = 'bin_'+str(
+00074060: 6561 6368 5f6e 756d 290d 0a20 2020 2020  each_num)..     
+00074070: 2020 2020 2020 2020 2020 2074 656d 705f             temp_
+00074080: 7472 6169 6e5b 6269 6e63 6f6c 5d20 3d20  train[bincol] = 
+00074090: 6e70 2e64 6967 6974 697a 6528 7465 6d70  np.digitize(temp
+000740a0: 5f74 7261 696e 5b65 6163 685f 6e75 6d5d  _train[each_num]
+000740b0: 2e76 616c 7565 732c 2065 6e74 726f 7079  .values, entropy
+000740c0: 5f74 6872 6573 686f 6c64 290d 0a20 2020  _threshold)..   
+000740d0: 2020 2020 2020 2020 2023 2323 2320 5765           #### We
+000740e0: 2044 726f 7020 7468 6520 6f72 6967 696e   Drop the origin
+000740f0: 616c 2063 6f6e 7469 6e75 6f75 7320 7661  al continuous va
+00074100: 7269 6162 6c65 2061 6674 6572 2079 6f75  riable after you
+00074110: 2068 6176 6520 6372 6561 7465 6420 7468   have created th
+00074120: 6520 6269 6e20 7768 656e 2046 6c61 6720  e bin when Flag 
+00074130: 6973 2074 7275 650d 0a20 2020 2020 2020  is true..       
+00074140: 2020 2020 2023 2323 2057 6520 446f 6e27       ### We Don'
+00074150: 7420 6472 6f70 2074 6865 7365 206f 7269  t drop these ori
+00074160: 6769 6e61 6c20 6e75 6d65 7269 6320 7661  ginal numeric va
+00074170: 7273 2073 696e 6365 2074 6865 7920 7769  rs since they wi
+00074180: 6c6c 2062 6520 7573 6564 206c 6174 6572  ll be used later
+00074190: 2066 6f72 2066 756c 6c20 7472 6169 6e20   for full train 
+000741a0: 6269 6e6e 696e 670d 0a20 2020 2020 2020  binning..       
+000741b0: 2020 2020 2069 6620 7479 7065 2874 656d       if type(tem
+000741c0: 705f 7465 7374 2920 213d 2073 7472 3a0d  p_test) != str:.
+000741d0: 0a20 2020 2020 2020 2020 2020 2020 2020  .               
+000741e0: 2069 6620 6973 696e 7374 616e 6365 2865   if isinstance(e
+000741f0: 6163 685f 6e75 6d2c 2073 7472 293a 0d0a  ach_num, str):..
+00074200: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00074210: 2020 2020 6269 6e63 6f6c 203d 2065 6163      bincol = eac
+00074220: 685f 6e75 6d2b 275f 6269 6e27 0d0a 2020  h_num+'_bin'..  
+00074230: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00074240: 2020 7465 6d70 5f74 6573 745b 6269 6e63    temp_test[binc
+00074250: 6f6c 5d20 3d20 6e70 2e64 6967 6974 697a  ol] = np.digitiz
+00074260: 6528 7465 6d70 5f74 6573 745b 6561 6368  e(temp_test[each
+00074270: 5f6e 756d 5d2e 7661 6c75 6573 2c20 656e  _num].values, en
+00074280: 7472 6f70 795f 7468 7265 7368 6f6c 6429  tropy_threshold)
+00074290: 0d0a 2020 2020 2020 2020 2020 2020 2020  ..              
+000742a0: 2020 656c 7365 3a0d 0a20 2020 2020 2020    else:..       
+000742b0: 2020 2020 2020 2020 2020 2020 2062 696e               bin
+000742c0: 636f 6c20 3d20 2762 696e 5f27 2b73 7472  col = 'bin_'+str
+000742d0: 2865 6163 685f 6e75 6d29 0d0a 2020 2020  (each_num)..    
+000742e0: 2020 2020 2020 2020 2020 2020 2020 2020                  
+000742f0: 7465 6d70 5f74 6573 745b 6269 6e63 6f6c  temp_test[bincol
+00074300: 5d20 3d20 6e70 2e64 6967 6974 697a 6528  ] = np.digitize(
+00074310: 7465 6d70 5f74 6573 745b 6561 6368 5f6e  temp_test[each_n
+00074320: 756d 5d2e 7661 6c75 6573 2c20 656e 7472  um].values, entr
+00074330: 6f70 795f 7468 7265 7368 6f6c 6429 0d0a  opy_threshold)..
+00074340: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00074350: 2323 2323 2057 6520 4472 6f70 2074 6865  #### We Drop the
+00074360: 206f 7269 6769 6e61 6c20 636f 6e74 696e   original contin
+00074370: 756f 7573 2076 6172 6961 626c 6520 6166  uous variable af
+00074380: 7465 7220 796f 7520 6861 7665 2063 7265  ter you have cre
+00074390: 6174 6564 2074 6865 2062 696e 2077 6865  ated the bin whe
+000743a0: 6e20 466c 6167 2069 7320 7472 7565 0d0a  n Flag is true..
+000743b0: 2020 2020 2020 2020 2020 2020 2020 2020                  
+000743c0: 2323 2320 5765 2044 6f6e 2774 2064 726f  ### We Don't dro
+000743d0: 7020 7468 6573 6520 6f72 6967 696e 616c  p these original
+000743e0: 206e 756d 6572 6963 2076 6172 7320 7369   numeric vars si
+000743f0: 6e63 6520 7468 6579 2077 696c 6c20 6265  nce they will be
+00074400: 2075 7365 6420 6c61 7465 7220 666f 7220   used later for 
+00074410: 6675 6c6c 2074 7261 696e 2062 696e 6e69  full train binni
+00074420: 6e67 0d0a 2020 2020 2020 2020 2020 2020  ng..            
+00074430: 6966 2065 6e74 726f 7079 5f62 696e 6e69  if entropy_binni
+00074440: 6e67 3a0d 0a20 2020 2020 2020 2020 2020  ng:..           
+00074450: 2020 2020 2023 2323 2049 6e20 7468 6520       ### In the 
+00074460: 7365 636f 6e64 2074 696d 652c 2077 6520  second time, we 
+00074470: 646f 6e27 7420 7265 7065 6174 2061 6464  don't repeat add
+00074480: 696e 6720 6269 6e6e 6564 2076 6172 7320  ing binned vars 
+00074490: 7369 6e63 6520 7468 6579 2068 6176 6520  since they have 
+000744a0: 616c 7265 6164 7920 6265 656e 2061 6464  already been add
+000744b0: 6564 210d 0a20 2020 2020 2020 2020 2020  ed!..           
+000744c0: 2020 2020 2023 2323 2320 7765 2061 6c73       #### we als
+000744d0: 6f20 6d61 6b65 2073 7572 6520 7468 6174  o make sure that
+000744e0: 2074 6865 206f 7269 6720 6e75 6d20 7661   the orig num va
+000744f0: 7273 2077 6869 6368 2068 6176 6520 6e6f  rs which have no
+00074500: 7720 6265 656e 2062 696e 6e65 6420 6172  w been binned ar
+00074510: 6520 7265 6d6f 7665 6421 0d0a 2020 2020  e removed!..    
+00074520: 2020 2020 2020 2020 2020 2020 7465 6d70              temp
+00074530: 5f74 7261 696e 2e64 726f 7028 6561 6368  _train.drop(each
+00074540: 5f6e 756d 2c61 7869 733d 312c 696e 706c  _num,axis=1,inpl
+00074550: 6163 653d 5472 7565 290d 0a20 2020 2020  ace=True)..     
+00074560: 2020 2020 2020 2020 2020 2069 6620 7479             if ty
+00074570: 7065 2874 656d 705f 7465 7374 2920 213d  pe(temp_test) !=
+00074580: 2073 7472 3a0d 0a20 2020 2020 2020 2020   str:..         
+00074590: 2020 2020 2020 2020 2020 2074 656d 705f             temp_
+000745a0: 7465 7374 2e64 726f 7028 6561 6368 5f6e  test.drop(each_n
+000745b0: 756d 2c61 7869 733d 312c 696e 706c 6163  um,axis=1,inplac
+000745c0: 653d 5472 7565 290d 0a20 2020 2020 2020  e=True)..       
+000745d0: 2020 2020 2065 6c73 653a 0d0a 2020 2020       else:..    
+000745e0: 2020 2020 2020 2020 2020 2020 2323 2323              ####
+000745f0: 2049 6e20 7468 6520 6669 7273 7420 7469   In the first ti
+00074600: 6d65 2c20 7765 2061 6464 2062 696e 6e65  me, we add binne
+00074610: 6420 7661 7273 2074 6f20 2069 6d70 6f72  d vars to  impor
+00074620: 7461 6e74 5f66 6561 7475 7265 7320 2023  tant_features  #
+00074630: 2323 0d0a 2020 2020 2020 2020 2020 2020  ##..            
+00074640: 2020 2020 2323 2320 496e 2074 6865 2073      ### In the s
+00074650: 6563 6f6e 6420 7469 6d65 2c20 7765 2064  econd time, we d
+00074660: 6f6e 2774 2072 6570 6561 7420 7468 6174  on't repeat that
+00074670: 2073 696e 6365 2074 6865 7920 6861 7665   since they have
+00074680: 2061 6c72 6561 6479 2062 6565 6e20 6164   already been ad
+00074690: 6465 6421 0d0a 2020 2020 2020 2020 2020  ded!..          
+000746a0: 2020 2020 2020 696d 706f 7274 616e 745f        important_
+000746b0: 6665 6174 7572 6573 2e61 7070 656e 6428  features.append(
+000746c0: 6269 6e63 6f6c 290d 0a20 2020 2020 2020  bincol)..       
+000746d0: 2020 2020 206e 756d 5f76 6172 732e 6170       num_vars.ap
+000746e0: 7065 6e64 2862 696e 636f 6c29 0d0a 2020  pend(bincol)..  
+000746f0: 2020 2020 2020 2020 2020 696d 706f 7274            import
+00074700: 616e 745f 6665 6174 7572 6573 2e72 656d  ant_features.rem
+00074710: 6f76 6528 6561 6368 5f6e 756d 290d 0a20  ove(each_num).. 
+00074720: 2020 2020 2020 2020 2020 2023 2323 2320             #### 
+00074730: 4472 6f70 2074 6865 7365 206f 7269 6769  Drop these origi
+00074740: 6e61 6c20 636f 6e74 696e 756f 7573 2076  nal continuous v
+00074750: 6172 6961 626c 6520 6672 6f6d 2066 7572  ariable from fur
+00074760: 7468 6572 2063 6f6e 7369 6465 7261 7469  ther considerati
+00074770: 6f6e 2074 6861 7427 7320 616c 6c21 2023  on that's all! #
+00074780: 2323 0d0a 2020 2020 2020 2020 2020 2020  ##..            
+00074790: 6e75 6d5f 7661 7273 2e72 656d 6f76 6528  num_vars.remove(
+000747a0: 6561 6368 5f6e 756d 290d 0a20 2020 2020  each_num)..     
+000747b0: 2020 2020 2020 206e 6577 5f62 696e 636f         new_binco
+000747c0: 6c73 2e61 7070 656e 6428 6269 6e63 6f6c  ls.append(bincol
+000747d0: 290d 0a20 2020 2020 2020 2065 7863 6570  )..        excep
+000747e0: 743a 0d0a 2020 2020 2020 2020 2020 2020  t:..            
+000747f0: 7072 696e 7428 2745 7272 6f72 2069 6e20  print('Error in 
+00074800: 2573 2064 7572 696e 6720 456e 7472 6f70  %s during Entrop
+00074810: 7920 4269 6e6e 696e 6727 2025 6561 6368  y Binning' %each
+00074820: 5f6e 756d 290d 0a20 2020 2070 7269 6e74  _num)..    print
+00074830: 2827 2020 2020 5365 6c65 6374 6564 2061  ('    Selected a
+00074840: 6e64 2062 696e 6e65 6420 6f6e 6c79 2074  nd binned only t
+00074850: 6f70 2025 7320 636f 6e74 696e 756f 7573  op %s continuous
+00074860: 2076 6172 6961 626c 6573 2e27 2025 286c   variables.' %(l
+00074870: 656e 286e 6577 5f62 696e 636f 6c73 2929  en(new_bincols))
+00074880: 290d 0a20 2020 2069 6620 7665 7262 6f73  )..    if verbos
+00074890: 6520 616e 6420 6c65 6e28 6e65 775f 6269  e and len(new_bi
+000748a0: 6e63 6f6c 7329 203c 3d20 3330 3a0d 0a20  ncols) <= 30:.. 
+000748b0: 2020 2020 2020 2070 7269 6e74 2827 2020         print('  
+000748c0: 2020 2573 2720 256e 6577 5f62 696e 636f    %s' %new_binco
+000748d0: 6c73 290d 0a20 2020 2072 6574 7572 6e20  ls)..    return 
+000748e0: 7465 6d70 5f74 7261 696e 2c20 6e75 6d5f  temp_train, num_
+000748f0: 7661 7273 2c20 696d 706f 7274 616e 745f  vars, important_
+00074900: 6665 6174 7572 6573 2c20 7465 6d70 5f74  features, temp_t
+00074910: 6573 740d 0a23 2323 2323 2323 2323 2323  est..###########
+00074920: 2323 2323 2323 2323 2323 2323 2323 2323  ################
+00074930: 2323 2323 2323 2323 2323 2323 2323 2323  ################
+00074940: 2323 2323 2323 2323 2323 2323 2323 2323  ################
+00074950: 2323 2323 2323 2323 2323 2323 2323 2323  ################
+00074960: 2323 0d0a 6672 6f6d 2073 6b6c 6561 726e  ##..from sklearn
+00074970: 2e62 6173 6520 696d 706f 7274 2042 6173  .base import Bas
+00074980: 6545 7374 696d 6174 6f72 2c20 436c 6173  eEstimator, Clas
+00074990: 7369 6669 6572 4d69 7869 6e2c 2054 7261  sifierMixin, Tra
+000749a0: 6e73 666f 726d 6572 4d69 7869 6e0d 0a66  nsformerMixin..f
+000749b0: 726f 6d20 696d 626c 6561 726e 2e6f 7665  rom imblearn.ove
+000749c0: 725f 7361 6d70 6c69 6e67 2069 6d70 6f72  r_sampling impor
+000749d0: 7420 534d 4f54 452c 2053 564d 534d 4f54  t SMOTE, SVMSMOT
+000749e0: 450d 0a66 726f 6d20 696d 626c 6561 726e  E..from imblearn
+000749f0: 2e6f 7665 725f 7361 6d70 6c69 6e67 2069  .over_sampling i
+00074a00: 6d70 6f72 7420 4144 4153 594e 2c20 534d  mport ADASYN, SM
+00074a10: 4f54 454e 430d 0a66 726f 6d20 736b 6c65  OTENC..from skle
+00074a20: 6172 6e2e 636c 7573 7465 7220 696d 706f  arn.cluster impo
+00074a30: 7274 204b 4d65 616e 730d 0a64 6566 206b  rt KMeans..def k
+00074a40: 6d65 616e 735f 7265 7361 6d70 6c65 7228  means_resampler(
+00074a50: 785f 7472 6169 6e2c 2079 5f74 7261 696e  x_train, y_train
+00074a60: 2c20 7461 7267 6574 2c20 736d 6f74 653d  , target, smote=
+00074a70: 2222 2c20 7665 7262 6f73 653d 3029 3a0d  "", verbose=0):.
+00074a80: 0a20 2020 2022 2222 0d0a 2020 2020 5468  .    """..    Th
+00074a90: 6973 2066 756e 6374 696f 6e20 636f 6e76  is function conv
+00074aa0: 6572 7473 2061 2052 6567 7265 7373 696f  erts a Regressio
+00074ab0: 6e20 7072 6f62 6c65 6d20 696e 746f 2061  n problem into a
+00074ac0: 2043 6c61 7373 6966 6963 6174 696f 6e20   Classification 
+00074ad0: 7072 6f62 6c65 6d20 746f 2065 6e61 626c  problem to enabl
+00074ae0: 6520 534d 4f54 4521 0d0a 2020 2020 4974  e SMOTE!..    It
+00074af0: 2069 7320 6120 7665 7279 2073 696d 706c   is a very simpl
+00074b00: 6520 7761 7920 746f 2073 656e 6420 796f  e way to send yo
+00074b10: 7572 2078 5f74 7261 696e 2c20 795f 7472  ur x_train, y_tr
+00074b20: 6169 6e20 696e 2061 6e64 2067 6574 2062  ain in and get b
+00074b30: 6163 6b20 616e 206f 7665 7273 616d 706c  ack an oversampl
+00074b40: 6564 2078 5f74 7261 696e 2c20 795f 7472  ed x_train, y_tr
+00074b50: 6169 6e2e 0d0a 2020 2020 5768 7920 6973  ain...    Why is
+00074b60: 2074 6869 7320 6e65 6564 6564 2069 6e20   this needed in 
+00074b70: 4d61 6368 696e 6520 4c65 6172 6e69 6e67  Machine Learning
+00074b80: 2070 726f 626c 656d 733f 0d0a 2020 2020   problems?..    
+00074b90: 2020 2020 2049 6e20 496d 6261 6c61 6e63       In Imbalanc
+00074ba0: 6564 2064 6174 6173 6574 732c 2065 7370  ed datasets, esp
+00074bb0: 2e20 736b 6577 6564 2072 6567 7265 7373  . skewed regress
+00074bc0: 696f 6e20 7072 6f62 6c65 6d73 2077 6865  ion problems whe
+00074bd0: 7265 2074 6865 2074 6172 6765 7420 7661  re the target va
+00074be0: 7269 6162 6c65 2069 7320 736b 6577 6564  riable is skewed
+00074bf0: 2c20 7468 6973 2069 7320 6e65 6564 6564  , this is needed
+00074c00: 2e0d 0a20 2020 2054 7279 2074 6869 7320  ...    Try this 
+00074c10: 6f6e 2079 6f75 7220 736b 6577 6564 2052  on your skewed R
+00074c20: 6567 7265 7373 696f 6e20 7072 6f62 6c65  egression proble
+00074c30: 6d73 2061 6e64 2073 6565 2077 6861 7420  ms and see what 
+00074c40: 7265 7375 6c74 7320 796f 7520 6765 742e  results you get.
+00074c50: 2049 7420 7368 6f75 6c64 2062 6520 6265   It should be be
+00074c60: 7474 6572 2e0d 0a20 2020 202d 2d2d 2d2d  tter...    -----
+00074c70: 2d2d 2d2d 2d0d 0a20 2020 2049 6e70 7574  -----..    Input
+00074c80: 730d 0a20 2020 202d 2d2d 2d2d 2d2d 2d2d  s..    ---------
+00074c90: 2d0d 0a20 2020 2078 5f74 7261 696e 203a  -..    x_train :
+00074ca0: 2070 616e 6461 7320 6461 7461 6672 616d   pandas datafram
+00074cb0: 653a 2079 6f75 206d 7573 7420 7365 6e64  e: you must send
+00074cc0: 2069 6e20 7468 6520 6461 7461 2077 6974   in the data wit
+00074cd0: 6820 7072 6564 6963 746f 7273 206f 6e6c  h predictors onl
+00074ce0: 792e 0d0a 2020 2020 6d69 6e5f 6e5f 7361  y...    min_n_sa
+00074cf0: 6d70 6c65 7320 3a20 696e 742c 2064 6566  mples : int, def
+00074d00: 6175 6c74 3d35 3a20 6d69 6e20 6e75 6d62  ault=5: min numb
+00074d10: 6572 206f 6620 7361 6d70 6c65 7320 6265  er of samples be
+00074d20: 6c6f 7720 7768 6963 6820 796f 7520 636f  low which you co
+00074d30: 6d62 696e 6520 6269 6e73 0d0a 2020 2020  mbine bins..    
+00074d40: 6269 6e73 203a 2069 6e74 2c20 6465 6661  bins : int, defa
+00074d50: 756c 743d 333a 2068 6f77 206d 616e 7920  ult=3: how many 
+00074d60: 6269 6e73 2079 6f75 2077 616e 7420 746f  bins you want to
+00074d70: 2073 706c 6974 2074 6172 6765 7420 696e   split target in
+00074d80: 746f 0d0a 0d0a 2020 2020 4f75 7470 7574  to....    Output
+00074d90: 730d 0a20 2020 202d 2d2d 2d2d 2d2d 2d2d  s..    ---------
+00074da0: 2d0d 0a20 2020 206e 5f66 6561 7475 7265  -..    n_feature
+00074db0: 735f 203a 2069 6e74 0d0a 2020 2020 2020  s_ : int..      
+00074dc0: 2020 5468 6520 6e75 6d62 6572 206f 6620    The number of 
+00074dd0: 6665 6174 7572 6573 206f 6620 7468 6520  features of the 
+00074de0: 6461 7461 2070 6173 7365 6420 746f 203a  data passed to :
+00074df0: 6d65 7468 3a60 6669 7460 2e0d 0a20 2020  meth:`fit`...   
+00074e00: 2022 2222 0d0a 2020 2020 785f 7472 6169   """..    x_trai
+00074e10: 6e5f 6320 3d20 636f 7079 2e64 6565 7063  n_c = copy.deepc
+00074e20: 6f70 7928 785f 7472 6169 6e29 0d0a 2020  opy(x_train)..  
+00074e30: 2020 785f 7472 6169 6e5f 635b 7461 7267    x_train_c[targ
+00074e40: 6574 5d20 3d20 795f 7472 6169 6e2e 7661  et] = y_train.va
+00074e50: 6c75 6573 0d0a 0d0a 2020 2020 2320 5265  lues....    # Re
+00074e60: 6772 6573 7369 6f6e 2070 726f 626c 656d  gression problem
+00074e70: 2074 7572 6e65 6420 696e 746f 2043 6c61   turned into Cla
+00074e80: 7373 6966 6963 6174 696f 6e20 7072 6f62  ssification prob
+00074e90: 6c65 6d0d 0a20 2020 206e 5f63 6c75 7374  lem..    n_clust
+00074ea0: 6572 7320 3d20 6d61 7828 332c 2069 6e74  ers = max(3, int
+00074eb0: 286e 702e 6c6f 6731 3028 6c65 6e28 795f  (np.log10(len(y_
+00074ec0: 7472 6169 6e29 2929 202b 2031 290d 0a20  train))) + 1).. 
+00074ed0: 2020 2023 2055 7365 204b 4d65 616e 7320     # Use KMeans 
+00074ee0: 746f 2066 696e 6420 6e61 7475 7261 6c20  to find natural 
+00074ef0: 636c 7573 7465 7273 2069 6e20 796f 7572  clusters in your
+00074f00: 2064 6174 610d 0a20 2020 206b 6d5f 6d6f   data..    km_mo
+00074f10: 6465 6c20 3d20 4b4d 6561 6e73 286e 5f63  del = KMeans(n_c
+00074f20: 6c75 7374 6572 733d 6e5f 636c 7573 7465  lusters=n_cluste
+00074f30: 7273 2c0d 0a20 2020 2020 2020 2020 2020  rs,..           
+00074f40: 2020 2020 2020 2020 2020 206e 5f69 6e69             n_ini
+00074f50: 743d 352c 0d0a 2020 2020 2020 2020 2020  t=5,..          
+00074f60: 2020 2020 2020 2020 2020 2020 7261 6e64              rand
+00074f70: 6f6d 5f73 7461 7465 3d39 3929 0d0a 2020  om_state=99)..  
+00074f80: 2020 2323 2323 2072 656d 656d 6265 7220    #### remember 
+00074f90: 796f 7520 6d75 7374 2070 7265 6469 6374  you must predict
+00074fa0: 2075 7369 6e67 206f 6e6c 7920 7072 6564   using only pred
+00074fb0: 6963 746f 7220 7661 7269 6162 6c65 7321  ictor variables!
+00074fc0: 0d0a 2020 2020 795f 7472 6169 6e5f 6320  ..    y_train_c 
+00074fd0: 3d20 6b6d 5f6d 6f64 656c 2e66 6974 5f70  = km_model.fit_p
+00074fe0: 7265 6469 6374 2878 5f74 7261 696e 290d  redict(x_train).
+00074ff0: 0a0d 0a20 2020 2069 6620 7665 7262 6f73  ...    if verbos
+00075000: 6520 3e3d 2031 3a0d 0a20 2020 2020 2020  e >= 1:..       
+00075010: 2070 7269 6e74 2827 2020 2020 4e75 6d62   print('    Numb
+00075020: 6572 206f 6620 636c 7573 7465 7273 2063  er of clusters c
+00075030: 7265 6174 6564 203d 2025 6427 2025 6e5f  reated = %d' %n_
+00075040: 636c 7573 7465 7273 290d 0a0d 0a20 2020  clusters)....   
+00075050: 2023 2323 2320 4765 6e65 7261 7465 2074   #### Generate t
+00075060: 6865 206f 7665 722d 7361 6d70 6c65 6420  he over-sampled 
+00075070: 6461 7461 0d0a 2020 2020 2323 2323 2041  data..    #### A
+00075080: 4441 5359 4e20 2f20 534d 4f54 4520 6f76  DASYN / SMOTE ov
+00075090: 6572 7361 6d70 6c69 6e67 2023 2323 2323  ersampling #####
+000750a0: 0d0a 2020 2020 6966 2069 7369 6e73 7461  ..    if isinsta
+000750b0: 6e63 6528 736d 6f74 652c 2073 7472 293a  nce(smote, str):
+000750c0: 0d0a 2020 2020 2020 2020 785f 7472 6169  ..        x_trai
+000750d0: 6e5f 6578 742c 205f 203d 206f 7665 7273  n_ext, _ = overs
+000750e0: 616d 706c 655f 534d 4f54 4528 785f 7472  ample_SMOTE(x_tr
+000750f0: 6169 6e5f 632c 2079 5f74 7261 696e 5f63  ain_c, y_train_c
+00075100: 290d 0a20 2020 2065 6c73 653a 0d0a 2020  )..    else:..  
+00075110: 2020 2020 2020 785f 7472 6169 6e5f 6578        x_train_ex
+00075120: 742c 205f 203d 2073 6d6f 7465 2e66 6974  t, _ = smote.fit
+00075130: 5f72 6573 616d 706c 6528 785f 7472 6169  _resample(x_trai
+00075140: 6e5f 632c 2079 5f74 7261 696e 5f63 290d  n_c, y_train_c).
+00075150: 0a20 2020 2079 5f74 7261 696e 5f65 7874  .    y_train_ext
+00075160: 203d 2078 5f74 7261 696e 5f65 7874 5b74   = x_train_ext[t
+00075170: 6172 6765 745d 2e76 616c 7565 730d 0a20  arget].values.. 
+00075180: 2020 2078 5f74 7261 696e 5f65 7874 2e64     x_train_ext.d
+00075190: 726f 7028 7461 7267 6574 2c20 6178 6973  rop(target, axis
+000751a0: 3d31 2c20 696e 706c 6163 653d 5472 7565  =1, inplace=True
+000751b0: 290d 0a20 2020 2072 6574 7572 6e20 2878  )..    return (x
+000751c0: 5f74 7261 696e 5f65 7874 2c20 795f 7472  _train_ext, y_tr
+000751d0: 6169 6e5f 6578 7429 0d0a 0d0a 2323 2323  ain_ext)....####
+000751e0: 2323 2323 2323 2323 2323 2323 2323 2323  ################
+000751f0: 2323 2323 2323 2323 2323 2323 2323 2323  ################
+00075200: 2323 2323 2323 2323 2323 2323 2323 2323  ################
+00075210: 2323 2323 2323 2323 2323 2323 2323 2323  ################
+00075220: 2323 2323 2323 2323 2323 2323 2323 0d0a  ##############..
+00075230: 6672 6f6d 2073 6b6c 6561 726e 2e75 7469  from sklearn.uti
+00075240: 6c73 2e63 6c61 7373 5f77 6569 6768 7420  ls.class_weight 
+00075250: 696d 706f 7274 2063 6f6d 7075 7465 5f63  import compute_c
+00075260: 6c61 7373 5f77 6569 6768 740d 0a64 6566  lass_weight..def
+00075270: 2067 6574 5f63 6c61 7373 5f64 6973 7472   get_class_distr
+00075280: 6962 7574 696f 6e28 795f 696e 7075 7429  ibution(y_input)
+00075290: 3a0d 0a20 2020 2079 5f69 6e70 7574 203d  :..    y_input =
+000752a0: 2063 6f70 792e 6465 6570 636f 7079 2879   copy.deepcopy(y
+000752b0: 5f69 6e70 7574 290d 0a20 2020 2063 6c61  _input)..    cla
+000752c0: 7373 6573 203d 206e 702e 756e 6971 7565  sses = np.unique
+000752d0: 2879 5f69 6e70 7574 290d 0a20 2020 2078  (y_input)..    x
+000752e0: 7020 3d20 436f 756e 7465 7228 795f 696e  p = Counter(y_in
+000752f0: 7075 7429 0d0a 2020 2020 636c 6173 735f  put)..    class_
+00075300: 7765 6967 6874 7320 3d20 636f 6d70 7574  weights = comput
+00075310: 655f 636c 6173 735f 7765 6967 6874 2827  e_class_weight('
+00075320: 6261 6c61 6e63 6564 272c 2063 6c61 7373  balanced', class
+00075330: 6573 3d6e 702e 756e 6971 7565 2879 5f69  es=np.unique(y_i
+00075340: 6e70 7574 292c 2079 3d79 5f69 6e70 7574  nput), y=y_input
+00075350: 290d 0a20 2020 2069 6620 6c65 6e28 636c  )..    if len(cl
+00075360: 6173 735f 7765 6967 6874 735b 2863 6c61  ass_weights[(cla
+00075370: 7373 5f77 6569 6768 7473 3e20 3130 295d  ss_weights> 10)]
+00075380: 2920 3e20 303a 0d0a 2020 2020 2020 2020  ) > 0:..        
+00075390: 636c 6173 735f 7765 6967 6874 7320 3d20  class_weights = 
+000753a0: 2863 6c61 7373 5f77 6569 6768 7473 2f31  (class_weights/1
+000753b0: 3029 0d0a 2020 2020 656c 7365 3a0d 0a20  0)..    else:.. 
+000753c0: 2020 2020 2020 2063 6c61 7373 5f77 6569         class_wei
+000753d0: 6768 7473 203d 2028 636c 6173 735f 7765  ghts = (class_we
+000753e0: 6967 6874 7329 0d0a 2020 2020 7072 696e  ights)..    prin
+000753f0: 7428 2720 2020 2063 6c61 7373 5f77 6569  t('    class_wei
+00075400: 6768 7473 203d 2025 7327 2025 636c 6173  ghts = %s' %clas
+00075410: 735f 7765 6967 6874 7329 0d0a 2020 2020  s_weights)..    
+00075420: 636c 6173 735f 7765 6967 6874 735b 2863  class_weights[(c
+00075430: 6c61 7373 5f77 6569 6768 7473 3c31 295d  lass_weights<1)]
+00075440: 3d31 0d0a 2020 2020 636c 6173 735f 726f  =1..    class_ro
+00075450: 7773 203d 2063 6c61 7373 5f77 6569 6768  ws = class_weigh
+00075460: 7473 2a5b 7870 5b78 5d20 666f 7220 7820  ts*[xp[x] for x 
+00075470: 696e 2063 6c61 7373 6573 5d0d 0a20 2020  in classes]..   
+00075480: 2063 6c61 7373 5f72 6f77 7320 3d20 636c   class_rows = cl
+00075490: 6173 735f 726f 7773 2e61 7374 7970 6528  ass_rows.astype(
+000754a0: 696e 7429 0d0a 2020 2020 636c 6173 735f  int)..    class_
+000754b0: 7765 6967 6874 6564 5f72 6f77 7320 3d20  weighted_rows = 
+000754c0: 6469 6374 287a 6970 2863 6c61 7373 6573  dict(zip(classes
+000754d0: 2c63 6c61 7373 5f72 6f77 7329 290d 0a20  ,class_rows)).. 
+000754e0: 2020 2070 7269 6e74 2827 2020 2020 636c     print('    cl
+000754f0: 6173 735f 7765 6967 6874 6564 5f72 6f77  ass_weighted_row
+00075500: 7320 3d20 2573 2720 2563 6c61 7373 5f77  s = %s' %class_w
+00075510: 6569 6768 7465 645f 726f 7773 290d 0a20  eighted_rows).. 
+00075520: 2020 2072 6574 7572 6e20 636c 6173 735f     return class_
+00075530: 7765 6967 6874 6564 5f72 6f77 730d 0a0d  weighted_rows...
+00075540: 0a64 6566 206f 7665 7273 616d 706c 655f  .def oversample_
+00075550: 534d 4f54 4528 582c 7929 3a0d 0a20 2020  SMOTE(X,y):..   
+00075560: 2023 696e 7075 7420 4461 7461 4672 616d   #input DataFram
+00075570: 650d 0a20 2020 2023 5820 e286 9249 6e64  e..    #X ...Ind
+00075580: 6570 656e 6465 6e74 2056 6172 6961 626c  ependent Variabl
+00075590: 6520 696e 2044 6174 6146 7261 6d65 5c0d  e in DataFrame\.
+000755a0: 0a20 2020 2023 7920 e286 9264 6570 656e  .    #y ...depen
+000755b0: 6465 6e74 2056 6172 6961 626c 6520 696e  dent Variable in
+000755c0: 2050 616e 6461 7320 4461 7461 4672 616d   Pandas DataFram
+000755d0: 6520 666f 726d 6174 0d0a 2020 2020 2320  e format..    # 
+000755e0: 4765 7420 7468 6520 636c 6173 7320 6469  Get the class di
+000755f0: 7374 7269 7562 7469 6f6e 2066 6f72 2070  striubtion for p
+00075600: 6572 666f 6d69 6e67 2072 656c 6174 6976  erfoming relativ
+00075610: 6520 7361 6d70 6c69 6e67 2069 6e20 7468  e sampling in th
+00075620: 6520 6e65 7874 206c 696e 650d 0a20 2020  e next line..   
+00075630: 2063 6c61 7373 5f77 6569 6768 7465 645f   class_weighted_
+00075640: 726f 7773 203d 2067 6574 5f63 6c61 7373  rows = get_class
+00075650: 5f64 6973 7472 6962 7574 696f 6e28 7929  _distribution(y)
+00075660: 0d0a 2020 2020 736d 6f74 6520 3d20 5356  ..    smote = SV
+00075670: 4d53 4d4f 5445 2820 7261 6e64 6f6d 5f73  MSMOTE( random_s
+00075680: 7461 7465 3d32 372c 0d0a 2020 2020 2020  tate=27,..      
+00075690: 2020 2020 2020 2020 2020 2020 7361 6d70              samp
+000756a0: 6c69 6e67 5f73 7472 6174 6567 793d 636c  ling_strategy=cl
+000756b0: 6173 735f 7765 6967 6874 6564 5f72 6f77  ass_weighted_row
+000756c0: 7329 0d0a 2020 2020 582c 2079 203d 2073  s)..    X, y = s
+000756d0: 6d6f 7465 2e66 6974 5f72 6573 616d 706c  mote.fit_resampl
+000756e0: 6528 582c 2079 290d 0a20 2020 2072 6574  e(X, y)..    ret
+000756f0: 7572 6e28 582c 7929 0d0a 0d0a 6465 6620  urn(X,y)....def 
+00075700: 6f76 6572 7361 6d70 6c65 5f41 4441 5359  oversample_ADASY
+00075710: 4e28 582c 7929 3a0d 0a20 2020 2023 696e  N(X,y):..    #in
+00075720: 7075 7420 4461 7461 4672 616d 650d 0a20  put DataFrame.. 
+00075730: 2020 2023 5820 e286 9249 6e64 6570 656e     #X ...Indepen
+00075740: 6465 6e74 2056 6172 6961 626c 6520 696e  dent Variable in
+00075750: 2044 6174 6146 7261 6d65 5c0d 0a20 2020   DataFrame\..   
+00075760: 2023 7920 e286 9264 6570 656e 6465 6e74   #y ...dependent
+00075770: 2056 6172 6961 626c 6520 696e 2050 616e   Variable in Pan
+00075780: 6461 7320 4461 7461 4672 616d 6520 666f  das DataFrame fo
+00075790: 726d 6174 0d0a 2020 2020 2320 4765 7420  rmat..    # Get 
+000757a0: 7468 6520 636c 6173 7320 6469 7374 7269  the class distri
+000757b0: 7562 7469 6f6e 2066 6f72 2070 6572 666f  ubtion for perfo
+000757c0: 6d69 6e67 2072 656c 6174 6976 6520 7361  ming relative sa
+000757d0: 6d70 6c69 6e67 2069 6e20 7468 6520 6e65  mpling in the ne
+000757e0: 7874 206c 696e 650d 0a20 2020 2063 6c61  xt line..    cla
+000757f0: 7373 5f77 6569 6768 7465 645f 726f 7773  ss_weighted_rows
+00075800: 203d 2067 6574 5f63 6c61 7373 5f64 6973   = get_class_dis
+00075810: 7472 6962 7574 696f 6e28 7929 0d0a 2020  tribution(y)..  
+00075820: 2020 2320 596f 7572 2066 6176 6f75 7269    # Your favouri
+00075830: 7465 206f 7665 7273 616d 706c 6572 0d0a  te oversampler..
+00075840: 2020 2020 736d 6f74 6520 3d20 4144 4153      smote = ADAS
+00075850: 594e 2872 616e 646f 6d5f 7374 6174 653d  YN(random_state=
+00075860: 3237 2c0d 0a20 2020 2020 2020 2020 2020  27,..           
+00075870: 2020 2020 2020 2020 7361 6d70 6c69 6e67          sampling
+00075880: 5f73 7472 6174 6567 793d 636c 6173 735f  _strategy=class_
+00075890: 7765 6967 6874 6564 5f72 6f77 7329 0d0a  weighted_rows)..
+000758a0: 2020 2020 582c 2079 203d 2073 6d6f 7465      X, y = smote
+000758b0: 2e66 6974 5f72 6573 616d 706c 6528 582c  .fit_resample(X,
+000758c0: 2079 290d 0a20 2020 2072 6574 7572 6e28   y)..    return(
+000758d0: 582c 7929 0d0a 2323 2323 2323 2323 2323  X,y)..##########
+000758e0: 2323 2323 2323 2323 2323 2323 2323 2323  ################
+000758f0: 2323 2323 2323 2323 2323 2323 2323 2323  ################
+00075900: 2323 2323 2323 2323 2323 2323 2323 2323  ################
+00075910: 2323 2323 2323 2323 2323 2323 2323 2323  ################
+00075920: 2323 2323 2323 2323 2323 2323 2323 2323  ################
+00075930: 230d 0a64 6566 206d 6172 7468 6173 5f63  #..def marthas_c
+00075940: 6f6c 756d 6e73 2864 6174 612c 7665 7262  olumns(data,verb
+00075950: 6f73 653d 3029 3a0d 0a20 2020 2022 2222  ose=0):..    """
+00075960: 0d0a 2020 2020 5468 6973 2070 726f 6772  ..    This progr
+00075970: 616d 2069 7320 6e61 6d65 6420 2069 6e20  am is named  in 
+00075980: 686f 6e6f 7220 6f66 206d 7920 6f6e 6520  honor of my one 
+00075990: 6f66 2073 7475 6465 6e74 732c 204d 6172  of students, Mar
+000759a0: 7468 612c 2077 686f 2063 616d 6520 7570  tha, who came up
+000759b0: 2077 6974 6820 7468 6520 6964 6561 2066   with the idea f
+000759c0: 6f72 2069 742e 0d0a 2020 2020 4974 2773  or it...    It's
+000759d0: 2061 206e 6561 7420 7761 7920 6f66 2070   a neat way of p
+000759e0: 7269 6e74 696e 6720 6461 7461 2074 7970  rinting data typ
+000759f0: 6573 2061 6e64 2069 6e66 6f72 6d61 7469  es and informati
+00075a00: 6f6e 2063 6f6d 7061 7265 6420 746f 2074  on compared to t
+00075a10: 6865 2062 6f72 696e 6720 6465 7363 7269  he boring descri
+00075a20: 6265 2829 2066 756e 6374 696f 6e20 696e  be() function in
+00075a30: 2050 616e 6461 732e 0d0a 2020 2020 2222   Pandas...    ""
+00075a40: 220d 0a20 2020 2064 6174 6120 3d20 6461  "..    data = da
+00075a50: 7461 5b3a 5d0d 0a20 2020 2070 7269 6e74  ta[:]..    print
+00075a60: 2827 4461 7461 2053 6574 2053 6861 7065  ('Data Set Shape
+00075a70: 3a20 2564 2072 6f77 732c 2025 6420 636f  : %d rows, %d co
+00075a80: 6c73 2720 2520 6461 7461 2e73 6861 7065  ls' % data.shape
+00075a90: 290d 0a20 2020 2069 6620 6461 7461 2e73  )..    if data.s
+00075aa0: 6861 7065 5b31 5d20 3e20 3330 3a0d 0a20  hape[1] > 30:.. 
+00075ab0: 2020 2020 2020 2070 7269 6e74 2827 546f         print('To
+00075ac0: 6f20 6d61 6e79 2063 6f6c 756d 6e73 2074  o many columns t
+00075ad0: 6f20 7072 696e 7427 290d 0a20 2020 2065  o print')..    e
+00075ae0: 6c73 653a 0d0a 2020 2020 2020 2020 6966  lse:..        if
+00075af0: 2076 6572 626f 7365 3d3d 313a 0d0a 2020   verbose==1:..  
+00075b00: 2020 2020 2020 2020 2020 7072 696e 7428            print(
+00075b10: 2720 2020 2041 6464 6974 696f 6e61 6c20  '    Additional 
+00075b20: 6465 7461 696c 7320 6f6e 2063 6f6c 756d  details on colum
+00075b30: 6e73 3a27 290d 0a20 2020 2020 2020 2020  ns:')..         
+00075b40: 2020 2066 6f72 2063 6f6c 2069 6e20 6461     for col in da
+00075b50: 7461 2e63 6f6c 756d 6e73 3a0d 0a20 2020  ta.columns:..   
+00075b60: 2020 2020 2020 2020 2020 2020 2070 7269               pri
+00075b70: 6e74 2827 5c74 2a20 2573 3a5c 7425 6420  nt('\t* %s:\t%d 
+00075b80: 6d69 7373 696e 672c 2025 6420 756e 6971  missing, %d uniq
+00075b90: 7565 732c 206d 6f73 7420 636f 6d6d 6f6e  ues, most common
+00075ba0: 3a20 2573 2720 2520 280d 0a20 2020 2020  : %s' % (..     
+00075bb0: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00075bc0: 2020 2063 6f6c 2c0d 0a20 2020 2020 2020     col,..       
+00075bd0: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00075be0: 2064 6174 615b 636f 6c5d 2e69 736e 756c   data[col].isnul
+00075bf0: 6c28 292e 7375 6d28 292c 0d0a 2020 2020  l().sum(),..    
+00075c00: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00075c10: 2020 2020 6461 7461 5b63 6f6c 5d2e 6e75      data[col].nu
+00075c20: 6e69 7175 6528 292c 0d0a 2020 2020 2020  nique(),..      
+00075c30: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00075c40: 2020 6461 7461 5b63 6f6c 5d2e 7661 6c75    data[col].valu
+00075c50: 655f 636f 756e 7473 2829 2e68 6561 6428  e_counts().head(
+00075c60: 3229 2e74 6f5f 6469 6374 2829 0d0a 2020  2).to_dict()..  
+00075c70: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00075c80: 2020 2929 0d0a 2020 2020 2020 2020 2020    ))..          
+00075c90: 2020 7072 696e 7428 272d 2d2d 2d2d 2d2d    print('-------
+00075ca0: 2d2d 2d2d 2d2d 2d2d 2d2d 2d2d 2d2d 2d2d  ----------------
+00075cb0: 2d2d 2d2d 2d2d 2d2d 2d2d 2d2d 2d2d 2d2d  ----------------
+00075cc0: 2d2d 2d2d 2d2d 2d2d 2d2d 2d2d 2d2d 2d2d  ----------------
+00075cd0: 2d2d 2d2d 2d2d 2d2d 2d2d 2d2d 2d27 290d  -------------').
+00075ce0: 0a23 2323 2323 2323 2323 2323 2323 2323  .###############
+00075cf0: 2323 2323 2323 2323 2323 2323 2323 2323  ################
+00075d00: 2323 2323 2323 2323 2323 2323 2323 2323  ################
+00075d10: 2323 2323 2323 2323 2323 2323 2323 2323  ################
+00075d20: 2323 2323 2323 2323 2323 2323 2323 2323  ################
+00075d30: 2323 230d 0a64 6566 2067 6574 5f73 697a  ###..def get_siz
+00075d40: 6528 6279 7465 732c 2073 7566 6669 783d  e(bytes, suffix=
+00075d50: 2242 2229 3a0d 0a20 2020 2022 2222 0d0a  "B"):..    """..
+00075d60: 2020 2020 5363 616c 6520 6279 7465 7320      Scale bytes 
+00075d70: 746f 2069 7473 2070 726f 7065 7220 666f  to its proper fo
+00075d80: 726d 6174 0d0a 2020 2020 652e 673a 0d0a  rmat..    e.g:..
+00075d90: 2020 2020 2020 2020 3132 3533 3635 3620          1253656 
+00075da0: 3d3e 2027 312e 3230 4d42 270d 0a20 2020  => '1.20MB'..   
+00075db0: 2020 2020 2031 3235 3336 3536 3637 3820       1253656678 
+00075dc0: 3d3e 2027 312e 3137 4742 270d 0a20 2020  => '1.17GB'..   
+00075dd0: 2022 2222 0d0a 2020 2020 6661 6374 6f72   """..    factor
+00075de0: 203d 2031 3032 340d 0a20 2020 2066 6f72   = 1024..    for
+00075df0: 2075 6e69 7420 696e 205b 2222 2c20 224b   unit in ["", "K
+00075e00: 222c 2022 4d22 2c20 2247 222c 2022 5422  ", "M", "G", "T"
+00075e10: 2c20 2250 225d 3a0d 0a20 2020 2020 2020  , "P"]:..       
+00075e20: 2069 6620 6279 7465 7320 3c20 6661 6374   if bytes < fact
+00075e30: 6f72 3a0d 0a20 2020 2020 2020 2020 2020  or:..           
+00075e40: 2072 6574 7572 6e20 6622 7b62 7974 6573   return f"{bytes
+00075e50: 3a2e 3266 7d7b 756e 6974 7d7b 7375 6666  :.2f}{unit}{suff
+00075e60: 6978 7d22 0d0a 2020 2020 2020 2020 6279  ix}"..        by
+00075e70: 7465 7320 2f3d 2066 6163 746f 720d 0a0d  tes /= factor...
+00075e80: 0a64 6566 2070 7269 6e74 5f73 7973 7465  .def print_syste
+00075e90: 6d5f 696e 666f 2829 3a0d 0a20 2020 2022  m_info():..    "
+00075ea0: 2222 0d0a 2020 2020 5468 6973 2070 7269  ""..    This pri
+00075eb0: 6e74 7320 7468 6520 696e 666f 726d 6174  nts the informat
+00075ec0: 696f 6e20 6f6e 2074 6865 2068 6172 6477  ion on the hardw
+00075ed0: 6172 6520 7275 6e6e 696e 6720 7468 6520  are running the 
+00075ee0: 5079 7468 6f6e 2063 6f64 6520 0d0a 2020  Python code ..  
+00075ef0: 2020 4d61 6e79 2074 6861 6e6b 7320 746f    Many thanks to
+00075f00: 3a20 6874 7470 733a 2f2f 7777 772e 7468  : https://www.th
+00075f10: 6570 7974 686f 6e63 6f64 652e 636f 6d2f  epythoncode.com/
+00075f20: 6172 7469 636c 652f 6765 742d 6861 7264  article/get-hard
+00075f30: 7761 7265 2d73 7973 7465 6d2d 696e 666f  ware-system-info
+00075f40: 726d 6174 696f 6e2d 7079 7468 6f6e 0d0a  rmation-python..
+00075f50: 2020 2020 2222 220d 0a20 2020 2069 6d70      """..    imp
+00075f60: 6f72 7420 7073 7574 696c 0d0a 2020 2020  ort psutil..    
+00075f70: 696d 706f 7274 2070 6c61 7466 6f72 6d0d  import platform.
+00075f80: 0a20 2020 2070 7269 6e74 2822 3d22 2a32  .    print("="*2
+00075f90: 302c 2022 5379 7374 656d 2049 6e66 6f72  0, "System Infor
+00075fa0: 6d61 7469 6f6e 222c 2022 3d22 2a32 3029  mation", "="*20)
+00075fb0: 0d0a 2020 2020 756e 616d 6520 3d20 706c  ..    uname = pl
+00075fc0: 6174 666f 726d 2e75 6e61 6d65 2829 0d0a  atform.uname()..
+00075fd0: 2020 2020 7072 696e 7428 6622 5379 7374      print(f"Syst
+00075fe0: 656d 3a20 7b75 6e61 6d65 2e73 7973 7465  em: {uname.syste
+00075ff0: 6d7d 2229 0d0a 2020 2020 7072 696e 7428  m}")..    print(
+00076000: 6622 4e6f 6465 204e 616d 653a 207b 756e  f"Node Name: {un
+00076010: 616d 652e 6e6f 6465 7d22 290d 0a20 2020  ame.node}")..   
+00076020: 2070 7269 6e74 2866 2252 656c 6561 7365   print(f"Release
+00076030: 3a20 7b75 6e61 6d65 2e72 656c 6561 7365  : {uname.release
+00076040: 7d22 290d 0a20 2020 2070 7269 6e74 2866  }")..    print(f
+00076050: 2256 6572 7369 6f6e 3a20 7b75 6e61 6d65  "Version: {uname
+00076060: 2e76 6572 7369 6f6e 7d22 290d 0a20 2020  .version}")..   
+00076070: 2070 7269 6e74 2866 224d 6163 6869 6e65   print(f"Machine
+00076080: 3a20 7b75 6e61 6d65 2e6d 6163 6869 6e65  : {uname.machine
+00076090: 7d22 290d 0a20 2020 2070 7269 6e74 2866  }")..    print(f
+000760a0: 2250 726f 6365 7373 6f72 3a20 7b75 6e61  "Processor: {una
+000760b0: 6d65 2e70 726f 6365 7373 6f72 7d22 290d  me.processor}").
+000760c0: 0a20 2020 2070 7269 6e74 2822 3d22 2a32  .    print("="*2
+000760d0: 322c 2022 4350 5520 496e 666f 726d 6174  2, "CPU Informat
+000760e0: 696f 6e22 2c20 223d 222a 3232 290d 0a20  ion", "="*22).. 
+000760f0: 2020 2023 206e 756d 6265 7220 6f66 2063     # number of c
+00076100: 6f72 6573 0d0a 2020 2020 7072 696e 7428  ores..    print(
+00076110: 2250 6879 7369 6361 6c20 636f 7265 733a  "Physical cores:
+00076120: 222c 2070 7375 7469 6c2e 6370 755f 636f  ", psutil.cpu_co
+00076130: 756e 7428 6c6f 6769 6361 6c3d 4661 6c73  unt(logical=Fals
+00076140: 6529 290d 0a20 2020 2070 7269 6e74 2822  e))..    print("
+00076150: 546f 7461 6c20 636f 7265 733a 222c 2070  Total cores:", p
+00076160: 7375 7469 6c2e 6370 755f 636f 756e 7428  sutil.cpu_count(
+00076170: 6c6f 6769 6361 6c3d 5472 7565 2929 0d0a  logical=True))..
+00076180: 2020 2020 7072 696e 7428 223d 222a 3230      print("="*20
+00076190: 2c20 224d 656d 6f72 7920 496e 666f 726d  , "Memory Inform
+000761a0: 6174 696f 6e22 2c20 223d 222a 3230 290d  ation", "="*20).
+000761b0: 0a20 2020 2023 2067 6574 2074 6865 206d  .    # get the m
+000761c0: 656d 6f72 7920 6465 7461 696c 730d 0a20  emory details.. 
+000761d0: 2020 2073 766d 656d 203d 2070 7375 7469     svmem = psuti
+000761e0: 6c2e 7669 7274 7561 6c5f 6d65 6d6f 7279  l.virtual_memory
+000761f0: 2829 0d0a 2020 2020 7072 696e 7428 6622  ()..    print(f"
+00076200: 546f 7461 6c3a 207b 6765 745f 7369 7a65  Total: {get_size
+00076210: 2873 766d 656d 2e74 6f74 616c 297d 2229  (svmem.total)}")
+00076220: 0d0a 2020 2020 7072 696e 7428 6622 4176  ..    print(f"Av
+00076230: 6169 6c61 626c 653a 207b 6765 745f 7369  ailable: {get_si
+00076240: 7a65 2873 766d 656d 2e61 7661 696c 6162  ze(svmem.availab
+00076250: 6c65 297d 2229 0d0a 2020 2020 7072 696e  le)}")..    prin
+00076260: 7428 6622 5573 6564 3a20 7b67 6574 5f73  t(f"Used: {get_s
+00076270: 697a 6528 7376 6d65 6d2e 7573 6564 297d  ize(svmem.used)}
+00076280: 2229 0d0a 2020 2020 7072 696e 7428 223d  ")..    print("=
+00076290: 222a 3138 2c20 2253 7973 7465 6d20 496e  "*18, "System In
+000762a0: 666f 726d 6174 696f 6e20 456e 6422 2c20  formation End", 
+000762b0: 223d 222a 3138 290d 0a23 2323 2323 2323  "="*18)..#######
+000762c0: 2323 2323 2323 2323 2323 2323 2323 2323  ################
+000762d0: 2323 2323 2323 2323 2323 2323 2323 2323  ################
+000762e0: 2323 2323 2323 2323 2323 2323 2323 2323  ################
+000762f0: 2323 2323 2323 2323 2323 2323 2323 2323  ################
+00076300: 2323 2323 2323 2323 2323 2323 2323 0000  ##############..
+00076310: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+00076320: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+00076330: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+00076340: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+00076350: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+00076360: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+00076370: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+00076380: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+00076390: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+000763a0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+000763b0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+000763c0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+000763d0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+000763e0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+000763f0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+00076400: 2e2f 2e2f 4050 6178 4865 6164 6572 0000  ././@PaxHeader..
+00076410: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+00076420: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+00076430: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+00076440: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+00076450: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+00076460: 0000 0000 3030 3030 3030 3000 3030 3030  ....0000000.0000
+00076470: 3030 3000 3030 3030 3030 3000 3030 3030  000.0000000.0000
+00076480: 3030 3030 3032 3600 3030 3030 3030 3030  0000026.00000000
+00076490: 3030 3000 3031 3134 3533 0020 7800 0000  000.011453. x...
+000764a0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+000764b0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+000764c0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+000764d0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+000764e0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+000764f0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+00076500: 0075 7374 6172 0030 3000 0000 0000 0000  .ustar.00.......
+00076510: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+00076520: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+00076530: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+00076540: 0000 0000 0000 0000 0030 3030 3030 3030  .........0000000
+00076550: 0030 3030 3030 3030 0000 0000 0000 0000  .0000000........
+00076560: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+00076570: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+00076580: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+00076590: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+000765a0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+000765b0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+000765c0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+000765d0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+000765e0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+000765f0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+00076600: 3232 206d 7469 6d65 3d31 3637 3831 3539  22 mtime=1678159
+00076610: 3732 322e 300a 0000 0000 0000 0000 0000  722.0...........
+00076620: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+00076630: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+00076640: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+00076650: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+00076660: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+00076670: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+00076680: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+00076690: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+000766a0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+000766b0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+000766c0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+000766d0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+000766e0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+000766f0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+00076700: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+00076710: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+00076720: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+00076730: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+00076740: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+00076750: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+00076760: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+00076770: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+00076780: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+00076790: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+000767a0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+000767b0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+000767c0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+000767d0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+000767e0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+000767f0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+00076800: 6175 746f 7669 6d6c 2d30 2e31 2e37 3135  autoviml-0.1.715
+00076810: 2f61 7574 6f76 696d 6c2f 5175 6963 6b4d  /autoviml/QuickM
+00076820: 4c5f 456e 7365 6d62 6c69 6e67 2e70 7900  L_Ensembling.py.
+00076830: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+00076840: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+00076850: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+00076860: 0000 0000 3030 3030 3737 3700 3030 3031  ....0000777.0001
+00076870: 3735 3000 3030 3031 3735 3000 3030 3030  750.0001750.0000
+00076880: 3030 3332 3634 3400 3030 3030 3030 3030  0032644.00000000
+00076890: 3030 3000 3032 3130 3130 0020 3000 0000  000.021010. 0...
+000768a0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+000768b0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+000768c0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+000768d0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+000768e0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+000768f0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+00076900: 0075 7374 6172 0030 3072 616d 0000 0000  .ustar.00ram....
+00076910: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+00076920: 0000 0000 0000 0000 0072 616d 0000 0000  .........ram....
+00076930: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+00076940: 0000 0000 0000 0000 0030 3030 3030 3030  .........0000000
+00076950: 0030 3030 3030 3030 0000 0000 0000 0000  .0000000........
+00076960: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+00076970: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+00076980: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+00076990: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+000769a0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+000769b0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+000769c0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+000769d0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+000769e0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+000769f0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+00076a00: 696d 706f 7274 2070 616e 6461 7320 6173  import pandas as
+00076a10: 2070 640d 0a69 6d70 6f72 7420 6e75 6d70   pd..import nump
+00076a20: 7920 6173 206e 700d 0a69 6d70 6f72 7420  y as np..import 
+00076a30: 6d61 7470 6c6f 746c 6962 2e70 7970 6c6f  matplotlib.pyplo
+00076a40: 7420 6173 2070 6c74 0d0a 6765 745f 6970  t as plt..get_ip
+00076a50: 7974 686f 6e28 292e 6d61 6769 6328 276d  ython().magic('m
+00076a60: 6174 706c 6f74 6c69 6220 696e 6c69 6e65  atplotlib inline
+00076a70: 2729 0d0a 696d 706f 7274 2073 6561 626f  ')..import seabo
+00076a80: 726e 2061 7320 736e 730d 0a73 6e73 2e73  rn as sns..sns.s
+00076a90: 6574 2873 7479 6c65 3d22 7768 6974 6522  et(style="white"
+00076aa0: 2c20 636f 6c6f 725f 636f 6465 733d 5472  , color_codes=Tr
+00076ab0: 7565 290d 0a69 6d70 6f72 7420 7761 726e  ue)..import warn
+00076ac0: 696e 6773 0d0a 7761 726e 696e 6773 2e66  ings..warnings.f
+00076ad0: 696c 7465 7277 6172 6e69 6e67 7328 2269  ilterwarnings("i
+00076ae0: 676e 6f72 6522 290d 0a66 726f 6d20 736b  gnore")..from sk
+00076af0: 6c65 6172 6e2e 6d6f 6465 6c5f 7365 6c65  learn.model_sele
+00076b00: 6374 696f 6e20 696d 706f 7274 2063 726f  ction import cro
+00076b10: 7373 5f76 616c 5f73 636f 7265 2c20 5374  ss_val_score, St
+00076b20: 7261 7469 6669 6564 5368 7566 666c 6553  ratifiedShuffleS
+00076b30: 706c 6974 2c20 5469 6d65 5365 7269 6573  plit, TimeSeries
+00076b40: 5370 6c69 740d 0a66 726f 6d20 736b 6c65  Split..from skle
+00076b50: 6172 6e2e 7376 6d20 696d 706f 7274 204c  arn.svm import L
+00076b60: 696e 6561 7253 5643 2c20 4c69 6e65 6172  inearSVC, Linear
+00076b70: 5356 520d 0a66 726f 6d20 736b 6c65 6172  SVR..from sklear
+00076b80: 6e2e 6c69 6e65 6172 5f6d 6f64 656c 2069  n.linear_model i
+00076b90: 6d70 6f72 7420 5347 4452 6567 7265 7373  mport SGDRegress
+00076ba0: 6f72 2c20 5347 4443 6c61 7373 6966 6965  or, SGDClassifie
+00076bb0: 720d 0a66 726f 6d20 736b 6c65 6172 6e2e  r..from sklearn.
+00076bc0: 6d6f 6465 6c5f 7365 6c65 6374 696f 6e20  model_selection 
+00076bd0: 696d 706f 7274 2063 726f 7373 5f76 616c  import cross_val
+00076be0: 5f73 636f 7265 2c20 5374 7261 7469 6669  _score, Stratifi
+00076bf0: 6564 5368 7566 666c 6553 706c 6974 2c20  edShuffleSplit, 
+00076c00: 5469 6d65 5365 7269 6573 5370 6c69 740d  TimeSeriesSplit.
+00076c10: 0a66 726f 6d20 736b 6c65 6172 6e2e 6d6f  .from sklearn.mo
+00076c20: 6465 6c5f 7365 6c65 6374 696f 6e20 696d  del_selection im
+00076c30: 706f 7274 2053 6875 6666 6c65 5370 6c69  port ShuffleSpli
+00076c40: 742c 5374 7261 7469 6669 6564 4b46 6f6c  t,StratifiedKFol
+00076c50: 642c 4b46 6f6c 640d 0a66 726f 6d20 736b  d,KFold..from sk
+00076c60: 6c65 6172 6e2e 6469 7363 7269 6d69 6e61  learn.discrimina
+00076c70: 6e74 5f61 6e61 6c79 7369 7320 696d 706f  nt_analysis impo
+00076c80: 7274 204c 696e 6561 7244 6973 6372 696d  rt LinearDiscrim
+00076c90: 696e 616e 7441 6e61 6c79 7369 730d 0a66  inantAnalysis..f
+00076ca0: 726f 6d20 736b 6c65 6172 6e2e 656e 7365  rom sklearn.ense
+00076cb0: 6d62 6c65 2069 6d70 6f72 7420 4261 6767  mble import Bagg
+00076cc0: 696e 6752 6567 7265 7373 6f72 2c20 5261  ingRegressor, Ra
+00076cd0: 6e64 6f6d 466f 7265 7374 436c 6173 7369  ndomForestClassi
+00076ce0: 6669 6572 2c20 5261 6e64 6f6d 466f 7265  fier, RandomFore
+00076cf0: 7374 5265 6772 6573 736f 720d 0a66 726f  stRegressor..fro
+00076d00: 6d20 736b 6c65 6172 6e2e 656e 7365 6d62  m sklearn.ensemb
+00076d10: 6c65 2069 6d70 6f72 7420 4578 7472 6154  le import ExtraT
+00076d20: 7265 6573 436c 6173 7369 6669 6572 2c45  reesClassifier,E
+00076d30: 7874 7261 5472 6565 7352 6567 7265 7373  xtraTreesRegress
+00076d40: 6f72 0d0a 6672 6f6d 2073 6b6c 6561 726e  or..from sklearn
+00076d50: 2e6c 696e 6561 725f 6d6f 6465 6c20 696d  .linear_model im
+00076d60: 706f 7274 204c 6f67 6973 7469 6352 6567  port LogisticReg
+00076d70: 7265 7373 696f 6e43 562c 204c 696e 6561  ressionCV, Linea
+00076d80: 7252 6567 7265 7373 696f 6e2c 2052 6964  rRegression, Rid
+00076d90: 6765 0d0a 6672 6f6d 2073 6b6c 6561 726e  ge..from sklearn
+00076da0: 2e73 766d 2069 6d70 6f72 7420 4c69 6e65  .svm import Line
+00076db0: 6172 5356 432c 2053 5652 2c20 4c69 6e65  arSVC, SVR, Line
+00076dc0: 6172 5356 520d 0a66 726f 6d20 736b 6c65  arSVR..from skle
+00076dd0: 6172 6e2e 656e 7365 6d62 6c65 2069 6d70  arn.ensemble imp
+00076de0: 6f72 7420 4164 6142 6f6f 7374 436c 6173  ort AdaBoostClas
+00076df0: 7369 6669 6572 2c20 4164 6142 6f6f 7374  sifier, AdaBoost
+00076e00: 5265 6772 6573 736f 720d 0a66 726f 6d20  Regressor..from 
+00076e10: 736b 6c65 6172 6e2e 7472 6565 2069 6d70  sklearn.tree imp
+00076e20: 6f72 7420 4465 6369 7369 6f6e 5472 6565  ort DecisionTree
+00076e30: 5265 6772 6573 736f 722c 2044 6563 6973  Regressor, Decis
+00076e40: 696f 6e54 7265 6543 6c61 7373 6966 6965  ionTreeClassifie
+00076e50: 720d 0a66 726f 6d20 736b 6c65 6172 6e2e  r..from sklearn.
+00076e60: 6c69 6e65 6172 5f6d 6f64 656c 2069 6d70  linear_model imp
+00076e70: 6f72 7420 4c61 7373 6f2c 204c 6173 736f  ort Lasso, Lasso
+00076e80: 4356 2c20 5269 6467 652c 2052 6964 6765  CV, Ridge, Ridge
+00076e90: 4356 2c20 4c61 7373 6f4c 6172 7343 560d  CV, LassoLarsCV.
+00076ea0: 0a66 726f 6d20 736b 6c65 6172 6e2e 6d6f  .from sklearn.mo
+00076eb0: 6465 6c5f 7365 6c65 6374 696f 6e20 696d  del_selection im
+00076ec0: 706f 7274 2063 726f 7373 5f76 616c 5f70  port cross_val_p
+00076ed0: 7265 6469 6374 0d0a 6672 6f6d 2073 6b6c  redict..from skl
+00076ee0: 6561 726e 2e65 6e73 656d 626c 6520 696d  earn.ensemble im
+00076ef0: 706f 7274 2045 7874 7261 5472 6565 7352  port ExtraTreesR
+00076f00: 6567 7265 7373 6f72 2c20 4578 7472 6154  egressor, ExtraT
+00076f10: 7265 6573 436c 6173 7369 6669 6572 0d0a  reesClassifier..
+00076f20: 6672 6f6d 2073 6b6c 6561 726e 2e6c 696e  from sklearn.lin
+00076f30: 6561 725f 6d6f 6465 6c20 696d 706f 7274  ear_model import
+00076f40: 204c 6f67 6973 7469 6352 6567 7265 7373   LogisticRegress
+00076f50: 696f 6e2c 204c 6f67 6973 7469 6352 6567  ion, LogisticReg
+00076f60: 7265 7373 696f 6e43 562c 204c 696e 6561  ressionCV, Linea
+00076f70: 7252 6567 7265 7373 696f 6e0d 0a66 726f  rRegression..fro
+00076f80: 6d20 736b 6c65 6172 6e2e 6d6f 6465 6c5f  m sklearn.model_
+00076f90: 7365 6c65 6374 696f 6e20 696d 706f 7274  selection import
+00076fa0: 2047 7269 6453 6561 7263 6843 562c 5374   GridSearchCV,St
+00076fb0: 7261 7469 6669 6564 5368 7566 666c 6553  ratifiedShuffleS
+00076fc0: 706c 6974 0d0a 6672 6f6d 2073 6b6c 6561  plit..from sklea
+00076fd0: 726e 2e6e 6169 7665 5f62 6179 6573 2069  rn.naive_bayes i
+00076fe0: 6d70 6f72 7420 4761 7573 7369 616e 4e42  mport GaussianNB
+00076ff0: 2c20 4d75 6c74 696e 6f6d 6961 6c4e 420d  , MultinomialNB.
+00077000: 0a66 726f 6d20 736b 6c65 6172 6e2e 7472  .from sklearn.tr
+00077010: 6565 2069 6d70 6f72 7420 4465 6369 7369  ee import Decisi
+00077020: 6f6e 5472 6565 436c 6173 7369 6669 6572  onTreeClassifier
+00077030: 0d0a 6672 6f6d 2073 6b6c 6561 726e 2e6d  ..from sklearn.m
+00077040: 756c 7469 636c 6173 7320 696d 706f 7274  ulticlass import
+00077050: 204f 6e65 5673 5265 7374 436c 6173 7369   OneVsRestClassi
+00077060: 6669 6572 0d0a 6672 6f6d 2073 6b6c 6561  fier..from sklea
+00077070: 726e 2e6e 6569 6768 626f 7273 2069 6d70  rn.neighbors imp
+00077080: 6f72 7420 4b4e 6569 6768 626f 7273 5265  ort KNeighborsRe
+00077090: 6772 6573 736f 720d 0a69 6d70 6f72 7420  gressor..import 
+000770a0: 7469 6d65 0d0a 696d 706f 7274 2070 6462  time..import pdb
+000770b0: 0d0a 696d 706f 7274 2074 696d 650d 0a69  ..import time..i
+000770c0: 6d70 6f72 7420 636f 7079 0d0a 696d 706f  mport copy..impo
+000770d0: 7274 206f 7065 7261 746f 720d 0a23 2323  rt operator..###
+000770e0: 2323 2323 2323 2323 2323 2323 2323 2323  ################
+000770f0: 2323 2323 2323 2323 2323 2323 2323 2323  ################
+00077100: 2323 2323 2323 2323 2323 2323 2323 2323  ################
+00077110: 2323 2323 2323 0d0a 6465 6620 5175 6963  ######..def Quic
+00077120: 6b4d 4c5f 456e 7365 6d62 6c69 6e67 2858  kML_Ensembling(X
+00077130: 5f74 7261 696e 2c20 795f 7472 6169 6e2c  _train, y_train,
+00077140: 2058 5f74 6573 742c 2079 5f74 6573 743d   X_test, y_test=
+00077150: 2727 2c20 6d6f 6465 6c74 7970 653d 2752  '', modeltype='R
+00077160: 6567 7265 7373 696f 6e27 2c0d 0a20 2020  egression',..   
+00077170: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00077180: 2020 2020 426f 6f73 7469 6e67 5f46 6c61      Boosting_Fla
+00077190: 673d 4661 6c73 652c 0d0a 2020 2020 2020  g=False,..      
+000771a0: 2020 2020 2020 2020 2020 2020 2020 2020                  
+000771b0: 2073 636f 7269 6e67 3d27 272c 2076 6572   scoring='', ver
+000771c0: 626f 7365 3d30 293a 0d0a 2020 2020 2222  bose=0):..    ""
+000771d0: 220d 0a20 2020 2051 7569 636b 6c79 2062  "..    Quickly b
+000771e0: 7569 6c64 7320 616e 6420 7275 6e73 206d  uilds and runs m
+000771f0: 756c 7469 706c 6520 6d6f 6465 6c73 2066  ultiple models f
+00077200: 6f72 2061 2063 6c65 616e 2064 6174 6120  or a clean data 
+00077210: 7365 7428 6f6e 6c79 206e 756d 6572 6963  set(only numeric
+00077220: 7329 2e0d 0a20 2020 2022 2222 0d0a 2020  s)...    """..  
+00077230: 2020 7374 6172 745f 7469 6d65 203d 2074    start_time = t
+00077240: 696d 652e 7469 6d65 2829 0d0a 2020 2020  ime.time()..    
+00077250: 7365 6564 203d 2039 390d 0a20 2020 2046  seed = 99..    F
+00077260: 4f4c 4453 203d 2035 0d0a 2020 2020 6d6f  OLDS = 5..    mo
+00077270: 6465 6c5f 6469 6374 203d 207b 7d0d 0a20  del_dict = {}.. 
+00077280: 2020 206d 6f64 656c 5f74 7570 6c65 7320     model_tuples 
+00077290: 3d20 5b5d 0d0a 2020 2020 6966 206c 656e  = []..    if len
+000772a0: 2858 5f74 7261 696e 2920 3c3d 2031 3030  (X_train) <= 100
+000772b0: 3030 3020 616e 6420 585f 7472 6169 6e2e  000 and X_train.
+000772c0: 7368 6170 655b 315d 203c 2035 303a 0d0a  shape[1] < 50:..
+000772d0: 2020 2020 2020 2020 4e55 4d53 203d 2031          NUMS = 1
+000772e0: 3030 0d0a 2020 2020 656c 7365 3a0d 0a20  00..    else:.. 
+000772f0: 2020 2020 2020 2074 7279 3a0d 0a20 2020         try:..   
+00077300: 2020 2020 2020 2020 2058 5f74 7261 696e           X_train
+00077310: 203d 2058 5f74 7261 696e 2e73 616d 706c   = X_train.sampl
+00077320: 6528 6672 6163 3d30 2e33 302c 7261 6e64  e(frac=0.30,rand
+00077330: 6f6d 5f73 7461 7465 3d39 3929 0d0a 2020  om_state=99)..  
+00077340: 2020 2020 2020 2020 2020 795f 7472 6169            y_trai
+00077350: 6e20 3d20 795f 7472 6169 6e5b 585f 7472  n = y_train[X_tr
+00077360: 6169 6e2e 696e 6465 785d 0d0a 2020 2020  ain.index]..    
+00077370: 2020 2020 6578 6365 7074 3a0d 0a20 2020      except:..   
+00077380: 2020 2020 2020 2020 2070 6173 730d 0a20           pass.. 
+00077390: 2020 2020 2020 204e 554d 5320 3d20 3230         NUMS = 20
+000773a0: 300d 0a20 2020 2023 2323 2323 2320 5468  0..    ###### Th
+000773b0: 6973 2069 7320 7768 6572 6520 7765 2073  is is where we s
+000773c0: 7461 7274 2070 6572 666f 726d 696e 6720  tart performing 
+000773d0: 656e 7365 6d62 6c69 6e67 206f 6620 6d75  ensembling of mu
+000773e0: 6c74 6970 6c65 2073 696d 706c 6572 206d  ltiple simpler m
+000773f0: 6f64 656c 7320 2323 230d 0a20 2020 2069  odels ###..    i
+00077400: 6620 6d6f 6465 6c74 7970 6520 3d3d 2027  f modeltype == '
+00077410: 5265 6772 6573 7369 6f6e 273a 0d0a 2020  Regression':..  
+00077420: 2020 2020 2020 6966 2073 636f 7269 6e67        if scoring
+00077430: 203d 3d20 2727 3a0d 0a20 2020 2020 2020   == '':..       
+00077440: 2020 2020 2073 636f 7269 6e67 203d 2027       scoring = '
+00077450: 6e65 675f 6d65 616e 5f73 7175 6172 6564  neg_mean_squared
+00077460: 5f65 7272 6f72 270d 0a20 2020 2020 2020  _error'..       
+00077470: 2023 7363 7620 3d20 5368 7566 666c 6553   #scv = ShuffleS
+00077480: 706c 6974 286e 5f73 706c 6974 733d 464f  plit(n_splits=FO
+00077490: 4c44 532c 7261 6e64 6f6d 5f73 7461 7465  LDS,random_state
+000774a0: 3d73 6565 6429 0d0a 2020 2020 2020 2020  =seed)..        
+000774b0: 7363 7620 3d20 4b46 6f6c 6428 6e5f 7370  scv = KFold(n_sp
+000774c0: 6c69 7473 3d46 4f4c 4453 2c20 7368 7566  lits=FOLDS, shuf
+000774d0: 666c 653d 4661 6c73 6529 0d0a 2020 2020  fle=False)..    
+000774e0: 2020 2020 6966 2042 6f6f 7374 696e 675f      if Boosting_
+000774f0: 466c 6167 2069 7320 4e6f 6e65 3a0d 0a20  Flag is None:.. 
+00077500: 2020 2020 2020 2020 2020 2023 2320 4372             ## Cr
+00077510: 6561 7465 2061 6e20 656e 7365 6d62 6c65  eate an ensemble
+00077520: 206d 6f64 656c 2023 2323 230d 0a20 2020   model ####..   
+00077530: 2020 2020 2020 2020 206d 6f64 656c 3520           model5 
+00077540: 3d20 4164 6142 6f6f 7374 5265 6772 6573  = AdaBoostRegres
+00077550: 736f 7228 6261 7365 5f65 7374 696d 6174  sor(base_estimat
+00077560: 6f72 3d44 6563 6973 696f 6e54 7265 6552  or=DecisionTreeR
+00077570: 6567 7265 7373 6f72 280d 0a20 2020 2020  egressor(..     
 00077580: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00077590: 2020 2020 2020 2020 2020 206d 6178 5f66             max_f
-000775a0: 6561 7475 7265 7320 3d20 2761 7574 6f27  eatures = 'auto'
-000775b0: 2c0d 0a20 2020 2020 2020 2020 2020 2020  ,..             
-000775c0: 2020 2020 2020 2020 2020 2020 2020 2020                  
-000775d0: 2020 2020 2020 2020 2020 6d69 6e5f 7361            min_sa
-000775e0: 6d70 6c65 735f 6c65 6166 203d 2032 2c0d  mples_leaf = 2,.
-000775f0: 0a20 2020 2020 2020 2020 2020 2020 2020  .               
-00077600: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00077610: 2020 2020 2020 2020 6e5f 6573 7469 6d61          n_estima
-00077620: 746f 7273 203d 2032 3030 2c0d 0a20 2020  tors = 200,..   
-00077630: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00077640: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00077650: 2020 2020 7261 6e64 6f6d 5f73 7461 7465      random_state
-00077660: 3d39 3929 0d0a 2020 2020 2020 2020 2020  =99)..          
-00077670: 2020 6d6f 6465 6c5f 7475 706c 6573 2e61    model_tuples.a
-00077680: 7070 656e 6428 2827 5246 5f52 6567 7265  ppend(('RF_Regre
-00077690: 7373 6f72 272c 6d6f 6465 6c38 2929 0d0a  ssor',model8))..
-000776a0: 2020 2020 656c 7365 3a0d 0a20 2020 2020      else:..     
-000776b0: 2020 2069 6620 7363 6f72 696e 6720 3d3d     if scoring ==
-000776c0: 2027 273a 0d0a 2020 2020 2020 2020 2020   '':..          
-000776d0: 2020 7363 6f72 696e 6720 3d20 2761 6363    scoring = 'acc
-000776e0: 7572 6163 7927 0d0a 2020 2020 2020 2020  uracy'..        
-000776f0: 6e75 6d5f 636c 6173 7365 7320 3d20 6c65  num_classes = le
-00077700: 6e28 6e70 2e75 6e69 7175 6528 795f 7465  n(np.unique(y_te
-00077710: 7374 2929 0d0a 2020 2020 2020 2020 7363  st))..        sc
-00077720: 7620 3d20 5374 7261 7469 6669 6564 4b46  v = StratifiedKF
-00077730: 6f6c 6428 6e5f 7370 6c69 7473 3d46 4f4c  old(n_splits=FOL
-00077740: 4453 2c20 7368 7566 666c 653d 5472 7565  DS, shuffle=True
-00077750: 2c20 7261 6e64 6f6d 5f73 7461 7465 3d73  , random_state=s
-00077760: 6565 6429 0d0a 2020 2020 2020 2020 6966  eed)..        if
-00077770: 2042 6f6f 7374 696e 675f 466c 6167 2069   Boosting_Flag i
-00077780: 7320 4e6f 6e65 3a0d 0a20 2020 2020 2020  s None:..       
-00077790: 2020 2020 2023 2320 4372 6561 7465 2061       ## Create a
-000777a0: 6e20 656e 7365 6d62 6c65 206d 6f64 656c  n ensemble model
-000777b0: 2023 2323 230d 0a20 2020 2020 2020 2020   ####..         
-000777c0: 2020 206d 6f64 656c 3520 3d20 4164 6142     model5 = AdaB
-000777d0: 6f6f 7374 436c 6173 7369 6669 6572 2862  oostClassifier(b
-000777e0: 6173 655f 6573 7469 6d61 746f 723d 4465  ase_estimator=De
-000777f0: 6369 7369 6f6e 5472 6565 436c 6173 7369  cisionTreeClassi
-00077800: 6669 6572 280d 0a20 2020 2020 2020 2020  fier(..         
-00077810: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00077820: 2020 2020 2020 2020 2020 2072 616e 646f             rando
-00077830: 6d5f 7374 6174 653d 7365 6564 2c20 6d61  m_state=seed, ma
-00077840: 785f 6465 7074 683d 312c 206d 696e 5f73  x_depth=1, min_s
-00077850: 616d 706c 6573 5f6c 6561 663d 320d 0a20  amples_leaf=2.. 
-00077860: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00077870: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00077880: 2020 2029 2c20 6e5f 6573 7469 6d61 746f     ), n_estimato
-00077890: 7273 3d4e 554d 532c 2072 616e 646f 6d5f  rs=NUMS, random_
-000778a0: 7374 6174 653d 7365 6564 290d 0a20 2020  state=seed)..   
-000778b0: 2020 2020 2020 2020 206d 6f64 656c 5f74           model_t
-000778c0: 7570 6c65 732e 6170 7065 6e64 2828 2741  uples.append(('A
-000778d0: 6461 626f 6f73 7427 2c6d 6f64 656c 3529  daboost',model5)
-000778e0: 290d 0a20 2020 2020 2020 2065 6c69 6620  )..        elif 
-000778f0: 6e6f 7420 426f 6f73 7469 6e67 5f46 6c61  not Boosting_Fla
-00077900: 673a 0d0a 2020 2020 2020 2020 2020 2020  g:..            
-00077910: 6d6f 6465 6c35 203d 204c 696e 6561 7244  model5 = LinearD
-00077920: 6973 6372 696d 696e 616e 7441 6e61 6c79  iscriminantAnaly
-00077930: 7369 7328 290d 0a20 2020 2020 2020 2020  sis()..         
-00077940: 2020 206d 6f64 656c 5f74 7570 6c65 732e     model_tuples.
-00077950: 6170 7065 6e64 2828 274c 696e 6561 725f  append(('Linear_
-00077960: 4469 7363 7269 6d69 6e61 6e74 272c 6d6f  Discriminant',mo
-00077970: 6465 6c35 2929 0d0a 2020 2020 2020 2020  del5))..        
-00077980: 656c 7365 3a0d 0a20 2020 2020 2020 2020  else:..         
-00077990: 2020 206d 6f64 656c 3520 3d20 4c6f 6769     model5 = Logi
-000779a0: 7374 6963 5265 6772 6573 7369 6f6e 4356  sticRegressionCV
-000779b0: 2843 733d 5b30 2e30 3031 2c30 2e30 312c  (Cs=[0.001,0.01,
-000779c0: 302e 312c 312c 3130 2c31 3030 5d2c 2074  0.1,1,10,100], t
-000779d0: 6f6c 3d30 2e30 312c 0d0a 2020 2020 2020  ol=0.01,..      
-000779e0: 2020 2020 2020 2020 2020 2020 2020 2020                  
-000779f0: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00077a00: 2020 2020 736f 6c76 6572 3d27 6c69 626c      solver='libl
-00077a10: 696e 6561 7227 2c20 7261 6e64 6f6d 5f73  inear', random_s
-00077a20: 7461 7465 3d73 6565 6429 0d0a 2020 2020  tate=seed)..    
-00077a30: 2020 2020 2020 2020 6d6f 6465 6c5f 7475          model_tu
-00077a40: 706c 6573 2e61 7070 656e 6428 2827 4c6f  ples.append(('Lo
-00077a50: 6769 7374 6963 5f52 6567 7265 7373 696f  gistic_Regressio
-00077a60: 6e5f 4356 272c 6d6f 6465 6c35 2929 0d0a  n_CV',model5))..
-00077a70: 2020 2020 2020 2020 6966 2042 6f6f 7374          if Boost
-00077a80: 696e 675f 466c 6167 2069 7320 4e6f 6e65  ing_Flag is None
-00077a90: 3a0d 0a20 2020 2020 2020 2020 2020 206d  :..            m
-00077aa0: 6f64 656c 3620 3d20 4465 6369 7369 6f6e  odel6 = Decision
-00077ab0: 5472 6565 436c 6173 7369 6669 6572 286d  TreeClassifier(m
-00077ac0: 6178 5f64 6570 7468 3d35 2c6d 696e 5f73  ax_depth=5,min_s
-00077ad0: 616d 706c 6573 5f6c 6561 663d 3229 0d0a  amples_leaf=2)..
-00077ae0: 2020 2020 2020 2020 2020 2020 6d6f 6465              mode
-00077af0: 6c5f 7475 706c 6573 2e61 7070 656e 6428  l_tuples.append(
-00077b00: 2827 4465 6369 7369 6f6e 5f54 7265 6527  ('Decision_Tree'
-00077b10: 2c6d 6f64 656c 3629 290d 0a20 2020 2020  ,model6))..     
-00077b20: 2020 2065 6c69 6620 6e6f 7420 426f 6f73     elif not Boos
-00077b30: 7469 6e67 5f46 6c61 673a 0d0a 2020 2020  ting_Flag:..    
-00077b40: 2020 2020 2020 2020 6d6f 6465 6c36 203d          model6 =
-00077b50: 204c 696e 6561 7253 5643 2829 0d0a 2020   LinearSVC()..  
-00077b60: 2020 2020 2020 2020 2020 6d6f 6465 6c5f            model_
-00077b70: 7475 706c 6573 2e61 7070 656e 6428 2827  tuples.append(('
-00077b80: 4c69 6e65 6172 5f53 5643 272c 6d6f 6465  Linear_SVC',mode
-00077b90: 6c36 2929 0d0a 2020 2020 2020 2020 656c  l6))..        el
-00077ba0: 7365 3a0d 0a20 2020 2020 2020 2020 2020  se:..           
-00077bb0: 206d 6f64 656c 3620 3d20 4465 6369 7369   model6 = Decisi
-00077bc0: 6f6e 5472 6565 436c 6173 7369 6669 6572  onTreeClassifier
-00077bd0: 286d 6178 5f64 6570 7468 3d35 2c6d 696e  (max_depth=5,min
-00077be0: 5f73 616d 706c 6573 5f6c 6561 663d 3229  _samples_leaf=2)
-00077bf0: 0d0a 2020 2020 2020 2020 2020 2020 6d6f  ..            mo
-00077c00: 6465 6c5f 7475 706c 6573 2e61 7070 656e  del_tuples.appen
-00077c10: 6428 2827 4465 6369 7369 6f6e 5f54 7265  d(('Decision_Tre
-00077c20: 6527 2c6d 6f64 656c 3629 290d 0a20 2020  e',model6))..   
-00077c30: 2020 2020 2069 6620 6d6f 6465 6c74 7970       if modeltyp
-00077c40: 6520 3d3d 2027 4269 6e61 7279 5f43 6c61  e == 'Binary_Cla
-00077c50: 7373 6966 6963 6174 696f 6e27 3a0d 0a20  ssification':.. 
-00077c60: 2020 2020 2020 2020 2020 206d 6f64 656c             model
-00077c70: 3720 3d20 4761 7573 7369 616e 4e42 2829  7 = GaussianNB()
-00077c80: 0d0a 2020 2020 2020 2020 656c 7365 3a0d  ..        else:.
-00077c90: 0a20 2020 2020 2020 2020 2020 206d 6f64  .            mod
-00077ca0: 656c 3720 3d20 4d75 6c74 696e 6f6d 6961  el7 = Multinomia
-00077cb0: 6c4e 4228 290d 0a20 2020 2020 2020 206d  lNB()..        m
-00077cc0: 6f64 656c 5f74 7570 6c65 732e 6170 7065  odel_tuples.appe
-00077cd0: 6e64 2828 274e 6169 7665 5f42 6179 6573  nd(('Naive_Bayes
-00077ce0: 272c 6d6f 6465 6c37 2929 0d0a 2020 2020  ',model7))..    
-00077cf0: 2020 2020 6966 2042 6f6f 7374 696e 675f      if Boosting_
-00077d00: 466c 6167 2069 7320 4e6f 6e65 3a0d 0a20  Flag is None:.. 
-00077d10: 2020 2020 2020 2020 2020 2023 2323 2320             #### 
-00077d20: 4966 2074 6865 2042 6f6f 7374 696e 675f  If the Boosting_
-00077d30: 466c 6167 2069 7320 5472 7565 2c20 6974  Flag is True, it
-00077d40: 206d 6561 6e73 2042 6f6f 7374 696e 6720   means Boosting 
-00077d50: 6d6f 6465 6c20 6973 2070 7265 7365 6e74  model is present
-00077d60: 2e0d 0a20 2020 2020 2020 2020 2020 2023  ...            #
-00077d70: 2323 2020 2053 6f20 6368 6f6f 7365 2061  ##   So choose a
-00077d80: 2064 6966 6665 7265 6e74 206b 696e 6420   different kind 
-00077d90: 6f66 2063 6c61 7373 6966 6965 7220 6865  of classifier he
-00077da0: 7265 0d0a 2020 2020 2020 2020 2020 2020  re..            
-00077db0: 6d6f 6465 6c38 203d 2052 616e 646f 6d46  model8 = RandomF
-00077dc0: 6f72 6573 7443 6c61 7373 6966 6965 7228  orestClassifier(
-00077dd0: 626f 6f74 7374 7261 7020 3d20 4661 6c73  bootstrap = Fals
-00077de0: 652c 0d0a 2020 2020 2020 2020 2020 2020  e,..            
-00077df0: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00077e00: 2020 2020 2020 2020 2020 206d 6178 5f64             max_d
-00077e10: 6570 7468 203d 2031 302c 0d0a 2020 2020  epth = 10,..    
-00077e20: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00077590: 2020 2020 2020 2020 2020 2020 2020 2072                 r
+000775a0: 616e 646f 6d5f 7374 6174 653d 7365 6564  andom_state=seed
+000775b0: 2c20 6d61 785f 6465 7074 683d 312c 206d  , max_depth=1, m
+000775c0: 696e 5f73 616d 706c 6573 5f6c 6561 663d  in_samples_leaf=
+000775d0: 320d 0a20 2020 2020 2020 2020 2020 2020  2..             
+000775e0: 2020 2020 2020 2020 2020 2020 2020 2020                  
+000775f0: 2020 2020 2020 2029 2c20 6e5f 6573 7469         ), n_esti
+00077600: 6d61 746f 7273 3d4e 554d 532c 2072 616e  mators=NUMS, ran
+00077610: 646f 6d5f 7374 6174 653d 7365 6564 290d  dom_state=seed).
+00077620: 0a20 2020 2020 2020 2020 2020 206d 6f64  .            mod
+00077630: 656c 5f74 7570 6c65 732e 6170 7065 6e64  el_tuples.append
+00077640: 2828 2741 6461 626f 6f73 7427 2c6d 6f64  (('Adaboost',mod
+00077650: 656c 3529 290d 0a20 2020 2020 2020 2065  el5))..        e
+00077660: 6c69 6620 6e6f 7420 426f 6f73 7469 6e67  lif not Boosting
+00077670: 5f46 6c61 673a 0d0a 2020 2020 2020 2020  _Flag:..        
+00077680: 2020 2020 6d6f 6465 6c35 203d 204c 6173      model5 = Las
+00077690: 736f 4c61 7273 4356 2863 763d 7363 7629  soLarsCV(cv=scv)
+000776a0: 0d0a 2020 2020 2020 2020 2020 2020 6d6f  ..            mo
+000776b0: 6465 6c5f 7475 706c 6573 2e61 7070 656e  del_tuples.appen
+000776c0: 6428 2827 4c61 7373 6f4c 6172 7343 5627  d(('LassoLarsCV'
+000776d0: 2c6d 6f64 656c 3529 290d 0a20 2020 2020  ,model5))..     
+000776e0: 2020 2065 6c73 653a 0d0a 2020 2020 2020     else:..      
+000776f0: 2020 2020 2020 6d6f 6465 6c35 203d 204c        model5 = L
+00077700: 6173 736f 4c61 7273 4356 2863 763d 7363  assoLarsCV(cv=sc
+00077710: 7629 0d0a 2020 2020 2020 2020 2020 2020  v)..            
+00077720: 6d6f 6465 6c5f 7475 706c 6573 2e61 7070  model_tuples.app
+00077730: 656e 6428 2827 4c61 7373 6f4c 6172 7343  end(('LassoLarsC
+00077740: 5627 2c6d 6f64 656c 3529 290d 0a20 2020  V',model5))..   
+00077750: 2020 2020 2069 6620 426f 6f73 7469 6e67       if Boosting
+00077760: 5f46 6c61 6720 6973 204e 6f6e 653a 0d0a  _Flag is None:..
+00077770: 2020 2020 2020 2020 2020 2020 6d6f 6465              mode
+00077780: 6c36 203d 2042 6167 6769 6e67 5265 6772  l6 = BaggingRegr
+00077790: 6573 736f 7228 4465 6369 7369 6f6e 5472  essor(DecisionTr
+000777a0: 6565 5265 6772 6573 736f 7228 7261 6e64  eeRegressor(rand
+000777b0: 6f6d 5f73 7461 7465 3d73 6565 6429 2c0d  om_state=seed),.
+000777c0: 0a20 2020 2020 2020 2020 2020 2020 2020  .               
+000777d0: 2020 2020 2020 2020 2020 2020 2020 2020                  
+000777e0: 2020 2020 2020 2020 2020 2020 206e 5f65               n_e
+000777f0: 7374 696d 6174 6f72 733d 4e55 4d53 2c72  stimators=NUMS,r
+00077800: 616e 646f 6d5f 7374 6174 653d 7365 6564  andom_state=seed
+00077810: 290d 0a20 2020 2020 2020 2020 2020 206d  )..            m
+00077820: 6f64 656c 5f74 7570 6c65 732e 6170 7065  odel_tuples.appe
+00077830: 6e64 2828 2742 6167 6769 6e67 5f52 6567  nd(('Bagging_Reg
+00077840: 7265 7373 6f72 272c 6d6f 6465 6c36 2929  ressor',model6))
+00077850: 0d0a 2020 2020 2020 2020 656c 6966 206e  ..        elif n
+00077860: 6f74 2042 6f6f 7374 696e 675f 466c 6167  ot Boosting_Flag
+00077870: 3a0d 0a20 2020 2020 2020 2020 2020 206d  :..            m
+00077880: 6f64 656c 3620 3d20 4c69 6e65 6172 5356  odel6 = LinearSV
+00077890: 5228 290d 0a20 2020 2020 2020 2020 2020  R()..           
+000778a0: 206d 6f64 656c 5f74 7570 6c65 732e 6170   model_tuples.ap
+000778b0: 7065 6e64 2828 274c 696e 6561 725f 5356  pend(('Linear_SV
+000778c0: 5227 2c6d 6f64 656c 3629 290d 0a20 2020  R',model6))..   
+000778d0: 2020 2020 2065 6c73 653a 0d0a 2020 2020       else:..    
+000778e0: 2020 2020 2020 2020 6d6f 6465 6c36 203d          model6 =
+000778f0: 2044 6563 6973 696f 6e54 7265 6552 6567   DecisionTreeReg
+00077900: 7265 7373 6f72 286d 6178 5f64 6570 7468  ressor(max_depth
+00077910: 3d35 2c6d 696e 5f73 616d 706c 6573 5f6c  =5,min_samples_l
+00077920: 6561 663d 3229 0d0a 2020 2020 2020 2020  eaf=2)..        
+00077930: 2020 2020 6d6f 6465 6c5f 7475 706c 6573      model_tuples
+00077940: 2e61 7070 656e 6428 2827 4465 6369 7369  .append(('Decisi
+00077950: 6f6e 5f54 7265 6527 2c6d 6f64 656c 3629  on_Tree',model6)
+00077960: 290d 0a20 2020 2020 2020 206d 6f64 656c  )..        model
+00077970: 3720 3d20 4b4e 6569 6768 626f 7273 5265  7 = KNeighborsRe
+00077980: 6772 6573 736f 7228 6e5f 6e65 6967 6862  gressor(n_neighb
+00077990: 6f72 733d 3829 0d0a 2020 2020 2020 2020  ors=8)..        
+000779a0: 6d6f 6465 6c5f 7475 706c 6573 2e61 7070  model_tuples.app
+000779b0: 656e 6428 2827 4b4e 4e5f 5265 6772 6573  end(('KNN_Regres
+000779c0: 736f 7227 2c6d 6f64 656c 3729 290d 0a20  sor',model7)).. 
+000779d0: 2020 2020 2020 2069 6620 426f 6f73 7469         if Boosti
+000779e0: 6e67 5f46 6c61 6720 6973 204e 6f6e 653a  ng_Flag is None:
+000779f0: 0d0a 2020 2020 2020 2020 2020 2020 2323  ..            ##
+00077a00: 2323 2049 6620 7468 6520 426f 6f73 7469  ## If the Boosti
+00077a10: 6e67 5f46 6c61 6720 6973 2054 7275 652c  ng_Flag is True,
+00077a20: 2069 7420 6d65 616e 7320 426f 6f73 7469   it means Boosti
+00077a30: 6e67 206d 6f64 656c 2069 7320 7072 6573  ng model is pres
+00077a40: 656e 742e 0d0a 2020 2020 2020 2020 2020  ent...          
+00077a50: 2020 2323 2320 2020 536f 2063 686f 6f73    ###   So choos
+00077a60: 6520 6120 6469 6666 6572 656e 7420 6b69  e a different ki
+00077a70: 6e64 206f 6620 636c 6173 7369 6669 6572  nd of classifier
+00077a80: 2068 6572 650d 0a20 2020 2020 2020 2020   here..         
+00077a90: 2020 206d 6f64 656c 3820 3d20 4465 6369     model8 = Deci
+00077aa0: 7369 6f6e 5472 6565 5265 6772 6573 736f  sionTreeRegresso
+00077ab0: 7228 6d61 785f 6465 7074 683d 352c 6d69  r(max_depth=5,mi
+00077ac0: 6e5f 7361 6d70 6c65 735f 6c65 6166 3d32  n_samples_leaf=2
+00077ad0: 290d 0a20 2020 2020 2020 2020 2020 206d  )..            m
+00077ae0: 6f64 656c 5f74 7570 6c65 732e 6170 7065  odel_tuples.appe
+00077af0: 6e64 2828 2744 6563 6973 696f 6e5f 5472  nd(('Decision_Tr
+00077b00: 6565 272c 6d6f 6465 6c38 2929 0d0a 2020  ee',model8))..  
+00077b10: 2020 2020 2020 656c 6966 206e 6f74 2042        elif not B
+00077b20: 6f6f 7374 696e 675f 466c 6167 3a0d 0a20  oosting_Flag:.. 
+00077b30: 2020 2020 2020 2020 2020 2023 2323 2320             #### 
+00077b40: 4966 2074 6865 2042 6f6f 7374 696e 675f  If the Boosting_
+00077b50: 466c 6167 2069 7320 5472 7565 2c20 6974  Flag is True, it
+00077b60: 206d 6561 6e73 2042 6f6f 7374 696e 6720   means Boosting 
+00077b70: 6d6f 6465 6c20 6973 2070 7265 7365 6e74  model is present
+00077b80: 2e0d 0a20 2020 2020 2020 2020 2020 2023  ...            #
+00077b90: 2323 2020 2053 6f20 6368 6f6f 7365 2061  ##   So choose a
+00077ba0: 2064 6966 6665 7265 6e74 206b 696e 6420   different kind 
+00077bb0: 6f66 2063 6c61 7373 6966 6965 7220 6865  of classifier he
+00077bc0: 7265 0d0a 2020 2020 2020 2020 2020 2020  re..            
+00077bd0: 6d6f 6465 6c38 203d 2041 6461 426f 6f73  model8 = AdaBoos
+00077be0: 7452 6567 7265 7373 6f72 2862 6173 655f  tRegressor(base_
+00077bf0: 6573 7469 6d61 746f 723d 4465 6369 7369  estimator=Decisi
+00077c00: 6f6e 5472 6565 5265 6772 6573 736f 7228  onTreeRegressor(
+00077c10: 0d0a 2020 2020 2020 2020 2020 2020 2020  ..              
+00077c20: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00077c30: 2020 2020 2020 7261 6e64 6f6d 5f73 7461        random_sta
+00077c40: 7465 3d73 6565 642c 206d 6178 5f64 6570  te=seed, max_dep
+00077c50: 7468 3d31 2c20 6d69 6e5f 7361 6d70 6c65  th=1, min_sample
+00077c60: 735f 6c65 6166 3d32 0d0a 2020 2020 2020  s_leaf=2..      
+00077c70: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00077c80: 2020 2020 2020 2020 2020 2020 2020 292c                ),
+00077c90: 206e 5f65 7374 696d 6174 6f72 733d 4e55   n_estimators=NU
+00077ca0: 4d53 2c20 7261 6e64 6f6d 5f73 7461 7465  MS, random_state
+00077cb0: 3d73 6565 6429 0d0a 2020 2020 2020 2020  =seed)..        
+00077cc0: 2020 2020 6d6f 6465 6c5f 7475 706c 6573      model_tuples
+00077cd0: 2e61 7070 656e 6428 2827 4164 6162 6f6f  .append(('Adaboo
+00077ce0: 7374 272c 6d6f 6465 6c38 2929 0d0a 2020  st',model8))..  
+00077cf0: 2020 2020 2020 656c 7365 3a0d 0a20 2020        else:..   
+00077d00: 2020 2020 2020 2020 206d 6f64 656c 3820           model8 
+00077d10: 3d20 5261 6e64 6f6d 466f 7265 7374 5265  = RandomForestRe
+00077d20: 6772 6573 736f 7228 626f 6f74 7374 7261  gressor(bootstra
+00077d30: 7020 3d20 4661 6c73 652c 0d0a 2020 2020  p = False,..    
+00077d40: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00077d50: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00077d60: 2020 206d 6178 5f64 6570 7468 203d 2031     max_depth = 1
+00077d70: 302c 0d0a 2020 2020 2020 2020 2020 2020  0,..            
+00077d80: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00077d90: 2020 2020 2020 2020 2020 206d 6178 5f66             max_f
+00077da0: 6561 7475 7265 7320 3d20 2761 7574 6f27  eatures = 'auto'
+00077db0: 2c0d 0a20 2020 2020 2020 2020 2020 2020  ,..             
+00077dc0: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00077dd0: 2020 2020 2020 2020 2020 6d69 6e5f 7361            min_sa
+00077de0: 6d70 6c65 735f 6c65 6166 203d 2032 2c0d  mples_leaf = 2,.
+00077df0: 0a20 2020 2020 2020 2020 2020 2020 2020  .               
+00077e00: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00077e10: 2020 2020 2020 2020 6e5f 6573 7469 6d61          n_estima
+00077e20: 746f 7273 203d 2032 3030 2c0d 0a20 2020  tors = 200,..   
 00077e30: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00077e40: 2020 206d 6178 5f66 6561 7475 7265 7320     max_features 
-00077e50: 3d20 2761 7574 6f27 2c0d 0a20 2020 2020  = 'auto',..     
-00077e60: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00077e70: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00077e80: 2020 6d69 6e5f 7361 6d70 6c65 735f 6c65    min_samples_le
-00077e90: 6166 203d 2032 2c0d 0a20 2020 2020 2020  af = 2,..       
-00077ea0: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00077eb0: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00077ec0: 6e5f 6573 7469 6d61 746f 7273 203d 2032  n_estimators = 2
-00077ed0: 3030 2c0d 0a20 2020 2020 2020 2020 2020  00,..           
-00077ee0: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00077ef0: 2020 2020 2020 2020 2020 2020 7261 6e64              rand
-00077f00: 6f6d 5f73 7461 7465 3d39 3929 0d0a 2020  om_state=99)..  
-00077f10: 2020 2020 2020 2020 2020 6d6f 6465 6c5f            model_
-00077f20: 7475 706c 6573 2e61 7070 656e 6428 2827  tuples.append(('
-00077f30: 4261 6767 696e 675f 436c 6173 7369 6669  Bagging_Classifi
-00077f40: 6572 272c 6d6f 6465 6c38 2929 0d0a 2020  er',model8))..  
-00077f50: 2020 2020 2020 656c 6966 206e 6f74 2042        elif not B
-00077f60: 6f6f 7374 696e 675f 466c 6167 3a0d 0a20  oosting_Flag:.. 
-00077f70: 2020 2020 2020 2020 2020 2023 2323 2320             #### 
-00077f80: 4966 2074 6865 2042 6f6f 7374 696e 675f  If the Boosting_
-00077f90: 466c 6167 2069 7320 5472 7565 2c20 6974  Flag is True, it
-00077fa0: 206d 6561 6e73 2042 6f6f 7374 696e 6720   means Boosting 
-00077fb0: 6d6f 6465 6c20 6973 2070 7265 7365 6e74  model is present
-00077fc0: 2e0d 0a20 2020 2020 2020 2020 2020 2023  ...            #
-00077fd0: 2323 2020 2053 6f20 6368 6f6f 7365 2061  ##   So choose a
-00077fe0: 2064 6966 6665 7265 6e74 206b 696e 6420   different kind 
-00077ff0: 6f66 2063 6c61 7373 6966 6965 7220 6865  of classifier he
-00078000: 7265 0d0a 2020 2020 2020 2020 2020 2020  re..            
-00078010: 7367 645f 6265 7374 5f6d 6f64 656c 203d  sgd_best_model =
-00078020: 2053 4744 436c 6173 7369 6669 6572 2861   SGDClassifier(a
-00078030: 6c70 6861 3d31 652d 3036 2c0d 0a20 2020  lpha=1e-06,..   
-00078040: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00078050: 2020 2020 2020 2020 2020 2020 206c 6f73               los
-00078060: 733d 276c 6f67 272c 0d0a 2020 2020 2020  s='log',..      
+00077e40: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00077e50: 2020 2020 7261 6e64 6f6d 5f73 7461 7465      random_state
+00077e60: 3d39 3929 0d0a 2020 2020 2020 2020 2020  =99)..          
+00077e70: 2020 6d6f 6465 6c5f 7475 706c 6573 2e61    model_tuples.a
+00077e80: 7070 656e 6428 2827 5246 5f52 6567 7265  ppend(('RF_Regre
+00077e90: 7373 6f72 272c 6d6f 6465 6c38 2929 0d0a  ssor',model8))..
+00077ea0: 2020 2020 656c 7365 3a0d 0a20 2020 2020      else:..     
+00077eb0: 2020 2069 6620 7363 6f72 696e 6720 3d3d     if scoring ==
+00077ec0: 2027 273a 0d0a 2020 2020 2020 2020 2020   '':..          
+00077ed0: 2020 7363 6f72 696e 6720 3d20 2761 6363    scoring = 'acc
+00077ee0: 7572 6163 7927 0d0a 2020 2020 2020 2020  uracy'..        
+00077ef0: 6e75 6d5f 636c 6173 7365 7320 3d20 6c65  num_classes = le
+00077f00: 6e28 6e70 2e75 6e69 7175 6528 795f 7465  n(np.unique(y_te
+00077f10: 7374 2929 0d0a 2020 2020 2020 2020 7363  st))..        sc
+00077f20: 7620 3d20 5374 7261 7469 6669 6564 4b46  v = StratifiedKF
+00077f30: 6f6c 6428 6e5f 7370 6c69 7473 3d46 4f4c  old(n_splits=FOL
+00077f40: 4453 2c20 7368 7566 666c 653d 5472 7565  DS, shuffle=True
+00077f50: 2c20 7261 6e64 6f6d 5f73 7461 7465 3d73  , random_state=s
+00077f60: 6565 6429 0d0a 2020 2020 2020 2020 6966  eed)..        if
+00077f70: 2042 6f6f 7374 696e 675f 466c 6167 2069   Boosting_Flag i
+00077f80: 7320 4e6f 6e65 3a0d 0a20 2020 2020 2020  s None:..       
+00077f90: 2020 2020 2023 2320 4372 6561 7465 2061       ## Create a
+00077fa0: 6e20 656e 7365 6d62 6c65 206d 6f64 656c  n ensemble model
+00077fb0: 2023 2323 230d 0a20 2020 2020 2020 2020   ####..         
+00077fc0: 2020 206d 6f64 656c 3520 3d20 4164 6142     model5 = AdaB
+00077fd0: 6f6f 7374 436c 6173 7369 6669 6572 2862  oostClassifier(b
+00077fe0: 6173 655f 6573 7469 6d61 746f 723d 4465  ase_estimator=De
+00077ff0: 6369 7369 6f6e 5472 6565 436c 6173 7369  cisionTreeClassi
+00078000: 6669 6572 280d 0a20 2020 2020 2020 2020  fier(..         
+00078010: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00078020: 2020 2020 2020 2020 2020 2072 616e 646f             rando
+00078030: 6d5f 7374 6174 653d 7365 6564 2c20 6d61  m_state=seed, ma
+00078040: 785f 6465 7074 683d 312c 206d 696e 5f73  x_depth=1, min_s
+00078050: 616d 706c 6573 5f6c 6561 663d 320d 0a20  amples_leaf=2.. 
+00078060: 2020 2020 2020 2020 2020 2020 2020 2020                  
 00078070: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00078080: 2020 2020 2020 2020 206d 6178 5f69 7465           max_ite
-00078090: 723d 3130 3030 2c0d 0a20 2020 2020 2020  r=1000,..       
-000780a0: 2020 2020 2020 2020 2020 2020 2020 2020                  
-000780b0: 2020 2020 2020 2020 7065 6e61 6c74 793d          penalty=
-000780c0: 276c 3227 2c0d 0a20 2020 2020 2020 2020  'l2',..         
-000780d0: 2020 2020 2020 2020 2020 2020 2020 2020                  
-000780e0: 2020 2020 2020 6c65 6172 6e69 6e67 5f72        learning_r
-000780f0: 6174 6520 3d20 2763 6f6e 7374 616e 7427  ate = 'constant'
-00078100: 2c0d 0a20 2020 2020 2020 2020 2020 2020  ,..             
-00078110: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00078120: 2020 6574 6130 203d 202e 312c 0d0a 2020    eta0 = .1,..  
-00078130: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00078140: 2020 2020 2020 2020 2020 2020 2072 616e               ran
-00078150: 646f 6d5f 7374 6174 6520 3d20 332c 0d0a  dom_state = 3,..
-00078160: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00078170: 2020 2020 2020 2020 2020 2020 2020 2074                 t
-00078180: 6f6c 3d4e 6f6e 6529 0d0a 2020 2020 2020  ol=None)..      
-00078190: 2020 2020 2020 6d6f 6465 6c38 203d 204f        model8 = O
-000781a0: 6e65 5673 5265 7374 436c 6173 7369 6669  neVsRestClassifi
-000781b0: 6572 2873 6764 5f62 6573 745f 6d6f 6465  er(sgd_best_mode
-000781c0: 6c29 0d0a 2020 2020 2020 2020 2020 2020  l)..            
-000781d0: 6d6f 6465 6c5f 7475 706c 6573 2e61 7070  model_tuples.app
-000781e0: 656e 6428 2827 4f6e 655f 7673 5f52 6573  end(('One_vs_Res
-000781f0: 745f 436c 6173 7369 6669 6572 272c 6d6f  t_Classifier',mo
-00078200: 6465 6c38 2929 0d0a 2020 2020 2020 2020  del8))..        
-00078210: 656c 7365 3a0d 0a20 2020 2020 2020 2020  else:..         
-00078220: 2020 206d 6f64 656c 3820 3d20 5261 6e64     model8 = Rand
-00078230: 6f6d 466f 7265 7374 436c 6173 7369 6669  omForestClassifi
-00078240: 6572 2862 6f6f 7473 7472 6170 203d 2046  er(bootstrap = F
-00078250: 616c 7365 2c0d 0a20 2020 2020 2020 2020  alse,..         
-00078260: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00078270: 2020 2020 2020 2020 2020 2020 2020 6d61                ma
-00078280: 785f 6465 7074 6820 3d20 3130 2c0d 0a20  x_depth = 10,.. 
-00078290: 2020 2020 2020 2020 2020 2020 2020 2020                  
-000782a0: 2020 2020 2020 2020 2020 2020 2020 2020                  
-000782b0: 2020 2020 2020 6d61 785f 6665 6174 7572        max_featur
-000782c0: 6573 203d 2027 6175 746f 272c 0d0a 2020  es = 'auto',..  
-000782d0: 2020 2020 2020 2020 2020 2020 2020 2020                  
-000782e0: 2020 2020 2020 2020 2020 2020 2020 2020                  
-000782f0: 2020 2020 206d 696e 5f73 616d 706c 6573       min_samples
-00078300: 5f6c 6561 6620 3d20 322c 0d0a 2020 2020  _leaf = 2,..    
-00078310: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00078320: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00078330: 2020 206e 5f65 7374 696d 6174 6f72 7320     n_estimators 
-00078340: 3d20 3230 302c 0d0a 2020 2020 2020 2020  = 200,..        
-00078350: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00078360: 2020 2020 2020 2020 2020 2020 2020 2072                 r
-00078370: 616e 646f 6d5f 7374 6174 653d 3939 290d  andom_state=99).
-00078380: 0a20 2020 2020 2020 2020 2020 206d 6f64  .            mod
-00078390: 656c 5f74 7570 6c65 732e 6170 7065 6e64  el_tuples.append
-000783a0: 2828 2742 6167 6769 6e67 5f43 6c61 7373  (('Bagging_Class
-000783b0: 6966 6965 7227 2c6d 6f64 656c 3829 290d  ifier',model8)).
-000783c0: 0a20 2020 206d 6f64 656c 5f64 6963 7420  .    model_dict 
-000783d0: 3d20 6469 6374 286d 6f64 656c 5f74 7570  = dict(model_tup
-000783e0: 6c65 7329 0d0a 2020 2020 6d6f 6465 6c73  les)..    models
-000783f0: 2c20 7265 7375 6c74 7320 3d20 7275 6e5f  , results = run_
-00078400: 656e 7365 6d62 6c65 5f6d 6f64 656c 7328  ensemble_models(
-00078410: 6d6f 6465 6c5f 6469 6374 2c20 585f 7472  model_dict, X_tr
-00078420: 6169 6e2c 2079 5f74 7261 696e 2c20 585f  ain, y_train, X_
-00078430: 7465 7374 2c20 795f 7465 7374 2c0d 0a20  test, y_test,.. 
-00078440: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00078450: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00078460: 2020 2020 2020 2020 2073 636f 7269 6e67           scoring
-00078470: 2c20 6d6f 6465 6c74 7970 6529 0d0a 2020  , modeltype)..  
-00078480: 2020 7265 7475 726e 206d 6f64 656c 732c    return models,
-00078490: 2072 6573 756c 7473 0d0a 2323 2323 2323   results..######
-000784a0: 2323 2323 2323 2323 2323 2323 2323 2323  ################
-000784b0: 2323 2323 2323 2323 2323 2323 2323 2323  ################
-000784c0: 2323 2323 2323 2323 2323 2323 2323 2323  ################
-000784d0: 2323 230d 0a66 726f 6d20 736b 6c65 6172  ###..from sklear
-000784e0: 6e2e 6d65 7472 6963 7320 696d 706f 7274  n.metrics import
-000784f0: 2062 616c 616e 6365 645f 6163 6375 7261   balanced_accura
-00078500: 6379 5f73 636f 7265 2c61 6363 7572 6163  cy_score,accurac
-00078510: 795f 7363 6f72 652c 7072 6563 6973 696f  y_score,precisio
-00078520: 6e5f 7363 6f72 652c 7265 6361 6c6c 5f73  n_score,recall_s
-00078530: 636f 7265 2c66 315f 7363 6f72 650d 0a66  core,f1_score..f
-00078540: 726f 6d20 736b 6c65 6172 6e2e 6d65 7472  rom sklearn.metr
-00078550: 6963 7320 696d 706f 7274 206d 6561 6e5f  ics import mean_
-00078560: 6162 736f 6c75 7465 5f65 7272 6f72 2c20  absolute_error, 
-00078570: 6d65 616e 5f73 7175 6172 6564 5f65 7272  mean_squared_err
-00078580: 6f72 0d0a 696d 706f 7274 2063 6f70 790d  or..import copy.
-00078590: 0a66 726f 6d20 736b 6c65 6172 6e2e 6c69  .from sklearn.li
-000785a0: 6e65 6172 5f6d 6f64 656c 2069 6d70 6f72  near_model impor
-000785b0: 7420 4c69 6e65 6172 5265 6772 6573 7369  t LinearRegressi
-000785c0: 6f6e 0d0a 6672 6f6d 2073 6b6c 6561 726e  on..from sklearn
-000785d0: 2e6c 696e 6561 725f 6d6f 6465 6c20 696d  .linear_model im
-000785e0: 706f 7274 204c 6f67 6973 7469 6352 6567  port LogisticReg
-000785f0: 7265 7373 696f 6e0d 0a64 6566 2072 756e  ression..def run
-00078600: 5f65 6e73 656d 626c 655f 6d6f 6465 6c73  _ensemble_models
-00078610: 286d 6f64 656c 5f64 6963 742c 2058 5f74  (model_dict, X_t
-00078620: 7261 696e 2c20 795f 7472 6169 6e2c 2058  rain, y_train, X
-00078630: 5f74 6573 742c 2079 5f74 6573 742c 2073  _test, y_test, s
-00078640: 636f 7269 6e67 2c20 6d6f 6465 6c74 7970  coring, modeltyp
-00078650: 6529 3a0d 0a20 2020 2073 7461 7274 5f74  e):..    start_t
-00078660: 696d 6520 3d20 7469 6d65 2e74 696d 6528  ime = time.time(
-00078670: 290d 0a20 2020 206d 6f64 656c 5f6e 616d  )..    model_nam
-00078680: 652c 2020 6261 635f 7363 6f72 655f 6c69  e,  bac_score_li
-00078690: 7374 2c20 6163 5f73 636f 7265 5f6c 6973  st, ac_score_lis
-000786a0: 742c 2070 5f73 636f 7265 5f6c 6973 742c  t, p_score_list,
-000786b0: 2072 5f73 636f 7265 5f6c 6973 742c 2066   r_score_list, f
-000786c0: 315f 7363 6f72 655f 6c69 7374 203d 205b  1_score_list = [
-000786d0: 5d2c 205b 5d2c 205b 5d2c 205b 5d2c 205b  ], [], [], [], [
-000786e0: 5d2c 205b 5d0d 0a20 2020 2069 7465 7261  ], []..    itera
-000786f0: 7469 6f6e 203d 2030 0d0a 2020 2020 6573  tion = 0..    es
-00078700: 7469 6d61 746f 7273 203d 205b 5d0d 0a20  timators = [].. 
-00078710: 2020 2065 7374 696d 5f74 7570 6c65 7320     estim_tuples 
-00078720: 3d20 5b5d 0d0a 2020 2020 666f 7220 6b65  = []..    for ke
-00078730: 792c 7661 6c20 696e 206d 6f64 656c 5f64  y,val in model_d
-00078740: 6963 742e 6974 656d 7328 293a 0d0a 2020  ict.items():..  
-00078750: 2020 2020 2020 6573 7469 6d61 746f 725f        estimator_
-00078760: 6e61 6d65 203d 206b 6579 0d0a 2020 2020  name = key..    
-00078770: 2020 2020 6d6f 6465 6c5f 6e61 6d65 2e61      model_name.a
-00078780: 7070 656e 6428 6b65 7929 0d0a 2020 2020  ppend(key)..    
-00078790: 2020 2020 6966 2073 7472 2876 616c 292e      if str(val).
-000787a0: 7370 6c69 7428 2228 2229 5b30 5d20 3d3d  split("(")[0] ==
-000787b0: 2027 4d75 6c74 696e 6f6d 6961 6c4e 4227   'MultinomialNB'
-000787c0: 3a0d 0a20 2020 2020 2020 2020 2020 2023  :..            #
-000787d0: 2323 2320 4d75 6c74 696e 6f6d 6961 6c20  ### Multinomial 
-000787e0: 6d6f 6465 6c73 206e 6565 6420 6f6e 6c79  models need only
-000787f0: 2070 6f73 6974 6976 6520 7661 6c75 6573   positive values
-00078800: 2121 0d0a 2020 2020 2020 2020 2020 2020  !!..            
-00078810: 7661 6c2e 6669 7428 6162 7328 585f 7472  val.fit(abs(X_tr
-00078820: 6169 6e29 2c20 795f 7472 6169 6e29 0d0a  ain), y_train)..
-00078830: 2020 2020 2020 2020 2020 2020 795f 7072              y_pr
-00078840: 6564 203d 2076 616c 2e70 7265 6469 6374  ed = val.predict
-00078850: 2861 6273 2858 5f74 6573 7429 290d 0a20  (abs(X_test)).. 
-00078860: 2020 2020 2020 2065 6c73 653a 0d0a 2020         else:..  
-00078870: 2020 2020 2020 2020 2020 7472 793a 0d0a            try:..
-00078880: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00078890: 7661 6c2e 6669 7428 585f 7472 6169 6e2c  val.fit(X_train,
-000788a0: 2079 5f74 7261 696e 290d 0a20 2020 2020   y_train)..     
-000788b0: 2020 2020 2020 2020 2020 2079 5f70 7265             y_pre
-000788c0: 6420 3d20 7661 6c2e 7072 6564 6963 7428  d = val.predict(
-000788d0: 585f 7465 7374 290d 0a20 2020 2020 2020  X_test)..       
-000788e0: 2020 2020 2065 7863 6570 743a 0d0a 2020       except:..  
-000788f0: 2020 2020 2020 2020 2020 2020 2020 6966                if
-00078900: 206d 6f64 656c 7479 7065 2021 3d20 2752   modeltype != 'R
-00078910: 6567 7265 7373 696f 6e27 3a0d 0a20 2020  egression':..   
-00078920: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00078930: 206b 6579 203d 2027 4c6f 6769 7374 6963   key = 'Logistic
-00078940: 5f52 6567 7265 7373 696f 6e27 0d0a 2020  _Regression'..  
-00078950: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00078960: 2020 7661 6c20 3d20 4c6f 6769 7374 6963    val = Logistic
-00078970: 5265 6772 6573 7369 6f6e 2829 0d0a 2020  Regression()..  
-00078980: 2020 2020 2020 2020 2020 2020 2020 656c                el
-00078990: 7365 3a0d 0a20 2020 2020 2020 2020 2020  se:..           
-000789a0: 2020 2020 2020 2020 206b 6579 203d 2027           key = '
-000789b0: 4c69 6e65 6172 5f52 6567 7265 7373 696f  Linear_Regressio
-000789c0: 6e27 0d0a 2020 2020 2020 2020 2020 2020  n'..            
-000789d0: 2020 2020 2020 2020 7661 6c20 3d20 4c69          val = Li
-000789e0: 6e65 6172 5265 6772 6573 7369 6f6e 2829  nearRegression()
-000789f0: 0d0a 2020 2020 2020 2020 2020 2020 2020  ..              
-00078a00: 2020 7661 6c2e 6669 7428 585f 7472 6169    val.fit(X_trai
-00078a10: 6e2c 2079 5f74 7261 696e 290d 0a20 2020  n, y_train)..   
-00078a20: 2020 2020 2074 7279 3a0d 0a20 2020 2020       try:..     
-00078a30: 2020 2020 2020 2079 5f70 7265 6420 3d20         y_pred = 
-00078a40: 7661 6c2e 7072 6564 6963 7428 585f 7465  val.predict(X_te
-00078a50: 7374 290d 0a20 2020 2020 2020 2065 7863  st)..        exc
-00078a60: 6570 743a 0d0a 2020 2020 2020 2020 2020  ept:..          
-00078a70: 2020 7072 696e 7428 2745 7272 6f72 2069    print('Error i
-00078a80: 6e20 656e 7365 6d62 6c65 206d 6f64 656c  n ensemble model
-00078a90: 732e 2052 6574 7572 6e69 6e67 2e2e 2e27  s. Returning...'
-00078aa0: 290d 0a20 2020 2020 2020 2020 2020 2073  )..            s
-00078ab0: 7461 636b 7320 3d20 6e70 2e61 7272 6179  tacks = np.array
-00078ac0: 285b 5d29 0d0a 2020 2020 2020 2020 2020  ([])..          
-00078ad0: 2020 7265 7475 726e 206d 6f64 656c 5f6e    return model_n
-00078ae0: 616d 652c 2073 7461 636b 730d 0a20 2020  ame, stacks..   
-00078af0: 2020 2020 2069 6620 6974 6572 6174 696f       if iteratio
-00078b00: 6e20 3d3d 2030 3a0d 0a20 2020 2020 2020  n == 0:..       
-00078b10: 2020 2020 2073 7461 636b 7320 3d20 636f       stacks = co
-00078b20: 7079 2e64 6565 7063 6f70 7928 795f 7072  py.deepcopy(y_pr
-00078b30: 6564 290d 0a20 2020 2020 2020 2020 2020  ed)..           
-00078b40: 2069 7465 7261 7469 6f6e 202b 3d20 310d   iteration += 1.
-00078b50: 0a20 2020 2020 2020 2065 6c73 653a 0d0a  .        else:..
-00078b60: 2020 2020 2020 2020 2020 2020 7374 6163              stac
-00078b70: 6b73 203d 206e 702e 635f 5b73 7461 636b  ks = np.c_[stack
-00078b80: 732c 795f 7072 6564 5d0d 0a20 2020 2020  s,y_pred]..     
-00078b90: 2020 2069 6620 6e6f 7420 6973 696e 7374     if not isinst
-00078ba0: 616e 6365 2879 5f74 6573 742c 7374 7229  ance(y_test,str)
-00078bb0: 3a0d 0a20 2020 2020 2020 2020 2020 2069  :..            i
-00078bc0: 6620 6d6f 6465 6c74 7970 6520 3d3d 2027  f modeltype == '
-00078bd0: 5265 6772 6573 7369 6f6e 273a 0d0a 2020  Regression':..  
-00078be0: 2020 2020 2020 2020 2020 2020 2020 6261                ba
-00078bf0: 635f 7363 6f72 6520 3d20 6e70 2e73 7172  c_score = np.sqr
-00078c00: 7428 6d65 616e 5f73 7175 6172 6564 5f65  t(mean_squared_e
-00078c10: 7272 6f72 2879 5f74 6573 742c 2079 5f70  rror(y_test, y_p
-00078c20: 7265 6429 290d 0a20 2020 2020 2020 2020  red))..         
-00078c30: 2020 2020 2020 2065 7374 696d 6174 6f72         estimator
-00078c40: 732e 6170 7065 6e64 2828 6573 7469 6d61  s.append((estima
-00078c50: 746f 725f 6e61 6d65 2c76 616c 2c20 6261  tor_name,val, ba
-00078c60: 635f 7363 6f72 6529 290d 0a20 2020 2020  c_score))..     
-00078c70: 2020 2020 2020 2020 2020 2065 7374 696d             estim
-00078c80: 5f74 7570 6c65 732e 6170 7065 6e64 2828  _tuples.append((
-00078c90: 6573 7469 6d61 746f 725f 6e61 6d65 2c20  estimator_name, 
-00078ca0: 6261 635f 7363 6f72 6529 290d 0a20 2020  bac_score))..   
-00078cb0: 2020 2020 2020 2020 2020 2020 2062 6163               bac
-00078cc0: 5f73 636f 7265 5f6c 6973 742e 6170 7065  _score_list.appe
-00078cd0: 6e64 2862 6163 5f73 636f 7265 290d 0a20  nd(bac_score).. 
-00078ce0: 2020 2020 2020 2020 2020 2020 2020 2061                 a
-00078cf0: 635f 7363 6f72 655f 6c69 7374 2e61 7070  c_score_list.app
-00078d00: 656e 6428 6d65 616e 5f73 7175 6172 6564  end(mean_squared
-00078d10: 5f65 7272 6f72 2879 5f74 6573 742c 2079  _error(y_test, y
-00078d20: 5f70 7265 6429 290d 0a20 2020 2020 2020  _pred))..       
-00078d30: 2020 2020 2020 2020 2070 5f73 636f 7265           p_score
-00078d40: 5f6c 6973 742e 6170 7065 6e64 286d 6561  _list.append(mea
-00078d50: 6e5f 6162 736f 6c75 7465 5f65 7272 6f72  n_absolute_error
-00078d60: 2879 5f74 6573 742c 2079 5f70 7265 6429  (y_test, y_pred)
-00078d70: 290d 0a20 2020 2020 2020 2020 2020 2020  )..             
-00078d80: 2020 206d 6f64 656c 5f63 6f6d 7061 7269     model_compari
-00078d90: 736f 6e5f 6466 203d 2070 642e 4461 7461  son_df = pd.Data
-00078da0: 4672 616d 6528 5b6d 6f64 656c 5f6e 616d  Frame([model_nam
-00078db0: 652c 2062 6163 5f73 636f 7265 5f6c 6973  e, bac_score_lis
-00078dc0: 742c 2061 635f 7363 6f72 655f 6c69 7374  t, ac_score_list
-00078dd0: 2c70 5f73 636f 7265 5f6c 6973 745d 292e  ,p_score_list]).
-00078de0: 540d 0a20 2020 2020 2020 2020 2020 2020  T..             
-00078df0: 2020 206d 6f64 656c 5f63 6f6d 7061 7269     model_compari
-00078e00: 736f 6e5f 6466 2e63 6f6c 756d 6e73 203d  son_df.columns =
-00078e10: 205b 276d 6f64 656c 5f6e 616d 6527 2c20   ['model_name', 
-00078e20: 2752 4d53 4527 2c20 274d 5345 272c 274d  'RMSE', 'MSE','M
-00078e30: 4145 275d 0d0a 2020 2020 2020 2020 2020  AE']..          
-00078e40: 2020 2020 2020 6d6f 6465 6c5f 636f 6d70        model_comp
-00078e50: 6172 6973 6f6e 5f64 6620 3d20 6d6f 6465  arison_df = mode
-00078e60: 6c5f 636f 6d70 6172 6973 6f6e 5f64 662e  l_comparison_df.
-00078e70: 736f 7274 5f76 616c 7565 7328 6279 3d27  sort_values(by='
-00078e80: 524d 5345 272c 2061 7363 656e 6469 6e67  RMSE', ascending
-00078e90: 3d54 7275 6529 0d0a 2020 2020 2020 2020  =True)..        
-00078ea0: 2020 2020 656c 7365 3a0d 0a20 2020 2020      else:..     
-00078eb0: 2020 2020 2020 2020 2020 2062 6163 5f73             bac_s
-00078ec0: 636f 7265 203d 2062 616c 616e 6365 645f  core = balanced_
-00078ed0: 6163 6375 7261 6379 5f73 636f 7265 2879  accuracy_score(y
-00078ee0: 5f74 6573 742c 2079 5f70 7265 6429 0d0a  _test, y_pred)..
-00078ef0: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00078f00: 6573 7469 6d61 746f 7273 2e61 7070 656e  estimators.appen
-00078f10: 6428 2865 7374 696d 6174 6f72 5f6e 616d  d((estimator_nam
-00078f20: 652c 7661 6c2c 2062 6163 5f73 636f 7265  e,val, bac_score
-00078f30: 2929 0d0a 2020 2020 2020 2020 2020 2020  ))..            
-00078f40: 2020 2020 6573 7469 6d5f 7475 706c 6573      estim_tuples
-00078f50: 2e61 7070 656e 6428 2865 7374 696d 6174  .append((estimat
-00078f60: 6f72 5f6e 616d 652c 2062 6163 5f73 636f  or_name, bac_sco
-00078f70: 7265 2929 0d0a 2020 2020 2020 2020 2020  re))..          
-00078f80: 2020 2020 2020 6261 635f 7363 6f72 655f        bac_score_
-00078f90: 6c69 7374 2e61 7070 656e 6428 6261 6c61  list.append(bala
-00078fa0: 6e63 6564 5f61 6363 7572 6163 795f 7363  nced_accuracy_sc
-00078fb0: 6f72 6528 795f 7465 7374 2c20 795f 7072  ore(y_test, y_pr
-00078fc0: 6564 2929 0d0a 2020 2020 2020 2020 2020  ed))..          
-00078fd0: 2020 2020 2020 6163 5f73 636f 7265 5f6c        ac_score_l
-00078fe0: 6973 742e 6170 7065 6e64 2861 6363 7572  ist.append(accur
-00078ff0: 6163 795f 7363 6f72 6528 795f 7465 7374  acy_score(y_test
-00079000: 2c20 795f 7072 6564 2929 0d0a 2020 2020  , y_pred))..    
-00079010: 2020 2020 2020 2020 2020 2020 705f 7363              p_sc
-00079020: 6f72 655f 6c69 7374 2e61 7070 656e 6428  ore_list.append(
-00079030: 7072 6563 6973 696f 6e5f 7363 6f72 6528  precision_score(
-00079040: 795f 7465 7374 2c20 795f 7072 6564 2c20  y_test, y_pred, 
-00079050: 6176 6572 6167 653d 276d 6163 726f 2729  average='macro')
-00079060: 290d 0a20 2020 2020 2020 2020 2020 2020  )..             
-00079070: 2020 2072 5f73 636f 7265 5f6c 6973 742e     r_score_list.
-00079080: 6170 7065 6e64 2872 6563 616c 6c5f 7363  append(recall_sc
-00079090: 6f72 6528 795f 7465 7374 2c20 795f 7072  ore(y_test, y_pr
-000790a0: 6564 2c20 6176 6572 6167 653d 276d 6163  ed, average='mac
-000790b0: 726f 2729 290d 0a20 2020 2020 2020 2020  ro'))..         
-000790c0: 2020 2020 2020 2066 315f 7363 6f72 655f         f1_score_
-000790d0: 6c69 7374 2e61 7070 656e 6428 6631 5f73  list.append(f1_s
-000790e0: 636f 7265 2879 5f74 6573 742c 2079 5f70  core(y_test, y_p
-000790f0: 7265 642c 2061 7665 7261 6765 3d27 6d61  red, average='ma
-00079100: 6372 6f27 2929 0d0a 2020 2020 2020 2020  cro'))..        
-00079110: 2020 2020 2020 2020 6d6f 6465 6c5f 636f          model_co
-00079120: 6d70 6172 6973 6f6e 5f64 6620 3d20 7064  mparison_df = pd
-00079130: 2e44 6174 6146 7261 6d65 285b 6d6f 6465  .DataFrame([mode
-00079140: 6c5f 6e61 6d65 2c20 6261 635f 7363 6f72  l_name, bac_scor
-00079150: 655f 6c69 7374 2c20 6163 5f73 636f 7265  e_list, ac_score
-00079160: 5f6c 6973 742c 2070 5f73 636f 7265 5f6c  _list, p_score_l
-00079170: 6973 742c 0d0a 2020 2020 2020 2020 2020  ist,..          
-00079180: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00079190: 2020 2020 2020 2020 2020 2020 2020 2020                  
-000791a0: 2020 2020 2020 2020 2020 2020 2020 2072                 r
-000791b0: 5f73 636f 7265 5f6c 6973 742c 2066 315f  _score_list, f1_
-000791c0: 7363 6f72 655f 6c69 7374 5d29 2e54 0d0a  score_list]).T..
-000791d0: 2020 2020 2020 2020 2020 2020 2020 2020                  
-000791e0: 6d6f 6465 6c5f 636f 6d70 6172 6973 6f6e  model_comparison
-000791f0: 5f64 662e 636f 6c75 6d6e 7320 3d20 5b27  _df.columns = ['
-00079200: 6d6f 6465 6c5f 6e61 6d65 272c 2027 6261  model_name', 'ba
-00079210: 6c5f 6163 6375 7261 6379 5f73 636f 7265  l_accuracy_score
-00079220: 272c 2027 6163 6375 7261 6379 5f73 636f  ', 'accuracy_sco
-00079230: 7265 272c 0d0a 2020 2020 2020 2020 2020  re',..          
-00079240: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00079250: 2020 2020 2020 2020 2020 2020 2020 2027                 '
-00079260: 6176 655f 7072 6563 6973 696f 6e5f 7363  ave_precision_sc
-00079270: 6f72 6527 2c20 2761 7665 5f72 6563 616c  ore', 'ave_recal
-00079280: 6c5f 7363 6f72 6527 2c20 2761 7665 5f66  l_score', 'ave_f
-00079290: 315f 7363 6f72 6527 5d0d 0a20 2020 2020  1_score']..     
-000792a0: 2020 2020 2020 2020 2020 206d 6f64 656c             model
-000792b0: 5f63 6f6d 7061 7269 736f 6e5f 6466 203d  _comparison_df =
-000792c0: 206d 6f64 656c 5f63 6f6d 7061 7269 736f   model_compariso
-000792d0: 6e5f 6466 2e73 6f72 745f 7661 6c75 6573  n_df.sort_values
-000792e0: 2862 793d 2762 616c 5f61 6363 7572 6163  (by='bal_accurac
-000792f0: 795f 7363 6f72 6527 2c20 6173 6365 6e64  y_score', ascend
-00079300: 696e 673d 4661 6c73 6529 0d0a 2020 2020  ing=False)..    
-00079310: 6966 206e 6f74 2069 7369 6e73 7461 6e63  if not isinstanc
-00079320: 6528 795f 7465 7374 2c20 7374 7229 3a0d  e(y_test, str):.
-00079330: 0a20 2020 2020 2020 2064 6174 615f 6672  .        data_fr
-00079340: 616d 6520 3d20 6d6f 6465 6c5f 636f 6d70  ame = model_comp
-00079350: 6172 6973 6f6e 5f64 662e 7365 745f 696e  arison_df.set_in
-00079360: 6465 7828 276d 6f64 656c 5f6e 616d 6527  dex('model_name'
-00079370: 292e 6173 7479 7065 2866 6c6f 6174 290d  ).astype(float).
-00079380: 0a20 2020 2020 2020 2070 6c74 2e66 6967  .        plt.fig
-00079390: 7572 6528 6669 6773 697a 653d 2831 302c  ure(figsize=(10,
-000793a0: 3130 2929 0d0a 2020 2020 2020 2020 6720  10))..        g 
-000793b0: 3d20 736e 732e 6865 6174 6d61 7028 6461  = sns.heatmap(da
-000793c0: 7461 5f66 7261 6d65 2c61 6e6e 6f74 3d54  ta_frame,annot=T
-000793d0: 7275 652c 666d 743d 2730 2e32 6627 2c63  rue,fmt='0.2f',c
-000793e0: 6261 723d 4661 6c73 6529 0d0a 2020 2020  bar=False)..    
-000793f0: 2020 2020 672e 7365 745f 7874 6963 6b6c      g.set_xtickl
-00079400: 6162 656c 7328 672e 6765 745f 7874 6963  abels(g.get_xtic
-00079410: 6b6c 6162 656c 7328 292c 2072 6f74 6174  klabels(), rotat
-00079420: 696f 6e20 3d20 3435 2c20 666f 6e74 7369  ion = 45, fontsi
-00079430: 7a65 203d 2031 3229 0d0a 2020 2020 2020  ze = 12)..      
-00079440: 2020 672e 7365 745f 7974 6963 6b6c 6162    g.set_yticklab
-00079450: 656c 7328 672e 6765 745f 7974 6963 6b6c  els(g.get_ytickl
-00079460: 6162 656c 7328 292c 2072 6f74 6174 696f  abels(), rotatio
-00079470: 6e20 3d20 302c 2066 6f6e 7473 697a 6520  n = 0, fontsize 
-00079480: 3d20 3132 290d 0a20 2020 2020 2020 2070  = 12)..        p
-00079490: 7269 6e74 2827 5469 6d65 2074 616b 656e  rint('Time taken
-000794a0: 203d 2025 302e 3066 2073 6563 6f6e 6473   = %0.0f seconds
-000794b0: 2720 2528 7469 6d65 2e74 696d 6528 292d  ' %(time.time()-
-000794c0: 7374 6172 745f 7469 6d65 2929 0d0a 2020  start_time))..  
-000794d0: 2020 2020 2020 672e 7365 745f 7469 746c        g.set_titl
-000794e0: 6528 2751 7569 636b 4d4c 2045 6e73 656d  e('QuickML Ensem
-000794f0: 626c 696e 6720 4d6f 6465 6c73 2052 6573  bling Models Res
-00079500: 756c 7473 272c 666f 6e74 7369 7a65 3d31  ults',fontsize=1
-00079510: 3829 0d0a 2020 2020 2020 2020 6631 5f73  8)..        f1_s
-00079520: 7461 7473 203d 2064 6963 7428 6573 7469  tats = dict(esti
-00079530: 6d5f 7475 706c 6573 290d 0a20 2020 2020  m_tuples)..     
-00079540: 2020 2074 7279 3a0d 0a20 2020 2020 2020     try:..       
-00079550: 2020 2020 2069 6620 7363 6f72 696e 6720       if scoring 
-00079560: 696e 205b 276c 6f67 6c6f 7373 272c 2772  in ['logloss','r
-00079570: 6d73 6527 2c27 6d61 6527 2c27 6d61 7065  mse','mae','mape
-00079580: 272c 2752 4d53 4527 2c27 6e65 675f 6d65  ','RMSE','neg_me
-00079590: 616e 5f73 7175 6172 6564 5f65 7272 6f72  an_squared_error
-000795a0: 275d 3a0d 0a20 2020 2020 2020 2020 2020  ']:..           
-000795b0: 2020 2020 2062 6573 745f 6d6f 6465 6c5f       best_model_
-000795c0: 6e61 6d65 203d 206d 696e 2866 315f 7374  name = min(f1_st
-000795d0: 6174 732e 6974 656d 7328 292c 206b 6579  ats.items(), key
-000795e0: 3d6f 7065 7261 746f 722e 6974 656d 6765  =operator.itemge
-000795f0: 7474 6572 2831 2929 5b30 5d0d 0a20 2020  tter(1))[0]..   
-00079600: 2020 2020 2020 2020 2065 6c73 653a 0d0a           else:..
-00079610: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00079620: 6265 7374 5f6d 6f64 656c 5f6e 616d 6520  best_model_name 
-00079630: 3d20 6d61 7828 6631 5f73 7461 7473 2e69  = max(f1_stats.i
-00079640: 7465 6d73 2829 2c20 6b65 793d 6f70 6572  tems(), key=oper
-00079650: 6174 6f72 2e69 7465 6d67 6574 7465 7228  ator.itemgetter(
-00079660: 3129 295b 305d 0d0a 2020 2020 2020 2020  1))[0]..        
-00079670: 2020 2020 7072 696e 7428 2742 6173 6564      print('Based
-00079680: 206f 6e20 7472 7969 6e67 206d 756c 7469   on trying multi
-00079690: 706c 6520 6d6f 6465 6c73 2c20 4265 7374  ple models, Best
-000796a0: 2074 7970 6520 6f66 2061 6c67 6f72 6974   type of algorit
-000796b0: 686d 2066 6f72 2074 6869 7320 6461 7461  hm for this data
-000796c0: 2073 6574 2069 7320 2573 2720 2562 6573   set is %s' %bes
-000796d0: 745f 6d6f 6465 6c5f 6e61 6d65 290d 0a20  t_model_name).. 
-000796e0: 2020 2020 2020 2065 7863 6570 743a 0d0a         except:..
-000796f0: 2020 2020 2020 2020 2020 2020 7072 696e              prin
-00079700: 7428 2743 6f75 6c64 206e 6f74 2064 6574  t('Could not det
-00079710: 6563 7420 6265 7374 2061 6c67 6f72 6974  ect best algorit
-00079720: 686d 2074 7970 6520 6672 6f6d 2065 6e73  hm type from ens
-00079730: 656d 626c 696e 672e 2043 6f6e 7469 6e75  embling. Continu
-00079740: 696e 672e 2e2e 2729 0d0a 2020 2020 7265  ing...')..    re
-00079750: 7475 726e 206d 6f64 656c 5f6e 616d 652c  turn model_name,
-00079760: 2073 7461 636b 730d 0a23 2323 2323 2323   stacks..#######
-00079770: 2323 2323 2323 2323 2323 2323 2323 2323  ################
-00079780: 2323 2323 2323 2323 2323 2323 2323 2323  ################
-00079790: 2323 2323 2323 2323 2323 2323 2323 2323  ################
-000797a0: 2323 0d0a 0000 0000 0000 0000 0000 0000  ##..............
-000797b0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-000797c0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-000797d0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-000797e0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-000797f0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-00079800: 2e2f 2e2f 4050 6178 4865 6164 6572 0000  ././@PaxHeader..
-00079810: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-00079820: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-00079830: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-00079840: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-00079850: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-00079860: 0000 0000 3030 3030 3030 3000 3030 3030  ....0000000.0000
-00079870: 3030 3000 3030 3030 3030 3000 3030 3030  000.0000000.0000
-00079880: 3030 3030 3032 3600 3030 3030 3030 3030  0000026.00000000
-00079890: 3030 3000 3031 3134 3533 0020 7800 0000  000.011453. x...
-000798a0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-000798b0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-000798c0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-000798d0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-000798e0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-000798f0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-00079900: 0075 7374 6172 0030 3000 0000 0000 0000  .ustar.00.......
-00079910: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-00079920: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-00079930: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-00079940: 0000 0000 0000 0000 0030 3030 3030 3030  .........0000000
-00079950: 0030 3030 3030 3030 0000 0000 0000 0000  .0000000........
-00079960: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-00079970: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-00079980: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-00079990: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-000799a0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-000799b0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-000799c0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-000799d0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-000799e0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-000799f0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-00079a00: 3232 206d 7469 6d65 3d31 3637 3831 3539  22 mtime=1678159
-00079a10: 3732 322e 300a 0000 0000 0000 0000 0000  722.0...........
-00079a20: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-00079a30: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-00079a40: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-00079a50: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-00079a60: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-00079a70: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-00079a80: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-00079a90: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-00079aa0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-00079ab0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-00079ac0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-00079ad0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-00079ae0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-00079af0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-00079b00: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-00079b10: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-00079b20: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-00079b30: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-00079b40: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-00079b50: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-00079b60: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-00079b70: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-00079b80: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-00079b90: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-00079ba0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-00079bb0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-00079bc0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-00079bd0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-00079be0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-00079bf0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-00079c00: 6175 746f 7669 6d6c 2d30 2e31 2e37 3134  autoviml-0.1.714
-00079c10: 2f61 7574 6f76 696d 6c2f 5175 6963 6b4d  /autoviml/QuickM
-00079c20: 4c5f 5374 6163 6b69 6e67 2e70 7900 0000  L_Stacking.py...
-00079c30: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-00079c40: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-00079c50: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-00079c60: 0000 0000 3030 3030 3737 3700 3030 3031  ....0000777.0001
-00079c70: 3735 3000 3030 3031 3735 3000 3030 3030  750.0001750.0000
-00079c80: 3030 3236 3237 3600 3030 3030 3030 3030  0026276.00000000
-00079c90: 3030 3000 3032 3034 3733 0020 3000 0000  000.020473. 0...
-00079ca0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-00079cb0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-00079cc0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-00079cd0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-00079ce0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-00079cf0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-00079d00: 0075 7374 6172 0030 3072 616d 0000 0000  .ustar.00ram....
-00079d10: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-00079d20: 0000 0000 0000 0000 0072 616d 0000 0000  .........ram....
-00079d30: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-00079d40: 0000 0000 0000 0000 0030 3030 3030 3030  .........0000000
-00079d50: 0030 3030 3030 3030 0000 0000 0000 0000  .0000000........
-00079d60: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-00079d70: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-00079d80: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-00079d90: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-00079da0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-00079db0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-00079dc0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-00079dd0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-00079de0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-00079df0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-00079e00: 696d 706f 7274 2070 616e 6461 7320 6173  import pandas as
-00079e10: 2070 640d 0a69 6d70 6f72 7420 6e75 6d70   pd..import nump
-00079e20: 7920 6173 206e 700d 0a69 6d70 6f72 7420  y as np..import 
-00079e30: 7761 726e 696e 6773 0d0a 7761 726e 696e  warnings..warnin
-00079e40: 6773 2e66 696c 7465 7277 6172 6e69 6e67  gs.filterwarning
-00079e50: 7328 2269 676e 6f72 6522 290d 0a66 726f  s("ignore")..fro
-00079e60: 6d20 736b 6c65 6172 6e2e 6d6f 6465 6c5f  m sklearn.model_
-00079e70: 7365 6c65 6374 696f 6e20 696d 706f 7274  selection import
-00079e80: 2063 726f 7373 5f76 616c 5f73 636f 7265   cross_val_score
-00079e90: 2c20 5374 7261 7469 6669 6564 5368 7566  , StratifiedShuf
-00079ea0: 666c 6553 706c 6974 2c20 5469 6d65 5365  fleSplit, TimeSe
-00079eb0: 7269 6573 5370 6c69 740d 0a66 726f 6d20  riesSplit..from 
-00079ec0: 736b 6c65 6172 6e2e 6d6f 6465 6c5f 7365  sklearn.model_se
-00079ed0: 6c65 6374 696f 6e20 696d 706f 7274 2053  lection import S
-00079ee0: 6875 6666 6c65 5370 6c69 742c 5374 7261  huffleSplit,Stra
-00079ef0: 7469 6669 6564 4b46 6f6c 642c 4b46 6f6c  tifiedKFold,KFol
-00079f00: 640d 0a66 726f 6d20 736b 6c65 6172 6e2e  d..from sklearn.
-00079f10: 6469 7363 7269 6d69 6e61 6e74 5f61 6e61  discriminant_ana
-00079f20: 6c79 7369 7320 696d 706f 7274 204c 696e  lysis import Lin
-00079f30: 6561 7244 6973 6372 696d 696e 616e 7441  earDiscriminantA
-00079f40: 6e61 6c79 7369 730d 0a66 726f 6d20 736b  nalysis..from sk
-00079f50: 6c65 6172 6e2e 656e 7365 6d62 6c65 2069  learn.ensemble i
-00079f60: 6d70 6f72 7420 4261 6767 696e 6752 6567  mport BaggingReg
-00079f70: 7265 7373 6f72 2c20 5261 6e64 6f6d 466f  ressor, RandomFo
-00079f80: 7265 7374 436c 6173 7369 6669 6572 0d0a  restClassifier..
-00079f90: 6672 6f6d 2073 6b6c 6561 726e 2e65 6e73  from sklearn.ens
-00079fa0: 656d 626c 6520 696d 706f 7274 2045 7874  emble import Ext
-00079fb0: 7261 5472 6565 7343 6c61 7373 6966 6965  raTreesClassifie
-00079fc0: 722c 4578 7472 6154 7265 6573 5265 6772  r,ExtraTreesRegr
-00079fd0: 6573 736f 720d 0a66 726f 6d20 736b 6c65  essor..from skle
-00079fe0: 6172 6e2e 6c69 6e65 6172 5f6d 6f64 656c  arn.linear_model
-00079ff0: 2069 6d70 6f72 7420 4c6f 6769 7374 6963   import Logistic
-0007a000: 5265 6772 6573 7369 6f6e 4356 2c20 4c69  RegressionCV, Li
-0007a010: 6e65 6172 5265 6772 6573 7369 6f6e 2c20  nearRegression, 
-0007a020: 5269 6467 650d 0a66 726f 6d20 736b 6c65  Ridge..from skle
-0007a030: 6172 6e2e 7376 6d20 696d 706f 7274 204c  arn.svm import L
-0007a040: 696e 6561 7253 5643 2c20 5356 522c 204c  inearSVC, SVR, L
-0007a050: 696e 6561 7253 5652 0d0a 6672 6f6d 2073  inearSVR..from s
-0007a060: 6b6c 6561 726e 2e65 6e73 656d 626c 6520  klearn.ensemble 
-0007a070: 696d 706f 7274 2041 6461 426f 6f73 7443  import AdaBoostC
-0007a080: 6c61 7373 6966 6965 722c 2041 6461 426f  lassifier, AdaBo
-0007a090: 6f73 7452 6567 7265 7373 6f72 0d0a 6672  ostRegressor..fr
-0007a0a0: 6f6d 2073 6b6c 6561 726e 2e74 7265 6520  om sklearn.tree 
-0007a0b0: 696d 706f 7274 2044 6563 6973 696f 6e54  import DecisionT
-0007a0c0: 7265 6552 6567 7265 7373 6f72 2c20 4465  reeRegressor, De
-0007a0d0: 6369 7369 6f6e 5472 6565 436c 6173 7369  cisionTreeClassi
-0007a0e0: 6669 6572 0d0a 6672 6f6d 2073 6b6c 6561  fier..from sklea
-0007a0f0: 726e 2e6c 696e 6561 725f 6d6f 6465 6c20  rn.linear_model 
-0007a100: 696d 706f 7274 204c 6173 736f 2c20 4c61  import Lasso, La
-0007a110: 7373 6f43 562c 2052 6964 6765 2c20 5269  ssoCV, Ridge, Ri
-0007a120: 6467 6543 562c 204c 6173 736f 4c61 7273  dgeCV, LassoLars
-0007a130: 4356 0d0a 6672 6f6d 2073 6b6c 6561 726e  CV..from sklearn
-0007a140: 2e6d 6f64 656c 5f73 656c 6563 7469 6f6e  .model_selection
-0007a150: 2069 6d70 6f72 7420 6372 6f73 735f 7661   import cross_va
-0007a160: 6c5f 7072 6564 6963 740d 0a66 726f 6d20  l_predict..from 
-0007a170: 736b 6c65 6172 6e2e 656e 7365 6d62 6c65  sklearn.ensemble
-0007a180: 2069 6d70 6f72 7420 4578 7472 6154 7265   import ExtraTre
-0007a190: 6573 5265 6772 6573 736f 722c 2045 7874  esRegressor, Ext
-0007a1a0: 7261 5472 6565 7343 6c61 7373 6966 6965  raTreesClassifie
-0007a1b0: 720d 0a66 726f 6d20 736b 6c65 6172 6e2e  r..from sklearn.
-0007a1c0: 6c69 6e65 6172 5f6d 6f64 656c 2069 6d70  linear_model imp
-0007a1d0: 6f72 7420 4c6f 6769 7374 6963 5265 6772  ort LogisticRegr
-0007a1e0: 6573 7369 6f6e 2c20 4c6f 6769 7374 6963  ession, Logistic
-0007a1f0: 5265 6772 6573 7369 6f6e 4356 2c20 4c69  RegressionCV, Li
-0007a200: 6e65 6172 5265 6772 6573 7369 6f6e 0d0a  nearRegression..
-0007a210: 6672 6f6d 2073 6b6c 6561 726e 2e6d 6f64  from sklearn.mod
-0007a220: 656c 5f73 656c 6563 7469 6f6e 2069 6d70  el_selection imp
-0007a230: 6f72 7420 4772 6964 5365 6172 6368 4356  ort GridSearchCV
-0007a240: 2c53 7472 6174 6966 6965 6453 6875 6666  ,StratifiedShuff
-0007a250: 6c65 5370 6c69 742c 5368 7566 666c 6553  leSplit,ShuffleS
-0007a260: 706c 6974 0d0a 6672 6f6d 2073 6b6c 6561  plit..from sklea
-0007a270: 726e 2e6e 6169 7665 5f62 6179 6573 2069  rn.naive_bayes i
-0007a280: 6d70 6f72 7420 4761 7573 7369 616e 4e42  mport GaussianNB
-0007a290: 2c20 4d75 6c74 696e 6f6d 6961 6c4e 420d  , MultinomialNB.
-0007a2a0: 0a66 726f 6d20 736b 6c65 6172 6e2e 7472  .from sklearn.tr
-0007a2b0: 6565 2069 6d70 6f72 7420 4465 6369 7369  ee import Decisi
-0007a2c0: 6f6e 5472 6565 436c 6173 7369 6669 6572  onTreeClassifier
-0007a2d0: 0d0a 696d 706f 7274 2074 696d 650d 0a69  ..import time..i
-0007a2e0: 6d70 6f72 7420 7064 620d 0a69 6d70 6f72  mport pdb..impor
-0007a2f0: 7420 7469 6d65 0d0a 696d 706f 7274 2063  t time..import c
-0007a300: 6f70 790d 0a66 726f 6d20 636f 6c6c 6563  opy..from collec
-0007a310: 7469 6f6e 7320 696d 706f 7274 2043 6f75  tions import Cou
-0007a320: 6e74 6572 0d0a 6672 6f6d 2063 6f6c 6c65  nter..from colle
-0007a330: 6374 696f 6e73 2069 6d70 6f72 7420 6465  ctions import de
-0007a340: 6661 756c 7464 6963 740d 0a66 726f 6d20  faultdict..from 
-0007a350: 636f 6c6c 6563 7469 6f6e 7320 696d 706f  collections impo
-0007a360: 7274 204f 7264 6572 6564 4469 6374 0d0a  rt OrderedDict..
-0007a370: 2323 2323 2323 2323 2323 2323 2323 2323  ################
-0007a380: 2323 2323 2323 2323 2323 2323 2323 2323  ################
-0007a390: 2323 2323 2323 2323 2323 2323 2323 2323  ################
-0007a3a0: 2323 2323 2323 2323 2323 2323 2323 2323  ################
-0007a3b0: 2323 2323 2323 2323 2323 2323 230d 0a64  #############..d
-0007a3c0: 6566 2066 696e 645f 7261 7265 5f63 6c61  ef find_rare_cla
-0007a3d0: 7373 2863 6c61 7373 6573 2c20 7665 7262  ss(classes, verb
-0007a3e0: 6f73 653d 3029 3a0d 0a20 2020 2023 2323  ose=0):..    ###
-0007a3f0: 2323 2323 2323 2050 7269 6e74 2074 6865  ###### Print the
-0007a400: 2025 2063 6f75 6e74 206f 6620 6561 6368   % count of each
-0007a410: 2063 6c61 7373 2069 6e20 6120 5461 7267   class in a Targ
-0007a420: 6574 2076 6172 6961 626c 6520 2023 2323  et variable  ###
-0007a430: 2323 0d0a 2020 2020 2222 220d 0a20 2020  ##..    """..   
-0007a440: 2057 6f72 6b73 206f 6e20 4d75 6c74 6920   Works on Multi 
-0007a450: 436c 6173 7320 746f 6f2e 2050 7269 6e74  Class too. Print
-0007a460: 7320 636c 6173 7320 7065 7263 656e 7461  s class percenta
-0007a470: 6765 7320 636f 756e 7420 6f66 2074 6172  ges count of tar
-0007a480: 6765 7420 7661 7269 6162 6c65 2e0d 0a20  get variable... 
-0007a490: 2020 2049 7420 7265 7475 726e 7320 7468     It returns th
-0007a4a0: 6520 6e61 6d65 206f 6620 7468 6520 5261  e name of the Ra
-0007a4b0: 7265 2063 6c61 7373 2028 7468 6520 6f6e  re class (the on
-0007a4c0: 6520 7769 7468 2074 6865 206d 696e 696d  e with the minim
-0007a4d0: 756d 2063 6c61 7373 206d 656d 6265 7220  um class member 
-0007a4e0: 636f 756e 7429 2e0d 0a20 2020 2054 6869  count)...    Thi
-0007a4f0: 7320 6361 6e20 616c 736f 2062 6520 6865  s can also be he
-0007a500: 6c70 6675 6c20 696e 2075 7369 6e67 2069  lpful in using i
-0007a510: 7420 6173 2070 6f73 5f6c 6162 656c 2069  t as pos_label i
-0007a520: 6e20 4269 6e61 7279 2061 6e64 204d 756c  n Binary and Mul
-0007a530: 7469 2043 6c61 7373 2070 726f 626c 656d  ti Class problem
-0007a540: 732e 0d0a 2020 2020 2222 220d 0a20 2020  s...    """..   
-0007a550: 2063 6f75 6e74 7320 3d20 4f72 6465 7265   counts = Ordere
-0007a560: 6444 6963 7428 436f 756e 7465 7228 636c  dDict(Counter(cl
-0007a570: 6173 7365 7329 290d 0a20 2020 2074 6f74  asses))..    tot
-0007a580: 616c 203d 2073 756d 2863 6f75 6e74 732e  al = sum(counts.
-0007a590: 7661 6c75 6573 2829 290d 0a20 2020 2069  values())..    i
-0007a5a0: 6620 7665 7262 6f73 6520 3e3d 2031 3a0d  f verbose >= 1:.
-0007a5b0: 0a20 2020 2020 2020 2070 7269 6e74 2827  .        print('
-0007a5c0: 2043 6c61 7373 2020 2d3e 2043 6f75 6e74   Class  -> Count
-0007a5d0: 7320 2d3e 2050 6572 6365 6e74 2729 0d0a  s -> Percent')..
-0007a5e0: 2020 2020 2020 2020 666f 7220 636c 7320          for cls 
-0007a5f0: 696e 2063 6f75 6e74 732e 6b65 7973 2829  in counts.keys()
-0007a600: 3a0d 0a20 2020 2020 2020 2020 2020 2070  :..            p
-0007a610: 7269 6e74 2822 2536 733a 2025 2037 6420  rint("%6s: % 7d 
-0007a620: 202d 3e20 2025 2035 2e31 6625 2522 2025   ->  % 5.1f%%" %
-0007a630: 2028 636c 732c 2063 6f75 6e74 735b 636c   (cls, counts[cl
-0007a640: 735d 2c20 636f 756e 7473 5b63 6c73 5d2f  s], counts[cls]/
-0007a650: 746f 7461 6c2a 3130 3029 290d 0a20 2020  total*100))..   
-0007a660: 2069 6620 7479 7065 2870 642e 5365 7269   if type(pd.Seri
-0007a670: 6573 2863 6f75 6e74 7329 2e69 6478 6d69  es(counts).idxmi
-0007a680: 6e28 2929 3d3d 7374 723a 0d0a 2020 2020  n())==str:..    
-0007a690: 2020 2020 7265 7475 726e 2070 642e 5365      return pd.Se
-0007a6a0: 7269 6573 2863 6f75 6e74 7329 2e69 6478  ries(counts).idx
-0007a6b0: 6d69 6e28 290d 0a20 2020 2065 6c73 653a  min()..    else:
-0007a6c0: 0d0a 2020 2020 2020 2020 7265 7475 726e  ..        return
-0007a6d0: 2069 6e74 2870 642e 5365 7269 6573 2863   int(pd.Series(c
-0007a6e0: 6f75 6e74 7329 2e69 6478 6d69 6e28 2929  ounts).idxmin())
-0007a6f0: 0d0a 2323 2323 2323 2323 2323 2323 2323  ..##############
-0007a700: 2323 2323 2323 2323 2323 2323 2323 2323  ################
-0007a710: 2323 2323 2323 2323 2323 2323 2323 2323  ################
-0007a720: 2323 2323 2323 2323 2323 2323 2323 2323  ################
-0007a730: 2323 2323 2323 2323 2323 2323 2323 2323  ################
-0007a740: 2323 0d0a 6465 6620 5175 6963 6b4d 4c5f  ##..def QuickML_
-0007a750: 5374 6163 6b69 6e67 2858 5f74 7261 696e  Stacking(X_train
-0007a760: 2c20 795f 7472 6169 6e2c 2058 5f74 6573  , y_train, X_tes
-0007a770: 743d 2727 2c20 6d6f 6465 6c74 7970 653d  t='', modeltype=
-0007a780: 2752 6567 7265 7373 696f 6e27 2c42 6f6f  'Regression',Boo
-0007a790: 7374 696e 675f 466c 6167 3d46 616c 7365  sting_Flag=False
-0007a7a0: 2c0d 0a20 2020 2020 2020 2020 2020 2020  ,..             
-0007a7b0: 2020 2020 2020 2073 636f 7269 6e67 3d27         scoring='
-0007a7c0: 272c 2076 6572 626f 7365 3d30 293a 0d0a  ', verbose=0):..
-0007a7d0: 2020 2020 2222 220d 0a20 2020 2051 7569      """..    Qui
-0007a7e0: 636b 6c79 2062 7569 6c64 2053 7461 636b  ckly build Stack
-0007a7f0: 7320 6f66 206d 756c 7469 706c 6520 6d6f  s of multiple mo
-0007a800: 6465 6c20 7265 7375 6c74 730d 0a20 2020  del results..   
-0007a810: 2049 6e70 7574 206d 7573 7420 6265 2061   Input must be a
-0007a820: 2063 6c65 616e 2064 6174 6120 7365 7420   clean data set 
-0007a830: 286f 6e6c 7920 6e75 6d65 7269 6320 7661  (only numeric va
-0007a840: 7269 6162 6c65 732c 206e 6f20 6361 7465  riables, no cate
-0007a850: 676f 7269 6361 6c20 6f72 2073 7472 696e  gorical or strin
-0007a860: 6720 7661 7269 6162 6c65 7329 2e0d 0a20  g variables)... 
-0007a870: 2020 2022 2222 0d0a 2020 2020 585f 7472     """..    X_tr
-0007a880: 6169 6e20 3d20 636f 7079 2e64 6565 7063  ain = copy.deepc
-0007a890: 6f70 7928 585f 7472 6169 6e29 0d0a 2020  opy(X_train)..  
-0007a8a0: 2020 585f 7465 7374 203d 2063 6f70 792e    X_test = copy.
-0007a8b0: 6465 6570 636f 7079 2858 5f74 6573 7429  deepcopy(X_test)
-0007a8c0: 0d0a 2020 2020 795f 7472 6169 6e20 3d20  ..    y_train = 
-0007a8d0: 636f 7079 2e64 6565 7063 6f70 7928 795f  copy.deepcopy(y_
-0007a8e0: 7472 6169 6e29 0d0a 2020 2020 7374 6172  train)..    star
-0007a8f0: 745f 7469 6d65 203d 2074 696d 652e 7469  t_time = time.ti
-0007a900: 6d65 2829 0d0a 2020 2020 7365 6564 203d  me()..    seed =
-0007a910: 2039 390d 0a20 2020 2069 6620 6c65 6e28   99..    if len(
-0007a920: 585f 7472 6169 6e29 203c 3d20 3130 3030  X_train) <= 1000
-0007a930: 3030 206f 7220 585f 7472 6169 6e2e 7368  00 or X_train.sh
-0007a940: 6170 655b 315d 203c 2035 303a 0d0a 2020  ape[1] < 50:..  
-0007a950: 2020 2020 2020 4e55 4d53 203d 2031 3030        NUMS = 100
-0007a960: 0d0a 2020 2020 2020 2020 464f 4c44 5320  ..        FOLDS 
-0007a970: 3d20 350d 0a20 2020 2065 6c73 653a 0d0a  = 5..    else:..
-0007a980: 2020 2020 2020 2020 4e55 4d53 203d 2032          NUMS = 2
-0007a990: 3030 0d0a 2020 2020 2020 2020 464f 4c44  00..        FOLD
-0007a9a0: 5320 3d20 3130 0d0a 2020 2020 2323 2063  S = 10..    ## c
-0007a9b0: 7265 6174 6520 5374 6163 6b69 6e67 206d  reate Stacking m
-0007a9c0: 6f64 656c 730d 0a20 2020 2065 7374 696d  odels..    estim
-0007a9d0: 6174 6f72 7320 3d20 5b5d 0d0a 2020 2020  ators = []..    
-0007a9e0: 2323 2320 5468 6973 206b 6565 7073 2074  ### This keeps t
-0007a9f0: 7261 636b 7320 6f66 2074 6865 206e 756d  racks of the num
-0007aa00: 6265 7220 6f66 2070 7265 6469 6374 5f70  ber of predict_p
-0007aa10: 726f 6261 2063 6f6c 756d 6e73 2067 656e  roba columns gen
-0007aa20: 6572 6174 6564 2062 7920 6561 6368 206d  erated by each m
-0007aa30: 6f64 656c 2023 2323 230d 0a20 2020 2065  odel ####..    e
-0007aa40: 7374 696d 6174 6f72 5f6c 656e 6774 6820  stimator_length 
-0007aa50: 3d20 5b5d 0d0a 2020 2020 6966 2069 7369  = []..    if isi
-0007aa60: 6e73 7461 6e63 6528 585f 7465 7374 2c20  nstance(X_test, 
-0007aa70: 7374 7229 3a0d 0a20 2020 2020 2020 206e  str):..        n
-0007aa80: 6f5f 6669 7420 3d20 5472 7565 0d0a 2020  o_fit = True..  
-0007aa90: 2020 656c 7365 3a0d 0a20 2020 2020 2020    else:..       
-0007aaa0: 206e 6f5f 6669 7420 3d20 4661 6c73 650d   no_fit = False.
-0007aab0: 0a20 2020 2069 6620 6e6f 5f66 6974 3a0d  .    if no_fit:.
-0007aac0: 0a20 2020 2020 2020 2023 2323 2320 5468  .        #### Th
-0007aad0: 6973 2069 7320 7768 6572 6520 796f 7520  is is where you 
-0007aae0: 646f 6e27 7420 6669 7420 7468 6520 6d6f  don't fit the mo
-0007aaf0: 6465 6c20 6275 7420 6a75 7374 2064 6f20  del but just do 
-0007ab00: 6372 6f73 735f 7661 6c5f 7072 6564 6963  cross_val_predic
-0007ab10: 7420 2323 2323 0d0a 2020 2020 2020 2020  t ####..        
-0007ab20: 6966 206d 6f64 656c 7479 7065 203d 3d20  if modeltype == 
-0007ab30: 2752 6567 7265 7373 696f 6e27 3a0d 0a20  'Regression':.. 
-0007ab40: 2020 2020 2020 2020 2020 2069 6620 7363             if sc
-0007ab50: 6f72 696e 6720 3d3d 2027 273a 0d0a 2020  oring == '':..  
-0007ab60: 2020 2020 2020 2020 2020 2020 2020 7363                sc
-0007ab70: 6f72 696e 6720 3d20 276e 6567 5f6d 6561  oring = 'neg_mea
-0007ab80: 6e5f 7371 7561 7265 645f 6572 726f 7227  n_squared_error'
-0007ab90: 0d0a 2020 2020 2020 2020 2020 2020 7363  ..            sc
-0007aba0: 7620 3d20 4b46 6f6c 6428 6e5f 7370 6c69  v = KFold(n_spli
-0007abb0: 7473 3d46 4f4c 4453 2c20 7368 7566 666c  ts=FOLDS, shuffl
-0007abc0: 653d 4661 6c73 6529 0d0a 2020 2020 2020  e=False)..      
-0007abd0: 2020 2020 2020 6966 2042 6f6f 7374 696e        if Boostin
-0007abe0: 675f 466c 6167 3a0d 0a20 2020 2020 2020  g_Flag:..       
-0007abf0: 2020 2020 2020 2020 2023 2323 2323 2320           ###### 
-0007ac00: 2020 2042 6167 6769 6e67 206d 6f64 656c     Bagging model
-0007ac10: 7320 6966 2042 6167 6769 6e67 2069 7320  s if Bagging is 
-0007ac20: 6368 6f73 656e 2023 2323 230d 0a20 2020  chosen ####..   
-0007ac30: 2020 2020 2020 2020 2020 2020 2023 6d6f               #mo
-0007ac40: 6465 6c34 203d 2042 6167 6769 6e67 5265  del4 = BaggingRe
-0007ac50: 6772 6573 736f 7228 4465 6369 7369 6f6e  gressor(Decision
-0007ac60: 5472 6565 5265 6772 6573 736f 7228 7261  TreeRegressor(ra
-0007ac70: 6e64 6f6d 5f73 7461 7465 3d73 6565 6429  ndom_state=seed)
-0007ac80: 2c0d 0a20 2020 2020 2020 2020 2020 2020  ,..             
-0007ac90: 2020 2023 2020 2020 2020 2020 2020 2020     #            
-0007aca0: 2020 2020 2020 2020 2020 2020 2020 2020                  
-0007acb0: 6e5f 6573 7469 6d61 746f 7273 3d4e 554d  n_estimators=NUM
-0007acc0: 532c 7261 6e64 6f6d 5f73 7461 7465 3d73  S,random_state=s
-0007acd0: 6565 6429 0d0a 2020 2020 2020 2020 2020  eed)..          
-0007ace0: 2020 2020 2020 6d6f 6465 6c34 203d 204c        model4 = L
-0007acf0: 696e 6561 7253 5652 2829 0d0a 2020 2020  inearSVR()..    
-0007ad00: 2020 2020 2020 2020 2020 2020 7265 7375              resu
-0007ad10: 6c74 7320 3d20 6372 6f73 735f 7661 6c5f  lts = cross_val_
-0007ad20: 7072 6564 6963 7428 6d6f 6465 6c34 2c58  predict(model4,X
-0007ad30: 5f74 7261 696e 2c79 5f74 7261 696e 2c20  _train,y_train, 
-0007ad40: 6376 3d73 6376 2c6e 5f6a 6f62 733d 2d31  cv=scv,n_jobs=-1
-0007ad50: 290d 0a20 2020 2020 2020 2020 2020 2020  )..             
-0007ad60: 2020 2065 7374 696d 6174 6f72 732e 6170     estimators.ap
-0007ad70: 7065 6e64 2828 274c 696e 6561 725f 5356  pend(('Linear_SV
-0007ad80: 5227 2c6d 6f64 656c 3429 290d 0a20 2020  R',model4))..   
-0007ad90: 2020 2020 2020 2020 2020 2020 2065 7374               est
-0007ada0: 696d 6174 6f72 5f6c 656e 6774 682e 6170  imator_length.ap
-0007adb0: 7065 6e64 2831 290d 0a20 2020 2020 2020  pend(1)..       
-0007adc0: 2020 2020 2065 6c69 6620 426f 6f73 7469       elif Boosti
-0007add0: 6e67 5f46 6c61 6720 6973 204e 6f6e 653a  ng_Flag is None:
-0007ade0: 0d0a 2020 2020 2020 2020 2020 2020 2020  ..              
-0007adf0: 2020 2323 2323 2020 2054 7265 6520 6d6f    ####   Tree mo
-0007ae00: 6465 6c73 2069 6620 4c69 6e65 6172 2063  dels if Linear c
-0007ae10: 686f 7365 6e20 2323 2323 230d 0a20 2020  hosen #####..   
-0007ae20: 2020 2020 2020 2020 2020 2020 206d 6f64               mod
-0007ae30: 656c 3520 3d20 4465 6369 7369 6f6e 5472  el5 = DecisionTr
-0007ae40: 6565 5265 6772 6573 736f 7228 7261 6e64  eeRegressor(rand
-0007ae50: 6f6d 5f73 7461 7465 3d73 6565 642c 6d69  om_state=seed,mi
-0007ae60: 6e5f 7361 6d70 6c65 735f 6c65 6166 3d32  n_samples_leaf=2
-0007ae70: 290d 0a20 2020 2020 2020 2020 2020 2020  )..             
-0007ae80: 2020 2072 6573 756c 7473 203d 2063 726f     results = cro
-0007ae90: 7373 5f76 616c 5f70 7265 6469 6374 286d  ss_val_predict(m
-0007aea0: 6f64 656c 352c 585f 7472 6169 6e2c 795f  odel5,X_train,y_
-0007aeb0: 7472 6169 6e2c 2063 763d 7363 762c 6e5f  train, cv=scv,n_
-0007aec0: 6a6f 6273 3d2d 3129 0d0a 2020 2020 2020  jobs=-1)..      
-0007aed0: 2020 2020 2020 2020 2020 6573 7469 6d61            estima
-0007aee0: 746f 7273 2e61 7070 656e 6428 2827 4465  tors.append(('De
-0007aef0: 6369 7369 6f6e 2054 7265 6573 272c 6d6f  cision Trees',mo
-0007af00: 6465 6c35 2929 0d0a 2020 2020 2020 2020  del5))..        
-0007af10: 2020 2020 2020 2020 6573 7469 6d61 746f          estimato
-0007af20: 725f 6c65 6e67 7468 2e61 7070 656e 6428  r_length.append(
-0007af30: 3129 0d0a 2020 2020 2020 2020 2020 2020  1)..            
-0007af40: 656c 7365 3a0d 0a20 2020 2020 2020 2020  else:..         
-0007af50: 2020 2020 2020 2023 2323 2320 2020 4c69         ####   Li
-0007af60: 6e65 6172 204d 6f64 656c 7320 6966 2042  near Models if B
-0007af70: 6f6f 7374 696e 6720 6973 2063 686f 7365  oosting is chose
-0007af80: 6e20 2323 2323 230d 0a20 2020 2020 2020  n #####..       
-0007af90: 2020 2020 2020 2020 206d 6f64 656c 3620           model6 
-0007afa0: 3d20 4c61 7373 6f43 5628 616c 7068 6173  = LassoCV(alphas
-0007afb0: 3d6e 702e 6c6f 6773 7061 6365 282d 352c  =np.logspace(-5,
-0007afc0: 2d31 2c32 3029 2c20 6376 3d73 6376 2c72  -1,20), cv=scv,r
-0007afd0: 616e 646f 6d5f 7374 6174 653d 7365 6564  andom_state=seed
-0007afe0: 290d 0a20 2020 2020 2020 2020 2020 2020  )..             
-0007aff0: 2020 2072 6573 756c 7473 203d 2063 726f     results = cro
-0007b000: 7373 5f76 616c 5f70 7265 6469 6374 286d  ss_val_predict(m
-0007b010: 6f64 656c 362c 585f 7472 6169 6e2c 795f  odel6,X_train,y_
-0007b020: 7472 6169 6e2c 2063 763d 7363 762c 6e5f  train, cv=scv,n_
-0007b030: 6a6f 6273 3d2d 3129 0d0a 2020 2020 2020  jobs=-1)..      
-0007b040: 2020 2020 2020 2020 2020 6573 7469 6d61            estima
-0007b050: 746f 7273 2e61 7070 656e 6428 2827 4c61  tors.append(('La
-0007b060: 7373 6f43 5620 5265 6775 6c61 7269 7a61  ssoCV Regulariza
-0007b070: 7469 6f6e 272c 6d6f 6465 6c36 2929 0d0a  tion',model6))..
-0007b080: 2020 2020 2020 2020 2020 2020 2020 2020                  
-0007b090: 6573 7469 6d61 746f 725f 6c65 6e67 7468  estimator_length
-0007b0a0: 2e61 7070 656e 6428 3129 0d0a 2020 2020  .append(1)..    
-0007b0b0: 2020 2020 656c 7365 3a0d 0a20 2020 2020      else:..     
-0007b0c0: 2020 2020 2020 206e 5f63 6c61 7373 6573         n_classes
-0007b0d0: 203d 206c 656e 2843 6f75 6e74 6572 2879   = len(Counter(y
-0007b0e0: 5f74 7261 696e 2929 0d0a 2020 2020 2020  _train))..      
-0007b0f0: 2020 2020 2020 6966 206e 5f63 6c61 7373        if n_class
-0007b100: 6573 203e 2032 3a0d 0a20 2020 2020 2020  es > 2:..       
-0007b110: 2020 2020 2020 2020 2023 2323 2320 496e           #### In
-0007b120: 206d 756c 7469 2d63 6c61 7373 2073 6574   multi-class set
-0007b130: 7469 6e67 2c20 6974 206d 616b 6573 2073  ting, it makes s
-0007b140: 656e 7365 2074 6f20 7475 726e 2069 7420  ense to turn it 
-0007b150: 696e 746f 2062 696e 6172 7920 636c 6173  into binary clas
-0007b160: 7320 696e 2073 7461 6765 2d31 0d0a 2020  s in stage-1..  
-0007b170: 2020 2020 2020 2020 2020 2020 2020 2323                ##
-0007b180: 2323 2049 6e20 7374 6167 6520 322c 2061  ## In stage 2, a
-0007b190: 2063 6f6d 706c 6578 206d 6f64 656c 2077   complex model w
-0007b1a0: 696c 6c20 7461 6b65 2074 6865 2069 6e70  ill take the inp
-0007b1b0: 7574 7320 6f66 2074 6869 7320 6d6f 6465  uts of this mode
-0007b1c0: 6c20 616e 6420 7472 7920 746f 2070 7265  l and try to pre
-0007b1d0: 6469 6374 0d0a 2020 2020 2020 2020 2020  dict..          
-0007b1e0: 2020 2020 2020 7261 7265 5f63 6c61 7373        rare_class
-0007b1f0: 203d 2066 696e 645f 7261 7265 5f63 6c61   = find_rare_cla
-0007b200: 7373 2879 5f74 7261 696e 290d 0a20 2020  ss(y_train)..   
-0007b210: 2020 2020 2020 2020 2020 2020 2069 6620               if 
-0007b220: 7261 7265 5f63 6c61 7373 203d 3d20 303a  rare_class == 0:
-0007b230: 0d0a 2020 2020 2020 2020 2020 2020 2020  ..              
-0007b240: 2020 2020 2020 6d61 6a6f 7269 7479 5f63        majority_c
-0007b250: 6c61 7373 203d 2031 0d0a 2020 2020 2020  lass = 1..      
-0007b260: 2020 2020 2020 2020 2020 656c 7365 3a0d            else:.
-0007b270: 0a20 2020 2020 2020 2020 2020 2020 2020  .               
-0007b280: 2020 2020 206d 616a 6f72 6974 795f 636c       majority_cl
-0007b290: 6173 7320 3d20 300d 0a20 2020 2020 2020  ass = 0..       
-0007b2a0: 2020 2020 2020 2020 2079 5f74 7261 696e           y_train
-0007b2b0: 203d 2079 5f74 7261 696e 2e6d 6170 286c   = y_train.map(l
-0007b2c0: 616d 6264 6120 783a 2072 6172 655f 636c  ambda x: rare_cl
-0007b2d0: 6173 7320 6966 2078 3d3d 7261 7265 5f63  ass if x==rare_c
-0007b2e0: 6c61 7373 2065 6c73 6520 6d61 6a6f 7269  lass else majori
-0007b2f0: 7479 5f63 6c61 7373 290d 0a20 2020 2020  ty_class)..     
-0007b300: 2020 2020 2020 2069 6620 7363 6f72 696e         if scorin
-0007b310: 6720 3d3d 2027 273a 0d0a 2020 2020 2020  g == '':..      
-0007b320: 2020 2020 2020 2020 2020 7363 6f72 696e            scorin
-0007b330: 6720 3d20 2761 6363 7572 6163 7927 0d0a  g = 'accuracy'..
-0007b340: 2020 2020 2020 2020 2020 2020 7363 7620              scv 
-0007b350: 3d20 5374 7261 7469 6669 6564 4b46 6f6c  = StratifiedKFol
-0007b360: 6428 6e5f 7370 6c69 7473 3d46 4f4c 4453  d(n_splits=FOLDS
-0007b370: 2c20 7261 6e64 6f6d 5f73 7461 7465 3d73  , random_state=s
-0007b380: 6565 642c 2073 6875 6666 6c65 3d54 7275  eed, shuffle=Tru
-0007b390: 6529 0d0a 2020 2020 2020 2020 2020 2020  e)..            
-0007b3a0: 6966 2042 6f6f 7374 696e 675f 466c 6167  if Boosting_Flag
-0007b3b0: 3a0d 0a20 2020 2020 2020 2020 2020 2020  :..             
-0007b3c0: 2020 2023 2323 2320 2020 4c69 6e65 6172     ####   Linear
-0007b3d0: 204d 6f64 656c 7320 6966 2042 6f6f 7374   Models if Boost
-0007b3e0: 696e 6720 6973 2063 686f 7365 6e20 2323  ing is chosen ##
-0007b3f0: 2323 230d 0a20 2020 2020 2020 2020 2020  ###..           
-0007b400: 2020 2020 206d 6f64 656c 3420 3d20 4c69       model4 = Li
-0007b410: 6e65 6172 4469 7363 7269 6d69 6e61 6e74  nearDiscriminant
-0007b420: 416e 616c 7973 6973 2829 0d0a 2020 2020  Analysis()..    
-0007b430: 2020 2020 2020 2020 2020 2020 7265 7375              resu
-0007b440: 6c74 7320 3d20 6372 6f73 735f 7661 6c5f  lts = cross_val_
-0007b450: 7072 6564 6963 7428 6d6f 6465 6c34 2c58  predict(model4,X
-0007b460: 5f74 7261 696e 2c79 5f74 7261 696e 2c20  _train,y_train, 
-0007b470: 6376 3d73 6376 2c6e 5f6a 6f62 733d 2d31  cv=scv,n_jobs=-1
+00078080: 2020 2029 2c20 6e5f 6573 7469 6d61 746f     ), n_estimato
+00078090: 7273 3d4e 554d 532c 2072 616e 646f 6d5f  rs=NUMS, random_
+000780a0: 7374 6174 653d 7365 6564 290d 0a20 2020  state=seed)..   
+000780b0: 2020 2020 2020 2020 206d 6f64 656c 5f74           model_t
+000780c0: 7570 6c65 732e 6170 7065 6e64 2828 2741  uples.append(('A
+000780d0: 6461 626f 6f73 7427 2c6d 6f64 656c 3529  daboost',model5)
+000780e0: 290d 0a20 2020 2020 2020 2065 6c69 6620  )..        elif 
+000780f0: 6e6f 7420 426f 6f73 7469 6e67 5f46 6c61  not Boosting_Fla
+00078100: 673a 0d0a 2020 2020 2020 2020 2020 2020  g:..            
+00078110: 6d6f 6465 6c35 203d 204c 696e 6561 7244  model5 = LinearD
+00078120: 6973 6372 696d 696e 616e 7441 6e61 6c79  iscriminantAnaly
+00078130: 7369 7328 290d 0a20 2020 2020 2020 2020  sis()..         
+00078140: 2020 206d 6f64 656c 5f74 7570 6c65 732e     model_tuples.
+00078150: 6170 7065 6e64 2828 274c 696e 6561 725f  append(('Linear_
+00078160: 4469 7363 7269 6d69 6e61 6e74 272c 6d6f  Discriminant',mo
+00078170: 6465 6c35 2929 0d0a 2020 2020 2020 2020  del5))..        
+00078180: 656c 7365 3a0d 0a20 2020 2020 2020 2020  else:..         
+00078190: 2020 206d 6f64 656c 3520 3d20 4c6f 6769     model5 = Logi
+000781a0: 7374 6963 5265 6772 6573 7369 6f6e 4356  sticRegressionCV
+000781b0: 2843 733d 5b30 2e30 3031 2c30 2e30 312c  (Cs=[0.001,0.01,
+000781c0: 302e 312c 312c 3130 2c31 3030 5d2c 2074  0.1,1,10,100], t
+000781d0: 6f6c 3d30 2e30 312c 0d0a 2020 2020 2020  ol=0.01,..      
+000781e0: 2020 2020 2020 2020 2020 2020 2020 2020                  
+000781f0: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00078200: 2020 2020 736f 6c76 6572 3d27 6c69 626c      solver='libl
+00078210: 696e 6561 7227 2c20 7261 6e64 6f6d 5f73  inear', random_s
+00078220: 7461 7465 3d73 6565 6429 0d0a 2020 2020  tate=seed)..    
+00078230: 2020 2020 2020 2020 6d6f 6465 6c5f 7475          model_tu
+00078240: 706c 6573 2e61 7070 656e 6428 2827 4c6f  ples.append(('Lo
+00078250: 6769 7374 6963 5f52 6567 7265 7373 696f  gistic_Regressio
+00078260: 6e5f 4356 272c 6d6f 6465 6c35 2929 0d0a  n_CV',model5))..
+00078270: 2020 2020 2020 2020 6966 2042 6f6f 7374          if Boost
+00078280: 696e 675f 466c 6167 2069 7320 4e6f 6e65  ing_Flag is None
+00078290: 3a0d 0a20 2020 2020 2020 2020 2020 206d  :..            m
+000782a0: 6f64 656c 3620 3d20 4465 6369 7369 6f6e  odel6 = Decision
+000782b0: 5472 6565 436c 6173 7369 6669 6572 286d  TreeClassifier(m
+000782c0: 6178 5f64 6570 7468 3d35 2c6d 696e 5f73  ax_depth=5,min_s
+000782d0: 616d 706c 6573 5f6c 6561 663d 3229 0d0a  amples_leaf=2)..
+000782e0: 2020 2020 2020 2020 2020 2020 6d6f 6465              mode
+000782f0: 6c5f 7475 706c 6573 2e61 7070 656e 6428  l_tuples.append(
+00078300: 2827 4465 6369 7369 6f6e 5f54 7265 6527  ('Decision_Tree'
+00078310: 2c6d 6f64 656c 3629 290d 0a20 2020 2020  ,model6))..     
+00078320: 2020 2065 6c69 6620 6e6f 7420 426f 6f73     elif not Boos
+00078330: 7469 6e67 5f46 6c61 673a 0d0a 2020 2020  ting_Flag:..    
+00078340: 2020 2020 2020 2020 6d6f 6465 6c36 203d          model6 =
+00078350: 204c 696e 6561 7253 5643 2829 0d0a 2020   LinearSVC()..  
+00078360: 2020 2020 2020 2020 2020 6d6f 6465 6c5f            model_
+00078370: 7475 706c 6573 2e61 7070 656e 6428 2827  tuples.append(('
+00078380: 4c69 6e65 6172 5f53 5643 272c 6d6f 6465  Linear_SVC',mode
+00078390: 6c36 2929 0d0a 2020 2020 2020 2020 656c  l6))..        el
+000783a0: 7365 3a0d 0a20 2020 2020 2020 2020 2020  se:..           
+000783b0: 206d 6f64 656c 3620 3d20 4465 6369 7369   model6 = Decisi
+000783c0: 6f6e 5472 6565 436c 6173 7369 6669 6572  onTreeClassifier
+000783d0: 286d 6178 5f64 6570 7468 3d35 2c6d 696e  (max_depth=5,min
+000783e0: 5f73 616d 706c 6573 5f6c 6561 663d 3229  _samples_leaf=2)
+000783f0: 0d0a 2020 2020 2020 2020 2020 2020 6d6f  ..            mo
+00078400: 6465 6c5f 7475 706c 6573 2e61 7070 656e  del_tuples.appen
+00078410: 6428 2827 4465 6369 7369 6f6e 5f54 7265  d(('Decision_Tre
+00078420: 6527 2c6d 6f64 656c 3629 290d 0a20 2020  e',model6))..   
+00078430: 2020 2020 2069 6620 6d6f 6465 6c74 7970       if modeltyp
+00078440: 6520 3d3d 2027 4269 6e61 7279 5f43 6c61  e == 'Binary_Cla
+00078450: 7373 6966 6963 6174 696f 6e27 3a0d 0a20  ssification':.. 
+00078460: 2020 2020 2020 2020 2020 206d 6f64 656c             model
+00078470: 3720 3d20 4761 7573 7369 616e 4e42 2829  7 = GaussianNB()
+00078480: 0d0a 2020 2020 2020 2020 656c 7365 3a0d  ..        else:.
+00078490: 0a20 2020 2020 2020 2020 2020 206d 6f64  .            mod
+000784a0: 656c 3720 3d20 4d75 6c74 696e 6f6d 6961  el7 = Multinomia
+000784b0: 6c4e 4228 290d 0a20 2020 2020 2020 206d  lNB()..        m
+000784c0: 6f64 656c 5f74 7570 6c65 732e 6170 7065  odel_tuples.appe
+000784d0: 6e64 2828 274e 6169 7665 5f42 6179 6573  nd(('Naive_Bayes
+000784e0: 272c 6d6f 6465 6c37 2929 0d0a 2020 2020  ',model7))..    
+000784f0: 2020 2020 6966 2042 6f6f 7374 696e 675f      if Boosting_
+00078500: 466c 6167 2069 7320 4e6f 6e65 3a0d 0a20  Flag is None:.. 
+00078510: 2020 2020 2020 2020 2020 2023 2323 2320             #### 
+00078520: 4966 2074 6865 2042 6f6f 7374 696e 675f  If the Boosting_
+00078530: 466c 6167 2069 7320 5472 7565 2c20 6974  Flag is True, it
+00078540: 206d 6561 6e73 2042 6f6f 7374 696e 6720   means Boosting 
+00078550: 6d6f 6465 6c20 6973 2070 7265 7365 6e74  model is present
+00078560: 2e0d 0a20 2020 2020 2020 2020 2020 2023  ...            #
+00078570: 2323 2020 2053 6f20 6368 6f6f 7365 2061  ##   So choose a
+00078580: 2064 6966 6665 7265 6e74 206b 696e 6420   different kind 
+00078590: 6f66 2063 6c61 7373 6966 6965 7220 6865  of classifier he
+000785a0: 7265 0d0a 2020 2020 2020 2020 2020 2020  re..            
+000785b0: 6d6f 6465 6c38 203d 2052 616e 646f 6d46  model8 = RandomF
+000785c0: 6f72 6573 7443 6c61 7373 6966 6965 7228  orestClassifier(
+000785d0: 626f 6f74 7374 7261 7020 3d20 4661 6c73  bootstrap = Fals
+000785e0: 652c 0d0a 2020 2020 2020 2020 2020 2020  e,..            
+000785f0: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00078600: 2020 2020 2020 2020 2020 206d 6178 5f64             max_d
+00078610: 6570 7468 203d 2031 302c 0d0a 2020 2020  epth = 10,..    
+00078620: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00078630: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00078640: 2020 206d 6178 5f66 6561 7475 7265 7320     max_features 
+00078650: 3d20 2761 7574 6f27 2c0d 0a20 2020 2020  = 'auto',..     
+00078660: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00078670: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00078680: 2020 6d69 6e5f 7361 6d70 6c65 735f 6c65    min_samples_le
+00078690: 6166 203d 2032 2c0d 0a20 2020 2020 2020  af = 2,..       
+000786a0: 2020 2020 2020 2020 2020 2020 2020 2020                  
+000786b0: 2020 2020 2020 2020 2020 2020 2020 2020                  
+000786c0: 6e5f 6573 7469 6d61 746f 7273 203d 2032  n_estimators = 2
+000786d0: 3030 2c0d 0a20 2020 2020 2020 2020 2020  00,..           
+000786e0: 2020 2020 2020 2020 2020 2020 2020 2020                  
+000786f0: 2020 2020 2020 2020 2020 2020 7261 6e64              rand
+00078700: 6f6d 5f73 7461 7465 3d39 3929 0d0a 2020  om_state=99)..  
+00078710: 2020 2020 2020 2020 2020 6d6f 6465 6c5f            model_
+00078720: 7475 706c 6573 2e61 7070 656e 6428 2827  tuples.append(('
+00078730: 4261 6767 696e 675f 436c 6173 7369 6669  Bagging_Classifi
+00078740: 6572 272c 6d6f 6465 6c38 2929 0d0a 2020  er',model8))..  
+00078750: 2020 2020 2020 656c 6966 206e 6f74 2042        elif not B
+00078760: 6f6f 7374 696e 675f 466c 6167 3a0d 0a20  oosting_Flag:.. 
+00078770: 2020 2020 2020 2020 2020 2023 2323 2320             #### 
+00078780: 4966 2074 6865 2042 6f6f 7374 696e 675f  If the Boosting_
+00078790: 466c 6167 2069 7320 5472 7565 2c20 6974  Flag is True, it
+000787a0: 206d 6561 6e73 2042 6f6f 7374 696e 6720   means Boosting 
+000787b0: 6d6f 6465 6c20 6973 2070 7265 7365 6e74  model is present
+000787c0: 2e0d 0a20 2020 2020 2020 2020 2020 2023  ...            #
+000787d0: 2323 2020 2053 6f20 6368 6f6f 7365 2061  ##   So choose a
+000787e0: 2064 6966 6665 7265 6e74 206b 696e 6420   different kind 
+000787f0: 6f66 2063 6c61 7373 6966 6965 7220 6865  of classifier he
+00078800: 7265 0d0a 2020 2020 2020 2020 2020 2020  re..            
+00078810: 7367 645f 6265 7374 5f6d 6f64 656c 203d  sgd_best_model =
+00078820: 2053 4744 436c 6173 7369 6669 6572 2861   SGDClassifier(a
+00078830: 6c70 6861 3d31 652d 3036 2c0d 0a20 2020  lpha=1e-06,..   
+00078840: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00078850: 2020 2020 2020 2020 2020 2020 206c 6f73               los
+00078860: 733d 276c 6f67 272c 0d0a 2020 2020 2020  s='log',..      
+00078870: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00078880: 2020 2020 2020 2020 206d 6178 5f69 7465           max_ite
+00078890: 723d 3130 3030 2c0d 0a20 2020 2020 2020  r=1000,..       
+000788a0: 2020 2020 2020 2020 2020 2020 2020 2020                  
+000788b0: 2020 2020 2020 2020 7065 6e61 6c74 793d          penalty=
+000788c0: 276c 3227 2c0d 0a20 2020 2020 2020 2020  'l2',..         
+000788d0: 2020 2020 2020 2020 2020 2020 2020 2020                  
+000788e0: 2020 2020 2020 6c65 6172 6e69 6e67 5f72        learning_r
+000788f0: 6174 6520 3d20 2763 6f6e 7374 616e 7427  ate = 'constant'
+00078900: 2c0d 0a20 2020 2020 2020 2020 2020 2020  ,..             
+00078910: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00078920: 2020 6574 6130 203d 202e 312c 0d0a 2020    eta0 = .1,..  
+00078930: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00078940: 2020 2020 2020 2020 2020 2020 2072 616e               ran
+00078950: 646f 6d5f 7374 6174 6520 3d20 332c 0d0a  dom_state = 3,..
+00078960: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00078970: 2020 2020 2020 2020 2020 2020 2020 2074                 t
+00078980: 6f6c 3d4e 6f6e 6529 0d0a 2020 2020 2020  ol=None)..      
+00078990: 2020 2020 2020 6d6f 6465 6c38 203d 204f        model8 = O
+000789a0: 6e65 5673 5265 7374 436c 6173 7369 6669  neVsRestClassifi
+000789b0: 6572 2873 6764 5f62 6573 745f 6d6f 6465  er(sgd_best_mode
+000789c0: 6c29 0d0a 2020 2020 2020 2020 2020 2020  l)..            
+000789d0: 6d6f 6465 6c5f 7475 706c 6573 2e61 7070  model_tuples.app
+000789e0: 656e 6428 2827 4f6e 655f 7673 5f52 6573  end(('One_vs_Res
+000789f0: 745f 436c 6173 7369 6669 6572 272c 6d6f  t_Classifier',mo
+00078a00: 6465 6c38 2929 0d0a 2020 2020 2020 2020  del8))..        
+00078a10: 656c 7365 3a0d 0a20 2020 2020 2020 2020  else:..         
+00078a20: 2020 206d 6f64 656c 3820 3d20 5261 6e64     model8 = Rand
+00078a30: 6f6d 466f 7265 7374 436c 6173 7369 6669  omForestClassifi
+00078a40: 6572 2862 6f6f 7473 7472 6170 203d 2046  er(bootstrap = F
+00078a50: 616c 7365 2c0d 0a20 2020 2020 2020 2020  alse,..         
+00078a60: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00078a70: 2020 2020 2020 2020 2020 2020 2020 6d61                ma
+00078a80: 785f 6465 7074 6820 3d20 3130 2c0d 0a20  x_depth = 10,.. 
+00078a90: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00078aa0: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00078ab0: 2020 2020 2020 6d61 785f 6665 6174 7572        max_featur
+00078ac0: 6573 203d 2027 6175 746f 272c 0d0a 2020  es = 'auto',..  
+00078ad0: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00078ae0: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00078af0: 2020 2020 206d 696e 5f73 616d 706c 6573       min_samples
+00078b00: 5f6c 6561 6620 3d20 322c 0d0a 2020 2020  _leaf = 2,..    
+00078b10: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00078b20: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00078b30: 2020 206e 5f65 7374 696d 6174 6f72 7320     n_estimators 
+00078b40: 3d20 3230 302c 0d0a 2020 2020 2020 2020  = 200,..        
+00078b50: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00078b60: 2020 2020 2020 2020 2020 2020 2020 2072                 r
+00078b70: 616e 646f 6d5f 7374 6174 653d 3939 290d  andom_state=99).
+00078b80: 0a20 2020 2020 2020 2020 2020 206d 6f64  .            mod
+00078b90: 656c 5f74 7570 6c65 732e 6170 7065 6e64  el_tuples.append
+00078ba0: 2828 2742 6167 6769 6e67 5f43 6c61 7373  (('Bagging_Class
+00078bb0: 6966 6965 7227 2c6d 6f64 656c 3829 290d  ifier',model8)).
+00078bc0: 0a20 2020 206d 6f64 656c 5f64 6963 7420  .    model_dict 
+00078bd0: 3d20 6469 6374 286d 6f64 656c 5f74 7570  = dict(model_tup
+00078be0: 6c65 7329 0d0a 2020 2020 6d6f 6465 6c73  les)..    models
+00078bf0: 2c20 7265 7375 6c74 7320 3d20 7275 6e5f  , results = run_
+00078c00: 656e 7365 6d62 6c65 5f6d 6f64 656c 7328  ensemble_models(
+00078c10: 6d6f 6465 6c5f 6469 6374 2c20 585f 7472  model_dict, X_tr
+00078c20: 6169 6e2c 2079 5f74 7261 696e 2c20 585f  ain, y_train, X_
+00078c30: 7465 7374 2c20 795f 7465 7374 2c0d 0a20  test, y_test,.. 
+00078c40: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00078c50: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00078c60: 2020 2020 2020 2020 2073 636f 7269 6e67           scoring
+00078c70: 2c20 6d6f 6465 6c74 7970 6529 0d0a 2020  , modeltype)..  
+00078c80: 2020 7265 7475 726e 206d 6f64 656c 732c    return models,
+00078c90: 2072 6573 756c 7473 0d0a 2323 2323 2323   results..######
+00078ca0: 2323 2323 2323 2323 2323 2323 2323 2323  ################
+00078cb0: 2323 2323 2323 2323 2323 2323 2323 2323  ################
+00078cc0: 2323 2323 2323 2323 2323 2323 2323 2323  ################
+00078cd0: 2323 230d 0a66 726f 6d20 736b 6c65 6172  ###..from sklear
+00078ce0: 6e2e 6d65 7472 6963 7320 696d 706f 7274  n.metrics import
+00078cf0: 2062 616c 616e 6365 645f 6163 6375 7261   balanced_accura
+00078d00: 6379 5f73 636f 7265 2c61 6363 7572 6163  cy_score,accurac
+00078d10: 795f 7363 6f72 652c 7072 6563 6973 696f  y_score,precisio
+00078d20: 6e5f 7363 6f72 652c 7265 6361 6c6c 5f73  n_score,recall_s
+00078d30: 636f 7265 2c66 315f 7363 6f72 650d 0a66  core,f1_score..f
+00078d40: 726f 6d20 736b 6c65 6172 6e2e 6d65 7472  rom sklearn.metr
+00078d50: 6963 7320 696d 706f 7274 206d 6561 6e5f  ics import mean_
+00078d60: 6162 736f 6c75 7465 5f65 7272 6f72 2c20  absolute_error, 
+00078d70: 6d65 616e 5f73 7175 6172 6564 5f65 7272  mean_squared_err
+00078d80: 6f72 0d0a 696d 706f 7274 2063 6f70 790d  or..import copy.
+00078d90: 0a66 726f 6d20 736b 6c65 6172 6e2e 6c69  .from sklearn.li
+00078da0: 6e65 6172 5f6d 6f64 656c 2069 6d70 6f72  near_model impor
+00078db0: 7420 4c69 6e65 6172 5265 6772 6573 7369  t LinearRegressi
+00078dc0: 6f6e 0d0a 6672 6f6d 2073 6b6c 6561 726e  on..from sklearn
+00078dd0: 2e6c 696e 6561 725f 6d6f 6465 6c20 696d  .linear_model im
+00078de0: 706f 7274 204c 6f67 6973 7469 6352 6567  port LogisticReg
+00078df0: 7265 7373 696f 6e0d 0a64 6566 2072 756e  ression..def run
+00078e00: 5f65 6e73 656d 626c 655f 6d6f 6465 6c73  _ensemble_models
+00078e10: 286d 6f64 656c 5f64 6963 742c 2058 5f74  (model_dict, X_t
+00078e20: 7261 696e 2c20 795f 7472 6169 6e2c 2058  rain, y_train, X
+00078e30: 5f74 6573 742c 2079 5f74 6573 742c 2073  _test, y_test, s
+00078e40: 636f 7269 6e67 2c20 6d6f 6465 6c74 7970  coring, modeltyp
+00078e50: 6529 3a0d 0a20 2020 2073 7461 7274 5f74  e):..    start_t
+00078e60: 696d 6520 3d20 7469 6d65 2e74 696d 6528  ime = time.time(
+00078e70: 290d 0a20 2020 206d 6f64 656c 5f6e 616d  )..    model_nam
+00078e80: 652c 2020 6261 635f 7363 6f72 655f 6c69  e,  bac_score_li
+00078e90: 7374 2c20 6163 5f73 636f 7265 5f6c 6973  st, ac_score_lis
+00078ea0: 742c 2070 5f73 636f 7265 5f6c 6973 742c  t, p_score_list,
+00078eb0: 2072 5f73 636f 7265 5f6c 6973 742c 2066   r_score_list, f
+00078ec0: 315f 7363 6f72 655f 6c69 7374 203d 205b  1_score_list = [
+00078ed0: 5d2c 205b 5d2c 205b 5d2c 205b 5d2c 205b  ], [], [], [], [
+00078ee0: 5d2c 205b 5d0d 0a20 2020 2069 7465 7261  ], []..    itera
+00078ef0: 7469 6f6e 203d 2030 0d0a 2020 2020 6573  tion = 0..    es
+00078f00: 7469 6d61 746f 7273 203d 205b 5d0d 0a20  timators = [].. 
+00078f10: 2020 2065 7374 696d 5f74 7570 6c65 7320     estim_tuples 
+00078f20: 3d20 5b5d 0d0a 2020 2020 666f 7220 6b65  = []..    for ke
+00078f30: 792c 7661 6c20 696e 206d 6f64 656c 5f64  y,val in model_d
+00078f40: 6963 742e 6974 656d 7328 293a 0d0a 2020  ict.items():..  
+00078f50: 2020 2020 2020 6573 7469 6d61 746f 725f        estimator_
+00078f60: 6e61 6d65 203d 206b 6579 0d0a 2020 2020  name = key..    
+00078f70: 2020 2020 6d6f 6465 6c5f 6e61 6d65 2e61      model_name.a
+00078f80: 7070 656e 6428 6b65 7929 0d0a 2020 2020  ppend(key)..    
+00078f90: 2020 2020 6966 2073 7472 2876 616c 292e      if str(val).
+00078fa0: 7370 6c69 7428 2228 2229 5b30 5d20 3d3d  split("(")[0] ==
+00078fb0: 2027 4d75 6c74 696e 6f6d 6961 6c4e 4227   'MultinomialNB'
+00078fc0: 3a0d 0a20 2020 2020 2020 2020 2020 2023  :..            #
+00078fd0: 2323 2320 4d75 6c74 696e 6f6d 6961 6c20  ### Multinomial 
+00078fe0: 6d6f 6465 6c73 206e 6565 6420 6f6e 6c79  models need only
+00078ff0: 2070 6f73 6974 6976 6520 7661 6c75 6573   positive values
+00079000: 2121 0d0a 2020 2020 2020 2020 2020 2020  !!..            
+00079010: 7661 6c2e 6669 7428 6162 7328 585f 7472  val.fit(abs(X_tr
+00079020: 6169 6e29 2c20 795f 7472 6169 6e29 0d0a  ain), y_train)..
+00079030: 2020 2020 2020 2020 2020 2020 795f 7072              y_pr
+00079040: 6564 203d 2076 616c 2e70 7265 6469 6374  ed = val.predict
+00079050: 2861 6273 2858 5f74 6573 7429 290d 0a20  (abs(X_test)).. 
+00079060: 2020 2020 2020 2065 6c73 653a 0d0a 2020         else:..  
+00079070: 2020 2020 2020 2020 2020 7472 793a 0d0a            try:..
+00079080: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00079090: 7661 6c2e 6669 7428 585f 7472 6169 6e2c  val.fit(X_train,
+000790a0: 2079 5f74 7261 696e 290d 0a20 2020 2020   y_train)..     
+000790b0: 2020 2020 2020 2020 2020 2079 5f70 7265             y_pre
+000790c0: 6420 3d20 7661 6c2e 7072 6564 6963 7428  d = val.predict(
+000790d0: 585f 7465 7374 290d 0a20 2020 2020 2020  X_test)..       
+000790e0: 2020 2020 2065 7863 6570 743a 0d0a 2020       except:..  
+000790f0: 2020 2020 2020 2020 2020 2020 2020 6966                if
+00079100: 206d 6f64 656c 7479 7065 2021 3d20 2752   modeltype != 'R
+00079110: 6567 7265 7373 696f 6e27 3a0d 0a20 2020  egression':..   
+00079120: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00079130: 206b 6579 203d 2027 4c6f 6769 7374 6963   key = 'Logistic
+00079140: 5f52 6567 7265 7373 696f 6e27 0d0a 2020  _Regression'..  
+00079150: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00079160: 2020 7661 6c20 3d20 4c6f 6769 7374 6963    val = Logistic
+00079170: 5265 6772 6573 7369 6f6e 2829 0d0a 2020  Regression()..  
+00079180: 2020 2020 2020 2020 2020 2020 2020 656c                el
+00079190: 7365 3a0d 0a20 2020 2020 2020 2020 2020  se:..           
+000791a0: 2020 2020 2020 2020 206b 6579 203d 2027           key = '
+000791b0: 4c69 6e65 6172 5f52 6567 7265 7373 696f  Linear_Regressio
+000791c0: 6e27 0d0a 2020 2020 2020 2020 2020 2020  n'..            
+000791d0: 2020 2020 2020 2020 7661 6c20 3d20 4c69          val = Li
+000791e0: 6e65 6172 5265 6772 6573 7369 6f6e 2829  nearRegression()
+000791f0: 0d0a 2020 2020 2020 2020 2020 2020 2020  ..              
+00079200: 2020 7661 6c2e 6669 7428 585f 7472 6169    val.fit(X_trai
+00079210: 6e2c 2079 5f74 7261 696e 290d 0a20 2020  n, y_train)..   
+00079220: 2020 2020 2074 7279 3a0d 0a20 2020 2020       try:..     
+00079230: 2020 2020 2020 2079 5f70 7265 6420 3d20         y_pred = 
+00079240: 7661 6c2e 7072 6564 6963 7428 585f 7465  val.predict(X_te
+00079250: 7374 290d 0a20 2020 2020 2020 2065 7863  st)..        exc
+00079260: 6570 743a 0d0a 2020 2020 2020 2020 2020  ept:..          
+00079270: 2020 7072 696e 7428 2745 7272 6f72 2069    print('Error i
+00079280: 6e20 656e 7365 6d62 6c65 206d 6f64 656c  n ensemble model
+00079290: 732e 2052 6574 7572 6e69 6e67 2e2e 2e27  s. Returning...'
+000792a0: 290d 0a20 2020 2020 2020 2020 2020 2073  )..            s
+000792b0: 7461 636b 7320 3d20 6e70 2e61 7272 6179  tacks = np.array
+000792c0: 285b 5d29 0d0a 2020 2020 2020 2020 2020  ([])..          
+000792d0: 2020 7265 7475 726e 206d 6f64 656c 5f6e    return model_n
+000792e0: 616d 652c 2073 7461 636b 730d 0a20 2020  ame, stacks..   
+000792f0: 2020 2020 2069 6620 6974 6572 6174 696f       if iteratio
+00079300: 6e20 3d3d 2030 3a0d 0a20 2020 2020 2020  n == 0:..       
+00079310: 2020 2020 2073 7461 636b 7320 3d20 636f       stacks = co
+00079320: 7079 2e64 6565 7063 6f70 7928 795f 7072  py.deepcopy(y_pr
+00079330: 6564 290d 0a20 2020 2020 2020 2020 2020  ed)..           
+00079340: 2069 7465 7261 7469 6f6e 202b 3d20 310d   iteration += 1.
+00079350: 0a20 2020 2020 2020 2065 6c73 653a 0d0a  .        else:..
+00079360: 2020 2020 2020 2020 2020 2020 7374 6163              stac
+00079370: 6b73 203d 206e 702e 635f 5b73 7461 636b  ks = np.c_[stack
+00079380: 732c 795f 7072 6564 5d0d 0a20 2020 2020  s,y_pred]..     
+00079390: 2020 2069 6620 6e6f 7420 6973 696e 7374     if not isinst
+000793a0: 616e 6365 2879 5f74 6573 742c 7374 7229  ance(y_test,str)
+000793b0: 3a0d 0a20 2020 2020 2020 2020 2020 2069  :..            i
+000793c0: 6620 6d6f 6465 6c74 7970 6520 3d3d 2027  f modeltype == '
+000793d0: 5265 6772 6573 7369 6f6e 273a 0d0a 2020  Regression':..  
+000793e0: 2020 2020 2020 2020 2020 2020 2020 6261                ba
+000793f0: 635f 7363 6f72 6520 3d20 6e70 2e73 7172  c_score = np.sqr
+00079400: 7428 6d65 616e 5f73 7175 6172 6564 5f65  t(mean_squared_e
+00079410: 7272 6f72 2879 5f74 6573 742c 2079 5f70  rror(y_test, y_p
+00079420: 7265 6429 290d 0a20 2020 2020 2020 2020  red))..         
+00079430: 2020 2020 2020 2065 7374 696d 6174 6f72         estimator
+00079440: 732e 6170 7065 6e64 2828 6573 7469 6d61  s.append((estima
+00079450: 746f 725f 6e61 6d65 2c76 616c 2c20 6261  tor_name,val, ba
+00079460: 635f 7363 6f72 6529 290d 0a20 2020 2020  c_score))..     
+00079470: 2020 2020 2020 2020 2020 2065 7374 696d             estim
+00079480: 5f74 7570 6c65 732e 6170 7065 6e64 2828  _tuples.append((
+00079490: 6573 7469 6d61 746f 725f 6e61 6d65 2c20  estimator_name, 
+000794a0: 6261 635f 7363 6f72 6529 290d 0a20 2020  bac_score))..   
+000794b0: 2020 2020 2020 2020 2020 2020 2062 6163               bac
+000794c0: 5f73 636f 7265 5f6c 6973 742e 6170 7065  _score_list.appe
+000794d0: 6e64 2862 6163 5f73 636f 7265 290d 0a20  nd(bac_score).. 
+000794e0: 2020 2020 2020 2020 2020 2020 2020 2061                 a
+000794f0: 635f 7363 6f72 655f 6c69 7374 2e61 7070  c_score_list.app
+00079500: 656e 6428 6d65 616e 5f73 7175 6172 6564  end(mean_squared
+00079510: 5f65 7272 6f72 2879 5f74 6573 742c 2079  _error(y_test, y
+00079520: 5f70 7265 6429 290d 0a20 2020 2020 2020  _pred))..       
+00079530: 2020 2020 2020 2020 2070 5f73 636f 7265           p_score
+00079540: 5f6c 6973 742e 6170 7065 6e64 286d 6561  _list.append(mea
+00079550: 6e5f 6162 736f 6c75 7465 5f65 7272 6f72  n_absolute_error
+00079560: 2879 5f74 6573 742c 2079 5f70 7265 6429  (y_test, y_pred)
+00079570: 290d 0a20 2020 2020 2020 2020 2020 2020  )..             
+00079580: 2020 206d 6f64 656c 5f63 6f6d 7061 7269     model_compari
+00079590: 736f 6e5f 6466 203d 2070 642e 4461 7461  son_df = pd.Data
+000795a0: 4672 616d 6528 5b6d 6f64 656c 5f6e 616d  Frame([model_nam
+000795b0: 652c 2062 6163 5f73 636f 7265 5f6c 6973  e, bac_score_lis
+000795c0: 742c 2061 635f 7363 6f72 655f 6c69 7374  t, ac_score_list
+000795d0: 2c70 5f73 636f 7265 5f6c 6973 745d 292e  ,p_score_list]).
+000795e0: 540d 0a20 2020 2020 2020 2020 2020 2020  T..             
+000795f0: 2020 206d 6f64 656c 5f63 6f6d 7061 7269     model_compari
+00079600: 736f 6e5f 6466 2e63 6f6c 756d 6e73 203d  son_df.columns =
+00079610: 205b 276d 6f64 656c 5f6e 616d 6527 2c20   ['model_name', 
+00079620: 2752 4d53 4527 2c20 274d 5345 272c 274d  'RMSE', 'MSE','M
+00079630: 4145 275d 0d0a 2020 2020 2020 2020 2020  AE']..          
+00079640: 2020 2020 2020 6d6f 6465 6c5f 636f 6d70        model_comp
+00079650: 6172 6973 6f6e 5f64 6620 3d20 6d6f 6465  arison_df = mode
+00079660: 6c5f 636f 6d70 6172 6973 6f6e 5f64 662e  l_comparison_df.
+00079670: 736f 7274 5f76 616c 7565 7328 6279 3d27  sort_values(by='
+00079680: 524d 5345 272c 2061 7363 656e 6469 6e67  RMSE', ascending
+00079690: 3d54 7275 6529 0d0a 2020 2020 2020 2020  =True)..        
+000796a0: 2020 2020 656c 7365 3a0d 0a20 2020 2020      else:..     
+000796b0: 2020 2020 2020 2020 2020 2062 6163 5f73             bac_s
+000796c0: 636f 7265 203d 2062 616c 616e 6365 645f  core = balanced_
+000796d0: 6163 6375 7261 6379 5f73 636f 7265 2879  accuracy_score(y
+000796e0: 5f74 6573 742c 2079 5f70 7265 6429 0d0a  _test, y_pred)..
+000796f0: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00079700: 6573 7469 6d61 746f 7273 2e61 7070 656e  estimators.appen
+00079710: 6428 2865 7374 696d 6174 6f72 5f6e 616d  d((estimator_nam
+00079720: 652c 7661 6c2c 2062 6163 5f73 636f 7265  e,val, bac_score
+00079730: 2929 0d0a 2020 2020 2020 2020 2020 2020  ))..            
+00079740: 2020 2020 6573 7469 6d5f 7475 706c 6573      estim_tuples
+00079750: 2e61 7070 656e 6428 2865 7374 696d 6174  .append((estimat
+00079760: 6f72 5f6e 616d 652c 2062 6163 5f73 636f  or_name, bac_sco
+00079770: 7265 2929 0d0a 2020 2020 2020 2020 2020  re))..          
+00079780: 2020 2020 2020 6261 635f 7363 6f72 655f        bac_score_
+00079790: 6c69 7374 2e61 7070 656e 6428 6261 6c61  list.append(bala
+000797a0: 6e63 6564 5f61 6363 7572 6163 795f 7363  nced_accuracy_sc
+000797b0: 6f72 6528 795f 7465 7374 2c20 795f 7072  ore(y_test, y_pr
+000797c0: 6564 2929 0d0a 2020 2020 2020 2020 2020  ed))..          
+000797d0: 2020 2020 2020 6163 5f73 636f 7265 5f6c        ac_score_l
+000797e0: 6973 742e 6170 7065 6e64 2861 6363 7572  ist.append(accur
+000797f0: 6163 795f 7363 6f72 6528 795f 7465 7374  acy_score(y_test
+00079800: 2c20 795f 7072 6564 2929 0d0a 2020 2020  , y_pred))..    
+00079810: 2020 2020 2020 2020 2020 2020 705f 7363              p_sc
+00079820: 6f72 655f 6c69 7374 2e61 7070 656e 6428  ore_list.append(
+00079830: 7072 6563 6973 696f 6e5f 7363 6f72 6528  precision_score(
+00079840: 795f 7465 7374 2c20 795f 7072 6564 2c20  y_test, y_pred, 
+00079850: 6176 6572 6167 653d 276d 6163 726f 2729  average='macro')
+00079860: 290d 0a20 2020 2020 2020 2020 2020 2020  )..             
+00079870: 2020 2072 5f73 636f 7265 5f6c 6973 742e     r_score_list.
+00079880: 6170 7065 6e64 2872 6563 616c 6c5f 7363  append(recall_sc
+00079890: 6f72 6528 795f 7465 7374 2c20 795f 7072  ore(y_test, y_pr
+000798a0: 6564 2c20 6176 6572 6167 653d 276d 6163  ed, average='mac
+000798b0: 726f 2729 290d 0a20 2020 2020 2020 2020  ro'))..         
+000798c0: 2020 2020 2020 2066 315f 7363 6f72 655f         f1_score_
+000798d0: 6c69 7374 2e61 7070 656e 6428 6631 5f73  list.append(f1_s
+000798e0: 636f 7265 2879 5f74 6573 742c 2079 5f70  core(y_test, y_p
+000798f0: 7265 642c 2061 7665 7261 6765 3d27 6d61  red, average='ma
+00079900: 6372 6f27 2929 0d0a 2020 2020 2020 2020  cro'))..        
+00079910: 2020 2020 2020 2020 6d6f 6465 6c5f 636f          model_co
+00079920: 6d70 6172 6973 6f6e 5f64 6620 3d20 7064  mparison_df = pd
+00079930: 2e44 6174 6146 7261 6d65 285b 6d6f 6465  .DataFrame([mode
+00079940: 6c5f 6e61 6d65 2c20 6261 635f 7363 6f72  l_name, bac_scor
+00079950: 655f 6c69 7374 2c20 6163 5f73 636f 7265  e_list, ac_score
+00079960: 5f6c 6973 742c 2070 5f73 636f 7265 5f6c  _list, p_score_l
+00079970: 6973 742c 0d0a 2020 2020 2020 2020 2020  ist,..          
+00079980: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00079990: 2020 2020 2020 2020 2020 2020 2020 2020                  
+000799a0: 2020 2020 2020 2020 2020 2020 2020 2072                 r
+000799b0: 5f73 636f 7265 5f6c 6973 742c 2066 315f  _score_list, f1_
+000799c0: 7363 6f72 655f 6c69 7374 5d29 2e54 0d0a  score_list]).T..
+000799d0: 2020 2020 2020 2020 2020 2020 2020 2020                  
+000799e0: 6d6f 6465 6c5f 636f 6d70 6172 6973 6f6e  model_comparison
+000799f0: 5f64 662e 636f 6c75 6d6e 7320 3d20 5b27  _df.columns = ['
+00079a00: 6d6f 6465 6c5f 6e61 6d65 272c 2027 6261  model_name', 'ba
+00079a10: 6c5f 6163 6375 7261 6379 5f73 636f 7265  l_accuracy_score
+00079a20: 272c 2027 6163 6375 7261 6379 5f73 636f  ', 'accuracy_sco
+00079a30: 7265 272c 0d0a 2020 2020 2020 2020 2020  re',..          
+00079a40: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00079a50: 2020 2020 2020 2020 2020 2020 2020 2027                 '
+00079a60: 6176 655f 7072 6563 6973 696f 6e5f 7363  ave_precision_sc
+00079a70: 6f72 6527 2c20 2761 7665 5f72 6563 616c  ore', 'ave_recal
+00079a80: 6c5f 7363 6f72 6527 2c20 2761 7665 5f66  l_score', 'ave_f
+00079a90: 315f 7363 6f72 6527 5d0d 0a20 2020 2020  1_score']..     
+00079aa0: 2020 2020 2020 2020 2020 206d 6f64 656c             model
+00079ab0: 5f63 6f6d 7061 7269 736f 6e5f 6466 203d  _comparison_df =
+00079ac0: 206d 6f64 656c 5f63 6f6d 7061 7269 736f   model_compariso
+00079ad0: 6e5f 6466 2e73 6f72 745f 7661 6c75 6573  n_df.sort_values
+00079ae0: 2862 793d 2762 616c 5f61 6363 7572 6163  (by='bal_accurac
+00079af0: 795f 7363 6f72 6527 2c20 6173 6365 6e64  y_score', ascend
+00079b00: 696e 673d 4661 6c73 6529 0d0a 2020 2020  ing=False)..    
+00079b10: 6966 206e 6f74 2069 7369 6e73 7461 6e63  if not isinstanc
+00079b20: 6528 795f 7465 7374 2c20 7374 7229 3a0d  e(y_test, str):.
+00079b30: 0a20 2020 2020 2020 2064 6174 615f 6672  .        data_fr
+00079b40: 616d 6520 3d20 6d6f 6465 6c5f 636f 6d70  ame = model_comp
+00079b50: 6172 6973 6f6e 5f64 662e 7365 745f 696e  arison_df.set_in
+00079b60: 6465 7828 276d 6f64 656c 5f6e 616d 6527  dex('model_name'
+00079b70: 292e 6173 7479 7065 2866 6c6f 6174 290d  ).astype(float).
+00079b80: 0a20 2020 2020 2020 2070 6c74 2e66 6967  .        plt.fig
+00079b90: 7572 6528 6669 6773 697a 653d 2831 302c  ure(figsize=(10,
+00079ba0: 3130 2929 0d0a 2020 2020 2020 2020 6720  10))..        g 
+00079bb0: 3d20 736e 732e 6865 6174 6d61 7028 6461  = sns.heatmap(da
+00079bc0: 7461 5f66 7261 6d65 2c61 6e6e 6f74 3d54  ta_frame,annot=T
+00079bd0: 7275 652c 666d 743d 2730 2e32 6627 2c63  rue,fmt='0.2f',c
+00079be0: 6261 723d 4661 6c73 6529 0d0a 2020 2020  bar=False)..    
+00079bf0: 2020 2020 672e 7365 745f 7874 6963 6b6c      g.set_xtickl
+00079c00: 6162 656c 7328 672e 6765 745f 7874 6963  abels(g.get_xtic
+00079c10: 6b6c 6162 656c 7328 292c 2072 6f74 6174  klabels(), rotat
+00079c20: 696f 6e20 3d20 3435 2c20 666f 6e74 7369  ion = 45, fontsi
+00079c30: 7a65 203d 2031 3229 0d0a 2020 2020 2020  ze = 12)..      
+00079c40: 2020 672e 7365 745f 7974 6963 6b6c 6162    g.set_yticklab
+00079c50: 656c 7328 672e 6765 745f 7974 6963 6b6c  els(g.get_ytickl
+00079c60: 6162 656c 7328 292c 2072 6f74 6174 696f  abels(), rotatio
+00079c70: 6e20 3d20 302c 2066 6f6e 7473 697a 6520  n = 0, fontsize 
+00079c80: 3d20 3132 290d 0a20 2020 2020 2020 2070  = 12)..        p
+00079c90: 7269 6e74 2827 5469 6d65 2074 616b 656e  rint('Time taken
+00079ca0: 203d 2025 302e 3066 2073 6563 6f6e 6473   = %0.0f seconds
+00079cb0: 2720 2528 7469 6d65 2e74 696d 6528 292d  ' %(time.time()-
+00079cc0: 7374 6172 745f 7469 6d65 2929 0d0a 2020  start_time))..  
+00079cd0: 2020 2020 2020 672e 7365 745f 7469 746c        g.set_titl
+00079ce0: 6528 2751 7569 636b 4d4c 2045 6e73 656d  e('QuickML Ensem
+00079cf0: 626c 696e 6720 4d6f 6465 6c73 2052 6573  bling Models Res
+00079d00: 756c 7473 272c 666f 6e74 7369 7a65 3d31  ults',fontsize=1
+00079d10: 3829 0d0a 2020 2020 2020 2020 6631 5f73  8)..        f1_s
+00079d20: 7461 7473 203d 2064 6963 7428 6573 7469  tats = dict(esti
+00079d30: 6d5f 7475 706c 6573 290d 0a20 2020 2020  m_tuples)..     
+00079d40: 2020 2074 7279 3a0d 0a20 2020 2020 2020     try:..       
+00079d50: 2020 2020 2069 6620 7363 6f72 696e 6720       if scoring 
+00079d60: 696e 205b 276c 6f67 6c6f 7373 272c 2772  in ['logloss','r
+00079d70: 6d73 6527 2c27 6d61 6527 2c27 6d61 7065  mse','mae','mape
+00079d80: 272c 2752 4d53 4527 2c27 6e65 675f 6d65  ','RMSE','neg_me
+00079d90: 616e 5f73 7175 6172 6564 5f65 7272 6f72  an_squared_error
+00079da0: 275d 3a0d 0a20 2020 2020 2020 2020 2020  ']:..           
+00079db0: 2020 2020 2062 6573 745f 6d6f 6465 6c5f       best_model_
+00079dc0: 6e61 6d65 203d 206d 696e 2866 315f 7374  name = min(f1_st
+00079dd0: 6174 732e 6974 656d 7328 292c 206b 6579  ats.items(), key
+00079de0: 3d6f 7065 7261 746f 722e 6974 656d 6765  =operator.itemge
+00079df0: 7474 6572 2831 2929 5b30 5d0d 0a20 2020  tter(1))[0]..   
+00079e00: 2020 2020 2020 2020 2065 6c73 653a 0d0a           else:..
+00079e10: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00079e20: 6265 7374 5f6d 6f64 656c 5f6e 616d 6520  best_model_name 
+00079e30: 3d20 6d61 7828 6631 5f73 7461 7473 2e69  = max(f1_stats.i
+00079e40: 7465 6d73 2829 2c20 6b65 793d 6f70 6572  tems(), key=oper
+00079e50: 6174 6f72 2e69 7465 6d67 6574 7465 7228  ator.itemgetter(
+00079e60: 3129 295b 305d 0d0a 2020 2020 2020 2020  1))[0]..        
+00079e70: 2020 2020 7072 696e 7428 2742 6173 6564      print('Based
+00079e80: 206f 6e20 7472 7969 6e67 206d 756c 7469   on trying multi
+00079e90: 706c 6520 6d6f 6465 6c73 2c20 4265 7374  ple models, Best
+00079ea0: 2074 7970 6520 6f66 2061 6c67 6f72 6974   type of algorit
+00079eb0: 686d 2066 6f72 2074 6869 7320 6461 7461  hm for this data
+00079ec0: 2073 6574 2069 7320 2573 2720 2562 6573   set is %s' %bes
+00079ed0: 745f 6d6f 6465 6c5f 6e61 6d65 290d 0a20  t_model_name).. 
+00079ee0: 2020 2020 2020 2065 7863 6570 743a 0d0a         except:..
+00079ef0: 2020 2020 2020 2020 2020 2020 7072 696e              prin
+00079f00: 7428 2743 6f75 6c64 206e 6f74 2064 6574  t('Could not det
+00079f10: 6563 7420 6265 7374 2061 6c67 6f72 6974  ect best algorit
+00079f20: 686d 2074 7970 6520 6672 6f6d 2065 6e73  hm type from ens
+00079f30: 656d 626c 696e 672e 2043 6f6e 7469 6e75  embling. Continu
+00079f40: 696e 672e 2e2e 2729 0d0a 2020 2020 7265  ing...')..    re
+00079f50: 7475 726e 206d 6f64 656c 5f6e 616d 652c  turn model_name,
+00079f60: 2073 7461 636b 730d 0a23 2323 2323 2323   stacks..#######
+00079f70: 2323 2323 2323 2323 2323 2323 2323 2323  ################
+00079f80: 2323 2323 2323 2323 2323 2323 2323 2323  ################
+00079f90: 2323 2323 2323 2323 2323 2323 2323 2323  ################
+00079fa0: 2323 0d0a 0000 0000 0000 0000 0000 0000  ##..............
+00079fb0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+00079fc0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+00079fd0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+00079fe0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+00079ff0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+0007a000: 2e2f 2e2f 4050 6178 4865 6164 6572 0000  ././@PaxHeader..
+0007a010: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+0007a020: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+0007a030: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+0007a040: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+0007a050: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+0007a060: 0000 0000 3030 3030 3030 3000 3030 3030  ....0000000.0000
+0007a070: 3030 3000 3030 3030 3030 3000 3030 3030  000.0000000.0000
+0007a080: 3030 3030 3032 3600 3030 3030 3030 3030  0000026.00000000
+0007a090: 3030 3000 3031 3134 3533 0020 7800 0000  000.011453. x...
+0007a0a0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+0007a0b0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+0007a0c0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+0007a0d0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+0007a0e0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+0007a0f0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+0007a100: 0075 7374 6172 0030 3000 0000 0000 0000  .ustar.00.......
+0007a110: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+0007a120: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+0007a130: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+0007a140: 0000 0000 0000 0000 0030 3030 3030 3030  .........0000000
+0007a150: 0030 3030 3030 3030 0000 0000 0000 0000  .0000000........
+0007a160: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+0007a170: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+0007a180: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+0007a190: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+0007a1a0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+0007a1b0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+0007a1c0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+0007a1d0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+0007a1e0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+0007a1f0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+0007a200: 3232 206d 7469 6d65 3d31 3637 3831 3539  22 mtime=1678159
+0007a210: 3732 322e 300a 0000 0000 0000 0000 0000  722.0...........
+0007a220: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+0007a230: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+0007a240: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+0007a250: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+0007a260: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+0007a270: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+0007a280: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+0007a290: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+0007a2a0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+0007a2b0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+0007a2c0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+0007a2d0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+0007a2e0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+0007a2f0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+0007a300: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+0007a310: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+0007a320: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+0007a330: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+0007a340: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+0007a350: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+0007a360: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+0007a370: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+0007a380: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+0007a390: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+0007a3a0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+0007a3b0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+0007a3c0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+0007a3d0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+0007a3e0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+0007a3f0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+0007a400: 6175 746f 7669 6d6c 2d30 2e31 2e37 3135  autoviml-0.1.715
+0007a410: 2f61 7574 6f76 696d 6c2f 5175 6963 6b4d  /autoviml/QuickM
+0007a420: 4c5f 5374 6163 6b69 6e67 2e70 7900 0000  L_Stacking.py...
+0007a430: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+0007a440: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+0007a450: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+0007a460: 0000 0000 3030 3030 3737 3700 3030 3031  ....0000777.0001
+0007a470: 3735 3000 3030 3031 3735 3000 3030 3030  750.0001750.0000
+0007a480: 3030 3236 3237 3600 3030 3030 3030 3030  0026276.00000000
+0007a490: 3030 3000 3032 3034 3734 0020 3000 0000  000.020474. 0...
+0007a4a0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+0007a4b0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+0007a4c0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+0007a4d0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+0007a4e0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+0007a4f0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+0007a500: 0075 7374 6172 0030 3072 616d 0000 0000  .ustar.00ram....
+0007a510: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+0007a520: 0000 0000 0000 0000 0072 616d 0000 0000  .........ram....
+0007a530: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+0007a540: 0000 0000 0000 0000 0030 3030 3030 3030  .........0000000
+0007a550: 0030 3030 3030 3030 0000 0000 0000 0000  .0000000........
+0007a560: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+0007a570: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+0007a580: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+0007a590: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+0007a5a0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+0007a5b0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+0007a5c0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+0007a5d0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+0007a5e0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+0007a5f0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+0007a600: 696d 706f 7274 2070 616e 6461 7320 6173  import pandas as
+0007a610: 2070 640d 0a69 6d70 6f72 7420 6e75 6d70   pd..import nump
+0007a620: 7920 6173 206e 700d 0a69 6d70 6f72 7420  y as np..import 
+0007a630: 7761 726e 696e 6773 0d0a 7761 726e 696e  warnings..warnin
+0007a640: 6773 2e66 696c 7465 7277 6172 6e69 6e67  gs.filterwarning
+0007a650: 7328 2269 676e 6f72 6522 290d 0a66 726f  s("ignore")..fro
+0007a660: 6d20 736b 6c65 6172 6e2e 6d6f 6465 6c5f  m sklearn.model_
+0007a670: 7365 6c65 6374 696f 6e20 696d 706f 7274  selection import
+0007a680: 2063 726f 7373 5f76 616c 5f73 636f 7265   cross_val_score
+0007a690: 2c20 5374 7261 7469 6669 6564 5368 7566  , StratifiedShuf
+0007a6a0: 666c 6553 706c 6974 2c20 5469 6d65 5365  fleSplit, TimeSe
+0007a6b0: 7269 6573 5370 6c69 740d 0a66 726f 6d20  riesSplit..from 
+0007a6c0: 736b 6c65 6172 6e2e 6d6f 6465 6c5f 7365  sklearn.model_se
+0007a6d0: 6c65 6374 696f 6e20 696d 706f 7274 2053  lection import S
+0007a6e0: 6875 6666 6c65 5370 6c69 742c 5374 7261  huffleSplit,Stra
+0007a6f0: 7469 6669 6564 4b46 6f6c 642c 4b46 6f6c  tifiedKFold,KFol
+0007a700: 640d 0a66 726f 6d20 736b 6c65 6172 6e2e  d..from sklearn.
+0007a710: 6469 7363 7269 6d69 6e61 6e74 5f61 6e61  discriminant_ana
+0007a720: 6c79 7369 7320 696d 706f 7274 204c 696e  lysis import Lin
+0007a730: 6561 7244 6973 6372 696d 696e 616e 7441  earDiscriminantA
+0007a740: 6e61 6c79 7369 730d 0a66 726f 6d20 736b  nalysis..from sk
+0007a750: 6c65 6172 6e2e 656e 7365 6d62 6c65 2069  learn.ensemble i
+0007a760: 6d70 6f72 7420 4261 6767 696e 6752 6567  mport BaggingReg
+0007a770: 7265 7373 6f72 2c20 5261 6e64 6f6d 466f  ressor, RandomFo
+0007a780: 7265 7374 436c 6173 7369 6669 6572 0d0a  restClassifier..
+0007a790: 6672 6f6d 2073 6b6c 6561 726e 2e65 6e73  from sklearn.ens
+0007a7a0: 656d 626c 6520 696d 706f 7274 2045 7874  emble import Ext
+0007a7b0: 7261 5472 6565 7343 6c61 7373 6966 6965  raTreesClassifie
+0007a7c0: 722c 4578 7472 6154 7265 6573 5265 6772  r,ExtraTreesRegr
+0007a7d0: 6573 736f 720d 0a66 726f 6d20 736b 6c65  essor..from skle
+0007a7e0: 6172 6e2e 6c69 6e65 6172 5f6d 6f64 656c  arn.linear_model
+0007a7f0: 2069 6d70 6f72 7420 4c6f 6769 7374 6963   import Logistic
+0007a800: 5265 6772 6573 7369 6f6e 4356 2c20 4c69  RegressionCV, Li
+0007a810: 6e65 6172 5265 6772 6573 7369 6f6e 2c20  nearRegression, 
+0007a820: 5269 6467 650d 0a66 726f 6d20 736b 6c65  Ridge..from skle
+0007a830: 6172 6e2e 7376 6d20 696d 706f 7274 204c  arn.svm import L
+0007a840: 696e 6561 7253 5643 2c20 5356 522c 204c  inearSVC, SVR, L
+0007a850: 696e 6561 7253 5652 0d0a 6672 6f6d 2073  inearSVR..from s
+0007a860: 6b6c 6561 726e 2e65 6e73 656d 626c 6520  klearn.ensemble 
+0007a870: 696d 706f 7274 2041 6461 426f 6f73 7443  import AdaBoostC
+0007a880: 6c61 7373 6966 6965 722c 2041 6461 426f  lassifier, AdaBo
+0007a890: 6f73 7452 6567 7265 7373 6f72 0d0a 6672  ostRegressor..fr
+0007a8a0: 6f6d 2073 6b6c 6561 726e 2e74 7265 6520  om sklearn.tree 
+0007a8b0: 696d 706f 7274 2044 6563 6973 696f 6e54  import DecisionT
+0007a8c0: 7265 6552 6567 7265 7373 6f72 2c20 4465  reeRegressor, De
+0007a8d0: 6369 7369 6f6e 5472 6565 436c 6173 7369  cisionTreeClassi
+0007a8e0: 6669 6572 0d0a 6672 6f6d 2073 6b6c 6561  fier..from sklea
+0007a8f0: 726e 2e6c 696e 6561 725f 6d6f 6465 6c20  rn.linear_model 
+0007a900: 696d 706f 7274 204c 6173 736f 2c20 4c61  import Lasso, La
+0007a910: 7373 6f43 562c 2052 6964 6765 2c20 5269  ssoCV, Ridge, Ri
+0007a920: 6467 6543 562c 204c 6173 736f 4c61 7273  dgeCV, LassoLars
+0007a930: 4356 0d0a 6672 6f6d 2073 6b6c 6561 726e  CV..from sklearn
+0007a940: 2e6d 6f64 656c 5f73 656c 6563 7469 6f6e  .model_selection
+0007a950: 2069 6d70 6f72 7420 6372 6f73 735f 7661   import cross_va
+0007a960: 6c5f 7072 6564 6963 740d 0a66 726f 6d20  l_predict..from 
+0007a970: 736b 6c65 6172 6e2e 656e 7365 6d62 6c65  sklearn.ensemble
+0007a980: 2069 6d70 6f72 7420 4578 7472 6154 7265   import ExtraTre
+0007a990: 6573 5265 6772 6573 736f 722c 2045 7874  esRegressor, Ext
+0007a9a0: 7261 5472 6565 7343 6c61 7373 6966 6965  raTreesClassifie
+0007a9b0: 720d 0a66 726f 6d20 736b 6c65 6172 6e2e  r..from sklearn.
+0007a9c0: 6c69 6e65 6172 5f6d 6f64 656c 2069 6d70  linear_model imp
+0007a9d0: 6f72 7420 4c6f 6769 7374 6963 5265 6772  ort LogisticRegr
+0007a9e0: 6573 7369 6f6e 2c20 4c6f 6769 7374 6963  ession, Logistic
+0007a9f0: 5265 6772 6573 7369 6f6e 4356 2c20 4c69  RegressionCV, Li
+0007aa00: 6e65 6172 5265 6772 6573 7369 6f6e 0d0a  nearRegression..
+0007aa10: 6672 6f6d 2073 6b6c 6561 726e 2e6d 6f64  from sklearn.mod
+0007aa20: 656c 5f73 656c 6563 7469 6f6e 2069 6d70  el_selection imp
+0007aa30: 6f72 7420 4772 6964 5365 6172 6368 4356  ort GridSearchCV
+0007aa40: 2c53 7472 6174 6966 6965 6453 6875 6666  ,StratifiedShuff
+0007aa50: 6c65 5370 6c69 742c 5368 7566 666c 6553  leSplit,ShuffleS
+0007aa60: 706c 6974 0d0a 6672 6f6d 2073 6b6c 6561  plit..from sklea
+0007aa70: 726e 2e6e 6169 7665 5f62 6179 6573 2069  rn.naive_bayes i
+0007aa80: 6d70 6f72 7420 4761 7573 7369 616e 4e42  mport GaussianNB
+0007aa90: 2c20 4d75 6c74 696e 6f6d 6961 6c4e 420d  , MultinomialNB.
+0007aaa0: 0a66 726f 6d20 736b 6c65 6172 6e2e 7472  .from sklearn.tr
+0007aab0: 6565 2069 6d70 6f72 7420 4465 6369 7369  ee import Decisi
+0007aac0: 6f6e 5472 6565 436c 6173 7369 6669 6572  onTreeClassifier
+0007aad0: 0d0a 696d 706f 7274 2074 696d 650d 0a69  ..import time..i
+0007aae0: 6d70 6f72 7420 7064 620d 0a69 6d70 6f72  mport pdb..impor
+0007aaf0: 7420 7469 6d65 0d0a 696d 706f 7274 2063  t time..import c
+0007ab00: 6f70 790d 0a66 726f 6d20 636f 6c6c 6563  opy..from collec
+0007ab10: 7469 6f6e 7320 696d 706f 7274 2043 6f75  tions import Cou
+0007ab20: 6e74 6572 0d0a 6672 6f6d 2063 6f6c 6c65  nter..from colle
+0007ab30: 6374 696f 6e73 2069 6d70 6f72 7420 6465  ctions import de
+0007ab40: 6661 756c 7464 6963 740d 0a66 726f 6d20  faultdict..from 
+0007ab50: 636f 6c6c 6563 7469 6f6e 7320 696d 706f  collections impo
+0007ab60: 7274 204f 7264 6572 6564 4469 6374 0d0a  rt OrderedDict..
+0007ab70: 2323 2323 2323 2323 2323 2323 2323 2323  ################
+0007ab80: 2323 2323 2323 2323 2323 2323 2323 2323  ################
+0007ab90: 2323 2323 2323 2323 2323 2323 2323 2323  ################
+0007aba0: 2323 2323 2323 2323 2323 2323 2323 2323  ################
+0007abb0: 2323 2323 2323 2323 2323 2323 230d 0a64  #############..d
+0007abc0: 6566 2066 696e 645f 7261 7265 5f63 6c61  ef find_rare_cla
+0007abd0: 7373 2863 6c61 7373 6573 2c20 7665 7262  ss(classes, verb
+0007abe0: 6f73 653d 3029 3a0d 0a20 2020 2023 2323  ose=0):..    ###
+0007abf0: 2323 2323 2323 2050 7269 6e74 2074 6865  ###### Print the
+0007ac00: 2025 2063 6f75 6e74 206f 6620 6561 6368   % count of each
+0007ac10: 2063 6c61 7373 2069 6e20 6120 5461 7267   class in a Targ
+0007ac20: 6574 2076 6172 6961 626c 6520 2023 2323  et variable  ###
+0007ac30: 2323 0d0a 2020 2020 2222 220d 0a20 2020  ##..    """..   
+0007ac40: 2057 6f72 6b73 206f 6e20 4d75 6c74 6920   Works on Multi 
+0007ac50: 436c 6173 7320 746f 6f2e 2050 7269 6e74  Class too. Print
+0007ac60: 7320 636c 6173 7320 7065 7263 656e 7461  s class percenta
+0007ac70: 6765 7320 636f 756e 7420 6f66 2074 6172  ges count of tar
+0007ac80: 6765 7420 7661 7269 6162 6c65 2e0d 0a20  get variable... 
+0007ac90: 2020 2049 7420 7265 7475 726e 7320 7468     It returns th
+0007aca0: 6520 6e61 6d65 206f 6620 7468 6520 5261  e name of the Ra
+0007acb0: 7265 2063 6c61 7373 2028 7468 6520 6f6e  re class (the on
+0007acc0: 6520 7769 7468 2074 6865 206d 696e 696d  e with the minim
+0007acd0: 756d 2063 6c61 7373 206d 656d 6265 7220  um class member 
+0007ace0: 636f 756e 7429 2e0d 0a20 2020 2054 6869  count)...    Thi
+0007acf0: 7320 6361 6e20 616c 736f 2062 6520 6865  s can also be he
+0007ad00: 6c70 6675 6c20 696e 2075 7369 6e67 2069  lpful in using i
+0007ad10: 7420 6173 2070 6f73 5f6c 6162 656c 2069  t as pos_label i
+0007ad20: 6e20 4269 6e61 7279 2061 6e64 204d 756c  n Binary and Mul
+0007ad30: 7469 2043 6c61 7373 2070 726f 626c 656d  ti Class problem
+0007ad40: 732e 0d0a 2020 2020 2222 220d 0a20 2020  s...    """..   
+0007ad50: 2063 6f75 6e74 7320 3d20 4f72 6465 7265   counts = Ordere
+0007ad60: 6444 6963 7428 436f 756e 7465 7228 636c  dDict(Counter(cl
+0007ad70: 6173 7365 7329 290d 0a20 2020 2074 6f74  asses))..    tot
+0007ad80: 616c 203d 2073 756d 2863 6f75 6e74 732e  al = sum(counts.
+0007ad90: 7661 6c75 6573 2829 290d 0a20 2020 2069  values())..    i
+0007ada0: 6620 7665 7262 6f73 6520 3e3d 2031 3a0d  f verbose >= 1:.
+0007adb0: 0a20 2020 2020 2020 2070 7269 6e74 2827  .        print('
+0007adc0: 2043 6c61 7373 2020 2d3e 2043 6f75 6e74   Class  -> Count
+0007add0: 7320 2d3e 2050 6572 6365 6e74 2729 0d0a  s -> Percent')..
+0007ade0: 2020 2020 2020 2020 666f 7220 636c 7320          for cls 
+0007adf0: 696e 2063 6f75 6e74 732e 6b65 7973 2829  in counts.keys()
+0007ae00: 3a0d 0a20 2020 2020 2020 2020 2020 2070  :..            p
+0007ae10: 7269 6e74 2822 2536 733a 2025 2037 6420  rint("%6s: % 7d 
+0007ae20: 202d 3e20 2025 2035 2e31 6625 2522 2025   ->  % 5.1f%%" %
+0007ae30: 2028 636c 732c 2063 6f75 6e74 735b 636c   (cls, counts[cl
+0007ae40: 735d 2c20 636f 756e 7473 5b63 6c73 5d2f  s], counts[cls]/
+0007ae50: 746f 7461 6c2a 3130 3029 290d 0a20 2020  total*100))..   
+0007ae60: 2069 6620 7479 7065 2870 642e 5365 7269   if type(pd.Seri
+0007ae70: 6573 2863 6f75 6e74 7329 2e69 6478 6d69  es(counts).idxmi
+0007ae80: 6e28 2929 3d3d 7374 723a 0d0a 2020 2020  n())==str:..    
+0007ae90: 2020 2020 7265 7475 726e 2070 642e 5365      return pd.Se
+0007aea0: 7269 6573 2863 6f75 6e74 7329 2e69 6478  ries(counts).idx
+0007aeb0: 6d69 6e28 290d 0a20 2020 2065 6c73 653a  min()..    else:
+0007aec0: 0d0a 2020 2020 2020 2020 7265 7475 726e  ..        return
+0007aed0: 2069 6e74 2870 642e 5365 7269 6573 2863   int(pd.Series(c
+0007aee0: 6f75 6e74 7329 2e69 6478 6d69 6e28 2929  ounts).idxmin())
+0007aef0: 0d0a 2323 2323 2323 2323 2323 2323 2323  ..##############
+0007af00: 2323 2323 2323 2323 2323 2323 2323 2323  ################
+0007af10: 2323 2323 2323 2323 2323 2323 2323 2323  ################
+0007af20: 2323 2323 2323 2323 2323 2323 2323 2323  ################
+0007af30: 2323 2323 2323 2323 2323 2323 2323 2323  ################
+0007af40: 2323 0d0a 6465 6620 5175 6963 6b4d 4c5f  ##..def QuickML_
+0007af50: 5374 6163 6b69 6e67 2858 5f74 7261 696e  Stacking(X_train
+0007af60: 2c20 795f 7472 6169 6e2c 2058 5f74 6573  , y_train, X_tes
+0007af70: 743d 2727 2c20 6d6f 6465 6c74 7970 653d  t='', modeltype=
+0007af80: 2752 6567 7265 7373 696f 6e27 2c42 6f6f  'Regression',Boo
+0007af90: 7374 696e 675f 466c 6167 3d46 616c 7365  sting_Flag=False
+0007afa0: 2c0d 0a20 2020 2020 2020 2020 2020 2020  ,..             
+0007afb0: 2020 2020 2020 2073 636f 7269 6e67 3d27         scoring='
+0007afc0: 272c 2076 6572 626f 7365 3d30 293a 0d0a  ', verbose=0):..
+0007afd0: 2020 2020 2222 220d 0a20 2020 2051 7569      """..    Qui
+0007afe0: 636b 6c79 2062 7569 6c64 2053 7461 636b  ckly build Stack
+0007aff0: 7320 6f66 206d 756c 7469 706c 6520 6d6f  s of multiple mo
+0007b000: 6465 6c20 7265 7375 6c74 730d 0a20 2020  del results..   
+0007b010: 2049 6e70 7574 206d 7573 7420 6265 2061   Input must be a
+0007b020: 2063 6c65 616e 2064 6174 6120 7365 7420   clean data set 
+0007b030: 286f 6e6c 7920 6e75 6d65 7269 6320 7661  (only numeric va
+0007b040: 7269 6162 6c65 732c 206e 6f20 6361 7465  riables, no cate
+0007b050: 676f 7269 6361 6c20 6f72 2073 7472 696e  gorical or strin
+0007b060: 6720 7661 7269 6162 6c65 7329 2e0d 0a20  g variables)... 
+0007b070: 2020 2022 2222 0d0a 2020 2020 585f 7472     """..    X_tr
+0007b080: 6169 6e20 3d20 636f 7079 2e64 6565 7063  ain = copy.deepc
+0007b090: 6f70 7928 585f 7472 6169 6e29 0d0a 2020  opy(X_train)..  
+0007b0a0: 2020 585f 7465 7374 203d 2063 6f70 792e    X_test = copy.
+0007b0b0: 6465 6570 636f 7079 2858 5f74 6573 7429  deepcopy(X_test)
+0007b0c0: 0d0a 2020 2020 795f 7472 6169 6e20 3d20  ..    y_train = 
+0007b0d0: 636f 7079 2e64 6565 7063 6f70 7928 795f  copy.deepcopy(y_
+0007b0e0: 7472 6169 6e29 0d0a 2020 2020 7374 6172  train)..    star
+0007b0f0: 745f 7469 6d65 203d 2074 696d 652e 7469  t_time = time.ti
+0007b100: 6d65 2829 0d0a 2020 2020 7365 6564 203d  me()..    seed =
+0007b110: 2039 390d 0a20 2020 2069 6620 6c65 6e28   99..    if len(
+0007b120: 585f 7472 6169 6e29 203c 3d20 3130 3030  X_train) <= 1000
+0007b130: 3030 206f 7220 585f 7472 6169 6e2e 7368  00 or X_train.sh
+0007b140: 6170 655b 315d 203c 2035 303a 0d0a 2020  ape[1] < 50:..  
+0007b150: 2020 2020 2020 4e55 4d53 203d 2031 3030        NUMS = 100
+0007b160: 0d0a 2020 2020 2020 2020 464f 4c44 5320  ..        FOLDS 
+0007b170: 3d20 350d 0a20 2020 2065 6c73 653a 0d0a  = 5..    else:..
+0007b180: 2020 2020 2020 2020 4e55 4d53 203d 2032          NUMS = 2
+0007b190: 3030 0d0a 2020 2020 2020 2020 464f 4c44  00..        FOLD
+0007b1a0: 5320 3d20 3130 0d0a 2020 2020 2323 2063  S = 10..    ## c
+0007b1b0: 7265 6174 6520 5374 6163 6b69 6e67 206d  reate Stacking m
+0007b1c0: 6f64 656c 730d 0a20 2020 2065 7374 696d  odels..    estim
+0007b1d0: 6174 6f72 7320 3d20 5b5d 0d0a 2020 2020  ators = []..    
+0007b1e0: 2323 2320 5468 6973 206b 6565 7073 2074  ### This keeps t
+0007b1f0: 7261 636b 7320 6f66 2074 6865 206e 756d  racks of the num
+0007b200: 6265 7220 6f66 2070 7265 6469 6374 5f70  ber of predict_p
+0007b210: 726f 6261 2063 6f6c 756d 6e73 2067 656e  roba columns gen
+0007b220: 6572 6174 6564 2062 7920 6561 6368 206d  erated by each m
+0007b230: 6f64 656c 2023 2323 230d 0a20 2020 2065  odel ####..    e
+0007b240: 7374 696d 6174 6f72 5f6c 656e 6774 6820  stimator_length 
+0007b250: 3d20 5b5d 0d0a 2020 2020 6966 2069 7369  = []..    if isi
+0007b260: 6e73 7461 6e63 6528 585f 7465 7374 2c20  nstance(X_test, 
+0007b270: 7374 7229 3a0d 0a20 2020 2020 2020 206e  str):..        n
+0007b280: 6f5f 6669 7420 3d20 5472 7565 0d0a 2020  o_fit = True..  
+0007b290: 2020 656c 7365 3a0d 0a20 2020 2020 2020    else:..       
+0007b2a0: 206e 6f5f 6669 7420 3d20 4661 6c73 650d   no_fit = False.
+0007b2b0: 0a20 2020 2069 6620 6e6f 5f66 6974 3a0d  .    if no_fit:.
+0007b2c0: 0a20 2020 2020 2020 2023 2323 2320 5468  .        #### Th
+0007b2d0: 6973 2069 7320 7768 6572 6520 796f 7520  is is where you 
+0007b2e0: 646f 6e27 7420 6669 7420 7468 6520 6d6f  don't fit the mo
+0007b2f0: 6465 6c20 6275 7420 6a75 7374 2064 6f20  del but just do 
+0007b300: 6372 6f73 735f 7661 6c5f 7072 6564 6963  cross_val_predic
+0007b310: 7420 2323 2323 0d0a 2020 2020 2020 2020  t ####..        
+0007b320: 6966 206d 6f64 656c 7479 7065 203d 3d20  if modeltype == 
+0007b330: 2752 6567 7265 7373 696f 6e27 3a0d 0a20  'Regression':.. 
+0007b340: 2020 2020 2020 2020 2020 2069 6620 7363             if sc
+0007b350: 6f72 696e 6720 3d3d 2027 273a 0d0a 2020  oring == '':..  
+0007b360: 2020 2020 2020 2020 2020 2020 2020 7363                sc
+0007b370: 6f72 696e 6720 3d20 276e 6567 5f6d 6561  oring = 'neg_mea
+0007b380: 6e5f 7371 7561 7265 645f 6572 726f 7227  n_squared_error'
+0007b390: 0d0a 2020 2020 2020 2020 2020 2020 7363  ..            sc
+0007b3a0: 7620 3d20 4b46 6f6c 6428 6e5f 7370 6c69  v = KFold(n_spli
+0007b3b0: 7473 3d46 4f4c 4453 2c20 7368 7566 666c  ts=FOLDS, shuffl
+0007b3c0: 653d 4661 6c73 6529 0d0a 2020 2020 2020  e=False)..      
+0007b3d0: 2020 2020 2020 6966 2042 6f6f 7374 696e        if Boostin
+0007b3e0: 675f 466c 6167 3a0d 0a20 2020 2020 2020  g_Flag:..       
+0007b3f0: 2020 2020 2020 2020 2023 2323 2323 2320           ###### 
+0007b400: 2020 2042 6167 6769 6e67 206d 6f64 656c     Bagging model
+0007b410: 7320 6966 2042 6167 6769 6e67 2069 7320  s if Bagging is 
+0007b420: 6368 6f73 656e 2023 2323 230d 0a20 2020  chosen ####..   
+0007b430: 2020 2020 2020 2020 2020 2020 2023 6d6f               #mo
+0007b440: 6465 6c34 203d 2042 6167 6769 6e67 5265  del4 = BaggingRe
+0007b450: 6772 6573 736f 7228 4465 6369 7369 6f6e  gressor(Decision
+0007b460: 5472 6565 5265 6772 6573 736f 7228 7261  TreeRegressor(ra
+0007b470: 6e64 6f6d 5f73 7461 7465 3d73 6565 6429  ndom_state=seed)
 0007b480: 2c0d 0a20 2020 2020 2020 2020 2020 2020  ,..             
-0007b490: 2020 2020 2020 2020 2020 2020 2020 2020                  
-0007b4a0: 2020 2020 2020 2020 2020 2020 2020 206d                 m
-0007b4b0: 6574 686f 643d 2770 7265 6469 6374 5f70  ethod='predict_p
-0007b4c0: 726f 6261 2729 0d0a 2020 2020 2020 2020  roba')..        
-0007b4d0: 2020 2020 2020 2020 6573 7469 6d61 746f          estimato
-0007b4e0: 7273 2e61 7070 656e 6428 2827 4c69 6e65  rs.append(('Line
-0007b4f0: 6172 2044 6973 6372 696d 696e 616e 7427  ar Discriminant'
-0007b500: 2c6d 6f64 656c 3429 290d 0a20 2020 2020  ,model4))..     
-0007b510: 2020 2020 2020 2020 2020 2065 7374 696d             estim
-0007b520: 6174 6f72 5f6c 656e 6774 682e 6170 7065  ator_length.appe
-0007b530: 6e64 2872 6573 756c 7473 2e73 6861 7065  nd(results.shape
-0007b540: 5b31 5d29 0d0a 2020 2020 2020 2020 2020  [1])..          
-0007b550: 2020 656c 6966 2042 6f6f 7374 696e 675f    elif Boosting_
-0007b560: 466c 6167 2069 7320 4e6f 6e65 3a0d 0a20  Flag is None:.. 
-0007b570: 2020 2020 2020 2020 2020 2020 2020 2023                 #
-0007b580: 2323 2320 2020 5472 6565 206d 6f64 656c  ###   Tree model
-0007b590: 7320 6966 204c 696e 6561 7220 6368 6f73  s if Linear chos
-0007b5a0: 656e 2023 2323 2323 0d0a 2020 2020 2020  en #####..      
-0007b5b0: 2020 2020 2020 2020 2020 6d6f 6465 6c36            model6
-0007b5c0: 203d 2044 6563 6973 696f 6e54 7265 6543   = DecisionTreeC
-0007b5d0: 6c61 7373 6966 6965 7228 6d69 6e5f 7361  lassifier(min_sa
-0007b5e0: 6d70 6c65 735f 6c65 6166 3d32 290d 0a20  mples_leaf=2).. 
-0007b5f0: 2020 2020 2020 2020 2020 2020 2020 2072                 r
-0007b600: 6573 756c 7473 203d 2063 726f 7373 5f76  esults = cross_v
-0007b610: 616c 5f70 7265 6469 6374 286d 6f64 656c  al_predict(model
-0007b620: 362c 585f 7472 6169 6e2c 795f 7472 6169  6,X_train,y_trai
-0007b630: 6e2c 2063 763d 7363 762c 6e5f 6a6f 6273  n, cv=scv,n_jobs
-0007b640: 3d2d 312c 0d0a 2020 2020 2020 2020 2020  =-1,..          
-0007b650: 2020 2020 2020 2020 2020 2020 2020 2020                  
-0007b660: 2020 2020 2020 2020 2020 2020 2020 2020                  
-0007b670: 2020 6d65 7468 6f64 3d27 7072 6564 6963    method='predic
-0007b680: 745f 7072 6f62 6127 290d 0a20 2020 2020  t_proba')..     
-0007b690: 2020 2020 2020 2020 2020 2065 7374 696d             estim
-0007b6a0: 6174 6f72 732e 6170 7065 6e64 2828 2744  ators.append(('D
-0007b6b0: 6563 6973 696f 6e20 5472 6565 272c 6d6f  ecision Tree',mo
-0007b6c0: 6465 6c36 2929 0d0a 2020 2020 2020 2020  del6))..        
-0007b6d0: 2020 2020 2020 2020 6573 7469 6d61 746f          estimato
-0007b6e0: 725f 6c65 6e67 7468 2e61 7070 656e 6428  r_length.append(
-0007b6f0: 7265 7375 6c74 732e 7368 6170 655b 315d  results.shape[1]
-0007b700: 290d 0a20 2020 2020 2020 2020 2020 2065  )..            e
-0007b710: 6c73 653a 0d0a 2020 2020 2020 2020 2020  lse:..          
-0007b720: 2020 2020 2020 2323 2323 2323 2020 2020        ######    
-0007b730: 4e61 6976 6520 4261 7965 7320 6d6f 6465  Naive Bayes mode
-0007b740: 6c73 2069 6620 4261 6767 696e 6720 6973  ls if Bagging is
-0007b750: 2063 686f 7365 6e20 2323 2323 0d0a 2020   chosen ####..  
-0007b760: 2020 2020 2020 2020 2020 2020 2020 6966                if
-0007b770: 206e 5f63 6c61 7373 6573 203c 3d20 323a   n_classes <= 2:
-0007b780: 0d0a 2020 2020 2020 2020 2020 2020 2020  ..              
-0007b790: 2020 2020 2020 7472 793a 0d0a 2020 2020        try:..    
-0007b7a0: 2020 2020 2020 2020 2020 2020 2020 2020                  
-0007b7b0: 2020 2020 6d6f 6465 6c37 203d 2047 6175      model7 = Gau
-0007b7c0: 7373 6961 6e4e 4228 290d 0a20 2020 2020  ssianNB()..     
-0007b7d0: 2020 2020 2020 2020 2020 2020 2020 2065                 e
-0007b7e0: 7863 6570 743a 0d0a 2020 2020 2020 2020  xcept:..        
-0007b7f0: 2020 2020 2020 2020 2020 2020 2020 2020                  
-0007b800: 6d6f 6465 6c37 203d 2044 6563 6973 696f  model7 = Decisio
-0007b810: 6e54 7265 6543 6c61 7373 6966 6965 7228  nTreeClassifier(
-0007b820: 6d69 6e5f 7361 6d70 6c65 735f 6c65 6166  min_samples_leaf
-0007b830: 3d32 290d 0a20 2020 2020 2020 2020 2020  =2)..           
-0007b840: 2020 2020 2065 6c73 653a 0d0a 2020 2020       else:..    
-0007b850: 2020 2020 2020 2020 2020 2020 2020 2020                  
-0007b860: 7472 793a 0d0a 2020 2020 2020 2020 2020  try:..          
-0007b870: 2020 2020 2020 2020 2020 2020 2020 6d6f                mo
-0007b880: 6465 6c37 203d 204d 756c 7469 6e6f 6d69  del7 = Multinomi
-0007b890: 616c 4e42 2829 0d0a 2020 2020 2020 2020  alNB()..        
-0007b8a0: 2020 2020 2020 2020 2020 2020 6578 6365              exce
-0007b8b0: 7074 3a0d 0a20 2020 2020 2020 2020 2020  pt:..           
-0007b8c0: 2020 2020 2020 2020 2020 2020 206d 6f64               mod
-0007b8d0: 656c 3720 3d20 4465 6369 7369 6f6e 5472  el7 = DecisionTr
-0007b8e0: 6565 436c 6173 7369 6669 6572 286d 696e  eeClassifier(min
-0007b8f0: 5f73 616d 706c 6573 5f6c 6561 663d 3229  _samples_leaf=2)
-0007b900: 0d0a 2020 2020 2020 2020 2020 2020 2020  ..              
-0007b910: 2020 7265 7375 6c74 7320 3d20 6372 6f73    results = cros
-0007b920: 735f 7661 6c5f 7072 6564 6963 7428 6d6f  s_val_predict(mo
-0007b930: 6465 6c37 2c58 5f74 7261 696e 2c79 5f74  del7,X_train,y_t
-0007b940: 7261 696e 2c20 6376 3d73 6376 2c6e 5f6a  rain, cv=scv,n_j
-0007b950: 6f62 733d 2d31 2c0d 0a20 2020 2020 2020  obs=-1,..       
-0007b960: 2020 2020 2020 2020 2020 2020 2020 2020                  
-0007b970: 2020 2020 2020 2020 2020 2020 2020 2020                  
-0007b980: 2020 2020 206d 6574 686f 643d 2770 7265       method='pre
-0007b990: 6469 6374 5f70 726f 6261 2729 0d0a 2020  dict_proba')..  
-0007b9a0: 2020 2020 2020 2020 2020 2020 2020 6573                es
-0007b9b0: 7469 6d61 746f 7273 2e61 7070 656e 6428  timators.append(
-0007b9c0: 2827 4e61 6976 6520 4261 7965 7327 2c6d  ('Naive Bayes',m
-0007b9d0: 6f64 656c 3729 290d 0a20 2020 2020 2020  odel7))..       
-0007b9e0: 2020 2020 2020 2020 2065 7374 696d 6174           estimat
-0007b9f0: 6f72 5f6c 656e 6774 682e 6170 7065 6e64  or_length.append
-0007ba00: 2872 6573 756c 7473 2e73 6861 7065 5b31  (results.shape[1
-0007ba10: 5d29 0d0a 2020 2020 656c 7365 3a0d 0a20  ])..    else:.. 
-0007ba20: 2020 2020 2020 2023 2323 2320 5468 6973         #### This
-0007ba30: 2069 7320 7768 6572 6520 796f 7520 6669   is where you fi
-0007ba40: 7420 7468 6520 6d6f 6465 6c20 616e 6420  t the model and 
-0007ba50: 7468 656e 2070 7265 6469 6374 2023 2323  then predict ###
-0007ba60: 2323 2323 230d 0a20 2020 2020 2020 2069  #####..        i
-0007ba70: 6620 6d6f 6465 6c74 7970 6520 3d3d 2027  f modeltype == '
-0007ba80: 5265 6772 6573 7369 6f6e 273a 0d0a 2020  Regression':..  
-0007ba90: 2020 2020 2020 2020 2020 6966 2073 636f            if sco
-0007baa0: 7269 6e67 203d 3d20 2727 3a0d 0a20 2020  ring == '':..   
-0007bab0: 2020 2020 2020 2020 2020 2020 2073 636f               sco
-0007bac0: 7269 6e67 203d 2027 6e65 675f 6d65 616e  ring = 'neg_mean
-0007bad0: 5f73 7175 6172 6564 5f65 7272 6f72 270d  _squared_error'.
-0007bae0: 0a20 2020 2020 2020 2020 2020 2073 6376  .            scv
-0007baf0: 203d 204b 466f 6c64 286e 5f73 706c 6974   = KFold(n_split
-0007bb00: 733d 464f 4c44 532c 2073 6875 6666 6c65  s=FOLDS, shuffle
-0007bb10: 3d46 616c 7365 290d 0a20 2020 2020 2020  =False)..       
-0007bb20: 2020 2020 2069 6620 426f 6f73 7469 6e67       if Boosting
-0007bb30: 5f46 6c61 673a 0d0a 2020 2020 2020 2020  _Flag:..        
-0007bb40: 2020 2020 2020 2020 2323 2323 2323 2020          ######  
-0007bb50: 2020 4261 6767 696e 6720 6d6f 6465 6c73    Bagging models
-0007bb60: 2069 6620 4261 6767 696e 6720 6973 2063   if Bagging is c
-0007bb70: 686f 7365 6e20 2323 2323 0d0a 2020 2020  hosen ####..    
-0007bb80: 2020 2020 2020 2020 2020 2020 236d 6f64              #mod
-0007bb90: 656c 3420 3d20 4261 6767 696e 6752 6567  el4 = BaggingReg
-0007bba0: 7265 7373 6f72 2844 6563 6973 696f 6e54  ressor(DecisionT
-0007bbb0: 7265 6552 6567 7265 7373 6f72 2872 616e  reeRegressor(ran
-0007bbc0: 646f 6d5f 7374 6174 653d 7365 6564 292c  dom_state=seed),
-0007bbd0: 0d0a 2020 2020 2020 2020 2020 2020 2020  ..              
-0007bbe0: 2020 2320 2020 2020 2020 2020 2020 2020    #             
-0007bbf0: 2020 2020 2020 2020 2020 2020 2020 206e                 n
-0007bc00: 5f65 7374 696d 6174 6f72 733d 4e55 4d53  _estimators=NUMS
-0007bc10: 2c72 616e 646f 6d5f 7374 6174 653d 7365  ,random_state=se
-0007bc20: 6564 290d 0a20 2020 2020 2020 2020 2020  ed)..           
-0007bc30: 2020 2020 206d 6f64 656c 3420 3d20 4c69       model4 = Li
-0007bc40: 6e65 6172 5356 5228 290d 0a20 2020 2020  nearSVR()..     
-0007bc50: 2020 2020 2020 2020 2020 2072 6573 756c             resul
-0007bc60: 7473 203d 206d 6f64 656c 342e 6669 7428  ts = model4.fit(
-0007bc70: 585f 7472 6169 6e2c 795f 7472 6169 6e29  X_train,y_train)
-0007bc80: 2e70 7265 6469 6374 2858 5f74 6573 7429  .predict(X_test)
-0007bc90: 0d0a 2020 2020 2020 2020 2020 2020 2020  ..              
-0007bca0: 2020 6573 7469 6d61 746f 7273 2e61 7070    estimators.app
-0007bcb0: 656e 6428 2827 4c69 6e65 6172 5f53 5652  end(('Linear_SVR
-0007bcc0: 272c 6d6f 6465 6c34 2929 0d0a 2020 2020  ',model4))..    
-0007bcd0: 2020 2020 2020 2020 2020 2020 6573 7469              esti
-0007bce0: 6d61 746f 725f 6c65 6e67 7468 2e61 7070  mator_length.app
-0007bcf0: 656e 6428 3129 0d0a 2020 2020 2020 2020  end(1)..        
-0007bd00: 2020 2020 656c 6966 2042 6f6f 7374 696e      elif Boostin
-0007bd10: 675f 466c 6167 2069 7320 4e6f 6e65 3a0d  g_Flag is None:.
-0007bd20: 0a20 2020 2020 2020 2020 2020 2020 2020  .               
-0007bd30: 2023 2323 2320 2020 5472 6565 206d 6f64   ####   Tree mod
-0007bd40: 656c 7320 6966 204c 696e 6561 7220 6368  els if Linear ch
-0007bd50: 6f73 656e 2023 2323 2323 0d0a 2020 2020  osen #####..    
-0007bd60: 2020 2020 2020 2020 2020 2020 6d6f 6465              mode
-0007bd70: 6c35 203d 2044 6563 6973 696f 6e54 7265  l5 = DecisionTre
-0007bd80: 6552 6567 7265 7373 6f72 2872 616e 646f  eRegressor(rando
-0007bd90: 6d5f 7374 6174 653d 7365 6564 2c6d 696e  m_state=seed,min
-0007bda0: 5f73 616d 706c 6573 5f6c 6561 663d 3229  _samples_leaf=2)
-0007bdb0: 0d0a 2020 2020 2020 2020 2020 2020 2020  ..              
-0007bdc0: 2020 7265 7375 6c74 7320 3d20 6d6f 6465    results = mode
-0007bdd0: 6c35 2e66 6974 2858 5f74 7261 696e 2c79  l5.fit(X_train,y
-0007bde0: 5f74 7261 696e 292e 7072 6564 6963 7428  _train).predict(
-0007bdf0: 585f 7465 7374 290d 0a20 2020 2020 2020  X_test)..       
-0007be00: 2020 2020 2020 2020 2065 7374 696d 6174           estimat
-0007be10: 6f72 732e 6170 7065 6e64 2828 2744 6563  ors.append(('Dec
-0007be20: 6973 696f 6e20 5472 6565 7327 2c6d 6f64  ision Trees',mod
-0007be30: 656c 3529 290d 0a20 2020 2020 2020 2020  el5))..         
-0007be40: 2020 2020 2020 2065 7374 696d 6174 6f72         estimator
-0007be50: 5f6c 656e 6774 682e 6170 7065 6e64 2831  _length.append(1
-0007be60: 290d 0a20 2020 2020 2020 2020 2020 2065  )..            e
-0007be70: 6c73 653a 0d0a 2020 2020 2020 2020 2020  lse:..          
-0007be80: 2020 2020 2020 2323 2323 2020 204c 696e        ####   Lin
-0007be90: 6561 7220 4d6f 6465 6c73 2069 6620 426f  ear Models if Bo
-0007bea0: 6f73 7469 6e67 2069 7320 6368 6f73 656e  osting is chosen
-0007beb0: 2023 2323 2323 0d0a 2020 2020 2020 2020   #####..        
-0007bec0: 2020 2020 2020 2020 6d6f 6465 6c36 203d          model6 =
-0007bed0: 204c 6173 736f 4356 2861 6c70 6861 733d   LassoCV(alphas=
-0007bee0: 6e70 2e6c 6f67 7370 6163 6528 2d35 2c2d  np.logspace(-5,-
-0007bef0: 312c 3230 292c 2063 763d 7363 762c 7261  1,20), cv=scv,ra
-0007bf00: 6e64 6f6d 5f73 7461 7465 3d73 6565 6429  ndom_state=seed)
-0007bf10: 0d0a 2020 2020 2020 2020 2020 2020 2020  ..              
-0007bf20: 2020 7265 7375 6c74 7320 3d20 6d6f 6465    results = mode
-0007bf30: 6c36 2e66 6974 2858 5f74 7261 696e 2c79  l6.fit(X_train,y
-0007bf40: 5f74 7261 696e 292e 7072 6564 6963 7428  _train).predict(
-0007bf50: 585f 7465 7374 290d 0a20 2020 2020 2020  X_test)..       
-0007bf60: 2020 2020 2020 2020 2065 7374 696d 6174           estimat
-0007bf70: 6f72 732e 6170 7065 6e64 2828 274c 6173  ors.append(('Las
-0007bf80: 736f 4356 2052 6567 756c 6172 697a 6174  soCV Regularizat
-0007bf90: 696f 6e27 2c6d 6f64 656c 3629 290d 0a20  ion',model6)).. 
-0007bfa0: 2020 2020 2020 2020 2020 2020 2020 2065                 e
-0007bfb0: 7374 696d 6174 6f72 5f6c 656e 6774 682e  stimator_length.
-0007bfc0: 6170 7065 6e64 2831 290d 0a20 2020 2020  append(1)..     
-0007bfd0: 2020 2065 6c73 653a 0d0a 2020 2020 2020     else:..      
-0007bfe0: 2020 2020 2020 6e5f 636c 6173 7365 7320        n_classes 
-0007bff0: 3d20 6c65 6e28 436f 756e 7465 7228 795f  = len(Counter(y_
-0007c000: 7472 6169 6e29 290d 0a20 2020 2020 2020  train))..       
-0007c010: 2020 2020 2069 6620 6e5f 636c 6173 7365       if n_classe
-0007c020: 7320 3e20 323a 0d0a 2020 2020 2020 2020  s > 2:..        
-0007c030: 2020 2020 2020 2020 2323 2323 2049 6e20          #### In 
-0007c040: 6d75 6c74 692d 636c 6173 7320 7365 7474  multi-class sett
-0007c050: 696e 672c 2069 7420 6d61 6b65 7320 7365  ing, it makes se
-0007c060: 6e73 6520 746f 2074 7572 6e20 6974 2069  nse to turn it i
-0007c070: 6e74 6f20 6269 6e61 7279 2063 6c61 7373  nto binary class
-0007c080: 2069 6e20 7374 6167 652d 310d 0a20 2020   in stage-1..   
-0007c090: 2020 2020 2020 2020 2020 2020 2023 2323               ###
-0007c0a0: 2320 496e 2073 7461 6765 2032 2c20 6120  # In stage 2, a 
-0007c0b0: 636f 6d70 6c65 7820 6d6f 6465 6c20 7769  complex model wi
-0007c0c0: 6c6c 2074 616b 6520 7468 6520 696e 7075  ll take the inpu
-0007c0d0: 7473 206f 6620 7468 6973 206d 6f64 656c  ts of this model
-0007c0e0: 2061 6e64 2074 7279 2074 6f20 7072 6564   and try to pred
-0007c0f0: 6963 740d 0a20 2020 2020 2020 2020 2020  ict..           
-0007c100: 2020 2020 2072 6172 655f 636c 6173 7320       rare_class 
-0007c110: 3d20 6669 6e64 5f72 6172 655f 636c 6173  = find_rare_clas
-0007c120: 7328 795f 7472 6169 6e29 0d0a 2020 2020  s(y_train)..    
-0007c130: 2020 2020 2020 2020 2020 2020 6966 2072              if r
-0007c140: 6172 655f 636c 6173 7320 3d3d 2030 3a0d  are_class == 0:.
-0007c150: 0a20 2020 2020 2020 2020 2020 2020 2020  .               
-0007c160: 2020 2020 206d 616a 6f72 6974 795f 636c       majority_cl
-0007c170: 6173 7320 3d20 310d 0a20 2020 2020 2020  ass = 1..       
-0007c180: 2020 2020 2020 2020 2065 6c73 653a 0d0a           else:..
-0007c190: 2020 2020 2020 2020 2020 2020 2020 2020                  
-0007c1a0: 2020 2020 6d61 6a6f 7269 7479 5f63 6c61      majority_cla
-0007c1b0: 7373 203d 2030 0d0a 2020 2020 2020 2020  ss = 0..        
-0007c1c0: 2020 2020 2020 2020 795f 7472 6169 6e20          y_train 
-0007c1d0: 3d20 795f 7472 6169 6e2e 6d61 7028 6c61  = y_train.map(la
-0007c1e0: 6d62 6461 2078 3a20 7261 7265 5f63 6c61  mbda x: rare_cla
-0007c1f0: 7373 2069 6620 783d 3d72 6172 655f 636c  ss if x==rare_cl
-0007c200: 6173 7320 656c 7365 206d 616a 6f72 6974  ass else majorit
-0007c210: 795f 636c 6173 7329 0d0a 2020 2020 2020  y_class)..      
-0007c220: 2020 2020 2020 6966 2073 636f 7269 6e67        if scoring
-0007c230: 203d 3d20 2727 3a0d 0a20 2020 2020 2020   == '':..       
-0007c240: 2020 2020 2020 2020 2073 636f 7269 6e67           scoring
-0007c250: 203d 2027 6163 6375 7261 6379 270d 0a20   = 'accuracy'.. 
-0007c260: 2020 2020 2020 2020 2020 2073 6376 203d             scv =
-0007c270: 2053 7472 6174 6966 6965 644b 466f 6c64   StratifiedKFold
-0007c280: 286e 5f73 706c 6974 733d 464f 4c44 532c  (n_splits=FOLDS,
-0007c290: 2072 616e 646f 6d5f 7374 6174 653d 7365   random_state=se
-0007c2a0: 6564 2c20 7368 7566 666c 653d 5472 7565  ed, shuffle=True
-0007c2b0: 290d 0a20 2020 2020 2020 2020 2020 2069  )..            i
-0007c2c0: 6620 426f 6f73 7469 6e67 5f46 6c61 673a  f Boosting_Flag:
-0007c2d0: 0d0a 2020 2020 2020 2020 2020 2020 2020  ..              
-0007c2e0: 2020 2323 2323 2020 204c 696e 6561 7220    ####   Linear 
-0007c2f0: 4d6f 6465 6c73 2069 6620 426f 6f73 7469  Models if Boosti
-0007c300: 6e67 2069 7320 6368 6f73 656e 2023 2323  ng is chosen ###
-0007c310: 2323 0d0a 2020 2020 2020 2020 2020 2020  ##..            
-0007c320: 2020 2020 6d6f 6465 6c34 203d 204c 696e      model4 = Lin
-0007c330: 6561 7244 6973 6372 696d 696e 616e 7441  earDiscriminantA
-0007c340: 6e61 6c79 7369 7328 290d 0a20 2020 2020  nalysis()..     
-0007c350: 2020 2020 2020 2020 2020 2072 6573 756c             resul
-0007c360: 7473 203d 206d 6f64 656c 342e 6669 7428  ts = model4.fit(
-0007c370: 585f 7472 6169 6e2c 795f 7472 6169 6e29  X_train,y_train)
-0007c380: 2e70 7265 6469 6374 5f70 726f 6261 2858  .predict_proba(X
-0007c390: 5f74 6573 7429 0d0a 2020 2020 2020 2020  _test)..        
-0007c3a0: 2020 2020 2020 2020 6573 7469 6d61 746f          estimato
-0007c3b0: 7273 2e61 7070 656e 6428 2827 4c69 6e65  rs.append(('Line
-0007c3c0: 6172 2044 6973 6372 696d 696e 616e 7427  ar Discriminant'
-0007c3d0: 2c6d 6f64 656c 3429 290d 0a20 2020 2020  ,model4))..     
-0007c3e0: 2020 2020 2020 2020 2020 2065 7374 696d             estim
-0007c3f0: 6174 6f72 5f6c 656e 6774 682e 6170 7065  ator_length.appe
-0007c400: 6e64 2872 6573 756c 7473 2e73 6861 7065  nd(results.shape
-0007c410: 5b31 5d29 0d0a 2020 2020 2020 2020 2020  [1])..          
-0007c420: 2020 656c 6966 2042 6f6f 7374 696e 675f    elif Boosting_
-0007c430: 466c 6167 2069 7320 4e6f 6e65 3a0d 0a20  Flag is None:.. 
-0007c440: 2020 2020 2020 2020 2020 2020 2020 2023                 #
-0007c450: 2323 2320 2020 5472 6565 206d 6f64 656c  ###   Tree model
-0007c460: 7320 6966 204c 696e 6561 7220 6368 6f73  s if Linear chos
-0007c470: 656e 2023 2323 2323 0d0a 2020 2020 2020  en #####..      
-0007c480: 2020 2020 2020 2020 2020 6d6f 6465 6c36            model6
-0007c490: 203d 2044 6563 6973 696f 6e54 7265 6543   = DecisionTreeC
-0007c4a0: 6c61 7373 6966 6965 7228 6d69 6e5f 7361  lassifier(min_sa
-0007c4b0: 6d70 6c65 735f 6c65 6166 3d32 290d 0a20  mples_leaf=2).. 
-0007c4c0: 2020 2020 2020 2020 2020 2020 2020 2072                 r
-0007c4d0: 6573 756c 7473 203d 206d 6f64 656c 362e  esults = model6.
-0007c4e0: 6669 7428 585f 7472 6169 6e2c 795f 7472  fit(X_train,y_tr
-0007c4f0: 6169 6e29 2e70 7265 6469 6374 5f70 726f  ain).predict_pro
-0007c500: 6261 2858 5f74 6573 7429 0d0a 2020 2020  ba(X_test)..    
-0007c510: 2020 2020 2020 2020 2020 2020 6573 7469              esti
-0007c520: 6d61 746f 7273 2e61 7070 656e 6428 2827  mators.append(('
-0007c530: 4465 6369 7369 6f6e 2054 7265 6527 2c6d  Decision Tree',m
-0007c540: 6f64 656c 3629 290d 0a20 2020 2020 2020  odel6))..       
-0007c550: 2020 2020 2020 2020 2065 7374 696d 6174           estimat
-0007c560: 6f72 5f6c 656e 6774 682e 6170 7065 6e64  or_length.append
-0007c570: 2872 6573 756c 7473 2e73 6861 7065 5b31  (results.shape[1
-0007c580: 5d29 0d0a 2020 2020 2020 2020 2020 2020  ])..            
-0007c590: 656c 7365 3a0d 0a20 2020 2020 2020 2020  else:..         
-0007c5a0: 2020 2020 2020 2023 2323 2323 2320 2020         ######   
-0007c5b0: 204e 6169 7665 2042 6179 6573 206d 6f64   Naive Bayes mod
-0007c5c0: 656c 7320 6966 2042 6167 6769 6e67 2069  els if Bagging i
-0007c5d0: 7320 6368 6f73 656e 2023 2323 230d 0a20  s chosen ####.. 
-0007c5e0: 2020 2020 2020 2020 2020 2020 2020 2069                 i
-0007c5f0: 6620 6e5f 636c 6173 7365 7320 3c3d 2032  f n_classes <= 2
-0007c600: 3a0d 0a20 2020 2020 2020 2020 2020 2020  :..             
-0007c610: 2020 2020 2020 2074 7279 3a0d 0a20 2020         try:..   
-0007c620: 2020 2020 2020 2020 2020 2020 2020 2020                  
-0007c630: 2020 2020 206d 6f64 656c 3720 3d20 4761       model7 = Ga
-0007c640: 7573 7369 616e 4e42 2829 0d0a 2020 2020  ussianNB()..    
-0007c650: 2020 2020 2020 2020 2020 2020 2020 2020                  
-0007c660: 6578 6365 7074 3a0d 0a20 2020 2020 2020  except:..       
-0007c670: 2020 2020 2020 2020 2020 2020 2020 2020                  
-0007c680: 206d 6f64 656c 3720 3d20 4465 6369 7369   model7 = Decisi
-0007c690: 6f6e 5472 6565 436c 6173 7369 6669 6572  onTreeClassifier
-0007c6a0: 286d 696e 5f73 616d 706c 6573 5f6c 6561  (min_samples_lea
-0007c6b0: 663d 3229 0d0a 2020 2020 2020 2020 2020  f=2)..          
-0007c6c0: 2020 2020 2020 656c 7365 3a0d 0a20 2020        else:..   
-0007c6d0: 2020 2020 2020 2020 2020 2020 2020 2020                  
-0007c6e0: 2074 7279 3a0d 0a20 2020 2020 2020 2020   try:..         
-0007c6f0: 2020 2020 2020 2020 2020 2020 2020 206d                 m
-0007c700: 6f64 656c 3720 3d20 4d75 6c74 696e 6f6d  odel7 = Multinom
-0007c710: 6961 6c4e 4228 290d 0a20 2020 2020 2020  ialNB()..       
-0007c720: 2020 2020 2020 2020 2020 2020 2065 7863               exc
-0007c730: 6570 743a 0d0a 2020 2020 2020 2020 2020  ept:..          
-0007c740: 2020 2020 2020 2020 2020 2020 2020 6d6f                mo
-0007c750: 6465 6c37 203d 2044 6563 6973 696f 6e54  del7 = DecisionT
-0007c760: 7265 6543 6c61 7373 6966 6965 7228 6d69  reeClassifier(mi
-0007c770: 6e5f 7361 6d70 6c65 735f 6c65 6166 3d32  n_samples_leaf=2
-0007c780: 290d 0a20 2020 2020 2020 2020 2020 2020  )..             
-0007c790: 2020 2072 6573 756c 7473 203d 206d 6f64     results = mod
-0007c7a0: 656c 372e 6669 7428 585f 7472 6169 6e2c  el7.fit(X_train,
-0007c7b0: 795f 7472 6169 6e29 2e70 7265 6469 6374  y_train).predict
-0007c7c0: 5f70 726f 6261 2858 5f74 6573 7429 0d0a  _proba(X_test)..
-0007c7d0: 2020 2020 2020 2020 2020 2020 2020 2020                  
-0007c7e0: 6573 7469 6d61 746f 7273 2e61 7070 656e  estimators.appen
-0007c7f0: 6428 2827 4e61 6976 6520 4261 7965 7327  d(('Naive Bayes'
-0007c800: 2c6d 6f64 656c 3729 290d 0a20 2020 2020  ,model7))..     
-0007c810: 2020 2020 2020 2020 2020 2065 7374 696d             estim
-0007c820: 6174 6f72 5f6c 656e 6774 682e 6170 7065  ator_length.appe
-0007c830: 6e64 2872 6573 756c 7473 2e73 6861 7065  nd(results.shape
-0007c840: 5b31 5d29 0d0a 2020 2020 2373 7461 636b  [1])..    #stack
-0007c850: 7320 3d20 6e70 2e63 5f5b 7265 7375 6c74  s = np.c_[result
-0007c860: 7331 2c72 6573 756c 7473 322c 7265 7375  s1,results2,resu
-0007c870: 6c74 7333 5d0d 0a20 2020 2065 7374 696d  lts3]..    estim
-0007c880: 6174 6f72 735f 6c69 7374 203d 205b 2874  ators_list = [(t
-0007c890: 7570 6c65 735b 305d 2c74 7570 6c65 735b  uples[0],tuples[
-0007c8a0: 315d 2920 666f 7220 7475 706c 6573 2069  1]) for tuples i
-0007c8b0: 6e20 6573 7469 6d61 746f 7273 5d0d 0a20  n estimators].. 
-0007c8c0: 2020 2065 7374 696d 6174 6f72 5f6e 616d     estimator_nam
-0007c8d0: 6573 203d 205b 7475 706c 6573 5b30 5d20  es = [tuples[0] 
-0007c8e0: 666f 7220 7475 706c 6573 2069 6e20 6573  for tuples in es
-0007c8f0: 7469 6d61 746f 7273 5d0d 0a20 2020 2023  timators]..    #
-0007c900: 2323 2320 4865 7265 2069 7320 7768 6572  ### Here is wher
-0007c910: 6520 7765 2063 6f6e 736f 6c69 6461 7465  e we consolidate
-0007c920: 2074 6865 2065 7374 696d 6174 6f72 206e   the estimator n
-0007c930: 616d 6573 2061 6e64 2074 6865 6972 2072  ames and their r
-0007c940: 6573 756c 7473 2069 6e74 6f20 6f6e 6520  esults into one 
-0007c950: 636f 6d6d 6f6e 206c 6973 7420 2323 230d  common list ###.
-0007c960: 0a20 2020 206c 7320 3d20 5b5d 0d0a 2020  .    ls = []..  
-0007c970: 2020 666f 7220 782c 7920 696e 2064 6963    for x,y in dic
-0007c980: 7428 7a69 7028 6573 7469 6d61 746f 725f  t(zip(estimator_
-0007c990: 6e61 6d65 732c 6573 7469 6d61 746f 725f  names,estimator_
-0007c9a0: 6c65 6e67 7468 2929 2e69 7465 6d73 2829  length)).items()
-0007c9b0: 3a0d 0a20 2020 2020 2020 2065 6c73 203d  :..        els =
-0007c9c0: 205b 782b 275f 272b 7374 7228 6561 6368   [x+'_'+str(each
-0007c9d0: 7929 2066 6f72 2065 6163 6879 2069 6e20  y) for eachy in 
-0007c9e0: 7261 6e67 6528 7929 5d0d 0a20 2020 2020  range(y)]..     
-0007c9f0: 2020 206c 7320 2b3d 2065 6c73 0d0a 2020     ls += els..  
-0007ca00: 2020 6966 2076 6572 626f 7365 203d 3d20    if verbose == 
-0007ca10: 313a 0d0a 2020 2020 2020 2020 7072 696e  1:..        prin
-0007ca20: 7428 2720 2020 2054 696d 6520 7461 6b65  t('    Time take
-0007ca30: 6e20 666f 7220 5374 6163 6b69 6e67 3a20  n for Stacking: 
-0007ca40: 2530 2e31 6620 7365 636f 6e64 7327 2025  %0.1f seconds' %
-0007ca50: 2874 696d 652e 7469 6d65 2829 2d73 7461  (time.time()-sta
-0007ca60: 7274 5f74 696d 6529 290d 0a20 2020 2072  rt_time))..    r
-0007ca70: 6574 7572 6e20 6c73 2c20 7265 7375 6c74  eturn ls, result
-0007ca80: 730d 0a23 2323 2323 2323 2323 2323 2323  s..#############
-0007ca90: 2323 2323 2323 2323 2323 2323 2323 2323  ################
-0007caa0: 2323 2323 2323 2323 2323 2323 2323 2323  ################
-0007cab0: 2323 2323 2323 2323 2323 2323 0d0a 0000  ############....
-0007cac0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-0007cad0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-0007cae0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-0007caf0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-0007cb00: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-0007cb10: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-0007cb20: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-0007cb30: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-0007cb40: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-0007cb50: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-0007cb60: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-0007cb70: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-0007cb80: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-0007cb90: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-0007cba0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-0007cbb0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-0007cbc0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-0007cbd0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-0007cbe0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-0007cbf0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-0007cc00: 2e2f 2e2f 4050 6178 4865 6164 6572 0000  ././@PaxHeader..
-0007cc10: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-0007cc20: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-0007cc30: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-0007cc40: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-0007cc50: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-0007cc60: 0000 0000 3030 3030 3030 3000 3030 3030  ....0000000.0000
-0007cc70: 3030 3000 3030 3030 3030 3000 3030 3030  000.0000000.0000
-0007cc80: 3030 3030 3032 3600 3030 3030 3030 3030  0000026.00000000
-0007cc90: 3030 3000 3031 3134 3533 0020 7800 0000  000.011453. x...
-0007cca0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-0007ccb0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-0007ccc0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-0007ccd0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-0007cce0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-0007ccf0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-0007cd00: 0075 7374 6172 0030 3000 0000 0000 0000  .ustar.00.......
-0007cd10: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-0007cd20: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-0007cd30: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-0007cd40: 0000 0000 0000 0000 0030 3030 3030 3030  .........0000000
-0007cd50: 0030 3030 3030 3030 0000 0000 0000 0000  .0000000........
-0007cd60: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-0007cd70: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-0007cd80: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-0007cd90: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-0007cda0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-0007cdb0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-0007cdc0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-0007cdd0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-0007cde0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-0007cdf0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-0007ce00: 3232 206d 7469 6d65 3d31 3637 3831 3539  22 mtime=1678159
-0007ce10: 3732 322e 300a 0000 0000 0000 0000 0000  722.0...........
-0007ce20: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-0007ce30: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-0007ce40: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-0007ce50: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-0007ce60: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-0007ce70: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-0007ce80: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-0007ce90: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-0007cea0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-0007ceb0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-0007cec0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-0007ced0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-0007cee0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-0007cef0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-0007cf00: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-0007cf10: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-0007cf20: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-0007cf30: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-0007cf40: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-0007cf50: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-0007cf60: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-0007cf70: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-0007cf80: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-0007cf90: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-0007cfa0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-0007cfb0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-0007cfc0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-0007cfd0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-0007cfe0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-0007cff0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-0007d000: 6175 746f 7669 6d6c 2d30 2e31 2e37 3134  autoviml-0.1.714
-0007d010: 2f61 7574 6f76 696d 6c2f 5472 616e 7366  /autoviml/Transf
-0007d020: 6f72 6d5f 4b4d 5f46 6561 7475 7265 732e  orm_KM_Features.
-0007d030: 7079 0000 0000 0000 0000 0000 0000 0000  py..............
-0007d040: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-0007d050: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-0007d060: 0000 0000 3030 3030 3737 3700 3030 3031  ....0000777.0001
-0007d070: 3735 3000 3030 3031 3735 3000 3030 3030  750.0001750.0000
-0007d080: 3030 3135 3332 3300 3030 3030 3030 3030  0015323.00000000
-0007d090: 3030 3000 3032 3135 3332 0020 3000 0000  000.021532. 0...
-0007d0a0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-0007d0b0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-0007d0c0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-0007d0d0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-0007d0e0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-0007d0f0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-0007d100: 0075 7374 6172 0030 3072 616d 0000 0000  .ustar.00ram....
-0007d110: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-0007d120: 0000 0000 0000 0000 0072 616d 0000 0000  .........ram....
-0007d130: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-0007d140: 0000 0000 0000 0000 0030 3030 3030 3030  .........0000000
-0007d150: 0030 3030 3030 3030 0000 0000 0000 0000  .0000000........
-0007d160: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-0007d170: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-0007d180: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-0007d190: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-0007d1a0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-0007d1b0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-0007d1c0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-0007d1d0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-0007d1e0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-0007d1f0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-0007d200: 696d 706f 7274 206e 756d 7079 2061 7320  import numpy as 
-0007d210: 6e70 0d0a 696d 706f 7274 2070 616e 6461  np..import panda
-0007d220: 7320 6173 2070 640d 0a66 726f 6d20 736b  s as pd..from sk
-0007d230: 6c65 6172 6e2e 636c 7573 7465 7220 696d  learn.cluster im
-0007d240: 706f 7274 204b 4d65 616e 730d 0a69 6d70  port KMeans..imp
-0007d250: 6f72 7420 736b 6c65 6172 6e0d 0a69 6d70  ort sklearn..imp
-0007d260: 6f72 7420 7363 6970 790d 0a0d 0a63 6c61  ort scipy....cla
-0007d270: 7373 204b 4d65 616e 7346 6561 7475 7269  ss KMeansFeaturi
-0007d280: 7a65 723a 0d0a 2020 2020 2222 2254 7261  zer:..    """Tra
-0007d290: 6e73 666f 726d 7320 6e75 6d65 7269 6320  nsforms numeric 
-0007d2a0: 6461 7461 2069 6e74 6f20 6b2d 6d65 616e  data into k-mean
-0007d2b0: 7320 636c 7573 7465 7220 6d65 6d62 6572  s cluster member
-0007d2c0: 7368 6970 732e 0d0a 2020 2020 4672 6f6d  ships...    From
-0007d2d0: 2074 6865 2046 6561 7475 7265 2045 6e67   the Feature Eng
-0007d2e0: 696e 6565 7269 6e67 2042 6f6f 6b20 6279  ineering Book by
-0007d2f0: 2041 6c69 6365 205a 6865 6e67 0d0a 2020   Alice Zheng..  
-0007d300: 2020 6874 7470 733a 2f2f 6769 7468 7562    https://github
-0007d310: 2e63 6f6d 2f61 6c69 6365 7a68 656e 672f  .com/alicezheng/
-0007d320: 6665 6174 7572 652d 656e 6769 6e65 6572  feature-engineer
-0007d330: 696e 672d 626f 6f6b 2f62 6c6f 622f 6d61  ing-book/blob/ma
-0007d340: 7374 6572 2f6b 6d65 616e 735f 6665 6174  ster/kmeans_feat
-0007d350: 7572 697a 6572 2e70 790d 0a20 2020 2054  urizer.py..    T
-0007d360: 6869 7320 7472 616e 7366 6f72 6d65 7220  his transformer 
-0007d370: 7275 6e73 206b 2d6d 6561 6e73 206f 6e20  runs k-means on 
-0007d380: 7468 6520 696e 7075 7420 6461 7461 2061  the input data a
-0007d390: 6e64 2063 6f6e 7665 7274 7320 6561 6368  nd converts each
-0007d3a0: 2064 6174 6120 706f 696e 740d 0a20 2020   data point..   
-0007d3b0: 2069 6e74 6f20 7468 6520 6964 206f 6620   into the id of 
-0007d3c0: 7468 6520 636c 6f73 6573 7420 636c 7573  the closest clus
-0007d3d0: 7465 722e 2049 6620 6120 7461 7267 6574  ter. If a target
-0007d3e0: 2076 6172 6961 626c 6520 6973 2070 7265   variable is pre
-0007d3f0: 7365 6e74 2c20 6974 2069 730d 0a20 2020  sent, it is..   
-0007d400: 2073 6361 6c65 6420 616e 6420 696e 636c   scaled and incl
-0007d410: 7564 6564 2061 7320 696e 7075 7420 746f  uded as input to
-0007d420: 206b 2d6d 6561 6e73 2069 6e20 6f72 6465   k-means in orde
-0007d430: 7220 746f 2064 6572 6976 6520 636c 7573  r to derive clus
-0007d440: 7465 7273 2074 6861 740d 0a20 2020 206f  ters that..    o
-0007d450: 6265 7920 7468 6520 636c 6173 7369 6669  bey the classifi
-0007d460: 6361 7469 6f6e 2062 6f75 6e64 6172 7920  cation boundary 
-0007d470: 6173 2077 656c 6c20 6173 2067 726f 7570  as well as group
-0007d480: 2073 696d 696c 6172 2070 6f69 6e74 7320   similar points 
-0007d490: 746f 6765 7468 6572 2e0d 0a20 2020 2050  together...    P
-0007d4a0: 6172 616d 6574 6572 730d 0a20 2020 202d  arameters..    -
-0007d4b0: 2d2d 2d2d 2d2d 2d2d 2d0d 0a20 2020 206b  ---------..    k
-0007d4c0: 3a20 696e 7465 6765 722c 206f 7074 696f  : integer, optio
-0007d4d0: 6e61 6c2c 2064 6566 6175 6c74 2031 3030  nal, default 100
-0007d4e0: 0d0a 2020 2020 2020 2020 5468 6520 6e75  ..        The nu
-0007d4f0: 6d62 6572 206f 6620 636c 7573 7465 7273  mber of clusters
-0007d500: 2074 6f20 6772 6f75 7020 6461 7461 2069   to group data i
-0007d510: 6e74 6f2e 0d0a 2020 2020 7461 7267 6574  nto...    target
-0007d520: 5f73 6361 6c65 3a20 666c 6f61 742c 205b  _scale: float, [
-0007d530: 302c 2069 6e66 7479 5d2c 206f 7074 696f  0, infty], optio
-0007d540: 6e61 6c2c 2064 6566 6175 6c74 2035 2e30  nal, default 5.0
-0007d550: 0d0a 2020 2020 2020 2020 5468 6520 7363  ..        The sc
-0007d560: 616c 696e 6720 6661 6374 6f72 2066 6f72  aling factor for
-0007d570: 2074 6865 2074 6172 6765 7420 7661 7269   the target vari
-0007d580: 6162 6c65 2e20 5365 7420 7468 6973 2074  able. Set this t
-0007d590: 6f20 7a65 726f 2074 6f20 6967 6e6f 7265  o zero to ignore
-0007d5a0: 0d0a 2020 2020 2020 2020 7468 6520 7461  ..        the ta
-0007d5b0: 7267 6574 2e20 466f 7220 636c 6173 7369  rget. For classi
-0007d5c0: 6669 6361 7469 6f6e 2070 726f 626c 656d  fication problem
-0007d5d0: 732c 206c 6172 6765 7220 6074 6172 6765  s, larger `targe
-0007d5e0: 745f 7363 616c 6560 2076 616c 7565 730d  t_scale` values.
-0007d5f0: 0a20 2020 2020 2020 2077 696c 6c20 7072  .        will pr
-0007d600: 6f64 7563 6520 636c 7573 7465 7273 2074  oduce clusters t
-0007d610: 6861 7420 6265 7474 6572 2072 6573 7065  hat better respe
-0007d620: 6374 2074 6865 2063 6c61 7373 2062 6f75  ct the class bou
-0007d630: 6e64 6172 792e 0d0a 2020 2020 7261 6e64  ndary...    rand
-0007d640: 6f6d 5f73 7461 7465 203a 2069 6e74 6567  om_state : integ
-0007d650: 6572 206f 7220 6e75 6d70 792e 5261 6e64  er or numpy.Rand
-0007d660: 6f6d 5374 6174 652c 206f 7074 696f 6e61  omState, optiona
-0007d670: 6c0d 0a20 2020 2020 2020 2054 6869 7320  l..        This 
-0007d680: 6973 2070 6173 7365 6420 746f 206b 2d6d  is passed to k-m
-0007d690: 6561 6e73 2061 7320 7468 6520 6765 6e65  eans as the gene
-0007d6a0: 7261 746f 7220 7573 6564 2074 6f20 696e  rator used to in
-0007d6b0: 6974 6961 6c69 7a65 2074 6865 0d0a 2020  itialize the..  
-0007d6c0: 2020 2020 2020 6b6d 6561 6e73 2063 656e        kmeans cen
-0007d6d0: 7465 7273 2e20 4966 2061 6e20 696e 7465  ters. If an inte
-0007d6e0: 6765 7220 6973 2067 6976 656e 2c20 6974  ger is given, it
-0007d6f0: 2066 6978 6573 2074 6865 2073 6565 642e   fixes the seed.
-0007d700: 2044 6566 6175 6c74 7320 746f 0d0a 2020   Defaults to..  
-0007d710: 2020 2020 2020 7468 6520 676c 6f62 616c        the global
-0007d720: 206e 756d 7079 2072 616e 646f 6d20 6e75   numpy random nu
-0007d730: 6d62 6572 2067 656e 6572 6174 6f72 2e0d  mber generator..
-0007d740: 0a20 2020 2041 7474 7269 6275 7465 730d  .    Attributes.
-0007d750: 0a20 2020 202d 2d2d 2d2d 2d2d 2d2d 2d0d  .    ----------.
-0007d760: 0a20 2020 2063 6c75 7374 6572 5f63 656e  .    cluster_cen
-0007d770: 7465 7273 5f20 3a20 6172 7261 792c 205b  ters_ : array, [
-0007d780: 6b2c 206e 5f66 6561 7475 7265 735d 0d0a  k, n_features]..
-0007d790: 2020 2020 2020 2020 436f 6f72 6469 6e61          Coordina
-0007d7a0: 7465 7320 6f66 2063 6c75 7374 6572 2063  tes of cluster c
-0007d7b0: 656e 7465 7273 2e20 6e5f 6665 6174 7572  enters. n_featur
-0007d7c0: 6573 2064 6f65 7320 636f 756e 7420 7468  es does count th
-0007d7d0: 6520 7461 7267 6574 2063 6f6c 756d 6e2e  e target column.
-0007d7e0: 0d0a 2020 2020 2222 220d 0a0d 0a20 2020  ..    """....   
-0007d7f0: 2064 6566 205f 5f69 6e69 745f 5f28 7365   def __init__(se
-0007d800: 6c66 2c20 6b3d 3130 302c 2074 6172 6765  lf, k=100, targe
-0007d810: 745f 7363 616c 653d 352e 302c 2072 616e  t_scale=5.0, ran
-0007d820: 646f 6d5f 7374 6174 653d 4e6f 6e65 293a  dom_state=None):
-0007d830: 0d0a 2020 2020 2020 2020 7365 6c66 2e6b  ..        self.k
-0007d840: 203d 206b 0d0a 2020 2020 2020 2020 7365   = k..        se
-0007d850: 6c66 2e74 6172 6765 745f 7363 616c 6520  lf.target_scale 
-0007d860: 3d20 7461 7267 6574 5f73 6361 6c65 0d0a  = target_scale..
-0007d870: 2020 2020 2020 2020 7365 6c66 2e72 616e          self.ran
-0007d880: 646f 6d5f 7374 6174 6520 3d20 7261 6e64  dom_state = rand
-0007d890: 6f6d 5f73 7461 7465 0d0a 0d0a 2020 2020  om_state....    
-0007d8a0: 6465 6620 6669 7428 7365 6c66 2c20 582c  def fit(self, X,
-0007d8b0: 2079 3d4e 6f6e 6529 3a0d 0a20 2020 2020   y=None):..     
-0007d8c0: 2020 2022 2222 5275 6e73 206b 2d6d 6561     """Runs k-mea
-0007d8d0: 6e73 206f 6e20 7468 6520 696e 7075 7420  ns on the input 
-0007d8e0: 6461 7461 2061 6e64 2066 696e 6420 6365  data and find ce
-0007d8f0: 6e74 726f 6964 732e 0d0a 2020 2020 2020  ntroids...      
-0007d900: 2020 4966 206e 6f20 7461 7267 6574 2069    If no target i
-0007d910: 7320 6769 7665 6e20 2860 7960 2069 7320  s given (`y` is 
-0007d920: 4e6f 6e65 2920 7468 656e 2072 756e 2076  None) then run v
-0007d930: 616e 696c 6c61 206b 2d6d 6561 6e73 206f  anilla k-means o
-0007d940: 6e20 696e 7075 740d 0a20 2020 2020 2020  n input..       
-0007d950: 2060 5860 2e0d 0a20 2020 2020 2020 2049   `X`...        I
-0007d960: 6620 7461 7267 6574 2060 7960 2069 7320  f target `y` is 
-0007d970: 6769 7665 6e2c 2074 6865 6e20 696e 636c  given, then incl
-0007d980: 7564 6520 7468 6520 7461 7267 6574 2028  ude the target (
-0007d990: 7765 6967 6874 6564 2062 790d 0a20 2020  weighted by..   
-0007d9a0: 2020 2020 2060 7461 7267 6574 5f73 6361       `target_sca
-0007d9b0: 6c65 6029 2061 7320 616e 2065 7874 7261  le`) as an extra
-0007d9c0: 2064 696d 656e 7369 6f6e 2066 6f72 206b   dimension for k
-0007d9d0: 2d6d 6561 6e73 2063 6c75 7374 6572 696e  -means clusterin
-0007d9e0: 672e 2049 6e20 7468 6973 0d0a 2020 2020  g. In this..    
-0007d9f0: 2020 2020 6361 7365 2c20 7275 6e20 6b2d      case, run k-
-0007da00: 6d65 616e 7320 7477 6963 652c 2066 6972  means twice, fir
-0007da10: 7374 2077 6974 6820 7468 6520 7461 7267  st with the targ
-0007da20: 6574 2c20 7468 656e 2061 6e20 6578 7472  et, then an extr
-0007da30: 6120 6974 6572 6174 696f 6e0d 0a20 2020  a iteration..   
-0007da40: 2020 2020 2077 6974 686f 7574 2e0d 0a20       without... 
-0007da50: 2020 2020 2020 2041 6674 6572 2066 6974         After fit
-0007da60: 7469 6e67 2c20 7468 6520 6174 7472 6962  ting, the attrib
-0007da70: 7574 6520 6063 6c75 7374 6572 5f63 656e  ute `cluster_cen
-0007da80: 7465 7273 5f60 2061 7265 2073 6574 2074  ters_` are set t
-0007da90: 6f20 7468 6520 6b2d 6d65 616e 730d 0a20  o the k-means.. 
-0007daa0: 2020 2020 2020 2063 656e 7472 6f69 6473         centroids
-0007dab0: 2069 6e20 7468 6520 696e 7075 7420 7370   in the input sp
-0007dac0: 6163 6520 7265 7072 6573 656e 7465 6420  ace represented 
-0007dad0: 6279 2060 5860 2e0d 0a20 2020 2020 2020  by `X`...       
-0007dae0: 2050 6172 616d 6574 6572 730d 0a20 2020   Parameters..   
-0007daf0: 2020 2020 202d 2d2d 2d2d 2d2d 2d2d 2d0d       ----------.
-0007db00: 0a20 2020 2020 2020 2058 203a 2061 7272  .        X : arr
-0007db10: 6179 2d6c 696b 6520 6f72 2073 7061 7273  ay-like or spars
-0007db20: 6520 6d61 7472 6978 2c20 7368 6170 653d  e matrix, shape=
-0007db30: 286e 5f64 6174 615f 706f 696e 7473 2c20  (n_data_points, 
-0007db40: 6e5f 6665 6174 7572 6573 290d 0a20 2020  n_features)..   
-0007db50: 2020 2020 2079 203a 2076 6563 746f 7220       y : vector 
-0007db60: 6f66 206c 656e 6774 6820 6e5f 6461 7461  of length n_data
-0007db70: 5f70 6f69 6e74 732c 206f 7074 696f 6e61  _points, optiona
-0007db80: 6c2c 2064 6566 6175 6c74 204e 6f6e 650d  l, default None.
-0007db90: 0a20 2020 2020 2020 2020 2020 2049 6620  .            If 
-0007dba0: 7072 6f76 6964 6564 2c20 7769 6c6c 2062  provided, will b
-0007dbb0: 6520 7765 6967 6874 6564 2077 6974 6820  e weighted with 
-0007dbc0: 6074 6172 6765 745f 7363 616c 6560 2061  `target_scale` a
-0007dbd0: 6e64 2069 6e63 6c75 6465 6420 696e 0d0a  nd included in..
-0007dbe0: 2020 2020 2020 2020 2020 2020 6b2d 6d65              k-me
-0007dbf0: 616e 7320 636c 7573 7465 7269 6e67 2061  ans clustering a
-0007dc00: 7320 6869 6e74 2e0d 0a20 2020 2020 2020  s hint...       
-0007dc10: 2022 2222 0d0a 2020 2020 2020 2020 6e5f   """..        n_
-0007dc20: 6665 6174 7572 6573 203d 2058 2e73 6861  features = X.sha
-0007dc30: 7065 5b31 5d0d 0a20 2020 2020 2020 2069  pe[1]..        i
-0007dc40: 6620 7920 6973 204e 6f6e 653a 0d0a 2020  f y is None:..  
-0007dc50: 2020 2020 2020 2020 2020 2320 4e6f 2074            # No t
-0007dc60: 6172 6765 7420 7661 7269 6162 6c65 2c20  arget variable, 
-0007dc70: 6a75 7374 2064 6f20 706c 6169 6e20 6b2d  just do plain k-
-0007dc80: 6d65 616e 730d 0a20 2020 2020 2020 2020  means..         
-0007dc90: 2020 206b 6d5f 6d6f 6465 6c20 3d20 4b4d     km_model = KM
-0007dca0: 6561 6e73 286e 5f63 6c75 7374 6572 733d  eans(n_clusters=
-0007dcb0: 7365 6c66 2e6b 2c0d 0a20 2020 2020 2020  self.k,..       
-0007dcc0: 2020 2020 2020 2020 2020 2020 2020 2020                  
-0007dcd0: 2020 2020 2020 2020 2020 206e 5f69 6e69             n_ini
-0007dce0: 743d 3230 2c0d 0a20 2020 2020 2020 2020  t=20,..         
-0007dcf0: 2020 2020 2020 2020 2020 2020 2020 2020                  
-0007dd00: 2020 2020 2020 2020 2072 616e 646f 6d5f           random_
-0007dd10: 7374 6174 653d 7365 6c66 2e72 616e 646f  state=self.rando
-0007dd20: 6d5f 7374 6174 6529 0d0a 2020 2020 2020  m_state)..      
-0007dd30: 2020 2020 2020 6b6d 5f6d 6f64 656c 2e66        km_model.f
-0007dd40: 6974 2858 290d 0a0d 0a20 2020 2020 2020  it(X)....       
-0007dd50: 2020 2020 2073 656c 662e 6b6d 5f6d 6f64       self.km_mod
-0007dd60: 656c 5f20 3d20 6b6d 5f6d 6f64 656c 0d0a  el_ = km_model..
-0007dd70: 2020 2020 2020 2020 2020 2020 7365 6c66              self
-0007dd80: 2e63 6c75 7374 6572 5f63 656e 7465 7273  .cluster_centers
-0007dd90: 5f20 3d20 6b6d 5f6d 6f64 656c 2e63 6c75  _ = km_model.clu
-0007dda0: 7374 6572 5f63 656e 7465 7273 5f0d 0a20  ster_centers_.. 
-0007ddb0: 2020 2020 2020 2020 2020 2072 6574 7572             retur
-0007ddc0: 6e20 7365 6c66 0d0a 0d0a 2020 2020 2020  n self....      
-0007ddd0: 2020 2320 5468 6572 6520 6973 2074 6172    # There is tar
-0007dde0: 6765 7420 696e 666f 726d 6174 696f 6e2e  get information.
-0007ddf0: 2041 7070 6c79 2061 7070 726f 7072 6961   Apply appropria
-0007de00: 7465 2073 6361 6c69 6e67 2061 6e64 2069  te scaling and i
-0007de10: 6e63 6c75 6465 0d0a 2020 2020 2020 2020  nclude..        
-0007de20: 2320 696e 746f 2069 6e70 7574 2064 6174  # into input dat
-0007de30: 6120 746f 206b 2d6d 6561 6e73 0d0a 2020  a to k-means..  
-0007de40: 2020 2020 2020 6461 7461 5f77 6974 685f        data_with_
-0007de50: 7461 7267 6574 203d 206e 702e 6873 7461  target = np.hsta
-0007de60: 636b 2828 582c 2079 5b3a 2c6e 702e 6e65  ck((X, y[:,np.ne
-0007de70: 7761 7869 735d 2a73 656c 662e 7461 7267  waxis]*self.targ
-0007de80: 6574 5f73 6361 6c65 2929 0d0a 0d0a 2020  et_scale))....  
-0007de90: 2020 2020 2020 2320 4275 696c 6420 6120        # Build a 
-0007dea0: 7072 652d 7472 6169 6e69 6e67 206b 2d6d  pre-training k-m
-0007deb0: 6561 6e73 206d 6f64 656c 206f 6e20 6461  eans model on da
-0007dec0: 7461 2061 6e64 2074 6172 6765 740d 0a20  ta and target.. 
-0007ded0: 2020 2020 2020 206b 6d5f 6d6f 6465 6c5f         km_model_
-0007dee0: 7072 6574 7261 696e 203d 204b 4d65 616e  pretrain = KMean
-0007def0: 7328 6e5f 636c 7573 7465 7273 3d73 656c  s(n_clusters=sel
-0007df00: 662e 6b2c 0d0a 2020 2020 2020 2020 2020  f.k,..          
-0007df10: 2020 2020 2020 2020 2020 2020 2020 2020                  
-0007df20: 2020 2020 2020 2020 206e 5f69 6e69 743d           n_init=
-0007df30: 3230 2c0d 0a20 2020 2020 2020 2020 2020  20,..           
-0007df40: 2020 2020 2020 2020 2020 2020 2020 2020                  
-0007df50: 2020 2020 2020 2020 7261 6e64 6f6d 5f73          random_s
-0007df60: 7461 7465 3d73 656c 662e 7261 6e64 6f6d  tate=self.random
-0007df70: 5f73 7461 7465 290d 0a20 2020 2020 2020  _state)..       
-0007df80: 206b 6d5f 6d6f 6465 6c5f 7072 6574 7261   km_model_pretra
-0007df90: 696e 2e66 6974 2864 6174 615f 7769 7468  in.fit(data_with
-0007dfa0: 5f74 6172 6765 7429 0d0a 0d0a 2020 2020  _target)....    
-0007dfb0: 2020 2020 2320 5275 6e20 6b2d 6d65 616e      # Run k-mean
-0007dfc0: 7320 6120 7365 636f 6e64 2074 696d 6520  s a second time 
-0007dfd0: 746f 2067 6574 2074 6865 2063 6c75 7374  to get the clust
-0007dfe0: 6572 7320 696e 2074 6865 206f 7269 6769  ers in the origi
-0007dff0: 6e61 6c20 7370 6163 650d 0a20 2020 2020  nal space..     
-0007e000: 2020 2023 2077 6974 686f 7574 2074 6172     # without tar
-0007e010: 6765 7420 696e 666f 2e20 496e 6974 6961  get info. Initia
-0007e020: 6c69 7a65 2075 7369 6e67 2063 656e 7472  lize using centr
-0007e030: 6f69 6473 2066 6f75 6e64 2069 6e20 7072  oids found in pr
-0007e040: 652d 7472 6169 6e69 6e67 2e0d 0a20 2020  e-training...   
-0007e050: 2020 2020 2023 2047 6f20 7468 726f 7567       # Go throug
-0007e060: 6820 6120 7369 6e67 6c65 2069 7465 7261  h a single itera
-0007e070: 7469 6f6e 206f 6620 636c 7573 7465 7220  tion of cluster 
-0007e080: 6173 7369 676e 6d65 6e74 2061 6e64 2063  assignment and c
-0007e090: 656e 7472 6f69 640d 0a20 2020 2020 2020  entroid..       
-0007e0a0: 2023 2072 6563 6f6d 7075 7461 7469 6f6e   # recomputation
-0007e0b0: 2e0d 0a20 2020 2020 2020 206b 6d5f 6d6f  ...        km_mo
-0007e0c0: 6465 6c20 3d20 4b4d 6561 6e73 286e 5f63  del = KMeans(n_c
-0007e0d0: 6c75 7374 6572 733d 7365 6c66 2e6b 2c0d  lusters=self.k,.
-0007e0e0: 0a20 2020 2020 2020 2020 2020 2020 2020  .               
-0007e0f0: 2020 2020 2020 2020 2020 2069 6e69 743d             init=
-0007e100: 6b6d 5f6d 6f64 656c 5f70 7265 7472 6169  km_model_pretrai
-0007e110: 6e2e 636c 7573 7465 725f 6365 6e74 6572  n.cluster_center
-0007e120: 735f 5b3a 2c3a 6e5f 6665 6174 7572 6573  s_[:,:n_features
-0007e130: 5d2c 0d0a 2020 2020 2020 2020 2020 2020  ],..            
-0007e140: 2020 2020 2020 2020 2020 2020 2020 6e5f                n_
-0007e150: 696e 6974 3d31 2c0d 0a20 2020 2020 2020  init=1,..       
-0007e160: 2020 2020 2020 2020 2020 2020 2020 2020                  
-0007e170: 2020 206d 6178 5f69 7465 723d 3129 0d0a     max_iter=1)..
-0007e180: 2020 2020 2020 2020 6b6d 5f6d 6f64 656c          km_model
-0007e190: 2e66 6974 2858 290d 0a0d 0a20 2020 2020  .fit(X)....     
-0007e1a0: 2020 2073 656c 662e 6b6d 5f6d 6f64 656c     self.km_model
-0007e1b0: 203d 206b 6d5f 6d6f 6465 6c0d 0a20 2020   = km_model..   
-0007e1c0: 2020 2020 2073 656c 662e 636c 7573 7465       self.cluste
-0007e1d0: 725f 6365 6e74 6572 735f 203d 206b 6d5f  r_centers_ = km_
-0007e1e0: 6d6f 6465 6c2e 636c 7573 7465 725f 6365  model.cluster_ce
-0007e1f0: 6e74 6572 735f 0d0a 2020 2020 2020 2020  nters_..        
-0007e200: 7265 7475 726e 2073 656c 660d 0a0d 0a20  return self.... 
-0007e210: 2020 2064 6566 2074 7261 6e73 666f 726d     def transform
-0007e220: 2873 656c 662c 2058 2c20 793d 4e6f 6e65  (self, X, y=None
-0007e230: 293a 0d0a 2020 2020 2020 2020 2222 224f  ):..        """O
-0007e240: 7574 7075 7420 7468 6520 636c 6f73 6573  utput the closes
-0007e250: 7420 636c 7573 7465 7220 6964 2066 6f72  t cluster id for
-0007e260: 2065 6163 6820 696e 7075 7420 6461 7461   each input data
-0007e270: 2070 6f69 6e74 2e0d 0a20 2020 2020 2020   point...       
-0007e280: 2050 6172 616d 6574 6572 730d 0a20 2020   Parameters..   
-0007e290: 2020 2020 202d 2d2d 2d2d 2d2d 2d2d 2d0d       ----------.
-0007e2a0: 0a20 2020 2020 2020 2058 203a 2061 7272  .        X : arr
-0007e2b0: 6179 2d6c 696b 6520 6f72 2073 7061 7273  ay-like or spars
-0007e2c0: 6520 6d61 7472 6978 2c20 7368 6170 653d  e matrix, shape=
-0007e2d0: 286e 5f64 6174 615f 706f 696e 7473 2c20  (n_data_points, 
-0007e2e0: 6e5f 6665 6174 7572 6573 290d 0a20 2020  n_features)..   
-0007e2f0: 2020 2020 2079 203a 2076 6563 746f 7220       y : vector 
-0007e300: 6f66 206c 656e 6774 6820 6e5f 6461 7461  of length n_data
-0007e310: 5f70 6f69 6e74 732c 206f 7074 696f 6e61  _points, optiona
-0007e320: 6c2c 2064 6566 6175 6c74 204e 6f6e 650d  l, default None.
-0007e330: 0a20 2020 2020 2020 2020 2020 2054 6172  .            Tar
-0007e340: 6765 7420 7665 6374 6f72 2069 7320 6967  get vector is ig
-0007e350: 6e6f 7265 6420 6576 656e 2069 6620 7072  nored even if pr
-0007e360: 6f76 6964 6564 2e0d 0a20 2020 2020 2020  ovided...       
-0007e370: 2052 6574 7572 6e73 0d0a 2020 2020 2020   Returns..      
-0007e380: 2020 2d2d 2d2d 2d2d 2d0d 0a20 2020 2020    -------..     
-0007e390: 2020 2063 6c75 7374 6572 5f69 6473 203a     cluster_ids :
-0007e3a0: 2061 7272 6179 2c20 7368 6170 655b 6e5f   array, shape[n_
-0007e3b0: 6461 7461 5f70 6f69 6e74 732c 315d 0d0a  data_points,1]..
-0007e3c0: 2020 2020 2020 2020 2222 220d 0a20 2020          """..   
-0007e3d0: 2020 2020 2063 6c75 7374 6572 7320 3d20       clusters = 
-0007e3e0: 7365 6c66 2e6b 6d5f 6d6f 6465 6c2e 7072  self.km_model.pr
-0007e3f0: 6564 6963 7428 5829 0d0a 2020 2020 2020  edict(X)..      
-0007e400: 2020 7265 7475 726e 2063 6c75 7374 6572    return cluster
-0007e410: 735b 3a2c 6e70 2e6e 6577 6178 6973 5d0d  s[:,np.newaxis].
-0007e420: 0a0d 0a20 2020 2064 6566 2066 6974 5f74  ...    def fit_t
-0007e430: 7261 6e73 666f 726d 2873 656c 662c 2058  ransform(self, X
-0007e440: 2c20 793d 4e6f 6e65 293a 0d0a 2020 2020  , y=None):..    
-0007e450: 2020 2020 2222 2252 756e 7320 6669 7420      """Runs fit 
-0007e460: 666f 6c6c 6f77 6564 2062 7920 7472 616e  followed by tran
-0007e470: 7366 6f72 6d2e 0d0a 2020 2020 2020 2020  sform...        
-0007e480: 2222 220d 0a20 2020 2020 2020 2073 656c  """..        sel
-0007e490: 662e 6669 7428 582c 2079 290d 0a20 2020  f.fit(X, y)..   
-0007e4a0: 2020 2020 2072 6574 7572 6e20 7365 6c66       return self
-0007e4b0: 2e74 7261 6e73 666f 726d 2858 2c20 7929  .transform(X, y)
-0007e4c0: 0d0a 0d0a 0d0a 6672 6f6d 2063 6f6c 6c65  ......from colle
-0007e4d0: 6374 696f 6e73 2069 6d70 6f72 7420 6465  ctions import de
-0007e4e0: 6661 756c 7464 6963 740d 0a69 6d70 6f72  faultdict..impor
-0007e4f0: 7420 6f70 6572 6174 6f72 0d0a 696d 706f  t operator..impo
-0007e500: 7274 2070 6462 0d0a 696d 706f 7274 2063  rt pdb..import c
-0007e510: 6f70 790d 0a66 726f 6d20 736b 6c65 6172  opy..from sklear
-0007e520: 6e2e 6d6f 6465 6c5f 7365 6c65 6374 696f  n.model_selectio
-0007e530: 6e20 696d 706f 7274 2074 7261 696e 5f74  n import train_t
-0007e540: 6573 745f 7370 6c69 740d 0a64 6566 2054  est_split..def T
-0007e550: 7261 6e73 666f 726d 5f4b 4d5f 4665 6174  ransform_KM_Feat
-0007e560: 7572 6573 2874 7261 696e 696e 675f 6461  ures(training_da
-0007e570: 7461 2c20 7472 6169 6e69 6e67 5f6c 6162  ta, training_lab
-0007e580: 656c 732c 2074 6573 745f 6461 7461 2c20  els, test_data, 
-0007e590: 6b6d 5f6d 6178 3d30 293a 0d0a 2020 2020  km_max=0):..    
-0007e5a0: 7365 6564 203d 2039 390d 0a20 2020 2070  seed = 99..    p
-0007e5b0: 7265 6473 203d 206c 6973 7428 7472 6169  reds = list(trai
-0007e5c0: 6e69 6e67 5f64 6174 6129 0d0a 2020 2020  ning_data)..    
-0007e5d0: 7461 7267 6574 203d 2074 7261 696e 696e  target = trainin
-0007e5e0: 675f 6c61 6265 6c73 2e6e 616d 650d 0a20  g_labels.name.. 
-0007e5f0: 2020 2074 7261 696e 5f69 6e64 6578 203d     train_index =
-0007e600: 2020 7472 6169 6e69 6e67 5f64 6174 612e    training_data.
-0007e610: 696e 6465 780d 0a20 2020 2074 6573 745f  index..    test_
-0007e620: 696e 6465 7820 3d20 2074 6573 745f 6461  index =  test_da
-0007e630: 7461 2e69 6e64 6578 0d0a 2020 2020 6966  ta.index..    if
-0007e640: 206b 6d5f 6d61 7820 3c3d 2032 3a0d 0a20   km_max <= 2:.. 
-0007e650: 2020 2020 2020 206b 5f6d 6178 203d 2032         k_max = 2
-0007e660: 0d0a 2020 2020 656c 7365 3a0d 0a20 2020  ..    else:..   
-0007e670: 2020 2020 206b 5f6d 6178 203d 2063 6f70       k_max = cop
-0007e680: 792e 6465 6570 636f 7079 286b 6d5f 6d61  y.deepcopy(km_ma
-0007e690: 7829 0d0a 2020 2020 2323 2320 4361 6c63  x)..    ### Calc
-0007e6a0: 756c 6174 6520 7468 6520 7461 7267 6574  ulate the target
-0007e6b0: 2073 6361 6c65 2068 6572 6520 3d3e 2074   scale here => t
-0007e6c0: 6865 2068 6967 6865 7220 7468 6520 6e75  he higher the nu
-0007e6d0: 6d62 6572 2074 6865 2062 6574 7465 7220  mber the better 
-0007e6e0: 666f 7220 7461 7267 6574 2061 6363 7572  for target accur
-0007e6f0: 6163 790d 0a20 2020 2074 7279 3a0d 0a20  acy..    try:.. 
-0007e700: 2020 2020 2020 2069 6620 7472 6169 6e69         if traini
-0007e710: 6e67 5f6c 6162 656c 732e 6474 7970 6520  ng_labels.dtype 
-0007e720: 696e 205b 6e70 2e66 6c6f 6174 3634 2c6e  in [np.float64,n
-0007e730: 702e 666c 6f61 7433 322c 6e70 2e66 6c6f  p.float32,np.flo
-0007e740: 6174 3136 5d3a 0d0a 2020 2020 2020 2020  at16]:..        
-0007e750: 2020 2020 7461 7267 6574 5f72 616e 6765      target_range
-0007e760: 203d 2066 6c6f 6174 2861 6273 2874 7261   = float(abs(tra
-0007e770: 696e 696e 675f 6c61 6265 6c73 2e6d 6178  ining_labels.max
-0007e780: 2829 202d 2074 7261 696e 696e 675f 6c61  () - training_la
-0007e790: 6265 6c73 2e6d 696e 2829 2929 0d0a 2020  bels.min()))..  
-0007e7a0: 2020 2020 2020 656c 6966 2074 7261 696e        elif train
-0007e7b0: 696e 675f 6c61 6265 6c73 2e64 7479 7065  ing_labels.dtype
-0007e7c0: 2069 6e20 5b6f 626a 6563 742c 626f 6f6c   in [object,bool
-0007e7d0: 5d3a 0d0a 2020 2020 2020 2020 2020 2020  ]:..            
-0007e7e0: 7461 7267 6574 5f72 616e 6765 203d 2069  target_range = i
-0007e7f0: 6e74 286c 656e 2843 6f75 6e74 6572 2874  nt(len(Counter(t
-0007e800: 7261 696e 696e 675f 6c61 6265 6c73 2929  raining_labels))
-0007e810: 202b 2033 290d 0a20 2020 2020 2020 2065   + 3)..        e
-0007e820: 6c73 653a 0d0a 2020 2020 2020 2020 2020  lse:..          
-0007e830: 2020 7461 7267 6574 5f72 616e 6765 203d    target_range =
-0007e840: 2069 6e74 2861 6273 2874 7261 696e 696e   int(abs(trainin
-0007e850: 675f 6c61 6265 6c73 2e6d 6178 2829 202d  g_labels.max() -
-0007e860: 2074 7261 696e 696e 675f 6c61 6265 6c73   training_labels
-0007e870: 2e6d 696e 2829 2929 0d0a 2020 2020 6578  .min()))..    ex
-0007e880: 6365 7074 3a0d 0a20 2020 2020 2020 2074  cept:..        t
-0007e890: 6172 6765 745f 7261 6e67 6520 3d20 352e  arget_range = 5.
-0007e8a0: 300d 0a20 2020 206b 6d66 203d 2020 4b4d  0..    kmf =  KM
-0007e8b0: 6561 6e73 4665 6174 7572 697a 6572 286b  eansFeaturizer(k
-0007e8c0: 3d6b 5f6d 6178 2c20 7461 7267 6574 5f73  =k_max, target_s
-0007e8d0: 6361 6c65 3d74 6172 6765 745f 7261 6e67  cale=target_rang
-0007e8e0: 652c 2072 616e 646f 6d5f 7374 6174 653d  e, random_state=
-0007e8f0: 7365 6564 290d 0a20 2020 206b 6d66 5f68  seed)..    kmf_h
-0007e900: 696e 7420 3d20 6b6d 662e 6669 7428 7472  int = kmf.fit(tr
-0007e910: 6169 6e69 6e67 5f64 6174 612c 2074 7261  aining_data, tra
-0007e920: 696e 696e 675f 6c61 6265 6c73 290d 0a20  ining_labels).. 
-0007e930: 2020 2023 2323 204a 7573 7420 7265 7475     ### Just retu
-0007e940: 726e 2069 7420 7769 7468 2074 6865 2063  rn it with the c
-0007e950: 6c75 7374 6572 2063 6f6c 756d 6e20 3d3e  luster column =>
-0007e960: 206e 6f20 6e65 6564 2074 6f20 7265 7475   no need to retu
-0007e970: 726e 2074 6865 2064 6174 6120 6672 616d  rn the data fram
-0007e980: 6520 2323 230d 0a20 2020 2074 7261 696e  e ###..    train
-0007e990: 696e 675f 636c 7573 7465 725f 6665 6174  ing_cluster_feat
-0007e9a0: 7572 6573 203d 206b 6d66 5f68 696e 742e  ures = kmf_hint.
-0007e9b0: 7472 616e 7366 6f72 6d28 7472 6169 6e69  transform(traini
-0007e9c0: 6e67 5f64 6174 6129 0d0a 2020 2020 7465  ng_data)..    te
-0007e9d0: 7374 5f63 6c75 7374 6572 5f66 6561 7475  st_cluster_featu
-0007e9e0: 7265 7320 3d20 6b6d 665f 6869 6e74 2e74  res = kmf_hint.t
-0007e9f0: 7261 6e73 666f 726d 2874 6573 745f 6461  ransform(test_da
-0007ea00: 7461 290d 0a20 2020 206e 7078 203d 206e  ta)..    npx = n
-0007ea10: 702e 635f 5b74 7261 696e 696e 675f 6461  p.c_[training_da
-0007ea20: 7461 2c20 7472 6169 6e69 6e67 5f6c 6162  ta, training_lab
-0007ea30: 656c 732e 7661 6c75 6573 5d0d 0a20 2020  els.values]..   
-0007ea40: 2074 7261 696e 696e 675f 7769 7468 5f63   training_with_c
-0007ea50: 6c75 7374 6572 203d 206e 702e 635f 5b6e  luster = np.c_[n
-0007ea60: 7078 2c74 7261 696e 696e 675f 636c 7573  px,training_clus
-0007ea70: 7465 725f 6665 6174 7572 6573 5d0d 0a20  ter_features].. 
-0007ea80: 2020 2074 6573 745f 7769 7468 5f63 6c75     test_with_clu
-0007ea90: 7374 6572 203d 206e 702e 635f 5b74 6573  ster = np.c_[tes
-0007eaa0: 745f 6461 7461 2c20 7465 7374 5f63 6c75  t_data, test_clu
-0007eab0: 7374 6572 5f66 6561 7475 7265 735d 0d0a  ster_features]..
-0007eac0: 2020 2020 2323 2320 5765 2061 7265 2067      ### We are g
-0007ead0: 6f69 6e67 2074 6f20 6a75 7374 2072 6574  oing to just ret
-0007eae0: 7572 6e20 7468 6520 636c 7573 7465 7220  urn the cluster 
-0007eaf0: 7661 6c75 6573 2023 2323 2323 230d 0a20  values ######.. 
-0007eb00: 2020 2074 7261 696e 5f77 6974 685f 636c     train_with_cl
-0007eb10: 7573 7465 725f 6466 203d 2074 7261 696e  uster_df = train
-0007eb20: 696e 675f 7769 7468 5f63 6c75 7374 6572  ing_with_cluster
-0007eb30: 5b3a 2c2d 315d 0d0a 2020 2020 7465 7374  [:,-1]..    test
-0007eb40: 5f77 6974 685f 636c 7573 7465 725f 6466  _with_cluster_df
-0007eb50: 203d 2074 6573 745f 7769 7468 5f63 6c75   = test_with_clu
-0007eb60: 7374 6572 5b3a 2c2d 315d 0d0a 2020 2020  ster[:,-1]..    
-0007eb70: 2374 7261 696e 5f77 6974 685f 636c 7573  #train_with_clus
-0007eb80: 7465 725f 6466 203d 2070 642e 4461 7461  ter_df = pd.Data
-0007eb90: 4672 616d 6528 7472 6169 6e69 6e67 5f77  Frame(training_w
-0007eba0: 6974 685f 636c 7573 7465 722c 696e 6465  ith_cluster,inde
-0007ebb0: 783d 7472 6169 6e5f 696e 6465 782c 0d0a  x=train_index,..
-0007ebc0: 2020 2020 2320 2020 2020 2020 2020 2020      #           
-0007ebd0: 2020 2020 2020 2020 2020 2020 2020 2020                  
-0007ebe0: 2020 2020 2020 2063 6f6c 756d 6e73 3d70         columns=p
-0007ebf0: 7265 6473 2b5b 7461 7267 6574 2c27 636c  reds+[target,'cl
-0007ec00: 7573 7465 7227 5d29 0d0a 2020 2020 2374  uster'])..    #t
-0007ec10: 6573 745f 7769 7468 5f63 6c75 7374 6572  est_with_cluster
-0007ec20: 5f64 6620 3d20 7064 2e44 6174 6146 7261  _df = pd.DataFra
-0007ec30: 6d65 2874 6573 745f 7769 7468 5f63 6c75  me(test_with_clu
-0007ec40: 7374 6572 2c69 6e64 6578 3d74 6573 745f  ster,index=test_
-0007ec50: 696e 6465 782c 0d0a 2020 2020 2320 2020  index,..    #   
-0007ec60: 2020 2020 2020 2020 2020 2020 2020 2020                  
-0007ec70: 2020 2020 2020 2020 2020 2020 2020 2063                 c
-0007ec80: 6f6c 756d 6e73 3d70 7265 6473 2b5b 2763  olumns=preds+['c
-0007ec90: 6c75 7374 6572 275d 290d 0a20 2020 2072  luster'])..    r
-0007eca0: 6574 7572 6e20 7472 6169 6e5f 7769 7468  eturn train_with
-0007ecb0: 5f63 6c75 7374 6572 5f64 662c 2074 6573  _cluster_df, tes
-0007ecc0: 745f 7769 7468 5f63 6c75 7374 6572 5f64  t_with_cluster_d
-0007ecd0: 660d 0a00 0000 0000 0000 0000 0000 0000  f...............
-0007ece0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-0007ecf0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-0007ed00: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-0007ed10: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-0007ed20: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-0007ed30: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-0007ed40: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-0007ed50: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-0007ed60: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-0007ed70: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-0007ed80: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-0007ed90: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-0007eda0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-0007edb0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-0007edc0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-0007edd0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-0007ede0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-0007edf0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-0007ee00: 2e2f 2e2f 4050 6178 4865 6164 6572 0000  ././@PaxHeader..
-0007ee10: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-0007ee20: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-0007ee30: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-0007ee40: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-0007ee50: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-0007ee60: 0000 0000 3030 3030 3030 3000 3030 3030  ....0000000.0000
-0007ee70: 3030 3000 3030 3030 3030 3000 3030 3030  000.0000000.0000
-0007ee80: 3030 3030 3032 3600 3030 3030 3030 3030  0000026.00000000
-0007ee90: 3030 3000 3031 3134 3533 0020 7800 0000  000.011453. x...
-0007eea0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-0007eeb0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-0007eec0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-0007eed0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-0007eee0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-0007eef0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-0007ef00: 0075 7374 6172 0030 3000 0000 0000 0000  .ustar.00.......
-0007ef10: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-0007ef20: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-0007ef30: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-0007ef40: 0000 0000 0000 0000 0030 3030 3030 3030  .........0000000
-0007ef50: 0030 3030 3030 3030 0000 0000 0000 0000  .0000000........
-0007ef60: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-0007ef70: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-0007ef80: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-0007ef90: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-0007efa0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-0007efb0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-0007efc0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-0007efd0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-0007efe0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-0007eff0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-0007f000: 3232 206d 7469 6d65 3d31 3637 3832 3830  22 mtime=1678280
-0007f010: 3638 392e 300a 0000 0000 0000 0000 0000  689.0...........
-0007f020: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-0007f030: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-0007f040: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-0007f050: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-0007f060: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-0007f070: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-0007f080: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-0007f090: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-0007f0a0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-0007f0b0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-0007f0c0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-0007f0d0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-0007f0e0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-0007f0f0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-0007f100: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-0007f110: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-0007f120: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-0007f130: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-0007f140: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-0007f150: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-0007f160: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-0007f170: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-0007f180: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-0007f190: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-0007f1a0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-0007f1b0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-0007f1c0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-0007f1d0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-0007f1e0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-0007f1f0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-0007f200: 6175 746f 7669 6d6c 2d30 2e31 2e37 3134  autoviml-0.1.714
-0007f210: 2f61 7574 6f76 696d 6c2f 5f5f 696e 6974  /autoviml/__init
-0007f220: 5f5f 2e70 7900 0000 0000 0000 0000 0000  __.py...........
-0007f230: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-0007f240: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-0007f250: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-0007f260: 0000 0000 3030 3030 3737 3700 3030 3031  ....0000777.0001
-0007f270: 3735 3000 3030 3031 3735 3000 3030 3030  750.0001750.0000
-0007f280: 3030 3033 3236 3400 3030 3030 3030 3030  0003264.00000000
-0007f290: 3030 3000 3031 3730 3732 0020 3000 0000  000.017072. 0...
-0007f2a0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-0007f2b0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-0007f2c0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-0007f2d0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-0007f2e0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-0007f2f0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-0007f300: 0075 7374 6172 0030 3072 616d 0000 0000  .ustar.00ram....
-0007f310: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-0007f320: 0000 0000 0000 0000 0072 616d 0000 0000  .........ram....
-0007f330: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-0007f340: 0000 0000 0000 0000 0030 3030 3030 3030  .........0000000
-0007f350: 0030 3030 3030 3030 0000 0000 0000 0000  .0000000........
-0007f360: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-0007f370: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-0007f380: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-0007f390: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-0007f3a0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-0007f3b0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-0007f3c0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-0007f3d0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-0007f3e0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-0007f3f0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-0007f400: 2320 2d2a 2d20 636f 6469 6e67 3a20 7574  # -*- coding: ut
-0007f410: 662d 3820 2d2a 2d0d 0a23 2323 2323 2323  f-8 -*-..#######
-0007f420: 2323 2323 2323 2323 2323 2323 2323 2323  ################
-0007f430: 2323 2323 2323 2323 2323 2323 2323 2323  ################
-0007f440: 2323 2323 2323 2323 2323 2323 2323 2323  ################
-0007f450: 2323 2323 2323 2323 2323 2323 2323 2323  ################
-0007f460: 2323 2323 2323 2323 230d 0a23 2020 2020  #########..#    
-0007f470: 2041 7574 6f5f 5669 4d4c 202d 2041 7574   Auto_ViML - Aut
-0007f480: 6f6d 6174 6963 616c 6c79 2042 7569 6c64  omatically Build
-0007f490: 204d 756c 7469 706c 6520 496e 7465 7270   Multiple Interp
-0007f4a0: 7265 7461 626c 6520 4d4c 204d 6f64 656c  retable ML Model
-0007f4b0: 7320 696e 2053 696e 676c 6520 4c69 6e65  s in Single Line
-0007f4c0: 206f 6620 436f 6465 0d0a 2320 2020 2020   of Code..#     
-0007f4d0: 5079 7468 6f6e 2076 332e 362b 0d0a 2320  Python v3.6+..# 
-0007f4e0: 2020 2020 4372 6561 7465 6420 6279 2052      Created by R
-0007f4f0: 616d 2053 6573 6861 6472 690d 0a23 2020  am Seshadri..#  
-0007f500: 2020 204c 6963 656e 7365 6420 756e 6465     Licensed unde
-0007f510: 7220 4170 6163 6865 204c 6963 656e 7365  r Apache License
-0007f520: 2076 320d 0a23 2323 2323 2323 2323 2323   v2..###########
-0007f530: 2323 2323 2323 2323 2323 2323 2323 2323  ################
-0007f540: 2323 2323 2323 2323 2323 2323 2323 2323  ################
-0007f550: 2323 2323 2323 2323 2323 2323 2323 2323  ################
-0007f560: 2323 2323 2323 2323 2323 2323 2323 2323  ################
-0007f570: 2323 2323 230d 0a23 2056 6572 7369 6f6e  #####..# Version
-0007f580: 0d0a 6672 6f6d 202e 5f5f 7665 7273 696f  ..from .__versio
-0007f590: 6e5f 5f20 696d 706f 7274 205f 5f76 6572  n__ import __ver
-0007f5a0: 7369 6f6e 5f5f 2c20 5f5f 6e6c 705f 7665  sion__, __nlp_ve
-0007f5b0: 7273 696f 6e5f 5f0d 0a69 6620 5f5f 6e61  rsion__..if __na
-0007f5c0: 6d65 5f5f 203d 3d20 225f 5f6d 6169 6e5f  me__ == "__main_
-0007f5d0: 5f22 3a0d 0a20 2020 206d 6f64 756c 655f  _":..    module_
-0007f5e0: 7479 7065 203d 2027 5275 6e6e 696e 6727  type = 'Running'
-0007f5f0: 0d0a 656c 7365 3a0d 0a20 2020 206d 6f64  ..else:..    mod
-0007f600: 756c 655f 7479 7065 203d 2027 496d 706f  ule_type = 'Impo
-0007f610: 7274 6564 270d 0a76 696d 6c5f 7665 7273  rted'..viml_vers
-0007f620: 696f 6e5f 6e75 6d62 6572 203d 205f 5f76  ion_number = __v
-0007f630: 6572 7369 6f6e 5f5f 0d0a 6e6c 705f 7665  ersion__..nlp_ve
-0007f640: 7273 696f 6e5f 6e75 6d62 6572 203d 205f  rsion_number = _
-0007f650: 5f6e 6c70 5f76 6572 7369 6f6e 5f5f 0d0a  _nlp_version__..
-0007f660: 7072 696e 7428 2222 2225 7320 4175 746f  print("""%s Auto
-0007f670: 5f56 694d 4c20 7665 7273 696f 6e3a 2025  _ViML version: %
-0007f680: 732e 2043 616c 6c20 7573 696e 673a 0d0a  s. Call using:..
-0007f690: 2020 2020 2020 2020 2020 2020 206d 2c20               m, 
-0007f6a0: 6665 6174 732c 2074 7261 696e 6d2c 2074  feats, trainm, t
-0007f6b0: 6573 746d 203d 2041 7574 6f5f 5669 4d4c  estm = Auto_ViML
-0007f6c0: 2874 7261 696e 2c20 7461 7267 6574 2c20  (train, target, 
-0007f6d0: 7465 7374 2c0d 0a20 2020 2020 2020 2020  test,..         
-0007f6e0: 2020 2020 2020 2020 2020 2020 2020 2020                  
-0007f6f0: 2020 2073 616d 706c 655f 7375 626d 6973     sample_submis
-0007f700: 7369 6f6e 3d27 272c 0d0a 2020 2020 2020  sion='',..      
-0007f710: 2020 2020 2020 2020 2020 2020 2020 2020                  
-0007f720: 2020 2020 2020 7363 6f72 696e 675f 7061        scoring_pa
-0007f730: 7261 6d65 7465 723d 2727 2c20 4b4d 6561  rameter='', KMea
-0007f740: 6e73 5f46 6561 7475 7269 7a65 723d 4661  ns_Featurizer=Fa
-0007f750: 6c73 652c 0d0a 2020 2020 2020 2020 2020  lse,..          
-0007f760: 2020 2020 2020 2020 2020 2020 2020 2020                  
-0007f770: 2020 6879 7065 725f 7061 7261 6d3d 2752    hyper_param='R
-0007f780: 5327 2c66 6561 7475 7265 5f72 6564 7563  S',feature_reduc
-0007f790: 7469 6f6e 3d54 7275 652c 0d0a 2020 2020  tion=True,..    
-0007f7a0: 2020 2020 2020 2020 2020 2020 2020 2020                  
-0007f7b0: 2020 2020 2020 2020 2042 6f6f 7374 696e           Boostin
-0007f7c0: 675f 466c 6167 3d27 4361 7442 6f6f 7374  g_Flag='CatBoost
-0007f7d0: 272c 2042 696e 6e69 6e67 5f46 6c61 673d  ', Binning_Flag=
-0007f7e0: 4661 6c73 652c 0d0a 2020 2020 2020 2020  False,..        
-0007f7f0: 2020 2020 2020 2020 2020 2020 2020 2020                  
-0007f800: 2020 2020 4164 645f 506f 6c79 3d30 2c20      Add_Poly=0, 
-0007f810: 5374 6163 6b69 6e67 5f46 6c61 673d 4661  Stacking_Flag=Fa
-0007f820: 6c73 652c 496d 6261 6c61 6e63 6564 5f46  lse,Imbalanced_F
-0007f830: 6c61 673d 4661 6c73 652c 0d0a 2020 2020  lag=False,..    
-0007f840: 2020 2020 2020 2020 2020 2020 2020 2020                  
-0007f850: 2020 2020 2020 2020 4750 555f 666c 6167          GPU_flag
-0007f860: 3d46 616c 7365 2c20 7665 7262 6f73 653d  =False, verbose=
-0007f870: 3129 0d0a 2020 2020 2020 2020 2020 2020  1)..            
-0007f880: 2222 2220 2528 6d6f 6475 6c65 5f74 7970  """ %(module_typ
-0007f890: 652c 2076 696d 6c5f 7665 7273 696f 6e5f  e, viml_version_
-0007f8a0: 6e75 6d62 6572 2929 0d0a 7072 696e 7428  number))..print(
-0007f8b0: 290d 0a23 2323 2323 2323 2323 2323 2323  )..#############
-0007f8c0: 2323 2323 2323 2323 2323 2323 2323 2323  ################
-0007f8d0: 2323 2323 2323 2323 2323 2323 2323 2323  ################
-0007f8e0: 2323 2323 2323 2323 2323 2323 2323 2323  ################
-0007f8f0: 2323 2323 2323 2323 2323 2323 2323 2323  ################
-0007f900: 2323 2323 2323 2323 2323 2323 2323 0d0a  ##############..
-0007f910: 7072 696e 7428 2222 2225 7320 4175 746f  print("""%s Auto
-0007f920: 5f4e 4c50 2076 6572 7369 6f6e 3a20 2573  _NLP version: %s
-0007f930: 2e2e 2043 616c 6c20 7573 696e 673a 0d0a  .. Call using:..
-0007f940: 2020 2020 2074 7261 696e 5f6e 6c70 2c20       train_nlp, 
-0007f950: 7465 7374 5f6e 6c70 2c20 6e6c 705f 7069  test_nlp, nlp_pi
-0007f960: 7065 6c69 6e65 2c20 7072 6564 6963 7469  peline, predicti
-0007f970: 6f6e 7320 3d20 4175 746f 5f4e 4c50 280d  ons = Auto_NLP(.
-0007f980: 0a20 2020 2020 2020 2020 2020 2020 2020  .               
-0007f990: 206e 6c70 5f63 6f6c 756d 6e2c 2074 7261   nlp_column, tra
-0007f9a0: 696e 2c20 7465 7374 2c20 7461 7267 6574  in, test, target
-0007f9b0: 2c20 7363 6f72 655f 7479 7065 3d27 6261  , score_type='ba
-0007f9c0: 6c61 6e63 6564 5f61 6363 7572 6163 7927  lanced_accuracy'
-0007f9d0: 2c0d 0a20 2020 2020 2020 2020 2020 2020  ,..             
-0007f9e0: 2020 206d 6f64 656c 7479 7065 3d27 436c     modeltype='Cl
-0007f9f0: 6173 7369 6669 6361 7469 6f6e 272c 746f  assification',to
-0007fa00: 705f 6e75 6d5f 6665 6174 7572 6573 3d32  p_num_features=2
-0007fa10: 3030 2c20 7665 7262 6f73 653d 302c 0d0a  00, verbose=0,..
-0007fa20: 2020 2020 2020 2020 2020 2020 2020 2020                  
-0007fa30: 6275 696c 645f 6d6f 6465 6c3d 5472 7565  build_model=True
-0007fa40: 2922 2222 2025 286d 6f64 756c 655f 7479  )""" %(module_ty
-0007fa50: 7065 2c20 6e6c 705f 7665 7273 696f 6e5f  pe, nlp_version_
-0007fa60: 6e75 6d62 6572 2929 0d0a 2323 2323 2323  number))..######
-0007fa70: 2323 2323 2323 2323 2323 2323 2323 2323  ################
-0007fa80: 2323 2323 2323 2323 2323 2323 2323 2323  ################
-0007fa90: 2323 2323 2323 2323 2323 2323 2323 2323  ################
-0007faa0: 2323 2323 2323 2323 2323 2323 2323 2323  ################
-0007fab0: 2323 0d0a 0000 0000 0000 0000 0000 0000  ##..............
+0007b490: 2020 2023 2020 2020 2020 2020 2020 2020     #            
+0007b4a0: 2020 2020 2020 2020 2020 2020 2020 2020                  
+0007b4b0: 6e5f 6573 7469 6d61 746f 7273 3d4e 554d  n_estimators=NUM
+0007b4c0: 532c 7261 6e64 6f6d 5f73 7461 7465 3d73  S,random_state=s
+0007b4d0: 6565 6429 0d0a 2020 2020 2020 2020 2020  eed)..          
+0007b4e0: 2020 2020 2020 6d6f 6465 6c34 203d 204c        model4 = L
+0007b4f0: 696e 6561 7253 5652 2829 0d0a 2020 2020  inearSVR()..    
+0007b500: 2020 2020 2020 2020 2020 2020 7265 7375              resu
+0007b510: 6c74 7320 3d20 6372 6f73 735f 7661 6c5f  lts = cross_val_
+0007b520: 7072 6564 6963 7428 6d6f 6465 6c34 2c58  predict(model4,X
+0007b530: 5f74 7261 696e 2c79 5f74 7261 696e 2c20  _train,y_train, 
+0007b540: 6376 3d73 6376 2c6e 5f6a 6f62 733d 2d31  cv=scv,n_jobs=-1
+0007b550: 290d 0a20 2020 2020 2020 2020 2020 2020  )..             
+0007b560: 2020 2065 7374 696d 6174 6f72 732e 6170     estimators.ap
+0007b570: 7065 6e64 2828 274c 696e 6561 725f 5356  pend(('Linear_SV
+0007b580: 5227 2c6d 6f64 656c 3429 290d 0a20 2020  R',model4))..   
+0007b590: 2020 2020 2020 2020 2020 2020 2065 7374               est
+0007b5a0: 696d 6174 6f72 5f6c 656e 6774 682e 6170  imator_length.ap
+0007b5b0: 7065 6e64 2831 290d 0a20 2020 2020 2020  pend(1)..       
+0007b5c0: 2020 2020 2065 6c69 6620 426f 6f73 7469       elif Boosti
+0007b5d0: 6e67 5f46 6c61 6720 6973 204e 6f6e 653a  ng_Flag is None:
+0007b5e0: 0d0a 2020 2020 2020 2020 2020 2020 2020  ..              
+0007b5f0: 2020 2323 2323 2020 2054 7265 6520 6d6f    ####   Tree mo
+0007b600: 6465 6c73 2069 6620 4c69 6e65 6172 2063  dels if Linear c
+0007b610: 686f 7365 6e20 2323 2323 230d 0a20 2020  hosen #####..   
+0007b620: 2020 2020 2020 2020 2020 2020 206d 6f64               mod
+0007b630: 656c 3520 3d20 4465 6369 7369 6f6e 5472  el5 = DecisionTr
+0007b640: 6565 5265 6772 6573 736f 7228 7261 6e64  eeRegressor(rand
+0007b650: 6f6d 5f73 7461 7465 3d73 6565 642c 6d69  om_state=seed,mi
+0007b660: 6e5f 7361 6d70 6c65 735f 6c65 6166 3d32  n_samples_leaf=2
+0007b670: 290d 0a20 2020 2020 2020 2020 2020 2020  )..             
+0007b680: 2020 2072 6573 756c 7473 203d 2063 726f     results = cro
+0007b690: 7373 5f76 616c 5f70 7265 6469 6374 286d  ss_val_predict(m
+0007b6a0: 6f64 656c 352c 585f 7472 6169 6e2c 795f  odel5,X_train,y_
+0007b6b0: 7472 6169 6e2c 2063 763d 7363 762c 6e5f  train, cv=scv,n_
+0007b6c0: 6a6f 6273 3d2d 3129 0d0a 2020 2020 2020  jobs=-1)..      
+0007b6d0: 2020 2020 2020 2020 2020 6573 7469 6d61            estima
+0007b6e0: 746f 7273 2e61 7070 656e 6428 2827 4465  tors.append(('De
+0007b6f0: 6369 7369 6f6e 2054 7265 6573 272c 6d6f  cision Trees',mo
+0007b700: 6465 6c35 2929 0d0a 2020 2020 2020 2020  del5))..        
+0007b710: 2020 2020 2020 2020 6573 7469 6d61 746f          estimato
+0007b720: 725f 6c65 6e67 7468 2e61 7070 656e 6428  r_length.append(
+0007b730: 3129 0d0a 2020 2020 2020 2020 2020 2020  1)..            
+0007b740: 656c 7365 3a0d 0a20 2020 2020 2020 2020  else:..         
+0007b750: 2020 2020 2020 2023 2323 2320 2020 4c69         ####   Li
+0007b760: 6e65 6172 204d 6f64 656c 7320 6966 2042  near Models if B
+0007b770: 6f6f 7374 696e 6720 6973 2063 686f 7365  oosting is chose
+0007b780: 6e20 2323 2323 230d 0a20 2020 2020 2020  n #####..       
+0007b790: 2020 2020 2020 2020 206d 6f64 656c 3620           model6 
+0007b7a0: 3d20 4c61 7373 6f43 5628 616c 7068 6173  = LassoCV(alphas
+0007b7b0: 3d6e 702e 6c6f 6773 7061 6365 282d 352c  =np.logspace(-5,
+0007b7c0: 2d31 2c32 3029 2c20 6376 3d73 6376 2c72  -1,20), cv=scv,r
+0007b7d0: 616e 646f 6d5f 7374 6174 653d 7365 6564  andom_state=seed
+0007b7e0: 290d 0a20 2020 2020 2020 2020 2020 2020  )..             
+0007b7f0: 2020 2072 6573 756c 7473 203d 2063 726f     results = cro
+0007b800: 7373 5f76 616c 5f70 7265 6469 6374 286d  ss_val_predict(m
+0007b810: 6f64 656c 362c 585f 7472 6169 6e2c 795f  odel6,X_train,y_
+0007b820: 7472 6169 6e2c 2063 763d 7363 762c 6e5f  train, cv=scv,n_
+0007b830: 6a6f 6273 3d2d 3129 0d0a 2020 2020 2020  jobs=-1)..      
+0007b840: 2020 2020 2020 2020 2020 6573 7469 6d61            estima
+0007b850: 746f 7273 2e61 7070 656e 6428 2827 4c61  tors.append(('La
+0007b860: 7373 6f43 5620 5265 6775 6c61 7269 7a61  ssoCV Regulariza
+0007b870: 7469 6f6e 272c 6d6f 6465 6c36 2929 0d0a  tion',model6))..
+0007b880: 2020 2020 2020 2020 2020 2020 2020 2020                  
+0007b890: 6573 7469 6d61 746f 725f 6c65 6e67 7468  estimator_length
+0007b8a0: 2e61 7070 656e 6428 3129 0d0a 2020 2020  .append(1)..    
+0007b8b0: 2020 2020 656c 7365 3a0d 0a20 2020 2020      else:..     
+0007b8c0: 2020 2020 2020 206e 5f63 6c61 7373 6573         n_classes
+0007b8d0: 203d 206c 656e 2843 6f75 6e74 6572 2879   = len(Counter(y
+0007b8e0: 5f74 7261 696e 2929 0d0a 2020 2020 2020  _train))..      
+0007b8f0: 2020 2020 2020 6966 206e 5f63 6c61 7373        if n_class
+0007b900: 6573 203e 2032 3a0d 0a20 2020 2020 2020  es > 2:..       
+0007b910: 2020 2020 2020 2020 2023 2323 2320 496e           #### In
+0007b920: 206d 756c 7469 2d63 6c61 7373 2073 6574   multi-class set
+0007b930: 7469 6e67 2c20 6974 206d 616b 6573 2073  ting, it makes s
+0007b940: 656e 7365 2074 6f20 7475 726e 2069 7420  ense to turn it 
+0007b950: 696e 746f 2062 696e 6172 7920 636c 6173  into binary clas
+0007b960: 7320 696e 2073 7461 6765 2d31 0d0a 2020  s in stage-1..  
+0007b970: 2020 2020 2020 2020 2020 2020 2020 2323                ##
+0007b980: 2323 2049 6e20 7374 6167 6520 322c 2061  ## In stage 2, a
+0007b990: 2063 6f6d 706c 6578 206d 6f64 656c 2077   complex model w
+0007b9a0: 696c 6c20 7461 6b65 2074 6865 2069 6e70  ill take the inp
+0007b9b0: 7574 7320 6f66 2074 6869 7320 6d6f 6465  uts of this mode
+0007b9c0: 6c20 616e 6420 7472 7920 746f 2070 7265  l and try to pre
+0007b9d0: 6469 6374 0d0a 2020 2020 2020 2020 2020  dict..          
+0007b9e0: 2020 2020 2020 7261 7265 5f63 6c61 7373        rare_class
+0007b9f0: 203d 2066 696e 645f 7261 7265 5f63 6c61   = find_rare_cla
+0007ba00: 7373 2879 5f74 7261 696e 290d 0a20 2020  ss(y_train)..   
+0007ba10: 2020 2020 2020 2020 2020 2020 2069 6620               if 
+0007ba20: 7261 7265 5f63 6c61 7373 203d 3d20 303a  rare_class == 0:
+0007ba30: 0d0a 2020 2020 2020 2020 2020 2020 2020  ..              
+0007ba40: 2020 2020 2020 6d61 6a6f 7269 7479 5f63        majority_c
+0007ba50: 6c61 7373 203d 2031 0d0a 2020 2020 2020  lass = 1..      
+0007ba60: 2020 2020 2020 2020 2020 656c 7365 3a0d            else:.
+0007ba70: 0a20 2020 2020 2020 2020 2020 2020 2020  .               
+0007ba80: 2020 2020 206d 616a 6f72 6974 795f 636c       majority_cl
+0007ba90: 6173 7320 3d20 300d 0a20 2020 2020 2020  ass = 0..       
+0007baa0: 2020 2020 2020 2020 2079 5f74 7261 696e           y_train
+0007bab0: 203d 2079 5f74 7261 696e 2e6d 6170 286c   = y_train.map(l
+0007bac0: 616d 6264 6120 783a 2072 6172 655f 636c  ambda x: rare_cl
+0007bad0: 6173 7320 6966 2078 3d3d 7261 7265 5f63  ass if x==rare_c
+0007bae0: 6c61 7373 2065 6c73 6520 6d61 6a6f 7269  lass else majori
+0007baf0: 7479 5f63 6c61 7373 290d 0a20 2020 2020  ty_class)..     
+0007bb00: 2020 2020 2020 2069 6620 7363 6f72 696e         if scorin
+0007bb10: 6720 3d3d 2027 273a 0d0a 2020 2020 2020  g == '':..      
+0007bb20: 2020 2020 2020 2020 2020 7363 6f72 696e            scorin
+0007bb30: 6720 3d20 2761 6363 7572 6163 7927 0d0a  g = 'accuracy'..
+0007bb40: 2020 2020 2020 2020 2020 2020 7363 7620              scv 
+0007bb50: 3d20 5374 7261 7469 6669 6564 4b46 6f6c  = StratifiedKFol
+0007bb60: 6428 6e5f 7370 6c69 7473 3d46 4f4c 4453  d(n_splits=FOLDS
+0007bb70: 2c20 7261 6e64 6f6d 5f73 7461 7465 3d73  , random_state=s
+0007bb80: 6565 642c 2073 6875 6666 6c65 3d54 7275  eed, shuffle=Tru
+0007bb90: 6529 0d0a 2020 2020 2020 2020 2020 2020  e)..            
+0007bba0: 6966 2042 6f6f 7374 696e 675f 466c 6167  if Boosting_Flag
+0007bbb0: 3a0d 0a20 2020 2020 2020 2020 2020 2020  :..             
+0007bbc0: 2020 2023 2323 2320 2020 4c69 6e65 6172     ####   Linear
+0007bbd0: 204d 6f64 656c 7320 6966 2042 6f6f 7374   Models if Boost
+0007bbe0: 696e 6720 6973 2063 686f 7365 6e20 2323  ing is chosen ##
+0007bbf0: 2323 230d 0a20 2020 2020 2020 2020 2020  ###..           
+0007bc00: 2020 2020 206d 6f64 656c 3420 3d20 4c69       model4 = Li
+0007bc10: 6e65 6172 4469 7363 7269 6d69 6e61 6e74  nearDiscriminant
+0007bc20: 416e 616c 7973 6973 2829 0d0a 2020 2020  Analysis()..    
+0007bc30: 2020 2020 2020 2020 2020 2020 7265 7375              resu
+0007bc40: 6c74 7320 3d20 6372 6f73 735f 7661 6c5f  lts = cross_val_
+0007bc50: 7072 6564 6963 7428 6d6f 6465 6c34 2c58  predict(model4,X
+0007bc60: 5f74 7261 696e 2c79 5f74 7261 696e 2c20  _train,y_train, 
+0007bc70: 6376 3d73 6376 2c6e 5f6a 6f62 733d 2d31  cv=scv,n_jobs=-1
+0007bc80: 2c0d 0a20 2020 2020 2020 2020 2020 2020  ,..             
+0007bc90: 2020 2020 2020 2020 2020 2020 2020 2020                  
+0007bca0: 2020 2020 2020 2020 2020 2020 2020 206d                 m
+0007bcb0: 6574 686f 643d 2770 7265 6469 6374 5f70  ethod='predict_p
+0007bcc0: 726f 6261 2729 0d0a 2020 2020 2020 2020  roba')..        
+0007bcd0: 2020 2020 2020 2020 6573 7469 6d61 746f          estimato
+0007bce0: 7273 2e61 7070 656e 6428 2827 4c69 6e65  rs.append(('Line
+0007bcf0: 6172 2044 6973 6372 696d 696e 616e 7427  ar Discriminant'
+0007bd00: 2c6d 6f64 656c 3429 290d 0a20 2020 2020  ,model4))..     
+0007bd10: 2020 2020 2020 2020 2020 2065 7374 696d             estim
+0007bd20: 6174 6f72 5f6c 656e 6774 682e 6170 7065  ator_length.appe
+0007bd30: 6e64 2872 6573 756c 7473 2e73 6861 7065  nd(results.shape
+0007bd40: 5b31 5d29 0d0a 2020 2020 2020 2020 2020  [1])..          
+0007bd50: 2020 656c 6966 2042 6f6f 7374 696e 675f    elif Boosting_
+0007bd60: 466c 6167 2069 7320 4e6f 6e65 3a0d 0a20  Flag is None:.. 
+0007bd70: 2020 2020 2020 2020 2020 2020 2020 2023                 #
+0007bd80: 2323 2320 2020 5472 6565 206d 6f64 656c  ###   Tree model
+0007bd90: 7320 6966 204c 696e 6561 7220 6368 6f73  s if Linear chos
+0007bda0: 656e 2023 2323 2323 0d0a 2020 2020 2020  en #####..      
+0007bdb0: 2020 2020 2020 2020 2020 6d6f 6465 6c36            model6
+0007bdc0: 203d 2044 6563 6973 696f 6e54 7265 6543   = DecisionTreeC
+0007bdd0: 6c61 7373 6966 6965 7228 6d69 6e5f 7361  lassifier(min_sa
+0007bde0: 6d70 6c65 735f 6c65 6166 3d32 290d 0a20  mples_leaf=2).. 
+0007bdf0: 2020 2020 2020 2020 2020 2020 2020 2072                 r
+0007be00: 6573 756c 7473 203d 2063 726f 7373 5f76  esults = cross_v
+0007be10: 616c 5f70 7265 6469 6374 286d 6f64 656c  al_predict(model
+0007be20: 362c 585f 7472 6169 6e2c 795f 7472 6169  6,X_train,y_trai
+0007be30: 6e2c 2063 763d 7363 762c 6e5f 6a6f 6273  n, cv=scv,n_jobs
+0007be40: 3d2d 312c 0d0a 2020 2020 2020 2020 2020  =-1,..          
+0007be50: 2020 2020 2020 2020 2020 2020 2020 2020                  
+0007be60: 2020 2020 2020 2020 2020 2020 2020 2020                  
+0007be70: 2020 6d65 7468 6f64 3d27 7072 6564 6963    method='predic
+0007be80: 745f 7072 6f62 6127 290d 0a20 2020 2020  t_proba')..     
+0007be90: 2020 2020 2020 2020 2020 2065 7374 696d             estim
+0007bea0: 6174 6f72 732e 6170 7065 6e64 2828 2744  ators.append(('D
+0007beb0: 6563 6973 696f 6e20 5472 6565 272c 6d6f  ecision Tree',mo
+0007bec0: 6465 6c36 2929 0d0a 2020 2020 2020 2020  del6))..        
+0007bed0: 2020 2020 2020 2020 6573 7469 6d61 746f          estimato
+0007bee0: 725f 6c65 6e67 7468 2e61 7070 656e 6428  r_length.append(
+0007bef0: 7265 7375 6c74 732e 7368 6170 655b 315d  results.shape[1]
+0007bf00: 290d 0a20 2020 2020 2020 2020 2020 2065  )..            e
+0007bf10: 6c73 653a 0d0a 2020 2020 2020 2020 2020  lse:..          
+0007bf20: 2020 2020 2020 2323 2323 2323 2020 2020        ######    
+0007bf30: 4e61 6976 6520 4261 7965 7320 6d6f 6465  Naive Bayes mode
+0007bf40: 6c73 2069 6620 4261 6767 696e 6720 6973  ls if Bagging is
+0007bf50: 2063 686f 7365 6e20 2323 2323 0d0a 2020   chosen ####..  
+0007bf60: 2020 2020 2020 2020 2020 2020 2020 6966                if
+0007bf70: 206e 5f63 6c61 7373 6573 203c 3d20 323a   n_classes <= 2:
+0007bf80: 0d0a 2020 2020 2020 2020 2020 2020 2020  ..              
+0007bf90: 2020 2020 2020 7472 793a 0d0a 2020 2020        try:..    
+0007bfa0: 2020 2020 2020 2020 2020 2020 2020 2020                  
+0007bfb0: 2020 2020 6d6f 6465 6c37 203d 2047 6175      model7 = Gau
+0007bfc0: 7373 6961 6e4e 4228 290d 0a20 2020 2020  ssianNB()..     
+0007bfd0: 2020 2020 2020 2020 2020 2020 2020 2065                 e
+0007bfe0: 7863 6570 743a 0d0a 2020 2020 2020 2020  xcept:..        
+0007bff0: 2020 2020 2020 2020 2020 2020 2020 2020                  
+0007c000: 6d6f 6465 6c37 203d 2044 6563 6973 696f  model7 = Decisio
+0007c010: 6e54 7265 6543 6c61 7373 6966 6965 7228  nTreeClassifier(
+0007c020: 6d69 6e5f 7361 6d70 6c65 735f 6c65 6166  min_samples_leaf
+0007c030: 3d32 290d 0a20 2020 2020 2020 2020 2020  =2)..           
+0007c040: 2020 2020 2065 6c73 653a 0d0a 2020 2020       else:..    
+0007c050: 2020 2020 2020 2020 2020 2020 2020 2020                  
+0007c060: 7472 793a 0d0a 2020 2020 2020 2020 2020  try:..          
+0007c070: 2020 2020 2020 2020 2020 2020 2020 6d6f                mo
+0007c080: 6465 6c37 203d 204d 756c 7469 6e6f 6d69  del7 = Multinomi
+0007c090: 616c 4e42 2829 0d0a 2020 2020 2020 2020  alNB()..        
+0007c0a0: 2020 2020 2020 2020 2020 2020 6578 6365              exce
+0007c0b0: 7074 3a0d 0a20 2020 2020 2020 2020 2020  pt:..           
+0007c0c0: 2020 2020 2020 2020 2020 2020 206d 6f64               mod
+0007c0d0: 656c 3720 3d20 4465 6369 7369 6f6e 5472  el7 = DecisionTr
+0007c0e0: 6565 436c 6173 7369 6669 6572 286d 696e  eeClassifier(min
+0007c0f0: 5f73 616d 706c 6573 5f6c 6561 663d 3229  _samples_leaf=2)
+0007c100: 0d0a 2020 2020 2020 2020 2020 2020 2020  ..              
+0007c110: 2020 7265 7375 6c74 7320 3d20 6372 6f73    results = cros
+0007c120: 735f 7661 6c5f 7072 6564 6963 7428 6d6f  s_val_predict(mo
+0007c130: 6465 6c37 2c58 5f74 7261 696e 2c79 5f74  del7,X_train,y_t
+0007c140: 7261 696e 2c20 6376 3d73 6376 2c6e 5f6a  rain, cv=scv,n_j
+0007c150: 6f62 733d 2d31 2c0d 0a20 2020 2020 2020  obs=-1,..       
+0007c160: 2020 2020 2020 2020 2020 2020 2020 2020                  
+0007c170: 2020 2020 2020 2020 2020 2020 2020 2020                  
+0007c180: 2020 2020 206d 6574 686f 643d 2770 7265       method='pre
+0007c190: 6469 6374 5f70 726f 6261 2729 0d0a 2020  dict_proba')..  
+0007c1a0: 2020 2020 2020 2020 2020 2020 2020 6573                es
+0007c1b0: 7469 6d61 746f 7273 2e61 7070 656e 6428  timators.append(
+0007c1c0: 2827 4e61 6976 6520 4261 7965 7327 2c6d  ('Naive Bayes',m
+0007c1d0: 6f64 656c 3729 290d 0a20 2020 2020 2020  odel7))..       
+0007c1e0: 2020 2020 2020 2020 2065 7374 696d 6174           estimat
+0007c1f0: 6f72 5f6c 656e 6774 682e 6170 7065 6e64  or_length.append
+0007c200: 2872 6573 756c 7473 2e73 6861 7065 5b31  (results.shape[1
+0007c210: 5d29 0d0a 2020 2020 656c 7365 3a0d 0a20  ])..    else:.. 
+0007c220: 2020 2020 2020 2023 2323 2320 5468 6973         #### This
+0007c230: 2069 7320 7768 6572 6520 796f 7520 6669   is where you fi
+0007c240: 7420 7468 6520 6d6f 6465 6c20 616e 6420  t the model and 
+0007c250: 7468 656e 2070 7265 6469 6374 2023 2323  then predict ###
+0007c260: 2323 2323 230d 0a20 2020 2020 2020 2069  #####..        i
+0007c270: 6620 6d6f 6465 6c74 7970 6520 3d3d 2027  f modeltype == '
+0007c280: 5265 6772 6573 7369 6f6e 273a 0d0a 2020  Regression':..  
+0007c290: 2020 2020 2020 2020 2020 6966 2073 636f            if sco
+0007c2a0: 7269 6e67 203d 3d20 2727 3a0d 0a20 2020  ring == '':..   
+0007c2b0: 2020 2020 2020 2020 2020 2020 2073 636f               sco
+0007c2c0: 7269 6e67 203d 2027 6e65 675f 6d65 616e  ring = 'neg_mean
+0007c2d0: 5f73 7175 6172 6564 5f65 7272 6f72 270d  _squared_error'.
+0007c2e0: 0a20 2020 2020 2020 2020 2020 2073 6376  .            scv
+0007c2f0: 203d 204b 466f 6c64 286e 5f73 706c 6974   = KFold(n_split
+0007c300: 733d 464f 4c44 532c 2073 6875 6666 6c65  s=FOLDS, shuffle
+0007c310: 3d46 616c 7365 290d 0a20 2020 2020 2020  =False)..       
+0007c320: 2020 2020 2069 6620 426f 6f73 7469 6e67       if Boosting
+0007c330: 5f46 6c61 673a 0d0a 2020 2020 2020 2020  _Flag:..        
+0007c340: 2020 2020 2020 2020 2323 2323 2323 2020          ######  
+0007c350: 2020 4261 6767 696e 6720 6d6f 6465 6c73    Bagging models
+0007c360: 2069 6620 4261 6767 696e 6720 6973 2063   if Bagging is c
+0007c370: 686f 7365 6e20 2323 2323 0d0a 2020 2020  hosen ####..    
+0007c380: 2020 2020 2020 2020 2020 2020 236d 6f64              #mod
+0007c390: 656c 3420 3d20 4261 6767 696e 6752 6567  el4 = BaggingReg
+0007c3a0: 7265 7373 6f72 2844 6563 6973 696f 6e54  ressor(DecisionT
+0007c3b0: 7265 6552 6567 7265 7373 6f72 2872 616e  reeRegressor(ran
+0007c3c0: 646f 6d5f 7374 6174 653d 7365 6564 292c  dom_state=seed),
+0007c3d0: 0d0a 2020 2020 2020 2020 2020 2020 2020  ..              
+0007c3e0: 2020 2320 2020 2020 2020 2020 2020 2020    #             
+0007c3f0: 2020 2020 2020 2020 2020 2020 2020 206e                 n
+0007c400: 5f65 7374 696d 6174 6f72 733d 4e55 4d53  _estimators=NUMS
+0007c410: 2c72 616e 646f 6d5f 7374 6174 653d 7365  ,random_state=se
+0007c420: 6564 290d 0a20 2020 2020 2020 2020 2020  ed)..           
+0007c430: 2020 2020 206d 6f64 656c 3420 3d20 4c69       model4 = Li
+0007c440: 6e65 6172 5356 5228 290d 0a20 2020 2020  nearSVR()..     
+0007c450: 2020 2020 2020 2020 2020 2072 6573 756c             resul
+0007c460: 7473 203d 206d 6f64 656c 342e 6669 7428  ts = model4.fit(
+0007c470: 585f 7472 6169 6e2c 795f 7472 6169 6e29  X_train,y_train)
+0007c480: 2e70 7265 6469 6374 2858 5f74 6573 7429  .predict(X_test)
+0007c490: 0d0a 2020 2020 2020 2020 2020 2020 2020  ..              
+0007c4a0: 2020 6573 7469 6d61 746f 7273 2e61 7070    estimators.app
+0007c4b0: 656e 6428 2827 4c69 6e65 6172 5f53 5652  end(('Linear_SVR
+0007c4c0: 272c 6d6f 6465 6c34 2929 0d0a 2020 2020  ',model4))..    
+0007c4d0: 2020 2020 2020 2020 2020 2020 6573 7469              esti
+0007c4e0: 6d61 746f 725f 6c65 6e67 7468 2e61 7070  mator_length.app
+0007c4f0: 656e 6428 3129 0d0a 2020 2020 2020 2020  end(1)..        
+0007c500: 2020 2020 656c 6966 2042 6f6f 7374 696e      elif Boostin
+0007c510: 675f 466c 6167 2069 7320 4e6f 6e65 3a0d  g_Flag is None:.
+0007c520: 0a20 2020 2020 2020 2020 2020 2020 2020  .               
+0007c530: 2023 2323 2320 2020 5472 6565 206d 6f64   ####   Tree mod
+0007c540: 656c 7320 6966 204c 696e 6561 7220 6368  els if Linear ch
+0007c550: 6f73 656e 2023 2323 2323 0d0a 2020 2020  osen #####..    
+0007c560: 2020 2020 2020 2020 2020 2020 6d6f 6465              mode
+0007c570: 6c35 203d 2044 6563 6973 696f 6e54 7265  l5 = DecisionTre
+0007c580: 6552 6567 7265 7373 6f72 2872 616e 646f  eRegressor(rando
+0007c590: 6d5f 7374 6174 653d 7365 6564 2c6d 696e  m_state=seed,min
+0007c5a0: 5f73 616d 706c 6573 5f6c 6561 663d 3229  _samples_leaf=2)
+0007c5b0: 0d0a 2020 2020 2020 2020 2020 2020 2020  ..              
+0007c5c0: 2020 7265 7375 6c74 7320 3d20 6d6f 6465    results = mode
+0007c5d0: 6c35 2e66 6974 2858 5f74 7261 696e 2c79  l5.fit(X_train,y
+0007c5e0: 5f74 7261 696e 292e 7072 6564 6963 7428  _train).predict(
+0007c5f0: 585f 7465 7374 290d 0a20 2020 2020 2020  X_test)..       
+0007c600: 2020 2020 2020 2020 2065 7374 696d 6174           estimat
+0007c610: 6f72 732e 6170 7065 6e64 2828 2744 6563  ors.append(('Dec
+0007c620: 6973 696f 6e20 5472 6565 7327 2c6d 6f64  ision Trees',mod
+0007c630: 656c 3529 290d 0a20 2020 2020 2020 2020  el5))..         
+0007c640: 2020 2020 2020 2065 7374 696d 6174 6f72         estimator
+0007c650: 5f6c 656e 6774 682e 6170 7065 6e64 2831  _length.append(1
+0007c660: 290d 0a20 2020 2020 2020 2020 2020 2065  )..            e
+0007c670: 6c73 653a 0d0a 2020 2020 2020 2020 2020  lse:..          
+0007c680: 2020 2020 2020 2323 2323 2020 204c 696e        ####   Lin
+0007c690: 6561 7220 4d6f 6465 6c73 2069 6620 426f  ear Models if Bo
+0007c6a0: 6f73 7469 6e67 2069 7320 6368 6f73 656e  osting is chosen
+0007c6b0: 2023 2323 2323 0d0a 2020 2020 2020 2020   #####..        
+0007c6c0: 2020 2020 2020 2020 6d6f 6465 6c36 203d          model6 =
+0007c6d0: 204c 6173 736f 4356 2861 6c70 6861 733d   LassoCV(alphas=
+0007c6e0: 6e70 2e6c 6f67 7370 6163 6528 2d35 2c2d  np.logspace(-5,-
+0007c6f0: 312c 3230 292c 2063 763d 7363 762c 7261  1,20), cv=scv,ra
+0007c700: 6e64 6f6d 5f73 7461 7465 3d73 6565 6429  ndom_state=seed)
+0007c710: 0d0a 2020 2020 2020 2020 2020 2020 2020  ..              
+0007c720: 2020 7265 7375 6c74 7320 3d20 6d6f 6465    results = mode
+0007c730: 6c36 2e66 6974 2858 5f74 7261 696e 2c79  l6.fit(X_train,y
+0007c740: 5f74 7261 696e 292e 7072 6564 6963 7428  _train).predict(
+0007c750: 585f 7465 7374 290d 0a20 2020 2020 2020  X_test)..       
+0007c760: 2020 2020 2020 2020 2065 7374 696d 6174           estimat
+0007c770: 6f72 732e 6170 7065 6e64 2828 274c 6173  ors.append(('Las
+0007c780: 736f 4356 2052 6567 756c 6172 697a 6174  soCV Regularizat
+0007c790: 696f 6e27 2c6d 6f64 656c 3629 290d 0a20  ion',model6)).. 
+0007c7a0: 2020 2020 2020 2020 2020 2020 2020 2065                 e
+0007c7b0: 7374 696d 6174 6f72 5f6c 656e 6774 682e  stimator_length.
+0007c7c0: 6170 7065 6e64 2831 290d 0a20 2020 2020  append(1)..     
+0007c7d0: 2020 2065 6c73 653a 0d0a 2020 2020 2020     else:..      
+0007c7e0: 2020 2020 2020 6e5f 636c 6173 7365 7320        n_classes 
+0007c7f0: 3d20 6c65 6e28 436f 756e 7465 7228 795f  = len(Counter(y_
+0007c800: 7472 6169 6e29 290d 0a20 2020 2020 2020  train))..       
+0007c810: 2020 2020 2069 6620 6e5f 636c 6173 7365       if n_classe
+0007c820: 7320 3e20 323a 0d0a 2020 2020 2020 2020  s > 2:..        
+0007c830: 2020 2020 2020 2020 2323 2323 2049 6e20          #### In 
+0007c840: 6d75 6c74 692d 636c 6173 7320 7365 7474  multi-class sett
+0007c850: 696e 672c 2069 7420 6d61 6b65 7320 7365  ing, it makes se
+0007c860: 6e73 6520 746f 2074 7572 6e20 6974 2069  nse to turn it i
+0007c870: 6e74 6f20 6269 6e61 7279 2063 6c61 7373  nto binary class
+0007c880: 2069 6e20 7374 6167 652d 310d 0a20 2020   in stage-1..   
+0007c890: 2020 2020 2020 2020 2020 2020 2023 2323               ###
+0007c8a0: 2320 496e 2073 7461 6765 2032 2c20 6120  # In stage 2, a 
+0007c8b0: 636f 6d70 6c65 7820 6d6f 6465 6c20 7769  complex model wi
+0007c8c0: 6c6c 2074 616b 6520 7468 6520 696e 7075  ll take the inpu
+0007c8d0: 7473 206f 6620 7468 6973 206d 6f64 656c  ts of this model
+0007c8e0: 2061 6e64 2074 7279 2074 6f20 7072 6564   and try to pred
+0007c8f0: 6963 740d 0a20 2020 2020 2020 2020 2020  ict..           
+0007c900: 2020 2020 2072 6172 655f 636c 6173 7320       rare_class 
+0007c910: 3d20 6669 6e64 5f72 6172 655f 636c 6173  = find_rare_clas
+0007c920: 7328 795f 7472 6169 6e29 0d0a 2020 2020  s(y_train)..    
+0007c930: 2020 2020 2020 2020 2020 2020 6966 2072              if r
+0007c940: 6172 655f 636c 6173 7320 3d3d 2030 3a0d  are_class == 0:.
+0007c950: 0a20 2020 2020 2020 2020 2020 2020 2020  .               
+0007c960: 2020 2020 206d 616a 6f72 6974 795f 636c       majority_cl
+0007c970: 6173 7320 3d20 310d 0a20 2020 2020 2020  ass = 1..       
+0007c980: 2020 2020 2020 2020 2065 6c73 653a 0d0a           else:..
+0007c990: 2020 2020 2020 2020 2020 2020 2020 2020                  
+0007c9a0: 2020 2020 6d61 6a6f 7269 7479 5f63 6c61      majority_cla
+0007c9b0: 7373 203d 2030 0d0a 2020 2020 2020 2020  ss = 0..        
+0007c9c0: 2020 2020 2020 2020 795f 7472 6169 6e20          y_train 
+0007c9d0: 3d20 795f 7472 6169 6e2e 6d61 7028 6c61  = y_train.map(la
+0007c9e0: 6d62 6461 2078 3a20 7261 7265 5f63 6c61  mbda x: rare_cla
+0007c9f0: 7373 2069 6620 783d 3d72 6172 655f 636c  ss if x==rare_cl
+0007ca00: 6173 7320 656c 7365 206d 616a 6f72 6974  ass else majorit
+0007ca10: 795f 636c 6173 7329 0d0a 2020 2020 2020  y_class)..      
+0007ca20: 2020 2020 2020 6966 2073 636f 7269 6e67        if scoring
+0007ca30: 203d 3d20 2727 3a0d 0a20 2020 2020 2020   == '':..       
+0007ca40: 2020 2020 2020 2020 2073 636f 7269 6e67           scoring
+0007ca50: 203d 2027 6163 6375 7261 6379 270d 0a20   = 'accuracy'.. 
+0007ca60: 2020 2020 2020 2020 2020 2073 6376 203d             scv =
+0007ca70: 2053 7472 6174 6966 6965 644b 466f 6c64   StratifiedKFold
+0007ca80: 286e 5f73 706c 6974 733d 464f 4c44 532c  (n_splits=FOLDS,
+0007ca90: 2072 616e 646f 6d5f 7374 6174 653d 7365   random_state=se
+0007caa0: 6564 2c20 7368 7566 666c 653d 5472 7565  ed, shuffle=True
+0007cab0: 290d 0a20 2020 2020 2020 2020 2020 2069  )..            i
+0007cac0: 6620 426f 6f73 7469 6e67 5f46 6c61 673a  f Boosting_Flag:
+0007cad0: 0d0a 2020 2020 2020 2020 2020 2020 2020  ..              
+0007cae0: 2020 2323 2323 2020 204c 696e 6561 7220    ####   Linear 
+0007caf0: 4d6f 6465 6c73 2069 6620 426f 6f73 7469  Models if Boosti
+0007cb00: 6e67 2069 7320 6368 6f73 656e 2023 2323  ng is chosen ###
+0007cb10: 2323 0d0a 2020 2020 2020 2020 2020 2020  ##..            
+0007cb20: 2020 2020 6d6f 6465 6c34 203d 204c 696e      model4 = Lin
+0007cb30: 6561 7244 6973 6372 696d 696e 616e 7441  earDiscriminantA
+0007cb40: 6e61 6c79 7369 7328 290d 0a20 2020 2020  nalysis()..     
+0007cb50: 2020 2020 2020 2020 2020 2072 6573 756c             resul
+0007cb60: 7473 203d 206d 6f64 656c 342e 6669 7428  ts = model4.fit(
+0007cb70: 585f 7472 6169 6e2c 795f 7472 6169 6e29  X_train,y_train)
+0007cb80: 2e70 7265 6469 6374 5f70 726f 6261 2858  .predict_proba(X
+0007cb90: 5f74 6573 7429 0d0a 2020 2020 2020 2020  _test)..        
+0007cba0: 2020 2020 2020 2020 6573 7469 6d61 746f          estimato
+0007cbb0: 7273 2e61 7070 656e 6428 2827 4c69 6e65  rs.append(('Line
+0007cbc0: 6172 2044 6973 6372 696d 696e 616e 7427  ar Discriminant'
+0007cbd0: 2c6d 6f64 656c 3429 290d 0a20 2020 2020  ,model4))..     
+0007cbe0: 2020 2020 2020 2020 2020 2065 7374 696d             estim
+0007cbf0: 6174 6f72 5f6c 656e 6774 682e 6170 7065  ator_length.appe
+0007cc00: 6e64 2872 6573 756c 7473 2e73 6861 7065  nd(results.shape
+0007cc10: 5b31 5d29 0d0a 2020 2020 2020 2020 2020  [1])..          
+0007cc20: 2020 656c 6966 2042 6f6f 7374 696e 675f    elif Boosting_
+0007cc30: 466c 6167 2069 7320 4e6f 6e65 3a0d 0a20  Flag is None:.. 
+0007cc40: 2020 2020 2020 2020 2020 2020 2020 2023                 #
+0007cc50: 2323 2320 2020 5472 6565 206d 6f64 656c  ###   Tree model
+0007cc60: 7320 6966 204c 696e 6561 7220 6368 6f73  s if Linear chos
+0007cc70: 656e 2023 2323 2323 0d0a 2020 2020 2020  en #####..      
+0007cc80: 2020 2020 2020 2020 2020 6d6f 6465 6c36            model6
+0007cc90: 203d 2044 6563 6973 696f 6e54 7265 6543   = DecisionTreeC
+0007cca0: 6c61 7373 6966 6965 7228 6d69 6e5f 7361  lassifier(min_sa
+0007ccb0: 6d70 6c65 735f 6c65 6166 3d32 290d 0a20  mples_leaf=2).. 
+0007ccc0: 2020 2020 2020 2020 2020 2020 2020 2072                 r
+0007ccd0: 6573 756c 7473 203d 206d 6f64 656c 362e  esults = model6.
+0007cce0: 6669 7428 585f 7472 6169 6e2c 795f 7472  fit(X_train,y_tr
+0007ccf0: 6169 6e29 2e70 7265 6469 6374 5f70 726f  ain).predict_pro
+0007cd00: 6261 2858 5f74 6573 7429 0d0a 2020 2020  ba(X_test)..    
+0007cd10: 2020 2020 2020 2020 2020 2020 6573 7469              esti
+0007cd20: 6d61 746f 7273 2e61 7070 656e 6428 2827  mators.append(('
+0007cd30: 4465 6369 7369 6f6e 2054 7265 6527 2c6d  Decision Tree',m
+0007cd40: 6f64 656c 3629 290d 0a20 2020 2020 2020  odel6))..       
+0007cd50: 2020 2020 2020 2020 2065 7374 696d 6174           estimat
+0007cd60: 6f72 5f6c 656e 6774 682e 6170 7065 6e64  or_length.append
+0007cd70: 2872 6573 756c 7473 2e73 6861 7065 5b31  (results.shape[1
+0007cd80: 5d29 0d0a 2020 2020 2020 2020 2020 2020  ])..            
+0007cd90: 656c 7365 3a0d 0a20 2020 2020 2020 2020  else:..         
+0007cda0: 2020 2020 2020 2023 2323 2323 2320 2020         ######   
+0007cdb0: 204e 6169 7665 2042 6179 6573 206d 6f64   Naive Bayes mod
+0007cdc0: 656c 7320 6966 2042 6167 6769 6e67 2069  els if Bagging i
+0007cdd0: 7320 6368 6f73 656e 2023 2323 230d 0a20  s chosen ####.. 
+0007cde0: 2020 2020 2020 2020 2020 2020 2020 2069                 i
+0007cdf0: 6620 6e5f 636c 6173 7365 7320 3c3d 2032  f n_classes <= 2
+0007ce00: 3a0d 0a20 2020 2020 2020 2020 2020 2020  :..             
+0007ce10: 2020 2020 2020 2074 7279 3a0d 0a20 2020         try:..   
+0007ce20: 2020 2020 2020 2020 2020 2020 2020 2020                  
+0007ce30: 2020 2020 206d 6f64 656c 3720 3d20 4761       model7 = Ga
+0007ce40: 7573 7369 616e 4e42 2829 0d0a 2020 2020  ussianNB()..    
+0007ce50: 2020 2020 2020 2020 2020 2020 2020 2020                  
+0007ce60: 6578 6365 7074 3a0d 0a20 2020 2020 2020  except:..       
+0007ce70: 2020 2020 2020 2020 2020 2020 2020 2020                  
+0007ce80: 206d 6f64 656c 3720 3d20 4465 6369 7369   model7 = Decisi
+0007ce90: 6f6e 5472 6565 436c 6173 7369 6669 6572  onTreeClassifier
+0007cea0: 286d 696e 5f73 616d 706c 6573 5f6c 6561  (min_samples_lea
+0007ceb0: 663d 3229 0d0a 2020 2020 2020 2020 2020  f=2)..          
+0007cec0: 2020 2020 2020 656c 7365 3a0d 0a20 2020        else:..   
+0007ced0: 2020 2020 2020 2020 2020 2020 2020 2020                  
+0007cee0: 2074 7279 3a0d 0a20 2020 2020 2020 2020   try:..         
+0007cef0: 2020 2020 2020 2020 2020 2020 2020 206d                 m
+0007cf00: 6f64 656c 3720 3d20 4d75 6c74 696e 6f6d  odel7 = Multinom
+0007cf10: 6961 6c4e 4228 290d 0a20 2020 2020 2020  ialNB()..       
+0007cf20: 2020 2020 2020 2020 2020 2020 2065 7863               exc
+0007cf30: 6570 743a 0d0a 2020 2020 2020 2020 2020  ept:..          
+0007cf40: 2020 2020 2020 2020 2020 2020 2020 6d6f                mo
+0007cf50: 6465 6c37 203d 2044 6563 6973 696f 6e54  del7 = DecisionT
+0007cf60: 7265 6543 6c61 7373 6966 6965 7228 6d69  reeClassifier(mi
+0007cf70: 6e5f 7361 6d70 6c65 735f 6c65 6166 3d32  n_samples_leaf=2
+0007cf80: 290d 0a20 2020 2020 2020 2020 2020 2020  )..             
+0007cf90: 2020 2072 6573 756c 7473 203d 206d 6f64     results = mod
+0007cfa0: 656c 372e 6669 7428 585f 7472 6169 6e2c  el7.fit(X_train,
+0007cfb0: 795f 7472 6169 6e29 2e70 7265 6469 6374  y_train).predict
+0007cfc0: 5f70 726f 6261 2858 5f74 6573 7429 0d0a  _proba(X_test)..
+0007cfd0: 2020 2020 2020 2020 2020 2020 2020 2020                  
+0007cfe0: 6573 7469 6d61 746f 7273 2e61 7070 656e  estimators.appen
+0007cff0: 6428 2827 4e61 6976 6520 4261 7965 7327  d(('Naive Bayes'
+0007d000: 2c6d 6f64 656c 3729 290d 0a20 2020 2020  ,model7))..     
+0007d010: 2020 2020 2020 2020 2020 2065 7374 696d             estim
+0007d020: 6174 6f72 5f6c 656e 6774 682e 6170 7065  ator_length.appe
+0007d030: 6e64 2872 6573 756c 7473 2e73 6861 7065  nd(results.shape
+0007d040: 5b31 5d29 0d0a 2020 2020 2373 7461 636b  [1])..    #stack
+0007d050: 7320 3d20 6e70 2e63 5f5b 7265 7375 6c74  s = np.c_[result
+0007d060: 7331 2c72 6573 756c 7473 322c 7265 7375  s1,results2,resu
+0007d070: 6c74 7333 5d0d 0a20 2020 2065 7374 696d  lts3]..    estim
+0007d080: 6174 6f72 735f 6c69 7374 203d 205b 2874  ators_list = [(t
+0007d090: 7570 6c65 735b 305d 2c74 7570 6c65 735b  uples[0],tuples[
+0007d0a0: 315d 2920 666f 7220 7475 706c 6573 2069  1]) for tuples i
+0007d0b0: 6e20 6573 7469 6d61 746f 7273 5d0d 0a20  n estimators].. 
+0007d0c0: 2020 2065 7374 696d 6174 6f72 5f6e 616d     estimator_nam
+0007d0d0: 6573 203d 205b 7475 706c 6573 5b30 5d20  es = [tuples[0] 
+0007d0e0: 666f 7220 7475 706c 6573 2069 6e20 6573  for tuples in es
+0007d0f0: 7469 6d61 746f 7273 5d0d 0a20 2020 2023  timators]..    #
+0007d100: 2323 2320 4865 7265 2069 7320 7768 6572  ### Here is wher
+0007d110: 6520 7765 2063 6f6e 736f 6c69 6461 7465  e we consolidate
+0007d120: 2074 6865 2065 7374 696d 6174 6f72 206e   the estimator n
+0007d130: 616d 6573 2061 6e64 2074 6865 6972 2072  ames and their r
+0007d140: 6573 756c 7473 2069 6e74 6f20 6f6e 6520  esults into one 
+0007d150: 636f 6d6d 6f6e 206c 6973 7420 2323 230d  common list ###.
+0007d160: 0a20 2020 206c 7320 3d20 5b5d 0d0a 2020  .    ls = []..  
+0007d170: 2020 666f 7220 782c 7920 696e 2064 6963    for x,y in dic
+0007d180: 7428 7a69 7028 6573 7469 6d61 746f 725f  t(zip(estimator_
+0007d190: 6e61 6d65 732c 6573 7469 6d61 746f 725f  names,estimator_
+0007d1a0: 6c65 6e67 7468 2929 2e69 7465 6d73 2829  length)).items()
+0007d1b0: 3a0d 0a20 2020 2020 2020 2065 6c73 203d  :..        els =
+0007d1c0: 205b 782b 275f 272b 7374 7228 6561 6368   [x+'_'+str(each
+0007d1d0: 7929 2066 6f72 2065 6163 6879 2069 6e20  y) for eachy in 
+0007d1e0: 7261 6e67 6528 7929 5d0d 0a20 2020 2020  range(y)]..     
+0007d1f0: 2020 206c 7320 2b3d 2065 6c73 0d0a 2020     ls += els..  
+0007d200: 2020 6966 2076 6572 626f 7365 203d 3d20    if verbose == 
+0007d210: 313a 0d0a 2020 2020 2020 2020 7072 696e  1:..        prin
+0007d220: 7428 2720 2020 2054 696d 6520 7461 6b65  t('    Time take
+0007d230: 6e20 666f 7220 5374 6163 6b69 6e67 3a20  n for Stacking: 
+0007d240: 2530 2e31 6620 7365 636f 6e64 7327 2025  %0.1f seconds' %
+0007d250: 2874 696d 652e 7469 6d65 2829 2d73 7461  (time.time()-sta
+0007d260: 7274 5f74 696d 6529 290d 0a20 2020 2072  rt_time))..    r
+0007d270: 6574 7572 6e20 6c73 2c20 7265 7375 6c74  eturn ls, result
+0007d280: 730d 0a23 2323 2323 2323 2323 2323 2323  s..#############
+0007d290: 2323 2323 2323 2323 2323 2323 2323 2323  ################
+0007d2a0: 2323 2323 2323 2323 2323 2323 2323 2323  ################
+0007d2b0: 2323 2323 2323 2323 2323 2323 0d0a 0000  ############....
+0007d2c0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+0007d2d0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+0007d2e0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+0007d2f0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+0007d300: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+0007d310: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+0007d320: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+0007d330: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+0007d340: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+0007d350: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+0007d360: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+0007d370: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+0007d380: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+0007d390: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+0007d3a0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+0007d3b0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+0007d3c0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+0007d3d0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+0007d3e0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+0007d3f0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+0007d400: 2e2f 2e2f 4050 6178 4865 6164 6572 0000  ././@PaxHeader..
+0007d410: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+0007d420: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+0007d430: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+0007d440: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+0007d450: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+0007d460: 0000 0000 3030 3030 3030 3000 3030 3030  ....0000000.0000
+0007d470: 3030 3000 3030 3030 3030 3000 3030 3030  000.0000000.0000
+0007d480: 3030 3030 3032 3600 3030 3030 3030 3030  0000026.00000000
+0007d490: 3030 3000 3031 3134 3533 0020 7800 0000  000.011453. x...
+0007d4a0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+0007d4b0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+0007d4c0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+0007d4d0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+0007d4e0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+0007d4f0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+0007d500: 0075 7374 6172 0030 3000 0000 0000 0000  .ustar.00.......
+0007d510: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+0007d520: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+0007d530: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+0007d540: 0000 0000 0000 0000 0030 3030 3030 3030  .........0000000
+0007d550: 0030 3030 3030 3030 0000 0000 0000 0000  .0000000........
+0007d560: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+0007d570: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+0007d580: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+0007d590: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+0007d5a0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+0007d5b0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+0007d5c0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+0007d5d0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+0007d5e0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+0007d5f0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+0007d600: 3232 206d 7469 6d65 3d31 3637 3831 3539  22 mtime=1678159
+0007d610: 3732 322e 300a 0000 0000 0000 0000 0000  722.0...........
+0007d620: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+0007d630: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+0007d640: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+0007d650: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+0007d660: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+0007d670: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+0007d680: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+0007d690: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+0007d6a0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+0007d6b0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+0007d6c0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+0007d6d0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+0007d6e0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+0007d6f0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+0007d700: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+0007d710: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+0007d720: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+0007d730: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+0007d740: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+0007d750: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+0007d760: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+0007d770: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+0007d780: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+0007d790: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+0007d7a0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+0007d7b0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+0007d7c0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+0007d7d0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+0007d7e0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+0007d7f0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+0007d800: 6175 746f 7669 6d6c 2d30 2e31 2e37 3135  autoviml-0.1.715
+0007d810: 2f61 7574 6f76 696d 6c2f 5472 616e 7366  /autoviml/Transf
+0007d820: 6f72 6d5f 4b4d 5f46 6561 7475 7265 732e  orm_KM_Features.
+0007d830: 7079 0000 0000 0000 0000 0000 0000 0000  py..............
+0007d840: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+0007d850: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+0007d860: 0000 0000 3030 3030 3737 3700 3030 3031  ....0000777.0001
+0007d870: 3735 3000 3030 3031 3735 3000 3030 3030  750.0001750.0000
+0007d880: 3030 3135 3332 3300 3030 3030 3030 3030  0015323.00000000
+0007d890: 3030 3000 3032 3135 3333 0020 3000 0000  000.021533. 0...
+0007d8a0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+0007d8b0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+0007d8c0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+0007d8d0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+0007d8e0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+0007d8f0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+0007d900: 0075 7374 6172 0030 3072 616d 0000 0000  .ustar.00ram....
+0007d910: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+0007d920: 0000 0000 0000 0000 0072 616d 0000 0000  .........ram....
+0007d930: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+0007d940: 0000 0000 0000 0000 0030 3030 3030 3030  .........0000000
+0007d950: 0030 3030 3030 3030 0000 0000 0000 0000  .0000000........
+0007d960: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+0007d970: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+0007d980: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+0007d990: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+0007d9a0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+0007d9b0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+0007d9c0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+0007d9d0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+0007d9e0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+0007d9f0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+0007da00: 696d 706f 7274 206e 756d 7079 2061 7320  import numpy as 
+0007da10: 6e70 0d0a 696d 706f 7274 2070 616e 6461  np..import panda
+0007da20: 7320 6173 2070 640d 0a66 726f 6d20 736b  s as pd..from sk
+0007da30: 6c65 6172 6e2e 636c 7573 7465 7220 696d  learn.cluster im
+0007da40: 706f 7274 204b 4d65 616e 730d 0a69 6d70  port KMeans..imp
+0007da50: 6f72 7420 736b 6c65 6172 6e0d 0a69 6d70  ort sklearn..imp
+0007da60: 6f72 7420 7363 6970 790d 0a0d 0a63 6c61  ort scipy....cla
+0007da70: 7373 204b 4d65 616e 7346 6561 7475 7269  ss KMeansFeaturi
+0007da80: 7a65 723a 0d0a 2020 2020 2222 2254 7261  zer:..    """Tra
+0007da90: 6e73 666f 726d 7320 6e75 6d65 7269 6320  nsforms numeric 
+0007daa0: 6461 7461 2069 6e74 6f20 6b2d 6d65 616e  data into k-mean
+0007dab0: 7320 636c 7573 7465 7220 6d65 6d62 6572  s cluster member
+0007dac0: 7368 6970 732e 0d0a 2020 2020 4672 6f6d  ships...    From
+0007dad0: 2074 6865 2046 6561 7475 7265 2045 6e67   the Feature Eng
+0007dae0: 696e 6565 7269 6e67 2042 6f6f 6b20 6279  ineering Book by
+0007daf0: 2041 6c69 6365 205a 6865 6e67 0d0a 2020   Alice Zheng..  
+0007db00: 2020 6874 7470 733a 2f2f 6769 7468 7562    https://github
+0007db10: 2e63 6f6d 2f61 6c69 6365 7a68 656e 672f  .com/alicezheng/
+0007db20: 6665 6174 7572 652d 656e 6769 6e65 6572  feature-engineer
+0007db30: 696e 672d 626f 6f6b 2f62 6c6f 622f 6d61  ing-book/blob/ma
+0007db40: 7374 6572 2f6b 6d65 616e 735f 6665 6174  ster/kmeans_feat
+0007db50: 7572 697a 6572 2e70 790d 0a20 2020 2054  urizer.py..    T
+0007db60: 6869 7320 7472 616e 7366 6f72 6d65 7220  his transformer 
+0007db70: 7275 6e73 206b 2d6d 6561 6e73 206f 6e20  runs k-means on 
+0007db80: 7468 6520 696e 7075 7420 6461 7461 2061  the input data a
+0007db90: 6e64 2063 6f6e 7665 7274 7320 6561 6368  nd converts each
+0007dba0: 2064 6174 6120 706f 696e 740d 0a20 2020   data point..   
+0007dbb0: 2069 6e74 6f20 7468 6520 6964 206f 6620   into the id of 
+0007dbc0: 7468 6520 636c 6f73 6573 7420 636c 7573  the closest clus
+0007dbd0: 7465 722e 2049 6620 6120 7461 7267 6574  ter. If a target
+0007dbe0: 2076 6172 6961 626c 6520 6973 2070 7265   variable is pre
+0007dbf0: 7365 6e74 2c20 6974 2069 730d 0a20 2020  sent, it is..   
+0007dc00: 2073 6361 6c65 6420 616e 6420 696e 636c   scaled and incl
+0007dc10: 7564 6564 2061 7320 696e 7075 7420 746f  uded as input to
+0007dc20: 206b 2d6d 6561 6e73 2069 6e20 6f72 6465   k-means in orde
+0007dc30: 7220 746f 2064 6572 6976 6520 636c 7573  r to derive clus
+0007dc40: 7465 7273 2074 6861 740d 0a20 2020 206f  ters that..    o
+0007dc50: 6265 7920 7468 6520 636c 6173 7369 6669  bey the classifi
+0007dc60: 6361 7469 6f6e 2062 6f75 6e64 6172 7920  cation boundary 
+0007dc70: 6173 2077 656c 6c20 6173 2067 726f 7570  as well as group
+0007dc80: 2073 696d 696c 6172 2070 6f69 6e74 7320   similar points 
+0007dc90: 746f 6765 7468 6572 2e0d 0a20 2020 2050  together...    P
+0007dca0: 6172 616d 6574 6572 730d 0a20 2020 202d  arameters..    -
+0007dcb0: 2d2d 2d2d 2d2d 2d2d 2d0d 0a20 2020 206b  ---------..    k
+0007dcc0: 3a20 696e 7465 6765 722c 206f 7074 696f  : integer, optio
+0007dcd0: 6e61 6c2c 2064 6566 6175 6c74 2031 3030  nal, default 100
+0007dce0: 0d0a 2020 2020 2020 2020 5468 6520 6e75  ..        The nu
+0007dcf0: 6d62 6572 206f 6620 636c 7573 7465 7273  mber of clusters
+0007dd00: 2074 6f20 6772 6f75 7020 6461 7461 2069   to group data i
+0007dd10: 6e74 6f2e 0d0a 2020 2020 7461 7267 6574  nto...    target
+0007dd20: 5f73 6361 6c65 3a20 666c 6f61 742c 205b  _scale: float, [
+0007dd30: 302c 2069 6e66 7479 5d2c 206f 7074 696f  0, infty], optio
+0007dd40: 6e61 6c2c 2064 6566 6175 6c74 2035 2e30  nal, default 5.0
+0007dd50: 0d0a 2020 2020 2020 2020 5468 6520 7363  ..        The sc
+0007dd60: 616c 696e 6720 6661 6374 6f72 2066 6f72  aling factor for
+0007dd70: 2074 6865 2074 6172 6765 7420 7661 7269   the target vari
+0007dd80: 6162 6c65 2e20 5365 7420 7468 6973 2074  able. Set this t
+0007dd90: 6f20 7a65 726f 2074 6f20 6967 6e6f 7265  o zero to ignore
+0007dda0: 0d0a 2020 2020 2020 2020 7468 6520 7461  ..        the ta
+0007ddb0: 7267 6574 2e20 466f 7220 636c 6173 7369  rget. For classi
+0007ddc0: 6669 6361 7469 6f6e 2070 726f 626c 656d  fication problem
+0007ddd0: 732c 206c 6172 6765 7220 6074 6172 6765  s, larger `targe
+0007dde0: 745f 7363 616c 6560 2076 616c 7565 730d  t_scale` values.
+0007ddf0: 0a20 2020 2020 2020 2077 696c 6c20 7072  .        will pr
+0007de00: 6f64 7563 6520 636c 7573 7465 7273 2074  oduce clusters t
+0007de10: 6861 7420 6265 7474 6572 2072 6573 7065  hat better respe
+0007de20: 6374 2074 6865 2063 6c61 7373 2062 6f75  ct the class bou
+0007de30: 6e64 6172 792e 0d0a 2020 2020 7261 6e64  ndary...    rand
+0007de40: 6f6d 5f73 7461 7465 203a 2069 6e74 6567  om_state : integ
+0007de50: 6572 206f 7220 6e75 6d70 792e 5261 6e64  er or numpy.Rand
+0007de60: 6f6d 5374 6174 652c 206f 7074 696f 6e61  omState, optiona
+0007de70: 6c0d 0a20 2020 2020 2020 2054 6869 7320  l..        This 
+0007de80: 6973 2070 6173 7365 6420 746f 206b 2d6d  is passed to k-m
+0007de90: 6561 6e73 2061 7320 7468 6520 6765 6e65  eans as the gene
+0007dea0: 7261 746f 7220 7573 6564 2074 6f20 696e  rator used to in
+0007deb0: 6974 6961 6c69 7a65 2074 6865 0d0a 2020  itialize the..  
+0007dec0: 2020 2020 2020 6b6d 6561 6e73 2063 656e        kmeans cen
+0007ded0: 7465 7273 2e20 4966 2061 6e20 696e 7465  ters. If an inte
+0007dee0: 6765 7220 6973 2067 6976 656e 2c20 6974  ger is given, it
+0007def0: 2066 6978 6573 2074 6865 2073 6565 642e   fixes the seed.
+0007df00: 2044 6566 6175 6c74 7320 746f 0d0a 2020   Defaults to..  
+0007df10: 2020 2020 2020 7468 6520 676c 6f62 616c        the global
+0007df20: 206e 756d 7079 2072 616e 646f 6d20 6e75   numpy random nu
+0007df30: 6d62 6572 2067 656e 6572 6174 6f72 2e0d  mber generator..
+0007df40: 0a20 2020 2041 7474 7269 6275 7465 730d  .    Attributes.
+0007df50: 0a20 2020 202d 2d2d 2d2d 2d2d 2d2d 2d0d  .    ----------.
+0007df60: 0a20 2020 2063 6c75 7374 6572 5f63 656e  .    cluster_cen
+0007df70: 7465 7273 5f20 3a20 6172 7261 792c 205b  ters_ : array, [
+0007df80: 6b2c 206e 5f66 6561 7475 7265 735d 0d0a  k, n_features]..
+0007df90: 2020 2020 2020 2020 436f 6f72 6469 6e61          Coordina
+0007dfa0: 7465 7320 6f66 2063 6c75 7374 6572 2063  tes of cluster c
+0007dfb0: 656e 7465 7273 2e20 6e5f 6665 6174 7572  enters. n_featur
+0007dfc0: 6573 2064 6f65 7320 636f 756e 7420 7468  es does count th
+0007dfd0: 6520 7461 7267 6574 2063 6f6c 756d 6e2e  e target column.
+0007dfe0: 0d0a 2020 2020 2222 220d 0a0d 0a20 2020  ..    """....   
+0007dff0: 2064 6566 205f 5f69 6e69 745f 5f28 7365   def __init__(se
+0007e000: 6c66 2c20 6b3d 3130 302c 2074 6172 6765  lf, k=100, targe
+0007e010: 745f 7363 616c 653d 352e 302c 2072 616e  t_scale=5.0, ran
+0007e020: 646f 6d5f 7374 6174 653d 4e6f 6e65 293a  dom_state=None):
+0007e030: 0d0a 2020 2020 2020 2020 7365 6c66 2e6b  ..        self.k
+0007e040: 203d 206b 0d0a 2020 2020 2020 2020 7365   = k..        se
+0007e050: 6c66 2e74 6172 6765 745f 7363 616c 6520  lf.target_scale 
+0007e060: 3d20 7461 7267 6574 5f73 6361 6c65 0d0a  = target_scale..
+0007e070: 2020 2020 2020 2020 7365 6c66 2e72 616e          self.ran
+0007e080: 646f 6d5f 7374 6174 6520 3d20 7261 6e64  dom_state = rand
+0007e090: 6f6d 5f73 7461 7465 0d0a 0d0a 2020 2020  om_state....    
+0007e0a0: 6465 6620 6669 7428 7365 6c66 2c20 582c  def fit(self, X,
+0007e0b0: 2079 3d4e 6f6e 6529 3a0d 0a20 2020 2020   y=None):..     
+0007e0c0: 2020 2022 2222 5275 6e73 206b 2d6d 6561     """Runs k-mea
+0007e0d0: 6e73 206f 6e20 7468 6520 696e 7075 7420  ns on the input 
+0007e0e0: 6461 7461 2061 6e64 2066 696e 6420 6365  data and find ce
+0007e0f0: 6e74 726f 6964 732e 0d0a 2020 2020 2020  ntroids...      
+0007e100: 2020 4966 206e 6f20 7461 7267 6574 2069    If no target i
+0007e110: 7320 6769 7665 6e20 2860 7960 2069 7320  s given (`y` is 
+0007e120: 4e6f 6e65 2920 7468 656e 2072 756e 2076  None) then run v
+0007e130: 616e 696c 6c61 206b 2d6d 6561 6e73 206f  anilla k-means o
+0007e140: 6e20 696e 7075 740d 0a20 2020 2020 2020  n input..       
+0007e150: 2060 5860 2e0d 0a20 2020 2020 2020 2049   `X`...        I
+0007e160: 6620 7461 7267 6574 2060 7960 2069 7320  f target `y` is 
+0007e170: 6769 7665 6e2c 2074 6865 6e20 696e 636c  given, then incl
+0007e180: 7564 6520 7468 6520 7461 7267 6574 2028  ude the target (
+0007e190: 7765 6967 6874 6564 2062 790d 0a20 2020  weighted by..   
+0007e1a0: 2020 2020 2060 7461 7267 6574 5f73 6361       `target_sca
+0007e1b0: 6c65 6029 2061 7320 616e 2065 7874 7261  le`) as an extra
+0007e1c0: 2064 696d 656e 7369 6f6e 2066 6f72 206b   dimension for k
+0007e1d0: 2d6d 6561 6e73 2063 6c75 7374 6572 696e  -means clusterin
+0007e1e0: 672e 2049 6e20 7468 6973 0d0a 2020 2020  g. In this..    
+0007e1f0: 2020 2020 6361 7365 2c20 7275 6e20 6b2d      case, run k-
+0007e200: 6d65 616e 7320 7477 6963 652c 2066 6972  means twice, fir
+0007e210: 7374 2077 6974 6820 7468 6520 7461 7267  st with the targ
+0007e220: 6574 2c20 7468 656e 2061 6e20 6578 7472  et, then an extr
+0007e230: 6120 6974 6572 6174 696f 6e0d 0a20 2020  a iteration..   
+0007e240: 2020 2020 2077 6974 686f 7574 2e0d 0a20       without... 
+0007e250: 2020 2020 2020 2041 6674 6572 2066 6974         After fit
+0007e260: 7469 6e67 2c20 7468 6520 6174 7472 6962  ting, the attrib
+0007e270: 7574 6520 6063 6c75 7374 6572 5f63 656e  ute `cluster_cen
+0007e280: 7465 7273 5f60 2061 7265 2073 6574 2074  ters_` are set t
+0007e290: 6f20 7468 6520 6b2d 6d65 616e 730d 0a20  o the k-means.. 
+0007e2a0: 2020 2020 2020 2063 656e 7472 6f69 6473         centroids
+0007e2b0: 2069 6e20 7468 6520 696e 7075 7420 7370   in the input sp
+0007e2c0: 6163 6520 7265 7072 6573 656e 7465 6420  ace represented 
+0007e2d0: 6279 2060 5860 2e0d 0a20 2020 2020 2020  by `X`...       
+0007e2e0: 2050 6172 616d 6574 6572 730d 0a20 2020   Parameters..   
+0007e2f0: 2020 2020 202d 2d2d 2d2d 2d2d 2d2d 2d0d       ----------.
+0007e300: 0a20 2020 2020 2020 2058 203a 2061 7272  .        X : arr
+0007e310: 6179 2d6c 696b 6520 6f72 2073 7061 7273  ay-like or spars
+0007e320: 6520 6d61 7472 6978 2c20 7368 6170 653d  e matrix, shape=
+0007e330: 286e 5f64 6174 615f 706f 696e 7473 2c20  (n_data_points, 
+0007e340: 6e5f 6665 6174 7572 6573 290d 0a20 2020  n_features)..   
+0007e350: 2020 2020 2079 203a 2076 6563 746f 7220       y : vector 
+0007e360: 6f66 206c 656e 6774 6820 6e5f 6461 7461  of length n_data
+0007e370: 5f70 6f69 6e74 732c 206f 7074 696f 6e61  _points, optiona
+0007e380: 6c2c 2064 6566 6175 6c74 204e 6f6e 650d  l, default None.
+0007e390: 0a20 2020 2020 2020 2020 2020 2049 6620  .            If 
+0007e3a0: 7072 6f76 6964 6564 2c20 7769 6c6c 2062  provided, will b
+0007e3b0: 6520 7765 6967 6874 6564 2077 6974 6820  e weighted with 
+0007e3c0: 6074 6172 6765 745f 7363 616c 6560 2061  `target_scale` a
+0007e3d0: 6e64 2069 6e63 6c75 6465 6420 696e 0d0a  nd included in..
+0007e3e0: 2020 2020 2020 2020 2020 2020 6b2d 6d65              k-me
+0007e3f0: 616e 7320 636c 7573 7465 7269 6e67 2061  ans clustering a
+0007e400: 7320 6869 6e74 2e0d 0a20 2020 2020 2020  s hint...       
+0007e410: 2022 2222 0d0a 2020 2020 2020 2020 6e5f   """..        n_
+0007e420: 6665 6174 7572 6573 203d 2058 2e73 6861  features = X.sha
+0007e430: 7065 5b31 5d0d 0a20 2020 2020 2020 2069  pe[1]..        i
+0007e440: 6620 7920 6973 204e 6f6e 653a 0d0a 2020  f y is None:..  
+0007e450: 2020 2020 2020 2020 2020 2320 4e6f 2074            # No t
+0007e460: 6172 6765 7420 7661 7269 6162 6c65 2c20  arget variable, 
+0007e470: 6a75 7374 2064 6f20 706c 6169 6e20 6b2d  just do plain k-
+0007e480: 6d65 616e 730d 0a20 2020 2020 2020 2020  means..         
+0007e490: 2020 206b 6d5f 6d6f 6465 6c20 3d20 4b4d     km_model = KM
+0007e4a0: 6561 6e73 286e 5f63 6c75 7374 6572 733d  eans(n_clusters=
+0007e4b0: 7365 6c66 2e6b 2c0d 0a20 2020 2020 2020  self.k,..       
+0007e4c0: 2020 2020 2020 2020 2020 2020 2020 2020                  
+0007e4d0: 2020 2020 2020 2020 2020 206e 5f69 6e69             n_ini
+0007e4e0: 743d 3230 2c0d 0a20 2020 2020 2020 2020  t=20,..         
+0007e4f0: 2020 2020 2020 2020 2020 2020 2020 2020                  
+0007e500: 2020 2020 2020 2020 2072 616e 646f 6d5f           random_
+0007e510: 7374 6174 653d 7365 6c66 2e72 616e 646f  state=self.rando
+0007e520: 6d5f 7374 6174 6529 0d0a 2020 2020 2020  m_state)..      
+0007e530: 2020 2020 2020 6b6d 5f6d 6f64 656c 2e66        km_model.f
+0007e540: 6974 2858 290d 0a0d 0a20 2020 2020 2020  it(X)....       
+0007e550: 2020 2020 2073 656c 662e 6b6d 5f6d 6f64       self.km_mod
+0007e560: 656c 5f20 3d20 6b6d 5f6d 6f64 656c 0d0a  el_ = km_model..
+0007e570: 2020 2020 2020 2020 2020 2020 7365 6c66              self
+0007e580: 2e63 6c75 7374 6572 5f63 656e 7465 7273  .cluster_centers
+0007e590: 5f20 3d20 6b6d 5f6d 6f64 656c 2e63 6c75  _ = km_model.clu
+0007e5a0: 7374 6572 5f63 656e 7465 7273 5f0d 0a20  ster_centers_.. 
+0007e5b0: 2020 2020 2020 2020 2020 2072 6574 7572             retur
+0007e5c0: 6e20 7365 6c66 0d0a 0d0a 2020 2020 2020  n self....      
+0007e5d0: 2020 2320 5468 6572 6520 6973 2074 6172    # There is tar
+0007e5e0: 6765 7420 696e 666f 726d 6174 696f 6e2e  get information.
+0007e5f0: 2041 7070 6c79 2061 7070 726f 7072 6961   Apply appropria
+0007e600: 7465 2073 6361 6c69 6e67 2061 6e64 2069  te scaling and i
+0007e610: 6e63 6c75 6465 0d0a 2020 2020 2020 2020  nclude..        
+0007e620: 2320 696e 746f 2069 6e70 7574 2064 6174  # into input dat
+0007e630: 6120 746f 206b 2d6d 6561 6e73 0d0a 2020  a to k-means..  
+0007e640: 2020 2020 2020 6461 7461 5f77 6974 685f        data_with_
+0007e650: 7461 7267 6574 203d 206e 702e 6873 7461  target = np.hsta
+0007e660: 636b 2828 582c 2079 5b3a 2c6e 702e 6e65  ck((X, y[:,np.ne
+0007e670: 7761 7869 735d 2a73 656c 662e 7461 7267  waxis]*self.targ
+0007e680: 6574 5f73 6361 6c65 2929 0d0a 0d0a 2020  et_scale))....  
+0007e690: 2020 2020 2020 2320 4275 696c 6420 6120        # Build a 
+0007e6a0: 7072 652d 7472 6169 6e69 6e67 206b 2d6d  pre-training k-m
+0007e6b0: 6561 6e73 206d 6f64 656c 206f 6e20 6461  eans model on da
+0007e6c0: 7461 2061 6e64 2074 6172 6765 740d 0a20  ta and target.. 
+0007e6d0: 2020 2020 2020 206b 6d5f 6d6f 6465 6c5f         km_model_
+0007e6e0: 7072 6574 7261 696e 203d 204b 4d65 616e  pretrain = KMean
+0007e6f0: 7328 6e5f 636c 7573 7465 7273 3d73 656c  s(n_clusters=sel
+0007e700: 662e 6b2c 0d0a 2020 2020 2020 2020 2020  f.k,..          
+0007e710: 2020 2020 2020 2020 2020 2020 2020 2020                  
+0007e720: 2020 2020 2020 2020 206e 5f69 6e69 743d           n_init=
+0007e730: 3230 2c0d 0a20 2020 2020 2020 2020 2020  20,..           
+0007e740: 2020 2020 2020 2020 2020 2020 2020 2020                  
+0007e750: 2020 2020 2020 2020 7261 6e64 6f6d 5f73          random_s
+0007e760: 7461 7465 3d73 656c 662e 7261 6e64 6f6d  tate=self.random
+0007e770: 5f73 7461 7465 290d 0a20 2020 2020 2020  _state)..       
+0007e780: 206b 6d5f 6d6f 6465 6c5f 7072 6574 7261   km_model_pretra
+0007e790: 696e 2e66 6974 2864 6174 615f 7769 7468  in.fit(data_with
+0007e7a0: 5f74 6172 6765 7429 0d0a 0d0a 2020 2020  _target)....    
+0007e7b0: 2020 2020 2320 5275 6e20 6b2d 6d65 616e      # Run k-mean
+0007e7c0: 7320 6120 7365 636f 6e64 2074 696d 6520  s a second time 
+0007e7d0: 746f 2067 6574 2074 6865 2063 6c75 7374  to get the clust
+0007e7e0: 6572 7320 696e 2074 6865 206f 7269 6769  ers in the origi
+0007e7f0: 6e61 6c20 7370 6163 650d 0a20 2020 2020  nal space..     
+0007e800: 2020 2023 2077 6974 686f 7574 2074 6172     # without tar
+0007e810: 6765 7420 696e 666f 2e20 496e 6974 6961  get info. Initia
+0007e820: 6c69 7a65 2075 7369 6e67 2063 656e 7472  lize using centr
+0007e830: 6f69 6473 2066 6f75 6e64 2069 6e20 7072  oids found in pr
+0007e840: 652d 7472 6169 6e69 6e67 2e0d 0a20 2020  e-training...   
+0007e850: 2020 2020 2023 2047 6f20 7468 726f 7567       # Go throug
+0007e860: 6820 6120 7369 6e67 6c65 2069 7465 7261  h a single itera
+0007e870: 7469 6f6e 206f 6620 636c 7573 7465 7220  tion of cluster 
+0007e880: 6173 7369 676e 6d65 6e74 2061 6e64 2063  assignment and c
+0007e890: 656e 7472 6f69 640d 0a20 2020 2020 2020  entroid..       
+0007e8a0: 2023 2072 6563 6f6d 7075 7461 7469 6f6e   # recomputation
+0007e8b0: 2e0d 0a20 2020 2020 2020 206b 6d5f 6d6f  ...        km_mo
+0007e8c0: 6465 6c20 3d20 4b4d 6561 6e73 286e 5f63  del = KMeans(n_c
+0007e8d0: 6c75 7374 6572 733d 7365 6c66 2e6b 2c0d  lusters=self.k,.
+0007e8e0: 0a20 2020 2020 2020 2020 2020 2020 2020  .               
+0007e8f0: 2020 2020 2020 2020 2020 2069 6e69 743d             init=
+0007e900: 6b6d 5f6d 6f64 656c 5f70 7265 7472 6169  km_model_pretrai
+0007e910: 6e2e 636c 7573 7465 725f 6365 6e74 6572  n.cluster_center
+0007e920: 735f 5b3a 2c3a 6e5f 6665 6174 7572 6573  s_[:,:n_features
+0007e930: 5d2c 0d0a 2020 2020 2020 2020 2020 2020  ],..            
+0007e940: 2020 2020 2020 2020 2020 2020 2020 6e5f                n_
+0007e950: 696e 6974 3d31 2c0d 0a20 2020 2020 2020  init=1,..       
+0007e960: 2020 2020 2020 2020 2020 2020 2020 2020                  
+0007e970: 2020 206d 6178 5f69 7465 723d 3129 0d0a     max_iter=1)..
+0007e980: 2020 2020 2020 2020 6b6d 5f6d 6f64 656c          km_model
+0007e990: 2e66 6974 2858 290d 0a0d 0a20 2020 2020  .fit(X)....     
+0007e9a0: 2020 2073 656c 662e 6b6d 5f6d 6f64 656c     self.km_model
+0007e9b0: 203d 206b 6d5f 6d6f 6465 6c0d 0a20 2020   = km_model..   
+0007e9c0: 2020 2020 2073 656c 662e 636c 7573 7465       self.cluste
+0007e9d0: 725f 6365 6e74 6572 735f 203d 206b 6d5f  r_centers_ = km_
+0007e9e0: 6d6f 6465 6c2e 636c 7573 7465 725f 6365  model.cluster_ce
+0007e9f0: 6e74 6572 735f 0d0a 2020 2020 2020 2020  nters_..        
+0007ea00: 7265 7475 726e 2073 656c 660d 0a0d 0a20  return self.... 
+0007ea10: 2020 2064 6566 2074 7261 6e73 666f 726d     def transform
+0007ea20: 2873 656c 662c 2058 2c20 793d 4e6f 6e65  (self, X, y=None
+0007ea30: 293a 0d0a 2020 2020 2020 2020 2222 224f  ):..        """O
+0007ea40: 7574 7075 7420 7468 6520 636c 6f73 6573  utput the closes
+0007ea50: 7420 636c 7573 7465 7220 6964 2066 6f72  t cluster id for
+0007ea60: 2065 6163 6820 696e 7075 7420 6461 7461   each input data
+0007ea70: 2070 6f69 6e74 2e0d 0a20 2020 2020 2020   point...       
+0007ea80: 2050 6172 616d 6574 6572 730d 0a20 2020   Parameters..   
+0007ea90: 2020 2020 202d 2d2d 2d2d 2d2d 2d2d 2d0d       ----------.
+0007eaa0: 0a20 2020 2020 2020 2058 203a 2061 7272  .        X : arr
+0007eab0: 6179 2d6c 696b 6520 6f72 2073 7061 7273  ay-like or spars
+0007eac0: 6520 6d61 7472 6978 2c20 7368 6170 653d  e matrix, shape=
+0007ead0: 286e 5f64 6174 615f 706f 696e 7473 2c20  (n_data_points, 
+0007eae0: 6e5f 6665 6174 7572 6573 290d 0a20 2020  n_features)..   
+0007eaf0: 2020 2020 2079 203a 2076 6563 746f 7220       y : vector 
+0007eb00: 6f66 206c 656e 6774 6820 6e5f 6461 7461  of length n_data
+0007eb10: 5f70 6f69 6e74 732c 206f 7074 696f 6e61  _points, optiona
+0007eb20: 6c2c 2064 6566 6175 6c74 204e 6f6e 650d  l, default None.
+0007eb30: 0a20 2020 2020 2020 2020 2020 2054 6172  .            Tar
+0007eb40: 6765 7420 7665 6374 6f72 2069 7320 6967  get vector is ig
+0007eb50: 6e6f 7265 6420 6576 656e 2069 6620 7072  nored even if pr
+0007eb60: 6f76 6964 6564 2e0d 0a20 2020 2020 2020  ovided...       
+0007eb70: 2052 6574 7572 6e73 0d0a 2020 2020 2020   Returns..      
+0007eb80: 2020 2d2d 2d2d 2d2d 2d0d 0a20 2020 2020    -------..     
+0007eb90: 2020 2063 6c75 7374 6572 5f69 6473 203a     cluster_ids :
+0007eba0: 2061 7272 6179 2c20 7368 6170 655b 6e5f   array, shape[n_
+0007ebb0: 6461 7461 5f70 6f69 6e74 732c 315d 0d0a  data_points,1]..
+0007ebc0: 2020 2020 2020 2020 2222 220d 0a20 2020          """..   
+0007ebd0: 2020 2020 2063 6c75 7374 6572 7320 3d20       clusters = 
+0007ebe0: 7365 6c66 2e6b 6d5f 6d6f 6465 6c2e 7072  self.km_model.pr
+0007ebf0: 6564 6963 7428 5829 0d0a 2020 2020 2020  edict(X)..      
+0007ec00: 2020 7265 7475 726e 2063 6c75 7374 6572    return cluster
+0007ec10: 735b 3a2c 6e70 2e6e 6577 6178 6973 5d0d  s[:,np.newaxis].
+0007ec20: 0a0d 0a20 2020 2064 6566 2066 6974 5f74  ...    def fit_t
+0007ec30: 7261 6e73 666f 726d 2873 656c 662c 2058  ransform(self, X
+0007ec40: 2c20 793d 4e6f 6e65 293a 0d0a 2020 2020  , y=None):..    
+0007ec50: 2020 2020 2222 2252 756e 7320 6669 7420      """Runs fit 
+0007ec60: 666f 6c6c 6f77 6564 2062 7920 7472 616e  followed by tran
+0007ec70: 7366 6f72 6d2e 0d0a 2020 2020 2020 2020  sform...        
+0007ec80: 2222 220d 0a20 2020 2020 2020 2073 656c  """..        sel
+0007ec90: 662e 6669 7428 582c 2079 290d 0a20 2020  f.fit(X, y)..   
+0007eca0: 2020 2020 2072 6574 7572 6e20 7365 6c66       return self
+0007ecb0: 2e74 7261 6e73 666f 726d 2858 2c20 7929  .transform(X, y)
+0007ecc0: 0d0a 0d0a 0d0a 6672 6f6d 2063 6f6c 6c65  ......from colle
+0007ecd0: 6374 696f 6e73 2069 6d70 6f72 7420 6465  ctions import de
+0007ece0: 6661 756c 7464 6963 740d 0a69 6d70 6f72  faultdict..impor
+0007ecf0: 7420 6f70 6572 6174 6f72 0d0a 696d 706f  t operator..impo
+0007ed00: 7274 2070 6462 0d0a 696d 706f 7274 2063  rt pdb..import c
+0007ed10: 6f70 790d 0a66 726f 6d20 736b 6c65 6172  opy..from sklear
+0007ed20: 6e2e 6d6f 6465 6c5f 7365 6c65 6374 696f  n.model_selectio
+0007ed30: 6e20 696d 706f 7274 2074 7261 696e 5f74  n import train_t
+0007ed40: 6573 745f 7370 6c69 740d 0a64 6566 2054  est_split..def T
+0007ed50: 7261 6e73 666f 726d 5f4b 4d5f 4665 6174  ransform_KM_Feat
+0007ed60: 7572 6573 2874 7261 696e 696e 675f 6461  ures(training_da
+0007ed70: 7461 2c20 7472 6169 6e69 6e67 5f6c 6162  ta, training_lab
+0007ed80: 656c 732c 2074 6573 745f 6461 7461 2c20  els, test_data, 
+0007ed90: 6b6d 5f6d 6178 3d30 293a 0d0a 2020 2020  km_max=0):..    
+0007eda0: 7365 6564 203d 2039 390d 0a20 2020 2070  seed = 99..    p
+0007edb0: 7265 6473 203d 206c 6973 7428 7472 6169  reds = list(trai
+0007edc0: 6e69 6e67 5f64 6174 6129 0d0a 2020 2020  ning_data)..    
+0007edd0: 7461 7267 6574 203d 2074 7261 696e 696e  target = trainin
+0007ede0: 675f 6c61 6265 6c73 2e6e 616d 650d 0a20  g_labels.name.. 
+0007edf0: 2020 2074 7261 696e 5f69 6e64 6578 203d     train_index =
+0007ee00: 2020 7472 6169 6e69 6e67 5f64 6174 612e    training_data.
+0007ee10: 696e 6465 780d 0a20 2020 2074 6573 745f  index..    test_
+0007ee20: 696e 6465 7820 3d20 2074 6573 745f 6461  index =  test_da
+0007ee30: 7461 2e69 6e64 6578 0d0a 2020 2020 6966  ta.index..    if
+0007ee40: 206b 6d5f 6d61 7820 3c3d 2032 3a0d 0a20   km_max <= 2:.. 
+0007ee50: 2020 2020 2020 206b 5f6d 6178 203d 2032         k_max = 2
+0007ee60: 0d0a 2020 2020 656c 7365 3a0d 0a20 2020  ..    else:..   
+0007ee70: 2020 2020 206b 5f6d 6178 203d 2063 6f70       k_max = cop
+0007ee80: 792e 6465 6570 636f 7079 286b 6d5f 6d61  y.deepcopy(km_ma
+0007ee90: 7829 0d0a 2020 2020 2323 2320 4361 6c63  x)..    ### Calc
+0007eea0: 756c 6174 6520 7468 6520 7461 7267 6574  ulate the target
+0007eeb0: 2073 6361 6c65 2068 6572 6520 3d3e 2074   scale here => t
+0007eec0: 6865 2068 6967 6865 7220 7468 6520 6e75  he higher the nu
+0007eed0: 6d62 6572 2074 6865 2062 6574 7465 7220  mber the better 
+0007eee0: 666f 7220 7461 7267 6574 2061 6363 7572  for target accur
+0007eef0: 6163 790d 0a20 2020 2074 7279 3a0d 0a20  acy..    try:.. 
+0007ef00: 2020 2020 2020 2069 6620 7472 6169 6e69         if traini
+0007ef10: 6e67 5f6c 6162 656c 732e 6474 7970 6520  ng_labels.dtype 
+0007ef20: 696e 205b 6e70 2e66 6c6f 6174 3634 2c6e  in [np.float64,n
+0007ef30: 702e 666c 6f61 7433 322c 6e70 2e66 6c6f  p.float32,np.flo
+0007ef40: 6174 3136 5d3a 0d0a 2020 2020 2020 2020  at16]:..        
+0007ef50: 2020 2020 7461 7267 6574 5f72 616e 6765      target_range
+0007ef60: 203d 2066 6c6f 6174 2861 6273 2874 7261   = float(abs(tra
+0007ef70: 696e 696e 675f 6c61 6265 6c73 2e6d 6178  ining_labels.max
+0007ef80: 2829 202d 2074 7261 696e 696e 675f 6c61  () - training_la
+0007ef90: 6265 6c73 2e6d 696e 2829 2929 0d0a 2020  bels.min()))..  
+0007efa0: 2020 2020 2020 656c 6966 2074 7261 696e        elif train
+0007efb0: 696e 675f 6c61 6265 6c73 2e64 7479 7065  ing_labels.dtype
+0007efc0: 2069 6e20 5b6f 626a 6563 742c 626f 6f6c   in [object,bool
+0007efd0: 5d3a 0d0a 2020 2020 2020 2020 2020 2020  ]:..            
+0007efe0: 7461 7267 6574 5f72 616e 6765 203d 2069  target_range = i
+0007eff0: 6e74 286c 656e 2843 6f75 6e74 6572 2874  nt(len(Counter(t
+0007f000: 7261 696e 696e 675f 6c61 6265 6c73 2929  raining_labels))
+0007f010: 202b 2033 290d 0a20 2020 2020 2020 2065   + 3)..        e
+0007f020: 6c73 653a 0d0a 2020 2020 2020 2020 2020  lse:..          
+0007f030: 2020 7461 7267 6574 5f72 616e 6765 203d    target_range =
+0007f040: 2069 6e74 2861 6273 2874 7261 696e 696e   int(abs(trainin
+0007f050: 675f 6c61 6265 6c73 2e6d 6178 2829 202d  g_labels.max() -
+0007f060: 2074 7261 696e 696e 675f 6c61 6265 6c73   training_labels
+0007f070: 2e6d 696e 2829 2929 0d0a 2020 2020 6578  .min()))..    ex
+0007f080: 6365 7074 3a0d 0a20 2020 2020 2020 2074  cept:..        t
+0007f090: 6172 6765 745f 7261 6e67 6520 3d20 352e  arget_range = 5.
+0007f0a0: 300d 0a20 2020 206b 6d66 203d 2020 4b4d  0..    kmf =  KM
+0007f0b0: 6561 6e73 4665 6174 7572 697a 6572 286b  eansFeaturizer(k
+0007f0c0: 3d6b 5f6d 6178 2c20 7461 7267 6574 5f73  =k_max, target_s
+0007f0d0: 6361 6c65 3d74 6172 6765 745f 7261 6e67  cale=target_rang
+0007f0e0: 652c 2072 616e 646f 6d5f 7374 6174 653d  e, random_state=
+0007f0f0: 7365 6564 290d 0a20 2020 206b 6d66 5f68  seed)..    kmf_h
+0007f100: 696e 7420 3d20 6b6d 662e 6669 7428 7472  int = kmf.fit(tr
+0007f110: 6169 6e69 6e67 5f64 6174 612c 2074 7261  aining_data, tra
+0007f120: 696e 696e 675f 6c61 6265 6c73 290d 0a20  ining_labels).. 
+0007f130: 2020 2023 2323 204a 7573 7420 7265 7475     ### Just retu
+0007f140: 726e 2069 7420 7769 7468 2074 6865 2063  rn it with the c
+0007f150: 6c75 7374 6572 2063 6f6c 756d 6e20 3d3e  luster column =>
+0007f160: 206e 6f20 6e65 6564 2074 6f20 7265 7475   no need to retu
+0007f170: 726e 2074 6865 2064 6174 6120 6672 616d  rn the data fram
+0007f180: 6520 2323 230d 0a20 2020 2074 7261 696e  e ###..    train
+0007f190: 696e 675f 636c 7573 7465 725f 6665 6174  ing_cluster_feat
+0007f1a0: 7572 6573 203d 206b 6d66 5f68 696e 742e  ures = kmf_hint.
+0007f1b0: 7472 616e 7366 6f72 6d28 7472 6169 6e69  transform(traini
+0007f1c0: 6e67 5f64 6174 6129 0d0a 2020 2020 7465  ng_data)..    te
+0007f1d0: 7374 5f63 6c75 7374 6572 5f66 6561 7475  st_cluster_featu
+0007f1e0: 7265 7320 3d20 6b6d 665f 6869 6e74 2e74  res = kmf_hint.t
+0007f1f0: 7261 6e73 666f 726d 2874 6573 745f 6461  ransform(test_da
+0007f200: 7461 290d 0a20 2020 206e 7078 203d 206e  ta)..    npx = n
+0007f210: 702e 635f 5b74 7261 696e 696e 675f 6461  p.c_[training_da
+0007f220: 7461 2c20 7472 6169 6e69 6e67 5f6c 6162  ta, training_lab
+0007f230: 656c 732e 7661 6c75 6573 5d0d 0a20 2020  els.values]..   
+0007f240: 2074 7261 696e 696e 675f 7769 7468 5f63   training_with_c
+0007f250: 6c75 7374 6572 203d 206e 702e 635f 5b6e  luster = np.c_[n
+0007f260: 7078 2c74 7261 696e 696e 675f 636c 7573  px,training_clus
+0007f270: 7465 725f 6665 6174 7572 6573 5d0d 0a20  ter_features].. 
+0007f280: 2020 2074 6573 745f 7769 7468 5f63 6c75     test_with_clu
+0007f290: 7374 6572 203d 206e 702e 635f 5b74 6573  ster = np.c_[tes
+0007f2a0: 745f 6461 7461 2c20 7465 7374 5f63 6c75  t_data, test_clu
+0007f2b0: 7374 6572 5f66 6561 7475 7265 735d 0d0a  ster_features]..
+0007f2c0: 2020 2020 2323 2320 5765 2061 7265 2067      ### We are g
+0007f2d0: 6f69 6e67 2074 6f20 6a75 7374 2072 6574  oing to just ret
+0007f2e0: 7572 6e20 7468 6520 636c 7573 7465 7220  urn the cluster 
+0007f2f0: 7661 6c75 6573 2023 2323 2323 230d 0a20  values ######.. 
+0007f300: 2020 2074 7261 696e 5f77 6974 685f 636c     train_with_cl
+0007f310: 7573 7465 725f 6466 203d 2074 7261 696e  uster_df = train
+0007f320: 696e 675f 7769 7468 5f63 6c75 7374 6572  ing_with_cluster
+0007f330: 5b3a 2c2d 315d 0d0a 2020 2020 7465 7374  [:,-1]..    test
+0007f340: 5f77 6974 685f 636c 7573 7465 725f 6466  _with_cluster_df
+0007f350: 203d 2074 6573 745f 7769 7468 5f63 6c75   = test_with_clu
+0007f360: 7374 6572 5b3a 2c2d 315d 0d0a 2020 2020  ster[:,-1]..    
+0007f370: 2374 7261 696e 5f77 6974 685f 636c 7573  #train_with_clus
+0007f380: 7465 725f 6466 203d 2070 642e 4461 7461  ter_df = pd.Data
+0007f390: 4672 616d 6528 7472 6169 6e69 6e67 5f77  Frame(training_w
+0007f3a0: 6974 685f 636c 7573 7465 722c 696e 6465  ith_cluster,inde
+0007f3b0: 783d 7472 6169 6e5f 696e 6465 782c 0d0a  x=train_index,..
+0007f3c0: 2020 2020 2320 2020 2020 2020 2020 2020      #           
+0007f3d0: 2020 2020 2020 2020 2020 2020 2020 2020                  
+0007f3e0: 2020 2020 2020 2063 6f6c 756d 6e73 3d70         columns=p
+0007f3f0: 7265 6473 2b5b 7461 7267 6574 2c27 636c  reds+[target,'cl
+0007f400: 7573 7465 7227 5d29 0d0a 2020 2020 2374  uster'])..    #t
+0007f410: 6573 745f 7769 7468 5f63 6c75 7374 6572  est_with_cluster
+0007f420: 5f64 6620 3d20 7064 2e44 6174 6146 7261  _df = pd.DataFra
+0007f430: 6d65 2874 6573 745f 7769 7468 5f63 6c75  me(test_with_clu
+0007f440: 7374 6572 2c69 6e64 6578 3d74 6573 745f  ster,index=test_
+0007f450: 696e 6465 782c 0d0a 2020 2020 2320 2020  index,..    #   
+0007f460: 2020 2020 2020 2020 2020 2020 2020 2020                  
+0007f470: 2020 2020 2020 2020 2020 2020 2020 2063                 c
+0007f480: 6f6c 756d 6e73 3d70 7265 6473 2b5b 2763  olumns=preds+['c
+0007f490: 6c75 7374 6572 275d 290d 0a20 2020 2072  luster'])..    r
+0007f4a0: 6574 7572 6e20 7472 6169 6e5f 7769 7468  eturn train_with
+0007f4b0: 5f63 6c75 7374 6572 5f64 662c 2074 6573  _cluster_df, tes
+0007f4c0: 745f 7769 7468 5f63 6c75 7374 6572 5f64  t_with_cluster_d
+0007f4d0: 660d 0a00 0000 0000 0000 0000 0000 0000  f...............
+0007f4e0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+0007f4f0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+0007f500: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+0007f510: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+0007f520: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+0007f530: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+0007f540: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+0007f550: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+0007f560: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+0007f570: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+0007f580: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+0007f590: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+0007f5a0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+0007f5b0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+0007f5c0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+0007f5d0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+0007f5e0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+0007f5f0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+0007f600: 2e2f 2e2f 4050 6178 4865 6164 6572 0000  ././@PaxHeader..
+0007f610: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+0007f620: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+0007f630: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+0007f640: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+0007f650: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+0007f660: 0000 0000 3030 3030 3030 3000 3030 3030  ....0000000.0000
+0007f670: 3030 3000 3030 3030 3030 3000 3030 3030  000.0000000.0000
+0007f680: 3030 3030 3032 3600 3030 3030 3030 3030  0000026.00000000
+0007f690: 3030 3000 3031 3134 3533 0020 7800 0000  000.011453. x...
+0007f6a0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+0007f6b0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+0007f6c0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+0007f6d0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+0007f6e0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+0007f6f0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+0007f700: 0075 7374 6172 0030 3000 0000 0000 0000  .ustar.00.......
+0007f710: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+0007f720: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+0007f730: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+0007f740: 0000 0000 0000 0000 0030 3030 3030 3030  .........0000000
+0007f750: 0030 3030 3030 3030 0000 0000 0000 0000  .0000000........
+0007f760: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+0007f770: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+0007f780: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+0007f790: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+0007f7a0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+0007f7b0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+0007f7c0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+0007f7d0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+0007f7e0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+0007f7f0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+0007f800: 3232 206d 7469 6d65 3d31 3637 3832 3830  22 mtime=1678280
+0007f810: 3638 392e 300a 0000 0000 0000 0000 0000  689.0...........
+0007f820: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+0007f830: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+0007f840: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+0007f850: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+0007f860: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+0007f870: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+0007f880: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+0007f890: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+0007f8a0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+0007f8b0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+0007f8c0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+0007f8d0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+0007f8e0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+0007f8f0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+0007f900: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+0007f910: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+0007f920: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+0007f930: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+0007f940: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+0007f950: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+0007f960: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+0007f970: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+0007f980: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+0007f990: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+0007f9a0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+0007f9b0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+0007f9c0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+0007f9d0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+0007f9e0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+0007f9f0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+0007fa00: 6175 746f 7669 6d6c 2d30 2e31 2e37 3135  autoviml-0.1.715
+0007fa10: 2f61 7574 6f76 696d 6c2f 5f5f 696e 6974  /autoviml/__init
+0007fa20: 5f5f 2e70 7900 0000 0000 0000 0000 0000  __.py...........
+0007fa30: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+0007fa40: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+0007fa50: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+0007fa60: 0000 0000 3030 3030 3737 3700 3030 3031  ....0000777.0001
+0007fa70: 3735 3000 3030 3031 3735 3000 3030 3030  750.0001750.0000
+0007fa80: 3030 3033 3236 3400 3030 3030 3030 3030  0003264.00000000
+0007fa90: 3030 3000 3031 3730 3733 0020 3000 0000  000.017073. 0...
+0007faa0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+0007fab0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
 0007fac0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
 0007fad0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
 0007fae0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
 0007faf0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-0007fb00: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+0007fb00: 0075 7374 6172 0030 3072 616d 0000 0000  .ustar.00ram....
 0007fb10: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-0007fb20: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+0007fb20: 0000 0000 0000 0000 0072 616d 0000 0000  .........ram....
 0007fb30: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-0007fb40: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-0007fb50: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+0007fb40: 0000 0000 0000 0000 0030 3030 3030 3030  .........0000000
+0007fb50: 0030 3030 3030 3030 0000 0000 0000 0000  .0000000........
 0007fb60: 0000 0000 0000 0000 0000 0000 0000 0000  ................
 0007fb70: 0000 0000 0000 0000 0000 0000 0000 0000  ................
 0007fb80: 0000 0000 0000 0000 0000 0000 0000 0000  ................
 0007fb90: 0000 0000 0000 0000 0000 0000 0000 0000  ................
 0007fba0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
 0007fbb0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
 0007fbc0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
 0007fbd0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
 0007fbe0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
 0007fbf0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-0007fc00: 2e2f 2e2f 4050 6178 4865 6164 6572 0000  ././@PaxHeader..
-0007fc10: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-0007fc20: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-0007fc30: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-0007fc40: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-0007fc50: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-0007fc60: 0000 0000 3030 3030 3030 3000 3030 3030  ....0000000.0000
-0007fc70: 3030 3000 3030 3030 3030 3000 3030 3030  000.0000000.0000
-0007fc80: 3030 3030 3032 3600 3030 3030 3030 3030  0000026.00000000
-0007fc90: 3030 3000 3031 3134 3533 0020 7800 0000  000.011453. x...
-0007fca0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-0007fcb0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-0007fcc0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-0007fcd0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-0007fce0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-0007fcf0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-0007fd00: 0075 7374 6172 0030 3000 0000 0000 0000  .ustar.00.......
-0007fd10: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-0007fd20: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-0007fd30: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-0007fd40: 0000 0000 0000 0000 0030 3030 3030 3030  .........0000000
-0007fd50: 0030 3030 3030 3030 0000 0000 0000 0000  .0000000........
-0007fd60: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-0007fd70: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-0007fd80: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-0007fd90: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-0007fda0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-0007fdb0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-0007fdc0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-0007fdd0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-0007fde0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-0007fdf0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-0007fe00: 3232 206d 7469 6d65 3d31 3638 3139 3033  22 mtime=1681903
-0007fe10: 3731 322e 300a 0000 0000 0000 0000 0000  712.0...........
-0007fe20: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-0007fe30: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-0007fe40: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-0007fe50: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-0007fe60: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-0007fe70: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-0007fe80: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-0007fe90: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-0007fea0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-0007feb0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-0007fec0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-0007fed0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-0007fee0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-0007fef0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-0007ff00: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-0007ff10: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-0007ff20: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-0007ff30: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-0007ff40: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-0007ff50: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-0007ff60: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-0007ff70: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-0007ff80: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-0007ff90: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-0007ffa0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-0007ffb0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-0007ffc0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-0007ffd0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-0007ffe0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-0007fff0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-00080000: 6175 746f 7669 6d6c 2d30 2e31 2e37 3134  autoviml-0.1.714
-00080010: 2f61 7574 6f76 696d 6c2f 5f5f 7665 7273  /autoviml/__vers
-00080020: 696f 6e5f 5f2e 7079 0000 0000 0000 0000  ion__.py........
-00080030: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-00080040: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-00080050: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-00080060: 0000 0000 3030 3030 3737 3700 3030 3031  ....0000777.0001
-00080070: 3735 3000 3030 3031 3735 3000 3030 3030  750.0001750.0000
-00080080: 3030 3030 3633 3300 3030 3030 3030 3030  0000633.00000000
-00080090: 3030 3000 3031 3736 3131 0020 3000 0000  000.017611. 0...
-000800a0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-000800b0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-000800c0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-000800d0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-000800e0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-000800f0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-00080100: 0075 7374 6172 0030 3072 616d 0000 0000  .ustar.00ram....
-00080110: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-00080120: 0000 0000 0000 0000 0072 616d 0000 0000  .........ram....
-00080130: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-00080140: 0000 0000 0000 0000 0030 3030 3030 3030  .........0000000
-00080150: 0030 3030 3030 3030 0000 0000 0000 0000  .0000000........
-00080160: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-00080170: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-00080180: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-00080190: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-000801a0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-000801b0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-000801c0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-000801d0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-000801e0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-000801f0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-00080200: 2320 2d2a 2d20 636f 6469 6e67 3a20 7574  # -*- coding: ut
-00080210: 662d 3820 2d2a 2d0d 0a22 2222 5370 6563  f-8 -*-.."""Spec
-00080220: 6966 6965 7320 7468 6520 7665 7273 696f  ifies the versio
-00080230: 6e20 6f66 2074 6865 2041 7574 6f5f 5669  n of the Auto_Vi
-00080240: 4d4c 2070 6163 6b61 6765 2e22 2222 0d0a  ML package."""..
-00080250: 0d0a 5f5f 7469 746c 655f 5f20 3d20 2241  ..__title__ = "A
-00080260: 7574 6f5f 5669 4d4c 220d 0a5f 5f61 7574  uto_ViML"..__aut
-00080270: 686f 725f 5f20 3d20 2252 616d 2053 6573  hor__ = "Ram Ses
-00080280: 6861 6472 6922 0d0a 5f5f 6465 7363 7269  hadri"..__descri
-00080290: 7074 696f 6e5f 5f20 3d20 2241 7574 6f6d  ption__ = "Autom
-000802a0: 6174 6963 616c 6c79 2042 7569 6c64 204d  atically Build M
-000802b0: 756c 7469 706c 6520 496e 7465 7270 7265  ultiple Interpre
-000802c0: 7461 626c 6520 4d4c 204d 6f64 656c 7320  table ML Models 
-000802d0: 696e 2053 696e 676c 6520 4c69 6e65 206f  in Single Line o
-000802e0: 6620 436f 6465 220d 0a5f 5f75 726c 5f5f  f Code"..__url__
-000802f0: 203d 2022 6874 7470 733a 2f2f 6769 7468   = "https://gith
-00080300: 7562 2e63 6f6d 2f41 7574 6f56 694d 4c2f  ub.com/AutoViML/
-00080310: 4175 746f 5f56 694d 4c2e 6769 7422 0d0a  Auto_ViML.git"..
-00080320: 5f5f 7665 7273 696f 6e5f 5f20 3d20 2230  __version__ = "0
-00080330: 2e31 2e37 3134 220d 0a5f 5f6e 6c70 5f76  .1.714"..__nlp_v
-00080340: 6572 7369 6f6e 5f5f 203d 2022 302e 312e  ersion__ = "0.1.
-00080350: 3031 220d 0a5f 5f6c 6963 656e 7365 5f5f  01"..__license__
-00080360: 203d 2022 4170 6163 6865 204c 6963 656e   = "Apache Licen
-00080370: 7365 2032 2e30 220d 0a5f 5f63 6f70 7972  se 2.0"..__copyr
-00080380: 6967 6874 5f5f 203d 2022 3230 3230 2d32  ight__ = "2020-2
-00080390: 3120 476f 6f67 6c65 220d 0a00 0000 0000  1 Google".......
+0007fc00: 2320 2d2a 2d20 636f 6469 6e67 3a20 7574  # -*- coding: ut
+0007fc10: 662d 3820 2d2a 2d0d 0a23 2323 2323 2323  f-8 -*-..#######
+0007fc20: 2323 2323 2323 2323 2323 2323 2323 2323  ################
+0007fc30: 2323 2323 2323 2323 2323 2323 2323 2323  ################
+0007fc40: 2323 2323 2323 2323 2323 2323 2323 2323  ################
+0007fc50: 2323 2323 2323 2323 2323 2323 2323 2323  ################
+0007fc60: 2323 2323 2323 2323 230d 0a23 2020 2020  #########..#    
+0007fc70: 2041 7574 6f5f 5669 4d4c 202d 2041 7574   Auto_ViML - Aut
+0007fc80: 6f6d 6174 6963 616c 6c79 2042 7569 6c64  omatically Build
+0007fc90: 204d 756c 7469 706c 6520 496e 7465 7270   Multiple Interp
+0007fca0: 7265 7461 626c 6520 4d4c 204d 6f64 656c  retable ML Model
+0007fcb0: 7320 696e 2053 696e 676c 6520 4c69 6e65  s in Single Line
+0007fcc0: 206f 6620 436f 6465 0d0a 2320 2020 2020   of Code..#     
+0007fcd0: 5079 7468 6f6e 2076 332e 362b 0d0a 2320  Python v3.6+..# 
+0007fce0: 2020 2020 4372 6561 7465 6420 6279 2052      Created by R
+0007fcf0: 616d 2053 6573 6861 6472 690d 0a23 2020  am Seshadri..#  
+0007fd00: 2020 204c 6963 656e 7365 6420 756e 6465     Licensed unde
+0007fd10: 7220 4170 6163 6865 204c 6963 656e 7365  r Apache License
+0007fd20: 2076 320d 0a23 2323 2323 2323 2323 2323   v2..###########
+0007fd30: 2323 2323 2323 2323 2323 2323 2323 2323  ################
+0007fd40: 2323 2323 2323 2323 2323 2323 2323 2323  ################
+0007fd50: 2323 2323 2323 2323 2323 2323 2323 2323  ################
+0007fd60: 2323 2323 2323 2323 2323 2323 2323 2323  ################
+0007fd70: 2323 2323 230d 0a23 2056 6572 7369 6f6e  #####..# Version
+0007fd80: 0d0a 6672 6f6d 202e 5f5f 7665 7273 696f  ..from .__versio
+0007fd90: 6e5f 5f20 696d 706f 7274 205f 5f76 6572  n__ import __ver
+0007fda0: 7369 6f6e 5f5f 2c20 5f5f 6e6c 705f 7665  sion__, __nlp_ve
+0007fdb0: 7273 696f 6e5f 5f0d 0a69 6620 5f5f 6e61  rsion__..if __na
+0007fdc0: 6d65 5f5f 203d 3d20 225f 5f6d 6169 6e5f  me__ == "__main_
+0007fdd0: 5f22 3a0d 0a20 2020 206d 6f64 756c 655f  _":..    module_
+0007fde0: 7479 7065 203d 2027 5275 6e6e 696e 6727  type = 'Running'
+0007fdf0: 0d0a 656c 7365 3a0d 0a20 2020 206d 6f64  ..else:..    mod
+0007fe00: 756c 655f 7479 7065 203d 2027 496d 706f  ule_type = 'Impo
+0007fe10: 7274 6564 270d 0a76 696d 6c5f 7665 7273  rted'..viml_vers
+0007fe20: 696f 6e5f 6e75 6d62 6572 203d 205f 5f76  ion_number = __v
+0007fe30: 6572 7369 6f6e 5f5f 0d0a 6e6c 705f 7665  ersion__..nlp_ve
+0007fe40: 7273 696f 6e5f 6e75 6d62 6572 203d 205f  rsion_number = _
+0007fe50: 5f6e 6c70 5f76 6572 7369 6f6e 5f5f 0d0a  _nlp_version__..
+0007fe60: 7072 696e 7428 2222 2225 7320 4175 746f  print("""%s Auto
+0007fe70: 5f56 694d 4c20 7665 7273 696f 6e3a 2025  _ViML version: %
+0007fe80: 732e 2043 616c 6c20 7573 696e 673a 0d0a  s. Call using:..
+0007fe90: 2020 2020 2020 2020 2020 2020 206d 2c20               m, 
+0007fea0: 6665 6174 732c 2074 7261 696e 6d2c 2074  feats, trainm, t
+0007feb0: 6573 746d 203d 2041 7574 6f5f 5669 4d4c  estm = Auto_ViML
+0007fec0: 2874 7261 696e 2c20 7461 7267 6574 2c20  (train, target, 
+0007fed0: 7465 7374 2c0d 0a20 2020 2020 2020 2020  test,..         
+0007fee0: 2020 2020 2020 2020 2020 2020 2020 2020                  
+0007fef0: 2020 2073 616d 706c 655f 7375 626d 6973     sample_submis
+0007ff00: 7369 6f6e 3d27 272c 0d0a 2020 2020 2020  sion='',..      
+0007ff10: 2020 2020 2020 2020 2020 2020 2020 2020                  
+0007ff20: 2020 2020 2020 7363 6f72 696e 675f 7061        scoring_pa
+0007ff30: 7261 6d65 7465 723d 2727 2c20 4b4d 6561  rameter='', KMea
+0007ff40: 6e73 5f46 6561 7475 7269 7a65 723d 4661  ns_Featurizer=Fa
+0007ff50: 6c73 652c 0d0a 2020 2020 2020 2020 2020  lse,..          
+0007ff60: 2020 2020 2020 2020 2020 2020 2020 2020                  
+0007ff70: 2020 6879 7065 725f 7061 7261 6d3d 2752    hyper_param='R
+0007ff80: 5327 2c66 6561 7475 7265 5f72 6564 7563  S',feature_reduc
+0007ff90: 7469 6f6e 3d54 7275 652c 0d0a 2020 2020  tion=True,..    
+0007ffa0: 2020 2020 2020 2020 2020 2020 2020 2020                  
+0007ffb0: 2020 2020 2020 2020 2042 6f6f 7374 696e           Boostin
+0007ffc0: 675f 466c 6167 3d27 4361 7442 6f6f 7374  g_Flag='CatBoost
+0007ffd0: 272c 2042 696e 6e69 6e67 5f46 6c61 673d  ', Binning_Flag=
+0007ffe0: 4661 6c73 652c 0d0a 2020 2020 2020 2020  False,..        
+0007fff0: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00080000: 2020 2020 4164 645f 506f 6c79 3d30 2c20      Add_Poly=0, 
+00080010: 5374 6163 6b69 6e67 5f46 6c61 673d 4661  Stacking_Flag=Fa
+00080020: 6c73 652c 496d 6261 6c61 6e63 6564 5f46  lse,Imbalanced_F
+00080030: 6c61 673d 4661 6c73 652c 0d0a 2020 2020  lag=False,..    
+00080040: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00080050: 2020 2020 2020 2020 4750 555f 666c 6167          GPU_flag
+00080060: 3d46 616c 7365 2c20 7665 7262 6f73 653d  =False, verbose=
+00080070: 3129 0d0a 2020 2020 2020 2020 2020 2020  1)..            
+00080080: 2222 2220 2528 6d6f 6475 6c65 5f74 7970  """ %(module_typ
+00080090: 652c 2076 696d 6c5f 7665 7273 696f 6e5f  e, viml_version_
+000800a0: 6e75 6d62 6572 2929 0d0a 7072 696e 7428  number))..print(
+000800b0: 290d 0a23 2323 2323 2323 2323 2323 2323  )..#############
+000800c0: 2323 2323 2323 2323 2323 2323 2323 2323  ################
+000800d0: 2323 2323 2323 2323 2323 2323 2323 2323  ################
+000800e0: 2323 2323 2323 2323 2323 2323 2323 2323  ################
+000800f0: 2323 2323 2323 2323 2323 2323 2323 2323  ################
+00080100: 2323 2323 2323 2323 2323 2323 2323 0d0a  ##############..
+00080110: 7072 696e 7428 2222 2225 7320 4175 746f  print("""%s Auto
+00080120: 5f4e 4c50 2076 6572 7369 6f6e 3a20 2573  _NLP version: %s
+00080130: 2e2e 2043 616c 6c20 7573 696e 673a 0d0a  .. Call using:..
+00080140: 2020 2020 2074 7261 696e 5f6e 6c70 2c20       train_nlp, 
+00080150: 7465 7374 5f6e 6c70 2c20 6e6c 705f 7069  test_nlp, nlp_pi
+00080160: 7065 6c69 6e65 2c20 7072 6564 6963 7469  peline, predicti
+00080170: 6f6e 7320 3d20 4175 746f 5f4e 4c50 280d  ons = Auto_NLP(.
+00080180: 0a20 2020 2020 2020 2020 2020 2020 2020  .               
+00080190: 206e 6c70 5f63 6f6c 756d 6e2c 2074 7261   nlp_column, tra
+000801a0: 696e 2c20 7465 7374 2c20 7461 7267 6574  in, test, target
+000801b0: 2c20 7363 6f72 655f 7479 7065 3d27 6261  , score_type='ba
+000801c0: 6c61 6e63 6564 5f61 6363 7572 6163 7927  lanced_accuracy'
+000801d0: 2c0d 0a20 2020 2020 2020 2020 2020 2020  ,..             
+000801e0: 2020 206d 6f64 656c 7479 7065 3d27 436c     modeltype='Cl
+000801f0: 6173 7369 6669 6361 7469 6f6e 272c 746f  assification',to
+00080200: 705f 6e75 6d5f 6665 6174 7572 6573 3d32  p_num_features=2
+00080210: 3030 2c20 7665 7262 6f73 653d 302c 0d0a  00, verbose=0,..
+00080220: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00080230: 6275 696c 645f 6d6f 6465 6c3d 5472 7565  build_model=True
+00080240: 2922 2222 2025 286d 6f64 756c 655f 7479  )""" %(module_ty
+00080250: 7065 2c20 6e6c 705f 7665 7273 696f 6e5f  pe, nlp_version_
+00080260: 6e75 6d62 6572 2929 0d0a 2323 2323 2323  number))..######
+00080270: 2323 2323 2323 2323 2323 2323 2323 2323  ################
+00080280: 2323 2323 2323 2323 2323 2323 2323 2323  ################
+00080290: 2323 2323 2323 2323 2323 2323 2323 2323  ################
+000802a0: 2323 2323 2323 2323 2323 2323 2323 2323  ################
+000802b0: 2323 0d0a 0000 0000 0000 0000 0000 0000  ##..............
+000802c0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+000802d0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+000802e0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+000802f0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+00080300: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+00080310: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+00080320: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+00080330: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+00080340: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+00080350: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+00080360: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+00080370: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+00080380: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+00080390: 0000 0000 0000 0000 0000 0000 0000 0000  ................
 000803a0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
 000803b0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
 000803c0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
 000803d0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
 000803e0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
 000803f0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
 00080400: 2e2f 2e2f 4050 6178 4865 6164 6572 0000  ././@PaxHeader..
@@ -32858,16 +32858,16 @@
 00080590: 0000 0000 0000 0000 0000 0000 0000 0000  ................
 000805a0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
 000805b0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
 000805c0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
 000805d0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
 000805e0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
 000805f0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-00080600: 3232 206d 7469 6d65 3d31 3637 3831 3539  22 mtime=1678159
-00080610: 3732 322e 300a 0000 0000 0000 0000 0000  722.0...........
+00080600: 3232 206d 7469 6d65 3d31 3638 3433 3237  22 mtime=1684327
+00080610: 3136 342e 300a 0000 0000 0000 0000 0000  164.0...........
 00080620: 0000 0000 0000 0000 0000 0000 0000 0000  ................
 00080630: 0000 0000 0000 0000 0000 0000 0000 0000  ................
 00080640: 0000 0000 0000 0000 0000 0000 0000 0000  ................
 00080650: 0000 0000 0000 0000 0000 0000 0000 0000  ................
 00080660: 0000 0000 0000 0000 0000 0000 0000 0000  ................
 00080670: 0000 0000 0000 0000 0000 0000 0000 0000  ................
 00080680: 0000 0000 0000 0000 0000 0000 0000 0000  ................
@@ -32890,24 +32890,24 @@
 00080790: 0000 0000 0000 0000 0000 0000 0000 0000  ................
 000807a0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
 000807b0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
 000807c0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
 000807d0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
 000807e0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
 000807f0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-00080800: 6175 746f 7669 6d6c 2d30 2e31 2e37 3134  autoviml-0.1.714
-00080810: 2f61 7574 6f76 696d 6c2f 636c 6173 7369  /autoviml/classi
-00080820: 6679 5f6d 6574 686f 642e 7079 0000 0000  fy_method.py....
+00080800: 6175 746f 7669 6d6c 2d30 2e31 2e37 3135  autoviml-0.1.715
+00080810: 2f61 7574 6f76 696d 6c2f 5f5f 7665 7273  /autoviml/__vers
+00080820: 696f 6e5f 5f2e 7079 0000 0000 0000 0000  ion__.py........
 00080830: 0000 0000 0000 0000 0000 0000 0000 0000  ................
 00080840: 0000 0000 0000 0000 0000 0000 0000 0000  ................
 00080850: 0000 0000 0000 0000 0000 0000 0000 0000  ................
 00080860: 0000 0000 3030 3030 3737 3700 3030 3031  ....0000777.0001
 00080870: 3735 3000 3030 3031 3735 3000 3030 3030  750.0001750.0000
-00080880: 3030 3433 3630 3200 3030 3030 3030 3030  0043602.00000000
-00080890: 3030 3000 3032 3035 3130 0020 3000 0000  000.020510. 0...
+00080880: 3030 3030 3633 3300 3030 3030 3030 3030  0000633.00000000
+00080890: 3030 3000 3031 3736 3132 0020 3000 0000  000.017612. 0...
 000808a0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
 000808b0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
 000808c0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
 000808d0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
 000808e0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
 000808f0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
 00080900: 0075 7374 6172 0030 3072 616d 0000 0000  .ustar.00ram....
@@ -32922,5774 +32922,5774 @@
 00080990: 0000 0000 0000 0000 0000 0000 0000 0000  ................
 000809a0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
 000809b0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
 000809c0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
 000809d0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
 000809e0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
 000809f0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-00080a00: 696d 706f 7274 206e 756d 7079 2061 7320  import numpy as 
-00080a10: 6e70 0d0a 696d 706f 7274 2070 616e 6461  np..import panda
-00080a20: 7320 6173 2070 640d 0a69 6d70 6f72 7420  s as pd..import 
-00080a30: 7261 6e64 6f6d 0d0a 6e70 2e72 616e 646f  random..np.rando
-00080a40: 6d2e 7365 6564 2839 3929 0d0a 7261 6e64  m.seed(99)..rand
-00080a50: 6f6d 2e73 6565 6428 3432 290d 0a23 2323  om.seed(42)..###
-00080a60: 2323 2323 2323 2323 2323 2323 2323 2323  ################
-00080a70: 2323 2323 2323 2323 2323 2323 2323 2323  ################
-00080a80: 2323 2323 2323 2323 2323 2323 2323 2323  ################
-00080a90: 2323 2323 2323 2323 2323 2323 2323 2323  ################
-00080aa0: 2323 2323 2323 2323 2323 2323 230d 0a23  #############..#
-00080ab0: 2323 2320 5468 6520 7761 726e 696e 6773  ### The warnings
-00080ac0: 2066 726f 6d20 536b 6c65 6172 6e20 6172   from Sklearn ar
-00080ad0: 6520 736f 2061 6e6e 6f79 696e 6720 7468  e so annoying th
-00080ae0: 6174 2049 2068 6176 6520 746f 2073 6875  at I have to shu
-00080af0: 7420 6974 206f 6666 2023 2323 2323 2323  t it off #######
-00080b00: 0d0a 696d 706f 7274 2077 6172 6e69 6e67  ..import warning
-00080b10: 730d 0a77 6172 6e69 6e67 732e 6669 6c74  s..warnings.filt
-00080b20: 6572 7761 726e 696e 6773 2822 6967 6e6f  erwarnings("igno
-00080b30: 7265 2229 0d0a 6672 6f6d 2073 6b6c 6561  re")..from sklea
-00080b40: 726e 2e65 7863 6570 7469 6f6e 7320 696d  rn.exceptions im
-00080b50: 706f 7274 2044 6174 6143 6f6e 7665 7273  port DataConvers
-00080b60: 696f 6e57 6172 6e69 6e67 0d0a 7761 726e  ionWarning..warn
-00080b70: 696e 6773 2e66 696c 7465 7277 6172 6e69  ings.filterwarni
-00080b80: 6e67 7328 6163 7469 6f6e 3d27 6967 6e6f  ngs(action='igno
-00080b90: 7265 272c 2063 6174 6567 6f72 793d 4461  re', category=Da
-00080ba0: 7461 436f 6e76 6572 7369 6f6e 5761 726e  taConversionWarn
-00080bb0: 696e 6729 0d0a 6465 6620 7761 726e 282a  ing)..def warn(*
-00080bc0: 6172 6773 2c20 2a2a 6b77 6172 6773 293a  args, **kwargs):
-00080bd0: 0d0a 2020 2020 7061 7373 0d0a 7761 726e  ..    pass..warn
-00080be0: 696e 6773 2e77 6172 6e20 3d20 7761 726e  ings.warn = warn
-00080bf0: 0d0a 696d 706f 7274 206c 6f67 6769 6e67  ..import logging
-00080c00: 0d0a 2323 2323 2323 2323 2323 2323 2323  ..##############
-00080c10: 2323 2323 2323 2323 2323 2323 2323 2323  ################
-00080c20: 2323 2323 2323 2323 2323 2323 2323 2323  ################
-00080c30: 2323 2323 2323 2323 2323 2323 2323 2323  ################
-00080c40: 2323 2323 2323 2323 2323 2323 2323 2323  ################
-00080c50: 2323 2323 2323 0d0a 696d 706f 7274 2070  ######..import p
-00080c60: 6462 0d0a 6672 6f6d 2066 756e 6374 6f6f  db..from functoo
-00080c70: 6c73 2069 6d70 6f72 7420 7265 6475 6365  ls import reduce
-00080c80: 0d0a 696d 706f 7274 2063 6f70 790d 0a69  ..import copy..i
-00080c90: 6d70 6f72 7420 7469 6d65 0d0a 6465 6620  mport time..def 
-00080ca0: 6c65 6674 5f73 7562 7472 6163 7428 6c31  left_subtract(l1
-00080cb0: 2c6c 3229 3a0d 0a20 2020 206c 7374 203d  ,l2):..    lst =
-00080cc0: 205b 5d0d 0a20 2020 2066 6f72 2069 2069   []..    for i i
-00080cd0: 6e20 6c31 3a0d 0a20 2020 2020 2020 2069  n l1:..        i
-00080ce0: 6620 6920 6e6f 7420 696e 206c 323a 0d0a  f i not in l2:..
-00080cf0: 2020 2020 2020 2020 2020 2020 6c73 742e              lst.
-00080d00: 6170 7065 6e64 2869 290d 0a20 2020 2072  append(i)..    r
-00080d10: 6574 7572 6e20 6c73 740d 0a23 2323 2323  eturn lst..#####
-00080d20: 2323 2323 2323 2323 2323 2323 2323 2323  ################
-00080d30: 2323 2323 2323 2323 2323 2323 2323 2323  ################
-00080d40: 2323 2323 2323 2323 2323 2323 2323 2323  ################
-00080d50: 2323 2323 2323 2323 2323 2323 2323 2323  ################
-00080d60: 2323 2323 2323 2323 2323 2323 0d0a 696d  ############..im
-00080d70: 706f 7274 2063 6f70 790d 0a64 6566 2045  port copy..def E
-00080d80: 4441 5f66 696e 645f 7265 6d6f 7665 5f63  DA_find_remove_c
-00080d90: 6f6c 756d 6e73 5f77 6974 685f 696e 6669  olumns_with_infi
-00080da0: 6e69 7479 2864 662c 2072 656d 6f76 653d  nity(df, remove=
-00080db0: 4661 6c73 6529 3a0d 0a20 2020 2022 2222  False):..    """
-00080dc0: 0d0a 2020 2020 5468 6973 2066 756e 6374  ..    This funct
-00080dd0: 696f 6e20 6669 6e64 7320 616c 6c20 636f  ion finds all co
-00080de0: 6c75 6d6e 7320 696e 2061 2064 6174 6166  lumns in a dataf
-00080df0: 7261 6d65 2074 6861 7420 6861 7665 2069  rame that have i
-00080e00: 6e69 6669 6e69 7465 2076 616c 7565 7320  nifinite values 
-00080e10: 286e 702e 696e 6620 6f72 202d 6e70 2e69  (np.inf or -np.i
-00080e20: 6e66 290d 0a20 2020 2049 7420 7265 7475  nf)..    It retu
-00080e30: 726e 7320 6120 6c69 7374 206f 6620 636f  rns a list of co
-00080e40: 6c75 6d6e 206e 616d 6573 2e20 4966 2074  lumn names. If t
-00080e50: 6865 206c 6973 7420 6973 2065 6d70 7479  he list is empty
-00080e60: 2c20 6974 206d 6561 6e73 206e 6f20 636f  , it means no co
-00080e70: 6c75 6d6e 7320 7765 7265 2066 6f75 6e64  lumns were found
-00080e80: 2e0d 0a20 2020 2049 6620 7265 6d6f 7665  ...    If remove
-00080e90: 2066 6c61 6720 6973 2073 6574 2c20 7468   flag is set, th
-00080ea0: 656e 2069 7420 7265 7475 726e 7320 6120  en it returns a 
-00080eb0: 736d 616c 6c65 7220 6461 7461 6672 616d  smaller datafram
-00080ec0: 6520 7769 7468 2069 6e66 2063 6f6c 756d  e with inf colum
-00080ed0: 6e73 2072 656d 6f76 6564 2e0d 0a20 2020  ns removed...   
-00080ee0: 2022 2222 0d0a 2020 2020 6e75 6d73 203d   """..    nums =
-00080ef0: 2064 662e 7365 6c65 6374 5f64 7479 7065   df.select_dtype
-00080f00: 7328 696e 636c 7564 653d 276e 756d 6265  s(include='numbe
-00080f10: 7227 292e 636f 6c75 6d6e 732e 746f 6c69  r').columns.toli
-00080f20: 7374 2829 0d0a 2020 2020 6466 7820 3d20  st()..    dfx = 
-00080f30: 6466 5b6e 756d 735d 0d0a 2020 2020 7375  df[nums]..    su
-00080f40: 6d5f 726f 7773 203d 206e 702e 6973 696e  m_rows = np.isin
-00080f50: 6628 6466 7829 2e76 616c 7565 732e 7375  f(dfx).values.su
-00080f60: 6d28 290d 0a20 2020 2061 6464 5f63 6f6c  m()..    add_col
-00080f70: 7320 3d20 206c 6973 7428 6466 782e 636f  s =  list(dfx.co
-00080f80: 6c75 6d6e 732e 746f 5f73 6572 6965 7328  lumns.to_series(
-00080f90: 295b 6e70 2e69 7369 6e66 2864 6678 292e  )[np.isinf(dfx).
-00080fa0: 616e 7928 295d 290d 0a20 2020 2069 6620  any()])..    if 
-00080fb0: 7375 6d5f 726f 7773 203e 2030 3a0d 0a20  sum_rows > 0:.. 
-00080fc0: 2020 2020 2020 2070 7269 6e74 2827 2020         print('  
-00080fd0: 2020 7468 6572 6520 6172 6520 2564 2072    there are %d r
-00080fe0: 6f77 7320 616e 6420 2564 2063 6f6c 756d  ows and %d colum
-00080ff0: 6e73 2077 6974 6820 696e 6669 6e69 7479  ns with infinity
-00081000: 2069 6e20 7468 656d 2e2e 2e27 2025 2873   in them...' %(s
-00081010: 756d 5f72 6f77 732c 6c65 6e28 6164 645f  um_rows,len(add_
-00081020: 636f 6c73 2929 290d 0a20 2020 2020 2020  cols)))..       
-00081030: 2069 6620 7265 6d6f 7665 3a0d 0a20 2020   if remove:..   
-00081040: 2020 2020 2020 2020 2023 2323 2068 6572           ### her
-00081050: 6520 796f 7520 6e65 6564 2074 6f20 7573  e you need to us
-00081060: 6520 6466 2073 696e 6365 2074 6865 2077  e df since the w
-00081070: 686f 6c65 2064 6174 6173 6574 2069 7320  hole dataset is 
-00081080: 696e 766f 6c76 6564 2023 2323 0d0a 2020  involved ###..  
-00081090: 2020 2020 2020 2020 2020 6e6f 636f 6c73            nocols
-000810a0: 203d 205b 7820 666f 7220 7820 696e 2064   = [x for x in d
-000810b0: 662e 636f 6c75 6d6e 7320 6966 2078 206e  f.columns if x n
-000810c0: 6f74 2069 6e20 6164 645f 636f 6c73 5d0d  ot in add_cols].
-000810d0: 0a20 2020 2020 2020 2020 2020 2070 7269  .            pri
-000810e0: 6e74 2822 2020 2020 5368 6170 6520 6f66  nt("    Shape of
-000810f0: 2064 6174 6173 6574 2062 6566 6f72 6520   dataset before 
-00081100: 2573 2061 6e64 2061 6674 6572 2025 7320  %s and after %s 
-00081110: 7265 6d6f 7669 6e67 2063 6f6c 756d 6e73  removing columns
-00081120: 2077 6974 6820 696e 6669 6e69 7479 2220   with infinity" 
-00081130: 2528 6466 2e73 6861 7065 2c28 6466 5b6e  %(df.shape,(df[n
-00081140: 6f63 6f6c 735d 2e73 6861 7065 2c29 2929  ocols].shape,)))
-00081150: 0d0a 2020 2020 2020 2020 2020 2020 7265  ..            re
-00081160: 7475 726e 2064 665b 6e6f 636f 6c73 5d0d  turn df[nocols].
-00081170: 0a20 2020 2020 2020 2065 6c73 653a 0d0a  .        else:..
-00081180: 2020 2020 2020 2020 2020 2020 2323 2074              ## t
-00081190: 6869 7320 7769 6c6c 2062 6520 6120 6c69  his will be a li
-000811a0: 7374 206f 6620 636f 6c75 6d6e 7320 7769  st of columns wi
-000811b0: 7468 2069 6e66 696e 6974 7920 2323 2323  th infinity ####
-000811c0: 0d0a 2020 2020 2020 2020 2020 2020 7265  ..            re
-000811d0: 7475 726e 2061 6464 5f63 6f6c 730d 0a20  turn add_cols.. 
-000811e0: 2020 2065 6c73 653a 0d0a 2020 2020 2020     else:..      
-000811f0: 2020 2323 2074 6869 7320 7769 6c6c 2062    ## this will b
-00081200: 6520 616e 2065 6d70 7479 206c 6973 7420  e an empty list 
-00081210: 6966 2074 6865 7265 2061 7265 206e 6f20  if there are no 
-00081220: 636f 6c75 6d6e 7320 7769 7468 2069 6e66  columns with inf
-00081230: 696e 6974 790d 0a20 2020 2020 2020 2072  inity..        r
-00081240: 6574 7572 6e20 6164 645f 636f 6c73 0d0a  eturn add_cols..
-00081250: 2323 2323 2323 2323 2323 2323 2323 2323  ################
+00080a00: 2320 2d2a 2d20 636f 6469 6e67 3a20 7574  # -*- coding: ut
+00080a10: 662d 3820 2d2a 2d0d 0a22 2222 5370 6563  f-8 -*-.."""Spec
+00080a20: 6966 6965 7320 7468 6520 7665 7273 696f  ifies the versio
+00080a30: 6e20 6f66 2074 6865 2041 7574 6f5f 5669  n of the Auto_Vi
+00080a40: 4d4c 2070 6163 6b61 6765 2e22 2222 0d0a  ML package."""..
+00080a50: 0d0a 5f5f 7469 746c 655f 5f20 3d20 2241  ..__title__ = "A
+00080a60: 7574 6f5f 5669 4d4c 220d 0a5f 5f61 7574  uto_ViML"..__aut
+00080a70: 686f 725f 5f20 3d20 2252 616d 2053 6573  hor__ = "Ram Ses
+00080a80: 6861 6472 6922 0d0a 5f5f 6465 7363 7269  hadri"..__descri
+00080a90: 7074 696f 6e5f 5f20 3d20 2241 7574 6f6d  ption__ = "Autom
+00080aa0: 6174 6963 616c 6c79 2042 7569 6c64 204d  atically Build M
+00080ab0: 756c 7469 706c 6520 496e 7465 7270 7265  ultiple Interpre
+00080ac0: 7461 626c 6520 4d4c 204d 6f64 656c 7320  table ML Models 
+00080ad0: 696e 2053 696e 676c 6520 4c69 6e65 206f  in Single Line o
+00080ae0: 6620 436f 6465 220d 0a5f 5f75 726c 5f5f  f Code"..__url__
+00080af0: 203d 2022 6874 7470 733a 2f2f 6769 7468   = "https://gith
+00080b00: 7562 2e63 6f6d 2f41 7574 6f56 694d 4c2f  ub.com/AutoViML/
+00080b10: 4175 746f 5f56 694d 4c2e 6769 7422 0d0a  Auto_ViML.git"..
+00080b20: 5f5f 7665 7273 696f 6e5f 5f20 3d20 2230  __version__ = "0
+00080b30: 2e31 2e37 3135 220d 0a5f 5f6e 6c70 5f76  .1.715"..__nlp_v
+00080b40: 6572 7369 6f6e 5f5f 203d 2022 302e 312e  ersion__ = "0.1.
+00080b50: 3031 220d 0a5f 5f6c 6963 656e 7365 5f5f  01"..__license__
+00080b60: 203d 2022 4170 6163 6865 204c 6963 656e   = "Apache Licen
+00080b70: 7365 2032 2e30 220d 0a5f 5f63 6f70 7972  se 2.0"..__copyr
+00080b80: 6967 6874 5f5f 203d 2022 3230 3230 2d32  ight__ = "2020-2
+00080b90: 3120 476f 6f67 6c65 220d 0a00 0000 0000  1 Google".......
+00080ba0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+00080bb0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+00080bc0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+00080bd0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+00080be0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+00080bf0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+00080c00: 2e2f 2e2f 4050 6178 4865 6164 6572 0000  ././@PaxHeader..
+00080c10: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+00080c20: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+00080c30: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+00080c40: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+00080c50: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+00080c60: 0000 0000 3030 3030 3030 3000 3030 3030  ....0000000.0000
+00080c70: 3030 3000 3030 3030 3030 3000 3030 3030  000.0000000.0000
+00080c80: 3030 3030 3032 3600 3030 3030 3030 3030  0000026.00000000
+00080c90: 3030 3000 3031 3134 3533 0020 7800 0000  000.011453. x...
+00080ca0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+00080cb0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+00080cc0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+00080cd0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+00080ce0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+00080cf0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+00080d00: 0075 7374 6172 0030 3000 0000 0000 0000  .ustar.00.......
+00080d10: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+00080d20: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+00080d30: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+00080d40: 0000 0000 0000 0000 0030 3030 3030 3030  .........0000000
+00080d50: 0030 3030 3030 3030 0000 0000 0000 0000  .0000000........
+00080d60: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+00080d70: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+00080d80: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+00080d90: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+00080da0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+00080db0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+00080dc0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+00080dd0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+00080de0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+00080df0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+00080e00: 3232 206d 7469 6d65 3d31 3637 3831 3539  22 mtime=1678159
+00080e10: 3732 322e 300a 0000 0000 0000 0000 0000  722.0...........
+00080e20: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+00080e30: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+00080e40: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+00080e50: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+00080e60: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+00080e70: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+00080e80: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+00080e90: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+00080ea0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+00080eb0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+00080ec0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+00080ed0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+00080ee0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+00080ef0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+00080f00: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+00080f10: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+00080f20: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+00080f30: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+00080f40: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+00080f50: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+00080f60: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+00080f70: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+00080f80: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+00080f90: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+00080fa0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+00080fb0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+00080fc0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+00080fd0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+00080fe0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+00080ff0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+00081000: 6175 746f 7669 6d6c 2d30 2e31 2e37 3135  autoviml-0.1.715
+00081010: 2f61 7574 6f76 696d 6c2f 636c 6173 7369  /autoviml/classi
+00081020: 6679 5f6d 6574 686f 642e 7079 0000 0000  fy_method.py....
+00081030: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+00081040: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+00081050: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+00081060: 0000 0000 3030 3030 3737 3700 3030 3031  ....0000777.0001
+00081070: 3735 3000 3030 3031 3735 3000 3030 3030  750.0001750.0000
+00081080: 3030 3433 3630 3200 3030 3030 3030 3030  0043602.00000000
+00081090: 3030 3000 3032 3035 3131 0020 3000 0000  000.020511. 0...
+000810a0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+000810b0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+000810c0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+000810d0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+000810e0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+000810f0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+00081100: 0075 7374 6172 0030 3072 616d 0000 0000  .ustar.00ram....
+00081110: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+00081120: 0000 0000 0000 0000 0072 616d 0000 0000  .........ram....
+00081130: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+00081140: 0000 0000 0000 0000 0030 3030 3030 3030  .........0000000
+00081150: 0030 3030 3030 3030 0000 0000 0000 0000  .0000000........
+00081160: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+00081170: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+00081180: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+00081190: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+000811a0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+000811b0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+000811c0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+000811d0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+000811e0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+000811f0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+00081200: 696d 706f 7274 206e 756d 7079 2061 7320  import numpy as 
+00081210: 6e70 0d0a 696d 706f 7274 2070 616e 6461  np..import panda
+00081220: 7320 6173 2070 640d 0a69 6d70 6f72 7420  s as pd..import 
+00081230: 7261 6e64 6f6d 0d0a 6e70 2e72 616e 646f  random..np.rando
+00081240: 6d2e 7365 6564 2839 3929 0d0a 7261 6e64  m.seed(99)..rand
+00081250: 6f6d 2e73 6565 6428 3432 290d 0a23 2323  om.seed(42)..###
 00081260: 2323 2323 2323 2323 2323 2323 2323 2323  ################
 00081270: 2323 2323 2323 2323 2323 2323 2323 2323  ################
 00081280: 2323 2323 2323 2323 2323 2323 2323 2323  ################
 00081290: 2323 2323 2323 2323 2323 2323 2323 2323  ################
-000812a0: 2323 2323 0d0a 6465 6620 636c 6173 7369  ####..def classi
-000812b0: 6679 5f63 6f6c 756d 6e73 2864 665f 7072  fy_columns(df_pr
-000812c0: 6564 732c 2076 6572 626f 7365 3d30 293a  eds, verbose=0):
-000812d0: 0d0a 2020 2020 2222 220d 0a20 2020 2054  ..    """..    T
-000812e0: 6869 7320 6163 7475 616c 6c79 2064 6f65  his actually doe
-000812f0: 7320 4578 706c 6f72 6174 6f72 7920 6461  s Exploratory da
-00081300: 7461 2061 6e61 6c79 7369 7320 2d20 6974  ta analysis - it
-00081310: 206d 6561 6e73 2074 6869 7320 6675 6e63   means this func
-00081320: 7469 6f6e 2070 6572 666f 726d 7320 4544  tion performs ED
-00081330: 410d 0a20 2020 2023 2323 2323 2323 2323  A..    #########
-00081340: 2323 2323 2323 2323 2323 2323 2323 2323  ################
-00081350: 2323 2323 2323 2323 2323 2323 2323 2323  ################
-00081360: 2323 2323 2323 2323 2323 2323 2323 2323  ################
-00081370: 2323 2323 2323 2323 2323 2323 2323 2323  ################
-00081380: 2323 2323 2323 2323 2323 2323 230d 0a20  #############.. 
-00081390: 2020 2054 616b 6573 2061 2064 6174 6166     Takes a dataf
-000813a0: 7261 6d65 2063 6f6e 7461 696e 696e 6720  rame containing 
-000813b0: 6f6e 6c79 2070 7265 6469 6374 6f72 7320  only predictors 
-000813c0: 746f 2062 6520 636c 6173 7369 6669 6564  to be classified
-000813d0: 2069 6e74 6f20 7661 7269 6f75 7320 7479   into various ty
-000813e0: 7065 732e 0d0a 2020 2020 444f 204e 4f54  pes...    DO NOT
-000813f0: 2053 454e 4420 494e 2041 2054 4152 4745   SEND IN A TARGE
-00081400: 5420 434f 4c55 4d4e 2073 696e 6365 2069  T COLUMN since i
-00081410: 7420 7769 6c6c 2074 7279 2074 6f20 696e  t will try to in
-00081420: 636c 7564 6520 7468 6174 2069 6e74 6f20  clude that into 
-00081430: 7661 7269 6f75 7320 636f 6c75 6d6e 732e  various columns.
-00081440: 0d0a 2020 2020 5265 7475 726e 7320 6120  ..    Returns a 
-00081450: 6461 7461 2066 7261 6d65 2063 6f6e 7461  data frame conta
-00081460: 696e 696e 6720 636f 6c75 6d6e 7320 616e  ining columns an
-00081470: 6420 7468 6520 636c 6173 7320 6974 2062  d the class it b
-00081480: 656c 6f6e 6773 2074 6f20 7375 6368 2061  elongs to such a
-00081490: 7320 6e75 6d65 7269 632c 0d0a 2020 2020  s numeric,..    
-000814a0: 6361 7465 676f 7269 6361 6c2c 2064 6174  categorical, dat
-000814b0: 6520 6f72 2069 6420 636f 6c75 6d6e 2c20  e or id column, 
-000814c0: 626f 6f6c 6561 6e2c 206e 6c70 2c20 6469  boolean, nlp, di
-000814d0: 7363 7265 7465 5f73 7472 696e 6720 616e  screte_string an
-000814e0: 6420 636f 6c73 2074 6f20 6465 6c65 7465  d cols to delete
-000814f0: 2e2e 2e0d 0a20 2020 2023 2323 2323 2323  .....    #######
-00081500: 2052 6574 7572 6e73 2061 2064 6963 7469   Returns a dicti
-00081510: 6f6e 6172 7920 7769 7468 2031 3020 6b69  onary with 10 ki
-00081520: 6e64 7320 6f66 2076 6172 7320 6c69 6b65  nds of vars like
-00081530: 2074 6865 2066 6f6c 6c6f 7769 6e67 3a20   the following: 
-00081540: 2320 636f 6e74 696e 756f 7573 5f76 6172  # continuous_var
-00081550: 732c 696e 745f 7661 7273 0d0a 2020 2020  s,int_vars..    
-00081560: 2320 6361 745f 7661 7273 2c66 6163 746f  # cat_vars,facto
-00081570: 725f 7661 7273 2c20 626f 6f6c 5f76 6172  r_vars, bool_var
-00081580: 732c 6469 7363 7265 7465 5f73 7472 696e  s,discrete_strin
-00081590: 675f 7661 7273 2c6e 6c70 5f76 6172 732c  g_vars,nlp_vars,
-000815a0: 6461 7465 5f76 6172 732c 6964 5f76 6172  date_vars,id_var
-000815b0: 732c 636f 6c73 5f64 656c 6574 650d 0a20  s,cols_delete.. 
-000815c0: 2020 2022 2222 0d0a 2020 2020 7472 6169     """..    trai
-000815d0: 6e20 3d20 636f 7079 2e64 6565 7063 6f70  n = copy.deepcop
-000815e0: 7928 6466 5f70 7265 6473 290d 0a20 2020  y(df_preds)..   
-000815f0: 2023 2323 2320 4966 2074 6865 7265 2061   #### If there a
-00081600: 7265 2033 3020 6368 6172 7320 6172 6520  re 30 chars are 
-00081610: 6d6f 7265 2069 6e20 6120 6469 7363 7265  more in a discre
-00081620: 7465 5f73 7472 696e 675f 7661 722c 2069  te_string_var, i
-00081630: 7420 6973 2074 6865 6e20 636f 6e73 6964  t is then consid
-00081640: 6572 6564 2061 6e20 4e4c 5020 7661 7269  ered an NLP vari
-00081650: 6162 6c65 0d0a 2020 2020 6d61 785f 6e6c  able..    max_nl
-00081660: 705f 6368 6172 5f73 697a 6520 3d20 3330  p_char_size = 30
-00081670: 0d0a 2020 2020 6d61 785f 636f 6c73 5f74  ..    max_cols_t
-00081680: 6f5f 7072 696e 7420 3d20 3330 0d0a 2020  o_print = 30..  
-00081690: 2020 7072 696e 7428 2723 2323 2323 2323    print('#######
-000816a0: 2323 2323 2323 2323 2323 2323 2323 2323  ################
-000816b0: 2323 2323 2323 2323 2323 2323 2323 2323  ################
-000816c0: 2323 2323 2323 2323 2323 2323 2323 2323  ################
-000816d0: 2323 2323 2323 2323 2323 2323 2323 2323  ################
-000816e0: 2323 2323 2323 2323 2323 2323 2323 2323  ################
-000816f0: 2729 0d0a 2020 2020 7072 696e 7428 2723  ')..    print('#
-00081700: 2323 2323 2323 2323 2323 2323 2323 2323  ################
-00081710: 2323 2323 2323 2320 4320 4c20 4120 5320  ####### C L A S 
-00081720: 5320 4920 4620 5920 4920 4e20 4720 2056  S I F Y I N G  V
-00081730: 2041 2052 2049 2041 2042 204c 2045 2053   A R I A B L E S
-00081740: 2020 2323 2323 2323 2323 2323 2323 2323    ##############
-00081750: 2323 2323 2323 2729 0d0a 2020 2020 7072  ######')..    pr
-00081760: 696e 7428 2723 2323 2323 2323 2323 2323  int('###########
-00081770: 2323 2323 2323 2323 2323 2323 2323 2323  ################
-00081780: 2323 2323 2323 2323 2323 2323 2323 2323  ################
-00081790: 2323 2323 2323 2323 2323 2323 2323 2323  ################
-000817a0: 2323 2323 2323 2323 2323 2323 2323 2323  ################
-000817b0: 2323 2323 2323 2323 2323 2323 2729 0d0a  ############')..
-000817c0: 2020 2020 7072 696e 7428 2743 6c61 7373      print('Class
-000817d0: 6966 7969 6e67 2076 6172 6961 626c 6573  ifying variables
-000817e0: 2069 6e20 6461 7461 2073 6574 2e2e 2e27   in data set...'
-000817f0: 290d 0a20 2020 2023 2323 2320 4361 745f  )..    #### Cat_
-00081800: 4c69 6d69 7420 6465 6669 6e65 7320 7468  Limit defines th
-00081810: 6520 6d61 7820 6e75 6d62 6572 206f 6620  e max number of 
-00081820: 6361 7465 676f 7269 6573 2061 2063 6f6c  categories a col
-00081830: 756d 6e20 6361 6e20 6861 7665 2074 6f20  umn can have to 
-00081840: 6265 2063 616c 6c65 6420 6120 6361 7465  be called a cate
-00081850: 676f 7269 6361 6c20 636f 6c75 6d0d 0a20  gorical colum.. 
-00081860: 2020 2063 6174 5f6c 696d 6974 203d 2033     cat_limit = 3
-00081870: 350d 0a20 2020 2066 6c6f 6174 5f6c 696d  5..    float_lim
-00081880: 6974 203d 2031 3520 2323 2323 204d 616b  it = 15 #### Mak
-00081890: 6520 7468 6973 206c 696d 6974 206c 6f77  e this limit low
-000818a0: 2073 6f20 7468 6174 2066 6c6f 6174 2076   so that float v
-000818b0: 6172 6961 626c 6573 2062 656c 6f77 2074  ariables below t
-000818c0: 6869 7320 6c69 6d69 7420 6265 636f 6d65  his limit become
-000818d0: 2063 6174 2076 6172 7320 2323 230d 0a20   cat vars ###.. 
-000818e0: 2020 2064 6566 2061 6464 2861 2c62 293a     def add(a,b):
-000818f0: 0d0a 2020 2020 2020 2020 7265 7475 726e  ..        return
-00081900: 2061 2b62 0d0a 2020 2020 7375 6d5f 616c   a+b..    sum_al
-00081910: 6c5f 636f 6c73 203d 2064 6963 7428 290d  l_cols = dict().
-00081920: 0a20 2020 206f 7269 675f 636f 6c73 5f74  .    orig_cols_t
-00081930: 6f74 616c 203d 2074 7261 696e 2e73 6861  otal = train.sha
-00081940: 7065 5b31 5d0d 0a20 2020 2023 5479 7065  pe[1]..    #Type
-00081950: 7320 6f66 2063 6f6c 756d 6e73 0d0a 2020  s of columns..  
-00081960: 2020 636f 6c73 5f64 656c 6574 6520 3d20    cols_delete = 
-00081970: 5b5d 0d0a 2020 2020 636f 6c73 5f64 656c  []..    cols_del
-00081980: 6574 6520 3d20 5b63 6f6c 2066 6f72 2063  ete = [col for c
-00081990: 6f6c 2069 6e20 6c69 7374 2874 7261 696e  ol in list(train
-000819a0: 2920 6966 2028 6c65 6e28 7472 6169 6e5b  ) if (len(train[
-000819b0: 636f 6c5d 2e76 616c 7565 5f63 6f75 6e74  col].value_count
-000819c0: 7328 2929 203d 3d20 310d 0a20 2020 2020  s()) == 1..     
-000819d0: 2020 2020 2020 2020 2020 2020 2020 2020                  
-000819e0: 2020 2020 2020 2020 2020 2020 2020 2020                  
-000819f0: 2020 2920 7c20 2874 7261 696e 5b63 6f6c    ) | (train[col
-00081a00: 5d2e 6973 6e75 6c6c 2829 2e73 756d 2829  ].isnull().sum()
-00081a10: 2f6c 656e 2874 7261 696e 2920 3e3d 2030  /len(train) >= 0
-00081a20: 2e39 3029 5d0d 0a20 2020 2069 6e66 5f63  .90)]..    inf_c
-00081a30: 6f6c 7320 3d20 4544 415f 6669 6e64 5f72  ols = EDA_find_r
-00081a40: 656d 6f76 655f 636f 6c75 6d6e 735f 7769  emove_columns_wi
-00081a50: 7468 5f69 6e66 696e 6974 7928 7472 6169  th_infinity(trai
-00081a60: 6e29 0d0a 2020 2020 6d69 7865 645f 636f  n)..    mixed_co
-00081a70: 6c73 203d 205b 7820 666f 7220 7820 696e  ls = [x for x in
-00081a80: 206c 6973 7428 7472 6169 6e29 2069 6620   list(train) if 
-00081a90: 6c65 6e28 7472 6169 6e5b 785d 2e64 726f  len(train[x].dro
-00081aa0: 706e 6128 292e 6170 706c 7928 7479 7065  pna().apply(type
-00081ab0: 292e 7661 6c75 655f 636f 756e 7473 2829  ).value_counts()
-00081ac0: 2920 3e20 315d 0d0a 2020 2020 6966 206c  ) > 1]..    if l
-00081ad0: 656e 286d 6978 6564 5f63 6f6c 7329 203e  en(mixed_cols) >
-00081ae0: 2030 3a0d 0a20 2020 2020 2020 2070 7269   0:..        pri
-00081af0: 6e74 2827 2020 2020 5265 6d6f 7669 6e67  nt('    Removing
-00081b00: 2025 7320 636f 6c75 6d6e 2873 2920 6475   %s column(s) du
-00081b10: 6520 746f 206d 6978 6564 2064 6174 6120  e to mixed data 
-00081b20: 7479 7065 2064 6574 6563 7465 642e 2e2e  type detected...
-00081b30: 2720 256d 6978 6564 5f63 6f6c 7329 0d0a  ' %mixed_cols)..
-00081b40: 2020 2020 636f 6c73 5f64 656c 6574 6520      cols_delete 
-00081b50: 2b3d 206d 6978 6564 5f63 6f6c 730d 0a20  += mixed_cols.. 
-00081b60: 2020 2063 6f6c 735f 6465 6c65 7465 202b     cols_delete +
-00081b70: 3d20 696e 665f 636f 6c73 0d0a 2020 2020  = inf_cols..    
-00081b80: 7472 6169 6e20 3d20 7472 6169 6e5b 6c65  train = train[le
-00081b90: 6674 5f73 7562 7472 6163 7428 6c69 7374  ft_subtract(list
-00081ba0: 2874 7261 696e 292c 636f 6c73 5f64 656c  (train),cols_del
-00081bb0: 6574 6529 5d0d 0a20 2020 2076 6172 5f64  ete)]..    var_d
-00081bc0: 6620 3d20 7064 2e53 6572 6965 7328 6469  f = pd.Series(di
-00081bd0: 6374 2874 7261 696e 2e64 7479 7065 7329  ct(train.dtypes)
-00081be0: 292e 7265 7365 745f 696e 6465 7828 6472  ).reset_index(dr
-00081bf0: 6f70 3d46 616c 7365 292e 7265 6e61 6d65  op=False).rename
-00081c00: 280d 0a20 2020 2020 2020 2020 2020 2020  (..             
-00081c10: 2020 2020 2020 2020 2020 2063 6f6c 756d             colum
-00081c20: 6e73 3d7b 303a 2774 7970 655f 6f66 5f63  ns={0:'type_of_c
-00081c30: 6f6c 756d 6e27 7d29 0d0a 2020 2020 7375  olumn'})..    su
-00081c40: 6d5f 616c 6c5f 636f 6c73 5b27 636f 6c73  m_all_cols['cols
-00081c50: 5f64 656c 6574 6527 5d20 3d20 636f 6c73  _delete'] = cols
-00081c60: 5f64 656c 6574 650d 0a0d 0a20 2020 2076  _delete....    v
-00081c70: 6172 5f64 665b 2762 6f6f 6c27 5d20 3d20  ar_df['bool'] = 
-00081c80: 7661 725f 6466 2e61 7070 6c79 286c 616d  var_df.apply(lam
-00081c90: 6264 6120 783a 2031 2069 6620 785b 2774  bda x: 1 if x['t
-00081ca0: 7970 655f 6f66 5f63 6f6c 756d 6e27 5d20  ype_of_column'] 
-00081cb0: 696e 205b 2762 6f6f 6c27 2c27 6f62 6a65  in ['bool','obje
-00081cc0: 6374 275d 0d0a 2020 2020 2020 2020 2020  ct']..          
-00081cd0: 2020 2020 2020 2020 2020 2020 2020 616e                an
-00081ce0: 6420 6c65 6e28 7472 6169 6e5b 785b 2769  d len(train[x['i
-00081cf0: 6e64 6578 275d 5d2e 7661 6c75 655f 636f  ndex']].value_co
-00081d00: 756e 7473 2829 2920 3d3d 2032 2065 6c73  unts()) == 2 els
-00081d10: 6520 302c 2061 7869 733d 3129 0d0a 2020  e 0, axis=1)..  
-00081d20: 2020 7374 7269 6e67 5f62 6f6f 6c5f 7661    string_bool_va
-00081d30: 7273 203d 206c 6973 7428 7661 725f 6466  rs = list(var_df
-00081d40: 5b28 7661 725f 6466 5b27 626f 6f6c 275d  [(var_df['bool']
-00081d50: 203d 3d31 295d 5b27 696e 6465 7827 5d29   ==1)]['index'])
-00081d60: 0d0a 2020 2020 7375 6d5f 616c 6c5f 636f  ..    sum_all_co
-00081d70: 6c73 5b27 7374 7269 6e67 5f62 6f6f 6c5f  ls['string_bool_
-00081d80: 7661 7273 275d 203d 2073 7472 696e 675f  vars'] = string_
-00081d90: 626f 6f6c 5f76 6172 730d 0a20 2020 2076  bool_vars..    v
-00081da0: 6172 5f64 665b 276e 756d 5f62 6f6f 6c27  ar_df['num_bool'
-00081db0: 5d20 3d20 7661 725f 6466 2e61 7070 6c79  ] = var_df.apply
-00081dc0: 286c 616d 6264 6120 783a 2031 2069 6620  (lambda x: 1 if 
-00081dd0: 785b 2774 7970 655f 6f66 5f63 6f6c 756d  x['type_of_colum
-00081de0: 6e27 5d20 696e 205b 6e70 2e75 696e 7438  n'] in [np.uint8
-00081df0: 2c0d 0a20 2020 2020 2020 2020 2020 2020  ,..             
-00081e00: 2020 2020 2020 2020 2020 2020 2020 206e                 n
-00081e10: 702e 7569 6e74 3136 2c20 6e70 2e75 696e  p.uint16, np.uin
-00081e20: 7433 322c 206e 702e 7569 6e74 3634 2c0d  t32, np.uint64,.
-00081e30: 0a20 2020 2020 2020 2020 2020 2020 2020  .               
-00081e40: 2020 2020 2020 2020 2020 2020 2027 696e               'in
-00081e50: 7438 272c 2769 6e74 3136 272c 2769 6e74  t8','int16','int
-00081e60: 3332 272c 2769 6e74 3634 272c 0d0a 2020  32','int64',..  
-00081e70: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00081e80: 2020 2020 2020 2020 2020 2766 6c6f 6174            'float
-00081e90: 3136 272c 2766 6c6f 6174 3332 272c 2766  16','float32','f
-00081ea0: 6c6f 6174 3634 275d 2061 6e64 206c 656e  loat64'] and len
-00081eb0: 280d 0a20 2020 2020 2020 2020 2020 2020  (..             
-00081ec0: 2020 2020 2020 2020 2020 2074 7261 696e             train
-00081ed0: 5b78 5b27 696e 6465 7827 5d5d 2e76 616c  [x['index']].val
-00081ee0: 7565 5f63 6f75 6e74 7328 2929 203d 3d20  ue_counts()) == 
-00081ef0: 3220 656c 7365 2030 2c20 6178 6973 3d31  2 else 0, axis=1
-00081f00: 290d 0a20 2020 206e 756d 5f62 6f6f 6c5f  )..    num_bool_
-00081f10: 7661 7273 203d 206c 6973 7428 7661 725f  vars = list(var_
-00081f20: 6466 5b28 7661 725f 6466 5b27 6e75 6d5f  df[(var_df['num_
-00081f30: 626f 6f6c 275d 203d 3d31 295d 5b27 696e  bool'] ==1)]['in
-00081f40: 6465 7827 5d29 0d0a 2020 2020 7375 6d5f  dex'])..    sum_
-00081f50: 616c 6c5f 636f 6c73 5b27 6e75 6d5f 626f  all_cols['num_bo
-00081f60: 6f6c 5f76 6172 7327 5d20 3d20 6e75 6d5f  ol_vars'] = num_
-00081f70: 626f 6f6c 5f76 6172 730d 0a20 2020 2023  bool_vars..    #
-00081f80: 2323 2323 2320 2020 5468 6973 2069 7320  #####   This is 
-00081f90: 7768 6572 6520 7765 2074 616b 6520 616c  where we take al
-00081fa0: 6c20 4f62 6a65 6374 2076 6172 7320 616e  l Object vars an
-00081fb0: 6420 7370 6c69 7420 7468 656d 2069 6e74  d split them int
-00081fc0: 6f20 6469 6666 206b 696e 6473 2023 2323  o diff kinds ###
-00081fd0: 0d0a 2020 2020 6469 7363 7265 7465 5f6f  ..    discrete_o
-00081fe0: 725f 6e6c 7020 3d20 7661 725f 6466 2e61  r_nlp = var_df.a
-00081ff0: 7070 6c79 286c 616d 6264 6120 783a 2031  pply(lambda x: 1
-00082000: 2069 6620 785b 2774 7970 655f 6f66 5f63   if x['type_of_c
-00082010: 6f6c 756d 6e27 5d20 696e 205b 276f 626a  olumn'] in ['obj
-00082020: 6563 7427 5d20 2061 6e64 2078 5b0d 0a20  ect']  and x[.. 
-00082030: 2020 2020 2020 2027 696e 6465 7827 5d20         'index'] 
-00082040: 6e6f 7420 696e 2073 7472 696e 675f 626f  not in string_bo
-00082050: 6f6c 5f76 6172 732b 636f 6c73 5f64 656c  ol_vars+cols_del
-00082060: 6574 6520 656c 7365 2030 2c61 7869 733d  ete else 0,axis=
-00082070: 3129 0d0a 2020 2020 2323 2323 2323 2323  1)..    ########
-00082080: 2320 5468 6973 2069 7320 7768 6572 6520  # This is where 
-00082090: 7765 2066 6967 7572 6520 6f75 7420 7768  we figure out wh
-000820a0: 6574 6865 7220 6120 7374 7269 6e67 2076  ether a string v
-000820b0: 6172 2069 7320 6e6c 7020 6f72 2064 6973  ar is nlp or dis
-000820c0: 6372 6574 655f 7374 7269 6e67 2076 6172  crete_string var
-000820d0: 2023 2323 0d0a 2020 2020 7661 725f 6466   ###..    var_df
-000820e0: 5b27 6e6c 705f 7374 7269 6e67 7327 5d20  ['nlp_strings'] 
-000820f0: 3d20 300d 0a20 2020 2076 6172 5f64 665b  = 0..    var_df[
-00082100: 2764 6973 6372 6574 655f 7374 7269 6e67  'discrete_string
-00082110: 7327 5d20 3d20 300d 0a20 2020 2076 6172  s'] = 0..    var
-00082120: 5f64 665b 2763 6174 275d 203d 2030 0d0a  _df['cat'] = 0..
-00082130: 2020 2020 7661 725f 6466 5b27 6964 5f63      var_df['id_c
-00082140: 6f6c 275d 203d 2030 0d0a 2020 2020 6469  ol'] = 0..    di
-00082150: 7363 7265 7465 5f6f 725f 6e6c 705f 7661  screte_or_nlp_va
-00082160: 7273 203d 2076 6172 5f64 662e 6c6f 635b  rs = var_df.loc[
-00082170: 6469 7363 7265 7465 5f6f 725f 6e6c 703d  discrete_or_nlp=
-00082180: 3d31 5d5b 2769 6e64 6578 275d 2e76 616c  =1]['index'].val
-00082190: 7565 732e 746f 6c69 7374 2829 0d0a 2020  ues.tolist()..  
-000821a0: 2020 636f 7079 5f64 6973 6372 6574 655f    copy_discrete_
-000821b0: 6f72 5f6e 6c70 5f76 6172 7320 3d20 636f  or_nlp_vars = co
-000821c0: 7079 2e64 6565 7063 6f70 7928 6469 7363  py.deepcopy(disc
-000821d0: 7265 7465 5f6f 725f 6e6c 705f 7661 7273  rete_or_nlp_vars
-000821e0: 290d 0a20 2020 2069 6620 6c65 6e28 6469  )..    if len(di
-000821f0: 7363 7265 7465 5f6f 725f 6e6c 705f 7661  screte_or_nlp_va
-00082200: 7273 2920 3e20 303a 0d0a 2020 2020 2020  rs) > 0:..      
-00082210: 2020 666f 7220 636f 6c20 696e 2063 6f70    for col in cop
-00082220: 795f 6469 7363 7265 7465 5f6f 725f 6e6c  y_discrete_or_nl
-00082230: 705f 7661 7273 3a0d 0a20 2020 2020 2020  p_vars:..       
-00082240: 2020 2020 2023 2323 2320 6669 7273 7420       #### first 
-00082250: 6669 6c6c 2065 6d70 7479 206f 7220 6d69  fill empty or mi
-00082260: 7373 696e 6720 7661 6c73 2073 696e 6365  ssing vals since
-00082270: 2069 7420 7769 6c6c 2062 6c6f 7775 7020   it will blowup 
-00082280: 2323 230d 0a20 2020 2020 2020 2020 2020  ###..           
-00082290: 2023 2323 2052 656d 656d 6265 7220 7468   ### Remember th
-000822a0: 6174 2066 696c 6c6e 6120 6f6e 6c79 2077  at fillna only w
-000822b0: 6f72 6b73 2061 7420 7468 6520 6461 7461  orks at the data
-000822c0: 6672 616d 6520 6c65 7665 6c21 0d0a 2020  frame level!..  
-000822d0: 2020 2020 2020 2020 2020 7472 6169 6e5b            train[
-000822e0: 5b63 6f6c 5d5d 203d 2074 7261 696e 5b5b  [col]] = train[[
-000822f0: 636f 6c5d 5d2e 6669 6c6c 6e61 2827 2020  col]].fillna('  
-00082300: 2729 0d0a 2020 2020 2020 2020 2020 2020  ')..            
-00082310: 6966 2074 7261 696e 5b63 6f6c 5d2e 6d61  if train[col].ma
-00082320: 7028 6c61 6d62 6461 2078 3a20 6c65 6e28  p(lambda x: len(
-00082330: 7829 2069 6620 7479 7065 2878 293d 3d73  x) if type(x)==s
-00082340: 7472 2065 6c73 6520 3029 2e6d 6178 280d  tr else 0).max(.
-00082350: 0a20 2020 2020 2020 2020 2020 2020 2020  .               
-00082360: 2029 203e 3d20 3530 2061 6e64 206c 656e   ) >= 50 and len
-00082370: 2874 7261 696e 5b63 6f6c 5d2e 7661 6c75  (train[col].valu
-00082380: 655f 636f 756e 7473 2829 0d0a 2020 2020  e_counts()..    
-00082390: 2020 2020 2020 2020 2020 2020 2020 2020                  
-000823a0: 2020 2020 2920 3e3d 2069 6e74 2830 2e39      ) >= int(0.9
-000823b0: 2a6c 656e 2874 7261 696e 2929 2061 6e64  *len(train)) and
-000823c0: 2063 6f6c 206e 6f74 2069 6e20 7374 7269   col not in stri
-000823d0: 6e67 5f62 6f6f 6c5f 7661 7273 3a0d 0a20  ng_bool_vars:.. 
-000823e0: 2020 2020 2020 2020 2020 2020 2020 2076                 v
-000823f0: 6172 5f64 662e 6c6f 635b 7661 725f 6466  ar_df.loc[var_df
-00082400: 5b27 696e 6465 7827 5d3d 3d63 6f6c 2c27  ['index']==col,'
-00082410: 6e6c 705f 7374 7269 6e67 7327 5d20 3d20  nlp_strings'] = 
-00082420: 310d 0a20 2020 2020 2020 2020 2020 2065  1..            e
-00082430: 6c69 6620 7472 6169 6e5b 636f 6c5d 2e6d  lif train[col].m
-00082440: 6170 286c 616d 6264 6120 783a 206c 656e  ap(lambda x: len
-00082450: 2878 2920 6966 2074 7970 6528 7829 3d3d  (x) if type(x)==
-00082460: 7374 7220 656c 7365 2030 292e 6d65 616e  str else 0).mean
-00082470: 280d 0a20 2020 2020 2020 2020 2020 2020  (..             
-00082480: 2020 2029 203e 3d20 6d61 785f 6e6c 705f     ) >= max_nlp_
-00082490: 6368 6172 5f73 697a 6520 616e 6420 7472  char_size and tr
-000824a0: 6169 6e5b 636f 6c5d 2e6d 6170 286c 616d  ain[col].map(lam
-000824b0: 6264 6120 783a 206c 656e 2878 2920 6966  bda x: len(x) if
-000824c0: 2074 7970 6528 7829 3d3d 7374 7220 656c   type(x)==str el
-000824d0: 7365 2030 292e 6d61 7828 0d0a 2020 2020  se 0).max(..    
-000824e0: 2020 2020 2020 2020 2020 2020 2920 3c20              ) < 
-000824f0: 3530 2061 6e64 206c 656e 2874 7261 696e  50 and len(train
-00082500: 5b63 6f6c 5d2e 7661 6c75 655f 636f 756e  [col].value_coun
-00082510: 7473 2829 0d0a 2020 2020 2020 2020 2020  ts()..          
-00082520: 2020 2020 2020 2020 2020 2020 2020 2920                ) 
-00082530: 3c3d 2069 6e74 2830 2e39 2a6c 656e 2874  <= int(0.9*len(t
-00082540: 7261 696e 2929 2061 6e64 2063 6f6c 206e  rain)) and col n
-00082550: 6f74 2069 6e20 7374 7269 6e67 5f62 6f6f  ot in string_boo
-00082560: 6c5f 7661 7273 3a0d 0a20 2020 2020 2020  l_vars:..       
-00082570: 2020 2020 2020 2020 2076 6172 5f64 662e           var_df.
-00082580: 6c6f 635b 7661 725f 6466 5b27 696e 6465  loc[var_df['inde
-00082590: 7827 5d3d 3d63 6f6c 2c27 6469 7363 7265  x']==col,'discre
-000825a0: 7465 5f73 7472 696e 6773 275d 203d 2031  te_strings'] = 1
-000825b0: 0d0a 2020 2020 2020 2020 2020 2020 656c  ..            el
-000825c0: 6966 206c 656e 2874 7261 696e 5b63 6f6c  if len(train[col
-000825d0: 5d2e 7661 6c75 655f 636f 756e 7473 2829  ].value_counts()
-000825e0: 2920 3e20 6361 745f 6c69 6d69 7420 616e  ) > cat_limit an
-000825f0: 6420 6c65 6e28 7472 6169 6e5b 636f 6c5d  d len(train[col]
-00082600: 2e76 616c 7565 5f63 6f75 6e74 7328 290d  .value_counts().
-00082610: 0a20 2020 2020 2020 2020 2020 2020 2020  .               
-00082620: 2020 2020 2020 2020 2029 203c 3d20 696e           ) <= in
-00082630: 7428 302e 392a 6c65 6e28 7472 6169 6e29  t(0.9*len(train)
-00082640: 2920 616e 6420 636f 6c20 6e6f 7420 696e  ) and col not in
-00082650: 2073 7472 696e 675f 626f 6f6c 5f76 6172   string_bool_var
-00082660: 733a 0d0a 2020 2020 2020 2020 2020 2020  s:..            
-00082670: 2020 2020 7661 725f 6466 2e6c 6f63 5b76      var_df.loc[v
-00082680: 6172 5f64 665b 2769 6e64 6578 275d 3d3d  ar_df['index']==
-00082690: 636f 6c2c 2764 6973 6372 6574 655f 7374  col,'discrete_st
-000826a0: 7269 6e67 7327 5d20 3d20 310d 0a20 2020  rings'] = 1..   
-000826b0: 2020 2020 2020 2020 2065 6c69 6620 6c65           elif le
-000826c0: 6e28 7472 6169 6e5b 636f 6c5d 2e76 616c  n(train[col].val
-000826d0: 7565 5f63 6f75 6e74 7328 2929 203e 2063  ue_counts()) > c
-000826e0: 6174 5f6c 696d 6974 2061 6e64 206c 656e  at_limit and len
-000826f0: 2874 7261 696e 5b63 6f6c 5d2e 7661 6c75  (train[col].valu
-00082700: 655f 636f 756e 7473 2829 0d0a 2020 2020  e_counts()..    
-00082710: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00082720: 2020 2020 2920 3d3d 206c 656e 2874 7261      ) == len(tra
-00082730: 696e 2920 616e 6420 636f 6c20 6e6f 7420  in) and col not 
-00082740: 696e 2073 7472 696e 675f 626f 6f6c 5f76  in string_bool_v
-00082750: 6172 733a 0d0a 2020 2020 2020 2020 2020  ars:..          
-00082760: 2020 2020 2020 7661 725f 6466 2e6c 6f63        var_df.loc
-00082770: 5b76 6172 5f64 665b 2769 6e64 6578 275d  [var_df['index']
-00082780: 3d3d 636f 6c2c 2769 645f 636f 6c27 5d20  ==col,'id_col'] 
-00082790: 3d20 310d 0a20 2020 2020 2020 2020 2020  = 1..           
-000827a0: 2065 6c73 653a 0d0a 2020 2020 2020 2020   else:..        
-000827b0: 2020 2020 2020 2020 7661 725f 6466 2e6c          var_df.l
-000827c0: 6f63 5b76 6172 5f64 665b 2769 6e64 6578  oc[var_df['index
-000827d0: 275d 3d3d 636f 6c2c 2763 6174 275d 203d  ']==col,'cat'] =
-000827e0: 2031 0d0a 2020 2020 6e6c 705f 7661 7273   1..    nlp_vars
-000827f0: 203d 206c 6973 7428 7661 725f 6466 5b28   = list(var_df[(
-00082800: 7661 725f 6466 5b27 6e6c 705f 7374 7269  var_df['nlp_stri
-00082810: 6e67 7327 5d20 3d3d 3129 5d5b 2769 6e64  ngs'] ==1)]['ind
-00082820: 6578 275d 290d 0a20 2020 2073 756d 5f61  ex'])..    sum_a
-00082830: 6c6c 5f63 6f6c 735b 276e 6c70 5f76 6172  ll_cols['nlp_var
-00082840: 7327 5d20 3d20 6e6c 705f 7661 7273 0d0a  s'] = nlp_vars..
-00082850: 2020 2020 6469 7363 7265 7465 5f73 7472      discrete_str
-00082860: 696e 675f 7661 7273 203d 206c 6973 7428  ing_vars = list(
-00082870: 7661 725f 6466 5b28 7661 725f 6466 5b27  var_df[(var_df['
-00082880: 6469 7363 7265 7465 5f73 7472 696e 6773  discrete_strings
-00082890: 275d 203d 3d31 2920 5d5b 2769 6e64 6578  '] ==1) ]['index
-000828a0: 275d 290d 0a20 2020 2073 756d 5f61 6c6c  '])..    sum_all
-000828b0: 5f63 6f6c 735b 2764 6973 6372 6574 655f  _cols['discrete_
-000828c0: 7374 7269 6e67 5f76 6172 7327 5d20 3d20  string_vars'] = 
-000828d0: 6469 7363 7265 7465 5f73 7472 696e 675f  discrete_string_
-000828e0: 7661 7273 0d0a 2020 2020 2323 2323 2323  vars..    ######
-000828f0: 2054 6869 7320 6861 7070 656e 7320 6f6e   This happens on
-00082900: 6c79 2069 6620 6120 7374 7269 6e67 2063  ly if a string c
-00082910: 6f6c 756d 6e20 6861 7070 656e 7320 746f  olumn happens to
-00082920: 2062 6520 616e 2049 4420 636f 6c75 6d6e   be an ID column
-00082930: 2023 2323 2323 2323 0d0a 2020 2020 2323   #######..    ##
-00082940: 2323 2044 4f20 4e4f 5420 4164 6420 7468  ## DO NOT Add th
-00082950: 6973 2074 6f20 4944 5f56 4152 5320 7965  is to ID_VARS ye
-00082960: 742e 2049 7420 7769 6c6c 2062 6520 646f  t. It will be do
-00082970: 6e65 206c 6174 6572 2e2e 2044 6f6e 7420  ne later.. Dont 
-00082980: 6368 616e 6765 2069 7420 6561 7369 6c79  change it easily
-00082990: 2e2e 2e0d 0a20 2020 2023 2323 2320 4361  .....    #### Ca
-000829a0: 7465 676f 7279 2044 5459 5045 2076 6172  tegory DTYPE var
-000829b0: 7320 6172 6520 7665 7279 2073 7065 6369  s are very speci
-000829c0: 616c 203d 2074 6865 7920 6361 6e20 6265  al = they can be
-000829d0: 206c 6566 7420 6173 2069 7320 616e 6420   left as is and 
-000829e0: 6e6f 7420 6469 7374 7572 6265 6420 696e  not disturbed in
-000829f0: 2050 7974 686f 6e2e 2023 2323 0d0a 2020   Python. ###..  
-00082a00: 2020 7661 725f 6466 5b27 6463 6174 275d    var_df['dcat']
-00082a10: 203d 2076 6172 5f64 662e 6170 706c 7928   = var_df.apply(
-00082a20: 6c61 6d62 6461 2078 3a20 3120 6966 2073  lambda x: 1 if s
-00082a30: 7472 2878 5b27 7479 7065 5f6f 665f 636f  tr(x['type_of_co
-00082a40: 6c75 6d6e 275d 293d 3d27 6361 7465 676f  lumn'])=='catego
-00082a50: 7279 2720 656c 7365 2030 2c0d 0a20 2020  ry' else 0,..   
-00082a60: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00082a70: 2020 2020 2020 2020 2061 7869 733d 3129           axis=1)
-00082a80: 0d0a 2020 2020 6661 6374 6f72 5f76 6172  ..    factor_var
-00082a90: 7320 3d20 6c69 7374 2876 6172 5f64 665b  s = list(var_df[
-00082aa0: 2876 6172 5f64 665b 2764 6361 7427 5d20  (var_df['dcat'] 
-00082ab0: 3d3d 3129 5d5b 2769 6e64 6578 275d 290d  ==1)]['index']).
-00082ac0: 0a20 2020 2073 756d 5f61 6c6c 5f63 6f6c  .    sum_all_col
-00082ad0: 735b 2766 6163 746f 725f 7661 7273 275d  s['factor_vars']
-00082ae0: 203d 2066 6163 746f 725f 7661 7273 0d0a   = factor_vars..
-00082af0: 2020 2020 2323 2323 2323 2323 2323 2323      ############
-00082b00: 2323 2323 2323 2323 2323 2323 2323 2323  ################
-00082b10: 2323 2323 2323 2323 2323 2323 2323 2323  ################
-00082b20: 2323 2323 2323 2323 2323 2323 2323 2323  ################
-00082b30: 2323 2323 2323 2323 2323 2323 0d0a 2020  ############..  
-00082b40: 2020 6461 7465 5f6f 725f 6964 203d 2076    date_or_id = v
-00082b50: 6172 5f64 662e 6170 706c 7928 6c61 6d62  ar_df.apply(lamb
-00082b60: 6461 2078 3a20 3120 6966 2078 5b27 7479  da x: 1 if x['ty
-00082b70: 7065 5f6f 665f 636f 6c75 6d6e 275d 2069  pe_of_column'] i
-00082b80: 6e20 5b6e 702e 7569 6e74 382c 0d0a 2020  n [np.uint8,..  
+000812a0: 2323 2323 2323 2323 2323 2323 230d 0a23  #############..#
+000812b0: 2323 2320 5468 6520 7761 726e 696e 6773  ### The warnings
+000812c0: 2066 726f 6d20 536b 6c65 6172 6e20 6172   from Sklearn ar
+000812d0: 6520 736f 2061 6e6e 6f79 696e 6720 7468  e so annoying th
+000812e0: 6174 2049 2068 6176 6520 746f 2073 6875  at I have to shu
+000812f0: 7420 6974 206f 6666 2023 2323 2323 2323  t it off #######
+00081300: 0d0a 696d 706f 7274 2077 6172 6e69 6e67  ..import warning
+00081310: 730d 0a77 6172 6e69 6e67 732e 6669 6c74  s..warnings.filt
+00081320: 6572 7761 726e 696e 6773 2822 6967 6e6f  erwarnings("igno
+00081330: 7265 2229 0d0a 6672 6f6d 2073 6b6c 6561  re")..from sklea
+00081340: 726e 2e65 7863 6570 7469 6f6e 7320 696d  rn.exceptions im
+00081350: 706f 7274 2044 6174 6143 6f6e 7665 7273  port DataConvers
+00081360: 696f 6e57 6172 6e69 6e67 0d0a 7761 726e  ionWarning..warn
+00081370: 696e 6773 2e66 696c 7465 7277 6172 6e69  ings.filterwarni
+00081380: 6e67 7328 6163 7469 6f6e 3d27 6967 6e6f  ngs(action='igno
+00081390: 7265 272c 2063 6174 6567 6f72 793d 4461  re', category=Da
+000813a0: 7461 436f 6e76 6572 7369 6f6e 5761 726e  taConversionWarn
+000813b0: 696e 6729 0d0a 6465 6620 7761 726e 282a  ing)..def warn(*
+000813c0: 6172 6773 2c20 2a2a 6b77 6172 6773 293a  args, **kwargs):
+000813d0: 0d0a 2020 2020 7061 7373 0d0a 7761 726e  ..    pass..warn
+000813e0: 696e 6773 2e77 6172 6e20 3d20 7761 726e  ings.warn = warn
+000813f0: 0d0a 696d 706f 7274 206c 6f67 6769 6e67  ..import logging
+00081400: 0d0a 2323 2323 2323 2323 2323 2323 2323  ..##############
+00081410: 2323 2323 2323 2323 2323 2323 2323 2323  ################
+00081420: 2323 2323 2323 2323 2323 2323 2323 2323  ################
+00081430: 2323 2323 2323 2323 2323 2323 2323 2323  ################
+00081440: 2323 2323 2323 2323 2323 2323 2323 2323  ################
+00081450: 2323 2323 2323 0d0a 696d 706f 7274 2070  ######..import p
+00081460: 6462 0d0a 6672 6f6d 2066 756e 6374 6f6f  db..from functoo
+00081470: 6c73 2069 6d70 6f72 7420 7265 6475 6365  ls import reduce
+00081480: 0d0a 696d 706f 7274 2063 6f70 790d 0a69  ..import copy..i
+00081490: 6d70 6f72 7420 7469 6d65 0d0a 6465 6620  mport time..def 
+000814a0: 6c65 6674 5f73 7562 7472 6163 7428 6c31  left_subtract(l1
+000814b0: 2c6c 3229 3a0d 0a20 2020 206c 7374 203d  ,l2):..    lst =
+000814c0: 205b 5d0d 0a20 2020 2066 6f72 2069 2069   []..    for i i
+000814d0: 6e20 6c31 3a0d 0a20 2020 2020 2020 2069  n l1:..        i
+000814e0: 6620 6920 6e6f 7420 696e 206c 323a 0d0a  f i not in l2:..
+000814f0: 2020 2020 2020 2020 2020 2020 6c73 742e              lst.
+00081500: 6170 7065 6e64 2869 290d 0a20 2020 2072  append(i)..    r
+00081510: 6574 7572 6e20 6c73 740d 0a23 2323 2323  eturn lst..#####
+00081520: 2323 2323 2323 2323 2323 2323 2323 2323  ################
+00081530: 2323 2323 2323 2323 2323 2323 2323 2323  ################
+00081540: 2323 2323 2323 2323 2323 2323 2323 2323  ################
+00081550: 2323 2323 2323 2323 2323 2323 2323 2323  ################
+00081560: 2323 2323 2323 2323 2323 2323 0d0a 696d  ############..im
+00081570: 706f 7274 2063 6f70 790d 0a64 6566 2045  port copy..def E
+00081580: 4441 5f66 696e 645f 7265 6d6f 7665 5f63  DA_find_remove_c
+00081590: 6f6c 756d 6e73 5f77 6974 685f 696e 6669  olumns_with_infi
+000815a0: 6e69 7479 2864 662c 2072 656d 6f76 653d  nity(df, remove=
+000815b0: 4661 6c73 6529 3a0d 0a20 2020 2022 2222  False):..    """
+000815c0: 0d0a 2020 2020 5468 6973 2066 756e 6374  ..    This funct
+000815d0: 696f 6e20 6669 6e64 7320 616c 6c20 636f  ion finds all co
+000815e0: 6c75 6d6e 7320 696e 2061 2064 6174 6166  lumns in a dataf
+000815f0: 7261 6d65 2074 6861 7420 6861 7665 2069  rame that have i
+00081600: 6e69 6669 6e69 7465 2076 616c 7565 7320  nifinite values 
+00081610: 286e 702e 696e 6620 6f72 202d 6e70 2e69  (np.inf or -np.i
+00081620: 6e66 290d 0a20 2020 2049 7420 7265 7475  nf)..    It retu
+00081630: 726e 7320 6120 6c69 7374 206f 6620 636f  rns a list of co
+00081640: 6c75 6d6e 206e 616d 6573 2e20 4966 2074  lumn names. If t
+00081650: 6865 206c 6973 7420 6973 2065 6d70 7479  he list is empty
+00081660: 2c20 6974 206d 6561 6e73 206e 6f20 636f  , it means no co
+00081670: 6c75 6d6e 7320 7765 7265 2066 6f75 6e64  lumns were found
+00081680: 2e0d 0a20 2020 2049 6620 7265 6d6f 7665  ...    If remove
+00081690: 2066 6c61 6720 6973 2073 6574 2c20 7468   flag is set, th
+000816a0: 656e 2069 7420 7265 7475 726e 7320 6120  en it returns a 
+000816b0: 736d 616c 6c65 7220 6461 7461 6672 616d  smaller datafram
+000816c0: 6520 7769 7468 2069 6e66 2063 6f6c 756d  e with inf colum
+000816d0: 6e73 2072 656d 6f76 6564 2e0d 0a20 2020  ns removed...   
+000816e0: 2022 2222 0d0a 2020 2020 6e75 6d73 203d   """..    nums =
+000816f0: 2064 662e 7365 6c65 6374 5f64 7479 7065   df.select_dtype
+00081700: 7328 696e 636c 7564 653d 276e 756d 6265  s(include='numbe
+00081710: 7227 292e 636f 6c75 6d6e 732e 746f 6c69  r').columns.toli
+00081720: 7374 2829 0d0a 2020 2020 6466 7820 3d20  st()..    dfx = 
+00081730: 6466 5b6e 756d 735d 0d0a 2020 2020 7375  df[nums]..    su
+00081740: 6d5f 726f 7773 203d 206e 702e 6973 696e  m_rows = np.isin
+00081750: 6628 6466 7829 2e76 616c 7565 732e 7375  f(dfx).values.su
+00081760: 6d28 290d 0a20 2020 2061 6464 5f63 6f6c  m()..    add_col
+00081770: 7320 3d20 206c 6973 7428 6466 782e 636f  s =  list(dfx.co
+00081780: 6c75 6d6e 732e 746f 5f73 6572 6965 7328  lumns.to_series(
+00081790: 295b 6e70 2e69 7369 6e66 2864 6678 292e  )[np.isinf(dfx).
+000817a0: 616e 7928 295d 290d 0a20 2020 2069 6620  any()])..    if 
+000817b0: 7375 6d5f 726f 7773 203e 2030 3a0d 0a20  sum_rows > 0:.. 
+000817c0: 2020 2020 2020 2070 7269 6e74 2827 2020         print('  
+000817d0: 2020 7468 6572 6520 6172 6520 2564 2072    there are %d r
+000817e0: 6f77 7320 616e 6420 2564 2063 6f6c 756d  ows and %d colum
+000817f0: 6e73 2077 6974 6820 696e 6669 6e69 7479  ns with infinity
+00081800: 2069 6e20 7468 656d 2e2e 2e27 2025 2873   in them...' %(s
+00081810: 756d 5f72 6f77 732c 6c65 6e28 6164 645f  um_rows,len(add_
+00081820: 636f 6c73 2929 290d 0a20 2020 2020 2020  cols)))..       
+00081830: 2069 6620 7265 6d6f 7665 3a0d 0a20 2020   if remove:..   
+00081840: 2020 2020 2020 2020 2023 2323 2068 6572           ### her
+00081850: 6520 796f 7520 6e65 6564 2074 6f20 7573  e you need to us
+00081860: 6520 6466 2073 696e 6365 2074 6865 2077  e df since the w
+00081870: 686f 6c65 2064 6174 6173 6574 2069 7320  hole dataset is 
+00081880: 696e 766f 6c76 6564 2023 2323 0d0a 2020  involved ###..  
+00081890: 2020 2020 2020 2020 2020 6e6f 636f 6c73            nocols
+000818a0: 203d 205b 7820 666f 7220 7820 696e 2064   = [x for x in d
+000818b0: 662e 636f 6c75 6d6e 7320 6966 2078 206e  f.columns if x n
+000818c0: 6f74 2069 6e20 6164 645f 636f 6c73 5d0d  ot in add_cols].
+000818d0: 0a20 2020 2020 2020 2020 2020 2070 7269  .            pri
+000818e0: 6e74 2822 2020 2020 5368 6170 6520 6f66  nt("    Shape of
+000818f0: 2064 6174 6173 6574 2062 6566 6f72 6520   dataset before 
+00081900: 2573 2061 6e64 2061 6674 6572 2025 7320  %s and after %s 
+00081910: 7265 6d6f 7669 6e67 2063 6f6c 756d 6e73  removing columns
+00081920: 2077 6974 6820 696e 6669 6e69 7479 2220   with infinity" 
+00081930: 2528 6466 2e73 6861 7065 2c28 6466 5b6e  %(df.shape,(df[n
+00081940: 6f63 6f6c 735d 2e73 6861 7065 2c29 2929  ocols].shape,)))
+00081950: 0d0a 2020 2020 2020 2020 2020 2020 7265  ..            re
+00081960: 7475 726e 2064 665b 6e6f 636f 6c73 5d0d  turn df[nocols].
+00081970: 0a20 2020 2020 2020 2065 6c73 653a 0d0a  .        else:..
+00081980: 2020 2020 2020 2020 2020 2020 2323 2074              ## t
+00081990: 6869 7320 7769 6c6c 2062 6520 6120 6c69  his will be a li
+000819a0: 7374 206f 6620 636f 6c75 6d6e 7320 7769  st of columns wi
+000819b0: 7468 2069 6e66 696e 6974 7920 2323 2323  th infinity ####
+000819c0: 0d0a 2020 2020 2020 2020 2020 2020 7265  ..            re
+000819d0: 7475 726e 2061 6464 5f63 6f6c 730d 0a20  turn add_cols.. 
+000819e0: 2020 2065 6c73 653a 0d0a 2020 2020 2020     else:..      
+000819f0: 2020 2323 2074 6869 7320 7769 6c6c 2062    ## this will b
+00081a00: 6520 616e 2065 6d70 7479 206c 6973 7420  e an empty list 
+00081a10: 6966 2074 6865 7265 2061 7265 206e 6f20  if there are no 
+00081a20: 636f 6c75 6d6e 7320 7769 7468 2069 6e66  columns with inf
+00081a30: 696e 6974 790d 0a20 2020 2020 2020 2072  inity..        r
+00081a40: 6574 7572 6e20 6164 645f 636f 6c73 0d0a  eturn add_cols..
+00081a50: 2323 2323 2323 2323 2323 2323 2323 2323  ################
+00081a60: 2323 2323 2323 2323 2323 2323 2323 2323  ################
+00081a70: 2323 2323 2323 2323 2323 2323 2323 2323  ################
+00081a80: 2323 2323 2323 2323 2323 2323 2323 2323  ################
+00081a90: 2323 2323 2323 2323 2323 2323 2323 2323  ################
+00081aa0: 2323 2323 0d0a 6465 6620 636c 6173 7369  ####..def classi
+00081ab0: 6679 5f63 6f6c 756d 6e73 2864 665f 7072  fy_columns(df_pr
+00081ac0: 6564 732c 2076 6572 626f 7365 3d30 293a  eds, verbose=0):
+00081ad0: 0d0a 2020 2020 2222 220d 0a20 2020 2054  ..    """..    T
+00081ae0: 6869 7320 6163 7475 616c 6c79 2064 6f65  his actually doe
+00081af0: 7320 4578 706c 6f72 6174 6f72 7920 6461  s Exploratory da
+00081b00: 7461 2061 6e61 6c79 7369 7320 2d20 6974  ta analysis - it
+00081b10: 206d 6561 6e73 2074 6869 7320 6675 6e63   means this func
+00081b20: 7469 6f6e 2070 6572 666f 726d 7320 4544  tion performs ED
+00081b30: 410d 0a20 2020 2023 2323 2323 2323 2323  A..    #########
+00081b40: 2323 2323 2323 2323 2323 2323 2323 2323  ################
+00081b50: 2323 2323 2323 2323 2323 2323 2323 2323  ################
+00081b60: 2323 2323 2323 2323 2323 2323 2323 2323  ################
+00081b70: 2323 2323 2323 2323 2323 2323 2323 2323  ################
+00081b80: 2323 2323 2323 2323 2323 2323 230d 0a20  #############.. 
+00081b90: 2020 2054 616b 6573 2061 2064 6174 6166     Takes a dataf
+00081ba0: 7261 6d65 2063 6f6e 7461 696e 696e 6720  rame containing 
+00081bb0: 6f6e 6c79 2070 7265 6469 6374 6f72 7320  only predictors 
+00081bc0: 746f 2062 6520 636c 6173 7369 6669 6564  to be classified
+00081bd0: 2069 6e74 6f20 7661 7269 6f75 7320 7479   into various ty
+00081be0: 7065 732e 0d0a 2020 2020 444f 204e 4f54  pes...    DO NOT
+00081bf0: 2053 454e 4420 494e 2041 2054 4152 4745   SEND IN A TARGE
+00081c00: 5420 434f 4c55 4d4e 2073 696e 6365 2069  T COLUMN since i
+00081c10: 7420 7769 6c6c 2074 7279 2074 6f20 696e  t will try to in
+00081c20: 636c 7564 6520 7468 6174 2069 6e74 6f20  clude that into 
+00081c30: 7661 7269 6f75 7320 636f 6c75 6d6e 732e  various columns.
+00081c40: 0d0a 2020 2020 5265 7475 726e 7320 6120  ..    Returns a 
+00081c50: 6461 7461 2066 7261 6d65 2063 6f6e 7461  data frame conta
+00081c60: 696e 696e 6720 636f 6c75 6d6e 7320 616e  ining columns an
+00081c70: 6420 7468 6520 636c 6173 7320 6974 2062  d the class it b
+00081c80: 656c 6f6e 6773 2074 6f20 7375 6368 2061  elongs to such a
+00081c90: 7320 6e75 6d65 7269 632c 0d0a 2020 2020  s numeric,..    
+00081ca0: 6361 7465 676f 7269 6361 6c2c 2064 6174  categorical, dat
+00081cb0: 6520 6f72 2069 6420 636f 6c75 6d6e 2c20  e or id column, 
+00081cc0: 626f 6f6c 6561 6e2c 206e 6c70 2c20 6469  boolean, nlp, di
+00081cd0: 7363 7265 7465 5f73 7472 696e 6720 616e  screte_string an
+00081ce0: 6420 636f 6c73 2074 6f20 6465 6c65 7465  d cols to delete
+00081cf0: 2e2e 2e0d 0a20 2020 2023 2323 2323 2323  .....    #######
+00081d00: 2052 6574 7572 6e73 2061 2064 6963 7469   Returns a dicti
+00081d10: 6f6e 6172 7920 7769 7468 2031 3020 6b69  onary with 10 ki
+00081d20: 6e64 7320 6f66 2076 6172 7320 6c69 6b65  nds of vars like
+00081d30: 2074 6865 2066 6f6c 6c6f 7769 6e67 3a20   the following: 
+00081d40: 2320 636f 6e74 696e 756f 7573 5f76 6172  # continuous_var
+00081d50: 732c 696e 745f 7661 7273 0d0a 2020 2020  s,int_vars..    
+00081d60: 2320 6361 745f 7661 7273 2c66 6163 746f  # cat_vars,facto
+00081d70: 725f 7661 7273 2c20 626f 6f6c 5f76 6172  r_vars, bool_var
+00081d80: 732c 6469 7363 7265 7465 5f73 7472 696e  s,discrete_strin
+00081d90: 675f 7661 7273 2c6e 6c70 5f76 6172 732c  g_vars,nlp_vars,
+00081da0: 6461 7465 5f76 6172 732c 6964 5f76 6172  date_vars,id_var
+00081db0: 732c 636f 6c73 5f64 656c 6574 650d 0a20  s,cols_delete.. 
+00081dc0: 2020 2022 2222 0d0a 2020 2020 7472 6169     """..    trai
+00081dd0: 6e20 3d20 636f 7079 2e64 6565 7063 6f70  n = copy.deepcop
+00081de0: 7928 6466 5f70 7265 6473 290d 0a20 2020  y(df_preds)..   
+00081df0: 2023 2323 2320 4966 2074 6865 7265 2061   #### If there a
+00081e00: 7265 2033 3020 6368 6172 7320 6172 6520  re 30 chars are 
+00081e10: 6d6f 7265 2069 6e20 6120 6469 7363 7265  more in a discre
+00081e20: 7465 5f73 7472 696e 675f 7661 722c 2069  te_string_var, i
+00081e30: 7420 6973 2074 6865 6e20 636f 6e73 6964  t is then consid
+00081e40: 6572 6564 2061 6e20 4e4c 5020 7661 7269  ered an NLP vari
+00081e50: 6162 6c65 0d0a 2020 2020 6d61 785f 6e6c  able..    max_nl
+00081e60: 705f 6368 6172 5f73 697a 6520 3d20 3330  p_char_size = 30
+00081e70: 0d0a 2020 2020 6d61 785f 636f 6c73 5f74  ..    max_cols_t
+00081e80: 6f5f 7072 696e 7420 3d20 3330 0d0a 2020  o_print = 30..  
+00081e90: 2020 7072 696e 7428 2723 2323 2323 2323    print('#######
+00081ea0: 2323 2323 2323 2323 2323 2323 2323 2323  ################
+00081eb0: 2323 2323 2323 2323 2323 2323 2323 2323  ################
+00081ec0: 2323 2323 2323 2323 2323 2323 2323 2323  ################
+00081ed0: 2323 2323 2323 2323 2323 2323 2323 2323  ################
+00081ee0: 2323 2323 2323 2323 2323 2323 2323 2323  ################
+00081ef0: 2729 0d0a 2020 2020 7072 696e 7428 2723  ')..    print('#
+00081f00: 2323 2323 2323 2323 2323 2323 2323 2323  ################
+00081f10: 2323 2323 2323 2320 4320 4c20 4120 5320  ####### C L A S 
+00081f20: 5320 4920 4620 5920 4920 4e20 4720 2056  S I F Y I N G  V
+00081f30: 2041 2052 2049 2041 2042 204c 2045 2053   A R I A B L E S
+00081f40: 2020 2323 2323 2323 2323 2323 2323 2323    ##############
+00081f50: 2323 2323 2323 2729 0d0a 2020 2020 7072  ######')..    pr
+00081f60: 696e 7428 2723 2323 2323 2323 2323 2323  int('###########
+00081f70: 2323 2323 2323 2323 2323 2323 2323 2323  ################
+00081f80: 2323 2323 2323 2323 2323 2323 2323 2323  ################
+00081f90: 2323 2323 2323 2323 2323 2323 2323 2323  ################
+00081fa0: 2323 2323 2323 2323 2323 2323 2323 2323  ################
+00081fb0: 2323 2323 2323 2323 2323 2323 2729 0d0a  ############')..
+00081fc0: 2020 2020 7072 696e 7428 2743 6c61 7373      print('Class
+00081fd0: 6966 7969 6e67 2076 6172 6961 626c 6573  ifying variables
+00081fe0: 2069 6e20 6461 7461 2073 6574 2e2e 2e27   in data set...'
+00081ff0: 290d 0a20 2020 2023 2323 2320 4361 745f  )..    #### Cat_
+00082000: 4c69 6d69 7420 6465 6669 6e65 7320 7468  Limit defines th
+00082010: 6520 6d61 7820 6e75 6d62 6572 206f 6620  e max number of 
+00082020: 6361 7465 676f 7269 6573 2061 2063 6f6c  categories a col
+00082030: 756d 6e20 6361 6e20 6861 7665 2074 6f20  umn can have to 
+00082040: 6265 2063 616c 6c65 6420 6120 6361 7465  be called a cate
+00082050: 676f 7269 6361 6c20 636f 6c75 6d0d 0a20  gorical colum.. 
+00082060: 2020 2063 6174 5f6c 696d 6974 203d 2033     cat_limit = 3
+00082070: 350d 0a20 2020 2066 6c6f 6174 5f6c 696d  5..    float_lim
+00082080: 6974 203d 2031 3520 2323 2323 204d 616b  it = 15 #### Mak
+00082090: 6520 7468 6973 206c 696d 6974 206c 6f77  e this limit low
+000820a0: 2073 6f20 7468 6174 2066 6c6f 6174 2076   so that float v
+000820b0: 6172 6961 626c 6573 2062 656c 6f77 2074  ariables below t
+000820c0: 6869 7320 6c69 6d69 7420 6265 636f 6d65  his limit become
+000820d0: 2063 6174 2076 6172 7320 2323 230d 0a20   cat vars ###.. 
+000820e0: 2020 2064 6566 2061 6464 2861 2c62 293a     def add(a,b):
+000820f0: 0d0a 2020 2020 2020 2020 7265 7475 726e  ..        return
+00082100: 2061 2b62 0d0a 2020 2020 7375 6d5f 616c   a+b..    sum_al
+00082110: 6c5f 636f 6c73 203d 2064 6963 7428 290d  l_cols = dict().
+00082120: 0a20 2020 206f 7269 675f 636f 6c73 5f74  .    orig_cols_t
+00082130: 6f74 616c 203d 2074 7261 696e 2e73 6861  otal = train.sha
+00082140: 7065 5b31 5d0d 0a20 2020 2023 5479 7065  pe[1]..    #Type
+00082150: 7320 6f66 2063 6f6c 756d 6e73 0d0a 2020  s of columns..  
+00082160: 2020 636f 6c73 5f64 656c 6574 6520 3d20    cols_delete = 
+00082170: 5b5d 0d0a 2020 2020 636f 6c73 5f64 656c  []..    cols_del
+00082180: 6574 6520 3d20 5b63 6f6c 2066 6f72 2063  ete = [col for c
+00082190: 6f6c 2069 6e20 6c69 7374 2874 7261 696e  ol in list(train
+000821a0: 2920 6966 2028 6c65 6e28 7472 6169 6e5b  ) if (len(train[
+000821b0: 636f 6c5d 2e76 616c 7565 5f63 6f75 6e74  col].value_count
+000821c0: 7328 2929 203d 3d20 310d 0a20 2020 2020  s()) == 1..     
+000821d0: 2020 2020 2020 2020 2020 2020 2020 2020                  
+000821e0: 2020 2020 2020 2020 2020 2020 2020 2020                  
+000821f0: 2020 2920 7c20 2874 7261 696e 5b63 6f6c    ) | (train[col
+00082200: 5d2e 6973 6e75 6c6c 2829 2e73 756d 2829  ].isnull().sum()
+00082210: 2f6c 656e 2874 7261 696e 2920 3e3d 2030  /len(train) >= 0
+00082220: 2e39 3029 5d0d 0a20 2020 2069 6e66 5f63  .90)]..    inf_c
+00082230: 6f6c 7320 3d20 4544 415f 6669 6e64 5f72  ols = EDA_find_r
+00082240: 656d 6f76 655f 636f 6c75 6d6e 735f 7769  emove_columns_wi
+00082250: 7468 5f69 6e66 696e 6974 7928 7472 6169  th_infinity(trai
+00082260: 6e29 0d0a 2020 2020 6d69 7865 645f 636f  n)..    mixed_co
+00082270: 6c73 203d 205b 7820 666f 7220 7820 696e  ls = [x for x in
+00082280: 206c 6973 7428 7472 6169 6e29 2069 6620   list(train) if 
+00082290: 6c65 6e28 7472 6169 6e5b 785d 2e64 726f  len(train[x].dro
+000822a0: 706e 6128 292e 6170 706c 7928 7479 7065  pna().apply(type
+000822b0: 292e 7661 6c75 655f 636f 756e 7473 2829  ).value_counts()
+000822c0: 2920 3e20 315d 0d0a 2020 2020 6966 206c  ) > 1]..    if l
+000822d0: 656e 286d 6978 6564 5f63 6f6c 7329 203e  en(mixed_cols) >
+000822e0: 2030 3a0d 0a20 2020 2020 2020 2070 7269   0:..        pri
+000822f0: 6e74 2827 2020 2020 5265 6d6f 7669 6e67  nt('    Removing
+00082300: 2025 7320 636f 6c75 6d6e 2873 2920 6475   %s column(s) du
+00082310: 6520 746f 206d 6978 6564 2064 6174 6120  e to mixed data 
+00082320: 7479 7065 2064 6574 6563 7465 642e 2e2e  type detected...
+00082330: 2720 256d 6978 6564 5f63 6f6c 7329 0d0a  ' %mixed_cols)..
+00082340: 2020 2020 636f 6c73 5f64 656c 6574 6520      cols_delete 
+00082350: 2b3d 206d 6978 6564 5f63 6f6c 730d 0a20  += mixed_cols.. 
+00082360: 2020 2063 6f6c 735f 6465 6c65 7465 202b     cols_delete +
+00082370: 3d20 696e 665f 636f 6c73 0d0a 2020 2020  = inf_cols..    
+00082380: 7472 6169 6e20 3d20 7472 6169 6e5b 6c65  train = train[le
+00082390: 6674 5f73 7562 7472 6163 7428 6c69 7374  ft_subtract(list
+000823a0: 2874 7261 696e 292c 636f 6c73 5f64 656c  (train),cols_del
+000823b0: 6574 6529 5d0d 0a20 2020 2076 6172 5f64  ete)]..    var_d
+000823c0: 6620 3d20 7064 2e53 6572 6965 7328 6469  f = pd.Series(di
+000823d0: 6374 2874 7261 696e 2e64 7479 7065 7329  ct(train.dtypes)
+000823e0: 292e 7265 7365 745f 696e 6465 7828 6472  ).reset_index(dr
+000823f0: 6f70 3d46 616c 7365 292e 7265 6e61 6d65  op=False).rename
+00082400: 280d 0a20 2020 2020 2020 2020 2020 2020  (..             
+00082410: 2020 2020 2020 2020 2020 2063 6f6c 756d             colum
+00082420: 6e73 3d7b 303a 2774 7970 655f 6f66 5f63  ns={0:'type_of_c
+00082430: 6f6c 756d 6e27 7d29 0d0a 2020 2020 7375  olumn'})..    su
+00082440: 6d5f 616c 6c5f 636f 6c73 5b27 636f 6c73  m_all_cols['cols
+00082450: 5f64 656c 6574 6527 5d20 3d20 636f 6c73  _delete'] = cols
+00082460: 5f64 656c 6574 650d 0a0d 0a20 2020 2076  _delete....    v
+00082470: 6172 5f64 665b 2762 6f6f 6c27 5d20 3d20  ar_df['bool'] = 
+00082480: 7661 725f 6466 2e61 7070 6c79 286c 616d  var_df.apply(lam
+00082490: 6264 6120 783a 2031 2069 6620 785b 2774  bda x: 1 if x['t
+000824a0: 7970 655f 6f66 5f63 6f6c 756d 6e27 5d20  ype_of_column'] 
+000824b0: 696e 205b 2762 6f6f 6c27 2c27 6f62 6a65  in ['bool','obje
+000824c0: 6374 275d 0d0a 2020 2020 2020 2020 2020  ct']..          
+000824d0: 2020 2020 2020 2020 2020 2020 2020 616e                an
+000824e0: 6420 6c65 6e28 7472 6169 6e5b 785b 2769  d len(train[x['i
+000824f0: 6e64 6578 275d 5d2e 7661 6c75 655f 636f  ndex']].value_co
+00082500: 756e 7473 2829 2920 3d3d 2032 2065 6c73  unts()) == 2 els
+00082510: 6520 302c 2061 7869 733d 3129 0d0a 2020  e 0, axis=1)..  
+00082520: 2020 7374 7269 6e67 5f62 6f6f 6c5f 7661    string_bool_va
+00082530: 7273 203d 206c 6973 7428 7661 725f 6466  rs = list(var_df
+00082540: 5b28 7661 725f 6466 5b27 626f 6f6c 275d  [(var_df['bool']
+00082550: 203d 3d31 295d 5b27 696e 6465 7827 5d29   ==1)]['index'])
+00082560: 0d0a 2020 2020 7375 6d5f 616c 6c5f 636f  ..    sum_all_co
+00082570: 6c73 5b27 7374 7269 6e67 5f62 6f6f 6c5f  ls['string_bool_
+00082580: 7661 7273 275d 203d 2073 7472 696e 675f  vars'] = string_
+00082590: 626f 6f6c 5f76 6172 730d 0a20 2020 2076  bool_vars..    v
+000825a0: 6172 5f64 665b 276e 756d 5f62 6f6f 6c27  ar_df['num_bool'
+000825b0: 5d20 3d20 7661 725f 6466 2e61 7070 6c79  ] = var_df.apply
+000825c0: 286c 616d 6264 6120 783a 2031 2069 6620  (lambda x: 1 if 
+000825d0: 785b 2774 7970 655f 6f66 5f63 6f6c 756d  x['type_of_colum
+000825e0: 6e27 5d20 696e 205b 6e70 2e75 696e 7438  n'] in [np.uint8
+000825f0: 2c0d 0a20 2020 2020 2020 2020 2020 2020  ,..             
+00082600: 2020 2020 2020 2020 2020 2020 2020 206e                 n
+00082610: 702e 7569 6e74 3136 2c20 6e70 2e75 696e  p.uint16, np.uin
+00082620: 7433 322c 206e 702e 7569 6e74 3634 2c0d  t32, np.uint64,.
+00082630: 0a20 2020 2020 2020 2020 2020 2020 2020  .               
+00082640: 2020 2020 2020 2020 2020 2020 2027 696e               'in
+00082650: 7438 272c 2769 6e74 3136 272c 2769 6e74  t8','int16','int
+00082660: 3332 272c 2769 6e74 3634 272c 0d0a 2020  32','int64',..  
+00082670: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00082680: 2020 2020 2020 2020 2020 2766 6c6f 6174            'float
+00082690: 3136 272c 2766 6c6f 6174 3332 272c 2766  16','float32','f
+000826a0: 6c6f 6174 3634 275d 2061 6e64 206c 656e  loat64'] and len
+000826b0: 280d 0a20 2020 2020 2020 2020 2020 2020  (..             
+000826c0: 2020 2020 2020 2020 2020 2074 7261 696e             train
+000826d0: 5b78 5b27 696e 6465 7827 5d5d 2e76 616c  [x['index']].val
+000826e0: 7565 5f63 6f75 6e74 7328 2929 203d 3d20  ue_counts()) == 
+000826f0: 3220 656c 7365 2030 2c20 6178 6973 3d31  2 else 0, axis=1
+00082700: 290d 0a20 2020 206e 756d 5f62 6f6f 6c5f  )..    num_bool_
+00082710: 7661 7273 203d 206c 6973 7428 7661 725f  vars = list(var_
+00082720: 6466 5b28 7661 725f 6466 5b27 6e75 6d5f  df[(var_df['num_
+00082730: 626f 6f6c 275d 203d 3d31 295d 5b27 696e  bool'] ==1)]['in
+00082740: 6465 7827 5d29 0d0a 2020 2020 7375 6d5f  dex'])..    sum_
+00082750: 616c 6c5f 636f 6c73 5b27 6e75 6d5f 626f  all_cols['num_bo
+00082760: 6f6c 5f76 6172 7327 5d20 3d20 6e75 6d5f  ol_vars'] = num_
+00082770: 626f 6f6c 5f76 6172 730d 0a20 2020 2023  bool_vars..    #
+00082780: 2323 2323 2320 2020 5468 6973 2069 7320  #####   This is 
+00082790: 7768 6572 6520 7765 2074 616b 6520 616c  where we take al
+000827a0: 6c20 4f62 6a65 6374 2076 6172 7320 616e  l Object vars an
+000827b0: 6420 7370 6c69 7420 7468 656d 2069 6e74  d split them int
+000827c0: 6f20 6469 6666 206b 696e 6473 2023 2323  o diff kinds ###
+000827d0: 0d0a 2020 2020 6469 7363 7265 7465 5f6f  ..    discrete_o
+000827e0: 725f 6e6c 7020 3d20 7661 725f 6466 2e61  r_nlp = var_df.a
+000827f0: 7070 6c79 286c 616d 6264 6120 783a 2031  pply(lambda x: 1
+00082800: 2069 6620 785b 2774 7970 655f 6f66 5f63   if x['type_of_c
+00082810: 6f6c 756d 6e27 5d20 696e 205b 276f 626a  olumn'] in ['obj
+00082820: 6563 7427 5d20 2061 6e64 2078 5b0d 0a20  ect']  and x[.. 
+00082830: 2020 2020 2020 2027 696e 6465 7827 5d20         'index'] 
+00082840: 6e6f 7420 696e 2073 7472 696e 675f 626f  not in string_bo
+00082850: 6f6c 5f76 6172 732b 636f 6c73 5f64 656c  ol_vars+cols_del
+00082860: 6574 6520 656c 7365 2030 2c61 7869 733d  ete else 0,axis=
+00082870: 3129 0d0a 2020 2020 2323 2323 2323 2323  1)..    ########
+00082880: 2320 5468 6973 2069 7320 7768 6572 6520  # This is where 
+00082890: 7765 2066 6967 7572 6520 6f75 7420 7768  we figure out wh
+000828a0: 6574 6865 7220 6120 7374 7269 6e67 2076  ether a string v
+000828b0: 6172 2069 7320 6e6c 7020 6f72 2064 6973  ar is nlp or dis
+000828c0: 6372 6574 655f 7374 7269 6e67 2076 6172  crete_string var
+000828d0: 2023 2323 0d0a 2020 2020 7661 725f 6466   ###..    var_df
+000828e0: 5b27 6e6c 705f 7374 7269 6e67 7327 5d20  ['nlp_strings'] 
+000828f0: 3d20 300d 0a20 2020 2076 6172 5f64 665b  = 0..    var_df[
+00082900: 2764 6973 6372 6574 655f 7374 7269 6e67  'discrete_string
+00082910: 7327 5d20 3d20 300d 0a20 2020 2076 6172  s'] = 0..    var
+00082920: 5f64 665b 2763 6174 275d 203d 2030 0d0a  _df['cat'] = 0..
+00082930: 2020 2020 7661 725f 6466 5b27 6964 5f63      var_df['id_c
+00082940: 6f6c 275d 203d 2030 0d0a 2020 2020 6469  ol'] = 0..    di
+00082950: 7363 7265 7465 5f6f 725f 6e6c 705f 7661  screte_or_nlp_va
+00082960: 7273 203d 2076 6172 5f64 662e 6c6f 635b  rs = var_df.loc[
+00082970: 6469 7363 7265 7465 5f6f 725f 6e6c 703d  discrete_or_nlp=
+00082980: 3d31 5d5b 2769 6e64 6578 275d 2e76 616c  =1]['index'].val
+00082990: 7565 732e 746f 6c69 7374 2829 0d0a 2020  ues.tolist()..  
+000829a0: 2020 636f 7079 5f64 6973 6372 6574 655f    copy_discrete_
+000829b0: 6f72 5f6e 6c70 5f76 6172 7320 3d20 636f  or_nlp_vars = co
+000829c0: 7079 2e64 6565 7063 6f70 7928 6469 7363  py.deepcopy(disc
+000829d0: 7265 7465 5f6f 725f 6e6c 705f 7661 7273  rete_or_nlp_vars
+000829e0: 290d 0a20 2020 2069 6620 6c65 6e28 6469  )..    if len(di
+000829f0: 7363 7265 7465 5f6f 725f 6e6c 705f 7661  screte_or_nlp_va
+00082a00: 7273 2920 3e20 303a 0d0a 2020 2020 2020  rs) > 0:..      
+00082a10: 2020 666f 7220 636f 6c20 696e 2063 6f70    for col in cop
+00082a20: 795f 6469 7363 7265 7465 5f6f 725f 6e6c  y_discrete_or_nl
+00082a30: 705f 7661 7273 3a0d 0a20 2020 2020 2020  p_vars:..       
+00082a40: 2020 2020 2023 2323 2320 6669 7273 7420       #### first 
+00082a50: 6669 6c6c 2065 6d70 7479 206f 7220 6d69  fill empty or mi
+00082a60: 7373 696e 6720 7661 6c73 2073 696e 6365  ssing vals since
+00082a70: 2069 7420 7769 6c6c 2062 6c6f 7775 7020   it will blowup 
+00082a80: 2323 230d 0a20 2020 2020 2020 2020 2020  ###..           
+00082a90: 2023 2323 2052 656d 656d 6265 7220 7468   ### Remember th
+00082aa0: 6174 2066 696c 6c6e 6120 6f6e 6c79 2077  at fillna only w
+00082ab0: 6f72 6b73 2061 7420 7468 6520 6461 7461  orks at the data
+00082ac0: 6672 616d 6520 6c65 7665 6c21 0d0a 2020  frame level!..  
+00082ad0: 2020 2020 2020 2020 2020 7472 6169 6e5b            train[
+00082ae0: 5b63 6f6c 5d5d 203d 2074 7261 696e 5b5b  [col]] = train[[
+00082af0: 636f 6c5d 5d2e 6669 6c6c 6e61 2827 2020  col]].fillna('  
+00082b00: 2729 0d0a 2020 2020 2020 2020 2020 2020  ')..            
+00082b10: 6966 2074 7261 696e 5b63 6f6c 5d2e 6d61  if train[col].ma
+00082b20: 7028 6c61 6d62 6461 2078 3a20 6c65 6e28  p(lambda x: len(
+00082b30: 7829 2069 6620 7479 7065 2878 293d 3d73  x) if type(x)==s
+00082b40: 7472 2065 6c73 6520 3029 2e6d 6178 280d  tr else 0).max(.
+00082b50: 0a20 2020 2020 2020 2020 2020 2020 2020  .               
+00082b60: 2029 203e 3d20 3530 2061 6e64 206c 656e   ) >= 50 and len
+00082b70: 2874 7261 696e 5b63 6f6c 5d2e 7661 6c75  (train[col].valu
+00082b80: 655f 636f 756e 7473 2829 0d0a 2020 2020  e_counts()..    
 00082b90: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00082ba0: 2020 2020 2020 206e 702e 7569 6e74 3136         np.uint16
-00082bb0: 2c20 6e70 2e75 696e 7433 322c 206e 702e  , np.uint32, np.
-00082bc0: 7569 6e74 3634 2c0d 0a20 2020 2020 2020  uint64,..       
-00082bd0: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00082be0: 2020 2769 6e74 3827 2c27 696e 7431 3627    'int8','int16'
-00082bf0: 2c0d 0a20 2020 2020 2020 2020 2020 2020  ,..             
-00082c00: 2020 2020 2020 2020 2020 2027 696e 7433             'int3
-00082c10: 3227 2c27 696e 7436 3427 5d20 2061 6e64  2','int64']  and
-00082c20: 2078 5b0d 0a20 2020 2020 2020 2027 696e   x[..        'in
-00082c30: 6465 7827 5d20 6e6f 7420 696e 2073 7472  dex'] not in str
-00082c40: 696e 675f 626f 6f6c 5f76 6172 732b 6e75  ing_bool_vars+nu
-00082c50: 6d5f 626f 6f6c 5f76 6172 732b 6469 7363  m_bool_vars+disc
-00082c60: 7265 7465 5f73 7472 696e 675f 7661 7273  rete_string_vars
-00082c70: 2b6e 6c70 5f76 6172 7320 656c 7365 2030  +nlp_vars else 0
-00082c80: 2c0d 0a20 2020 2020 2020 2020 2020 2020  ,..             
-00082c90: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00082ca0: 2020 2020 2020 2020 2020 2061 7869 733d             axis=
-00082cb0: 3129 0d0a 2020 2020 2323 2323 2323 2323  1)..    ########
-00082cc0: 2320 5468 6973 2069 7320 7768 6572 6520  # This is where 
-00082cd0: 7765 2066 6967 7572 6520 6f75 7420 7768  we figure out wh
-00082ce0: 6574 6865 7220 6120 6e75 6d65 7269 6320  ether a numeric 
-00082cf0: 636f 6c20 6973 2064 6174 6520 6f72 2069  col is date or i
-00082d00: 6420 7661 7269 6162 6c65 2023 2323 0d0a  d variable ###..
-00082d10: 2020 2020 7661 725f 6466 5b27 696e 7427      var_df['int'
-00082d20: 5d20 3d20 300d 0a20 2020 2076 6172 5f64  ] = 0..    var_d
-00082d30: 665b 2764 6174 655f 7469 6d65 275d 203d  f['date_time'] =
-00082d40: 2030 0d0a 2020 2020 2323 2320 6966 2061   0..    ### if a
-00082d50: 2070 6172 7469 6375 6c61 7220 636f 6c75   particular colu
-00082d60: 6d6e 2069 7320 6461 7465 2d74 696d 6520  mn is date-time 
-00082d70: 7479 7065 2c20 6e6f 7720 7365 7420 6974  type, now set it
-00082d80: 2061 7320 6120 6461 7465 2074 696d 6520   as a date time 
-00082d90: 7661 7269 6162 6c65 2023 230d 0a20 2020  variable ##..   
-00082da0: 2076 6172 5f64 665b 2764 6174 655f 7469   var_df['date_ti
-00082db0: 6d65 275d 203d 2076 6172 5f64 662e 6170  me'] = var_df.ap
-00082dc0: 706c 7928 6c61 6d62 6461 2078 3a20 3120  ply(lambda x: 1 
-00082dd0: 6966 2078 5b27 7479 7065 5f6f 665f 636f  if x['type_of_co
-00082de0: 6c75 6d6e 275d 2069 6e20 5b27 3c4d 385b  lumn'] in ['<M8[
-00082df0: 6e73 5d27 2c27 6461 7465 7469 6d65 3634  ns]','datetime64
-00082e00: 5b6e 735d 275d 2020 616e 6420 785b 0d0a  [ns]']  and x[..
-00082e10: 2020 2020 2020 2020 2769 6e64 6578 275d          'index']
-00082e20: 206e 6f74 2069 6e20 7374 7269 6e67 5f62   not in string_b
-00082e30: 6f6f 6c5f 7661 7273 2b6e 756d 5f62 6f6f  ool_vars+num_boo
-00082e40: 6c5f 7661 7273 2b64 6973 6372 6574 655f  l_vars+discrete_
-00082e50: 7374 7269 6e67 5f76 6172 732b 6e6c 705f  string_vars+nlp_
-00082e60: 7661 7273 2065 6c73 6520 302c 0d0a 2020  vars else 0,..  
-00082e70: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00082e80: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00082e90: 2020 2020 2020 6178 6973 3d31 290d 0a20        axis=1).. 
-00082ea0: 2020 2023 2323 2074 6869 7320 6973 2077     ### this is w
-00082eb0: 6865 7265 2077 6520 7361 7665 2074 6865  here we save the
-00082ec0: 6d20 6173 2064 6174 6520 7469 6d65 2076  m as date time v
-00082ed0: 6172 6961 626c 6573 2023 2323 0d0a 2020  ariables ###..  
-00082ee0: 2020 6966 206c 656e 2876 6172 5f64 662e    if len(var_df.
-00082ef0: 6c6f 635b 6461 7465 5f6f 725f 6964 3d3d  loc[date_or_id==
-00082f00: 315d 2920 213d 2030 3a0d 0a20 2020 2020  1]) != 0:..     
-00082f10: 2020 2066 6f72 2063 6f6c 2069 6e20 7661     for col in va
-00082f20: 725f 6466 2e6c 6f63 5b64 6174 655f 6f72  r_df.loc[date_or
-00082f30: 5f69 643d 3d31 5d5b 2769 6e64 6578 275d  _id==1]['index']
-00082f40: 2e76 616c 7565 732e 746f 6c69 7374 2829  .values.tolist()
-00082f50: 3a0d 0a20 2020 2020 2020 2020 2020 2069  :..            i
-00082f60: 6620 6c65 6e28 7472 6169 6e5b 636f 6c5d  f len(train[col]
-00082f70: 2e76 616c 7565 5f63 6f75 6e74 7328 2929  .value_counts())
-00082f80: 203d 3d20 6c65 6e28 7472 6169 6e29 3a0d   == len(train):.
-00082f90: 0a20 2020 2020 2020 2020 2020 2020 2020  .               
-00082fa0: 2069 6620 7472 6169 6e5b 636f 6c5d 2e6d   if train[col].m
-00082fb0: 696e 2829 203c 2031 3930 3020 6f72 2074  in() < 1900 or t
-00082fc0: 7261 696e 5b63 6f6c 5d2e 6d61 7828 2920  rain[col].max() 
-00082fd0: 3e20 3230 3530 3a0d 0a20 2020 2020 2020  > 2050:..       
-00082fe0: 2020 2020 2020 2020 2020 2020 2076 6172               var
-00082ff0: 5f64 662e 6c6f 635b 7661 725f 6466 5b27  _df.loc[var_df['
-00083000: 696e 6465 7827 5d3d 3d63 6f6c 2c27 6964  index']==col,'id
-00083010: 5f63 6f6c 275d 203d 2031 0d0a 2020 2020  _col'] = 1..    
-00083020: 2020 2020 2020 2020 2020 2020 656c 7365              else
-00083030: 3a0d 0a20 2020 2020 2020 2020 2020 2020  :..             
-00083040: 2020 2020 2020 2074 7279 3a0d 0a20 2020         try:..   
-00083050: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00083060: 2020 2020 2070 642e 746f 5f64 6174 6574       pd.to_datet
-00083070: 696d 6528 7472 6169 6e5b 636f 6c5d 2c69  ime(train[col],i
-00083080: 6e66 6572 5f64 6174 6574 696d 655f 666f  nfer_datetime_fo
-00083090: 726d 6174 3d54 7275 6529 0d0a 2020 2020  rmat=True)..    
-000830a0: 2020 2020 2020 2020 2020 2020 2020 2020                  
-000830b0: 2020 2020 7661 725f 6466 2e6c 6f63 5b76      var_df.loc[v
-000830c0: 6172 5f64 665b 2769 6e64 6578 275d 3d3d  ar_df['index']==
-000830d0: 636f 6c2c 2764 6174 655f 7469 6d65 275d  col,'date_time']
-000830e0: 203d 2031 0d0a 2020 2020 2020 2020 2020   = 1..          
-000830f0: 2020 2020 2020 2020 2020 6578 6365 7074            except
-00083100: 3a0d 0a20 2020 2020 2020 2020 2020 2020  :..             
-00083110: 2020 2020 2020 2020 2020 2076 6172 5f64             var_d
-00083120: 662e 6c6f 635b 7661 725f 6466 5b27 696e  f.loc[var_df['in
-00083130: 6465 7827 5d3d 3d63 6f6c 2c27 6964 5f63  dex']==col,'id_c
-00083140: 6f6c 275d 203d 2031 0d0a 2020 2020 2020  ol'] = 1..      
-00083150: 2020 2020 2020 656c 7365 3a0d 0a20 2020        else:..   
-00083160: 2020 2020 2020 2020 2020 2020 2069 6620               if 
-00083170: 7472 6169 6e5b 636f 6c5d 2e6d 696e 2829  train[col].min()
-00083180: 203c 2031 3930 3020 6f72 2074 7261 696e   < 1900 or train
-00083190: 5b63 6f6c 5d2e 6d61 7828 2920 3e20 3230  [col].max() > 20
-000831a0: 3530 3a0d 0a20 2020 2020 2020 2020 2020  50:..           
-000831b0: 2020 2020 2020 2020 2069 6620 636f 6c20           if col 
-000831c0: 6e6f 7420 696e 206e 756d 5f62 6f6f 6c5f  not in num_bool_
-000831d0: 7661 7273 3a0d 0a20 2020 2020 2020 2020  vars:..         
-000831e0: 2020 2020 2020 2020 2020 2020 2020 2076                 v
-000831f0: 6172 5f64 662e 6c6f 635b 7661 725f 6466  ar_df.loc[var_df
-00083200: 5b27 696e 6465 7827 5d3d 3d63 6f6c 2c27  ['index']==col,'
-00083210: 696e 7427 5d20 3d20 310d 0a20 2020 2020  int'] = 1..     
-00083220: 2020 2020 2020 2020 2020 2065 6c73 653a             else:
-00083230: 0d0a 2020 2020 2020 2020 2020 2020 2020  ..              
-00083240: 2020 2020 2020 7472 793a 0d0a 2020 2020        try:..    
-00083250: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00083260: 2020 2020 7064 2e74 6f5f 6461 7465 7469      pd.to_dateti
-00083270: 6d65 2874 7261 696e 5b63 6f6c 5d2c 696e  me(train[col],in
-00083280: 6665 725f 6461 7465 7469 6d65 5f66 6f72  fer_datetime_for
-00083290: 6d61 743d 5472 7565 290d 0a20 2020 2020  mat=True)..     
-000832a0: 2020 2020 2020 2020 2020 2020 2020 2020                  
-000832b0: 2020 2076 6172 5f64 662e 6c6f 635b 7661     var_df.loc[va
-000832c0: 725f 6466 5b27 696e 6465 7827 5d3d 3d63  r_df['index']==c
-000832d0: 6f6c 2c27 6461 7465 5f74 696d 6527 5d20  ol,'date_time'] 
-000832e0: 3d20 310d 0a20 2020 2020 2020 2020 2020  = 1..           
-000832f0: 2020 2020 2020 2020 2065 7863 6570 743a           except:
-00083300: 0d0a 2020 2020 2020 2020 2020 2020 2020  ..              
-00083310: 2020 2020 2020 2020 2020 6966 2063 6f6c            if col
-00083320: 206e 6f74 2069 6e20 6e75 6d5f 626f 6f6c   not in num_bool
-00083330: 5f76 6172 733a 0d0a 2020 2020 2020 2020  _vars:..        
-00083340: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00083350: 2020 2020 7661 725f 6466 2e6c 6f63 5b76      var_df.loc[v
-00083360: 6172 5f64 665b 2769 6e64 6578 275d 3d3d  ar_df['index']==
-00083370: 636f 6c2c 2769 6e74 275d 203d 2031 0d0a  col,'int'] = 1..
-00083380: 2020 2020 656c 7365 3a0d 0a20 2020 2020      else:..     
-00083390: 2020 2070 6173 730d 0a20 2020 2069 6e74     pass..    int
-000833a0: 5f76 6172 7320 3d20 6c69 7374 2876 6172  _vars = list(var
-000833b0: 5f64 665b 2876 6172 5f64 665b 2769 6e74  _df[(var_df['int
-000833c0: 275d 203d 3d31 295d 5b27 696e 6465 7827  '] ==1)]['index'
-000833d0: 5d29 0d0a 2020 2020 6461 7465 5f76 6172  ])..    date_var
-000833e0: 7320 3d20 6c69 7374 2876 6172 5f64 665b  s = list(var_df[
-000833f0: 2876 6172 5f64 665b 2764 6174 655f 7469  (var_df['date_ti
-00083400: 6d65 275d 203d 3d20 3129 5d5b 2769 6e64  me'] == 1)]['ind
-00083410: 6578 275d 290d 0a20 2020 2069 645f 7661  ex'])..    id_va
-00083420: 7273 203d 206c 6973 7428 7661 725f 6466  rs = list(var_df
-00083430: 5b28 7661 725f 6466 5b27 6964 5f63 6f6c  [(var_df['id_col
-00083440: 275d 203d 3d20 3129 5d5b 2769 6e64 6578  '] == 1)]['index
-00083450: 275d 290d 0a20 2020 2073 756d 5f61 6c6c  '])..    sum_all
-00083460: 5f63 6f6c 735b 2769 6e74 5f76 6172 7327  _cols['int_vars'
-00083470: 5d20 3d20 696e 745f 7661 7273 0d0a 2020  ] = int_vars..  
-00083480: 2020 636f 7079 5f64 6174 655f 7661 7273    copy_date_vars
-00083490: 203d 2063 6f70 792e 6465 6570 636f 7079   = copy.deepcopy
-000834a0: 2864 6174 655f 7661 7273 290d 0a20 2020  (date_vars)..   
-000834b0: 2066 6f72 2064 6174 655f 7661 7220 696e   for date_var in
-000834c0: 2063 6f70 795f 6461 7465 5f76 6172 733a   copy_date_vars:
-000834d0: 0d0a 2020 2020 2020 2020 2323 2323 2054  ..        #### T
-000834e0: 6869 7320 7465 7374 2069 7320 746f 206d  his test is to m
-000834f0: 616b 6520 7375 7265 2073 7572 6520 6461  ake sure sure da
-00083500: 7465 2076 6172 7320 6172 6520 6163 7475  te vars are actu
-00083510: 616c 6c79 2064 6174 6520 7661 7273 0d0a  ally date vars..
-00083520: 2020 2020 2020 2020 7472 793a 0d0a 2020          try:..  
-00083530: 2020 2020 2020 2020 2020 7064 2e74 6f5f            pd.to_
-00083540: 6461 7465 7469 6d65 2874 7261 696e 5b64  datetime(train[d
-00083550: 6174 655f 7661 725d 2c69 6e66 6572 5f64  ate_var],infer_d
-00083560: 6174 6574 696d 655f 666f 726d 6174 3d54  atetime_format=T
-00083570: 7275 6529 0d0a 2020 2020 2020 2020 6578  rue)..        ex
-00083580: 6365 7074 3a0d 0a20 2020 2020 2020 2020  cept:..         
-00083590: 2020 2023 2323 2323 2069 6620 6e6f 7420     ##### if not 
-000835a0: 6120 6461 7465 2076 6172 2c20 7468 656e  a date var, then
-000835b0: 206a 7573 7420 6164 6420 6974 2074 6f20   just add it to 
-000835c0: 6465 6c65 7465 2069 7420 6672 6f6d 2070  delete it from p
-000835d0: 726f 6365 7373 696e 670d 0a20 2020 2020  rocessing..     
-000835e0: 2020 2020 2020 2063 6f6c 735f 6465 6c65         cols_dele
-000835f0: 7465 2e61 7070 656e 6428 6461 7465 5f76  te.append(date_v
-00083600: 6172 290d 0a20 2020 2020 2020 2020 2020  ar)..           
-00083610: 2064 6174 655f 7661 7273 2e72 656d 6f76   date_vars.remov
-00083620: 6528 6461 7465 5f76 6172 290d 0a20 2020  e(date_var)..   
-00083630: 2073 756d 5f61 6c6c 5f63 6f6c 735b 2764   sum_all_cols['d
-00083640: 6174 655f 7661 7273 275d 203d 2064 6174  ate_vars'] = dat
-00083650: 655f 7661 7273 0d0a 2020 2020 7375 6d5f  e_vars..    sum_
-00083660: 616c 6c5f 636f 6c73 5b27 6964 5f76 6172  all_cols['id_var
-00083670: 7327 5d20 3d20 6964 5f76 6172 730d 0a20  s'] = id_vars.. 
-00083680: 2020 2073 756d 5f61 6c6c 5f63 6f6c 735b     sum_all_cols[
-00083690: 2763 6f6c 735f 6465 6c65 7465 275d 203d  'cols_delete'] =
-000836a0: 2063 6f6c 735f 6465 6c65 7465 0d0a 2020   cols_delete..  
-000836b0: 2020 2323 2054 6869 7320 6973 2061 6e20    ## This is an 
-000836c0: 4558 5452 454d 454c 5920 636f 6d70 6c69  EXTREMELY compli
-000836d0: 6361 7465 6420 6c6f 6769 6320 666f 7220  cated logic for 
-000836e0: 6361 7420 7661 7273 2e20 446f 6e27 7420  cat vars. Don't 
-000836f0: 6368 616e 6765 2069 7420 756e 6c65 7373  change it unless
-00083700: 2079 6f75 2074 6573 7420 6974 206d 616e   you test it man
-00083710: 7920 7469 6d65 7321 0d0a 2020 2020 7661  y times!..    va
-00083720: 725f 6466 5b27 6e75 6d65 7269 6327 5d20  r_df['numeric'] 
-00083730: 3d20 300d 0a20 2020 2066 6c6f 6174 5f6f  = 0..    float_o
-00083740: 725f 6361 7420 3d20 7661 725f 6466 2e61  r_cat = var_df.a
-00083750: 7070 6c79 286c 616d 6264 6120 783a 2031  pply(lambda x: 1
-00083760: 2069 6620 785b 2774 7970 655f 6f66 5f63   if x['type_of_c
-00083770: 6f6c 756d 6e27 5d20 696e 205b 2766 6c6f  olumn'] in ['flo
-00083780: 6174 3136 272c 0d0a 2020 2020 2020 2020  at16',..        
-00083790: 2020 2020 2020 2020 2020 2020 2020 2020                  
-000837a0: 2020 2020 2766 6c6f 6174 3332 272c 2766      'float32','f
-000837b0: 6c6f 6174 3634 275d 2065 6c73 6520 302c  loat64'] else 0,
-000837c0: 0d0a 2020 2020 2020 2020 2020 2020 2020  ..              
-000837d0: 2020 2020 2020 2020 2020 2020 2020 2020                  
-000837e0: 2020 2020 2020 2020 2020 6178 6973 3d31            axis=1
-000837f0: 290d 0a20 2020 2023 2323 2323 2323 2020  )..    #######  
-00083800: 5765 206e 6565 6420 746f 206d 616b 6520  We need to make 
-00083810: 7375 7265 2074 6865 7265 2061 7265 206e  sure there are n
-00083820: 6f20 6361 7465 676f 7269 6361 6c20 7661  o categorical va
-00083830: 7273 2069 6e20 666c 6f61 7420 2323 2323  rs in float ####
-00083840: 2323 230d 0a20 2020 2069 6620 6c65 6e28  ###..    if len(
-00083850: 7661 725f 6466 2e6c 6f63 5b66 6c6f 6174  var_df.loc[float
-00083860: 5f6f 725f 6361 7420 3d3d 2031 5d29 203e  _or_cat == 1]) >
-00083870: 2030 3a0d 0a20 2020 2020 2020 2066 6f72   0:..        for
-00083880: 2063 6f6c 2069 6e20 7661 725f 6466 2e6c   col in var_df.l
-00083890: 6f63 5b66 6c6f 6174 5f6f 725f 6361 7420  oc[float_or_cat 
-000838a0: 3d3d 2031 5d5b 2769 6e64 6578 275d 2e76  == 1]['index'].v
-000838b0: 616c 7565 732e 746f 6c69 7374 2829 3a0d  alues.tolist():.
-000838c0: 0a20 2020 2020 2020 2020 2020 2069 6620  .            if 
-000838d0: 6c65 6e28 7472 6169 6e5b 636f 6c5d 2e76  len(train[col].v
-000838e0: 616c 7565 5f63 6f75 6e74 7328 2929 203e  alue_counts()) >
-000838f0: 2032 2061 6e64 206c 656e 2874 7261 696e   2 and len(train
-00083900: 5b63 6f6c 5d2e 7661 6c75 655f 636f 756e  [col].value_coun
-00083910: 7473 2829 0d0a 2020 2020 2020 2020 2020  ts()..          
-00083920: 2020 2020 2020 2920 3c3d 2066 6c6f 6174        ) <= float
-00083930: 5f6c 696d 6974 2061 6e64 206c 656e 2874  _limit and len(t
-00083940: 7261 696e 5b63 6f6c 5d2e 7661 6c75 655f  rain[col].value_
-00083950: 636f 756e 7473 2829 2920 3c3d 206c 656e  counts()) <= len
-00083960: 2874 7261 696e 293a 0d0a 2020 2020 2020  (train):..      
-00083970: 2020 2020 2020 2020 2020 7661 725f 6466            var_df
-00083980: 2e6c 6f63 5b76 6172 5f64 665b 2769 6e64  .loc[var_df['ind
-00083990: 6578 275d 3d3d 636f 6c2c 2763 6174 275d  ex']==col,'cat']
-000839a0: 203d 2031 0d0a 2020 2020 2020 2020 2020   = 1..          
-000839b0: 2020 656c 7365 3a0d 0a20 2020 2020 2020    else:..       
-000839c0: 2020 2020 2020 2020 2069 6620 636f 6c20           if col 
-000839d0: 6e6f 7420 696e 2028 6e75 6d5f 626f 6f6c  not in (num_bool
-000839e0: 5f76 6172 7320 2b20 6661 6374 6f72 5f76  _vars + factor_v
-000839f0: 6172 7329 3a0d 0a20 2020 2020 2020 2020  ars):..         
-00083a00: 2020 2020 2020 2020 2020 2076 6172 5f64             var_d
-00083a10: 662e 6c6f 635b 7661 725f 6466 5b27 696e  f.loc[var_df['in
-00083a20: 6465 7827 5d3d 3d63 6f6c 2c27 6e75 6d65  dex']==col,'nume
-00083a30: 7269 6327 5d20 3d20 310d 0a20 2020 2063  ric'] = 1..    c
-00083a40: 6174 5f76 6172 7320 3d20 6c69 7374 2876  at_vars = list(v
-00083a50: 6172 5f64 665b 2876 6172 5f64 665b 2763  ar_df[(var_df['c
-00083a60: 6174 275d 203d 3d31 295d 5b27 696e 6465  at'] ==1)]['inde
-00083a70: 7827 5d29 0d0a 2020 2020 636f 6e74 696e  x'])..    contin
-00083a80: 756f 7573 5f76 6172 7320 3d20 6c69 7374  uous_vars = list
-00083a90: 2876 6172 5f64 665b 2876 6172 5f64 665b  (var_df[(var_df[
-00083aa0: 276e 756d 6572 6963 275d 203d 3d31 295d  'numeric'] ==1)]
-00083ab0: 5b27 696e 6465 7827 5d29 0d0a 2020 2020  ['index'])..    
-00083ac0: 0d0a 2020 2020 2323 2323 2323 2323 2020  ..    ########  
-00083ad0: 5620 4520 5220 5920 2020 2049 204d 2050  V E R Y    I M P
-00083ae0: 204f 2052 2054 2041 204e 2054 2020 2023   O R T A N T   #
-00083af0: 2323 2323 2323 2323 2323 2323 2323 2323  ################
-00083b00: 2323 2323 2323 2323 2323 2323 2323 2323  ################
-00083b10: 2323 2323 2323 2323 2323 2323 2323 2323  ################
-00083b20: 2323 0d0a 2020 2020 6361 745f 7661 7273  ##..    cat_vars
-00083b30: 5f63 6f70 7920 3d20 636f 7079 2e64 6565  _copy = copy.dee
-00083b40: 7063 6f70 7928 6661 6374 6f72 5f76 6172  pcopy(factor_var
-00083b50: 7329 200d 0a20 2020 2066 6f72 2063 6174  s) ..    for cat
-00083b60: 2069 6e20 6361 745f 7661 7273 5f63 6f70   in cat_vars_cop
-00083b70: 793a 0d0a 2020 2020 2020 2020 6966 2064  y:..        if d
-00083b80: 665f 7072 6564 735b 6361 745d 2e64 7479  f_preds[cat].dty
-00083b90: 7065 3d3d 666c 6f61 743a 0d0a 2020 2020  pe==float:..    
-00083ba0: 2020 2020 2020 2020 636f 6e74 696e 756f          continuo
-00083bb0: 7573 5f76 6172 732e 6170 7065 6e64 2863  us_vars.append(c
-00083bc0: 6174 290d 0a20 2020 2020 2020 2020 2020  at)..           
-00083bd0: 2066 6163 746f 725f 7661 7273 2e72 656d   factor_vars.rem
-00083be0: 6f76 6528 6361 7429 0d0a 2020 2020 2020  ove(cat)..      
-00083bf0: 2020 2020 2020 7661 725f 6466 2e6c 6f63        var_df.loc
-00083c00: 5b76 6172 5f64 665b 2769 6e64 6578 275d  [var_df['index']
-00083c10: 3d3d 6361 742c 2764 6361 7427 5d20 3d20  ==cat,'dcat'] = 
-00083c20: 300d 0a20 2020 2020 2020 2020 2020 2076  0..            v
-00083c30: 6172 5f64 662e 6c6f 635b 7661 725f 6466  ar_df.loc[var_df
-00083c40: 5b27 696e 6465 7827 5d3d 3d63 6174 2c27  ['index']==cat,'
-00083c50: 6e75 6d65 7269 6327 5d20 3d20 310d 0a20  numeric'] = 1.. 
-00083c60: 2020 2020 2020 2065 6c69 6620 6c65 6e28         elif len(
-00083c70: 6466 5f70 7265 6473 5b63 6174 5d2e 7661  df_preds[cat].va
-00083c80: 6c75 655f 636f 756e 7473 2829 2920 3d3d  lue_counts()) ==
-00083c90: 2064 665f 7072 6564 732e 7368 6170 655b   df_preds.shape[
-00083ca0: 305d 3a0d 0a20 2020 2020 2020 2020 2020  0]:..           
-00083cb0: 2069 645f 7661 7273 2e61 7070 656e 6428   id_vars.append(
-00083cc0: 6361 7429 0d0a 2020 2020 2020 2020 2020  cat)..          
-00083cd0: 2020 6661 6374 6f72 5f76 6172 732e 7265    factor_vars.re
-00083ce0: 6d6f 7665 2863 6174 290d 0a20 2020 2020  move(cat)..     
-00083cf0: 2020 2020 2020 2076 6172 5f64 662e 6c6f         var_df.lo
-00083d00: 635b 7661 725f 6466 5b27 696e 6465 7827  c[var_df['index'
-00083d10: 5d3d 3d63 6174 2c27 6463 6174 275d 203d  ]==cat,'dcat'] =
-00083d20: 2030 0d0a 2020 2020 2020 2020 2020 2020   0..            
-00083d30: 7661 725f 6466 2e6c 6f63 5b76 6172 5f64  var_df.loc[var_d
-00083d40: 665b 2769 6e64 6578 275d 3d3d 6361 742c  f['index']==cat,
-00083d50: 2769 645f 636f 6c27 5d20 3d20 310d 0a20  'id_col'] = 1.. 
-00083d60: 2020 200d 0a20 2020 2073 756d 5f61 6c6c     ..    sum_all
-00083d70: 5f63 6f6c 735b 2766 6163 746f 725f 7661  _cols['factor_va
-00083d80: 7273 275d 203d 2066 6163 746f 725f 7661  rs'] = factor_va
-00083d90: 7273 0d0a 2020 2020 2323 2323 2320 5468  rs..    ##### Th
-00083da0: 6572 6520 6172 6520 6120 636f 7570 6c65  ere are a couple
-00083db0: 206f 6620 6578 7472 6120 7465 7374 7320   of extra tests 
-00083dc0: 796f 7520 6e65 6564 2074 6f20 646f 2074  you need to do t
-00083dd0: 6f20 7265 6d6f 7665 2061 6262 6572 6174  o remove abberat
-00083de0: 696f 6e73 2069 6e20 6361 745f 7661 7273  ions in cat_vars
-00083df0: 2023 2323 0d0a 2020 2020 6361 745f 7661   ###..    cat_va
-00083e00: 7273 5f63 6f70 7920 3d20 636f 7079 2e64  rs_copy = copy.d
-00083e10: 6565 7063 6f70 7928 6361 745f 7661 7273  eepcopy(cat_vars
-00083e20: 2920 0d0a 2020 2020 666f 7220 6361 7420  ) ..    for cat 
-00083e30: 696e 2063 6174 5f76 6172 735f 636f 7079  in cat_vars_copy
-00083e40: 3a0d 0a20 2020 2020 2020 2069 6620 6466  :..        if df
-00083e50: 5f70 7265 6473 5b63 6174 5d2e 6474 7970  _preds[cat].dtyp
-00083e60: 653d 3d66 6c6f 6174 3a0d 0a20 2020 2020  e==float:..     
-00083e70: 2020 2020 2020 2063 6f6e 7469 6e75 6f75         continuou
-00083e80: 735f 7661 7273 2e61 7070 656e 6428 6361  s_vars.append(ca
-00083e90: 7429 0d0a 2020 2020 2020 2020 2020 2020  t)..            
-00083ea0: 6361 745f 7661 7273 2e72 656d 6f76 6528  cat_vars.remove(
-00083eb0: 6361 7429 0d0a 2020 2020 2020 2020 2020  cat)..          
-00083ec0: 2020 7661 725f 6466 2e6c 6f63 5b76 6172    var_df.loc[var
-00083ed0: 5f64 665b 2769 6e64 6578 275d 3d3d 6361  _df['index']==ca
-00083ee0: 742c 2763 6174 275d 203d 2030 0d0a 2020  t,'cat'] = 0..  
-00083ef0: 2020 2020 2020 2020 2020 7661 725f 6466            var_df
-00083f00: 2e6c 6f63 5b76 6172 5f64 665b 2769 6e64  .loc[var_df['ind
-00083f10: 6578 275d 3d3d 6361 742c 276e 756d 6572  ex']==cat,'numer
-00083f20: 6963 275d 203d 2031 0d0a 2020 2020 2020  ic'] = 1..      
-00083f30: 2020 656c 6966 206c 656e 2864 665f 7072    elif len(df_pr
-00083f40: 6564 735b 6361 745d 2e76 616c 7565 5f63  eds[cat].value_c
-00083f50: 6f75 6e74 7328 2929 203d 3d20 6466 5f70  ounts()) == df_p
-00083f60: 7265 6473 2e73 6861 7065 5b30 5d3a 0d0a  reds.shape[0]:..
-00083f70: 2020 2020 2020 2020 2020 2020 6964 5f76              id_v
-00083f80: 6172 732e 6170 7065 6e64 2863 6174 290d  ars.append(cat).
-00083f90: 0a20 2020 2020 2020 2020 2020 2063 6174  .            cat
-00083fa0: 5f76 6172 732e 7265 6d6f 7665 2863 6174  _vars.remove(cat
-00083fb0: 290d 0a20 2020 2020 2020 2020 2020 2076  )..            v
-00083fc0: 6172 5f64 662e 6c6f 635b 7661 725f 6466  ar_df.loc[var_df
-00083fd0: 5b27 696e 6465 7827 5d3d 3d63 6174 2c27  ['index']==cat,'
-00083fe0: 6361 7427 5d20 3d20 300d 0a20 2020 2020  cat'] = 0..     
-00083ff0: 2020 2020 2020 2076 6172 5f64 662e 6c6f         var_df.lo
-00084000: 635b 7661 725f 6466 5b27 696e 6465 7827  c[var_df['index'
-00084010: 5d3d 3d63 6174 2c27 6964 5f63 6f6c 275d  ]==cat,'id_col']
-00084020: 203d 2031 0d0a 2020 2020 7375 6d5f 616c   = 1..    sum_al
-00084030: 6c5f 636f 6c73 5b27 6361 745f 7661 7273  l_cols['cat_vars
-00084040: 275d 203d 2063 6174 5f76 6172 730d 0a20  '] = cat_vars.. 
-00084050: 2020 2073 756d 5f61 6c6c 5f63 6f6c 735b     sum_all_cols[
-00084060: 2763 6f6e 7469 6e75 6f75 735f 7661 7273  'continuous_vars
-00084070: 275d 203d 2063 6f6e 7469 6e75 6f75 735f  '] = continuous_
-00084080: 7661 7273 0d0a 2020 2020 7375 6d5f 616c  vars..    sum_al
-00084090: 6c5f 636f 6c73 5b27 6964 5f76 6172 7327  l_cols['id_vars'
-000840a0: 5d20 3d20 6964 5f76 6172 730d 0a20 2020  ] = id_vars..   
-000840b0: 2023 2323 2323 2320 5468 6973 2069 7320   ###### This is 
-000840c0: 7768 6572 6520 796f 7520 636f 6e73 6f6c  where you consol
-000840d0: 6461 7465 2074 6865 206e 756d 6265 7273  date the numbers
-000840e0: 2023 2323 2323 2323 2323 2323 0d0a 2020   ###########..  
-000840f0: 2020 7661 725f 6469 6374 5f73 756d 203d    var_dict_sum =
-00084100: 2064 6963 7428 7a69 7028 7661 725f 6466   dict(zip(var_df
-00084110: 2e76 616c 7565 735b 3a2c 305d 2c20 7661  .values[:,0], va
-00084120: 725f 6466 2e76 616c 7565 735b 3a2c 323a  r_df.values[:,2:
-00084130: 5d2e 7375 6d28 3129 2929 0d0a 2020 2020  ].sum(1)))..    
-00084140: 666f 7220 636f 6c2c 2073 756d 7661 6c20  for col, sumval 
-00084150: 696e 2076 6172 5f64 6963 745f 7375 6d2e  in var_dict_sum.
-00084160: 6974 656d 7328 293a 0d0a 2020 2020 2020  items():..      
-00084170: 2020 6966 2073 756d 7661 6c20 3d3d 2030    if sumval == 0
-00084180: 3a0d 0a20 2020 2020 2020 2020 2020 2070  :..            p
-00084190: 7269 6e74 2827 2573 206f 6620 7479 7065  rint('%s of type
-000841a0: 3d25 7320 6973 206e 6f74 2063 6c61 7373  =%s is not class
-000841b0: 6966 6965 6427 2025 2863 6f6c 2c74 7261  ified' %(col,tra
-000841c0: 696e 5b63 6f6c 5d2e 6474 7970 6529 290d  in[col].dtype)).
-000841d0: 0a20 2020 2020 2020 2065 6c69 6620 7375  .        elif su
-000841e0: 6d76 616c 203e 2031 3a0d 0a20 2020 2020  mval > 1:..     
-000841f0: 2020 2020 2020 2070 7269 6e74 2827 2573         print('%s
-00084200: 206f 6620 7479 7065 3d25 7320 6973 2063   of type=%s is c
-00084210: 6c61 7373 6966 6965 6420 696e 746f 206d  lassified into m
-00084220: 6f72 6520 7468 656e 206f 6e65 2074 7970  ore then one typ
-00084230: 6527 2025 2863 6f6c 2c74 7261 696e 5b63  e' %(col,train[c
-00084240: 6f6c 5d2e 6474 7970 6529 290d 0a20 2020  ol].dtype))..   
-00084250: 2020 2020 2065 6c73 653a 0d0a 2020 2020       else:..    
-00084260: 2020 2020 2020 2020 7061 7373 0d0a 2020          pass..  
-00084270: 2020 2323 2323 2320 4966 2074 6865 7265    ##### If there
-00084280: 2061 7265 206d 6f72 6520 7468 616e 2031   are more than 1
-00084290: 3030 3020 756e 6971 7565 2076 616c 7565  000 unique value
-000842a0: 732c 2074 6865 6e20 6164 6420 6974 2074  s, then add it t
-000842b0: 6f20 4e4c 5020 7661 7273 2023 2323 0d0a  o NLP vars ###..
-000842c0: 2020 2020 636f 7079 5f64 6973 6372 6574      copy_discret
-000842d0: 6573 203d 2063 6f70 792e 6465 6570 636f  es = copy.deepco
-000842e0: 7079 2864 6973 6372 6574 655f 7374 7269  py(discrete_stri
-000842f0: 6e67 5f76 6172 7329 0d0a 2020 2020 666f  ng_vars)..    fo
-00084300: 7220 6561 6368 5f64 6973 6372 6574 6520  r each_discrete 
-00084310: 696e 2063 6f70 795f 6469 7363 7265 7465  in copy_discrete
-00084320: 733a 0d0a 2020 2020 2020 2020 6966 2074  s:..        if t
-00084330: 7261 696e 5b65 6163 685f 6469 7363 7265  rain[each_discre
-00084340: 7465 5d2e 6e75 6e69 7175 6528 2920 3e3d  te].nunique() >=
-00084350: 2031 3030 303a 0d0a 2020 2020 2020 2020   1000:..        
-00084360: 2020 2020 6e6c 705f 7661 7273 2e61 7070      nlp_vars.app
-00084370: 656e 6428 6561 6368 5f64 6973 6372 6574  end(each_discret
-00084380: 6529 0d0a 2020 2020 2020 2020 2020 2020  e)..            
-00084390: 6469 7363 7265 7465 5f73 7472 696e 675f  discrete_string_
-000843a0: 7661 7273 2e72 656d 6f76 6528 6561 6368  vars.remove(each
-000843b0: 5f64 6973 6372 6574 6529 0d0a 2020 2020  _discrete)..    
-000843c0: 2020 2020 656c 6966 2074 7261 696e 5b65      elif train[e
-000843d0: 6163 685f 6469 7363 7265 7465 5d2e 6e75  ach_discrete].nu
-000843e0: 6e69 7175 6528 2920 3e20 3130 3020 616e  nique() > 100 an
-000843f0: 6420 7472 6169 6e5b 6561 6368 5f64 6973  d train[each_dis
-00084400: 6372 6574 655d 2e6e 756e 6971 7565 2829  crete].nunique()
-00084410: 203c 2031 3030 303a 0d0a 2020 2020 2020   < 1000:..      
-00084420: 2020 2020 2020 7061 7373 0d0a 2020 2020        pass..    
-00084430: 2020 2020 656c 7365 3a0d 0a20 2020 2020      else:..     
-00084440: 2020 2020 2020 2023 2323 2049 6620 6974         ### If it
-00084450: 2069 7320 6c65 7373 2074 6861 6e20 3130   is less than 10
-00084460: 3020 756e 6971 7565 2076 616c 7565 732c  0 unique values,
-00084470: 2074 6865 6e20 6d61 6b65 2069 7420 6361   then make it ca
-00084480: 7465 676f 7269 6361 6c20 7661 720d 0a20  tegorical var.. 
-00084490: 2020 2020 2020 2020 2020 2063 6174 5f76             cat_v
-000844a0: 6172 732e 6170 7065 6e64 2865 6163 685f  ars.append(each_
-000844b0: 6469 7363 7265 7465 290d 0a20 2020 2020  discrete)..     
-000844c0: 2020 2020 2020 2064 6973 6372 6574 655f         discrete_
-000844d0: 7374 7269 6e67 5f76 6172 732e 7265 6d6f  string_vars.remo
-000844e0: 7665 2865 6163 685f 6469 7363 7265 7465  ve(each_discrete
-000844f0: 290d 0a20 2020 2073 756d 5f61 6c6c 5f63  )..    sum_all_c
-00084500: 6f6c 735b 2764 6973 6372 6574 655f 7374  ols['discrete_st
-00084510: 7269 6e67 5f76 6172 7327 5d20 3d20 2064  ring_vars'] =  d
-00084520: 6973 6372 6574 655f 7374 7269 6e67 5f76  iscrete_string_v
-00084530: 6172 730d 0a20 2020 2073 756d 5f61 6c6c  ars..    sum_all
-00084540: 5f63 6f6c 735b 2763 6174 5f76 6172 7327  _cols['cat_vars'
-00084550: 5d20 3d20 6361 745f 7661 7273 0d0a 2020  ] = cat_vars..  
-00084560: 2020 7375 6d5f 616c 6c5f 636f 6c73 5b27    sum_all_cols['
-00084570: 6e6c 705f 7661 7273 275d 203d 206e 6c70  nlp_vars'] = nlp
-00084580: 5f76 6172 730d 0a20 2020 2023 2323 2323  _vars..    #####
-00084590: 2323 2323 2323 2323 2323 2020 5468 6973  ##########  This
-000845a0: 2069 7320 7768 6572 6520 796f 7520 7072   is where you pr
-000845b0: 696e 7420 616c 6c20 7468 6520 7479 7065  int all the type
-000845c0: 7320 6f66 2076 6172 6961 626c 6573 2023  s of variables #
-000845d0: 2323 2323 2323 2323 2323 2323 230d 0a20  #############.. 
-000845e0: 2020 2023 2323 2323 2323 2052 6574 7572     ####### Retur
-000845f0: 6e73 2038 2076 6172 7320 696e 2074 6865  ns 8 vars in the
-00084600: 2066 6f6c 6c6f 7769 6e67 206f 7264 6572   following order
-00084610: 3a20 636f 6e74 696e 756f 7573 5f76 6172  : continuous_var
-00084620: 732c 696e 745f 7661 7273 2c63 6174 5f76  s,int_vars,cat_v
-00084630: 6172 732c 0d0a 2020 2020 2323 2320 2073  ars,..    ###  s
-00084640: 7472 696e 675f 626f 6f6c 5f76 6172 732c  tring_bool_vars,
-00084650: 6469 7363 7265 7465 5f73 7472 696e 675f  discrete_string_
-00084660: 7661 7273 2c6e 6c70 5f76 6172 732c 6461  vars,nlp_vars,da
-00084670: 7465 5f6f 725f 6964 5f76 6172 732c 636f  te_or_id_vars,co
-00084680: 6c73 5f64 656c 6574 650d 0a20 2020 2069  ls_delete..    i
-00084690: 6620 7665 7262 6f73 6520 3d3d 2031 3a0d  f verbose == 1:.
-000846a0: 0a20 2020 2020 2020 2070 7269 6e74 2822  .        print("
-000846b0: 2020 2020 4e75 6d62 6572 206f 6620 4e75      Number of Nu
-000846c0: 6d65 7269 6320 436f 6c75 6d6e 7320 3d20  meric Columns = 
-000846d0: 222c 206c 656e 2863 6f6e 7469 6e75 6f75  ", len(continuou
-000846e0: 735f 7661 7273 2929 0d0a 2020 2020 2020  s_vars))..      
-000846f0: 2020 7072 696e 7428 2220 2020 204e 756d    print("    Num
-00084700: 6265 7220 6f66 2049 6e74 6567 6572 2d43  ber of Integer-C
-00084710: 6174 6567 6f72 6963 616c 2043 6f6c 756d  ategorical Colum
-00084720: 6e73 203d 2022 2c20 6c65 6e28 696e 745f  ns = ", len(int_
-00084730: 7661 7273 2929 0d0a 2020 2020 2020 2020  vars))..        
-00084740: 7072 696e 7428 2220 2020 204e 756d 6265  print("    Numbe
-00084750: 7220 6f66 2053 7472 696e 672d 4361 7465  r of String-Cate
-00084760: 676f 7269 6361 6c20 436f 6c75 6d6e 7320  gorical Columns 
-00084770: 3d20 222c 206c 656e 2863 6174 5f76 6172  = ", len(cat_var
-00084780: 7329 290d 0a20 2020 2020 2020 2070 7269  s))..        pri
-00084790: 6e74 2822 2020 2020 4e75 6d62 6572 206f  nt("    Number o
-000847a0: 6620 4661 6374 6f72 2d43 6174 6567 6f72  f Factor-Categor
-000847b0: 6963 616c 2043 6f6c 756d 6e73 203d 2022  ical Columns = "
-000847c0: 2c20 6c65 6e28 6661 6374 6f72 5f76 6172  , len(factor_var
-000847d0: 7329 290d 0a20 2020 2020 2020 2070 7269  s))..        pri
-000847e0: 6e74 2822 2020 2020 4e75 6d62 6572 206f  nt("    Number o
-000847f0: 6620 5374 7269 6e67 2d42 6f6f 6c65 616e  f String-Boolean
-00084800: 2043 6f6c 756d 6e73 203d 2022 2c20 6c65   Columns = ", le
-00084810: 6e28 7374 7269 6e67 5f62 6f6f 6c5f 7661  n(string_bool_va
-00084820: 7273 2929 0d0a 2020 2020 2020 2020 7072  rs))..        pr
-00084830: 696e 7428 2220 2020 204e 756d 6265 7220  int("    Number 
-00084840: 6f66 204e 756d 6572 6963 2d42 6f6f 6c65  of Numeric-Boole
-00084850: 616e 2043 6f6c 756d 6e73 203d 2022 2c20  an Columns = ", 
-00084860: 6c65 6e28 6e75 6d5f 626f 6f6c 5f76 6172  len(num_bool_var
-00084870: 7329 290d 0a20 2020 2020 2020 2070 7269  s))..        pri
-00084880: 6e74 2822 2020 2020 4e75 6d62 6572 206f  nt("    Number o
-00084890: 6620 4469 7363 7265 7465 2053 7472 696e  f Discrete Strin
-000848a0: 6720 436f 6c75 6d6e 7320 3d20 222c 206c  g Columns = ", l
-000848b0: 656e 2864 6973 6372 6574 655f 7374 7269  en(discrete_stri
-000848c0: 6e67 5f76 6172 7329 290d 0a20 2020 2020  ng_vars))..     
-000848d0: 2020 2070 7269 6e74 2822 2020 2020 4e75     print("    Nu
-000848e0: 6d62 6572 206f 6620 4e4c 5020 5374 7269  mber of NLP Stri
-000848f0: 6e67 2043 6f6c 756d 6e73 203d 2022 2c20  ng Columns = ", 
-00084900: 6c65 6e28 6e6c 705f 7661 7273 2929 0d0a  len(nlp_vars))..
-00084910: 2020 2020 2020 2020 7072 696e 7428 2220          print(" 
-00084920: 2020 204e 756d 6265 7220 6f66 2044 6174     Number of Dat
-00084930: 6520 5469 6d65 2043 6f6c 756d 6e73 203d  e Time Columns =
-00084940: 2022 2c20 6c65 6e28 6461 7465 5f76 6172   ", len(date_var
-00084950: 7329 290d 0a20 2020 2020 2020 2070 7269  s))..        pri
-00084960: 6e74 2822 2020 2020 4e75 6d62 6572 206f  nt("    Number o
-00084970: 6620 4944 2043 6f6c 756d 6e73 203d 2022  f ID Columns = "
-00084980: 2c20 6c65 6e28 6964 5f76 6172 7329 290d  , len(id_vars)).
-00084990: 0a20 2020 2020 2020 2070 7269 6e74 2822  .        print("
-000849a0: 2020 2020 4e75 6d62 6572 206f 6620 436f      Number of Co
-000849b0: 6c75 6d6e 7320 746f 2044 656c 6574 6520  lumns to Delete 
-000849c0: 3d20 222c 206c 656e 2863 6f6c 735f 6465  = ", len(cols_de
-000849d0: 6c65 7465 2929 0d0a 2020 2020 6966 2076  lete))..    if v
-000849e0: 6572 626f 7365 203d 3d20 323a 0d0a 2020  erbose == 2:..  
-000849f0: 2020 2020 2020 7072 696e 7428 2720 2050        print('  P
-00084a00: 7269 6e74 696e 6720 7570 746f 2025 6420  rinting upto %d 
-00084a10: 636f 6c75 6d6e 7320 6d61 7820 696e 2065  columns max in e
-00084a20: 6163 6820 6361 7465 676f 7279 3a27 2025  ach category:' %
-00084a30: 6d61 785f 636f 6c73 5f74 6f5f 7072 696e  max_cols_to_prin
-00084a40: 7429 0d0a 2020 2020 2020 2020 7072 696e  t)..        prin
-00084a50: 7428 2220 2020 204e 756d 6572 6963 2043  t("    Numeric C
-00084a60: 6f6c 756d 6e73 203a 2025 7322 2025 636f  olumns : %s" %co
-00084a70: 6e74 696e 756f 7573 5f76 6172 735b 3a6d  ntinuous_vars[:m
-00084a80: 6178 5f63 6f6c 735f 746f 5f70 7269 6e74  ax_cols_to_print
-00084a90: 5d29 0d0a 2020 2020 2020 2020 7072 696e  ])..        prin
-00084aa0: 7428 2220 2020 2049 6e74 6567 6572 2d43  t("    Integer-C
-00084ab0: 6174 6567 6f72 6963 616c 2043 6f6c 756d  ategorical Colum
-00084ac0: 6e73 3a20 2573 2220 2569 6e74 5f76 6172  ns: %s" %int_var
-00084ad0: 735b 3a6d 6178 5f63 6f6c 735f 746f 5f70  s[:max_cols_to_p
-00084ae0: 7269 6e74 5d29 0d0a 2020 2020 2020 2020  rint])..        
-00084af0: 7072 696e 7428 2220 2020 2053 7472 696e  print("    Strin
-00084b00: 672d 4361 7465 676f 7269 6361 6c20 436f  g-Categorical Co
-00084b10: 6c75 6d6e 733a 2025 7322 2025 6361 745f  lumns: %s" %cat_
-00084b20: 7661 7273 5b3a 6d61 785f 636f 6c73 5f74  vars[:max_cols_t
-00084b30: 6f5f 7072 696e 745d 290d 0a20 2020 2020  o_print])..     
-00084b40: 2020 2070 7269 6e74 2822 2020 2020 4661     print("    Fa
-00084b50: 6374 6f72 2d43 6174 6567 6f72 6963 616c  ctor-Categorical
-00084b60: 2043 6f6c 756d 6e73 3a20 2573 2220 2566   Columns: %s" %f
-00084b70: 6163 746f 725f 7661 7273 5b3a 6d61 785f  actor_vars[:max_
-00084b80: 636f 6c73 5f74 6f5f 7072 696e 745d 290d  cols_to_print]).
-00084b90: 0a20 2020 2020 2020 2070 7269 6e74 2822  .        print("
-00084ba0: 2020 2020 5374 7269 6e67 2d42 6f6f 6c65      String-Boole
-00084bb0: 616e 2043 6f6c 756d 6e73 3a20 2573 2220  an Columns: %s" 
-00084bc0: 2573 7472 696e 675f 626f 6f6c 5f76 6172  %string_bool_var
-00084bd0: 735b 3a6d 6178 5f63 6f6c 735f 746f 5f70  s[:max_cols_to_p
-00084be0: 7269 6e74 5d29 0d0a 2020 2020 2020 2020  rint])..        
-00084bf0: 7072 696e 7428 2220 2020 204e 756d 6572  print("    Numer
-00084c00: 6963 2d42 6f6f 6c65 616e 2043 6f6c 756d  ic-Boolean Colum
-00084c10: 6e73 3a20 2573 2220 256e 756d 5f62 6f6f  ns: %s" %num_boo
-00084c20: 6c5f 7661 7273 5b3a 6d61 785f 636f 6c73  l_vars[:max_cols
-00084c30: 5f74 6f5f 7072 696e 745d 290d 0a20 2020  _to_print])..   
-00084c40: 2020 2020 2070 7269 6e74 2822 2020 2020       print("    
-00084c50: 4469 7363 7265 7465 2053 7472 696e 6720  Discrete String 
-00084c60: 436f 6c75 6d6e 733a 2025 7322 2025 6469  Columns: %s" %di
-00084c70: 7363 7265 7465 5f73 7472 696e 675f 7661  screte_string_va
-00084c80: 7273 5b3a 6d61 785f 636f 6c73 5f74 6f5f  rs[:max_cols_to_
-00084c90: 7072 696e 745d 290d 0a20 2020 2020 2020  print])..       
-00084ca0: 2070 7269 6e74 2822 2020 2020 4e4c 5020   print("    NLP 
-00084cb0: 7465 7874 2043 6f6c 756d 6e73 3a20 2573  text Columns: %s
-00084cc0: 2220 256e 6c70 5f76 6172 735b 3a6d 6178  " %nlp_vars[:max
-00084cd0: 5f63 6f6c 735f 746f 5f70 7269 6e74 5d29  _cols_to_print])
-00084ce0: 0d0a 2020 2020 2020 2020 7072 696e 7428  ..        print(
-00084cf0: 2220 2020 2044 6174 6520 5469 6d65 2043  "    Date Time C
-00084d00: 6f6c 756d 6e73 3a20 2573 2220 2564 6174  olumns: %s" %dat
-00084d10: 655f 7661 7273 5b3a 6d61 785f 636f 6c73  e_vars[:max_cols
-00084d20: 5f74 6f5f 7072 696e 745d 290d 0a20 2020  _to_print])..   
-00084d30: 2020 2020 2070 7269 6e74 2822 2020 2020       print("    
-00084d40: 4944 2043 6f6c 756d 6e73 3a20 2573 2220  ID Columns: %s" 
-00084d50: 2569 645f 7661 7273 5b3a 6d61 785f 636f  %id_vars[:max_co
-00084d60: 6c73 5f74 6f5f 7072 696e 745d 290d 0a20  ls_to_print]).. 
-00084d70: 2020 2020 2020 2070 7269 6e74 2822 2020         print("  
-00084d80: 2020 436f 6c75 6d6e 7320 7468 6174 2077    Columns that w
-00084d90: 696c 6c20 6e6f 7420 6265 2063 6f6e 7369  ill not be consi
-00084da0: 6465 7265 6420 696e 206d 6f64 656c 696e  dered in modelin
-00084db0: 673a 2025 7322 2025 636f 6c73 5f64 656c  g: %s" %cols_del
-00084dc0: 6574 655b 3a6d 6178 5f63 6f6c 735f 746f  ete[:max_cols_to
-00084dd0: 5f70 7269 6e74 5d29 0d0a 2020 2020 2323  _print])..    ##
-00084de0: 2323 2320 6e6f 7720 636f 6c6c 6563 7420  ### now collect 
-00084df0: 616c 6c20 7468 6520 636f 6c75 6d6e 2074  all the column t
-00084e00: 7970 6573 2061 6e64 2063 6f6c 756d 6e20  ypes and column 
-00084e10: 6e61 6d65 7320 696e 746f 2061 2073 696e  names into a sin
-00084e20: 676c 6520 6469 6374 696f 6e61 7279 2074  gle dictionary t
-00084e30: 6f20 7265 7475 726e 210d 0a20 2020 200d  o return!..    .
-00084e40: 0a20 2020 206c 656e 5f73 756d 5f61 6c6c  .    len_sum_all
-00084e50: 5f63 6f6c 7320 3d20 7265 6475 6365 2861  _cols = reduce(a
-00084e60: 6464 2c5b 6c65 6e28 7629 2066 6f72 2076  dd,[len(v) for v
-00084e70: 2069 6e20 7375 6d5f 616c 6c5f 636f 6c73   in sum_all_cols
-00084e80: 2e76 616c 7565 7328 295d 290d 0a20 2020  .values()])..   
-00084e90: 2069 6620 6c65 6e5f 7375 6d5f 616c 6c5f   if len_sum_all_
-00084ea0: 636f 6c73 203d 3d20 6f72 6967 5f63 6f6c  cols == orig_col
-00084eb0: 735f 746f 7461 6c3a 0d0a 2020 2020 2020  s_total:..      
-00084ec0: 2020 7072 696e 7428 2720 2020 2025 6420    print('    %d 
-00084ed0: 5072 6564 6963 746f 7273 2063 6c61 7373  Predictors class
-00084ee0: 6966 6965 642e 2e2e 2720 256f 7269 675f  ified...' %orig_
-00084ef0: 636f 6c73 5f74 6f74 616c 290d 0a20 2020  cols_total)..   
-00084f00: 2020 2020 2023 7072 696e 7428 2720 2020       #print('   
-00084f10: 2020 2020 2054 6869 7320 646f 6573 206e       This does n
-00084f20: 6f74 2069 6e63 6c75 6465 2074 6865 2054  ot include the T
-00084f30: 6172 6765 7420 636f 6c75 6d6e 2873 2927  arget column(s)'
-00084f40: 290d 0a20 2020 2065 6c73 653a 0d0a 2020  )..    else:..  
-00084f50: 2020 2020 2020 7072 696e 7428 274e 6f20        print('No 
-00084f60: 6f66 2063 6f6c 756d 6e73 2063 6c61 7373  of columns class
-00084f70: 6966 6965 6420 2564 2064 6f65 7320 6e6f  ified %d does no
-00084f80: 7420 6d61 7463 6820 2564 2074 6f74 616c  t match %d total
-00084f90: 2063 6f6c 732e 2043 6f6e 7469 6e75 696e   cols. Continuin
-00084fa0: 672e 2e2e 2720 2528 0d0a 2020 2020 2020  g...' %(..      
-00084fb0: 2020 2020 2020 2020 2020 2020 206c 656e               len
-00084fc0: 5f73 756d 5f61 6c6c 5f63 6f6c 732c 206f  _sum_all_cols, o
-00084fd0: 7269 675f 636f 6c73 5f74 6f74 616c 2929  rig_cols_total))
-00084fe0: 0d0a 2020 2020 2020 2020 6c73 203d 2073  ..        ls = s
-00084ff0: 756d 5f61 6c6c 5f63 6f6c 732e 7661 6c75  um_all_cols.valu
-00085000: 6573 2829 0d0a 2020 2020 2020 2020 666c  es()..        fl
-00085010: 6174 5f6c 6973 7420 3d20 5b69 7465 6d20  at_list = [item 
-00085020: 666f 7220 7375 626c 6973 7420 696e 206c  for sublist in l
-00085030: 7320 666f 7220 6974 656d 2069 6e20 7375  s for item in su
-00085040: 626c 6973 745d 0d0a 2020 2020 2020 2020  blist]..        
-00085050: 6966 206c 656e 286c 6566 745f 7375 6274  if len(left_subt
-00085060: 7261 6374 286c 6973 7428 7472 6169 6e29  ract(list(train)
-00085070: 2c66 6c61 745f 6c69 7374 2929 203d 3d20  ,flat_list)) == 
-00085080: 303a 0d0a 2020 2020 2020 2020 2020 2020  0:..            
-00085090: 7072 696e 7428 2720 4d69 7373 696e 6720  print(' Missing 
-000850a0: 636f 6c75 6d6e 7320 3d20 4e6f 6e65 2729  columns = None')
-000850b0: 0d0a 2020 2020 2020 2020 656c 7365 3a0d  ..        else:.
-000850c0: 0a20 2020 2020 2020 2020 2020 2070 7269  .            pri
-000850d0: 6e74 2827 204d 6973 7369 6e67 2063 6f6c  nt(' Missing col
-000850e0: 756d 6e73 203d 2025 7327 2025 6c65 6674  umns = %s' %left
-000850f0: 5f73 7562 7472 6163 7428 6c69 7374 2874  _subtract(list(t
-00085100: 7261 696e 292c 666c 6174 5f6c 6973 7429  rain),flat_list)
-00085110: 290d 0a20 2020 2072 6574 7572 6e20 7375  )..    return su
-00085120: 6d5f 616c 6c5f 636f 6c73 0d0a 2323 2323  m_all_cols..####
-00085130: 2323 2323 2323 2323 2323 2323 2323 2323  ################
-00085140: 2323 2323 2323 2323 2323 2323 2323 2323  ################
-00085150: 2323 2323 2323 2323 2323 2323 2323 2323  ################
-00085160: 2323 2323 2323 2323 2323 2323 2323 2323  ################
-00085170: 2323 2323 2323 2323 2323 2323 2323 2323  ################
-00085180: 0d0a 0000 0000 0000 0000 0000 0000 0000  ................
-00085190: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-000851a0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-000851b0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-000851c0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-000851d0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-000851e0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-000851f0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-00085200: 2e2f 2e2f 4050 6178 4865 6164 6572 0000  ././@PaxHeader..
-00085210: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-00085220: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-00085230: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-00085240: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-00085250: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-00085260: 0000 0000 3030 3030 3030 3000 3030 3030  ....0000000.0000
-00085270: 3030 3000 3030 3030 3030 3000 3030 3030  000.0000000.0000
-00085280: 3030 3030 3032 3600 3030 3030 3030 3030  0000026.00000000
-00085290: 3030 3000 3031 3134 3533 0020 7800 0000  000.011453. x...
-000852a0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-000852b0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-000852c0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-000852d0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-000852e0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-000852f0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-00085300: 0075 7374 6172 0030 3000 0000 0000 0000  .ustar.00.......
-00085310: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-00085320: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-00085330: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-00085340: 0000 0000 0000 0000 0030 3030 3030 3030  .........0000000
-00085350: 0030 3030 3030 3030 0000 0000 0000 0000  .0000000........
-00085360: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-00085370: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-00085380: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-00085390: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-000853a0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-000853b0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-000853c0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-000853d0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-000853e0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-000853f0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-00085400: 3232 206d 7469 6d65 3d31 3637 3831 3539  22 mtime=1678159
-00085410: 3732 322e 300a 0000 0000 0000 0000 0000  722.0...........
-00085420: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-00085430: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-00085440: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-00085450: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-00085460: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-00085470: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-00085480: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-00085490: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-000854a0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-000854b0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-000854c0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-000854d0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-000854e0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-000854f0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-00085500: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-00085510: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-00085520: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-00085530: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-00085540: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-00085550: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-00085560: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-00085570: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-00085580: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-00085590: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-000855a0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-000855b0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-000855c0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-000855d0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-000855e0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-000855f0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-00085600: 6175 746f 7669 6d6c 2d30 2e31 2e37 3134  autoviml-0.1.714
-00085610: 2f61 7574 6f76 696d 6c2f 6375 7374 6f6d  /autoviml/custom
-00085620: 5f73 636f 7265 732e 7079 0000 0000 0000  _scores.py......
-00085630: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-00085640: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-00085650: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-00085660: 0000 0000 3030 3030 3737 3700 3030 3031  ....0000777.0001
-00085670: 3735 3000 3030 3031 3735 3000 3030 3030  750.0001750.0000
-00085680: 3030 3132 3536 3400 3030 3030 3030 3030  0012564.00000000
-00085690: 3030 3000 3032 3032 3236 0020 3000 0000  000.020226. 0...
-000856a0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-000856b0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-000856c0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-000856d0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-000856e0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-000856f0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-00085700: 0075 7374 6172 0030 3072 616d 0000 0000  .ustar.00ram....
-00085710: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-00085720: 0000 0000 0000 0000 0072 616d 0000 0000  .........ram....
-00085730: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-00085740: 0000 0000 0000 0000 0030 3030 3030 3030  .........0000000
-00085750: 0030 3030 3030 3030 0000 0000 0000 0000  .0000000........
-00085760: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-00085770: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-00085780: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-00085790: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-000857a0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-000857b0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-000857c0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-000857d0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-000857e0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-000857f0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-00085800: 696d 706f 7274 206e 756d 7079 2061 7320  import numpy as 
-00085810: 6e70 0d0a 6672 6f6d 2073 6b6c 6561 726e  np..from sklearn
-00085820: 2069 6d70 6f72 7420 6d6f 6465 6c5f 7365   import model_se
-00085830: 6c65 6374 696f 6e0d 0a66 726f 6d20 736b  lection..from sk
-00085840: 6c65 6172 6e2e 6d65 7472 6963 7320 696d  learn.metrics im
-00085850: 706f 7274 2063 6f6e 6675 7369 6f6e 5f6d  port confusion_m
-00085860: 6174 7269 782c 206d 6561 6e5f 7371 7561  atrix, mean_squa
-00085870: 7265 645f 6572 726f 720d 0a66 726f 6d20  red_error..from 
-00085880: 736b 6c65 6172 6e20 696d 706f 7274 206d  sklearn import m
-00085890: 6574 7269 6373 0d0a 6672 6f6d 2073 6b6c  etrics..from skl
-000858a0: 6561 726e 2069 6d70 6f72 7420 6d6f 6465  earn import mode
-000858b0: 6c5f 7365 6c65 6374 696f 6e2c 206d 6574  l_selection, met
-000858c0: 7269 6373 2020 2023 4164 6469 7469 6f6e  rics   #Addition
-000858d0: 616c 2073 6b6c 6561 726e 2066 756e 6374  al sklearn funct
-000858e0: 696f 6e73 0d0a 6672 6f6d 2073 6b6c 6561  ions..from sklea
-000858f0: 726e 2e6d 6574 7269 6373 2069 6d70 6f72  rn.metrics impor
-00085900: 7420 6163 6375 7261 6379 5f73 636f 7265  t accuracy_score
-00085910: 2c66 315f 7363 6f72 652c 726f 635f 6175  ,f1_score,roc_au
-00085920: 635f 7363 6f72 652c 6c6f 675f 6c6f 7373  c_score,log_loss
-00085930: 0d0a 6672 6f6d 2073 6b6c 6561 726e 2e6d  ..from sklearn.m
-00085940: 6574 7269 6373 2069 6d70 6f72 7420 6d65  etrics import me
-00085950: 616e 5f73 7175 6172 6564 5f65 7272 6f72  an_squared_error
-00085960: 2c6d 6564 6961 6e5f 6162 736f 6c75 7465  ,median_absolute
-00085970: 5f65 7272 6f72 2c6d 6561 6e5f 6162 736f  _error,mean_abso
-00085980: 6c75 7465 5f65 7272 6f72 0d0a 6672 6f6d  lute_error..from
-00085990: 2073 6b6c 6561 726e 2e6d 6574 7269 6373   sklearn.metrics
-000859a0: 2069 6d70 6f72 7420 636c 6173 7369 6669   import classifi
-000859b0: 6361 7469 6f6e 5f72 6570 6f72 742c 2063  cation_report, c
-000859c0: 6f6e 6675 7369 6f6e 5f6d 6174 7269 782c  onfusion_matrix,
-000859d0: 6d65 616e 5f73 7175 6172 6564 5f6c 6f67  mean_squared_log
-000859e0: 5f65 7272 6f72 0d0a 6672 6f6d 2073 6b6c  _error..from skl
-000859f0: 6561 726e 2e6d 6574 7269 6373 2069 6d70  earn.metrics imp
-00085a00: 6f72 7420 7072 6563 6973 696f 6e5f 7265  ort precision_re
-00085a10: 6361 6c6c 5f63 7572 7665 0d0a 6672 6f6d  call_curve..from
-00085a20: 2073 6b6c 6561 726e 2e6d 6f64 656c 5f73   sklearn.model_s
-00085a30: 656c 6563 7469 6f6e 2069 6d70 6f72 7420  election import 
-00085a40: 6372 6f73 735f 7661 6c5f 7363 6f72 652c  cross_val_score,
-00085a50: 2053 7472 6174 6966 6965 644b 466f 6c64   StratifiedKFold
-00085a60: 2c20 4b46 6f6c 640d 0a66 726f 6d20 736b  , KFold..from sk
-00085a70: 6c65 6172 6e2e 6d65 7472 6963 7320 696d  learn.metrics im
-00085a80: 706f 7274 206d 616b 655f 7363 6f72 6572  port make_scorer
-00085a90: 0d0a 6672 6f6d 2073 6b6c 6561 726e 2e6d  ..from sklearn.m
-00085aa0: 6574 7269 6373 2069 6d70 6f72 7420 6163  etrics import ac
-00085ab0: 6375 7261 6379 5f73 636f 7265 0d0a 6672  curacy_score..fr
-00085ac0: 6f6d 2073 6b6c 6561 726e 2e6d 6574 7269  om sklearn.metri
-00085ad0: 6373 2069 6d70 6f72 7420 6176 6572 6167  cs import averag
-00085ae0: 655f 7072 6563 6973 696f 6e5f 7363 6f72  e_precision_scor
-00085af0: 650d 0a66 726f 6d20 736b 6c65 6172 6e2e  e..from sklearn.
-00085b00: 6d65 7472 6963 7320 696d 706f 7274 2066  metrics import f
-00085b10: 315f 7363 6f72 650d 0a66 726f 6d20 736b  1_score..from sk
-00085b20: 6c65 6172 6e2e 6d65 7472 6963 7320 696d  learn.metrics im
-00085b30: 706f 7274 206c 6f67 5f6c 6f73 730d 0a66  port log_loss..f
-00085b40: 726f 6d20 736b 6c65 6172 6e2e 6d65 7472  rom sklearn.metr
-00085b50: 6963 7320 696d 706f 7274 2070 7265 6369  ics import preci
-00085b60: 7369 6f6e 5f73 636f 7265 0d0a 6672 6f6d  sion_score..from
-00085b70: 2073 6b6c 6561 726e 2e6d 6574 7269 6373   sklearn.metrics
-00085b80: 2069 6d70 6f72 7420 7265 6361 6c6c 5f73   import recall_s
-00085b90: 636f 7265 0d0a 6672 6f6d 2073 6b6c 6561  core..from sklea
-00085ba0: 726e 2e6d 6574 7269 6373 2069 6d70 6f72  rn.metrics impor
-00085bb0: 7420 726f 635f 6175 635f 7363 6f72 650d  t roc_auc_score.
-00085bc0: 0a66 726f 6d20 736b 6c65 6172 6e2e 6d65  .from sklearn.me
-00085bd0: 7472 6963 7320 696d 706f 7274 2066 6265  trics import fbe
-00085be0: 7461 5f73 636f 7265 0d0a 2323 2323 2323  ta_score..######
-00085bf0: 2323 2323 2323 2323 2323 2323 2323 2323  ################
-00085c00: 2323 2323 2323 2323 2323 2323 2323 2323  ################
-00085c10: 2323 2323 2323 2323 2323 2323 2323 2323  ################
-00085c20: 2323 2323 2323 2323 2323 2323 2323 2323  ################
-00085c30: 2323 2323 2323 2323 2323 2323 2323 230d  ###############.
-00085c40: 0a66 726f 6d20 736b 6c65 6172 6e2e 6d65  .from sklearn.me
-00085c50: 7472 6963 7320 696d 706f 7274 2063 6f6e  trics import con
-00085c60: 6675 7369 6f6e 5f6d 6174 7269 780d 0a64  fusion_matrix..d
-00085c70: 6566 2062 616c 616e 6365 645f 6163 6375  ef balanced_accu
-00085c80: 7261 6379 5f73 636f 7265 2879 5f74 7275  racy_score(y_tru
-00085c90: 652c 2079 5f70 7265 642c 2073 616d 706c  e, y_pred, sampl
-00085ca0: 655f 7765 6967 6874 3d4e 6f6e 652c 0d0a  e_weight=None,..
-00085cb0: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00085cc0: 2020 2020 2020 2020 2020 2020 6164 6a75              adju
-00085cd0: 7374 6564 3d46 616c 7365 293a 0d0a 2020  sted=False):..  
-00085ce0: 2020 4320 3d20 636f 6e66 7573 696f 6e5f    C = confusion_
-00085cf0: 6d61 7472 6978 2879 5f74 7275 652c 2079  matrix(y_true, y
-00085d00: 5f70 7265 642c 2073 616d 706c 655f 7765  _pred, sample_we
-00085d10: 6967 6874 3d73 616d 706c 655f 7765 6967  ight=sample_weig
-00085d20: 6874 290d 0a20 2020 2077 6974 6820 6e70  ht)..    with np
-00085d30: 2e65 7272 7374 6174 6528 6469 7669 6465  .errstate(divide
-00085d40: 3d27 6967 6e6f 7265 272c 2069 6e76 616c  ='ignore', inval
-00085d50: 6964 3d27 6967 6e6f 7265 2729 3a0d 0a20  id='ignore'):.. 
-00085d60: 2020 2020 2020 2070 6572 5f63 6c61 7373         per_class
-00085d70: 203d 206e 702e 6469 6167 2843 2920 2f20   = np.diag(C) / 
-00085d80: 432e 7375 6d28 6178 6973 3d31 290d 0a20  C.sum(axis=1).. 
-00085d90: 2020 2069 6620 6e70 2e61 6e79 286e 702e     if np.any(np.
-00085da0: 6973 6e61 6e28 7065 725f 636c 6173 7329  isnan(per_class)
-00085db0: 293a 0d0a 2020 2020 2020 2020 7761 726e  ):..        warn
-00085dc0: 696e 6773 2e77 6172 6e28 2779 5f70 7265  ings.warn('y_pre
-00085dd0: 6420 636f 6e74 6169 6e73 2063 6c61 7373  d contains class
-00085de0: 6573 206e 6f74 2069 6e20 795f 7472 7565  es not in y_true
-00085df0: 2729 0d0a 2020 2020 2020 2020 7065 725f  ')..        per_
-00085e00: 636c 6173 7320 3d20 7065 725f 636c 6173  class = per_clas
-00085e10: 735b 7e6e 702e 6973 6e61 6e28 7065 725f  s[~np.isnan(per_
-00085e20: 636c 6173 7329 5d0d 0a20 2020 2073 636f  class)]..    sco
-00085e30: 7265 203d 206e 702e 6d65 616e 2870 6572  re = np.mean(per
-00085e40: 5f63 6c61 7373 290d 0a20 2020 2069 6620  _class)..    if 
-00085e50: 6164 6a75 7374 6564 3a0d 0a20 2020 2020  adjusted:..     
-00085e60: 2020 206e 5f63 6c61 7373 6573 203d 206c     n_classes = l
-00085e70: 656e 2870 6572 5f63 6c61 7373 290d 0a20  en(per_class).. 
-00085e80: 2020 2020 2020 2063 6861 6e63 6520 3d20         chance = 
-00085e90: 3120 2f20 6e5f 636c 6173 7365 730d 0a20  1 / n_classes.. 
-00085ea0: 2020 2020 2020 2073 636f 7265 202d 3d20         score -= 
-00085eb0: 6368 616e 6365 0d0a 2020 2020 2020 2020  chance..        
-00085ec0: 7363 6f72 6520 2f3d 2031 202d 2063 6861  score /= 1 - cha
-00085ed0: 6e63 650d 0a20 2020 2072 6574 7572 6e20  nce..    return 
-00085ee0: 7363 6f72 650d 0a23 2323 2323 2323 2323  score..#########
-00085ef0: 2323 2323 2323 2323 2323 2323 2323 2323  ################
-00085f00: 2323 2323 2323 2323 2323 2323 2323 2323  ################
-00085f10: 2323 2323 2323 2323 2323 2323 2323 2323  ################
-00085f20: 2323 2323 2323 2323 2323 2323 2323 2323  ################
-00085f30: 2323 2323 2323 2323 2323 2323 0d0a 6465  ############..de
-00085f40: 6620 6163 6375 2872 6573 756c 7473 2c20  f accu(results, 
-00085f50: 795f 6376 293a 0d0a 2020 2020 7265 7475  y_cv):..    retu
-00085f60: 726e 2028 7265 7375 6c74 733d 3d79 5f63  rn (results==y_c
-00085f70: 7629 2e61 7374 7970 6528 696e 7429 2e73  v).astype(int).s
-00085f80: 756d 2861 7869 733d 3029 2f28 795f 6376  um(axis=0)/(y_cv
-00085f90: 2e73 6861 7065 5b30 5d29 0d0a 6465 6620  .shape[0])..def 
-00085fa0: 726d 7365 2872 6573 756c 7473 2c20 795f  rmse(results, y_
-00085fb0: 6376 293a 0d0a 2020 2020 7265 7475 726e  cv):..    return
-00085fc0: 206e 702e 7371 7274 286e 702e 6d65 616e   np.sqrt(np.mean
-00085fd0: 2828 7265 7375 6c74 7320 2d20 795f 6376  ((results - y_cv
-00085fe0: 292a 2a32 2c20 6178 6973 3d30 2929 0d0a  )**2, axis=0))..
-00085ff0: 2323 2323 2323 2323 2044 6566 696e 696e  ######## Definin
-00086000: 6720 6f62 6a65 6374 6976 6520 6675 6e63  g objective func
-00086010: 7469 6f6e 7320 666f 7220 4879 7065 724f  tions for HyperO
-00086020: 7074 2068 6572 6520 2323 2323 2323 2323  pt here ########
-00086030: 2323 2323 2323 2323 2323 2323 2323 0d0a  ##############..
-00086040: 6465 6620 6769 6e69 2874 7275 7468 2c20  def gini(truth, 
-00086050: 7072 6564 6963 7469 6f6e 7329 3a0d 0a20  predictions):.. 
-00086060: 2020 2067 203d 206e 702e 6173 6172 7261     g = np.asarra
-00086070: 7928 6e70 2e63 5f5b 7472 7574 682c 2070  y(np.c_[truth, p
-00086080: 7265 6469 6374 696f 6e73 2c20 6e70 2e61  redictions, np.a
-00086090: 7261 6e67 6528 6c65 6e28 7472 7574 6829  range(len(truth)
-000860a0: 2920 5d2c 2064 7479 7065 3d6e 702e 666c  ) ], dtype=np.fl
-000860b0: 6f61 7429 0d0a 2020 2020 6720 3d20 675b  oat)..    g = g[
-000860c0: 6e70 2e6c 6578 736f 7274 2828 675b 3a2c  np.lexsort((g[:,
-000860d0: 325d 2c20 2d31 2a67 5b3a 2c31 5d29 295d  2], -1*g[:,1]))]
-000860e0: 0d0a 2020 2020 6773 203d 2067 5b3a 2c30  ..    gs = g[:,0
-000860f0: 5d2e 6375 6d73 756d 2829 2e73 756d 2829  ].cumsum().sum()
-00086100: 202f 2067 5b3a 2c30 5d2e 7375 6d28 290d   / g[:,0].sum().
-00086110: 0a20 2020 2067 7320 2d3d 2028 6c65 6e28  .    gs -= (len(
-00086120: 7472 7574 6829 202b 2031 2920 2f20 322e  truth) + 1) / 2.
-00086130: 0d0a 2020 2020 7265 7475 726e 2067 7320  ..    return gs 
-00086140: 2f20 6c65 6e28 7472 7574 6829 0d0a 0d0a  / len(truth)....
-00086150: 6465 6620 6769 6e69 5f73 6b6c 6561 726e  def gini_sklearn
-00086160: 2874 7275 7468 2c20 7072 6564 6963 7469  (truth, predicti
-00086170: 6f6e 7329 3a0d 0a20 2020 2072 6574 7572  ons):..    retur
-00086180: 6e20 6769 6e69 2874 7275 7468 2c20 7072  n gini(truth, pr
-00086190: 6564 6963 7469 6f6e 7329 202f 2067 696e  edictions) / gin
-000861a0: 6928 7472 7574 682c 2074 7275 7468 290d  i(truth, truth).
-000861b0: 0a0d 0a64 6566 2067 696e 695f 6d65 6165  ...def gini_meae
-000861c0: 2874 7275 7468 2c20 7072 6564 6963 7469  (truth, predicti
-000861d0: 6f6e 7329 3a0d 0a20 2020 2073 636f 7265  ons):..    score
-000861e0: 203d 206d 6564 6961 6e5f 6162 736f 6c75   = median_absolu
-000861f0: 7465 5f65 7272 6f72 2874 7275 7468 2c20  te_error(truth, 
-00086200: 7072 6564 6963 7469 6f6e 7329 0d0a 2020  predictions)..  
-00086210: 2020 7265 7475 726e 2073 636f 7265 0d0a    return score..
-00086220: 0d0a 6465 6620 6769 6e69 5f6d 736c 6528  ..def gini_msle(
-00086230: 7472 7574 682c 2070 7265 6469 6374 696f  truth, predictio
-00086240: 6e73 293a 0d0a 2020 2020 7363 6f72 6520  ns):..    score 
-00086250: 3d20 6d65 616e 5f73 7175 6172 6564 5f6c  = mean_squared_l
-00086260: 6f67 5f65 7272 6f72 2874 7275 7468 2c20  og_error(truth, 
-00086270: 7072 6564 6963 7469 6f6e 7329 0d0a 2020  predictions)..  
-00086280: 2020 7265 7475 726e 2073 636f 7265 0d0a    return score..
-00086290: 0d0a 6465 6620 6769 6e69 5f6d 6165 2874  ..def gini_mae(t
-000862a0: 7275 7468 2c20 7072 6564 6963 7469 6f6e  ruth, prediction
-000862b0: 7329 3a0d 0a20 2020 2073 636f 7265 203d  s):..    score =
-000862c0: 206d 6561 6e5f 6162 736f 6c75 7465 5f65   mean_absolute_e
-000862d0: 7272 6f72 2874 7275 7468 2c20 7072 6564  rror(truth, pred
-000862e0: 6963 7469 6f6e 7329 0d0a 2020 2020 7265  ictions)..    re
-000862f0: 7475 726e 2073 636f 7265 0d0a 0d0a 6465  turn score....de
-00086300: 6620 6769 6e69 5f6d 7365 2874 7275 7468  f gini_mse(truth
-00086310: 2c20 7072 6564 6963 7469 6f6e 7329 3a0d  , predictions):.
-00086320: 0a20 2020 2073 636f 7265 203d 206d 6561  .    score = mea
-00086330: 6e5f 7371 7561 7265 645f 6572 726f 7228  n_squared_error(
-00086340: 7472 7574 682c 2070 7265 6469 6374 696f  truth, predictio
-00086350: 6e73 290d 0a20 2020 2072 6574 7572 6e20  ns)..    return 
-00086360: 7363 6f72 650d 0a0d 0a64 6566 2067 696e  score....def gin
-00086370: 695f 726d 7365 2874 7275 7468 2c20 7072  i_rmse(truth, pr
-00086380: 6564 6963 7469 6f6e 7329 3a0d 0a20 2020  edictions):..   
-00086390: 2073 636f 7265 203d 206e 702e 7371 7274   score = np.sqrt
-000863a0: 286d 6561 6e5f 7371 7561 7265 645f 6572  (mean_squared_er
-000863b0: 726f 7228 7472 7574 682c 2070 7265 6469  ror(truth, predi
-000863c0: 6374 696f 6e73 2929 0d0a 2020 2020 7265  ctions))..    re
-000863d0: 7475 726e 2073 636f 7265 0d0a 0d0a 6465  turn score....de
-000863e0: 6620 6769 6e69 5f61 6363 7572 6163 7928  f gini_accuracy(
-000863f0: 7472 7574 682c 2070 7265 6469 6374 696f  truth, predictio
-00086400: 6e73 293a 0d0a 2020 2020 7265 7475 726e  ns):..    return
-00086410: 2061 6363 7572 6163 795f 7363 6f72 6528   accuracy_score(
-00086420: 7472 7574 682c 2070 7265 6469 6374 696f  truth, predictio
-00086430: 6e73 290d 0a0d 0a64 6566 2067 696e 695f  ns)....def gini_
-00086440: 6261 6c5f 6163 6375 7261 6379 2874 7275  bal_accuracy(tru
-00086450: 7468 2c20 7072 6564 6963 7469 6f6e 7329  th, predictions)
-00086460: 3a0d 0a20 2020 2072 6574 7572 6e20 6261  :..    return ba
-00086470: 6c61 6e63 6564 5f61 6363 7572 6163 795f  lanced_accuracy_
-00086480: 7363 6f72 6528 7472 7574 682c 2070 7265  score(truth, pre
-00086490: 6469 6374 696f 6e73 290d 0a0d 0a64 6566  dictions)....def
-000864a0: 2067 696e 695f 726f 6328 7472 7574 682c   gini_roc(truth,
-000864b0: 2070 7265 6469 6374 696f 6e73 293a 0d0a   predictions):..
-000864c0: 2020 2020 7265 7475 726e 2072 6f63 5f61      return roc_a
-000864d0: 7563 5f73 636f 7265 2874 7275 7468 2c20  uc_score(truth, 
-000864e0: 7072 6564 6963 7469 6f6e 7329 0d0a 0d0a  predictions)....
-000864f0: 6465 6620 6769 6e69 5f70 7265 6369 7369  def gini_precisi
-00086500: 6f6e 2874 7275 7468 2c20 7072 6564 6963  on(truth, predic
-00086510: 7469 6f6e 732c 706f 735f 6c61 6265 6c3d  tions,pos_label=
-00086520: 3129 3a0d 0a20 2020 2072 6574 7572 6e20  1):..    return 
-00086530: 7072 6563 6973 696f 6e5f 7363 6f72 6528  precision_score(
-00086540: 7472 7574 682c 2070 7265 6469 6374 696f  truth, predictio
-00086550: 6e73 2c61 7665 7261 6765 3d4e 6f6e 6529  ns,average=None)
-00086560: 5b70 6f73 5f6c 6162 656c 5d0d 0a0d 0a64  [pos_label]....d
-00086570: 6566 2067 696e 695f 6176 6572 6167 655f  ef gini_average_
-00086580: 7072 6563 6973 696f 6e28 7472 7574 682c  precision(truth,
-00086590: 2070 7265 6469 6374 696f 6e73 293a 0d0a   predictions):..
-000865a0: 2020 2020 7265 7475 726e 2070 7265 6369      return preci
-000865b0: 7369 6f6e 5f73 636f 7265 2874 7275 7468  sion_score(truth
-000865c0: 2c20 7072 6564 6963 7469 6f6e 732e 6172  , predictions.ar
-000865d0: 676d 6178 2861 7869 733d 3129 2c61 7665  gmax(axis=1),ave
-000865e0: 7261 6765 3d27 6d61 6372 6f27 290d 0a0d  rage='macro')...
-000865f0: 0a64 6566 2067 696e 695f 7765 6967 6874  .def gini_weight
-00086600: 6564 5f70 7265 6369 7369 6f6e 2874 7275  ed_precision(tru
-00086610: 7468 2c20 7072 6564 6963 7469 6f6e 7329  th, predictions)
-00086620: 3a0d 0a20 2020 2072 6574 7572 6e20 7072  :..    return pr
-00086630: 6563 6973 696f 6e5f 7363 6f72 6528 7472  ecision_score(tr
-00086640: 7574 682c 2070 7265 6469 6374 696f 6e73  uth, predictions
-00086650: 2e61 7267 6d61 7828 6178 6973 3d31 292c  .argmax(axis=1),
-00086660: 6176 6572 6167 653d 2777 6569 6768 7465  average='weighte
-00086670: 6427 290d 0a0d 0a64 6566 2067 696e 695f  d')....def gini_
-00086680: 6d61 6372 6f5f 7072 6563 6973 696f 6e28  macro_precision(
-00086690: 7472 7574 682c 2070 7265 6469 6374 696f  truth, predictio
-000866a0: 6e73 293a 0d0a 2020 2020 7265 7475 726e  ns):..    return
-000866b0: 2070 7265 6369 7369 6f6e 5f73 636f 7265   precision_score
-000866c0: 2874 7275 7468 2c20 7072 6564 6963 7469  (truth, predicti
-000866d0: 6f6e 732e 6172 676d 6178 2861 7869 733d  ons.argmax(axis=
-000866e0: 3129 2c61 7665 7261 6765 3d27 6d61 6372  1),average='macr
-000866f0: 6f27 290d 0a0d 0a64 6566 2067 696e 695f  o')....def gini_
-00086700: 6d69 6372 6f5f 7072 6563 6973 696f 6e28  micro_precision(
-00086710: 7472 7574 682c 2070 7265 6469 6374 696f  truth, predictio
-00086720: 6e73 293a 0d0a 2020 2020 7265 7475 726e  ns):..    return
-00086730: 2070 7265 6369 7369 6f6e 5f73 636f 7265   precision_score
-00086740: 2874 7275 7468 2c20 7072 6564 6963 7469  (truth, predicti
-00086750: 6f6e 732e 6172 676d 6178 2861 7869 733d  ons.argmax(axis=
-00086760: 3129 2c61 7665 7261 6765 3d27 6d69 6372  1),average='micr
-00086770: 6f27 290d 0a0d 0a64 6566 2067 696e 695f  o')....def gini_
-00086780: 7361 6d70 6c65 735f 7072 6563 6973 696f  samples_precisio
-00086790: 6e28 7472 7574 682c 2070 7265 6469 6374  n(truth, predict
-000867a0: 696f 6e73 293a 0d0a 2020 2020 7265 7475  ions):..    retu
-000867b0: 726e 2070 7265 6369 7369 6f6e 5f73 636f  rn precision_sco
-000867c0: 7265 2874 7275 7468 2c20 7072 6564 6963  re(truth, predic
-000867d0: 7469 6f6e 732e 6172 676d 6178 2861 7869  tions.argmax(axi
-000867e0: 733d 3129 2c61 7665 7261 6765 3d27 7361  s=1),average='sa
-000867f0: 6d70 6c65 7327 290d 0a0d 0a64 6566 2067  mples')....def g
-00086800: 696e 695f 6631 2874 7275 7468 2c20 7072  ini_f1(truth, pr
-00086810: 6564 6963 7469 6f6e 732c 706f 735f 6c61  edictions,pos_la
-00086820: 6265 6c3d 3129 3a0d 0a20 2020 2072 6574  bel=1):..    ret
-00086830: 7572 6e20 6631 5f73 636f 7265 2874 7275  urn f1_score(tru
-00086840: 7468 2c20 7072 6564 6963 7469 6f6e 732c  th, predictions,
-00086850: 6176 6572 6167 653d 4e6f 6e65 295b 706f  average=None)[po
-00086860: 735f 6c61 6265 6c5d 0d0a 0d0a 6465 6620  s_label]....def 
-00086870: 6769 6e69 5f77 6569 6768 7465 645f 6631  gini_weighted_f1
-00086880: 2874 7275 7468 2c20 7072 6564 6963 7469  (truth, predicti
-00086890: 6f6e 7329 3a0d 0a20 2020 2072 6574 7572  ons):..    retur
-000868a0: 6e20 6631 5f73 636f 7265 2874 7275 7468  n f1_score(truth
-000868b0: 2c20 7072 6564 6963 7469 6f6e 732e 6172  , predictions.ar
-000868c0: 676d 6178 2861 7869 733d 3129 2c61 7665  gmax(axis=1),ave
-000868d0: 7261 6765 3d27 7765 6967 6874 6564 2729  rage='weighted')
-000868e0: 0d0a 0d0a 6465 6620 6769 6e69 5f6d 6163  ....def gini_mac
-000868f0: 726f 5f66 3128 7472 7574 682c 2070 7265  ro_f1(truth, pre
-00086900: 6469 6374 696f 6e73 293a 0d0a 2020 2020  dictions):..    
-00086910: 7265 7475 726e 2066 315f 7363 6f72 6528  return f1_score(
-00086920: 7472 7574 682c 2070 7265 6469 6374 696f  truth, predictio
-00086930: 6e73 2e61 7267 6d61 7828 6178 6973 3d31  ns.argmax(axis=1
-00086940: 292c 6176 6572 6167 653d 276d 6163 726f  ),average='macro
-00086950: 2729 0d0a 0d0a 6465 6620 6769 6e69 5f6d  ')....def gini_m
-00086960: 6963 726f 5f66 3128 7472 7574 682c 2070  icro_f1(truth, p
-00086970: 7265 6469 6374 696f 6e73 293a 0d0a 2020  redictions):..  
-00086980: 2020 7265 7475 726e 2066 315f 7363 6f72    return f1_scor
-00086990: 6528 7472 7574 682c 2070 7265 6469 6374  e(truth, predict
-000869a0: 696f 6e73 2e61 7267 6d61 7828 6178 6973  ions.argmax(axis
-000869b0: 3d31 292c 6176 6572 6167 653d 276d 6963  =1),average='mic
-000869c0: 726f 2729 0d0a 0d0a 6465 6620 6769 6e69  ro')....def gini
-000869d0: 5f73 616d 706c 6573 5f66 3128 7472 7574  _samples_f1(trut
-000869e0: 682c 2070 7265 6469 6374 696f 6e73 293a  h, predictions):
-000869f0: 0d0a 2020 2020 7265 7475 726e 2066 315f  ..    return f1_
-00086a00: 7363 6f72 6528 7472 7574 682c 2070 7265  score(truth, pre
-00086a10: 6469 6374 696f 6e73 2e61 7267 6d61 7828  dictions.argmax(
-00086a20: 6178 6973 3d31 292c 6176 6572 6167 653d  axis=1),average=
-00086a30: 2773 616d 706c 6573 2729 0d0a 0d0a 6465  'samples')....de
-00086a40: 6620 6769 6e69 5f6c 6f67 5f6c 6f73 7328  f gini_log_loss(
-00086a50: 7472 7574 682c 2070 7265 6469 6374 696f  truth, predictio
-00086a60: 6e73 293a 0d0a 2020 2020 7265 7475 726e  ns):..    return
-00086a70: 206c 6f67 5f6c 6f73 7328 7472 7574 682c   log_loss(truth,
-00086a80: 2070 7265 6469 6374 696f 6e73 2c6e 6f72   predictions,nor
-00086a90: 6d61 6c69 7a65 3d54 7275 6529 0d0a 0d0a  malize=True)....
-00086aa0: 6465 6620 6769 6e69 5f72 6563 616c 6c28  def gini_recall(
-00086ab0: 7472 7574 682c 2070 7265 6469 6374 696f  truth, predictio
-00086ac0: 6e73 2c70 6f73 5f6c 6162 656c 3d31 293a  ns,pos_label=1):
-00086ad0: 0d0a 2020 2020 7265 7475 726e 2072 6563  ..    return rec
-00086ae0: 616c 6c5f 7363 6f72 6528 7472 7574 682c  all_score(truth,
-00086af0: 2070 7265 6469 6374 696f 6e73 2c61 7665   predictions,ave
-00086b00: 7261 6765 3d4e 6f6e 6529 5b70 6f73 5f6c  rage=None)[pos_l
-00086b10: 6162 656c 5d0d 0a0d 0a64 6566 2067 696e  abel]....def gin
-00086b20: 695f 7765 6967 6874 6564 5f72 6563 616c  i_weighted_recal
-00086b30: 6c28 7472 7574 682c 2070 7265 6469 6374  l(truth, predict
-00086b40: 696f 6e73 293a 0d0a 2020 2020 7265 7475  ions):..    retu
-00086b50: 726e 2072 6563 616c 6c5f 7363 6f72 6528  rn recall_score(
-00086b60: 7472 7574 682c 2070 7265 6469 6374 696f  truth, predictio
-00086b70: 6e73 2e61 7267 6d61 7828 6178 6973 3d31  ns.argmax(axis=1
-00086b80: 292c 6176 6572 6167 653d 2777 6569 6768  ),average='weigh
-00086b90: 7465 6427 290d 0a0d 0a64 6566 2067 696e  ted')....def gin
-00086ba0: 695f 7361 6d70 6c65 735f 7265 6361 6c6c  i_samples_recall
-00086bb0: 2874 7275 7468 2c20 7072 6564 6963 7469  (truth, predicti
-00086bc0: 6f6e 7329 3a0d 0a20 2020 2072 6574 7572  ons):..    retur
-00086bd0: 6e20 7265 6361 6c6c 5f73 636f 7265 2874  n recall_score(t
-00086be0: 7275 7468 2c20 7072 6564 6963 7469 6f6e  ruth, prediction
-00086bf0: 732e 6172 676d 6178 2861 7869 733d 3129  s.argmax(axis=1)
-00086c00: 2c61 7665 7261 6765 3d27 7361 6d70 6c65  ,average='sample
-00086c10: 7327 290d 0a0d 0a64 6566 2067 696e 695f  s')....def gini_
-00086c20: 6d61 6372 6f5f 7265 6361 6c6c 2874 7275  macro_recall(tru
-00086c30: 7468 2c20 7072 6564 6963 7469 6f6e 7329  th, predictions)
-00086c40: 3a0d 0a20 2020 2072 6574 7572 6e20 7265  :..    return re
-00086c50: 6361 6c6c 5f73 636f 7265 2874 7275 7468  call_score(truth
-00086c60: 2c20 7072 6564 6963 7469 6f6e 732e 6172  , predictions.ar
-00086c70: 676d 6178 2861 7869 733d 3129 2c61 7665  gmax(axis=1),ave
-00086c80: 7261 6765 3d27 6d61 6372 6f27 290d 0a0d  rage='macro')...
-00086c90: 0a64 6566 2067 696e 695f 6d69 6372 6f5f  .def gini_micro_
-00086ca0: 7265 6361 6c6c 2874 7275 7468 2c20 7072  recall(truth, pr
-00086cb0: 6564 6963 7469 6f6e 7329 3a0d 0a20 2020  edictions):..   
-00086cc0: 2072 6574 7572 6e20 7265 6361 6c6c 5f73   return recall_s
-00086cd0: 636f 7265 2874 7275 7468 2c20 7072 6564  core(truth, pred
-00086ce0: 6963 7469 6f6e 732e 6172 676d 6178 2861  ictions.argmax(a
-00086cf0: 7869 733d 3129 2c61 7665 7261 6765 3d27  xis=1),average='
-00086d00: 6d69 6372 6f27 290d 0a0d 0a23 2063 616c  micro')....# cal
-00086d10: 6375 6c61 7465 2066 322d 6d65 6173 7572  culate f2-measur
-00086d20: 650d 0a64 6566 2066 325f 6d65 6173 7572  e..def f2_measur
-00086d30: 6528 795f 7472 7565 2c20 795f 7072 6564  e(y_true, y_pred
-00086d40: 293a 0d0a 2020 2020 7265 7475 726e 2066  ):..    return f
-00086d50: 6265 7461 5f73 636f 7265 2879 5f74 7275  beta_score(y_tru
-00086d60: 652c 2079 5f70 7265 642c 2062 6574 613d  e, y_pred, beta=
-00086d70: 3229 0d0a 0000 0000 0000 0000 0000 0000  2)..............
-00086d80: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-00086d90: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-00086da0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-00086db0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-00086dc0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-00086dd0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-00086de0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-00086df0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-00086e00: 2e2f 2e2f 4050 6178 4865 6164 6572 0000  ././@PaxHeader..
-00086e10: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-00086e20: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-00086e30: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-00086e40: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-00086e50: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-00086e60: 0000 0000 3030 3030 3030 3000 3030 3030  ....0000000.0000
-00086e70: 3030 3000 3030 3030 3030 3000 3030 3030  000.0000000.0000
-00086e80: 3030 3030 3032 3600 3030 3030 3030 3030  0000026.00000000
-00086e90: 3030 3000 3031 3134 3533 0020 7800 0000  000.011453. x...
-00086ea0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-00086eb0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-00086ec0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-00086ed0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-00086ee0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-00086ef0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-00086f00: 0075 7374 6172 0030 3000 0000 0000 0000  .ustar.00.......
-00086f10: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-00086f20: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-00086f30: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-00086f40: 0000 0000 0000 0000 0030 3030 3030 3030  .........0000000
-00086f50: 0030 3030 3030 3030 0000 0000 0000 0000  .0000000........
-00086f60: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-00086f70: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-00086f80: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-00086f90: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-00086fa0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-00086fb0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-00086fc0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-00086fd0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-00086fe0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-00086ff0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-00087000: 3232 206d 7469 6d65 3d31 3637 3831 3539  22 mtime=1678159
-00087010: 3732 322e 300a 0000 0000 0000 0000 0000  722.0...........
-00087020: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-00087030: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-00087040: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-00087050: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-00087060: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-00087070: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-00087080: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-00087090: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-000870a0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-000870b0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-000870c0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-000870d0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-000870e0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-000870f0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-00087100: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-00087110: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-00087120: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-00087130: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-00087140: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-00087150: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-00087160: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-00087170: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-00087180: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-00087190: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-000871a0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-000871b0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-000871c0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-000871d0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-000871e0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-000871f0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-00087200: 6175 746f 7669 6d6c 2d30 2e31 2e37 3134  autoviml-0.1.714
-00087210: 2f61 7574 6f76 696d 6c2f 6375 7374 6f6d  /autoviml/custom
-00087220: 5f73 636f 7265 735f 484f 2e70 7900 0000  _scores_HO.py...
-00087230: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-00087240: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-00087250: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-00087260: 0000 0000 3030 3030 3737 3700 3030 3031  ....0000777.0001
-00087270: 3735 3000 3030 3031 3735 3000 3030 3030  750.0001750.0000
-00087280: 3030 3230 3630 3500 3030 3030 3030 3030  0020605.00000000
-00087290: 3030 3000 3032 3036 3037 0020 3000 0000  000.020607. 0...
-000872a0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-000872b0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-000872c0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-000872d0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-000872e0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-000872f0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-00087300: 0075 7374 6172 0030 3072 616d 0000 0000  .ustar.00ram....
-00087310: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-00087320: 0000 0000 0000 0000 0072 616d 0000 0000  .........ram....
-00087330: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-00087340: 0000 0000 0000 0000 0030 3030 3030 3030  .........0000000
-00087350: 0030 3030 3030 3030 0000 0000 0000 0000  .0000000........
-00087360: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-00087370: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-00087380: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-00087390: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-000873a0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-000873b0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-000873c0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-000873d0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-000873e0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-000873f0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-00087400: 696d 706f 7274 206e 756d 7079 2061 7320  import numpy as 
-00087410: 6e70 0d0a 6672 6f6d 2073 6b6c 6561 726e  np..from sklearn
-00087420: 2069 6d70 6f72 7420 6d6f 6465 6c5f 7365   import model_se
-00087430: 6c65 6374 696f 6e0d 0a66 726f 6d20 736b  lection..from sk
-00087440: 6c65 6172 6e2e 6d65 7472 6963 7320 696d  learn.metrics im
-00087450: 706f 7274 2063 6f6e 6675 7369 6f6e 5f6d  port confusion_m
-00087460: 6174 7269 782c 206d 6561 6e5f 7371 7561  atrix, mean_squa
-00087470: 7265 645f 6572 726f 720d 0a66 726f 6d20  red_error..from 
-00087480: 736b 6c65 6172 6e20 696d 706f 7274 206d  sklearn import m
-00087490: 6574 7269 6373 0d0a 6672 6f6d 2073 6b6c  etrics..from skl
-000874a0: 6561 726e 2069 6d70 6f72 7420 6d6f 6465  earn import mode
-000874b0: 6c5f 7365 6c65 6374 696f 6e2c 206d 6574  l_selection, met
-000874c0: 7269 6373 2020 2023 4164 6469 7469 6f6e  rics   #Addition
-000874d0: 616c 2073 6b6c 6561 726e 2066 756e 6374  al sklearn funct
-000874e0: 696f 6e73 0d0a 6672 6f6d 2073 6b6c 6561  ions..from sklea
-000874f0: 726e 2e6d 6574 7269 6373 2069 6d70 6f72  rn.metrics impor
-00087500: 7420 6163 6375 7261 6379 5f73 636f 7265  t accuracy_score
-00087510: 2c66 315f 7363 6f72 652c 726f 635f 6175  ,f1_score,roc_au
-00087520: 635f 7363 6f72 652c 6c6f 675f 6c6f 7373  c_score,log_loss
-00087530: 0d0a 6672 6f6d 2073 6b6c 6561 726e 2e6d  ..from sklearn.m
-00087540: 6574 7269 6373 2069 6d70 6f72 7420 6d65  etrics import me
-00087550: 616e 5f73 7175 6172 6564 5f65 7272 6f72  an_squared_error
-00087560: 2c6d 6564 6961 6e5f 6162 736f 6c75 7465  ,median_absolute
-00087570: 5f65 7272 6f72 2c6d 6561 6e5f 6162 736f  _error,mean_abso
-00087580: 6c75 7465 5f65 7272 6f72 0d0a 6672 6f6d  lute_error..from
-00087590: 2073 6b6c 6561 726e 2e6d 6574 7269 6373   sklearn.metrics
-000875a0: 2069 6d70 6f72 7420 636c 6173 7369 6669   import classifi
-000875b0: 6361 7469 6f6e 5f72 6570 6f72 742c 2063  cation_report, c
-000875c0: 6f6e 6675 7369 6f6e 5f6d 6174 7269 782c  onfusion_matrix,
-000875d0: 6d65 616e 5f73 7175 6172 6564 5f6c 6f67  mean_squared_log
-000875e0: 5f65 7272 6f72 0d0a 6672 6f6d 2073 6b6c  _error..from skl
-000875f0: 6561 726e 2e6d 6574 7269 6373 2069 6d70  earn.metrics imp
-00087600: 6f72 7420 7072 6563 6973 696f 6e5f 7265  ort precision_re
-00087610: 6361 6c6c 5f63 7572 7665 0d0a 6672 6f6d  call_curve..from
-00087620: 2073 6b6c 6561 726e 2e6d 6f64 656c 5f73   sklearn.model_s
-00087630: 656c 6563 7469 6f6e 2069 6d70 6f72 7420  election import 
-00087640: 6372 6f73 735f 7661 6c5f 7363 6f72 652c  cross_val_score,
-00087650: 2053 7472 6174 6966 6965 644b 466f 6c64   StratifiedKFold
-00087660: 2c20 4b46 6f6c 640d 0a66 726f 6d20 736b  , KFold..from sk
-00087670: 6c65 6172 6e2e 6d65 7472 6963 7320 696d  learn.metrics im
-00087680: 706f 7274 206d 616b 655f 7363 6f72 6572  port make_scorer
-00087690: 0d0a 6672 6f6d 2073 6b6c 6561 726e 2e6d  ..from sklearn.m
-000876a0: 6574 7269 6373 2069 6d70 6f72 7420 6163  etrics import ac
-000876b0: 6375 7261 6379 5f73 636f 7265 2020 200d  curacy_score   .
-000876c0: 0a66 726f 6d20 736b 6c65 6172 6e2e 6d65  .from sklearn.me
-000876d0: 7472 6963 7320 696d 706f 7274 2061 7665  trics import ave
-000876e0: 7261 6765 5f70 7265 6369 7369 6f6e 5f73  rage_precision_s
-000876f0: 636f 7265 0d0a 6672 6f6d 2073 6b6c 6561  core..from sklea
-00087700: 726e 2e6d 6574 7269 6373 2069 6d70 6f72  rn.metrics impor
-00087710: 7420 6631 5f73 636f 7265 0d0a 6672 6f6d  t f1_score..from
-00087720: 2073 6b6c 6561 726e 2e6d 6574 7269 6373   sklearn.metrics
-00087730: 2069 6d70 6f72 7420 6c6f 675f 6c6f 7373   import log_loss
-00087740: 0d0a 6672 6f6d 2073 6b6c 6561 726e 2e6d  ..from sklearn.m
-00087750: 6574 7269 6373 2069 6d70 6f72 7420 7072  etrics import pr
-00087760: 6563 6973 696f 6e5f 7363 6f72 650d 0a66  ecision_score..f
-00087770: 726f 6d20 736b 6c65 6172 6e2e 6d65 7472  rom sklearn.metr
-00087780: 6963 7320 696d 706f 7274 2072 6563 616c  ics import recal
-00087790: 6c5f 7363 6f72 650d 0a66 726f 6d20 736b  l_score..from sk
-000877a0: 6c65 6172 6e2e 6d65 7472 6963 7320 696d  learn.metrics im
-000877b0: 706f 7274 2072 6f63 5f61 7563 5f73 636f  port roc_auc_sco
-000877c0: 7265 0d0a 6672 6f6d 2073 6b6c 6561 726e  re..from sklearn
-000877d0: 2e6d 6574 7269 6373 2069 6d70 6f72 7420  .metrics import 
-000877e0: 6662 6574 615f 7363 6f72 650d 0a23 2323  fbeta_score..###
-000877f0: 2323 2323 2323 2323 2323 2323 2323 2323  ################
-00087800: 2323 2323 2323 2323 2323 2323 2323 2323  ################
-00087810: 2323 2323 2323 2323 2323 2323 2323 2323  ################
-00087820: 2323 2323 2323 2323 2323 2323 2323 2323  ################
-00087830: 2323 2323 2323 2323 2323 2323 2323 2323  ################
-00087840: 2323 0d0a 6672 6f6d 2073 6b6c 6561 726e  ##..from sklearn
-00087850: 2e6d 6574 7269 6373 2069 6d70 6f72 7420  .metrics import 
-00087860: 636f 6e66 7573 696f 6e5f 6d61 7472 6978  confusion_matrix
-00087870: 0d0a 6465 6620 6261 6c61 6e63 6564 5f61  ..def balanced_a
-00087880: 6363 7572 6163 795f 7363 6f72 6528 795f  ccuracy_score(y_
-00087890: 7472 7565 2c20 795f 7072 6564 2c20 7361  true, y_pred, sa
-000878a0: 6d70 6c65 5f77 6569 6768 743d 4e6f 6e65  mple_weight=None
-000878b0: 2c0d 0a20 2020 2020 2020 2020 2020 2020  ,..             
-000878c0: 2020 2020 2020 2020 2020 2020 2020 2061                 a
-000878d0: 646a 7573 7465 643d 4661 6c73 6529 3a0d  djusted=False):.
-000878e0: 0a20 2020 2043 203d 2063 6f6e 6675 7369  .    C = confusi
-000878f0: 6f6e 5f6d 6174 7269 7828 795f 7472 7565  on_matrix(y_true
-00087900: 2c20 795f 7072 6564 2c20 7361 6d70 6c65  , y_pred, sample
-00087910: 5f77 6569 6768 743d 7361 6d70 6c65 5f77  _weight=sample_w
-00087920: 6569 6768 7429 0d0a 2020 2020 7769 7468  eight)..    with
-00087930: 206e 702e 6572 7273 7461 7465 2864 6976   np.errstate(div
-00087940: 6964 653d 2769 676e 6f72 6527 2c20 696e  ide='ignore', in
-00087950: 7661 6c69 643d 2769 676e 6f72 6527 293a  valid='ignore'):
-00087960: 0d0a 2020 2020 2020 2020 7065 725f 636c  ..        per_cl
-00087970: 6173 7320 3d20 6e70 2e64 6961 6728 4329  ass = np.diag(C)
-00087980: 202f 2043 2e73 756d 2861 7869 733d 3129   / C.sum(axis=1)
-00087990: 0d0a 2020 2020 6966 206e 702e 616e 7928  ..    if np.any(
-000879a0: 6e70 2e69 736e 616e 2870 6572 5f63 6c61  np.isnan(per_cla
-000879b0: 7373 2929 3a0d 0a20 2020 2020 2020 2077  ss)):..        w
-000879c0: 6172 6e69 6e67 732e 7761 726e 2827 795f  arnings.warn('y_
-000879d0: 7072 6564 2063 6f6e 7461 696e 7320 636c  pred contains cl
-000879e0: 6173 7365 7320 6e6f 7420 696e 2079 5f74  asses not in y_t
-000879f0: 7275 6527 290d 0a20 2020 2020 2020 2070  rue')..        p
-00087a00: 6572 5f63 6c61 7373 203d 2070 6572 5f63  er_class = per_c
-00087a10: 6c61 7373 5b7e 6e70 2e69 736e 616e 2870  lass[~np.isnan(p
-00087a20: 6572 5f63 6c61 7373 295d 0d0a 2020 2020  er_class)]..    
-00087a30: 7363 6f72 6520 3d20 6e70 2e6d 6561 6e28  score = np.mean(
-00087a40: 7065 725f 636c 6173 7329 0d0a 2020 2020  per_class)..    
-00087a50: 6966 2061 646a 7573 7465 643a 0d0a 2020  if adjusted:..  
-00087a60: 2020 2020 2020 6e5f 636c 6173 7365 7320        n_classes 
-00087a70: 3d20 6c65 6e28 7065 725f 636c 6173 7329  = len(per_class)
-00087a80: 0d0a 2020 2020 2020 2020 6368 616e 6365  ..        chance
-00087a90: 203d 2031 202f 206e 5f63 6c61 7373 6573   = 1 / n_classes
-00087aa0: 0d0a 2020 2020 2020 2020 7363 6f72 6520  ..        score 
-00087ab0: 2d3d 2063 6861 6e63 650d 0a20 2020 2020  -= chance..     
-00087ac0: 2020 2073 636f 7265 202f 3d20 3120 2d20     score /= 1 - 
-00087ad0: 6368 616e 6365 0d0a 2020 2020 7265 7475  chance..    retu
-00087ae0: 726e 2073 636f 7265 0d0a 2323 2323 2323  rn score..######
-00087af0: 2323 2323 2323 2323 2323 2323 2323 2323  ################
-00087b00: 2323 2323 2323 2323 2323 2323 2323 2323  ################
-00087b10: 2323 2323 2323 2323 2323 2323 2323 2323  ################
-00087b20: 2323 2323 2323 2323 2323 2323 2323 2323  ################
-00087b30: 2323 2323 2323 2323 2323 2323 2323 230d  ###############.
-00087b40: 0a64 6566 2061 6363 7528 7265 7375 6c74  .def accu(result
-00087b50: 732c 2079 5f63 7629 3a0d 0a20 2020 2072  s, y_cv):..    r
-00087b60: 6574 7572 6e20 2872 6573 756c 7473 3d3d  eturn (results==
-00087b70: 795f 6376 292e 6173 7479 7065 2869 6e74  y_cv).astype(int
-00087b80: 292e 7375 6d28 6178 6973 3d30 292f 2879  ).sum(axis=0)/(y
-00087b90: 5f63 762e 7368 6170 655b 305d 290d 0a64  _cv.shape[0])..d
-00087ba0: 6566 2072 6d73 6528 7265 7375 6c74 732c  ef rmse(results,
-00087bb0: 2079 5f63 7629 3a0d 0a20 2020 2072 6574   y_cv):..    ret
-00087bc0: 7572 6e20 6e70 2e73 7172 7428 6e70 2e6d  urn np.sqrt(np.m
-00087bd0: 6561 6e28 2872 6573 756c 7473 202d 2079  ean((results - y
-00087be0: 5f63 7629 2a2a 322c 2061 7869 733d 3029  _cv)**2, axis=0)
-00087bf0: 290d 0a23 2323 2323 2323 2320 4465 6669  )..######## Defi
-00087c00: 6e69 6e67 206f 626a 6563 7469 7665 2066  ning objective f
-00087c10: 756e 6374 696f 6e73 2066 6f72 2048 7970  unctions for Hyp
-00087c20: 6572 4f70 7420 6865 7265 2023 2323 2323  erOpt here #####
-00087c30: 2323 2323 2323 2323 2323 2323 2323 2323  ################
-00087c40: 230d 0a23 2323 206b 6565 7020 616c 6c20  #..### keep all 
-00087c50: 436c 6173 7369 6669 6361 7469 6f6e 2053  Classification S
-00087c60: 636f 7265 7273 2067 7265 6174 6572 5f69  corers greater_i
-00087c70: 735f 6265 7474 6572 2054 7275 6520 6275  s_better True bu
-00087c80: 7420 7375 6274 7261 6374 2073 636f 7265  t subtract score
-00087c90: 7220 6672 6f6d 2031 2073 6f20 6974 2064  r from 1 so it d
-00087ca0: 696d 696e 6973 6865 732e 0d0a 2323 2323  iminishes...####
-00087cb0: 2054 6869 7320 6973 2074 6865 206f 6e6c   This is the onl
-00087cc0: 7920 7761 7920 4879 7065 724f 7074 2077  y way HyperOpt w
-00087cd0: 696c 6c20 6669 6e64 2074 6865 206d 696e  ill find the min
-00087ce0: 696d 756d 202d 2073 6f20 646f 6e27 7420  imum - so don't 
-00087cf0: 6368 616e 6765 2074 6869 7320 636f 6465  change this code
-00087d00: 2061 6e79 7469 6d65 210d 0a64 6566 2067   anytime!..def g
-00087d10: 696e 6928 7472 7574 682c 2070 7265 6469  ini(truth, predi
-00087d20: 6374 696f 6e73 293a 0d0a 2020 2020 6720  ctions):..    g 
-00087d30: 3d20 6e70 2e61 7361 7272 6179 286e 702e  = np.asarray(np.
-00087d40: 635f 5b74 7275 7468 2c20 7072 6564 6963  c_[truth, predic
-00087d50: 7469 6f6e 732c 206e 702e 6172 616e 6765  tions, np.arange
-00087d60: 286c 656e 2874 7275 7468 2929 205d 2c20  (len(truth)) ], 
-00087d70: 6474 7970 653d 6e70 2e66 6c6f 6174 290d  dtype=np.float).
-00087d80: 0a20 2020 2067 203d 2067 5b6e 702e 6c65  .    g = g[np.le
-00087d90: 7873 6f72 7428 2867 5b3a 2c32 5d2c 202d  xsort((g[:,2], -
-00087da0: 312a 675b 3a2c 315d 2929 5d0d 0a20 2020  1*g[:,1]))]..   
-00087db0: 2067 7320 3d20 675b 3a2c 305d 2e63 756d   gs = g[:,0].cum
-00087dc0: 7375 6d28 292e 7375 6d28 2920 2f20 675b  sum().sum() / g[
-00087dd0: 3a2c 305d 2e73 756d 2829 0d0a 2020 2020  :,0].sum()..    
-00087de0: 6773 202d 3d20 286c 656e 2874 7275 7468  gs -= (len(truth
-00087df0: 2920 2b20 3129 202f 2032 2e0d 0a20 2020  ) + 1) / 2...   
-00087e00: 2072 6574 7572 6e20 6773 202f 206c 656e   return gs / len
-00087e10: 2874 7275 7468 290d 0a0d 0a64 6566 2067  (truth)....def g
-00087e20: 696e 695f 736b 6c65 6172 6e28 7472 7574  ini_sklearn(trut
-00087e30: 682c 2070 7265 6469 6374 696f 6e73 293a  h, predictions):
-00087e40: 0d0a 2020 2020 7265 7475 726e 2067 696e  ..    return gin
-00087e50: 6928 7472 7574 682c 2070 7265 6469 6374  i(truth, predict
-00087e60: 696f 6e73 2920 2f20 6769 6e69 2874 7275  ions) / gini(tru
-00087e70: 7468 2c20 7472 7574 6829 0d0a 0d0a 6465  th, truth)....de
-00087e80: 6620 6769 6e69 5f6d 6561 6528 7472 7574  f gini_meae(trut
-00087e90: 682c 2070 7265 6469 6374 696f 6e73 293a  h, predictions):
-00087ea0: 0d0a 2020 2020 7363 6f72 6520 3d20 6d65  ..    score = me
-00087eb0: 6469 616e 5f61 6273 6f6c 7574 655f 6572  dian_absolute_er
-00087ec0: 726f 7228 7472 7574 682c 2070 7265 6469  ror(truth, predi
-00087ed0: 6374 696f 6e73 290d 0a20 2020 2072 6574  ctions)..    ret
-00087ee0: 7572 6e20 7363 6f72 650d 0a0d 0a64 6566  urn score....def
-00087ef0: 2067 696e 695f 6d73 6c65 2874 7275 7468   gini_msle(truth
-00087f00: 2c20 7072 6564 6963 7469 6f6e 7329 3a0d  , predictions):.
-00087f10: 0a20 2020 2073 636f 7265 203d 206e 702e  .    score = np.
-00087f20: 7371 7274 286d 6561 6e5f 7371 7561 7265  sqrt(mean_square
-00087f30: 645f 6c6f 675f 6572 726f 7228 7472 7574  d_log_error(trut
-00087f40: 682c 2070 7265 6469 6374 696f 6e73 2929  h, predictions))
-00087f50: 0d0a 2020 2020 7265 7475 726e 2073 636f  ..    return sco
-00087f60: 7265 0d0a 0d0a 6465 6620 6769 6e69 5f6d  re....def gini_m
-00087f70: 6165 2874 7275 7468 2c20 7072 6564 6963  ae(truth, predic
-00087f80: 7469 6f6e 7329 3a0d 0a20 2020 2073 636f  tions):..    sco
-00087f90: 7265 203d 206d 6561 6e5f 6162 736f 6c75  re = mean_absolu
-00087fa0: 7465 5f65 7272 6f72 2874 7275 7468 2c20  te_error(truth, 
-00087fb0: 7072 6564 6963 7469 6f6e 7329 0d0a 2020  predictions)..  
-00087fc0: 2020 7265 7475 726e 2073 636f 7265 0d0a    return score..
-00087fd0: 0d0a 6465 6620 6769 6e69 5f6d 7365 2874  ..def gini_mse(t
-00087fe0: 7275 7468 2c20 7072 6564 6963 7469 6f6e  ruth, prediction
-00087ff0: 7329 3a0d 0a20 2020 2073 636f 7265 203d  s):..    score =
-00088000: 206e 702e 7371 7274 286d 6561 6e5f 7371   np.sqrt(mean_sq
-00088010: 7561 7265 645f 6572 726f 7228 7472 7574  uared_error(trut
-00088020: 682c 2070 7265 6469 6374 696f 6e73 2929  h, predictions))
-00088030: 0d0a 2020 2020 7265 7475 726e 2073 636f  ..    return sco
-00088040: 7265 0d0a 0d0a 6465 6620 6769 6e69 5f72  re....def gini_r
-00088050: 6d73 6528 7472 7574 682c 2070 7265 6469  mse(truth, predi
-00088060: 6374 696f 6e73 293a 0d0a 2020 2020 7363  ctions):..    sc
-00088070: 6f72 6520 3d20 6e70 2e73 7172 7428 6d65  ore = np.sqrt(me
-00088080: 616e 5f73 7175 6172 6564 5f65 7272 6f72  an_squared_error
-00088090: 2874 7275 7468 2c20 7072 6564 6963 7469  (truth, predicti
-000880a0: 6f6e 7329 290d 0a20 2020 2072 6574 7572  ons))..    retur
-000880b0: 6e20 7363 6f72 650d 0a0d 0a64 6566 2067  n score....def g
-000880c0: 696e 695f 6163 6375 7261 6379 2874 7275  ini_accuracy(tru
-000880d0: 7468 2c20 7072 6564 6963 7469 6f6e 7329  th, predictions)
-000880e0: 3a0d 0a20 2020 2072 6574 7572 6e20 312d  :..    return 1-
-000880f0: 6163 6375 7261 6379 5f73 636f 7265 2874  accuracy_score(t
-00088100: 7275 7468 2c20 7072 6564 6963 7469 6f6e  ruth, prediction
-00088110: 7329 0d0a 0d0a 6465 6620 6769 6e69 5f62  s)....def gini_b
-00088120: 616c 5f61 6363 7572 6163 7928 7472 7574  al_accuracy(trut
-00088130: 682c 2070 7265 6469 6374 696f 6e73 293a  h, predictions):
-00088140: 0d0a 2020 2020 7265 7475 726e 2031 2d62  ..    return 1-b
-00088150: 616c 616e 6365 645f 6163 6375 7261 6379  alanced_accuracy
-00088160: 5f73 636f 7265 2874 7275 7468 2c20 7072  _score(truth, pr
-00088170: 6564 6963 7469 6f6e 7329 0d0a 0d0a 6465  edictions)....de
-00088180: 6620 6769 6e69 5f72 6f63 2874 7275 7468  f gini_roc(truth
-00088190: 2c20 7072 6564 6963 7469 6f6e 7329 3a0d  , predictions):.
-000881a0: 0a20 2020 2072 6574 7572 6e20 312d 726f  .    return 1-ro
-000881b0: 635f 6175 635f 7363 6f72 6528 7472 7574  c_auc_score(trut
-000881c0: 682c 2070 7265 6469 6374 696f 6e73 290d  h, predictions).
-000881d0: 0a0d 0a64 6566 2067 696e 695f 7072 6563  ...def gini_prec
-000881e0: 6973 696f 6e28 7472 7574 682c 2070 7265  ision(truth, pre
-000881f0: 6469 6374 696f 6e73 2c70 6f73 5f6c 6162  dictions,pos_lab
-00088200: 656c 3d31 293a 0d0a 2020 2020 7265 7475  el=1):..    retu
-00088210: 726e 2031 2d70 7265 6369 7369 6f6e 5f73  rn 1-precision_s
-00088220: 636f 7265 2874 7275 7468 2c20 7072 6564  core(truth, pred
-00088230: 6963 7469 6f6e 7329 0d0a 0d0a 6465 6620  ictions)....def 
-00088240: 6769 6e69 5f61 7665 7261 6765 5f70 7265  gini_average_pre
-00088250: 6369 7369 6f6e 2874 7275 7468 2c20 7072  cision(truth, pr
-00088260: 6564 6963 7469 6f6e 7329 3a0d 0a20 2020  edictions):..   
-00088270: 2072 6574 7572 6e20 312d 6176 6572 6167   return 1-averag
-00088280: 655f 7072 6563 6973 696f 6e5f 7363 6f72  e_precision_scor
-00088290: 6528 7472 7574 682c 2070 7265 6469 6374  e(truth, predict
-000882a0: 696f 6e73 2e61 7267 6d61 7828 6178 6973  ions.argmax(axis
-000882b0: 3d31 292c 6176 6572 6167 653d 2777 6569  =1),average='wei
-000882c0: 6768 7465 6427 290d 0a0d 0a64 6566 2067  ghted')....def g
-000882d0: 696e 695f 7765 6967 6874 6564 5f70 7265  ini_weighted_pre
-000882e0: 6369 7369 6f6e 2874 7275 7468 2c20 7072  cision(truth, pr
-000882f0: 6564 6963 7469 6f6e 7329 3a0d 0a20 2020  edictions):..   
-00088300: 2072 6574 7572 6e20 312d 7072 6563 6973   return 1-precis
-00088310: 696f 6e5f 7363 6f72 6528 7472 7574 682c  ion_score(truth,
-00088320: 2070 7265 6469 6374 696f 6e73 2e61 7267   predictions.arg
-00088330: 6d61 7828 6178 6973 3d31 292c 6176 6572  max(axis=1),aver
-00088340: 6167 653d 2777 6569 6768 7465 6427 290d  age='weighted').
-00088350: 0a0d 0a64 6566 2067 696e 695f 6d61 6372  ...def gini_macr
-00088360: 6f5f 7072 6563 6973 696f 6e28 7472 7574  o_precision(trut
-00088370: 682c 2070 7265 6469 6374 696f 6e73 293a  h, predictions):
-00088380: 0d0a 2020 2020 7265 7475 726e 2031 2d70  ..    return 1-p
-00088390: 7265 6369 7369 6f6e 5f73 636f 7265 2874  recision_score(t
-000883a0: 7275 7468 2c20 7072 6564 6963 7469 6f6e  ruth, prediction
-000883b0: 732e 6172 676d 6178 2861 7869 733d 3129  s.argmax(axis=1)
-000883c0: 2c61 7665 7261 6765 3d27 6d61 6372 6f27  ,average='macro'
-000883d0: 290d 0a0d 0a64 6566 2067 696e 695f 6d69  )....def gini_mi
-000883e0: 6372 6f5f 7072 6563 6973 696f 6e28 7472  cro_precision(tr
-000883f0: 7574 682c 2070 7265 6469 6374 696f 6e73  uth, predictions
-00088400: 293a 0d0a 2020 2020 7265 7475 726e 2031  ):..    return 1
-00088410: 2d70 7265 6369 7369 6f6e 5f73 636f 7265  -precision_score
-00088420: 2874 7275 7468 2c20 7072 6564 6963 7469  (truth, predicti
-00088430: 6f6e 732e 6172 676d 6178 2861 7869 733d  ons.argmax(axis=
-00088440: 3129 2c61 7665 7261 6765 3d27 6d69 6372  1),average='micr
-00088450: 6f27 290d 0a0d 0a64 6566 2067 696e 695f  o')....def gini_
-00088460: 7361 6d70 6c65 735f 7072 6563 6973 696f  samples_precisio
-00088470: 6e28 7472 7574 682c 2070 7265 6469 6374  n(truth, predict
-00088480: 696f 6e73 293a 0d0a 2020 2020 7265 7475  ions):..    retu
-00088490: 726e 2031 2d70 7265 6369 7369 6f6e 5f73  rn 1-precision_s
-000884a0: 636f 7265 2874 7275 7468 2c20 7072 6564  core(truth, pred
-000884b0: 6963 7469 6f6e 732e 6172 676d 6178 2861  ictions.argmax(a
-000884c0: 7869 733d 3129 2c61 7665 7261 6765 3d27  xis=1),average='
-000884d0: 7361 6d70 6c65 7327 290d 0a0d 0a64 6566  samples')....def
-000884e0: 2067 696e 695f 6631 2874 7275 7468 2c20   gini_f1(truth, 
-000884f0: 7072 6564 6963 7469 6f6e 7329 3a0d 0a20  predictions):.. 
-00088500: 2020 2072 6574 7572 6e20 312d 6631 5f73     return 1-f1_s
-00088510: 636f 7265 2874 7275 7468 2c70 7265 6469  core(truth,predi
-00088520: 6374 696f 6e73 290d 0a0d 0a64 6566 2067  ctions)....def g
-00088530: 696e 695f 7765 6967 6874 6564 5f66 3128  ini_weighted_f1(
-00088540: 7472 7574 682c 2070 7265 6469 6374 696f  truth, predictio
-00088550: 6e73 293a 0d0a 2020 2020 7265 7475 726e  ns):..    return
-00088560: 2031 2d66 315f 7363 6f72 6528 7472 7574   1-f1_score(trut
-00088570: 682c 2070 7265 6469 6374 696f 6e73 2e61  h, predictions.a
-00088580: 7267 6d61 7828 6178 6973 3d31 292c 6176  rgmax(axis=1),av
-00088590: 6572 6167 653d 2777 6569 6768 7465 6427  erage='weighted'
-000885a0: 290d 0a0d 0a64 6566 2067 696e 695f 6d61  )....def gini_ma
-000885b0: 6372 6f5f 6631 2874 7275 7468 2c20 7072  cro_f1(truth, pr
-000885c0: 6564 6963 7469 6f6e 7329 3a0d 0a20 2020  edictions):..   
-000885d0: 2072 6574 7572 6e20 312d 6631 5f73 636f   return 1-f1_sco
-000885e0: 7265 2874 7275 7468 2c20 7072 6564 6963  re(truth, predic
-000885f0: 7469 6f6e 732e 6172 676d 6178 2861 7869  tions.argmax(axi
-00088600: 733d 3129 2c61 7665 7261 6765 3d27 6d61  s=1),average='ma
-00088610: 6372 6f27 290d 0a0d 0a64 6566 2067 696e  cro')....def gin
-00088620: 695f 6d69 6372 6f5f 6631 2874 7275 7468  i_micro_f1(truth
-00088630: 2c20 7072 6564 6963 7469 6f6e 7329 3a0d  , predictions):.
-00088640: 0a20 2020 2072 6574 7572 6e20 312d 6631  .    return 1-f1
-00088650: 5f73 636f 7265 2874 7275 7468 2c20 7072  _score(truth, pr
-00088660: 6564 6963 7469 6f6e 732e 6172 676d 6178  edictions.argmax
-00088670: 2861 7869 733d 3129 2c61 7665 7261 6765  (axis=1),average
-00088680: 3d27 6d69 6372 6f27 290d 0a0d 0a64 6566  ='micro')....def
-00088690: 2067 696e 695f 7361 6d70 6c65 735f 6631   gini_samples_f1
-000886a0: 2874 7275 7468 2c20 7072 6564 6963 7469  (truth, predicti
-000886b0: 6f6e 7329 3a0d 0a20 2020 2072 6574 7572  ons):..    retur
-000886c0: 6e20 312d 6631 5f73 636f 7265 2874 7275  n 1-f1_score(tru
-000886d0: 7468 2c20 7072 6564 6963 7469 6f6e 732e  th, predictions.
-000886e0: 6172 676d 6178 2861 7869 733d 3129 2c61  argmax(axis=1),a
-000886f0: 7665 7261 6765 3d27 7361 6d70 6c65 7327  verage='samples'
-00088700: 290d 0a0d 0a64 6566 2067 696e 695f 6c6f  )....def gini_lo
-00088710: 675f 6c6f 7373 2874 7275 7468 2c20 7072  g_loss(truth, pr
-00088720: 6564 6963 7469 6f6e 7329 3a0d 0a20 2020  edictions):..   
-00088730: 2072 6574 7572 6e20 6c6f 675f 6c6f 7373   return log_loss
-00088740: 2874 7275 7468 2c20 7072 6564 6963 7469  (truth, predicti
-00088750: 6f6e 732c 6e6f 726d 616c 697a 653d 5472  ons,normalize=Tr
-00088760: 7565 290d 0a0d 0a64 6566 2067 696e 695f  ue)....def gini_
-00088770: 7265 6361 6c6c 2874 7275 7468 2c20 7072  recall(truth, pr
-00088780: 6564 6963 7469 6f6e 7329 3a0d 0a20 2020  edictions):..   
-00088790: 2072 6574 7572 6e20 312d 7265 6361 6c6c   return 1-recall
-000887a0: 5f73 636f 7265 2874 7275 7468 2c20 7072  _score(truth, pr
-000887b0: 6564 6963 7469 6f6e 7329 0d0a 0d0a 6465  edictions)....de
-000887c0: 6620 6769 6e69 5f77 6569 6768 7465 645f  f gini_weighted_
-000887d0: 7265 6361 6c6c 2874 7275 7468 2c20 7072  recall(truth, pr
-000887e0: 6564 6963 7469 6f6e 7329 3a0d 0a20 2020  edictions):..   
-000887f0: 2072 6574 7572 6e20 312d 7265 6361 6c6c   return 1-recall
-00088800: 5f73 636f 7265 2874 7275 7468 2c20 7072  _score(truth, pr
-00088810: 6564 6963 7469 6f6e 732e 6172 676d 6178  edictions.argmax
-00088820: 2861 7869 733d 3129 2c61 7665 7261 6765  (axis=1),average
-00088830: 3d27 7765 6967 6874 6564 2729 0d0a 0d0a  ='weighted')....
-00088840: 6465 6620 6769 6e69 5f73 616d 706c 6573  def gini_samples
-00088850: 5f72 6563 616c 6c28 7472 7574 682c 2070  _recall(truth, p
-00088860: 7265 6469 6374 696f 6e73 293a 0d0a 2020  redictions):..  
-00088870: 2020 7265 7475 726e 2031 2d72 6563 616c    return 1-recal
-00088880: 6c5f 7363 6f72 6528 7472 7574 682c 2070  l_score(truth, p
-00088890: 7265 6469 6374 696f 6e73 2e61 7267 6d61  redictions.argma
-000888a0: 7828 6178 6973 3d31 292c 6176 6572 6167  x(axis=1),averag
-000888b0: 653d 2773 616d 706c 6573 2729 0d0a 0d0a  e='samples')....
-000888c0: 6465 6620 6769 6e69 5f6d 6163 726f 5f72  def gini_macro_r
-000888d0: 6563 616c 6c28 7472 7574 682c 2070 7265  ecall(truth, pre
-000888e0: 6469 6374 696f 6e73 293a 0d0a 2020 2020  dictions):..    
-000888f0: 7265 7475 726e 2031 2d72 6563 616c 6c5f  return 1-recall_
-00088900: 7363 6f72 6528 7472 7574 682c 2070 7265  score(truth, pre
-00088910: 6469 6374 696f 6e73 2e61 7267 6d61 7828  dictions.argmax(
-00088920: 6178 6973 3d31 292c 6176 6572 6167 653d  axis=1),average=
-00088930: 276d 6163 726f 2729 0d0a 0d0a 6465 6620  'macro')....def 
-00088940: 6769 6e69 5f6d 6963 726f 5f72 6563 616c  gini_micro_recal
-00088950: 6c28 7472 7574 682c 2070 7265 6469 6374  l(truth, predict
-00088960: 696f 6e73 293a 0d0a 2020 2020 7265 7475  ions):..    retu
-00088970: 726e 2031 2d72 6563 616c 6c5f 7363 6f72  rn 1-recall_scor
-00088980: 6528 7472 7574 682c 2070 7265 6469 6374  e(truth, predict
-00088990: 696f 6e73 2e61 7267 6d61 7828 6178 6973  ions.argmax(axis
-000889a0: 3d31 292c 6176 6572 6167 653d 276d 6963  =1),average='mic
-000889b0: 726f 2729 0d0a 0d0a 6465 6620 6769 6e69  ro')....def gini
-000889c0: 5f72 6f63 5f61 7563 2874 7275 7468 2c20  _roc_auc(truth, 
-000889d0: 7072 6564 6963 7469 6f6e 7329 3a0d 0a20  predictions):.. 
-000889e0: 2020 2072 6574 7572 6e20 312d 726f 635f     return 1-roc_
-000889f0: 6175 635f 7363 6f72 6528 7472 7574 682c  auc_score(truth,
-00088a00: 2070 7265 6469 6374 696f 6e73 2e61 7267   predictions.arg
-00088a10: 6d61 7828 6178 6973 3d31 292c 6176 6572  max(axis=1),aver
-00088a20: 6167 653d 276d 6163 726f 2729 0d0a 2320  age='macro')..# 
-00088a30: 6361 6c63 756c 6174 6520 6632 2d6d 6561  calculate f2-mea
-00088a40: 7375 7265 0d0a 6465 6620 6632 5f6d 6561  sure..def f2_mea
-00088a50: 7375 7265 2879 5f74 7275 652c 2079 5f70  sure(y_true, y_p
-00088a60: 7265 6429 3a0d 0a20 2020 2072 6574 7572  red):..    retur
-00088a70: 6e20 6662 6574 615f 7363 6f72 6528 795f  n fbeta_score(y_
-00088a80: 7472 7565 2c20 795f 7072 6564 2c20 6265  true, y_pred, be
-00088a90: 7461 3d32 290d 0a23 2323 206b 6565 7020  ta=2)..### keep 
-00088aa0: 616c 6c20 5265 6772 6573 7369 6f6e 2053  all Regression S
-00088ab0: 636f 7265 7273 2067 7265 6174 6572 5f69  corers greater_i
-00088ac0: 735f 6265 7474 6572 2054 7275 6520 7369  s_better True si
-00088ad0: 6e63 6520 6974 206c 6561 7665 7320 7468  nce it leaves th
-00088ae0: 656d 2061 7320 6973 2061 6e64 206d 696e  em as is and min
-00088af0: 696d 697a 6573 2074 6865 6d0d 0a6d 6561  imizes them..mea
-00088b00: 655f 7363 6f72 6572 203d 206d 616b 655f  e_scorer = make_
-00088b10: 7363 6f72 6572 2867 696e 695f 6d65 6165  scorer(gini_meae
-00088b20: 2c20 6772 6561 7465 725f 6973 5f62 6574  , greater_is_bet
-00088b30: 7465 723d 5472 7565 290d 0a6d 736c 655f  ter=True)..msle_
-00088b40: 7363 6f72 6572 203d 206d 616b 655f 7363  scorer = make_sc
-00088b50: 6f72 6572 2867 696e 695f 6d73 6c65 2c20  orer(gini_msle, 
-00088b60: 6772 6561 7465 725f 6973 5f62 6574 7465  greater_is_bette
-00088b70: 723d 5472 7565 290d 0a6d 6165 5f73 636f  r=True)..mae_sco
-00088b80: 7265 7220 3d20 6d61 6b65 5f73 636f 7265  rer = make_score
-00088b90: 7228 6769 6e69 5f6d 6165 2c20 6772 6561  r(gini_mae, grea
-00088ba0: 7465 725f 6973 5f62 6574 7465 723d 5472  ter_is_better=Tr
-00088bb0: 7565 290d 0a6d 7365 5f73 636f 7265 7220  ue)..mse_scorer 
-00088bc0: 3d20 6d61 6b65 5f73 636f 7265 7228 6769  = make_scorer(gi
-00088bd0: 6e69 5f6d 7365 2c20 6772 6561 7465 725f  ni_mse, greater_
-00088be0: 6973 5f62 6574 7465 723d 5472 7565 290d  is_better=True).
-00088bf0: 0a0d 0a23 2323 206b 6565 7020 616c 6c20  ...### keep all 
-00088c00: 436c 6173 7369 6669 6361 7469 6f6e 2053  Classification S
-00088c10: 636f 7265 7273 2067 7265 6174 6572 5f69  corers greater_i
-00088c20: 735f 6265 7474 6572 2054 7275 6520 6275  s_better True bu
-00088c30: 7420 7375 6274 7261 6374 2073 636f 7265  t subtract score
-00088c40: 7220 6672 6f6d 2031 2073 6f20 6974 2064  r from 1 so it d
-00088c50: 696d 696e 6973 6865 732e 0d0a 2323 2323  iminishes...####
-00088c60: 2054 6869 7320 6973 2074 6865 206f 6e6c   This is the onl
-00088c70: 7920 7761 7920 4879 7065 724f 7074 2077  y way HyperOpt w
-00088c80: 696c 6c20 6669 6e64 2074 6865 206d 696e  ill find the min
-00088c90: 696d 756d 202d 2073 6f20 646f 6e27 7420  imum - so don't 
-00088ca0: 6368 616e 6765 2074 6869 7320 636f 6465  change this code
-00088cb0: 2061 6e79 7469 6d65 210d 0a61 6363 7572   anytime!..accur
-00088cc0: 6163 795f 7363 6f72 6572 203d 206d 616b  acy_scorer = mak
-00088cd0: 655f 7363 6f72 6572 2867 696e 695f 6163  e_scorer(gini_ac
-00088ce0: 6375 7261 6379 2c20 6772 6561 7465 725f  curacy, greater_
-00088cf0: 6973 5f62 6574 7465 723d 5472 7565 2c20  is_better=True, 
-00088d00: 6e65 6564 735f 7072 6f62 613d 4661 6c73  needs_proba=Fals
-00088d10: 6529 0d0a 6261 6c5f 6163 6375 7261 6379  e)..bal_accuracy
-00088d20: 5f73 636f 7265 7220 3d20 6d61 6b65 5f73  _scorer = make_s
-00088d30: 636f 7265 7228 6769 6e69 5f62 616c 5f61  corer(gini_bal_a
-00088d40: 6363 7572 6163 792c 2067 7265 6174 6572  ccuracy, greater
-00088d50: 5f69 735f 6265 7474 6572 3d54 7275 652c  _is_better=True,
-00088d60: 206e 6565 6473 5f70 726f 6261 3d46 616c   needs_proba=Fal
-00088d70: 7365 290d 0a0d 0a67 696e 695f 7363 6f72  se)....gini_scor
-00088d80: 6572 203d 206d 616b 655f 7363 6f72 6572  er = make_scorer
-00088d90: 2867 696e 695f 736b 6c65 6172 6e2c 2067  (gini_sklearn, g
-00088da0: 7265 6174 6572 5f69 735f 6265 7474 6572  reater_is_better
-00088db0: 3d54 7275 652c 206e 6565 6473 5f70 726f  =True, needs_pro
-00088dc0: 6261 3d54 7275 6529 0d0a 726f 635f 7363  ba=True)..roc_sc
-00088dd0: 6f72 6572 203d 206d 616b 655f 7363 6f72  orer = make_scor
-00088de0: 6572 2867 696e 695f 726f 632c 2067 7265  er(gini_roc, gre
-00088df0: 6174 6572 5f69 735f 6265 7474 6572 3d54  ater_is_better=T
-00088e00: 7275 652c 206e 6565 6473 5f70 726f 6261  rue, needs_proba
-00088e10: 3d54 7275 6529 0d0a 0d0a 7072 6563 6973  =True)....precis
-00088e20: 696f 6e5f 7363 6f72 6572 203d 206d 616b  ion_scorer = mak
-00088e30: 655f 7363 6f72 6572 2867 696e 695f 7072  e_scorer(gini_pr
-00088e40: 6563 6973 696f 6e2c 2067 7265 6174 6572  ecision, greater
-00088e50: 5f69 735f 6265 7474 6572 3d54 7275 652c  _is_better=True,
-00088e60: 206e 6565 6473 5f70 726f 6261 3d46 616c   needs_proba=Fal
-00088e70: 7365 290d 0a61 7665 7261 6765 5f70 7265  se)..average_pre
-00088e80: 6369 7369 6f6e 5f73 636f 7265 7220 3d20  cision_scorer = 
-00088e90: 6d61 6b65 5f73 636f 7265 7228 6769 6e69  make_scorer(gini
-00088ea0: 5f61 7665 7261 6765 5f70 7265 6369 7369  _average_precisi
-00088eb0: 6f6e 2c20 6772 6561 7465 725f 6973 5f62  on, greater_is_b
-00088ec0: 6574 7465 723d 5472 7565 2c20 6e65 6564  etter=True, need
-00088ed0: 735f 7072 6f62 613d 5472 7565 290d 0a77  s_proba=True)..w
-00088ee0: 6569 6768 7465 645f 7072 6563 6973 696f  eighted_precisio
-00088ef0: 6e5f 7363 6f72 6572 203d 206d 616b 655f  n_scorer = make_
-00088f00: 7363 6f72 6572 2867 696e 695f 7765 6967  scorer(gini_weig
-00088f10: 6874 6564 5f70 7265 6369 7369 6f6e 2c20  hted_precision, 
-00088f20: 6772 6561 7465 725f 6973 5f62 6574 7465  greater_is_bette
-00088f30: 723d 5472 7565 2c20 6e65 6564 735f 7072  r=True, needs_pr
-00088f40: 6f62 613d 5472 7565 290d 0a6d 6163 726f  oba=True)..macro
-00088f50: 5f70 7265 6369 7369 6f6e 5f73 636f 7265  _precision_score
-00088f60: 7220 3d20 6d61 6b65 5f73 636f 7265 7228  r = make_scorer(
-00088f70: 6769 6e69 5f6d 6163 726f 5f70 7265 6369  gini_macro_preci
-00088f80: 7369 6f6e 2c20 6772 6561 7465 725f 6973  sion, greater_is
-00088f90: 5f62 6574 7465 723d 5472 7565 2c20 6e65  _better=True, ne
-00088fa0: 6564 735f 7072 6f62 613d 5472 7565 290d  eds_proba=True).
-00088fb0: 0a6d 6963 726f 5f70 7265 6369 7369 6f6e  .micro_precision
-00088fc0: 5f73 636f 7265 7220 3d20 6d61 6b65 5f73  _scorer = make_s
-00088fd0: 636f 7265 7228 6769 6e69 5f6d 6963 726f  corer(gini_micro
-00088fe0: 5f70 7265 6369 7369 6f6e 2c20 6772 6561  _precision, grea
-00088ff0: 7465 725f 6973 5f62 6574 7465 723d 5472  ter_is_better=Tr
-00089000: 7565 2c20 6e65 6564 735f 7072 6f62 613d  ue, needs_proba=
-00089010: 5472 7565 290d 0a73 616d 706c 6573 5f70  True)..samples_p
-00089020: 7265 6369 7369 6f6e 5f73 636f 7265 7220  recision_scorer 
-00089030: 3d20 6d61 6b65 5f73 636f 7265 7228 6769  = make_scorer(gi
-00089040: 6e69 5f73 616d 706c 6573 5f70 7265 6369  ni_samples_preci
-00089050: 7369 6f6e 2c20 6772 6561 7465 725f 6973  sion, greater_is
-00089060: 5f62 6574 7465 723d 5472 7565 2c20 6e65  _better=True, ne
-00089070: 6564 735f 7072 6f62 613d 5472 7565 290d  eds_proba=True).
-00089080: 0a0d 0a66 315f 7363 6f72 6572 203d 206d  ...f1_scorer = m
-00089090: 616b 655f 7363 6f72 6572 2867 696e 695f  ake_scorer(gini_
-000890a0: 6631 2c20 6772 6561 7465 725f 6973 5f62  f1, greater_is_b
-000890b0: 6574 7465 723d 5472 7565 2c20 6e65 6564  etter=True, need
-000890c0: 735f 7072 6f62 613d 4661 6c73 6529 0d0a  s_proba=False)..
-000890d0: 7765 6967 6874 6564 5f66 315f 7363 6f72  weighted_f1_scor
-000890e0: 6572 203d 206d 616b 655f 7363 6f72 6572  er = make_scorer
-000890f0: 2867 696e 695f 7765 6967 6874 6564 5f66  (gini_weighted_f
-00089100: 312c 2067 7265 6174 6572 5f69 735f 6265  1, greater_is_be
-00089110: 7474 6572 3d54 7275 652c 206e 6565 6473  tter=True, needs
-00089120: 5f70 726f 6261 3d54 7275 6529 0d0a 6d61  _proba=True)..ma
-00089130: 6372 6f5f 6631 5f73 636f 7265 7220 3d20  cro_f1_scorer = 
-00089140: 6d61 6b65 5f73 636f 7265 7228 6769 6e69  make_scorer(gini
-00089150: 5f6d 6163 726f 5f66 312c 2067 7265 6174  _macro_f1, great
-00089160: 6572 5f69 735f 6265 7474 6572 3d54 7275  er_is_better=Tru
-00089170: 652c 206e 6565 6473 5f70 726f 6261 3d54  e, needs_proba=T
-00089180: 7275 6529 0d0a 6d69 6372 6f5f 6631 5f73  rue)..micro_f1_s
-00089190: 636f 7265 7220 3d20 6d61 6b65 5f73 636f  corer = make_sco
-000891a0: 7265 7228 6769 6e69 5f6d 6963 726f 5f66  rer(gini_micro_f
-000891b0: 312c 2067 7265 6174 6572 5f69 735f 6265  1, greater_is_be
-000891c0: 7474 6572 3d54 7275 652c 206e 6565 6473  tter=True, needs
-000891d0: 5f70 726f 6261 3d54 7275 6529 0d0a 7361  _proba=True)..sa
-000891e0: 6d70 6c65 735f 6631 5f73 636f 7265 7220  mples_f1_scorer 
-000891f0: 3d20 6d61 6b65 5f73 636f 7265 7228 6769  = make_scorer(gi
-00089200: 6e69 5f73 616d 706c 6573 5f66 312c 2067  ni_samples_f1, g
-00089210: 7265 6174 6572 5f69 735f 6265 7474 6572  reater_is_better
-00089220: 3d54 7275 652c 206e 6565 6473 5f70 726f  =True, needs_pro
-00089230: 6261 3d54 7275 6529 0d0a 0d0a 7265 6361  ba=True)....reca
-00089240: 6c6c 5f73 636f 7265 7220 3d20 6d61 6b65  ll_scorer = make
-00089250: 5f73 636f 7265 7228 6769 6e69 5f72 6563  _scorer(gini_rec
-00089260: 616c 6c2c 2067 7265 6174 6572 5f69 735f  all, greater_is_
-00089270: 6265 7474 6572 3d54 7275 652c 206e 6565  better=True, nee
-00089280: 6473 5f70 726f 6261 3d46 616c 7365 290d  ds_proba=False).
-00089290: 0a77 6569 6768 7465 645f 7265 6361 6c6c  .weighted_recall
-000892a0: 5f73 636f 7265 7220 3d20 6d61 6b65 5f73  _scorer = make_s
-000892b0: 636f 7265 7228 6769 6e69 5f77 6569 6768  corer(gini_weigh
-000892c0: 7465 645f 7265 6361 6c6c 2c20 6772 6561  ted_recall, grea
-000892d0: 7465 725f 6973 5f62 6574 7465 723d 5472  ter_is_better=Tr
-000892e0: 7565 2c20 6e65 6564 735f 7072 6f62 613d  ue, needs_proba=
-000892f0: 5472 7565 290d 0a6d 6163 726f 5f72 6563  True)..macro_rec
-00089300: 616c 6c5f 7363 6f72 6572 203d 206d 616b  all_scorer = mak
-00089310: 655f 7363 6f72 6572 2867 696e 695f 6d61  e_scorer(gini_ma
-00089320: 6372 6f5f 7265 6361 6c6c 2c20 6772 6561  cro_recall, grea
-00089330: 7465 725f 6973 5f62 6574 7465 723d 5472  ter_is_better=Tr
-00089340: 7565 2c20 6e65 6564 735f 7072 6f62 613d  ue, needs_proba=
-00089350: 5472 7565 290d 0a6d 6963 726f 5f72 6563  True)..micro_rec
-00089360: 616c 6c5f 7363 6f72 6572 203d 206d 616b  all_scorer = mak
-00089370: 655f 7363 6f72 6572 2867 696e 695f 6d69  e_scorer(gini_mi
-00089380: 6372 6f5f 7265 6361 6c6c 2c20 6772 6561  cro_recall, grea
-00089390: 7465 725f 6973 5f62 6574 7465 723d 5472  ter_is_better=Tr
-000893a0: 7565 2c20 6e65 6564 735f 7072 6f62 613d  ue, needs_proba=
-000893b0: 5472 7565 290d 0a73 616d 706c 6573 5f72  True)..samples_r
-000893c0: 6563 616c 6c5f 7363 6f72 6572 203d 206d  ecall_scorer = m
-000893d0: 616b 655f 7363 6f72 6572 2867 696e 695f  ake_scorer(gini_
-000893e0: 7361 6d70 6c65 735f 7265 6361 6c6c 2c20  samples_recall, 
-000893f0: 6772 6561 7465 725f 6973 5f62 6574 7465  greater_is_bette
-00089400: 723d 5472 7565 2c20 6e65 6564 735f 7072  r=True, needs_pr
-00089410: 6f62 613d 5472 7565 290d 0a0d 0a72 6f63  oba=True)....roc
-00089420: 5f61 7563 5f73 636f 7265 7220 3d20 6d61  _auc_scorer = ma
-00089430: 6b65 5f73 636f 7265 7228 6769 6e69 5f72  ke_scorer(gini_r
-00089440: 6f63 5f61 7563 2c20 6772 6561 7465 725f  oc_auc, greater_
-00089450: 6973 5f62 6574 7465 723d 5472 7565 2c20  is_better=True, 
-00089460: 6e65 6564 735f 7072 6f62 613d 5472 7565  needs_proba=True
-00089470: 290d 0a23 2323 204c 6561 7665 2074 6865  )..### Leave the
-00089480: 206c 6f67 2d6c 6f73 7320 7363 6f72 6572   log-loss scorer
-00089490: 2061 7320 6772 6561 7465 725f 6973 5f62   as greater_is_b
-000894a0: 6574 7465 7220 5472 7565 2073 696e 6365  etter True since
-000894b0: 2069 7420 6b65 6570 7320 7369 676e 2061   it keeps sign a
-000894c0: 6e64 206d 696e 696d 697a 6573 2069 742e  nd minimizes it.
-000894d0: 0d0a 6c6f 676c 6f73 735f 7363 6f72 6572  ..logloss_scorer
-000894e0: 203d 206d 616b 655f 7363 6f72 6572 2867   = make_scorer(g
-000894f0: 696e 695f 6c6f 675f 6c6f 7373 2c20 6772  ini_log_loss, gr
-00089500: 6561 7465 725f 6973 5f62 6574 7465 723d  eater_is_better=
-00089510: 5472 7565 2c20 6e65 6564 735f 7072 6f62  True, needs_prob
-00089520: 613d 5472 7565 290d 0a23 2323 2323 2323  a=True)..#######
-00089530: 2323 2323 2323 2323 2323 2323 2323 2323  ################
-00089540: 2323 2323 2323 2323 2323 2323 2323 2323  ################
-00089550: 2323 2323 2323 2323 2323 2323 2323 2323  ################
-00089560: 2323 2323 2323 2323 2323 2323 2323 2323  ################
-00089570: 2323 2323 2323 2323 2323 2323 2323 2323  ################
-00089580: 2323 230d 0a00 0000 0000 0000 0000 0000  ###.............
-00089590: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-000895a0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-000895b0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-000895c0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-000895d0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-000895e0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-000895f0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-00089600: 2e2f 2e2f 4050 6178 4865 6164 6572 0000  ././@PaxHeader..
-00089610: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-00089620: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-00089630: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-00089640: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-00089650: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-00089660: 0000 0000 3030 3030 3030 3000 3030 3030  ....0000000.0000
-00089670: 3030 3000 3030 3030 3030 3000 3030 3030  000.0000000.0000
-00089680: 3030 3030 3032 3600 3030 3030 3030 3030  0000026.00000000
-00089690: 3030 3000 3031 3134 3533 0020 7800 0000  000.011453. x...
-000896a0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-000896b0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-000896c0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-000896d0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-000896e0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-000896f0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-00089700: 0075 7374 6172 0030 3000 0000 0000 0000  .ustar.00.......
-00089710: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-00089720: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-00089730: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-00089740: 0000 0000 0000 0000 0030 3030 3030 3030  .........0000000
-00089750: 0030 3030 3030 3030 0000 0000 0000 0000  .0000000........
-00089760: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-00089770: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-00089780: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-00089790: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-000897a0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-000897b0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-000897c0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-000897d0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-000897e0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-000897f0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-00089800: 3232 206d 7469 6d65 3d31 3637 3831 3539  22 mtime=1678159
-00089810: 3732 322e 300a 0000 0000 0000 0000 0000  722.0...........
-00089820: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-00089830: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-00089840: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-00089850: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-00089860: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-00089870: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-00089880: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-00089890: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-000898a0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-000898b0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-000898c0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-000898d0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-000898e0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-000898f0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-00089900: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-00089910: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-00089920: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-00089930: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-00089940: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-00089950: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-00089960: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-00089970: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-00089980: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-00089990: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-000899a0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-000899b0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-000899c0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-000899d0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-000899e0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-000899f0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-00089a00: 6175 746f 7669 6d6c 2d30 2e31 2e37 3134  autoviml-0.1.714
-00089a10: 2f61 7574 6f76 696d 6c2f 6665 6174 7572  /autoviml/featur
-00089a20: 655f 656e 6769 6e65 6572 696e 672e 7079  e_engineering.py
-00089a30: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-00089a40: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-00089a50: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-00089a60: 0000 0000 3030 3030 3737 3700 3030 3031  ....0000777.0001
-00089a70: 3735 3000 3030 3031 3735 3000 3030 3030  750.0001750.0000
-00089a80: 3030 3433 3237 3000 3030 3030 3030 3030  0043270.00000000
-00089a90: 3030 3000 3032 3133 3431 0020 3000 0000  000.021341. 0...
-00089aa0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-00089ab0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-00089ac0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-00089ad0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-00089ae0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-00089af0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-00089b00: 0075 7374 6172 0030 3072 616d 0000 0000  .ustar.00ram....
-00089b10: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-00089b20: 0000 0000 0000 0000 0072 616d 0000 0000  .........ram....
-00089b30: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-00089b40: 0000 0000 0000 0000 0030 3030 3030 3030  .........0000000
-00089b50: 0030 3030 3030 3030 0000 0000 0000 0000  .0000000........
-00089b60: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-00089b70: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-00089b80: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-00089b90: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-00089ba0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-00089bb0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-00089bc0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-00089bd0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-00089be0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-00089bf0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-00089c00: 696d 706f 7274 2070 616e 6461 7320 6173  import pandas as
-00089c10: 2070 640d 0a69 6d70 6f72 7420 6e75 6d70   pd..import nump
-00089c20: 7920 6173 206e 700d 0a23 2323 2323 2323  y as np..#######
-00089c30: 2323 204e 4557 2041 6e64 2046 4153 5420  ## NEW And FAST 
-00089c40: 5741 5920 746f 2041 4444 2046 6561 7475  WAY to ADD Featu
-00089c50: 7265 2045 6e67 6720 434f 4c55 4d4e 5320  re Engg COLUMNS 
-00089c60: 494e 2041 2044 4154 4120 5345 5420 2323  IN A DATA SET ##
-00089c70: 2323 2323 230d 0a23 2323 2020 204d 6f64  #####..###   Mod
-00089c80: 6966 7920 4461 7461 6672 616d 6520 6279  ify Dataframe by
-00089c90: 2061 6464 696e 6720 4665 6174 7572 6573   adding Features
-00089ca0: 2075 7369 6e67 2046 6561 7475 7265 2054   using Feature T
-00089cb0: 6f6f 6c73 2023 2323 230d 0a64 6566 2061  ools ####..def a
-00089cc0: 6464 5f63 6f6d 7075 7461 7469 6f6e 616c  dd_computational
-00089cd0: 5f70 7269 6d69 7469 7665 5f66 6561 7475  _primitive_featu
-00089ce0: 7265 7328 2064 662c 2061 6464 5f74 7970  res( df, add_typ
-00089cf0: 6573 3d5b 5d2c 2069 6463 6f6c 756d 6e3d  es=[], idcolumn=
-00089d00: 2727 293a 0d0a 2020 2020 2222 220d 0a20  ''):..    """.. 
-00089d10: 2020 2023 2323 2020 204d 6f64 6966 7920     ###   Modify 
-00089d20: 4461 7461 6672 616d 6520 6279 2061 6464  Dataframe by add
-00089d30: 696e 6720 636f 6d70 7574 6174 696f 6e61  ing computationa
-00089d40: 6c20 7072 696d 6974 6976 6520 4665 6174  l primitive Feat
-00089d50: 7572 6573 2075 7369 6e67 2046 6561 7475  ures using Featu
-00089d60: 7265 2054 6f6f 6c73 2023 2323 230d 0a20  re Tools ####.. 
-00089d70: 2020 2023 2323 2020 2057 6861 7420 6172     ###   What ar
-00089d80: 6520 636f 6d70 7574 6174 696f 6e61 6c20  e computational 
-00089d90: 7072 696d 6974 6976 6573 3f20 7468 6579  primitives? they
-00089da0: 2061 7265 2074 6f20 6164 642c 2073 7562   are to add, sub
-00089db0: 7472 6163 742c 206d 756c 7469 706c 7920  tract, multiply 
-00089dc0: 616e 6420 6469 7669 6465 2066 6561 7475  and divide featu
-00089dd0: 7265 730d 0a20 2020 2023 2323 2049 6e70  res..    ### Inp
-00089de0: 7574 733a 0d0a 2020 2020 2323 2320 2020  uts:..    ###   
-00089df0: 6466 3a20 4a75 7374 2073 656e 7420 696e  df: Just sent in
-00089e00: 2074 6865 2064 6174 6120 6672 616d 6520   the data frame 
-00089e10: 6466 2074 6861 7420 796f 7520 7761 6e74  df that you want
-00089e20: 2066 6561 7475 7265 7320 6164 6465 6420   features added 
-00089e30: 746f 0d0a 2020 2020 2323 2320 2020 6164  to..    ###   ad
-00089e40: 645f 7479 7065 733a 206c 6973 7420 6f66  d_types: list of
-00089e50: 2063 6f6d 7075 7461 7469 6f6e 616c 2074   computational t
-00089e60: 7970 6573 3a20 2761 6464 272c 2027 7375  ypes: 'add', 'su
-00089e70: 6274 7261 6374 272c 2027 6d75 6c74 6970  btract', 'multip
-00089e80: 6c79 2720 616e 6420 2764 6976 6964 6527  ly' and 'divide'
-00089e90: 2e20 4368 6f6f 7365 2061 6e79 206f 7220  . Choose any or 
-00089ea0: 616c 6c2e 0d0a 2020 2020 2323 2320 2020  all...    ###   
-00089eb0: 6964 636f 6c75 6d6e 3a20 7468 6973 2069  idcolumn: this i
-00089ec0: 7320 746f 2063 7265 6174 6520 616e 2069  s to create an i
-00089ed0: 6e64 6578 2066 6f72 2074 6865 2064 6174  ndex for the dat
-00089ee0: 6166 7261 6d65 2073 696e 6365 2046 5420  aframe since FT 
-00089ef0: 7275 6e73 206f 6e20 696e 6465 7820 7661  runs on index va
-00089f00: 7269 6162 6c65 2e20 596f 7520 6361 6e20  riable. You can 
-00089f10: 6c65 6176 6520 6974 2065 6d70 7479 2073  leave it empty s
-00089f20: 7472 696e 672e 0d0a 2020 2020 2222 220d  tring...    """.
-00089f30: 0a20 2020 2074 7279 3a0d 0a20 2020 2020  .    try:..     
-00089f40: 2020 2069 6d70 6f72 7420 6665 6174 7572     import featur
-00089f50: 6574 6f6f 6c73 2061 7320 6674 0d0a 2020  etools as ft..  
-00089f60: 2020 6578 6365 7074 3a0d 0a20 2020 2020    except:..     
-00089f70: 2020 2070 7269 6e74 2827 596f 7520 6d75     print('You mu
-00089f80: 7374 2069 6e73 7461 6c6c 2066 6561 7475  st install featu
-00089f90: 7265 746f 6f6c 7320 746f 2075 7365 2066  retools to use f
-00089fa0: 6561 7475 7265 5f65 6e67 696e 6565 7269  eature_engineeri
-00089fb0: 6e67 2066 756e 6374 696f 6e73 2e20 496e  ng functions. In
-00089fc0: 7374 616c 6c20 6974 2061 6e64 2074 7279  stall it and try
-00089fd0: 2061 6761 696e 2e27 290d 0a20 2020 2064   again.')..    d
-00089fe0: 6620 3d20 636f 7079 2e64 6565 7063 6f70  f = copy.deepcop
-00089ff0: 7928 6466 290d 0a20 2020 2070 726f 6a65  y(df)..    proje
-0008a000: 6374 6964 203d 2027 7072 6f6a 6563 745f  ctid = 'project_
-0008a010: 7072 6564 6963 7469 6f6e 270d 0a20 2020  prediction'..   
-0008a020: 2064 6174 6169 6420 3d20 2770 726f 6a65   dataid = 'proje
-0008a030: 6374 5f64 6174 6127 0d0a 2020 2020 6966  ct_data'..    if
-0008a040: 2069 6463 6f6c 756d 6e20 3d3d 2027 273a   idcolumn == '':
-0008a050: 0d0a 2020 2020 2020 2020 696e 6465 7869  ..        indexi
-0008a060: 6420 3d20 2769 6e64 6578 270d 0a20 2020  d = 'index'..   
-0008a070: 2020 2020 206d 616b 655f 696e 6465 7820       make_index 
-0008a080: 3d20 5472 7565 0d0a 2020 2020 656c 7365  = True..    else
-0008a090: 3a0d 0a20 2020 2020 2020 2069 6e64 6578  :..        index
-0008a0a0: 6964 203d 2069 6463 6f6c 756d 6e0d 0a20  id = idcolumn.. 
-0008a0b0: 2020 2020 2020 206d 616b 655f 696e 6465         make_inde
-0008a0c0: 783d 4661 6c73 650d 0a20 2020 2023 204d  x=False..    # M
-0008a0d0: 616b 6520 616e 2065 6e74 6974 7973 6574  ake an entityset
-0008a0e0: 2061 6e64 2061 6464 2074 6865 2065 6e74   and add the ent
-0008a0f0: 6974 790d 0a20 2020 2065 7320 3d20 6674  ity..    es = ft
-0008a100: 2e45 6e74 6974 7953 6574 2869 6420 3d20  .EntitySet(id = 
-0008a110: 7072 6f6a 6563 7469 6429 0d0a 2020 2020  projectid)..    
-0008a120: 6573 2e65 6e74 6974 795f 6672 6f6d 5f64  es.entity_from_d
-0008a130: 6174 6166 7261 6d65 2865 6e74 6974 795f  ataframe(entity_
-0008a140: 6964 203d 2064 6174 6169 642c 2064 6174  id = dataid, dat
-0008a150: 6166 7261 6d65 203d 2064 662c 0d0a 2020  aframe = df,..  
-0008a160: 2020 2020 2020 2020 2020 2020 2020 2020                  
-0008a170: 2020 2020 2020 2020 2020 206d 616b 655f             make_
-0008a180: 696e 6465 7820 3d20 6d61 6b65 5f69 6e64  index = make_ind
-0008a190: 6578 2c20 696e 6465 7820 3d20 696e 6465  ex, index = inde
-0008a1a0: 7869 6429 0d0a 0d0a 2020 2020 2320 5275  xid)....    # Ru
-0008a1b0: 6e20 6465 6570 2066 6561 7475 7265 2073  n deep feature s
-0008a1c0: 796e 7468 6573 6973 2077 6974 6820 6769  ynthesis with gi
-0008a1d0: 7665 6e20 696e 7075 7420 7072 696d 6974  ven input primit
-0008a1e0: 6976 6573 206f 7220 6175 746f 6d61 7469  ives or automati
-0008a1f0: 6361 6c6c 7920 6465 6570 2032 0d0a 2020  cally deep 2..  
-0008a200: 2020 6966 206c 656e 2861 6464 5f74 7970    if len(add_typ
-0008a210: 6573 2920 3e20 303a 0d0a 2020 2020 2020  es) > 0:..      
-0008a220: 2020 2323 2320 4275 696c 6420 4665 6174    ### Build Feat
-0008a230: 7572 6573 2062 6173 6564 206f 6e20 6769  ures based on gi
-0008a240: 7665 6e20 7072 696d 6974 6976 6520 7479  ven primitive ty
-0008a250: 7065 732c 2061 6464 5f74 7970 6573 2077  pes, add_types w
-0008a260: 6869 6368 2069 7320 6120 6c69 7374 0d0a  hich is a list..
-0008a270: 2020 2020 2020 2020 6466 5f6d 6f64 2c20          df_mod, 
-0008a280: 6665 6174 7572 655f 6465 6673 203d 2066  feature_defs = f
-0008a290: 742e 6466 7328 656e 7469 7479 7365 7420  t.dfs(entityset 
-0008a2a0: 3d20 6573 2c20 7461 7267 6574 5f65 6e74  = es, target_ent
-0008a2b0: 6974 7920 3d20 6461 7461 6964 2c0d 0a20  ity = dataid,.. 
-0008a2c0: 2020 2020 2020 2020 2020 2020 2020 2020                  
-0008a2d0: 2020 2020 2020 2020 2020 2020 7472 616e              tran
-0008a2e0: 735f 7072 696d 6974 6976 6573 203d 2061  s_primitives = a
-0008a2f0: 6464 5f74 7970 6573 290d 0a20 2020 2065  dd_types)..    e
-0008a300: 6c73 653a 0d0a 2020 2020 2020 2020 2323  lse:..        ##
-0008a310: 2320 5065 7266 6f72 6d20 4465 6570 2046  # Perform Deep F
-0008a320: 6561 7475 7265 2053 796e 7468 6573 6973  eature Synthesis
-0008a330: 2041 7574 6f6d 6174 6963 616c 6c79 2066   Automatically f
-0008a340: 6f72 2044 6570 7468 2032 0d0a 2020 2020  or Depth 2..    
-0008a350: 2020 2020 6466 5f6d 6f64 2c20 6665 6174      df_mod, feat
-0008a360: 7572 655f 6465 6673 203d 2066 742e 6466  ure_defs = ft.df
-0008a370: 7328 656e 7469 7479 7365 743d 6573 2c20  s(entityset=es, 
-0008a380: 7461 7267 6574 5f65 6e74 6974 7920 3d20  target_entity = 
-0008a390: 6461 7461 6964 2c0d 0a20 2020 2020 2020  dataid,..       
-0008a3a0: 2020 2020 2020 2020 2020 2020 2020 2020                  
-0008a3b0: 2020 2020 2020 206d 6178 5f64 6570 7468         max_depth
-0008a3c0: 203d 2032 2c20 6e5f 6a6f 6273 3d2d 312c   = 2, n_jobs=-1,
-0008a3d0: 0d0a 2020 2020 2020 2020 2020 2020 2020  ..              
-0008a3e0: 2020 2020 2020 2020 2020 2020 2020 2020                  
-0008a3f0: 7665 7262 6f73 6520 3d20 3029 0d0a 2020  verbose = 0)..  
-0008a400: 2020 6966 206d 616b 655f 696e 6465 783a    if make_index:
-0008a410: 0d0a 2020 2020 2020 2020 6466 5f6d 6f64  ..        df_mod
-0008a420: 203d 2064 665f 6d6f 642e 7265 7365 745f   = df_mod.reset_
-0008a430: 696e 6465 7828 6472 6f70 3d54 7275 6529  index(drop=True)
-0008a440: 0d0a 2020 2020 7265 7475 726e 2064 665f  ..    return df_
-0008a450: 6d6f 640d 0a0d 0a64 6566 2066 6561 7475  mod....def featu
-0008a460: 7265 5f65 6e67 696e 6565 7269 6e67 2864  re_engineering(d
-0008a470: 662c 2066 745f 7265 7175 6573 7473 2c20  f, ft_requests, 
-0008a480: 6964 636f 6c29 3a0d 0a20 2020 2022 2222  idcol):..    """
-0008a490: 0d0a 2020 2020 5468 6520 4665 6174 7572  ..    The Featur
-0008a4a0: 6520 456e 6769 6e65 6572 696e 6720 6d6f  e Engineering mo
-0008a4b0: 6475 6c65 206e 6565 6473 2046 6561 7475  dule needs Featu
-0008a4c0: 7265 546f 6f6c 7320 696e 7374 616c 6c65  reTools installe
-0008a4d0: 6420 746f 2077 6f72 6b2e 0d0a 2020 2020  d to work...    
-0008a4e0: 536f 2070 6c65 6173 6520 646f 2022 7069  So please do "pi
-0008a4f0: 7020 696e 7374 616c 6c20 6665 6174 7572  p install featur
-0008a500: 6574 6f6f 6c73 2220 6265 666f 7265 2074  etools" before t
-0008a510: 7279 696e 6720 6f75 7420 7468 6973 206d  rying out this m
-0008a520: 6f64 756c 652e 0d0a 2020 2020 4974 2074  odule...    It t
-0008a530: 616b 6573 2061 2067 6976 656e 2064 6174  akes a given dat
-0008a540: 6120 7365 742c 2064 6620 616e 6420 6164  a set, df and ad
-0008a550: 6473 2066 6561 7475 7265 7320 6261 7365  ds features base
-0008a560: 6420 6f6e 2074 6865 2072 6571 7565 7420  d on the requet 
-0008a570: 7479 7065 7320 696e 0d0a 2020 2020 6674  types in..    ft
-0008a580: 5f72 6571 7565 7374 7320 7768 6963 6820  _requests which 
-0008a590: 6361 6e20 6265 2027 6164 6427 2c27 7375  can be 'add','su
-0008a5a0: 6274 7261 6374 272c 276d 756c 7469 706c  btract','multipl
-0008a5b0: 7927 2c27 6469 7669 6465 272e 2049 6620  y','divide'. If 
-0008a5c0: 796f 7520 6861 7665 0d0a 2020 2020 616e  you have..    an
-0008a5d0: 2069 645f 636f 6c75 6d6e 2069 6e20 7468   id_column in th
-0008a5e0: 6520 6461 7461 2073 6574 2c20 796f 7520  e data set, you 
-0008a5f0: 6361 6e20 7072 6f76 6964 6520 6974 2061  can provide it a
-0008a600: 7320 6964 636f 6c20 2861 2073 7472 696e  s idcol (a strin
-0008a610: 6720 7661 7269 6162 6c65 292e 0d0a 2020  g variable)...  
-0008a620: 2020 4974 2077 696c 6c20 7265 7475 726e    It will return
-0008a630: 2079 6f75 7220 6d6f 6469 6669 6564 2064   your modified d
-0008a640: 6174 6173 6574 2077 6974 6820 2769 6463  ataset with 'idc
-0008a650: 6f6c 2720 6173 2074 6865 2069 6e64 6578  ol' as the index
-0008a660: 2e20 4d61 6b65 2073 7572 650d 0a20 2020  . Make sure..   
-0008a670: 2079 6f75 2072 6573 6574 2074 6865 2069   you reset the i
-0008a680: 6e64 6578 2069 6620 796f 7520 7761 6e74  ndex if you want
-0008a690: 2074 6f20 7265 7475 726e 2069 7420 746f   to return it to
-0008a6a0: 2069 7473 2066 6f72 6d65 7220 7374 6174   its former stat
-0008a6b0: 652e 0d0a 2020 2020 416c 736f 2064 6f20  e...    Also do 
-0008a6c0: 6e6f 7420 7365 6e64 2069 6e20 796f 7572  not send in your
-0008a6d0: 2065 6e74 6972 6520 6461 7461 6672 616d   entire datafram
-0008a6e0: 6521 204a 7573 7420 7365 6e64 2061 2073  e! Just send a s
-0008a6f0: 6d61 6c6c 2064 6174 6166 7261 6d65 2077  mall dataframe w
-0008a700: 6974 6820 6120 6665 7720 7661 7269 6162  ith a few variab
-0008a710: 6c65 732e 0d0a 2020 2020 4f6e 6365 2079  les...    Once y
-0008a720: 6f75 2073 6565 2068 6f77 2069 7420 6164  ou see how it ad
-0008a730: 6473 2074 6f20 7065 7266 6f72 6d61 6e63  ds to performanc
-0008a740: 6520 6f66 206d 6f64 656c 2c20 796f 7520  e of model, you 
-0008a750: 6361 6e20 6164 6420 6d6f 7265 2076 6172  can add more var
-0008a760: 6961 626c 6573 2074 6f20 6461 7461 6672  iables to datafr
-0008a770: 616d 652e 0d0a 2020 2020 2222 220d 0a20  ame...    """.. 
-0008a780: 2020 2064 6620 3d20 636f 7079 2e64 6565     df = copy.dee
-0008a790: 7063 6f70 7928 6466 290d 0a20 2020 2069  pcopy(df)..    i
-0008a7a0: 6620 6466 2e73 6861 7065 5b31 5d20 3c20  f df.shape[1] < 
-0008a7b0: 323a 0d0a 2020 2020 2020 2020 7072 696e  2:..        prin
-0008a7c0: 7428 274d 6f72 6520 7468 616e 206f 6e65  t('More than one
-0008a7d0: 2063 6f6c 756d 6e20 696e 2064 6174 6166   column in dataf
-0008a7e0: 7261 6d65 2072 6571 7569 7265 6420 746f  rame required to
-0008a7f0: 2070 6572 666f 726d 2066 6561 7475 7265   perform feature
-0008a800: 2065 6e67 696e 6565 7269 6e67 2e20 5265   engineering. Re
-0008a810: 7475 726e 696e 6727 290d 0a20 2020 2020  turning')..     
-0008a820: 2020 2072 6574 7572 6e20 6466 0d0a 2020     return df..  
-0008a830: 2020 6674 5f64 6963 7420 3d20 6469 6374    ft_dict = dict
-0008a840: 287a 6970 285b 2761 6464 272c 276d 756c  (zip(['add','mul
-0008a850: 7469 706c 7927 2c27 7375 6274 7261 6374  tiply','subtract
-0008a860: 272c 2764 6976 6964 6527 5d2c 0d0a 2020  ','divide'],..  
-0008a870: 2020 2020 2020 2020 2020 2020 2020 2020                  
-0008a880: 5b27 6164 645f 6e75 6d65 7269 6327 2c20  ['add_numeric', 
-0008a890: 276d 756c 7469 706c 795f 6e75 6d65 7269  'multiply_numeri
-0008a8a0: 6327 2c0d 0a20 2020 2020 2020 2020 2020  c',..           
-0008a8b0: 2027 7375 6274 7261 6374 5f6e 756d 6572   'subtract_numer
-0008a8c0: 6963 272c 2027 6469 7669 6465 5f6e 756d  ic', 'divide_num
-0008a8d0: 6572 6963 275d 2929 0d0a 2020 2020 6966  eric']))..    if
-0008a8e0: 206c 656e 2866 745f 7265 7175 6573 7473   len(ft_requests
-0008a8f0: 2920 3e20 303a 0d0a 2020 2020 2020 2020  ) > 0:..        
-0008a900: 6674 5f6c 6973 7420 3d20 5b5d 0d0a 2020  ft_list = []..  
-0008a910: 2020 2020 2020 666f 7220 6674 5f6f 6e65        for ft_one
-0008a920: 2069 6e20 6674 5f72 6571 7565 7374 733a   in ft_requests:
-0008a930: 0d0a 2020 2020 2020 2020 2020 2020 6966  ..            if
-0008a940: 2066 745f 6f6e 6520 696e 2066 745f 6469   ft_one in ft_di
-0008a950: 6374 2e6b 6579 7328 293a 0d0a 2020 2020  ct.keys():..    
-0008a960: 2020 2020 2020 2020 2020 2020 6674 5f6c              ft_l
-0008a970: 6973 742e 6170 7065 6e64 2866 745f 6469  ist.append(ft_di
-0008a980: 6374 5b66 745f 6f6e 655d 290d 0a20 2020  ct[ft_one])..   
-0008a990: 2020 2020 2020 2020 2065 6c73 653a 0d0a           else:..
-0008a9a0: 2020 2020 2020 2020 2020 2020 2020 2020                  
-0008a9b0: 7072 696e 7428 2720 2020 2043 616e 6e6f  print('    Canno
-0008a9c0: 7420 7065 7266 6f72 6d20 2573 2d74 7970  t perform %s-typ
-0008a9d0: 6520 6665 6174 7572 6520 656e 6769 6e65  e feature engine
-0008a9e0: 6572 696e 672e 2e2e 2720 2566 745f 6f6e  ering...' %ft_on
-0008a9f0: 6529 0d0a 2020 2020 2020 2020 636f 6c73  e)..        cols
-0008aa00: 203d 205b 7820 666f 7220 7820 696e 2064   = [x for x in d
-0008aa10: 662e 636f 6c75 6d6e 732e 746f 6c69 7374  f.columns.tolist
-0008aa20: 2829 2069 6620 7820 6e6f 7420 696e 205b  () if x not in [
-0008aa30: 6964 636f 6c5d 5d0d 0a20 2020 2020 2020  idcol]]..       
-0008aa40: 2066 6f72 2065 6163 685f 6674 2c20 636f   for each_ft, co
-0008aa50: 756e 7420 696e 207a 6970 2866 745f 6c69  unt in zip(ft_li
-0008aa60: 7374 2c20 7261 6e67 6528 6c65 6e28 6674  st, range(len(ft
-0008aa70: 5f6c 6973 7429 2929 3a0d 0a20 2020 2020  _list))):..     
-0008aa80: 2020 2020 2020 2069 6620 636f 756e 7420         if count 
-0008aa90: 3d3d 2030 3a0d 0a20 2020 2020 2020 2020  == 0:..         
-0008aaa0: 2020 2020 2020 2064 665f 6d6f 6420 3d20         df_mod = 
-0008aab0: 6164 645f 636f 6d70 7574 6174 696f 6e61  add_computationa
-0008aac0: 6c5f 7072 696d 6974 6976 655f 6665 6174  l_primitive_feat
-0008aad0: 7572 6573 2864 662c 5b65 6163 685f 6674  ures(df,[each_ft
-0008aae0: 5d2c 2069 6463 6f6c 290d 0a20 2020 2020  ], idcol)..     
-0008aaf0: 2020 2020 2020 2020 2020 2070 7269 6e74             print
-0008ab00: 2864 665f 6d6f 642e 7368 6170 6529 0d0a  (df_mod.shape)..
-0008ab10: 2020 2020 2020 2020 2020 2020 656c 7365              else
-0008ab20: 3a0d 0a20 2020 2020 2020 2020 2020 2020  :..             
-0008ab30: 2020 2064 665f 7465 6d70 203d 2061 6464     df_temp = add
-0008ab40: 5f63 6f6d 7075 7461 7469 6f6e 616c 5f70  _computational_p
-0008ab50: 7269 6d69 7469 7665 5f66 6561 7475 7265  rimitive_feature
-0008ab60: 7328 6466 2c5b 6561 6368 5f66 745d 2c20  s(df,[each_ft], 
-0008ab70: 6964 636f 6c29 0d0a 2020 2020 2020 2020  idcol)..        
-0008ab80: 2020 2020 2020 2020 6466 5f74 656d 702e          df_temp.
-0008ab90: 6472 6f70 2863 6f6c 732c 6178 6973 3d31  drop(cols,axis=1
-0008aba0: 2c69 6e70 6c61 6365 3d54 7275 6529 0d0a  ,inplace=True)..
-0008abb0: 2020 2020 2020 2020 2020 2020 2020 2020                  
-0008abc0: 6466 5f6d 6f64 203d 2070 642e 636f 6e63  df_mod = pd.conc
-0008abd0: 6174 285b 6466 5f6d 6f64 2c64 665f 7465  at([df_mod,df_te
-0008abe0: 6d70 5d2c 6178 6973 3d31 2c69 676e 6f72  mp],axis=1,ignor
-0008abf0: 655f 696e 6465 783d 4661 6c73 6529 0d0a  e_index=False)..
-0008ac00: 2020 2020 2020 2020 2020 2020 2020 2020                  
-0008ac10: 7072 696e 7428 6466 5f6d 6f64 2e73 6861  print(df_mod.sha
-0008ac20: 7065 290d 0a20 2020 2065 6c73 653a 0d0a  pe)..    else:..
-0008ac30: 2020 2020 2020 2020 6466 5f6d 6f64 203d          df_mod =
-0008ac40: 2061 6464 5f63 6f6d 7075 7461 7469 6f6e   add_computation
-0008ac50: 616c 5f70 7269 6d69 7469 7665 5f66 6561  al_primitive_fea
-0008ac60: 7475 7265 7328 6466 2c5b 5d2c 2069 6463  tures(df,[], idc
-0008ac70: 6f6c 290d 0a20 2020 2072 6574 7572 6e20  ol)..    return 
-0008ac80: 6466 5f6d 6f64 0d0a 0d0a 0d0a 6465 6620  df_mod......def 
-0008ac90: 6164 645f 6461 7465 5f74 696d 655f 6665  add_date_time_fe
-0008aca0: 6174 7572 6573 2873 6d61 6c6c 6466 2c20  atures(smalldf, 
-0008acb0: 7374 6172 7454 696d 652c 2065 6e64 5469  startTime, endTi
-0008acc0: 6d65 2c20 7370 6c69 7474 6572 5f64 6174  me, splitter_dat
-0008acd0: 655f 7374 7269 6e67 3d22 2f22 2c73 706c  e_string="/",spl
-0008ace0: 6974 7465 725f 686f 7572 5f73 7472 696e  itter_hour_strin
-0008acf0: 673d 223a 2229 3a0d 0a20 2020 2022 2222  g=":"):..    """
-0008ad00: 0d0a 2020 2020 4966 2079 6f75 2068 6176  ..    If you hav
-0008ad10: 6520 7374 6172 7420 6461 7465 2074 696d  e start date tim
-0008ad20: 6520 7374 616d 7020 616e 6420 656e 6420  e stamp and end 
-0008ad30: 6461 7465 2074 696d 6520 7374 616d 702c  date time stamp,
-0008ad40: 2074 6869 7320 6d6f 6475 6c65 2077 696c   this module wil
-0008ad50: 6c20 6372 6561 7465 2061 6464 6974 696f  l create additio
-0008ad60: 6e61 6c20 6665 6174 7572 6573 2066 6f72  nal features for
-0008ad70: 2073 7563 6820 6669 656c 6473 2e0d 0a20   such fields... 
-0008ad80: 2020 2059 6f75 206d 7573 7420 7072 6f76     You must prov
-0008ad90: 6964 6520 6120 7374 6172 7420 6461 7465  ide a start date
-0008ada0: 2074 696d 6520 7374 616d 7020 6669 656c   time stamp fiel
-0008adb0: 6420 616e 6420 6966 2079 6f75 2068 6176  d and if you hav
-0008adc0: 6520 616e 2065 6e64 2064 6174 6520 7469  e an end date ti
-0008add0: 6d65 2073 7461 6d70 2066 6965 6c64 2c20  me stamp field, 
-0008ade0: 796f 7520 6d75 7374 2075 7365 2069 742e  you must use it.
-0008adf0: 0d0a 2020 2020 4f74 6865 7277 6973 652c  ..    Otherwise,
-0008ae00: 2079 6f75 2061 7265 2062 6574 7465 7220   you are better 
-0008ae10: 6f66 6620 7573 696e 6720 7468 6520 6372  off using the cr
-0008ae20: 6561 7465 5f64 6174 655f 7469 6d65 5f66  eate_date_time_f
-0008ae30: 6561 7475 7265 7320 6d6f 6475 6c65 2077  eatures module w
-0008ae40: 6869 6368 2069 7320 616c 736f 2069 6e20  hich is also in 
-0008ae50: 7468 6973 206c 6962 7261 7279 2e0d 0a20  this library... 
-0008ae60: 2020 2059 6f75 206d 7573 7420 7072 6f76     You must prov
-0008ae70: 6964 6520 7468 6520 666f 6c6c 6f77 696e  ide the followin
-0008ae80: 673a 0d0a 2020 2020 736d 616c 6c64 663a  g:..    smalldf:
-0008ae90: 2044 6174 6166 7261 6d65 2063 6f6e 7461   Dataframe conta
-0008aea0: 696e 696e 6720 796f 7572 2064 6174 6520  ining your date 
-0008aeb0: 7469 6d65 2066 6965 6c64 730d 0a20 2020  time fields..   
-0008aec0: 2073 7461 7274 5469 6d65 3a20 7468 6973   startTime: this
-0008aed0: 2069 7320 686f 7065 6675 6c6c 7920 6120   is hopefully a 
-0008aee0: 7374 7269 6e67 2066 6965 6c64 2077 6869  string field whi
-0008aef0: 6368 2063 6f6e 7665 7274 7320 746f 2061  ch converts to a
-0008af00: 2064 6174 6520 7469 6d65 2073 7461 6d70   date time stamp
-0008af10: 2065 6173 696c 792e 204d 616b 6520 7375   easily. Make su
-0008af20: 7265 2069 7420 6973 2061 2073 7472 696e  re it is a strin
-0008af30: 672e 0d0a 2020 2020 656e 6454 696d 653a  g...    endTime:
-0008af40: 2074 6869 7320 616c 736f 206d 7573 7420   this also must 
-0008af50: 6265 2061 2073 7472 696e 6720 6669 656c  be a string fiel
-0008af60: 6420 7768 6963 6820 636f 6e76 6572 7473  d which converts
-0008af70: 2074 6f20 6120 6461 7465 2074 696d 6520   to a date time 
-0008af80: 7374 616d 7020 6561 7369 6c79 2e20 4d61  stamp easily. Ma
-0008af90: 6b65 2073 7572 6520 6974 2069 7320 6120  ke sure it is a 
-0008afa0: 7374 7269 6e67 2e0d 0a20 2020 2073 706c  string...    spl
-0008afb0: 6974 7465 725f 6461 7465 5f73 7472 696e  itter_date_strin
-0008afc0: 673a 2075 7375 616c 6c79 2074 6865 7265  g: usually there
-0008afd0: 2069 7320 6120 7374 7269 6e67 2073 7563   is a string suc
-0008afe0: 6820 6173 2027 2f27 206f 7220 272e 2720  h as '/' or '.' 
-0008aff0: 6265 7477 6565 6e20 6461 792f 6d6f 6e74  between day/mont
-0008b000: 682f 7965 6172 2065 7463 2e20 4465 6661  h/year etc. Defa
-0008b010: 756c 7420 6973 2061 7373 756d 6564 202f  ult is assumed /
-0008b020: 2068 6572 652e 0d0a 2020 2020 7370 6c69   here...    spli
-0008b030: 7474 6572 5f68 6f75 725f 7374 7269 6e67  tter_hour_string
-0008b040: 3a20 7573 7561 6c6c 7920 7468 6572 6520  : usually there 
-0008b050: 6973 2061 2073 7472 696e 6720 7375 6368  is a string such
-0008b060: 2061 7320 273a 2720 6f72 2027 2e27 2062   as ':' or '.' b
-0008b070: 6574 7765 656e 2068 6f75 723a 6d69 6e3a  etween hour:min:
-0008b080: 7365 6320 6574 632e 2044 6566 6175 6c74  sec etc. Default
-0008b090: 2069 7320 6173 7375 6d65 6420 3a20 6865   is assumed : he
-0008b0a0: 7265 2e0d 0a20 2020 2022 2222 0d0a 2020  re...    """..  
-0008b0b0: 2020 736d 616c 6c64 6620 3d20 736d 616c    smalldf = smal
-0008b0c0: 6c64 662e 636f 7079 2829 0d0a 2020 2020  ldf.copy()..    
-0008b0d0: 6164 645f 636f 6c73 203d 205b 5d0d 0a20  add_cols = [].. 
-0008b0e0: 2020 2073 7461 7274 5f64 6174 6520 3d20     start_date = 
-0008b0f0: 2770 726f 6365 7373 696e 6727 2b73 7461  'processing'+sta
-0008b100: 7274 5469 6d65 2b27 5f73 7461 7274 5f64  rtTime+'_start_d
-0008b110: 6174 6527 0d0a 2020 2020 736d 616c 6c64  ate'..    smalld
-0008b120: 665b 7374 6172 745f 6461 7465 5d20 3d20  f[start_date] = 
-0008b130: 736d 616c 6c64 665b 7374 6172 7454 696d  smalldf[startTim
-0008b140: 655d 2e6d 6170 286c 616d 6264 6120 783a  e].map(lambda x:
-0008b150: 2078 2e73 706c 6974 2822 2022 295b 305d   x.split(" ")[0]
-0008b160: 290d 0a20 2020 2061 6464 5f63 6f6c 732e  )..    add_cols.
-0008b170: 6170 7065 6e64 2873 7461 7274 5f64 6174  append(start_dat
-0008b180: 6529 0d0a 2020 2020 7472 793a 0d0a 2020  e)..    try:..  
-0008b190: 2020 2020 2020 7374 6172 745f 7469 6d65        start_time
-0008b1a0: 203d 2027 7072 6f63 6573 7369 6e67 272b   = 'processing'+
-0008b1b0: 7374 6172 7454 696d 652b 275f 7374 6172  startTime+'_star
-0008b1c0: 745f 7469 6d65 270d 0a20 2020 2020 2020  t_time'..       
-0008b1d0: 2073 6d61 6c6c 6466 5b73 7461 7274 5f74   smalldf[start_t
-0008b1e0: 696d 655d 203d 2073 6d61 6c6c 6466 5b73  ime] = smalldf[s
-0008b1f0: 7461 7274 5469 6d65 5d2e 6d61 7028 6c61  tartTime].map(la
-0008b200: 6d62 6461 2078 3a20 782e 7370 6c69 7428  mbda x: x.split(
-0008b210: 2220 2229 5b31 5d29 0d0a 2020 2020 2020  " ")[1])..      
-0008b220: 2020 6164 645f 636f 6c73 2e61 7070 656e    add_cols.appen
-0008b230: 6428 7374 6172 745f 7469 6d65 290d 0a20  d(start_time).. 
-0008b240: 2020 2065 7863 6570 743a 0d0a 2020 2020     except:..    
-0008b250: 2020 2020 2323 2320 7468 6572 6520 6973      ### there is
-0008b260: 206e 6f20 686f 7572 2d6d 696e 7574 6573   no hour-minutes
-0008b270: 2070 6172 7420 6f66 2074 6869 7320 6461   part of this da
-0008b280: 7465 2074 696d 6520 7374 616d 7020 6669  te time stamp fi
-0008b290: 656c 642e 2059 6f75 2063 616e 206a 7573  eld. You can jus
-0008b2a0: 7420 736b 6970 2069 7420 6966 2069 7420  t skip it if it 
-0008b2b0: 6973 206e 6f74 2074 6865 7265 0d0a 2020  is not there..  
-0008b2c0: 2020 2020 2020 7061 7373 0d0a 2020 2020        pass..    
-0008b2d0: 656e 645f 6461 7465 203d 2027 7072 6f63  end_date = 'proc
-0008b2e0: 6573 7369 6e67 272b 656e 6454 696d 652b  essing'+endTime+
-0008b2f0: 275f 656e 645f 6461 7465 270d 0a20 2020  '_end_date'..   
-0008b300: 2073 6d61 6c6c 6466 5b65 6e64 5f64 6174   smalldf[end_dat
-0008b310: 655d 203d 2073 6d61 6c6c 6466 5b65 6e64  e] = smalldf[end
-0008b320: 5469 6d65 5d2e 6d61 7028 6c61 6d62 6461  Time].map(lambda
-0008b330: 2078 3a20 782e 7370 6c69 7428 2220 2229   x: x.split(" ")
-0008b340: 5b30 5d29 0d0a 2020 2020 6164 645f 636f  [0])..    add_co
-0008b350: 6c73 2e61 7070 656e 6428 656e 645f 6461  ls.append(end_da
-0008b360: 7465 290d 0a20 2020 2074 7279 3a0d 0a20  te)..    try:.. 
-0008b370: 2020 2020 2020 2065 6e64 5f74 696d 6520         end_time 
-0008b380: 3d20 2770 726f 6365 7373 696e 6727 2b65  = 'processing'+e
-0008b390: 6e64 5469 6d65 2b27 5f65 6e64 5f74 696d  ndTime+'_end_tim
-0008b3a0: 6527 0d0a 2020 2020 2020 2020 736d 616c  e'..        smal
-0008b3b0: 6c64 665b 656e 645f 7469 6d65 5d20 3d20  ldf[end_time] = 
-0008b3c0: 736d 616c 6c64 665b 656e 6454 696d 655d  smalldf[endTime]
-0008b3d0: 2e6d 6170 286c 616d 6264 6120 783a 2078  .map(lambda x: x
-0008b3e0: 2e73 706c 6974 2822 2022 295b 315d 290d  .split(" ")[1]).
-0008b3f0: 0a20 2020 2020 2020 2061 6464 5f63 6f6c  .        add_col
-0008b400: 732e 6170 7065 6e64 2865 6e64 5f74 696d  s.append(end_tim
-0008b410: 6529 0d0a 2020 2020 6578 6365 7074 3a0d  e)..    except:.
-0008b420: 0a20 2020 2020 2020 2023 2323 2074 6865  .        ### the
-0008b430: 7265 2069 7320 6e6f 2068 6f75 722d 6d69  re is no hour-mi
-0008b440: 6e75 7465 7320 7061 7274 206f 6620 7468  nutes part of th
-0008b450: 6973 2064 6174 6520 7469 6d65 2073 7461  is date time sta
-0008b460: 6d70 2066 6965 6c64 2e20 596f 7520 6361  mp field. You ca
-0008b470: 6e20 6a75 7374 2073 6b69 7020 6974 2069  n just skip it i
-0008b480: 6620 6974 2069 7320 6e6f 7420 7468 6572  f it is not ther
-0008b490: 650d 0a20 2020 2020 2020 2070 6173 730d  e..        pass.
-0008b4a0: 0a20 2020 2076 6965 775f 6461 7973 203d  .    view_days =
-0008b4b0: 2027 7072 6f63 6573 7369 6e67 272b 7374   'processing'+st
-0008b4c0: 6172 7454 696d 652b 275f 656c 6170 7365  artTime+'_elapse
-0008b4d0: 645f 6461 7973 270d 0a20 2020 2073 6d61  d_days'..    sma
-0008b4e0: 6c6c 6466 5b76 6965 775f 6461 7973 5d20  lldf[view_days] 
-0008b4f0: 3d20 2870 642e 746f 5f64 6174 6574 696d  = (pd.to_datetim
-0008b500: 6528 736d 616c 6c64 665b 656e 645f 6461  e(smalldf[end_da
-0008b510: 7465 5d29 202d 2070 642e 746f 5f64 6174  te]) - pd.to_dat
-0008b520: 6574 696d 6528 736d 616c 6c64 665b 7374  etime(smalldf[st
-0008b530: 6172 745f 6461 7465 5d29 292e 7661 6c75  art_date])).valu
-0008b540: 6573 2e61 7374 7970 6528 696e 7429 0d0a  es.astype(int)..
-0008b550: 2020 2020 6164 645f 636f 6c73 2e61 7070      add_cols.app
-0008b560: 656e 6428 7669 6577 5f64 6179 7329 0d0a  end(view_days)..
-0008b570: 2020 2020 7472 793a 0d0a 2020 2020 2020      try:..      
-0008b580: 2020 7669 6577 5f74 696d 6520 3d20 2770    view_time = 'p
-0008b590: 726f 6365 7373 696e 6727 2b73 7461 7274  rocessing'+start
-0008b5a0: 5469 6d65 2b27 5f65 6c61 7073 6564 5f74  Time+'_elapsed_t
-0008b5b0: 696d 6527 0d0a 2020 2020 2020 2020 736d  ime'..        sm
-0008b5c0: 616c 6c64 665b 7669 6577 5f74 696d 655d  alldf[view_time]
-0008b5d0: 203d 2028 7064 2e74 6f5f 6461 7465 7469   = (pd.to_dateti
-0008b5e0: 6d65 2873 6d61 6c6c 6466 5b65 6e64 5f74  me(smalldf[end_t
-0008b5f0: 696d 655d 2920 2d20 7064 2e74 6f5f 6461  ime]) - pd.to_da
-0008b600: 7465 7469 6d65 2873 6d61 6c6c 6466 5b73  tetime(smalldf[s
-0008b610: 7461 7274 5f74 696d 655d 2929 2e61 7374  tart_time])).ast
-0008b620: 7970 6528 2774 696d 6564 656c 7461 3634  ype('timedelta64
-0008b630: 5b73 5d27 292e 7661 6c75 6573 0d0a 2020  [s]').values..  
-0008b640: 2020 2020 2020 6164 645f 636f 6c73 2e61        add_cols.a
-0008b650: 7070 656e 6428 7669 6577 5f74 696d 6529  ppend(view_time)
-0008b660: 0d0a 2020 2020 6578 6365 7074 3a0d 0a20  ..    except:.. 
-0008b670: 2020 2020 2020 2023 2323 2049 6e20 736f         ### In so
-0008b680: 6d65 2064 6174 6520 7469 6d65 2066 6965  me date time fie
-0008b690: 6c64 7320 7468 6973 2067 6976 6573 2061  lds this gives a
-0008b6a0: 6e20 6572 726f 7220 736f 2073 6b69 7020  n error so skip 
-0008b6b0: 6974 2069 6e20 7468 6174 2063 6173 650d  it in that case.
-0008b6c0: 0a20 2020 2020 2020 2070 6173 730d 0a20  .        pass.. 
-0008b6d0: 2020 2023 2323 2320 5468 6520 7265 6173     #### The reas
-0008b6e0: 6f6e 2077 6520 6368 6f73 6520 656e 6454  on we chose endT
-0008b6f0: 696d 6520 6865 7265 2069 7320 7468 6174  ime here is that
-0008b700: 2073 7461 7274 5469 6d65 2069 7320 7573   startTime is us
-0008b710: 7561 6c6c 7920 7461 6b65 6e20 6361 7265  ually taken care
-0008b720: 206f 6620 6279 2061 6e6f 7468 6572 206c   of by another l
-0008b730: 6962 7261 7279 2e20 536f 2062 6574 7465  ibrary. So bette
-0008b740: 7220 746f 2064 6f20 7468 6973 2061 6c6f  r to do this alo
-0008b750: 6e65 2e0d 0a20 2020 2079 6561 7220 3d20  ne...    year = 
-0008b760: 2770 726f 6365 7373 696e 6727 2b65 6e64  'processing'+end
-0008b770: 5469 6d65 2b27 5f65 6e64 5f79 6561 7227  Time+'_end_year'
-0008b780: 0d0a 2020 2020 736d 616c 6c64 665b 7965  ..    smalldf[ye
-0008b790: 6172 5d20 3d20 736d 616c 6c64 665b 656e  ar] = smalldf[en
-0008b7a0: 645f 6461 7465 5d2e 6d61 7028 6c61 6d62  d_date].map(lamb
-0008b7b0: 6461 2078 3a20 7374 7228 7829 2e73 706c  da x: str(x).spl
-0008b7c0: 6974 2873 706c 6974 7465 725f 6461 7465  it(splitter_date
-0008b7d0: 5f73 7472 696e 6729 5b30 5d29 2e76 616c  _string)[0]).val
-0008b7e0: 7565 730d 0a20 2020 2061 6464 5f63 6f6c  ues..    add_col
-0008b7f0: 732e 6170 7065 6e64 2879 6561 7229 0d0a  s.append(year)..
-0008b800: 2020 2020 2323 2323 2054 6865 2072 6561      #### The rea
-0008b810: 736f 6e20 7765 2063 686f 7365 2065 6e64  son we chose end
-0008b820: 5469 6d65 2068 6572 6520 6973 2074 6861  Time here is tha
-0008b830: 7420 7374 6172 7454 696d 6520 6973 2075  t startTime is u
-0008b840: 7375 616c 6c79 2074 616b 656e 2063 6172  sually taken car
-0008b850: 6520 6f66 2062 7920 616e 6f74 6865 7220  e of by another 
-0008b860: 6c69 6272 6172 792e 2053 6f20 6265 7474  library. So bett
-0008b870: 6572 2074 6f20 646f 2074 6869 7320 616c  er to do this al
-0008b880: 6f6e 652e 0d0a 2020 2020 6d6f 6e74 6820  one...    month 
-0008b890: 3d20 2770 726f 6365 7373 696e 6727 2b65  = 'processing'+e
-0008b8a0: 6e64 5469 6d65 2b27 5f65 6e64 5f6d 6f6e  ndTime+'_end_mon
-0008b8b0: 7468 270d 0a20 2020 2073 6d61 6c6c 6466  th'..    smalldf
-0008b8c0: 5b6d 6f6e 7468 5d20 3d20 736d 616c 6c64  [month] = smalld
-0008b8d0: 665b 656e 645f 6461 7465 5d2e 6d61 7028  f[end_date].map(
-0008b8e0: 6c61 6d62 6461 2078 3a20 7374 7228 7829  lambda x: str(x)
-0008b8f0: 2e73 706c 6974 2873 706c 6974 7465 725f  .split(splitter_
-0008b900: 6461 7465 5f73 7472 696e 6729 5b31 5d29  date_string)[1])
-0008b910: 2e76 616c 7565 730d 0a20 2020 2061 6464  .values..    add
-0008b920: 5f63 6f6c 732e 6170 7065 6e64 286d 6f6e  _cols.append(mon
-0008b930: 7468 290d 0a20 2020 2074 7279 3a0d 0a20  th)..    try:.. 
-0008b940: 2020 2020 2020 2023 2323 2320 5468 6520         #### The 
-0008b950: 7265 6173 6f6e 2077 6520 6368 6f73 6520  reason we chose 
-0008b960: 656e 6454 696d 6520 6865 7265 2069 7320  endTime here is 
-0008b970: 7468 6174 2073 7461 7274 5469 6d65 2069  that startTime i
-0008b980: 7320 7573 7561 6c6c 7920 7461 6b65 6e20  s usually taken 
-0008b990: 6361 7265 206f 6620 6279 2061 6e6f 7468  care of by anoth
-0008b9a0: 6572 206c 6962 7261 7279 2e20 536f 2062  er library. So b
-0008b9b0: 6574 7465 7220 746f 2064 6f20 7468 6973  etter to do this
-0008b9c0: 2061 6c6f 6e65 2e0d 0a20 2020 2020 2020   alone...       
-0008b9d0: 2064 6179 6e75 6d20 3d20 2770 726f 6365   daynum = 'proce
-0008b9e0: 7373 696e 6727 2b65 6e64 5469 6d65 2b27  ssing'+endTime+'
-0008b9f0: 5f65 6e64 5f64 6179 5f6e 756d 6265 7227  _end_day_number'
-0008ba00: 0d0a 2020 2020 2020 2020 736d 616c 6c64  ..        smalld
-0008ba10: 665b 6461 796e 756d 5d20 3d20 736d 616c  f[daynum] = smal
-0008ba20: 6c64 665b 656e 645f 6461 7465 5d2e 6d61  ldf[end_date].ma
-0008ba30: 7028 6c61 6d62 6461 2078 3a20 7374 7228  p(lambda x: str(
-0008ba40: 7829 2e73 706c 6974 2873 706c 6974 7465  x).split(splitte
-0008ba50: 725f 6461 7465 5f73 7472 696e 6729 5b32  r_date_string)[2
-0008ba60: 5d29 2e76 616c 7565 730d 0a20 2020 2020  ]).values..     
-0008ba70: 2020 2061 6464 5f63 6f6c 732e 6170 7065     add_cols.appe
-0008ba80: 6e64 2864 6179 6e75 6d29 0d0a 2020 2020  nd(daynum)..    
-0008ba90: 6578 6365 7074 3a0d 0a20 2020 2020 2020  except:..       
-0008baa0: 2023 2323 2049 6e20 736f 6d65 2064 6174   ### In some dat
-0008bab0: 6520 7469 6d65 2066 6965 6c64 7320 7468  e time fields th
-0008bac0: 6520 6461 7920 6e75 6d62 6572 2069 7320  e day number is 
-0008bad0: 6e6f 7420 7468 6572 652e 2049 6620 6e6f  not there. If no
-0008bae0: 742c 206a 7573 7420 736b 6970 2069 7420  t, just skip it 
-0008baf0: 2323 2323 0d0a 2020 2020 2020 2020 7061  ####..        pa
-0008bb00: 7373 0d0a 2020 2020 2323 2323 2049 6e20  ss..    #### In 
-0008bb10: 736f 6d65 2064 6174 6520 7469 6d65 2066  some date time f
-0008bb20: 6965 6c64 732c 2074 6865 2068 6f75 7220  ields, the hour 
-0008bb30: 616e 6420 6d69 6e75 7465 2069 7320 6e6f  and minute is no
-0008bb40: 7420 7468 6572 652c 2073 6f20 736b 6970  t there, so skip
-0008bb50: 2069 7420 696e 2074 6861 7420 6361 7365   it in that case
-0008bb60: 2069 6620 6974 2065 7272 6f72 7321 0d0a   if it errors!..
-0008bb70: 2020 2020 7472 793a 0d0a 2020 2020 2020      try:..      
-0008bb80: 2020 7374 6172 745f 686f 7572 203d 2027    start_hour = '
-0008bb90: 7072 6f63 6573 7369 6e67 272b 7374 6172  processing'+star
-0008bba0: 7454 696d 652b 275f 7374 6172 745f 686f  tTime+'_start_ho
-0008bbb0: 7572 270d 0a20 2020 2020 2020 2073 6d61  ur'..        sma
-0008bbc0: 6c6c 6466 5b73 7461 7274 5f68 6f75 725d  lldf[start_hour]
-0008bbd0: 203d 2073 6d61 6c6c 6466 5b73 7461 7274   = smalldf[start
-0008bbe0: 5f74 696d 655d 2e6d 6170 286c 616d 6264  _time].map(lambd
-0008bbf0: 6120 783a 2073 7472 2878 292e 7370 6c69  a x: str(x).spli
-0008bc00: 7428 7370 6c69 7474 6572 5f68 6f75 725f  t(splitter_hour_
-0008bc10: 7374 7269 6e67 295b 305d 292e 7661 6c75  string)[0]).valu
-0008bc20: 6573 0d0a 2020 2020 2020 2020 6164 645f  es..        add_
-0008bc30: 636f 6c73 2e61 7070 656e 6428 7374 6172  cols.append(star
-0008bc40: 745f 686f 7572 290d 0a20 2020 2020 2020  t_hour)..       
-0008bc50: 2073 7461 7274 5f6d 696e 203d 2027 7072   start_min = 'pr
-0008bc60: 6f63 6573 7369 6e67 272b 7374 6172 7454  ocessing'+startT
-0008bc70: 696d 652b 275f 7374 6172 745f 686f 7572  ime+'_start_hour
-0008bc80: 270d 0a20 2020 2020 2020 2073 6d61 6c6c  '..        small
-0008bc90: 6466 5b73 7461 7274 5f6d 696e 5d20 3d20  df[start_min] = 
-0008bca0: 736d 616c 6c64 665b 7374 6172 745f 7469  smalldf[start_ti
-0008bcb0: 6d65 5d2e 6d61 7028 6c61 6d62 6461 2078  me].map(lambda x
-0008bcc0: 3a20 7374 7228 7829 2e73 706c 6974 2873  : str(x).split(s
-0008bcd0: 706c 6974 7465 725f 686f 7572 5f73 7472  plitter_hour_str
-0008bce0: 696e 6729 5b31 5d29 2e76 616c 7565 730d  ing)[1]).values.
-0008bcf0: 0a20 2020 2020 2020 2061 6464 5f63 6f6c  .        add_col
-0008bd00: 732e 6170 7065 6e64 2873 7461 7274 5f6d  s.append(start_m
-0008bd10: 696e 290d 0a20 2020 2065 7863 6570 743a  in)..    except:
-0008bd20: 0d0a 2020 2020 2020 2020 2323 2320 4966  ..        ### If
-0008bd30: 2069 7420 6572 726f 7273 2c20 736b 6970   it errors, skip
-0008bd40: 2069 740d 0a20 2020 2020 2020 2070 6173   it..        pas
-0008bd50: 730d 0a20 2020 2023 2323 2320 4368 6563  s..    #### Chec
-0008bd60: 6b20 6966 2074 6865 7265 2069 7320 6120  k if there is a 
-0008bd70: 7765 656b 6461 7920 616e 6420 7765 656b  weekday and week
-0008bd80: 656e 6473 2069 6e20 6461 7465 2074 696d  ends in date tim
-0008bd90: 6520 636f 6c75 6d6e 7320 7573 696e 6720  e columns using 
-0008bda0: 656e 6454 696d 6520 6f6e 6c79 0d0a 2020  endTime only..  
-0008bdb0: 2020 7765 656b 6461 795f 6e75 6d20 3d20    weekday_num = 
-0008bdc0: 2770 726f 6365 7373 696e 6727 2b65 6e64  'processing'+end
-0008bdd0: 5469 6d65 2b27 5f65 6e64 5f77 6565 6b64  Time+'_end_weekd
-0008bde0: 6179 5f6e 756d 6265 7227 0d0a 2020 2020  ay_number'..    
-0008bdf0: 736d 616c 6c64 665b 7765 656b 6461 795f  smalldf[weekday_
-0008be00: 6e75 6d5d 203d 2070 642e 746f 5f64 6174  num] = pd.to_dat
-0008be10: 6574 696d 6528 736d 616c 6c64 665b 656e  etime(smalldf[en
-0008be20: 645f 6461 7465 5d29 2e64 742e 7765 656b  d_date]).dt.week
-0008be30: 6461 792e 7661 6c75 6573 0d0a 2020 2020  day.values..    
-0008be40: 6164 645f 636f 6c73 2e61 7070 656e 6428  add_cols.append(
-0008be50: 7765 656b 6461 795f 6e75 6d29 0d0a 2020  weekday_num)..  
-0008be60: 2020 7765 656b 656e 6420 3d20 2770 726f    weekend = 'pro
-0008be70: 6365 7373 696e 6727 2b65 6e64 5469 6d65  cessing'+endTime
-0008be80: 2b27 5f65 6e64 5f77 6565 6b65 6e64 5f66  +'_end_weekend_f
-0008be90: 6c61 6727 0d0a 2020 2020 736d 616c 6c64  lag'..    smalld
-0008bea0: 665b 7765 656b 656e 645d 203d 2073 6d61  f[weekend] = sma
-0008beb0: 6c6c 6466 5b77 6565 6b64 6179 5f6e 756d  lldf[weekday_num
-0008bec0: 5d2e 6d61 7028 6c61 6d62 6461 2078 3a20  ].map(lambda x: 
-0008bed0: 3120 6966 2078 2069 6e5b 352c 365d 2065  1 if x in[5,6] e
-0008bee0: 6c73 6520 3029 0d0a 2020 2020 6164 645f  lse 0)..    add_
-0008bef0: 636f 6c73 2e61 7070 656e 6428 7765 656b  cols.append(week
-0008bf00: 656e 6429 0d0a 2020 2020 2323 2323 2049  end)..    #### I
-0008bf10: 6620 6576 6572 7974 6869 6e67 2077 6f72  f everything wor
-0008bf20: 6b73 2077 656c 6c2c 2074 6865 7265 2073  ks well, there s
-0008bf30: 686f 756c 6420 6265 2031 3320 6e65 7720  hould be 13 new 
-0008bf40: 636f 6c75 6d6e 7320 6164 6465 6420 6279  columns added by
-0008bf50: 206d 6f64 756c 652e 2041 6c6c 2074 6865   module. All the
-0008bf60: 2062 6573 7421 0d0a 2020 2020 7072 696e   best!..    prin
-0008bf70: 7428 2725 6420 636f 6c75 6d6e 7320 6164  t('%d columns ad
-0008bf80: 6465 6420 7573 696e 6720 7374 6172 7420  ded using start 
-0008bf90: 6461 7465 3d25 7320 616e 6420 656e 6420  date=%s and end 
-0008bfa0: 6461 7465 3d25 7320 7072 6f63 6573 7369  date=%s processi
-0008bfb0: 6e67 2e2e 2e27 2025 286c 656e 2861 6464  ng...' %(len(add
-0008bfc0: 5f63 6f6c 7329 2c73 7461 7274 5469 6d65  _cols),startTime
-0008bfd0: 2c65 6e64 5469 6d65 2929 0d0a 2020 2020  ,endTime))..    
-0008bfe0: 7265 7475 726e 2073 6d61 6c6c 6466 0d0a  return smalldf..
-0008bff0: 230d 0a23 2323 2323 2323 2323 2323 2323  #..#############
-0008c000: 2323 2323 2323 2323 2323 2323 2323 2323  ################
-0008c010: 2323 2323 2323 2323 2323 2323 2323 2323  ################
-0008c020: 2323 2323 2323 2323 2323 2323 2323 2323  ################
-0008c030: 2323 2323 2323 2323 2323 2323 2323 2323  ################
-0008c040: 2323 2323 0d0a 6465 6620 7370 6c69 745f  ####..def split_
-0008c050: 6f6e 655f 6669 656c 645f 696e 746f 5f6d  one_field_into_m
-0008c060: 616e 7928 6466 2c20 6669 656c 642c 2073  any(df, field, s
-0008c070: 706c 6974 7465 722c 2066 696c 6c65 722c  plitter, filler,
-0008c080: 206e 6577 5f6e 616d 6573 5f6c 6973 7429   new_names_list)
-0008c090: 3a0d 0a20 2020 2022 2222 0d0a 2020 2020  :..    """..    
-0008c0a0: 5468 6973 206c 6974 746c 6520 6675 6e63  This little func
-0008c0b0: 7469 6f6e 2074 616b 6573 2061 6e79 2064  tion takes any d
-0008c0c0: 6174 6120 6672 616d 6520 6669 656c 6420  ata frame field 
-0008c0d0: 2873 7472 696e 6720 7661 7269 6162 6c65  (string variable
-0008c0e0: 7320 6f6e 6c79 2920 616e 6420 7370 6c69  s only) and spli
-0008c0f0: 7473 0d0a 2020 2020 6974 2069 6e74 6f20  ts..    it into 
-0008c100: 6173 206d 616e 7920 6669 656c 6473 2061  as many fields a
-0008c110: 7320 796f 7520 7761 6e74 2069 6e20 7468  s you want in th
-0008c120: 6520 6e65 775f 6e61 6d65 735f 6c69 7374  e new_names_list
-0008c130: 2e0d 0a20 2020 2059 6f75 2063 616e 2061  ...    You can a
-0008c140: 6c73 6f20 7370 6563 6966 7920 7768 6174  lso specify what
-0008c150: 2073 7472 696e 6720 746f 2073 706c 6974   string to split
-0008c160: 206f 6e20 7573 696e 6720 7468 6520 7370   on using the sp
-0008c170: 6c69 7474 6572 2061 7267 756d 656e 742e  litter argument.
-0008c180: 0d0a 2020 2020 596f 7520 6361 6e20 616c  ..    You can al
-0008c190: 736f 2066 696c 6c20 4e75 6c6c 2076 616c  so fill Null val
-0008c1a0: 7565 7320 7468 6174 206f 6363 7572 2064  ues that occur d
-0008c1b0: 7565 2074 6f20 796f 7572 2073 706c 6974  ue to your split
-0008c1c0: 7469 6e67 2062 7920 7370 6563 6966 7969  ting by specifyi
-0008c1d0: 6e67 2061 2066 696c 6c65 722e 0d0a 2020  ng a filler...  
-0008c1e0: 2020 6966 206e 6f20 6e65 775f 6e61 6d65    if no new_name
-0008c1f0: 735f 6c69 7374 2069 7320 6769 7665 6e2c  s_list is given,
-0008c200: 2074 6865 6e20 7765 2075 7365 2074 6865   then we use the
-0008c210: 206e 616d 6520 6f66 2074 6865 2066 6965   name of the fie
-0008c220: 6c64 2069 7473 656c 6620 746f 2073 706c  ld itself to spl
-0008c230: 6974 2e0d 0a20 2020 2022 2222 0d0a 2020  it...    """..  
-0008c240: 2020 696d 706f 7274 2077 6172 6e69 6e67    import warning
-0008c250: 730d 0a20 2020 2077 6172 6e69 6e67 732e  s..    warnings.
-0008c260: 6669 6c74 6572 7761 726e 696e 6773 2822  filterwarnings("
-0008c270: 6967 6e6f 7265 2229 0d0a 2020 2020 6466  ignore")..    df
-0008c280: 203d 2064 662e 636f 7079 2829 0d0a 2020   = df.copy()..  
-0008c290: 2020 2323 2320 4669 7273 7420 7072 696e    ### First prin
-0008c2a0: 7420 7468 6520 6d61 7869 6d75 6d20 6e75  t the maximum nu
-0008c2b0: 6d62 6572 206f 6620 7468 696e 6773 2069  mber of things i
-0008c2c0: 6e20 7468 6174 2066 6965 6c64 0d0a 2020  n that field..  
-0008c2d0: 2020 6d61 785f 7468 696e 6773 203d 2064    max_things = d
-0008c2e0: 665b 6669 656c 645d 2e6d 6170 286c 616d  f[field].map(lam
-0008c2f0: 6264 6120 783a 206c 656e 2878 2e73 706c  bda x: len(x.spl
-0008c300: 6974 2873 706c 6974 7465 7229 2929 2e6d  it(splitter))).m
-0008c310: 6178 2829 0d0a 2020 2020 6966 206c 656e  ax()..    if len
-0008c320: 286e 6577 5f6e 616d 6573 5f6c 6973 7429  (new_names_list)
-0008c330: 203d 3d20 303a 0d0a 2020 2020 2020 2020   == 0:..        
-0008c340: 7072 696e 7428 2720 2020 204d 6178 2e20  print('    Max. 
-0008c350: 636f 6c75 6d6e 7320 6372 6561 7465 6420  columns created 
-0008c360: 6279 2073 706c 6974 7469 6e67 2025 7320  by splitting %s 
-0008c370: 6669 656c 6420 6973 2025 642e 2720 2528  field is %d.' %(
-0008c380: 0d0a 2020 2020 2020 2020 2020 2020 2020  ..              
-0008c390: 2020 2020 2020 2020 2020 2020 2020 6669                fi
-0008c3a0: 656c 642c 6d61 785f 7468 696e 6773 2929  eld,max_things))
-0008c3b0: 0d0a 2020 2020 656c 7365 3a0d 0a20 2020  ..    else:..   
-0008c3c0: 2020 2020 2070 7269 6e74 2827 2020 2020       print('    
-0008c3d0: 4d61 782e 2063 6f6c 756d 6e73 2063 7265  Max. columns cre
-0008c3e0: 6174 6564 2062 7920 7370 6c69 7474 696e  ated by splittin
-0008c3f0: 6720 2573 2066 6965 6c64 2069 7320 2564  g %s field is %d
-0008c400: 2062 7574 2079 6f75 2068 6176 6520 6769   but you have gi
-0008c410: 7665 6e20 2564 2076 6172 6961 626c 6520  ven %d variable 
-0008c420: 6e61 6d65 7320 6f6e 6c79 2e20 5365 6c65  names only. Sele
-0008c430: 6374 696e 6720 6669 7273 7420 2564 2720  cting first %d' 
-0008c440: 2528 0d0a 2020 2020 2020 2020 2020 2020  %(..            
-0008c450: 2020 2020 2020 2020 2020 2020 6669 656c              fiel
-0008c460: 642c 6d61 785f 7468 696e 6773 2c6c 656e  d,max_things,len
-0008c470: 286e 6577 5f6e 616d 6573 5f6c 6973 7429  (new_names_list)
-0008c480: 2c6c 656e 286e 6577 5f6e 616d 6573 5f6c  ,len(new_names_l
-0008c490: 6973 7429 2929 0d0a 2020 2020 2323 2320  ist)))..    ### 
-0008c4a0: 5468 6973 2063 7265 6174 6573 2061 206e  This creates a n
-0008c4b0: 6577 2066 6965 6c64 2074 6861 7420 636f  ew field that co
-0008c4c0: 756e 7473 2074 6865 206e 756d 6265 7220  unts the number 
-0008c4d0: 6f66 2074 6869 6e67 7320 7468 6174 2061  of things that a
-0008c4e0: 7265 2069 6e20 7468 6174 2066 6965 6c64  re in that field
-0008c4f0: 2e0d 0a20 2020 206e 756d 5f70 726f 6475  ...    num_produ
-0008c500: 6374 735f 7669 6577 6564 203d 2027 636f  cts_viewed = 'co
-0008c510: 756e 745f 7468 696e 6773 5f69 6e5f 272b  unt_things_in_'+
-0008c520: 6669 656c 640d 0a20 2020 2064 665b 6e75  field..    df[nu
-0008c530: 6d5f 7072 6f64 7563 7473 5f76 6965 7765  m_products_viewe
-0008c540: 645d 203d 2064 665b 6669 656c 645d 2e6d  d] = df[field].m
-0008c550: 6170 286c 616d 6264 6120 783a 206c 656e  ap(lambda x: len
-0008c560: 2878 2e73 706c 6974 2822 3b22 2929 292e  (x.split(";"))).
-0008c570: 7661 6c75 6573 0d0a 2020 2020 2323 2320  values..    ### 
-0008c580: 436c 6561 6e20 7570 2074 6865 2066 6965  Clean up the fie
-0008c590: 6c64 2073 7563 6820 7468 6174 2069 7420  ld such that it 
-0008c5a0: 6861 7320 7468 6520 7269 6768 7420 6e75  has the right nu
-0008c5b0: 6d62 6572 206f 6620 7370 6c69 7420 6368  mber of split ch
-0008c5c0: 6172 7320 6f74 6865 7277 6973 6520 6164  ars otherwise ad
-0008c5d0: 6420 746f 2069 740d 0a20 2020 2064 665b  d to it..    df[
-0008c5e0: 6669 656c 645d 203d 2064 665b 6669 656c  field] = df[fiel
-0008c5f0: 645d 2e6d 6170 286c 616d 6264 6120 783a  d].map(lambda x:
-0008c600: 2078 2b73 706c 6974 7465 722a 286d 6178   x+splitter*(max
-0008c610: 5f74 6869 6e67 732d 6c65 6e28 782e 7370  _things-len(x.sp
-0008c620: 6c69 7428 223b 2229 2929 2069 6620 6c65  lit(";"))) if le
-0008c630: 6e28 782e 7370 6c69 7428 223b 2229 2920  n(x.split(";")) 
-0008c640: 3c20 6d61 785f 7468 696e 6773 2065 6c73  < max_things els
-0008c650: 6520 7829 0d0a 2020 2020 2323 2323 2323  e x)..    ######
-0008c660: 204e 6f77 2079 6f75 2063 7265 6174 6520   Now you create 
-0008c670: 6e65 7720 6669 656c 6473 2062 7920 7370  new fields by sp
-0008c680: 6c69 7420 7468 6520 6f6e 6520 6c61 7267  lit the one larg
-0008c690: 6520 6669 656c 6420 2323 2323 2323 2323  e field ########
-0008c6a0: 0d0a 2020 2020 6966 206e 6577 5f6e 616d  ..    if new_nam
-0008c6b0: 6573 5f6c 6973 7420 3d3d 2027 273a 0d0a  es_list == '':..
-0008c6c0: 2020 2020 2020 2020 6e65 775f 6e61 6d65          new_name
-0008c6d0: 735f 6c69 7374 203d 205b 6669 656c 642b  s_list = [field+
-0008c6e0: 275f 272b 7374 7228 6929 2066 6f72 2069  '_'+str(i) for i
-0008c6f0: 2069 6e20 7261 6e67 6528 312c 6d61 785f   in range(1,max_
-0008c700: 7468 696e 6773 2b31 295d 0d0a 2020 2020  things+1)]..    
-0008c710: 7472 793a 0d0a 2020 2020 2020 2020 666f  try:..        fo
-0008c720: 7220 6920 696e 2072 616e 6765 286c 656e  r i in range(len
-0008c730: 286e 6577 5f6e 616d 6573 5f6c 6973 7429  (new_names_list)
-0008c740: 293a 0d0a 2020 2020 2020 2020 2020 2020  ):..            
-0008c750: 6466 5b66 6965 6c64 5d2e 6669 6c6c 6e61  df[field].fillna
-0008c760: 2866 696c 6c65 722c 2069 6e70 6c61 6365  (filler, inplace
-0008c770: 3d54 7275 6529 0d0a 2020 2020 2020 2020  =True)..        
-0008c780: 2020 2020 6466 2e6c 6f63 5b64 665b 6669      df.loc[df[fi
-0008c790: 656c 645d 203d 3d20 7370 6c69 7474 6572  eld] == splitter
-0008c7a0: 2c20 6669 656c 645d 203d 2066 696c 6c65  , field] = fille
-0008c7b0: 720d 0a20 2020 2020 2020 2020 2020 2064  r..            d
-0008c7c0: 665b 6e65 775f 6e61 6d65 735f 6c69 7374  f[new_names_list
-0008c7d0: 5b69 5d5d 203d 2064 665b 6669 656c 645d  [i]] = df[field]
-0008c7e0: 2e6d 6170 286c 616d 6264 6120 783a 2078  .map(lambda x: x
-0008c7f0: 2e73 706c 6974 2873 706c 6974 7465 7229  .split(splitter)
-0008c800: 5b69 5d0d 0a20 2020 2020 2020 2020 2020  [i]..           
-0008c810: 2020 2020 2020 2020 2020 2020 2020 2020                  
-0008c820: 2020 2020 2020 2020 2020 2020 2020 2069                 i
-0008c830: 6620 7370 6c69 7474 6572 2069 6e20 7820  f splitter in x 
-0008c840: 656c 7365 2078 290d 0a20 2020 2065 7863  else x)..    exc
-0008c850: 6570 743a 0d0a 2020 2020 2020 2020 2323  ept:..        ##
-0008c860: 2320 4368 6563 6b20 6966 2074 6865 2063  # Check if the c
-0008c870: 6f6c 756d 6e20 6973 2061 2073 7472 696e  olumn is a strin
-0008c880: 6720 636f 6c75 6d6e 2e20 4966 206e 6f74  g column. If not
-0008c890: 2c20 6769 7665 2061 6e20 6572 726f 7220  , give an error 
-0008c8a0: 6d65 7373 6167 652e 0d0a 2020 2020 2020  message...      
-0008c8b0: 2020 7072 696e 7428 2743 616e 6e6f 7420    print('Cannot 
-0008c8c0: 7370 6c69 7420 7468 6520 636f 6c75 6d6e  split the column
-0008c8d0: 2e20 4765 7474 696e 6720 616e 2065 7272  . Getting an err
-0008c8e0: 6f72 2e20 4368 6563 6b20 7468 6520 636f  or. Check the co
-0008c8f0: 6c75 6d6e 2061 6761 696e 2729 0d0a 2020  lumn again')..  
-0008c900: 2020 2020 2020 7265 7475 726e 2064 660d        return df.
-0008c910: 0a20 2020 2072 6574 7572 6e20 6466 2c20  .    return df, 
-0008c920: 6e65 775f 6e61 6d65 735f 6c69 7374 0d0a  new_names_list..
-0008c930: 2323 2323 2323 2323 2323 2323 2323 2323  ################
-0008c940: 2323 2323 2323 2323 2323 2323 2323 2323  ################
-0008c950: 2323 2323 2323 2323 2323 2323 2323 2323  ################
-0008c960: 2323 2323 2323 2323 2323 2323 2323 2323  ################
-0008c970: 2323 2323 2323 2323 2323 2323 2323 2323  ################
-0008c980: 230d 0a64 6566 2061 6464 5f61 6767 7265  #..def add_aggre
-0008c990: 6761 7465 5f70 7269 6d69 7469 7665 5f66  gate_primitive_f
-0008c9a0: 6561 7475 7265 7328 6466 742c 2061 6767  eatures(dft, agg
-0008c9b0: 5f74 7970 6573 2c20 6964 5f63 6f6c 756d  _types, id_colum
-0008c9c0: 6e2c 2069 676e 6f72 655f 7661 7269 6162  n, ignore_variab
-0008c9d0: 6c65 733d 5b5d 293a 0d0a 2020 2020 2222  les=[]):..    ""
-0008c9e0: 220d 0a20 2020 2023 2323 2020 204d 6f64  "..    ###   Mod
-0008c9f0: 6966 7920 4461 7461 6672 616d 6520 6279  ify Dataframe by
-0008ca00: 2061 6464 696e 6720 636f 6d70 7574 6174   adding computat
-0008ca10: 696f 6e61 6c20 7072 696d 6974 6976 6520  ional primitive 
-0008ca20: 4665 6174 7572 6573 2075 7369 6e67 2046  Features using F
-0008ca30: 6561 7475 7265 2054 6f6f 6c73 2023 2323  eature Tools ###
-0008ca40: 230d 0a20 2020 2023 2323 2020 2057 6861  #..    ###   Wha
-0008ca50: 7420 6172 6520 6167 6772 6567 6174 6520  t are aggregate 
-0008ca60: 7072 696d 6974 6976 6573 3f20 7468 6579  primitives? they
-0008ca70: 2061 7265 2074 6f20 226d 6561 6e22 226d   are to "mean""m
-0008ca80: 6564 6961 6e22 2c22 6d6f 6465 222c 226d  edian","mode","m
-0008ca90: 696e 222c 226d 6178 222c 2065 7463 2e20  in","max", etc. 
-0008caa0: 6665 6174 7572 6573 0d0a 2020 2020 2323  features..    ##
-0008cab0: 2320 496e 7075 7473 3a0d 0a20 2020 2023  # Inputs:..    #
-0008cac0: 2323 2020 2064 663a 204a 7573 7420 7365  ##   df: Just se
-0008cad0: 6e74 2069 6e20 7468 6520 6461 7461 2066  nt in the data f
-0008cae0: 7261 6d65 2064 6620 7468 6174 2079 6f75  rame df that you
-0008caf0: 2077 616e 7420 6665 6174 7572 6573 2061   want features a
-0008cb00: 6464 6564 2074 6f0d 0a20 2020 2023 2323  dded to..    ###
-0008cb10: 2020 2061 6767 5f74 7970 6573 3a20 6c69     agg_types: li
-0008cb20: 7374 206f 6620 636f 6d70 7574 6174 696f  st of computatio
-0008cb30: 6e61 6c20 7479 7065 733a 2027 6d65 616e  nal types: 'mean
-0008cb40: 272c 276d 6564 6961 6e27 2c27 636f 756e  ','median','coun
-0008cb50: 7427 2c20 276d 6178 272c 2027 6d69 6e27  t', 'max', 'min'
-0008cb60: 2c20 2773 756d 272c 2065 7463 2e0d 0a20  , 'sum', etc... 
-0008cb70: 2020 2023 2323 2020 2020 2020 2020 204f     ###         O
-0008cb80: 6e65 2063 6176 6561 743a 2074 6865 7365  ne caveat: these
-0008cb90: 2061 6767 5f74 7970 6573 206d 7573 7420   agg_types must 
-0008cba0: 6265 2066 6f75 6e64 2069 6e20 7468 6520  be found in the 
-0008cbb0: 6167 675f 6675 6e63 206f 6620 6e75 6d70  agg_func of nump
-0008cbc0: 7920 6f72 2070 616e 6461 7320 6772 6f75  y or pandas grou
-0008cbd0: 7062 7920 7374 6174 656d 656e 742e 0d0a  pby statement...
-0008cbe0: 2020 2020 2323 2320 2020 2020 2020 2020      ###         
-0008cbf0: 666f 7220 6578 616d 706c 653a 206e 756d  for example: num
-0008cc00: 7079 2068 6173 2027 6d65 6469 616e 272c  py has 'median',
-0008cc10: 2770 726f 6427 2c27 7375 6d27 2c27 7374  'prod','sum','st
-0008cc20: 6427 2c27 7661 7227 2c20 6574 632e 202d  d','var', etc. -
-0008cc30: 2074 6865 7920 7769 6c6c 2077 6f72 6b21   they will work!
-0008cc40: 0d0a 2020 2020 2323 2320 2020 6964 636f  ..    ###   idco
-0008cc50: 6c75 6d6e 3a20 7468 6973 2069 7320 746f  lumn: this is to
-0008cc60: 2063 7265 6174 6520 616e 2069 6e64 6578   create an index
-0008cc70: 2066 6f72 2074 6865 2064 6174 6166 7261   for the datafra
-0008cc80: 6d65 2073 696e 6365 2046 5420 7275 6e73  me since FT runs
-0008cc90: 206f 6e20 696e 6465 7820 7661 7269 6162   on index variab
-0008cca0: 6c65 2e20 596f 7520 6361 6e20 6c65 6176  le. You can leav
-0008ccb0: 6520 6974 2065 6d70 7479 2073 7472 696e  e it empty strin
-0008ccc0: 672e 0d0a 2020 2020 2323 2320 2020 6967  g...    ###   ig
-0008ccd0: 6e6f 7265 5f76 6172 6961 626c 6573 3a20  nore_variables: 
-0008cce0: 6c69 7374 206f 6620 7661 7269 6162 6c65  list of variable
-0008ccf0: 7320 746f 2069 676e 6f72 6520 616d 6f6e  s to ignore amon
-0008cd00: 6720 6e75 6d65 7269 6320 7661 7269 6162  g numeric variab
-0008cd10: 6c65 7320 696e 2064 6174 6120 7369 6e63  les in data sinc
-0008cd20: 6520 7468 6579 206d 6179 2062 6520 4944  e they may be ID
-0008cd30: 2076 6172 6961 626c 6573 2e0d 0a20 2020   variables...   
-0008cd40: 2022 2222 0d0a 2020 2020 696d 706f 7274   """..    import
-0008cd50: 2063 6f70 790d 0a20 2020 2023 2323 204d   copy..    ### M
-0008cd60: 616b 6520 7375 7265 2074 6865 206c 6973  ake sure the lis
-0008cd70: 7420 6f66 2066 756e 6374 696f 6e73 2074  t of functions t
-0008cd80: 6865 7920 7365 6e64 2069 6e20 6172 6520  hey send in are 
-0008cd90: 6163 6365 7074 6162 6c65 2066 756e 6374  acceptable funct
-0008cda0: 696f 6e73 2e20 4966 206e 6f74 2c20 7468  ions. If not, th
-0008cdb0: 6520 6167 6772 6567 6174 6520 7769 6c6c  e aggregate will
-0008cdc0: 2062 6c6f 7720 7570 210d 0a20 2020 2066   blow up!..    f
-0008cdd0: 756e 635f 7365 7420 3d20 7b27 636f 756e  unc_set = {'coun
-0008cde0: 7427 2c27 7375 6d27 2c27 6d65 616e 272c  t','sum','mean',
-0008cdf0: 276d 6164 272c 276d 6564 6961 6e27 2c27  'mad','median','
-0008ce00: 6d69 6e27 2c27 6d61 7827 2c27 6d6f 6465  min','max','mode
-0008ce10: 272c 2761 6273 272c 2770 726f 6427 2c27  ','abs','prod','
-0008ce20: 7374 6427 2c27 7661 7227 2c27 7365 6d27  std','var','sem'
-0008ce30: 2c27 736b 6577 272c 276b 7572 7427 2c27  ,'skew','kurt','
-0008ce40: 7175 616e 7469 6c65 272c 2763 756d 7375  quantile','cumsu
-0008ce50: 6d27 2c27 6375 6d70 726f 6427 2c27 6375  m','cumprod','cu
-0008ce60: 6d6d 6178 272c 2763 756d 6d69 6e27 7d0d  mmax','cummin'}.
-0008ce70: 0a20 2020 2061 6767 5f74 7970 6573 203d  .    agg_types =
-0008ce80: 206c 6973 7428 7365 7428 6167 675f 7479   list(set(agg_ty
-0008ce90: 7065 7329 2e69 6e74 6572 7365 6374 696f  pes).intersectio
-0008cea0: 6e28 6675 6e63 5f73 6574 2929 0d0a 2020  n(func_set))..  
-0008ceb0: 2020 2323 2320 4966 2074 6865 2069 676e    ### If the ign
-0008cec0: 6f72 655f 7661 7269 6162 6c65 7320 6c69  ore_variables li
-0008ced0: 7374 2069 7320 656d 7074 792c 206d 616b  st is empty, mak
-0008cee0: 6520 7375 7265 2079 6f75 2061 6464 2074  e sure you add t
-0008cef0: 6865 2069 645f 636f 6c75 6d6e 2074 6f20  he id_column to 
-0008cf00: 6974 2073 6f20 6974 2063 616e 2062 6520  it so it can be 
-0008cf10: 6472 6f70 7065 6420 6672 6f6d 2061 6767  dropped from agg
-0008cf20: 7265 6761 7469 6f6e 2e0d 0a20 2020 2069  regation...    i
-0008cf30: 6620 6c65 6e28 6967 6e6f 7265 5f76 6172  f len(ignore_var
-0008cf40: 6961 626c 6573 2920 3d3d 2030 3a0d 0a20  iables) == 0:.. 
-0008cf50: 2020 2020 2020 2069 676e 6f72 655f 7661         ignore_va
-0008cf60: 7269 6162 6c65 7320 3d20 5b69 645f 636f  riables = [id_co
-0008cf70: 6c75 6d6e 5d0d 0a20 2020 2023 2323 2053  lumn]..    ### S
-0008cf80: 656c 6563 7420 6f6e 6c79 2069 6e74 6567  elect only integ
-0008cf90: 6572 2061 6e64 2066 6c6f 6174 2076 6172  er and float var
-0008cfa0: 6961 626c 6573 2074 6f20 646f 2074 6869  iables to do thi
-0008cfb0: 7320 6167 6772 6567 6174 696f 6e20 6f6e  s aggregation on
-0008cfc0: 2e20 4265 2076 6572 7920 6361 7265 6675  . Be very carefu
-0008cfd0: 6c20 6966 2074 6865 7265 2061 7265 2074  l if there are t
-0008cfe0: 6f6f 206d 616e 7920 7661 7273 2e0d 0a20  oo many vars... 
-0008cff0: 2020 2023 2323 2054 6869 7320 7769 6c6c     ### This will
-0008d000: 2074 616b 6520 7469 6d65 2074 6f20 7275   take time to ru
-0008d010: 6e20 696e 2074 6861 7420 6361 7365 2e0d  n in that case..
-0008d020: 0a20 2020 2064 6674 5f69 6e64 6578 203d  .    dft_index =
-0008d030: 2063 6f70 792e 6465 6570 636f 7079 2864   copy.deepcopy(d
-0008d040: 6674 5b69 645f 636f 6c75 6d6e 5d29 0d0a  ft[id_column])..
-0008d050: 2020 2020 6466 745f 636f 6e74 203d 2063      dft_cont = c
-0008d060: 6f70 792e 6465 6570 636f 7079 2864 6674  opy.deepcopy(dft
-0008d070: 2e73 656c 6563 745f 6474 7970 6573 2827  .select_dtypes('
-0008d080: 6e75 6d62 6572 2729 2e64 726f 7028 6967  number').drop(ig
-0008d090: 6e6f 7265 5f76 6172 6961 626c 6573 2c61  nore_variables,a
-0008d0a0: 7869 733d 3129 290d 0a20 2020 2064 6674  xis=1))..    dft
-0008d0b0: 5f63 6f6e 745b 6964 5f63 6f6c 756d 6e5d  _cont[id_column]
-0008d0c0: 203d 2064 6674 5f69 6e64 6578 0d0a 2020   = dft_index..  
-0008d0d0: 2020 7472 793a 0d0a 2020 2020 2020 2020    try:..        
-0008d0e0: 6466 745f 6675 6c6c 203d 2064 6674 5f63  dft_full = dft_c
-0008d0f0: 6f6e 742e 6772 6f75 7062 7928 6964 5f63  ont.groupby(id_c
-0008d100: 6f6c 756d 6e29 2e61 6767 2861 6767 5f74  olumn).agg(agg_t
-0008d110: 7970 6573 290d 0a20 2020 2065 7863 6570  ypes)..    excep
-0008d120: 743a 0d0a 2020 2020 2020 2020 2323 2320  t:..        ### 
-0008d130: 6966 2066 6f72 2073 6f6d 6520 7265 6173  if for some reas
-0008d140: 6f6e 2c20 7468 6520 6772 6f75 7062 7920  on, the groupby 
-0008d150: 626c 6f77 7320 7570 2c20 7468 656e 206a  blows up, then j
-0008d160: 7573 7420 7265 7475 726e 2074 6865 2064  ust return the d
-0008d170: 6174 6166 7261 6d65 2061 7320 6973 202d  ataframe as is -
-0008d180: 206e 6f20 6368 616e 6765 7321 0d0a 2020   no changes!..  
-0008d190: 2020 2020 2020 7265 7475 726e 2064 6674        return dft
-0008d1a0: 0d0a 2020 2020 636f 6c73 203d 205b 782b  ..    cols = [x+
-0008d1b0: 275f 272b 792b 275f 6279 5f27 2b69 645f  '_'+y+'_by_'+id_
-0008d1c0: 636f 6c75 6d6e 2066 6f72 2028 782c 7929  column for (x,y)
-0008d1d0: 2069 6e20 6466 745f 6675 6c6c 2e63 6f6c   in dft_full.col
-0008d1e0: 756d 6e73 5d0d 0a20 2020 2064 6674 5f66  umns]..    dft_f
-0008d1f0: 756c 6c2e 636f 6c75 6d6e 7320 3d20 636f  ull.columns = co
-0008d200: 6c73 0d0a 2020 2020 2323 2320 204e 6f74  ls..    ###  Not
-0008d210: 2065 7665 7279 2063 6f6c 756d 6e20 6861   every column ha
-0008d220: 7320 7573 6566 756c 2076 616c 7565 732e  s useful values.
-0008d230: 2049 6620 6974 2069 7320 6675 6c6c 206f   If it is full o
-0008d240: 6620 6a75 7374 2074 6865 2073 616d 6520  f just the same 
-0008d250: 7661 6c75 652c 2072 656d 6f76 6520 6974  value, remove it
-0008d260: 0d0a 2020 2020 5f2c 206c 6973 745f 756e  ..    _, list_un
-0008d270: 6971 7565 5f63 6f6c 5f69 6473 203d 206e  ique_col_ids = n
-0008d280: 702e 756e 6971 7565 2864 6674 5f66 756c  p.unique(dft_ful
-0008d290: 6c2c 2061 7869 7320 3d20 312c 2072 6574  l, axis = 1, ret
-0008d2a0: 7572 6e5f 696e 6465 783d 5472 7565 290d  urn_index=True).
-0008d2b0: 0a20 2020 2064 6674 5f66 756c 6c20 3d20  .    dft_full = 
-0008d2c0: 6466 745f 6675 6c6c 2e69 6c6f 635b 3a2c  dft_full.iloc[:,
-0008d2d0: 206c 6973 745f 756e 6971 7565 5f63 6f6c   list_unique_col
-0008d2e0: 5f69 6473 5d0d 0a20 2020 2072 6574 7572  _ids]..    retur
-0008d2f0: 6e20 6466 745f 6675 6c6c 0d0a 2323 2323  n dft_full..####
-0008d300: 2323 2323 2323 2323 2323 2323 2323 2323  ################
-0008d310: 2323 2323 2323 2323 2323 2323 2323 2323  ################
-0008d320: 2323 2323 2323 2323 2323 2323 2323 2323  ################
-0008d330: 2323 2323 2323 2323 2323 2323 2323 2323  ################
-0008d340: 2323 2323 2323 2323 2323 2323 2323 2323  ################
-0008d350: 2323 2323 2323 2323 2323 2323 2323 2323  ################
-0008d360: 2323 2323 2323 2323 2323 2323 2323 2323  ################
-0008d370: 2323 2323 2323 2323 2323 2323 0d0a 696d  ############..im
-0008d380: 706f 7274 2063 6f70 790d 0a69 6d70 6f72  port copy..impor
-0008d390: 7420 7469 6d65 0d0a 696d 706f 7274 2070  t time..import p
-0008d3a0: 6462 0d0a 6465 6620 4645 5f63 7265 6174  db..def FE_creat
-0008d3b0: 655f 6772 6f75 7062 795f 6665 6174 7572  e_groupby_featur
-0008d3c0: 6573 2864 6674 2c20 6772 6f75 7062 795f  es(dft, groupby_
-0008d3d0: 636f 6c75 6d6e 732c 206e 756d 6572 6963  columns, numeric
-0008d3e0: 5f63 6f6c 756d 6e73 2c20 6167 675f 7479  _columns, agg_ty
-0008d3f0: 7065 7329 3a0d 0a20 2020 2022 2222 0d0a  pes):..    """..
-0008d400: 2020 2020 4645 206d 6561 6e73 2046 4541      FE means FEA
-0008d410: 5455 5245 2045 4e47 494e 4545 5249 4e47  TURE ENGINEERING
-0008d420: 202d 2054 6861 7420 6d65 616e 7320 7468   - That means th
-0008d430: 6973 2066 756e 6374 696f 6e20 7769 6c6c  is function will
-0008d440: 2063 7265 6174 6520 6e65 7720 6665 6174   create new feat
-0008d450: 7572 6573 0d0a 2020 2020 4265 7761 7265  ures..    Beware
-0008d460: 3a20 7468 6973 2066 756e 6374 696f 6e20  : this function 
-0008d470: 7769 6c6c 2072 6574 7572 6e20 6120 736d  will return a sm
-0008d480: 616c 6c65 7220 6461 7461 6672 616d 6520  aller dataframe 
-0008d490: 7468 616e 2077 6861 7420 796f 7520 7365  than what you se
-0008d4a0: 6e64 2069 6e20 7369 6e63 6520 6974 2067  nd in since it g
-0008d4b0: 726f 7570 7320 726f 7773 2062 7920 6b65  roups rows by ke
-0008d4c0: 7973 2e0d 0a20 2020 2023 2323 2323 2323  ys...    #######
-0008d4d0: 2323 2323 2323 2323 2323 2323 2323 2323  ################
-0008d4e0: 2323 2323 2323 2323 2323 2323 2323 2323  ################
-0008d4f0: 2323 2323 2323 2323 2323 2323 2323 2323  ################
-0008d500: 2323 2323 2323 2323 2323 2323 2323 2323  ################
-0008d510: 2323 2323 2323 2323 2323 2323 2323 2323  ################
-0008d520: 2323 2323 2323 2323 2323 2323 2323 2323  ################
-0008d530: 2323 0d0a 2020 2020 4675 6e63 7469 6f6e  ##..    Function
-0008d540: 2067 726f 7570 7320 726f 7773 2069 6e20   groups rows in 
-0008d550: 6120 6466 7420 6461 7461 6672 616d 6520  a dft dataframe 
-0008d560: 6279 2074 6865 2067 726f 7570 6279 5f63  by the groupby_c
-0008d570: 6f6c 756d 6e73 2061 6e64 2072 6574 7572  olumns and retur
-0008d580: 6e73 206d 756c 7469 706c 6520 636f 6c75  ns multiple colu
-0008d590: 6d6e 7320 666f 7220 7468 6520 6e75 6d65  mns for the nume
-0008d5a0: 7269 6320 636f 6c75 6d6e 2061 6767 7265  ric column aggre
-0008d5b0: 6761 7465 642e 0d0a 2020 2020 446f 206e  gated...    Do n
-0008d5c0: 6f74 2073 656e 6420 696e 206d 6f72 6520  ot send in more 
-0008d5d0: 7468 616e 206f 6e65 2063 6f6c 756d 6e20  than one column 
-0008d5e0: 696e 2074 6865 206e 756d 6572 6963 2063  in the numeric c
-0008d5f0: 6f6c 756d 6e20 7369 6e63 6520 6265 796f  olumn since beyo
-0008d600: 6e64 2074 6865 2066 6972 7374 2063 6f6c  nd the first col
-0008d610: 756d 6e20 6974 2077 696c 6c20 6265 2069  umn it will be i
-0008d620: 676e 6f72 6564 210d 0a20 2020 2061 6767  gnored!..    agg
-0008d630: 5f74 7970 6520 6361 6e20 6265 2061 6e79  _type can be any
-0008d640: 206e 756d 7079 2066 756e 6374 696f 6e20   numpy function 
-0008d650: 7375 6368 2061 7320 6d65 616e 2c20 6d65  such as mean, me
-0008d660: 6469 616e 2c20 7375 6d2c 2063 6f75 6e74  dian, sum, count
-0008d670: 2c20 6574 632e 0d0a 2020 2020 2323 2323  , etc...    ####
-0008d680: 2323 2323 2323 2323 2323 2323 2323 2323  ################
-0008d690: 2323 2323 2323 2323 2323 2323 2323 2323  ################
-0008d6a0: 2323 2323 2323 2323 2323 2323 2323 2323  ################
-0008d6b0: 2323 2323 2323 2323 2323 2323 2323 2323  ################
-0008d6c0: 2323 2323 2323 2323 2323 2323 2323 2323  ################
-0008d6d0: 2323 2323 2323 2323 2323 2323 2323 2323  ################
-0008d6e0: 2323 2323 2323 0d0a 2020 2020 5265 7475  ######..    Retu
-0008d6f0: 726e 733a 2061 2073 6d61 6c6c 6572 2064  rns: a smaller d
-0008d700: 6174 6166 7261 6d65 2077 6974 6820 726f  ataframe with ro
-0008d710: 7773 2067 726f 7570 6564 2062 7920 6772  ws grouped by gr
-0008d720: 6f75 7062 795f 636f 6c75 6d6e 7320 616e  oupby_columns an
-0008d730: 6420 6167 6772 6567 6174 6564 2066 6f72  d aggregated for
-0008d740: 2074 6865 206e 756d 6572 6963 5f63 6f6c   the numeric_col
-0008d750: 756d 6e0d 0a20 2020 2022 2222 0d0a 2020  umn..    """..  
-0008d760: 2020 7374 6172 745f 7469 6d65 203d 2074    start_time = t
-0008d770: 696d 652e 7469 6d65 2829 0d0a 2020 2020  ime.time()..    
-0008d780: 6772 6f75 7065 645f 7365 7020 3d20 7064  grouped_sep = pd
-0008d790: 2e44 6174 6146 7261 6d65 2829 0d0a 2020  .DataFrame()..  
-0008d7a0: 2020 7072 696e 7428 2741 7574 6f76 696d    print('Autovim
-0008d7b0: 6c20 4665 6174 7572 6520 456e 6769 6e65  l Feature Engine
-0008d7c0: 6572 696e 673a 2063 7265 6174 696e 6720  ering: creating 
-0008d7d0: 6772 6f75 7062 7920 6665 6174 7572 6573  groupby features
-0008d7e0: 2075 7369 6e67 2025 7327 2025 6772 6f75   using %s' %grou
-0008d7f0: 7062 795f 636f 6c75 6d6e 7329 0d0a 2020  pby_columns)..  
-0008d800: 2020 2323 2323 2323 2323 2323 2020 5468    ##########  Th
-0008d810: 6973 2069 7320 7768 6572 6520 7765 2063  is is where we c
-0008d820: 7265 6174 6520 6e65 7720 636f 6c75 6d6e  reate new column
-0008d830: 7320 6279 2065 6163 6820 6e75 6d65 7269  s by each numeri
-0008d840: 6320 636f 6c75 6d6e 2067 726f 7570 6564  c column grouped
-0008d850: 2062 7920 6772 6f75 702d 6279 2063 6f6c   by group-by col
-0008d860: 756d 6e73 2067 6976 656e 2e0d 0a20 2020  umns given...   
-0008d870: 2069 6620 6973 696e 7374 616e 6365 286e   if isinstance(n
-0008d880: 756d 6572 6963 5f63 6f6c 756d 6e73 2c20  umeric_columns, 
-0008d890: 6c69 7374 293a 0d0a 2020 2020 2020 2020  list):..        
-0008d8a0: 7061 7373 0d0a 2020 2020 656c 6966 2069  pass..    elif i
-0008d8b0: 7369 6e73 7461 6e63 6528 6e75 6d65 7269  sinstance(numeri
-0008d8c0: 635f 636f 6c75 6d6e 2c20 7374 7229 3a0d  c_column, str):.
-0008d8d0: 0a20 2020 2020 2020 206e 756d 6572 6963  .        numeric
-0008d8e0: 5f63 6f6c 756d 6e73 203d 205b 6e75 6d65  _columns = [nume
-0008d8f0: 7269 635f 636f 6c75 6d6e 735d 0d0a 2020  ric_columns]..  
-0008d900: 2020 656c 7365 3a0d 0a20 2020 2020 2020    else:..       
-0008d910: 2070 7269 6e74 2827 2020 2020 4e75 6d65   print('    Nume
-0008d920: 7269 6320 636f 6c75 6d6e 206d 7573 7420  ric column must 
-0008d930: 6265 2061 2073 7472 696e 6720 6e6f 7420  be a string not 
-0008d940: 6120 6e75 6d62 6572 2054 7279 2061 6761  a number Try aga
-0008d950: 696e 2729 0d0a 2020 2020 2020 2020 7265  in')..        re
-0008d960: 7475 726e 2070 642e 4461 7461 4672 616d  turn pd.DataFram
-0008d970: 6528 290d 0a20 2020 2067 726f 7570 6564  e()..    grouped
-0008d980: 5f6c 6973 7420 3d20 7064 2e44 6174 6146  _list = pd.DataF
-0008d990: 7261 6d65 2829 0d0a 2020 2020 666f 7220  rame()..    for 
-0008d9a0: 6974 6572 6174 696f 6e2c 206e 756d 6572  iteration, numer
-0008d9b0: 6963 5f63 6f6c 756d 6e20 696e 207a 6970  ic_column in zip
-0008d9c0: 2872 616e 6765 286c 656e 286e 756d 6572  (range(len(numer
-0008d9d0: 6963 5f63 6f6c 756d 6e73 2929 2c6e 756d  ic_columns)),num
-0008d9e0: 6572 6963 5f63 6f6c 756d 6e73 293a 0d0a  eric_columns):..
-0008d9f0: 2020 2020 2020 2020 6772 6f75 7065 6420          grouped 
-0008da00: 3d20 6466 742e 6772 6f75 7062 7928 6772  = dft.groupby(gr
-0008da10: 6f75 7062 795f 636f 6c75 6d6e 7329 5b5b  oupby_columns)[[
-0008da20: 6e75 6d65 7269 635f 636f 6c75 6d6e 5d5d  numeric_column]]
-0008da30: 0d0a 2020 2020 2020 2020 7472 793a 0d0a  ..        try:..
-0008da40: 2020 2020 2020 2020 2020 2020 6167 675f              agg_
-0008da50: 7479 7065 203d 2061 6767 5f74 7970 6573  type = agg_types
-0008da60: 5b69 7465 7261 7469 6f6e 5d0d 0a20 2020  [iteration]..   
-0008da70: 2020 2020 2065 7863 6570 743a 0d0a 2020       except:..  
-0008da80: 2020 2020 2020 2020 2020 7072 696e 7428            print(
-0008da90: 2720 2020 204e 6f20 6167 6772 6567 6174  '    No aggregat
-0008daa0: 696f 6e20 7479 7065 2067 6976 656e 2c20  ion type given, 
-0008dab0: 6865 6e63 6520 6d65 616e 2069 7320 6368  hence mean is ch
-0008dac0: 6f73 656e 2062 7920 6465 6661 756c 7427  osen by default'
-0008dad0: 290d 0a20 2020 2020 2020 2020 2020 2061  )..            a
-0008dae0: 6767 5f74 7970 6520 3d20 276d 6561 6e27  gg_type = 'mean'
-0008daf0: 0d0a 2020 2020 2020 2020 7472 793a 0d0a  ..        try:..
-0008db00: 2020 2020 2020 2020 2020 2020 7072 6566              pref
-0008db10: 6978 203d 206e 756d 6572 6963 5f63 6f6c  ix = numeric_col
-0008db20: 756d 6e20 2b20 275f 270d 0a20 2020 2020  umn + '_'..     
-0008db30: 2020 2020 2020 2069 6620 6167 675f 7479         if agg_ty
-0008db40: 7065 2069 6e20 5b27 5375 6d27 2c20 2773  pe in ['Sum', 's
-0008db50: 756d 275d 3a0d 0a20 2020 2020 2020 2020  um']:..         
-0008db60: 2020 2020 2020 2067 726f 7570 6564 5f61         grouped_a
-0008db70: 6767 203d 2067 726f 7570 6564 2e73 756d  gg = grouped.sum
-0008db80: 2829 0d0a 2020 2020 2020 2020 2020 2020  ()..            
-0008db90: 656c 6966 2061 6767 5f74 7970 6520 696e  elif agg_type in
-0008dba0: 205b 274d 6561 6e27 2c20 276d 6561 6e27   ['Mean', 'mean'
-0008dbb0: 2c27 4176 6572 6167 6527 2c27 6176 6572  ,'Average','aver
-0008dbc0: 6167 6527 5d3a 0d0a 2020 2020 2020 2020  age']:..        
-0008dbd0: 2020 2020 2020 2020 6772 6f75 7065 645f          grouped_
-0008dbe0: 6167 6720 3d20 6772 6f75 7065 642e 6d65  agg = grouped.me
-0008dbf0: 616e 2829 0d0a 2020 2020 2020 2020 2020  an()..          
-0008dc00: 2020 656c 6966 2061 6767 5f74 7970 6520    elif agg_type 
-0008dc10: 696e 205b 2763 6f75 6e74 272c 2027 436f  in ['count', 'Co
-0008dc20: 756e 7427 5d3a 0d0a 2020 2020 2020 2020  unt']:..        
-0008dc30: 2020 2020 2020 2020 6772 6f75 7065 645f          grouped_
-0008dc40: 6167 6720 3d20 6772 6f75 7065 642e 636f  agg = grouped.co
-0008dc50: 756e 7428 290d 0a20 2020 2020 2020 2020  unt()..         
-0008dc60: 2020 2065 6c69 6620 6167 675f 7479 7065     elif agg_type
-0008dc70: 2069 6e20 5b27 4d65 6469 616e 272c 2027   in ['Median', '
-0008dc80: 6d65 6469 616e 275d 3a0d 0a20 2020 2020  median']:..     
-0008dc90: 2020 2020 2020 2020 2020 2067 726f 7570             group
-0008dca0: 6564 5f61 6767 203d 2067 726f 7570 6564  ed_agg = grouped
-0008dcb0: 2e6d 6564 6961 6e28 290d 0a20 2020 2020  .median()..     
-0008dcc0: 2020 2020 2020 2065 6c69 6620 6167 675f         elif agg_
-0008dcd0: 7479 7065 2069 6e20 5b27 4d61 7869 6d75  type in ['Maximu
-0008dce0: 6d27 2c20 276d 6178 696d 756d 272c 276d  m', 'maximum','m
-0008dcf0: 6178 272c 2027 4d61 7827 5d3a 0d0a 2020  ax', 'Max']:..  
-0008dd00: 2020 2020 2020 2020 2020 2020 2020 2323                ##
-0008dd10: 206d 6178 696d 756d 206f 6620 7468 6520   maximum of the 
-0008dd20: 616d 6f75 6e74 730d 0a20 2020 2020 2020  amounts..       
-0008dd30: 2020 2020 2020 2020 2067 726f 7570 6564           grouped
-0008dd40: 5f61 6767 203d 2067 726f 7570 6564 2e6d  _agg = grouped.m
-0008dd50: 6178 2829 0d0a 2020 2020 2020 2020 2020  ax()..          
-0008dd60: 2020 656c 6966 2061 6767 5f74 7970 6520    elif agg_type 
-0008dd70: 696e 205b 274d 696e 696d 756d 272c 2027  in ['Minimum', '
-0008dd80: 6d69 6e69 6d75 6d27 2c27 6d69 6e27 2c20  minimum','min', 
-0008dd90: 274d 696e 275d 3a0d 0a20 2020 2020 2020  'Min']:..       
-0008dda0: 2020 2020 2020 2020 2023 2320 6d61 7869           ## maxi
-0008ddb0: 6d75 6d20 6f66 2074 6865 2061 6d6f 756e  mum of the amoun
-0008ddc0: 7473 0d0a 2020 2020 2020 2020 2020 2020  ts..            
-0008ddd0: 2020 2020 6772 6f75 7065 645f 6167 6720      grouped_agg 
-0008dde0: 3d20 6772 6f75 7065 642e 6d69 6e28 290d  = grouped.min().
-0008ddf0: 0a20 2020 2020 2020 2020 2020 2065 6c73  .            els
-0008de00: 653a 0d0a 2020 2020 2020 2020 2020 2020  e:..            
-0008de10: 2020 2020 6772 6f75 7065 645f 6167 6720      grouped_agg 
-0008de20: 3d20 6772 6f75 7065 642e 6d65 616e 2829  = grouped.mean()
-0008de30: 0d0a 2020 2020 2020 2020 2020 2020 6772  ..            gr
-0008de40: 6f75 7065 645f 7365 7020 3d20 6772 6f75  ouped_sep = grou
-0008de50: 7065 645f 6167 672e 756e 7374 6163 6b28  ped_agg.unstack(
-0008de60: 292e 6164 645f 7072 6566 6978 2870 7265  ).add_prefix(pre
-0008de70: 6669 7829 2e66 696c 6c6e 6128 3029 0d0a  fix).fillna(0)..
-0008de80: 2020 2020 2020 2020 6578 6365 7074 3a0d          except:.
-0008de90: 0a20 2020 2020 2020 2020 2020 2070 7269  .            pri
-0008dea0: 6e74 2827 2020 2020 4572 726f 7220 696e  nt('    Error in
-0008deb0: 2063 7265 6174 696e 6720 6772 6f75 7062   creating groupb
-0008dec0: 7920 6665 6174 7572 6573 2e2e 2e72 6574  y features...ret
-0008ded0: 7572 6e69 6e67 2077 6974 6820 6e75 6c6c  urning with null
-0008dee0: 2064 6174 6166 7261 6d65 2729 0d0a 2020   dataframe')..  
-0008def0: 2020 2020 2020 2020 2020 6772 6f75 7065            groupe
-0008df00: 645f 7365 7020 3d20 7064 2e44 6174 6146  d_sep = pd.DataF
-0008df10: 7261 6d65 2829 0d0a 2020 2020 2020 2020  rame()..        
-0008df20: 6966 2069 7465 7261 7469 6f6e 203d 3d20  if iteration == 
-0008df30: 303a 0d0a 2020 2020 2020 2020 2020 2020  0:..            
-0008df40: 6772 6f75 7065 645f 6c69 7374 203d 2063  grouped_list = c
-0008df50: 6f70 792e 6465 6570 636f 7079 2867 726f  opy.deepcopy(gro
-0008df60: 7570 6564 5f73 6570 290d 0a20 2020 2020  uped_sep)..     
-0008df70: 2020 2065 6c73 653a 0d0a 2020 2020 2020     else:..      
-0008df80: 2020 2020 2020 6772 6f75 7065 645f 6c69        grouped_li
-0008df90: 7374 203d 2070 642e 636f 6e63 6174 285b  st = pd.concat([
-0008dfa0: 6772 6f75 7065 645f 6c69 7374 2c67 726f  grouped_list,gro
-0008dfb0: 7570 6564 5f73 6570 5d2c 6178 6973 3d31  uped_sep],axis=1
-0008dfc0: 290d 0a20 2020 2020 2020 2070 7269 6e74  )..        print
-0008dfd0: 2827 2020 2020 4166 7465 7220 6772 6f75  ('    After grou
-0008dfe0: 7065 6420 6665 6174 7572 6573 2061 6464  ped features add
-0008dff0: 6564 2062 7920 2573 2c20 6e75 6d62 6572  ed by %s, number
-0008e000: 206f 6620 636f 6c75 6d6e 7320 3d20 2564   of columns = %d
-0008e010: 2720 2528 6e75 6d65 7269 635f 636f 6c75  ' %(numeric_colu
-0008e020: 6d6e 2c20 6772 6f75 7065 645f 6c69 7374  mn, grouped_list
-0008e030: 2e73 6861 7065 5b31 5d29 290d 0a20 2020  .shape[1]))..   
-0008e040: 2023 2323 2320 6f6e 6365 2065 7665 7279   #### once every
-0008e050: 7468 696e 6720 6973 2064 6f6e 652c 2079  thing is done, y
-0008e060: 6f75 2063 616e 2063 6c6f 7365 2069 7420  ou can close it 
-0008e070: 6865 7265 0d0a 2020 2020 7072 696e 7428  here..    print(
-0008e080: 2754 696d 6520 7461 6b65 6e20 666f 7220  'Time taken for 
-0008e090: 6372 6561 7469 6f6e 206f 6620 6772 6f75  creation of grou
-0008e0a0: 7062 7920 6665 6174 7572 6573 2028 696e  pby features (in
-0008e0b0: 2073 6563 6f6e 6473 2920 3d20 2530 2e30   seconds) = %0.0
-0008e0c0: 6627 2025 2874 696d 652e 7469 6d65 2829  f' %(time.time()
-0008e0d0: 2d73 7461 7274 5f74 696d 6529 290d 0a20  -start_time)).. 
-0008e0e0: 2020 2074 7279 3a0d 0a20 2020 2020 2020     try:..       
-0008e0f0: 2067 726f 7570 6564 5f6c 6973 742e 636f   grouped_list.co
-0008e100: 6c75 6d6e 7320 3d20 6772 6f75 7065 645f  lumns = grouped_
-0008e110: 6c69 7374 2e63 6f6c 756d 6e73 2e67 6574  list.columns.get
-0008e120: 5f6c 6576 656c 5f76 616c 7565 7328 3129  _level_values(1)
-0008e130: 0d0a 2020 2020 2020 2020 6772 6f75 7065  ..        groupe
-0008e140: 645f 6c69 7374 2e63 6f6c 756d 6e73 2e6e  d_list.columns.n
-0008e150: 616d 6520 3d20 4e6f 6e65 2023 2320 6d61  ame = None ## ma
-0008e160: 6b65 2073 7572 6520 7468 6520 6e61 6d65  ke sure the name
-0008e170: 206f 6e20 636f 6c75 6d6e 7320 6973 2072   on columns is r
-0008e180: 656d 6f76 6564 0d0a 2020 2020 2020 2020  emoved..        
-0008e190: 6772 6f75 7065 645f 6c69 7374 203d 2067  grouped_list = g
-0008e1a0: 726f 7570 6564 5f6c 6973 742e 7265 7365  rouped_list.rese
-0008e1b0: 745f 696e 6465 7828 2920 2323 206d 616b  t_index() ## mak
-0008e1c0: 6520 7375 7265 2074 6865 2049 4420 636f  e sure the ID co
-0008e1d0: 6c75 6d6e 2063 6f6d 6573 2062 6163 6b0d  lumn comes back.
-0008e1e0: 0a20 2020 2065 7863 6570 743a 0d0a 2020  .    except:..  
-0008e1f0: 2020 2020 2020 7072 696e 7428 2720 2020        print('   
-0008e200: 4572 726f 7220 696e 2073 6574 7469 6e67  Error in setting
-0008e210: 2063 6f6c 756d 6e20 6e61 6d65 732e 2050   column names. P
-0008e220: 6c65 6173 6520 7265 7365 7420 636f 6c75  lease reset colu
-0008e230: 6d6e 206e 616d 6573 2061 6674 6572 2074  mn names after t
-0008e240: 6869 7320 7374 6570 2e2e 2e27 290d 0a20  his step...').. 
-0008e250: 2020 2072 6574 7572 6e20 6772 6f75 7065     return groupe
-0008e260: 645f 6c69 7374 0d0a 2323 2323 2323 2323  d_list..########
-0008e270: 2323 2323 2323 2323 2323 2323 2323 2323  ################
-0008e280: 2323 2323 2323 2323 2323 2323 2323 2323  ################
-0008e290: 2323 2323 2323 2323 2323 2323 2323 2323  ################
-0008e2a0: 2323 2323 2323 2323 2323 2323 2323 2323  ################
-0008e2b0: 2323 2323 2323 2323 0000 0000 0000 0000  ########........
-0008e2c0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-0008e2d0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-0008e2e0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-0008e2f0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-0008e300: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-0008e310: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-0008e320: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-0008e330: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-0008e340: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-0008e350: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-0008e360: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-0008e370: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-0008e380: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-0008e390: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-0008e3a0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-0008e3b0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-0008e3c0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-0008e3d0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-0008e3e0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-0008e3f0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-0008e400: 2e2f 2e2f 4050 6178 4865 6164 6572 0000  ././@PaxHeader..
-0008e410: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-0008e420: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-0008e430: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-0008e440: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-0008e450: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-0008e460: 0000 0000 3030 3030 3030 3000 3030 3030  ....0000000.0000
-0008e470: 3030 3000 3030 3030 3030 3000 3030 3030  000.0000000.0000
-0008e480: 3030 3030 3032 3600 3030 3030 3030 3030  0000026.00000000
-0008e490: 3030 3000 3031 3134 3533 0020 7800 0000  000.011453. x...
-0008e4a0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-0008e4b0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-0008e4c0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-0008e4d0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-0008e4e0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-0008e4f0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-0008e500: 0075 7374 6172 0030 3000 0000 0000 0000  .ustar.00.......
-0008e510: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-0008e520: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-0008e530: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-0008e540: 0000 0000 0000 0000 0030 3030 3030 3030  .........0000000
-0008e550: 0030 3030 3030 3030 0000 0000 0000 0000  .0000000........
-0008e560: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-0008e570: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-0008e580: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-0008e590: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-0008e5a0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-0008e5b0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-0008e5c0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-0008e5d0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-0008e5e0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-0008e5f0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-0008e600: 3232 206d 7469 6d65 3d31 3637 3831 3539  22 mtime=1678159
-0008e610: 3732 322e 300a 0000 0000 0000 0000 0000  722.0...........
-0008e620: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-0008e630: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-0008e640: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-0008e650: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-0008e660: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-0008e670: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-0008e680: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-0008e690: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-0008e6a0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-0008e6b0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-0008e6c0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-0008e6d0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-0008e6e0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-0008e6f0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-0008e700: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-0008e710: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-0008e720: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-0008e730: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-0008e740: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-0008e750: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-0008e760: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-0008e770: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-0008e780: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-0008e790: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-0008e7a0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-0008e7b0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-0008e7c0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-0008e7d0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-0008e7e0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-0008e7f0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-0008e800: 6175 746f 7669 6d6c 2d30 2e31 2e37 3134  autoviml-0.1.714
-0008e810: 2f61 7574 6f76 696d 6c2f 7375 6c6f 765f  /autoviml/sulov_
-0008e820: 6d65 7468 6f64 2e70 7900 0000 0000 0000  method.py.......
-0008e830: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-0008e840: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-0008e850: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-0008e860: 0000 0000 3030 3030 3737 3700 3030 3031  ....0000777.0001
-0008e870: 3735 3000 3030 3031 3735 3000 3030 3030  750.0001750.0000
-0008e880: 3030 3333 3234 3500 3030 3030 3030 3030  0033245.00000000
-0008e890: 3030 3000 3032 3030 3435 0020 3000 0000  000.020045. 0...
-0008e8a0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-0008e8b0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-0008e8c0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-0008e8d0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-0008e8e0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-0008e8f0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-0008e900: 0075 7374 6172 0030 3072 616d 0000 0000  .ustar.00ram....
-0008e910: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-0008e920: 0000 0000 0000 0000 0072 616d 0000 0000  .........ram....
-0008e930: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-0008e940: 0000 0000 0000 0000 0030 3030 3030 3030  .........0000000
-0008e950: 0030 3030 3030 3030 0000 0000 0000 0000  .0000000........
-0008e960: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-0008e970: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-0008e980: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-0008e990: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-0008e9a0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-0008e9b0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-0008e9c0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-0008e9d0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-0008e9e0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-0008e9f0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-0008ea00: 696d 706f 7274 206e 756d 7079 2061 7320  import numpy as 
-0008ea10: 6e70 0d0a 696d 706f 7274 2070 616e 6461  np..import panda
-0008ea20: 7320 6173 2070 640d 0a69 6d70 6f72 7420  s as pd..import 
-0008ea30: 7261 6e64 6f6d 0d0a 6e70 2e72 616e 646f  random..np.rando
-0008ea40: 6d2e 7365 6564 2839 3929 0d0a 7261 6e64  m.seed(99)..rand
-0008ea50: 6f6d 2e73 6565 6428 3432 290d 0a23 2323  om.seed(42)..###
-0008ea60: 2323 2323 2323 2323 2323 2323 2323 2323  ################
+00082ba0: 2020 2020 2920 3e3d 2069 6e74 2830 2e39      ) >= int(0.9
+00082bb0: 2a6c 656e 2874 7261 696e 2929 2061 6e64  *len(train)) and
+00082bc0: 2063 6f6c 206e 6f74 2069 6e20 7374 7269   col not in stri
+00082bd0: 6e67 5f62 6f6f 6c5f 7661 7273 3a0d 0a20  ng_bool_vars:.. 
+00082be0: 2020 2020 2020 2020 2020 2020 2020 2076                 v
+00082bf0: 6172 5f64 662e 6c6f 635b 7661 725f 6466  ar_df.loc[var_df
+00082c00: 5b27 696e 6465 7827 5d3d 3d63 6f6c 2c27  ['index']==col,'
+00082c10: 6e6c 705f 7374 7269 6e67 7327 5d20 3d20  nlp_strings'] = 
+00082c20: 310d 0a20 2020 2020 2020 2020 2020 2065  1..            e
+00082c30: 6c69 6620 7472 6169 6e5b 636f 6c5d 2e6d  lif train[col].m
+00082c40: 6170 286c 616d 6264 6120 783a 206c 656e  ap(lambda x: len
+00082c50: 2878 2920 6966 2074 7970 6528 7829 3d3d  (x) if type(x)==
+00082c60: 7374 7220 656c 7365 2030 292e 6d65 616e  str else 0).mean
+00082c70: 280d 0a20 2020 2020 2020 2020 2020 2020  (..             
+00082c80: 2020 2029 203e 3d20 6d61 785f 6e6c 705f     ) >= max_nlp_
+00082c90: 6368 6172 5f73 697a 6520 616e 6420 7472  char_size and tr
+00082ca0: 6169 6e5b 636f 6c5d 2e6d 6170 286c 616d  ain[col].map(lam
+00082cb0: 6264 6120 783a 206c 656e 2878 2920 6966  bda x: len(x) if
+00082cc0: 2074 7970 6528 7829 3d3d 7374 7220 656c   type(x)==str el
+00082cd0: 7365 2030 292e 6d61 7828 0d0a 2020 2020  se 0).max(..    
+00082ce0: 2020 2020 2020 2020 2020 2020 2920 3c20              ) < 
+00082cf0: 3530 2061 6e64 206c 656e 2874 7261 696e  50 and len(train
+00082d00: 5b63 6f6c 5d2e 7661 6c75 655f 636f 756e  [col].value_coun
+00082d10: 7473 2829 0d0a 2020 2020 2020 2020 2020  ts()..          
+00082d20: 2020 2020 2020 2020 2020 2020 2020 2920                ) 
+00082d30: 3c3d 2069 6e74 2830 2e39 2a6c 656e 2874  <= int(0.9*len(t
+00082d40: 7261 696e 2929 2061 6e64 2063 6f6c 206e  rain)) and col n
+00082d50: 6f74 2069 6e20 7374 7269 6e67 5f62 6f6f  ot in string_boo
+00082d60: 6c5f 7661 7273 3a0d 0a20 2020 2020 2020  l_vars:..       
+00082d70: 2020 2020 2020 2020 2076 6172 5f64 662e           var_df.
+00082d80: 6c6f 635b 7661 725f 6466 5b27 696e 6465  loc[var_df['inde
+00082d90: 7827 5d3d 3d63 6f6c 2c27 6469 7363 7265  x']==col,'discre
+00082da0: 7465 5f73 7472 696e 6773 275d 203d 2031  te_strings'] = 1
+00082db0: 0d0a 2020 2020 2020 2020 2020 2020 656c  ..            el
+00082dc0: 6966 206c 656e 2874 7261 696e 5b63 6f6c  if len(train[col
+00082dd0: 5d2e 7661 6c75 655f 636f 756e 7473 2829  ].value_counts()
+00082de0: 2920 3e20 6361 745f 6c69 6d69 7420 616e  ) > cat_limit an
+00082df0: 6420 6c65 6e28 7472 6169 6e5b 636f 6c5d  d len(train[col]
+00082e00: 2e76 616c 7565 5f63 6f75 6e74 7328 290d  .value_counts().
+00082e10: 0a20 2020 2020 2020 2020 2020 2020 2020  .               
+00082e20: 2020 2020 2020 2020 2029 203c 3d20 696e           ) <= in
+00082e30: 7428 302e 392a 6c65 6e28 7472 6169 6e29  t(0.9*len(train)
+00082e40: 2920 616e 6420 636f 6c20 6e6f 7420 696e  ) and col not in
+00082e50: 2073 7472 696e 675f 626f 6f6c 5f76 6172   string_bool_var
+00082e60: 733a 0d0a 2020 2020 2020 2020 2020 2020  s:..            
+00082e70: 2020 2020 7661 725f 6466 2e6c 6f63 5b76      var_df.loc[v
+00082e80: 6172 5f64 665b 2769 6e64 6578 275d 3d3d  ar_df['index']==
+00082e90: 636f 6c2c 2764 6973 6372 6574 655f 7374  col,'discrete_st
+00082ea0: 7269 6e67 7327 5d20 3d20 310d 0a20 2020  rings'] = 1..   
+00082eb0: 2020 2020 2020 2020 2065 6c69 6620 6c65           elif le
+00082ec0: 6e28 7472 6169 6e5b 636f 6c5d 2e76 616c  n(train[col].val
+00082ed0: 7565 5f63 6f75 6e74 7328 2929 203e 2063  ue_counts()) > c
+00082ee0: 6174 5f6c 696d 6974 2061 6e64 206c 656e  at_limit and len
+00082ef0: 2874 7261 696e 5b63 6f6c 5d2e 7661 6c75  (train[col].valu
+00082f00: 655f 636f 756e 7473 2829 0d0a 2020 2020  e_counts()..    
+00082f10: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00082f20: 2020 2020 2920 3d3d 206c 656e 2874 7261      ) == len(tra
+00082f30: 696e 2920 616e 6420 636f 6c20 6e6f 7420  in) and col not 
+00082f40: 696e 2073 7472 696e 675f 626f 6f6c 5f76  in string_bool_v
+00082f50: 6172 733a 0d0a 2020 2020 2020 2020 2020  ars:..          
+00082f60: 2020 2020 2020 7661 725f 6466 2e6c 6f63        var_df.loc
+00082f70: 5b76 6172 5f64 665b 2769 6e64 6578 275d  [var_df['index']
+00082f80: 3d3d 636f 6c2c 2769 645f 636f 6c27 5d20  ==col,'id_col'] 
+00082f90: 3d20 310d 0a20 2020 2020 2020 2020 2020  = 1..           
+00082fa0: 2065 6c73 653a 0d0a 2020 2020 2020 2020   else:..        
+00082fb0: 2020 2020 2020 2020 7661 725f 6466 2e6c          var_df.l
+00082fc0: 6f63 5b76 6172 5f64 665b 2769 6e64 6578  oc[var_df['index
+00082fd0: 275d 3d3d 636f 6c2c 2763 6174 275d 203d  ']==col,'cat'] =
+00082fe0: 2031 0d0a 2020 2020 6e6c 705f 7661 7273   1..    nlp_vars
+00082ff0: 203d 206c 6973 7428 7661 725f 6466 5b28   = list(var_df[(
+00083000: 7661 725f 6466 5b27 6e6c 705f 7374 7269  var_df['nlp_stri
+00083010: 6e67 7327 5d20 3d3d 3129 5d5b 2769 6e64  ngs'] ==1)]['ind
+00083020: 6578 275d 290d 0a20 2020 2073 756d 5f61  ex'])..    sum_a
+00083030: 6c6c 5f63 6f6c 735b 276e 6c70 5f76 6172  ll_cols['nlp_var
+00083040: 7327 5d20 3d20 6e6c 705f 7661 7273 0d0a  s'] = nlp_vars..
+00083050: 2020 2020 6469 7363 7265 7465 5f73 7472      discrete_str
+00083060: 696e 675f 7661 7273 203d 206c 6973 7428  ing_vars = list(
+00083070: 7661 725f 6466 5b28 7661 725f 6466 5b27  var_df[(var_df['
+00083080: 6469 7363 7265 7465 5f73 7472 696e 6773  discrete_strings
+00083090: 275d 203d 3d31 2920 5d5b 2769 6e64 6578  '] ==1) ]['index
+000830a0: 275d 290d 0a20 2020 2073 756d 5f61 6c6c  '])..    sum_all
+000830b0: 5f63 6f6c 735b 2764 6973 6372 6574 655f  _cols['discrete_
+000830c0: 7374 7269 6e67 5f76 6172 7327 5d20 3d20  string_vars'] = 
+000830d0: 6469 7363 7265 7465 5f73 7472 696e 675f  discrete_string_
+000830e0: 7661 7273 0d0a 2020 2020 2323 2323 2323  vars..    ######
+000830f0: 2054 6869 7320 6861 7070 656e 7320 6f6e   This happens on
+00083100: 6c79 2069 6620 6120 7374 7269 6e67 2063  ly if a string c
+00083110: 6f6c 756d 6e20 6861 7070 656e 7320 746f  olumn happens to
+00083120: 2062 6520 616e 2049 4420 636f 6c75 6d6e   be an ID column
+00083130: 2023 2323 2323 2323 0d0a 2020 2020 2323   #######..    ##
+00083140: 2323 2044 4f20 4e4f 5420 4164 6420 7468  ## DO NOT Add th
+00083150: 6973 2074 6f20 4944 5f56 4152 5320 7965  is to ID_VARS ye
+00083160: 742e 2049 7420 7769 6c6c 2062 6520 646f  t. It will be do
+00083170: 6e65 206c 6174 6572 2e2e 2044 6f6e 7420  ne later.. Dont 
+00083180: 6368 616e 6765 2069 7420 6561 7369 6c79  change it easily
+00083190: 2e2e 2e0d 0a20 2020 2023 2323 2320 4361  .....    #### Ca
+000831a0: 7465 676f 7279 2044 5459 5045 2076 6172  tegory DTYPE var
+000831b0: 7320 6172 6520 7665 7279 2073 7065 6369  s are very speci
+000831c0: 616c 203d 2074 6865 7920 6361 6e20 6265  al = they can be
+000831d0: 206c 6566 7420 6173 2069 7320 616e 6420   left as is and 
+000831e0: 6e6f 7420 6469 7374 7572 6265 6420 696e  not disturbed in
+000831f0: 2050 7974 686f 6e2e 2023 2323 0d0a 2020   Python. ###..  
+00083200: 2020 7661 725f 6466 5b27 6463 6174 275d    var_df['dcat']
+00083210: 203d 2076 6172 5f64 662e 6170 706c 7928   = var_df.apply(
+00083220: 6c61 6d62 6461 2078 3a20 3120 6966 2073  lambda x: 1 if s
+00083230: 7472 2878 5b27 7479 7065 5f6f 665f 636f  tr(x['type_of_co
+00083240: 6c75 6d6e 275d 293d 3d27 6361 7465 676f  lumn'])=='catego
+00083250: 7279 2720 656c 7365 2030 2c0d 0a20 2020  ry' else 0,..   
+00083260: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00083270: 2020 2020 2020 2020 2061 7869 733d 3129           axis=1)
+00083280: 0d0a 2020 2020 6661 6374 6f72 5f76 6172  ..    factor_var
+00083290: 7320 3d20 6c69 7374 2876 6172 5f64 665b  s = list(var_df[
+000832a0: 2876 6172 5f64 665b 2764 6361 7427 5d20  (var_df['dcat'] 
+000832b0: 3d3d 3129 5d5b 2769 6e64 6578 275d 290d  ==1)]['index']).
+000832c0: 0a20 2020 2073 756d 5f61 6c6c 5f63 6f6c  .    sum_all_col
+000832d0: 735b 2766 6163 746f 725f 7661 7273 275d  s['factor_vars']
+000832e0: 203d 2066 6163 746f 725f 7661 7273 0d0a   = factor_vars..
+000832f0: 2020 2020 2323 2323 2323 2323 2323 2323      ############
+00083300: 2323 2323 2323 2323 2323 2323 2323 2323  ################
+00083310: 2323 2323 2323 2323 2323 2323 2323 2323  ################
+00083320: 2323 2323 2323 2323 2323 2323 2323 2323  ################
+00083330: 2323 2323 2323 2323 2323 2323 0d0a 2020  ############..  
+00083340: 2020 6461 7465 5f6f 725f 6964 203d 2076    date_or_id = v
+00083350: 6172 5f64 662e 6170 706c 7928 6c61 6d62  ar_df.apply(lamb
+00083360: 6461 2078 3a20 3120 6966 2078 5b27 7479  da x: 1 if x['ty
+00083370: 7065 5f6f 665f 636f 6c75 6d6e 275d 2069  pe_of_column'] i
+00083380: 6e20 5b6e 702e 7569 6e74 382c 0d0a 2020  n [np.uint8,..  
+00083390: 2020 2020 2020 2020 2020 2020 2020 2020                  
+000833a0: 2020 2020 2020 206e 702e 7569 6e74 3136         np.uint16
+000833b0: 2c20 6e70 2e75 696e 7433 322c 206e 702e  , np.uint32, np.
+000833c0: 7569 6e74 3634 2c0d 0a20 2020 2020 2020  uint64,..       
+000833d0: 2020 2020 2020 2020 2020 2020 2020 2020                  
+000833e0: 2020 2769 6e74 3827 2c27 696e 7431 3627    'int8','int16'
+000833f0: 2c0d 0a20 2020 2020 2020 2020 2020 2020  ,..             
+00083400: 2020 2020 2020 2020 2020 2027 696e 7433             'int3
+00083410: 3227 2c27 696e 7436 3427 5d20 2061 6e64  2','int64']  and
+00083420: 2078 5b0d 0a20 2020 2020 2020 2027 696e   x[..        'in
+00083430: 6465 7827 5d20 6e6f 7420 696e 2073 7472  dex'] not in str
+00083440: 696e 675f 626f 6f6c 5f76 6172 732b 6e75  ing_bool_vars+nu
+00083450: 6d5f 626f 6f6c 5f76 6172 732b 6469 7363  m_bool_vars+disc
+00083460: 7265 7465 5f73 7472 696e 675f 7661 7273  rete_string_vars
+00083470: 2b6e 6c70 5f76 6172 7320 656c 7365 2030  +nlp_vars else 0
+00083480: 2c0d 0a20 2020 2020 2020 2020 2020 2020  ,..             
+00083490: 2020 2020 2020 2020 2020 2020 2020 2020                  
+000834a0: 2020 2020 2020 2020 2020 2061 7869 733d             axis=
+000834b0: 3129 0d0a 2020 2020 2323 2323 2323 2323  1)..    ########
+000834c0: 2320 5468 6973 2069 7320 7768 6572 6520  # This is where 
+000834d0: 7765 2066 6967 7572 6520 6f75 7420 7768  we figure out wh
+000834e0: 6574 6865 7220 6120 6e75 6d65 7269 6320  ether a numeric 
+000834f0: 636f 6c20 6973 2064 6174 6520 6f72 2069  col is date or i
+00083500: 6420 7661 7269 6162 6c65 2023 2323 0d0a  d variable ###..
+00083510: 2020 2020 7661 725f 6466 5b27 696e 7427      var_df['int'
+00083520: 5d20 3d20 300d 0a20 2020 2076 6172 5f64  ] = 0..    var_d
+00083530: 665b 2764 6174 655f 7469 6d65 275d 203d  f['date_time'] =
+00083540: 2030 0d0a 2020 2020 2323 2320 6966 2061   0..    ### if a
+00083550: 2070 6172 7469 6375 6c61 7220 636f 6c75   particular colu
+00083560: 6d6e 2069 7320 6461 7465 2d74 696d 6520  mn is date-time 
+00083570: 7479 7065 2c20 6e6f 7720 7365 7420 6974  type, now set it
+00083580: 2061 7320 6120 6461 7465 2074 696d 6520   as a date time 
+00083590: 7661 7269 6162 6c65 2023 230d 0a20 2020  variable ##..   
+000835a0: 2076 6172 5f64 665b 2764 6174 655f 7469   var_df['date_ti
+000835b0: 6d65 275d 203d 2076 6172 5f64 662e 6170  me'] = var_df.ap
+000835c0: 706c 7928 6c61 6d62 6461 2078 3a20 3120  ply(lambda x: 1 
+000835d0: 6966 2078 5b27 7479 7065 5f6f 665f 636f  if x['type_of_co
+000835e0: 6c75 6d6e 275d 2069 6e20 5b27 3c4d 385b  lumn'] in ['<M8[
+000835f0: 6e73 5d27 2c27 6461 7465 7469 6d65 3634  ns]','datetime64
+00083600: 5b6e 735d 275d 2020 616e 6420 785b 0d0a  [ns]']  and x[..
+00083610: 2020 2020 2020 2020 2769 6e64 6578 275d          'index']
+00083620: 206e 6f74 2069 6e20 7374 7269 6e67 5f62   not in string_b
+00083630: 6f6f 6c5f 7661 7273 2b6e 756d 5f62 6f6f  ool_vars+num_boo
+00083640: 6c5f 7661 7273 2b64 6973 6372 6574 655f  l_vars+discrete_
+00083650: 7374 7269 6e67 5f76 6172 732b 6e6c 705f  string_vars+nlp_
+00083660: 7661 7273 2065 6c73 6520 302c 0d0a 2020  vars else 0,..  
+00083670: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00083680: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00083690: 2020 2020 2020 6178 6973 3d31 290d 0a20        axis=1).. 
+000836a0: 2020 2023 2323 2074 6869 7320 6973 2077     ### this is w
+000836b0: 6865 7265 2077 6520 7361 7665 2074 6865  here we save the
+000836c0: 6d20 6173 2064 6174 6520 7469 6d65 2076  m as date time v
+000836d0: 6172 6961 626c 6573 2023 2323 0d0a 2020  ariables ###..  
+000836e0: 2020 6966 206c 656e 2876 6172 5f64 662e    if len(var_df.
+000836f0: 6c6f 635b 6461 7465 5f6f 725f 6964 3d3d  loc[date_or_id==
+00083700: 315d 2920 213d 2030 3a0d 0a20 2020 2020  1]) != 0:..     
+00083710: 2020 2066 6f72 2063 6f6c 2069 6e20 7661     for col in va
+00083720: 725f 6466 2e6c 6f63 5b64 6174 655f 6f72  r_df.loc[date_or
+00083730: 5f69 643d 3d31 5d5b 2769 6e64 6578 275d  _id==1]['index']
+00083740: 2e76 616c 7565 732e 746f 6c69 7374 2829  .values.tolist()
+00083750: 3a0d 0a20 2020 2020 2020 2020 2020 2069  :..            i
+00083760: 6620 6c65 6e28 7472 6169 6e5b 636f 6c5d  f len(train[col]
+00083770: 2e76 616c 7565 5f63 6f75 6e74 7328 2929  .value_counts())
+00083780: 203d 3d20 6c65 6e28 7472 6169 6e29 3a0d   == len(train):.
+00083790: 0a20 2020 2020 2020 2020 2020 2020 2020  .               
+000837a0: 2069 6620 7472 6169 6e5b 636f 6c5d 2e6d   if train[col].m
+000837b0: 696e 2829 203c 2031 3930 3020 6f72 2074  in() < 1900 or t
+000837c0: 7261 696e 5b63 6f6c 5d2e 6d61 7828 2920  rain[col].max() 
+000837d0: 3e20 3230 3530 3a0d 0a20 2020 2020 2020  > 2050:..       
+000837e0: 2020 2020 2020 2020 2020 2020 2076 6172               var
+000837f0: 5f64 662e 6c6f 635b 7661 725f 6466 5b27  _df.loc[var_df['
+00083800: 696e 6465 7827 5d3d 3d63 6f6c 2c27 6964  index']==col,'id
+00083810: 5f63 6f6c 275d 203d 2031 0d0a 2020 2020  _col'] = 1..    
+00083820: 2020 2020 2020 2020 2020 2020 656c 7365              else
+00083830: 3a0d 0a20 2020 2020 2020 2020 2020 2020  :..             
+00083840: 2020 2020 2020 2074 7279 3a0d 0a20 2020         try:..   
+00083850: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00083860: 2020 2020 2070 642e 746f 5f64 6174 6574       pd.to_datet
+00083870: 696d 6528 7472 6169 6e5b 636f 6c5d 2c69  ime(train[col],i
+00083880: 6e66 6572 5f64 6174 6574 696d 655f 666f  nfer_datetime_fo
+00083890: 726d 6174 3d54 7275 6529 0d0a 2020 2020  rmat=True)..    
+000838a0: 2020 2020 2020 2020 2020 2020 2020 2020                  
+000838b0: 2020 2020 7661 725f 6466 2e6c 6f63 5b76      var_df.loc[v
+000838c0: 6172 5f64 665b 2769 6e64 6578 275d 3d3d  ar_df['index']==
+000838d0: 636f 6c2c 2764 6174 655f 7469 6d65 275d  col,'date_time']
+000838e0: 203d 2031 0d0a 2020 2020 2020 2020 2020   = 1..          
+000838f0: 2020 2020 2020 2020 2020 6578 6365 7074            except
+00083900: 3a0d 0a20 2020 2020 2020 2020 2020 2020  :..             
+00083910: 2020 2020 2020 2020 2020 2076 6172 5f64             var_d
+00083920: 662e 6c6f 635b 7661 725f 6466 5b27 696e  f.loc[var_df['in
+00083930: 6465 7827 5d3d 3d63 6f6c 2c27 6964 5f63  dex']==col,'id_c
+00083940: 6f6c 275d 203d 2031 0d0a 2020 2020 2020  ol'] = 1..      
+00083950: 2020 2020 2020 656c 7365 3a0d 0a20 2020        else:..   
+00083960: 2020 2020 2020 2020 2020 2020 2069 6620               if 
+00083970: 7472 6169 6e5b 636f 6c5d 2e6d 696e 2829  train[col].min()
+00083980: 203c 2031 3930 3020 6f72 2074 7261 696e   < 1900 or train
+00083990: 5b63 6f6c 5d2e 6d61 7828 2920 3e20 3230  [col].max() > 20
+000839a0: 3530 3a0d 0a20 2020 2020 2020 2020 2020  50:..           
+000839b0: 2020 2020 2020 2020 2069 6620 636f 6c20           if col 
+000839c0: 6e6f 7420 696e 206e 756d 5f62 6f6f 6c5f  not in num_bool_
+000839d0: 7661 7273 3a0d 0a20 2020 2020 2020 2020  vars:..         
+000839e0: 2020 2020 2020 2020 2020 2020 2020 2076                 v
+000839f0: 6172 5f64 662e 6c6f 635b 7661 725f 6466  ar_df.loc[var_df
+00083a00: 5b27 696e 6465 7827 5d3d 3d63 6f6c 2c27  ['index']==col,'
+00083a10: 696e 7427 5d20 3d20 310d 0a20 2020 2020  int'] = 1..     
+00083a20: 2020 2020 2020 2020 2020 2065 6c73 653a             else:
+00083a30: 0d0a 2020 2020 2020 2020 2020 2020 2020  ..              
+00083a40: 2020 2020 2020 7472 793a 0d0a 2020 2020        try:..    
+00083a50: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00083a60: 2020 2020 7064 2e74 6f5f 6461 7465 7469      pd.to_dateti
+00083a70: 6d65 2874 7261 696e 5b63 6f6c 5d2c 696e  me(train[col],in
+00083a80: 6665 725f 6461 7465 7469 6d65 5f66 6f72  fer_datetime_for
+00083a90: 6d61 743d 5472 7565 290d 0a20 2020 2020  mat=True)..     
+00083aa0: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00083ab0: 2020 2076 6172 5f64 662e 6c6f 635b 7661     var_df.loc[va
+00083ac0: 725f 6466 5b27 696e 6465 7827 5d3d 3d63  r_df['index']==c
+00083ad0: 6f6c 2c27 6461 7465 5f74 696d 6527 5d20  ol,'date_time'] 
+00083ae0: 3d20 310d 0a20 2020 2020 2020 2020 2020  = 1..           
+00083af0: 2020 2020 2020 2020 2065 7863 6570 743a           except:
+00083b00: 0d0a 2020 2020 2020 2020 2020 2020 2020  ..              
+00083b10: 2020 2020 2020 2020 2020 6966 2063 6f6c            if col
+00083b20: 206e 6f74 2069 6e20 6e75 6d5f 626f 6f6c   not in num_bool
+00083b30: 5f76 6172 733a 0d0a 2020 2020 2020 2020  _vars:..        
+00083b40: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00083b50: 2020 2020 7661 725f 6466 2e6c 6f63 5b76      var_df.loc[v
+00083b60: 6172 5f64 665b 2769 6e64 6578 275d 3d3d  ar_df['index']==
+00083b70: 636f 6c2c 2769 6e74 275d 203d 2031 0d0a  col,'int'] = 1..
+00083b80: 2020 2020 656c 7365 3a0d 0a20 2020 2020      else:..     
+00083b90: 2020 2070 6173 730d 0a20 2020 2069 6e74     pass..    int
+00083ba0: 5f76 6172 7320 3d20 6c69 7374 2876 6172  _vars = list(var
+00083bb0: 5f64 665b 2876 6172 5f64 665b 2769 6e74  _df[(var_df['int
+00083bc0: 275d 203d 3d31 295d 5b27 696e 6465 7827  '] ==1)]['index'
+00083bd0: 5d29 0d0a 2020 2020 6461 7465 5f76 6172  ])..    date_var
+00083be0: 7320 3d20 6c69 7374 2876 6172 5f64 665b  s = list(var_df[
+00083bf0: 2876 6172 5f64 665b 2764 6174 655f 7469  (var_df['date_ti
+00083c00: 6d65 275d 203d 3d20 3129 5d5b 2769 6e64  me'] == 1)]['ind
+00083c10: 6578 275d 290d 0a20 2020 2069 645f 7661  ex'])..    id_va
+00083c20: 7273 203d 206c 6973 7428 7661 725f 6466  rs = list(var_df
+00083c30: 5b28 7661 725f 6466 5b27 6964 5f63 6f6c  [(var_df['id_col
+00083c40: 275d 203d 3d20 3129 5d5b 2769 6e64 6578  '] == 1)]['index
+00083c50: 275d 290d 0a20 2020 2073 756d 5f61 6c6c  '])..    sum_all
+00083c60: 5f63 6f6c 735b 2769 6e74 5f76 6172 7327  _cols['int_vars'
+00083c70: 5d20 3d20 696e 745f 7661 7273 0d0a 2020  ] = int_vars..  
+00083c80: 2020 636f 7079 5f64 6174 655f 7661 7273    copy_date_vars
+00083c90: 203d 2063 6f70 792e 6465 6570 636f 7079   = copy.deepcopy
+00083ca0: 2864 6174 655f 7661 7273 290d 0a20 2020  (date_vars)..   
+00083cb0: 2066 6f72 2064 6174 655f 7661 7220 696e   for date_var in
+00083cc0: 2063 6f70 795f 6461 7465 5f76 6172 733a   copy_date_vars:
+00083cd0: 0d0a 2020 2020 2020 2020 2323 2323 2054  ..        #### T
+00083ce0: 6869 7320 7465 7374 2069 7320 746f 206d  his test is to m
+00083cf0: 616b 6520 7375 7265 2073 7572 6520 6461  ake sure sure da
+00083d00: 7465 2076 6172 7320 6172 6520 6163 7475  te vars are actu
+00083d10: 616c 6c79 2064 6174 6520 7661 7273 0d0a  ally date vars..
+00083d20: 2020 2020 2020 2020 7472 793a 0d0a 2020          try:..  
+00083d30: 2020 2020 2020 2020 2020 7064 2e74 6f5f            pd.to_
+00083d40: 6461 7465 7469 6d65 2874 7261 696e 5b64  datetime(train[d
+00083d50: 6174 655f 7661 725d 2c69 6e66 6572 5f64  ate_var],infer_d
+00083d60: 6174 6574 696d 655f 666f 726d 6174 3d54  atetime_format=T
+00083d70: 7275 6529 0d0a 2020 2020 2020 2020 6578  rue)..        ex
+00083d80: 6365 7074 3a0d 0a20 2020 2020 2020 2020  cept:..         
+00083d90: 2020 2023 2323 2323 2069 6620 6e6f 7420     ##### if not 
+00083da0: 6120 6461 7465 2076 6172 2c20 7468 656e  a date var, then
+00083db0: 206a 7573 7420 6164 6420 6974 2074 6f20   just add it to 
+00083dc0: 6465 6c65 7465 2069 7420 6672 6f6d 2070  delete it from p
+00083dd0: 726f 6365 7373 696e 670d 0a20 2020 2020  rocessing..     
+00083de0: 2020 2020 2020 2063 6f6c 735f 6465 6c65         cols_dele
+00083df0: 7465 2e61 7070 656e 6428 6461 7465 5f76  te.append(date_v
+00083e00: 6172 290d 0a20 2020 2020 2020 2020 2020  ar)..           
+00083e10: 2064 6174 655f 7661 7273 2e72 656d 6f76   date_vars.remov
+00083e20: 6528 6461 7465 5f76 6172 290d 0a20 2020  e(date_var)..   
+00083e30: 2073 756d 5f61 6c6c 5f63 6f6c 735b 2764   sum_all_cols['d
+00083e40: 6174 655f 7661 7273 275d 203d 2064 6174  ate_vars'] = dat
+00083e50: 655f 7661 7273 0d0a 2020 2020 7375 6d5f  e_vars..    sum_
+00083e60: 616c 6c5f 636f 6c73 5b27 6964 5f76 6172  all_cols['id_var
+00083e70: 7327 5d20 3d20 6964 5f76 6172 730d 0a20  s'] = id_vars.. 
+00083e80: 2020 2073 756d 5f61 6c6c 5f63 6f6c 735b     sum_all_cols[
+00083e90: 2763 6f6c 735f 6465 6c65 7465 275d 203d  'cols_delete'] =
+00083ea0: 2063 6f6c 735f 6465 6c65 7465 0d0a 2020   cols_delete..  
+00083eb0: 2020 2323 2054 6869 7320 6973 2061 6e20    ## This is an 
+00083ec0: 4558 5452 454d 454c 5920 636f 6d70 6c69  EXTREMELY compli
+00083ed0: 6361 7465 6420 6c6f 6769 6320 666f 7220  cated logic for 
+00083ee0: 6361 7420 7661 7273 2e20 446f 6e27 7420  cat vars. Don't 
+00083ef0: 6368 616e 6765 2069 7420 756e 6c65 7373  change it unless
+00083f00: 2079 6f75 2074 6573 7420 6974 206d 616e   you test it man
+00083f10: 7920 7469 6d65 7321 0d0a 2020 2020 7661  y times!..    va
+00083f20: 725f 6466 5b27 6e75 6d65 7269 6327 5d20  r_df['numeric'] 
+00083f30: 3d20 300d 0a20 2020 2066 6c6f 6174 5f6f  = 0..    float_o
+00083f40: 725f 6361 7420 3d20 7661 725f 6466 2e61  r_cat = var_df.a
+00083f50: 7070 6c79 286c 616d 6264 6120 783a 2031  pply(lambda x: 1
+00083f60: 2069 6620 785b 2774 7970 655f 6f66 5f63   if x['type_of_c
+00083f70: 6f6c 756d 6e27 5d20 696e 205b 2766 6c6f  olumn'] in ['flo
+00083f80: 6174 3136 272c 0d0a 2020 2020 2020 2020  at16',..        
+00083f90: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00083fa0: 2020 2020 2766 6c6f 6174 3332 272c 2766      'float32','f
+00083fb0: 6c6f 6174 3634 275d 2065 6c73 6520 302c  loat64'] else 0,
+00083fc0: 0d0a 2020 2020 2020 2020 2020 2020 2020  ..              
+00083fd0: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00083fe0: 2020 2020 2020 2020 2020 6178 6973 3d31            axis=1
+00083ff0: 290d 0a20 2020 2023 2323 2323 2323 2020  )..    #######  
+00084000: 5765 206e 6565 6420 746f 206d 616b 6520  We need to make 
+00084010: 7375 7265 2074 6865 7265 2061 7265 206e  sure there are n
+00084020: 6f20 6361 7465 676f 7269 6361 6c20 7661  o categorical va
+00084030: 7273 2069 6e20 666c 6f61 7420 2323 2323  rs in float ####
+00084040: 2323 230d 0a20 2020 2069 6620 6c65 6e28  ###..    if len(
+00084050: 7661 725f 6466 2e6c 6f63 5b66 6c6f 6174  var_df.loc[float
+00084060: 5f6f 725f 6361 7420 3d3d 2031 5d29 203e  _or_cat == 1]) >
+00084070: 2030 3a0d 0a20 2020 2020 2020 2066 6f72   0:..        for
+00084080: 2063 6f6c 2069 6e20 7661 725f 6466 2e6c   col in var_df.l
+00084090: 6f63 5b66 6c6f 6174 5f6f 725f 6361 7420  oc[float_or_cat 
+000840a0: 3d3d 2031 5d5b 2769 6e64 6578 275d 2e76  == 1]['index'].v
+000840b0: 616c 7565 732e 746f 6c69 7374 2829 3a0d  alues.tolist():.
+000840c0: 0a20 2020 2020 2020 2020 2020 2069 6620  .            if 
+000840d0: 6c65 6e28 7472 6169 6e5b 636f 6c5d 2e76  len(train[col].v
+000840e0: 616c 7565 5f63 6f75 6e74 7328 2929 203e  alue_counts()) >
+000840f0: 2032 2061 6e64 206c 656e 2874 7261 696e   2 and len(train
+00084100: 5b63 6f6c 5d2e 7661 6c75 655f 636f 756e  [col].value_coun
+00084110: 7473 2829 0d0a 2020 2020 2020 2020 2020  ts()..          
+00084120: 2020 2020 2020 2920 3c3d 2066 6c6f 6174        ) <= float
+00084130: 5f6c 696d 6974 2061 6e64 206c 656e 2874  _limit and len(t
+00084140: 7261 696e 5b63 6f6c 5d2e 7661 6c75 655f  rain[col].value_
+00084150: 636f 756e 7473 2829 2920 3c3d 206c 656e  counts()) <= len
+00084160: 2874 7261 696e 293a 0d0a 2020 2020 2020  (train):..      
+00084170: 2020 2020 2020 2020 2020 7661 725f 6466            var_df
+00084180: 2e6c 6f63 5b76 6172 5f64 665b 2769 6e64  .loc[var_df['ind
+00084190: 6578 275d 3d3d 636f 6c2c 2763 6174 275d  ex']==col,'cat']
+000841a0: 203d 2031 0d0a 2020 2020 2020 2020 2020   = 1..          
+000841b0: 2020 656c 7365 3a0d 0a20 2020 2020 2020    else:..       
+000841c0: 2020 2020 2020 2020 2069 6620 636f 6c20           if col 
+000841d0: 6e6f 7420 696e 2028 6e75 6d5f 626f 6f6c  not in (num_bool
+000841e0: 5f76 6172 7320 2b20 6661 6374 6f72 5f76  _vars + factor_v
+000841f0: 6172 7329 3a0d 0a20 2020 2020 2020 2020  ars):..         
+00084200: 2020 2020 2020 2020 2020 2076 6172 5f64             var_d
+00084210: 662e 6c6f 635b 7661 725f 6466 5b27 696e  f.loc[var_df['in
+00084220: 6465 7827 5d3d 3d63 6f6c 2c27 6e75 6d65  dex']==col,'nume
+00084230: 7269 6327 5d20 3d20 310d 0a20 2020 2063  ric'] = 1..    c
+00084240: 6174 5f76 6172 7320 3d20 6c69 7374 2876  at_vars = list(v
+00084250: 6172 5f64 665b 2876 6172 5f64 665b 2763  ar_df[(var_df['c
+00084260: 6174 275d 203d 3d31 295d 5b27 696e 6465  at'] ==1)]['inde
+00084270: 7827 5d29 0d0a 2020 2020 636f 6e74 696e  x'])..    contin
+00084280: 756f 7573 5f76 6172 7320 3d20 6c69 7374  uous_vars = list
+00084290: 2876 6172 5f64 665b 2876 6172 5f64 665b  (var_df[(var_df[
+000842a0: 276e 756d 6572 6963 275d 203d 3d31 295d  'numeric'] ==1)]
+000842b0: 5b27 696e 6465 7827 5d29 0d0a 2020 2020  ['index'])..    
+000842c0: 0d0a 2020 2020 2323 2323 2323 2323 2020  ..    ########  
+000842d0: 5620 4520 5220 5920 2020 2049 204d 2050  V E R Y    I M P
+000842e0: 204f 2052 2054 2041 204e 2054 2020 2023   O R T A N T   #
+000842f0: 2323 2323 2323 2323 2323 2323 2323 2323  ################
+00084300: 2323 2323 2323 2323 2323 2323 2323 2323  ################
+00084310: 2323 2323 2323 2323 2323 2323 2323 2323  ################
+00084320: 2323 0d0a 2020 2020 6361 745f 7661 7273  ##..    cat_vars
+00084330: 5f63 6f70 7920 3d20 636f 7079 2e64 6565  _copy = copy.dee
+00084340: 7063 6f70 7928 6661 6374 6f72 5f76 6172  pcopy(factor_var
+00084350: 7329 200d 0a20 2020 2066 6f72 2063 6174  s) ..    for cat
+00084360: 2069 6e20 6361 745f 7661 7273 5f63 6f70   in cat_vars_cop
+00084370: 793a 0d0a 2020 2020 2020 2020 6966 2064  y:..        if d
+00084380: 665f 7072 6564 735b 6361 745d 2e64 7479  f_preds[cat].dty
+00084390: 7065 3d3d 666c 6f61 743a 0d0a 2020 2020  pe==float:..    
+000843a0: 2020 2020 2020 2020 636f 6e74 696e 756f          continuo
+000843b0: 7573 5f76 6172 732e 6170 7065 6e64 2863  us_vars.append(c
+000843c0: 6174 290d 0a20 2020 2020 2020 2020 2020  at)..           
+000843d0: 2066 6163 746f 725f 7661 7273 2e72 656d   factor_vars.rem
+000843e0: 6f76 6528 6361 7429 0d0a 2020 2020 2020  ove(cat)..      
+000843f0: 2020 2020 2020 7661 725f 6466 2e6c 6f63        var_df.loc
+00084400: 5b76 6172 5f64 665b 2769 6e64 6578 275d  [var_df['index']
+00084410: 3d3d 6361 742c 2764 6361 7427 5d20 3d20  ==cat,'dcat'] = 
+00084420: 300d 0a20 2020 2020 2020 2020 2020 2076  0..            v
+00084430: 6172 5f64 662e 6c6f 635b 7661 725f 6466  ar_df.loc[var_df
+00084440: 5b27 696e 6465 7827 5d3d 3d63 6174 2c27  ['index']==cat,'
+00084450: 6e75 6d65 7269 6327 5d20 3d20 310d 0a20  numeric'] = 1.. 
+00084460: 2020 2020 2020 2065 6c69 6620 6c65 6e28         elif len(
+00084470: 6466 5f70 7265 6473 5b63 6174 5d2e 7661  df_preds[cat].va
+00084480: 6c75 655f 636f 756e 7473 2829 2920 3d3d  lue_counts()) ==
+00084490: 2064 665f 7072 6564 732e 7368 6170 655b   df_preds.shape[
+000844a0: 305d 3a0d 0a20 2020 2020 2020 2020 2020  0]:..           
+000844b0: 2069 645f 7661 7273 2e61 7070 656e 6428   id_vars.append(
+000844c0: 6361 7429 0d0a 2020 2020 2020 2020 2020  cat)..          
+000844d0: 2020 6661 6374 6f72 5f76 6172 732e 7265    factor_vars.re
+000844e0: 6d6f 7665 2863 6174 290d 0a20 2020 2020  move(cat)..     
+000844f0: 2020 2020 2020 2076 6172 5f64 662e 6c6f         var_df.lo
+00084500: 635b 7661 725f 6466 5b27 696e 6465 7827  c[var_df['index'
+00084510: 5d3d 3d63 6174 2c27 6463 6174 275d 203d  ]==cat,'dcat'] =
+00084520: 2030 0d0a 2020 2020 2020 2020 2020 2020   0..            
+00084530: 7661 725f 6466 2e6c 6f63 5b76 6172 5f64  var_df.loc[var_d
+00084540: 665b 2769 6e64 6578 275d 3d3d 6361 742c  f['index']==cat,
+00084550: 2769 645f 636f 6c27 5d20 3d20 310d 0a20  'id_col'] = 1.. 
+00084560: 2020 200d 0a20 2020 2073 756d 5f61 6c6c     ..    sum_all
+00084570: 5f63 6f6c 735b 2766 6163 746f 725f 7661  _cols['factor_va
+00084580: 7273 275d 203d 2066 6163 746f 725f 7661  rs'] = factor_va
+00084590: 7273 0d0a 2020 2020 2323 2323 2320 5468  rs..    ##### Th
+000845a0: 6572 6520 6172 6520 6120 636f 7570 6c65  ere are a couple
+000845b0: 206f 6620 6578 7472 6120 7465 7374 7320   of extra tests 
+000845c0: 796f 7520 6e65 6564 2074 6f20 646f 2074  you need to do t
+000845d0: 6f20 7265 6d6f 7665 2061 6262 6572 6174  o remove abberat
+000845e0: 696f 6e73 2069 6e20 6361 745f 7661 7273  ions in cat_vars
+000845f0: 2023 2323 0d0a 2020 2020 6361 745f 7661   ###..    cat_va
+00084600: 7273 5f63 6f70 7920 3d20 636f 7079 2e64  rs_copy = copy.d
+00084610: 6565 7063 6f70 7928 6361 745f 7661 7273  eepcopy(cat_vars
+00084620: 2920 0d0a 2020 2020 666f 7220 6361 7420  ) ..    for cat 
+00084630: 696e 2063 6174 5f76 6172 735f 636f 7079  in cat_vars_copy
+00084640: 3a0d 0a20 2020 2020 2020 2069 6620 6466  :..        if df
+00084650: 5f70 7265 6473 5b63 6174 5d2e 6474 7970  _preds[cat].dtyp
+00084660: 653d 3d66 6c6f 6174 3a0d 0a20 2020 2020  e==float:..     
+00084670: 2020 2020 2020 2063 6f6e 7469 6e75 6f75         continuou
+00084680: 735f 7661 7273 2e61 7070 656e 6428 6361  s_vars.append(ca
+00084690: 7429 0d0a 2020 2020 2020 2020 2020 2020  t)..            
+000846a0: 6361 745f 7661 7273 2e72 656d 6f76 6528  cat_vars.remove(
+000846b0: 6361 7429 0d0a 2020 2020 2020 2020 2020  cat)..          
+000846c0: 2020 7661 725f 6466 2e6c 6f63 5b76 6172    var_df.loc[var
+000846d0: 5f64 665b 2769 6e64 6578 275d 3d3d 6361  _df['index']==ca
+000846e0: 742c 2763 6174 275d 203d 2030 0d0a 2020  t,'cat'] = 0..  
+000846f0: 2020 2020 2020 2020 2020 7661 725f 6466            var_df
+00084700: 2e6c 6f63 5b76 6172 5f64 665b 2769 6e64  .loc[var_df['ind
+00084710: 6578 275d 3d3d 6361 742c 276e 756d 6572  ex']==cat,'numer
+00084720: 6963 275d 203d 2031 0d0a 2020 2020 2020  ic'] = 1..      
+00084730: 2020 656c 6966 206c 656e 2864 665f 7072    elif len(df_pr
+00084740: 6564 735b 6361 745d 2e76 616c 7565 5f63  eds[cat].value_c
+00084750: 6f75 6e74 7328 2929 203d 3d20 6466 5f70  ounts()) == df_p
+00084760: 7265 6473 2e73 6861 7065 5b30 5d3a 0d0a  reds.shape[0]:..
+00084770: 2020 2020 2020 2020 2020 2020 6964 5f76              id_v
+00084780: 6172 732e 6170 7065 6e64 2863 6174 290d  ars.append(cat).
+00084790: 0a20 2020 2020 2020 2020 2020 2063 6174  .            cat
+000847a0: 5f76 6172 732e 7265 6d6f 7665 2863 6174  _vars.remove(cat
+000847b0: 290d 0a20 2020 2020 2020 2020 2020 2076  )..            v
+000847c0: 6172 5f64 662e 6c6f 635b 7661 725f 6466  ar_df.loc[var_df
+000847d0: 5b27 696e 6465 7827 5d3d 3d63 6174 2c27  ['index']==cat,'
+000847e0: 6361 7427 5d20 3d20 300d 0a20 2020 2020  cat'] = 0..     
+000847f0: 2020 2020 2020 2076 6172 5f64 662e 6c6f         var_df.lo
+00084800: 635b 7661 725f 6466 5b27 696e 6465 7827  c[var_df['index'
+00084810: 5d3d 3d63 6174 2c27 6964 5f63 6f6c 275d  ]==cat,'id_col']
+00084820: 203d 2031 0d0a 2020 2020 7375 6d5f 616c   = 1..    sum_al
+00084830: 6c5f 636f 6c73 5b27 6361 745f 7661 7273  l_cols['cat_vars
+00084840: 275d 203d 2063 6174 5f76 6172 730d 0a20  '] = cat_vars.. 
+00084850: 2020 2073 756d 5f61 6c6c 5f63 6f6c 735b     sum_all_cols[
+00084860: 2763 6f6e 7469 6e75 6f75 735f 7661 7273  'continuous_vars
+00084870: 275d 203d 2063 6f6e 7469 6e75 6f75 735f  '] = continuous_
+00084880: 7661 7273 0d0a 2020 2020 7375 6d5f 616c  vars..    sum_al
+00084890: 6c5f 636f 6c73 5b27 6964 5f76 6172 7327  l_cols['id_vars'
+000848a0: 5d20 3d20 6964 5f76 6172 730d 0a20 2020  ] = id_vars..   
+000848b0: 2023 2323 2323 2320 5468 6973 2069 7320   ###### This is 
+000848c0: 7768 6572 6520 796f 7520 636f 6e73 6f6c  where you consol
+000848d0: 6461 7465 2074 6865 206e 756d 6265 7273  date the numbers
+000848e0: 2023 2323 2323 2323 2323 2323 0d0a 2020   ###########..  
+000848f0: 2020 7661 725f 6469 6374 5f73 756d 203d    var_dict_sum =
+00084900: 2064 6963 7428 7a69 7028 7661 725f 6466   dict(zip(var_df
+00084910: 2e76 616c 7565 735b 3a2c 305d 2c20 7661  .values[:,0], va
+00084920: 725f 6466 2e76 616c 7565 735b 3a2c 323a  r_df.values[:,2:
+00084930: 5d2e 7375 6d28 3129 2929 0d0a 2020 2020  ].sum(1)))..    
+00084940: 666f 7220 636f 6c2c 2073 756d 7661 6c20  for col, sumval 
+00084950: 696e 2076 6172 5f64 6963 745f 7375 6d2e  in var_dict_sum.
+00084960: 6974 656d 7328 293a 0d0a 2020 2020 2020  items():..      
+00084970: 2020 6966 2073 756d 7661 6c20 3d3d 2030    if sumval == 0
+00084980: 3a0d 0a20 2020 2020 2020 2020 2020 2070  :..            p
+00084990: 7269 6e74 2827 2573 206f 6620 7479 7065  rint('%s of type
+000849a0: 3d25 7320 6973 206e 6f74 2063 6c61 7373  =%s is not class
+000849b0: 6966 6965 6427 2025 2863 6f6c 2c74 7261  ified' %(col,tra
+000849c0: 696e 5b63 6f6c 5d2e 6474 7970 6529 290d  in[col].dtype)).
+000849d0: 0a20 2020 2020 2020 2065 6c69 6620 7375  .        elif su
+000849e0: 6d76 616c 203e 2031 3a0d 0a20 2020 2020  mval > 1:..     
+000849f0: 2020 2020 2020 2070 7269 6e74 2827 2573         print('%s
+00084a00: 206f 6620 7479 7065 3d25 7320 6973 2063   of type=%s is c
+00084a10: 6c61 7373 6966 6965 6420 696e 746f 206d  lassified into m
+00084a20: 6f72 6520 7468 656e 206f 6e65 2074 7970  ore then one typ
+00084a30: 6527 2025 2863 6f6c 2c74 7261 696e 5b63  e' %(col,train[c
+00084a40: 6f6c 5d2e 6474 7970 6529 290d 0a20 2020  ol].dtype))..   
+00084a50: 2020 2020 2065 6c73 653a 0d0a 2020 2020       else:..    
+00084a60: 2020 2020 2020 2020 7061 7373 0d0a 2020          pass..  
+00084a70: 2020 2323 2323 2320 4966 2074 6865 7265    ##### If there
+00084a80: 2061 7265 206d 6f72 6520 7468 616e 2031   are more than 1
+00084a90: 3030 3020 756e 6971 7565 2076 616c 7565  000 unique value
+00084aa0: 732c 2074 6865 6e20 6164 6420 6974 2074  s, then add it t
+00084ab0: 6f20 4e4c 5020 7661 7273 2023 2323 0d0a  o NLP vars ###..
+00084ac0: 2020 2020 636f 7079 5f64 6973 6372 6574      copy_discret
+00084ad0: 6573 203d 2063 6f70 792e 6465 6570 636f  es = copy.deepco
+00084ae0: 7079 2864 6973 6372 6574 655f 7374 7269  py(discrete_stri
+00084af0: 6e67 5f76 6172 7329 0d0a 2020 2020 666f  ng_vars)..    fo
+00084b00: 7220 6561 6368 5f64 6973 6372 6574 6520  r each_discrete 
+00084b10: 696e 2063 6f70 795f 6469 7363 7265 7465  in copy_discrete
+00084b20: 733a 0d0a 2020 2020 2020 2020 6966 2074  s:..        if t
+00084b30: 7261 696e 5b65 6163 685f 6469 7363 7265  rain[each_discre
+00084b40: 7465 5d2e 6e75 6e69 7175 6528 2920 3e3d  te].nunique() >=
+00084b50: 2031 3030 303a 0d0a 2020 2020 2020 2020   1000:..        
+00084b60: 2020 2020 6e6c 705f 7661 7273 2e61 7070      nlp_vars.app
+00084b70: 656e 6428 6561 6368 5f64 6973 6372 6574  end(each_discret
+00084b80: 6529 0d0a 2020 2020 2020 2020 2020 2020  e)..            
+00084b90: 6469 7363 7265 7465 5f73 7472 696e 675f  discrete_string_
+00084ba0: 7661 7273 2e72 656d 6f76 6528 6561 6368  vars.remove(each
+00084bb0: 5f64 6973 6372 6574 6529 0d0a 2020 2020  _discrete)..    
+00084bc0: 2020 2020 656c 6966 2074 7261 696e 5b65      elif train[e
+00084bd0: 6163 685f 6469 7363 7265 7465 5d2e 6e75  ach_discrete].nu
+00084be0: 6e69 7175 6528 2920 3e20 3130 3020 616e  nique() > 100 an
+00084bf0: 6420 7472 6169 6e5b 6561 6368 5f64 6973  d train[each_dis
+00084c00: 6372 6574 655d 2e6e 756e 6971 7565 2829  crete].nunique()
+00084c10: 203c 2031 3030 303a 0d0a 2020 2020 2020   < 1000:..      
+00084c20: 2020 2020 2020 7061 7373 0d0a 2020 2020        pass..    
+00084c30: 2020 2020 656c 7365 3a0d 0a20 2020 2020      else:..     
+00084c40: 2020 2020 2020 2023 2323 2049 6620 6974         ### If it
+00084c50: 2069 7320 6c65 7373 2074 6861 6e20 3130   is less than 10
+00084c60: 3020 756e 6971 7565 2076 616c 7565 732c  0 unique values,
+00084c70: 2074 6865 6e20 6d61 6b65 2069 7420 6361   then make it ca
+00084c80: 7465 676f 7269 6361 6c20 7661 720d 0a20  tegorical var.. 
+00084c90: 2020 2020 2020 2020 2020 2063 6174 5f76             cat_v
+00084ca0: 6172 732e 6170 7065 6e64 2865 6163 685f  ars.append(each_
+00084cb0: 6469 7363 7265 7465 290d 0a20 2020 2020  discrete)..     
+00084cc0: 2020 2020 2020 2064 6973 6372 6574 655f         discrete_
+00084cd0: 7374 7269 6e67 5f76 6172 732e 7265 6d6f  string_vars.remo
+00084ce0: 7665 2865 6163 685f 6469 7363 7265 7465  ve(each_discrete
+00084cf0: 290d 0a20 2020 2073 756d 5f61 6c6c 5f63  )..    sum_all_c
+00084d00: 6f6c 735b 2764 6973 6372 6574 655f 7374  ols['discrete_st
+00084d10: 7269 6e67 5f76 6172 7327 5d20 3d20 2064  ring_vars'] =  d
+00084d20: 6973 6372 6574 655f 7374 7269 6e67 5f76  iscrete_string_v
+00084d30: 6172 730d 0a20 2020 2073 756d 5f61 6c6c  ars..    sum_all
+00084d40: 5f63 6f6c 735b 2763 6174 5f76 6172 7327  _cols['cat_vars'
+00084d50: 5d20 3d20 6361 745f 7661 7273 0d0a 2020  ] = cat_vars..  
+00084d60: 2020 7375 6d5f 616c 6c5f 636f 6c73 5b27    sum_all_cols['
+00084d70: 6e6c 705f 7661 7273 275d 203d 206e 6c70  nlp_vars'] = nlp
+00084d80: 5f76 6172 730d 0a20 2020 2023 2323 2323  _vars..    #####
+00084d90: 2323 2323 2323 2323 2323 2020 5468 6973  ##########  This
+00084da0: 2069 7320 7768 6572 6520 796f 7520 7072   is where you pr
+00084db0: 696e 7420 616c 6c20 7468 6520 7479 7065  int all the type
+00084dc0: 7320 6f66 2076 6172 6961 626c 6573 2023  s of variables #
+00084dd0: 2323 2323 2323 2323 2323 2323 230d 0a20  #############.. 
+00084de0: 2020 2023 2323 2323 2323 2052 6574 7572     ####### Retur
+00084df0: 6e73 2038 2076 6172 7320 696e 2074 6865  ns 8 vars in the
+00084e00: 2066 6f6c 6c6f 7769 6e67 206f 7264 6572   following order
+00084e10: 3a20 636f 6e74 696e 756f 7573 5f76 6172  : continuous_var
+00084e20: 732c 696e 745f 7661 7273 2c63 6174 5f76  s,int_vars,cat_v
+00084e30: 6172 732c 0d0a 2020 2020 2323 2320 2073  ars,..    ###  s
+00084e40: 7472 696e 675f 626f 6f6c 5f76 6172 732c  tring_bool_vars,
+00084e50: 6469 7363 7265 7465 5f73 7472 696e 675f  discrete_string_
+00084e60: 7661 7273 2c6e 6c70 5f76 6172 732c 6461  vars,nlp_vars,da
+00084e70: 7465 5f6f 725f 6964 5f76 6172 732c 636f  te_or_id_vars,co
+00084e80: 6c73 5f64 656c 6574 650d 0a20 2020 2069  ls_delete..    i
+00084e90: 6620 7665 7262 6f73 6520 3d3d 2031 3a0d  f verbose == 1:.
+00084ea0: 0a20 2020 2020 2020 2070 7269 6e74 2822  .        print("
+00084eb0: 2020 2020 4e75 6d62 6572 206f 6620 4e75      Number of Nu
+00084ec0: 6d65 7269 6320 436f 6c75 6d6e 7320 3d20  meric Columns = 
+00084ed0: 222c 206c 656e 2863 6f6e 7469 6e75 6f75  ", len(continuou
+00084ee0: 735f 7661 7273 2929 0d0a 2020 2020 2020  s_vars))..      
+00084ef0: 2020 7072 696e 7428 2220 2020 204e 756d    print("    Num
+00084f00: 6265 7220 6f66 2049 6e74 6567 6572 2d43  ber of Integer-C
+00084f10: 6174 6567 6f72 6963 616c 2043 6f6c 756d  ategorical Colum
+00084f20: 6e73 203d 2022 2c20 6c65 6e28 696e 745f  ns = ", len(int_
+00084f30: 7661 7273 2929 0d0a 2020 2020 2020 2020  vars))..        
+00084f40: 7072 696e 7428 2220 2020 204e 756d 6265  print("    Numbe
+00084f50: 7220 6f66 2053 7472 696e 672d 4361 7465  r of String-Cate
+00084f60: 676f 7269 6361 6c20 436f 6c75 6d6e 7320  gorical Columns 
+00084f70: 3d20 222c 206c 656e 2863 6174 5f76 6172  = ", len(cat_var
+00084f80: 7329 290d 0a20 2020 2020 2020 2070 7269  s))..        pri
+00084f90: 6e74 2822 2020 2020 4e75 6d62 6572 206f  nt("    Number o
+00084fa0: 6620 4661 6374 6f72 2d43 6174 6567 6f72  f Factor-Categor
+00084fb0: 6963 616c 2043 6f6c 756d 6e73 203d 2022  ical Columns = "
+00084fc0: 2c20 6c65 6e28 6661 6374 6f72 5f76 6172  , len(factor_var
+00084fd0: 7329 290d 0a20 2020 2020 2020 2070 7269  s))..        pri
+00084fe0: 6e74 2822 2020 2020 4e75 6d62 6572 206f  nt("    Number o
+00084ff0: 6620 5374 7269 6e67 2d42 6f6f 6c65 616e  f String-Boolean
+00085000: 2043 6f6c 756d 6e73 203d 2022 2c20 6c65   Columns = ", le
+00085010: 6e28 7374 7269 6e67 5f62 6f6f 6c5f 7661  n(string_bool_va
+00085020: 7273 2929 0d0a 2020 2020 2020 2020 7072  rs))..        pr
+00085030: 696e 7428 2220 2020 204e 756d 6265 7220  int("    Number 
+00085040: 6f66 204e 756d 6572 6963 2d42 6f6f 6c65  of Numeric-Boole
+00085050: 616e 2043 6f6c 756d 6e73 203d 2022 2c20  an Columns = ", 
+00085060: 6c65 6e28 6e75 6d5f 626f 6f6c 5f76 6172  len(num_bool_var
+00085070: 7329 290d 0a20 2020 2020 2020 2070 7269  s))..        pri
+00085080: 6e74 2822 2020 2020 4e75 6d62 6572 206f  nt("    Number o
+00085090: 6620 4469 7363 7265 7465 2053 7472 696e  f Discrete Strin
+000850a0: 6720 436f 6c75 6d6e 7320 3d20 222c 206c  g Columns = ", l
+000850b0: 656e 2864 6973 6372 6574 655f 7374 7269  en(discrete_stri
+000850c0: 6e67 5f76 6172 7329 290d 0a20 2020 2020  ng_vars))..     
+000850d0: 2020 2070 7269 6e74 2822 2020 2020 4e75     print("    Nu
+000850e0: 6d62 6572 206f 6620 4e4c 5020 5374 7269  mber of NLP Stri
+000850f0: 6e67 2043 6f6c 756d 6e73 203d 2022 2c20  ng Columns = ", 
+00085100: 6c65 6e28 6e6c 705f 7661 7273 2929 0d0a  len(nlp_vars))..
+00085110: 2020 2020 2020 2020 7072 696e 7428 2220          print(" 
+00085120: 2020 204e 756d 6265 7220 6f66 2044 6174     Number of Dat
+00085130: 6520 5469 6d65 2043 6f6c 756d 6e73 203d  e Time Columns =
+00085140: 2022 2c20 6c65 6e28 6461 7465 5f76 6172   ", len(date_var
+00085150: 7329 290d 0a20 2020 2020 2020 2070 7269  s))..        pri
+00085160: 6e74 2822 2020 2020 4e75 6d62 6572 206f  nt("    Number o
+00085170: 6620 4944 2043 6f6c 756d 6e73 203d 2022  f ID Columns = "
+00085180: 2c20 6c65 6e28 6964 5f76 6172 7329 290d  , len(id_vars)).
+00085190: 0a20 2020 2020 2020 2070 7269 6e74 2822  .        print("
+000851a0: 2020 2020 4e75 6d62 6572 206f 6620 436f      Number of Co
+000851b0: 6c75 6d6e 7320 746f 2044 656c 6574 6520  lumns to Delete 
+000851c0: 3d20 222c 206c 656e 2863 6f6c 735f 6465  = ", len(cols_de
+000851d0: 6c65 7465 2929 0d0a 2020 2020 6966 2076  lete))..    if v
+000851e0: 6572 626f 7365 203d 3d20 323a 0d0a 2020  erbose == 2:..  
+000851f0: 2020 2020 2020 7072 696e 7428 2720 2050        print('  P
+00085200: 7269 6e74 696e 6720 7570 746f 2025 6420  rinting upto %d 
+00085210: 636f 6c75 6d6e 7320 6d61 7820 696e 2065  columns max in e
+00085220: 6163 6820 6361 7465 676f 7279 3a27 2025  ach category:' %
+00085230: 6d61 785f 636f 6c73 5f74 6f5f 7072 696e  max_cols_to_prin
+00085240: 7429 0d0a 2020 2020 2020 2020 7072 696e  t)..        prin
+00085250: 7428 2220 2020 204e 756d 6572 6963 2043  t("    Numeric C
+00085260: 6f6c 756d 6e73 203a 2025 7322 2025 636f  olumns : %s" %co
+00085270: 6e74 696e 756f 7573 5f76 6172 735b 3a6d  ntinuous_vars[:m
+00085280: 6178 5f63 6f6c 735f 746f 5f70 7269 6e74  ax_cols_to_print
+00085290: 5d29 0d0a 2020 2020 2020 2020 7072 696e  ])..        prin
+000852a0: 7428 2220 2020 2049 6e74 6567 6572 2d43  t("    Integer-C
+000852b0: 6174 6567 6f72 6963 616c 2043 6f6c 756d  ategorical Colum
+000852c0: 6e73 3a20 2573 2220 2569 6e74 5f76 6172  ns: %s" %int_var
+000852d0: 735b 3a6d 6178 5f63 6f6c 735f 746f 5f70  s[:max_cols_to_p
+000852e0: 7269 6e74 5d29 0d0a 2020 2020 2020 2020  rint])..        
+000852f0: 7072 696e 7428 2220 2020 2053 7472 696e  print("    Strin
+00085300: 672d 4361 7465 676f 7269 6361 6c20 436f  g-Categorical Co
+00085310: 6c75 6d6e 733a 2025 7322 2025 6361 745f  lumns: %s" %cat_
+00085320: 7661 7273 5b3a 6d61 785f 636f 6c73 5f74  vars[:max_cols_t
+00085330: 6f5f 7072 696e 745d 290d 0a20 2020 2020  o_print])..     
+00085340: 2020 2070 7269 6e74 2822 2020 2020 4661     print("    Fa
+00085350: 6374 6f72 2d43 6174 6567 6f72 6963 616c  ctor-Categorical
+00085360: 2043 6f6c 756d 6e73 3a20 2573 2220 2566   Columns: %s" %f
+00085370: 6163 746f 725f 7661 7273 5b3a 6d61 785f  actor_vars[:max_
+00085380: 636f 6c73 5f74 6f5f 7072 696e 745d 290d  cols_to_print]).
+00085390: 0a20 2020 2020 2020 2070 7269 6e74 2822  .        print("
+000853a0: 2020 2020 5374 7269 6e67 2d42 6f6f 6c65      String-Boole
+000853b0: 616e 2043 6f6c 756d 6e73 3a20 2573 2220  an Columns: %s" 
+000853c0: 2573 7472 696e 675f 626f 6f6c 5f76 6172  %string_bool_var
+000853d0: 735b 3a6d 6178 5f63 6f6c 735f 746f 5f70  s[:max_cols_to_p
+000853e0: 7269 6e74 5d29 0d0a 2020 2020 2020 2020  rint])..        
+000853f0: 7072 696e 7428 2220 2020 204e 756d 6572  print("    Numer
+00085400: 6963 2d42 6f6f 6c65 616e 2043 6f6c 756d  ic-Boolean Colum
+00085410: 6e73 3a20 2573 2220 256e 756d 5f62 6f6f  ns: %s" %num_boo
+00085420: 6c5f 7661 7273 5b3a 6d61 785f 636f 6c73  l_vars[:max_cols
+00085430: 5f74 6f5f 7072 696e 745d 290d 0a20 2020  _to_print])..   
+00085440: 2020 2020 2070 7269 6e74 2822 2020 2020       print("    
+00085450: 4469 7363 7265 7465 2053 7472 696e 6720  Discrete String 
+00085460: 436f 6c75 6d6e 733a 2025 7322 2025 6469  Columns: %s" %di
+00085470: 7363 7265 7465 5f73 7472 696e 675f 7661  screte_string_va
+00085480: 7273 5b3a 6d61 785f 636f 6c73 5f74 6f5f  rs[:max_cols_to_
+00085490: 7072 696e 745d 290d 0a20 2020 2020 2020  print])..       
+000854a0: 2070 7269 6e74 2822 2020 2020 4e4c 5020   print("    NLP 
+000854b0: 7465 7874 2043 6f6c 756d 6e73 3a20 2573  text Columns: %s
+000854c0: 2220 256e 6c70 5f76 6172 735b 3a6d 6178  " %nlp_vars[:max
+000854d0: 5f63 6f6c 735f 746f 5f70 7269 6e74 5d29  _cols_to_print])
+000854e0: 0d0a 2020 2020 2020 2020 7072 696e 7428  ..        print(
+000854f0: 2220 2020 2044 6174 6520 5469 6d65 2043  "    Date Time C
+00085500: 6f6c 756d 6e73 3a20 2573 2220 2564 6174  olumns: %s" %dat
+00085510: 655f 7661 7273 5b3a 6d61 785f 636f 6c73  e_vars[:max_cols
+00085520: 5f74 6f5f 7072 696e 745d 290d 0a20 2020  _to_print])..   
+00085530: 2020 2020 2070 7269 6e74 2822 2020 2020       print("    
+00085540: 4944 2043 6f6c 756d 6e73 3a20 2573 2220  ID Columns: %s" 
+00085550: 2569 645f 7661 7273 5b3a 6d61 785f 636f  %id_vars[:max_co
+00085560: 6c73 5f74 6f5f 7072 696e 745d 290d 0a20  ls_to_print]).. 
+00085570: 2020 2020 2020 2070 7269 6e74 2822 2020         print("  
+00085580: 2020 436f 6c75 6d6e 7320 7468 6174 2077    Columns that w
+00085590: 696c 6c20 6e6f 7420 6265 2063 6f6e 7369  ill not be consi
+000855a0: 6465 7265 6420 696e 206d 6f64 656c 696e  dered in modelin
+000855b0: 673a 2025 7322 2025 636f 6c73 5f64 656c  g: %s" %cols_del
+000855c0: 6574 655b 3a6d 6178 5f63 6f6c 735f 746f  ete[:max_cols_to
+000855d0: 5f70 7269 6e74 5d29 0d0a 2020 2020 2323  _print])..    ##
+000855e0: 2323 2320 6e6f 7720 636f 6c6c 6563 7420  ### now collect 
+000855f0: 616c 6c20 7468 6520 636f 6c75 6d6e 2074  all the column t
+00085600: 7970 6573 2061 6e64 2063 6f6c 756d 6e20  ypes and column 
+00085610: 6e61 6d65 7320 696e 746f 2061 2073 696e  names into a sin
+00085620: 676c 6520 6469 6374 696f 6e61 7279 2074  gle dictionary t
+00085630: 6f20 7265 7475 726e 210d 0a20 2020 200d  o return!..    .
+00085640: 0a20 2020 206c 656e 5f73 756d 5f61 6c6c  .    len_sum_all
+00085650: 5f63 6f6c 7320 3d20 7265 6475 6365 2861  _cols = reduce(a
+00085660: 6464 2c5b 6c65 6e28 7629 2066 6f72 2076  dd,[len(v) for v
+00085670: 2069 6e20 7375 6d5f 616c 6c5f 636f 6c73   in sum_all_cols
+00085680: 2e76 616c 7565 7328 295d 290d 0a20 2020  .values()])..   
+00085690: 2069 6620 6c65 6e5f 7375 6d5f 616c 6c5f   if len_sum_all_
+000856a0: 636f 6c73 203d 3d20 6f72 6967 5f63 6f6c  cols == orig_col
+000856b0: 735f 746f 7461 6c3a 0d0a 2020 2020 2020  s_total:..      
+000856c0: 2020 7072 696e 7428 2720 2020 2025 6420    print('    %d 
+000856d0: 5072 6564 6963 746f 7273 2063 6c61 7373  Predictors class
+000856e0: 6966 6965 642e 2e2e 2720 256f 7269 675f  ified...' %orig_
+000856f0: 636f 6c73 5f74 6f74 616c 290d 0a20 2020  cols_total)..   
+00085700: 2020 2020 2023 7072 696e 7428 2720 2020       #print('   
+00085710: 2020 2020 2054 6869 7320 646f 6573 206e       This does n
+00085720: 6f74 2069 6e63 6c75 6465 2074 6865 2054  ot include the T
+00085730: 6172 6765 7420 636f 6c75 6d6e 2873 2927  arget column(s)'
+00085740: 290d 0a20 2020 2065 6c73 653a 0d0a 2020  )..    else:..  
+00085750: 2020 2020 2020 7072 696e 7428 274e 6f20        print('No 
+00085760: 6f66 2063 6f6c 756d 6e73 2063 6c61 7373  of columns class
+00085770: 6966 6965 6420 2564 2064 6f65 7320 6e6f  ified %d does no
+00085780: 7420 6d61 7463 6820 2564 2074 6f74 616c  t match %d total
+00085790: 2063 6f6c 732e 2043 6f6e 7469 6e75 696e   cols. Continuin
+000857a0: 672e 2e2e 2720 2528 0d0a 2020 2020 2020  g...' %(..      
+000857b0: 2020 2020 2020 2020 2020 2020 206c 656e               len
+000857c0: 5f73 756d 5f61 6c6c 5f63 6f6c 732c 206f  _sum_all_cols, o
+000857d0: 7269 675f 636f 6c73 5f74 6f74 616c 2929  rig_cols_total))
+000857e0: 0d0a 2020 2020 2020 2020 6c73 203d 2073  ..        ls = s
+000857f0: 756d 5f61 6c6c 5f63 6f6c 732e 7661 6c75  um_all_cols.valu
+00085800: 6573 2829 0d0a 2020 2020 2020 2020 666c  es()..        fl
+00085810: 6174 5f6c 6973 7420 3d20 5b69 7465 6d20  at_list = [item 
+00085820: 666f 7220 7375 626c 6973 7420 696e 206c  for sublist in l
+00085830: 7320 666f 7220 6974 656d 2069 6e20 7375  s for item in su
+00085840: 626c 6973 745d 0d0a 2020 2020 2020 2020  blist]..        
+00085850: 6966 206c 656e 286c 6566 745f 7375 6274  if len(left_subt
+00085860: 7261 6374 286c 6973 7428 7472 6169 6e29  ract(list(train)
+00085870: 2c66 6c61 745f 6c69 7374 2929 203d 3d20  ,flat_list)) == 
+00085880: 303a 0d0a 2020 2020 2020 2020 2020 2020  0:..            
+00085890: 7072 696e 7428 2720 4d69 7373 696e 6720  print(' Missing 
+000858a0: 636f 6c75 6d6e 7320 3d20 4e6f 6e65 2729  columns = None')
+000858b0: 0d0a 2020 2020 2020 2020 656c 7365 3a0d  ..        else:.
+000858c0: 0a20 2020 2020 2020 2020 2020 2070 7269  .            pri
+000858d0: 6e74 2827 204d 6973 7369 6e67 2063 6f6c  nt(' Missing col
+000858e0: 756d 6e73 203d 2025 7327 2025 6c65 6674  umns = %s' %left
+000858f0: 5f73 7562 7472 6163 7428 6c69 7374 2874  _subtract(list(t
+00085900: 7261 696e 292c 666c 6174 5f6c 6973 7429  rain),flat_list)
+00085910: 290d 0a20 2020 2072 6574 7572 6e20 7375  )..    return su
+00085920: 6d5f 616c 6c5f 636f 6c73 0d0a 2323 2323  m_all_cols..####
+00085930: 2323 2323 2323 2323 2323 2323 2323 2323  ################
+00085940: 2323 2323 2323 2323 2323 2323 2323 2323  ################
+00085950: 2323 2323 2323 2323 2323 2323 2323 2323  ################
+00085960: 2323 2323 2323 2323 2323 2323 2323 2323  ################
+00085970: 2323 2323 2323 2323 2323 2323 2323 2323  ################
+00085980: 0d0a 0000 0000 0000 0000 0000 0000 0000  ................
+00085990: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+000859a0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+000859b0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+000859c0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+000859d0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+000859e0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+000859f0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+00085a00: 2e2f 2e2f 4050 6178 4865 6164 6572 0000  ././@PaxHeader..
+00085a10: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+00085a20: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+00085a30: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+00085a40: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+00085a50: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+00085a60: 0000 0000 3030 3030 3030 3000 3030 3030  ....0000000.0000
+00085a70: 3030 3000 3030 3030 3030 3000 3030 3030  000.0000000.0000
+00085a80: 3030 3030 3032 3600 3030 3030 3030 3030  0000026.00000000
+00085a90: 3030 3000 3031 3134 3533 0020 7800 0000  000.011453. x...
+00085aa0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+00085ab0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+00085ac0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+00085ad0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+00085ae0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+00085af0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+00085b00: 0075 7374 6172 0030 3000 0000 0000 0000  .ustar.00.......
+00085b10: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+00085b20: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+00085b30: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+00085b40: 0000 0000 0000 0000 0030 3030 3030 3030  .........0000000
+00085b50: 0030 3030 3030 3030 0000 0000 0000 0000  .0000000........
+00085b60: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+00085b70: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+00085b80: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+00085b90: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+00085ba0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+00085bb0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+00085bc0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+00085bd0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+00085be0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+00085bf0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+00085c00: 3232 206d 7469 6d65 3d31 3637 3831 3539  22 mtime=1678159
+00085c10: 3732 322e 300a 0000 0000 0000 0000 0000  722.0...........
+00085c20: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+00085c30: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+00085c40: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+00085c50: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+00085c60: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+00085c70: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+00085c80: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+00085c90: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+00085ca0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+00085cb0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+00085cc0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+00085cd0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+00085ce0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+00085cf0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+00085d00: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+00085d10: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+00085d20: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+00085d30: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+00085d40: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+00085d50: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+00085d60: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+00085d70: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+00085d80: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+00085d90: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+00085da0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+00085db0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+00085dc0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+00085dd0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+00085de0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+00085df0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+00085e00: 6175 746f 7669 6d6c 2d30 2e31 2e37 3135  autoviml-0.1.715
+00085e10: 2f61 7574 6f76 696d 6c2f 6375 7374 6f6d  /autoviml/custom
+00085e20: 5f73 636f 7265 732e 7079 0000 0000 0000  _scores.py......
+00085e30: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+00085e40: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+00085e50: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+00085e60: 0000 0000 3030 3030 3737 3700 3030 3031  ....0000777.0001
+00085e70: 3735 3000 3030 3031 3735 3000 3030 3030  750.0001750.0000
+00085e80: 3030 3132 3536 3400 3030 3030 3030 3030  0012564.00000000
+00085e90: 3030 3000 3032 3032 3237 0020 3000 0000  000.020227. 0...
+00085ea0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+00085eb0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+00085ec0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+00085ed0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+00085ee0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+00085ef0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+00085f00: 0075 7374 6172 0030 3072 616d 0000 0000  .ustar.00ram....
+00085f10: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+00085f20: 0000 0000 0000 0000 0072 616d 0000 0000  .........ram....
+00085f30: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+00085f40: 0000 0000 0000 0000 0030 3030 3030 3030  .........0000000
+00085f50: 0030 3030 3030 3030 0000 0000 0000 0000  .0000000........
+00085f60: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+00085f70: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+00085f80: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+00085f90: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+00085fa0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+00085fb0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+00085fc0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+00085fd0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+00085fe0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+00085ff0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+00086000: 696d 706f 7274 206e 756d 7079 2061 7320  import numpy as 
+00086010: 6e70 0d0a 6672 6f6d 2073 6b6c 6561 726e  np..from sklearn
+00086020: 2069 6d70 6f72 7420 6d6f 6465 6c5f 7365   import model_se
+00086030: 6c65 6374 696f 6e0d 0a66 726f 6d20 736b  lection..from sk
+00086040: 6c65 6172 6e2e 6d65 7472 6963 7320 696d  learn.metrics im
+00086050: 706f 7274 2063 6f6e 6675 7369 6f6e 5f6d  port confusion_m
+00086060: 6174 7269 782c 206d 6561 6e5f 7371 7561  atrix, mean_squa
+00086070: 7265 645f 6572 726f 720d 0a66 726f 6d20  red_error..from 
+00086080: 736b 6c65 6172 6e20 696d 706f 7274 206d  sklearn import m
+00086090: 6574 7269 6373 0d0a 6672 6f6d 2073 6b6c  etrics..from skl
+000860a0: 6561 726e 2069 6d70 6f72 7420 6d6f 6465  earn import mode
+000860b0: 6c5f 7365 6c65 6374 696f 6e2c 206d 6574  l_selection, met
+000860c0: 7269 6373 2020 2023 4164 6469 7469 6f6e  rics   #Addition
+000860d0: 616c 2073 6b6c 6561 726e 2066 756e 6374  al sklearn funct
+000860e0: 696f 6e73 0d0a 6672 6f6d 2073 6b6c 6561  ions..from sklea
+000860f0: 726e 2e6d 6574 7269 6373 2069 6d70 6f72  rn.metrics impor
+00086100: 7420 6163 6375 7261 6379 5f73 636f 7265  t accuracy_score
+00086110: 2c66 315f 7363 6f72 652c 726f 635f 6175  ,f1_score,roc_au
+00086120: 635f 7363 6f72 652c 6c6f 675f 6c6f 7373  c_score,log_loss
+00086130: 0d0a 6672 6f6d 2073 6b6c 6561 726e 2e6d  ..from sklearn.m
+00086140: 6574 7269 6373 2069 6d70 6f72 7420 6d65  etrics import me
+00086150: 616e 5f73 7175 6172 6564 5f65 7272 6f72  an_squared_error
+00086160: 2c6d 6564 6961 6e5f 6162 736f 6c75 7465  ,median_absolute
+00086170: 5f65 7272 6f72 2c6d 6561 6e5f 6162 736f  _error,mean_abso
+00086180: 6c75 7465 5f65 7272 6f72 0d0a 6672 6f6d  lute_error..from
+00086190: 2073 6b6c 6561 726e 2e6d 6574 7269 6373   sklearn.metrics
+000861a0: 2069 6d70 6f72 7420 636c 6173 7369 6669   import classifi
+000861b0: 6361 7469 6f6e 5f72 6570 6f72 742c 2063  cation_report, c
+000861c0: 6f6e 6675 7369 6f6e 5f6d 6174 7269 782c  onfusion_matrix,
+000861d0: 6d65 616e 5f73 7175 6172 6564 5f6c 6f67  mean_squared_log
+000861e0: 5f65 7272 6f72 0d0a 6672 6f6d 2073 6b6c  _error..from skl
+000861f0: 6561 726e 2e6d 6574 7269 6373 2069 6d70  earn.metrics imp
+00086200: 6f72 7420 7072 6563 6973 696f 6e5f 7265  ort precision_re
+00086210: 6361 6c6c 5f63 7572 7665 0d0a 6672 6f6d  call_curve..from
+00086220: 2073 6b6c 6561 726e 2e6d 6f64 656c 5f73   sklearn.model_s
+00086230: 656c 6563 7469 6f6e 2069 6d70 6f72 7420  election import 
+00086240: 6372 6f73 735f 7661 6c5f 7363 6f72 652c  cross_val_score,
+00086250: 2053 7472 6174 6966 6965 644b 466f 6c64   StratifiedKFold
+00086260: 2c20 4b46 6f6c 640d 0a66 726f 6d20 736b  , KFold..from sk
+00086270: 6c65 6172 6e2e 6d65 7472 6963 7320 696d  learn.metrics im
+00086280: 706f 7274 206d 616b 655f 7363 6f72 6572  port make_scorer
+00086290: 0d0a 6672 6f6d 2073 6b6c 6561 726e 2e6d  ..from sklearn.m
+000862a0: 6574 7269 6373 2069 6d70 6f72 7420 6163  etrics import ac
+000862b0: 6375 7261 6379 5f73 636f 7265 0d0a 6672  curacy_score..fr
+000862c0: 6f6d 2073 6b6c 6561 726e 2e6d 6574 7269  om sklearn.metri
+000862d0: 6373 2069 6d70 6f72 7420 6176 6572 6167  cs import averag
+000862e0: 655f 7072 6563 6973 696f 6e5f 7363 6f72  e_precision_scor
+000862f0: 650d 0a66 726f 6d20 736b 6c65 6172 6e2e  e..from sklearn.
+00086300: 6d65 7472 6963 7320 696d 706f 7274 2066  metrics import f
+00086310: 315f 7363 6f72 650d 0a66 726f 6d20 736b  1_score..from sk
+00086320: 6c65 6172 6e2e 6d65 7472 6963 7320 696d  learn.metrics im
+00086330: 706f 7274 206c 6f67 5f6c 6f73 730d 0a66  port log_loss..f
+00086340: 726f 6d20 736b 6c65 6172 6e2e 6d65 7472  rom sklearn.metr
+00086350: 6963 7320 696d 706f 7274 2070 7265 6369  ics import preci
+00086360: 7369 6f6e 5f73 636f 7265 0d0a 6672 6f6d  sion_score..from
+00086370: 2073 6b6c 6561 726e 2e6d 6574 7269 6373   sklearn.metrics
+00086380: 2069 6d70 6f72 7420 7265 6361 6c6c 5f73   import recall_s
+00086390: 636f 7265 0d0a 6672 6f6d 2073 6b6c 6561  core..from sklea
+000863a0: 726e 2e6d 6574 7269 6373 2069 6d70 6f72  rn.metrics impor
+000863b0: 7420 726f 635f 6175 635f 7363 6f72 650d  t roc_auc_score.
+000863c0: 0a66 726f 6d20 736b 6c65 6172 6e2e 6d65  .from sklearn.me
+000863d0: 7472 6963 7320 696d 706f 7274 2066 6265  trics import fbe
+000863e0: 7461 5f73 636f 7265 0d0a 2323 2323 2323  ta_score..######
+000863f0: 2323 2323 2323 2323 2323 2323 2323 2323  ################
+00086400: 2323 2323 2323 2323 2323 2323 2323 2323  ################
+00086410: 2323 2323 2323 2323 2323 2323 2323 2323  ################
+00086420: 2323 2323 2323 2323 2323 2323 2323 2323  ################
+00086430: 2323 2323 2323 2323 2323 2323 2323 230d  ###############.
+00086440: 0a66 726f 6d20 736b 6c65 6172 6e2e 6d65  .from sklearn.me
+00086450: 7472 6963 7320 696d 706f 7274 2063 6f6e  trics import con
+00086460: 6675 7369 6f6e 5f6d 6174 7269 780d 0a64  fusion_matrix..d
+00086470: 6566 2062 616c 616e 6365 645f 6163 6375  ef balanced_accu
+00086480: 7261 6379 5f73 636f 7265 2879 5f74 7275  racy_score(y_tru
+00086490: 652c 2079 5f70 7265 642c 2073 616d 706c  e, y_pred, sampl
+000864a0: 655f 7765 6967 6874 3d4e 6f6e 652c 0d0a  e_weight=None,..
+000864b0: 2020 2020 2020 2020 2020 2020 2020 2020                  
+000864c0: 2020 2020 2020 2020 2020 2020 6164 6a75              adju
+000864d0: 7374 6564 3d46 616c 7365 293a 0d0a 2020  sted=False):..  
+000864e0: 2020 4320 3d20 636f 6e66 7573 696f 6e5f    C = confusion_
+000864f0: 6d61 7472 6978 2879 5f74 7275 652c 2079  matrix(y_true, y
+00086500: 5f70 7265 642c 2073 616d 706c 655f 7765  _pred, sample_we
+00086510: 6967 6874 3d73 616d 706c 655f 7765 6967  ight=sample_weig
+00086520: 6874 290d 0a20 2020 2077 6974 6820 6e70  ht)..    with np
+00086530: 2e65 7272 7374 6174 6528 6469 7669 6465  .errstate(divide
+00086540: 3d27 6967 6e6f 7265 272c 2069 6e76 616c  ='ignore', inval
+00086550: 6964 3d27 6967 6e6f 7265 2729 3a0d 0a20  id='ignore'):.. 
+00086560: 2020 2020 2020 2070 6572 5f63 6c61 7373         per_class
+00086570: 203d 206e 702e 6469 6167 2843 2920 2f20   = np.diag(C) / 
+00086580: 432e 7375 6d28 6178 6973 3d31 290d 0a20  C.sum(axis=1).. 
+00086590: 2020 2069 6620 6e70 2e61 6e79 286e 702e     if np.any(np.
+000865a0: 6973 6e61 6e28 7065 725f 636c 6173 7329  isnan(per_class)
+000865b0: 293a 0d0a 2020 2020 2020 2020 7761 726e  ):..        warn
+000865c0: 696e 6773 2e77 6172 6e28 2779 5f70 7265  ings.warn('y_pre
+000865d0: 6420 636f 6e74 6169 6e73 2063 6c61 7373  d contains class
+000865e0: 6573 206e 6f74 2069 6e20 795f 7472 7565  es not in y_true
+000865f0: 2729 0d0a 2020 2020 2020 2020 7065 725f  ')..        per_
+00086600: 636c 6173 7320 3d20 7065 725f 636c 6173  class = per_clas
+00086610: 735b 7e6e 702e 6973 6e61 6e28 7065 725f  s[~np.isnan(per_
+00086620: 636c 6173 7329 5d0d 0a20 2020 2073 636f  class)]..    sco
+00086630: 7265 203d 206e 702e 6d65 616e 2870 6572  re = np.mean(per
+00086640: 5f63 6c61 7373 290d 0a20 2020 2069 6620  _class)..    if 
+00086650: 6164 6a75 7374 6564 3a0d 0a20 2020 2020  adjusted:..     
+00086660: 2020 206e 5f63 6c61 7373 6573 203d 206c     n_classes = l
+00086670: 656e 2870 6572 5f63 6c61 7373 290d 0a20  en(per_class).. 
+00086680: 2020 2020 2020 2063 6861 6e63 6520 3d20         chance = 
+00086690: 3120 2f20 6e5f 636c 6173 7365 730d 0a20  1 / n_classes.. 
+000866a0: 2020 2020 2020 2073 636f 7265 202d 3d20         score -= 
+000866b0: 6368 616e 6365 0d0a 2020 2020 2020 2020  chance..        
+000866c0: 7363 6f72 6520 2f3d 2031 202d 2063 6861  score /= 1 - cha
+000866d0: 6e63 650d 0a20 2020 2072 6574 7572 6e20  nce..    return 
+000866e0: 7363 6f72 650d 0a23 2323 2323 2323 2323  score..#########
+000866f0: 2323 2323 2323 2323 2323 2323 2323 2323  ################
+00086700: 2323 2323 2323 2323 2323 2323 2323 2323  ################
+00086710: 2323 2323 2323 2323 2323 2323 2323 2323  ################
+00086720: 2323 2323 2323 2323 2323 2323 2323 2323  ################
+00086730: 2323 2323 2323 2323 2323 2323 0d0a 6465  ############..de
+00086740: 6620 6163 6375 2872 6573 756c 7473 2c20  f accu(results, 
+00086750: 795f 6376 293a 0d0a 2020 2020 7265 7475  y_cv):..    retu
+00086760: 726e 2028 7265 7375 6c74 733d 3d79 5f63  rn (results==y_c
+00086770: 7629 2e61 7374 7970 6528 696e 7429 2e73  v).astype(int).s
+00086780: 756d 2861 7869 733d 3029 2f28 795f 6376  um(axis=0)/(y_cv
+00086790: 2e73 6861 7065 5b30 5d29 0d0a 6465 6620  .shape[0])..def 
+000867a0: 726d 7365 2872 6573 756c 7473 2c20 795f  rmse(results, y_
+000867b0: 6376 293a 0d0a 2020 2020 7265 7475 726e  cv):..    return
+000867c0: 206e 702e 7371 7274 286e 702e 6d65 616e   np.sqrt(np.mean
+000867d0: 2828 7265 7375 6c74 7320 2d20 795f 6376  ((results - y_cv
+000867e0: 292a 2a32 2c20 6178 6973 3d30 2929 0d0a  )**2, axis=0))..
+000867f0: 2323 2323 2323 2323 2044 6566 696e 696e  ######## Definin
+00086800: 6720 6f62 6a65 6374 6976 6520 6675 6e63  g objective func
+00086810: 7469 6f6e 7320 666f 7220 4879 7065 724f  tions for HyperO
+00086820: 7074 2068 6572 6520 2323 2323 2323 2323  pt here ########
+00086830: 2323 2323 2323 2323 2323 2323 2323 0d0a  ##############..
+00086840: 6465 6620 6769 6e69 2874 7275 7468 2c20  def gini(truth, 
+00086850: 7072 6564 6963 7469 6f6e 7329 3a0d 0a20  predictions):.. 
+00086860: 2020 2067 203d 206e 702e 6173 6172 7261     g = np.asarra
+00086870: 7928 6e70 2e63 5f5b 7472 7574 682c 2070  y(np.c_[truth, p
+00086880: 7265 6469 6374 696f 6e73 2c20 6e70 2e61  redictions, np.a
+00086890: 7261 6e67 6528 6c65 6e28 7472 7574 6829  range(len(truth)
+000868a0: 2920 5d2c 2064 7479 7065 3d6e 702e 666c  ) ], dtype=np.fl
+000868b0: 6f61 7429 0d0a 2020 2020 6720 3d20 675b  oat)..    g = g[
+000868c0: 6e70 2e6c 6578 736f 7274 2828 675b 3a2c  np.lexsort((g[:,
+000868d0: 325d 2c20 2d31 2a67 5b3a 2c31 5d29 295d  2], -1*g[:,1]))]
+000868e0: 0d0a 2020 2020 6773 203d 2067 5b3a 2c30  ..    gs = g[:,0
+000868f0: 5d2e 6375 6d73 756d 2829 2e73 756d 2829  ].cumsum().sum()
+00086900: 202f 2067 5b3a 2c30 5d2e 7375 6d28 290d   / g[:,0].sum().
+00086910: 0a20 2020 2067 7320 2d3d 2028 6c65 6e28  .    gs -= (len(
+00086920: 7472 7574 6829 202b 2031 2920 2f20 322e  truth) + 1) / 2.
+00086930: 0d0a 2020 2020 7265 7475 726e 2067 7320  ..    return gs 
+00086940: 2f20 6c65 6e28 7472 7574 6829 0d0a 0d0a  / len(truth)....
+00086950: 6465 6620 6769 6e69 5f73 6b6c 6561 726e  def gini_sklearn
+00086960: 2874 7275 7468 2c20 7072 6564 6963 7469  (truth, predicti
+00086970: 6f6e 7329 3a0d 0a20 2020 2072 6574 7572  ons):..    retur
+00086980: 6e20 6769 6e69 2874 7275 7468 2c20 7072  n gini(truth, pr
+00086990: 6564 6963 7469 6f6e 7329 202f 2067 696e  edictions) / gin
+000869a0: 6928 7472 7574 682c 2074 7275 7468 290d  i(truth, truth).
+000869b0: 0a0d 0a64 6566 2067 696e 695f 6d65 6165  ...def gini_meae
+000869c0: 2874 7275 7468 2c20 7072 6564 6963 7469  (truth, predicti
+000869d0: 6f6e 7329 3a0d 0a20 2020 2073 636f 7265  ons):..    score
+000869e0: 203d 206d 6564 6961 6e5f 6162 736f 6c75   = median_absolu
+000869f0: 7465 5f65 7272 6f72 2874 7275 7468 2c20  te_error(truth, 
+00086a00: 7072 6564 6963 7469 6f6e 7329 0d0a 2020  predictions)..  
+00086a10: 2020 7265 7475 726e 2073 636f 7265 0d0a    return score..
+00086a20: 0d0a 6465 6620 6769 6e69 5f6d 736c 6528  ..def gini_msle(
+00086a30: 7472 7574 682c 2070 7265 6469 6374 696f  truth, predictio
+00086a40: 6e73 293a 0d0a 2020 2020 7363 6f72 6520  ns):..    score 
+00086a50: 3d20 6d65 616e 5f73 7175 6172 6564 5f6c  = mean_squared_l
+00086a60: 6f67 5f65 7272 6f72 2874 7275 7468 2c20  og_error(truth, 
+00086a70: 7072 6564 6963 7469 6f6e 7329 0d0a 2020  predictions)..  
+00086a80: 2020 7265 7475 726e 2073 636f 7265 0d0a    return score..
+00086a90: 0d0a 6465 6620 6769 6e69 5f6d 6165 2874  ..def gini_mae(t
+00086aa0: 7275 7468 2c20 7072 6564 6963 7469 6f6e  ruth, prediction
+00086ab0: 7329 3a0d 0a20 2020 2073 636f 7265 203d  s):..    score =
+00086ac0: 206d 6561 6e5f 6162 736f 6c75 7465 5f65   mean_absolute_e
+00086ad0: 7272 6f72 2874 7275 7468 2c20 7072 6564  rror(truth, pred
+00086ae0: 6963 7469 6f6e 7329 0d0a 2020 2020 7265  ictions)..    re
+00086af0: 7475 726e 2073 636f 7265 0d0a 0d0a 6465  turn score....de
+00086b00: 6620 6769 6e69 5f6d 7365 2874 7275 7468  f gini_mse(truth
+00086b10: 2c20 7072 6564 6963 7469 6f6e 7329 3a0d  , predictions):.
+00086b20: 0a20 2020 2073 636f 7265 203d 206d 6561  .    score = mea
+00086b30: 6e5f 7371 7561 7265 645f 6572 726f 7228  n_squared_error(
+00086b40: 7472 7574 682c 2070 7265 6469 6374 696f  truth, predictio
+00086b50: 6e73 290d 0a20 2020 2072 6574 7572 6e20  ns)..    return 
+00086b60: 7363 6f72 650d 0a0d 0a64 6566 2067 696e  score....def gin
+00086b70: 695f 726d 7365 2874 7275 7468 2c20 7072  i_rmse(truth, pr
+00086b80: 6564 6963 7469 6f6e 7329 3a0d 0a20 2020  edictions):..   
+00086b90: 2073 636f 7265 203d 206e 702e 7371 7274   score = np.sqrt
+00086ba0: 286d 6561 6e5f 7371 7561 7265 645f 6572  (mean_squared_er
+00086bb0: 726f 7228 7472 7574 682c 2070 7265 6469  ror(truth, predi
+00086bc0: 6374 696f 6e73 2929 0d0a 2020 2020 7265  ctions))..    re
+00086bd0: 7475 726e 2073 636f 7265 0d0a 0d0a 6465  turn score....de
+00086be0: 6620 6769 6e69 5f61 6363 7572 6163 7928  f gini_accuracy(
+00086bf0: 7472 7574 682c 2070 7265 6469 6374 696f  truth, predictio
+00086c00: 6e73 293a 0d0a 2020 2020 7265 7475 726e  ns):..    return
+00086c10: 2061 6363 7572 6163 795f 7363 6f72 6528   accuracy_score(
+00086c20: 7472 7574 682c 2070 7265 6469 6374 696f  truth, predictio
+00086c30: 6e73 290d 0a0d 0a64 6566 2067 696e 695f  ns)....def gini_
+00086c40: 6261 6c5f 6163 6375 7261 6379 2874 7275  bal_accuracy(tru
+00086c50: 7468 2c20 7072 6564 6963 7469 6f6e 7329  th, predictions)
+00086c60: 3a0d 0a20 2020 2072 6574 7572 6e20 6261  :..    return ba
+00086c70: 6c61 6e63 6564 5f61 6363 7572 6163 795f  lanced_accuracy_
+00086c80: 7363 6f72 6528 7472 7574 682c 2070 7265  score(truth, pre
+00086c90: 6469 6374 696f 6e73 290d 0a0d 0a64 6566  dictions)....def
+00086ca0: 2067 696e 695f 726f 6328 7472 7574 682c   gini_roc(truth,
+00086cb0: 2070 7265 6469 6374 696f 6e73 293a 0d0a   predictions):..
+00086cc0: 2020 2020 7265 7475 726e 2072 6f63 5f61      return roc_a
+00086cd0: 7563 5f73 636f 7265 2874 7275 7468 2c20  uc_score(truth, 
+00086ce0: 7072 6564 6963 7469 6f6e 7329 0d0a 0d0a  predictions)....
+00086cf0: 6465 6620 6769 6e69 5f70 7265 6369 7369  def gini_precisi
+00086d00: 6f6e 2874 7275 7468 2c20 7072 6564 6963  on(truth, predic
+00086d10: 7469 6f6e 732c 706f 735f 6c61 6265 6c3d  tions,pos_label=
+00086d20: 3129 3a0d 0a20 2020 2072 6574 7572 6e20  1):..    return 
+00086d30: 7072 6563 6973 696f 6e5f 7363 6f72 6528  precision_score(
+00086d40: 7472 7574 682c 2070 7265 6469 6374 696f  truth, predictio
+00086d50: 6e73 2c61 7665 7261 6765 3d4e 6f6e 6529  ns,average=None)
+00086d60: 5b70 6f73 5f6c 6162 656c 5d0d 0a0d 0a64  [pos_label]....d
+00086d70: 6566 2067 696e 695f 6176 6572 6167 655f  ef gini_average_
+00086d80: 7072 6563 6973 696f 6e28 7472 7574 682c  precision(truth,
+00086d90: 2070 7265 6469 6374 696f 6e73 293a 0d0a   predictions):..
+00086da0: 2020 2020 7265 7475 726e 2070 7265 6369      return preci
+00086db0: 7369 6f6e 5f73 636f 7265 2874 7275 7468  sion_score(truth
+00086dc0: 2c20 7072 6564 6963 7469 6f6e 732e 6172  , predictions.ar
+00086dd0: 676d 6178 2861 7869 733d 3129 2c61 7665  gmax(axis=1),ave
+00086de0: 7261 6765 3d27 6d61 6372 6f27 290d 0a0d  rage='macro')...
+00086df0: 0a64 6566 2067 696e 695f 7765 6967 6874  .def gini_weight
+00086e00: 6564 5f70 7265 6369 7369 6f6e 2874 7275  ed_precision(tru
+00086e10: 7468 2c20 7072 6564 6963 7469 6f6e 7329  th, predictions)
+00086e20: 3a0d 0a20 2020 2072 6574 7572 6e20 7072  :..    return pr
+00086e30: 6563 6973 696f 6e5f 7363 6f72 6528 7472  ecision_score(tr
+00086e40: 7574 682c 2070 7265 6469 6374 696f 6e73  uth, predictions
+00086e50: 2e61 7267 6d61 7828 6178 6973 3d31 292c  .argmax(axis=1),
+00086e60: 6176 6572 6167 653d 2777 6569 6768 7465  average='weighte
+00086e70: 6427 290d 0a0d 0a64 6566 2067 696e 695f  d')....def gini_
+00086e80: 6d61 6372 6f5f 7072 6563 6973 696f 6e28  macro_precision(
+00086e90: 7472 7574 682c 2070 7265 6469 6374 696f  truth, predictio
+00086ea0: 6e73 293a 0d0a 2020 2020 7265 7475 726e  ns):..    return
+00086eb0: 2070 7265 6369 7369 6f6e 5f73 636f 7265   precision_score
+00086ec0: 2874 7275 7468 2c20 7072 6564 6963 7469  (truth, predicti
+00086ed0: 6f6e 732e 6172 676d 6178 2861 7869 733d  ons.argmax(axis=
+00086ee0: 3129 2c61 7665 7261 6765 3d27 6d61 6372  1),average='macr
+00086ef0: 6f27 290d 0a0d 0a64 6566 2067 696e 695f  o')....def gini_
+00086f00: 6d69 6372 6f5f 7072 6563 6973 696f 6e28  micro_precision(
+00086f10: 7472 7574 682c 2070 7265 6469 6374 696f  truth, predictio
+00086f20: 6e73 293a 0d0a 2020 2020 7265 7475 726e  ns):..    return
+00086f30: 2070 7265 6369 7369 6f6e 5f73 636f 7265   precision_score
+00086f40: 2874 7275 7468 2c20 7072 6564 6963 7469  (truth, predicti
+00086f50: 6f6e 732e 6172 676d 6178 2861 7869 733d  ons.argmax(axis=
+00086f60: 3129 2c61 7665 7261 6765 3d27 6d69 6372  1),average='micr
+00086f70: 6f27 290d 0a0d 0a64 6566 2067 696e 695f  o')....def gini_
+00086f80: 7361 6d70 6c65 735f 7072 6563 6973 696f  samples_precisio
+00086f90: 6e28 7472 7574 682c 2070 7265 6469 6374  n(truth, predict
+00086fa0: 696f 6e73 293a 0d0a 2020 2020 7265 7475  ions):..    retu
+00086fb0: 726e 2070 7265 6369 7369 6f6e 5f73 636f  rn precision_sco
+00086fc0: 7265 2874 7275 7468 2c20 7072 6564 6963  re(truth, predic
+00086fd0: 7469 6f6e 732e 6172 676d 6178 2861 7869  tions.argmax(axi
+00086fe0: 733d 3129 2c61 7665 7261 6765 3d27 7361  s=1),average='sa
+00086ff0: 6d70 6c65 7327 290d 0a0d 0a64 6566 2067  mples')....def g
+00087000: 696e 695f 6631 2874 7275 7468 2c20 7072  ini_f1(truth, pr
+00087010: 6564 6963 7469 6f6e 732c 706f 735f 6c61  edictions,pos_la
+00087020: 6265 6c3d 3129 3a0d 0a20 2020 2072 6574  bel=1):..    ret
+00087030: 7572 6e20 6631 5f73 636f 7265 2874 7275  urn f1_score(tru
+00087040: 7468 2c20 7072 6564 6963 7469 6f6e 732c  th, predictions,
+00087050: 6176 6572 6167 653d 4e6f 6e65 295b 706f  average=None)[po
+00087060: 735f 6c61 6265 6c5d 0d0a 0d0a 6465 6620  s_label]....def 
+00087070: 6769 6e69 5f77 6569 6768 7465 645f 6631  gini_weighted_f1
+00087080: 2874 7275 7468 2c20 7072 6564 6963 7469  (truth, predicti
+00087090: 6f6e 7329 3a0d 0a20 2020 2072 6574 7572  ons):..    retur
+000870a0: 6e20 6631 5f73 636f 7265 2874 7275 7468  n f1_score(truth
+000870b0: 2c20 7072 6564 6963 7469 6f6e 732e 6172  , predictions.ar
+000870c0: 676d 6178 2861 7869 733d 3129 2c61 7665  gmax(axis=1),ave
+000870d0: 7261 6765 3d27 7765 6967 6874 6564 2729  rage='weighted')
+000870e0: 0d0a 0d0a 6465 6620 6769 6e69 5f6d 6163  ....def gini_mac
+000870f0: 726f 5f66 3128 7472 7574 682c 2070 7265  ro_f1(truth, pre
+00087100: 6469 6374 696f 6e73 293a 0d0a 2020 2020  dictions):..    
+00087110: 7265 7475 726e 2066 315f 7363 6f72 6528  return f1_score(
+00087120: 7472 7574 682c 2070 7265 6469 6374 696f  truth, predictio
+00087130: 6e73 2e61 7267 6d61 7828 6178 6973 3d31  ns.argmax(axis=1
+00087140: 292c 6176 6572 6167 653d 276d 6163 726f  ),average='macro
+00087150: 2729 0d0a 0d0a 6465 6620 6769 6e69 5f6d  ')....def gini_m
+00087160: 6963 726f 5f66 3128 7472 7574 682c 2070  icro_f1(truth, p
+00087170: 7265 6469 6374 696f 6e73 293a 0d0a 2020  redictions):..  
+00087180: 2020 7265 7475 726e 2066 315f 7363 6f72    return f1_scor
+00087190: 6528 7472 7574 682c 2070 7265 6469 6374  e(truth, predict
+000871a0: 696f 6e73 2e61 7267 6d61 7828 6178 6973  ions.argmax(axis
+000871b0: 3d31 292c 6176 6572 6167 653d 276d 6963  =1),average='mic
+000871c0: 726f 2729 0d0a 0d0a 6465 6620 6769 6e69  ro')....def gini
+000871d0: 5f73 616d 706c 6573 5f66 3128 7472 7574  _samples_f1(trut
+000871e0: 682c 2070 7265 6469 6374 696f 6e73 293a  h, predictions):
+000871f0: 0d0a 2020 2020 7265 7475 726e 2066 315f  ..    return f1_
+00087200: 7363 6f72 6528 7472 7574 682c 2070 7265  score(truth, pre
+00087210: 6469 6374 696f 6e73 2e61 7267 6d61 7828  dictions.argmax(
+00087220: 6178 6973 3d31 292c 6176 6572 6167 653d  axis=1),average=
+00087230: 2773 616d 706c 6573 2729 0d0a 0d0a 6465  'samples')....de
+00087240: 6620 6769 6e69 5f6c 6f67 5f6c 6f73 7328  f gini_log_loss(
+00087250: 7472 7574 682c 2070 7265 6469 6374 696f  truth, predictio
+00087260: 6e73 293a 0d0a 2020 2020 7265 7475 726e  ns):..    return
+00087270: 206c 6f67 5f6c 6f73 7328 7472 7574 682c   log_loss(truth,
+00087280: 2070 7265 6469 6374 696f 6e73 2c6e 6f72   predictions,nor
+00087290: 6d61 6c69 7a65 3d54 7275 6529 0d0a 0d0a  malize=True)....
+000872a0: 6465 6620 6769 6e69 5f72 6563 616c 6c28  def gini_recall(
+000872b0: 7472 7574 682c 2070 7265 6469 6374 696f  truth, predictio
+000872c0: 6e73 2c70 6f73 5f6c 6162 656c 3d31 293a  ns,pos_label=1):
+000872d0: 0d0a 2020 2020 7265 7475 726e 2072 6563  ..    return rec
+000872e0: 616c 6c5f 7363 6f72 6528 7472 7574 682c  all_score(truth,
+000872f0: 2070 7265 6469 6374 696f 6e73 2c61 7665   predictions,ave
+00087300: 7261 6765 3d4e 6f6e 6529 5b70 6f73 5f6c  rage=None)[pos_l
+00087310: 6162 656c 5d0d 0a0d 0a64 6566 2067 696e  abel]....def gin
+00087320: 695f 7765 6967 6874 6564 5f72 6563 616c  i_weighted_recal
+00087330: 6c28 7472 7574 682c 2070 7265 6469 6374  l(truth, predict
+00087340: 696f 6e73 293a 0d0a 2020 2020 7265 7475  ions):..    retu
+00087350: 726e 2072 6563 616c 6c5f 7363 6f72 6528  rn recall_score(
+00087360: 7472 7574 682c 2070 7265 6469 6374 696f  truth, predictio
+00087370: 6e73 2e61 7267 6d61 7828 6178 6973 3d31  ns.argmax(axis=1
+00087380: 292c 6176 6572 6167 653d 2777 6569 6768  ),average='weigh
+00087390: 7465 6427 290d 0a0d 0a64 6566 2067 696e  ted')....def gin
+000873a0: 695f 7361 6d70 6c65 735f 7265 6361 6c6c  i_samples_recall
+000873b0: 2874 7275 7468 2c20 7072 6564 6963 7469  (truth, predicti
+000873c0: 6f6e 7329 3a0d 0a20 2020 2072 6574 7572  ons):..    retur
+000873d0: 6e20 7265 6361 6c6c 5f73 636f 7265 2874  n recall_score(t
+000873e0: 7275 7468 2c20 7072 6564 6963 7469 6f6e  ruth, prediction
+000873f0: 732e 6172 676d 6178 2861 7869 733d 3129  s.argmax(axis=1)
+00087400: 2c61 7665 7261 6765 3d27 7361 6d70 6c65  ,average='sample
+00087410: 7327 290d 0a0d 0a64 6566 2067 696e 695f  s')....def gini_
+00087420: 6d61 6372 6f5f 7265 6361 6c6c 2874 7275  macro_recall(tru
+00087430: 7468 2c20 7072 6564 6963 7469 6f6e 7329  th, predictions)
+00087440: 3a0d 0a20 2020 2072 6574 7572 6e20 7265  :..    return re
+00087450: 6361 6c6c 5f73 636f 7265 2874 7275 7468  call_score(truth
+00087460: 2c20 7072 6564 6963 7469 6f6e 732e 6172  , predictions.ar
+00087470: 676d 6178 2861 7869 733d 3129 2c61 7665  gmax(axis=1),ave
+00087480: 7261 6765 3d27 6d61 6372 6f27 290d 0a0d  rage='macro')...
+00087490: 0a64 6566 2067 696e 695f 6d69 6372 6f5f  .def gini_micro_
+000874a0: 7265 6361 6c6c 2874 7275 7468 2c20 7072  recall(truth, pr
+000874b0: 6564 6963 7469 6f6e 7329 3a0d 0a20 2020  edictions):..   
+000874c0: 2072 6574 7572 6e20 7265 6361 6c6c 5f73   return recall_s
+000874d0: 636f 7265 2874 7275 7468 2c20 7072 6564  core(truth, pred
+000874e0: 6963 7469 6f6e 732e 6172 676d 6178 2861  ictions.argmax(a
+000874f0: 7869 733d 3129 2c61 7665 7261 6765 3d27  xis=1),average='
+00087500: 6d69 6372 6f27 290d 0a0d 0a23 2063 616c  micro')....# cal
+00087510: 6375 6c61 7465 2066 322d 6d65 6173 7572  culate f2-measur
+00087520: 650d 0a64 6566 2066 325f 6d65 6173 7572  e..def f2_measur
+00087530: 6528 795f 7472 7565 2c20 795f 7072 6564  e(y_true, y_pred
+00087540: 293a 0d0a 2020 2020 7265 7475 726e 2066  ):..    return f
+00087550: 6265 7461 5f73 636f 7265 2879 5f74 7275  beta_score(y_tru
+00087560: 652c 2079 5f70 7265 642c 2062 6574 613d  e, y_pred, beta=
+00087570: 3229 0d0a 0000 0000 0000 0000 0000 0000  2)..............
+00087580: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+00087590: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+000875a0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+000875b0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+000875c0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+000875d0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+000875e0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+000875f0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+00087600: 2e2f 2e2f 4050 6178 4865 6164 6572 0000  ././@PaxHeader..
+00087610: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+00087620: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+00087630: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+00087640: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+00087650: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+00087660: 0000 0000 3030 3030 3030 3000 3030 3030  ....0000000.0000
+00087670: 3030 3000 3030 3030 3030 3000 3030 3030  000.0000000.0000
+00087680: 3030 3030 3032 3600 3030 3030 3030 3030  0000026.00000000
+00087690: 3030 3000 3031 3134 3533 0020 7800 0000  000.011453. x...
+000876a0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+000876b0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+000876c0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+000876d0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+000876e0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+000876f0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+00087700: 0075 7374 6172 0030 3000 0000 0000 0000  .ustar.00.......
+00087710: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+00087720: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+00087730: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+00087740: 0000 0000 0000 0000 0030 3030 3030 3030  .........0000000
+00087750: 0030 3030 3030 3030 0000 0000 0000 0000  .0000000........
+00087760: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+00087770: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+00087780: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+00087790: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+000877a0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+000877b0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+000877c0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+000877d0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+000877e0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+000877f0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+00087800: 3232 206d 7469 6d65 3d31 3637 3831 3539  22 mtime=1678159
+00087810: 3732 322e 300a 0000 0000 0000 0000 0000  722.0...........
+00087820: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+00087830: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+00087840: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+00087850: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+00087860: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+00087870: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+00087880: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+00087890: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+000878a0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+000878b0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+000878c0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+000878d0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+000878e0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+000878f0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+00087900: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+00087910: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+00087920: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+00087930: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+00087940: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+00087950: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+00087960: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+00087970: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+00087980: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+00087990: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+000879a0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+000879b0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+000879c0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+000879d0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+000879e0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+000879f0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+00087a00: 6175 746f 7669 6d6c 2d30 2e31 2e37 3135  autoviml-0.1.715
+00087a10: 2f61 7574 6f76 696d 6c2f 6375 7374 6f6d  /autoviml/custom
+00087a20: 5f73 636f 7265 735f 484f 2e70 7900 0000  _scores_HO.py...
+00087a30: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+00087a40: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+00087a50: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+00087a60: 0000 0000 3030 3030 3737 3700 3030 3031  ....0000777.0001
+00087a70: 3735 3000 3030 3031 3735 3000 3030 3030  750.0001750.0000
+00087a80: 3030 3230 3630 3500 3030 3030 3030 3030  0020605.00000000
+00087a90: 3030 3000 3032 3036 3130 0020 3000 0000  000.020610. 0...
+00087aa0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+00087ab0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+00087ac0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+00087ad0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+00087ae0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+00087af0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+00087b00: 0075 7374 6172 0030 3072 616d 0000 0000  .ustar.00ram....
+00087b10: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+00087b20: 0000 0000 0000 0000 0072 616d 0000 0000  .........ram....
+00087b30: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+00087b40: 0000 0000 0000 0000 0030 3030 3030 3030  .........0000000
+00087b50: 0030 3030 3030 3030 0000 0000 0000 0000  .0000000........
+00087b60: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+00087b70: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+00087b80: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+00087b90: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+00087ba0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+00087bb0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+00087bc0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+00087bd0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+00087be0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+00087bf0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+00087c00: 696d 706f 7274 206e 756d 7079 2061 7320  import numpy as 
+00087c10: 6e70 0d0a 6672 6f6d 2073 6b6c 6561 726e  np..from sklearn
+00087c20: 2069 6d70 6f72 7420 6d6f 6465 6c5f 7365   import model_se
+00087c30: 6c65 6374 696f 6e0d 0a66 726f 6d20 736b  lection..from sk
+00087c40: 6c65 6172 6e2e 6d65 7472 6963 7320 696d  learn.metrics im
+00087c50: 706f 7274 2063 6f6e 6675 7369 6f6e 5f6d  port confusion_m
+00087c60: 6174 7269 782c 206d 6561 6e5f 7371 7561  atrix, mean_squa
+00087c70: 7265 645f 6572 726f 720d 0a66 726f 6d20  red_error..from 
+00087c80: 736b 6c65 6172 6e20 696d 706f 7274 206d  sklearn import m
+00087c90: 6574 7269 6373 0d0a 6672 6f6d 2073 6b6c  etrics..from skl
+00087ca0: 6561 726e 2069 6d70 6f72 7420 6d6f 6465  earn import mode
+00087cb0: 6c5f 7365 6c65 6374 696f 6e2c 206d 6574  l_selection, met
+00087cc0: 7269 6373 2020 2023 4164 6469 7469 6f6e  rics   #Addition
+00087cd0: 616c 2073 6b6c 6561 726e 2066 756e 6374  al sklearn funct
+00087ce0: 696f 6e73 0d0a 6672 6f6d 2073 6b6c 6561  ions..from sklea
+00087cf0: 726e 2e6d 6574 7269 6373 2069 6d70 6f72  rn.metrics impor
+00087d00: 7420 6163 6375 7261 6379 5f73 636f 7265  t accuracy_score
+00087d10: 2c66 315f 7363 6f72 652c 726f 635f 6175  ,f1_score,roc_au
+00087d20: 635f 7363 6f72 652c 6c6f 675f 6c6f 7373  c_score,log_loss
+00087d30: 0d0a 6672 6f6d 2073 6b6c 6561 726e 2e6d  ..from sklearn.m
+00087d40: 6574 7269 6373 2069 6d70 6f72 7420 6d65  etrics import me
+00087d50: 616e 5f73 7175 6172 6564 5f65 7272 6f72  an_squared_error
+00087d60: 2c6d 6564 6961 6e5f 6162 736f 6c75 7465  ,median_absolute
+00087d70: 5f65 7272 6f72 2c6d 6561 6e5f 6162 736f  _error,mean_abso
+00087d80: 6c75 7465 5f65 7272 6f72 0d0a 6672 6f6d  lute_error..from
+00087d90: 2073 6b6c 6561 726e 2e6d 6574 7269 6373   sklearn.metrics
+00087da0: 2069 6d70 6f72 7420 636c 6173 7369 6669   import classifi
+00087db0: 6361 7469 6f6e 5f72 6570 6f72 742c 2063  cation_report, c
+00087dc0: 6f6e 6675 7369 6f6e 5f6d 6174 7269 782c  onfusion_matrix,
+00087dd0: 6d65 616e 5f73 7175 6172 6564 5f6c 6f67  mean_squared_log
+00087de0: 5f65 7272 6f72 0d0a 6672 6f6d 2073 6b6c  _error..from skl
+00087df0: 6561 726e 2e6d 6574 7269 6373 2069 6d70  earn.metrics imp
+00087e00: 6f72 7420 7072 6563 6973 696f 6e5f 7265  ort precision_re
+00087e10: 6361 6c6c 5f63 7572 7665 0d0a 6672 6f6d  call_curve..from
+00087e20: 2073 6b6c 6561 726e 2e6d 6f64 656c 5f73   sklearn.model_s
+00087e30: 656c 6563 7469 6f6e 2069 6d70 6f72 7420  election import 
+00087e40: 6372 6f73 735f 7661 6c5f 7363 6f72 652c  cross_val_score,
+00087e50: 2053 7472 6174 6966 6965 644b 466f 6c64   StratifiedKFold
+00087e60: 2c20 4b46 6f6c 640d 0a66 726f 6d20 736b  , KFold..from sk
+00087e70: 6c65 6172 6e2e 6d65 7472 6963 7320 696d  learn.metrics im
+00087e80: 706f 7274 206d 616b 655f 7363 6f72 6572  port make_scorer
+00087e90: 0d0a 6672 6f6d 2073 6b6c 6561 726e 2e6d  ..from sklearn.m
+00087ea0: 6574 7269 6373 2069 6d70 6f72 7420 6163  etrics import ac
+00087eb0: 6375 7261 6379 5f73 636f 7265 2020 200d  curacy_score   .
+00087ec0: 0a66 726f 6d20 736b 6c65 6172 6e2e 6d65  .from sklearn.me
+00087ed0: 7472 6963 7320 696d 706f 7274 2061 7665  trics import ave
+00087ee0: 7261 6765 5f70 7265 6369 7369 6f6e 5f73  rage_precision_s
+00087ef0: 636f 7265 0d0a 6672 6f6d 2073 6b6c 6561  core..from sklea
+00087f00: 726e 2e6d 6574 7269 6373 2069 6d70 6f72  rn.metrics impor
+00087f10: 7420 6631 5f73 636f 7265 0d0a 6672 6f6d  t f1_score..from
+00087f20: 2073 6b6c 6561 726e 2e6d 6574 7269 6373   sklearn.metrics
+00087f30: 2069 6d70 6f72 7420 6c6f 675f 6c6f 7373   import log_loss
+00087f40: 0d0a 6672 6f6d 2073 6b6c 6561 726e 2e6d  ..from sklearn.m
+00087f50: 6574 7269 6373 2069 6d70 6f72 7420 7072  etrics import pr
+00087f60: 6563 6973 696f 6e5f 7363 6f72 650d 0a66  ecision_score..f
+00087f70: 726f 6d20 736b 6c65 6172 6e2e 6d65 7472  rom sklearn.metr
+00087f80: 6963 7320 696d 706f 7274 2072 6563 616c  ics import recal
+00087f90: 6c5f 7363 6f72 650d 0a66 726f 6d20 736b  l_score..from sk
+00087fa0: 6c65 6172 6e2e 6d65 7472 6963 7320 696d  learn.metrics im
+00087fb0: 706f 7274 2072 6f63 5f61 7563 5f73 636f  port roc_auc_sco
+00087fc0: 7265 0d0a 6672 6f6d 2073 6b6c 6561 726e  re..from sklearn
+00087fd0: 2e6d 6574 7269 6373 2069 6d70 6f72 7420  .metrics import 
+00087fe0: 6662 6574 615f 7363 6f72 650d 0a23 2323  fbeta_score..###
+00087ff0: 2323 2323 2323 2323 2323 2323 2323 2323  ################
+00088000: 2323 2323 2323 2323 2323 2323 2323 2323  ################
+00088010: 2323 2323 2323 2323 2323 2323 2323 2323  ################
+00088020: 2323 2323 2323 2323 2323 2323 2323 2323  ################
+00088030: 2323 2323 2323 2323 2323 2323 2323 2323  ################
+00088040: 2323 0d0a 6672 6f6d 2073 6b6c 6561 726e  ##..from sklearn
+00088050: 2e6d 6574 7269 6373 2069 6d70 6f72 7420  .metrics import 
+00088060: 636f 6e66 7573 696f 6e5f 6d61 7472 6978  confusion_matrix
+00088070: 0d0a 6465 6620 6261 6c61 6e63 6564 5f61  ..def balanced_a
+00088080: 6363 7572 6163 795f 7363 6f72 6528 795f  ccuracy_score(y_
+00088090: 7472 7565 2c20 795f 7072 6564 2c20 7361  true, y_pred, sa
+000880a0: 6d70 6c65 5f77 6569 6768 743d 4e6f 6e65  mple_weight=None
+000880b0: 2c0d 0a20 2020 2020 2020 2020 2020 2020  ,..             
+000880c0: 2020 2020 2020 2020 2020 2020 2020 2061                 a
+000880d0: 646a 7573 7465 643d 4661 6c73 6529 3a0d  djusted=False):.
+000880e0: 0a20 2020 2043 203d 2063 6f6e 6675 7369  .    C = confusi
+000880f0: 6f6e 5f6d 6174 7269 7828 795f 7472 7565  on_matrix(y_true
+00088100: 2c20 795f 7072 6564 2c20 7361 6d70 6c65  , y_pred, sample
+00088110: 5f77 6569 6768 743d 7361 6d70 6c65 5f77  _weight=sample_w
+00088120: 6569 6768 7429 0d0a 2020 2020 7769 7468  eight)..    with
+00088130: 206e 702e 6572 7273 7461 7465 2864 6976   np.errstate(div
+00088140: 6964 653d 2769 676e 6f72 6527 2c20 696e  ide='ignore', in
+00088150: 7661 6c69 643d 2769 676e 6f72 6527 293a  valid='ignore'):
+00088160: 0d0a 2020 2020 2020 2020 7065 725f 636c  ..        per_cl
+00088170: 6173 7320 3d20 6e70 2e64 6961 6728 4329  ass = np.diag(C)
+00088180: 202f 2043 2e73 756d 2861 7869 733d 3129   / C.sum(axis=1)
+00088190: 0d0a 2020 2020 6966 206e 702e 616e 7928  ..    if np.any(
+000881a0: 6e70 2e69 736e 616e 2870 6572 5f63 6c61  np.isnan(per_cla
+000881b0: 7373 2929 3a0d 0a20 2020 2020 2020 2077  ss)):..        w
+000881c0: 6172 6e69 6e67 732e 7761 726e 2827 795f  arnings.warn('y_
+000881d0: 7072 6564 2063 6f6e 7461 696e 7320 636c  pred contains cl
+000881e0: 6173 7365 7320 6e6f 7420 696e 2079 5f74  asses not in y_t
+000881f0: 7275 6527 290d 0a20 2020 2020 2020 2070  rue')..        p
+00088200: 6572 5f63 6c61 7373 203d 2070 6572 5f63  er_class = per_c
+00088210: 6c61 7373 5b7e 6e70 2e69 736e 616e 2870  lass[~np.isnan(p
+00088220: 6572 5f63 6c61 7373 295d 0d0a 2020 2020  er_class)]..    
+00088230: 7363 6f72 6520 3d20 6e70 2e6d 6561 6e28  score = np.mean(
+00088240: 7065 725f 636c 6173 7329 0d0a 2020 2020  per_class)..    
+00088250: 6966 2061 646a 7573 7465 643a 0d0a 2020  if adjusted:..  
+00088260: 2020 2020 2020 6e5f 636c 6173 7365 7320        n_classes 
+00088270: 3d20 6c65 6e28 7065 725f 636c 6173 7329  = len(per_class)
+00088280: 0d0a 2020 2020 2020 2020 6368 616e 6365  ..        chance
+00088290: 203d 2031 202f 206e 5f63 6c61 7373 6573   = 1 / n_classes
+000882a0: 0d0a 2020 2020 2020 2020 7363 6f72 6520  ..        score 
+000882b0: 2d3d 2063 6861 6e63 650d 0a20 2020 2020  -= chance..     
+000882c0: 2020 2073 636f 7265 202f 3d20 3120 2d20     score /= 1 - 
+000882d0: 6368 616e 6365 0d0a 2020 2020 7265 7475  chance..    retu
+000882e0: 726e 2073 636f 7265 0d0a 2323 2323 2323  rn score..######
+000882f0: 2323 2323 2323 2323 2323 2323 2323 2323  ################
+00088300: 2323 2323 2323 2323 2323 2323 2323 2323  ################
+00088310: 2323 2323 2323 2323 2323 2323 2323 2323  ################
+00088320: 2323 2323 2323 2323 2323 2323 2323 2323  ################
+00088330: 2323 2323 2323 2323 2323 2323 2323 230d  ###############.
+00088340: 0a64 6566 2061 6363 7528 7265 7375 6c74  .def accu(result
+00088350: 732c 2079 5f63 7629 3a0d 0a20 2020 2072  s, y_cv):..    r
+00088360: 6574 7572 6e20 2872 6573 756c 7473 3d3d  eturn (results==
+00088370: 795f 6376 292e 6173 7479 7065 2869 6e74  y_cv).astype(int
+00088380: 292e 7375 6d28 6178 6973 3d30 292f 2879  ).sum(axis=0)/(y
+00088390: 5f63 762e 7368 6170 655b 305d 290d 0a64  _cv.shape[0])..d
+000883a0: 6566 2072 6d73 6528 7265 7375 6c74 732c  ef rmse(results,
+000883b0: 2079 5f63 7629 3a0d 0a20 2020 2072 6574   y_cv):..    ret
+000883c0: 7572 6e20 6e70 2e73 7172 7428 6e70 2e6d  urn np.sqrt(np.m
+000883d0: 6561 6e28 2872 6573 756c 7473 202d 2079  ean((results - y
+000883e0: 5f63 7629 2a2a 322c 2061 7869 733d 3029  _cv)**2, axis=0)
+000883f0: 290d 0a23 2323 2323 2323 2320 4465 6669  )..######## Defi
+00088400: 6e69 6e67 206f 626a 6563 7469 7665 2066  ning objective f
+00088410: 756e 6374 696f 6e73 2066 6f72 2048 7970  unctions for Hyp
+00088420: 6572 4f70 7420 6865 7265 2023 2323 2323  erOpt here #####
+00088430: 2323 2323 2323 2323 2323 2323 2323 2323  ################
+00088440: 230d 0a23 2323 206b 6565 7020 616c 6c20  #..### keep all 
+00088450: 436c 6173 7369 6669 6361 7469 6f6e 2053  Classification S
+00088460: 636f 7265 7273 2067 7265 6174 6572 5f69  corers greater_i
+00088470: 735f 6265 7474 6572 2054 7275 6520 6275  s_better True bu
+00088480: 7420 7375 6274 7261 6374 2073 636f 7265  t subtract score
+00088490: 7220 6672 6f6d 2031 2073 6f20 6974 2064  r from 1 so it d
+000884a0: 696d 696e 6973 6865 732e 0d0a 2323 2323  iminishes...####
+000884b0: 2054 6869 7320 6973 2074 6865 206f 6e6c   This is the onl
+000884c0: 7920 7761 7920 4879 7065 724f 7074 2077  y way HyperOpt w
+000884d0: 696c 6c20 6669 6e64 2074 6865 206d 696e  ill find the min
+000884e0: 696d 756d 202d 2073 6f20 646f 6e27 7420  imum - so don't 
+000884f0: 6368 616e 6765 2074 6869 7320 636f 6465  change this code
+00088500: 2061 6e79 7469 6d65 210d 0a64 6566 2067   anytime!..def g
+00088510: 696e 6928 7472 7574 682c 2070 7265 6469  ini(truth, predi
+00088520: 6374 696f 6e73 293a 0d0a 2020 2020 6720  ctions):..    g 
+00088530: 3d20 6e70 2e61 7361 7272 6179 286e 702e  = np.asarray(np.
+00088540: 635f 5b74 7275 7468 2c20 7072 6564 6963  c_[truth, predic
+00088550: 7469 6f6e 732c 206e 702e 6172 616e 6765  tions, np.arange
+00088560: 286c 656e 2874 7275 7468 2929 205d 2c20  (len(truth)) ], 
+00088570: 6474 7970 653d 6e70 2e66 6c6f 6174 290d  dtype=np.float).
+00088580: 0a20 2020 2067 203d 2067 5b6e 702e 6c65  .    g = g[np.le
+00088590: 7873 6f72 7428 2867 5b3a 2c32 5d2c 202d  xsort((g[:,2], -
+000885a0: 312a 675b 3a2c 315d 2929 5d0d 0a20 2020  1*g[:,1]))]..   
+000885b0: 2067 7320 3d20 675b 3a2c 305d 2e63 756d   gs = g[:,0].cum
+000885c0: 7375 6d28 292e 7375 6d28 2920 2f20 675b  sum().sum() / g[
+000885d0: 3a2c 305d 2e73 756d 2829 0d0a 2020 2020  :,0].sum()..    
+000885e0: 6773 202d 3d20 286c 656e 2874 7275 7468  gs -= (len(truth
+000885f0: 2920 2b20 3129 202f 2032 2e0d 0a20 2020  ) + 1) / 2...   
+00088600: 2072 6574 7572 6e20 6773 202f 206c 656e   return gs / len
+00088610: 2874 7275 7468 290d 0a0d 0a64 6566 2067  (truth)....def g
+00088620: 696e 695f 736b 6c65 6172 6e28 7472 7574  ini_sklearn(trut
+00088630: 682c 2070 7265 6469 6374 696f 6e73 293a  h, predictions):
+00088640: 0d0a 2020 2020 7265 7475 726e 2067 696e  ..    return gin
+00088650: 6928 7472 7574 682c 2070 7265 6469 6374  i(truth, predict
+00088660: 696f 6e73 2920 2f20 6769 6e69 2874 7275  ions) / gini(tru
+00088670: 7468 2c20 7472 7574 6829 0d0a 0d0a 6465  th, truth)....de
+00088680: 6620 6769 6e69 5f6d 6561 6528 7472 7574  f gini_meae(trut
+00088690: 682c 2070 7265 6469 6374 696f 6e73 293a  h, predictions):
+000886a0: 0d0a 2020 2020 7363 6f72 6520 3d20 6d65  ..    score = me
+000886b0: 6469 616e 5f61 6273 6f6c 7574 655f 6572  dian_absolute_er
+000886c0: 726f 7228 7472 7574 682c 2070 7265 6469  ror(truth, predi
+000886d0: 6374 696f 6e73 290d 0a20 2020 2072 6574  ctions)..    ret
+000886e0: 7572 6e20 7363 6f72 650d 0a0d 0a64 6566  urn score....def
+000886f0: 2067 696e 695f 6d73 6c65 2874 7275 7468   gini_msle(truth
+00088700: 2c20 7072 6564 6963 7469 6f6e 7329 3a0d  , predictions):.
+00088710: 0a20 2020 2073 636f 7265 203d 206e 702e  .    score = np.
+00088720: 7371 7274 286d 6561 6e5f 7371 7561 7265  sqrt(mean_square
+00088730: 645f 6c6f 675f 6572 726f 7228 7472 7574  d_log_error(trut
+00088740: 682c 2070 7265 6469 6374 696f 6e73 2929  h, predictions))
+00088750: 0d0a 2020 2020 7265 7475 726e 2073 636f  ..    return sco
+00088760: 7265 0d0a 0d0a 6465 6620 6769 6e69 5f6d  re....def gini_m
+00088770: 6165 2874 7275 7468 2c20 7072 6564 6963  ae(truth, predic
+00088780: 7469 6f6e 7329 3a0d 0a20 2020 2073 636f  tions):..    sco
+00088790: 7265 203d 206d 6561 6e5f 6162 736f 6c75  re = mean_absolu
+000887a0: 7465 5f65 7272 6f72 2874 7275 7468 2c20  te_error(truth, 
+000887b0: 7072 6564 6963 7469 6f6e 7329 0d0a 2020  predictions)..  
+000887c0: 2020 7265 7475 726e 2073 636f 7265 0d0a    return score..
+000887d0: 0d0a 6465 6620 6769 6e69 5f6d 7365 2874  ..def gini_mse(t
+000887e0: 7275 7468 2c20 7072 6564 6963 7469 6f6e  ruth, prediction
+000887f0: 7329 3a0d 0a20 2020 2073 636f 7265 203d  s):..    score =
+00088800: 206e 702e 7371 7274 286d 6561 6e5f 7371   np.sqrt(mean_sq
+00088810: 7561 7265 645f 6572 726f 7228 7472 7574  uared_error(trut
+00088820: 682c 2070 7265 6469 6374 696f 6e73 2929  h, predictions))
+00088830: 0d0a 2020 2020 7265 7475 726e 2073 636f  ..    return sco
+00088840: 7265 0d0a 0d0a 6465 6620 6769 6e69 5f72  re....def gini_r
+00088850: 6d73 6528 7472 7574 682c 2070 7265 6469  mse(truth, predi
+00088860: 6374 696f 6e73 293a 0d0a 2020 2020 7363  ctions):..    sc
+00088870: 6f72 6520 3d20 6e70 2e73 7172 7428 6d65  ore = np.sqrt(me
+00088880: 616e 5f73 7175 6172 6564 5f65 7272 6f72  an_squared_error
+00088890: 2874 7275 7468 2c20 7072 6564 6963 7469  (truth, predicti
+000888a0: 6f6e 7329 290d 0a20 2020 2072 6574 7572  ons))..    retur
+000888b0: 6e20 7363 6f72 650d 0a0d 0a64 6566 2067  n score....def g
+000888c0: 696e 695f 6163 6375 7261 6379 2874 7275  ini_accuracy(tru
+000888d0: 7468 2c20 7072 6564 6963 7469 6f6e 7329  th, predictions)
+000888e0: 3a0d 0a20 2020 2072 6574 7572 6e20 312d  :..    return 1-
+000888f0: 6163 6375 7261 6379 5f73 636f 7265 2874  accuracy_score(t
+00088900: 7275 7468 2c20 7072 6564 6963 7469 6f6e  ruth, prediction
+00088910: 7329 0d0a 0d0a 6465 6620 6769 6e69 5f62  s)....def gini_b
+00088920: 616c 5f61 6363 7572 6163 7928 7472 7574  al_accuracy(trut
+00088930: 682c 2070 7265 6469 6374 696f 6e73 293a  h, predictions):
+00088940: 0d0a 2020 2020 7265 7475 726e 2031 2d62  ..    return 1-b
+00088950: 616c 616e 6365 645f 6163 6375 7261 6379  alanced_accuracy
+00088960: 5f73 636f 7265 2874 7275 7468 2c20 7072  _score(truth, pr
+00088970: 6564 6963 7469 6f6e 7329 0d0a 0d0a 6465  edictions)....de
+00088980: 6620 6769 6e69 5f72 6f63 2874 7275 7468  f gini_roc(truth
+00088990: 2c20 7072 6564 6963 7469 6f6e 7329 3a0d  , predictions):.
+000889a0: 0a20 2020 2072 6574 7572 6e20 312d 726f  .    return 1-ro
+000889b0: 635f 6175 635f 7363 6f72 6528 7472 7574  c_auc_score(trut
+000889c0: 682c 2070 7265 6469 6374 696f 6e73 290d  h, predictions).
+000889d0: 0a0d 0a64 6566 2067 696e 695f 7072 6563  ...def gini_prec
+000889e0: 6973 696f 6e28 7472 7574 682c 2070 7265  ision(truth, pre
+000889f0: 6469 6374 696f 6e73 2c70 6f73 5f6c 6162  dictions,pos_lab
+00088a00: 656c 3d31 293a 0d0a 2020 2020 7265 7475  el=1):..    retu
+00088a10: 726e 2031 2d70 7265 6369 7369 6f6e 5f73  rn 1-precision_s
+00088a20: 636f 7265 2874 7275 7468 2c20 7072 6564  core(truth, pred
+00088a30: 6963 7469 6f6e 7329 0d0a 0d0a 6465 6620  ictions)....def 
+00088a40: 6769 6e69 5f61 7665 7261 6765 5f70 7265  gini_average_pre
+00088a50: 6369 7369 6f6e 2874 7275 7468 2c20 7072  cision(truth, pr
+00088a60: 6564 6963 7469 6f6e 7329 3a0d 0a20 2020  edictions):..   
+00088a70: 2072 6574 7572 6e20 312d 6176 6572 6167   return 1-averag
+00088a80: 655f 7072 6563 6973 696f 6e5f 7363 6f72  e_precision_scor
+00088a90: 6528 7472 7574 682c 2070 7265 6469 6374  e(truth, predict
+00088aa0: 696f 6e73 2e61 7267 6d61 7828 6178 6973  ions.argmax(axis
+00088ab0: 3d31 292c 6176 6572 6167 653d 2777 6569  =1),average='wei
+00088ac0: 6768 7465 6427 290d 0a0d 0a64 6566 2067  ghted')....def g
+00088ad0: 696e 695f 7765 6967 6874 6564 5f70 7265  ini_weighted_pre
+00088ae0: 6369 7369 6f6e 2874 7275 7468 2c20 7072  cision(truth, pr
+00088af0: 6564 6963 7469 6f6e 7329 3a0d 0a20 2020  edictions):..   
+00088b00: 2072 6574 7572 6e20 312d 7072 6563 6973   return 1-precis
+00088b10: 696f 6e5f 7363 6f72 6528 7472 7574 682c  ion_score(truth,
+00088b20: 2070 7265 6469 6374 696f 6e73 2e61 7267   predictions.arg
+00088b30: 6d61 7828 6178 6973 3d31 292c 6176 6572  max(axis=1),aver
+00088b40: 6167 653d 2777 6569 6768 7465 6427 290d  age='weighted').
+00088b50: 0a0d 0a64 6566 2067 696e 695f 6d61 6372  ...def gini_macr
+00088b60: 6f5f 7072 6563 6973 696f 6e28 7472 7574  o_precision(trut
+00088b70: 682c 2070 7265 6469 6374 696f 6e73 293a  h, predictions):
+00088b80: 0d0a 2020 2020 7265 7475 726e 2031 2d70  ..    return 1-p
+00088b90: 7265 6369 7369 6f6e 5f73 636f 7265 2874  recision_score(t
+00088ba0: 7275 7468 2c20 7072 6564 6963 7469 6f6e  ruth, prediction
+00088bb0: 732e 6172 676d 6178 2861 7869 733d 3129  s.argmax(axis=1)
+00088bc0: 2c61 7665 7261 6765 3d27 6d61 6372 6f27  ,average='macro'
+00088bd0: 290d 0a0d 0a64 6566 2067 696e 695f 6d69  )....def gini_mi
+00088be0: 6372 6f5f 7072 6563 6973 696f 6e28 7472  cro_precision(tr
+00088bf0: 7574 682c 2070 7265 6469 6374 696f 6e73  uth, predictions
+00088c00: 293a 0d0a 2020 2020 7265 7475 726e 2031  ):..    return 1
+00088c10: 2d70 7265 6369 7369 6f6e 5f73 636f 7265  -precision_score
+00088c20: 2874 7275 7468 2c20 7072 6564 6963 7469  (truth, predicti
+00088c30: 6f6e 732e 6172 676d 6178 2861 7869 733d  ons.argmax(axis=
+00088c40: 3129 2c61 7665 7261 6765 3d27 6d69 6372  1),average='micr
+00088c50: 6f27 290d 0a0d 0a64 6566 2067 696e 695f  o')....def gini_
+00088c60: 7361 6d70 6c65 735f 7072 6563 6973 696f  samples_precisio
+00088c70: 6e28 7472 7574 682c 2070 7265 6469 6374  n(truth, predict
+00088c80: 696f 6e73 293a 0d0a 2020 2020 7265 7475  ions):..    retu
+00088c90: 726e 2031 2d70 7265 6369 7369 6f6e 5f73  rn 1-precision_s
+00088ca0: 636f 7265 2874 7275 7468 2c20 7072 6564  core(truth, pred
+00088cb0: 6963 7469 6f6e 732e 6172 676d 6178 2861  ictions.argmax(a
+00088cc0: 7869 733d 3129 2c61 7665 7261 6765 3d27  xis=1),average='
+00088cd0: 7361 6d70 6c65 7327 290d 0a0d 0a64 6566  samples')....def
+00088ce0: 2067 696e 695f 6631 2874 7275 7468 2c20   gini_f1(truth, 
+00088cf0: 7072 6564 6963 7469 6f6e 7329 3a0d 0a20  predictions):.. 
+00088d00: 2020 2072 6574 7572 6e20 312d 6631 5f73     return 1-f1_s
+00088d10: 636f 7265 2874 7275 7468 2c70 7265 6469  core(truth,predi
+00088d20: 6374 696f 6e73 290d 0a0d 0a64 6566 2067  ctions)....def g
+00088d30: 696e 695f 7765 6967 6874 6564 5f66 3128  ini_weighted_f1(
+00088d40: 7472 7574 682c 2070 7265 6469 6374 696f  truth, predictio
+00088d50: 6e73 293a 0d0a 2020 2020 7265 7475 726e  ns):..    return
+00088d60: 2031 2d66 315f 7363 6f72 6528 7472 7574   1-f1_score(trut
+00088d70: 682c 2070 7265 6469 6374 696f 6e73 2e61  h, predictions.a
+00088d80: 7267 6d61 7828 6178 6973 3d31 292c 6176  rgmax(axis=1),av
+00088d90: 6572 6167 653d 2777 6569 6768 7465 6427  erage='weighted'
+00088da0: 290d 0a0d 0a64 6566 2067 696e 695f 6d61  )....def gini_ma
+00088db0: 6372 6f5f 6631 2874 7275 7468 2c20 7072  cro_f1(truth, pr
+00088dc0: 6564 6963 7469 6f6e 7329 3a0d 0a20 2020  edictions):..   
+00088dd0: 2072 6574 7572 6e20 312d 6631 5f73 636f   return 1-f1_sco
+00088de0: 7265 2874 7275 7468 2c20 7072 6564 6963  re(truth, predic
+00088df0: 7469 6f6e 732e 6172 676d 6178 2861 7869  tions.argmax(axi
+00088e00: 733d 3129 2c61 7665 7261 6765 3d27 6d61  s=1),average='ma
+00088e10: 6372 6f27 290d 0a0d 0a64 6566 2067 696e  cro')....def gin
+00088e20: 695f 6d69 6372 6f5f 6631 2874 7275 7468  i_micro_f1(truth
+00088e30: 2c20 7072 6564 6963 7469 6f6e 7329 3a0d  , predictions):.
+00088e40: 0a20 2020 2072 6574 7572 6e20 312d 6631  .    return 1-f1
+00088e50: 5f73 636f 7265 2874 7275 7468 2c20 7072  _score(truth, pr
+00088e60: 6564 6963 7469 6f6e 732e 6172 676d 6178  edictions.argmax
+00088e70: 2861 7869 733d 3129 2c61 7665 7261 6765  (axis=1),average
+00088e80: 3d27 6d69 6372 6f27 290d 0a0d 0a64 6566  ='micro')....def
+00088e90: 2067 696e 695f 7361 6d70 6c65 735f 6631   gini_samples_f1
+00088ea0: 2874 7275 7468 2c20 7072 6564 6963 7469  (truth, predicti
+00088eb0: 6f6e 7329 3a0d 0a20 2020 2072 6574 7572  ons):..    retur
+00088ec0: 6e20 312d 6631 5f73 636f 7265 2874 7275  n 1-f1_score(tru
+00088ed0: 7468 2c20 7072 6564 6963 7469 6f6e 732e  th, predictions.
+00088ee0: 6172 676d 6178 2861 7869 733d 3129 2c61  argmax(axis=1),a
+00088ef0: 7665 7261 6765 3d27 7361 6d70 6c65 7327  verage='samples'
+00088f00: 290d 0a0d 0a64 6566 2067 696e 695f 6c6f  )....def gini_lo
+00088f10: 675f 6c6f 7373 2874 7275 7468 2c20 7072  g_loss(truth, pr
+00088f20: 6564 6963 7469 6f6e 7329 3a0d 0a20 2020  edictions):..   
+00088f30: 2072 6574 7572 6e20 6c6f 675f 6c6f 7373   return log_loss
+00088f40: 2874 7275 7468 2c20 7072 6564 6963 7469  (truth, predicti
+00088f50: 6f6e 732c 6e6f 726d 616c 697a 653d 5472  ons,normalize=Tr
+00088f60: 7565 290d 0a0d 0a64 6566 2067 696e 695f  ue)....def gini_
+00088f70: 7265 6361 6c6c 2874 7275 7468 2c20 7072  recall(truth, pr
+00088f80: 6564 6963 7469 6f6e 7329 3a0d 0a20 2020  edictions):..   
+00088f90: 2072 6574 7572 6e20 312d 7265 6361 6c6c   return 1-recall
+00088fa0: 5f73 636f 7265 2874 7275 7468 2c20 7072  _score(truth, pr
+00088fb0: 6564 6963 7469 6f6e 7329 0d0a 0d0a 6465  edictions)....de
+00088fc0: 6620 6769 6e69 5f77 6569 6768 7465 645f  f gini_weighted_
+00088fd0: 7265 6361 6c6c 2874 7275 7468 2c20 7072  recall(truth, pr
+00088fe0: 6564 6963 7469 6f6e 7329 3a0d 0a20 2020  edictions):..   
+00088ff0: 2072 6574 7572 6e20 312d 7265 6361 6c6c   return 1-recall
+00089000: 5f73 636f 7265 2874 7275 7468 2c20 7072  _score(truth, pr
+00089010: 6564 6963 7469 6f6e 732e 6172 676d 6178  edictions.argmax
+00089020: 2861 7869 733d 3129 2c61 7665 7261 6765  (axis=1),average
+00089030: 3d27 7765 6967 6874 6564 2729 0d0a 0d0a  ='weighted')....
+00089040: 6465 6620 6769 6e69 5f73 616d 706c 6573  def gini_samples
+00089050: 5f72 6563 616c 6c28 7472 7574 682c 2070  _recall(truth, p
+00089060: 7265 6469 6374 696f 6e73 293a 0d0a 2020  redictions):..  
+00089070: 2020 7265 7475 726e 2031 2d72 6563 616c    return 1-recal
+00089080: 6c5f 7363 6f72 6528 7472 7574 682c 2070  l_score(truth, p
+00089090: 7265 6469 6374 696f 6e73 2e61 7267 6d61  redictions.argma
+000890a0: 7828 6178 6973 3d31 292c 6176 6572 6167  x(axis=1),averag
+000890b0: 653d 2773 616d 706c 6573 2729 0d0a 0d0a  e='samples')....
+000890c0: 6465 6620 6769 6e69 5f6d 6163 726f 5f72  def gini_macro_r
+000890d0: 6563 616c 6c28 7472 7574 682c 2070 7265  ecall(truth, pre
+000890e0: 6469 6374 696f 6e73 293a 0d0a 2020 2020  dictions):..    
+000890f0: 7265 7475 726e 2031 2d72 6563 616c 6c5f  return 1-recall_
+00089100: 7363 6f72 6528 7472 7574 682c 2070 7265  score(truth, pre
+00089110: 6469 6374 696f 6e73 2e61 7267 6d61 7828  dictions.argmax(
+00089120: 6178 6973 3d31 292c 6176 6572 6167 653d  axis=1),average=
+00089130: 276d 6163 726f 2729 0d0a 0d0a 6465 6620  'macro')....def 
+00089140: 6769 6e69 5f6d 6963 726f 5f72 6563 616c  gini_micro_recal
+00089150: 6c28 7472 7574 682c 2070 7265 6469 6374  l(truth, predict
+00089160: 696f 6e73 293a 0d0a 2020 2020 7265 7475  ions):..    retu
+00089170: 726e 2031 2d72 6563 616c 6c5f 7363 6f72  rn 1-recall_scor
+00089180: 6528 7472 7574 682c 2070 7265 6469 6374  e(truth, predict
+00089190: 696f 6e73 2e61 7267 6d61 7828 6178 6973  ions.argmax(axis
+000891a0: 3d31 292c 6176 6572 6167 653d 276d 6963  =1),average='mic
+000891b0: 726f 2729 0d0a 0d0a 6465 6620 6769 6e69  ro')....def gini
+000891c0: 5f72 6f63 5f61 7563 2874 7275 7468 2c20  _roc_auc(truth, 
+000891d0: 7072 6564 6963 7469 6f6e 7329 3a0d 0a20  predictions):.. 
+000891e0: 2020 2072 6574 7572 6e20 312d 726f 635f     return 1-roc_
+000891f0: 6175 635f 7363 6f72 6528 7472 7574 682c  auc_score(truth,
+00089200: 2070 7265 6469 6374 696f 6e73 2e61 7267   predictions.arg
+00089210: 6d61 7828 6178 6973 3d31 292c 6176 6572  max(axis=1),aver
+00089220: 6167 653d 276d 6163 726f 2729 0d0a 2320  age='macro')..# 
+00089230: 6361 6c63 756c 6174 6520 6632 2d6d 6561  calculate f2-mea
+00089240: 7375 7265 0d0a 6465 6620 6632 5f6d 6561  sure..def f2_mea
+00089250: 7375 7265 2879 5f74 7275 652c 2079 5f70  sure(y_true, y_p
+00089260: 7265 6429 3a0d 0a20 2020 2072 6574 7572  red):..    retur
+00089270: 6e20 6662 6574 615f 7363 6f72 6528 795f  n fbeta_score(y_
+00089280: 7472 7565 2c20 795f 7072 6564 2c20 6265  true, y_pred, be
+00089290: 7461 3d32 290d 0a23 2323 206b 6565 7020  ta=2)..### keep 
+000892a0: 616c 6c20 5265 6772 6573 7369 6f6e 2053  all Regression S
+000892b0: 636f 7265 7273 2067 7265 6174 6572 5f69  corers greater_i
+000892c0: 735f 6265 7474 6572 2054 7275 6520 7369  s_better True si
+000892d0: 6e63 6520 6974 206c 6561 7665 7320 7468  nce it leaves th
+000892e0: 656d 2061 7320 6973 2061 6e64 206d 696e  em as is and min
+000892f0: 696d 697a 6573 2074 6865 6d0d 0a6d 6561  imizes them..mea
+00089300: 655f 7363 6f72 6572 203d 206d 616b 655f  e_scorer = make_
+00089310: 7363 6f72 6572 2867 696e 695f 6d65 6165  scorer(gini_meae
+00089320: 2c20 6772 6561 7465 725f 6973 5f62 6574  , greater_is_bet
+00089330: 7465 723d 5472 7565 290d 0a6d 736c 655f  ter=True)..msle_
+00089340: 7363 6f72 6572 203d 206d 616b 655f 7363  scorer = make_sc
+00089350: 6f72 6572 2867 696e 695f 6d73 6c65 2c20  orer(gini_msle, 
+00089360: 6772 6561 7465 725f 6973 5f62 6574 7465  greater_is_bette
+00089370: 723d 5472 7565 290d 0a6d 6165 5f73 636f  r=True)..mae_sco
+00089380: 7265 7220 3d20 6d61 6b65 5f73 636f 7265  rer = make_score
+00089390: 7228 6769 6e69 5f6d 6165 2c20 6772 6561  r(gini_mae, grea
+000893a0: 7465 725f 6973 5f62 6574 7465 723d 5472  ter_is_better=Tr
+000893b0: 7565 290d 0a6d 7365 5f73 636f 7265 7220  ue)..mse_scorer 
+000893c0: 3d20 6d61 6b65 5f73 636f 7265 7228 6769  = make_scorer(gi
+000893d0: 6e69 5f6d 7365 2c20 6772 6561 7465 725f  ni_mse, greater_
+000893e0: 6973 5f62 6574 7465 723d 5472 7565 290d  is_better=True).
+000893f0: 0a0d 0a23 2323 206b 6565 7020 616c 6c20  ...### keep all 
+00089400: 436c 6173 7369 6669 6361 7469 6f6e 2053  Classification S
+00089410: 636f 7265 7273 2067 7265 6174 6572 5f69  corers greater_i
+00089420: 735f 6265 7474 6572 2054 7275 6520 6275  s_better True bu
+00089430: 7420 7375 6274 7261 6374 2073 636f 7265  t subtract score
+00089440: 7220 6672 6f6d 2031 2073 6f20 6974 2064  r from 1 so it d
+00089450: 696d 696e 6973 6865 732e 0d0a 2323 2323  iminishes...####
+00089460: 2054 6869 7320 6973 2074 6865 206f 6e6c   This is the onl
+00089470: 7920 7761 7920 4879 7065 724f 7074 2077  y way HyperOpt w
+00089480: 696c 6c20 6669 6e64 2074 6865 206d 696e  ill find the min
+00089490: 696d 756d 202d 2073 6f20 646f 6e27 7420  imum - so don't 
+000894a0: 6368 616e 6765 2074 6869 7320 636f 6465  change this code
+000894b0: 2061 6e79 7469 6d65 210d 0a61 6363 7572   anytime!..accur
+000894c0: 6163 795f 7363 6f72 6572 203d 206d 616b  acy_scorer = mak
+000894d0: 655f 7363 6f72 6572 2867 696e 695f 6163  e_scorer(gini_ac
+000894e0: 6375 7261 6379 2c20 6772 6561 7465 725f  curacy, greater_
+000894f0: 6973 5f62 6574 7465 723d 5472 7565 2c20  is_better=True, 
+00089500: 6e65 6564 735f 7072 6f62 613d 4661 6c73  needs_proba=Fals
+00089510: 6529 0d0a 6261 6c5f 6163 6375 7261 6379  e)..bal_accuracy
+00089520: 5f73 636f 7265 7220 3d20 6d61 6b65 5f73  _scorer = make_s
+00089530: 636f 7265 7228 6769 6e69 5f62 616c 5f61  corer(gini_bal_a
+00089540: 6363 7572 6163 792c 2067 7265 6174 6572  ccuracy, greater
+00089550: 5f69 735f 6265 7474 6572 3d54 7275 652c  _is_better=True,
+00089560: 206e 6565 6473 5f70 726f 6261 3d46 616c   needs_proba=Fal
+00089570: 7365 290d 0a0d 0a67 696e 695f 7363 6f72  se)....gini_scor
+00089580: 6572 203d 206d 616b 655f 7363 6f72 6572  er = make_scorer
+00089590: 2867 696e 695f 736b 6c65 6172 6e2c 2067  (gini_sklearn, g
+000895a0: 7265 6174 6572 5f69 735f 6265 7474 6572  reater_is_better
+000895b0: 3d54 7275 652c 206e 6565 6473 5f70 726f  =True, needs_pro
+000895c0: 6261 3d54 7275 6529 0d0a 726f 635f 7363  ba=True)..roc_sc
+000895d0: 6f72 6572 203d 206d 616b 655f 7363 6f72  orer = make_scor
+000895e0: 6572 2867 696e 695f 726f 632c 2067 7265  er(gini_roc, gre
+000895f0: 6174 6572 5f69 735f 6265 7474 6572 3d54  ater_is_better=T
+00089600: 7275 652c 206e 6565 6473 5f70 726f 6261  rue, needs_proba
+00089610: 3d54 7275 6529 0d0a 0d0a 7072 6563 6973  =True)....precis
+00089620: 696f 6e5f 7363 6f72 6572 203d 206d 616b  ion_scorer = mak
+00089630: 655f 7363 6f72 6572 2867 696e 695f 7072  e_scorer(gini_pr
+00089640: 6563 6973 696f 6e2c 2067 7265 6174 6572  ecision, greater
+00089650: 5f69 735f 6265 7474 6572 3d54 7275 652c  _is_better=True,
+00089660: 206e 6565 6473 5f70 726f 6261 3d46 616c   needs_proba=Fal
+00089670: 7365 290d 0a61 7665 7261 6765 5f70 7265  se)..average_pre
+00089680: 6369 7369 6f6e 5f73 636f 7265 7220 3d20  cision_scorer = 
+00089690: 6d61 6b65 5f73 636f 7265 7228 6769 6e69  make_scorer(gini
+000896a0: 5f61 7665 7261 6765 5f70 7265 6369 7369  _average_precisi
+000896b0: 6f6e 2c20 6772 6561 7465 725f 6973 5f62  on, greater_is_b
+000896c0: 6574 7465 723d 5472 7565 2c20 6e65 6564  etter=True, need
+000896d0: 735f 7072 6f62 613d 5472 7565 290d 0a77  s_proba=True)..w
+000896e0: 6569 6768 7465 645f 7072 6563 6973 696f  eighted_precisio
+000896f0: 6e5f 7363 6f72 6572 203d 206d 616b 655f  n_scorer = make_
+00089700: 7363 6f72 6572 2867 696e 695f 7765 6967  scorer(gini_weig
+00089710: 6874 6564 5f70 7265 6369 7369 6f6e 2c20  hted_precision, 
+00089720: 6772 6561 7465 725f 6973 5f62 6574 7465  greater_is_bette
+00089730: 723d 5472 7565 2c20 6e65 6564 735f 7072  r=True, needs_pr
+00089740: 6f62 613d 5472 7565 290d 0a6d 6163 726f  oba=True)..macro
+00089750: 5f70 7265 6369 7369 6f6e 5f73 636f 7265  _precision_score
+00089760: 7220 3d20 6d61 6b65 5f73 636f 7265 7228  r = make_scorer(
+00089770: 6769 6e69 5f6d 6163 726f 5f70 7265 6369  gini_macro_preci
+00089780: 7369 6f6e 2c20 6772 6561 7465 725f 6973  sion, greater_is
+00089790: 5f62 6574 7465 723d 5472 7565 2c20 6e65  _better=True, ne
+000897a0: 6564 735f 7072 6f62 613d 5472 7565 290d  eds_proba=True).
+000897b0: 0a6d 6963 726f 5f70 7265 6369 7369 6f6e  .micro_precision
+000897c0: 5f73 636f 7265 7220 3d20 6d61 6b65 5f73  _scorer = make_s
+000897d0: 636f 7265 7228 6769 6e69 5f6d 6963 726f  corer(gini_micro
+000897e0: 5f70 7265 6369 7369 6f6e 2c20 6772 6561  _precision, grea
+000897f0: 7465 725f 6973 5f62 6574 7465 723d 5472  ter_is_better=Tr
+00089800: 7565 2c20 6e65 6564 735f 7072 6f62 613d  ue, needs_proba=
+00089810: 5472 7565 290d 0a73 616d 706c 6573 5f70  True)..samples_p
+00089820: 7265 6369 7369 6f6e 5f73 636f 7265 7220  recision_scorer 
+00089830: 3d20 6d61 6b65 5f73 636f 7265 7228 6769  = make_scorer(gi
+00089840: 6e69 5f73 616d 706c 6573 5f70 7265 6369  ni_samples_preci
+00089850: 7369 6f6e 2c20 6772 6561 7465 725f 6973  sion, greater_is
+00089860: 5f62 6574 7465 723d 5472 7565 2c20 6e65  _better=True, ne
+00089870: 6564 735f 7072 6f62 613d 5472 7565 290d  eds_proba=True).
+00089880: 0a0d 0a66 315f 7363 6f72 6572 203d 206d  ...f1_scorer = m
+00089890: 616b 655f 7363 6f72 6572 2867 696e 695f  ake_scorer(gini_
+000898a0: 6631 2c20 6772 6561 7465 725f 6973 5f62  f1, greater_is_b
+000898b0: 6574 7465 723d 5472 7565 2c20 6e65 6564  etter=True, need
+000898c0: 735f 7072 6f62 613d 4661 6c73 6529 0d0a  s_proba=False)..
+000898d0: 7765 6967 6874 6564 5f66 315f 7363 6f72  weighted_f1_scor
+000898e0: 6572 203d 206d 616b 655f 7363 6f72 6572  er = make_scorer
+000898f0: 2867 696e 695f 7765 6967 6874 6564 5f66  (gini_weighted_f
+00089900: 312c 2067 7265 6174 6572 5f69 735f 6265  1, greater_is_be
+00089910: 7474 6572 3d54 7275 652c 206e 6565 6473  tter=True, needs
+00089920: 5f70 726f 6261 3d54 7275 6529 0d0a 6d61  _proba=True)..ma
+00089930: 6372 6f5f 6631 5f73 636f 7265 7220 3d20  cro_f1_scorer = 
+00089940: 6d61 6b65 5f73 636f 7265 7228 6769 6e69  make_scorer(gini
+00089950: 5f6d 6163 726f 5f66 312c 2067 7265 6174  _macro_f1, great
+00089960: 6572 5f69 735f 6265 7474 6572 3d54 7275  er_is_better=Tru
+00089970: 652c 206e 6565 6473 5f70 726f 6261 3d54  e, needs_proba=T
+00089980: 7275 6529 0d0a 6d69 6372 6f5f 6631 5f73  rue)..micro_f1_s
+00089990: 636f 7265 7220 3d20 6d61 6b65 5f73 636f  corer = make_sco
+000899a0: 7265 7228 6769 6e69 5f6d 6963 726f 5f66  rer(gini_micro_f
+000899b0: 312c 2067 7265 6174 6572 5f69 735f 6265  1, greater_is_be
+000899c0: 7474 6572 3d54 7275 652c 206e 6565 6473  tter=True, needs
+000899d0: 5f70 726f 6261 3d54 7275 6529 0d0a 7361  _proba=True)..sa
+000899e0: 6d70 6c65 735f 6631 5f73 636f 7265 7220  mples_f1_scorer 
+000899f0: 3d20 6d61 6b65 5f73 636f 7265 7228 6769  = make_scorer(gi
+00089a00: 6e69 5f73 616d 706c 6573 5f66 312c 2067  ni_samples_f1, g
+00089a10: 7265 6174 6572 5f69 735f 6265 7474 6572  reater_is_better
+00089a20: 3d54 7275 652c 206e 6565 6473 5f70 726f  =True, needs_pro
+00089a30: 6261 3d54 7275 6529 0d0a 0d0a 7265 6361  ba=True)....reca
+00089a40: 6c6c 5f73 636f 7265 7220 3d20 6d61 6b65  ll_scorer = make
+00089a50: 5f73 636f 7265 7228 6769 6e69 5f72 6563  _scorer(gini_rec
+00089a60: 616c 6c2c 2067 7265 6174 6572 5f69 735f  all, greater_is_
+00089a70: 6265 7474 6572 3d54 7275 652c 206e 6565  better=True, nee
+00089a80: 6473 5f70 726f 6261 3d46 616c 7365 290d  ds_proba=False).
+00089a90: 0a77 6569 6768 7465 645f 7265 6361 6c6c  .weighted_recall
+00089aa0: 5f73 636f 7265 7220 3d20 6d61 6b65 5f73  _scorer = make_s
+00089ab0: 636f 7265 7228 6769 6e69 5f77 6569 6768  corer(gini_weigh
+00089ac0: 7465 645f 7265 6361 6c6c 2c20 6772 6561  ted_recall, grea
+00089ad0: 7465 725f 6973 5f62 6574 7465 723d 5472  ter_is_better=Tr
+00089ae0: 7565 2c20 6e65 6564 735f 7072 6f62 613d  ue, needs_proba=
+00089af0: 5472 7565 290d 0a6d 6163 726f 5f72 6563  True)..macro_rec
+00089b00: 616c 6c5f 7363 6f72 6572 203d 206d 616b  all_scorer = mak
+00089b10: 655f 7363 6f72 6572 2867 696e 695f 6d61  e_scorer(gini_ma
+00089b20: 6372 6f5f 7265 6361 6c6c 2c20 6772 6561  cro_recall, grea
+00089b30: 7465 725f 6973 5f62 6574 7465 723d 5472  ter_is_better=Tr
+00089b40: 7565 2c20 6e65 6564 735f 7072 6f62 613d  ue, needs_proba=
+00089b50: 5472 7565 290d 0a6d 6963 726f 5f72 6563  True)..micro_rec
+00089b60: 616c 6c5f 7363 6f72 6572 203d 206d 616b  all_scorer = mak
+00089b70: 655f 7363 6f72 6572 2867 696e 695f 6d69  e_scorer(gini_mi
+00089b80: 6372 6f5f 7265 6361 6c6c 2c20 6772 6561  cro_recall, grea
+00089b90: 7465 725f 6973 5f62 6574 7465 723d 5472  ter_is_better=Tr
+00089ba0: 7565 2c20 6e65 6564 735f 7072 6f62 613d  ue, needs_proba=
+00089bb0: 5472 7565 290d 0a73 616d 706c 6573 5f72  True)..samples_r
+00089bc0: 6563 616c 6c5f 7363 6f72 6572 203d 206d  ecall_scorer = m
+00089bd0: 616b 655f 7363 6f72 6572 2867 696e 695f  ake_scorer(gini_
+00089be0: 7361 6d70 6c65 735f 7265 6361 6c6c 2c20  samples_recall, 
+00089bf0: 6772 6561 7465 725f 6973 5f62 6574 7465  greater_is_bette
+00089c00: 723d 5472 7565 2c20 6e65 6564 735f 7072  r=True, needs_pr
+00089c10: 6f62 613d 5472 7565 290d 0a0d 0a72 6f63  oba=True)....roc
+00089c20: 5f61 7563 5f73 636f 7265 7220 3d20 6d61  _auc_scorer = ma
+00089c30: 6b65 5f73 636f 7265 7228 6769 6e69 5f72  ke_scorer(gini_r
+00089c40: 6f63 5f61 7563 2c20 6772 6561 7465 725f  oc_auc, greater_
+00089c50: 6973 5f62 6574 7465 723d 5472 7565 2c20  is_better=True, 
+00089c60: 6e65 6564 735f 7072 6f62 613d 5472 7565  needs_proba=True
+00089c70: 290d 0a23 2323 204c 6561 7665 2074 6865  )..### Leave the
+00089c80: 206c 6f67 2d6c 6f73 7320 7363 6f72 6572   log-loss scorer
+00089c90: 2061 7320 6772 6561 7465 725f 6973 5f62   as greater_is_b
+00089ca0: 6574 7465 7220 5472 7565 2073 696e 6365  etter True since
+00089cb0: 2069 7420 6b65 6570 7320 7369 676e 2061   it keeps sign a
+00089cc0: 6e64 206d 696e 696d 697a 6573 2069 742e  nd minimizes it.
+00089cd0: 0d0a 6c6f 676c 6f73 735f 7363 6f72 6572  ..logloss_scorer
+00089ce0: 203d 206d 616b 655f 7363 6f72 6572 2867   = make_scorer(g
+00089cf0: 696e 695f 6c6f 675f 6c6f 7373 2c20 6772  ini_log_loss, gr
+00089d00: 6561 7465 725f 6973 5f62 6574 7465 723d  eater_is_better=
+00089d10: 5472 7565 2c20 6e65 6564 735f 7072 6f62  True, needs_prob
+00089d20: 613d 5472 7565 290d 0a23 2323 2323 2323  a=True)..#######
+00089d30: 2323 2323 2323 2323 2323 2323 2323 2323  ################
+00089d40: 2323 2323 2323 2323 2323 2323 2323 2323  ################
+00089d50: 2323 2323 2323 2323 2323 2323 2323 2323  ################
+00089d60: 2323 2323 2323 2323 2323 2323 2323 2323  ################
+00089d70: 2323 2323 2323 2323 2323 2323 2323 2323  ################
+00089d80: 2323 230d 0a00 0000 0000 0000 0000 0000  ###.............
+00089d90: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+00089da0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+00089db0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+00089dc0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+00089dd0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+00089de0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+00089df0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+00089e00: 2e2f 2e2f 4050 6178 4865 6164 6572 0000  ././@PaxHeader..
+00089e10: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+00089e20: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+00089e30: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+00089e40: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+00089e50: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+00089e60: 0000 0000 3030 3030 3030 3000 3030 3030  ....0000000.0000
+00089e70: 3030 3000 3030 3030 3030 3000 3030 3030  000.0000000.0000
+00089e80: 3030 3030 3032 3600 3030 3030 3030 3030  0000026.00000000
+00089e90: 3030 3000 3031 3134 3533 0020 7800 0000  000.011453. x...
+00089ea0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+00089eb0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+00089ec0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+00089ed0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+00089ee0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+00089ef0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+00089f00: 0075 7374 6172 0030 3000 0000 0000 0000  .ustar.00.......
+00089f10: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+00089f20: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+00089f30: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+00089f40: 0000 0000 0000 0000 0030 3030 3030 3030  .........0000000
+00089f50: 0030 3030 3030 3030 0000 0000 0000 0000  .0000000........
+00089f60: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+00089f70: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+00089f80: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+00089f90: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+00089fa0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+00089fb0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+00089fc0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+00089fd0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+00089fe0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+00089ff0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+0008a000: 3232 206d 7469 6d65 3d31 3637 3831 3539  22 mtime=1678159
+0008a010: 3732 322e 300a 0000 0000 0000 0000 0000  722.0...........
+0008a020: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+0008a030: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+0008a040: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+0008a050: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+0008a060: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+0008a070: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+0008a080: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+0008a090: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+0008a0a0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+0008a0b0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+0008a0c0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+0008a0d0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+0008a0e0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+0008a0f0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+0008a100: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+0008a110: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+0008a120: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+0008a130: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+0008a140: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+0008a150: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+0008a160: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+0008a170: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+0008a180: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+0008a190: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+0008a1a0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+0008a1b0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+0008a1c0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+0008a1d0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+0008a1e0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+0008a1f0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+0008a200: 6175 746f 7669 6d6c 2d30 2e31 2e37 3135  autoviml-0.1.715
+0008a210: 2f61 7574 6f76 696d 6c2f 6665 6174 7572  /autoviml/featur
+0008a220: 655f 656e 6769 6e65 6572 696e 672e 7079  e_engineering.py
+0008a230: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+0008a240: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+0008a250: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+0008a260: 0000 0000 3030 3030 3737 3700 3030 3031  ....0000777.0001
+0008a270: 3735 3000 3030 3031 3735 3000 3030 3030  750.0001750.0000
+0008a280: 3030 3433 3237 3000 3030 3030 3030 3030  0043270.00000000
+0008a290: 3030 3000 3032 3133 3432 0020 3000 0000  000.021342. 0...
+0008a2a0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+0008a2b0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+0008a2c0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+0008a2d0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+0008a2e0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+0008a2f0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+0008a300: 0075 7374 6172 0030 3072 616d 0000 0000  .ustar.00ram....
+0008a310: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+0008a320: 0000 0000 0000 0000 0072 616d 0000 0000  .........ram....
+0008a330: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+0008a340: 0000 0000 0000 0000 0030 3030 3030 3030  .........0000000
+0008a350: 0030 3030 3030 3030 0000 0000 0000 0000  .0000000........
+0008a360: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+0008a370: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+0008a380: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+0008a390: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+0008a3a0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+0008a3b0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+0008a3c0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+0008a3d0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+0008a3e0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+0008a3f0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+0008a400: 696d 706f 7274 2070 616e 6461 7320 6173  import pandas as
+0008a410: 2070 640d 0a69 6d70 6f72 7420 6e75 6d70   pd..import nump
+0008a420: 7920 6173 206e 700d 0a23 2323 2323 2323  y as np..#######
+0008a430: 2323 204e 4557 2041 6e64 2046 4153 5420  ## NEW And FAST 
+0008a440: 5741 5920 746f 2041 4444 2046 6561 7475  WAY to ADD Featu
+0008a450: 7265 2045 6e67 6720 434f 4c55 4d4e 5320  re Engg COLUMNS 
+0008a460: 494e 2041 2044 4154 4120 5345 5420 2323  IN A DATA SET ##
+0008a470: 2323 2323 230d 0a23 2323 2020 204d 6f64  #####..###   Mod
+0008a480: 6966 7920 4461 7461 6672 616d 6520 6279  ify Dataframe by
+0008a490: 2061 6464 696e 6720 4665 6174 7572 6573   adding Features
+0008a4a0: 2075 7369 6e67 2046 6561 7475 7265 2054   using Feature T
+0008a4b0: 6f6f 6c73 2023 2323 230d 0a64 6566 2061  ools ####..def a
+0008a4c0: 6464 5f63 6f6d 7075 7461 7469 6f6e 616c  dd_computational
+0008a4d0: 5f70 7269 6d69 7469 7665 5f66 6561 7475  _primitive_featu
+0008a4e0: 7265 7328 2064 662c 2061 6464 5f74 7970  res( df, add_typ
+0008a4f0: 6573 3d5b 5d2c 2069 6463 6f6c 756d 6e3d  es=[], idcolumn=
+0008a500: 2727 293a 0d0a 2020 2020 2222 220d 0a20  ''):..    """.. 
+0008a510: 2020 2023 2323 2020 204d 6f64 6966 7920     ###   Modify 
+0008a520: 4461 7461 6672 616d 6520 6279 2061 6464  Dataframe by add
+0008a530: 696e 6720 636f 6d70 7574 6174 696f 6e61  ing computationa
+0008a540: 6c20 7072 696d 6974 6976 6520 4665 6174  l primitive Feat
+0008a550: 7572 6573 2075 7369 6e67 2046 6561 7475  ures using Featu
+0008a560: 7265 2054 6f6f 6c73 2023 2323 230d 0a20  re Tools ####.. 
+0008a570: 2020 2023 2323 2020 2057 6861 7420 6172     ###   What ar
+0008a580: 6520 636f 6d70 7574 6174 696f 6e61 6c20  e computational 
+0008a590: 7072 696d 6974 6976 6573 3f20 7468 6579  primitives? they
+0008a5a0: 2061 7265 2074 6f20 6164 642c 2073 7562   are to add, sub
+0008a5b0: 7472 6163 742c 206d 756c 7469 706c 7920  tract, multiply 
+0008a5c0: 616e 6420 6469 7669 6465 2066 6561 7475  and divide featu
+0008a5d0: 7265 730d 0a20 2020 2023 2323 2049 6e70  res..    ### Inp
+0008a5e0: 7574 733a 0d0a 2020 2020 2323 2320 2020  uts:..    ###   
+0008a5f0: 6466 3a20 4a75 7374 2073 656e 7420 696e  df: Just sent in
+0008a600: 2074 6865 2064 6174 6120 6672 616d 6520   the data frame 
+0008a610: 6466 2074 6861 7420 796f 7520 7761 6e74  df that you want
+0008a620: 2066 6561 7475 7265 7320 6164 6465 6420   features added 
+0008a630: 746f 0d0a 2020 2020 2323 2320 2020 6164  to..    ###   ad
+0008a640: 645f 7479 7065 733a 206c 6973 7420 6f66  d_types: list of
+0008a650: 2063 6f6d 7075 7461 7469 6f6e 616c 2074   computational t
+0008a660: 7970 6573 3a20 2761 6464 272c 2027 7375  ypes: 'add', 'su
+0008a670: 6274 7261 6374 272c 2027 6d75 6c74 6970  btract', 'multip
+0008a680: 6c79 2720 616e 6420 2764 6976 6964 6527  ly' and 'divide'
+0008a690: 2e20 4368 6f6f 7365 2061 6e79 206f 7220  . Choose any or 
+0008a6a0: 616c 6c2e 0d0a 2020 2020 2323 2320 2020  all...    ###   
+0008a6b0: 6964 636f 6c75 6d6e 3a20 7468 6973 2069  idcolumn: this i
+0008a6c0: 7320 746f 2063 7265 6174 6520 616e 2069  s to create an i
+0008a6d0: 6e64 6578 2066 6f72 2074 6865 2064 6174  ndex for the dat
+0008a6e0: 6166 7261 6d65 2073 696e 6365 2046 5420  aframe since FT 
+0008a6f0: 7275 6e73 206f 6e20 696e 6465 7820 7661  runs on index va
+0008a700: 7269 6162 6c65 2e20 596f 7520 6361 6e20  riable. You can 
+0008a710: 6c65 6176 6520 6974 2065 6d70 7479 2073  leave it empty s
+0008a720: 7472 696e 672e 0d0a 2020 2020 2222 220d  tring...    """.
+0008a730: 0a20 2020 2074 7279 3a0d 0a20 2020 2020  .    try:..     
+0008a740: 2020 2069 6d70 6f72 7420 6665 6174 7572     import featur
+0008a750: 6574 6f6f 6c73 2061 7320 6674 0d0a 2020  etools as ft..  
+0008a760: 2020 6578 6365 7074 3a0d 0a20 2020 2020    except:..     
+0008a770: 2020 2070 7269 6e74 2827 596f 7520 6d75     print('You mu
+0008a780: 7374 2069 6e73 7461 6c6c 2066 6561 7475  st install featu
+0008a790: 7265 746f 6f6c 7320 746f 2075 7365 2066  retools to use f
+0008a7a0: 6561 7475 7265 5f65 6e67 696e 6565 7269  eature_engineeri
+0008a7b0: 6e67 2066 756e 6374 696f 6e73 2e20 496e  ng functions. In
+0008a7c0: 7374 616c 6c20 6974 2061 6e64 2074 7279  stall it and try
+0008a7d0: 2061 6761 696e 2e27 290d 0a20 2020 2064   again.')..    d
+0008a7e0: 6620 3d20 636f 7079 2e64 6565 7063 6f70  f = copy.deepcop
+0008a7f0: 7928 6466 290d 0a20 2020 2070 726f 6a65  y(df)..    proje
+0008a800: 6374 6964 203d 2027 7072 6f6a 6563 745f  ctid = 'project_
+0008a810: 7072 6564 6963 7469 6f6e 270d 0a20 2020  prediction'..   
+0008a820: 2064 6174 6169 6420 3d20 2770 726f 6a65   dataid = 'proje
+0008a830: 6374 5f64 6174 6127 0d0a 2020 2020 6966  ct_data'..    if
+0008a840: 2069 6463 6f6c 756d 6e20 3d3d 2027 273a   idcolumn == '':
+0008a850: 0d0a 2020 2020 2020 2020 696e 6465 7869  ..        indexi
+0008a860: 6420 3d20 2769 6e64 6578 270d 0a20 2020  d = 'index'..   
+0008a870: 2020 2020 206d 616b 655f 696e 6465 7820       make_index 
+0008a880: 3d20 5472 7565 0d0a 2020 2020 656c 7365  = True..    else
+0008a890: 3a0d 0a20 2020 2020 2020 2069 6e64 6578  :..        index
+0008a8a0: 6964 203d 2069 6463 6f6c 756d 6e0d 0a20  id = idcolumn.. 
+0008a8b0: 2020 2020 2020 206d 616b 655f 696e 6465         make_inde
+0008a8c0: 783d 4661 6c73 650d 0a20 2020 2023 204d  x=False..    # M
+0008a8d0: 616b 6520 616e 2065 6e74 6974 7973 6574  ake an entityset
+0008a8e0: 2061 6e64 2061 6464 2074 6865 2065 6e74   and add the ent
+0008a8f0: 6974 790d 0a20 2020 2065 7320 3d20 6674  ity..    es = ft
+0008a900: 2e45 6e74 6974 7953 6574 2869 6420 3d20  .EntitySet(id = 
+0008a910: 7072 6f6a 6563 7469 6429 0d0a 2020 2020  projectid)..    
+0008a920: 6573 2e65 6e74 6974 795f 6672 6f6d 5f64  es.entity_from_d
+0008a930: 6174 6166 7261 6d65 2865 6e74 6974 795f  ataframe(entity_
+0008a940: 6964 203d 2064 6174 6169 642c 2064 6174  id = dataid, dat
+0008a950: 6166 7261 6d65 203d 2064 662c 0d0a 2020  aframe = df,..  
+0008a960: 2020 2020 2020 2020 2020 2020 2020 2020                  
+0008a970: 2020 2020 2020 2020 2020 206d 616b 655f             make_
+0008a980: 696e 6465 7820 3d20 6d61 6b65 5f69 6e64  index = make_ind
+0008a990: 6578 2c20 696e 6465 7820 3d20 696e 6465  ex, index = inde
+0008a9a0: 7869 6429 0d0a 0d0a 2020 2020 2320 5275  xid)....    # Ru
+0008a9b0: 6e20 6465 6570 2066 6561 7475 7265 2073  n deep feature s
+0008a9c0: 796e 7468 6573 6973 2077 6974 6820 6769  ynthesis with gi
+0008a9d0: 7665 6e20 696e 7075 7420 7072 696d 6974  ven input primit
+0008a9e0: 6976 6573 206f 7220 6175 746f 6d61 7469  ives or automati
+0008a9f0: 6361 6c6c 7920 6465 6570 2032 0d0a 2020  cally deep 2..  
+0008aa00: 2020 6966 206c 656e 2861 6464 5f74 7970    if len(add_typ
+0008aa10: 6573 2920 3e20 303a 0d0a 2020 2020 2020  es) > 0:..      
+0008aa20: 2020 2323 2320 4275 696c 6420 4665 6174    ### Build Feat
+0008aa30: 7572 6573 2062 6173 6564 206f 6e20 6769  ures based on gi
+0008aa40: 7665 6e20 7072 696d 6974 6976 6520 7479  ven primitive ty
+0008aa50: 7065 732c 2061 6464 5f74 7970 6573 2077  pes, add_types w
+0008aa60: 6869 6368 2069 7320 6120 6c69 7374 0d0a  hich is a list..
+0008aa70: 2020 2020 2020 2020 6466 5f6d 6f64 2c20          df_mod, 
+0008aa80: 6665 6174 7572 655f 6465 6673 203d 2066  feature_defs = f
+0008aa90: 742e 6466 7328 656e 7469 7479 7365 7420  t.dfs(entityset 
+0008aaa0: 3d20 6573 2c20 7461 7267 6574 5f65 6e74  = es, target_ent
+0008aab0: 6974 7920 3d20 6461 7461 6964 2c0d 0a20  ity = dataid,.. 
+0008aac0: 2020 2020 2020 2020 2020 2020 2020 2020                  
+0008aad0: 2020 2020 2020 2020 2020 2020 7472 616e              tran
+0008aae0: 735f 7072 696d 6974 6976 6573 203d 2061  s_primitives = a
+0008aaf0: 6464 5f74 7970 6573 290d 0a20 2020 2065  dd_types)..    e
+0008ab00: 6c73 653a 0d0a 2020 2020 2020 2020 2323  lse:..        ##
+0008ab10: 2320 5065 7266 6f72 6d20 4465 6570 2046  # Perform Deep F
+0008ab20: 6561 7475 7265 2053 796e 7468 6573 6973  eature Synthesis
+0008ab30: 2041 7574 6f6d 6174 6963 616c 6c79 2066   Automatically f
+0008ab40: 6f72 2044 6570 7468 2032 0d0a 2020 2020  or Depth 2..    
+0008ab50: 2020 2020 6466 5f6d 6f64 2c20 6665 6174      df_mod, feat
+0008ab60: 7572 655f 6465 6673 203d 2066 742e 6466  ure_defs = ft.df
+0008ab70: 7328 656e 7469 7479 7365 743d 6573 2c20  s(entityset=es, 
+0008ab80: 7461 7267 6574 5f65 6e74 6974 7920 3d20  target_entity = 
+0008ab90: 6461 7461 6964 2c0d 0a20 2020 2020 2020  dataid,..       
+0008aba0: 2020 2020 2020 2020 2020 2020 2020 2020                  
+0008abb0: 2020 2020 2020 206d 6178 5f64 6570 7468         max_depth
+0008abc0: 203d 2032 2c20 6e5f 6a6f 6273 3d2d 312c   = 2, n_jobs=-1,
+0008abd0: 0d0a 2020 2020 2020 2020 2020 2020 2020  ..              
+0008abe0: 2020 2020 2020 2020 2020 2020 2020 2020                  
+0008abf0: 7665 7262 6f73 6520 3d20 3029 0d0a 2020  verbose = 0)..  
+0008ac00: 2020 6966 206d 616b 655f 696e 6465 783a    if make_index:
+0008ac10: 0d0a 2020 2020 2020 2020 6466 5f6d 6f64  ..        df_mod
+0008ac20: 203d 2064 665f 6d6f 642e 7265 7365 745f   = df_mod.reset_
+0008ac30: 696e 6465 7828 6472 6f70 3d54 7275 6529  index(drop=True)
+0008ac40: 0d0a 2020 2020 7265 7475 726e 2064 665f  ..    return df_
+0008ac50: 6d6f 640d 0a0d 0a64 6566 2066 6561 7475  mod....def featu
+0008ac60: 7265 5f65 6e67 696e 6565 7269 6e67 2864  re_engineering(d
+0008ac70: 662c 2066 745f 7265 7175 6573 7473 2c20  f, ft_requests, 
+0008ac80: 6964 636f 6c29 3a0d 0a20 2020 2022 2222  idcol):..    """
+0008ac90: 0d0a 2020 2020 5468 6520 4665 6174 7572  ..    The Featur
+0008aca0: 6520 456e 6769 6e65 6572 696e 6720 6d6f  e Engineering mo
+0008acb0: 6475 6c65 206e 6565 6473 2046 6561 7475  dule needs Featu
+0008acc0: 7265 546f 6f6c 7320 696e 7374 616c 6c65  reTools installe
+0008acd0: 6420 746f 2077 6f72 6b2e 0d0a 2020 2020  d to work...    
+0008ace0: 536f 2070 6c65 6173 6520 646f 2022 7069  So please do "pi
+0008acf0: 7020 696e 7374 616c 6c20 6665 6174 7572  p install featur
+0008ad00: 6574 6f6f 6c73 2220 6265 666f 7265 2074  etools" before t
+0008ad10: 7279 696e 6720 6f75 7420 7468 6973 206d  rying out this m
+0008ad20: 6f64 756c 652e 0d0a 2020 2020 4974 2074  odule...    It t
+0008ad30: 616b 6573 2061 2067 6976 656e 2064 6174  akes a given dat
+0008ad40: 6120 7365 742c 2064 6620 616e 6420 6164  a set, df and ad
+0008ad50: 6473 2066 6561 7475 7265 7320 6261 7365  ds features base
+0008ad60: 6420 6f6e 2074 6865 2072 6571 7565 7420  d on the requet 
+0008ad70: 7479 7065 7320 696e 0d0a 2020 2020 6674  types in..    ft
+0008ad80: 5f72 6571 7565 7374 7320 7768 6963 6820  _requests which 
+0008ad90: 6361 6e20 6265 2027 6164 6427 2c27 7375  can be 'add','su
+0008ada0: 6274 7261 6374 272c 276d 756c 7469 706c  btract','multipl
+0008adb0: 7927 2c27 6469 7669 6465 272e 2049 6620  y','divide'. If 
+0008adc0: 796f 7520 6861 7665 0d0a 2020 2020 616e  you have..    an
+0008add0: 2069 645f 636f 6c75 6d6e 2069 6e20 7468   id_column in th
+0008ade0: 6520 6461 7461 2073 6574 2c20 796f 7520  e data set, you 
+0008adf0: 6361 6e20 7072 6f76 6964 6520 6974 2061  can provide it a
+0008ae00: 7320 6964 636f 6c20 2861 2073 7472 696e  s idcol (a strin
+0008ae10: 6720 7661 7269 6162 6c65 292e 0d0a 2020  g variable)...  
+0008ae20: 2020 4974 2077 696c 6c20 7265 7475 726e    It will return
+0008ae30: 2079 6f75 7220 6d6f 6469 6669 6564 2064   your modified d
+0008ae40: 6174 6173 6574 2077 6974 6820 2769 6463  ataset with 'idc
+0008ae50: 6f6c 2720 6173 2074 6865 2069 6e64 6578  ol' as the index
+0008ae60: 2e20 4d61 6b65 2073 7572 650d 0a20 2020  . Make sure..   
+0008ae70: 2079 6f75 2072 6573 6574 2074 6865 2069   you reset the i
+0008ae80: 6e64 6578 2069 6620 796f 7520 7761 6e74  ndex if you want
+0008ae90: 2074 6f20 7265 7475 726e 2069 7420 746f   to return it to
+0008aea0: 2069 7473 2066 6f72 6d65 7220 7374 6174   its former stat
+0008aeb0: 652e 0d0a 2020 2020 416c 736f 2064 6f20  e...    Also do 
+0008aec0: 6e6f 7420 7365 6e64 2069 6e20 796f 7572  not send in your
+0008aed0: 2065 6e74 6972 6520 6461 7461 6672 616d   entire datafram
+0008aee0: 6521 204a 7573 7420 7365 6e64 2061 2073  e! Just send a s
+0008aef0: 6d61 6c6c 2064 6174 6166 7261 6d65 2077  mall dataframe w
+0008af00: 6974 6820 6120 6665 7720 7661 7269 6162  ith a few variab
+0008af10: 6c65 732e 0d0a 2020 2020 4f6e 6365 2079  les...    Once y
+0008af20: 6f75 2073 6565 2068 6f77 2069 7420 6164  ou see how it ad
+0008af30: 6473 2074 6f20 7065 7266 6f72 6d61 6e63  ds to performanc
+0008af40: 6520 6f66 206d 6f64 656c 2c20 796f 7520  e of model, you 
+0008af50: 6361 6e20 6164 6420 6d6f 7265 2076 6172  can add more var
+0008af60: 6961 626c 6573 2074 6f20 6461 7461 6672  iables to datafr
+0008af70: 616d 652e 0d0a 2020 2020 2222 220d 0a20  ame...    """.. 
+0008af80: 2020 2064 6620 3d20 636f 7079 2e64 6565     df = copy.dee
+0008af90: 7063 6f70 7928 6466 290d 0a20 2020 2069  pcopy(df)..    i
+0008afa0: 6620 6466 2e73 6861 7065 5b31 5d20 3c20  f df.shape[1] < 
+0008afb0: 323a 0d0a 2020 2020 2020 2020 7072 696e  2:..        prin
+0008afc0: 7428 274d 6f72 6520 7468 616e 206f 6e65  t('More than one
+0008afd0: 2063 6f6c 756d 6e20 696e 2064 6174 6166   column in dataf
+0008afe0: 7261 6d65 2072 6571 7569 7265 6420 746f  rame required to
+0008aff0: 2070 6572 666f 726d 2066 6561 7475 7265   perform feature
+0008b000: 2065 6e67 696e 6565 7269 6e67 2e20 5265   engineering. Re
+0008b010: 7475 726e 696e 6727 290d 0a20 2020 2020  turning')..     
+0008b020: 2020 2072 6574 7572 6e20 6466 0d0a 2020     return df..  
+0008b030: 2020 6674 5f64 6963 7420 3d20 6469 6374    ft_dict = dict
+0008b040: 287a 6970 285b 2761 6464 272c 276d 756c  (zip(['add','mul
+0008b050: 7469 706c 7927 2c27 7375 6274 7261 6374  tiply','subtract
+0008b060: 272c 2764 6976 6964 6527 5d2c 0d0a 2020  ','divide'],..  
+0008b070: 2020 2020 2020 2020 2020 2020 2020 2020                  
+0008b080: 5b27 6164 645f 6e75 6d65 7269 6327 2c20  ['add_numeric', 
+0008b090: 276d 756c 7469 706c 795f 6e75 6d65 7269  'multiply_numeri
+0008b0a0: 6327 2c0d 0a20 2020 2020 2020 2020 2020  c',..           
+0008b0b0: 2027 7375 6274 7261 6374 5f6e 756d 6572   'subtract_numer
+0008b0c0: 6963 272c 2027 6469 7669 6465 5f6e 756d  ic', 'divide_num
+0008b0d0: 6572 6963 275d 2929 0d0a 2020 2020 6966  eric']))..    if
+0008b0e0: 206c 656e 2866 745f 7265 7175 6573 7473   len(ft_requests
+0008b0f0: 2920 3e20 303a 0d0a 2020 2020 2020 2020  ) > 0:..        
+0008b100: 6674 5f6c 6973 7420 3d20 5b5d 0d0a 2020  ft_list = []..  
+0008b110: 2020 2020 2020 666f 7220 6674 5f6f 6e65        for ft_one
+0008b120: 2069 6e20 6674 5f72 6571 7565 7374 733a   in ft_requests:
+0008b130: 0d0a 2020 2020 2020 2020 2020 2020 6966  ..            if
+0008b140: 2066 745f 6f6e 6520 696e 2066 745f 6469   ft_one in ft_di
+0008b150: 6374 2e6b 6579 7328 293a 0d0a 2020 2020  ct.keys():..    
+0008b160: 2020 2020 2020 2020 2020 2020 6674 5f6c              ft_l
+0008b170: 6973 742e 6170 7065 6e64 2866 745f 6469  ist.append(ft_di
+0008b180: 6374 5b66 745f 6f6e 655d 290d 0a20 2020  ct[ft_one])..   
+0008b190: 2020 2020 2020 2020 2065 6c73 653a 0d0a           else:..
+0008b1a0: 2020 2020 2020 2020 2020 2020 2020 2020                  
+0008b1b0: 7072 696e 7428 2720 2020 2043 616e 6e6f  print('    Canno
+0008b1c0: 7420 7065 7266 6f72 6d20 2573 2d74 7970  t perform %s-typ
+0008b1d0: 6520 6665 6174 7572 6520 656e 6769 6e65  e feature engine
+0008b1e0: 6572 696e 672e 2e2e 2720 2566 745f 6f6e  ering...' %ft_on
+0008b1f0: 6529 0d0a 2020 2020 2020 2020 636f 6c73  e)..        cols
+0008b200: 203d 205b 7820 666f 7220 7820 696e 2064   = [x for x in d
+0008b210: 662e 636f 6c75 6d6e 732e 746f 6c69 7374  f.columns.tolist
+0008b220: 2829 2069 6620 7820 6e6f 7420 696e 205b  () if x not in [
+0008b230: 6964 636f 6c5d 5d0d 0a20 2020 2020 2020  idcol]]..       
+0008b240: 2066 6f72 2065 6163 685f 6674 2c20 636f   for each_ft, co
+0008b250: 756e 7420 696e 207a 6970 2866 745f 6c69  unt in zip(ft_li
+0008b260: 7374 2c20 7261 6e67 6528 6c65 6e28 6674  st, range(len(ft
+0008b270: 5f6c 6973 7429 2929 3a0d 0a20 2020 2020  _list))):..     
+0008b280: 2020 2020 2020 2069 6620 636f 756e 7420         if count 
+0008b290: 3d3d 2030 3a0d 0a20 2020 2020 2020 2020  == 0:..         
+0008b2a0: 2020 2020 2020 2064 665f 6d6f 6420 3d20         df_mod = 
+0008b2b0: 6164 645f 636f 6d70 7574 6174 696f 6e61  add_computationa
+0008b2c0: 6c5f 7072 696d 6974 6976 655f 6665 6174  l_primitive_feat
+0008b2d0: 7572 6573 2864 662c 5b65 6163 685f 6674  ures(df,[each_ft
+0008b2e0: 5d2c 2069 6463 6f6c 290d 0a20 2020 2020  ], idcol)..     
+0008b2f0: 2020 2020 2020 2020 2020 2070 7269 6e74             print
+0008b300: 2864 665f 6d6f 642e 7368 6170 6529 0d0a  (df_mod.shape)..
+0008b310: 2020 2020 2020 2020 2020 2020 656c 7365              else
+0008b320: 3a0d 0a20 2020 2020 2020 2020 2020 2020  :..             
+0008b330: 2020 2064 665f 7465 6d70 203d 2061 6464     df_temp = add
+0008b340: 5f63 6f6d 7075 7461 7469 6f6e 616c 5f70  _computational_p
+0008b350: 7269 6d69 7469 7665 5f66 6561 7475 7265  rimitive_feature
+0008b360: 7328 6466 2c5b 6561 6368 5f66 745d 2c20  s(df,[each_ft], 
+0008b370: 6964 636f 6c29 0d0a 2020 2020 2020 2020  idcol)..        
+0008b380: 2020 2020 2020 2020 6466 5f74 656d 702e          df_temp.
+0008b390: 6472 6f70 2863 6f6c 732c 6178 6973 3d31  drop(cols,axis=1
+0008b3a0: 2c69 6e70 6c61 6365 3d54 7275 6529 0d0a  ,inplace=True)..
+0008b3b0: 2020 2020 2020 2020 2020 2020 2020 2020                  
+0008b3c0: 6466 5f6d 6f64 203d 2070 642e 636f 6e63  df_mod = pd.conc
+0008b3d0: 6174 285b 6466 5f6d 6f64 2c64 665f 7465  at([df_mod,df_te
+0008b3e0: 6d70 5d2c 6178 6973 3d31 2c69 676e 6f72  mp],axis=1,ignor
+0008b3f0: 655f 696e 6465 783d 4661 6c73 6529 0d0a  e_index=False)..
+0008b400: 2020 2020 2020 2020 2020 2020 2020 2020                  
+0008b410: 7072 696e 7428 6466 5f6d 6f64 2e73 6861  print(df_mod.sha
+0008b420: 7065 290d 0a20 2020 2065 6c73 653a 0d0a  pe)..    else:..
+0008b430: 2020 2020 2020 2020 6466 5f6d 6f64 203d          df_mod =
+0008b440: 2061 6464 5f63 6f6d 7075 7461 7469 6f6e   add_computation
+0008b450: 616c 5f70 7269 6d69 7469 7665 5f66 6561  al_primitive_fea
+0008b460: 7475 7265 7328 6466 2c5b 5d2c 2069 6463  tures(df,[], idc
+0008b470: 6f6c 290d 0a20 2020 2072 6574 7572 6e20  ol)..    return 
+0008b480: 6466 5f6d 6f64 0d0a 0d0a 0d0a 6465 6620  df_mod......def 
+0008b490: 6164 645f 6461 7465 5f74 696d 655f 6665  add_date_time_fe
+0008b4a0: 6174 7572 6573 2873 6d61 6c6c 6466 2c20  atures(smalldf, 
+0008b4b0: 7374 6172 7454 696d 652c 2065 6e64 5469  startTime, endTi
+0008b4c0: 6d65 2c20 7370 6c69 7474 6572 5f64 6174  me, splitter_dat
+0008b4d0: 655f 7374 7269 6e67 3d22 2f22 2c73 706c  e_string="/",spl
+0008b4e0: 6974 7465 725f 686f 7572 5f73 7472 696e  itter_hour_strin
+0008b4f0: 673d 223a 2229 3a0d 0a20 2020 2022 2222  g=":"):..    """
+0008b500: 0d0a 2020 2020 4966 2079 6f75 2068 6176  ..    If you hav
+0008b510: 6520 7374 6172 7420 6461 7465 2074 696d  e start date tim
+0008b520: 6520 7374 616d 7020 616e 6420 656e 6420  e stamp and end 
+0008b530: 6461 7465 2074 696d 6520 7374 616d 702c  date time stamp,
+0008b540: 2074 6869 7320 6d6f 6475 6c65 2077 696c   this module wil
+0008b550: 6c20 6372 6561 7465 2061 6464 6974 696f  l create additio
+0008b560: 6e61 6c20 6665 6174 7572 6573 2066 6f72  nal features for
+0008b570: 2073 7563 6820 6669 656c 6473 2e0d 0a20   such fields... 
+0008b580: 2020 2059 6f75 206d 7573 7420 7072 6f76     You must prov
+0008b590: 6964 6520 6120 7374 6172 7420 6461 7465  ide a start date
+0008b5a0: 2074 696d 6520 7374 616d 7020 6669 656c   time stamp fiel
+0008b5b0: 6420 616e 6420 6966 2079 6f75 2068 6176  d and if you hav
+0008b5c0: 6520 616e 2065 6e64 2064 6174 6520 7469  e an end date ti
+0008b5d0: 6d65 2073 7461 6d70 2066 6965 6c64 2c20  me stamp field, 
+0008b5e0: 796f 7520 6d75 7374 2075 7365 2069 742e  you must use it.
+0008b5f0: 0d0a 2020 2020 4f74 6865 7277 6973 652c  ..    Otherwise,
+0008b600: 2079 6f75 2061 7265 2062 6574 7465 7220   you are better 
+0008b610: 6f66 6620 7573 696e 6720 7468 6520 6372  off using the cr
+0008b620: 6561 7465 5f64 6174 655f 7469 6d65 5f66  eate_date_time_f
+0008b630: 6561 7475 7265 7320 6d6f 6475 6c65 2077  eatures module w
+0008b640: 6869 6368 2069 7320 616c 736f 2069 6e20  hich is also in 
+0008b650: 7468 6973 206c 6962 7261 7279 2e0d 0a20  this library... 
+0008b660: 2020 2059 6f75 206d 7573 7420 7072 6f76     You must prov
+0008b670: 6964 6520 7468 6520 666f 6c6c 6f77 696e  ide the followin
+0008b680: 673a 0d0a 2020 2020 736d 616c 6c64 663a  g:..    smalldf:
+0008b690: 2044 6174 6166 7261 6d65 2063 6f6e 7461   Dataframe conta
+0008b6a0: 696e 696e 6720 796f 7572 2064 6174 6520  ining your date 
+0008b6b0: 7469 6d65 2066 6965 6c64 730d 0a20 2020  time fields..   
+0008b6c0: 2073 7461 7274 5469 6d65 3a20 7468 6973   startTime: this
+0008b6d0: 2069 7320 686f 7065 6675 6c6c 7920 6120   is hopefully a 
+0008b6e0: 7374 7269 6e67 2066 6965 6c64 2077 6869  string field whi
+0008b6f0: 6368 2063 6f6e 7665 7274 7320 746f 2061  ch converts to a
+0008b700: 2064 6174 6520 7469 6d65 2073 7461 6d70   date time stamp
+0008b710: 2065 6173 696c 792e 204d 616b 6520 7375   easily. Make su
+0008b720: 7265 2069 7420 6973 2061 2073 7472 696e  re it is a strin
+0008b730: 672e 0d0a 2020 2020 656e 6454 696d 653a  g...    endTime:
+0008b740: 2074 6869 7320 616c 736f 206d 7573 7420   this also must 
+0008b750: 6265 2061 2073 7472 696e 6720 6669 656c  be a string fiel
+0008b760: 6420 7768 6963 6820 636f 6e76 6572 7473  d which converts
+0008b770: 2074 6f20 6120 6461 7465 2074 696d 6520   to a date time 
+0008b780: 7374 616d 7020 6561 7369 6c79 2e20 4d61  stamp easily. Ma
+0008b790: 6b65 2073 7572 6520 6974 2069 7320 6120  ke sure it is a 
+0008b7a0: 7374 7269 6e67 2e0d 0a20 2020 2073 706c  string...    spl
+0008b7b0: 6974 7465 725f 6461 7465 5f73 7472 696e  itter_date_strin
+0008b7c0: 673a 2075 7375 616c 6c79 2074 6865 7265  g: usually there
+0008b7d0: 2069 7320 6120 7374 7269 6e67 2073 7563   is a string suc
+0008b7e0: 6820 6173 2027 2f27 206f 7220 272e 2720  h as '/' or '.' 
+0008b7f0: 6265 7477 6565 6e20 6461 792f 6d6f 6e74  between day/mont
+0008b800: 682f 7965 6172 2065 7463 2e20 4465 6661  h/year etc. Defa
+0008b810: 756c 7420 6973 2061 7373 756d 6564 202f  ult is assumed /
+0008b820: 2068 6572 652e 0d0a 2020 2020 7370 6c69   here...    spli
+0008b830: 7474 6572 5f68 6f75 725f 7374 7269 6e67  tter_hour_string
+0008b840: 3a20 7573 7561 6c6c 7920 7468 6572 6520  : usually there 
+0008b850: 6973 2061 2073 7472 696e 6720 7375 6368  is a string such
+0008b860: 2061 7320 273a 2720 6f72 2027 2e27 2062   as ':' or '.' b
+0008b870: 6574 7765 656e 2068 6f75 723a 6d69 6e3a  etween hour:min:
+0008b880: 7365 6320 6574 632e 2044 6566 6175 6c74  sec etc. Default
+0008b890: 2069 7320 6173 7375 6d65 6420 3a20 6865   is assumed : he
+0008b8a0: 7265 2e0d 0a20 2020 2022 2222 0d0a 2020  re...    """..  
+0008b8b0: 2020 736d 616c 6c64 6620 3d20 736d 616c    smalldf = smal
+0008b8c0: 6c64 662e 636f 7079 2829 0d0a 2020 2020  ldf.copy()..    
+0008b8d0: 6164 645f 636f 6c73 203d 205b 5d0d 0a20  add_cols = [].. 
+0008b8e0: 2020 2073 7461 7274 5f64 6174 6520 3d20     start_date = 
+0008b8f0: 2770 726f 6365 7373 696e 6727 2b73 7461  'processing'+sta
+0008b900: 7274 5469 6d65 2b27 5f73 7461 7274 5f64  rtTime+'_start_d
+0008b910: 6174 6527 0d0a 2020 2020 736d 616c 6c64  ate'..    smalld
+0008b920: 665b 7374 6172 745f 6461 7465 5d20 3d20  f[start_date] = 
+0008b930: 736d 616c 6c64 665b 7374 6172 7454 696d  smalldf[startTim
+0008b940: 655d 2e6d 6170 286c 616d 6264 6120 783a  e].map(lambda x:
+0008b950: 2078 2e73 706c 6974 2822 2022 295b 305d   x.split(" ")[0]
+0008b960: 290d 0a20 2020 2061 6464 5f63 6f6c 732e  )..    add_cols.
+0008b970: 6170 7065 6e64 2873 7461 7274 5f64 6174  append(start_dat
+0008b980: 6529 0d0a 2020 2020 7472 793a 0d0a 2020  e)..    try:..  
+0008b990: 2020 2020 2020 7374 6172 745f 7469 6d65        start_time
+0008b9a0: 203d 2027 7072 6f63 6573 7369 6e67 272b   = 'processing'+
+0008b9b0: 7374 6172 7454 696d 652b 275f 7374 6172  startTime+'_star
+0008b9c0: 745f 7469 6d65 270d 0a20 2020 2020 2020  t_time'..       
+0008b9d0: 2073 6d61 6c6c 6466 5b73 7461 7274 5f74   smalldf[start_t
+0008b9e0: 696d 655d 203d 2073 6d61 6c6c 6466 5b73  ime] = smalldf[s
+0008b9f0: 7461 7274 5469 6d65 5d2e 6d61 7028 6c61  tartTime].map(la
+0008ba00: 6d62 6461 2078 3a20 782e 7370 6c69 7428  mbda x: x.split(
+0008ba10: 2220 2229 5b31 5d29 0d0a 2020 2020 2020  " ")[1])..      
+0008ba20: 2020 6164 645f 636f 6c73 2e61 7070 656e    add_cols.appen
+0008ba30: 6428 7374 6172 745f 7469 6d65 290d 0a20  d(start_time).. 
+0008ba40: 2020 2065 7863 6570 743a 0d0a 2020 2020     except:..    
+0008ba50: 2020 2020 2323 2320 7468 6572 6520 6973      ### there is
+0008ba60: 206e 6f20 686f 7572 2d6d 696e 7574 6573   no hour-minutes
+0008ba70: 2070 6172 7420 6f66 2074 6869 7320 6461   part of this da
+0008ba80: 7465 2074 696d 6520 7374 616d 7020 6669  te time stamp fi
+0008ba90: 656c 642e 2059 6f75 2063 616e 206a 7573  eld. You can jus
+0008baa0: 7420 736b 6970 2069 7420 6966 2069 7420  t skip it if it 
+0008bab0: 6973 206e 6f74 2074 6865 7265 0d0a 2020  is not there..  
+0008bac0: 2020 2020 2020 7061 7373 0d0a 2020 2020        pass..    
+0008bad0: 656e 645f 6461 7465 203d 2027 7072 6f63  end_date = 'proc
+0008bae0: 6573 7369 6e67 272b 656e 6454 696d 652b  essing'+endTime+
+0008baf0: 275f 656e 645f 6461 7465 270d 0a20 2020  '_end_date'..   
+0008bb00: 2073 6d61 6c6c 6466 5b65 6e64 5f64 6174   smalldf[end_dat
+0008bb10: 655d 203d 2073 6d61 6c6c 6466 5b65 6e64  e] = smalldf[end
+0008bb20: 5469 6d65 5d2e 6d61 7028 6c61 6d62 6461  Time].map(lambda
+0008bb30: 2078 3a20 782e 7370 6c69 7428 2220 2229   x: x.split(" ")
+0008bb40: 5b30 5d29 0d0a 2020 2020 6164 645f 636f  [0])..    add_co
+0008bb50: 6c73 2e61 7070 656e 6428 656e 645f 6461  ls.append(end_da
+0008bb60: 7465 290d 0a20 2020 2074 7279 3a0d 0a20  te)..    try:.. 
+0008bb70: 2020 2020 2020 2065 6e64 5f74 696d 6520         end_time 
+0008bb80: 3d20 2770 726f 6365 7373 696e 6727 2b65  = 'processing'+e
+0008bb90: 6e64 5469 6d65 2b27 5f65 6e64 5f74 696d  ndTime+'_end_tim
+0008bba0: 6527 0d0a 2020 2020 2020 2020 736d 616c  e'..        smal
+0008bbb0: 6c64 665b 656e 645f 7469 6d65 5d20 3d20  ldf[end_time] = 
+0008bbc0: 736d 616c 6c64 665b 656e 6454 696d 655d  smalldf[endTime]
+0008bbd0: 2e6d 6170 286c 616d 6264 6120 783a 2078  .map(lambda x: x
+0008bbe0: 2e73 706c 6974 2822 2022 295b 315d 290d  .split(" ")[1]).
+0008bbf0: 0a20 2020 2020 2020 2061 6464 5f63 6f6c  .        add_col
+0008bc00: 732e 6170 7065 6e64 2865 6e64 5f74 696d  s.append(end_tim
+0008bc10: 6529 0d0a 2020 2020 6578 6365 7074 3a0d  e)..    except:.
+0008bc20: 0a20 2020 2020 2020 2023 2323 2074 6865  .        ### the
+0008bc30: 7265 2069 7320 6e6f 2068 6f75 722d 6d69  re is no hour-mi
+0008bc40: 6e75 7465 7320 7061 7274 206f 6620 7468  nutes part of th
+0008bc50: 6973 2064 6174 6520 7469 6d65 2073 7461  is date time sta
+0008bc60: 6d70 2066 6965 6c64 2e20 596f 7520 6361  mp field. You ca
+0008bc70: 6e20 6a75 7374 2073 6b69 7020 6974 2069  n just skip it i
+0008bc80: 6620 6974 2069 7320 6e6f 7420 7468 6572  f it is not ther
+0008bc90: 650d 0a20 2020 2020 2020 2070 6173 730d  e..        pass.
+0008bca0: 0a20 2020 2076 6965 775f 6461 7973 203d  .    view_days =
+0008bcb0: 2027 7072 6f63 6573 7369 6e67 272b 7374   'processing'+st
+0008bcc0: 6172 7454 696d 652b 275f 656c 6170 7365  artTime+'_elapse
+0008bcd0: 645f 6461 7973 270d 0a20 2020 2073 6d61  d_days'..    sma
+0008bce0: 6c6c 6466 5b76 6965 775f 6461 7973 5d20  lldf[view_days] 
+0008bcf0: 3d20 2870 642e 746f 5f64 6174 6574 696d  = (pd.to_datetim
+0008bd00: 6528 736d 616c 6c64 665b 656e 645f 6461  e(smalldf[end_da
+0008bd10: 7465 5d29 202d 2070 642e 746f 5f64 6174  te]) - pd.to_dat
+0008bd20: 6574 696d 6528 736d 616c 6c64 665b 7374  etime(smalldf[st
+0008bd30: 6172 745f 6461 7465 5d29 292e 7661 6c75  art_date])).valu
+0008bd40: 6573 2e61 7374 7970 6528 696e 7429 0d0a  es.astype(int)..
+0008bd50: 2020 2020 6164 645f 636f 6c73 2e61 7070      add_cols.app
+0008bd60: 656e 6428 7669 6577 5f64 6179 7329 0d0a  end(view_days)..
+0008bd70: 2020 2020 7472 793a 0d0a 2020 2020 2020      try:..      
+0008bd80: 2020 7669 6577 5f74 696d 6520 3d20 2770    view_time = 'p
+0008bd90: 726f 6365 7373 696e 6727 2b73 7461 7274  rocessing'+start
+0008bda0: 5469 6d65 2b27 5f65 6c61 7073 6564 5f74  Time+'_elapsed_t
+0008bdb0: 696d 6527 0d0a 2020 2020 2020 2020 736d  ime'..        sm
+0008bdc0: 616c 6c64 665b 7669 6577 5f74 696d 655d  alldf[view_time]
+0008bdd0: 203d 2028 7064 2e74 6f5f 6461 7465 7469   = (pd.to_dateti
+0008bde0: 6d65 2873 6d61 6c6c 6466 5b65 6e64 5f74  me(smalldf[end_t
+0008bdf0: 696d 655d 2920 2d20 7064 2e74 6f5f 6461  ime]) - pd.to_da
+0008be00: 7465 7469 6d65 2873 6d61 6c6c 6466 5b73  tetime(smalldf[s
+0008be10: 7461 7274 5f74 696d 655d 2929 2e61 7374  tart_time])).ast
+0008be20: 7970 6528 2774 696d 6564 656c 7461 3634  ype('timedelta64
+0008be30: 5b73 5d27 292e 7661 6c75 6573 0d0a 2020  [s]').values..  
+0008be40: 2020 2020 2020 6164 645f 636f 6c73 2e61        add_cols.a
+0008be50: 7070 656e 6428 7669 6577 5f74 696d 6529  ppend(view_time)
+0008be60: 0d0a 2020 2020 6578 6365 7074 3a0d 0a20  ..    except:.. 
+0008be70: 2020 2020 2020 2023 2323 2049 6e20 736f         ### In so
+0008be80: 6d65 2064 6174 6520 7469 6d65 2066 6965  me date time fie
+0008be90: 6c64 7320 7468 6973 2067 6976 6573 2061  lds this gives a
+0008bea0: 6e20 6572 726f 7220 736f 2073 6b69 7020  n error so skip 
+0008beb0: 6974 2069 6e20 7468 6174 2063 6173 650d  it in that case.
+0008bec0: 0a20 2020 2020 2020 2070 6173 730d 0a20  .        pass.. 
+0008bed0: 2020 2023 2323 2320 5468 6520 7265 6173     #### The reas
+0008bee0: 6f6e 2077 6520 6368 6f73 6520 656e 6454  on we chose endT
+0008bef0: 696d 6520 6865 7265 2069 7320 7468 6174  ime here is that
+0008bf00: 2073 7461 7274 5469 6d65 2069 7320 7573   startTime is us
+0008bf10: 7561 6c6c 7920 7461 6b65 6e20 6361 7265  ually taken care
+0008bf20: 206f 6620 6279 2061 6e6f 7468 6572 206c   of by another l
+0008bf30: 6962 7261 7279 2e20 536f 2062 6574 7465  ibrary. So bette
+0008bf40: 7220 746f 2064 6f20 7468 6973 2061 6c6f  r to do this alo
+0008bf50: 6e65 2e0d 0a20 2020 2079 6561 7220 3d20  ne...    year = 
+0008bf60: 2770 726f 6365 7373 696e 6727 2b65 6e64  'processing'+end
+0008bf70: 5469 6d65 2b27 5f65 6e64 5f79 6561 7227  Time+'_end_year'
+0008bf80: 0d0a 2020 2020 736d 616c 6c64 665b 7965  ..    smalldf[ye
+0008bf90: 6172 5d20 3d20 736d 616c 6c64 665b 656e  ar] = smalldf[en
+0008bfa0: 645f 6461 7465 5d2e 6d61 7028 6c61 6d62  d_date].map(lamb
+0008bfb0: 6461 2078 3a20 7374 7228 7829 2e73 706c  da x: str(x).spl
+0008bfc0: 6974 2873 706c 6974 7465 725f 6461 7465  it(splitter_date
+0008bfd0: 5f73 7472 696e 6729 5b30 5d29 2e76 616c  _string)[0]).val
+0008bfe0: 7565 730d 0a20 2020 2061 6464 5f63 6f6c  ues..    add_col
+0008bff0: 732e 6170 7065 6e64 2879 6561 7229 0d0a  s.append(year)..
+0008c000: 2020 2020 2323 2323 2054 6865 2072 6561      #### The rea
+0008c010: 736f 6e20 7765 2063 686f 7365 2065 6e64  son we chose end
+0008c020: 5469 6d65 2068 6572 6520 6973 2074 6861  Time here is tha
+0008c030: 7420 7374 6172 7454 696d 6520 6973 2075  t startTime is u
+0008c040: 7375 616c 6c79 2074 616b 656e 2063 6172  sually taken car
+0008c050: 6520 6f66 2062 7920 616e 6f74 6865 7220  e of by another 
+0008c060: 6c69 6272 6172 792e 2053 6f20 6265 7474  library. So bett
+0008c070: 6572 2074 6f20 646f 2074 6869 7320 616c  er to do this al
+0008c080: 6f6e 652e 0d0a 2020 2020 6d6f 6e74 6820  one...    month 
+0008c090: 3d20 2770 726f 6365 7373 696e 6727 2b65  = 'processing'+e
+0008c0a0: 6e64 5469 6d65 2b27 5f65 6e64 5f6d 6f6e  ndTime+'_end_mon
+0008c0b0: 7468 270d 0a20 2020 2073 6d61 6c6c 6466  th'..    smalldf
+0008c0c0: 5b6d 6f6e 7468 5d20 3d20 736d 616c 6c64  [month] = smalld
+0008c0d0: 665b 656e 645f 6461 7465 5d2e 6d61 7028  f[end_date].map(
+0008c0e0: 6c61 6d62 6461 2078 3a20 7374 7228 7829  lambda x: str(x)
+0008c0f0: 2e73 706c 6974 2873 706c 6974 7465 725f  .split(splitter_
+0008c100: 6461 7465 5f73 7472 696e 6729 5b31 5d29  date_string)[1])
+0008c110: 2e76 616c 7565 730d 0a20 2020 2061 6464  .values..    add
+0008c120: 5f63 6f6c 732e 6170 7065 6e64 286d 6f6e  _cols.append(mon
+0008c130: 7468 290d 0a20 2020 2074 7279 3a0d 0a20  th)..    try:.. 
+0008c140: 2020 2020 2020 2023 2323 2320 5468 6520         #### The 
+0008c150: 7265 6173 6f6e 2077 6520 6368 6f73 6520  reason we chose 
+0008c160: 656e 6454 696d 6520 6865 7265 2069 7320  endTime here is 
+0008c170: 7468 6174 2073 7461 7274 5469 6d65 2069  that startTime i
+0008c180: 7320 7573 7561 6c6c 7920 7461 6b65 6e20  s usually taken 
+0008c190: 6361 7265 206f 6620 6279 2061 6e6f 7468  care of by anoth
+0008c1a0: 6572 206c 6962 7261 7279 2e20 536f 2062  er library. So b
+0008c1b0: 6574 7465 7220 746f 2064 6f20 7468 6973  etter to do this
+0008c1c0: 2061 6c6f 6e65 2e0d 0a20 2020 2020 2020   alone...       
+0008c1d0: 2064 6179 6e75 6d20 3d20 2770 726f 6365   daynum = 'proce
+0008c1e0: 7373 696e 6727 2b65 6e64 5469 6d65 2b27  ssing'+endTime+'
+0008c1f0: 5f65 6e64 5f64 6179 5f6e 756d 6265 7227  _end_day_number'
+0008c200: 0d0a 2020 2020 2020 2020 736d 616c 6c64  ..        smalld
+0008c210: 665b 6461 796e 756d 5d20 3d20 736d 616c  f[daynum] = smal
+0008c220: 6c64 665b 656e 645f 6461 7465 5d2e 6d61  ldf[end_date].ma
+0008c230: 7028 6c61 6d62 6461 2078 3a20 7374 7228  p(lambda x: str(
+0008c240: 7829 2e73 706c 6974 2873 706c 6974 7465  x).split(splitte
+0008c250: 725f 6461 7465 5f73 7472 696e 6729 5b32  r_date_string)[2
+0008c260: 5d29 2e76 616c 7565 730d 0a20 2020 2020  ]).values..     
+0008c270: 2020 2061 6464 5f63 6f6c 732e 6170 7065     add_cols.appe
+0008c280: 6e64 2864 6179 6e75 6d29 0d0a 2020 2020  nd(daynum)..    
+0008c290: 6578 6365 7074 3a0d 0a20 2020 2020 2020  except:..       
+0008c2a0: 2023 2323 2049 6e20 736f 6d65 2064 6174   ### In some dat
+0008c2b0: 6520 7469 6d65 2066 6965 6c64 7320 7468  e time fields th
+0008c2c0: 6520 6461 7920 6e75 6d62 6572 2069 7320  e day number is 
+0008c2d0: 6e6f 7420 7468 6572 652e 2049 6620 6e6f  not there. If no
+0008c2e0: 742c 206a 7573 7420 736b 6970 2069 7420  t, just skip it 
+0008c2f0: 2323 2323 0d0a 2020 2020 2020 2020 7061  ####..        pa
+0008c300: 7373 0d0a 2020 2020 2323 2323 2049 6e20  ss..    #### In 
+0008c310: 736f 6d65 2064 6174 6520 7469 6d65 2066  some date time f
+0008c320: 6965 6c64 732c 2074 6865 2068 6f75 7220  ields, the hour 
+0008c330: 616e 6420 6d69 6e75 7465 2069 7320 6e6f  and minute is no
+0008c340: 7420 7468 6572 652c 2073 6f20 736b 6970  t there, so skip
+0008c350: 2069 7420 696e 2074 6861 7420 6361 7365   it in that case
+0008c360: 2069 6620 6974 2065 7272 6f72 7321 0d0a   if it errors!..
+0008c370: 2020 2020 7472 793a 0d0a 2020 2020 2020      try:..      
+0008c380: 2020 7374 6172 745f 686f 7572 203d 2027    start_hour = '
+0008c390: 7072 6f63 6573 7369 6e67 272b 7374 6172  processing'+star
+0008c3a0: 7454 696d 652b 275f 7374 6172 745f 686f  tTime+'_start_ho
+0008c3b0: 7572 270d 0a20 2020 2020 2020 2073 6d61  ur'..        sma
+0008c3c0: 6c6c 6466 5b73 7461 7274 5f68 6f75 725d  lldf[start_hour]
+0008c3d0: 203d 2073 6d61 6c6c 6466 5b73 7461 7274   = smalldf[start
+0008c3e0: 5f74 696d 655d 2e6d 6170 286c 616d 6264  _time].map(lambd
+0008c3f0: 6120 783a 2073 7472 2878 292e 7370 6c69  a x: str(x).spli
+0008c400: 7428 7370 6c69 7474 6572 5f68 6f75 725f  t(splitter_hour_
+0008c410: 7374 7269 6e67 295b 305d 292e 7661 6c75  string)[0]).valu
+0008c420: 6573 0d0a 2020 2020 2020 2020 6164 645f  es..        add_
+0008c430: 636f 6c73 2e61 7070 656e 6428 7374 6172  cols.append(star
+0008c440: 745f 686f 7572 290d 0a20 2020 2020 2020  t_hour)..       
+0008c450: 2073 7461 7274 5f6d 696e 203d 2027 7072   start_min = 'pr
+0008c460: 6f63 6573 7369 6e67 272b 7374 6172 7454  ocessing'+startT
+0008c470: 696d 652b 275f 7374 6172 745f 686f 7572  ime+'_start_hour
+0008c480: 270d 0a20 2020 2020 2020 2073 6d61 6c6c  '..        small
+0008c490: 6466 5b73 7461 7274 5f6d 696e 5d20 3d20  df[start_min] = 
+0008c4a0: 736d 616c 6c64 665b 7374 6172 745f 7469  smalldf[start_ti
+0008c4b0: 6d65 5d2e 6d61 7028 6c61 6d62 6461 2078  me].map(lambda x
+0008c4c0: 3a20 7374 7228 7829 2e73 706c 6974 2873  : str(x).split(s
+0008c4d0: 706c 6974 7465 725f 686f 7572 5f73 7472  plitter_hour_str
+0008c4e0: 696e 6729 5b31 5d29 2e76 616c 7565 730d  ing)[1]).values.
+0008c4f0: 0a20 2020 2020 2020 2061 6464 5f63 6f6c  .        add_col
+0008c500: 732e 6170 7065 6e64 2873 7461 7274 5f6d  s.append(start_m
+0008c510: 696e 290d 0a20 2020 2065 7863 6570 743a  in)..    except:
+0008c520: 0d0a 2020 2020 2020 2020 2323 2320 4966  ..        ### If
+0008c530: 2069 7420 6572 726f 7273 2c20 736b 6970   it errors, skip
+0008c540: 2069 740d 0a20 2020 2020 2020 2070 6173   it..        pas
+0008c550: 730d 0a20 2020 2023 2323 2320 4368 6563  s..    #### Chec
+0008c560: 6b20 6966 2074 6865 7265 2069 7320 6120  k if there is a 
+0008c570: 7765 656b 6461 7920 616e 6420 7765 656b  weekday and week
+0008c580: 656e 6473 2069 6e20 6461 7465 2074 696d  ends in date tim
+0008c590: 6520 636f 6c75 6d6e 7320 7573 696e 6720  e columns using 
+0008c5a0: 656e 6454 696d 6520 6f6e 6c79 0d0a 2020  endTime only..  
+0008c5b0: 2020 7765 656b 6461 795f 6e75 6d20 3d20    weekday_num = 
+0008c5c0: 2770 726f 6365 7373 696e 6727 2b65 6e64  'processing'+end
+0008c5d0: 5469 6d65 2b27 5f65 6e64 5f77 6565 6b64  Time+'_end_weekd
+0008c5e0: 6179 5f6e 756d 6265 7227 0d0a 2020 2020  ay_number'..    
+0008c5f0: 736d 616c 6c64 665b 7765 656b 6461 795f  smalldf[weekday_
+0008c600: 6e75 6d5d 203d 2070 642e 746f 5f64 6174  num] = pd.to_dat
+0008c610: 6574 696d 6528 736d 616c 6c64 665b 656e  etime(smalldf[en
+0008c620: 645f 6461 7465 5d29 2e64 742e 7765 656b  d_date]).dt.week
+0008c630: 6461 792e 7661 6c75 6573 0d0a 2020 2020  day.values..    
+0008c640: 6164 645f 636f 6c73 2e61 7070 656e 6428  add_cols.append(
+0008c650: 7765 656b 6461 795f 6e75 6d29 0d0a 2020  weekday_num)..  
+0008c660: 2020 7765 656b 656e 6420 3d20 2770 726f    weekend = 'pro
+0008c670: 6365 7373 696e 6727 2b65 6e64 5469 6d65  cessing'+endTime
+0008c680: 2b27 5f65 6e64 5f77 6565 6b65 6e64 5f66  +'_end_weekend_f
+0008c690: 6c61 6727 0d0a 2020 2020 736d 616c 6c64  lag'..    smalld
+0008c6a0: 665b 7765 656b 656e 645d 203d 2073 6d61  f[weekend] = sma
+0008c6b0: 6c6c 6466 5b77 6565 6b64 6179 5f6e 756d  lldf[weekday_num
+0008c6c0: 5d2e 6d61 7028 6c61 6d62 6461 2078 3a20  ].map(lambda x: 
+0008c6d0: 3120 6966 2078 2069 6e5b 352c 365d 2065  1 if x in[5,6] e
+0008c6e0: 6c73 6520 3029 0d0a 2020 2020 6164 645f  lse 0)..    add_
+0008c6f0: 636f 6c73 2e61 7070 656e 6428 7765 656b  cols.append(week
+0008c700: 656e 6429 0d0a 2020 2020 2323 2323 2049  end)..    #### I
+0008c710: 6620 6576 6572 7974 6869 6e67 2077 6f72  f everything wor
+0008c720: 6b73 2077 656c 6c2c 2074 6865 7265 2073  ks well, there s
+0008c730: 686f 756c 6420 6265 2031 3320 6e65 7720  hould be 13 new 
+0008c740: 636f 6c75 6d6e 7320 6164 6465 6420 6279  columns added by
+0008c750: 206d 6f64 756c 652e 2041 6c6c 2074 6865   module. All the
+0008c760: 2062 6573 7421 0d0a 2020 2020 7072 696e   best!..    prin
+0008c770: 7428 2725 6420 636f 6c75 6d6e 7320 6164  t('%d columns ad
+0008c780: 6465 6420 7573 696e 6720 7374 6172 7420  ded using start 
+0008c790: 6461 7465 3d25 7320 616e 6420 656e 6420  date=%s and end 
+0008c7a0: 6461 7465 3d25 7320 7072 6f63 6573 7369  date=%s processi
+0008c7b0: 6e67 2e2e 2e27 2025 286c 656e 2861 6464  ng...' %(len(add
+0008c7c0: 5f63 6f6c 7329 2c73 7461 7274 5469 6d65  _cols),startTime
+0008c7d0: 2c65 6e64 5469 6d65 2929 0d0a 2020 2020  ,endTime))..    
+0008c7e0: 7265 7475 726e 2073 6d61 6c6c 6466 0d0a  return smalldf..
+0008c7f0: 230d 0a23 2323 2323 2323 2323 2323 2323  #..#############
+0008c800: 2323 2323 2323 2323 2323 2323 2323 2323  ################
+0008c810: 2323 2323 2323 2323 2323 2323 2323 2323  ################
+0008c820: 2323 2323 2323 2323 2323 2323 2323 2323  ################
+0008c830: 2323 2323 2323 2323 2323 2323 2323 2323  ################
+0008c840: 2323 2323 0d0a 6465 6620 7370 6c69 745f  ####..def split_
+0008c850: 6f6e 655f 6669 656c 645f 696e 746f 5f6d  one_field_into_m
+0008c860: 616e 7928 6466 2c20 6669 656c 642c 2073  any(df, field, s
+0008c870: 706c 6974 7465 722c 2066 696c 6c65 722c  plitter, filler,
+0008c880: 206e 6577 5f6e 616d 6573 5f6c 6973 7429   new_names_list)
+0008c890: 3a0d 0a20 2020 2022 2222 0d0a 2020 2020  :..    """..    
+0008c8a0: 5468 6973 206c 6974 746c 6520 6675 6e63  This little func
+0008c8b0: 7469 6f6e 2074 616b 6573 2061 6e79 2064  tion takes any d
+0008c8c0: 6174 6120 6672 616d 6520 6669 656c 6420  ata frame field 
+0008c8d0: 2873 7472 696e 6720 7661 7269 6162 6c65  (string variable
+0008c8e0: 7320 6f6e 6c79 2920 616e 6420 7370 6c69  s only) and spli
+0008c8f0: 7473 0d0a 2020 2020 6974 2069 6e74 6f20  ts..    it into 
+0008c900: 6173 206d 616e 7920 6669 656c 6473 2061  as many fields a
+0008c910: 7320 796f 7520 7761 6e74 2069 6e20 7468  s you want in th
+0008c920: 6520 6e65 775f 6e61 6d65 735f 6c69 7374  e new_names_list
+0008c930: 2e0d 0a20 2020 2059 6f75 2063 616e 2061  ...    You can a
+0008c940: 6c73 6f20 7370 6563 6966 7920 7768 6174  lso specify what
+0008c950: 2073 7472 696e 6720 746f 2073 706c 6974   string to split
+0008c960: 206f 6e20 7573 696e 6720 7468 6520 7370   on using the sp
+0008c970: 6c69 7474 6572 2061 7267 756d 656e 742e  litter argument.
+0008c980: 0d0a 2020 2020 596f 7520 6361 6e20 616c  ..    You can al
+0008c990: 736f 2066 696c 6c20 4e75 6c6c 2076 616c  so fill Null val
+0008c9a0: 7565 7320 7468 6174 206f 6363 7572 2064  ues that occur d
+0008c9b0: 7565 2074 6f20 796f 7572 2073 706c 6974  ue to your split
+0008c9c0: 7469 6e67 2062 7920 7370 6563 6966 7969  ting by specifyi
+0008c9d0: 6e67 2061 2066 696c 6c65 722e 0d0a 2020  ng a filler...  
+0008c9e0: 2020 6966 206e 6f20 6e65 775f 6e61 6d65    if no new_name
+0008c9f0: 735f 6c69 7374 2069 7320 6769 7665 6e2c  s_list is given,
+0008ca00: 2074 6865 6e20 7765 2075 7365 2074 6865   then we use the
+0008ca10: 206e 616d 6520 6f66 2074 6865 2066 6965   name of the fie
+0008ca20: 6c64 2069 7473 656c 6620 746f 2073 706c  ld itself to spl
+0008ca30: 6974 2e0d 0a20 2020 2022 2222 0d0a 2020  it...    """..  
+0008ca40: 2020 696d 706f 7274 2077 6172 6e69 6e67    import warning
+0008ca50: 730d 0a20 2020 2077 6172 6e69 6e67 732e  s..    warnings.
+0008ca60: 6669 6c74 6572 7761 726e 696e 6773 2822  filterwarnings("
+0008ca70: 6967 6e6f 7265 2229 0d0a 2020 2020 6466  ignore")..    df
+0008ca80: 203d 2064 662e 636f 7079 2829 0d0a 2020   = df.copy()..  
+0008ca90: 2020 2323 2320 4669 7273 7420 7072 696e    ### First prin
+0008caa0: 7420 7468 6520 6d61 7869 6d75 6d20 6e75  t the maximum nu
+0008cab0: 6d62 6572 206f 6620 7468 696e 6773 2069  mber of things i
+0008cac0: 6e20 7468 6174 2066 6965 6c64 0d0a 2020  n that field..  
+0008cad0: 2020 6d61 785f 7468 696e 6773 203d 2064    max_things = d
+0008cae0: 665b 6669 656c 645d 2e6d 6170 286c 616d  f[field].map(lam
+0008caf0: 6264 6120 783a 206c 656e 2878 2e73 706c  bda x: len(x.spl
+0008cb00: 6974 2873 706c 6974 7465 7229 2929 2e6d  it(splitter))).m
+0008cb10: 6178 2829 0d0a 2020 2020 6966 206c 656e  ax()..    if len
+0008cb20: 286e 6577 5f6e 616d 6573 5f6c 6973 7429  (new_names_list)
+0008cb30: 203d 3d20 303a 0d0a 2020 2020 2020 2020   == 0:..        
+0008cb40: 7072 696e 7428 2720 2020 204d 6178 2e20  print('    Max. 
+0008cb50: 636f 6c75 6d6e 7320 6372 6561 7465 6420  columns created 
+0008cb60: 6279 2073 706c 6974 7469 6e67 2025 7320  by splitting %s 
+0008cb70: 6669 656c 6420 6973 2025 642e 2720 2528  field is %d.' %(
+0008cb80: 0d0a 2020 2020 2020 2020 2020 2020 2020  ..              
+0008cb90: 2020 2020 2020 2020 2020 2020 2020 6669                fi
+0008cba0: 656c 642c 6d61 785f 7468 696e 6773 2929  eld,max_things))
+0008cbb0: 0d0a 2020 2020 656c 7365 3a0d 0a20 2020  ..    else:..   
+0008cbc0: 2020 2020 2070 7269 6e74 2827 2020 2020       print('    
+0008cbd0: 4d61 782e 2063 6f6c 756d 6e73 2063 7265  Max. columns cre
+0008cbe0: 6174 6564 2062 7920 7370 6c69 7474 696e  ated by splittin
+0008cbf0: 6720 2573 2066 6965 6c64 2069 7320 2564  g %s field is %d
+0008cc00: 2062 7574 2079 6f75 2068 6176 6520 6769   but you have gi
+0008cc10: 7665 6e20 2564 2076 6172 6961 626c 6520  ven %d variable 
+0008cc20: 6e61 6d65 7320 6f6e 6c79 2e20 5365 6c65  names only. Sele
+0008cc30: 6374 696e 6720 6669 7273 7420 2564 2720  cting first %d' 
+0008cc40: 2528 0d0a 2020 2020 2020 2020 2020 2020  %(..            
+0008cc50: 2020 2020 2020 2020 2020 2020 6669 656c              fiel
+0008cc60: 642c 6d61 785f 7468 696e 6773 2c6c 656e  d,max_things,len
+0008cc70: 286e 6577 5f6e 616d 6573 5f6c 6973 7429  (new_names_list)
+0008cc80: 2c6c 656e 286e 6577 5f6e 616d 6573 5f6c  ,len(new_names_l
+0008cc90: 6973 7429 2929 0d0a 2020 2020 2323 2320  ist)))..    ### 
+0008cca0: 5468 6973 2063 7265 6174 6573 2061 206e  This creates a n
+0008ccb0: 6577 2066 6965 6c64 2074 6861 7420 636f  ew field that co
+0008ccc0: 756e 7473 2074 6865 206e 756d 6265 7220  unts the number 
+0008ccd0: 6f66 2074 6869 6e67 7320 7468 6174 2061  of things that a
+0008cce0: 7265 2069 6e20 7468 6174 2066 6965 6c64  re in that field
+0008ccf0: 2e0d 0a20 2020 206e 756d 5f70 726f 6475  ...    num_produ
+0008cd00: 6374 735f 7669 6577 6564 203d 2027 636f  cts_viewed = 'co
+0008cd10: 756e 745f 7468 696e 6773 5f69 6e5f 272b  unt_things_in_'+
+0008cd20: 6669 656c 640d 0a20 2020 2064 665b 6e75  field..    df[nu
+0008cd30: 6d5f 7072 6f64 7563 7473 5f76 6965 7765  m_products_viewe
+0008cd40: 645d 203d 2064 665b 6669 656c 645d 2e6d  d] = df[field].m
+0008cd50: 6170 286c 616d 6264 6120 783a 206c 656e  ap(lambda x: len
+0008cd60: 2878 2e73 706c 6974 2822 3b22 2929 292e  (x.split(";"))).
+0008cd70: 7661 6c75 6573 0d0a 2020 2020 2323 2320  values..    ### 
+0008cd80: 436c 6561 6e20 7570 2074 6865 2066 6965  Clean up the fie
+0008cd90: 6c64 2073 7563 6820 7468 6174 2069 7420  ld such that it 
+0008cda0: 6861 7320 7468 6520 7269 6768 7420 6e75  has the right nu
+0008cdb0: 6d62 6572 206f 6620 7370 6c69 7420 6368  mber of split ch
+0008cdc0: 6172 7320 6f74 6865 7277 6973 6520 6164  ars otherwise ad
+0008cdd0: 6420 746f 2069 740d 0a20 2020 2064 665b  d to it..    df[
+0008cde0: 6669 656c 645d 203d 2064 665b 6669 656c  field] = df[fiel
+0008cdf0: 645d 2e6d 6170 286c 616d 6264 6120 783a  d].map(lambda x:
+0008ce00: 2078 2b73 706c 6974 7465 722a 286d 6178   x+splitter*(max
+0008ce10: 5f74 6869 6e67 732d 6c65 6e28 782e 7370  _things-len(x.sp
+0008ce20: 6c69 7428 223b 2229 2929 2069 6620 6c65  lit(";"))) if le
+0008ce30: 6e28 782e 7370 6c69 7428 223b 2229 2920  n(x.split(";")) 
+0008ce40: 3c20 6d61 785f 7468 696e 6773 2065 6c73  < max_things els
+0008ce50: 6520 7829 0d0a 2020 2020 2323 2323 2323  e x)..    ######
+0008ce60: 204e 6f77 2079 6f75 2063 7265 6174 6520   Now you create 
+0008ce70: 6e65 7720 6669 656c 6473 2062 7920 7370  new fields by sp
+0008ce80: 6c69 7420 7468 6520 6f6e 6520 6c61 7267  lit the one larg
+0008ce90: 6520 6669 656c 6420 2323 2323 2323 2323  e field ########
+0008cea0: 0d0a 2020 2020 6966 206e 6577 5f6e 616d  ..    if new_nam
+0008ceb0: 6573 5f6c 6973 7420 3d3d 2027 273a 0d0a  es_list == '':..
+0008cec0: 2020 2020 2020 2020 6e65 775f 6e61 6d65          new_name
+0008ced0: 735f 6c69 7374 203d 205b 6669 656c 642b  s_list = [field+
+0008cee0: 275f 272b 7374 7228 6929 2066 6f72 2069  '_'+str(i) for i
+0008cef0: 2069 6e20 7261 6e67 6528 312c 6d61 785f   in range(1,max_
+0008cf00: 7468 696e 6773 2b31 295d 0d0a 2020 2020  things+1)]..    
+0008cf10: 7472 793a 0d0a 2020 2020 2020 2020 666f  try:..        fo
+0008cf20: 7220 6920 696e 2072 616e 6765 286c 656e  r i in range(len
+0008cf30: 286e 6577 5f6e 616d 6573 5f6c 6973 7429  (new_names_list)
+0008cf40: 293a 0d0a 2020 2020 2020 2020 2020 2020  ):..            
+0008cf50: 6466 5b66 6965 6c64 5d2e 6669 6c6c 6e61  df[field].fillna
+0008cf60: 2866 696c 6c65 722c 2069 6e70 6c61 6365  (filler, inplace
+0008cf70: 3d54 7275 6529 0d0a 2020 2020 2020 2020  =True)..        
+0008cf80: 2020 2020 6466 2e6c 6f63 5b64 665b 6669      df.loc[df[fi
+0008cf90: 656c 645d 203d 3d20 7370 6c69 7474 6572  eld] == splitter
+0008cfa0: 2c20 6669 656c 645d 203d 2066 696c 6c65  , field] = fille
+0008cfb0: 720d 0a20 2020 2020 2020 2020 2020 2064  r..            d
+0008cfc0: 665b 6e65 775f 6e61 6d65 735f 6c69 7374  f[new_names_list
+0008cfd0: 5b69 5d5d 203d 2064 665b 6669 656c 645d  [i]] = df[field]
+0008cfe0: 2e6d 6170 286c 616d 6264 6120 783a 2078  .map(lambda x: x
+0008cff0: 2e73 706c 6974 2873 706c 6974 7465 7229  .split(splitter)
+0008d000: 5b69 5d0d 0a20 2020 2020 2020 2020 2020  [i]..           
+0008d010: 2020 2020 2020 2020 2020 2020 2020 2020                  
+0008d020: 2020 2020 2020 2020 2020 2020 2020 2069                 i
+0008d030: 6620 7370 6c69 7474 6572 2069 6e20 7820  f splitter in x 
+0008d040: 656c 7365 2078 290d 0a20 2020 2065 7863  else x)..    exc
+0008d050: 6570 743a 0d0a 2020 2020 2020 2020 2323  ept:..        ##
+0008d060: 2320 4368 6563 6b20 6966 2074 6865 2063  # Check if the c
+0008d070: 6f6c 756d 6e20 6973 2061 2073 7472 696e  olumn is a strin
+0008d080: 6720 636f 6c75 6d6e 2e20 4966 206e 6f74  g column. If not
+0008d090: 2c20 6769 7665 2061 6e20 6572 726f 7220  , give an error 
+0008d0a0: 6d65 7373 6167 652e 0d0a 2020 2020 2020  message...      
+0008d0b0: 2020 7072 696e 7428 2743 616e 6e6f 7420    print('Cannot 
+0008d0c0: 7370 6c69 7420 7468 6520 636f 6c75 6d6e  split the column
+0008d0d0: 2e20 4765 7474 696e 6720 616e 2065 7272  . Getting an err
+0008d0e0: 6f72 2e20 4368 6563 6b20 7468 6520 636f  or. Check the co
+0008d0f0: 6c75 6d6e 2061 6761 696e 2729 0d0a 2020  lumn again')..  
+0008d100: 2020 2020 2020 7265 7475 726e 2064 660d        return df.
+0008d110: 0a20 2020 2072 6574 7572 6e20 6466 2c20  .    return df, 
+0008d120: 6e65 775f 6e61 6d65 735f 6c69 7374 0d0a  new_names_list..
+0008d130: 2323 2323 2323 2323 2323 2323 2323 2323  ################
+0008d140: 2323 2323 2323 2323 2323 2323 2323 2323  ################
+0008d150: 2323 2323 2323 2323 2323 2323 2323 2323  ################
+0008d160: 2323 2323 2323 2323 2323 2323 2323 2323  ################
+0008d170: 2323 2323 2323 2323 2323 2323 2323 2323  ################
+0008d180: 230d 0a64 6566 2061 6464 5f61 6767 7265  #..def add_aggre
+0008d190: 6761 7465 5f70 7269 6d69 7469 7665 5f66  gate_primitive_f
+0008d1a0: 6561 7475 7265 7328 6466 742c 2061 6767  eatures(dft, agg
+0008d1b0: 5f74 7970 6573 2c20 6964 5f63 6f6c 756d  _types, id_colum
+0008d1c0: 6e2c 2069 676e 6f72 655f 7661 7269 6162  n, ignore_variab
+0008d1d0: 6c65 733d 5b5d 293a 0d0a 2020 2020 2222  les=[]):..    ""
+0008d1e0: 220d 0a20 2020 2023 2323 2020 204d 6f64  "..    ###   Mod
+0008d1f0: 6966 7920 4461 7461 6672 616d 6520 6279  ify Dataframe by
+0008d200: 2061 6464 696e 6720 636f 6d70 7574 6174   adding computat
+0008d210: 696f 6e61 6c20 7072 696d 6974 6976 6520  ional primitive 
+0008d220: 4665 6174 7572 6573 2075 7369 6e67 2046  Features using F
+0008d230: 6561 7475 7265 2054 6f6f 6c73 2023 2323  eature Tools ###
+0008d240: 230d 0a20 2020 2023 2323 2020 2057 6861  #..    ###   Wha
+0008d250: 7420 6172 6520 6167 6772 6567 6174 6520  t are aggregate 
+0008d260: 7072 696d 6974 6976 6573 3f20 7468 6579  primitives? they
+0008d270: 2061 7265 2074 6f20 226d 6561 6e22 226d   are to "mean""m
+0008d280: 6564 6961 6e22 2c22 6d6f 6465 222c 226d  edian","mode","m
+0008d290: 696e 222c 226d 6178 222c 2065 7463 2e20  in","max", etc. 
+0008d2a0: 6665 6174 7572 6573 0d0a 2020 2020 2323  features..    ##
+0008d2b0: 2320 496e 7075 7473 3a0d 0a20 2020 2023  # Inputs:..    #
+0008d2c0: 2323 2020 2064 663a 204a 7573 7420 7365  ##   df: Just se
+0008d2d0: 6e74 2069 6e20 7468 6520 6461 7461 2066  nt in the data f
+0008d2e0: 7261 6d65 2064 6620 7468 6174 2079 6f75  rame df that you
+0008d2f0: 2077 616e 7420 6665 6174 7572 6573 2061   want features a
+0008d300: 6464 6564 2074 6f0d 0a20 2020 2023 2323  dded to..    ###
+0008d310: 2020 2061 6767 5f74 7970 6573 3a20 6c69     agg_types: li
+0008d320: 7374 206f 6620 636f 6d70 7574 6174 696f  st of computatio
+0008d330: 6e61 6c20 7479 7065 733a 2027 6d65 616e  nal types: 'mean
+0008d340: 272c 276d 6564 6961 6e27 2c27 636f 756e  ','median','coun
+0008d350: 7427 2c20 276d 6178 272c 2027 6d69 6e27  t', 'max', 'min'
+0008d360: 2c20 2773 756d 272c 2065 7463 2e0d 0a20  , 'sum', etc... 
+0008d370: 2020 2023 2323 2020 2020 2020 2020 204f     ###         O
+0008d380: 6e65 2063 6176 6561 743a 2074 6865 7365  ne caveat: these
+0008d390: 2061 6767 5f74 7970 6573 206d 7573 7420   agg_types must 
+0008d3a0: 6265 2066 6f75 6e64 2069 6e20 7468 6520  be found in the 
+0008d3b0: 6167 675f 6675 6e63 206f 6620 6e75 6d70  agg_func of nump
+0008d3c0: 7920 6f72 2070 616e 6461 7320 6772 6f75  y or pandas grou
+0008d3d0: 7062 7920 7374 6174 656d 656e 742e 0d0a  pby statement...
+0008d3e0: 2020 2020 2323 2320 2020 2020 2020 2020      ###         
+0008d3f0: 666f 7220 6578 616d 706c 653a 206e 756d  for example: num
+0008d400: 7079 2068 6173 2027 6d65 6469 616e 272c  py has 'median',
+0008d410: 2770 726f 6427 2c27 7375 6d27 2c27 7374  'prod','sum','st
+0008d420: 6427 2c27 7661 7227 2c20 6574 632e 202d  d','var', etc. -
+0008d430: 2074 6865 7920 7769 6c6c 2077 6f72 6b21   they will work!
+0008d440: 0d0a 2020 2020 2323 2320 2020 6964 636f  ..    ###   idco
+0008d450: 6c75 6d6e 3a20 7468 6973 2069 7320 746f  lumn: this is to
+0008d460: 2063 7265 6174 6520 616e 2069 6e64 6578   create an index
+0008d470: 2066 6f72 2074 6865 2064 6174 6166 7261   for the datafra
+0008d480: 6d65 2073 696e 6365 2046 5420 7275 6e73  me since FT runs
+0008d490: 206f 6e20 696e 6465 7820 7661 7269 6162   on index variab
+0008d4a0: 6c65 2e20 596f 7520 6361 6e20 6c65 6176  le. You can leav
+0008d4b0: 6520 6974 2065 6d70 7479 2073 7472 696e  e it empty strin
+0008d4c0: 672e 0d0a 2020 2020 2323 2320 2020 6967  g...    ###   ig
+0008d4d0: 6e6f 7265 5f76 6172 6961 626c 6573 3a20  nore_variables: 
+0008d4e0: 6c69 7374 206f 6620 7661 7269 6162 6c65  list of variable
+0008d4f0: 7320 746f 2069 676e 6f72 6520 616d 6f6e  s to ignore amon
+0008d500: 6720 6e75 6d65 7269 6320 7661 7269 6162  g numeric variab
+0008d510: 6c65 7320 696e 2064 6174 6120 7369 6e63  les in data sinc
+0008d520: 6520 7468 6579 206d 6179 2062 6520 4944  e they may be ID
+0008d530: 2076 6172 6961 626c 6573 2e0d 0a20 2020   variables...   
+0008d540: 2022 2222 0d0a 2020 2020 696d 706f 7274   """..    import
+0008d550: 2063 6f70 790d 0a20 2020 2023 2323 204d   copy..    ### M
+0008d560: 616b 6520 7375 7265 2074 6865 206c 6973  ake sure the lis
+0008d570: 7420 6f66 2066 756e 6374 696f 6e73 2074  t of functions t
+0008d580: 6865 7920 7365 6e64 2069 6e20 6172 6520  hey send in are 
+0008d590: 6163 6365 7074 6162 6c65 2066 756e 6374  acceptable funct
+0008d5a0: 696f 6e73 2e20 4966 206e 6f74 2c20 7468  ions. If not, th
+0008d5b0: 6520 6167 6772 6567 6174 6520 7769 6c6c  e aggregate will
+0008d5c0: 2062 6c6f 7720 7570 210d 0a20 2020 2066   blow up!..    f
+0008d5d0: 756e 635f 7365 7420 3d20 7b27 636f 756e  unc_set = {'coun
+0008d5e0: 7427 2c27 7375 6d27 2c27 6d65 616e 272c  t','sum','mean',
+0008d5f0: 276d 6164 272c 276d 6564 6961 6e27 2c27  'mad','median','
+0008d600: 6d69 6e27 2c27 6d61 7827 2c27 6d6f 6465  min','max','mode
+0008d610: 272c 2761 6273 272c 2770 726f 6427 2c27  ','abs','prod','
+0008d620: 7374 6427 2c27 7661 7227 2c27 7365 6d27  std','var','sem'
+0008d630: 2c27 736b 6577 272c 276b 7572 7427 2c27  ,'skew','kurt','
+0008d640: 7175 616e 7469 6c65 272c 2763 756d 7375  quantile','cumsu
+0008d650: 6d27 2c27 6375 6d70 726f 6427 2c27 6375  m','cumprod','cu
+0008d660: 6d6d 6178 272c 2763 756d 6d69 6e27 7d0d  mmax','cummin'}.
+0008d670: 0a20 2020 2061 6767 5f74 7970 6573 203d  .    agg_types =
+0008d680: 206c 6973 7428 7365 7428 6167 675f 7479   list(set(agg_ty
+0008d690: 7065 7329 2e69 6e74 6572 7365 6374 696f  pes).intersectio
+0008d6a0: 6e28 6675 6e63 5f73 6574 2929 0d0a 2020  n(func_set))..  
+0008d6b0: 2020 2323 2320 4966 2074 6865 2069 676e    ### If the ign
+0008d6c0: 6f72 655f 7661 7269 6162 6c65 7320 6c69  ore_variables li
+0008d6d0: 7374 2069 7320 656d 7074 792c 206d 616b  st is empty, mak
+0008d6e0: 6520 7375 7265 2079 6f75 2061 6464 2074  e sure you add t
+0008d6f0: 6865 2069 645f 636f 6c75 6d6e 2074 6f20  he id_column to 
+0008d700: 6974 2073 6f20 6974 2063 616e 2062 6520  it so it can be 
+0008d710: 6472 6f70 7065 6420 6672 6f6d 2061 6767  dropped from agg
+0008d720: 7265 6761 7469 6f6e 2e0d 0a20 2020 2069  regation...    i
+0008d730: 6620 6c65 6e28 6967 6e6f 7265 5f76 6172  f len(ignore_var
+0008d740: 6961 626c 6573 2920 3d3d 2030 3a0d 0a20  iables) == 0:.. 
+0008d750: 2020 2020 2020 2069 676e 6f72 655f 7661         ignore_va
+0008d760: 7269 6162 6c65 7320 3d20 5b69 645f 636f  riables = [id_co
+0008d770: 6c75 6d6e 5d0d 0a20 2020 2023 2323 2053  lumn]..    ### S
+0008d780: 656c 6563 7420 6f6e 6c79 2069 6e74 6567  elect only integ
+0008d790: 6572 2061 6e64 2066 6c6f 6174 2076 6172  er and float var
+0008d7a0: 6961 626c 6573 2074 6f20 646f 2074 6869  iables to do thi
+0008d7b0: 7320 6167 6772 6567 6174 696f 6e20 6f6e  s aggregation on
+0008d7c0: 2e20 4265 2076 6572 7920 6361 7265 6675  . Be very carefu
+0008d7d0: 6c20 6966 2074 6865 7265 2061 7265 2074  l if there are t
+0008d7e0: 6f6f 206d 616e 7920 7661 7273 2e0d 0a20  oo many vars... 
+0008d7f0: 2020 2023 2323 2054 6869 7320 7769 6c6c     ### This will
+0008d800: 2074 616b 6520 7469 6d65 2074 6f20 7275   take time to ru
+0008d810: 6e20 696e 2074 6861 7420 6361 7365 2e0d  n in that case..
+0008d820: 0a20 2020 2064 6674 5f69 6e64 6578 203d  .    dft_index =
+0008d830: 2063 6f70 792e 6465 6570 636f 7079 2864   copy.deepcopy(d
+0008d840: 6674 5b69 645f 636f 6c75 6d6e 5d29 0d0a  ft[id_column])..
+0008d850: 2020 2020 6466 745f 636f 6e74 203d 2063      dft_cont = c
+0008d860: 6f70 792e 6465 6570 636f 7079 2864 6674  opy.deepcopy(dft
+0008d870: 2e73 656c 6563 745f 6474 7970 6573 2827  .select_dtypes('
+0008d880: 6e75 6d62 6572 2729 2e64 726f 7028 6967  number').drop(ig
+0008d890: 6e6f 7265 5f76 6172 6961 626c 6573 2c61  nore_variables,a
+0008d8a0: 7869 733d 3129 290d 0a20 2020 2064 6674  xis=1))..    dft
+0008d8b0: 5f63 6f6e 745b 6964 5f63 6f6c 756d 6e5d  _cont[id_column]
+0008d8c0: 203d 2064 6674 5f69 6e64 6578 0d0a 2020   = dft_index..  
+0008d8d0: 2020 7472 793a 0d0a 2020 2020 2020 2020    try:..        
+0008d8e0: 6466 745f 6675 6c6c 203d 2064 6674 5f63  dft_full = dft_c
+0008d8f0: 6f6e 742e 6772 6f75 7062 7928 6964 5f63  ont.groupby(id_c
+0008d900: 6f6c 756d 6e29 2e61 6767 2861 6767 5f74  olumn).agg(agg_t
+0008d910: 7970 6573 290d 0a20 2020 2065 7863 6570  ypes)..    excep
+0008d920: 743a 0d0a 2020 2020 2020 2020 2323 2320  t:..        ### 
+0008d930: 6966 2066 6f72 2073 6f6d 6520 7265 6173  if for some reas
+0008d940: 6f6e 2c20 7468 6520 6772 6f75 7062 7920  on, the groupby 
+0008d950: 626c 6f77 7320 7570 2c20 7468 656e 206a  blows up, then j
+0008d960: 7573 7420 7265 7475 726e 2074 6865 2064  ust return the d
+0008d970: 6174 6166 7261 6d65 2061 7320 6973 202d  ataframe as is -
+0008d980: 206e 6f20 6368 616e 6765 7321 0d0a 2020   no changes!..  
+0008d990: 2020 2020 2020 7265 7475 726e 2064 6674        return dft
+0008d9a0: 0d0a 2020 2020 636f 6c73 203d 205b 782b  ..    cols = [x+
+0008d9b0: 275f 272b 792b 275f 6279 5f27 2b69 645f  '_'+y+'_by_'+id_
+0008d9c0: 636f 6c75 6d6e 2066 6f72 2028 782c 7929  column for (x,y)
+0008d9d0: 2069 6e20 6466 745f 6675 6c6c 2e63 6f6c   in dft_full.col
+0008d9e0: 756d 6e73 5d0d 0a20 2020 2064 6674 5f66  umns]..    dft_f
+0008d9f0: 756c 6c2e 636f 6c75 6d6e 7320 3d20 636f  ull.columns = co
+0008da00: 6c73 0d0a 2020 2020 2323 2320 204e 6f74  ls..    ###  Not
+0008da10: 2065 7665 7279 2063 6f6c 756d 6e20 6861   every column ha
+0008da20: 7320 7573 6566 756c 2076 616c 7565 732e  s useful values.
+0008da30: 2049 6620 6974 2069 7320 6675 6c6c 206f   If it is full o
+0008da40: 6620 6a75 7374 2074 6865 2073 616d 6520  f just the same 
+0008da50: 7661 6c75 652c 2072 656d 6f76 6520 6974  value, remove it
+0008da60: 0d0a 2020 2020 5f2c 206c 6973 745f 756e  ..    _, list_un
+0008da70: 6971 7565 5f63 6f6c 5f69 6473 203d 206e  ique_col_ids = n
+0008da80: 702e 756e 6971 7565 2864 6674 5f66 756c  p.unique(dft_ful
+0008da90: 6c2c 2061 7869 7320 3d20 312c 2072 6574  l, axis = 1, ret
+0008daa0: 7572 6e5f 696e 6465 783d 5472 7565 290d  urn_index=True).
+0008dab0: 0a20 2020 2064 6674 5f66 756c 6c20 3d20  .    dft_full = 
+0008dac0: 6466 745f 6675 6c6c 2e69 6c6f 635b 3a2c  dft_full.iloc[:,
+0008dad0: 206c 6973 745f 756e 6971 7565 5f63 6f6c   list_unique_col
+0008dae0: 5f69 6473 5d0d 0a20 2020 2072 6574 7572  _ids]..    retur
+0008daf0: 6e20 6466 745f 6675 6c6c 0d0a 2323 2323  n dft_full..####
+0008db00: 2323 2323 2323 2323 2323 2323 2323 2323  ################
+0008db10: 2323 2323 2323 2323 2323 2323 2323 2323  ################
+0008db20: 2323 2323 2323 2323 2323 2323 2323 2323  ################
+0008db30: 2323 2323 2323 2323 2323 2323 2323 2323  ################
+0008db40: 2323 2323 2323 2323 2323 2323 2323 2323  ################
+0008db50: 2323 2323 2323 2323 2323 2323 2323 2323  ################
+0008db60: 2323 2323 2323 2323 2323 2323 2323 2323  ################
+0008db70: 2323 2323 2323 2323 2323 2323 0d0a 696d  ############..im
+0008db80: 706f 7274 2063 6f70 790d 0a69 6d70 6f72  port copy..impor
+0008db90: 7420 7469 6d65 0d0a 696d 706f 7274 2070  t time..import p
+0008dba0: 6462 0d0a 6465 6620 4645 5f63 7265 6174  db..def FE_creat
+0008dbb0: 655f 6772 6f75 7062 795f 6665 6174 7572  e_groupby_featur
+0008dbc0: 6573 2864 6674 2c20 6772 6f75 7062 795f  es(dft, groupby_
+0008dbd0: 636f 6c75 6d6e 732c 206e 756d 6572 6963  columns, numeric
+0008dbe0: 5f63 6f6c 756d 6e73 2c20 6167 675f 7479  _columns, agg_ty
+0008dbf0: 7065 7329 3a0d 0a20 2020 2022 2222 0d0a  pes):..    """..
+0008dc00: 2020 2020 4645 206d 6561 6e73 2046 4541      FE means FEA
+0008dc10: 5455 5245 2045 4e47 494e 4545 5249 4e47  TURE ENGINEERING
+0008dc20: 202d 2054 6861 7420 6d65 616e 7320 7468   - That means th
+0008dc30: 6973 2066 756e 6374 696f 6e20 7769 6c6c  is function will
+0008dc40: 2063 7265 6174 6520 6e65 7720 6665 6174   create new feat
+0008dc50: 7572 6573 0d0a 2020 2020 4265 7761 7265  ures..    Beware
+0008dc60: 3a20 7468 6973 2066 756e 6374 696f 6e20  : this function 
+0008dc70: 7769 6c6c 2072 6574 7572 6e20 6120 736d  will return a sm
+0008dc80: 616c 6c65 7220 6461 7461 6672 616d 6520  aller dataframe 
+0008dc90: 7468 616e 2077 6861 7420 796f 7520 7365  than what you se
+0008dca0: 6e64 2069 6e20 7369 6e63 6520 6974 2067  nd in since it g
+0008dcb0: 726f 7570 7320 726f 7773 2062 7920 6b65  roups rows by ke
+0008dcc0: 7973 2e0d 0a20 2020 2023 2323 2323 2323  ys...    #######
+0008dcd0: 2323 2323 2323 2323 2323 2323 2323 2323  ################
+0008dce0: 2323 2323 2323 2323 2323 2323 2323 2323  ################
+0008dcf0: 2323 2323 2323 2323 2323 2323 2323 2323  ################
+0008dd00: 2323 2323 2323 2323 2323 2323 2323 2323  ################
+0008dd10: 2323 2323 2323 2323 2323 2323 2323 2323  ################
+0008dd20: 2323 2323 2323 2323 2323 2323 2323 2323  ################
+0008dd30: 2323 0d0a 2020 2020 4675 6e63 7469 6f6e  ##..    Function
+0008dd40: 2067 726f 7570 7320 726f 7773 2069 6e20   groups rows in 
+0008dd50: 6120 6466 7420 6461 7461 6672 616d 6520  a dft dataframe 
+0008dd60: 6279 2074 6865 2067 726f 7570 6279 5f63  by the groupby_c
+0008dd70: 6f6c 756d 6e73 2061 6e64 2072 6574 7572  olumns and retur
+0008dd80: 6e73 206d 756c 7469 706c 6520 636f 6c75  ns multiple colu
+0008dd90: 6d6e 7320 666f 7220 7468 6520 6e75 6d65  mns for the nume
+0008dda0: 7269 6320 636f 6c75 6d6e 2061 6767 7265  ric column aggre
+0008ddb0: 6761 7465 642e 0d0a 2020 2020 446f 206e  gated...    Do n
+0008ddc0: 6f74 2073 656e 6420 696e 206d 6f72 6520  ot send in more 
+0008ddd0: 7468 616e 206f 6e65 2063 6f6c 756d 6e20  than one column 
+0008dde0: 696e 2074 6865 206e 756d 6572 6963 2063  in the numeric c
+0008ddf0: 6f6c 756d 6e20 7369 6e63 6520 6265 796f  olumn since beyo
+0008de00: 6e64 2074 6865 2066 6972 7374 2063 6f6c  nd the first col
+0008de10: 756d 6e20 6974 2077 696c 6c20 6265 2069  umn it will be i
+0008de20: 676e 6f72 6564 210d 0a20 2020 2061 6767  gnored!..    agg
+0008de30: 5f74 7970 6520 6361 6e20 6265 2061 6e79  _type can be any
+0008de40: 206e 756d 7079 2066 756e 6374 696f 6e20   numpy function 
+0008de50: 7375 6368 2061 7320 6d65 616e 2c20 6d65  such as mean, me
+0008de60: 6469 616e 2c20 7375 6d2c 2063 6f75 6e74  dian, sum, count
+0008de70: 2c20 6574 632e 0d0a 2020 2020 2323 2323  , etc...    ####
+0008de80: 2323 2323 2323 2323 2323 2323 2323 2323  ################
+0008de90: 2323 2323 2323 2323 2323 2323 2323 2323  ################
+0008dea0: 2323 2323 2323 2323 2323 2323 2323 2323  ################
+0008deb0: 2323 2323 2323 2323 2323 2323 2323 2323  ################
+0008dec0: 2323 2323 2323 2323 2323 2323 2323 2323  ################
+0008ded0: 2323 2323 2323 2323 2323 2323 2323 2323  ################
+0008dee0: 2323 2323 2323 0d0a 2020 2020 5265 7475  ######..    Retu
+0008def0: 726e 733a 2061 2073 6d61 6c6c 6572 2064  rns: a smaller d
+0008df00: 6174 6166 7261 6d65 2077 6974 6820 726f  ataframe with ro
+0008df10: 7773 2067 726f 7570 6564 2062 7920 6772  ws grouped by gr
+0008df20: 6f75 7062 795f 636f 6c75 6d6e 7320 616e  oupby_columns an
+0008df30: 6420 6167 6772 6567 6174 6564 2066 6f72  d aggregated for
+0008df40: 2074 6865 206e 756d 6572 6963 5f63 6f6c   the numeric_col
+0008df50: 756d 6e0d 0a20 2020 2022 2222 0d0a 2020  umn..    """..  
+0008df60: 2020 7374 6172 745f 7469 6d65 203d 2074    start_time = t
+0008df70: 696d 652e 7469 6d65 2829 0d0a 2020 2020  ime.time()..    
+0008df80: 6772 6f75 7065 645f 7365 7020 3d20 7064  grouped_sep = pd
+0008df90: 2e44 6174 6146 7261 6d65 2829 0d0a 2020  .DataFrame()..  
+0008dfa0: 2020 7072 696e 7428 2741 7574 6f76 696d    print('Autovim
+0008dfb0: 6c20 4665 6174 7572 6520 456e 6769 6e65  l Feature Engine
+0008dfc0: 6572 696e 673a 2063 7265 6174 696e 6720  ering: creating 
+0008dfd0: 6772 6f75 7062 7920 6665 6174 7572 6573  groupby features
+0008dfe0: 2075 7369 6e67 2025 7327 2025 6772 6f75   using %s' %grou
+0008dff0: 7062 795f 636f 6c75 6d6e 7329 0d0a 2020  pby_columns)..  
+0008e000: 2020 2323 2323 2323 2323 2323 2020 5468    ##########  Th
+0008e010: 6973 2069 7320 7768 6572 6520 7765 2063  is is where we c
+0008e020: 7265 6174 6520 6e65 7720 636f 6c75 6d6e  reate new column
+0008e030: 7320 6279 2065 6163 6820 6e75 6d65 7269  s by each numeri
+0008e040: 6320 636f 6c75 6d6e 2067 726f 7570 6564  c column grouped
+0008e050: 2062 7920 6772 6f75 702d 6279 2063 6f6c   by group-by col
+0008e060: 756d 6e73 2067 6976 656e 2e0d 0a20 2020  umns given...   
+0008e070: 2069 6620 6973 696e 7374 616e 6365 286e   if isinstance(n
+0008e080: 756d 6572 6963 5f63 6f6c 756d 6e73 2c20  umeric_columns, 
+0008e090: 6c69 7374 293a 0d0a 2020 2020 2020 2020  list):..        
+0008e0a0: 7061 7373 0d0a 2020 2020 656c 6966 2069  pass..    elif i
+0008e0b0: 7369 6e73 7461 6e63 6528 6e75 6d65 7269  sinstance(numeri
+0008e0c0: 635f 636f 6c75 6d6e 2c20 7374 7229 3a0d  c_column, str):.
+0008e0d0: 0a20 2020 2020 2020 206e 756d 6572 6963  .        numeric
+0008e0e0: 5f63 6f6c 756d 6e73 203d 205b 6e75 6d65  _columns = [nume
+0008e0f0: 7269 635f 636f 6c75 6d6e 735d 0d0a 2020  ric_columns]..  
+0008e100: 2020 656c 7365 3a0d 0a20 2020 2020 2020    else:..       
+0008e110: 2070 7269 6e74 2827 2020 2020 4e75 6d65   print('    Nume
+0008e120: 7269 6320 636f 6c75 6d6e 206d 7573 7420  ric column must 
+0008e130: 6265 2061 2073 7472 696e 6720 6e6f 7420  be a string not 
+0008e140: 6120 6e75 6d62 6572 2054 7279 2061 6761  a number Try aga
+0008e150: 696e 2729 0d0a 2020 2020 2020 2020 7265  in')..        re
+0008e160: 7475 726e 2070 642e 4461 7461 4672 616d  turn pd.DataFram
+0008e170: 6528 290d 0a20 2020 2067 726f 7570 6564  e()..    grouped
+0008e180: 5f6c 6973 7420 3d20 7064 2e44 6174 6146  _list = pd.DataF
+0008e190: 7261 6d65 2829 0d0a 2020 2020 666f 7220  rame()..    for 
+0008e1a0: 6974 6572 6174 696f 6e2c 206e 756d 6572  iteration, numer
+0008e1b0: 6963 5f63 6f6c 756d 6e20 696e 207a 6970  ic_column in zip
+0008e1c0: 2872 616e 6765 286c 656e 286e 756d 6572  (range(len(numer
+0008e1d0: 6963 5f63 6f6c 756d 6e73 2929 2c6e 756d  ic_columns)),num
+0008e1e0: 6572 6963 5f63 6f6c 756d 6e73 293a 0d0a  eric_columns):..
+0008e1f0: 2020 2020 2020 2020 6772 6f75 7065 6420          grouped 
+0008e200: 3d20 6466 742e 6772 6f75 7062 7928 6772  = dft.groupby(gr
+0008e210: 6f75 7062 795f 636f 6c75 6d6e 7329 5b5b  oupby_columns)[[
+0008e220: 6e75 6d65 7269 635f 636f 6c75 6d6e 5d5d  numeric_column]]
+0008e230: 0d0a 2020 2020 2020 2020 7472 793a 0d0a  ..        try:..
+0008e240: 2020 2020 2020 2020 2020 2020 6167 675f              agg_
+0008e250: 7479 7065 203d 2061 6767 5f74 7970 6573  type = agg_types
+0008e260: 5b69 7465 7261 7469 6f6e 5d0d 0a20 2020  [iteration]..   
+0008e270: 2020 2020 2065 7863 6570 743a 0d0a 2020       except:..  
+0008e280: 2020 2020 2020 2020 2020 7072 696e 7428            print(
+0008e290: 2720 2020 204e 6f20 6167 6772 6567 6174  '    No aggregat
+0008e2a0: 696f 6e20 7479 7065 2067 6976 656e 2c20  ion type given, 
+0008e2b0: 6865 6e63 6520 6d65 616e 2069 7320 6368  hence mean is ch
+0008e2c0: 6f73 656e 2062 7920 6465 6661 756c 7427  osen by default'
+0008e2d0: 290d 0a20 2020 2020 2020 2020 2020 2061  )..            a
+0008e2e0: 6767 5f74 7970 6520 3d20 276d 6561 6e27  gg_type = 'mean'
+0008e2f0: 0d0a 2020 2020 2020 2020 7472 793a 0d0a  ..        try:..
+0008e300: 2020 2020 2020 2020 2020 2020 7072 6566              pref
+0008e310: 6978 203d 206e 756d 6572 6963 5f63 6f6c  ix = numeric_col
+0008e320: 756d 6e20 2b20 275f 270d 0a20 2020 2020  umn + '_'..     
+0008e330: 2020 2020 2020 2069 6620 6167 675f 7479         if agg_ty
+0008e340: 7065 2069 6e20 5b27 5375 6d27 2c20 2773  pe in ['Sum', 's
+0008e350: 756d 275d 3a0d 0a20 2020 2020 2020 2020  um']:..         
+0008e360: 2020 2020 2020 2067 726f 7570 6564 5f61         grouped_a
+0008e370: 6767 203d 2067 726f 7570 6564 2e73 756d  gg = grouped.sum
+0008e380: 2829 0d0a 2020 2020 2020 2020 2020 2020  ()..            
+0008e390: 656c 6966 2061 6767 5f74 7970 6520 696e  elif agg_type in
+0008e3a0: 205b 274d 6561 6e27 2c20 276d 6561 6e27   ['Mean', 'mean'
+0008e3b0: 2c27 4176 6572 6167 6527 2c27 6176 6572  ,'Average','aver
+0008e3c0: 6167 6527 5d3a 0d0a 2020 2020 2020 2020  age']:..        
+0008e3d0: 2020 2020 2020 2020 6772 6f75 7065 645f          grouped_
+0008e3e0: 6167 6720 3d20 6772 6f75 7065 642e 6d65  agg = grouped.me
+0008e3f0: 616e 2829 0d0a 2020 2020 2020 2020 2020  an()..          
+0008e400: 2020 656c 6966 2061 6767 5f74 7970 6520    elif agg_type 
+0008e410: 696e 205b 2763 6f75 6e74 272c 2027 436f  in ['count', 'Co
+0008e420: 756e 7427 5d3a 0d0a 2020 2020 2020 2020  unt']:..        
+0008e430: 2020 2020 2020 2020 6772 6f75 7065 645f          grouped_
+0008e440: 6167 6720 3d20 6772 6f75 7065 642e 636f  agg = grouped.co
+0008e450: 756e 7428 290d 0a20 2020 2020 2020 2020  unt()..         
+0008e460: 2020 2065 6c69 6620 6167 675f 7479 7065     elif agg_type
+0008e470: 2069 6e20 5b27 4d65 6469 616e 272c 2027   in ['Median', '
+0008e480: 6d65 6469 616e 275d 3a0d 0a20 2020 2020  median']:..     
+0008e490: 2020 2020 2020 2020 2020 2067 726f 7570             group
+0008e4a0: 6564 5f61 6767 203d 2067 726f 7570 6564  ed_agg = grouped
+0008e4b0: 2e6d 6564 6961 6e28 290d 0a20 2020 2020  .median()..     
+0008e4c0: 2020 2020 2020 2065 6c69 6620 6167 675f         elif agg_
+0008e4d0: 7479 7065 2069 6e20 5b27 4d61 7869 6d75  type in ['Maximu
+0008e4e0: 6d27 2c20 276d 6178 696d 756d 272c 276d  m', 'maximum','m
+0008e4f0: 6178 272c 2027 4d61 7827 5d3a 0d0a 2020  ax', 'Max']:..  
+0008e500: 2020 2020 2020 2020 2020 2020 2020 2323                ##
+0008e510: 206d 6178 696d 756d 206f 6620 7468 6520   maximum of the 
+0008e520: 616d 6f75 6e74 730d 0a20 2020 2020 2020  amounts..       
+0008e530: 2020 2020 2020 2020 2067 726f 7570 6564           grouped
+0008e540: 5f61 6767 203d 2067 726f 7570 6564 2e6d  _agg = grouped.m
+0008e550: 6178 2829 0d0a 2020 2020 2020 2020 2020  ax()..          
+0008e560: 2020 656c 6966 2061 6767 5f74 7970 6520    elif agg_type 
+0008e570: 696e 205b 274d 696e 696d 756d 272c 2027  in ['Minimum', '
+0008e580: 6d69 6e69 6d75 6d27 2c27 6d69 6e27 2c20  minimum','min', 
+0008e590: 274d 696e 275d 3a0d 0a20 2020 2020 2020  'Min']:..       
+0008e5a0: 2020 2020 2020 2020 2023 2320 6d61 7869           ## maxi
+0008e5b0: 6d75 6d20 6f66 2074 6865 2061 6d6f 756e  mum of the amoun
+0008e5c0: 7473 0d0a 2020 2020 2020 2020 2020 2020  ts..            
+0008e5d0: 2020 2020 6772 6f75 7065 645f 6167 6720      grouped_agg 
+0008e5e0: 3d20 6772 6f75 7065 642e 6d69 6e28 290d  = grouped.min().
+0008e5f0: 0a20 2020 2020 2020 2020 2020 2065 6c73  .            els
+0008e600: 653a 0d0a 2020 2020 2020 2020 2020 2020  e:..            
+0008e610: 2020 2020 6772 6f75 7065 645f 6167 6720      grouped_agg 
+0008e620: 3d20 6772 6f75 7065 642e 6d65 616e 2829  = grouped.mean()
+0008e630: 0d0a 2020 2020 2020 2020 2020 2020 6772  ..            gr
+0008e640: 6f75 7065 645f 7365 7020 3d20 6772 6f75  ouped_sep = grou
+0008e650: 7065 645f 6167 672e 756e 7374 6163 6b28  ped_agg.unstack(
+0008e660: 292e 6164 645f 7072 6566 6978 2870 7265  ).add_prefix(pre
+0008e670: 6669 7829 2e66 696c 6c6e 6128 3029 0d0a  fix).fillna(0)..
+0008e680: 2020 2020 2020 2020 6578 6365 7074 3a0d          except:.
+0008e690: 0a20 2020 2020 2020 2020 2020 2070 7269  .            pri
+0008e6a0: 6e74 2827 2020 2020 4572 726f 7220 696e  nt('    Error in
+0008e6b0: 2063 7265 6174 696e 6720 6772 6f75 7062   creating groupb
+0008e6c0: 7920 6665 6174 7572 6573 2e2e 2e72 6574  y features...ret
+0008e6d0: 7572 6e69 6e67 2077 6974 6820 6e75 6c6c  urning with null
+0008e6e0: 2064 6174 6166 7261 6d65 2729 0d0a 2020   dataframe')..  
+0008e6f0: 2020 2020 2020 2020 2020 6772 6f75 7065            groupe
+0008e700: 645f 7365 7020 3d20 7064 2e44 6174 6146  d_sep = pd.DataF
+0008e710: 7261 6d65 2829 0d0a 2020 2020 2020 2020  rame()..        
+0008e720: 6966 2069 7465 7261 7469 6f6e 203d 3d20  if iteration == 
+0008e730: 303a 0d0a 2020 2020 2020 2020 2020 2020  0:..            
+0008e740: 6772 6f75 7065 645f 6c69 7374 203d 2063  grouped_list = c
+0008e750: 6f70 792e 6465 6570 636f 7079 2867 726f  opy.deepcopy(gro
+0008e760: 7570 6564 5f73 6570 290d 0a20 2020 2020  uped_sep)..     
+0008e770: 2020 2065 6c73 653a 0d0a 2020 2020 2020     else:..      
+0008e780: 2020 2020 2020 6772 6f75 7065 645f 6c69        grouped_li
+0008e790: 7374 203d 2070 642e 636f 6e63 6174 285b  st = pd.concat([
+0008e7a0: 6772 6f75 7065 645f 6c69 7374 2c67 726f  grouped_list,gro
+0008e7b0: 7570 6564 5f73 6570 5d2c 6178 6973 3d31  uped_sep],axis=1
+0008e7c0: 290d 0a20 2020 2020 2020 2070 7269 6e74  )..        print
+0008e7d0: 2827 2020 2020 4166 7465 7220 6772 6f75  ('    After grou
+0008e7e0: 7065 6420 6665 6174 7572 6573 2061 6464  ped features add
+0008e7f0: 6564 2062 7920 2573 2c20 6e75 6d62 6572  ed by %s, number
+0008e800: 206f 6620 636f 6c75 6d6e 7320 3d20 2564   of columns = %d
+0008e810: 2720 2528 6e75 6d65 7269 635f 636f 6c75  ' %(numeric_colu
+0008e820: 6d6e 2c20 6772 6f75 7065 645f 6c69 7374  mn, grouped_list
+0008e830: 2e73 6861 7065 5b31 5d29 290d 0a20 2020  .shape[1]))..   
+0008e840: 2023 2323 2320 6f6e 6365 2065 7665 7279   #### once every
+0008e850: 7468 696e 6720 6973 2064 6f6e 652c 2079  thing is done, y
+0008e860: 6f75 2063 616e 2063 6c6f 7365 2069 7420  ou can close it 
+0008e870: 6865 7265 0d0a 2020 2020 7072 696e 7428  here..    print(
+0008e880: 2754 696d 6520 7461 6b65 6e20 666f 7220  'Time taken for 
+0008e890: 6372 6561 7469 6f6e 206f 6620 6772 6f75  creation of grou
+0008e8a0: 7062 7920 6665 6174 7572 6573 2028 696e  pby features (in
+0008e8b0: 2073 6563 6f6e 6473 2920 3d20 2530 2e30   seconds) = %0.0
+0008e8c0: 6627 2025 2874 696d 652e 7469 6d65 2829  f' %(time.time()
+0008e8d0: 2d73 7461 7274 5f74 696d 6529 290d 0a20  -start_time)).. 
+0008e8e0: 2020 2074 7279 3a0d 0a20 2020 2020 2020     try:..       
+0008e8f0: 2067 726f 7570 6564 5f6c 6973 742e 636f   grouped_list.co
+0008e900: 6c75 6d6e 7320 3d20 6772 6f75 7065 645f  lumns = grouped_
+0008e910: 6c69 7374 2e63 6f6c 756d 6e73 2e67 6574  list.columns.get
+0008e920: 5f6c 6576 656c 5f76 616c 7565 7328 3129  _level_values(1)
+0008e930: 0d0a 2020 2020 2020 2020 6772 6f75 7065  ..        groupe
+0008e940: 645f 6c69 7374 2e63 6f6c 756d 6e73 2e6e  d_list.columns.n
+0008e950: 616d 6520 3d20 4e6f 6e65 2023 2320 6d61  ame = None ## ma
+0008e960: 6b65 2073 7572 6520 7468 6520 6e61 6d65  ke sure the name
+0008e970: 206f 6e20 636f 6c75 6d6e 7320 6973 2072   on columns is r
+0008e980: 656d 6f76 6564 0d0a 2020 2020 2020 2020  emoved..        
+0008e990: 6772 6f75 7065 645f 6c69 7374 203d 2067  grouped_list = g
+0008e9a0: 726f 7570 6564 5f6c 6973 742e 7265 7365  rouped_list.rese
+0008e9b0: 745f 696e 6465 7828 2920 2323 206d 616b  t_index() ## mak
+0008e9c0: 6520 7375 7265 2074 6865 2049 4420 636f  e sure the ID co
+0008e9d0: 6c75 6d6e 2063 6f6d 6573 2062 6163 6b0d  lumn comes back.
+0008e9e0: 0a20 2020 2065 7863 6570 743a 0d0a 2020  .    except:..  
+0008e9f0: 2020 2020 2020 7072 696e 7428 2720 2020        print('   
+0008ea00: 4572 726f 7220 696e 2073 6574 7469 6e67  Error in setting
+0008ea10: 2063 6f6c 756d 6e20 6e61 6d65 732e 2050   column names. P
+0008ea20: 6c65 6173 6520 7265 7365 7420 636f 6c75  lease reset colu
+0008ea30: 6d6e 206e 616d 6573 2061 6674 6572 2074  mn names after t
+0008ea40: 6869 7320 7374 6570 2e2e 2e27 290d 0a20  his step...').. 
+0008ea50: 2020 2072 6574 7572 6e20 6772 6f75 7065     return groupe
+0008ea60: 645f 6c69 7374 0d0a 2323 2323 2323 2323  d_list..########
 0008ea70: 2323 2323 2323 2323 2323 2323 2323 2323  ################
 0008ea80: 2323 2323 2323 2323 2323 2323 2323 2323  ################
 0008ea90: 2323 2323 2323 2323 2323 2323 2323 2323  ################
-0008eaa0: 2323 2323 2323 2323 2323 2323 230d 0a23  #############..#
-0008eab0: 2323 2320 5468 6520 7761 726e 696e 6773  ### The warnings
-0008eac0: 2066 726f 6d20 536b 6c65 6172 6e20 6172   from Sklearn ar
-0008ead0: 6520 736f 2061 6e6e 6f79 696e 6720 7468  e so annoying th
-0008eae0: 6174 2049 2068 6176 6520 746f 2073 6875  at I have to shu
-0008eaf0: 7420 6974 206f 6666 2023 2323 2323 2323  t it off #######
-0008eb00: 0d0a 696d 706f 7274 2077 6172 6e69 6e67  ..import warning
-0008eb10: 730d 0a77 6172 6e69 6e67 732e 6669 6c74  s..warnings.filt
-0008eb20: 6572 7761 726e 696e 6773 2822 6967 6e6f  erwarnings("igno
-0008eb30: 7265 2229 0d0a 6672 6f6d 2073 6b6c 6561  re")..from sklea
-0008eb40: 726e 2e65 7863 6570 7469 6f6e 7320 696d  rn.exceptions im
-0008eb50: 706f 7274 2044 6174 6143 6f6e 7665 7273  port DataConvers
-0008eb60: 696f 6e57 6172 6e69 6e67 0d0a 7761 726e  ionWarning..warn
-0008eb70: 696e 6773 2e66 696c 7465 7277 6172 6e69  ings.filterwarni
-0008eb80: 6e67 7328 6163 7469 6f6e 3d27 6967 6e6f  ngs(action='igno
-0008eb90: 7265 272c 2063 6174 6567 6f72 793d 4461  re', category=Da
-0008eba0: 7461 436f 6e76 6572 7369 6f6e 5761 726e  taConversionWarn
-0008ebb0: 696e 6729 0d0a 6465 6620 7761 726e 282a  ing)..def warn(*
-0008ebc0: 6172 6773 2c20 2a2a 6b77 6172 6773 293a  args, **kwargs):
-0008ebd0: 0d0a 2020 2020 7061 7373 0d0a 7761 726e  ..    pass..warn
-0008ebe0: 696e 6773 2e77 6172 6e20 3d20 7761 726e  ings.warn = warn
-0008ebf0: 0d0a 696d 706f 7274 206c 6f67 6769 6e67  ..import logging
-0008ec00: 0d0a 2323 2323 2323 2323 2323 2323 2323  ..##############
-0008ec10: 2323 2323 2323 2323 2323 2323 2323 2323  ################
-0008ec20: 2323 2323 2323 2323 2323 2323 2323 2323  ################
-0008ec30: 2323 2323 2323 2323 2323 2323 2323 2323  ################
-0008ec40: 2323 2323 2323 2323 2323 2323 2323 2323  ################
-0008ec50: 2323 2323 2323 0d0a 696d 706f 7274 2070  ######..import p
-0008ec60: 6462 0d0a 696d 706f 7274 2063 6f70 790d  db..import copy.
-0008ec70: 0a69 6d70 6f72 7420 7469 6d65 0d0a 6672  .import time..fr
-0008ec80: 6f6d 2073 6b6c 6561 726e 2e66 6561 7475  om sklearn.featu
-0008ec90: 7265 5f73 656c 6563 7469 6f6e 2069 6d70  re_selection imp
-0008eca0: 6f72 7420 6368 6932 2c20 6d75 7475 616c  ort chi2, mutual
-0008ecb0: 5f69 6e66 6f5f 7265 6772 6573 7369 6f6e  _info_regression
-0008ecc0: 2c20 6d75 7475 616c 5f69 6e66 6f5f 636c  , mutual_info_cl
-0008ecd0: 6173 7369 660d 0a66 726f 6d20 736b 6c65  assif..from skle
-0008ece0: 6172 6e2e 6665 6174 7572 655f 7365 6c65  arn.feature_sele
-0008ecf0: 6374 696f 6e20 696d 706f 7274 2053 656c  ction import Sel
-0008ed00: 6563 744b 4265 7374 0d0a 6672 6f6d 2069  ectKBest..from i
-0008ed10: 7465 7274 6f6f 6c73 2069 6d70 6f72 7420  tertools import 
-0008ed20: 636f 6d62 696e 6174 696f 6e73 0d0a 696d  combinations..im
-0008ed30: 706f 7274 206d 6174 706c 6f74 6c69 622e  port matplotlib.
-0008ed40: 7061 7463 6865 7320 6173 206d 7061 7463  patches as mpatc
-0008ed50: 6865 730d 0a69 6d70 6f72 7420 6d61 7470  hes..import matp
-0008ed60: 6c6f 746c 6962 2e70 7970 6c6f 7420 6173  lotlib.pyplot as
-0008ed70: 2070 6c74 0d0a 6672 6f6d 2063 6f6c 6c65   plt..from colle
-0008ed80: 6374 696f 6e73 2069 6d70 6f72 7420 6465  ctions import de
-0008ed90: 6661 756c 7464 6963 740d 0a66 726f 6d20  faultdict..from 
-0008eda0: 636f 6c6c 6563 7469 6f6e 7320 696d 706f  collections impo
-0008edb0: 7274 204f 7264 6572 6564 4469 6374 0d0a  rt OrderedDict..
-0008edc0: 696d 706f 7274 2074 696d 650d 0a23 2323  import time..###
-0008edd0: 2323 2323 2323 2323 2323 2323 2323 2323  ################
-0008ede0: 2323 2323 2323 2323 2323 2323 2323 2323  ################
-0008edf0: 2323 2323 2323 2323 2323 2323 2323 2323  ################
-0008ee00: 2323 2323 2323 2323 2323 2323 2323 2323  ################
-0008ee10: 2323 2323 2323 2323 2323 2323 2323 2323  ################
-0008ee20: 2323 2323 2323 2323 2323 2323 2323 0d0a  ##############..
-0008ee30: 6465 6620 6c65 6674 5f73 7562 7472 6163  def left_subtrac
-0008ee40: 7428 6c31 2c6c 3229 3a0d 0a20 2020 206c  t(l1,l2):..    l
-0008ee50: 7374 203d 205b 5d0d 0a20 2020 2066 6f72  st = []..    for
-0008ee60: 2069 2069 6e20 6c31 3a0d 0a20 2020 2020   i in l1:..     
-0008ee70: 2020 2069 6620 6920 6e6f 7420 696e 206c     if i not in l
-0008ee80: 323a 0d0a 2020 2020 2020 2020 2020 2020  2:..            
-0008ee90: 6c73 742e 6170 7065 6e64 2869 290d 0a20  lst.append(i).. 
-0008eea0: 2020 2072 6574 7572 6e20 6c73 740d 0a23     return lst..#
-0008eeb0: 2323 2323 2323 2323 2323 2323 2323 2323  ################
-0008eec0: 2323 2323 2323 2323 2323 2323 2323 2323  ################
-0008eed0: 2323 2323 2323 2323 2323 2323 2323 2323  ################
-0008eee0: 2323 2323 2323 2323 2323 2323 2323 2323  ################
-0008eef0: 2323 2323 2323 2323 2323 2323 2323 2323  ################
-0008ef00: 0d0a 6465 6620 7265 7475 726e 5f64 6963  ..def return_dic
-0008ef10: 7469 6f6e 6172 795f 6c69 7374 286c 7374  tionary_list(lst
-0008ef20: 5f6f 665f 7475 706c 6573 293a 0d0a 2020  _of_tuples):..  
-0008ef30: 2020 2222 2220 5265 7475 726e 7320 6120    """ Returns a 
-0008ef40: 6469 6374 696f 6e61 7279 206f 6620 6c69  dictionary of li
-0008ef50: 7374 7320 6966 2079 6f75 2073 656e 6420  sts if you send 
-0008ef60: 696e 2061 206c 6973 7420 6f66 2054 7570  in a list of Tup
-0008ef70: 6c65 7322 2222 0d0a 2020 2020 6f72 4469  les"""..    orDi
-0008ef80: 6374 203d 2064 6566 6175 6c74 6469 6374  ct = defaultdict
-0008ef90: 286c 6973 7429 0d0a 2020 2020 2320 6974  (list)..    # it
-0008efa0: 6572 6174 696e 6720 6f76 6572 206c 6973  erating over lis
-0008efb0: 7420 6f66 2074 7570 6c65 730d 0a20 2020  t of tuples..   
-0008efc0: 2066 6f72 206b 6579 2c20 7661 6c20 696e   for key, val in
-0008efd0: 206c 7374 5f6f 665f 7475 706c 6573 3a0d   lst_of_tuples:.
-0008efe0: 0a20 2020 2020 2020 206f 7244 6963 745b  .        orDict[
-0008eff0: 6b65 795d 2e61 7070 656e 6428 7661 6c29  key].append(val)
-0008f000: 0d0a 2020 2020 7265 7475 726e 206f 7244  ..    return orD
-0008f010: 6963 740d 0a23 2323 2323 2323 2323 2323  ict..###########
-0008f020: 2323 2323 2323 2323 2323 2323 2323 2323  ################
-0008f030: 2323 2323 2323 2323 2323 2323 2323 2323  ################
-0008f040: 2323 2323 2323 2323 2323 2323 2323 2323  ################
-0008f050: 2323 2323 2323 2323 2323 2323 2323 2323  ################
-0008f060: 2323 2323 230d 0a64 6566 2066 696e 645f  #####..def find_
-0008f070: 7265 6d6f 7665 5f64 7570 6c69 6361 7465  remove_duplicate
-0008f080: 7328 6c69 7374 5f6f 665f 7661 6c75 6573  s(list_of_values
-0008f090: 293a 0d0a 2020 2020 2222 220d 0a20 2020  ):..    """..   
-0008f0a0: 2023 2052 656d 6f76 6573 2064 7570 6c69   # Removes dupli
-0008f0b0: 6361 7465 7320 6672 6f6d 2061 206c 6973  cates from a lis
-0008f0c0: 7420 746f 2072 6574 7572 6e20 756e 6971  t to return uniq
-0008f0d0: 7565 2076 616c 7565 7320 2d20 5553 4544  ue values - USED
-0008f0e0: 204f 4e4c 5920 4f4e 4345 0d0a 2020 2020   ONLY ONCE..    
-0008f0f0: 2222 220d 0a20 2020 206f 7574 7075 7420  """..    output 
-0008f100: 3d20 5b5d 0d0a 2020 2020 7365 656e 203d  = []..    seen =
-0008f110: 2073 6574 2829 0d0a 2020 2020 666f 7220   set()..    for 
-0008f120: 7661 6c75 6520 696e 206c 6973 745f 6f66  value in list_of
-0008f130: 5f76 616c 7565 733a 0d0a 2020 2020 2020  _values:..      
-0008f140: 2020 6966 2076 616c 7565 206e 6f74 2069    if value not i
-0008f150: 6e20 7365 656e 3a0d 0a20 2020 2020 2020  n seen:..       
-0008f160: 2020 2020 206f 7574 7075 742e 6170 7065       output.appe
-0008f170: 6e64 2876 616c 7565 290d 0a20 2020 2020  nd(value)..     
-0008f180: 2020 2020 2020 2073 6565 6e2e 6164 6428         seen.add(
-0008f190: 7661 6c75 6529 0d0a 2020 2020 7265 7475  value)..    retu
-0008f1a0: 726e 206f 7574 7075 740d 0a23 2323 2323  rn output..#####
-0008f1b0: 2323 2323 2323 2323 2323 2323 2323 2323  ################
-0008f1c0: 2323 2323 2323 2323 2323 2323 2323 2323  ################
-0008f1d0: 2323 2323 2323 2323 2323 2323 2323 2323  ################
-0008f1e0: 2323 2323 2323 2323 2323 2323 2323 2323  ################
-0008f1f0: 2323 2323 2323 2323 2323 2323 230d 0a64  #############..d
-0008f200: 6566 2046 455f 7265 6d6f 7665 5f76 6172  ef FE_remove_var
-0008f210: 6961 626c 6573 5f75 7369 6e67 5f53 554c  iables_using_SUL
-0008f220: 4f56 5f6d 6574 686f 6428 6466 2c20 7072  OV_method(df, pr
-0008f230: 6564 735f 696e 2c20 6d6f 6465 6c74 7970  eds_in, modeltyp
-0008f240: 652c 2074 6172 6765 742c 0d0a 2020 2020  e, target,..    
-0008f250: 2020 2020 2020 2020 2020 2020 2020 2020                  
-0008f260: 2020 2020 2020 2020 2020 2020 636f 7272              corr
-0008f270: 5f6c 696d 6974 203d 2030 2e37 302c 7665  _limit = 0.70,ve
-0008f280: 7262 6f73 653d 302c 2064 6173 6b5f 7867  rbose=0, dask_xg
-0008f290: 626f 6f73 745f 666c 6167 3d46 616c 7365  boost_flag=False
-0008f2a0: 293a 0d0a 2020 2020 2222 220d 0a20 2020  ):..    """..   
-0008f2b0: 2046 4520 7374 616e 6473 2066 6f72 2046   FE stands for F
-0008f2c0: 6561 7475 7265 2045 6e67 696e 6565 7269  eature Engineeri
-0008f2d0: 6e67 202d 2069 7420 6d65 616e 7320 7468  ng - it means th
-0008f2e0: 6973 2066 756e 6374 696f 6e20 7065 7266  is function perf
-0008f2f0: 6f72 6d73 2066 6561 7475 7265 2065 6e67  orms feature eng
-0008f300: 696e 6565 7269 6e67 0d0a 2020 2020 2323  ineering..    ##
-0008f310: 2323 2323 2323 2323 2323 2323 2323 2323  ################
-0008f320: 2323 2323 2323 2323 2323 2323 2323 2323  ################
-0008f330: 2323 2323 2323 2323 2323 2323 2323 2323  ################
-0008f340: 2323 2323 2323 2323 2323 2323 2323 2323  ################
-0008f350: 2323 2323 2323 2323 2323 2323 2323 2323  ################
-0008f360: 2323 2323 2323 2323 230d 0a20 2020 2023  #########..    #
-0008f370: 2323 2323 2020 2020 2020 2020 2020 2020  ####            
-0008f380: 2020 5355 4c4f 5620 7374 616e 6473 2066    SULOV stands f
-0008f390: 6f72 2053 6561 7263 6869 6e67 2055 6e63  or Searching Unc
-0008f3a0: 6f72 7265 6c61 7465 6420 4c69 7374 204f  orrelated List O
-0008f3b0: 6620 5661 7269 6162 6c65 7320 2023 2323  f Variables  ###
-0008f3c0: 2323 2323 2323 2323 2323 0d0a 2020 2020  ##########..    
-0008f3d0: 5468 6973 2068 6967 686c 7920 6566 6669  This highly effi
-0008f3e0: 6369 656e 7420 6d65 7468 6f64 2072 656d  cient method rem
-0008f3f0: 6f76 6573 2076 6172 6961 626c 6573 2074  oves variables t
-0008f400: 6861 7420 6172 6520 6869 6768 6c79 2063  hat are highly c
-0008f410: 6f72 7265 6c61 7465 6420 7573 696e 6720  orrelated using 
-0008f420: 6120 7365 7269 6573 206f 660d 0a20 2020  a series of..   
-0008f430: 2070 6169 722d 7769 7365 2063 6f72 7265   pair-wise corre
-0008f440: 6c61 7469 6f6e 206b 6e6f 636b 6f75 7420  lation knockout 
-0008f450: 726f 756e 6473 2e20 4974 2069 7320 6578  rounds. It is ex
-0008f460: 7472 656d 656c 7920 6661 7374 2061 6e64  tremely fast and
-0008f470: 2068 656e 6365 2063 616e 2077 6f72 6b20   hence can work 
-0008f480: 6f6e 2074 686f 7573 616e 6473 0d0a 2020  on thousands..  
-0008f490: 2020 6f66 2076 6172 6961 626c 6573 2069    of variables i
-0008f4a0: 6e20 6c65 7373 2074 6861 6e20 6120 6d69  n less than a mi
-0008f4b0: 6e75 7465 2c20 6576 656e 206f 6e20 6120  nute, even on a 
-0008f4c0: 6c61 7074 6f70 2e20 596f 7520 6e65 6564  laptop. You need
-0008f4d0: 2074 6f20 7365 6e64 2069 6e20 6120 6c69   to send in a li
-0008f4e0: 7374 206f 6620 6e75 6d65 7269 630d 0a20  st of numeric.. 
-0008f4f0: 2020 2076 6172 6961 626c 6573 2061 6e64     variables and
-0008f500: 2074 6861 7427 7320 616c 6c21 2054 6865   that's all! The
-0008f510: 206d 6574 686f 6420 6465 6669 6e65 7320   method defines 
-0008f520: 6869 6768 2043 6f72 7265 6c61 7469 6f6e  high Correlation
-0008f530: 2061 7320 616e 7974 6869 6e67 206f 7665   as anything ove
-0008f540: 7220 302e 3730 2028 6162 736f 6c75 7465  r 0.70 (absolute
-0008f550: 290d 0a20 2020 2062 7574 2074 6869 7320  )..    but this 
-0008f560: 6361 6e20 6265 2063 6861 6e67 6564 2e20  can be changed. 
-0008f570: 4966 2074 776f 2076 6172 6961 626c 6573  If two variables
-0008f580: 2068 6176 6520 6162 736f 6c75 7465 2063   have absolute c
-0008f590: 6f72 7265 6c61 7469 6f6e 2068 6967 6865  orrelation highe
-0008f5a0: 7220 7468 616e 2074 6869 732c 2074 6865  r than this, the
-0008f5b0: 790d 0a20 2020 2077 696c 6c20 6265 206d  y..    will be m
-0008f5c0: 6172 6b65 642c 2061 6e64 2075 7369 6e67  arked, and using
-0008f5d0: 2061 2070 726f 6365 7373 206f 6620 656c   a process of el
-0008f5e0: 696d 696e 6174 696f 6e2c 206f 6e65 206f  imination, one o
-0008f5f0: 6620 7468 656d 2077 696c 6c20 6765 7420  f them will get 
-0008f600: 6b6e 6f63 6b65 6420 6f75 743a 0d0a 2020  knocked out:..  
-0008f610: 2020 546f 2064 6563 6964 6520 6f72 6465    To decide orde
-0008f620: 7220 6f66 2076 6172 6961 626c 6573 2074  r of variables t
-0008f630: 6f20 6b65 6570 2c20 7765 2075 7365 206d  o keep, we use m
-0008f640: 7574 7561 696c 2069 6e66 6f72 6d61 7469  utuail informati
-0008f650: 6f6e 2073 636f 7265 2074 6f20 7365 6c65  on score to sele
-0008f660: 6374 2e20 4d49 5320 7265 7475 726e 730d  ct. MIS returns.
-0008f670: 0a20 2020 2061 2072 616e 6b65 6420 6c69  .    a ranked li
-0008f680: 7374 206f 6620 7468 6573 6520 636f 7272  st of these corr
-0008f690: 656c 6174 6564 2076 6172 6961 626c 6573  elated variables
-0008f6a0: 3a20 7768 656e 2077 6520 7365 6c65 6374  : when we select
-0008f6b0: 206f 6e65 2c20 7765 206b 6e6f 636b 206f   one, we knock o
-0008f6c0: 7574 206f 7468 6572 730d 0a20 2020 2074  ut others..    t
-0008f6d0: 6861 7420 6974 2069 7320 636f 7272 656c  hat it is correl
-0008f6e0: 6174 6564 2074 6f2e 2054 6865 6e20 7765  ated to. Then we
-0008f6f0: 2073 656c 6563 7420 6e65 7874 2076 6172   select next var
-0008f700: 2e20 5468 6973 2077 6179 2077 6520 6b6e  . This way we kn
-0008f710: 6f63 6b20 6f75 7420 636f 7272 656c 6174  ock out correlat
-0008f720: 6564 2076 6172 6961 626c 6573 2e0d 0a20  ed variables... 
-0008f730: 2020 2046 696e 616c 6c79 2077 6520 6172     Finally we ar
-0008f740: 6520 6c65 6674 2077 6974 6820 756e 636f  e left with unco
-0008f750: 7272 656c 6174 6564 2076 6172 6961 626c  rrelated variabl
-0008f760: 6573 2074 6861 7420 6172 6520 616c 736f  es that are also
-0008f770: 2068 6967 686c 7920 696d 706f 7274 616e   highly importan
-0008f780: 7420 696e 206d 7574 7561 6c20 7363 6f72  t in mutual scor
-0008f790: 652e 0d0a 2020 2020 2323 2323 2323 2323  e...    ########
-0008f7a0: 2020 594f 5520 4d55 5354 2049 4e43 4c55    YOU MUST INCLU
-0008f7b0: 4445 2054 4845 2041 424f 5645 204d 4553  DE THE ABOVE MES
-0008f7c0: 5341 4745 2049 4620 594f 5520 434f 5059  SAGE IF YOU COPY
-0008f7d0: 2054 4849 5320 434f 4445 2049 4e20 594f   THIS CODE IN YO
-0008f7e0: 5552 204c 4942 5241 5259 2023 2323 2323  UR LIBRARY #####
-0008f7f0: 2323 2323 230d 0a20 2020 2022 2222 0d0a  #####..    """..
-0008f800: 2020 2020 0d0a 2020 2020 6466 203d 2063      ..    df = c
-0008f810: 6f70 792e 6465 6570 636f 7079 2864 6629  opy.deepcopy(df)
-0008f820: 0d0a 2020 2020 6466 5f74 6172 6765 7420  ..    df_target 
-0008f830: 3d20 6466 5b74 6172 6765 745d 0d0a 2020  = df[target]..  
-0008f840: 2020 6e75 6d76 6172 7320 3d20 6466 5b70    numvars = df[p
-0008f850: 7265 6473 5f69 6e5d 2e73 656c 6563 745f  reds_in].select_
-0008f860: 6474 7970 6573 2869 6e63 6c75 6465 3d27  dtypes(include='
-0008f870: 666c 6f61 7427 292e 636f 6c75 6d6e 732e  float').columns.
-0008f880: 746f 6c69 7374 2829 0d0a 2020 2020 7265  tolist()..    re
-0008f890: 6d76 6172 7320 3d20 6c65 6674 5f73 7562  mvars = left_sub
-0008f8a0: 7472 6163 7428 7072 6564 735f 696e 2c20  tract(preds_in, 
-0008f8b0: 6e75 6d76 6172 7329 0d0a 2020 2020 6466  numvars)..    df
-0008f8c0: 203d 2064 665b 6e75 6d76 6172 735d 0d0a   = df[numvars]..
-0008f8d0: 2020 2020 2323 2320 666f 7220 736f 6d65      ### for some
-0008f8e0: 2072 6561 736f 6e2c 2064 6f69 6e67 2061   reason, doing a
-0008f8f0: 206d 6173 7320 6669 6c6c 6e61 206f 6620   mass fillna of 
-0008f900: 7661 7273 2064 6f65 736e 2774 2077 6f72  vars doesn't wor
-0008f910: 6b21 2048 656e 6365 2064 6f69 6e67 2069  k! Hence doing i
-0008f920: 7420 696e 6469 7669 6475 616c 6c79 210d  t individually!.
-0008f930: 0a20 2020 206e 756c 6c5f 7661 7273 203d  .    null_vars =
-0008f940: 206e 702e 6172 7261 7928 6e75 6d76 6172   np.array(numvar
-0008f950: 7329 5b64 662e 6973 6e75 6c6c 2829 2e73  s)[df.isnull().s
-0008f960: 756d 2829 3e30 5d0d 0a20 2020 2066 6f72  um()>0]..    for
-0008f970: 2065 6163 685f 6e75 6d20 696e 206e 756c   each_num in nul
-0008f980: 6c5f 7661 7273 3a0d 0a20 2020 2020 2020  l_vars:..       
-0008f990: 2023 2323 2052 656d 656d 6265 7220 7468   ### Remember th
-0008f9a0: 6174 2066 696c 6c6e 6120 6f6e 6c79 2077  at fillna only w
-0008f9b0: 6f72 6b73 2061 7420 7468 6520 6461 7461  orks at the data
-0008f9c0: 6672 616d 6520 6c65 7665 6c21 0d0a 2020  frame level!..  
-0008f9d0: 2020 2020 2020 6466 5b5b 6561 6368 5f6e        df[[each_n
-0008f9e0: 756d 5d5d 203d 2064 665b 5b65 6163 685f  um]] = df[[each_
-0008f9f0: 6e75 6d5d 5d2e 6669 6c6c 6e61 2830 290d  num]].fillna(0).
-0008fa00: 0a20 2020 2074 6172 6765 7420 3d20 636f  .    target = co
-0008fa10: 7079 2e64 6565 7063 6f70 7928 7461 7267  py.deepcopy(targ
-0008fa20: 6574 290d 0a0d 0a20 2020 2070 7269 6e74  et)....    print
-0008fa30: 2827 2323 2323 2323 2323 2323 2323 2323  ('##############
-0008fa40: 2323 2323 2323 2323 2323 2323 2323 2323  ################
-0008fa50: 2323 2323 2323 2323 2323 2323 2323 2323  ################
-0008fa60: 2323 2323 2323 2323 2323 2323 2323 2323  ################
-0008fa70: 2323 2323 2323 2323 2323 2323 2323 2323  ################
-0008fa80: 2323 2323 2323 2323 2327 290d 0a20 2020  #########')..   
-0008fa90: 2070 7269 6e74 2827 2323 2323 2320 2053   print('#####  S
-0008faa0: 554c 4f56 3a20 2053 6561 7263 6869 6e67  ULOV:  Searching
-0008fab0: 2066 6f72 2055 6e63 6f72 7265 6c61 7465   for Uncorrelate
-0008fac0: 6420 4c69 7374 204f 6620 5661 7269 6162  d List Of Variab
-0008fad0: 6c65 7320 696e 2025 7320 6665 6174 7572  les in %s featur
-0008fae0: 6573 2023 2323 2323 2323 2323 2323 2327  es ############'
-0008faf0: 2025 6c65 6e28 6e75 6d76 6172 7329 290d   %len(numvars)).
-0008fb00: 0a20 2020 2070 7269 6e74 2827 2323 2323  .    print('####
+0008eaa0: 2323 2323 2323 2323 2323 2323 2323 2323  ################
+0008eab0: 2323 2323 2323 2323 0000 0000 0000 0000  ########........
+0008eac0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+0008ead0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+0008eae0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+0008eaf0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+0008eb00: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+0008eb10: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+0008eb20: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+0008eb30: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+0008eb40: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+0008eb50: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+0008eb60: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+0008eb70: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+0008eb80: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+0008eb90: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+0008eba0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+0008ebb0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+0008ebc0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+0008ebd0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+0008ebe0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+0008ebf0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+0008ec00: 2e2f 2e2f 4050 6178 4865 6164 6572 0000  ././@PaxHeader..
+0008ec10: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+0008ec20: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+0008ec30: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+0008ec40: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+0008ec50: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+0008ec60: 0000 0000 3030 3030 3030 3000 3030 3030  ....0000000.0000
+0008ec70: 3030 3000 3030 3030 3030 3000 3030 3030  000.0000000.0000
+0008ec80: 3030 3030 3032 3600 3030 3030 3030 3030  0000026.00000000
+0008ec90: 3030 3000 3031 3134 3533 0020 7800 0000  000.011453. x...
+0008eca0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+0008ecb0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+0008ecc0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+0008ecd0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+0008ece0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+0008ecf0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+0008ed00: 0075 7374 6172 0030 3000 0000 0000 0000  .ustar.00.......
+0008ed10: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+0008ed20: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+0008ed30: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+0008ed40: 0000 0000 0000 0000 0030 3030 3030 3030  .........0000000
+0008ed50: 0030 3030 3030 3030 0000 0000 0000 0000  .0000000........
+0008ed60: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+0008ed70: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+0008ed80: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+0008ed90: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+0008eda0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+0008edb0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+0008edc0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+0008edd0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+0008ede0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+0008edf0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+0008ee00: 3232 206d 7469 6d65 3d31 3637 3831 3539  22 mtime=1678159
+0008ee10: 3732 322e 300a 0000 0000 0000 0000 0000  722.0...........
+0008ee20: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+0008ee30: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+0008ee40: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+0008ee50: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+0008ee60: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+0008ee70: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+0008ee80: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+0008ee90: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+0008eea0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+0008eeb0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+0008eec0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+0008eed0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+0008eee0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+0008eef0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+0008ef00: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+0008ef10: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+0008ef20: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+0008ef30: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+0008ef40: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+0008ef50: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+0008ef60: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+0008ef70: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+0008ef80: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+0008ef90: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+0008efa0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+0008efb0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+0008efc0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+0008efd0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+0008efe0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+0008eff0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+0008f000: 6175 746f 7669 6d6c 2d30 2e31 2e37 3135  autoviml-0.1.715
+0008f010: 2f61 7574 6f76 696d 6c2f 7375 6c6f 765f  /autoviml/sulov_
+0008f020: 6d65 7468 6f64 2e70 7900 0000 0000 0000  method.py.......
+0008f030: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+0008f040: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+0008f050: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+0008f060: 0000 0000 3030 3030 3737 3700 3030 3031  ....0000777.0001
+0008f070: 3735 3000 3030 3031 3735 3000 3030 3030  750.0001750.0000
+0008f080: 3030 3333 3234 3500 3030 3030 3030 3030  0033245.00000000
+0008f090: 3030 3000 3032 3030 3436 0020 3000 0000  000.020046. 0...
+0008f0a0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+0008f0b0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+0008f0c0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+0008f0d0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+0008f0e0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+0008f0f0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+0008f100: 0075 7374 6172 0030 3072 616d 0000 0000  .ustar.00ram....
+0008f110: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+0008f120: 0000 0000 0000 0000 0072 616d 0000 0000  .........ram....
+0008f130: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+0008f140: 0000 0000 0000 0000 0030 3030 3030 3030  .........0000000
+0008f150: 0030 3030 3030 3030 0000 0000 0000 0000  .0000000........
+0008f160: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+0008f170: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+0008f180: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+0008f190: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+0008f1a0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+0008f1b0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+0008f1c0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+0008f1d0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+0008f1e0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+0008f1f0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+0008f200: 696d 706f 7274 206e 756d 7079 2061 7320  import numpy as 
+0008f210: 6e70 0d0a 696d 706f 7274 2070 616e 6461  np..import panda
+0008f220: 7320 6173 2070 640d 0a69 6d70 6f72 7420  s as pd..import 
+0008f230: 7261 6e64 6f6d 0d0a 6e70 2e72 616e 646f  random..np.rando
+0008f240: 6d2e 7365 6564 2839 3929 0d0a 7261 6e64  m.seed(99)..rand
+0008f250: 6f6d 2e73 6565 6428 3432 290d 0a23 2323  om.seed(42)..###
+0008f260: 2323 2323 2323 2323 2323 2323 2323 2323  ################
+0008f270: 2323 2323 2323 2323 2323 2323 2323 2323  ################
+0008f280: 2323 2323 2323 2323 2323 2323 2323 2323  ################
+0008f290: 2323 2323 2323 2323 2323 2323 2323 2323  ################
+0008f2a0: 2323 2323 2323 2323 2323 2323 230d 0a23  #############..#
+0008f2b0: 2323 2320 5468 6520 7761 726e 696e 6773  ### The warnings
+0008f2c0: 2066 726f 6d20 536b 6c65 6172 6e20 6172   from Sklearn ar
+0008f2d0: 6520 736f 2061 6e6e 6f79 696e 6720 7468  e so annoying th
+0008f2e0: 6174 2049 2068 6176 6520 746f 2073 6875  at I have to shu
+0008f2f0: 7420 6974 206f 6666 2023 2323 2323 2323  t it off #######
+0008f300: 0d0a 696d 706f 7274 2077 6172 6e69 6e67  ..import warning
+0008f310: 730d 0a77 6172 6e69 6e67 732e 6669 6c74  s..warnings.filt
+0008f320: 6572 7761 726e 696e 6773 2822 6967 6e6f  erwarnings("igno
+0008f330: 7265 2229 0d0a 6672 6f6d 2073 6b6c 6561  re")..from sklea
+0008f340: 726e 2e65 7863 6570 7469 6f6e 7320 696d  rn.exceptions im
+0008f350: 706f 7274 2044 6174 6143 6f6e 7665 7273  port DataConvers
+0008f360: 696f 6e57 6172 6e69 6e67 0d0a 7761 726e  ionWarning..warn
+0008f370: 696e 6773 2e66 696c 7465 7277 6172 6e69  ings.filterwarni
+0008f380: 6e67 7328 6163 7469 6f6e 3d27 6967 6e6f  ngs(action='igno
+0008f390: 7265 272c 2063 6174 6567 6f72 793d 4461  re', category=Da
+0008f3a0: 7461 436f 6e76 6572 7369 6f6e 5761 726e  taConversionWarn
+0008f3b0: 696e 6729 0d0a 6465 6620 7761 726e 282a  ing)..def warn(*
+0008f3c0: 6172 6773 2c20 2a2a 6b77 6172 6773 293a  args, **kwargs):
+0008f3d0: 0d0a 2020 2020 7061 7373 0d0a 7761 726e  ..    pass..warn
+0008f3e0: 696e 6773 2e77 6172 6e20 3d20 7761 726e  ings.warn = warn
+0008f3f0: 0d0a 696d 706f 7274 206c 6f67 6769 6e67  ..import logging
+0008f400: 0d0a 2323 2323 2323 2323 2323 2323 2323  ..##############
+0008f410: 2323 2323 2323 2323 2323 2323 2323 2323  ################
+0008f420: 2323 2323 2323 2323 2323 2323 2323 2323  ################
+0008f430: 2323 2323 2323 2323 2323 2323 2323 2323  ################
+0008f440: 2323 2323 2323 2323 2323 2323 2323 2323  ################
+0008f450: 2323 2323 2323 0d0a 696d 706f 7274 2070  ######..import p
+0008f460: 6462 0d0a 696d 706f 7274 2063 6f70 790d  db..import copy.
+0008f470: 0a69 6d70 6f72 7420 7469 6d65 0d0a 6672  .import time..fr
+0008f480: 6f6d 2073 6b6c 6561 726e 2e66 6561 7475  om sklearn.featu
+0008f490: 7265 5f73 656c 6563 7469 6f6e 2069 6d70  re_selection imp
+0008f4a0: 6f72 7420 6368 6932 2c20 6d75 7475 616c  ort chi2, mutual
+0008f4b0: 5f69 6e66 6f5f 7265 6772 6573 7369 6f6e  _info_regression
+0008f4c0: 2c20 6d75 7475 616c 5f69 6e66 6f5f 636c  , mutual_info_cl
+0008f4d0: 6173 7369 660d 0a66 726f 6d20 736b 6c65  assif..from skle
+0008f4e0: 6172 6e2e 6665 6174 7572 655f 7365 6c65  arn.feature_sele
+0008f4f0: 6374 696f 6e20 696d 706f 7274 2053 656c  ction import Sel
+0008f500: 6563 744b 4265 7374 0d0a 6672 6f6d 2069  ectKBest..from i
+0008f510: 7465 7274 6f6f 6c73 2069 6d70 6f72 7420  tertools import 
+0008f520: 636f 6d62 696e 6174 696f 6e73 0d0a 696d  combinations..im
+0008f530: 706f 7274 206d 6174 706c 6f74 6c69 622e  port matplotlib.
+0008f540: 7061 7463 6865 7320 6173 206d 7061 7463  patches as mpatc
+0008f550: 6865 730d 0a69 6d70 6f72 7420 6d61 7470  hes..import matp
+0008f560: 6c6f 746c 6962 2e70 7970 6c6f 7420 6173  lotlib.pyplot as
+0008f570: 2070 6c74 0d0a 6672 6f6d 2063 6f6c 6c65   plt..from colle
+0008f580: 6374 696f 6e73 2069 6d70 6f72 7420 6465  ctions import de
+0008f590: 6661 756c 7464 6963 740d 0a66 726f 6d20  faultdict..from 
+0008f5a0: 636f 6c6c 6563 7469 6f6e 7320 696d 706f  collections impo
+0008f5b0: 7274 204f 7264 6572 6564 4469 6374 0d0a  rt OrderedDict..
+0008f5c0: 696d 706f 7274 2074 696d 650d 0a23 2323  import time..###
+0008f5d0: 2323 2323 2323 2323 2323 2323 2323 2323  ################
+0008f5e0: 2323 2323 2323 2323 2323 2323 2323 2323  ################
+0008f5f0: 2323 2323 2323 2323 2323 2323 2323 2323  ################
+0008f600: 2323 2323 2323 2323 2323 2323 2323 2323  ################
+0008f610: 2323 2323 2323 2323 2323 2323 2323 2323  ################
+0008f620: 2323 2323 2323 2323 2323 2323 2323 0d0a  ##############..
+0008f630: 6465 6620 6c65 6674 5f73 7562 7472 6163  def left_subtrac
+0008f640: 7428 6c31 2c6c 3229 3a0d 0a20 2020 206c  t(l1,l2):..    l
+0008f650: 7374 203d 205b 5d0d 0a20 2020 2066 6f72  st = []..    for
+0008f660: 2069 2069 6e20 6c31 3a0d 0a20 2020 2020   i in l1:..     
+0008f670: 2020 2069 6620 6920 6e6f 7420 696e 206c     if i not in l
+0008f680: 323a 0d0a 2020 2020 2020 2020 2020 2020  2:..            
+0008f690: 6c73 742e 6170 7065 6e64 2869 290d 0a20  lst.append(i).. 
+0008f6a0: 2020 2072 6574 7572 6e20 6c73 740d 0a23     return lst..#
+0008f6b0: 2323 2323 2323 2323 2323 2323 2323 2323  ################
+0008f6c0: 2323 2323 2323 2323 2323 2323 2323 2323  ################
+0008f6d0: 2323 2323 2323 2323 2323 2323 2323 2323  ################
+0008f6e0: 2323 2323 2323 2323 2323 2323 2323 2323  ################
+0008f6f0: 2323 2323 2323 2323 2323 2323 2323 2323  ################
+0008f700: 0d0a 6465 6620 7265 7475 726e 5f64 6963  ..def return_dic
+0008f710: 7469 6f6e 6172 795f 6c69 7374 286c 7374  tionary_list(lst
+0008f720: 5f6f 665f 7475 706c 6573 293a 0d0a 2020  _of_tuples):..  
+0008f730: 2020 2222 2220 5265 7475 726e 7320 6120    """ Returns a 
+0008f740: 6469 6374 696f 6e61 7279 206f 6620 6c69  dictionary of li
+0008f750: 7374 7320 6966 2079 6f75 2073 656e 6420  sts if you send 
+0008f760: 696e 2061 206c 6973 7420 6f66 2054 7570  in a list of Tup
+0008f770: 6c65 7322 2222 0d0a 2020 2020 6f72 4469  les"""..    orDi
+0008f780: 6374 203d 2064 6566 6175 6c74 6469 6374  ct = defaultdict
+0008f790: 286c 6973 7429 0d0a 2020 2020 2320 6974  (list)..    # it
+0008f7a0: 6572 6174 696e 6720 6f76 6572 206c 6973  erating over lis
+0008f7b0: 7420 6f66 2074 7570 6c65 730d 0a20 2020  t of tuples..   
+0008f7c0: 2066 6f72 206b 6579 2c20 7661 6c20 696e   for key, val in
+0008f7d0: 206c 7374 5f6f 665f 7475 706c 6573 3a0d   lst_of_tuples:.
+0008f7e0: 0a20 2020 2020 2020 206f 7244 6963 745b  .        orDict[
+0008f7f0: 6b65 795d 2e61 7070 656e 6428 7661 6c29  key].append(val)
+0008f800: 0d0a 2020 2020 7265 7475 726e 206f 7244  ..    return orD
+0008f810: 6963 740d 0a23 2323 2323 2323 2323 2323  ict..###########
+0008f820: 2323 2323 2323 2323 2323 2323 2323 2323  ################
+0008f830: 2323 2323 2323 2323 2323 2323 2323 2323  ################
+0008f840: 2323 2323 2323 2323 2323 2323 2323 2323  ################
+0008f850: 2323 2323 2323 2323 2323 2323 2323 2323  ################
+0008f860: 2323 2323 230d 0a64 6566 2066 696e 645f  #####..def find_
+0008f870: 7265 6d6f 7665 5f64 7570 6c69 6361 7465  remove_duplicate
+0008f880: 7328 6c69 7374 5f6f 665f 7661 6c75 6573  s(list_of_values
+0008f890: 293a 0d0a 2020 2020 2222 220d 0a20 2020  ):..    """..   
+0008f8a0: 2023 2052 656d 6f76 6573 2064 7570 6c69   # Removes dupli
+0008f8b0: 6361 7465 7320 6672 6f6d 2061 206c 6973  cates from a lis
+0008f8c0: 7420 746f 2072 6574 7572 6e20 756e 6971  t to return uniq
+0008f8d0: 7565 2076 616c 7565 7320 2d20 5553 4544  ue values - USED
+0008f8e0: 204f 4e4c 5920 4f4e 4345 0d0a 2020 2020   ONLY ONCE..    
+0008f8f0: 2222 220d 0a20 2020 206f 7574 7075 7420  """..    output 
+0008f900: 3d20 5b5d 0d0a 2020 2020 7365 656e 203d  = []..    seen =
+0008f910: 2073 6574 2829 0d0a 2020 2020 666f 7220   set()..    for 
+0008f920: 7661 6c75 6520 696e 206c 6973 745f 6f66  value in list_of
+0008f930: 5f76 616c 7565 733a 0d0a 2020 2020 2020  _values:..      
+0008f940: 2020 6966 2076 616c 7565 206e 6f74 2069    if value not i
+0008f950: 6e20 7365 656e 3a0d 0a20 2020 2020 2020  n seen:..       
+0008f960: 2020 2020 206f 7574 7075 742e 6170 7065       output.appe
+0008f970: 6e64 2876 616c 7565 290d 0a20 2020 2020  nd(value)..     
+0008f980: 2020 2020 2020 2073 6565 6e2e 6164 6428         seen.add(
+0008f990: 7661 6c75 6529 0d0a 2020 2020 7265 7475  value)..    retu
+0008f9a0: 726e 206f 7574 7075 740d 0a23 2323 2323  rn output..#####
+0008f9b0: 2323 2323 2323 2323 2323 2323 2323 2323  ################
+0008f9c0: 2323 2323 2323 2323 2323 2323 2323 2323  ################
+0008f9d0: 2323 2323 2323 2323 2323 2323 2323 2323  ################
+0008f9e0: 2323 2323 2323 2323 2323 2323 2323 2323  ################
+0008f9f0: 2323 2323 2323 2323 2323 2323 230d 0a64  #############..d
+0008fa00: 6566 2046 455f 7265 6d6f 7665 5f76 6172  ef FE_remove_var
+0008fa10: 6961 626c 6573 5f75 7369 6e67 5f53 554c  iables_using_SUL
+0008fa20: 4f56 5f6d 6574 686f 6428 6466 2c20 7072  OV_method(df, pr
+0008fa30: 6564 735f 696e 2c20 6d6f 6465 6c74 7970  eds_in, modeltyp
+0008fa40: 652c 2074 6172 6765 742c 0d0a 2020 2020  e, target,..    
+0008fa50: 2020 2020 2020 2020 2020 2020 2020 2020                  
+0008fa60: 2020 2020 2020 2020 2020 2020 636f 7272              corr
+0008fa70: 5f6c 696d 6974 203d 2030 2e37 302c 7665  _limit = 0.70,ve
+0008fa80: 7262 6f73 653d 302c 2064 6173 6b5f 7867  rbose=0, dask_xg
+0008fa90: 626f 6f73 745f 666c 6167 3d46 616c 7365  boost_flag=False
+0008faa0: 293a 0d0a 2020 2020 2222 220d 0a20 2020  ):..    """..   
+0008fab0: 2046 4520 7374 616e 6473 2066 6f72 2046   FE stands for F
+0008fac0: 6561 7475 7265 2045 6e67 696e 6565 7269  eature Engineeri
+0008fad0: 6e67 202d 2069 7420 6d65 616e 7320 7468  ng - it means th
+0008fae0: 6973 2066 756e 6374 696f 6e20 7065 7266  is function perf
+0008faf0: 6f72 6d73 2066 6561 7475 7265 2065 6e67  orms feature eng
+0008fb00: 696e 6565 7269 6e67 0d0a 2020 2020 2323  ineering..    ##
 0008fb10: 2323 2323 2323 2323 2323 2323 2323 2323  ################
 0008fb20: 2323 2323 2323 2323 2323 2323 2323 2323  ################
 0008fb30: 2323 2323 2323 2323 2323 2323 2323 2323  ################
 0008fb40: 2323 2323 2323 2323 2323 2323 2323 2323  ################
 0008fb50: 2323 2323 2323 2323 2323 2323 2323 2323  ################
-0008fb60: 2323 2327 290d 0a20 2020 2023 2323 2054  ###')..    ### T
-0008fb70: 6869 7320 6973 2061 2073 686f 7274 6572  his is a shorter
-0008fb80: 2076 6572 7369 6f6e 206f 6620 6765 7474   version of gett
-0008fb90: 696e 6720 756e 6475 706c 6963 6174 6564  ing unduplicated
-0008fba0: 2061 6e64 2068 6967 686c 7920 636f 7272   and highly corr
-0008fbb0: 656c 6174 6564 2076 6172 7320 2323 0d0a  elated vars ##..
-0008fbc0: 2020 2020 636f 7272 656c 6174 696f 6e5f      correlation_
-0008fbd0: 6461 7461 6672 616d 6520 3d20 6466 2e63  dataframe = df.c
-0008fbe0: 6f72 7228 292e 6162 7328 292e 756e 7374  orr().abs().unst
-0008fbf0: 6163 6b28 292e 736f 7274 5f76 616c 7565  ack().sort_value
-0008fc00: 7328 292e 6472 6f70 5f64 7570 6c69 6361  s().drop_duplica
-0008fc10: 7465 7328 290d 0a20 2020 2063 6f72 7264  tes()..    corrd
-0008fc20: 6620 3d20 7064 2e44 6174 6146 7261 6d65  f = pd.DataFrame
-0008fc30: 2863 6f72 7265 6c61 7469 6f6e 5f64 6174  (correlation_dat
-0008fc40: 6166 7261 6d65 5b3a 5d2e 7265 7365 745f  aframe[:].reset_
-0008fc50: 696e 6465 7828 2929 0d0a 2020 2020 636f  index())..    co
-0008fc60: 7272 6466 2e63 6f6c 756d 6e73 203d 205b  rrdf.columns = [
-0008fc70: 2776 6172 3127 2c27 7661 7232 272c 2763  'var1','var2','c
-0008fc80: 6f65 6666 275d 0d0a 2020 2020 636f 7272  oeff']..    corr
-0008fc90: 6466 3120 3d20 636f 7272 6466 5b63 6f72  df1 = corrdf[cor
-0008fca0: 7264 665b 2763 6f65 6666 275d 3e3d 636f  rdf['coeff']>=co
-0008fcb0: 7272 5f6c 696d 6974 5d0d 0a20 2020 2063  rr_limit]..    c
-0008fcc0: 6f72 7265 6c61 7465 645f 7061 6972 203d  orrelated_pair =
-0008fcd0: 206c 6973 7428 7a69 7028 636f 7272 6466   list(zip(corrdf
-0008fce0: 315b 2776 6172 3127 5d2e 7661 6c75 6573  1['var1'].values
-0008fcf0: 2e74 6f6c 6973 7428 292c 636f 7272 6466  .tolist(),corrdf
-0008fd00: 315b 2776 6172 3227 5d2e 7661 6c75 6573  1['var2'].values
-0008fd10: 2e74 6f6c 6973 7428 2929 290d 0a20 2020  .tolist()))..   
-0008fd20: 2063 6f72 725f 7061 6972 5f64 6963 7420   corr_pair_dict 
-0008fd30: 3d20 6469 6374 2872 6574 7572 6e5f 6469  = dict(return_di
-0008fd40: 6374 696f 6e61 7279 5f6c 6973 7428 636f  ctionary_list(co
-0008fd50: 7272 656c 6174 6564 5f70 6169 7229 290d  rrelated_pair)).
-0008fd60: 0a20 2020 2063 6f72 725f 6c69 7374 203d  .    corr_list =
-0008fd70: 2066 696e 645f 7265 6d6f 7665 5f64 7570   find_remove_dup
-0008fd80: 6c69 6361 7465 7328 636f 7272 6466 315b  licates(corrdf1[
-0008fd90: 2776 6172 3127 5d2e 7661 6c75 6573 2e74  'var1'].values.t
-0008fda0: 6f6c 6973 7428 292b 636f 7272 6466 315b  olist()+corrdf1[
-0008fdb0: 2776 6172 3227 5d2e 7661 6c75 6573 2e74  'var2'].values.t
-0008fdc0: 6f6c 6973 7428 2929 0d0a 2020 2020 6b65  olist())..    ke
-0008fdd0: 7973 5f69 6e5f 6469 6374 203d 206c 6973  ys_in_dict = lis
-0008fde0: 7428 636f 7272 5f70 6169 725f 6469 6374  t(corr_pair_dict
-0008fdf0: 2e6b 6579 7328 2929 0d0a 2020 2020 7265  .keys())..    re
-0008fe00: 7665 7273 655f 636f 7272 656c 6174 6564  verse_correlated
-0008fe10: 5f70 6169 7220 3d20 5b28 792c 7829 2066  _pair = [(y,x) f
-0008fe20: 6f72 2028 782c 7929 2069 6e20 636f 7272  or (x,y) in corr
-0008fe30: 656c 6174 6564 5f70 6169 725d 0d0a 2020  elated_pair]..  
-0008fe40: 2020 7265 7665 7273 655f 636f 7272 5f70    reverse_corr_p
-0008fe50: 6169 725f 6469 6374 203d 2064 6963 7428  air_dict = dict(
-0008fe60: 7265 7475 726e 5f64 6963 7469 6f6e 6172  return_dictionar
-0008fe70: 795f 6c69 7374 2872 6576 6572 7365 5f63  y_list(reverse_c
-0008fe80: 6f72 7265 6c61 7465 645f 7061 6972 2929  orrelated_pair))
-0008fe90: 0d0a 2020 2020 2323 2323 2063 6f72 725f  ..    #### corr_
-0008fea0: 7061 6972 5f64 6963 7420 6973 2075 7365  pair_dict is use
-0008feb0: 6420 6c61 7465 7220 746f 206d 616b 6520  d later to make 
-0008fec0: 7468 6520 6e65 7477 6f72 6b20 6469 6167  the network diag
-0008fed0: 7261 6d20 746f 2073 6565 2077 6869 6368  ram to see which
-0008fee0: 2076 6172 7320 6172 6520 636f 7272 656c   vars are correl
-0008fef0: 6174 6564 2074 6f20 7768 6963 680d 0a20  ated to which.. 
-0008ff00: 2020 2066 6f72 206b 6579 2c20 7661 6c20     for key, val 
-0008ff10: 696e 2072 6576 6572 7365 5f63 6f72 725f  in reverse_corr_
-0008ff20: 7061 6972 5f64 6963 742e 6974 656d 7328  pair_dict.items(
-0008ff30: 293a 0d0a 2020 2020 2020 2020 6966 206b  ):..        if k
-0008ff40: 6579 2069 6e20 6b65 7973 5f69 6e5f 6469  ey in keys_in_di
-0008ff50: 6374 3a0d 0a20 2020 2020 2020 2020 2020  ct:..           
-0008ff60: 2069 6620 6c65 6e28 6b65 7929 203e 2031   if len(key) > 1
-0008ff70: 3a0d 0a20 2020 2020 2020 2020 2020 2020  :..             
-0008ff80: 2020 2063 6f72 725f 7061 6972 5f64 6963     corr_pair_dic
-0008ff90: 745b 6b65 795d 202b 3d20 7661 6c0d 0a20  t[key] += val.. 
-0008ffa0: 2020 2020 2020 2065 6c73 653a 0d0a 2020         else:..  
-0008ffb0: 2020 2020 2020 2020 2020 636f 7272 5f70            corr_p
-0008ffc0: 6169 725f 6469 6374 5b6b 6579 5d20 3d20  air_dict[key] = 
-0008ffd0: 7661 6c0d 0a0d 0a20 2020 2023 2323 2323  val....    #####
-0008ffe0: 2320 5468 6973 2069 7320 666f 7220 6f72  # This is for or
-0008fff0: 6465 7269 6e67 2074 6865 2076 6172 6961  dering the varia
-00090000: 626c 6573 2069 6e20 7468 6520 6869 6768  bles in the high
-00090010: 6573 7420 746f 206c 6f77 6573 7420 696d  est to lowest im
-00090020: 706f 7274 616e 6365 2074 6f20 7461 7267  portance to targ
-00090030: 6574 2023 2323 0d0a 2020 2020 6966 206c  et ###..    if l
-00090040: 656e 2863 6f72 725f 6c69 7374 2920 3d3d  en(corr_list) ==
-00090050: 2030 3a0d 0a20 2020 2020 2020 2066 696e   0:..        fin
-00090060: 616c 5f6c 6973 7420 3d20 6c69 7374 2863  al_list = list(c
-00090070: 6f72 7265 6c61 7469 6f6e 5f64 6174 6166  orrelation_dataf
-00090080: 7261 6d65 290d 0a20 2020 2020 2020 2070  rame)..        p
-00090090: 7269 6e74 2827 5365 6c65 6374 696e 6720  rint('Selecting 
-000900a0: 616c 6c20 2825 6429 2076 6172 6961 626c  all (%d) variabl
-000900b0: 6573 2073 696e 6365 206e 6f6e 6520 6f66  es since none of
-000900c0: 206e 756d 6572 6963 2076 6172 7320 6172   numeric vars ar
-000900d0: 6520 6869 6768 6c79 2063 6f72 7265 6c61  e highly correla
-000900e0: 7465 642e 2e2e 2720 256c 656e 286e 756d  ted...' %len(num
-000900f0: 7661 7273 2929 0d0a 2020 2020 2020 2020  vars))..        
-00090100: 7265 7475 726e 206e 756d 7661 7273 0d0a  return numvars..
-00090110: 2020 2020 656c 7365 3a0d 0a20 2020 2020      else:..     
-00090120: 2020 2069 6620 6973 696e 7374 616e 6365     if isinstance
-00090130: 2874 6172 6765 742c 206c 6973 7429 3a0d  (target, list):.
-00090140: 0a20 2020 2020 2020 2020 2020 2074 6172  .            tar
-00090150: 6765 7420 3d20 7461 7267 6574 5b30 5d0d  get = target[0].
-00090160: 0a20 2020 2020 2020 206d 6178 5f66 6561  .        max_fea
-00090170: 7473 203d 206c 656e 2863 6f72 725f 6c69  ts = len(corr_li
-00090180: 7374 290d 0a20 2020 2020 2020 2069 6620  st)..        if 
-00090190: 6d6f 6465 6c74 7970 6520 3d3d 2027 5265  modeltype == 'Re
-000901a0: 6772 6573 7369 6f6e 273a 0d0a 2020 2020  gression':..    
-000901b0: 2020 2020 2020 2020 7365 6c5f 6675 6e63          sel_func
-000901c0: 7469 6f6e 203d 206d 7574 7561 6c5f 696e  tion = mutual_in
-000901d0: 666f 5f72 6567 7265 7373 696f 6e0d 0a20  fo_regression.. 
-000901e0: 2020 2020 2020 2020 2020 2066 7320 3d20             fs = 
-000901f0: 5365 6c65 6374 4b42 6573 7428 7363 6f72  SelectKBest(scor
-00090200: 655f 6675 6e63 3d73 656c 5f66 756e 6374  e_func=sel_funct
-00090210: 696f 6e2c 206b 3d6d 6178 5f66 6561 7473  ion, k=max_feats
-00090220: 290d 0a20 2020 2020 2020 2065 6c73 653a  )..        else:
-00090230: 0d0a 2020 2020 2020 2020 2020 2020 7365  ..            se
-00090240: 6c5f 6675 6e63 7469 6f6e 203d 206d 7574  l_function = mut
-00090250: 7561 6c5f 696e 666f 5f63 6c61 7373 6966  ual_info_classif
-00090260: 0d0a 2020 2020 2020 2020 2020 2020 6673  ..            fs
-00090270: 203d 2053 656c 6563 744b 4265 7374 2873   = SelectKBest(s
-00090280: 636f 7265 5f66 756e 633d 7365 6c5f 6675  core_func=sel_fu
-00090290: 6e63 7469 6f6e 2c20 6b3d 6d61 785f 6665  nction, k=max_fe
-000902a0: 6174 7329 0d0a 2020 2020 2020 2020 2323  ats)..        ##
-000902b0: 2323 2320 796f 7520 6d75 7374 2065 6e73  ### you must ens
-000902c0: 7572 6520 7468 6572 6520 6172 6520 6e6f  ure there are no
-000902d0: 2069 6e66 696e 6974 6520 6e6f 7220 6e75   infinite nor nu
-000902e0: 6c6c 2076 616c 7565 7320 696e 2063 6f72  ll values in cor
-000902f0: 725f 6c69 7374 2064 6620 2323 0d0a 2020  r_list df ##..  
-00090300: 2020 2020 2020 6466 5f66 6974 203d 2064        df_fit = d
-00090310: 665b 636f 7272 5f6c 6973 745d 0d0a 2020  f[corr_list]..  
-00090320: 2020 2020 2020 2323 2320 4e6f 7720 6368        ### Now ch
-00090330: 6563 6b20 6966 2074 6865 7265 2061 7265  eck if there are
-00090340: 2061 6e79 204e 614e 2076 616c 7565 7320   any NaN values 
-00090350: 696e 2074 6865 2064 6174 6173 6574 2023  in the dataset #
-00090360: 2323 2323 0d0a 2020 2020 2020 2020 0d0a  ####..        ..
-00090370: 2020 2020 2020 2020 6966 2064 665f 6669          if df_fi
-00090380: 742e 6973 6e75 6c6c 2829 2e73 756d 2829  t.isnull().sum()
-00090390: 2e73 756d 2829 203e 2030 3a0d 0a20 2020  .sum() > 0:..   
-000903a0: 2020 2020 2020 2020 2064 665f 6669 7420           df_fit 
-000903b0: 3d20 6466 5f66 6974 2e64 726f 706e 6128  = df_fit.dropna(
-000903c0: 290d 0a20 2020 2020 2020 2065 6c73 653a  )..        else:
-000903d0: 0d0a 2020 2020 2020 2020 2020 2020 7072  ..            pr
-000903e0: 696e 7428 2720 2020 2074 6865 7265 2061  int('    there a
-000903f0: 7265 206e 6f20 6e75 6c6c 2076 616c 7565  re no null value
-00090400: 7320 696e 2064 6174 6173 6574 2e2e 2e27  s in dataset...'
-00090410: 290d 0a20 2020 2020 2020 2023 2323 2323  )..        #####
-00090420: 2052 6564 7563 6520 6d65 6d6f 7279 2075   Reduce memory u
-00090430: 7361 6765 2061 6e64 2066 696e 6420 6d75  sage and find mu
-00090440: 7475 616c 2069 6e66 6f72 6d61 7469 6f6e  tual information
-00090450: 2073 636f 7265 2023 2323 2320 2020 2020   score ####     
-00090460: 2020 0d0a 2020 2020 2020 2020 2374 7279    ..        #try
-00090470: 3a0d 0a20 2020 2020 2020 2023 2020 2020  :..        #    
-00090480: 6466 5f66 6974 203d 2072 6564 7563 655f  df_fit = reduce_
-00090490: 6d65 6d5f 7573 6167 6528 6466 5f66 6974  mem_usage(df_fit
-000904a0: 290d 0a20 2020 2020 2020 2023 6578 6365  )..        #exce
-000904b0: 7074 3a0d 0a20 2020 2020 2020 2023 2020  pt:..        #  
-000904c0: 2020 7072 696e 7428 2752 6564 7563 6520    print('Reduce 
-000904d0: 6d65 6d6f 7279 2065 7272 6f72 696e 672e  memory erroring.
-000904e0: 2043 6f6e 7469 6e75 696e 672e 2e2e 2729   Continuing...')
-000904f0: 0d0a 2020 2020 2020 2020 2323 2323 2320  ..        ##### 
-00090500: 5265 6164 7920 746f 2070 6572 666f 726d  Ready to perform
-00090510: 2066 6974 2061 6e64 2066 696e 6420 6d75   fit and find mu
-00090520: 7475 616c 2069 6e66 6f72 6d61 7469 6f6e  tual information
-00090530: 2073 636f 7265 2023 2323 230d 0a20 2020   score ####..   
-00090540: 2020 2020 2074 7279 3a0d 0a20 2020 2020       try:..     
-00090550: 2020 2020 2020 2066 732e 6669 7428 6466         fs.fit(df
-00090560: 5f66 6974 2c20 6466 5f74 6172 6765 7429  _fit, df_target)
-00090570: 0d0a 2020 2020 2020 2020 6578 6365 7074  ..        except
-00090580: 3a0d 0a20 2020 2020 2020 2020 2020 2070  :..            p
-00090590: 7269 6e74 2827 2020 2020 5365 6c65 6374  rint('    Select
-000905a0: 4b42 6573 7428 2920 6675 6e63 7469 6f6e  KBest() function
-000905b0: 2069 7320 6572 726f 7269 6e67 2e20 5265   is erroring. Re
-000905c0: 7475 726e 696e 6720 7769 7468 2061 6c6c  turning with all
-000905d0: 2025 7320 7661 7269 6162 6c65 732e 2e2e   %s variables...
-000905e0: 2720 256c 656e 286e 756d 7661 7273 2929  ' %len(numvars))
-000905f0: 0d0a 2020 2020 2020 2020 2020 2020 7265  ..            re
-00090600: 7475 726e 206e 756d 7661 7273 0d0a 2020  turn numvars..  
-00090610: 2020 2020 2020 7472 793a 0d0a 2020 2020        try:..    
-00090620: 2020 2020 2020 2020 2323 2323 2323 2323          ########
-00090630: 2323 2323 2323 2323 2323 2323 2323 2323  ################
-00090640: 2323 2323 2323 2323 2323 2323 2323 2323  ################
-00090650: 2323 2323 2323 2323 2323 2323 2323 2323  ################
-00090660: 2323 2323 2323 2323 2323 2323 2323 2323  ################
-00090670: 2323 2323 2323 2323 230d 0a20 2020 2020  #########..     
-00090680: 2020 2020 2020 2023 2323 2323 2323 2020         #######  
-00090690: 2054 6869 7320 6973 2074 6865 206d 6169   This is the mai
-000906a0: 6e20 7365 6374 696f 6e20 7768 6572 6520  n section where 
-000906b0: 7765 2075 7365 206d 7574 7561 6c20 696e  we use mutual in
-000906c0: 666f 2073 636f 7265 2074 6f20 7365 6c65  fo score to sele
-000906d0: 6374 2076 6172 7320 2020 2020 2020 200d  ct vars        .
-000906e0: 0a20 2020 2020 2020 2020 2020 2023 2323  .            ###
-000906f0: 2323 2323 2323 2323 2323 2323 2323 2323  ################
-00090700: 2323 2323 2323 2323 2323 2323 2323 2323  ################
-00090710: 2323 2323 2323 2323 2323 2323 2323 2323  ################
-00090720: 2323 2323 2323 2323 2323 2323 2323 2323  ################
-00090730: 2323 2323 2323 2323 2323 2323 2323 0d0a  ##############..
-00090740: 2020 2020 2020 2020 2020 2020 6d75 7475              mutu
-00090750: 616c 5f69 6e66 6f20 3d20 6469 6374 287a  al_info = dict(z
-00090760: 6970 2863 6f72 725f 6c69 7374 2c66 732e  ip(corr_list,fs.
-00090770: 7363 6f72 6573 5f29 290d 0a20 2020 2020  scores_))..     
-00090780: 2020 2020 2020 2023 2323 2320 5468 6520         #### The 
-00090790: 6669 7273 7420 7661 7269 6162 6c65 2069  first variable i
-000907a0: 6e20 6c69 7374 2068 6173 2074 6865 2068  n list has the h
-000907b0: 6967 6865 7374 2063 6f72 7265 6c61 7469  ighest correlati
-000907c0: 6f6e 2074 6f20 7468 6520 7461 7267 6574  on to the target
-000907d0: 2076 6172 6961 626c 6520 2323 230d 0a20   variable ###.. 
-000907e0: 2020 2020 2020 2020 2020 2073 6f72 7465             sorte
-000907f0: 645f 6279 5f6d 7574 7561 6c5f 696e 666f  d_by_mutual_info
-00090800: 203d 5b6b 6579 2066 6f72 2028 6b65 792c   =[key for (key,
-00090810: 7661 6c29 2069 6e20 736f 7274 6564 286d  val) in sorted(m
-00090820: 7574 7561 6c5f 696e 666f 2e69 7465 6d73  utual_info.items
-00090830: 2829 2c20 6b65 793d 6c61 6d62 6461 206b  (), key=lambda k
-00090840: 763a 206b 765b 315d 2c72 6576 6572 7365  v: kv[1],reverse
-00090850: 3d54 7275 6529 5d0d 0a20 2020 2020 2020  =True)]..       
-00090860: 2020 2020 2023 2323 2323 2020 204e 6f77       #####   Now
-00090870: 2077 6520 7365 6c65 6374 2074 6865 2066   we select the f
-00090880: 696e 616c 206c 6973 7420 6f66 2063 6f72  inal list of cor
-00090890: 7265 6c61 7465 6420 7661 7269 6162 6c65  related variable
-000908a0: 7320 2323 2323 2323 2323 2323 230d 0a20  s ###########.. 
-000908b0: 2020 2020 2020 2020 2020 2073 656c 6563             selec
-000908c0: 7465 645f 636f 7272 5f6c 6973 7420 3d20  ted_corr_list = 
-000908d0: 5b5d 0d0a 2020 2020 2020 2020 2020 2020  []..            
-000908e0: 2323 2323 2059 6f75 2068 6176 6520 746f  #### You have to
-000908f0: 206d 616b 6520 6d75 6c74 6970 6c65 2063   make multiple c
-00090900: 6f70 6965 7320 6f66 2074 6869 7320 736f  opies of this so
-00090910: 7274 6564 206c 6973 7420 7369 6e63 6520  rted list since 
-00090920: 6974 2069 7320 6974 6572 6174 6564 206d  it is iterated m
-00090930: 616e 7920 7469 6d65 7320 2323 2323 0d0a  any times ####..
-00090940: 2020 2020 2020 2020 2020 2020 6f72 6967              orig
-00090950: 5f73 6f72 7465 6420 3d20 636f 7079 2e64  _sorted = copy.d
-00090960: 6565 7063 6f70 7928 736f 7274 6564 5f62  eepcopy(sorted_b
-00090970: 795f 6d75 7475 616c 5f69 6e66 6f29 0d0a  y_mutual_info)..
-00090980: 2020 2020 2020 2020 2020 2020 636f 7079              copy
-00090990: 5f73 6f72 7465 6420 3d20 636f 7079 2e64  _sorted = copy.d
-000909a0: 6565 7063 6f70 7928 736f 7274 6564 5f62  eepcopy(sorted_b
-000909b0: 795f 6d75 7475 616c 5f69 6e66 6f29 0d0a  y_mutual_info)..
-000909c0: 2020 2020 2020 2020 2020 2020 636f 7079              copy
-000909d0: 5f70 6169 7220 3d20 636f 7079 2e64 6565  _pair = copy.dee
-000909e0: 7063 6f70 7928 636f 7272 5f70 6169 725f  pcopy(corr_pair_
-000909f0: 6469 6374 290d 0a20 2020 2020 2020 2020  dict)..         
-00090a00: 2020 2023 2323 2320 7365 6c65 6374 2065     #### select e
-00090a10: 6163 6820 7661 7269 6162 6c65 2062 7920  ach variable by 
-00090a20: 7468 6520 6869 6768 6573 7420 6d75 7475  the highest mutu
-00090a30: 616c 2069 6e66 6f20 616e 6420 7365 6520  al info and see 
-00090a40: 7768 6174 2076 6172 7320 6172 6520 636f  what vars are co
-00090a50: 7272 656c 6174 6564 2074 6f20 6974 0d0a  rrelated to it..
-00090a60: 2020 2020 2020 2020 2020 2020 666f 7220              for 
-00090a70: 6561 6368 5f63 6f72 725f 6e61 6d65 2069  each_corr_name i
-00090a80: 6e20 636f 7079 5f73 6f72 7465 643a 0d0a  n copy_sorted:..
-00090a90: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00090aa0: 2323 2320 6164 6420 7468 6520 7365 6c65  ### add the sele
-00090ab0: 6374 6564 2076 6172 2074 6f20 7468 6520  cted var to the 
-00090ac0: 7365 6c65 6374 6564 5f63 6f72 725f 6c69  selected_corr_li
-00090ad0: 7374 0d0a 2020 2020 2020 2020 2020 2020  st..            
-00090ae0: 2020 2020 7365 6c65 6374 6564 5f63 6f72      selected_cor
-00090af0: 725f 6c69 7374 2e61 7070 656e 6428 6561  r_list.append(ea
-00090b00: 6368 5f63 6f72 725f 6e61 6d65 290d 0a20  ch_corr_name).. 
-00090b10: 2020 2020 2020 2020 2020 2020 2020 2066                 f
-00090b20: 6f72 2065 6163 685f 7265 6d6f 7665 2069  or each_remove i
-00090b30: 6e20 636f 7079 5f70 6169 725b 6561 6368  n copy_pair[each
-00090b40: 5f63 6f72 725f 6e61 6d65 5d3a 0d0a 2020  _corr_name]:..  
-00090b50: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00090b60: 2020 2323 2323 204e 6f77 2072 656d 6f76    #### Now remov
-00090b70: 6520 6561 6368 2076 6172 6961 626c 6520  e each variable 
-00090b80: 7468 6174 2069 7320 6869 6768 6c79 2063  that is highly c
-00090b90: 6f72 7265 6c61 7465 6420 746f 2074 6865  orrelated to the
-00090ba0: 2073 656c 6563 7465 6420 7661 7269 6162   selected variab
-00090bb0: 6c65 0d0a 2020 2020 2020 2020 2020 2020  le..            
-00090bc0: 2020 2020 2020 2020 6966 2065 6163 685f          if each_
-00090bd0: 7265 6d6f 7665 2069 6e20 636f 7079 5f73  remove in copy_s
-00090be0: 6f72 7465 643a 0d0a 2020 2020 2020 2020  orted:..        
-00090bf0: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00090c00: 636f 7079 5f73 6f72 7465 642e 7265 6d6f  copy_sorted.remo
-00090c10: 7665 2865 6163 685f 7265 6d6f 7665 290d  ve(each_remove).
-00090c20: 0a20 2020 2020 2020 2020 2020 2023 2323  .            ###
-00090c30: 2323 204e 6f77 2077 6520 636f 6d62 696e  ## Now we combin
-00090c40: 6520 7468 6520 756e 636f 7272 656c 6174  e the uncorrelat
-00090c50: 6564 206c 6973 7420 746f 2074 6865 2073  ed list to the s
-00090c60: 656c 6563 7465 6420 636f 7272 656c 6174  elected correlat
-00090c70: 6564 206c 6973 7420 6162 6f76 650d 0a20  ed list above.. 
-00090c80: 2020 2020 2020 2020 2020 2072 656d 5f63             rem_c
-00090c90: 6f6c 5f6c 6973 7420 3d20 6c65 6674 5f73  ol_list = left_s
-00090ca0: 7562 7472 6163 7428 6e75 6d76 6172 732c  ubtract(numvars,
-00090cb0: 636f 7272 5f6c 6973 7429 0d0a 2020 2020  corr_list)..    
-00090cc0: 2020 2020 2020 2020 6669 6e61 6c5f 6c69          final_li
-00090cd0: 7374 203d 2072 656d 5f63 6f6c 5f6c 6973  st = rem_col_lis
-00090ce0: 7420 2b20 7365 6c65 6374 6564 5f63 6f72  t + selected_cor
-00090cf0: 725f 6c69 7374 0d0a 2020 2020 2020 2020  r_list..        
-00090d00: 2020 2020 7265 6d6f 7665 645f 636f 6c73      removed_cols
-00090d10: 203d 206c 6566 745f 7375 6274 7261 6374   = left_subtract
-00090d20: 286e 756d 7661 7273 2c20 6669 6e61 6c5f  (numvars, final_
-00090d30: 6c69 7374 290d 0a20 2020 2020 2020 2065  list)..        e
-00090d40: 7863 6570 7420 4578 6365 7074 696f 6e20  xcept Exception 
-00090d50: 6173 2065 3a0d 0a20 2020 2020 2020 2020  as e:..         
-00090d60: 2020 2070 7269 6e74 2827 2020 2020 5355     print('    SU
-00090d70: 4c4f 5620 4d65 7468 6f64 2063 7261 7368  LOV Method crash
-00090d80: 696e 6720 6475 6520 746f 2025 7327 2025  ing due to %s' %
-00090d90: 6529 0d0a 2020 2020 2020 2020 2020 2020  e)..            
-00090da0: 2323 2323 2044 726f 7070 696e 6720 6869  #### Dropping hi
-00090db0: 6768 6c79 2063 6f72 7265 6c61 7465 6420  ghly correlated 
-00090dc0: 4665 6174 7572 6573 2066 6173 7420 7573  Features fast us
-00090dd0: 696e 6720 7369 6d70 6c65 206c 696e 6561  ing simple linea
-00090de0: 7220 636f 7272 656c 6174 696f 6e20 2323  r correlation ##
-00090df0: 230d 0a20 2020 2020 2020 2020 2020 2072  #..            r
-00090e00: 656d 6f76 6564 5f63 6f6c 7320 3d20 7265  emoved_cols = re
-00090e10: 6d6f 7665 5f68 6967 686c 795f 636f 7272  move_highly_corr
-00090e20: 656c 6174 6564 5f76 6172 735f 6661 7374  elated_vars_fast
-00090e30: 2864 662c 636f 7272 5f6c 696d 6974 290d  (df,corr_limit).
-00090e40: 0a20 2020 2020 2020 2020 2020 2066 696e  .            fin
-00090e50: 616c 5f6c 6973 7420 3d20 6c65 6674 5f73  al_list = left_s
-00090e60: 7562 7472 6163 7428 6e75 6d76 6172 732c  ubtract(numvars,
-00090e70: 2072 656d 6f76 6564 5f63 6f6c 7329 0d0a   removed_cols)..
-00090e80: 2020 2020 2020 2020 6966 206c 656e 2872          if len(r
-00090e90: 656d 6f76 6564 5f63 6f6c 7329 203e 2030  emoved_cols) > 0
-00090ea0: 3a0d 0a20 2020 2020 2020 2020 2020 2070  :..            p
-00090eb0: 7269 6e74 2827 2020 2020 5265 6d6f 7669  rint('    Removi
-00090ec0: 6e67 2028 2564 2920 6869 6768 6c79 2063  ng (%d) highly c
-00090ed0: 6f72 7265 6c61 7465 6420 7661 7269 6162  orrelated variab
-00090ee0: 6c65 733a 2720 2528 6c65 6e28 7265 6d6f  les:' %(len(remo
-00090ef0: 7665 645f 636f 6c73 2929 290d 0a20 2020  ved_cols)))..   
-00090f00: 2020 2020 2020 2020 2069 6620 6c65 6e28           if len(
-00090f10: 7265 6d6f 7665 645f 636f 6c73 2920 3c3d  removed_cols) <=
-00090f20: 2033 303a 0d0a 2020 2020 2020 2020 2020   30:..          
-00090f30: 2020 2020 2020 7072 696e 7428 2720 2020        print('   
-00090f40: 2025 7327 2025 7265 6d6f 7665 645f 636f   %s' %removed_co
-00090f50: 6c73 290d 0a20 2020 2020 2020 2020 2020  ls)..           
-00090f60: 2069 6620 6c65 6e28 6669 6e61 6c5f 6c69   if len(final_li
-00090f70: 7374 2920 3c3d 2033 303a 0d0a 2020 2020  st) <= 30:..    
-00090f80: 2020 2020 2020 2020 2020 2020 7072 696e              prin
-00090f90: 7428 2720 2020 2046 6f6c 6c6f 7769 6e67  t('    Following
-00090fa0: 2028 2564 2920 7661 7273 2073 656c 6563   (%d) vars selec
-00090fb0: 7465 643a 2025 7327 2025 286c 656e 2866  ted: %s' %(len(f
-00090fc0: 696e 616c 5f6c 6973 7429 2c66 696e 616c  inal_list),final
-00090fd0: 5f6c 6973 7429 290d 0a20 2020 2020 2020  _list))..       
-00090fe0: 2023 2323 2323 2323 2323 2323 2323 2320   ############## 
-00090ff0: 2020 2044 2052 2041 2057 2020 2043 204f     D R A W   C O
-00091000: 2052 2052 2045 204c 2041 2054 2049 204f   R R E L A T I O
-00091010: 204e 2020 204e 2045 2054 2057 204f 2052   N   N E T W O R
-00091020: 204b 2023 2323 2323 2323 2323 2323 2323   K #############
-00091030: 2323 2323 230d 0a20 2020 2020 2020 2073  #####..        s
-00091040: 656c 6563 7465 6420 3d20 636f 7079 2e64  elected = copy.d
-00091050: 6565 7063 6f70 7928 6669 6e61 6c5f 6c69  eepcopy(final_li
-00091060: 7374 290d 0a20 2020 2020 2020 2074 7279  st)..        try
-00091070: 3a0d 0a20 2020 2020 2020 2020 2020 2069  :..            i
-00091080: 6d70 6f72 7420 6e65 7477 6f72 6b78 2061  mport networkx a
-00091090: 7320 6e78 0d0a 2020 2020 2020 2020 2020  s nx..          
-000910a0: 2020 2323 2323 204e 6f77 2073 7461 7274    #### Now start
-000910b0: 2062 7569 6c64 696e 6720 7468 6520 6772   building the gr
-000910c0: 6170 6820 2323 2323 2323 2323 2323 2323  aph ############
-000910d0: 2323 2323 2323 230d 0a20 2020 2020 2020  #######..       
-000910e0: 2020 2020 2067 6620 3d20 6e78 2e47 7261       gf = nx.Gra
-000910f0: 7068 2829 0d0a 2020 2020 2020 2020 2020  ph()..          
-00091100: 2020 2323 2320 7468 6520 6d75 7475 616c    ### the mutual
-00091110: 2069 6e66 6f20 7363 6f72 6520 6769 7665   info score give
-00091120: 7320 7468 6520 7369 7a65 206f 6620 7468  s the size of th
-00091130: 6520 6275 6262 6c65 2023 2323 0d0a 2020  e bubble ###..  
-00091140: 2020 2020 2020 2020 2020 6d75 6c74 6970            multip
-00091150: 6c69 6572 203d 2032 3130 300d 0a20 2020  lier = 2100..   
-00091160: 2020 2020 2020 2020 2066 6f72 2065 6163           for eac
-00091170: 6820 696e 206f 7269 675f 736f 7274 6564  h in orig_sorted
-00091180: 3a0d 0a20 2020 2020 2020 2020 2020 2020  :..             
-00091190: 2020 2067 662e 6164 645f 6e6f 6465 2865     gf.add_node(e
-000911a0: 6163 682c 2073 697a 653d 696e 7428 6d61  ach, size=int(ma
-000911b0: 7828 312c 6d75 7475 616c 5f69 6e66 6f5b  x(1,mutual_info[
-000911c0: 6561 6368 5d2a 6d75 6c74 6970 6c69 6572  each]*multiplier
-000911d0: 2929 290d 0a20 2020 2020 2020 2020 2020  )))..           
-000911e0: 2023 2323 2323 2323 2323 2054 6869 7320   ######### This 
-000911f0: 6973 2077 6865 7265 2079 6f75 2063 616c  is where you cal
-00091200: 6375 6c61 7465 2074 6865 2073 697a 6520  culate the size 
-00091210: 6f66 2065 6163 6820 6e6f 6465 2074 6f20  of each node to 
-00091220: 6472 6177 0d0a 2020 2020 2020 2020 2020  draw..          
-00091230: 2020 7369 7a65 7320 3d20 5b6d 7574 7561    sizes = [mutua
-00091240: 6c5f 696e 666f 5b78 5d2a 6d75 6c74 6970  l_info[x]*multip
-00091250: 6c69 6572 2066 6f72 2078 2069 6e20 6c69  lier for x in li
-00091260: 7374 2867 662e 6e6f 6465 7328 2929 5d0d  st(gf.nodes())].
-00091270: 0a20 2020 2020 2020 2020 2020 2023 2323  .            ###
-00091280: 2320 2054 6865 2073 697a 6573 206f 6620  #  The sizes of 
-00091290: 7468 6520 6275 6262 6c65 7320 666f 7220  the bubbles for 
-000912a0: 6561 6368 206e 6f64 6520 6973 2064 6574  each node is det
-000912b0: 6572 6d69 6e65 6420 6279 2069 7473 206d  ermined by its m
-000912c0: 7574 7561 6c20 696e 666f 726d 6174 696f  utual informatio
-000912d0: 6e20 7363 6f72 6520 7661 6c75 650d 0a20  n score value.. 
-000912e0: 2020 2020 2020 2020 2020 2063 6f72 7220             corr 
-000912f0: 3d20 6466 5f66 6974 2e63 6f72 7228 290d  = df_fit.corr().
-00091300: 0a20 2020 2020 2020 2020 2020 2068 6967  .            hig
-00091310: 685f 636f 7272 203d 2063 6f72 725b 6162  h_corr = corr[ab
-00091320: 7328 636f 7272 293e 636f 7272 5f6c 696d  s(corr)>corr_lim
-00091330: 6974 5d0d 0a20 2020 2020 2020 2020 2020  it]..           
-00091340: 2023 2320 6869 6768 5f63 6f72 7220 6973   ## high_corr is
-00091350: 2074 6865 2064 6174 6166 7261 6d65 206f   the dataframe o
-00091360: 6620 6120 6665 7720 7661 7269 6162 6c65  f a few variable
-00091370: 7320 7468 6174 2061 7265 2068 6967 686c  s that are highl
-00091380: 7920 636f 7272 656c 6174 6564 2074 6f20  y correlated to 
-00091390: 6561 6368 206f 7468 6572 0d0a 2020 2020  each other..    
-000913a0: 2020 2020 2020 2020 636f 6d62 6f73 203d          combos =
-000913b0: 2063 6f6d 6269 6e61 7469 6f6e 7328 636f   combinations(co
-000913c0: 7272 5f6c 6973 742c 3229 0d0a 2020 2020  rr_list,2)..    
-000913d0: 2020 2020 2020 2020 2323 2320 7468 6973          ### this
-000913e0: 2067 6976 6573 2074 6865 2073 7472 656e   gives the stren
-000913f0: 6774 6820 6f66 2063 6f72 7265 6c61 7469  gth of correlati
-00091400: 6f6e 2062 6574 7765 656e 2032 206e 6f64  on between 2 nod
-00091410: 6573 2023 230d 0a20 2020 2020 2020 2020  es ##..         
-00091420: 2020 206d 756c 7469 706c 6965 7220 3d20     multiplier = 
-00091430: 3230 0d0a 2020 2020 2020 2020 2020 2020  20..            
-00091440: 666f 7220 2876 6172 312c 2076 6172 3229  for (var1, var2)
-00091450: 2069 6e20 636f 6d62 6f73 3a0d 0a20 2020   in combos:..   
-00091460: 2020 2020 2020 2020 2020 2020 2069 6620               if 
-00091470: 6e70 2e69 736e 616e 2868 6967 685f 636f  np.isnan(high_co
-00091480: 7272 2e6c 6f63 5b76 6172 312c 7661 7232  rr.loc[var1,var2
-00091490: 5d29 3a0d 0a20 2020 2020 2020 2020 2020  ]):..           
-000914a0: 2020 2020 2020 2020 2070 6173 730d 0a20           pass.. 
-000914b0: 2020 2020 2020 2020 2020 2020 2020 2065                 e
-000914c0: 6c73 653a 0d0a 2020 2020 2020 2020 2020  lse:..          
-000914d0: 2020 2020 2020 2020 2020 6766 2e61 6464            gf.add
-000914e0: 5f65 6467 6528 7661 7231 2c20 7661 7232  _edge(var1, var2
-000914f0: 2c77 6569 6768 743d 6d75 6c74 6970 6c69  ,weight=multipli
-00091500: 6572 2a68 6967 685f 636f 7272 2e6c 6f63  er*high_corr.loc
-00091510: 5b76 6172 312c 7661 7232 5d29 0d0a 2020  [var1,var2])..  
-00091520: 2020 2020 2020 2020 2020 2323 2323 2323            ######
-00091530: 2323 204e 6f77 2073 7461 7274 2062 7569  ## Now start bui
-00091540: 6c64 696e 6720 7468 6520 6e65 7477 6f72  lding the networ
-00091550: 6b78 2067 7261 7068 2023 2323 2323 2323  kx graph #######
-00091560: 2323 2323 2323 2323 2323 2323 2323 2323  ################
-00091570: 2323 230d 0a20 2020 2020 2020 2020 2020  ###..           
-00091580: 2077 6964 7468 7320 3d20 6e78 2e67 6574   widths = nx.get
-00091590: 5f65 6467 655f 6174 7472 6962 7574 6573  _edge_attributes
-000915a0: 2867 662c 2027 7765 6967 6874 2729 0d0a  (gf, 'weight')..
-000915b0: 2020 2020 2020 2020 2020 2020 6e6f 6465              node
-000915c0: 6c69 7374 203d 2067 662e 6e6f 6465 7328  list = gf.nodes(
-000915d0: 290d 0a20 2020 2020 2020 2020 2020 2063  )..            c
-000915e0: 6f6c 7320 3d20 350d 0a20 2020 2020 2020  ols = 5..       
-000915f0: 2020 2020 2068 6569 6768 745f 7369 7a65       height_size
-00091600: 203d 2035 0d0a 2020 2020 2020 2020 2020   = 5..          
-00091610: 2020 7769 6474 685f 7369 7a65 203d 2031    width_size = 1
-00091620: 350d 0a20 2020 2020 2020 2020 2020 2072  5..            r
-00091630: 6f77 7320 3d20 696e 7428 6c65 6e28 636f  ows = int(len(co
-00091640: 7272 5f6c 6973 7429 2f63 6f6c 7329 0d0a  rr_list)/cols)..
-00091650: 2020 2020 2020 2020 2020 2020 6966 2072              if r
-00091660: 6f77 7320 3c20 313a 0d0a 2020 2020 2020  ows < 1:..      
-00091670: 2020 2020 2020 2020 2020 726f 7773 203d            rows =
-00091680: 2031 0d0a 2020 2020 2020 2020 2020 2020   1..            
-00091690: 706c 742e 6669 6775 7265 2866 6967 7369  plt.figure(figsi
-000916a0: 7a65 3d28 7769 6474 685f 7369 7a65 2c6d  ze=(width_size,m
-000916b0: 696e 2832 302c 6865 6967 6874 5f73 697a  in(20,height_siz
-000916c0: 652a 726f 7773 2929 290d 0a20 2020 2020  e*rows)))..     
-000916d0: 2020 2020 2020 2070 6f73 203d 206e 782e         pos = nx.
-000916e0: 7368 656c 6c5f 6c61 796f 7574 2867 6629  shell_layout(gf)
-000916f0: 0d0a 2020 2020 2020 2020 2020 2020 6e78  ..            nx
-00091700: 2e64 7261 775f 6e65 7477 6f72 6b78 5f6e  .draw_networkx_n
-00091710: 6f64 6573 2867 662c 706f 732c 0d0a 2020  odes(gf,pos,..  
-00091720: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00091730: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00091740: 206e 6f64 656c 6973 743d 6e6f 6465 6c69   nodelist=nodeli
-00091750: 7374 2c0d 0a20 2020 2020 2020 2020 2020  st,..           
-00091760: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00091770: 2020 2020 2020 2020 6e6f 6465 5f73 697a          node_siz
-00091780: 653d 7369 7a65 732c 0d0a 2020 2020 2020  e=sizes,..      
-00091790: 2020 2020 2020 2020 2020 2020 2020 2020                  
-000917a0: 2020 2020 2020 2020 2020 2020 206e 6f64               nod
-000917b0: 655f 636f 6c6f 723d 2762 6c75 6527 2c0d  e_color='blue',.
-000917c0: 0a20 2020 2020 2020 2020 2020 2020 2020  .               
-000917d0: 2020 2020 2020 2020 2020 2020 2020 2020                  
-000917e0: 2020 2020 616c 7068 613d 302e 3529 0d0a      alpha=0.5)..
-000917f0: 2020 2020 2020 2020 2020 2020 6e78 2e64              nx.d
-00091800: 7261 775f 6e65 7477 6f72 6b78 5f65 6467  raw_networkx_edg
-00091810: 6573 2867 662c 706f 732c 0d0a 2020 2020  es(gf,pos,..    
-00091820: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00091830: 2020 2020 2020 2020 2020 2020 2020 2065                 e
-00091840: 6467 656c 6973 7420 3d20 7769 6474 6873  dgelist = widths
-00091850: 2e6b 6579 7328 292c 0d0a 2020 2020 2020  .keys(),..      
-00091860: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00091870: 2020 2020 2020 2020 2020 2020 2077 6964               wid
-00091880: 7468 3d6c 6973 7428 7769 6474 6873 2e76  th=list(widths.v
-00091890: 616c 7565 7328 2929 2c0d 0a20 2020 2020  alues()),..     
-000918a0: 2020 2020 2020 2020 2020 2020 2020 2020                  
-000918b0: 2020 2020 2020 2020 2020 2020 2020 6564                ed
-000918c0: 6765 5f63 6f6c 6f72 3d27 6c69 6768 7462  ge_color='lightb
-000918d0: 6c75 6527 2c0d 0a20 2020 2020 2020 2020  lue',..         
-000918e0: 2020 2020 2020 2020 2020 2020 2020 2020                  
-000918f0: 2020 2020 2020 2020 2020 616c 7068 613d            alpha=
-00091900: 302e 3629 0d0a 2020 2020 2020 2020 2020  0.6)..          
-00091910: 2020 706f 735f 6869 6768 6572 203d 207b    pos_higher = {
-00091920: 7d0d 0a20 2020 2020 2020 2020 2020 2078  }..            x
-00091930: 5f6f 6666 203d 2030 2e30 3420 2023 206f  _off = 0.04  # o
-00091940: 6666 7365 7420 6f6e 2074 6865 2078 2061  ffset on the x a
-00091950: 7869 730d 0a20 2020 2020 2020 2020 2020  xis..           
-00091960: 2079 5f6f 6666 203d 2030 2e30 3420 2023   y_off = 0.04  #
-00091970: 206f 6666 7365 7420 6f6e 2074 6865 2079   offset on the y
-00091980: 2061 7869 730d 0a20 2020 2020 2020 2020   axis..         
-00091990: 2020 2066 6f72 206b 2c20 7620 696e 2070     for k, v in p
-000919a0: 6f73 2e69 7465 6d73 2829 3a0d 0a20 2020  os.items():..   
-000919b0: 2020 2020 2020 2020 2020 2020 2070 6f73               pos
-000919c0: 5f68 6967 6865 725b 6b5d 203d 2028 765b  _higher[k] = (v[
-000919d0: 305d 2b78 5f6f 6666 2c20 765b 315d 2b79  0]+x_off, v[1]+y
-000919e0: 5f6f 6666 290d 0a20 2020 2020 2020 2020  _off)..         
-000919f0: 2020 2069 6620 6c65 6e28 7365 6c65 6374     if len(select
-00091a00: 6564 2920 3d3d 2030 3a0d 0a20 2020 2020  ed) == 0:..     
-00091a10: 2020 2020 2020 2020 2020 206e 782e 6472             nx.dr
-00091a20: 6177 5f6e 6574 776f 726b 785f 6c61 6265  aw_networkx_labe
-00091a30: 6c73 2867 662c 2070 6f73 3d70 6f73 5f68  ls(gf, pos=pos_h
-00091a40: 6967 6865 722c 0d0a 2020 2020 2020 2020  igher,..        
-00091a50: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00091a60: 2020 2020 2020 2020 2020 2020 6c61 6265              labe
-00091a70: 6c73 3d64 6963 7428 7a69 7028 6e6f 6465  ls=dict(zip(node
-00091a80: 6c69 7374 2c6e 6f64 656c 6973 7429 292c  list,nodelist)),
-00091a90: 0d0a 2020 2020 2020 2020 2020 2020 2020  ..              
-00091aa0: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00091ab0: 2020 2020 2020 666f 6e74 5f63 6f6c 6f72        font_color
-00091ac0: 3d27 626c 6163 6b27 290d 0a20 2020 2020  ='black')..     
-00091ad0: 2020 2020 2020 2065 6c73 653a 0d0a 2020         else:..  
-00091ae0: 2020 2020 2020 2020 2020 2020 2020 6e78                nx
-00091af0: 2e64 7261 775f 6e65 7477 6f72 6b78 5f6c  .draw_networkx_l
-00091b00: 6162 656c 7328 6766 2c20 706f 733d 706f  abels(gf, pos=po
-00091b10: 735f 6869 6768 6572 2c0d 0a20 2020 2020  s_higher,..     
-00091b20: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00091b30: 2020 2020 2020 2020 2020 2020 2020 206c                 l
-00091b40: 6162 656c 7320 3d20 6469 6374 287a 6970  abels = dict(zip
-00091b50: 286e 6f64 656c 6973 742c 5b78 2b27 2028  (nodelist,[x+' (
-00091b60: 7365 6c65 6374 6564 2927 2069 6620 7820  selected)' if x 
-00091b70: 696e 2073 656c 6563 7465 6420 656c 7365  in selected else
-00091b80: 2078 2b27 2028 7265 6d6f 7665 6429 2720   x+' (removed)' 
-00091b90: 666f 7220 7820 696e 206e 6f64 656c 6973  for x in nodelis
-00091ba0: 745d 2929 2c0d 0a20 2020 2020 2020 2020  t])),..         
-00091bb0: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00091bc0: 2020 2020 2020 2020 2020 2066 6f6e 745f             font_
-00091bd0: 636f 6c6f 723d 2762 6c61 636b 2729 0d0a  color='black')..
-00091be0: 2020 2020 2020 2020 2020 2020 706c 742e              plt.
-00091bf0: 626f 7828 5472 7565 290d 0a20 2020 2020  box(True)..     
-00091c00: 2020 2020 2020 2070 6c74 2e74 6974 6c65         plt.title
-00091c10: 2822 2222 496e 2053 554c 4f56 2c20 7765  ("""In SULOV, we
-00091c20: 2072 6570 6561 7465 646c 7920 7265 6d6f   repeatedly remo
-00091c30: 7665 2066 6561 7475 7265 7320 7769 7468  ve features with
-00091c40: 206c 6f77 6572 206d 7574 7561 6c20 696e   lower mutual in
-00091c50: 666f 2073 636f 7265 7320 616d 6f6e 6720  fo scores among 
-00091c60: 6869 6768 6c79 2063 6f72 7265 6c61 7465  highly correlate
-00091c70: 6420 7061 6972 7320 2873 6565 2066 6967  d pairs (see fig
-00091c80: 7572 6529 2c0d 0a20 2020 2020 2020 2020  ure),..         
-00091c90: 2020 2020 2020 2020 2020 2020 2020 2053                 S
-00091ca0: 554c 4f56 2073 656c 6563 7473 2074 6865  ULOV selects the
-00091cb0: 2066 6561 7475 7265 2077 6974 6820 6869   feature with hi
-00091cc0: 6768 6572 206d 7574 7561 6c20 696e 666f  gher mutual info
-00091cd0: 2073 636f 7265 2072 656c 6174 6564 2074   score related t
-00091ce0: 6f20 7461 7267 6574 2077 6865 6e20 6368  o target when ch
-00091cf0: 6f6f 7369 6e67 2062 6574 7765 656e 2061  oosing between a
-00091d00: 2070 6169 722e 2022 2222 2c20 666f 6e74   pair. """, font
-00091d10: 7369 7a65 3d31 3029 0d0a 2020 2020 2020  size=10)..      
-00091d20: 2020 2020 2020 706c 742e 7375 7074 6974        plt.suptit
-00091d30: 6c65 2827 486f 7720 5355 4c4f 5620 4d65  le('How SULOV Me
-00091d40: 7468 6f64 2057 6f72 6b73 2062 7920 5265  thod Works by Re
-00091d50: 6d6f 7669 6e67 2048 6967 686c 7920 436f  moving Highly Co
-00091d60: 7272 656c 6174 6564 2046 6561 7475 7265  rrelated Feature
-00091d70: 7327 2c20 666f 6e74 7369 7a65 3d32 302c  s', fontsize=20,
-00091d80: 793d 312e 3033 290d 0a20 2020 2020 2020  y=1.03)..       
-00091d90: 2020 2020 2072 6564 5f70 6174 6368 203d       red_patch =
-00091da0: 206d 7061 7463 6865 732e 5061 7463 6828   mpatches.Patch(
-00091db0: 636f 6c6f 723d 2762 6c75 6527 2c20 6c61  color='blue', la
-00091dc0: 6265 6c3d 2742 6967 6765 7220 6369 7263  bel='Bigger circ
-00091dd0: 6c65 2064 656e 6f74 6573 2068 6967 6865  le denotes highe
-00091de0: 7220 6d75 7475 616c 2069 6e66 6f20 7363  r mutual info sc
-00091df0: 6f72 6520 7769 7468 2074 6172 6765 7427  ore with target'
-00091e00: 290d 0a20 2020 2020 2020 2020 2020 2062  )..            b
-00091e10: 6c75 655f 7061 7463 6820 3d20 6d70 6174  lue_patch = mpat
-00091e20: 6368 6573 2e50 6174 6368 2863 6f6c 6f72  ches.Patch(color
-00091e30: 3d27 6c69 6768 7462 6c75 6527 2c20 6c61  ='lightblue', la
-00091e40: 6265 6c3d 2754 6869 636b 6572 206c 696e  bel='Thicker lin
-00091e50: 6520 6465 6e6f 7465 7320 6869 6768 6572  e denotes higher
-00091e60: 2063 6f72 7265 6c61 7469 6f6e 2062 6574   correlation bet
-00091e70: 7765 656e 2074 776f 2076 6172 6961 626c  ween two variabl
-00091e80: 6573 2729 0d0a 2020 2020 2020 2020 2020  es')..          
-00091e90: 2020 706c 742e 6c65 6765 6e64 2868 616e    plt.legend(han
-00091ea0: 646c 6573 3d5b 7265 645f 7061 7463 682c  dles=[red_patch,
-00091eb0: 2062 6c75 655f 7061 7463 685d 2c6c 6f63   blue_patch],loc
-00091ec0: 3d27 6265 7374 2729 0d0a 2020 2020 2020  ='best')..      
-00091ed0: 2020 2020 2020 706c 742e 7368 6f77 2829        plt.show()
-00091ee0: 3b0d 0a20 2020 2020 2020 2020 2020 2023  ;..            #
-00091ef0: 2323 2323 2020 2020 4e20 4520 5420 5720  ####    N E T W 
-00091f00: 4f20 5220 4b20 2020 2020 4420 4920 4120  O R K     D I A 
-00091f10: 4720 5220 4120 4d20 2020 2043 204f 204d  G R A M    C O M
-00091f20: 2050 204c 2045 2054 2045 2020 2023 2323   P L E T E   ###
-00091f30: 2323 2323 2323 2323 2323 2323 2323 0d0a  ##############..
-00091f40: 2020 2020 2020 2020 2020 2020 7265 7475              retu
-00091f50: 726e 2066 696e 616c 5f6c 6973 742b 7265  rn final_list+re
-00091f60: 6d76 6172 730d 0a20 2020 2020 2020 2065  mvars..        e
-00091f70: 7863 6570 7420 4578 6365 7074 696f 6e20  xcept Exception 
-00091f80: 6173 2065 3a0d 0a20 2020 2020 2020 2020  as e:..         
-00091f90: 2020 2070 7269 6e74 2827 2020 2020 4e65     print('    Ne
-00091fa0: 7477 6f72 6b78 206c 6962 7261 7279 2076  tworkx library v
-00091fb0: 6973 7561 6c69 7a61 7469 6f6e 2063 7261  isualization cra
-00091fc0: 7368 696e 6720 6475 6520 746f 2025 7327  shing due to %s'
-00091fd0: 2025 6529 0d0a 2020 2020 2020 2020 2020   %e)..          
-00091fe0: 2020 7072 696e 7428 2743 6f6e 7469 6e75    print('Continu
-00091ff0: 696e 6720 7769 7468 2053 554c 4f56 2e20  ing with SULOV. 
-00092000: 2564 2066 6561 7475 7265 7320 7365 6c65  %d features sele
-00092010: 6374 6564 2720 256c 656e 2866 696e 616c  cted' %len(final
-00092020: 5f6c 6973 7429 290d 0a20 2020 2020 2020  _list))..       
-00092030: 2020 2020 2072 6574 7572 6e20 6669 6e61       return fina
-00092040: 6c5f 6c69 7374 2b72 656d 7661 7273 0d0a  l_list+remvars..
-00092050: 2323 2323 2323 2323 2323 2323 2323 2323  ################
-00092060: 2323 2323 2323 2323 2323 2323 2323 2323  ################
-00092070: 2323 2323 2323 2323 2323 2323 2323 2323  ################
-00092080: 2323 2323 2323 2323 2323 2323 2323 2323  ################
-00092090: 2323 2323 2323 2323 2323 2323 2323 2323  ################
-000920a0: 2323 230d 0a00 0000 0000 0000 0000 0000  ###.............
-000920b0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-000920c0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-000920d0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-000920e0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-000920f0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-00092100: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-00092110: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-00092120: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-00092130: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-00092140: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-00092150: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-00092160: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-00092170: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-00092180: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-00092190: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-000921a0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-000921b0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-000921c0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-000921d0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-000921e0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-000921f0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-00092200: 2e2f 2e2f 4050 6178 4865 6164 6572 0000  ././@PaxHeader..
-00092210: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-00092220: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-00092230: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-00092240: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-00092250: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-00092260: 0000 0000 3030 3030 3030 3000 3030 3030  ....0000000.0000
-00092270: 3030 3000 3030 3030 3030 3000 3030 3030  000.0000000.0000
-00092280: 3030 3030 3033 3400 3030 3030 3030 3030  0000034.00000000
-00092290: 3030 3000 3031 3134 3532 0020 7800 0000  000.011452. x...
-000922a0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-000922b0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-000922c0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-000922d0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-000922e0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-000922f0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-00092300: 0075 7374 6172 0030 3000 0000 0000 0000  .ustar.00.......
-00092310: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-00092320: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-00092330: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-00092340: 0000 0000 0000 0000 0030 3030 3030 3030  .........0000000
-00092350: 0030 3030 3030 3030 0000 0000 0000 0000  .0000000........
-00092360: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-00092370: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-00092380: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-00092390: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-000923a0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-000923b0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-000923c0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-000923d0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-000923e0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-000923f0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-00092400: 3238 206d 7469 6d65 3d31 3638 3139 3033  28 mtime=1681903
-00092410: 3937 382e 3638 3539 3938 370a 0000 0000  978.6859987.....
-00092420: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-00092430: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-00092440: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-00092450: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-00092460: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-00092470: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-00092480: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-00092490: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-000924a0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-000924b0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-000924c0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-000924d0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-000924e0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-000924f0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-00092500: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-00092510: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-00092520: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-00092530: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-00092540: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-00092550: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-00092560: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-00092570: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-00092580: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-00092590: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-000925a0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-000925b0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-000925c0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-000925d0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-000925e0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-000925f0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-00092600: 6175 746f 7669 6d6c 2d30 2e31 2e37 3134  autoviml-0.1.714
-00092610: 2f61 7574 6f76 696d 6c2e 6567 672d 696e  /autoviml.egg-in
-00092620: 666f 2f00 0000 0000 0000 0000 0000 0000  fo/.............
-00092630: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-00092640: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-00092650: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-00092660: 0000 0000 3030 3030 3737 3700 3030 3031  ....0000777.0001
-00092670: 3735 3000 3030 3031 3735 3000 3030 3030  750.0001750.0000
-00092680: 3030 3030 3030 3000 3030 3030 3030 3030  0000000.00000000
-00092690: 3030 3000 3031 3634 3433 0020 3500 0000  000.016443. 5...
-000926a0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-000926b0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-000926c0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-000926d0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-000926e0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-000926f0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-00092700: 0075 7374 6172 0030 3072 616d 0000 0000  .ustar.00ram....
-00092710: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-00092720: 0000 0000 0000 0000 0072 616d 0000 0000  .........ram....
-00092730: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-00092740: 0000 0000 0000 0000 0030 3030 3030 3030  .........0000000
-00092750: 0030 3030 3030 3030 0000 0000 0000 0000  .0000000........
-00092760: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-00092770: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-00092780: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-00092790: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-000927a0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-000927b0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-000927c0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-000927d0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-000927e0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-000927f0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-00092800: 2e2f 2e2f 4050 6178 4865 6164 6572 0000  ././@PaxHeader..
-00092810: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-00092820: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-00092830: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-00092840: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-00092850: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-00092860: 0000 0000 3030 3030 3030 3000 3030 3030  ....0000000.0000
-00092870: 3030 3000 3030 3030 3030 3000 3030 3030  000.0000000.0000
-00092880: 3030 3030 3032 3600 3030 3030 3030 3030  0000026.00000000
-00092890: 3030 3000 3031 3134 3533 0020 7800 0000  000.011453. x...
-000928a0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+0008fb60: 2323 2323 2323 2323 230d 0a20 2020 2023  #########..    #
+0008fb70: 2323 2323 2020 2020 2020 2020 2020 2020  ####            
+0008fb80: 2020 5355 4c4f 5620 7374 616e 6473 2066    SULOV stands f
+0008fb90: 6f72 2053 6561 7263 6869 6e67 2055 6e63  or Searching Unc
+0008fba0: 6f72 7265 6c61 7465 6420 4c69 7374 204f  orrelated List O
+0008fbb0: 6620 5661 7269 6162 6c65 7320 2023 2323  f Variables  ###
+0008fbc0: 2323 2323 2323 2323 2323 0d0a 2020 2020  ##########..    
+0008fbd0: 5468 6973 2068 6967 686c 7920 6566 6669  This highly effi
+0008fbe0: 6369 656e 7420 6d65 7468 6f64 2072 656d  cient method rem
+0008fbf0: 6f76 6573 2076 6172 6961 626c 6573 2074  oves variables t
+0008fc00: 6861 7420 6172 6520 6869 6768 6c79 2063  hat are highly c
+0008fc10: 6f72 7265 6c61 7465 6420 7573 696e 6720  orrelated using 
+0008fc20: 6120 7365 7269 6573 206f 660d 0a20 2020  a series of..   
+0008fc30: 2070 6169 722d 7769 7365 2063 6f72 7265   pair-wise corre
+0008fc40: 6c61 7469 6f6e 206b 6e6f 636b 6f75 7420  lation knockout 
+0008fc50: 726f 756e 6473 2e20 4974 2069 7320 6578  rounds. It is ex
+0008fc60: 7472 656d 656c 7920 6661 7374 2061 6e64  tremely fast and
+0008fc70: 2068 656e 6365 2063 616e 2077 6f72 6b20   hence can work 
+0008fc80: 6f6e 2074 686f 7573 616e 6473 0d0a 2020  on thousands..  
+0008fc90: 2020 6f66 2076 6172 6961 626c 6573 2069    of variables i
+0008fca0: 6e20 6c65 7373 2074 6861 6e20 6120 6d69  n less than a mi
+0008fcb0: 6e75 7465 2c20 6576 656e 206f 6e20 6120  nute, even on a 
+0008fcc0: 6c61 7074 6f70 2e20 596f 7520 6e65 6564  laptop. You need
+0008fcd0: 2074 6f20 7365 6e64 2069 6e20 6120 6c69   to send in a li
+0008fce0: 7374 206f 6620 6e75 6d65 7269 630d 0a20  st of numeric.. 
+0008fcf0: 2020 2076 6172 6961 626c 6573 2061 6e64     variables and
+0008fd00: 2074 6861 7427 7320 616c 6c21 2054 6865   that's all! The
+0008fd10: 206d 6574 686f 6420 6465 6669 6e65 7320   method defines 
+0008fd20: 6869 6768 2043 6f72 7265 6c61 7469 6f6e  high Correlation
+0008fd30: 2061 7320 616e 7974 6869 6e67 206f 7665   as anything ove
+0008fd40: 7220 302e 3730 2028 6162 736f 6c75 7465  r 0.70 (absolute
+0008fd50: 290d 0a20 2020 2062 7574 2074 6869 7320  )..    but this 
+0008fd60: 6361 6e20 6265 2063 6861 6e67 6564 2e20  can be changed. 
+0008fd70: 4966 2074 776f 2076 6172 6961 626c 6573  If two variables
+0008fd80: 2068 6176 6520 6162 736f 6c75 7465 2063   have absolute c
+0008fd90: 6f72 7265 6c61 7469 6f6e 2068 6967 6865  orrelation highe
+0008fda0: 7220 7468 616e 2074 6869 732c 2074 6865  r than this, the
+0008fdb0: 790d 0a20 2020 2077 696c 6c20 6265 206d  y..    will be m
+0008fdc0: 6172 6b65 642c 2061 6e64 2075 7369 6e67  arked, and using
+0008fdd0: 2061 2070 726f 6365 7373 206f 6620 656c   a process of el
+0008fde0: 696d 696e 6174 696f 6e2c 206f 6e65 206f  imination, one o
+0008fdf0: 6620 7468 656d 2077 696c 6c20 6765 7420  f them will get 
+0008fe00: 6b6e 6f63 6b65 6420 6f75 743a 0d0a 2020  knocked out:..  
+0008fe10: 2020 546f 2064 6563 6964 6520 6f72 6465    To decide orde
+0008fe20: 7220 6f66 2076 6172 6961 626c 6573 2074  r of variables t
+0008fe30: 6f20 6b65 6570 2c20 7765 2075 7365 206d  o keep, we use m
+0008fe40: 7574 7561 696c 2069 6e66 6f72 6d61 7469  utuail informati
+0008fe50: 6f6e 2073 636f 7265 2074 6f20 7365 6c65  on score to sele
+0008fe60: 6374 2e20 4d49 5320 7265 7475 726e 730d  ct. MIS returns.
+0008fe70: 0a20 2020 2061 2072 616e 6b65 6420 6c69  .    a ranked li
+0008fe80: 7374 206f 6620 7468 6573 6520 636f 7272  st of these corr
+0008fe90: 656c 6174 6564 2076 6172 6961 626c 6573  elated variables
+0008fea0: 3a20 7768 656e 2077 6520 7365 6c65 6374  : when we select
+0008feb0: 206f 6e65 2c20 7765 206b 6e6f 636b 206f   one, we knock o
+0008fec0: 7574 206f 7468 6572 730d 0a20 2020 2074  ut others..    t
+0008fed0: 6861 7420 6974 2069 7320 636f 7272 656c  hat it is correl
+0008fee0: 6174 6564 2074 6f2e 2054 6865 6e20 7765  ated to. Then we
+0008fef0: 2073 656c 6563 7420 6e65 7874 2076 6172   select next var
+0008ff00: 2e20 5468 6973 2077 6179 2077 6520 6b6e  . This way we kn
+0008ff10: 6f63 6b20 6f75 7420 636f 7272 656c 6174  ock out correlat
+0008ff20: 6564 2076 6172 6961 626c 6573 2e0d 0a20  ed variables... 
+0008ff30: 2020 2046 696e 616c 6c79 2077 6520 6172     Finally we ar
+0008ff40: 6520 6c65 6674 2077 6974 6820 756e 636f  e left with unco
+0008ff50: 7272 656c 6174 6564 2076 6172 6961 626c  rrelated variabl
+0008ff60: 6573 2074 6861 7420 6172 6520 616c 736f  es that are also
+0008ff70: 2068 6967 686c 7920 696d 706f 7274 616e   highly importan
+0008ff80: 7420 696e 206d 7574 7561 6c20 7363 6f72  t in mutual scor
+0008ff90: 652e 0d0a 2020 2020 2323 2323 2323 2323  e...    ########
+0008ffa0: 2020 594f 5520 4d55 5354 2049 4e43 4c55    YOU MUST INCLU
+0008ffb0: 4445 2054 4845 2041 424f 5645 204d 4553  DE THE ABOVE MES
+0008ffc0: 5341 4745 2049 4620 594f 5520 434f 5059  SAGE IF YOU COPY
+0008ffd0: 2054 4849 5320 434f 4445 2049 4e20 594f   THIS CODE IN YO
+0008ffe0: 5552 204c 4942 5241 5259 2023 2323 2323  UR LIBRARY #####
+0008fff0: 2323 2323 230d 0a20 2020 2022 2222 0d0a  #####..    """..
+00090000: 2020 2020 0d0a 2020 2020 6466 203d 2063      ..    df = c
+00090010: 6f70 792e 6465 6570 636f 7079 2864 6629  opy.deepcopy(df)
+00090020: 0d0a 2020 2020 6466 5f74 6172 6765 7420  ..    df_target 
+00090030: 3d20 6466 5b74 6172 6765 745d 0d0a 2020  = df[target]..  
+00090040: 2020 6e75 6d76 6172 7320 3d20 6466 5b70    numvars = df[p
+00090050: 7265 6473 5f69 6e5d 2e73 656c 6563 745f  reds_in].select_
+00090060: 6474 7970 6573 2869 6e63 6c75 6465 3d27  dtypes(include='
+00090070: 666c 6f61 7427 292e 636f 6c75 6d6e 732e  float').columns.
+00090080: 746f 6c69 7374 2829 0d0a 2020 2020 7265  tolist()..    re
+00090090: 6d76 6172 7320 3d20 6c65 6674 5f73 7562  mvars = left_sub
+000900a0: 7472 6163 7428 7072 6564 735f 696e 2c20  tract(preds_in, 
+000900b0: 6e75 6d76 6172 7329 0d0a 2020 2020 6466  numvars)..    df
+000900c0: 203d 2064 665b 6e75 6d76 6172 735d 0d0a   = df[numvars]..
+000900d0: 2020 2020 2323 2320 666f 7220 736f 6d65      ### for some
+000900e0: 2072 6561 736f 6e2c 2064 6f69 6e67 2061   reason, doing a
+000900f0: 206d 6173 7320 6669 6c6c 6e61 206f 6620   mass fillna of 
+00090100: 7661 7273 2064 6f65 736e 2774 2077 6f72  vars doesn't wor
+00090110: 6b21 2048 656e 6365 2064 6f69 6e67 2069  k! Hence doing i
+00090120: 7420 696e 6469 7669 6475 616c 6c79 210d  t individually!.
+00090130: 0a20 2020 206e 756c 6c5f 7661 7273 203d  .    null_vars =
+00090140: 206e 702e 6172 7261 7928 6e75 6d76 6172   np.array(numvar
+00090150: 7329 5b64 662e 6973 6e75 6c6c 2829 2e73  s)[df.isnull().s
+00090160: 756d 2829 3e30 5d0d 0a20 2020 2066 6f72  um()>0]..    for
+00090170: 2065 6163 685f 6e75 6d20 696e 206e 756c   each_num in nul
+00090180: 6c5f 7661 7273 3a0d 0a20 2020 2020 2020  l_vars:..       
+00090190: 2023 2323 2052 656d 656d 6265 7220 7468   ### Remember th
+000901a0: 6174 2066 696c 6c6e 6120 6f6e 6c79 2077  at fillna only w
+000901b0: 6f72 6b73 2061 7420 7468 6520 6461 7461  orks at the data
+000901c0: 6672 616d 6520 6c65 7665 6c21 0d0a 2020  frame level!..  
+000901d0: 2020 2020 2020 6466 5b5b 6561 6368 5f6e        df[[each_n
+000901e0: 756d 5d5d 203d 2064 665b 5b65 6163 685f  um]] = df[[each_
+000901f0: 6e75 6d5d 5d2e 6669 6c6c 6e61 2830 290d  num]].fillna(0).
+00090200: 0a20 2020 2074 6172 6765 7420 3d20 636f  .    target = co
+00090210: 7079 2e64 6565 7063 6f70 7928 7461 7267  py.deepcopy(targ
+00090220: 6574 290d 0a0d 0a20 2020 2070 7269 6e74  et)....    print
+00090230: 2827 2323 2323 2323 2323 2323 2323 2323  ('##############
+00090240: 2323 2323 2323 2323 2323 2323 2323 2323  ################
+00090250: 2323 2323 2323 2323 2323 2323 2323 2323  ################
+00090260: 2323 2323 2323 2323 2323 2323 2323 2323  ################
+00090270: 2323 2323 2323 2323 2323 2323 2323 2323  ################
+00090280: 2323 2323 2323 2323 2327 290d 0a20 2020  #########')..   
+00090290: 2070 7269 6e74 2827 2323 2323 2320 2053   print('#####  S
+000902a0: 554c 4f56 3a20 2053 6561 7263 6869 6e67  ULOV:  Searching
+000902b0: 2066 6f72 2055 6e63 6f72 7265 6c61 7465   for Uncorrelate
+000902c0: 6420 4c69 7374 204f 6620 5661 7269 6162  d List Of Variab
+000902d0: 6c65 7320 696e 2025 7320 6665 6174 7572  les in %s featur
+000902e0: 6573 2023 2323 2323 2323 2323 2323 2327  es ############'
+000902f0: 2025 6c65 6e28 6e75 6d76 6172 7329 290d   %len(numvars)).
+00090300: 0a20 2020 2070 7269 6e74 2827 2323 2323  .    print('####
+00090310: 2323 2323 2323 2323 2323 2323 2323 2323  ################
+00090320: 2323 2323 2323 2323 2323 2323 2323 2323  ################
+00090330: 2323 2323 2323 2323 2323 2323 2323 2323  ################
+00090340: 2323 2323 2323 2323 2323 2323 2323 2323  ################
+00090350: 2323 2323 2323 2323 2323 2323 2323 2323  ################
+00090360: 2323 2327 290d 0a20 2020 2023 2323 2054  ###')..    ### T
+00090370: 6869 7320 6973 2061 2073 686f 7274 6572  his is a shorter
+00090380: 2076 6572 7369 6f6e 206f 6620 6765 7474   version of gett
+00090390: 696e 6720 756e 6475 706c 6963 6174 6564  ing unduplicated
+000903a0: 2061 6e64 2068 6967 686c 7920 636f 7272   and highly corr
+000903b0: 656c 6174 6564 2076 6172 7320 2323 0d0a  elated vars ##..
+000903c0: 2020 2020 636f 7272 656c 6174 696f 6e5f      correlation_
+000903d0: 6461 7461 6672 616d 6520 3d20 6466 2e63  dataframe = df.c
+000903e0: 6f72 7228 292e 6162 7328 292e 756e 7374  orr().abs().unst
+000903f0: 6163 6b28 292e 736f 7274 5f76 616c 7565  ack().sort_value
+00090400: 7328 292e 6472 6f70 5f64 7570 6c69 6361  s().drop_duplica
+00090410: 7465 7328 290d 0a20 2020 2063 6f72 7264  tes()..    corrd
+00090420: 6620 3d20 7064 2e44 6174 6146 7261 6d65  f = pd.DataFrame
+00090430: 2863 6f72 7265 6c61 7469 6f6e 5f64 6174  (correlation_dat
+00090440: 6166 7261 6d65 5b3a 5d2e 7265 7365 745f  aframe[:].reset_
+00090450: 696e 6465 7828 2929 0d0a 2020 2020 636f  index())..    co
+00090460: 7272 6466 2e63 6f6c 756d 6e73 203d 205b  rrdf.columns = [
+00090470: 2776 6172 3127 2c27 7661 7232 272c 2763  'var1','var2','c
+00090480: 6f65 6666 275d 0d0a 2020 2020 636f 7272  oeff']..    corr
+00090490: 6466 3120 3d20 636f 7272 6466 5b63 6f72  df1 = corrdf[cor
+000904a0: 7264 665b 2763 6f65 6666 275d 3e3d 636f  rdf['coeff']>=co
+000904b0: 7272 5f6c 696d 6974 5d0d 0a20 2020 2063  rr_limit]..    c
+000904c0: 6f72 7265 6c61 7465 645f 7061 6972 203d  orrelated_pair =
+000904d0: 206c 6973 7428 7a69 7028 636f 7272 6466   list(zip(corrdf
+000904e0: 315b 2776 6172 3127 5d2e 7661 6c75 6573  1['var1'].values
+000904f0: 2e74 6f6c 6973 7428 292c 636f 7272 6466  .tolist(),corrdf
+00090500: 315b 2776 6172 3227 5d2e 7661 6c75 6573  1['var2'].values
+00090510: 2e74 6f6c 6973 7428 2929 290d 0a20 2020  .tolist()))..   
+00090520: 2063 6f72 725f 7061 6972 5f64 6963 7420   corr_pair_dict 
+00090530: 3d20 6469 6374 2872 6574 7572 6e5f 6469  = dict(return_di
+00090540: 6374 696f 6e61 7279 5f6c 6973 7428 636f  ctionary_list(co
+00090550: 7272 656c 6174 6564 5f70 6169 7229 290d  rrelated_pair)).
+00090560: 0a20 2020 2063 6f72 725f 6c69 7374 203d  .    corr_list =
+00090570: 2066 696e 645f 7265 6d6f 7665 5f64 7570   find_remove_dup
+00090580: 6c69 6361 7465 7328 636f 7272 6466 315b  licates(corrdf1[
+00090590: 2776 6172 3127 5d2e 7661 6c75 6573 2e74  'var1'].values.t
+000905a0: 6f6c 6973 7428 292b 636f 7272 6466 315b  olist()+corrdf1[
+000905b0: 2776 6172 3227 5d2e 7661 6c75 6573 2e74  'var2'].values.t
+000905c0: 6f6c 6973 7428 2929 0d0a 2020 2020 6b65  olist())..    ke
+000905d0: 7973 5f69 6e5f 6469 6374 203d 206c 6973  ys_in_dict = lis
+000905e0: 7428 636f 7272 5f70 6169 725f 6469 6374  t(corr_pair_dict
+000905f0: 2e6b 6579 7328 2929 0d0a 2020 2020 7265  .keys())..    re
+00090600: 7665 7273 655f 636f 7272 656c 6174 6564  verse_correlated
+00090610: 5f70 6169 7220 3d20 5b28 792c 7829 2066  _pair = [(y,x) f
+00090620: 6f72 2028 782c 7929 2069 6e20 636f 7272  or (x,y) in corr
+00090630: 656c 6174 6564 5f70 6169 725d 0d0a 2020  elated_pair]..  
+00090640: 2020 7265 7665 7273 655f 636f 7272 5f70    reverse_corr_p
+00090650: 6169 725f 6469 6374 203d 2064 6963 7428  air_dict = dict(
+00090660: 7265 7475 726e 5f64 6963 7469 6f6e 6172  return_dictionar
+00090670: 795f 6c69 7374 2872 6576 6572 7365 5f63  y_list(reverse_c
+00090680: 6f72 7265 6c61 7465 645f 7061 6972 2929  orrelated_pair))
+00090690: 0d0a 2020 2020 2323 2323 2063 6f72 725f  ..    #### corr_
+000906a0: 7061 6972 5f64 6963 7420 6973 2075 7365  pair_dict is use
+000906b0: 6420 6c61 7465 7220 746f 206d 616b 6520  d later to make 
+000906c0: 7468 6520 6e65 7477 6f72 6b20 6469 6167  the network diag
+000906d0: 7261 6d20 746f 2073 6565 2077 6869 6368  ram to see which
+000906e0: 2076 6172 7320 6172 6520 636f 7272 656c   vars are correl
+000906f0: 6174 6564 2074 6f20 7768 6963 680d 0a20  ated to which.. 
+00090700: 2020 2066 6f72 206b 6579 2c20 7661 6c20     for key, val 
+00090710: 696e 2072 6576 6572 7365 5f63 6f72 725f  in reverse_corr_
+00090720: 7061 6972 5f64 6963 742e 6974 656d 7328  pair_dict.items(
+00090730: 293a 0d0a 2020 2020 2020 2020 6966 206b  ):..        if k
+00090740: 6579 2069 6e20 6b65 7973 5f69 6e5f 6469  ey in keys_in_di
+00090750: 6374 3a0d 0a20 2020 2020 2020 2020 2020  ct:..           
+00090760: 2069 6620 6c65 6e28 6b65 7929 203e 2031   if len(key) > 1
+00090770: 3a0d 0a20 2020 2020 2020 2020 2020 2020  :..             
+00090780: 2020 2063 6f72 725f 7061 6972 5f64 6963     corr_pair_dic
+00090790: 745b 6b65 795d 202b 3d20 7661 6c0d 0a20  t[key] += val.. 
+000907a0: 2020 2020 2020 2065 6c73 653a 0d0a 2020         else:..  
+000907b0: 2020 2020 2020 2020 2020 636f 7272 5f70            corr_p
+000907c0: 6169 725f 6469 6374 5b6b 6579 5d20 3d20  air_dict[key] = 
+000907d0: 7661 6c0d 0a0d 0a20 2020 2023 2323 2323  val....    #####
+000907e0: 2320 5468 6973 2069 7320 666f 7220 6f72  # This is for or
+000907f0: 6465 7269 6e67 2074 6865 2076 6172 6961  dering the varia
+00090800: 626c 6573 2069 6e20 7468 6520 6869 6768  bles in the high
+00090810: 6573 7420 746f 206c 6f77 6573 7420 696d  est to lowest im
+00090820: 706f 7274 616e 6365 2074 6f20 7461 7267  portance to targ
+00090830: 6574 2023 2323 0d0a 2020 2020 6966 206c  et ###..    if l
+00090840: 656e 2863 6f72 725f 6c69 7374 2920 3d3d  en(corr_list) ==
+00090850: 2030 3a0d 0a20 2020 2020 2020 2066 696e   0:..        fin
+00090860: 616c 5f6c 6973 7420 3d20 6c69 7374 2863  al_list = list(c
+00090870: 6f72 7265 6c61 7469 6f6e 5f64 6174 6166  orrelation_dataf
+00090880: 7261 6d65 290d 0a20 2020 2020 2020 2070  rame)..        p
+00090890: 7269 6e74 2827 5365 6c65 6374 696e 6720  rint('Selecting 
+000908a0: 616c 6c20 2825 6429 2076 6172 6961 626c  all (%d) variabl
+000908b0: 6573 2073 696e 6365 206e 6f6e 6520 6f66  es since none of
+000908c0: 206e 756d 6572 6963 2076 6172 7320 6172   numeric vars ar
+000908d0: 6520 6869 6768 6c79 2063 6f72 7265 6c61  e highly correla
+000908e0: 7465 642e 2e2e 2720 256c 656e 286e 756d  ted...' %len(num
+000908f0: 7661 7273 2929 0d0a 2020 2020 2020 2020  vars))..        
+00090900: 7265 7475 726e 206e 756d 7661 7273 0d0a  return numvars..
+00090910: 2020 2020 656c 7365 3a0d 0a20 2020 2020      else:..     
+00090920: 2020 2069 6620 6973 696e 7374 616e 6365     if isinstance
+00090930: 2874 6172 6765 742c 206c 6973 7429 3a0d  (target, list):.
+00090940: 0a20 2020 2020 2020 2020 2020 2074 6172  .            tar
+00090950: 6765 7420 3d20 7461 7267 6574 5b30 5d0d  get = target[0].
+00090960: 0a20 2020 2020 2020 206d 6178 5f66 6561  .        max_fea
+00090970: 7473 203d 206c 656e 2863 6f72 725f 6c69  ts = len(corr_li
+00090980: 7374 290d 0a20 2020 2020 2020 2069 6620  st)..        if 
+00090990: 6d6f 6465 6c74 7970 6520 3d3d 2027 5265  modeltype == 'Re
+000909a0: 6772 6573 7369 6f6e 273a 0d0a 2020 2020  gression':..    
+000909b0: 2020 2020 2020 2020 7365 6c5f 6675 6e63          sel_func
+000909c0: 7469 6f6e 203d 206d 7574 7561 6c5f 696e  tion = mutual_in
+000909d0: 666f 5f72 6567 7265 7373 696f 6e0d 0a20  fo_regression.. 
+000909e0: 2020 2020 2020 2020 2020 2066 7320 3d20             fs = 
+000909f0: 5365 6c65 6374 4b42 6573 7428 7363 6f72  SelectKBest(scor
+00090a00: 655f 6675 6e63 3d73 656c 5f66 756e 6374  e_func=sel_funct
+00090a10: 696f 6e2c 206b 3d6d 6178 5f66 6561 7473  ion, k=max_feats
+00090a20: 290d 0a20 2020 2020 2020 2065 6c73 653a  )..        else:
+00090a30: 0d0a 2020 2020 2020 2020 2020 2020 7365  ..            se
+00090a40: 6c5f 6675 6e63 7469 6f6e 203d 206d 7574  l_function = mut
+00090a50: 7561 6c5f 696e 666f 5f63 6c61 7373 6966  ual_info_classif
+00090a60: 0d0a 2020 2020 2020 2020 2020 2020 6673  ..            fs
+00090a70: 203d 2053 656c 6563 744b 4265 7374 2873   = SelectKBest(s
+00090a80: 636f 7265 5f66 756e 633d 7365 6c5f 6675  core_func=sel_fu
+00090a90: 6e63 7469 6f6e 2c20 6b3d 6d61 785f 6665  nction, k=max_fe
+00090aa0: 6174 7329 0d0a 2020 2020 2020 2020 2323  ats)..        ##
+00090ab0: 2323 2320 796f 7520 6d75 7374 2065 6e73  ### you must ens
+00090ac0: 7572 6520 7468 6572 6520 6172 6520 6e6f  ure there are no
+00090ad0: 2069 6e66 696e 6974 6520 6e6f 7220 6e75   infinite nor nu
+00090ae0: 6c6c 2076 616c 7565 7320 696e 2063 6f72  ll values in cor
+00090af0: 725f 6c69 7374 2064 6620 2323 0d0a 2020  r_list df ##..  
+00090b00: 2020 2020 2020 6466 5f66 6974 203d 2064        df_fit = d
+00090b10: 665b 636f 7272 5f6c 6973 745d 0d0a 2020  f[corr_list]..  
+00090b20: 2020 2020 2020 2323 2320 4e6f 7720 6368        ### Now ch
+00090b30: 6563 6b20 6966 2074 6865 7265 2061 7265  eck if there are
+00090b40: 2061 6e79 204e 614e 2076 616c 7565 7320   any NaN values 
+00090b50: 696e 2074 6865 2064 6174 6173 6574 2023  in the dataset #
+00090b60: 2323 2323 0d0a 2020 2020 2020 2020 0d0a  ####..        ..
+00090b70: 2020 2020 2020 2020 6966 2064 665f 6669          if df_fi
+00090b80: 742e 6973 6e75 6c6c 2829 2e73 756d 2829  t.isnull().sum()
+00090b90: 2e73 756d 2829 203e 2030 3a0d 0a20 2020  .sum() > 0:..   
+00090ba0: 2020 2020 2020 2020 2064 665f 6669 7420           df_fit 
+00090bb0: 3d20 6466 5f66 6974 2e64 726f 706e 6128  = df_fit.dropna(
+00090bc0: 290d 0a20 2020 2020 2020 2065 6c73 653a  )..        else:
+00090bd0: 0d0a 2020 2020 2020 2020 2020 2020 7072  ..            pr
+00090be0: 696e 7428 2720 2020 2074 6865 7265 2061  int('    there a
+00090bf0: 7265 206e 6f20 6e75 6c6c 2076 616c 7565  re no null value
+00090c00: 7320 696e 2064 6174 6173 6574 2e2e 2e27  s in dataset...'
+00090c10: 290d 0a20 2020 2020 2020 2023 2323 2323  )..        #####
+00090c20: 2052 6564 7563 6520 6d65 6d6f 7279 2075   Reduce memory u
+00090c30: 7361 6765 2061 6e64 2066 696e 6420 6d75  sage and find mu
+00090c40: 7475 616c 2069 6e66 6f72 6d61 7469 6f6e  tual information
+00090c50: 2073 636f 7265 2023 2323 2320 2020 2020   score ####     
+00090c60: 2020 0d0a 2020 2020 2020 2020 2374 7279    ..        #try
+00090c70: 3a0d 0a20 2020 2020 2020 2023 2020 2020  :..        #    
+00090c80: 6466 5f66 6974 203d 2072 6564 7563 655f  df_fit = reduce_
+00090c90: 6d65 6d5f 7573 6167 6528 6466 5f66 6974  mem_usage(df_fit
+00090ca0: 290d 0a20 2020 2020 2020 2023 6578 6365  )..        #exce
+00090cb0: 7074 3a0d 0a20 2020 2020 2020 2023 2020  pt:..        #  
+00090cc0: 2020 7072 696e 7428 2752 6564 7563 6520    print('Reduce 
+00090cd0: 6d65 6d6f 7279 2065 7272 6f72 696e 672e  memory erroring.
+00090ce0: 2043 6f6e 7469 6e75 696e 672e 2e2e 2729   Continuing...')
+00090cf0: 0d0a 2020 2020 2020 2020 2323 2323 2320  ..        ##### 
+00090d00: 5265 6164 7920 746f 2070 6572 666f 726d  Ready to perform
+00090d10: 2066 6974 2061 6e64 2066 696e 6420 6d75   fit and find mu
+00090d20: 7475 616c 2069 6e66 6f72 6d61 7469 6f6e  tual information
+00090d30: 2073 636f 7265 2023 2323 230d 0a20 2020   score ####..   
+00090d40: 2020 2020 2074 7279 3a0d 0a20 2020 2020       try:..     
+00090d50: 2020 2020 2020 2066 732e 6669 7428 6466         fs.fit(df
+00090d60: 5f66 6974 2c20 6466 5f74 6172 6765 7429  _fit, df_target)
+00090d70: 0d0a 2020 2020 2020 2020 6578 6365 7074  ..        except
+00090d80: 3a0d 0a20 2020 2020 2020 2020 2020 2070  :..            p
+00090d90: 7269 6e74 2827 2020 2020 5365 6c65 6374  rint('    Select
+00090da0: 4b42 6573 7428 2920 6675 6e63 7469 6f6e  KBest() function
+00090db0: 2069 7320 6572 726f 7269 6e67 2e20 5265   is erroring. Re
+00090dc0: 7475 726e 696e 6720 7769 7468 2061 6c6c  turning with all
+00090dd0: 2025 7320 7661 7269 6162 6c65 732e 2e2e   %s variables...
+00090de0: 2720 256c 656e 286e 756d 7661 7273 2929  ' %len(numvars))
+00090df0: 0d0a 2020 2020 2020 2020 2020 2020 7265  ..            re
+00090e00: 7475 726e 206e 756d 7661 7273 0d0a 2020  turn numvars..  
+00090e10: 2020 2020 2020 7472 793a 0d0a 2020 2020        try:..    
+00090e20: 2020 2020 2020 2020 2323 2323 2323 2323          ########
+00090e30: 2323 2323 2323 2323 2323 2323 2323 2323  ################
+00090e40: 2323 2323 2323 2323 2323 2323 2323 2323  ################
+00090e50: 2323 2323 2323 2323 2323 2323 2323 2323  ################
+00090e60: 2323 2323 2323 2323 2323 2323 2323 2323  ################
+00090e70: 2323 2323 2323 2323 230d 0a20 2020 2020  #########..     
+00090e80: 2020 2020 2020 2023 2323 2323 2323 2020         #######  
+00090e90: 2054 6869 7320 6973 2074 6865 206d 6169   This is the mai
+00090ea0: 6e20 7365 6374 696f 6e20 7768 6572 6520  n section where 
+00090eb0: 7765 2075 7365 206d 7574 7561 6c20 696e  we use mutual in
+00090ec0: 666f 2073 636f 7265 2074 6f20 7365 6c65  fo score to sele
+00090ed0: 6374 2076 6172 7320 2020 2020 2020 200d  ct vars        .
+00090ee0: 0a20 2020 2020 2020 2020 2020 2023 2323  .            ###
+00090ef0: 2323 2323 2323 2323 2323 2323 2323 2323  ################
+00090f00: 2323 2323 2323 2323 2323 2323 2323 2323  ################
+00090f10: 2323 2323 2323 2323 2323 2323 2323 2323  ################
+00090f20: 2323 2323 2323 2323 2323 2323 2323 2323  ################
+00090f30: 2323 2323 2323 2323 2323 2323 2323 0d0a  ##############..
+00090f40: 2020 2020 2020 2020 2020 2020 6d75 7475              mutu
+00090f50: 616c 5f69 6e66 6f20 3d20 6469 6374 287a  al_info = dict(z
+00090f60: 6970 2863 6f72 725f 6c69 7374 2c66 732e  ip(corr_list,fs.
+00090f70: 7363 6f72 6573 5f29 290d 0a20 2020 2020  scores_))..     
+00090f80: 2020 2020 2020 2023 2323 2320 5468 6520         #### The 
+00090f90: 6669 7273 7420 7661 7269 6162 6c65 2069  first variable i
+00090fa0: 6e20 6c69 7374 2068 6173 2074 6865 2068  n list has the h
+00090fb0: 6967 6865 7374 2063 6f72 7265 6c61 7469  ighest correlati
+00090fc0: 6f6e 2074 6f20 7468 6520 7461 7267 6574  on to the target
+00090fd0: 2076 6172 6961 626c 6520 2323 230d 0a20   variable ###.. 
+00090fe0: 2020 2020 2020 2020 2020 2073 6f72 7465             sorte
+00090ff0: 645f 6279 5f6d 7574 7561 6c5f 696e 666f  d_by_mutual_info
+00091000: 203d 5b6b 6579 2066 6f72 2028 6b65 792c   =[key for (key,
+00091010: 7661 6c29 2069 6e20 736f 7274 6564 286d  val) in sorted(m
+00091020: 7574 7561 6c5f 696e 666f 2e69 7465 6d73  utual_info.items
+00091030: 2829 2c20 6b65 793d 6c61 6d62 6461 206b  (), key=lambda k
+00091040: 763a 206b 765b 315d 2c72 6576 6572 7365  v: kv[1],reverse
+00091050: 3d54 7275 6529 5d0d 0a20 2020 2020 2020  =True)]..       
+00091060: 2020 2020 2023 2323 2323 2020 204e 6f77       #####   Now
+00091070: 2077 6520 7365 6c65 6374 2074 6865 2066   we select the f
+00091080: 696e 616c 206c 6973 7420 6f66 2063 6f72  inal list of cor
+00091090: 7265 6c61 7465 6420 7661 7269 6162 6c65  related variable
+000910a0: 7320 2323 2323 2323 2323 2323 230d 0a20  s ###########.. 
+000910b0: 2020 2020 2020 2020 2020 2073 656c 6563             selec
+000910c0: 7465 645f 636f 7272 5f6c 6973 7420 3d20  ted_corr_list = 
+000910d0: 5b5d 0d0a 2020 2020 2020 2020 2020 2020  []..            
+000910e0: 2323 2323 2059 6f75 2068 6176 6520 746f  #### You have to
+000910f0: 206d 616b 6520 6d75 6c74 6970 6c65 2063   make multiple c
+00091100: 6f70 6965 7320 6f66 2074 6869 7320 736f  opies of this so
+00091110: 7274 6564 206c 6973 7420 7369 6e63 6520  rted list since 
+00091120: 6974 2069 7320 6974 6572 6174 6564 206d  it is iterated m
+00091130: 616e 7920 7469 6d65 7320 2323 2323 0d0a  any times ####..
+00091140: 2020 2020 2020 2020 2020 2020 6f72 6967              orig
+00091150: 5f73 6f72 7465 6420 3d20 636f 7079 2e64  _sorted = copy.d
+00091160: 6565 7063 6f70 7928 736f 7274 6564 5f62  eepcopy(sorted_b
+00091170: 795f 6d75 7475 616c 5f69 6e66 6f29 0d0a  y_mutual_info)..
+00091180: 2020 2020 2020 2020 2020 2020 636f 7079              copy
+00091190: 5f73 6f72 7465 6420 3d20 636f 7079 2e64  _sorted = copy.d
+000911a0: 6565 7063 6f70 7928 736f 7274 6564 5f62  eepcopy(sorted_b
+000911b0: 795f 6d75 7475 616c 5f69 6e66 6f29 0d0a  y_mutual_info)..
+000911c0: 2020 2020 2020 2020 2020 2020 636f 7079              copy
+000911d0: 5f70 6169 7220 3d20 636f 7079 2e64 6565  _pair = copy.dee
+000911e0: 7063 6f70 7928 636f 7272 5f70 6169 725f  pcopy(corr_pair_
+000911f0: 6469 6374 290d 0a20 2020 2020 2020 2020  dict)..         
+00091200: 2020 2023 2323 2320 7365 6c65 6374 2065     #### select e
+00091210: 6163 6820 7661 7269 6162 6c65 2062 7920  ach variable by 
+00091220: 7468 6520 6869 6768 6573 7420 6d75 7475  the highest mutu
+00091230: 616c 2069 6e66 6f20 616e 6420 7365 6520  al info and see 
+00091240: 7768 6174 2076 6172 7320 6172 6520 636f  what vars are co
+00091250: 7272 656c 6174 6564 2074 6f20 6974 0d0a  rrelated to it..
+00091260: 2020 2020 2020 2020 2020 2020 666f 7220              for 
+00091270: 6561 6368 5f63 6f72 725f 6e61 6d65 2069  each_corr_name i
+00091280: 6e20 636f 7079 5f73 6f72 7465 643a 0d0a  n copy_sorted:..
+00091290: 2020 2020 2020 2020 2020 2020 2020 2020                  
+000912a0: 2323 2320 6164 6420 7468 6520 7365 6c65  ### add the sele
+000912b0: 6374 6564 2076 6172 2074 6f20 7468 6520  cted var to the 
+000912c0: 7365 6c65 6374 6564 5f63 6f72 725f 6c69  selected_corr_li
+000912d0: 7374 0d0a 2020 2020 2020 2020 2020 2020  st..            
+000912e0: 2020 2020 7365 6c65 6374 6564 5f63 6f72      selected_cor
+000912f0: 725f 6c69 7374 2e61 7070 656e 6428 6561  r_list.append(ea
+00091300: 6368 5f63 6f72 725f 6e61 6d65 290d 0a20  ch_corr_name).. 
+00091310: 2020 2020 2020 2020 2020 2020 2020 2066                 f
+00091320: 6f72 2065 6163 685f 7265 6d6f 7665 2069  or each_remove i
+00091330: 6e20 636f 7079 5f70 6169 725b 6561 6368  n copy_pair[each
+00091340: 5f63 6f72 725f 6e61 6d65 5d3a 0d0a 2020  _corr_name]:..  
+00091350: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00091360: 2020 2323 2323 204e 6f77 2072 656d 6f76    #### Now remov
+00091370: 6520 6561 6368 2076 6172 6961 626c 6520  e each variable 
+00091380: 7468 6174 2069 7320 6869 6768 6c79 2063  that is highly c
+00091390: 6f72 7265 6c61 7465 6420 746f 2074 6865  orrelated to the
+000913a0: 2073 656c 6563 7465 6420 7661 7269 6162   selected variab
+000913b0: 6c65 0d0a 2020 2020 2020 2020 2020 2020  le..            
+000913c0: 2020 2020 2020 2020 6966 2065 6163 685f          if each_
+000913d0: 7265 6d6f 7665 2069 6e20 636f 7079 5f73  remove in copy_s
+000913e0: 6f72 7465 643a 0d0a 2020 2020 2020 2020  orted:..        
+000913f0: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00091400: 636f 7079 5f73 6f72 7465 642e 7265 6d6f  copy_sorted.remo
+00091410: 7665 2865 6163 685f 7265 6d6f 7665 290d  ve(each_remove).
+00091420: 0a20 2020 2020 2020 2020 2020 2023 2323  .            ###
+00091430: 2323 204e 6f77 2077 6520 636f 6d62 696e  ## Now we combin
+00091440: 6520 7468 6520 756e 636f 7272 656c 6174  e the uncorrelat
+00091450: 6564 206c 6973 7420 746f 2074 6865 2073  ed list to the s
+00091460: 656c 6563 7465 6420 636f 7272 656c 6174  elected correlat
+00091470: 6564 206c 6973 7420 6162 6f76 650d 0a20  ed list above.. 
+00091480: 2020 2020 2020 2020 2020 2072 656d 5f63             rem_c
+00091490: 6f6c 5f6c 6973 7420 3d20 6c65 6674 5f73  ol_list = left_s
+000914a0: 7562 7472 6163 7428 6e75 6d76 6172 732c  ubtract(numvars,
+000914b0: 636f 7272 5f6c 6973 7429 0d0a 2020 2020  corr_list)..    
+000914c0: 2020 2020 2020 2020 6669 6e61 6c5f 6c69          final_li
+000914d0: 7374 203d 2072 656d 5f63 6f6c 5f6c 6973  st = rem_col_lis
+000914e0: 7420 2b20 7365 6c65 6374 6564 5f63 6f72  t + selected_cor
+000914f0: 725f 6c69 7374 0d0a 2020 2020 2020 2020  r_list..        
+00091500: 2020 2020 7265 6d6f 7665 645f 636f 6c73      removed_cols
+00091510: 203d 206c 6566 745f 7375 6274 7261 6374   = left_subtract
+00091520: 286e 756d 7661 7273 2c20 6669 6e61 6c5f  (numvars, final_
+00091530: 6c69 7374 290d 0a20 2020 2020 2020 2065  list)..        e
+00091540: 7863 6570 7420 4578 6365 7074 696f 6e20  xcept Exception 
+00091550: 6173 2065 3a0d 0a20 2020 2020 2020 2020  as e:..         
+00091560: 2020 2070 7269 6e74 2827 2020 2020 5355     print('    SU
+00091570: 4c4f 5620 4d65 7468 6f64 2063 7261 7368  LOV Method crash
+00091580: 696e 6720 6475 6520 746f 2025 7327 2025  ing due to %s' %
+00091590: 6529 0d0a 2020 2020 2020 2020 2020 2020  e)..            
+000915a0: 2323 2323 2044 726f 7070 696e 6720 6869  #### Dropping hi
+000915b0: 6768 6c79 2063 6f72 7265 6c61 7465 6420  ghly correlated 
+000915c0: 4665 6174 7572 6573 2066 6173 7420 7573  Features fast us
+000915d0: 696e 6720 7369 6d70 6c65 206c 696e 6561  ing simple linea
+000915e0: 7220 636f 7272 656c 6174 696f 6e20 2323  r correlation ##
+000915f0: 230d 0a20 2020 2020 2020 2020 2020 2072  #..            r
+00091600: 656d 6f76 6564 5f63 6f6c 7320 3d20 7265  emoved_cols = re
+00091610: 6d6f 7665 5f68 6967 686c 795f 636f 7272  move_highly_corr
+00091620: 656c 6174 6564 5f76 6172 735f 6661 7374  elated_vars_fast
+00091630: 2864 662c 636f 7272 5f6c 696d 6974 290d  (df,corr_limit).
+00091640: 0a20 2020 2020 2020 2020 2020 2066 696e  .            fin
+00091650: 616c 5f6c 6973 7420 3d20 6c65 6674 5f73  al_list = left_s
+00091660: 7562 7472 6163 7428 6e75 6d76 6172 732c  ubtract(numvars,
+00091670: 2072 656d 6f76 6564 5f63 6f6c 7329 0d0a   removed_cols)..
+00091680: 2020 2020 2020 2020 6966 206c 656e 2872          if len(r
+00091690: 656d 6f76 6564 5f63 6f6c 7329 203e 2030  emoved_cols) > 0
+000916a0: 3a0d 0a20 2020 2020 2020 2020 2020 2070  :..            p
+000916b0: 7269 6e74 2827 2020 2020 5265 6d6f 7669  rint('    Removi
+000916c0: 6e67 2028 2564 2920 6869 6768 6c79 2063  ng (%d) highly c
+000916d0: 6f72 7265 6c61 7465 6420 7661 7269 6162  orrelated variab
+000916e0: 6c65 733a 2720 2528 6c65 6e28 7265 6d6f  les:' %(len(remo
+000916f0: 7665 645f 636f 6c73 2929 290d 0a20 2020  ved_cols)))..   
+00091700: 2020 2020 2020 2020 2069 6620 6c65 6e28           if len(
+00091710: 7265 6d6f 7665 645f 636f 6c73 2920 3c3d  removed_cols) <=
+00091720: 2033 303a 0d0a 2020 2020 2020 2020 2020   30:..          
+00091730: 2020 2020 2020 7072 696e 7428 2720 2020        print('   
+00091740: 2025 7327 2025 7265 6d6f 7665 645f 636f   %s' %removed_co
+00091750: 6c73 290d 0a20 2020 2020 2020 2020 2020  ls)..           
+00091760: 2069 6620 6c65 6e28 6669 6e61 6c5f 6c69   if len(final_li
+00091770: 7374 2920 3c3d 2033 303a 0d0a 2020 2020  st) <= 30:..    
+00091780: 2020 2020 2020 2020 2020 2020 7072 696e              prin
+00091790: 7428 2720 2020 2046 6f6c 6c6f 7769 6e67  t('    Following
+000917a0: 2028 2564 2920 7661 7273 2073 656c 6563   (%d) vars selec
+000917b0: 7465 643a 2025 7327 2025 286c 656e 2866  ted: %s' %(len(f
+000917c0: 696e 616c 5f6c 6973 7429 2c66 696e 616c  inal_list),final
+000917d0: 5f6c 6973 7429 290d 0a20 2020 2020 2020  _list))..       
+000917e0: 2023 2323 2323 2323 2323 2323 2323 2320   ############## 
+000917f0: 2020 2044 2052 2041 2057 2020 2043 204f     D R A W   C O
+00091800: 2052 2052 2045 204c 2041 2054 2049 204f   R R E L A T I O
+00091810: 204e 2020 204e 2045 2054 2057 204f 2052   N   N E T W O R
+00091820: 204b 2023 2323 2323 2323 2323 2323 2323   K #############
+00091830: 2323 2323 230d 0a20 2020 2020 2020 2073  #####..        s
+00091840: 656c 6563 7465 6420 3d20 636f 7079 2e64  elected = copy.d
+00091850: 6565 7063 6f70 7928 6669 6e61 6c5f 6c69  eepcopy(final_li
+00091860: 7374 290d 0a20 2020 2020 2020 2074 7279  st)..        try
+00091870: 3a0d 0a20 2020 2020 2020 2020 2020 2069  :..            i
+00091880: 6d70 6f72 7420 6e65 7477 6f72 6b78 2061  mport networkx a
+00091890: 7320 6e78 0d0a 2020 2020 2020 2020 2020  s nx..          
+000918a0: 2020 2323 2323 204e 6f77 2073 7461 7274    #### Now start
+000918b0: 2062 7569 6c64 696e 6720 7468 6520 6772   building the gr
+000918c0: 6170 6820 2323 2323 2323 2323 2323 2323  aph ############
+000918d0: 2323 2323 2323 230d 0a20 2020 2020 2020  #######..       
+000918e0: 2020 2020 2067 6620 3d20 6e78 2e47 7261       gf = nx.Gra
+000918f0: 7068 2829 0d0a 2020 2020 2020 2020 2020  ph()..          
+00091900: 2020 2323 2320 7468 6520 6d75 7475 616c    ### the mutual
+00091910: 2069 6e66 6f20 7363 6f72 6520 6769 7665   info score give
+00091920: 7320 7468 6520 7369 7a65 206f 6620 7468  s the size of th
+00091930: 6520 6275 6262 6c65 2023 2323 0d0a 2020  e bubble ###..  
+00091940: 2020 2020 2020 2020 2020 6d75 6c74 6970            multip
+00091950: 6c69 6572 203d 2032 3130 300d 0a20 2020  lier = 2100..   
+00091960: 2020 2020 2020 2020 2066 6f72 2065 6163           for eac
+00091970: 6820 696e 206f 7269 675f 736f 7274 6564  h in orig_sorted
+00091980: 3a0d 0a20 2020 2020 2020 2020 2020 2020  :..             
+00091990: 2020 2067 662e 6164 645f 6e6f 6465 2865     gf.add_node(e
+000919a0: 6163 682c 2073 697a 653d 696e 7428 6d61  ach, size=int(ma
+000919b0: 7828 312c 6d75 7475 616c 5f69 6e66 6f5b  x(1,mutual_info[
+000919c0: 6561 6368 5d2a 6d75 6c74 6970 6c69 6572  each]*multiplier
+000919d0: 2929 290d 0a20 2020 2020 2020 2020 2020  )))..           
+000919e0: 2023 2323 2323 2323 2323 2054 6869 7320   ######### This 
+000919f0: 6973 2077 6865 7265 2079 6f75 2063 616c  is where you cal
+00091a00: 6375 6c61 7465 2074 6865 2073 697a 6520  culate the size 
+00091a10: 6f66 2065 6163 6820 6e6f 6465 2074 6f20  of each node to 
+00091a20: 6472 6177 0d0a 2020 2020 2020 2020 2020  draw..          
+00091a30: 2020 7369 7a65 7320 3d20 5b6d 7574 7561    sizes = [mutua
+00091a40: 6c5f 696e 666f 5b78 5d2a 6d75 6c74 6970  l_info[x]*multip
+00091a50: 6c69 6572 2066 6f72 2078 2069 6e20 6c69  lier for x in li
+00091a60: 7374 2867 662e 6e6f 6465 7328 2929 5d0d  st(gf.nodes())].
+00091a70: 0a20 2020 2020 2020 2020 2020 2023 2323  .            ###
+00091a80: 2320 2054 6865 2073 697a 6573 206f 6620  #  The sizes of 
+00091a90: 7468 6520 6275 6262 6c65 7320 666f 7220  the bubbles for 
+00091aa0: 6561 6368 206e 6f64 6520 6973 2064 6574  each node is det
+00091ab0: 6572 6d69 6e65 6420 6279 2069 7473 206d  ermined by its m
+00091ac0: 7574 7561 6c20 696e 666f 726d 6174 696f  utual informatio
+00091ad0: 6e20 7363 6f72 6520 7661 6c75 650d 0a20  n score value.. 
+00091ae0: 2020 2020 2020 2020 2020 2063 6f72 7220             corr 
+00091af0: 3d20 6466 5f66 6974 2e63 6f72 7228 290d  = df_fit.corr().
+00091b00: 0a20 2020 2020 2020 2020 2020 2068 6967  .            hig
+00091b10: 685f 636f 7272 203d 2063 6f72 725b 6162  h_corr = corr[ab
+00091b20: 7328 636f 7272 293e 636f 7272 5f6c 696d  s(corr)>corr_lim
+00091b30: 6974 5d0d 0a20 2020 2020 2020 2020 2020  it]..           
+00091b40: 2023 2320 6869 6768 5f63 6f72 7220 6973   ## high_corr is
+00091b50: 2074 6865 2064 6174 6166 7261 6d65 206f   the dataframe o
+00091b60: 6620 6120 6665 7720 7661 7269 6162 6c65  f a few variable
+00091b70: 7320 7468 6174 2061 7265 2068 6967 686c  s that are highl
+00091b80: 7920 636f 7272 656c 6174 6564 2074 6f20  y correlated to 
+00091b90: 6561 6368 206f 7468 6572 0d0a 2020 2020  each other..    
+00091ba0: 2020 2020 2020 2020 636f 6d62 6f73 203d          combos =
+00091bb0: 2063 6f6d 6269 6e61 7469 6f6e 7328 636f   combinations(co
+00091bc0: 7272 5f6c 6973 742c 3229 0d0a 2020 2020  rr_list,2)..    
+00091bd0: 2020 2020 2020 2020 2323 2320 7468 6973          ### this
+00091be0: 2067 6976 6573 2074 6865 2073 7472 656e   gives the stren
+00091bf0: 6774 6820 6f66 2063 6f72 7265 6c61 7469  gth of correlati
+00091c00: 6f6e 2062 6574 7765 656e 2032 206e 6f64  on between 2 nod
+00091c10: 6573 2023 230d 0a20 2020 2020 2020 2020  es ##..         
+00091c20: 2020 206d 756c 7469 706c 6965 7220 3d20     multiplier = 
+00091c30: 3230 0d0a 2020 2020 2020 2020 2020 2020  20..            
+00091c40: 666f 7220 2876 6172 312c 2076 6172 3229  for (var1, var2)
+00091c50: 2069 6e20 636f 6d62 6f73 3a0d 0a20 2020   in combos:..   
+00091c60: 2020 2020 2020 2020 2020 2020 2069 6620               if 
+00091c70: 6e70 2e69 736e 616e 2868 6967 685f 636f  np.isnan(high_co
+00091c80: 7272 2e6c 6f63 5b76 6172 312c 7661 7232  rr.loc[var1,var2
+00091c90: 5d29 3a0d 0a20 2020 2020 2020 2020 2020  ]):..           
+00091ca0: 2020 2020 2020 2020 2070 6173 730d 0a20           pass.. 
+00091cb0: 2020 2020 2020 2020 2020 2020 2020 2065                 e
+00091cc0: 6c73 653a 0d0a 2020 2020 2020 2020 2020  lse:..          
+00091cd0: 2020 2020 2020 2020 2020 6766 2e61 6464            gf.add
+00091ce0: 5f65 6467 6528 7661 7231 2c20 7661 7232  _edge(var1, var2
+00091cf0: 2c77 6569 6768 743d 6d75 6c74 6970 6c69  ,weight=multipli
+00091d00: 6572 2a68 6967 685f 636f 7272 2e6c 6f63  er*high_corr.loc
+00091d10: 5b76 6172 312c 7661 7232 5d29 0d0a 2020  [var1,var2])..  
+00091d20: 2020 2020 2020 2020 2020 2323 2323 2323            ######
+00091d30: 2323 204e 6f77 2073 7461 7274 2062 7569  ## Now start bui
+00091d40: 6c64 696e 6720 7468 6520 6e65 7477 6f72  lding the networ
+00091d50: 6b78 2067 7261 7068 2023 2323 2323 2323  kx graph #######
+00091d60: 2323 2323 2323 2323 2323 2323 2323 2323  ################
+00091d70: 2323 230d 0a20 2020 2020 2020 2020 2020  ###..           
+00091d80: 2077 6964 7468 7320 3d20 6e78 2e67 6574   widths = nx.get
+00091d90: 5f65 6467 655f 6174 7472 6962 7574 6573  _edge_attributes
+00091da0: 2867 662c 2027 7765 6967 6874 2729 0d0a  (gf, 'weight')..
+00091db0: 2020 2020 2020 2020 2020 2020 6e6f 6465              node
+00091dc0: 6c69 7374 203d 2067 662e 6e6f 6465 7328  list = gf.nodes(
+00091dd0: 290d 0a20 2020 2020 2020 2020 2020 2063  )..            c
+00091de0: 6f6c 7320 3d20 350d 0a20 2020 2020 2020  ols = 5..       
+00091df0: 2020 2020 2068 6569 6768 745f 7369 7a65       height_size
+00091e00: 203d 2035 0d0a 2020 2020 2020 2020 2020   = 5..          
+00091e10: 2020 7769 6474 685f 7369 7a65 203d 2031    width_size = 1
+00091e20: 350d 0a20 2020 2020 2020 2020 2020 2072  5..            r
+00091e30: 6f77 7320 3d20 696e 7428 6c65 6e28 636f  ows = int(len(co
+00091e40: 7272 5f6c 6973 7429 2f63 6f6c 7329 0d0a  rr_list)/cols)..
+00091e50: 2020 2020 2020 2020 2020 2020 6966 2072              if r
+00091e60: 6f77 7320 3c20 313a 0d0a 2020 2020 2020  ows < 1:..      
+00091e70: 2020 2020 2020 2020 2020 726f 7773 203d            rows =
+00091e80: 2031 0d0a 2020 2020 2020 2020 2020 2020   1..            
+00091e90: 706c 742e 6669 6775 7265 2866 6967 7369  plt.figure(figsi
+00091ea0: 7a65 3d28 7769 6474 685f 7369 7a65 2c6d  ze=(width_size,m
+00091eb0: 696e 2832 302c 6865 6967 6874 5f73 697a  in(20,height_siz
+00091ec0: 652a 726f 7773 2929 290d 0a20 2020 2020  e*rows)))..     
+00091ed0: 2020 2020 2020 2070 6f73 203d 206e 782e         pos = nx.
+00091ee0: 7368 656c 6c5f 6c61 796f 7574 2867 6629  shell_layout(gf)
+00091ef0: 0d0a 2020 2020 2020 2020 2020 2020 6e78  ..            nx
+00091f00: 2e64 7261 775f 6e65 7477 6f72 6b78 5f6e  .draw_networkx_n
+00091f10: 6f64 6573 2867 662c 706f 732c 0d0a 2020  odes(gf,pos,..  
+00091f20: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00091f30: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00091f40: 206e 6f64 656c 6973 743d 6e6f 6465 6c69   nodelist=nodeli
+00091f50: 7374 2c0d 0a20 2020 2020 2020 2020 2020  st,..           
+00091f60: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00091f70: 2020 2020 2020 2020 6e6f 6465 5f73 697a          node_siz
+00091f80: 653d 7369 7a65 732c 0d0a 2020 2020 2020  e=sizes,..      
+00091f90: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00091fa0: 2020 2020 2020 2020 2020 2020 206e 6f64               nod
+00091fb0: 655f 636f 6c6f 723d 2762 6c75 6527 2c0d  e_color='blue',.
+00091fc0: 0a20 2020 2020 2020 2020 2020 2020 2020  .               
+00091fd0: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00091fe0: 2020 2020 616c 7068 613d 302e 3529 0d0a      alpha=0.5)..
+00091ff0: 2020 2020 2020 2020 2020 2020 6e78 2e64              nx.d
+00092000: 7261 775f 6e65 7477 6f72 6b78 5f65 6467  raw_networkx_edg
+00092010: 6573 2867 662c 706f 732c 0d0a 2020 2020  es(gf,pos,..    
+00092020: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00092030: 2020 2020 2020 2020 2020 2020 2020 2065                 e
+00092040: 6467 656c 6973 7420 3d20 7769 6474 6873  dgelist = widths
+00092050: 2e6b 6579 7328 292c 0d0a 2020 2020 2020  .keys(),..      
+00092060: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00092070: 2020 2020 2020 2020 2020 2020 2077 6964               wid
+00092080: 7468 3d6c 6973 7428 7769 6474 6873 2e76  th=list(widths.v
+00092090: 616c 7565 7328 2929 2c0d 0a20 2020 2020  alues()),..     
+000920a0: 2020 2020 2020 2020 2020 2020 2020 2020                  
+000920b0: 2020 2020 2020 2020 2020 2020 2020 6564                ed
+000920c0: 6765 5f63 6f6c 6f72 3d27 6c69 6768 7462  ge_color='lightb
+000920d0: 6c75 6527 2c0d 0a20 2020 2020 2020 2020  lue',..         
+000920e0: 2020 2020 2020 2020 2020 2020 2020 2020                  
+000920f0: 2020 2020 2020 2020 2020 616c 7068 613d            alpha=
+00092100: 302e 3629 0d0a 2020 2020 2020 2020 2020  0.6)..          
+00092110: 2020 706f 735f 6869 6768 6572 203d 207b    pos_higher = {
+00092120: 7d0d 0a20 2020 2020 2020 2020 2020 2078  }..            x
+00092130: 5f6f 6666 203d 2030 2e30 3420 2023 206f  _off = 0.04  # o
+00092140: 6666 7365 7420 6f6e 2074 6865 2078 2061  ffset on the x a
+00092150: 7869 730d 0a20 2020 2020 2020 2020 2020  xis..           
+00092160: 2079 5f6f 6666 203d 2030 2e30 3420 2023   y_off = 0.04  #
+00092170: 206f 6666 7365 7420 6f6e 2074 6865 2079   offset on the y
+00092180: 2061 7869 730d 0a20 2020 2020 2020 2020   axis..         
+00092190: 2020 2066 6f72 206b 2c20 7620 696e 2070     for k, v in p
+000921a0: 6f73 2e69 7465 6d73 2829 3a0d 0a20 2020  os.items():..   
+000921b0: 2020 2020 2020 2020 2020 2020 2070 6f73               pos
+000921c0: 5f68 6967 6865 725b 6b5d 203d 2028 765b  _higher[k] = (v[
+000921d0: 305d 2b78 5f6f 6666 2c20 765b 315d 2b79  0]+x_off, v[1]+y
+000921e0: 5f6f 6666 290d 0a20 2020 2020 2020 2020  _off)..         
+000921f0: 2020 2069 6620 6c65 6e28 7365 6c65 6374     if len(select
+00092200: 6564 2920 3d3d 2030 3a0d 0a20 2020 2020  ed) == 0:..     
+00092210: 2020 2020 2020 2020 2020 206e 782e 6472             nx.dr
+00092220: 6177 5f6e 6574 776f 726b 785f 6c61 6265  aw_networkx_labe
+00092230: 6c73 2867 662c 2070 6f73 3d70 6f73 5f68  ls(gf, pos=pos_h
+00092240: 6967 6865 722c 0d0a 2020 2020 2020 2020  igher,..        
+00092250: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00092260: 2020 2020 2020 2020 2020 2020 6c61 6265              labe
+00092270: 6c73 3d64 6963 7428 7a69 7028 6e6f 6465  ls=dict(zip(node
+00092280: 6c69 7374 2c6e 6f64 656c 6973 7429 292c  list,nodelist)),
+00092290: 0d0a 2020 2020 2020 2020 2020 2020 2020  ..              
+000922a0: 2020 2020 2020 2020 2020 2020 2020 2020                  
+000922b0: 2020 2020 2020 666f 6e74 5f63 6f6c 6f72        font_color
+000922c0: 3d27 626c 6163 6b27 290d 0a20 2020 2020  ='black')..     
+000922d0: 2020 2020 2020 2065 6c73 653a 0d0a 2020         else:..  
+000922e0: 2020 2020 2020 2020 2020 2020 2020 6e78                nx
+000922f0: 2e64 7261 775f 6e65 7477 6f72 6b78 5f6c  .draw_networkx_l
+00092300: 6162 656c 7328 6766 2c20 706f 733d 706f  abels(gf, pos=po
+00092310: 735f 6869 6768 6572 2c0d 0a20 2020 2020  s_higher,..     
+00092320: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00092330: 2020 2020 2020 2020 2020 2020 2020 206c                 l
+00092340: 6162 656c 7320 3d20 6469 6374 287a 6970  abels = dict(zip
+00092350: 286e 6f64 656c 6973 742c 5b78 2b27 2028  (nodelist,[x+' (
+00092360: 7365 6c65 6374 6564 2927 2069 6620 7820  selected)' if x 
+00092370: 696e 2073 656c 6563 7465 6420 656c 7365  in selected else
+00092380: 2078 2b27 2028 7265 6d6f 7665 6429 2720   x+' (removed)' 
+00092390: 666f 7220 7820 696e 206e 6f64 656c 6973  for x in nodelis
+000923a0: 745d 2929 2c0d 0a20 2020 2020 2020 2020  t])),..         
+000923b0: 2020 2020 2020 2020 2020 2020 2020 2020                  
+000923c0: 2020 2020 2020 2020 2020 2066 6f6e 745f             font_
+000923d0: 636f 6c6f 723d 2762 6c61 636b 2729 0d0a  color='black')..
+000923e0: 2020 2020 2020 2020 2020 2020 706c 742e              plt.
+000923f0: 626f 7828 5472 7565 290d 0a20 2020 2020  box(True)..     
+00092400: 2020 2020 2020 2070 6c74 2e74 6974 6c65         plt.title
+00092410: 2822 2222 496e 2053 554c 4f56 2c20 7765  ("""In SULOV, we
+00092420: 2072 6570 6561 7465 646c 7920 7265 6d6f   repeatedly remo
+00092430: 7665 2066 6561 7475 7265 7320 7769 7468  ve features with
+00092440: 206c 6f77 6572 206d 7574 7561 6c20 696e   lower mutual in
+00092450: 666f 2073 636f 7265 7320 616d 6f6e 6720  fo scores among 
+00092460: 6869 6768 6c79 2063 6f72 7265 6c61 7465  highly correlate
+00092470: 6420 7061 6972 7320 2873 6565 2066 6967  d pairs (see fig
+00092480: 7572 6529 2c0d 0a20 2020 2020 2020 2020  ure),..         
+00092490: 2020 2020 2020 2020 2020 2020 2020 2053                 S
+000924a0: 554c 4f56 2073 656c 6563 7473 2074 6865  ULOV selects the
+000924b0: 2066 6561 7475 7265 2077 6974 6820 6869   feature with hi
+000924c0: 6768 6572 206d 7574 7561 6c20 696e 666f  gher mutual info
+000924d0: 2073 636f 7265 2072 656c 6174 6564 2074   score related t
+000924e0: 6f20 7461 7267 6574 2077 6865 6e20 6368  o target when ch
+000924f0: 6f6f 7369 6e67 2062 6574 7765 656e 2061  oosing between a
+00092500: 2070 6169 722e 2022 2222 2c20 666f 6e74   pair. """, font
+00092510: 7369 7a65 3d31 3029 0d0a 2020 2020 2020  size=10)..      
+00092520: 2020 2020 2020 706c 742e 7375 7074 6974        plt.suptit
+00092530: 6c65 2827 486f 7720 5355 4c4f 5620 4d65  le('How SULOV Me
+00092540: 7468 6f64 2057 6f72 6b73 2062 7920 5265  thod Works by Re
+00092550: 6d6f 7669 6e67 2048 6967 686c 7920 436f  moving Highly Co
+00092560: 7272 656c 6174 6564 2046 6561 7475 7265  rrelated Feature
+00092570: 7327 2c20 666f 6e74 7369 7a65 3d32 302c  s', fontsize=20,
+00092580: 793d 312e 3033 290d 0a20 2020 2020 2020  y=1.03)..       
+00092590: 2020 2020 2072 6564 5f70 6174 6368 203d       red_patch =
+000925a0: 206d 7061 7463 6865 732e 5061 7463 6828   mpatches.Patch(
+000925b0: 636f 6c6f 723d 2762 6c75 6527 2c20 6c61  color='blue', la
+000925c0: 6265 6c3d 2742 6967 6765 7220 6369 7263  bel='Bigger circ
+000925d0: 6c65 2064 656e 6f74 6573 2068 6967 6865  le denotes highe
+000925e0: 7220 6d75 7475 616c 2069 6e66 6f20 7363  r mutual info sc
+000925f0: 6f72 6520 7769 7468 2074 6172 6765 7427  ore with target'
+00092600: 290d 0a20 2020 2020 2020 2020 2020 2062  )..            b
+00092610: 6c75 655f 7061 7463 6820 3d20 6d70 6174  lue_patch = mpat
+00092620: 6368 6573 2e50 6174 6368 2863 6f6c 6f72  ches.Patch(color
+00092630: 3d27 6c69 6768 7462 6c75 6527 2c20 6c61  ='lightblue', la
+00092640: 6265 6c3d 2754 6869 636b 6572 206c 696e  bel='Thicker lin
+00092650: 6520 6465 6e6f 7465 7320 6869 6768 6572  e denotes higher
+00092660: 2063 6f72 7265 6c61 7469 6f6e 2062 6574   correlation bet
+00092670: 7765 656e 2074 776f 2076 6172 6961 626c  ween two variabl
+00092680: 6573 2729 0d0a 2020 2020 2020 2020 2020  es')..          
+00092690: 2020 706c 742e 6c65 6765 6e64 2868 616e    plt.legend(han
+000926a0: 646c 6573 3d5b 7265 645f 7061 7463 682c  dles=[red_patch,
+000926b0: 2062 6c75 655f 7061 7463 685d 2c6c 6f63   blue_patch],loc
+000926c0: 3d27 6265 7374 2729 0d0a 2020 2020 2020  ='best')..      
+000926d0: 2020 2020 2020 706c 742e 7368 6f77 2829        plt.show()
+000926e0: 3b0d 0a20 2020 2020 2020 2020 2020 2023  ;..            #
+000926f0: 2323 2323 2020 2020 4e20 4520 5420 5720  ####    N E T W 
+00092700: 4f20 5220 4b20 2020 2020 4420 4920 4120  O R K     D I A 
+00092710: 4720 5220 4120 4d20 2020 2043 204f 204d  G R A M    C O M
+00092720: 2050 204c 2045 2054 2045 2020 2023 2323   P L E T E   ###
+00092730: 2323 2323 2323 2323 2323 2323 2323 0d0a  ##############..
+00092740: 2020 2020 2020 2020 2020 2020 7265 7475              retu
+00092750: 726e 2066 696e 616c 5f6c 6973 742b 7265  rn final_list+re
+00092760: 6d76 6172 730d 0a20 2020 2020 2020 2065  mvars..        e
+00092770: 7863 6570 7420 4578 6365 7074 696f 6e20  xcept Exception 
+00092780: 6173 2065 3a0d 0a20 2020 2020 2020 2020  as e:..         
+00092790: 2020 2070 7269 6e74 2827 2020 2020 4e65     print('    Ne
+000927a0: 7477 6f72 6b78 206c 6962 7261 7279 2076  tworkx library v
+000927b0: 6973 7561 6c69 7a61 7469 6f6e 2063 7261  isualization cra
+000927c0: 7368 696e 6720 6475 6520 746f 2025 7327  shing due to %s'
+000927d0: 2025 6529 0d0a 2020 2020 2020 2020 2020   %e)..          
+000927e0: 2020 7072 696e 7428 2743 6f6e 7469 6e75    print('Continu
+000927f0: 696e 6720 7769 7468 2053 554c 4f56 2e20  ing with SULOV. 
+00092800: 2564 2066 6561 7475 7265 7320 7365 6c65  %d features sele
+00092810: 6374 6564 2720 256c 656e 2866 696e 616c  cted' %len(final
+00092820: 5f6c 6973 7429 290d 0a20 2020 2020 2020  _list))..       
+00092830: 2020 2020 2072 6574 7572 6e20 6669 6e61       return fina
+00092840: 6c5f 6c69 7374 2b72 656d 7661 7273 0d0a  l_list+remvars..
+00092850: 2323 2323 2323 2323 2323 2323 2323 2323  ################
+00092860: 2323 2323 2323 2323 2323 2323 2323 2323  ################
+00092870: 2323 2323 2323 2323 2323 2323 2323 2323  ################
+00092880: 2323 2323 2323 2323 2323 2323 2323 2323  ################
+00092890: 2323 2323 2323 2323 2323 2323 2323 2323  ################
+000928a0: 2323 230d 0a00 0000 0000 0000 0000 0000  ###.............
 000928b0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
 000928c0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
 000928d0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
 000928e0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
 000928f0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-00092900: 0075 7374 6172 0030 3000 0000 0000 0000  .ustar.00.......
+00092900: 0000 0000 0000 0000 0000 0000 0000 0000  ................
 00092910: 0000 0000 0000 0000 0000 0000 0000 0000  ................
 00092920: 0000 0000 0000 0000 0000 0000 0000 0000  ................
 00092930: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-00092940: 0000 0000 0000 0000 0030 3030 3030 3030  .........0000000
-00092950: 0030 3030 3030 3030 0000 0000 0000 0000  .0000000........
+00092940: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+00092950: 0000 0000 0000 0000 0000 0000 0000 0000  ................
 00092960: 0000 0000 0000 0000 0000 0000 0000 0000  ................
 00092970: 0000 0000 0000 0000 0000 0000 0000 0000  ................
 00092980: 0000 0000 0000 0000 0000 0000 0000 0000  ................
 00092990: 0000 0000 0000 0000 0000 0000 0000 0000  ................
 000929a0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
 000929b0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
 000929c0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
 000929d0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
 000929e0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
 000929f0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-00092a00: 3232 206d 7469 6d65 3d31 3638 3139 3033  22 mtime=1681903
-00092a10: 3937 372e 300a 0000 0000 0000 0000 0000  977.0...........
+00092a00: 2e2f 2e2f 4050 6178 4865 6164 6572 0000  ././@PaxHeader..
+00092a10: 0000 0000 0000 0000 0000 0000 0000 0000  ................
 00092a20: 0000 0000 0000 0000 0000 0000 0000 0000  ................
 00092a30: 0000 0000 0000 0000 0000 0000 0000 0000  ................
 00092a40: 0000 0000 0000 0000 0000 0000 0000 0000  ................
 00092a50: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-00092a60: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-00092a70: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-00092a80: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-00092a90: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+00092a60: 0000 0000 3030 3030 3030 3000 3030 3030  ....0000000.0000
+00092a70: 3030 3000 3030 3030 3030 3000 3030 3030  000.0000000.0000
+00092a80: 3030 3030 3033 3400 3030 3030 3030 3030  0000034.00000000
+00092a90: 3030 3000 3031 3134 3532 0020 7800 0000  000.011452. x...
 00092aa0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
 00092ab0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
 00092ac0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
 00092ad0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
 00092ae0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
 00092af0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-00092b00: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+00092b00: 0075 7374 6172 0030 3000 0000 0000 0000  .ustar.00.......
 00092b10: 0000 0000 0000 0000 0000 0000 0000 0000  ................
 00092b20: 0000 0000 0000 0000 0000 0000 0000 0000  ................
 00092b30: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-00092b40: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-00092b50: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+00092b40: 0000 0000 0000 0000 0030 3030 3030 3030  .........0000000
+00092b50: 0030 3030 3030 3030 0000 0000 0000 0000  .0000000........
 00092b60: 0000 0000 0000 0000 0000 0000 0000 0000  ................
 00092b70: 0000 0000 0000 0000 0000 0000 0000 0000  ................
 00092b80: 0000 0000 0000 0000 0000 0000 0000 0000  ................
 00092b90: 0000 0000 0000 0000 0000 0000 0000 0000  ................
 00092ba0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
 00092bb0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
 00092bc0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
 00092bd0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
 00092be0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
 00092bf0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-00092c00: 6175 746f 7669 6d6c 2d30 2e31 2e37 3134  autoviml-0.1.714
-00092c10: 2f61 7574 6f76 696d 6c2e 6567 672d 696e  /autoviml.egg-in
-00092c20: 666f 2f50 4b47 2d49 4e46 4f00 0000 0000  fo/PKG-INFO.....
+00092c00: 3238 206d 7469 6d65 3d31 3638 3433 3238  28 mtime=1684328
+00092c10: 3631 352e 3834 3137 3730 340a 0000 0000  615.8417704.....
+00092c20: 0000 0000 0000 0000 0000 0000 0000 0000  ................
 00092c30: 0000 0000 0000 0000 0000 0000 0000 0000  ................
 00092c40: 0000 0000 0000 0000 0000 0000 0000 0000  ................
 00092c50: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-00092c60: 0000 0000 3030 3030 3737 3700 3030 3031  ....0000777.0001
-00092c70: 3735 3000 3030 3031 3735 3000 3030 3030  750.0001750.0000
-00092c80: 3030 3335 3137 3400 3030 3030 3030 3030  0035174.00000000
-00092c90: 3030 3000 3031 3735 3535 0020 3000 0000  000.017555. 0...
+00092c60: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+00092c70: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+00092c80: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+00092c90: 0000 0000 0000 0000 0000 0000 0000 0000  ................
 00092ca0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
 00092cb0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
 00092cc0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
 00092cd0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
 00092ce0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
 00092cf0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-00092d00: 0075 7374 6172 0030 3072 616d 0000 0000  .ustar.00ram....
+00092d00: 0000 0000 0000 0000 0000 0000 0000 0000  ................
 00092d10: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-00092d20: 0000 0000 0000 0000 0072 616d 0000 0000  .........ram....
+00092d20: 0000 0000 0000 0000 0000 0000 0000 0000  ................
 00092d30: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-00092d40: 0000 0000 0000 0000 0030 3030 3030 3030  .........0000000
-00092d50: 0030 3030 3030 3030 0000 0000 0000 0000  .0000000........
+00092d40: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+00092d50: 0000 0000 0000 0000 0000 0000 0000 0000  ................
 00092d60: 0000 0000 0000 0000 0000 0000 0000 0000  ................
 00092d70: 0000 0000 0000 0000 0000 0000 0000 0000  ................
 00092d80: 0000 0000 0000 0000 0000 0000 0000 0000  ................
 00092d90: 0000 0000 0000 0000 0000 0000 0000 0000  ................
 00092da0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
 00092db0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
 00092dc0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
 00092dd0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
 00092de0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
 00092df0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-00092e00: 4d65 7461 6461 7461 2d56 6572 7369 6f6e  Metadata-Version
-00092e10: 3a20 322e 310a 4e61 6d65 3a20 6175 746f  : 2.1.Name: auto
-00092e20: 7669 6d6c 0a56 6572 7369 6f6e 3a20 302e  viml.Version: 0.
-00092e30: 312e 3731 340a 5375 6d6d 6172 793a 2041  1.714.Summary: A
-00092e40: 7574 6f6d 6174 6963 616c 6c79 2042 7569  utomatically Bui
-00092e50: 6c64 2056 6172 6961 6e74 2049 6e74 6572  ld Variant Inter
-00092e60: 7072 6574 6162 6c65 204d 4c20 6d6f 6465  pretable ML mode
-00092e70: 6c73 2066 6173 7420 2d20 6e6f 7720 7769  ls fast - now wi
-00092e80: 7468 2043 6174 426f 6f73 7421 0a48 6f6d  th CatBoost!.Hom
-00092e90: 652d 7061 6765 3a20 6874 7470 733a 2f2f  e-page: https://
-00092ea0: 6769 7468 7562 2e63 6f6d 2f41 7574 6f56  github.com/AutoV
-00092eb0: 694d 4c2f 4175 746f 5f56 694d 4c0a 4175  iML/Auto_ViML.Au
-00092ec0: 7468 6f72 3a20 5261 6d20 5365 7368 6164  thor: Ram Seshad
-00092ed0: 7269 0a4c 6963 656e 7365 3a20 4170 6163  ri.License: Apac
-00092ee0: 6865 204c 6963 656e 7365 2032 2e30 0a44  he License 2.0.D
-00092ef0: 6573 6372 6970 7469 6f6e 3a20 2320 4175  escription: # Au
-00092f00: 746f 2d56 694d 4c0a 2020 2020 2020 2020  to-ViML.        
-00092f10: 0a20 2020 2020 2020 2021 5b62 616e 6e65  .        ![banne
-00092f20: 725d 286c 6f67 6f2e 706e 6729 3c62 723e  r](logo.png)<br>
-00092f30: 0a20 2020 2020 2020 2041 7574 6f6d 6174  .        Automat
-00092f40: 6963 616c 6c79 2042 7569 6c64 2056 6172  ically Build Var
-00092f50: 696f 7573 2049 6e74 6572 7072 6574 6162  ious Interpretab
-00092f60: 6c65 204d 4c20 6d6f 6465 6c73 2066 6173  le ML models fas
-00092f70: 7421 3c62 723e 0a20 2020 2020 2020 205b  t!<br>.        [
-00092f80: 215b 446f 776e 6c6f 6164 735d 2868 7474  ![Downloads](htt
-00092f90: 7073 3a2f 2f70 6570 792e 7465 6368 2f62  ps://pepy.tech/b
-00092fa0: 6164 6765 2f61 7574 6f76 696d 6c2f 7765  adge/autoviml/we
-00092fb0: 656b 295d 2868 7474 7073 3a2f 2f70 6570  ek)](https://pep
-00092fc0: 792e 7465 6368 2f70 726f 6a65 6374 2f61  y.tech/project/a
-00092fd0: 7574 6f76 696d 6c2f 7765 656b 290a 2020  utoviml/week).  
-00092fe0: 2020 2020 2020 5b21 5b44 6f77 6e6c 6f61        [![Downloa
-00092ff0: 6473 5d28 6874 7470 733a 2f2f 7065 7079  ds](https://pepy
-00093000: 2e74 6563 682f 6261 6467 652f 6175 746f  .tech/badge/auto
-00093010: 7669 6d6c 2f6d 6f6e 7468 295d 2868 7474  viml/month)](htt
-00093020: 7073 3a2f 2f70 6570 792e 7465 6368 2f70  ps://pepy.tech/p
-00093030: 726f 6a65 6374 2f61 7574 6f76 696d 6c2f  roject/autoviml/
-00093040: 6d6f 6e74 6829 0a20 2020 2020 2020 205b  month).        [
-00093050: 215b 446f 776e 6c6f 6164 735d 2868 7474  ![Downloads](htt
-00093060: 7073 3a2f 2f70 6570 792e 7465 6368 2f62  ps://pepy.tech/b
-00093070: 6164 6765 2f61 7574 6f76 696d 6c29 5d28  adge/autoviml)](
-00093080: 6874 7470 733a 2f2f 7065 7079 2e74 6563  https://pepy.tec
-00093090: 682f 7072 6f6a 6563 742f 6175 746f 7669  h/project/autovi
-000930a0: 6d6c 290a 2020 2020 2020 2020 5b21 5b73  ml).        [![s
-000930b0: 7461 6e64 6172 642d 7265 6164 6d65 2063  tandard-readme c
-000930c0: 6f6d 706c 6961 6e74 5d28 6874 7470 733a  ompliant](https:
-000930d0: 2f2f 696d 672e 7368 6965 6c64 732e 696f  //img.shields.io
-000930e0: 2f62 6164 6765 2f73 7461 6e64 6172 642d  /badge/standard-
-000930f0: 2d72 6561 646d 652d 4f4b 2d67 7265 656e  -readme-OK-green
-00093100: 2e73 7667 3f73 7479 6c65 3d66 6c61 742d  .svg?style=flat-
-00093110: 7371 7561 7265 295d 2868 7474 7073 3a2f  square)](https:/
-00093120: 2f67 6974 6875 622e 636f 6d2f 5269 6368  /github.com/Rich
-00093130: 6172 644c 6974 742f 7374 616e 6461 7264  ardLitt/standard
-00093140: 2d72 6561 646d 6529 0a20 2020 2020 2020  -readme).       
-00093150: 205b 215b 5079 7468 6f6e 2056 6572 7369   [![Python Versi
-00093160: 6f6e 735d 2868 7474 7073 3a2f 2f69 6d67  ons](https://img
-00093170: 2e73 6869 656c 6473 2e69 6f2f 7079 7069  .shields.io/pypi
-00093180: 2f70 7976 6572 7369 6f6e 732f 6175 746f  /pyversions/auto
-00093190: 7669 6d6c 2e73 7667 3f6c 6f67 6f3d 7079  viml.svg?logo=py
-000931a0: 7468 6f6e 266c 6f67 6f43 6f6c 6f72 3d77  thon&logoColor=w
-000931b0: 6869 7465 295d 2868 7474 7073 3a2f 2f70  hite)](https://p
-000931c0: 7970 692e 6f72 672f 7072 6f6a 6563 742f  ypi.org/project/
-000931d0: 6175 746f 7669 6d6c 290a 2020 2020 2020  autoviml).      
-000931e0: 2020 5b21 5b50 7950 4920 5665 7273 696f    [![PyPI Versio
-000931f0: 6e5d 2868 7474 7073 3a2f 2f69 6d67 2e73  n](https://img.s
-00093200: 6869 656c 6473 2e69 6f2f 7079 7069 2f76  hields.io/pypi/v
-00093210: 2f61 7574 6f76 696d 6c2e 7376 673f 6c6f  /autoviml.svg?lo
-00093220: 676f 3d70 7970 6926 6c6f 676f 436f 6c6f  go=pypi&logoColo
-00093230: 723d 7768 6974 6529 5d28 6874 7470 733a  r=white)](https:
-00093240: 2f2f 7079 7069 2e6f 7267 2f70 726f 6a65  //pypi.org/proje
-00093250: 6374 2f61 7574 6f76 696d 6c29 0a20 2020  ct/autoviml).   
-00093260: 2020 2020 205b 215b 5079 5049 204c 6963       [![PyPI Lic
-00093270: 656e 7365 5d28 6874 7470 733a 2f2f 696d  ense](https://im
-00093280: 672e 7368 6965 6c64 732e 696f 2f70 7970  g.shields.io/pyp
-00093290: 692f 6c2f 6175 746f 7669 6d6c 2e73 7667  i/l/autoviml.svg
-000932a0: 295d 2868 7474 7073 3a2f 2f67 6974 6875  )](https://githu
-000932b0: 622e 636f 6d2f 4175 746f 5669 4d4c 2f41  b.com/AutoViML/A
-000932c0: 7574 6f5f 5669 4d4c 2f62 6c6f 622f 6d61  uto_ViML/blob/ma
-000932d0: 7374 6572 2f4c 4943 454e 5345 290a 2020  ster/LICENSE).  
-000932e0: 2020 2020 2020 0a20 2020 2020 2020 2041        .        A
-000932f0: 7574 6f5f 5669 4d4c 2069 7320 7072 6f6e  uto_ViML is pron
-00093300: 6f75 6e63 6564 2061 7320 2261 7574 6f20  ounced as "auto 
-00093310: 7669 6d61 6c22 2028 6175 746f 7669 6d61  vimal" (autovima
-00093320: 6c20 6c6f 676f 2063 7265 6174 6564 2062  l logo created b
-00093330: 7920 5361 6e6b 6574 2047 6861 6e6d 6172  y Sanket Ghanmar
-00093340: 6529 2e0a 2020 2020 2020 2020 0a20 2020  e)..        .   
-00093350: 2020 2020 2023 2320 5570 6461 7465 2028       ## Update (
-00093360: 4d61 7263 6820 3230 3233 290a 2020 2020  March 2023).    
-00093370: 2020 2020 3c6f 6c3e 0a20 2020 2020 2020      <ol>.       
-00093380: 203c 6c69 3e3c 623e 4175 746f 5f56 694d   <li><b>Auto_ViM
-00093390: 4c20 6861 7320 6120 6e65 7720 666c 6167  L has a new flag
-000933a0: 2074 6f20 7370 6565 6420 7570 2070 726f   to speed up pro
-000933b0: 6365 7373 696e 6720 7573 696e 6720 4750  cessing using GP
-000933c0: 5527 733c 2f62 3e2e 204a 7573 7420 7365  U's</b>. Just se
-000933d0: 7420 7468 6520 6047 5055 5f66 6c61 6760  t the `GPU_flag`
-000933e0: 3d60 5472 7565 6020 6f6e 2043 6f6c 6162  =`True` on Colab
-000933f0: 2061 6e64 206f 7468 6572 2065 6e76 6972   and other envir
-00093400: 6f6e 6d65 6e74 732e 2042 7574 2064 6f6e  onments. But don
-00093410: 2774 2066 6f72 6765 7420 746f 2073 6574  't forget to set
-00093420: 2074 6865 2072 756e 7469 6d65 2074 7970   the runtime typ
-00093430: 6520 746f 2062 6520 2247 5055 2220 7768  e to be "GPU" wh
-00093440: 696c 6520 7275 6e6e 696e 6720 6f6e 2043  ile running on C
-00093450: 6f6c 6162 2e20 4f74 6865 7277 6973 6520  olab. Otherwise 
-00093460: 796f 7520 7769 6c6c 2067 6574 2061 6e20  you will get an 
-00093470: 6572 726f 722e 3c2f 6c69 3e0a 2020 2020  error.</li>.    
-00093480: 2020 2020 3c2f 6f6c 3e0a 2020 2020 2020      </ol>.      
-00093490: 2020 0a20 2020 2020 2020 2023 2320 5570    .        ## Up
-000934a0: 6461 7465 2028 4d61 7920 3230 3232 290a  date (May 2022).
-000934b0: 2020 2020 2020 2020 3c6f 6c3e 0a20 2020          <ol>.   
-000934c0: 2020 2020 203c 6c69 3e3c 623e 4175 746f       <li><b>Auto
-000934d0: 5f56 694d 4c20 6173 206f 6620 7665 7273  _ViML as of vers
-000934e0: 696f 6e20 302e 312e 3731 3020 7573 6573  ion 0.1.710 uses
-000934f0: 2061 2076 6572 7920 6869 6768 2070 6572   a very high per
-00093500: 666f 726d 616e 6365 206c 6962 7261 7279  formance library
-00093510: 2063 616c 6c65 6420 6069 6d62 616c 616e   called `imbalan
-00093520: 6365 645f 656e 7365 6d62 6c65 6020 666f  ced_ensemble` fo
-00093530: 7220 496d 6261 6c61 6e63 6564 2064 6174  r Imbalanced dat
-00093540: 6173 6574 2070 726f 626c 656d 732e 3c2f  aset problems.</
-00093550: 623e 2049 7420 7769 6c6c 2070 726f 6475  b> It will produ
-00093560: 6365 2061 2035 2d31 3025 2062 6f6f 7374  ce a 5-10% boost
-00093570: 2069 6e20 796f 7572 2062 616c 616e 6365   in your balance
-00093580: 645f 6163 6375 7261 6379 2062 6173 6564  d_accuracy based
-00093590: 206f 6e20 6d79 2065 7870 6572 6965 6e63   on my experienc
-000935a0: 6520 7769 7468 2020 6d61 6e79 2064 6174  e with  many dat
-000935b0: 6173 6574 7320 4920 6861 7665 2074 7269  asets I have tri
-000935c0: 6564 2e3c 2f6c 693e 0a20 2020 2020 2020  ed.</li>.       
-000935d0: 203c 6272 3e0a 2020 2020 2020 2020 3c70   <br>.        <p
-000935e0: 3e49 6e20 6164 6469 7469 6f6e 2c20 6e65  >In addition, ne
-000935f0: 7720 6665 6174 7572 6573 2069 6e20 7468  w features in th
-00093600: 6973 2076 6572 7369 6f6e 2061 7265 3a3c  is version are:<
-00093610: 6272 3e0a 2020 2020 2020 2020 3c75 6c3e  br>.        <ul>
-00093620: 0a20 2020 2020 2020 203c 6c69 3e53 554c  .        <li>SUL
-00093630: 4f56 202d 3e20 5573 6573 2074 6865 2053  OV -> Uses the S
-00093640: 554c 4f56 2061 6c67 6f72 6974 686d 2066  ULOV algorithm f
-00093650: 6f72 2072 656d 6f76 696e 6720 6869 6768  or removing high
-00093660: 6c79 2063 6f72 7265 6c61 7465 6420 6665  ly correlated fe
-00093670: 6174 7572 6573 2061 7574 6f6d 6174 6963  atures automatic
-00093680: 616c 6c79 2e3c 2f6c 693e 0a20 2020 2020  ally.</li>.     
-00093690: 2020 203c 6c69 3e41 7574 6f5f 4e4c 5020     <li>Auto_NLP 
-000936a0: 2d3e 2041 7574 6f56 694d 4c20 6175 746f  -> AutoViML auto
-000936b0: 6d61 7469 6361 6c6c 7920 6465 7465 6374  matically detect
-000936c0: 7320 5465 7874 2076 6172 6961 626c 6573  s Text variables
-000936d0: 2061 6e64 2064 6f65 7320 4e4c 5020 7072   and does NLP pr
-000936e0: 6f63 6573 7369 6e67 2075 7369 6e67 2041  ocessing using A
-000936f0: 7574 6f5f 4e4c 503c 2f6c 693e 0a20 2020  uto_NLP</li>.   
-00093700: 2020 2020 203c 6c69 3e44 6174 6520 5469       <li>Date Ti
-00093710: 6d65 202d 3e20 4974 2061 7574 6f6d 6174  me -> It automat
-00093720: 6963 616c 6c79 2064 6574 6563 7473 2020  ically detects  
-00093730: 6461 7465 2074 696d 6520 7661 7269 6162  date time variab
-00093740: 6c65 7320 616e 6420 6765 6e65 7261 7465  les and generate
-00093750: 7320 6e65 7720 6665 6174 7572 6573 3c2f  s new features</
-00093760: 6c69 3e0a 2020 2020 2020 2020 3c6c 693e  li>.        <li>
-00093770: 6069 6d62 616c 616e 6365 645f 656e 7365  `imbalanced_ense
-00093780: 6d62 6c65 6020 6c69 6272 6172 7920 2d3e  mble` library ->
-00093790: 2055 7365 7320 696d 6261 6c61 6e63 6564   Uses imbalanced
-000937a0: 5f65 6e73 656d 626c 6520 6c69 6272 6172  _ensemble librar
-000937b0: 7920 666f 7220 696d 6261 6c61 6e63 6564  y for imbalanced
-000937c0: 2064 6174 612e 204a 7573 7420 7365 7420   data. Just set 
-000937d0: 496d 6261 6c61 6e63 6564 5f46 6c61 6720  Imbalanced_Flag 
-000937e0: 3d20 5472 7565 2069 6e20 6172 6775 6d65  = True in argume
-000937f0: 6e74 733c 2f6c 693e 0a20 2020 2020 2020  nts</li>.       
-00093800: 203c 6c69 3e46 6561 7475 7265 2053 656c   <li>Feature Sel
-00093810: 6563 7469 6f6e 202d 3e20 5765 2075 7365  ection -> We use
-00093820: 2074 6865 2073 616d 6520 616c 676f 7269   the same algori
-00093830: 7468 6d20 7468 6174 2066 6561 7475 7265  thm that feature
-00093840: 7769 7a20 6c69 6272 6172 7920 7573 6573  wiz library uses
-00093850: 3a20 5355 4c4f 5620 616e 6420 5265 6375  : SULOV and Recu
-00093860: 7273 6976 6520 5847 426f 6f73 7420 746f  rsive XGBoost to
-00093870: 2073 656c 6563 7420 6265 7374 2066 6561   select best fea
-00093880: 7475 7265 7320 6661 7374 2e20 5365 6520  tures fast. See 
-00093890: 6265 6c6f 772e 3c2f 6c69 3e0a 2020 2020  below.</li>.    
-000938a0: 2020 2020 3c2f 756c 3e0a 2020 2020 2020      </ul>.      
-000938b0: 2020 0a20 2020 2020 2020 2023 2320 5461    .        ## Ta
-000938c0: 626c 6520 6f66 2043 6f6e 7465 6e74 730a  ble of Contents.
-000938d0: 2020 2020 2020 2020 3c75 6c3e 0a20 2020          <ul>.   
-000938e0: 2020 2020 203c 6c69 3e3c 6120 6872 6566       <li><a href
-000938f0: 3d22 2362 6163 6b67 726f 756e 6422 3e42  ="#background">B
-00093900: 6163 6b67 726f 756e 643c 2f61 3e3c 2f6c  ackground</a></l
-00093910: 693e 0a20 2020 2020 2020 203c 6c69 3e3c  i>.        <li><
-00093920: 6120 6872 6566 3d22 2369 6e73 7461 6c6c  a href="#install
-00093930: 223e 496e 7374 616c 6c3c 2f61 3e3c 2f6c  ">Install</a></l
-00093940: 693e 0a20 2020 2020 2020 203c 6c69 3e3c  i>.        <li><
-00093950: 6120 6872 6566 3d22 2375 7361 6765 223e  a href="#usage">
-00093960: 5573 6167 653c 2f61 3e3c 2f6c 693e 0a20  Usage</a></li>. 
-00093970: 2020 2020 2020 203c 6c69 3e3c 6120 6872         <li><a hr
-00093980: 6566 3d22 2374 6970 732d 666f 722d 7573  ef="#tips-for-us
-00093990: 696e 672d 6175 746f 5f76 696d 6c22 3e54  ing-auto_viml">T
-000939a0: 6970 7320 666f 7220 7573 696e 6720 4175  ips for using Au
-000939b0: 746f 5f56 694d 4c3c 2f61 3e3c 2f6c 693e  to_ViML</a></li>
-000939c0: 0a20 2020 2020 2020 203c 6c69 3e3c 6120  .        <li><a 
-000939d0: 6872 6566 3d22 2361 7069 223e 4150 493c  href="#api">API<
-000939e0: 2f61 3e3c 2f6c 693e 0a20 2020 2020 2020  /a></li>.       
-000939f0: 203c 6c69 3e3c 6120 6872 6566 3d22 236d   <li><a href="#m
-00093a00: 6169 6e74 6169 6e65 7273 223e 4d61 696e  aintainers">Main
-00093a10: 7461 696e 6572 733c 2f61 3e3c 2f6c 693e  tainers</a></li>
-00093a20: 0a20 2020 2020 2020 203c 6c69 3e3c 6120  .        <li><a 
-00093a30: 6872 6566 3d22 2363 6f6e 7472 6962 7574  href="#contribut
-00093a40: 696e 6722 3e43 6f6e 7472 6962 7574 696e  ing">Contributin
-00093a50: 673c 2f61 3e3c 2f6c 693e 0a20 2020 2020  g</a></li>.     
-00093a60: 2020 203c 6c69 3e3c 6120 6872 6566 3d22     <li><a href="
-00093a70: 236c 6963 656e 7365 223e 4c69 6365 6e73  #license">Licens
-00093a80: 653c 2f61 3e3c 2f6c 693e 0a20 2020 2020  e</a></li>.     
-00093a90: 2020 203c 2f75 6c3e 0a20 2020 2020 2020     </ul>.       
-00093aa0: 200a 2020 2020 2020 2020 2323 2042 6163   .        ## Bac
-00093ab0: 6b67 726f 756e 640a 2020 2020 2020 2020  kground.        
-00093ac0: 3c70 3e52 6561 6420 7468 6973 203c 6120  <p>Read this <a 
-00093ad0: 6872 6566 3d22 6874 7470 733a 2f2f 746f  href="https://to
-00093ae0: 7761 7264 7364 6174 6173 6369 656e 6365  wardsdatascience
-00093af0: 2e63 6f6d 2f77 6879 2d61 7574 6f6d 6c2d  .com/why-automl-
-00093b00: 6973 2d61 6e2d 6573 7365 6e74 6961 6c2d  is-an-essential-
-00093b10: 6e65 772d 746f 6f6c 2d66 6f72 2d64 6174  new-tool-for-dat
-00093b20: 612d 7363 6965 6e74 6973 7473 2d32 6439  a-scientists-2d9
-00093b30: 6162 3465 3235 6534 3622 3e4d 6564 6975  ab4e25e46">Mediu
-00093b40: 6d20 6172 7469 636c 6520 746f 206c 6561  m article to lea
-00093b50: 726e 2068 6f77 2074 6f20 7573 6520 4175  rn how to use Au
-00093b60: 746f 5f56 694d 4c20 6566 6665 6374 6976  to_ViML effectiv
-00093b70: 656c 792e 3c2f 613e 0a20 2020 2020 2020  ely.</a>.       
-00093b80: 200a 2020 2020 2020 2020 3c70 3e41 7574   .        <p>Aut
-00093b90: 6f5f 5669 4d4c 2077 6173 2064 6573 6967  o_ViML was desig
-00093ba0: 6e65 6420 666f 7220 6275 696c 6469 6e67  ned for building
-00093bb0: 2048 6967 6820 5065 7266 6f72 6d61 6e63   High Performanc
-00093bc0: 6520 496e 7465 7270 7265 7461 626c 6520  e Interpretable 
-00093bd0: 4d6f 6465 6c73 2077 6974 6820 7468 6520  Models with the 
-00093be0: 6665 7765 7374 2076 6172 6961 626c 6573  fewest variables
-00093bf0: 206e 6565 6465 642e 0a20 2020 2020 2020   needed..       
-00093c00: 2054 6865 2022 5622 2069 6e20 4175 746f   The "V" in Auto
-00093c10: 5f56 694d 4c20 7374 616e 6473 2066 6f72  _ViML stands for
-00093c20: 2056 6172 6961 6e74 2062 6563 6175 7365   Variant because
-00093c30: 2069 7420 7472 6965 7320 6d75 6c74 6970   it tries multip
-00093c40: 6c65 206d 6f64 656c 7320 7769 7468 206d  le models with m
-00093c50: 756c 7469 706c 6520 6665 6174 7572 6573  ultiple features
-00093c60: 2074 6f20 6669 6e64 2079 6f75 2074 6865   to find you the
-00093c70: 2062 6573 7420 7065 7266 6f72 6d69 6e67   best performing
-00093c80: 206d 6f64 656c 2066 6f72 2079 6f75 7220   model for your 
-00093c90: 6461 7461 7365 742e 2054 6865 2022 6922  dataset. The "i"
-00093ca0: 2069 6e20 4175 746f 5f56 694d 4c20 7374   in Auto_ViML st
-00093cb0: 616e 6473 2066 6f72 2022 696e 7465 7270  ands for "interp
-00093cc0: 7265 7461 626c 6522 2073 696e 6365 2041  retable" since A
-00093cd0: 7574 6f5f 5669 4d4c 2073 656c 6563 7473  uto_ViML selects
-00093ce0: 2074 6865 206c 6561 7374 206e 756d 6265   the least numbe
-00093cf0: 7220 6f66 2066 6561 7475 7265 7320 6e65  r of features ne
-00093d00: 6365 7373 6172 7920 746f 2062 7569 6c64  cessary to build
-00093d10: 2061 2073 696d 706c 6572 2c20 6d6f 7265   a simpler, more
-00093d20: 2069 6e74 6572 7072 6574 6162 6c65 206d   interpretable m
-00093d30: 6f64 656c 2e20 496e 206d 6f73 7420 6361  odel. In most ca
-00093d40: 7365 732c 2041 7574 6f5f 5669 4d4c 2062  ses, Auto_ViML b
-00093d50: 7569 6c64 7320 6d6f 6465 6c73 2077 6974  uilds models wit
-00093d60: 6820 3230 252d 3939 2520 6665 7765 7220  h 20%-99% fewer 
-00093d70: 6665 6174 7572 6573 2074 6861 6e20 6120  features than a 
-00093d80: 7369 6d69 6c61 7220 7065 7266 6f72 6d69  similar performi
-00093d90: 6e67 206d 6f64 656c 2077 6974 6820 616c  ng model with al
-00093da0: 6c20 696e 636c 7564 6564 2066 6561 7475  l included featu
-00093db0: 7265 7320 2874 6869 7320 6973 2062 6173  res (this is bas
-00093dc0: 6564 206f 6e20 6d79 2074 7269 616c 732e  ed on my trials.
-00093dd0: 2059 6f75 7220 6578 7065 7269 656e 6365   Your experience
-00093de0: 206d 6179 2076 6172 7929 2e3c 6272 3e0a   may vary).<br>.
-00093df0: 2020 2020 2020 2020 3c70 3e0a 2020 2020          <p>.    
-00093e00: 2020 2020 4175 746f 5f56 694d 4c20 6973      Auto_ViML is
-00093e10: 2065 7665 7279 2044 6174 6120 5363 6965   every Data Scie
-00093e20: 6e74 6973 7427 7320 6d6f 6465 6c20 6163  ntist's model ac
-00093e30: 6365 6c65 7261 746f 7220 746f 6f6c 2074  celerator tool t
-00093e40: 6861 743a 3c6f 6c3e 0a20 2020 2020 2020  hat:<ol>.       
-00093e50: 203c 6c69 3e3c 623e 4865 6c70 7320 796f   <li><b>Helps yo
-00093e60: 7520 7769 7468 2064 6174 6120 636c 6561  u with data clea
-00093e70: 6e69 6e67 3c2f 623e 3a20 796f 7520 6361  ning</b>: you ca
-00093e80: 6e20 7365 6e64 2069 6e20 796f 7572 2065  n send in your e
-00093e90: 6e74 6972 6520 6461 7461 6672 616d 6520  ntire dataframe 
-00093ea0: 6173 2069 7320 616e 6420 4175 746f 5f56  as is and Auto_V
-00093eb0: 694d 4c20 7769 6c6c 2073 7567 6765 7374  iML will suggest
-00093ec0: 2063 6861 6e67 6573 2074 6f20 6865 6c70   changes to help
-00093ed0: 2077 6974 6820 6d69 7373 696e 6720 7661   with missing va
-00093ee0: 6c75 6573 2c20 666f 726d 6174 7469 6e67  lues, formatting
-00093ef0: 2076 6172 6961 626c 6573 2c20 6164 6469   variables, addi
-00093f00: 6e67 2076 6172 6961 626c 6573 2c20 6574  ng variables, et
-00093f10: 632e 2049 7420 6c6f 7665 7320 6469 7274  c. It loves dirt
-00093f20: 7920 6461 7461 2e20 5468 6520 6469 7274  y data. The dirt
-00093f30: 6965 7220 7468 6520 6265 7474 6572 213c  ier the better!<
-00093f40: 6272 3e0a 2020 2020 2020 2020 3c6c 693e  br>.        <li>
-00093f50: 3c62 3e50 6572 666f 726d 7320 4665 6174  <b>Performs Feat
-00093f60: 7572 6520 5365 6c65 6374 696f 6e3c 2f62  ure Selection</b
-00093f70: 3e3a 2041 7574 6f5f 5669 4d4c 2073 656c  >: Auto_ViML sel
-00093f80: 6563 7473 2076 6172 6961 626c 6573 2061  ects variables a
-00093f90: 7574 6f6d 6174 6963 616c 6c79 2062 7920  utomatically by 
-00093fa0: 6465 6661 756c 742e 2054 6869 7320 6973  default. This is
-00093fb0: 2076 6572 7920 6865 6c70 6675 6c20 7768   very helpful wh
-00093fc0: 656e 2079 6f75 2068 6176 6520 6875 6e64  en you have hund
-00093fd0: 7265 6473 2069 6620 6e6f 7420 7468 6f75  reds if not thou
-00093fe0: 7361 6e64 7320 6f66 2076 6172 6961 626c  sands of variabl
-00093ff0: 6573 2073 696e 6365 2069 7420 6361 6e20  es since it can 
-00094000: 7265 6164 696c 7920 6964 656e 7469 6679  readily identify
-00094010: 2077 6869 6368 206f 6620 7468 6f73 6520   which of those 
-00094020: 6172 6520 696d 706f 7274 616e 7420 7661  are important va
-00094030: 7269 6162 6c65 7320 7673 2077 6869 6368  riables vs which
-00094040: 2061 7265 2075 6e6e 6563 6573 7361 7279   are unnecessary
-00094050: 2e20 596f 7520 6361 6e20 7475 726e 2074  . You can turn t
-00094060: 6869 7320 6f66 6620 6173 2077 656c 6c20  his off as well 
-00094070: 2873 6565 2041 5049 292e 3c62 723e 0a20  (see API).<br>. 
-00094080: 2020 2020 2020 200a 2020 2020 2020 2020         .        
-00094090: 215b 7867 626f 6f73 745d 2873 756c 6f76  ![xgboost](sulov
-000940a0: 5f78 6762 6f6f 7374 2e70 6e67 290a 2020  _xgboost.png).  
-000940b0: 2020 2020 2020 3c6c 693e 3c62 3e52 656d        <li><b>Rem
-000940c0: 6f76 6573 2068 6967 686c 7920 636f 7272  oves highly corr
-000940d0: 656c 6174 6564 2066 6561 7475 7265 7320  elated features 
-000940e0: 6175 746f 6d61 7469 6361 6c6c 793c 2f62  automatically</b
-000940f0: 3e2e 2049 6620 7477 6f20 7661 7269 6162  >. If two variab
-00094100: 6c65 7320 6172 6520 6869 6768 6c79 2063  les are highly c
-00094110: 6f72 7265 6c61 7465 6420 696e 2079 6f75  orrelated in you
-00094120: 7220 6461 7461 7365 742c 2077 6869 6368  r dataset, which
-00094130: 206f 6e65 2073 686f 756c 6420 796f 7520   one should you 
-00094140: 7265 6d6f 7665 2061 6e64 2077 6869 6368  remove and which
-00094150: 206f 6e65 2073 686f 756c 6420 796f 7520   one should you 
-00094160: 6b65 6570 3f20 5468 6520 6465 6369 7369  keep? The decisi
-00094170: 6f6e 2069 7320 6e6f 7420 6173 2065 6173  on is not as eas
-00094180: 7920 6173 2069 7420 6c6f 6f6b 732e 2041  y as it looks. A
-00094190: 7574 6f5f 5669 4d4c 2075 7365 7320 7468  uto_ViML uses th
-000941a0: 6520 5355 4c4f 5620 616c 676f 7269 7468  e SULOV algorith
-000941b0: 6d20 746f 2072 656d 6f76 6520 6869 6768  m to remove high
-000941c0: 6c79 2063 6f72 7265 6c61 7465 6420 6665  ly correlated fe
-000941d0: 6174 7572 6573 2e20 596f 7520 6361 6e20  atures. You can 
-000941e0: 756e 6465 7273 7461 6e64 2053 554c 4f56  understand SULOV
-000941f0: 2066 726f 6d20 7468 6973 2070 6963 7475   from this pictu
-00094200: 7265 206d 6f72 6520 696e 7475 6974 6976  re more intuitiv
-00094210: 656c 792e 3c62 723e 0a20 2020 2020 2020  ely.<br>.       
-00094220: 200a 2020 2020 2020 2020 215b 7375 6c6f   .        ![sulo
-00094230: 765d 2853 554c 4f56 2e6a 7067 290a 2020  v](SULOV.jpg).  
-00094240: 2020 2020 2020 0a20 2020 2020 2020 203c        .        <
-00094250: 6c69 3e3c 623e 4765 6e65 7261 7465 7320  li><b>Generates 
-00094260: 7065 7266 6f72 6d61 6e63 6520 7265 7375  performance resu
-00094270: 6c74 7320 6772 6170 6869 6361 6c6c 793c  lts graphically<
-00094280: 2f62 3e2e 204a 7573 7420 7365 7420 7665  /b>. Just set ve
-00094290: 7262 6f73 6520 3d20 3120 286f 7229 2032  rbose = 1 (or) 2
-000942a0: 2069 6e73 7465 6164 206f 6620 3020 2873   instead of 0 (s
-000942b0: 696c 656e 7429 2e20 596f 7520 7769 6c6c  ilent). You will
-000942c0: 2067 6574 2068 6967 6865 7220 7175 616c   get higher qual
-000942d0: 6974 7920 6f66 2069 6e73 6967 6874 7320  ity of insights 
-000942e0: 6173 2079 6f75 2069 6e63 7265 6173 6520  as you increase 
-000942f0: 7665 7262 6f73 6974 792e 203c 6272 3e0a  verbosity. <br>.
-00094300: 2020 2020 2020 2020 3c6c 693e 3c62 3e48          <li><b>H
-00094310: 616e 646c 6573 2074 6578 742c 2064 6174  andles text, dat
-00094320: 652d 7469 6d65 2c20 7374 7275 6374 7320  e-time, structs 
-00094330: 286c 6973 7473 2c20 6469 6374 696f 6e61  (lists, dictiona
-00094340: 7269 6573 292c 206e 756d 6572 6963 2c20  ries), numeric, 
-00094350: 626f 6f6c 6561 6e2c 2066 6163 746f 7220  boolean, factor 
-00094360: 616e 6420 6361 7465 676f 7269 6361 6c3c  and categorical<
-00094370: 2f62 3e20 7661 7269 6162 6c65 7320 616c  /b> variables al
-00094380: 6c20 696e 206f 6e65 206d 6f64 656c 2075  l in one model u
-00094390: 7369 6e67 206f 6e65 2073 7472 6169 6768  sing one straigh
-000943a0: 7420 7072 6f63 6573 732e 3c62 723e 0a20  t process.<br>. 
-000943b0: 2020 2020 2020 203c 2f6f 6c3e 0a20 2020         </ol>.   
-000943c0: 2020 2020 2041 7574 6f5f 5669 4d4c 2069       Auto_ViML i
-000943d0: 7320 6275 696c 7420 7573 696e 6720 7363  s built using sc
-000943e0: 696b 6974 2d6c 6561 726e 2c20 6e75 6d70  ikit-learn, nump
-000943f0: 792c 2070 616e 6461 7320 616e 6420 6d61  y, pandas and ma
-00094400: 7470 6c6f 746c 6962 2e20 4974 2073 686f  tplotlib. It sho
-00094410: 756c 6420 7275 6e20 6f6e 206d 6f73 7420  uld run on most 
-00094420: 5079 7468 6f6e 2033 2041 6e61 636f 6e64  Python 3 Anacond
-00094430: 6120 696e 7374 616c 6c61 7469 6f6e 732e  a installations.
-00094440: 2059 6f75 2077 6f6e 2774 2068 6176 6520   You won't have 
-00094450: 746f 2069 6d70 6f72 7420 616e 7920 7370  to import any sp
-00094460: 6563 6961 6c20 6c69 6272 6172 6965 7320  ecial libraries 
-00094470: 6f74 6865 7220 7468 616e 2022 5847 426f  other than "XGBo
-00094480: 6f73 7422 2c20 2249 6d62 616c 616e 6365  ost", "Imbalance
-00094490: 642d 4c65 6172 6e22 2c20 2243 6174 426f  d-Learn", "CatBo
-000944a0: 6f73 7422 2c20 616e 6420 2266 6561 7475  ost", and "featu
-000944b0: 7265 746f 6f6c 7322 206c 6962 7261 7279  retools" library
-000944c0: 2e20 5765 2075 7365 2022 5348 4150 2220  . We use "SHAP" 
-000944d0: 6c69 6272 6172 7920 666f 7220 696e 7465  library for inte
-000944e0: 7270 7265 7461 6269 6c69 7479 2e20 3c62  rpretability. <b
-000944f0: 723e 4275 7420 6966 2079 6f75 2064 6f6e  r>But if you don
-00094500: 2774 2068 6176 6520 7468 6573 6520 6c69  't have these li
-00094510: 6272 6172 6965 732c 2041 7574 6f5f 5669  braries, Auto_Vi
-00094520: 4d4c 2077 696c 6c20 696e 7374 616c 6c20  ML will install 
-00094530: 7468 6f73 6520 666f 7220 796f 7520 6175  those for you au
-00094540: 746f 6d61 7469 6361 6c6c 792e 0a20 2020  tomatically..   
-00094550: 2020 2020 200a 2020 2020 2020 2020 2323       .        ##
-00094560: 2049 6e73 7461 6c6c 0a20 2020 2020 2020   Install.       
-00094570: 200a 2020 2020 2020 2020 2a2a 5072 6572   .        **Prer
-00094580: 6571 7573 6974 6573 3a2a 2a0a 2020 2020  equsites:**.    
-00094590: 2020 2020 0a20 2020 2020 2020 202d 205b      .        - [
-000945a0: 416e 6163 6f6e 6461 5d28 6874 7470 733a  Anaconda](https:
-000945b0: 2f2f 646f 6373 2e61 6e61 636f 6e64 612e  //docs.anaconda.
-000945c0: 636f 6d2f 616e 6163 6f6e 6461 2f69 6e73  com/anaconda/ins
-000945d0: 7461 6c6c 2f29 0a20 2020 2020 2020 200a  tall/).        .
-000945e0: 2020 2020 2020 2020 546f 2063 6c6f 6e65          To clone
-000945f0: 2041 7574 6f5f 5669 4d4c 2c20 6974 2069   Auto_ViML, it i
-00094600: 7320 6265 7474 6572 2074 6f20 6372 6561  s better to crea
-00094610: 7465 2061 206e 6577 2065 6e76 6972 6f6e  te a new environ
-00094620: 6d65 6e74 2c20 616e 6420 696e 7374 616c  ment, and instal
-00094630: 6c20 7468 6520 7265 7175 6972 6564 2064  l the required d
-00094640: 6570 656e 6465 6e63 6965 733a 0a20 2020  ependencies:.   
-00094650: 2020 2020 200a 2020 2020 2020 2020 546f       .        To
-00094660: 2069 6e73 7461 6c6c 2066 726f 6d20 5079   install from Py
-00094670: 5069 3a0a 2020 2020 2020 2020 3c70 3e0a  Pi:.        <p>.
-00094680: 2020 2020 2020 2020 3c63 6f64 653e 2420          <code>$ 
-00094690: 7069 7020 696e 7374 616c 6c20 6175 746f  pip install auto
-000946a0: 7669 6d6c 202d 2d75 7067 7261 6465 202d  viml --upgrade -
-000946b0: 2d69 676e 6f72 652d 696e 7374 616c 6c65  -ignore-installe
-000946c0: 643c 2f63 6f64 653e 3c62 723e 0a20 2020  d</code><br>.   
-000946d0: 2020 2020 206f 720a 2020 2020 2020 2020       or.        
-000946e0: 0a20 2020 2020 2020 2060 6060 0a20 2020  .        ```.   
-000946f0: 2020 2020 2070 6970 2069 6e73 7461 6c6c       pip install
-00094700: 2067 6974 2b68 7474 7073 3a2f 2f67 6974   git+https://git
-00094710: 6875 622e 636f 6d2f 4175 746f 5669 4d4c  hub.com/AutoViML
-00094720: 2f41 7574 6f5f 5669 4d4c 2e67 6974 0a20  /Auto_ViML.git. 
-00094730: 2020 2020 2020 2060 6060 0a20 2020 2020         ```.     
-00094740: 2020 200a 2020 2020 2020 2020 546f 2069     .        To i
-00094750: 6e73 7461 6c6c 2066 726f 6d20 736f 7572  nstall from sour
-00094760: 6365 3a0a 2020 2020 2020 2020 0a20 2020  ce:.        .   
-00094770: 2020 2020 2060 6060 0a20 2020 2020 2020       ```.       
-00094780: 2063 6420 3c41 7574 6f56 494d 4c5f 4465   cd <AutoVIML_De
-00094790: 7374 696e 6174 696f 6e3e 0a20 2020 2020  stination>.     
-000947a0: 2020 2067 6974 2063 6c6f 6e65 2067 6974     git clone git
-000947b0: 4067 6974 6875 622e 636f 6d3a 4175 746f  @github.com:Auto
-000947c0: 5669 4d4c 2f41 7574 6f5f 5669 4d4c 2e67  ViML/Auto_ViML.g
-000947d0: 6974 0a20 2020 2020 2020 2023 206f 7220  it.        # or 
-000947e0: 646f 776e 6c6f 6164 2061 6e64 2075 6e7a  download and unz
-000947f0: 6970 2068 7474 7073 3a2f 2f67 6974 6875  ip https://githu
-00094800: 622e 636f 6d2f 4175 746f 5669 4d4c 2f41  b.com/AutoViML/A
-00094810: 7574 6f5f 5669 4d4c 2f61 7263 6869 7665  uto_ViML/archive
-00094820: 2f6d 6173 7465 722e 7a69 700a 2020 2020  /master.zip.    
-00094830: 2020 2020 636f 6e64 6120 6372 6561 7465      conda create
-00094840: 202d 6e20 3c79 6f75 725f 656e 765f 6e61   -n <your_env_na
-00094850: 6d65 3e20 7079 7468 6f6e 3d33 2e37 2061  me> python=3.7 a
-00094860: 6e61 636f 6e64 610a 2020 2020 2020 2020  naconda.        
-00094870: 636f 6e64 6120 6163 7469 7661 7465 203c  conda activate <
-00094880: 796f 7572 5f65 6e76 5f6e 616d 653e 2023  your_env_name> #
-00094890: 204f 4e20 5749 4e44 4f57 533a 2060 736f   ON WINDOWS: `so
-000948a0: 7572 6365 2061 6374 6976 6174 6520 3c79  urce activate <y
-000948b0: 6f75 725f 656e 765f 6e61 6d65 3e60 0a20  our_env_name>`. 
-000948c0: 2020 2020 2020 2063 6420 4175 746f 5f56         cd Auto_V
-000948d0: 694d 4c0a 2020 2020 2020 2020 7069 7020  iML.        pip 
-000948e0: 696e 7374 616c 6c20 2d72 2072 6571 7569  install -r requi
-000948f0: 7265 6d65 6e74 732e 7478 740a 2020 2020  rements.txt.    
-00094900: 2020 2020 6060 600a 2020 2020 2020 2020      ```.        
-00094910: 0a20 2020 2020 2020 2023 2320 5573 6167  .        ## Usag
-00094920: 650a 2020 2020 2020 2020 0a20 2020 2020  e.        .     
-00094930: 2020 2049 6e20 7468 6520 7361 6d65 2064     In the same d
-00094940: 6972 6563 746f 7279 2c20 6f70 656e 2061  irectory, open a
-00094950: 204a 7570 7974 6572 204e 6f74 6562 6f6f   Jupyter Noteboo
-00094960: 6b20 616e 6420 7573 6520 7468 6973 206c  k and use this l
-00094970: 696e 6520 746f 2069 6d70 6f72 7420 7468  ine to import th
-00094980: 6520 2e70 7920 6669 6c65 3a0a 2020 2020  e .py file:.    
-00094990: 2020 2020 0a20 2020 2020 2020 2060 6060      .        ```
-000949a0: 0a20 2020 2020 2020 2066 726f 6d20 6175  .        from au
-000949b0: 746f 7669 6d6c 2e41 7574 6f5f 5669 4d4c  toviml.Auto_ViML
-000949c0: 2069 6d70 6f72 7420 4175 746f 5f56 694d   import Auto_ViM
-000949d0: 4c0a 2020 2020 2020 2020 6060 600a 2020  L.        ```.  
-000949e0: 2020 2020 2020 0a20 2020 2020 2020 204c        .        L
-000949f0: 6f61 6420 6120 6461 7461 2073 6574 2028  oad a data set (
-00094a00: 616e 7920 4353 5620 6f72 2074 6578 7420  any CSV or text 
-00094a10: 6669 6c65 2920 696e 746f 2061 2050 616e  file) into a Pan
-00094a20: 6461 7320 6461 7461 6672 616d 6520 616e  das dataframe an
-00094a30: 6420 7370 6c69 7420 6974 2069 6e74 6f20  d split it into 
-00094a40: 5472 6169 6e20 616e 6420 5465 7374 2064  Train and Test d
-00094a50: 6174 6166 7261 6d65 732e 2049 6620 796f  ataframes. If yo
-00094a60: 7520 646f 6e27 7420 6861 7665 2061 2074  u don't have a t
-00094a70: 6573 7420 6461 7461 6672 616d 652c 2079  est dataframe, y
-00094a80: 6f75 2063 616e 2073 696d 706c 6520 6173  ou can simple as
-00094a90: 7369 676e 2074 6865 2074 6573 7420 7661  sign the test va
-00094aa0: 7269 6162 6c65 2062 656c 6f77 2074 6f20  riable below to 
-00094ab0: 2727 2028 656d 7074 7920 7374 7269 6e67  '' (empty string
-00094ac0: 293a 0a20 2020 2020 2020 200a 2020 2020  ):.        .    
-00094ad0: 2020 2020 6060 600a 2020 2020 2020 2020      ```.        
-00094ae0: 6d6f 6465 6c2c 2066 6561 7475 7265 732c  model, features,
-00094af0: 2074 7261 696e 6d2c 2074 6573 746d 203d   trainm, testm =
-00094b00: 2041 7574 6f5f 5669 4d4c 280a 2020 2020   Auto_ViML(.    
-00094b10: 2020 2020 2020 2020 7472 6169 6e2c 0a20          train,. 
-00094b20: 2020 2020 2020 2020 2020 2074 6172 6765             targe
-00094b30: 742c 0a20 2020 2020 2020 2020 2020 2074  t,.            t
-00094b40: 6573 742c 0a20 2020 2020 2020 2020 2020  est,.           
-00094b50: 2073 616d 706c 655f 7375 626d 6973 7369   sample_submissi
-00094b60: 6f6e 2c0a 2020 2020 2020 2020 2020 2020  on,.            
-00094b70: 6879 7065 725f 7061 7261 6d3d 2247 5322  hyper_param="GS"
-00094b80: 2c0a 2020 2020 2020 2020 2020 2020 6665  ,.            fe
-00094b90: 6174 7572 655f 7265 6475 6374 696f 6e3d  ature_reduction=
-00094ba0: 5472 7565 2c0a 2020 2020 2020 2020 2020  True,.          
-00094bb0: 2020 7363 6f72 696e 675f 7061 7261 6d65    scoring_parame
-00094bc0: 7465 723d 2277 6569 6768 7465 642d 6631  ter="weighted-f1
-00094bd0: 222c 0a20 2020 2020 2020 2020 2020 204b  ",.            K
-00094be0: 4d65 616e 735f 4665 6174 7572 697a 6572  Means_Featurizer
-00094bf0: 3d46 616c 7365 2c0a 2020 2020 2020 2020  =False,.        
-00094c00: 2020 2020 426f 6f73 7469 6e67 5f46 6c61      Boosting_Fla
-00094c10: 673d 4661 6c73 652c 0a20 2020 2020 2020  g=False,.       
-00094c20: 2020 2020 2042 696e 6e69 6e67 5f46 6c61       Binning_Fla
-00094c30: 673d 4661 6c73 652c 0a20 2020 2020 2020  g=False,.       
-00094c40: 2020 2020 2041 6464 5f50 6f6c 793d 4661       Add_Poly=Fa
-00094c50: 6c73 652c 0a20 2020 2020 2020 2020 2020  lse,.           
-00094c60: 2053 7461 636b 696e 675f 466c 6167 3d46   Stacking_Flag=F
-00094c70: 616c 7365 2c0a 2020 2020 2020 2020 2020  alse,.          
-00094c80: 2020 496d 6261 6c61 6e63 6564 5f46 6c61    Imbalanced_Fla
-00094c90: 673d 4661 6c73 652c 0a20 2020 2020 2020  g=False,.       
-00094ca0: 2020 2020 2076 6572 626f 7365 3d30 2c0a       verbose=0,.
-00094cb0: 2020 2020 2020 2020 290a 2020 2020 2020          ).      
-00094cc0: 2020 6060 600a 2020 2020 2020 2020 0a20    ```.        . 
-00094cd0: 2020 2020 2020 2046 696e 616c 6c79 2c20         Finally, 
-00094ce0: 6974 2077 7269 7465 7320 796f 7572 2073  it writes your s
-00094cf0: 7562 6d69 7373 696f 6e20 6669 6c65 2074  ubmission file t
-00094d00: 6f20 6469 736b 2069 6e20 7468 6520 6375  o disk in the cu
-00094d10: 7272 656e 7420 6469 7265 6374 6f72 7920  rrent directory 
-00094d20: 6361 6c6c 6564 2060 6d79 7375 626d 6973  called `mysubmis
-00094d30: 7369 6f6e 2e63 7376 602e 0a20 2020 2020  sion.csv`..     
-00094d40: 2020 2054 6869 7320 7375 626d 6973 7369     This submissi
-00094d50: 6f6e 2066 696c 6520 6973 2072 6561 6479  on file is ready
-00094d60: 2066 6f72 2079 6f75 2074 6f20 7368 6f77   for you to show
-00094d70: 2069 7420 636c 6965 6e74 7320 6f72 2073   it clients or s
-00094d80: 7562 6d69 7420 6974 2074 6f20 636f 6d70  ubmit it to comp
-00094d90: 6574 6974 696f 6e73 2e0a 2020 2020 2020  etitions..      
-00094da0: 2020 4966 206e 6f20 7375 626d 6973 7369    If no submissi
-00094db0: 6f6e 2066 696c 6520 7761 7320 6769 7665  on file was give
-00094dc0: 6e2c 2062 7574 2061 7320 6c6f 6e67 2061  n, but as long a
-00094dd0: 7320 796f 7520 6769 7665 2069 7420 6120  s you give it a 
-00094de0: 7465 7374 2066 696c 6520 6e61 6d65 2c20  test file name, 
-00094df0: 6974 2077 696c 6c20 6372 6561 7465 2061  it will create a
-00094e00: 2073 7562 6d69 7373 696f 6e20 6669 6c65   submission file
-00094e10: 2066 6f72 2079 6f75 206e 616d 6564 2060   for you named `
-00094e20: 6d79 5375 626d 6973 7369 6f6e 2e63 7376  mySubmission.csv
-00094e30: 602e 0a20 2020 2020 2020 2041 7574 6f5f  `..        Auto_
-00094e40: 5669 4d4c 2077 6f72 6b73 206f 6e20 616e  ViML works on an
-00094e50: 7920 4d75 6c74 692d 436c 6173 732c 204d  y Multi-Class, M
-00094e60: 756c 7469 2d4c 6162 656c 2044 6174 6120  ulti-Label Data 
-00094e70: 5365 742e 2053 6f20 796f 7520 6361 6e20  Set. So you can 
-00094e80: 6861 7665 206d 616e 7920 7461 7267 6574  have many target
-00094e90: 206c 6162 656c 732e 0a20 2020 2020 2020   labels..       
-00094ea0: 2059 6f75 2064 6f6e 2774 2068 6176 6520   You don't have 
-00094eb0: 746f 2074 656c 6c20 4175 746f 5f56 694d  to tell Auto_ViM
-00094ec0: 4c20 7768 6574 6865 7220 6974 2069 7320  L whether it is 
-00094ed0: 6120 5265 6772 6573 7369 6f6e 206f 7220  a Regression or 
-00094ee0: 436c 6173 7369 6669 6361 7469 6f6e 2070  Classification p
-00094ef0: 726f 626c 656d 2e0a 2020 2020 2020 2020  roblem..        
-00094f00: 0a20 2020 2020 2020 2023 2320 5469 7073  .        ## Tips
-00094f10: 2066 6f72 2075 7369 6e67 2041 7574 6f5f   for using Auto_
-00094f20: 5669 4d4c 3a0a 2020 2020 2020 2020 312e  ViML:.        1.
-00094f30: 2060 7363 6f72 696e 675f 7061 7261 6d65   `scoring_parame
-00094f40: 7465 7260 3a20 466f 7220 436c 6173 7369  ter`: For Classi
-00094f50: 6669 6361 7469 6f6e 2070 726f 626c 656d  fication problem
-00094f60: 7320 616e 6420 696d 6261 6c61 6e63 6564  s and imbalanced
-00094f70: 2063 6c61 7373 6573 2c20 6368 6f6f 7365   classes, choose
-00094f80: 2073 636f 7269 6e67 5f70 6172 616d 6574   scoring_paramet
-00094f90: 6572 3d22 6261 6c61 6e63 6564 5f61 6363  er="balanced_acc
-00094fa0: 7572 6163 7922 2e20 4974 2077 6f72 6b73  uracy". It works
-00094fb0: 2062 6574 7465 722e 0a20 2020 2020 2020   better..       
-00094fc0: 2032 2e20 6049 6d62 616c 616e 6365 645f   2. `Imbalanced_
-00094fd0: 466c 6167 603a 2046 6f72 2049 6d62 616c  Flag`: For Imbal
-00094fe0: 616e 6365 6420 436c 6173 7365 7320 283c  anced Classes (<
-00094ff0: 3525 2073 616d 706c 6573 2069 6e20 7261  5% samples in ra
-00095000: 7265 2063 6c61 7373 292c 2063 686f 6f73  re class), choos
-00095010: 6520 2249 6d62 616c 616e 6365 645f 466c  e "Imbalanced_Fl
-00095020: 6167 223d 5472 7565 2e20 596f 7520 6361  ag"=True. You ca
-00095030: 6e20 616c 736f 2073 6574 2074 6869 7320  n also set this 
-00095040: 666c 6167 2074 6f20 5472 7565 2066 6f72  flag to True for
-00095050: 2052 6567 7265 7373 696f 6e20 7072 6f62   Regression prob
-00095060: 6c65 6d73 2077 6865 7265 2074 6865 2074  lems where the t
-00095070: 6172 6765 7420 7661 7269 6162 6c65 206d  arget variable m
-00095080: 6967 6874 2068 6176 6520 736b 6577 6564  ight have skewed
-00095090: 2064 6973 7472 6962 7574 696f 6e73 2e0a   distributions..
-000950a0: 2020 2020 2020 2020 332e 2060 7461 7267          3. `targ
-000950b0: 6574 603a 2046 6f72 204d 756c 7469 2d4c  et`: For Multi-L
-000950c0: 6162 656c 2064 6174 6173 6574 2c20 7468  abel dataset, th
-000950d0: 6520 7461 7267 6574 2069 6e70 7574 2074  e target input t
-000950e0: 6172 6765 7420 7661 7269 6162 6c65 2063  arget variable c
-000950f0: 616e 2062 6520 7365 6e74 2069 6e20 6173  an be sent in as
-00095100: 2061 206c 6973 7420 6f66 2076 6172 6961   a list of varia
-00095110: 626c 6573 2e0a 2020 2020 2020 2020 342e  bles..        4.
-00095120: 2060 426f 6f73 7469 6e67 5f46 6c61 6760   `Boosting_Flag`
-00095130: 3a20 4974 2069 7320 7265 636f 6d6d 656e  : It is recommen
-00095140: 6465 6420 7468 6174 2079 6f75 2066 6972  ded that you fir
-00095150: 7374 2073 6574 2042 6f6f 7374 696e 675f  st set Boosting_
-00095160: 466c 6167 3d4e 6f6e 6520 746f 2067 6574  Flag=None to get
-00095170: 2061 204c 696e 6561 7220 6d6f 6465 6c2e   a Linear model.
-00095180: 204f 6e63 6520 796f 7520 756e 6465 7273   Once you unders
-00095190: 7461 6e64 2074 6861 742c 2074 6865 6e20  tand that, then 
-000951a0: 796f 7520 6361 6e20 7472 7920 746f 2073  you can try to s
-000951b0: 6574 2042 6f6f 7374 696e 675f 466c 6167  et Boosting_Flag
-000951c0: 3d46 616c 7365 2074 6f20 6765 7420 6120  =False to get a 
-000951d0: 5261 6e64 6f6d 2046 6f72 6573 7420 6d6f  Random Forest mo
-000951e0: 6465 6c2e 2046 696e 616c 6c79 2c20 7472  del. Finally, tr
-000951f0: 7920 426f 6f73 7469 6e67 5f46 6c61 673d  y Boosting_Flag=
-00095200: 5472 7565 2074 6f20 6765 7420 616e 2058  True to get an X
-00095210: 4742 6f6f 7374 206d 6f64 656c 2e20 5468  GBoost model. Th
-00095220: 6973 2069 7320 7468 6520 6f72 6465 7220  is is the order 
-00095230: 7468 6174 2077 6520 7265 636f 6d6d 656e  that we recommen
-00095240: 6420 696e 206f 7264 6572 2074 6f20 7573  d in order to us
-00095250: 6520 4175 746f 5f56 694d 4c2e 2046 696e  e Auto_ViML. Fin
-00095260: 616c 6c79 2074 7279 2042 6f6f 7374 696e  ally try Boostin
-00095270: 675f 466c 6167 3d22 4361 7442 6f6f 7374  g_Flag="CatBoost
-00095280: 2220 746f 2067 6574 2061 2063 6f6d 706c  " to get a compl
-00095290: 6578 2062 7574 2068 6967 6820 7065 7266  ex but high perf
-000952a0: 6f72 6d69 6e67 206d 6f64 656c 2e0a 2020  orming model..  
-000952b0: 2020 2020 2020 352e 2060 4269 6e6e 696e        5. `Binnin
-000952c0: 675f 466c 6167 603a 2042 696e 6e69 6e67  g_Flag`: Binning
-000952d0: 5f46 6c61 673d 5472 7565 2069 6d70 726f  _Flag=True impro
-000952e0: 7665 7320 6120 4361 7442 6f6f 7374 206d  ves a CatBoost m
-000952f0: 6f64 656c 2073 696e 6365 2069 7420 6164  odel since it ad
-00095300: 6473 2074 6f20 7468 6520 6c69 7374 206f  ds to the list o
-00095310: 6620 6361 7465 676f 7269 6361 6c20 7661  f categorical va
-00095320: 7273 2069 6e20 6461 7461 0a20 2020 2020  rs in data.     
-00095330: 2020 2036 2e20 604b 4d65 616e 735f 6665     6. `KMeans_fe
-00095340: 6174 7572 697a 6572 603a 204b 4d65 616e  aturizer`: KMean
-00095350: 735f 6665 6174 7572 697a 6572 3d54 7275  s_featurizer=Tru
-00095360: 6520 776f 726b 7320 7765 6c6c 2069 6e20  e works well in 
-00095370: 4e4c 5020 616e 6420 4361 7442 6f6f 7374  NLP and CatBoost
-00095380: 206d 6f64 656c 7320 7369 6e63 6520 6974   models since it
-00095390: 2063 7265 6174 6573 2063 6c75 7374 6572   creates cluster
-000953a0: 2076 6172 6961 626c 6573 0a20 2020 2020   variables.     
-000953b0: 2020 2037 2e20 6041 6464 5f50 6f6c 7960     7. `Add_Poly`
-000953c0: 3a20 4164 645f 506f 6c79 3d33 2069 6d70  : Add_Poly=3 imp
-000953d0: 726f 7665 7320 6365 7274 6169 6e20 6d6f  roves certain mo
-000953e0: 6465 6c73 2077 6865 7265 2074 6865 7265  dels where there
-000953f0: 2069 7320 6461 7465 2d74 696d 6520 6f72   is date-time or
-00095400: 2063 6174 6567 6f72 6963 616c 2061 6e64   categorical and
-00095410: 206e 756d 6572 6963 2076 6172 6961 626c   numeric variabl
-00095420: 6573 0a20 2020 2020 2020 2038 2e20 6066  es.        8. `f
-00095430: 6561 7475 7265 5f72 6564 7563 7469 6f6e  eature_reduction
-00095440: 603a 2066 6561 7475 7265 5f72 6564 7563  `: feature_reduc
-00095450: 7469 6f6e 3d54 7275 6520 6973 2074 6865  tion=True is the
-00095460: 2064 6566 6175 6c74 2061 6e64 2077 6f72   default and wor
-00095470: 6b73 2062 6573 742e 2042 7574 2077 6865  ks best. But whe
-00095480: 6e20 796f 7520 6861 7665 203c 3130 2066  n you have <10 f
-00095490: 6561 7475 7265 7320 696e 2064 6174 612c  eatures in data,
-000954a0: 2073 6574 2069 7420 746f 2046 616c 7365   set it to False
-000954b0: 0a20 2020 2020 2020 2039 2e20 6053 7461  .        9. `Sta
-000954c0: 636b 696e 675f 466c 6167 603a 2044 6f20  cking_Flag`: Do 
-000954d0: 6e6f 7420 7365 7420 5374 6163 6b69 6e67  not set Stacking
-000954e0: 5f46 6c61 673d 5472 7565 2077 6974 6820  _Flag=True with 
-000954f0: 4c69 6e65 6172 206d 6f64 656c 7320 7369  Linear models si
-00095500: 6e63 6520 796f 7572 2072 6573 756c 7473  nce your results
-00095510: 206d 6179 206e 6f74 206c 6f6f 6b20 6772   may not look gr
-00095520: 6561 742e 0a20 2020 2020 2020 2031 302e  eat..        10.
-00095530: 2060 5374 6163 6b69 6e67 5f46 6c61 6760   `Stacking_Flag`
-00095540: 3a20 5573 6520 5374 6163 6b69 6e67 5f46  : Use Stacking_F
-00095550: 6c61 673d 5472 7565 206f 6e6c 7920 666f  lag=True only fo
-00095560: 7220 636f 6d70 6c65 7820 6d6f 6465 6c73  r complex models
-00095570: 2061 6e64 2061 7320 6120 6c61 7374 2073   and as a last s
-00095580: 7465 7020 7769 7468 2042 6f6f 7374 696e  tep with Boostin
-00095590: 675f 466c 6167 3d54 7275 6520 6f72 2043  g_Flag=True or C
-000955a0: 6174 426f 6f73 740a 2020 2020 2020 2020  atBoost.        
-000955b0: 3131 2e20 6068 7970 6572 5f70 6172 616d  11. `hyper_param
-000955c0: 603a 204c 6561 7665 2068 7970 6572 5f70  `: Leave hyper_p
-000955d0: 6172 616d 203d 2252 5322 2061 7320 696e  aram ="RS" as in
-000955e0: 7075 7420 7369 6e63 6520 6974 2072 756e  put since it run
-000955f0: 7320 6661 7374 6572 2074 6861 6e20 4772  s faster than Gr
-00095600: 6964 5365 6172 6368 4356 2061 6e64 2067  idSearchCV and g
-00095610: 6976 6573 2062 6574 7465 7220 7265 7375  ives better resu
-00095620: 6c74 7320 756e 6c65 7373 2079 6f75 2068  lts unless you h
-00095630: 6176 6520 6120 736d 616c 6c20 6461 7461  ave a small data
-00095640: 2073 6574 2061 6e64 2063 616e 2061 6666   set and can aff
-00095650: 6f72 6420 746f 2073 7065 6e64 2074 696d  ord to spend tim
-00095660: 6520 6f6e 2068 7970 6572 2074 756e 696e  e on hyper tunin
-00095670: 672e 0a20 2020 2020 2020 2031 322e 2060  g..        12. `
-00095680: 4b4d 6561 6e73 5f46 6561 7475 7269 7a65  KMeans_Featurize
-00095690: 7260 3a20 4b4d 6561 6e73 5f46 6561 7475  r`: KMeans_Featu
-000956a0: 7269 7a65 723d 5472 7565 2064 6f65 7320  rizer=True does 
-000956b0: 6e6f 7420 776f 726b 2077 656c 6c20 666f  not work well fo
-000956c0: 7220 736d 616c 6c20 6461 7461 2073 6574  r small data set
-000956d0: 732e 2055 7365 2069 7420 666f 7220 6461  s. Use it for da
-000956e0: 7461 2073 6574 7320 3e20 3130 2c30 3030  ta sets > 10,000
-000956f0: 2072 6f77 732e 0a20 2020 2020 2020 2031   rows..        1
-00095700: 332e 2060 4669 6e61 6c20 7468 6f75 6768  3. `Final though
-00095710: 7473 603a 2046 696e 616c 6c79 2041 7574  ts`: Finally Aut
-00095720: 6f5f 5669 4d4c 2069 7320 6d65 616e 7420  o_ViML is meant 
-00095730: 746f 2062 6520 6120 6261 7365 6c69 6e65  to be a baseline
-00095740: 206f 7220 6368 616c 6c65 6e67 6572 2073   or challenger s
-00095750: 6f6c 7574 696f 6e20 746f 2079 6f75 7220  olution to your 
-00095760: 6461 7461 2073 6574 2e20 536f 2075 7365  data set. So use
-00095770: 2069 7420 666f 7220 6d61 6b69 6e67 2071   it for making q
-00095780: 7569 636b 206d 6f64 656c 7320 7468 6174  uick models that
-00095790: 2079 6f75 2063 616e 2063 6f6d 7061 7265   you can compare
-000957a0: 2061 6761 696e 7374 206f 7220 696e 2048   against or in H
-000957b0: 6163 6b61 7468 6f6e 732e 2049 7420 6973  ackathons. It is
-000957c0: 206e 6f74 206d 6561 6e74 2066 6f72 2070   not meant for p
-000957d0: 726f 6475 6374 696f 6e21 0a20 2020 2020  roduction!.     
-000957e0: 2020 200a 2020 2020 2020 2020 2323 2041     .        ## A
-000957f0: 5049 0a20 2020 2020 2020 200a 2020 2020  PI.        .    
-00095800: 2020 2020 2a2a 4172 6775 6d65 6e74 732a      **Arguments*
-00095810: 2a0a 2020 2020 2020 2020 0a20 2020 2020  *.        .     
-00095820: 2020 202d 2060 7472 6169 6e60 3a20 636f     - `train`: co
-00095830: 756c 6420 6265 2061 2064 6174 6170 6174  uld be a datapat
-00095840: 682b 6669 6c65 6e61 6d65 206f 7220 6120  h+filename or a 
-00095850: 6461 7461 6672 616d 652e 2049 7420 7769  dataframe. It wi
-00095860: 6c6c 2064 6574 6563 7420 7768 6963 6820  ll detect which 
-00095870: 6973 2077 6869 6368 2061 6e64 206c 6f61  is which and loa
-00095880: 6420 6974 2e0a 2020 2020 2020 2020 2d20  d it..        - 
-00095890: 6074 6573 7460 3a20 636f 756c 6420 6265  `test`: could be
-000958a0: 2061 2064 6174 6170 6174 682b 6669 6c65   a datapath+file
-000958b0: 6e61 6d65 206f 7220 6120 6461 7461 6672  name or a datafr
-000958c0: 616d 652e 2049 6620 796f 7520 646f 6e27  ame. If you don'
-000958d0: 7420 6861 7665 2061 6e79 2c20 6a75 7374  t have any, just
-000958e0: 206c 6561 7665 2069 7420 6173 2022 222e   leave it as "".
-000958f0: 0a20 2020 2020 2020 202d 2060 7375 626d  .        - `subm
-00095900: 6973 7369 6f6e 603a 206d 7573 7420 6265  ission`: must be
-00095910: 2061 2064 6174 6170 6174 682b 6669 6c65   a datapath+file
-00095920: 6e61 6d65 2e20 4966 2079 6f75 2064 6f6e  name. If you don
-00095930: 2774 2068 6176 6520 616e 792c 206a 7573  't have any, jus
-00095940: 7420 6c65 6176 6520 6974 2061 7320 656d  t leave it as em
-00095950: 7074 7920 7374 7269 6e67 2e0a 2020 2020  pty string..    
-00095960: 2020 2020 2d20 6074 6172 6765 7460 3a20      - `target`: 
-00095970: 6e61 6d65 206f 6620 7468 6520 7461 7267  name of the targ
-00095980: 6574 2076 6172 6961 626c 6520 696e 2074  et variable in t
-00095990: 6865 2064 6174 6120 7365 742e 0a20 2020  he data set..   
-000959a0: 2020 2020 202d 2060 7365 7060 3a20 6966       - `sep`: if
-000959b0: 2079 6f75 2068 6176 6520 6120 7370 6561   you have a spea
-000959c0: 7261 746f 7220 696e 2074 6865 2066 696c  rator in the fil
-000959d0: 6520 7375 6368 2061 7320 222c 2220 6f72  e such as "," or
-000959e0: 2022 5c74 2220 6d65 6e74 696f 6e20 6974   "\t" mention it
-000959f0: 2068 6572 652e 2044 6566 6175 6c74 2069   here. Default i
-00095a00: 7320 222c 222e 0a20 2020 2020 2020 202d  s ","..        -
-00095a10: 2060 7363 6f72 696e 675f 7061 7261 6d65   `scoring_parame
-00095a20: 7465 7260 3a20 6966 2079 6f75 2077 616e  ter`: if you wan
-00095a30: 7420 796f 7572 206f 776e 2073 636f 7269  t your own scori
-00095a40: 6e67 2070 6172 616d 6574 6572 2073 7563  ng parameter suc
-00095a50: 6820 6173 2022 6631 2220 6769 7665 2069  h as "f1" give i
-00095a60: 7420 6865 7265 2e20 4966 206e 6f74 2c20  t here. If not, 
-00095a70: 6974 2077 696c 6c20 6173 7375 6d65 2074  it will assume t
-00095a80: 6865 2061 7070 726f 7072 6961 7465 2073  he appropriate s
-00095a90: 636f 7269 6e67 2070 6172 616d 2066 6f72  coring param for
-00095aa0: 2074 6865 2070 726f 626c 656d 2061 6e64   the problem and
-00095ab0: 2069 7420 7769 6c6c 2062 7569 6c64 2074   it will build t
-00095ac0: 6865 206d 6f64 656c 2e0a 2020 2020 2020  he model..      
-00095ad0: 2020 2d20 6068 7970 6572 5f70 6172 616d    - `hyper_param
-00095ae0: 603a 2054 756e 696e 6720 6f70 7469 6f6e  `: Tuning option
-00095af0: 7320 6172 6520 4772 6964 5365 6172 6368  s are GridSearch
-00095b00: 2028 2747 5327 2920 616e 6420 5261 6e64   ('GS') and Rand
-00095b10: 6f6d 697a 6564 5365 6172 6368 2028 2752  omizedSearch ('R
-00095b20: 5327 292e 2044 6566 6175 6c74 2069 7320  S'). Default is 
-00095b30: 2752 5327 2e0a 2020 2020 2020 2020 2d20  'RS'..        - 
-00095b40: 6066 6561 7475 7265 5f72 6564 7563 7469  `feature_reducti
-00095b50: 6f6e 603a 2044 6566 6175 6c74 203d 2027  on`: Default = '
-00095b60: 5472 7565 2720 6275 7420 6974 2063 616e  True' but it can
-00095b70: 2062 6520 7365 7420 746f 2046 616c 7365   be set to False
-00095b80: 2069 6620 796f 7520 646f 6e27 7420 7761   if you don't wa
-00095b90: 6e74 2061 7574 6f6d 6174 6963 2066 6561  nt automatic fea
-00095ba0: 7475 7265 5f72 6564 7563 7469 6f6e 2073  ture_reduction s
-00095bb0: 696e 6365 2069 6e20 496d 6167 6520 6461  ince in Image da
-00095bc0: 7461 2073 6574 7320 6c69 6b65 2064 6967  ta sets like dig
-00095bd0: 6974 7320 616e 6420 4d4e 4953 542c 2079  its and MNIST, y
-00095be0: 6f75 2067 6574 2062 6574 7465 7220 7265  ou get better re
-00095bf0: 7375 6c74 7320 7768 656e 2079 6f75 2064  sults when you d
-00095c00: 6f6e 2774 2072 6564 7563 6520 6665 6174  on't reduce feat
-00095c10: 7572 6573 2061 7574 6f6d 6174 6963 616c  ures automatical
-00095c20: 6c79 2e20 596f 7520 6361 6e20 616c 7761  ly. You can alwa
-00095c30: 7973 2074 7279 2062 6f74 6820 616e 6420  ys try both and 
-00095c40: 7365 652e 0a20 2020 2020 2020 202d 2060  see..        - `
-00095c50: 4b4d 6561 6e73 5f46 6561 7475 7269 7a65  KMeans_Featurize
-00095c60: 7260 0a20 2020 2020 2020 2020 202d 2060  r`.          - `
-00095c70: 5472 7565 603a 2041 6464 7320 6120 636c  True`: Adds a cl
-00095c80: 7573 7465 7220 6c61 6265 6c20 746f 2066  uster label to f
-00095c90: 6561 7475 7265 7320 6261 7365 6420 6f6e  eatures based on
-00095ca0: 204b 4d65 616e 732e 2055 7365 2066 6f72   KMeans. Use for
-00095cb0: 204c 696e 6561 722e 0a20 2020 2020 2020   Linear..       
-00095cc0: 2020 202d 2060 4661 6c73 6520 2864 6566     - `False (def
-00095cd0: 6175 6c74 2960 2046 6f72 2052 616e 646f  ault)` For Rando
-00095ce0: 6d20 466f 7265 7374 7320 6f72 2058 4742  m Forests or XGB
-00095cf0: 206d 6f64 656c 732c 206c 6561 7665 2069   models, leave i
-00095d00: 7420 4661 6c73 6520 7369 6e63 6520 6974  t False since it
-00095d10: 206d 6179 206f 7665 7266 6974 2e0a 2020   may overfit..  
-00095d20: 2020 2020 2020 2d20 6042 6f6f 7374 696e        - `Boostin
-00095d30: 6720 466c 6167 603a 2079 6f75 2068 6176  g Flag`: you hav
-00095d40: 6520 3420 706f 7373 6962 6c65 2063 686f  e 4 possible cho
-00095d50: 6963 6573 2028 6465 6661 756c 7420 6973  ices (default is
-00095d60: 2046 616c 7365 293a 0a20 2020 2020 2020   False):.       
-00095d70: 2020 202d 2060 4e6f 6e65 6020 5468 6973     - `None` This
-00095d80: 2077 696c 6c20 6275 696c 6420 6120 4c69   will build a Li
-00095d90: 6e65 6172 204d 6f64 656c 0a20 2020 2020  near Model.     
-00095da0: 2020 2020 202d 2060 4661 6c73 6560 2054       - `False` T
-00095db0: 6869 7320 7769 6c6c 2062 7569 6c64 2061  his will build a
-00095dc0: 2052 616e 646f 6d20 466f 7265 7374 206f   Random Forest o
-00095dd0: 7220 4578 7472 6120 5472 6565 7320 6d6f  r Extra Trees mo
-00095de0: 6465 6c20 2861 6c73 6f20 6b6e 6f77 6e20  del (also known 
-00095df0: 6173 2042 6167 6769 6e67 290a 2020 2020  as Bagging).    
-00095e00: 2020 2020 2020 2d20 6054 7275 6560 2054        - `True` T
-00095e10: 6869 7320 7769 6c6c 2062 7569 6c64 2061  his will build a
-00095e20: 6e20 5847 426f 6f73 7420 6d6f 6465 6c0a  n XGBoost model.
-00095e30: 2020 2020 2020 2020 2020 2d20 6043 6174            - `Cat
-00095e40: 426f 6f73 7460 2054 6869 7320 7769 6c6c  Boost` This will
-00095e50: 2062 7569 6c64 2061 2043 6174 426f 6f73   build a CatBoos
-00095e60: 7420 6d6f 6465 6c20 2870 726f 7669 6465  t model (provide
-00095e70: 6420 796f 7520 6861 7665 2043 6174 426f  d you have CatBo
-00095e80: 6f73 7420 696e 7374 616c 6c65 6429 0a20  ost installed). 
-00095e90: 2020 2020 2020 202d 2060 4164 645f 506f         - `Add_Po
-00095ea0: 6c79 603a 2044 6566 6175 6c74 2069 7320  ly`: Default is 
-00095eb0: 3020 7768 6963 6820 6d65 616e 7320 646f  0 which means do
-00095ec0: 2d6e 6f74 6869 6e67 2e20 4275 7420 6974  -nothing. But it
-00095ed0: 2068 6173 2074 6872 6565 2069 6e74 6572   has three inter
-00095ee0: 6573 7469 6e67 2073 6574 7469 6e67 733a  esting settings:
-00095ef0: 0a20 2020 2020 2020 2020 202d 2060 3160  .          - `1`
-00095f00: 2041 6464 2069 6e74 6572 6163 7469 6f6e   Add interaction
-00095f10: 2076 6172 6961 626c 6573 206f 6e6c 7920   variables only 
-00095f20: 7375 6368 2061 7320 7831 2a78 322c 2078  such as x1*x2, x
-00095f30: 322a 7833 2c2e 2e2e 7839 5c2a 3130 2065  2*x3,...x9\*10 e
-00095f40: 7463 2e0a 2020 2020 2020 2020 2020 2d20  tc..          - 
-00095f50: 6032 6020 4164 6420 496e 7465 7261 6374  `2` Add Interact
-00095f60: 696f 6e73 2061 6e64 2053 7175 6172 6564  ions and Squared
-00095f70: 2076 6172 6961 626c 6573 2073 7563 6820   variables such 
-00095f80: 6173 2078 312a 2a32 2c20 7832 2a2a 322c  as x1**2, x2**2,
-00095f90: 2065 7463 2e0a 2020 2020 2020 2020 2020   etc..          
-00095fa0: 2d20 6033 6020 4164 6473 2062 6f74 6820  - `3` Adds both 
-00095fb0: 496e 7465 7261 6374 696f 6e73 2061 6e64  Interactions and
-00095fc0: 2053 7175 6172 6564 2076 6172 6961 626c   Squared variabl
-00095fd0: 6573 2073 7563 6820 6173 2078 312a 7832  es such as x1*x2
-00095fe0: 2c20 7831 2a2a 322c 7832 2a78 332c 2078  , x1**2,x2*x3, x
-00095ff0: 322a 2a32 2c20 6574 632e 0a20 2020 2020  2**2, etc..     
-00096000: 2020 202d 2060 5374 6163 6b69 6e67 5f46     - `Stacking_F
-00096010: 6c61 6760 3a20 4465 6661 756c 7420 6973  lag`: Default is
-00096020: 2046 616c 7365 2e20 4966 2073 6574 2074   False. If set t
-00096030: 6f20 5472 7565 2c20 6974 2077 696c 6c20  o True, it will 
-00096040: 6164 6420 616e 2061 6464 6974 696f 6e61  add an additiona
-00096050: 6c20 6665 6174 7572 6520 7768 6963 6820  l feature which 
-00096060: 6973 2064 6572 6976 6564 2066 726f 6d20  is derived from 
-00096070: 7072 6564 6963 7469 6f6e 7320 6f66 2061  predictions of a
-00096080: 6e6f 7468 6572 206d 6f64 656c 2e20 5468  nother model. Th
-00096090: 6973 2069 7320 7573 6564 2069 6e20 736f  is is used in so
-000960a0: 6d65 2063 6173 6573 2062 7574 206d 6179  me cases but may
-000960b0: 2072 6573 756c 7420 696e 206f 7665 7266   result in overf
-000960c0: 6974 7469 6e67 2e20 536f 2062 6520 6361  itting. So be ca
-000960d0: 7265 6675 6c20 7475 726e 696e 6720 7468  reful turning th
-000960e0: 6973 2066 6c61 6720 226f 6e22 2e0a 2020  is flag "on"..  
-000960f0: 2020 2020 2020 2d20 6042 696e 6e69 6e67        - `Binning
-00096100: 5f46 6c61 6760 3a20 4465 6661 756c 7420  _Flag`: Default 
-00096110: 6973 2046 616c 7365 2e20 4974 2073 6574  is False. It set
-00096120: 2074 6f20 5472 7565 2c20 6974 2077 696c   to True, it wil
-00096130: 6c20 636f 6e76 6572 7420 7468 6520 746f  l convert the to
-00096140: 7020 6e75 6d65 7269 6320 7661 7269 6162  p numeric variab
-00096150: 6c65 7320 696e 746f 2062 696e 6e65 6420  les into binned 
-00096160: 7661 7269 6162 6c65 7320 7468 726f 7567  variables throug
-00096170: 6820 6120 7465 6368 6e69 7175 6520 6b6e  h a technique kn
-00096180: 6f77 6e20 6173 2022 456e 7472 6f70 7922  own as "Entropy"
-00096190: 2062 696e 6e69 6e67 2e20 5468 6973 2069   binning. This i
-000961a0: 7320 7665 7279 2068 656c 7066 756c 2066  s very helpful f
-000961b0: 6f72 2063 6572 7461 696e 2064 6174 6173  or certain datas
-000961c0: 6574 7320 2865 7370 6563 6961 6c6c 7920  ets (especially 
-000961d0: 6861 7264 2074 6f20 6275 696c 6420 6d6f  hard to build mo
-000961e0: 6465 6c73 292e 0a20 2020 2020 2020 202d  dels)..        -
-000961f0: 2060 496d 6261 6c61 6e63 6564 5f46 6c61   `Imbalanced_Fla
-00096200: 6760 3a20 4465 6661 756c 7420 6973 2046  g`: Default is F
-00096210: 616c 7365 2e20 5573 6573 2069 6d62 616c  alse. Uses imbal
-00096220: 616e 6365 645f 656e 7365 6d62 6c65 206c  anced_ensemble l
-00096230: 6962 7261 7279 2066 6f72 2069 6d62 616c  ibrary for imbal
-00096240: 616e 6365 6420 6461 7461 2e20 4a75 7374  anced data. Just
-00096250: 2073 6574 2049 6d62 616c 616e 6365 645f   set Imbalanced_
-00096260: 466c 6167 203d 2054 7275 6520 696e 2061  Flag = True in a
-00096270: 7267 756d 656e 7473 0a20 2020 2020 2020  rguments.       
-00096280: 202d 2060 7665 7262 6f73 6560 3a20 5468   - `verbose`: Th
-00096290: 6973 2068 6173 2033 2070 6f73 7369 626c  is has 3 possibl
-000962a0: 6520 7374 6174 6573 3a0a 2020 2020 2020  e states:.      
-000962b0: 2020 2020 2d20 6030 6020 6c69 6d69 7465      - `0` limite
-000962c0: 6420 6f75 7470 7574 2e20 4772 6561 7420  d output. Great 
-000962d0: 666f 7220 7275 6e6e 696e 6720 7468 6973  for running this
-000962e0: 2073 696c 656e 746c 7920 616e 6420 6765   silently and ge
-000962f0: 7474 696e 6720 6661 7374 2072 6573 756c  tting fast resul
-00096300: 7473 2e0a 2020 2020 2020 2020 2020 2d20  ts..          - 
-00096310: 6031 6020 6d6f 7265 2063 6861 7274 732e  `1` more charts.
-00096320: 2047 7265 6174 2066 6f72 206b 6e6f 7769   Great for knowi
-00096330: 6e67 2068 6f77 2072 6573 756c 7473 2077  ng how results w
-00096340: 6572 6520 616e 6420 6d61 6b69 6e67 2063  ere and making c
-00096350: 6861 6e67 6573 2074 6f20 666c 6167 7320  hanges to flags 
-00096360: 696e 2069 6e70 7574 2e0a 2020 2020 2020  in input..      
-00096370: 2020 2020 2d20 6032 6020 6c6f 7473 206f      - `2` lots o
-00096380: 6620 6368 6172 7473 2061 6e64 206f 7574  f charts and out
-00096390: 7075 742e 2047 7265 6174 2066 6f72 2072  put. Great for r
-000963a0: 6570 726f 6475 6369 6e67 2077 6861 7420  eproducing what 
-000963b0: 4175 746f 5f56 694d 4c20 646f 6573 206f  Auto_ViML does o
-000963c0: 6e20 796f 7572 206f 776e 2e0a 2020 2020  n your own..    
-000963d0: 2020 2020 0a20 2020 2020 2020 202a 2a52      .        **R
-000963e0: 6574 7572 6e20 7661 6c75 6573 2a2a 0a20  eturn values**. 
-000963f0: 2020 2020 2020 200a 2020 2020 2020 2020         .        
-00096400: 2d20 606d 6f64 656c 603a 2049 7420 7769  - `model`: It wi
-00096410: 6c6c 2072 6574 7572 6e20 796f 7572 2074  ll return your t
-00096420: 7261 696e 6564 206d 6f64 656c 0a20 2020  rained model.   
-00096430: 2020 2020 202d 2060 6665 6174 7572 6573       - `features
-00096440: 603a 2074 6865 2066 6577 6573 7420 6e75  `: the fewest nu
-00096450: 6d62 6572 206f 6620 6665 6174 7572 6573  mber of features
-00096460: 2069 6e20 796f 7572 206d 6f64 656c 2074   in your model t
-00096470: 6f20 6d61 6b65 2069 7420 7065 7266 6f72  o make it perfor
-00096480: 6d20 7765 6c6c 0a20 2020 2020 2020 202d  m well.        -
-00096490: 2060 7472 6169 6e5f 6d6f 6469 6669 6564   `train_modified
-000964a0: 603a 2074 6869 7320 6973 2074 6865 206d  `: this is the m
-000964b0: 6f64 6966 6965 6420 7472 6169 6e20 6461  odified train da
-000964c0: 7461 6672 616d 6520 6166 7465 7220 7265  taframe after re
-000964d0: 6d6f 7669 6e67 2061 6e64 2061 6464 696e  moving and addin
-000964e0: 6720 6665 6174 7572 6573 0a20 2020 2020  g features.     
-000964f0: 2020 202d 2060 7465 7374 5f6d 6f64 6966     - `test_modif
-00096500: 6965 6460 3a20 7468 6973 2069 7320 7468  ied`: this is th
-00096510: 6520 6d6f 6469 6669 6564 2074 6573 7420  e modified test 
-00096520: 6461 7461 6672 616d 6520 7769 7468 2074  dataframe with t
-00096530: 6865 2073 616d 6520 7472 616e 7366 6f72  he same transfor
-00096540: 6d61 7469 6f6e 7320 6173 2074 7261 696e  mations as train
-00096550: 0a20 2020 2020 2020 200a 2020 2020 2020  .        .      
-00096560: 2020 2323 204d 6169 6e74 6169 6e65 7273    ## Maintainers
-00096570: 0a20 2020 2020 2020 200a 2020 2020 2020  .        .      
-00096580: 2020 2a20 5b40 4175 746f 5669 4d4c 5d28    * [@AutoViML](
-00096590: 6874 7470 733a 2f2f 6769 7468 7562 2e63  https://github.c
-000965a0: 6f6d 2f41 7574 6f56 694d 4c29 0a20 2020  om/AutoViML).   
-000965b0: 2020 2020 202a 205b 406d 6f72 656e 6f68       * [@morenoh
-000965c0: 3134 395d 2868 7474 7073 3a2f 2f67 6974  149](https://git
-000965d0: 6875 622e 636f 6d2f 6d6f 7265 6e6f 6831  hub.com/morenoh1
-000965e0: 3439 290a 2020 2020 2020 2020 2a20 5b40  49).        * [@
-000965f0: 6869 726f 6e72 6f79 5d28 6874 7470 733a  hironroy](https:
-00096600: 2f2f 6769 7468 7562 2e63 6f6d 2f68 6972  //github.com/hir
-00096610: 6f6e 726f 7929 0a20 2020 2020 2020 200a  onroy).        .
-00096620: 2020 2020 2020 2020 2323 2043 6f6e 7472          ## Contr
-00096630: 6962 7574 696e 670a 2020 2020 2020 2020  ibuting.        
-00096640: 0a20 2020 2020 2020 2053 6565 205b 7468  .        See [th
-00096650: 6520 636f 6e74 7269 6275 7469 6e67 2066  e contributing f
-00096660: 696c 655d 2843 4f4e 5452 4942 5554 494e  ile](CONTRIBUTIN
-00096670: 472e 6d64 2921 0a20 2020 2020 2020 200a  G.md)!.        .
-00096680: 2020 2020 2020 2020 5052 7320 6163 6365          PRs acce
-00096690: 7074 6564 2e0a 2020 2020 2020 2020 0a20  pted..        . 
-000966a0: 2020 2020 2020 2023 2320 4c69 6365 6e73         ## Licens
-000966b0: 650a 2020 2020 2020 2020 0a20 2020 2020  e.        .     
-000966c0: 2020 2041 7061 6368 6520 4c69 6365 6e73     Apache Licens
-000966d0: 6520 322e 3020 c2a9 2032 3032 3020 5261  e 2.0 .. 2020 Ra
-000966e0: 6d20 5365 7368 6164 7269 0a20 2020 2020  m Seshadri.     
-000966f0: 2020 200a 2020 2020 2020 2020 2323 2044     .        ## D
-00096700: 4953 434c 4149 4d45 520a 2020 2020 2020  ISCLAIMER.      
-00096710: 2020 5468 6973 2070 726f 6a65 6374 2069    This project i
-00096720: 7320 6e6f 7420 616e 206f 6666 6963 6961  s not an officia
-00096730: 6c20 476f 6f67 6c65 2070 726f 6a65 6374  l Google project
-00096740: 2e20 4974 2069 7320 6e6f 7420 7375 7070  . It is not supp
-00096750: 6f72 7465 6420 6279 2047 6f6f 676c 6520  orted by Google 
-00096760: 616e 6420 476f 6f67 6c65 2073 7065 6369  and Google speci
-00096770: 6669 6361 6c6c 7920 6469 7363 6c61 696d  fically disclaim
-00096780: 7320 616c 6c20 7761 7272 616e 7469 6573  s all warranties
-00096790: 2061 7320 746f 2069 7473 2071 7561 6c69   as to its quali
-000967a0: 7479 2c20 6d65 7263 6861 6e74 6162 696c  ty, merchantabil
-000967b0: 6974 792c 206f 7220 6669 746e 6573 7320  ity, or fitness 
-000967c0: 666f 7220 6120 7061 7274 6963 756c 6172  for a particular
-000967d0: 2070 7572 706f 7365 2e0a 2020 2020 2020   purpose..      
-000967e0: 2020 0a50 6c61 7466 6f72 6d3a 2055 4e4b    .Platform: UNK
-000967f0: 4e4f 574e 0a43 6c61 7373 6966 6965 723a  NOWN.Classifier:
-00096800: 2050 726f 6772 616d 6d69 6e67 204c 616e   Programming Lan
-00096810: 6775 6167 6520 3a3a 2050 7974 686f 6e20  guage :: Python 
-00096820: 3a3a 2033 0a43 6c61 7373 6966 6965 723a  :: 3.Classifier:
-00096830: 204f 7065 7261 7469 6e67 2053 7973 7465   Operating Syste
-00096840: 6d20 3a3a 204f 5320 496e 6465 7065 6e64  m :: OS Independ
-00096850: 656e 740a 4465 7363 7269 7074 696f 6e2d  ent.Description-
-00096860: 436f 6e74 656e 742d 5479 7065 3a20 7465  Content-Type: te
-00096870: 7874 2f6d 6172 6b64 6f77 6e0a 0000 0000  xt/markdown.....
-00096880: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-00096890: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-000968a0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-000968b0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-000968c0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-000968d0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-000968e0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-000968f0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-00096900: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-00096910: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-00096920: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-00096930: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-00096940: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-00096950: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-00096960: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-00096970: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-00096980: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-00096990: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-000969a0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-000969b0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-000969c0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-000969d0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-000969e0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-000969f0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-00096a00: 2e2f 2e2f 4050 6178 4865 6164 6572 0000  ././@PaxHeader..
-00096a10: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-00096a20: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-00096a30: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-00096a40: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-00096a50: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-00096a60: 0000 0000 3030 3030 3030 3000 3030 3030  ....0000000.0000
-00096a70: 3030 3000 3030 3030 3030 3000 3030 3030  000.0000000.0000
-00096a80: 3030 3030 3032 3600 3030 3030 3030 3030  0000026.00000000
-00096a90: 3030 3000 3031 3134 3533 0020 7800 0000  000.011453. x...
-00096aa0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-00096ab0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-00096ac0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-00096ad0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-00096ae0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-00096af0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-00096b00: 0075 7374 6172 0030 3000 0000 0000 0000  .ustar.00.......
-00096b10: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-00096b20: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-00096b30: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-00096b40: 0000 0000 0000 0000 0030 3030 3030 3030  .........0000000
-00096b50: 0030 3030 3030 3030 0000 0000 0000 0000  .0000000........
-00096b60: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-00096b70: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-00096b80: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-00096b90: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-00096ba0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-00096bb0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-00096bc0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-00096bd0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-00096be0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-00096bf0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-00096c00: 3232 206d 7469 6d65 3d31 3638 3139 3033  22 mtime=1681903
-00096c10: 3937 372e 300a 0000 0000 0000 0000 0000  977.0...........
-00096c20: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-00096c30: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-00096c40: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-00096c50: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-00096c60: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-00096c70: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-00096c80: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-00096c90: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-00096ca0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-00096cb0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-00096cc0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-00096cd0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-00096ce0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-00096cf0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-00096d00: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-00096d10: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-00096d20: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-00096d30: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-00096d40: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-00096d50: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-00096d60: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-00096d70: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-00096d80: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-00096d90: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-00096da0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-00096db0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-00096dc0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-00096dd0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-00096de0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-00096df0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-00096e00: 6175 746f 7669 6d6c 2d30 2e31 2e37 3134  autoviml-0.1.714
-00096e10: 2f61 7574 6f76 696d 6c2e 6567 672d 696e  /autoviml.egg-in
-00096e20: 666f 2f53 4f55 5243 4553 2e74 7874 0000  fo/SOURCES.txt..
-00096e30: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-00096e40: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-00096e50: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-00096e60: 0000 0000 3030 3030 3737 3700 3030 3031  ....0000777.0001
-00096e70: 3735 3000 3030 3031 3735 3000 3030 3030  750.0001750.0000
-00096e80: 3030 3030 3737 3500 3030 3030 3030 3030  0000775.00000000
-00096e90: 3030 3000 3032 3033 3433 0020 3000 0000  000.020343. 0...
-00096ea0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-00096eb0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-00096ec0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-00096ed0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-00096ee0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-00096ef0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-00096f00: 0075 7374 6172 0030 3072 616d 0000 0000  .ustar.00ram....
-00096f10: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-00096f20: 0000 0000 0000 0000 0072 616d 0000 0000  .........ram....
-00096f30: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-00096f40: 0000 0000 0000 0000 0030 3030 3030 3030  .........0000000
-00096f50: 0030 3030 3030 3030 0000 0000 0000 0000  .0000000........
-00096f60: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-00096f70: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-00096f80: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-00096f90: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-00096fa0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-00096fb0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-00096fc0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-00096fd0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-00096fe0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-00096ff0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-00097000: 5245 4144 4d45 2e6d 640a 7365 7475 702e  README.md.setup.
-00097010: 6366 670a 7365 7475 702e 7079 0a61 7574  cfg.setup.py.aut
-00097020: 6f76 696d 6c2f 4175 746f 5f4e 4c50 2e70  oviml/Auto_NLP.p
-00097030: 790a 6175 746f 7669 6d6c 2f41 7574 6f5f  y.autoviml/Auto_
-00097040: 5669 4d4c 2e70 790a 6175 746f 7669 6d6c  ViML.py.autoviml
-00097050: 2f51 7569 636b 4d4c 5f45 6e73 656d 626c  /QuickML_Ensembl
-00097060: 696e 672e 7079 0a61 7574 6f76 696d 6c2f  ing.py.autoviml/
-00097070: 5175 6963 6b4d 4c5f 5374 6163 6b69 6e67  QuickML_Stacking
-00097080: 2e70 790a 6175 746f 7669 6d6c 2f54 7261  .py.autoviml/Tra
-00097090: 6e73 666f 726d 5f4b 4d5f 4665 6174 7572  nsform_KM_Featur
-000970a0: 6573 2e70 790a 6175 746f 7669 6d6c 2f5f  es.py.autoviml/_
-000970b0: 5f69 6e69 745f 5f2e 7079 0a61 7574 6f76  _init__.py.autov
-000970c0: 696d 6c2f 5f5f 7665 7273 696f 6e5f 5f2e  iml/__version__.
-000970d0: 7079 0a61 7574 6f76 696d 6c2f 636c 6173  py.autoviml/clas
-000970e0: 7369 6679 5f6d 6574 686f 642e 7079 0a61  sify_method.py.a
-000970f0: 7574 6f76 696d 6c2f 6375 7374 6f6d 5f73  utoviml/custom_s
-00097100: 636f 7265 732e 7079 0a61 7574 6f76 696d  cores.py.autovim
-00097110: 6c2f 6375 7374 6f6d 5f73 636f 7265 735f  l/custom_scores_
-00097120: 484f 2e70 790a 6175 746f 7669 6d6c 2f66  HO.py.autoviml/f
-00097130: 6561 7475 7265 5f65 6e67 696e 6565 7269  eature_engineeri
-00097140: 6e67 2e70 790a 6175 746f 7669 6d6c 2f73  ng.py.autoviml/s
-00097150: 756c 6f76 5f6d 6574 686f 642e 7079 0a61  ulov_method.py.a
-00097160: 7574 6f76 696d 6c2e 6567 672d 696e 666f  utoviml.egg-info
-00097170: 2f50 4b47 2d49 4e46 4f0a 6175 746f 7669  /PKG-INFO.autovi
-00097180: 6d6c 2e65 6767 2d69 6e66 6f2f 534f 5552  ml.egg-info/SOUR
-00097190: 4345 532e 7478 740a 6175 746f 7669 6d6c  CES.txt.autoviml
-000971a0: 2e65 6767 2d69 6e66 6f2f 6465 7065 6e64  .egg-info/depend
-000971b0: 656e 6379 5f6c 696e 6b73 2e74 7874 0a61  ency_links.txt.a
-000971c0: 7574 6f76 696d 6c2e 6567 672d 696e 666f  utoviml.egg-info
-000971d0: 2f72 6571 7569 7265 732e 7478 740a 6175  /requires.txt.au
-000971e0: 746f 7669 6d6c 2e65 6767 2d69 6e66 6f2f  toviml.egg-info/
-000971f0: 746f 705f 6c65 7665 6c2e 7478 7400 0000  top_level.txt...
+00092e00: 6175 746f 7669 6d6c 2d30 2e31 2e37 3135  autoviml-0.1.715
+00092e10: 2f61 7574 6f76 696d 6c2e 6567 672d 696e  /autoviml.egg-in
+00092e20: 666f 2f00 0000 0000 0000 0000 0000 0000  fo/.............
+00092e30: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+00092e40: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+00092e50: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+00092e60: 0000 0000 3030 3030 3737 3700 3030 3031  ....0000777.0001
+00092e70: 3735 3000 3030 3031 3735 3000 3030 3030  750.0001750.0000
+00092e80: 3030 3030 3030 3000 3030 3030 3030 3030  0000000.00000000
+00092e90: 3030 3000 3031 3634 3434 0020 3500 0000  000.016444. 5...
+00092ea0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+00092eb0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+00092ec0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+00092ed0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+00092ee0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+00092ef0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+00092f00: 0075 7374 6172 0030 3072 616d 0000 0000  .ustar.00ram....
+00092f10: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+00092f20: 0000 0000 0000 0000 0072 616d 0000 0000  .........ram....
+00092f30: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+00092f40: 0000 0000 0000 0000 0030 3030 3030 3030  .........0000000
+00092f50: 0030 3030 3030 3030 0000 0000 0000 0000  .0000000........
+00092f60: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+00092f70: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+00092f80: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+00092f90: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+00092fa0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+00092fb0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+00092fc0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+00092fd0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+00092fe0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+00092ff0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+00093000: 2e2f 2e2f 4050 6178 4865 6164 6572 0000  ././@PaxHeader..
+00093010: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+00093020: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+00093030: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+00093040: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+00093050: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+00093060: 0000 0000 3030 3030 3030 3000 3030 3030  ....0000000.0000
+00093070: 3030 3000 3030 3030 3030 3000 3030 3030  000.0000000.0000
+00093080: 3030 3030 3032 3600 3030 3030 3030 3030  0000026.00000000
+00093090: 3030 3000 3031 3134 3533 0020 7800 0000  000.011453. x...
+000930a0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+000930b0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+000930c0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+000930d0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+000930e0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+000930f0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+00093100: 0075 7374 6172 0030 3000 0000 0000 0000  .ustar.00.......
+00093110: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+00093120: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+00093130: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+00093140: 0000 0000 0000 0000 0030 3030 3030 3030  .........0000000
+00093150: 0030 3030 3030 3030 0000 0000 0000 0000  .0000000........
+00093160: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+00093170: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+00093180: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+00093190: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+000931a0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+000931b0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+000931c0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+000931d0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+000931e0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+000931f0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+00093200: 3232 206d 7469 6d65 3d31 3638 3433 3238  22 mtime=1684328
+00093210: 3631 342e 300a 0000 0000 0000 0000 0000  614.0...........
+00093220: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+00093230: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+00093240: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+00093250: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+00093260: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+00093270: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+00093280: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+00093290: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+000932a0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+000932b0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+000932c0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+000932d0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+000932e0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+000932f0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+00093300: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+00093310: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+00093320: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+00093330: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+00093340: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+00093350: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+00093360: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+00093370: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+00093380: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+00093390: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+000933a0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+000933b0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+000933c0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+000933d0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+000933e0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+000933f0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+00093400: 6175 746f 7669 6d6c 2d30 2e31 2e37 3135  autoviml-0.1.715
+00093410: 2f61 7574 6f76 696d 6c2e 6567 672d 696e  /autoviml.egg-in
+00093420: 666f 2f50 4b47 2d49 4e46 4f00 0000 0000  fo/PKG-INFO.....
+00093430: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+00093440: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+00093450: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+00093460: 0000 0000 3030 3030 3737 3700 3030 3031  ....0000777.0001
+00093470: 3735 3000 3030 3031 3735 3000 3030 3030  750.0001750.0000
+00093480: 3030 3335 3137 3400 3030 3030 3030 3030  0035174.00000000
+00093490: 3030 3000 3031 3735 3536 0020 3000 0000  000.017556. 0...
+000934a0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+000934b0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+000934c0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+000934d0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+000934e0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+000934f0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+00093500: 0075 7374 6172 0030 3072 616d 0000 0000  .ustar.00ram....
+00093510: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+00093520: 0000 0000 0000 0000 0072 616d 0000 0000  .........ram....
+00093530: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+00093540: 0000 0000 0000 0000 0030 3030 3030 3030  .........0000000
+00093550: 0030 3030 3030 3030 0000 0000 0000 0000  .0000000........
+00093560: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+00093570: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+00093580: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+00093590: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+000935a0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+000935b0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+000935c0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+000935d0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+000935e0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+000935f0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+00093600: 4d65 7461 6461 7461 2d56 6572 7369 6f6e  Metadata-Version
+00093610: 3a20 322e 310a 4e61 6d65 3a20 6175 746f  : 2.1.Name: auto
+00093620: 7669 6d6c 0a56 6572 7369 6f6e 3a20 302e  viml.Version: 0.
+00093630: 312e 3731 350a 5375 6d6d 6172 793a 2041  1.715.Summary: A
+00093640: 7574 6f6d 6174 6963 616c 6c79 2042 7569  utomatically Bui
+00093650: 6c64 2056 6172 6961 6e74 2049 6e74 6572  ld Variant Inter
+00093660: 7072 6574 6162 6c65 204d 4c20 6d6f 6465  pretable ML mode
+00093670: 6c73 2066 6173 7420 2d20 6e6f 7720 7769  ls fast - now wi
+00093680: 7468 2043 6174 426f 6f73 7421 0a48 6f6d  th CatBoost!.Hom
+00093690: 652d 7061 6765 3a20 6874 7470 733a 2f2f  e-page: https://
+000936a0: 6769 7468 7562 2e63 6f6d 2f41 7574 6f56  github.com/AutoV
+000936b0: 694d 4c2f 4175 746f 5f56 694d 4c0a 4175  iML/Auto_ViML.Au
+000936c0: 7468 6f72 3a20 5261 6d20 5365 7368 6164  thor: Ram Seshad
+000936d0: 7269 0a4c 6963 656e 7365 3a20 4170 6163  ri.License: Apac
+000936e0: 6865 204c 6963 656e 7365 2032 2e30 0a44  he License 2.0.D
+000936f0: 6573 6372 6970 7469 6f6e 3a20 2320 4175  escription: # Au
+00093700: 746f 2d56 694d 4c0a 2020 2020 2020 2020  to-ViML.        
+00093710: 0a20 2020 2020 2020 2021 5b62 616e 6e65  .        ![banne
+00093720: 725d 286c 6f67 6f2e 706e 6729 3c62 723e  r](logo.png)<br>
+00093730: 0a20 2020 2020 2020 2041 7574 6f6d 6174  .        Automat
+00093740: 6963 616c 6c79 2042 7569 6c64 2056 6172  ically Build Var
+00093750: 696f 7573 2049 6e74 6572 7072 6574 6162  ious Interpretab
+00093760: 6c65 204d 4c20 6d6f 6465 6c73 2066 6173  le ML models fas
+00093770: 7421 3c62 723e 0a20 2020 2020 2020 205b  t!<br>.        [
+00093780: 215b 446f 776e 6c6f 6164 735d 2868 7474  ![Downloads](htt
+00093790: 7073 3a2f 2f70 6570 792e 7465 6368 2f62  ps://pepy.tech/b
+000937a0: 6164 6765 2f61 7574 6f76 696d 6c2f 7765  adge/autoviml/we
+000937b0: 656b 295d 2868 7474 7073 3a2f 2f70 6570  ek)](https://pep
+000937c0: 792e 7465 6368 2f70 726f 6a65 6374 2f61  y.tech/project/a
+000937d0: 7574 6f76 696d 6c2f 7765 656b 290a 2020  utoviml/week).  
+000937e0: 2020 2020 2020 5b21 5b44 6f77 6e6c 6f61        [![Downloa
+000937f0: 6473 5d28 6874 7470 733a 2f2f 7065 7079  ds](https://pepy
+00093800: 2e74 6563 682f 6261 6467 652f 6175 746f  .tech/badge/auto
+00093810: 7669 6d6c 2f6d 6f6e 7468 295d 2868 7474  viml/month)](htt
+00093820: 7073 3a2f 2f70 6570 792e 7465 6368 2f70  ps://pepy.tech/p
+00093830: 726f 6a65 6374 2f61 7574 6f76 696d 6c2f  roject/autoviml/
+00093840: 6d6f 6e74 6829 0a20 2020 2020 2020 205b  month).        [
+00093850: 215b 446f 776e 6c6f 6164 735d 2868 7474  ![Downloads](htt
+00093860: 7073 3a2f 2f70 6570 792e 7465 6368 2f62  ps://pepy.tech/b
+00093870: 6164 6765 2f61 7574 6f76 696d 6c29 5d28  adge/autoviml)](
+00093880: 6874 7470 733a 2f2f 7065 7079 2e74 6563  https://pepy.tec
+00093890: 682f 7072 6f6a 6563 742f 6175 746f 7669  h/project/autovi
+000938a0: 6d6c 290a 2020 2020 2020 2020 5b21 5b73  ml).        [![s
+000938b0: 7461 6e64 6172 642d 7265 6164 6d65 2063  tandard-readme c
+000938c0: 6f6d 706c 6961 6e74 5d28 6874 7470 733a  ompliant](https:
+000938d0: 2f2f 696d 672e 7368 6965 6c64 732e 696f  //img.shields.io
+000938e0: 2f62 6164 6765 2f73 7461 6e64 6172 642d  /badge/standard-
+000938f0: 2d72 6561 646d 652d 4f4b 2d67 7265 656e  -readme-OK-green
+00093900: 2e73 7667 3f73 7479 6c65 3d66 6c61 742d  .svg?style=flat-
+00093910: 7371 7561 7265 295d 2868 7474 7073 3a2f  square)](https:/
+00093920: 2f67 6974 6875 622e 636f 6d2f 5269 6368  /github.com/Rich
+00093930: 6172 644c 6974 742f 7374 616e 6461 7264  ardLitt/standard
+00093940: 2d72 6561 646d 6529 0a20 2020 2020 2020  -readme).       
+00093950: 205b 215b 5079 7468 6f6e 2056 6572 7369   [![Python Versi
+00093960: 6f6e 735d 2868 7474 7073 3a2f 2f69 6d67  ons](https://img
+00093970: 2e73 6869 656c 6473 2e69 6f2f 7079 7069  .shields.io/pypi
+00093980: 2f70 7976 6572 7369 6f6e 732f 6175 746f  /pyversions/auto
+00093990: 7669 6d6c 2e73 7667 3f6c 6f67 6f3d 7079  viml.svg?logo=py
+000939a0: 7468 6f6e 266c 6f67 6f43 6f6c 6f72 3d77  thon&logoColor=w
+000939b0: 6869 7465 295d 2868 7474 7073 3a2f 2f70  hite)](https://p
+000939c0: 7970 692e 6f72 672f 7072 6f6a 6563 742f  ypi.org/project/
+000939d0: 6175 746f 7669 6d6c 290a 2020 2020 2020  autoviml).      
+000939e0: 2020 5b21 5b50 7950 4920 5665 7273 696f    [![PyPI Versio
+000939f0: 6e5d 2868 7474 7073 3a2f 2f69 6d67 2e73  n](https://img.s
+00093a00: 6869 656c 6473 2e69 6f2f 7079 7069 2f76  hields.io/pypi/v
+00093a10: 2f61 7574 6f76 696d 6c2e 7376 673f 6c6f  /autoviml.svg?lo
+00093a20: 676f 3d70 7970 6926 6c6f 676f 436f 6c6f  go=pypi&logoColo
+00093a30: 723d 7768 6974 6529 5d28 6874 7470 733a  r=white)](https:
+00093a40: 2f2f 7079 7069 2e6f 7267 2f70 726f 6a65  //pypi.org/proje
+00093a50: 6374 2f61 7574 6f76 696d 6c29 0a20 2020  ct/autoviml).   
+00093a60: 2020 2020 205b 215b 5079 5049 204c 6963       [![PyPI Lic
+00093a70: 656e 7365 5d28 6874 7470 733a 2f2f 696d  ense](https://im
+00093a80: 672e 7368 6965 6c64 732e 696f 2f70 7970  g.shields.io/pyp
+00093a90: 692f 6c2f 6175 746f 7669 6d6c 2e73 7667  i/l/autoviml.svg
+00093aa0: 295d 2868 7474 7073 3a2f 2f67 6974 6875  )](https://githu
+00093ab0: 622e 636f 6d2f 4175 746f 5669 4d4c 2f41  b.com/AutoViML/A
+00093ac0: 7574 6f5f 5669 4d4c 2f62 6c6f 622f 6d61  uto_ViML/blob/ma
+00093ad0: 7374 6572 2f4c 4943 454e 5345 290a 2020  ster/LICENSE).  
+00093ae0: 2020 2020 2020 0a20 2020 2020 2020 2041        .        A
+00093af0: 7574 6f5f 5669 4d4c 2069 7320 7072 6f6e  uto_ViML is pron
+00093b00: 6f75 6e63 6564 2061 7320 2261 7574 6f20  ounced as "auto 
+00093b10: 7669 6d61 6c22 2028 6175 746f 7669 6d61  vimal" (autovima
+00093b20: 6c20 6c6f 676f 2063 7265 6174 6564 2062  l logo created b
+00093b30: 7920 5361 6e6b 6574 2047 6861 6e6d 6172  y Sanket Ghanmar
+00093b40: 6529 2e0a 2020 2020 2020 2020 0a20 2020  e)..        .   
+00093b50: 2020 2020 2023 2320 5570 6461 7465 2028       ## Update (
+00093b60: 4d61 7263 6820 3230 3233 290a 2020 2020  March 2023).    
+00093b70: 2020 2020 3c6f 6c3e 0a20 2020 2020 2020      <ol>.       
+00093b80: 203c 6c69 3e3c 623e 4175 746f 5f56 694d   <li><b>Auto_ViM
+00093b90: 4c20 6861 7320 6120 6e65 7720 666c 6167  L has a new flag
+00093ba0: 2074 6f20 7370 6565 6420 7570 2070 726f   to speed up pro
+00093bb0: 6365 7373 696e 6720 7573 696e 6720 4750  cessing using GP
+00093bc0: 5527 733c 2f62 3e2e 204a 7573 7420 7365  U's</b>. Just se
+00093bd0: 7420 7468 6520 6047 5055 5f66 6c61 6760  t the `GPU_flag`
+00093be0: 3d60 5472 7565 6020 6f6e 2043 6f6c 6162  =`True` on Colab
+00093bf0: 2061 6e64 206f 7468 6572 2065 6e76 6972   and other envir
+00093c00: 6f6e 6d65 6e74 732e 2042 7574 2064 6f6e  onments. But don
+00093c10: 2774 2066 6f72 6765 7420 746f 2073 6574  't forget to set
+00093c20: 2074 6865 2072 756e 7469 6d65 2074 7970   the runtime typ
+00093c30: 6520 746f 2062 6520 2247 5055 2220 7768  e to be "GPU" wh
+00093c40: 696c 6520 7275 6e6e 696e 6720 6f6e 2043  ile running on C
+00093c50: 6f6c 6162 2e20 4f74 6865 7277 6973 6520  olab. Otherwise 
+00093c60: 796f 7520 7769 6c6c 2067 6574 2061 6e20  you will get an 
+00093c70: 6572 726f 722e 3c2f 6c69 3e0a 2020 2020  error.</li>.    
+00093c80: 2020 2020 3c2f 6f6c 3e0a 2020 2020 2020      </ol>.      
+00093c90: 2020 0a20 2020 2020 2020 2023 2320 5570    .        ## Up
+00093ca0: 6461 7465 2028 4d61 7920 3230 3232 290a  date (May 2022).
+00093cb0: 2020 2020 2020 2020 3c6f 6c3e 0a20 2020          <ol>.   
+00093cc0: 2020 2020 203c 6c69 3e3c 623e 4175 746f       <li><b>Auto
+00093cd0: 5f56 694d 4c20 6173 206f 6620 7665 7273  _ViML as of vers
+00093ce0: 696f 6e20 302e 312e 3731 3020 7573 6573  ion 0.1.710 uses
+00093cf0: 2061 2076 6572 7920 6869 6768 2070 6572   a very high per
+00093d00: 666f 726d 616e 6365 206c 6962 7261 7279  formance library
+00093d10: 2063 616c 6c65 6420 6069 6d62 616c 616e   called `imbalan
+00093d20: 6365 645f 656e 7365 6d62 6c65 6020 666f  ced_ensemble` fo
+00093d30: 7220 496d 6261 6c61 6e63 6564 2064 6174  r Imbalanced dat
+00093d40: 6173 6574 2070 726f 626c 656d 732e 3c2f  aset problems.</
+00093d50: 623e 2049 7420 7769 6c6c 2070 726f 6475  b> It will produ
+00093d60: 6365 2061 2035 2d31 3025 2062 6f6f 7374  ce a 5-10% boost
+00093d70: 2069 6e20 796f 7572 2062 616c 616e 6365   in your balance
+00093d80: 645f 6163 6375 7261 6379 2062 6173 6564  d_accuracy based
+00093d90: 206f 6e20 6d79 2065 7870 6572 6965 6e63   on my experienc
+00093da0: 6520 7769 7468 2020 6d61 6e79 2064 6174  e with  many dat
+00093db0: 6173 6574 7320 4920 6861 7665 2074 7269  asets I have tri
+00093dc0: 6564 2e3c 2f6c 693e 0a20 2020 2020 2020  ed.</li>.       
+00093dd0: 203c 6272 3e0a 2020 2020 2020 2020 3c70   <br>.        <p
+00093de0: 3e49 6e20 6164 6469 7469 6f6e 2c20 6e65  >In addition, ne
+00093df0: 7720 6665 6174 7572 6573 2069 6e20 7468  w features in th
+00093e00: 6973 2076 6572 7369 6f6e 2061 7265 3a3c  is version are:<
+00093e10: 6272 3e0a 2020 2020 2020 2020 3c75 6c3e  br>.        <ul>
+00093e20: 0a20 2020 2020 2020 203c 6c69 3e53 554c  .        <li>SUL
+00093e30: 4f56 202d 3e20 5573 6573 2074 6865 2053  OV -> Uses the S
+00093e40: 554c 4f56 2061 6c67 6f72 6974 686d 2066  ULOV algorithm f
+00093e50: 6f72 2072 656d 6f76 696e 6720 6869 6768  or removing high
+00093e60: 6c79 2063 6f72 7265 6c61 7465 6420 6665  ly correlated fe
+00093e70: 6174 7572 6573 2061 7574 6f6d 6174 6963  atures automatic
+00093e80: 616c 6c79 2e3c 2f6c 693e 0a20 2020 2020  ally.</li>.     
+00093e90: 2020 203c 6c69 3e41 7574 6f5f 4e4c 5020     <li>Auto_NLP 
+00093ea0: 2d3e 2041 7574 6f56 694d 4c20 6175 746f  -> AutoViML auto
+00093eb0: 6d61 7469 6361 6c6c 7920 6465 7465 6374  matically detect
+00093ec0: 7320 5465 7874 2076 6172 6961 626c 6573  s Text variables
+00093ed0: 2061 6e64 2064 6f65 7320 4e4c 5020 7072   and does NLP pr
+00093ee0: 6f63 6573 7369 6e67 2075 7369 6e67 2041  ocessing using A
+00093ef0: 7574 6f5f 4e4c 503c 2f6c 693e 0a20 2020  uto_NLP</li>.   
+00093f00: 2020 2020 203c 6c69 3e44 6174 6520 5469       <li>Date Ti
+00093f10: 6d65 202d 3e20 4974 2061 7574 6f6d 6174  me -> It automat
+00093f20: 6963 616c 6c79 2064 6574 6563 7473 2020  ically detects  
+00093f30: 6461 7465 2074 696d 6520 7661 7269 6162  date time variab
+00093f40: 6c65 7320 616e 6420 6765 6e65 7261 7465  les and generate
+00093f50: 7320 6e65 7720 6665 6174 7572 6573 3c2f  s new features</
+00093f60: 6c69 3e0a 2020 2020 2020 2020 3c6c 693e  li>.        <li>
+00093f70: 6069 6d62 616c 616e 6365 645f 656e 7365  `imbalanced_ense
+00093f80: 6d62 6c65 6020 6c69 6272 6172 7920 2d3e  mble` library ->
+00093f90: 2055 7365 7320 696d 6261 6c61 6e63 6564   Uses imbalanced
+00093fa0: 5f65 6e73 656d 626c 6520 6c69 6272 6172  _ensemble librar
+00093fb0: 7920 666f 7220 696d 6261 6c61 6e63 6564  y for imbalanced
+00093fc0: 2064 6174 612e 204a 7573 7420 7365 7420   data. Just set 
+00093fd0: 496d 6261 6c61 6e63 6564 5f46 6c61 6720  Imbalanced_Flag 
+00093fe0: 3d20 5472 7565 2069 6e20 6172 6775 6d65  = True in argume
+00093ff0: 6e74 733c 2f6c 693e 0a20 2020 2020 2020  nts</li>.       
+00094000: 203c 6c69 3e46 6561 7475 7265 2053 656c   <li>Feature Sel
+00094010: 6563 7469 6f6e 202d 3e20 5765 2075 7365  ection -> We use
+00094020: 2074 6865 2073 616d 6520 616c 676f 7269   the same algori
+00094030: 7468 6d20 7468 6174 2066 6561 7475 7265  thm that feature
+00094040: 7769 7a20 6c69 6272 6172 7920 7573 6573  wiz library uses
+00094050: 3a20 5355 4c4f 5620 616e 6420 5265 6375  : SULOV and Recu
+00094060: 7273 6976 6520 5847 426f 6f73 7420 746f  rsive XGBoost to
+00094070: 2073 656c 6563 7420 6265 7374 2066 6561   select best fea
+00094080: 7475 7265 7320 6661 7374 2e20 5365 6520  tures fast. See 
+00094090: 6265 6c6f 772e 3c2f 6c69 3e0a 2020 2020  below.</li>.    
+000940a0: 2020 2020 3c2f 756c 3e0a 2020 2020 2020      </ul>.      
+000940b0: 2020 0a20 2020 2020 2020 2023 2320 5461    .        ## Ta
+000940c0: 626c 6520 6f66 2043 6f6e 7465 6e74 730a  ble of Contents.
+000940d0: 2020 2020 2020 2020 3c75 6c3e 0a20 2020          <ul>.   
+000940e0: 2020 2020 203c 6c69 3e3c 6120 6872 6566       <li><a href
+000940f0: 3d22 2362 6163 6b67 726f 756e 6422 3e42  ="#background">B
+00094100: 6163 6b67 726f 756e 643c 2f61 3e3c 2f6c  ackground</a></l
+00094110: 693e 0a20 2020 2020 2020 203c 6c69 3e3c  i>.        <li><
+00094120: 6120 6872 6566 3d22 2369 6e73 7461 6c6c  a href="#install
+00094130: 223e 496e 7374 616c 6c3c 2f61 3e3c 2f6c  ">Install</a></l
+00094140: 693e 0a20 2020 2020 2020 203c 6c69 3e3c  i>.        <li><
+00094150: 6120 6872 6566 3d22 2375 7361 6765 223e  a href="#usage">
+00094160: 5573 6167 653c 2f61 3e3c 2f6c 693e 0a20  Usage</a></li>. 
+00094170: 2020 2020 2020 203c 6c69 3e3c 6120 6872         <li><a hr
+00094180: 6566 3d22 2374 6970 732d 666f 722d 7573  ef="#tips-for-us
+00094190: 696e 672d 6175 746f 5f76 696d 6c22 3e54  ing-auto_viml">T
+000941a0: 6970 7320 666f 7220 7573 696e 6720 4175  ips for using Au
+000941b0: 746f 5f56 694d 4c3c 2f61 3e3c 2f6c 693e  to_ViML</a></li>
+000941c0: 0a20 2020 2020 2020 203c 6c69 3e3c 6120  .        <li><a 
+000941d0: 6872 6566 3d22 2361 7069 223e 4150 493c  href="#api">API<
+000941e0: 2f61 3e3c 2f6c 693e 0a20 2020 2020 2020  /a></li>.       
+000941f0: 203c 6c69 3e3c 6120 6872 6566 3d22 236d   <li><a href="#m
+00094200: 6169 6e74 6169 6e65 7273 223e 4d61 696e  aintainers">Main
+00094210: 7461 696e 6572 733c 2f61 3e3c 2f6c 693e  tainers</a></li>
+00094220: 0a20 2020 2020 2020 203c 6c69 3e3c 6120  .        <li><a 
+00094230: 6872 6566 3d22 2363 6f6e 7472 6962 7574  href="#contribut
+00094240: 696e 6722 3e43 6f6e 7472 6962 7574 696e  ing">Contributin
+00094250: 673c 2f61 3e3c 2f6c 693e 0a20 2020 2020  g</a></li>.     
+00094260: 2020 203c 6c69 3e3c 6120 6872 6566 3d22     <li><a href="
+00094270: 236c 6963 656e 7365 223e 4c69 6365 6e73  #license">Licens
+00094280: 653c 2f61 3e3c 2f6c 693e 0a20 2020 2020  e</a></li>.     
+00094290: 2020 203c 2f75 6c3e 0a20 2020 2020 2020     </ul>.       
+000942a0: 200a 2020 2020 2020 2020 2323 2042 6163   .        ## Bac
+000942b0: 6b67 726f 756e 640a 2020 2020 2020 2020  kground.        
+000942c0: 3c70 3e52 6561 6420 7468 6973 203c 6120  <p>Read this <a 
+000942d0: 6872 6566 3d22 6874 7470 733a 2f2f 746f  href="https://to
+000942e0: 7761 7264 7364 6174 6173 6369 656e 6365  wardsdatascience
+000942f0: 2e63 6f6d 2f77 6879 2d61 7574 6f6d 6c2d  .com/why-automl-
+00094300: 6973 2d61 6e2d 6573 7365 6e74 6961 6c2d  is-an-essential-
+00094310: 6e65 772d 746f 6f6c 2d66 6f72 2d64 6174  new-tool-for-dat
+00094320: 612d 7363 6965 6e74 6973 7473 2d32 6439  a-scientists-2d9
+00094330: 6162 3465 3235 6534 3622 3e4d 6564 6975  ab4e25e46">Mediu
+00094340: 6d20 6172 7469 636c 6520 746f 206c 6561  m article to lea
+00094350: 726e 2068 6f77 2074 6f20 7573 6520 4175  rn how to use Au
+00094360: 746f 5f56 694d 4c20 6566 6665 6374 6976  to_ViML effectiv
+00094370: 656c 792e 3c2f 613e 0a20 2020 2020 2020  ely.</a>.       
+00094380: 200a 2020 2020 2020 2020 3c70 3e41 7574   .        <p>Aut
+00094390: 6f5f 5669 4d4c 2077 6173 2064 6573 6967  o_ViML was desig
+000943a0: 6e65 6420 666f 7220 6275 696c 6469 6e67  ned for building
+000943b0: 2048 6967 6820 5065 7266 6f72 6d61 6e63   High Performanc
+000943c0: 6520 496e 7465 7270 7265 7461 626c 6520  e Interpretable 
+000943d0: 4d6f 6465 6c73 2077 6974 6820 7468 6520  Models with the 
+000943e0: 6665 7765 7374 2076 6172 6961 626c 6573  fewest variables
+000943f0: 206e 6565 6465 642e 0a20 2020 2020 2020   needed..       
+00094400: 2054 6865 2022 5622 2069 6e20 4175 746f   The "V" in Auto
+00094410: 5f56 694d 4c20 7374 616e 6473 2066 6f72  _ViML stands for
+00094420: 2056 6172 6961 6e74 2062 6563 6175 7365   Variant because
+00094430: 2069 7420 7472 6965 7320 6d75 6c74 6970   it tries multip
+00094440: 6c65 206d 6f64 656c 7320 7769 7468 206d  le models with m
+00094450: 756c 7469 706c 6520 6665 6174 7572 6573  ultiple features
+00094460: 2074 6f20 6669 6e64 2079 6f75 2074 6865   to find you the
+00094470: 2062 6573 7420 7065 7266 6f72 6d69 6e67   best performing
+00094480: 206d 6f64 656c 2066 6f72 2079 6f75 7220   model for your 
+00094490: 6461 7461 7365 742e 2054 6865 2022 6922  dataset. The "i"
+000944a0: 2069 6e20 4175 746f 5f56 694d 4c20 7374   in Auto_ViML st
+000944b0: 616e 6473 2066 6f72 2022 696e 7465 7270  ands for "interp
+000944c0: 7265 7461 626c 6522 2073 696e 6365 2041  retable" since A
+000944d0: 7574 6f5f 5669 4d4c 2073 656c 6563 7473  uto_ViML selects
+000944e0: 2074 6865 206c 6561 7374 206e 756d 6265   the least numbe
+000944f0: 7220 6f66 2066 6561 7475 7265 7320 6e65  r of features ne
+00094500: 6365 7373 6172 7920 746f 2062 7569 6c64  cessary to build
+00094510: 2061 2073 696d 706c 6572 2c20 6d6f 7265   a simpler, more
+00094520: 2069 6e74 6572 7072 6574 6162 6c65 206d   interpretable m
+00094530: 6f64 656c 2e20 496e 206d 6f73 7420 6361  odel. In most ca
+00094540: 7365 732c 2041 7574 6f5f 5669 4d4c 2062  ses, Auto_ViML b
+00094550: 7569 6c64 7320 6d6f 6465 6c73 2077 6974  uilds models wit
+00094560: 6820 3230 252d 3939 2520 6665 7765 7220  h 20%-99% fewer 
+00094570: 6665 6174 7572 6573 2074 6861 6e20 6120  features than a 
+00094580: 7369 6d69 6c61 7220 7065 7266 6f72 6d69  similar performi
+00094590: 6e67 206d 6f64 656c 2077 6974 6820 616c  ng model with al
+000945a0: 6c20 696e 636c 7564 6564 2066 6561 7475  l included featu
+000945b0: 7265 7320 2874 6869 7320 6973 2062 6173  res (this is bas
+000945c0: 6564 206f 6e20 6d79 2074 7269 616c 732e  ed on my trials.
+000945d0: 2059 6f75 7220 6578 7065 7269 656e 6365   Your experience
+000945e0: 206d 6179 2076 6172 7929 2e3c 6272 3e0a   may vary).<br>.
+000945f0: 2020 2020 2020 2020 3c70 3e0a 2020 2020          <p>.    
+00094600: 2020 2020 4175 746f 5f56 694d 4c20 6973      Auto_ViML is
+00094610: 2065 7665 7279 2044 6174 6120 5363 6965   every Data Scie
+00094620: 6e74 6973 7427 7320 6d6f 6465 6c20 6163  ntist's model ac
+00094630: 6365 6c65 7261 746f 7220 746f 6f6c 2074  celerator tool t
+00094640: 6861 743a 3c6f 6c3e 0a20 2020 2020 2020  hat:<ol>.       
+00094650: 203c 6c69 3e3c 623e 4865 6c70 7320 796f   <li><b>Helps yo
+00094660: 7520 7769 7468 2064 6174 6120 636c 6561  u with data clea
+00094670: 6e69 6e67 3c2f 623e 3a20 796f 7520 6361  ning</b>: you ca
+00094680: 6e20 7365 6e64 2069 6e20 796f 7572 2065  n send in your e
+00094690: 6e74 6972 6520 6461 7461 6672 616d 6520  ntire dataframe 
+000946a0: 6173 2069 7320 616e 6420 4175 746f 5f56  as is and Auto_V
+000946b0: 694d 4c20 7769 6c6c 2073 7567 6765 7374  iML will suggest
+000946c0: 2063 6861 6e67 6573 2074 6f20 6865 6c70   changes to help
+000946d0: 2077 6974 6820 6d69 7373 696e 6720 7661   with missing va
+000946e0: 6c75 6573 2c20 666f 726d 6174 7469 6e67  lues, formatting
+000946f0: 2076 6172 6961 626c 6573 2c20 6164 6469   variables, addi
+00094700: 6e67 2076 6172 6961 626c 6573 2c20 6574  ng variables, et
+00094710: 632e 2049 7420 6c6f 7665 7320 6469 7274  c. It loves dirt
+00094720: 7920 6461 7461 2e20 5468 6520 6469 7274  y data. The dirt
+00094730: 6965 7220 7468 6520 6265 7474 6572 213c  ier the better!<
+00094740: 6272 3e0a 2020 2020 2020 2020 3c6c 693e  br>.        <li>
+00094750: 3c62 3e50 6572 666f 726d 7320 4665 6174  <b>Performs Feat
+00094760: 7572 6520 5365 6c65 6374 696f 6e3c 2f62  ure Selection</b
+00094770: 3e3a 2041 7574 6f5f 5669 4d4c 2073 656c  >: Auto_ViML sel
+00094780: 6563 7473 2076 6172 6961 626c 6573 2061  ects variables a
+00094790: 7574 6f6d 6174 6963 616c 6c79 2062 7920  utomatically by 
+000947a0: 6465 6661 756c 742e 2054 6869 7320 6973  default. This is
+000947b0: 2076 6572 7920 6865 6c70 6675 6c20 7768   very helpful wh
+000947c0: 656e 2079 6f75 2068 6176 6520 6875 6e64  en you have hund
+000947d0: 7265 6473 2069 6620 6e6f 7420 7468 6f75  reds if not thou
+000947e0: 7361 6e64 7320 6f66 2076 6172 6961 626c  sands of variabl
+000947f0: 6573 2073 696e 6365 2069 7420 6361 6e20  es since it can 
+00094800: 7265 6164 696c 7920 6964 656e 7469 6679  readily identify
+00094810: 2077 6869 6368 206f 6620 7468 6f73 6520   which of those 
+00094820: 6172 6520 696d 706f 7274 616e 7420 7661  are important va
+00094830: 7269 6162 6c65 7320 7673 2077 6869 6368  riables vs which
+00094840: 2061 7265 2075 6e6e 6563 6573 7361 7279   are unnecessary
+00094850: 2e20 596f 7520 6361 6e20 7475 726e 2074  . You can turn t
+00094860: 6869 7320 6f66 6620 6173 2077 656c 6c20  his off as well 
+00094870: 2873 6565 2041 5049 292e 3c62 723e 0a20  (see API).<br>. 
+00094880: 2020 2020 2020 200a 2020 2020 2020 2020         .        
+00094890: 215b 7867 626f 6f73 745d 2873 756c 6f76  ![xgboost](sulov
+000948a0: 5f78 6762 6f6f 7374 2e70 6e67 290a 2020  _xgboost.png).  
+000948b0: 2020 2020 2020 3c6c 693e 3c62 3e52 656d        <li><b>Rem
+000948c0: 6f76 6573 2068 6967 686c 7920 636f 7272  oves highly corr
+000948d0: 656c 6174 6564 2066 6561 7475 7265 7320  elated features 
+000948e0: 6175 746f 6d61 7469 6361 6c6c 793c 2f62  automatically</b
+000948f0: 3e2e 2049 6620 7477 6f20 7661 7269 6162  >. If two variab
+00094900: 6c65 7320 6172 6520 6869 6768 6c79 2063  les are highly c
+00094910: 6f72 7265 6c61 7465 6420 696e 2079 6f75  orrelated in you
+00094920: 7220 6461 7461 7365 742c 2077 6869 6368  r dataset, which
+00094930: 206f 6e65 2073 686f 756c 6420 796f 7520   one should you 
+00094940: 7265 6d6f 7665 2061 6e64 2077 6869 6368  remove and which
+00094950: 206f 6e65 2073 686f 756c 6420 796f 7520   one should you 
+00094960: 6b65 6570 3f20 5468 6520 6465 6369 7369  keep? The decisi
+00094970: 6f6e 2069 7320 6e6f 7420 6173 2065 6173  on is not as eas
+00094980: 7920 6173 2069 7420 6c6f 6f6b 732e 2041  y as it looks. A
+00094990: 7574 6f5f 5669 4d4c 2075 7365 7320 7468  uto_ViML uses th
+000949a0: 6520 5355 4c4f 5620 616c 676f 7269 7468  e SULOV algorith
+000949b0: 6d20 746f 2072 656d 6f76 6520 6869 6768  m to remove high
+000949c0: 6c79 2063 6f72 7265 6c61 7465 6420 6665  ly correlated fe
+000949d0: 6174 7572 6573 2e20 596f 7520 6361 6e20  atures. You can 
+000949e0: 756e 6465 7273 7461 6e64 2053 554c 4f56  understand SULOV
+000949f0: 2066 726f 6d20 7468 6973 2070 6963 7475   from this pictu
+00094a00: 7265 206d 6f72 6520 696e 7475 6974 6976  re more intuitiv
+00094a10: 656c 792e 3c62 723e 0a20 2020 2020 2020  ely.<br>.       
+00094a20: 200a 2020 2020 2020 2020 215b 7375 6c6f   .        ![sulo
+00094a30: 765d 2853 554c 4f56 2e6a 7067 290a 2020  v](SULOV.jpg).  
+00094a40: 2020 2020 2020 0a20 2020 2020 2020 203c        .        <
+00094a50: 6c69 3e3c 623e 4765 6e65 7261 7465 7320  li><b>Generates 
+00094a60: 7065 7266 6f72 6d61 6e63 6520 7265 7375  performance resu
+00094a70: 6c74 7320 6772 6170 6869 6361 6c6c 793c  lts graphically<
+00094a80: 2f62 3e2e 204a 7573 7420 7365 7420 7665  /b>. Just set ve
+00094a90: 7262 6f73 6520 3d20 3120 286f 7229 2032  rbose = 1 (or) 2
+00094aa0: 2069 6e73 7465 6164 206f 6620 3020 2873   instead of 0 (s
+00094ab0: 696c 656e 7429 2e20 596f 7520 7769 6c6c  ilent). You will
+00094ac0: 2067 6574 2068 6967 6865 7220 7175 616c   get higher qual
+00094ad0: 6974 7920 6f66 2069 6e73 6967 6874 7320  ity of insights 
+00094ae0: 6173 2079 6f75 2069 6e63 7265 6173 6520  as you increase 
+00094af0: 7665 7262 6f73 6974 792e 203c 6272 3e0a  verbosity. <br>.
+00094b00: 2020 2020 2020 2020 3c6c 693e 3c62 3e48          <li><b>H
+00094b10: 616e 646c 6573 2074 6578 742c 2064 6174  andles text, dat
+00094b20: 652d 7469 6d65 2c20 7374 7275 6374 7320  e-time, structs 
+00094b30: 286c 6973 7473 2c20 6469 6374 696f 6e61  (lists, dictiona
+00094b40: 7269 6573 292c 206e 756d 6572 6963 2c20  ries), numeric, 
+00094b50: 626f 6f6c 6561 6e2c 2066 6163 746f 7220  boolean, factor 
+00094b60: 616e 6420 6361 7465 676f 7269 6361 6c3c  and categorical<
+00094b70: 2f62 3e20 7661 7269 6162 6c65 7320 616c  /b> variables al
+00094b80: 6c20 696e 206f 6e65 206d 6f64 656c 2075  l in one model u
+00094b90: 7369 6e67 206f 6e65 2073 7472 6169 6768  sing one straigh
+00094ba0: 7420 7072 6f63 6573 732e 3c62 723e 0a20  t process.<br>. 
+00094bb0: 2020 2020 2020 203c 2f6f 6c3e 0a20 2020         </ol>.   
+00094bc0: 2020 2020 2041 7574 6f5f 5669 4d4c 2069       Auto_ViML i
+00094bd0: 7320 6275 696c 7420 7573 696e 6720 7363  s built using sc
+00094be0: 696b 6974 2d6c 6561 726e 2c20 6e75 6d70  ikit-learn, nump
+00094bf0: 792c 2070 616e 6461 7320 616e 6420 6d61  y, pandas and ma
+00094c00: 7470 6c6f 746c 6962 2e20 4974 2073 686f  tplotlib. It sho
+00094c10: 756c 6420 7275 6e20 6f6e 206d 6f73 7420  uld run on most 
+00094c20: 5079 7468 6f6e 2033 2041 6e61 636f 6e64  Python 3 Anacond
+00094c30: 6120 696e 7374 616c 6c61 7469 6f6e 732e  a installations.
+00094c40: 2059 6f75 2077 6f6e 2774 2068 6176 6520   You won't have 
+00094c50: 746f 2069 6d70 6f72 7420 616e 7920 7370  to import any sp
+00094c60: 6563 6961 6c20 6c69 6272 6172 6965 7320  ecial libraries 
+00094c70: 6f74 6865 7220 7468 616e 2022 5847 426f  other than "XGBo
+00094c80: 6f73 7422 2c20 2249 6d62 616c 616e 6365  ost", "Imbalance
+00094c90: 642d 4c65 6172 6e22 2c20 2243 6174 426f  d-Learn", "CatBo
+00094ca0: 6f73 7422 2c20 616e 6420 2266 6561 7475  ost", and "featu
+00094cb0: 7265 746f 6f6c 7322 206c 6962 7261 7279  retools" library
+00094cc0: 2e20 5765 2075 7365 2022 5348 4150 2220  . We use "SHAP" 
+00094cd0: 6c69 6272 6172 7920 666f 7220 696e 7465  library for inte
+00094ce0: 7270 7265 7461 6269 6c69 7479 2e20 3c62  rpretability. <b
+00094cf0: 723e 4275 7420 6966 2079 6f75 2064 6f6e  r>But if you don
+00094d00: 2774 2068 6176 6520 7468 6573 6520 6c69  't have these li
+00094d10: 6272 6172 6965 732c 2041 7574 6f5f 5669  braries, Auto_Vi
+00094d20: 4d4c 2077 696c 6c20 696e 7374 616c 6c20  ML will install 
+00094d30: 7468 6f73 6520 666f 7220 796f 7520 6175  those for you au
+00094d40: 746f 6d61 7469 6361 6c6c 792e 0a20 2020  tomatically..   
+00094d50: 2020 2020 200a 2020 2020 2020 2020 2323       .        ##
+00094d60: 2049 6e73 7461 6c6c 0a20 2020 2020 2020   Install.       
+00094d70: 200a 2020 2020 2020 2020 2a2a 5072 6572   .        **Prer
+00094d80: 6571 7573 6974 6573 3a2a 2a0a 2020 2020  equsites:**.    
+00094d90: 2020 2020 0a20 2020 2020 2020 202d 205b      .        - [
+00094da0: 416e 6163 6f6e 6461 5d28 6874 7470 733a  Anaconda](https:
+00094db0: 2f2f 646f 6373 2e61 6e61 636f 6e64 612e  //docs.anaconda.
+00094dc0: 636f 6d2f 616e 6163 6f6e 6461 2f69 6e73  com/anaconda/ins
+00094dd0: 7461 6c6c 2f29 0a20 2020 2020 2020 200a  tall/).        .
+00094de0: 2020 2020 2020 2020 546f 2063 6c6f 6e65          To clone
+00094df0: 2041 7574 6f5f 5669 4d4c 2c20 6974 2069   Auto_ViML, it i
+00094e00: 7320 6265 7474 6572 2074 6f20 6372 6561  s better to crea
+00094e10: 7465 2061 206e 6577 2065 6e76 6972 6f6e  te a new environ
+00094e20: 6d65 6e74 2c20 616e 6420 696e 7374 616c  ment, and instal
+00094e30: 6c20 7468 6520 7265 7175 6972 6564 2064  l the required d
+00094e40: 6570 656e 6465 6e63 6965 733a 0a20 2020  ependencies:.   
+00094e50: 2020 2020 200a 2020 2020 2020 2020 546f       .        To
+00094e60: 2069 6e73 7461 6c6c 2066 726f 6d20 5079   install from Py
+00094e70: 5069 3a0a 2020 2020 2020 2020 3c70 3e0a  Pi:.        <p>.
+00094e80: 2020 2020 2020 2020 3c63 6f64 653e 2420          <code>$ 
+00094e90: 7069 7020 696e 7374 616c 6c20 6175 746f  pip install auto
+00094ea0: 7669 6d6c 202d 2d75 7067 7261 6465 202d  viml --upgrade -
+00094eb0: 2d69 676e 6f72 652d 696e 7374 616c 6c65  -ignore-installe
+00094ec0: 643c 2f63 6f64 653e 3c62 723e 0a20 2020  d</code><br>.   
+00094ed0: 2020 2020 206f 720a 2020 2020 2020 2020       or.        
+00094ee0: 0a20 2020 2020 2020 2060 6060 0a20 2020  .        ```.   
+00094ef0: 2020 2020 2070 6970 2069 6e73 7461 6c6c       pip install
+00094f00: 2067 6974 2b68 7474 7073 3a2f 2f67 6974   git+https://git
+00094f10: 6875 622e 636f 6d2f 4175 746f 5669 4d4c  hub.com/AutoViML
+00094f20: 2f41 7574 6f5f 5669 4d4c 2e67 6974 0a20  /Auto_ViML.git. 
+00094f30: 2020 2020 2020 2060 6060 0a20 2020 2020         ```.     
+00094f40: 2020 200a 2020 2020 2020 2020 546f 2069     .        To i
+00094f50: 6e73 7461 6c6c 2066 726f 6d20 736f 7572  nstall from sour
+00094f60: 6365 3a0a 2020 2020 2020 2020 0a20 2020  ce:.        .   
+00094f70: 2020 2020 2060 6060 0a20 2020 2020 2020       ```.       
+00094f80: 2063 6420 3c41 7574 6f56 494d 4c5f 4465   cd <AutoVIML_De
+00094f90: 7374 696e 6174 696f 6e3e 0a20 2020 2020  stination>.     
+00094fa0: 2020 2067 6974 2063 6c6f 6e65 2067 6974     git clone git
+00094fb0: 4067 6974 6875 622e 636f 6d3a 4175 746f  @github.com:Auto
+00094fc0: 5669 4d4c 2f41 7574 6f5f 5669 4d4c 2e67  ViML/Auto_ViML.g
+00094fd0: 6974 0a20 2020 2020 2020 2023 206f 7220  it.        # or 
+00094fe0: 646f 776e 6c6f 6164 2061 6e64 2075 6e7a  download and unz
+00094ff0: 6970 2068 7474 7073 3a2f 2f67 6974 6875  ip https://githu
+00095000: 622e 636f 6d2f 4175 746f 5669 4d4c 2f41  b.com/AutoViML/A
+00095010: 7574 6f5f 5669 4d4c 2f61 7263 6869 7665  uto_ViML/archive
+00095020: 2f6d 6173 7465 722e 7a69 700a 2020 2020  /master.zip.    
+00095030: 2020 2020 636f 6e64 6120 6372 6561 7465      conda create
+00095040: 202d 6e20 3c79 6f75 725f 656e 765f 6e61   -n <your_env_na
+00095050: 6d65 3e20 7079 7468 6f6e 3d33 2e37 2061  me> python=3.7 a
+00095060: 6e61 636f 6e64 610a 2020 2020 2020 2020  naconda.        
+00095070: 636f 6e64 6120 6163 7469 7661 7465 203c  conda activate <
+00095080: 796f 7572 5f65 6e76 5f6e 616d 653e 2023  your_env_name> #
+00095090: 204f 4e20 5749 4e44 4f57 533a 2060 736f   ON WINDOWS: `so
+000950a0: 7572 6365 2061 6374 6976 6174 6520 3c79  urce activate <y
+000950b0: 6f75 725f 656e 765f 6e61 6d65 3e60 0a20  our_env_name>`. 
+000950c0: 2020 2020 2020 2063 6420 4175 746f 5f56         cd Auto_V
+000950d0: 694d 4c0a 2020 2020 2020 2020 7069 7020  iML.        pip 
+000950e0: 696e 7374 616c 6c20 2d72 2072 6571 7569  install -r requi
+000950f0: 7265 6d65 6e74 732e 7478 740a 2020 2020  rements.txt.    
+00095100: 2020 2020 6060 600a 2020 2020 2020 2020      ```.        
+00095110: 0a20 2020 2020 2020 2023 2320 5573 6167  .        ## Usag
+00095120: 650a 2020 2020 2020 2020 0a20 2020 2020  e.        .     
+00095130: 2020 2049 6e20 7468 6520 7361 6d65 2064     In the same d
+00095140: 6972 6563 746f 7279 2c20 6f70 656e 2061  irectory, open a
+00095150: 204a 7570 7974 6572 204e 6f74 6562 6f6f   Jupyter Noteboo
+00095160: 6b20 616e 6420 7573 6520 7468 6973 206c  k and use this l
+00095170: 696e 6520 746f 2069 6d70 6f72 7420 7468  ine to import th
+00095180: 6520 2e70 7920 6669 6c65 3a0a 2020 2020  e .py file:.    
+00095190: 2020 2020 0a20 2020 2020 2020 2060 6060      .        ```
+000951a0: 0a20 2020 2020 2020 2066 726f 6d20 6175  .        from au
+000951b0: 746f 7669 6d6c 2e41 7574 6f5f 5669 4d4c  toviml.Auto_ViML
+000951c0: 2069 6d70 6f72 7420 4175 746f 5f56 694d   import Auto_ViM
+000951d0: 4c0a 2020 2020 2020 2020 6060 600a 2020  L.        ```.  
+000951e0: 2020 2020 2020 0a20 2020 2020 2020 204c        .        L
+000951f0: 6f61 6420 6120 6461 7461 2073 6574 2028  oad a data set (
+00095200: 616e 7920 4353 5620 6f72 2074 6578 7420  any CSV or text 
+00095210: 6669 6c65 2920 696e 746f 2061 2050 616e  file) into a Pan
+00095220: 6461 7320 6461 7461 6672 616d 6520 616e  das dataframe an
+00095230: 6420 7370 6c69 7420 6974 2069 6e74 6f20  d split it into 
+00095240: 5472 6169 6e20 616e 6420 5465 7374 2064  Train and Test d
+00095250: 6174 6166 7261 6d65 732e 2049 6620 796f  ataframes. If yo
+00095260: 7520 646f 6e27 7420 6861 7665 2061 2074  u don't have a t
+00095270: 6573 7420 6461 7461 6672 616d 652c 2079  est dataframe, y
+00095280: 6f75 2063 616e 2073 696d 706c 6520 6173  ou can simple as
+00095290: 7369 676e 2074 6865 2074 6573 7420 7661  sign the test va
+000952a0: 7269 6162 6c65 2062 656c 6f77 2074 6f20  riable below to 
+000952b0: 2727 2028 656d 7074 7920 7374 7269 6e67  '' (empty string
+000952c0: 293a 0a20 2020 2020 2020 200a 2020 2020  ):.        .    
+000952d0: 2020 2020 6060 600a 2020 2020 2020 2020      ```.        
+000952e0: 6d6f 6465 6c2c 2066 6561 7475 7265 732c  model, features,
+000952f0: 2074 7261 696e 6d2c 2074 6573 746d 203d   trainm, testm =
+00095300: 2041 7574 6f5f 5669 4d4c 280a 2020 2020   Auto_ViML(.    
+00095310: 2020 2020 2020 2020 7472 6169 6e2c 0a20          train,. 
+00095320: 2020 2020 2020 2020 2020 2074 6172 6765             targe
+00095330: 742c 0a20 2020 2020 2020 2020 2020 2074  t,.            t
+00095340: 6573 742c 0a20 2020 2020 2020 2020 2020  est,.           
+00095350: 2073 616d 706c 655f 7375 626d 6973 7369   sample_submissi
+00095360: 6f6e 2c0a 2020 2020 2020 2020 2020 2020  on,.            
+00095370: 6879 7065 725f 7061 7261 6d3d 2247 5322  hyper_param="GS"
+00095380: 2c0a 2020 2020 2020 2020 2020 2020 6665  ,.            fe
+00095390: 6174 7572 655f 7265 6475 6374 696f 6e3d  ature_reduction=
+000953a0: 5472 7565 2c0a 2020 2020 2020 2020 2020  True,.          
+000953b0: 2020 7363 6f72 696e 675f 7061 7261 6d65    scoring_parame
+000953c0: 7465 723d 2277 6569 6768 7465 642d 6631  ter="weighted-f1
+000953d0: 222c 0a20 2020 2020 2020 2020 2020 204b  ",.            K
+000953e0: 4d65 616e 735f 4665 6174 7572 697a 6572  Means_Featurizer
+000953f0: 3d46 616c 7365 2c0a 2020 2020 2020 2020  =False,.        
+00095400: 2020 2020 426f 6f73 7469 6e67 5f46 6c61      Boosting_Fla
+00095410: 673d 4661 6c73 652c 0a20 2020 2020 2020  g=False,.       
+00095420: 2020 2020 2042 696e 6e69 6e67 5f46 6c61       Binning_Fla
+00095430: 673d 4661 6c73 652c 0a20 2020 2020 2020  g=False,.       
+00095440: 2020 2020 2041 6464 5f50 6f6c 793d 4661       Add_Poly=Fa
+00095450: 6c73 652c 0a20 2020 2020 2020 2020 2020  lse,.           
+00095460: 2053 7461 636b 696e 675f 466c 6167 3d46   Stacking_Flag=F
+00095470: 616c 7365 2c0a 2020 2020 2020 2020 2020  alse,.          
+00095480: 2020 496d 6261 6c61 6e63 6564 5f46 6c61    Imbalanced_Fla
+00095490: 673d 4661 6c73 652c 0a20 2020 2020 2020  g=False,.       
+000954a0: 2020 2020 2076 6572 626f 7365 3d30 2c0a       verbose=0,.
+000954b0: 2020 2020 2020 2020 290a 2020 2020 2020          ).      
+000954c0: 2020 6060 600a 2020 2020 2020 2020 0a20    ```.        . 
+000954d0: 2020 2020 2020 2046 696e 616c 6c79 2c20         Finally, 
+000954e0: 6974 2077 7269 7465 7320 796f 7572 2073  it writes your s
+000954f0: 7562 6d69 7373 696f 6e20 6669 6c65 2074  ubmission file t
+00095500: 6f20 6469 736b 2069 6e20 7468 6520 6375  o disk in the cu
+00095510: 7272 656e 7420 6469 7265 6374 6f72 7920  rrent directory 
+00095520: 6361 6c6c 6564 2060 6d79 7375 626d 6973  called `mysubmis
+00095530: 7369 6f6e 2e63 7376 602e 0a20 2020 2020  sion.csv`..     
+00095540: 2020 2054 6869 7320 7375 626d 6973 7369     This submissi
+00095550: 6f6e 2066 696c 6520 6973 2072 6561 6479  on file is ready
+00095560: 2066 6f72 2079 6f75 2074 6f20 7368 6f77   for you to show
+00095570: 2069 7420 636c 6965 6e74 7320 6f72 2073   it clients or s
+00095580: 7562 6d69 7420 6974 2074 6f20 636f 6d70  ubmit it to comp
+00095590: 6574 6974 696f 6e73 2e0a 2020 2020 2020  etitions..      
+000955a0: 2020 4966 206e 6f20 7375 626d 6973 7369    If no submissi
+000955b0: 6f6e 2066 696c 6520 7761 7320 6769 7665  on file was give
+000955c0: 6e2c 2062 7574 2061 7320 6c6f 6e67 2061  n, but as long a
+000955d0: 7320 796f 7520 6769 7665 2069 7420 6120  s you give it a 
+000955e0: 7465 7374 2066 696c 6520 6e61 6d65 2c20  test file name, 
+000955f0: 6974 2077 696c 6c20 6372 6561 7465 2061  it will create a
+00095600: 2073 7562 6d69 7373 696f 6e20 6669 6c65   submission file
+00095610: 2066 6f72 2079 6f75 206e 616d 6564 2060   for you named `
+00095620: 6d79 5375 626d 6973 7369 6f6e 2e63 7376  mySubmission.csv
+00095630: 602e 0a20 2020 2020 2020 2041 7574 6f5f  `..        Auto_
+00095640: 5669 4d4c 2077 6f72 6b73 206f 6e20 616e  ViML works on an
+00095650: 7920 4d75 6c74 692d 436c 6173 732c 204d  y Multi-Class, M
+00095660: 756c 7469 2d4c 6162 656c 2044 6174 6120  ulti-Label Data 
+00095670: 5365 742e 2053 6f20 796f 7520 6361 6e20  Set. So you can 
+00095680: 6861 7665 206d 616e 7920 7461 7267 6574  have many target
+00095690: 206c 6162 656c 732e 0a20 2020 2020 2020   labels..       
+000956a0: 2059 6f75 2064 6f6e 2774 2068 6176 6520   You don't have 
+000956b0: 746f 2074 656c 6c20 4175 746f 5f56 694d  to tell Auto_ViM
+000956c0: 4c20 7768 6574 6865 7220 6974 2069 7320  L whether it is 
+000956d0: 6120 5265 6772 6573 7369 6f6e 206f 7220  a Regression or 
+000956e0: 436c 6173 7369 6669 6361 7469 6f6e 2070  Classification p
+000956f0: 726f 626c 656d 2e0a 2020 2020 2020 2020  roblem..        
+00095700: 0a20 2020 2020 2020 2023 2320 5469 7073  .        ## Tips
+00095710: 2066 6f72 2075 7369 6e67 2041 7574 6f5f   for using Auto_
+00095720: 5669 4d4c 3a0a 2020 2020 2020 2020 312e  ViML:.        1.
+00095730: 2060 7363 6f72 696e 675f 7061 7261 6d65   `scoring_parame
+00095740: 7465 7260 3a20 466f 7220 436c 6173 7369  ter`: For Classi
+00095750: 6669 6361 7469 6f6e 2070 726f 626c 656d  fication problem
+00095760: 7320 616e 6420 696d 6261 6c61 6e63 6564  s and imbalanced
+00095770: 2063 6c61 7373 6573 2c20 6368 6f6f 7365   classes, choose
+00095780: 2073 636f 7269 6e67 5f70 6172 616d 6574   scoring_paramet
+00095790: 6572 3d22 6261 6c61 6e63 6564 5f61 6363  er="balanced_acc
+000957a0: 7572 6163 7922 2e20 4974 2077 6f72 6b73  uracy". It works
+000957b0: 2062 6574 7465 722e 0a20 2020 2020 2020   better..       
+000957c0: 2032 2e20 6049 6d62 616c 616e 6365 645f   2. `Imbalanced_
+000957d0: 466c 6167 603a 2046 6f72 2049 6d62 616c  Flag`: For Imbal
+000957e0: 616e 6365 6420 436c 6173 7365 7320 283c  anced Classes (<
+000957f0: 3525 2073 616d 706c 6573 2069 6e20 7261  5% samples in ra
+00095800: 7265 2063 6c61 7373 292c 2063 686f 6f73  re class), choos
+00095810: 6520 2249 6d62 616c 616e 6365 645f 466c  e "Imbalanced_Fl
+00095820: 6167 223d 5472 7565 2e20 596f 7520 6361  ag"=True. You ca
+00095830: 6e20 616c 736f 2073 6574 2074 6869 7320  n also set this 
+00095840: 666c 6167 2074 6f20 5472 7565 2066 6f72  flag to True for
+00095850: 2052 6567 7265 7373 696f 6e20 7072 6f62   Regression prob
+00095860: 6c65 6d73 2077 6865 7265 2074 6865 2074  lems where the t
+00095870: 6172 6765 7420 7661 7269 6162 6c65 206d  arget variable m
+00095880: 6967 6874 2068 6176 6520 736b 6577 6564  ight have skewed
+00095890: 2064 6973 7472 6962 7574 696f 6e73 2e0a   distributions..
+000958a0: 2020 2020 2020 2020 332e 2060 7461 7267          3. `targ
+000958b0: 6574 603a 2046 6f72 204d 756c 7469 2d4c  et`: For Multi-L
+000958c0: 6162 656c 2064 6174 6173 6574 2c20 7468  abel dataset, th
+000958d0: 6520 7461 7267 6574 2069 6e70 7574 2074  e target input t
+000958e0: 6172 6765 7420 7661 7269 6162 6c65 2063  arget variable c
+000958f0: 616e 2062 6520 7365 6e74 2069 6e20 6173  an be sent in as
+00095900: 2061 206c 6973 7420 6f66 2076 6172 6961   a list of varia
+00095910: 626c 6573 2e0a 2020 2020 2020 2020 342e  bles..        4.
+00095920: 2060 426f 6f73 7469 6e67 5f46 6c61 6760   `Boosting_Flag`
+00095930: 3a20 4974 2069 7320 7265 636f 6d6d 656e  : It is recommen
+00095940: 6465 6420 7468 6174 2079 6f75 2066 6972  ded that you fir
+00095950: 7374 2073 6574 2042 6f6f 7374 696e 675f  st set Boosting_
+00095960: 466c 6167 3d4e 6f6e 6520 746f 2067 6574  Flag=None to get
+00095970: 2061 204c 696e 6561 7220 6d6f 6465 6c2e   a Linear model.
+00095980: 204f 6e63 6520 796f 7520 756e 6465 7273   Once you unders
+00095990: 7461 6e64 2074 6861 742c 2074 6865 6e20  tand that, then 
+000959a0: 796f 7520 6361 6e20 7472 7920 746f 2073  you can try to s
+000959b0: 6574 2042 6f6f 7374 696e 675f 466c 6167  et Boosting_Flag
+000959c0: 3d46 616c 7365 2074 6f20 6765 7420 6120  =False to get a 
+000959d0: 5261 6e64 6f6d 2046 6f72 6573 7420 6d6f  Random Forest mo
+000959e0: 6465 6c2e 2046 696e 616c 6c79 2c20 7472  del. Finally, tr
+000959f0: 7920 426f 6f73 7469 6e67 5f46 6c61 673d  y Boosting_Flag=
+00095a00: 5472 7565 2074 6f20 6765 7420 616e 2058  True to get an X
+00095a10: 4742 6f6f 7374 206d 6f64 656c 2e20 5468  GBoost model. Th
+00095a20: 6973 2069 7320 7468 6520 6f72 6465 7220  is is the order 
+00095a30: 7468 6174 2077 6520 7265 636f 6d6d 656e  that we recommen
+00095a40: 6420 696e 206f 7264 6572 2074 6f20 7573  d in order to us
+00095a50: 6520 4175 746f 5f56 694d 4c2e 2046 696e  e Auto_ViML. Fin
+00095a60: 616c 6c79 2074 7279 2042 6f6f 7374 696e  ally try Boostin
+00095a70: 675f 466c 6167 3d22 4361 7442 6f6f 7374  g_Flag="CatBoost
+00095a80: 2220 746f 2067 6574 2061 2063 6f6d 706c  " to get a compl
+00095a90: 6578 2062 7574 2068 6967 6820 7065 7266  ex but high perf
+00095aa0: 6f72 6d69 6e67 206d 6f64 656c 2e0a 2020  orming model..  
+00095ab0: 2020 2020 2020 352e 2060 4269 6e6e 696e        5. `Binnin
+00095ac0: 675f 466c 6167 603a 2042 696e 6e69 6e67  g_Flag`: Binning
+00095ad0: 5f46 6c61 673d 5472 7565 2069 6d70 726f  _Flag=True impro
+00095ae0: 7665 7320 6120 4361 7442 6f6f 7374 206d  ves a CatBoost m
+00095af0: 6f64 656c 2073 696e 6365 2069 7420 6164  odel since it ad
+00095b00: 6473 2074 6f20 7468 6520 6c69 7374 206f  ds to the list o
+00095b10: 6620 6361 7465 676f 7269 6361 6c20 7661  f categorical va
+00095b20: 7273 2069 6e20 6461 7461 0a20 2020 2020  rs in data.     
+00095b30: 2020 2036 2e20 604b 4d65 616e 735f 6665     6. `KMeans_fe
+00095b40: 6174 7572 697a 6572 603a 204b 4d65 616e  aturizer`: KMean
+00095b50: 735f 6665 6174 7572 697a 6572 3d54 7275  s_featurizer=Tru
+00095b60: 6520 776f 726b 7320 7765 6c6c 2069 6e20  e works well in 
+00095b70: 4e4c 5020 616e 6420 4361 7442 6f6f 7374  NLP and CatBoost
+00095b80: 206d 6f64 656c 7320 7369 6e63 6520 6974   models since it
+00095b90: 2063 7265 6174 6573 2063 6c75 7374 6572   creates cluster
+00095ba0: 2076 6172 6961 626c 6573 0a20 2020 2020   variables.     
+00095bb0: 2020 2037 2e20 6041 6464 5f50 6f6c 7960     7. `Add_Poly`
+00095bc0: 3a20 4164 645f 506f 6c79 3d33 2069 6d70  : Add_Poly=3 imp
+00095bd0: 726f 7665 7320 6365 7274 6169 6e20 6d6f  roves certain mo
+00095be0: 6465 6c73 2077 6865 7265 2074 6865 7265  dels where there
+00095bf0: 2069 7320 6461 7465 2d74 696d 6520 6f72   is date-time or
+00095c00: 2063 6174 6567 6f72 6963 616c 2061 6e64   categorical and
+00095c10: 206e 756d 6572 6963 2076 6172 6961 626c   numeric variabl
+00095c20: 6573 0a20 2020 2020 2020 2038 2e20 6066  es.        8. `f
+00095c30: 6561 7475 7265 5f72 6564 7563 7469 6f6e  eature_reduction
+00095c40: 603a 2066 6561 7475 7265 5f72 6564 7563  `: feature_reduc
+00095c50: 7469 6f6e 3d54 7275 6520 6973 2074 6865  tion=True is the
+00095c60: 2064 6566 6175 6c74 2061 6e64 2077 6f72   default and wor
+00095c70: 6b73 2062 6573 742e 2042 7574 2077 6865  ks best. But whe
+00095c80: 6e20 796f 7520 6861 7665 203c 3130 2066  n you have <10 f
+00095c90: 6561 7475 7265 7320 696e 2064 6174 612c  eatures in data,
+00095ca0: 2073 6574 2069 7420 746f 2046 616c 7365   set it to False
+00095cb0: 0a20 2020 2020 2020 2039 2e20 6053 7461  .        9. `Sta
+00095cc0: 636b 696e 675f 466c 6167 603a 2044 6f20  cking_Flag`: Do 
+00095cd0: 6e6f 7420 7365 7420 5374 6163 6b69 6e67  not set Stacking
+00095ce0: 5f46 6c61 673d 5472 7565 2077 6974 6820  _Flag=True with 
+00095cf0: 4c69 6e65 6172 206d 6f64 656c 7320 7369  Linear models si
+00095d00: 6e63 6520 796f 7572 2072 6573 756c 7473  nce your results
+00095d10: 206d 6179 206e 6f74 206c 6f6f 6b20 6772   may not look gr
+00095d20: 6561 742e 0a20 2020 2020 2020 2031 302e  eat..        10.
+00095d30: 2060 5374 6163 6b69 6e67 5f46 6c61 6760   `Stacking_Flag`
+00095d40: 3a20 5573 6520 5374 6163 6b69 6e67 5f46  : Use Stacking_F
+00095d50: 6c61 673d 5472 7565 206f 6e6c 7920 666f  lag=True only fo
+00095d60: 7220 636f 6d70 6c65 7820 6d6f 6465 6c73  r complex models
+00095d70: 2061 6e64 2061 7320 6120 6c61 7374 2073   and as a last s
+00095d80: 7465 7020 7769 7468 2042 6f6f 7374 696e  tep with Boostin
+00095d90: 675f 466c 6167 3d54 7275 6520 6f72 2043  g_Flag=True or C
+00095da0: 6174 426f 6f73 740a 2020 2020 2020 2020  atBoost.        
+00095db0: 3131 2e20 6068 7970 6572 5f70 6172 616d  11. `hyper_param
+00095dc0: 603a 204c 6561 7665 2068 7970 6572 5f70  `: Leave hyper_p
+00095dd0: 6172 616d 203d 2252 5322 2061 7320 696e  aram ="RS" as in
+00095de0: 7075 7420 7369 6e63 6520 6974 2072 756e  put since it run
+00095df0: 7320 6661 7374 6572 2074 6861 6e20 4772  s faster than Gr
+00095e00: 6964 5365 6172 6368 4356 2061 6e64 2067  idSearchCV and g
+00095e10: 6976 6573 2062 6574 7465 7220 7265 7375  ives better resu
+00095e20: 6c74 7320 756e 6c65 7373 2079 6f75 2068  lts unless you h
+00095e30: 6176 6520 6120 736d 616c 6c20 6461 7461  ave a small data
+00095e40: 2073 6574 2061 6e64 2063 616e 2061 6666   set and can aff
+00095e50: 6f72 6420 746f 2073 7065 6e64 2074 696d  ord to spend tim
+00095e60: 6520 6f6e 2068 7970 6572 2074 756e 696e  e on hyper tunin
+00095e70: 672e 0a20 2020 2020 2020 2031 322e 2060  g..        12. `
+00095e80: 4b4d 6561 6e73 5f46 6561 7475 7269 7a65  KMeans_Featurize
+00095e90: 7260 3a20 4b4d 6561 6e73 5f46 6561 7475  r`: KMeans_Featu
+00095ea0: 7269 7a65 723d 5472 7565 2064 6f65 7320  rizer=True does 
+00095eb0: 6e6f 7420 776f 726b 2077 656c 6c20 666f  not work well fo
+00095ec0: 7220 736d 616c 6c20 6461 7461 2073 6574  r small data set
+00095ed0: 732e 2055 7365 2069 7420 666f 7220 6461  s. Use it for da
+00095ee0: 7461 2073 6574 7320 3e20 3130 2c30 3030  ta sets > 10,000
+00095ef0: 2072 6f77 732e 0a20 2020 2020 2020 2031   rows..        1
+00095f00: 332e 2060 4669 6e61 6c20 7468 6f75 6768  3. `Final though
+00095f10: 7473 603a 2046 696e 616c 6c79 2041 7574  ts`: Finally Aut
+00095f20: 6f5f 5669 4d4c 2069 7320 6d65 616e 7420  o_ViML is meant 
+00095f30: 746f 2062 6520 6120 6261 7365 6c69 6e65  to be a baseline
+00095f40: 206f 7220 6368 616c 6c65 6e67 6572 2073   or challenger s
+00095f50: 6f6c 7574 696f 6e20 746f 2079 6f75 7220  olution to your 
+00095f60: 6461 7461 2073 6574 2e20 536f 2075 7365  data set. So use
+00095f70: 2069 7420 666f 7220 6d61 6b69 6e67 2071   it for making q
+00095f80: 7569 636b 206d 6f64 656c 7320 7468 6174  uick models that
+00095f90: 2079 6f75 2063 616e 2063 6f6d 7061 7265   you can compare
+00095fa0: 2061 6761 696e 7374 206f 7220 696e 2048   against or in H
+00095fb0: 6163 6b61 7468 6f6e 732e 2049 7420 6973  ackathons. It is
+00095fc0: 206e 6f74 206d 6561 6e74 2066 6f72 2070   not meant for p
+00095fd0: 726f 6475 6374 696f 6e21 0a20 2020 2020  roduction!.     
+00095fe0: 2020 200a 2020 2020 2020 2020 2323 2041     .        ## A
+00095ff0: 5049 0a20 2020 2020 2020 200a 2020 2020  PI.        .    
+00096000: 2020 2020 2a2a 4172 6775 6d65 6e74 732a      **Arguments*
+00096010: 2a0a 2020 2020 2020 2020 0a20 2020 2020  *.        .     
+00096020: 2020 202d 2060 7472 6169 6e60 3a20 636f     - `train`: co
+00096030: 756c 6420 6265 2061 2064 6174 6170 6174  uld be a datapat
+00096040: 682b 6669 6c65 6e61 6d65 206f 7220 6120  h+filename or a 
+00096050: 6461 7461 6672 616d 652e 2049 7420 7769  dataframe. It wi
+00096060: 6c6c 2064 6574 6563 7420 7768 6963 6820  ll detect which 
+00096070: 6973 2077 6869 6368 2061 6e64 206c 6f61  is which and loa
+00096080: 6420 6974 2e0a 2020 2020 2020 2020 2d20  d it..        - 
+00096090: 6074 6573 7460 3a20 636f 756c 6420 6265  `test`: could be
+000960a0: 2061 2064 6174 6170 6174 682b 6669 6c65   a datapath+file
+000960b0: 6e61 6d65 206f 7220 6120 6461 7461 6672  name or a datafr
+000960c0: 616d 652e 2049 6620 796f 7520 646f 6e27  ame. If you don'
+000960d0: 7420 6861 7665 2061 6e79 2c20 6a75 7374  t have any, just
+000960e0: 206c 6561 7665 2069 7420 6173 2022 222e   leave it as "".
+000960f0: 0a20 2020 2020 2020 202d 2060 7375 626d  .        - `subm
+00096100: 6973 7369 6f6e 603a 206d 7573 7420 6265  ission`: must be
+00096110: 2061 2064 6174 6170 6174 682b 6669 6c65   a datapath+file
+00096120: 6e61 6d65 2e20 4966 2079 6f75 2064 6f6e  name. If you don
+00096130: 2774 2068 6176 6520 616e 792c 206a 7573  't have any, jus
+00096140: 7420 6c65 6176 6520 6974 2061 7320 656d  t leave it as em
+00096150: 7074 7920 7374 7269 6e67 2e0a 2020 2020  pty string..    
+00096160: 2020 2020 2d20 6074 6172 6765 7460 3a20      - `target`: 
+00096170: 6e61 6d65 206f 6620 7468 6520 7461 7267  name of the targ
+00096180: 6574 2076 6172 6961 626c 6520 696e 2074  et variable in t
+00096190: 6865 2064 6174 6120 7365 742e 0a20 2020  he data set..   
+000961a0: 2020 2020 202d 2060 7365 7060 3a20 6966       - `sep`: if
+000961b0: 2079 6f75 2068 6176 6520 6120 7370 6561   you have a spea
+000961c0: 7261 746f 7220 696e 2074 6865 2066 696c  rator in the fil
+000961d0: 6520 7375 6368 2061 7320 222c 2220 6f72  e such as "," or
+000961e0: 2022 5c74 2220 6d65 6e74 696f 6e20 6974   "\t" mention it
+000961f0: 2068 6572 652e 2044 6566 6175 6c74 2069   here. Default i
+00096200: 7320 222c 222e 0a20 2020 2020 2020 202d  s ","..        -
+00096210: 2060 7363 6f72 696e 675f 7061 7261 6d65   `scoring_parame
+00096220: 7465 7260 3a20 6966 2079 6f75 2077 616e  ter`: if you wan
+00096230: 7420 796f 7572 206f 776e 2073 636f 7269  t your own scori
+00096240: 6e67 2070 6172 616d 6574 6572 2073 7563  ng parameter suc
+00096250: 6820 6173 2022 6631 2220 6769 7665 2069  h as "f1" give i
+00096260: 7420 6865 7265 2e20 4966 206e 6f74 2c20  t here. If not, 
+00096270: 6974 2077 696c 6c20 6173 7375 6d65 2074  it will assume t
+00096280: 6865 2061 7070 726f 7072 6961 7465 2073  he appropriate s
+00096290: 636f 7269 6e67 2070 6172 616d 2066 6f72  coring param for
+000962a0: 2074 6865 2070 726f 626c 656d 2061 6e64   the problem and
+000962b0: 2069 7420 7769 6c6c 2062 7569 6c64 2074   it will build t
+000962c0: 6865 206d 6f64 656c 2e0a 2020 2020 2020  he model..      
+000962d0: 2020 2d20 6068 7970 6572 5f70 6172 616d    - `hyper_param
+000962e0: 603a 2054 756e 696e 6720 6f70 7469 6f6e  `: Tuning option
+000962f0: 7320 6172 6520 4772 6964 5365 6172 6368  s are GridSearch
+00096300: 2028 2747 5327 2920 616e 6420 5261 6e64   ('GS') and Rand
+00096310: 6f6d 697a 6564 5365 6172 6368 2028 2752  omizedSearch ('R
+00096320: 5327 292e 2044 6566 6175 6c74 2069 7320  S'). Default is 
+00096330: 2752 5327 2e0a 2020 2020 2020 2020 2d20  'RS'..        - 
+00096340: 6066 6561 7475 7265 5f72 6564 7563 7469  `feature_reducti
+00096350: 6f6e 603a 2044 6566 6175 6c74 203d 2027  on`: Default = '
+00096360: 5472 7565 2720 6275 7420 6974 2063 616e  True' but it can
+00096370: 2062 6520 7365 7420 746f 2046 616c 7365   be set to False
+00096380: 2069 6620 796f 7520 646f 6e27 7420 7761   if you don't wa
+00096390: 6e74 2061 7574 6f6d 6174 6963 2066 6561  nt automatic fea
+000963a0: 7475 7265 5f72 6564 7563 7469 6f6e 2073  ture_reduction s
+000963b0: 696e 6365 2069 6e20 496d 6167 6520 6461  ince in Image da
+000963c0: 7461 2073 6574 7320 6c69 6b65 2064 6967  ta sets like dig
+000963d0: 6974 7320 616e 6420 4d4e 4953 542c 2079  its and MNIST, y
+000963e0: 6f75 2067 6574 2062 6574 7465 7220 7265  ou get better re
+000963f0: 7375 6c74 7320 7768 656e 2079 6f75 2064  sults when you d
+00096400: 6f6e 2774 2072 6564 7563 6520 6665 6174  on't reduce feat
+00096410: 7572 6573 2061 7574 6f6d 6174 6963 616c  ures automatical
+00096420: 6c79 2e20 596f 7520 6361 6e20 616c 7761  ly. You can alwa
+00096430: 7973 2074 7279 2062 6f74 6820 616e 6420  ys try both and 
+00096440: 7365 652e 0a20 2020 2020 2020 202d 2060  see..        - `
+00096450: 4b4d 6561 6e73 5f46 6561 7475 7269 7a65  KMeans_Featurize
+00096460: 7260 0a20 2020 2020 2020 2020 202d 2060  r`.          - `
+00096470: 5472 7565 603a 2041 6464 7320 6120 636c  True`: Adds a cl
+00096480: 7573 7465 7220 6c61 6265 6c20 746f 2066  uster label to f
+00096490: 6561 7475 7265 7320 6261 7365 6420 6f6e  eatures based on
+000964a0: 204b 4d65 616e 732e 2055 7365 2066 6f72   KMeans. Use for
+000964b0: 204c 696e 6561 722e 0a20 2020 2020 2020   Linear..       
+000964c0: 2020 202d 2060 4661 6c73 6520 2864 6566     - `False (def
+000964d0: 6175 6c74 2960 2046 6f72 2052 616e 646f  ault)` For Rando
+000964e0: 6d20 466f 7265 7374 7320 6f72 2058 4742  m Forests or XGB
+000964f0: 206d 6f64 656c 732c 206c 6561 7665 2069   models, leave i
+00096500: 7420 4661 6c73 6520 7369 6e63 6520 6974  t False since it
+00096510: 206d 6179 206f 7665 7266 6974 2e0a 2020   may overfit..  
+00096520: 2020 2020 2020 2d20 6042 6f6f 7374 696e        - `Boostin
+00096530: 6720 466c 6167 603a 2079 6f75 2068 6176  g Flag`: you hav
+00096540: 6520 3420 706f 7373 6962 6c65 2063 686f  e 4 possible cho
+00096550: 6963 6573 2028 6465 6661 756c 7420 6973  ices (default is
+00096560: 2046 616c 7365 293a 0a20 2020 2020 2020   False):.       
+00096570: 2020 202d 2060 4e6f 6e65 6020 5468 6973     - `None` This
+00096580: 2077 696c 6c20 6275 696c 6420 6120 4c69   will build a Li
+00096590: 6e65 6172 204d 6f64 656c 0a20 2020 2020  near Model.     
+000965a0: 2020 2020 202d 2060 4661 6c73 6560 2054       - `False` T
+000965b0: 6869 7320 7769 6c6c 2062 7569 6c64 2061  his will build a
+000965c0: 2052 616e 646f 6d20 466f 7265 7374 206f   Random Forest o
+000965d0: 7220 4578 7472 6120 5472 6565 7320 6d6f  r Extra Trees mo
+000965e0: 6465 6c20 2861 6c73 6f20 6b6e 6f77 6e20  del (also known 
+000965f0: 6173 2042 6167 6769 6e67 290a 2020 2020  as Bagging).    
+00096600: 2020 2020 2020 2d20 6054 7275 6560 2054        - `True` T
+00096610: 6869 7320 7769 6c6c 2062 7569 6c64 2061  his will build a
+00096620: 6e20 5847 426f 6f73 7420 6d6f 6465 6c0a  n XGBoost model.
+00096630: 2020 2020 2020 2020 2020 2d20 6043 6174            - `Cat
+00096640: 426f 6f73 7460 2054 6869 7320 7769 6c6c  Boost` This will
+00096650: 2062 7569 6c64 2061 2043 6174 426f 6f73   build a CatBoos
+00096660: 7420 6d6f 6465 6c20 2870 726f 7669 6465  t model (provide
+00096670: 6420 796f 7520 6861 7665 2043 6174 426f  d you have CatBo
+00096680: 6f73 7420 696e 7374 616c 6c65 6429 0a20  ost installed). 
+00096690: 2020 2020 2020 202d 2060 4164 645f 506f         - `Add_Po
+000966a0: 6c79 603a 2044 6566 6175 6c74 2069 7320  ly`: Default is 
+000966b0: 3020 7768 6963 6820 6d65 616e 7320 646f  0 which means do
+000966c0: 2d6e 6f74 6869 6e67 2e20 4275 7420 6974  -nothing. But it
+000966d0: 2068 6173 2074 6872 6565 2069 6e74 6572   has three inter
+000966e0: 6573 7469 6e67 2073 6574 7469 6e67 733a  esting settings:
+000966f0: 0a20 2020 2020 2020 2020 202d 2060 3160  .          - `1`
+00096700: 2041 6464 2069 6e74 6572 6163 7469 6f6e   Add interaction
+00096710: 2076 6172 6961 626c 6573 206f 6e6c 7920   variables only 
+00096720: 7375 6368 2061 7320 7831 2a78 322c 2078  such as x1*x2, x
+00096730: 322a 7833 2c2e 2e2e 7839 5c2a 3130 2065  2*x3,...x9\*10 e
+00096740: 7463 2e0a 2020 2020 2020 2020 2020 2d20  tc..          - 
+00096750: 6032 6020 4164 6420 496e 7465 7261 6374  `2` Add Interact
+00096760: 696f 6e73 2061 6e64 2053 7175 6172 6564  ions and Squared
+00096770: 2076 6172 6961 626c 6573 2073 7563 6820   variables such 
+00096780: 6173 2078 312a 2a32 2c20 7832 2a2a 322c  as x1**2, x2**2,
+00096790: 2065 7463 2e0a 2020 2020 2020 2020 2020   etc..          
+000967a0: 2d20 6033 6020 4164 6473 2062 6f74 6820  - `3` Adds both 
+000967b0: 496e 7465 7261 6374 696f 6e73 2061 6e64  Interactions and
+000967c0: 2053 7175 6172 6564 2076 6172 6961 626c   Squared variabl
+000967d0: 6573 2073 7563 6820 6173 2078 312a 7832  es such as x1*x2
+000967e0: 2c20 7831 2a2a 322c 7832 2a78 332c 2078  , x1**2,x2*x3, x
+000967f0: 322a 2a32 2c20 6574 632e 0a20 2020 2020  2**2, etc..     
+00096800: 2020 202d 2060 5374 6163 6b69 6e67 5f46     - `Stacking_F
+00096810: 6c61 6760 3a20 4465 6661 756c 7420 6973  lag`: Default is
+00096820: 2046 616c 7365 2e20 4966 2073 6574 2074   False. If set t
+00096830: 6f20 5472 7565 2c20 6974 2077 696c 6c20  o True, it will 
+00096840: 6164 6420 616e 2061 6464 6974 696f 6e61  add an additiona
+00096850: 6c20 6665 6174 7572 6520 7768 6963 6820  l feature which 
+00096860: 6973 2064 6572 6976 6564 2066 726f 6d20  is derived from 
+00096870: 7072 6564 6963 7469 6f6e 7320 6f66 2061  predictions of a
+00096880: 6e6f 7468 6572 206d 6f64 656c 2e20 5468  nother model. Th
+00096890: 6973 2069 7320 7573 6564 2069 6e20 736f  is is used in so
+000968a0: 6d65 2063 6173 6573 2062 7574 206d 6179  me cases but may
+000968b0: 2072 6573 756c 7420 696e 206f 7665 7266   result in overf
+000968c0: 6974 7469 6e67 2e20 536f 2062 6520 6361  itting. So be ca
+000968d0: 7265 6675 6c20 7475 726e 696e 6720 7468  reful turning th
+000968e0: 6973 2066 6c61 6720 226f 6e22 2e0a 2020  is flag "on"..  
+000968f0: 2020 2020 2020 2d20 6042 696e 6e69 6e67        - `Binning
+00096900: 5f46 6c61 6760 3a20 4465 6661 756c 7420  _Flag`: Default 
+00096910: 6973 2046 616c 7365 2e20 4974 2073 6574  is False. It set
+00096920: 2074 6f20 5472 7565 2c20 6974 2077 696c   to True, it wil
+00096930: 6c20 636f 6e76 6572 7420 7468 6520 746f  l convert the to
+00096940: 7020 6e75 6d65 7269 6320 7661 7269 6162  p numeric variab
+00096950: 6c65 7320 696e 746f 2062 696e 6e65 6420  les into binned 
+00096960: 7661 7269 6162 6c65 7320 7468 726f 7567  variables throug
+00096970: 6820 6120 7465 6368 6e69 7175 6520 6b6e  h a technique kn
+00096980: 6f77 6e20 6173 2022 456e 7472 6f70 7922  own as "Entropy"
+00096990: 2062 696e 6e69 6e67 2e20 5468 6973 2069   binning. This i
+000969a0: 7320 7665 7279 2068 656c 7066 756c 2066  s very helpful f
+000969b0: 6f72 2063 6572 7461 696e 2064 6174 6173  or certain datas
+000969c0: 6574 7320 2865 7370 6563 6961 6c6c 7920  ets (especially 
+000969d0: 6861 7264 2074 6f20 6275 696c 6420 6d6f  hard to build mo
+000969e0: 6465 6c73 292e 0a20 2020 2020 2020 202d  dels)..        -
+000969f0: 2060 496d 6261 6c61 6e63 6564 5f46 6c61   `Imbalanced_Fla
+00096a00: 6760 3a20 4465 6661 756c 7420 6973 2046  g`: Default is F
+00096a10: 616c 7365 2e20 5573 6573 2069 6d62 616c  alse. Uses imbal
+00096a20: 616e 6365 645f 656e 7365 6d62 6c65 206c  anced_ensemble l
+00096a30: 6962 7261 7279 2066 6f72 2069 6d62 616c  ibrary for imbal
+00096a40: 616e 6365 6420 6461 7461 2e20 4a75 7374  anced data. Just
+00096a50: 2073 6574 2049 6d62 616c 616e 6365 645f   set Imbalanced_
+00096a60: 466c 6167 203d 2054 7275 6520 696e 2061  Flag = True in a
+00096a70: 7267 756d 656e 7473 0a20 2020 2020 2020  rguments.       
+00096a80: 202d 2060 7665 7262 6f73 6560 3a20 5468   - `verbose`: Th
+00096a90: 6973 2068 6173 2033 2070 6f73 7369 626c  is has 3 possibl
+00096aa0: 6520 7374 6174 6573 3a0a 2020 2020 2020  e states:.      
+00096ab0: 2020 2020 2d20 6030 6020 6c69 6d69 7465      - `0` limite
+00096ac0: 6420 6f75 7470 7574 2e20 4772 6561 7420  d output. Great 
+00096ad0: 666f 7220 7275 6e6e 696e 6720 7468 6973  for running this
+00096ae0: 2073 696c 656e 746c 7920 616e 6420 6765   silently and ge
+00096af0: 7474 696e 6720 6661 7374 2072 6573 756c  tting fast resul
+00096b00: 7473 2e0a 2020 2020 2020 2020 2020 2d20  ts..          - 
+00096b10: 6031 6020 6d6f 7265 2063 6861 7274 732e  `1` more charts.
+00096b20: 2047 7265 6174 2066 6f72 206b 6e6f 7769   Great for knowi
+00096b30: 6e67 2068 6f77 2072 6573 756c 7473 2077  ng how results w
+00096b40: 6572 6520 616e 6420 6d61 6b69 6e67 2063  ere and making c
+00096b50: 6861 6e67 6573 2074 6f20 666c 6167 7320  hanges to flags 
+00096b60: 696e 2069 6e70 7574 2e0a 2020 2020 2020  in input..      
+00096b70: 2020 2020 2d20 6032 6020 6c6f 7473 206f      - `2` lots o
+00096b80: 6620 6368 6172 7473 2061 6e64 206f 7574  f charts and out
+00096b90: 7075 742e 2047 7265 6174 2066 6f72 2072  put. Great for r
+00096ba0: 6570 726f 6475 6369 6e67 2077 6861 7420  eproducing what 
+00096bb0: 4175 746f 5f56 694d 4c20 646f 6573 206f  Auto_ViML does o
+00096bc0: 6e20 796f 7572 206f 776e 2e0a 2020 2020  n your own..    
+00096bd0: 2020 2020 0a20 2020 2020 2020 202a 2a52      .        **R
+00096be0: 6574 7572 6e20 7661 6c75 6573 2a2a 0a20  eturn values**. 
+00096bf0: 2020 2020 2020 200a 2020 2020 2020 2020         .        
+00096c00: 2d20 606d 6f64 656c 603a 2049 7420 7769  - `model`: It wi
+00096c10: 6c6c 2072 6574 7572 6e20 796f 7572 2074  ll return your t
+00096c20: 7261 696e 6564 206d 6f64 656c 0a20 2020  rained model.   
+00096c30: 2020 2020 202d 2060 6665 6174 7572 6573       - `features
+00096c40: 603a 2074 6865 2066 6577 6573 7420 6e75  `: the fewest nu
+00096c50: 6d62 6572 206f 6620 6665 6174 7572 6573  mber of features
+00096c60: 2069 6e20 796f 7572 206d 6f64 656c 2074   in your model t
+00096c70: 6f20 6d61 6b65 2069 7420 7065 7266 6f72  o make it perfor
+00096c80: 6d20 7765 6c6c 0a20 2020 2020 2020 202d  m well.        -
+00096c90: 2060 7472 6169 6e5f 6d6f 6469 6669 6564   `train_modified
+00096ca0: 603a 2074 6869 7320 6973 2074 6865 206d  `: this is the m
+00096cb0: 6f64 6966 6965 6420 7472 6169 6e20 6461  odified train da
+00096cc0: 7461 6672 616d 6520 6166 7465 7220 7265  taframe after re
+00096cd0: 6d6f 7669 6e67 2061 6e64 2061 6464 696e  moving and addin
+00096ce0: 6720 6665 6174 7572 6573 0a20 2020 2020  g features.     
+00096cf0: 2020 202d 2060 7465 7374 5f6d 6f64 6966     - `test_modif
+00096d00: 6965 6460 3a20 7468 6973 2069 7320 7468  ied`: this is th
+00096d10: 6520 6d6f 6469 6669 6564 2074 6573 7420  e modified test 
+00096d20: 6461 7461 6672 616d 6520 7769 7468 2074  dataframe with t
+00096d30: 6865 2073 616d 6520 7472 616e 7366 6f72  he same transfor
+00096d40: 6d61 7469 6f6e 7320 6173 2074 7261 696e  mations as train
+00096d50: 0a20 2020 2020 2020 200a 2020 2020 2020  .        .      
+00096d60: 2020 2323 204d 6169 6e74 6169 6e65 7273    ## Maintainers
+00096d70: 0a20 2020 2020 2020 200a 2020 2020 2020  .        .      
+00096d80: 2020 2a20 5b40 4175 746f 5669 4d4c 5d28    * [@AutoViML](
+00096d90: 6874 7470 733a 2f2f 6769 7468 7562 2e63  https://github.c
+00096da0: 6f6d 2f41 7574 6f56 694d 4c29 0a20 2020  om/AutoViML).   
+00096db0: 2020 2020 202a 205b 406d 6f72 656e 6f68       * [@morenoh
+00096dc0: 3134 395d 2868 7474 7073 3a2f 2f67 6974  149](https://git
+00096dd0: 6875 622e 636f 6d2f 6d6f 7265 6e6f 6831  hub.com/morenoh1
+00096de0: 3439 290a 2020 2020 2020 2020 2a20 5b40  49).        * [@
+00096df0: 6869 726f 6e72 6f79 5d28 6874 7470 733a  hironroy](https:
+00096e00: 2f2f 6769 7468 7562 2e63 6f6d 2f68 6972  //github.com/hir
+00096e10: 6f6e 726f 7929 0a20 2020 2020 2020 200a  onroy).        .
+00096e20: 2020 2020 2020 2020 2323 2043 6f6e 7472          ## Contr
+00096e30: 6962 7574 696e 670a 2020 2020 2020 2020  ibuting.        
+00096e40: 0a20 2020 2020 2020 2053 6565 205b 7468  .        See [th
+00096e50: 6520 636f 6e74 7269 6275 7469 6e67 2066  e contributing f
+00096e60: 696c 655d 2843 4f4e 5452 4942 5554 494e  ile](CONTRIBUTIN
+00096e70: 472e 6d64 2921 0a20 2020 2020 2020 200a  G.md)!.        .
+00096e80: 2020 2020 2020 2020 5052 7320 6163 6365          PRs acce
+00096e90: 7074 6564 2e0a 2020 2020 2020 2020 0a20  pted..        . 
+00096ea0: 2020 2020 2020 2023 2320 4c69 6365 6e73         ## Licens
+00096eb0: 650a 2020 2020 2020 2020 0a20 2020 2020  e.        .     
+00096ec0: 2020 2041 7061 6368 6520 4c69 6365 6e73     Apache Licens
+00096ed0: 6520 322e 3020 c2a9 2032 3032 3020 5261  e 2.0 .. 2020 Ra
+00096ee0: 6d20 5365 7368 6164 7269 0a20 2020 2020  m Seshadri.     
+00096ef0: 2020 200a 2020 2020 2020 2020 2323 2044     .        ## D
+00096f00: 4953 434c 4149 4d45 520a 2020 2020 2020  ISCLAIMER.      
+00096f10: 2020 5468 6973 2070 726f 6a65 6374 2069    This project i
+00096f20: 7320 6e6f 7420 616e 206f 6666 6963 6961  s not an officia
+00096f30: 6c20 476f 6f67 6c65 2070 726f 6a65 6374  l Google project
+00096f40: 2e20 4974 2069 7320 6e6f 7420 7375 7070  . It is not supp
+00096f50: 6f72 7465 6420 6279 2047 6f6f 676c 6520  orted by Google 
+00096f60: 616e 6420 476f 6f67 6c65 2073 7065 6369  and Google speci
+00096f70: 6669 6361 6c6c 7920 6469 7363 6c61 696d  fically disclaim
+00096f80: 7320 616c 6c20 7761 7272 616e 7469 6573  s all warranties
+00096f90: 2061 7320 746f 2069 7473 2071 7561 6c69   as to its quali
+00096fa0: 7479 2c20 6d65 7263 6861 6e74 6162 696c  ty, merchantabil
+00096fb0: 6974 792c 206f 7220 6669 746e 6573 7320  ity, or fitness 
+00096fc0: 666f 7220 6120 7061 7274 6963 756c 6172  for a particular
+00096fd0: 2070 7572 706f 7365 2e0a 2020 2020 2020   purpose..      
+00096fe0: 2020 0a50 6c61 7466 6f72 6d3a 2055 4e4b    .Platform: UNK
+00096ff0: 4e4f 574e 0a43 6c61 7373 6966 6965 723a  NOWN.Classifier:
+00097000: 2050 726f 6772 616d 6d69 6e67 204c 616e   Programming Lan
+00097010: 6775 6167 6520 3a3a 2050 7974 686f 6e20  guage :: Python 
+00097020: 3a3a 2033 0a43 6c61 7373 6966 6965 723a  :: 3.Classifier:
+00097030: 204f 7065 7261 7469 6e67 2053 7973 7465   Operating Syste
+00097040: 6d20 3a3a 204f 5320 496e 6465 7065 6e64  m :: OS Independ
+00097050: 656e 740a 4465 7363 7269 7074 696f 6e2d  ent.Description-
+00097060: 436f 6e74 656e 742d 5479 7065 3a20 7465  Content-Type: te
+00097070: 7874 2f6d 6172 6b64 6f77 6e0a 0000 0000  xt/markdown.....
+00097080: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+00097090: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+000970a0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+000970b0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+000970c0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+000970d0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+000970e0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+000970f0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+00097100: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+00097110: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+00097120: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+00097130: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+00097140: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+00097150: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+00097160: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+00097170: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+00097180: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+00097190: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+000971a0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+000971b0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+000971c0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+000971d0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+000971e0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+000971f0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
 00097200: 2e2f 2e2f 4050 6178 4865 6164 6572 0000  ././@PaxHeader..
 00097210: 0000 0000 0000 0000 0000 0000 0000 0000  ................
 00097220: 0000 0000 0000 0000 0000 0000 0000 0000  ................
 00097230: 0000 0000 0000 0000 0000 0000 0000 0000  ................
 00097240: 0000 0000 0000 0000 0000 0000 0000 0000  ................
 00097250: 0000 0000 0000 0000 0000 0000 0000 0000  ................
 00097260: 0000 0000 3030 3030 3030 3000 3030 3030  ....0000000.0000
@@ -38714,16 +38714,16 @@
 00097390: 0000 0000 0000 0000 0000 0000 0000 0000  ................
 000973a0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
 000973b0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
 000973c0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
 000973d0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
 000973e0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
 000973f0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-00097400: 3232 206d 7469 6d65 3d31 3638 3139 3033  22 mtime=1681903
-00097410: 3937 372e 300a 0000 0000 0000 0000 0000  977.0...........
+00097400: 3232 206d 7469 6d65 3d31 3638 3433 3238  22 mtime=1684328
+00097410: 3631 352e 300a 0000 0000 0000 0000 0000  615.0...........
 00097420: 0000 0000 0000 0000 0000 0000 0000 0000  ................
 00097430: 0000 0000 0000 0000 0000 0000 0000 0000  ................
 00097440: 0000 0000 0000 0000 0000 0000 0000 0000  ................
 00097450: 0000 0000 0000 0000 0000 0000 0000 0000  ................
 00097460: 0000 0000 0000 0000 0000 0000 0000 0000  ................
 00097470: 0000 0000 0000 0000 0000 0000 0000 0000  ................
 00097480: 0000 0000 0000 0000 0000 0000 0000 0000  ................
@@ -38746,24 +38746,24 @@
 00097590: 0000 0000 0000 0000 0000 0000 0000 0000  ................
 000975a0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
 000975b0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
 000975c0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
 000975d0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
 000975e0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
 000975f0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-00097600: 6175 746f 7669 6d6c 2d30 2e31 2e37 3134  autoviml-0.1.714
+00097600: 6175 746f 7669 6d6c 2d30 2e31 2e37 3135  autoviml-0.1.715
 00097610: 2f61 7574 6f76 696d 6c2e 6567 672d 696e  /autoviml.egg-in
-00097620: 666f 2f64 6570 656e 6465 6e63 795f 6c69  fo/dependency_li
-00097630: 6e6b 732e 7478 7400 0000 0000 0000 0000  nks.txt.........
+00097620: 666f 2f53 4f55 5243 4553 2e74 7874 0000  fo/SOURCES.txt..
+00097630: 0000 0000 0000 0000 0000 0000 0000 0000  ................
 00097640: 0000 0000 0000 0000 0000 0000 0000 0000  ................
 00097650: 0000 0000 0000 0000 0000 0000 0000 0000  ................
 00097660: 0000 0000 3030 3030 3737 3700 3030 3031  ....0000777.0001
 00097670: 3735 3000 3030 3031 3735 3000 3030 3030  750.0001750.0000
-00097680: 3030 3030 3030 3100 3030 3030 3030 3030  0000001.00000000
-00097690: 3030 3000 3032 3235 3134 0020 3000 0000  000.022514. 0...
+00097680: 3030 3030 3737 3500 3030 3030 3030 3030  0000775.00000000
+00097690: 3030 3000 3032 3033 3434 0020 3000 0000  000.020344. 0...
 000976a0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
 000976b0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
 000976c0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
 000976d0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
 000976e0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
 000976f0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
 00097700: 0075 7374 6172 0030 3072 616d 0000 0000  .ustar.00ram....
@@ -38778,46 +38778,46 @@
 00097790: 0000 0000 0000 0000 0000 0000 0000 0000  ................
 000977a0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
 000977b0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
 000977c0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
 000977d0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
 000977e0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
 000977f0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-00097800: 0a00 0000 0000 0000 0000 0000 0000 0000  ................
-00097810: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-00097820: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-00097830: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-00097840: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-00097850: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-00097860: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-00097870: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-00097880: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-00097890: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-000978a0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-000978b0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-000978c0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-000978d0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-000978e0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-000978f0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-00097900: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-00097910: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-00097920: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-00097930: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-00097940: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-00097950: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-00097960: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-00097970: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-00097980: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-00097990: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-000979a0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-000979b0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-000979c0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-000979d0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-000979e0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-000979f0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+00097800: 5245 4144 4d45 2e6d 640a 7365 7475 702e  README.md.setup.
+00097810: 6366 670a 7365 7475 702e 7079 0a61 7574  cfg.setup.py.aut
+00097820: 6f76 696d 6c2f 4175 746f 5f4e 4c50 2e70  oviml/Auto_NLP.p
+00097830: 790a 6175 746f 7669 6d6c 2f41 7574 6f5f  y.autoviml/Auto_
+00097840: 5669 4d4c 2e70 790a 6175 746f 7669 6d6c  ViML.py.autoviml
+00097850: 2f51 7569 636b 4d4c 5f45 6e73 656d 626c  /QuickML_Ensembl
+00097860: 696e 672e 7079 0a61 7574 6f76 696d 6c2f  ing.py.autoviml/
+00097870: 5175 6963 6b4d 4c5f 5374 6163 6b69 6e67  QuickML_Stacking
+00097880: 2e70 790a 6175 746f 7669 6d6c 2f54 7261  .py.autoviml/Tra
+00097890: 6e73 666f 726d 5f4b 4d5f 4665 6174 7572  nsform_KM_Featur
+000978a0: 6573 2e70 790a 6175 746f 7669 6d6c 2f5f  es.py.autoviml/_
+000978b0: 5f69 6e69 745f 5f2e 7079 0a61 7574 6f76  _init__.py.autov
+000978c0: 696d 6c2f 5f5f 7665 7273 696f 6e5f 5f2e  iml/__version__.
+000978d0: 7079 0a61 7574 6f76 696d 6c2f 636c 6173  py.autoviml/clas
+000978e0: 7369 6679 5f6d 6574 686f 642e 7079 0a61  sify_method.py.a
+000978f0: 7574 6f76 696d 6c2f 6375 7374 6f6d 5f73  utoviml/custom_s
+00097900: 636f 7265 732e 7079 0a61 7574 6f76 696d  cores.py.autovim
+00097910: 6c2f 6375 7374 6f6d 5f73 636f 7265 735f  l/custom_scores_
+00097920: 484f 2e70 790a 6175 746f 7669 6d6c 2f66  HO.py.autoviml/f
+00097930: 6561 7475 7265 5f65 6e67 696e 6565 7269  eature_engineeri
+00097940: 6e67 2e70 790a 6175 746f 7669 6d6c 2f73  ng.py.autoviml/s
+00097950: 756c 6f76 5f6d 6574 686f 642e 7079 0a61  ulov_method.py.a
+00097960: 7574 6f76 696d 6c2e 6567 672d 696e 666f  utoviml.egg-info
+00097970: 2f50 4b47 2d49 4e46 4f0a 6175 746f 7669  /PKG-INFO.autovi
+00097980: 6d6c 2e65 6767 2d69 6e66 6f2f 534f 5552  ml.egg-info/SOUR
+00097990: 4345 532e 7478 740a 6175 746f 7669 6d6c  CES.txt.autoviml
+000979a0: 2e65 6767 2d69 6e66 6f2f 6465 7065 6e64  .egg-info/depend
+000979b0: 656e 6379 5f6c 696e 6b73 2e74 7874 0a61  ency_links.txt.a
+000979c0: 7574 6f76 696d 6c2e 6567 672d 696e 666f  utoviml.egg-info
+000979d0: 2f72 6571 7569 7265 732e 7478 740a 6175  /requires.txt.au
+000979e0: 746f 7669 6d6c 2e65 6767 2d69 6e66 6f2f  toviml.egg-info/
+000979f0: 746f 705f 6c65 7665 6c2e 7478 7400 0000  top_level.txt...
 00097a00: 2e2f 2e2f 4050 6178 4865 6164 6572 0000  ././@PaxHeader..
 00097a10: 0000 0000 0000 0000 0000 0000 0000 0000  ................
 00097a20: 0000 0000 0000 0000 0000 0000 0000 0000  ................
 00097a30: 0000 0000 0000 0000 0000 0000 0000 0000  ................
 00097a40: 0000 0000 0000 0000 0000 0000 0000 0000  ................
 00097a50: 0000 0000 0000 0000 0000 0000 0000 0000  ................
 00097a60: 0000 0000 3030 3030 3030 3000 3030 3030  ....0000000.0000
@@ -38842,16 +38842,16 @@
 00097b90: 0000 0000 0000 0000 0000 0000 0000 0000  ................
 00097ba0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
 00097bb0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
 00097bc0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
 00097bd0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
 00097be0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
 00097bf0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-00097c00: 3232 206d 7469 6d65 3d31 3638 3139 3033  22 mtime=1681903
-00097c10: 3937 372e 300a 0000 0000 0000 0000 0000  977.0...........
+00097c00: 3232 206d 7469 6d65 3d31 3638 3433 3238  22 mtime=1684328
+00097c10: 3631 342e 300a 0000 0000 0000 0000 0000  614.0...........
 00097c20: 0000 0000 0000 0000 0000 0000 0000 0000  ................
 00097c30: 0000 0000 0000 0000 0000 0000 0000 0000  ................
 00097c40: 0000 0000 0000 0000 0000 0000 0000 0000  ................
 00097c50: 0000 0000 0000 0000 0000 0000 0000 0000  ................
 00097c60: 0000 0000 0000 0000 0000 0000 0000 0000  ................
 00097c70: 0000 0000 0000 0000 0000 0000 0000 0000  ................
 00097c80: 0000 0000 0000 0000 0000 0000 0000 0000  ................
@@ -38874,24 +38874,24 @@
 00097d90: 0000 0000 0000 0000 0000 0000 0000 0000  ................
 00097da0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
 00097db0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
 00097dc0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
 00097dd0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
 00097de0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
 00097df0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-00097e00: 6175 746f 7669 6d6c 2d30 2e31 2e37 3134  autoviml-0.1.714
+00097e00: 6175 746f 7669 6d6c 2d30 2e31 2e37 3135  autoviml-0.1.715
 00097e10: 2f61 7574 6f76 696d 6c2e 6567 672d 696e  /autoviml.egg-in
-00097e20: 666f 2f72 6571 7569 7265 732e 7478 7400  fo/requires.txt.
-00097e30: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+00097e20: 666f 2f64 6570 656e 6465 6e63 795f 6c69  fo/dependency_li
+00097e30: 6e6b 732e 7478 7400 0000 0000 0000 0000  nks.txt.........
 00097e40: 0000 0000 0000 0000 0000 0000 0000 0000  ................
 00097e50: 0000 0000 0000 0000 0000 0000 0000 0000  ................
 00097e60: 0000 0000 3030 3030 3737 3700 3030 3031  ....0000777.0001
 00097e70: 3735 3000 3030 3031 3735 3000 3030 3030  750.0001750.0000
-00097e80: 3030 3030 3336 3700 3030 3030 3030 3030  0000367.00000000
-00097e90: 3030 3000 3032 3130 3534 0020 3000 0000  000.021054. 0...
+00097e80: 3030 3030 3030 3100 3030 3030 3030 3030  0000001.00000000
+00097e90: 3030 3000 3032 3235 3135 0020 3000 0000  000.022515. 0...
 00097ea0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
 00097eb0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
 00097ec0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
 00097ed0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
 00097ee0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
 00097ef0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
 00097f00: 0075 7374 6172 0030 3072 616d 0000 0000  .ustar.00ram....
@@ -38906,30 +38906,30 @@
 00097f90: 0000 0000 0000 0000 0000 0000 0000 0000  ................
 00097fa0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
 00097fb0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
 00097fc0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
 00097fd0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
 00097fe0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
 00097ff0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-00098000: 6265 6175 7469 6675 6c73 6f75 7034 0a63  beautifulsoup4.c
-00098010: 6174 626f 6f73 740a 656d 6f6a 690a 696d  atboost.emoji.im
-00098020: 6261 6c61 6e63 6564 2d6c 6561 726e 3e3d  balanced-learn>=
-00098030: 302e 3130 2e31 0a69 6d62 616c 616e 6365  0.10.1.imbalance
-00098040: 645f 656e 7365 6d62 6c65 3e3d 302e 322e  d_ensemble>=0.2.
-00098050: 300a 6970 7974 686f 6e0a 6a75 7079 7465  0.ipython.jupyte
-00098060: 720a 6c69 6768 7467 626d 3e3d 332e 302e  r.lightgbm>=3.0.
-00098070: 300a 6d61 7470 6c6f 746c 6962 0a6e 6c74  0.matplotlib.nlt
-00098080: 6b0a 6e75 6d70 797e 3d31 2e31 392e 350a  k.numpy~=1.19.5.
-00098090: 7061 6e64 6173 3e3d 312e 312e 330a 7265  pandas>=1.1.3.re
-000980a0: 6765 780a 7363 696b 6974 2d6c 6561 726e  gex.scikit-learn
-000980b0: 7e3d 312e 310a 7365 6162 6f72 6e0a 7368  ~=1.1.seaborn.sh
-000980c0: 6170 3e3d 302e 3336 2e30 0a74 6578 7462  ap>=0.36.0.textb
-000980d0: 6c6f 620a 7661 6465 7253 656e 7469 6d65  lob.vaderSentime
-000980e0: 6e74 0a78 6762 6f6f 7374 7e3d 312e 312e  nt.xgboost~=1.1.
-000980f0: 310a 786c 7264 0a00 0000 0000 0000 0000  1.xlrd..........
+00098000: 0a00 0000 0000 0000 0000 0000 0000 0000  ................
+00098010: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+00098020: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+00098030: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+00098040: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+00098050: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+00098060: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+00098070: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+00098080: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+00098090: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+000980a0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+000980b0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+000980c0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+000980d0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+000980e0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+000980f0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
 00098100: 0000 0000 0000 0000 0000 0000 0000 0000  ................
 00098110: 0000 0000 0000 0000 0000 0000 0000 0000  ................
 00098120: 0000 0000 0000 0000 0000 0000 0000 0000  ................
 00098130: 0000 0000 0000 0000 0000 0000 0000 0000  ................
 00098140: 0000 0000 0000 0000 0000 0000 0000 0000  ................
 00098150: 0000 0000 0000 0000 0000 0000 0000 0000  ................
 00098160: 0000 0000 0000 0000 0000 0000 0000 0000  ................
@@ -38970,16 +38970,16 @@
 00098390: 0000 0000 0000 0000 0000 0000 0000 0000  ................
 000983a0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
 000983b0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
 000983c0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
 000983d0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
 000983e0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
 000983f0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-00098400: 3232 206d 7469 6d65 3d31 3638 3139 3033  22 mtime=1681903
-00098410: 3937 372e 300a 0000 0000 0000 0000 0000  977.0...........
+00098400: 3232 206d 7469 6d65 3d31 3638 3433 3238  22 mtime=1684328
+00098410: 3631 342e 300a 0000 0000 0000 0000 0000  614.0...........
 00098420: 0000 0000 0000 0000 0000 0000 0000 0000  ................
 00098430: 0000 0000 0000 0000 0000 0000 0000 0000  ................
 00098440: 0000 0000 0000 0000 0000 0000 0000 0000  ................
 00098450: 0000 0000 0000 0000 0000 0000 0000 0000  ................
 00098460: 0000 0000 0000 0000 0000 0000 0000 0000  ................
 00098470: 0000 0000 0000 0000 0000 0000 0000 0000  ................
 00098480: 0000 0000 0000 0000 0000 0000 0000 0000  ................
@@ -39002,24 +39002,24 @@
 00098590: 0000 0000 0000 0000 0000 0000 0000 0000  ................
 000985a0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
 000985b0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
 000985c0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
 000985d0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
 000985e0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
 000985f0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-00098600: 6175 746f 7669 6d6c 2d30 2e31 2e37 3134  autoviml-0.1.714
+00098600: 6175 746f 7669 6d6c 2d30 2e31 2e37 3135  autoviml-0.1.715
 00098610: 2f61 7574 6f76 696d 6c2e 6567 672d 696e  /autoviml.egg-in
-00098620: 666f 2f74 6f70 5f6c 6576 656c 2e74 7874  fo/top_level.txt
+00098620: 666f 2f72 6571 7569 7265 732e 7478 7400  fo/requires.txt.
 00098630: 0000 0000 0000 0000 0000 0000 0000 0000  ................
 00098640: 0000 0000 0000 0000 0000 0000 0000 0000  ................
 00098650: 0000 0000 0000 0000 0000 0000 0000 0000  ................
 00098660: 0000 0000 3030 3030 3737 3700 3030 3031  ....0000777.0001
 00098670: 3735 3000 3030 3031 3735 3000 3030 3030  750.0001750.0000
-00098680: 3030 3030 3031 3100 3030 3030 3030 3030  0000011.00000000
-00098690: 3030 3000 3032 3131 3730 0020 3000 0000  000.021170. 0...
+00098680: 3030 3030 3336 3700 3030 3030 3030 3030  0000367.00000000
+00098690: 3030 3000 3032 3130 3535 0020 3000 0000  000.021055. 0...
 000986a0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
 000986b0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
 000986c0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
 000986d0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
 000986e0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
 000986f0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
 00098700: 0075 7374 6172 0030 3072 616d 0000 0000  .ustar.00ram....
@@ -39034,30 +39034,30 @@
 00098790: 0000 0000 0000 0000 0000 0000 0000 0000  ................
 000987a0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
 000987b0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
 000987c0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
 000987d0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
 000987e0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
 000987f0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-00098800: 6175 746f 7669 6d6c 0a00 0000 0000 0000  autoviml........
-00098810: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-00098820: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-00098830: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-00098840: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-00098850: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-00098860: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-00098870: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-00098880: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-00098890: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-000988a0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-000988b0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-000988c0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-000988d0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-000988e0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-000988f0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+00098800: 6265 6175 7469 6675 6c73 6f75 7034 0a63  beautifulsoup4.c
+00098810: 6174 626f 6f73 740a 656d 6f6a 690a 696d  atboost.emoji.im
+00098820: 6261 6c61 6e63 6564 2d6c 6561 726e 3e3d  balanced-learn>=
+00098830: 302e 3130 2e31 0a69 6d62 616c 616e 6365  0.10.1.imbalance
+00098840: 645f 656e 7365 6d62 6c65 3e3d 302e 322e  d_ensemble>=0.2.
+00098850: 300a 6970 7974 686f 6e0a 6a75 7079 7465  0.ipython.jupyte
+00098860: 720a 6c69 6768 7467 626d 3e3d 332e 302e  r.lightgbm>=3.0.
+00098870: 300a 6d61 7470 6c6f 746c 6962 0a6e 6c74  0.matplotlib.nlt
+00098880: 6b0a 6e75 6d70 797e 3d31 2e31 392e 350a  k.numpy~=1.19.5.
+00098890: 7061 6e64 6173 3e3d 312e 312e 330a 7265  pandas>=1.1.3.re
+000988a0: 6765 780a 7363 696b 6974 2d6c 6561 726e  gex.scikit-learn
+000988b0: 7e3d 312e 310a 7365 6162 6f72 6e0a 7368  ~=1.1.seaborn.sh
+000988c0: 6170 3e3d 302e 3336 2e30 0a74 6578 7462  ap>=0.36.0.textb
+000988d0: 6c6f 620a 7661 6465 7253 656e 7469 6d65  lob.vaderSentime
+000988e0: 6e74 0a78 6762 6f6f 7374 7e3d 312e 312e  nt.xgboost~=1.1.
+000988f0: 310a 786c 7264 0a00 0000 0000 0000 0000  1.xlrd..........
 00098900: 0000 0000 0000 0000 0000 0000 0000 0000  ................
 00098910: 0000 0000 0000 0000 0000 0000 0000 0000  ................
 00098920: 0000 0000 0000 0000 0000 0000 0000 0000  ................
 00098930: 0000 0000 0000 0000 0000 0000 0000 0000  ................
 00098940: 0000 0000 0000 0000 0000 0000 0000 0000  ................
 00098950: 0000 0000 0000 0000 0000 0000 0000 0000  ................
 00098960: 0000 0000 0000 0000 0000 0000 0000 0000  ................
@@ -39074,16 +39074,16 @@
 00098a10: 0000 0000 0000 0000 0000 0000 0000 0000  ................
 00098a20: 0000 0000 0000 0000 0000 0000 0000 0000  ................
 00098a30: 0000 0000 0000 0000 0000 0000 0000 0000  ................
 00098a40: 0000 0000 0000 0000 0000 0000 0000 0000  ................
 00098a50: 0000 0000 0000 0000 0000 0000 0000 0000  ................
 00098a60: 0000 0000 3030 3030 3030 3000 3030 3030  ....0000000.0000
 00098a70: 3030 3000 3030 3030 3030 3000 3030 3030  000.0000000.0000
-00098a80: 3030 3030 3033 3400 3030 3030 3030 3030  0000034.00000000
-00098a90: 3030 3000 3031 3134 3532 0020 7800 0000  000.011452. x...
+00098a80: 3030 3030 3032 3600 3030 3030 3030 3030  0000026.00000000
+00098a90: 3030 3000 3031 3134 3533 0020 7800 0000  000.011453. x...
 00098aa0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
 00098ab0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
 00098ac0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
 00098ad0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
 00098ae0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
 00098af0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
 00098b00: 0075 7374 6172 0030 3000 0000 0000 0000  .ustar.00.......
@@ -39098,16 +39098,16 @@
 00098b90: 0000 0000 0000 0000 0000 0000 0000 0000  ................
 00098ba0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
 00098bb0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
 00098bc0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
 00098bd0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
 00098be0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
 00098bf0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-00098c00: 3238 206d 7469 6d65 3d31 3638 3139 3033  28 mtime=1681903
-00098c10: 3937 382e 3731 3832 3532 370a 0000 0000  978.7182527.....
+00098c00: 3232 206d 7469 6d65 3d31 3638 3433 3238  22 mtime=1684328
+00098c10: 3631 342e 300a 0000 0000 0000 0000 0000  614.0...........
 00098c20: 0000 0000 0000 0000 0000 0000 0000 0000  ................
 00098c30: 0000 0000 0000 0000 0000 0000 0000 0000  ................
 00098c40: 0000 0000 0000 0000 0000 0000 0000 0000  ................
 00098c50: 0000 0000 0000 0000 0000 0000 0000 0000  ................
 00098c60: 0000 0000 0000 0000 0000 0000 0000 0000  ................
 00098c70: 0000 0000 0000 0000 0000 0000 0000 0000  ................
 00098c80: 0000 0000 0000 0000 0000 0000 0000 0000  ................
@@ -39130,24 +39130,24 @@
 00098d90: 0000 0000 0000 0000 0000 0000 0000 0000  ................
 00098da0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
 00098db0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
 00098dc0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
 00098dd0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
 00098de0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
 00098df0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-00098e00: 6175 746f 7669 6d6c 2d30 2e31 2e37 3134  autoviml-0.1.714
-00098e10: 2f73 6574 7570 2e63 6667 0000 0000 0000  /setup.cfg......
-00098e20: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+00098e00: 6175 746f 7669 6d6c 2d30 2e31 2e37 3135  autoviml-0.1.715
+00098e10: 2f61 7574 6f76 696d 6c2e 6567 672d 696e  /autoviml.egg-in
+00098e20: 666f 2f74 6f70 5f6c 6576 656c 2e74 7874  fo/top_level.txt
 00098e30: 0000 0000 0000 0000 0000 0000 0000 0000  ................
 00098e40: 0000 0000 0000 0000 0000 0000 0000 0000  ................
 00098e50: 0000 0000 0000 0000 0000 0000 0000 0000  ................
 00098e60: 0000 0000 3030 3030 3737 3700 3030 3031  ....0000777.0001
 00098e70: 3735 3000 3030 3031 3735 3000 3030 3030  750.0001750.0000
-00098e80: 3030 3030 3034 3600 3030 3030 3030 3030  0000046.00000000
-00098e90: 3030 3000 3031 3437 3335 0020 3000 0000  000.014735. 0...
+00098e80: 3030 3030 3031 3100 3030 3030 3030 3030  0000011.00000000
+00098e90: 3030 3000 3032 3131 3731 0020 3000 0000  000.021171. 0...
 00098ea0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
 00098eb0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
 00098ec0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
 00098ed0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
 00098ee0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
 00098ef0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
 00098f00: 0075 7374 6172 0030 3072 616d 0000 0000  .ustar.00ram....
@@ -39162,17 +39162,17 @@
 00098f90: 0000 0000 0000 0000 0000 0000 0000 0000  ................
 00098fa0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
 00098fb0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
 00098fc0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
 00098fd0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
 00098fe0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
 00098ff0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-00099000: 5b65 6767 5f69 6e66 6f5d 0a74 6167 5f62  [egg_info].tag_b
-00099010: 7569 6c64 203d 200a 7461 675f 6461 7465  uild = .tag_date
-00099020: 203d 2030 0a0a 0000 0000 0000 0000 0000   = 0............
+00099000: 6175 746f 7669 6d6c 0a00 0000 0000 0000  autoviml........
+00099010: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+00099020: 0000 0000 0000 0000 0000 0000 0000 0000  ................
 00099030: 0000 0000 0000 0000 0000 0000 0000 0000  ................
 00099040: 0000 0000 0000 0000 0000 0000 0000 0000  ................
 00099050: 0000 0000 0000 0000 0000 0000 0000 0000  ................
 00099060: 0000 0000 0000 0000 0000 0000 0000 0000  ................
 00099070: 0000 0000 0000 0000 0000 0000 0000 0000  ................
 00099080: 0000 0000 0000 0000 0000 0000 0000 0000  ................
 00099090: 0000 0000 0000 0000 0000 0000 0000 0000  ................
@@ -39202,16 +39202,16 @@
 00099210: 0000 0000 0000 0000 0000 0000 0000 0000  ................
 00099220: 0000 0000 0000 0000 0000 0000 0000 0000  ................
 00099230: 0000 0000 0000 0000 0000 0000 0000 0000  ................
 00099240: 0000 0000 0000 0000 0000 0000 0000 0000  ................
 00099250: 0000 0000 0000 0000 0000 0000 0000 0000  ................
 00099260: 0000 0000 3030 3030 3030 3000 3030 3030  ....0000000.0000
 00099270: 3030 3000 3030 3030 3030 3000 3030 3030  000.0000000.0000
-00099280: 3030 3030 3032 3600 3030 3030 3030 3030  0000026.00000000
-00099290: 3030 3000 3031 3134 3533 0020 7800 0000  000.011453. x...
+00099280: 3030 3030 3033 3400 3030 3030 3030 3030  0000034.00000000
+00099290: 3030 3000 3031 3134 3532 0020 7800 0000  000.011452. x...
 000992a0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
 000992b0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
 000992c0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
 000992d0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
 000992e0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
 000992f0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
 00099300: 0075 7374 6172 0030 3000 0000 0000 0000  .ustar.00.......
@@ -39226,16 +39226,16 @@
 00099390: 0000 0000 0000 0000 0000 0000 0000 0000  ................
 000993a0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
 000993b0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
 000993c0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
 000993d0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
 000993e0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
 000993f0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-00099400: 3232 206d 7469 6d65 3d31 3638 3139 3033  22 mtime=1681903
-00099410: 3739 392e 300a 0000 0000 0000 0000 0000  799.0...........
+00099400: 3238 206d 7469 6d65 3d31 3638 3433 3238  28 mtime=1684328
+00099410: 3631 352e 3931 3038 3639 340a 0000 0000  615.9108694.....
 00099420: 0000 0000 0000 0000 0000 0000 0000 0000  ................
 00099430: 0000 0000 0000 0000 0000 0000 0000 0000  ................
 00099440: 0000 0000 0000 0000 0000 0000 0000 0000  ................
 00099450: 0000 0000 0000 0000 0000 0000 0000 0000  ................
 00099460: 0000 0000 0000 0000 0000 0000 0000 0000  ................
 00099470: 0000 0000 0000 0000 0000 0000 0000 0000  ................
 00099480: 0000 0000 0000 0000 0000 0000 0000 0000  ................
@@ -39258,24 +39258,24 @@
 00099590: 0000 0000 0000 0000 0000 0000 0000 0000  ................
 000995a0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
 000995b0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
 000995c0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
 000995d0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
 000995e0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
 000995f0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-00099600: 6175 746f 7669 6d6c 2d30 2e31 2e37 3134  autoviml-0.1.714
-00099610: 2f73 6574 7570 2e70 7900 0000 0000 0000  /setup.py.......
+00099600: 6175 746f 7669 6d6c 2d30 2e31 2e37 3135  autoviml-0.1.715
+00099610: 2f73 6574 7570 2e63 6667 0000 0000 0000  /setup.cfg......
 00099620: 0000 0000 0000 0000 0000 0000 0000 0000  ................
 00099630: 0000 0000 0000 0000 0000 0000 0000 0000  ................
 00099640: 0000 0000 0000 0000 0000 0000 0000 0000  ................
 00099650: 0000 0000 0000 0000 0000 0000 0000 0000  ................
 00099660: 0000 0000 3030 3030 3737 3700 3030 3031  ....0000777.0001
 00099670: 3735 3000 3030 3031 3735 3000 3030 3030  750.0001750.0000
-00099680: 3030 3032 3331 3100 3030 3030 3030 3030  0002311.00000000
-00099690: 3030 3000 3031 3436 3233 0020 3000 0000  000.014623. 0...
+00099680: 3030 3030 3034 3600 3030 3030 3030 3030  0000046.00000000
+00099690: 3030 3000 3031 3437 3336 0020 3000 0000  000.014736. 0...
 000996a0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
 000996b0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
 000996c0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
 000996d0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
 000996e0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
 000996f0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
 00099700: 0075 7374 6172 0030 3072 616d 0000 0000  .ustar.00ram....
@@ -39290,91 +39290,91 @@
 00099790: 0000 0000 0000 0000 0000 0000 0000 0000  ................
 000997a0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
 000997b0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
 000997c0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
 000997d0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
 000997e0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
 000997f0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-00099800: 696d 706f 7274 2073 6574 7570 746f 6f6c  import setuptool
-00099810: 730d 0a0d 0a77 6974 6820 6f70 656e 2822  s....with open("
-00099820: 5245 4144 4d45 2e6d 6422 2c20 2272 222c  README.md", "r",
-00099830: 2065 6e63 6f64 696e 673d 2275 7466 2d38   encoding="utf-8
-00099840: 2229 2061 7320 6668 3a0d 0a20 2020 206c  ") as fh:..    l
-00099850: 6f6e 675f 6465 7363 7269 7074 696f 6e20  ong_description 
-00099860: 3d20 6668 2e72 6561 6428 290d 0a0d 0a73  = fh.read()....s
-00099870: 6574 7570 746f 6f6c 732e 7365 7475 7028  etuptools.setup(
-00099880: 0d0a 2020 2020 6e61 6d65 3d22 6175 746f  ..    name="auto
-00099890: 7669 6d6c 222c 0d0a 2020 2020 7665 7273  viml",..    vers
-000998a0: 696f 6e3d 2230 2e31 2e37 3134 222c 0d0a  ion="0.1.714",..
-000998b0: 2020 2020 6175 7468 6f72 3d22 5261 6d20      author="Ram 
-000998c0: 5365 7368 6164 7269 222c 0d0a 2020 2020  Seshadri",..    
-000998d0: 2320 6175 7468 6f72 5f65 6d61 696c 3d22  # author_email="
-000998e0: 6175 7468 6f72 4065 7861 6d70 6c65 2e63  author@example.c
-000998f0: 6f6d 222c 0d0a 2020 2020 6465 7363 7269  om",..    descri
-00099900: 7074 696f 6e3d 2241 7574 6f6d 6174 6963  ption="Automatic
-00099910: 616c 6c79 2042 7569 6c64 2056 6172 6961  ally Build Varia
-00099920: 6e74 2049 6e74 6572 7072 6574 6162 6c65  nt Interpretable
-00099930: 204d 4c20 6d6f 6465 6c73 2066 6173 7420   ML models fast 
-00099940: 2d20 6e6f 7720 7769 7468 2043 6174 426f  - now with CatBo
-00099950: 6f73 7421 222c 0d0a 2020 2020 6c6f 6e67  ost!",..    long
-00099960: 5f64 6573 6372 6970 7469 6f6e 3d6c 6f6e  _description=lon
-00099970: 675f 6465 7363 7269 7074 696f 6e2c 0d0a  g_description,..
-00099980: 2020 2020 6c6f 6e67 5f64 6573 6372 6970      long_descrip
-00099990: 7469 6f6e 5f63 6f6e 7465 6e74 5f74 7970  tion_content_typ
-000999a0: 653d 2274 6578 742f 6d61 726b 646f 776e  e="text/markdown
-000999b0: 222c 0d0a 2020 2020 6c69 6365 6e73 653d  ",..    license=
-000999c0: 2741 7061 6368 6520 4c69 6365 6e73 6520  'Apache License 
-000999d0: 322e 3027 2c0d 0a20 2020 2075 726c 3d22  2.0',..    url="
-000999e0: 6874 7470 733a 2f2f 6769 7468 7562 2e63  https://github.c
-000999f0: 6f6d 2f41 7574 6f56 694d 4c2f 4175 746f  om/AutoViML/Auto
-00099a00: 5f56 694d 4c22 2c0d 0a20 2020 2070 6163  _ViML",..    pac
-00099a10: 6b61 6765 733d 7365 7475 7074 6f6f 6c73  kages=setuptools
-00099a20: 2e66 696e 645f 7061 636b 6167 6573 2865  .find_packages(e
-00099a30: 7863 6c75 6465 3d28 2274 6573 7473 222c  xclude=("tests",
-00099a40: 2929 2c0d 0a20 2020 2069 6e73 7461 6c6c  )),..    install
-00099a50: 5f72 6571 7569 7265 733d 5b0d 0a20 2020  _requires=[..   
-00099a60: 2020 2020 2022 6e75 6d70 797e 3d31 2e31       "numpy~=1.1
-00099a70: 392e 3522 2c0d 0a20 2020 2020 2020 2022  9.5",..        "
-00099a80: 7061 6e64 6173 3e3d 312e 312e 3322 2c0d  pandas>=1.1.3",.
-00099a90: 0a20 2020 2020 2020 2022 786c 7264 222c  .        "xlrd",
-00099aa0: 0d0a 2020 2020 2020 2020 226d 6174 706c  ..        "matpl
-00099ab0: 6f74 6c69 6222 2c0d 0a20 2020 2020 2020  otlib",..       
-00099ac0: 2022 6265 6175 7469 6675 6c73 6f75 7034   "beautifulsoup4
-00099ad0: 222c 0d0a 2020 2020 2020 2020 2265 6d6f  ",..        "emo
-00099ae0: 6a69 222c 0d0a 2020 2020 2020 2020 2269  ji",..        "i
-00099af0: 7079 7468 6f6e 222c 0d0a 2020 2020 2020  python",..      
-00099b00: 2020 226a 7570 7974 6572 222c 0d0a 2020    "jupyter",..  
-00099b10: 2020 2020 2020 2273 6561 626f 726e 222c        "seaborn",
-00099b20: 0d0a 2020 2020 2020 2020 2263 6174 626f  ..        "catbo
-00099b30: 6f73 7422 2c0d 0a20 2020 2020 2020 2022  ost",..        "
-00099b40: 7465 7874 626c 6f62 222c 0d0a 2020 2020  textblob",..    
-00099b50: 2020 2020 226e 6c74 6b22 2c0d 0a20 2020      "nltk",..   
-00099b60: 2020 2020 2022 7265 6765 7822 2c0d 0a20       "regex",.. 
-00099b70: 2020 2020 2020 2022 7363 696b 6974 2d6c         "scikit-l
-00099b80: 6561 726e 7e3d 312e 3122 2c0d 0a20 2020  earn~=1.1",..   
-00099b90: 2020 2020 2022 7867 626f 6f73 747e 3d31       "xgboost~=1
-00099ba0: 2e31 2e31 222c 0d0a 2020 2020 2020 2020  .1.1",..        
-00099bb0: 2276 6164 6572 5365 6e74 696d 656e 7422  "vaderSentiment"
-00099bc0: 2c0d 0a20 2020 2020 2020 2022 696d 6261  ,..        "imba
-00099bd0: 6c61 6e63 6564 2d6c 6561 726e 3e3d 302e  lanced-learn>=0.
-00099be0: 3130 2e31 222c 0d0a 2020 2020 2020 2020  10.1",..        
-00099bf0: 2273 6861 703e 3d30 2e33 362e 3022 2c0d  "shap>=0.36.0",.
-00099c00: 0a20 2020 2020 2020 2022 696d 6261 6c61  .        "imbala
-00099c10: 6e63 6564 5f65 6e73 656d 626c 653e 3d30  nced_ensemble>=0
-00099c20: 2e32 2e30 222c 0d0a 2020 2020 2020 2020  .2.0",..        
-00099c30: 226c 6967 6874 6762 6d3e 3d33 2e30 2e30  "lightgbm>=3.0.0
-00099c40: 222c 0d0a 2020 2020 5d2c 0d0a 2020 2020  ",..    ],..    
-00099c50: 636c 6173 7369 6669 6572 733d 5b0d 0a20  classifiers=[.. 
-00099c60: 2020 2020 2020 2022 5072 6f67 7261 6d6d         "Programm
-00099c70: 696e 6720 4c61 6e67 7561 6765 203a 3a20  ing Language :: 
-00099c80: 5079 7468 6f6e 203a 3a20 3322 2c0d 0a20  Python :: 3",.. 
-00099c90: 2020 2020 2020 2022 4f70 6572 6174 696e         "Operatin
-00099ca0: 6720 5379 7374 656d 203a 3a20 4f53 2049  g System :: OS I
-00099cb0: 6e64 6570 656e 6465 6e74 222c 0d0a 2020  ndependent",..  
-00099cc0: 2020 5d2c 0d0a 290d 0a00 0000 0000 0000    ],..).........
+00099800: 5b65 6767 5f69 6e66 6f5d 0a74 6167 5f62  [egg_info].tag_b
+00099810: 7569 6c64 203d 200a 7461 675f 6461 7465  uild = .tag_date
+00099820: 203d 2030 0a0a 0000 0000 0000 0000 0000   = 0............
+00099830: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+00099840: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+00099850: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+00099860: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+00099870: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+00099880: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+00099890: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+000998a0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+000998b0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+000998c0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+000998d0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+000998e0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+000998f0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+00099900: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+00099910: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+00099920: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+00099930: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+00099940: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+00099950: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+00099960: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+00099970: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+00099980: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+00099990: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+000999a0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+000999b0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+000999c0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+000999d0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+000999e0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+000999f0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+00099a00: 2e2f 2e2f 4050 6178 4865 6164 6572 0000  ././@PaxHeader..
+00099a10: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+00099a20: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+00099a30: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+00099a40: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+00099a50: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+00099a60: 0000 0000 3030 3030 3030 3000 3030 3030  ....0000000.0000
+00099a70: 3030 3000 3030 3030 3030 3000 3030 3030  000.0000000.0000
+00099a80: 3030 3030 3032 3600 3030 3030 3030 3030  0000026.00000000
+00099a90: 3030 3000 3031 3134 3533 0020 7800 0000  000.011453. x...
+00099aa0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+00099ab0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+00099ac0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+00099ad0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+00099ae0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+00099af0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+00099b00: 0075 7374 6172 0030 3000 0000 0000 0000  .ustar.00.......
+00099b10: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+00099b20: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+00099b30: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+00099b40: 0000 0000 0000 0000 0030 3030 3030 3030  .........0000000
+00099b50: 0030 3030 3030 3030 0000 0000 0000 0000  .0000000........
+00099b60: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+00099b70: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+00099b80: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+00099b90: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+00099ba0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+00099bb0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+00099bc0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+00099bd0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+00099be0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+00099bf0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+00099c00: 3232 206d 7469 6d65 3d31 3638 3433 3237  22 mtime=1684327
+00099c10: 3138 392e 300a 0000 0000 0000 0000 0000  189.0...........
+00099c20: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+00099c30: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+00099c40: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+00099c50: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+00099c60: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+00099c70: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+00099c80: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+00099c90: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+00099ca0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+00099cb0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+00099cc0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
 00099cd0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
 00099ce0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
 00099cf0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
 00099d00: 0000 0000 0000 0000 0000 0000 0000 0000  ................
 00099d10: 0000 0000 0000 0000 0000 0000 0000 0000  ................
 00099d20: 0000 0000 0000 0000 0000 0000 0000 0000  ................
 00099d30: 0000 0000 0000 0000 0000 0000 0000 0000  ................
@@ -39386,123 +39386,123 @@
 00099d90: 0000 0000 0000 0000 0000 0000 0000 0000  ................
 00099da0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
 00099db0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
 00099dc0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
 00099dd0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
 00099de0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
 00099df0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-00099e00: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-00099e10: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+00099e00: 6175 746f 7669 6d6c 2d30 2e31 2e37 3135  autoviml-0.1.715
+00099e10: 2f73 6574 7570 2e70 7900 0000 0000 0000  /setup.py.......
 00099e20: 0000 0000 0000 0000 0000 0000 0000 0000  ................
 00099e30: 0000 0000 0000 0000 0000 0000 0000 0000  ................
 00099e40: 0000 0000 0000 0000 0000 0000 0000 0000  ................
 00099e50: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-00099e60: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-00099e70: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-00099e80: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-00099e90: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+00099e60: 0000 0000 3030 3030 3737 3700 3030 3031  ....0000777.0001
+00099e70: 3735 3000 3030 3031 3735 3000 3030 3030  750.0001750.0000
+00099e80: 3030 3032 3331 3100 3030 3030 3030 3030  0002311.00000000
+00099e90: 3030 3000 3031 3436 3234 0020 3000 0000  000.014624. 0...
 00099ea0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
 00099eb0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
 00099ec0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
 00099ed0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
 00099ee0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
 00099ef0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-00099f00: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+00099f00: 0075 7374 6172 0030 3072 616d 0000 0000  .ustar.00ram....
 00099f10: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-00099f20: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+00099f20: 0000 0000 0000 0000 0072 616d 0000 0000  .........ram....
 00099f30: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-00099f40: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-00099f50: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+00099f40: 0000 0000 0000 0000 0030 3030 3030 3030  .........0000000
+00099f50: 0030 3030 3030 3030 0000 0000 0000 0000  .0000000........
 00099f60: 0000 0000 0000 0000 0000 0000 0000 0000  ................
 00099f70: 0000 0000 0000 0000 0000 0000 0000 0000  ................
 00099f80: 0000 0000 0000 0000 0000 0000 0000 0000  ................
 00099f90: 0000 0000 0000 0000 0000 0000 0000 0000  ................
 00099fa0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
 00099fb0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
 00099fc0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
 00099fd0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
 00099fe0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
 00099ff0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-0009a000: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-0009a010: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-0009a020: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-0009a030: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-0009a040: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-0009a050: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-0009a060: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-0009a070: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-0009a080: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-0009a090: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-0009a0a0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-0009a0b0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-0009a0c0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-0009a0d0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-0009a0e0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-0009a0f0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-0009a100: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-0009a110: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-0009a120: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-0009a130: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-0009a140: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-0009a150: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-0009a160: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-0009a170: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-0009a180: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-0009a190: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-0009a1a0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-0009a1b0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-0009a1c0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-0009a1d0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-0009a1e0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-0009a1f0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-0009a200: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-0009a210: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-0009a220: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-0009a230: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-0009a240: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-0009a250: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-0009a260: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-0009a270: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-0009a280: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-0009a290: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-0009a2a0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-0009a2b0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-0009a2c0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-0009a2d0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-0009a2e0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-0009a2f0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-0009a300: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-0009a310: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-0009a320: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-0009a330: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-0009a340: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-0009a350: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-0009a360: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-0009a370: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-0009a380: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-0009a390: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-0009a3a0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-0009a3b0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-0009a3c0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-0009a3d0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-0009a3e0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-0009a3f0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-0009a400: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-0009a410: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-0009a420: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-0009a430: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-0009a440: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-0009a450: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-0009a460: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-0009a470: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-0009a480: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-0009a490: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-0009a4a0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-0009a4b0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-0009a4c0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+0009a000: 696d 706f 7274 2073 6574 7570 746f 6f6c  import setuptool
+0009a010: 730d 0a0d 0a77 6974 6820 6f70 656e 2822  s....with open("
+0009a020: 5245 4144 4d45 2e6d 6422 2c20 2272 222c  README.md", "r",
+0009a030: 2065 6e63 6f64 696e 673d 2275 7466 2d38   encoding="utf-8
+0009a040: 2229 2061 7320 6668 3a0d 0a20 2020 206c  ") as fh:..    l
+0009a050: 6f6e 675f 6465 7363 7269 7074 696f 6e20  ong_description 
+0009a060: 3d20 6668 2e72 6561 6428 290d 0a0d 0a73  = fh.read()....s
+0009a070: 6574 7570 746f 6f6c 732e 7365 7475 7028  etuptools.setup(
+0009a080: 0d0a 2020 2020 6e61 6d65 3d22 6175 746f  ..    name="auto
+0009a090: 7669 6d6c 222c 0d0a 2020 2020 7665 7273  viml",..    vers
+0009a0a0: 696f 6e3d 2230 2e31 2e37 3135 222c 0d0a  ion="0.1.715",..
+0009a0b0: 2020 2020 6175 7468 6f72 3d22 5261 6d20      author="Ram 
+0009a0c0: 5365 7368 6164 7269 222c 0d0a 2020 2020  Seshadri",..    
+0009a0d0: 2320 6175 7468 6f72 5f65 6d61 696c 3d22  # author_email="
+0009a0e0: 6175 7468 6f72 4065 7861 6d70 6c65 2e63  author@example.c
+0009a0f0: 6f6d 222c 0d0a 2020 2020 6465 7363 7269  om",..    descri
+0009a100: 7074 696f 6e3d 2241 7574 6f6d 6174 6963  ption="Automatic
+0009a110: 616c 6c79 2042 7569 6c64 2056 6172 6961  ally Build Varia
+0009a120: 6e74 2049 6e74 6572 7072 6574 6162 6c65  nt Interpretable
+0009a130: 204d 4c20 6d6f 6465 6c73 2066 6173 7420   ML models fast 
+0009a140: 2d20 6e6f 7720 7769 7468 2043 6174 426f  - now with CatBo
+0009a150: 6f73 7421 222c 0d0a 2020 2020 6c6f 6e67  ost!",..    long
+0009a160: 5f64 6573 6372 6970 7469 6f6e 3d6c 6f6e  _description=lon
+0009a170: 675f 6465 7363 7269 7074 696f 6e2c 0d0a  g_description,..
+0009a180: 2020 2020 6c6f 6e67 5f64 6573 6372 6970      long_descrip
+0009a190: 7469 6f6e 5f63 6f6e 7465 6e74 5f74 7970  tion_content_typ
+0009a1a0: 653d 2274 6578 742f 6d61 726b 646f 776e  e="text/markdown
+0009a1b0: 222c 0d0a 2020 2020 6c69 6365 6e73 653d  ",..    license=
+0009a1c0: 2741 7061 6368 6520 4c69 6365 6e73 6520  'Apache License 
+0009a1d0: 322e 3027 2c0d 0a20 2020 2075 726c 3d22  2.0',..    url="
+0009a1e0: 6874 7470 733a 2f2f 6769 7468 7562 2e63  https://github.c
+0009a1f0: 6f6d 2f41 7574 6f56 694d 4c2f 4175 746f  om/AutoViML/Auto
+0009a200: 5f56 694d 4c22 2c0d 0a20 2020 2070 6163  _ViML",..    pac
+0009a210: 6b61 6765 733d 7365 7475 7074 6f6f 6c73  kages=setuptools
+0009a220: 2e66 696e 645f 7061 636b 6167 6573 2865  .find_packages(e
+0009a230: 7863 6c75 6465 3d28 2274 6573 7473 222c  xclude=("tests",
+0009a240: 2929 2c0d 0a20 2020 2069 6e73 7461 6c6c  )),..    install
+0009a250: 5f72 6571 7569 7265 733d 5b0d 0a20 2020  _requires=[..   
+0009a260: 2020 2020 2022 6e75 6d70 797e 3d31 2e31       "numpy~=1.1
+0009a270: 392e 3522 2c0d 0a20 2020 2020 2020 2022  9.5",..        "
+0009a280: 7061 6e64 6173 3e3d 312e 312e 3322 2c0d  pandas>=1.1.3",.
+0009a290: 0a20 2020 2020 2020 2022 786c 7264 222c  .        "xlrd",
+0009a2a0: 0d0a 2020 2020 2020 2020 226d 6174 706c  ..        "matpl
+0009a2b0: 6f74 6c69 6222 2c0d 0a20 2020 2020 2020  otlib",..       
+0009a2c0: 2022 6265 6175 7469 6675 6c73 6f75 7034   "beautifulsoup4
+0009a2d0: 222c 0d0a 2020 2020 2020 2020 2265 6d6f  ",..        "emo
+0009a2e0: 6a69 222c 0d0a 2020 2020 2020 2020 2269  ji",..        "i
+0009a2f0: 7079 7468 6f6e 222c 0d0a 2020 2020 2020  python",..      
+0009a300: 2020 226a 7570 7974 6572 222c 0d0a 2020    "jupyter",..  
+0009a310: 2020 2020 2020 2273 6561 626f 726e 222c        "seaborn",
+0009a320: 0d0a 2020 2020 2020 2020 2263 6174 626f  ..        "catbo
+0009a330: 6f73 7422 2c0d 0a20 2020 2020 2020 2022  ost",..        "
+0009a340: 7465 7874 626c 6f62 222c 0d0a 2020 2020  textblob",..    
+0009a350: 2020 2020 226e 6c74 6b22 2c0d 0a20 2020      "nltk",..   
+0009a360: 2020 2020 2022 7265 6765 7822 2c0d 0a20       "regex",.. 
+0009a370: 2020 2020 2020 2022 7363 696b 6974 2d6c         "scikit-l
+0009a380: 6561 726e 7e3d 312e 3122 2c0d 0a20 2020  earn~=1.1",..   
+0009a390: 2020 2020 2022 7867 626f 6f73 747e 3d31       "xgboost~=1
+0009a3a0: 2e31 2e31 222c 0d0a 2020 2020 2020 2020  .1.1",..        
+0009a3b0: 2276 6164 6572 5365 6e74 696d 656e 7422  "vaderSentiment"
+0009a3c0: 2c0d 0a20 2020 2020 2020 2022 696d 6261  ,..        "imba
+0009a3d0: 6c61 6e63 6564 2d6c 6561 726e 3e3d 302e  lanced-learn>=0.
+0009a3e0: 3130 2e31 222c 0d0a 2020 2020 2020 2020  10.1",..        
+0009a3f0: 2273 6861 703e 3d30 2e33 362e 3022 2c0d  "shap>=0.36.0",.
+0009a400: 0a20 2020 2020 2020 2022 696d 6261 6c61  .        "imbala
+0009a410: 6e63 6564 5f65 6e73 656d 626c 653e 3d30  nced_ensemble>=0
+0009a420: 2e32 2e30 222c 0d0a 2020 2020 2020 2020  .2.0",..        
+0009a430: 226c 6967 6874 6762 6d3e 3d33 2e30 2e30  "lightgbm>=3.0.0
+0009a440: 222c 0d0a 2020 2020 5d2c 0d0a 2020 2020  ",..    ],..    
+0009a450: 636c 6173 7369 6669 6572 733d 5b0d 0a20  classifiers=[.. 
+0009a460: 2020 2020 2020 2022 5072 6f67 7261 6d6d         "Programm
+0009a470: 696e 6720 4c61 6e67 7561 6765 203a 3a20  ing Language :: 
+0009a480: 5079 7468 6f6e 203a 3a20 3322 2c0d 0a20  Python :: 3",.. 
+0009a490: 2020 2020 2020 2022 4f70 6572 6174 696e         "Operatin
+0009a4a0: 6720 5379 7374 656d 203a 3a20 4f53 2049  g System :: OS I
+0009a4b0: 6e64 6570 656e 6465 6e74 222c 0d0a 2020  ndependent",..  
+0009a4c0: 2020 5d2c 0d0a 290d 0a00 0000 0000 0000    ],..).........
 0009a4d0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
 0009a4e0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
 0009a4f0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
 0009a500: 0000 0000 0000 0000 0000 0000 0000 0000  ................
 0009a510: 0000 0000 0000 0000 0000 0000 0000 0000  ................
 0009a520: 0000 0000 0000 0000 0000 0000 0000 0000  ................
 0009a530: 0000 0000 0000 0000 0000 0000 0000 0000  ................
```

