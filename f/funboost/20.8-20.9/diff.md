# Comparing `tmp/funboost-20.8-py3-none-any.whl.zip` & `tmp/funboost-20.9-py3-none-any.whl.zip`

## zipinfo {}

```diff
@@ -1,13 +1,14 @@
-Zip file size: 1884927 bytes, number of entries: 218
--rw-rw-rw-  2.0 fat    21081 b- defN 23-May-05 03:43 funboost/__init__.py
+Zip file size: 1885994 bytes, number of entries: 219
+-rw-rw-rw-  2.0 fat    21031 b- defN 23-May-15 01:33 funboost/__init__.py
 -rw-rw-rw-  2.0 fat     5910 b- defN 23-Apr-28 02:46 funboost/constant.py
 -rw-rw-rw-  2.0 fat     7100 b- defN 23-Apr-27 08:42 funboost/funboost_config_deafult.py
--rw-rw-rw-  2.0 fat    14104 b- defN 23-Apr-14 00:56 funboost/helpers.py
+-rw-rw-rw-  2.0 fat    14135 b- defN 23-May-15 01:33 funboost/helpers.py
 -rw-rw-rw-  2.0 fat     9149 b- defN 23-Apr-13 09:47 funboost/set_frame_config.py
+-rw-rw-rw-  2.0 fat     3955 b- defN 23-May-15 01:33 funboost/assist/celery_helper.py
 -rw-rw-rw-  2.0 fat     3930 b- defN 22-Sep-17 06:12 funboost/beggar_version_implementation/beggar_redis_consumer.py
 -rw-rw-rw-  2.0 fat      759 b- defN 22-Dec-19 11:45 funboost/concurrent_pool/__init__.py
 -rw-rw-rw-  2.0 fat     3256 b- defN 21-Dec-27 01:40 funboost/concurrent_pool/async_helper.py
 -rw-rw-rw-  2.0 fat     7227 b- defN 23-Mar-23 05:32 funboost/concurrent_pool/async_pool_executor.py
 -rw-rw-rw-  2.0 fat     4723 b- defN 23-Mar-23 05:32 funboost/concurrent_pool/bounded_processpoolexcutor_gt_py37.py
 -rw-rw-rw-  2.0 fat     3011 b- defN 23-Mar-23 05:32 funboost/concurrent_pool/bounded_processpoolexcutor_py36.py
 -rw-rw-rw-  2.0 fat     1571 b- defN 23-Mar-23 05:32 funboost/concurrent_pool/bounded_threadpoolexcutor.py
@@ -18,34 +19,34 @@
 -rw-rw-rw-  2.0 fat     9317 b- defN 21-Dec-27 01:40 funboost/concurrent_pool/custom_threadpool_executor000.py
 -rw-rw-rw-  2.0 fat      373 b- defN 21-Dec-27 01:40 funboost/concurrent_pool/single_thread_executor.py
 -rw-rw-rw-  2.0 fat        0 b- defN 23-Feb-24 11:39 funboost/concurrent_pool/backup/__init__.py
 -rw-rw-rw-  2.0 fat     9548 b- defN 23-Mar-23 05:32 funboost/concurrent_pool/backup/async_pool_executor0223.py
 -rw-rw-rw-  2.0 fat     9568 b- defN 23-Mar-23 05:32 funboost/concurrent_pool/backup/async_pool_executor_back.py
 -rw-rw-rw-  2.0 fat     5728 b- defN 23-Mar-23 05:32 funboost/concurrent_pool/backup/async_pool_executor_janus.py
 -rw-rw-rw-  2.0 fat      126 b- defN 22-Sep-17 06:12 funboost/consumers/__init__.py
--rw-rw-rw-  2.0 fat    94087 b- defN 23-May-10 06:10 funboost/consumers/base_consumer.py
--rw-rw-rw-  2.0 fat    11737 b- defN 23-May-10 12:16 funboost/consumers/celery_consumer.py
+-rw-rw-rw-  2.0 fat    96280 b- defN 23-May-15 01:33 funboost/consumers/base_consumer.py
+-rw-rw-rw-  2.0 fat     7431 b- defN 23-May-15 01:33 funboost/consumers/celery_consumer.py
 -rw-rw-rw-  2.0 fat     4574 b- defN 23-May-04 06:09 funboost/consumers/celery_consumer000.py
 -rw-rw-rw-  2.0 fat     5877 b- defN 23-Mar-29 02:19 funboost/consumers/confirm_mixin.py
--rw-rw-rw-  2.0 fat     2067 b- defN 23-May-04 12:12 funboost/consumers/http_consumer.py
+-rw-rw-rw-  2.0 fat     2025 b- defN 23-May-15 01:33 funboost/consumers/http_consumer.py
 -rw-rw-rw-  2.0 fat     4463 b- defN 22-Sep-17 06:12 funboost/consumers/http_consumer000.py
 -rw-rw-rw-  2.0 fat     1080 b- defN 23-May-04 12:12 funboost/consumers/httpsqs_consumer.py
 -rw-rw-rw-  2.0 fat     4217 b- defN 23-May-04 12:12 funboost/consumers/kafka_consumer.py
 -rw-rw-rw-  2.0 fat     6556 b- defN 23-May-04 12:12 funboost/consumers/kafka_consumer_manually_commit.py
--rw-rw-rw-  2.0 fat    10186 b- defN 23-May-04 12:12 funboost/consumers/kombu_consumer.py
+-rw-rw-rw-  2.0 fat    10186 b- defN 23-May-12 08:42 funboost/consumers/kombu_consumer.py
 -rw-rw-rw-  2.0 fat     1291 b- defN 23-May-04 12:12 funboost/consumers/local_python_queue_consumer.py
 -rw-rw-rw-  2.0 fat     1090 b- defN 23-May-04 12:12 funboost/consumers/mongomq_consumer.py
 -rw-rw-rw-  2.0 fat     2228 b- defN 23-May-04 12:12 funboost/consumers/mqtt_consumer.py
 -rw-rw-rw-  2.0 fat     2183 b- defN 23-May-04 12:12 funboost/consumers/nameko_consumer.py
 -rw-rw-rw-  2.0 fat     1076 b- defN 23-May-04 12:12 funboost/consumers/nats_consumer.py
 -rw-rw-rw-  2.0 fat     1461 b- defN 23-May-04 12:12 funboost/consumers/nsq_consumer.py
 -rw-rw-rw-  2.0 fat     1238 b- defN 23-May-04 12:12 funboost/consumers/peewee_conusmer.py
 -rw-rw-rw-  2.0 fat     1005 b- defN 23-May-04 12:12 funboost/consumers/persist_queue_consumer.py
 -rw-rw-rw-  2.0 fat     2414 b- defN 23-May-04 12:12 funboost/consumers/pulsar_consumer.py
--rw-rw-rw-  2.0 fat     1721 b- defN 23-May-04 12:12 funboost/consumers/rabbitmq_amqpstorm_consumer.py
+-rw-rw-rw-  2.0 fat     1721 b- defN 23-May-12 09:09 funboost/consumers/rabbitmq_amqpstorm_consumer.py
 -rw-rw-rw-  2.0 fat     5433 b- defN 23-May-04 12:12 funboost/consumers/rabbitmq_pika_consumer.py
 -rw-rw-rw-  2.0 fat     4674 b- defN 23-May-04 12:12 funboost/consumers/rabbitmq_pika_consumerv0.py
 -rw-rw-rw-  2.0 fat     1260 b- defN 23-May-04 12:12 funboost/consumers/rabbitmq_rabbitpy_consumer.py
 -rw-rw-rw-  2.0 fat     3031 b- defN 23-May-04 12:12 funboost/consumers/redis_brpoplpush_consumer.py
 -rw-rw-rw-  2.0 fat     2829 b- defN 23-May-04 12:12 funboost/consumers/redis_consumer.py
 -rw-rw-rw-  2.0 fat     7545 b- defN 23-May-04 12:12 funboost/consumers/redis_consumer_ack_able.py
 -rw-rw-rw-  2.0 fat      922 b- defN 23-May-04 12:12 funboost/consumers/redis_consumer_simple.py
@@ -55,15 +56,15 @@
 -rw-rw-rw-  2.0 fat     1653 b- defN 23-May-04 12:12 funboost/consumers/rocketmq_consumer.py
 -rw-rw-rw-  2.0 fat     1309 b- defN 23-May-04 12:12 funboost/consumers/sqlachemy_consumer.py
 -rw-rw-rw-  2.0 fat     2045 b- defN 23-May-04 12:12 funboost/consumers/tcp_consumer.py
 -rw-rw-rw-  2.0 fat     1340 b- defN 23-May-04 12:12 funboost/consumers/txt_file_consumer.py
 -rw-rw-rw-  2.0 fat     1643 b- defN 23-May-04 12:12 funboost/consumers/udp_consumer.py
 -rw-rw-rw-  2.0 fat     4157 b- defN 23-May-04 12:12 funboost/consumers/zeromq_consumer.py
 -rw-rw-rw-  2.0 fat        0 b- defN 22-Dec-05 10:31 funboost/contrib/__init__.py
--rw-rw-rw-  2.0 fat     4703 b- defN 23-Mar-29 03:02 funboost/contrib/queue2queue.py
+-rw-rw-rw-  2.0 fat     4680 b- defN 23-May-15 08:24 funboost/contrib/queue2queue.py
 -rw-rw-rw-  2.0 fat     1817 b- defN 23-Mar-22 02:09 funboost/contrib/redis_consume_latest_msg_broker.py
 -rw-rw-rw-  2.0 fat      178 b- defN 22-Sep-17 06:12 funboost/factories/__init__.py
 -rw-rw-rw-  2.0 fat     8362 b- defN 23-May-10 11:19 funboost/factories/broker_kind__publsiher_consumer_type_map.py
 -rw-rw-rw-  2.0 fat     1032 b- defN 23-May-05 03:52 funboost/factories/consumer_factory.py
 -rw-rw-rw-  2.0 fat     2367 b- defN 23-May-06 01:20 funboost/factories/publisher_factotry.py
 -rw-rw-rw-  2.0 fat     4841 b- defN 22-Sep-17 06:12 funboost/function_result_web/app.py
 -rw-rw-rw-  2.0 fat     7345 b- defN 23-Mar-08 10:19 funboost/function_result_web/functions.py
@@ -79,22 +80,22 @@
 -rw-rw-rw-  2.0 fat      546 b- defN 21-Dec-27 01:40 funboost/function_result_web/static/images/password.png
 -rw-rw-rw-  2.0 fat     2912 b- defN 21-Dec-27 01:40 funboost/function_result_web/static/images/tick.png
 -rw-rw-rw-  2.0 fat      622 b- defN 21-Dec-27 01:40 funboost/function_result_web/static/images/user.png
 -rw-rw-rw-  2.0 fat    96383 b- defN 21-Dec-27 01:40 funboost/function_result_web/static/js/jquery-1.11.0.min.js
 -rw-rw-rw-  2.0 fat    19501 b- defN 22-Feb-21 12:32 funboost/function_result_web/templates/index.html
 -rw-rw-rw-  2.0 fat     2007 b- defN 21-Dec-27 01:40 funboost/function_result_web/templates/login.html
 -rw-rw-rw-  2.0 fat      131 b- defN 22-Sep-17 06:12 funboost/publishers/__init__.py
--rw-rw-rw-  2.0 fat    14894 b- defN 23-Apr-21 09:06 funboost/publishers/base_publisher.py
--rw-rw-rw-  2.0 fat     3660 b- defN 23-May-04 07:41 funboost/publishers/celery_publisher.py
+-rw-rw-rw-  2.0 fat    15103 b- defN 23-May-15 01:33 funboost/publishers/base_publisher.py
+-rw-rw-rw-  2.0 fat     3724 b- defN 23-May-15 01:33 funboost/publishers/celery_publisher.py
 -rw-rw-rw-  2.0 fat     3897 b- defN 23-May-04 06:09 funboost/publishers/celery_publisher000.py
 -rw-rw-rw-  2.0 fat     3541 b- defN 23-Mar-23 05:32 funboost/publishers/confluent_kafka_publisher.py
 -rw-rw-rw-  2.0 fat      753 b- defN 23-May-04 11:53 funboost/publishers/http_publisher.py
 -rw-rw-rw-  2.0 fat     2783 b- defN 22-Sep-17 06:12 funboost/publishers/httpsqs_publisher.py
 -rw-rw-rw-  2.0 fat     2160 b- defN 23-Apr-03 10:55 funboost/publishers/kafka_publisher.py
--rw-rw-rw-  2.0 fat     5246 b- defN 23-Apr-21 09:40 funboost/publishers/kombu_publisher.py
+-rw-rw-rw-  2.0 fat     5321 b- defN 23-May-15 01:33 funboost/publishers/kombu_publisher.py
 -rw-rw-rw-  2.0 fat     1365 b- defN 22-Sep-17 06:12 funboost/publishers/local_python_queue_publisher.py
 -rw-rw-rw-  2.0 fat     1874 b- defN 23-Mar-14 02:56 funboost/publishers/mongomq_publisher.py
 -rw-rw-rw-  2.0 fat     3050 b- defN 22-Sep-17 06:12 funboost/publishers/mqtt_publisher.py
 -rw-rw-rw-  2.0 fat     7782 b- defN 23-Mar-31 03:13 funboost/publishers/msg_result_getter.py
 -rw-rw-rw-  2.0 fat     2147 b- defN 23-Apr-28 06:21 funboost/publishers/nameko_publisher.py
 -rw-rw-rw-  2.0 fat      776 b- defN 21-Dec-27 01:40 funboost/publishers/nats_publisher.py
 -rw-rw-rw-  2.0 fat     1302 b- defN 22-Sep-17 06:12 funboost/publishers/nsq_publisher.py
@@ -131,15 +132,15 @@
 -rw-rw-rw-  2.0 fat      251 b- defN 21-Dec-27 01:40 funboost/utils/develop_log.py
 -rw-rw-rw-  2.0 fat     2984 b- defN 23-Apr-07 02:11 funboost/utils/mongo_util.py
 -rw-rw-rw-  2.0 fat     7367 b- defN 23-Mar-23 05:34 funboost/utils/monkey_color_log.py
 -rw-rw-rw-  2.0 fat     2882 b- defN 23-Feb-23 05:04 funboost/utils/monkey_patches.py
 -rw-rw-rw-  2.0 fat     3199 b- defN 21-Dec-27 01:40 funboost/utils/mqtt_util.py
 -rw-rw-rw-  2.0 fat     4901 b- defN 21-Dec-27 01:40 funboost/utils/paramiko_util.py
 -rw-rw-rw-  2.0 fat     2963 b- defN 22-Sep-17 06:12 funboost/utils/rabbitmq_factory.py
--rw-rw-rw-  2.0 fat     4604 b- defN 23-Mar-23 05:32 funboost/utils/redis_manager.py
+-rw-rw-rw-  2.0 fat     4628 b- defN 23-May-12 03:14 funboost/utils/redis_manager.py
 -rw-rw-rw-  2.0 fat     5532 b- defN 22-Sep-17 06:12 funboost/utils/resource_monitoring.py
 -rw-rw-rw-  2.0 fat     1418 b- defN 23-Mar-15 02:41 funboost/utils/restart_python.py
 -rw-rw-rw-  2.0 fat     2985 b- defN 23-Jan-29 07:39 funboost/utils/show_funboost_flag.py
 -rw-rw-rw-  2.0 fat     1204 b- defN 22-Dec-12 08:11 funboost/utils/simple_data_class.py
 -rw-rw-rw-  2.0 fat     5407 b- defN 21-Dec-27 01:40 funboost/utils/time_util.py
 -rw-rw-rw-  2.0 fat      408 b- defN 22-Jan-17 01:57 funboost/utils/un_strict_json_dumps.py
 -rw-rw-rw-  2.0 fat        0 b- defN 21-Dec-27 01:40 funboost/utils/dependency_packages/__init__.py
@@ -208,13 +209,13 @@
 -rw-rw-rw-  2.0 fat      303 b- defN 23-Mar-13 01:28 funboost/utils/dependency_packages_in_pythonpath/func_timeout/__pycache__/py3_raise.cpython-37.pyc
 -rw-rw-rw-  2.0 fat      311 b- defN 23-Mar-21 10:43 funboost/utils/dependency_packages_in_pythonpath/func_timeout/__pycache__/py3_raise.cpython-39.pyc
 -rw-rw-rw-  2.0 fat      909 b- defN 21-Dec-27 01:40 funboost/utils/pysnooper_ydf/__init__.py
 -rw-rw-rw-  2.0 fat     2243 b- defN 21-Dec-27 01:40 funboost/utils/pysnooper_ydf/pycompat.py
 -rw-rw-rw-  2.0 fat    19131 b- defN 23-Mar-23 05:34 funboost/utils/pysnooper_ydf/tracer.py
 -rw-rw-rw-  2.0 fat     2753 b- defN 23-Mar-23 05:34 funboost/utils/pysnooper_ydf/utils.py
 -rw-rw-rw-  2.0 fat     3693 b- defN 23-Mar-23 05:34 funboost/utils/pysnooper_ydf/variables.py
--rw-rw-rw-  2.0 fat    11558 b- defN 23-May-10 12:17 funboost-20.8.dist-info/LICENSE
--rw-rw-rw-  2.0 fat    26332 b- defN 23-May-10 12:17 funboost-20.8.dist-info/METADATA
--rw-rw-rw-  2.0 fat       97 b- defN 23-May-10 12:17 funboost-20.8.dist-info/WHEEL
--rw-rw-rw-  2.0 fat        9 b- defN 23-May-10 12:17 funboost-20.8.dist-info/top_level.txt
-?rw-rw-r--  2.0 fat    24059 b- defN 23-May-10 12:17 funboost-20.8.dist-info/RECORD
-218 files, 3240556 bytes uncompressed, 1844915 bytes compressed:  43.1%
+-rw-rw-rw-  2.0 fat    11558 b- defN 23-May-17 02:01 funboost-20.9.dist-info/LICENSE
+-rw-rw-rw-  2.0 fat    26332 b- defN 23-May-17 02:01 funboost-20.9.dist-info/METADATA
+-rw-rw-rw-  2.0 fat       97 b- defN 23-May-17 02:01 funboost-20.9.dist-info/WHEEL
+-rw-rw-rw-  2.0 fat        9 b- defN 23-May-17 02:01 funboost-20.9.dist-info/top_level.txt
+?rw-rw-r--  2.0 fat    24147 b- defN 23-May-17 02:01 funboost-20.9.dist-info/RECORD
+219 files, 3242774 bytes uncompressed, 1845842 bytes compressed:  43.1%
```

## zipnote {}

```diff
@@ -9,14 +9,17 @@
 
 Filename: funboost/helpers.py
 Comment: 
 
 Filename: funboost/set_frame_config.py
 Comment: 
 
+Filename: funboost/assist/celery_helper.py
+Comment: 
+
 Filename: funboost/beggar_version_implementation/beggar_redis_consumer.py
 Comment: 
 
 Filename: funboost/concurrent_pool/__init__.py
 Comment: 
 
 Filename: funboost/concurrent_pool/async_helper.py
@@ -633,23 +636,23 @@
 
 Filename: funboost/utils/pysnooper_ydf/utils.py
 Comment: 
 
 Filename: funboost/utils/pysnooper_ydf/variables.py
 Comment: 
 
-Filename: funboost-20.8.dist-info/LICENSE
+Filename: funboost-20.9.dist-info/LICENSE
 Comment: 
 
-Filename: funboost-20.8.dist-info/METADATA
+Filename: funboost-20.9.dist-info/METADATA
 Comment: 
 
-Filename: funboost-20.8.dist-info/WHEEL
+Filename: funboost-20.9.dist-info/WHEEL
 Comment: 
 
-Filename: funboost-20.8.dist-info/top_level.txt
+Filename: funboost-20.9.dist-info/top_level.txt
 Comment: 
 
-Filename: funboost-20.8.dist-info/RECORD
+Filename: funboost-20.9.dist-info/RECORD
 Comment: 
 
 Zip file comment:
```

## funboost/__init__.py

```diff
@@ -9,15 +9,15 @@
 import copy
 # noinspection PyUnresolvedReferences
 import nb_log
 from funboost.set_frame_config import patch_frame_config, show_frame_config
 from funboost.funboost_config_deafult import BoostDecoratorDefaultParams
 from funboost.helpers import (fabric_deploy, kill_all_remote_tasks,
                               multi_process_pub_params_list,
-                              run_consumer_with_multi_process)
+                              run_consumer_with_multi_process, boost_queue__fun_map)
 
 from funboost.utils.paramiko_util import ParamikoFolderUploader
 from funboost.consumers.base_consumer import (ExceptionForRequeue, ExceptionForRetry, ExceptionForPushToDlxqueue,
                                               AbstractConsumer, ConsumersManager,
                                               FunctionResultStatusPersistanceConfig,
                                               wait_for_possible_has_finish_all_tasks_by_conusmer_list,
                                               ActiveCousumerProcessInfoGetter, FunctionResultStatus)
@@ -133,15 +133,15 @@
         return self.consuming_func_decorated(*args, **kwargs)
 
 
 class _Undefined:
     pass
 
 
-boost_queue__fun_map = {}  # type:typing.Dict[str,IdeAutoCompleteHelper]
+
 
 
 # import funboost ; funboost.boost_queue__fun_map
 
 def boost(queue_name,
           *,
           consumin_function_decorator: typing.Callable = _Undefined,
```

## funboost/helpers.py

```diff
@@ -208,14 +208,17 @@
 
                 'is_save_result': self.is_save_result, 'expire_seconds': self.expire_seconds}
 
     def __str__(self):
         return f'<FunctionResultStatusPersistanceConfig> {id(self)} {self.to_dict()}'
 
 
+boost_queue__fun_map = {}
+
+
 # noinspection PyUnusedLocal
 def _interrupt_signal_handler(signalx, framex):
     print('你按了 Ctrl+C  。 You pressed Ctrl+C!  结束程序！')
     # sys.exit(0)
     # noinspection PyUnresolvedReferences
     os._exit(0)  # os._exit才能更强力的迅速终止python，sys.exit只能退出主线程。
```

## funboost/consumers/base_consumer.py

```diff
@@ -26,24 +26,27 @@
 from typing import Callable
 from functools import wraps
 import threading
 from threading import Lock, Thread
 import gevent
 import asyncio
 
+from apscheduler.jobstores.redis import RedisJobStore
 from apscheduler.schedulers.background import BackgroundScheduler
 from apscheduler.executors.pool import ThreadPoolExecutor as ApschedulerThreadPoolExecutor
 from apscheduler.events import EVENT_JOB_MISSED
 
 import pymongo
 from pymongo import IndexModel, ReplaceOne
 from pymongo.errors import PyMongoError
 
+import nb_log
 from funboost.concurrent_pool.single_thread_executor import SoloExecutor
-from funboost.helpers import FunctionResultStatusPersistanceConfig
+from funboost.helpers import FunctionResultStatusPersistanceConfig, boost_queue__fun_map
+
 from funboost.utils.apscheduler_monkey import patch_run_job as patch_apscheduler_run_job
 
 # noinspection PyUnresolvedReferences
 from nb_log import get_logger, LoggerLevelSetterMixin, LogManager, nb_print, LoggerMixin, \
     LoggerMixinDefaultWithFileHandler, stdout_write, stderr_write, is_main_process, \
     only_print_on_main_process, nb_log_config_default
 # noinspection PyUnresolvedReferences
@@ -66,15 +69,16 @@
 # noinspection PyUnresolvedReferences
 from funboost.utils.bulk_operation import MongoBulkWriteHelper, InsertOne
 from funboost.utils.mongo_util import MongoMixin
 from funboost import funboost_config_deafult
 # noinspection PyUnresolvedReferences
 from funboost.constant import ConcurrentModeEnum, BrokerEnum
 
-patch_apscheduler_run_job()
+
+# patch_apscheduler_run_job()
 
 
 def _delete_keys_and_return_new_dict(dictx: dict, keys: list = None):
     dict_new = copy.copy(dictx)  # 主要是去掉一级键 publish_time，浅拷贝即可。新的消息已经不是这样了。
     keys = ['publish_time', 'publish_time_format', 'extra'] if keys is None else keys
     for dict_key in keys:
         try:
@@ -507,14 +511,15 @@
         self._log_level = log_level
         log_file_handler_type = 1
         if int(os.getenv('is_fsdf_remote_run', 0)) == 1:  # 这个是远程部署的自动的环境变量，用户不需要亲自自己设置这个值。
             log_file_handler_type = 5  # 如果是fabric_deploy 自动化远程部署函数时候，python -c 启动的使用第一个filehandler没记录文件，现在使用第5种filehandler。
         self.logger = get_logger(logger_name, log_level_int=log_level, log_filename=f'{logger_name}.log' if create_logger_file else None,
                                  # log_file_handler_type=log_file_handler_type,
                                  formatter_template=funboost_config_deafult.NB_LOG_FORMATER_INDEX_FOR_CONSUMER_AND_PUBLISHER, )
+        self._logger_name = logger_name
         # self.logger.info(f'{self.__class__} 在 {current_queue__info_dict["where_to_instantiate"]}  被实例化')
         logger_name_error = f'{logger_name}_error'
         self.error_file_logger = get_logger(logger_name_error, log_level_int=log_level, log_filename=f'{logger_name_error}.log',
                                             is_add_stream_handler=False,
                                             formatter_template=funboost_config_deafult.NB_LOG_FORMATER_INDEX_FOR_CONSUMER_AND_PUBLISHER, )
 
         stdout_write(f'{time.strftime("%H:%M:%S")} "{current_queue__info_dict["where_to_instantiate"]}"  \033[0;37;44m此行 '
@@ -561,15 +566,15 @@
         self._redis_key_pause_flag = f'funboost_pause_flag:{self.queue_name}'
 
         # 控频要用到的成员变量
         self._last_submit_task_timestamp = 0
         self._last_start_count_qps_timestamp = time.time()
         self._has_execute_times_in_recent_second = 0
 
-        self._publisher_of_same_queue = None
+        self._publisher_of_same_queue = None  #
         self._dlx_queue_name = f'{queue_name}_dlx'
         self._publisher_of_dlx_queue = None  # 死信队列发布者
 
         self._do_not_delete_extra_from_msg = False
 
         self.consumer_identification = f'{nb_log_config_default.computer_name}_{nb_log_config_default.computer_ip}_' \
                                        f'{time_util.DatetimeConverter().datetime_str.replace(":", "-")}_{os.getpid()}_{id(self)}'
@@ -692,20 +697,33 @@
             self.keep_circulating(1)(self._shedual_task)()
         else:
             self._concurrent_mode_dispatcher.schedulal_task_with_no_block()
         setattr(funboost_config_deafult, 'has_start_a_consumer_flag', 1)
 
     def _start_delay_task_scheduler(self):
         from funboost.timing_job import FsdfBackgroundScheduler
-        self._delay_task_scheduler = FsdfBackgroundScheduler(timezone=funboost_config_deafult.TIMEZONE, daemon=False)
+        jobstores = {
+            "default": RedisJobStore(db=funboost_config_deafult.REDIS_DB, host=funboost_config_deafult.REDIS_HOST,
+                                     port=funboost_config_deafult.REDIS_PORT, password=funboost_config_deafult.REDIS_PASSWORD, )
+        }
+        self._delay_task_scheduler = FsdfBackgroundScheduler(timezone=funboost_config_deafult.TIMEZONE, daemon=False,
+                                                             jobstores=jobstores  # push 方法的序列化带thredignn.lock
+                                                             )
         self._delay_task_scheduler.add_executor(ApschedulerThreadPoolExecutor(2))  # 只是运行submit任务到并发池，不需要很多线程。
-        self._delay_task_scheduler.add_listener(self._apscheduler_job_miss, EVENT_JOB_MISSED)
+        # self._delay_task_scheduler.add_listener(self._apscheduler_job_miss, EVENT_JOB_MISSED)
         self._delay_task_scheduler.start()
         self.logger.warning('启动延时任务sheduler')
 
+    logger_apscheduler = nb_log.get_logger('push_for_apscheduler_use_database_store', log_filename='push_for_apscheduler_use_database_store.log')
+
+    @classmethod
+    def _push_for_apscheduler_use_database_store(cls, queue_name, msg, ):
+        cls.logger_apscheduler.debug(f'延时任务用普通消息重新发布到普通队列 {msg}')
+        boost_queue__fun_map[queue_name].publish(msg)
+
     @abc.abstractmethod
     def _shedual_task(self):
         """
         每个子类必须实现这个的方法，完成如何从中间件取出消息，并将函数和运行参数添加到工作池。
         :return:
         """
         raise NotImplementedError
@@ -754,25 +772,50 @@
         # print(run_date.timestamp(),time_util.DatetimeConverter().datetime_obj.timestamp())
         # print(self.concurrent_pool)
         if run_date:  # 延时任务
             # print(repr(run_date),repr(datetime.datetime.now(tz=pytz.timezone(frame_config.TIMEZONE))))
             if self._has_start_delay_task_scheduler is False:
                 self._has_start_delay_task_scheduler = True
                 self._start_delay_task_scheduler()
-            self._delay_task_scheduler.add_job(self.concurrent_pool.submit, 'date', run_date=run_date, args=(self._run,), kwargs={'kw': kw},
+
+            # 这种方式是扔到线程池
+            # self._delay_task_scheduler.add_job(self.concurrent_pool.submit, 'date', run_date=run_date, args=(self._run,), kwargs={'kw': kw},
+            #                                    misfire_grace_time=misfire_grace_time)
+
+            # 这种方式是延时任务重新以普通任务方式发送到消息队列
+            msg_no_delay = copy.deepcopy(kw['body'])
+            self.__delete_eta_countdown(msg_no_delay)
+            # print(msg_no_delay)
+            # 数据库作为apscheduler的jobstores时候， 不能用 self.pbulisher_of_same_queue.publish，self不能序列化
+            self._delay_task_scheduler.add_job(self._push_for_apscheduler_use_database_store, 'date', run_date=run_date,
+                                               kwargs={'queue_name': self.queue_name, 'msg': msg_no_delay, },
                                                misfire_grace_time=misfire_grace_time)
+            self._confirm_consume(kw)
+
         else:  # 普通任务
             self.concurrent_pool.submit(self._run, kw)
 
         if self._is_using_distributed_frequency_control:  # 如果是需要分布式控频。
             active_num = self._distributed_consumer_statistics.active_consumer_num
             self._frequency_control(self._qps / active_num, self._msg_schedule_time_intercal * active_num)
         else:
             self._frequency_control(self._qps, self._msg_schedule_time_intercal)
 
+    def __delete_eta_countdown(self, msg_body: dict):
+        self.__dict_pop(msg_body.get('extra', {}), 'eta')
+        self.__dict_pop(msg_body.get('extra', {}), 'countdown')
+        self.__dict_pop(msg_body.get('extra', {}), 'misfire_grace_time')
+
+    @staticmethod
+    def __dict_pop(dictx, key):
+        try:
+            dictx.pop(key)
+        except KeyError:
+            pass
+
     def _frequency_control(self, qpsx: float, msg_schedule_time_intercalx: float):
         # 以下是消费函数qps控制代码。无论是单个消费者空频还是分布式消费控频，都是基于直接计算的，没有依赖redis inrc计数，使得控频性能好。
         if qpsx == 0:  # 不需要控频的时候，就不需要休眠。
             return
         if qpsx <= 5:
             """ 原来的简单版 """
             time.sleep(msg_schedule_time_intercalx)
```

## funboost/consumers/celery_consumer.py

```diff
@@ -1,24 +1,15 @@
 # -*- coding: utf-8 -*-
 # @Author  : ydf
 # @Time    : 2022/8/8 0008 13:32
-import os
-import sys
-import threading
+
 import time
-import typing
-from functools import partial
+from funboost.assist.celery_helper import CeleryHelper, celery_app
 
-import nb_log
-from nb_log import get_logger
-from funboost.constant import BrokerEnum
-from funboost import funboost_config_deafult
 from funboost.consumers.base_consumer import AbstractConsumer
-from funboost.publishers.celery_publisher import celery_app
-from funboost.constant import ConcurrentModeEnum
 
 
 class CeleryConsumer(AbstractConsumer):
     """
     celery作为中间件实现的。
     """
 
@@ -161,120 +152,31 @@
         resultrepr_maxsize = 1024
 
         #: Task request stack, the current request will be the topmost.
         request_stack = None
     '''
 
     def custom_init(self):
+        # 这就是核心，@boost时候回注册任务路由到celery_app
         @celery_app.task(name=self.queue_name, rate_limit=f'{self._qps}/s', soft_time_limit=self._function_timeout,
                          max_retries=self._max_retry_times,
                          **self.broker_exclusive_config['celery_task_config'])
         def f(*args, **kwargs):
             self.logger.debug(f' 这条消息是 celery 从 {self.queue_name} 队列中取出 ,是由 celery 框架调度 {self.consuming_function.__name__} 函数处理: args:  {args} ,  kwargs: {kwargs}')
             return self.consuming_function(*args, **kwargs)
 
         CeleryHelper.concurrent_mode = self._concurrent_mode
 
-        # print(type(f), dir(f), f.__dict__)
-
-    # def _shedual_task000(self):
-    #     """ 建议使用 batch_start_celery_consumers([f1,f2]) ,而不是 f1.consume()  f2.consume() 方式"""
-    #
-    #     # # celery_app.worker_main(
-    #     # #     argv=['worker', '--pool=threads', '--concurrency=500', '-n', 'worker1@%h', '--loglevel=INFO',
-    #     # #           f'--queues={self.queue_name}',
-    #     # #           ])
-    #     #
-    #     # # logging.getLevelName(self._log_level)
-    #     def f():
-    #         celery_app.worker_main(
-    #             argv=['worker', '--pool=threads', f'--concurrency={self._concurrent_num}',
-    #                   '-n', f'worker_{self.queue_name}@%h', f'--loglevel=INFO',
-    #                   f'--queues={self.queue_name}',
-    #                   ])
-    #
-    #     # threading.Thread(target=f).start()
-    #     f()
-    #     #
-    #     # # worker = celery_app.Worker()
-    #     # # worker.start()
-    #     # raise Exception('不建议这样启动')
-
-    def _shedual_task(self):
+    def start_consuming_message(self):
         # 不单独每个函数都启动一次celery的worker消费，是把要消费的 queue name放到列表中，realy_start_celery_worker 一次性启动多个函数消费。
         CeleryHelper.to_be_start_work_celery_queue_name_set.add(self.queue_name)
-        time.sleep(1000)
+        super().start_consuming_message()
+
+    def _shedual_task(self):
+        while 1:
+            time.sleep(100)
 
     def _confirm_consume(self, kw):
         pass
 
     def _requeue(self, kw):
         pass
-
-
-class CeleryHelper:
-
-    celery_app = celery_app
-    to_be_start_work_celery_queue_name_set = set()  # 存放需要worker运行的queue name。
-    to_be_start_work_celery_queue_name__conmsumer_map = {}
-    logger = get_logger('funboost.CeleryHelper')
-    concurrent_mode = None
-
-    @staticmethod
-    def update_celery_app_conf(celery_app_conf: dict):
-        """
-        更新celery app的配置，celery app配置大全见 https://docs.celeryq.dev/en/stable/userguide/configuration.html
-        :param celery_app_conf:
-        :return:
-        """
-        celery_app.conf.update(celery_app_conf)
-
-    @staticmethod
-    def celery_start_beat(beat_schedule: dict):
-        celery_app.conf.beat_schedule = beat_schedule  # 配置celery定时任务
-
-        def _f():
-            beat = partial(celery_app.Beat, loglevel='INFO', )
-            beat().run()
-
-        threading.Thread(target=_f).start()  # 使得可以很方便启动定时任务，继续启动函数消费
-
-    @classmethod
-    def start_flower(cls,port=5555):
-        def _f():
-            python_executable = sys.executable
-            # print(python_executable)
-
-            # cmd = f'''{python_executable} -m celery -A funboost.publishers.celery_publisher --broker={funboost_config_deafult.CELERY_BROKER_URL}  --result-backend={funboost_config_deafult.CELERY_RESULT_BACKEND}   flower --address=0.0.0.0 --port={port}  --auto_refresh=True '''
-            cmd = f'''{python_executable} -m celery  --broker={funboost_config_deafult.CELERY_BROKER_URL}  --result-backend={funboost_config_deafult.CELERY_RESULT_BACKEND}   flower --address=0.0.0.0 --port={port}  --auto_refresh=True '''
-
-            cls.logger.info(f'启动flower命令:   {cmd}')
-            os.system(cmd)
-
-        threading.Thread(target=_f).start()
-
-    @classmethod
-    def realy_start_celery_worker(cls, worker_name=None):
-        time.sleep(1)  # .consume() 是线程中运行的，要确保_shedual_task 运行完了，再运行的这。1秒肯定能运行完。
-        if len(cls.to_be_start_work_celery_queue_name_set) == 0:
-            raise Exception('celery worker 没有需要运行的queue')
-        queue_names_str = ','.join(list(cls.to_be_start_work_celery_queue_name_set))
-        # '--concurrency=200',
-        # '--autoscale=5,500' threads 并发模式不支持自动扩大缩小并发数量,
-        worker_name = worker_name or f'pid_{os.getpid()}'
-        pool_name = 'threads'
-        if cls.concurrent_mode == ConcurrentModeEnum.GEVENT:
-            pool_name = 'gevent'
-        if cls.concurrent_mode == ConcurrentModeEnum.EVENTLET:
-            pool_name = 'eventlet'
-        argv = ['worker', f'--pool={pool_name}', '--concurrency=200',
-                '-n', f'worker_funboost_{worker_name}@%h', f'--loglevel=INFO',
-                f'--queues={queue_names_str}',
-                ]
-        cls.logger.info(f'celery 启动work参数 {argv}')
-        celery_app.worker_main(argv)
-
-    @classmethod
-    def show_celery_app_conf(cls):
-        cls.logger.debug('展示celery app的配置')
-        for k, v in celery_app.conf.items():
-            print(k, ' : ', v)
```

## funboost/consumers/http_consumer.py

```diff
@@ -3,15 +3,14 @@
 # @Time    : 2022/8/8 0008 13:32
 import asyncio
 import json
 
 from aiohttp import web
 from aiohttp.web_request import Request
 
-from funboost.constant import BrokerEnum
 from funboost.consumers.base_consumer import AbstractConsumer
 
 
 class HTTPConsumer(AbstractConsumer, ):
     """
     http 实现消息队列，不支持持久化，但不需要安装软件。
     """
```

## funboost/contrib/queue2queue.py

```diff
@@ -68,19 +68,17 @@
 
             source_consumer = get_consumer(source_queue_name, broker_kind=source_broker_kind, consuming_function=_fun, log_level=log_level_int)
             source_consumer_list.append(source_consumer)
     if exit_script_when_finish:
         wait_for_possible_has_finish_all_tasks_by_conusmer_list(consumer_list=source_consumer_list, minutes=2)
         for (source_queue_name, source_broker_kind, target_queue_name, target_broker_kind) in source_target_list:
             print(f'{source_queue_name}  转移到 {target_queue_name} 消息转移完成，结束脚本')
-        os._exit(999)  # 结束脚本
-
-
+        os._exit(999)  #
 if __name__ == '__main__':
     # 一次转移一个队列，使用单进程
-    # consume_and_push_to_another_queue('test_queue77h3', BrokerEnum.RABBITMQ_AMQPSTORM,
-    #                                   'test_queue77h3_dlx', BrokerEnum.RABBITMQ_AMQPSTORM,
-    #                                   log_level_int=logging.INFO, exit_script_when_finish=True)
+    consume_and_push_to_another_queue('test_queue77h3_dlx', BrokerEnum.RABBITMQ_AMQPSTORM,
+                                      'test_queue77h3', BrokerEnum.RABBITMQ_AMQPSTORM,
+                                      log_level_int=logging.INFO, exit_script_when_finish=True)
 
     # 转移多个队列，并使用多进程。
     multi_prcocess_queue2queue([['test_queue77h5', BrokerEnum.RABBITMQ_AMQPSTORM, 'test_queue77h4', BrokerEnum.RABBITMQ_AMQPSTORM]],
                                log_level_int=logging.INFO, exit_script_when_finish=True, n=6)
```

## funboost/publishers/base_publisher.py

```diff
@@ -193,22 +193,28 @@
         :param msg:函数的入参字典或者字典转json。,例如消费函数是 def add(x,y)，你就发布 {"x":1,"y":2}
         :param task_id:可以指定task_id,也可以不指定就随机生产uuid
         :param priority_control_config:优先级配置，消息可以携带优先级配置，覆盖boost的配置。
         :return:
         """
         if isinstance(msg, str):
             msg = json.loads(msg)
-        msg_function_kw = copy.copy(msg)
+        msg_function_kw = copy.deepcopy(msg)
+        raw_extra = {}
+        if 'extra' in msg:
+            msg_function_kw.pop('extra')
+            raw_extra = msg['extra']
         if self.publish_params_checker:
-            self.publish_params_checker.check_params(msg)
+            self.publish_params_checker.check_params(msg_function_kw)
         task_id = task_id or f'{self._queue_name}_result:{uuid.uuid4()}'
-        msg['extra'] = extra_params = {'task_id': task_id, 'publish_time': round(time.time(), 4),
+        extra_params = {'task_id': task_id, 'publish_time': round(time.time(), 4),
                                        'publish_time_format': time.strftime('%Y-%m-%d %H:%M:%S')}
         if priority_control_config:
             extra_params.update(priority_control_config.to_dict())
+        extra_params.update(raw_extra)
+        msg['extra'] =extra_params
         t_start = time.time()
         decorators.handle_exception(retry_times=10, is_throw_error=True, time_sleep=0.1)(
             self.concrete_realization_of_publish)(json.dumps(msg, ensure_ascii=False))
         self.logger.debug(f'向{self._queue_name} 队列，推送消息 耗时{round(time.time() - t_start, 4)}秒  {msg_function_kw}')  # 显示msg太长了。
         with self._lock_for_count:
             self.count_per_minute += 1
             self.publish_msg_num_total += 1
```

## funboost/publishers/celery_publisher.py

```diff
@@ -1,32 +1,23 @@
 # -*- coding: utf-8 -*-
 # @Author  : ydf
 # @Time    : 2022/8/8 0008 12:12
+import os
+import sys
 import uuid
 import copy
 import time
 import threading
 import json
 import celery
 import celery.result
 import typing
 
+from funboost.assist.celery_helper import celery_app
 from funboost.publishers.base_publisher import AbstractPublisher, PriorityConsumingControlConfig
-from funboost import funboost_config_deafult
-
-celery_app = celery.Celery(broker=funboost_config_deafult.CELERY_BROKER_URL,
-                           backend=funboost_config_deafult.CELERY_RESULT_BACKEND,
-                           task_routes={}, timezone=funboost_config_deafult.TIMEZONE, enable_utc=False)
-
-celery_app.conf.task_acks_late = True
-
-# celery_app.conf.worker_task_log_format = '%(asctime)s - %(name)s - "%(pathname)s:%(lineno)d" - %(funcName)s - %(levelname)s - %(message)s'
-# celery_app.conf.worker_log_format = '%(asctime)s - %(name)s - "%(pathname)s:%(lineno)d" - %(funcName)s - %(levelname)s - %(message)s'
-
-celery_app.conf.worker_redirect_stdouts = False
 
 
 class CeleryPublisher(AbstractPublisher, ):
     """
     使用celery作为中间件
     """
     celery_conf_lock = threading.Lock()
@@ -48,22 +39,28 @@
 
         celery_app.conf.task_routes.update({self.queue_name: {"queue": self.queue_name}})
 
     def publish(self, msg: typing.Union[str, dict], task_id=None,
                 priority_control_config: PriorityConsumingControlConfig = None) -> celery.result.AsyncResult:
         if isinstance(msg, str):
             msg = json.loads(msg)
-        msg_function_kw = copy.copy(msg)
+        msg_function_kw = copy.deepcopy(msg)
+        raw_extra = {}
+        if 'extra' in msg:
+            msg_function_kw.pop('extra')
+            raw_extra = msg['extra']
         if self.publish_params_checker:
-            self.publish_params_checker.check_params(msg)
+            self.publish_params_checker.check_params(msg_function_kw)
         task_id = task_id or f'{self._queue_name}_result:{uuid.uuid4()}'
-        msg['extra'] = extra_params = {'task_id': task_id, 'publish_time': round(time.time(), 4),
-                                       'publish_time_format': time.strftime('%Y-%m-%d %H:%M:%S')}
+        extra_params = {'task_id': task_id, 'publish_time': round(time.time(), 4),
+                        'publish_time_format': time.strftime('%Y-%m-%d %H:%M:%S')}
         if priority_control_config:
             extra_params.update(priority_control_config.to_dict())
+        extra_params.update(raw_extra)
+        msg['extra'] = extra_params
 
         t_start = time.time()
         celery_result = celery_app.send_task(name=self.queue_name, kwargs=msg_function_kw, task_id=extra_params['task_id'])  # type: celery.result.AsyncResult
         self.logger.debug(f'向{self._queue_name} 队列，推送消息 耗时{round(time.time() - t_start, 4)}秒  {msg_function_kw}')  # 显示msg太长了。
         with self._lock_for_count:
             self.count_per_minute += 1
             self.publish_msg_num_total += 1
@@ -74,14 +71,21 @@
         # return AsyncResult(task_id)
         return celery_result  # 这里返回celery结果原生对象，类型是 celery.result.AsyncResult。
 
     def concrete_realization_of_publish(self, msg):
         pass
 
     def clear(self):
-        pass
+        python_executable = sys.executable
+        cmd = f''' {python_executable} -m celery -A funboost.publishers.celery_publisher purge -Q {self.queue_name} -f'''
+        self.logger.warning(f'刪除celery {self.queue_name} 隊列中的消息  {cmd}')
+        os.system(cmd)
 
     def get_message_count(self):
-        return -1
+        # return -1
+        with celery_app.connection_or_acquire() as conn:
+            msg_cnt = conn.default_channel.queue_declare(
+                queue=self.queue_name, passive=False).message_count
+        return msg_cnt
 
     def close(self):
         pass
```

## funboost/publishers/kombu_publisher.py

```diff
@@ -78,14 +78,15 @@
 
     @deco_mq_conn_error
     def concrete_realization_of_publish(self, msg):
         self.producer.publish(json.loads(msg), exchange=self.exchange, routing_key=self._queue_name, declare=[self.queue])
 
     @deco_mq_conn_error
     def clear(self):
+        self.logger.warning(f'kombu清空消息队列 {self.queue_name}')
         self.channel.queue_purge(self._queue_name)
 
     @deco_mq_conn_error
     def get_message_count(self):
         # queue = self.channel.queue_declare(queue=self._queue_name, durable=True)
         # return queue.method.message_count
         # self.logger.warning(self.channel._size(self._queue_name))
```

## funboost/utils/redis_manager.py

```diff
@@ -83,15 +83,15 @@
     @property
     @decorators.cached_method_result
     def redis_db_filter_and_rpc_result_version3(self):
         return redis3.Redis(host=funboost_config_deafult.REDIS_HOST, port=funboost_config_deafult.REDIS_PORT,
                             password=funboost_config_deafult.REDIS_PASSWORD, db=funboost_config_deafult.REDIS_DB_FILTER_AND_RPC_RESULT, decode_responses=True)
 
     def timestamp(self):
-        """ 如果是多台机器做分布式控频 乃至确认消费，每台机器取自己的时间，如果各机器的时间戳不一致会发生问题，改成统一使用从redis服务端获取时间。"""
+        """ 如果是多台机器做分布式控频 乃至确认消费，每台机器取自己的时间，如果各机器的时间戳不一致会发生问题，改成统一使用从redis服务端获取时间，单位是时间戳秒。"""
         time_tuple = self.redis_db_frame_version3.time()
         # print(time_tuple)
         return time_tuple[0] + time_tuple[1] / 1000000
 
 
 class AioRedisMixin(object):
     @property
```

## Comparing `funboost-20.8.dist-info/LICENSE` & `funboost-20.9.dist-info/LICENSE`

 * *Files identical despite different names*

## Comparing `funboost-20.8.dist-info/METADATA` & `funboost-20.9.dist-info/METADATA`

 * *Files 0% similar despite different names*

```diff
@@ -1,10 +1,10 @@
 Metadata-Version: 2.1
 Name: funboost
-Version: 20.8
+Version: 20.9
 Summary: pip install funboost，python全功能分布式函数调度框架,。支持python所有类型的并发模式和一切知名消息队列中间件，python函数加速器，框架包罗万象，一统编程思维，兼容50% python业务场景，适用范围广。只需要一行代码即可分布式执行python一切函数，99%用过funboost的pythoner 感受是 方便 快速 强大，相见恨晚 
 Home-page: https://github.com/ydf0509/funboost
 Author: bfzs
 Author-email: ydf0509@sohu.com
 Maintainer: ydf
 Maintainer-email: ydf0509@sohu.com
 License: BSD License
```

## Comparing `funboost-20.8.dist-info/RECORD` & `funboost-20.9.dist-info/RECORD`

 * *Files 1% similar despite different names*

```diff
@@ -1,12 +1,13 @@
-funboost/__init__.py,sha256=8jWW7T0V1u2AVkwpocR4eVxWhjQO5cmpl31y50S7S2Y,21081
+funboost/__init__.py,sha256=OogYd2P1b9gmGWJw-92iZQt7pY5a8gehC9xczg1SaHA,21031
 funboost/constant.py,sha256=1PtxXLXFg7LsHMePU2iZeL2XOF4JUXnanI6kDFeh-JU,5910
 funboost/funboost_config_deafult.py,sha256=hQD7MZtJFQykqqJIULmqNJBwHSBEXGcCs_2LX2oDTdc,7100
-funboost/helpers.py,sha256=KApnbT-OXtgKKlY-MGjTnsP7YxBtDn3k3LL_XOn4TGU,14104
+funboost/helpers.py,sha256=0Z5hsNL1iBNr98S71SqHc0AXXW1umhjXMjrrEzDUe5I,14135
 funboost/set_frame_config.py,sha256=hz_38C-IXEulYpHQdr1fhsMcdEDCHIsF2la8MkHiIjA,9149
+funboost/assist/celery_helper.py,sha256=magWpS4Sn61vpG469v_bDzCJMUz02fBxjAQ4qgrtkdo,3955
 funboost/beggar_version_implementation/beggar_redis_consumer.py,sha256=aiucCkj7-GWbLMIWHhevdQrAsxzyc55AL69fue8esYs,3930
 funboost/concurrent_pool/__init__.py,sha256=dGgxgzMSwcXWMexwAnojsML7EMjHAAsmAofNgrxtl2w,759
 funboost/concurrent_pool/async_helper.py,sha256=iyb0Jcjyx-vkUGC_saSUWqN657kcR5K7B-L_SB6cDCE,3256
 funboost/concurrent_pool/async_pool_executor.py,sha256=zCymNAFuPrV5CuW9hXCyzQ8nLCY73ixvvDsWFPNvt90,7227
 funboost/concurrent_pool/bounded_processpoolexcutor_gt_py37.py,sha256=y6tL41X4sC_d5E2k2sNz0JZUJU2hyJDyMcOi2RzkI_w,4723
 funboost/concurrent_pool/bounded_processpoolexcutor_py36.py,sha256=fwhCvXCRILshQbGVv5Y9kFqCZsX0VMKTUdLhI9dLDbg,3011
 funboost/concurrent_pool/bounded_threadpoolexcutor.py,sha256=T1mJA1yxUYAkoDjrJMxCPPxSF3bUH4_5AFpYx3PWjfQ,1571
@@ -17,19 +18,19 @@
 funboost/concurrent_pool/custom_threadpool_executor000.py,sha256=jJLXy3h-bELap6nZA6yLtdozzTWcvCtZ7IY6MTqLEAM,9317
 funboost/concurrent_pool/single_thread_executor.py,sha256=NDWOegh8Nxpb-Bp-lUlj-DONWvepSmA9qepL1yNgdQI,373
 funboost/concurrent_pool/backup/__init__.py,sha256=47DEQpj8HBSa-_TImW-5JCeuQeRkm5NMpJWZG3hSuFU,0
 funboost/concurrent_pool/backup/async_pool_executor0223.py,sha256=iTxxJFk2lu1P9ZAIkBip3euq3oEQ4_qTODy3xUaOecY,9548
 funboost/concurrent_pool/backup/async_pool_executor_back.py,sha256=vIgUUyF4Zb0jIRPWgNPqyO09YEkQP32kkpGBldqm4qA,9568
 funboost/concurrent_pool/backup/async_pool_executor_janus.py,sha256=OHMWJ9l3EYTpPpcrPrGGKd4K0tmQ2PN8HiX0Dta0EOo,5728
 funboost/consumers/__init__.py,sha256=ZXY_6Kut1VYNQiF5aWEgIWobsW1ht9YUP0TdRZRWFqI,126
-funboost/consumers/base_consumer.py,sha256=hl5cLNGE4JhRN5MI633pFxmfeeMomC5vzY7SmLxPI_0,94087
-funboost/consumers/celery_consumer.py,sha256=MUF3Zc2WOD2l4eCZ0FhfQmR4p_qmMs5z-zHT0xnk-Vs,11737
+funboost/consumers/base_consumer.py,sha256=r4Qz_pQXAK-HPAVTSGnn01VxApVimhWJySOS0295JJE,96280
+funboost/consumers/celery_consumer.py,sha256=EkKR9IGOOjj92S5eZw8L6fYUzGj60sfzx8yuXOw1_4s,7431
 funboost/consumers/celery_consumer000.py,sha256=8SF8ppHIMH-BIAHO0NyJYnSQxe_PcT6hv05e7DySG54,4574
 funboost/consumers/confirm_mixin.py,sha256=H0w07PceU2gGf6X1EXvAB5oD7IavzGv96bQTxm-58sE,5877
-funboost/consumers/http_consumer.py,sha256=zkEdYTz4xnRhLJq4JftCTehAb5oTjvnVaMjBNEP7Sfk,2067
+funboost/consumers/http_consumer.py,sha256=3HF8tsH90fUPX3iOmVid_nqW_7hZCFaL7feOkuAM36U,2025
 funboost/consumers/http_consumer000.py,sha256=NXOSiN1qpLAJfJkuF6SjFpWQ28YxMDULzWCBTNMwYe8,4463
 funboost/consumers/httpsqs_consumer.py,sha256=LICZzovaMVrZsJY4GgLrk3EaHz8f9ZZBLKZtWl3frMc,1080
 funboost/consumers/kafka_consumer.py,sha256=2BZT5UQIGqjS1emsX--V1J8gWFOhMjCMMiSnWy_Hto0,4217
 funboost/consumers/kafka_consumer_manually_commit.py,sha256=OJvua_kEZ8_MRuRxW9Jz5aiebM1tYSdjzQfVXd0sBd0,6556
 funboost/consumers/kombu_consumer.py,sha256=VlU5LR69G0we6K5UCzWOiz-Ul_LJArWznMvTUCBwyR8,10186
 funboost/consumers/local_python_queue_consumer.py,sha256=29r44zUZPBIREvsHOfw59kRvwvfVBE2AJ8wWmXDh_3Y,1291
 funboost/consumers/mongomq_consumer.py,sha256=W5d4QnYun1OnnCn8K41ZmXuGdpAXmnzAa4EI7H7KQO4,1090
@@ -54,15 +55,15 @@
 funboost/consumers/rocketmq_consumer.py,sha256=sqJwxNFOz7c-4Dbk5Rgj_iJqDVwRVCGsw_tMTArGc2o,1653
 funboost/consumers/sqlachemy_consumer.py,sha256=-pY9pvAVUCw_T-1bRKRT37vNGjvv6BK9h-I5kfelpVk,1309
 funboost/consumers/tcp_consumer.py,sha256=hgjcXOtHyGBDS_h_p0gbOtF__Ba6DS1Chk5P9nc6Its,2045
 funboost/consumers/txt_file_consumer.py,sha256=rd8F7liwUfidk7SXY-qF4Iamx-U1NXJBYsOhOudFyyU,1340
 funboost/consumers/udp_consumer.py,sha256=J-G1ZYktXZ_er_1fg3FdSPVl4V_eEIHZXlBadCNpJmE,1643
 funboost/consumers/zeromq_consumer.py,sha256=7V1RwZKtPDDpjKTKj4GWGuz1AGZ83EBHCnWuYN4ooSM,4157
 funboost/contrib/__init__.py,sha256=47DEQpj8HBSa-_TImW-5JCeuQeRkm5NMpJWZG3hSuFU,0
-funboost/contrib/queue2queue.py,sha256=zSIOaj9dPjskV0Rzk-T6gLeO0X-vCZb1pQ1YvCCafOM,4703
+funboost/contrib/queue2queue.py,sha256=I6e1d2s_TQ_29rbwSs3KuA7Tuj9B905EcJruT287CnM,4680
 funboost/contrib/redis_consume_latest_msg_broker.py,sha256=V-8-pOyotOXNbs2olS7vig-yN1PxRdw_MeLOtpUufJc,1817
 funboost/factories/__init__.py,sha256=s7kKKjR1HU5eMjPD6r5b-SXTVMo1zBp2JjOAtkyt5Yo,178
 funboost/factories/broker_kind__publsiher_consumer_type_map.py,sha256=eG4DO0x2d5oZBrqK93B1VXMPgYrQtPuLInyBZxz_JNI,8362
 funboost/factories/consumer_factory.py,sha256=3BcdYqTH1UvH3Q0V7eqZ9ePHLyywDr-07fPlTjJeD8w,1032
 funboost/factories/publisher_factotry.py,sha256=sQTvGgVnJidpGAe-01rbu9_bYU7hKhSsjM6vShLkP1g,2367
 funboost/function_result_web/app.py,sha256=xUSDBwwDA5wQVWFdFBXj9Y1s7BOh2itUw5pCZl0URMw,4841
 funboost/function_result_web/functions.py,sha256=OIPMxc4jv51qnhBxFGfTZnpMx5p4lQflPoTviDTbJUc,7345
@@ -78,22 +79,22 @@
 funboost/function_result_web/static/images/password.png,sha256=0jRivuQAhWKtkS73p8f_KiLy3D39_flqVTrpFKJPNqk,546
 funboost/function_result_web/static/images/tick.png,sha256=S9dZYN4HQzw7JsWPw3ut1dQp4OTJ_Uh2Qp2KUDF1Jv8,2912
 funboost/function_result_web/static/images/user.png,sha256=HxLjNc83WZzZEscZRdmVhGKlPXNdp_EKmmYxafuyb3g,622
 funboost/function_result_web/static/js/jquery-1.11.0.min.js,sha256=ryQZ3RXgnqkTz-lNEw-YcEhnMuV3ZODwLqOEbyBBRu4,96383
 funboost/function_result_web/templates/index.html,sha256=dWe-JFQhsDpoNjSsBF4P6SJWp_KvHX8EP_yECS5r7_o,19501
 funboost/function_result_web/templates/login.html,sha256=q37dj7O0LeyiV38Zd5P1Qn_qmhjdFomuYTRY1Yk48Bo,2007
 funboost/publishers/__init__.py,sha256=xqBHlvsJQVPfbdvP84G0LHmVB7-pFBS7vDnX1Uo9pVY,131
-funboost/publishers/base_publisher.py,sha256=davLWo-tSw7gwqF4fMrxlcz-sitZ9kqpfofb0yjp_ok,14894
-funboost/publishers/celery_publisher.py,sha256=gWZDJpgcAc2YaASaHiGmj1WKLE3XLuMZUsvclrYYL94,3660
+funboost/publishers/base_publisher.py,sha256=hFHMGGoPdCBgJ1xVQ2buXnX21e-Hp0AHuzRuNKf5dDw,15103
+funboost/publishers/celery_publisher.py,sha256=OSNra9kx1_iSOc5WkqMTBkMvICBdRI2Eww1YVtf-eEE,3724
 funboost/publishers/celery_publisher000.py,sha256=ag2s7MzPPrnNdza3u8vcbDJqtiqbQw4lJJzAVuJ6GF0,3897
 funboost/publishers/confluent_kafka_publisher.py,sha256=cpbyWvZ0T_kM62LWeBKRUuEuMkJAKOof97UUMSz6-Dk,3541
 funboost/publishers/http_publisher.py,sha256=pS3z_AVqH6h4PAgqB7usihvzLJP5ZzfPKQRMQfHrJHQ,753
 funboost/publishers/httpsqs_publisher.py,sha256=7cf5ijwrbp4smq6ofndrKisruAqG0Wzfo_d_7bnLUk4,2783
 funboost/publishers/kafka_publisher.py,sha256=cmlJ0mvwq0Ajlth4VQqwnoe6v_bZ4eIz49GgkiJr-ZU,2160
-funboost/publishers/kombu_publisher.py,sha256=1tsYCngzx0PR9a4cF2vzvzW3S2wUYObKhfvaqOqDNNo,5246
+funboost/publishers/kombu_publisher.py,sha256=TJt24M_Y4x8wjXHFl2hp6z3Dat6rjuA_xGiqA8RbRLg,5321
 funboost/publishers/local_python_queue_publisher.py,sha256=veskMS5tjeneYU9HmrJLXZSK9_UT48NzHzcljjOoy3g,1365
 funboost/publishers/mongomq_publisher.py,sha256=xQr3KMQEKksX4OEvzPlCl8v1VeBHaoZtYw2QujOUyGo,1874
 funboost/publishers/mqtt_publisher.py,sha256=NKVDE5R12QL99IXgRjJtF4phyW8QaXKxHkqW5p_kXr4,3050
 funboost/publishers/msg_result_getter.py,sha256=a2ffSE8Rvz1t1KVEt4UxIPsWgcriaHE_Armkac-JrJY,7782
 funboost/publishers/nameko_publisher.py,sha256=HtR8I_NemyJCO2KL-w8geNMhZcoj06_95QZ8qq1-gog,2147
 funboost/publishers/nats_publisher.py,sha256=hFfaQovij9dm8w-iRN0SgiHHoS_TlrTAjw42dPwCLSA,776
 funboost/publishers/nsq_publisher.py,sha256=Go4UjLd_Vt4JuVtfkmCuuXrmxUXv1y6NaBQJX6s1XUo,1302
@@ -130,15 +131,15 @@
 funboost/utils/develop_log.py,sha256=f82JHBPBjdF_By5P_Ft4wMREeIHtF8MmqGFYa_pZbyA,251
 funboost/utils/mongo_util.py,sha256=9oAWgYMBdP1rqY2KySW_VEuEBq8Xdsf5lgml4484OzM,2984
 funboost/utils/monkey_color_log.py,sha256=QChhQMTB6phZ2eBaPq-9tFZF1n7pWeJgmJPIB_ugkvs,7367
 funboost/utils/monkey_patches.py,sha256=Q0_jKxOfFrSgrIDSuSZFrgNh6w_LRGaKAITghrIpEwI,2882
 funboost/utils/mqtt_util.py,sha256=BfCmyYwI-B8VL9499_IuYlJDCbv6ZhwyWThMf8dANOU,3199
 funboost/utils/paramiko_util.py,sha256=pu67zkgptqNSV9m2Lznezb3zF1AFYvkWJp_6DVKFSPU,4901
 funboost/utils/rabbitmq_factory.py,sha256=NPzTwG-INZG9aJgkzp-QVk3TgV0rjiuTVT5lmRT77zg,2963
-funboost/utils/redis_manager.py,sha256=mWwrED5DzFVRJaGsUIKUCgaixo5-DqqXm36BAR5_jxE,4604
+funboost/utils/redis_manager.py,sha256=2Hg9UT-X6nS5TkZ-YrTRxRK-WPHZaLOsuvTxYuD1cCc,4628
 funboost/utils/resource_monitoring.py,sha256=vf1htYa3a4wlMfQqksvIINMw8laiXwG5N8NXU2Zm3qQ,5532
 funboost/utils/restart_python.py,sha256=bFbV0_24ajL8hBwVRLxWe9v9kTwiX1fGLhXRroNnmgQ,1418
 funboost/utils/show_funboost_flag.py,sha256=A4WB5P7SO9tFux1Y4yIurLmjLj09B973hq3LxEo4HOY,2985
 funboost/utils/simple_data_class.py,sha256=HgFyyrw2mDuMX6l-re8W6q-6HXwhg2MalpIbP9JKW70,1204
 funboost/utils/time_util.py,sha256=Y-P6KowTNgGwXHzfQd4KnHdfLl8vAOqhg626MCKDvtA,5407
 funboost/utils/un_strict_json_dumps.py,sha256=uh2mXNRCq5dJcqMhb9CkfvehfEGYZAgI6RY1oLcYX_M,408
 funboost/utils/dependency_packages/__init__.py,sha256=47DEQpj8HBSa-_TImW-5JCeuQeRkm5NMpJWZG3hSuFU,0
@@ -207,12 +208,12 @@
 funboost/utils/dependency_packages_in_pythonpath/func_timeout/__pycache__/py3_raise.cpython-37.pyc,sha256=67Zqz4tjErzQSm9FM9mGaY3uMHYOUj3QYKtPqJQvQpE,303
 funboost/utils/dependency_packages_in_pythonpath/func_timeout/__pycache__/py3_raise.cpython-39.pyc,sha256=a1ajayGg3JjQz--IC3-6YQHRFStG9etoieY8mXEdJ6Q,311
 funboost/utils/pysnooper_ydf/__init__.py,sha256=ctbQdJpLVZ5g_PPstj7Xaqcl0sMIgvUGwZXtcogYyHA,909
 funboost/utils/pysnooper_ydf/pycompat.py,sha256=ehsCfjsLdwoK0_o5fwYWDo3WeqCVfHW5lxekrEZxq4Y,2243
 funboost/utils/pysnooper_ydf/tracer.py,sha256=DYxYeRFSH1jXy4OTB5KIAgQm2EHRWEOwq3EXJig7Yrk,19131
 funboost/utils/pysnooper_ydf/utils.py,sha256=evSmGi_Oul7vSP47AJ0DLjFwoCYCfunJZ1mWxAkwPZw,2753
 funboost/utils/pysnooper_ydf/variables.py,sha256=QejRDESBA06KG9OH4sBT4J1M55eaU29EIHg8K_igaXo,3693
-funboost-20.8.dist-info/LICENSE,sha256=HrhfyXIkWY2tGFK11kg7vPCqhgh5DcxleloqdhrpyMY,11558
-funboost-20.8.dist-info/METADATA,sha256=jXHSxD4AhdsObGTfMsinHr1G5_viUQYRoqha6PfJn_w,26332
-funboost-20.8.dist-info/WHEEL,sha256=D1Wh14kWDxPnrM-5t_6UCB-UuQNrEODtRa3vF4OsvQY,97
-funboost-20.8.dist-info/top_level.txt,sha256=K8WuKnS6MRcEWxP1NvbmCeujJq6TEfbsB150YROlRw0,9
-funboost-20.8.dist-info/RECORD,,
+funboost-20.9.dist-info/LICENSE,sha256=HrhfyXIkWY2tGFK11kg7vPCqhgh5DcxleloqdhrpyMY,11558
+funboost-20.9.dist-info/METADATA,sha256=kbHFsKMMSalMkNXhZectXtUsBV5mxet4VXoP_zbApSk,26332
+funboost-20.9.dist-info/WHEEL,sha256=D1Wh14kWDxPnrM-5t_6UCB-UuQNrEODtRa3vF4OsvQY,97
+funboost-20.9.dist-info/top_level.txt,sha256=K8WuKnS6MRcEWxP1NvbmCeujJq6TEfbsB150YROlRw0,9
+funboost-20.9.dist-info/RECORD,,
```

