# Comparing `tmp/censoredsummarystats-0.0.4.tar.gz` & `tmp/censoredsummarystats-0.0.5.tar.gz`

## filetype from file(1)

```diff
@@ -1 +1 @@
-gzip compressed data, was "censoredsummarystats-0.0.4.tar", max compression
+gzip compressed data, was "censoredsummarystats-0.0.5.tar", max compression
```

## Comparing `censoredsummarystats-0.0.4.tar` & `censoredsummarystats-0.0.5.tar`

### file list

```diff
@@ -1,7 +1,7 @@
--rw-r--r--   0        0        0      123 2023-05-10 02:13:31.336281 censoredsummarystats-0.0.4/censoredsummarystats/__init__.py
--rw-r--r--   0        0        0    63774 2023-05-14 10:04:27.004920 censoredsummarystats-0.0.4/censoredsummarystats/statistics.py
--rw-r--r--   0        0        0     2291 2023-04-29 21:55:33.186386 censoredsummarystats-0.0.4/censoredsummarystats/utils.py
--rw-r--r--   0        0        0    11558 2023-03-12 00:39:53.769556 censoredsummarystats-0.0.4/LICENSE
--rw-r--r--   0        0        0      558 2023-05-14 10:12:09.207115 censoredsummarystats-0.0.4/pyproject.toml
--rw-r--r--   0        0        0     4309 2023-05-14 10:11:56.349705 censoredsummarystats-0.0.4/README.md
--rw-r--r--   0        0        0     5005 1970-01-01 00:00:00.000000 censoredsummarystats-0.0.4/PKG-INFO
+-rw-r--r--   0        0        0      123 2023-05-10 02:13:31.336281 censoredsummarystats-0.0.5/censoredsummarystats/__init__.py
+-rw-r--r--   0        0        0    64146 2023-05-17 00:37:31.628109 censoredsummarystats-0.0.5/censoredsummarystats/statistics.py
+-rw-r--r--   0        0        0     2291 2023-04-29 21:55:33.186386 censoredsummarystats-0.0.5/censoredsummarystats/utils.py
+-rw-r--r--   0        0        0    11558 2023-03-12 00:39:53.769556 censoredsummarystats-0.0.5/LICENSE
+-rw-r--r--   0        0        0      558 2023-05-17 00:37:56.637351 censoredsummarystats-0.0.5/pyproject.toml
+-rw-r--r--   0        0        0     4309 2023-05-14 10:11:56.349705 censoredsummarystats-0.0.5/README.md
+-rw-r--r--   0        0        0     5005 1970-01-01 00:00:00.000000 censoredsummarystats-0.0.5/PKG-INFO
```

### Comparing `censoredsummarystats-0.0.4/censoredsummarystats/statistics.py` & `censoredsummarystats-0.0.5/censoredsummarystats/statistics.py`

 * *Files 1% similar despite different names*

```diff
@@ -3228,759 +3228,783 @@
 0000c9b0: 6674 5f62 6f75 6e64 5f63 6f6c 5d20 3e3d  ft_bound_col] >=
 0000c9c0: 2074 6872 6573 686f 6c64 292c 0d0a 2020   threshold),..  
 0000c9d0: 2020 2020 2020 2020 2020 2320 4966 2074            # If t
 0000c9e0: 6865 2072 6967 6874 2062 6f75 6e64 2069  he right bound i
 0000c9f0: 7320 6c65 7373 2074 6861 6e20 7468 6520  s less than the 
 0000ca00: 7472 6573 686f 6c64 2074 6861 6e20 6e6f  treshold than no
 0000ca10: 6e2d 6578 6365 6564 616e 6365 0d0a 2020  n-exceedance..  
-0000ca20: 2020 2020 2020 2020 2020 2864 665b 7269            (df[ri
-0000ca30: 6768 745f 626f 756e 645f 636f 6c5d 203c  ght_bound_col] <
-0000ca40: 2074 6872 6573 686f 6c64 290d 0a20 2020   threshold)..   
-0000ca50: 2020 2020 2020 2020 205d 0d0a 2020 2020           ]..    
-0000ca60: 656c 7365 3a0d 0a20 2020 2020 2020 2023  else:..        #
-0000ca70: 2053 6574 2063 6f6e 6469 7469 6f6e 7320   Set conditions 
-0000ca80: 666f 7220 6578 6365 6564 616e 6365 7320  for exceedances 
-0000ca90: 616e 6420 6e6f 6e2d 6578 6365 6564 616e  and non-exceedan
-0000caa0: 6365 730d 0a20 2020 2020 2020 2063 6f6e  ces..        con
-0000cab0: 6469 7469 6f6e 7320 3d20 5b0d 0a20 2020  ditions = [..   
-0000cac0: 2020 2020 2020 2020 2023 2049 6620 7468           # If th
-0000cad0: 6520 6c65 6674 2062 6f75 6e64 2069 7320  e left bound is 
-0000cae0: 6772 6561 7465 7220 7468 616e 2074 6865  greater than the
-0000caf0: 2074 6872 6573 686f 6c64 2074 6861 6e20   threshold than 
-0000cb00: 6578 6365 6564 616e 6365 0d0a 2020 2020  exceedance..    
-0000cb10: 2020 2020 2020 2020 2864 665b 6c65 6674          (df[left
-0000cb20: 5f62 6f75 6e64 5f63 6f6c 5d20 3e20 7468  _bound_col] > th
-0000cb30: 7265 7368 6f6c 6429 2c0d 0a20 2020 2020  reshold),..     
-0000cb40: 2020 2020 2020 2023 2049 6620 7468 6520         # If the 
-0000cb50: 7269 6768 7420 626f 756e 6420 6973 206c  right bound is l
-0000cb60: 6573 7320 7468 616e 206f 7220 6571 7561  ess than or equa
-0000cb70: 6c20 746f 2074 6865 2074 7265 7368 6f6c  l to the treshol
-0000cb80: 6420 7468 616e 206e 6f6e 2d65 7863 6565  d than non-excee
-0000cb90: 6461 6e63 650d 0a20 2020 2020 2020 2020  dance..         
-0000cba0: 2020 2028 6466 5b72 6967 6874 5f62 6f75     (df[right_bou
-0000cbb0: 6e64 5f63 6f6c 5d20 3c3d 2074 6872 6573  nd_col] <= thres
-0000cbc0: 686f 6c64 290d 0a20 2020 2020 2020 2020  hold)..         
-0000cbd0: 2020 205d 0d0a 2020 2020 2320 4578 6365     ]..    # Exce
-0000cbe0: 6564 616e 6365 7320 6172 6520 696e 6469  edances are indi
-0000cbf0: 6361 7465 6420 6279 2069 6e74 6567 6572  cated by integer
-0000cc00: 730d 0a20 2020 2023 2028 313d 6578 6365  s..    # (1=exce
-0000cc10: 6564 616e 6365 2c20 303d 6e6f 6e2d 6578  edance, 0=non-ex
-0000cc20: 6365 6564 616e 6365 290d 0a20 2020 2072  ceedance)..    r
-0000cc30: 6573 756c 7473 203d 205b 0d0a 2020 2020  esults = [..    
-0000cc40: 2020 2020 312c 0d0a 2020 2020 2020 2020      1,..        
-0000cc50: 300d 0a20 2020 2020 2020 205d 0d0a 2020  0..        ]..  
-0000cc60: 2020 2320 4465 6661 756c 7420 6578 6365    # Default exce
-0000cc70: 6564 616e 6365 2028 6e70 2e6e 616e 3d75  edance (np.nan=u
-0000cc80: 6e6b 6e6f 776e 290d 0a20 2020 2064 665b  nknown)..    df[
-0000cc90: 275f 5f45 7863 6565 6461 6e63 655f 5f27  '__Exceedance__'
-0000cca0: 5d20 3d20 6e70 2e73 656c 6563 7428 636f  ] = np.select(co
-0000ccb0: 6e64 6974 696f 6e73 2c20 7265 7375 6c74  nditions, result
-0000ccc0: 732c 206e 702e 6e61 6e29 0d0a 2020 2020  s, np.nan)..    
-0000ccd0: 0d0a 2020 2020 7265 7475 726e 2064 660d  ..    return df.
-0000cce0: 0a0d 0a64 6566 2070 6572 6365 6e74 5f65  ...def percent_e
-0000ccf0: 7863 6565 6461 6e63 6528 6466 2c0d 0a20  xceedance(df,.. 
-0000cd00: 2020 2020 2020 2020 2020 2020 2020 2020                  
-0000cd10: 2020 2020 2020 7265 7375 6c74 735f 636f        results_co
-0000cd20: 6c2c 0d0a 2020 2020 2020 2020 2020 2020  l,..            
-0000cd30: 2020 2020 2020 2020 2020 2074 6872 6573             thres
-0000cd40: 686f 6c64 2c0d 0a20 2020 2020 2020 2020  hold,..         
-0000cd50: 2020 2020 2020 2020 2020 2020 2020 636f                co
-0000cd60: 756e 745f 7468 7265 7368 6f6c 645f 6173  unt_threshold_as
-0000cd70: 5f65 7863 6565 6461 6e63 653d 4661 6c73  _exceedance=Fals
-0000cd80: 652c 0d0a 2020 2020 2020 2020 2020 2020  e,..            
-0000cd90: 2020 2020 2020 2020 2020 2067 726f 7570             group
-0000cda0: 6279 5f63 6f6c 7320 3d20 4e6f 6e65 2c0d  by_cols = None,.
-0000cdb0: 0a20 2020 2020 2020 2020 2020 2020 2020  .               
-0000cdc0: 2020 2020 2020 2020 696e 636c 7564 655f          include_
-0000cdd0: 6e65 6761 7469 7665 5f69 6e74 6572 7661  negative_interva
-0000cde0: 6c20 3d20 4661 6c73 6529 3a0d 0a20 2020  l = False):..   
-0000cdf0: 2027 2727 0d0a 2020 2020 4120 6675 6e63   '''..    A func
-0000ce00: 7469 6f6e 2074 6861 7420 636f 6d62 696e  tion that combin
-0000ce10: 6573 2074 6865 2072 656c 6576 616e 7420  es the relevant 
-0000ce20: 7065 7263 656e 7469 6c65 2061 6e64 2075  percentile and u
-0000ce30: 7469 6c69 7479 2066 756e 6374 696f 6e73  tility functions
-0000ce40: 2074 6f0d 0a20 2020 2067 656e 6572 6174   to..    generat
-0000ce50: 6520 7468 6520 7065 7263 656e 6974 6c65  e the percenitle
-0000ce60: 2072 6573 756c 7473 2066 6f72 2067 726f   results for gro
-0000ce70: 7570 7320 7769 7468 696e 2061 2044 6174  ups within a Dat
-0000ce80: 6146 7261 6d65 2e0d 0a0d 0a20 2020 2050  aFrame.....    P
-0000ce90: 6172 616d 6574 6572 730d 0a20 2020 202d  arameters..    -
-0000cea0: 2d2d 2d2d 2d2d 2d2d 2d0d 0a20 2020 2064  ---------..    d
-0000ceb0: 6620 3a20 4461 7461 4672 616d 650d 0a20  f : DataFrame.. 
-0000cec0: 2020 2020 2020 2044 6174 6146 7261 6d65         DataFrame
-0000ced0: 2074 6861 7420 636f 6e74 6169 6e73 2063   that contains c
-0000cee0: 656e 736f 7265 6420 6f72 2075 6e63 656e  ensored or uncen
-0000cef0: 736f 7265 6420 7265 7375 6c74 730d 0a20  sored results.. 
-0000cf00: 2020 2072 6573 756c 7473 5f63 6f6c 203a     results_col :
-0000cf10: 2073 7472 696e 670d 0a20 2020 2020 2020   string..       
-0000cf20: 2054 6865 2063 6f6c 756d 6e20 6e61 6d65   The column name
-0000cf30: 2066 6f72 2074 6865 2063 6f6c 756d 6e20   for the column 
-0000cf40: 7468 6174 2063 6f6e 7461 696e 2074 6865  that contain the
-0000cf50: 2072 6573 756c 7473 2061 7320 7465 7874   results as text
-0000cf60: 2e0d 0a20 2020 2020 2020 204f 6e6c 7920  ...        Only 
-0000cf70: 666f 7572 2070 6f73 7369 626c 6520 6365  four possible ce
-0000cf80: 6e73 6f72 7320 7368 6f75 6c64 2062 6520  nsors should be 
-0000cf90: 7573 6564 2028 3c2c e289 a42c e289 a52c  used (<,...,...,
-0000cfa0: 3e29 2e0d 0a20 2020 2074 6872 6573 686f  >)...    thresho
-0000cfb0: 6c64 203a 2066 6c6f 6174 0d0a 2020 2020  ld : float..    
-0000cfc0: 2020 2020 5468 6520 7468 7265 7368 6f6c      The threshol
-0000cfd0: 6420 6f66 2069 6e74 6572 6573 742e 0d0a  d of interest...
-0000cfe0: 2020 2020 636f 756e 745f 7468 7265 7368      count_thresh
-0000cff0: 6f6c 645f 6173 5f65 7863 6565 6461 6e63  old_as_exceedanc
-0000d000: 6520 3a20 626f 6f6c 6561 6e0d 0a20 2020  e : boolean..   
-0000d010: 2020 2020 2053 6574 2061 7320 5472 7565       Set as True
-0000d020: 2069 6620 7468 6520 7468 7265 7368 6f6c   if the threshol
-0000d030: 6420 7661 6c75 6520 7368 6f75 6c64 2062  d value should b
-0000d040: 6520 636f 756e 7465 6420 6173 2061 6e20  e counted as an 
-0000d050: 6578 6365 6564 616e 6365 2e0d 0a20 2020  exceedance...   
-0000d060: 2020 2020 2054 6865 2064 6566 6175 6c74       The default
-0000d070: 2069 7320 4661 6c73 652e 0d0a 2020 2020   is False...    
-0000d080: 6772 6f75 7062 795f 636f 6c73 203a 206c  groupby_cols : l
-0000d090: 6973 7473 206f 6620 7374 7269 6e67 7320  ists of strings 
-0000d0a0: 286f 7220 6c69 7374 206f 6620 7477 6f20  (or list of two 
-0000d0b0: 6c69 7374 7329 2c20 6f70 7469 6f6e 616c  lists), optional
-0000d0c0: 0d0a 2020 2020 2020 2020 4c69 7374 206f  ..        List o
-0000d0d0: 6620 636f 6c75 6d6e 206e 616d 6573 2074  f column names t
-0000d0e0: 6861 7420 7368 6f75 6c64 2062 6520 7573  hat should be us
-0000d0f0: 6564 2074 6f20 6372 6561 7465 2067 726f  ed to create gro
-0000d100: 7570 732e 2050 6572 6365 6e74 6167 650d  ups. Percentage.
-0000d110: 0a20 2020 2020 2020 206f 6620 6578 6365  .        of exce
-0000d120: 6564 616e 6365 7320 7769 6c6c 2062 6520  edances will be 
-0000d130: 666f 756e 6420 7769 7468 696e 2065 6163  found within eac
-0000d140: 6820 6772 6f75 702e 2054 776f 206c 6973  h group. Two lis
-0000d150: 7473 2063 616e 2062 650d 0a20 2020 2020  ts can be..     
-0000d160: 2020 2073 7570 706c 6965 6420 746f 2066     supplied to f
-0000d170: 6972 7374 2066 696e 6420 7468 6520 6d61  irst find the ma
-0000d180: 7869 6d75 6d20 7769 7468 696e 2065 6163  ximum within eac
-0000d190: 6820 6772 6f75 7020 6265 666f 7265 0d0a  h group before..
-0000d1a0: 2020 2020 2020 2020 6465 7465 726d 696e          determin
-0000d1b0: 696e 6720 7468 6520 7065 7263 656e 7461  ing the percenta
-0000d1c0: 6765 206f 6620 6578 6365 6564 616e 6365  ge of exceedance
-0000d1d0: 7320 6f76 6572 2074 6865 2073 6563 6f6e  s over the secon
-0000d1e0: 6420 6772 6f75 7069 6e67 2e0d 0a20 2020  d grouping...   
-0000d1f0: 2020 2020 2054 6865 2064 6566 6175 6c74       The default
-0000d200: 2069 7320 4e6f 6e65 2e0d 0a20 2020 2069   is None...    i
-0000d210: 6e63 6c75 6465 5f6e 6567 6174 6976 655f  nclude_negative_
-0000d220: 696e 7465 7276 616c 203a 2062 6f6f 6c65  interval : boole
-0000d230: 616e 2c20 6f70 7469 6f6e 616c 0d0a 2020  an, optional..  
-0000d240: 2020 2020 2020 4966 2054 7275 652c 2074        If True, t
-0000d250: 6865 6e20 616c 6c20 706f 7369 7469 7665  hen all positive
-0000d260: 2061 6e64 206e 6567 6174 6976 6520 7661   and negative va
-0000d270: 6c75 6573 2061 7265 2063 6f6e 7369 6465  lues are conside
-0000d280: 7265 640d 0a20 2020 2020 2020 2065 2e67  red..        e.g
-0000d290: 2e2c 203c 302e 3520 776f 756c 6420 6265  ., <0.5 would be
-0000d2a0: 2063 6f6e 7665 7274 6564 2074 6f20 282d   converted to (-
-0000d2b0: 6e70 2e69 6e66 2c35 292e 0d0a 2020 2020  np.inf,5)...    
-0000d2c0: 2020 2020 4966 2046 616c 7365 2c20 7468      If False, th
-0000d2d0: 656e 206f 6e6c 7920 6e6f 6e2d 6e65 6761  en only non-nega
-0000d2e0: 7469 7665 2076 616c 7565 7320 6172 6520  tive values are 
-0000d2f0: 636f 6e73 6964 6572 6564 0d0a 2020 2020  considered..    
-0000d300: 2020 2020 652e 672e 2c20 3c30 2e35 2077      e.g., <0.5 w
-0000d310: 6f75 6c64 2062 6520 636f 6e76 6572 7465  ould be converte
-0000d320: 6420 746f 205b 302c 3529 2e0d 0a20 2020  d to [0,5)...   
-0000d330: 2020 2020 2054 6869 7320 7365 7474 696e       This settin
-0000d340: 6720 6f6e 6c79 2061 6666 6563 7473 2072  g only affects r
-0000d350: 6573 756c 7473 2069 6620 666f 6375 735f  esults if focus_
-0000d360: 6869 6768 5f70 6f74 656e 7469 616c 2069  high_potential i
-0000d370: 7320 4661 6c73 652e 0d0a 2020 2020 2020  s False...      
-0000d380: 2020 5468 6520 6465 6661 756c 7420 6973    The default is
-0000d390: 2046 616c 7365 2e0d 0a0d 0a20 2020 2052   False.....    R
-0000d3a0: 6574 7572 6e73 0d0a 2020 2020 2d2d 2d2d  eturns..    ----
-0000d3b0: 2d2d 2d0d 0a20 2020 2064 6620 3a20 4461  ---..    df : Da
-0000d3c0: 7461 4672 616d 650d 0a20 2020 2020 2020  taFrame..       
-0000d3d0: 2044 6174 6146 7261 6d65 2074 6861 7420   DataFrame that 
-0000d3e0: 636f 6e74 6169 6e73 2063 616c 6375 6c61  contains calcula
-0000d3f0: 7465 6420 7065 7263 656e 7469 6c65 730d  ted percentiles.
-0000d400: 0a0d 0a20 2020 2027 2727 0d0a 2020 2020  ...    '''..    
-0000d410: 0d0a 2020 2020 2320 4372 6561 7465 2061  ..    # Create a
-0000d420: 2063 6f70 7920 6f66 2074 6865 2044 6174   copy of the Dat
-0000d430: 6146 7261 6d65 0d0a 2020 2020 6466 203d  aFrame..    df =
-0000d440: 2064 662e 636f 7079 2829 0d0a 2020 2020   df.copy()..    
-0000d450: 0d0a 2020 2020 2320 5370 6c69 7420 7468  ..    # Split th
-0000d460: 6520 7265 7375 6c74 2069 6e74 6f20 6365  e result into ce
-0000d470: 6e73 6f72 2061 6e64 206e 756d 6572 6963  nsor and numeric
-0000d480: 2063 6f6d 706f 6e65 6e74 730d 0a20 2020   components..   
-0000d490: 2064 6620 3d20 7265 7375 6c74 5f74 6f5f   df = result_to_
-0000d4a0: 636f 6d70 6f6e 656e 7473 2864 662c 7265  components(df,re
-0000d4b0: 7375 6c74 735f 636f 6c29 0d0a 2020 2020  sults_col)..    
-0000d4c0: 0d0a 2020 2020 2320 436f 6e76 6572 7420  ..    # Convert 
-0000d4d0: 7468 6520 7265 7375 6c74 7320 6672 6f6d  the results from
-0000d4e0: 2063 656e 736f 7220 616e 6420 6e75 6d65   censor and nume
-0000d4f0: 7269 6320 636f 6d70 6f6e 656e 7473 2074  ric components t
-0000d500: 6f20 616e 2069 6e74 6572 7661 6c20 7265  o an interval re
-0000d510: 7072 6573 656e 7461 7469 6f6e 0d0a 2020  presentation..  
-0000d520: 2020 6466 203d 2063 6f6d 706f 6e65 6e74    df = component
-0000d530: 735f 746f 5f69 6e74 6572 7661 6c28 6466  s_to_interval(df
-0000d540: 2c20 696e 636c 7564 655f 6e65 6761 7469  , include_negati
-0000d550: 7665 5f69 6e74 6572 7661 6c29 0d0a 2020  ve_interval)..  
-0000d560: 2020 0d0a 2020 2020 2320 4173 7365 7373    ..    # Assess
-0000d570: 2065 7863 6565 6461 6e63 6573 0d0a 2020   exceedances..  
-0000d580: 2020 6466 203d 2070 6572 6365 6e74 5f65    df = percent_e
-0000d590: 7863 6565 6461 6e63 655f 6173 7365 7373  xceedance_assess
-0000d5a0: 6d65 6e74 2864 662c 0d0a 2020 2020 2020  ment(df,..      
-0000d5b0: 2020 2020 2020 2020 2020 2020 2020 2020                  
-0000d5c0: 2020 2020 2020 2020 2020 2020 2020 2020                  
-0000d5d0: 2074 6872 6573 686f 6c64 3d74 6872 6573   threshold=thres
-0000d5e0: 686f 6c64 2c0d 0a20 2020 2020 2020 2020  hold,..         
-0000d5f0: 2020 2020 2020 2020 2020 2020 2020 2020                  
-0000d600: 2020 2020 2020 2020 2020 2020 2020 636f                co
-0000d610: 756e 745f 7468 7265 7368 6f6c 645f 6173  unt_threshold_as
-0000d620: 5f65 7863 6565 6461 6e63 653d 636f 756e  _exceedance=coun
-0000d630: 745f 7468 7265 7368 6f6c 645f 6173 5f65  t_threshold_as_e
-0000d640: 7863 6565 6461 6e63 6529 0d0a 2020 2020  xceedance)..    
-0000d650: 0d0a 2020 2020 2320 4966 2074 6865 7265  ..    # If there
-0000d660: 2061 7265 206e 6f20 6772 6f75 7062 792d   are no groupby-
-0000d670: 636f 6c75 6d6e 732c 2074 6865 6e20 6361  columns, then ca
-0000d680: 6c63 756c 6174 6520 7065 7263 656e 7420  lculate percent 
-0000d690: 6578 6365 6564 616e 6365 7320 6f66 2061  exceedances of a
-0000d6a0: 6c6c 2072 6573 756c 7473 0d0a 2020 2020  ll results..    
-0000d6b0: 6966 206e 6f74 2067 726f 7570 6279 5f63  if not groupby_c
-0000d6c0: 6f6c 733a 0d0a 2020 2020 2020 2020 6466  ols:..        df
-0000d6d0: 203d 2064 662e 6167 6728 2a2a 7b0d 0a20   = df.agg(**{.. 
-0000d6e0: 2020 2020 2020 2020 2020 2020 2020 2065                 e
-0000d6f0: 7863 6565 6461 6e63 6573 5f63 6f6c 3a20  xceedances_col: 
-0000d700: 2827 5f5f 4578 6365 6564 616e 6365 5f5f  ('__Exceedance__
-0000d710: 272c 2773 756d 2729 2c0d 0a20 2020 2020  ','sum'),..     
-0000d720: 2020 2020 2020 2020 2020 2027 5f5f 4465             '__De
-0000d730: 7465 726d 696e 6564 4578 6365 6564 616e  terminedExceedan
-0000d740: 6365 735f 5f27 3a20 2827 5f5f 4578 6365  ces__': ('__Exce
-0000d750: 6564 616e 6365 5f5f 272c 2763 6f75 6e74  edance__','count
-0000d760: 2729 2c0d 0a20 2020 2020 2020 2020 2020  '),..           
-0000d770: 2020 2020 2027 5f5f 546f 7461 6c43 6f75       '__TotalCou
-0000d780: 6e74 5f5f 273a 2028 275f 5f45 7863 6565  nt__': ('__Excee
-0000d790: 6461 6e63 655f 5f27 2c27 7369 7a65 2729  dance__','size')
-0000d7a0: 0d0a 2020 2020 2020 2020 2020 2020 2020  ..              
-0000d7b0: 2020 7d29 2e74 7261 6e73 706f 7365 2829    }).transpose()
-0000d7c0: 2e72 6573 6574 5f69 6e64 6578 2864 726f  .reset_index(dro
-0000d7d0: 703d 5472 7565 290d 0a20 2020 2023 2049  p=True)..    # I
-0000d7e0: 6620 7468 6520 6772 6f75 7062 795f 636f  f the groupby_co
-0000d7f0: 6c73 2069 7320 6120 6c69 7374 206f 6620  ls is a list of 
-0000d800: 6c69 7374 732c 2074 6865 6e20 6173 7365  lists, then asse
-0000d810: 7373 206d 6178 696d 756d 7320 666f 7220  ss maximums for 
-0000d820: 6669 7273 7420 6772 6f75 7069 6e67 0d0a  first grouping..
-0000d830: 2020 2020 2320 616e 6420 7065 7263 656e      # and percen
-0000d840: 7461 6765 206f 6620 6578 6365 6564 616e  tage of exceedan
-0000d850: 6365 7320 666f 7220 7468 6520 7365 636f  ces for the seco
-0000d860: 6e64 2067 726f 7570 696e 670d 0a20 2020  nd grouping..   
-0000d870: 2065 6c69 6620 2869 7369 6e73 7461 6e63   elif (isinstanc
-0000d880: 6528 6772 6f75 7062 795f 636f 6c73 5b30  e(groupby_cols[0
-0000d890: 5d2c 6c69 7374 2929 2026 2028 6c65 6e28  ],list)) & (len(
-0000d8a0: 6772 6f75 7062 795f 636f 6c73 2920 213d  groupby_cols) !=
-0000d8b0: 2032 293a 0d0a 2020 2020 2020 2020 7261   2):..        ra
-0000d8c0: 6973 6520 5661 6c75 6545 7272 6f72 2827  ise ValueError('
-0000d8d0: 5477 6f20 6c69 7374 7320 6d75 7374 2062  Two lists must b
-0000d8e0: 6520 696e 636c 7564 6564 2066 6f72 2067  e included for g
-0000d8f0: 726f 7570 6279 5f63 6f6c 7320 7468 6174  roupby_cols that
-0000d900: 2069 7320 6120 6c69 7374 206f 6620 6c69   is a list of li
-0000d910: 7374 732e 2729 0d0a 2020 2020 656c 6966  sts.')..    elif
-0000d920: 2069 7369 6e73 7461 6e63 6528 6772 6f75   isinstance(grou
-0000d930: 7062 795f 636f 6c73 5b30 5d2c 6c69 7374  pby_cols[0],list
-0000d940: 293a 0d0a 2020 2020 2020 2020 2320 5573  ):..        # Us
-0000d950: 6520 6d61 7869 6d75 6d20 7769 7468 696e  e maximum within
-0000d960: 2065 6163 6820 6772 6f75 7020 666f 7220   each group for 
-0000d970: 6669 7273 7420 6772 6f75 7069 6e67 0d0a  first grouping..
-0000d980: 2020 2020 2020 2020 6466 203d 2064 662e          df = df.
-0000d990: 6772 6f75 7062 7928 6772 6f75 7062 795f  groupby(groupby_
-0000d9a0: 636f 6c73 5b30 5d29 5b27 5f5f 4578 6365  cols[0])['__Exce
-0000d9b0: 6564 616e 6365 5f5f 275d 2e6d 6178 2829  edance__'].max()
-0000d9c0: 2e72 6573 6574 5f69 6e64 6578 2829 0d0a  .reset_index()..
-0000d9d0: 2020 2020 2020 2020 2320 5573 6520 7365          # Use se
-0000d9e0: 636f 6e64 2067 726f 7570 696e 6720 666f  cond grouping fo
-0000d9f0: 7220 7065 7263 656e 7461 6765 206f 6620  r percentage of 
-0000da00: 6578 6365 6564 616e 6365 730d 0a20 2020  exceedances..   
-0000da10: 2020 2020 2064 6620 3d20 6466 2e67 726f       df = df.gro
-0000da20: 7570 6279 2867 726f 7570 6279 5f63 6f6c  upby(groupby_col
-0000da30: 735b 315d 292e 6167 6728 2a2a 7b0d 0a20  s[1]).agg(**{.. 
-0000da40: 2020 2020 2020 2020 2020 2020 2020 2065                 e
-0000da50: 7863 6565 6461 6e63 6573 5f63 6f6c 3a20  xceedances_col: 
-0000da60: 2827 5f5f 4578 6365 6564 616e 6365 5f5f  ('__Exceedance__
-0000da70: 272c 2773 756d 2729 2c0d 0a20 2020 2020  ','sum'),..     
-0000da80: 2020 2020 2020 2020 2020 2027 5f5f 4465             '__De
-0000da90: 7465 726d 696e 6564 4578 6365 6564 616e  terminedExceedan
-0000daa0: 6365 735f 5f27 3a20 2827 5f5f 4578 6365  ces__': ('__Exce
-0000dab0: 6564 616e 6365 5f5f 272c 2763 6f75 6e74  edance__','count
-0000dac0: 2729 2c0d 0a20 2020 2020 2020 2020 2020  '),..           
-0000dad0: 2020 2020 2027 5f5f 546f 7461 6c43 6f75       '__TotalCou
-0000dae0: 6e74 5f5f 273a 2028 275f 5f45 7863 6565  nt__': ('__Excee
-0000daf0: 6461 6e63 655f 5f27 2c27 7369 7a65 2729  dance__','size')
-0000db00: 0d0a 2020 2020 2020 2020 2020 2020 2020  ..              
-0000db10: 2020 7d29 0d0a 2020 2020 2320 456c 7365    })..    # Else
-0000db20: 2074 6865 2067 726f 7570 6279 5f63 6f6c   the groupby_col
-0000db30: 7320 6973 2061 206c 6973 7420 6f66 2063  s is a list of c
-0000db40: 6f6c 756d 6e20 6e61 6d65 730d 0a20 2020  olumn names..   
-0000db50: 2065 6c73 653a 0d0a 2020 2020 2020 2020   else:..        
-0000db60: 6466 203d 2064 662e 6772 6f75 7062 7928  df = df.groupby(
-0000db70: 6772 6f75 7062 795f 636f 6c73 292e 6167  groupby_cols).ag
-0000db80: 6728 2a2a 7b0d 0a20 2020 2020 2020 2020  g(**{..         
-0000db90: 2020 2020 2020 2065 7863 6565 6461 6e63         exceedanc
-0000dba0: 6573 5f63 6f6c 3a20 2827 5f5f 4578 6365  es_col: ('__Exce
-0000dbb0: 6564 616e 6365 5f5f 272c 2773 756d 2729  edance__','sum')
-0000dbc0: 2c0d 0a20 2020 2020 2020 2020 2020 2020  ,..             
-0000dbd0: 2020 2027 5f5f 4465 7465 726d 696e 6564     '__Determined
-0000dbe0: 4578 6365 6564 616e 6365 735f 5f27 3a20  Exceedances__': 
-0000dbf0: 2827 5f5f 4578 6365 6564 616e 6365 5f5f  ('__Exceedance__
-0000dc00: 272c 2763 6f75 6e74 2729 2c0d 0a20 2020  ','count'),..   
-0000dc10: 2020 2020 2020 2020 2020 2020 2027 5f5f               '__
-0000dc20: 546f 7461 6c43 6f75 6e74 5f5f 273a 2028  TotalCount__': (
-0000dc30: 275f 5f45 7863 6565 6461 6e63 655f 5f27  '__Exceedance__'
-0000dc40: 2c27 7369 7a65 2729 0d0a 2020 2020 2020  ,'size')..      
-0000dc50: 2020 2020 2020 2020 2020 7d29 0d0a 2020            })..  
-0000dc60: 2020 0d0a 2020 2020 2320 4465 7465 726d    ..    # Determ
-0000dc70: 696e 6520 636f 756e 7473 2061 6e64 2063  ine counts and c
-0000dc80: 616c 6375 6c61 7465 2070 6572 6365 6e74  alculate percent
-0000dc90: 6167 650d 0a20 2020 2064 665b 6e6f 6e5f  age..    df[non_
-0000dca0: 6578 6365 6564 616e 6365 735f 636f 6c5d  exceedances_col]
-0000dcb0: 203d 2064 665b 275f 5f44 6574 6572 6d69   = df['__Determi
-0000dcc0: 6e65 6445 7863 6565 6461 6e63 6573 5f5f  nedExceedances__
-0000dcd0: 275d 202d 2064 665b 6578 6365 6564 616e  '] - df[exceedan
-0000dce0: 6365 735f 636f 6c5d 0d0a 2020 2020 6466  ces_col]..    df
-0000dcf0: 5b69 676e 6f72 6564 5f63 6f6c 5d20 3d20  [ignored_col] = 
-0000dd00: 6466 5b27 5f5f 546f 7461 6c43 6f75 6e74  df['__TotalCount
-0000dd10: 5f5f 275d 2d64 665b 275f 5f44 6574 6572  __']-df['__Deter
-0000dd20: 6d69 6e65 6445 7863 6565 6461 6e63 6573  minedExceedances
-0000dd30: 5f5f 275d 0d0a 2020 2020 6466 5b70 6572  __']..    df[per
-0000dd40: 6365 6e74 5f65 7863 6565 6461 6e63 6573  cent_exceedances
-0000dd50: 5f63 6f6c 5d20 3d20 6466 5b65 7863 6565  _col] = df[excee
-0000dd60: 6461 6e63 6573 5f63 6f6c 5d20 2f20 6466  dances_col] / df
-0000dd70: 5b27 5f5f 4465 7465 726d 696e 6564 4578  ['__DeterminedEx
-0000dd80: 6365 6564 616e 6365 735f 5f27 5d20 2a20  ceedances__'] * 
-0000dd90: 3130 300d 0a20 2020 200d 0a20 2020 2023  100..    ..    #
-0000dda0: 2044 726f 7020 776f 726b 696e 6720 636f   Drop working co
-0000ddb0: 6c75 6d6e 730d 0a20 2020 2064 6620 3d20  lumns..    df = 
-0000ddc0: 6466 2e64 726f 7028 6466 2e66 696c 7465  df.drop(df.filte
-0000ddd0: 7228 7265 6765 783d 275f 5f27 292e 636f  r(regex='__').co
-0000dde0: 6c75 6d6e 732c 2061 7869 733d 3129 0d0a  lumns, axis=1)..
-0000ddf0: 2020 2020 0d0a 2020 2020 2320 5265 6f72      ..    # Reor
-0000de00: 6465 7220 636f 6c75 6d6e 730d 0a20 2020  der columns..   
-0000de10: 2066 6f72 2063 6f6c 2069 6e20 5b70 6572   for col in [per
-0000de20: 6365 6e74 5f65 7863 6565 6461 6e63 6573  cent_exceedances
-0000de30: 5f63 6f6c 2c65 7863 6565 6461 6e63 6573  _col,exceedances
-0000de40: 5f63 6f6c 2c6e 6f6e 5f65 7863 6565 6461  _col,non_exceeda
-0000de50: 6e63 6573 5f63 6f6c 2c69 676e 6f72 6564  nces_col,ignored
-0000de60: 5f63 6f6c 5d3a 0d0a 2020 2020 2020 2020  _col]:..        
-0000de70: 6466 5b63 6f6c 5d20 3d20 6466 2e70 6f70  df[col] = df.pop
-0000de80: 2863 6f6c 290d 0a20 2020 200d 0a20 2020  (col)..    ..   
-0000de90: 2072 6574 7572 6e20 6466 0d0a 0d0a 2325   return df....#%
-0000dea0: 2520 4164 6469 7469 6f6e 0d0a 0d0a 6465  % Addition....de
-0000deb0: 6620 6164 645f 696e 7465 7276 616c 7328  f add_intervals(
-0000dec0: 6466 2c0d 0a20 2020 2020 2020 2020 2020  df,..           
-0000ded0: 2020 2020 2020 2067 726f 7570 6279 5f63         groupby_c
-0000dee0: 6f6c 7329 3a0d 0a20 2020 2027 2727 0d0a  ols):..    '''..
-0000def0: 2020 2020 4120 6675 6e63 7469 6f6e 2074      A function t
-0000df00: 6861 7420 6164 6473 2074 6865 2069 6e74  hat adds the int
-0000df10: 6572 7661 6c20 6e6f 7461 7469 6f6e 2066  erval notation f
-0000df20: 6f72 6d20 6f66 2072 6573 756c 7473 2072  orm of results r
-0000df30: 6574 7572 6e65 640d 0a20 2020 2066 726f  eturned..    fro
-0000df40: 6d20 636f 6d70 6f6e 656e 7473 5f74 6f5f  m components_to_
-0000df50: 696e 7465 7276 616c 2074 6f20 6765 6e65  interval to gene
-0000df60: 7261 7465 2061 206e 6577 2069 6e74 6572  rate a new inter
-0000df70: 7661 6c20 666f 7220 7468 6520 7375 6d2e  val for the sum.
-0000df80: 2047 726f 7570 730d 0a20 2020 206f 6620   Groups..    of 
-0000df90: 7265 7375 6c74 7320 6361 6e20 6265 2064  results can be d
-0000dfa0: 6566 696e 6564 2062 7920 696e 636c 7564  efined by includ
-0000dfb0: 696e 6720 7468 6520 636f 6c75 6d6e 7320  ing the columns 
-0000dfc0: 7468 6174 2073 686f 756c 6420 6265 2075  that should be u
-0000dfd0: 7365 6420 746f 0d0a 2020 2020 6372 6561  sed to..    crea
-0000dfe0: 7465 2067 726f 7570 732e 0d0a 0d0a 2020  te groups.....  
-0000dff0: 2020 5061 7261 6d65 7465 7273 0d0a 2020    Parameters..  
-0000e000: 2020 2d2d 2d2d 2d2d 2d2d 2d2d 0d0a 2020    ----------..  
-0000e010: 2020 6466 203a 2044 6174 6146 7261 6d65    df : DataFrame
-0000e020: 0d0a 2020 2020 2020 2020 4461 7461 4672  ..        DataFr
-0000e030: 616d 6520 7468 6174 2063 6f6e 7461 696e  ame that contain
-0000e040: 7320 7265 7375 6c74 7320 696e 2061 2073  s results in a s
-0000e050: 7065 6369 6669 6320 696e 7465 7276 616c  pecific interval
-0000e060: 206e 6f74 6174 696f 6e2e 0d0a 2020 2020   notation...    
-0000e070: 6772 6f75 7062 795f 636f 6c73 203a 206c  groupby_cols : l
-0000e080: 6973 7420 6f66 2073 7472 696e 6773 0d0a  ist of strings..
-0000e090: 2020 2020 2020 2020 4c69 7374 206f 6620          List of 
-0000e0a0: 636f 6c75 6d6e 206e 616d 6573 2074 6861  column names tha
-0000e0b0: 7420 7368 6f75 6c64 2062 6520 7573 6564  t should be used
-0000e0c0: 2074 6f20 6372 6561 7465 2067 726f 7570   to create group
-0000e0d0: 732e 0d0a 0d0a 2020 2020 5265 7475 726e  s.....    Return
-0000e0e0: 730d 0a20 2020 202d 2d2d 2d2d 2d2d 0d0a  s..    -------..
-0000e0f0: 2020 2020 6466 203a 2044 6174 6146 7261      df : DataFra
-0000e100: 6d65 0d0a 2020 2020 2020 2020 4461 7461  me..        Data
-0000e110: 4672 616d 6520 7468 6174 2068 6173 2074  Frame that has t
-0000e120: 6865 2069 6e74 6572 7661 6c20 666f 7220  he interval for 
-0000e130: 7468 6520 7375 6d20 2866 6f72 2065 6163  the sum (for eac
-0000e140: 6820 6772 6f75 7020 6966 0d0a 2020 2020  h group if..    
-0000e150: 2020 2020 636f 6c75 6d6e 206e 616d 6573      column names
-0000e160: 2061 7265 2070 726f 7669 6465 6420 666f   are provided fo
-0000e170: 7220 6772 6f75 7069 6e67 290d 0a0d 0a20  r grouping).... 
-0000e180: 2020 2027 2727 0d0a 2020 2020 0d0a 2020     '''..    ..  
-0000e190: 2020 2320 4372 6561 7465 2061 2063 6f70    # Create a cop
-0000e1a0: 7920 6f66 2074 6865 2044 6174 6146 7261  y of the DataFra
-0000e1b0: 6d65 0d0a 2020 2020 6466 203d 2064 662e  me..    df = df.
-0000e1c0: 636f 7079 2829 0d0a 2020 2020 0d0a 2020  copy()..    ..  
-0000e1d0: 2020 2320 4372 6561 7465 2063 6f6c 756d    # Create colum
-0000e1e0: 6e20 7468 6174 2069 6e64 6963 6174 6573  n that indicates
-0000e1f0: 2074 6865 2067 656e 6572 6174 6564 2073   the generated s
-0000e200: 7461 7469 7374 6963 2061 6e64 2061 7070  tatistic and app
-0000e210: 656e 6420 746f 2067 726f 7570 696e 6720  end to grouping 
-0000e220: 6c69 7374 0d0a 2020 2020 6466 5b73 7461  list..    df[sta
-0000e230: 745f 636f 6c5d 203d 2027 5375 6d27 0d0a  t_col] = 'Sum'..
-0000e240: 2020 2020 6772 6f75 7062 795f 636f 6c73      groupby_cols
-0000e250: 2e61 7070 656e 6428 7374 6174 5f63 6f6c  .append(stat_col
-0000e260: 290d 0a20 2020 200d 0a20 2020 2023 2043  )..    ..    # C
-0000e270: 6861 6e67 6520 6e6f 7461 7469 6f6e 206f  hange notation o
-0000e280: 6620 2743 6c6f 7365 6427 2061 6e64 2027  f 'Closed' and '
-0000e290: 4f70 656e 2720 626f 756e 6461 7269 6573  Open' boundaries
-0000e2a0: 2074 6f20 3020 616e 6420 312c 2072 6573   to 0 and 1, res
-0000e2b0: 7065 6374 6976 656c 790d 0a20 2020 2023  pectively..    #
-0000e2c0: 2054 6865 2070 7265 7365 6e63 6520 6f66   The presence of
-0000e2d0: 2061 6e79 206f 7065 6e20 626f 756e 6461   any open bounda
-0000e2e0: 7269 6573 206f 6e20 6f6e 6520 7369 6465  ries on one side
-0000e2f0: 2065 6e73 7572 6520 7468 6174 2074 6865   ensure that the
-0000e300: 2069 6e74 6572 7661 6c20 666f 7220 7468   interval for th
-0000e310: 6520 7375 6d20 6973 2061 6c73 6f0d 0a20  e sum is also.. 
-0000e320: 2020 2023 206f 7065 6e20 6f6e 2074 6861     # open on tha
-0000e330: 7420 7369 6465 0d0a 2020 2020 6466 5b5b  t side..    df[[
-0000e340: 6c65 6674 5f62 6f75 6e64 6172 795f 636f  left_boundary_co
-0000e350: 6c2c 7269 6768 745f 626f 756e 6461 7279  l,right_boundary
-0000e360: 5f63 6f6c 5d5d 203d 2064 665b 5b6c 6566  _col]] = df[[lef
-0000e370: 745f 626f 756e 6461 7279 5f63 6f6c 2c72  t_boundary_col,r
-0000e380: 6967 6874 5f62 6f75 6e64 6172 795f 636f  ight_boundary_co
-0000e390: 6c5d 5d2e 7265 706c 6163 6528 5b27 436c  l]].replace(['Cl
-0000e3a0: 6f73 6564 272c 274f 7065 6e27 5d2c 205b  osed','Open'], [
-0000e3b0: 302c 315d 290d 0a20 2020 200d 0a20 2020  0,1])..    ..   
-0000e3c0: 2023 2047 6574 2074 6865 206c 6566 742f   # Get the left/
-0000e3d0: 7269 6768 7420 626f 756e 6473 206f 6620  right bounds of 
-0000e3e0: 7468 6520 7375 6d20 6279 2061 6464 696e  the sum by addin
-0000e3f0: 6720 626f 756e 6473 2077 6974 6869 6e20  g bounds within 
-0000e400: 7468 6520 6772 6f75 700d 0a20 2020 2023  the group..    #
-0000e410: 2044 6574 6572 6d69 6e65 2077 6865 7468   Determine wheth
-0000e420: 6572 2061 6e79 204f 7065 6e20 286e 6f77  er any Open (now
-0000e430: 2076 616c 7565 206f 6620 3129 2062 6f75   value of 1) bou
-0000e440: 6e64 6172 6965 7320 6578 6973 742e 2049  ndaries exist. I
-0000e450: 6620 7468 6572 6520 6172 650d 0a20 2020  f there are..   
-0000e460: 2023 2061 6e79 206f 7065 6e20 626f 756e   # any open boun
-0000e470: 6461 7269 6573 2075 7365 6420 696e 2074  daries used in t
-0000e480: 6865 2073 756d 2c20 7468 656e 2074 6865  he sum, then the
-0000e490: 2072 6573 756c 7469 6e67 2073 756d 2077   resulting sum w
-0000e4a0: 696c 6c20 6265 206f 7065 6e0d 0a20 2020  ill be open..   
-0000e4b0: 2064 6620 3d20 6466 2e67 726f 7570 6279   df = df.groupby
-0000e4c0: 2867 726f 7570 6279 5f63 6f6c 7329 2e61  (groupby_cols).a
-0000e4d0: 6767 282a 2a7b 0d0a 2020 2020 2020 2020  gg(**{..        
-0000e4e0: 2020 2020 2020 2020 2020 2020 2020 2020                  
-0000e4f0: 2020 2020 6c65 6674 5f62 6f75 6e64 6172      left_boundar
-0000e500: 795f 636f 6c3a 2028 6c65 6674 5f62 6f75  y_col: (left_bou
-0000e510: 6e64 6172 795f 636f 6c2c 2027 6d61 7827  ndary_col, 'max'
-0000e520: 292c 0d0a 2020 2020 2020 2020 2020 2020  ),..            
-0000e530: 2020 2020 2020 2020 2020 2020 2020 2020                  
-0000e540: 275f 5f4d 696e 696d 756d 5f5f 273a 2028  '__Minimum__': (
-0000e550: 6c65 6674 5f62 6f75 6e64 5f63 6f6c 2c27  left_bound_col,'
-0000e560: 6d69 6e27 292c 0d0a 2020 2020 2020 2020  min'),..        
-0000e570: 2020 2020 2020 2020 2020 2020 2020 2020                  
-0000e580: 2020 2020 6c65 6674 5f62 6f75 6e64 5f63      left_bound_c
-0000e590: 6f6c 3a20 286c 6566 745f 626f 756e 645f  ol: (left_bound_
-0000e5a0: 636f 6c2c 2773 756d 2729 2c0d 0a20 2020  col,'sum'),..   
-0000e5b0: 2020 2020 2020 2020 2020 2020 2020 2020                  
-0000e5c0: 2020 2020 2020 2020 2072 6967 6874 5f62           right_b
-0000e5d0: 6f75 6e64 5f63 6f6c 3a20 2872 6967 6874  ound_col: (right
-0000e5e0: 5f62 6f75 6e64 5f63 6f6c 2c27 7375 6d27  _bound_col,'sum'
-0000e5f0: 292c 0d0a 2020 2020 2020 2020 2020 2020  ),..            
-0000e600: 2020 2020 2020 2020 2020 2020 2020 2020                  
-0000e610: 275f 5f4d 6178 696d 756d 5f5f 273a 2028  '__Maximum__': (
-0000e620: 7269 6768 745f 626f 756e 645f 636f 6c2c  right_bound_col,
-0000e630: 276d 6178 2729 2c0d 0a20 2020 2020 2020  'max'),..       
-0000e640: 2020 2020 2020 2020 2020 2020 2020 2020                  
-0000e650: 2020 2020 2072 6967 6874 5f62 6f75 6e64       right_bound
-0000e660: 6172 795f 636f 6c3a 2028 7269 6768 745f  ary_col: (right_
-0000e670: 626f 756e 6461 7279 5f63 6f6c 2c27 6d61  boundary_col,'ma
-0000e680: 7827 290d 0a20 2020 2020 2020 2020 2020  x')..           
-0000e690: 2020 2020 2020 2020 2020 2020 2020 2020                  
-0000e6a0: 207d 290d 0a20 2020 200d 0a20 2020 2023   })..    ..    #
-0000e6b0: 2052 6570 6c61 6365 2069 6e74 6567 6572   Replace integer
-0000e6c0: 7320 7769 7468 2074 6578 7420 666f 7220  s with text for 
-0000e6d0: 626f 756e 6461 7269 6573 0d0a 2020 2020  boundaries..    
-0000e6e0: 6466 5b5b 6c65 6674 5f62 6f75 6e64 6172  df[[left_boundar
-0000e6f0: 795f 636f 6c2c 7269 6768 745f 626f 756e  y_col,right_boun
-0000e700: 6461 7279 5f63 6f6c 5d5d 203d 2064 665b  dary_col]] = df[
-0000e710: 5b6c 6566 745f 626f 756e 6461 7279 5f63  [left_boundary_c
-0000e720: 6f6c 2c72 6967 6874 5f62 6f75 6e64 6172  ol,right_boundar
-0000e730: 795f 636f 6c5d 5d2e 7265 706c 6163 6528  y_col]].replace(
-0000e740: 5b30 2c31 5d2c 205b 2743 6c6f 7365 6427  [0,1], ['Closed'
-0000e750: 2c27 4f70 656e 275d 290d 0a20 2020 200d  ,'Open'])..    .
-0000e760: 0a20 2020 2023 2053 756d 7320 7769 7468  .    # Sums with
-0000e770: 2069 6e66 696e 6974 6520 7661 6c75 6573   infinite values
-0000e780: 2070 726f 6475 6365 206e 616e 2076 616c   produce nan val
-0000e790: 7565 7320 7261 7468 6572 2074 6861 6e20  ues rather than 
-0000e7a0: 6e70 2e69 6e66 2076 616c 7565 730d 0a20  np.inf values.. 
-0000e7b0: 2020 2023 2043 6f6e 7665 7274 206e 616e     # Convert nan
-0000e7c0: 2074 6f20 696e 6620 6f6e 6c79 2069 6620   to inf only if 
-0000e7d0: 696e 6669 6e69 7465 2076 616c 7565 7320  infinite values 
-0000e7e0: 6172 6520 696e 636c 7564 6564 2069 6e20  are included in 
-0000e7f0: 7468 6520 7375 6d0d 0a20 2020 2064 665b  the sum..    df[
-0000e800: 6c65 6674 5f62 6f75 6e64 5f63 6f6c 5d20  left_bound_col] 
-0000e810: 3d20 6e70 2e77 6865 7265 2864 665b 275f  = np.where(df['_
-0000e820: 5f4d 696e 696d 756d 5f5f 275d 203d 3d20  _Minimum__'] == 
-0000e830: 2d6e 702e 696e 662c 202d 6e70 2e69 6e66  -np.inf, -np.inf
-0000e840: 2c20 6466 5b6c 6566 745f 626f 756e 645f  , df[left_bound_
-0000e850: 636f 6c5d 290d 0a20 2020 2064 665b 7269  col])..    df[ri
-0000e860: 6768 745f 626f 756e 645f 636f 6c5d 203d  ght_bound_col] =
-0000e870: 206e 702e 7768 6572 6528 6466 5b27 5f5f   np.where(df['__
-0000e880: 4d61 7869 6d75 6d5f 5f27 5d20 3d3d 206e  Maximum__'] == n
-0000e890: 702e 696e 662c 206e 702e 696e 662c 2064  p.inf, np.inf, d
-0000e8a0: 665b 7269 6768 745f 626f 756e 645f 636f  f[right_bound_co
-0000e8b0: 6c5d 290d 0a20 2020 200d 0a20 2020 2023  l])..    ..    #
-0000e8c0: 2052 6573 6574 2069 6e64 6578 0d0a 2020   Reset index..  
-0000e8d0: 2020 6466 203d 2064 662e 7265 7365 745f    df = df.reset_
-0000e8e0: 696e 6465 7828 290d 0a20 2020 200d 0a20  index()..    .. 
-0000e8f0: 2020 2072 6574 7572 6e20 6466 0d0a 0d0a     return df....
-0000e900: 6465 6620 6164 6469 7469 6f6e 2864 662c  def addition(df,
-0000e910: 0d0a 2020 2020 2020 2020 2020 2020 2072  ..             r
-0000e920: 6573 756c 7473 5f63 6f6c 2c0d 0a20 2020  esults_col,..   
-0000e930: 2020 2020 2020 2020 2020 6772 6f75 7062            groupb
-0000e940: 795f 636f 6c73 203d 204e 6f6e 652c 0d0a  y_cols = None,..
-0000e950: 2020 2020 2020 2020 2020 2020 2066 6f63               foc
-0000e960: 7573 5f68 6967 685f 706f 7465 6e74 6961  us_high_potentia
-0000e970: 6c20 3d20 5472 7565 2c0d 0a20 2020 2020  l = True,..     
-0000e980: 2020 2020 2020 2020 696e 636c 7564 655f          include_
-0000e990: 6e65 6761 7469 7665 5f69 6e74 6572 7661  negative_interva
-0000e9a0: 6c20 3d20 4661 6c73 652c 0d0a 2020 2020  l = False,..    
-0000e9b0: 2020 2020 2020 2020 2070 7265 6369 7369           precisi
-0000e9c0: 6f6e 5f74 6f6c 6572 616e 6365 5f74 6f5f  on_tolerance_to_
-0000e9d0: 6472 6f70 5f63 656e 736f 7220 3d20 302e  drop_censor = 0.
-0000e9e0: 3235 2c0d 0a20 2020 2020 2020 2020 2020  25,..           
-0000e9f0: 2020 7072 6563 6973 696f 6e5f 726f 756e    precision_roun
-0000ea00: 6469 6e67 203d 2054 7275 6529 3a0d 0a20  ding = True):.. 
-0000ea10: 2020 2027 2727 0d0a 2020 2020 4120 6675     '''..    A fu
-0000ea20: 6e63 7469 6f6e 2074 6861 7420 636f 6d62  nction that comb
-0000ea30: 696e 6573 2074 6865 2072 656c 6576 616e  ines the relevan
-0000ea40: 7420 6164 6469 7469 6f6e 2061 6e64 2075  t addition and u
-0000ea50: 7469 6c69 7479 2066 756e 6374 696f 6e73  tility functions
-0000ea60: 2074 6f0d 0a20 2020 2073 756d 2072 6573   to..    sum res
-0000ea70: 756c 7473 2066 6f72 2067 726f 7570 7320  ults for groups 
-0000ea80: 7769 7468 696e 2061 2044 6174 6146 7261  within a DataFra
-0000ea90: 6d65 2e0d 0a0d 0a20 2020 2050 6172 616d  me.....    Param
-0000eaa0: 6574 6572 730d 0a20 2020 202d 2d2d 2d2d  eters..    -----
-0000eab0: 2d2d 2d2d 2d0d 0a20 2020 2064 6620 3a20  -----..    df : 
-0000eac0: 4461 7461 4672 616d 650d 0a20 2020 2020  DataFrame..     
-0000ead0: 2020 2044 6174 6146 7261 6d65 2074 6861     DataFrame tha
-0000eae0: 7420 636f 6e74 6169 6e73 2063 656e 736f  t contains censo
-0000eaf0: 7265 6420 6f72 2075 6e63 656e 736f 7265  red or uncensore
-0000eb00: 6420 7265 7375 6c74 730d 0a20 2020 2072  d results..    r
-0000eb10: 6573 756c 7473 5f63 6f6c 203a 2073 7472  esults_col : str
-0000eb20: 696e 670d 0a20 2020 2020 2020 2054 6865  ing..        The
-0000eb30: 2063 6f6c 756d 6e20 6e61 6d65 2066 6f72   column name for
-0000eb40: 2074 6865 2063 6f6c 756d 6e20 7468 6174   the column that
-0000eb50: 2063 6f6e 7461 696e 2074 6865 2072 6573   contain the res
-0000eb60: 756c 7473 2061 7320 7465 7874 2e0d 0a20  ults as text... 
-0000eb70: 2020 2020 2020 204f 6e6c 7920 666f 7572         Only four
-0000eb80: 2070 6f73 7369 626c 6520 6365 6e73 6f72   possible censor
-0000eb90: 7320 7368 6f75 6c64 2062 6520 7573 6564  s should be used
-0000eba0: 2028 3c2c e289 a42c e289 a52c 3e29 2e0d   (<,...,...,>)..
-0000ebb0: 0a20 2020 2067 726f 7570 6279 5f63 6f6c  .    groupby_col
-0000ebc0: 7320 3a20 6c69 7374 7320 6f66 2073 7472  s : lists of str
-0000ebd0: 696e 6773 2028 6f72 206c 6973 7420 6f66  ings (or list of
-0000ebe0: 206c 6973 7473 292c 206f 7074 696f 6e61   lists), optiona
-0000ebf0: 6c0d 0a20 2020 2020 2020 204c 6973 7420  l..        List 
-0000ec00: 6f66 2063 6f6c 756d 6e20 6e61 6d65 7320  of column names 
-0000ec10: 7468 6174 2073 686f 756c 6420 6265 2075  that should be u
-0000ec20: 7365 6420 746f 2063 7265 6174 6520 6772  sed to create gr
-0000ec30: 6f75 7073 2e20 416e 2061 7665 7261 6765  oups. An average
-0000ec40: 0d0a 2020 2020 2020 2020 7769 6c6c 2062  ..        will b
-0000ec50: 6520 666f 756e 6420 7769 7468 696e 2065  e found within e
-0000ec60: 6163 6820 6772 6f75 702e 204d 756c 7469  ach group. Multi
-0000ec70: 706c 6520 6c69 7374 7320 6361 6e20 6265  ple lists can be
-0000ec80: 2073 7570 706c 6965 6420 746f 0d0a 2020   supplied to..  
-0000ec90: 2020 2020 2020 7065 7266 6f72 6d20 7365        perform se
-0000eca0: 7175 656e 7469 616c 2061 7665 7261 6769  quential averagi
-0000ecb0: 6e67 2062 6566 6f72 6520 636f 6e76 6572  ng before conver
-0000ecc0: 7469 6e67 2069 6e74 6572 7661 6c73 2074  ting intervals t
-0000ecd0: 6f20 6120 7265 7375 6c74 2e0d 0a20 2020  o a result...   
-0000ece0: 2020 2020 2054 6865 2064 6566 6175 6c74       The default
-0000ecf0: 2069 7320 4e6f 6e65 2e0d 0a20 2020 2066   is None...    f
-0000ed00: 6f63 7573 5f68 6967 685f 706f 7465 6e74  ocus_high_potent
-0000ed10: 6961 6c20 3a20 626f 6f6c 6561 6e2c 206f  ial : boolean, o
-0000ed20: 7074 696f 6e61 6c0d 0a20 2020 2020 2020  ptional..       
-0000ed30: 2049 6620 5472 7565 2c20 7468 656e 2069   If True, then i
-0000ed40: 6e66 6f72 6d61 7469 6f6e 206f 6e20 7468  nformation on th
-0000ed50: 6520 6869 6768 6573 7420 706f 7465 6e74  e highest potent
-0000ed60: 6961 6c20 7265 7375 6c74 2077 696c 6c20  ial result will 
-0000ed70: 6265 0d0a 2020 2020 2020 2020 666f 6375  be..        focu
-0000ed80: 7365 6420 6f76 6572 2074 6865 206c 6f77  sed over the low
-0000ed90: 6573 7420 706f 7465 6e74 6961 6c20 7265  est potential re
-0000eda0: 7375 6c74 2e0d 0a20 2020 2069 6e63 6c75  sult...    inclu
-0000edb0: 6465 5f6e 6567 6174 6976 655f 696e 7465  de_negative_inte
-0000edc0: 7276 616c 203a 2062 6f6f 6c65 616e 2c20  rval : boolean, 
-0000edd0: 6f70 7469 6f6e 616c 0d0a 2020 2020 2020  optional..      
-0000ede0: 2020 4966 2054 7275 652c 2074 6865 6e20    If True, then 
-0000edf0: 616c 6c20 706f 7369 7469 7665 2061 6e64  all positive and
-0000ee00: 206e 6567 6174 6976 6520 7661 6c75 6573   negative values
-0000ee10: 2061 7265 2063 6f6e 7369 6465 7265 640d   are considered.
-0000ee20: 0a20 2020 2020 2020 2065 2e67 2e2c 203c  .        e.g., <
-0000ee30: 302e 3520 776f 756c 6420 6265 2063 6f6e  0.5 would be con
-0000ee40: 7665 7274 6564 2074 6f20 282d 6e70 2e69  verted to (-np.i
-0000ee50: 6e66 2c35 292e 0d0a 2020 2020 2020 2020  nf,5)...        
-0000ee60: 4966 2046 616c 7365 2c20 7468 656e 206f  If False, then o
-0000ee70: 6e6c 7920 6e6f 6e2d 6e65 6761 7469 7665  nly non-negative
-0000ee80: 2076 616c 7565 7320 6172 6520 636f 6e73   values are cons
-0000ee90: 6964 6572 6564 0d0a 2020 2020 2020 2020  idered..        
-0000eea0: 652e 672e 2c20 3c30 2e35 2077 6f75 6c64  e.g., <0.5 would
-0000eeb0: 2062 6520 636f 6e76 6572 7465 6420 746f   be converted to
-0000eec0: 205b 302c 3529 2e0d 0a20 2020 2020 2020   [0,5)...       
-0000eed0: 2054 6869 7320 7365 7474 696e 6720 6f6e   This setting on
-0000eee0: 6c79 2061 6666 6563 7473 2072 6573 756c  ly affects resul
-0000eef0: 7473 2069 6620 666f 6375 735f 6869 6768  ts if focus_high
-0000ef00: 5f70 6f74 656e 7469 616c 2069 7320 4661  _potential is Fa
-0000ef10: 6c73 652e 0d0a 2020 2020 2020 2020 5468  lse...        Th
-0000ef20: 6520 6465 6661 756c 7420 6973 2046 616c  e default is Fal
-0000ef30: 7365 2e0d 0a20 2020 2070 7265 6369 7369  se...    precisi
-0000ef40: 6f6e 5f74 6f6c 6572 616e 6365 5f74 6f5f  on_tolerance_to_
-0000ef50: 6472 6f70 5f63 656e 736f 7220 3a20 666c  drop_censor : fl
-0000ef60: 6f61 742c 206f 7074 696f 6e61 6c0d 0a20  oat, optional.. 
-0000ef70: 2020 2020 2020 2054 6872 6573 686f 6c64         Threshold
-0000ef80: 2066 6f72 2072 6570 6f72 7469 6e67 2063   for reporting c
-0000ef90: 656e 736f 7265 6420 7673 206e 6f6e 2d63  ensored vs non-c
-0000efa0: 656e 736f 7265 6420 7265 7375 6c74 732e  ensored results.
-0000efb0: 0d0a 2020 2020 2020 2020 5573 696e 6720  ..        Using 
-0000efc0: 7468 6520 6465 6661 756c 742c 2061 2072  the default, a r
-0000efd0: 6573 756c 7420 7468 6174 2069 7320 6b6e  esult that is kn
-0000efe0: 6f77 6e20 746f 2062 6520 696e 2074 6865  own to be in the
-0000eff0: 2069 6e74 6572 7661 6c20 2830 2e33 2c20   interval (0.3, 
-0000f000: 302e 3529 0d0a 2020 2020 2020 2020 776f  0.5)..        wo
-0000f010: 756c 6420 6265 2072 6574 7572 6e65 6420  uld be returned 
-0000f020: 6173 2030 2e34 2c20 7768 6572 6561 7320  as 0.4, whereas 
-0000f030: 6120 746f 6c65 7261 6e63 6520 6f66 2030  a tolerance of 0
-0000f040: 2077 6f75 6c64 2079 6965 6c64 2061 0d0a   would yield a..
-0000f050: 2020 2020 2020 2020 7265 7375 6c74 206f          result o
-0000f060: 6620 3c30 2e35 206f 7220 3e30 2e33 2064  f <0.5 or >0.3 d
-0000f070: 6570 656e 6469 6e67 206f 6e20 7468 6520  epending on the 
-0000f080: 7661 6c75 6520 6f66 2066 6f63 7573 5f68  value of focus_h
-0000f090: 6967 6865 7374 5f70 6f74 656e 7469 616c  ighest_potential
-0000f0a0: 2e0d 0a20 2020 2020 2020 2054 6865 2064  ...        The d
-0000f0b0: 6566 6175 6c74 2069 7320 302e 3235 2e0d  efault is 0.25..
-0000f0c0: 0a20 2020 2070 7265 6369 7369 6f6e 5f72  .    precision_r
-0000f0d0: 6f75 6e64 696e 6720 3a20 626f 6f6c 6561  ounding : boolea
-0000f0e0: 6e2c 206f 7074 696f 6e61 6c0d 0a20 2020  n, optional..   
-0000f0f0: 2020 2020 2049 6620 5472 7565 2c20 6120       If True, a 
-0000f100: 726f 756e 6469 6e67 206d 6574 686f 6420  rounding method 
-0000f110: 6973 2061 7070 6c69 6564 2074 6f20 726f  is applied to ro
-0000f120: 756e 6420 7265 7375 6c74 7320 746f 2068  und results to h
-0000f130: 6176 6520 6e6f 206d 6f72 650d 0a20 2020  ave no more..   
-0000f140: 2020 2020 2064 6563 696d 616c 7320 7468       decimals th
-0000f150: 616e 2077 6861 7420 6361 6e20 6265 206d  an what can be m
-0000f160: 6561 7375 7265 642e 0d0a 2020 2020 2020  easured...      
-0000f170: 2020 5468 6520 6465 6661 756c 7420 6973    The default is
-0000f180: 2054 7275 652e 0d0a 0d0a 2020 2020 5265   True.....    Re
-0000f190: 7475 726e 730d 0a20 2020 202d 2d2d 2d2d  turns..    -----
-0000f1a0: 2d2d 0d0a 2020 2020 6466 203a 2044 6174  --..    df : Dat
-0000f1b0: 6146 7261 6d65 0d0a 2020 2020 2020 2020  aFrame..        
-0000f1c0: 4461 7461 4672 616d 6520 7468 6174 2063  DataFrame that c
-0000f1d0: 6f6e 7461 696e 7320 6361 6c63 756c 6174  ontains calculat
-0000f1e0: 6564 2061 7665 7261 6765 730d 0a0d 0a20  ed averages.... 
-0000f1f0: 2020 2027 2727 0d0a 2020 2020 0d0a 2020     '''..    ..  
-0000f200: 2020 2320 4372 6561 7465 2061 2063 6f70    # Create a cop
-0000f210: 7920 6f66 2074 6865 2044 6174 6146 7261  y of the DataFra
-0000f220: 6d65 0d0a 2020 2020 6466 203d 2064 662e  me..    df = df.
-0000f230: 636f 7079 2829 0d0a 2020 2020 0d0a 2020  copy()..    ..  
-0000f240: 2020 2320 5370 6c69 7420 7468 6520 7265    # Split the re
-0000f250: 7375 6c74 2069 6e74 6f20 6365 6e73 6f72  sult into censor
-0000f260: 2061 6e64 206e 756d 6572 6963 2063 6f6d   and numeric com
-0000f270: 706f 6e65 6e74 730d 0a20 2020 2064 6620  ponents..    df 
-0000f280: 3d20 7265 7375 6c74 5f74 6f5f 636f 6d70  = result_to_comp
-0000f290: 6f6e 656e 7473 2864 662c 7265 7375 6c74  onents(df,result
-0000f2a0: 735f 636f 6c29 0d0a 2020 2020 0d0a 2020  s_col)..    ..  
-0000f2b0: 2020 2320 436f 6e76 6572 7420 7468 6520    # Convert the 
-0000f2c0: 7265 7375 6c74 7320 6672 6f6d 2063 656e  results from cen
-0000f2d0: 736f 7220 616e 6420 6e75 6d65 7269 6320  sor and numeric 
-0000f2e0: 636f 6d70 6f6e 656e 7473 2074 6f20 616e  components to an
-0000f2f0: 2069 6e74 6572 7661 6c20 7265 7072 6573   interval repres
-0000f300: 656e 7461 7469 6f6e 0d0a 2020 2020 6466  entation..    df
-0000f310: 203d 2063 6f6d 706f 6e65 6e74 735f 746f   = components_to
-0000f320: 5f69 6e74 6572 7661 6c28 6466 2c20 696e  _interval(df, in
-0000f330: 636c 7564 655f 6e65 6761 7469 7665 5f69  clude_negative_i
-0000f340: 6e74 6572 7661 6c29 0d0a 2020 2020 0d0a  nterval)..    ..
-0000f350: 2020 2020 2320 5573 696e 6720 7468 6520      # Using the 
-0000f360: 696e 7465 7276 616c 732c 2064 6574 6572  intervals, deter
-0000f370: 6d69 6e65 2074 6865 2072 616e 6765 206f  mine the range o
-0000f380: 6620 706f 7373 6962 6c65 2061 7665 7261  f possible avera
-0000f390: 6765 730d 0a20 2020 200d 0a20 2020 2023  ges..    ..    #
-0000f3a0: 2049 6620 7468 6572 6520 6172 6520 6e6f   If there are no
-0000f3b0: 2067 726f 7570 6279 2d63 6f6c 756d 6e73   groupby-columns
-0000f3c0: 2c20 7468 656e 2074 616b 6520 6176 6572  , then take aver
-0000f3d0: 6167 6520 6f66 2061 6c6c 2072 6573 756c  age of all resul
-0000f3e0: 7473 0d0a 2020 2020 6966 206e 6f74 2067  ts..    if not g
-0000f3f0: 726f 7570 6279 5f63 6f6c 733a 0d0a 2020  roupby_cols:..  
-0000f400: 2020 2020 2020 6466 203d 2061 6464 5f69        df = add_i
-0000f410: 6e74 6572 7661 6c73 2864 662c 2067 726f  ntervals(df, gro
-0000f420: 7570 6279 5f63 6f6c 733d 5b5d 290d 0a20  upby_cols=[]).. 
-0000f430: 2020 2023 2049 6620 7468 6520 6772 6f75     # If the grou
-0000f440: 7062 795f 636f 6c73 2069 7320 6120 6c69  pby_cols is a li
-0000f450: 7374 206f 6620 6c69 7374 732c 2074 6865  st of lists, the
-0000f460: 6e20 7065 7266 6f72 6d20 6d75 6c74 6970  n perform multip
-0000f470: 6c65 2061 7665 7261 6765 730d 0a20 2020  le averages..   
-0000f480: 2065 6c69 6620 6973 696e 7374 616e 6365   elif isinstance
-0000f490: 2867 726f 7570 6279 5f63 6f6c 735b 305d  (groupby_cols[0]
-0000f4a0: 2c6c 6973 7429 3a0d 0a20 2020 2020 2020  ,list):..       
-0000f4b0: 2066 6f72 2067 726f 7570 696e 6720 696e   for grouping in
-0000f4c0: 2067 726f 7570 6279 5f63 6f6c 733a 0d0a   groupby_cols:..
-0000f4d0: 2020 2020 2020 2020 2020 2020 2320 5573              # Us
-0000f4e0: 696e 6720 7468 6520 696e 7465 7276 616c  ing the interval
-0000f4f0: 732c 2064 6574 6572 6d69 6e65 2074 6865  s, determine the
-0000f500: 2072 616e 6765 206f 6620 706f 7373 6962   range of possib
-0000f510: 6c65 206d 6178 696d 610d 0a20 2020 2020  le maxima..     
-0000f520: 2020 2020 2020 2064 6620 3d20 6164 645f         df = add_
-0000f530: 696e 7465 7276 616c 7328 6466 2c20 6772  intervals(df, gr
-0000f540: 6f75 7069 6e67 290d 0a20 2020 2023 2045  ouping)..    # E
-0000f550: 6c73 6520 7468 6520 6772 6f75 7062 795f  lse the groupby_
-0000f560: 636f 6c73 2069 7320 6120 6c69 7374 206f  cols is a list o
-0000f570: 6620 636f 6c75 6d6e 206e 616d 6573 0d0a  f column names..
-0000f580: 2020 2020 656c 7365 3a0d 0a20 2020 2020      else:..     
-0000f590: 2020 2064 6620 3d20 6164 645f 696e 7465     df = add_inte
-0000f5a0: 7276 616c 7328 6466 2c20 6772 6f75 7062  rvals(df, groupb
-0000f5b0: 795f 636f 6c73 290d 0a20 2020 200d 0a20  y_cols)..    .. 
-0000f5c0: 2020 2023 2043 6f6e 7665 7274 2074 6865     # Convert the
-0000f5d0: 2069 6e74 6572 7661 6c20 666f 7220 7468   interval for th
-0000f5e0: 6520 6176 6572 6167 6520 696e 746f 2063  e average into c
-0000f5f0: 656e 736f 7220 616e 6420 6e75 6d65 7269  ensor and numeri
-0000f600: 6320 6e6f 7461 7469 6f6e 0d0a 2020 2020  c notation..    
-0000f610: 6466 203d 2069 6e74 6572 7661 6c5f 746f  df = interval_to
-0000f620: 5f63 6f6d 706f 6e65 6e74 7328 6466 2c0d  _components(df,.
-0000f630: 0a20 2020 2020 2020 2020 2020 2020 2020  .               
-0000f640: 2020 2020 2020 2020 2020 2020 2020 2020                  
-0000f650: 2066 6f63 7573 5f68 6967 685f 706f 7465   focus_high_pote
-0000f660: 6e74 6961 6c20 3d20 666f 6375 735f 6869  ntial = focus_hi
-0000f670: 6768 5f70 6f74 656e 7469 616c 2c0d 0a20  gh_potential,.. 
-0000f680: 2020 2020 2020 2020 2020 2020 2020 2020                  
-0000f690: 2020 2020 2020 2020 2020 2020 2020 2069                 i
-0000f6a0: 6e63 6c75 6465 5f6e 6567 6174 6976 655f  nclude_negative_
-0000f6b0: 696e 7465 7276 616c 203d 2069 6e63 6c75  interval = inclu
-0000f6c0: 6465 5f6e 6567 6174 6976 655f 696e 7465  de_negative_inte
-0000f6d0: 7276 616c 2c0d 0a20 2020 2020 2020 2020  rval,..         
-0000f6e0: 2020 2020 2020 2020 2020 2020 2020 2020                  
-0000f6f0: 2020 2020 2020 2070 7265 6369 7369 6f6e         precision
-0000f700: 5f74 6f6c 6572 616e 6365 5f74 6f5f 6472  _tolerance_to_dr
-0000f710: 6f70 5f63 656e 736f 7220 3d20 7072 6563  op_censor = prec
-0000f720: 6973 696f 6e5f 746f 6c65 7261 6e63 655f  ision_tolerance_
-0000f730: 746f 5f64 726f 705f 6365 6e73 6f72 290d  to_drop_censor).
-0000f740: 0a20 2020 200d 0a20 2020 2023 2043 7265  .    ..    # Cre
-0000f750: 6174 6520 696e 7465 7276 616c 206e 6f74  ate interval not
-0000f760: 6174 696f 6e20 666f 7220 7468 6520 6176  ation for the av
-0000f770: 6572 6167 650d 0a20 2020 2064 6620 3d20  erage..    df = 
-0000f780: 696e 7465 7276 616c 5f6e 6f74 6174 696f  interval_notatio
-0000f790: 6e28 6466 2c20 7072 6563 6973 696f 6e5f  n(df, precision_
-0000f7a0: 726f 756e 6469 6e67 290d 0a20 2020 200d  rounding)..    .
-0000f7b0: 0a20 2020 2023 2043 6f6d 6269 6e65 2074  .    # Combine t
-0000f7c0: 6865 2063 656e 736f 7220 616e 6420 6e75  he censor and nu
-0000f7d0: 6d65 7269 6320 636f 6d70 6f6e 656e 7473  meric components
-0000f7e0: 2069 6e74 6f20 6120 7265 7375 6c74 0d0a   into a result..
-0000f7f0: 2020 2020 6466 203d 2063 6f6d 706f 6e65      df = compone
-0000f800: 6e74 735f 746f 5f72 6573 756c 7428 6466  nts_to_result(df
-0000f810: 2c20 7072 6563 6973 696f 6e5f 726f 756e  , precision_roun
-0000f820: 6469 6e67 290d 0a20 2020 200d 0a20 2020  ding)..    ..   
-0000f830: 2023 2044 726f 7020 776f 726b 696e 6720   # Drop working 
-0000f840: 636f 6c75 6d6e 730d 0a20 2020 2064 6620  columns..    df 
-0000f850: 3d20 6466 2e64 726f 7028 6466 2e66 696c  = df.drop(df.fil
-0000f860: 7465 7228 7265 6765 783d 275f 5f27 292e  ter(regex='__').
-0000f870: 636f 6c75 6d6e 732c 2061 7869 733d 3129  columns, axis=1)
-0000f880: 0d0a 2020 2020 0d0a 2020 2020 2320 5265  ..    ..    # Re
-0000f890: 6f72 6465 7220 636f 6c75 6d6e 730d 0a20  order columns.. 
-0000f8a0: 2020 2066 6f72 2063 6f6c 2069 6e20 5b73     for col in [s
-0000f8b0: 7461 745f 636f 6c2c 7265 7375 6c74 5f63  tat_col,result_c
-0000f8c0: 6f6c 2c63 656e 736f 725f 636f 6c2c 6e75  ol,censor_col,nu
-0000f8d0: 6d65 7269 635f 636f 6c2c 696e 7465 7276  meric_col,interv
-0000f8e0: 616c 5f63 6f6c 5d3a 0d0a 2020 2020 2020  al_col]:..      
-0000f8f0: 2020 6466 5b63 6f6c 5d20 3d20 6466 2e70    df[col] = df.p
-0000f900: 6f70 2863 6f6c 290d 0a20 2020 200d 0a20  op(col)..    .. 
-0000f910: 2020 2072 6574 7572 6e20 6466 0d0a          return df..
+0000ca20: 2020 2020 2020 2020 2020 2828 6466 5b72            ((df[r
+0000ca30: 6967 6874 5f62 6f75 6e64 5f63 6f6c 5d20  ight_bound_col] 
+0000ca40: 3c20 7468 7265 7368 6f6c 6429 207c 205c  < threshold) | \
+0000ca50: 0d0a 2020 2020 2020 2020 2020 2020 2320  ..            # 
+0000ca60: 4966 2074 6865 2072 6967 6874 2062 6f75  If the right bou
+0000ca70: 6e64 2069 7320 6571 7561 6c20 746f 2074  nd is equal to t
+0000ca80: 6865 2074 7265 7368 6f6c 6420 616e 6420  he treshold and 
+0000ca90: 6f70 656e 2074 6861 6e20 6e6f 6e2d 6578  open than non-ex
+0000caa0: 6365 6564 616e 6365 0d0a 2020 2020 2020  ceedance..      
+0000cab0: 2020 2020 2020 2828 6466 5b72 6967 6874        ((df[right
+0000cac0: 5f62 6f75 6e64 5f63 6f6c 5d20 3d3d 2074  _bound_col] == t
+0000cad0: 6872 6573 686f 6c64 2920 2620 2864 665b  hreshold) & (df[
+0000cae0: 7269 6768 745f 626f 756e 6461 7279 5f63  right_boundary_c
+0000caf0: 6f6c 5d20 3d3d 2027 4f70 656e 2729 2929  ol] == 'Open')))
+0000cb00: 2c0d 0a20 2020 2020 2020 2020 2020 205d  ,..            ]
+0000cb10: 0d0a 2020 2020 656c 7365 3a0d 0a20 2020  ..    else:..   
+0000cb20: 2020 2020 2023 2053 6574 2063 6f6e 6469       # Set condi
+0000cb30: 7469 6f6e 7320 666f 7220 6578 6365 6564  tions for exceed
+0000cb40: 616e 6365 7320 616e 6420 6e6f 6e2d 6578  ances and non-ex
+0000cb50: 6365 6564 616e 6365 730d 0a20 2020 2020  ceedances..     
+0000cb60: 2020 2063 6f6e 6469 7469 6f6e 7320 3d20     conditions = 
+0000cb70: 5b0d 0a20 2020 2020 2020 2020 2020 2023  [..            #
+0000cb80: 2049 6620 7468 6520 6c65 6674 2062 6f75   If the left bou
+0000cb90: 6e64 2069 7320 6772 6561 7465 7220 7468  nd is greater th
+0000cba0: 616e 2074 6865 2074 6872 6573 686f 6c64  an the threshold
+0000cbb0: 2074 6861 6e20 6578 6365 6564 616e 6365   than exceedance
+0000cbc0: 0d0a 2020 2020 2020 2020 2020 2020 2828  ..            ((
+0000cbd0: 6466 5b6c 6566 745f 626f 756e 645f 636f  df[left_bound_co
+0000cbe0: 6c5d 203e 2074 6872 6573 686f 6c64 2920  l] > threshold) 
+0000cbf0: 7c20 5c0d 0a20 2020 2020 2020 2020 2020  | \..           
+0000cc00: 2023 2049 6620 7468 6520 6c65 6674 2062   # If the left b
+0000cc10: 6f75 6e64 2069 7365 7175 616c 2074 6f20  ound isequal to 
+0000cc20: 7468 6520 7468 7265 7368 6f6c 6420 616e  the threshold an
+0000cc30: 6420 6f70 656e 2074 6861 6e20 6578 6365  d open than exce
+0000cc40: 6564 616e 6365 0d0a 2020 2020 2020 2020  edance..        
+0000cc50: 2020 2020 2828 6466 5b6c 6566 745f 626f      ((df[left_bo
+0000cc60: 756e 645f 636f 6c5d 203d 3d20 7468 7265  und_col] == thre
+0000cc70: 7368 6f6c 6429 2026 2028 6466 5b6c 6566  shold) & (df[lef
+0000cc80: 745f 626f 756e 6461 7279 5f63 6f6c 5d20  t_boundary_col] 
+0000cc90: 3d3d 2027 4f70 656e 2729 2929 2c0d 0a20  == 'Open'))),.. 
+0000cca0: 2020 2020 2020 2020 2020 2023 2049 6620             # If 
+0000ccb0: 7468 6520 7269 6768 7420 626f 756e 6420  the right bound 
+0000ccc0: 6973 206c 6573 7320 7468 616e 206f 7220  is less than or 
+0000ccd0: 6571 7561 6c20 746f 2074 6865 2074 7265  equal to the tre
+0000cce0: 7368 6f6c 6420 7468 616e 206e 6f6e 2d65  shold than non-e
+0000ccf0: 7863 6565 6461 6e63 650d 0a20 2020 2020  xceedance..     
+0000cd00: 2020 2020 2020 2028 6466 5b72 6967 6874         (df[right
+0000cd10: 5f62 6f75 6e64 5f63 6f6c 5d20 3c3d 2074  _bound_col] <= t
+0000cd20: 6872 6573 686f 6c64 290d 0a20 2020 2020  hreshold)..     
+0000cd30: 2020 2020 2020 205d 0d0a 2020 2020 2320         ]..    # 
+0000cd40: 4578 6365 6564 616e 6365 7320 6172 6520  Exceedances are 
+0000cd50: 696e 6469 6361 7465 6420 6279 2069 6e74  indicated by int
+0000cd60: 6567 6572 730d 0a20 2020 2023 2028 313d  egers..    # (1=
+0000cd70: 6578 6365 6564 616e 6365 2c20 303d 6e6f  exceedance, 0=no
+0000cd80: 6e2d 6578 6365 6564 616e 6365 290d 0a20  n-exceedance).. 
+0000cd90: 2020 2072 6573 756c 7473 203d 205b 0d0a     results = [..
+0000cda0: 2020 2020 2020 2020 312c 0d0a 2020 2020          1,..    
+0000cdb0: 2020 2020 300d 0a20 2020 2020 2020 205d      0..        ]
+0000cdc0: 0d0a 2020 2020 2320 4465 6661 756c 7420  ..    # Default 
+0000cdd0: 6578 6365 6564 616e 6365 2028 6e70 2e6e  exceedance (np.n
+0000cde0: 616e 3d75 6e6b 6e6f 776e 290d 0a20 2020  an=unknown)..   
+0000cdf0: 2064 665b 275f 5f45 7863 6565 6461 6e63   df['__Exceedanc
+0000ce00: 655f 5f27 5d20 3d20 6e70 2e73 656c 6563  e__'] = np.selec
+0000ce10: 7428 636f 6e64 6974 696f 6e73 2c20 7265  t(conditions, re
+0000ce20: 7375 6c74 732c 206e 702e 6e61 6e29 0d0a  sults, np.nan)..
+0000ce30: 2020 2020 0d0a 2020 2020 7265 7475 726e      ..    return
+0000ce40: 2064 660d 0a0d 0a64 6566 2070 6572 6365   df....def perce
+0000ce50: 6e74 5f65 7863 6565 6461 6e63 6528 6466  nt_exceedance(df
+0000ce60: 2c0d 0a20 2020 2020 2020 2020 2020 2020  ,..             
+0000ce70: 2020 2020 2020 2020 2020 7265 7375 6c74            result
+0000ce80: 735f 636f 6c2c 0d0a 2020 2020 2020 2020  s_col,..        
+0000ce90: 2020 2020 2020 2020 2020 2020 2020 2074                 t
+0000cea0: 6872 6573 686f 6c64 2c0d 0a20 2020 2020  hreshold,..     
+0000ceb0: 2020 2020 2020 2020 2020 2020 2020 2020                  
+0000cec0: 2020 636f 756e 745f 7468 7265 7368 6f6c    count_threshol
+0000ced0: 645f 6173 5f65 7863 6565 6461 6e63 653d  d_as_exceedance=
+0000cee0: 4661 6c73 652c 0d0a 2020 2020 2020 2020  False,..        
+0000cef0: 2020 2020 2020 2020 2020 2020 2020 2067                 g
+0000cf00: 726f 7570 6279 5f63 6f6c 7320 3d20 4e6f  roupby_cols = No
+0000cf10: 6e65 2c0d 0a20 2020 2020 2020 2020 2020  ne,..           
+0000cf20: 2020 2020 2020 2020 2020 2020 696e 636c              incl
+0000cf30: 7564 655f 6e65 6761 7469 7665 5f69 6e74  ude_negative_int
+0000cf40: 6572 7661 6c20 3d20 4661 6c73 6529 3a0d  erval = False):.
+0000cf50: 0a20 2020 2027 2727 0d0a 2020 2020 4120  .    '''..    A 
+0000cf60: 6675 6e63 7469 6f6e 2074 6861 7420 636f  function that co
+0000cf70: 6d62 696e 6573 2074 6865 2072 656c 6576  mbines the relev
+0000cf80: 616e 7420 7065 7263 656e 7469 6c65 2061  ant percentile a
+0000cf90: 6e64 2075 7469 6c69 7479 2066 756e 6374  nd utility funct
+0000cfa0: 696f 6e73 2074 6f0d 0a20 2020 2067 656e  ions to..    gen
+0000cfb0: 6572 6174 6520 7468 6520 7065 7263 656e  erate the percen
+0000cfc0: 6974 6c65 2072 6573 756c 7473 2066 6f72  itle results for
+0000cfd0: 2067 726f 7570 7320 7769 7468 696e 2061   groups within a
+0000cfe0: 2044 6174 6146 7261 6d65 2e0d 0a0d 0a20   DataFrame..... 
+0000cff0: 2020 2050 6172 616d 6574 6572 730d 0a20     Parameters.. 
+0000d000: 2020 202d 2d2d 2d2d 2d2d 2d2d 2d0d 0a20     ----------.. 
+0000d010: 2020 2064 6620 3a20 4461 7461 4672 616d     df : DataFram
+0000d020: 650d 0a20 2020 2020 2020 2044 6174 6146  e..        DataF
+0000d030: 7261 6d65 2074 6861 7420 636f 6e74 6169  rame that contai
+0000d040: 6e73 2063 656e 736f 7265 6420 6f72 2075  ns censored or u
+0000d050: 6e63 656e 736f 7265 6420 7265 7375 6c74  ncensored result
+0000d060: 730d 0a20 2020 2072 6573 756c 7473 5f63  s..    results_c
+0000d070: 6f6c 203a 2073 7472 696e 670d 0a20 2020  ol : string..   
+0000d080: 2020 2020 2054 6865 2063 6f6c 756d 6e20       The column 
+0000d090: 6e61 6d65 2066 6f72 2074 6865 2063 6f6c  name for the col
+0000d0a0: 756d 6e20 7468 6174 2063 6f6e 7461 696e  umn that contain
+0000d0b0: 2074 6865 2072 6573 756c 7473 2061 7320   the results as 
+0000d0c0: 7465 7874 2e0d 0a20 2020 2020 2020 204f  text...        O
+0000d0d0: 6e6c 7920 666f 7572 2070 6f73 7369 626c  nly four possibl
+0000d0e0: 6520 6365 6e73 6f72 7320 7368 6f75 6c64  e censors should
+0000d0f0: 2062 6520 7573 6564 2028 3c2c e289 a42c   be used (<,...,
+0000d100: e289 a52c 3e29 2e0d 0a20 2020 2074 6872  ...,>)...    thr
+0000d110: 6573 686f 6c64 203a 2066 6c6f 6174 0d0a  eshold : float..
+0000d120: 2020 2020 2020 2020 5468 6520 7468 7265          The thre
+0000d130: 7368 6f6c 6420 6f66 2069 6e74 6572 6573  shold of interes
+0000d140: 742e 0d0a 2020 2020 636f 756e 745f 7468  t...    count_th
+0000d150: 7265 7368 6f6c 645f 6173 5f65 7863 6565  reshold_as_excee
+0000d160: 6461 6e63 6520 3a20 626f 6f6c 6561 6e0d  dance : boolean.
+0000d170: 0a20 2020 2020 2020 2053 6574 2061 7320  .        Set as 
+0000d180: 5472 7565 2069 6620 7468 6520 7468 7265  True if the thre
+0000d190: 7368 6f6c 6420 7661 6c75 6520 7368 6f75  shold value shou
+0000d1a0: 6c64 2062 6520 636f 756e 7465 6420 6173  ld be counted as
+0000d1b0: 2061 6e20 6578 6365 6564 616e 6365 2e0d   an exceedance..
+0000d1c0: 0a20 2020 2020 2020 2054 6865 2064 6566  .        The def
+0000d1d0: 6175 6c74 2069 7320 4661 6c73 652e 0d0a  ault is False...
+0000d1e0: 2020 2020 6772 6f75 7062 795f 636f 6c73      groupby_cols
+0000d1f0: 203a 206c 6973 7473 206f 6620 7374 7269   : lists of stri
+0000d200: 6e67 7320 286f 7220 6c69 7374 206f 6620  ngs (or list of 
+0000d210: 7477 6f20 6c69 7374 7329 2c20 6f70 7469  two lists), opti
+0000d220: 6f6e 616c 0d0a 2020 2020 2020 2020 4c69  onal..        Li
+0000d230: 7374 206f 6620 636f 6c75 6d6e 206e 616d  st of column nam
+0000d240: 6573 2074 6861 7420 7368 6f75 6c64 2062  es that should b
+0000d250: 6520 7573 6564 2074 6f20 6372 6561 7465  e used to create
+0000d260: 2067 726f 7570 732e 2050 6572 6365 6e74   groups. Percent
+0000d270: 6167 650d 0a20 2020 2020 2020 206f 6620  age..        of 
+0000d280: 6578 6365 6564 616e 6365 7320 7769 6c6c  exceedances will
+0000d290: 2062 6520 666f 756e 6420 7769 7468 696e   be found within
+0000d2a0: 2065 6163 6820 6772 6f75 702e 2054 776f   each group. Two
+0000d2b0: 206c 6973 7473 2063 616e 2062 650d 0a20   lists can be.. 
+0000d2c0: 2020 2020 2020 2073 7570 706c 6965 6420         supplied 
+0000d2d0: 746f 2066 6972 7374 2066 696e 6420 7468  to first find th
+0000d2e0: 6520 6d61 7869 6d75 6d20 7769 7468 696e  e maximum within
+0000d2f0: 2065 6163 6820 6772 6f75 7020 6265 666f   each group befo
+0000d300: 7265 0d0a 2020 2020 2020 2020 6465 7465  re..        dete
+0000d310: 726d 696e 696e 6720 7468 6520 7065 7263  rmining the perc
+0000d320: 656e 7461 6765 206f 6620 6578 6365 6564  entage of exceed
+0000d330: 616e 6365 7320 6f76 6572 2074 6865 2073  ances over the s
+0000d340: 6563 6f6e 6420 6772 6f75 7069 6e67 2e0d  econd grouping..
+0000d350: 0a20 2020 2020 2020 2054 6865 2064 6566  .        The def
+0000d360: 6175 6c74 2069 7320 4e6f 6e65 2e0d 0a20  ault is None... 
+0000d370: 2020 2069 6e63 6c75 6465 5f6e 6567 6174     include_negat
+0000d380: 6976 655f 696e 7465 7276 616c 203a 2062  ive_interval : b
+0000d390: 6f6f 6c65 616e 2c20 6f70 7469 6f6e 616c  oolean, optional
+0000d3a0: 0d0a 2020 2020 2020 2020 4966 2054 7275  ..        If Tru
+0000d3b0: 652c 2074 6865 6e20 616c 6c20 706f 7369  e, then all posi
+0000d3c0: 7469 7665 2061 6e64 206e 6567 6174 6976  tive and negativ
+0000d3d0: 6520 7661 6c75 6573 2061 7265 2063 6f6e  e values are con
+0000d3e0: 7369 6465 7265 640d 0a20 2020 2020 2020  sidered..       
+0000d3f0: 2065 2e67 2e2c 203c 302e 3520 776f 756c   e.g., <0.5 woul
+0000d400: 6420 6265 2063 6f6e 7665 7274 6564 2074  d be converted t
+0000d410: 6f20 282d 6e70 2e69 6e66 2c35 292e 0d0a  o (-np.inf,5)...
+0000d420: 2020 2020 2020 2020 4966 2046 616c 7365          If False
+0000d430: 2c20 7468 656e 206f 6e6c 7920 6e6f 6e2d  , then only non-
+0000d440: 6e65 6761 7469 7665 2076 616c 7565 7320  negative values 
+0000d450: 6172 6520 636f 6e73 6964 6572 6564 0d0a  are considered..
+0000d460: 2020 2020 2020 2020 652e 672e 2c20 3c30          e.g., <0
+0000d470: 2e35 2077 6f75 6c64 2062 6520 636f 6e76  .5 would be conv
+0000d480: 6572 7465 6420 746f 205b 302c 3529 2e0d  erted to [0,5)..
+0000d490: 0a20 2020 2020 2020 2054 6869 7320 7365  .        This se
+0000d4a0: 7474 696e 6720 6f6e 6c79 2061 6666 6563  tting only affec
+0000d4b0: 7473 2072 6573 756c 7473 2069 6620 666f  ts results if fo
+0000d4c0: 6375 735f 6869 6768 5f70 6f74 656e 7469  cus_high_potenti
+0000d4d0: 616c 2069 7320 4661 6c73 652e 0d0a 2020  al is False...  
+0000d4e0: 2020 2020 2020 5468 6520 6465 6661 756c        The defaul
+0000d4f0: 7420 6973 2046 616c 7365 2e0d 0a0d 0a20  t is False..... 
+0000d500: 2020 2052 6574 7572 6e73 0d0a 2020 2020     Returns..    
+0000d510: 2d2d 2d2d 2d2d 2d0d 0a20 2020 2064 6620  -------..    df 
+0000d520: 3a20 4461 7461 4672 616d 650d 0a20 2020  : DataFrame..   
+0000d530: 2020 2020 2044 6174 6146 7261 6d65 2074       DataFrame t
+0000d540: 6861 7420 636f 6e74 6169 6e73 2063 616c  hat contains cal
+0000d550: 6375 6c61 7465 6420 7065 7263 656e 7469  culated percenti
+0000d560: 6c65 730d 0a0d 0a20 2020 2027 2727 0d0a  les....    '''..
+0000d570: 2020 2020 0d0a 2020 2020 2320 4372 6561      ..    # Crea
+0000d580: 7465 2061 2063 6f70 7920 6f66 2074 6865  te a copy of the
+0000d590: 2044 6174 6146 7261 6d65 0d0a 2020 2020   DataFrame..    
+0000d5a0: 6466 203d 2064 662e 636f 7079 2829 0d0a  df = df.copy()..
+0000d5b0: 2020 2020 0d0a 2020 2020 2320 5370 6c69      ..    # Spli
+0000d5c0: 7420 7468 6520 7265 7375 6c74 2069 6e74  t the result int
+0000d5d0: 6f20 6365 6e73 6f72 2061 6e64 206e 756d  o censor and num
+0000d5e0: 6572 6963 2063 6f6d 706f 6e65 6e74 730d  eric components.
+0000d5f0: 0a20 2020 2064 6620 3d20 7265 7375 6c74  .    df = result
+0000d600: 5f74 6f5f 636f 6d70 6f6e 656e 7473 2864  _to_components(d
+0000d610: 662c 7265 7375 6c74 735f 636f 6c29 0d0a  f,results_col)..
+0000d620: 2020 2020 0d0a 2020 2020 2320 436f 6e76      ..    # Conv
+0000d630: 6572 7420 7468 6520 7265 7375 6c74 7320  ert the results 
+0000d640: 6672 6f6d 2063 656e 736f 7220 616e 6420  from censor and 
+0000d650: 6e75 6d65 7269 6320 636f 6d70 6f6e 656e  numeric componen
+0000d660: 7473 2074 6f20 616e 2069 6e74 6572 7661  ts to an interva
+0000d670: 6c20 7265 7072 6573 656e 7461 7469 6f6e  l representation
+0000d680: 0d0a 2020 2020 6466 203d 2063 6f6d 706f  ..    df = compo
+0000d690: 6e65 6e74 735f 746f 5f69 6e74 6572 7661  nents_to_interva
+0000d6a0: 6c28 6466 2c20 696e 636c 7564 655f 6e65  l(df, include_ne
+0000d6b0: 6761 7469 7665 5f69 6e74 6572 7661 6c29  gative_interval)
+0000d6c0: 0d0a 2020 2020 0d0a 2020 2020 2320 4173  ..    ..    # As
+0000d6d0: 7365 7373 2065 7863 6565 6461 6e63 6573  sess exceedances
+0000d6e0: 0d0a 2020 2020 6466 203d 2070 6572 6365  ..    df = perce
+0000d6f0: 6e74 5f65 7863 6565 6461 6e63 655f 6173  nt_exceedance_as
+0000d700: 7365 7373 6d65 6e74 2864 662c 0d0a 2020  sessment(df,..  
+0000d710: 2020 2020 2020 2020 2020 2020 2020 2020                  
+0000d720: 2020 2020 2020 2020 2020 2020 2020 2020                  
+0000d730: 2020 2020 2074 6872 6573 686f 6c64 3d74       threshold=t
+0000d740: 6872 6573 686f 6c64 2c0d 0a20 2020 2020  hreshold,..     
+0000d750: 2020 2020 2020 2020 2020 2020 2020 2020                  
+0000d760: 2020 2020 2020 2020 2020 2020 2020 2020                  
+0000d770: 2020 636f 756e 745f 7468 7265 7368 6f6c    count_threshol
+0000d780: 645f 6173 5f65 7863 6565 6461 6e63 653d  d_as_exceedance=
+0000d790: 636f 756e 745f 7468 7265 7368 6f6c 645f  count_threshold_
+0000d7a0: 6173 5f65 7863 6565 6461 6e63 6529 0d0a  as_exceedance)..
+0000d7b0: 2020 2020 0d0a 2020 2020 2320 4966 2074      ..    # If t
+0000d7c0: 6865 7265 2061 7265 206e 6f20 6772 6f75  here are no grou
+0000d7d0: 7062 792d 636f 6c75 6d6e 732c 2074 6865  pby-columns, the
+0000d7e0: 6e20 6361 6c63 756c 6174 6520 7065 7263  n calculate perc
+0000d7f0: 656e 7420 6578 6365 6564 616e 6365 7320  ent exceedances 
+0000d800: 6f66 2061 6c6c 2072 6573 756c 7473 0d0a  of all results..
+0000d810: 2020 2020 6966 206e 6f74 2067 726f 7570      if not group
+0000d820: 6279 5f63 6f6c 733a 0d0a 2020 2020 2020  by_cols:..      
+0000d830: 2020 6466 203d 2064 662e 6167 6728 2a2a    df = df.agg(**
+0000d840: 7b0d 0a20 2020 2020 2020 2020 2020 2020  {..             
+0000d850: 2020 2065 7863 6565 6461 6e63 6573 5f63     exceedances_c
+0000d860: 6f6c 3a20 2827 5f5f 4578 6365 6564 616e  ol: ('__Exceedan
+0000d870: 6365 5f5f 272c 2773 756d 2729 2c0d 0a20  ce__','sum'),.. 
+0000d880: 2020 2020 2020 2020 2020 2020 2020 2027                 '
+0000d890: 5f5f 4465 7465 726d 696e 6564 436f 756e  __DeterminedCoun
+0000d8a0: 745f 5f27 3a20 2827 5f5f 4578 6365 6564  t__': ('__Exceed
+0000d8b0: 616e 6365 5f5f 272c 2763 6f75 6e74 2729  ance__','count')
+0000d8c0: 2c0d 0a20 2020 2020 2020 2020 2020 2020  ,..             
+0000d8d0: 2020 2027 5f5f 546f 7461 6c43 6f75 6e74     '__TotalCount
+0000d8e0: 5f5f 273a 2028 275f 5f45 7863 6565 6461  __': ('__Exceeda
+0000d8f0: 6e63 655f 5f27 2c27 7369 7a65 2729 0d0a  nce__','size')..
+0000d900: 2020 2020 2020 2020 2020 2020 2020 2020                  
+0000d910: 7d29 2e74 7261 6e73 706f 7365 2829 2e72  }).transpose().r
+0000d920: 6573 6574 5f69 6e64 6578 2864 726f 703d  eset_index(drop=
+0000d930: 5472 7565 290d 0a20 2020 2023 2049 6620  True)..    # If 
+0000d940: 7468 6520 6772 6f75 7062 795f 636f 6c73  the groupby_cols
+0000d950: 2069 7320 6120 6c69 7374 206f 6620 6c69   is a list of li
+0000d960: 7374 732c 2074 6865 6e20 6173 7365 7373  sts, then assess
+0000d970: 206d 6178 696d 756d 7320 666f 7220 6669   maximums for fi
+0000d980: 7273 7420 6772 6f75 7069 6e67 0d0a 2020  rst grouping..  
+0000d990: 2020 2320 616e 6420 7065 7263 656e 7461    # and percenta
+0000d9a0: 6765 206f 6620 6578 6365 6564 616e 6365  ge of exceedance
+0000d9b0: 7320 666f 7220 7468 6520 7365 636f 6e64  s for the second
+0000d9c0: 2067 726f 7570 696e 670d 0a20 2020 2065   grouping..    e
+0000d9d0: 6c69 6620 2869 7369 6e73 7461 6e63 6528  lif (isinstance(
+0000d9e0: 6772 6f75 7062 795f 636f 6c73 5b30 5d2c  groupby_cols[0],
+0000d9f0: 6c69 7374 2929 2026 2028 6c65 6e28 6772  list)) & (len(gr
+0000da00: 6f75 7062 795f 636f 6c73 2920 213d 2032  oupby_cols) != 2
+0000da10: 293a 0d0a 2020 2020 2020 2020 7261 6973  ):..        rais
+0000da20: 6520 5661 6c75 6545 7272 6f72 2827 5477  e ValueError('Tw
+0000da30: 6f20 6c69 7374 7320 6d75 7374 2062 6520  o lists must be 
+0000da40: 696e 636c 7564 6564 2066 6f72 2067 726f  included for gro
+0000da50: 7570 6279 5f63 6f6c 7320 7468 6174 2069  upby_cols that i
+0000da60: 7320 6120 6c69 7374 206f 6620 6c69 7374  s a list of list
+0000da70: 732e 2729 0d0a 2020 2020 656c 6966 2069  s.')..    elif i
+0000da80: 7369 6e73 7461 6e63 6528 6772 6f75 7062  sinstance(groupb
+0000da90: 795f 636f 6c73 5b30 5d2c 6c69 7374 293a  y_cols[0],list):
+0000daa0: 0d0a 2020 2020 2020 2020 2320 5573 6520  ..        # Use 
+0000dab0: 6d61 7869 6d75 6d20 7769 7468 696e 2065  maximum within e
+0000dac0: 6163 6820 6772 6f75 7020 666f 7220 6669  ach group for fi
+0000dad0: 7273 7420 6772 6f75 7069 6e67 0d0a 2020  rst grouping..  
+0000dae0: 2020 2020 2020 6466 203d 2064 662e 6772        df = df.gr
+0000daf0: 6f75 7062 7928 6772 6f75 7062 795f 636f  oupby(groupby_co
+0000db00: 6c73 5b30 5d29 5b27 5f5f 4578 6365 6564  ls[0])['__Exceed
+0000db10: 616e 6365 5f5f 275d 2e6d 6178 2829 2e72  ance__'].max().r
+0000db20: 6573 6574 5f69 6e64 6578 2829 0d0a 2020  eset_index()..  
+0000db30: 2020 2020 2020 2320 5573 6520 7365 636f        # Use seco
+0000db40: 6e64 2067 726f 7570 696e 6720 666f 7220  nd grouping for 
+0000db50: 7065 7263 656e 7461 6765 206f 6620 6578  percentage of ex
+0000db60: 6365 6564 616e 6365 730d 0a20 2020 2020  ceedances..     
+0000db70: 2020 2064 6620 3d20 6466 2e67 726f 7570     df = df.group
+0000db80: 6279 2867 726f 7570 6279 5f63 6f6c 735b  by(groupby_cols[
+0000db90: 315d 292e 6167 6728 2a2a 7b0d 0a20 2020  1]).agg(**{..   
+0000dba0: 2020 2020 2020 2020 2020 2020 2065 7863               exc
+0000dbb0: 6565 6461 6e63 6573 5f63 6f6c 3a20 2827  eedances_col: ('
+0000dbc0: 5f5f 4578 6365 6564 616e 6365 5f5f 272c  __Exceedance__',
+0000dbd0: 2773 756d 2729 2c0d 0a20 2020 2020 2020  'sum'),..       
+0000dbe0: 2020 2020 2020 2020 2027 5f5f 4465 7465           '__Dete
+0000dbf0: 726d 696e 6564 436f 756e 745f 5f27 3a20  rminedCount__': 
+0000dc00: 2827 5f5f 4578 6365 6564 616e 6365 5f5f  ('__Exceedance__
+0000dc10: 272c 2763 6f75 6e74 2729 2c0d 0a20 2020  ','count'),..   
+0000dc20: 2020 2020 2020 2020 2020 2020 2027 5f5f               '__
+0000dc30: 546f 7461 6c43 6f75 6e74 5f5f 273a 2028  TotalCount__': (
+0000dc40: 275f 5f45 7863 6565 6461 6e63 655f 5f27  '__Exceedance__'
+0000dc50: 2c27 7369 7a65 2729 0d0a 2020 2020 2020  ,'size')..      
+0000dc60: 2020 2020 2020 2020 2020 7d29 0d0a 2020            })..  
+0000dc70: 2020 2320 456c 7365 2074 6865 2067 726f    # Else the gro
+0000dc80: 7570 6279 5f63 6f6c 7320 6973 2061 206c  upby_cols is a l
+0000dc90: 6973 7420 6f66 2063 6f6c 756d 6e20 6e61  ist of column na
+0000dca0: 6d65 730d 0a20 2020 2065 6c73 653a 0d0a  mes..    else:..
+0000dcb0: 2020 2020 2020 2020 6466 203d 2064 662e          df = df.
+0000dcc0: 6772 6f75 7062 7928 6772 6f75 7062 795f  groupby(groupby_
+0000dcd0: 636f 6c73 292e 6167 6728 2a2a 7b0d 0a20  cols).agg(**{.. 
+0000dce0: 2020 2020 2020 2020 2020 2020 2020 2065                 e
+0000dcf0: 7863 6565 6461 6e63 6573 5f63 6f6c 3a20  xceedances_col: 
+0000dd00: 2827 5f5f 4578 6365 6564 616e 6365 5f5f  ('__Exceedance__
+0000dd10: 272c 2773 756d 2729 2c0d 0a20 2020 2020  ','sum'),..     
+0000dd20: 2020 2020 2020 2020 2020 2027 5f5f 4465             '__De
+0000dd30: 7465 726d 696e 6564 436f 756e 745f 5f27  terminedCount__'
+0000dd40: 3a20 2827 5f5f 4578 6365 6564 616e 6365  : ('__Exceedance
+0000dd50: 5f5f 272c 2763 6f75 6e74 2729 2c0d 0a20  __','count'),.. 
+0000dd60: 2020 2020 2020 2020 2020 2020 2020 2027                 '
+0000dd70: 5f5f 546f 7461 6c43 6f75 6e74 5f5f 273a  __TotalCount__':
+0000dd80: 2028 275f 5f45 7863 6565 6461 6e63 655f   ('__Exceedance_
+0000dd90: 5f27 2c27 7369 7a65 2729 0d0a 2020 2020  _','size')..    
+0000dda0: 2020 2020 2020 2020 2020 2020 7d29 0d0a              })..
+0000ddb0: 2020 2020 0d0a 2020 2020 2320 4465 7465      ..    # Dete
+0000ddc0: 726d 696e 6520 636f 756e 7473 2061 6e64  rmine counts and
+0000ddd0: 2063 616c 6375 6c61 7465 2070 6572 6365   calculate perce
+0000dde0: 6e74 6167 650d 0a20 2020 2064 665b 6e6f  ntage..    df[no
+0000ddf0: 6e5f 6578 6365 6564 616e 6365 735f 636f  n_exceedances_co
+0000de00: 6c5d 203d 2064 665b 275f 5f44 6574 6572  l] = df['__Deter
+0000de10: 6d69 6e65 6443 6f75 6e74 5f5f 275d 202d  minedCount__'] -
+0000de20: 2064 665b 6578 6365 6564 616e 6365 735f   df[exceedances_
+0000de30: 636f 6c5d 0d0a 2020 2020 6466 5b69 676e  col]..    df[ign
+0000de40: 6f72 6564 5f63 6f6c 5d20 3d20 6466 5b27  ored_col] = df['
+0000de50: 5f5f 546f 7461 6c43 6f75 6e74 5f5f 275d  __TotalCount__']
+0000de60: 2d64 665b 275f 5f44 6574 6572 6d69 6e65  -df['__Determine
+0000de70: 6443 6f75 6e74 5f5f 275d 0d0a 2020 2020  dCount__']..    
+0000de80: 6466 5b70 6572 6365 6e74 5f65 7863 6565  df[percent_excee
+0000de90: 6461 6e63 6573 5f63 6f6c 5d20 3d20 6466  dances_col] = df
+0000dea0: 5b65 7863 6565 6461 6e63 6573 5f63 6f6c  [exceedances_col
+0000deb0: 5d20 2f20 6466 5b27 5f5f 4465 7465 726d  ] / df['__Determ
+0000dec0: 696e 6564 436f 756e 745f 5f27 5d20 2a20  inedCount__'] * 
+0000ded0: 3130 300d 0a20 2020 200d 0a20 2020 2023  100..    ..    #
+0000dee0: 2044 726f 7020 776f 726b 696e 6720 636f   Drop working co
+0000def0: 6c75 6d6e 730d 0a20 2020 2064 6620 3d20  lumns..    df = 
+0000df00: 6466 2e64 726f 7028 6466 2e66 696c 7465  df.drop(df.filte
+0000df10: 7228 7265 6765 783d 275f 5f27 292e 636f  r(regex='__').co
+0000df20: 6c75 6d6e 732c 2061 7869 733d 3129 0d0a  lumns, axis=1)..
+0000df30: 2020 2020 0d0a 2020 2020 2320 5265 6f72      ..    # Reor
+0000df40: 6465 7220 636f 6c75 6d6e 730d 0a20 2020  der columns..   
+0000df50: 2066 6f72 2063 6f6c 2069 6e20 5b70 6572   for col in [per
+0000df60: 6365 6e74 5f65 7863 6565 6461 6e63 6573  cent_exceedances
+0000df70: 5f63 6f6c 2c65 7863 6565 6461 6e63 6573  _col,exceedances
+0000df80: 5f63 6f6c 2c6e 6f6e 5f65 7863 6565 6461  _col,non_exceeda
+0000df90: 6e63 6573 5f63 6f6c 2c69 676e 6f72 6564  nces_col,ignored
+0000dfa0: 5f63 6f6c 5d3a 0d0a 2020 2020 2020 2020  _col]:..        
+0000dfb0: 6466 5b63 6f6c 5d20 3d20 6466 2e70 6f70  df[col] = df.pop
+0000dfc0: 2863 6f6c 290d 0a20 2020 200d 0a20 2020  (col)..    ..   
+0000dfd0: 2023 2052 6573 6574 2069 6e64 6578 0d0a   # Reset index..
+0000dfe0: 2020 2020 6466 203d 2064 662e 7265 7365      df = df.rese
+0000dff0: 745f 696e 6465 7828 290d 0a20 2020 200d  t_index()..    .
+0000e000: 0a20 2020 2072 6574 7572 6e20 6466 0d0a  .    return df..
+0000e010: 0d0a 2325 2520 4164 6469 7469 6f6e 0d0a  ..#%% Addition..
+0000e020: 0d0a 6465 6620 6164 645f 696e 7465 7276  ..def add_interv
+0000e030: 616c 7328 6466 2c0d 0a20 2020 2020 2020  als(df,..       
+0000e040: 2020 2020 2020 2020 2020 2067 726f 7570             group
+0000e050: 6279 5f63 6f6c 7329 3a0d 0a20 2020 2027  by_cols):..    '
+0000e060: 2727 0d0a 2020 2020 4120 6675 6e63 7469  ''..    A functi
+0000e070: 6f6e 2074 6861 7420 6164 6473 2074 6865  on that adds the
+0000e080: 2069 6e74 6572 7661 6c20 6e6f 7461 7469   interval notati
+0000e090: 6f6e 2066 6f72 6d20 6f66 2072 6573 756c  on form of resul
+0000e0a0: 7473 2072 6574 7572 6e65 640d 0a20 2020  ts returned..   
+0000e0b0: 2066 726f 6d20 636f 6d70 6f6e 656e 7473   from components
+0000e0c0: 5f74 6f5f 696e 7465 7276 616c 2074 6f20  _to_interval to 
+0000e0d0: 6765 6e65 7261 7465 2061 206e 6577 2069  generate a new i
+0000e0e0: 6e74 6572 7661 6c20 666f 7220 7468 6520  nterval for the 
+0000e0f0: 7375 6d2e 2047 726f 7570 730d 0a20 2020  sum. Groups..   
+0000e100: 206f 6620 7265 7375 6c74 7320 6361 6e20   of results can 
+0000e110: 6265 2064 6566 696e 6564 2062 7920 696e  be defined by in
+0000e120: 636c 7564 696e 6720 7468 6520 636f 6c75  cluding the colu
+0000e130: 6d6e 7320 7468 6174 2073 686f 756c 6420  mns that should 
+0000e140: 6265 2075 7365 6420 746f 0d0a 2020 2020  be used to..    
+0000e150: 6372 6561 7465 2067 726f 7570 732e 0d0a  create groups...
+0000e160: 0d0a 2020 2020 5061 7261 6d65 7465 7273  ..    Parameters
+0000e170: 0d0a 2020 2020 2d2d 2d2d 2d2d 2d2d 2d2d  ..    ----------
+0000e180: 0d0a 2020 2020 6466 203a 2044 6174 6146  ..    df : DataF
+0000e190: 7261 6d65 0d0a 2020 2020 2020 2020 4461  rame..        Da
+0000e1a0: 7461 4672 616d 6520 7468 6174 2063 6f6e  taFrame that con
+0000e1b0: 7461 696e 7320 7265 7375 6c74 7320 696e  tains results in
+0000e1c0: 2061 2073 7065 6369 6669 6320 696e 7465   a specific inte
+0000e1d0: 7276 616c 206e 6f74 6174 696f 6e2e 0d0a  rval notation...
+0000e1e0: 2020 2020 6772 6f75 7062 795f 636f 6c73      groupby_cols
+0000e1f0: 203a 206c 6973 7420 6f66 2073 7472 696e   : list of strin
+0000e200: 6773 0d0a 2020 2020 2020 2020 4c69 7374  gs..        List
+0000e210: 206f 6620 636f 6c75 6d6e 206e 616d 6573   of column names
+0000e220: 2074 6861 7420 7368 6f75 6c64 2062 6520   that should be 
+0000e230: 7573 6564 2074 6f20 6372 6561 7465 2067  used to create g
+0000e240: 726f 7570 732e 0d0a 0d0a 2020 2020 5265  roups.....    Re
+0000e250: 7475 726e 730d 0a20 2020 202d 2d2d 2d2d  turns..    -----
+0000e260: 2d2d 0d0a 2020 2020 6466 203a 2044 6174  --..    df : Dat
+0000e270: 6146 7261 6d65 0d0a 2020 2020 2020 2020  aFrame..        
+0000e280: 4461 7461 4672 616d 6520 7468 6174 2068  DataFrame that h
+0000e290: 6173 2074 6865 2069 6e74 6572 7661 6c20  as the interval 
+0000e2a0: 666f 7220 7468 6520 7375 6d20 2866 6f72  for the sum (for
+0000e2b0: 2065 6163 6820 6772 6f75 7020 6966 0d0a   each group if..
+0000e2c0: 2020 2020 2020 2020 636f 6c75 6d6e 206e          column n
+0000e2d0: 616d 6573 2061 7265 2070 726f 7669 6465  ames are provide
+0000e2e0: 6420 666f 7220 6772 6f75 7069 6e67 290d  d for grouping).
+0000e2f0: 0a0d 0a20 2020 2027 2727 0d0a 2020 2020  ...    '''..    
+0000e300: 0d0a 2020 2020 2320 4372 6561 7465 2061  ..    # Create a
+0000e310: 2063 6f70 7920 6f66 2074 6865 2044 6174   copy of the Dat
+0000e320: 6146 7261 6d65 0d0a 2020 2020 6466 203d  aFrame..    df =
+0000e330: 2064 662e 636f 7079 2829 0d0a 2020 2020   df.copy()..    
+0000e340: 0d0a 2020 2020 2320 4372 6561 7465 2063  ..    # Create c
+0000e350: 6f6c 756d 6e20 7468 6174 2069 6e64 6963  olumn that indic
+0000e360: 6174 6573 2074 6865 2067 656e 6572 6174  ates the generat
+0000e370: 6564 2073 7461 7469 7374 6963 2061 6e64  ed statistic and
+0000e380: 2061 7070 656e 6420 746f 2067 726f 7570   append to group
+0000e390: 696e 6720 6c69 7374 0d0a 2020 2020 6466  ing list..    df
+0000e3a0: 5b73 7461 745f 636f 6c5d 203d 2027 5375  [stat_col] = 'Su
+0000e3b0: 6d27 0d0a 2020 2020 6772 6f75 7062 795f  m'..    groupby_
+0000e3c0: 636f 6c73 2e61 7070 656e 6428 7374 6174  cols.append(stat
+0000e3d0: 5f63 6f6c 290d 0a20 2020 200d 0a20 2020  _col)..    ..   
+0000e3e0: 2023 2043 6861 6e67 6520 6e6f 7461 7469   # Change notati
+0000e3f0: 6f6e 206f 6620 2743 6c6f 7365 6427 2061  on of 'Closed' a
+0000e400: 6e64 2027 4f70 656e 2720 626f 756e 6461  nd 'Open' bounda
+0000e410: 7269 6573 2074 6f20 3020 616e 6420 312c  ries to 0 and 1,
+0000e420: 2072 6573 7065 6374 6976 656c 790d 0a20   respectively.. 
+0000e430: 2020 2023 2054 6865 2070 7265 7365 6e63     # The presenc
+0000e440: 6520 6f66 2061 6e79 206f 7065 6e20 626f  e of any open bo
+0000e450: 756e 6461 7269 6573 206f 6e20 6f6e 6520  undaries on one 
+0000e460: 7369 6465 2065 6e73 7572 6520 7468 6174  side ensure that
+0000e470: 2074 6865 2069 6e74 6572 7661 6c20 666f   the interval fo
+0000e480: 7220 7468 6520 7375 6d20 6973 2061 6c73  r the sum is als
+0000e490: 6f0d 0a20 2020 2023 206f 7065 6e20 6f6e  o..    # open on
+0000e4a0: 2074 6861 7420 7369 6465 0d0a 2020 2020   that side..    
+0000e4b0: 6466 5b5b 6c65 6674 5f62 6f75 6e64 6172  df[[left_boundar
+0000e4c0: 795f 636f 6c2c 7269 6768 745f 626f 756e  y_col,right_boun
+0000e4d0: 6461 7279 5f63 6f6c 5d5d 203d 2064 665b  dary_col]] = df[
+0000e4e0: 5b6c 6566 745f 626f 756e 6461 7279 5f63  [left_boundary_c
+0000e4f0: 6f6c 2c72 6967 6874 5f62 6f75 6e64 6172  ol,right_boundar
+0000e500: 795f 636f 6c5d 5d2e 7265 706c 6163 6528  y_col]].replace(
+0000e510: 5b27 436c 6f73 6564 272c 274f 7065 6e27  ['Closed','Open'
+0000e520: 5d2c 205b 302c 315d 290d 0a20 2020 200d  ], [0,1])..    .
+0000e530: 0a20 2020 2023 2047 6574 2074 6865 206c  .    # Get the l
+0000e540: 6566 742f 7269 6768 7420 626f 756e 6473  eft/right bounds
+0000e550: 206f 6620 7468 6520 7375 6d20 6279 2061   of the sum by a
+0000e560: 6464 696e 6720 626f 756e 6473 2077 6974  dding bounds wit
+0000e570: 6869 6e20 7468 6520 6772 6f75 700d 0a20  hin the group.. 
+0000e580: 2020 2023 2044 6574 6572 6d69 6e65 2077     # Determine w
+0000e590: 6865 7468 6572 2061 6e79 204f 7065 6e20  hether any Open 
+0000e5a0: 286e 6f77 2076 616c 7565 206f 6620 3129  (now value of 1)
+0000e5b0: 2062 6f75 6e64 6172 6965 7320 6578 6973   boundaries exis
+0000e5c0: 742e 2049 6620 7468 6572 6520 6172 650d  t. If there are.
+0000e5d0: 0a20 2020 2023 2061 6e79 206f 7065 6e20  .    # any open 
+0000e5e0: 626f 756e 6461 7269 6573 2075 7365 6420  boundaries used 
+0000e5f0: 696e 2074 6865 2073 756d 2c20 7468 656e  in the sum, then
+0000e600: 2074 6865 2072 6573 756c 7469 6e67 2073   the resulting s
+0000e610: 756d 2077 696c 6c20 6265 206f 7065 6e0d  um will be open.
+0000e620: 0a20 2020 2064 6620 3d20 6466 2e67 726f  .    df = df.gro
+0000e630: 7570 6279 2867 726f 7570 6279 5f63 6f6c  upby(groupby_col
+0000e640: 7329 2e61 6767 282a 2a7b 0d0a 2020 2020  s).agg(**{..    
+0000e650: 2020 2020 2020 2020 2020 2020 2020 2020                  
+0000e660: 2020 2020 2020 2020 6c65 6674 5f62 6f75          left_bou
+0000e670: 6e64 6172 795f 636f 6c3a 2028 6c65 6674  ndary_col: (left
+0000e680: 5f62 6f75 6e64 6172 795f 636f 6c2c 2027  _boundary_col, '
+0000e690: 6d61 7827 292c 0d0a 2020 2020 2020 2020  max'),..        
+0000e6a0: 2020 2020 2020 2020 2020 2020 2020 2020                  
+0000e6b0: 2020 2020 275f 5f4d 696e 696d 756d 5f5f      '__Minimum__
+0000e6c0: 273a 2028 6c65 6674 5f62 6f75 6e64 5f63  ': (left_bound_c
+0000e6d0: 6f6c 2c27 6d69 6e27 292c 0d0a 2020 2020  ol,'min'),..    
+0000e6e0: 2020 2020 2020 2020 2020 2020 2020 2020                  
+0000e6f0: 2020 2020 2020 2020 6c65 6674 5f62 6f75          left_bou
+0000e700: 6e64 5f63 6f6c 3a20 286c 6566 745f 626f  nd_col: (left_bo
+0000e710: 756e 645f 636f 6c2c 2773 756d 2729 2c0d  und_col,'sum'),.
+0000e720: 0a20 2020 2020 2020 2020 2020 2020 2020  .               
+0000e730: 2020 2020 2020 2020 2020 2020 2072 6967               rig
+0000e740: 6874 5f62 6f75 6e64 5f63 6f6c 3a20 2872  ht_bound_col: (r
+0000e750: 6967 6874 5f62 6f75 6e64 5f63 6f6c 2c27  ight_bound_col,'
+0000e760: 7375 6d27 292c 0d0a 2020 2020 2020 2020  sum'),..        
+0000e770: 2020 2020 2020 2020 2020 2020 2020 2020                  
+0000e780: 2020 2020 275f 5f4d 6178 696d 756d 5f5f      '__Maximum__
+0000e790: 273a 2028 7269 6768 745f 626f 756e 645f  ': (right_bound_
+0000e7a0: 636f 6c2c 276d 6178 2729 2c0d 0a20 2020  col,'max'),..   
+0000e7b0: 2020 2020 2020 2020 2020 2020 2020 2020                  
+0000e7c0: 2020 2020 2020 2020 2072 6967 6874 5f62           right_b
+0000e7d0: 6f75 6e64 6172 795f 636f 6c3a 2028 7269  oundary_col: (ri
+0000e7e0: 6768 745f 626f 756e 6461 7279 5f63 6f6c  ght_boundary_col
+0000e7f0: 2c27 6d61 7827 290d 0a20 2020 2020 2020  ,'max')..       
+0000e800: 2020 2020 2020 2020 2020 2020 2020 2020                  
+0000e810: 2020 2020 207d 290d 0a20 2020 200d 0a20       })..    .. 
+0000e820: 2020 2023 2052 6570 6c61 6365 2069 6e74     # Replace int
+0000e830: 6567 6572 7320 7769 7468 2074 6578 7420  egers with text 
+0000e840: 666f 7220 626f 756e 6461 7269 6573 0d0a  for boundaries..
+0000e850: 2020 2020 6466 5b5b 6c65 6674 5f62 6f75      df[[left_bou
+0000e860: 6e64 6172 795f 636f 6c2c 7269 6768 745f  ndary_col,right_
+0000e870: 626f 756e 6461 7279 5f63 6f6c 5d5d 203d  boundary_col]] =
+0000e880: 2064 665b 5b6c 6566 745f 626f 756e 6461   df[[left_bounda
+0000e890: 7279 5f63 6f6c 2c72 6967 6874 5f62 6f75  ry_col,right_bou
+0000e8a0: 6e64 6172 795f 636f 6c5d 5d2e 7265 706c  ndary_col]].repl
+0000e8b0: 6163 6528 5b30 2c31 5d2c 205b 2743 6c6f  ace([0,1], ['Clo
+0000e8c0: 7365 6427 2c27 4f70 656e 275d 290d 0a20  sed','Open']).. 
+0000e8d0: 2020 200d 0a20 2020 2023 2053 756d 7320     ..    # Sums 
+0000e8e0: 7769 7468 2069 6e66 696e 6974 6520 7661  with infinite va
+0000e8f0: 6c75 6573 2070 726f 6475 6365 206e 616e  lues produce nan
+0000e900: 2076 616c 7565 7320 7261 7468 6572 2074   values rather t
+0000e910: 6861 6e20 6e70 2e69 6e66 2076 616c 7565  han np.inf value
+0000e920: 730d 0a20 2020 2023 2043 6f6e 7665 7274  s..    # Convert
+0000e930: 206e 616e 2074 6f20 696e 6620 6f6e 6c79   nan to inf only
+0000e940: 2069 6620 696e 6669 6e69 7465 2076 616c   if infinite val
+0000e950: 7565 7320 6172 6520 696e 636c 7564 6564  ues are included
+0000e960: 2069 6e20 7468 6520 7375 6d0d 0a20 2020   in the sum..   
+0000e970: 2064 665b 6c65 6674 5f62 6f75 6e64 5f63   df[left_bound_c
+0000e980: 6f6c 5d20 3d20 6e70 2e77 6865 7265 2864  ol] = np.where(d
+0000e990: 665b 275f 5f4d 696e 696d 756d 5f5f 275d  f['__Minimum__']
+0000e9a0: 203d 3d20 2d6e 702e 696e 662c 202d 6e70   == -np.inf, -np
+0000e9b0: 2e69 6e66 2c20 6466 5b6c 6566 745f 626f  .inf, df[left_bo
+0000e9c0: 756e 645f 636f 6c5d 290d 0a20 2020 2064  und_col])..    d
+0000e9d0: 665b 7269 6768 745f 626f 756e 645f 636f  f[right_bound_co
+0000e9e0: 6c5d 203d 206e 702e 7768 6572 6528 6466  l] = np.where(df
+0000e9f0: 5b27 5f5f 4d61 7869 6d75 6d5f 5f27 5d20  ['__Maximum__'] 
+0000ea00: 3d3d 206e 702e 696e 662c 206e 702e 696e  == np.inf, np.in
+0000ea10: 662c 2064 665b 7269 6768 745f 626f 756e  f, df[right_boun
+0000ea20: 645f 636f 6c5d 290d 0a20 2020 200d 0a20  d_col])..    .. 
+0000ea30: 2020 2023 2052 6573 6574 2069 6e64 6578     # Reset index
+0000ea40: 0d0a 2020 2020 6466 203d 2064 662e 7265  ..    df = df.re
+0000ea50: 7365 745f 696e 6465 7828 290d 0a20 2020  set_index()..   
+0000ea60: 200d 0a20 2020 2072 6574 7572 6e20 6466   ..    return df
+0000ea70: 0d0a 0d0a 6465 6620 6164 6469 7469 6f6e  ....def addition
+0000ea80: 2864 662c 0d0a 2020 2020 2020 2020 2020  (df,..          
+0000ea90: 2020 2072 6573 756c 7473 5f63 6f6c 2c0d     results_col,.
+0000eaa0: 0a20 2020 2020 2020 2020 2020 2020 6772  .             gr
+0000eab0: 6f75 7062 795f 636f 6c73 203d 204e 6f6e  oupby_cols = Non
+0000eac0: 652c 0d0a 2020 2020 2020 2020 2020 2020  e,..            
+0000ead0: 2066 6f63 7573 5f68 6967 685f 706f 7465   focus_high_pote
+0000eae0: 6e74 6961 6c20 3d20 5472 7565 2c0d 0a20  ntial = True,.. 
+0000eaf0: 2020 2020 2020 2020 2020 2020 696e 636c              incl
+0000eb00: 7564 655f 6e65 6761 7469 7665 5f69 6e74  ude_negative_int
+0000eb10: 6572 7661 6c20 3d20 4661 6c73 652c 0d0a  erval = False,..
+0000eb20: 2020 2020 2020 2020 2020 2020 2070 7265               pre
+0000eb30: 6369 7369 6f6e 5f74 6f6c 6572 616e 6365  cision_tolerance
+0000eb40: 5f74 6f5f 6472 6f70 5f63 656e 736f 7220  _to_drop_censor 
+0000eb50: 3d20 302e 3235 2c0d 0a20 2020 2020 2020  = 0.25,..       
+0000eb60: 2020 2020 2020 7072 6563 6973 696f 6e5f        precision_
+0000eb70: 726f 756e 6469 6e67 203d 2054 7275 6529  rounding = True)
+0000eb80: 3a0d 0a20 2020 2027 2727 0d0a 2020 2020  :..    '''..    
+0000eb90: 4120 6675 6e63 7469 6f6e 2074 6861 7420  A function that 
+0000eba0: 636f 6d62 696e 6573 2074 6865 2072 656c  combines the rel
+0000ebb0: 6576 616e 7420 6164 6469 7469 6f6e 2061  evant addition a
+0000ebc0: 6e64 2075 7469 6c69 7479 2066 756e 6374  nd utility funct
+0000ebd0: 696f 6e73 2074 6f0d 0a20 2020 2073 756d  ions to..    sum
+0000ebe0: 2072 6573 756c 7473 2066 6f72 2067 726f   results for gro
+0000ebf0: 7570 7320 7769 7468 696e 2061 2044 6174  ups within a Dat
+0000ec00: 6146 7261 6d65 2e0d 0a0d 0a20 2020 2050  aFrame.....    P
+0000ec10: 6172 616d 6574 6572 730d 0a20 2020 202d  arameters..    -
+0000ec20: 2d2d 2d2d 2d2d 2d2d 2d0d 0a20 2020 2064  ---------..    d
+0000ec30: 6620 3a20 4461 7461 4672 616d 650d 0a20  f : DataFrame.. 
+0000ec40: 2020 2020 2020 2044 6174 6146 7261 6d65         DataFrame
+0000ec50: 2074 6861 7420 636f 6e74 6169 6e73 2063   that contains c
+0000ec60: 656e 736f 7265 6420 6f72 2075 6e63 656e  ensored or uncen
+0000ec70: 736f 7265 6420 7265 7375 6c74 730d 0a20  sored results.. 
+0000ec80: 2020 2072 6573 756c 7473 5f63 6f6c 203a     results_col :
+0000ec90: 2073 7472 696e 670d 0a20 2020 2020 2020   string..       
+0000eca0: 2054 6865 2063 6f6c 756d 6e20 6e61 6d65   The column name
+0000ecb0: 2066 6f72 2074 6865 2063 6f6c 756d 6e20   for the column 
+0000ecc0: 7468 6174 2063 6f6e 7461 696e 2074 6865  that contain the
+0000ecd0: 2072 6573 756c 7473 2061 7320 7465 7874   results as text
+0000ece0: 2e0d 0a20 2020 2020 2020 204f 6e6c 7920  ...        Only 
+0000ecf0: 666f 7572 2070 6f73 7369 626c 6520 6365  four possible ce
+0000ed00: 6e73 6f72 7320 7368 6f75 6c64 2062 6520  nsors should be 
+0000ed10: 7573 6564 2028 3c2c e289 a42c e289 a52c  used (<,...,...,
+0000ed20: 3e29 2e0d 0a20 2020 2067 726f 7570 6279  >)...    groupby
+0000ed30: 5f63 6f6c 7320 3a20 6c69 7374 7320 6f66  _cols : lists of
+0000ed40: 2073 7472 696e 6773 2028 6f72 206c 6973   strings (or lis
+0000ed50: 7420 6f66 206c 6973 7473 292c 206f 7074  t of lists), opt
+0000ed60: 696f 6e61 6c0d 0a20 2020 2020 2020 204c  ional..        L
+0000ed70: 6973 7420 6f66 2063 6f6c 756d 6e20 6e61  ist of column na
+0000ed80: 6d65 7320 7468 6174 2073 686f 756c 6420  mes that should 
+0000ed90: 6265 2075 7365 6420 746f 2063 7265 6174  be used to creat
+0000eda0: 6520 6772 6f75 7073 2e20 416e 2061 7665  e groups. An ave
+0000edb0: 7261 6765 0d0a 2020 2020 2020 2020 7769  rage..        wi
+0000edc0: 6c6c 2062 6520 666f 756e 6420 7769 7468  ll be found with
+0000edd0: 696e 2065 6163 6820 6772 6f75 702e 204d  in each group. M
+0000ede0: 756c 7469 706c 6520 6c69 7374 7320 6361  ultiple lists ca
+0000edf0: 6e20 6265 2073 7570 706c 6965 6420 746f  n be supplied to
+0000ee00: 0d0a 2020 2020 2020 2020 7065 7266 6f72  ..        perfor
+0000ee10: 6d20 7365 7175 656e 7469 616c 2061 7665  m sequential ave
+0000ee20: 7261 6769 6e67 2062 6566 6f72 6520 636f  raging before co
+0000ee30: 6e76 6572 7469 6e67 2069 6e74 6572 7661  nverting interva
+0000ee40: 6c73 2074 6f20 6120 7265 7375 6c74 2e0d  ls to a result..
+0000ee50: 0a20 2020 2020 2020 2054 6865 2064 6566  .        The def
+0000ee60: 6175 6c74 2069 7320 4e6f 6e65 2e0d 0a20  ault is None... 
+0000ee70: 2020 2066 6f63 7573 5f68 6967 685f 706f     focus_high_po
+0000ee80: 7465 6e74 6961 6c20 3a20 626f 6f6c 6561  tential : boolea
+0000ee90: 6e2c 206f 7074 696f 6e61 6c0d 0a20 2020  n, optional..   
+0000eea0: 2020 2020 2049 6620 5472 7565 2c20 7468       If True, th
+0000eeb0: 656e 2069 6e66 6f72 6d61 7469 6f6e 206f  en information o
+0000eec0: 6e20 7468 6520 6869 6768 6573 7420 706f  n the highest po
+0000eed0: 7465 6e74 6961 6c20 7265 7375 6c74 2077  tential result w
+0000eee0: 696c 6c20 6265 0d0a 2020 2020 2020 2020  ill be..        
+0000eef0: 666f 6375 7365 6420 6f76 6572 2074 6865  focused over the
+0000ef00: 206c 6f77 6573 7420 706f 7465 6e74 6961   lowest potentia
+0000ef10: 6c20 7265 7375 6c74 2e0d 0a20 2020 2069  l result...    i
+0000ef20: 6e63 6c75 6465 5f6e 6567 6174 6976 655f  nclude_negative_
+0000ef30: 696e 7465 7276 616c 203a 2062 6f6f 6c65  interval : boole
+0000ef40: 616e 2c20 6f70 7469 6f6e 616c 0d0a 2020  an, optional..  
+0000ef50: 2020 2020 2020 4966 2054 7275 652c 2074        If True, t
+0000ef60: 6865 6e20 616c 6c20 706f 7369 7469 7665  hen all positive
+0000ef70: 2061 6e64 206e 6567 6174 6976 6520 7661   and negative va
+0000ef80: 6c75 6573 2061 7265 2063 6f6e 7369 6465  lues are conside
+0000ef90: 7265 640d 0a20 2020 2020 2020 2065 2e67  red..        e.g
+0000efa0: 2e2c 203c 302e 3520 776f 756c 6420 6265  ., <0.5 would be
+0000efb0: 2063 6f6e 7665 7274 6564 2074 6f20 282d   converted to (-
+0000efc0: 6e70 2e69 6e66 2c35 292e 0d0a 2020 2020  np.inf,5)...    
+0000efd0: 2020 2020 4966 2046 616c 7365 2c20 7468      If False, th
+0000efe0: 656e 206f 6e6c 7920 6e6f 6e2d 6e65 6761  en only non-nega
+0000eff0: 7469 7665 2076 616c 7565 7320 6172 6520  tive values are 
+0000f000: 636f 6e73 6964 6572 6564 0d0a 2020 2020  considered..    
+0000f010: 2020 2020 652e 672e 2c20 3c30 2e35 2077      e.g., <0.5 w
+0000f020: 6f75 6c64 2062 6520 636f 6e76 6572 7465  ould be converte
+0000f030: 6420 746f 205b 302c 3529 2e0d 0a20 2020  d to [0,5)...   
+0000f040: 2020 2020 2054 6869 7320 7365 7474 696e       This settin
+0000f050: 6720 6f6e 6c79 2061 6666 6563 7473 2072  g only affects r
+0000f060: 6573 756c 7473 2069 6620 666f 6375 735f  esults if focus_
+0000f070: 6869 6768 5f70 6f74 656e 7469 616c 2069  high_potential i
+0000f080: 7320 4661 6c73 652e 0d0a 2020 2020 2020  s False...      
+0000f090: 2020 5468 6520 6465 6661 756c 7420 6973    The default is
+0000f0a0: 2046 616c 7365 2e0d 0a20 2020 2070 7265   False...    pre
+0000f0b0: 6369 7369 6f6e 5f74 6f6c 6572 616e 6365  cision_tolerance
+0000f0c0: 5f74 6f5f 6472 6f70 5f63 656e 736f 7220  _to_drop_censor 
+0000f0d0: 3a20 666c 6f61 742c 206f 7074 696f 6e61  : float, optiona
+0000f0e0: 6c0d 0a20 2020 2020 2020 2054 6872 6573  l..        Thres
+0000f0f0: 686f 6c64 2066 6f72 2072 6570 6f72 7469  hold for reporti
+0000f100: 6e67 2063 656e 736f 7265 6420 7673 206e  ng censored vs n
+0000f110: 6f6e 2d63 656e 736f 7265 6420 7265 7375  on-censored resu
+0000f120: 6c74 732e 0d0a 2020 2020 2020 2020 5573  lts...        Us
+0000f130: 696e 6720 7468 6520 6465 6661 756c 742c  ing the default,
+0000f140: 2061 2072 6573 756c 7420 7468 6174 2069   a result that i
+0000f150: 7320 6b6e 6f77 6e20 746f 2062 6520 696e  s known to be in
+0000f160: 2074 6865 2069 6e74 6572 7661 6c20 2830   the interval (0
+0000f170: 2e33 2c20 302e 3529 0d0a 2020 2020 2020  .3, 0.5)..      
+0000f180: 2020 776f 756c 6420 6265 2072 6574 7572    would be retur
+0000f190: 6e65 6420 6173 2030 2e34 2c20 7768 6572  ned as 0.4, wher
+0000f1a0: 6561 7320 6120 746f 6c65 7261 6e63 6520  eas a tolerance 
+0000f1b0: 6f66 2030 2077 6f75 6c64 2079 6965 6c64  of 0 would yield
+0000f1c0: 2061 0d0a 2020 2020 2020 2020 7265 7375   a..        resu
+0000f1d0: 6c74 206f 6620 3c30 2e35 206f 7220 3e30  lt of <0.5 or >0
+0000f1e0: 2e33 2064 6570 656e 6469 6e67 206f 6e20  .3 depending on 
+0000f1f0: 7468 6520 7661 6c75 6520 6f66 2066 6f63  the value of foc
+0000f200: 7573 5f68 6967 6865 7374 5f70 6f74 656e  us_highest_poten
+0000f210: 7469 616c 2e0d 0a20 2020 2020 2020 2054  tial...        T
+0000f220: 6865 2064 6566 6175 6c74 2069 7320 302e  he default is 0.
+0000f230: 3235 2e0d 0a20 2020 2070 7265 6369 7369  25...    precisi
+0000f240: 6f6e 5f72 6f75 6e64 696e 6720 3a20 626f  on_rounding : bo
+0000f250: 6f6c 6561 6e2c 206f 7074 696f 6e61 6c0d  olean, optional.
+0000f260: 0a20 2020 2020 2020 2049 6620 5472 7565  .        If True
+0000f270: 2c20 6120 726f 756e 6469 6e67 206d 6574  , a rounding met
+0000f280: 686f 6420 6973 2061 7070 6c69 6564 2074  hod is applied t
+0000f290: 6f20 726f 756e 6420 7265 7375 6c74 7320  o round results 
+0000f2a0: 746f 2068 6176 6520 6e6f 206d 6f72 650d  to have no more.
+0000f2b0: 0a20 2020 2020 2020 2064 6563 696d 616c  .        decimal
+0000f2c0: 7320 7468 616e 2077 6861 7420 6361 6e20  s than what can 
+0000f2d0: 6265 206d 6561 7375 7265 642e 0d0a 2020  be measured...  
+0000f2e0: 2020 2020 2020 5468 6520 6465 6661 756c        The defaul
+0000f2f0: 7420 6973 2054 7275 652e 0d0a 0d0a 2020  t is True.....  
+0000f300: 2020 5265 7475 726e 730d 0a20 2020 202d    Returns..    -
+0000f310: 2d2d 2d2d 2d2d 0d0a 2020 2020 6466 203a  ------..    df :
+0000f320: 2044 6174 6146 7261 6d65 0d0a 2020 2020   DataFrame..    
+0000f330: 2020 2020 4461 7461 4672 616d 6520 7468      DataFrame th
+0000f340: 6174 2063 6f6e 7461 696e 7320 6361 6c63  at contains calc
+0000f350: 756c 6174 6564 2061 7665 7261 6765 730d  ulated averages.
+0000f360: 0a0d 0a20 2020 2027 2727 0d0a 2020 2020  ...    '''..    
+0000f370: 0d0a 2020 2020 2320 4372 6561 7465 2061  ..    # Create a
+0000f380: 2063 6f70 7920 6f66 2074 6865 2044 6174   copy of the Dat
+0000f390: 6146 7261 6d65 0d0a 2020 2020 6466 203d  aFrame..    df =
+0000f3a0: 2064 662e 636f 7079 2829 0d0a 2020 2020   df.copy()..    
+0000f3b0: 0d0a 2020 2020 2320 5370 6c69 7420 7468  ..    # Split th
+0000f3c0: 6520 7265 7375 6c74 2069 6e74 6f20 6365  e result into ce
+0000f3d0: 6e73 6f72 2061 6e64 206e 756d 6572 6963  nsor and numeric
+0000f3e0: 2063 6f6d 706f 6e65 6e74 730d 0a20 2020   components..   
+0000f3f0: 2064 6620 3d20 7265 7375 6c74 5f74 6f5f   df = result_to_
+0000f400: 636f 6d70 6f6e 656e 7473 2864 662c 7265  components(df,re
+0000f410: 7375 6c74 735f 636f 6c29 0d0a 2020 2020  sults_col)..    
+0000f420: 0d0a 2020 2020 2320 436f 6e76 6572 7420  ..    # Convert 
+0000f430: 7468 6520 7265 7375 6c74 7320 6672 6f6d  the results from
+0000f440: 2063 656e 736f 7220 616e 6420 6e75 6d65   censor and nume
+0000f450: 7269 6320 636f 6d70 6f6e 656e 7473 2074  ric components t
+0000f460: 6f20 616e 2069 6e74 6572 7661 6c20 7265  o an interval re
+0000f470: 7072 6573 656e 7461 7469 6f6e 0d0a 2020  presentation..  
+0000f480: 2020 6466 203d 2063 6f6d 706f 6e65 6e74    df = component
+0000f490: 735f 746f 5f69 6e74 6572 7661 6c28 6466  s_to_interval(df
+0000f4a0: 2c20 696e 636c 7564 655f 6e65 6761 7469  , include_negati
+0000f4b0: 7665 5f69 6e74 6572 7661 6c29 0d0a 2020  ve_interval)..  
+0000f4c0: 2020 0d0a 2020 2020 2320 5573 696e 6720    ..    # Using 
+0000f4d0: 7468 6520 696e 7465 7276 616c 732c 2064  the intervals, d
+0000f4e0: 6574 6572 6d69 6e65 2074 6865 2072 616e  etermine the ran
+0000f4f0: 6765 206f 6620 706f 7373 6962 6c65 2061  ge of possible a
+0000f500: 7665 7261 6765 730d 0a20 2020 200d 0a20  verages..    .. 
+0000f510: 2020 2023 2049 6620 7468 6572 6520 6172     # If there ar
+0000f520: 6520 6e6f 2067 726f 7570 6279 2d63 6f6c  e no groupby-col
+0000f530: 756d 6e73 2c20 7468 656e 2074 616b 6520  umns, then take 
+0000f540: 6176 6572 6167 6520 6f66 2061 6c6c 2072  average of all r
+0000f550: 6573 756c 7473 0d0a 2020 2020 6966 206e  esults..    if n
+0000f560: 6f74 2067 726f 7570 6279 5f63 6f6c 733a  ot groupby_cols:
+0000f570: 0d0a 2020 2020 2020 2020 6466 203d 2061  ..        df = a
+0000f580: 6464 5f69 6e74 6572 7661 6c73 2864 662c  dd_intervals(df,
+0000f590: 2067 726f 7570 6279 5f63 6f6c 733d 5b5d   groupby_cols=[]
+0000f5a0: 290d 0a20 2020 2023 2049 6620 7468 6520  )..    # If the 
+0000f5b0: 6772 6f75 7062 795f 636f 6c73 2069 7320  groupby_cols is 
+0000f5c0: 6120 6c69 7374 206f 6620 6c69 7374 732c  a list of lists,
+0000f5d0: 2074 6865 6e20 7065 7266 6f72 6d20 6d75   then perform mu
+0000f5e0: 6c74 6970 6c65 2061 7665 7261 6765 730d  ltiple averages.
+0000f5f0: 0a20 2020 2065 6c69 6620 6973 696e 7374  .    elif isinst
+0000f600: 616e 6365 2867 726f 7570 6279 5f63 6f6c  ance(groupby_col
+0000f610: 735b 305d 2c6c 6973 7429 3a0d 0a20 2020  s[0],list):..   
+0000f620: 2020 2020 2066 6f72 2067 726f 7570 696e       for groupin
+0000f630: 6720 696e 2067 726f 7570 6279 5f63 6f6c  g in groupby_col
+0000f640: 733a 0d0a 2020 2020 2020 2020 2020 2020  s:..            
+0000f650: 2320 5573 696e 6720 7468 6520 696e 7465  # Using the inte
+0000f660: 7276 616c 732c 2064 6574 6572 6d69 6e65  rvals, determine
+0000f670: 2074 6865 2072 616e 6765 206f 6620 706f   the range of po
+0000f680: 7373 6962 6c65 206d 6178 696d 610d 0a20  ssible maxima.. 
+0000f690: 2020 2020 2020 2020 2020 2064 6620 3d20             df = 
+0000f6a0: 6164 645f 696e 7465 7276 616c 7328 6466  add_intervals(df
+0000f6b0: 2c20 6772 6f75 7069 6e67 290d 0a20 2020  , grouping)..   
+0000f6c0: 2023 2045 6c73 6520 7468 6520 6772 6f75   # Else the grou
+0000f6d0: 7062 795f 636f 6c73 2069 7320 6120 6c69  pby_cols is a li
+0000f6e0: 7374 206f 6620 636f 6c75 6d6e 206e 616d  st of column nam
+0000f6f0: 6573 0d0a 2020 2020 656c 7365 3a0d 0a20  es..    else:.. 
+0000f700: 2020 2020 2020 2064 6620 3d20 6164 645f         df = add_
+0000f710: 696e 7465 7276 616c 7328 6466 2c20 6772  intervals(df, gr
+0000f720: 6f75 7062 795f 636f 6c73 290d 0a20 2020  oupby_cols)..   
+0000f730: 200d 0a20 2020 2023 2043 6f6e 7665 7274   ..    # Convert
+0000f740: 2074 6865 2069 6e74 6572 7661 6c20 666f   the interval fo
+0000f750: 7220 7468 6520 6176 6572 6167 6520 696e  r the average in
+0000f760: 746f 2063 656e 736f 7220 616e 6420 6e75  to censor and nu
+0000f770: 6d65 7269 6320 6e6f 7461 7469 6f6e 0d0a  meric notation..
+0000f780: 2020 2020 6466 203d 2069 6e74 6572 7661      df = interva
+0000f790: 6c5f 746f 5f63 6f6d 706f 6e65 6e74 7328  l_to_components(
+0000f7a0: 6466 2c0d 0a20 2020 2020 2020 2020 2020  df,..           
+0000f7b0: 2020 2020 2020 2020 2020 2020 2020 2020                  
+0000f7c0: 2020 2020 2066 6f63 7573 5f68 6967 685f       focus_high_
+0000f7d0: 706f 7465 6e74 6961 6c20 3d20 666f 6375  potential = focu
+0000f7e0: 735f 6869 6768 5f70 6f74 656e 7469 616c  s_high_potential
+0000f7f0: 2c0d 0a20 2020 2020 2020 2020 2020 2020  ,..             
+0000f800: 2020 2020 2020 2020 2020 2020 2020 2020                  
+0000f810: 2020 2069 6e63 6c75 6465 5f6e 6567 6174     include_negat
+0000f820: 6976 655f 696e 7465 7276 616c 203d 2069  ive_interval = i
+0000f830: 6e63 6c75 6465 5f6e 6567 6174 6976 655f  nclude_negative_
+0000f840: 696e 7465 7276 616c 2c0d 0a20 2020 2020  interval,..     
+0000f850: 2020 2020 2020 2020 2020 2020 2020 2020                  
+0000f860: 2020 2020 2020 2020 2020 2070 7265 6369             preci
+0000f870: 7369 6f6e 5f74 6f6c 6572 616e 6365 5f74  sion_tolerance_t
+0000f880: 6f5f 6472 6f70 5f63 656e 736f 7220 3d20  o_drop_censor = 
+0000f890: 7072 6563 6973 696f 6e5f 746f 6c65 7261  precision_tolera
+0000f8a0: 6e63 655f 746f 5f64 726f 705f 6365 6e73  nce_to_drop_cens
+0000f8b0: 6f72 290d 0a20 2020 200d 0a20 2020 2023  or)..    ..    #
+0000f8c0: 2043 7265 6174 6520 696e 7465 7276 616c   Create interval
+0000f8d0: 206e 6f74 6174 696f 6e20 666f 7220 7468   notation for th
+0000f8e0: 6520 6176 6572 6167 650d 0a20 2020 2064  e average..    d
+0000f8f0: 6620 3d20 696e 7465 7276 616c 5f6e 6f74  f = interval_not
+0000f900: 6174 696f 6e28 6466 2c20 7072 6563 6973  ation(df, precis
+0000f910: 696f 6e5f 726f 756e 6469 6e67 290d 0a20  ion_rounding).. 
+0000f920: 2020 200d 0a20 2020 2023 2043 6f6d 6269     ..    # Combi
+0000f930: 6e65 2074 6865 2063 656e 736f 7220 616e  ne the censor an
+0000f940: 6420 6e75 6d65 7269 6320 636f 6d70 6f6e  d numeric compon
+0000f950: 656e 7473 2069 6e74 6f20 6120 7265 7375  ents into a resu
+0000f960: 6c74 0d0a 2020 2020 6466 203d 2063 6f6d  lt..    df = com
+0000f970: 706f 6e65 6e74 735f 746f 5f72 6573 756c  ponents_to_resul
+0000f980: 7428 6466 2c20 7072 6563 6973 696f 6e5f  t(df, precision_
+0000f990: 726f 756e 6469 6e67 290d 0a20 2020 200d  rounding)..    .
+0000f9a0: 0a20 2020 2023 2044 726f 7020 776f 726b  .    # Drop work
+0000f9b0: 696e 6720 636f 6c75 6d6e 730d 0a20 2020  ing columns..   
+0000f9c0: 2064 6620 3d20 6466 2e64 726f 7028 6466   df = df.drop(df
+0000f9d0: 2e66 696c 7465 7228 7265 6765 783d 275f  .filter(regex='_
+0000f9e0: 5f27 292e 636f 6c75 6d6e 732c 2061 7869  _').columns, axi
+0000f9f0: 733d 3129 0d0a 2020 2020 0d0a 2020 2020  s=1)..    ..    
+0000fa00: 2320 5265 6f72 6465 7220 636f 6c75 6d6e  # Reorder column
+0000fa10: 730d 0a20 2020 2066 6f72 2063 6f6c 2069  s..    for col i
+0000fa20: 6e20 5b73 7461 745f 636f 6c2c 7265 7375  n [stat_col,resu
+0000fa30: 6c74 5f63 6f6c 2c63 656e 736f 725f 636f  lt_col,censor_co
+0000fa40: 6c2c 6e75 6d65 7269 635f 636f 6c2c 696e  l,numeric_col,in
+0000fa50: 7465 7276 616c 5f63 6f6c 5d3a 0d0a 2020  terval_col]:..  
+0000fa60: 2020 2020 2020 6466 5b63 6f6c 5d20 3d20        df[col] = 
+0000fa70: 6466 2e70 6f70 2863 6f6c 290d 0a20 2020  df.pop(col)..   
+0000fa80: 200d 0a20 2020 2072 6574 7572 6e20 6466   ..    return df
+0000fa90: 0d0a                                     ..
```

### Comparing `censoredsummarystats-0.0.4/censoredsummarystats/utils.py` & `censoredsummarystats-0.0.5/censoredsummarystats/utils.py`

 * *Files identical despite different names*

### Comparing `censoredsummarystats-0.0.4/LICENSE` & `censoredsummarystats-0.0.5/LICENSE`

 * *Files identical despite different names*

### Comparing `censoredsummarystats-0.0.4/pyproject.toml` & `censoredsummarystats-0.0.5/pyproject.toml`

 * *Files 2% similar despite different names*

```diff
@@ -1,10 +1,10 @@
 [tool.poetry]
 name = "censoredsummarystats"
-version = "0.0.4"
+version = "0.0.5"
 description = "A python package for calculating summary stats on censored data (data that contains < and > symbols)."
 authors = ["Kurt van Ness <vanness.kurt@gmail.com>"]
 readme = "README.md"
 repository = "https://github.com/kurtvanness/CensoredSummaryStats"
 license = "Apache-2.0"
 packages = [{include = "censoredsummarystats"}]
```

### Comparing `censoredsummarystats-0.0.4/README.md` & `censoredsummarystats-0.0.5/README.md`

 * *Files identical despite different names*

### Comparing `censoredsummarystats-0.0.4/PKG-INFO` & `censoredsummarystats-0.0.5/PKG-INFO`

 * *Files 0% similar despite different names*

```diff
@@ -1,10 +1,10 @@
 Metadata-Version: 2.1
 Name: censoredsummarystats
-Version: 0.0.4
+Version: 0.0.5
 Summary: A python package for calculating summary stats on censored data (data that contains < and > symbols).
 Home-page: https://github.com/kurtvanness/CensoredSummaryStats
 License: Apache-2.0
 Author: Kurt van Ness
 Author-email: vanness.kurt@gmail.com
 Requires-Python: >=3.9,<4.0
 Classifier: License :: OSI Approved :: Apache Software License
```

