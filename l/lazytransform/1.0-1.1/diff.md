# Comparing `tmp/lazytransform-1.0.tar.gz` & `tmp/lazytransform-1.1.tar.gz`

## filetype from file(1)

```diff
@@ -1 +1 @@
-gzip compressed data, was "lazytransform-1.0.tar", last modified: Tue Sep 27 12:37:54 2022, max compression
+gzip compressed data, was "lazytransform-1.1.tar", last modified: Wed May 17 01:54:33 2023, max compression
```

## Comparing `lazytransform-1.0.tar` & `lazytransform-1.1.tar`

 * *Command `'html2text {}'` failed with exit code 1. (No output)*

```diff
@@ -2,16 +2,16 @@
 00000010: 0000 0000 0000 0000 0000 0000 0000 0000  ................
 00000020: 0000 0000 0000 0000 0000 0000 0000 0000  ................
 00000030: 0000 0000 0000 0000 0000 0000 0000 0000  ................
 00000040: 0000 0000 0000 0000 0000 0000 0000 0000  ................
 00000050: 0000 0000 0000 0000 0000 0000 0000 0000  ................
 00000060: 0000 0000 3030 3030 3030 3000 3030 3030  ....0000000.0000
 00000070: 3030 3000 3030 3030 3030 3000 3030 3030  000.0000000.0000
-00000080: 3030 3030 3033 3300 3030 3030 3030 3030  0000033.00000000
-00000090: 3030 3000 3031 3134 3531 0020 7800 0000  000.011451. x...
+00000080: 3030 3030 3033 3400 3030 3030 3030 3030  0000034.00000000
+00000090: 3030 3000 3031 3134 3532 0020 7800 0000  000.011452. x...
 000000a0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
 000000b0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
 000000c0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
 000000d0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
 000000e0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
 000000f0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
 00000100: 0075 7374 6172 0030 3000 0000 0000 0000  .ustar.00.......
@@ -26,16 +26,16 @@
 00000190: 0000 0000 0000 0000 0000 0000 0000 0000  ................
 000001a0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
 000001b0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
 000001c0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
 000001d0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
 000001e0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
 000001f0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-00000200: 3237 206d 7469 6d65 3d31 3636 3432 3832  27 mtime=1664282
-00000210: 3237 342e 3333 3339 3133 0a00 0000 0000  274.333913......
+00000200: 3238 206d 7469 6d65 3d31 3638 3432 3838  28 mtime=1684288
+00000210: 3437 332e 3633 3036 3532 320a 0000 0000  473.6306522.....
 00000220: 0000 0000 0000 0000 0000 0000 0000 0000  ................
 00000230: 0000 0000 0000 0000 0000 0000 0000 0000  ................
 00000240: 0000 0000 0000 0000 0000 0000 0000 0000  ................
 00000250: 0000 0000 0000 0000 0000 0000 0000 0000  ................
 00000260: 0000 0000 0000 0000 0000 0000 0000 0000  ................
 00000270: 0000 0000 0000 0000 0000 0000 0000 0000  ................
 00000280: 0000 0000 0000 0000 0000 0000 0000 0000  ................
@@ -59,23 +59,23 @@
 000003a0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
 000003b0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
 000003c0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
 000003d0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
 000003e0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
 000003f0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
 00000400: 6c61 7a79 7472 616e 7366 6f72 6d2d 312e  lazytransform-1.
-00000410: 302f 0000 0000 0000 0000 0000 0000 0000  0/..............
+00000410: 312f 0000 0000 0000 0000 0000 0000 0000  1/..............
 00000420: 0000 0000 0000 0000 0000 0000 0000 0000  ................
 00000430: 0000 0000 0000 0000 0000 0000 0000 0000  ................
 00000440: 0000 0000 0000 0000 0000 0000 0000 0000  ................
 00000450: 0000 0000 0000 0000 0000 0000 0000 0000  ................
 00000460: 0000 0000 3030 3030 3737 3700 3030 3031  ....0000777.0001
 00000470: 3735 3000 3030 3031 3735 3000 3030 3030  750.0001750.0000
 00000480: 3030 3030 3030 3000 3030 3030 3030 3030  0000000.00000000
-00000490: 3030 3000 3031 3336 3532 0020 3500 0000  000.013652. 5...
+00000490: 3030 3000 3031 3336 3533 0020 3500 0000  000.013653. 5...
 000004a0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
 000004b0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
 000004c0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
 000004d0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
 000004e0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
 000004f0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
 00000500: 0075 7374 6172 0030 3072 616d 0000 0000  .ustar.00ram....
@@ -98,16 +98,16 @@
 00000610: 0000 0000 0000 0000 0000 0000 0000 0000  ................
 00000620: 0000 0000 0000 0000 0000 0000 0000 0000  ................
 00000630: 0000 0000 0000 0000 0000 0000 0000 0000  ................
 00000640: 0000 0000 0000 0000 0000 0000 0000 0000  ................
 00000650: 0000 0000 0000 0000 0000 0000 0000 0000  ................
 00000660: 0000 0000 3030 3030 3030 3000 3030 3030  ....0000000.0000
 00000670: 3030 3000 3030 3030 3030 3000 3030 3030  000.0000000.0000
-00000680: 3030 3030 3032 3600 3030 3030 3030 3030  0000026.00000000
-00000690: 3030 3000 3031 3134 3533 0020 7800 0000  000.011453. x...
+00000680: 3030 3030 3033 3400 3030 3030 3030 3030  0000034.00000000
+00000690: 3030 3000 3031 3134 3532 0020 7800 0000  000.011452. x...
 000006a0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
 000006b0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
 000006c0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
 000006d0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
 000006e0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
 000006f0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
 00000700: 0075 7374 6172 0030 3000 0000 0000 0000  .ustar.00.......
@@ -122,16 +122,16 @@
 00000790: 0000 0000 0000 0000 0000 0000 0000 0000  ................
 000007a0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
 000007b0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
 000007c0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
 000007d0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
 000007e0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
 000007f0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-00000800: 3232 206d 7469 6d65 3d31 3634 3839 3836  22 mtime=1648986
-00000810: 3137 392e 300a 0000 0000 0000 0000 0000  179.0...........
+00000800: 3238 206d 7469 6d65 3d31 3638 3432 3838  28 mtime=1684288
+00000810: 3437 332e 3633 3036 3532 320a 0000 0000  473.6306522.....
 00000820: 0000 0000 0000 0000 0000 0000 0000 0000  ................
 00000830: 0000 0000 0000 0000 0000 0000 0000 0000  ................
 00000840: 0000 0000 0000 0000 0000 0000 0000 0000  ................
 00000850: 0000 0000 0000 0000 0000 0000 0000 0000  ................
 00000860: 0000 0000 0000 0000 0000 0000 0000 0000  ................
 00000870: 0000 0000 0000 0000 0000 0000 0000 0000  ................
 00000880: 0000 0000 0000 0000 0000 0000 0000 0000  ................
@@ -155,23 +155,23 @@
 000009a0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
 000009b0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
 000009c0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
 000009d0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
 000009e0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
 000009f0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
 00000a00: 6c61 7a79 7472 616e 7366 6f72 6d2d 312e  lazytransform-1.
-00000a10: 302f 4c49 4345 4e53 4500 0000 0000 0000  0/LICENSE.......
+00000a10: 312f 504b 472d 494e 464f 0000 0000 0000  1/PKG-INFO......
 00000a20: 0000 0000 0000 0000 0000 0000 0000 0000  ................
 00000a30: 0000 0000 0000 0000 0000 0000 0000 0000  ................
 00000a40: 0000 0000 0000 0000 0000 0000 0000 0000  ................
 00000a50: 0000 0000 0000 0000 0000 0000 0000 0000  ................
 00000a60: 0000 0000 3030 3030 3737 3700 3030 3031  ....0000777.0001
 00000a70: 3735 3000 3030 3031 3735 3000 3030 3030  750.0001750.0000
-00000a80: 3030 3236 3133 3500 3030 3030 3030 3030  0026135.00000000
-00000a90: 3030 3000 3031 3436 3731 0020 3000 0000  000.014671. 0...
+00000a80: 3030 3436 3330 3400 3030 3030 3030 3030  0046304.00000000
+00000a90: 3030 3000 3031 3437 3632 0020 3000 0000  000.014762. 0...
 00000aa0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
 00000ab0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
 00000ac0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
 00000ad0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
 00000ae0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
 00000af0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
 00000b00: 0075 7374 6172 0030 3072 616d 0000 0000  .ustar.00ram....
@@ -186,20295 +186,19015 @@
 00000b90: 0000 0000 0000 0000 0000 0000 0000 0000  ................
 00000ba0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
 00000bb0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
 00000bc0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
 00000bd0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
 00000be0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
 00000bf0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-00000c00: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00000c10: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00000c20: 2041 7061 6368 6520 4c69 6365 6e73 650a   Apache License.
-00000c30: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00000c40: 2020 2020 2020 2020 2020 2056 6572 7369             Versi
-00000c50: 6f6e 2032 2e30 2c20 4a61 6e75 6172 7920  on 2.0, January 
-00000c60: 3230 3034 0a20 2020 2020 2020 2020 2020  2004.           
-00000c70: 2020 2020 2020 2020 2020 2020 2068 7474               htt
-00000c80: 703a 2f2f 7777 772e 6170 6163 6865 2e6f  p://www.apache.o
-00000c90: 7267 2f6c 6963 656e 7365 732f 0a0a 2020  rg/licenses/..  
-00000ca0: 2054 4552 4d53 2041 4e44 2043 4f4e 4449   TERMS AND CONDI
-00000cb0: 5449 4f4e 5320 464f 5220 5553 452c 2052  TIONS FOR USE, R
-00000cc0: 4550 524f 4455 4354 494f 4e2c 2041 4e44  EPRODUCTION, AND
-00000cd0: 2044 4953 5452 4942 5554 494f 4e0a 0a20   DISTRIBUTION.. 
-00000ce0: 2020 312e 2044 6566 696e 6974 696f 6e73    1. Definitions
-00000cf0: 2e0a 0a20 2020 2020 2022 4c69 6365 6e73  ...      "Licens
-00000d00: 6522 2073 6861 6c6c 206d 6561 6e20 7468  e" shall mean th
-00000d10: 6520 7465 726d 7320 616e 6420 636f 6e64  e terms and cond
-00000d20: 6974 696f 6e73 2066 6f72 2075 7365 2c20  itions for use, 
-00000d30: 7265 7072 6f64 7563 7469 6f6e 2c0a 2020  reproduction,.  
-00000d40: 2020 2020 616e 6420 6469 7374 7269 6275      and distribu
-00000d50: 7469 6f6e 2061 7320 6465 6669 6e65 6420  tion as defined 
-00000d60: 6279 2053 6563 7469 6f6e 7320 3120 7468  by Sections 1 th
-00000d70: 726f 7567 6820 3920 6f66 2074 6869 7320  rough 9 of this 
-00000d80: 646f 6375 6d65 6e74 2e0a 0a20 2020 2020  document...     
-00000d90: 2022 4c69 6365 6e73 6f72 2220 7368 616c   "Licensor" shal
-00000da0: 6c20 6d65 616e 2074 6865 2063 6f70 7972  l mean the copyr
-00000db0: 6967 6874 206f 776e 6572 206f 7220 656e  ight owner or en
-00000dc0: 7469 7479 2061 7574 686f 7269 7a65 6420  tity authorized 
-00000dd0: 6279 0a20 2020 2020 2074 6865 2063 6f70  by.      the cop
-00000de0: 7972 6967 6874 206f 776e 6572 2074 6861  yright owner tha
-00000df0: 7420 6973 2067 7261 6e74 696e 6720 7468  t is granting th
-00000e00: 6520 4c69 6365 6e73 652e 0a0a 2020 2020  e License...    
-00000e10: 2020 224c 6567 616c 2045 6e74 6974 7922    "Legal Entity"
-00000e20: 2073 6861 6c6c 206d 6561 6e20 7468 6520   shall mean the 
-00000e30: 756e 696f 6e20 6f66 2074 6865 2061 6374  union of the act
-00000e40: 696e 6720 656e 7469 7479 2061 6e64 2061  ing entity and a
-00000e50: 6c6c 0a20 2020 2020 206f 7468 6572 2065  ll.      other e
-00000e60: 6e74 6974 6965 7320 7468 6174 2063 6f6e  ntities that con
-00000e70: 7472 6f6c 2c20 6172 6520 636f 6e74 726f  trol, are contro
-00000e80: 6c6c 6564 2062 792c 206f 7220 6172 6520  lled by, or are 
-00000e90: 756e 6465 7220 636f 6d6d 6f6e 0a20 2020  under common.   
-00000ea0: 2020 2063 6f6e 7472 6f6c 2077 6974 6820     control with 
-00000eb0: 7468 6174 2065 6e74 6974 792e 2046 6f72  that entity. For
-00000ec0: 2074 6865 2070 7572 706f 7365 7320 6f66   the purposes of
-00000ed0: 2074 6869 7320 6465 6669 6e69 7469 6f6e   this definition
-00000ee0: 2c0a 2020 2020 2020 2263 6f6e 7472 6f6c  ,.      "control
-00000ef0: 2220 6d65 616e 7320 2869 2920 7468 6520  " means (i) the 
-00000f00: 706f 7765 722c 2064 6972 6563 7420 6f72  power, direct or
-00000f10: 2069 6e64 6972 6563 742c 2074 6f20 6361   indirect, to ca
-00000f20: 7573 6520 7468 650a 2020 2020 2020 6469  use the.      di
-00000f30: 7265 6374 696f 6e20 6f72 206d 616e 6167  rection or manag
-00000f40: 656d 656e 7420 6f66 2073 7563 6820 656e  ement of such en
-00000f50: 7469 7479 2c20 7768 6574 6865 7220 6279  tity, whether by
-00000f60: 2063 6f6e 7472 6163 7420 6f72 0a20 2020   contract or.   
-00000f70: 2020 206f 7468 6572 7769 7365 2c20 6f72     otherwise, or
-00000f80: 2028 6969 2920 6f77 6e65 7273 6869 7020   (ii) ownership 
-00000f90: 6f66 2066 6966 7479 2070 6572 6365 6e74  of fifty percent
-00000fa0: 2028 3530 2529 206f 7220 6d6f 7265 206f   (50%) or more o
-00000fb0: 6620 7468 650a 2020 2020 2020 6f75 7473  f the.      outs
-00000fc0: 7461 6e64 696e 6720 7368 6172 6573 2c20  tanding shares, 
-00000fd0: 6f72 2028 6969 6929 2062 656e 6566 6963  or (iii) benefic
-00000fe0: 6961 6c20 6f77 6e65 7273 6869 7020 6f66  ial ownership of
-00000ff0: 2073 7563 6820 656e 7469 7479 2e0a 0a20   such entity... 
-00001000: 2020 2020 2022 596f 7522 2028 6f72 2022       "You" (or "
-00001010: 596f 7572 2229 2073 6861 6c6c 206d 6561  Your") shall mea
-00001020: 6e20 616e 2069 6e64 6976 6964 7561 6c20  n an individual 
-00001030: 6f72 204c 6567 616c 2045 6e74 6974 790a  or Legal Entity.
-00001040: 2020 2020 2020 6578 6572 6369 7369 6e67        exercising
-00001050: 2070 6572 6d69 7373 696f 6e73 2067 7261   permissions gra
-00001060: 6e74 6564 2062 7920 7468 6973 204c 6963  nted by this Lic
-00001070: 656e 7365 2e0a 0a20 2020 2020 2022 536f  ense...      "So
-00001080: 7572 6365 2220 666f 726d 2073 6861 6c6c  urce" form shall
-00001090: 206d 6561 6e20 7468 6520 7072 6566 6572   mean the prefer
-000010a0: 7265 6420 666f 726d 2066 6f72 206d 616b  red form for mak
-000010b0: 696e 6720 6d6f 6469 6669 6361 7469 6f6e  ing modification
-000010c0: 732c 0a20 2020 2020 2069 6e63 6c75 6469  s,.      includi
-000010d0: 6e67 2062 7574 206e 6f74 206c 696d 6974  ng but not limit
-000010e0: 6564 2074 6f20 736f 6674 7761 7265 2073  ed to software s
-000010f0: 6f75 7263 6520 636f 6465 2c20 646f 6375  ource code, docu
-00001100: 6d65 6e74 6174 696f 6e0a 2020 2020 2020  mentation.      
-00001110: 736f 7572 6365 2c20 616e 6420 636f 6e66  source, and conf
-00001120: 6967 7572 6174 696f 6e20 6669 6c65 732e  iguration files.
-00001130: 0a0a 2020 2020 2020 224f 626a 6563 7422  ..      "Object"
-00001140: 2066 6f72 6d20 7368 616c 6c20 6d65 616e   form shall mean
-00001150: 2061 6e79 2066 6f72 6d20 7265 7375 6c74   any form result
-00001160: 696e 6720 6672 6f6d 206d 6563 6861 6e69  ing from mechani
-00001170: 6361 6c0a 2020 2020 2020 7472 616e 7366  cal.      transf
-00001180: 6f72 6d61 7469 6f6e 206f 7220 7472 616e  ormation or tran
-00001190: 736c 6174 696f 6e20 6f66 2061 2053 6f75  slation of a Sou
-000011a0: 7263 6520 666f 726d 2c20 696e 636c 7564  rce form, includ
-000011b0: 696e 6720 6275 740a 2020 2020 2020 6e6f  ing but.      no
-000011c0: 7420 6c69 6d69 7465 6420 746f 2063 6f6d  t limited to com
-000011d0: 7069 6c65 6420 6f62 6a65 6374 2063 6f64  piled object cod
-000011e0: 652c 2067 656e 6572 6174 6564 2064 6f63  e, generated doc
-000011f0: 756d 656e 7461 7469 6f6e 2c0a 2020 2020  umentation,.    
-00001200: 2020 616e 6420 636f 6e76 6572 7369 6f6e    and conversion
-00001210: 7320 746f 206f 7468 6572 206d 6564 6961  s to other media
-00001220: 2074 7970 6573 2e0a 0a20 2020 2020 2022   types...      "
-00001230: 576f 726b 2220 7368 616c 6c20 6d65 616e  Work" shall mean
-00001240: 2074 6865 2077 6f72 6b20 6f66 2061 7574   the work of aut
-00001250: 686f 7273 6869 702c 2077 6865 7468 6572  horship, whether
-00001260: 2069 6e20 536f 7572 6365 206f 720a 2020   in Source or.  
-00001270: 2020 2020 4f62 6a65 6374 2066 6f72 6d2c      Object form,
-00001280: 206d 6164 6520 6176 6169 6c61 626c 6520   made available 
-00001290: 756e 6465 7220 7468 6520 4c69 6365 6e73  under the Licens
-000012a0: 652c 2061 7320 696e 6469 6361 7465 6420  e, as indicated 
-000012b0: 6279 2061 0a20 2020 2020 2063 6f70 7972  by a.      copyr
-000012c0: 6967 6874 206e 6f74 6963 6520 7468 6174  ight notice that
-000012d0: 2069 7320 696e 636c 7564 6564 2069 6e20   is included in 
-000012e0: 6f72 2061 7474 6163 6865 6420 746f 2074  or attached to t
-000012f0: 6865 2077 6f72 6b0a 2020 2020 2020 2861  he work.      (a
-00001300: 6e20 6578 616d 706c 6520 6973 2070 726f  n example is pro
-00001310: 7669 6465 6420 696e 2074 6865 2041 7070  vided in the App
-00001320: 656e 6469 7820 6265 6c6f 7729 2e0a 0a20  endix below)... 
-00001330: 2020 2020 2022 4465 7269 7661 7469 7665       "Derivative
-00001340: 2057 6f72 6b73 2220 7368 616c 6c20 6d65   Works" shall me
-00001350: 616e 2061 6e79 2077 6f72 6b2c 2077 6865  an any work, whe
-00001360: 7468 6572 2069 6e20 536f 7572 6365 206f  ther in Source o
-00001370: 7220 4f62 6a65 6374 0a20 2020 2020 2066  r Object.      f
-00001380: 6f72 6d2c 2074 6861 7420 6973 2062 6173  orm, that is bas
-00001390: 6564 206f 6e20 286f 7220 6465 7269 7665  ed on (or derive
-000013a0: 6420 6672 6f6d 2920 7468 6520 576f 726b  d from) the Work
-000013b0: 2061 6e64 2066 6f72 2077 6869 6368 2074   and for which t
-000013c0: 6865 0a20 2020 2020 2065 6469 746f 7269  he.      editori
-000013d0: 616c 2072 6576 6973 696f 6e73 2c20 616e  al revisions, an
-000013e0: 6e6f 7461 7469 6f6e 732c 2065 6c61 626f  notations, elabo
-000013f0: 7261 7469 6f6e 732c 206f 7220 6f74 6865  rations, or othe
-00001400: 7220 6d6f 6469 6669 6361 7469 6f6e 730a  r modifications.
-00001410: 2020 2020 2020 7265 7072 6573 656e 742c        represent,
-00001420: 2061 7320 6120 7768 6f6c 652c 2061 6e20   as a whole, an 
-00001430: 6f72 6967 696e 616c 2077 6f72 6b20 6f66  original work of
-00001440: 2061 7574 686f 7273 6869 702e 2046 6f72   authorship. For
-00001450: 2074 6865 2070 7572 706f 7365 730a 2020   the purposes.  
-00001460: 2020 2020 6f66 2074 6869 7320 4c69 6365      of this Lice
-00001470: 6e73 652c 2044 6572 6976 6174 6976 6520  nse, Derivative 
-00001480: 576f 726b 7320 7368 616c 6c20 6e6f 7420  Works shall not 
-00001490: 696e 636c 7564 6520 776f 726b 7320 7468  include works th
-000014a0: 6174 2072 656d 6169 6e0a 2020 2020 2020  at remain.      
-000014b0: 7365 7061 7261 626c 6520 6672 6f6d 2c20  separable from, 
-000014c0: 6f72 206d 6572 656c 7920 6c69 6e6b 2028  or merely link (
-000014d0: 6f72 2062 696e 6420 6279 206e 616d 6529  or bind by name)
-000014e0: 2074 6f20 7468 6520 696e 7465 7266 6163   to the interfac
-000014f0: 6573 206f 662c 0a20 2020 2020 2074 6865  es of,.      the
-00001500: 2057 6f72 6b20 616e 6420 4465 7269 7661   Work and Deriva
-00001510: 7469 7665 2057 6f72 6b73 2074 6865 7265  tive Works there
-00001520: 6f66 2e0a 0a20 2020 2020 2022 436f 6e74  of...      "Cont
-00001530: 7269 6275 7469 6f6e 2220 7368 616c 6c20  ribution" shall 
-00001540: 6d65 616e 2061 6e79 2077 6f72 6b20 6f66  mean any work of
-00001550: 2061 7574 686f 7273 6869 702c 2069 6e63   authorship, inc
-00001560: 6c75 6469 6e67 0a20 2020 2020 2074 6865  luding.      the
-00001570: 206f 7269 6769 6e61 6c20 7665 7273 696f   original versio
-00001580: 6e20 6f66 2074 6865 2057 6f72 6b20 616e  n of the Work an
-00001590: 6420 616e 7920 6d6f 6469 6669 6361 7469  d any modificati
-000015a0: 6f6e 7320 6f72 2061 6464 6974 696f 6e73  ons or additions
-000015b0: 0a20 2020 2020 2074 6f20 7468 6174 2057  .      to that W
-000015c0: 6f72 6b20 6f72 2044 6572 6976 6174 6976  ork or Derivativ
-000015d0: 6520 576f 726b 7320 7468 6572 656f 662c  e Works thereof,
-000015e0: 2074 6861 7420 6973 2069 6e74 656e 7469   that is intenti
-000015f0: 6f6e 616c 6c79 0a20 2020 2020 2073 7562  onally.      sub
-00001600: 6d69 7474 6564 2074 6f20 4c69 6365 6e73  mitted to Licens
-00001610: 6f72 2066 6f72 2069 6e63 6c75 7369 6f6e  or for inclusion
-00001620: 2069 6e20 7468 6520 576f 726b 2062 7920   in the Work by 
-00001630: 7468 6520 636f 7079 7269 6768 7420 6f77  the copyright ow
-00001640: 6e65 720a 2020 2020 2020 6f72 2062 7920  ner.      or by 
-00001650: 616e 2069 6e64 6976 6964 7561 6c20 6f72  an individual or
-00001660: 204c 6567 616c 2045 6e74 6974 7920 6175   Legal Entity au
-00001670: 7468 6f72 697a 6564 2074 6f20 7375 626d  thorized to subm
-00001680: 6974 206f 6e20 6265 6861 6c66 206f 660a  it on behalf of.
-00001690: 2020 2020 2020 7468 6520 636f 7079 7269        the copyri
-000016a0: 6768 7420 6f77 6e65 722e 2046 6f72 2074  ght owner. For t
-000016b0: 6865 2070 7572 706f 7365 7320 6f66 2074  he purposes of t
-000016c0: 6869 7320 6465 6669 6e69 7469 6f6e 2c20  his definition, 
-000016d0: 2273 7562 6d69 7474 6564 220a 2020 2020  "submitted".    
-000016e0: 2020 6d65 616e 7320 616e 7920 666f 726d    means any form
-000016f0: 206f 6620 656c 6563 7472 6f6e 6963 2c20   of electronic, 
-00001700: 7665 7262 616c 2c20 6f72 2077 7269 7474  verbal, or writt
-00001710: 656e 2063 6f6d 6d75 6e69 6361 7469 6f6e  en communication
-00001720: 2073 656e 740a 2020 2020 2020 746f 2074   sent.      to t
-00001730: 6865 204c 6963 656e 736f 7220 6f72 2069  he Licensor or i
-00001740: 7473 2072 6570 7265 7365 6e74 6174 6976  ts representativ
-00001750: 6573 2c20 696e 636c 7564 696e 6720 6275  es, including bu
-00001760: 7420 6e6f 7420 6c69 6d69 7465 6420 746f  t not limited to
-00001770: 0a20 2020 2020 2063 6f6d 6d75 6e69 6361  .      communica
-00001780: 7469 6f6e 206f 6e20 656c 6563 7472 6f6e  tion on electron
-00001790: 6963 206d 6169 6c69 6e67 206c 6973 7473  ic mailing lists
-000017a0: 2c20 736f 7572 6365 2063 6f64 6520 636f  , source code co
-000017b0: 6e74 726f 6c20 7379 7374 656d 732c 0a20  ntrol systems,. 
-000017c0: 2020 2020 2061 6e64 2069 7373 7565 2074       and issue t
-000017d0: 7261 636b 696e 6720 7379 7374 656d 7320  racking systems 
-000017e0: 7468 6174 2061 7265 206d 616e 6167 6564  that are managed
-000017f0: 2062 792c 206f 7220 6f6e 2062 6568 616c   by, or on behal
-00001800: 6620 6f66 2c20 7468 650a 2020 2020 2020  f of, the.      
-00001810: 4c69 6365 6e73 6f72 2066 6f72 2074 6865  Licensor for the
-00001820: 2070 7572 706f 7365 206f 6620 6469 7363   purpose of disc
-00001830: 7573 7369 6e67 2061 6e64 2069 6d70 726f  ussing and impro
-00001840: 7669 6e67 2074 6865 2057 6f72 6b2c 2062  ving the Work, b
-00001850: 7574 0a20 2020 2020 2065 7863 6c75 6469  ut.      excludi
-00001860: 6e67 2063 6f6d 6d75 6e69 6361 7469 6f6e  ng communication
-00001870: 2074 6861 7420 6973 2063 6f6e 7370 6963   that is conspic
-00001880: 756f 7573 6c79 206d 6172 6b65 6420 6f72  uously marked or
-00001890: 206f 7468 6572 7769 7365 0a20 2020 2020   otherwise.     
-000018a0: 2064 6573 6967 6e61 7465 6420 696e 2077   designated in w
-000018b0: 7269 7469 6e67 2062 7920 7468 6520 636f  riting by the co
-000018c0: 7079 7269 6768 7420 6f77 6e65 7220 6173  pyright owner as
-000018d0: 2022 4e6f 7420 6120 436f 6e74 7269 6275   "Not a Contribu
-000018e0: 7469 6f6e 2e22 0a0a 2020 2020 2020 2243  tion."..      "C
-000018f0: 6f6e 7472 6962 7574 6f72 2220 7368 616c  ontributor" shal
-00001900: 6c20 6d65 616e 204c 6963 656e 736f 7220  l mean Licensor 
-00001910: 616e 6420 616e 7920 696e 6469 7669 6475  and any individu
-00001920: 616c 206f 7220 4c65 6761 6c20 456e 7469  al or Legal Enti
-00001930: 7479 0a20 2020 2020 206f 6e20 6265 6861  ty.      on beha
-00001940: 6c66 206f 6620 7768 6f6d 2061 2043 6f6e  lf of whom a Con
-00001950: 7472 6962 7574 696f 6e20 6861 7320 6265  tribution has be
-00001960: 656e 2072 6563 6569 7665 6420 6279 204c  en received by L
-00001970: 6963 656e 736f 7220 616e 640a 2020 2020  icensor and.    
-00001980: 2020 7375 6273 6571 7565 6e74 6c79 2069    subsequently i
-00001990: 6e63 6f72 706f 7261 7465 6420 7769 7468  ncorporated with
-000019a0: 696e 2074 6865 2057 6f72 6b2e 0a0a 2020  in the Work...  
-000019b0: 2032 2e20 4772 616e 7420 6f66 2043 6f70   2. Grant of Cop
-000019c0: 7972 6967 6874 204c 6963 656e 7365 2e20  yright License. 
-000019d0: 5375 626a 6563 7420 746f 2074 6865 2074  Subject to the t
-000019e0: 6572 6d73 2061 6e64 2063 6f6e 6469 7469  erms and conditi
-000019f0: 6f6e 7320 6f66 0a20 2020 2020 2074 6869  ons of.      thi
-00001a00: 7320 4c69 6365 6e73 652c 2065 6163 6820  s License, each 
-00001a10: 436f 6e74 7269 6275 746f 7220 6865 7265  Contributor here
-00001a20: 6279 2067 7261 6e74 7320 746f 2059 6f75  by grants to You
-00001a30: 2061 2070 6572 7065 7475 616c 2c0a 2020   a perpetual,.  
-00001a40: 2020 2020 776f 726c 6477 6964 652c 206e      worldwide, n
-00001a50: 6f6e 2d65 7863 6c75 7369 7665 2c20 6e6f  on-exclusive, no
-00001a60: 2d63 6861 7267 652c 2072 6f79 616c 7479  -charge, royalty
-00001a70: 2d66 7265 652c 2069 7272 6576 6f63 6162  -free, irrevocab
-00001a80: 6c65 0a20 2020 2020 2063 6f70 7972 6967  le.      copyrig
-00001a90: 6874 206c 6963 656e 7365 2074 6f20 7265  ht license to re
-00001aa0: 7072 6f64 7563 652c 2070 7265 7061 7265  produce, prepare
-00001ab0: 2044 6572 6976 6174 6976 6520 576f 726b   Derivative Work
-00001ac0: 7320 6f66 2c0a 2020 2020 2020 7075 626c  s of,.      publ
-00001ad0: 6963 6c79 2064 6973 706c 6179 2c20 7075  icly display, pu
-00001ae0: 626c 6963 6c79 2070 6572 666f 726d 2c20  blicly perform, 
-00001af0: 7375 626c 6963 656e 7365 2c20 616e 6420  sublicense, and 
-00001b00: 6469 7374 7269 6275 7465 2074 6865 0a20  distribute the. 
-00001b10: 2020 2020 2057 6f72 6b20 616e 6420 7375       Work and su
-00001b20: 6368 2044 6572 6976 6174 6976 6520 576f  ch Derivative Wo
-00001b30: 726b 7320 696e 2053 6f75 7263 6520 6f72  rks in Source or
-00001b40: 204f 626a 6563 7420 666f 726d 2e0a 0a20   Object form... 
-00001b50: 2020 332e 2047 7261 6e74 206f 6620 5061    3. Grant of Pa
-00001b60: 7465 6e74 204c 6963 656e 7365 2e20 5375  tent License. Su
-00001b70: 626a 6563 7420 746f 2074 6865 2074 6572  bject to the ter
-00001b80: 6d73 2061 6e64 2063 6f6e 6469 7469 6f6e  ms and condition
-00001b90: 7320 6f66 0a20 2020 2020 2074 6869 7320  s of.      this 
-00001ba0: 4c69 6365 6e73 652c 2065 6163 6820 436f  License, each Co
-00001bb0: 6e74 7269 6275 746f 7220 6865 7265 6279  ntributor hereby
-00001bc0: 2067 7261 6e74 7320 746f 2059 6f75 2061   grants to You a
-00001bd0: 2070 6572 7065 7475 616c 2c0a 2020 2020   perpetual,.    
-00001be0: 2020 776f 726c 6477 6964 652c 206e 6f6e    worldwide, non
-00001bf0: 2d65 7863 6c75 7369 7665 2c20 6e6f 2d63  -exclusive, no-c
-00001c00: 6861 7267 652c 2072 6f79 616c 7479 2d66  harge, royalty-f
-00001c10: 7265 652c 2069 7272 6576 6f63 6162 6c65  ree, irrevocable
-00001c20: 0a20 2020 2020 2028 6578 6365 7074 2061  .      (except a
-00001c30: 7320 7374 6174 6564 2069 6e20 7468 6973  s stated in this
-00001c40: 2073 6563 7469 6f6e 2920 7061 7465 6e74   section) patent
-00001c50: 206c 6963 656e 7365 2074 6f20 6d61 6b65   license to make
-00001c60: 2c20 6861 7665 206d 6164 652c 0a20 2020  , have made,.   
-00001c70: 2020 2075 7365 2c20 6f66 6665 7220 746f     use, offer to
-00001c80: 2073 656c 6c2c 2073 656c 6c2c 2069 6d70   sell, sell, imp
-00001c90: 6f72 742c 2061 6e64 206f 7468 6572 7769  ort, and otherwi
-00001ca0: 7365 2074 7261 6e73 6665 7220 7468 6520  se transfer the 
-00001cb0: 576f 726b 2c0a 2020 2020 2020 7768 6572  Work,.      wher
-00001cc0: 6520 7375 6368 206c 6963 656e 7365 2061  e such license a
-00001cd0: 7070 6c69 6573 206f 6e6c 7920 746f 2074  pplies only to t
-00001ce0: 686f 7365 2070 6174 656e 7420 636c 6169  hose patent clai
-00001cf0: 6d73 206c 6963 656e 7361 626c 650a 2020  ms licensable.  
-00001d00: 2020 2020 6279 2073 7563 6820 436f 6e74      by such Cont
-00001d10: 7269 6275 746f 7220 7468 6174 2061 7265  ributor that are
-00001d20: 206e 6563 6573 7361 7269 6c79 2069 6e66   necessarily inf
-00001d30: 7269 6e67 6564 2062 7920 7468 6569 720a  ringed by their.
-00001d40: 2020 2020 2020 436f 6e74 7269 6275 7469        Contributi
-00001d50: 6f6e 2873 2920 616c 6f6e 6520 6f72 2062  on(s) alone or b
-00001d60: 7920 636f 6d62 696e 6174 696f 6e20 6f66  y combination of
-00001d70: 2074 6865 6972 2043 6f6e 7472 6962 7574   their Contribut
-00001d80: 696f 6e28 7329 0a20 2020 2020 2077 6974  ion(s).      wit
-00001d90: 6820 7468 6520 576f 726b 2074 6f20 7768  h the Work to wh
-00001da0: 6963 6820 7375 6368 2043 6f6e 7472 6962  ich such Contrib
-00001db0: 7574 696f 6e28 7329 2077 6173 2073 7562  ution(s) was sub
-00001dc0: 6d69 7474 6564 2e20 4966 2059 6f75 0a20  mitted. If You. 
-00001dd0: 2020 2020 2069 6e73 7469 7475 7465 2070       institute p
-00001de0: 6174 656e 7420 6c69 7469 6761 7469 6f6e  atent litigation
-00001df0: 2061 6761 696e 7374 2061 6e79 2065 6e74   against any ent
-00001e00: 6974 7920 2869 6e63 6c75 6469 6e67 2061  ity (including a
-00001e10: 0a20 2020 2020 2063 726f 7373 2d63 6c61  .      cross-cla
-00001e20: 696d 206f 7220 636f 756e 7465 7263 6c61  im or countercla
-00001e30: 696d 2069 6e20 6120 6c61 7773 7569 7429  im in a lawsuit)
-00001e40: 2061 6c6c 6567 696e 6720 7468 6174 2074   alleging that t
-00001e50: 6865 2057 6f72 6b0a 2020 2020 2020 6f72  he Work.      or
-00001e60: 2061 2043 6f6e 7472 6962 7574 696f 6e20   a Contribution 
-00001e70: 696e 636f 7270 6f72 6174 6564 2077 6974  incorporated wit
-00001e80: 6869 6e20 7468 6520 576f 726b 2063 6f6e  hin the Work con
-00001e90: 7374 6974 7574 6573 2064 6972 6563 740a  stitutes direct.
-00001ea0: 2020 2020 2020 6f72 2063 6f6e 7472 6962        or contrib
-00001eb0: 7574 6f72 7920 7061 7465 6e74 2069 6e66  utory patent inf
-00001ec0: 7269 6e67 656d 656e 742c 2074 6865 6e20  ringement, then 
-00001ed0: 616e 7920 7061 7465 6e74 206c 6963 656e  any patent licen
-00001ee0: 7365 730a 2020 2020 2020 6772 616e 7465  ses.      grante
-00001ef0: 6420 746f 2059 6f75 2075 6e64 6572 2074  d to You under t
-00001f00: 6869 7320 4c69 6365 6e73 6520 666f 7220  his License for 
-00001f10: 7468 6174 2057 6f72 6b20 7368 616c 6c20  that Work shall 
-00001f20: 7465 726d 696e 6174 650a 2020 2020 2020  terminate.      
-00001f30: 6173 206f 6620 7468 6520 6461 7465 2073  as of the date s
-00001f40: 7563 6820 6c69 7469 6761 7469 6f6e 2069  uch litigation i
-00001f50: 7320 6669 6c65 642e 0a0a 2020 2034 2e20  s filed...   4. 
-00001f60: 5265 6469 7374 7269 6275 7469 6f6e 2e20  Redistribution. 
-00001f70: 596f 7520 6d61 7920 7265 7072 6f64 7563  You may reproduc
-00001f80: 6520 616e 6420 6469 7374 7269 6275 7465  e and distribute
-00001f90: 2063 6f70 6965 7320 6f66 2074 6865 0a20   copies of the. 
-00001fa0: 2020 2020 2057 6f72 6b20 6f72 2044 6572       Work or Der
-00001fb0: 6976 6174 6976 6520 576f 726b 7320 7468  ivative Works th
-00001fc0: 6572 656f 6620 696e 2061 6e79 206d 6564  ereof in any med
-00001fd0: 6975 6d2c 2077 6974 6820 6f72 2077 6974  ium, with or wit
-00001fe0: 686f 7574 0a20 2020 2020 206d 6f64 6966  hout.      modif
-00001ff0: 6963 6174 696f 6e73 2c20 616e 6420 696e  ications, and in
-00002000: 2053 6f75 7263 6520 6f72 204f 626a 6563   Source or Objec
-00002010: 7420 666f 726d 2c20 7072 6f76 6964 6564  t form, provided
-00002020: 2074 6861 7420 596f 750a 2020 2020 2020   that You.      
-00002030: 6d65 6574 2074 6865 2066 6f6c 6c6f 7769  meet the followi
-00002040: 6e67 2063 6f6e 6469 7469 6f6e 733a 0a0a  ng conditions:..
-00002050: 2020 2020 2020 2861 2920 596f 7520 6d75        (a) You mu
-00002060: 7374 2067 6976 6520 616e 7920 6f74 6865  st give any othe
-00002070: 7220 7265 6369 7069 656e 7473 206f 6620  r recipients of 
-00002080: 7468 6520 576f 726b 206f 720a 2020 2020  the Work or.    
-00002090: 2020 2020 2020 4465 7269 7661 7469 7665        Derivative
-000020a0: 2057 6f72 6b73 2061 2063 6f70 7920 6f66   Works a copy of
-000020b0: 2074 6869 7320 4c69 6365 6e73 653b 2061   this License; a
-000020c0: 6e64 0a0a 2020 2020 2020 2862 2920 596f  nd..      (b) Yo
-000020d0: 7520 6d75 7374 2063 6175 7365 2061 6e79  u must cause any
-000020e0: 206d 6f64 6966 6965 6420 6669 6c65 7320   modified files 
-000020f0: 746f 2063 6172 7279 2070 726f 6d69 6e65  to carry promine
-00002100: 6e74 206e 6f74 6963 6573 0a20 2020 2020  nt notices.     
-00002110: 2020 2020 2073 7461 7469 6e67 2074 6861       stating tha
-00002120: 7420 596f 7520 6368 616e 6765 6420 7468  t You changed th
-00002130: 6520 6669 6c65 733b 2061 6e64 0a0a 2020  e files; and..  
-00002140: 2020 2020 2863 2920 596f 7520 6d75 7374      (c) You must
-00002150: 2072 6574 6169 6e2c 2069 6e20 7468 6520   retain, in the 
-00002160: 536f 7572 6365 2066 6f72 6d20 6f66 2061  Source form of a
-00002170: 6e79 2044 6572 6976 6174 6976 6520 576f  ny Derivative Wo
-00002180: 726b 730a 2020 2020 2020 2020 2020 7468  rks.          th
-00002190: 6174 2059 6f75 2064 6973 7472 6962 7574  at You distribut
-000021a0: 652c 2061 6c6c 2063 6f70 7972 6967 6874  e, all copyright
-000021b0: 2c20 7061 7465 6e74 2c20 7472 6164 656d  , patent, tradem
-000021c0: 6172 6b2c 2061 6e64 0a20 2020 2020 2020  ark, and.       
-000021d0: 2020 2061 7474 7269 6275 7469 6f6e 206e     attribution n
-000021e0: 6f74 6963 6573 2066 726f 6d20 7468 6520  otices from the 
-000021f0: 536f 7572 6365 2066 6f72 6d20 6f66 2074  Source form of t
-00002200: 6865 2057 6f72 6b2c 0a20 2020 2020 2020  he Work,.       
-00002210: 2020 2065 7863 6c75 6469 6e67 2074 686f     excluding tho
-00002220: 7365 206e 6f74 6963 6573 2074 6861 7420  se notices that 
-00002230: 646f 206e 6f74 2070 6572 7461 696e 2074  do not pertain t
-00002240: 6f20 616e 7920 7061 7274 206f 660a 2020  o any part of.  
-00002250: 2020 2020 2020 2020 7468 6520 4465 7269          the Deri
-00002260: 7661 7469 7665 2057 6f72 6b73 3b20 616e  vative Works; an
-00002270: 640a 0a20 2020 2020 2028 6429 2049 6620  d..      (d) If 
-00002280: 7468 6520 576f 726b 2069 6e63 6c75 6465  the Work include
-00002290: 7320 6120 224e 4f54 4943 4522 2074 6578  s a "NOTICE" tex
-000022a0: 7420 6669 6c65 2061 7320 7061 7274 206f  t file as part o
-000022b0: 6620 6974 730a 2020 2020 2020 2020 2020  f its.          
-000022c0: 6469 7374 7269 6275 7469 6f6e 2c20 7468  distribution, th
-000022d0: 656e 2061 6e79 2044 6572 6976 6174 6976  en any Derivativ
-000022e0: 6520 576f 726b 7320 7468 6174 2059 6f75  e Works that You
-000022f0: 2064 6973 7472 6962 7574 6520 6d75 7374   distribute must
-00002300: 0a20 2020 2020 2020 2020 2069 6e63 6c75  .          inclu
-00002310: 6465 2061 2072 6561 6461 626c 6520 636f  de a readable co
-00002320: 7079 206f 6620 7468 6520 6174 7472 6962  py of the attrib
-00002330: 7574 696f 6e20 6e6f 7469 6365 7320 636f  ution notices co
-00002340: 6e74 6169 6e65 640a 2020 2020 2020 2020  ntained.        
-00002350: 2020 7769 7468 696e 2073 7563 6820 4e4f    within such NO
-00002360: 5449 4345 2066 696c 652c 2065 7863 6c75  TICE file, exclu
-00002370: 6469 6e67 2074 686f 7365 206e 6f74 6963  ding those notic
-00002380: 6573 2074 6861 7420 646f 206e 6f74 0a20  es that do not. 
-00002390: 2020 2020 2020 2020 2070 6572 7461 696e           pertain
-000023a0: 2074 6f20 616e 7920 7061 7274 206f 6620   to any part of 
-000023b0: 7468 6520 4465 7269 7661 7469 7665 2057  the Derivative W
-000023c0: 6f72 6b73 2c20 696e 2061 7420 6c65 6173  orks, in at leas
-000023d0: 7420 6f6e 650a 2020 2020 2020 2020 2020  t one.          
-000023e0: 6f66 2074 6865 2066 6f6c 6c6f 7769 6e67  of the following
-000023f0: 2070 6c61 6365 733a 2077 6974 6869 6e20   places: within 
-00002400: 6120 4e4f 5449 4345 2074 6578 7420 6669  a NOTICE text fi
-00002410: 6c65 2064 6973 7472 6962 7574 6564 0a20  le distributed. 
-00002420: 2020 2020 2020 2020 2061 7320 7061 7274           as part
-00002430: 206f 6620 7468 6520 4465 7269 7661 7469   of the Derivati
-00002440: 7665 2057 6f72 6b73 3b20 7769 7468 696e  ve Works; within
-00002450: 2074 6865 2053 6f75 7263 6520 666f 726d   the Source form
-00002460: 206f 720a 2020 2020 2020 2020 2020 646f   or.          do
-00002470: 6375 6d65 6e74 6174 696f 6e2c 2069 6620  cumentation, if 
-00002480: 7072 6f76 6964 6564 2061 6c6f 6e67 2077  provided along w
-00002490: 6974 6820 7468 6520 4465 7269 7661 7469  ith the Derivati
-000024a0: 7665 2057 6f72 6b73 3b20 6f72 2c0a 2020  ve Works; or,.  
-000024b0: 2020 2020 2020 2020 7769 7468 696e 2061          within a
-000024c0: 2064 6973 706c 6179 2067 656e 6572 6174   display generat
-000024d0: 6564 2062 7920 7468 6520 4465 7269 7661  ed by the Deriva
-000024e0: 7469 7665 2057 6f72 6b73 2c20 6966 2061  tive Works, if a
-000024f0: 6e64 0a20 2020 2020 2020 2020 2077 6865  nd.          whe
-00002500: 7265 7665 7220 7375 6368 2074 6869 7264  rever such third
-00002510: 2d70 6172 7479 206e 6f74 6963 6573 206e  -party notices n
-00002520: 6f72 6d61 6c6c 7920 6170 7065 6172 2e20  ormally appear. 
-00002530: 5468 6520 636f 6e74 656e 7473 0a20 2020  The contents.   
-00002540: 2020 2020 2020 206f 6620 7468 6520 4e4f         of the NO
-00002550: 5449 4345 2066 696c 6520 6172 6520 666f  TICE file are fo
-00002560: 7220 696e 666f 726d 6174 696f 6e61 6c20  r informational 
-00002570: 7075 7270 6f73 6573 206f 6e6c 7920 616e  purposes only an
-00002580: 640a 2020 2020 2020 2020 2020 646f 206e  d.          do n
-00002590: 6f74 206d 6f64 6966 7920 7468 6520 4c69  ot modify the Li
-000025a0: 6365 6e73 652e 2059 6f75 206d 6179 2061  cense. You may a
-000025b0: 6464 2059 6f75 7220 6f77 6e20 6174 7472  dd Your own attr
-000025c0: 6962 7574 696f 6e0a 2020 2020 2020 2020  ibution.        
-000025d0: 2020 6e6f 7469 6365 7320 7769 7468 696e    notices within
-000025e0: 2044 6572 6976 6174 6976 6520 576f 726b   Derivative Work
-000025f0: 7320 7468 6174 2059 6f75 2064 6973 7472  s that You distr
-00002600: 6962 7574 652c 2061 6c6f 6e67 7369 6465  ibute, alongside
-00002610: 0a20 2020 2020 2020 2020 206f 7220 6173  .          or as
-00002620: 2061 6e20 6164 6465 6e64 756d 2074 6f20   an addendum to 
-00002630: 7468 6520 4e4f 5449 4345 2074 6578 7420  the NOTICE text 
-00002640: 6672 6f6d 2074 6865 2057 6f72 6b2c 2070  from the Work, p
-00002650: 726f 7669 6465 640a 2020 2020 2020 2020  rovided.        
-00002660: 2020 7468 6174 2073 7563 6820 6164 6469    that such addi
-00002670: 7469 6f6e 616c 2061 7474 7269 6275 7469  tional attributi
-00002680: 6f6e 206e 6f74 6963 6573 2063 616e 6e6f  on notices canno
-00002690: 7420 6265 2063 6f6e 7374 7275 6564 0a20  t be construed. 
-000026a0: 2020 2020 2020 2020 2061 7320 6d6f 6469           as modi
-000026b0: 6679 696e 6720 7468 6520 4c69 6365 6e73  fying the Licens
-000026c0: 652e 0a0a 2020 2020 2020 596f 7520 6d61  e...      You ma
-000026d0: 7920 6164 6420 596f 7572 206f 776e 2063  y add Your own c
-000026e0: 6f70 7972 6967 6874 2073 7461 7465 6d65  opyright stateme
-000026f0: 6e74 2074 6f20 596f 7572 206d 6f64 6966  nt to Your modif
-00002700: 6963 6174 696f 6e73 2061 6e64 0a20 2020  ications and.   
-00002710: 2020 206d 6179 2070 726f 7669 6465 2061     may provide a
-00002720: 6464 6974 696f 6e61 6c20 6f72 2064 6966  dditional or dif
-00002730: 6665 7265 6e74 206c 6963 656e 7365 2074  ferent license t
-00002740: 6572 6d73 2061 6e64 2063 6f6e 6469 7469  erms and conditi
-00002750: 6f6e 730a 2020 2020 2020 666f 7220 7573  ons.      for us
-00002760: 652c 2072 6570 726f 6475 6374 696f 6e2c  e, reproduction,
-00002770: 206f 7220 6469 7374 7269 6275 7469 6f6e   or distribution
-00002780: 206f 6620 596f 7572 206d 6f64 6966 6963   of Your modific
-00002790: 6174 696f 6e73 2c20 6f72 0a20 2020 2020  ations, or.     
-000027a0: 2066 6f72 2061 6e79 2073 7563 6820 4465   for any such De
-000027b0: 7269 7661 7469 7665 2057 6f72 6b73 2061  rivative Works a
-000027c0: 7320 6120 7768 6f6c 652c 2070 726f 7669  s a whole, provi
-000027d0: 6465 6420 596f 7572 2075 7365 2c0a 2020  ded Your use,.  
-000027e0: 2020 2020 7265 7072 6f64 7563 7469 6f6e      reproduction
-000027f0: 2c20 616e 6420 6469 7374 7269 6275 7469  , and distributi
-00002800: 6f6e 206f 6620 7468 6520 576f 726b 206f  on of the Work o
-00002810: 7468 6572 7769 7365 2063 6f6d 706c 6965  therwise complie
-00002820: 7320 7769 7468 0a20 2020 2020 2074 6865  s with.      the
-00002830: 2063 6f6e 6469 7469 6f6e 7320 7374 6174   conditions stat
-00002840: 6564 2069 6e20 7468 6973 204c 6963 656e  ed in this Licen
-00002850: 7365 2e0a 0a20 2020 352e 2053 7562 6d69  se...   5. Submi
-00002860: 7373 696f 6e20 6f66 2043 6f6e 7472 6962  ssion of Contrib
-00002870: 7574 696f 6e73 2e20 556e 6c65 7373 2059  utions. Unless Y
-00002880: 6f75 2065 7870 6c69 6369 746c 7920 7374  ou explicitly st
-00002890: 6174 6520 6f74 6865 7277 6973 652c 0a20  ate otherwise,. 
-000028a0: 2020 2020 2061 6e79 2043 6f6e 7472 6962       any Contrib
-000028b0: 7574 696f 6e20 696e 7465 6e74 696f 6e61  ution intentiona
-000028c0: 6c6c 7920 7375 626d 6974 7465 6420 666f  lly submitted fo
-000028d0: 7220 696e 636c 7573 696f 6e20 696e 2074  r inclusion in t
-000028e0: 6865 2057 6f72 6b0a 2020 2020 2020 6279  he Work.      by
-000028f0: 2059 6f75 2074 6f20 7468 6520 4c69 6365   You to the Lice
-00002900: 6e73 6f72 2073 6861 6c6c 2062 6520 756e  nsor shall be un
-00002910: 6465 7220 7468 6520 7465 726d 7320 616e  der the terms an
-00002920: 6420 636f 6e64 6974 696f 6e73 206f 660a  d conditions of.
-00002930: 2020 2020 2020 7468 6973 204c 6963 656e        this Licen
-00002940: 7365 2c20 7769 7468 6f75 7420 616e 7920  se, without any 
-00002950: 6164 6469 7469 6f6e 616c 2074 6572 6d73  additional terms
-00002960: 206f 7220 636f 6e64 6974 696f 6e73 2e0a   or conditions..
-00002970: 2020 2020 2020 4e6f 7477 6974 6873 7461        Notwithsta
-00002980: 6e64 696e 6720 7468 6520 6162 6f76 652c  nding the above,
-00002990: 206e 6f74 6869 6e67 2068 6572 6569 6e20   nothing herein 
-000029a0: 7368 616c 6c20 7375 7065 7273 6564 6520  shall supersede 
-000029b0: 6f72 206d 6f64 6966 790a 2020 2020 2020  or modify.      
-000029c0: 7468 6520 7465 726d 7320 6f66 2061 6e79  the terms of any
-000029d0: 2073 6570 6172 6174 6520 6c69 6365 6e73   separate licens
-000029e0: 6520 6167 7265 656d 656e 7420 796f 7520  e agreement you 
-000029f0: 6d61 7920 6861 7665 2065 7865 6375 7465  may have execute
-00002a00: 640a 2020 2020 2020 7769 7468 204c 6963  d.      with Lic
-00002a10: 656e 736f 7220 7265 6761 7264 696e 6720  ensor regarding 
-00002a20: 7375 6368 2043 6f6e 7472 6962 7574 696f  such Contributio
-00002a30: 6e73 2e0a 0a20 2020 362e 2054 7261 6465  ns...   6. Trade
-00002a40: 6d61 726b 732e 2054 6869 7320 4c69 6365  marks. This Lice
-00002a50: 6e73 6520 646f 6573 206e 6f74 2067 7261  nse does not gra
-00002a60: 6e74 2070 6572 6d69 7373 696f 6e20 746f  nt permission to
-00002a70: 2075 7365 2074 6865 2074 7261 6465 0a20   use the trade. 
-00002a80: 2020 2020 206e 616d 6573 2c20 7472 6164       names, trad
-00002a90: 656d 6172 6b73 2c20 7365 7276 6963 6520  emarks, service 
-00002aa0: 6d61 726b 732c 206f 7220 7072 6f64 7563  marks, or produc
-00002ab0: 7420 6e61 6d65 7320 6f66 2074 6865 204c  t names of the L
-00002ac0: 6963 656e 736f 722c 0a20 2020 2020 2065  icensor,.      e
-00002ad0: 7863 6570 7420 6173 2072 6571 7569 7265  xcept as require
-00002ae0: 6420 666f 7220 7265 6173 6f6e 6162 6c65  d for reasonable
-00002af0: 2061 6e64 2063 7573 746f 6d61 7279 2075   and customary u
-00002b00: 7365 2069 6e20 6465 7363 7269 6269 6e67  se in describing
-00002b10: 2074 6865 0a20 2020 2020 206f 7269 6769   the.      origi
-00002b20: 6e20 6f66 2074 6865 2057 6f72 6b20 616e  n of the Work an
-00002b30: 6420 7265 7072 6f64 7563 696e 6720 7468  d reproducing th
-00002b40: 6520 636f 6e74 656e 7420 6f66 2074 6865  e content of the
-00002b50: 204e 4f54 4943 4520 6669 6c65 2e0a 0a20   NOTICE file... 
-00002b60: 2020 372e 2044 6973 636c 6169 6d65 7220    7. Disclaimer 
-00002b70: 6f66 2057 6172 7261 6e74 792e 2055 6e6c  of Warranty. Unl
-00002b80: 6573 7320 7265 7175 6972 6564 2062 7920  ess required by 
-00002b90: 6170 706c 6963 6162 6c65 206c 6177 206f  applicable law o
-00002ba0: 720a 2020 2020 2020 6167 7265 6564 2074  r.      agreed t
-00002bb0: 6f20 696e 2077 7269 7469 6e67 2c20 4c69  o in writing, Li
-00002bc0: 6365 6e73 6f72 2070 726f 7669 6465 7320  censor provides 
-00002bd0: 7468 6520 576f 726b 2028 616e 6420 6561  the Work (and ea
-00002be0: 6368 0a20 2020 2020 2043 6f6e 7472 6962  ch.      Contrib
-00002bf0: 7574 6f72 2070 726f 7669 6465 7320 6974  utor provides it
-00002c00: 7320 436f 6e74 7269 6275 7469 6f6e 7329  s Contributions)
-00002c10: 206f 6e20 616e 2022 4153 2049 5322 2042   on an "AS IS" B
-00002c20: 4153 4953 2c0a 2020 2020 2020 5749 5448  ASIS,.      WITH
-00002c30: 4f55 5420 5741 5252 414e 5449 4553 204f  OUT WARRANTIES O
-00002c40: 5220 434f 4e44 4954 494f 4e53 204f 4620  R CONDITIONS OF 
-00002c50: 414e 5920 4b49 4e44 2c20 6569 7468 6572  ANY KIND, either
-00002c60: 2065 7870 7265 7373 206f 720a 2020 2020   express or.    
-00002c70: 2020 696d 706c 6965 642c 2069 6e63 6c75    implied, inclu
-00002c80: 6469 6e67 2c20 7769 7468 6f75 7420 6c69  ding, without li
-00002c90: 6d69 7461 7469 6f6e 2c20 616e 7920 7761  mitation, any wa
-00002ca0: 7272 616e 7469 6573 206f 7220 636f 6e64  rranties or cond
-00002cb0: 6974 696f 6e73 0a20 2020 2020 206f 6620  itions.      of 
-00002cc0: 5449 544c 452c 204e 4f4e 2d49 4e46 5249  TITLE, NON-INFRI
-00002cd0: 4e47 454d 454e 542c 204d 4552 4348 414e  NGEMENT, MERCHAN
-00002ce0: 5441 4249 4c49 5459 2c20 6f72 2046 4954  TABILITY, or FIT
-00002cf0: 4e45 5353 2046 4f52 2041 0a20 2020 2020  NESS FOR A.     
-00002d00: 2050 4152 5449 4355 4c41 5220 5055 5250   PARTICULAR PURP
-00002d10: 4f53 452e 2059 6f75 2061 7265 2073 6f6c  OSE. You are sol
-00002d20: 656c 7920 7265 7370 6f6e 7369 626c 6520  ely responsible 
-00002d30: 666f 7220 6465 7465 726d 696e 696e 6720  for determining 
-00002d40: 7468 650a 2020 2020 2020 6170 7072 6f70  the.      approp
-00002d50: 7269 6174 656e 6573 7320 6f66 2075 7369  riateness of usi
-00002d60: 6e67 206f 7220 7265 6469 7374 7269 6275  ng or redistribu
-00002d70: 7469 6e67 2074 6865 2057 6f72 6b20 616e  ting the Work an
-00002d80: 6420 6173 7375 6d65 2061 6e79 0a20 2020  d assume any.   
-00002d90: 2020 2072 6973 6b73 2061 7373 6f63 6961     risks associa
-00002da0: 7465 6420 7769 7468 2059 6f75 7220 6578  ted with Your ex
-00002db0: 6572 6369 7365 206f 6620 7065 726d 6973  ercise of permis
-00002dc0: 7369 6f6e 7320 756e 6465 7220 7468 6973  sions under this
-00002dd0: 204c 6963 656e 7365 2e0a 0a20 2020 382e   License...   8.
-00002de0: 204c 696d 6974 6174 696f 6e20 6f66 204c   Limitation of L
-00002df0: 6961 6269 6c69 7479 2e20 496e 206e 6f20  iability. In no 
-00002e00: 6576 656e 7420 616e 6420 756e 6465 7220  event and under 
-00002e10: 6e6f 206c 6567 616c 2074 6865 6f72 792c  no legal theory,
-00002e20: 0a20 2020 2020 2077 6865 7468 6572 2069  .      whether i
-00002e30: 6e20 746f 7274 2028 696e 636c 7564 696e  n tort (includin
-00002e40: 6720 6e65 676c 6967 656e 6365 292c 2063  g negligence), c
-00002e50: 6f6e 7472 6163 742c 206f 7220 6f74 6865  ontract, or othe
-00002e60: 7277 6973 652c 0a20 2020 2020 2075 6e6c  rwise,.      unl
-00002e70: 6573 7320 7265 7175 6972 6564 2062 7920  ess required by 
-00002e80: 6170 706c 6963 6162 6c65 206c 6177 2028  applicable law (
-00002e90: 7375 6368 2061 7320 6465 6c69 6265 7261  such as delibera
-00002ea0: 7465 2061 6e64 2067 726f 7373 6c79 0a20  te and grossly. 
-00002eb0: 2020 2020 206e 6567 6c69 6765 6e74 2061       negligent a
-00002ec0: 6374 7329 206f 7220 6167 7265 6564 2074  cts) or agreed t
-00002ed0: 6f20 696e 2077 7269 7469 6e67 2c20 7368  o in writing, sh
-00002ee0: 616c 6c20 616e 7920 436f 6e74 7269 6275  all any Contribu
-00002ef0: 746f 7220 6265 0a20 2020 2020 206c 6961  tor be.      lia
-00002f00: 626c 6520 746f 2059 6f75 2066 6f72 2064  ble to You for d
-00002f10: 616d 6167 6573 2c20 696e 636c 7564 696e  amages, includin
-00002f20: 6720 616e 7920 6469 7265 6374 2c20 696e  g any direct, in
-00002f30: 6469 7265 6374 2c20 7370 6563 6961 6c2c  direct, special,
-00002f40: 0a20 2020 2020 2069 6e63 6964 656e 7461  .      incidenta
-00002f50: 6c2c 206f 7220 636f 6e73 6571 7565 6e74  l, or consequent
-00002f60: 6961 6c20 6461 6d61 6765 7320 6f66 2061  ial damages of a
-00002f70: 6e79 2063 6861 7261 6374 6572 2061 7269  ny character ari
-00002f80: 7369 6e67 2061 7320 610a 2020 2020 2020  sing as a.      
-00002f90: 7265 7375 6c74 206f 6620 7468 6973 204c  result of this L
-00002fa0: 6963 656e 7365 206f 7220 6f75 7420 6f66  icense or out of
-00002fb0: 2074 6865 2075 7365 206f 7220 696e 6162   the use or inab
-00002fc0: 696c 6974 7920 746f 2075 7365 2074 6865  ility to use the
-00002fd0: 0a20 2020 2020 2057 6f72 6b20 2869 6e63  .      Work (inc
-00002fe0: 6c75 6469 6e67 2062 7574 206e 6f74 206c  luding but not l
-00002ff0: 696d 6974 6564 2074 6f20 6461 6d61 6765  imited to damage
-00003000: 7320 666f 7220 6c6f 7373 206f 6620 676f  s for loss of go
-00003010: 6f64 7769 6c6c 2c0a 2020 2020 2020 776f  odwill,.      wo
-00003020: 726b 2073 746f 7070 6167 652c 2063 6f6d  rk stoppage, com
-00003030: 7075 7465 7220 6661 696c 7572 6520 6f72  puter failure or
-00003040: 206d 616c 6675 6e63 7469 6f6e 2c20 6f72   malfunction, or
-00003050: 2061 6e79 2061 6e64 2061 6c6c 0a20 2020   any and all.   
-00003060: 2020 206f 7468 6572 2063 6f6d 6d65 7263     other commerc
-00003070: 6961 6c20 6461 6d61 6765 7320 6f72 206c  ial damages or l
-00003080: 6f73 7365 7329 2c20 6576 656e 2069 6620  osses), even if 
-00003090: 7375 6368 2043 6f6e 7472 6962 7574 6f72  such Contributor
-000030a0: 0a20 2020 2020 2068 6173 2062 6565 6e20  .      has been 
-000030b0: 6164 7669 7365 6420 6f66 2074 6865 2070  advised of the p
-000030c0: 6f73 7369 6269 6c69 7479 206f 6620 7375  ossibility of su
-000030d0: 6368 2064 616d 6167 6573 2e0a 0a20 2020  ch damages...   
-000030e0: 392e 2041 6363 6570 7469 6e67 2057 6172  9. Accepting War
-000030f0: 7261 6e74 7920 6f72 2041 6464 6974 696f  ranty or Additio
-00003100: 6e61 6c20 4c69 6162 696c 6974 792e 2057  nal Liability. W
-00003110: 6869 6c65 2072 6564 6973 7472 6962 7574  hile redistribut
-00003120: 696e 670a 2020 2020 2020 7468 6520 576f  ing.      the Wo
-00003130: 726b 206f 7220 4465 7269 7661 7469 7665  rk or Derivative
-00003140: 2057 6f72 6b73 2074 6865 7265 6f66 2c20   Works thereof, 
-00003150: 596f 7520 6d61 7920 6368 6f6f 7365 2074  You may choose t
-00003160: 6f20 6f66 6665 722c 0a20 2020 2020 2061  o offer,.      a
-00003170: 6e64 2063 6861 7267 6520 6120 6665 6520  nd charge a fee 
-00003180: 666f 722c 2061 6363 6570 7461 6e63 6520  for, acceptance 
-00003190: 6f66 2073 7570 706f 7274 2c20 7761 7272  of support, warr
-000031a0: 616e 7479 2c20 696e 6465 6d6e 6974 792c  anty, indemnity,
-000031b0: 0a20 2020 2020 206f 7220 6f74 6865 7220  .      or other 
-000031c0: 6c69 6162 696c 6974 7920 6f62 6c69 6761  liability obliga
-000031d0: 7469 6f6e 7320 616e 642f 6f72 2072 6967  tions and/or rig
-000031e0: 6874 7320 636f 6e73 6973 7465 6e74 2077  hts consistent w
-000031f0: 6974 6820 7468 6973 0a20 2020 2020 204c  ith this.      L
-00003200: 6963 656e 7365 2e20 486f 7765 7665 722c  icense. However,
-00003210: 2069 6e20 6163 6365 7074 696e 6720 7375   in accepting su
-00003220: 6368 206f 626c 6967 6174 696f 6e73 2c20  ch obligations, 
-00003230: 596f 7520 6d61 7920 6163 7420 6f6e 6c79  You may act only
-00003240: 0a20 2020 2020 206f 6e20 596f 7572 206f  .      on Your o
-00003250: 776e 2062 6568 616c 6620 616e 6420 6f6e  wn behalf and on
-00003260: 2059 6f75 7220 736f 6c65 2072 6573 706f   Your sole respo
-00003270: 6e73 6962 696c 6974 792c 206e 6f74 206f  nsibility, not o
-00003280: 6e20 6265 6861 6c66 0a20 2020 2020 206f  n behalf.      o
-00003290: 6620 616e 7920 6f74 6865 7220 436f 6e74  f any other Cont
-000032a0: 7269 6275 746f 722c 2061 6e64 206f 6e6c  ributor, and onl
-000032b0: 7920 6966 2059 6f75 2061 6772 6565 2074  y if You agree t
-000032c0: 6f20 696e 6465 6d6e 6966 792c 0a20 2020  o indemnify,.   
-000032d0: 2020 2064 6566 656e 642c 2061 6e64 2068     defend, and h
-000032e0: 6f6c 6420 6561 6368 2043 6f6e 7472 6962  old each Contrib
-000032f0: 7574 6f72 2068 6172 6d6c 6573 7320 666f  utor harmless fo
-00003300: 7220 616e 7920 6c69 6162 696c 6974 790a  r any liability.
-00003310: 2020 2020 2020 696e 6375 7272 6564 2062        incurred b
-00003320: 792c 206f 7220 636c 6169 6d73 2061 7373  y, or claims ass
-00003330: 6572 7465 6420 6167 6169 6e73 742c 2073  erted against, s
-00003340: 7563 6820 436f 6e74 7269 6275 746f 7220  uch Contributor 
-00003350: 6279 2072 6561 736f 6e0a 2020 2020 2020  by reason.      
-00003360: 6f66 2079 6f75 7220 6163 6365 7074 696e  of your acceptin
-00003370: 6720 616e 7920 7375 6368 2077 6172 7261  g any such warra
-00003380: 6e74 7920 6f72 2061 6464 6974 696f 6e61  nty or additiona
-00003390: 6c20 6c69 6162 696c 6974 792e 0a0a 2020  l liability...  
-000033a0: 2045 4e44 204f 4620 5445 524d 5320 414e   END OF TERMS AN
-000033b0: 4420 434f 4e44 4954 494f 4e53 0a0a 2020  D CONDITIONS..  
-000033c0: 2041 5050 454e 4449 583a 2048 6f77 2074   APPENDIX: How t
-000033d0: 6f20 6170 706c 7920 7468 6520 4170 6163  o apply the Apac
-000033e0: 6865 204c 6963 656e 7365 2074 6f20 796f  he License to yo
-000033f0: 7572 2077 6f72 6b2e 0a0a 2020 2020 2020  ur work...      
-00003400: 546f 2061 7070 6c79 2074 6865 2041 7061  To apply the Apa
-00003410: 6368 6520 4c69 6365 6e73 6520 746f 2079  che License to y
-00003420: 6f75 7220 776f 726b 2c20 6174 7461 6368  our work, attach
-00003430: 2074 6865 2066 6f6c 6c6f 7769 6e67 0a20   the following. 
-00003440: 2020 2020 2062 6f69 6c65 7270 6c61 7465       boilerplate
-00003450: 206e 6f74 6963 652c 2077 6974 6820 7468   notice, with th
-00003460: 6520 6669 656c 6473 2065 6e63 6c6f 7365  e fields enclose
-00003470: 6420 6279 2062 7261 636b 6574 7320 225b  d by brackets "[
-00003480: 5d22 0a20 2020 2020 2072 6570 6c61 6365  ]".      replace
-00003490: 6420 7769 7468 2079 6f75 7220 6f77 6e20  d with your own 
-000034a0: 6964 656e 7469 6679 696e 6720 696e 666f  identifying info
-000034b0: 726d 6174 696f 6e2e 2028 446f 6e27 7420  rmation. (Don't 
-000034c0: 696e 636c 7564 650a 2020 2020 2020 7468  include.      th
-000034d0: 6520 6272 6163 6b65 7473 2129 2020 5468  e brackets!)  Th
-000034e0: 6520 7465 7874 2073 686f 756c 6420 6265  e text should be
-000034f0: 2065 6e63 6c6f 7365 6420 696e 2074 6865   enclosed in the
-00003500: 2061 7070 726f 7072 6961 7465 0a20 2020   appropriate.   
-00003510: 2020 2063 6f6d 6d65 6e74 2073 796e 7461     comment synta
-00003520: 7820 666f 7220 7468 6520 6669 6c65 2066  x for the file f
-00003530: 6f72 6d61 742e 2057 6520 616c 736f 2072  ormat. We also r
-00003540: 6563 6f6d 6d65 6e64 2074 6861 7420 610a  ecommend that a.
-00003550: 2020 2020 2020 6669 6c65 206f 7220 636c        file or cl
-00003560: 6173 7320 6e61 6d65 2061 6e64 2064 6573  ass name and des
-00003570: 6372 6970 7469 6f6e 206f 6620 7075 7270  cription of purp
-00003580: 6f73 6520 6265 2069 6e63 6c75 6465 6420  ose be included 
-00003590: 6f6e 2074 6865 0a20 2020 2020 2073 616d  on the.      sam
-000035a0: 6520 2270 7269 6e74 6564 2070 6167 6522  e "printed page"
-000035b0: 2061 7320 7468 6520 636f 7079 7269 6768   as the copyrigh
-000035c0: 7420 6e6f 7469 6365 2066 6f72 2065 6173  t notice for eas
-000035d0: 6965 720a 2020 2020 2020 6964 656e 7469  ier.      identi
-000035e0: 6669 6361 7469 6f6e 2077 6974 6869 6e20  fication within 
-000035f0: 7468 6972 642d 7061 7274 7920 6172 6368  third-party arch
-00003600: 6976 6573 2e0a 0a20 2020 436f 7079 7269  ives...   Copyri
-00003610: 6768 7420 5b79 7979 795d 205b 6e61 6d65  ght [yyyy] [name
-00003620: 206f 6620 636f 7079 7269 6768 7420 6f77   of copyright ow
-00003630: 6e65 725d 0a0a 2020 204c 6963 656e 7365  ner]..   License
-00003640: 6420 756e 6465 7220 7468 6520 4170 6163  d under the Apac
-00003650: 6865 204c 6963 656e 7365 2c20 5665 7273  he License, Vers
-00003660: 696f 6e20 322e 3020 2874 6865 2022 4c69  ion 2.0 (the "Li
-00003670: 6365 6e73 6522 293b 0a20 2020 796f 7520  cense");.   you 
-00003680: 6d61 7920 6e6f 7420 7573 6520 7468 6973  may not use this
-00003690: 2066 696c 6520 6578 6365 7074 2069 6e20   file except in 
-000036a0: 636f 6d70 6c69 616e 6365 2077 6974 6820  compliance with 
-000036b0: 7468 6520 4c69 6365 6e73 652e 0a20 2020  the License..   
-000036c0: 596f 7520 6d61 7920 6f62 7461 696e 2061  You may obtain a
-000036d0: 2063 6f70 7920 6f66 2074 6865 204c 6963   copy of the Lic
-000036e0: 656e 7365 2061 740a 0a20 2020 2020 2020  ense at..       
-000036f0: 6874 7470 3a2f 2f77 7777 2e61 7061 6368  http://www.apach
-00003700: 652e 6f72 672f 6c69 6365 6e73 6573 2f4c  e.org/licenses/L
-00003710: 4943 454e 5345 2d32 2e30 0a0a 2020 2055  ICENSE-2.0..   U
-00003720: 6e6c 6573 7320 7265 7175 6972 6564 2062  nless required b
-00003730: 7920 6170 706c 6963 6162 6c65 206c 6177  y applicable law
-00003740: 206f 7220 6167 7265 6564 2074 6f20 696e   or agreed to in
-00003750: 2077 7269 7469 6e67 2c20 736f 6674 7761   writing, softwa
-00003760: 7265 0a20 2020 6469 7374 7269 6275 7465  re.   distribute
-00003770: 6420 756e 6465 7220 7468 6520 4c69 6365  d under the Lice
-00003780: 6e73 6520 6973 2064 6973 7472 6962 7574  nse is distribut
-00003790: 6564 206f 6e20 616e 2022 4153 2049 5322  ed on an "AS IS"
-000037a0: 2042 4153 4953 2c0a 2020 2057 4954 484f   BASIS,.   WITHO
-000037b0: 5554 2057 4152 5241 4e54 4945 5320 4f52  UT WARRANTIES OR
-000037c0: 2043 4f4e 4449 5449 4f4e 5320 4f46 2041   CONDITIONS OF A
-000037d0: 4e59 204b 494e 442c 2065 6974 6865 7220  NY KIND, either 
-000037e0: 6578 7072 6573 7320 6f72 2069 6d70 6c69  express or impli
-000037f0: 6564 2e0a 2020 2053 6565 2074 6865 204c  ed..   See the L
-00003800: 6963 656e 7365 2066 6f72 2074 6865 2073  icense for the s
-00003810: 7065 6369 6669 6320 6c61 6e67 7561 6765  pecific language
-00003820: 2067 6f76 6572 6e69 6e67 2070 6572 6d69   governing permi
-00003830: 7373 696f 6e73 2061 6e64 0a20 2020 6c69  ssions and.   li
-00003840: 6d69 7461 7469 6f6e 7320 756e 6465 7220  mitations under 
-00003850: 7468 6520 4c69 6365 6e73 652e 0a00 0000  the License.....
-00003860: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-00003870: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-00003880: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-00003890: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-000038a0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-000038b0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-000038c0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-000038d0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-000038e0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-000038f0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-00003900: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-00003910: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-00003920: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-00003930: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-00003940: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-00003950: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-00003960: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-00003970: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-00003980: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-00003990: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-000039a0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-000039b0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-000039c0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-000039d0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-000039e0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-000039f0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-00003a00: 2e2f 2e2f 4050 6178 4865 6164 6572 0000  ././@PaxHeader..
-00003a10: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-00003a20: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-00003a30: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-00003a40: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-00003a50: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-00003a60: 0000 0000 3030 3030 3030 3000 3030 3030  ....0000000.0000
-00003a70: 3030 3000 3030 3030 3030 3000 3030 3030  000.0000000.0000
-00003a80: 3030 3030 3032 3600 3030 3030 3030 3030  0000026.00000000
-00003a90: 3030 3000 3031 3134 3533 0020 7800 0000  000.011453. x...
-00003aa0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-00003ab0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-00003ac0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-00003ad0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-00003ae0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-00003af0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-00003b00: 0075 7374 6172 0030 3000 0000 0000 0000  .ustar.00.......
-00003b10: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-00003b20: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-00003b30: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-00003b40: 0000 0000 0000 0000 0030 3030 3030 3030  .........0000000
-00003b50: 0030 3030 3030 3030 0000 0000 0000 0000  .0000000........
-00003b60: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-00003b70: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-00003b80: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-00003b90: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-00003ba0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-00003bb0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-00003bc0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-00003bd0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-00003be0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-00003bf0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-00003c00: 3232 206d 7469 6d65 3d31 3634 3933 3732  22 mtime=1649372
-00003c10: 3831 332e 300a 0000 0000 0000 0000 0000  813.0...........
-00003c20: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-00003c30: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-00003c40: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-00003c50: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-00003c60: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-00003c70: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-00003c80: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-00003c90: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-00003ca0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-00003cb0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-00003cc0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-00003cd0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-00003ce0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-00003cf0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-00003d00: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-00003d10: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-00003d20: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-00003d30: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-00003d40: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-00003d50: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-00003d60: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-00003d70: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-00003d80: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-00003d90: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-00003da0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-00003db0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-00003dc0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-00003dd0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-00003de0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-00003df0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-00003e00: 6c61 7a79 7472 616e 7366 6f72 6d2d 312e  lazytransform-1.
-00003e10: 302f 4d41 4e49 4645 5354 2e69 6e00 0000  0/MANIFEST.in...
-00003e20: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-00003e30: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-00003e40: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-00003e50: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-00003e60: 0000 0000 3030 3030 3737 3700 3030 3031  ....0000777.0001
-00003e70: 3735 3000 3030 3031 3735 3000 3030 3030  750.0001750.0000
-00003e80: 3030 3031 3134 3200 3030 3030 3030 3030  0001142.00000000
-00003e90: 3030 3000 3031 3534 3131 0020 3000 0000  000.015411. 0...
-00003ea0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-00003eb0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-00003ec0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-00003ed0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-00003ee0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-00003ef0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-00003f00: 0075 7374 6172 0030 3072 616d 0000 0000  .ustar.00ram....
-00003f10: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-00003f20: 0000 0000 0000 0000 0072 616d 0000 0000  .........ram....
-00003f30: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-00003f40: 0000 0000 0000 0000 0030 3030 3030 3030  .........0000000
-00003f50: 0030 3030 3030 3030 0000 0000 0000 0000  .0000000........
-00003f60: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-00003f70: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-00003f80: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-00003f90: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-00003fa0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-00003fb0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-00003fc0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-00003fd0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-00003fe0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-00003ff0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-00004000: 696e 636c 7564 6520 5245 4144 4d45 2e6d  include README.m
-00004010: 640a 0a69 6e63 6c75 6465 204c 4943 454e  d..include LICEN
-00004020: 5345 0a69 6e63 6c75 6465 204c 4943 454e  SE.include LICEN
-00004030: 5345 2e74 7874 0a0a 696e 636c 7564 6520  SE.txt..include 
-00004040: 4d41 4e49 4645 5354 2e69 6e0a 696e 636c  MANIFEST.in.incl
-00004050: 7564 6520 7365 7475 702e 7079 0a69 6e63  ude setup.py.inc
-00004060: 6c75 6465 2073 6574 7570 2e63 6667 0a0a  lude setup.cfg..
-00004070: 696e 636c 7564 6520 7265 7175 6972 656d  include requirem
-00004080: 656e 7473 2e74 7874 0a72 6563 7572 7369  ents.txt.recursi
-00004090: 7665 2d69 6e63 6c75 6465 2072 6571 7569  ve-include requi
-000040a0: 7265 6d65 6e74 7320 2a2e 7478 740a 0a69  rements *.txt..i
-000040b0: 6e63 6c75 6465 2046 6561 7475 7265 7769  nclude Featurewi
-000040c0: 7a5f 4c61 7a79 5472 616e 7366 6f72 6d5f  z_LazyTransform_
-000040d0: 4465 6d6f 312e 6970 796e 620a 696e 636c  Demo1.ipynb.incl
-000040e0: 7564 6520 4665 6174 7572 6577 697a 5f4c  ude Featurewiz_L
-000040f0: 617a 7954 7261 6e73 666f 726d 5f44 656d  azyTransform_Dem
-00004100: 6f32 2e69 7079 6e62 0a69 6e63 6c75 6465  o2.ipynb.include
-00004110: 204c 617a 7954 7261 6e73 666f 726d 6572   LazyTransformer
-00004120: 5f77 6974 685f 4772 6964 5365 6172 6368  _with_GridSearch
-00004130: 5f50 6970 656c 696e 652e 6970 796e 620a  _Pipeline.ipynb.
-00004140: 696e 636c 7564 6520 6c61 7a79 5f63 6f64  include lazy_cod
-00004150: 6531 2e70 6e67 0a69 6e63 6c75 6465 206c  e1.png.include l
-00004160: 617a 795f 636f 6465 322e 706e 670a 696e  azy_code2.png.in
-00004170: 636c 7564 6520 6c61 7a79 5f66 6561 745f  clude lazy_feat_
-00004180: 696d 702e 706e 670a 696e 636c 7564 6520  imp.png.include 
-00004190: 6c61 7a79 5f67 7269 6473 6561 7263 682e  lazy_gridsearch.
-000041a0: 706e 670a 696e 636c 7564 6520 6c61 7a79  png.include lazy
-000041b0: 5f6c 6f67 6f35 2e70 6e67 0a69 6e63 6c75  _logo5.png.inclu
-000041c0: 6465 206c 617a 795f 7069 7065 2e70 6e67  de lazy_pipe.png
-000041d0: 0a69 6e63 6c75 6465 206c 617a 7974 7261  .include lazytra
-000041e0: 6e73 666f 726d 2e70 790a 696e 636c 7564  nsform.py.includ
-000041f0: 6520 6c61 7a79 7472 616e 7366 6f72 6d65  e lazytransforme
-00004200: 725f 6b61 6767 6c65 5f64 656d 6f2e 6970  r_kaggle_demo.ip
-00004210: 796e 620a 0a72 6563 7572 7369 7665 2d65  ynb..recursive-e
-00004220: 7863 6c75 6465 206e 6f74 6562 6f6f 6b73  xclude notebooks
-00004230: 202a 0a72 6563 7572 7369 7665 2d65 7863   *.recursive-exc
-00004240: 6c75 6465 2069 6d61 6765 7320 2a0a 0a65  lude images *..e
-00004250: 7863 6c75 6465 202e 6769 7469 676e 6f72  xclude .gitignor
-00004260: 650a 0000 0000 0000 0000 0000 0000 0000  e...............
-00004270: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-00004280: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-00004290: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-000042a0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-000042b0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-000042c0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-000042d0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-000042e0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-000042f0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-00004300: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-00004310: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-00004320: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-00004330: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-00004340: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-00004350: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-00004360: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-00004370: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-00004380: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-00004390: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-000043a0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-000043b0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-000043c0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-000043d0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-000043e0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-000043f0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-00004400: 2e2f 2e2f 4050 6178 4865 6164 6572 0000  ././@PaxHeader..
-00004410: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-00004420: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-00004430: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-00004440: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-00004450: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-00004460: 0000 0000 3030 3030 3030 3000 3030 3030  ....0000000.0000
-00004470: 3030 3000 3030 3030 3030 3000 3030 3030  000.0000000.0000
-00004480: 3030 3030 3033 3300 3030 3030 3030 3030  0000033.00000000
-00004490: 3030 3000 3031 3134 3531 0020 7800 0000  000.011451. x...
-000044a0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-000044b0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-000044c0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-000044d0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-000044e0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-000044f0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-00004500: 0075 7374 6172 0030 3000 0000 0000 0000  .ustar.00.......
-00004510: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-00004520: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-00004530: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-00004540: 0000 0000 0000 0000 0030 3030 3030 3030  .........0000000
-00004550: 0030 3030 3030 3030 0000 0000 0000 0000  .0000000........
-00004560: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-00004570: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-00004580: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-00004590: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-000045a0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-000045b0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-000045c0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-000045d0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-000045e0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-000045f0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-00004600: 3237 206d 7469 6d65 3d31 3636 3432 3832  27 mtime=1664282
-00004610: 3237 342e 3333 3339 3133 0a00 0000 0000  274.333913......
-00004620: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-00004630: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-00004640: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-00004650: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-00004660: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-00004670: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-00004680: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-00004690: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-000046a0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-000046b0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-000046c0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-000046d0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-000046e0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-000046f0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-00004700: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-00004710: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-00004720: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-00004730: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-00004740: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-00004750: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-00004760: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-00004770: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-00004780: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-00004790: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-000047a0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-000047b0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-000047c0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-000047d0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-000047e0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-000047f0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-00004800: 6c61 7a79 7472 616e 7366 6f72 6d2d 312e  lazytransform-1.
-00004810: 302f 504b 472d 494e 464f 0000 0000 0000  0/PKG-INFO......
-00004820: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-00004830: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-00004840: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-00004850: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-00004860: 0000 0000 3030 3030 3737 3700 3030 3031  ....0000777.0001
-00004870: 3735 3000 3030 3031 3735 3000 3030 3030  750.0001750.0000
-00004880: 3030 3436 3731 3600 3030 3030 3030 3030  0046716.00000000
-00004890: 3030 3000 3031 3437 3730 0020 3000 0000  000.014770. 0...
-000048a0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-000048b0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-000048c0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-000048d0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-000048e0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-000048f0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-00004900: 0075 7374 6172 0030 3072 616d 0000 0000  .ustar.00ram....
-00004910: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-00004920: 0000 0000 0000 0000 0072 616d 0000 0000  .........ram....
-00004930: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-00004940: 0000 0000 0000 0000 0030 3030 3030 3030  .........0000000
-00004950: 0030 3030 3030 3030 0000 0000 0000 0000  .0000000........
-00004960: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-00004970: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-00004980: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-00004990: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-000049a0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-000049b0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-000049c0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-000049d0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-000049e0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-000049f0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-00004a00: 4d65 7461 6461 7461 2d56 6572 7369 6f6e  Metadata-Version
-00004a10: 3a20 322e 310a 4e61 6d65 3a20 6c61 7a79  : 2.1.Name: lazy
-00004a20: 7472 616e 7366 6f72 6d0a 5665 7273 696f  transform.Versio
-00004a30: 6e3a 2031 2e30 0a53 756d 6d61 7279 3a20  n: 1.0.Summary: 
-00004a40: 4175 746f 6d61 7469 6361 6c6c 7920 6275  Automatically bu
-00004a50: 696c 6420 6461 7461 2061 6e64 206d 6f64  ild data and mod
-00004a60: 656c 2070 6970 656c 696e 6573 2075 7369  el pipelines usi
-00004a70: 6e67 2073 6369 6b69 742d 6c65 6172 6e20  ng scikit-learn 
-00004a80: 696e 2061 2073 696e 676c 6520 6c69 6e65  in a single line
-00004a90: 206f 6620 636f 6465 0a48 6f6d 652d 7061   of code.Home-pa
-00004aa0: 6765 3a20 6874 7470 733a 2f2f 6769 7468  ge: https://gith
-00004ab0: 7562 2e63 6f6d 2f41 7574 6f56 694d 4c2f  ub.com/AutoViML/
-00004ac0: 6c61 7a79 7472 616e 7366 6f72 6d0a 4175  lazytransform.Au
-00004ad0: 7468 6f72 3a20 5261 6d20 5365 7368 6164  thor: Ram Seshad
-00004ae0: 7269 0a4c 6963 656e 7365 3a20 4170 6163  ri.License: Apac
-00004af0: 6865 204c 6963 656e 7365 2032 2e30 0a44  he License 2.0.D
-00004b00: 6573 6372 6970 7469 6f6e 3a20 2320 6c61  escription: # la
-00004b10: 7a79 7472 616e 7366 6f72 6d0a 2020 2020  zytransform.    
-00004b20: 2020 2020 4175 746f 6d61 7469 6361 6c6c      Automaticall
-00004b30: 7920 7472 616e 7366 6f72 6d20 616c 6c20  y transform all 
-00004b40: 6361 7465 676f 7269 6361 6c2c 2064 6174  categorical, dat
-00004b50: 652d 7469 6d65 2c20 4e4c 5020 7661 7269  e-time, NLP vari
-00004b60: 6162 6c65 7320 696e 2079 6f75 7220 6461  ables in your da
-00004b70: 7461 2073 6574 2074 6f20 6e75 6d65 7269  ta set to numeri
-00004b80: 6320 696e 2061 2073 696e 676c 6520 6c69  c in a single li
-00004b90: 6e65 206f 6620 636f 6465 2066 6f72 2061  ne of code for a
-00004ba0: 6e79 2064 6174 6120 7365 7420 616e 7920  ny data set any 
-00004bb0: 7369 7a65 2e0a 2020 2020 2020 2020 0a20  size..        . 
-00004bc0: 2020 2020 2020 203c 6120 6872 6566 3d22         <a href="
-00004bd0: 6874 7470 733a 2f2f 6769 7468 7562 2e63  https://github.c
-00004be0: 6f6d 2f41 7574 6f56 694d 4c2f 6c61 7a79  om/AutoViML/lazy
-00004bf0: 7472 616e 7366 6f72 6d22 3e3c 696d 6720  transform"><img 
-00004c00: 7372 633d 2268 7474 7073 3a2f 2f69 2e69  src="https://i.i
-00004c10: 6262 2e63 6f2f 576b 7446 6b74 4c2f 6c61  bb.co/WktFktL/la
-00004c20: 7a79 7472 616e 7366 6f72 6d65 722e 706e  zytransformer.pn
-00004c30: 6722 2061 6c74 3d22 6c61 7a79 7472 616e  g" alt="lazytran
-00004c40: 7366 6f72 6d65 7222 2062 6f72 6465 723d  sformer" border=
-00004c50: 2230 223e 3c2f 613e 0a20 2020 2020 2020  "0"></a>.       
-00004c60: 2023 2320 5570 6461 7465 2028 4175 6720   ## Update (Aug 
-00004c70: 3230 3232 290a 2020 2020 2020 2020 3c6f  2022).        <o
-00004c80: 6c3e 0a20 2020 2020 2020 203c 6c69 3e3c  l>.        <li><
-00004c90: 623e 6c61 7a79 7472 616e 7366 6f72 6d20  b>lazytransform 
-00004ca0: 6973 2076 6572 7920 6561 7379 2074 6f20  is very easy to 
-00004cb0: 696e 7374 616c 6c20 6f6e 204b 6167 676c  install on Kaggl
-00004cc0: 6520 616e 6420 436f 6c61 6220 6e6f 7465  e and Colab note
-00004cd0: 626f 6f6b 7320 7573 696e 6720 7468 6973  books using this
-00004ce0: 2063 6f6d 6d61 6e64 3a3c 2f62 3e2e 200a   command:</b>. .
-00004cf0: 2020 2020 2020 2020 0a20 2020 2020 2020          .       
-00004d00: 2060 6060 0a20 2020 2020 2020 2021 7069   ```.        !pi
-00004d10: 7020 696e 7374 616c 6c20 6c61 7a79 7472  p install lazytr
-00004d20: 616e 7366 6f72 6d20 2d2d 6967 6e6f 7265  ansform --ignore
-00004d30: 2d69 6e73 7461 6c6c 6564 202d 2d6e 6f2d  -installed --no-
-00004d40: 6361 6368 6520 2d2d 6e6f 2d64 6570 730a  cache --no-deps.
-00004d50: 2020 2020 2020 2020 6060 600a 2020 2020          ```.    
-00004d60: 2020 2020 3c2f 6c69 3e3c 6272 3e0a 2020      </li><br>.  
-00004d70: 2020 2020 2020 3c6c 693e 3c62 3e6c 617a        <li><b>laz
-00004d80: 7974 7261 6e73 666f 726d 2061 7320 6f66  ytransform as of
-00004d90: 2076 6572 7369 6f6e 2030 2e39 3120 6861   version 0.91 ha
-00004da0: 7320 7477 6f20 5375 7065 7220 4c65 6172  s two Super Lear
-00004db0: 6e69 6e67 204f 7074 696d 697a 6564 2028  ning Optimized (
-00004dc0: 5355 4c4f 2920 456e 7365 6d62 6c65 7320  SULO) Ensembles 
-00004dd0: 6e61 6d65 6420 2253 756c 6f43 6c61 7373  named "SuloClass
-00004de0: 6966 6965 7222 2061 6e64 2022 5375 6c6f  ifier" and "Sulo
-00004df0: 5265 6772 6573 736f 7222 3c2f 623e 2e20  Regressor"</b>. 
-00004e00: 5468 6520 6573 7469 6d61 746f 7273 2061  The estimators a
-00004e10: 7265 2022 6f70 7469 6d69 7a65 6422 2069  re "optimized" i
-00004e20: 6e20 7468 6520 7365 6e73 6520 7468 6174  n the sense that
-00004e30: 2079 6f75 2063 616e 2075 7365 2074 6865   you can use the
-00004e40: 6d20 666f 7220 616c 6c20 6b69 6e64 7320  m for all kinds 
-00004e50: 6f66 206d 756c 7469 2d6c 6162 656c 206d  of multi-label m
-00004e60: 756c 7469 2d63 6c61 7373 2061 6e64 2049  ulti-class and I
-00004e70: 6d62 616c 616e 6365 6420 6461 7461 2073  mbalanced data s
-00004e80: 6574 2070 726f 626c 656d 7320 7769 7468  et problems with
-00004e90: 6f75 7420 6e65 6564 696e 6720 746f 2064  out needing to d
-00004ea0: 6f20 6879 7065 722d 7061 7261 6d65 7465  o hyper-paramete
-00004eb0: 7220 7475 6e69 6e67 2077 6974 6820 4772  r tuning with Gr
-00004ec0: 6964 5365 6172 6368 4356 2e20 5468 6579  idSearchCV. They
-00004ed0: 2061 7265 2062 7569 6c74 2075 7369 6e67   are built using
-00004ee0: 2062 6173 6963 2073 6369 6b69 742d 6c65   basic scikit-le
-00004ef0: 6172 6e20 6573 7469 6d61 746f 7273 2061  arn estimators a
-00004f00: 6e64 2061 7265 2073 656c 662d 6f70 7469  nd are self-opti
-00004f10: 6d69 7a69 6e67 2073 696e 6365 2074 6865  mizing since the
-00004f20: 7920 7065 7266 6f72 6d20 6879 7065 722d  y perform hyper-
-00004f30: 7061 7261 6d20 7475 6e69 6e67 2066 6f72  param tuning for
-00004f40: 2065 6163 6820 6b69 6e64 206f 6620 7072   each kind of pr
-00004f50: 6f62 6c65 6d20 616e 6420 7573 6520 7765  oblem and use we
-00004f60: 6967 6874 7320 666f 7220 6561 6368 2063  ights for each c
-00004f70: 6c61 7373 6966 6965 7220 6f72 2072 6567  lassifier or reg
-00004f80: 7265 7373 6f72 2c20 6469 6666 6572 656e  ressor, differen
-00004f90: 7420 7261 6e64 6f6d 2073 6565 6473 2c20  t random seeds, 
-00004fa0: 6574 632e 2074 6f20 6d61 6b65 2074 6865  etc. to make the
-00004fb0: 6d20 6869 6768 6c79 2070 6572 666f 726d  m highly perform
-00004fc0: 616e 742e 204f 6e20 746f 7020 6f66 2069  ant. On top of i
-00004fd0: 742c 2074 6865 7920 6172 6520 6675 6c6c  t, they are full
-00004fe0: 7920 7363 696b 6974 2d6c 6561 726e 2063  y scikit-learn c
-00004ff0: 6f6d 7061 7469 626c 6520 7769 7468 2074  ompatible with t
-00005000: 6865 2073 616d 6520 2266 6974 2061 6e64  he same "fit and
-00005010: 2070 7265 6469 6374 2220 7379 6e74 6178   predict" syntax
-00005020: 2e20 3c2f 6c69 3e0a 2020 2020 2020 2020  . </li>.        
-00005030: 5461 6b65 2061 206c 6f6f 6b20 6174 2074  Take a look at t
-00005040: 6865 2062 656e 6368 6d61 726b 696e 6720  he benchmarking 
-00005050: 7265 7375 6c74 7320 6e6f 7465 626f 6f6b  results notebook
-00005060: 2068 6572 6520 666f 7220 5375 6c6f 436c   here for SuloCl
-00005070: 6173 7369 6669 6572 3a20 0a20 2020 2020  assifier: .     
-00005080: 2020 200a 2020 2020 2020 2020 215b 4e6f     .        ![No
-00005090: 7465 626f 6f6b 5d28 6874 7470 733a 2f2f  tebook](https://
-000050a0: 6769 7468 7562 2e63 6f6d 2f41 7574 6f56  github.com/AutoV
-000050b0: 694d 4c2f 6c61 7a79 7472 616e 7366 6f72  iML/lazytransfor
-000050c0: 6d2f 7472 6565 2f6d 6169 6e2f 6e6f 7465  m/tree/main/note
-000050d0: 626f 6f6b 732f 5375 6c6f 436c 6173 7369  books/SuloClassi
-000050e0: 6669 6572 5f42 656e 6368 6d61 726b 696e  fier_Benchmarkin
-000050f0: 675f 5265 7375 6c74 732e 6970 796e 6229  g_Results.ipynb)
-00005100: 0a20 2020 2020 2020 200a 2020 2020 2020  .        .      
-00005110: 2020 215b 5375 6c6f 436c 6173 7369 6669    ![SuloClassifi
-00005120: 6572 5d28 2e2f 696d 6167 6573 2f53 756c  er](./images/Sul
-00005130: 6f43 6c61 7373 6966 6965 722e 706e 6729  oClassifier.png)
-00005140: 0a20 2020 2020 2020 200a 2020 2020 2020  .        .      
-00005150: 2020 5765 2072 616e 2061 2073 696d 696c    We ran a simil
-00005160: 6172 2062 656e 6368 6d61 726b 696e 6720  ar benchmarking 
-00005170: 7265 7375 6c74 2069 6e20 5375 6c6f 5265  result in SuloRe
-00005180: 6772 6573 736f 7220 6167 6169 6e73 7420  gressor against 
-00005190: 5847 426f 6f73 7420 616e 6420 4c69 6768  XGBoost and Ligh
-000051a0: 7447 424d 2052 6567 7265 7373 6f72 7320  tGBM Regressors 
-000051b0: 616e 6420 6974 2068 656c 6420 6974 7320  and it held its 
-000051c0: 6f77 6e20 6167 6169 6e73 7420 7468 656d  own against them
-000051d0: 2e20 5461 6b65 2061 206c 6f6f 6b20 6174  . Take a look at
-000051e0: 2074 6865 2062 656e 6368 6d61 726b 696e   the benchmarkin
-000051f0: 6720 7265 7375 6c74 3a0a 2020 2020 2020  g result:.      
-00005200: 2020 0a20 2020 2020 2020 2021 5b4e 6f74    .        ![Not
-00005210: 6562 6f6f 6b5d 2868 7474 7073 3a2f 2f67  ebook](https://g
-00005220: 6974 6875 622e 636f 6d2f 4175 746f 5669  ithub.com/AutoVi
-00005230: 4d4c 2f6c 617a 7974 7261 6e73 666f 726d  ML/lazytransform
-00005240: 2f74 7265 652f 6d61 696e 2f6e 6f74 6562  /tree/main/noteb
-00005250: 6f6f 6b73 2f53 756c 6f52 6567 7265 7373  ooks/SuloRegress
-00005260: 6f72 5f42 656e 6368 6d61 726b 696e 675f  or_Benchmarking_
-00005270: 5265 7375 6c74 732e 6970 796e 6229 0a20  Results.ipynb). 
-00005280: 2020 2020 2020 200a 2020 2020 2020 2020         .        
-00005290: 215b 5375 6c6f 5265 6772 6573 736f 725d  ![SuloRegressor]
-000052a0: 282e 2f69 6d61 6765 732f 5375 6c6f 5265  (./images/SuloRe
-000052b0: 6772 6573 736f 722e 706e 6729 0a20 2020  gressor.png).   
-000052c0: 2020 2020 200a 2020 2020 2020 2020 2320       .        # 
-000052d0: 5461 626c 6520 6f66 2043 6f6e 7465 6e74  Table of Content
-000052e0: 730a 2020 2020 2020 2020 3c75 6c3e 0a20  s.        <ul>. 
-000052f0: 2020 2020 2020 203c 6c69 3e3c 6120 6872         <li><a hr
-00005300: 6566 3d22 2369 6e74 726f 6475 6374 696f  ef="#introductio
-00005310: 6e22 3e57 6861 7420 6973 206c 617a 7974  n">What is lazyt
-00005320: 7261 6e73 666f 726d 3c2f 613e 3c2f 6c69  ransform</a></li
-00005330: 3e0a 2020 2020 2020 2020 3c6c 693e 3c61  >.        <li><a
-00005340: 2068 7265 663d 2223 7573 6573 223e 486f   href="#uses">Ho
-00005350: 7720 746f 2075 7365 206c 617a 7974 7261  w to use lazytra
-00005360: 6e73 666f 726d 3c2f 613e 3c2f 6c69 3e0a  nsform</a></li>.
-00005370: 2020 2020 2020 2020 3c6c 693e 3c61 2068          <li><a h
-00005380: 7265 663d 2223 696e 7374 616c 6c22 3e48  ref="#install">H
-00005390: 6f77 2074 6f20 696e 7374 616c 6c20 6c61  ow to install la
-000053a0: 7a79 7472 616e 7366 6f72 6d3c 2f61 3e3c  zytransform</a><
-000053b0: 2f6c 693e 0a20 2020 2020 2020 203c 6c69  /li>.        <li
-000053c0: 3e3c 6120 6872 6566 3d22 2375 7361 6765  ><a href="#usage
-000053d0: 223e 5573 6167 653c 2f61 3e3c 2f6c 693e  ">Usage</a></li>
-000053e0: 0a20 2020 2020 2020 203c 6c69 3e3c 6120  .        <li><a 
-000053f0: 6872 6566 3d22 2361 7069 223e 4150 493c  href="#api">API<
-00005400: 2f61 3e3c 2f6c 693e 0a20 2020 2020 2020  /a></li>.       
-00005410: 203c 6c69 3e3c 6120 6872 6566 3d22 236d   <li><a href="#m
-00005420: 6169 6e74 6169 6e65 7273 223e 4d61 696e  aintainers">Main
-00005430: 7461 696e 6572 733c 2f61 3e3c 2f6c 693e  tainers</a></li>
-00005440: 0a20 2020 2020 2020 203c 6c69 3e3c 6120  .        <li><a 
-00005450: 6872 6566 3d22 2363 6f6e 7472 6962 7574  href="#contribut
-00005460: 696e 6722 3e43 6f6e 7472 6962 7574 696e  ing">Contributin
-00005470: 673c 2f61 3e3c 2f6c 693e 0a20 2020 2020  g</a></li>.     
-00005480: 2020 203c 6c69 3e3c 6120 6872 6566 3d22     <li><a href="
-00005490: 236c 6963 656e 7365 223e 4c69 6365 6e73  #license">Licens
-000054a0: 653c 2f61 3e3c 2f6c 693e 0a20 2020 2020  e</a></li>.     
-000054b0: 2020 203c 2f75 6c3e 0a20 2020 2020 2020     </ul>.       
-000054c0: 203c 703e 0a20 2020 2020 2020 200a 2020   <p>.        .  
-000054d0: 2020 2020 2020 2323 2049 6e74 726f 6475        ## Introdu
-000054e0: 6374 696f 6e0a 2020 2020 2020 2020 2323  ction.        ##
-000054f0: 2320 5768 6174 2069 7320 6c61 7a79 7472  # What is lazytr
-00005500: 616e 7366 6f72 6d3f 0a20 2020 2020 2020  ansform?.       
-00005510: 2060 6c61 7a79 7472 616e 7366 6f72 6d60   `lazytransform`
-00005520: 2069 7320 6120 6e65 7720 7079 7468 6f6e   is a new python
-00005530: 206c 6962 7261 7279 2066 6f72 2061 7574   library for aut
-00005540: 6f6d 6174 6963 616c 6c79 2074 7261 6e73  omatically trans
-00005550: 666f 726d 696e 6720 796f 7572 2065 6e74  forming your ent
-00005560: 6972 6520 6461 7461 7365 7420 746f 206e  ire dataset to n
-00005570: 756d 6572 6963 2066 6f72 6d61 7420 7573  umeric format us
-00005580: 696e 6720 6361 7465 676f 7279 2065 6e63  ing category enc
-00005590: 6f64 6572 732c 204e 4c50 2074 6578 7420  oders, NLP text 
-000055a0: 7665 6374 6f72 697a 6572 7320 616e 6420  vectorizers and 
-000055b0: 7061 6e64 6173 2064 6174 6520 7469 6d65  pandas date time
-000055c0: 2070 726f 6365 7373 696e 6720 6675 6e63   processing func
-000055d0: 7469 6f6e 732e 2041 6c6c 2069 6e20 6120  tions. All in a 
-000055e0: 7369 6e67 6c65 206c 696e 6520 6f66 2063  single line of c
-000055f0: 6f64 6521 0a20 2020 2020 2020 200a 2020  ode!.        .  
-00005600: 2020 2020 2020 3c61 2068 7265 663d 2268        <a href="h
-00005610: 7474 7073 3a2f 2f67 6974 6875 622e 636f  ttps://github.co
-00005620: 6d2f 4175 746f 5669 4d4c 2f6c 617a 7974  m/AutoViML/lazyt
-00005630: 7261 6e73 666f 726d 223e 3c69 6d67 2073  ransform"><img s
-00005640: 7263 3d22 6874 7470 733a 2f2f 692e 6962  rc="https://i.ib
-00005650: 622e 636f 2f6e 7a59 7873 386b 2f6c 617a  b.co/nzYxs8k/laz
-00005660: 7974 7261 6e73 666f 726d 6572 2e70 6e67  ytransformer.png
-00005670: 2220 616c 743d 226c 617a 7974 7261 6e73  " alt="lazytrans
-00005680: 666f 726d 6572 2220 626f 7264 6572 3d22  former" border="
-00005690: 3022 3e3c 2f61 3e0a 2020 2020 2020 2020  0"></a>.        
-000056a0: 0a20 2020 2020 2020 2023 2320 5573 6573  .        ## Uses
-000056b0: 0a20 2020 2020 2020 2060 6c61 7a79 7472  .        `lazytr
-000056c0: 616e 7366 6f72 6d60 2068 6173 2074 776f  ansform` has two
-000056d0: 2069 6d70 6f72 7461 6e74 2075 7365 7320   important uses 
-000056e0: 696e 2074 6865 2044 6174 6120 5363 6965  in the Data Scie
-000056f0: 6e63 6520 7072 6f63 6573 732e 2049 7420  nce process. It 
-00005700: 6361 6e20 6265 2075 7365 6420 696e 2046  can be used in F
-00005710: 6561 7475 7265 2045 6e67 6720 746f 2074  eature Engg to t
-00005720: 7261 6e73 666f 726d 2066 6561 7475 7265  ransform feature
-00005730: 7320 6f72 2061 6464 2066 6561 7475 7265  s or add feature
-00005740: 7320 2873 6565 2041 5049 2062 656c 6f77  s (see API below
-00005750: 292e 2049 7420 6361 6e20 616c 736f 2062  ). It can also b
-00005760: 6520 7573 6564 2069 6e20 4d4c 4f70 7320  e used in MLOps 
-00005770: 746f 2074 7261 696e 2061 6e64 2065 7661  to train and eva
-00005780: 6c75 6174 6520 6d6f 6465 6c73 2069 6e20  luate models in 
-00005790: 6461 7461 2070 6970 656c 696e 6573 2077  data pipelines w
-000057a0: 6974 6820 6d75 6c74 6970 6c65 206d 6f64  ith multiple mod
-000057b0: 656c 7320 6265 696e 6720 7472 6169 6e65  els being traine
-000057c0: 6420 7369 6d75 6c74 616e 6575 736c 7920  d simultaneusly 
-000057d0: 7573 696e 6720 7468 6520 7361 6d65 2074  using the same t
-000057e0: 7261 696e 2f74 6573 7420 7370 6c69 7420  rain/test split 
-000057f0: 616e 6420 7468 6520 7361 6d65 2066 6561  and the same fea
-00005800: 7475 7265 2065 6e67 6720 7374 6570 732e  ture engg steps.
-00005810: 2054 6869 7320 656e 7375 7265 7320 7468   This ensures th
-00005820: 6174 2074 6865 7265 2069 7320 6162 736f  at there is abso
-00005830: 6c75 7465 6c79 207a 6572 6f20 6f72 206d  lutely zero or m
-00005840: 696e 696d 616c 2064 6174 6120 6c65 616b  inimal data leak
-00005850: 6167 6520 696e 2079 6f75 7220 4d4c 4f70  age in your MLOp
-00005860: 7320 7069 7065 6c69 6e65 732e 0a20 2020  s pipelines..   
-00005870: 2020 2020 200a 2020 2020 2020 2020 2323       .        ##
-00005880: 2320 312e 2020 5573 696e 6720 6c61 7a79  # 1.  Using lazy
-00005890: 7472 616e 7366 6f72 6d20 6173 2061 2073  transform as a s
-000058a0: 696d 706c 6520 7061 6e64 6173 2064 6174  imple pandas dat
-000058b0: 6120 7472 616e 7366 6f72 6d61 7469 6f6e  a transformation
-000058c0: 2070 6970 656c 696e 6520 0a20 2020 2020   pipeline .     
-000058d0: 2020 200a 2020 2020 2020 2020 3c70 3e54     .        <p>T
-000058e0: 6865 2066 6972 7374 206d 6574 686f 6420  he first method 
-000058f0: 6973 2070 726f 6261 626c 7920 7468 6520  is probably the 
-00005900: 6d6f 7374 2070 6f70 756c 6172 2077 6179  most popular way
-00005910: 2074 6f20 7573 6520 6c61 7a79 7472 616e   to use lazytran
-00005920: 7366 6f72 6d2e 2054 6865 2074 7261 6e73  sform. The trans
-00005930: 666f 726d 6572 2077 6974 6869 6e20 6c61  former within la
-00005940: 7a79 7472 616e 7366 6f72 6d20 6361 6e20  zytransform can 
-00005950: 6265 2075 7365 6420 746f 2074 7261 6e73  be used to trans
-00005960: 666f 726d 2061 6e64 2063 7265 6174 6520  form and create 
-00005970: 6e65 7720 6665 6174 7572 6573 2066 726f  new features fro
-00005980: 6d20 6361 7465 676f 7269 6361 6c2c 2064  m categorical, d
-00005990: 6174 652d 7469 6d65 2061 6e64 204e 4c50  ate-time and NLP
-000059a0: 2028 7465 7874 2920 6665 6174 7572 6573   (text) features
-000059b0: 2069 6e20 796f 7572 2064 6174 6173 6574   in your dataset
-000059c0: 2e20 5468 6973 2074 7261 6e73 666f 726d  . This transform
-000059d0: 6572 2070 6970 656c 696e 6520 6973 2066  er pipeline is f
-000059e0: 756c 6c79 2073 6369 6b69 742d 6c65 6172  ully scikit-lear
-000059f0: 6e20 5069 7065 6c69 6e65 2063 6f6d 7061  n Pipeline compa
-00005a00: 7469 626c 6520 616e 6420 6361 6e20 6265  tible and can be
-00005a10: 2075 7365 6420 746f 2062 7569 6c64 2065   used to build e
-00005a20: 7665 6e20 6d6f 7265 2063 6f6d 706c 6578  ven more complex
-00005a30: 2070 6970 656c 696e 6573 2062 7920 796f   pipelines by yo
-00005a40: 7520 6261 7365 6420 6f6e 2060 6d61 6b65  u based on `make
-00005a50: 5f70 6970 656c 696e 6560 2073 7461 7465  _pipeline` state
-00005a60: 6d65 6e74 2066 726f 6d20 6073 6b6c 6561  ment from `sklea
-00005a70: 726e 2e70 6970 656c 696e 6560 206c 6962  rn.pipeline` lib
-00005a80: 7261 7279 2e20 3c61 2068 7265 663d 2268  rary. <a href="h
-00005a90: 7474 7073 3a2f 2f67 6974 6875 622e 636f  ttps://github.co
-00005aa0: 6d2f 4175 746f 5669 4d4c 2f6c 617a 7974  m/AutoViML/lazyt
-00005ab0: 7261 6e73 666f 726d 2f62 6c6f 622f 6d61  ransform/blob/ma
-00005ac0: 696e 2f46 6561 7475 7265 7769 7a5f 4c61  in/Featurewiz_La
-00005ad0: 7a79 5472 616e 7366 6f72 6d5f 4465 6d6f  zyTransform_Demo
-00005ae0: 312e 6970 796e 6222 3e4c 6574 2075 7320  1.ipynb">Let us 
-00005af0: 7365 6520 616e 2065 7861 6d70 6c65 3c2f  see an example</
-00005b00: 613e 3a3c 703e 0a20 2020 2020 2020 200a  a>:<p>.        .
-00005b10: 2020 2020 2020 2020 3c61 2068 7265 663d          <a href=
-00005b20: 2268 7474 7073 3a2f 2f69 6262 2e63 6f2f  "https://ibb.co/
-00005b30: 7866 4d51 6e4e 7a22 3e3c 696d 6720 7372  xfMQnNz"><img sr
-00005b40: 633d 2268 7474 7073 3a2f 2f69 2e69 6262  c="https://i.ibb
-00005b50: 2e63 6f2f 5a59 6843 5130 632f 6c61 7a79  .co/ZYhCQ0c/lazy
-00005b60: 2d63 6f64 6531 2e70 6e67 2220 616c 743d  -code1.png" alt=
-00005b70: 226c 617a 792d 636f 6465 3122 2062 6f72  "lazy-code1" bor
-00005b80: 6465 723d 2230 223e 3c2f 613e 0a20 2020  der="0"></a>.   
-00005b90: 2020 2020 200a 2020 2020 2020 2020 2323       .        ##
-00005ba0: 2320 322e 2020 5573 696e 6720 6c61 7a79  # 2.  Using lazy
-00005bb0: 7472 616e 7366 6f72 6d20 6173 2061 2073  transform as a s
-00005bc0: 6b6c 6561 726e 2070 6970 656c 696e 6520  klearn pipeline 
-00005bd0: 7769 7468 2073 6b6c 6561 726e 206d 6f64  with sklearn mod
-00005be0: 656c 7320 6f72 2058 4742 6f6f 7374 206f  els or XGBoost o
-00005bf0: 7220 4c69 6768 7447 424d 206d 6f64 656c  r LightGBM model
-00005c00: 730a 2020 2020 2020 2020 0a20 2020 2020  s.        .     
-00005c10: 2020 203c 703e 5468 6520 7365 636f 6e64     <p>The second
-00005c20: 206d 6574 686f 6420 6973 2061 2067 7265   method is a gre
-00005c30: 6174 2077 6179 2074 6f20 6372 6561 7465  at way to create
-00005c40: 2061 6e20 656e 7469 7265 2064 6174 6120   an entire data 
-00005c50: 7472 616e 7366 6f72 6d20 616e 6420 6d6f  transform and mo
-00005c60: 6465 6c20 7472 6169 6e69 6e67 2070 6970  del training pip
-00005c70: 656c 696e 6520 7769 7468 2061 6273 6f6c  eline with absol
-00005c80: 7574 656c 7920 6e6f 2064 6174 6120 6c65  utely no data le
-00005c90: 616b 6167 652e 2060 6c61 7a79 7472 616e  akage. `lazytran
-00005ca0: 7366 6f72 6d60 2061 6c6c 6f77 7320 796f  sform` allows yo
-00005cb0: 7520 746f 2073 656e 6420 696e 2061 206d  u to send in a m
-00005cc0: 6f64 656c 206f 626a 6563 7420 286f 6e6c  odel object (onl
-00005cd0: 7920 7468 6520 666f 6c6c 6f77 696e 6720  y the following 
-00005ce0: 6172 6520 7375 7070 6f72 7465 6429 2061  are supported) a
-00005cf0: 6e64 2069 7420 7769 6c6c 2061 7574 6f6d  nd it will autom
-00005d00: 6174 6963 616c 6c79 2074 7261 6e73 666f  atically transfo
-00005d10: 726d 2c20 6372 6561 7465 206e 6577 2066  rm, create new f
-00005d20: 6561 7475 7265 7320 616e 6420 7472 6169  eatures and trai
-00005d30: 6e20 6120 6d6f 6465 6c20 7573 696e 6720  n a model using 
-00005d40: 736b 6c65 6172 6e20 7069 7065 6c69 6e65  sklearn pipeline
-00005d50: 732e 203c 6120 6872 6566 3d22 6874 7470  s. <a href="http
-00005d60: 733a 2f2f 6769 7468 7562 2e63 6f6d 2f41  s://github.com/A
-00005d70: 7574 6f56 694d 4c2f 6c61 7a79 7472 616e  utoViML/lazytran
-00005d80: 7366 6f72 6d2f 626c 6f62 2f6d 6169 6e2f  sform/blob/main/
-00005d90: 4665 6174 7572 6577 697a 5f4c 617a 7954  Featurewiz_LazyT
-00005da0: 7261 6e73 666f 726d 5f44 656d 6f32 2e69  ransform_Demo2.i
-00005db0: 7079 6e62 223e 5468 6973 206d 6574 686f  pynb">This metho
-00005dc0: 6420 6361 6e20 6265 2073 6565 6e20 6173  d can be seen as
-00005dd0: 2066 6f6c 6c6f 7773 3c2f 613e 3a3c 6272   follows</a>:<br
-00005de0: 3e0a 2020 2020 2020 2020 0a20 2020 2020  >.        .     
-00005df0: 2020 203c 6120 6872 6566 3d22 6874 7470     <a href="http
-00005e00: 733a 2f2f 6962 622e 636f 2f54 3157 4e68  s://ibb.co/T1WNh
-00005e10: 7a54 223e 3c69 6d67 2073 7263 3d22 6874  zT"><img src="ht
-00005e20: 7470 733a 2f2f 692e 6962 622e 636f 2f30  tps://i.ibb.co/0
-00005e30: 4b73 7a4a 5058 2f6c 617a 792d 636f 6465  KszJPX/lazy-code
-00005e40: 322e 706e 6722 2061 6c74 3d22 6c61 7a79  2.png" alt="lazy
-00005e50: 2d63 6f64 6532 2220 626f 7264 6572 3d22  -code2" border="
-00005e60: 3022 3e3c 2f61 3e0a 2020 2020 2020 2020  0"></a>.        
-00005e70: 0a20 2020 2020 2020 2023 2323 2033 2e20  .        ### 3. 
-00005e80: 2055 7369 6e67 206c 617a 7974 7261 6e73   Using lazytrans
-00005e90: 666f 726d 2069 6e20 4772 6964 5365 6172  form in GridSear
-00005ea0: 6368 4356 2074 6f20 6669 6e64 2074 6865  chCV to find the
-00005eb0: 2062 6573 7420 6d6f 6465 6c20 7069 7065   best model pipe
-00005ec0: 6c69 6e65 0a20 2020 2020 2020 203c 703e  line.        <p>
-00005ed0: 5468 6520 7468 6972 6420 6d65 7468 6f64  The third method
-00005ee0: 2069 7320 6120 6772 6561 7420 7761 7920   is a great way 
-00005ef0: 746f 2066 696e 6420 7468 6520 6265 7374  to find the best
-00005f00: 2064 6174 6120 7472 616e 7366 6f72 6d61   data transforma
-00005f10: 7469 6f6e 2061 6e64 206d 6f64 656c 2074  tion and model t
-00005f20: 7261 696e 696e 6720 7069 7065 6c69 6e65  raining pipeline
-00005f30: 2075 7369 6e67 2047 7269 6453 6561 7263   using GridSearc
-00005f40: 6843 5620 6f72 2052 616e 646f 6d69 7a65  hCV or Randomize
-00005f50: 6453 6561 7263 6843 5620 616c 6f6e 6720  dSearchCV along 
-00005f60: 7769 7468 2061 204c 6967 6874 4742 4d20  with a LightGBM 
-00005f70: 6f72 2058 4742 6f6f 7374 206f 7220 7363  or XGBoost or sc
-00005f80: 696b 6974 2d6c 6561 726e 206d 6f64 656c  ikit-learn model
-00005f90: 2e20 5468 6973 2069 7320 6578 706c 6169  . This is explai
-00005fa0: 6e65 6420 7665 7279 2063 6c65 6172 6c79  ned very clearly
-00005fb0: 2069 6e20 7468 6520 3c61 2068 7265 663d   in the <a href=
-00005fc0: 2268 7474 7073 3a2f 2f67 6974 6875 622e  "https://github.
-00005fd0: 636f 6d2f 4175 746f 5669 4d4c 2f6c 617a  com/AutoViML/laz
-00005fe0: 7974 7261 6e73 666f 726d 2f62 6c6f 622f  ytransform/blob/
-00005ff0: 6d61 696e 2f4c 617a 7954 7261 6e73 666f  main/LazyTransfo
-00006000: 726d 6572 5f77 6974 685f 4772 6964 5365  rmer_with_GridSe
-00006010: 6172 6368 5f50 6970 656c 696e 652e 6970  arch_Pipeline.ip
-00006020: 796e 6222 3e4c 617a 7954 7261 6e73 666f  ynb">LazyTransfo
-00006030: 726d 6572 5f77 6974 685f 4772 6964 5365  rmer_with_GridSe
-00006040: 6172 6368 5f50 6970 656c 696e 652e 6970  arch_Pipeline.ip
-00006050: 796e 623c 2f61 3e20 6e6f 7465 626f 6f6b  ynb</a> notebook
-00006060: 2069 6e20 7468 6520 7361 6d65 2067 6974   in the same git
-00006070: 6875 6220 6865 7265 2e20 4d61 6b65 2073  hub here. Make s
-00006080: 7572 6520 796f 7520 6368 6563 6b20 6974  ure you check it
-00006090: 206f 7574 210a 2020 2020 2020 2020 0a20   out!.        . 
-000060a0: 2020 2020 2020 203c 6120 6872 6566 3d22         <a href="
-000060b0: 6874 7470 733a 2f2f 6962 622e 636f 2f57  https://ibb.co/W
-000060c0: 4776 6e71 6a73 223e 3c69 6d67 2073 7263  Gvnqjs"><img src
-000060d0: 3d22 6874 7470 733a 2f2f 692e 6962 622e  ="https://i.ibb.
-000060e0: 636f 2f78 5871 6850 6433 2f6c 617a 792d  co/xXqhPd3/lazy-
-000060f0: 6772 6964 7365 6172 6368 2e70 6e67 2220  gridsearch.png" 
-00006100: 616c 743d 226c 617a 792d 6772 6964 7365  alt="lazy-gridse
-00006110: 6172 6368 2220 626f 7264 6572 3d22 3022  arch" border="0"
-00006120: 3e3c 2f61 3e3c 6272 202f 3e0a 2020 2020  ></a><br />.    
-00006130: 2020 2020 0a20 2020 2020 2020 203c 703e      .        <p>
-00006140: 0a20 2020 2020 2020 2054 6865 2066 6f6c  .        The fol
-00006150: 6c6f 7769 6e67 206d 6f64 656c 7320 6172  lowing models ar
-00006160: 6520 6375 7272 656e 746c 7920 7375 7070  e currently supp
-00006170: 6f72 7465 643a 0a20 2020 2020 2020 203c  orted:.        <
-00006180: 6f6c 3e0a 2020 2020 2020 2020 3c6c 693e  ol>.        <li>
-00006190: 416c 6c20 736b 6c65 6172 6e20 6d6f 6465  All sklearn mode
-000061a0: 6c73 3c2f 6c69 3e0a 2020 2020 2020 2020  ls</li>.        
-000061b0: 3c6c 693e 416c 6c20 4d75 6c74 694f 7574  <li>All MultiOut
-000061c0: 7075 7420 6d6f 6465 6c73 2066 726f 6d20  put models from 
-000061d0: 736b 6c65 6172 6e2e 6d75 6c74 696f 7574  sklearn.multiout
-000061e0: 7075 7420 6c69 6272 6172 793c 2f6c 693e  put library</li>
-000061f0: 0a20 2020 2020 2020 203c 6c69 3e58 4762  .        <li>XGb
-00006200: 6f6f 7374 206d 6f64 656c 733c 2f6c 693e  oost models</li>
-00006210: 0a20 2020 2020 2020 203c 6c69 3e4c 6967  .        <li>Lig
-00006220: 6874 4742 4d20 6d6f 6465 6c73 3c2f 6c69  htGBM models</li
-00006230: 3e0a 2020 2020 2020 2020 3c2f 6f6c 3e0a  >.        </ol>.
-00006240: 2020 2020 2020 2020 486f 7765 7665 722c          However,
-00006250: 2079 6f75 206d 7573 7420 696e 7374 616c   you must instal
-00006260: 6c20 616e 6420 696d 706f 7274 2074 686f  l and import tho
-00006270: 7365 206d 6f64 656c 7320 6f6e 2079 6f75  se models on you
-00006280: 7220 6f77 6e20 616e 6420 6465 6669 6e65  r own and define
-00006290: 2074 6865 6d20 6173 206d 6f64 656c 2076   them as model v
-000062a0: 6172 6961 626c 6573 2062 6566 6f72 6520  ariables before 
-000062b0: 7061 7373 696e 6720 7468 6f73 6520 7661  passing those va
-000062c0: 7269 6162 6c65 7320 746f 206c 617a 7974  riables to lazyt
-000062d0: 7261 6e73 666f 726d 2e0a 2020 2020 2020  ransform..      
-000062e0: 2020 0a20 2020 2020 2020 2023 2320 496e    .        ## In
-000062f0: 7374 616c 6c0a 2020 2020 2020 2020 3c70  stall.        <p
-00006300: 3e0a 2020 2020 2020 2020 0a20 2020 2020  >.        .     
-00006310: 2020 202a 2a50 7265 7265 7175 7369 7465     **Prerequsite
-00006320: 733a 2a2a 0a20 2020 2020 2020 203c 6f6c  s:**.        <ol
-00006330: 3e0a 2020 2020 2020 2020 3c6c 693e 3c62  >.        <li><b
-00006340: 3e6c 617a 7974 7261 6e73 666f 726d 2069  >lazytransform i
-00006350: 7320 6275 696c 7420 7573 696e 6720 7061  s built using pa
-00006360: 6e64 6173 2c20 6e75 6d70 792c 2073 6369  ndas, numpy, sci
-00006370: 6b69 742d 6c65 6172 6e2c 2063 6174 6567  kit-learn, categ
-00006380: 6f72 795f 656e 636f 6465 7273 2061 6e64  ory_encoders and
-00006390: 2069 6d62 616c 616e 6365 642d 6c65 6172   imbalanced-lear
-000063a0: 6e20 6c69 6272 6172 6965 732e 3c2f 623e  n libraries.</b>
-000063b0: 2049 7420 7368 6f75 6c64 2072 756e 206f   It should run o
-000063c0: 6e20 6d6f 7374 2050 7974 686f 6e33 2041  n most Python3 A
-000063d0: 6e61 636f 6e64 6120 696e 7374 616c 6c61  naconda installa
-000063e0: 7469 6f6e 7320 7769 7468 6f75 7420 6164  tions without ad
-000063f0: 6469 7469 6f6e 616c 2069 6e73 7461 6c6c  ditional install
-00006400: 732e 2059 6f75 2077 6f6e 2774 2068 6176  s. You won't hav
-00006410: 6520 746f 2069 6d70 6f72 7420 616e 7920  e to import any 
-00006420: 7370 6563 6961 6c20 6c69 6272 6172 6965  special librarie
-00006430: 7320 6f74 6865 7220 7468 616e 2022 696d  s other than "im
-00006440: 6261 6c61 6e63 6564 2d6c 6561 726e 2220  balanced-learn" 
-00006450: 616e 6420 2263 6174 6567 6f72 795f 656e  and "category_en
-00006460: 636f 6465 7273 222e 3c2f 6c69 3e0a 2020  coders".</li>.  
-00006470: 2020 2020 2020 3c2f 6f6c 3e0a 2020 2020        </ol>.    
-00006480: 2020 2020 5468 6520 6265 7374 206d 6574      The best met
-00006490: 686f 6420 746f 2069 6e73 7461 6c6c 206c  hod to install l
-000064a0: 617a 7974 7261 6e73 666f 726d 2069 7320  azytransform is 
-000064b0: 746f 2075 7365 2063 6f6e 6461 3a3c 703e  to use conda:<p>
-000064c0: 0a20 2020 2020 2020 200a 2020 2020 2020  .        .      
-000064d0: 2020 6060 600a 2020 2020 2020 2020 636f    ```.        co
-000064e0: 6e64 6120 696e 7374 616c 6c20 2d63 2063  nda install -c c
-000064f0: 6f6e 6461 2d66 6f72 6765 206c 617a 7974  onda-forge lazyt
-00006500: 7261 6e73 666f 726d 0a20 2020 2020 2020  ransform.       
-00006510: 2060 6060 0a20 2020 2020 2020 203c 6120   ```.        <a 
-00006520: 6872 6566 3d22 6874 7470 733a 2f2f 6962  href="https://ib
-00006530: 622e 636f 2f66 586e 6250 6436 223e 3c69  b.co/fXnbPd6"><i
-00006540: 6d67 2073 7263 3d22 6874 7470 733a 2f2f  mg src="https://
-00006550: 692e 6962 622e 636f 2f71 4457 7a50 5971  i.ibb.co/qDWzPYq
-00006560: 2f63 6f6e 6461 2d69 6e73 7461 6c6c 2e70  /conda-install.p
-00006570: 6e67 2220 616c 743d 2263 6f6e 6461 2d69  ng" alt="conda-i
-00006580: 6e73 7461 6c6c 2220 626f 7264 6572 3d22  nstall" border="
-00006590: 3022 3e3c 2f61 3e3c 6272 3e0a 2020 2020  0"></a><br>.    
-000065a0: 2020 2020 5468 6520 7365 636f 6e64 2062      The second b
-000065b0: 6573 7420 696e 7374 616c 6c61 7469 6f6e  est installation
-000065c0: 206d 6574 686f 6420 6973 2074 6f20 7573   method is to us
-000065d0: 6520 2270 6970 2069 6e73 7461 6c6c 222e  e "pip install".
-000065e0: 0a20 2020 2020 2020 200a 2020 2020 2020  .        .      
-000065f0: 2020 6060 600a 2020 2020 2020 2020 7069    ```.        pi
-00006600: 7020 696e 7374 616c 6c20 6c61 7a79 7472  p install lazytr
-00006610: 616e 7366 6f72 6d20 0a20 2020 2020 2020  ansform .       
-00006620: 2060 6060 0a20 2020 2020 2020 2041 6c65   ```.        Ale
-00006630: 7274 2120 5768 656e 2075 7369 6e67 2043  rt! When using C
-00006640: 6f6c 6162 206f 7220 4b61 6767 6c65 204e  olab or Kaggle N
-00006650: 6f74 6562 6f6f 6b73 2c20 796f 7520 6d75  otebooks, you mu
-00006660: 7374 2075 7365 2061 2073 6c69 6768 746c  st use a slightl
-00006670: 7920 6d6f 6469 6679 2069 6e73 7461 6c6c  y modify install
-00006680: 6174 696f 6e20 7072 6f63 6573 7320 6265  ation process be
-00006690: 6c6f 772e 2049 6620 796f 7520 646f 6e27  low. If you don'
-000066a0: 7420 646f 2074 6869 732c 2079 6f75 2077  t do this, you w
-000066b0: 696c 6c20 6765 7420 7765 6972 6420 6572  ill get weird er
-000066c0: 726f 7273 2069 6e20 7468 6f73 6520 706c  rors in those pl
-000066d0: 6174 666f 726d 7321 0a20 2020 2020 2020  atforms!.       
-000066e0: 200a 2020 2020 2020 2020 6060 600a 2020   .        ```.  
-000066f0: 2020 2020 2020 7069 7020 696e 7374 616c        pip instal
-00006700: 6c20 6c61 7a79 7472 616e 7366 6f72 6d20  l lazytransform 
-00006710: 2d2d 6967 6e6f 7265 2d69 6e73 7461 6c6c  --ignore-install
-00006720: 6564 202d 2d6e 6f2d 6465 7073 0a20 2020  ed --no-deps.   
-00006730: 2020 2020 2070 6970 2069 6e73 7461 6c6c       pip install
-00006740: 2063 6174 6567 6f72 792d 656e 636f 6465   category-encode
-00006750: 7273 202d 2d69 676e 6f72 652d 696e 7374  rs --ignore-inst
-00006760: 616c 6c65 6420 2d2d 6e6f 2d64 6570 730a  alled --no-deps.
-00006770: 2020 2020 2020 2020 0a20 2020 2020 2020          .       
-00006780: 2060 6060 0a20 2020 2020 2020 200a 2020   ```.        .  
-00006790: 2020 2020 2020 546f 2069 6e73 7461 6c6c        To install
-000067a0: 2066 726f 6d20 736f 7572 6365 3a0a 2020   from source:.  
-000067b0: 2020 2020 2020 0a20 2020 2020 2020 2060        .        `
-000067c0: 6060 0a20 2020 2020 2020 2063 6420 3c6c  ``.        cd <l
-000067d0: 617a 7974 7261 6e73 666f 726d 5f44 6573  azytransform_Des
-000067e0: 7469 6e61 7469 6f6e 3e0a 2020 2020 2020  tination>.      
-000067f0: 2020 6769 7420 636c 6f6e 6520 6769 7440    git clone git@
-00006800: 6769 7468 7562 2e63 6f6d 3a41 7574 6f56  github.com:AutoV
-00006810: 694d 4c2f 6c61 7a79 7472 616e 7366 6f72  iML/lazytransfor
-00006820: 6d2e 6769 740a 2020 2020 2020 2020 6060  m.git.        ``
-00006830: 600a 2020 2020 2020 2020 6f72 2064 6f77  `.        or dow
-00006840: 6e6c 6f61 6420 616e 6420 756e 7a69 7020  nload and unzip 
-00006850: 6874 7470 733a 2f2f 6769 7468 7562 2e63  https://github.c
-00006860: 6f6d 2f41 7574 6f56 694d 4c2f 6c61 7a79  om/AutoViML/lazy
-00006870: 7472 616e 7366 6f72 6d2f 6172 6368 6976  transform/archiv
-00006880: 652f 6d61 7374 6572 2e7a 6970 0a20 2020  e/master.zip.   
-00006890: 2020 2020 2060 6060 0a20 2020 2020 2020       ```.       
-000068a0: 2063 6f6e 6461 2063 7265 6174 6520 2d6e   conda create -n
-000068b0: 203c 796f 7572 5f65 6e76 5f6e 616d 653e   <your_env_name>
-000068c0: 2070 7974 686f 6e3d 332e 3720 616e 6163   python=3.7 anac
-000068d0: 6f6e 6461 0a20 2020 2020 2020 2063 6f6e  onda.        con
-000068e0: 6461 2061 6374 6976 6174 6520 3c79 6f75  da activate <you
-000068f0: 725f 656e 765f 6e61 6d65 3e20 2320 4f4e  r_env_name> # ON
-00006900: 2057 494e 444f 5753 3a20 6073 6f75 7263   WINDOWS: `sourc
-00006910: 6520 6163 7469 7661 7465 203c 796f 7572  e activate <your
-00006920: 5f65 6e76 5f6e 616d 653e 600a 2020 2020  _env_name>`.    
-00006930: 2020 2020 6364 206c 617a 7974 7261 6e73      cd lazytrans
-00006940: 666f 726d 0a20 2020 2020 2020 2070 6970  form.        pip
-00006950: 2069 6e73 7461 6c6c 202d 7220 7265 7175   install -r requ
-00006960: 6972 656d 656e 7473 2e74 7874 0a20 2020  irements.txt.   
-00006970: 2020 2020 2060 6060 0a20 2020 2020 2020       ```.       
-00006980: 200a 2020 2020 2020 2020 2323 2055 7361   .        ## Usa
-00006990: 6765 0a20 2020 2020 2020 203c 703e 0a20  ge.        <p>. 
-000069a0: 2020 2020 2020 2059 6f75 2063 616e 2069         You can i
-000069b0: 6e76 6f6b 6520 606c 617a 7974 7261 6e73  nvoke `lazytrans
-000069c0: 666f 726d 6020 6173 2061 2073 6369 6b69  form` as a sciki
-000069d0: 742d 6c65 6172 6e20 636f 6d70 6174 6962  t-learn compatib
-000069e0: 6c65 2066 6974 2061 6e64 2074 7261 6e73  le fit and trans
-000069f0: 666f 726d 206f 7220 6120 6669 7420 616e  form or a fit an
-00006a00: 6420 7072 6564 6963 7420 7069 7065 6c69  d predict pipeli
-00006a10: 6e65 2e20 5365 6520 7379 6e74 6178 2062  ne. See syntax b
-00006a20: 656c 6f77 2e3c 703e 0a20 2020 2020 2020  elow.<p>.       
-00006a30: 200a 2020 2020 2020 2020 6060 600a 2020   .        ```.  
-00006a40: 2020 2020 2020 6672 6f6d 206c 617a 7974        from lazyt
-00006a50: 7261 6e73 666f 726d 2069 6d70 6f72 7420  ransform import 
-00006a60: 4c61 7a79 5472 616e 7366 6f72 6d65 720a  LazyTransformer.
-00006a70: 2020 2020 2020 2020 6c61 7a79 203d 204c          lazy = L
-00006a80: 617a 7954 7261 6e73 666f 726d 6572 286d  azyTransformer(m
-00006a90: 6f64 656c 3d4e 6f6e 652c 2065 6e63 6f64  odel=None, encod
-00006aa0: 6572 733d 2761 7574 6f27 2c20 7363 616c  ers='auto', scal
-00006ab0: 6572 733d 4e6f 6e65 2c20 0a20 2020 2020  ers=None, .     
-00006ac0: 2020 2020 2020 2020 2020 2064 6174 655f             date_
-00006ad0: 746f 5f73 7472 696e 673d 4661 6c73 652c  to_string=False,
-00006ae0: 2074 7261 6e73 666f 726d 5f74 6172 6765   transform_targe
-00006af0: 743d 4661 6c73 652c 2069 6d62 616c 616e  t=False, imbalan
-00006b00: 6365 643d 4661 6c73 652c 0a20 2020 2020  ced=False,.     
-00006b10: 2020 2020 2020 2020 2020 2063 6f6d 6269             combi
-00006b20: 6e65 5f72 6172 653d 4661 6c73 652c 2076  ne_rare=False, v
-00006b30: 6572 626f 7365 3d30 290a 2020 2020 2020  erbose=0).      
-00006b40: 2020 6060 600a 2020 2020 2020 2020 0a20    ```.        . 
-00006b50: 2020 2020 2020 2023 2323 2069 6620 796f         ### if yo
-00006b60: 7520 6172 6520 6e6f 7420 7573 696e 6720  u are not using 
-00006b70: 6120 6d6f 6465 6c20 696e 2070 6970 656c  a model in pipel
-00006b80: 696e 652c 2079 6f75 206d 7573 7420 7573  ine, you must us
-00006b90: 6520 6669 7420 616e 6420 7472 616e 7366  e fit and transf
-00006ba0: 6f72 6d0a 2020 2020 2020 2020 6060 600a  orm.        ```.
-00006bb0: 2020 2020 2020 2020 585f 7472 6169 6e6d          X_trainm
-00006bc0: 2c20 795f 7472 6169 6e6d 203d 206c 617a  , y_trainm = laz
-00006bd0: 792e 6669 745f 7472 616e 7366 6f72 6d28  y.fit_transform(
-00006be0: 585f 7472 6169 6e2c 2079 5f74 7261 696e  X_train, y_train
-00006bf0: 290a 2020 2020 2020 2020 585f 7465 7374  ).        X_test
-00006c00: 6d20 3d20 6c61 7a79 2e74 7261 6e73 666f  m = lazy.transfo
-00006c10: 726d 2858 5f74 6573 7429 0a20 2020 2020  rm(X_test).     
-00006c20: 2020 2060 6060 0a20 2020 2020 2020 2023     ```.        #
-00006c30: 2323 2049 6620 796f 7520 6172 6520 7573  ## If you are us
-00006c40: 696e 6720 6120 6d6f 6465 6c20 696e 2070  ing a model in p
-00006c50: 6970 656c 696e 652c 2075 7365 206d 7573  ipeline, use mus
-00006c60: 7420 7573 6520 6669 7420 616e 6420 7072  t use fit and pr
-00006c70: 6564 6963 7420 6f6e 6c79 0a20 2020 2020  edict only.     
-00006c80: 2020 2060 6060 0a20 2020 2020 2020 206c     ```.        l
-00006c90: 617a 7920 3d20 4c61 7a79 5472 616e 7366  azy = LazyTransf
-00006ca0: 6f72 6d65 7228 6d6f 6465 6c3d 5261 6e64  ormer(model=Rand
-00006cb0: 6f6d 466f 7265 7374 436c 6173 7369 6669  omForestClassifi
-00006cc0: 6572 2829 2c20 656e 636f 6465 7273 3d27  er(), encoders='
-00006cd0: 6175 746f 272c 2073 6361 6c65 7273 3d4e  auto', scalers=N
-00006ce0: 6f6e 652c 200a 2020 2020 2020 2020 2020  one, .          
-00006cf0: 2020 2020 2020 6461 7465 5f74 6f5f 7374        date_to_st
-00006d00: 7269 6e67 3d46 616c 7365 2c20 7472 616e  ring=False, tran
-00006d10: 7366 6f72 6d5f 7461 7267 6574 3d46 616c  sform_target=Fal
-00006d20: 7365 2c20 696d 6261 6c61 6e63 6564 3d46  se, imbalanced=F
-00006d30: 616c 7365 2c0a 2020 2020 2020 2020 2020  alse,.          
-00006d40: 2020 2020 2020 636f 6d62 696e 655f 7261        combine_ra
-00006d50: 7265 3d46 616c 7365 2c20 7665 7262 6f73  re=False, verbos
-00006d60: 653d 3029 0a20 2020 2020 2020 2060 6060  e=0).        ```
-00006d70: 0a20 2020 2020 2020 200a 2020 2020 2020  .        .      
-00006d80: 2020 6060 600a 2020 2020 2020 2020 6c61    ```.        la
-00006d90: 7a79 2e66 6974 2858 5f74 7261 696e 2c20  zy.fit(X_train, 
-00006da0: 795f 7472 6169 6e29 0a20 2020 2020 2020  y_train).       
-00006db0: 206c 617a 792e 7072 6564 6963 7428 585f   lazy.predict(X_
-00006dc0: 7465 7374 290a 2020 2020 2020 2020 6060  test).        ``
-00006dd0: 600a 2020 2020 2020 2020 0a20 2020 2020  `.        .     
-00006de0: 2020 2023 2320 4150 490a 2020 2020 2020     ## API.      
-00006df0: 2020 0a20 2020 2020 2020 203c 703e 0a20    .        <p>. 
-00006e00: 2020 2020 2020 206c 617a 7974 7261 6e73         lazytrans
-00006e10: 666f 726d 2068 6173 2061 2076 6572 7920  form has a very 
-00006e20: 7369 6d70 6c65 2041 5049 2077 6974 6820  simple API with 
-00006e30: 7468 6520 666f 6c6c 6f77 696e 6720 696e  the following in
-00006e40: 7075 7473 2e20 596f 7520 6e65 6564 2074  puts. You need t
-00006e50: 6f20 6372 6561 7465 2061 2073 6b6c 6561  o create a sklea
-00006e60: 726e 2d63 6f6d 7061 7469 626c 6520 7472  rn-compatible tr
-00006e70: 616e 7366 6f72 6d65 7220 7069 7065 6c69  ansformer pipeli
-00006e80: 6e65 206f 626a 6563 7420 6279 2069 6d70  ne object by imp
-00006e90: 6f72 7469 6e67 204c 617a 7954 7261 6e73  orting LazyTrans
-00006ea0: 666f 726d 6572 2066 726f 6d20 6c61 7a79  former from lazy
-00006eb0: 7472 616e 7366 6f72 6d20 6c69 6272 6172  transform librar
-00006ec0: 792e 203c 703e 0a20 2020 2020 2020 204f  y. <p>.        O
-00006ed0: 6e63 6520 796f 7520 696d 706f 7274 2069  nce you import i
-00006ee0: 742c 2079 6f75 2063 616e 2064 6566 696e  t, you can defin
-00006ef0: 6520 7468 6520 6f62 6a65 6374 2062 7920  e the object by 
-00006f00: 6769 7669 6e67 2073 6576 6572 616c 206f  giving several o
-00006f10: 7074 696f 6e73 2073 7563 6820 6173 3a0a  ptions such as:.
-00006f20: 2020 2020 2020 2020 0a20 2020 2020 2020          .       
-00006f30: 202a 2a41 7267 756d 656e 7473 2a2a 0a20   **Arguments**. 
-00006f40: 2020 2020 2020 200a 2020 2020 2020 2020         .        
-00006f50: 3c62 3e43 6175 7469 6f6e 3a3c 2f62 3e20  <b>Caution:</b> 
-00006f60: 585f 7472 6169 6e20 616e 6420 795f 7472  X_train and y_tr
-00006f70: 6169 6e20 6d75 7374 2062 6520 7061 6e64  ain must be pand
-00006f80: 6173 2044 6174 6166 7261 6d65 7320 6f72  as Dataframes or
-00006f90: 2070 616e 6461 7320 5365 7269 6573 2e20   pandas Series. 
-00006fa0: 444f 204e 4f54 2073 656e 6420 696e 206e  DO NOT send in n
-00006fb0: 756d 7079 2061 7272 6179 732e 2054 6865  umpy arrays. The
-00006fc0: 7920 776f 6e27 7420 776f 726b 2e0a 2020  y won't work..  
-00006fd0: 2020 2020 2020 0a20 2020 2020 2020 202d        .        -
-00006fe0: 2060 6d6f 6465 6c60 3a20 6465 6661 756c   `model`: defaul
-00006ff0: 7420 6973 204e 6f6e 652e 204f 7220 6974  t is None. Or it
-00007000: 2063 6f75 6c64 2062 6520 616e 7920 7363   could be any sc
-00007010: 696b 6974 2d6c 6561 726e 206d 6f64 656c  ikit-learn model
-00007020: 2028 696e 636c 7564 696e 6720 6d75 6c74   (including mult
-00007030: 696f 7574 7075 7420 6d6f 6465 6c73 2920  ioutput models) 
-00007040: 6173 2077 656c 6c20 6173 2074 6865 2070  as well as the p
-00007050: 6f70 756c 6172 2058 4742 6f6f 7374 2061  opular XGBoost a
-00007060: 6e64 204c 6967 6874 4742 4d20 6c69 6272  nd LightGBM libr
-00007070: 6172 6965 732e 2059 6f75 206e 6565 6420  aries. You need 
-00007080: 746f 2069 6e73 7461 6c6c 2074 686f 7365  to install those
-00007090: 206c 6962 7261 7269 6573 2069 6620 796f   libraries if yo
-000070a0: 7520 7761 6e74 2074 6f20 7573 6520 7468  u want to use th
-000070b0: 656d 2e0a 2020 2020 2020 2020 2d20 6065  em..        - `e
-000070c0: 6e63 6f64 6572 7360 3a20 636f 756c 6420  ncoders`: could 
-000070d0: 6265 206f 6e65 206d 6f72 6520 656e 636f  be one more enco
-000070e0: 6465 7273 2069 6e20 6120 7374 7269 6e67  ders in a string
-000070f0: 206f 7220 6120 6c69 7374 2e20 4561 6368   or a list. Each
-00007100: 2065 6e63 6f64 6572 2073 7472 696e 6720   encoder string 
-00007110: 6361 6e20 6265 2061 6e79 206f 6e65 206f  can be any one o
-00007120: 6620 7468 6520 3130 2b20 656e 636f 6465  f the 10+ encode
-00007130: 7273 2066 726f 6d20 6063 6174 6567 6f72  rs from `categor
-00007140: 795f 656e 636f 6465 7273 6020 6c69 6272  y_encoders` libr
-00007150: 6172 7920 6265 6c6f 772e 2020 4176 6169  ary below.  Avai
-00007160: 6c61 626c 6520 656e 636f 6465 7273 2061  lable encoders a
-00007170: 7265 206c 6973 7465 6420 6865 7265 2061  re listed here a
-00007180: 7320 7374 7269 6e67 7320 736f 2074 6861  s strings so tha
-00007190: 7420 796f 7520 6361 6e20 696e 7075 7420  t you can input 
-000071a0: 7468 656d 2069 6e20 6c61 7a79 7472 616e  them in lazytran
-000071b0: 7366 6f72 6d3a 0a20 2020 2020 2020 2020  sform:.         
-000071c0: 202d 2060 6175 746f 6020 2d20 4974 2075   - `auto` - It u
-000071d0: 7365 7320 606f 6e65 686f 7460 2065 6e63  ses `onehot` enc
-000071e0: 6f64 696e 6720 666f 7220 6c6f 772d 6361  oding for low-ca
-000071f0: 7264 696e 616c 6974 7920 7661 7269 6162  rdinality variab
-00007200: 6c65 7320 616e 6420 606c 6162 656c 6020  les and `label` 
-00007210: 656e 636f 6469 6e67 2066 6f72 2068 6967  encoding for hig
-00007220: 6820 6361 7264 696e 616c 6974 7920 7661  h cardinality va
-00007230: 7269 6162 6c65 732e 0a20 2020 2020 2020  riables..       
-00007240: 2020 202d 2060 6f6e 6568 6f74 6020 2d20     - `onehot` - 
-00007250: 4f6e 6520 486f 7420 656e 636f 6469 6e67  One Hot encoding
-00007260: 202d 2069 7420 7769 6c6c 2062 6520 7573   - it will be us
-00007270: 6564 2066 6f72 2061 6c6c 2063 6174 6567  ed for all categ
-00007280: 6f72 6963 616c 2066 6561 7475 7265 7320  orical features 
-00007290: 6972 7265 7370 6563 7469 7665 206f 6620  irrespective of 
-000072a0: 6361 7264 696e 616c 6974 790a 2020 2020  cardinality.    
-000072b0: 2020 2020 2020 2d20 606c 6162 656c 6020        - `label` 
-000072c0: 2d20 4c61 6265 6c20 456e 636f 6469 6e67  - Label Encoding
-000072d0: 202d 2069 7420 7769 6c6c 2062 6520 7573   - it will be us
-000072e0: 6564 2066 6f72 2061 6c6c 2063 6174 6567  ed for all categ
-000072f0: 6f72 6963 616c 2066 6561 7475 7265 7320  orical features 
-00007300: 6972 7265 7370 6563 7469 7665 206f 6620  irrespective of 
-00007310: 6361 7264 696e 616c 6974 790a 2020 2020  cardinality.    
-00007320: 2020 2020 2020 2d20 6068 6173 6869 6e67        - `hashing
-00007330: 6020 6f72 2060 6861 7368 6020 2d20 4861  ` or `hash` - Ha
-00007340: 7368 696e 6720 286f 7220 4861 7368 2920  shing (or Hash) 
-00007350: 456e 636f 6469 6e67 202d 2077 696c 6c20  Encoding - will 
-00007360: 6265 2075 7365 6420 666f 7220 616c 6c20  be used for all 
-00007370: 6361 7465 676f 7269 6361 6c20 7661 7269  categorical vari
-00007380: 6162 6c65 730a 2020 2020 2020 2020 2020  ables.          
-00007390: 2d20 6068 656c 6d65 7274 6020 2d20 4865  - `helmert` - He
-000073a0: 6c6d 6572 7420 456e 636f 6469 6e67 202d  lmert Encoding -
-000073b0: 2077 696c 6c20 6265 2075 7365 6420 666f   will be used fo
-000073c0: 7220 616c 6c20 6361 7465 676f 7269 6361  r all categorica
-000073d0: 6c20 7661 7269 6162 6c65 730a 2020 2020  l variables.    
-000073e0: 2020 2020 2020 2d20 6062 6463 6020 2d20        - `bdc` - 
-000073f0: 4244 4320 456e 636f 6469 6e67 202d 2077  BDC Encoding - w
-00007400: 696c 6c20 6265 2075 7365 6420 666f 7220  ill be used for 
-00007410: 616c 6c20 6361 7465 676f 7269 6361 6c20  all categorical 
-00007420: 7661 7269 6162 6c65 730a 2020 2020 2020  variables.      
-00007430: 2020 2020 2d20 6073 756d 6020 2d20 5375      - `sum` - Su
-00007440: 6d20 456e 636f 6469 6e67 202d 2077 696c  m Encoding - wil
-00007450: 6c20 6265 2075 7365 6420 666f 7220 616c  l be used for al
-00007460: 6c20 6361 7465 676f 7269 6361 6c20 7661  l categorical va
-00007470: 7269 6162 6c65 730a 2020 2020 2020 2020  riables.        
-00007480: 2020 2d20 606c 6f6f 6020 2d20 4c65 6176    - `loo` - Leav
-00007490: 6520 6f6e 6520 6f75 7420 456e 636f 6469  e one out Encodi
-000074a0: 6e67 202d 2077 696c 6c20 6265 2075 7365  ng - will be use
-000074b0: 6420 666f 7220 616c 6c20 6361 7465 676f  d for all catego
-000074c0: 7269 6361 6c20 7661 7269 6162 6c65 730a  rical variables.
-000074d0: 2020 2020 2020 2020 2020 2d20 6062 6173            - `bas
-000074e0: 6560 202d 2042 6173 6520 656e 636f 6469  e` - Base encodi
-000074f0: 6e67 202d 2077 696c 6c20 6265 2075 7365  ng - will be use
-00007500: 6420 666f 7220 616c 6c20 6361 7465 676f  d for all catego
-00007510: 7269 6361 6c20 7661 7269 6162 6c65 730a  rical variables.
-00007520: 2020 2020 2020 2020 2020 2d20 6077 6f65            - `woe
-00007530: 6020 2d20 5765 6967 6874 206f 6620 4576  ` - Weight of Ev
-00007540: 6964 656e 6365 2045 6e63 6f64 696e 6720  idence Encoding 
-00007550: 2d20 7769 6c6c 2062 6520 7573 6564 2066  - will be used f
-00007560: 6f72 2061 6c6c 2063 6174 6567 6f72 6963  or all categoric
-00007570: 616c 2076 6172 6961 626c 6573 0a20 2020  al variables.   
-00007580: 2020 2020 2020 202d 2060 6a61 6d65 7360         - `james`
-00007590: 202d 204a 616d 6573 2045 6e63 6f64 696e   - James Encodin
-000075a0: 6720 2d20 7769 6c6c 2062 6520 7573 6564  g - will be used
-000075b0: 2066 6f72 2061 6c6c 2063 6174 6567 6f72   for all categor
-000075c0: 6963 616c 2076 6172 6961 626c 6573 0a20  ical variables. 
-000075d0: 2020 2020 2020 2020 202d 2060 7461 7267           - `targ
-000075e0: 6574 6020 2d20 5461 7267 6574 2045 6e63  et` - Target Enc
-000075f0: 6f64 696e 6720 2d20 7769 6c6c 2062 6520  oding - will be 
-00007600: 7573 6564 2066 6f72 2061 6c6c 2063 6174  used for all cat
-00007610: 6567 6f72 6963 616c 2076 6172 6961 626c  egorical variabl
-00007620: 6573 0a20 2020 2020 2020 2020 202d 2060  es.          - `
-00007630: 636f 756e 7460 202d 2043 6f75 6e74 2045  count` - Count E
-00007640: 6e63 6f64 696e 6720 2d20 7769 6c6c 2062  ncoding - will b
-00007650: 6520 7573 6564 2066 6f72 2061 6c6c 2063  e used for all c
-00007660: 6174 6567 6f72 6963 616c 2076 6172 6961  ategorical varia
-00007670: 626c 6573 0a20 2020 2020 2020 2020 202d  bles.          -
-00007680: 2060 676c 6d60 2c60 676c 6d6d 6020 2d20   `glm`,`glmm` - 
-00007690: 4765 6e65 7261 6c69 7a65 6420 4c69 6e65  Generalized Line
-000076a0: 6172 204d 6f64 656c 2045 6e63 6f64 696e  ar Model Encodin
-000076b0: 670a 2020 2020 2020 2020 2d20 4865 7265  g.        - Here
-000076c0: 2069 7320 6120 6465 7363 7269 7074 696f   is a descriptio
-000076d0: 6e20 6f66 2076 6172 696f 7573 2065 6e63  n of various enc
-000076e0: 6f64 6572 7320 616e 6420 7468 6569 7220  oders and their 
-000076f0: 7573 6573 2066 726f 6d20 7468 6520 6578  uses from the ex
-00007700: 6365 6c6c 656e 7420 3c61 2068 7265 663d  cellent <a href=
-00007710: 2268 7474 7073 3a2f 2f63 6f6e 7472 6962  "https://contrib
-00007720: 2e73 6369 6b69 742d 6c65 6172 6e2e 6f72  .scikit-learn.or
-00007730: 672f 6361 7465 676f 7279 5f65 6e63 6f64  g/category_encod
-00007740: 6572 732f 223e 2063 6174 6567 6f72 795f  ers/"> category_
-00007750: 656e 636f 6465 7273 3c2f 613e 2070 7974  encoders</a> pyt
-00007760: 686f 6e20 6c69 6272 6172 793a 3c62 723e  hon library:<br>
-00007770: 0a20 2020 2020 2020 2020 2020 202d 2060  .            - `
-00007780: 4861 7368 696e 6745 6e63 6f64 6572 603a  HashingEncoder`:
-00007790: 2048 6173 6869 6e67 456e 636f 6465 7220   HashingEncoder 
-000077a0: 6973 2061 206d 756c 7469 7661 7269 6174  is a multivariat
-000077b0: 6520 6861 7368 696e 6720 696d 706c 656d  e hashing implem
-000077c0: 656e 7461 7469 6f6e 2077 6974 6820 636f  entation with co
-000077d0: 6e66 6967 7572 6162 6c65 2064 696d 656e  nfigurable dimen
-000077e0: 7369 6f6e 616c 6974 792f 7072 6563 6973  sionality/precis
-000077f0: 696f 6e2e 2054 6865 2061 6476 616e 7461  ion. The advanta
-00007800: 6765 206f 6620 7468 6973 2065 6e63 6f64  ge of this encod
-00007810: 6572 2069 7320 7468 6174 2069 7420 646f  er is that it do
-00007820: 6573 206e 6f74 206d 6169 6e74 6169 6e20  es not maintain 
-00007830: 6120 6469 6374 696f 6e61 7279 206f 6620  a dictionary of 
-00007840: 6f62 7365 7276 6564 2063 6174 6567 6f72  observed categor
-00007850: 6965 732e 2043 6f6e 7365 7175 656e 746c  ies. Consequentl
-00007860: 792c 2074 6865 2065 6e63 6f64 6572 2064  y, the encoder d
-00007870: 6f65 7320 6e6f 7420 6772 6f77 2069 6e20  oes not grow in 
-00007880: 7369 7a65 2061 6e64 2061 6363 6570 7473  size and accepts
-00007890: 206e 6577 2076 616c 7565 7320 6475 7269   new values duri
-000078a0: 6e67 2064 6174 6120 7363 6f72 696e 6720  ng data scoring 
-000078b0: 6279 2064 6573 6967 6e2e 0a20 2020 2020  by design..     
-000078c0: 2020 2020 2020 202d 2060 5375 6d45 6e63         - `SumEnc
-000078d0: 6f64 6572 603a 2053 756d 456e 636f 6465  oder`: SumEncode
-000078e0: 7220 6973 2061 2053 756d 2063 6f6e 7472  r is a Sum contr
-000078f0: 6173 7420 636f 6469 6e67 2066 6f72 2074  ast coding for t
-00007900: 6865 2065 6e63 6f64 696e 6720 6f66 2063  he encoding of c
-00007910: 6174 6567 6f72 6963 616c 2066 6561 7475  ategorical featu
-00007920: 7265 732e 0a20 2020 2020 2020 2020 2020  res..           
-00007930: 202d 2060 506f 6c79 6e6f 6d69 616c 456e   - `PolynomialEn
-00007940: 636f 6465 7260 3a20 506f 6c79 6e6f 6d69  coder`: Polynomi
-00007950: 616c 456e 636f 6465 7220 6973 2061 2050  alEncoder is a P
-00007960: 6f6c 796e 6f6d 6961 6c20 636f 6e74 7261  olynomial contra
-00007970: 7374 2063 6f64 696e 6720 666f 7220 7468  st coding for th
-00007980: 6520 656e 636f 6469 6e67 206f 6620 6361  e encoding of ca
-00007990: 7465 676f 7269 6361 6c20 6665 6174 7572  tegorical featur
-000079a0: 6573 2e0a 2020 2020 2020 2020 2020 2020  es..            
-000079b0: 2d20 6042 6163 6b77 6172 6444 6966 6665  - `BackwardDiffe
-000079c0: 7265 6e63 6545 6e63 6f64 6572 603a 2042  renceEncoder`: B
-000079d0: 6163 6b77 6172 6444 6966 6665 7265 6e63  ackwardDifferenc
-000079e0: 6545 6e63 6f64 6572 2069 7320 6120 4261  eEncoder is a Ba
-000079f0: 636b 7761 7264 2064 6966 6665 7265 6e63  ckward differenc
-00007a00: 6520 636f 6e74 7261 7374 2063 6f64 696e  e contrast codin
-00007a10: 6720 666f 7220 656e 636f 6469 6e67 2063  g for encoding c
-00007a20: 6174 6567 6f72 6963 616c 2076 6172 6961  ategorical varia
-00007a30: 626c 6573 2e0a 2020 2020 2020 2020 2020  bles..          
-00007a40: 2020 2d20 604f 6e65 486f 7445 6e63 6f64    - `OneHotEncod
-00007a50: 6572 603a 204f 6e65 486f 7445 6e63 6f64  er`: OneHotEncod
-00007a60: 6572 2069 7320 7468 6520 7472 6164 6974  er is the tradit
-00007a70: 696f 6e61 6c20 4f6e 6568 6f74 2028 6f72  ional Onehot (or
-00007a80: 2064 756d 6d79 2920 636f 6469 6e67 2066   dummy) coding f
-00007a90: 6f72 2063 6174 6567 6f72 6963 616c 2066  or categorical f
-00007aa0: 6561 7475 7265 732e 2049 7420 7072 6f64  eatures. It prod
-00007ab0: 7563 6573 206f 6e65 2066 6561 7475 7265  uces one feature
-00007ac0: 2070 6572 2063 6174 6567 6f72 792c 2065   per category, e
-00007ad0: 6163 6820 6265 696e 6720 6120 6269 6e61  ach being a bina
-00007ae0: 7279 2e0a 2020 2020 2020 2020 2020 2020  ry..            
-00007af0: 2d20 6048 656c 6d65 7274 456e 636f 6465  - `HelmertEncode
-00007b00: 7260 3a20 4865 6c6d 6572 7445 6e63 6f64  r`: HelmertEncod
-00007b10: 6572 2075 7365 7320 7468 6520 4865 6c6d  er uses the Helm
-00007b20: 6572 7420 636f 6e74 7261 7374 2063 6f64  ert contrast cod
-00007b30: 696e 6720 666f 7220 656e 636f 6469 6e67  ing for encoding
-00007b40: 2063 6174 6567 6f72 6963 616c 2066 6561   categorical fea
-00007b50: 7475 7265 732e 0a20 2020 2020 2020 2020  tures..         
-00007b60: 2020 202d 2060 4f72 6469 6e61 6c45 6e63     - `OrdinalEnc
-00007b70: 6f64 6572 603a 204f 7264 696e 616c 456e  oder`: OrdinalEn
-00007b80: 636f 6465 7220 7573 6573 204f 7264 696e  coder uses Ordin
-00007b90: 616c 2065 6e63 6f64 696e 6720 746f 2064  al encoding to d
-00007ba0: 6573 6967 6e61 7465 2061 2073 696e 676c  esignate a singl
-00007bb0: 6520 636f 6c75 6d6e 206f 6620 696e 7465  e column of inte
-00007bc0: 6765 7273 2074 6f20 7265 7072 6573 656e  gers to represen
-00007bd0: 7420 7468 6520 6361 7465 676f 7269 6573  t the categories
-00007be0: 2069 6e20 796f 7572 2064 6174 612e 2049   in your data. I
-00007bf0: 6e74 6567 6572 7320 686f 7765 7665 7220  ntegers however 
-00007c00: 7374 6172 7420 696e 2074 6865 2073 616d  start in the sam
-00007c10: 6520 6f72 6465 7220 696e 2077 6869 6368  e order in which
-00007c20: 2074 6865 2063 6174 6567 6f72 6965 7320   the categories 
-00007c30: 6172 6520 666f 756e 6420 696e 2079 6f75  are found in you
-00007c40: 7220 6461 7461 7365 742e 2049 6620 796f  r dataset. If yo
-00007c50: 7520 7761 6e74 2074 6f20 6368 616e 6765  u want to change
-00007c60: 2074 6865 206f 7264 6572 2c20 6a75 7374   the order, just
-00007c70: 2073 6f72 7420 7468 6520 636f 6c75 6d6e   sort the column
-00007c80: 2061 6e64 2073 656e 6420 6974 2069 6e20   and send it in 
-00007c90: 666f 7220 656e 636f 6469 6e67 2e0a 2020  for encoding..  
-00007ca0: 2020 2020 2020 2020 2020 2d20 6046 7265            - `Fre
-00007cb0: 7175 656e 6379 456e 636f 6465 7260 3a20  quencyEncoder`: 
-00007cc0: 4672 6571 7565 6e63 7945 6e63 6f64 6572  FrequencyEncoder
-00007cd0: 2069 7320 6120 636f 756e 7420 656e 636f   is a count enco
-00007ce0: 6469 6e67 2074 6563 686e 6971 7565 2066  ding technique f
-00007cf0: 6f72 2063 6174 6567 6f72 6963 616c 2066  or categorical f
-00007d00: 6561 7475 7265 732e 2046 6f72 2061 2067  eatures. For a g
-00007d10: 6976 656e 2063 6174 6567 6f72 6963 616c  iven categorical
-00007d20: 2066 6561 7475 7265 2c20 6974 2072 6570   feature, it rep
-00007d30: 6c61 6365 7320 7468 6520 6e61 6d65 7320  laces the names 
-00007d40: 6f66 2074 6865 2063 6174 6567 6f72 6965  of the categorie
-00007d50: 7320 7769 7468 2074 6865 2067 726f 7570  s with the group
-00007d60: 2063 6f75 6e74 7320 6f66 2065 6163 6820   counts of each 
-00007d70: 6361 7465 676f 7279 2e0a 2020 2020 2020  category..      
-00007d80: 2020 2020 2020 2d20 6042 6173 654e 456e        - `BaseNEn
-00007d90: 636f 6465 7260 3a20 4261 7365 4e45 6e63  coder`: BaseNEnc
-00007da0: 6f64 6572 2065 6e63 6f64 6573 2074 6865  oder encodes the
-00007db0: 2063 6174 6567 6f72 6965 7320 696e 746f   categories into
-00007dc0: 2061 7272 6179 7320 6f66 2074 6865 6972   arrays of their
-00007dd0: 2062 6173 652d 4e20 7265 7072 6573 656e   base-N represen
-00007de0: 7461 7469 6f6e 2e20 4120 6261 7365 206f  tation. A base o
-00007df0: 6620 3120 6973 2065 7175 6976 616c 656e  f 1 is equivalen
-00007e00: 7420 746f 206f 6e65 2d68 6f74 2065 6e63  t to one-hot enc
-00007e10: 6f64 696e 6720 286e 6f74 2072 6561 6c6c  oding (not reall
-00007e20: 7920 6261 7365 2d31 2c20 6275 7420 7573  y base-1, but us
-00007e30: 6566 756c 292c 2061 2062 6173 6520 6f66  eful), a base of
-00007e40: 2032 2069 7320 6571 7569 7661 6c65 6e74   2 is equivalent
-00007e50: 2074 6f20 6269 6e61 7279 2065 6e63 6f64   to binary encod
-00007e60: 696e 672e 204e 3d6e 756d 6265 7220 6f66  ing. N=number of
-00007e70: 2061 6374 7561 6c20 6361 7465 676f 7269   actual categori
-00007e80: 6573 2069 7320 6571 7569 7661 6c65 6e74  es is equivalent
-00007e90: 2074 6f20 7661 6e69 6c6c 6120 6f72 6469   to vanilla ordi
-00007ea0: 6e61 6c20 656e 636f 6469 6e67 2e0a 2020  nal encoding..  
-00007eb0: 2020 2020 2020 2020 2020 2d20 6054 6172            - `Tar
-00007ec0: 6765 7445 6e63 6f64 6572 603a 2054 6172  getEncoder`: Tar
-00007ed0: 6765 7445 6e63 6f64 6572 2070 6572 666f  getEncoder perfo
-00007ee0: 726d 7320 5461 7267 6574 2065 6e63 6f64  rms Target encod
-00007ef0: 696e 6720 666f 7220 6361 7465 676f 7269  ing for categori
-00007f00: 6361 6c20 6665 6174 7572 6573 2e20 4974  cal features. It
-00007f10: 2073 7570 706f 7274 7320 666f 6c6c 6f77   supports follow
-00007f20: 696e 6720 6b69 6e64 7320 6f66 2074 6172  ing kinds of tar
-00007f30: 6765 7473 3a20 6269 6e61 7279 2061 6e64  gets: binary and
-00007f40: 2063 6f6e 7469 6e75 6f75 732e 2046 6f72   continuous. For
-00007f50: 206d 756c 7469 2d63 6c61 7373 2074 6172   multi-class tar
-00007f60: 6765 7473 2069 7420 7573 6573 2061 2050  gets it uses a P
-00007f70: 6f6c 796e 6f6d 6961 6c57 7261 7070 6572  olynomialWrapper
-00007f80: 2e0a 2020 2020 2020 2020 2020 2020 2d20  ..            - 
-00007f90: 6043 6174 426f 6f73 7445 6e63 6f64 6572  `CatBoostEncoder
-00007fa0: 603a 2043 6174 426f 6f73 7445 6e63 6f64  `: CatBoostEncod
-00007fb0: 6572 2070 6572 666f 726d 7320 4361 7442  er performs CatB
-00007fc0: 6f6f 7374 2063 6f64 696e 6720 666f 7220  oost coding for 
-00007fd0: 6361 7465 676f 7269 6361 6c20 6665 6174  categorical feat
-00007fe0: 7572 6573 2e20 4974 2073 7570 706f 7274  ures. It support
-00007ff0: 7320 7468 6520 666f 6c6c 6f77 696e 6720  s the following 
-00008000: 6b69 6e64 7320 6f66 2074 6172 6765 7473  kinds of targets
-00008010: 3a20 6269 6e61 7279 2061 6e64 2063 6f6e  : binary and con
-00008020: 7469 6e75 6f75 732e 2046 6f72 2070 6f6c  tinuous. For pol
-00008030: 796e 6f6d 6961 6c20 7461 7267 6574 2073  ynomial target s
-00008040: 7570 706f 7274 2c20 6974 2075 7365 7320  upport, it uses 
-00008050: 6120 506f 6c79 6e6f 6d69 616c 5772 6170  a PolynomialWrap
-00008060: 7065 722e 2054 6869 7320 6973 2076 6572  per. This is ver
-00008070: 7920 7369 6d69 6c61 7220 746f 206c 6561  y similar to lea
-00008080: 7665 2d6f 6e65 2d6f 7574 2065 6e63 6f64  ve-one-out encod
-00008090: 696e 672c 2062 7574 2063 616c 6375 6c61  ing, but calcula
-000080a0: 7465 7320 7468 6520 7661 6c75 6573 20e2  tes the values .
-000080b0: 809c 6f6e 2d74 6865 2d66 6c79 e280 9d2e  ..on-the-fly....
-000080c0: 2043 6f6e 7365 7175 656e 746c 792c 2074   Consequently, t
-000080d0: 6865 2076 616c 7565 7320 6e61 7475 7261  he values natura
-000080e0: 6c6c 7920 7661 7279 2064 7572 696e 6720  lly vary during 
-000080f0: 7468 6520 7472 6169 6e69 6e67 2070 6861  the training pha
-00008100: 7365 2061 6e64 2069 7420 6973 206e 6f74  se and it is not
-00008110: 206e 6563 6573 7361 7279 2074 6f20 6164   necessary to ad
-00008120: 6420 7261 6e64 6f6d 206e 6f69 7365 2e0a  d random noise..
-00008130: 2020 2020 2020 2020 2020 2020 2d20 6057              - `W
-00008140: 4f45 456e 636f 6465 7260 3a20 574f 4545  OEEncoder`: WOEE
-00008150: 6e63 6f64 6572 2075 7365 7320 7468 6520  ncoder uses the 
-00008160: 5765 6967 6874 206f 6620 4576 6964 656e  Weight of Eviden
-00008170: 6365 2074 6563 686e 6971 7565 2066 6f72  ce technique for
-00008180: 2063 6174 6567 6f72 6963 616c 2066 6561   categorical fea
-00008190: 7475 7265 732e 2049 7420 7375 7070 6f72  tures. It suppor
-000081a0: 7473 206f 6e6c 7920 6f6e 6520 6b69 6e64  ts only one kind
-000081b0: 206f 6620 7461 7267 6574 3a20 6269 6e61   of target: bina
-000081c0: 7279 2e20 466f 7220 706f 6c79 6e6f 6d69  ry. For polynomi
-000081d0: 616c 2074 6172 6765 7420 7375 7070 6f72  al target suppor
-000081e0: 742c 2069 7420 7573 6573 2061 2050 6f6c  t, it uses a Pol
-000081f0: 796e 6f6d 6961 6c57 7261 7070 6572 2e20  ynomialWrapper. 
-00008200: 4974 2063 616e 6e6f 7420 6265 2075 7365  It cannot be use
-00008210: 6420 666f 7220 5265 6772 6573 7369 6f6e  d for Regression
-00008220: 2e0a 2020 2020 2020 2020 2020 2020 2d20  ..            - 
-00008230: 604a 616d 6573 5374 6569 6e45 6e63 6f64  `JamesSteinEncod
-00008240: 6572 603a 204a 616d 6573 5374 6569 6e45  er`: JamesSteinE
-00008250: 6e63 6f64 6572 2075 7365 7320 7468 6520  ncoder uses the 
-00008260: 4a61 6d65 732d 5374 6569 6e20 6573 7469  James-Stein esti
-00008270: 6d61 746f 722e 2049 7420 7375 7070 6f72  mator. It suppor
-00008280: 7473 2032 206b 696e 6473 206f 6620 7461  ts 2 kinds of ta
-00008290: 7267 6574 733a 2062 696e 6172 7920 616e  rgets: binary an
-000082a0: 6420 636f 6e74 696e 756f 7573 2e20 466f  d continuous. Fo
-000082b0: 7220 706f 6c79 6e6f 6d69 616c 2074 6172  r polynomial tar
-000082c0: 6765 7420 7375 7070 6f72 742c 2069 7420  get support, it 
-000082d0: 7573 6573 2050 6f6c 796e 6f6d 6961 6c57  uses PolynomialW
-000082e0: 7261 7070 6572 2e0a 2020 2020 2020 2020  rapper..        
-000082f0: 2020 2020 466f 7220 6665 6174 7572 6520      For feature 
-00008300: 7661 6c75 6520 692c 204a 616d 6573 2d53  value i, James-S
-00008310: 7465 696e 2065 7374 696d 6174 6f72 2072  tein estimator r
-00008320: 6574 7572 6e73 2061 2077 6569 6768 7465  eturns a weighte
-00008330: 6420 6176 6572 6167 6520 6f66 3a0a 2020  d average of:.  
-00008340: 2020 2020 2020 2020 2020 5468 6520 6d65            The me
-00008350: 616e 2074 6172 6765 7420 7661 6c75 6520  an target value 
-00008360: 666f 7220 7468 6520 6f62 7365 7276 6564  for the observed
-00008370: 2066 6561 7475 7265 2076 616c 7565 2069   feature value i
-00008380: 2e0a 2020 2020 2020 2020 2020 2020 5468  ..            Th
-00008390: 6520 6d65 616e 2074 6172 6765 7420 7661  e mean target va
-000083a0: 6c75 6520 2872 6567 6172 646c 6573 7320  lue (regardless 
-000083b0: 6f66 2074 6865 2066 6561 7475 7265 2076  of the feature v
-000083c0: 616c 7565 292e 0a20 2020 2020 2020 2020  alue)..         
-000083d0: 2020 202d 2060 5175 616e 7469 6c65 456e     - `QuantileEn
-000083e0: 636f 6465 7260 3a20 5468 6973 2069 7320  coder`: This is 
-000083f0: 6120 7665 7279 2067 6f6f 6420 656e 636f  a very good enco
-00008400: 6465 7220 666f 7220 5265 6772 6573 7369  der for Regressi
-00008410: 6f6e 2074 6173 6b73 2e20 5365 6520 5061  on tasks. See Pa
-00008420: 7065 7220 616e 6420 6172 7469 636c 653a  per and article:
-00008430: 0a20 2020 2020 2020 2020 2020 2068 7474  .            htt
-00008440: 7073 3a2f 2f74 6f77 6172 6473 6461 7461  ps://towardsdata
-00008450: 7363 6965 6e63 652e 636f 6d2f 7175 616e  science.com/quan
-00008460: 7469 6c65 2d65 6e63 6f64 6572 2d65 6233  tile-encoder-eb3
-00008470: 3363 3237 3234 3131 640a 2020 2020 2020  3c272411d.      
-00008480: 2020 0a20 2020 2020 2020 202d 2060 7363    .        - `sc
-00008490: 616c 6572 7360 3a20 636f 756c 6420 6265  alers`: could be
-000084a0: 206f 6e65 206f 6620 7468 7265 6520 6d61   one of three ma
-000084b0: 696e 2073 6361 6c65 7273 2075 7365 6420  in scalers used 
-000084c0: 696e 2073 6369 6b69 742d 6c65 6172 6e20  in scikit-learn 
-000084d0: 6d6f 6465 6c73 2074 6f20 7472 616e 7366  models to transf
-000084e0: 6f72 6d20 6e75 6d65 7269 6320 6665 6174  orm numeric feat
-000084f0: 7572 6573 2e20 4465 6661 756c 7420 6973  ures. Default is
-00008500: 204e 6f6e 652e 2053 6361 6c65 7273 2061   None. Scalers a
-00008510: 7265 2075 7365 6420 696e 2074 6865 206c  re used in the l
-00008520: 6173 7420 7374 6570 206f 6620 7468 6520  ast step of the 
-00008530: 7069 7065 6c69 6e65 2074 6f20 7363 616c  pipeline to scal
-00008540: 6520 616c 6c20 6665 6174 7572 6573 2074  e all features t
-00008550: 6861 7420 6861 7665 2074 7261 6e73 666f  hat have transfo
-00008560: 726d 6564 2e20 486f 7765 7665 722c 2079  rmed. However, y
-00008570: 6f75 206d 6967 6874 2077 616e 7420 746f  ou might want to
-00008580: 2061 766f 6964 2073 6361 6c69 6e67 2069   avoid scaling i
-00008590: 6e20 4e4c 5020 6461 7461 7365 7473 2073  n NLP datasets s
-000085a0: 696e 6365 2061 6674 6572 2054 4669 4446  ince after TFiDF
-000085b0: 2076 6563 746f 7269 7a61 7469 6f6e 2c20   vectorization, 
-000085c0: 7363 616c 696e 6720 7468 656d 206d 6179  scaling them may
-000085d0: 206e 6f74 206d 616b 6520 7365 6e73 652e   not make sense.
-000085e0: 2042 7574 2069 7420 6973 2075 7020 746f   But it is up to
-000085f0: 2079 6f75 2e20 5468 6520 3420 6f70 7469   you. The 4 opti
-00008600: 6f6e 7320 6172 653a 0a20 2020 2020 2020  ons are:.       
-00008610: 2020 202d 2060 4e6f 6e65 6020 4e6f 2073     - `None` No s
-00008620: 6361 6c65 722e 2047 7265 6174 2066 6f72  caler. Great for
-00008630: 2061 6c6d 6f73 7420 616c 6c20 6461 7461   almost all data
-00008640: 7365 7473 2e20 5465 7374 2069 7420 6669  sets. Test it fi
-00008650: 7273 7420 616e 6420 7468 656e 2074 7279  rst and then try
-00008660: 206f 6e65 206f 6620 7468 6520 7363 616c   one of the scal
-00008670: 6572 7320 6265 6c6f 772e 0a20 2020 2020  ers below..     
-00008680: 2020 2020 202d 2060 7374 6460 2073 7461       - `std` sta
-00008690: 6e64 6172 6420 7363 616c 6572 2e20 4772  ndard scaler. Gr
-000086a0: 6561 7420 666f 7220 616c 6d6f 7374 2061  eat for almost a
-000086b0: 6c6c 2064 6174 6173 6574 732e 0a20 2020  ll datasets..   
-000086c0: 2020 2020 2020 202d 2060 6d69 6e6d 6178         - `minmax
-000086d0: 6020 6d69 6e6d 6178 2073 6361 6c65 722e  ` minmax scaler.
-000086e0: 2047 7265 6174 2066 6f72 2064 6174 6173   Great for datas
-000086f0: 6574 7320 7768 6572 6520 796f 7520 6e65  ets where you ne
-00008700: 6564 2074 6f20 7365 6520 7468 6520 6469  ed to see the di
-00008710: 7374 7269 6275 7469 6f6e 2062 6574 7765  stribution betwe
-00008720: 656e 2030 2061 6e64 2031 2e0a 2020 2020  en 0 and 1..    
-00008730: 2020 2020 2020 2d20 6072 6f62 7573 7460        - `robust`
-00008740: 2052 6f62 7573 7420 7363 616c 6572 2e20   Robust scaler. 
-00008750: 4772 6561 7420 666f 7220 6461 7461 7365  Great for datase
-00008760: 7473 2077 6865 7265 2079 6f75 2068 6176  ts where you hav
-00008770: 6520 6f75 746c 6965 7273 2e0a 2020 2020  e outliers..    
-00008780: 2020 2020 2020 2d20 606d 6178 6162 7360        - `maxabs`
-00008790: 206d 6178 2061 6273 6f6c 7574 6520 7363   max absolute sc
-000087a0: 616c 6572 2e20 4772 6561 7420 666f 7220  aler. Great for 
-000087b0: 7363 616c 696e 6720 6275 7420 6c65 6176  scaling but leav
-000087c0: 6573 2074 6865 206e 6567 6174 6976 6520  es the negative 
-000087d0: 7661 6c75 6573 2061 7320 7468 6579 2061  values as they a
-000087e0: 7265 2028 6e65 6761 7469 7665 292e 200a  re (negative). .
-000087f0: 2020 2020 2020 2020 2d20 6064 6174 655f          - `date_
-00008800: 746f 5f73 7472 696e 6760 3a20 6465 6661  to_string`: defa
-00008810: 756c 7420 6973 2046 616c 7365 2e20 4966  ult is False. If
-00008820: 2079 6f75 2077 616e 7420 746f 2075 7365   you want to use
-00008830: 2064 6174 6520 7661 7269 6162 6c65 7320   date variables 
-00008840: 6173 2073 7472 696e 6773 2028 6361 7465  as strings (cate
-00008850: 676f 7269 6361 6c29 2c20 7468 656e 2073  gorical), then s
-00008860: 6574 2069 7420 6173 2054 7275 652e 596f  et it as True.Yo
-00008870: 7520 6361 6e20 7573 6520 7468 6973 206f  u can use this o
-00008880: 7074 696f 6e20 7768 656e 2074 6865 7265  ption when there
-00008890: 2061 7265 2076 6572 7920 6665 7720 6461   are very few da
-000088a0: 7465 7320 696e 2079 6f75 7220 6461 7461  tes in your data
-000088b0: 7365 742e 2049 6620 796f 7520 7365 7420  set. If you set 
-000088c0: 6974 2061 7320 4661 6c73 652c 2069 7420  it as False, it 
-000088d0: 7769 6c6c 2063 6f6e 7665 7274 2069 7420  will convert it 
-000088e0: 696e 746f 2064 6174 6520 7469 6d65 2066  into date time f
-000088f0: 6f72 6d61 7420 616e 6420 6578 7472 6163  ormat and extrac
-00008900: 7420 7570 2074 6f20 3230 2066 6561 7475  t up to 20 featu
-00008910: 7265 7320 6672 6f6d 2079 6f75 7220 6461  res from your da
-00008920: 7465 2074 696d 6520 636f 6c75 6d6e 2e20  te time column. 
-00008930: 5468 6973 2069 7320 7468 6520 6465 6661  This is the defa
-00008940: 756c 7420 6f70 7469 6f6e 2061 6e64 2062  ult option and b
-00008950: 6573 7420 6f70 7469 6f6e 2e0a 2020 2020  est option..    
-00008960: 2020 2020 2d20 6074 7261 6e73 666f 726d      - `transform
-00008970: 5f74 6172 6765 7460 3a20 6465 6661 756c  _target`: defaul
-00008980: 7420 6973 2046 616c 7365 2e20 4966 2079  t is False. If y
-00008990: 6f75 2077 616e 7420 746f 2074 7261 6e73  ou want to trans
-000089a0: 666f 726d 2079 6f75 7220 7461 7267 6574  form your target
-000089b0: 2076 6172 6961 626c 6528 7329 2c20 7468   variable(s), th
-000089c0: 656e 2073 6574 2069 7420 6173 2054 7275  en set it as Tru
-000089d0: 6520 616e 6420 7765 2077 696c 6c20 7472  e and we will tr
-000089e0: 616e 7366 6f72 6d20 796f 7572 2074 6172  ansform your tar
-000089f0: 6765 7428 7329 2061 7320 6e75 6d65 7269  get(s) as numeri
-00008a00: 6320 7573 696e 6720 4c61 6265 6c20 456e  c using Label En
-00008a10: 636f 6469 6e67 2061 7320 7765 6c6c 2061  coding as well a
-00008a20: 7320 6d75 6c74 692d 6c61 6265 6c20 4269  s multi-label Bi
-00008a30: 6e61 7279 2063 6c61 7373 6573 2e20 5468  nary classes. Th
-00008a40: 6973 2069 7320 6120 6772 6561 7420 6f70  is is a great op
-00008a50: 7469 6f6e 2077 6865 6e20 796f 7520 6861  tion when you ha
-00008a60: 7665 2063 6174 6567 6f72 6963 616c 2074  ve categorical t
-00008a70: 6172 6765 7420 7661 7269 6162 6c65 732e  arget variables.
-00008a80: 0a20 2020 2020 2020 202d 2060 696d 6261  .        - `imba
-00008a90: 6c61 6e63 6564 603a 2064 6566 6175 6c74  lanced`: default
-00008aa0: 2069 7320 4661 6c73 652e 2049 6620 796f   is False. If yo
-00008ab0: 7520 6861 7665 2061 6e20 696d 6261 6c61  u have an imbala
-00008ac0: 6e63 6564 2064 6174 6173 6574 2c20 7468  nced dataset, th
-00008ad0: 656e 2073 6574 2069 7420 746f 2054 7275  en set it to Tru
-00008ae0: 6520 616e 6420 7765 2077 696c 6c20 7472  e and we will tr
-00008af0: 616e 7366 6f72 6d20 796f 7572 2074 7261  ansform your tra
-00008b00: 696e 2064 6174 6120 7573 696e 6720 426f  in data using Bo
-00008b10: 7264 6572 6c69 6e65 534d 4f54 4520 6f72  rderlineSMOTE or
-00008b20: 2053 4d4f 5445 4e43 2077 6869 6368 2061   SMOTENC which a
-00008b30: 7265 2062 6f74 6820 6772 6561 7420 6f70  re both great op
-00008b40: 7469 6f6e 732e 2057 6520 7769 6c6c 2073  tions. We will s
-00008b50: 656c 6563 7420 7468 6520 7269 6768 7420  elect the right 
-00008b60: 534d 4f54 4520 6675 6e63 7469 6f6e 2061  SMOTE function a
-00008b70: 7574 6f6d 6174 6963 616c 6c79 2e0a 2020  utomatically..  
-00008b80: 2020 2020 2020 2d20 6063 6f6d 6269 6e65        - `combine
-00008b90: 5f72 6172 6560 3a20 6465 6661 756c 7420  _rare`: default 
-00008ba0: 6973 2046 616c 7365 2e20 5468 6973 2069  is False. This i
-00008bb0: 7320 6120 6772 6561 7420 6f70 7469 6f6e  s a great option
-00008bc0: 2069 6620 796f 7520 6861 7665 2074 6f6f   if you have too
-00008bd0: 206d 616e 7920 7261 7265 2063 6174 6567   many rare categ
-00008be0: 6f72 6965 7320 696e 2079 6f75 7220 6361  ories in your ca
-00008bf0: 7465 676f 7269 6361 6c20 7661 7269 6162  tegorical variab
-00008c00: 6c65 732e 2049 7420 7769 6c6c 2061 7574  les. It will aut
-00008c10: 6f6d 6174 6963 616c 6c79 2063 6f6d 6269  omatically combi
-00008c20: 6e65 2074 686f 7365 2072 6172 6520 6361  ne those rare ca
-00008c30: 7465 676f 7269 6573 2077 6869 6368 2061  tegories which a
-00008c40: 7265 206c 6573 7320 7468 616e 2031 2520  re less than 1% 
-00008c50: 6f66 2074 6865 2064 6174 6173 6574 2069  of the dataset i
-00008c60: 6e74 6f20 6f6e 6520 636f 6d62 696e 6564  nto one combined
-00008c70: 2063 6174 6567 6f72 7920 6361 6c6c 6564   category called
-00008c80: 2022 7261 7265 5f63 6174 6567 6f72 6965   "rare_categorie
-00008c90: 7322 2e20 596f 7520 6361 6e20 616c 736f  s". You can also
-00008ca0: 2073 6574 2069 7420 746f 2046 616c 7365   set it to False
-00008cb0: 2061 6e64 2077 6520 7769 6c6c 206e 6f74   and we will not
-00008cc0: 2074 7261 6e73 666f 726d 2061 6e79 206f   transform any o
-00008cd0: 6620 796f 7572 2063 6174 6567 6f72 6965  f your categorie
-00008ce0: 7320 696e 2079 6f75 7220 6361 7465 676f  s in your catego
-00008cf0: 7269 6361 6c20 7661 7269 6162 6c65 732e  rical variables.
-00008d00: 0a20 2020 2020 2020 2020 2d20 6076 6572  .         - `ver
-00008d10: 626f 7365 603a 2054 6869 7320 6861 7320  bose`: This has 
-00008d20: 3320 706f 7373 6962 6c65 2073 7461 7465  3 possible state
-00008d30: 733a 0a20 2020 2020 2020 2020 202d 2060  s:.          - `
-00008d40: 3060 2073 696c 656e 7420 6f75 7470 7574  0` silent output
-00008d50: 2e20 4772 6561 7420 666f 7220 7275 6e6e  . Great for runn
-00008d60: 696e 6720 7468 6973 2073 696c 656e 746c  ing this silentl
-00008d70: 7920 616e 6420 6765 7474 696e 6720 6661  y and getting fa
-00008d80: 7374 2072 6573 756c 7473 2e0a 2020 2020  st results..    
-00008d90: 2020 2020 2020 2d20 6031 6020 6d6f 7265        - `1` more
-00008da0: 2076 6572 6269 6167 652e 2047 7265 6174   verbiage. Great
-00008db0: 2066 6f72 206b 6e6f 7769 6e67 2068 6f77   for knowing how
-00008dc0: 2072 6573 756c 7473 2077 6572 6520 616e   results were an
-00008dd0: 6420 6d61 6b69 6e67 2063 6861 6e67 6573  d making changes
-00008de0: 2074 6f20 666c 6167 7320 696e 2069 6e70   to flags in inp
-00008df0: 7574 2e0a 2020 2020 2020 2020 2020 2d20  ut..          - 
-00008e00: 6032 6020 6869 6768 6c79 2076 6572 626f  `2` highly verbo
-00008e10: 7365 206f 7574 7075 742e 2047 7265 6174  se output. Great
-00008e20: 2066 6f72 2066 696e 6469 6e67 206f 7574   for finding out
-00008e30: 2077 6861 7420 6861 7070 656e 7320 756e   what happens un
-00008e40: 6465 7220 7468 6520 686f 6f64 2069 6e20  der the hood in 
-00008e50: 6c61 7a79 7472 616e 7366 6f72 6d20 7069  lazytransform pi
-00008e60: 7065 6c69 6e65 732e 0a20 2020 2020 2020  pelines..       
-00008e70: 203c 703e 0a20 2020 2020 2020 2054 6f20   <p>.        To 
-00008e80: 7669 6577 2074 6865 2074 6578 7420 7069  view the text pi
-00008e90: 7065 6c69 6e65 2c20 7468 6520 6465 6661  peline, the defa
-00008ea0: 756c 7420 6469 7370 6c61 7920 6973 2027  ult display is '
-00008eb0: 7465 7874 272c 2064 6f3a 3c62 723e 0a20  text', do:<br>. 
-00008ec0: 2020 2020 2020 200a 2020 2020 2020 2020         .        
-00008ed0: 6060 600a 2020 2020 2020 2020 6672 6f6d  ```.        from
-00008ee0: 2073 6b6c 6561 726e 2069 6d70 6f72 7420   sklearn import 
-00008ef0: 7365 745f 636f 6e66 6967 0a20 2020 2020  set_config.     
-00008f00: 2020 2073 6574 5f63 6f6e 6669 6728 6469     set_config(di
-00008f10: 7370 6c61 793d 2274 6578 7422 290a 2020  splay="text").  
-00008f20: 2020 2020 2020 6c61 7a79 2e78 666f 726d        lazy.xform
-00008f30: 6572 0a20 2020 2020 2020 2060 6060 0a20  er.        ```. 
-00008f40: 2020 2020 2020 200a 2020 2020 2020 2020         .        
-00008f50: 3c70 3e0a 2020 2020 2020 2020 546f 2076  <p>.        To v
-00008f60: 6965 7720 7468 6520 7069 7065 6c69 6e65  iew the pipeline
-00008f70: 2069 6e20 6120 6469 6167 7261 6d20 2876   in a diagram (v
-00008f80: 6973 7561 6c20 666f 726d 6174 292c 2064  isual format), d
-00008f90: 6f3a 3c62 723e 0a20 2020 2020 2020 200a  o:<br>.        .
-00008fa0: 2020 2020 2020 2020 6060 600a 2020 2020          ```.    
-00008fb0: 2020 2020 6672 6f6d 2073 6b6c 6561 726e      from sklearn
-00008fc0: 2069 6d70 6f72 7420 7365 745f 636f 6e66   import set_conf
-00008fd0: 6967 0a20 2020 2020 2020 2073 6574 5f63  ig.        set_c
-00008fe0: 6f6e 6669 6728 6469 7370 6c61 793d 2264  onfig(display="d
-00008ff0: 6961 6772 616d 2229 0a20 2020 2020 2020  iagram").       
-00009000: 206c 617a 792e 7866 6f72 6d65 720a 2020   lazy.xformer.  
-00009010: 2020 2020 2020 2320 4966 2079 6f75 2068        # If you h
-00009020: 6176 6520 6120 6d6f 6465 6c20 696e 2074  ave a model in t
-00009030: 6865 2070 6970 656c 696e 652c 2064 6f3a  he pipeline, do:
-00009040: 0a20 2020 2020 2020 206c 617a 792e 6d6f  .        lazy.mo
-00009050: 6465 6c66 6f72 6d65 720a 2020 2020 2020  delformer.      
-00009060: 2020 6060 600a 2020 2020 2020 2020 3c61    ```.        <a
-00009070: 2068 7265 663d 2268 7474 7073 3a2f 2f69   href="https://i
-00009080: 6d67 6262 2e63 6f6d 2f22 3e3c 696d 6720  mgbb.com/"><img 
-00009090: 7372 633d 2268 7474 7073 3a2f 2f69 2e69  src="https://i.i
-000090a0: 6262 2e63 6f2f 426e 3756 3470 782f 6c61  bb.co/Bn7V4px/la
-000090b0: 7a79 2d70 6970 652e 706e 6722 2061 6c74  zy-pipe.png" alt
-000090c0: 3d22 6c61 7a79 2d70 6970 6522 2062 6f72  ="lazy-pipe" bor
-000090d0: 6465 723d 2230 223e 3c2f 613e 0a20 2020  der="0"></a>.   
-000090e0: 2020 2020 200a 2020 2020 2020 2020 546f       .        To
-000090f0: 2076 6965 7720 7468 6520 6665 6174 7572   view the featur
-00009100: 6520 696d 706f 7274 616e 6365 7320 6f66  e importances of
-00009110: 2074 6865 206d 6f64 656c 2069 6e20 7468   the model in th
-00009120: 6520 7069 7065 6c69 6e65 2c20 796f 7520  e pipeline, you 
-00009130: 6361 6e20 646f 3a0a 2020 2020 2020 2020  can do:.        
-00009140: 6060 600a 2020 2020 2020 2020 6c61 7a79  ```.        lazy
-00009150: 2e70 6c6f 745f 696d 706f 7274 616e 6365  .plot_importance
-00009160: 2829 0a20 2020 2020 2020 2060 6060 0a20  ().        ```. 
-00009170: 2020 2020 2020 203c 6120 6872 6566 3d22         <a href="
-00009180: 6874 7470 733a 2f2f 6962 622e 636f 2f6a  https://ibb.co/j
-00009190: 6870 7356 744a 223e 3c69 6d67 2073 7263  hpsVtJ"><img src
-000091a0: 3d22 6874 7470 733a 2f2f 692e 6962 622e  ="https://i.ibb.
-000091b0: 636f 2f63 4a6d 5662 7159 2f6c 617a 792d  co/cJmVbqY/lazy-
-000091c0: 6665 6174 2d69 6d70 2e70 6e67 2220 616c  feat-imp.png" al
-000091d0: 743d 226c 617a 792d 6665 6174 2d69 6d70  t="lazy-feat-imp
-000091e0: 2220 626f 7264 6572 3d22 3022 3e3c 2f61  " border="0"></a
-000091f0: 3e0a 2020 2020 2020 2020 0a20 2020 2020  >.        .     
-00009200: 2020 2023 2320 4d61 696e 7461 696e 6572     ## Maintainer
-00009210: 730a 2020 2020 2020 2020 0a20 2020 2020  s.        .     
-00009220: 2020 202a 205b 4041 7574 6f56 694d 4c5d     * [@AutoViML]
-00009230: 2868 7474 7073 3a2f 2f67 6974 6875 622e  (https://github.
-00009240: 636f 6d2f 4175 746f 5669 4d4c 290a 2020  com/AutoViML).  
-00009250: 2020 2020 2020 0a20 2020 2020 2020 2023        .        #
-00009260: 2320 436f 6e74 7269 6275 7469 6e67 0a20  # Contributing. 
-00009270: 2020 2020 2020 200a 2020 2020 2020 2020         .        
-00009280: 5365 6520 5b74 6865 2063 6f6e 7472 6962  See [the contrib
-00009290: 7574 696e 6720 6669 6c65 5d28 434f 4e54  uting file](CONT
-000092a0: 5249 4255 5449 4e47 2e6d 6429 210a 2020  RIBUTING.md)!.  
-000092b0: 2020 2020 2020 0a20 2020 2020 2020 2050        .        P
-000092c0: 5273 2061 6363 6570 7465 642e 0a20 2020  Rs accepted..   
-000092d0: 2020 2020 200a 2020 2020 2020 2020 2323       .        ##
-000092e0: 204c 6963 656e 7365 0a20 2020 2020 2020   License.       
-000092f0: 200a 2020 2020 2020 2020 4170 6163 6865   .        Apache
-00009300: 204c 6963 656e 7365 2032 2e30 20c2 a920   License 2.0 .. 
-00009310: 3230 3230 2052 616d 2053 6573 6861 6472  2020 Ram Seshadr
-00009320: 690a 2020 2020 2020 2020 0a20 2020 2020  i.        .     
-00009330: 2020 2023 2320 4e6f 7465 206f 6620 4772     ## Note of Gr
-00009340: 6174 6974 7564 650a 2020 2020 2020 2020  atitude.        
-00009350: 0a20 2020 2020 2020 2054 6869 7320 6c69  .        This li
-00009360: 6272 6179 2077 6f75 6c64 206e 6f74 2068  bray would not h
-00009370: 6176 6520 6265 656e 2070 6f73 7369 626c  ave been possibl
-00009380: 6520 7769 7468 6f75 7420 7468 6520 666f  e without the fo
-00009390: 6c6c 6f77 696e 6720 6772 6561 7420 6c69  llowing great li
-000093a0: 6272 6172 6965 733a 0a20 2020 2020 2020  braries:.       
-000093b0: 203c 6f6c 3e0a 2020 2020 2020 2020 3c6c   <ol>.        <l
-000093c0: 693e 3c62 3e43 6174 6567 6f72 7920 456e  i><b>Category En
-000093d0: 636f 6465 7273 206c 6962 7261 7279 3a3c  coders library:<
-000093e0: 2f62 3e20 4661 6e74 6173 7469 6320 6c69  /b> Fantastic li
-000093f0: 6272 6172 7920 6874 7470 733a 2f2f 636f  brary https://co
-00009400: 6e74 7269 622e 7363 696b 6974 2d6c 6561  ntrib.scikit-lea
-00009410: 726e 2e6f 7267 2f63 6174 6567 6f72 795f  rn.org/category_
-00009420: 656e 636f 6465 7273 2f69 6e64 6578 2e68  encoders/index.h
-00009430: 746d 6c3c 2f6c 693e 0a20 2020 2020 2020  tml</li>.       
-00009440: 203c 6c69 3e3c 623e 496d 6261 6c61 6e63   <li><b>Imbalanc
-00009450: 6564 204c 6561 726e 206c 6962 7261 7279  ed Learn library
-00009460: 3a3c 2f62 3e20 416e 6f74 6865 7220 6661  :</b> Another fa
-00009470: 6e74 6173 7469 6320 6c69 6272 6172 7920  ntastic library 
-00009480: 6874 7470 733a 2f2f 696d 6261 6c61 6e63  https://imbalanc
-00009490: 6564 2d6c 6561 726e 2e6f 7267 2f73 7461  ed-learn.org/sta
-000094a0: 626c 652f 696e 6465 782e 6874 6d6c 3c2f  ble/index.html</
-000094b0: 6c69 3e0a 2020 2020 2020 2020 3c6c 693e  li>.        <li>
-000094c0: 3c62 3e54 6865 2061 6d61 7a69 6e67 2060  <b>The amazing `
-000094d0: 6c61 7a79 7072 6564 6963 7460 3c2f 623e  lazypredict`</b>
-000094e0: 2077 6173 2061 6e20 696e 7370 6972 6174   was an inspirat
-000094f0: 696f 6e20 666f 7220 606c 617a 7974 7261  ion for `lazytra
-00009500: 6e73 666f 726d 602e 2059 6f75 2063 616e  nsform`. You can
-00009510: 2063 6865 636b 206f 7574 2074 6865 206c   check out the l
-00009520: 6962 7261 7279 2068 6572 653a 0a20 2020  ibrary here:.   
-00009530: 2020 2020 2068 7474 7073 3a2f 2f67 6974       https://git
-00009540: 6875 622e 636f 6d2f 7368 616e 6b61 7270  hub.com/shankarp
-00009550: 616e 6461 6c61 2f6c 617a 7970 7265 6469  andala/lazypredi
-00009560: 6374 0a20 2020 2020 2020 203c 2f6c 693e  ct.        </li>
-00009570: 0a20 2020 2020 2020 203c 6c69 3e3c 623e  .        <li><b>
-00009580: 5468 6520 616d 617a 696e 6720 604b 6576  The amazing `Kev
-00009590: 696e 204d 6172 6b68 616d 603c 2f62 3e20  in Markham`</b> 
-000095a0: 7761 7320 616e 6f74 6865 7220 696e 7370  was another insp
-000095b0: 6972 6174 696f 6e20 666f 7220 6c61 7a79  iration for lazy
-000095c0: 7472 616e 7366 6f72 6d2e 2059 6f75 2063  transform. You c
-000095d0: 616e 2063 6865 636b 206f 7574 2068 6973  an check out his
-000095e0: 2063 6c61 7373 6573 2068 6572 653a 0a20   classes here:. 
-000095f0: 2020 2020 2020 2068 7474 7073 3a2f 2f77         https://w
-00009600: 7777 2e64 6174 6173 6368 6f6f 6c2e 696f  ww.dataschool.io
-00009610: 2f61 626f 7574 2f0a 2020 2020 2020 2020  /about/.        
-00009620: 3c2f 6c69 3e0a 2020 2020 2020 2020 3c2f  </li>.        </
-00009630: 6f6c 3e0a 2020 2020 2020 2020 0a20 2020  ol>.        .   
-00009640: 2020 2020 2023 2320 4449 5343 4c41 494d       ## DISCLAIM
-00009650: 4552 0a20 2020 2020 2020 2054 6869 7320  ER.        This 
-00009660: 7072 6f6a 6563 7420 6973 206e 6f74 2061  project is not a
-00009670: 6e20 6f66 6669 6369 616c 2047 6f6f 676c  n official Googl
-00009680: 6520 7072 6f6a 6563 742e 2049 7420 6973  e project. It is
-00009690: 206e 6f74 2073 7570 706f 7274 6564 2062   not supported b
-000096a0: 7920 476f 6f67 6c65 2061 6e64 2047 6f6f  y Google and Goo
-000096b0: 676c 6520 7370 6563 6966 6963 616c 6c79  gle specifically
-000096c0: 2064 6973 636c 6169 6d73 2061 6c6c 2077   disclaims all w
-000096d0: 6172 7261 6e74 6965 7320 6173 2074 6f20  arranties as to 
-000096e0: 6974 7320 7175 616c 6974 792c 206d 6572  its quality, mer
-000096f0: 6368 616e 7461 6269 6c69 7479 2c20 6f72  chantability, or
-00009700: 2066 6974 6e65 7373 2066 6f72 2061 2070   fitness for a p
-00009710: 6172 7469 6375 6c61 7220 7075 7270 6f73  articular purpos
-00009720: 652e 0a20 2020 2020 2020 200a 2020 2020  e..        .    
-00009730: 2020 2020 0a50 6c61 7466 6f72 6d3a 2055      .Platform: U
-00009740: 4e4b 4e4f 574e 0a43 6c61 7373 6966 6965  NKNOWN.Classifie
-00009750: 723a 2050 726f 6772 616d 6d69 6e67 204c  r: Programming L
-00009760: 616e 6775 6167 6520 3a3a 2050 7974 686f  anguage :: Pytho
-00009770: 6e20 3a3a 2033 0a43 6c61 7373 6966 6965  n :: 3.Classifie
-00009780: 723a 204f 7065 7261 7469 6e67 2053 7973  r: Operating Sys
-00009790: 7465 6d20 3a3a 204f 5320 496e 6465 7065  tem :: OS Indepe
-000097a0: 6e64 656e 740a 4465 7363 7269 7074 696f  ndent.Descriptio
-000097b0: 6e2d 436f 6e74 656e 742d 5479 7065 3a20  n-Content-Type: 
-000097c0: 7465 7874 2f6d 6172 6b64 6f77 6e0a 0000  text/markdown...
-000097d0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-000097e0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-000097f0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-00009800: 2e2f 2e2f 4050 6178 4865 6164 6572 0000  ././@PaxHeader..
-00009810: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-00009820: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-00009830: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-00009840: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-00009850: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-00009860: 0000 0000 3030 3030 3030 3000 3030 3030  ....0000000.0000
-00009870: 3030 3000 3030 3030 3030 3000 3030 3030  000.0000000.0000
-00009880: 3030 3030 3032 3600 3030 3030 3030 3030  0000026.00000000
-00009890: 3030 3000 3031 3134 3533 0020 7800 0000  000.011453. x...
-000098a0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-000098b0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-000098c0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-000098d0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-000098e0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-000098f0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-00009900: 0075 7374 6172 0030 3000 0000 0000 0000  .ustar.00.......
-00009910: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-00009920: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-00009930: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-00009940: 0000 0000 0000 0000 0030 3030 3030 3030  .........0000000
-00009950: 0030 3030 3030 3030 0000 0000 0000 0000  .0000000........
-00009960: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-00009970: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-00009980: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-00009990: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-000099a0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-000099b0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-000099c0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-000099d0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-000099e0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-000099f0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-00009a00: 3232 206d 7469 6d65 3d31 3636 3130 3932  22 mtime=1661092
-00009a10: 3135 352e 300a 0000 0000 0000 0000 0000  155.0...........
-00009a20: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-00009a30: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-00009a40: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-00009a50: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-00009a60: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-00009a70: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-00009a80: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-00009a90: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-00009aa0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-00009ab0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-00009ac0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-00009ad0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-00009ae0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-00009af0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-00009b00: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-00009b10: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-00009b20: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-00009b30: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-00009b40: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-00009b50: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-00009b60: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-00009b70: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-00009b80: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-00009b90: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-00009ba0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-00009bb0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-00009bc0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-00009bd0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-00009be0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-00009bf0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-00009c00: 6c61 7a79 7472 616e 7366 6f72 6d2d 312e  lazytransform-1.
-00009c10: 302f 5245 4144 4d45 2e6d 6400 0000 0000  0/README.md.....
-00009c20: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-00009c30: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-00009c40: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-00009c50: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-00009c60: 0000 0000 3030 3030 3737 3700 3030 3031  ....0000777.0001
-00009c70: 3735 3000 3030 3031 3735 3000 3030 3030  750.0001750.0000
-00009c80: 3030 3432 3031 3000 3030 3030 3030 3030  0042010.00000000
-00009c90: 3030 3000 3031 3531 3331 0020 3000 0000  000.015131. 0...
-00009ca0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-00009cb0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-00009cc0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-00009cd0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-00009ce0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-00009cf0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-00009d00: 0075 7374 6172 0030 3072 616d 0000 0000  .ustar.00ram....
-00009d10: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-00009d20: 0000 0000 0000 0000 0072 616d 0000 0000  .........ram....
-00009d30: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-00009d40: 0000 0000 0000 0000 0030 3030 3030 3030  .........0000000
-00009d50: 0030 3030 3030 3030 0000 0000 0000 0000  .0000000........
-00009d60: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-00009d70: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-00009d80: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-00009d90: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-00009da0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-00009db0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-00009dc0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-00009dd0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-00009de0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-00009df0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-00009e00: 2320 6c61 7a79 7472 616e 7366 6f72 6d0a  # lazytransform.
-00009e10: 4175 746f 6d61 7469 6361 6c6c 7920 7472  Automatically tr
-00009e20: 616e 7366 6f72 6d20 616c 6c20 6361 7465  ansform all cate
-00009e30: 676f 7269 6361 6c2c 2064 6174 652d 7469  gorical, date-ti
-00009e40: 6d65 2c20 4e4c 5020 7661 7269 6162 6c65  me, NLP variable
-00009e50: 7320 696e 2079 6f75 7220 6461 7461 2073  s in your data s
-00009e60: 6574 2074 6f20 6e75 6d65 7269 6320 696e  et to numeric in
-00009e70: 2061 2073 696e 676c 6520 6c69 6e65 206f   a single line o
-00009e80: 6620 636f 6465 2066 6f72 2061 6e79 2064  f code for any d
-00009e90: 6174 6120 7365 7420 616e 7920 7369 7a65  ata set any size
-00009ea0: 2e0a 0a3c 6120 6872 6566 3d22 6874 7470  ...<a href="http
-00009eb0: 733a 2f2f 6769 7468 7562 2e63 6f6d 2f41  s://github.com/A
-00009ec0: 7574 6f56 694d 4c2f 6c61 7a79 7472 616e  utoViML/lazytran
-00009ed0: 7366 6f72 6d22 3e3c 696d 6720 7372 633d  sform"><img src=
-00009ee0: 2268 7474 7073 3a2f 2f69 2e69 6262 2e63  "https://i.ibb.c
-00009ef0: 6f2f 576b 7446 6b74 4c2f 6c61 7a79 7472  o/WktFktL/lazytr
-00009f00: 616e 7366 6f72 6d65 722e 706e 6722 2061  ansformer.png" a
-00009f10: 6c74 3d22 6c61 7a79 7472 616e 7366 6f72  lt="lazytransfor
-00009f20: 6d65 7222 2062 6f72 6465 723d 2230 223e  mer" border="0">
-00009f30: 3c2f 613e 0a23 2320 5570 6461 7465 2028  </a>.## Update (
-00009f40: 4175 6720 3230 3232 290a 3c6f 6c3e 0a3c  Aug 2022).<ol>.<
-00009f50: 6c69 3e3c 623e 6c61 7a79 7472 616e 7366  li><b>lazytransf
-00009f60: 6f72 6d20 6973 2076 6572 7920 6561 7379  orm is very easy
-00009f70: 2074 6f20 696e 7374 616c 6c20 6f6e 204b   to install on K
-00009f80: 6167 676c 6520 616e 6420 436f 6c61 6220  aggle and Colab 
-00009f90: 6e6f 7465 626f 6f6b 7320 7573 696e 6720  notebooks using 
-00009fa0: 7468 6973 2063 6f6d 6d61 6e64 3a3c 2f62  this command:</b
-00009fb0: 3e2e 200a 0a60 6060 0a21 7069 7020 696e  >. ..```.!pip in
-00009fc0: 7374 616c 6c20 6c61 7a79 7472 616e 7366  stall lazytransf
-00009fd0: 6f72 6d20 2d2d 6967 6e6f 7265 2d69 6e73  orm --ignore-ins
-00009fe0: 7461 6c6c 6564 202d 2d6e 6f2d 6361 6368  talled --no-cach
-00009ff0: 6520 2d2d 6e6f 2d64 6570 730a 6060 600a  e --no-deps.```.
-0000a000: 3c2f 6c69 3e3c 6272 3e0a 3c6c 693e 3c62  </li><br>.<li><b
-0000a010: 3e6c 617a 7974 7261 6e73 666f 726d 2061  >lazytransform a
-0000a020: 7320 6f66 2076 6572 7369 6f6e 2030 2e39  s of version 0.9
-0000a030: 3120 6861 7320 7477 6f20 5375 7065 7220  1 has two Super 
-0000a040: 4c65 6172 6e69 6e67 204f 7074 696d 697a  Learning Optimiz
-0000a050: 6564 2028 5355 4c4f 2920 456e 7365 6d62  ed (SULO) Ensemb
-0000a060: 6c65 7320 6e61 6d65 6420 2253 756c 6f43  les named "SuloC
-0000a070: 6c61 7373 6966 6965 7222 2061 6e64 2022  lassifier" and "
-0000a080: 5375 6c6f 5265 6772 6573 736f 7222 3c2f  SuloRegressor"</
-0000a090: 623e 2e20 5468 6520 6573 7469 6d61 746f  b>. The estimato
-0000a0a0: 7273 2061 7265 2022 6f70 7469 6d69 7a65  rs are "optimize
-0000a0b0: 6422 2069 6e20 7468 6520 7365 6e73 6520  d" in the sense 
-0000a0c0: 7468 6174 2079 6f75 2063 616e 2075 7365  that you can use
-0000a0d0: 2074 6865 6d20 666f 7220 616c 6c20 6b69   them for all ki
-0000a0e0: 6e64 7320 6f66 206d 756c 7469 2d6c 6162  nds of multi-lab
-0000a0f0: 656c 206d 756c 7469 2d63 6c61 7373 2061  el multi-class a
-0000a100: 6e64 2049 6d62 616c 616e 6365 6420 6461  nd Imbalanced da
-0000a110: 7461 2073 6574 2070 726f 626c 656d 7320  ta set problems 
-0000a120: 7769 7468 6f75 7420 6e65 6564 696e 6720  without needing 
-0000a130: 746f 2064 6f20 6879 7065 722d 7061 7261  to do hyper-para
-0000a140: 6d65 7465 7220 7475 6e69 6e67 2077 6974  meter tuning wit
-0000a150: 6820 4772 6964 5365 6172 6368 4356 2e20  h GridSearchCV. 
-0000a160: 5468 6579 2061 7265 2062 7569 6c74 2075  They are built u
-0000a170: 7369 6e67 2062 6173 6963 2073 6369 6b69  sing basic sciki
-0000a180: 742d 6c65 6172 6e20 6573 7469 6d61 746f  t-learn estimato
-0000a190: 7273 2061 6e64 2061 7265 2073 656c 662d  rs and are self-
-0000a1a0: 6f70 7469 6d69 7a69 6e67 2073 696e 6365  optimizing since
-0000a1b0: 2074 6865 7920 7065 7266 6f72 6d20 6879   they perform hy
-0000a1c0: 7065 722d 7061 7261 6d20 7475 6e69 6e67  per-param tuning
-0000a1d0: 2066 6f72 2065 6163 6820 6b69 6e64 206f   for each kind o
-0000a1e0: 6620 7072 6f62 6c65 6d20 616e 6420 7573  f problem and us
-0000a1f0: 6520 7765 6967 6874 7320 666f 7220 6561  e weights for ea
-0000a200: 6368 2063 6c61 7373 6966 6965 7220 6f72  ch classifier or
-0000a210: 2072 6567 7265 7373 6f72 2c20 6469 6666   regressor, diff
-0000a220: 6572 656e 7420 7261 6e64 6f6d 2073 6565  erent random see
-0000a230: 6473 2c20 6574 632e 2074 6f20 6d61 6b65  ds, etc. to make
-0000a240: 2074 6865 6d20 6869 6768 6c79 2070 6572   them highly per
-0000a250: 666f 726d 616e 742e 204f 6e20 746f 7020  formant. On top 
-0000a260: 6f66 2069 742c 2074 6865 7920 6172 6520  of it, they are 
-0000a270: 6675 6c6c 7920 7363 696b 6974 2d6c 6561  fully scikit-lea
-0000a280: 726e 2063 6f6d 7061 7469 626c 6520 7769  rn compatible wi
-0000a290: 7468 2074 6865 2073 616d 6520 2266 6974  th the same "fit
-0000a2a0: 2061 6e64 2070 7265 6469 6374 2220 7379   and predict" sy
-0000a2b0: 6e74 6178 2e20 3c2f 6c69 3e0a 5461 6b65  ntax. </li>.Take
-0000a2c0: 2061 206c 6f6f 6b20 6174 2074 6865 2062   a look at the b
-0000a2d0: 656e 6368 6d61 726b 696e 6720 7265 7375  enchmarking resu
-0000a2e0: 6c74 7320 6e6f 7465 626f 6f6b 2068 6572  lts notebook her
-0000a2f0: 6520 666f 7220 5375 6c6f 436c 6173 7369  e for SuloClassi
-0000a300: 6669 6572 3a20 0a0a 215b 4e6f 7465 626f  fier: ..![Notebo
-0000a310: 6f6b 5d28 6874 7470 733a 2f2f 6769 7468  ok](https://gith
-0000a320: 7562 2e63 6f6d 2f41 7574 6f56 694d 4c2f  ub.com/AutoViML/
-0000a330: 6c61 7a79 7472 616e 7366 6f72 6d2f 7472  lazytransform/tr
-0000a340: 6565 2f6d 6169 6e2f 6e6f 7465 626f 6f6b  ee/main/notebook
-0000a350: 732f 5375 6c6f 436c 6173 7369 6669 6572  s/SuloClassifier
-0000a360: 5f42 656e 6368 6d61 726b 696e 675f 5265  _Benchmarking_Re
-0000a370: 7375 6c74 732e 6970 796e 6229 0a0a 215b  sults.ipynb)..![
-0000a380: 5375 6c6f 436c 6173 7369 6669 6572 5d28  SuloClassifier](
-0000a390: 2e2f 696d 6167 6573 2f53 756c 6f43 6c61  ./images/SuloCla
-0000a3a0: 7373 6966 6965 722e 706e 6729 0a0a 5765  ssifier.png)..We
-0000a3b0: 2072 616e 2061 2073 696d 696c 6172 2062   ran a similar b
-0000a3c0: 656e 6368 6d61 726b 696e 6720 7265 7375  enchmarking resu
-0000a3d0: 6c74 2069 6e20 5375 6c6f 5265 6772 6573  lt in SuloRegres
-0000a3e0: 736f 7220 6167 6169 6e73 7420 5847 426f  sor against XGBo
-0000a3f0: 6f73 7420 616e 6420 4c69 6768 7447 424d  ost and LightGBM
-0000a400: 2052 6567 7265 7373 6f72 7320 616e 6420   Regressors and 
-0000a410: 6974 2068 656c 6420 6974 7320 6f77 6e20  it held its own 
-0000a420: 6167 6169 6e73 7420 7468 656d 2e20 5461  against them. Ta
-0000a430: 6b65 2061 206c 6f6f 6b20 6174 2074 6865  ke a look at the
-0000a440: 2062 656e 6368 6d61 726b 696e 6720 7265   benchmarking re
-0000a450: 7375 6c74 3a0a 0a21 5b4e 6f74 6562 6f6f  sult:..![Noteboo
-0000a460: 6b5d 2868 7474 7073 3a2f 2f67 6974 6875  k](https://githu
-0000a470: 622e 636f 6d2f 4175 746f 5669 4d4c 2f6c  b.com/AutoViML/l
-0000a480: 617a 7974 7261 6e73 666f 726d 2f74 7265  azytransform/tre
-0000a490: 652f 6d61 696e 2f6e 6f74 6562 6f6f 6b73  e/main/notebooks
-0000a4a0: 2f53 756c 6f52 6567 7265 7373 6f72 5f42  /SuloRegressor_B
-0000a4b0: 656e 6368 6d61 726b 696e 675f 5265 7375  enchmarking_Resu
-0000a4c0: 6c74 732e 6970 796e 6229 0a0a 215b 5375  lts.ipynb)..![Su
-0000a4d0: 6c6f 5265 6772 6573 736f 725d 282e 2f69  loRegressor](./i
-0000a4e0: 6d61 6765 732f 5375 6c6f 5265 6772 6573  mages/SuloRegres
-0000a4f0: 736f 722e 706e 6729 0a0a 2320 5461 626c  sor.png)..# Tabl
-0000a500: 6520 6f66 2043 6f6e 7465 6e74 730a 3c75  e of Contents.<u
-0000a510: 6c3e 0a3c 6c69 3e3c 6120 6872 6566 3d22  l>.<li><a href="
-0000a520: 2369 6e74 726f 6475 6374 696f 6e22 3e57  #introduction">W
-0000a530: 6861 7420 6973 206c 617a 7974 7261 6e73  hat is lazytrans
-0000a540: 666f 726d 3c2f 613e 3c2f 6c69 3e0a 3c6c  form</a></li>.<l
-0000a550: 693e 3c61 2068 7265 663d 2223 7573 6573  i><a href="#uses
-0000a560: 223e 486f 7720 746f 2075 7365 206c 617a  ">How to use laz
-0000a570: 7974 7261 6e73 666f 726d 3c2f 613e 3c2f  ytransform</a></
-0000a580: 6c69 3e0a 3c6c 693e 3c61 2068 7265 663d  li>.<li><a href=
-0000a590: 2223 696e 7374 616c 6c22 3e48 6f77 2074  "#install">How t
-0000a5a0: 6f20 696e 7374 616c 6c20 6c61 7a79 7472  o install lazytr
-0000a5b0: 616e 7366 6f72 6d3c 2f61 3e3c 2f6c 693e  ansform</a></li>
-0000a5c0: 0a3c 6c69 3e3c 6120 6872 6566 3d22 2375  .<li><a href="#u
-0000a5d0: 7361 6765 223e 5573 6167 653c 2f61 3e3c  sage">Usage</a><
-0000a5e0: 2f6c 693e 0a3c 6c69 3e3c 6120 6872 6566  /li>.<li><a href
-0000a5f0: 3d22 2361 7069 223e 4150 493c 2f61 3e3c  ="#api">API</a><
-0000a600: 2f6c 693e 0a3c 6c69 3e3c 6120 6872 6566  /li>.<li><a href
-0000a610: 3d22 236d 6169 6e74 6169 6e65 7273 223e  ="#maintainers">
-0000a620: 4d61 696e 7461 696e 6572 733c 2f61 3e3c  Maintainers</a><
-0000a630: 2f6c 693e 0a3c 6c69 3e3c 6120 6872 6566  /li>.<li><a href
-0000a640: 3d22 2363 6f6e 7472 6962 7574 696e 6722  ="#contributing"
-0000a650: 3e43 6f6e 7472 6962 7574 696e 673c 2f61  >Contributing</a
-0000a660: 3e3c 2f6c 693e 0a3c 6c69 3e3c 6120 6872  ></li>.<li><a hr
-0000a670: 6566 3d22 236c 6963 656e 7365 223e 4c69  ef="#license">Li
-0000a680: 6365 6e73 653c 2f61 3e3c 2f6c 693e 0a3c  cense</a></li>.<
-0000a690: 2f75 6c3e 0a3c 703e 0a0a 2323 2049 6e74  /ul>.<p>..## Int
-0000a6a0: 726f 6475 6374 696f 6e0a 2323 2320 5768  roduction.### Wh
-0000a6b0: 6174 2069 7320 6c61 7a79 7472 616e 7366  at is lazytransf
-0000a6c0: 6f72 6d3f 0a60 6c61 7a79 7472 616e 7366  orm?.`lazytransf
-0000a6d0: 6f72 6d60 2069 7320 6120 6e65 7720 7079  orm` is a new py
-0000a6e0: 7468 6f6e 206c 6962 7261 7279 2066 6f72  thon library for
-0000a6f0: 2061 7574 6f6d 6174 6963 616c 6c79 2074   automatically t
-0000a700: 7261 6e73 666f 726d 696e 6720 796f 7572  ransforming your
-0000a710: 2065 6e74 6972 6520 6461 7461 7365 7420   entire dataset 
-0000a720: 746f 206e 756d 6572 6963 2066 6f72 6d61  to numeric forma
-0000a730: 7420 7573 696e 6720 6361 7465 676f 7279  t using category
-0000a740: 2065 6e63 6f64 6572 732c 204e 4c50 2074   encoders, NLP t
-0000a750: 6578 7420 7665 6374 6f72 697a 6572 7320  ext vectorizers 
-0000a760: 616e 6420 7061 6e64 6173 2064 6174 6520  and pandas date 
-0000a770: 7469 6d65 2070 726f 6365 7373 696e 6720  time processing 
-0000a780: 6675 6e63 7469 6f6e 732e 2041 6c6c 2069  functions. All i
-0000a790: 6e20 6120 7369 6e67 6c65 206c 696e 6520  n a single line 
-0000a7a0: 6f66 2063 6f64 6521 0a0a 3c61 2068 7265  of code!..<a hre
-0000a7b0: 663d 2268 7474 7073 3a2f 2f67 6974 6875  f="https://githu
-0000a7c0: 622e 636f 6d2f 4175 746f 5669 4d4c 2f6c  b.com/AutoViML/l
-0000a7d0: 617a 7974 7261 6e73 666f 726d 223e 3c69  azytransform"><i
-0000a7e0: 6d67 2073 7263 3d22 6874 7470 733a 2f2f  mg src="https://
-0000a7f0: 692e 6962 622e 636f 2f6e 7a59 7873 386b  i.ibb.co/nzYxs8k
-0000a800: 2f6c 617a 7974 7261 6e73 666f 726d 6572  /lazytransformer
-0000a810: 2e70 6e67 2220 616c 743d 226c 617a 7974  .png" alt="lazyt
-0000a820: 7261 6e73 666f 726d 6572 2220 626f 7264  ransformer" bord
-0000a830: 6572 3d22 3022 3e3c 2f61 3e0a 0a23 2320  er="0"></a>..## 
-0000a840: 5573 6573 0a60 6c61 7a79 7472 616e 7366  Uses.`lazytransf
-0000a850: 6f72 6d60 2068 6173 2074 776f 2069 6d70  orm` has two imp
-0000a860: 6f72 7461 6e74 2075 7365 7320 696e 2074  ortant uses in t
-0000a870: 6865 2044 6174 6120 5363 6965 6e63 6520  he Data Science 
-0000a880: 7072 6f63 6573 732e 2049 7420 6361 6e20  process. It can 
-0000a890: 6265 2075 7365 6420 696e 2046 6561 7475  be used in Featu
-0000a8a0: 7265 2045 6e67 6720 746f 2074 7261 6e73  re Engg to trans
-0000a8b0: 666f 726d 2066 6561 7475 7265 7320 6f72  form features or
-0000a8c0: 2061 6464 2066 6561 7475 7265 7320 2873   add features (s
-0000a8d0: 6565 2041 5049 2062 656c 6f77 292e 2049  ee API below). I
-0000a8e0: 7420 6361 6e20 616c 736f 2062 6520 7573  t can also be us
-0000a8f0: 6564 2069 6e20 4d4c 4f70 7320 746f 2074  ed in MLOps to t
-0000a900: 7261 696e 2061 6e64 2065 7661 6c75 6174  rain and evaluat
-0000a910: 6520 6d6f 6465 6c73 2069 6e20 6461 7461  e models in data
-0000a920: 2070 6970 656c 696e 6573 2077 6974 6820   pipelines with 
-0000a930: 6d75 6c74 6970 6c65 206d 6f64 656c 7320  multiple models 
-0000a940: 6265 696e 6720 7472 6169 6e65 6420 7369  being trained si
-0000a950: 6d75 6c74 616e 6575 736c 7920 7573 696e  multaneusly usin
-0000a960: 6720 7468 6520 7361 6d65 2074 7261 696e  g the same train
-0000a970: 2f74 6573 7420 7370 6c69 7420 616e 6420  /test split and 
-0000a980: 7468 6520 7361 6d65 2066 6561 7475 7265  the same feature
-0000a990: 2065 6e67 6720 7374 6570 732e 2054 6869   engg steps. Thi
-0000a9a0: 7320 656e 7375 7265 7320 7468 6174 2074  s ensures that t
-0000a9b0: 6865 7265 2069 7320 6162 736f 6c75 7465  here is absolute
-0000a9c0: 6c79 207a 6572 6f20 6f72 206d 696e 696d  ly zero or minim
-0000a9d0: 616c 2064 6174 6120 6c65 616b 6167 6520  al data leakage 
-0000a9e0: 696e 2079 6f75 7220 4d4c 4f70 7320 7069  in your MLOps pi
-0000a9f0: 7065 6c69 6e65 732e 0a0a 2323 2320 312e  pelines...### 1.
-0000aa00: 2020 5573 696e 6720 6c61 7a79 7472 616e    Using lazytran
-0000aa10: 7366 6f72 6d20 6173 2061 2073 696d 706c  sform as a simpl
-0000aa20: 6520 7061 6e64 6173 2064 6174 6120 7472  e pandas data tr
-0000aa30: 616e 7366 6f72 6d61 7469 6f6e 2070 6970  ansformation pip
-0000aa40: 656c 696e 6520 0a0a 3c70 3e54 6865 2066  eline ..<p>The f
-0000aa50: 6972 7374 206d 6574 686f 6420 6973 2070  irst method is p
-0000aa60: 726f 6261 626c 7920 7468 6520 6d6f 7374  robably the most
-0000aa70: 2070 6f70 756c 6172 2077 6179 2074 6f20   popular way to 
-0000aa80: 7573 6520 6c61 7a79 7472 616e 7366 6f72  use lazytransfor
-0000aa90: 6d2e 2054 6865 2074 7261 6e73 666f 726d  m. The transform
-0000aaa0: 6572 2077 6974 6869 6e20 6c61 7a79 7472  er within lazytr
-0000aab0: 616e 7366 6f72 6d20 6361 6e20 6265 2075  ansform can be u
-0000aac0: 7365 6420 746f 2074 7261 6e73 666f 726d  sed to transform
-0000aad0: 2061 6e64 2063 7265 6174 6520 6e65 7720   and create new 
-0000aae0: 6665 6174 7572 6573 2066 726f 6d20 6361  features from ca
-0000aaf0: 7465 676f 7269 6361 6c2c 2064 6174 652d  tegorical, date-
-0000ab00: 7469 6d65 2061 6e64 204e 4c50 2028 7465  time and NLP (te
-0000ab10: 7874 2920 6665 6174 7572 6573 2069 6e20  xt) features in 
-0000ab20: 796f 7572 2064 6174 6173 6574 2e20 5468  your dataset. Th
-0000ab30: 6973 2074 7261 6e73 666f 726d 6572 2070  is transformer p
-0000ab40: 6970 656c 696e 6520 6973 2066 756c 6c79  ipeline is fully
-0000ab50: 2073 6369 6b69 742d 6c65 6172 6e20 5069   scikit-learn Pi
-0000ab60: 7065 6c69 6e65 2063 6f6d 7061 7469 626c  peline compatibl
-0000ab70: 6520 616e 6420 6361 6e20 6265 2075 7365  e and can be use
-0000ab80: 6420 746f 2062 7569 6c64 2065 7665 6e20  d to build even 
-0000ab90: 6d6f 7265 2063 6f6d 706c 6578 2070 6970  more complex pip
-0000aba0: 656c 696e 6573 2062 7920 796f 7520 6261  elines by you ba
-0000abb0: 7365 6420 6f6e 2060 6d61 6b65 5f70 6970  sed on `make_pip
-0000abc0: 656c 696e 6560 2073 7461 7465 6d65 6e74  eline` statement
-0000abd0: 2066 726f 6d20 6073 6b6c 6561 726e 2e70   from `sklearn.p
-0000abe0: 6970 656c 696e 6560 206c 6962 7261 7279  ipeline` library
-0000abf0: 2e20 3c61 2068 7265 663d 2268 7474 7073  . <a href="https
-0000ac00: 3a2f 2f67 6974 6875 622e 636f 6d2f 4175  ://github.com/Au
-0000ac10: 746f 5669 4d4c 2f6c 617a 7974 7261 6e73  toViML/lazytrans
-0000ac20: 666f 726d 2f62 6c6f 622f 6d61 696e 2f46  form/blob/main/F
-0000ac30: 6561 7475 7265 7769 7a5f 4c61 7a79 5472  eaturewiz_LazyTr
-0000ac40: 616e 7366 6f72 6d5f 4465 6d6f 312e 6970  ansform_Demo1.ip
-0000ac50: 796e 6222 3e4c 6574 2075 7320 7365 6520  ynb">Let us see 
-0000ac60: 616e 2065 7861 6d70 6c65 3c2f 613e 3a3c  an example</a>:<
-0000ac70: 703e 0a0a 3c61 2068 7265 663d 2268 7474  p>..<a href="htt
-0000ac80: 7073 3a2f 2f69 6262 2e63 6f2f 7866 4d51  ps://ibb.co/xfMQ
-0000ac90: 6e4e 7a22 3e3c 696d 6720 7372 633d 2268  nNz"><img src="h
-0000aca0: 7474 7073 3a2f 2f69 2e69 6262 2e63 6f2f  ttps://i.ibb.co/
-0000acb0: 5a59 6843 5130 632f 6c61 7a79 2d63 6f64  ZYhCQ0c/lazy-cod
-0000acc0: 6531 2e70 6e67 2220 616c 743d 226c 617a  e1.png" alt="laz
-0000acd0: 792d 636f 6465 3122 2062 6f72 6465 723d  y-code1" border=
-0000ace0: 2230 223e 3c2f 613e 0a0a 2323 2320 322e  "0"></a>..### 2.
-0000acf0: 2020 5573 696e 6720 6c61 7a79 7472 616e    Using lazytran
-0000ad00: 7366 6f72 6d20 6173 2061 2073 6b6c 6561  sform as a sklea
-0000ad10: 726e 2070 6970 656c 696e 6520 7769 7468  rn pipeline with
-0000ad20: 2073 6b6c 6561 726e 206d 6f64 656c 7320   sklearn models 
-0000ad30: 6f72 2058 4742 6f6f 7374 206f 7220 4c69  or XGBoost or Li
-0000ad40: 6768 7447 424d 206d 6f64 656c 730a 0a3c  ghtGBM models..<
-0000ad50: 703e 5468 6520 7365 636f 6e64 206d 6574  p>The second met
-0000ad60: 686f 6420 6973 2061 2067 7265 6174 2077  hod is a great w
-0000ad70: 6179 2074 6f20 6372 6561 7465 2061 6e20  ay to create an 
-0000ad80: 656e 7469 7265 2064 6174 6120 7472 616e  entire data tran
-0000ad90: 7366 6f72 6d20 616e 6420 6d6f 6465 6c20  sform and model 
-0000ada0: 7472 6169 6e69 6e67 2070 6970 656c 696e  training pipelin
-0000adb0: 6520 7769 7468 2061 6273 6f6c 7574 656c  e with absolutel
-0000adc0: 7920 6e6f 2064 6174 6120 6c65 616b 6167  y no data leakag
-0000add0: 652e 2060 6c61 7a79 7472 616e 7366 6f72  e. `lazytransfor
-0000ade0: 6d60 2061 6c6c 6f77 7320 796f 7520 746f  m` allows you to
-0000adf0: 2073 656e 6420 696e 2061 206d 6f64 656c   send in a model
-0000ae00: 206f 626a 6563 7420 286f 6e6c 7920 7468   object (only th
-0000ae10: 6520 666f 6c6c 6f77 696e 6720 6172 6520  e following are 
-0000ae20: 7375 7070 6f72 7465 6429 2061 6e64 2069  supported) and i
-0000ae30: 7420 7769 6c6c 2061 7574 6f6d 6174 6963  t will automatic
-0000ae40: 616c 6c79 2074 7261 6e73 666f 726d 2c20  ally transform, 
-0000ae50: 6372 6561 7465 206e 6577 2066 6561 7475  create new featu
-0000ae60: 7265 7320 616e 6420 7472 6169 6e20 6120  res and train a 
-0000ae70: 6d6f 6465 6c20 7573 696e 6720 736b 6c65  model using skle
-0000ae80: 6172 6e20 7069 7065 6c69 6e65 732e 203c  arn pipelines. <
-0000ae90: 6120 6872 6566 3d22 6874 7470 733a 2f2f  a href="https://
-0000aea0: 6769 7468 7562 2e63 6f6d 2f41 7574 6f56  github.com/AutoV
-0000aeb0: 694d 4c2f 6c61 7a79 7472 616e 7366 6f72  iML/lazytransfor
-0000aec0: 6d2f 626c 6f62 2f6d 6169 6e2f 4665 6174  m/blob/main/Feat
-0000aed0: 7572 6577 697a 5f4c 617a 7954 7261 6e73  urewiz_LazyTrans
-0000aee0: 666f 726d 5f44 656d 6f32 2e69 7079 6e62  form_Demo2.ipynb
-0000aef0: 223e 5468 6973 206d 6574 686f 6420 6361  ">This method ca
-0000af00: 6e20 6265 2073 6565 6e20 6173 2066 6f6c  n be seen as fol
-0000af10: 6c6f 7773 3c2f 613e 3a3c 6272 3e0a 0a3c  lows</a>:<br>..<
-0000af20: 6120 6872 6566 3d22 6874 7470 733a 2f2f  a href="https://
-0000af30: 6962 622e 636f 2f54 3157 4e68 7a54 223e  ibb.co/T1WNhzT">
-0000af40: 3c69 6d67 2073 7263 3d22 6874 7470 733a  <img src="https:
-0000af50: 2f2f 692e 6962 622e 636f 2f30 4b73 7a4a  //i.ibb.co/0KszJ
-0000af60: 5058 2f6c 617a 792d 636f 6465 322e 706e  PX/lazy-code2.pn
-0000af70: 6722 2061 6c74 3d22 6c61 7a79 2d63 6f64  g" alt="lazy-cod
-0000af80: 6532 2220 626f 7264 6572 3d22 3022 3e3c  e2" border="0"><
-0000af90: 2f61 3e0a 0a23 2323 2033 2e20 2055 7369  /a>..### 3.  Usi
-0000afa0: 6e67 206c 617a 7974 7261 6e73 666f 726d  ng lazytransform
-0000afb0: 2069 6e20 4772 6964 5365 6172 6368 4356   in GridSearchCV
-0000afc0: 2074 6f20 6669 6e64 2074 6865 2062 6573   to find the bes
-0000afd0: 7420 6d6f 6465 6c20 7069 7065 6c69 6e65  t model pipeline
-0000afe0: 0a3c 703e 5468 6520 7468 6972 6420 6d65  .<p>The third me
-0000aff0: 7468 6f64 2069 7320 6120 6772 6561 7420  thod is a great 
-0000b000: 7761 7920 746f 2066 696e 6420 7468 6520  way to find the 
-0000b010: 6265 7374 2064 6174 6120 7472 616e 7366  best data transf
-0000b020: 6f72 6d61 7469 6f6e 2061 6e64 206d 6f64  ormation and mod
-0000b030: 656c 2074 7261 696e 696e 6720 7069 7065  el training pipe
-0000b040: 6c69 6e65 2075 7369 6e67 2047 7269 6453  line using GridS
-0000b050: 6561 7263 6843 5620 6f72 2052 616e 646f  earchCV or Rando
-0000b060: 6d69 7a65 6453 6561 7263 6843 5620 616c  mizedSearchCV al
-0000b070: 6f6e 6720 7769 7468 2061 204c 6967 6874  ong with a Light
-0000b080: 4742 4d20 6f72 2058 4742 6f6f 7374 206f  GBM or XGBoost o
-0000b090: 7220 7363 696b 6974 2d6c 6561 726e 206d  r scikit-learn m
-0000b0a0: 6f64 656c 2e20 5468 6973 2069 7320 6578  odel. This is ex
-0000b0b0: 706c 6169 6e65 6420 7665 7279 2063 6c65  plained very cle
-0000b0c0: 6172 6c79 2069 6e20 7468 6520 3c61 2068  arly in the <a h
-0000b0d0: 7265 663d 2268 7474 7073 3a2f 2f67 6974  ref="https://git
-0000b0e0: 6875 622e 636f 6d2f 4175 746f 5669 4d4c  hub.com/AutoViML
-0000b0f0: 2f6c 617a 7974 7261 6e73 666f 726d 2f62  /lazytransform/b
-0000b100: 6c6f 622f 6d61 696e 2f4c 617a 7954 7261  lob/main/LazyTra
-0000b110: 6e73 666f 726d 6572 5f77 6974 685f 4772  nsformer_with_Gr
-0000b120: 6964 5365 6172 6368 5f50 6970 656c 696e  idSearch_Pipelin
-0000b130: 652e 6970 796e 6222 3e4c 617a 7954 7261  e.ipynb">LazyTra
-0000b140: 6e73 666f 726d 6572 5f77 6974 685f 4772  nsformer_with_Gr
-0000b150: 6964 5365 6172 6368 5f50 6970 656c 696e  idSearch_Pipelin
-0000b160: 652e 6970 796e 623c 2f61 3e20 6e6f 7465  e.ipynb</a> note
-0000b170: 626f 6f6b 2069 6e20 7468 6520 7361 6d65  book in the same
-0000b180: 2067 6974 6875 6220 6865 7265 2e20 4d61   github here. Ma
-0000b190: 6b65 2073 7572 6520 796f 7520 6368 6563  ke sure you chec
-0000b1a0: 6b20 6974 206f 7574 210a 0a3c 6120 6872  k it out!..<a hr
-0000b1b0: 6566 3d22 6874 7470 733a 2f2f 6962 622e  ef="https://ibb.
-0000b1c0: 636f 2f57 4776 6e71 6a73 223e 3c69 6d67  co/WGvnqjs"><img
-0000b1d0: 2073 7263 3d22 6874 7470 733a 2f2f 692e   src="https://i.
-0000b1e0: 6962 622e 636f 2f78 5871 6850 6433 2f6c  ibb.co/xXqhPd3/l
-0000b1f0: 617a 792d 6772 6964 7365 6172 6368 2e70  azy-gridsearch.p
-0000b200: 6e67 2220 616c 743d 226c 617a 792d 6772  ng" alt="lazy-gr
-0000b210: 6964 7365 6172 6368 2220 626f 7264 6572  idsearch" border
-0000b220: 3d22 3022 3e3c 2f61 3e3c 6272 202f 3e0a  ="0"></a><br />.
-0000b230: 0a3c 703e 0a54 6865 2066 6f6c 6c6f 7769  .<p>.The followi
-0000b240: 6e67 206d 6f64 656c 7320 6172 6520 6375  ng models are cu
-0000b250: 7272 656e 746c 7920 7375 7070 6f72 7465  rrently supporte
-0000b260: 643a 0a3c 6f6c 3e0a 3c6c 693e 416c 6c20  d:.<ol>.<li>All 
-0000b270: 736b 6c65 6172 6e20 6d6f 6465 6c73 3c2f  sklearn models</
-0000b280: 6c69 3e0a 3c6c 693e 416c 6c20 4d75 6c74  li>.<li>All Mult
-0000b290: 694f 7574 7075 7420 6d6f 6465 6c73 2066  iOutput models f
-0000b2a0: 726f 6d20 736b 6c65 6172 6e2e 6d75 6c74  rom sklearn.mult
-0000b2b0: 696f 7574 7075 7420 6c69 6272 6172 793c  ioutput library<
-0000b2c0: 2f6c 693e 0a3c 6c69 3e58 4762 6f6f 7374  /li>.<li>XGboost
-0000b2d0: 206d 6f64 656c 733c 2f6c 693e 0a3c 6c69   models</li>.<li
-0000b2e0: 3e4c 6967 6874 4742 4d20 6d6f 6465 6c73  >LightGBM models
-0000b2f0: 3c2f 6c69 3e0a 3c2f 6f6c 3e0a 486f 7765  </li>.</ol>.Howe
-0000b300: 7665 722c 2079 6f75 206d 7573 7420 696e  ver, you must in
-0000b310: 7374 616c 6c20 616e 6420 696d 706f 7274  stall and import
-0000b320: 2074 686f 7365 206d 6f64 656c 7320 6f6e   those models on
-0000b330: 2079 6f75 7220 6f77 6e20 616e 6420 6465   your own and de
-0000b340: 6669 6e65 2074 6865 6d20 6173 206d 6f64  fine them as mod
-0000b350: 656c 2076 6172 6961 626c 6573 2062 6566  el variables bef
-0000b360: 6f72 6520 7061 7373 696e 6720 7468 6f73  ore passing thos
-0000b370: 6520 7661 7269 6162 6c65 7320 746f 206c  e variables to l
-0000b380: 617a 7974 7261 6e73 666f 726d 2e0a 0a23  azytransform...#
-0000b390: 2320 496e 7374 616c 6c0a 3c70 3e0a 0a2a  # Install.<p>..*
-0000b3a0: 2a50 7265 7265 7175 7369 7465 733a 2a2a  *Prerequsites:**
-0000b3b0: 0a3c 6f6c 3e0a 3c6c 693e 3c62 3e6c 617a  .<ol>.<li><b>laz
-0000b3c0: 7974 7261 6e73 666f 726d 2069 7320 6275  ytransform is bu
-0000b3d0: 696c 7420 7573 696e 6720 7061 6e64 6173  ilt using pandas
-0000b3e0: 2c20 6e75 6d70 792c 2073 6369 6b69 742d  , numpy, scikit-
-0000b3f0: 6c65 6172 6e2c 2063 6174 6567 6f72 795f  learn, category_
-0000b400: 656e 636f 6465 7273 2061 6e64 2069 6d62  encoders and imb
-0000b410: 616c 616e 6365 642d 6c65 6172 6e20 6c69  alanced-learn li
-0000b420: 6272 6172 6965 732e 3c2f 623e 2049 7420  braries.</b> It 
-0000b430: 7368 6f75 6c64 2072 756e 206f 6e20 6d6f  should run on mo
-0000b440: 7374 2050 7974 686f 6e33 2041 6e61 636f  st Python3 Anaco
-0000b450: 6e64 6120 696e 7374 616c 6c61 7469 6f6e  nda installation
-0000b460: 7320 7769 7468 6f75 7420 6164 6469 7469  s without additi
-0000b470: 6f6e 616c 2069 6e73 7461 6c6c 732e 2059  onal installs. Y
-0000b480: 6f75 2077 6f6e 2774 2068 6176 6520 746f  ou won't have to
-0000b490: 2069 6d70 6f72 7420 616e 7920 7370 6563   import any spec
-0000b4a0: 6961 6c20 6c69 6272 6172 6965 7320 6f74  ial libraries ot
-0000b4b0: 6865 7220 7468 616e 2022 696d 6261 6c61  her than "imbala
-0000b4c0: 6e63 6564 2d6c 6561 726e 2220 616e 6420  nced-learn" and 
-0000b4d0: 2263 6174 6567 6f72 795f 656e 636f 6465  "category_encode
-0000b4e0: 7273 222e 3c2f 6c69 3e0a 3c2f 6f6c 3e0a  rs".</li>.</ol>.
-0000b4f0: 5468 6520 6265 7374 206d 6574 686f 6420  The best method 
-0000b500: 746f 2069 6e73 7461 6c6c 206c 617a 7974  to install lazyt
-0000b510: 7261 6e73 666f 726d 2069 7320 746f 2075  ransform is to u
-0000b520: 7365 2063 6f6e 6461 3a3c 703e 0a0a 6060  se conda:<p>..``
-0000b530: 600a 636f 6e64 6120 696e 7374 616c 6c20  `.conda install 
-0000b540: 2d63 2063 6f6e 6461 2d66 6f72 6765 206c  -c conda-forge l
-0000b550: 617a 7974 7261 6e73 666f 726d 0a60 6060  azytransform.```
-0000b560: 0a3c 6120 6872 6566 3d22 6874 7470 733a  .<a href="https:
-0000b570: 2f2f 6962 622e 636f 2f66 586e 6250 6436  //ibb.co/fXnbPd6
-0000b580: 223e 3c69 6d67 2073 7263 3d22 6874 7470  "><img src="http
-0000b590: 733a 2f2f 692e 6962 622e 636f 2f71 4457  s://i.ibb.co/qDW
-0000b5a0: 7a50 5971 2f63 6f6e 6461 2d69 6e73 7461  zPYq/conda-insta
-0000b5b0: 6c6c 2e70 6e67 2220 616c 743d 2263 6f6e  ll.png" alt="con
-0000b5c0: 6461 2d69 6e73 7461 6c6c 2220 626f 7264  da-install" bord
-0000b5d0: 6572 3d22 3022 3e3c 2f61 3e3c 6272 3e0a  er="0"></a><br>.
-0000b5e0: 5468 6520 7365 636f 6e64 2062 6573 7420  The second best 
-0000b5f0: 696e 7374 616c 6c61 7469 6f6e 206d 6574  installation met
-0000b600: 686f 6420 6973 2074 6f20 7573 6520 2270  hod is to use "p
-0000b610: 6970 2069 6e73 7461 6c6c 222e 0a0a 6060  ip install"...``
-0000b620: 600a 7069 7020 696e 7374 616c 6c20 6c61  `.pip install la
-0000b630: 7a79 7472 616e 7366 6f72 6d20 0a60 6060  zytransform .```
-0000b640: 0a41 6c65 7274 2120 5768 656e 2075 7369  .Alert! When usi
-0000b650: 6e67 2043 6f6c 6162 206f 7220 4b61 6767  ng Colab or Kagg
-0000b660: 6c65 204e 6f74 6562 6f6f 6b73 2c20 796f  le Notebooks, yo
-0000b670: 7520 6d75 7374 2075 7365 2061 2073 6c69  u must use a sli
-0000b680: 6768 746c 7920 6d6f 6469 6679 2069 6e73  ghtly modify ins
-0000b690: 7461 6c6c 6174 696f 6e20 7072 6f63 6573  tallation proces
-0000b6a0: 7320 6265 6c6f 772e 2049 6620 796f 7520  s below. If you 
-0000b6b0: 646f 6e27 7420 646f 2074 6869 732c 2079  don't do this, y
-0000b6c0: 6f75 2077 696c 6c20 6765 7420 7765 6972  ou will get weir
-0000b6d0: 6420 6572 726f 7273 2069 6e20 7468 6f73  d errors in thos
-0000b6e0: 6520 706c 6174 666f 726d 7321 0a0a 6060  e platforms!..``
-0000b6f0: 600a 7069 7020 696e 7374 616c 6c20 6c61  `.pip install la
-0000b700: 7a79 7472 616e 7366 6f72 6d20 2d2d 6967  zytransform --ig
-0000b710: 6e6f 7265 2d69 6e73 7461 6c6c 6564 202d  nore-installed -
-0000b720: 2d6e 6f2d 6465 7073 0a70 6970 2069 6e73  -no-deps.pip ins
-0000b730: 7461 6c6c 2063 6174 6567 6f72 792d 656e  tall category-en
-0000b740: 636f 6465 7273 202d 2d69 676e 6f72 652d  coders --ignore-
-0000b750: 696e 7374 616c 6c65 6420 2d2d 6e6f 2d64  installed --no-d
-0000b760: 6570 730a 0a60 6060 0a0a 546f 2069 6e73  eps..```..To ins
-0000b770: 7461 6c6c 2066 726f 6d20 736f 7572 6365  tall from source
-0000b780: 3a0a 0a60 6060 0a63 6420 3c6c 617a 7974  :..```.cd <lazyt
-0000b790: 7261 6e73 666f 726d 5f44 6573 7469 6e61  ransform_Destina
-0000b7a0: 7469 6f6e 3e0a 6769 7420 636c 6f6e 6520  tion>.git clone 
-0000b7b0: 6769 7440 6769 7468 7562 2e63 6f6d 3a41  git@github.com:A
-0000b7c0: 7574 6f56 694d 4c2f 6c61 7a79 7472 616e  utoViML/lazytran
-0000b7d0: 7366 6f72 6d2e 6769 740a 6060 600a 6f72  sform.git.```.or
-0000b7e0: 2064 6f77 6e6c 6f61 6420 616e 6420 756e   download and un
-0000b7f0: 7a69 7020 6874 7470 733a 2f2f 6769 7468  zip https://gith
-0000b800: 7562 2e63 6f6d 2f41 7574 6f56 694d 4c2f  ub.com/AutoViML/
-0000b810: 6c61 7a79 7472 616e 7366 6f72 6d2f 6172  lazytransform/ar
-0000b820: 6368 6976 652f 6d61 7374 6572 2e7a 6970  chive/master.zip
-0000b830: 0a60 6060 0a63 6f6e 6461 2063 7265 6174  .```.conda creat
-0000b840: 6520 2d6e 203c 796f 7572 5f65 6e76 5f6e  e -n <your_env_n
-0000b850: 616d 653e 2070 7974 686f 6e3d 332e 3720  ame> python=3.7 
-0000b860: 616e 6163 6f6e 6461 0a63 6f6e 6461 2061  anaconda.conda a
-0000b870: 6374 6976 6174 6520 3c79 6f75 725f 656e  ctivate <your_en
-0000b880: 765f 6e61 6d65 3e20 2320 4f4e 2057 494e  v_name> # ON WIN
-0000b890: 444f 5753 3a20 6073 6f75 7263 6520 6163  DOWS: `source ac
-0000b8a0: 7469 7661 7465 203c 796f 7572 5f65 6e76  tivate <your_env
-0000b8b0: 5f6e 616d 653e 600a 6364 206c 617a 7974  _name>`.cd lazyt
-0000b8c0: 7261 6e73 666f 726d 0a70 6970 2069 6e73  ransform.pip ins
-0000b8d0: 7461 6c6c 202d 7220 7265 7175 6972 656d  tall -r requirem
-0000b8e0: 656e 7473 2e74 7874 0a60 6060 0a0a 2323  ents.txt.```..##
-0000b8f0: 2055 7361 6765 0a3c 703e 0a59 6f75 2063   Usage.<p>.You c
-0000b900: 616e 2069 6e76 6f6b 6520 606c 617a 7974  an invoke `lazyt
-0000b910: 7261 6e73 666f 726d 6020 6173 2061 2073  ransform` as a s
-0000b920: 6369 6b69 742d 6c65 6172 6e20 636f 6d70  cikit-learn comp
-0000b930: 6174 6962 6c65 2066 6974 2061 6e64 2074  atible fit and t
-0000b940: 7261 6e73 666f 726d 206f 7220 6120 6669  ransform or a fi
-0000b950: 7420 616e 6420 7072 6564 6963 7420 7069  t and predict pi
-0000b960: 7065 6c69 6e65 2e20 5365 6520 7379 6e74  peline. See synt
-0000b970: 6178 2062 656c 6f77 2e3c 703e 0a0a 6060  ax below.<p>..``
-0000b980: 600a 6672 6f6d 206c 617a 7974 7261 6e73  `.from lazytrans
-0000b990: 666f 726d 2069 6d70 6f72 7420 4c61 7a79  form import Lazy
-0000b9a0: 5472 616e 7366 6f72 6d65 720a 6c61 7a79  Transformer.lazy
-0000b9b0: 203d 204c 617a 7954 7261 6e73 666f 726d   = LazyTransform
-0000b9c0: 6572 286d 6f64 656c 3d4e 6f6e 652c 2065  er(model=None, e
-0000b9d0: 6e63 6f64 6572 733d 2761 7574 6f27 2c20  ncoders='auto', 
-0000b9e0: 7363 616c 6572 733d 4e6f 6e65 2c20 0a20  scalers=None, . 
-0000b9f0: 2020 2020 2020 2064 6174 655f 746f 5f73         date_to_s
-0000ba00: 7472 696e 673d 4661 6c73 652c 2074 7261  tring=False, tra
-0000ba10: 6e73 666f 726d 5f74 6172 6765 743d 4661  nsform_target=Fa
-0000ba20: 6c73 652c 2069 6d62 616c 616e 6365 643d  lse, imbalanced=
-0000ba30: 4661 6c73 652c 0a20 2020 2020 2020 2063  False,.        c
-0000ba40: 6f6d 6269 6e65 5f72 6172 653d 4661 6c73  ombine_rare=Fals
-0000ba50: 652c 2076 6572 626f 7365 3d30 290a 6060  e, verbose=0).``
-0000ba60: 600a 0a23 2323 2069 6620 796f 7520 6172  `..### if you ar
-0000ba70: 6520 6e6f 7420 7573 696e 6720 6120 6d6f  e not using a mo
-0000ba80: 6465 6c20 696e 2070 6970 656c 696e 652c  del in pipeline,
-0000ba90: 2079 6f75 206d 7573 7420 7573 6520 6669   you must use fi
-0000baa0: 7420 616e 6420 7472 616e 7366 6f72 6d0a  t and transform.
-0000bab0: 6060 600a 585f 7472 6169 6e6d 2c20 795f  ```.X_trainm, y_
-0000bac0: 7472 6169 6e6d 203d 206c 617a 792e 6669  trainm = lazy.fi
-0000bad0: 745f 7472 616e 7366 6f72 6d28 585f 7472  t_transform(X_tr
-0000bae0: 6169 6e2c 2079 5f74 7261 696e 290a 585f  ain, y_train).X_
-0000baf0: 7465 7374 6d20 3d20 6c61 7a79 2e74 7261  testm = lazy.tra
-0000bb00: 6e73 666f 726d 2858 5f74 6573 7429 0a60  nsform(X_test).`
-0000bb10: 6060 0a23 2323 2049 6620 796f 7520 6172  ``.### If you ar
-0000bb20: 6520 7573 696e 6720 6120 6d6f 6465 6c20  e using a model 
-0000bb30: 696e 2070 6970 656c 696e 652c 2075 7365  in pipeline, use
-0000bb40: 206d 7573 7420 7573 6520 6669 7420 616e   must use fit an
-0000bb50: 6420 7072 6564 6963 7420 6f6e 6c79 0a60  d predict only.`
-0000bb60: 6060 0a6c 617a 7920 3d20 4c61 7a79 5472  ``.lazy = LazyTr
-0000bb70: 616e 7366 6f72 6d65 7228 6d6f 6465 6c3d  ansformer(model=
-0000bb80: 5261 6e64 6f6d 466f 7265 7374 436c 6173  RandomForestClas
-0000bb90: 7369 6669 6572 2829 2c20 656e 636f 6465  sifier(), encode
-0000bba0: 7273 3d27 6175 746f 272c 2073 6361 6c65  rs='auto', scale
-0000bbb0: 7273 3d4e 6f6e 652c 200a 2020 2020 2020  rs=None, .      
-0000bbc0: 2020 6461 7465 5f74 6f5f 7374 7269 6e67    date_to_string
-0000bbd0: 3d46 616c 7365 2c20 7472 616e 7366 6f72  =False, transfor
-0000bbe0: 6d5f 7461 7267 6574 3d46 616c 7365 2c20  m_target=False, 
-0000bbf0: 696d 6261 6c61 6e63 6564 3d46 616c 7365  imbalanced=False
-0000bc00: 2c0a 2020 2020 2020 2020 636f 6d62 696e  ,.        combin
-0000bc10: 655f 7261 7265 3d46 616c 7365 2c20 7665  e_rare=False, ve
-0000bc20: 7262 6f73 653d 3029 0a60 6060 0a0a 6060  rbose=0).```..``
-0000bc30: 600a 6c61 7a79 2e66 6974 2858 5f74 7261  `.lazy.fit(X_tra
-0000bc40: 696e 2c20 795f 7472 6169 6e29 0a6c 617a  in, y_train).laz
-0000bc50: 792e 7072 6564 6963 7428 585f 7465 7374  y.predict(X_test
-0000bc60: 290a 6060 600a 0a23 2320 4150 490a 0a3c  ).```..## API..<
-0000bc70: 703e 0a6c 617a 7974 7261 6e73 666f 726d  p>.lazytransform
-0000bc80: 2068 6173 2061 2076 6572 7920 7369 6d70   has a very simp
-0000bc90: 6c65 2041 5049 2077 6974 6820 7468 6520  le API with the 
-0000bca0: 666f 6c6c 6f77 696e 6720 696e 7075 7473  following inputs
-0000bcb0: 2e20 596f 7520 6e65 6564 2074 6f20 6372  . You need to cr
-0000bcc0: 6561 7465 2061 2073 6b6c 6561 726e 2d63  eate a sklearn-c
-0000bcd0: 6f6d 7061 7469 626c 6520 7472 616e 7366  ompatible transf
-0000bce0: 6f72 6d65 7220 7069 7065 6c69 6e65 206f  ormer pipeline o
-0000bcf0: 626a 6563 7420 6279 2069 6d70 6f72 7469  bject by importi
-0000bd00: 6e67 204c 617a 7954 7261 6e73 666f 726d  ng LazyTransform
-0000bd10: 6572 2066 726f 6d20 6c61 7a79 7472 616e  er from lazytran
-0000bd20: 7366 6f72 6d20 6c69 6272 6172 792e 203c  sform library. <
-0000bd30: 703e 0a4f 6e63 6520 796f 7520 696d 706f  p>.Once you impo
-0000bd40: 7274 2069 742c 2079 6f75 2063 616e 2064  rt it, you can d
-0000bd50: 6566 696e 6520 7468 6520 6f62 6a65 6374  efine the object
-0000bd60: 2062 7920 6769 7669 6e67 2073 6576 6572   by giving sever
-0000bd70: 616c 206f 7074 696f 6e73 2073 7563 6820  al options such 
-0000bd80: 6173 3a0a 0a2a 2a41 7267 756d 656e 7473  as:..**Arguments
-0000bd90: 2a2a 0a0a 3c62 3e43 6175 7469 6f6e 3a3c  **..<b>Caution:<
-0000bda0: 2f62 3e20 585f 7472 6169 6e20 616e 6420  /b> X_train and 
-0000bdb0: 795f 7472 6169 6e20 6d75 7374 2062 6520  y_train must be 
-0000bdc0: 7061 6e64 6173 2044 6174 6166 7261 6d65  pandas Dataframe
-0000bdd0: 7320 6f72 2070 616e 6461 7320 5365 7269  s or pandas Seri
-0000bde0: 6573 2e20 444f 204e 4f54 2073 656e 6420  es. DO NOT send 
-0000bdf0: 696e 206e 756d 7079 2061 7272 6179 732e  in numpy arrays.
-0000be00: 2054 6865 7920 776f 6e27 7420 776f 726b   They won't work
-0000be10: 2e0a 0a2d 2060 6d6f 6465 6c60 3a20 6465  ...- `model`: de
-0000be20: 6661 756c 7420 6973 204e 6f6e 652e 204f  fault is None. O
-0000be30: 7220 6974 2063 6f75 6c64 2062 6520 616e  r it could be an
-0000be40: 7920 7363 696b 6974 2d6c 6561 726e 206d  y scikit-learn m
-0000be50: 6f64 656c 2028 696e 636c 7564 696e 6720  odel (including 
-0000be60: 6d75 6c74 696f 7574 7075 7420 6d6f 6465  multioutput mode
-0000be70: 6c73 2920 6173 2077 656c 6c20 6173 2074  ls) as well as t
-0000be80: 6865 2070 6f70 756c 6172 2058 4742 6f6f  he popular XGBoo
-0000be90: 7374 2061 6e64 204c 6967 6874 4742 4d20  st and LightGBM 
-0000bea0: 6c69 6272 6172 6965 732e 2059 6f75 206e  libraries. You n
-0000beb0: 6565 6420 746f 2069 6e73 7461 6c6c 2074  eed to install t
-0000bec0: 686f 7365 206c 6962 7261 7269 6573 2069  hose libraries i
-0000bed0: 6620 796f 7520 7761 6e74 2074 6f20 7573  f you want to us
-0000bee0: 6520 7468 656d 2e0a 2d20 6065 6e63 6f64  e them..- `encod
-0000bef0: 6572 7360 3a20 636f 756c 6420 6265 206f  ers`: could be o
-0000bf00: 6e65 206d 6f72 6520 656e 636f 6465 7273  ne more encoders
-0000bf10: 2069 6e20 6120 7374 7269 6e67 206f 7220   in a string or 
-0000bf20: 6120 6c69 7374 2e20 4561 6368 2065 6e63  a list. Each enc
-0000bf30: 6f64 6572 2073 7472 696e 6720 6361 6e20  oder string can 
-0000bf40: 6265 2061 6e79 206f 6e65 206f 6620 7468  be any one of th
-0000bf50: 6520 3130 2b20 656e 636f 6465 7273 2066  e 10+ encoders f
-0000bf60: 726f 6d20 6063 6174 6567 6f72 795f 656e  rom `category_en
-0000bf70: 636f 6465 7273 6020 6c69 6272 6172 7920  coders` library 
-0000bf80: 6265 6c6f 772e 2020 4176 6169 6c61 626c  below.  Availabl
-0000bf90: 6520 656e 636f 6465 7273 2061 7265 206c  e encoders are l
-0000bfa0: 6973 7465 6420 6865 7265 2061 7320 7374  isted here as st
-0000bfb0: 7269 6e67 7320 736f 2074 6861 7420 796f  rings so that yo
-0000bfc0: 7520 6361 6e20 696e 7075 7420 7468 656d  u can input them
-0000bfd0: 2069 6e20 6c61 7a79 7472 616e 7366 6f72   in lazytransfor
-0000bfe0: 6d3a 0a20 202d 2060 6175 746f 6020 2d20  m:.  - `auto` - 
-0000bff0: 4974 2075 7365 7320 606f 6e65 686f 7460  It uses `onehot`
-0000c000: 2065 6e63 6f64 696e 6720 666f 7220 6c6f   encoding for lo
-0000c010: 772d 6361 7264 696e 616c 6974 7920 7661  w-cardinality va
-0000c020: 7269 6162 6c65 7320 616e 6420 606c 6162  riables and `lab
-0000c030: 656c 6020 656e 636f 6469 6e67 2066 6f72  el` encoding for
-0000c040: 2068 6967 6820 6361 7264 696e 616c 6974   high cardinalit
-0000c050: 7920 7661 7269 6162 6c65 732e 0a20 202d  y variables..  -
-0000c060: 2060 6f6e 6568 6f74 6020 2d20 4f6e 6520   `onehot` - One 
-0000c070: 486f 7420 656e 636f 6469 6e67 202d 2069  Hot encoding - i
-0000c080: 7420 7769 6c6c 2062 6520 7573 6564 2066  t will be used f
-0000c090: 6f72 2061 6c6c 2063 6174 6567 6f72 6963  or all categoric
-0000c0a0: 616c 2066 6561 7475 7265 7320 6972 7265  al features irre
-0000c0b0: 7370 6563 7469 7665 206f 6620 6361 7264  spective of card
-0000c0c0: 696e 616c 6974 790a 2020 2d20 606c 6162  inality.  - `lab
-0000c0d0: 656c 6020 2d20 4c61 6265 6c20 456e 636f  el` - Label Enco
-0000c0e0: 6469 6e67 202d 2069 7420 7769 6c6c 2062  ding - it will b
-0000c0f0: 6520 7573 6564 2066 6f72 2061 6c6c 2063  e used for all c
-0000c100: 6174 6567 6f72 6963 616c 2066 6561 7475  ategorical featu
-0000c110: 7265 7320 6972 7265 7370 6563 7469 7665  res irrespective
-0000c120: 206f 6620 6361 7264 696e 616c 6974 790a   of cardinality.
-0000c130: 2020 2d20 6068 6173 6869 6e67 6020 6f72    - `hashing` or
-0000c140: 2060 6861 7368 6020 2d20 4861 7368 696e   `hash` - Hashin
-0000c150: 6720 286f 7220 4861 7368 2920 456e 636f  g (or Hash) Enco
-0000c160: 6469 6e67 202d 2077 696c 6c20 6265 2075  ding - will be u
-0000c170: 7365 6420 666f 7220 616c 6c20 6361 7465  sed for all cate
-0000c180: 676f 7269 6361 6c20 7661 7269 6162 6c65  gorical variable
-0000c190: 730a 2020 2d20 6068 656c 6d65 7274 6020  s.  - `helmert` 
-0000c1a0: 2d20 4865 6c6d 6572 7420 456e 636f 6469  - Helmert Encodi
-0000c1b0: 6e67 202d 2077 696c 6c20 6265 2075 7365  ng - will be use
-0000c1c0: 6420 666f 7220 616c 6c20 6361 7465 676f  d for all catego
-0000c1d0: 7269 6361 6c20 7661 7269 6162 6c65 730a  rical variables.
-0000c1e0: 2020 2d20 6062 6463 6020 2d20 4244 4320    - `bdc` - BDC 
-0000c1f0: 456e 636f 6469 6e67 202d 2077 696c 6c20  Encoding - will 
-0000c200: 6265 2075 7365 6420 666f 7220 616c 6c20  be used for all 
-0000c210: 6361 7465 676f 7269 6361 6c20 7661 7269  categorical vari
-0000c220: 6162 6c65 730a 2020 2d20 6073 756d 6020  ables.  - `sum` 
-0000c230: 2d20 5375 6d20 456e 636f 6469 6e67 202d  - Sum Encoding -
-0000c240: 2077 696c 6c20 6265 2075 7365 6420 666f   will be used fo
-0000c250: 7220 616c 6c20 6361 7465 676f 7269 6361  r all categorica
-0000c260: 6c20 7661 7269 6162 6c65 730a 2020 2d20  l variables.  - 
-0000c270: 606c 6f6f 6020 2d20 4c65 6176 6520 6f6e  `loo` - Leave on
-0000c280: 6520 6f75 7420 456e 636f 6469 6e67 202d  e out Encoding -
-0000c290: 2077 696c 6c20 6265 2075 7365 6420 666f   will be used fo
-0000c2a0: 7220 616c 6c20 6361 7465 676f 7269 6361  r all categorica
-0000c2b0: 6c20 7661 7269 6162 6c65 730a 2020 2d20  l variables.  - 
-0000c2c0: 6062 6173 6560 202d 2042 6173 6520 656e  `base` - Base en
-0000c2d0: 636f 6469 6e67 202d 2077 696c 6c20 6265  coding - will be
-0000c2e0: 2075 7365 6420 666f 7220 616c 6c20 6361   used for all ca
-0000c2f0: 7465 676f 7269 6361 6c20 7661 7269 6162  tegorical variab
-0000c300: 6c65 730a 2020 2d20 6077 6f65 6020 2d20  les.  - `woe` - 
-0000c310: 5765 6967 6874 206f 6620 4576 6964 656e  Weight of Eviden
-0000c320: 6365 2045 6e63 6f64 696e 6720 2d20 7769  ce Encoding - wi
-0000c330: 6c6c 2062 6520 7573 6564 2066 6f72 2061  ll be used for a
-0000c340: 6c6c 2063 6174 6567 6f72 6963 616c 2076  ll categorical v
-0000c350: 6172 6961 626c 6573 0a20 202d 2060 6a61  ariables.  - `ja
-0000c360: 6d65 7360 202d 204a 616d 6573 2045 6e63  mes` - James Enc
-0000c370: 6f64 696e 6720 2d20 7769 6c6c 2062 6520  oding - will be 
-0000c380: 7573 6564 2066 6f72 2061 6c6c 2063 6174  used for all cat
-0000c390: 6567 6f72 6963 616c 2076 6172 6961 626c  egorical variabl
-0000c3a0: 6573 0a20 202d 2060 7461 7267 6574 6020  es.  - `target` 
-0000c3b0: 2d20 5461 7267 6574 2045 6e63 6f64 696e  - Target Encodin
-0000c3c0: 6720 2d20 7769 6c6c 2062 6520 7573 6564  g - will be used
-0000c3d0: 2066 6f72 2061 6c6c 2063 6174 6567 6f72   for all categor
-0000c3e0: 6963 616c 2076 6172 6961 626c 6573 0a20  ical variables. 
-0000c3f0: 202d 2060 636f 756e 7460 202d 2043 6f75   - `count` - Cou
-0000c400: 6e74 2045 6e63 6f64 696e 6720 2d20 7769  nt Encoding - wi
-0000c410: 6c6c 2062 6520 7573 6564 2066 6f72 2061  ll be used for a
-0000c420: 6c6c 2063 6174 6567 6f72 6963 616c 2076  ll categorical v
-0000c430: 6172 6961 626c 6573 0a20 202d 2060 676c  ariables.  - `gl
-0000c440: 6d60 2c60 676c 6d6d 6020 2d20 4765 6e65  m`,`glmm` - Gene
-0000c450: 7261 6c69 7a65 6420 4c69 6e65 6172 204d  ralized Linear M
-0000c460: 6f64 656c 2045 6e63 6f64 696e 670a 2d20  odel Encoding.- 
-0000c470: 4865 7265 2069 7320 6120 6465 7363 7269  Here is a descri
-0000c480: 7074 696f 6e20 6f66 2076 6172 696f 7573  ption of various
-0000c490: 2065 6e63 6f64 6572 7320 616e 6420 7468   encoders and th
-0000c4a0: 6569 7220 7573 6573 2066 726f 6d20 7468  eir uses from th
-0000c4b0: 6520 6578 6365 6c6c 656e 7420 3c61 2068  e excellent <a h
-0000c4c0: 7265 663d 2268 7474 7073 3a2f 2f63 6f6e  ref="https://con
-0000c4d0: 7472 6962 2e73 6369 6b69 742d 6c65 6172  trib.scikit-lear
-0000c4e0: 6e2e 6f72 672f 6361 7465 676f 7279 5f65  n.org/category_e
-0000c4f0: 6e63 6f64 6572 732f 223e 2063 6174 6567  ncoders/"> categ
-0000c500: 6f72 795f 656e 636f 6465 7273 3c2f 613e  ory_encoders</a>
-0000c510: 2070 7974 686f 6e20 6c69 6272 6172 793a   python library:
-0000c520: 3c62 723e 0a20 2020 202d 2060 4861 7368  <br>.    - `Hash
-0000c530: 696e 6745 6e63 6f64 6572 603a 2048 6173  ingEncoder`: Has
-0000c540: 6869 6e67 456e 636f 6465 7220 6973 2061  hingEncoder is a
-0000c550: 206d 756c 7469 7661 7269 6174 6520 6861   multivariate ha
-0000c560: 7368 696e 6720 696d 706c 656d 656e 7461  shing implementa
-0000c570: 7469 6f6e 2077 6974 6820 636f 6e66 6967  tion with config
-0000c580: 7572 6162 6c65 2064 696d 656e 7369 6f6e  urable dimension
-0000c590: 616c 6974 792f 7072 6563 6973 696f 6e2e  ality/precision.
-0000c5a0: 2054 6865 2061 6476 616e 7461 6765 206f   The advantage o
-0000c5b0: 6620 7468 6973 2065 6e63 6f64 6572 2069  f this encoder i
-0000c5c0: 7320 7468 6174 2069 7420 646f 6573 206e  s that it does n
-0000c5d0: 6f74 206d 6169 6e74 6169 6e20 6120 6469  ot maintain a di
-0000c5e0: 6374 696f 6e61 7279 206f 6620 6f62 7365  ctionary of obse
-0000c5f0: 7276 6564 2063 6174 6567 6f72 6965 732e  rved categories.
-0000c600: 2043 6f6e 7365 7175 656e 746c 792c 2074   Consequently, t
-0000c610: 6865 2065 6e63 6f64 6572 2064 6f65 7320  he encoder does 
-0000c620: 6e6f 7420 6772 6f77 2069 6e20 7369 7a65  not grow in size
-0000c630: 2061 6e64 2061 6363 6570 7473 206e 6577   and accepts new
-0000c640: 2076 616c 7565 7320 6475 7269 6e67 2064   values during d
-0000c650: 6174 6120 7363 6f72 696e 6720 6279 2064  ata scoring by d
-0000c660: 6573 6967 6e2e 0a20 2020 202d 2060 5375  esign..    - `Su
-0000c670: 6d45 6e63 6f64 6572 603a 2053 756d 456e  mEncoder`: SumEn
-0000c680: 636f 6465 7220 6973 2061 2053 756d 2063  coder is a Sum c
-0000c690: 6f6e 7472 6173 7420 636f 6469 6e67 2066  ontrast coding f
-0000c6a0: 6f72 2074 6865 2065 6e63 6f64 696e 6720  or the encoding 
-0000c6b0: 6f66 2063 6174 6567 6f72 6963 616c 2066  of categorical f
-0000c6c0: 6561 7475 7265 732e 0a20 2020 202d 2060  eatures..    - `
-0000c6d0: 506f 6c79 6e6f 6d69 616c 456e 636f 6465  PolynomialEncode
-0000c6e0: 7260 3a20 506f 6c79 6e6f 6d69 616c 456e  r`: PolynomialEn
-0000c6f0: 636f 6465 7220 6973 2061 2050 6f6c 796e  coder is a Polyn
-0000c700: 6f6d 6961 6c20 636f 6e74 7261 7374 2063  omial contrast c
-0000c710: 6f64 696e 6720 666f 7220 7468 6520 656e  oding for the en
-0000c720: 636f 6469 6e67 206f 6620 6361 7465 676f  coding of catego
-0000c730: 7269 6361 6c20 6665 6174 7572 6573 2e0a  rical features..
-0000c740: 2020 2020 2d20 6042 6163 6b77 6172 6444      - `BackwardD
-0000c750: 6966 6665 7265 6e63 6545 6e63 6f64 6572  ifferenceEncoder
-0000c760: 603a 2042 6163 6b77 6172 6444 6966 6665  `: BackwardDiffe
-0000c770: 7265 6e63 6545 6e63 6f64 6572 2069 7320  renceEncoder is 
-0000c780: 6120 4261 636b 7761 7264 2064 6966 6665  a Backward diffe
-0000c790: 7265 6e63 6520 636f 6e74 7261 7374 2063  rence contrast c
-0000c7a0: 6f64 696e 6720 666f 7220 656e 636f 6469  oding for encodi
-0000c7b0: 6e67 2063 6174 6567 6f72 6963 616c 2076  ng categorical v
-0000c7c0: 6172 6961 626c 6573 2e0a 2020 2020 2d20  ariables..    - 
-0000c7d0: 604f 6e65 486f 7445 6e63 6f64 6572 603a  `OneHotEncoder`:
-0000c7e0: 204f 6e65 486f 7445 6e63 6f64 6572 2069   OneHotEncoder i
-0000c7f0: 7320 7468 6520 7472 6164 6974 696f 6e61  s the traditiona
-0000c800: 6c20 4f6e 6568 6f74 2028 6f72 2064 756d  l Onehot (or dum
-0000c810: 6d79 2920 636f 6469 6e67 2066 6f72 2063  my) coding for c
-0000c820: 6174 6567 6f72 6963 616c 2066 6561 7475  ategorical featu
-0000c830: 7265 732e 2049 7420 7072 6f64 7563 6573  res. It produces
-0000c840: 206f 6e65 2066 6561 7475 7265 2070 6572   one feature per
-0000c850: 2063 6174 6567 6f72 792c 2065 6163 6820   category, each 
-0000c860: 6265 696e 6720 6120 6269 6e61 7279 2e0a  being a binary..
-0000c870: 2020 2020 2d20 6048 656c 6d65 7274 456e      - `HelmertEn
-0000c880: 636f 6465 7260 3a20 4865 6c6d 6572 7445  coder`: HelmertE
-0000c890: 6e63 6f64 6572 2075 7365 7320 7468 6520  ncoder uses the 
-0000c8a0: 4865 6c6d 6572 7420 636f 6e74 7261 7374  Helmert contrast
-0000c8b0: 2063 6f64 696e 6720 666f 7220 656e 636f   coding for enco
-0000c8c0: 6469 6e67 2063 6174 6567 6f72 6963 616c  ding categorical
-0000c8d0: 2066 6561 7475 7265 732e 0a20 2020 202d   features..    -
-0000c8e0: 2060 4f72 6469 6e61 6c45 6e63 6f64 6572   `OrdinalEncoder
-0000c8f0: 603a 204f 7264 696e 616c 456e 636f 6465  `: OrdinalEncode
-0000c900: 7220 7573 6573 204f 7264 696e 616c 2065  r uses Ordinal e
-0000c910: 6e63 6f64 696e 6720 746f 2064 6573 6967  ncoding to desig
-0000c920: 6e61 7465 2061 2073 696e 676c 6520 636f  nate a single co
-0000c930: 6c75 6d6e 206f 6620 696e 7465 6765 7273  lumn of integers
-0000c940: 2074 6f20 7265 7072 6573 656e 7420 7468   to represent th
-0000c950: 6520 6361 7465 676f 7269 6573 2069 6e20  e categories in 
-0000c960: 796f 7572 2064 6174 612e 2049 6e74 6567  your data. Integ
-0000c970: 6572 7320 686f 7765 7665 7220 7374 6172  ers however star
-0000c980: 7420 696e 2074 6865 2073 616d 6520 6f72  t in the same or
-0000c990: 6465 7220 696e 2077 6869 6368 2074 6865  der in which the
-0000c9a0: 2063 6174 6567 6f72 6965 7320 6172 6520   categories are 
-0000c9b0: 666f 756e 6420 696e 2079 6f75 7220 6461  found in your da
-0000c9c0: 7461 7365 742e 2049 6620 796f 7520 7761  taset. If you wa
-0000c9d0: 6e74 2074 6f20 6368 616e 6765 2074 6865  nt to change the
-0000c9e0: 206f 7264 6572 2c20 6a75 7374 2073 6f72   order, just sor
-0000c9f0: 7420 7468 6520 636f 6c75 6d6e 2061 6e64  t the column and
-0000ca00: 2073 656e 6420 6974 2069 6e20 666f 7220   send it in for 
-0000ca10: 656e 636f 6469 6e67 2e0a 2020 2020 2d20  encoding..    - 
-0000ca20: 6046 7265 7175 656e 6379 456e 636f 6465  `FrequencyEncode
-0000ca30: 7260 3a20 4672 6571 7565 6e63 7945 6e63  r`: FrequencyEnc
-0000ca40: 6f64 6572 2069 7320 6120 636f 756e 7420  oder is a count 
-0000ca50: 656e 636f 6469 6e67 2074 6563 686e 6971  encoding techniq
-0000ca60: 7565 2066 6f72 2063 6174 6567 6f72 6963  ue for categoric
-0000ca70: 616c 2066 6561 7475 7265 732e 2046 6f72  al features. For
-0000ca80: 2061 2067 6976 656e 2063 6174 6567 6f72   a given categor
-0000ca90: 6963 616c 2066 6561 7475 7265 2c20 6974  ical feature, it
-0000caa0: 2072 6570 6c61 6365 7320 7468 6520 6e61   replaces the na
-0000cab0: 6d65 7320 6f66 2074 6865 2063 6174 6567  mes of the categ
-0000cac0: 6f72 6965 7320 7769 7468 2074 6865 2067  ories with the g
-0000cad0: 726f 7570 2063 6f75 6e74 7320 6f66 2065  roup counts of e
-0000cae0: 6163 6820 6361 7465 676f 7279 2e0a 2020  ach category..  
-0000caf0: 2020 2d20 6042 6173 654e 456e 636f 6465    - `BaseNEncode
-0000cb00: 7260 3a20 4261 7365 4e45 6e63 6f64 6572  r`: BaseNEncoder
-0000cb10: 2065 6e63 6f64 6573 2074 6865 2063 6174   encodes the cat
-0000cb20: 6567 6f72 6965 7320 696e 746f 2061 7272  egories into arr
-0000cb30: 6179 7320 6f66 2074 6865 6972 2062 6173  ays of their bas
-0000cb40: 652d 4e20 7265 7072 6573 656e 7461 7469  e-N representati
-0000cb50: 6f6e 2e20 4120 6261 7365 206f 6620 3120  on. A base of 1 
-0000cb60: 6973 2065 7175 6976 616c 656e 7420 746f  is equivalent to
-0000cb70: 206f 6e65 2d68 6f74 2065 6e63 6f64 696e   one-hot encodin
-0000cb80: 6720 286e 6f74 2072 6561 6c6c 7920 6261  g (not really ba
-0000cb90: 7365 2d31 2c20 6275 7420 7573 6566 756c  se-1, but useful
-0000cba0: 292c 2061 2062 6173 6520 6f66 2032 2069  ), a base of 2 i
-0000cbb0: 7320 6571 7569 7661 6c65 6e74 2074 6f20  s equivalent to 
-0000cbc0: 6269 6e61 7279 2065 6e63 6f64 696e 672e  binary encoding.
-0000cbd0: 204e 3d6e 756d 6265 7220 6f66 2061 6374   N=number of act
-0000cbe0: 7561 6c20 6361 7465 676f 7269 6573 2069  ual categories i
-0000cbf0: 7320 6571 7569 7661 6c65 6e74 2074 6f20  s equivalent to 
-0000cc00: 7661 6e69 6c6c 6120 6f72 6469 6e61 6c20  vanilla ordinal 
-0000cc10: 656e 636f 6469 6e67 2e0a 2020 2020 2d20  encoding..    - 
-0000cc20: 6054 6172 6765 7445 6e63 6f64 6572 603a  `TargetEncoder`:
-0000cc30: 2054 6172 6765 7445 6e63 6f64 6572 2070   TargetEncoder p
-0000cc40: 6572 666f 726d 7320 5461 7267 6574 2065  erforms Target e
-0000cc50: 6e63 6f64 696e 6720 666f 7220 6361 7465  ncoding for cate
-0000cc60: 676f 7269 6361 6c20 6665 6174 7572 6573  gorical features
-0000cc70: 2e20 4974 2073 7570 706f 7274 7320 666f  . It supports fo
-0000cc80: 6c6c 6f77 696e 6720 6b69 6e64 7320 6f66  llowing kinds of
-0000cc90: 2074 6172 6765 7473 3a20 6269 6e61 7279   targets: binary
-0000cca0: 2061 6e64 2063 6f6e 7469 6e75 6f75 732e   and continuous.
-0000ccb0: 2046 6f72 206d 756c 7469 2d63 6c61 7373   For multi-class
-0000ccc0: 2074 6172 6765 7473 2069 7420 7573 6573   targets it uses
-0000ccd0: 2061 2050 6f6c 796e 6f6d 6961 6c57 7261   a PolynomialWra
-0000cce0: 7070 6572 2e0a 2020 2020 2d20 6043 6174  pper..    - `Cat
-0000ccf0: 426f 6f73 7445 6e63 6f64 6572 603a 2043  BoostEncoder`: C
-0000cd00: 6174 426f 6f73 7445 6e63 6f64 6572 2070  atBoostEncoder p
-0000cd10: 6572 666f 726d 7320 4361 7442 6f6f 7374  erforms CatBoost
-0000cd20: 2063 6f64 696e 6720 666f 7220 6361 7465   coding for cate
-0000cd30: 676f 7269 6361 6c20 6665 6174 7572 6573  gorical features
-0000cd40: 2e20 4974 2073 7570 706f 7274 7320 7468  . It supports th
-0000cd50: 6520 666f 6c6c 6f77 696e 6720 6b69 6e64  e following kind
-0000cd60: 7320 6f66 2074 6172 6765 7473 3a20 6269  s of targets: bi
-0000cd70: 6e61 7279 2061 6e64 2063 6f6e 7469 6e75  nary and continu
-0000cd80: 6f75 732e 2046 6f72 2070 6f6c 796e 6f6d  ous. For polynom
-0000cd90: 6961 6c20 7461 7267 6574 2073 7570 706f  ial target suppo
-0000cda0: 7274 2c20 6974 2075 7365 7320 6120 506f  rt, it uses a Po
-0000cdb0: 6c79 6e6f 6d69 616c 5772 6170 7065 722e  lynomialWrapper.
-0000cdc0: 2054 6869 7320 6973 2076 6572 7920 7369   This is very si
-0000cdd0: 6d69 6c61 7220 746f 206c 6561 7665 2d6f  milar to leave-o
-0000cde0: 6e65 2d6f 7574 2065 6e63 6f64 696e 672c  ne-out encoding,
-0000cdf0: 2062 7574 2063 616c 6375 6c61 7465 7320   but calculates 
-0000ce00: 7468 6520 7661 6c75 6573 20e2 809c 6f6e  the values ...on
-0000ce10: 2d74 6865 2d66 6c79 e280 9d2e 2043 6f6e  -the-fly.... Con
-0000ce20: 7365 7175 656e 746c 792c 2074 6865 2076  sequently, the v
-0000ce30: 616c 7565 7320 6e61 7475 7261 6c6c 7920  alues naturally 
-0000ce40: 7661 7279 2064 7572 696e 6720 7468 6520  vary during the 
-0000ce50: 7472 6169 6e69 6e67 2070 6861 7365 2061  training phase a
-0000ce60: 6e64 2069 7420 6973 206e 6f74 206e 6563  nd it is not nec
-0000ce70: 6573 7361 7279 2074 6f20 6164 6420 7261  essary to add ra
-0000ce80: 6e64 6f6d 206e 6f69 7365 2e0a 2020 2020  ndom noise..    
-0000ce90: 2d20 6057 4f45 456e 636f 6465 7260 3a20  - `WOEEncoder`: 
-0000cea0: 574f 4545 6e63 6f64 6572 2075 7365 7320  WOEEncoder uses 
-0000ceb0: 7468 6520 5765 6967 6874 206f 6620 4576  the Weight of Ev
-0000cec0: 6964 656e 6365 2074 6563 686e 6971 7565  idence technique
-0000ced0: 2066 6f72 2063 6174 6567 6f72 6963 616c   for categorical
-0000cee0: 2066 6561 7475 7265 732e 2049 7420 7375   features. It su
-0000cef0: 7070 6f72 7473 206f 6e6c 7920 6f6e 6520  pports only one 
-0000cf00: 6b69 6e64 206f 6620 7461 7267 6574 3a20  kind of target: 
-0000cf10: 6269 6e61 7279 2e20 466f 7220 706f 6c79  binary. For poly
-0000cf20: 6e6f 6d69 616c 2074 6172 6765 7420 7375  nomial target su
-0000cf30: 7070 6f72 742c 2069 7420 7573 6573 2061  pport, it uses a
-0000cf40: 2050 6f6c 796e 6f6d 6961 6c57 7261 7070   PolynomialWrapp
-0000cf50: 6572 2e20 4974 2063 616e 6e6f 7420 6265  er. It cannot be
-0000cf60: 2075 7365 6420 666f 7220 5265 6772 6573   used for Regres
-0000cf70: 7369 6f6e 2e0a 2020 2020 2d20 604a 616d  sion..    - `Jam
-0000cf80: 6573 5374 6569 6e45 6e63 6f64 6572 603a  esSteinEncoder`:
-0000cf90: 204a 616d 6573 5374 6569 6e45 6e63 6f64   JamesSteinEncod
-0000cfa0: 6572 2075 7365 7320 7468 6520 4a61 6d65  er uses the Jame
-0000cfb0: 732d 5374 6569 6e20 6573 7469 6d61 746f  s-Stein estimato
-0000cfc0: 722e 2049 7420 7375 7070 6f72 7473 2032  r. It supports 2
-0000cfd0: 206b 696e 6473 206f 6620 7461 7267 6574   kinds of target
-0000cfe0: 733a 2062 696e 6172 7920 616e 6420 636f  s: binary and co
-0000cff0: 6e74 696e 756f 7573 2e20 466f 7220 706f  ntinuous. For po
-0000d000: 6c79 6e6f 6d69 616c 2074 6172 6765 7420  lynomial target 
-0000d010: 7375 7070 6f72 742c 2069 7420 7573 6573  support, it uses
-0000d020: 2050 6f6c 796e 6f6d 6961 6c57 7261 7070   PolynomialWrapp
-0000d030: 6572 2e0a 2020 2020 466f 7220 6665 6174  er..    For feat
-0000d040: 7572 6520 7661 6c75 6520 692c 204a 616d  ure value i, Jam
-0000d050: 6573 2d53 7465 696e 2065 7374 696d 6174  es-Stein estimat
-0000d060: 6f72 2072 6574 7572 6e73 2061 2077 6569  or returns a wei
-0000d070: 6768 7465 6420 6176 6572 6167 6520 6f66  ghted average of
-0000d080: 3a0a 2020 2020 5468 6520 6d65 616e 2074  :.    The mean t
-0000d090: 6172 6765 7420 7661 6c75 6520 666f 7220  arget value for 
-0000d0a0: 7468 6520 6f62 7365 7276 6564 2066 6561  the observed fea
-0000d0b0: 7475 7265 2076 616c 7565 2069 2e0a 2020  ture value i..  
-0000d0c0: 2020 5468 6520 6d65 616e 2074 6172 6765    The mean targe
-0000d0d0: 7420 7661 6c75 6520 2872 6567 6172 646c  t value (regardl
-0000d0e0: 6573 7320 6f66 2074 6865 2066 6561 7475  ess of the featu
-0000d0f0: 7265 2076 616c 7565 292e 0a20 2020 202d  re value)..    -
-0000d100: 2060 5175 616e 7469 6c65 456e 636f 6465   `QuantileEncode
-0000d110: 7260 3a20 5468 6973 2069 7320 6120 7665  r`: This is a ve
-0000d120: 7279 2067 6f6f 6420 656e 636f 6465 7220  ry good encoder 
-0000d130: 666f 7220 5265 6772 6573 7369 6f6e 2074  for Regression t
-0000d140: 6173 6b73 2e20 5365 6520 5061 7065 7220  asks. See Paper 
-0000d150: 616e 6420 6172 7469 636c 653a 0a20 2020  and article:.   
-0000d160: 2068 7474 7073 3a2f 2f74 6f77 6172 6473   https://towards
-0000d170: 6461 7461 7363 6965 6e63 652e 636f 6d2f  datascience.com/
-0000d180: 7175 616e 7469 6c65 2d65 6e63 6f64 6572  quantile-encoder
-0000d190: 2d65 6233 3363 3237 3234 3131 640a 0a2d  -eb33c272411d..-
-0000d1a0: 2060 7363 616c 6572 7360 3a20 636f 756c   `scalers`: coul
-0000d1b0: 6420 6265 206f 6e65 206f 6620 7468 7265  d be one of thre
-0000d1c0: 6520 6d61 696e 2073 6361 6c65 7273 2075  e main scalers u
-0000d1d0: 7365 6420 696e 2073 6369 6b69 742d 6c65  sed in scikit-le
-0000d1e0: 6172 6e20 6d6f 6465 6c73 2074 6f20 7472  arn models to tr
-0000d1f0: 616e 7366 6f72 6d20 6e75 6d65 7269 6320  ansform numeric 
-0000d200: 6665 6174 7572 6573 2e20 4465 6661 756c  features. Defaul
-0000d210: 7420 6973 204e 6f6e 652e 2053 6361 6c65  t is None. Scale
-0000d220: 7273 2061 7265 2075 7365 6420 696e 2074  rs are used in t
-0000d230: 6865 206c 6173 7420 7374 6570 206f 6620  he last step of 
-0000d240: 7468 6520 7069 7065 6c69 6e65 2074 6f20  the pipeline to 
-0000d250: 7363 616c 6520 616c 6c20 6665 6174 7572  scale all featur
-0000d260: 6573 2074 6861 7420 6861 7665 2074 7261  es that have tra
-0000d270: 6e73 666f 726d 6564 2e20 486f 7765 7665  nsformed. Howeve
-0000d280: 722c 2079 6f75 206d 6967 6874 2077 616e  r, you might wan
-0000d290: 7420 746f 2061 766f 6964 2073 6361 6c69  t to avoid scali
-0000d2a0: 6e67 2069 6e20 4e4c 5020 6461 7461 7365  ng in NLP datase
-0000d2b0: 7473 2073 696e 6365 2061 6674 6572 2054  ts since after T
-0000d2c0: 4669 4446 2076 6563 746f 7269 7a61 7469  FiDF vectorizati
-0000d2d0: 6f6e 2c20 7363 616c 696e 6720 7468 656d  on, scaling them
-0000d2e0: 206d 6179 206e 6f74 206d 616b 6520 7365   may not make se
-0000d2f0: 6e73 652e 2042 7574 2069 7420 6973 2075  nse. But it is u
-0000d300: 7020 746f 2079 6f75 2e20 5468 6520 3420  p to you. The 4 
-0000d310: 6f70 7469 6f6e 7320 6172 653a 0a20 202d  options are:.  -
-0000d320: 2060 4e6f 6e65 6020 4e6f 2073 6361 6c65   `None` No scale
-0000d330: 722e 2047 7265 6174 2066 6f72 2061 6c6d  r. Great for alm
-0000d340: 6f73 7420 616c 6c20 6461 7461 7365 7473  ost all datasets
-0000d350: 2e20 5465 7374 2069 7420 6669 7273 7420  . Test it first 
-0000d360: 616e 6420 7468 656e 2074 7279 206f 6e65  and then try one
-0000d370: 206f 6620 7468 6520 7363 616c 6572 7320   of the scalers 
-0000d380: 6265 6c6f 772e 0a20 202d 2060 7374 6460  below..  - `std`
-0000d390: 2073 7461 6e64 6172 6420 7363 616c 6572   standard scaler
-0000d3a0: 2e20 4772 6561 7420 666f 7220 616c 6d6f  . Great for almo
-0000d3b0: 7374 2061 6c6c 2064 6174 6173 6574 732e  st all datasets.
-0000d3c0: 0a20 202d 2060 6d69 6e6d 6178 6020 6d69  .  - `minmax` mi
-0000d3d0: 6e6d 6178 2073 6361 6c65 722e 2047 7265  nmax scaler. Gre
-0000d3e0: 6174 2066 6f72 2064 6174 6173 6574 7320  at for datasets 
-0000d3f0: 7768 6572 6520 796f 7520 6e65 6564 2074  where you need t
-0000d400: 6f20 7365 6520 7468 6520 6469 7374 7269  o see the distri
-0000d410: 6275 7469 6f6e 2062 6574 7765 656e 2030  bution between 0
-0000d420: 2061 6e64 2031 2e0a 2020 2d20 6072 6f62   and 1..  - `rob
-0000d430: 7573 7460 2052 6f62 7573 7420 7363 616c  ust` Robust scal
-0000d440: 6572 2e20 4772 6561 7420 666f 7220 6461  er. Great for da
-0000d450: 7461 7365 7473 2077 6865 7265 2079 6f75  tasets where you
-0000d460: 2068 6176 6520 6f75 746c 6965 7273 2e0a   have outliers..
-0000d470: 2020 2d20 606d 6178 6162 7360 206d 6178    - `maxabs` max
-0000d480: 2061 6273 6f6c 7574 6520 7363 616c 6572   absolute scaler
-0000d490: 2e20 4772 6561 7420 666f 7220 7363 616c  . Great for scal
-0000d4a0: 696e 6720 6275 7420 6c65 6176 6573 2074  ing but leaves t
-0000d4b0: 6865 206e 6567 6174 6976 6520 7661 6c75  he negative valu
-0000d4c0: 6573 2061 7320 7468 6579 2061 7265 2028  es as they are (
-0000d4d0: 6e65 6761 7469 7665 292e 200a 2d20 6064  negative). .- `d
-0000d4e0: 6174 655f 746f 5f73 7472 696e 6760 3a20  ate_to_string`: 
-0000d4f0: 6465 6661 756c 7420 6973 2046 616c 7365  default is False
-0000d500: 2e20 4966 2079 6f75 2077 616e 7420 746f  . If you want to
-0000d510: 2075 7365 2064 6174 6520 7661 7269 6162   use date variab
-0000d520: 6c65 7320 6173 2073 7472 696e 6773 2028  les as strings (
-0000d530: 6361 7465 676f 7269 6361 6c29 2c20 7468  categorical), th
-0000d540: 656e 2073 6574 2069 7420 6173 2054 7275  en set it as Tru
-0000d550: 652e 596f 7520 6361 6e20 7573 6520 7468  e.You can use th
-0000d560: 6973 206f 7074 696f 6e20 7768 656e 2074  is option when t
-0000d570: 6865 7265 2061 7265 2076 6572 7920 6665  here are very fe
-0000d580: 7720 6461 7465 7320 696e 2079 6f75 7220  w dates in your 
-0000d590: 6461 7461 7365 742e 2049 6620 796f 7520  dataset. If you 
-0000d5a0: 7365 7420 6974 2061 7320 4661 6c73 652c  set it as False,
-0000d5b0: 2069 7420 7769 6c6c 2063 6f6e 7665 7274   it will convert
-0000d5c0: 2069 7420 696e 746f 2064 6174 6520 7469   it into date ti
-0000d5d0: 6d65 2066 6f72 6d61 7420 616e 6420 6578  me format and ex
-0000d5e0: 7472 6163 7420 7570 2074 6f20 3230 2066  tract up to 20 f
-0000d5f0: 6561 7475 7265 7320 6672 6f6d 2079 6f75  eatures from you
-0000d600: 7220 6461 7465 2074 696d 6520 636f 6c75  r date time colu
-0000d610: 6d6e 2e20 5468 6973 2069 7320 7468 6520  mn. This is the 
-0000d620: 6465 6661 756c 7420 6f70 7469 6f6e 2061  default option a
-0000d630: 6e64 2062 6573 7420 6f70 7469 6f6e 2e0a  nd best option..
-0000d640: 2d20 6074 7261 6e73 666f 726d 5f74 6172  - `transform_tar
-0000d650: 6765 7460 3a20 6465 6661 756c 7420 6973  get`: default is
-0000d660: 2046 616c 7365 2e20 4966 2079 6f75 2077   False. If you w
-0000d670: 616e 7420 746f 2074 7261 6e73 666f 726d  ant to transform
-0000d680: 2079 6f75 7220 7461 7267 6574 2076 6172   your target var
-0000d690: 6961 626c 6528 7329 2c20 7468 656e 2073  iable(s), then s
-0000d6a0: 6574 2069 7420 6173 2054 7275 6520 616e  et it as True an
-0000d6b0: 6420 7765 2077 696c 6c20 7472 616e 7366  d we will transf
-0000d6c0: 6f72 6d20 796f 7572 2074 6172 6765 7428  orm your target(
-0000d6d0: 7329 2061 7320 6e75 6d65 7269 6320 7573  s) as numeric us
-0000d6e0: 696e 6720 4c61 6265 6c20 456e 636f 6469  ing Label Encodi
-0000d6f0: 6e67 2061 7320 7765 6c6c 2061 7320 6d75  ng as well as mu
-0000d700: 6c74 692d 6c61 6265 6c20 4269 6e61 7279  lti-label Binary
-0000d710: 2063 6c61 7373 6573 2e20 5468 6973 2069   classes. This i
-0000d720: 7320 6120 6772 6561 7420 6f70 7469 6f6e  s a great option
-0000d730: 2077 6865 6e20 796f 7520 6861 7665 2063   when you have c
-0000d740: 6174 6567 6f72 6963 616c 2074 6172 6765  ategorical targe
-0000d750: 7420 7661 7269 6162 6c65 732e 0a2d 2060  t variables..- `
-0000d760: 696d 6261 6c61 6e63 6564 603a 2064 6566  imbalanced`: def
-0000d770: 6175 6c74 2069 7320 4661 6c73 652e 2049  ault is False. I
-0000d780: 6620 796f 7520 6861 7665 2061 6e20 696d  f you have an im
-0000d790: 6261 6c61 6e63 6564 2064 6174 6173 6574  balanced dataset
-0000d7a0: 2c20 7468 656e 2073 6574 2069 7420 746f  , then set it to
-0000d7b0: 2054 7275 6520 616e 6420 7765 2077 696c   True and we wil
-0000d7c0: 6c20 7472 616e 7366 6f72 6d20 796f 7572  l transform your
-0000d7d0: 2074 7261 696e 2064 6174 6120 7573 696e   train data usin
-0000d7e0: 6720 426f 7264 6572 6c69 6e65 534d 4f54  g BorderlineSMOT
-0000d7f0: 4520 6f72 2053 4d4f 5445 4e43 2077 6869  E or SMOTENC whi
-0000d800: 6368 2061 7265 2062 6f74 6820 6772 6561  ch are both grea
-0000d810: 7420 6f70 7469 6f6e 732e 2057 6520 7769  t options. We wi
-0000d820: 6c6c 2073 656c 6563 7420 7468 6520 7269  ll select the ri
-0000d830: 6768 7420 534d 4f54 4520 6675 6e63 7469  ght SMOTE functi
-0000d840: 6f6e 2061 7574 6f6d 6174 6963 616c 6c79  on automatically
-0000d850: 2e0a 2d20 6063 6f6d 6269 6e65 5f72 6172  ..- `combine_rar
-0000d860: 6560 3a20 6465 6661 756c 7420 6973 2046  e`: default is F
-0000d870: 616c 7365 2e20 5468 6973 2069 7320 6120  alse. This is a 
-0000d880: 6772 6561 7420 6f70 7469 6f6e 2069 6620  great option if 
-0000d890: 796f 7520 6861 7665 2074 6f6f 206d 616e  you have too man
-0000d8a0: 7920 7261 7265 2063 6174 6567 6f72 6965  y rare categorie
-0000d8b0: 7320 696e 2079 6f75 7220 6361 7465 676f  s in your catego
-0000d8c0: 7269 6361 6c20 7661 7269 6162 6c65 732e  rical variables.
-0000d8d0: 2049 7420 7769 6c6c 2061 7574 6f6d 6174   It will automat
-0000d8e0: 6963 616c 6c79 2063 6f6d 6269 6e65 2074  ically combine t
-0000d8f0: 686f 7365 2072 6172 6520 6361 7465 676f  hose rare catego
-0000d900: 7269 6573 2077 6869 6368 2061 7265 206c  ries which are l
-0000d910: 6573 7320 7468 616e 2031 2520 6f66 2074  ess than 1% of t
-0000d920: 6865 2064 6174 6173 6574 2069 6e74 6f20  he dataset into 
-0000d930: 6f6e 6520 636f 6d62 696e 6564 2063 6174  one combined cat
-0000d940: 6567 6f72 7920 6361 6c6c 6564 2022 7261  egory called "ra
-0000d950: 7265 5f63 6174 6567 6f72 6965 7322 2e20  re_categories". 
-0000d960: 596f 7520 6361 6e20 616c 736f 2073 6574  You can also set
-0000d970: 2069 7420 746f 2046 616c 7365 2061 6e64   it to False and
-0000d980: 2077 6520 7769 6c6c 206e 6f74 2074 7261   we will not tra
-0000d990: 6e73 666f 726d 2061 6e79 206f 6620 796f  nsform any of yo
-0000d9a0: 7572 2063 6174 6567 6f72 6965 7320 696e  ur categories in
-0000d9b0: 2079 6f75 7220 6361 7465 676f 7269 6361   your categorica
-0000d9c0: 6c20 7661 7269 6162 6c65 732e 0a20 2d20  l variables.. - 
-0000d9d0: 6076 6572 626f 7365 603a 2054 6869 7320  `verbose`: This 
-0000d9e0: 6861 7320 3320 706f 7373 6962 6c65 2073  has 3 possible s
-0000d9f0: 7461 7465 733a 0a20 202d 2060 3060 2073  tates:.  - `0` s
-0000da00: 696c 656e 7420 6f75 7470 7574 2e20 4772  ilent output. Gr
-0000da10: 6561 7420 666f 7220 7275 6e6e 696e 6720  eat for running 
-0000da20: 7468 6973 2073 696c 656e 746c 7920 616e  this silently an
-0000da30: 6420 6765 7474 696e 6720 6661 7374 2072  d getting fast r
-0000da40: 6573 756c 7473 2e0a 2020 2d20 6031 6020  esults..  - `1` 
-0000da50: 6d6f 7265 2076 6572 6269 6167 652e 2047  more verbiage. G
-0000da60: 7265 6174 2066 6f72 206b 6e6f 7769 6e67  reat for knowing
-0000da70: 2068 6f77 2072 6573 756c 7473 2077 6572   how results wer
-0000da80: 6520 616e 6420 6d61 6b69 6e67 2063 6861  e and making cha
-0000da90: 6e67 6573 2074 6f20 666c 6167 7320 696e  nges to flags in
-0000daa0: 2069 6e70 7574 2e0a 2020 2d20 6032 6020   input..  - `2` 
-0000dab0: 6869 6768 6c79 2076 6572 626f 7365 206f  highly verbose o
-0000dac0: 7574 7075 742e 2047 7265 6174 2066 6f72  utput. Great for
-0000dad0: 2066 696e 6469 6e67 206f 7574 2077 6861   finding out wha
-0000dae0: 7420 6861 7070 656e 7320 756e 6465 7220  t happens under 
-0000daf0: 7468 6520 686f 6f64 2069 6e20 6c61 7a79  the hood in lazy
-0000db00: 7472 616e 7366 6f72 6d20 7069 7065 6c69  transform pipeli
-0000db10: 6e65 732e 0a3c 703e 0a54 6f20 7669 6577  nes..<p>.To view
-0000db20: 2074 6865 2074 6578 7420 7069 7065 6c69   the text pipeli
-0000db30: 6e65 2c20 7468 6520 6465 6661 756c 7420  ne, the default 
-0000db40: 6469 7370 6c61 7920 6973 2027 7465 7874  display is 'text
-0000db50: 272c 2064 6f3a 3c62 723e 0a0a 6060 600a  ', do:<br>..```.
-0000db60: 6672 6f6d 2073 6b6c 6561 726e 2069 6d70  from sklearn imp
-0000db70: 6f72 7420 7365 745f 636f 6e66 6967 0a73  ort set_config.s
-0000db80: 6574 5f63 6f6e 6669 6728 6469 7370 6c61  et_config(displa
-0000db90: 793d 2274 6578 7422 290a 6c61 7a79 2e78  y="text").lazy.x
-0000dba0: 666f 726d 6572 0a60 6060 0a0a 3c70 3e0a  former.```..<p>.
-0000dbb0: 546f 2076 6965 7720 7468 6520 7069 7065  To view the pipe
-0000dbc0: 6c69 6e65 2069 6e20 6120 6469 6167 7261  line in a diagra
-0000dbd0: 6d20 2876 6973 7561 6c20 666f 726d 6174  m (visual format
-0000dbe0: 292c 2064 6f3a 3c62 723e 0a0a 6060 600a  ), do:<br>..```.
-0000dbf0: 6672 6f6d 2073 6b6c 6561 726e 2069 6d70  from sklearn imp
-0000dc00: 6f72 7420 7365 745f 636f 6e66 6967 0a73  ort set_config.s
-0000dc10: 6574 5f63 6f6e 6669 6728 6469 7370 6c61  et_config(displa
-0000dc20: 793d 2264 6961 6772 616d 2229 0a6c 617a  y="diagram").laz
-0000dc30: 792e 7866 6f72 6d65 720a 2320 4966 2079  y.xformer.# If y
-0000dc40: 6f75 2068 6176 6520 6120 6d6f 6465 6c20  ou have a model 
-0000dc50: 696e 2074 6865 2070 6970 656c 696e 652c  in the pipeline,
-0000dc60: 2064 6f3a 0a6c 617a 792e 6d6f 6465 6c66   do:.lazy.modelf
-0000dc70: 6f72 6d65 720a 6060 600a 3c61 2068 7265  ormer.```.<a hre
-0000dc80: 663d 2268 7474 7073 3a2f 2f69 6d67 6262  f="https://imgbb
-0000dc90: 2e63 6f6d 2f22 3e3c 696d 6720 7372 633d  .com/"><img src=
-0000dca0: 2268 7474 7073 3a2f 2f69 2e69 6262 2e63  "https://i.ibb.c
-0000dcb0: 6f2f 426e 3756 3470 782f 6c61 7a79 2d70  o/Bn7V4px/lazy-p
-0000dcc0: 6970 652e 706e 6722 2061 6c74 3d22 6c61  ipe.png" alt="la
-0000dcd0: 7a79 2d70 6970 6522 2062 6f72 6465 723d  zy-pipe" border=
-0000dce0: 2230 223e 3c2f 613e 0a0a 546f 2076 6965  "0"></a>..To vie
-0000dcf0: 7720 7468 6520 6665 6174 7572 6520 696d  w the feature im
-0000dd00: 706f 7274 616e 6365 7320 6f66 2074 6865  portances of the
-0000dd10: 206d 6f64 656c 2069 6e20 7468 6520 7069   model in the pi
-0000dd20: 7065 6c69 6e65 2c20 796f 7520 6361 6e20  peline, you can 
-0000dd30: 646f 3a0a 6060 600a 6c61 7a79 2e70 6c6f  do:.```.lazy.plo
-0000dd40: 745f 696d 706f 7274 616e 6365 2829 0a60  t_importance().`
-0000dd50: 6060 0a3c 6120 6872 6566 3d22 6874 7470  ``.<a href="http
-0000dd60: 733a 2f2f 6962 622e 636f 2f6a 6870 7356  s://ibb.co/jhpsV
-0000dd70: 744a 223e 3c69 6d67 2073 7263 3d22 6874  tJ"><img src="ht
-0000dd80: 7470 733a 2f2f 692e 6962 622e 636f 2f63  tps://i.ibb.co/c
-0000dd90: 4a6d 5662 7159 2f6c 617a 792d 6665 6174  JmVbqY/lazy-feat
-0000dda0: 2d69 6d70 2e70 6e67 2220 616c 743d 226c  -imp.png" alt="l
-0000ddb0: 617a 792d 6665 6174 2d69 6d70 2220 626f  azy-feat-imp" bo
-0000ddc0: 7264 6572 3d22 3022 3e3c 2f61 3e0a 0a23  rder="0"></a>..#
-0000ddd0: 2320 4d61 696e 7461 696e 6572 730a 0a2a  # Maintainers..*
-0000dde0: 205b 4041 7574 6f56 694d 4c5d 2868 7474   [@AutoViML](htt
-0000ddf0: 7073 3a2f 2f67 6974 6875 622e 636f 6d2f  ps://github.com/
-0000de00: 4175 746f 5669 4d4c 290a 0a23 2320 436f  AutoViML)..## Co
-0000de10: 6e74 7269 6275 7469 6e67 0a0a 5365 6520  ntributing..See 
-0000de20: 5b74 6865 2063 6f6e 7472 6962 7574 696e  [the contributin
-0000de30: 6720 6669 6c65 5d28 434f 4e54 5249 4255  g file](CONTRIBU
-0000de40: 5449 4e47 2e6d 6429 210a 0a50 5273 2061  TING.md)!..PRs a
-0000de50: 6363 6570 7465 642e 0a0a 2323 204c 6963  ccepted...## Lic
-0000de60: 656e 7365 0a0a 4170 6163 6865 204c 6963  ense..Apache Lic
-0000de70: 656e 7365 2032 2e30 20c2 a920 3230 3230  ense 2.0 .. 2020
-0000de80: 2052 616d 2053 6573 6861 6472 690a 0a23   Ram Seshadri..#
-0000de90: 2320 4e6f 7465 206f 6620 4772 6174 6974  # Note of Gratit
-0000dea0: 7564 650a 0a54 6869 7320 6c69 6272 6179  ude..This libray
-0000deb0: 2077 6f75 6c64 206e 6f74 2068 6176 6520   would not have 
-0000dec0: 6265 656e 2070 6f73 7369 626c 6520 7769  been possible wi
-0000ded0: 7468 6f75 7420 7468 6520 666f 6c6c 6f77  thout the follow
-0000dee0: 696e 6720 6772 6561 7420 6c69 6272 6172  ing great librar
-0000def0: 6965 733a 0a3c 6f6c 3e0a 3c6c 693e 3c62  ies:.<ol>.<li><b
-0000df00: 3e43 6174 6567 6f72 7920 456e 636f 6465  >Category Encode
-0000df10: 7273 206c 6962 7261 7279 3a3c 2f62 3e20  rs library:</b> 
-0000df20: 4661 6e74 6173 7469 6320 6c69 6272 6172  Fantastic librar
-0000df30: 7920 6874 7470 733a 2f2f 636f 6e74 7269  y https://contri
-0000df40: 622e 7363 696b 6974 2d6c 6561 726e 2e6f  b.scikit-learn.o
-0000df50: 7267 2f63 6174 6567 6f72 795f 656e 636f  rg/category_enco
-0000df60: 6465 7273 2f69 6e64 6578 2e68 746d 6c3c  ders/index.html<
-0000df70: 2f6c 693e 0a3c 6c69 3e3c 623e 496d 6261  /li>.<li><b>Imba
-0000df80: 6c61 6e63 6564 204c 6561 726e 206c 6962  lanced Learn lib
-0000df90: 7261 7279 3a3c 2f62 3e20 416e 6f74 6865  rary:</b> Anothe
-0000dfa0: 7220 6661 6e74 6173 7469 6320 6c69 6272  r fantastic libr
-0000dfb0: 6172 7920 6874 7470 733a 2f2f 696d 6261  ary https://imba
-0000dfc0: 6c61 6e63 6564 2d6c 6561 726e 2e6f 7267  lanced-learn.org
-0000dfd0: 2f73 7461 626c 652f 696e 6465 782e 6874  /stable/index.ht
-0000dfe0: 6d6c 3c2f 6c69 3e0a 3c6c 693e 3c62 3e54  ml</li>.<li><b>T
-0000dff0: 6865 2061 6d61 7a69 6e67 2060 6c61 7a79  he amazing `lazy
-0000e000: 7072 6564 6963 7460 3c2f 623e 2077 6173  predict`</b> was
-0000e010: 2061 6e20 696e 7370 6972 6174 696f 6e20   an inspiration 
-0000e020: 666f 7220 606c 617a 7974 7261 6e73 666f  for `lazytransfo
-0000e030: 726d 602e 2059 6f75 2063 616e 2063 6865  rm`. You can che
-0000e040: 636b 206f 7574 2074 6865 206c 6962 7261  ck out the libra
-0000e050: 7279 2068 6572 653a 0a68 7474 7073 3a2f  ry here:.https:/
-0000e060: 2f67 6974 6875 622e 636f 6d2f 7368 616e  /github.com/shan
-0000e070: 6b61 7270 616e 6461 6c61 2f6c 617a 7970  karpandala/lazyp
-0000e080: 7265 6469 6374 0a3c 2f6c 693e 0a3c 6c69  redict.</li>.<li
-0000e090: 3e3c 623e 5468 6520 616d 617a 696e 6720  ><b>The amazing 
-0000e0a0: 604b 6576 696e 204d 6172 6b68 616d 603c  `Kevin Markham`<
-0000e0b0: 2f62 3e20 7761 7320 616e 6f74 6865 7220  /b> was another 
-0000e0c0: 696e 7370 6972 6174 696f 6e20 666f 7220  inspiration for 
-0000e0d0: 6c61 7a79 7472 616e 7366 6f72 6d2e 2059  lazytransform. Y
-0000e0e0: 6f75 2063 616e 2063 6865 636b 206f 7574  ou can check out
-0000e0f0: 2068 6973 2063 6c61 7373 6573 2068 6572   his classes her
-0000e100: 653a 0a68 7474 7073 3a2f 2f77 7777 2e64  e:.https://www.d
-0000e110: 6174 6173 6368 6f6f 6c2e 696f 2f61 626f  ataschool.io/abo
-0000e120: 7574 2f0a 3c2f 6c69 3e0a 3c2f 6f6c 3e0a  ut/.</li>.</ol>.
-0000e130: 0a23 2320 4449 5343 4c41 494d 4552 0a54  .## DISCLAIMER.T
-0000e140: 6869 7320 7072 6f6a 6563 7420 6973 206e  his project is n
-0000e150: 6f74 2061 6e20 6f66 6669 6369 616c 2047  ot an official G
-0000e160: 6f6f 676c 6520 7072 6f6a 6563 742e 2049  oogle project. I
-0000e170: 7420 6973 206e 6f74 2073 7570 706f 7274  t is not support
-0000e180: 6564 2062 7920 476f 6f67 6c65 2061 6e64  ed by Google and
-0000e190: 2047 6f6f 676c 6520 7370 6563 6966 6963   Google specific
-0000e1a0: 616c 6c79 2064 6973 636c 6169 6d73 2061  ally disclaims a
-0000e1b0: 6c6c 2077 6172 7261 6e74 6965 7320 6173  ll warranties as
-0000e1c0: 2074 6f20 6974 7320 7175 616c 6974 792c   to its quality,
-0000e1d0: 206d 6572 6368 616e 7461 6269 6c69 7479   merchantability
-0000e1e0: 2c20 6f72 2066 6974 6e65 7373 2066 6f72  , or fitness for
-0000e1f0: 2061 2070 6172 7469 6375 6c61 7220 7075   a particular pu
-0000e200: 7270 6f73 652e 0a0a 0000 0000 0000 0000  rpose...........
-0000e210: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-0000e220: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-0000e230: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-0000e240: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-0000e250: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-0000e260: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-0000e270: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-0000e280: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-0000e290: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-0000e2a0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-0000e2b0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-0000e2c0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-0000e2d0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-0000e2e0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-0000e2f0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-0000e300: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-0000e310: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-0000e320: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-0000e330: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-0000e340: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-0000e350: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-0000e360: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-0000e370: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-0000e380: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-0000e390: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-0000e3a0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-0000e3b0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-0000e3c0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-0000e3d0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-0000e3e0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-0000e3f0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-0000e400: 2e2f 2e2f 4050 6178 4865 6164 6572 0000  ././@PaxHeader..
-0000e410: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-0000e420: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-0000e430: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-0000e440: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-0000e450: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-0000e460: 0000 0000 3030 3030 3030 3000 3030 3030  ....0000000.0000
-0000e470: 3030 3000 3030 3030 3030 3000 3030 3030  000.0000000.0000
-0000e480: 3030 3030 3033 3400 3030 3030 3030 3030  0000034.00000000
-0000e490: 3030 3000 3031 3134 3532 0020 7800 0000  000.011452. x...
-0000e4a0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-0000e4b0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-0000e4c0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-0000e4d0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-0000e4e0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-0000e4f0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-0000e500: 0075 7374 6172 0030 3000 0000 0000 0000  .ustar.00.......
-0000e510: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-0000e520: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-0000e530: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-0000e540: 0000 0000 0000 0000 0030 3030 3030 3030  .........0000000
-0000e550: 0030 3030 3030 3030 0000 0000 0000 0000  .0000000........
-0000e560: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-0000e570: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-0000e580: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-0000e590: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-0000e5a0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-0000e5b0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-0000e5c0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-0000e5d0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-0000e5e0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-0000e5f0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-0000e600: 3238 206d 7469 6d65 3d31 3636 3432 3832  28 mtime=1664282
-0000e610: 3237 342e 3239 3631 3532 380a 0000 0000  274.2961528.....
-0000e620: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-0000e630: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-0000e640: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-0000e650: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-0000e660: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-0000e670: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-0000e680: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-0000e690: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-0000e6a0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-0000e6b0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-0000e6c0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-0000e6d0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-0000e6e0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-0000e6f0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-0000e700: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-0000e710: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-0000e720: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-0000e730: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-0000e740: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-0000e750: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-0000e760: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-0000e770: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-0000e780: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-0000e790: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-0000e7a0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-0000e7b0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-0000e7c0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-0000e7d0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-0000e7e0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-0000e7f0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-0000e800: 6c61 7a79 7472 616e 7366 6f72 6d2d 312e  lazytransform-1.
-0000e810: 302f 6c61 7a79 7472 616e 7366 6f72 6d2e  0/lazytransform.
-0000e820: 6567 672d 696e 666f 2f00 0000 0000 0000  egg-info/.......
-0000e830: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-0000e840: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-0000e850: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-0000e860: 0000 0000 3030 3030 3737 3700 3030 3031  ....0000777.0001
-0000e870: 3735 3000 3030 3031 3735 3000 3030 3030  750.0001750.0000
-0000e880: 3030 3030 3030 3000 3030 3030 3030 3030  0000000.00000000
-0000e890: 3030 3000 3032 3032 3537 0020 3500 0000  000.020257. 5...
-0000e8a0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-0000e8b0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-0000e8c0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-0000e8d0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-0000e8e0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-0000e8f0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-0000e900: 0075 7374 6172 0030 3072 616d 0000 0000  .ustar.00ram....
-0000e910: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-0000e920: 0000 0000 0000 0000 0072 616d 0000 0000  .........ram....
-0000e930: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-0000e940: 0000 0000 0000 0000 0030 3030 3030 3030  .........0000000
-0000e950: 0030 3030 3030 3030 0000 0000 0000 0000  .0000000........
-0000e960: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-0000e970: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-0000e980: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-0000e990: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-0000e9a0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-0000e9b0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-0000e9c0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-0000e9d0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-0000e9e0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-0000e9f0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-0000ea00: 2e2f 2e2f 4050 6178 4865 6164 6572 0000  ././@PaxHeader..
-0000ea10: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-0000ea20: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-0000ea30: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-0000ea40: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-0000ea50: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-0000ea60: 0000 0000 3030 3030 3030 3000 3030 3030  ....0000000.0000
-0000ea70: 3030 3000 3030 3030 3030 3000 3030 3030  000.0000000.0000
-0000ea80: 3030 3030 3032 3600 3030 3030 3030 3030  0000026.00000000
-0000ea90: 3030 3000 3031 3134 3533 0020 7800 0000  000.011453. x...
-0000eaa0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-0000eab0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-0000eac0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-0000ead0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-0000eae0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-0000eaf0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-0000eb00: 0075 7374 6172 0030 3000 0000 0000 0000  .ustar.00.......
-0000eb10: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-0000eb20: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-0000eb30: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-0000eb40: 0000 0000 0000 0000 0030 3030 3030 3030  .........0000000
-0000eb50: 0030 3030 3030 3030 0000 0000 0000 0000  .0000000........
-0000eb60: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-0000eb70: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-0000eb80: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-0000eb90: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-0000eba0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-0000ebb0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-0000ebc0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-0000ebd0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-0000ebe0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-0000ebf0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-0000ec00: 3232 206d 7469 6d65 3d31 3636 3432 3832  22 mtime=1664282
-0000ec10: 3237 332e 300a 0000 0000 0000 0000 0000  273.0...........
-0000ec20: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-0000ec30: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-0000ec40: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-0000ec50: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-0000ec60: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-0000ec70: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-0000ec80: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-0000ec90: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-0000eca0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-0000ecb0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-0000ecc0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-0000ecd0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-0000ece0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-0000ecf0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-0000ed00: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-0000ed10: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-0000ed20: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-0000ed30: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-0000ed40: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-0000ed50: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-0000ed60: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-0000ed70: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-0000ed80: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-0000ed90: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-0000eda0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-0000edb0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-0000edc0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-0000edd0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-0000ede0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-0000edf0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-0000ee00: 6c61 7a79 7472 616e 7366 6f72 6d2d 312e  lazytransform-1.
-0000ee10: 302f 6c61 7a79 7472 616e 7366 6f72 6d2e  0/lazytransform.
-0000ee20: 6567 672d 696e 666f 2f50 4b47 2d49 4e46  egg-info/PKG-INF
-0000ee30: 4f00 0000 0000 0000 0000 0000 0000 0000  O...............
-0000ee40: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-0000ee50: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-0000ee60: 0000 0000 3030 3030 3737 3700 3030 3031  ....0000777.0001
-0000ee70: 3735 3000 3030 3031 3735 3000 3030 3030  750.0001750.0000
-0000ee80: 3030 3436 3731 3600 3030 3030 3030 3030  0046716.00000000
-0000ee90: 3030 3000 3032 3133 3735 0020 3000 0000  000.021375. 0...
-0000eea0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-0000eeb0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-0000eec0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-0000eed0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-0000eee0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-0000eef0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-0000ef00: 0075 7374 6172 0030 3072 616d 0000 0000  .ustar.00ram....
-0000ef10: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-0000ef20: 0000 0000 0000 0000 0072 616d 0000 0000  .........ram....
-0000ef30: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-0000ef40: 0000 0000 0000 0000 0030 3030 3030 3030  .........0000000
-0000ef50: 0030 3030 3030 3030 0000 0000 0000 0000  .0000000........
-0000ef60: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-0000ef70: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-0000ef80: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-0000ef90: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-0000efa0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-0000efb0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-0000efc0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-0000efd0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-0000efe0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-0000eff0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-0000f000: 4d65 7461 6461 7461 2d56 6572 7369 6f6e  Metadata-Version
-0000f010: 3a20 322e 310a 4e61 6d65 3a20 6c61 7a79  : 2.1.Name: lazy
-0000f020: 7472 616e 7366 6f72 6d0a 5665 7273 696f  transform.Versio
-0000f030: 6e3a 2031 2e30 0a53 756d 6d61 7279 3a20  n: 1.0.Summary: 
-0000f040: 4175 746f 6d61 7469 6361 6c6c 7920 6275  Automatically bu
-0000f050: 696c 6420 6461 7461 2061 6e64 206d 6f64  ild data and mod
-0000f060: 656c 2070 6970 656c 696e 6573 2075 7369  el pipelines usi
-0000f070: 6e67 2073 6369 6b69 742d 6c65 6172 6e20  ng scikit-learn 
-0000f080: 696e 2061 2073 696e 676c 6520 6c69 6e65  in a single line
-0000f090: 206f 6620 636f 6465 0a48 6f6d 652d 7061   of code.Home-pa
-0000f0a0: 6765 3a20 6874 7470 733a 2f2f 6769 7468  ge: https://gith
-0000f0b0: 7562 2e63 6f6d 2f41 7574 6f56 694d 4c2f  ub.com/AutoViML/
-0000f0c0: 6c61 7a79 7472 616e 7366 6f72 6d0a 4175  lazytransform.Au
-0000f0d0: 7468 6f72 3a20 5261 6d20 5365 7368 6164  thor: Ram Seshad
-0000f0e0: 7269 0a4c 6963 656e 7365 3a20 4170 6163  ri.License: Apac
-0000f0f0: 6865 204c 6963 656e 7365 2032 2e30 0a44  he License 2.0.D
-0000f100: 6573 6372 6970 7469 6f6e 3a20 2320 6c61  escription: # la
-0000f110: 7a79 7472 616e 7366 6f72 6d0a 2020 2020  zytransform.    
-0000f120: 2020 2020 4175 746f 6d61 7469 6361 6c6c      Automaticall
-0000f130: 7920 7472 616e 7366 6f72 6d20 616c 6c20  y transform all 
-0000f140: 6361 7465 676f 7269 6361 6c2c 2064 6174  categorical, dat
-0000f150: 652d 7469 6d65 2c20 4e4c 5020 7661 7269  e-time, NLP vari
-0000f160: 6162 6c65 7320 696e 2079 6f75 7220 6461  ables in your da
-0000f170: 7461 2073 6574 2074 6f20 6e75 6d65 7269  ta set to numeri
-0000f180: 6320 696e 2061 2073 696e 676c 6520 6c69  c in a single li
-0000f190: 6e65 206f 6620 636f 6465 2066 6f72 2061  ne of code for a
-0000f1a0: 6e79 2064 6174 6120 7365 7420 616e 7920  ny data set any 
-0000f1b0: 7369 7a65 2e0a 2020 2020 2020 2020 0a20  size..        . 
-0000f1c0: 2020 2020 2020 203c 6120 6872 6566 3d22         <a href="
-0000f1d0: 6874 7470 733a 2f2f 6769 7468 7562 2e63  https://github.c
-0000f1e0: 6f6d 2f41 7574 6f56 694d 4c2f 6c61 7a79  om/AutoViML/lazy
-0000f1f0: 7472 616e 7366 6f72 6d22 3e3c 696d 6720  transform"><img 
-0000f200: 7372 633d 2268 7474 7073 3a2f 2f69 2e69  src="https://i.i
-0000f210: 6262 2e63 6f2f 576b 7446 6b74 4c2f 6c61  bb.co/WktFktL/la
-0000f220: 7a79 7472 616e 7366 6f72 6d65 722e 706e  zytransformer.pn
-0000f230: 6722 2061 6c74 3d22 6c61 7a79 7472 616e  g" alt="lazytran
-0000f240: 7366 6f72 6d65 7222 2062 6f72 6465 723d  sformer" border=
-0000f250: 2230 223e 3c2f 613e 0a20 2020 2020 2020  "0"></a>.       
-0000f260: 2023 2320 5570 6461 7465 2028 4175 6720   ## Update (Aug 
-0000f270: 3230 3232 290a 2020 2020 2020 2020 3c6f  2022).        <o
-0000f280: 6c3e 0a20 2020 2020 2020 203c 6c69 3e3c  l>.        <li><
-0000f290: 623e 6c61 7a79 7472 616e 7366 6f72 6d20  b>lazytransform 
-0000f2a0: 6973 2076 6572 7920 6561 7379 2074 6f20  is very easy to 
-0000f2b0: 696e 7374 616c 6c20 6f6e 204b 6167 676c  install on Kaggl
-0000f2c0: 6520 616e 6420 436f 6c61 6220 6e6f 7465  e and Colab note
-0000f2d0: 626f 6f6b 7320 7573 696e 6720 7468 6973  books using this
-0000f2e0: 2063 6f6d 6d61 6e64 3a3c 2f62 3e2e 200a   command:</b>. .
-0000f2f0: 2020 2020 2020 2020 0a20 2020 2020 2020          .       
-0000f300: 2060 6060 0a20 2020 2020 2020 2021 7069   ```.        !pi
-0000f310: 7020 696e 7374 616c 6c20 6c61 7a79 7472  p install lazytr
-0000f320: 616e 7366 6f72 6d20 2d2d 6967 6e6f 7265  ansform --ignore
-0000f330: 2d69 6e73 7461 6c6c 6564 202d 2d6e 6f2d  -installed --no-
-0000f340: 6361 6368 6520 2d2d 6e6f 2d64 6570 730a  cache --no-deps.
-0000f350: 2020 2020 2020 2020 6060 600a 2020 2020          ```.    
-0000f360: 2020 2020 3c2f 6c69 3e3c 6272 3e0a 2020      </li><br>.  
-0000f370: 2020 2020 2020 3c6c 693e 3c62 3e6c 617a        <li><b>laz
-0000f380: 7974 7261 6e73 666f 726d 2061 7320 6f66  ytransform as of
-0000f390: 2076 6572 7369 6f6e 2030 2e39 3120 6861   version 0.91 ha
-0000f3a0: 7320 7477 6f20 5375 7065 7220 4c65 6172  s two Super Lear
-0000f3b0: 6e69 6e67 204f 7074 696d 697a 6564 2028  ning Optimized (
-0000f3c0: 5355 4c4f 2920 456e 7365 6d62 6c65 7320  SULO) Ensembles 
-0000f3d0: 6e61 6d65 6420 2253 756c 6f43 6c61 7373  named "SuloClass
-0000f3e0: 6966 6965 7222 2061 6e64 2022 5375 6c6f  ifier" and "Sulo
-0000f3f0: 5265 6772 6573 736f 7222 3c2f 623e 2e20  Regressor"</b>. 
-0000f400: 5468 6520 6573 7469 6d61 746f 7273 2061  The estimators a
-0000f410: 7265 2022 6f70 7469 6d69 7a65 6422 2069  re "optimized" i
-0000f420: 6e20 7468 6520 7365 6e73 6520 7468 6174  n the sense that
-0000f430: 2079 6f75 2063 616e 2075 7365 2074 6865   you can use the
-0000f440: 6d20 666f 7220 616c 6c20 6b69 6e64 7320  m for all kinds 
-0000f450: 6f66 206d 756c 7469 2d6c 6162 656c 206d  of multi-label m
-0000f460: 756c 7469 2d63 6c61 7373 2061 6e64 2049  ulti-class and I
-0000f470: 6d62 616c 616e 6365 6420 6461 7461 2073  mbalanced data s
-0000f480: 6574 2070 726f 626c 656d 7320 7769 7468  et problems with
-0000f490: 6f75 7420 6e65 6564 696e 6720 746f 2064  out needing to d
-0000f4a0: 6f20 6879 7065 722d 7061 7261 6d65 7465  o hyper-paramete
-0000f4b0: 7220 7475 6e69 6e67 2077 6974 6820 4772  r tuning with Gr
-0000f4c0: 6964 5365 6172 6368 4356 2e20 5468 6579  idSearchCV. They
-0000f4d0: 2061 7265 2062 7569 6c74 2075 7369 6e67   are built using
-0000f4e0: 2062 6173 6963 2073 6369 6b69 742d 6c65   basic scikit-le
-0000f4f0: 6172 6e20 6573 7469 6d61 746f 7273 2061  arn estimators a
-0000f500: 6e64 2061 7265 2073 656c 662d 6f70 7469  nd are self-opti
-0000f510: 6d69 7a69 6e67 2073 696e 6365 2074 6865  mizing since the
-0000f520: 7920 7065 7266 6f72 6d20 6879 7065 722d  y perform hyper-
-0000f530: 7061 7261 6d20 7475 6e69 6e67 2066 6f72  param tuning for
-0000f540: 2065 6163 6820 6b69 6e64 206f 6620 7072   each kind of pr
-0000f550: 6f62 6c65 6d20 616e 6420 7573 6520 7765  oblem and use we
-0000f560: 6967 6874 7320 666f 7220 6561 6368 2063  ights for each c
-0000f570: 6c61 7373 6966 6965 7220 6f72 2072 6567  lassifier or reg
-0000f580: 7265 7373 6f72 2c20 6469 6666 6572 656e  ressor, differen
-0000f590: 7420 7261 6e64 6f6d 2073 6565 6473 2c20  t random seeds, 
-0000f5a0: 6574 632e 2074 6f20 6d61 6b65 2074 6865  etc. to make the
-0000f5b0: 6d20 6869 6768 6c79 2070 6572 666f 726d  m highly perform
-0000f5c0: 616e 742e 204f 6e20 746f 7020 6f66 2069  ant. On top of i
-0000f5d0: 742c 2074 6865 7920 6172 6520 6675 6c6c  t, they are full
-0000f5e0: 7920 7363 696b 6974 2d6c 6561 726e 2063  y scikit-learn c
-0000f5f0: 6f6d 7061 7469 626c 6520 7769 7468 2074  ompatible with t
-0000f600: 6865 2073 616d 6520 2266 6974 2061 6e64  he same "fit and
-0000f610: 2070 7265 6469 6374 2220 7379 6e74 6178   predict" syntax
-0000f620: 2e20 3c2f 6c69 3e0a 2020 2020 2020 2020  . </li>.        
-0000f630: 5461 6b65 2061 206c 6f6f 6b20 6174 2074  Take a look at t
-0000f640: 6865 2062 656e 6368 6d61 726b 696e 6720  he benchmarking 
-0000f650: 7265 7375 6c74 7320 6e6f 7465 626f 6f6b  results notebook
-0000f660: 2068 6572 6520 666f 7220 5375 6c6f 436c   here for SuloCl
-0000f670: 6173 7369 6669 6572 3a20 0a20 2020 2020  assifier: .     
-0000f680: 2020 200a 2020 2020 2020 2020 215b 4e6f     .        ![No
-0000f690: 7465 626f 6f6b 5d28 6874 7470 733a 2f2f  tebook](https://
-0000f6a0: 6769 7468 7562 2e63 6f6d 2f41 7574 6f56  github.com/AutoV
-0000f6b0: 694d 4c2f 6c61 7a79 7472 616e 7366 6f72  iML/lazytransfor
-0000f6c0: 6d2f 7472 6565 2f6d 6169 6e2f 6e6f 7465  m/tree/main/note
-0000f6d0: 626f 6f6b 732f 5375 6c6f 436c 6173 7369  books/SuloClassi
-0000f6e0: 6669 6572 5f42 656e 6368 6d61 726b 696e  fier_Benchmarkin
-0000f6f0: 675f 5265 7375 6c74 732e 6970 796e 6229  g_Results.ipynb)
-0000f700: 0a20 2020 2020 2020 200a 2020 2020 2020  .        .      
-0000f710: 2020 215b 5375 6c6f 436c 6173 7369 6669    ![SuloClassifi
-0000f720: 6572 5d28 2e2f 696d 6167 6573 2f53 756c  er](./images/Sul
-0000f730: 6f43 6c61 7373 6966 6965 722e 706e 6729  oClassifier.png)
-0000f740: 0a20 2020 2020 2020 200a 2020 2020 2020  .        .      
-0000f750: 2020 5765 2072 616e 2061 2073 696d 696c    We ran a simil
-0000f760: 6172 2062 656e 6368 6d61 726b 696e 6720  ar benchmarking 
-0000f770: 7265 7375 6c74 2069 6e20 5375 6c6f 5265  result in SuloRe
-0000f780: 6772 6573 736f 7220 6167 6169 6e73 7420  gressor against 
-0000f790: 5847 426f 6f73 7420 616e 6420 4c69 6768  XGBoost and Ligh
-0000f7a0: 7447 424d 2052 6567 7265 7373 6f72 7320  tGBM Regressors 
-0000f7b0: 616e 6420 6974 2068 656c 6420 6974 7320  and it held its 
-0000f7c0: 6f77 6e20 6167 6169 6e73 7420 7468 656d  own against them
-0000f7d0: 2e20 5461 6b65 2061 206c 6f6f 6b20 6174  . Take a look at
-0000f7e0: 2074 6865 2062 656e 6368 6d61 726b 696e   the benchmarkin
-0000f7f0: 6720 7265 7375 6c74 3a0a 2020 2020 2020  g result:.      
-0000f800: 2020 0a20 2020 2020 2020 2021 5b4e 6f74    .        ![Not
-0000f810: 6562 6f6f 6b5d 2868 7474 7073 3a2f 2f67  ebook](https://g
-0000f820: 6974 6875 622e 636f 6d2f 4175 746f 5669  ithub.com/AutoVi
-0000f830: 4d4c 2f6c 617a 7974 7261 6e73 666f 726d  ML/lazytransform
-0000f840: 2f74 7265 652f 6d61 696e 2f6e 6f74 6562  /tree/main/noteb
-0000f850: 6f6f 6b73 2f53 756c 6f52 6567 7265 7373  ooks/SuloRegress
-0000f860: 6f72 5f42 656e 6368 6d61 726b 696e 675f  or_Benchmarking_
-0000f870: 5265 7375 6c74 732e 6970 796e 6229 0a20  Results.ipynb). 
-0000f880: 2020 2020 2020 200a 2020 2020 2020 2020         .        
-0000f890: 215b 5375 6c6f 5265 6772 6573 736f 725d  ![SuloRegressor]
-0000f8a0: 282e 2f69 6d61 6765 732f 5375 6c6f 5265  (./images/SuloRe
-0000f8b0: 6772 6573 736f 722e 706e 6729 0a20 2020  gressor.png).   
-0000f8c0: 2020 2020 200a 2020 2020 2020 2020 2320       .        # 
-0000f8d0: 5461 626c 6520 6f66 2043 6f6e 7465 6e74  Table of Content
-0000f8e0: 730a 2020 2020 2020 2020 3c75 6c3e 0a20  s.        <ul>. 
-0000f8f0: 2020 2020 2020 203c 6c69 3e3c 6120 6872         <li><a hr
-0000f900: 6566 3d22 2369 6e74 726f 6475 6374 696f  ef="#introductio
-0000f910: 6e22 3e57 6861 7420 6973 206c 617a 7974  n">What is lazyt
-0000f920: 7261 6e73 666f 726d 3c2f 613e 3c2f 6c69  ransform</a></li
-0000f930: 3e0a 2020 2020 2020 2020 3c6c 693e 3c61  >.        <li><a
-0000f940: 2068 7265 663d 2223 7573 6573 223e 486f   href="#uses">Ho
-0000f950: 7720 746f 2075 7365 206c 617a 7974 7261  w to use lazytra
-0000f960: 6e73 666f 726d 3c2f 613e 3c2f 6c69 3e0a  nsform</a></li>.
-0000f970: 2020 2020 2020 2020 3c6c 693e 3c61 2068          <li><a h
-0000f980: 7265 663d 2223 696e 7374 616c 6c22 3e48  ref="#install">H
-0000f990: 6f77 2074 6f20 696e 7374 616c 6c20 6c61  ow to install la
-0000f9a0: 7a79 7472 616e 7366 6f72 6d3c 2f61 3e3c  zytransform</a><
-0000f9b0: 2f6c 693e 0a20 2020 2020 2020 203c 6c69  /li>.        <li
-0000f9c0: 3e3c 6120 6872 6566 3d22 2375 7361 6765  ><a href="#usage
-0000f9d0: 223e 5573 6167 653c 2f61 3e3c 2f6c 693e  ">Usage</a></li>
-0000f9e0: 0a20 2020 2020 2020 203c 6c69 3e3c 6120  .        <li><a 
-0000f9f0: 6872 6566 3d22 2361 7069 223e 4150 493c  href="#api">API<
-0000fa00: 2f61 3e3c 2f6c 693e 0a20 2020 2020 2020  /a></li>.       
-0000fa10: 203c 6c69 3e3c 6120 6872 6566 3d22 236d   <li><a href="#m
-0000fa20: 6169 6e74 6169 6e65 7273 223e 4d61 696e  aintainers">Main
-0000fa30: 7461 696e 6572 733c 2f61 3e3c 2f6c 693e  tainers</a></li>
-0000fa40: 0a20 2020 2020 2020 203c 6c69 3e3c 6120  .        <li><a 
-0000fa50: 6872 6566 3d22 2363 6f6e 7472 6962 7574  href="#contribut
-0000fa60: 696e 6722 3e43 6f6e 7472 6962 7574 696e  ing">Contributin
-0000fa70: 673c 2f61 3e3c 2f6c 693e 0a20 2020 2020  g</a></li>.     
-0000fa80: 2020 203c 6c69 3e3c 6120 6872 6566 3d22     <li><a href="
-0000fa90: 236c 6963 656e 7365 223e 4c69 6365 6e73  #license">Licens
-0000faa0: 653c 2f61 3e3c 2f6c 693e 0a20 2020 2020  e</a></li>.     
-0000fab0: 2020 203c 2f75 6c3e 0a20 2020 2020 2020     </ul>.       
-0000fac0: 203c 703e 0a20 2020 2020 2020 200a 2020   <p>.        .  
-0000fad0: 2020 2020 2020 2323 2049 6e74 726f 6475        ## Introdu
-0000fae0: 6374 696f 6e0a 2020 2020 2020 2020 2323  ction.        ##
-0000faf0: 2320 5768 6174 2069 7320 6c61 7a79 7472  # What is lazytr
-0000fb00: 616e 7366 6f72 6d3f 0a20 2020 2020 2020  ansform?.       
-0000fb10: 2060 6c61 7a79 7472 616e 7366 6f72 6d60   `lazytransform`
-0000fb20: 2069 7320 6120 6e65 7720 7079 7468 6f6e   is a new python
-0000fb30: 206c 6962 7261 7279 2066 6f72 2061 7574   library for aut
-0000fb40: 6f6d 6174 6963 616c 6c79 2074 7261 6e73  omatically trans
-0000fb50: 666f 726d 696e 6720 796f 7572 2065 6e74  forming your ent
-0000fb60: 6972 6520 6461 7461 7365 7420 746f 206e  ire dataset to n
-0000fb70: 756d 6572 6963 2066 6f72 6d61 7420 7573  umeric format us
-0000fb80: 696e 6720 6361 7465 676f 7279 2065 6e63  ing category enc
-0000fb90: 6f64 6572 732c 204e 4c50 2074 6578 7420  oders, NLP text 
-0000fba0: 7665 6374 6f72 697a 6572 7320 616e 6420  vectorizers and 
-0000fbb0: 7061 6e64 6173 2064 6174 6520 7469 6d65  pandas date time
-0000fbc0: 2070 726f 6365 7373 696e 6720 6675 6e63   processing func
-0000fbd0: 7469 6f6e 732e 2041 6c6c 2069 6e20 6120  tions. All in a 
-0000fbe0: 7369 6e67 6c65 206c 696e 6520 6f66 2063  single line of c
-0000fbf0: 6f64 6521 0a20 2020 2020 2020 200a 2020  ode!.        .  
-0000fc00: 2020 2020 2020 3c61 2068 7265 663d 2268        <a href="h
-0000fc10: 7474 7073 3a2f 2f67 6974 6875 622e 636f  ttps://github.co
-0000fc20: 6d2f 4175 746f 5669 4d4c 2f6c 617a 7974  m/AutoViML/lazyt
-0000fc30: 7261 6e73 666f 726d 223e 3c69 6d67 2073  ransform"><img s
-0000fc40: 7263 3d22 6874 7470 733a 2f2f 692e 6962  rc="https://i.ib
-0000fc50: 622e 636f 2f6e 7a59 7873 386b 2f6c 617a  b.co/nzYxs8k/laz
-0000fc60: 7974 7261 6e73 666f 726d 6572 2e70 6e67  ytransformer.png
-0000fc70: 2220 616c 743d 226c 617a 7974 7261 6e73  " alt="lazytrans
-0000fc80: 666f 726d 6572 2220 626f 7264 6572 3d22  former" border="
-0000fc90: 3022 3e3c 2f61 3e0a 2020 2020 2020 2020  0"></a>.        
-0000fca0: 0a20 2020 2020 2020 2023 2320 5573 6573  .        ## Uses
-0000fcb0: 0a20 2020 2020 2020 2060 6c61 7a79 7472  .        `lazytr
-0000fcc0: 616e 7366 6f72 6d60 2068 6173 2074 776f  ansform` has two
-0000fcd0: 2069 6d70 6f72 7461 6e74 2075 7365 7320   important uses 
-0000fce0: 696e 2074 6865 2044 6174 6120 5363 6965  in the Data Scie
-0000fcf0: 6e63 6520 7072 6f63 6573 732e 2049 7420  nce process. It 
-0000fd00: 6361 6e20 6265 2075 7365 6420 696e 2046  can be used in F
-0000fd10: 6561 7475 7265 2045 6e67 6720 746f 2074  eature Engg to t
-0000fd20: 7261 6e73 666f 726d 2066 6561 7475 7265  ransform feature
-0000fd30: 7320 6f72 2061 6464 2066 6561 7475 7265  s or add feature
-0000fd40: 7320 2873 6565 2041 5049 2062 656c 6f77  s (see API below
-0000fd50: 292e 2049 7420 6361 6e20 616c 736f 2062  ). It can also b
-0000fd60: 6520 7573 6564 2069 6e20 4d4c 4f70 7320  e used in MLOps 
-0000fd70: 746f 2074 7261 696e 2061 6e64 2065 7661  to train and eva
-0000fd80: 6c75 6174 6520 6d6f 6465 6c73 2069 6e20  luate models in 
-0000fd90: 6461 7461 2070 6970 656c 696e 6573 2077  data pipelines w
-0000fda0: 6974 6820 6d75 6c74 6970 6c65 206d 6f64  ith multiple mod
-0000fdb0: 656c 7320 6265 696e 6720 7472 6169 6e65  els being traine
-0000fdc0: 6420 7369 6d75 6c74 616e 6575 736c 7920  d simultaneusly 
-0000fdd0: 7573 696e 6720 7468 6520 7361 6d65 2074  using the same t
-0000fde0: 7261 696e 2f74 6573 7420 7370 6c69 7420  rain/test split 
-0000fdf0: 616e 6420 7468 6520 7361 6d65 2066 6561  and the same fea
-0000fe00: 7475 7265 2065 6e67 6720 7374 6570 732e  ture engg steps.
-0000fe10: 2054 6869 7320 656e 7375 7265 7320 7468   This ensures th
-0000fe20: 6174 2074 6865 7265 2069 7320 6162 736f  at there is abso
-0000fe30: 6c75 7465 6c79 207a 6572 6f20 6f72 206d  lutely zero or m
-0000fe40: 696e 696d 616c 2064 6174 6120 6c65 616b  inimal data leak
-0000fe50: 6167 6520 696e 2079 6f75 7220 4d4c 4f70  age in your MLOp
-0000fe60: 7320 7069 7065 6c69 6e65 732e 0a20 2020  s pipelines..   
-0000fe70: 2020 2020 200a 2020 2020 2020 2020 2323       .        ##
-0000fe80: 2320 312e 2020 5573 696e 6720 6c61 7a79  # 1.  Using lazy
-0000fe90: 7472 616e 7366 6f72 6d20 6173 2061 2073  transform as a s
-0000fea0: 696d 706c 6520 7061 6e64 6173 2064 6174  imple pandas dat
-0000feb0: 6120 7472 616e 7366 6f72 6d61 7469 6f6e  a transformation
-0000fec0: 2070 6970 656c 696e 6520 0a20 2020 2020   pipeline .     
-0000fed0: 2020 200a 2020 2020 2020 2020 3c70 3e54     .        <p>T
-0000fee0: 6865 2066 6972 7374 206d 6574 686f 6420  he first method 
-0000fef0: 6973 2070 726f 6261 626c 7920 7468 6520  is probably the 
-0000ff00: 6d6f 7374 2070 6f70 756c 6172 2077 6179  most popular way
-0000ff10: 2074 6f20 7573 6520 6c61 7a79 7472 616e   to use lazytran
-0000ff20: 7366 6f72 6d2e 2054 6865 2074 7261 6e73  sform. The trans
-0000ff30: 666f 726d 6572 2077 6974 6869 6e20 6c61  former within la
-0000ff40: 7a79 7472 616e 7366 6f72 6d20 6361 6e20  zytransform can 
-0000ff50: 6265 2075 7365 6420 746f 2074 7261 6e73  be used to trans
-0000ff60: 666f 726d 2061 6e64 2063 7265 6174 6520  form and create 
-0000ff70: 6e65 7720 6665 6174 7572 6573 2066 726f  new features fro
-0000ff80: 6d20 6361 7465 676f 7269 6361 6c2c 2064  m categorical, d
-0000ff90: 6174 652d 7469 6d65 2061 6e64 204e 4c50  ate-time and NLP
-0000ffa0: 2028 7465 7874 2920 6665 6174 7572 6573   (text) features
-0000ffb0: 2069 6e20 796f 7572 2064 6174 6173 6574   in your dataset
-0000ffc0: 2e20 5468 6973 2074 7261 6e73 666f 726d  . This transform
-0000ffd0: 6572 2070 6970 656c 696e 6520 6973 2066  er pipeline is f
-0000ffe0: 756c 6c79 2073 6369 6b69 742d 6c65 6172  ully scikit-lear
-0000fff0: 6e20 5069 7065 6c69 6e65 2063 6f6d 7061  n Pipeline compa
-00010000: 7469 626c 6520 616e 6420 6361 6e20 6265  tible and can be
-00010010: 2075 7365 6420 746f 2062 7569 6c64 2065   used to build e
-00010020: 7665 6e20 6d6f 7265 2063 6f6d 706c 6578  ven more complex
-00010030: 2070 6970 656c 696e 6573 2062 7920 796f   pipelines by yo
-00010040: 7520 6261 7365 6420 6f6e 2060 6d61 6b65  u based on `make
-00010050: 5f70 6970 656c 696e 6560 2073 7461 7465  _pipeline` state
-00010060: 6d65 6e74 2066 726f 6d20 6073 6b6c 6561  ment from `sklea
-00010070: 726e 2e70 6970 656c 696e 6560 206c 6962  rn.pipeline` lib
-00010080: 7261 7279 2e20 3c61 2068 7265 663d 2268  rary. <a href="h
-00010090: 7474 7073 3a2f 2f67 6974 6875 622e 636f  ttps://github.co
-000100a0: 6d2f 4175 746f 5669 4d4c 2f6c 617a 7974  m/AutoViML/lazyt
-000100b0: 7261 6e73 666f 726d 2f62 6c6f 622f 6d61  ransform/blob/ma
-000100c0: 696e 2f46 6561 7475 7265 7769 7a5f 4c61  in/Featurewiz_La
-000100d0: 7a79 5472 616e 7366 6f72 6d5f 4465 6d6f  zyTransform_Demo
-000100e0: 312e 6970 796e 6222 3e4c 6574 2075 7320  1.ipynb">Let us 
-000100f0: 7365 6520 616e 2065 7861 6d70 6c65 3c2f  see an example</
-00010100: 613e 3a3c 703e 0a20 2020 2020 2020 200a  a>:<p>.        .
-00010110: 2020 2020 2020 2020 3c61 2068 7265 663d          <a href=
-00010120: 2268 7474 7073 3a2f 2f69 6262 2e63 6f2f  "https://ibb.co/
-00010130: 7866 4d51 6e4e 7a22 3e3c 696d 6720 7372  xfMQnNz"><img sr
-00010140: 633d 2268 7474 7073 3a2f 2f69 2e69 6262  c="https://i.ibb
-00010150: 2e63 6f2f 5a59 6843 5130 632f 6c61 7a79  .co/ZYhCQ0c/lazy
-00010160: 2d63 6f64 6531 2e70 6e67 2220 616c 743d  -code1.png" alt=
-00010170: 226c 617a 792d 636f 6465 3122 2062 6f72  "lazy-code1" bor
-00010180: 6465 723d 2230 223e 3c2f 613e 0a20 2020  der="0"></a>.   
-00010190: 2020 2020 200a 2020 2020 2020 2020 2323       .        ##
-000101a0: 2320 322e 2020 5573 696e 6720 6c61 7a79  # 2.  Using lazy
-000101b0: 7472 616e 7366 6f72 6d20 6173 2061 2073  transform as a s
-000101c0: 6b6c 6561 726e 2070 6970 656c 696e 6520  klearn pipeline 
-000101d0: 7769 7468 2073 6b6c 6561 726e 206d 6f64  with sklearn mod
-000101e0: 656c 7320 6f72 2058 4742 6f6f 7374 206f  els or XGBoost o
-000101f0: 7220 4c69 6768 7447 424d 206d 6f64 656c  r LightGBM model
-00010200: 730a 2020 2020 2020 2020 0a20 2020 2020  s.        .     
-00010210: 2020 203c 703e 5468 6520 7365 636f 6e64     <p>The second
-00010220: 206d 6574 686f 6420 6973 2061 2067 7265   method is a gre
-00010230: 6174 2077 6179 2074 6f20 6372 6561 7465  at way to create
-00010240: 2061 6e20 656e 7469 7265 2064 6174 6120   an entire data 
-00010250: 7472 616e 7366 6f72 6d20 616e 6420 6d6f  transform and mo
-00010260: 6465 6c20 7472 6169 6e69 6e67 2070 6970  del training pip
-00010270: 656c 696e 6520 7769 7468 2061 6273 6f6c  eline with absol
-00010280: 7574 656c 7920 6e6f 2064 6174 6120 6c65  utely no data le
-00010290: 616b 6167 652e 2060 6c61 7a79 7472 616e  akage. `lazytran
-000102a0: 7366 6f72 6d60 2061 6c6c 6f77 7320 796f  sform` allows yo
-000102b0: 7520 746f 2073 656e 6420 696e 2061 206d  u to send in a m
-000102c0: 6f64 656c 206f 626a 6563 7420 286f 6e6c  odel object (onl
-000102d0: 7920 7468 6520 666f 6c6c 6f77 696e 6720  y the following 
-000102e0: 6172 6520 7375 7070 6f72 7465 6429 2061  are supported) a
-000102f0: 6e64 2069 7420 7769 6c6c 2061 7574 6f6d  nd it will autom
-00010300: 6174 6963 616c 6c79 2074 7261 6e73 666f  atically transfo
-00010310: 726d 2c20 6372 6561 7465 206e 6577 2066  rm, create new f
-00010320: 6561 7475 7265 7320 616e 6420 7472 6169  eatures and trai
-00010330: 6e20 6120 6d6f 6465 6c20 7573 696e 6720  n a model using 
-00010340: 736b 6c65 6172 6e20 7069 7065 6c69 6e65  sklearn pipeline
-00010350: 732e 203c 6120 6872 6566 3d22 6874 7470  s. <a href="http
-00010360: 733a 2f2f 6769 7468 7562 2e63 6f6d 2f41  s://github.com/A
-00010370: 7574 6f56 694d 4c2f 6c61 7a79 7472 616e  utoViML/lazytran
-00010380: 7366 6f72 6d2f 626c 6f62 2f6d 6169 6e2f  sform/blob/main/
-00010390: 4665 6174 7572 6577 697a 5f4c 617a 7954  Featurewiz_LazyT
-000103a0: 7261 6e73 666f 726d 5f44 656d 6f32 2e69  ransform_Demo2.i
-000103b0: 7079 6e62 223e 5468 6973 206d 6574 686f  pynb">This metho
-000103c0: 6420 6361 6e20 6265 2073 6565 6e20 6173  d can be seen as
-000103d0: 2066 6f6c 6c6f 7773 3c2f 613e 3a3c 6272   follows</a>:<br
-000103e0: 3e0a 2020 2020 2020 2020 0a20 2020 2020  >.        .     
-000103f0: 2020 203c 6120 6872 6566 3d22 6874 7470     <a href="http
-00010400: 733a 2f2f 6962 622e 636f 2f54 3157 4e68  s://ibb.co/T1WNh
-00010410: 7a54 223e 3c69 6d67 2073 7263 3d22 6874  zT"><img src="ht
-00010420: 7470 733a 2f2f 692e 6962 622e 636f 2f30  tps://i.ibb.co/0
-00010430: 4b73 7a4a 5058 2f6c 617a 792d 636f 6465  KszJPX/lazy-code
-00010440: 322e 706e 6722 2061 6c74 3d22 6c61 7a79  2.png" alt="lazy
-00010450: 2d63 6f64 6532 2220 626f 7264 6572 3d22  -code2" border="
-00010460: 3022 3e3c 2f61 3e0a 2020 2020 2020 2020  0"></a>.        
-00010470: 0a20 2020 2020 2020 2023 2323 2033 2e20  .        ### 3. 
-00010480: 2055 7369 6e67 206c 617a 7974 7261 6e73   Using lazytrans
-00010490: 666f 726d 2069 6e20 4772 6964 5365 6172  form in GridSear
-000104a0: 6368 4356 2074 6f20 6669 6e64 2074 6865  chCV to find the
-000104b0: 2062 6573 7420 6d6f 6465 6c20 7069 7065   best model pipe
-000104c0: 6c69 6e65 0a20 2020 2020 2020 203c 703e  line.        <p>
-000104d0: 5468 6520 7468 6972 6420 6d65 7468 6f64  The third method
-000104e0: 2069 7320 6120 6772 6561 7420 7761 7920   is a great way 
-000104f0: 746f 2066 696e 6420 7468 6520 6265 7374  to find the best
-00010500: 2064 6174 6120 7472 616e 7366 6f72 6d61   data transforma
-00010510: 7469 6f6e 2061 6e64 206d 6f64 656c 2074  tion and model t
-00010520: 7261 696e 696e 6720 7069 7065 6c69 6e65  raining pipeline
-00010530: 2075 7369 6e67 2047 7269 6453 6561 7263   using GridSearc
-00010540: 6843 5620 6f72 2052 616e 646f 6d69 7a65  hCV or Randomize
-00010550: 6453 6561 7263 6843 5620 616c 6f6e 6720  dSearchCV along 
-00010560: 7769 7468 2061 204c 6967 6874 4742 4d20  with a LightGBM 
-00010570: 6f72 2058 4742 6f6f 7374 206f 7220 7363  or XGBoost or sc
-00010580: 696b 6974 2d6c 6561 726e 206d 6f64 656c  ikit-learn model
-00010590: 2e20 5468 6973 2069 7320 6578 706c 6169  . This is explai
-000105a0: 6e65 6420 7665 7279 2063 6c65 6172 6c79  ned very clearly
-000105b0: 2069 6e20 7468 6520 3c61 2068 7265 663d   in the <a href=
-000105c0: 2268 7474 7073 3a2f 2f67 6974 6875 622e  "https://github.
-000105d0: 636f 6d2f 4175 746f 5669 4d4c 2f6c 617a  com/AutoViML/laz
-000105e0: 7974 7261 6e73 666f 726d 2f62 6c6f 622f  ytransform/blob/
-000105f0: 6d61 696e 2f4c 617a 7954 7261 6e73 666f  main/LazyTransfo
-00010600: 726d 6572 5f77 6974 685f 4772 6964 5365  rmer_with_GridSe
-00010610: 6172 6368 5f50 6970 656c 696e 652e 6970  arch_Pipeline.ip
-00010620: 796e 6222 3e4c 617a 7954 7261 6e73 666f  ynb">LazyTransfo
-00010630: 726d 6572 5f77 6974 685f 4772 6964 5365  rmer_with_GridSe
-00010640: 6172 6368 5f50 6970 656c 696e 652e 6970  arch_Pipeline.ip
-00010650: 796e 623c 2f61 3e20 6e6f 7465 626f 6f6b  ynb</a> notebook
-00010660: 2069 6e20 7468 6520 7361 6d65 2067 6974   in the same git
-00010670: 6875 6220 6865 7265 2e20 4d61 6b65 2073  hub here. Make s
-00010680: 7572 6520 796f 7520 6368 6563 6b20 6974  ure you check it
-00010690: 206f 7574 210a 2020 2020 2020 2020 0a20   out!.        . 
-000106a0: 2020 2020 2020 203c 6120 6872 6566 3d22         <a href="
-000106b0: 6874 7470 733a 2f2f 6962 622e 636f 2f57  https://ibb.co/W
-000106c0: 4776 6e71 6a73 223e 3c69 6d67 2073 7263  Gvnqjs"><img src
-000106d0: 3d22 6874 7470 733a 2f2f 692e 6962 622e  ="https://i.ibb.
-000106e0: 636f 2f78 5871 6850 6433 2f6c 617a 792d  co/xXqhPd3/lazy-
-000106f0: 6772 6964 7365 6172 6368 2e70 6e67 2220  gridsearch.png" 
-00010700: 616c 743d 226c 617a 792d 6772 6964 7365  alt="lazy-gridse
-00010710: 6172 6368 2220 626f 7264 6572 3d22 3022  arch" border="0"
-00010720: 3e3c 2f61 3e3c 6272 202f 3e0a 2020 2020  ></a><br />.    
-00010730: 2020 2020 0a20 2020 2020 2020 203c 703e      .        <p>
-00010740: 0a20 2020 2020 2020 2054 6865 2066 6f6c  .        The fol
-00010750: 6c6f 7769 6e67 206d 6f64 656c 7320 6172  lowing models ar
-00010760: 6520 6375 7272 656e 746c 7920 7375 7070  e currently supp
-00010770: 6f72 7465 643a 0a20 2020 2020 2020 203c  orted:.        <
-00010780: 6f6c 3e0a 2020 2020 2020 2020 3c6c 693e  ol>.        <li>
-00010790: 416c 6c20 736b 6c65 6172 6e20 6d6f 6465  All sklearn mode
-000107a0: 6c73 3c2f 6c69 3e0a 2020 2020 2020 2020  ls</li>.        
-000107b0: 3c6c 693e 416c 6c20 4d75 6c74 694f 7574  <li>All MultiOut
-000107c0: 7075 7420 6d6f 6465 6c73 2066 726f 6d20  put models from 
-000107d0: 736b 6c65 6172 6e2e 6d75 6c74 696f 7574  sklearn.multiout
-000107e0: 7075 7420 6c69 6272 6172 793c 2f6c 693e  put library</li>
-000107f0: 0a20 2020 2020 2020 203c 6c69 3e58 4762  .        <li>XGb
-00010800: 6f6f 7374 206d 6f64 656c 733c 2f6c 693e  oost models</li>
-00010810: 0a20 2020 2020 2020 203c 6c69 3e4c 6967  .        <li>Lig
-00010820: 6874 4742 4d20 6d6f 6465 6c73 3c2f 6c69  htGBM models</li
-00010830: 3e0a 2020 2020 2020 2020 3c2f 6f6c 3e0a  >.        </ol>.
-00010840: 2020 2020 2020 2020 486f 7765 7665 722c          However,
-00010850: 2079 6f75 206d 7573 7420 696e 7374 616c   you must instal
-00010860: 6c20 616e 6420 696d 706f 7274 2074 686f  l and import tho
-00010870: 7365 206d 6f64 656c 7320 6f6e 2079 6f75  se models on you
-00010880: 7220 6f77 6e20 616e 6420 6465 6669 6e65  r own and define
-00010890: 2074 6865 6d20 6173 206d 6f64 656c 2076   them as model v
-000108a0: 6172 6961 626c 6573 2062 6566 6f72 6520  ariables before 
-000108b0: 7061 7373 696e 6720 7468 6f73 6520 7661  passing those va
-000108c0: 7269 6162 6c65 7320 746f 206c 617a 7974  riables to lazyt
-000108d0: 7261 6e73 666f 726d 2e0a 2020 2020 2020  ransform..      
-000108e0: 2020 0a20 2020 2020 2020 2023 2320 496e    .        ## In
-000108f0: 7374 616c 6c0a 2020 2020 2020 2020 3c70  stall.        <p
-00010900: 3e0a 2020 2020 2020 2020 0a20 2020 2020  >.        .     
-00010910: 2020 202a 2a50 7265 7265 7175 7369 7465     **Prerequsite
-00010920: 733a 2a2a 0a20 2020 2020 2020 203c 6f6c  s:**.        <ol
-00010930: 3e0a 2020 2020 2020 2020 3c6c 693e 3c62  >.        <li><b
-00010940: 3e6c 617a 7974 7261 6e73 666f 726d 2069  >lazytransform i
-00010950: 7320 6275 696c 7420 7573 696e 6720 7061  s built using pa
-00010960: 6e64 6173 2c20 6e75 6d70 792c 2073 6369  ndas, numpy, sci
-00010970: 6b69 742d 6c65 6172 6e2c 2063 6174 6567  kit-learn, categ
-00010980: 6f72 795f 656e 636f 6465 7273 2061 6e64  ory_encoders and
-00010990: 2069 6d62 616c 616e 6365 642d 6c65 6172   imbalanced-lear
-000109a0: 6e20 6c69 6272 6172 6965 732e 3c2f 623e  n libraries.</b>
-000109b0: 2049 7420 7368 6f75 6c64 2072 756e 206f   It should run o
-000109c0: 6e20 6d6f 7374 2050 7974 686f 6e33 2041  n most Python3 A
-000109d0: 6e61 636f 6e64 6120 696e 7374 616c 6c61  naconda installa
-000109e0: 7469 6f6e 7320 7769 7468 6f75 7420 6164  tions without ad
-000109f0: 6469 7469 6f6e 616c 2069 6e73 7461 6c6c  ditional install
-00010a00: 732e 2059 6f75 2077 6f6e 2774 2068 6176  s. You won't hav
-00010a10: 6520 746f 2069 6d70 6f72 7420 616e 7920  e to import any 
-00010a20: 7370 6563 6961 6c20 6c69 6272 6172 6965  special librarie
-00010a30: 7320 6f74 6865 7220 7468 616e 2022 696d  s other than "im
-00010a40: 6261 6c61 6e63 6564 2d6c 6561 726e 2220  balanced-learn" 
-00010a50: 616e 6420 2263 6174 6567 6f72 795f 656e  and "category_en
-00010a60: 636f 6465 7273 222e 3c2f 6c69 3e0a 2020  coders".</li>.  
-00010a70: 2020 2020 2020 3c2f 6f6c 3e0a 2020 2020        </ol>.    
-00010a80: 2020 2020 5468 6520 6265 7374 206d 6574      The best met
-00010a90: 686f 6420 746f 2069 6e73 7461 6c6c 206c  hod to install l
-00010aa0: 617a 7974 7261 6e73 666f 726d 2069 7320  azytransform is 
-00010ab0: 746f 2075 7365 2063 6f6e 6461 3a3c 703e  to use conda:<p>
-00010ac0: 0a20 2020 2020 2020 200a 2020 2020 2020  .        .      
-00010ad0: 2020 6060 600a 2020 2020 2020 2020 636f    ```.        co
-00010ae0: 6e64 6120 696e 7374 616c 6c20 2d63 2063  nda install -c c
-00010af0: 6f6e 6461 2d66 6f72 6765 206c 617a 7974  onda-forge lazyt
-00010b00: 7261 6e73 666f 726d 0a20 2020 2020 2020  ransform.       
-00010b10: 2060 6060 0a20 2020 2020 2020 203c 6120   ```.        <a 
-00010b20: 6872 6566 3d22 6874 7470 733a 2f2f 6962  href="https://ib
-00010b30: 622e 636f 2f66 586e 6250 6436 223e 3c69  b.co/fXnbPd6"><i
-00010b40: 6d67 2073 7263 3d22 6874 7470 733a 2f2f  mg src="https://
-00010b50: 692e 6962 622e 636f 2f71 4457 7a50 5971  i.ibb.co/qDWzPYq
-00010b60: 2f63 6f6e 6461 2d69 6e73 7461 6c6c 2e70  /conda-install.p
-00010b70: 6e67 2220 616c 743d 2263 6f6e 6461 2d69  ng" alt="conda-i
-00010b80: 6e73 7461 6c6c 2220 626f 7264 6572 3d22  nstall" border="
-00010b90: 3022 3e3c 2f61 3e3c 6272 3e0a 2020 2020  0"></a><br>.    
-00010ba0: 2020 2020 5468 6520 7365 636f 6e64 2062      The second b
-00010bb0: 6573 7420 696e 7374 616c 6c61 7469 6f6e  est installation
-00010bc0: 206d 6574 686f 6420 6973 2074 6f20 7573   method is to us
-00010bd0: 6520 2270 6970 2069 6e73 7461 6c6c 222e  e "pip install".
-00010be0: 0a20 2020 2020 2020 200a 2020 2020 2020  .        .      
-00010bf0: 2020 6060 600a 2020 2020 2020 2020 7069    ```.        pi
-00010c00: 7020 696e 7374 616c 6c20 6c61 7a79 7472  p install lazytr
-00010c10: 616e 7366 6f72 6d20 0a20 2020 2020 2020  ansform .       
-00010c20: 2060 6060 0a20 2020 2020 2020 2041 6c65   ```.        Ale
-00010c30: 7274 2120 5768 656e 2075 7369 6e67 2043  rt! When using C
-00010c40: 6f6c 6162 206f 7220 4b61 6767 6c65 204e  olab or Kaggle N
-00010c50: 6f74 6562 6f6f 6b73 2c20 796f 7520 6d75  otebooks, you mu
-00010c60: 7374 2075 7365 2061 2073 6c69 6768 746c  st use a slightl
-00010c70: 7920 6d6f 6469 6679 2069 6e73 7461 6c6c  y modify install
-00010c80: 6174 696f 6e20 7072 6f63 6573 7320 6265  ation process be
-00010c90: 6c6f 772e 2049 6620 796f 7520 646f 6e27  low. If you don'
-00010ca0: 7420 646f 2074 6869 732c 2079 6f75 2077  t do this, you w
-00010cb0: 696c 6c20 6765 7420 7765 6972 6420 6572  ill get weird er
-00010cc0: 726f 7273 2069 6e20 7468 6f73 6520 706c  rors in those pl
-00010cd0: 6174 666f 726d 7321 0a20 2020 2020 2020  atforms!.       
-00010ce0: 200a 2020 2020 2020 2020 6060 600a 2020   .        ```.  
-00010cf0: 2020 2020 2020 7069 7020 696e 7374 616c        pip instal
-00010d00: 6c20 6c61 7a79 7472 616e 7366 6f72 6d20  l lazytransform 
-00010d10: 2d2d 6967 6e6f 7265 2d69 6e73 7461 6c6c  --ignore-install
-00010d20: 6564 202d 2d6e 6f2d 6465 7073 0a20 2020  ed --no-deps.   
-00010d30: 2020 2020 2070 6970 2069 6e73 7461 6c6c       pip install
-00010d40: 2063 6174 6567 6f72 792d 656e 636f 6465   category-encode
-00010d50: 7273 202d 2d69 676e 6f72 652d 696e 7374  rs --ignore-inst
-00010d60: 616c 6c65 6420 2d2d 6e6f 2d64 6570 730a  alled --no-deps.
-00010d70: 2020 2020 2020 2020 0a20 2020 2020 2020          .       
-00010d80: 2060 6060 0a20 2020 2020 2020 200a 2020   ```.        .  
-00010d90: 2020 2020 2020 546f 2069 6e73 7461 6c6c        To install
-00010da0: 2066 726f 6d20 736f 7572 6365 3a0a 2020   from source:.  
-00010db0: 2020 2020 2020 0a20 2020 2020 2020 2060        .        `
-00010dc0: 6060 0a20 2020 2020 2020 2063 6420 3c6c  ``.        cd <l
-00010dd0: 617a 7974 7261 6e73 666f 726d 5f44 6573  azytransform_Des
-00010de0: 7469 6e61 7469 6f6e 3e0a 2020 2020 2020  tination>.      
-00010df0: 2020 6769 7420 636c 6f6e 6520 6769 7440    git clone git@
-00010e00: 6769 7468 7562 2e63 6f6d 3a41 7574 6f56  github.com:AutoV
-00010e10: 694d 4c2f 6c61 7a79 7472 616e 7366 6f72  iML/lazytransfor
-00010e20: 6d2e 6769 740a 2020 2020 2020 2020 6060  m.git.        ``
-00010e30: 600a 2020 2020 2020 2020 6f72 2064 6f77  `.        or dow
-00010e40: 6e6c 6f61 6420 616e 6420 756e 7a69 7020  nload and unzip 
-00010e50: 6874 7470 733a 2f2f 6769 7468 7562 2e63  https://github.c
-00010e60: 6f6d 2f41 7574 6f56 694d 4c2f 6c61 7a79  om/AutoViML/lazy
-00010e70: 7472 616e 7366 6f72 6d2f 6172 6368 6976  transform/archiv
-00010e80: 652f 6d61 7374 6572 2e7a 6970 0a20 2020  e/master.zip.   
-00010e90: 2020 2020 2060 6060 0a20 2020 2020 2020       ```.       
-00010ea0: 2063 6f6e 6461 2063 7265 6174 6520 2d6e   conda create -n
-00010eb0: 203c 796f 7572 5f65 6e76 5f6e 616d 653e   <your_env_name>
-00010ec0: 2070 7974 686f 6e3d 332e 3720 616e 6163   python=3.7 anac
-00010ed0: 6f6e 6461 0a20 2020 2020 2020 2063 6f6e  onda.        con
-00010ee0: 6461 2061 6374 6976 6174 6520 3c79 6f75  da activate <you
-00010ef0: 725f 656e 765f 6e61 6d65 3e20 2320 4f4e  r_env_name> # ON
-00010f00: 2057 494e 444f 5753 3a20 6073 6f75 7263   WINDOWS: `sourc
-00010f10: 6520 6163 7469 7661 7465 203c 796f 7572  e activate <your
-00010f20: 5f65 6e76 5f6e 616d 653e 600a 2020 2020  _env_name>`.    
-00010f30: 2020 2020 6364 206c 617a 7974 7261 6e73      cd lazytrans
-00010f40: 666f 726d 0a20 2020 2020 2020 2070 6970  form.        pip
-00010f50: 2069 6e73 7461 6c6c 202d 7220 7265 7175   install -r requ
-00010f60: 6972 656d 656e 7473 2e74 7874 0a20 2020  irements.txt.   
-00010f70: 2020 2020 2060 6060 0a20 2020 2020 2020       ```.       
-00010f80: 200a 2020 2020 2020 2020 2323 2055 7361   .        ## Usa
-00010f90: 6765 0a20 2020 2020 2020 203c 703e 0a20  ge.        <p>. 
-00010fa0: 2020 2020 2020 2059 6f75 2063 616e 2069         You can i
-00010fb0: 6e76 6f6b 6520 606c 617a 7974 7261 6e73  nvoke `lazytrans
-00010fc0: 666f 726d 6020 6173 2061 2073 6369 6b69  form` as a sciki
-00010fd0: 742d 6c65 6172 6e20 636f 6d70 6174 6962  t-learn compatib
-00010fe0: 6c65 2066 6974 2061 6e64 2074 7261 6e73  le fit and trans
-00010ff0: 666f 726d 206f 7220 6120 6669 7420 616e  form or a fit an
-00011000: 6420 7072 6564 6963 7420 7069 7065 6c69  d predict pipeli
-00011010: 6e65 2e20 5365 6520 7379 6e74 6178 2062  ne. See syntax b
-00011020: 656c 6f77 2e3c 703e 0a20 2020 2020 2020  elow.<p>.       
-00011030: 200a 2020 2020 2020 2020 6060 600a 2020   .        ```.  
-00011040: 2020 2020 2020 6672 6f6d 206c 617a 7974        from lazyt
-00011050: 7261 6e73 666f 726d 2069 6d70 6f72 7420  ransform import 
-00011060: 4c61 7a79 5472 616e 7366 6f72 6d65 720a  LazyTransformer.
-00011070: 2020 2020 2020 2020 6c61 7a79 203d 204c          lazy = L
-00011080: 617a 7954 7261 6e73 666f 726d 6572 286d  azyTransformer(m
-00011090: 6f64 656c 3d4e 6f6e 652c 2065 6e63 6f64  odel=None, encod
-000110a0: 6572 733d 2761 7574 6f27 2c20 7363 616c  ers='auto', scal
-000110b0: 6572 733d 4e6f 6e65 2c20 0a20 2020 2020  ers=None, .     
-000110c0: 2020 2020 2020 2020 2020 2064 6174 655f             date_
-000110d0: 746f 5f73 7472 696e 673d 4661 6c73 652c  to_string=False,
-000110e0: 2074 7261 6e73 666f 726d 5f74 6172 6765   transform_targe
-000110f0: 743d 4661 6c73 652c 2069 6d62 616c 616e  t=False, imbalan
-00011100: 6365 643d 4661 6c73 652c 0a20 2020 2020  ced=False,.     
-00011110: 2020 2020 2020 2020 2020 2063 6f6d 6269             combi
-00011120: 6e65 5f72 6172 653d 4661 6c73 652c 2076  ne_rare=False, v
-00011130: 6572 626f 7365 3d30 290a 2020 2020 2020  erbose=0).      
-00011140: 2020 6060 600a 2020 2020 2020 2020 0a20    ```.        . 
-00011150: 2020 2020 2020 2023 2323 2069 6620 796f         ### if yo
-00011160: 7520 6172 6520 6e6f 7420 7573 696e 6720  u are not using 
-00011170: 6120 6d6f 6465 6c20 696e 2070 6970 656c  a model in pipel
-00011180: 696e 652c 2079 6f75 206d 7573 7420 7573  ine, you must us
-00011190: 6520 6669 7420 616e 6420 7472 616e 7366  e fit and transf
-000111a0: 6f72 6d0a 2020 2020 2020 2020 6060 600a  orm.        ```.
-000111b0: 2020 2020 2020 2020 585f 7472 6169 6e6d          X_trainm
-000111c0: 2c20 795f 7472 6169 6e6d 203d 206c 617a  , y_trainm = laz
-000111d0: 792e 6669 745f 7472 616e 7366 6f72 6d28  y.fit_transform(
-000111e0: 585f 7472 6169 6e2c 2079 5f74 7261 696e  X_train, y_train
-000111f0: 290a 2020 2020 2020 2020 585f 7465 7374  ).        X_test
-00011200: 6d20 3d20 6c61 7a79 2e74 7261 6e73 666f  m = lazy.transfo
-00011210: 726d 2858 5f74 6573 7429 0a20 2020 2020  rm(X_test).     
-00011220: 2020 2060 6060 0a20 2020 2020 2020 2023     ```.        #
-00011230: 2323 2049 6620 796f 7520 6172 6520 7573  ## If you are us
-00011240: 696e 6720 6120 6d6f 6465 6c20 696e 2070  ing a model in p
-00011250: 6970 656c 696e 652c 2075 7365 206d 7573  ipeline, use mus
-00011260: 7420 7573 6520 6669 7420 616e 6420 7072  t use fit and pr
-00011270: 6564 6963 7420 6f6e 6c79 0a20 2020 2020  edict only.     
-00011280: 2020 2060 6060 0a20 2020 2020 2020 206c     ```.        l
-00011290: 617a 7920 3d20 4c61 7a79 5472 616e 7366  azy = LazyTransf
-000112a0: 6f72 6d65 7228 6d6f 6465 6c3d 5261 6e64  ormer(model=Rand
-000112b0: 6f6d 466f 7265 7374 436c 6173 7369 6669  omForestClassifi
-000112c0: 6572 2829 2c20 656e 636f 6465 7273 3d27  er(), encoders='
-000112d0: 6175 746f 272c 2073 6361 6c65 7273 3d4e  auto', scalers=N
-000112e0: 6f6e 652c 200a 2020 2020 2020 2020 2020  one, .          
-000112f0: 2020 2020 2020 6461 7465 5f74 6f5f 7374        date_to_st
-00011300: 7269 6e67 3d46 616c 7365 2c20 7472 616e  ring=False, tran
-00011310: 7366 6f72 6d5f 7461 7267 6574 3d46 616c  sform_target=Fal
-00011320: 7365 2c20 696d 6261 6c61 6e63 6564 3d46  se, imbalanced=F
-00011330: 616c 7365 2c0a 2020 2020 2020 2020 2020  alse,.          
-00011340: 2020 2020 2020 636f 6d62 696e 655f 7261        combine_ra
-00011350: 7265 3d46 616c 7365 2c20 7665 7262 6f73  re=False, verbos
-00011360: 653d 3029 0a20 2020 2020 2020 2060 6060  e=0).        ```
-00011370: 0a20 2020 2020 2020 200a 2020 2020 2020  .        .      
-00011380: 2020 6060 600a 2020 2020 2020 2020 6c61    ```.        la
-00011390: 7a79 2e66 6974 2858 5f74 7261 696e 2c20  zy.fit(X_train, 
-000113a0: 795f 7472 6169 6e29 0a20 2020 2020 2020  y_train).       
-000113b0: 206c 617a 792e 7072 6564 6963 7428 585f   lazy.predict(X_
-000113c0: 7465 7374 290a 2020 2020 2020 2020 6060  test).        ``
-000113d0: 600a 2020 2020 2020 2020 0a20 2020 2020  `.        .     
-000113e0: 2020 2023 2320 4150 490a 2020 2020 2020     ## API.      
-000113f0: 2020 0a20 2020 2020 2020 203c 703e 0a20    .        <p>. 
-00011400: 2020 2020 2020 206c 617a 7974 7261 6e73         lazytrans
-00011410: 666f 726d 2068 6173 2061 2076 6572 7920  form has a very 
-00011420: 7369 6d70 6c65 2041 5049 2077 6974 6820  simple API with 
-00011430: 7468 6520 666f 6c6c 6f77 696e 6720 696e  the following in
-00011440: 7075 7473 2e20 596f 7520 6e65 6564 2074  puts. You need t
-00011450: 6f20 6372 6561 7465 2061 2073 6b6c 6561  o create a sklea
-00011460: 726e 2d63 6f6d 7061 7469 626c 6520 7472  rn-compatible tr
-00011470: 616e 7366 6f72 6d65 7220 7069 7065 6c69  ansformer pipeli
-00011480: 6e65 206f 626a 6563 7420 6279 2069 6d70  ne object by imp
-00011490: 6f72 7469 6e67 204c 617a 7954 7261 6e73  orting LazyTrans
-000114a0: 666f 726d 6572 2066 726f 6d20 6c61 7a79  former from lazy
-000114b0: 7472 616e 7366 6f72 6d20 6c69 6272 6172  transform librar
-000114c0: 792e 203c 703e 0a20 2020 2020 2020 204f  y. <p>.        O
-000114d0: 6e63 6520 796f 7520 696d 706f 7274 2069  nce you import i
-000114e0: 742c 2079 6f75 2063 616e 2064 6566 696e  t, you can defin
-000114f0: 6520 7468 6520 6f62 6a65 6374 2062 7920  e the object by 
-00011500: 6769 7669 6e67 2073 6576 6572 616c 206f  giving several o
-00011510: 7074 696f 6e73 2073 7563 6820 6173 3a0a  ptions such as:.
-00011520: 2020 2020 2020 2020 0a20 2020 2020 2020          .       
-00011530: 202a 2a41 7267 756d 656e 7473 2a2a 0a20   **Arguments**. 
-00011540: 2020 2020 2020 200a 2020 2020 2020 2020         .        
-00011550: 3c62 3e43 6175 7469 6f6e 3a3c 2f62 3e20  <b>Caution:</b> 
-00011560: 585f 7472 6169 6e20 616e 6420 795f 7472  X_train and y_tr
-00011570: 6169 6e20 6d75 7374 2062 6520 7061 6e64  ain must be pand
-00011580: 6173 2044 6174 6166 7261 6d65 7320 6f72  as Dataframes or
-00011590: 2070 616e 6461 7320 5365 7269 6573 2e20   pandas Series. 
-000115a0: 444f 204e 4f54 2073 656e 6420 696e 206e  DO NOT send in n
-000115b0: 756d 7079 2061 7272 6179 732e 2054 6865  umpy arrays. The
-000115c0: 7920 776f 6e27 7420 776f 726b 2e0a 2020  y won't work..  
-000115d0: 2020 2020 2020 0a20 2020 2020 2020 202d        .        -
-000115e0: 2060 6d6f 6465 6c60 3a20 6465 6661 756c   `model`: defaul
-000115f0: 7420 6973 204e 6f6e 652e 204f 7220 6974  t is None. Or it
-00011600: 2063 6f75 6c64 2062 6520 616e 7920 7363   could be any sc
-00011610: 696b 6974 2d6c 6561 726e 206d 6f64 656c  ikit-learn model
-00011620: 2028 696e 636c 7564 696e 6720 6d75 6c74   (including mult
-00011630: 696f 7574 7075 7420 6d6f 6465 6c73 2920  ioutput models) 
-00011640: 6173 2077 656c 6c20 6173 2074 6865 2070  as well as the p
-00011650: 6f70 756c 6172 2058 4742 6f6f 7374 2061  opular XGBoost a
-00011660: 6e64 204c 6967 6874 4742 4d20 6c69 6272  nd LightGBM libr
-00011670: 6172 6965 732e 2059 6f75 206e 6565 6420  aries. You need 
-00011680: 746f 2069 6e73 7461 6c6c 2074 686f 7365  to install those
-00011690: 206c 6962 7261 7269 6573 2069 6620 796f   libraries if yo
-000116a0: 7520 7761 6e74 2074 6f20 7573 6520 7468  u want to use th
-000116b0: 656d 2e0a 2020 2020 2020 2020 2d20 6065  em..        - `e
-000116c0: 6e63 6f64 6572 7360 3a20 636f 756c 6420  ncoders`: could 
-000116d0: 6265 206f 6e65 206d 6f72 6520 656e 636f  be one more enco
-000116e0: 6465 7273 2069 6e20 6120 7374 7269 6e67  ders in a string
-000116f0: 206f 7220 6120 6c69 7374 2e20 4561 6368   or a list. Each
-00011700: 2065 6e63 6f64 6572 2073 7472 696e 6720   encoder string 
-00011710: 6361 6e20 6265 2061 6e79 206f 6e65 206f  can be any one o
-00011720: 6620 7468 6520 3130 2b20 656e 636f 6465  f the 10+ encode
-00011730: 7273 2066 726f 6d20 6063 6174 6567 6f72  rs from `categor
-00011740: 795f 656e 636f 6465 7273 6020 6c69 6272  y_encoders` libr
-00011750: 6172 7920 6265 6c6f 772e 2020 4176 6169  ary below.  Avai
-00011760: 6c61 626c 6520 656e 636f 6465 7273 2061  lable encoders a
-00011770: 7265 206c 6973 7465 6420 6865 7265 2061  re listed here a
-00011780: 7320 7374 7269 6e67 7320 736f 2074 6861  s strings so tha
-00011790: 7420 796f 7520 6361 6e20 696e 7075 7420  t you can input 
-000117a0: 7468 656d 2069 6e20 6c61 7a79 7472 616e  them in lazytran
-000117b0: 7366 6f72 6d3a 0a20 2020 2020 2020 2020  sform:.         
-000117c0: 202d 2060 6175 746f 6020 2d20 4974 2075   - `auto` - It u
-000117d0: 7365 7320 606f 6e65 686f 7460 2065 6e63  ses `onehot` enc
-000117e0: 6f64 696e 6720 666f 7220 6c6f 772d 6361  oding for low-ca
-000117f0: 7264 696e 616c 6974 7920 7661 7269 6162  rdinality variab
-00011800: 6c65 7320 616e 6420 606c 6162 656c 6020  les and `label` 
-00011810: 656e 636f 6469 6e67 2066 6f72 2068 6967  encoding for hig
-00011820: 6820 6361 7264 696e 616c 6974 7920 7661  h cardinality va
-00011830: 7269 6162 6c65 732e 0a20 2020 2020 2020  riables..       
-00011840: 2020 202d 2060 6f6e 6568 6f74 6020 2d20     - `onehot` - 
-00011850: 4f6e 6520 486f 7420 656e 636f 6469 6e67  One Hot encoding
-00011860: 202d 2069 7420 7769 6c6c 2062 6520 7573   - it will be us
-00011870: 6564 2066 6f72 2061 6c6c 2063 6174 6567  ed for all categ
-00011880: 6f72 6963 616c 2066 6561 7475 7265 7320  orical features 
-00011890: 6972 7265 7370 6563 7469 7665 206f 6620  irrespective of 
-000118a0: 6361 7264 696e 616c 6974 790a 2020 2020  cardinality.    
-000118b0: 2020 2020 2020 2d20 606c 6162 656c 6020        - `label` 
-000118c0: 2d20 4c61 6265 6c20 456e 636f 6469 6e67  - Label Encoding
-000118d0: 202d 2069 7420 7769 6c6c 2062 6520 7573   - it will be us
-000118e0: 6564 2066 6f72 2061 6c6c 2063 6174 6567  ed for all categ
-000118f0: 6f72 6963 616c 2066 6561 7475 7265 7320  orical features 
-00011900: 6972 7265 7370 6563 7469 7665 206f 6620  irrespective of 
-00011910: 6361 7264 696e 616c 6974 790a 2020 2020  cardinality.    
-00011920: 2020 2020 2020 2d20 6068 6173 6869 6e67        - `hashing
-00011930: 6020 6f72 2060 6861 7368 6020 2d20 4861  ` or `hash` - Ha
-00011940: 7368 696e 6720 286f 7220 4861 7368 2920  shing (or Hash) 
-00011950: 456e 636f 6469 6e67 202d 2077 696c 6c20  Encoding - will 
-00011960: 6265 2075 7365 6420 666f 7220 616c 6c20  be used for all 
-00011970: 6361 7465 676f 7269 6361 6c20 7661 7269  categorical vari
-00011980: 6162 6c65 730a 2020 2020 2020 2020 2020  ables.          
-00011990: 2d20 6068 656c 6d65 7274 6020 2d20 4865  - `helmert` - He
-000119a0: 6c6d 6572 7420 456e 636f 6469 6e67 202d  lmert Encoding -
-000119b0: 2077 696c 6c20 6265 2075 7365 6420 666f   will be used fo
-000119c0: 7220 616c 6c20 6361 7465 676f 7269 6361  r all categorica
-000119d0: 6c20 7661 7269 6162 6c65 730a 2020 2020  l variables.    
-000119e0: 2020 2020 2020 2d20 6062 6463 6020 2d20        - `bdc` - 
-000119f0: 4244 4320 456e 636f 6469 6e67 202d 2077  BDC Encoding - w
-00011a00: 696c 6c20 6265 2075 7365 6420 666f 7220  ill be used for 
-00011a10: 616c 6c20 6361 7465 676f 7269 6361 6c20  all categorical 
-00011a20: 7661 7269 6162 6c65 730a 2020 2020 2020  variables.      
-00011a30: 2020 2020 2d20 6073 756d 6020 2d20 5375      - `sum` - Su
-00011a40: 6d20 456e 636f 6469 6e67 202d 2077 696c  m Encoding - wil
-00011a50: 6c20 6265 2075 7365 6420 666f 7220 616c  l be used for al
-00011a60: 6c20 6361 7465 676f 7269 6361 6c20 7661  l categorical va
-00011a70: 7269 6162 6c65 730a 2020 2020 2020 2020  riables.        
-00011a80: 2020 2d20 606c 6f6f 6020 2d20 4c65 6176    - `loo` - Leav
-00011a90: 6520 6f6e 6520 6f75 7420 456e 636f 6469  e one out Encodi
-00011aa0: 6e67 202d 2077 696c 6c20 6265 2075 7365  ng - will be use
-00011ab0: 6420 666f 7220 616c 6c20 6361 7465 676f  d for all catego
-00011ac0: 7269 6361 6c20 7661 7269 6162 6c65 730a  rical variables.
-00011ad0: 2020 2020 2020 2020 2020 2d20 6062 6173            - `bas
-00011ae0: 6560 202d 2042 6173 6520 656e 636f 6469  e` - Base encodi
-00011af0: 6e67 202d 2077 696c 6c20 6265 2075 7365  ng - will be use
-00011b00: 6420 666f 7220 616c 6c20 6361 7465 676f  d for all catego
-00011b10: 7269 6361 6c20 7661 7269 6162 6c65 730a  rical variables.
-00011b20: 2020 2020 2020 2020 2020 2d20 6077 6f65            - `woe
-00011b30: 6020 2d20 5765 6967 6874 206f 6620 4576  ` - Weight of Ev
-00011b40: 6964 656e 6365 2045 6e63 6f64 696e 6720  idence Encoding 
-00011b50: 2d20 7769 6c6c 2062 6520 7573 6564 2066  - will be used f
-00011b60: 6f72 2061 6c6c 2063 6174 6567 6f72 6963  or all categoric
-00011b70: 616c 2076 6172 6961 626c 6573 0a20 2020  al variables.   
-00011b80: 2020 2020 2020 202d 2060 6a61 6d65 7360         - `james`
-00011b90: 202d 204a 616d 6573 2045 6e63 6f64 696e   - James Encodin
-00011ba0: 6720 2d20 7769 6c6c 2062 6520 7573 6564  g - will be used
-00011bb0: 2066 6f72 2061 6c6c 2063 6174 6567 6f72   for all categor
-00011bc0: 6963 616c 2076 6172 6961 626c 6573 0a20  ical variables. 
-00011bd0: 2020 2020 2020 2020 202d 2060 7461 7267           - `targ
-00011be0: 6574 6020 2d20 5461 7267 6574 2045 6e63  et` - Target Enc
-00011bf0: 6f64 696e 6720 2d20 7769 6c6c 2062 6520  oding - will be 
-00011c00: 7573 6564 2066 6f72 2061 6c6c 2063 6174  used for all cat
-00011c10: 6567 6f72 6963 616c 2076 6172 6961 626c  egorical variabl
-00011c20: 6573 0a20 2020 2020 2020 2020 202d 2060  es.          - `
-00011c30: 636f 756e 7460 202d 2043 6f75 6e74 2045  count` - Count E
-00011c40: 6e63 6f64 696e 6720 2d20 7769 6c6c 2062  ncoding - will b
-00011c50: 6520 7573 6564 2066 6f72 2061 6c6c 2063  e used for all c
-00011c60: 6174 6567 6f72 6963 616c 2076 6172 6961  ategorical varia
-00011c70: 626c 6573 0a20 2020 2020 2020 2020 202d  bles.          -
-00011c80: 2060 676c 6d60 2c60 676c 6d6d 6020 2d20   `glm`,`glmm` - 
-00011c90: 4765 6e65 7261 6c69 7a65 6420 4c69 6e65  Generalized Line
-00011ca0: 6172 204d 6f64 656c 2045 6e63 6f64 696e  ar Model Encodin
-00011cb0: 670a 2020 2020 2020 2020 2d20 4865 7265  g.        - Here
-00011cc0: 2069 7320 6120 6465 7363 7269 7074 696f   is a descriptio
-00011cd0: 6e20 6f66 2076 6172 696f 7573 2065 6e63  n of various enc
-00011ce0: 6f64 6572 7320 616e 6420 7468 6569 7220  oders and their 
-00011cf0: 7573 6573 2066 726f 6d20 7468 6520 6578  uses from the ex
-00011d00: 6365 6c6c 656e 7420 3c61 2068 7265 663d  cellent <a href=
-00011d10: 2268 7474 7073 3a2f 2f63 6f6e 7472 6962  "https://contrib
-00011d20: 2e73 6369 6b69 742d 6c65 6172 6e2e 6f72  .scikit-learn.or
-00011d30: 672f 6361 7465 676f 7279 5f65 6e63 6f64  g/category_encod
-00011d40: 6572 732f 223e 2063 6174 6567 6f72 795f  ers/"> category_
-00011d50: 656e 636f 6465 7273 3c2f 613e 2070 7974  encoders</a> pyt
-00011d60: 686f 6e20 6c69 6272 6172 793a 3c62 723e  hon library:<br>
-00011d70: 0a20 2020 2020 2020 2020 2020 202d 2060  .            - `
-00011d80: 4861 7368 696e 6745 6e63 6f64 6572 603a  HashingEncoder`:
-00011d90: 2048 6173 6869 6e67 456e 636f 6465 7220   HashingEncoder 
-00011da0: 6973 2061 206d 756c 7469 7661 7269 6174  is a multivariat
-00011db0: 6520 6861 7368 696e 6720 696d 706c 656d  e hashing implem
-00011dc0: 656e 7461 7469 6f6e 2077 6974 6820 636f  entation with co
-00011dd0: 6e66 6967 7572 6162 6c65 2064 696d 656e  nfigurable dimen
-00011de0: 7369 6f6e 616c 6974 792f 7072 6563 6973  sionality/precis
-00011df0: 696f 6e2e 2054 6865 2061 6476 616e 7461  ion. The advanta
-00011e00: 6765 206f 6620 7468 6973 2065 6e63 6f64  ge of this encod
-00011e10: 6572 2069 7320 7468 6174 2069 7420 646f  er is that it do
-00011e20: 6573 206e 6f74 206d 6169 6e74 6169 6e20  es not maintain 
-00011e30: 6120 6469 6374 696f 6e61 7279 206f 6620  a dictionary of 
-00011e40: 6f62 7365 7276 6564 2063 6174 6567 6f72  observed categor
-00011e50: 6965 732e 2043 6f6e 7365 7175 656e 746c  ies. Consequentl
-00011e60: 792c 2074 6865 2065 6e63 6f64 6572 2064  y, the encoder d
-00011e70: 6f65 7320 6e6f 7420 6772 6f77 2069 6e20  oes not grow in 
-00011e80: 7369 7a65 2061 6e64 2061 6363 6570 7473  size and accepts
-00011e90: 206e 6577 2076 616c 7565 7320 6475 7269   new values duri
-00011ea0: 6e67 2064 6174 6120 7363 6f72 696e 6720  ng data scoring 
-00011eb0: 6279 2064 6573 6967 6e2e 0a20 2020 2020  by design..     
-00011ec0: 2020 2020 2020 202d 2060 5375 6d45 6e63         - `SumEnc
-00011ed0: 6f64 6572 603a 2053 756d 456e 636f 6465  oder`: SumEncode
-00011ee0: 7220 6973 2061 2053 756d 2063 6f6e 7472  r is a Sum contr
-00011ef0: 6173 7420 636f 6469 6e67 2066 6f72 2074  ast coding for t
-00011f00: 6865 2065 6e63 6f64 696e 6720 6f66 2063  he encoding of c
-00011f10: 6174 6567 6f72 6963 616c 2066 6561 7475  ategorical featu
-00011f20: 7265 732e 0a20 2020 2020 2020 2020 2020  res..           
-00011f30: 202d 2060 506f 6c79 6e6f 6d69 616c 456e   - `PolynomialEn
-00011f40: 636f 6465 7260 3a20 506f 6c79 6e6f 6d69  coder`: Polynomi
-00011f50: 616c 456e 636f 6465 7220 6973 2061 2050  alEncoder is a P
-00011f60: 6f6c 796e 6f6d 6961 6c20 636f 6e74 7261  olynomial contra
-00011f70: 7374 2063 6f64 696e 6720 666f 7220 7468  st coding for th
-00011f80: 6520 656e 636f 6469 6e67 206f 6620 6361  e encoding of ca
-00011f90: 7465 676f 7269 6361 6c20 6665 6174 7572  tegorical featur
-00011fa0: 6573 2e0a 2020 2020 2020 2020 2020 2020  es..            
-00011fb0: 2d20 6042 6163 6b77 6172 6444 6966 6665  - `BackwardDiffe
-00011fc0: 7265 6e63 6545 6e63 6f64 6572 603a 2042  renceEncoder`: B
-00011fd0: 6163 6b77 6172 6444 6966 6665 7265 6e63  ackwardDifferenc
-00011fe0: 6545 6e63 6f64 6572 2069 7320 6120 4261  eEncoder is a Ba
-00011ff0: 636b 7761 7264 2064 6966 6665 7265 6e63  ckward differenc
-00012000: 6520 636f 6e74 7261 7374 2063 6f64 696e  e contrast codin
-00012010: 6720 666f 7220 656e 636f 6469 6e67 2063  g for encoding c
-00012020: 6174 6567 6f72 6963 616c 2076 6172 6961  ategorical varia
-00012030: 626c 6573 2e0a 2020 2020 2020 2020 2020  bles..          
-00012040: 2020 2d20 604f 6e65 486f 7445 6e63 6f64    - `OneHotEncod
-00012050: 6572 603a 204f 6e65 486f 7445 6e63 6f64  er`: OneHotEncod
-00012060: 6572 2069 7320 7468 6520 7472 6164 6974  er is the tradit
-00012070: 696f 6e61 6c20 4f6e 6568 6f74 2028 6f72  ional Onehot (or
-00012080: 2064 756d 6d79 2920 636f 6469 6e67 2066   dummy) coding f
-00012090: 6f72 2063 6174 6567 6f72 6963 616c 2066  or categorical f
-000120a0: 6561 7475 7265 732e 2049 7420 7072 6f64  eatures. It prod
-000120b0: 7563 6573 206f 6e65 2066 6561 7475 7265  uces one feature
-000120c0: 2070 6572 2063 6174 6567 6f72 792c 2065   per category, e
-000120d0: 6163 6820 6265 696e 6720 6120 6269 6e61  ach being a bina
-000120e0: 7279 2e0a 2020 2020 2020 2020 2020 2020  ry..            
-000120f0: 2d20 6048 656c 6d65 7274 456e 636f 6465  - `HelmertEncode
-00012100: 7260 3a20 4865 6c6d 6572 7445 6e63 6f64  r`: HelmertEncod
-00012110: 6572 2075 7365 7320 7468 6520 4865 6c6d  er uses the Helm
-00012120: 6572 7420 636f 6e74 7261 7374 2063 6f64  ert contrast cod
-00012130: 696e 6720 666f 7220 656e 636f 6469 6e67  ing for encoding
-00012140: 2063 6174 6567 6f72 6963 616c 2066 6561   categorical fea
-00012150: 7475 7265 732e 0a20 2020 2020 2020 2020  tures..         
-00012160: 2020 202d 2060 4f72 6469 6e61 6c45 6e63     - `OrdinalEnc
-00012170: 6f64 6572 603a 204f 7264 696e 616c 456e  oder`: OrdinalEn
-00012180: 636f 6465 7220 7573 6573 204f 7264 696e  coder uses Ordin
-00012190: 616c 2065 6e63 6f64 696e 6720 746f 2064  al encoding to d
-000121a0: 6573 6967 6e61 7465 2061 2073 696e 676c  esignate a singl
-000121b0: 6520 636f 6c75 6d6e 206f 6620 696e 7465  e column of inte
-000121c0: 6765 7273 2074 6f20 7265 7072 6573 656e  gers to represen
-000121d0: 7420 7468 6520 6361 7465 676f 7269 6573  t the categories
-000121e0: 2069 6e20 796f 7572 2064 6174 612e 2049   in your data. I
-000121f0: 6e74 6567 6572 7320 686f 7765 7665 7220  ntegers however 
-00012200: 7374 6172 7420 696e 2074 6865 2073 616d  start in the sam
-00012210: 6520 6f72 6465 7220 696e 2077 6869 6368  e order in which
-00012220: 2074 6865 2063 6174 6567 6f72 6965 7320   the categories 
-00012230: 6172 6520 666f 756e 6420 696e 2079 6f75  are found in you
-00012240: 7220 6461 7461 7365 742e 2049 6620 796f  r dataset. If yo
-00012250: 7520 7761 6e74 2074 6f20 6368 616e 6765  u want to change
-00012260: 2074 6865 206f 7264 6572 2c20 6a75 7374   the order, just
-00012270: 2073 6f72 7420 7468 6520 636f 6c75 6d6e   sort the column
-00012280: 2061 6e64 2073 656e 6420 6974 2069 6e20   and send it in 
-00012290: 666f 7220 656e 636f 6469 6e67 2e0a 2020  for encoding..  
-000122a0: 2020 2020 2020 2020 2020 2d20 6046 7265            - `Fre
-000122b0: 7175 656e 6379 456e 636f 6465 7260 3a20  quencyEncoder`: 
-000122c0: 4672 6571 7565 6e63 7945 6e63 6f64 6572  FrequencyEncoder
-000122d0: 2069 7320 6120 636f 756e 7420 656e 636f   is a count enco
-000122e0: 6469 6e67 2074 6563 686e 6971 7565 2066  ding technique f
-000122f0: 6f72 2063 6174 6567 6f72 6963 616c 2066  or categorical f
-00012300: 6561 7475 7265 732e 2046 6f72 2061 2067  eatures. For a g
-00012310: 6976 656e 2063 6174 6567 6f72 6963 616c  iven categorical
-00012320: 2066 6561 7475 7265 2c20 6974 2072 6570   feature, it rep
-00012330: 6c61 6365 7320 7468 6520 6e61 6d65 7320  laces the names 
-00012340: 6f66 2074 6865 2063 6174 6567 6f72 6965  of the categorie
-00012350: 7320 7769 7468 2074 6865 2067 726f 7570  s with the group
-00012360: 2063 6f75 6e74 7320 6f66 2065 6163 6820   counts of each 
-00012370: 6361 7465 676f 7279 2e0a 2020 2020 2020  category..      
-00012380: 2020 2020 2020 2d20 6042 6173 654e 456e        - `BaseNEn
-00012390: 636f 6465 7260 3a20 4261 7365 4e45 6e63  coder`: BaseNEnc
-000123a0: 6f64 6572 2065 6e63 6f64 6573 2074 6865  oder encodes the
-000123b0: 2063 6174 6567 6f72 6965 7320 696e 746f   categories into
-000123c0: 2061 7272 6179 7320 6f66 2074 6865 6972   arrays of their
-000123d0: 2062 6173 652d 4e20 7265 7072 6573 656e   base-N represen
-000123e0: 7461 7469 6f6e 2e20 4120 6261 7365 206f  tation. A base o
-000123f0: 6620 3120 6973 2065 7175 6976 616c 656e  f 1 is equivalen
-00012400: 7420 746f 206f 6e65 2d68 6f74 2065 6e63  t to one-hot enc
-00012410: 6f64 696e 6720 286e 6f74 2072 6561 6c6c  oding (not reall
-00012420: 7920 6261 7365 2d31 2c20 6275 7420 7573  y base-1, but us
-00012430: 6566 756c 292c 2061 2062 6173 6520 6f66  eful), a base of
-00012440: 2032 2069 7320 6571 7569 7661 6c65 6e74   2 is equivalent
-00012450: 2074 6f20 6269 6e61 7279 2065 6e63 6f64   to binary encod
-00012460: 696e 672e 204e 3d6e 756d 6265 7220 6f66  ing. N=number of
-00012470: 2061 6374 7561 6c20 6361 7465 676f 7269   actual categori
-00012480: 6573 2069 7320 6571 7569 7661 6c65 6e74  es is equivalent
-00012490: 2074 6f20 7661 6e69 6c6c 6120 6f72 6469   to vanilla ordi
-000124a0: 6e61 6c20 656e 636f 6469 6e67 2e0a 2020  nal encoding..  
-000124b0: 2020 2020 2020 2020 2020 2d20 6054 6172            - `Tar
-000124c0: 6765 7445 6e63 6f64 6572 603a 2054 6172  getEncoder`: Tar
-000124d0: 6765 7445 6e63 6f64 6572 2070 6572 666f  getEncoder perfo
-000124e0: 726d 7320 5461 7267 6574 2065 6e63 6f64  rms Target encod
-000124f0: 696e 6720 666f 7220 6361 7465 676f 7269  ing for categori
-00012500: 6361 6c20 6665 6174 7572 6573 2e20 4974  cal features. It
-00012510: 2073 7570 706f 7274 7320 666f 6c6c 6f77   supports follow
-00012520: 696e 6720 6b69 6e64 7320 6f66 2074 6172  ing kinds of tar
-00012530: 6765 7473 3a20 6269 6e61 7279 2061 6e64  gets: binary and
-00012540: 2063 6f6e 7469 6e75 6f75 732e 2046 6f72   continuous. For
-00012550: 206d 756c 7469 2d63 6c61 7373 2074 6172   multi-class tar
-00012560: 6765 7473 2069 7420 7573 6573 2061 2050  gets it uses a P
-00012570: 6f6c 796e 6f6d 6961 6c57 7261 7070 6572  olynomialWrapper
-00012580: 2e0a 2020 2020 2020 2020 2020 2020 2d20  ..            - 
-00012590: 6043 6174 426f 6f73 7445 6e63 6f64 6572  `CatBoostEncoder
-000125a0: 603a 2043 6174 426f 6f73 7445 6e63 6f64  `: CatBoostEncod
-000125b0: 6572 2070 6572 666f 726d 7320 4361 7442  er performs CatB
-000125c0: 6f6f 7374 2063 6f64 696e 6720 666f 7220  oost coding for 
-000125d0: 6361 7465 676f 7269 6361 6c20 6665 6174  categorical feat
-000125e0: 7572 6573 2e20 4974 2073 7570 706f 7274  ures. It support
-000125f0: 7320 7468 6520 666f 6c6c 6f77 696e 6720  s the following 
-00012600: 6b69 6e64 7320 6f66 2074 6172 6765 7473  kinds of targets
-00012610: 3a20 6269 6e61 7279 2061 6e64 2063 6f6e  : binary and con
-00012620: 7469 6e75 6f75 732e 2046 6f72 2070 6f6c  tinuous. For pol
-00012630: 796e 6f6d 6961 6c20 7461 7267 6574 2073  ynomial target s
-00012640: 7570 706f 7274 2c20 6974 2075 7365 7320  upport, it uses 
-00012650: 6120 506f 6c79 6e6f 6d69 616c 5772 6170  a PolynomialWrap
-00012660: 7065 722e 2054 6869 7320 6973 2076 6572  per. This is ver
-00012670: 7920 7369 6d69 6c61 7220 746f 206c 6561  y similar to lea
-00012680: 7665 2d6f 6e65 2d6f 7574 2065 6e63 6f64  ve-one-out encod
-00012690: 696e 672c 2062 7574 2063 616c 6375 6c61  ing, but calcula
-000126a0: 7465 7320 7468 6520 7661 6c75 6573 20e2  tes the values .
-000126b0: 809c 6f6e 2d74 6865 2d66 6c79 e280 9d2e  ..on-the-fly....
-000126c0: 2043 6f6e 7365 7175 656e 746c 792c 2074   Consequently, t
-000126d0: 6865 2076 616c 7565 7320 6e61 7475 7261  he values natura
-000126e0: 6c6c 7920 7661 7279 2064 7572 696e 6720  lly vary during 
-000126f0: 7468 6520 7472 6169 6e69 6e67 2070 6861  the training pha
-00012700: 7365 2061 6e64 2069 7420 6973 206e 6f74  se and it is not
-00012710: 206e 6563 6573 7361 7279 2074 6f20 6164   necessary to ad
-00012720: 6420 7261 6e64 6f6d 206e 6f69 7365 2e0a  d random noise..
-00012730: 2020 2020 2020 2020 2020 2020 2d20 6057              - `W
-00012740: 4f45 456e 636f 6465 7260 3a20 574f 4545  OEEncoder`: WOEE
-00012750: 6e63 6f64 6572 2075 7365 7320 7468 6520  ncoder uses the 
-00012760: 5765 6967 6874 206f 6620 4576 6964 656e  Weight of Eviden
-00012770: 6365 2074 6563 686e 6971 7565 2066 6f72  ce technique for
-00012780: 2063 6174 6567 6f72 6963 616c 2066 6561   categorical fea
-00012790: 7475 7265 732e 2049 7420 7375 7070 6f72  tures. It suppor
-000127a0: 7473 206f 6e6c 7920 6f6e 6520 6b69 6e64  ts only one kind
-000127b0: 206f 6620 7461 7267 6574 3a20 6269 6e61   of target: bina
-000127c0: 7279 2e20 466f 7220 706f 6c79 6e6f 6d69  ry. For polynomi
-000127d0: 616c 2074 6172 6765 7420 7375 7070 6f72  al target suppor
-000127e0: 742c 2069 7420 7573 6573 2061 2050 6f6c  t, it uses a Pol
-000127f0: 796e 6f6d 6961 6c57 7261 7070 6572 2e20  ynomialWrapper. 
-00012800: 4974 2063 616e 6e6f 7420 6265 2075 7365  It cannot be use
-00012810: 6420 666f 7220 5265 6772 6573 7369 6f6e  d for Regression
-00012820: 2e0a 2020 2020 2020 2020 2020 2020 2d20  ..            - 
-00012830: 604a 616d 6573 5374 6569 6e45 6e63 6f64  `JamesSteinEncod
-00012840: 6572 603a 204a 616d 6573 5374 6569 6e45  er`: JamesSteinE
-00012850: 6e63 6f64 6572 2075 7365 7320 7468 6520  ncoder uses the 
-00012860: 4a61 6d65 732d 5374 6569 6e20 6573 7469  James-Stein esti
-00012870: 6d61 746f 722e 2049 7420 7375 7070 6f72  mator. It suppor
-00012880: 7473 2032 206b 696e 6473 206f 6620 7461  ts 2 kinds of ta
-00012890: 7267 6574 733a 2062 696e 6172 7920 616e  rgets: binary an
-000128a0: 6420 636f 6e74 696e 756f 7573 2e20 466f  d continuous. Fo
-000128b0: 7220 706f 6c79 6e6f 6d69 616c 2074 6172  r polynomial tar
-000128c0: 6765 7420 7375 7070 6f72 742c 2069 7420  get support, it 
-000128d0: 7573 6573 2050 6f6c 796e 6f6d 6961 6c57  uses PolynomialW
-000128e0: 7261 7070 6572 2e0a 2020 2020 2020 2020  rapper..        
-000128f0: 2020 2020 466f 7220 6665 6174 7572 6520      For feature 
-00012900: 7661 6c75 6520 692c 204a 616d 6573 2d53  value i, James-S
-00012910: 7465 696e 2065 7374 696d 6174 6f72 2072  tein estimator r
-00012920: 6574 7572 6e73 2061 2077 6569 6768 7465  eturns a weighte
-00012930: 6420 6176 6572 6167 6520 6f66 3a0a 2020  d average of:.  
-00012940: 2020 2020 2020 2020 2020 5468 6520 6d65            The me
-00012950: 616e 2074 6172 6765 7420 7661 6c75 6520  an target value 
-00012960: 666f 7220 7468 6520 6f62 7365 7276 6564  for the observed
-00012970: 2066 6561 7475 7265 2076 616c 7565 2069   feature value i
-00012980: 2e0a 2020 2020 2020 2020 2020 2020 5468  ..            Th
-00012990: 6520 6d65 616e 2074 6172 6765 7420 7661  e mean target va
-000129a0: 6c75 6520 2872 6567 6172 646c 6573 7320  lue (regardless 
-000129b0: 6f66 2074 6865 2066 6561 7475 7265 2076  of the feature v
-000129c0: 616c 7565 292e 0a20 2020 2020 2020 2020  alue)..         
-000129d0: 2020 202d 2060 5175 616e 7469 6c65 456e     - `QuantileEn
-000129e0: 636f 6465 7260 3a20 5468 6973 2069 7320  coder`: This is 
-000129f0: 6120 7665 7279 2067 6f6f 6420 656e 636f  a very good enco
-00012a00: 6465 7220 666f 7220 5265 6772 6573 7369  der for Regressi
-00012a10: 6f6e 2074 6173 6b73 2e20 5365 6520 5061  on tasks. See Pa
-00012a20: 7065 7220 616e 6420 6172 7469 636c 653a  per and article:
-00012a30: 0a20 2020 2020 2020 2020 2020 2068 7474  .            htt
-00012a40: 7073 3a2f 2f74 6f77 6172 6473 6461 7461  ps://towardsdata
-00012a50: 7363 6965 6e63 652e 636f 6d2f 7175 616e  science.com/quan
-00012a60: 7469 6c65 2d65 6e63 6f64 6572 2d65 6233  tile-encoder-eb3
-00012a70: 3363 3237 3234 3131 640a 2020 2020 2020  3c272411d.      
-00012a80: 2020 0a20 2020 2020 2020 202d 2060 7363    .        - `sc
-00012a90: 616c 6572 7360 3a20 636f 756c 6420 6265  alers`: could be
-00012aa0: 206f 6e65 206f 6620 7468 7265 6520 6d61   one of three ma
-00012ab0: 696e 2073 6361 6c65 7273 2075 7365 6420  in scalers used 
-00012ac0: 696e 2073 6369 6b69 742d 6c65 6172 6e20  in scikit-learn 
-00012ad0: 6d6f 6465 6c73 2074 6f20 7472 616e 7366  models to transf
-00012ae0: 6f72 6d20 6e75 6d65 7269 6320 6665 6174  orm numeric feat
-00012af0: 7572 6573 2e20 4465 6661 756c 7420 6973  ures. Default is
-00012b00: 204e 6f6e 652e 2053 6361 6c65 7273 2061   None. Scalers a
-00012b10: 7265 2075 7365 6420 696e 2074 6865 206c  re used in the l
-00012b20: 6173 7420 7374 6570 206f 6620 7468 6520  ast step of the 
-00012b30: 7069 7065 6c69 6e65 2074 6f20 7363 616c  pipeline to scal
-00012b40: 6520 616c 6c20 6665 6174 7572 6573 2074  e all features t
-00012b50: 6861 7420 6861 7665 2074 7261 6e73 666f  hat have transfo
-00012b60: 726d 6564 2e20 486f 7765 7665 722c 2079  rmed. However, y
-00012b70: 6f75 206d 6967 6874 2077 616e 7420 746f  ou might want to
-00012b80: 2061 766f 6964 2073 6361 6c69 6e67 2069   avoid scaling i
-00012b90: 6e20 4e4c 5020 6461 7461 7365 7473 2073  n NLP datasets s
-00012ba0: 696e 6365 2061 6674 6572 2054 4669 4446  ince after TFiDF
-00012bb0: 2076 6563 746f 7269 7a61 7469 6f6e 2c20   vectorization, 
-00012bc0: 7363 616c 696e 6720 7468 656d 206d 6179  scaling them may
-00012bd0: 206e 6f74 206d 616b 6520 7365 6e73 652e   not make sense.
-00012be0: 2042 7574 2069 7420 6973 2075 7020 746f   But it is up to
-00012bf0: 2079 6f75 2e20 5468 6520 3420 6f70 7469   you. The 4 opti
-00012c00: 6f6e 7320 6172 653a 0a20 2020 2020 2020  ons are:.       
-00012c10: 2020 202d 2060 4e6f 6e65 6020 4e6f 2073     - `None` No s
-00012c20: 6361 6c65 722e 2047 7265 6174 2066 6f72  caler. Great for
-00012c30: 2061 6c6d 6f73 7420 616c 6c20 6461 7461   almost all data
-00012c40: 7365 7473 2e20 5465 7374 2069 7420 6669  sets. Test it fi
-00012c50: 7273 7420 616e 6420 7468 656e 2074 7279  rst and then try
-00012c60: 206f 6e65 206f 6620 7468 6520 7363 616c   one of the scal
-00012c70: 6572 7320 6265 6c6f 772e 0a20 2020 2020  ers below..     
-00012c80: 2020 2020 202d 2060 7374 6460 2073 7461       - `std` sta
-00012c90: 6e64 6172 6420 7363 616c 6572 2e20 4772  ndard scaler. Gr
-00012ca0: 6561 7420 666f 7220 616c 6d6f 7374 2061  eat for almost a
-00012cb0: 6c6c 2064 6174 6173 6574 732e 0a20 2020  ll datasets..   
-00012cc0: 2020 2020 2020 202d 2060 6d69 6e6d 6178         - `minmax
-00012cd0: 6020 6d69 6e6d 6178 2073 6361 6c65 722e  ` minmax scaler.
-00012ce0: 2047 7265 6174 2066 6f72 2064 6174 6173   Great for datas
-00012cf0: 6574 7320 7768 6572 6520 796f 7520 6e65  ets where you ne
-00012d00: 6564 2074 6f20 7365 6520 7468 6520 6469  ed to see the di
-00012d10: 7374 7269 6275 7469 6f6e 2062 6574 7765  stribution betwe
-00012d20: 656e 2030 2061 6e64 2031 2e0a 2020 2020  en 0 and 1..    
-00012d30: 2020 2020 2020 2d20 6072 6f62 7573 7460        - `robust`
-00012d40: 2052 6f62 7573 7420 7363 616c 6572 2e20   Robust scaler. 
-00012d50: 4772 6561 7420 666f 7220 6461 7461 7365  Great for datase
-00012d60: 7473 2077 6865 7265 2079 6f75 2068 6176  ts where you hav
-00012d70: 6520 6f75 746c 6965 7273 2e0a 2020 2020  e outliers..    
-00012d80: 2020 2020 2020 2d20 606d 6178 6162 7360        - `maxabs`
-00012d90: 206d 6178 2061 6273 6f6c 7574 6520 7363   max absolute sc
-00012da0: 616c 6572 2e20 4772 6561 7420 666f 7220  aler. Great for 
-00012db0: 7363 616c 696e 6720 6275 7420 6c65 6176  scaling but leav
-00012dc0: 6573 2074 6865 206e 6567 6174 6976 6520  es the negative 
-00012dd0: 7661 6c75 6573 2061 7320 7468 6579 2061  values as they a
-00012de0: 7265 2028 6e65 6761 7469 7665 292e 200a  re (negative). .
-00012df0: 2020 2020 2020 2020 2d20 6064 6174 655f          - `date_
-00012e00: 746f 5f73 7472 696e 6760 3a20 6465 6661  to_string`: defa
-00012e10: 756c 7420 6973 2046 616c 7365 2e20 4966  ult is False. If
-00012e20: 2079 6f75 2077 616e 7420 746f 2075 7365   you want to use
-00012e30: 2064 6174 6520 7661 7269 6162 6c65 7320   date variables 
-00012e40: 6173 2073 7472 696e 6773 2028 6361 7465  as strings (cate
-00012e50: 676f 7269 6361 6c29 2c20 7468 656e 2073  gorical), then s
-00012e60: 6574 2069 7420 6173 2054 7275 652e 596f  et it as True.Yo
-00012e70: 7520 6361 6e20 7573 6520 7468 6973 206f  u can use this o
-00012e80: 7074 696f 6e20 7768 656e 2074 6865 7265  ption when there
-00012e90: 2061 7265 2076 6572 7920 6665 7720 6461   are very few da
-00012ea0: 7465 7320 696e 2079 6f75 7220 6461 7461  tes in your data
-00012eb0: 7365 742e 2049 6620 796f 7520 7365 7420  set. If you set 
-00012ec0: 6974 2061 7320 4661 6c73 652c 2069 7420  it as False, it 
-00012ed0: 7769 6c6c 2063 6f6e 7665 7274 2069 7420  will convert it 
-00012ee0: 696e 746f 2064 6174 6520 7469 6d65 2066  into date time f
-00012ef0: 6f72 6d61 7420 616e 6420 6578 7472 6163  ormat and extrac
-00012f00: 7420 7570 2074 6f20 3230 2066 6561 7475  t up to 20 featu
-00012f10: 7265 7320 6672 6f6d 2079 6f75 7220 6461  res from your da
-00012f20: 7465 2074 696d 6520 636f 6c75 6d6e 2e20  te time column. 
-00012f30: 5468 6973 2069 7320 7468 6520 6465 6661  This is the defa
-00012f40: 756c 7420 6f70 7469 6f6e 2061 6e64 2062  ult option and b
-00012f50: 6573 7420 6f70 7469 6f6e 2e0a 2020 2020  est option..    
-00012f60: 2020 2020 2d20 6074 7261 6e73 666f 726d      - `transform
-00012f70: 5f74 6172 6765 7460 3a20 6465 6661 756c  _target`: defaul
-00012f80: 7420 6973 2046 616c 7365 2e20 4966 2079  t is False. If y
-00012f90: 6f75 2077 616e 7420 746f 2074 7261 6e73  ou want to trans
-00012fa0: 666f 726d 2079 6f75 7220 7461 7267 6574  form your target
-00012fb0: 2076 6172 6961 626c 6528 7329 2c20 7468   variable(s), th
-00012fc0: 656e 2073 6574 2069 7420 6173 2054 7275  en set it as Tru
-00012fd0: 6520 616e 6420 7765 2077 696c 6c20 7472  e and we will tr
-00012fe0: 616e 7366 6f72 6d20 796f 7572 2074 6172  ansform your tar
-00012ff0: 6765 7428 7329 2061 7320 6e75 6d65 7269  get(s) as numeri
-00013000: 6320 7573 696e 6720 4c61 6265 6c20 456e  c using Label En
-00013010: 636f 6469 6e67 2061 7320 7765 6c6c 2061  coding as well a
-00013020: 7320 6d75 6c74 692d 6c61 6265 6c20 4269  s multi-label Bi
-00013030: 6e61 7279 2063 6c61 7373 6573 2e20 5468  nary classes. Th
-00013040: 6973 2069 7320 6120 6772 6561 7420 6f70  is is a great op
-00013050: 7469 6f6e 2077 6865 6e20 796f 7520 6861  tion when you ha
-00013060: 7665 2063 6174 6567 6f72 6963 616c 2074  ve categorical t
-00013070: 6172 6765 7420 7661 7269 6162 6c65 732e  arget variables.
-00013080: 0a20 2020 2020 2020 202d 2060 696d 6261  .        - `imba
-00013090: 6c61 6e63 6564 603a 2064 6566 6175 6c74  lanced`: default
-000130a0: 2069 7320 4661 6c73 652e 2049 6620 796f   is False. If yo
-000130b0: 7520 6861 7665 2061 6e20 696d 6261 6c61  u have an imbala
-000130c0: 6e63 6564 2064 6174 6173 6574 2c20 7468  nced dataset, th
-000130d0: 656e 2073 6574 2069 7420 746f 2054 7275  en set it to Tru
-000130e0: 6520 616e 6420 7765 2077 696c 6c20 7472  e and we will tr
-000130f0: 616e 7366 6f72 6d20 796f 7572 2074 7261  ansform your tra
-00013100: 696e 2064 6174 6120 7573 696e 6720 426f  in data using Bo
-00013110: 7264 6572 6c69 6e65 534d 4f54 4520 6f72  rderlineSMOTE or
-00013120: 2053 4d4f 5445 4e43 2077 6869 6368 2061   SMOTENC which a
-00013130: 7265 2062 6f74 6820 6772 6561 7420 6f70  re both great op
-00013140: 7469 6f6e 732e 2057 6520 7769 6c6c 2073  tions. We will s
-00013150: 656c 6563 7420 7468 6520 7269 6768 7420  elect the right 
-00013160: 534d 4f54 4520 6675 6e63 7469 6f6e 2061  SMOTE function a
-00013170: 7574 6f6d 6174 6963 616c 6c79 2e0a 2020  utomatically..  
-00013180: 2020 2020 2020 2d20 6063 6f6d 6269 6e65        - `combine
-00013190: 5f72 6172 6560 3a20 6465 6661 756c 7420  _rare`: default 
-000131a0: 6973 2046 616c 7365 2e20 5468 6973 2069  is False. This i
-000131b0: 7320 6120 6772 6561 7420 6f70 7469 6f6e  s a great option
-000131c0: 2069 6620 796f 7520 6861 7665 2074 6f6f   if you have too
-000131d0: 206d 616e 7920 7261 7265 2063 6174 6567   many rare categ
-000131e0: 6f72 6965 7320 696e 2079 6f75 7220 6361  ories in your ca
-000131f0: 7465 676f 7269 6361 6c20 7661 7269 6162  tegorical variab
-00013200: 6c65 732e 2049 7420 7769 6c6c 2061 7574  les. It will aut
-00013210: 6f6d 6174 6963 616c 6c79 2063 6f6d 6269  omatically combi
-00013220: 6e65 2074 686f 7365 2072 6172 6520 6361  ne those rare ca
-00013230: 7465 676f 7269 6573 2077 6869 6368 2061  tegories which a
-00013240: 7265 206c 6573 7320 7468 616e 2031 2520  re less than 1% 
-00013250: 6f66 2074 6865 2064 6174 6173 6574 2069  of the dataset i
-00013260: 6e74 6f20 6f6e 6520 636f 6d62 696e 6564  nto one combined
-00013270: 2063 6174 6567 6f72 7920 6361 6c6c 6564   category called
-00013280: 2022 7261 7265 5f63 6174 6567 6f72 6965   "rare_categorie
-00013290: 7322 2e20 596f 7520 6361 6e20 616c 736f  s". You can also
-000132a0: 2073 6574 2069 7420 746f 2046 616c 7365   set it to False
-000132b0: 2061 6e64 2077 6520 7769 6c6c 206e 6f74   and we will not
-000132c0: 2074 7261 6e73 666f 726d 2061 6e79 206f   transform any o
-000132d0: 6620 796f 7572 2063 6174 6567 6f72 6965  f your categorie
-000132e0: 7320 696e 2079 6f75 7220 6361 7465 676f  s in your catego
-000132f0: 7269 6361 6c20 7661 7269 6162 6c65 732e  rical variables.
-00013300: 0a20 2020 2020 2020 2020 2d20 6076 6572  .         - `ver
-00013310: 626f 7365 603a 2054 6869 7320 6861 7320  bose`: This has 
-00013320: 3320 706f 7373 6962 6c65 2073 7461 7465  3 possible state
-00013330: 733a 0a20 2020 2020 2020 2020 202d 2060  s:.          - `
-00013340: 3060 2073 696c 656e 7420 6f75 7470 7574  0` silent output
-00013350: 2e20 4772 6561 7420 666f 7220 7275 6e6e  . Great for runn
-00013360: 696e 6720 7468 6973 2073 696c 656e 746c  ing this silentl
-00013370: 7920 616e 6420 6765 7474 696e 6720 6661  y and getting fa
-00013380: 7374 2072 6573 756c 7473 2e0a 2020 2020  st results..    
-00013390: 2020 2020 2020 2d20 6031 6020 6d6f 7265        - `1` more
-000133a0: 2076 6572 6269 6167 652e 2047 7265 6174   verbiage. Great
-000133b0: 2066 6f72 206b 6e6f 7769 6e67 2068 6f77   for knowing how
-000133c0: 2072 6573 756c 7473 2077 6572 6520 616e   results were an
-000133d0: 6420 6d61 6b69 6e67 2063 6861 6e67 6573  d making changes
-000133e0: 2074 6f20 666c 6167 7320 696e 2069 6e70   to flags in inp
-000133f0: 7574 2e0a 2020 2020 2020 2020 2020 2d20  ut..          - 
-00013400: 6032 6020 6869 6768 6c79 2076 6572 626f  `2` highly verbo
-00013410: 7365 206f 7574 7075 742e 2047 7265 6174  se output. Great
-00013420: 2066 6f72 2066 696e 6469 6e67 206f 7574   for finding out
-00013430: 2077 6861 7420 6861 7070 656e 7320 756e   what happens un
-00013440: 6465 7220 7468 6520 686f 6f64 2069 6e20  der the hood in 
-00013450: 6c61 7a79 7472 616e 7366 6f72 6d20 7069  lazytransform pi
-00013460: 7065 6c69 6e65 732e 0a20 2020 2020 2020  pelines..       
-00013470: 203c 703e 0a20 2020 2020 2020 2054 6f20   <p>.        To 
-00013480: 7669 6577 2074 6865 2074 6578 7420 7069  view the text pi
-00013490: 7065 6c69 6e65 2c20 7468 6520 6465 6661  peline, the defa
-000134a0: 756c 7420 6469 7370 6c61 7920 6973 2027  ult display is '
-000134b0: 7465 7874 272c 2064 6f3a 3c62 723e 0a20  text', do:<br>. 
-000134c0: 2020 2020 2020 200a 2020 2020 2020 2020         .        
-000134d0: 6060 600a 2020 2020 2020 2020 6672 6f6d  ```.        from
-000134e0: 2073 6b6c 6561 726e 2069 6d70 6f72 7420   sklearn import 
-000134f0: 7365 745f 636f 6e66 6967 0a20 2020 2020  set_config.     
-00013500: 2020 2073 6574 5f63 6f6e 6669 6728 6469     set_config(di
-00013510: 7370 6c61 793d 2274 6578 7422 290a 2020  splay="text").  
-00013520: 2020 2020 2020 6c61 7a79 2e78 666f 726d        lazy.xform
-00013530: 6572 0a20 2020 2020 2020 2060 6060 0a20  er.        ```. 
-00013540: 2020 2020 2020 200a 2020 2020 2020 2020         .        
-00013550: 3c70 3e0a 2020 2020 2020 2020 546f 2076  <p>.        To v
-00013560: 6965 7720 7468 6520 7069 7065 6c69 6e65  iew the pipeline
-00013570: 2069 6e20 6120 6469 6167 7261 6d20 2876   in a diagram (v
-00013580: 6973 7561 6c20 666f 726d 6174 292c 2064  isual format), d
-00013590: 6f3a 3c62 723e 0a20 2020 2020 2020 200a  o:<br>.        .
-000135a0: 2020 2020 2020 2020 6060 600a 2020 2020          ```.    
-000135b0: 2020 2020 6672 6f6d 2073 6b6c 6561 726e      from sklearn
-000135c0: 2069 6d70 6f72 7420 7365 745f 636f 6e66   import set_conf
-000135d0: 6967 0a20 2020 2020 2020 2073 6574 5f63  ig.        set_c
-000135e0: 6f6e 6669 6728 6469 7370 6c61 793d 2264  onfig(display="d
-000135f0: 6961 6772 616d 2229 0a20 2020 2020 2020  iagram").       
-00013600: 206c 617a 792e 7866 6f72 6d65 720a 2020   lazy.xformer.  
-00013610: 2020 2020 2020 2320 4966 2079 6f75 2068        # If you h
-00013620: 6176 6520 6120 6d6f 6465 6c20 696e 2074  ave a model in t
-00013630: 6865 2070 6970 656c 696e 652c 2064 6f3a  he pipeline, do:
-00013640: 0a20 2020 2020 2020 206c 617a 792e 6d6f  .        lazy.mo
-00013650: 6465 6c66 6f72 6d65 720a 2020 2020 2020  delformer.      
-00013660: 2020 6060 600a 2020 2020 2020 2020 3c61    ```.        <a
-00013670: 2068 7265 663d 2268 7474 7073 3a2f 2f69   href="https://i
-00013680: 6d67 6262 2e63 6f6d 2f22 3e3c 696d 6720  mgbb.com/"><img 
-00013690: 7372 633d 2268 7474 7073 3a2f 2f69 2e69  src="https://i.i
-000136a0: 6262 2e63 6f2f 426e 3756 3470 782f 6c61  bb.co/Bn7V4px/la
-000136b0: 7a79 2d70 6970 652e 706e 6722 2061 6c74  zy-pipe.png" alt
-000136c0: 3d22 6c61 7a79 2d70 6970 6522 2062 6f72  ="lazy-pipe" bor
-000136d0: 6465 723d 2230 223e 3c2f 613e 0a20 2020  der="0"></a>.   
-000136e0: 2020 2020 200a 2020 2020 2020 2020 546f       .        To
-000136f0: 2076 6965 7720 7468 6520 6665 6174 7572   view the featur
-00013700: 6520 696d 706f 7274 616e 6365 7320 6f66  e importances of
-00013710: 2074 6865 206d 6f64 656c 2069 6e20 7468   the model in th
-00013720: 6520 7069 7065 6c69 6e65 2c20 796f 7520  e pipeline, you 
-00013730: 6361 6e20 646f 3a0a 2020 2020 2020 2020  can do:.        
-00013740: 6060 600a 2020 2020 2020 2020 6c61 7a79  ```.        lazy
-00013750: 2e70 6c6f 745f 696d 706f 7274 616e 6365  .plot_importance
-00013760: 2829 0a20 2020 2020 2020 2060 6060 0a20  ().        ```. 
-00013770: 2020 2020 2020 203c 6120 6872 6566 3d22         <a href="
-00013780: 6874 7470 733a 2f2f 6962 622e 636f 2f6a  https://ibb.co/j
-00013790: 6870 7356 744a 223e 3c69 6d67 2073 7263  hpsVtJ"><img src
-000137a0: 3d22 6874 7470 733a 2f2f 692e 6962 622e  ="https://i.ibb.
-000137b0: 636f 2f63 4a6d 5662 7159 2f6c 617a 792d  co/cJmVbqY/lazy-
-000137c0: 6665 6174 2d69 6d70 2e70 6e67 2220 616c  feat-imp.png" al
-000137d0: 743d 226c 617a 792d 6665 6174 2d69 6d70  t="lazy-feat-imp
-000137e0: 2220 626f 7264 6572 3d22 3022 3e3c 2f61  " border="0"></a
-000137f0: 3e0a 2020 2020 2020 2020 0a20 2020 2020  >.        .     
-00013800: 2020 2023 2320 4d61 696e 7461 696e 6572     ## Maintainer
-00013810: 730a 2020 2020 2020 2020 0a20 2020 2020  s.        .     
-00013820: 2020 202a 205b 4041 7574 6f56 694d 4c5d     * [@AutoViML]
-00013830: 2868 7474 7073 3a2f 2f67 6974 6875 622e  (https://github.
-00013840: 636f 6d2f 4175 746f 5669 4d4c 290a 2020  com/AutoViML).  
-00013850: 2020 2020 2020 0a20 2020 2020 2020 2023        .        #
-00013860: 2320 436f 6e74 7269 6275 7469 6e67 0a20  # Contributing. 
-00013870: 2020 2020 2020 200a 2020 2020 2020 2020         .        
-00013880: 5365 6520 5b74 6865 2063 6f6e 7472 6962  See [the contrib
-00013890: 7574 696e 6720 6669 6c65 5d28 434f 4e54  uting file](CONT
-000138a0: 5249 4255 5449 4e47 2e6d 6429 210a 2020  RIBUTING.md)!.  
-000138b0: 2020 2020 2020 0a20 2020 2020 2020 2050        .        P
-000138c0: 5273 2061 6363 6570 7465 642e 0a20 2020  Rs accepted..   
-000138d0: 2020 2020 200a 2020 2020 2020 2020 2323       .        ##
-000138e0: 204c 6963 656e 7365 0a20 2020 2020 2020   License.       
-000138f0: 200a 2020 2020 2020 2020 4170 6163 6865   .        Apache
-00013900: 204c 6963 656e 7365 2032 2e30 20c2 a920   License 2.0 .. 
-00013910: 3230 3230 2052 616d 2053 6573 6861 6472  2020 Ram Seshadr
-00013920: 690a 2020 2020 2020 2020 0a20 2020 2020  i.        .     
-00013930: 2020 2023 2320 4e6f 7465 206f 6620 4772     ## Note of Gr
-00013940: 6174 6974 7564 650a 2020 2020 2020 2020  atitude.        
-00013950: 0a20 2020 2020 2020 2054 6869 7320 6c69  .        This li
-00013960: 6272 6179 2077 6f75 6c64 206e 6f74 2068  bray would not h
-00013970: 6176 6520 6265 656e 2070 6f73 7369 626c  ave been possibl
-00013980: 6520 7769 7468 6f75 7420 7468 6520 666f  e without the fo
-00013990: 6c6c 6f77 696e 6720 6772 6561 7420 6c69  llowing great li
-000139a0: 6272 6172 6965 733a 0a20 2020 2020 2020  braries:.       
-000139b0: 203c 6f6c 3e0a 2020 2020 2020 2020 3c6c   <ol>.        <l
-000139c0: 693e 3c62 3e43 6174 6567 6f72 7920 456e  i><b>Category En
-000139d0: 636f 6465 7273 206c 6962 7261 7279 3a3c  coders library:<
-000139e0: 2f62 3e20 4661 6e74 6173 7469 6320 6c69  /b> Fantastic li
-000139f0: 6272 6172 7920 6874 7470 733a 2f2f 636f  brary https://co
-00013a00: 6e74 7269 622e 7363 696b 6974 2d6c 6561  ntrib.scikit-lea
-00013a10: 726e 2e6f 7267 2f63 6174 6567 6f72 795f  rn.org/category_
-00013a20: 656e 636f 6465 7273 2f69 6e64 6578 2e68  encoders/index.h
-00013a30: 746d 6c3c 2f6c 693e 0a20 2020 2020 2020  tml</li>.       
-00013a40: 203c 6c69 3e3c 623e 496d 6261 6c61 6e63   <li><b>Imbalanc
-00013a50: 6564 204c 6561 726e 206c 6962 7261 7279  ed Learn library
-00013a60: 3a3c 2f62 3e20 416e 6f74 6865 7220 6661  :</b> Another fa
-00013a70: 6e74 6173 7469 6320 6c69 6272 6172 7920  ntastic library 
-00013a80: 6874 7470 733a 2f2f 696d 6261 6c61 6e63  https://imbalanc
-00013a90: 6564 2d6c 6561 726e 2e6f 7267 2f73 7461  ed-learn.org/sta
-00013aa0: 626c 652f 696e 6465 782e 6874 6d6c 3c2f  ble/index.html</
-00013ab0: 6c69 3e0a 2020 2020 2020 2020 3c6c 693e  li>.        <li>
-00013ac0: 3c62 3e54 6865 2061 6d61 7a69 6e67 2060  <b>The amazing `
-00013ad0: 6c61 7a79 7072 6564 6963 7460 3c2f 623e  lazypredict`</b>
-00013ae0: 2077 6173 2061 6e20 696e 7370 6972 6174   was an inspirat
-00013af0: 696f 6e20 666f 7220 606c 617a 7974 7261  ion for `lazytra
-00013b00: 6e73 666f 726d 602e 2059 6f75 2063 616e  nsform`. You can
-00013b10: 2063 6865 636b 206f 7574 2074 6865 206c   check out the l
-00013b20: 6962 7261 7279 2068 6572 653a 0a20 2020  ibrary here:.   
-00013b30: 2020 2020 2068 7474 7073 3a2f 2f67 6974       https://git
-00013b40: 6875 622e 636f 6d2f 7368 616e 6b61 7270  hub.com/shankarp
-00013b50: 616e 6461 6c61 2f6c 617a 7970 7265 6469  andala/lazypredi
-00013b60: 6374 0a20 2020 2020 2020 203c 2f6c 693e  ct.        </li>
-00013b70: 0a20 2020 2020 2020 203c 6c69 3e3c 623e  .        <li><b>
-00013b80: 5468 6520 616d 617a 696e 6720 604b 6576  The amazing `Kev
-00013b90: 696e 204d 6172 6b68 616d 603c 2f62 3e20  in Markham`</b> 
-00013ba0: 7761 7320 616e 6f74 6865 7220 696e 7370  was another insp
-00013bb0: 6972 6174 696f 6e20 666f 7220 6c61 7a79  iration for lazy
-00013bc0: 7472 616e 7366 6f72 6d2e 2059 6f75 2063  transform. You c
-00013bd0: 616e 2063 6865 636b 206f 7574 2068 6973  an check out his
-00013be0: 2063 6c61 7373 6573 2068 6572 653a 0a20   classes here:. 
-00013bf0: 2020 2020 2020 2068 7474 7073 3a2f 2f77         https://w
-00013c00: 7777 2e64 6174 6173 6368 6f6f 6c2e 696f  ww.dataschool.io
-00013c10: 2f61 626f 7574 2f0a 2020 2020 2020 2020  /about/.        
-00013c20: 3c2f 6c69 3e0a 2020 2020 2020 2020 3c2f  </li>.        </
-00013c30: 6f6c 3e0a 2020 2020 2020 2020 0a20 2020  ol>.        .   
-00013c40: 2020 2020 2023 2320 4449 5343 4c41 494d       ## DISCLAIM
-00013c50: 4552 0a20 2020 2020 2020 2054 6869 7320  ER.        This 
-00013c60: 7072 6f6a 6563 7420 6973 206e 6f74 2061  project is not a
-00013c70: 6e20 6f66 6669 6369 616c 2047 6f6f 676c  n official Googl
-00013c80: 6520 7072 6f6a 6563 742e 2049 7420 6973  e project. It is
-00013c90: 206e 6f74 2073 7570 706f 7274 6564 2062   not supported b
-00013ca0: 7920 476f 6f67 6c65 2061 6e64 2047 6f6f  y Google and Goo
-00013cb0: 676c 6520 7370 6563 6966 6963 616c 6c79  gle specifically
-00013cc0: 2064 6973 636c 6169 6d73 2061 6c6c 2077   disclaims all w
-00013cd0: 6172 7261 6e74 6965 7320 6173 2074 6f20  arranties as to 
-00013ce0: 6974 7320 7175 616c 6974 792c 206d 6572  its quality, mer
-00013cf0: 6368 616e 7461 6269 6c69 7479 2c20 6f72  chantability, or
-00013d00: 2066 6974 6e65 7373 2066 6f72 2061 2070   fitness for a p
-00013d10: 6172 7469 6375 6c61 7220 7075 7270 6f73  articular purpos
-00013d20: 652e 0a20 2020 2020 2020 200a 2020 2020  e..        .    
-00013d30: 2020 2020 0a50 6c61 7466 6f72 6d3a 2055      .Platform: U
-00013d40: 4e4b 4e4f 574e 0a43 6c61 7373 6966 6965  NKNOWN.Classifie
-00013d50: 723a 2050 726f 6772 616d 6d69 6e67 204c  r: Programming L
-00013d60: 616e 6775 6167 6520 3a3a 2050 7974 686f  anguage :: Pytho
-00013d70: 6e20 3a3a 2033 0a43 6c61 7373 6966 6965  n :: 3.Classifie
-00013d80: 723a 204f 7065 7261 7469 6e67 2053 7973  r: Operating Sys
-00013d90: 7465 6d20 3a3a 204f 5320 496e 6465 7065  tem :: OS Indepe
-00013da0: 6e64 656e 740a 4465 7363 7269 7074 696f  ndent.Descriptio
-00013db0: 6e2d 436f 6e74 656e 742d 5479 7065 3a20  n-Content-Type: 
-00013dc0: 7465 7874 2f6d 6172 6b64 6f77 6e0a 0000  text/markdown...
-00013dd0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-00013de0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-00013df0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-00013e00: 2e2f 2e2f 4050 6178 4865 6164 6572 0000  ././@PaxHeader..
-00013e10: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-00013e20: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-00013e30: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-00013e40: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-00013e50: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-00013e60: 0000 0000 3030 3030 3030 3000 3030 3030  ....0000000.0000
-00013e70: 3030 3000 3030 3030 3030 3000 3030 3030  000.0000000.0000
-00013e80: 3030 3030 3032 3600 3030 3030 3030 3030  0000026.00000000
-00013e90: 3030 3000 3031 3134 3533 0020 7800 0000  000.011453. x...
-00013ea0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-00013eb0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-00013ec0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-00013ed0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-00013ee0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-00013ef0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-00013f00: 0075 7374 6172 0030 3000 0000 0000 0000  .ustar.00.......
-00013f10: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-00013f20: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-00013f30: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-00013f40: 0000 0000 0000 0000 0030 3030 3030 3030  .........0000000
-00013f50: 0030 3030 3030 3030 0000 0000 0000 0000  .0000000........
-00013f60: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-00013f70: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-00013f80: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-00013f90: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-00013fa0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-00013fb0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-00013fc0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-00013fd0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-00013fe0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-00013ff0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-00014000: 3232 206d 7469 6d65 3d31 3636 3432 3832  22 mtime=1664282
-00014010: 3237 332e 300a 0000 0000 0000 0000 0000  273.0...........
-00014020: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-00014030: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-00014040: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-00014050: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-00014060: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-00014070: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-00014080: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-00014090: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-000140a0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-000140b0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-000140c0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-000140d0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-000140e0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-000140f0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-00014100: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-00014110: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-00014120: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-00014130: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-00014140: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-00014150: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-00014160: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-00014170: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-00014180: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-00014190: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-000141a0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-000141b0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-000141c0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-000141d0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-000141e0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-000141f0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-00014200: 6c61 7a79 7472 616e 7366 6f72 6d2d 312e  lazytransform-1.
-00014210: 302f 6c61 7a79 7472 616e 7366 6f72 6d2e  0/lazytransform.
-00014220: 6567 672d 696e 666f 2f53 4f55 5243 4553  egg-info/SOURCES
-00014230: 2e74 7874 0000 0000 0000 0000 0000 0000  .txt............
-00014240: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-00014250: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-00014260: 0000 0000 3030 3030 3737 3700 3030 3031  ....0000777.0001
-00014270: 3735 3000 3030 3031 3735 3000 3030 3030  750.0001750.0000
-00014280: 3030 3030 3430 3000 3030 3030 3030 3030  0000400.00000000
-00014290: 3030 3000 3032 3231 3430 0020 3000 0000  000.022140. 0...
-000142a0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-000142b0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-000142c0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-000142d0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-000142e0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-000142f0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-00014300: 0075 7374 6172 0030 3072 616d 0000 0000  .ustar.00ram....
-00014310: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-00014320: 0000 0000 0000 0000 0072 616d 0000 0000  .........ram....
-00014330: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-00014340: 0000 0000 0000 0000 0030 3030 3030 3030  .........0000000
-00014350: 0030 3030 3030 3030 0000 0000 0000 0000  .0000000........
-00014360: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-00014370: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-00014380: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-00014390: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-000143a0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-000143b0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-000143c0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-000143d0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-000143e0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-000143f0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-00014400: 4c49 4345 4e53 450a 4d41 4e49 4645 5354  LICENSE.MANIFEST
-00014410: 2e69 6e0a 5245 4144 4d45 2e6d 640a 6c61  .in.README.md.la
-00014420: 7a79 7472 616e 7366 6f72 6d2e 7079 0a72  zytransform.py.r
-00014430: 6571 7569 7265 6d65 6e74 732e 7478 740a  equirements.txt.
-00014440: 7365 7475 702e 7079 0a6c 617a 7974 7261  setup.py.lazytra
-00014450: 6e73 666f 726d 2e65 6767 2d69 6e66 6f2f  nsform.egg-info/
-00014460: 504b 472d 494e 464f 0a6c 617a 7974 7261  PKG-INFO.lazytra
-00014470: 6e73 666f 726d 2e65 6767 2d69 6e66 6f2f  nsform.egg-info/
-00014480: 534f 5552 4345 532e 7478 740a 6c61 7a79  SOURCES.txt.lazy
-00014490: 7472 616e 7366 6f72 6d2e 6567 672d 696e  transform.egg-in
-000144a0: 666f 2f64 6570 656e 6465 6e63 795f 6c69  fo/dependency_li
-000144b0: 6e6b 732e 7478 740a 6c61 7a79 7472 616e  nks.txt.lazytran
-000144c0: 7366 6f72 6d2e 6567 672d 696e 666f 2f72  sform.egg-info/r
-000144d0: 6571 7569 7265 732e 7478 740a 6c61 7a79  equires.txt.lazy
-000144e0: 7472 616e 7366 6f72 6d2e 6567 672d 696e  transform.egg-in
-000144f0: 666f 2f74 6f70 5f6c 6576 656c 2e74 7874  fo/top_level.txt
-00014500: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-00014510: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-00014520: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-00014530: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-00014540: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-00014550: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-00014560: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-00014570: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-00014580: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-00014590: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-000145a0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-000145b0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-000145c0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-000145d0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-000145e0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-000145f0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-00014600: 2e2f 2e2f 4050 6178 4865 6164 6572 0000  ././@PaxHeader..
-00014610: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-00014620: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-00014630: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-00014640: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-00014650: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-00014660: 0000 0000 3030 3030 3030 3000 3030 3030  ....0000000.0000
-00014670: 3030 3000 3030 3030 3030 3000 3030 3030  000.0000000.0000
-00014680: 3030 3030 3032 3600 3030 3030 3030 3030  0000026.00000000
-00014690: 3030 3000 3031 3134 3533 0020 7800 0000  000.011453. x...
-000146a0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-000146b0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-000146c0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-000146d0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-000146e0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-000146f0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-00014700: 0075 7374 6172 0030 3000 0000 0000 0000  .ustar.00.......
-00014710: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-00014720: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-00014730: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-00014740: 0000 0000 0000 0000 0030 3030 3030 3030  .........0000000
-00014750: 0030 3030 3030 3030 0000 0000 0000 0000  .0000000........
-00014760: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-00014770: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-00014780: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-00014790: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-000147a0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-000147b0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-000147c0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-000147d0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-000147e0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-000147f0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-00014800: 3232 206d 7469 6d65 3d31 3636 3432 3832  22 mtime=1664282
-00014810: 3237 332e 300a 0000 0000 0000 0000 0000  273.0...........
-00014820: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-00014830: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-00014840: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-00014850: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-00014860: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-00014870: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-00014880: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-00014890: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-000148a0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-000148b0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-000148c0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-000148d0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-000148e0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-000148f0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-00014900: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-00014910: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-00014920: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-00014930: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-00014940: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-00014950: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-00014960: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-00014970: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-00014980: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-00014990: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-000149a0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-000149b0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-000149c0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-000149d0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-000149e0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-000149f0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-00014a00: 6c61 7a79 7472 616e 7366 6f72 6d2d 312e  lazytransform-1.
-00014a10: 302f 6c61 7a79 7472 616e 7366 6f72 6d2e  0/lazytransform.
-00014a20: 6567 672d 696e 666f 2f64 6570 656e 6465  egg-info/depende
-00014a30: 6e63 795f 6c69 6e6b 732e 7478 7400 0000  ncy_links.txt...
-00014a40: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-00014a50: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-00014a60: 0000 0000 3030 3030 3737 3700 3030 3031  ....0000777.0001
-00014a70: 3735 3000 3030 3031 3735 3000 3030 3030  750.0001750.0000
-00014a80: 3030 3030 3030 3100 3030 3030 3030 3030  0000001.00000000
-00014a90: 3030 3000 3032 3433 3330 0020 3000 0000  000.024330. 0...
-00014aa0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-00014ab0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-00014ac0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-00014ad0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-00014ae0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-00014af0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-00014b00: 0075 7374 6172 0030 3072 616d 0000 0000  .ustar.00ram....
-00014b10: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-00014b20: 0000 0000 0000 0000 0072 616d 0000 0000  .........ram....
-00014b30: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-00014b40: 0000 0000 0000 0000 0030 3030 3030 3030  .........0000000
-00014b50: 0030 3030 3030 3030 0000 0000 0000 0000  .0000000........
-00014b60: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-00014b70: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-00014b80: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-00014b90: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-00014ba0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-00014bb0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-00014bc0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-00014bd0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-00014be0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-00014bf0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-00014c00: 0a00 0000 0000 0000 0000 0000 0000 0000  ................
-00014c10: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-00014c20: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-00014c30: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-00014c40: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-00014c50: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-00014c60: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-00014c70: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-00014c80: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-00014c90: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-00014ca0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-00014cb0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-00014cc0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-00014cd0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-00014ce0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-00014cf0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-00014d00: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-00014d10: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-00014d20: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-00014d30: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-00014d40: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-00014d50: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-00014d60: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-00014d70: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-00014d80: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-00014d90: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-00014da0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-00014db0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-00014dc0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-00014dd0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-00014de0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-00014df0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-00014e00: 2e2f 2e2f 4050 6178 4865 6164 6572 0000  ././@PaxHeader..
-00014e10: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-00014e20: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-00014e30: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-00014e40: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-00014e50: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-00014e60: 0000 0000 3030 3030 3030 3000 3030 3030  ....0000000.0000
-00014e70: 3030 3000 3030 3030 3030 3000 3030 3030  000.0000000.0000
-00014e80: 3030 3030 3032 3600 3030 3030 3030 3030  0000026.00000000
-00014e90: 3030 3000 3031 3134 3533 0020 7800 0000  000.011453. x...
-00014ea0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-00014eb0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-00014ec0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-00014ed0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-00014ee0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-00014ef0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-00014f00: 0075 7374 6172 0030 3000 0000 0000 0000  .ustar.00.......
-00014f10: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-00014f20: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-00014f30: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-00014f40: 0000 0000 0000 0000 0030 3030 3030 3030  .........0000000
-00014f50: 0030 3030 3030 3030 0000 0000 0000 0000  .0000000........
-00014f60: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-00014f70: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-00014f80: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-00014f90: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-00014fa0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-00014fb0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-00014fc0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-00014fd0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-00014fe0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-00014ff0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-00015000: 3232 206d 7469 6d65 3d31 3636 3432 3832  22 mtime=1664282
-00015010: 3237 332e 300a 0000 0000 0000 0000 0000  273.0...........
-00015020: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-00015030: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-00015040: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-00015050: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-00015060: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-00015070: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-00015080: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-00015090: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-000150a0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-000150b0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-000150c0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-000150d0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-000150e0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-000150f0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-00015100: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-00015110: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-00015120: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-00015130: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-00015140: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-00015150: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-00015160: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-00015170: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-00015180: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-00015190: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-000151a0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-000151b0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-000151c0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-000151d0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-000151e0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-000151f0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-00015200: 6c61 7a79 7472 616e 7366 6f72 6d2d 312e  lazytransform-1.
-00015210: 302f 6c61 7a79 7472 616e 7366 6f72 6d2e  0/lazytransform.
-00015220: 6567 672d 696e 666f 2f72 6571 7569 7265  egg-info/require
-00015230: 732e 7478 7400 0000 0000 0000 0000 0000  s.txt...........
-00015240: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-00015250: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-00015260: 0000 0000 3030 3030 3737 3700 3030 3031  ....0000777.0001
-00015270: 3735 3000 3030 3031 3735 3000 3030 3030  750.0001750.0000
-00015280: 3030 3030 3231 3600 3030 3030 3030 3030  0000216.00000000
-00015290: 3030 3000 3032 3236 3631 0020 3000 0000  000.022661. 0...
-000152a0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-000152b0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-000152c0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-000152d0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-000152e0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-000152f0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-00015300: 0075 7374 6172 0030 3072 616d 0000 0000  .ustar.00ram....
-00015310: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-00015320: 0000 0000 0000 0000 0072 616d 0000 0000  .........ram....
-00015330: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-00015340: 0000 0000 0000 0000 0030 3030 3030 3030  .........0000000
-00015350: 0030 3030 3030 3030 0000 0000 0000 0000  .0000000........
-00015360: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-00015370: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-00015380: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-00015390: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-000153a0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-000153b0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-000153c0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-000153d0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-000153e0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-000153f0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-00015400: 6361 7465 676f 7279 2d65 6e63 6f64 6572  category-encoder
-00015410: 737e 3d32 2e34 0a69 6d62 616c 616e 6365  s~=2.4.imbalance
-00015420: 642d 656e 7365 6d62 6c65 3e3d 302e 312e  d-ensemble>=0.1.
-00015430: 370a 696d 6261 6c61 6e63 6564 2d6c 6561  7.imbalanced-lea
-00015440: 726e 3e3d 302e 370a 6d61 7470 6c6f 746c  rn>=0.7.matplotl
-00015450: 6962 0a6e 756d 7079 3e3d 312e 3231 2e35  ib.numpy>=1.21.5
-00015460: 0a70 616e 6461 733e 3d31 2e33 2e35 0a73  .pandas>=1.3.5.s
-00015470: 6369 6b69 742d 6c65 6172 6e3c 3d30 2e32  cikit-learn<=0.2
-00015480: 342e 320a 7471 646d 0a78 6c72 640a 0000  4.2.tqdm.xlrd...
-00015490: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-000154a0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-000154b0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-000154c0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-000154d0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-000154e0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-000154f0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-00015500: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-00015510: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-00015520: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-00015530: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-00015540: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-00015550: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-00015560: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-00015570: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-00015580: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-00015590: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-000155a0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-000155b0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-000155c0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-000155d0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-000155e0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-000155f0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-00015600: 2e2f 2e2f 4050 6178 4865 6164 6572 0000  ././@PaxHeader..
-00015610: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-00015620: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-00015630: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-00015640: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-00015650: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-00015660: 0000 0000 3030 3030 3030 3000 3030 3030  ....0000000.0000
-00015670: 3030 3000 3030 3030 3030 3000 3030 3030  000.0000000.0000
-00015680: 3030 3030 3032 3600 3030 3030 3030 3030  0000026.00000000
-00015690: 3030 3000 3031 3134 3533 0020 7800 0000  000.011453. x...
-000156a0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-000156b0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-000156c0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-000156d0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-000156e0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-000156f0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-00015700: 0075 7374 6172 0030 3000 0000 0000 0000  .ustar.00.......
-00015710: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-00015720: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-00015730: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-00015740: 0000 0000 0000 0000 0030 3030 3030 3030  .........0000000
-00015750: 0030 3030 3030 3030 0000 0000 0000 0000  .0000000........
-00015760: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-00015770: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-00015780: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-00015790: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-000157a0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-000157b0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-000157c0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-000157d0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-000157e0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-000157f0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-00015800: 3232 206d 7469 6d65 3d31 3636 3432 3832  22 mtime=1664282
-00015810: 3237 332e 300a 0000 0000 0000 0000 0000  273.0...........
-00015820: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-00015830: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-00015840: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-00015850: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-00015860: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-00015870: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-00015880: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-00015890: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-000158a0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-000158b0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-000158c0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-000158d0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-000158e0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-000158f0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-00015900: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-00015910: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-00015920: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-00015930: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-00015940: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-00015950: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-00015960: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-00015970: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-00015980: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-00015990: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-000159a0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-000159b0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-000159c0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-000159d0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-000159e0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-000159f0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-00015a00: 6c61 7a79 7472 616e 7366 6f72 6d2d 312e  lazytransform-1.
-00015a10: 302f 6c61 7a79 7472 616e 7366 6f72 6d2e  0/lazytransform.
-00015a20: 6567 672d 696e 666f 2f74 6f70 5f6c 6576  egg-info/top_lev
-00015a30: 656c 2e74 7874 0000 0000 0000 0000 0000  el.txt..........
-00015a40: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-00015a50: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-00015a60: 0000 0000 3030 3030 3737 3700 3030 3031  ....0000777.0001
-00015a70: 3735 3000 3030 3031 3735 3000 3030 3030  750.0001750.0000
-00015a80: 3030 3030 3031 3600 3030 3030 3030 3030  0000016.00000000
-00015a90: 3030 3000 3032 3330 3131 0020 3000 0000  000.023011. 0...
-00015aa0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-00015ab0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-00015ac0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-00015ad0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-00015ae0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-00015af0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-00015b00: 0075 7374 6172 0030 3072 616d 0000 0000  .ustar.00ram....
-00015b10: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-00015b20: 0000 0000 0000 0000 0072 616d 0000 0000  .........ram....
-00015b30: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-00015b40: 0000 0000 0000 0000 0030 3030 3030 3030  .........0000000
-00015b50: 0030 3030 3030 3030 0000 0000 0000 0000  .0000000........
-00015b60: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-00015b70: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-00015b80: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-00015b90: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-00015ba0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-00015bb0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-00015bc0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-00015bd0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-00015be0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-00015bf0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-00015c00: 6c61 7a79 7472 616e 7366 6f72 6d0a 0000  lazytransform...
-00015c10: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-00015c20: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-00015c30: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-00015c40: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-00015c50: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-00015c60: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-00015c70: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-00015c80: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-00015c90: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-00015ca0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-00015cb0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-00015cc0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-00015cd0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-00015ce0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-00015cf0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-00015d00: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-00015d10: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-00015d20: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-00015d30: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-00015d40: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-00015d50: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-00015d60: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-00015d70: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-00015d80: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-00015d90: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-00015da0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-00015db0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-00015dc0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-00015dd0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-00015de0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-00015df0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-00015e00: 2e2f 2e2f 4050 6178 4865 6164 6572 0000  ././@PaxHeader..
-00015e10: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-00015e20: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-00015e30: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-00015e40: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-00015e50: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-00015e60: 0000 0000 3030 3030 3030 3000 3030 3030  ....0000000.0000
-00015e70: 3030 3000 3030 3030 3030 3000 3030 3030  000.0000000.0000
-00015e80: 3030 3030 3032 3600 3030 3030 3030 3030  0000026.00000000
-00015e90: 3030 3000 3031 3134 3533 0020 7800 0000  000.011453. x...
-00015ea0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-00015eb0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-00015ec0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-00015ed0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-00015ee0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-00015ef0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-00015f00: 0075 7374 6172 0030 3000 0000 0000 0000  .ustar.00.......
-00015f10: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-00015f20: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-00015f30: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-00015f40: 0000 0000 0000 0000 0030 3030 3030 3030  .........0000000
-00015f50: 0030 3030 3030 3030 0000 0000 0000 0000  .0000000........
-00015f60: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-00015f70: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-00015f80: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-00015f90: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-00015fa0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-00015fb0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-00015fc0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-00015fd0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-00015fe0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-00015ff0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-00016000: 3232 206d 7469 6d65 3d31 3636 3432 3832  22 mtime=1664282
-00016010: 3231 332e 300a 0000 0000 0000 0000 0000  213.0...........
-00016020: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-00016030: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-00016040: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-00016050: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-00016060: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-00016070: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-00016080: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-00016090: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-000160a0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-000160b0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-000160c0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-000160d0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-000160e0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-000160f0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-00016100: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-00016110: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-00016120: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-00016130: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-00016140: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-00016150: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-00016160: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-00016170: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-00016180: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-00016190: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-000161a0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-000161b0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-000161c0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-000161d0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-000161e0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-000161f0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-00016200: 6c61 7a79 7472 616e 7366 6f72 6d2d 312e  lazytransform-1.
-00016210: 302f 6c61 7a79 7472 616e 7366 6f72 6d2e  0/lazytransform.
-00016220: 7079 0000 0000 0000 0000 0000 0000 0000  py..............
-00016230: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-00016240: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-00016250: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-00016260: 0000 0000 3030 3030 3737 3700 3030 3031  ....0000777.0001
-00016270: 3735 3000 3030 3031 3735 3000 3030 3030  750.0001750.0000
-00016280: 3036 3631 3135 3700 3030 3030 3030 3030  0661157.00000000
-00016290: 3030 3000 3031 3731 3632 0020 3000 0000  000.017162. 0...
-000162a0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-000162b0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-000162c0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-000162d0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-000162e0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-000162f0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-00016300: 0075 7374 6172 0030 3072 616d 0000 0000  .ustar.00ram....
-00016310: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-00016320: 0000 0000 0000 0000 0072 616d 0000 0000  .........ram....
-00016330: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-00016340: 0000 0000 0000 0000 0030 3030 3030 3030  .........0000000
-00016350: 0030 3030 3030 3030 0000 0000 0000 0000  .0000000........
-00016360: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-00016370: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-00016380: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-00016390: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-000163a0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-000163b0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-000163c0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-000163d0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-000163e0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-000163f0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-00016400: 2321 2f75 7372 2f62 696e 2f65 6e76 2070  #!/usr/bin/env p
-00016410: 7974 686f 6e0a 2320 636f 6469 6e67 3a20  ython.# coding: 
-00016420: 7574 662d 380a 2323 2323 2323 2323 2323  utf-8.##########
-00016430: 2323 2323 2323 2323 2323 2323 2323 2323  ################
-00016440: 2323 2323 2323 2323 2323 2323 2323 2323  ################
-00016450: 2323 2323 2323 2323 2323 2323 2323 2323  ################
-00016460: 2323 2323 2323 2323 2323 2323 2323 2323  ################
-00016470: 2323 2323 2323 2323 2323 2323 2323 2323  ################
-00016480: 2323 0a23 2043 6f70 7972 6967 6874 205b  ##.# Copyright [
-00016490: 3230 3232 5d20 5b52 616d 2053 6573 6861  2022] [Ram Sesha
-000164a0: 6472 695d 0a23 0a23 204c 6963 656e 7365  dri].#.# License
-000164b0: 6420 756e 6465 7220 7468 6520 4170 6163  d under the Apac
-000164c0: 6865 204c 6963 656e 7365 2c20 5665 7273  he License, Vers
-000164d0: 696f 6e20 322e 3020 2874 6865 2022 4c69  ion 2.0 (the "Li
-000164e0: 6365 6e73 6522 293b 0a23 2079 6f75 206d  cense");.# you m
-000164f0: 6179 206e 6f74 2075 7365 2074 6869 7320  ay not use this 
-00016500: 6669 6c65 2065 7863 6570 7420 696e 2063  file except in c
-00016510: 6f6d 706c 6961 6e63 6520 7769 7468 2074  ompliance with t
-00016520: 6865 204c 6963 656e 7365 2e0a 2320 596f  he License..# Yo
-00016530: 7520 6d61 7920 6f62 7461 696e 2061 2063  u may obtain a c
-00016540: 6f70 7920 6f66 2074 6865 204c 6963 656e  opy of the Licen
-00016550: 7365 2061 740a 230a 2320 2020 2068 7474  se at.#.#    htt
-00016560: 703a 2f2f 7777 772e 6170 6163 6865 2e6f  p://www.apache.o
-00016570: 7267 2f6c 6963 656e 7365 732f 4c49 4345  rg/licenses/LICE
-00016580: 4e53 452d 322e 300a 230a 2320 556e 6c65  NSE-2.0.#.# Unle
-00016590: 7373 2072 6571 7569 7265 6420 6279 2061  ss required by a
-000165a0: 7070 6c69 6361 626c 6520 6c61 7720 6f72  pplicable law or
-000165b0: 2061 6772 6565 6420 746f 2069 6e20 7772   agreed to in wr
-000165c0: 6974 696e 672c 2073 6f66 7477 6172 650a  iting, software.
-000165d0: 2320 6469 7374 7269 6275 7465 6420 756e  # distributed un
-000165e0: 6465 7220 7468 6520 4c69 6365 6e73 6520  der the License 
-000165f0: 6973 2064 6973 7472 6962 7574 6564 206f  is distributed o
-00016600: 6e20 616e 2022 4153 2049 5322 2042 4153  n an "AS IS" BAS
-00016610: 4953 2c0a 2320 5749 5448 4f55 5420 5741  IS,.# WITHOUT WA
-00016620: 5252 414e 5449 4553 204f 5220 434f 4e44  RRANTIES OR COND
-00016630: 4954 494f 4e53 204f 4620 414e 5920 4b49  ITIONS OF ANY KI
-00016640: 4e44 2c20 6569 7468 6572 2065 7870 7265  ND, either expre
-00016650: 7373 206f 7220 696d 706c 6965 642e 0a23  ss or implied..#
-00016660: 2053 6565 2074 6865 204c 6963 656e 7365   See the License
-00016670: 2066 6f72 2074 6865 2073 7065 6369 6669   for the specifi
-00016680: 6320 6c61 6e67 7561 6765 2067 6f76 6572  c language gover
-00016690: 6e69 6e67 2070 6572 6d69 7373 696f 6e73  ning permissions
-000166a0: 2061 6e64 0a23 206c 696d 6974 6174 696f   and.# limitatio
-000166b0: 6e73 2075 6e64 6572 2074 6865 204c 6963  ns under the Lic
-000166c0: 656e 7365 2e0a 2323 2323 2323 2323 2323  ense..##########
-000166d0: 2323 2323 2323 2323 2323 2323 2323 2323  ################
-000166e0: 2323 2323 2323 2323 2323 2323 2323 2323  ################
-000166f0: 2323 2323 2323 2323 2323 2323 2323 2323  ################
-00016700: 2323 2323 2323 2323 2323 2323 2323 2323  ################
-00016710: 2323 2323 2323 2323 2323 2323 2323 2323  ################
-00016720: 230a 2323 2323 2320 4c61 7a79 5472 616e  #.##### LazyTran
-00016730: 7366 6f72 6d65 7220 6973 2061 2073 696d  sformer is a sim
-00016740: 706c 6520 7472 616e 7366 6f72 6d65 7220  ple transformer 
-00016750: 7069 7065 6c69 6e65 2066 6f72 2061 6c6c  pipeline for all
-00016760: 206b 696e 6473 206f 6620 4d4c 2070 726f   kinds of ML pro
-00016770: 626c 656d 732e 2023 2323 2323 230a 2323  blems. ######.##
-00016780: 2323 2323 2323 2323 2323 2323 2323 2323  ################
-00016790: 2323 2323 2323 2323 2323 2323 2323 2323  ################
-000167a0: 2323 2323 2323 2323 2323 2323 2323 2323  ################
-000167b0: 2323 2323 2323 2323 2323 2323 2323 2323  ################
-000167c0: 2323 2323 2323 2323 2323 2323 2323 2323  ################
-000167d0: 2323 2323 2323 2323 230a 2320 5768 6174  #########.# What
-000167e0: 2064 6f65 7320 7468 6973 2070 6970 656c   does this pipel
-000167f0: 696e 6520 646f 3f20 4865 7265 2773 2074  ine do? Here's t
-00016800: 6865 206d 616a 6f72 2073 7465 7073 3a0a  he major steps:.
-00016810: 2320 312e 2054 616b 6573 2063 6174 6567  # 1. Takes categ
-00016820: 6f72 6963 616c 2076 6172 6961 626c 6573  orical variables
-00016830: 2061 6e64 2065 6e63 6f64 6573 2074 6865   and encodes the
-00016840: 6d20 7573 696e 6720 6d79 2073 7065 6369  m using my speci
-00016850: 616c 206c 6162 656c 2065 6e63 6f64 6572  al label encoder
-00016860: 2077 6869 6368 2063 616e 200a 2320 2020   which can .#   
-00016870: 2068 616e 646c 6520 4e61 4e73 2061 6e64   handle NaNs and
-00016880: 2066 7574 7572 6520 6361 7465 676f 7269   future categori
-00016890: 6573 0a23 2031 2e20 5461 6b65 7320 696e  es.# 1. Takes in
-000168a0: 7465 6765 7220 616e 6420 666c 6f61 7420  teger and float 
-000168b0: 7661 7269 6162 6c65 7320 616e 6420 696d  variables and im
-000168c0: 7075 7465 7320 7468 656d 2075 7369 6e67  putes them using
-000168d0: 2061 2073 696d 706c 6520 696d 7075 7465   a simple impute
-000168e0: 7220 2877 6974 6820 6120 6465 6661 756c  r (with a defaul
-000168f0: 7429 0a23 2031 2e20 5461 6b65 7320 4e4c  t).# 1. Takes NL
-00016900: 5020 616e 6420 7469 6d65 2073 6572 6965  P and time serie
-00016910: 7320 2861 7320 7374 7269 6e67 2920 7661  s (as string) va
-00016920: 7269 6162 6c65 7320 616e 6420 7665 6374  riables and vect
-00016930: 6f72 697a 6573 2074 6865 6d20 7573 696e  orizes them usin
-00016940: 6720 5446 6944 460a 2320 312e 2054 616b  g TFiDF.# 1. Tak
-00016950: 6573 2070 616e 6461 7320 6461 7465 2d74  es pandas date-t
-00016960: 696d 6520 2861 6374 7561 6c20 6461 7465  ime (actual date
-00016970: 2d74 696d 6529 2076 6172 6961 626c 6573  -time) variables
-00016980: 2061 6e64 2065 7874 7261 6374 7320 6d6f   and extracts mo
-00016990: 7265 2066 6561 7475 7265 7320 6672 6f6d  re features from
-000169a0: 2074 6865 6d0a 2320 312e 2043 6f6d 706c   them.# 1. Compl
-000169b0: 6574 656c 7920 4e6f 726d 616c 697a 6573  etely Normalizes
-000169c0: 2061 6c6c 206f 6620 7468 6520 6162 6f76   all of the abov
-000169d0: 6520 7573 696e 6720 4162 734d 6178 5363  e using AbsMaxSc
-000169e0: 616c 6572 2077 6869 6368 2070 7265 7365  aler which prese
-000169f0: 7276 6573 2074 6865 200a 2320 2020 2020  rves the .#     
-00016a00: 7265 6c61 7469 6f6e 7368 6970 206f 6620  relationship of 
-00016a10: 6c61 6265 6c20 656e 636f 6465 6420 7661  label encoded va
-00016a20: 7273 0a23 2031 2e20 4f70 7469 6f6e 616c  rs.# 1. Optional
-00016a30: 6c79 2061 6464 7320 616e 7920 6d6f 6465  ly adds any mode
-00016a40: 6c20 746f 2070 6970 656c 696e 6520 736f  l to pipeline so
-00016a50: 2074 6865 2065 6e74 6972 6520 7069 7065   the entire pipe
-00016a60: 6c69 6e65 2063 616e 2062 6520 6665 6420  line can be fed 
-00016a70: 746f 2061 200a 2320 2020 2020 6372 6f73  to a .#     cros
-00016a80: 7320 7661 6c69 6461 7469 6f6e 2073 6368  s validation sch
-00016a90: 656d 6520 286a 7573 7420 7365 7420 6d6f  eme (just set mo
-00016aa0: 6465 6c3d 616e 795f 736b 6c65 6172 6e5f  del=any_sklearn_
-00016ab0: 6d6f 6465 6c28 2920 7768 656e 2064 6566  model() when def
-00016ac0: 696e 696e 6720 7468 6520 7069 7065 6c69  ining the pipeli
-00016ad0: 6e65 290a 2320 5468 6520 696e 6974 6961  ne).# The initia
-00016ae0: 6c20 7265 7375 6c74 7320 6672 6f6d 2074  l results from t
-00016af0: 6869 7320 7069 7065 6c69 6e65 2069 6e20  his pipeline in 
-00016b00: 7265 616c 2077 6f72 6c64 2064 6174 6120  real world data 
-00016b10: 7365 7473 2069 7320 7072 6f6d 6973 696e  sets is promisin
-00016b20: 6720 696e 6465 6564 2e0a 2323 2323 2323  g indeed..######
-00016b30: 2323 2323 2323 2323 2323 2323 2323 2323  ################
-00016b40: 2323 2323 2323 2323 2323 2323 2323 2323  ################
-00016b50: 2323 2323 2323 2323 2323 2323 2323 2323  ################
-00016b60: 2323 2323 2323 2323 2323 2323 2323 2323  ################
-00016b70: 2323 2323 2323 2323 2323 2323 2323 2323  ################
-00016b80: 2323 2323 2323 0a23 2323 2323 2323 2054  ######.####### T
-00016b90: 6869 7320 5472 616e 7366 6f72 6d65 7220  his Transformer 
-00016ba0: 6973 2069 6e73 7069 7265 6420 6279 204b  is inspired by K
-00016bb0: 6576 696e 204d 6172 6b68 616d 2773 2063  evin Markham's c
-00016bc0: 6c61 7373 206f 6e20 5363 696b 6974 2d4c  lass on Scikit-L
-00016bd0: 6561 726e 2070 6970 656c 696e 6573 2e20  earn pipelines. 
-00016be0: 2323 230a 2323 2323 2323 2320 2020 596f  ###.#######   Yo
-00016bf0: 7520 6361 6e20 7369 676e 2075 7020 666f  u can sign up fo
-00016c00: 7220 6869 7320 4461 7461 2053 6368 6f6f  r his Data Schoo
-00016c10: 6c20 636c 6173 7320 6865 7265 3a20 6874  l class here: ht
-00016c20: 7470 733a 2f2f 7777 772e 6461 7461 7363  tps://www.datasc
-00016c30: 686f 6f6c 2e69 6f2f 2020 2323 2323 2323  hool.io/  ######
-00016c40: 0a23 2323 2323 2323 2323 2323 2323 2323  .###############
-00016c50: 2323 2323 2323 2323 2323 2323 2323 2323  ################
-00016c60: 2323 2323 2323 2323 2323 2323 2323 2323  ################
-00016c70: 2323 2323 2323 2323 2323 2323 2323 2323  ################
-00016c80: 2323 2323 2323 2323 2323 2323 2323 2323  ################
-00016c90: 2323 2323 2323 2323 2323 2323 230a 696d  #############.im
-00016ca0: 706f 7274 206e 756d 7079 2061 7320 6e70  port numpy as np
-00016cb0: 0a69 6d70 6f72 7420 7061 6e64 6173 2061  .import pandas a
-00016cc0: 7320 7064 0a6e 702e 7261 6e64 6f6d 2e73  s pd.np.random.s
-00016cd0: 6565 6428 3939 290a 696d 706f 7274 2072  eed(99).import r
-00016ce0: 616e 646f 6d0a 7261 6e64 6f6d 2e73 6565  andom.random.see
-00016cf0: 6428 3432 290a 2323 2323 2323 2323 2323  d(42).##########
-00016d00: 2323 2323 2323 2323 2323 2323 2323 2323  ################
-00016d10: 2323 2323 2323 2323 2323 2323 2323 2323  ################
-00016d20: 2323 2323 2323 2323 2323 2323 2323 2323  ################
-00016d30: 2323 2323 2323 2323 2323 2323 2323 2323  ################
-00016d40: 2323 2323 2323 0a69 6d70 6f72 7420 7761  ######.import wa
-00016d50: 726e 696e 6773 0a77 6172 6e69 6e67 732e  rnings.warnings.
-00016d60: 6669 6c74 6572 7761 726e 696e 6773 2822  filterwarnings("
-00016d70: 6967 6e6f 7265 2229 0a66 726f 6d20 736b  ignore").from sk
-00016d80: 6c65 6172 6e2e 6578 6365 7074 696f 6e73  learn.exceptions
-00016d90: 2069 6d70 6f72 7420 4461 7461 436f 6e76   import DataConv
-00016da0: 6572 7369 6f6e 5761 726e 696e 670a 7761  ersionWarning.wa
-00016db0: 726e 696e 6773 2e66 696c 7465 7277 6172  rnings.filterwar
-00016dc0: 6e69 6e67 7328 6163 7469 6f6e 3d27 6967  nings(action='ig
-00016dd0: 6e6f 7265 272c 2063 6174 6567 6f72 793d  nore', category=
-00016de0: 4461 7461 436f 6e76 6572 7369 6f6e 5761  DataConversionWa
-00016df0: 726e 696e 6729 0a77 6974 6820 7761 726e  rning).with warn
-00016e00: 696e 6773 2e63 6174 6368 5f77 6172 6e69  ings.catch_warni
-00016e10: 6e67 7328 293a 0a20 2020 2077 6172 6e69  ngs():.    warni
-00016e20: 6e67 732e 7369 6d70 6c65 6669 6c74 6572  ngs.simplefilter
-00016e30: 2822 6967 6e6f 7265 2229 0a23 2323 2323  ("ignore").#####
-00016e40: 2323 2323 2323 2323 2323 2323 2323 2323  ################
-00016e50: 2323 2323 2323 2323 2323 2323 2323 2323  ################
+00000c00: 4d65 7461 6461 7461 2d56 6572 7369 6f6e  Metadata-Version
+00000c10: 3a20 322e 310a 4e61 6d65 3a20 6c61 7a79  : 2.1.Name: lazy
+00000c20: 7472 616e 7366 6f72 6d0a 5665 7273 696f  transform.Versio
+00000c30: 6e3a 2031 2e31 0a53 756d 6d61 7279 3a20  n: 1.1.Summary: 
+00000c40: 436c 6561 6e20 796f 7572 2064 6174 6120  Clean your data 
+00000c50: 7573 696e 6720 6120 7363 696b 6974 2d6c  using a scikit-l
+00000c60: 6561 726e 2074 7261 6e73 666f 726d 6572  earn transformer
+00000c70: 2069 6e20 6120 7369 6e67 6c65 206c 696e   in a single lin
+00000c80: 6520 6f66 2063 6f64 650a 486f 6d65 2d70  e of code.Home-p
+00000c90: 6167 653a 2068 7474 7073 3a2f 2f67 6974  age: https://git
+00000ca0: 6875 622e 636f 6d2f 4175 746f 5669 4d4c  hub.com/AutoViML
+00000cb0: 2f6c 617a 7974 7261 6e73 666f 726d 0a41  /lazytransform.A
+00000cc0: 7574 686f 723a 2052 616d 2053 6573 6861  uthor: Ram Sesha
+00000cd0: 6472 690a 4c69 6365 6e73 653a 2041 7061  dri.License: Apa
+00000ce0: 6368 6520 4c69 6365 6e73 6520 322e 300a  che License 2.0.
+00000cf0: 4465 7363 7269 7074 696f 6e3a 2023 206c  Description: # l
+00000d00: 617a 7974 7261 6e73 666f 726d 0a20 2020  azytransform.   
+00000d10: 2020 2020 2041 7574 6f6d 6174 6963 616c       Automatical
+00000d20: 6c79 2074 7261 6e73 666f 726d 2061 6c6c  ly transform all
+00000d30: 2063 6174 6567 6f72 6963 616c 2c20 6461   categorical, da
+00000d40: 7465 2d74 696d 652c 204e 4c50 2076 6172  te-time, NLP var
+00000d50: 6961 626c 6573 2069 6e20 796f 7572 2064  iables in your d
+00000d60: 6174 6120 7365 7420 746f 206e 756d 6572  ata set to numer
+00000d70: 6963 2069 6e20 6120 7369 6e67 6c65 206c  ic in a single l
+00000d80: 696e 6520 6f66 2063 6f64 6520 666f 7220  ine of code for 
+00000d90: 616e 7920 6461 7461 2073 6574 2061 6e79  any data set any
+00000da0: 2073 697a 652e 0a20 2020 2020 2020 200a   size..        .
+00000db0: 2020 2020 2020 2020 2323 2055 7064 6174          ## Updat
+00000dc0: 6520 2841 7567 2032 3032 3229 0a20 2020  e (Aug 2022).   
+00000dd0: 2020 2020 203c 6f6c 3e0a 2020 2020 2020       <ol>.      
+00000de0: 2020 3c6c 693e 3c62 3e6c 617a 7974 7261    <li><b>lazytra
+00000df0: 6e73 666f 726d 2069 7320 7665 7279 2065  nsform is very e
+00000e00: 6173 7920 746f 2069 6e73 7461 6c6c 206f  asy to install o
+00000e10: 6e20 4b61 6767 6c65 2061 6e64 2043 6f6c  n Kaggle and Col
+00000e20: 6162 206e 6f74 6562 6f6f 6b73 2075 7369  ab notebooks usi
+00000e30: 6e67 2074 6869 7320 636f 6d6d 616e 643a  ng this command:
+00000e40: 3c2f 623e 2e20 0a20 2020 2020 2020 200a  </b>. .        .
+00000e50: 2020 2020 2020 2020 6060 600a 2020 2020          ```.    
+00000e60: 2020 2020 2170 6970 2069 6e73 7461 6c6c      !pip install
+00000e70: 206c 617a 7974 7261 6e73 666f 726d 202d   lazytransform -
+00000e80: 2d69 676e 6f72 652d 696e 7374 616c 6c65  -ignore-installe
+00000e90: 6420 2d2d 6e6f 2d63 6163 6865 202d 2d6e  d --no-cache --n
+00000ea0: 6f2d 6465 7073 0a20 2020 2020 2020 2060  o-deps.        `
+00000eb0: 6060 0a20 2020 2020 2020 203c 2f6c 693e  ``.        </li>
+00000ec0: 3c62 723e 0a20 2020 2020 2020 203c 6c69  <br>.        <li
+00000ed0: 3e3c 623e 6c61 7a79 7472 616e 7366 6f72  ><b>lazytransfor
+00000ee0: 6d20 6173 206f 6620 7665 7273 696f 6e20  m as of version 
+00000ef0: 302e 3931 2068 6173 2074 776f 2053 7570  0.91 has two Sup
+00000f00: 6572 204c 6561 726e 696e 6720 4f70 7469  er Learning Opti
+00000f10: 6d69 7a65 6420 2853 554c 4f29 2045 6e73  mized (SULO) Ens
+00000f20: 656d 626c 6573 206e 616d 6564 2022 5375  embles named "Su
+00000f30: 6c6f 436c 6173 7369 6669 6572 2220 616e  loClassifier" an
+00000f40: 6420 2253 756c 6f52 6567 7265 7373 6f72  d "SuloRegressor
+00000f50: 223c 2f62 3e2e 2054 6865 2065 7374 696d  "</b>. The estim
+00000f60: 6174 6f72 7320 6172 6520 226f 7074 696d  ators are "optim
+00000f70: 697a 6564 2220 696e 2074 6865 2073 656e  ized" in the sen
+00000f80: 7365 2074 6861 7420 796f 7520 6361 6e20  se that you can 
+00000f90: 7573 6520 7468 656d 2066 6f72 2061 6c6c  use them for all
+00000fa0: 206b 696e 6473 206f 6620 6d75 6c74 692d   kinds of multi-
+00000fb0: 6c61 6265 6c20 6d75 6c74 692d 636c 6173  label multi-clas
+00000fc0: 7320 616e 6420 496d 6261 6c61 6e63 6564  s and Imbalanced
+00000fd0: 2064 6174 6120 7365 7420 7072 6f62 6c65   data set proble
+00000fe0: 6d73 2077 6974 686f 7574 206e 6565 6469  ms without needi
+00000ff0: 6e67 2074 6f20 646f 2068 7970 6572 2d70  ng to do hyper-p
+00001000: 6172 616d 6574 6572 2074 756e 696e 6720  arameter tuning 
+00001010: 7769 7468 2047 7269 6453 6561 7263 6843  with GridSearchC
+00001020: 562e 2054 6865 7920 6172 6520 6275 696c  V. They are buil
+00001030: 7420 7573 696e 6720 6261 7369 6320 7363  t using basic sc
+00001040: 696b 6974 2d6c 6561 726e 2065 7374 696d  ikit-learn estim
+00001050: 6174 6f72 7320 616e 6420 6172 6520 7365  ators and are se
+00001060: 6c66 2d6f 7074 696d 697a 696e 6720 7369  lf-optimizing si
+00001070: 6e63 6520 7468 6579 2070 6572 666f 726d  nce they perform
+00001080: 2068 7970 6572 2d70 6172 616d 2074 756e   hyper-param tun
+00001090: 696e 6720 666f 7220 6561 6368 206b 696e  ing for each kin
+000010a0: 6420 6f66 2070 726f 626c 656d 2061 6e64  d of problem and
+000010b0: 2075 7365 2077 6569 6768 7473 2066 6f72   use weights for
+000010c0: 2065 6163 6820 636c 6173 7369 6669 6572   each classifier
+000010d0: 206f 7220 7265 6772 6573 736f 722c 2064   or regressor, d
+000010e0: 6966 6665 7265 6e74 2072 616e 646f 6d20  ifferent random 
+000010f0: 7365 6564 732c 2065 7463 2e20 746f 206d  seeds, etc. to m
+00001100: 616b 6520 7468 656d 2068 6967 686c 7920  ake them highly 
+00001110: 7065 7266 6f72 6d61 6e74 2e20 4f6e 2074  performant. On t
+00001120: 6f70 206f 6620 6974 2c20 7468 6579 2061  op of it, they a
+00001130: 7265 2066 756c 6c79 2073 6369 6b69 742d  re fully scikit-
+00001140: 6c65 6172 6e20 636f 6d70 6174 6962 6c65  learn compatible
+00001150: 2077 6974 6820 7468 6520 7361 6d65 2022   with the same "
+00001160: 6669 7420 616e 6420 7072 6564 6963 7422  fit and predict"
+00001170: 2073 796e 7461 782e 203c 2f6c 693e 0a20   syntax. </li>. 
+00001180: 2020 2020 2020 2054 616b 6520 6120 6c6f         Take a lo
+00001190: 6f6b 2061 7420 7468 6520 6265 6e63 686d  ok at the benchm
+000011a0: 6172 6b69 6e67 2072 6573 756c 7473 206e  arking results n
+000011b0: 6f74 6562 6f6f 6b20 6865 7265 2066 6f72  otebook here for
+000011c0: 2053 756c 6f43 6c61 7373 6966 6965 723a   SuloClassifier:
+000011d0: 200a 2020 2020 2020 2020 0a20 2020 2020   .        .     
+000011e0: 2020 2021 5b4e 6f74 6562 6f6f 6b5d 2868     ![Notebook](h
+000011f0: 7474 7073 3a2f 2f67 6974 6875 622e 636f  ttps://github.co
+00001200: 6d2f 4175 746f 5669 4d4c 2f6c 617a 7974  m/AutoViML/lazyt
+00001210: 7261 6e73 666f 726d 2f74 7265 652f 6d61  ransform/tree/ma
+00001220: 696e 2f6e 6f74 6562 6f6f 6b73 2f53 756c  in/notebooks/Sul
+00001230: 6f43 6c61 7373 6966 6965 725f 4265 6e63  oClassifier_Benc
+00001240: 686d 6172 6b69 6e67 5f52 6573 756c 7473  hmarking_Results
+00001250: 2e69 7079 6e62 290a 2020 2020 2020 2020  .ipynb).        
+00001260: 0a20 2020 2020 2020 2021 5b53 756c 6f43  .        ![SuloC
+00001270: 6c61 7373 6966 6965 725d 282e 2f69 6d61  lassifier](./ima
+00001280: 6765 732f 5375 6c6f 436c 6173 7369 6669  ges/SuloClassifi
+00001290: 6572 2e70 6e67 290a 2020 2020 2020 2020  er.png).        
+000012a0: 0a20 2020 2020 2020 2057 6520 7261 6e20  .        We ran 
+000012b0: 6120 7369 6d69 6c61 7220 6265 6e63 686d  a similar benchm
+000012c0: 6172 6b69 6e67 2072 6573 756c 7420 696e  arking result in
+000012d0: 2053 756c 6f52 6567 7265 7373 6f72 2061   SuloRegressor a
+000012e0: 6761 696e 7374 2058 4742 6f6f 7374 2061  gainst XGBoost a
+000012f0: 6e64 204c 6967 6874 4742 4d20 5265 6772  nd LightGBM Regr
+00001300: 6573 736f 7273 2061 6e64 2069 7420 6865  essors and it he
+00001310: 6c64 2069 7473 206f 776e 2061 6761 696e  ld its own again
+00001320: 7374 2074 6865 6d2e 2054 616b 6520 6120  st them. Take a 
+00001330: 6c6f 6f6b 2061 7420 7468 6520 6265 6e63  look at the benc
+00001340: 686d 6172 6b69 6e67 2072 6573 756c 743a  hmarking result:
+00001350: 0a20 2020 2020 2020 200a 2020 2020 2020  .        .      
+00001360: 2020 215b 4e6f 7465 626f 6f6b 5d28 6874    ![Notebook](ht
+00001370: 7470 733a 2f2f 6769 7468 7562 2e63 6f6d  tps://github.com
+00001380: 2f41 7574 6f56 694d 4c2f 6c61 7a79 7472  /AutoViML/lazytr
+00001390: 616e 7366 6f72 6d2f 7472 6565 2f6d 6169  ansform/tree/mai
+000013a0: 6e2f 6e6f 7465 626f 6f6b 732f 5375 6c6f  n/notebooks/Sulo
+000013b0: 5265 6772 6573 736f 725f 4265 6e63 686d  Regressor_Benchm
+000013c0: 6172 6b69 6e67 5f52 6573 756c 7473 2e69  arking_Results.i
+000013d0: 7079 6e62 290a 2020 2020 2020 2020 0a20  pynb).        . 
+000013e0: 2020 2020 2020 2021 5b53 756c 6f52 6567         ![SuloReg
+000013f0: 7265 7373 6f72 5d28 2e2f 696d 6167 6573  ressor](./images
+00001400: 2f53 756c 6f52 6567 7265 7373 6f72 2e70  /SuloRegressor.p
+00001410: 6e67 290a 2020 2020 2020 2020 0a20 2020  ng).        .   
+00001420: 2020 2020 2023 2054 6162 6c65 206f 6620       # Table of 
+00001430: 436f 6e74 656e 7473 0a20 2020 2020 2020  Contents.       
+00001440: 203c 756c 3e0a 2020 2020 2020 2020 3c6c   <ul>.        <l
+00001450: 693e 3c61 2068 7265 663d 2223 696e 7472  i><a href="#intr
+00001460: 6f64 7563 7469 6f6e 223e 5768 6174 2069  oduction">What i
+00001470: 7320 6c61 7a79 7472 616e 7366 6f72 6d3c  s lazytransform<
+00001480: 2f61 3e3c 2f6c 693e 0a20 2020 2020 2020  /a></li>.       
+00001490: 203c 6c69 3e3c 6120 6872 6566 3d22 2375   <li><a href="#u
+000014a0: 7365 7322 3e48 6f77 2074 6f20 7573 6520  ses">How to use 
+000014b0: 6c61 7a79 7472 616e 7366 6f72 6d3c 2f61  lazytransform</a
+000014c0: 3e3c 2f6c 693e 0a20 2020 2020 2020 203c  ></li>.        <
+000014d0: 6c69 3e3c 6120 6872 6566 3d22 2369 6e73  li><a href="#ins
+000014e0: 7461 6c6c 223e 486f 7720 746f 2069 6e73  tall">How to ins
+000014f0: 7461 6c6c 206c 617a 7974 7261 6e73 666f  tall lazytransfo
+00001500: 726d 3c2f 613e 3c2f 6c69 3e0a 2020 2020  rm</a></li>.    
+00001510: 2020 2020 3c6c 693e 3c61 2068 7265 663d      <li><a href=
+00001520: 2223 7573 6167 6522 3e55 7361 6765 3c2f  "#usage">Usage</
+00001530: 613e 3c2f 6c69 3e0a 2020 2020 2020 2020  a></li>.        
+00001540: 3c6c 693e 3c61 2068 7265 663d 2223 6170  <li><a href="#ap
+00001550: 6922 3e41 5049 3c2f 613e 3c2f 6c69 3e0a  i">API</a></li>.
+00001560: 2020 2020 2020 2020 3c6c 693e 3c61 2068          <li><a h
+00001570: 7265 663d 2223 6d61 696e 7461 696e 6572  ref="#maintainer
+00001580: 7322 3e4d 6169 6e74 6169 6e65 7273 3c2f  s">Maintainers</
+00001590: 613e 3c2f 6c69 3e0a 2020 2020 2020 2020  a></li>.        
+000015a0: 3c6c 693e 3c61 2068 7265 663d 2223 636f  <li><a href="#co
+000015b0: 6e74 7269 6275 7469 6e67 223e 436f 6e74  ntributing">Cont
+000015c0: 7269 6275 7469 6e67 3c2f 613e 3c2f 6c69  ributing</a></li
+000015d0: 3e0a 2020 2020 2020 2020 3c6c 693e 3c61  >.        <li><a
+000015e0: 2068 7265 663d 2223 6c69 6365 6e73 6522   href="#license"
+000015f0: 3e4c 6963 656e 7365 3c2f 613e 3c2f 6c69  >License</a></li
+00001600: 3e0a 2020 2020 2020 2020 3c2f 756c 3e0a  >.        </ul>.
+00001610: 2020 2020 2020 2020 3c70 3e0a 2020 2020          <p>.    
+00001620: 2020 2020 0a20 2020 2020 2020 2023 2320      .        ## 
+00001630: 496e 7472 6f64 7563 7469 6f6e 0a20 2020  Introduction.   
+00001640: 2020 2020 2023 2323 2057 6861 7420 6973       ### What is
+00001650: 206c 617a 7974 7261 6e73 666f 726d 3f0a   lazytransform?.
+00001660: 2020 2020 2020 2020 606c 617a 7974 7261          `lazytra
+00001670: 6e73 666f 726d 6020 6973 2061 206e 6577  nsform` is a new
+00001680: 2070 7974 686f 6e20 6c69 6272 6172 7920   python library 
+00001690: 666f 7220 6175 746f 6d61 7469 6361 6c6c  for automaticall
+000016a0: 7920 7472 616e 7366 6f72 6d69 6e67 2079  y transforming y
+000016b0: 6f75 7220 656e 7469 7265 2064 6174 6173  our entire datas
+000016c0: 6574 2074 6f20 6e75 6d65 7269 6320 666f  et to numeric fo
+000016d0: 726d 6174 2075 7369 6e67 2063 6174 6567  rmat using categ
+000016e0: 6f72 7920 656e 636f 6465 7273 2c20 4e4c  ory encoders, NL
+000016f0: 5020 7465 7874 2076 6563 746f 7269 7a65  P text vectorize
+00001700: 7273 2061 6e64 2070 616e 6461 7320 6461  rs and pandas da
+00001710: 7465 2074 696d 6520 7072 6f63 6573 7369  te time processi
+00001720: 6e67 2066 756e 6374 696f 6e73 2e20 416c  ng functions. Al
+00001730: 6c20 696e 2061 2073 696e 676c 6520 6c69  l in a single li
+00001740: 6e65 206f 6620 636f 6465 210a 2020 2020  ne of code!.    
+00001750: 2020 2020 0a20 2020 2020 2020 2021 5b6c      .        ![l
+00001760: 617a 7974 7261 6e73 666f 726d 6572 5d28  azytransformer](
+00001770: 2e2f 696d 6167 6573 2f6c 617a 7974 7261  ./images/lazytra
+00001780: 6e73 666f 726d 6572 2e6a 7067 290a 2020  nsformer.jpg).  
+00001790: 2020 2020 2020 0a20 2020 2020 2020 2023        .        #
+000017a0: 2320 5573 6573 0a20 2020 2020 2020 2060  # Uses.        `
+000017b0: 6c61 7a79 7472 616e 7366 6f72 6d60 2068  lazytransform` h
+000017c0: 6173 2074 776f 2069 6d70 6f72 7461 6e74  as two important
+000017d0: 2075 7365 7320 696e 2074 6865 2044 6174   uses in the Dat
+000017e0: 6120 5363 6965 6e63 6520 7072 6f63 6573  a Science proces
+000017f0: 732e 2049 7420 6361 6e20 6265 2075 7365  s. It can be use
+00001800: 6420 696e 2046 6561 7475 7265 2045 6e67  d in Feature Eng
+00001810: 6720 746f 2074 7261 6e73 666f 726d 2066  g to transform f
+00001820: 6561 7475 7265 7320 6f72 2061 6464 2066  eatures or add f
+00001830: 6561 7475 7265 7320 2873 6565 2041 5049  eatures (see API
+00001840: 2062 656c 6f77 292e 2049 7420 6361 6e20   below). It can 
+00001850: 616c 736f 2062 6520 7573 6564 2069 6e20  also be used in 
+00001860: 4d4c 4f70 7320 746f 2074 7261 696e 2061  MLOps to train a
+00001870: 6e64 2065 7661 6c75 6174 6520 6d6f 6465  nd evaluate mode
+00001880: 6c73 2069 6e20 6461 7461 2070 6970 656c  ls in data pipel
+00001890: 696e 6573 2077 6974 6820 6d75 6c74 6970  ines with multip
+000018a0: 6c65 206d 6f64 656c 7320 6265 696e 6720  le models being 
+000018b0: 7472 6169 6e65 6420 7369 6d75 6c74 616e  trained simultan
+000018c0: 6575 736c 7920 7573 696e 6720 7468 6520  eusly using the 
+000018d0: 7361 6d65 2074 7261 696e 2f74 6573 7420  same train/test 
+000018e0: 7370 6c69 7420 616e 6420 7468 6520 7361  split and the sa
+000018f0: 6d65 2066 6561 7475 7265 2065 6e67 6720  me feature engg 
+00001900: 7374 6570 732e 2054 6869 7320 656e 7375  steps. This ensu
+00001910: 7265 7320 7468 6174 2074 6865 7265 2069  res that there i
+00001920: 7320 6162 736f 6c75 7465 6c79 207a 6572  s absolutely zer
+00001930: 6f20 6f72 206d 696e 696d 616c 2064 6174  o or minimal dat
+00001940: 6120 6c65 616b 6167 6520 696e 2079 6f75  a leakage in you
+00001950: 7220 4d4c 4f70 7320 7069 7065 6c69 6e65  r MLOps pipeline
+00001960: 732e 0a20 2020 2020 2020 200a 2020 2020  s..        .    
+00001970: 2020 2020 2323 2320 312e 2020 5573 696e      ### 1.  Usin
+00001980: 6720 6c61 7a79 7472 616e 7366 6f72 6d20  g lazytransform 
+00001990: 6173 2061 2073 696d 706c 6520 7061 6e64  as a simple pand
+000019a0: 6173 2064 6174 6120 7472 616e 7366 6f72  as data transfor
+000019b0: 6d61 7469 6f6e 2070 6970 656c 696e 6520  mation pipeline 
+000019c0: 0a20 2020 2020 2020 200a 2020 2020 2020  .        .      
+000019d0: 2020 3c70 3e54 6865 2066 6972 7374 206d    <p>The first m
+000019e0: 6574 686f 6420 6973 2070 726f 6261 626c  ethod is probabl
+000019f0: 7920 7468 6520 6d6f 7374 2070 6f70 756c  y the most popul
+00001a00: 6172 2077 6179 2074 6f20 7573 6520 6c61  ar way to use la
+00001a10: 7a79 7472 616e 7366 6f72 6d2e 2054 6865  zytransform. The
+00001a20: 2074 7261 6e73 666f 726d 6572 2077 6974   transformer wit
+00001a30: 6869 6e20 6c61 7a79 7472 616e 7366 6f72  hin lazytransfor
+00001a40: 6d20 6361 6e20 6265 2075 7365 6420 746f  m can be used to
+00001a50: 2074 7261 6e73 666f 726d 2061 6e64 2063   transform and c
+00001a60: 7265 6174 6520 6e65 7720 6665 6174 7572  reate new featur
+00001a70: 6573 2066 726f 6d20 6361 7465 676f 7269  es from categori
+00001a80: 6361 6c2c 2064 6174 652d 7469 6d65 2061  cal, date-time a
+00001a90: 6e64 204e 4c50 2028 7465 7874 2920 6665  nd NLP (text) fe
+00001aa0: 6174 7572 6573 2069 6e20 796f 7572 2064  atures in your d
+00001ab0: 6174 6173 6574 2e20 5468 6973 2074 7261  ataset. This tra
+00001ac0: 6e73 666f 726d 6572 2070 6970 656c 696e  nsformer pipelin
+00001ad0: 6520 6973 2066 756c 6c79 2073 6369 6b69  e is fully sciki
+00001ae0: 742d 6c65 6172 6e20 5069 7065 6c69 6e65  t-learn Pipeline
+00001af0: 2063 6f6d 7061 7469 626c 6520 616e 6420   compatible and 
+00001b00: 6361 6e20 6265 2075 7365 6420 746f 2062  can be used to b
+00001b10: 7569 6c64 2065 7665 6e20 6d6f 7265 2063  uild even more c
+00001b20: 6f6d 706c 6578 2070 6970 656c 696e 6573  omplex pipelines
+00001b30: 2062 7920 796f 7520 6261 7365 6420 6f6e   by you based on
+00001b40: 2060 6d61 6b65 5f70 6970 656c 696e 6560   `make_pipeline`
+00001b50: 2073 7461 7465 6d65 6e74 2066 726f 6d20   statement from 
+00001b60: 6073 6b6c 6561 726e 2e70 6970 656c 696e  `sklearn.pipelin
+00001b70: 6560 206c 6962 7261 7279 2e20 3c61 2068  e` library. <a h
+00001b80: 7265 663d 2268 7474 7073 3a2f 2f67 6974  ref="https://git
+00001b90: 6875 622e 636f 6d2f 4175 746f 5669 4d4c  hub.com/AutoViML
+00001ba0: 2f6c 617a 7974 7261 6e73 666f 726d 2f62  /lazytransform/b
+00001bb0: 6c6f 622f 6d61 696e 2f46 6561 7475 7265  lob/main/Feature
+00001bc0: 7769 7a5f 4c61 7a79 5472 616e 7366 6f72  wiz_LazyTransfor
+00001bd0: 6d5f 4465 6d6f 312e 6970 796e 6222 3e4c  m_Demo1.ipynb">L
+00001be0: 6574 2075 7320 7365 6520 616e 2065 7861  et us see an exa
+00001bf0: 6d70 6c65 3c2f 613e 3a3c 703e 0a20 2020  mple</a>:<p>.   
+00001c00: 2020 2020 200a 2020 2020 2020 2020 3c61       .        <a
+00001c10: 2068 7265 663d 2268 7474 7073 3a2f 2f69   href="https://i
+00001c20: 6262 2e63 6f2f 7866 4d51 6e4e 7a22 3e3c  bb.co/xfMQnNz"><
+00001c30: 696d 6720 7372 633d 2268 7474 7073 3a2f  img src="https:/
+00001c40: 2f69 2e69 6262 2e63 6f2f 5a59 6843 5130  /i.ibb.co/ZYhCQ0
+00001c50: 632f 6c61 7a79 2d63 6f64 6531 2e70 6e67  c/lazy-code1.png
+00001c60: 2220 616c 743d 226c 617a 792d 636f 6465  " alt="lazy-code
+00001c70: 3122 2062 6f72 6465 723d 2230 223e 3c2f  1" border="0"></
+00001c80: 613e 0a20 2020 2020 2020 200a 2020 2020  a>.        .    
+00001c90: 2020 2020 2323 2320 322e 2020 5573 696e      ### 2.  Usin
+00001ca0: 6720 6c61 7a79 7472 616e 7366 6f72 6d20  g lazytransform 
+00001cb0: 6173 2061 2073 6b6c 6561 726e 2070 6970  as a sklearn pip
+00001cc0: 656c 696e 6520 7769 7468 2073 6b6c 6561  eline with sklea
+00001cd0: 726e 206d 6f64 656c 7320 6f72 2058 4742  rn models or XGB
+00001ce0: 6f6f 7374 206f 7220 4c69 6768 7447 424d  oost or LightGBM
+00001cf0: 206d 6f64 656c 730a 2020 2020 2020 2020   models.        
+00001d00: 0a20 2020 2020 2020 203c 703e 5468 6520  .        <p>The 
+00001d10: 7365 636f 6e64 206d 6574 686f 6420 6973  second method is
+00001d20: 2061 2067 7265 6174 2077 6179 2074 6f20   a great way to 
+00001d30: 6372 6561 7465 2061 6e20 656e 7469 7265  create an entire
+00001d40: 2064 6174 6120 7472 616e 7366 6f72 6d20   data transform 
+00001d50: 616e 6420 6d6f 6465 6c20 7472 6169 6e69  and model traini
+00001d60: 6e67 2070 6970 656c 696e 6520 7769 7468  ng pipeline with
+00001d70: 2061 6273 6f6c 7574 656c 7920 6e6f 2064   absolutely no d
+00001d80: 6174 6120 6c65 616b 6167 652e 2060 6c61  ata leakage. `la
+00001d90: 7a79 7472 616e 7366 6f72 6d60 2061 6c6c  zytransform` all
+00001da0: 6f77 7320 796f 7520 746f 2073 656e 6420  ows you to send 
+00001db0: 696e 2061 206d 6f64 656c 206f 626a 6563  in a model objec
+00001dc0: 7420 286f 6e6c 7920 7468 6520 666f 6c6c  t (only the foll
+00001dd0: 6f77 696e 6720 6172 6520 7375 7070 6f72  owing are suppor
+00001de0: 7465 6429 2061 6e64 2069 7420 7769 6c6c  ted) and it will
+00001df0: 2061 7574 6f6d 6174 6963 616c 6c79 2074   automatically t
+00001e00: 7261 6e73 666f 726d 2c20 6372 6561 7465  ransform, create
+00001e10: 206e 6577 2066 6561 7475 7265 7320 616e   new features an
+00001e20: 6420 7472 6169 6e20 6120 6d6f 6465 6c20  d train a model 
+00001e30: 7573 696e 6720 736b 6c65 6172 6e20 7069  using sklearn pi
+00001e40: 7065 6c69 6e65 732e 203c 6120 6872 6566  pelines. <a href
+00001e50: 3d22 6874 7470 733a 2f2f 6769 7468 7562  ="https://github
+00001e60: 2e63 6f6d 2f41 7574 6f56 694d 4c2f 6c61  .com/AutoViML/la
+00001e70: 7a79 7472 616e 7366 6f72 6d2f 626c 6f62  zytransform/blob
+00001e80: 2f6d 6169 6e2f 4665 6174 7572 6577 697a  /main/Featurewiz
+00001e90: 5f4c 617a 7954 7261 6e73 666f 726d 5f44  _LazyTransform_D
+00001ea0: 656d 6f32 2e69 7079 6e62 223e 5468 6973  emo2.ipynb">This
+00001eb0: 206d 6574 686f 6420 6361 6e20 6265 2073   method can be s
+00001ec0: 6565 6e20 6173 2066 6f6c 6c6f 7773 3c2f  een as follows</
+00001ed0: 613e 3a3c 6272 3e0a 2020 2020 2020 2020  a>:<br>.        
+00001ee0: 0a20 2020 2020 2020 203c 6120 6872 6566  .        <a href
+00001ef0: 3d22 6874 7470 733a 2f2f 6962 622e 636f  ="https://ibb.co
+00001f00: 2f54 3157 4e68 7a54 223e 3c69 6d67 2073  /T1WNhzT"><img s
+00001f10: 7263 3d22 6874 7470 733a 2f2f 692e 6962  rc="https://i.ib
+00001f20: 622e 636f 2f30 4b73 7a4a 5058 2f6c 617a  b.co/0KszJPX/laz
+00001f30: 792d 636f 6465 322e 706e 6722 2061 6c74  y-code2.png" alt
+00001f40: 3d22 6c61 7a79 2d63 6f64 6532 2220 626f  ="lazy-code2" bo
+00001f50: 7264 6572 3d22 3022 3e3c 2f61 3e0a 2020  rder="0"></a>.  
+00001f60: 2020 2020 2020 0a20 2020 2020 2020 2023        .        #
+00001f70: 2323 2033 2e20 2055 7369 6e67 206c 617a  ## 3.  Using laz
+00001f80: 7974 7261 6e73 666f 726d 2069 6e20 4772  ytransform in Gr
+00001f90: 6964 5365 6172 6368 4356 2074 6f20 6669  idSearchCV to fi
+00001fa0: 6e64 2074 6865 2062 6573 7420 6d6f 6465  nd the best mode
+00001fb0: 6c20 7069 7065 6c69 6e65 0a20 2020 2020  l pipeline.     
+00001fc0: 2020 203c 703e 5468 6520 7468 6972 6420     <p>The third 
+00001fd0: 6d65 7468 6f64 2069 7320 6120 6772 6561  method is a grea
+00001fe0: 7420 7761 7920 746f 2066 696e 6420 7468  t way to find th
+00001ff0: 6520 6265 7374 2064 6174 6120 7472 616e  e best data tran
+00002000: 7366 6f72 6d61 7469 6f6e 2061 6e64 206d  sformation and m
+00002010: 6f64 656c 2074 7261 696e 696e 6720 7069  odel training pi
+00002020: 7065 6c69 6e65 2075 7369 6e67 2047 7269  peline using Gri
+00002030: 6453 6561 7263 6843 5620 6f72 2052 616e  dSearchCV or Ran
+00002040: 646f 6d69 7a65 6453 6561 7263 6843 5620  domizedSearchCV 
+00002050: 616c 6f6e 6720 7769 7468 2061 204c 6967  along with a Lig
+00002060: 6874 4742 4d20 6f72 2058 4742 6f6f 7374  htGBM or XGBoost
+00002070: 206f 7220 7363 696b 6974 2d6c 6561 726e   or scikit-learn
+00002080: 206d 6f64 656c 2e20 5468 6973 2069 7320   model. This is 
+00002090: 6578 706c 6169 6e65 6420 7665 7279 2063  explained very c
+000020a0: 6c65 6172 6c79 2069 6e20 7468 6520 3c61  learly in the <a
+000020b0: 2068 7265 663d 2268 7474 7073 3a2f 2f67   href="https://g
+000020c0: 6974 6875 622e 636f 6d2f 4175 746f 5669  ithub.com/AutoVi
+000020d0: 4d4c 2f6c 617a 7974 7261 6e73 666f 726d  ML/lazytransform
+000020e0: 2f62 6c6f 622f 6d61 696e 2f4c 617a 7954  /blob/main/LazyT
+000020f0: 7261 6e73 666f 726d 6572 5f77 6974 685f  ransformer_with_
+00002100: 4772 6964 5365 6172 6368 5f50 6970 656c  GridSearch_Pipel
+00002110: 696e 652e 6970 796e 6222 3e4c 617a 7954  ine.ipynb">LazyT
+00002120: 7261 6e73 666f 726d 6572 5f77 6974 685f  ransformer_with_
+00002130: 4772 6964 5365 6172 6368 5f50 6970 656c  GridSearch_Pipel
+00002140: 696e 652e 6970 796e 623c 2f61 3e20 6e6f  ine.ipynb</a> no
+00002150: 7465 626f 6f6b 2069 6e20 7468 6520 7361  tebook in the sa
+00002160: 6d65 2067 6974 6875 6220 6865 7265 2e20  me github here. 
+00002170: 4d61 6b65 2073 7572 6520 796f 7520 6368  Make sure you ch
+00002180: 6563 6b20 6974 206f 7574 210a 2020 2020  eck it out!.    
+00002190: 2020 2020 0a20 2020 2020 2020 203c 6120      .        <a 
+000021a0: 6872 6566 3d22 6874 7470 733a 2f2f 6962  href="https://ib
+000021b0: 622e 636f 2f57 4776 6e71 6a73 223e 3c69  b.co/WGvnqjs"><i
+000021c0: 6d67 2073 7263 3d22 6874 7470 733a 2f2f  mg src="https://
+000021d0: 692e 6962 622e 636f 2f78 5871 6850 6433  i.ibb.co/xXqhPd3
+000021e0: 2f6c 617a 792d 6772 6964 7365 6172 6368  /lazy-gridsearch
+000021f0: 2e70 6e67 2220 616c 743d 226c 617a 792d  .png" alt="lazy-
+00002200: 6772 6964 7365 6172 6368 2220 626f 7264  gridsearch" bord
+00002210: 6572 3d22 3022 3e3c 2f61 3e3c 6272 202f  er="0"></a><br /
+00002220: 3e0a 2020 2020 2020 2020 0a20 2020 2020  >.        .     
+00002230: 2020 203c 703e 0a20 2020 2020 2020 2054     <p>.        T
+00002240: 6865 2066 6f6c 6c6f 7769 6e67 206d 6f64  he following mod
+00002250: 656c 7320 6172 6520 6375 7272 656e 746c  els are currentl
+00002260: 7920 7375 7070 6f72 7465 643a 0a20 2020  y supported:.   
+00002270: 2020 2020 203c 6f6c 3e0a 2020 2020 2020       <ol>.      
+00002280: 2020 3c6c 693e 416c 6c20 736b 6c65 6172    <li>All sklear
+00002290: 6e20 6d6f 6465 6c73 3c2f 6c69 3e0a 2020  n models</li>.  
+000022a0: 2020 2020 2020 3c6c 693e 416c 6c20 4d75        <li>All Mu
+000022b0: 6c74 694f 7574 7075 7420 6d6f 6465 6c73  ltiOutput models
+000022c0: 2066 726f 6d20 736b 6c65 6172 6e2e 6d75   from sklearn.mu
+000022d0: 6c74 696f 7574 7075 7420 6c69 6272 6172  ltioutput librar
+000022e0: 793c 2f6c 693e 0a20 2020 2020 2020 203c  y</li>.        <
+000022f0: 6c69 3e58 4762 6f6f 7374 206d 6f64 656c  li>XGboost model
+00002300: 733c 2f6c 693e 0a20 2020 2020 2020 203c  s</li>.        <
+00002310: 6c69 3e4c 6967 6874 4742 4d20 6d6f 6465  li>LightGBM mode
+00002320: 6c73 3c2f 6c69 3e0a 2020 2020 2020 2020  ls</li>.        
+00002330: 3c2f 6f6c 3e0a 2020 2020 2020 2020 486f  </ol>.        Ho
+00002340: 7765 7665 722c 2079 6f75 206d 7573 7420  wever, you must 
+00002350: 696e 7374 616c 6c20 616e 6420 696d 706f  install and impo
+00002360: 7274 2074 686f 7365 206d 6f64 656c 7320  rt those models 
+00002370: 6f6e 2079 6f75 7220 6f77 6e20 616e 6420  on your own and 
+00002380: 6465 6669 6e65 2074 6865 6d20 6173 206d  define them as m
+00002390: 6f64 656c 2076 6172 6961 626c 6573 2062  odel variables b
+000023a0: 6566 6f72 6520 7061 7373 696e 6720 7468  efore passing th
+000023b0: 6f73 6520 7661 7269 6162 6c65 7320 746f  ose variables to
+000023c0: 206c 617a 7974 7261 6e73 666f 726d 2e0a   lazytransform..
+000023d0: 2020 2020 2020 2020 0a20 2020 2020 2020          .       
+000023e0: 2023 2320 496e 7374 616c 6c0a 2020 2020   ## Install.    
+000023f0: 2020 2020 3c70 3e0a 2020 2020 2020 2020      <p>.        
+00002400: 0a20 2020 2020 2020 202a 2a50 7265 7265  .        **Prere
+00002410: 7175 7369 7465 733a 2a2a 0a20 2020 2020  qusites:**.     
+00002420: 2020 203c 6f6c 3e0a 2020 2020 2020 2020     <ol>.        
+00002430: 3c6c 693e 3c62 3e6c 617a 7974 7261 6e73  <li><b>lazytrans
+00002440: 666f 726d 2069 7320 6275 696c 7420 7573  form is built us
+00002450: 696e 6720 7061 6e64 6173 2c20 6e75 6d70  ing pandas, nump
+00002460: 792c 2073 6369 6b69 742d 6c65 6172 6e2c  y, scikit-learn,
+00002470: 2063 6174 6567 6f72 795f 656e 636f 6465   category_encode
+00002480: 7273 2061 6e64 2069 6d62 616c 616e 6365  rs and imbalance
+00002490: 642d 6c65 6172 6e20 6c69 6272 6172 6965  d-learn librarie
+000024a0: 732e 3c2f 623e 2049 7420 7368 6f75 6c64  s.</b> It should
+000024b0: 2072 756e 206f 6e20 6d6f 7374 2050 7974   run on most Pyt
+000024c0: 686f 6e33 2041 6e61 636f 6e64 6120 696e  hon3 Anaconda in
+000024d0: 7374 616c 6c61 7469 6f6e 7320 7769 7468  stallations with
+000024e0: 6f75 7420 6164 6469 7469 6f6e 616c 2069  out additional i
+000024f0: 6e73 7461 6c6c 732e 2059 6f75 2077 6f6e  nstalls. You won
+00002500: 2774 2068 6176 6520 746f 2069 6d70 6f72  't have to impor
+00002510: 7420 616e 7920 7370 6563 6961 6c20 6c69  t any special li
+00002520: 6272 6172 6965 7320 6f74 6865 7220 7468  braries other th
+00002530: 616e 2022 696d 6261 6c61 6e63 6564 2d6c  an "imbalanced-l
+00002540: 6561 726e 2220 616e 6420 2263 6174 6567  earn" and "categ
+00002550: 6f72 795f 656e 636f 6465 7273 222e 3c2f  ory_encoders".</
+00002560: 6c69 3e0a 2020 2020 2020 2020 3c2f 6f6c  li>.        </ol
+00002570: 3e0a 2020 2020 2020 2020 5468 6520 6265  >.        The be
+00002580: 7374 206d 6574 686f 6420 746f 2069 6e73  st method to ins
+00002590: 7461 6c6c 206c 617a 7974 7261 6e73 666f  tall lazytransfo
+000025a0: 726d 2069 7320 746f 2075 7365 2063 6f6e  rm is to use con
+000025b0: 6461 3a3c 703e 0a20 2020 2020 2020 200a  da:<p>.        .
+000025c0: 2020 2020 2020 2020 6060 600a 2020 2020          ```.    
+000025d0: 2020 2020 636f 6e64 6120 696e 7374 616c      conda instal
+000025e0: 6c20 2d63 2063 6f6e 6461 2d66 6f72 6765  l -c conda-forge
+000025f0: 206c 617a 7974 7261 6e73 666f 726d 0a20   lazytransform. 
+00002600: 2020 2020 2020 2060 6060 0a20 2020 2020         ```.     
+00002610: 2020 203c 6120 6872 6566 3d22 6874 7470     <a href="http
+00002620: 733a 2f2f 6962 622e 636f 2f66 586e 6250  s://ibb.co/fXnbP
+00002630: 6436 223e 3c69 6d67 2073 7263 3d22 6874  d6"><img src="ht
+00002640: 7470 733a 2f2f 692e 6962 622e 636f 2f71  tps://i.ibb.co/q
+00002650: 4457 7a50 5971 2f63 6f6e 6461 2d69 6e73  DWzPYq/conda-ins
+00002660: 7461 6c6c 2e70 6e67 2220 616c 743d 2263  tall.png" alt="c
+00002670: 6f6e 6461 2d69 6e73 7461 6c6c 2220 626f  onda-install" bo
+00002680: 7264 6572 3d22 3022 3e3c 2f61 3e3c 6272  rder="0"></a><br
+00002690: 3e0a 2020 2020 2020 2020 5468 6520 7365  >.        The se
+000026a0: 636f 6e64 2062 6573 7420 696e 7374 616c  cond best instal
+000026b0: 6c61 7469 6f6e 206d 6574 686f 6420 6973  lation method is
+000026c0: 2074 6f20 7573 6520 2270 6970 2069 6e73   to use "pip ins
+000026d0: 7461 6c6c 222e 0a20 2020 2020 2020 200a  tall"..        .
+000026e0: 2020 2020 2020 2020 6060 600a 2020 2020          ```.    
+000026f0: 2020 2020 7069 7020 696e 7374 616c 6c20      pip install 
+00002700: 6c61 7a79 7472 616e 7366 6f72 6d20 0a20  lazytransform . 
+00002710: 2020 2020 2020 2060 6060 0a20 2020 2020         ```.     
+00002720: 2020 2041 6c65 7274 2120 5768 656e 2075     Alert! When u
+00002730: 7369 6e67 2043 6f6c 6162 206f 7220 4b61  sing Colab or Ka
+00002740: 6767 6c65 204e 6f74 6562 6f6f 6b73 2c20  ggle Notebooks, 
+00002750: 796f 7520 6d75 7374 2075 7365 2061 2073  you must use a s
+00002760: 6c69 6768 746c 7920 6d6f 6469 6679 2069  lightly modify i
+00002770: 6e73 7461 6c6c 6174 696f 6e20 7072 6f63  nstallation proc
+00002780: 6573 7320 6265 6c6f 772e 2049 6620 796f  ess below. If yo
+00002790: 7520 646f 6e27 7420 646f 2074 6869 732c  u don't do this,
+000027a0: 2079 6f75 2077 696c 6c20 6765 7420 7765   you will get we
+000027b0: 6972 6420 6572 726f 7273 2069 6e20 7468  ird errors in th
+000027c0: 6f73 6520 706c 6174 666f 726d 7321 0a20  ose platforms!. 
+000027d0: 2020 2020 2020 200a 2020 2020 2020 2020         .        
+000027e0: 6060 600a 2020 2020 2020 2020 7069 7020  ```.        pip 
+000027f0: 696e 7374 616c 6c20 6c61 7a79 7472 616e  install lazytran
+00002800: 7366 6f72 6d20 2d2d 6967 6e6f 7265 2d69  sform --ignore-i
+00002810: 6e73 7461 6c6c 6564 202d 2d6e 6f2d 6465  nstalled --no-de
+00002820: 7073 0a20 2020 2020 2020 2070 6970 2069  ps.        pip i
+00002830: 6e73 7461 6c6c 2063 6174 6567 6f72 792d  nstall category-
+00002840: 656e 636f 6465 7273 202d 2d69 676e 6f72  encoders --ignor
+00002850: 652d 696e 7374 616c 6c65 6420 2d2d 6e6f  e-installed --no
+00002860: 2d64 6570 730a 2020 2020 2020 2020 0a20  -deps.        . 
+00002870: 2020 2020 2020 2060 6060 0a20 2020 2020         ```.     
+00002880: 2020 200a 2020 2020 2020 2020 546f 2069     .        To i
+00002890: 6e73 7461 6c6c 2066 726f 6d20 736f 7572  nstall from sour
+000028a0: 6365 3a0a 2020 2020 2020 2020 0a20 2020  ce:.        .   
+000028b0: 2020 2020 2060 6060 0a20 2020 2020 2020       ```.       
+000028c0: 2063 6420 3c6c 617a 7974 7261 6e73 666f   cd <lazytransfo
+000028d0: 726d 5f44 6573 7469 6e61 7469 6f6e 3e0a  rm_Destination>.
+000028e0: 2020 2020 2020 2020 6769 7420 636c 6f6e          git clon
+000028f0: 6520 6769 7440 6769 7468 7562 2e63 6f6d  e git@github.com
+00002900: 3a41 7574 6f56 694d 4c2f 6c61 7a79 7472  :AutoViML/lazytr
+00002910: 616e 7366 6f72 6d2e 6769 740a 2020 2020  ansform.git.    
+00002920: 2020 2020 6060 600a 2020 2020 2020 2020      ```.        
+00002930: 6f72 2064 6f77 6e6c 6f61 6420 616e 6420  or download and 
+00002940: 756e 7a69 7020 6874 7470 733a 2f2f 6769  unzip https://gi
+00002950: 7468 7562 2e63 6f6d 2f41 7574 6f56 694d  thub.com/AutoViM
+00002960: 4c2f 6c61 7a79 7472 616e 7366 6f72 6d2f  L/lazytransform/
+00002970: 6172 6368 6976 652f 6d61 7374 6572 2e7a  archive/master.z
+00002980: 6970 0a20 2020 2020 2020 2060 6060 0a20  ip.        ```. 
+00002990: 2020 2020 2020 2063 6f6e 6461 2063 7265         conda cre
+000029a0: 6174 6520 2d6e 203c 796f 7572 5f65 6e76  ate -n <your_env
+000029b0: 5f6e 616d 653e 2070 7974 686f 6e3d 332e  _name> python=3.
+000029c0: 3720 616e 6163 6f6e 6461 0a20 2020 2020  7 anaconda.     
+000029d0: 2020 2063 6f6e 6461 2061 6374 6976 6174     conda activat
+000029e0: 6520 3c79 6f75 725f 656e 765f 6e61 6d65  e <your_env_name
+000029f0: 3e20 2320 4f4e 2057 494e 444f 5753 3a20  > # ON WINDOWS: 
+00002a00: 6073 6f75 7263 6520 6163 7469 7661 7465  `source activate
+00002a10: 203c 796f 7572 5f65 6e76 5f6e 616d 653e   <your_env_name>
+00002a20: 600a 2020 2020 2020 2020 6364 206c 617a  `.        cd laz
+00002a30: 7974 7261 6e73 666f 726d 0a20 2020 2020  ytransform.     
+00002a40: 2020 2070 6970 2069 6e73 7461 6c6c 202d     pip install -
+00002a50: 7220 7265 7175 6972 656d 656e 7473 2e74  r requirements.t
+00002a60: 7874 0a20 2020 2020 2020 2060 6060 0a20  xt.        ```. 
+00002a70: 2020 2020 2020 200a 2020 2020 2020 2020         .        
+00002a80: 2323 2055 7361 6765 0a20 2020 2020 2020  ## Usage.       
+00002a90: 203c 703e 0a20 2020 2020 2020 2059 6f75   <p>.        You
+00002aa0: 2063 616e 2069 6e76 6f6b 6520 606c 617a   can invoke `laz
+00002ab0: 7974 7261 6e73 666f 726d 6020 6173 2061  ytransform` as a
+00002ac0: 2073 6369 6b69 742d 6c65 6172 6e20 636f   scikit-learn co
+00002ad0: 6d70 6174 6962 6c65 2066 6974 2061 6e64  mpatible fit and
+00002ae0: 2074 7261 6e73 666f 726d 206f 7220 6120   transform or a 
+00002af0: 6669 7420 616e 6420 7072 6564 6963 7420  fit and predict 
+00002b00: 7069 7065 6c69 6e65 2e20 5365 6520 7379  pipeline. See sy
+00002b10: 6e74 6178 2062 656c 6f77 2e3c 703e 0a20  ntax below.<p>. 
+00002b20: 2020 2020 2020 200a 2020 2020 2020 2020         .        
+00002b30: 6060 600a 2020 2020 2020 2020 6672 6f6d  ```.        from
+00002b40: 206c 617a 7974 7261 6e73 666f 726d 2069   lazytransform i
+00002b50: 6d70 6f72 7420 4c61 7a79 5472 616e 7366  mport LazyTransf
+00002b60: 6f72 6d65 720a 2020 2020 2020 2020 6c61  ormer.        la
+00002b70: 7a79 203d 204c 617a 7954 7261 6e73 666f  zy = LazyTransfo
+00002b80: 726d 6572 286d 6f64 656c 3d4e 6f6e 652c  rmer(model=None,
+00002b90: 2065 6e63 6f64 6572 733d 2761 7574 6f27   encoders='auto'
+00002ba0: 2c20 7363 616c 6572 733d 4e6f 6e65 2c20  , scalers=None, 
+00002bb0: 0a20 2020 2020 2020 2020 2020 2020 2020  .               
+00002bc0: 2064 6174 655f 746f 5f73 7472 696e 673d   date_to_string=
+00002bd0: 4661 6c73 652c 2074 7261 6e73 666f 726d  False, transform
+00002be0: 5f74 6172 6765 743d 4661 6c73 652c 2069  _target=False, i
+00002bf0: 6d62 616c 616e 6365 643d 4661 6c73 652c  mbalanced=False,
+00002c00: 0a20 2020 2020 2020 2020 2020 2020 2020  .               
+00002c10: 2063 6f6d 6269 6e65 5f72 6172 653d 4661   combine_rare=Fa
+00002c20: 6c73 652c 2076 6572 626f 7365 3d30 290a  lse, verbose=0).
+00002c30: 2020 2020 2020 2020 6060 600a 2020 2020          ```.    
+00002c40: 2020 2020 0a20 2020 2020 2020 2023 2323      .        ###
+00002c50: 2069 6620 796f 7520 6172 6520 6e6f 7420   if you are not 
+00002c60: 7573 696e 6720 6120 6d6f 6465 6c20 696e  using a model in
+00002c70: 2070 6970 656c 696e 652c 2079 6f75 206d   pipeline, you m
+00002c80: 7573 7420 7573 6520 6669 7420 616e 6420  ust use fit and 
+00002c90: 7472 616e 7366 6f72 6d0a 2020 2020 2020  transform.      
+00002ca0: 2020 6060 600a 2020 2020 2020 2020 585f    ```.        X_
+00002cb0: 7472 6169 6e6d 2c20 795f 7472 6169 6e6d  trainm, y_trainm
+00002cc0: 203d 206c 617a 792e 6669 745f 7472 616e   = lazy.fit_tran
+00002cd0: 7366 6f72 6d28 585f 7472 6169 6e2c 2079  sform(X_train, y
+00002ce0: 5f74 7261 696e 290a 2020 2020 2020 2020  _train).        
+00002cf0: 585f 7465 7374 6d20 3d20 6c61 7a79 2e74  X_testm = lazy.t
+00002d00: 7261 6e73 666f 726d 2858 5f74 6573 7429  ransform(X_test)
+00002d10: 0a20 2020 2020 2020 2060 6060 0a20 2020  .        ```.   
+00002d20: 2020 2020 2023 2323 2049 6620 796f 7520       ### If you 
+00002d30: 6172 6520 7573 696e 6720 6120 6d6f 6465  are using a mode
+00002d40: 6c20 696e 2070 6970 656c 696e 652c 2075  l in pipeline, u
+00002d50: 7365 206d 7573 7420 7573 6520 6669 7420  se must use fit 
+00002d60: 616e 6420 7072 6564 6963 7420 6f6e 6c79  and predict only
+00002d70: 0a20 2020 2020 2020 2060 6060 0a20 2020  .        ```.   
+00002d80: 2020 2020 206c 617a 7920 3d20 4c61 7a79       lazy = Lazy
+00002d90: 5472 616e 7366 6f72 6d65 7228 6d6f 6465  Transformer(mode
+00002da0: 6c3d 5261 6e64 6f6d 466f 7265 7374 436c  l=RandomForestCl
+00002db0: 6173 7369 6669 6572 2829 2c20 656e 636f  assifier(), enco
+00002dc0: 6465 7273 3d27 6175 746f 272c 2073 6361  ders='auto', sca
+00002dd0: 6c65 7273 3d4e 6f6e 652c 200a 2020 2020  lers=None, .    
+00002de0: 2020 2020 2020 2020 2020 2020 6461 7465              date
+00002df0: 5f74 6f5f 7374 7269 6e67 3d46 616c 7365  _to_string=False
+00002e00: 2c20 7472 616e 7366 6f72 6d5f 7461 7267  , transform_targ
+00002e10: 6574 3d46 616c 7365 2c20 696d 6261 6c61  et=False, imbala
+00002e20: 6e63 6564 3d46 616c 7365 2c0a 2020 2020  nced=False,.    
+00002e30: 2020 2020 2020 2020 2020 2020 636f 6d62              comb
+00002e40: 696e 655f 7261 7265 3d46 616c 7365 2c20  ine_rare=False, 
+00002e50: 7665 7262 6f73 653d 3029 0a20 2020 2020  verbose=0).     
+00002e60: 2020 2060 6060 0a20 2020 2020 2020 200a     ```.        .
+00002e70: 2020 2020 2020 2020 6060 600a 2020 2020          ```.    
+00002e80: 2020 2020 6c61 7a79 2e66 6974 2858 5f74      lazy.fit(X_t
+00002e90: 7261 696e 2c20 795f 7472 6169 6e29 0a20  rain, y_train). 
+00002ea0: 2020 2020 2020 206c 617a 792e 7072 6564         lazy.pred
+00002eb0: 6963 7428 585f 7465 7374 290a 2020 2020  ict(X_test).    
+00002ec0: 2020 2020 6060 600a 2020 2020 2020 2020      ```.        
+00002ed0: 0a20 2020 2020 2020 2023 2320 4150 490a  .        ## API.
+00002ee0: 2020 2020 2020 2020 0a20 2020 2020 2020          .       
+00002ef0: 203c 703e 0a20 2020 2020 2020 206c 617a   <p>.        laz
+00002f00: 7974 7261 6e73 666f 726d 2068 6173 2061  ytransform has a
+00002f10: 2076 6572 7920 7369 6d70 6c65 2041 5049   very simple API
+00002f20: 2077 6974 6820 7468 6520 666f 6c6c 6f77   with the follow
+00002f30: 696e 6720 696e 7075 7473 2e20 596f 7520  ing inputs. You 
+00002f40: 6e65 6564 2074 6f20 6372 6561 7465 2061  need to create a
+00002f50: 2073 6b6c 6561 726e 2d63 6f6d 7061 7469   sklearn-compati
+00002f60: 626c 6520 7472 616e 7366 6f72 6d65 7220  ble transformer 
+00002f70: 7069 7065 6c69 6e65 206f 626a 6563 7420  pipeline object 
+00002f80: 6279 2069 6d70 6f72 7469 6e67 204c 617a  by importing Laz
+00002f90: 7954 7261 6e73 666f 726d 6572 2066 726f  yTransformer fro
+00002fa0: 6d20 6c61 7a79 7472 616e 7366 6f72 6d20  m lazytransform 
+00002fb0: 6c69 6272 6172 792e 203c 703e 0a20 2020  library. <p>.   
+00002fc0: 2020 2020 204f 6e63 6520 796f 7520 696d       Once you im
+00002fd0: 706f 7274 2069 742c 2079 6f75 2063 616e  port it, you can
+00002fe0: 2064 6566 696e 6520 7468 6520 6f62 6a65   define the obje
+00002ff0: 6374 2062 7920 6769 7669 6e67 2073 6576  ct by giving sev
+00003000: 6572 616c 206f 7074 696f 6e73 2073 7563  eral options suc
+00003010: 6820 6173 3a0a 2020 2020 2020 2020 0a20  h as:.        . 
+00003020: 2020 2020 2020 202a 2a41 7267 756d 656e         **Argumen
+00003030: 7473 2a2a 0a20 2020 2020 2020 200a 2020  ts**.        .  
+00003040: 2020 2020 2020 3c62 3e43 6175 7469 6f6e        <b>Caution
+00003050: 3a3c 2f62 3e20 585f 7472 6169 6e20 616e  :</b> X_train an
+00003060: 6420 795f 7472 6169 6e20 6d75 7374 2062  d y_train must b
+00003070: 6520 7061 6e64 6173 2044 6174 6166 7261  e pandas Datafra
+00003080: 6d65 7320 6f72 2070 616e 6461 7320 5365  mes or pandas Se
+00003090: 7269 6573 2e20 444f 204e 4f54 2073 656e  ries. DO NOT sen
+000030a0: 6420 696e 206e 756d 7079 2061 7272 6179  d in numpy array
+000030b0: 732e 2054 6865 7920 776f 6e27 7420 776f  s. They won't wo
+000030c0: 726b 2e0a 2020 2020 2020 2020 0a20 2020  rk..        .   
+000030d0: 2020 2020 202d 2060 6d6f 6465 6c60 3a20       - `model`: 
+000030e0: 6465 6661 756c 7420 6973 204e 6f6e 652e  default is None.
+000030f0: 204f 7220 6974 2063 6f75 6c64 2062 6520   Or it could be 
+00003100: 616e 7920 7363 696b 6974 2d6c 6561 726e  any scikit-learn
+00003110: 206d 6f64 656c 2028 696e 636c 7564 696e   model (includin
+00003120: 6720 6d75 6c74 696f 7574 7075 7420 6d6f  g multioutput mo
+00003130: 6465 6c73 2920 6173 2077 656c 6c20 6173  dels) as well as
+00003140: 2074 6865 2070 6f70 756c 6172 2058 4742   the popular XGB
+00003150: 6f6f 7374 2061 6e64 204c 6967 6874 4742  oost and LightGB
+00003160: 4d20 6c69 6272 6172 6965 732e 2059 6f75  M libraries. You
+00003170: 206e 6565 6420 746f 2069 6e73 7461 6c6c   need to install
+00003180: 2074 686f 7365 206c 6962 7261 7269 6573   those libraries
+00003190: 2069 6620 796f 7520 7761 6e74 2074 6f20   if you want to 
+000031a0: 7573 6520 7468 656d 2e0a 2020 2020 2020  use them..      
+000031b0: 2020 2d20 6065 6e63 6f64 6572 7360 3a20    - `encoders`: 
+000031c0: 636f 756c 6420 6265 206f 6e65 206d 6f72  could be one mor
+000031d0: 6520 656e 636f 6465 7273 2069 6e20 6120  e encoders in a 
+000031e0: 7374 7269 6e67 206f 7220 6120 6c69 7374  string or a list
+000031f0: 2e20 4561 6368 2065 6e63 6f64 6572 2073  . Each encoder s
+00003200: 7472 696e 6720 6361 6e20 6265 2061 6e79  tring can be any
+00003210: 206f 6e65 206f 6620 7468 6520 3130 2b20   one of the 10+ 
+00003220: 656e 636f 6465 7273 2066 726f 6d20 6063  encoders from `c
+00003230: 6174 6567 6f72 795f 656e 636f 6465 7273  ategory_encoders
+00003240: 6020 6c69 6272 6172 7920 6265 6c6f 772e  ` library below.
+00003250: 2020 4176 6169 6c61 626c 6520 656e 636f    Available enco
+00003260: 6465 7273 2061 7265 206c 6973 7465 6420  ders are listed 
+00003270: 6865 7265 2061 7320 7374 7269 6e67 7320  here as strings 
+00003280: 736f 2074 6861 7420 796f 7520 6361 6e20  so that you can 
+00003290: 696e 7075 7420 7468 656d 2069 6e20 6c61  input them in la
+000032a0: 7a79 7472 616e 7366 6f72 6d3a 0a20 2020  zytransform:.   
+000032b0: 2020 2020 2020 202d 2060 6175 746f 6020         - `auto` 
+000032c0: 2d20 4974 2075 7365 7320 606f 6e65 686f  - It uses `oneho
+000032d0: 7460 2065 6e63 6f64 696e 6720 666f 7220  t` encoding for 
+000032e0: 6c6f 772d 6361 7264 696e 616c 6974 7920  low-cardinality 
+000032f0: 7661 7269 6162 6c65 7320 616e 6420 606c  variables and `l
+00003300: 6162 656c 6020 656e 636f 6469 6e67 2066  abel` encoding f
+00003310: 6f72 2068 6967 6820 6361 7264 696e 616c  or high cardinal
+00003320: 6974 7920 7661 7269 6162 6c65 732e 0a20  ity variables.. 
+00003330: 2020 2020 2020 2020 202d 2060 6f6e 6568           - `oneh
+00003340: 6f74 6020 2d20 4f6e 6520 486f 7420 656e  ot` - One Hot en
+00003350: 636f 6469 6e67 202d 2069 7420 7769 6c6c  coding - it will
+00003360: 2062 6520 7573 6564 2066 6f72 2061 6c6c   be used for all
+00003370: 2063 6174 6567 6f72 6963 616c 2066 6561   categorical fea
+00003380: 7475 7265 7320 6972 7265 7370 6563 7469  tures irrespecti
+00003390: 7665 206f 6620 6361 7264 696e 616c 6974  ve of cardinalit
+000033a0: 790a 2020 2020 2020 2020 2020 2d20 606c  y.          - `l
+000033b0: 6162 656c 6020 2d20 4c61 6265 6c20 456e  abel` - Label En
+000033c0: 636f 6469 6e67 202d 2069 7420 7769 6c6c  coding - it will
+000033d0: 2062 6520 7573 6564 2066 6f72 2061 6c6c   be used for all
+000033e0: 2063 6174 6567 6f72 6963 616c 2066 6561   categorical fea
+000033f0: 7475 7265 7320 6972 7265 7370 6563 7469  tures irrespecti
+00003400: 7665 206f 6620 6361 7264 696e 616c 6974  ve of cardinalit
+00003410: 790a 2020 2020 2020 2020 2020 2d20 6068  y.          - `h
+00003420: 6173 6869 6e67 6020 6f72 2060 6861 7368  ashing` or `hash
+00003430: 6020 2d20 4861 7368 696e 6720 286f 7220  ` - Hashing (or 
+00003440: 4861 7368 2920 456e 636f 6469 6e67 202d  Hash) Encoding -
+00003450: 2077 696c 6c20 6265 2075 7365 6420 666f   will be used fo
+00003460: 7220 616c 6c20 6361 7465 676f 7269 6361  r all categorica
+00003470: 6c20 7661 7269 6162 6c65 730a 2020 2020  l variables.    
+00003480: 2020 2020 2020 2d20 6068 656c 6d65 7274        - `helmert
+00003490: 6020 2d20 4865 6c6d 6572 7420 456e 636f  ` - Helmert Enco
+000034a0: 6469 6e67 202d 2077 696c 6c20 6265 2075  ding - will be u
+000034b0: 7365 6420 666f 7220 616c 6c20 6361 7465  sed for all cate
+000034c0: 676f 7269 6361 6c20 7661 7269 6162 6c65  gorical variable
+000034d0: 730a 2020 2020 2020 2020 2020 2d20 6062  s.          - `b
+000034e0: 6463 6020 2d20 4244 4320 456e 636f 6469  dc` - BDC Encodi
+000034f0: 6e67 202d 2077 696c 6c20 6265 2075 7365  ng - will be use
+00003500: 6420 666f 7220 616c 6c20 6361 7465 676f  d for all catego
+00003510: 7269 6361 6c20 7661 7269 6162 6c65 730a  rical variables.
+00003520: 2020 2020 2020 2020 2020 2d20 6073 756d            - `sum
+00003530: 6020 2d20 5375 6d20 456e 636f 6469 6e67  ` - Sum Encoding
+00003540: 202d 2077 696c 6c20 6265 2075 7365 6420   - will be used 
+00003550: 666f 7220 616c 6c20 6361 7465 676f 7269  for all categori
+00003560: 6361 6c20 7661 7269 6162 6c65 730a 2020  cal variables.  
+00003570: 2020 2020 2020 2020 2d20 606c 6f6f 6020          - `loo` 
+00003580: 2d20 4c65 6176 6520 6f6e 6520 6f75 7420  - Leave one out 
+00003590: 456e 636f 6469 6e67 202d 2077 696c 6c20  Encoding - will 
+000035a0: 6265 2075 7365 6420 666f 7220 616c 6c20  be used for all 
+000035b0: 6361 7465 676f 7269 6361 6c20 7661 7269  categorical vari
+000035c0: 6162 6c65 730a 2020 2020 2020 2020 2020  ables.          
+000035d0: 2d20 6062 6173 6560 202d 2042 6173 6520  - `base` - Base 
+000035e0: 656e 636f 6469 6e67 202d 2077 696c 6c20  encoding - will 
+000035f0: 6265 2075 7365 6420 666f 7220 616c 6c20  be used for all 
+00003600: 6361 7465 676f 7269 6361 6c20 7661 7269  categorical vari
+00003610: 6162 6c65 730a 2020 2020 2020 2020 2020  ables.          
+00003620: 2d20 6077 6f65 6020 2d20 5765 6967 6874  - `woe` - Weight
+00003630: 206f 6620 4576 6964 656e 6365 2045 6e63   of Evidence Enc
+00003640: 6f64 696e 6720 2d20 7769 6c6c 2062 6520  oding - will be 
+00003650: 7573 6564 2066 6f72 2061 6c6c 2063 6174  used for all cat
+00003660: 6567 6f72 6963 616c 2076 6172 6961 626c  egorical variabl
+00003670: 6573 0a20 2020 2020 2020 2020 202d 2060  es.          - `
+00003680: 6a61 6d65 7360 202d 204a 616d 6573 2045  james` - James E
+00003690: 6e63 6f64 696e 6720 2d20 7769 6c6c 2062  ncoding - will b
+000036a0: 6520 7573 6564 2066 6f72 2061 6c6c 2063  e used for all c
+000036b0: 6174 6567 6f72 6963 616c 2076 6172 6961  ategorical varia
+000036c0: 626c 6573 0a20 2020 2020 2020 2020 202d  bles.          -
+000036d0: 2060 7461 7267 6574 6020 2d20 5461 7267   `target` - Targ
+000036e0: 6574 2045 6e63 6f64 696e 6720 2d20 7769  et Encoding - wi
+000036f0: 6c6c 2062 6520 7573 6564 2066 6f72 2061  ll be used for a
+00003700: 6c6c 2063 6174 6567 6f72 6963 616c 2076  ll categorical v
+00003710: 6172 6961 626c 6573 0a20 2020 2020 2020  ariables.       
+00003720: 2020 202d 2060 636f 756e 7460 202d 2043     - `count` - C
+00003730: 6f75 6e74 2045 6e63 6f64 696e 6720 2d20  ount Encoding - 
+00003740: 7769 6c6c 2062 6520 7573 6564 2066 6f72  will be used for
+00003750: 2061 6c6c 2063 6174 6567 6f72 6963 616c   all categorical
+00003760: 2076 6172 6961 626c 6573 0a20 2020 2020   variables.     
+00003770: 2020 2020 202d 2060 676c 6d60 2c60 676c       - `glm`,`gl
+00003780: 6d6d 6020 2d20 4765 6e65 7261 6c69 7a65  mm` - Generalize
+00003790: 6420 4c69 6e65 6172 204d 6f64 656c 2045  d Linear Model E
+000037a0: 6e63 6f64 696e 670a 2020 2020 2020 2020  ncoding.        
+000037b0: 2d20 4865 7265 2069 7320 6120 6465 7363  - Here is a desc
+000037c0: 7269 7074 696f 6e20 6f66 2076 6172 696f  ription of vario
+000037d0: 7573 2065 6e63 6f64 6572 7320 616e 6420  us encoders and 
+000037e0: 7468 6569 7220 7573 6573 2066 726f 6d20  their uses from 
+000037f0: 7468 6520 6578 6365 6c6c 656e 7420 3c61  the excellent <a
+00003800: 2068 7265 663d 2268 7474 7073 3a2f 2f63   href="https://c
+00003810: 6f6e 7472 6962 2e73 6369 6b69 742d 6c65  ontrib.scikit-le
+00003820: 6172 6e2e 6f72 672f 6361 7465 676f 7279  arn.org/category
+00003830: 5f65 6e63 6f64 6572 732f 223e 2063 6174  _encoders/"> cat
+00003840: 6567 6f72 795f 656e 636f 6465 7273 3c2f  egory_encoders</
+00003850: 613e 2070 7974 686f 6e20 6c69 6272 6172  a> python librar
+00003860: 793a 3c62 723e 0a20 2020 2020 2020 2020  y:<br>.         
+00003870: 2020 202d 2060 4861 7368 696e 6745 6e63     - `HashingEnc
+00003880: 6f64 6572 603a 2048 6173 6869 6e67 456e  oder`: HashingEn
+00003890: 636f 6465 7220 6973 2061 206d 756c 7469  coder is a multi
+000038a0: 7661 7269 6174 6520 6861 7368 696e 6720  variate hashing 
+000038b0: 696d 706c 656d 656e 7461 7469 6f6e 2077  implementation w
+000038c0: 6974 6820 636f 6e66 6967 7572 6162 6c65  ith configurable
+000038d0: 2064 696d 656e 7369 6f6e 616c 6974 792f   dimensionality/
+000038e0: 7072 6563 6973 696f 6e2e 2054 6865 2061  precision. The a
+000038f0: 6476 616e 7461 6765 206f 6620 7468 6973  dvantage of this
+00003900: 2065 6e63 6f64 6572 2069 7320 7468 6174   encoder is that
+00003910: 2069 7420 646f 6573 206e 6f74 206d 6169   it does not mai
+00003920: 6e74 6169 6e20 6120 6469 6374 696f 6e61  ntain a dictiona
+00003930: 7279 206f 6620 6f62 7365 7276 6564 2063  ry of observed c
+00003940: 6174 6567 6f72 6965 732e 2043 6f6e 7365  ategories. Conse
+00003950: 7175 656e 746c 792c 2074 6865 2065 6e63  quently, the enc
+00003960: 6f64 6572 2064 6f65 7320 6e6f 7420 6772  oder does not gr
+00003970: 6f77 2069 6e20 7369 7a65 2061 6e64 2061  ow in size and a
+00003980: 6363 6570 7473 206e 6577 2076 616c 7565  ccepts new value
+00003990: 7320 6475 7269 6e67 2064 6174 6120 7363  s during data sc
+000039a0: 6f72 696e 6720 6279 2064 6573 6967 6e2e  oring by design.
+000039b0: 0a20 2020 2020 2020 2020 2020 202d 2060  .            - `
+000039c0: 5375 6d45 6e63 6f64 6572 603a 2053 756d  SumEncoder`: Sum
+000039d0: 456e 636f 6465 7220 6973 2061 2053 756d  Encoder is a Sum
+000039e0: 2063 6f6e 7472 6173 7420 636f 6469 6e67   contrast coding
+000039f0: 2066 6f72 2074 6865 2065 6e63 6f64 696e   for the encodin
+00003a00: 6720 6f66 2063 6174 6567 6f72 6963 616c  g of categorical
+00003a10: 2066 6561 7475 7265 732e 0a20 2020 2020   features..     
+00003a20: 2020 2020 2020 202d 2060 506f 6c79 6e6f         - `Polyno
+00003a30: 6d69 616c 456e 636f 6465 7260 3a20 506f  mialEncoder`: Po
+00003a40: 6c79 6e6f 6d69 616c 456e 636f 6465 7220  lynomialEncoder 
+00003a50: 6973 2061 2050 6f6c 796e 6f6d 6961 6c20  is a Polynomial 
+00003a60: 636f 6e74 7261 7374 2063 6f64 696e 6720  contrast coding 
+00003a70: 666f 7220 7468 6520 656e 636f 6469 6e67  for the encoding
+00003a80: 206f 6620 6361 7465 676f 7269 6361 6c20   of categorical 
+00003a90: 6665 6174 7572 6573 2e0a 2020 2020 2020  features..      
+00003aa0: 2020 2020 2020 2d20 6042 6163 6b77 6172        - `Backwar
+00003ab0: 6444 6966 6665 7265 6e63 6545 6e63 6f64  dDifferenceEncod
+00003ac0: 6572 603a 2042 6163 6b77 6172 6444 6966  er`: BackwardDif
+00003ad0: 6665 7265 6e63 6545 6e63 6f64 6572 2069  ferenceEncoder i
+00003ae0: 7320 6120 4261 636b 7761 7264 2064 6966  s a Backward dif
+00003af0: 6665 7265 6e63 6520 636f 6e74 7261 7374  ference contrast
+00003b00: 2063 6f64 696e 6720 666f 7220 656e 636f   coding for enco
+00003b10: 6469 6e67 2063 6174 6567 6f72 6963 616c  ding categorical
+00003b20: 2076 6172 6961 626c 6573 2e0a 2020 2020   variables..    
+00003b30: 2020 2020 2020 2020 2d20 604f 6e65 486f          - `OneHo
+00003b40: 7445 6e63 6f64 6572 603a 204f 6e65 486f  tEncoder`: OneHo
+00003b50: 7445 6e63 6f64 6572 2069 7320 7468 6520  tEncoder is the 
+00003b60: 7472 6164 6974 696f 6e61 6c20 4f6e 6568  traditional Oneh
+00003b70: 6f74 2028 6f72 2064 756d 6d79 2920 636f  ot (or dummy) co
+00003b80: 6469 6e67 2066 6f72 2063 6174 6567 6f72  ding for categor
+00003b90: 6963 616c 2066 6561 7475 7265 732e 2049  ical features. I
+00003ba0: 7420 7072 6f64 7563 6573 206f 6e65 2066  t produces one f
+00003bb0: 6561 7475 7265 2070 6572 2063 6174 6567  eature per categ
+00003bc0: 6f72 792c 2065 6163 6820 6265 696e 6720  ory, each being 
+00003bd0: 6120 6269 6e61 7279 2e0a 2020 2020 2020  a binary..      
+00003be0: 2020 2020 2020 2d20 6048 656c 6d65 7274        - `Helmert
+00003bf0: 456e 636f 6465 7260 3a20 4865 6c6d 6572  Encoder`: Helmer
+00003c00: 7445 6e63 6f64 6572 2075 7365 7320 7468  tEncoder uses th
+00003c10: 6520 4865 6c6d 6572 7420 636f 6e74 7261  e Helmert contra
+00003c20: 7374 2063 6f64 696e 6720 666f 7220 656e  st coding for en
+00003c30: 636f 6469 6e67 2063 6174 6567 6f72 6963  coding categoric
+00003c40: 616c 2066 6561 7475 7265 732e 0a20 2020  al features..   
+00003c50: 2020 2020 2020 2020 202d 2060 4f72 6469           - `Ordi
+00003c60: 6e61 6c45 6e63 6f64 6572 603a 204f 7264  nalEncoder`: Ord
+00003c70: 696e 616c 456e 636f 6465 7220 7573 6573  inalEncoder uses
+00003c80: 204f 7264 696e 616c 2065 6e63 6f64 696e   Ordinal encodin
+00003c90: 6720 746f 2064 6573 6967 6e61 7465 2061  g to designate a
+00003ca0: 2073 696e 676c 6520 636f 6c75 6d6e 206f   single column o
+00003cb0: 6620 696e 7465 6765 7273 2074 6f20 7265  f integers to re
+00003cc0: 7072 6573 656e 7420 7468 6520 6361 7465  present the cate
+00003cd0: 676f 7269 6573 2069 6e20 796f 7572 2064  gories in your d
+00003ce0: 6174 612e 2049 6e74 6567 6572 7320 686f  ata. Integers ho
+00003cf0: 7765 7665 7220 7374 6172 7420 696e 2074  wever start in t
+00003d00: 6865 2073 616d 6520 6f72 6465 7220 696e  he same order in
+00003d10: 2077 6869 6368 2074 6865 2063 6174 6567   which the categ
+00003d20: 6f72 6965 7320 6172 6520 666f 756e 6420  ories are found 
+00003d30: 696e 2079 6f75 7220 6461 7461 7365 742e  in your dataset.
+00003d40: 2049 6620 796f 7520 7761 6e74 2074 6f20   If you want to 
+00003d50: 6368 616e 6765 2074 6865 206f 7264 6572  change the order
+00003d60: 2c20 6a75 7374 2073 6f72 7420 7468 6520  , just sort the 
+00003d70: 636f 6c75 6d6e 2061 6e64 2073 656e 6420  column and send 
+00003d80: 6974 2069 6e20 666f 7220 656e 636f 6469  it in for encodi
+00003d90: 6e67 2e0a 2020 2020 2020 2020 2020 2020  ng..            
+00003da0: 2d20 6046 7265 7175 656e 6379 456e 636f  - `FrequencyEnco
+00003db0: 6465 7260 3a20 4672 6571 7565 6e63 7945  der`: FrequencyE
+00003dc0: 6e63 6f64 6572 2069 7320 6120 636f 756e  ncoder is a coun
+00003dd0: 7420 656e 636f 6469 6e67 2074 6563 686e  t encoding techn
+00003de0: 6971 7565 2066 6f72 2063 6174 6567 6f72  ique for categor
+00003df0: 6963 616c 2066 6561 7475 7265 732e 2046  ical features. F
+00003e00: 6f72 2061 2067 6976 656e 2063 6174 6567  or a given categ
+00003e10: 6f72 6963 616c 2066 6561 7475 7265 2c20  orical feature, 
+00003e20: 6974 2072 6570 6c61 6365 7320 7468 6520  it replaces the 
+00003e30: 6e61 6d65 7320 6f66 2074 6865 2063 6174  names of the cat
+00003e40: 6567 6f72 6965 7320 7769 7468 2074 6865  egories with the
+00003e50: 2067 726f 7570 2063 6f75 6e74 7320 6f66   group counts of
+00003e60: 2065 6163 6820 6361 7465 676f 7279 2e0a   each category..
+00003e70: 2020 2020 2020 2020 2020 2020 2d20 6042              - `B
+00003e80: 6173 654e 456e 636f 6465 7260 3a20 4261  aseNEncoder`: Ba
+00003e90: 7365 4e45 6e63 6f64 6572 2065 6e63 6f64  seNEncoder encod
+00003ea0: 6573 2074 6865 2063 6174 6567 6f72 6965  es the categorie
+00003eb0: 7320 696e 746f 2061 7272 6179 7320 6f66  s into arrays of
+00003ec0: 2074 6865 6972 2062 6173 652d 4e20 7265   their base-N re
+00003ed0: 7072 6573 656e 7461 7469 6f6e 2e20 4120  presentation. A 
+00003ee0: 6261 7365 206f 6620 3120 6973 2065 7175  base of 1 is equ
+00003ef0: 6976 616c 656e 7420 746f 206f 6e65 2d68  ivalent to one-h
+00003f00: 6f74 2065 6e63 6f64 696e 6720 286e 6f74  ot encoding (not
+00003f10: 2072 6561 6c6c 7920 6261 7365 2d31 2c20   really base-1, 
+00003f20: 6275 7420 7573 6566 756c 292c 2061 2062  but useful), a b
+00003f30: 6173 6520 6f66 2032 2069 7320 6571 7569  ase of 2 is equi
+00003f40: 7661 6c65 6e74 2074 6f20 6269 6e61 7279  valent to binary
+00003f50: 2065 6e63 6f64 696e 672e 204e 3d6e 756d   encoding. N=num
+00003f60: 6265 7220 6f66 2061 6374 7561 6c20 6361  ber of actual ca
+00003f70: 7465 676f 7269 6573 2069 7320 6571 7569  tegories is equi
+00003f80: 7661 6c65 6e74 2074 6f20 7661 6e69 6c6c  valent to vanill
+00003f90: 6120 6f72 6469 6e61 6c20 656e 636f 6469  a ordinal encodi
+00003fa0: 6e67 2e0a 2020 2020 2020 2020 2020 2020  ng..            
+00003fb0: 2d20 6054 6172 6765 7445 6e63 6f64 6572  - `TargetEncoder
+00003fc0: 603a 2054 6172 6765 7445 6e63 6f64 6572  `: TargetEncoder
+00003fd0: 2070 6572 666f 726d 7320 5461 7267 6574   performs Target
+00003fe0: 2065 6e63 6f64 696e 6720 666f 7220 6361   encoding for ca
+00003ff0: 7465 676f 7269 6361 6c20 6665 6174 7572  tegorical featur
+00004000: 6573 2e20 4974 2073 7570 706f 7274 7320  es. It supports 
+00004010: 666f 6c6c 6f77 696e 6720 6b69 6e64 7320  following kinds 
+00004020: 6f66 2074 6172 6765 7473 3a20 6269 6e61  of targets: bina
+00004030: 7279 2061 6e64 2063 6f6e 7469 6e75 6f75  ry and continuou
+00004040: 732e 2046 6f72 206d 756c 7469 2d63 6c61  s. For multi-cla
+00004050: 7373 2074 6172 6765 7473 2069 7420 7573  ss targets it us
+00004060: 6573 2061 2050 6f6c 796e 6f6d 6961 6c57  es a PolynomialW
+00004070: 7261 7070 6572 2e0a 2020 2020 2020 2020  rapper..        
+00004080: 2020 2020 2d20 6043 6174 426f 6f73 7445      - `CatBoostE
+00004090: 6e63 6f64 6572 603a 2043 6174 426f 6f73  ncoder`: CatBoos
+000040a0: 7445 6e63 6f64 6572 2070 6572 666f 726d  tEncoder perform
+000040b0: 7320 4361 7442 6f6f 7374 2063 6f64 696e  s CatBoost codin
+000040c0: 6720 666f 7220 6361 7465 676f 7269 6361  g for categorica
+000040d0: 6c20 6665 6174 7572 6573 2e20 4974 2073  l features. It s
+000040e0: 7570 706f 7274 7320 7468 6520 666f 6c6c  upports the foll
+000040f0: 6f77 696e 6720 6b69 6e64 7320 6f66 2074  owing kinds of t
+00004100: 6172 6765 7473 3a20 6269 6e61 7279 2061  argets: binary a
+00004110: 6e64 2063 6f6e 7469 6e75 6f75 732e 2046  nd continuous. F
+00004120: 6f72 2070 6f6c 796e 6f6d 6961 6c20 7461  or polynomial ta
+00004130: 7267 6574 2073 7570 706f 7274 2c20 6974  rget support, it
+00004140: 2075 7365 7320 6120 506f 6c79 6e6f 6d69   uses a Polynomi
+00004150: 616c 5772 6170 7065 722e 2054 6869 7320  alWrapper. This 
+00004160: 6973 2076 6572 7920 7369 6d69 6c61 7220  is very similar 
+00004170: 746f 206c 6561 7665 2d6f 6e65 2d6f 7574  to leave-one-out
+00004180: 2065 6e63 6f64 696e 672c 2062 7574 2063   encoding, but c
+00004190: 616c 6375 6c61 7465 7320 7468 6520 7661  alculates the va
+000041a0: 6c75 6573 20e2 809c 6f6e 2d74 6865 2d66  lues ...on-the-f
+000041b0: 6c79 e280 9d2e 2043 6f6e 7365 7175 656e  ly.... Consequen
+000041c0: 746c 792c 2074 6865 2076 616c 7565 7320  tly, the values 
+000041d0: 6e61 7475 7261 6c6c 7920 7661 7279 2064  naturally vary d
+000041e0: 7572 696e 6720 7468 6520 7472 6169 6e69  uring the traini
+000041f0: 6e67 2070 6861 7365 2061 6e64 2069 7420  ng phase and it 
+00004200: 6973 206e 6f74 206e 6563 6573 7361 7279  is not necessary
+00004210: 2074 6f20 6164 6420 7261 6e64 6f6d 206e   to add random n
+00004220: 6f69 7365 2e0a 2020 2020 2020 2020 2020  oise..          
+00004230: 2020 2d20 6057 4f45 456e 636f 6465 7260    - `WOEEncoder`
+00004240: 3a20 574f 4545 6e63 6f64 6572 2075 7365  : WOEEncoder use
+00004250: 7320 7468 6520 5765 6967 6874 206f 6620  s the Weight of 
+00004260: 4576 6964 656e 6365 2074 6563 686e 6971  Evidence techniq
+00004270: 7565 2066 6f72 2063 6174 6567 6f72 6963  ue for categoric
+00004280: 616c 2066 6561 7475 7265 732e 2049 7420  al features. It 
+00004290: 7375 7070 6f72 7473 206f 6e6c 7920 6f6e  supports only on
+000042a0: 6520 6b69 6e64 206f 6620 7461 7267 6574  e kind of target
+000042b0: 3a20 6269 6e61 7279 2e20 466f 7220 706f  : binary. For po
+000042c0: 6c79 6e6f 6d69 616c 2074 6172 6765 7420  lynomial target 
+000042d0: 7375 7070 6f72 742c 2069 7420 7573 6573  support, it uses
+000042e0: 2061 2050 6f6c 796e 6f6d 6961 6c57 7261   a PolynomialWra
+000042f0: 7070 6572 2e20 4974 2063 616e 6e6f 7420  pper. It cannot 
+00004300: 6265 2075 7365 6420 666f 7220 5265 6772  be used for Regr
+00004310: 6573 7369 6f6e 2e0a 2020 2020 2020 2020  ession..        
+00004320: 2020 2020 2d20 604a 616d 6573 5374 6569      - `JamesStei
+00004330: 6e45 6e63 6f64 6572 603a 204a 616d 6573  nEncoder`: James
+00004340: 5374 6569 6e45 6e63 6f64 6572 2075 7365  SteinEncoder use
+00004350: 7320 7468 6520 4a61 6d65 732d 5374 6569  s the James-Stei
+00004360: 6e20 6573 7469 6d61 746f 722e 2049 7420  n estimator. It 
+00004370: 7375 7070 6f72 7473 2032 206b 696e 6473  supports 2 kinds
+00004380: 206f 6620 7461 7267 6574 733a 2062 696e   of targets: bin
+00004390: 6172 7920 616e 6420 636f 6e74 696e 756f  ary and continuo
+000043a0: 7573 2e20 466f 7220 706f 6c79 6e6f 6d69  us. For polynomi
+000043b0: 616c 2074 6172 6765 7420 7375 7070 6f72  al target suppor
+000043c0: 742c 2069 7420 7573 6573 2050 6f6c 796e  t, it uses Polyn
+000043d0: 6f6d 6961 6c57 7261 7070 6572 2e0a 2020  omialWrapper..  
+000043e0: 2020 2020 2020 2020 2020 466f 7220 6665            For fe
+000043f0: 6174 7572 6520 7661 6c75 6520 692c 204a  ature value i, J
+00004400: 616d 6573 2d53 7465 696e 2065 7374 696d  ames-Stein estim
+00004410: 6174 6f72 2072 6574 7572 6e73 2061 2077  ator returns a w
+00004420: 6569 6768 7465 6420 6176 6572 6167 6520  eighted average 
+00004430: 6f66 3a0a 2020 2020 2020 2020 2020 2020  of:.            
+00004440: 5468 6520 6d65 616e 2074 6172 6765 7420  The mean target 
+00004450: 7661 6c75 6520 666f 7220 7468 6520 6f62  value for the ob
+00004460: 7365 7276 6564 2066 6561 7475 7265 2076  served feature v
+00004470: 616c 7565 2069 2e0a 2020 2020 2020 2020  alue i..        
+00004480: 2020 2020 5468 6520 6d65 616e 2074 6172      The mean tar
+00004490: 6765 7420 7661 6c75 6520 2872 6567 6172  get value (regar
+000044a0: 646c 6573 7320 6f66 2074 6865 2066 6561  dless of the fea
+000044b0: 7475 7265 2076 616c 7565 292e 0a20 2020  ture value)..   
+000044c0: 2020 2020 2020 2020 202d 2060 5175 616e           - `Quan
+000044d0: 7469 6c65 456e 636f 6465 7260 3a20 5468  tileEncoder`: Th
+000044e0: 6973 2069 7320 6120 7665 7279 2067 6f6f  is is a very goo
+000044f0: 6420 656e 636f 6465 7220 666f 7220 5265  d encoder for Re
+00004500: 6772 6573 7369 6f6e 2074 6173 6b73 2e20  gression tasks. 
+00004510: 5365 6520 5061 7065 7220 616e 6420 6172  See Paper and ar
+00004520: 7469 636c 653a 0a20 2020 2020 2020 2020  ticle:.         
+00004530: 2020 2068 7474 7073 3a2f 2f74 6f77 6172     https://towar
+00004540: 6473 6461 7461 7363 6965 6e63 652e 636f  dsdatascience.co
+00004550: 6d2f 7175 616e 7469 6c65 2d65 6e63 6f64  m/quantile-encod
+00004560: 6572 2d65 6233 3363 3237 3234 3131 640a  er-eb33c272411d.
+00004570: 2020 2020 2020 2020 0a20 2020 2020 2020          .       
+00004580: 202d 2060 7363 616c 6572 7360 3a20 636f   - `scalers`: co
+00004590: 756c 6420 6265 206f 6e65 206f 6620 7468  uld be one of th
+000045a0: 7265 6520 6d61 696e 2073 6361 6c65 7273  ree main scalers
+000045b0: 2075 7365 6420 696e 2073 6369 6b69 742d   used in scikit-
+000045c0: 6c65 6172 6e20 6d6f 6465 6c73 2074 6f20  learn models to 
+000045d0: 7472 616e 7366 6f72 6d20 6e75 6d65 7269  transform numeri
+000045e0: 6320 6665 6174 7572 6573 2e20 4465 6661  c features. Defa
+000045f0: 756c 7420 6973 204e 6f6e 652e 2053 6361  ult is None. Sca
+00004600: 6c65 7273 2061 7265 2075 7365 6420 696e  lers are used in
+00004610: 2074 6865 206c 6173 7420 7374 6570 206f   the last step o
+00004620: 6620 7468 6520 7069 7065 6c69 6e65 2074  f the pipeline t
+00004630: 6f20 7363 616c 6520 616c 6c20 6665 6174  o scale all feat
+00004640: 7572 6573 2074 6861 7420 6861 7665 2074  ures that have t
+00004650: 7261 6e73 666f 726d 6564 2e20 486f 7765  ransformed. Howe
+00004660: 7665 722c 2079 6f75 206d 6967 6874 2077  ver, you might w
+00004670: 616e 7420 746f 2061 766f 6964 2073 6361  ant to avoid sca
+00004680: 6c69 6e67 2069 6e20 4e4c 5020 6461 7461  ling in NLP data
+00004690: 7365 7473 2073 696e 6365 2061 6674 6572  sets since after
+000046a0: 2054 4669 4446 2076 6563 746f 7269 7a61   TFiDF vectoriza
+000046b0: 7469 6f6e 2c20 7363 616c 696e 6720 7468  tion, scaling th
+000046c0: 656d 206d 6179 206e 6f74 206d 616b 6520  em may not make 
+000046d0: 7365 6e73 652e 2042 7574 2069 7420 6973  sense. But it is
+000046e0: 2075 7020 746f 2079 6f75 2e20 5468 6520   up to you. The 
+000046f0: 3420 6f70 7469 6f6e 7320 6172 653a 0a20  4 options are:. 
+00004700: 2020 2020 2020 2020 202d 2060 4e6f 6e65           - `None
+00004710: 6020 4e6f 2073 6361 6c65 722e 2047 7265  ` No scaler. Gre
+00004720: 6174 2066 6f72 2061 6c6d 6f73 7420 616c  at for almost al
+00004730: 6c20 6461 7461 7365 7473 2e20 5465 7374  l datasets. Test
+00004740: 2069 7420 6669 7273 7420 616e 6420 7468   it first and th
+00004750: 656e 2074 7279 206f 6e65 206f 6620 7468  en try one of th
+00004760: 6520 7363 616c 6572 7320 6265 6c6f 772e  e scalers below.
+00004770: 0a20 2020 2020 2020 2020 202d 2060 7374  .          - `st
+00004780: 6460 2073 7461 6e64 6172 6420 7363 616c  d` standard scal
+00004790: 6572 2e20 4772 6561 7420 666f 7220 616c  er. Great for al
+000047a0: 6d6f 7374 2061 6c6c 2064 6174 6173 6574  most all dataset
+000047b0: 732e 0a20 2020 2020 2020 2020 202d 2060  s..          - `
+000047c0: 6d69 6e6d 6178 6020 6d69 6e6d 6178 2073  minmax` minmax s
+000047d0: 6361 6c65 722e 2047 7265 6174 2066 6f72  caler. Great for
+000047e0: 2064 6174 6173 6574 7320 7768 6572 6520   datasets where 
+000047f0: 796f 7520 6e65 6564 2074 6f20 7365 6520  you need to see 
+00004800: 7468 6520 6469 7374 7269 6275 7469 6f6e  the distribution
+00004810: 2062 6574 7765 656e 2030 2061 6e64 2031   between 0 and 1
+00004820: 2e0a 2020 2020 2020 2020 2020 2d20 6072  ..          - `r
+00004830: 6f62 7573 7460 2052 6f62 7573 7420 7363  obust` Robust sc
+00004840: 616c 6572 2e20 4772 6561 7420 666f 7220  aler. Great for 
+00004850: 6461 7461 7365 7473 2077 6865 7265 2079  datasets where y
+00004860: 6f75 2068 6176 6520 6f75 746c 6965 7273  ou have outliers
+00004870: 2e0a 2020 2020 2020 2020 2020 2d20 606d  ..          - `m
+00004880: 6178 6162 7360 206d 6178 2061 6273 6f6c  axabs` max absol
+00004890: 7574 6520 7363 616c 6572 2e20 4772 6561  ute scaler. Grea
+000048a0: 7420 666f 7220 7363 616c 696e 6720 6275  t for scaling bu
+000048b0: 7420 6c65 6176 6573 2074 6865 206e 6567  t leaves the neg
+000048c0: 6174 6976 6520 7661 6c75 6573 2061 7320  ative values as 
+000048d0: 7468 6579 2061 7265 2028 6e65 6761 7469  they are (negati
+000048e0: 7665 292e 200a 2020 2020 2020 2020 2d20  ve). .        - 
+000048f0: 6064 6174 655f 746f 5f73 7472 696e 6760  `date_to_string`
+00004900: 3a20 6465 6661 756c 7420 6973 2046 616c  : default is Fal
+00004910: 7365 2e20 4966 2079 6f75 2077 616e 7420  se. If you want 
+00004920: 746f 2075 7365 2064 6174 6520 7661 7269  to use date vari
+00004930: 6162 6c65 7320 6173 2073 7472 696e 6773  ables as strings
+00004940: 2028 6361 7465 676f 7269 6361 6c29 2c20   (categorical), 
+00004950: 7468 656e 2073 6574 2069 7420 6173 2054  then set it as T
+00004960: 7275 652e 596f 7520 6361 6e20 7573 6520  rue.You can use 
+00004970: 7468 6973 206f 7074 696f 6e20 7768 656e  this option when
+00004980: 2074 6865 7265 2061 7265 2076 6572 7920   there are very 
+00004990: 6665 7720 6461 7465 7320 696e 2079 6f75  few dates in you
+000049a0: 7220 6461 7461 7365 742e 2049 6620 796f  r dataset. If yo
+000049b0: 7520 7365 7420 6974 2061 7320 4661 6c73  u set it as Fals
+000049c0: 652c 2069 7420 7769 6c6c 2063 6f6e 7665  e, it will conve
+000049d0: 7274 2069 7420 696e 746f 2064 6174 6520  rt it into date 
+000049e0: 7469 6d65 2066 6f72 6d61 7420 616e 6420  time format and 
+000049f0: 6578 7472 6163 7420 7570 2074 6f20 3230  extract up to 20
+00004a00: 2066 6561 7475 7265 7320 6672 6f6d 2079   features from y
+00004a10: 6f75 7220 6461 7465 2074 696d 6520 636f  our date time co
+00004a20: 6c75 6d6e 2e20 5468 6973 2069 7320 7468  lumn. This is th
+00004a30: 6520 6465 6661 756c 7420 6f70 7469 6f6e  e default option
+00004a40: 2061 6e64 2062 6573 7420 6f70 7469 6f6e   and best option
+00004a50: 2e0a 2020 2020 2020 2020 2d20 6074 7261  ..        - `tra
+00004a60: 6e73 666f 726d 5f74 6172 6765 7460 3a20  nsform_target`: 
+00004a70: 6465 6661 756c 7420 6973 2046 616c 7365  default is False
+00004a80: 2e20 4966 2079 6f75 2077 616e 7420 746f  . If you want to
+00004a90: 2074 7261 6e73 666f 726d 2079 6f75 7220   transform your 
+00004aa0: 7461 7267 6574 2076 6172 6961 626c 6528  target variable(
+00004ab0: 7329 2c20 7468 656e 2073 6574 2069 7420  s), then set it 
+00004ac0: 6173 2054 7275 6520 616e 6420 7765 2077  as True and we w
+00004ad0: 696c 6c20 7472 616e 7366 6f72 6d20 796f  ill transform yo
+00004ae0: 7572 2074 6172 6765 7428 7329 2061 7320  ur target(s) as 
+00004af0: 6e75 6d65 7269 6320 7573 696e 6720 4c61  numeric using La
+00004b00: 6265 6c20 456e 636f 6469 6e67 2061 7320  bel Encoding as 
+00004b10: 7765 6c6c 2061 7320 6d75 6c74 692d 6c61  well as multi-la
+00004b20: 6265 6c20 4269 6e61 7279 2063 6c61 7373  bel Binary class
+00004b30: 6573 2e20 5468 6973 2069 7320 6120 6772  es. This is a gr
+00004b40: 6561 7420 6f70 7469 6f6e 2077 6865 6e20  eat option when 
+00004b50: 796f 7520 6861 7665 2063 6174 6567 6f72  you have categor
+00004b60: 6963 616c 2074 6172 6765 7420 7661 7269  ical target vari
+00004b70: 6162 6c65 732e 0a20 2020 2020 2020 202d  ables..        -
+00004b80: 2060 696d 6261 6c61 6e63 6564 603a 2064   `imbalanced`: d
+00004b90: 6566 6175 6c74 2069 7320 4661 6c73 652e  efault is False.
+00004ba0: 2049 6620 796f 7520 6861 7665 2061 6e20   If you have an 
+00004bb0: 696d 6261 6c61 6e63 6564 2064 6174 6173  imbalanced datas
+00004bc0: 6574 2c20 7468 656e 2073 6574 2069 7420  et, then set it 
+00004bd0: 746f 2054 7275 6520 616e 6420 7765 2077  to True and we w
+00004be0: 696c 6c20 7472 616e 7366 6f72 6d20 796f  ill transform yo
+00004bf0: 7572 2074 7261 696e 2064 6174 6120 7573  ur train data us
+00004c00: 696e 6720 426f 7264 6572 6c69 6e65 534d  ing BorderlineSM
+00004c10: 4f54 4520 6f72 2053 4d4f 5445 4e43 2077  OTE or SMOTENC w
+00004c20: 6869 6368 2061 7265 2062 6f74 6820 6772  hich are both gr
+00004c30: 6561 7420 6f70 7469 6f6e 732e 2057 6520  eat options. We 
+00004c40: 7769 6c6c 2073 656c 6563 7420 7468 6520  will select the 
+00004c50: 7269 6768 7420 534d 4f54 4520 6675 6e63  right SMOTE func
+00004c60: 7469 6f6e 2061 7574 6f6d 6174 6963 616c  tion automatical
+00004c70: 6c79 2e0a 2020 2020 2020 2020 2d20 6063  ly..        - `c
+00004c80: 6f6d 6269 6e65 5f72 6172 6560 3a20 6465  ombine_rare`: de
+00004c90: 6661 756c 7420 6973 2046 616c 7365 2e20  fault is False. 
+00004ca0: 5468 6973 2069 7320 6120 6772 6561 7420  This is a great 
+00004cb0: 6f70 7469 6f6e 2069 6620 796f 7520 6861  option if you ha
+00004cc0: 7665 2074 6f6f 206d 616e 7920 7261 7265  ve too many rare
+00004cd0: 2063 6174 6567 6f72 6965 7320 696e 2079   categories in y
+00004ce0: 6f75 7220 6361 7465 676f 7269 6361 6c20  our categorical 
+00004cf0: 7661 7269 6162 6c65 732e 2049 7420 7769  variables. It wi
+00004d00: 6c6c 2061 7574 6f6d 6174 6963 616c 6c79  ll automatically
+00004d10: 2063 6f6d 6269 6e65 2074 686f 7365 2072   combine those r
+00004d20: 6172 6520 6361 7465 676f 7269 6573 2077  are categories w
+00004d30: 6869 6368 2061 7265 206c 6573 7320 7468  hich are less th
+00004d40: 616e 2031 2520 6f66 2074 6865 2064 6174  an 1% of the dat
+00004d50: 6173 6574 2069 6e74 6f20 6f6e 6520 636f  aset into one co
+00004d60: 6d62 696e 6564 2063 6174 6567 6f72 7920  mbined category 
+00004d70: 6361 6c6c 6564 2022 7261 7265 5f63 6174  called "rare_cat
+00004d80: 6567 6f72 6965 7322 2e20 596f 7520 6361  egories". You ca
+00004d90: 6e20 616c 736f 2073 6574 2069 7420 746f  n also set it to
+00004da0: 2046 616c 7365 2061 6e64 2077 6520 7769   False and we wi
+00004db0: 6c6c 206e 6f74 2074 7261 6e73 666f 726d  ll not transform
+00004dc0: 2061 6e79 206f 6620 796f 7572 2063 6174   any of your cat
+00004dd0: 6567 6f72 6965 7320 696e 2079 6f75 7220  egories in your 
+00004de0: 6361 7465 676f 7269 6361 6c20 7661 7269  categorical vari
+00004df0: 6162 6c65 732e 0a20 2020 2020 2020 2020  ables..         
+00004e00: 2d20 6076 6572 626f 7365 603a 2054 6869  - `verbose`: Thi
+00004e10: 7320 6861 7320 3320 706f 7373 6962 6c65  s has 3 possible
+00004e20: 2073 7461 7465 733a 0a20 2020 2020 2020   states:.       
+00004e30: 2020 202d 2060 3060 2073 696c 656e 7420     - `0` silent 
+00004e40: 6f75 7470 7574 2e20 4772 6561 7420 666f  output. Great fo
+00004e50: 7220 7275 6e6e 696e 6720 7468 6973 2073  r running this s
+00004e60: 696c 656e 746c 7920 616e 6420 6765 7474  ilently and gett
+00004e70: 696e 6720 6661 7374 2072 6573 756c 7473  ing fast results
+00004e80: 2e0a 2020 2020 2020 2020 2020 2d20 6031  ..          - `1
+00004e90: 6020 6d6f 7265 2076 6572 6269 6167 652e  ` more verbiage.
+00004ea0: 2047 7265 6174 2066 6f72 206b 6e6f 7769   Great for knowi
+00004eb0: 6e67 2068 6f77 2072 6573 756c 7473 2077  ng how results w
+00004ec0: 6572 6520 616e 6420 6d61 6b69 6e67 2063  ere and making c
+00004ed0: 6861 6e67 6573 2074 6f20 666c 6167 7320  hanges to flags 
+00004ee0: 696e 2069 6e70 7574 2e0a 2020 2020 2020  in input..      
+00004ef0: 2020 2020 2d20 6032 6020 6869 6768 6c79      - `2` highly
+00004f00: 2076 6572 626f 7365 206f 7574 7075 742e   verbose output.
+00004f10: 2047 7265 6174 2066 6f72 2066 696e 6469   Great for findi
+00004f20: 6e67 206f 7574 2077 6861 7420 6861 7070  ng out what happ
+00004f30: 656e 7320 756e 6465 7220 7468 6520 686f  ens under the ho
+00004f40: 6f64 2069 6e20 6c61 7a79 7472 616e 7366  od in lazytransf
+00004f50: 6f72 6d20 7069 7065 6c69 6e65 732e 0a20  orm pipelines.. 
+00004f60: 2020 2020 2020 203c 703e 0a20 2020 2020         <p>.     
+00004f70: 2020 2054 6f20 7669 6577 2074 6865 2074     To view the t
+00004f80: 6578 7420 7069 7065 6c69 6e65 2c20 7468  ext pipeline, th
+00004f90: 6520 6465 6661 756c 7420 6469 7370 6c61  e default displa
+00004fa0: 7920 6973 2027 7465 7874 272c 2064 6f3a  y is 'text', do:
+00004fb0: 3c62 723e 0a20 2020 2020 2020 200a 2020  <br>.        .  
+00004fc0: 2020 2020 2020 6060 600a 2020 2020 2020        ```.      
+00004fd0: 2020 6672 6f6d 2073 6b6c 6561 726e 2069    from sklearn i
+00004fe0: 6d70 6f72 7420 7365 745f 636f 6e66 6967  mport set_config
+00004ff0: 0a20 2020 2020 2020 2073 6574 5f63 6f6e  .        set_con
+00005000: 6669 6728 6469 7370 6c61 793d 2274 6578  fig(display="tex
+00005010: 7422 290a 2020 2020 2020 2020 6c61 7a79  t").        lazy
+00005020: 2e78 666f 726d 6572 0a20 2020 2020 2020  .xformer.       
+00005030: 2060 6060 0a20 2020 2020 2020 200a 2020   ```.        .  
+00005040: 2020 2020 2020 3c70 3e0a 2020 2020 2020        <p>.      
+00005050: 2020 546f 2076 6965 7720 7468 6520 7069    To view the pi
+00005060: 7065 6c69 6e65 2069 6e20 6120 6469 6167  peline in a diag
+00005070: 7261 6d20 2876 6973 7561 6c20 666f 726d  ram (visual form
+00005080: 6174 292c 2064 6f3a 3c62 723e 0a20 2020  at), do:<br>.   
+00005090: 2020 2020 200a 2020 2020 2020 2020 6060       .        ``
+000050a0: 600a 2020 2020 2020 2020 6672 6f6d 2073  `.        from s
+000050b0: 6b6c 6561 726e 2069 6d70 6f72 7420 7365  klearn import se
+000050c0: 745f 636f 6e66 6967 0a20 2020 2020 2020  t_config.       
+000050d0: 2073 6574 5f63 6f6e 6669 6728 6469 7370   set_config(disp
+000050e0: 6c61 793d 2264 6961 6772 616d 2229 0a20  lay="diagram"). 
+000050f0: 2020 2020 2020 206c 617a 792e 7866 6f72         lazy.xfor
+00005100: 6d65 720a 2020 2020 2020 2020 2320 4966  mer.        # If
+00005110: 2079 6f75 2068 6176 6520 6120 6d6f 6465   you have a mode
+00005120: 6c20 696e 2074 6865 2070 6970 656c 696e  l in the pipelin
+00005130: 652c 2064 6f3a 0a20 2020 2020 2020 206c  e, do:.        l
+00005140: 617a 792e 6d6f 6465 6c66 6f72 6d65 720a  azy.modelformer.
+00005150: 2020 2020 2020 2020 6060 600a 2020 2020          ```.    
+00005160: 2020 2020 3c61 2068 7265 663d 2268 7474      <a href="htt
+00005170: 7073 3a2f 2f69 6d67 6262 2e63 6f6d 2f22  ps://imgbb.com/"
+00005180: 3e3c 696d 6720 7372 633d 2268 7474 7073  ><img src="https
+00005190: 3a2f 2f69 2e69 6262 2e63 6f2f 426e 3756  ://i.ibb.co/Bn7V
+000051a0: 3470 782f 6c61 7a79 2d70 6970 652e 706e  4px/lazy-pipe.pn
+000051b0: 6722 2061 6c74 3d22 6c61 7a79 2d70 6970  g" alt="lazy-pip
+000051c0: 6522 2062 6f72 6465 723d 2230 223e 3c2f  e" border="0"></
+000051d0: 613e 0a20 2020 2020 2020 200a 2020 2020  a>.        .    
+000051e0: 2020 2020 546f 2076 6965 7720 7468 6520      To view the 
+000051f0: 6665 6174 7572 6520 696d 706f 7274 616e  feature importan
+00005200: 6365 7320 6f66 2074 6865 206d 6f64 656c  ces of the model
+00005210: 2069 6e20 7468 6520 7069 7065 6c69 6e65   in the pipeline
+00005220: 2c20 796f 7520 6361 6e20 646f 3a0a 2020  , you can do:.  
+00005230: 2020 2020 2020 6060 600a 2020 2020 2020        ```.      
+00005240: 2020 6c61 7a79 2e70 6c6f 745f 696d 706f    lazy.plot_impo
+00005250: 7274 616e 6365 2829 0a20 2020 2020 2020  rtance().       
+00005260: 2060 6060 0a20 2020 2020 2020 203c 6120   ```.        <a 
+00005270: 6872 6566 3d22 6874 7470 733a 2f2f 6962  href="https://ib
+00005280: 622e 636f 2f6a 6870 7356 744a 223e 3c69  b.co/jhpsVtJ"><i
+00005290: 6d67 2073 7263 3d22 6874 7470 733a 2f2f  mg src="https://
+000052a0: 692e 6962 622e 636f 2f63 4a6d 5662 7159  i.ibb.co/cJmVbqY
+000052b0: 2f6c 617a 792d 6665 6174 2d69 6d70 2e70  /lazy-feat-imp.p
+000052c0: 6e67 2220 616c 743d 226c 617a 792d 6665  ng" alt="lazy-fe
+000052d0: 6174 2d69 6d70 2220 626f 7264 6572 3d22  at-imp" border="
+000052e0: 3022 3e3c 2f61 3e0a 2020 2020 2020 2020  0"></a>.        
+000052f0: 0a20 2020 2020 2020 2023 2320 4d61 696e  .        ## Main
+00005300: 7461 696e 6572 730a 2020 2020 2020 2020  tainers.        
+00005310: 0a20 2020 2020 2020 202a 205b 4041 7574  .        * [@Aut
+00005320: 6f56 694d 4c5d 2868 7474 7073 3a2f 2f67  oViML](https://g
+00005330: 6974 6875 622e 636f 6d2f 4175 746f 5669  ithub.com/AutoVi
+00005340: 4d4c 290a 2020 2020 2020 2020 0a20 2020  ML).        .   
+00005350: 2020 2020 2023 2320 436f 6e74 7269 6275       ## Contribu
+00005360: 7469 6e67 0a20 2020 2020 2020 200a 2020  ting.        .  
+00005370: 2020 2020 2020 5365 6520 5b74 6865 2063        See [the c
+00005380: 6f6e 7472 6962 7574 696e 6720 6669 6c65  ontributing file
+00005390: 5d28 434f 4e54 5249 4255 5449 4e47 2e6d  ](CONTRIBUTING.m
+000053a0: 6429 210a 2020 2020 2020 2020 0a20 2020  d)!.        .   
+000053b0: 2020 2020 2050 5273 2061 6363 6570 7465       PRs accepte
+000053c0: 642e 0a20 2020 2020 2020 200a 2020 2020  d..        .    
+000053d0: 2020 2020 2323 204c 6963 656e 7365 0a20      ## License. 
+000053e0: 2020 2020 2020 200a 2020 2020 2020 2020         .        
+000053f0: 4170 6163 6865 204c 6963 656e 7365 2032  Apache License 2
+00005400: 2e30 20c2 a920 3230 3230 2052 616d 2053  .0 .. 2020 Ram S
+00005410: 6573 6861 6472 690a 2020 2020 2020 2020  eshadri.        
+00005420: 0a20 2020 2020 2020 2023 2320 4e6f 7465  .        ## Note
+00005430: 206f 6620 4772 6174 6974 7564 650a 2020   of Gratitude.  
+00005440: 2020 2020 2020 0a20 2020 2020 2020 2054        .        T
+00005450: 6869 7320 6c69 6272 6179 2077 6f75 6c64  his libray would
+00005460: 206e 6f74 2068 6176 6520 6265 656e 2070   not have been p
+00005470: 6f73 7369 626c 6520 7769 7468 6f75 7420  ossible without 
+00005480: 7468 6520 666f 6c6c 6f77 696e 6720 6772  the following gr
+00005490: 6561 7420 6c69 6272 6172 6965 733a 0a20  eat libraries:. 
+000054a0: 2020 2020 2020 203c 6f6c 3e0a 2020 2020         <ol>.    
+000054b0: 2020 2020 3c6c 693e 3c62 3e43 6174 6567      <li><b>Categ
+000054c0: 6f72 7920 456e 636f 6465 7273 206c 6962  ory Encoders lib
+000054d0: 7261 7279 3a3c 2f62 3e20 4661 6e74 6173  rary:</b> Fantas
+000054e0: 7469 6320 6c69 6272 6172 7920 6874 7470  tic library http
+000054f0: 733a 2f2f 636f 6e74 7269 622e 7363 696b  s://contrib.scik
+00005500: 6974 2d6c 6561 726e 2e6f 7267 2f63 6174  it-learn.org/cat
+00005510: 6567 6f72 795f 656e 636f 6465 7273 2f69  egory_encoders/i
+00005520: 6e64 6578 2e68 746d 6c3c 2f6c 693e 0a20  ndex.html</li>. 
+00005530: 2020 2020 2020 203c 6c69 3e3c 623e 496d         <li><b>Im
+00005540: 6261 6c61 6e63 6564 204c 6561 726e 206c  balanced Learn l
+00005550: 6962 7261 7279 3a3c 2f62 3e20 416e 6f74  ibrary:</b> Anot
+00005560: 6865 7220 6661 6e74 6173 7469 6320 6c69  her fantastic li
+00005570: 6272 6172 7920 6874 7470 733a 2f2f 696d  brary https://im
+00005580: 6261 6c61 6e63 6564 2d6c 6561 726e 2e6f  balanced-learn.o
+00005590: 7267 2f73 7461 626c 652f 696e 6465 782e  rg/stable/index.
+000055a0: 6874 6d6c 3c2f 6c69 3e0a 2020 2020 2020  html</li>.      
+000055b0: 2020 3c6c 693e 3c62 3e54 6865 2061 6d61    <li><b>The ama
+000055c0: 7a69 6e67 2060 6c61 7a79 7072 6564 6963  zing `lazypredic
+000055d0: 7460 3c2f 623e 2077 6173 2061 6e20 696e  t`</b> was an in
+000055e0: 7370 6972 6174 696f 6e20 666f 7220 606c  spiration for `l
+000055f0: 617a 7974 7261 6e73 666f 726d 602e 2059  azytransform`. Y
+00005600: 6f75 2063 616e 2063 6865 636b 206f 7574  ou can check out
+00005610: 2074 6865 206c 6962 7261 7279 2068 6572   the library her
+00005620: 653a 0a20 2020 2020 2020 2068 7474 7073  e:.        https
+00005630: 3a2f 2f67 6974 6875 622e 636f 6d2f 7368  ://github.com/sh
+00005640: 616e 6b61 7270 616e 6461 6c61 2f6c 617a  ankarpandala/laz
+00005650: 7970 7265 6469 6374 0a20 2020 2020 2020  ypredict.       
+00005660: 203c 2f6c 693e 0a20 2020 2020 2020 203c   </li>.        <
+00005670: 6c69 3e3c 623e 5468 6520 616d 617a 696e  li><b>The amazin
+00005680: 6720 604b 6576 696e 204d 6172 6b68 616d  g `Kevin Markham
+00005690: 603c 2f62 3e20 7761 7320 616e 6f74 6865  `</b> was anothe
+000056a0: 7220 696e 7370 6972 6174 696f 6e20 666f  r inspiration fo
+000056b0: 7220 6c61 7a79 7472 616e 7366 6f72 6d2e  r lazytransform.
+000056c0: 2059 6f75 2063 616e 2063 6865 636b 206f   You can check o
+000056d0: 7574 2068 6973 2063 6c61 7373 6573 2068  ut his classes h
+000056e0: 6572 653a 0a20 2020 2020 2020 2068 7474  ere:.        htt
+000056f0: 7073 3a2f 2f77 7777 2e64 6174 6173 6368  ps://www.datasch
+00005700: 6f6f 6c2e 696f 2f61 626f 7574 2f0a 2020  ool.io/about/.  
+00005710: 2020 2020 2020 3c2f 6c69 3e0a 2020 2020        </li>.    
+00005720: 2020 2020 3c2f 6f6c 3e0a 2020 2020 2020      </ol>.      
+00005730: 2020 0a20 2020 2020 2020 2023 2320 4449    .        ## DI
+00005740: 5343 4c41 494d 4552 0a20 2020 2020 2020  SCLAIMER.       
+00005750: 2054 6869 7320 7072 6f6a 6563 7420 6973   This project is
+00005760: 206e 6f74 2061 6e20 6f66 6669 6369 616c   not an official
+00005770: 2047 6f6f 676c 6520 7072 6f6a 6563 742e   Google project.
+00005780: 2049 7420 6973 206e 6f74 2073 7570 706f   It is not suppo
+00005790: 7274 6564 2062 7920 476f 6f67 6c65 2061  rted by Google a
+000057a0: 6e64 2047 6f6f 676c 6520 7370 6563 6966  nd Google specif
+000057b0: 6963 616c 6c79 2064 6973 636c 6169 6d73  ically disclaims
+000057c0: 2061 6c6c 2077 6172 7261 6e74 6965 7320   all warranties 
+000057d0: 6173 2074 6f20 6974 7320 7175 616c 6974  as to its qualit
+000057e0: 792c 206d 6572 6368 616e 7461 6269 6c69  y, merchantabili
+000057f0: 7479 2c20 6f72 2066 6974 6e65 7373 2066  ty, or fitness f
+00005800: 6f72 2061 2070 6172 7469 6375 6c61 7220  or a particular 
+00005810: 7075 7270 6f73 652e 0a20 2020 2020 2020  purpose..       
+00005820: 200a 2020 2020 2020 2020 0a50 6c61 7466   .        .Platf
+00005830: 6f72 6d3a 2055 4e4b 4e4f 574e 0a43 6c61  orm: UNKNOWN.Cla
+00005840: 7373 6966 6965 723a 2050 726f 6772 616d  ssifier: Program
+00005850: 6d69 6e67 204c 616e 6775 6167 6520 3a3a  ming Language ::
+00005860: 2050 7974 686f 6e20 3a3a 2033 0a43 6c61   Python :: 3.Cla
+00005870: 7373 6966 6965 723a 204f 7065 7261 7469  ssifier: Operati
+00005880: 6e67 2053 7973 7465 6d20 3a3a 204f 5320  ng System :: OS 
+00005890: 496e 6465 7065 6e64 656e 740a 4465 7363  Independent.Desc
+000058a0: 7269 7074 696f 6e2d 436f 6e74 656e 742d  ription-Content-
+000058b0: 5479 7065 3a20 7465 7874 2f6d 6172 6b64  Type: text/markd
+000058c0: 6f77 6e0a 0000 0000 0000 0000 0000 0000  own.............
+000058d0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+000058e0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+000058f0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+00005900: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+00005910: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+00005920: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+00005930: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+00005940: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+00005950: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+00005960: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+00005970: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+00005980: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+00005990: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+000059a0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+000059b0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+000059c0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+000059d0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+000059e0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+000059f0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+00005a00: 2e2f 2e2f 4050 6178 4865 6164 6572 0000  ././@PaxHeader..
+00005a10: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+00005a20: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+00005a30: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+00005a40: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+00005a50: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+00005a60: 0000 0000 3030 3030 3030 3000 3030 3030  ....0000000.0000
+00005a70: 3030 3000 3030 3030 3030 3000 3030 3030  000.0000000.0000
+00005a80: 3030 3030 3032 3600 3030 3030 3030 3030  0000026.00000000
+00005a90: 3030 3000 3031 3134 3533 0020 7800 0000  000.011453. x...
+00005aa0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+00005ab0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+00005ac0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+00005ad0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+00005ae0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+00005af0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+00005b00: 0075 7374 6172 0030 3000 0000 0000 0000  .ustar.00.......
+00005b10: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+00005b20: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+00005b30: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+00005b40: 0000 0000 0000 0000 0030 3030 3030 3030  .........0000000
+00005b50: 0030 3030 3030 3030 0000 0000 0000 0000  .0000000........
+00005b60: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+00005b70: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+00005b80: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+00005b90: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+00005ba0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+00005bb0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+00005bc0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+00005bd0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+00005be0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+00005bf0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+00005c00: 3232 206d 7469 6d65 3d31 3637 3730 3733  22 mtime=1677073
+00005c10: 3830 312e 300a 0000 0000 0000 0000 0000  801.0...........
+00005c20: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+00005c30: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+00005c40: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+00005c50: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+00005c60: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+00005c70: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+00005c80: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+00005c90: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+00005ca0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+00005cb0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+00005cc0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+00005cd0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+00005ce0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+00005cf0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+00005d00: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+00005d10: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+00005d20: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+00005d30: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+00005d40: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+00005d50: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+00005d60: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+00005d70: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+00005d80: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+00005d90: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+00005da0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+00005db0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+00005dc0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+00005dd0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+00005de0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+00005df0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+00005e00: 6c61 7a79 7472 616e 7366 6f72 6d2d 312e  lazytransform-1.
+00005e10: 312f 5245 4144 4d45 2e6d 6400 0000 0000  1/README.md.....
+00005e20: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+00005e30: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+00005e40: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+00005e50: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+00005e60: 0000 0000 3030 3030 3737 3700 3030 3031  ....0000777.0001
+00005e70: 3735 3000 3030 3031 3735 3000 3030 3030  750.0001750.0000
+00005e80: 3030 3431 3432 3500 3030 3030 3030 3030  0041425.00000000
+00005e90: 3030 3000 3031 3531 3433 0020 3000 0000  000.015143. 0...
+00005ea0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+00005eb0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+00005ec0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+00005ed0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+00005ee0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+00005ef0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+00005f00: 0075 7374 6172 0030 3072 616d 0000 0000  .ustar.00ram....
+00005f10: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+00005f20: 0000 0000 0000 0000 0072 616d 0000 0000  .........ram....
+00005f30: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+00005f40: 0000 0000 0000 0000 0030 3030 3030 3030  .........0000000
+00005f50: 0030 3030 3030 3030 0000 0000 0000 0000  .0000000........
+00005f60: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+00005f70: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+00005f80: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+00005f90: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+00005fa0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+00005fb0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+00005fc0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+00005fd0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+00005fe0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+00005ff0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+00006000: 2320 6c61 7a79 7472 616e 7366 6f72 6d0a  # lazytransform.
+00006010: 4175 746f 6d61 7469 6361 6c6c 7920 7472  Automatically tr
+00006020: 616e 7366 6f72 6d20 616c 6c20 6361 7465  ansform all cate
+00006030: 676f 7269 6361 6c2c 2064 6174 652d 7469  gorical, date-ti
+00006040: 6d65 2c20 4e4c 5020 7661 7269 6162 6c65  me, NLP variable
+00006050: 7320 696e 2079 6f75 7220 6461 7461 2073  s in your data s
+00006060: 6574 2074 6f20 6e75 6d65 7269 6320 696e  et to numeric in
+00006070: 2061 2073 696e 676c 6520 6c69 6e65 206f   a single line o
+00006080: 6620 636f 6465 2066 6f72 2061 6e79 2064  f code for any d
+00006090: 6174 6120 7365 7420 616e 7920 7369 7a65  ata set any size
+000060a0: 2e0a 0a23 2320 5570 6461 7465 2028 4175  ...## Update (Au
+000060b0: 6720 3230 3232 290a 3c6f 6c3e 0a3c 6c69  g 2022).<ol>.<li
+000060c0: 3e3c 623e 6c61 7a79 7472 616e 7366 6f72  ><b>lazytransfor
+000060d0: 6d20 6973 2076 6572 7920 6561 7379 2074  m is very easy t
+000060e0: 6f20 696e 7374 616c 6c20 6f6e 204b 6167  o install on Kag
+000060f0: 676c 6520 616e 6420 436f 6c61 6220 6e6f  gle and Colab no
+00006100: 7465 626f 6f6b 7320 7573 696e 6720 7468  tebooks using th
+00006110: 6973 2063 6f6d 6d61 6e64 3a3c 2f62 3e2e  is command:</b>.
+00006120: 200a 0a60 6060 0a21 7069 7020 696e 7374   ..```.!pip inst
+00006130: 616c 6c20 6c61 7a79 7472 616e 7366 6f72  all lazytransfor
+00006140: 6d20 2d2d 6967 6e6f 7265 2d69 6e73 7461  m --ignore-insta
+00006150: 6c6c 6564 202d 2d6e 6f2d 6361 6368 6520  lled --no-cache 
+00006160: 2d2d 6e6f 2d64 6570 730a 6060 600a 3c2f  --no-deps.```.</
+00006170: 6c69 3e3c 6272 3e0a 3c6c 693e 3c62 3e6c  li><br>.<li><b>l
+00006180: 617a 7974 7261 6e73 666f 726d 2061 7320  azytransform as 
+00006190: 6f66 2076 6572 7369 6f6e 2030 2e39 3120  of version 0.91 
+000061a0: 6861 7320 7477 6f20 5375 7065 7220 4c65  has two Super Le
+000061b0: 6172 6e69 6e67 204f 7074 696d 697a 6564  arning Optimized
+000061c0: 2028 5355 4c4f 2920 456e 7365 6d62 6c65   (SULO) Ensemble
+000061d0: 7320 6e61 6d65 6420 2253 756c 6f43 6c61  s named "SuloCla
+000061e0: 7373 6966 6965 7222 2061 6e64 2022 5375  ssifier" and "Su
+000061f0: 6c6f 5265 6772 6573 736f 7222 3c2f 623e  loRegressor"</b>
+00006200: 2e20 5468 6520 6573 7469 6d61 746f 7273  . The estimators
+00006210: 2061 7265 2022 6f70 7469 6d69 7a65 6422   are "optimized"
+00006220: 2069 6e20 7468 6520 7365 6e73 6520 7468   in the sense th
+00006230: 6174 2079 6f75 2063 616e 2075 7365 2074  at you can use t
+00006240: 6865 6d20 666f 7220 616c 6c20 6b69 6e64  hem for all kind
+00006250: 7320 6f66 206d 756c 7469 2d6c 6162 656c  s of multi-label
+00006260: 206d 756c 7469 2d63 6c61 7373 2061 6e64   multi-class and
+00006270: 2049 6d62 616c 616e 6365 6420 6461 7461   Imbalanced data
+00006280: 2073 6574 2070 726f 626c 656d 7320 7769   set problems wi
+00006290: 7468 6f75 7420 6e65 6564 696e 6720 746f  thout needing to
+000062a0: 2064 6f20 6879 7065 722d 7061 7261 6d65   do hyper-parame
+000062b0: 7465 7220 7475 6e69 6e67 2077 6974 6820  ter tuning with 
+000062c0: 4772 6964 5365 6172 6368 4356 2e20 5468  GridSearchCV. Th
+000062d0: 6579 2061 7265 2062 7569 6c74 2075 7369  ey are built usi
+000062e0: 6e67 2062 6173 6963 2073 6369 6b69 742d  ng basic scikit-
+000062f0: 6c65 6172 6e20 6573 7469 6d61 746f 7273  learn estimators
+00006300: 2061 6e64 2061 7265 2073 656c 662d 6f70   and are self-op
+00006310: 7469 6d69 7a69 6e67 2073 696e 6365 2074  timizing since t
+00006320: 6865 7920 7065 7266 6f72 6d20 6879 7065  hey perform hype
+00006330: 722d 7061 7261 6d20 7475 6e69 6e67 2066  r-param tuning f
+00006340: 6f72 2065 6163 6820 6b69 6e64 206f 6620  or each kind of 
+00006350: 7072 6f62 6c65 6d20 616e 6420 7573 6520  problem and use 
+00006360: 7765 6967 6874 7320 666f 7220 6561 6368  weights for each
+00006370: 2063 6c61 7373 6966 6965 7220 6f72 2072   classifier or r
+00006380: 6567 7265 7373 6f72 2c20 6469 6666 6572  egressor, differ
+00006390: 656e 7420 7261 6e64 6f6d 2073 6565 6473  ent random seeds
+000063a0: 2c20 6574 632e 2074 6f20 6d61 6b65 2074  , etc. to make t
+000063b0: 6865 6d20 6869 6768 6c79 2070 6572 666f  hem highly perfo
+000063c0: 726d 616e 742e 204f 6e20 746f 7020 6f66  rmant. On top of
+000063d0: 2069 742c 2074 6865 7920 6172 6520 6675   it, they are fu
+000063e0: 6c6c 7920 7363 696b 6974 2d6c 6561 726e  lly scikit-learn
+000063f0: 2063 6f6d 7061 7469 626c 6520 7769 7468   compatible with
+00006400: 2074 6865 2073 616d 6520 2266 6974 2061   the same "fit a
+00006410: 6e64 2070 7265 6469 6374 2220 7379 6e74  nd predict" synt
+00006420: 6178 2e20 3c2f 6c69 3e0a 5461 6b65 2061  ax. </li>.Take a
+00006430: 206c 6f6f 6b20 6174 2074 6865 2062 656e   look at the ben
+00006440: 6368 6d61 726b 696e 6720 7265 7375 6c74  chmarking result
+00006450: 7320 6e6f 7465 626f 6f6b 2068 6572 6520  s notebook here 
+00006460: 666f 7220 5375 6c6f 436c 6173 7369 6669  for SuloClassifi
+00006470: 6572 3a20 0a0a 215b 4e6f 7465 626f 6f6b  er: ..![Notebook
+00006480: 5d28 6874 7470 733a 2f2f 6769 7468 7562  ](https://github
+00006490: 2e63 6f6d 2f41 7574 6f56 694d 4c2f 6c61  .com/AutoViML/la
+000064a0: 7a79 7472 616e 7366 6f72 6d2f 7472 6565  zytransform/tree
+000064b0: 2f6d 6169 6e2f 6e6f 7465 626f 6f6b 732f  /main/notebooks/
+000064c0: 5375 6c6f 436c 6173 7369 6669 6572 5f42  SuloClassifier_B
+000064d0: 656e 6368 6d61 726b 696e 675f 5265 7375  enchmarking_Resu
+000064e0: 6c74 732e 6970 796e 6229 0a0a 215b 5375  lts.ipynb)..![Su
+000064f0: 6c6f 436c 6173 7369 6669 6572 5d28 2e2f  loClassifier](./
+00006500: 696d 6167 6573 2f53 756c 6f43 6c61 7373  images/SuloClass
+00006510: 6966 6965 722e 706e 6729 0a0a 5765 2072  ifier.png)..We r
+00006520: 616e 2061 2073 696d 696c 6172 2062 656e  an a similar ben
+00006530: 6368 6d61 726b 696e 6720 7265 7375 6c74  chmarking result
+00006540: 2069 6e20 5375 6c6f 5265 6772 6573 736f   in SuloRegresso
+00006550: 7220 6167 6169 6e73 7420 5847 426f 6f73  r against XGBoos
+00006560: 7420 616e 6420 4c69 6768 7447 424d 2052  t and LightGBM R
+00006570: 6567 7265 7373 6f72 7320 616e 6420 6974  egressors and it
+00006580: 2068 656c 6420 6974 7320 6f77 6e20 6167   held its own ag
+00006590: 6169 6e73 7420 7468 656d 2e20 5461 6b65  ainst them. Take
+000065a0: 2061 206c 6f6f 6b20 6174 2074 6865 2062   a look at the b
+000065b0: 656e 6368 6d61 726b 696e 6720 7265 7375  enchmarking resu
+000065c0: 6c74 3a0a 0a21 5b4e 6f74 6562 6f6f 6b5d  lt:..![Notebook]
+000065d0: 2868 7474 7073 3a2f 2f67 6974 6875 622e  (https://github.
+000065e0: 636f 6d2f 4175 746f 5669 4d4c 2f6c 617a  com/AutoViML/laz
+000065f0: 7974 7261 6e73 666f 726d 2f74 7265 652f  ytransform/tree/
+00006600: 6d61 696e 2f6e 6f74 6562 6f6f 6b73 2f53  main/notebooks/S
+00006610: 756c 6f52 6567 7265 7373 6f72 5f42 656e  uloRegressor_Ben
+00006620: 6368 6d61 726b 696e 675f 5265 7375 6c74  chmarking_Result
+00006630: 732e 6970 796e 6229 0a0a 215b 5375 6c6f  s.ipynb)..![Sulo
+00006640: 5265 6772 6573 736f 725d 282e 2f69 6d61  Regressor](./ima
+00006650: 6765 732f 5375 6c6f 5265 6772 6573 736f  ges/SuloRegresso
+00006660: 722e 706e 6729 0a0a 2320 5461 626c 6520  r.png)..# Table 
+00006670: 6f66 2043 6f6e 7465 6e74 730a 3c75 6c3e  of Contents.<ul>
+00006680: 0a3c 6c69 3e3c 6120 6872 6566 3d22 2369  .<li><a href="#i
+00006690: 6e74 726f 6475 6374 696f 6e22 3e57 6861  ntroduction">Wha
+000066a0: 7420 6973 206c 617a 7974 7261 6e73 666f  t is lazytransfo
+000066b0: 726d 3c2f 613e 3c2f 6c69 3e0a 3c6c 693e  rm</a></li>.<li>
+000066c0: 3c61 2068 7265 663d 2223 7573 6573 223e  <a href="#uses">
+000066d0: 486f 7720 746f 2075 7365 206c 617a 7974  How to use lazyt
+000066e0: 7261 6e73 666f 726d 3c2f 613e 3c2f 6c69  ransform</a></li
+000066f0: 3e0a 3c6c 693e 3c61 2068 7265 663d 2223  >.<li><a href="#
+00006700: 696e 7374 616c 6c22 3e48 6f77 2074 6f20  install">How to 
+00006710: 696e 7374 616c 6c20 6c61 7a79 7472 616e  install lazytran
+00006720: 7366 6f72 6d3c 2f61 3e3c 2f6c 693e 0a3c  sform</a></li>.<
+00006730: 6c69 3e3c 6120 6872 6566 3d22 2375 7361  li><a href="#usa
+00006740: 6765 223e 5573 6167 653c 2f61 3e3c 2f6c  ge">Usage</a></l
+00006750: 693e 0a3c 6c69 3e3c 6120 6872 6566 3d22  i>.<li><a href="
+00006760: 2361 7069 223e 4150 493c 2f61 3e3c 2f6c  #api">API</a></l
+00006770: 693e 0a3c 6c69 3e3c 6120 6872 6566 3d22  i>.<li><a href="
+00006780: 236d 6169 6e74 6169 6e65 7273 223e 4d61  #maintainers">Ma
+00006790: 696e 7461 696e 6572 733c 2f61 3e3c 2f6c  intainers</a></l
+000067a0: 693e 0a3c 6c69 3e3c 6120 6872 6566 3d22  i>.<li><a href="
+000067b0: 2363 6f6e 7472 6962 7574 696e 6722 3e43  #contributing">C
+000067c0: 6f6e 7472 6962 7574 696e 673c 2f61 3e3c  ontributing</a><
+000067d0: 2f6c 693e 0a3c 6c69 3e3c 6120 6872 6566  /li>.<li><a href
+000067e0: 3d22 236c 6963 656e 7365 223e 4c69 6365  ="#license">Lice
+000067f0: 6e73 653c 2f61 3e3c 2f6c 693e 0a3c 2f75  nse</a></li>.</u
+00006800: 6c3e 0a3c 703e 0a0a 2323 2049 6e74 726f  l>.<p>..## Intro
+00006810: 6475 6374 696f 6e0a 2323 2320 5768 6174  duction.### What
+00006820: 2069 7320 6c61 7a79 7472 616e 7366 6f72   is lazytransfor
+00006830: 6d3f 0a60 6c61 7a79 7472 616e 7366 6f72  m?.`lazytransfor
+00006840: 6d60 2069 7320 6120 6e65 7720 7079 7468  m` is a new pyth
+00006850: 6f6e 206c 6962 7261 7279 2066 6f72 2061  on library for a
+00006860: 7574 6f6d 6174 6963 616c 6c79 2074 7261  utomatically tra
+00006870: 6e73 666f 726d 696e 6720 796f 7572 2065  nsforming your e
+00006880: 6e74 6972 6520 6461 7461 7365 7420 746f  ntire dataset to
+00006890: 206e 756d 6572 6963 2066 6f72 6d61 7420   numeric format 
+000068a0: 7573 696e 6720 6361 7465 676f 7279 2065  using category e
+000068b0: 6e63 6f64 6572 732c 204e 4c50 2074 6578  ncoders, NLP tex
+000068c0: 7420 7665 6374 6f72 697a 6572 7320 616e  t vectorizers an
+000068d0: 6420 7061 6e64 6173 2064 6174 6520 7469  d pandas date ti
+000068e0: 6d65 2070 726f 6365 7373 696e 6720 6675  me processing fu
+000068f0: 6e63 7469 6f6e 732e 2041 6c6c 2069 6e20  nctions. All in 
+00006900: 6120 7369 6e67 6c65 206c 696e 6520 6f66  a single line of
+00006910: 2063 6f64 6521 0a0a 215b 6c61 7a79 7472   code!..![lazytr
+00006920: 616e 7366 6f72 6d65 725d 282e 2f69 6d61  ansformer](./ima
+00006930: 6765 732f 6c61 7a79 7472 616e 7366 6f72  ges/lazytransfor
+00006940: 6d65 722e 6a70 6729 0a0a 2323 2055 7365  mer.jpg)..## Use
+00006950: 730a 606c 617a 7974 7261 6e73 666f 726d  s.`lazytransform
+00006960: 6020 6861 7320 7477 6f20 696d 706f 7274  ` has two import
+00006970: 616e 7420 7573 6573 2069 6e20 7468 6520  ant uses in the 
+00006980: 4461 7461 2053 6369 656e 6365 2070 726f  Data Science pro
+00006990: 6365 7373 2e20 4974 2063 616e 2062 6520  cess. It can be 
+000069a0: 7573 6564 2069 6e20 4665 6174 7572 6520  used in Feature 
+000069b0: 456e 6767 2074 6f20 7472 616e 7366 6f72  Engg to transfor
+000069c0: 6d20 6665 6174 7572 6573 206f 7220 6164  m features or ad
+000069d0: 6420 6665 6174 7572 6573 2028 7365 6520  d features (see 
+000069e0: 4150 4920 6265 6c6f 7729 2e20 4974 2063  API below). It c
+000069f0: 616e 2061 6c73 6f20 6265 2075 7365 6420  an also be used 
+00006a00: 696e 204d 4c4f 7073 2074 6f20 7472 6169  in MLOps to trai
+00006a10: 6e20 616e 6420 6576 616c 7561 7465 206d  n and evaluate m
+00006a20: 6f64 656c 7320 696e 2064 6174 6120 7069  odels in data pi
+00006a30: 7065 6c69 6e65 7320 7769 7468 206d 756c  pelines with mul
+00006a40: 7469 706c 6520 6d6f 6465 6c73 2062 6569  tiple models bei
+00006a50: 6e67 2074 7261 696e 6564 2073 696d 756c  ng trained simul
+00006a60: 7461 6e65 7573 6c79 2075 7369 6e67 2074  taneusly using t
+00006a70: 6865 2073 616d 6520 7472 6169 6e2f 7465  he same train/te
+00006a80: 7374 2073 706c 6974 2061 6e64 2074 6865  st split and the
+00006a90: 2073 616d 6520 6665 6174 7572 6520 656e   same feature en
+00006aa0: 6767 2073 7465 7073 2e20 5468 6973 2065  gg steps. This e
+00006ab0: 6e73 7572 6573 2074 6861 7420 7468 6572  nsures that ther
+00006ac0: 6520 6973 2061 6273 6f6c 7574 656c 7920  e is absolutely 
+00006ad0: 7a65 726f 206f 7220 6d69 6e69 6d61 6c20  zero or minimal 
+00006ae0: 6461 7461 206c 6561 6b61 6765 2069 6e20  data leakage in 
+00006af0: 796f 7572 204d 4c4f 7073 2070 6970 656c  your MLOps pipel
+00006b00: 696e 6573 2e0a 0a23 2323 2031 2e20 2055  ines...### 1.  U
+00006b10: 7369 6e67 206c 617a 7974 7261 6e73 666f  sing lazytransfo
+00006b20: 726d 2061 7320 6120 7369 6d70 6c65 2070  rm as a simple p
+00006b30: 616e 6461 7320 6461 7461 2074 7261 6e73  andas data trans
+00006b40: 666f 726d 6174 696f 6e20 7069 7065 6c69  formation pipeli
+00006b50: 6e65 200a 0a3c 703e 5468 6520 6669 7273  ne ..<p>The firs
+00006b60: 7420 6d65 7468 6f64 2069 7320 7072 6f62  t method is prob
+00006b70: 6162 6c79 2074 6865 206d 6f73 7420 706f  ably the most po
+00006b80: 7075 6c61 7220 7761 7920 746f 2075 7365  pular way to use
+00006b90: 206c 617a 7974 7261 6e73 666f 726d 2e20   lazytransform. 
+00006ba0: 5468 6520 7472 616e 7366 6f72 6d65 7220  The transformer 
+00006bb0: 7769 7468 696e 206c 617a 7974 7261 6e73  within lazytrans
+00006bc0: 666f 726d 2063 616e 2062 6520 7573 6564  form can be used
+00006bd0: 2074 6f20 7472 616e 7366 6f72 6d20 616e   to transform an
+00006be0: 6420 6372 6561 7465 206e 6577 2066 6561  d create new fea
+00006bf0: 7475 7265 7320 6672 6f6d 2063 6174 6567  tures from categ
+00006c00: 6f72 6963 616c 2c20 6461 7465 2d74 696d  orical, date-tim
+00006c10: 6520 616e 6420 4e4c 5020 2874 6578 7429  e and NLP (text)
+00006c20: 2066 6561 7475 7265 7320 696e 2079 6f75   features in you
+00006c30: 7220 6461 7461 7365 742e 2054 6869 7320  r dataset. This 
+00006c40: 7472 616e 7366 6f72 6d65 7220 7069 7065  transformer pipe
+00006c50: 6c69 6e65 2069 7320 6675 6c6c 7920 7363  line is fully sc
+00006c60: 696b 6974 2d6c 6561 726e 2050 6970 656c  ikit-learn Pipel
+00006c70: 696e 6520 636f 6d70 6174 6962 6c65 2061  ine compatible a
+00006c80: 6e64 2063 616e 2062 6520 7573 6564 2074  nd can be used t
+00006c90: 6f20 6275 696c 6420 6576 656e 206d 6f72  o build even mor
+00006ca0: 6520 636f 6d70 6c65 7820 7069 7065 6c69  e complex pipeli
+00006cb0: 6e65 7320 6279 2079 6f75 2062 6173 6564  nes by you based
+00006cc0: 206f 6e20 606d 616b 655f 7069 7065 6c69   on `make_pipeli
+00006cd0: 6e65 6020 7374 6174 656d 656e 7420 6672  ne` statement fr
+00006ce0: 6f6d 2060 736b 6c65 6172 6e2e 7069 7065  om `sklearn.pipe
+00006cf0: 6c69 6e65 6020 6c69 6272 6172 792e 203c  line` library. <
+00006d00: 6120 6872 6566 3d22 6874 7470 733a 2f2f  a href="https://
+00006d10: 6769 7468 7562 2e63 6f6d 2f41 7574 6f56  github.com/AutoV
+00006d20: 694d 4c2f 6c61 7a79 7472 616e 7366 6f72  iML/lazytransfor
+00006d30: 6d2f 626c 6f62 2f6d 6169 6e2f 4665 6174  m/blob/main/Feat
+00006d40: 7572 6577 697a 5f4c 617a 7954 7261 6e73  urewiz_LazyTrans
+00006d50: 666f 726d 5f44 656d 6f31 2e69 7079 6e62  form_Demo1.ipynb
+00006d60: 223e 4c65 7420 7573 2073 6565 2061 6e20  ">Let us see an 
+00006d70: 6578 616d 706c 653c 2f61 3e3a 3c70 3e0a  example</a>:<p>.
+00006d80: 0a3c 6120 6872 6566 3d22 6874 7470 733a  .<a href="https:
+00006d90: 2f2f 6962 622e 636f 2f78 664d 516e 4e7a  //ibb.co/xfMQnNz
+00006da0: 223e 3c69 6d67 2073 7263 3d22 6874 7470  "><img src="http
+00006db0: 733a 2f2f 692e 6962 622e 636f 2f5a 5968  s://i.ibb.co/ZYh
+00006dc0: 4351 3063 2f6c 617a 792d 636f 6465 312e  CQ0c/lazy-code1.
+00006dd0: 706e 6722 2061 6c74 3d22 6c61 7a79 2d63  png" alt="lazy-c
+00006de0: 6f64 6531 2220 626f 7264 6572 3d22 3022  ode1" border="0"
+00006df0: 3e3c 2f61 3e0a 0a23 2323 2032 2e20 2055  ></a>..### 2.  U
+00006e00: 7369 6e67 206c 617a 7974 7261 6e73 666f  sing lazytransfo
+00006e10: 726d 2061 7320 6120 736b 6c65 6172 6e20  rm as a sklearn 
+00006e20: 7069 7065 6c69 6e65 2077 6974 6820 736b  pipeline with sk
+00006e30: 6c65 6172 6e20 6d6f 6465 6c73 206f 7220  learn models or 
+00006e40: 5847 426f 6f73 7420 6f72 204c 6967 6874  XGBoost or Light
+00006e50: 4742 4d20 6d6f 6465 6c73 0a0a 3c70 3e54  GBM models..<p>T
+00006e60: 6865 2073 6563 6f6e 6420 6d65 7468 6f64  he second method
+00006e70: 2069 7320 6120 6772 6561 7420 7761 7920   is a great way 
+00006e80: 746f 2063 7265 6174 6520 616e 2065 6e74  to create an ent
+00006e90: 6972 6520 6461 7461 2074 7261 6e73 666f  ire data transfo
+00006ea0: 726d 2061 6e64 206d 6f64 656c 2074 7261  rm and model tra
+00006eb0: 696e 696e 6720 7069 7065 6c69 6e65 2077  ining pipeline w
+00006ec0: 6974 6820 6162 736f 6c75 7465 6c79 206e  ith absolutely n
+00006ed0: 6f20 6461 7461 206c 6561 6b61 6765 2e20  o data leakage. 
+00006ee0: 606c 617a 7974 7261 6e73 666f 726d 6020  `lazytransform` 
+00006ef0: 616c 6c6f 7773 2079 6f75 2074 6f20 7365  allows you to se
+00006f00: 6e64 2069 6e20 6120 6d6f 6465 6c20 6f62  nd in a model ob
+00006f10: 6a65 6374 2028 6f6e 6c79 2074 6865 2066  ject (only the f
+00006f20: 6f6c 6c6f 7769 6e67 2061 7265 2073 7570  ollowing are sup
+00006f30: 706f 7274 6564 2920 616e 6420 6974 2077  ported) and it w
+00006f40: 696c 6c20 6175 746f 6d61 7469 6361 6c6c  ill automaticall
+00006f50: 7920 7472 616e 7366 6f72 6d2c 2063 7265  y transform, cre
+00006f60: 6174 6520 6e65 7720 6665 6174 7572 6573  ate new features
+00006f70: 2061 6e64 2074 7261 696e 2061 206d 6f64   and train a mod
+00006f80: 656c 2075 7369 6e67 2073 6b6c 6561 726e  el using sklearn
+00006f90: 2070 6970 656c 696e 6573 2e20 3c61 2068   pipelines. <a h
+00006fa0: 7265 663d 2268 7474 7073 3a2f 2f67 6974  ref="https://git
+00006fb0: 6875 622e 636f 6d2f 4175 746f 5669 4d4c  hub.com/AutoViML
+00006fc0: 2f6c 617a 7974 7261 6e73 666f 726d 2f62  /lazytransform/b
+00006fd0: 6c6f 622f 6d61 696e 2f46 6561 7475 7265  lob/main/Feature
+00006fe0: 7769 7a5f 4c61 7a79 5472 616e 7366 6f72  wiz_LazyTransfor
+00006ff0: 6d5f 4465 6d6f 322e 6970 796e 6222 3e54  m_Demo2.ipynb">T
+00007000: 6869 7320 6d65 7468 6f64 2063 616e 2062  his method can b
+00007010: 6520 7365 656e 2061 7320 666f 6c6c 6f77  e seen as follow
+00007020: 733c 2f61 3e3a 3c62 723e 0a0a 3c61 2068  s</a>:<br>..<a h
+00007030: 7265 663d 2268 7474 7073 3a2f 2f69 6262  ref="https://ibb
+00007040: 2e63 6f2f 5431 574e 687a 5422 3e3c 696d  .co/T1WNhzT"><im
+00007050: 6720 7372 633d 2268 7474 7073 3a2f 2f69  g src="https://i
+00007060: 2e69 6262 2e63 6f2f 304b 737a 4a50 582f  .ibb.co/0KszJPX/
+00007070: 6c61 7a79 2d63 6f64 6532 2e70 6e67 2220  lazy-code2.png" 
+00007080: 616c 743d 226c 617a 792d 636f 6465 3222  alt="lazy-code2"
+00007090: 2062 6f72 6465 723d 2230 223e 3c2f 613e   border="0"></a>
+000070a0: 0a0a 2323 2320 332e 2020 5573 696e 6720  ..### 3.  Using 
+000070b0: 6c61 7a79 7472 616e 7366 6f72 6d20 696e  lazytransform in
+000070c0: 2047 7269 6453 6561 7263 6843 5620 746f   GridSearchCV to
+000070d0: 2066 696e 6420 7468 6520 6265 7374 206d   find the best m
+000070e0: 6f64 656c 2070 6970 656c 696e 650a 3c70  odel pipeline.<p
+000070f0: 3e54 6865 2074 6869 7264 206d 6574 686f  >The third metho
+00007100: 6420 6973 2061 2067 7265 6174 2077 6179  d is a great way
+00007110: 2074 6f20 6669 6e64 2074 6865 2062 6573   to find the bes
+00007120: 7420 6461 7461 2074 7261 6e73 666f 726d  t data transform
+00007130: 6174 696f 6e20 616e 6420 6d6f 6465 6c20  ation and model 
+00007140: 7472 6169 6e69 6e67 2070 6970 656c 696e  training pipelin
+00007150: 6520 7573 696e 6720 4772 6964 5365 6172  e using GridSear
+00007160: 6368 4356 206f 7220 5261 6e64 6f6d 697a  chCV or Randomiz
+00007170: 6564 5365 6172 6368 4356 2061 6c6f 6e67  edSearchCV along
+00007180: 2077 6974 6820 6120 4c69 6768 7447 424d   with a LightGBM
+00007190: 206f 7220 5847 426f 6f73 7420 6f72 2073   or XGBoost or s
+000071a0: 6369 6b69 742d 6c65 6172 6e20 6d6f 6465  cikit-learn mode
+000071b0: 6c2e 2054 6869 7320 6973 2065 7870 6c61  l. This is expla
+000071c0: 696e 6564 2076 6572 7920 636c 6561 726c  ined very clearl
+000071d0: 7920 696e 2074 6865 203c 6120 6872 6566  y in the <a href
+000071e0: 3d22 6874 7470 733a 2f2f 6769 7468 7562  ="https://github
+000071f0: 2e63 6f6d 2f41 7574 6f56 694d 4c2f 6c61  .com/AutoViML/la
+00007200: 7a79 7472 616e 7366 6f72 6d2f 626c 6f62  zytransform/blob
+00007210: 2f6d 6169 6e2f 4c61 7a79 5472 616e 7366  /main/LazyTransf
+00007220: 6f72 6d65 725f 7769 7468 5f47 7269 6453  ormer_with_GridS
+00007230: 6561 7263 685f 5069 7065 6c69 6e65 2e69  earch_Pipeline.i
+00007240: 7079 6e62 223e 4c61 7a79 5472 616e 7366  pynb">LazyTransf
+00007250: 6f72 6d65 725f 7769 7468 5f47 7269 6453  ormer_with_GridS
+00007260: 6561 7263 685f 5069 7065 6c69 6e65 2e69  earch_Pipeline.i
+00007270: 7079 6e62 3c2f 613e 206e 6f74 6562 6f6f  pynb</a> noteboo
+00007280: 6b20 696e 2074 6865 2073 616d 6520 6769  k in the same gi
+00007290: 7468 7562 2068 6572 652e 204d 616b 6520  thub here. Make 
+000072a0: 7375 7265 2079 6f75 2063 6865 636b 2069  sure you check i
+000072b0: 7420 6f75 7421 0a0a 3c61 2068 7265 663d  t out!..<a href=
+000072c0: 2268 7474 7073 3a2f 2f69 6262 2e63 6f2f  "https://ibb.co/
+000072d0: 5747 766e 716a 7322 3e3c 696d 6720 7372  WGvnqjs"><img sr
+000072e0: 633d 2268 7474 7073 3a2f 2f69 2e69 6262  c="https://i.ibb
+000072f0: 2e63 6f2f 7858 7168 5064 332f 6c61 7a79  .co/xXqhPd3/lazy
+00007300: 2d67 7269 6473 6561 7263 682e 706e 6722  -gridsearch.png"
+00007310: 2061 6c74 3d22 6c61 7a79 2d67 7269 6473   alt="lazy-grids
+00007320: 6561 7263 6822 2062 6f72 6465 723d 2230  earch" border="0
+00007330: 223e 3c2f 613e 3c62 7220 2f3e 0a0a 3c70  "></a><br />..<p
+00007340: 3e0a 5468 6520 666f 6c6c 6f77 696e 6720  >.The following 
+00007350: 6d6f 6465 6c73 2061 7265 2063 7572 7265  models are curre
+00007360: 6e74 6c79 2073 7570 706f 7274 6564 3a0a  ntly supported:.
+00007370: 3c6f 6c3e 0a3c 6c69 3e41 6c6c 2073 6b6c  <ol>.<li>All skl
+00007380: 6561 726e 206d 6f64 656c 733c 2f6c 693e  earn models</li>
+00007390: 0a3c 6c69 3e41 6c6c 204d 756c 7469 4f75  .<li>All MultiOu
+000073a0: 7470 7574 206d 6f64 656c 7320 6672 6f6d  tput models from
+000073b0: 2073 6b6c 6561 726e 2e6d 756c 7469 6f75   sklearn.multiou
+000073c0: 7470 7574 206c 6962 7261 7279 3c2f 6c69  tput library</li
+000073d0: 3e0a 3c6c 693e 5847 626f 6f73 7420 6d6f  >.<li>XGboost mo
+000073e0: 6465 6c73 3c2f 6c69 3e0a 3c6c 693e 4c69  dels</li>.<li>Li
+000073f0: 6768 7447 424d 206d 6f64 656c 733c 2f6c  ghtGBM models</l
+00007400: 693e 0a3c 2f6f 6c3e 0a48 6f77 6576 6572  i>.</ol>.However
+00007410: 2c20 796f 7520 6d75 7374 2069 6e73 7461  , you must insta
+00007420: 6c6c 2061 6e64 2069 6d70 6f72 7420 7468  ll and import th
+00007430: 6f73 6520 6d6f 6465 6c73 206f 6e20 796f  ose models on yo
+00007440: 7572 206f 776e 2061 6e64 2064 6566 696e  ur own and defin
+00007450: 6520 7468 656d 2061 7320 6d6f 6465 6c20  e them as model 
+00007460: 7661 7269 6162 6c65 7320 6265 666f 7265  variables before
+00007470: 2070 6173 7369 6e67 2074 686f 7365 2076   passing those v
+00007480: 6172 6961 626c 6573 2074 6f20 6c61 7a79  ariables to lazy
+00007490: 7472 616e 7366 6f72 6d2e 0a0a 2323 2049  transform...## I
+000074a0: 6e73 7461 6c6c 0a3c 703e 0a0a 2a2a 5072  nstall.<p>..**Pr
+000074b0: 6572 6571 7573 6974 6573 3a2a 2a0a 3c6f  erequsites:**.<o
+000074c0: 6c3e 0a3c 6c69 3e3c 623e 6c61 7a79 7472  l>.<li><b>lazytr
+000074d0: 616e 7366 6f72 6d20 6973 2062 7569 6c74  ansform is built
+000074e0: 2075 7369 6e67 2070 616e 6461 732c 206e   using pandas, n
+000074f0: 756d 7079 2c20 7363 696b 6974 2d6c 6561  umpy, scikit-lea
+00007500: 726e 2c20 6361 7465 676f 7279 5f65 6e63  rn, category_enc
+00007510: 6f64 6572 7320 616e 6420 696d 6261 6c61  oders and imbala
+00007520: 6e63 6564 2d6c 6561 726e 206c 6962 7261  nced-learn libra
+00007530: 7269 6573 2e3c 2f62 3e20 4974 2073 686f  ries.</b> It sho
+00007540: 756c 6420 7275 6e20 6f6e 206d 6f73 7420  uld run on most 
+00007550: 5079 7468 6f6e 3320 416e 6163 6f6e 6461  Python3 Anaconda
+00007560: 2069 6e73 7461 6c6c 6174 696f 6e73 2077   installations w
+00007570: 6974 686f 7574 2061 6464 6974 696f 6e61  ithout additiona
+00007580: 6c20 696e 7374 616c 6c73 2e20 596f 7520  l installs. You 
+00007590: 776f 6e27 7420 6861 7665 2074 6f20 696d  won't have to im
+000075a0: 706f 7274 2061 6e79 2073 7065 6369 616c  port any special
+000075b0: 206c 6962 7261 7269 6573 206f 7468 6572   libraries other
+000075c0: 2074 6861 6e20 2269 6d62 616c 616e 6365   than "imbalance
+000075d0: 642d 6c65 6172 6e22 2061 6e64 2022 6361  d-learn" and "ca
+000075e0: 7465 676f 7279 5f65 6e63 6f64 6572 7322  tegory_encoders"
+000075f0: 2e3c 2f6c 693e 0a3c 2f6f 6c3e 0a54 6865  .</li>.</ol>.The
+00007600: 2062 6573 7420 6d65 7468 6f64 2074 6f20   best method to 
+00007610: 696e 7374 616c 6c20 6c61 7a79 7472 616e  install lazytran
+00007620: 7366 6f72 6d20 6973 2074 6f20 7573 6520  sform is to use 
+00007630: 636f 6e64 613a 3c70 3e0a 0a60 6060 0a63  conda:<p>..```.c
+00007640: 6f6e 6461 2069 6e73 7461 6c6c 202d 6320  onda install -c 
+00007650: 636f 6e64 612d 666f 7267 6520 6c61 7a79  conda-forge lazy
+00007660: 7472 616e 7366 6f72 6d0a 6060 600a 3c61  transform.```.<a
+00007670: 2068 7265 663d 2268 7474 7073 3a2f 2f69   href="https://i
+00007680: 6262 2e63 6f2f 6658 6e62 5064 3622 3e3c  bb.co/fXnbPd6"><
+00007690: 696d 6720 7372 633d 2268 7474 7073 3a2f  img src="https:/
+000076a0: 2f69 2e69 6262 2e63 6f2f 7144 577a 5059  /i.ibb.co/qDWzPY
+000076b0: 712f 636f 6e64 612d 696e 7374 616c 6c2e  q/conda-install.
+000076c0: 706e 6722 2061 6c74 3d22 636f 6e64 612d  png" alt="conda-
+000076d0: 696e 7374 616c 6c22 2062 6f72 6465 723d  install" border=
+000076e0: 2230 223e 3c2f 613e 3c62 723e 0a54 6865  "0"></a><br>.The
+000076f0: 2073 6563 6f6e 6420 6265 7374 2069 6e73   second best ins
+00007700: 7461 6c6c 6174 696f 6e20 6d65 7468 6f64  tallation method
+00007710: 2069 7320 746f 2075 7365 2022 7069 7020   is to use "pip 
+00007720: 696e 7374 616c 6c22 2e0a 0a60 6060 0a70  install"...```.p
+00007730: 6970 2069 6e73 7461 6c6c 206c 617a 7974  ip install lazyt
+00007740: 7261 6e73 666f 726d 200a 6060 600a 416c  ransform .```.Al
+00007750: 6572 7421 2057 6865 6e20 7573 696e 6720  ert! When using 
+00007760: 436f 6c61 6220 6f72 204b 6167 676c 6520  Colab or Kaggle 
+00007770: 4e6f 7465 626f 6f6b 732c 2079 6f75 206d  Notebooks, you m
+00007780: 7573 7420 7573 6520 6120 736c 6967 6874  ust use a slight
+00007790: 6c79 206d 6f64 6966 7920 696e 7374 616c  ly modify instal
+000077a0: 6c61 7469 6f6e 2070 726f 6365 7373 2062  lation process b
+000077b0: 656c 6f77 2e20 4966 2079 6f75 2064 6f6e  elow. If you don
+000077c0: 2774 2064 6f20 7468 6973 2c20 796f 7520  't do this, you 
+000077d0: 7769 6c6c 2067 6574 2077 6569 7264 2065  will get weird e
+000077e0: 7272 6f72 7320 696e 2074 686f 7365 2070  rrors in those p
+000077f0: 6c61 7466 6f72 6d73 210a 0a60 6060 0a70  latforms!..```.p
+00007800: 6970 2069 6e73 7461 6c6c 206c 617a 7974  ip install lazyt
+00007810: 7261 6e73 666f 726d 202d 2d69 676e 6f72  ransform --ignor
+00007820: 652d 696e 7374 616c 6c65 6420 2d2d 6e6f  e-installed --no
+00007830: 2d64 6570 730a 7069 7020 696e 7374 616c  -deps.pip instal
+00007840: 6c20 6361 7465 676f 7279 2d65 6e63 6f64  l category-encod
+00007850: 6572 7320 2d2d 6967 6e6f 7265 2d69 6e73  ers --ignore-ins
+00007860: 7461 6c6c 6564 202d 2d6e 6f2d 6465 7073  talled --no-deps
+00007870: 0a0a 6060 600a 0a54 6f20 696e 7374 616c  ..```..To instal
+00007880: 6c20 6672 6f6d 2073 6f75 7263 653a 0a0a  l from source:..
+00007890: 6060 600a 6364 203c 6c61 7a79 7472 616e  ```.cd <lazytran
+000078a0: 7366 6f72 6d5f 4465 7374 696e 6174 696f  sform_Destinatio
+000078b0: 6e3e 0a67 6974 2063 6c6f 6e65 2067 6974  n>.git clone git
+000078c0: 4067 6974 6875 622e 636f 6d3a 4175 746f  @github.com:Auto
+000078d0: 5669 4d4c 2f6c 617a 7974 7261 6e73 666f  ViML/lazytransfo
+000078e0: 726d 2e67 6974 0a60 6060 0a6f 7220 646f  rm.git.```.or do
+000078f0: 776e 6c6f 6164 2061 6e64 2075 6e7a 6970  wnload and unzip
+00007900: 2068 7474 7073 3a2f 2f67 6974 6875 622e   https://github.
+00007910: 636f 6d2f 4175 746f 5669 4d4c 2f6c 617a  com/AutoViML/laz
+00007920: 7974 7261 6e73 666f 726d 2f61 7263 6869  ytransform/archi
+00007930: 7665 2f6d 6173 7465 722e 7a69 700a 6060  ve/master.zip.``
+00007940: 600a 636f 6e64 6120 6372 6561 7465 202d  `.conda create -
+00007950: 6e20 3c79 6f75 725f 656e 765f 6e61 6d65  n <your_env_name
+00007960: 3e20 7079 7468 6f6e 3d33 2e37 2061 6e61  > python=3.7 ana
+00007970: 636f 6e64 610a 636f 6e64 6120 6163 7469  conda.conda acti
+00007980: 7661 7465 203c 796f 7572 5f65 6e76 5f6e  vate <your_env_n
+00007990: 616d 653e 2023 204f 4e20 5749 4e44 4f57  ame> # ON WINDOW
+000079a0: 533a 2060 736f 7572 6365 2061 6374 6976  S: `source activ
+000079b0: 6174 6520 3c79 6f75 725f 656e 765f 6e61  ate <your_env_na
+000079c0: 6d65 3e60 0a63 6420 6c61 7a79 7472 616e  me>`.cd lazytran
+000079d0: 7366 6f72 6d0a 7069 7020 696e 7374 616c  sform.pip instal
+000079e0: 6c20 2d72 2072 6571 7569 7265 6d65 6e74  l -r requirement
+000079f0: 732e 7478 740a 6060 600a 0a23 2320 5573  s.txt.```..## Us
+00007a00: 6167 650a 3c70 3e0a 596f 7520 6361 6e20  age.<p>.You can 
+00007a10: 696e 766f 6b65 2060 6c61 7a79 7472 616e  invoke `lazytran
+00007a20: 7366 6f72 6d60 2061 7320 6120 7363 696b  sform` as a scik
+00007a30: 6974 2d6c 6561 726e 2063 6f6d 7061 7469  it-learn compati
+00007a40: 626c 6520 6669 7420 616e 6420 7472 616e  ble fit and tran
+00007a50: 7366 6f72 6d20 6f72 2061 2066 6974 2061  sform or a fit a
+00007a60: 6e64 2070 7265 6469 6374 2070 6970 656c  nd predict pipel
+00007a70: 696e 652e 2053 6565 2073 796e 7461 7820  ine. See syntax 
+00007a80: 6265 6c6f 772e 3c70 3e0a 0a60 6060 0a66  below.<p>..```.f
+00007a90: 726f 6d20 6c61 7a79 7472 616e 7366 6f72  rom lazytransfor
+00007aa0: 6d20 696d 706f 7274 204c 617a 7954 7261  m import LazyTra
+00007ab0: 6e73 666f 726d 6572 0a6c 617a 7920 3d20  nsformer.lazy = 
+00007ac0: 4c61 7a79 5472 616e 7366 6f72 6d65 7228  LazyTransformer(
+00007ad0: 6d6f 6465 6c3d 4e6f 6e65 2c20 656e 636f  model=None, enco
+00007ae0: 6465 7273 3d27 6175 746f 272c 2073 6361  ders='auto', sca
+00007af0: 6c65 7273 3d4e 6f6e 652c 200a 2020 2020  lers=None, .    
+00007b00: 2020 2020 6461 7465 5f74 6f5f 7374 7269      date_to_stri
+00007b10: 6e67 3d46 616c 7365 2c20 7472 616e 7366  ng=False, transf
+00007b20: 6f72 6d5f 7461 7267 6574 3d46 616c 7365  orm_target=False
+00007b30: 2c20 696d 6261 6c61 6e63 6564 3d46 616c  , imbalanced=Fal
+00007b40: 7365 2c0a 2020 2020 2020 2020 636f 6d62  se,.        comb
+00007b50: 696e 655f 7261 7265 3d46 616c 7365 2c20  ine_rare=False, 
+00007b60: 7665 7262 6f73 653d 3029 0a60 6060 0a0a  verbose=0).```..
+00007b70: 2323 2320 6966 2079 6f75 2061 7265 206e  ### if you are n
+00007b80: 6f74 2075 7369 6e67 2061 206d 6f64 656c  ot using a model
+00007b90: 2069 6e20 7069 7065 6c69 6e65 2c20 796f   in pipeline, yo
+00007ba0: 7520 6d75 7374 2075 7365 2066 6974 2061  u must use fit a
+00007bb0: 6e64 2074 7261 6e73 666f 726d 0a60 6060  nd transform.```
+00007bc0: 0a58 5f74 7261 696e 6d2c 2079 5f74 7261  .X_trainm, y_tra
+00007bd0: 696e 6d20 3d20 6c61 7a79 2e66 6974 5f74  inm = lazy.fit_t
+00007be0: 7261 6e73 666f 726d 2858 5f74 7261 696e  ransform(X_train
+00007bf0: 2c20 795f 7472 6169 6e29 0a58 5f74 6573  , y_train).X_tes
+00007c00: 746d 203d 206c 617a 792e 7472 616e 7366  tm = lazy.transf
+00007c10: 6f72 6d28 585f 7465 7374 290a 6060 600a  orm(X_test).```.
+00007c20: 2323 2320 4966 2079 6f75 2061 7265 2075  ### If you are u
+00007c30: 7369 6e67 2061 206d 6f64 656c 2069 6e20  sing a model in 
+00007c40: 7069 7065 6c69 6e65 2c20 7573 6520 6d75  pipeline, use mu
+00007c50: 7374 2075 7365 2066 6974 2061 6e64 2070  st use fit and p
+00007c60: 7265 6469 6374 206f 6e6c 790a 6060 600a  redict only.```.
+00007c70: 6c61 7a79 203d 204c 617a 7954 7261 6e73  lazy = LazyTrans
+00007c80: 666f 726d 6572 286d 6f64 656c 3d52 616e  former(model=Ran
+00007c90: 646f 6d46 6f72 6573 7443 6c61 7373 6966  domForestClassif
+00007ca0: 6965 7228 292c 2065 6e63 6f64 6572 733d  ier(), encoders=
+00007cb0: 2761 7574 6f27 2c20 7363 616c 6572 733d  'auto', scalers=
+00007cc0: 4e6f 6e65 2c20 0a20 2020 2020 2020 2064  None, .        d
+00007cd0: 6174 655f 746f 5f73 7472 696e 673d 4661  ate_to_string=Fa
+00007ce0: 6c73 652c 2074 7261 6e73 666f 726d 5f74  lse, transform_t
+00007cf0: 6172 6765 743d 4661 6c73 652c 2069 6d62  arget=False, imb
+00007d00: 616c 616e 6365 643d 4661 6c73 652c 0a20  alanced=False,. 
+00007d10: 2020 2020 2020 2063 6f6d 6269 6e65 5f72         combine_r
+00007d20: 6172 653d 4661 6c73 652c 2076 6572 626f  are=False, verbo
+00007d30: 7365 3d30 290a 6060 600a 0a60 6060 0a6c  se=0).```..```.l
+00007d40: 617a 792e 6669 7428 585f 7472 6169 6e2c  azy.fit(X_train,
+00007d50: 2079 5f74 7261 696e 290a 6c61 7a79 2e70   y_train).lazy.p
+00007d60: 7265 6469 6374 2858 5f74 6573 7429 0a60  redict(X_test).`
+00007d70: 6060 0a0a 2323 2041 5049 0a0a 3c70 3e0a  ``..## API..<p>.
+00007d80: 6c61 7a79 7472 616e 7366 6f72 6d20 6861  lazytransform ha
+00007d90: 7320 6120 7665 7279 2073 696d 706c 6520  s a very simple 
+00007da0: 4150 4920 7769 7468 2074 6865 2066 6f6c  API with the fol
+00007db0: 6c6f 7769 6e67 2069 6e70 7574 732e 2059  lowing inputs. Y
+00007dc0: 6f75 206e 6565 6420 746f 2063 7265 6174  ou need to creat
+00007dd0: 6520 6120 736b 6c65 6172 6e2d 636f 6d70  e a sklearn-comp
+00007de0: 6174 6962 6c65 2074 7261 6e73 666f 726d  atible transform
+00007df0: 6572 2070 6970 656c 696e 6520 6f62 6a65  er pipeline obje
+00007e00: 6374 2062 7920 696d 706f 7274 696e 6720  ct by importing 
+00007e10: 4c61 7a79 5472 616e 7366 6f72 6d65 7220  LazyTransformer 
+00007e20: 6672 6f6d 206c 617a 7974 7261 6e73 666f  from lazytransfo
+00007e30: 726d 206c 6962 7261 7279 2e20 3c70 3e0a  rm library. <p>.
+00007e40: 4f6e 6365 2079 6f75 2069 6d70 6f72 7420  Once you import 
+00007e50: 6974 2c20 796f 7520 6361 6e20 6465 6669  it, you can defi
+00007e60: 6e65 2074 6865 206f 626a 6563 7420 6279  ne the object by
+00007e70: 2067 6976 696e 6720 7365 7665 7261 6c20   giving several 
+00007e80: 6f70 7469 6f6e 7320 7375 6368 2061 733a  options such as:
+00007e90: 0a0a 2a2a 4172 6775 6d65 6e74 732a 2a0a  ..**Arguments**.
+00007ea0: 0a3c 623e 4361 7574 696f 6e3a 3c2f 623e  .<b>Caution:</b>
+00007eb0: 2058 5f74 7261 696e 2061 6e64 2079 5f74   X_train and y_t
+00007ec0: 7261 696e 206d 7573 7420 6265 2070 616e  rain must be pan
+00007ed0: 6461 7320 4461 7461 6672 616d 6573 206f  das Dataframes o
+00007ee0: 7220 7061 6e64 6173 2053 6572 6965 732e  r pandas Series.
+00007ef0: 2044 4f20 4e4f 5420 7365 6e64 2069 6e20   DO NOT send in 
+00007f00: 6e75 6d70 7920 6172 7261 7973 2e20 5468  numpy arrays. Th
+00007f10: 6579 2077 6f6e 2774 2077 6f72 6b2e 0a0a  ey won't work...
+00007f20: 2d20 606d 6f64 656c 603a 2064 6566 6175  - `model`: defau
+00007f30: 6c74 2069 7320 4e6f 6e65 2e20 4f72 2069  lt is None. Or i
+00007f40: 7420 636f 756c 6420 6265 2061 6e79 2073  t could be any s
+00007f50: 6369 6b69 742d 6c65 6172 6e20 6d6f 6465  cikit-learn mode
+00007f60: 6c20 2869 6e63 6c75 6469 6e67 206d 756c  l (including mul
+00007f70: 7469 6f75 7470 7574 206d 6f64 656c 7329  tioutput models)
+00007f80: 2061 7320 7765 6c6c 2061 7320 7468 6520   as well as the 
+00007f90: 706f 7075 6c61 7220 5847 426f 6f73 7420  popular XGBoost 
+00007fa0: 616e 6420 4c69 6768 7447 424d 206c 6962  and LightGBM lib
+00007fb0: 7261 7269 6573 2e20 596f 7520 6e65 6564  raries. You need
+00007fc0: 2074 6f20 696e 7374 616c 6c20 7468 6f73   to install thos
+00007fd0: 6520 6c69 6272 6172 6965 7320 6966 2079  e libraries if y
+00007fe0: 6f75 2077 616e 7420 746f 2075 7365 2074  ou want to use t
+00007ff0: 6865 6d2e 0a2d 2060 656e 636f 6465 7273  hem..- `encoders
+00008000: 603a 2063 6f75 6c64 2062 6520 6f6e 6520  `: could be one 
+00008010: 6d6f 7265 2065 6e63 6f64 6572 7320 696e  more encoders in
+00008020: 2061 2073 7472 696e 6720 6f72 2061 206c   a string or a l
+00008030: 6973 742e 2045 6163 6820 656e 636f 6465  ist. Each encode
+00008040: 7220 7374 7269 6e67 2063 616e 2062 6520  r string can be 
+00008050: 616e 7920 6f6e 6520 6f66 2074 6865 2031  any one of the 1
+00008060: 302b 2065 6e63 6f64 6572 7320 6672 6f6d  0+ encoders from
+00008070: 2060 6361 7465 676f 7279 5f65 6e63 6f64   `category_encod
+00008080: 6572 7360 206c 6962 7261 7279 2062 656c  ers` library bel
+00008090: 6f77 2e20 2041 7661 696c 6162 6c65 2065  ow.  Available e
+000080a0: 6e63 6f64 6572 7320 6172 6520 6c69 7374  ncoders are list
+000080b0: 6564 2068 6572 6520 6173 2073 7472 696e  ed here as strin
+000080c0: 6773 2073 6f20 7468 6174 2079 6f75 2063  gs so that you c
+000080d0: 616e 2069 6e70 7574 2074 6865 6d20 696e  an input them in
+000080e0: 206c 617a 7974 7261 6e73 666f 726d 3a0a   lazytransform:.
+000080f0: 2020 2d20 6061 7574 6f60 202d 2049 7420    - `auto` - It 
+00008100: 7573 6573 2060 6f6e 6568 6f74 6020 656e  uses `onehot` en
+00008110: 636f 6469 6e67 2066 6f72 206c 6f77 2d63  coding for low-c
+00008120: 6172 6469 6e61 6c69 7479 2076 6172 6961  ardinality varia
+00008130: 626c 6573 2061 6e64 2060 6c61 6265 6c60  bles and `label`
+00008140: 2065 6e63 6f64 696e 6720 666f 7220 6869   encoding for hi
+00008150: 6768 2063 6172 6469 6e61 6c69 7479 2076  gh cardinality v
+00008160: 6172 6961 626c 6573 2e0a 2020 2d20 606f  ariables..  - `o
+00008170: 6e65 686f 7460 202d 204f 6e65 2048 6f74  nehot` - One Hot
+00008180: 2065 6e63 6f64 696e 6720 2d20 6974 2077   encoding - it w
+00008190: 696c 6c20 6265 2075 7365 6420 666f 7220  ill be used for 
+000081a0: 616c 6c20 6361 7465 676f 7269 6361 6c20  all categorical 
+000081b0: 6665 6174 7572 6573 2069 7272 6573 7065  features irrespe
+000081c0: 6374 6976 6520 6f66 2063 6172 6469 6e61  ctive of cardina
+000081d0: 6c69 7479 0a20 202d 2060 6c61 6265 6c60  lity.  - `label`
+000081e0: 202d 204c 6162 656c 2045 6e63 6f64 696e   - Label Encodin
+000081f0: 6720 2d20 6974 2077 696c 6c20 6265 2075  g - it will be u
+00008200: 7365 6420 666f 7220 616c 6c20 6361 7465  sed for all cate
+00008210: 676f 7269 6361 6c20 6665 6174 7572 6573  gorical features
+00008220: 2069 7272 6573 7065 6374 6976 6520 6f66   irrespective of
+00008230: 2063 6172 6469 6e61 6c69 7479 0a20 202d   cardinality.  -
+00008240: 2060 6861 7368 696e 6760 206f 7220 6068   `hashing` or `h
+00008250: 6173 6860 202d 2048 6173 6869 6e67 2028  ash` - Hashing (
+00008260: 6f72 2048 6173 6829 2045 6e63 6f64 696e  or Hash) Encodin
+00008270: 6720 2d20 7769 6c6c 2062 6520 7573 6564  g - will be used
+00008280: 2066 6f72 2061 6c6c 2063 6174 6567 6f72   for all categor
+00008290: 6963 616c 2076 6172 6961 626c 6573 0a20  ical variables. 
+000082a0: 202d 2060 6865 6c6d 6572 7460 202d 2048   - `helmert` - H
+000082b0: 656c 6d65 7274 2045 6e63 6f64 696e 6720  elmert Encoding 
+000082c0: 2d20 7769 6c6c 2062 6520 7573 6564 2066  - will be used f
+000082d0: 6f72 2061 6c6c 2063 6174 6567 6f72 6963  or all categoric
+000082e0: 616c 2076 6172 6961 626c 6573 0a20 202d  al variables.  -
+000082f0: 2060 6264 6360 202d 2042 4443 2045 6e63   `bdc` - BDC Enc
+00008300: 6f64 696e 6720 2d20 7769 6c6c 2062 6520  oding - will be 
+00008310: 7573 6564 2066 6f72 2061 6c6c 2063 6174  used for all cat
+00008320: 6567 6f72 6963 616c 2076 6172 6961 626c  egorical variabl
+00008330: 6573 0a20 202d 2060 7375 6d60 202d 2053  es.  - `sum` - S
+00008340: 756d 2045 6e63 6f64 696e 6720 2d20 7769  um Encoding - wi
+00008350: 6c6c 2062 6520 7573 6564 2066 6f72 2061  ll be used for a
+00008360: 6c6c 2063 6174 6567 6f72 6963 616c 2076  ll categorical v
+00008370: 6172 6961 626c 6573 0a20 202d 2060 6c6f  ariables.  - `lo
+00008380: 6f60 202d 204c 6561 7665 206f 6e65 206f  o` - Leave one o
+00008390: 7574 2045 6e63 6f64 696e 6720 2d20 7769  ut Encoding - wi
+000083a0: 6c6c 2062 6520 7573 6564 2066 6f72 2061  ll be used for a
+000083b0: 6c6c 2063 6174 6567 6f72 6963 616c 2076  ll categorical v
+000083c0: 6172 6961 626c 6573 0a20 202d 2060 6261  ariables.  - `ba
+000083d0: 7365 6020 2d20 4261 7365 2065 6e63 6f64  se` - Base encod
+000083e0: 696e 6720 2d20 7769 6c6c 2062 6520 7573  ing - will be us
+000083f0: 6564 2066 6f72 2061 6c6c 2063 6174 6567  ed for all categ
+00008400: 6f72 6963 616c 2076 6172 6961 626c 6573  orical variables
+00008410: 0a20 202d 2060 776f 6560 202d 2057 6569  .  - `woe` - Wei
+00008420: 6768 7420 6f66 2045 7669 6465 6e63 6520  ght of Evidence 
+00008430: 456e 636f 6469 6e67 202d 2077 696c 6c20  Encoding - will 
+00008440: 6265 2075 7365 6420 666f 7220 616c 6c20  be used for all 
+00008450: 6361 7465 676f 7269 6361 6c20 7661 7269  categorical vari
+00008460: 6162 6c65 730a 2020 2d20 606a 616d 6573  ables.  - `james
+00008470: 6020 2d20 4a61 6d65 7320 456e 636f 6469  ` - James Encodi
+00008480: 6e67 202d 2077 696c 6c20 6265 2075 7365  ng - will be use
+00008490: 6420 666f 7220 616c 6c20 6361 7465 676f  d for all catego
+000084a0: 7269 6361 6c20 7661 7269 6162 6c65 730a  rical variables.
+000084b0: 2020 2d20 6074 6172 6765 7460 202d 2054    - `target` - T
+000084c0: 6172 6765 7420 456e 636f 6469 6e67 202d  arget Encoding -
+000084d0: 2077 696c 6c20 6265 2075 7365 6420 666f   will be used fo
+000084e0: 7220 616c 6c20 6361 7465 676f 7269 6361  r all categorica
+000084f0: 6c20 7661 7269 6162 6c65 730a 2020 2d20  l variables.  - 
+00008500: 6063 6f75 6e74 6020 2d20 436f 756e 7420  `count` - Count 
+00008510: 456e 636f 6469 6e67 202d 2077 696c 6c20  Encoding - will 
+00008520: 6265 2075 7365 6420 666f 7220 616c 6c20  be used for all 
+00008530: 6361 7465 676f 7269 6361 6c20 7661 7269  categorical vari
+00008540: 6162 6c65 730a 2020 2d20 6067 6c6d 602c  ables.  - `glm`,
+00008550: 6067 6c6d 6d60 202d 2047 656e 6572 616c  `glmm` - General
+00008560: 697a 6564 204c 696e 6561 7220 4d6f 6465  ized Linear Mode
+00008570: 6c20 456e 636f 6469 6e67 0a2d 2048 6572  l Encoding.- Her
+00008580: 6520 6973 2061 2064 6573 6372 6970 7469  e is a descripti
+00008590: 6f6e 206f 6620 7661 7269 6f75 7320 656e  on of various en
+000085a0: 636f 6465 7273 2061 6e64 2074 6865 6972  coders and their
+000085b0: 2075 7365 7320 6672 6f6d 2074 6865 2065   uses from the e
+000085c0: 7863 656c 6c65 6e74 203c 6120 6872 6566  xcellent <a href
+000085d0: 3d22 6874 7470 733a 2f2f 636f 6e74 7269  ="https://contri
+000085e0: 622e 7363 696b 6974 2d6c 6561 726e 2e6f  b.scikit-learn.o
+000085f0: 7267 2f63 6174 6567 6f72 795f 656e 636f  rg/category_enco
+00008600: 6465 7273 2f22 3e20 6361 7465 676f 7279  ders/"> category
+00008610: 5f65 6e63 6f64 6572 733c 2f61 3e20 7079  _encoders</a> py
+00008620: 7468 6f6e 206c 6962 7261 7279 3a3c 6272  thon library:<br
+00008630: 3e0a 2020 2020 2d20 6048 6173 6869 6e67  >.    - `Hashing
+00008640: 456e 636f 6465 7260 3a20 4861 7368 696e  Encoder`: Hashin
+00008650: 6745 6e63 6f64 6572 2069 7320 6120 6d75  gEncoder is a mu
+00008660: 6c74 6976 6172 6961 7465 2068 6173 6869  ltivariate hashi
+00008670: 6e67 2069 6d70 6c65 6d65 6e74 6174 696f  ng implementatio
+00008680: 6e20 7769 7468 2063 6f6e 6669 6775 7261  n with configura
+00008690: 626c 6520 6469 6d65 6e73 696f 6e61 6c69  ble dimensionali
+000086a0: 7479 2f70 7265 6369 7369 6f6e 2e20 5468  ty/precision. Th
+000086b0: 6520 6164 7661 6e74 6167 6520 6f66 2074  e advantage of t
+000086c0: 6869 7320 656e 636f 6465 7220 6973 2074  his encoder is t
+000086d0: 6861 7420 6974 2064 6f65 7320 6e6f 7420  hat it does not 
+000086e0: 6d61 696e 7461 696e 2061 2064 6963 7469  maintain a dicti
+000086f0: 6f6e 6172 7920 6f66 206f 6273 6572 7665  onary of observe
+00008700: 6420 6361 7465 676f 7269 6573 2e20 436f  d categories. Co
+00008710: 6e73 6571 7565 6e74 6c79 2c20 7468 6520  nsequently, the 
+00008720: 656e 636f 6465 7220 646f 6573 206e 6f74  encoder does not
+00008730: 2067 726f 7720 696e 2073 697a 6520 616e   grow in size an
+00008740: 6420 6163 6365 7074 7320 6e65 7720 7661  d accepts new va
+00008750: 6c75 6573 2064 7572 696e 6720 6461 7461  lues during data
+00008760: 2073 636f 7269 6e67 2062 7920 6465 7369   scoring by desi
+00008770: 676e 2e0a 2020 2020 2d20 6053 756d 456e  gn..    - `SumEn
+00008780: 636f 6465 7260 3a20 5375 6d45 6e63 6f64  coder`: SumEncod
+00008790: 6572 2069 7320 6120 5375 6d20 636f 6e74  er is a Sum cont
+000087a0: 7261 7374 2063 6f64 696e 6720 666f 7220  rast coding for 
+000087b0: 7468 6520 656e 636f 6469 6e67 206f 6620  the encoding of 
+000087c0: 6361 7465 676f 7269 6361 6c20 6665 6174  categorical feat
+000087d0: 7572 6573 2e0a 2020 2020 2d20 6050 6f6c  ures..    - `Pol
+000087e0: 796e 6f6d 6961 6c45 6e63 6f64 6572 603a  ynomialEncoder`:
+000087f0: 2050 6f6c 796e 6f6d 6961 6c45 6e63 6f64   PolynomialEncod
+00008800: 6572 2069 7320 6120 506f 6c79 6e6f 6d69  er is a Polynomi
+00008810: 616c 2063 6f6e 7472 6173 7420 636f 6469  al contrast codi
+00008820: 6e67 2066 6f72 2074 6865 2065 6e63 6f64  ng for the encod
+00008830: 696e 6720 6f66 2063 6174 6567 6f72 6963  ing of categoric
+00008840: 616c 2066 6561 7475 7265 732e 0a20 2020  al features..   
+00008850: 202d 2060 4261 636b 7761 7264 4469 6666   - `BackwardDiff
+00008860: 6572 656e 6365 456e 636f 6465 7260 3a20  erenceEncoder`: 
+00008870: 4261 636b 7761 7264 4469 6666 6572 656e  BackwardDifferen
+00008880: 6365 456e 636f 6465 7220 6973 2061 2042  ceEncoder is a B
+00008890: 6163 6b77 6172 6420 6469 6666 6572 656e  ackward differen
+000088a0: 6365 2063 6f6e 7472 6173 7420 636f 6469  ce contrast codi
+000088b0: 6e67 2066 6f72 2065 6e63 6f64 696e 6720  ng for encoding 
+000088c0: 6361 7465 676f 7269 6361 6c20 7661 7269  categorical vari
+000088d0: 6162 6c65 732e 0a20 2020 202d 2060 4f6e  ables..    - `On
+000088e0: 6548 6f74 456e 636f 6465 7260 3a20 4f6e  eHotEncoder`: On
+000088f0: 6548 6f74 456e 636f 6465 7220 6973 2074  eHotEncoder is t
+00008900: 6865 2074 7261 6469 7469 6f6e 616c 204f  he traditional O
+00008910: 6e65 686f 7420 286f 7220 6475 6d6d 7929  nehot (or dummy)
+00008920: 2063 6f64 696e 6720 666f 7220 6361 7465   coding for cate
+00008930: 676f 7269 6361 6c20 6665 6174 7572 6573  gorical features
+00008940: 2e20 4974 2070 726f 6475 6365 7320 6f6e  . It produces on
+00008950: 6520 6665 6174 7572 6520 7065 7220 6361  e feature per ca
+00008960: 7465 676f 7279 2c20 6561 6368 2062 6569  tegory, each bei
+00008970: 6e67 2061 2062 696e 6172 792e 0a20 2020  ng a binary..   
+00008980: 202d 2060 4865 6c6d 6572 7445 6e63 6f64   - `HelmertEncod
+00008990: 6572 603a 2048 656c 6d65 7274 456e 636f  er`: HelmertEnco
+000089a0: 6465 7220 7573 6573 2074 6865 2048 656c  der uses the Hel
+000089b0: 6d65 7274 2063 6f6e 7472 6173 7420 636f  mert contrast co
+000089c0: 6469 6e67 2066 6f72 2065 6e63 6f64 696e  ding for encodin
+000089d0: 6720 6361 7465 676f 7269 6361 6c20 6665  g categorical fe
+000089e0: 6174 7572 6573 2e0a 2020 2020 2d20 604f  atures..    - `O
+000089f0: 7264 696e 616c 456e 636f 6465 7260 3a20  rdinalEncoder`: 
+00008a00: 4f72 6469 6e61 6c45 6e63 6f64 6572 2075  OrdinalEncoder u
+00008a10: 7365 7320 4f72 6469 6e61 6c20 656e 636f  ses Ordinal enco
+00008a20: 6469 6e67 2074 6f20 6465 7369 676e 6174  ding to designat
+00008a30: 6520 6120 7369 6e67 6c65 2063 6f6c 756d  e a single colum
+00008a40: 6e20 6f66 2069 6e74 6567 6572 7320 746f  n of integers to
+00008a50: 2072 6570 7265 7365 6e74 2074 6865 2063   represent the c
+00008a60: 6174 6567 6f72 6965 7320 696e 2079 6f75  ategories in you
+00008a70: 7220 6461 7461 2e20 496e 7465 6765 7273  r data. Integers
+00008a80: 2068 6f77 6576 6572 2073 7461 7274 2069   however start i
+00008a90: 6e20 7468 6520 7361 6d65 206f 7264 6572  n the same order
+00008aa0: 2069 6e20 7768 6963 6820 7468 6520 6361   in which the ca
+00008ab0: 7465 676f 7269 6573 2061 7265 2066 6f75  tegories are fou
+00008ac0: 6e64 2069 6e20 796f 7572 2064 6174 6173  nd in your datas
+00008ad0: 6574 2e20 4966 2079 6f75 2077 616e 7420  et. If you want 
+00008ae0: 746f 2063 6861 6e67 6520 7468 6520 6f72  to change the or
+00008af0: 6465 722c 206a 7573 7420 736f 7274 2074  der, just sort t
+00008b00: 6865 2063 6f6c 756d 6e20 616e 6420 7365  he column and se
+00008b10: 6e64 2069 7420 696e 2066 6f72 2065 6e63  nd it in for enc
+00008b20: 6f64 696e 672e 0a20 2020 202d 2060 4672  oding..    - `Fr
+00008b30: 6571 7565 6e63 7945 6e63 6f64 6572 603a  equencyEncoder`:
+00008b40: 2046 7265 7175 656e 6379 456e 636f 6465   FrequencyEncode
+00008b50: 7220 6973 2061 2063 6f75 6e74 2065 6e63  r is a count enc
+00008b60: 6f64 696e 6720 7465 6368 6e69 7175 6520  oding technique 
+00008b70: 666f 7220 6361 7465 676f 7269 6361 6c20  for categorical 
+00008b80: 6665 6174 7572 6573 2e20 466f 7220 6120  features. For a 
+00008b90: 6769 7665 6e20 6361 7465 676f 7269 6361  given categorica
+00008ba0: 6c20 6665 6174 7572 652c 2069 7420 7265  l feature, it re
+00008bb0: 706c 6163 6573 2074 6865 206e 616d 6573  places the names
+00008bc0: 206f 6620 7468 6520 6361 7465 676f 7269   of the categori
+00008bd0: 6573 2077 6974 6820 7468 6520 6772 6f75  es with the grou
+00008be0: 7020 636f 756e 7473 206f 6620 6561 6368  p counts of each
+00008bf0: 2063 6174 6567 6f72 792e 0a20 2020 202d   category..    -
+00008c00: 2060 4261 7365 4e45 6e63 6f64 6572 603a   `BaseNEncoder`:
+00008c10: 2042 6173 654e 456e 636f 6465 7220 656e   BaseNEncoder en
+00008c20: 636f 6465 7320 7468 6520 6361 7465 676f  codes the catego
+00008c30: 7269 6573 2069 6e74 6f20 6172 7261 7973  ries into arrays
+00008c40: 206f 6620 7468 6569 7220 6261 7365 2d4e   of their base-N
+00008c50: 2072 6570 7265 7365 6e74 6174 696f 6e2e   representation.
+00008c60: 2041 2062 6173 6520 6f66 2031 2069 7320   A base of 1 is 
+00008c70: 6571 7569 7661 6c65 6e74 2074 6f20 6f6e  equivalent to on
+00008c80: 652d 686f 7420 656e 636f 6469 6e67 2028  e-hot encoding (
+00008c90: 6e6f 7420 7265 616c 6c79 2062 6173 652d  not really base-
+00008ca0: 312c 2062 7574 2075 7365 6675 6c29 2c20  1, but useful), 
+00008cb0: 6120 6261 7365 206f 6620 3220 6973 2065  a base of 2 is e
+00008cc0: 7175 6976 616c 656e 7420 746f 2062 696e  quivalent to bin
+00008cd0: 6172 7920 656e 636f 6469 6e67 2e20 4e3d  ary encoding. N=
+00008ce0: 6e75 6d62 6572 206f 6620 6163 7475 616c  number of actual
+00008cf0: 2063 6174 6567 6f72 6965 7320 6973 2065   categories is e
+00008d00: 7175 6976 616c 656e 7420 746f 2076 616e  quivalent to van
+00008d10: 696c 6c61 206f 7264 696e 616c 2065 6e63  illa ordinal enc
+00008d20: 6f64 696e 672e 0a20 2020 202d 2060 5461  oding..    - `Ta
+00008d30: 7267 6574 456e 636f 6465 7260 3a20 5461  rgetEncoder`: Ta
+00008d40: 7267 6574 456e 636f 6465 7220 7065 7266  rgetEncoder perf
+00008d50: 6f72 6d73 2054 6172 6765 7420 656e 636f  orms Target enco
+00008d60: 6469 6e67 2066 6f72 2063 6174 6567 6f72  ding for categor
+00008d70: 6963 616c 2066 6561 7475 7265 732e 2049  ical features. I
+00008d80: 7420 7375 7070 6f72 7473 2066 6f6c 6c6f  t supports follo
+00008d90: 7769 6e67 206b 696e 6473 206f 6620 7461  wing kinds of ta
+00008da0: 7267 6574 733a 2062 696e 6172 7920 616e  rgets: binary an
+00008db0: 6420 636f 6e74 696e 756f 7573 2e20 466f  d continuous. Fo
+00008dc0: 7220 6d75 6c74 692d 636c 6173 7320 7461  r multi-class ta
+00008dd0: 7267 6574 7320 6974 2075 7365 7320 6120  rgets it uses a 
+00008de0: 506f 6c79 6e6f 6d69 616c 5772 6170 7065  PolynomialWrappe
+00008df0: 722e 0a20 2020 202d 2060 4361 7442 6f6f  r..    - `CatBoo
+00008e00: 7374 456e 636f 6465 7260 3a20 4361 7442  stEncoder`: CatB
+00008e10: 6f6f 7374 456e 636f 6465 7220 7065 7266  oostEncoder perf
+00008e20: 6f72 6d73 2043 6174 426f 6f73 7420 636f  orms CatBoost co
+00008e30: 6469 6e67 2066 6f72 2063 6174 6567 6f72  ding for categor
+00008e40: 6963 616c 2066 6561 7475 7265 732e 2049  ical features. I
+00008e50: 7420 7375 7070 6f72 7473 2074 6865 2066  t supports the f
+00008e60: 6f6c 6c6f 7769 6e67 206b 696e 6473 206f  ollowing kinds o
+00008e70: 6620 7461 7267 6574 733a 2062 696e 6172  f targets: binar
+00008e80: 7920 616e 6420 636f 6e74 696e 756f 7573  y and continuous
+00008e90: 2e20 466f 7220 706f 6c79 6e6f 6d69 616c  . For polynomial
+00008ea0: 2074 6172 6765 7420 7375 7070 6f72 742c   target support,
+00008eb0: 2069 7420 7573 6573 2061 2050 6f6c 796e   it uses a Polyn
+00008ec0: 6f6d 6961 6c57 7261 7070 6572 2e20 5468  omialWrapper. Th
+00008ed0: 6973 2069 7320 7665 7279 2073 696d 696c  is is very simil
+00008ee0: 6172 2074 6f20 6c65 6176 652d 6f6e 652d  ar to leave-one-
+00008ef0: 6f75 7420 656e 636f 6469 6e67 2c20 6275  out encoding, bu
+00008f00: 7420 6361 6c63 756c 6174 6573 2074 6865  t calculates the
+00008f10: 2076 616c 7565 7320 e280 9c6f 6e2d 7468   values ...on-th
+00008f20: 652d 666c 79e2 809d 2e20 436f 6e73 6571  e-fly.... Conseq
+00008f30: 7565 6e74 6c79 2c20 7468 6520 7661 6c75  uently, the valu
+00008f40: 6573 206e 6174 7572 616c 6c79 2076 6172  es naturally var
+00008f50: 7920 6475 7269 6e67 2074 6865 2074 7261  y during the tra
+00008f60: 696e 696e 6720 7068 6173 6520 616e 6420  ining phase and 
+00008f70: 6974 2069 7320 6e6f 7420 6e65 6365 7373  it is not necess
+00008f80: 6172 7920 746f 2061 6464 2072 616e 646f  ary to add rando
+00008f90: 6d20 6e6f 6973 652e 0a20 2020 202d 2060  m noise..    - `
+00008fa0: 574f 4545 6e63 6f64 6572 603a 2057 4f45  WOEEncoder`: WOE
+00008fb0: 456e 636f 6465 7220 7573 6573 2074 6865  Encoder uses the
+00008fc0: 2057 6569 6768 7420 6f66 2045 7669 6465   Weight of Evide
+00008fd0: 6e63 6520 7465 6368 6e69 7175 6520 666f  nce technique fo
+00008fe0: 7220 6361 7465 676f 7269 6361 6c20 6665  r categorical fe
+00008ff0: 6174 7572 6573 2e20 4974 2073 7570 706f  atures. It suppo
+00009000: 7274 7320 6f6e 6c79 206f 6e65 206b 696e  rts only one kin
+00009010: 6420 6f66 2074 6172 6765 743a 2062 696e  d of target: bin
+00009020: 6172 792e 2046 6f72 2070 6f6c 796e 6f6d  ary. For polynom
+00009030: 6961 6c20 7461 7267 6574 2073 7570 706f  ial target suppo
+00009040: 7274 2c20 6974 2075 7365 7320 6120 506f  rt, it uses a Po
+00009050: 6c79 6e6f 6d69 616c 5772 6170 7065 722e  lynomialWrapper.
+00009060: 2049 7420 6361 6e6e 6f74 2062 6520 7573   It cannot be us
+00009070: 6564 2066 6f72 2052 6567 7265 7373 696f  ed for Regressio
+00009080: 6e2e 0a20 2020 202d 2060 4a61 6d65 7353  n..    - `JamesS
+00009090: 7465 696e 456e 636f 6465 7260 3a20 4a61  teinEncoder`: Ja
+000090a0: 6d65 7353 7465 696e 456e 636f 6465 7220  mesSteinEncoder 
+000090b0: 7573 6573 2074 6865 204a 616d 6573 2d53  uses the James-S
+000090c0: 7465 696e 2065 7374 696d 6174 6f72 2e20  tein estimator. 
+000090d0: 4974 2073 7570 706f 7274 7320 3220 6b69  It supports 2 ki
+000090e0: 6e64 7320 6f66 2074 6172 6765 7473 3a20  nds of targets: 
+000090f0: 6269 6e61 7279 2061 6e64 2063 6f6e 7469  binary and conti
+00009100: 6e75 6f75 732e 2046 6f72 2070 6f6c 796e  nuous. For polyn
+00009110: 6f6d 6961 6c20 7461 7267 6574 2073 7570  omial target sup
+00009120: 706f 7274 2c20 6974 2075 7365 7320 506f  port, it uses Po
+00009130: 6c79 6e6f 6d69 616c 5772 6170 7065 722e  lynomialWrapper.
+00009140: 0a20 2020 2046 6f72 2066 6561 7475 7265  .    For feature
+00009150: 2076 616c 7565 2069 2c20 4a61 6d65 732d   value i, James-
+00009160: 5374 6569 6e20 6573 7469 6d61 746f 7220  Stein estimator 
+00009170: 7265 7475 726e 7320 6120 7765 6967 6874  returns a weight
+00009180: 6564 2061 7665 7261 6765 206f 663a 0a20  ed average of:. 
+00009190: 2020 2054 6865 206d 6561 6e20 7461 7267     The mean targ
+000091a0: 6574 2076 616c 7565 2066 6f72 2074 6865  et value for the
+000091b0: 206f 6273 6572 7665 6420 6665 6174 7572   observed featur
+000091c0: 6520 7661 6c75 6520 692e 0a20 2020 2054  e value i..    T
+000091d0: 6865 206d 6561 6e20 7461 7267 6574 2076  he mean target v
+000091e0: 616c 7565 2028 7265 6761 7264 6c65 7373  alue (regardless
+000091f0: 206f 6620 7468 6520 6665 6174 7572 6520   of the feature 
+00009200: 7661 6c75 6529 2e0a 2020 2020 2d20 6051  value)..    - `Q
+00009210: 7561 6e74 696c 6545 6e63 6f64 6572 603a  uantileEncoder`:
+00009220: 2054 6869 7320 6973 2061 2076 6572 7920   This is a very 
+00009230: 676f 6f64 2065 6e63 6f64 6572 2066 6f72  good encoder for
+00009240: 2052 6567 7265 7373 696f 6e20 7461 736b   Regression task
+00009250: 732e 2053 6565 2050 6170 6572 2061 6e64  s. See Paper and
+00009260: 2061 7274 6963 6c65 3a0a 2020 2020 6874   article:.    ht
+00009270: 7470 733a 2f2f 746f 7761 7264 7364 6174  tps://towardsdat
+00009280: 6173 6369 656e 6365 2e63 6f6d 2f71 7561  ascience.com/qua
+00009290: 6e74 696c 652d 656e 636f 6465 722d 6562  ntile-encoder-eb
+000092a0: 3333 6332 3732 3431 3164 0a0a 2d20 6073  33c272411d..- `s
+000092b0: 6361 6c65 7273 603a 2063 6f75 6c64 2062  calers`: could b
+000092c0: 6520 6f6e 6520 6f66 2074 6872 6565 206d  e one of three m
+000092d0: 6169 6e20 7363 616c 6572 7320 7573 6564  ain scalers used
+000092e0: 2069 6e20 7363 696b 6974 2d6c 6561 726e   in scikit-learn
+000092f0: 206d 6f64 656c 7320 746f 2074 7261 6e73   models to trans
+00009300: 666f 726d 206e 756d 6572 6963 2066 6561  form numeric fea
+00009310: 7475 7265 732e 2044 6566 6175 6c74 2069  tures. Default i
+00009320: 7320 4e6f 6e65 2e20 5363 616c 6572 7320  s None. Scalers 
+00009330: 6172 6520 7573 6564 2069 6e20 7468 6520  are used in the 
+00009340: 6c61 7374 2073 7465 7020 6f66 2074 6865  last step of the
+00009350: 2070 6970 656c 696e 6520 746f 2073 6361   pipeline to sca
+00009360: 6c65 2061 6c6c 2066 6561 7475 7265 7320  le all features 
+00009370: 7468 6174 2068 6176 6520 7472 616e 7366  that have transf
+00009380: 6f72 6d65 642e 2048 6f77 6576 6572 2c20  ormed. However, 
+00009390: 796f 7520 6d69 6768 7420 7761 6e74 2074  you might want t
+000093a0: 6f20 6176 6f69 6420 7363 616c 696e 6720  o avoid scaling 
+000093b0: 696e 204e 4c50 2064 6174 6173 6574 7320  in NLP datasets 
+000093c0: 7369 6e63 6520 6166 7465 7220 5446 6944  since after TFiD
+000093d0: 4620 7665 6374 6f72 697a 6174 696f 6e2c  F vectorization,
+000093e0: 2073 6361 6c69 6e67 2074 6865 6d20 6d61   scaling them ma
+000093f0: 7920 6e6f 7420 6d61 6b65 2073 656e 7365  y not make sense
+00009400: 2e20 4275 7420 6974 2069 7320 7570 2074  . But it is up t
+00009410: 6f20 796f 752e 2054 6865 2034 206f 7074  o you. The 4 opt
+00009420: 696f 6e73 2061 7265 3a0a 2020 2d20 604e  ions are:.  - `N
+00009430: 6f6e 6560 204e 6f20 7363 616c 6572 2e20  one` No scaler. 
+00009440: 4772 6561 7420 666f 7220 616c 6d6f 7374  Great for almost
+00009450: 2061 6c6c 2064 6174 6173 6574 732e 2054   all datasets. T
+00009460: 6573 7420 6974 2066 6972 7374 2061 6e64  est it first and
+00009470: 2074 6865 6e20 7472 7920 6f6e 6520 6f66   then try one of
+00009480: 2074 6865 2073 6361 6c65 7273 2062 656c   the scalers bel
+00009490: 6f77 2e0a 2020 2d20 6073 7464 6020 7374  ow..  - `std` st
+000094a0: 616e 6461 7264 2073 6361 6c65 722e 2047  andard scaler. G
+000094b0: 7265 6174 2066 6f72 2061 6c6d 6f73 7420  reat for almost 
+000094c0: 616c 6c20 6461 7461 7365 7473 2e0a 2020  all datasets..  
+000094d0: 2d20 606d 696e 6d61 7860 206d 696e 6d61  - `minmax` minma
+000094e0: 7820 7363 616c 6572 2e20 4772 6561 7420  x scaler. Great 
+000094f0: 666f 7220 6461 7461 7365 7473 2077 6865  for datasets whe
+00009500: 7265 2079 6f75 206e 6565 6420 746f 2073  re you need to s
+00009510: 6565 2074 6865 2064 6973 7472 6962 7574  ee the distribut
+00009520: 696f 6e20 6265 7477 6565 6e20 3020 616e  ion between 0 an
+00009530: 6420 312e 0a20 202d 2060 726f 6275 7374  d 1..  - `robust
+00009540: 6020 526f 6275 7374 2073 6361 6c65 722e  ` Robust scaler.
+00009550: 2047 7265 6174 2066 6f72 2064 6174 6173   Great for datas
+00009560: 6574 7320 7768 6572 6520 796f 7520 6861  ets where you ha
+00009570: 7665 206f 7574 6c69 6572 732e 0a20 202d  ve outliers..  -
+00009580: 2060 6d61 7861 6273 6020 6d61 7820 6162   `maxabs` max ab
+00009590: 736f 6c75 7465 2073 6361 6c65 722e 2047  solute scaler. G
+000095a0: 7265 6174 2066 6f72 2073 6361 6c69 6e67  reat for scaling
+000095b0: 2062 7574 206c 6561 7665 7320 7468 6520   but leaves the 
+000095c0: 6e65 6761 7469 7665 2076 616c 7565 7320  negative values 
+000095d0: 6173 2074 6865 7920 6172 6520 286e 6567  as they are (neg
+000095e0: 6174 6976 6529 2e20 0a2d 2060 6461 7465  ative). .- `date
+000095f0: 5f74 6f5f 7374 7269 6e67 603a 2064 6566  _to_string`: def
+00009600: 6175 6c74 2069 7320 4661 6c73 652e 2049  ault is False. I
+00009610: 6620 796f 7520 7761 6e74 2074 6f20 7573  f you want to us
+00009620: 6520 6461 7465 2076 6172 6961 626c 6573  e date variables
+00009630: 2061 7320 7374 7269 6e67 7320 2863 6174   as strings (cat
+00009640: 6567 6f72 6963 616c 292c 2074 6865 6e20  egorical), then 
+00009650: 7365 7420 6974 2061 7320 5472 7565 2e59  set it as True.Y
+00009660: 6f75 2063 616e 2075 7365 2074 6869 7320  ou can use this 
+00009670: 6f70 7469 6f6e 2077 6865 6e20 7468 6572  option when ther
+00009680: 6520 6172 6520 7665 7279 2066 6577 2064  e are very few d
+00009690: 6174 6573 2069 6e20 796f 7572 2064 6174  ates in your dat
+000096a0: 6173 6574 2e20 4966 2079 6f75 2073 6574  aset. If you set
+000096b0: 2069 7420 6173 2046 616c 7365 2c20 6974   it as False, it
+000096c0: 2077 696c 6c20 636f 6e76 6572 7420 6974   will convert it
+000096d0: 2069 6e74 6f20 6461 7465 2074 696d 6520   into date time 
+000096e0: 666f 726d 6174 2061 6e64 2065 7874 7261  format and extra
+000096f0: 6374 2075 7020 746f 2032 3020 6665 6174  ct up to 20 feat
+00009700: 7572 6573 2066 726f 6d20 796f 7572 2064  ures from your d
+00009710: 6174 6520 7469 6d65 2063 6f6c 756d 6e2e  ate time column.
+00009720: 2054 6869 7320 6973 2074 6865 2064 6566   This is the def
+00009730: 6175 6c74 206f 7074 696f 6e20 616e 6420  ault option and 
+00009740: 6265 7374 206f 7074 696f 6e2e 0a2d 2060  best option..- `
+00009750: 7472 616e 7366 6f72 6d5f 7461 7267 6574  transform_target
+00009760: 603a 2064 6566 6175 6c74 2069 7320 4661  `: default is Fa
+00009770: 6c73 652e 2049 6620 796f 7520 7761 6e74  lse. If you want
+00009780: 2074 6f20 7472 616e 7366 6f72 6d20 796f   to transform yo
+00009790: 7572 2074 6172 6765 7420 7661 7269 6162  ur target variab
+000097a0: 6c65 2873 292c 2074 6865 6e20 7365 7420  le(s), then set 
+000097b0: 6974 2061 7320 5472 7565 2061 6e64 2077  it as True and w
+000097c0: 6520 7769 6c6c 2074 7261 6e73 666f 726d  e will transform
+000097d0: 2079 6f75 7220 7461 7267 6574 2873 2920   your target(s) 
+000097e0: 6173 206e 756d 6572 6963 2075 7369 6e67  as numeric using
+000097f0: 204c 6162 656c 2045 6e63 6f64 696e 6720   Label Encoding 
+00009800: 6173 2077 656c 6c20 6173 206d 756c 7469  as well as multi
+00009810: 2d6c 6162 656c 2042 696e 6172 7920 636c  -label Binary cl
+00009820: 6173 7365 732e 2054 6869 7320 6973 2061  asses. This is a
+00009830: 2067 7265 6174 206f 7074 696f 6e20 7768   great option wh
+00009840: 656e 2079 6f75 2068 6176 6520 6361 7465  en you have cate
+00009850: 676f 7269 6361 6c20 7461 7267 6574 2076  gorical target v
+00009860: 6172 6961 626c 6573 2e0a 2d20 6069 6d62  ariables..- `imb
+00009870: 616c 616e 6365 6460 3a20 6465 6661 756c  alanced`: defaul
+00009880: 7420 6973 2046 616c 7365 2e20 4966 2079  t is False. If y
+00009890: 6f75 2068 6176 6520 616e 2069 6d62 616c  ou have an imbal
+000098a0: 616e 6365 6420 6461 7461 7365 742c 2074  anced dataset, t
+000098b0: 6865 6e20 7365 7420 6974 2074 6f20 5472  hen set it to Tr
+000098c0: 7565 2061 6e64 2077 6520 7769 6c6c 2074  ue and we will t
+000098d0: 7261 6e73 666f 726d 2079 6f75 7220 7472  ransform your tr
+000098e0: 6169 6e20 6461 7461 2075 7369 6e67 2042  ain data using B
+000098f0: 6f72 6465 726c 696e 6553 4d4f 5445 206f  orderlineSMOTE o
+00009900: 7220 534d 4f54 454e 4320 7768 6963 6820  r SMOTENC which 
+00009910: 6172 6520 626f 7468 2067 7265 6174 206f  are both great o
+00009920: 7074 696f 6e73 2e20 5765 2077 696c 6c20  ptions. We will 
+00009930: 7365 6c65 6374 2074 6865 2072 6967 6874  select the right
+00009940: 2053 4d4f 5445 2066 756e 6374 696f 6e20   SMOTE function 
+00009950: 6175 746f 6d61 7469 6361 6c6c 792e 0a2d  automatically..-
+00009960: 2060 636f 6d62 696e 655f 7261 7265 603a   `combine_rare`:
+00009970: 2064 6566 6175 6c74 2069 7320 4661 6c73   default is Fals
+00009980: 652e 2054 6869 7320 6973 2061 2067 7265  e. This is a gre
+00009990: 6174 206f 7074 696f 6e20 6966 2079 6f75  at option if you
+000099a0: 2068 6176 6520 746f 6f20 6d61 6e79 2072   have too many r
+000099b0: 6172 6520 6361 7465 676f 7269 6573 2069  are categories i
+000099c0: 6e20 796f 7572 2063 6174 6567 6f72 6963  n your categoric
+000099d0: 616c 2076 6172 6961 626c 6573 2e20 4974  al variables. It
+000099e0: 2077 696c 6c20 6175 746f 6d61 7469 6361   will automatica
+000099f0: 6c6c 7920 636f 6d62 696e 6520 7468 6f73  lly combine thos
+00009a00: 6520 7261 7265 2063 6174 6567 6f72 6965  e rare categorie
+00009a10: 7320 7768 6963 6820 6172 6520 6c65 7373  s which are less
+00009a20: 2074 6861 6e20 3125 206f 6620 7468 6520   than 1% of the 
+00009a30: 6461 7461 7365 7420 696e 746f 206f 6e65  dataset into one
+00009a40: 2063 6f6d 6269 6e65 6420 6361 7465 676f   combined catego
+00009a50: 7279 2063 616c 6c65 6420 2272 6172 655f  ry called "rare_
+00009a60: 6361 7465 676f 7269 6573 222e 2059 6f75  categories". You
+00009a70: 2063 616e 2061 6c73 6f20 7365 7420 6974   can also set it
+00009a80: 2074 6f20 4661 6c73 6520 616e 6420 7765   to False and we
+00009a90: 2077 696c 6c20 6e6f 7420 7472 616e 7366   will not transf
+00009aa0: 6f72 6d20 616e 7920 6f66 2079 6f75 7220  orm any of your 
+00009ab0: 6361 7465 676f 7269 6573 2069 6e20 796f  categories in yo
+00009ac0: 7572 2063 6174 6567 6f72 6963 616c 2076  ur categorical v
+00009ad0: 6172 6961 626c 6573 2e0a 202d 2060 7665  ariables.. - `ve
+00009ae0: 7262 6f73 6560 3a20 5468 6973 2068 6173  rbose`: This has
+00009af0: 2033 2070 6f73 7369 626c 6520 7374 6174   3 possible stat
+00009b00: 6573 3a0a 2020 2d20 6030 6020 7369 6c65  es:.  - `0` sile
+00009b10: 6e74 206f 7574 7075 742e 2047 7265 6174  nt output. Great
+00009b20: 2066 6f72 2072 756e 6e69 6e67 2074 6869   for running thi
+00009b30: 7320 7369 6c65 6e74 6c79 2061 6e64 2067  s silently and g
+00009b40: 6574 7469 6e67 2066 6173 7420 7265 7375  etting fast resu
+00009b50: 6c74 732e 0a20 202d 2060 3160 206d 6f72  lts..  - `1` mor
+00009b60: 6520 7665 7262 6961 6765 2e20 4772 6561  e verbiage. Grea
+00009b70: 7420 666f 7220 6b6e 6f77 696e 6720 686f  t for knowing ho
+00009b80: 7720 7265 7375 6c74 7320 7765 7265 2061  w results were a
+00009b90: 6e64 206d 616b 696e 6720 6368 616e 6765  nd making change
+00009ba0: 7320 746f 2066 6c61 6773 2069 6e20 696e  s to flags in in
+00009bb0: 7075 742e 0a20 202d 2060 3260 2068 6967  put..  - `2` hig
+00009bc0: 686c 7920 7665 7262 6f73 6520 6f75 7470  hly verbose outp
+00009bd0: 7574 2e20 4772 6561 7420 666f 7220 6669  ut. Great for fi
+00009be0: 6e64 696e 6720 6f75 7420 7768 6174 2068  nding out what h
+00009bf0: 6170 7065 6e73 2075 6e64 6572 2074 6865  appens under the
+00009c00: 2068 6f6f 6420 696e 206c 617a 7974 7261   hood in lazytra
+00009c10: 6e73 666f 726d 2070 6970 656c 696e 6573  nsform pipelines
+00009c20: 2e0a 3c70 3e0a 546f 2076 6965 7720 7468  ..<p>.To view th
+00009c30: 6520 7465 7874 2070 6970 656c 696e 652c  e text pipeline,
+00009c40: 2074 6865 2064 6566 6175 6c74 2064 6973   the default dis
+00009c50: 706c 6179 2069 7320 2774 6578 7427 2c20  play is 'text', 
+00009c60: 646f 3a3c 6272 3e0a 0a60 6060 0a66 726f  do:<br>..```.fro
+00009c70: 6d20 736b 6c65 6172 6e20 696d 706f 7274  m sklearn import
+00009c80: 2073 6574 5f63 6f6e 6669 670a 7365 745f   set_config.set_
+00009c90: 636f 6e66 6967 2864 6973 706c 6179 3d22  config(display="
+00009ca0: 7465 7874 2229 0a6c 617a 792e 7866 6f72  text").lazy.xfor
+00009cb0: 6d65 720a 6060 600a 0a3c 703e 0a54 6f20  mer.```..<p>.To 
+00009cc0: 7669 6577 2074 6865 2070 6970 656c 696e  view the pipelin
+00009cd0: 6520 696e 2061 2064 6961 6772 616d 2028  e in a diagram (
+00009ce0: 7669 7375 616c 2066 6f72 6d61 7429 2c20  visual format), 
+00009cf0: 646f 3a3c 6272 3e0a 0a60 6060 0a66 726f  do:<br>..```.fro
+00009d00: 6d20 736b 6c65 6172 6e20 696d 706f 7274  m sklearn import
+00009d10: 2073 6574 5f63 6f6e 6669 670a 7365 745f   set_config.set_
+00009d20: 636f 6e66 6967 2864 6973 706c 6179 3d22  config(display="
+00009d30: 6469 6167 7261 6d22 290a 6c61 7a79 2e78  diagram").lazy.x
+00009d40: 666f 726d 6572 0a23 2049 6620 796f 7520  former.# If you 
+00009d50: 6861 7665 2061 206d 6f64 656c 2069 6e20  have a model in 
+00009d60: 7468 6520 7069 7065 6c69 6e65 2c20 646f  the pipeline, do
+00009d70: 3a0a 6c61 7a79 2e6d 6f64 656c 666f 726d  :.lazy.modelform
+00009d80: 6572 0a60 6060 0a3c 6120 6872 6566 3d22  er.```.<a href="
+00009d90: 6874 7470 733a 2f2f 696d 6762 622e 636f  https://imgbb.co
+00009da0: 6d2f 223e 3c69 6d67 2073 7263 3d22 6874  m/"><img src="ht
+00009db0: 7470 733a 2f2f 692e 6962 622e 636f 2f42  tps://i.ibb.co/B
+00009dc0: 6e37 5634 7078 2f6c 617a 792d 7069 7065  n7V4px/lazy-pipe
+00009dd0: 2e70 6e67 2220 616c 743d 226c 617a 792d  .png" alt="lazy-
+00009de0: 7069 7065 2220 626f 7264 6572 3d22 3022  pipe" border="0"
+00009df0: 3e3c 2f61 3e0a 0a54 6f20 7669 6577 2074  ></a>..To view t
+00009e00: 6865 2066 6561 7475 7265 2069 6d70 6f72  he feature impor
+00009e10: 7461 6e63 6573 206f 6620 7468 6520 6d6f  tances of the mo
+00009e20: 6465 6c20 696e 2074 6865 2070 6970 656c  del in the pipel
+00009e30: 696e 652c 2079 6f75 2063 616e 2064 6f3a  ine, you can do:
+00009e40: 0a60 6060 0a6c 617a 792e 706c 6f74 5f69  .```.lazy.plot_i
+00009e50: 6d70 6f72 7461 6e63 6528 290a 6060 600a  mportance().```.
+00009e60: 3c61 2068 7265 663d 2268 7474 7073 3a2f  <a href="https:/
+00009e70: 2f69 6262 2e63 6f2f 6a68 7073 5674 4a22  /ibb.co/jhpsVtJ"
+00009e80: 3e3c 696d 6720 7372 633d 2268 7474 7073  ><img src="https
+00009e90: 3a2f 2f69 2e69 6262 2e63 6f2f 634a 6d56  ://i.ibb.co/cJmV
+00009ea0: 6271 592f 6c61 7a79 2d66 6561 742d 696d  bqY/lazy-feat-im
+00009eb0: 702e 706e 6722 2061 6c74 3d22 6c61 7a79  p.png" alt="lazy
+00009ec0: 2d66 6561 742d 696d 7022 2062 6f72 6465  -feat-imp" borde
+00009ed0: 723d 2230 223e 3c2f 613e 0a0a 2323 204d  r="0"></a>..## M
+00009ee0: 6169 6e74 6169 6e65 7273 0a0a 2a20 5b40  aintainers..* [@
+00009ef0: 4175 746f 5669 4d4c 5d28 6874 7470 733a  AutoViML](https:
+00009f00: 2f2f 6769 7468 7562 2e63 6f6d 2f41 7574  //github.com/Aut
+00009f10: 6f56 694d 4c29 0a0a 2323 2043 6f6e 7472  oViML)..## Contr
+00009f20: 6962 7574 696e 670a 0a53 6565 205b 7468  ibuting..See [th
+00009f30: 6520 636f 6e74 7269 6275 7469 6e67 2066  e contributing f
+00009f40: 696c 655d 2843 4f4e 5452 4942 5554 494e  ile](CONTRIBUTIN
+00009f50: 472e 6d64 2921 0a0a 5052 7320 6163 6365  G.md)!..PRs acce
+00009f60: 7074 6564 2e0a 0a23 2320 4c69 6365 6e73  pted...## Licens
+00009f70: 650a 0a41 7061 6368 6520 4c69 6365 6e73  e..Apache Licens
+00009f80: 6520 322e 3020 c2a9 2032 3032 3020 5261  e 2.0 .. 2020 Ra
+00009f90: 6d20 5365 7368 6164 7269 0a0a 2323 204e  m Seshadri..## N
+00009fa0: 6f74 6520 6f66 2047 7261 7469 7475 6465  ote of Gratitude
+00009fb0: 0a0a 5468 6973 206c 6962 7261 7920 776f  ..This libray wo
+00009fc0: 756c 6420 6e6f 7420 6861 7665 2062 6565  uld not have bee
+00009fd0: 6e20 706f 7373 6962 6c65 2077 6974 686f  n possible witho
+00009fe0: 7574 2074 6865 2066 6f6c 6c6f 7769 6e67  ut the following
+00009ff0: 2067 7265 6174 206c 6962 7261 7269 6573   great libraries
+0000a000: 3a0a 3c6f 6c3e 0a3c 6c69 3e3c 623e 4361  :.<ol>.<li><b>Ca
+0000a010: 7465 676f 7279 2045 6e63 6f64 6572 7320  tegory Encoders 
+0000a020: 6c69 6272 6172 793a 3c2f 623e 2046 616e  library:</b> Fan
+0000a030: 7461 7374 6963 206c 6962 7261 7279 2068  tastic library h
+0000a040: 7474 7073 3a2f 2f63 6f6e 7472 6962 2e73  ttps://contrib.s
+0000a050: 6369 6b69 742d 6c65 6172 6e2e 6f72 672f  cikit-learn.org/
+0000a060: 6361 7465 676f 7279 5f65 6e63 6f64 6572  category_encoder
+0000a070: 732f 696e 6465 782e 6874 6d6c 3c2f 6c69  s/index.html</li
+0000a080: 3e0a 3c6c 693e 3c62 3e49 6d62 616c 616e  >.<li><b>Imbalan
+0000a090: 6365 6420 4c65 6172 6e20 6c69 6272 6172  ced Learn librar
+0000a0a0: 793a 3c2f 623e 2041 6e6f 7468 6572 2066  y:</b> Another f
+0000a0b0: 616e 7461 7374 6963 206c 6962 7261 7279  antastic library
+0000a0c0: 2068 7474 7073 3a2f 2f69 6d62 616c 616e   https://imbalan
+0000a0d0: 6365 642d 6c65 6172 6e2e 6f72 672f 7374  ced-learn.org/st
+0000a0e0: 6162 6c65 2f69 6e64 6578 2e68 746d 6c3c  able/index.html<
+0000a0f0: 2f6c 693e 0a3c 6c69 3e3c 623e 5468 6520  /li>.<li><b>The 
+0000a100: 616d 617a 696e 6720 606c 617a 7970 7265  amazing `lazypre
+0000a110: 6469 6374 603c 2f62 3e20 7761 7320 616e  dict`</b> was an
+0000a120: 2069 6e73 7069 7261 7469 6f6e 2066 6f72   inspiration for
+0000a130: 2060 6c61 7a79 7472 616e 7366 6f72 6d60   `lazytransform`
+0000a140: 2e20 596f 7520 6361 6e20 6368 6563 6b20  . You can check 
+0000a150: 6f75 7420 7468 6520 6c69 6272 6172 7920  out the library 
+0000a160: 6865 7265 3a0a 6874 7470 733a 2f2f 6769  here:.https://gi
+0000a170: 7468 7562 2e63 6f6d 2f73 6861 6e6b 6172  thub.com/shankar
+0000a180: 7061 6e64 616c 612f 6c61 7a79 7072 6564  pandala/lazypred
+0000a190: 6963 740a 3c2f 6c69 3e0a 3c6c 693e 3c62  ict.</li>.<li><b
+0000a1a0: 3e54 6865 2061 6d61 7a69 6e67 2060 4b65  >The amazing `Ke
+0000a1b0: 7669 6e20 4d61 726b 6861 6d60 3c2f 623e  vin Markham`</b>
+0000a1c0: 2077 6173 2061 6e6f 7468 6572 2069 6e73   was another ins
+0000a1d0: 7069 7261 7469 6f6e 2066 6f72 206c 617a  piration for laz
+0000a1e0: 7974 7261 6e73 666f 726d 2e20 596f 7520  ytransform. You 
+0000a1f0: 6361 6e20 6368 6563 6b20 6f75 7420 6869  can check out hi
+0000a200: 7320 636c 6173 7365 7320 6865 7265 3a0a  s classes here:.
+0000a210: 6874 7470 733a 2f2f 7777 772e 6461 7461  https://www.data
+0000a220: 7363 686f 6f6c 2e69 6f2f 6162 6f75 742f  school.io/about/
+0000a230: 0a3c 2f6c 693e 0a3c 2f6f 6c3e 0a0a 2323  .</li>.</ol>..##
+0000a240: 2044 4953 434c 4149 4d45 520a 5468 6973   DISCLAIMER.This
+0000a250: 2070 726f 6a65 6374 2069 7320 6e6f 7420   project is not 
+0000a260: 616e 206f 6666 6963 6961 6c20 476f 6f67  an official Goog
+0000a270: 6c65 2070 726f 6a65 6374 2e20 4974 2069  le project. It i
+0000a280: 7320 6e6f 7420 7375 7070 6f72 7465 6420  s not supported 
+0000a290: 6279 2047 6f6f 676c 6520 616e 6420 476f  by Google and Go
+0000a2a0: 6f67 6c65 2073 7065 6369 6669 6361 6c6c  ogle specificall
+0000a2b0: 7920 6469 7363 6c61 696d 7320 616c 6c20  y disclaims all 
+0000a2c0: 7761 7272 616e 7469 6573 2061 7320 746f  warranties as to
+0000a2d0: 2069 7473 2071 7561 6c69 7479 2c20 6d65   its quality, me
+0000a2e0: 7263 6861 6e74 6162 696c 6974 792c 206f  rchantability, o
+0000a2f0: 7220 6669 746e 6573 7320 666f 7220 6120  r fitness for a 
+0000a300: 7061 7274 6963 756c 6172 2070 7572 706f  particular purpo
+0000a310: 7365 2e0a 0a00 0000 0000 0000 0000 0000  se..............
+0000a320: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+0000a330: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+0000a340: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+0000a350: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+0000a360: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+0000a370: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+0000a380: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+0000a390: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+0000a3a0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+0000a3b0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+0000a3c0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+0000a3d0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+0000a3e0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+0000a3f0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+0000a400: 2e2f 2e2f 4050 6178 4865 6164 6572 0000  ././@PaxHeader..
+0000a410: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+0000a420: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+0000a430: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+0000a440: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+0000a450: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+0000a460: 0000 0000 3030 3030 3030 3000 3030 3030  ....0000000.0000
+0000a470: 3030 3000 3030 3030 3030 3000 3030 3030  000.0000000.0000
+0000a480: 3030 3030 3033 3400 3030 3030 3030 3030  0000034.00000000
+0000a490: 3030 3000 3031 3134 3532 0020 7800 0000  000.011452. x...
+0000a4a0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+0000a4b0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+0000a4c0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+0000a4d0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+0000a4e0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+0000a4f0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+0000a500: 0075 7374 6172 0030 3000 0000 0000 0000  .ustar.00.......
+0000a510: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+0000a520: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+0000a530: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+0000a540: 0000 0000 0000 0000 0030 3030 3030 3030  .........0000000
+0000a550: 0030 3030 3030 3030 0000 0000 0000 0000  .0000000........
+0000a560: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+0000a570: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+0000a580: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+0000a590: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+0000a5a0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+0000a5b0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+0000a5c0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+0000a5d0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+0000a5e0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+0000a5f0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+0000a600: 3238 206d 7469 6d65 3d31 3638 3432 3838  28 mtime=1684288
+0000a610: 3437 332e 3539 3934 3033 340a 0000 0000  473.5994034.....
+0000a620: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+0000a630: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+0000a640: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+0000a650: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+0000a660: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+0000a670: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+0000a680: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+0000a690: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+0000a6a0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+0000a6b0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+0000a6c0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+0000a6d0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+0000a6e0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+0000a6f0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+0000a700: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+0000a710: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+0000a720: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+0000a730: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+0000a740: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+0000a750: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+0000a760: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+0000a770: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+0000a780: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+0000a790: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+0000a7a0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+0000a7b0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+0000a7c0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+0000a7d0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+0000a7e0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+0000a7f0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+0000a800: 6c61 7a79 7472 616e 7366 6f72 6d2d 312e  lazytransform-1.
+0000a810: 312f 6c61 7a79 7472 616e 7366 6f72 6d2e  1/lazytransform.
+0000a820: 6567 672d 696e 666f 2f00 0000 0000 0000  egg-info/.......
+0000a830: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+0000a840: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+0000a850: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+0000a860: 0000 0000 3030 3030 3737 3700 3030 3031  ....0000777.0001
+0000a870: 3735 3000 3030 3031 3735 3000 3030 3030  750.0001750.0000
+0000a880: 3030 3030 3030 3000 3030 3030 3030 3030  0000000.00000000
+0000a890: 3030 3000 3032 3032 3630 0020 3500 0000  000.020260. 5...
+0000a8a0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+0000a8b0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+0000a8c0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+0000a8d0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+0000a8e0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+0000a8f0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+0000a900: 0075 7374 6172 0030 3072 616d 0000 0000  .ustar.00ram....
+0000a910: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+0000a920: 0000 0000 0000 0000 0072 616d 0000 0000  .........ram....
+0000a930: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+0000a940: 0000 0000 0000 0000 0030 3030 3030 3030  .........0000000
+0000a950: 0030 3030 3030 3030 0000 0000 0000 0000  .0000000........
+0000a960: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+0000a970: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+0000a980: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+0000a990: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+0000a9a0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+0000a9b0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+0000a9c0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+0000a9d0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+0000a9e0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+0000a9f0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+0000aa00: 2e2f 2e2f 4050 6178 4865 6164 6572 0000  ././@PaxHeader..
+0000aa10: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+0000aa20: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+0000aa30: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+0000aa40: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+0000aa50: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+0000aa60: 0000 0000 3030 3030 3030 3000 3030 3030  ....0000000.0000
+0000aa70: 3030 3000 3030 3030 3030 3000 3030 3030  000.0000000.0000
+0000aa80: 3030 3030 3032 3600 3030 3030 3030 3030  0000026.00000000
+0000aa90: 3030 3000 3031 3134 3533 0020 7800 0000  000.011453. x...
+0000aaa0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+0000aab0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+0000aac0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+0000aad0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+0000aae0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+0000aaf0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+0000ab00: 0075 7374 6172 0030 3000 0000 0000 0000  .ustar.00.......
+0000ab10: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+0000ab20: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+0000ab30: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+0000ab40: 0000 0000 0000 0000 0030 3030 3030 3030  .........0000000
+0000ab50: 0030 3030 3030 3030 0000 0000 0000 0000  .0000000........
+0000ab60: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+0000ab70: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+0000ab80: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+0000ab90: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+0000aba0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+0000abb0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+0000abc0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+0000abd0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+0000abe0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+0000abf0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+0000ac00: 3232 206d 7469 6d65 3d31 3638 3432 3838  22 mtime=1684288
+0000ac10: 3437 332e 300a 0000 0000 0000 0000 0000  473.0...........
+0000ac20: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+0000ac30: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+0000ac40: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+0000ac50: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+0000ac60: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+0000ac70: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+0000ac80: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+0000ac90: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+0000aca0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+0000acb0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+0000acc0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+0000acd0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+0000ace0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+0000acf0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+0000ad00: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+0000ad10: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+0000ad20: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+0000ad30: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+0000ad40: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+0000ad50: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+0000ad60: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+0000ad70: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+0000ad80: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+0000ad90: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+0000ada0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+0000adb0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+0000adc0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+0000add0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+0000ade0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+0000adf0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+0000ae00: 6c61 7a79 7472 616e 7366 6f72 6d2d 312e  lazytransform-1.
+0000ae10: 312f 6c61 7a79 7472 616e 7366 6f72 6d2e  1/lazytransform.
+0000ae20: 6567 672d 696e 666f 2f50 4b47 2d49 4e46  egg-info/PKG-INF
+0000ae30: 4f00 0000 0000 0000 0000 0000 0000 0000  O...............
+0000ae40: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+0000ae50: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+0000ae60: 0000 0000 3030 3030 3737 3700 3030 3031  ....0000777.0001
+0000ae70: 3735 3000 3030 3031 3735 3000 3030 3030  750.0001750.0000
+0000ae80: 3030 3436 3330 3400 3030 3030 3030 3030  0046304.00000000
+0000ae90: 3030 3000 3032 3133 3637 0020 3000 0000  000.021367. 0...
+0000aea0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+0000aeb0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+0000aec0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+0000aed0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+0000aee0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+0000aef0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+0000af00: 0075 7374 6172 0030 3072 616d 0000 0000  .ustar.00ram....
+0000af10: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+0000af20: 0000 0000 0000 0000 0072 616d 0000 0000  .........ram....
+0000af30: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+0000af40: 0000 0000 0000 0000 0030 3030 3030 3030  .........0000000
+0000af50: 0030 3030 3030 3030 0000 0000 0000 0000  .0000000........
+0000af60: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+0000af70: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+0000af80: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+0000af90: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+0000afa0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+0000afb0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+0000afc0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+0000afd0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+0000afe0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+0000aff0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+0000b000: 4d65 7461 6461 7461 2d56 6572 7369 6f6e  Metadata-Version
+0000b010: 3a20 322e 310a 4e61 6d65 3a20 6c61 7a79  : 2.1.Name: lazy
+0000b020: 7472 616e 7366 6f72 6d0a 5665 7273 696f  transform.Versio
+0000b030: 6e3a 2031 2e31 0a53 756d 6d61 7279 3a20  n: 1.1.Summary: 
+0000b040: 436c 6561 6e20 796f 7572 2064 6174 6120  Clean your data 
+0000b050: 7573 696e 6720 6120 7363 696b 6974 2d6c  using a scikit-l
+0000b060: 6561 726e 2074 7261 6e73 666f 726d 6572  earn transformer
+0000b070: 2069 6e20 6120 7369 6e67 6c65 206c 696e   in a single lin
+0000b080: 6520 6f66 2063 6f64 650a 486f 6d65 2d70  e of code.Home-p
+0000b090: 6167 653a 2068 7474 7073 3a2f 2f67 6974  age: https://git
+0000b0a0: 6875 622e 636f 6d2f 4175 746f 5669 4d4c  hub.com/AutoViML
+0000b0b0: 2f6c 617a 7974 7261 6e73 666f 726d 0a41  /lazytransform.A
+0000b0c0: 7574 686f 723a 2052 616d 2053 6573 6861  uthor: Ram Sesha
+0000b0d0: 6472 690a 4c69 6365 6e73 653a 2041 7061  dri.License: Apa
+0000b0e0: 6368 6520 4c69 6365 6e73 6520 322e 300a  che License 2.0.
+0000b0f0: 4465 7363 7269 7074 696f 6e3a 2023 206c  Description: # l
+0000b100: 617a 7974 7261 6e73 666f 726d 0a20 2020  azytransform.   
+0000b110: 2020 2020 2041 7574 6f6d 6174 6963 616c       Automatical
+0000b120: 6c79 2074 7261 6e73 666f 726d 2061 6c6c  ly transform all
+0000b130: 2063 6174 6567 6f72 6963 616c 2c20 6461   categorical, da
+0000b140: 7465 2d74 696d 652c 204e 4c50 2076 6172  te-time, NLP var
+0000b150: 6961 626c 6573 2069 6e20 796f 7572 2064  iables in your d
+0000b160: 6174 6120 7365 7420 746f 206e 756d 6572  ata set to numer
+0000b170: 6963 2069 6e20 6120 7369 6e67 6c65 206c  ic in a single l
+0000b180: 696e 6520 6f66 2063 6f64 6520 666f 7220  ine of code for 
+0000b190: 616e 7920 6461 7461 2073 6574 2061 6e79  any data set any
+0000b1a0: 2073 697a 652e 0a20 2020 2020 2020 200a   size..        .
+0000b1b0: 2020 2020 2020 2020 2323 2055 7064 6174          ## Updat
+0000b1c0: 6520 2841 7567 2032 3032 3229 0a20 2020  e (Aug 2022).   
+0000b1d0: 2020 2020 203c 6f6c 3e0a 2020 2020 2020       <ol>.      
+0000b1e0: 2020 3c6c 693e 3c62 3e6c 617a 7974 7261    <li><b>lazytra
+0000b1f0: 6e73 666f 726d 2069 7320 7665 7279 2065  nsform is very e
+0000b200: 6173 7920 746f 2069 6e73 7461 6c6c 206f  asy to install o
+0000b210: 6e20 4b61 6767 6c65 2061 6e64 2043 6f6c  n Kaggle and Col
+0000b220: 6162 206e 6f74 6562 6f6f 6b73 2075 7369  ab notebooks usi
+0000b230: 6e67 2074 6869 7320 636f 6d6d 616e 643a  ng this command:
+0000b240: 3c2f 623e 2e20 0a20 2020 2020 2020 200a  </b>. .        .
+0000b250: 2020 2020 2020 2020 6060 600a 2020 2020          ```.    
+0000b260: 2020 2020 2170 6970 2069 6e73 7461 6c6c      !pip install
+0000b270: 206c 617a 7974 7261 6e73 666f 726d 202d   lazytransform -
+0000b280: 2d69 676e 6f72 652d 696e 7374 616c 6c65  -ignore-installe
+0000b290: 6420 2d2d 6e6f 2d63 6163 6865 202d 2d6e  d --no-cache --n
+0000b2a0: 6f2d 6465 7073 0a20 2020 2020 2020 2060  o-deps.        `
+0000b2b0: 6060 0a20 2020 2020 2020 203c 2f6c 693e  ``.        </li>
+0000b2c0: 3c62 723e 0a20 2020 2020 2020 203c 6c69  <br>.        <li
+0000b2d0: 3e3c 623e 6c61 7a79 7472 616e 7366 6f72  ><b>lazytransfor
+0000b2e0: 6d20 6173 206f 6620 7665 7273 696f 6e20  m as of version 
+0000b2f0: 302e 3931 2068 6173 2074 776f 2053 7570  0.91 has two Sup
+0000b300: 6572 204c 6561 726e 696e 6720 4f70 7469  er Learning Opti
+0000b310: 6d69 7a65 6420 2853 554c 4f29 2045 6e73  mized (SULO) Ens
+0000b320: 656d 626c 6573 206e 616d 6564 2022 5375  embles named "Su
+0000b330: 6c6f 436c 6173 7369 6669 6572 2220 616e  loClassifier" an
+0000b340: 6420 2253 756c 6f52 6567 7265 7373 6f72  d "SuloRegressor
+0000b350: 223c 2f62 3e2e 2054 6865 2065 7374 696d  "</b>. The estim
+0000b360: 6174 6f72 7320 6172 6520 226f 7074 696d  ators are "optim
+0000b370: 697a 6564 2220 696e 2074 6865 2073 656e  ized" in the sen
+0000b380: 7365 2074 6861 7420 796f 7520 6361 6e20  se that you can 
+0000b390: 7573 6520 7468 656d 2066 6f72 2061 6c6c  use them for all
+0000b3a0: 206b 696e 6473 206f 6620 6d75 6c74 692d   kinds of multi-
+0000b3b0: 6c61 6265 6c20 6d75 6c74 692d 636c 6173  label multi-clas
+0000b3c0: 7320 616e 6420 496d 6261 6c61 6e63 6564  s and Imbalanced
+0000b3d0: 2064 6174 6120 7365 7420 7072 6f62 6c65   data set proble
+0000b3e0: 6d73 2077 6974 686f 7574 206e 6565 6469  ms without needi
+0000b3f0: 6e67 2074 6f20 646f 2068 7970 6572 2d70  ng to do hyper-p
+0000b400: 6172 616d 6574 6572 2074 756e 696e 6720  arameter tuning 
+0000b410: 7769 7468 2047 7269 6453 6561 7263 6843  with GridSearchC
+0000b420: 562e 2054 6865 7920 6172 6520 6275 696c  V. They are buil
+0000b430: 7420 7573 696e 6720 6261 7369 6320 7363  t using basic sc
+0000b440: 696b 6974 2d6c 6561 726e 2065 7374 696d  ikit-learn estim
+0000b450: 6174 6f72 7320 616e 6420 6172 6520 7365  ators and are se
+0000b460: 6c66 2d6f 7074 696d 697a 696e 6720 7369  lf-optimizing si
+0000b470: 6e63 6520 7468 6579 2070 6572 666f 726d  nce they perform
+0000b480: 2068 7970 6572 2d70 6172 616d 2074 756e   hyper-param tun
+0000b490: 696e 6720 666f 7220 6561 6368 206b 696e  ing for each kin
+0000b4a0: 6420 6f66 2070 726f 626c 656d 2061 6e64  d of problem and
+0000b4b0: 2075 7365 2077 6569 6768 7473 2066 6f72   use weights for
+0000b4c0: 2065 6163 6820 636c 6173 7369 6669 6572   each classifier
+0000b4d0: 206f 7220 7265 6772 6573 736f 722c 2064   or regressor, d
+0000b4e0: 6966 6665 7265 6e74 2072 616e 646f 6d20  ifferent random 
+0000b4f0: 7365 6564 732c 2065 7463 2e20 746f 206d  seeds, etc. to m
+0000b500: 616b 6520 7468 656d 2068 6967 686c 7920  ake them highly 
+0000b510: 7065 7266 6f72 6d61 6e74 2e20 4f6e 2074  performant. On t
+0000b520: 6f70 206f 6620 6974 2c20 7468 6579 2061  op of it, they a
+0000b530: 7265 2066 756c 6c79 2073 6369 6b69 742d  re fully scikit-
+0000b540: 6c65 6172 6e20 636f 6d70 6174 6962 6c65  learn compatible
+0000b550: 2077 6974 6820 7468 6520 7361 6d65 2022   with the same "
+0000b560: 6669 7420 616e 6420 7072 6564 6963 7422  fit and predict"
+0000b570: 2073 796e 7461 782e 203c 2f6c 693e 0a20   syntax. </li>. 
+0000b580: 2020 2020 2020 2054 616b 6520 6120 6c6f         Take a lo
+0000b590: 6f6b 2061 7420 7468 6520 6265 6e63 686d  ok at the benchm
+0000b5a0: 6172 6b69 6e67 2072 6573 756c 7473 206e  arking results n
+0000b5b0: 6f74 6562 6f6f 6b20 6865 7265 2066 6f72  otebook here for
+0000b5c0: 2053 756c 6f43 6c61 7373 6966 6965 723a   SuloClassifier:
+0000b5d0: 200a 2020 2020 2020 2020 0a20 2020 2020   .        .     
+0000b5e0: 2020 2021 5b4e 6f74 6562 6f6f 6b5d 2868     ![Notebook](h
+0000b5f0: 7474 7073 3a2f 2f67 6974 6875 622e 636f  ttps://github.co
+0000b600: 6d2f 4175 746f 5669 4d4c 2f6c 617a 7974  m/AutoViML/lazyt
+0000b610: 7261 6e73 666f 726d 2f74 7265 652f 6d61  ransform/tree/ma
+0000b620: 696e 2f6e 6f74 6562 6f6f 6b73 2f53 756c  in/notebooks/Sul
+0000b630: 6f43 6c61 7373 6966 6965 725f 4265 6e63  oClassifier_Benc
+0000b640: 686d 6172 6b69 6e67 5f52 6573 756c 7473  hmarking_Results
+0000b650: 2e69 7079 6e62 290a 2020 2020 2020 2020  .ipynb).        
+0000b660: 0a20 2020 2020 2020 2021 5b53 756c 6f43  .        ![SuloC
+0000b670: 6c61 7373 6966 6965 725d 282e 2f69 6d61  lassifier](./ima
+0000b680: 6765 732f 5375 6c6f 436c 6173 7369 6669  ges/SuloClassifi
+0000b690: 6572 2e70 6e67 290a 2020 2020 2020 2020  er.png).        
+0000b6a0: 0a20 2020 2020 2020 2057 6520 7261 6e20  .        We ran 
+0000b6b0: 6120 7369 6d69 6c61 7220 6265 6e63 686d  a similar benchm
+0000b6c0: 6172 6b69 6e67 2072 6573 756c 7420 696e  arking result in
+0000b6d0: 2053 756c 6f52 6567 7265 7373 6f72 2061   SuloRegressor a
+0000b6e0: 6761 696e 7374 2058 4742 6f6f 7374 2061  gainst XGBoost a
+0000b6f0: 6e64 204c 6967 6874 4742 4d20 5265 6772  nd LightGBM Regr
+0000b700: 6573 736f 7273 2061 6e64 2069 7420 6865  essors and it he
+0000b710: 6c64 2069 7473 206f 776e 2061 6761 696e  ld its own again
+0000b720: 7374 2074 6865 6d2e 2054 616b 6520 6120  st them. Take a 
+0000b730: 6c6f 6f6b 2061 7420 7468 6520 6265 6e63  look at the benc
+0000b740: 686d 6172 6b69 6e67 2072 6573 756c 743a  hmarking result:
+0000b750: 0a20 2020 2020 2020 200a 2020 2020 2020  .        .      
+0000b760: 2020 215b 4e6f 7465 626f 6f6b 5d28 6874    ![Notebook](ht
+0000b770: 7470 733a 2f2f 6769 7468 7562 2e63 6f6d  tps://github.com
+0000b780: 2f41 7574 6f56 694d 4c2f 6c61 7a79 7472  /AutoViML/lazytr
+0000b790: 616e 7366 6f72 6d2f 7472 6565 2f6d 6169  ansform/tree/mai
+0000b7a0: 6e2f 6e6f 7465 626f 6f6b 732f 5375 6c6f  n/notebooks/Sulo
+0000b7b0: 5265 6772 6573 736f 725f 4265 6e63 686d  Regressor_Benchm
+0000b7c0: 6172 6b69 6e67 5f52 6573 756c 7473 2e69  arking_Results.i
+0000b7d0: 7079 6e62 290a 2020 2020 2020 2020 0a20  pynb).        . 
+0000b7e0: 2020 2020 2020 2021 5b53 756c 6f52 6567         ![SuloReg
+0000b7f0: 7265 7373 6f72 5d28 2e2f 696d 6167 6573  ressor](./images
+0000b800: 2f53 756c 6f52 6567 7265 7373 6f72 2e70  /SuloRegressor.p
+0000b810: 6e67 290a 2020 2020 2020 2020 0a20 2020  ng).        .   
+0000b820: 2020 2020 2023 2054 6162 6c65 206f 6620       # Table of 
+0000b830: 436f 6e74 656e 7473 0a20 2020 2020 2020  Contents.       
+0000b840: 203c 756c 3e0a 2020 2020 2020 2020 3c6c   <ul>.        <l
+0000b850: 693e 3c61 2068 7265 663d 2223 696e 7472  i><a href="#intr
+0000b860: 6f64 7563 7469 6f6e 223e 5768 6174 2069  oduction">What i
+0000b870: 7320 6c61 7a79 7472 616e 7366 6f72 6d3c  s lazytransform<
+0000b880: 2f61 3e3c 2f6c 693e 0a20 2020 2020 2020  /a></li>.       
+0000b890: 203c 6c69 3e3c 6120 6872 6566 3d22 2375   <li><a href="#u
+0000b8a0: 7365 7322 3e48 6f77 2074 6f20 7573 6520  ses">How to use 
+0000b8b0: 6c61 7a79 7472 616e 7366 6f72 6d3c 2f61  lazytransform</a
+0000b8c0: 3e3c 2f6c 693e 0a20 2020 2020 2020 203c  ></li>.        <
+0000b8d0: 6c69 3e3c 6120 6872 6566 3d22 2369 6e73  li><a href="#ins
+0000b8e0: 7461 6c6c 223e 486f 7720 746f 2069 6e73  tall">How to ins
+0000b8f0: 7461 6c6c 206c 617a 7974 7261 6e73 666f  tall lazytransfo
+0000b900: 726d 3c2f 613e 3c2f 6c69 3e0a 2020 2020  rm</a></li>.    
+0000b910: 2020 2020 3c6c 693e 3c61 2068 7265 663d      <li><a href=
+0000b920: 2223 7573 6167 6522 3e55 7361 6765 3c2f  "#usage">Usage</
+0000b930: 613e 3c2f 6c69 3e0a 2020 2020 2020 2020  a></li>.        
+0000b940: 3c6c 693e 3c61 2068 7265 663d 2223 6170  <li><a href="#ap
+0000b950: 6922 3e41 5049 3c2f 613e 3c2f 6c69 3e0a  i">API</a></li>.
+0000b960: 2020 2020 2020 2020 3c6c 693e 3c61 2068          <li><a h
+0000b970: 7265 663d 2223 6d61 696e 7461 696e 6572  ref="#maintainer
+0000b980: 7322 3e4d 6169 6e74 6169 6e65 7273 3c2f  s">Maintainers</
+0000b990: 613e 3c2f 6c69 3e0a 2020 2020 2020 2020  a></li>.        
+0000b9a0: 3c6c 693e 3c61 2068 7265 663d 2223 636f  <li><a href="#co
+0000b9b0: 6e74 7269 6275 7469 6e67 223e 436f 6e74  ntributing">Cont
+0000b9c0: 7269 6275 7469 6e67 3c2f 613e 3c2f 6c69  ributing</a></li
+0000b9d0: 3e0a 2020 2020 2020 2020 3c6c 693e 3c61  >.        <li><a
+0000b9e0: 2068 7265 663d 2223 6c69 6365 6e73 6522   href="#license"
+0000b9f0: 3e4c 6963 656e 7365 3c2f 613e 3c2f 6c69  >License</a></li
+0000ba00: 3e0a 2020 2020 2020 2020 3c2f 756c 3e0a  >.        </ul>.
+0000ba10: 2020 2020 2020 2020 3c70 3e0a 2020 2020          <p>.    
+0000ba20: 2020 2020 0a20 2020 2020 2020 2023 2320      .        ## 
+0000ba30: 496e 7472 6f64 7563 7469 6f6e 0a20 2020  Introduction.   
+0000ba40: 2020 2020 2023 2323 2057 6861 7420 6973       ### What is
+0000ba50: 206c 617a 7974 7261 6e73 666f 726d 3f0a   lazytransform?.
+0000ba60: 2020 2020 2020 2020 606c 617a 7974 7261          `lazytra
+0000ba70: 6e73 666f 726d 6020 6973 2061 206e 6577  nsform` is a new
+0000ba80: 2070 7974 686f 6e20 6c69 6272 6172 7920   python library 
+0000ba90: 666f 7220 6175 746f 6d61 7469 6361 6c6c  for automaticall
+0000baa0: 7920 7472 616e 7366 6f72 6d69 6e67 2079  y transforming y
+0000bab0: 6f75 7220 656e 7469 7265 2064 6174 6173  our entire datas
+0000bac0: 6574 2074 6f20 6e75 6d65 7269 6320 666f  et to numeric fo
+0000bad0: 726d 6174 2075 7369 6e67 2063 6174 6567  rmat using categ
+0000bae0: 6f72 7920 656e 636f 6465 7273 2c20 4e4c  ory encoders, NL
+0000baf0: 5020 7465 7874 2076 6563 746f 7269 7a65  P text vectorize
+0000bb00: 7273 2061 6e64 2070 616e 6461 7320 6461  rs and pandas da
+0000bb10: 7465 2074 696d 6520 7072 6f63 6573 7369  te time processi
+0000bb20: 6e67 2066 756e 6374 696f 6e73 2e20 416c  ng functions. Al
+0000bb30: 6c20 696e 2061 2073 696e 676c 6520 6c69  l in a single li
+0000bb40: 6e65 206f 6620 636f 6465 210a 2020 2020  ne of code!.    
+0000bb50: 2020 2020 0a20 2020 2020 2020 2021 5b6c      .        ![l
+0000bb60: 617a 7974 7261 6e73 666f 726d 6572 5d28  azytransformer](
+0000bb70: 2e2f 696d 6167 6573 2f6c 617a 7974 7261  ./images/lazytra
+0000bb80: 6e73 666f 726d 6572 2e6a 7067 290a 2020  nsformer.jpg).  
+0000bb90: 2020 2020 2020 0a20 2020 2020 2020 2023        .        #
+0000bba0: 2320 5573 6573 0a20 2020 2020 2020 2060  # Uses.        `
+0000bbb0: 6c61 7a79 7472 616e 7366 6f72 6d60 2068  lazytransform` h
+0000bbc0: 6173 2074 776f 2069 6d70 6f72 7461 6e74  as two important
+0000bbd0: 2075 7365 7320 696e 2074 6865 2044 6174   uses in the Dat
+0000bbe0: 6120 5363 6965 6e63 6520 7072 6f63 6573  a Science proces
+0000bbf0: 732e 2049 7420 6361 6e20 6265 2075 7365  s. It can be use
+0000bc00: 6420 696e 2046 6561 7475 7265 2045 6e67  d in Feature Eng
+0000bc10: 6720 746f 2074 7261 6e73 666f 726d 2066  g to transform f
+0000bc20: 6561 7475 7265 7320 6f72 2061 6464 2066  eatures or add f
+0000bc30: 6561 7475 7265 7320 2873 6565 2041 5049  eatures (see API
+0000bc40: 2062 656c 6f77 292e 2049 7420 6361 6e20   below). It can 
+0000bc50: 616c 736f 2062 6520 7573 6564 2069 6e20  also be used in 
+0000bc60: 4d4c 4f70 7320 746f 2074 7261 696e 2061  MLOps to train a
+0000bc70: 6e64 2065 7661 6c75 6174 6520 6d6f 6465  nd evaluate mode
+0000bc80: 6c73 2069 6e20 6461 7461 2070 6970 656c  ls in data pipel
+0000bc90: 696e 6573 2077 6974 6820 6d75 6c74 6970  ines with multip
+0000bca0: 6c65 206d 6f64 656c 7320 6265 696e 6720  le models being 
+0000bcb0: 7472 6169 6e65 6420 7369 6d75 6c74 616e  trained simultan
+0000bcc0: 6575 736c 7920 7573 696e 6720 7468 6520  eusly using the 
+0000bcd0: 7361 6d65 2074 7261 696e 2f74 6573 7420  same train/test 
+0000bce0: 7370 6c69 7420 616e 6420 7468 6520 7361  split and the sa
+0000bcf0: 6d65 2066 6561 7475 7265 2065 6e67 6720  me feature engg 
+0000bd00: 7374 6570 732e 2054 6869 7320 656e 7375  steps. This ensu
+0000bd10: 7265 7320 7468 6174 2074 6865 7265 2069  res that there i
+0000bd20: 7320 6162 736f 6c75 7465 6c79 207a 6572  s absolutely zer
+0000bd30: 6f20 6f72 206d 696e 696d 616c 2064 6174  o or minimal dat
+0000bd40: 6120 6c65 616b 6167 6520 696e 2079 6f75  a leakage in you
+0000bd50: 7220 4d4c 4f70 7320 7069 7065 6c69 6e65  r MLOps pipeline
+0000bd60: 732e 0a20 2020 2020 2020 200a 2020 2020  s..        .    
+0000bd70: 2020 2020 2323 2320 312e 2020 5573 696e      ### 1.  Usin
+0000bd80: 6720 6c61 7a79 7472 616e 7366 6f72 6d20  g lazytransform 
+0000bd90: 6173 2061 2073 696d 706c 6520 7061 6e64  as a simple pand
+0000bda0: 6173 2064 6174 6120 7472 616e 7366 6f72  as data transfor
+0000bdb0: 6d61 7469 6f6e 2070 6970 656c 696e 6520  mation pipeline 
+0000bdc0: 0a20 2020 2020 2020 200a 2020 2020 2020  .        .      
+0000bdd0: 2020 3c70 3e54 6865 2066 6972 7374 206d    <p>The first m
+0000bde0: 6574 686f 6420 6973 2070 726f 6261 626c  ethod is probabl
+0000bdf0: 7920 7468 6520 6d6f 7374 2070 6f70 756c  y the most popul
+0000be00: 6172 2077 6179 2074 6f20 7573 6520 6c61  ar way to use la
+0000be10: 7a79 7472 616e 7366 6f72 6d2e 2054 6865  zytransform. The
+0000be20: 2074 7261 6e73 666f 726d 6572 2077 6974   transformer wit
+0000be30: 6869 6e20 6c61 7a79 7472 616e 7366 6f72  hin lazytransfor
+0000be40: 6d20 6361 6e20 6265 2075 7365 6420 746f  m can be used to
+0000be50: 2074 7261 6e73 666f 726d 2061 6e64 2063   transform and c
+0000be60: 7265 6174 6520 6e65 7720 6665 6174 7572  reate new featur
+0000be70: 6573 2066 726f 6d20 6361 7465 676f 7269  es from categori
+0000be80: 6361 6c2c 2064 6174 652d 7469 6d65 2061  cal, date-time a
+0000be90: 6e64 204e 4c50 2028 7465 7874 2920 6665  nd NLP (text) fe
+0000bea0: 6174 7572 6573 2069 6e20 796f 7572 2064  atures in your d
+0000beb0: 6174 6173 6574 2e20 5468 6973 2074 7261  ataset. This tra
+0000bec0: 6e73 666f 726d 6572 2070 6970 656c 696e  nsformer pipelin
+0000bed0: 6520 6973 2066 756c 6c79 2073 6369 6b69  e is fully sciki
+0000bee0: 742d 6c65 6172 6e20 5069 7065 6c69 6e65  t-learn Pipeline
+0000bef0: 2063 6f6d 7061 7469 626c 6520 616e 6420   compatible and 
+0000bf00: 6361 6e20 6265 2075 7365 6420 746f 2062  can be used to b
+0000bf10: 7569 6c64 2065 7665 6e20 6d6f 7265 2063  uild even more c
+0000bf20: 6f6d 706c 6578 2070 6970 656c 696e 6573  omplex pipelines
+0000bf30: 2062 7920 796f 7520 6261 7365 6420 6f6e   by you based on
+0000bf40: 2060 6d61 6b65 5f70 6970 656c 696e 6560   `make_pipeline`
+0000bf50: 2073 7461 7465 6d65 6e74 2066 726f 6d20   statement from 
+0000bf60: 6073 6b6c 6561 726e 2e70 6970 656c 696e  `sklearn.pipelin
+0000bf70: 6560 206c 6962 7261 7279 2e20 3c61 2068  e` library. <a h
+0000bf80: 7265 663d 2268 7474 7073 3a2f 2f67 6974  ref="https://git
+0000bf90: 6875 622e 636f 6d2f 4175 746f 5669 4d4c  hub.com/AutoViML
+0000bfa0: 2f6c 617a 7974 7261 6e73 666f 726d 2f62  /lazytransform/b
+0000bfb0: 6c6f 622f 6d61 696e 2f46 6561 7475 7265  lob/main/Feature
+0000bfc0: 7769 7a5f 4c61 7a79 5472 616e 7366 6f72  wiz_LazyTransfor
+0000bfd0: 6d5f 4465 6d6f 312e 6970 796e 6222 3e4c  m_Demo1.ipynb">L
+0000bfe0: 6574 2075 7320 7365 6520 616e 2065 7861  et us see an exa
+0000bff0: 6d70 6c65 3c2f 613e 3a3c 703e 0a20 2020  mple</a>:<p>.   
+0000c000: 2020 2020 200a 2020 2020 2020 2020 3c61       .        <a
+0000c010: 2068 7265 663d 2268 7474 7073 3a2f 2f69   href="https://i
+0000c020: 6262 2e63 6f2f 7866 4d51 6e4e 7a22 3e3c  bb.co/xfMQnNz"><
+0000c030: 696d 6720 7372 633d 2268 7474 7073 3a2f  img src="https:/
+0000c040: 2f69 2e69 6262 2e63 6f2f 5a59 6843 5130  /i.ibb.co/ZYhCQ0
+0000c050: 632f 6c61 7a79 2d63 6f64 6531 2e70 6e67  c/lazy-code1.png
+0000c060: 2220 616c 743d 226c 617a 792d 636f 6465  " alt="lazy-code
+0000c070: 3122 2062 6f72 6465 723d 2230 223e 3c2f  1" border="0"></
+0000c080: 613e 0a20 2020 2020 2020 200a 2020 2020  a>.        .    
+0000c090: 2020 2020 2323 2320 322e 2020 5573 696e      ### 2.  Usin
+0000c0a0: 6720 6c61 7a79 7472 616e 7366 6f72 6d20  g lazytransform 
+0000c0b0: 6173 2061 2073 6b6c 6561 726e 2070 6970  as a sklearn pip
+0000c0c0: 656c 696e 6520 7769 7468 2073 6b6c 6561  eline with sklea
+0000c0d0: 726e 206d 6f64 656c 7320 6f72 2058 4742  rn models or XGB
+0000c0e0: 6f6f 7374 206f 7220 4c69 6768 7447 424d  oost or LightGBM
+0000c0f0: 206d 6f64 656c 730a 2020 2020 2020 2020   models.        
+0000c100: 0a20 2020 2020 2020 203c 703e 5468 6520  .        <p>The 
+0000c110: 7365 636f 6e64 206d 6574 686f 6420 6973  second method is
+0000c120: 2061 2067 7265 6174 2077 6179 2074 6f20   a great way to 
+0000c130: 6372 6561 7465 2061 6e20 656e 7469 7265  create an entire
+0000c140: 2064 6174 6120 7472 616e 7366 6f72 6d20   data transform 
+0000c150: 616e 6420 6d6f 6465 6c20 7472 6169 6e69  and model traini
+0000c160: 6e67 2070 6970 656c 696e 6520 7769 7468  ng pipeline with
+0000c170: 2061 6273 6f6c 7574 656c 7920 6e6f 2064   absolutely no d
+0000c180: 6174 6120 6c65 616b 6167 652e 2060 6c61  ata leakage. `la
+0000c190: 7a79 7472 616e 7366 6f72 6d60 2061 6c6c  zytransform` all
+0000c1a0: 6f77 7320 796f 7520 746f 2073 656e 6420  ows you to send 
+0000c1b0: 696e 2061 206d 6f64 656c 206f 626a 6563  in a model objec
+0000c1c0: 7420 286f 6e6c 7920 7468 6520 666f 6c6c  t (only the foll
+0000c1d0: 6f77 696e 6720 6172 6520 7375 7070 6f72  owing are suppor
+0000c1e0: 7465 6429 2061 6e64 2069 7420 7769 6c6c  ted) and it will
+0000c1f0: 2061 7574 6f6d 6174 6963 616c 6c79 2074   automatically t
+0000c200: 7261 6e73 666f 726d 2c20 6372 6561 7465  ransform, create
+0000c210: 206e 6577 2066 6561 7475 7265 7320 616e   new features an
+0000c220: 6420 7472 6169 6e20 6120 6d6f 6465 6c20  d train a model 
+0000c230: 7573 696e 6720 736b 6c65 6172 6e20 7069  using sklearn pi
+0000c240: 7065 6c69 6e65 732e 203c 6120 6872 6566  pelines. <a href
+0000c250: 3d22 6874 7470 733a 2f2f 6769 7468 7562  ="https://github
+0000c260: 2e63 6f6d 2f41 7574 6f56 694d 4c2f 6c61  .com/AutoViML/la
+0000c270: 7a79 7472 616e 7366 6f72 6d2f 626c 6f62  zytransform/blob
+0000c280: 2f6d 6169 6e2f 4665 6174 7572 6577 697a  /main/Featurewiz
+0000c290: 5f4c 617a 7954 7261 6e73 666f 726d 5f44  _LazyTransform_D
+0000c2a0: 656d 6f32 2e69 7079 6e62 223e 5468 6973  emo2.ipynb">This
+0000c2b0: 206d 6574 686f 6420 6361 6e20 6265 2073   method can be s
+0000c2c0: 6565 6e20 6173 2066 6f6c 6c6f 7773 3c2f  een as follows</
+0000c2d0: 613e 3a3c 6272 3e0a 2020 2020 2020 2020  a>:<br>.        
+0000c2e0: 0a20 2020 2020 2020 203c 6120 6872 6566  .        <a href
+0000c2f0: 3d22 6874 7470 733a 2f2f 6962 622e 636f  ="https://ibb.co
+0000c300: 2f54 3157 4e68 7a54 223e 3c69 6d67 2073  /T1WNhzT"><img s
+0000c310: 7263 3d22 6874 7470 733a 2f2f 692e 6962  rc="https://i.ib
+0000c320: 622e 636f 2f30 4b73 7a4a 5058 2f6c 617a  b.co/0KszJPX/laz
+0000c330: 792d 636f 6465 322e 706e 6722 2061 6c74  y-code2.png" alt
+0000c340: 3d22 6c61 7a79 2d63 6f64 6532 2220 626f  ="lazy-code2" bo
+0000c350: 7264 6572 3d22 3022 3e3c 2f61 3e0a 2020  rder="0"></a>.  
+0000c360: 2020 2020 2020 0a20 2020 2020 2020 2023        .        #
+0000c370: 2323 2033 2e20 2055 7369 6e67 206c 617a  ## 3.  Using laz
+0000c380: 7974 7261 6e73 666f 726d 2069 6e20 4772  ytransform in Gr
+0000c390: 6964 5365 6172 6368 4356 2074 6f20 6669  idSearchCV to fi
+0000c3a0: 6e64 2074 6865 2062 6573 7420 6d6f 6465  nd the best mode
+0000c3b0: 6c20 7069 7065 6c69 6e65 0a20 2020 2020  l pipeline.     
+0000c3c0: 2020 203c 703e 5468 6520 7468 6972 6420     <p>The third 
+0000c3d0: 6d65 7468 6f64 2069 7320 6120 6772 6561  method is a grea
+0000c3e0: 7420 7761 7920 746f 2066 696e 6420 7468  t way to find th
+0000c3f0: 6520 6265 7374 2064 6174 6120 7472 616e  e best data tran
+0000c400: 7366 6f72 6d61 7469 6f6e 2061 6e64 206d  sformation and m
+0000c410: 6f64 656c 2074 7261 696e 696e 6720 7069  odel training pi
+0000c420: 7065 6c69 6e65 2075 7369 6e67 2047 7269  peline using Gri
+0000c430: 6453 6561 7263 6843 5620 6f72 2052 616e  dSearchCV or Ran
+0000c440: 646f 6d69 7a65 6453 6561 7263 6843 5620  domizedSearchCV 
+0000c450: 616c 6f6e 6720 7769 7468 2061 204c 6967  along with a Lig
+0000c460: 6874 4742 4d20 6f72 2058 4742 6f6f 7374  htGBM or XGBoost
+0000c470: 206f 7220 7363 696b 6974 2d6c 6561 726e   or scikit-learn
+0000c480: 206d 6f64 656c 2e20 5468 6973 2069 7320   model. This is 
+0000c490: 6578 706c 6169 6e65 6420 7665 7279 2063  explained very c
+0000c4a0: 6c65 6172 6c79 2069 6e20 7468 6520 3c61  learly in the <a
+0000c4b0: 2068 7265 663d 2268 7474 7073 3a2f 2f67   href="https://g
+0000c4c0: 6974 6875 622e 636f 6d2f 4175 746f 5669  ithub.com/AutoVi
+0000c4d0: 4d4c 2f6c 617a 7974 7261 6e73 666f 726d  ML/lazytransform
+0000c4e0: 2f62 6c6f 622f 6d61 696e 2f4c 617a 7954  /blob/main/LazyT
+0000c4f0: 7261 6e73 666f 726d 6572 5f77 6974 685f  ransformer_with_
+0000c500: 4772 6964 5365 6172 6368 5f50 6970 656c  GridSearch_Pipel
+0000c510: 696e 652e 6970 796e 6222 3e4c 617a 7954  ine.ipynb">LazyT
+0000c520: 7261 6e73 666f 726d 6572 5f77 6974 685f  ransformer_with_
+0000c530: 4772 6964 5365 6172 6368 5f50 6970 656c  GridSearch_Pipel
+0000c540: 696e 652e 6970 796e 623c 2f61 3e20 6e6f  ine.ipynb</a> no
+0000c550: 7465 626f 6f6b 2069 6e20 7468 6520 7361  tebook in the sa
+0000c560: 6d65 2067 6974 6875 6220 6865 7265 2e20  me github here. 
+0000c570: 4d61 6b65 2073 7572 6520 796f 7520 6368  Make sure you ch
+0000c580: 6563 6b20 6974 206f 7574 210a 2020 2020  eck it out!.    
+0000c590: 2020 2020 0a20 2020 2020 2020 203c 6120      .        <a 
+0000c5a0: 6872 6566 3d22 6874 7470 733a 2f2f 6962  href="https://ib
+0000c5b0: 622e 636f 2f57 4776 6e71 6a73 223e 3c69  b.co/WGvnqjs"><i
+0000c5c0: 6d67 2073 7263 3d22 6874 7470 733a 2f2f  mg src="https://
+0000c5d0: 692e 6962 622e 636f 2f78 5871 6850 6433  i.ibb.co/xXqhPd3
+0000c5e0: 2f6c 617a 792d 6772 6964 7365 6172 6368  /lazy-gridsearch
+0000c5f0: 2e70 6e67 2220 616c 743d 226c 617a 792d  .png" alt="lazy-
+0000c600: 6772 6964 7365 6172 6368 2220 626f 7264  gridsearch" bord
+0000c610: 6572 3d22 3022 3e3c 2f61 3e3c 6272 202f  er="0"></a><br /
+0000c620: 3e0a 2020 2020 2020 2020 0a20 2020 2020  >.        .     
+0000c630: 2020 203c 703e 0a20 2020 2020 2020 2054     <p>.        T
+0000c640: 6865 2066 6f6c 6c6f 7769 6e67 206d 6f64  he following mod
+0000c650: 656c 7320 6172 6520 6375 7272 656e 746c  els are currentl
+0000c660: 7920 7375 7070 6f72 7465 643a 0a20 2020  y supported:.   
+0000c670: 2020 2020 203c 6f6c 3e0a 2020 2020 2020       <ol>.      
+0000c680: 2020 3c6c 693e 416c 6c20 736b 6c65 6172    <li>All sklear
+0000c690: 6e20 6d6f 6465 6c73 3c2f 6c69 3e0a 2020  n models</li>.  
+0000c6a0: 2020 2020 2020 3c6c 693e 416c 6c20 4d75        <li>All Mu
+0000c6b0: 6c74 694f 7574 7075 7420 6d6f 6465 6c73  ltiOutput models
+0000c6c0: 2066 726f 6d20 736b 6c65 6172 6e2e 6d75   from sklearn.mu
+0000c6d0: 6c74 696f 7574 7075 7420 6c69 6272 6172  ltioutput librar
+0000c6e0: 793c 2f6c 693e 0a20 2020 2020 2020 203c  y</li>.        <
+0000c6f0: 6c69 3e58 4762 6f6f 7374 206d 6f64 656c  li>XGboost model
+0000c700: 733c 2f6c 693e 0a20 2020 2020 2020 203c  s</li>.        <
+0000c710: 6c69 3e4c 6967 6874 4742 4d20 6d6f 6465  li>LightGBM mode
+0000c720: 6c73 3c2f 6c69 3e0a 2020 2020 2020 2020  ls</li>.        
+0000c730: 3c2f 6f6c 3e0a 2020 2020 2020 2020 486f  </ol>.        Ho
+0000c740: 7765 7665 722c 2079 6f75 206d 7573 7420  wever, you must 
+0000c750: 696e 7374 616c 6c20 616e 6420 696d 706f  install and impo
+0000c760: 7274 2074 686f 7365 206d 6f64 656c 7320  rt those models 
+0000c770: 6f6e 2079 6f75 7220 6f77 6e20 616e 6420  on your own and 
+0000c780: 6465 6669 6e65 2074 6865 6d20 6173 206d  define them as m
+0000c790: 6f64 656c 2076 6172 6961 626c 6573 2062  odel variables b
+0000c7a0: 6566 6f72 6520 7061 7373 696e 6720 7468  efore passing th
+0000c7b0: 6f73 6520 7661 7269 6162 6c65 7320 746f  ose variables to
+0000c7c0: 206c 617a 7974 7261 6e73 666f 726d 2e0a   lazytransform..
+0000c7d0: 2020 2020 2020 2020 0a20 2020 2020 2020          .       
+0000c7e0: 2023 2320 496e 7374 616c 6c0a 2020 2020   ## Install.    
+0000c7f0: 2020 2020 3c70 3e0a 2020 2020 2020 2020      <p>.        
+0000c800: 0a20 2020 2020 2020 202a 2a50 7265 7265  .        **Prere
+0000c810: 7175 7369 7465 733a 2a2a 0a20 2020 2020  qusites:**.     
+0000c820: 2020 203c 6f6c 3e0a 2020 2020 2020 2020     <ol>.        
+0000c830: 3c6c 693e 3c62 3e6c 617a 7974 7261 6e73  <li><b>lazytrans
+0000c840: 666f 726d 2069 7320 6275 696c 7420 7573  form is built us
+0000c850: 696e 6720 7061 6e64 6173 2c20 6e75 6d70  ing pandas, nump
+0000c860: 792c 2073 6369 6b69 742d 6c65 6172 6e2c  y, scikit-learn,
+0000c870: 2063 6174 6567 6f72 795f 656e 636f 6465   category_encode
+0000c880: 7273 2061 6e64 2069 6d62 616c 616e 6365  rs and imbalance
+0000c890: 642d 6c65 6172 6e20 6c69 6272 6172 6965  d-learn librarie
+0000c8a0: 732e 3c2f 623e 2049 7420 7368 6f75 6c64  s.</b> It should
+0000c8b0: 2072 756e 206f 6e20 6d6f 7374 2050 7974   run on most Pyt
+0000c8c0: 686f 6e33 2041 6e61 636f 6e64 6120 696e  hon3 Anaconda in
+0000c8d0: 7374 616c 6c61 7469 6f6e 7320 7769 7468  stallations with
+0000c8e0: 6f75 7420 6164 6469 7469 6f6e 616c 2069  out additional i
+0000c8f0: 6e73 7461 6c6c 732e 2059 6f75 2077 6f6e  nstalls. You won
+0000c900: 2774 2068 6176 6520 746f 2069 6d70 6f72  't have to impor
+0000c910: 7420 616e 7920 7370 6563 6961 6c20 6c69  t any special li
+0000c920: 6272 6172 6965 7320 6f74 6865 7220 7468  braries other th
+0000c930: 616e 2022 696d 6261 6c61 6e63 6564 2d6c  an "imbalanced-l
+0000c940: 6561 726e 2220 616e 6420 2263 6174 6567  earn" and "categ
+0000c950: 6f72 795f 656e 636f 6465 7273 222e 3c2f  ory_encoders".</
+0000c960: 6c69 3e0a 2020 2020 2020 2020 3c2f 6f6c  li>.        </ol
+0000c970: 3e0a 2020 2020 2020 2020 5468 6520 6265  >.        The be
+0000c980: 7374 206d 6574 686f 6420 746f 2069 6e73  st method to ins
+0000c990: 7461 6c6c 206c 617a 7974 7261 6e73 666f  tall lazytransfo
+0000c9a0: 726d 2069 7320 746f 2075 7365 2063 6f6e  rm is to use con
+0000c9b0: 6461 3a3c 703e 0a20 2020 2020 2020 200a  da:<p>.        .
+0000c9c0: 2020 2020 2020 2020 6060 600a 2020 2020          ```.    
+0000c9d0: 2020 2020 636f 6e64 6120 696e 7374 616c      conda instal
+0000c9e0: 6c20 2d63 2063 6f6e 6461 2d66 6f72 6765  l -c conda-forge
+0000c9f0: 206c 617a 7974 7261 6e73 666f 726d 0a20   lazytransform. 
+0000ca00: 2020 2020 2020 2060 6060 0a20 2020 2020         ```.     
+0000ca10: 2020 203c 6120 6872 6566 3d22 6874 7470     <a href="http
+0000ca20: 733a 2f2f 6962 622e 636f 2f66 586e 6250  s://ibb.co/fXnbP
+0000ca30: 6436 223e 3c69 6d67 2073 7263 3d22 6874  d6"><img src="ht
+0000ca40: 7470 733a 2f2f 692e 6962 622e 636f 2f71  tps://i.ibb.co/q
+0000ca50: 4457 7a50 5971 2f63 6f6e 6461 2d69 6e73  DWzPYq/conda-ins
+0000ca60: 7461 6c6c 2e70 6e67 2220 616c 743d 2263  tall.png" alt="c
+0000ca70: 6f6e 6461 2d69 6e73 7461 6c6c 2220 626f  onda-install" bo
+0000ca80: 7264 6572 3d22 3022 3e3c 2f61 3e3c 6272  rder="0"></a><br
+0000ca90: 3e0a 2020 2020 2020 2020 5468 6520 7365  >.        The se
+0000caa0: 636f 6e64 2062 6573 7420 696e 7374 616c  cond best instal
+0000cab0: 6c61 7469 6f6e 206d 6574 686f 6420 6973  lation method is
+0000cac0: 2074 6f20 7573 6520 2270 6970 2069 6e73   to use "pip ins
+0000cad0: 7461 6c6c 222e 0a20 2020 2020 2020 200a  tall"..        .
+0000cae0: 2020 2020 2020 2020 6060 600a 2020 2020          ```.    
+0000caf0: 2020 2020 7069 7020 696e 7374 616c 6c20      pip install 
+0000cb00: 6c61 7a79 7472 616e 7366 6f72 6d20 0a20  lazytransform . 
+0000cb10: 2020 2020 2020 2060 6060 0a20 2020 2020         ```.     
+0000cb20: 2020 2041 6c65 7274 2120 5768 656e 2075     Alert! When u
+0000cb30: 7369 6e67 2043 6f6c 6162 206f 7220 4b61  sing Colab or Ka
+0000cb40: 6767 6c65 204e 6f74 6562 6f6f 6b73 2c20  ggle Notebooks, 
+0000cb50: 796f 7520 6d75 7374 2075 7365 2061 2073  you must use a s
+0000cb60: 6c69 6768 746c 7920 6d6f 6469 6679 2069  lightly modify i
+0000cb70: 6e73 7461 6c6c 6174 696f 6e20 7072 6f63  nstallation proc
+0000cb80: 6573 7320 6265 6c6f 772e 2049 6620 796f  ess below. If yo
+0000cb90: 7520 646f 6e27 7420 646f 2074 6869 732c  u don't do this,
+0000cba0: 2079 6f75 2077 696c 6c20 6765 7420 7765   you will get we
+0000cbb0: 6972 6420 6572 726f 7273 2069 6e20 7468  ird errors in th
+0000cbc0: 6f73 6520 706c 6174 666f 726d 7321 0a20  ose platforms!. 
+0000cbd0: 2020 2020 2020 200a 2020 2020 2020 2020         .        
+0000cbe0: 6060 600a 2020 2020 2020 2020 7069 7020  ```.        pip 
+0000cbf0: 696e 7374 616c 6c20 6c61 7a79 7472 616e  install lazytran
+0000cc00: 7366 6f72 6d20 2d2d 6967 6e6f 7265 2d69  sform --ignore-i
+0000cc10: 6e73 7461 6c6c 6564 202d 2d6e 6f2d 6465  nstalled --no-de
+0000cc20: 7073 0a20 2020 2020 2020 2070 6970 2069  ps.        pip i
+0000cc30: 6e73 7461 6c6c 2063 6174 6567 6f72 792d  nstall category-
+0000cc40: 656e 636f 6465 7273 202d 2d69 676e 6f72  encoders --ignor
+0000cc50: 652d 696e 7374 616c 6c65 6420 2d2d 6e6f  e-installed --no
+0000cc60: 2d64 6570 730a 2020 2020 2020 2020 0a20  -deps.        . 
+0000cc70: 2020 2020 2020 2060 6060 0a20 2020 2020         ```.     
+0000cc80: 2020 200a 2020 2020 2020 2020 546f 2069     .        To i
+0000cc90: 6e73 7461 6c6c 2066 726f 6d20 736f 7572  nstall from sour
+0000cca0: 6365 3a0a 2020 2020 2020 2020 0a20 2020  ce:.        .   
+0000ccb0: 2020 2020 2060 6060 0a20 2020 2020 2020       ```.       
+0000ccc0: 2063 6420 3c6c 617a 7974 7261 6e73 666f   cd <lazytransfo
+0000ccd0: 726d 5f44 6573 7469 6e61 7469 6f6e 3e0a  rm_Destination>.
+0000cce0: 2020 2020 2020 2020 6769 7420 636c 6f6e          git clon
+0000ccf0: 6520 6769 7440 6769 7468 7562 2e63 6f6d  e git@github.com
+0000cd00: 3a41 7574 6f56 694d 4c2f 6c61 7a79 7472  :AutoViML/lazytr
+0000cd10: 616e 7366 6f72 6d2e 6769 740a 2020 2020  ansform.git.    
+0000cd20: 2020 2020 6060 600a 2020 2020 2020 2020      ```.        
+0000cd30: 6f72 2064 6f77 6e6c 6f61 6420 616e 6420  or download and 
+0000cd40: 756e 7a69 7020 6874 7470 733a 2f2f 6769  unzip https://gi
+0000cd50: 7468 7562 2e63 6f6d 2f41 7574 6f56 694d  thub.com/AutoViM
+0000cd60: 4c2f 6c61 7a79 7472 616e 7366 6f72 6d2f  L/lazytransform/
+0000cd70: 6172 6368 6976 652f 6d61 7374 6572 2e7a  archive/master.z
+0000cd80: 6970 0a20 2020 2020 2020 2060 6060 0a20  ip.        ```. 
+0000cd90: 2020 2020 2020 2063 6f6e 6461 2063 7265         conda cre
+0000cda0: 6174 6520 2d6e 203c 796f 7572 5f65 6e76  ate -n <your_env
+0000cdb0: 5f6e 616d 653e 2070 7974 686f 6e3d 332e  _name> python=3.
+0000cdc0: 3720 616e 6163 6f6e 6461 0a20 2020 2020  7 anaconda.     
+0000cdd0: 2020 2063 6f6e 6461 2061 6374 6976 6174     conda activat
+0000cde0: 6520 3c79 6f75 725f 656e 765f 6e61 6d65  e <your_env_name
+0000cdf0: 3e20 2320 4f4e 2057 494e 444f 5753 3a20  > # ON WINDOWS: 
+0000ce00: 6073 6f75 7263 6520 6163 7469 7661 7465  `source activate
+0000ce10: 203c 796f 7572 5f65 6e76 5f6e 616d 653e   <your_env_name>
+0000ce20: 600a 2020 2020 2020 2020 6364 206c 617a  `.        cd laz
+0000ce30: 7974 7261 6e73 666f 726d 0a20 2020 2020  ytransform.     
+0000ce40: 2020 2070 6970 2069 6e73 7461 6c6c 202d     pip install -
+0000ce50: 7220 7265 7175 6972 656d 656e 7473 2e74  r requirements.t
+0000ce60: 7874 0a20 2020 2020 2020 2060 6060 0a20  xt.        ```. 
+0000ce70: 2020 2020 2020 200a 2020 2020 2020 2020         .        
+0000ce80: 2323 2055 7361 6765 0a20 2020 2020 2020  ## Usage.       
+0000ce90: 203c 703e 0a20 2020 2020 2020 2059 6f75   <p>.        You
+0000cea0: 2063 616e 2069 6e76 6f6b 6520 606c 617a   can invoke `laz
+0000ceb0: 7974 7261 6e73 666f 726d 6020 6173 2061  ytransform` as a
+0000cec0: 2073 6369 6b69 742d 6c65 6172 6e20 636f   scikit-learn co
+0000ced0: 6d70 6174 6962 6c65 2066 6974 2061 6e64  mpatible fit and
+0000cee0: 2074 7261 6e73 666f 726d 206f 7220 6120   transform or a 
+0000cef0: 6669 7420 616e 6420 7072 6564 6963 7420  fit and predict 
+0000cf00: 7069 7065 6c69 6e65 2e20 5365 6520 7379  pipeline. See sy
+0000cf10: 6e74 6178 2062 656c 6f77 2e3c 703e 0a20  ntax below.<p>. 
+0000cf20: 2020 2020 2020 200a 2020 2020 2020 2020         .        
+0000cf30: 6060 600a 2020 2020 2020 2020 6672 6f6d  ```.        from
+0000cf40: 206c 617a 7974 7261 6e73 666f 726d 2069   lazytransform i
+0000cf50: 6d70 6f72 7420 4c61 7a79 5472 616e 7366  mport LazyTransf
+0000cf60: 6f72 6d65 720a 2020 2020 2020 2020 6c61  ormer.        la
+0000cf70: 7a79 203d 204c 617a 7954 7261 6e73 666f  zy = LazyTransfo
+0000cf80: 726d 6572 286d 6f64 656c 3d4e 6f6e 652c  rmer(model=None,
+0000cf90: 2065 6e63 6f64 6572 733d 2761 7574 6f27   encoders='auto'
+0000cfa0: 2c20 7363 616c 6572 733d 4e6f 6e65 2c20  , scalers=None, 
+0000cfb0: 0a20 2020 2020 2020 2020 2020 2020 2020  .               
+0000cfc0: 2064 6174 655f 746f 5f73 7472 696e 673d   date_to_string=
+0000cfd0: 4661 6c73 652c 2074 7261 6e73 666f 726d  False, transform
+0000cfe0: 5f74 6172 6765 743d 4661 6c73 652c 2069  _target=False, i
+0000cff0: 6d62 616c 616e 6365 643d 4661 6c73 652c  mbalanced=False,
+0000d000: 0a20 2020 2020 2020 2020 2020 2020 2020  .               
+0000d010: 2063 6f6d 6269 6e65 5f72 6172 653d 4661   combine_rare=Fa
+0000d020: 6c73 652c 2076 6572 626f 7365 3d30 290a  lse, verbose=0).
+0000d030: 2020 2020 2020 2020 6060 600a 2020 2020          ```.    
+0000d040: 2020 2020 0a20 2020 2020 2020 2023 2323      .        ###
+0000d050: 2069 6620 796f 7520 6172 6520 6e6f 7420   if you are not 
+0000d060: 7573 696e 6720 6120 6d6f 6465 6c20 696e  using a model in
+0000d070: 2070 6970 656c 696e 652c 2079 6f75 206d   pipeline, you m
+0000d080: 7573 7420 7573 6520 6669 7420 616e 6420  ust use fit and 
+0000d090: 7472 616e 7366 6f72 6d0a 2020 2020 2020  transform.      
+0000d0a0: 2020 6060 600a 2020 2020 2020 2020 585f    ```.        X_
+0000d0b0: 7472 6169 6e6d 2c20 795f 7472 6169 6e6d  trainm, y_trainm
+0000d0c0: 203d 206c 617a 792e 6669 745f 7472 616e   = lazy.fit_tran
+0000d0d0: 7366 6f72 6d28 585f 7472 6169 6e2c 2079  sform(X_train, y
+0000d0e0: 5f74 7261 696e 290a 2020 2020 2020 2020  _train).        
+0000d0f0: 585f 7465 7374 6d20 3d20 6c61 7a79 2e74  X_testm = lazy.t
+0000d100: 7261 6e73 666f 726d 2858 5f74 6573 7429  ransform(X_test)
+0000d110: 0a20 2020 2020 2020 2060 6060 0a20 2020  .        ```.   
+0000d120: 2020 2020 2023 2323 2049 6620 796f 7520       ### If you 
+0000d130: 6172 6520 7573 696e 6720 6120 6d6f 6465  are using a mode
+0000d140: 6c20 696e 2070 6970 656c 696e 652c 2075  l in pipeline, u
+0000d150: 7365 206d 7573 7420 7573 6520 6669 7420  se must use fit 
+0000d160: 616e 6420 7072 6564 6963 7420 6f6e 6c79  and predict only
+0000d170: 0a20 2020 2020 2020 2060 6060 0a20 2020  .        ```.   
+0000d180: 2020 2020 206c 617a 7920 3d20 4c61 7a79       lazy = Lazy
+0000d190: 5472 616e 7366 6f72 6d65 7228 6d6f 6465  Transformer(mode
+0000d1a0: 6c3d 5261 6e64 6f6d 466f 7265 7374 436c  l=RandomForestCl
+0000d1b0: 6173 7369 6669 6572 2829 2c20 656e 636f  assifier(), enco
+0000d1c0: 6465 7273 3d27 6175 746f 272c 2073 6361  ders='auto', sca
+0000d1d0: 6c65 7273 3d4e 6f6e 652c 200a 2020 2020  lers=None, .    
+0000d1e0: 2020 2020 2020 2020 2020 2020 6461 7465              date
+0000d1f0: 5f74 6f5f 7374 7269 6e67 3d46 616c 7365  _to_string=False
+0000d200: 2c20 7472 616e 7366 6f72 6d5f 7461 7267  , transform_targ
+0000d210: 6574 3d46 616c 7365 2c20 696d 6261 6c61  et=False, imbala
+0000d220: 6e63 6564 3d46 616c 7365 2c0a 2020 2020  nced=False,.    
+0000d230: 2020 2020 2020 2020 2020 2020 636f 6d62              comb
+0000d240: 696e 655f 7261 7265 3d46 616c 7365 2c20  ine_rare=False, 
+0000d250: 7665 7262 6f73 653d 3029 0a20 2020 2020  verbose=0).     
+0000d260: 2020 2060 6060 0a20 2020 2020 2020 200a     ```.        .
+0000d270: 2020 2020 2020 2020 6060 600a 2020 2020          ```.    
+0000d280: 2020 2020 6c61 7a79 2e66 6974 2858 5f74      lazy.fit(X_t
+0000d290: 7261 696e 2c20 795f 7472 6169 6e29 0a20  rain, y_train). 
+0000d2a0: 2020 2020 2020 206c 617a 792e 7072 6564         lazy.pred
+0000d2b0: 6963 7428 585f 7465 7374 290a 2020 2020  ict(X_test).    
+0000d2c0: 2020 2020 6060 600a 2020 2020 2020 2020      ```.        
+0000d2d0: 0a20 2020 2020 2020 2023 2320 4150 490a  .        ## API.
+0000d2e0: 2020 2020 2020 2020 0a20 2020 2020 2020          .       
+0000d2f0: 203c 703e 0a20 2020 2020 2020 206c 617a   <p>.        laz
+0000d300: 7974 7261 6e73 666f 726d 2068 6173 2061  ytransform has a
+0000d310: 2076 6572 7920 7369 6d70 6c65 2041 5049   very simple API
+0000d320: 2077 6974 6820 7468 6520 666f 6c6c 6f77   with the follow
+0000d330: 696e 6720 696e 7075 7473 2e20 596f 7520  ing inputs. You 
+0000d340: 6e65 6564 2074 6f20 6372 6561 7465 2061  need to create a
+0000d350: 2073 6b6c 6561 726e 2d63 6f6d 7061 7469   sklearn-compati
+0000d360: 626c 6520 7472 616e 7366 6f72 6d65 7220  ble transformer 
+0000d370: 7069 7065 6c69 6e65 206f 626a 6563 7420  pipeline object 
+0000d380: 6279 2069 6d70 6f72 7469 6e67 204c 617a  by importing Laz
+0000d390: 7954 7261 6e73 666f 726d 6572 2066 726f  yTransformer fro
+0000d3a0: 6d20 6c61 7a79 7472 616e 7366 6f72 6d20  m lazytransform 
+0000d3b0: 6c69 6272 6172 792e 203c 703e 0a20 2020  library. <p>.   
+0000d3c0: 2020 2020 204f 6e63 6520 796f 7520 696d       Once you im
+0000d3d0: 706f 7274 2069 742c 2079 6f75 2063 616e  port it, you can
+0000d3e0: 2064 6566 696e 6520 7468 6520 6f62 6a65   define the obje
+0000d3f0: 6374 2062 7920 6769 7669 6e67 2073 6576  ct by giving sev
+0000d400: 6572 616c 206f 7074 696f 6e73 2073 7563  eral options suc
+0000d410: 6820 6173 3a0a 2020 2020 2020 2020 0a20  h as:.        . 
+0000d420: 2020 2020 2020 202a 2a41 7267 756d 656e         **Argumen
+0000d430: 7473 2a2a 0a20 2020 2020 2020 200a 2020  ts**.        .  
+0000d440: 2020 2020 2020 3c62 3e43 6175 7469 6f6e        <b>Caution
+0000d450: 3a3c 2f62 3e20 585f 7472 6169 6e20 616e  :</b> X_train an
+0000d460: 6420 795f 7472 6169 6e20 6d75 7374 2062  d y_train must b
+0000d470: 6520 7061 6e64 6173 2044 6174 6166 7261  e pandas Datafra
+0000d480: 6d65 7320 6f72 2070 616e 6461 7320 5365  mes or pandas Se
+0000d490: 7269 6573 2e20 444f 204e 4f54 2073 656e  ries. DO NOT sen
+0000d4a0: 6420 696e 206e 756d 7079 2061 7272 6179  d in numpy array
+0000d4b0: 732e 2054 6865 7920 776f 6e27 7420 776f  s. They won't wo
+0000d4c0: 726b 2e0a 2020 2020 2020 2020 0a20 2020  rk..        .   
+0000d4d0: 2020 2020 202d 2060 6d6f 6465 6c60 3a20       - `model`: 
+0000d4e0: 6465 6661 756c 7420 6973 204e 6f6e 652e  default is None.
+0000d4f0: 204f 7220 6974 2063 6f75 6c64 2062 6520   Or it could be 
+0000d500: 616e 7920 7363 696b 6974 2d6c 6561 726e  any scikit-learn
+0000d510: 206d 6f64 656c 2028 696e 636c 7564 696e   model (includin
+0000d520: 6720 6d75 6c74 696f 7574 7075 7420 6d6f  g multioutput mo
+0000d530: 6465 6c73 2920 6173 2077 656c 6c20 6173  dels) as well as
+0000d540: 2074 6865 2070 6f70 756c 6172 2058 4742   the popular XGB
+0000d550: 6f6f 7374 2061 6e64 204c 6967 6874 4742  oost and LightGB
+0000d560: 4d20 6c69 6272 6172 6965 732e 2059 6f75  M libraries. You
+0000d570: 206e 6565 6420 746f 2069 6e73 7461 6c6c   need to install
+0000d580: 2074 686f 7365 206c 6962 7261 7269 6573   those libraries
+0000d590: 2069 6620 796f 7520 7761 6e74 2074 6f20   if you want to 
+0000d5a0: 7573 6520 7468 656d 2e0a 2020 2020 2020  use them..      
+0000d5b0: 2020 2d20 6065 6e63 6f64 6572 7360 3a20    - `encoders`: 
+0000d5c0: 636f 756c 6420 6265 206f 6e65 206d 6f72  could be one mor
+0000d5d0: 6520 656e 636f 6465 7273 2069 6e20 6120  e encoders in a 
+0000d5e0: 7374 7269 6e67 206f 7220 6120 6c69 7374  string or a list
+0000d5f0: 2e20 4561 6368 2065 6e63 6f64 6572 2073  . Each encoder s
+0000d600: 7472 696e 6720 6361 6e20 6265 2061 6e79  tring can be any
+0000d610: 206f 6e65 206f 6620 7468 6520 3130 2b20   one of the 10+ 
+0000d620: 656e 636f 6465 7273 2066 726f 6d20 6063  encoders from `c
+0000d630: 6174 6567 6f72 795f 656e 636f 6465 7273  ategory_encoders
+0000d640: 6020 6c69 6272 6172 7920 6265 6c6f 772e  ` library below.
+0000d650: 2020 4176 6169 6c61 626c 6520 656e 636f    Available enco
+0000d660: 6465 7273 2061 7265 206c 6973 7465 6420  ders are listed 
+0000d670: 6865 7265 2061 7320 7374 7269 6e67 7320  here as strings 
+0000d680: 736f 2074 6861 7420 796f 7520 6361 6e20  so that you can 
+0000d690: 696e 7075 7420 7468 656d 2069 6e20 6c61  input them in la
+0000d6a0: 7a79 7472 616e 7366 6f72 6d3a 0a20 2020  zytransform:.   
+0000d6b0: 2020 2020 2020 202d 2060 6175 746f 6020         - `auto` 
+0000d6c0: 2d20 4974 2075 7365 7320 606f 6e65 686f  - It uses `oneho
+0000d6d0: 7460 2065 6e63 6f64 696e 6720 666f 7220  t` encoding for 
+0000d6e0: 6c6f 772d 6361 7264 696e 616c 6974 7920  low-cardinality 
+0000d6f0: 7661 7269 6162 6c65 7320 616e 6420 606c  variables and `l
+0000d700: 6162 656c 6020 656e 636f 6469 6e67 2066  abel` encoding f
+0000d710: 6f72 2068 6967 6820 6361 7264 696e 616c  or high cardinal
+0000d720: 6974 7920 7661 7269 6162 6c65 732e 0a20  ity variables.. 
+0000d730: 2020 2020 2020 2020 202d 2060 6f6e 6568           - `oneh
+0000d740: 6f74 6020 2d20 4f6e 6520 486f 7420 656e  ot` - One Hot en
+0000d750: 636f 6469 6e67 202d 2069 7420 7769 6c6c  coding - it will
+0000d760: 2062 6520 7573 6564 2066 6f72 2061 6c6c   be used for all
+0000d770: 2063 6174 6567 6f72 6963 616c 2066 6561   categorical fea
+0000d780: 7475 7265 7320 6972 7265 7370 6563 7469  tures irrespecti
+0000d790: 7665 206f 6620 6361 7264 696e 616c 6974  ve of cardinalit
+0000d7a0: 790a 2020 2020 2020 2020 2020 2d20 606c  y.          - `l
+0000d7b0: 6162 656c 6020 2d20 4c61 6265 6c20 456e  abel` - Label En
+0000d7c0: 636f 6469 6e67 202d 2069 7420 7769 6c6c  coding - it will
+0000d7d0: 2062 6520 7573 6564 2066 6f72 2061 6c6c   be used for all
+0000d7e0: 2063 6174 6567 6f72 6963 616c 2066 6561   categorical fea
+0000d7f0: 7475 7265 7320 6972 7265 7370 6563 7469  tures irrespecti
+0000d800: 7665 206f 6620 6361 7264 696e 616c 6974  ve of cardinalit
+0000d810: 790a 2020 2020 2020 2020 2020 2d20 6068  y.          - `h
+0000d820: 6173 6869 6e67 6020 6f72 2060 6861 7368  ashing` or `hash
+0000d830: 6020 2d20 4861 7368 696e 6720 286f 7220  ` - Hashing (or 
+0000d840: 4861 7368 2920 456e 636f 6469 6e67 202d  Hash) Encoding -
+0000d850: 2077 696c 6c20 6265 2075 7365 6420 666f   will be used fo
+0000d860: 7220 616c 6c20 6361 7465 676f 7269 6361  r all categorica
+0000d870: 6c20 7661 7269 6162 6c65 730a 2020 2020  l variables.    
+0000d880: 2020 2020 2020 2d20 6068 656c 6d65 7274        - `helmert
+0000d890: 6020 2d20 4865 6c6d 6572 7420 456e 636f  ` - Helmert Enco
+0000d8a0: 6469 6e67 202d 2077 696c 6c20 6265 2075  ding - will be u
+0000d8b0: 7365 6420 666f 7220 616c 6c20 6361 7465  sed for all cate
+0000d8c0: 676f 7269 6361 6c20 7661 7269 6162 6c65  gorical variable
+0000d8d0: 730a 2020 2020 2020 2020 2020 2d20 6062  s.          - `b
+0000d8e0: 6463 6020 2d20 4244 4320 456e 636f 6469  dc` - BDC Encodi
+0000d8f0: 6e67 202d 2077 696c 6c20 6265 2075 7365  ng - will be use
+0000d900: 6420 666f 7220 616c 6c20 6361 7465 676f  d for all catego
+0000d910: 7269 6361 6c20 7661 7269 6162 6c65 730a  rical variables.
+0000d920: 2020 2020 2020 2020 2020 2d20 6073 756d            - `sum
+0000d930: 6020 2d20 5375 6d20 456e 636f 6469 6e67  ` - Sum Encoding
+0000d940: 202d 2077 696c 6c20 6265 2075 7365 6420   - will be used 
+0000d950: 666f 7220 616c 6c20 6361 7465 676f 7269  for all categori
+0000d960: 6361 6c20 7661 7269 6162 6c65 730a 2020  cal variables.  
+0000d970: 2020 2020 2020 2020 2d20 606c 6f6f 6020          - `loo` 
+0000d980: 2d20 4c65 6176 6520 6f6e 6520 6f75 7420  - Leave one out 
+0000d990: 456e 636f 6469 6e67 202d 2077 696c 6c20  Encoding - will 
+0000d9a0: 6265 2075 7365 6420 666f 7220 616c 6c20  be used for all 
+0000d9b0: 6361 7465 676f 7269 6361 6c20 7661 7269  categorical vari
+0000d9c0: 6162 6c65 730a 2020 2020 2020 2020 2020  ables.          
+0000d9d0: 2d20 6062 6173 6560 202d 2042 6173 6520  - `base` - Base 
+0000d9e0: 656e 636f 6469 6e67 202d 2077 696c 6c20  encoding - will 
+0000d9f0: 6265 2075 7365 6420 666f 7220 616c 6c20  be used for all 
+0000da00: 6361 7465 676f 7269 6361 6c20 7661 7269  categorical vari
+0000da10: 6162 6c65 730a 2020 2020 2020 2020 2020  ables.          
+0000da20: 2d20 6077 6f65 6020 2d20 5765 6967 6874  - `woe` - Weight
+0000da30: 206f 6620 4576 6964 656e 6365 2045 6e63   of Evidence Enc
+0000da40: 6f64 696e 6720 2d20 7769 6c6c 2062 6520  oding - will be 
+0000da50: 7573 6564 2066 6f72 2061 6c6c 2063 6174  used for all cat
+0000da60: 6567 6f72 6963 616c 2076 6172 6961 626c  egorical variabl
+0000da70: 6573 0a20 2020 2020 2020 2020 202d 2060  es.          - `
+0000da80: 6a61 6d65 7360 202d 204a 616d 6573 2045  james` - James E
+0000da90: 6e63 6f64 696e 6720 2d20 7769 6c6c 2062  ncoding - will b
+0000daa0: 6520 7573 6564 2066 6f72 2061 6c6c 2063  e used for all c
+0000dab0: 6174 6567 6f72 6963 616c 2076 6172 6961  ategorical varia
+0000dac0: 626c 6573 0a20 2020 2020 2020 2020 202d  bles.          -
+0000dad0: 2060 7461 7267 6574 6020 2d20 5461 7267   `target` - Targ
+0000dae0: 6574 2045 6e63 6f64 696e 6720 2d20 7769  et Encoding - wi
+0000daf0: 6c6c 2062 6520 7573 6564 2066 6f72 2061  ll be used for a
+0000db00: 6c6c 2063 6174 6567 6f72 6963 616c 2076  ll categorical v
+0000db10: 6172 6961 626c 6573 0a20 2020 2020 2020  ariables.       
+0000db20: 2020 202d 2060 636f 756e 7460 202d 2043     - `count` - C
+0000db30: 6f75 6e74 2045 6e63 6f64 696e 6720 2d20  ount Encoding - 
+0000db40: 7769 6c6c 2062 6520 7573 6564 2066 6f72  will be used for
+0000db50: 2061 6c6c 2063 6174 6567 6f72 6963 616c   all categorical
+0000db60: 2076 6172 6961 626c 6573 0a20 2020 2020   variables.     
+0000db70: 2020 2020 202d 2060 676c 6d60 2c60 676c       - `glm`,`gl
+0000db80: 6d6d 6020 2d20 4765 6e65 7261 6c69 7a65  mm` - Generalize
+0000db90: 6420 4c69 6e65 6172 204d 6f64 656c 2045  d Linear Model E
+0000dba0: 6e63 6f64 696e 670a 2020 2020 2020 2020  ncoding.        
+0000dbb0: 2d20 4865 7265 2069 7320 6120 6465 7363  - Here is a desc
+0000dbc0: 7269 7074 696f 6e20 6f66 2076 6172 696f  ription of vario
+0000dbd0: 7573 2065 6e63 6f64 6572 7320 616e 6420  us encoders and 
+0000dbe0: 7468 6569 7220 7573 6573 2066 726f 6d20  their uses from 
+0000dbf0: 7468 6520 6578 6365 6c6c 656e 7420 3c61  the excellent <a
+0000dc00: 2068 7265 663d 2268 7474 7073 3a2f 2f63   href="https://c
+0000dc10: 6f6e 7472 6962 2e73 6369 6b69 742d 6c65  ontrib.scikit-le
+0000dc20: 6172 6e2e 6f72 672f 6361 7465 676f 7279  arn.org/category
+0000dc30: 5f65 6e63 6f64 6572 732f 223e 2063 6174  _encoders/"> cat
+0000dc40: 6567 6f72 795f 656e 636f 6465 7273 3c2f  egory_encoders</
+0000dc50: 613e 2070 7974 686f 6e20 6c69 6272 6172  a> python librar
+0000dc60: 793a 3c62 723e 0a20 2020 2020 2020 2020  y:<br>.         
+0000dc70: 2020 202d 2060 4861 7368 696e 6745 6e63     - `HashingEnc
+0000dc80: 6f64 6572 603a 2048 6173 6869 6e67 456e  oder`: HashingEn
+0000dc90: 636f 6465 7220 6973 2061 206d 756c 7469  coder is a multi
+0000dca0: 7661 7269 6174 6520 6861 7368 696e 6720  variate hashing 
+0000dcb0: 696d 706c 656d 656e 7461 7469 6f6e 2077  implementation w
+0000dcc0: 6974 6820 636f 6e66 6967 7572 6162 6c65  ith configurable
+0000dcd0: 2064 696d 656e 7369 6f6e 616c 6974 792f   dimensionality/
+0000dce0: 7072 6563 6973 696f 6e2e 2054 6865 2061  precision. The a
+0000dcf0: 6476 616e 7461 6765 206f 6620 7468 6973  dvantage of this
+0000dd00: 2065 6e63 6f64 6572 2069 7320 7468 6174   encoder is that
+0000dd10: 2069 7420 646f 6573 206e 6f74 206d 6169   it does not mai
+0000dd20: 6e74 6169 6e20 6120 6469 6374 696f 6e61  ntain a dictiona
+0000dd30: 7279 206f 6620 6f62 7365 7276 6564 2063  ry of observed c
+0000dd40: 6174 6567 6f72 6965 732e 2043 6f6e 7365  ategories. Conse
+0000dd50: 7175 656e 746c 792c 2074 6865 2065 6e63  quently, the enc
+0000dd60: 6f64 6572 2064 6f65 7320 6e6f 7420 6772  oder does not gr
+0000dd70: 6f77 2069 6e20 7369 7a65 2061 6e64 2061  ow in size and a
+0000dd80: 6363 6570 7473 206e 6577 2076 616c 7565  ccepts new value
+0000dd90: 7320 6475 7269 6e67 2064 6174 6120 7363  s during data sc
+0000dda0: 6f72 696e 6720 6279 2064 6573 6967 6e2e  oring by design.
+0000ddb0: 0a20 2020 2020 2020 2020 2020 202d 2060  .            - `
+0000ddc0: 5375 6d45 6e63 6f64 6572 603a 2053 756d  SumEncoder`: Sum
+0000ddd0: 456e 636f 6465 7220 6973 2061 2053 756d  Encoder is a Sum
+0000dde0: 2063 6f6e 7472 6173 7420 636f 6469 6e67   contrast coding
+0000ddf0: 2066 6f72 2074 6865 2065 6e63 6f64 696e   for the encodin
+0000de00: 6720 6f66 2063 6174 6567 6f72 6963 616c  g of categorical
+0000de10: 2066 6561 7475 7265 732e 0a20 2020 2020   features..     
+0000de20: 2020 2020 2020 202d 2060 506f 6c79 6e6f         - `Polyno
+0000de30: 6d69 616c 456e 636f 6465 7260 3a20 506f  mialEncoder`: Po
+0000de40: 6c79 6e6f 6d69 616c 456e 636f 6465 7220  lynomialEncoder 
+0000de50: 6973 2061 2050 6f6c 796e 6f6d 6961 6c20  is a Polynomial 
+0000de60: 636f 6e74 7261 7374 2063 6f64 696e 6720  contrast coding 
+0000de70: 666f 7220 7468 6520 656e 636f 6469 6e67  for the encoding
+0000de80: 206f 6620 6361 7465 676f 7269 6361 6c20   of categorical 
+0000de90: 6665 6174 7572 6573 2e0a 2020 2020 2020  features..      
+0000dea0: 2020 2020 2020 2d20 6042 6163 6b77 6172        - `Backwar
+0000deb0: 6444 6966 6665 7265 6e63 6545 6e63 6f64  dDifferenceEncod
+0000dec0: 6572 603a 2042 6163 6b77 6172 6444 6966  er`: BackwardDif
+0000ded0: 6665 7265 6e63 6545 6e63 6f64 6572 2069  ferenceEncoder i
+0000dee0: 7320 6120 4261 636b 7761 7264 2064 6966  s a Backward dif
+0000def0: 6665 7265 6e63 6520 636f 6e74 7261 7374  ference contrast
+0000df00: 2063 6f64 696e 6720 666f 7220 656e 636f   coding for enco
+0000df10: 6469 6e67 2063 6174 6567 6f72 6963 616c  ding categorical
+0000df20: 2076 6172 6961 626c 6573 2e0a 2020 2020   variables..    
+0000df30: 2020 2020 2020 2020 2d20 604f 6e65 486f          - `OneHo
+0000df40: 7445 6e63 6f64 6572 603a 204f 6e65 486f  tEncoder`: OneHo
+0000df50: 7445 6e63 6f64 6572 2069 7320 7468 6520  tEncoder is the 
+0000df60: 7472 6164 6974 696f 6e61 6c20 4f6e 6568  traditional Oneh
+0000df70: 6f74 2028 6f72 2064 756d 6d79 2920 636f  ot (or dummy) co
+0000df80: 6469 6e67 2066 6f72 2063 6174 6567 6f72  ding for categor
+0000df90: 6963 616c 2066 6561 7475 7265 732e 2049  ical features. I
+0000dfa0: 7420 7072 6f64 7563 6573 206f 6e65 2066  t produces one f
+0000dfb0: 6561 7475 7265 2070 6572 2063 6174 6567  eature per categ
+0000dfc0: 6f72 792c 2065 6163 6820 6265 696e 6720  ory, each being 
+0000dfd0: 6120 6269 6e61 7279 2e0a 2020 2020 2020  a binary..      
+0000dfe0: 2020 2020 2020 2d20 6048 656c 6d65 7274        - `Helmert
+0000dff0: 456e 636f 6465 7260 3a20 4865 6c6d 6572  Encoder`: Helmer
+0000e000: 7445 6e63 6f64 6572 2075 7365 7320 7468  tEncoder uses th
+0000e010: 6520 4865 6c6d 6572 7420 636f 6e74 7261  e Helmert contra
+0000e020: 7374 2063 6f64 696e 6720 666f 7220 656e  st coding for en
+0000e030: 636f 6469 6e67 2063 6174 6567 6f72 6963  coding categoric
+0000e040: 616c 2066 6561 7475 7265 732e 0a20 2020  al features..   
+0000e050: 2020 2020 2020 2020 202d 2060 4f72 6469           - `Ordi
+0000e060: 6e61 6c45 6e63 6f64 6572 603a 204f 7264  nalEncoder`: Ord
+0000e070: 696e 616c 456e 636f 6465 7220 7573 6573  inalEncoder uses
+0000e080: 204f 7264 696e 616c 2065 6e63 6f64 696e   Ordinal encodin
+0000e090: 6720 746f 2064 6573 6967 6e61 7465 2061  g to designate a
+0000e0a0: 2073 696e 676c 6520 636f 6c75 6d6e 206f   single column o
+0000e0b0: 6620 696e 7465 6765 7273 2074 6f20 7265  f integers to re
+0000e0c0: 7072 6573 656e 7420 7468 6520 6361 7465  present the cate
+0000e0d0: 676f 7269 6573 2069 6e20 796f 7572 2064  gories in your d
+0000e0e0: 6174 612e 2049 6e74 6567 6572 7320 686f  ata. Integers ho
+0000e0f0: 7765 7665 7220 7374 6172 7420 696e 2074  wever start in t
+0000e100: 6865 2073 616d 6520 6f72 6465 7220 696e  he same order in
+0000e110: 2077 6869 6368 2074 6865 2063 6174 6567   which the categ
+0000e120: 6f72 6965 7320 6172 6520 666f 756e 6420  ories are found 
+0000e130: 696e 2079 6f75 7220 6461 7461 7365 742e  in your dataset.
+0000e140: 2049 6620 796f 7520 7761 6e74 2074 6f20   If you want to 
+0000e150: 6368 616e 6765 2074 6865 206f 7264 6572  change the order
+0000e160: 2c20 6a75 7374 2073 6f72 7420 7468 6520  , just sort the 
+0000e170: 636f 6c75 6d6e 2061 6e64 2073 656e 6420  column and send 
+0000e180: 6974 2069 6e20 666f 7220 656e 636f 6469  it in for encodi
+0000e190: 6e67 2e0a 2020 2020 2020 2020 2020 2020  ng..            
+0000e1a0: 2d20 6046 7265 7175 656e 6379 456e 636f  - `FrequencyEnco
+0000e1b0: 6465 7260 3a20 4672 6571 7565 6e63 7945  der`: FrequencyE
+0000e1c0: 6e63 6f64 6572 2069 7320 6120 636f 756e  ncoder is a coun
+0000e1d0: 7420 656e 636f 6469 6e67 2074 6563 686e  t encoding techn
+0000e1e0: 6971 7565 2066 6f72 2063 6174 6567 6f72  ique for categor
+0000e1f0: 6963 616c 2066 6561 7475 7265 732e 2046  ical features. F
+0000e200: 6f72 2061 2067 6976 656e 2063 6174 6567  or a given categ
+0000e210: 6f72 6963 616c 2066 6561 7475 7265 2c20  orical feature, 
+0000e220: 6974 2072 6570 6c61 6365 7320 7468 6520  it replaces the 
+0000e230: 6e61 6d65 7320 6f66 2074 6865 2063 6174  names of the cat
+0000e240: 6567 6f72 6965 7320 7769 7468 2074 6865  egories with the
+0000e250: 2067 726f 7570 2063 6f75 6e74 7320 6f66   group counts of
+0000e260: 2065 6163 6820 6361 7465 676f 7279 2e0a   each category..
+0000e270: 2020 2020 2020 2020 2020 2020 2d20 6042              - `B
+0000e280: 6173 654e 456e 636f 6465 7260 3a20 4261  aseNEncoder`: Ba
+0000e290: 7365 4e45 6e63 6f64 6572 2065 6e63 6f64  seNEncoder encod
+0000e2a0: 6573 2074 6865 2063 6174 6567 6f72 6965  es the categorie
+0000e2b0: 7320 696e 746f 2061 7272 6179 7320 6f66  s into arrays of
+0000e2c0: 2074 6865 6972 2062 6173 652d 4e20 7265   their base-N re
+0000e2d0: 7072 6573 656e 7461 7469 6f6e 2e20 4120  presentation. A 
+0000e2e0: 6261 7365 206f 6620 3120 6973 2065 7175  base of 1 is equ
+0000e2f0: 6976 616c 656e 7420 746f 206f 6e65 2d68  ivalent to one-h
+0000e300: 6f74 2065 6e63 6f64 696e 6720 286e 6f74  ot encoding (not
+0000e310: 2072 6561 6c6c 7920 6261 7365 2d31 2c20   really base-1, 
+0000e320: 6275 7420 7573 6566 756c 292c 2061 2062  but useful), a b
+0000e330: 6173 6520 6f66 2032 2069 7320 6571 7569  ase of 2 is equi
+0000e340: 7661 6c65 6e74 2074 6f20 6269 6e61 7279  valent to binary
+0000e350: 2065 6e63 6f64 696e 672e 204e 3d6e 756d   encoding. N=num
+0000e360: 6265 7220 6f66 2061 6374 7561 6c20 6361  ber of actual ca
+0000e370: 7465 676f 7269 6573 2069 7320 6571 7569  tegories is equi
+0000e380: 7661 6c65 6e74 2074 6f20 7661 6e69 6c6c  valent to vanill
+0000e390: 6120 6f72 6469 6e61 6c20 656e 636f 6469  a ordinal encodi
+0000e3a0: 6e67 2e0a 2020 2020 2020 2020 2020 2020  ng..            
+0000e3b0: 2d20 6054 6172 6765 7445 6e63 6f64 6572  - `TargetEncoder
+0000e3c0: 603a 2054 6172 6765 7445 6e63 6f64 6572  `: TargetEncoder
+0000e3d0: 2070 6572 666f 726d 7320 5461 7267 6574   performs Target
+0000e3e0: 2065 6e63 6f64 696e 6720 666f 7220 6361   encoding for ca
+0000e3f0: 7465 676f 7269 6361 6c20 6665 6174 7572  tegorical featur
+0000e400: 6573 2e20 4974 2073 7570 706f 7274 7320  es. It supports 
+0000e410: 666f 6c6c 6f77 696e 6720 6b69 6e64 7320  following kinds 
+0000e420: 6f66 2074 6172 6765 7473 3a20 6269 6e61  of targets: bina
+0000e430: 7279 2061 6e64 2063 6f6e 7469 6e75 6f75  ry and continuou
+0000e440: 732e 2046 6f72 206d 756c 7469 2d63 6c61  s. For multi-cla
+0000e450: 7373 2074 6172 6765 7473 2069 7420 7573  ss targets it us
+0000e460: 6573 2061 2050 6f6c 796e 6f6d 6961 6c57  es a PolynomialW
+0000e470: 7261 7070 6572 2e0a 2020 2020 2020 2020  rapper..        
+0000e480: 2020 2020 2d20 6043 6174 426f 6f73 7445      - `CatBoostE
+0000e490: 6e63 6f64 6572 603a 2043 6174 426f 6f73  ncoder`: CatBoos
+0000e4a0: 7445 6e63 6f64 6572 2070 6572 666f 726d  tEncoder perform
+0000e4b0: 7320 4361 7442 6f6f 7374 2063 6f64 696e  s CatBoost codin
+0000e4c0: 6720 666f 7220 6361 7465 676f 7269 6361  g for categorica
+0000e4d0: 6c20 6665 6174 7572 6573 2e20 4974 2073  l features. It s
+0000e4e0: 7570 706f 7274 7320 7468 6520 666f 6c6c  upports the foll
+0000e4f0: 6f77 696e 6720 6b69 6e64 7320 6f66 2074  owing kinds of t
+0000e500: 6172 6765 7473 3a20 6269 6e61 7279 2061  argets: binary a
+0000e510: 6e64 2063 6f6e 7469 6e75 6f75 732e 2046  nd continuous. F
+0000e520: 6f72 2070 6f6c 796e 6f6d 6961 6c20 7461  or polynomial ta
+0000e530: 7267 6574 2073 7570 706f 7274 2c20 6974  rget support, it
+0000e540: 2075 7365 7320 6120 506f 6c79 6e6f 6d69   uses a Polynomi
+0000e550: 616c 5772 6170 7065 722e 2054 6869 7320  alWrapper. This 
+0000e560: 6973 2076 6572 7920 7369 6d69 6c61 7220  is very similar 
+0000e570: 746f 206c 6561 7665 2d6f 6e65 2d6f 7574  to leave-one-out
+0000e580: 2065 6e63 6f64 696e 672c 2062 7574 2063   encoding, but c
+0000e590: 616c 6375 6c61 7465 7320 7468 6520 7661  alculates the va
+0000e5a0: 6c75 6573 20e2 809c 6f6e 2d74 6865 2d66  lues ...on-the-f
+0000e5b0: 6c79 e280 9d2e 2043 6f6e 7365 7175 656e  ly.... Consequen
+0000e5c0: 746c 792c 2074 6865 2076 616c 7565 7320  tly, the values 
+0000e5d0: 6e61 7475 7261 6c6c 7920 7661 7279 2064  naturally vary d
+0000e5e0: 7572 696e 6720 7468 6520 7472 6169 6e69  uring the traini
+0000e5f0: 6e67 2070 6861 7365 2061 6e64 2069 7420  ng phase and it 
+0000e600: 6973 206e 6f74 206e 6563 6573 7361 7279  is not necessary
+0000e610: 2074 6f20 6164 6420 7261 6e64 6f6d 206e   to add random n
+0000e620: 6f69 7365 2e0a 2020 2020 2020 2020 2020  oise..          
+0000e630: 2020 2d20 6057 4f45 456e 636f 6465 7260    - `WOEEncoder`
+0000e640: 3a20 574f 4545 6e63 6f64 6572 2075 7365  : WOEEncoder use
+0000e650: 7320 7468 6520 5765 6967 6874 206f 6620  s the Weight of 
+0000e660: 4576 6964 656e 6365 2074 6563 686e 6971  Evidence techniq
+0000e670: 7565 2066 6f72 2063 6174 6567 6f72 6963  ue for categoric
+0000e680: 616c 2066 6561 7475 7265 732e 2049 7420  al features. It 
+0000e690: 7375 7070 6f72 7473 206f 6e6c 7920 6f6e  supports only on
+0000e6a0: 6520 6b69 6e64 206f 6620 7461 7267 6574  e kind of target
+0000e6b0: 3a20 6269 6e61 7279 2e20 466f 7220 706f  : binary. For po
+0000e6c0: 6c79 6e6f 6d69 616c 2074 6172 6765 7420  lynomial target 
+0000e6d0: 7375 7070 6f72 742c 2069 7420 7573 6573  support, it uses
+0000e6e0: 2061 2050 6f6c 796e 6f6d 6961 6c57 7261   a PolynomialWra
+0000e6f0: 7070 6572 2e20 4974 2063 616e 6e6f 7420  pper. It cannot 
+0000e700: 6265 2075 7365 6420 666f 7220 5265 6772  be used for Regr
+0000e710: 6573 7369 6f6e 2e0a 2020 2020 2020 2020  ession..        
+0000e720: 2020 2020 2d20 604a 616d 6573 5374 6569      - `JamesStei
+0000e730: 6e45 6e63 6f64 6572 603a 204a 616d 6573  nEncoder`: James
+0000e740: 5374 6569 6e45 6e63 6f64 6572 2075 7365  SteinEncoder use
+0000e750: 7320 7468 6520 4a61 6d65 732d 5374 6569  s the James-Stei
+0000e760: 6e20 6573 7469 6d61 746f 722e 2049 7420  n estimator. It 
+0000e770: 7375 7070 6f72 7473 2032 206b 696e 6473  supports 2 kinds
+0000e780: 206f 6620 7461 7267 6574 733a 2062 696e   of targets: bin
+0000e790: 6172 7920 616e 6420 636f 6e74 696e 756f  ary and continuo
+0000e7a0: 7573 2e20 466f 7220 706f 6c79 6e6f 6d69  us. For polynomi
+0000e7b0: 616c 2074 6172 6765 7420 7375 7070 6f72  al target suppor
+0000e7c0: 742c 2069 7420 7573 6573 2050 6f6c 796e  t, it uses Polyn
+0000e7d0: 6f6d 6961 6c57 7261 7070 6572 2e0a 2020  omialWrapper..  
+0000e7e0: 2020 2020 2020 2020 2020 466f 7220 6665            For fe
+0000e7f0: 6174 7572 6520 7661 6c75 6520 692c 204a  ature value i, J
+0000e800: 616d 6573 2d53 7465 696e 2065 7374 696d  ames-Stein estim
+0000e810: 6174 6f72 2072 6574 7572 6e73 2061 2077  ator returns a w
+0000e820: 6569 6768 7465 6420 6176 6572 6167 6520  eighted average 
+0000e830: 6f66 3a0a 2020 2020 2020 2020 2020 2020  of:.            
+0000e840: 5468 6520 6d65 616e 2074 6172 6765 7420  The mean target 
+0000e850: 7661 6c75 6520 666f 7220 7468 6520 6f62  value for the ob
+0000e860: 7365 7276 6564 2066 6561 7475 7265 2076  served feature v
+0000e870: 616c 7565 2069 2e0a 2020 2020 2020 2020  alue i..        
+0000e880: 2020 2020 5468 6520 6d65 616e 2074 6172      The mean tar
+0000e890: 6765 7420 7661 6c75 6520 2872 6567 6172  get value (regar
+0000e8a0: 646c 6573 7320 6f66 2074 6865 2066 6561  dless of the fea
+0000e8b0: 7475 7265 2076 616c 7565 292e 0a20 2020  ture value)..   
+0000e8c0: 2020 2020 2020 2020 202d 2060 5175 616e           - `Quan
+0000e8d0: 7469 6c65 456e 636f 6465 7260 3a20 5468  tileEncoder`: Th
+0000e8e0: 6973 2069 7320 6120 7665 7279 2067 6f6f  is is a very goo
+0000e8f0: 6420 656e 636f 6465 7220 666f 7220 5265  d encoder for Re
+0000e900: 6772 6573 7369 6f6e 2074 6173 6b73 2e20  gression tasks. 
+0000e910: 5365 6520 5061 7065 7220 616e 6420 6172  See Paper and ar
+0000e920: 7469 636c 653a 0a20 2020 2020 2020 2020  ticle:.         
+0000e930: 2020 2068 7474 7073 3a2f 2f74 6f77 6172     https://towar
+0000e940: 6473 6461 7461 7363 6965 6e63 652e 636f  dsdatascience.co
+0000e950: 6d2f 7175 616e 7469 6c65 2d65 6e63 6f64  m/quantile-encod
+0000e960: 6572 2d65 6233 3363 3237 3234 3131 640a  er-eb33c272411d.
+0000e970: 2020 2020 2020 2020 0a20 2020 2020 2020          .       
+0000e980: 202d 2060 7363 616c 6572 7360 3a20 636f   - `scalers`: co
+0000e990: 756c 6420 6265 206f 6e65 206f 6620 7468  uld be one of th
+0000e9a0: 7265 6520 6d61 696e 2073 6361 6c65 7273  ree main scalers
+0000e9b0: 2075 7365 6420 696e 2073 6369 6b69 742d   used in scikit-
+0000e9c0: 6c65 6172 6e20 6d6f 6465 6c73 2074 6f20  learn models to 
+0000e9d0: 7472 616e 7366 6f72 6d20 6e75 6d65 7269  transform numeri
+0000e9e0: 6320 6665 6174 7572 6573 2e20 4465 6661  c features. Defa
+0000e9f0: 756c 7420 6973 204e 6f6e 652e 2053 6361  ult is None. Sca
+0000ea00: 6c65 7273 2061 7265 2075 7365 6420 696e  lers are used in
+0000ea10: 2074 6865 206c 6173 7420 7374 6570 206f   the last step o
+0000ea20: 6620 7468 6520 7069 7065 6c69 6e65 2074  f the pipeline t
+0000ea30: 6f20 7363 616c 6520 616c 6c20 6665 6174  o scale all feat
+0000ea40: 7572 6573 2074 6861 7420 6861 7665 2074  ures that have t
+0000ea50: 7261 6e73 666f 726d 6564 2e20 486f 7765  ransformed. Howe
+0000ea60: 7665 722c 2079 6f75 206d 6967 6874 2077  ver, you might w
+0000ea70: 616e 7420 746f 2061 766f 6964 2073 6361  ant to avoid sca
+0000ea80: 6c69 6e67 2069 6e20 4e4c 5020 6461 7461  ling in NLP data
+0000ea90: 7365 7473 2073 696e 6365 2061 6674 6572  sets since after
+0000eaa0: 2054 4669 4446 2076 6563 746f 7269 7a61   TFiDF vectoriza
+0000eab0: 7469 6f6e 2c20 7363 616c 696e 6720 7468  tion, scaling th
+0000eac0: 656d 206d 6179 206e 6f74 206d 616b 6520  em may not make 
+0000ead0: 7365 6e73 652e 2042 7574 2069 7420 6973  sense. But it is
+0000eae0: 2075 7020 746f 2079 6f75 2e20 5468 6520   up to you. The 
+0000eaf0: 3420 6f70 7469 6f6e 7320 6172 653a 0a20  4 options are:. 
+0000eb00: 2020 2020 2020 2020 202d 2060 4e6f 6e65           - `None
+0000eb10: 6020 4e6f 2073 6361 6c65 722e 2047 7265  ` No scaler. Gre
+0000eb20: 6174 2066 6f72 2061 6c6d 6f73 7420 616c  at for almost al
+0000eb30: 6c20 6461 7461 7365 7473 2e20 5465 7374  l datasets. Test
+0000eb40: 2069 7420 6669 7273 7420 616e 6420 7468   it first and th
+0000eb50: 656e 2074 7279 206f 6e65 206f 6620 7468  en try one of th
+0000eb60: 6520 7363 616c 6572 7320 6265 6c6f 772e  e scalers below.
+0000eb70: 0a20 2020 2020 2020 2020 202d 2060 7374  .          - `st
+0000eb80: 6460 2073 7461 6e64 6172 6420 7363 616c  d` standard scal
+0000eb90: 6572 2e20 4772 6561 7420 666f 7220 616c  er. Great for al
+0000eba0: 6d6f 7374 2061 6c6c 2064 6174 6173 6574  most all dataset
+0000ebb0: 732e 0a20 2020 2020 2020 2020 202d 2060  s..          - `
+0000ebc0: 6d69 6e6d 6178 6020 6d69 6e6d 6178 2073  minmax` minmax s
+0000ebd0: 6361 6c65 722e 2047 7265 6174 2066 6f72  caler. Great for
+0000ebe0: 2064 6174 6173 6574 7320 7768 6572 6520   datasets where 
+0000ebf0: 796f 7520 6e65 6564 2074 6f20 7365 6520  you need to see 
+0000ec00: 7468 6520 6469 7374 7269 6275 7469 6f6e  the distribution
+0000ec10: 2062 6574 7765 656e 2030 2061 6e64 2031   between 0 and 1
+0000ec20: 2e0a 2020 2020 2020 2020 2020 2d20 6072  ..          - `r
+0000ec30: 6f62 7573 7460 2052 6f62 7573 7420 7363  obust` Robust sc
+0000ec40: 616c 6572 2e20 4772 6561 7420 666f 7220  aler. Great for 
+0000ec50: 6461 7461 7365 7473 2077 6865 7265 2079  datasets where y
+0000ec60: 6f75 2068 6176 6520 6f75 746c 6965 7273  ou have outliers
+0000ec70: 2e0a 2020 2020 2020 2020 2020 2d20 606d  ..          - `m
+0000ec80: 6178 6162 7360 206d 6178 2061 6273 6f6c  axabs` max absol
+0000ec90: 7574 6520 7363 616c 6572 2e20 4772 6561  ute scaler. Grea
+0000eca0: 7420 666f 7220 7363 616c 696e 6720 6275  t for scaling bu
+0000ecb0: 7420 6c65 6176 6573 2074 6865 206e 6567  t leaves the neg
+0000ecc0: 6174 6976 6520 7661 6c75 6573 2061 7320  ative values as 
+0000ecd0: 7468 6579 2061 7265 2028 6e65 6761 7469  they are (negati
+0000ece0: 7665 292e 200a 2020 2020 2020 2020 2d20  ve). .        - 
+0000ecf0: 6064 6174 655f 746f 5f73 7472 696e 6760  `date_to_string`
+0000ed00: 3a20 6465 6661 756c 7420 6973 2046 616c  : default is Fal
+0000ed10: 7365 2e20 4966 2079 6f75 2077 616e 7420  se. If you want 
+0000ed20: 746f 2075 7365 2064 6174 6520 7661 7269  to use date vari
+0000ed30: 6162 6c65 7320 6173 2073 7472 696e 6773  ables as strings
+0000ed40: 2028 6361 7465 676f 7269 6361 6c29 2c20   (categorical), 
+0000ed50: 7468 656e 2073 6574 2069 7420 6173 2054  then set it as T
+0000ed60: 7275 652e 596f 7520 6361 6e20 7573 6520  rue.You can use 
+0000ed70: 7468 6973 206f 7074 696f 6e20 7768 656e  this option when
+0000ed80: 2074 6865 7265 2061 7265 2076 6572 7920   there are very 
+0000ed90: 6665 7720 6461 7465 7320 696e 2079 6f75  few dates in you
+0000eda0: 7220 6461 7461 7365 742e 2049 6620 796f  r dataset. If yo
+0000edb0: 7520 7365 7420 6974 2061 7320 4661 6c73  u set it as Fals
+0000edc0: 652c 2069 7420 7769 6c6c 2063 6f6e 7665  e, it will conve
+0000edd0: 7274 2069 7420 696e 746f 2064 6174 6520  rt it into date 
+0000ede0: 7469 6d65 2066 6f72 6d61 7420 616e 6420  time format and 
+0000edf0: 6578 7472 6163 7420 7570 2074 6f20 3230  extract up to 20
+0000ee00: 2066 6561 7475 7265 7320 6672 6f6d 2079   features from y
+0000ee10: 6f75 7220 6461 7465 2074 696d 6520 636f  our date time co
+0000ee20: 6c75 6d6e 2e20 5468 6973 2069 7320 7468  lumn. This is th
+0000ee30: 6520 6465 6661 756c 7420 6f70 7469 6f6e  e default option
+0000ee40: 2061 6e64 2062 6573 7420 6f70 7469 6f6e   and best option
+0000ee50: 2e0a 2020 2020 2020 2020 2d20 6074 7261  ..        - `tra
+0000ee60: 6e73 666f 726d 5f74 6172 6765 7460 3a20  nsform_target`: 
+0000ee70: 6465 6661 756c 7420 6973 2046 616c 7365  default is False
+0000ee80: 2e20 4966 2079 6f75 2077 616e 7420 746f  . If you want to
+0000ee90: 2074 7261 6e73 666f 726d 2079 6f75 7220   transform your 
+0000eea0: 7461 7267 6574 2076 6172 6961 626c 6528  target variable(
+0000eeb0: 7329 2c20 7468 656e 2073 6574 2069 7420  s), then set it 
+0000eec0: 6173 2054 7275 6520 616e 6420 7765 2077  as True and we w
+0000eed0: 696c 6c20 7472 616e 7366 6f72 6d20 796f  ill transform yo
+0000eee0: 7572 2074 6172 6765 7428 7329 2061 7320  ur target(s) as 
+0000eef0: 6e75 6d65 7269 6320 7573 696e 6720 4c61  numeric using La
+0000ef00: 6265 6c20 456e 636f 6469 6e67 2061 7320  bel Encoding as 
+0000ef10: 7765 6c6c 2061 7320 6d75 6c74 692d 6c61  well as multi-la
+0000ef20: 6265 6c20 4269 6e61 7279 2063 6c61 7373  bel Binary class
+0000ef30: 6573 2e20 5468 6973 2069 7320 6120 6772  es. This is a gr
+0000ef40: 6561 7420 6f70 7469 6f6e 2077 6865 6e20  eat option when 
+0000ef50: 796f 7520 6861 7665 2063 6174 6567 6f72  you have categor
+0000ef60: 6963 616c 2074 6172 6765 7420 7661 7269  ical target vari
+0000ef70: 6162 6c65 732e 0a20 2020 2020 2020 202d  ables..        -
+0000ef80: 2060 696d 6261 6c61 6e63 6564 603a 2064   `imbalanced`: d
+0000ef90: 6566 6175 6c74 2069 7320 4661 6c73 652e  efault is False.
+0000efa0: 2049 6620 796f 7520 6861 7665 2061 6e20   If you have an 
+0000efb0: 696d 6261 6c61 6e63 6564 2064 6174 6173  imbalanced datas
+0000efc0: 6574 2c20 7468 656e 2073 6574 2069 7420  et, then set it 
+0000efd0: 746f 2054 7275 6520 616e 6420 7765 2077  to True and we w
+0000efe0: 696c 6c20 7472 616e 7366 6f72 6d20 796f  ill transform yo
+0000eff0: 7572 2074 7261 696e 2064 6174 6120 7573  ur train data us
+0000f000: 696e 6720 426f 7264 6572 6c69 6e65 534d  ing BorderlineSM
+0000f010: 4f54 4520 6f72 2053 4d4f 5445 4e43 2077  OTE or SMOTENC w
+0000f020: 6869 6368 2061 7265 2062 6f74 6820 6772  hich are both gr
+0000f030: 6561 7420 6f70 7469 6f6e 732e 2057 6520  eat options. We 
+0000f040: 7769 6c6c 2073 656c 6563 7420 7468 6520  will select the 
+0000f050: 7269 6768 7420 534d 4f54 4520 6675 6e63  right SMOTE func
+0000f060: 7469 6f6e 2061 7574 6f6d 6174 6963 616c  tion automatical
+0000f070: 6c79 2e0a 2020 2020 2020 2020 2d20 6063  ly..        - `c
+0000f080: 6f6d 6269 6e65 5f72 6172 6560 3a20 6465  ombine_rare`: de
+0000f090: 6661 756c 7420 6973 2046 616c 7365 2e20  fault is False. 
+0000f0a0: 5468 6973 2069 7320 6120 6772 6561 7420  This is a great 
+0000f0b0: 6f70 7469 6f6e 2069 6620 796f 7520 6861  option if you ha
+0000f0c0: 7665 2074 6f6f 206d 616e 7920 7261 7265  ve too many rare
+0000f0d0: 2063 6174 6567 6f72 6965 7320 696e 2079   categories in y
+0000f0e0: 6f75 7220 6361 7465 676f 7269 6361 6c20  our categorical 
+0000f0f0: 7661 7269 6162 6c65 732e 2049 7420 7769  variables. It wi
+0000f100: 6c6c 2061 7574 6f6d 6174 6963 616c 6c79  ll automatically
+0000f110: 2063 6f6d 6269 6e65 2074 686f 7365 2072   combine those r
+0000f120: 6172 6520 6361 7465 676f 7269 6573 2077  are categories w
+0000f130: 6869 6368 2061 7265 206c 6573 7320 7468  hich are less th
+0000f140: 616e 2031 2520 6f66 2074 6865 2064 6174  an 1% of the dat
+0000f150: 6173 6574 2069 6e74 6f20 6f6e 6520 636f  aset into one co
+0000f160: 6d62 696e 6564 2063 6174 6567 6f72 7920  mbined category 
+0000f170: 6361 6c6c 6564 2022 7261 7265 5f63 6174  called "rare_cat
+0000f180: 6567 6f72 6965 7322 2e20 596f 7520 6361  egories". You ca
+0000f190: 6e20 616c 736f 2073 6574 2069 7420 746f  n also set it to
+0000f1a0: 2046 616c 7365 2061 6e64 2077 6520 7769   False and we wi
+0000f1b0: 6c6c 206e 6f74 2074 7261 6e73 666f 726d  ll not transform
+0000f1c0: 2061 6e79 206f 6620 796f 7572 2063 6174   any of your cat
+0000f1d0: 6567 6f72 6965 7320 696e 2079 6f75 7220  egories in your 
+0000f1e0: 6361 7465 676f 7269 6361 6c20 7661 7269  categorical vari
+0000f1f0: 6162 6c65 732e 0a20 2020 2020 2020 2020  ables..         
+0000f200: 2d20 6076 6572 626f 7365 603a 2054 6869  - `verbose`: Thi
+0000f210: 7320 6861 7320 3320 706f 7373 6962 6c65  s has 3 possible
+0000f220: 2073 7461 7465 733a 0a20 2020 2020 2020   states:.       
+0000f230: 2020 202d 2060 3060 2073 696c 656e 7420     - `0` silent 
+0000f240: 6f75 7470 7574 2e20 4772 6561 7420 666f  output. Great fo
+0000f250: 7220 7275 6e6e 696e 6720 7468 6973 2073  r running this s
+0000f260: 696c 656e 746c 7920 616e 6420 6765 7474  ilently and gett
+0000f270: 696e 6720 6661 7374 2072 6573 756c 7473  ing fast results
+0000f280: 2e0a 2020 2020 2020 2020 2020 2d20 6031  ..          - `1
+0000f290: 6020 6d6f 7265 2076 6572 6269 6167 652e  ` more verbiage.
+0000f2a0: 2047 7265 6174 2066 6f72 206b 6e6f 7769   Great for knowi
+0000f2b0: 6e67 2068 6f77 2072 6573 756c 7473 2077  ng how results w
+0000f2c0: 6572 6520 616e 6420 6d61 6b69 6e67 2063  ere and making c
+0000f2d0: 6861 6e67 6573 2074 6f20 666c 6167 7320  hanges to flags 
+0000f2e0: 696e 2069 6e70 7574 2e0a 2020 2020 2020  in input..      
+0000f2f0: 2020 2020 2d20 6032 6020 6869 6768 6c79      - `2` highly
+0000f300: 2076 6572 626f 7365 206f 7574 7075 742e   verbose output.
+0000f310: 2047 7265 6174 2066 6f72 2066 696e 6469   Great for findi
+0000f320: 6e67 206f 7574 2077 6861 7420 6861 7070  ng out what happ
+0000f330: 656e 7320 756e 6465 7220 7468 6520 686f  ens under the ho
+0000f340: 6f64 2069 6e20 6c61 7a79 7472 616e 7366  od in lazytransf
+0000f350: 6f72 6d20 7069 7065 6c69 6e65 732e 0a20  orm pipelines.. 
+0000f360: 2020 2020 2020 203c 703e 0a20 2020 2020         <p>.     
+0000f370: 2020 2054 6f20 7669 6577 2074 6865 2074     To view the t
+0000f380: 6578 7420 7069 7065 6c69 6e65 2c20 7468  ext pipeline, th
+0000f390: 6520 6465 6661 756c 7420 6469 7370 6c61  e default displa
+0000f3a0: 7920 6973 2027 7465 7874 272c 2064 6f3a  y is 'text', do:
+0000f3b0: 3c62 723e 0a20 2020 2020 2020 200a 2020  <br>.        .  
+0000f3c0: 2020 2020 2020 6060 600a 2020 2020 2020        ```.      
+0000f3d0: 2020 6672 6f6d 2073 6b6c 6561 726e 2069    from sklearn i
+0000f3e0: 6d70 6f72 7420 7365 745f 636f 6e66 6967  mport set_config
+0000f3f0: 0a20 2020 2020 2020 2073 6574 5f63 6f6e  .        set_con
+0000f400: 6669 6728 6469 7370 6c61 793d 2274 6578  fig(display="tex
+0000f410: 7422 290a 2020 2020 2020 2020 6c61 7a79  t").        lazy
+0000f420: 2e78 666f 726d 6572 0a20 2020 2020 2020  .xformer.       
+0000f430: 2060 6060 0a20 2020 2020 2020 200a 2020   ```.        .  
+0000f440: 2020 2020 2020 3c70 3e0a 2020 2020 2020        <p>.      
+0000f450: 2020 546f 2076 6965 7720 7468 6520 7069    To view the pi
+0000f460: 7065 6c69 6e65 2069 6e20 6120 6469 6167  peline in a diag
+0000f470: 7261 6d20 2876 6973 7561 6c20 666f 726d  ram (visual form
+0000f480: 6174 292c 2064 6f3a 3c62 723e 0a20 2020  at), do:<br>.   
+0000f490: 2020 2020 200a 2020 2020 2020 2020 6060       .        ``
+0000f4a0: 600a 2020 2020 2020 2020 6672 6f6d 2073  `.        from s
+0000f4b0: 6b6c 6561 726e 2069 6d70 6f72 7420 7365  klearn import se
+0000f4c0: 745f 636f 6e66 6967 0a20 2020 2020 2020  t_config.       
+0000f4d0: 2073 6574 5f63 6f6e 6669 6728 6469 7370   set_config(disp
+0000f4e0: 6c61 793d 2264 6961 6772 616d 2229 0a20  lay="diagram"). 
+0000f4f0: 2020 2020 2020 206c 617a 792e 7866 6f72         lazy.xfor
+0000f500: 6d65 720a 2020 2020 2020 2020 2320 4966  mer.        # If
+0000f510: 2079 6f75 2068 6176 6520 6120 6d6f 6465   you have a mode
+0000f520: 6c20 696e 2074 6865 2070 6970 656c 696e  l in the pipelin
+0000f530: 652c 2064 6f3a 0a20 2020 2020 2020 206c  e, do:.        l
+0000f540: 617a 792e 6d6f 6465 6c66 6f72 6d65 720a  azy.modelformer.
+0000f550: 2020 2020 2020 2020 6060 600a 2020 2020          ```.    
+0000f560: 2020 2020 3c61 2068 7265 663d 2268 7474      <a href="htt
+0000f570: 7073 3a2f 2f69 6d67 6262 2e63 6f6d 2f22  ps://imgbb.com/"
+0000f580: 3e3c 696d 6720 7372 633d 2268 7474 7073  ><img src="https
+0000f590: 3a2f 2f69 2e69 6262 2e63 6f2f 426e 3756  ://i.ibb.co/Bn7V
+0000f5a0: 3470 782f 6c61 7a79 2d70 6970 652e 706e  4px/lazy-pipe.pn
+0000f5b0: 6722 2061 6c74 3d22 6c61 7a79 2d70 6970  g" alt="lazy-pip
+0000f5c0: 6522 2062 6f72 6465 723d 2230 223e 3c2f  e" border="0"></
+0000f5d0: 613e 0a20 2020 2020 2020 200a 2020 2020  a>.        .    
+0000f5e0: 2020 2020 546f 2076 6965 7720 7468 6520      To view the 
+0000f5f0: 6665 6174 7572 6520 696d 706f 7274 616e  feature importan
+0000f600: 6365 7320 6f66 2074 6865 206d 6f64 656c  ces of the model
+0000f610: 2069 6e20 7468 6520 7069 7065 6c69 6e65   in the pipeline
+0000f620: 2c20 796f 7520 6361 6e20 646f 3a0a 2020  , you can do:.  
+0000f630: 2020 2020 2020 6060 600a 2020 2020 2020        ```.      
+0000f640: 2020 6c61 7a79 2e70 6c6f 745f 696d 706f    lazy.plot_impo
+0000f650: 7274 616e 6365 2829 0a20 2020 2020 2020  rtance().       
+0000f660: 2060 6060 0a20 2020 2020 2020 203c 6120   ```.        <a 
+0000f670: 6872 6566 3d22 6874 7470 733a 2f2f 6962  href="https://ib
+0000f680: 622e 636f 2f6a 6870 7356 744a 223e 3c69  b.co/jhpsVtJ"><i
+0000f690: 6d67 2073 7263 3d22 6874 7470 733a 2f2f  mg src="https://
+0000f6a0: 692e 6962 622e 636f 2f63 4a6d 5662 7159  i.ibb.co/cJmVbqY
+0000f6b0: 2f6c 617a 792d 6665 6174 2d69 6d70 2e70  /lazy-feat-imp.p
+0000f6c0: 6e67 2220 616c 743d 226c 617a 792d 6665  ng" alt="lazy-fe
+0000f6d0: 6174 2d69 6d70 2220 626f 7264 6572 3d22  at-imp" border="
+0000f6e0: 3022 3e3c 2f61 3e0a 2020 2020 2020 2020  0"></a>.        
+0000f6f0: 0a20 2020 2020 2020 2023 2320 4d61 696e  .        ## Main
+0000f700: 7461 696e 6572 730a 2020 2020 2020 2020  tainers.        
+0000f710: 0a20 2020 2020 2020 202a 205b 4041 7574  .        * [@Aut
+0000f720: 6f56 694d 4c5d 2868 7474 7073 3a2f 2f67  oViML](https://g
+0000f730: 6974 6875 622e 636f 6d2f 4175 746f 5669  ithub.com/AutoVi
+0000f740: 4d4c 290a 2020 2020 2020 2020 0a20 2020  ML).        .   
+0000f750: 2020 2020 2023 2320 436f 6e74 7269 6275       ## Contribu
+0000f760: 7469 6e67 0a20 2020 2020 2020 200a 2020  ting.        .  
+0000f770: 2020 2020 2020 5365 6520 5b74 6865 2063        See [the c
+0000f780: 6f6e 7472 6962 7574 696e 6720 6669 6c65  ontributing file
+0000f790: 5d28 434f 4e54 5249 4255 5449 4e47 2e6d  ](CONTRIBUTING.m
+0000f7a0: 6429 210a 2020 2020 2020 2020 0a20 2020  d)!.        .   
+0000f7b0: 2020 2020 2050 5273 2061 6363 6570 7465       PRs accepte
+0000f7c0: 642e 0a20 2020 2020 2020 200a 2020 2020  d..        .    
+0000f7d0: 2020 2020 2323 204c 6963 656e 7365 0a20      ## License. 
+0000f7e0: 2020 2020 2020 200a 2020 2020 2020 2020         .        
+0000f7f0: 4170 6163 6865 204c 6963 656e 7365 2032  Apache License 2
+0000f800: 2e30 20c2 a920 3230 3230 2052 616d 2053  .0 .. 2020 Ram S
+0000f810: 6573 6861 6472 690a 2020 2020 2020 2020  eshadri.        
+0000f820: 0a20 2020 2020 2020 2023 2320 4e6f 7465  .        ## Note
+0000f830: 206f 6620 4772 6174 6974 7564 650a 2020   of Gratitude.  
+0000f840: 2020 2020 2020 0a20 2020 2020 2020 2054        .        T
+0000f850: 6869 7320 6c69 6272 6179 2077 6f75 6c64  his libray would
+0000f860: 206e 6f74 2068 6176 6520 6265 656e 2070   not have been p
+0000f870: 6f73 7369 626c 6520 7769 7468 6f75 7420  ossible without 
+0000f880: 7468 6520 666f 6c6c 6f77 696e 6720 6772  the following gr
+0000f890: 6561 7420 6c69 6272 6172 6965 733a 0a20  eat libraries:. 
+0000f8a0: 2020 2020 2020 203c 6f6c 3e0a 2020 2020         <ol>.    
+0000f8b0: 2020 2020 3c6c 693e 3c62 3e43 6174 6567      <li><b>Categ
+0000f8c0: 6f72 7920 456e 636f 6465 7273 206c 6962  ory Encoders lib
+0000f8d0: 7261 7279 3a3c 2f62 3e20 4661 6e74 6173  rary:</b> Fantas
+0000f8e0: 7469 6320 6c69 6272 6172 7920 6874 7470  tic library http
+0000f8f0: 733a 2f2f 636f 6e74 7269 622e 7363 696b  s://contrib.scik
+0000f900: 6974 2d6c 6561 726e 2e6f 7267 2f63 6174  it-learn.org/cat
+0000f910: 6567 6f72 795f 656e 636f 6465 7273 2f69  egory_encoders/i
+0000f920: 6e64 6578 2e68 746d 6c3c 2f6c 693e 0a20  ndex.html</li>. 
+0000f930: 2020 2020 2020 203c 6c69 3e3c 623e 496d         <li><b>Im
+0000f940: 6261 6c61 6e63 6564 204c 6561 726e 206c  balanced Learn l
+0000f950: 6962 7261 7279 3a3c 2f62 3e20 416e 6f74  ibrary:</b> Anot
+0000f960: 6865 7220 6661 6e74 6173 7469 6320 6c69  her fantastic li
+0000f970: 6272 6172 7920 6874 7470 733a 2f2f 696d  brary https://im
+0000f980: 6261 6c61 6e63 6564 2d6c 6561 726e 2e6f  balanced-learn.o
+0000f990: 7267 2f73 7461 626c 652f 696e 6465 782e  rg/stable/index.
+0000f9a0: 6874 6d6c 3c2f 6c69 3e0a 2020 2020 2020  html</li>.      
+0000f9b0: 2020 3c6c 693e 3c62 3e54 6865 2061 6d61    <li><b>The ama
+0000f9c0: 7a69 6e67 2060 6c61 7a79 7072 6564 6963  zing `lazypredic
+0000f9d0: 7460 3c2f 623e 2077 6173 2061 6e20 696e  t`</b> was an in
+0000f9e0: 7370 6972 6174 696f 6e20 666f 7220 606c  spiration for `l
+0000f9f0: 617a 7974 7261 6e73 666f 726d 602e 2059  azytransform`. Y
+0000fa00: 6f75 2063 616e 2063 6865 636b 206f 7574  ou can check out
+0000fa10: 2074 6865 206c 6962 7261 7279 2068 6572   the library her
+0000fa20: 653a 0a20 2020 2020 2020 2068 7474 7073  e:.        https
+0000fa30: 3a2f 2f67 6974 6875 622e 636f 6d2f 7368  ://github.com/sh
+0000fa40: 616e 6b61 7270 616e 6461 6c61 2f6c 617a  ankarpandala/laz
+0000fa50: 7970 7265 6469 6374 0a20 2020 2020 2020  ypredict.       
+0000fa60: 203c 2f6c 693e 0a20 2020 2020 2020 203c   </li>.        <
+0000fa70: 6c69 3e3c 623e 5468 6520 616d 617a 696e  li><b>The amazin
+0000fa80: 6720 604b 6576 696e 204d 6172 6b68 616d  g `Kevin Markham
+0000fa90: 603c 2f62 3e20 7761 7320 616e 6f74 6865  `</b> was anothe
+0000faa0: 7220 696e 7370 6972 6174 696f 6e20 666f  r inspiration fo
+0000fab0: 7220 6c61 7a79 7472 616e 7366 6f72 6d2e  r lazytransform.
+0000fac0: 2059 6f75 2063 616e 2063 6865 636b 206f   You can check o
+0000fad0: 7574 2068 6973 2063 6c61 7373 6573 2068  ut his classes h
+0000fae0: 6572 653a 0a20 2020 2020 2020 2068 7474  ere:.        htt
+0000faf0: 7073 3a2f 2f77 7777 2e64 6174 6173 6368  ps://www.datasch
+0000fb00: 6f6f 6c2e 696f 2f61 626f 7574 2f0a 2020  ool.io/about/.  
+0000fb10: 2020 2020 2020 3c2f 6c69 3e0a 2020 2020        </li>.    
+0000fb20: 2020 2020 3c2f 6f6c 3e0a 2020 2020 2020      </ol>.      
+0000fb30: 2020 0a20 2020 2020 2020 2023 2320 4449    .        ## DI
+0000fb40: 5343 4c41 494d 4552 0a20 2020 2020 2020  SCLAIMER.       
+0000fb50: 2054 6869 7320 7072 6f6a 6563 7420 6973   This project is
+0000fb60: 206e 6f74 2061 6e20 6f66 6669 6369 616c   not an official
+0000fb70: 2047 6f6f 676c 6520 7072 6f6a 6563 742e   Google project.
+0000fb80: 2049 7420 6973 206e 6f74 2073 7570 706f   It is not suppo
+0000fb90: 7274 6564 2062 7920 476f 6f67 6c65 2061  rted by Google a
+0000fba0: 6e64 2047 6f6f 676c 6520 7370 6563 6966  nd Google specif
+0000fbb0: 6963 616c 6c79 2064 6973 636c 6169 6d73  ically disclaims
+0000fbc0: 2061 6c6c 2077 6172 7261 6e74 6965 7320   all warranties 
+0000fbd0: 6173 2074 6f20 6974 7320 7175 616c 6974  as to its qualit
+0000fbe0: 792c 206d 6572 6368 616e 7461 6269 6c69  y, merchantabili
+0000fbf0: 7479 2c20 6f72 2066 6974 6e65 7373 2066  ty, or fitness f
+0000fc00: 6f72 2061 2070 6172 7469 6375 6c61 7220  or a particular 
+0000fc10: 7075 7270 6f73 652e 0a20 2020 2020 2020  purpose..       
+0000fc20: 200a 2020 2020 2020 2020 0a50 6c61 7466   .        .Platf
+0000fc30: 6f72 6d3a 2055 4e4b 4e4f 574e 0a43 6c61  orm: UNKNOWN.Cla
+0000fc40: 7373 6966 6965 723a 2050 726f 6772 616d  ssifier: Program
+0000fc50: 6d69 6e67 204c 616e 6775 6167 6520 3a3a  ming Language ::
+0000fc60: 2050 7974 686f 6e20 3a3a 2033 0a43 6c61   Python :: 3.Cla
+0000fc70: 7373 6966 6965 723a 204f 7065 7261 7469  ssifier: Operati
+0000fc80: 6e67 2053 7973 7465 6d20 3a3a 204f 5320  ng System :: OS 
+0000fc90: 496e 6465 7065 6e64 656e 740a 4465 7363  Independent.Desc
+0000fca0: 7269 7074 696f 6e2d 436f 6e74 656e 742d  ription-Content-
+0000fcb0: 5479 7065 3a20 7465 7874 2f6d 6172 6b64  Type: text/markd
+0000fcc0: 6f77 6e0a 0000 0000 0000 0000 0000 0000  own.............
+0000fcd0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+0000fce0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+0000fcf0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+0000fd00: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+0000fd10: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+0000fd20: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+0000fd30: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+0000fd40: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+0000fd50: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+0000fd60: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+0000fd70: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+0000fd80: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+0000fd90: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+0000fda0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+0000fdb0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+0000fdc0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+0000fdd0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+0000fde0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+0000fdf0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+0000fe00: 2e2f 2e2f 4050 6178 4865 6164 6572 0000  ././@PaxHeader..
+0000fe10: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+0000fe20: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+0000fe30: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+0000fe40: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+0000fe50: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+0000fe60: 0000 0000 3030 3030 3030 3000 3030 3030  ....0000000.0000
+0000fe70: 3030 3000 3030 3030 3030 3000 3030 3030  000.0000000.0000
+0000fe80: 3030 3030 3032 3600 3030 3030 3030 3030  0000026.00000000
+0000fe90: 3030 3000 3031 3134 3533 0020 7800 0000  000.011453. x...
+0000fea0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+0000feb0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+0000fec0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+0000fed0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+0000fee0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+0000fef0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+0000ff00: 0075 7374 6172 0030 3000 0000 0000 0000  .ustar.00.......
+0000ff10: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+0000ff20: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+0000ff30: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+0000ff40: 0000 0000 0000 0000 0030 3030 3030 3030  .........0000000
+0000ff50: 0030 3030 3030 3030 0000 0000 0000 0000  .0000000........
+0000ff60: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+0000ff70: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+0000ff80: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+0000ff90: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+0000ffa0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+0000ffb0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+0000ffc0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+0000ffd0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+0000ffe0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+0000fff0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+00010000: 3232 206d 7469 6d65 3d31 3638 3432 3838  22 mtime=1684288
+00010010: 3437 332e 300a 0000 0000 0000 0000 0000  473.0...........
+00010020: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+00010030: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+00010040: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+00010050: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+00010060: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+00010070: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+00010080: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+00010090: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+000100a0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+000100b0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+000100c0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+000100d0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+000100e0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+000100f0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+00010100: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+00010110: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+00010120: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+00010130: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+00010140: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+00010150: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+00010160: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+00010170: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+00010180: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+00010190: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+000101a0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+000101b0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+000101c0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+000101d0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+000101e0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+000101f0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+00010200: 6c61 7a79 7472 616e 7366 6f72 6d2d 312e  lazytransform-1.
+00010210: 312f 6c61 7a79 7472 616e 7366 6f72 6d2e  1/lazytransform.
+00010220: 6567 672d 696e 666f 2f53 4f55 5243 4553  egg-info/SOURCES
+00010230: 2e74 7874 0000 0000 0000 0000 0000 0000  .txt............
+00010240: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+00010250: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+00010260: 0000 0000 3030 3030 3737 3700 3030 3031  ....0000777.0001
+00010270: 3735 3000 3030 3031 3735 3000 3030 3030  750.0001750.0000
+00010280: 3030 3030 3333 3300 3030 3030 3030 3030  0000333.00000000
+00010290: 3030 3000 3032 3231 3436 0020 3000 0000  000.022146. 0...
+000102a0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+000102b0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+000102c0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+000102d0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+000102e0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+000102f0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+00010300: 0075 7374 6172 0030 3072 616d 0000 0000  .ustar.00ram....
+00010310: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+00010320: 0000 0000 0000 0000 0072 616d 0000 0000  .........ram....
+00010330: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+00010340: 0000 0000 0000 0000 0030 3030 3030 3030  .........0000000
+00010350: 0030 3030 3030 3030 0000 0000 0000 0000  .0000000........
+00010360: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+00010370: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+00010380: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+00010390: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+000103a0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+000103b0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+000103c0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+000103d0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+000103e0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+000103f0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+00010400: 5245 4144 4d45 2e6d 640a 6c61 7a79 7472  README.md.lazytr
+00010410: 616e 7366 6f72 6d2e 7079 0a73 6574 7570  ansform.py.setup
+00010420: 2e70 790a 6c61 7a79 7472 616e 7366 6f72  .py.lazytransfor
+00010430: 6d2e 6567 672d 696e 666f 2f50 4b47 2d49  m.egg-info/PKG-I
+00010440: 4e46 4f0a 6c61 7a79 7472 616e 7366 6f72  NFO.lazytransfor
+00010450: 6d2e 6567 672d 696e 666f 2f53 4f55 5243  m.egg-info/SOURC
+00010460: 4553 2e74 7874 0a6c 617a 7974 7261 6e73  ES.txt.lazytrans
+00010470: 666f 726d 2e65 6767 2d69 6e66 6f2f 6465  form.egg-info/de
+00010480: 7065 6e64 656e 6379 5f6c 696e 6b73 2e74  pendency_links.t
+00010490: 7874 0a6c 617a 7974 7261 6e73 666f 726d  xt.lazytransform
+000104a0: 2e65 6767 2d69 6e66 6f2f 7265 7175 6972  .egg-info/requir
+000104b0: 6573 2e74 7874 0a6c 617a 7974 7261 6e73  es.txt.lazytrans
+000104c0: 666f 726d 2e65 6767 2d69 6e66 6f2f 746f  form.egg-info/to
+000104d0: 705f 6c65 7665 6c2e 7478 7400 0000 0000  p_level.txt.....
+000104e0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+000104f0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+00010500: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+00010510: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+00010520: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+00010530: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+00010540: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+00010550: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+00010560: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+00010570: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+00010580: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+00010590: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+000105a0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+000105b0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+000105c0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+000105d0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+000105e0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+000105f0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+00010600: 2e2f 2e2f 4050 6178 4865 6164 6572 0000  ././@PaxHeader..
+00010610: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+00010620: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+00010630: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+00010640: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+00010650: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+00010660: 0000 0000 3030 3030 3030 3000 3030 3030  ....0000000.0000
+00010670: 3030 3000 3030 3030 3030 3000 3030 3030  000.0000000.0000
+00010680: 3030 3030 3032 3600 3030 3030 3030 3030  0000026.00000000
+00010690: 3030 3000 3031 3134 3533 0020 7800 0000  000.011453. x...
+000106a0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+000106b0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+000106c0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+000106d0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+000106e0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+000106f0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+00010700: 0075 7374 6172 0030 3000 0000 0000 0000  .ustar.00.......
+00010710: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+00010720: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+00010730: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+00010740: 0000 0000 0000 0000 0030 3030 3030 3030  .........0000000
+00010750: 0030 3030 3030 3030 0000 0000 0000 0000  .0000000........
+00010760: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+00010770: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+00010780: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+00010790: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+000107a0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+000107b0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+000107c0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+000107d0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+000107e0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+000107f0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+00010800: 3232 206d 7469 6d65 3d31 3638 3432 3838  22 mtime=1684288
+00010810: 3437 332e 300a 0000 0000 0000 0000 0000  473.0...........
+00010820: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+00010830: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+00010840: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+00010850: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+00010860: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+00010870: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+00010880: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+00010890: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+000108a0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+000108b0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+000108c0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+000108d0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+000108e0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+000108f0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+00010900: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+00010910: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+00010920: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+00010930: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+00010940: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+00010950: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+00010960: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+00010970: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+00010980: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+00010990: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+000109a0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+000109b0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+000109c0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+000109d0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+000109e0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+000109f0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+00010a00: 6c61 7a79 7472 616e 7366 6f72 6d2d 312e  lazytransform-1.
+00010a10: 312f 6c61 7a79 7472 616e 7366 6f72 6d2e  1/lazytransform.
+00010a20: 6567 672d 696e 666f 2f64 6570 656e 6465  egg-info/depende
+00010a30: 6e63 795f 6c69 6e6b 732e 7478 7400 0000  ncy_links.txt...
+00010a40: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+00010a50: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+00010a60: 0000 0000 3030 3030 3737 3700 3030 3031  ....0000777.0001
+00010a70: 3735 3000 3030 3031 3735 3000 3030 3030  750.0001750.0000
+00010a80: 3030 3030 3030 3100 3030 3030 3030 3030  0000001.00000000
+00010a90: 3030 3000 3032 3433 3331 0020 3000 0000  000.024331. 0...
+00010aa0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+00010ab0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+00010ac0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+00010ad0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+00010ae0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+00010af0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+00010b00: 0075 7374 6172 0030 3072 616d 0000 0000  .ustar.00ram....
+00010b10: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+00010b20: 0000 0000 0000 0000 0072 616d 0000 0000  .........ram....
+00010b30: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+00010b40: 0000 0000 0000 0000 0030 3030 3030 3030  .........0000000
+00010b50: 0030 3030 3030 3030 0000 0000 0000 0000  .0000000........
+00010b60: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+00010b70: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+00010b80: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+00010b90: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+00010ba0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+00010bb0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+00010bc0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+00010bd0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+00010be0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+00010bf0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+00010c00: 0a00 0000 0000 0000 0000 0000 0000 0000  ................
+00010c10: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+00010c20: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+00010c30: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+00010c40: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+00010c50: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+00010c60: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+00010c70: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+00010c80: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+00010c90: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+00010ca0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+00010cb0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+00010cc0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+00010cd0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+00010ce0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+00010cf0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+00010d00: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+00010d10: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+00010d20: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+00010d30: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+00010d40: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+00010d50: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+00010d60: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+00010d70: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+00010d80: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+00010d90: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+00010da0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+00010db0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+00010dc0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+00010dd0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+00010de0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+00010df0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+00010e00: 2e2f 2e2f 4050 6178 4865 6164 6572 0000  ././@PaxHeader..
+00010e10: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+00010e20: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+00010e30: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+00010e40: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+00010e50: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+00010e60: 0000 0000 3030 3030 3030 3000 3030 3030  ....0000000.0000
+00010e70: 3030 3000 3030 3030 3030 3000 3030 3030  000.0000000.0000
+00010e80: 3030 3030 3032 3600 3030 3030 3030 3030  0000026.00000000
+00010e90: 3030 3000 3031 3134 3533 0020 7800 0000  000.011453. x...
+00010ea0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+00010eb0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+00010ec0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+00010ed0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+00010ee0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+00010ef0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+00010f00: 0075 7374 6172 0030 3000 0000 0000 0000  .ustar.00.......
+00010f10: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+00010f20: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+00010f30: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+00010f40: 0000 0000 0000 0000 0030 3030 3030 3030  .........0000000
+00010f50: 0030 3030 3030 3030 0000 0000 0000 0000  .0000000........
+00010f60: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+00010f70: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+00010f80: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+00010f90: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+00010fa0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+00010fb0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+00010fc0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+00010fd0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+00010fe0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+00010ff0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+00011000: 3232 206d 7469 6d65 3d31 3638 3432 3838  22 mtime=1684288
+00011010: 3437 332e 300a 0000 0000 0000 0000 0000  473.0...........
+00011020: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+00011030: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+00011040: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+00011050: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+00011060: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+00011070: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+00011080: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+00011090: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+000110a0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+000110b0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+000110c0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+000110d0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+000110e0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+000110f0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+00011100: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+00011110: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+00011120: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+00011130: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+00011140: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+00011150: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+00011160: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+00011170: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+00011180: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+00011190: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+000111a0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+000111b0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+000111c0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+000111d0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+000111e0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+000111f0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+00011200: 6c61 7a79 7472 616e 7366 6f72 6d2d 312e  lazytransform-1.
+00011210: 312f 6c61 7a79 7472 616e 7366 6f72 6d2e  1/lazytransform.
+00011220: 6567 672d 696e 666f 2f72 6571 7569 7265  egg-info/require
+00011230: 732e 7478 7400 0000 0000 0000 0000 0000  s.txt...........
+00011240: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+00011250: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+00011260: 0000 0000 3030 3030 3737 3700 3030 3031  ....0000777.0001
+00011270: 3735 3000 3030 3031 3735 3000 3030 3030  750.0001750.0000
+00011280: 3030 3030 3235 3000 3030 3030 3030 3030  0000250.00000000
+00011290: 3030 3000 3032 3236 3630 0020 3000 0000  000.022660. 0...
+000112a0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+000112b0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+000112c0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+000112d0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+000112e0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+000112f0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+00011300: 0075 7374 6172 0030 3072 616d 0000 0000  .ustar.00ram....
+00011310: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+00011320: 0000 0000 0000 0000 0072 616d 0000 0000  .........ram....
+00011330: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+00011340: 0000 0000 0000 0000 0030 3030 3030 3030  .........0000000
+00011350: 0030 3030 3030 3030 0000 0000 0000 0000  .0000000........
+00011360: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+00011370: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+00011380: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+00011390: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+000113a0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+000113b0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+000113c0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+000113d0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+000113e0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+000113f0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+00011400: 6361 7465 676f 7279 2d65 6e63 6f64 6572  category-encoder
+00011410: 737e 3d32 2e32 2e32 0a69 6d62 616c 616e  s~=2.2.2.imbalan
+00011420: 6365 642d 6c65 6172 6e3e 3d30 2e38 2e30  ced-learn>=0.8.0
+00011430: 0a6c 6967 6874 6762 6d3e 3d33 2e32 2e31  .lightgbm>=3.2.1
+00011440: 0a6d 6174 706c 6f74 6c69 627e 3d33 2e34  .matplotlib~=3.4
+00011450: 2e32 0a6e 756d 7079 7e3d 312e 3230 2e33  .2.numpy~=1.20.3
+00011460: 0a70 616e 6461 737e 3d31 2e32 2e34 0a70  .pandas~=1.2.4.p
+00011470: 7974 686f 6e2d 6461 7465 7574 696c 7e3d  ython-dateutil~=
+00011480: 322e 382e 310a 7363 696b 6974 2d6c 6561  2.8.1.scikit-lea
+00011490: 726e 7e3d 302e 3234 2e32 0a74 7164 6d7e  rn~=0.24.2.tqdm~
+000114a0: 3d34 2e36 312e 310a 0000 0000 0000 0000  =4.61.1.........
+000114b0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+000114c0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+000114d0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+000114e0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+000114f0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+00011500: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+00011510: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+00011520: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+00011530: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+00011540: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+00011550: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+00011560: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+00011570: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+00011580: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+00011590: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+000115a0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+000115b0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+000115c0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+000115d0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+000115e0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+000115f0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+00011600: 2e2f 2e2f 4050 6178 4865 6164 6572 0000  ././@PaxHeader..
+00011610: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+00011620: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+00011630: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+00011640: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+00011650: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+00011660: 0000 0000 3030 3030 3030 3000 3030 3030  ....0000000.0000
+00011670: 3030 3000 3030 3030 3030 3000 3030 3030  000.0000000.0000
+00011680: 3030 3030 3032 3600 3030 3030 3030 3030  0000026.00000000
+00011690: 3030 3000 3031 3134 3533 0020 7800 0000  000.011453. x...
+000116a0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+000116b0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+000116c0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+000116d0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+000116e0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+000116f0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+00011700: 0075 7374 6172 0030 3000 0000 0000 0000  .ustar.00.......
+00011710: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+00011720: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+00011730: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+00011740: 0000 0000 0000 0000 0030 3030 3030 3030  .........0000000
+00011750: 0030 3030 3030 3030 0000 0000 0000 0000  .0000000........
+00011760: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+00011770: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+00011780: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+00011790: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+000117a0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+000117b0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+000117c0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+000117d0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+000117e0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+000117f0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+00011800: 3232 206d 7469 6d65 3d31 3638 3432 3838  22 mtime=1684288
+00011810: 3437 332e 300a 0000 0000 0000 0000 0000  473.0...........
+00011820: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+00011830: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+00011840: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+00011850: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+00011860: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+00011870: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+00011880: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+00011890: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+000118a0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+000118b0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+000118c0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+000118d0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+000118e0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+000118f0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+00011900: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+00011910: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+00011920: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+00011930: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+00011940: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+00011950: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+00011960: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+00011970: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+00011980: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+00011990: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+000119a0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+000119b0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+000119c0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+000119d0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+000119e0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+000119f0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+00011a00: 6c61 7a79 7472 616e 7366 6f72 6d2d 312e  lazytransform-1.
+00011a10: 312f 6c61 7a79 7472 616e 7366 6f72 6d2e  1/lazytransform.
+00011a20: 6567 672d 696e 666f 2f74 6f70 5f6c 6576  egg-info/top_lev
+00011a30: 656c 2e74 7874 0000 0000 0000 0000 0000  el.txt..........
+00011a40: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+00011a50: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+00011a60: 0000 0000 3030 3030 3737 3700 3030 3031  ....0000777.0001
+00011a70: 3735 3000 3030 3031 3735 3000 3030 3030  750.0001750.0000
+00011a80: 3030 3030 3031 3600 3030 3030 3030 3030  0000016.00000000
+00011a90: 3030 3000 3032 3330 3132 0020 3000 0000  000.023012. 0...
+00011aa0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+00011ab0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+00011ac0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+00011ad0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+00011ae0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+00011af0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+00011b00: 0075 7374 6172 0030 3072 616d 0000 0000  .ustar.00ram....
+00011b10: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+00011b20: 0000 0000 0000 0000 0072 616d 0000 0000  .........ram....
+00011b30: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+00011b40: 0000 0000 0000 0000 0030 3030 3030 3030  .........0000000
+00011b50: 0030 3030 3030 3030 0000 0000 0000 0000  .0000000........
+00011b60: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+00011b70: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+00011b80: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+00011b90: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+00011ba0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+00011bb0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+00011bc0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+00011bd0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+00011be0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+00011bf0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+00011c00: 6c61 7a79 7472 616e 7366 6f72 6d0a 0000  lazytransform...
+00011c10: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+00011c20: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+00011c30: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+00011c40: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+00011c50: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+00011c60: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+00011c70: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+00011c80: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+00011c90: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+00011ca0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+00011cb0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+00011cc0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+00011cd0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+00011ce0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+00011cf0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+00011d00: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+00011d10: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+00011d20: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+00011d30: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+00011d40: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+00011d50: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+00011d60: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+00011d70: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+00011d80: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+00011d90: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+00011da0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+00011db0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+00011dc0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+00011dd0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+00011de0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+00011df0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+00011e00: 2e2f 2e2f 4050 6178 4865 6164 6572 0000  ././@PaxHeader..
+00011e10: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+00011e20: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+00011e30: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+00011e40: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+00011e50: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+00011e60: 0000 0000 3030 3030 3030 3000 3030 3030  ....0000000.0000
+00011e70: 3030 3000 3030 3030 3030 3000 3030 3030  000.0000000.0000
+00011e80: 3030 3030 3032 3600 3030 3030 3030 3030  0000026.00000000
+00011e90: 3030 3000 3031 3134 3533 0020 7800 0000  000.011453. x...
+00011ea0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+00011eb0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+00011ec0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+00011ed0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+00011ee0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+00011ef0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+00011f00: 0075 7374 6172 0030 3000 0000 0000 0000  .ustar.00.......
+00011f10: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+00011f20: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+00011f30: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+00011f40: 0000 0000 0000 0000 0030 3030 3030 3030  .........0000000
+00011f50: 0030 3030 3030 3030 0000 0000 0000 0000  .0000000........
+00011f60: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+00011f70: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+00011f80: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+00011f90: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+00011fa0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+00011fb0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+00011fc0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+00011fd0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+00011fe0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+00011ff0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+00012000: 3232 206d 7469 6d65 3d31 3638 3336 3833  22 mtime=1683683
+00012010: 3230 322e 300a 0000 0000 0000 0000 0000  202.0...........
+00012020: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+00012030: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+00012040: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+00012050: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+00012060: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+00012070: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+00012080: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+00012090: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+000120a0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+000120b0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+000120c0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+000120d0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+000120e0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+000120f0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+00012100: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+00012110: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+00012120: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+00012130: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+00012140: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+00012150: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+00012160: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+00012170: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+00012180: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+00012190: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+000121a0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+000121b0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+000121c0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+000121d0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+000121e0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+000121f0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+00012200: 6c61 7a79 7472 616e 7366 6f72 6d2d 312e  lazytransform-1.
+00012210: 312f 6c61 7a79 7472 616e 7366 6f72 6d2e  1/lazytransform.
+00012220: 7079 0000 0000 0000 0000 0000 0000 0000  py..............
+00012230: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+00012240: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+00012250: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+00012260: 0000 0000 3030 3030 3737 3700 3030 3031  ....0000777.0001
+00012270: 3735 3000 3030 3031 3735 3000 3030 3030  750.0001750.0000
+00012280: 3036 3634 3533 3300 3030 3030 3030 3030  0664533.00000000
+00012290: 3030 3000 3031 3731 3634 0020 3000 0000  000.017164. 0...
+000122a0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+000122b0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+000122c0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+000122d0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+000122e0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+000122f0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+00012300: 0075 7374 6172 0030 3072 616d 0000 0000  .ustar.00ram....
+00012310: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+00012320: 0000 0000 0000 0000 0072 616d 0000 0000  .........ram....
+00012330: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+00012340: 0000 0000 0000 0000 0030 3030 3030 3030  .........0000000
+00012350: 0030 3030 3030 3030 0000 0000 0000 0000  .0000000........
+00012360: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+00012370: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+00012380: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+00012390: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+000123a0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+000123b0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+000123c0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+000123d0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+000123e0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+000123f0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+00012400: 2321 2f75 7372 2f62 696e 2f65 6e76 2070  #!/usr/bin/env p
+00012410: 7974 686f 6e0a 2320 636f 6469 6e67 3a20  ython.# coding: 
+00012420: 7574 662d 380a 2323 2323 2323 2323 2323  utf-8.##########
+00012430: 2323 2323 2323 2323 2323 2323 2323 2323  ################
+00012440: 2323 2323 2323 2323 2323 2323 2323 2323  ################
+00012450: 2323 2323 2323 2323 2323 2323 2323 2323  ################
+00012460: 2323 2323 2323 2323 2323 2323 2323 2323  ################
+00012470: 2323 2323 2323 2323 2323 2323 2323 2323  ################
+00012480: 2323 0a23 2043 6f70 7972 6967 6874 205b  ##.# Copyright [
+00012490: 3230 3232 5d20 5b52 616d 2053 6573 6861  2022] [Ram Sesha
+000124a0: 6472 695d 0a23 0a23 204c 6963 656e 7365  dri].#.# License
+000124b0: 6420 756e 6465 7220 7468 6520 4170 6163  d under the Apac
+000124c0: 6865 204c 6963 656e 7365 2c20 5665 7273  he License, Vers
+000124d0: 696f 6e20 322e 3020 2874 6865 2022 4c69  ion 2.0 (the "Li
+000124e0: 6365 6e73 6522 293b 0a23 2079 6f75 206d  cense");.# you m
+000124f0: 6179 206e 6f74 2075 7365 2074 6869 7320  ay not use this 
+00012500: 6669 6c65 2065 7863 6570 7420 696e 2063  file except in c
+00012510: 6f6d 706c 6961 6e63 6520 7769 7468 2074  ompliance with t
+00012520: 6865 204c 6963 656e 7365 2e0a 2320 596f  he License..# Yo
+00012530: 7520 6d61 7920 6f62 7461 696e 2061 2063  u may obtain a c
+00012540: 6f70 7920 6f66 2074 6865 204c 6963 656e  opy of the Licen
+00012550: 7365 2061 740a 230a 2320 2020 2068 7474  se at.#.#    htt
+00012560: 703a 2f2f 7777 772e 6170 6163 6865 2e6f  p://www.apache.o
+00012570: 7267 2f6c 6963 656e 7365 732f 4c49 4345  rg/licenses/LICE
+00012580: 4e53 452d 322e 300a 230a 2320 556e 6c65  NSE-2.0.#.# Unle
+00012590: 7373 2072 6571 7569 7265 6420 6279 2061  ss required by a
+000125a0: 7070 6c69 6361 626c 6520 6c61 7720 6f72  pplicable law or
+000125b0: 2061 6772 6565 6420 746f 2069 6e20 7772   agreed to in wr
+000125c0: 6974 696e 672c 2073 6f66 7477 6172 650a  iting, software.
+000125d0: 2320 6469 7374 7269 6275 7465 6420 756e  # distributed un
+000125e0: 6465 7220 7468 6520 4c69 6365 6e73 6520  der the License 
+000125f0: 6973 2064 6973 7472 6962 7574 6564 206f  is distributed o
+00012600: 6e20 616e 2022 4153 2049 5322 2042 4153  n an "AS IS" BAS
+00012610: 4953 2c0a 2320 5749 5448 4f55 5420 5741  IS,.# WITHOUT WA
+00012620: 5252 414e 5449 4553 204f 5220 434f 4e44  RRANTIES OR COND
+00012630: 4954 494f 4e53 204f 4620 414e 5920 4b49  ITIONS OF ANY KI
+00012640: 4e44 2c20 6569 7468 6572 2065 7870 7265  ND, either expre
+00012650: 7373 206f 7220 696d 706c 6965 642e 0a23  ss or implied..#
+00012660: 2053 6565 2074 6865 204c 6963 656e 7365   See the License
+00012670: 2066 6f72 2074 6865 2073 7065 6369 6669   for the specifi
+00012680: 6320 6c61 6e67 7561 6765 2067 6f76 6572  c language gover
+00012690: 6e69 6e67 2070 6572 6d69 7373 696f 6e73  ning permissions
+000126a0: 2061 6e64 0a23 206c 696d 6974 6174 696f   and.# limitatio
+000126b0: 6e73 2075 6e64 6572 2074 6865 204c 6963  ns under the Lic
+000126c0: 656e 7365 2e0a 2323 2323 2323 2323 2323  ense..##########
+000126d0: 2323 2323 2323 2323 2323 2323 2323 2323  ################
+000126e0: 2323 2323 2323 2323 2323 2323 2323 2323  ################
+000126f0: 2323 2323 2323 2323 2323 2323 2323 2323  ################
+00012700: 2323 2323 2323 2323 2323 2323 2323 2323  ################
+00012710: 2323 2323 2323 2323 2323 2323 2323 2323  ################
+00012720: 230a 2323 2323 2320 4c61 7a79 5472 616e  #.##### LazyTran
+00012730: 7366 6f72 6d65 7220 6973 2061 2073 696d  sformer is a sim
+00012740: 706c 6520 7472 616e 7366 6f72 6d65 7220  ple transformer 
+00012750: 7069 7065 6c69 6e65 2066 6f72 2061 6c6c  pipeline for all
+00012760: 206b 696e 6473 206f 6620 4d4c 2070 726f   kinds of ML pro
+00012770: 626c 656d 732e 2023 2323 2323 230a 2323  blems. ######.##
+00012780: 2323 2323 2323 2323 2323 2323 2323 2323  ################
+00012790: 2323 2323 2323 2323 2323 2323 2323 2323  ################
+000127a0: 2323 2323 2323 2323 2323 2323 2323 2323  ################
+000127b0: 2323 2323 2323 2323 2323 2323 2323 2323  ################
+000127c0: 2323 2323 2323 2323 2323 2323 2323 2323  ################
+000127d0: 2323 2323 2323 2323 230a 2320 5768 6174  #########.# What
+000127e0: 2064 6f65 7320 7468 6973 2070 6970 656c   does this pipel
+000127f0: 696e 6520 646f 3f20 4865 7265 2773 2074  ine do? Here's t
+00012800: 6865 206d 616a 6f72 2073 7465 7073 3a0a  he major steps:.
+00012810: 2320 312e 2054 616b 6573 2063 6174 6567  # 1. Takes categ
+00012820: 6f72 6963 616c 2076 6172 6961 626c 6573  orical variables
+00012830: 2061 6e64 2065 6e63 6f64 6573 2074 6865   and encodes the
+00012840: 6d20 7573 696e 6720 6d79 2073 7065 6369  m using my speci
+00012850: 616c 206c 6162 656c 2065 6e63 6f64 6572  al label encoder
+00012860: 2077 6869 6368 2063 616e 200a 2320 2020   which can .#   
+00012870: 2068 616e 646c 6520 4e61 4e73 2061 6e64   handle NaNs and
+00012880: 2066 7574 7572 6520 6361 7465 676f 7269   future categori
+00012890: 6573 0a23 2031 2e20 5461 6b65 7320 696e  es.# 1. Takes in
+000128a0: 7465 6765 7220 616e 6420 666c 6f61 7420  teger and float 
+000128b0: 7661 7269 6162 6c65 7320 616e 6420 696d  variables and im
+000128c0: 7075 7465 7320 7468 656d 2075 7369 6e67  putes them using
+000128d0: 2061 2073 696d 706c 6520 696d 7075 7465   a simple impute
+000128e0: 7220 2877 6974 6820 6120 6465 6661 756c  r (with a defaul
+000128f0: 7429 0a23 2031 2e20 5461 6b65 7320 4e4c  t).# 1. Takes NL
+00012900: 5020 616e 6420 7469 6d65 2073 6572 6965  P and time serie
+00012910: 7320 2861 7320 7374 7269 6e67 2920 7661  s (as string) va
+00012920: 7269 6162 6c65 7320 616e 6420 7665 6374  riables and vect
+00012930: 6f72 697a 6573 2074 6865 6d20 7573 696e  orizes them usin
+00012940: 6720 5446 6944 460a 2320 312e 2054 616b  g TFiDF.# 1. Tak
+00012950: 6573 2070 616e 6461 7320 6461 7465 2d74  es pandas date-t
+00012960: 696d 6520 2861 6374 7561 6c20 6461 7465  ime (actual date
+00012970: 2d74 696d 6529 2076 6172 6961 626c 6573  -time) variables
+00012980: 2061 6e64 2065 7874 7261 6374 7320 6d6f   and extracts mo
+00012990: 7265 2066 6561 7475 7265 7320 6672 6f6d  re features from
+000129a0: 2074 6865 6d0a 2320 312e 2043 6f6d 706c   them.# 1. Compl
+000129b0: 6574 656c 7920 4e6f 726d 616c 697a 6573  etely Normalizes
+000129c0: 2061 6c6c 206f 6620 7468 6520 6162 6f76   all of the abov
+000129d0: 6520 7573 696e 6720 4162 734d 6178 5363  e using AbsMaxSc
+000129e0: 616c 6572 2077 6869 6368 2070 7265 7365  aler which prese
+000129f0: 7276 6573 2074 6865 200a 2320 2020 2020  rves the .#     
+00012a00: 7265 6c61 7469 6f6e 7368 6970 206f 6620  relationship of 
+00012a10: 6c61 6265 6c20 656e 636f 6465 6420 7661  label encoded va
+00012a20: 7273 0a23 2031 2e20 4f70 7469 6f6e 616c  rs.# 1. Optional
+00012a30: 6c79 2061 6464 7320 616e 7920 6d6f 6465  ly adds any mode
+00012a40: 6c20 746f 2070 6970 656c 696e 6520 736f  l to pipeline so
+00012a50: 2074 6865 2065 6e74 6972 6520 7069 7065   the entire pipe
+00012a60: 6c69 6e65 2063 616e 2062 6520 6665 6420  line can be fed 
+00012a70: 746f 2061 200a 2320 2020 2020 6372 6f73  to a .#     cros
+00012a80: 7320 7661 6c69 6461 7469 6f6e 2073 6368  s validation sch
+00012a90: 656d 6520 286a 7573 7420 7365 7420 6d6f  eme (just set mo
+00012aa0: 6465 6c3d 616e 795f 736b 6c65 6172 6e5f  del=any_sklearn_
+00012ab0: 6d6f 6465 6c28 2920 7768 656e 2064 6566  model() when def
+00012ac0: 696e 696e 6720 7468 6520 7069 7065 6c69  ining the pipeli
+00012ad0: 6e65 290a 2320 5468 6520 696e 6974 6961  ne).# The initia
+00012ae0: 6c20 7265 7375 6c74 7320 6672 6f6d 2074  l results from t
+00012af0: 6869 7320 7069 7065 6c69 6e65 2069 6e20  his pipeline in 
+00012b00: 7265 616c 2077 6f72 6c64 2064 6174 6120  real world data 
+00012b10: 7365 7473 2069 7320 7072 6f6d 6973 696e  sets is promisin
+00012b20: 6720 696e 6465 6564 2e0a 2323 2323 2323  g indeed..######
+00012b30: 2323 2323 2323 2323 2323 2323 2323 2323  ################
+00012b40: 2323 2323 2323 2323 2323 2323 2323 2323  ################
+00012b50: 2323 2323 2323 2323 2323 2323 2323 2323  ################
+00012b60: 2323 2323 2323 2323 2323 2323 2323 2323  ################
+00012b70: 2323 2323 2323 2323 2323 2323 2323 2323  ################
+00012b80: 2323 2323 2323 0a23 2323 2323 2323 2054  ######.####### T
+00012b90: 6869 7320 5472 616e 7366 6f72 6d65 7220  his Transformer 
+00012ba0: 6973 2069 6e73 7069 7265 6420 6279 204b  is inspired by K
+00012bb0: 6576 696e 204d 6172 6b68 616d 2773 2063  evin Markham's c
+00012bc0: 6c61 7373 206f 6e20 5363 696b 6974 2d4c  lass on Scikit-L
+00012bd0: 6561 726e 2070 6970 656c 696e 6573 2e20  earn pipelines. 
+00012be0: 2323 230a 2323 2323 2323 2320 2020 596f  ###.#######   Yo
+00012bf0: 7520 6361 6e20 7369 676e 2075 7020 666f  u can sign up fo
+00012c00: 7220 6869 7320 4461 7461 2053 6368 6f6f  r his Data Schoo
+00012c10: 6c20 636c 6173 7320 6865 7265 3a20 6874  l class here: ht
+00012c20: 7470 733a 2f2f 7777 772e 6461 7461 7363  tps://www.datasc
+00012c30: 686f 6f6c 2e69 6f2f 2020 2323 2323 2323  hool.io/  ######
+00012c40: 0a23 2323 2323 2323 2323 2323 2323 2323  .###############
+00012c50: 2323 2323 2323 2323 2323 2323 2323 2323  ################
+00012c60: 2323 2323 2323 2323 2323 2323 2323 2323  ################
+00012c70: 2323 2323 2323 2323 2323 2323 2323 2323  ################
+00012c80: 2323 2323 2323 2323 2323 2323 2323 2323  ################
+00012c90: 2323 2323 2323 2323 2323 2323 230a 696d  #############.im
+00012ca0: 706f 7274 206e 756d 7079 2061 7320 6e70  port numpy as np
+00012cb0: 0a69 6d70 6f72 7420 7061 6e64 6173 2061  .import pandas a
+00012cc0: 7320 7064 0a6e 702e 7261 6e64 6f6d 2e73  s pd.np.random.s
+00012cd0: 6565 6428 3939 290a 696d 706f 7274 2072  eed(99).import r
+00012ce0: 616e 646f 6d0a 7261 6e64 6f6d 2e73 6565  andom.random.see
+00012cf0: 6428 3432 290a 2323 2323 2323 2323 2323  d(42).##########
+00012d00: 2323 2323 2323 2323 2323 2323 2323 2323  ################
+00012d10: 2323 2323 2323 2323 2323 2323 2323 2323  ################
+00012d20: 2323 2323 2323 2323 2323 2323 2323 2323  ################
+00012d30: 2323 2323 2323 2323 2323 2323 2323 2323  ################
+00012d40: 2323 2323 2323 0a69 6d70 6f72 7420 7761  ######.import wa
+00012d50: 726e 696e 6773 0a77 6172 6e69 6e67 732e  rnings.warnings.
+00012d60: 6669 6c74 6572 7761 726e 696e 6773 2822  filterwarnings("
+00012d70: 6967 6e6f 7265 2229 0a66 726f 6d20 736b  ignore").from sk
+00012d80: 6c65 6172 6e2e 6578 6365 7074 696f 6e73  learn.exceptions
+00012d90: 2069 6d70 6f72 7420 4461 7461 436f 6e76   import DataConv
+00012da0: 6572 7369 6f6e 5761 726e 696e 670a 7761  ersionWarning.wa
+00012db0: 726e 696e 6773 2e66 696c 7465 7277 6172  rnings.filterwar
+00012dc0: 6e69 6e67 7328 6163 7469 6f6e 3d27 6967  nings(action='ig
+00012dd0: 6e6f 7265 272c 2063 6174 6567 6f72 793d  nore', category=
+00012de0: 4461 7461 436f 6e76 6572 7369 6f6e 5761  DataConversionWa
+00012df0: 726e 696e 6729 0a77 6974 6820 7761 726e  rning).with warn
+00012e00: 696e 6773 2e63 6174 6368 5f77 6172 6e69  ings.catch_warni
+00012e10: 6e67 7328 293a 0a20 2020 2077 6172 6e69  ngs():.    warni
+00012e20: 6e67 732e 7369 6d70 6c65 6669 6c74 6572  ngs.simplefilter
+00012e30: 2822 6967 6e6f 7265 2229 0a23 2323 2323  ("ignore").#####
+00012e40: 2323 2323 2323 2323 2323 2323 2323 2323  ################
+00012e50: 2323 2323 2323 2323 2323 2323 2323 2323  ################
+00012e60: 2323 2323 2323 2323 2323 2323 2323 2323  ################
+00012e70: 2323 2323 2323 2323 2323 2323 2323 2323  ################
+00012e80: 2323 2323 2323 2323 2323 230a 6672 6f6d  ###########.from
+00012e90: 2073 6b6c 6561 726e 2e69 6d70 7574 6520   sklearn.impute 
+00012ea0: 696d 706f 7274 2053 696d 706c 6549 6d70  import SimpleImp
+00012eb0: 7574 6572 0a66 726f 6d20 736b 6c65 6172  uter.from sklear
+00012ec0: 6e2e 6665 6174 7572 655f 6578 7472 6163  n.feature_extrac
+00012ed0: 7469 6f6e 2e74 6578 7420 696d 706f 7274  tion.text import
+00012ee0: 2043 6f75 6e74 5665 6374 6f72 697a 6572   CountVectorizer
+00012ef0: 2c20 5466 6964 6656 6563 746f 7269 7a65  , TfidfVectorize
+00012f00: 720a 6672 6f6d 2073 6b6c 6561 726e 2e6c  r.from sklearn.l
+00012f10: 696e 6561 725f 6d6f 6465 6c20 696d 706f  inear_model impo
+00012f20: 7274 204c 6f67 6973 7469 6352 6567 7265  rt LogisticRegre
+00012f30: 7373 696f 6e0a 6672 6f6d 2073 6b6c 6561  ssion.from sklea
+00012f40: 726e 2e63 6f6d 706f 7365 2069 6d70 6f72  rn.compose impor
+00012f50: 7420 6d61 6b65 5f63 6f6c 756d 6e5f 7472  t make_column_tr
+00012f60: 616e 7366 6f72 6d65 720a 6672 6f6d 2073  ansformer.from s
+00012f70: 6b6c 6561 726e 2e70 7265 7072 6f63 6573  klearn.preproces
+00012f80: 7369 6e67 2069 6d70 6f72 7420 4c61 6265  sing import Labe
+00012f90: 6c45 6e63 6f64 6572 2c20 4c61 6265 6c42  lEncoder, LabelB
+00012fa0: 696e 6172 697a 6572 0a69 6d70 6f72 7420  inarizer.import 
+00012fb0: 7064 620a 6672 6f6d 2063 6f6c 6c65 6374  pdb.from collect
+00012fc0: 696f 6e73 2069 6d70 6f72 7420 6465 6661  ions import defa
+00012fd0: 756c 7464 6963 742c 2043 6f75 6e74 6572  ultdict, Counter
+00012fe0: 0a23 2323 2054 6865 7365 2069 6d70 6f72  .### These impor
+00012ff0: 7473 2067 6976 6520 6669 745f 7472 616e  ts give fit_tran
+00013000: 7366 6f72 6d20 6d65 7468 6f64 2066 6f72  sform method for
+00013010: 2066 7265 6520 2323 230a 6672 6f6d 2073   free ###.from s
+00013020: 6b6c 6561 726e 2e62 6173 6520 696d 706f  klearn.base impo
+00013030: 7274 2042 6173 6545 7374 696d 6174 6f72  rt BaseEstimator
+00013040: 2c20 5472 616e 7366 6f72 6d65 724d 6978  , TransformerMix
+00013050: 696e 200a 6672 6f6d 2073 6b6c 6561 726e  in .from sklearn
+00013060: 2e75 7469 6c73 2e76 616c 6964 6174 696f  .utils.validatio
+00013070: 6e20 696d 706f 7274 2063 6f6c 756d 6e5f  n import column_
+00013080: 6f72 5f31 640a 6672 6f6d 2073 6b6c 6561  or_1d.from sklea
+00013090: 726e 2e62 6173 6520 696d 706f 7274 2052  rn.base import R
+000130a0: 6567 7265 7373 6f72 4d69 7869 6e2c 2043  egressorMixin, C
+000130b0: 6c61 7373 6966 6965 724d 6978 696e 0a66  lassifierMixin.f
+000130c0: 726f 6d20 736b 6c65 6172 6e2e 7072 6570  rom sklearn.prep
+000130d0: 726f 6365 7373 696e 6720 696d 706f 7274  rocessing import
+000130e0: 2046 756e 6374 696f 6e54 7261 6e73 666f   FunctionTransfo
+000130f0: 726d 6572 0a66 726f 6d20 736b 6c65 6172  rmer.from sklear
+00013100: 6e2e 7072 6570 726f 6365 7373 696e 6720  n.preprocessing 
+00013110: 696d 706f 7274 204d 6178 4162 7353 6361  import MaxAbsSca
+00013120: 6c65 722c 2053 7461 6e64 6172 6453 6361  ler, StandardSca
+00013130: 6c65 722c 204d 696e 4d61 7853 6361 6c65  ler, MinMaxScale
+00013140: 720a 6672 6f6d 2073 6b6c 6561 726e 2e70  r.from sklearn.p
+00013150: 7265 7072 6f63 6573 7369 6e67 2069 6d70  reprocessing imp
+00013160: 6f72 7420 526f 6275 7374 5363 616c 6572  ort RobustScaler
+00013170: 0a66 726f 6d20 736b 6c65 6172 6e2e 656e  .from sklearn.en
+00013180: 7365 6d62 6c65 2069 6d70 6f72 7420 5261  semble import Ra
+00013190: 6e64 6f6d 466f 7265 7374 436c 6173 7369  ndomForestClassi
+000131a0: 6669 6572 2c20 5261 6e64 6f6d 466f 7265  fier, RandomFore
+000131b0: 7374 5265 6772 6573 736f 720a 6672 6f6d  stRegressor.from
+000131c0: 2073 6b6c 6561 726e 2e74 7265 6520 696d   sklearn.tree im
+000131d0: 706f 7274 2045 7874 7261 5472 6565 5265  port ExtraTreeRe
+000131e0: 6772 6573 736f 722c 2045 7874 7261 5472  gressor, ExtraTr
+000131f0: 6565 436c 6173 7369 6669 6572 0a66 726f  eeClassifier.fro
+00013200: 6d20 736b 6c65 6172 6e2e 6465 636f 6d70  m sklearn.decomp
+00013210: 6f73 6974 696f 6e20 696d 706f 7274 2054  osition import T
+00013220: 7275 6e63 6174 6564 5356 440a 6672 6f6d  runcatedSVD.from
+00013230: 2073 6b6c 6561 726e 2e6d 6f64 656c 5f73   sklearn.model_s
+00013240: 656c 6563 7469 6f6e 2069 6d70 6f72 7420  election import 
+00013250: 4772 6964 5365 6172 6368 4356 2c20 5261  GridSearchCV, Ra
+00013260: 6e64 6f6d 697a 6564 5365 6172 6368 4356  ndomizedSearchCV
+00013270: 0a66 726f 6d20 736b 6c65 6172 6e2e 6d65  .from sklearn.me
+00013280: 7472 6963 7320 696d 706f 7274 206d 6561  trics import mea
+00013290: 6e5f 7371 7561 7265 645f 6c6f 675f 6572  n_squared_log_er
+000132a0: 726f 722c 206d 6561 6e5f 7371 7561 7265  ror, mean_square
+000132b0: 645f 6572 726f 722c 6261 6c61 6e63 6564  d_error,balanced
+000132c0: 5f61 6363 7572 6163 795f 7363 6f72 650a  _accuracy_score.
+000132d0: 696d 706f 7274 2067 630a 2323 2323 2323  import gc.######
+000132e0: 2323 2323 2323 2323 2020 5468 6573 6520  ########  These 
+000132f0: 696d 706f 7274 7320 6172 6520 746f 206d  imports are to m
+00013300: 616b 6520 7472 6f75 626c 6520 7368 6f6f  ake trouble shoo
+00013310: 7469 6e67 2065 6173 6965 7220 2323 2323  ting easier ####
+00013320: 230a 696d 706f 7274 2074 696d 650a 696d  #.import time.im
+00013330: 706f 7274 2063 6f70 790a 696d 706f 7274  port copy.import
+00013340: 206f 730a 696d 706f 7274 2070 6963 6b6c   os.import pickl
+00013350: 650a 696d 706f 7274 2073 6369 7079 0a69  e.import scipy.i
+00013360: 6d70 6f72 7420 7761 726e 696e 6773 0a77  mport warnings.w
+00013370: 6172 6e69 6e67 732e 6669 6c74 6572 7761  arnings.filterwa
+00013380: 726e 696e 6773 2822 6967 6e6f 7265 2229  rnings("ignore")
+00013390: 0a23 2323 2323 2323 2323 2323 2323 2323  .###############
+000133a0: 2323 2323 2323 2323 2323 2323 2323 2323  ################
+000133b0: 2323 2323 2323 2323 2323 2323 2323 2323  ################
+000133c0: 2323 2323 2323 2323 2323 230a 6672 6f6d  ###########.from
+000133d0: 2063 6174 6567 6f72 795f 656e 636f 6465   category_encode
+000133e0: 7273 2069 6d70 6f72 7420 4861 7368 696e  rs import Hashin
+000133f0: 6745 6e63 6f64 6572 2c20 506f 6c79 6e6f  gEncoder, Polyno
+00013400: 6d69 616c 456e 636f 6465 722c 2042 6163  mialEncoder, Bac
+00013410: 6b77 6172 6444 6966 6665 7265 6e63 6545  kwardDifferenceE
+00013420: 6e63 6f64 6572 0a66 726f 6d20 6361 7465  ncoder.from cate
+00013430: 676f 7279 5f65 6e63 6f64 6572 732e 7375  gory_encoders.su
+00013440: 6d5f 636f 6469 6e67 2069 6d70 6f72 7420  m_coding import 
+00013450: 5375 6d45 6e63 6f64 6572 0a66 726f 6d20  SumEncoder.from 
+00013460: 6361 7465 676f 7279 5f65 6e63 6f64 6572  category_encoder
+00013470: 732e 6c65 6176 655f 6f6e 655f 6f75 7420  s.leave_one_out 
+00013480: 696d 706f 7274 204c 6561 7665 4f6e 654f  import LeaveOneO
+00013490: 7574 456e 636f 6465 720a 6672 6f6d 2063  utEncoder.from c
+000134a0: 6174 6567 6f72 795f 656e 636f 6465 7273  ategory_encoders
+000134b0: 2069 6d70 6f72 7420 4865 6c6d 6572 7445   import HelmertE
+000134c0: 6e63 6f64 6572 2c20 4f72 6469 6e61 6c45  ncoder, OrdinalE
+000134d0: 6e63 6f64 6572 2c20 436f 756e 7445 6e63  ncoder, CountEnc
+000134e0: 6f64 6572 2c20 4261 7365 4e45 6e63 6f64  oder, BaseNEncod
+000134f0: 6572 0a66 726f 6d20 6361 7465 676f 7279  er.from category
+00013500: 5f65 6e63 6f64 6572 7320 696d 706f 7274  _encoders import
+00013510: 2054 6172 6765 7445 6e63 6f64 6572 2c20   TargetEncoder, 
+00013520: 4361 7442 6f6f 7374 456e 636f 6465 722c  CatBoostEncoder,
+00013530: 2057 4f45 456e 636f 6465 722c 204a 616d   WOEEncoder, Jam
+00013540: 6573 5374 6569 6e45 6e63 6f64 6572 0a66  esSteinEncoder.f
+00013550: 726f 6d20 6361 7465 676f 7279 5f65 6e63  rom category_enc
+00013560: 6f64 6572 732e 676c 6d6d 2069 6d70 6f72  oders.glmm impor
+00013570: 7420 474c 4d4d 456e 636f 6465 720a 6672  t GLMMEncoder.fr
+00013580: 6f6d 2073 6b6c 6561 726e 2e70 7265 7072  om sklearn.prepr
+00013590: 6f63 6573 7369 6e67 2069 6d70 6f72 7420  ocessing import 
+000135a0: 4c61 6265 6c45 6e63 6f64 6572 0a66 726f  LabelEncoder.fro
+000135b0: 6d20 6361 7465 676f 7279 5f65 6e63 6f64  m category_encod
+000135c0: 6572 732e 7772 6170 7065 7220 696d 706f  ers.wrapper impo
+000135d0: 7274 2050 6f6c 796e 6f6d 6961 6c57 7261  rt PolynomialWra
+000135e0: 7070 6572 0a66 726f 6d20 6361 7465 676f  pper.from catego
+000135f0: 7279 5f65 6e63 6f64 6572 7320 696d 706f  ry_encoders impo
+00013600: 7274 204f 6e65 486f 7445 6e63 6f64 6572  rt OneHotEncoder
+00013610: 0a66 726f 6d20 696d 626c 6561 726e 2e6f  .from imblearn.o
+00013620: 7665 725f 7361 6d70 6c69 6e67 2069 6d70  ver_sampling imp
+00013630: 6f72 7420 534d 4f54 452c 2042 6f72 6465  ort SMOTE, Borde
+00013640: 726c 696e 6553 4d4f 5445 2c20 534d 4f54  rlineSMOTE, SMOT
+00013650: 454e 430a 6672 6f6d 2073 6b6c 6561 726e  ENC.from sklearn
+00013660: 2e70 6970 656c 696e 6520 696d 706f 7274  .pipeline import
+00013670: 206d 616b 655f 7069 7065 6c69 6e65 2c20   make_pipeline, 
+00013680: 5069 7065 6c69 6e65 0a23 6672 6f6d 2073  Pipeline.#from s
+00013690: 6b6c 6561 726e 2e70 7265 7072 6f63 6573  klearn.preproces
+000136a0: 7369 6e67 2069 6d70 6f72 7420 4f6e 6548  sing import OneH
+000136b0: 6f74 456e 636f 6465 720a 6672 6f6d 2074  otEncoder.from t
+000136c0: 7164 6d20 696d 706f 7274 2074 7164 6d0a  qdm import tqdm.
+000136d0: 6672 6f6d 2073 6b6c 6561 726e 2e6d 6f64  from sklearn.mod
+000136e0: 656c 5f73 656c 6563 7469 6f6e 2069 6d70  el_selection imp
+000136f0: 6f72 7420 5469 6d65 5365 7269 6573 5370  ort TimeSeriesSp
+00013700: 6c69 740a 696d 706f 7274 206e 756d 7079  lit.import numpy
+00013710: 2061 7320 6e70 0a69 6d70 6f72 7420 7061   as np.import pa
+00013720: 6e64 6173 2061 7320 7064 0a23 2323 2323  ndas as pd.#####
+00013730: 2323 2323 2323 2323 2323 2323 2323 2323  ################
+00013740: 2323 2323 2323 2323 2323 2323 2323 2323  ################
+00013750: 2323 2323 2323 2323 2323 2323 2323 2323  ################
+00013760: 2323 2323 2323 2323 2323 2323 2323 2323  ################
+00013770: 2323 2323 2323 2323 2323 230a 696d 706f  ###########.impo
+00013780: 7274 2077 6172 6e69 6e67 730a 7761 726e  rt warnings.warn
+00013790: 696e 6773 2e66 696c 7465 7277 6172 6e69  ings.filterwarni
+000137a0: 6e67 7328 2269 676e 6f72 6522 290a 6672  ngs("ignore").fr
+000137b0: 6f6d 2073 6b6c 6561 726e 2e65 7863 6570  om sklearn.excep
+000137c0: 7469 6f6e 7320 696d 706f 7274 2044 6174  tions import Dat
+000137d0: 6143 6f6e 7665 7273 696f 6e57 6172 6e69  aConversionWarni
+000137e0: 6e67 0a77 6172 6e69 6e67 732e 6669 6c74  ng.warnings.filt
+000137f0: 6572 7761 726e 696e 6773 2861 6374 696f  erwarnings(actio
+00013800: 6e3d 2769 676e 6f72 6527 2c20 6361 7465  n='ignore', cate
+00013810: 676f 7279 3d44 6174 6143 6f6e 7665 7273  gory=DataConvers
+00013820: 696f 6e57 6172 6e69 6e67 290a 7769 7468  ionWarning).with
+00013830: 2077 6172 6e69 6e67 732e 6361 7463 685f   warnings.catch_
+00013840: 7761 726e 696e 6773 2829 3a0a 2020 2020  warnings():.    
+00013850: 7761 726e 696e 6773 2e73 696d 706c 6566  warnings.simplef
+00013860: 696c 7465 7228 2269 676e 6f72 6522 290a  ilter("ignore").
+00013870: 2323 2323 2323 2323 2323 2323 2323 2323  ################
+00013880: 2323 2323 2323 2323 2323 2323 2323 2323  ################
+00013890: 2323 2323 2323 2323 2323 2323 2323 2323  ################
+000138a0: 2323 2323 2323 2323 2323 2323 2323 2323  ################
+000138b0: 2323 2323 2323 2323 2323 2323 2323 2323  ################
+000138c0: 0a69 6d70 6f72 7420 6d61 7468 0a66 726f  .import math.fro
+000138d0: 6d20 636f 6c6c 6563 7469 6f6e 7320 696d  m collections im
+000138e0: 706f 7274 2043 6f75 6e74 6572 0a66 726f  port Counter.fro
+000138f0: 6d20 736b 6c65 6172 6e2e 6c69 6e65 6172  m sklearn.linear
+00013900: 5f6d 6f64 656c 2069 6d70 6f72 7420 5269  _model import Ri
+00013910: 6467 652c 204c 6173 736f 2c20 5269 6467  dge, Lasso, Ridg
+00013920: 6543 560a 6672 6f6d 2073 6b6c 6561 726e  eCV.from sklearn
+00013930: 2e74 7265 6520 696d 706f 7274 2044 6563  .tree import Dec
+00013940: 6973 696f 6e54 7265 6543 6c61 7373 6966  isionTreeClassif
+00013950: 6965 722c 2044 6563 6973 696f 6e54 7265  ier, DecisionTre
+00013960: 6552 6567 7265 7373 6f72 0a66 726f 6d20  eRegressor.from 
+00013970: 736b 6c65 6172 6e2e 656e 7365 6d62 6c65  sklearn.ensemble
+00013980: 2069 6d70 6f72 7420 5261 6e64 6f6d 466f   import RandomFo
+00013990: 7265 7374 436c 6173 7369 6669 6572 2c20  restClassifier, 
+000139a0: 5261 6e64 6f6d 466f 7265 7374 5265 6772  RandomForestRegr
+000139b0: 6573 736f 722c 2041 6461 426f 6f73 7443  essor, AdaBoostC
+000139c0: 6c61 7373 6966 6965 720a 6672 6f6d 2073  lassifier.from s
+000139d0: 6b6c 6561 726e 2e65 6e73 656d 626c 6520  klearn.ensemble 
+000139e0: 696d 706f 7274 2045 7874 7261 5472 6565  import ExtraTree
+000139f0: 7343 6c61 7373 6966 6965 722c 2045 7874  sClassifier, Ext
+00013a00: 7261 5472 6565 7352 6567 7265 7373 6f72  raTreesRegressor
+00013a10: 0a66 726f 6d20 736b 6c65 6172 6e2e 6c69  .from sklearn.li
+00013a20: 6e65 6172 5f6d 6f64 656c 2069 6d70 6f72  near_model impor
+00013a30: 7420 4c6f 6769 7374 6963 5265 6772 6573  t LogisticRegres
+00013a40: 7369 6f6e 2c20 4c6f 6769 7374 6963 5265  sion, LogisticRe
+00013a50: 6772 6573 7369 6f6e 4356 0a66 726f 6d20  gressionCV.from 
+00013a60: 736b 6c65 6172 6e2e 6d75 6c74 6963 6c61  sklearn.multicla
+00013a70: 7373 2069 6d70 6f72 7420 4f6e 6556 7352  ss import OneVsR
+00013a80: 6573 7443 6c61 7373 6966 6965 722c 204f  estClassifier, O
+00013a90: 6e65 5673 4f6e 6543 6c61 7373 6966 6965  neVsOneClassifie
+00013aa0: 720a 6672 6f6d 2073 6b6c 6561 726e 2e6d  r.from sklearn.m
+00013ab0: 6574 7269 6373 2069 6d70 6f72 7420 6163  etrics import ac
+00013ac0: 6375 7261 6379 5f73 636f 7265 0a66 726f  curacy_score.fro
+00013ad0: 6d20 736b 6c65 6172 6e2e 6d6f 6465 6c5f  m sklearn.model_
+00013ae0: 7365 6c65 6374 696f 6e20 696d 706f 7274  selection import
+00013af0: 204b 466f 6c64 2c20 5374 7261 7469 6669   KFold, Stratifi
+00013b00: 6564 4b46 6f6c 640a 696d 706f 7274 2074  edKFold.import t
+00013b10: 696d 650a 6672 6f6d 2073 6b6c 6561 726e  ime.from sklearn
+00013b20: 2e63 6c75 7374 6572 2069 6d70 6f72 7420  .cluster import 
+00013b30: 4b4d 6561 6e73 0a66 726f 6d20 6d61 7470  KMeans.from matp
+00013b40: 6c6f 746c 6962 2e70 7970 6c6f 7420 696d  lotlib.pyplot im
+00013b50: 706f 7274 2066 6967 7572 650a 6672 6f6d  port figure.from
+00013b60: 2073 6b6c 6561 726e 2e6d 6574 7269 6373   sklearn.metrics
+00013b70: 2e63 6c75 7374 6572 2069 6d70 6f72 7420  .cluster import 
+00013b80: 6e6f 726d 616c 697a 6564 5f6d 7574 7561  normalized_mutua
+00013b90: 6c5f 696e 666f 5f73 636f 7265 0a66 726f  l_info_score.fro
+00013ba0: 6d20 736b 6c65 6172 6e2e 6d65 7472 6963  m sklearn.metric
+00013bb0: 7320 696d 706f 7274 2062 616c 616e 6365  s import balance
+00013bc0: 645f 6163 6375 7261 6379 5f73 636f 7265  d_accuracy_score
+00013bd0: 0a66 726f 6d20 736b 6c65 6172 6e2e 656e  .from sklearn.en
+00013be0: 7365 6d62 6c65 2069 6d70 6f72 7420 566f  semble import Vo
+00013bf0: 7469 6e67 5265 6772 6573 736f 722c 2056  tingRegressor, V
+00013c00: 6f74 696e 6743 6c61 7373 6966 6965 720a  otingClassifier.
+00013c10: 696d 706f 7274 2063 6f70 790a 6672 6f6d  import copy.from
+00013c20: 2073 6b6c 6561 726e 2e62 6173 6520 696d   sklearn.base im
+00013c30: 706f 7274 2042 6173 6545 7374 696d 6174  port BaseEstimat
+00013c40: 6f72 2c20 5472 616e 7366 6f72 6d65 724d  or, TransformerM
+00013c50: 6978 696e 2c20 5265 6772 6573 736f 724d  ixin, RegressorM
+00013c60: 6978 696e 2c20 636c 6f6e 650a 6672 6f6d  ixin, clone.from
+00013c70: 2073 6b6c 6561 726e 2e62 6173 6520 696d   sklearn.base im
+00013c80: 706f 7274 2043 6c61 7373 6966 6965 724d  port ClassifierM
+00013c90: 6978 696e 2c20 5265 6772 6573 736f 724d  ixin, RegressorM
+00013ca0: 6978 696e 0a66 726f 6d20 696d 626c 6561  ixin.from imblea
+00013cb0: 726e 2e6f 7665 725f 7361 6d70 6c69 6e67  rn.over_sampling
+00013cc0: 2069 6d70 6f72 7420 534d 4f54 454e 432c   import SMOTENC,
+00013cd0: 2041 4441 5359 4e0a 6672 6f6d 2069 6d62   ADASYN.from imb
+00013ce0: 6c65 6172 6e2e 6f76 6572 5f73 616d 706c  learn.over_sampl
+00013cf0: 696e 6720 696d 706f 7274 2053 4d4f 5445  ing import SMOTE
+00013d00: 2c20 5356 4d53 4d4f 5445 0a66 726f 6d20  , SVMSMOTE.from 
+00013d10: 696d 626c 6561 726e 2e63 6f6d 6269 6e65  imblearn.combine
+00013d20: 2069 6d70 6f72 7420 534d 4f54 4554 6f6d   import SMOTETom
+00013d30: 656b 200a 696d 706f 7274 206c 6967 6874  ek .import light
+00013d40: 6762 6d0a 6672 6f6d 206c 6967 6874 6762  gbm.from lightgb
+00013d50: 6d20 696d 706f 7274 204c 4742 4d43 6c61  m import LGBMCla
+00013d60: 7373 6966 6965 722c 204c 4742 4d52 6567  ssifier, LGBMReg
+00013d70: 7265 7373 6f72 0a66 726f 6d20 7867 626f  ressor.from xgbo
+00013d80: 6f73 7420 696d 706f 7274 2058 4742 5265  ost import XGBRe
+00013d90: 6772 6573 736f 722c 2058 4742 436c 6173  gressor, XGBClas
+00013da0: 7369 6669 6572 0a66 726f 6d20 736b 6c65  sifier.from skle
+00013db0: 6172 6e2e 6d75 6c74 696f 7574 7075 7420  arn.multioutput 
+00013dc0: 696d 706f 7274 204d 756c 7469 4f75 7470  import MultiOutp
+00013dd0: 7574 5265 6772 6573 736f 722c 204d 756c  utRegressor, Mul
+00013de0: 7469 4f75 7470 7574 436c 6173 7369 6669  tiOutputClassifi
+00013df0: 6572 0a66 726f 6d20 736b 6c65 6172 6e2e  er.from sklearn.
+00013e00: 6d75 6c74 696f 7574 7075 7420 696d 706f  multioutput impo
+00013e10: 7274 2043 6c61 7373 6966 6965 7243 6861  rt ClassifierCha
+00013e20: 696e 2c20 5265 6772 6573 736f 7243 6861  in, RegressorCha
+00013e30: 696e 0a69 6d70 6f72 7420 7363 6970 7920  in.import scipy 
+00013e40: 6173 2073 700a 696d 706f 7274 2070 6462  as sp.import pdb
+00013e50: 0a66 726f 6d20 736b 6c65 6172 6e2e 7365  .from sklearn.se
+00013e60: 6d69 5f73 7570 6572 7669 7365 6420 696d  mi_supervised im
+00013e70: 706f 7274 204c 6162 656c 5072 6f70 6167  port LabelPropag
+00013e80: 6174 696f 6e0a 6672 6f6d 2073 6b6c 6561  ation.from sklea
+00013e90: 726e 2e65 6e73 656d 626c 6520 696d 706f  rn.ensemble impo
+00013ea0: 7274 2042 6167 6769 6e67 436c 6173 7369  rt BaggingClassi
+00013eb0: 6669 6572 2c20 4261 6767 696e 6752 6567  fier, BaggingReg
+00013ec0: 7265 7373 6f72 0a66 726f 6d20 736b 6c65  ressor.from skle
+00013ed0: 6172 6e2e 7376 6d20 696d 706f 7274 2053  arn.svm import S
+00013ee0: 5652 2c20 4c69 6e65 6172 5356 520a 6672  VR, LinearSVR.fr
+00013ef0: 6f6d 2073 6b6c 6561 726e 2e70 6970 656c  om sklearn.pipel
+00013f00: 696e 6520 696d 706f 7274 2050 6970 656c  ine import Pipel
+00013f10: 696e 650a 6672 6f6d 2073 6b6c 6561 726e  ine.from sklearn
+00013f20: 2e69 6d70 7574 6520 696d 706f 7274 2053  .impute import S
+00013f30: 696d 706c 6549 6d70 7574 6572 2c20 4d69  impleImputer, Mi
+00013f40: 7373 696e 6749 6e64 6963 6174 6f72 0a23  ssingIndicator.#
+00013f50: 6672 6f6d 2073 6b6c 6561 726e 2e70 7265  from sklearn.pre
+00013f60: 7072 6f63 6573 7369 6e67 2069 6d70 6f72  processing impor
+00013f70: 7420 5374 616e 6461 7264 5363 616c 6572  t StandardScaler
+00013f80: 2c20 4f6e 6548 6f74 456e 636f 6465 722c  , OneHotEncoder,
+00013f90: 204c 6162 656c 456e 636f 6465 720a 6672   LabelEncoder.fr
+00013fa0: 6f6d 2073 6b6c 6561 726e 2e63 6f6d 706f  om sklearn.compo
+00013fb0: 7365 2069 6d70 6f72 7420 436f 6c75 6d6e  se import Column
+00013fc0: 5472 616e 7366 6f72 6d65 720a 6672 6f6d  Transformer.from
+00013fd0: 2073 6369 7079 2e73 7461 7473 2069 6d70   scipy.stats imp
+00013fe0: 6f72 7420 756e 6966 6f72 6d20 6173 2073  ort uniform as s
+00013ff0: 705f 7261 6e64 466c 6f61 740a 6672 6f6d  p_randFloat.from
+00014000: 2073 6369 7079 2e73 7461 7473 2069 6d70   scipy.stats imp
+00014010: 6f72 7420 7261 6e64 696e 7420 6173 2073  ort randint as s
+00014020: 705f 7261 6e64 496e 740a 6672 6f6d 2073  p_randInt.from s
+00014030: 6b6c 6561 726e 2e6d 6574 7269 6373 2069  klearn.metrics i
+00014040: 6d70 6f72 7420 6d65 616e 5f61 6273 6f6c  mport mean_absol
+00014050: 7574 655f 6572 726f 722c 206d 6561 6e5f  ute_error, mean_
+00014060: 7371 7561 7265 645f 6572 726f 720a 6672  squared_error.fr
+00014070: 6f6d 2069 7465 7274 6f6f 6c73 2069 6d70  om itertools imp
+00014080: 6f72 7420 6379 636c 650a 696d 706f 7274  ort cycle.import
+00014090: 206d 6174 706c 6f74 6c69 622e 7079 706c   matplotlib.pypl
+000140a0: 6f74 2061 7320 706c 740a 0a23 2323 2323  ot as plt..#####
+000140b0: 2323 2323 2323 2323 2323 2323 2323 2323  ################
+000140c0: 2323 2323 2323 2323 2323 2323 2323 2323  ################
+000140d0: 2323 2323 2323 2323 2323 2323 2323 2323  ################
+000140e0: 2323 2323 0a63 6c61 7373 204d 795f 4c61  ####.class My_La
+000140f0: 6265 6c45 6e63 6f64 6572 2842 6173 6545  belEncoder(BaseE
+00014100: 7374 696d 6174 6f72 2c20 5472 616e 7366  stimator, Transf
+00014110: 6f72 6d65 724d 6978 696e 293a 0a20 2020  ormerMixin):.   
+00014120: 2022 2222 0a20 2020 2023 2323 2323 2323   """.    #######
+00014130: 2323 2323 2323 2323 2323 2323 2323 2323  ################
+00014140: 2323 2323 2323 2323 2323 2323 2323 2323  ################
+00014150: 2323 2323 2323 2323 2323 2323 2323 2323  ################
+00014160: 2323 2323 2323 2323 2323 2323 2323 2323  ################
+00014170: 2323 2323 2323 2323 2323 2323 2323 2323  ################
+00014180: 2323 2323 2323 2323 230a 2020 2020 2323  #########.    ##
+00014190: 2323 2323 2020 2020 2054 6865 204d 795f  ####     The My_
+000141a0: 4c61 6265 6c45 6e63 6f64 6572 2063 6c61  LabelEncoder cla
+000141b0: 7373 2077 6f72 6b73 206a 7573 7420 6c69  ss works just li
+000141c0: 6b65 2073 6b6c 6561 726e 2773 204c 6162  ke sklearn's Lab
+000141d0: 656c 2045 6e63 6f64 6572 2062 7574 2062  el Encoder but b
+000141e0: 6574 7465 7221 2023 2323 2323 2323 0a20  etter! #######. 
+000141f0: 2020 2023 2323 2323 2020 4974 206c 6162     #####  It lab
+00014200: 656c 2065 6e63 6f64 6573 2061 6e79 206f  el encodes any o
+00014210: 626a 6563 7420 6f72 2063 6174 6567 6f72  bject or categor
+00014220: 7920 6474 7970 6520 696e 2079 6f75 7220  y dtype in your 
+00014230: 6461 7461 7365 742e 2049 7420 616c 736f  dataset. It also
+00014240: 2068 616e 646c 6573 204e 614e 2773 2e23   handles NaN's.#
+00014250: 2323 230a 2020 2020 2323 2020 5468 6520  ###.    ##  The 
+00014260: 6265 6175 7479 206f 6620 7468 6973 2066  beauty of this f
+00014270: 756e 6374 696f 6e20 6973 2074 6861 7420  unction is that 
+00014280: 6974 2074 616b 6573 2063 6172 6520 6f66  it takes care of
+00014290: 2065 6e63 6f64 696e 6720 756e 6b6e 6f77   encoding unknow
+000142a0: 6e20 2866 7574 7572 6529 2076 616c 7565  n (future) value
+000142b0: 732e 2023 2323 2323 0a20 2020 2023 2323  s. #####.    ###
+000142c0: 2323 2323 2323 2323 2323 2323 2323 2323  ################
+000142d0: 2323 2054 6869 7320 6973 2074 6865 2042  ## This is the B
+000142e0: 4553 5420 776f 726b 696e 6720 7665 7273  EST working vers
+000142f0: 696f 6e20 2d20 646f 6e27 7420 6d65 7373  ion - don't mess
+00014300: 2077 6974 6820 6974 2121 2023 2323 2323   with it!! #####
+00014310: 2323 2323 2323 2323 2323 2323 230a 2020  #############.  
+00014320: 2020 2323 2323 2323 2323 2323 2323 2323    ##############
+00014330: 2323 2323 2323 2323 2323 2323 2323 2323  ################
+00014340: 2323 2323 2323 2323 2323 2323 2323 2323  ################
+00014350: 2323 2323 2323 2323 2323 2323 2323 2323  ################
+00014360: 2323 2323 2323 2323 2323 2323 2323 2323  ################
+00014370: 2323 2323 2323 2323 2323 2323 2323 2323  ################
+00014380: 2323 0a20 2020 2055 7361 6765 3a0a 2020  ##.    Usage:.  
+00014390: 2020 2020 2020 2020 6c65 203d 204d 795f          le = My_
+000143a0: 4c61 6265 6c45 6e63 6f64 6572 2829 0a20  LabelEncoder(). 
+000143b0: 2020 2020 2020 2020 206c 652e 6669 745f           le.fit_
+000143c0: 7472 616e 7366 6f72 6d28 7472 6169 6e5b  transform(train[
+000143d0: 636f 6c75 6d6e 5d29 2023 2320 7468 6973  column]) ## this
+000143e0: 2077 696c 6c20 6769 7665 2079 6f75 7220   will give your 
+000143f0: 7472 616e 7366 6f72 6d65 6420 7661 6c75  transformed valu
+00014400: 6573 2061 7320 616e 2061 7272 6179 0a20  es as an array. 
+00014410: 2020 2020 2020 2020 206c 652e 7472 616e           le.tran
+00014420: 7366 6f72 6d28 7465 7374 5b63 6f6c 756d  sform(test[colum
+00014430: 6e5d 2920 2323 2320 7468 6973 2077 696c  n]) ### this wil
+00014440: 6c20 6769 7665 2079 6f75 7220 7472 616e  l give your tran
+00014450: 7366 6f72 6d65 6420 7661 6c75 6573 2061  sformed values a
+00014460: 7320 616e 2061 7272 6179 0a20 2020 2020  s an array.     
+00014470: 2020 2020 2020 2020 200a 2020 2020 5573           .    Us
+00014480: 6167 6520 696e 2043 6f6c 756d 6e20 5472  age in Column Tr
+00014490: 616e 7366 6f72 6d65 7273 2061 6e64 2050  ansformers and P
+000144a0: 6970 656c 696e 6573 3a0a 2020 2020 2020  ipelines:.      
+000144b0: 2020 2020 4e6f 2e20 4974 2063 616e 6e6f      No. It canno
+000144c0: 7420 6265 2075 7365 6420 696e 2070 6970  t be used in pip
+000144d0: 656c 696e 6573 2073 696e 6365 2069 7420  elines since it 
+000144e0: 6e65 6564 2074 6f20 7072 6f64 7563 6520  need to produce 
+000144f0: 7477 6f20 636f 6c75 6d6e 7320 666f 7220  two columns for 
+00014500: 7468 6520 6e65 7874 2073 7461 6765 2069  the next stage i
+00014510: 6e20 7069 7065 6c69 6e65 2e0a 2020 2020  n pipeline..    
+00014520: 2020 2020 2020 5365 6520 6d79 206f 7468        See my oth
+00014530: 6572 206d 6f64 756c 6520 6361 6c6c 6564  er module called
+00014540: 204d 795f 4c61 6265 6c45 6e63 6f64 6572   My_LabelEncoder
+00014550: 5f50 6970 6528 2920 746f 2073 6565 2068  _Pipe() to see h
+00014560: 6f77 2069 7420 6361 6e20 6265 2075 7365  ow it can be use
+00014570: 6420 696e 2050 6970 656c 696e 6573 2e0a  d in Pipelines..
+00014580: 2020 2020 2222 220a 2020 2020 6465 6620      """.    def 
+00014590: 5f5f 696e 6974 5f5f 2873 656c 6629 3a0a  __init__(self):.
+000145a0: 2020 2020 2020 2020 7365 6c66 2e74 7261          self.tra
+000145b0: 6e73 666f 726d 6572 203d 2064 6566 6175  nsformer = defau
+000145c0: 6c74 6469 6374 2873 7472 290a 2020 2020  ltdict(str).    
+000145d0: 2020 2020 7365 6c66 2e69 6e76 6572 7365      self.inverse
+000145e0: 5f74 7261 6e73 666f 726d 6572 203d 2064  _transformer = d
+000145f0: 6566 6175 6c74 6469 6374 2873 7472 290a  efaultdict(str).
+00014600: 2020 2020 2020 2020 7365 6c66 2e6d 6178          self.max
+00014610: 5f76 616c 203d 2030 0a20 2020 2020 2020  _val = 0.       
+00014620: 200a 2020 2020 6465 6620 6669 7428 7365   .    def fit(se
+00014630: 6c66 2c74 6573 7478 2c20 793d 4e6f 6e65  lf,testx, y=None
+00014640: 293a 0a20 2020 2020 2020 2023 2323 2044  ):.        ### D
+00014650: 6f20 6e6f 7420 6368 616e 6765 2074 6869  o not change thi
+00014660: 7320 7369 6e63 6520 5261 7265 2063 6c61  s since Rare cla
+00014670: 7373 2063 6f6d 6269 6e65 7220 7265 7175  ss combiner requ
+00014680: 6972 6573 2074 6869 7320 7465 7374 2023  ires this test #
+00014690: 230a 2020 2020 2020 2020 6966 2069 7369  #.        if isi
+000146a0: 6e73 7461 6e63 6528 7465 7374 782c 2074  nstance(testx, t
+000146b0: 7570 6c65 293a 0a20 2020 2020 2020 2020  uple):.         
+000146c0: 2020 2079 203d 2074 6573 7478 5b31 5d0a     y = testx[1].
+000146d0: 2020 2020 2020 2020 2020 2020 7465 7374              test
+000146e0: 7820 3d20 7465 7374 785b 305d 0a20 2020  x = testx[0].   
+000146f0: 2020 2020 2023 2320 7465 7374 7820 6d75       ## testx mu
+00014700: 7374 2073 7469 6c6c 2062 6520 6120 7064  st still be a pd
+00014710: 2e53 6572 6965 7320 666f 7220 7468 6973  .Series for this
+00014720: 2065 6e63 6f64 6572 2074 6f20 776f 726b   encoder to work
+00014730: 210a 2020 2020 2020 2020 6966 2069 7369  !.        if isi
+00014740: 6e73 7461 6e63 6528 7465 7374 782c 2070  nstance(testx, p
+00014750: 642e 5365 7269 6573 293a 0a20 2020 2020  d.Series):.     
+00014760: 2020 2020 2020 2070 6173 730a 2020 2020         pass.    
+00014770: 2020 2020 656c 6966 2069 7369 6e73 7461      elif isinsta
+00014780: 6e63 6528 7465 7374 782c 206e 702e 6e64  nce(testx, np.nd
+00014790: 6172 7261 7929 3a0a 2020 2020 2020 2020  array):.        
+000147a0: 2020 2020 7465 7374 7820 3d20 7064 2e53      testx = pd.S
+000147b0: 6572 6965 7328 7465 7374 7829 0a20 2020  eries(testx).   
+000147c0: 2020 2020 2065 6c73 653a 0a20 2020 2020       else:.     
+000147d0: 2020 2020 2020 2023 2323 2320 5468 6572         #### Ther
+000147e0: 6520 6973 206e 6f20 7761 7920 746f 2074  e is no way to t
+000147f0: 7261 6e73 666f 726d 2064 6174 6166 7261  ransform datafra
+00014800: 6d65 7320 7369 6e63 6520 796f 7520 7769  mes since you wi
+00014810: 6c6c 2067 6574 2061 206e 6573 7465 6420  ll get a nested 
+00014820: 7265 6e61 6d65 7220 6572 726f 7220 6966  renamer error if
+00014830: 2079 6f75 2074 7279 2023 2323 0a20 2020   you try ###.   
+00014840: 2020 2020 2020 2020 2023 2323 2042 7574           ### But
+00014850: 2069 6620 6974 2069 7320 6120 6f6e 652d   if it is a one-
+00014860: 6469 6d65 6e73 696f 6e61 6c20 6461 7461  dimensional data
+00014870: 6672 616d 652c 2063 6f6e 7665 7274 2069  frame, convert i
+00014880: 7420 696e 746f 2061 2053 6572 6965 730a  t into a Series.
+00014890: 2020 2020 2020 2020 2020 2020 2323 2323              ####
+000148a0: 2044 6f20 6e6f 7420 6368 616e 6765 2074   Do not change t
+000148b0: 6869 7320 7369 6e63 6520 4920 6861 7665  his since I have
+000148c0: 2074 6573 7465 6420 6974 2061 6e64 2069   tested it and i
+000148d0: 7420 776f 726b 732e 0a20 2020 2020 2020  t works..       
+000148e0: 2020 2020 2069 6620 7465 7374 782e 7368       if testx.sh
+000148f0: 6170 655b 315d 203d 3d20 313a 0a20 2020  ape[1] == 1:.   
+00014900: 2020 2020 2020 2020 2020 2020 2074 6573               tes
+00014910: 7478 203d 2070 642e 5365 7269 6573 2874  tx = pd.Series(t
+00014920: 6573 7478 2e76 616c 7565 732e 7261 7665  estx.values.rave
+00014930: 6c28 292c 6e61 6d65 3d74 6573 7478 2e63  l(),name=testx.c
+00014940: 6f6c 756d 6e73 5b30 5d29 0a20 2020 2020  olumns[0]).     
+00014950: 2020 2020 2020 2065 6c73 653a 0a20 2020         else:.   
+00014960: 2020 2020 2020 2020 2020 2020 2023 2323               ###
+00014970: 2320 5369 6e63 6520 6974 2069 7320 6d75  # Since it is mu
+00014980: 6c74 692d 6469 6d65 6e73 696f 6e61 6c2c  lti-dimensional,
+00014990: 2053 6f20 696e 2074 6869 7320 6361 7365   So in this case
+000149a0: 2c20 6a75 7374 2072 6574 7572 6e20 7468  , just return th
+000149b0: 6520 6f62 6a65 6374 2061 7320 6973 0a20  e object as is. 
+000149c0: 2020 2020 2020 2020 2020 2020 2020 2072                 r
+000149d0: 6574 7572 6e20 7365 6c66 0a20 2020 2020  eturn self.     
+000149e0: 2020 2069 6e73 203d 206e 702e 756e 6971     ins = np.uniq
+000149f0: 7565 2874 6573 7478 2e66 6163 746f 7269  ue(testx.factori
+00014a00: 7a65 2829 5b31 5d29 2e74 6f6c 6973 7428  ze()[1]).tolist(
+00014a10: 290a 2020 2020 2020 2020 6f75 7473 203d  ).        outs =
+00014a20: 206e 702e 756e 6971 7565 2874 6573 7478   np.unique(testx
+00014a30: 2e66 6163 746f 7269 7a65 2829 5b30 5d29  .factorize()[0])
+00014a40: 2e74 6f6c 6973 7428 290a 2020 2020 2020  .tolist().      
+00014a50: 2020 2369 6e73 203d 2074 6573 7478 2e76    #ins = testx.v
+00014a60: 616c 7565 5f63 6f75 6e74 7328 6472 6f70  alue_counts(drop
+00014a70: 6e61 3d46 616c 7365 292e 696e 6465 7820  na=False).index 
+00014a80: 2020 2020 2020 200a 2020 2020 2020 2020         .        
+00014a90: 6966 202d 3120 696e 206f 7574 733a 0a20  if -1 in outs:. 
+00014aa0: 2020 2020 2020 2023 2020 2069 7420 616c         #   it al
+00014ab0: 7265 6164 7920 6861 7320 6e61 6e20 6966  ready has nan if
+00014ac0: 202d 3120 6973 2069 6e20 6f75 7473 2e20   -1 is in outs. 
+00014ad0: 4e6f 206e 6565 6420 746f 2061 6464 2069  No need to add i
+00014ae0: 742e 0a20 2020 2020 2020 2020 2020 2069  t..            i
+00014af0: 6620 6e6f 7420 6e70 2e6e 616e 2069 6e20  f not np.nan in 
+00014b00: 696e 733a 0a20 2020 2020 2020 2020 2020  ins:.           
+00014b10: 2020 2020 2069 6e73 2e69 6e73 6572 7428       ins.insert(
+00014b20: 302c 6e70 2e6e 616e 290a 2020 2020 2020  0,np.nan).      
+00014b30: 2020 7365 6c66 2e74 7261 6e73 666f 726d    self.transform
+00014b40: 6572 203d 2064 6963 7428 7a69 7028 696e  er = dict(zip(in
+00014b50: 732c 6f75 7473 2929 0a20 2020 2020 2020  s,outs)).       
+00014b60: 2073 656c 662e 696e 7665 7273 655f 7472   self.inverse_tr
+00014b70: 616e 7366 6f72 6d65 7220 3d20 6469 6374  ansformer = dict
+00014b80: 287a 6970 286f 7574 732c 696e 7329 290a  (zip(outs,ins)).
+00014b90: 2020 2020 2020 2020 7265 7475 726e 2073          return s
+00014ba0: 656c 660a 0a20 2020 2064 6566 2074 7261  elf..    def tra
+00014bb0: 6e73 666f 726d 2873 656c 662c 2074 6573  nsform(self, tes
+00014bc0: 7478 2c20 793d 4e6f 6e65 293a 0a20 2020  tx, y=None):.   
+00014bd0: 2020 2020 2023 2323 2044 6f20 6e6f 7420       ### Do not 
+00014be0: 6368 616e 6765 2074 6869 7320 7369 6e63  change this sinc
+00014bf0: 6520 5261 7265 2063 6c61 7373 2063 6f6d  e Rare class com
+00014c00: 6269 6e65 7220 7265 7175 6972 6573 2074  biner requires t
+00014c10: 6869 7320 7465 7374 2023 230a 2020 2020  his test ##.    
+00014c20: 2020 2020 6966 2069 7369 6e73 7461 6e63      if isinstanc
+00014c30: 6528 7465 7374 782c 2074 7570 6c65 293a  e(testx, tuple):
+00014c40: 0a20 2020 2020 2020 2020 2020 2079 203d  .            y =
+00014c50: 2074 6573 7478 5b31 5d0a 2020 2020 2020   testx[1].      
+00014c60: 2020 2020 2020 7465 7374 7820 3d20 7465        testx = te
+00014c70: 7374 785b 305d 0a20 2020 2020 2020 2023  stx[0].        #
+00014c80: 2320 7465 7374 7820 6d75 7374 2073 7469  # testx must sti
+00014c90: 6c6c 2062 6520 6120 7064 2e53 6572 6965  ll be a pd.Serie
+00014ca0: 7320 666f 7220 7468 6973 2065 6e63 6f64  s for this encod
+00014cb0: 6572 2074 6f20 776f 726b 210a 2020 2020  er to work!.    
+00014cc0: 2020 2020 6966 2069 7369 6e73 7461 6e63      if isinstanc
+00014cd0: 6528 7465 7374 782c 2070 642e 5365 7269  e(testx, pd.Seri
+00014ce0: 6573 293a 0a20 2020 2020 2020 2020 2020  es):.           
+00014cf0: 2070 6173 730a 2020 2020 2020 2020 656c   pass.        el
+00014d00: 6966 2069 7369 6e73 7461 6e63 6528 7465  if isinstance(te
+00014d10: 7374 782c 206e 702e 6e64 6172 7261 7929  stx, np.ndarray)
+00014d20: 3a0a 2020 2020 2020 2020 2020 2020 7465  :.            te
+00014d30: 7374 7820 3d20 7064 2e53 6572 6965 7328  stx = pd.Series(
+00014d40: 7465 7374 7829 0a20 2020 2020 2020 2065  testx).        e
+00014d50: 6c73 653a 0a20 2020 2020 2020 2020 2020  lse:.           
+00014d60: 2023 2323 2320 5468 6572 6520 6973 206e   #### There is n
+00014d70: 6f20 7761 7920 746f 2074 7261 6e73 666f  o way to transfo
+00014d80: 726d 2064 6174 6166 7261 6d65 7320 7369  rm dataframes si
+00014d90: 6e63 6520 796f 7520 7769 6c6c 2067 6574  nce you will get
+00014da0: 2061 206e 6573 7465 6420 7265 6e61 6d65   a nested rename
+00014db0: 7220 6572 726f 7220 6966 2079 6f75 2074  r error if you t
+00014dc0: 7279 2023 2323 0a20 2020 2020 2020 2020  ry ###.         
+00014dd0: 2020 2023 2323 2042 7574 2069 6620 6974     ### But if it
+00014de0: 2069 7320 6120 6f6e 652d 6469 6d65 6e73   is a one-dimens
+00014df0: 696f 6e61 6c20 6461 7461 6672 616d 652c  ional dataframe,
+00014e00: 2063 6f6e 7665 7274 2069 7420 696e 746f   convert it into
+00014e10: 2061 2053 6572 6965 730a 2020 2020 2020   a Series.      
+00014e20: 2020 2020 2020 2323 2323 2044 6f20 6e6f        #### Do no
+00014e30: 7420 6368 616e 6765 2074 6869 7320 7369  t change this si
+00014e40: 6e63 6520 4920 6861 7665 2074 6573 7465  nce I have teste
+00014e50: 6420 6974 2061 6e64 2069 7420 776f 726b  d it and it work
+00014e60: 732e 0a20 2020 2020 2020 2020 2020 2069  s..            i
+00014e70: 6620 7465 7374 782e 7368 6170 655b 315d  f testx.shape[1]
+00014e80: 203d 3d20 313a 0a20 2020 2020 2020 2020   == 1:.         
+00014e90: 2020 2020 2020 2074 6573 7478 203d 2070         testx = p
+00014ea0: 642e 5365 7269 6573 2874 6573 7478 2e76  d.Series(testx.v
+00014eb0: 616c 7565 732e 7261 7665 6c28 292c 6e61  alues.ravel(),na
+00014ec0: 6d65 3d74 6573 7478 2e63 6f6c 756d 6e73  me=testx.columns
+00014ed0: 5b30 5d29 0a20 2020 2020 2020 2020 2020  [0]).           
+00014ee0: 2065 6c73 653a 0a20 2020 2020 2020 2020   else:.         
+00014ef0: 2020 2020 2020 2023 2323 2320 5369 6e63         #### Sinc
+00014f00: 6520 6974 2069 7320 6d75 6c74 692d 6469  e it is multi-di
+00014f10: 6d65 6e73 696f 6e61 6c2c 2053 6f20 696e  mensional, So in
+00014f20: 2074 6869 7320 6361 7365 2c20 6a75 7374   this case, just
+00014f30: 2072 6574 7572 6e20 7468 6520 6461 7461   return the data
+00014f40: 2061 7320 6973 0a20 2020 2020 2020 2020   as is.         
+00014f50: 2020 2020 2020 2023 2323 2320 446f 206e         #### Do n
+00014f60: 6f74 2063 6861 6e67 6520 7468 6973 2073  ot change this s
+00014f70: 696e 6365 2049 2068 6176 6520 7465 7374  ince I have test
+00014f80: 6564 2069 7420 616e 6420 6974 2077 6f72  ed it and it wor
+00014f90: 6b73 2e0a 2020 2020 2020 2020 2020 2020  ks..            
+00014fa0: 2020 2020 7265 7475 726e 2074 6573 7478      return testx
+00014fb0: 0a20 2020 2020 2020 2023 2323 206e 6f77  .        ### now
+00014fc0: 2063 6f6e 7665 7274 2074 6865 2069 6e70   convert the inp
+00014fd0: 7574 2074 6f20 7472 616e 7366 6f72 6d65  ut to transforme
+00014fe0: 7220 6469 6374 696f 6e61 7279 2076 616c  r dictionary val
+00014ff0: 7565 730a 2020 2020 2020 2020 6e65 775f  ues.        new_
+00015000: 696e 7320 3d20 6e70 2e75 6e69 7175 6528  ins = np.unique(
+00015010: 7465 7374 782e 6661 6374 6f72 697a 6528  testx.factorize(
+00015020: 295b 315d 292e 746f 6c69 7374 2829 0a20  )[1]).tolist(). 
+00015030: 2020 2020 2020 206d 6973 7369 6e67 203d         missing =
+00015040: 205b 7820 666f 7220 7820 696e 206e 6577   [x for x in new
+00015050: 5f69 6e73 2069 6620 7820 6e6f 7420 696e  _ins if x not in
+00015060: 2073 656c 662e 7472 616e 7366 6f72 6d65   self.transforme
+00015070: 722e 6b65 7973 2829 5d0a 2020 2020 2020  r.keys()].      
+00015080: 2020 6966 206c 656e 286d 6973 7369 6e67    if len(missing
+00015090: 2920 3e20 303a 0a20 2020 2020 2020 2020  ) > 0:.         
+000150a0: 2020 2066 6f72 2065 6163 685f 6d69 7373     for each_miss
+000150b0: 696e 6720 696e 206d 6973 7369 6e67 3a0a  ing in missing:.
+000150c0: 2020 2020 2020 2020 2020 2020 2020 2020                  
+000150d0: 7365 6c66 2e74 7261 6e73 666f 726d 6572  self.transformer
+000150e0: 5b65 6163 685f 6d69 7373 696e 675d 203d  [each_missing] =
+000150f0: 2069 6e74 2873 656c 662e 6d61 785f 7661   int(self.max_va
+00015100: 6c20 2b20 3129 0a20 2020 2020 2020 2020  l + 1).         
+00015110: 2020 2020 2020 2073 656c 662e 696e 7665         self.inve
+00015120: 7273 655f 7472 616e 7366 6f72 6d65 725b  rse_transformer[
+00015130: 696e 7428 7365 6c66 2e6d 6178 5f76 616c  int(self.max_val
+00015140: 2b31 295d 203d 2065 6163 685f 6d69 7373  +1)] = each_miss
+00015150: 696e 670a 2020 2020 2020 2020 2020 2020  ing.            
+00015160: 2020 2020 7365 6c66 2e6d 6178 5f76 616c      self.max_val
+00015170: 203d 2069 6e74 2873 656c 662e 6d61 785f   = int(self.max_
+00015180: 7661 6c2b 3129 0a20 2020 2020 2020 2065  val+1).        e
+00015190: 6c73 653a 0a20 2020 2020 2020 2020 2020  lse:.           
+000151a0: 2073 656c 662e 6d61 785f 7661 6c20 3d20   self.max_val = 
+000151b0: 6e70 2e6d 6178 286c 6973 7428 7365 6c66  np.max(list(self
+000151c0: 2e74 7261 6e73 666f 726d 6572 2e76 616c  .transformer.val
+000151d0: 7565 7328 2929 290a 2020 2020 2020 2020  ues())).        
+000151e0: 2323 2320 546f 2068 616e 646c 6520 6361  ### To handle ca
+000151f0: 7465 676f 7279 2064 7479 7065 2079 6f75  tegory dtype you
+00015200: 206d 7573 7420 646f 2074 6865 206e 6578   must do the nex
+00015210: 7420 7374 6570 2023 2323 2323 0a20 2020  t step #####.   
+00015220: 2020 2020 2023 2323 2320 446f 206e 6f74       #### Do not
+00015230: 2063 6861 6e67 6520 7468 6973 2073 696e   change this sin
+00015240: 6365 2049 2068 6176 6520 7465 7374 6564  ce I have tested
+00015250: 2069 7420 616e 6420 6974 2077 6f72 6b73   it and it works
+00015260: 2e0a 2020 2020 2020 2020 7465 7374 6b20  ..        testk 
+00015270: 3d20 7465 7374 782e 6d61 7028 7365 6c66  = testx.map(self
+00015280: 2e74 7261 6e73 666f 726d 6572 2920 0a20  .transformer) . 
+00015290: 2020 2020 2020 2069 6620 7465 7374 782e         if testx.
+000152a0: 6474 7970 6520 6e6f 7420 696e 205b 6e70  dtype not in [np
+000152b0: 2e69 6e74 3136 2c20 6e70 2e69 6e74 3332  .int16, np.int32
+000152c0: 2c20 6e70 2e69 6e74 3634 2c20 666c 6f61  , np.int64, floa
+000152d0: 742c 2062 6f6f 6c2c 206f 626a 6563 745d  t, bool, object]
+000152e0: 3a0a 2020 2020 2020 2020 2020 2020 6966  :.            if
+000152f0: 2074 6573 7478 2e69 736e 756c 6c28 292e   testx.isnull().
+00015300: 7375 6d28 292e 7375 6d28 2920 3e20 303a  sum().sum() > 0:
+00015310: 0a20 2020 2020 2020 2020 2020 2020 2020  .               
+00015320: 2066 696c 6c76 616c 203d 2073 656c 662e   fillval = self.
+00015330: 7472 616e 7366 6f72 6d65 725b 6e70 2e6e  transformer[np.n
+00015340: 616e 5d0a 2020 2020 2020 2020 2020 2020  an].            
+00015350: 2020 2020 7465 7374 6b20 3d20 7465 7374      testk = test
+00015360: 782e 6361 742e 6164 645f 6361 7465 676f  x.cat.add_catego
+00015370: 7269 6573 285b 6669 6c6c 7661 6c5d 290a  ries([fillval]).
+00015380: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00015390: 7465 7374 6b20 3d20 7465 7374 6b2e 6669  testk = testk.fi
+000153a0: 6c6c 6e61 2866 696c 6c76 616c 290a 2020  llna(fillval).  
+000153b0: 2020 2020 2020 2020 2020 2020 2020 7465                te
+000153c0: 7374 6b20 3d20 7465 7374 782e 6d61 7028  stk = testx.map(
+000153d0: 7365 6c66 2e74 7261 6e73 666f 726d 6572  self.transformer
+000153e0: 292e 7661 6c75 6573 2e61 7374 7970 6528  ).values.astype(
+000153f0: 696e 7429 0a20 2020 2020 2020 2020 2020  int).           
+00015400: 2020 2020 2072 6574 7572 6e20 7465 7374       return test
+00015410: 6b0a 2020 2020 2020 2020 2020 2020 656c  k.            el
+00015420: 7365 3a0a 2020 2020 2020 2020 2020 2020  se:.            
+00015430: 2020 2020 7465 7374 6b20 3d20 7465 7374      testk = test
+00015440: 782e 6d61 7028 7365 6c66 2e74 7261 6e73  x.map(self.trans
+00015450: 666f 726d 6572 292e 7661 6c75 6573 2e61  former).values.a
+00015460: 7374 7970 6528 696e 7429 0a20 2020 2020  stype(int).     
+00015470: 2020 2020 2020 2020 2020 2072 6574 7572             retur
+00015480: 6e20 7465 7374 6b0a 2020 2020 2020 2020  n testk.        
+00015490: 656c 7365 3a0a 2020 2020 2020 2020 2020  else:.          
+000154a0: 2020 6f75 7473 203d 2074 6573 7478 2e6d    outs = testx.m
+000154b0: 6170 2873 656c 662e 7472 616e 7366 6f72  ap(self.transfor
+000154c0: 6d65 7229 2e76 616c 7565 732e 6173 7479  mer).values.asty
+000154d0: 7065 2869 6e74 290a 2020 2020 2020 2020  pe(int).        
+000154e0: 2020 2020 7265 7475 726e 206f 7574 730a      return outs.
+000154f0: 0a20 2020 2064 6566 2069 6e76 6572 7365  .    def inverse
+00015500: 5f74 7261 6e73 666f 726d 2873 656c 662c  _transform(self,
+00015510: 2074 6573 7478 2c20 793d 4e6f 6e65 293a   testx, y=None):
+00015520: 0a20 2020 2020 2020 2023 2323 206e 6f77  .        ### now
+00015530: 2063 6f6e 7665 7274 2074 6865 2069 6e70   convert the inp
+00015540: 7574 2074 6f20 7472 616e 7366 6f72 6d65  ut to transforme
+00015550: 7220 6469 6374 696f 6e61 7279 2076 616c  r dictionary val
+00015560: 7565 730a 2020 2020 2020 2020 6966 2069  ues.        if i
+00015570: 7369 6e73 7461 6e63 6528 7465 7374 782c  sinstance(testx,
+00015580: 2070 642e 5365 7269 6573 293a 0a20 2020   pd.Series):.   
+00015590: 2020 2020 2020 2020 206f 7574 7320 3d20           outs = 
+000155a0: 7465 7374 782e 6d61 7028 7365 6c66 2e69  testx.map(self.i
+000155b0: 6e76 6572 7365 5f74 7261 6e73 666f 726d  nverse_transform
+000155c0: 6572 292e 7661 6c75 6573 0a20 2020 2020  er).values.     
+000155d0: 2020 2065 6c69 6620 6973 696e 7374 616e     elif isinstan
+000155e0: 6365 2874 6573 7478 2c20 6e70 2e6e 6461  ce(testx, np.nda
+000155f0: 7272 6179 293a 0a20 2020 2020 2020 2020  rray):.         
+00015600: 2020 206f 7574 7320 3d20 7064 2e53 6572     outs = pd.Ser
+00015610: 6965 7328 7465 7374 7829 2e6d 6170 2873  ies(testx).map(s
+00015620: 656c 662e 696e 7665 7273 655f 7472 616e  elf.inverse_tran
+00015630: 7366 6f72 6d65 7229 2e76 616c 7565 730a  sformer).values.
+00015640: 2020 2020 2020 2020 656c 7365 3a0a 2020          else:.  
+00015650: 2020 2020 2020 2020 2020 6f75 7473 203d            outs =
+00015660: 2074 6573 7478 5b3a 5d0a 2020 2020 2020   testx[:].      
+00015670: 2020 7265 7475 726e 206f 7574 730a 2323    return outs.##
+00015680: 2323 2323 2323 2323 2323 2323 2323 2323  ################
+00015690: 2323 2323 2323 2323 2323 2323 2323 2323  ################
+000156a0: 2323 2323 2323 2323 2323 2323 2323 2323  ################
+000156b0: 2323 2323 2323 2323 2323 2323 2323 2323  ################
+000156c0: 2323 2323 2323 2323 2323 2323 2323 230a  ###############.
+000156d0: 636c 6173 7320 4d79 5f4c 6162 656c 456e  class My_LabelEn
+000156e0: 636f 6465 725f 5069 7065 2842 6173 6545  coder_Pipe(BaseE
+000156f0: 7374 696d 6174 6f72 2c20 5472 616e 7366  stimator, Transf
+00015700: 6f72 6d65 724d 6978 696e 293a 0a20 2020  ormerMixin):.   
+00015710: 2022 2222 0a20 2020 2023 2323 2323 2323   """.    #######
+00015720: 2323 2323 2323 2323 2323 2323 2323 2323  ################
+00015730: 2323 2323 2323 2323 2323 2323 2323 2323  ################
+00015740: 2323 2323 2323 2323 2323 2323 2323 2323  ################
+00015750: 2323 2323 2323 2323 2323 2323 2323 2323  ################
+00015760: 2323 2323 2323 2323 2323 2323 2323 2323  ################
+00015770: 2323 2323 2323 2323 230a 2020 2020 2323  #########.    ##
+00015780: 2323 2323 2020 5468 6520 4d79 5f4c 6162  ####  The My_Lab
+00015790: 656c 456e 636f 6465 725f 5069 7065 2063  elEncoder_Pipe c
+000157a0: 6c61 7373 2077 6f72 6b73 206a 7573 7420  lass works just 
+000157b0: 6c69 6b65 2073 6b6c 6561 726e 2773 204c  like sklearn's L
+000157c0: 6162 656c 2045 6e63 6f64 6572 2062 7574  abel Encoder but
+000157d0: 2062 6574 7465 7221 2023 2323 2323 0a20   better! #####. 
+000157e0: 2020 2023 2323 2323 2020 4974 206c 6162     #####  It lab
+000157f0: 656c 2065 6e63 6f64 6573 2061 6e79 2063  el encodes any c
+00015800: 6174 2076 6172 2069 6e20 796f 7572 2064  at var in your d
+00015810: 6174 6173 6574 2e20 4275 7420 6974 2063  ataset. But it c
+00015820: 616e 2061 6c73 6f20 6265 2075 7365 6420  an also be used 
+00015830: 696e 2050 6970 656c 696e 6573 2120 2323  in Pipelines! ##
+00015840: 2323 230a 2020 2020 2323 2020 5468 6520  ###.    ##  The 
+00015850: 6265 6175 7479 206f 6620 7468 6973 2066  beauty of this f
+00015860: 756e 6374 696f 6e20 6973 2074 6861 7420  unction is that 
+00015870: 6974 2074 616b 6573 2063 6172 6520 6f66  it takes care of
+00015880: 204e 614e 2773 2061 6e64 2075 6e6b 6e6f   NaN's and unkno
+00015890: 776e 2028 6675 7475 7265 2920 7661 6c75  wn (future) valu
+000158a0: 6573 2e23 2323 2323 0a20 2020 2023 2323  es.#####.    ###
+000158b0: 2323 2020 5369 6e63 6520 6974 2070 726f  ##  Since it pro
+000158c0: 6475 6365 7320 616e 2075 6e75 7365 6420  duces an unused 
+000158d0: 7365 636f 6e64 2063 6f6c 756d 6e20 6974  second column it
+000158e0: 2063 616e 2062 6520 7573 6564 2069 6e20   can be used in 
+000158f0: 736b 6c65 6172 6e27 7320 5069 7065 6c69  sklearn's Pipeli
+00015900: 6e65 732e 2020 2020 2323 2323 230a 2020  nes.    #####.  
+00015910: 2020 2323 2323 2320 2042 7574 2066 6f72    #####  But for
+00015920: 2074 6861 7420 796f 7520 6e65 6564 2074   that you need t
+00015930: 6f20 6164 6420 6120 6472 6f70 5f73 6563  o add a drop_sec
+00015940: 6f6e 645f 636f 6c28 2920 6675 6e63 7469  ond_col() functi
+00015950: 6f6e 2074 6f20 7468 6973 204d 795f 4c61  on to this My_La
+00015960: 6265 6c45 6e63 6f64 6572 5f50 6970 6520  belEncoder_Pipe 
+00015970: 2323 200a 2020 2020 2323 2323 2320 2061  ## .    #####  a
+00015980: 6e64 2074 6865 6e20 6665 6564 2074 6865  nd then feed the
+00015990: 2077 686f 6c65 2070 6970 656c 696e 6520   whole pipeline 
+000159a0: 746f 2061 2043 6f6c 756d 6e5f 5472 616e  to a Column_Tran
+000159b0: 7366 6f72 6d65 7220 6675 6e63 7469 6f6e  sformer function
+000159c0: 2e20 4974 2069 7320 7665 7279 2065 6173  . It is very eas
+000159d0: 792e 2023 2323 2323 0a20 2020 2023 2323  y. #####.    ###
+000159e0: 2323 2323 2323 2323 2323 2323 2323 2323  ################
+000159f0: 2323 2054 6869 7320 6973 2074 6865 2042  ## This is the B
+00015a00: 4553 5420 776f 726b 696e 6720 7665 7273  EST working vers
+00015a10: 696f 6e20 2d20 646f 6e27 7420 6d65 7373  ion - don't mess
+00015a20: 2077 6974 6820 6974 2121 2023 2323 2323   with it!! #####
+00015a30: 2323 2323 2323 2323 2323 2323 230a 2020  #############.  
+00015a40: 2020 2323 2323 2323 2323 2323 2323 2323    ##############
+00015a50: 2323 2323 2323 2323 2323 2323 2323 2323  ################
+00015a60: 2323 2323 2323 2323 2323 2323 2323 2323  ################
+00015a70: 2323 2323 2323 2323 2323 2323 2323 2323  ################
+00015a80: 2323 2323 2323 2323 2323 2323 2323 2323  ################
+00015a90: 2323 2323 2323 2323 2323 2323 2323 2323  ################
+00015aa0: 2323 0a20 2020 2055 7361 6765 2069 6e20  ##.    Usage in 
+00015ab0: 7069 7065 6c69 6e65 733a 0a20 2020 2020  pipelines:.     
+00015ac0: 2020 2020 206c 6520 3d20 4d79 5f4c 6162       le = My_Lab
+00015ad0: 656c 456e 636f 6465 725f 5069 7065 2829  elEncoder_Pipe()
+00015ae0: 0a20 2020 2020 2020 2020 206c 652e 6669  .          le.fi
+00015af0: 745f 7472 616e 7366 6f72 6d28 7472 6169  t_transform(trai
+00015b00: 6e5b 636f 6c75 6d6e 5d29 2023 2320 7468  n[column]) ## th
+00015b10: 6973 2077 696c 6c20 6769 7665 2079 6f75  is will give you
+00015b20: 2074 776f 2063 6f6c 756d 6e73 202d 2062   two columns - b
+00015b30: 6577 6172 6521 0a20 2020 2020 2020 2020  eware!.         
+00015b40: 206c 652e 7472 616e 7366 6f72 6d28 7465   le.transform(te
+00015b50: 7374 5b63 6f6c 756d 6e5d 2920 2323 2320  st[column]) ### 
+00015b60: 7468 6973 2077 696c 6c20 6769 7665 2079  this will give y
+00015b70: 6f75 2074 776f 2063 6f6c 756d 6e73 202d  ou two columns -
+00015b80: 2062 6577 6172 6521 0a20 2020 2020 2020   beware!.       
+00015b90: 2020 2020 2020 200a 2020 2020 5573 6167         .    Usag
+00015ba0: 6520 696e 2043 6f6c 756d 6e20 5472 616e  e in Column Tran
+00015bb0: 7366 6f72 6d65 7273 3a0a 2020 2020 2020  sformers:.      
+00015bc0: 2020 6465 6620 6472 6f70 5f73 6563 6f6e    def drop_secon
+00015bd0: 645f 636f 6c28 5874 293a 0a20 2020 2020  d_col(Xt):.     
+00015be0: 2020 2023 2323 2054 6869 7320 6465 6c65     ### This dele
+00015bf0: 7465 7320 7468 6520 326e 6420 636f 6c75  tes the 2nd colu
+00015c00: 6d6e 2e20 4865 6e63 6520 636f 6c20 6e75  mn. Hence col nu
+00015c10: 6d62 6572 3d31 2061 6e64 2061 7869 733d  mber=1 and axis=
+00015c20: 3120 2323 230a 2020 2020 2020 2020 7265  1 ###.        re
+00015c30: 7475 726e 206e 702e 6465 6c65 7465 2858  turn np.delete(X
+00015c40: 742c 2031 2c20 3129 0a20 2020 2020 2020  t, 1, 1).       
+00015c50: 200a 2020 2020 2020 2020 6472 6f70 5f73   .        drop_s
+00015c60: 6563 6f6e 645f 636f 6c5f 6675 6e63 203d  econd_col_func =
+00015c70: 2046 756e 6374 696f 6e54 7261 6e73 666f   FunctionTransfo
+00015c80: 726d 6572 2864 726f 705f 7365 636f 6e64  rmer(drop_second
+00015c90: 5f63 6f6c 290a 2020 2020 2020 2020 0a20  _col).        . 
+00015ca0: 2020 2020 2020 206c 655f 6f6e 6520 3d20         le_one = 
+00015cb0: 6d61 6b65 5f70 6970 656c 696e 6528 6c65  make_pipeline(le
+00015cc0: 2c20 6472 6f70 5f73 6563 6f6e 645f 636f  , drop_second_co
+00015cd0: 6c5f 6675 6e63 290a 2020 2020 0a20 2020  l_func).    .   
+00015ce0: 2020 2020 2063 7420 3d20 6d61 6b65 5f63       ct = make_c
+00015cf0: 6f6c 756d 6e5f 7472 616e 7366 6f72 6d65  olumn_transforme
+00015d00: 7228 0a20 2020 2020 2020 2020 2020 2028  r(.            (
+00015d10: 6c65 5f6f 6e65 2c20 6361 7476 6172 735b  le_one, catvars[
+00015d20: 305d 292c 0a20 2020 2020 2020 2020 2020  0]),.           
+00015d30: 2028 6c65 5f6f 6e65 2c20 6361 7476 6172   (le_one, catvar
+00015d40: 735b 315d 292c 0a20 2020 2020 2020 2020  s[1]),.         
+00015d50: 2020 2028 696d 702c 206e 756d 7661 7273     (imp, numvars
+00015d60: 292c 0a20 2020 2020 2020 2020 2020 2072  ),.            r
+00015d70: 656d 6169 6e64 6572 3d72 656d 6169 6e64  emainder=remaind
+00015d80: 6572 2920 2020 200a 0a20 2020 2022 2222  er)    ..    """
+00015d90: 0a20 2020 2064 6566 205f 5f69 6e69 745f  .    def __init_
+00015da0: 5f28 7365 6c66 293a 0a20 2020 2020 2020  _(self):.       
+00015db0: 2073 656c 662e 7472 616e 7366 6f72 6d65   self.transforme
+00015dc0: 7220 3d20 6465 6661 756c 7464 6963 7428  r = defaultdict(
+00015dd0: 7374 7229 0a20 2020 2020 2020 2073 656c  str).        sel
+00015de0: 662e 696e 7665 7273 655f 7472 616e 7366  f.inverse_transf
+00015df0: 6f72 6d65 7220 3d20 6465 6661 756c 7464  ormer = defaultd
+00015e00: 6963 7428 7374 7229 0a20 2020 2020 2020  ict(str).       
+00015e10: 2073 656c 662e 6d61 785f 7661 6c20 3d20   self.max_val = 
+00015e20: 300a 2020 2020 2020 2020 0a20 2020 2064  0.        .    d
+00015e30: 6566 2066 6974 2873 656c 662c 7465 7374  ef fit(self,test
+00015e40: 782c 2079 3d4e 6f6e 6529 3a0a 2020 2020  x, y=None):.    
+00015e50: 2020 2020 2323 2320 446f 206e 6f74 2063      ### Do not c
+00015e60: 6861 6e67 6520 7468 6973 2073 696e 6365  hange this since
+00015e70: 2052 6172 6520 636c 6173 7320 636f 6d62   Rare class comb
+00015e80: 696e 6572 2072 6571 7569 7265 7320 7468  iner requires th
+00015e90: 6973 2074 6573 7420 2323 0a20 2020 2020  is test ##.     
+00015ea0: 2020 2069 6620 6973 696e 7374 616e 6365     if isinstance
+00015eb0: 2874 6573 7478 2c20 7475 706c 6529 3a0a  (testx, tuple):.
+00015ec0: 2020 2020 2020 2020 2020 2020 7920 3d20              y = 
+00015ed0: 7465 7374 785b 315d 0a20 2020 2020 2020  testx[1].       
+00015ee0: 2020 2020 2074 6573 7478 203d 2074 6573       testx = tes
+00015ef0: 7478 5b30 5d0a 2020 2020 2020 2020 6966  tx[0].        if
+00015f00: 2069 7369 6e73 7461 6e63 6528 7465 7374   isinstance(test
+00015f10: 782c 2070 642e 5365 7269 6573 293a 0a20  x, pd.Series):. 
+00015f20: 2020 2020 2020 2020 2020 2070 6173 730a             pass.
+00015f30: 2020 2020 2020 2020 656c 6966 2069 7369          elif isi
+00015f40: 6e73 7461 6e63 6528 7465 7374 782c 206e  nstance(testx, n
+00015f50: 702e 6e64 6172 7261 7929 3a0a 2020 2020  p.ndarray):.    
+00015f60: 2020 2020 2020 2020 7465 7374 7820 3d20          testx = 
+00015f70: 7064 2e53 6572 6965 7328 7465 7374 7829  pd.Series(testx)
+00015f80: 0a20 2020 2020 2020 2065 6c73 653a 0a20  .        else:. 
+00015f90: 2020 2020 2020 2020 2020 2023 2323 2320             #### 
+00015fa0: 5468 6572 6520 6973 206e 6f20 7761 7920  There is no way 
+00015fb0: 746f 2074 7261 6e73 666f 726d 2064 6174  to transform dat
+00015fc0: 6166 7261 6d65 7320 7369 6e63 6520 796f  aframes since yo
+00015fd0: 7520 7769 6c6c 2067 6574 2061 206e 6573  u will get a nes
+00015fe0: 7465 6420 7265 6e61 6d65 7220 6572 726f  ted renamer erro
+00015ff0: 7220 6966 2079 6f75 2074 7279 2023 2323  r if you try ###
+00016000: 0a20 2020 2020 2020 2020 2020 2023 2323  .            ###
+00016010: 2042 7574 2069 6620 6974 2069 7320 6120   But if it is a 
+00016020: 6f6e 652d 6469 6d65 6e73 696f 6e61 6c20  one-dimensional 
+00016030: 6461 7461 6672 616d 652c 2063 6f6e 7665  dataframe, conve
+00016040: 7274 2069 7420 696e 746f 2061 2053 6572  rt it into a Ser
+00016050: 6965 730a 2020 2020 2020 2020 2020 2020  ies.            
+00016060: 6966 2074 6573 7478 2e73 6861 7065 5b31  if testx.shape[1
+00016070: 5d20 3d3d 2031 3a0a 2020 2020 2020 2020  ] == 1:.        
+00016080: 2020 2020 2020 2020 7465 7374 7820 3d20          testx = 
+00016090: 7064 2e53 6572 6965 7328 7465 7374 782e  pd.Series(testx.
+000160a0: 7661 6c75 6573 2e72 6176 656c 2829 2c6e  values.ravel(),n
+000160b0: 616d 653d 7465 7374 782e 636f 6c75 6d6e  ame=testx.column
+000160c0: 735b 305d 290a 2020 2020 2020 2020 2020  s[0]).          
+000160d0: 2020 656c 7365 3a0a 2020 2020 2020 2020    else:.        
+000160e0: 2020 2020 2020 2020 2323 2323 2053 696e          #### Sin
+000160f0: 6365 2069 7420 6973 206d 756c 7469 2d64  ce it is multi-d
+00016100: 696d 656e 7369 6f6e 616c 2c20 536f 2069  imensional, So i
+00016110: 6e20 7468 6973 2063 6173 652c 206a 7573  n this case, jus
+00016120: 7420 7265 7475 726e 2074 6865 2064 6174  t return the dat
+00016130: 6120 6173 2069 730a 2020 2020 2020 2020  a as is.        
+00016140: 2020 2020 2020 2020 7265 7475 726e 2073          return s
+00016150: 656c 660a 2020 2020 2020 2020 696e 7320  elf.        ins 
+00016160: 3d20 6e70 2e75 6e69 7175 6528 7465 7374  = np.unique(test
+00016170: 782e 6661 6374 6f72 697a 6528 295b 315d  x.factorize()[1]
+00016180: 292e 746f 6c69 7374 2829 0a20 2020 2020  ).tolist().     
+00016190: 2020 206f 7574 7320 3d20 6e70 2e75 6e69     outs = np.uni
+000161a0: 7175 6528 7465 7374 782e 6661 6374 6f72  que(testx.factor
+000161b0: 697a 6528 295b 305d 292e 746f 6c69 7374  ize()[0]).tolist
+000161c0: 2829 0a20 2020 2020 2020 2023 696e 7320  ().        #ins 
+000161d0: 3d20 7465 7374 782e 7661 6c75 655f 636f  = testx.value_co
+000161e0: 756e 7473 2864 726f 706e 613d 4661 6c73  unts(dropna=Fals
+000161f0: 6529 2e69 6e64 6578 2020 2020 2020 2020  e).index        
+00016200: 0a20 2020 2020 2020 2069 6620 2d31 2069  .        if -1 i
+00016210: 6e20 6f75 7473 3a0a 2020 2020 2020 2020  n outs:.        
+00016220: 2320 2020 6974 2061 6c72 6561 6479 2068  #   it already h
+00016230: 6173 206e 616e 2069 6620 2d31 2069 7320  as nan if -1 is 
+00016240: 696e 206f 7574 732e 204e 6f20 6e65 6564  in outs. No need
+00016250: 2074 6f20 6164 6420 6974 2e0a 2020 2020   to add it..    
+00016260: 2020 2020 2020 2020 6966 206e 6f74 206e          if not n
+00016270: 702e 6e61 6e20 696e 2069 6e73 3a0a 2020  p.nan in ins:.  
+00016280: 2020 2020 2020 2020 2020 2020 2020 696e                in
+00016290: 732e 696e 7365 7274 2830 2c6e 702e 6e61  s.insert(0,np.na
+000162a0: 6e29 0a20 2020 2020 2020 2073 656c 662e  n).        self.
+000162b0: 7472 616e 7366 6f72 6d65 7220 3d20 6469  transformer = di
+000162c0: 6374 287a 6970 2869 6e73 2c6f 7574 7329  ct(zip(ins,outs)
+000162d0: 290a 2020 2020 2020 2020 7365 6c66 2e69  ).        self.i
+000162e0: 6e76 6572 7365 5f74 7261 6e73 666f 726d  nverse_transform
+000162f0: 6572 203d 2064 6963 7428 7a69 7028 6f75  er = dict(zip(ou
+00016300: 7473 2c69 6e73 2929 0a20 2020 2020 2020  ts,ins)).       
+00016310: 2072 6574 7572 6e20 7365 6c66 0a0a 2020   return self..  
+00016320: 2020 6465 6620 7472 616e 7366 6f72 6d28    def transform(
+00016330: 7365 6c66 2c20 7465 7374 782c 2079 3d4e  self, testx, y=N
+00016340: 6f6e 6529 3a0a 2020 2020 2020 2020 2323  one):.        ##
+00016350: 2320 446f 206e 6f74 2063 6861 6e67 6520  # Do not change 
+00016360: 7468 6973 2073 696e 6365 2052 6172 6520  this since Rare 
+00016370: 636c 6173 7320 636f 6d62 696e 6572 2072  class combiner r
+00016380: 6571 7569 7265 7320 7468 6973 2074 6573  equires this tes
+00016390: 7420 2323 0a20 2020 2020 2020 2069 6620  t ##.        if 
+000163a0: 6973 696e 7374 616e 6365 2874 6573 7478  isinstance(testx
+000163b0: 2c20 7475 706c 6529 3a0a 2020 2020 2020  , tuple):.      
+000163c0: 2020 2020 2020 7920 3d20 7465 7374 785b        y = testx[
+000163d0: 315d 0a20 2020 2020 2020 2020 2020 2074  1].            t
+000163e0: 6573 7478 203d 2074 6573 7478 5b30 5d0a  estx = testx[0].
+000163f0: 2020 2020 2020 2020 2323 2074 6573 7478          ## testx
+00016400: 206d 7573 7420 7374 696c 6c20 6265 2061   must still be a
+00016410: 2070 642e 5365 7269 6573 2066 6f72 2074   pd.Series for t
+00016420: 6869 7320 656e 636f 6465 7220 746f 2077  his encoder to w
+00016430: 6f72 6b21 0a20 2020 2020 2020 2069 6620  ork!.        if 
+00016440: 6973 696e 7374 616e 6365 2874 6573 7478  isinstance(testx
+00016450: 2c20 7064 2e53 6572 6965 7329 3a0a 2020  , pd.Series):.  
+00016460: 2020 2020 2020 2020 2020 7061 7373 0a20            pass. 
+00016470: 2020 2020 2020 2065 6c69 6620 6973 696e         elif isin
+00016480: 7374 616e 6365 2874 6573 7478 2c20 6e70  stance(testx, np
+00016490: 2e6e 6461 7272 6179 293a 0a20 2020 2020  .ndarray):.     
+000164a0: 2020 2020 2020 2074 6573 7478 203d 2070         testx = p
+000164b0: 642e 5365 7269 6573 2874 6573 7478 290a  d.Series(testx).
+000164c0: 2020 2020 2020 2020 656c 7365 3a0a 2020          else:.  
+000164d0: 2020 2020 2020 2020 2020 2323 2323 2054            #### T
+000164e0: 6865 7265 2069 7320 6e6f 2077 6179 2074  here is no way t
+000164f0: 6f20 7472 616e 7366 6f72 6d20 6461 7461  o transform data
+00016500: 6672 616d 6573 2073 696e 6365 2079 6f75  frames since you
+00016510: 2077 696c 6c20 6765 7420 6120 6e65 7374   will get a nest
+00016520: 6564 2072 656e 616d 6572 2065 7272 6f72  ed renamer error
+00016530: 2069 6620 796f 7520 7472 7920 2323 230a   if you try ###.
+00016540: 2020 2020 2020 2020 2020 2020 2323 2320              ### 
+00016550: 4275 7420 6966 2069 7420 6973 2061 206f  But if it is a o
+00016560: 6e65 2d64 696d 656e 7369 6f6e 616c 2064  ne-dimensional d
+00016570: 6174 6166 7261 6d65 2c20 636f 6e76 6572  ataframe, conver
+00016580: 7420 6974 2069 6e74 6f20 6120 5365 7269  t it into a Seri
+00016590: 6573 0a20 2020 2020 2020 2020 2020 2023  es.            #
+000165a0: 2323 2320 446f 206e 6f74 2063 6861 6e67  ### Do not chang
+000165b0: 6520 7468 6973 2073 696e 6365 2049 2068  e this since I h
+000165c0: 6176 6520 7465 7374 6564 2069 7420 616e  ave tested it an
+000165d0: 6420 6974 2077 6f72 6b73 2e0a 2020 2020  d it works..    
+000165e0: 2020 2020 2020 2020 6966 2074 6573 7478          if testx
+000165f0: 2e73 6861 7065 5b31 5d20 3d3d 2031 3a0a  .shape[1] == 1:.
+00016600: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00016610: 7465 7374 7820 3d20 7064 2e53 6572 6965  testx = pd.Serie
+00016620: 7328 7465 7374 782e 7661 6c75 6573 2e72  s(testx.values.r
+00016630: 6176 656c 2829 2c6e 616d 653d 7465 7374  avel(),name=test
+00016640: 782e 636f 6c75 6d6e 735b 305d 290a 2020  x.columns[0]).  
+00016650: 2020 2020 2020 2020 2020 656c 7365 3a0a            else:.
+00016660: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00016670: 2323 2323 2053 696e 6365 2069 7420 6973  #### Since it is
+00016680: 206d 756c 7469 2d64 696d 656e 7369 6f6e   multi-dimension
+00016690: 616c 2c20 536f 2069 6e20 7468 6973 2063  al, So in this c
+000166a0: 6173 652c 206a 7573 7420 7265 7475 726e  ase, just return
+000166b0: 2074 6865 2064 6174 6120 6173 2069 730a   the data as is.
+000166c0: 2020 2020 2020 2020 2020 2020 2020 2020                  
+000166d0: 2323 2323 2044 6f20 6e6f 7420 6368 616e  #### Do not chan
+000166e0: 6765 2074 6869 7320 7369 6e63 6520 4920  ge this since I 
+000166f0: 6861 7665 2074 6573 7465 6420 6974 2061  have tested it a
+00016700: 6e64 2069 7420 776f 726b 732e 0a20 2020  nd it works..   
+00016710: 2020 2020 2020 2020 2020 2020 2072 6574               ret
+00016720: 7572 6e20 7465 7374 780a 0a20 2020 2020  urn testx..     
+00016730: 2020 2023 2323 206e 6f77 2063 6f6e 7665     ### now conve
+00016740: 7274 2074 6865 2069 6e70 7574 2074 6f20  rt the input to 
+00016750: 7472 616e 7366 6f72 6d65 7220 6469 6374  transformer dict
+00016760: 696f 6e61 7279 2076 616c 7565 730a 2020  ionary values.  
+00016770: 2020 2020 2020 6e65 775f 696e 7320 3d20        new_ins = 
+00016780: 6e70 2e75 6e69 7175 6528 7465 7374 782e  np.unique(testx.
+00016790: 6661 6374 6f72 697a 6528 295b 315d 292e  factorize()[1]).
+000167a0: 746f 6c69 7374 2829 0a20 2020 2020 2020  tolist().       
+000167b0: 206d 6973 7369 6e67 203d 205b 7820 666f   missing = [x fo
+000167c0: 7220 7820 696e 206e 6577 5f69 6e73 2069  r x in new_ins i
+000167d0: 6620 7820 6e6f 7420 696e 2073 656c 662e  f x not in self.
+000167e0: 7472 616e 7366 6f72 6d65 722e 6b65 7973  transformer.keys
+000167f0: 2829 5d0a 2020 2020 2020 2020 6966 206c  ()].        if l
+00016800: 656e 286d 6973 7369 6e67 2920 3e20 303a  en(missing) > 0:
+00016810: 0a20 2020 2020 2020 2020 2020 2066 6f72  .            for
+00016820: 2065 6163 685f 6d69 7373 696e 6720 696e   each_missing in
+00016830: 206d 6973 7369 6e67 3a0a 2020 2020 2020   missing:.      
+00016840: 2020 2020 2020 2020 2020 7365 6c66 2e74            self.t
+00016850: 7261 6e73 666f 726d 6572 5b65 6163 685f  ransformer[each_
+00016860: 6d69 7373 696e 675d 203d 2069 6e74 2873  missing] = int(s
+00016870: 656c 662e 6d61 785f 7661 6c20 2b20 3129  elf.max_val + 1)
+00016880: 0a20 2020 2020 2020 2020 2020 2020 2020  .               
+00016890: 2073 656c 662e 696e 7665 7273 655f 7472   self.inverse_tr
+000168a0: 616e 7366 6f72 6d65 725b 696e 7428 7365  ansformer[int(se
+000168b0: 6c66 2e6d 6178 5f76 616c 2b31 295d 203d  lf.max_val+1)] =
+000168c0: 2065 6163 685f 6d69 7373 696e 670a 2020   each_missing.  
+000168d0: 2020 2020 2020 2020 2020 2020 2020 7365                se
+000168e0: 6c66 2e6d 6178 5f76 616c 203d 2069 6e74  lf.max_val = int
+000168f0: 2873 656c 662e 6d61 785f 7661 6c2b 3129  (self.max_val+1)
+00016900: 0a20 2020 2020 2020 2065 6c73 653a 0a20  .        else:. 
+00016910: 2020 2020 2020 2020 2020 2073 656c 662e             self.
+00016920: 6d61 785f 7661 6c20 3d20 6e70 2e6d 6178  max_val = np.max
+00016930: 286c 6973 7428 7365 6c66 2e74 7261 6e73  (list(self.trans
+00016940: 666f 726d 6572 2e76 616c 7565 7328 2929  former.values())
+00016950: 290a 2020 2020 2020 2020 2323 2320 546f  ).        ### To
+00016960: 2068 616e 646c 6520 6361 7465 676f 7279   handle category
+00016970: 2064 7479 7065 2079 6f75 206d 7573 7420   dtype you must 
+00016980: 646f 2074 6865 206e 6578 7420 7374 6570  do the next step
+00016990: 2023 2323 2323 0a20 2020 2020 2020 2023   #####.        #
+000169a0: 2323 2320 446f 206e 6f74 2063 6861 6e67  ### Do not chang
+000169b0: 6520 7468 6973 2073 696e 6365 2049 2068  e this since I h
+000169c0: 6176 6520 7465 7374 6564 2069 7420 616e  ave tested it an
+000169d0: 6420 6974 2077 6f72 6b73 2e0a 2020 2020  d it works..    
+000169e0: 2020 2020 7465 7374 6b20 3d20 7465 7374      testk = test
+000169f0: 782e 6d61 7028 7365 6c66 2e74 7261 6e73  x.map(self.trans
+00016a00: 666f 726d 6572 2920 0a20 2020 2020 2020  former) .       
+00016a10: 200a 2020 2020 2020 2020 6966 2074 6573   .        if tes
+00016a20: 7478 2e69 736e 756c 6c28 292e 7375 6d28  tx.isnull().sum(
+00016a30: 292e 7375 6d28 2920 3e20 303a 0a20 2020  ).sum() > 0:.   
+00016a40: 2020 2020 2020 2020 2074 7279 3a0a 2020           try:.  
+00016a50: 2020 2020 2020 2020 2020 2020 2020 6669                fi
+00016a60: 6c6c 7661 6c20 3d20 7365 6c66 2e74 7261  llval = self.tra
+00016a70: 6e73 666f 726d 6572 5b6e 702e 6e61 6e5d  nsformer[np.nan]
+00016a80: 0a20 2020 2020 2020 2020 2020 2065 7863  .            exc
+00016a90: 6570 743a 0a20 2020 2020 2020 2020 2020  ept:.           
+00016aa0: 2020 2020 2066 696c 6c76 616c 203d 202d       fillval = -
+00016ab0: 310a 2020 2020 2020 2020 2020 2020 6966  1.            if
+00016ac0: 2074 6573 7478 2e64 7479 7065 206e 6f74   testx.dtype not
+00016ad0: 2069 6e20 5b6e 702e 696e 7431 362c 206e   in [np.int16, n
+00016ae0: 702e 696e 7433 322c 206e 702e 696e 7436  p.int32, np.int6
+00016af0: 342c 2066 6c6f 6174 2c20 626f 6f6c 2c20  4, float, bool, 
+00016b00: 6f62 6a65 6374 5d3a 0a20 2020 2020 2020  object]:.       
+00016b10: 2020 2020 2020 2020 2074 6573 746b 203d           testk =
+00016b20: 2074 6573 746b 2e6d 6170 2873 656c 662e   testk.map(self.
+00016b30: 7472 616e 7366 6f72 6d65 7229 2e66 696c  transformer).fil
+00016b40: 6c6e 6128 6669 6c6c 7661 6c29 2e76 616c  lna(fillval).val
+00016b50: 7565 732e 6173 7479 7065 2869 6e74 290a  ues.astype(int).
+00016b60: 2020 2020 2020 2020 2020 2020 656c 7365              else
+00016b70: 3a0a 2020 2020 2020 2020 2020 2020 2020  :.              
+00016b80: 2020 7465 7374 6b20 3d20 7465 7374 6b2e    testk = testk.
+00016b90: 6669 6c6c 6e61 2866 696c 6c76 616c 290a  fillna(fillval).
+00016ba0: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00016bb0: 7465 7374 6b20 3d20 7465 7374 782e 6d61  testk = testx.ma
+00016bc0: 7028 7365 6c66 2e74 7261 6e73 666f 726d  p(self.transform
+00016bd0: 6572 292e 7661 6c75 6573 2e61 7374 7970  er).values.astyp
+00016be0: 6528 696e 7429 0a20 2020 2020 2020 2020  e(int).         
+00016bf0: 2020 2072 6574 7572 6e20 6e70 2e63 5f5b     return np.c_[
+00016c00: 7465 7374 6b2c 6e70 2e7a 6572 6f73 2873  testk,np.zeros(s
+00016c10: 6861 7065 3d74 6573 746b 2e73 6861 7065  hape=testk.shape
+00016c20: 295d 2e61 7374 7970 6528 696e 7429 0a20  )].astype(int). 
+00016c30: 2020 2020 2020 2065 6c73 653a 0a20 2020         else:.   
+00016c40: 2020 2020 2020 2020 2074 6573 746b 203d           testk =
+00016c50: 2074 6573 7478 2e6d 6170 2873 656c 662e   testx.map(self.
+00016c60: 7472 616e 7366 6f72 6d65 7229 2e76 616c  transformer).val
+00016c70: 7565 732e 6173 7479 7065 2869 6e74 290a  ues.astype(int).
+00016c80: 2020 2020 2020 2020 2020 2020 7265 7475              retu
+00016c90: 726e 206e 702e 635f 5b74 6573 746b 2c6e  rn np.c_[testk,n
+00016ca0: 702e 7a65 726f 7328 7368 6170 653d 7465  p.zeros(shape=te
+00016cb0: 7374 6b2e 7368 6170 6529 5d2e 6173 7479  stk.shape)].asty
+00016cc0: 7065 2869 6e74 290a 0a20 2020 2064 6566  pe(int)..    def
+00016cd0: 2069 6e76 6572 7365 5f74 7261 6e73 666f   inverse_transfo
+00016ce0: 726d 2873 656c 662c 2074 6573 7478 2c20  rm(self, testx, 
+00016cf0: 793d 4e6f 6e65 293a 0a20 2020 2020 2020  y=None):.       
+00016d00: 2023 2323 206e 6f77 2063 6f6e 7665 7274   ### now convert
+00016d10: 2074 6865 2069 6e70 7574 2074 6f20 7472   the input to tr
+00016d20: 616e 7366 6f72 6d65 7220 6469 6374 696f  ansformer dictio
+00016d30: 6e61 7279 2076 616c 7565 730a 2020 2020  nary values.    
+00016d40: 2020 2020 6966 2069 7369 6e73 7461 6e63      if isinstanc
+00016d50: 6528 7465 7374 782c 2070 642e 5365 7269  e(testx, pd.Seri
+00016d60: 6573 293a 0a20 2020 2020 2020 2020 2020  es):.           
+00016d70: 206f 7574 7320 3d20 7465 7374 782e 6d61   outs = testx.ma
+00016d80: 7028 7365 6c66 2e69 6e76 6572 7365 5f74  p(self.inverse_t
+00016d90: 7261 6e73 666f 726d 6572 292e 7661 6c75  ransformer).valu
+00016da0: 6573 0a20 2020 2020 2020 2065 6c69 6620  es.        elif 
+00016db0: 6973 696e 7374 616e 6365 2874 6573 7478  isinstance(testx
+00016dc0: 2c20 6e70 2e6e 6461 7272 6179 293a 0a20  , np.ndarray):. 
+00016dd0: 2020 2020 2020 2020 2020 206f 7574 7320             outs 
+00016de0: 3d20 7064 2e53 6572 6965 7328 7465 7374  = pd.Series(test
+00016df0: 7829 2e6d 6170 2873 656c 662e 696e 7665  x).map(self.inve
+00016e00: 7273 655f 7472 616e 7366 6f72 6d65 7229  rse_transformer)
+00016e10: 2e76 616c 7565 730a 2020 2020 2020 2020  .values.        
+00016e20: 656c 7365 3a0a 2020 2020 2020 2020 2020  else:.          
+00016e30: 2020 6f75 7473 203d 2074 6573 7478 5b3a    outs = testx[:
+00016e40: 5d0a 2020 2020 2020 2020 7265 7475 726e  ].        return
+00016e50: 206f 7574 730a 2323 2323 2323 2323 2323   outs.##########
 00016e60: 2323 2323 2323 2323 2323 2323 2323 2323  ################
 00016e70: 2323 2323 2323 2323 2323 2323 2323 2323  ################
-00016e80: 2323 2323 2323 2323 2323 230a 6672 6f6d  ###########.from
-00016e90: 2073 6b6c 6561 726e 2e69 6d70 7574 6520   sklearn.impute 
-00016ea0: 696d 706f 7274 2053 696d 706c 6549 6d70  import SimpleImp
-00016eb0: 7574 6572 0a66 726f 6d20 736b 6c65 6172  uter.from sklear
-00016ec0: 6e2e 6665 6174 7572 655f 6578 7472 6163  n.feature_extrac
-00016ed0: 7469 6f6e 2e74 6578 7420 696d 706f 7274  tion.text import
-00016ee0: 2043 6f75 6e74 5665 6374 6f72 697a 6572   CountVectorizer
-00016ef0: 2c20 5466 6964 6656 6563 746f 7269 7a65  , TfidfVectorize
-00016f00: 720a 6672 6f6d 2073 6b6c 6561 726e 2e6c  r.from sklearn.l
-00016f10: 696e 6561 725f 6d6f 6465 6c20 696d 706f  inear_model impo
-00016f20: 7274 204c 6f67 6973 7469 6352 6567 7265  rt LogisticRegre
-00016f30: 7373 696f 6e0a 6672 6f6d 2073 6b6c 6561  ssion.from sklea
-00016f40: 726e 2e63 6f6d 706f 7365 2069 6d70 6f72  rn.compose impor
-00016f50: 7420 6d61 6b65 5f63 6f6c 756d 6e5f 7472  t make_column_tr
-00016f60: 616e 7366 6f72 6d65 720a 6672 6f6d 2073  ansformer.from s
-00016f70: 6b6c 6561 726e 2e70 7265 7072 6f63 6573  klearn.preproces
-00016f80: 7369 6e67 2069 6d70 6f72 7420 4c61 6265  sing import Labe
-00016f90: 6c45 6e63 6f64 6572 2c20 4c61 6265 6c42  lEncoder, LabelB
-00016fa0: 696e 6172 697a 6572 0a69 6d70 6f72 7420  inarizer.import 
-00016fb0: 7064 620a 6672 6f6d 2063 6f6c 6c65 6374  pdb.from collect
-00016fc0: 696f 6e73 2069 6d70 6f72 7420 6465 6661  ions import defa
-00016fd0: 756c 7464 6963 742c 2043 6f75 6e74 6572  ultdict, Counter
-00016fe0: 0a23 2323 2054 6865 7365 2069 6d70 6f72  .### These impor
-00016ff0: 7473 2067 6976 6520 6669 745f 7472 616e  ts give fit_tran
-00017000: 7366 6f72 6d20 6d65 7468 6f64 2066 6f72  sform method for
-00017010: 2066 7265 6520 2323 230a 6672 6f6d 2073   free ###.from s
-00017020: 6b6c 6561 726e 2e62 6173 6520 696d 706f  klearn.base impo
-00017030: 7274 2042 6173 6545 7374 696d 6174 6f72  rt BaseEstimator
-00017040: 2c20 5472 616e 7366 6f72 6d65 724d 6978  , TransformerMix
-00017050: 696e 200a 6672 6f6d 2073 6b6c 6561 726e  in .from sklearn
-00017060: 2e75 7469 6c73 2e76 616c 6964 6174 696f  .utils.validatio
-00017070: 6e20 696d 706f 7274 2063 6f6c 756d 6e5f  n import column_
-00017080: 6f72 5f31 640a 6672 6f6d 2073 6b6c 6561  or_1d.from sklea
-00017090: 726e 2e62 6173 6520 696d 706f 7274 2052  rn.base import R
-000170a0: 6567 7265 7373 6f72 4d69 7869 6e2c 2043  egressorMixin, C
-000170b0: 6c61 7373 6966 6965 724d 6978 696e 0a66  lassifierMixin.f
-000170c0: 726f 6d20 736b 6c65 6172 6e2e 7072 6570  rom sklearn.prep
-000170d0: 726f 6365 7373 696e 6720 696d 706f 7274  rocessing import
-000170e0: 2046 756e 6374 696f 6e54 7261 6e73 666f   FunctionTransfo
-000170f0: 726d 6572 0a66 726f 6d20 736b 6c65 6172  rmer.from sklear
-00017100: 6e2e 7072 6570 726f 6365 7373 696e 6720  n.preprocessing 
-00017110: 696d 706f 7274 204d 6178 4162 7353 6361  import MaxAbsSca
-00017120: 6c65 722c 2053 7461 6e64 6172 6453 6361  ler, StandardSca
-00017130: 6c65 722c 204d 696e 4d61 7853 6361 6c65  ler, MinMaxScale
-00017140: 720a 6672 6f6d 2073 6b6c 6561 726e 2e70  r.from sklearn.p
-00017150: 7265 7072 6f63 6573 7369 6e67 2069 6d70  reprocessing imp
-00017160: 6f72 7420 526f 6275 7374 5363 616c 6572  ort RobustScaler
-00017170: 0a66 726f 6d20 736b 6c65 6172 6e2e 656e  .from sklearn.en
-00017180: 7365 6d62 6c65 2069 6d70 6f72 7420 5261  semble import Ra
-00017190: 6e64 6f6d 466f 7265 7374 436c 6173 7369  ndomForestClassi
-000171a0: 6669 6572 2c20 5261 6e64 6f6d 466f 7265  fier, RandomFore
-000171b0: 7374 5265 6772 6573 736f 720a 6672 6f6d  stRegressor.from
-000171c0: 2073 6b6c 6561 726e 2e74 7265 6520 696d   sklearn.tree im
-000171d0: 706f 7274 2045 7874 7261 5472 6565 5265  port ExtraTreeRe
-000171e0: 6772 6573 736f 722c 2045 7874 7261 5472  gressor, ExtraTr
-000171f0: 6565 436c 6173 7369 6669 6572 0a66 726f  eeClassifier.fro
-00017200: 6d20 736b 6c65 6172 6e2e 6465 636f 6d70  m sklearn.decomp
-00017210: 6f73 6974 696f 6e20 696d 706f 7274 2054  osition import T
-00017220: 7275 6e63 6174 6564 5356 440a 6672 6f6d  runcatedSVD.from
-00017230: 2073 6b6c 6561 726e 2e6d 6f64 656c 5f73   sklearn.model_s
-00017240: 656c 6563 7469 6f6e 2069 6d70 6f72 7420  election import 
-00017250: 4772 6964 5365 6172 6368 4356 2c20 5261  GridSearchCV, Ra
-00017260: 6e64 6f6d 697a 6564 5365 6172 6368 4356  ndomizedSearchCV
-00017270: 0a66 726f 6d20 736b 6c65 6172 6e2e 6d65  .from sklearn.me
-00017280: 7472 6963 7320 696d 706f 7274 206d 6561  trics import mea
-00017290: 6e5f 7371 7561 7265 645f 6c6f 675f 6572  n_squared_log_er
-000172a0: 726f 722c 206d 6561 6e5f 7371 7561 7265  ror, mean_square
-000172b0: 645f 6572 726f 722c 6261 6c61 6e63 6564  d_error,balanced
-000172c0: 5f61 6363 7572 6163 795f 7363 6f72 650a  _accuracy_score.
-000172d0: 696d 706f 7274 2067 630a 2323 2323 2323  import gc.######
-000172e0: 2323 2323 2323 2323 2020 5468 6573 6520  ########  These 
-000172f0: 696d 706f 7274 7320 6172 6520 746f 206d  imports are to m
-00017300: 616b 6520 7472 6f75 626c 6520 7368 6f6f  ake trouble shoo
-00017310: 7469 6e67 2065 6173 6965 7220 2323 2323  ting easier ####
-00017320: 230a 696d 706f 7274 2074 696d 650a 696d  #.import time.im
-00017330: 706f 7274 2063 6f70 790a 696d 706f 7274  port copy.import
-00017340: 206f 730a 696d 706f 7274 2070 6963 6b6c   os.import pickl
-00017350: 650a 696d 706f 7274 2073 6369 7079 0a69  e.import scipy.i
-00017360: 6d70 6f72 7420 7761 726e 696e 6773 0a77  mport warnings.w
-00017370: 6172 6e69 6e67 732e 6669 6c74 6572 7761  arnings.filterwa
-00017380: 726e 696e 6773 2822 6967 6e6f 7265 2229  rnings("ignore")
-00017390: 0a23 2323 2323 2323 2323 2323 2323 2323  .###############
-000173a0: 2323 2323 2323 2323 2323 2323 2323 2323  ################
-000173b0: 2323 2323 2323 2323 2323 2323 2323 2323  ################
-000173c0: 2323 2323 2323 2323 2323 230a 6672 6f6d  ###########.from
-000173d0: 2063 6174 6567 6f72 795f 656e 636f 6465   category_encode
-000173e0: 7273 2069 6d70 6f72 7420 4861 7368 696e  rs import Hashin
-000173f0: 6745 6e63 6f64 6572 2c20 506f 6c79 6e6f  gEncoder, Polyno
-00017400: 6d69 616c 456e 636f 6465 722c 2042 6163  mialEncoder, Bac
-00017410: 6b77 6172 6444 6966 6665 7265 6e63 6545  kwardDifferenceE
-00017420: 6e63 6f64 6572 0a66 726f 6d20 6361 7465  ncoder.from cate
-00017430: 676f 7279 5f65 6e63 6f64 6572 732e 7375  gory_encoders.su
-00017440: 6d5f 636f 6469 6e67 2069 6d70 6f72 7420  m_coding import 
-00017450: 5375 6d45 6e63 6f64 6572 0a66 726f 6d20  SumEncoder.from 
-00017460: 6361 7465 676f 7279 5f65 6e63 6f64 6572  category_encoder
-00017470: 732e 6c65 6176 655f 6f6e 655f 6f75 7420  s.leave_one_out 
-00017480: 696d 706f 7274 204c 6561 7665 4f6e 654f  import LeaveOneO
-00017490: 7574 456e 636f 6465 720a 6672 6f6d 2063  utEncoder.from c
-000174a0: 6174 6567 6f72 795f 656e 636f 6465 7273  ategory_encoders
-000174b0: 2069 6d70 6f72 7420 4865 6c6d 6572 7445   import HelmertE
-000174c0: 6e63 6f64 6572 2c20 4f72 6469 6e61 6c45  ncoder, OrdinalE
-000174d0: 6e63 6f64 6572 2c20 436f 756e 7445 6e63  ncoder, CountEnc
-000174e0: 6f64 6572 2c20 4261 7365 4e45 6e63 6f64  oder, BaseNEncod
-000174f0: 6572 0a66 726f 6d20 6361 7465 676f 7279  er.from category
-00017500: 5f65 6e63 6f64 6572 7320 696d 706f 7274  _encoders import
-00017510: 2054 6172 6765 7445 6e63 6f64 6572 2c20   TargetEncoder, 
-00017520: 4361 7442 6f6f 7374 456e 636f 6465 722c  CatBoostEncoder,
-00017530: 2057 4f45 456e 636f 6465 722c 204a 616d   WOEEncoder, Jam
-00017540: 6573 5374 6569 6e45 6e63 6f64 6572 0a66  esSteinEncoder.f
-00017550: 726f 6d20 6361 7465 676f 7279 5f65 6e63  rom category_enc
-00017560: 6f64 6572 732e 676c 6d6d 2069 6d70 6f72  oders.glmm impor
-00017570: 7420 474c 4d4d 456e 636f 6465 720a 6672  t GLMMEncoder.fr
-00017580: 6f6d 2073 6b6c 6561 726e 2e70 7265 7072  om sklearn.prepr
-00017590: 6f63 6573 7369 6e67 2069 6d70 6f72 7420  ocessing import 
-000175a0: 4c61 6265 6c45 6e63 6f64 6572 0a66 726f  LabelEncoder.fro
-000175b0: 6d20 6361 7465 676f 7279 5f65 6e63 6f64  m category_encod
-000175c0: 6572 732e 7772 6170 7065 7220 696d 706f  ers.wrapper impo
-000175d0: 7274 2050 6f6c 796e 6f6d 6961 6c57 7261  rt PolynomialWra
-000175e0: 7070 6572 0a66 726f 6d20 6361 7465 676f  pper.from catego
-000175f0: 7279 5f65 6e63 6f64 6572 7320 696d 706f  ry_encoders impo
-00017600: 7274 204f 6e65 486f 7445 6e63 6f64 6572  rt OneHotEncoder
-00017610: 0a66 726f 6d20 696d 626c 6561 726e 2e6f  .from imblearn.o
-00017620: 7665 725f 7361 6d70 6c69 6e67 2069 6d70  ver_sampling imp
-00017630: 6f72 7420 534d 4f54 452c 2042 6f72 6465  ort SMOTE, Borde
-00017640: 726c 696e 6553 4d4f 5445 2c20 534d 4f54  rlineSMOTE, SMOT
-00017650: 454e 430a 6672 6f6d 2073 6b6c 6561 726e  ENC.from sklearn
-00017660: 2e70 6970 656c 696e 6520 696d 706f 7274  .pipeline import
-00017670: 206d 616b 655f 7069 7065 6c69 6e65 2c20   make_pipeline, 
-00017680: 5069 7065 6c69 6e65 0a23 6672 6f6d 2073  Pipeline.#from s
-00017690: 6b6c 6561 726e 2e70 7265 7072 6f63 6573  klearn.preproces
-000176a0: 7369 6e67 2069 6d70 6f72 7420 4f6e 6548  sing import OneH
-000176b0: 6f74 456e 636f 6465 720a 6672 6f6d 2074  otEncoder.from t
-000176c0: 7164 6d20 696d 706f 7274 2074 7164 6d0a  qdm import tqdm.
-000176d0: 6672 6f6d 2073 6b6c 6561 726e 2e6d 6f64  from sklearn.mod
-000176e0: 656c 5f73 656c 6563 7469 6f6e 2069 6d70  el_selection imp
-000176f0: 6f72 7420 5469 6d65 5365 7269 6573 5370  ort TimeSeriesSp
-00017700: 6c69 740a 2323 2323 2323 2323 2323 2323  lit.############
-00017710: 2323 2323 2323 2323 2323 2323 2323 2323  ################
-00017720: 2323 2323 2323 2323 2323 2323 2323 2323  ################
-00017730: 2323 2323 2323 2323 2323 2323 230a 636c  #############.cl
-00017740: 6173 7320 4d79 5f4c 6162 656c 456e 636f  ass My_LabelEnco
-00017750: 6465 7228 4261 7365 4573 7469 6d61 746f  der(BaseEstimato
-00017760: 722c 2054 7261 6e73 666f 726d 6572 4d69  r, TransformerMi
-00017770: 7869 6e29 3a0a 2020 2020 2222 220a 2020  xin):.    """.  
-00017780: 2020 2323 2323 2323 2323 2323 2323 2323    ##############
-00017790: 2323 2323 2323 2323 2323 2323 2323 2323  ################
-000177a0: 2323 2323 2323 2323 2323 2323 2323 2323  ################
-000177b0: 2323 2323 2323 2323 2323 2323 2323 2323  ################
-000177c0: 2323 2323 2323 2323 2323 2323 2323 2323  ################
-000177d0: 2323 2323 2323 2323 2323 2323 2323 2323  ################
-000177e0: 2323 0a20 2020 2023 2323 2323 2320 2020  ##.    ######   
-000177f0: 2020 5468 6520 4d79 5f4c 6162 656c 456e    The My_LabelEn
-00017800: 636f 6465 7220 636c 6173 7320 776f 726b  coder class work
-00017810: 7320 6a75 7374 206c 696b 6520 736b 6c65  s just like skle
-00017820: 6172 6e27 7320 4c61 6265 6c20 456e 636f  arn's Label Enco
-00017830: 6465 7220 6275 7420 6265 7474 6572 2120  der but better! 
-00017840: 2323 2323 2323 230a 2020 2020 2323 2323  #######.    ####
-00017850: 2320 2049 7420 6c61 6265 6c20 656e 636f  #  It label enco
-00017860: 6465 7320 616e 7920 6f62 6a65 6374 206f  des any object o
-00017870: 7220 6361 7465 676f 7279 2064 7479 7065  r category dtype
-00017880: 2069 6e20 796f 7572 2064 6174 6173 6574   in your dataset
-00017890: 2e20 4974 2061 6c73 6f20 6861 6e64 6c65  . It also handle
-000178a0: 7320 4e61 4e27 732e 2323 2323 0a20 2020  s NaN's.####.   
-000178b0: 2023 2320 2054 6865 2062 6561 7574 7920   ##  The beauty 
-000178c0: 6f66 2074 6869 7320 6675 6e63 7469 6f6e  of this function
-000178d0: 2069 7320 7468 6174 2069 7420 7461 6b65   is that it take
-000178e0: 7320 6361 7265 206f 6620 656e 636f 6469  s care of encodi
-000178f0: 6e67 2075 6e6b 6e6f 776e 2028 6675 7475  ng unknown (futu
-00017900: 7265 2920 7661 6c75 6573 2e20 2323 2323  re) values. ####
-00017910: 230a 2020 2020 2323 2323 2323 2323 2323  #.    ##########
-00017920: 2323 2323 2323 2323 2323 2320 5468 6973  ########### This
-00017930: 2069 7320 7468 6520 4245 5354 2077 6f72   is the BEST wor
-00017940: 6b69 6e67 2076 6572 7369 6f6e 202d 2064  king version - d
-00017950: 6f6e 2774 206d 6573 7320 7769 7468 2069  on't mess with i
-00017960: 7421 2120 2323 2323 2323 2323 2323 2323  t!! ############
-00017970: 2323 2323 2323 0a20 2020 2023 2323 2323  ######.    #####
-00017980: 2323 2323 2323 2323 2323 2323 2323 2323  ################
-00017990: 2323 2323 2323 2323 2323 2323 2323 2323  ################
-000179a0: 2323 2323 2323 2323 2323 2323 2323 2323  ################
-000179b0: 2323 2323 2323 2323 2323 2323 2323 2323  ################
-000179c0: 2323 2323 2323 2323 2323 2323 2323 2323  ################
-000179d0: 2323 2323 2323 2323 2323 230a 2020 2020  ###########.    
-000179e0: 5573 6167 653a 0a20 2020 2020 2020 2020  Usage:.         
-000179f0: 206c 6520 3d20 4d79 5f4c 6162 656c 456e   le = My_LabelEn
-00017a00: 636f 6465 7228 290a 2020 2020 2020 2020  coder().        
-00017a10: 2020 6c65 2e66 6974 5f74 7261 6e73 666f    le.fit_transfo
-00017a20: 726d 2874 7261 696e 5b63 6f6c 756d 6e5d  rm(train[column]
-00017a30: 2920 2323 2074 6869 7320 7769 6c6c 2067  ) ## this will g
-00017a40: 6976 6520 796f 7572 2074 7261 6e73 666f  ive your transfo
-00017a50: 726d 6564 2076 616c 7565 7320 6173 2061  rmed values as a
-00017a60: 6e20 6172 7261 790a 2020 2020 2020 2020  n array.        
-00017a70: 2020 6c65 2e74 7261 6e73 666f 726d 2874    le.transform(t
-00017a80: 6573 745b 636f 6c75 6d6e 5d29 2023 2323  est[column]) ###
-00017a90: 2074 6869 7320 7769 6c6c 2067 6976 6520   this will give 
-00017aa0: 796f 7572 2074 7261 6e73 666f 726d 6564  your transformed
-00017ab0: 2076 616c 7565 7320 6173 2061 6e20 6172   values as an ar
-00017ac0: 7261 790a 2020 2020 2020 2020 2020 2020  ray.            
-00017ad0: 2020 0a20 2020 2055 7361 6765 2069 6e20    .    Usage in 
-00017ae0: 436f 6c75 6d6e 2054 7261 6e73 666f 726d  Column Transform
-00017af0: 6572 7320 616e 6420 5069 7065 6c69 6e65  ers and Pipeline
-00017b00: 733a 0a20 2020 2020 2020 2020 204e 6f2e  s:.          No.
-00017b10: 2049 7420 6361 6e6e 6f74 2062 6520 7573   It cannot be us
-00017b20: 6564 2069 6e20 7069 7065 6c69 6e65 7320  ed in pipelines 
-00017b30: 7369 6e63 6520 6974 206e 6565 6420 746f  since it need to
-00017b40: 2070 726f 6475 6365 2074 776f 2063 6f6c   produce two col
-00017b50: 756d 6e73 2066 6f72 2074 6865 206e 6578  umns for the nex
-00017b60: 7420 7374 6167 6520 696e 2070 6970 656c  t stage in pipel
-00017b70: 696e 652e 0a20 2020 2020 2020 2020 2053  ine..          S
-00017b80: 6565 206d 7920 6f74 6865 7220 6d6f 6475  ee my other modu
-00017b90: 6c65 2063 616c 6c65 6420 4d79 5f4c 6162  le called My_Lab
-00017ba0: 656c 456e 636f 6465 725f 5069 7065 2829  elEncoder_Pipe()
-00017bb0: 2074 6f20 7365 6520 686f 7720 6974 2063   to see how it c
-00017bc0: 616e 2062 6520 7573 6564 2069 6e20 5069  an be used in Pi
-00017bd0: 7065 6c69 6e65 732e 0a20 2020 2022 2222  pelines..    """
-00017be0: 0a20 2020 2064 6566 205f 5f69 6e69 745f  .    def __init_
-00017bf0: 5f28 7365 6c66 293a 0a20 2020 2020 2020  _(self):.       
-00017c00: 2073 656c 662e 7472 616e 7366 6f72 6d65   self.transforme
-00017c10: 7220 3d20 6465 6661 756c 7464 6963 7428  r = defaultdict(
-00017c20: 7374 7229 0a20 2020 2020 2020 2073 656c  str).        sel
-00017c30: 662e 696e 7665 7273 655f 7472 616e 7366  f.inverse_transf
-00017c40: 6f72 6d65 7220 3d20 6465 6661 756c 7464  ormer = defaultd
-00017c50: 6963 7428 7374 7229 0a20 2020 2020 2020  ict(str).       
-00017c60: 2073 656c 662e 6d61 785f 7661 6c20 3d20   self.max_val = 
-00017c70: 300a 2020 2020 2020 2020 0a20 2020 2064  0.        .    d
-00017c80: 6566 2066 6974 2873 656c 662c 7465 7374  ef fit(self,test
-00017c90: 782c 2079 3d4e 6f6e 6529 3a0a 2020 2020  x, y=None):.    
-00017ca0: 2020 2020 2323 2320 446f 206e 6f74 2063      ### Do not c
-00017cb0: 6861 6e67 6520 7468 6973 2073 696e 6365  hange this since
-00017cc0: 2052 6172 6520 636c 6173 7320 636f 6d62   Rare class comb
-00017cd0: 696e 6572 2072 6571 7569 7265 7320 7468  iner requires th
-00017ce0: 6973 2074 6573 7420 2323 0a20 2020 2020  is test ##.     
-00017cf0: 2020 2069 6620 6973 696e 7374 616e 6365     if isinstance
-00017d00: 2874 6573 7478 2c20 7475 706c 6529 3a0a  (testx, tuple):.
-00017d10: 2020 2020 2020 2020 2020 2020 7920 3d20              y = 
-00017d20: 7465 7374 785b 315d 0a20 2020 2020 2020  testx[1].       
-00017d30: 2020 2020 2074 6573 7478 203d 2074 6573       testx = tes
-00017d40: 7478 5b30 5d0a 2020 2020 2020 2020 2323  tx[0].        ##
-00017d50: 2074 6573 7478 206d 7573 7420 7374 696c   testx must stil
-00017d60: 6c20 6265 2061 2070 642e 5365 7269 6573  l be a pd.Series
-00017d70: 2066 6f72 2074 6869 7320 656e 636f 6465   for this encode
-00017d80: 7220 746f 2077 6f72 6b21 0a20 2020 2020  r to work!.     
-00017d90: 2020 2069 6620 6973 696e 7374 616e 6365     if isinstance
-00017da0: 2874 6573 7478 2c20 7064 2e53 6572 6965  (testx, pd.Serie
-00017db0: 7329 3a0a 2020 2020 2020 2020 2020 2020  s):.            
-00017dc0: 7061 7373 0a20 2020 2020 2020 2065 6c69  pass.        eli
-00017dd0: 6620 6973 696e 7374 616e 6365 2874 6573  f isinstance(tes
-00017de0: 7478 2c20 6e70 2e6e 6461 7272 6179 293a  tx, np.ndarray):
-00017df0: 0a20 2020 2020 2020 2020 2020 2074 6573  .            tes
-00017e00: 7478 203d 2070 642e 5365 7269 6573 2874  tx = pd.Series(t
-00017e10: 6573 7478 290a 2020 2020 2020 2020 656c  estx).        el
-00017e20: 7365 3a0a 2020 2020 2020 2020 2020 2020  se:.            
-00017e30: 2323 2323 2054 6865 7265 2069 7320 6e6f  #### There is no
-00017e40: 2077 6179 2074 6f20 7472 616e 7366 6f72   way to transfor
-00017e50: 6d20 6461 7461 6672 616d 6573 2073 696e  m dataframes sin
-00017e60: 6365 2079 6f75 2077 696c 6c20 6765 7420  ce you will get 
-00017e70: 6120 6e65 7374 6564 2072 656e 616d 6572  a nested renamer
-00017e80: 2065 7272 6f72 2069 6620 796f 7520 7472   error if you tr
-00017e90: 7920 2323 230a 2020 2020 2020 2020 2020  y ###.          
-00017ea0: 2020 2323 2320 4275 7420 6966 2069 7420    ### But if it 
-00017eb0: 6973 2061 206f 6e65 2d64 696d 656e 7369  is a one-dimensi
-00017ec0: 6f6e 616c 2064 6174 6166 7261 6d65 2c20  onal dataframe, 
-00017ed0: 636f 6e76 6572 7420 6974 2069 6e74 6f20  convert it into 
-00017ee0: 6120 5365 7269 6573 0a20 2020 2020 2020  a Series.       
-00017ef0: 2020 2020 2023 2323 2320 446f 206e 6f74       #### Do not
-00017f00: 2063 6861 6e67 6520 7468 6973 2073 696e   change this sin
-00017f10: 6365 2049 2068 6176 6520 7465 7374 6564  ce I have tested
-00017f20: 2069 7420 616e 6420 6974 2077 6f72 6b73   it and it works
-00017f30: 2e0a 2020 2020 2020 2020 2020 2020 6966  ..            if
-00017f40: 2074 6573 7478 2e73 6861 7065 5b31 5d20   testx.shape[1] 
-00017f50: 3d3d 2031 3a0a 2020 2020 2020 2020 2020  == 1:.          
-00017f60: 2020 2020 2020 7465 7374 7820 3d20 7064        testx = pd
-00017f70: 2e53 6572 6965 7328 7465 7374 782e 7661  .Series(testx.va
-00017f80: 6c75 6573 2e72 6176 656c 2829 2c6e 616d  lues.ravel(),nam
-00017f90: 653d 7465 7374 782e 636f 6c75 6d6e 735b  e=testx.columns[
-00017fa0: 305d 290a 2020 2020 2020 2020 2020 2020  0]).            
-00017fb0: 656c 7365 3a0a 2020 2020 2020 2020 2020  else:.          
-00017fc0: 2020 2020 2020 2323 2323 2053 696e 6365        #### Since
-00017fd0: 2069 7420 6973 206d 756c 7469 2d64 696d   it is multi-dim
-00017fe0: 656e 7369 6f6e 616c 2c20 536f 2069 6e20  ensional, So in 
-00017ff0: 7468 6973 2063 6173 652c 206a 7573 7420  this case, just 
-00018000: 7265 7475 726e 2074 6865 206f 626a 6563  return the objec
-00018010: 7420 6173 2069 730a 2020 2020 2020 2020  t as is.        
-00018020: 2020 2020 2020 2020 7265 7475 726e 2073          return s
-00018030: 656c 660a 2020 2020 2020 2020 696e 7320  elf.        ins 
-00018040: 3d20 6e70 2e75 6e69 7175 6528 7465 7374  = np.unique(test
-00018050: 782e 6661 6374 6f72 697a 6528 295b 315d  x.factorize()[1]
-00018060: 292e 746f 6c69 7374 2829 0a20 2020 2020  ).tolist().     
-00018070: 2020 206f 7574 7320 3d20 6e70 2e75 6e69     outs = np.uni
-00018080: 7175 6528 7465 7374 782e 6661 6374 6f72  que(testx.factor
-00018090: 697a 6528 295b 305d 292e 746f 6c69 7374  ize()[0]).tolist
-000180a0: 2829 0a20 2020 2020 2020 2023 696e 7320  ().        #ins 
-000180b0: 3d20 7465 7374 782e 7661 6c75 655f 636f  = testx.value_co
-000180c0: 756e 7473 2864 726f 706e 613d 4661 6c73  unts(dropna=Fals
-000180d0: 6529 2e69 6e64 6578 2020 2020 2020 2020  e).index        
-000180e0: 0a20 2020 2020 2020 2069 6620 2d31 2069  .        if -1 i
-000180f0: 6e20 6f75 7473 3a0a 2020 2020 2020 2020  n outs:.        
-00018100: 2320 2020 6974 2061 6c72 6561 6479 2068  #   it already h
-00018110: 6173 206e 616e 2069 6620 2d31 2069 7320  as nan if -1 is 
-00018120: 696e 206f 7574 732e 204e 6f20 6e65 6564  in outs. No need
-00018130: 2074 6f20 6164 6420 6974 2e0a 2020 2020   to add it..    
-00018140: 2020 2020 2020 2020 6966 206e 6f74 206e          if not n
-00018150: 702e 6e61 6e20 696e 2069 6e73 3a0a 2020  p.nan in ins:.  
-00018160: 2020 2020 2020 2020 2020 2020 2020 696e                in
-00018170: 732e 696e 7365 7274 2830 2c6e 702e 6e61  s.insert(0,np.na
-00018180: 6e29 0a20 2020 2020 2020 2073 656c 662e  n).        self.
-00018190: 7472 616e 7366 6f72 6d65 7220 3d20 6469  transformer = di
-000181a0: 6374 287a 6970 2869 6e73 2c6f 7574 7329  ct(zip(ins,outs)
-000181b0: 290a 2020 2020 2020 2020 7365 6c66 2e69  ).        self.i
-000181c0: 6e76 6572 7365 5f74 7261 6e73 666f 726d  nverse_transform
-000181d0: 6572 203d 2064 6963 7428 7a69 7028 6f75  er = dict(zip(ou
-000181e0: 7473 2c69 6e73 2929 0a20 2020 2020 2020  ts,ins)).       
-000181f0: 2072 6574 7572 6e20 7365 6c66 0a0a 2020   return self..  
-00018200: 2020 6465 6620 7472 616e 7366 6f72 6d28    def transform(
-00018210: 7365 6c66 2c20 7465 7374 782c 2079 3d4e  self, testx, y=N
-00018220: 6f6e 6529 3a0a 2020 2020 2020 2020 2323  one):.        ##
-00018230: 2320 446f 206e 6f74 2063 6861 6e67 6520  # Do not change 
-00018240: 7468 6973 2073 696e 6365 2052 6172 6520  this since Rare 
-00018250: 636c 6173 7320 636f 6d62 696e 6572 2072  class combiner r
-00018260: 6571 7569 7265 7320 7468 6973 2074 6573  equires this tes
-00018270: 7420 2323 0a20 2020 2020 2020 2069 6620  t ##.        if 
-00018280: 6973 696e 7374 616e 6365 2874 6573 7478  isinstance(testx
-00018290: 2c20 7475 706c 6529 3a0a 2020 2020 2020  , tuple):.      
-000182a0: 2020 2020 2020 7920 3d20 7465 7374 785b        y = testx[
-000182b0: 315d 0a20 2020 2020 2020 2020 2020 2074  1].            t
-000182c0: 6573 7478 203d 2074 6573 7478 5b30 5d0a  estx = testx[0].
-000182d0: 2020 2020 2020 2020 2323 2074 6573 7478          ## testx
-000182e0: 206d 7573 7420 7374 696c 6c20 6265 2061   must still be a
-000182f0: 2070 642e 5365 7269 6573 2066 6f72 2074   pd.Series for t
-00018300: 6869 7320 656e 636f 6465 7220 746f 2077  his encoder to w
-00018310: 6f72 6b21 0a20 2020 2020 2020 2069 6620  ork!.        if 
-00018320: 6973 696e 7374 616e 6365 2874 6573 7478  isinstance(testx
-00018330: 2c20 7064 2e53 6572 6965 7329 3a0a 2020  , pd.Series):.  
-00018340: 2020 2020 2020 2020 2020 7061 7373 0a20            pass. 
-00018350: 2020 2020 2020 2065 6c69 6620 6973 696e         elif isin
-00018360: 7374 616e 6365 2874 6573 7478 2c20 6e70  stance(testx, np
-00018370: 2e6e 6461 7272 6179 293a 0a20 2020 2020  .ndarray):.     
-00018380: 2020 2020 2020 2074 6573 7478 203d 2070         testx = p
-00018390: 642e 5365 7269 6573 2874 6573 7478 290a  d.Series(testx).
-000183a0: 2020 2020 2020 2020 656c 7365 3a0a 2020          else:.  
-000183b0: 2020 2020 2020 2020 2020 2323 2323 2054            #### T
-000183c0: 6865 7265 2069 7320 6e6f 2077 6179 2074  here is no way t
-000183d0: 6f20 7472 616e 7366 6f72 6d20 6461 7461  o transform data
-000183e0: 6672 616d 6573 2073 696e 6365 2079 6f75  frames since you
-000183f0: 2077 696c 6c20 6765 7420 6120 6e65 7374   will get a nest
-00018400: 6564 2072 656e 616d 6572 2065 7272 6f72  ed renamer error
-00018410: 2069 6620 796f 7520 7472 7920 2323 230a   if you try ###.
-00018420: 2020 2020 2020 2020 2020 2020 2323 2320              ### 
-00018430: 4275 7420 6966 2069 7420 6973 2061 206f  But if it is a o
-00018440: 6e65 2d64 696d 656e 7369 6f6e 616c 2064  ne-dimensional d
-00018450: 6174 6166 7261 6d65 2c20 636f 6e76 6572  ataframe, conver
-00018460: 7420 6974 2069 6e74 6f20 6120 5365 7269  t it into a Seri
-00018470: 6573 0a20 2020 2020 2020 2020 2020 2023  es.            #
-00018480: 2323 2320 446f 206e 6f74 2063 6861 6e67  ### Do not chang
-00018490: 6520 7468 6973 2073 696e 6365 2049 2068  e this since I h
-000184a0: 6176 6520 7465 7374 6564 2069 7420 616e  ave tested it an
-000184b0: 6420 6974 2077 6f72 6b73 2e0a 2020 2020  d it works..    
-000184c0: 2020 2020 2020 2020 6966 2074 6573 7478          if testx
-000184d0: 2e73 6861 7065 5b31 5d20 3d3d 2031 3a0a  .shape[1] == 1:.
-000184e0: 2020 2020 2020 2020 2020 2020 2020 2020                  
-000184f0: 7465 7374 7820 3d20 7064 2e53 6572 6965  testx = pd.Serie
-00018500: 7328 7465 7374 782e 7661 6c75 6573 2e72  s(testx.values.r
-00018510: 6176 656c 2829 2c6e 616d 653d 7465 7374  avel(),name=test
-00018520: 782e 636f 6c75 6d6e 735b 305d 290a 2020  x.columns[0]).  
-00018530: 2020 2020 2020 2020 2020 656c 7365 3a0a            else:.
-00018540: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00018550: 2323 2323 2053 696e 6365 2069 7420 6973  #### Since it is
-00018560: 206d 756c 7469 2d64 696d 656e 7369 6f6e   multi-dimension
-00018570: 616c 2c20 536f 2069 6e20 7468 6973 2063  al, So in this c
-00018580: 6173 652c 206a 7573 7420 7265 7475 726e  ase, just return
-00018590: 2074 6865 2064 6174 6120 6173 2069 730a   the data as is.
-000185a0: 2020 2020 2020 2020 2020 2020 2020 2020                  
-000185b0: 2323 2323 2044 6f20 6e6f 7420 6368 616e  #### Do not chan
-000185c0: 6765 2074 6869 7320 7369 6e63 6520 4920  ge this since I 
-000185d0: 6861 7665 2074 6573 7465 6420 6974 2061  have tested it a
-000185e0: 6e64 2069 7420 776f 726b 732e 0a20 2020  nd it works..   
-000185f0: 2020 2020 2020 2020 2020 2020 2072 6574               ret
-00018600: 7572 6e20 7465 7374 780a 2020 2020 2020  urn testx.      
-00018610: 2020 2323 2320 6e6f 7720 636f 6e76 6572    ### now conver
-00018620: 7420 7468 6520 696e 7075 7420 746f 2074  t the input to t
-00018630: 7261 6e73 666f 726d 6572 2064 6963 7469  ransformer dicti
-00018640: 6f6e 6172 7920 7661 6c75 6573 0a20 2020  onary values.   
-00018650: 2020 2020 206e 6577 5f69 6e73 203d 206e       new_ins = n
-00018660: 702e 756e 6971 7565 2874 6573 7478 2e66  p.unique(testx.f
-00018670: 6163 746f 7269 7a65 2829 5b31 5d29 2e74  actorize()[1]).t
-00018680: 6f6c 6973 7428 290a 2020 2020 2020 2020  olist().        
-00018690: 6d69 7373 696e 6720 3d20 5b78 2066 6f72  missing = [x for
-000186a0: 2078 2069 6e20 6e65 775f 696e 7320 6966   x in new_ins if
-000186b0: 2078 206e 6f74 2069 6e20 7365 6c66 2e74   x not in self.t
-000186c0: 7261 6e73 666f 726d 6572 2e6b 6579 7328  ransformer.keys(
-000186d0: 295d 0a20 2020 2020 2020 2069 6620 6c65  )].        if le
-000186e0: 6e28 6d69 7373 696e 6729 203e 2030 3a0a  n(missing) > 0:.
-000186f0: 2020 2020 2020 2020 2020 2020 666f 7220              for 
-00018700: 6561 6368 5f6d 6973 7369 6e67 2069 6e20  each_missing in 
-00018710: 6d69 7373 696e 673a 0a20 2020 2020 2020  missing:.       
-00018720: 2020 2020 2020 2020 2073 656c 662e 7472           self.tr
-00018730: 616e 7366 6f72 6d65 725b 6561 6368 5f6d  ansformer[each_m
-00018740: 6973 7369 6e67 5d20 3d20 696e 7428 7365  issing] = int(se
-00018750: 6c66 2e6d 6178 5f76 616c 202b 2031 290a  lf.max_val + 1).
-00018760: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00018770: 7365 6c66 2e69 6e76 6572 7365 5f74 7261  self.inverse_tra
-00018780: 6e73 666f 726d 6572 5b69 6e74 2873 656c  nsformer[int(sel
-00018790: 662e 6d61 785f 7661 6c2b 3129 5d20 3d20  f.max_val+1)] = 
-000187a0: 6561 6368 5f6d 6973 7369 6e67 0a20 2020  each_missing.   
-000187b0: 2020 2020 2020 2020 2020 2020 2073 656c               sel
-000187c0: 662e 6d61 785f 7661 6c20 3d20 696e 7428  f.max_val = int(
-000187d0: 7365 6c66 2e6d 6178 5f76 616c 2b31 290a  self.max_val+1).
-000187e0: 2020 2020 2020 2020 656c 7365 3a0a 2020          else:.  
-000187f0: 2020 2020 2020 2020 2020 7365 6c66 2e6d            self.m
-00018800: 6178 5f76 616c 203d 206e 702e 6d61 7828  ax_val = np.max(
-00018810: 6c69 7374 2873 656c 662e 7472 616e 7366  list(self.transf
-00018820: 6f72 6d65 722e 7661 6c75 6573 2829 2929  ormer.values()))
-00018830: 0a20 2020 2020 2020 2023 2323 2054 6f20  .        ### To 
-00018840: 6861 6e64 6c65 2063 6174 6567 6f72 7920  handle category 
-00018850: 6474 7970 6520 796f 7520 6d75 7374 2064  dtype you must d
-00018860: 6f20 7468 6520 6e65 7874 2073 7465 7020  o the next step 
-00018870: 2323 2323 230a 2020 2020 2020 2020 2323  #####.        ##
-00018880: 2323 2044 6f20 6e6f 7420 6368 616e 6765  ## Do not change
-00018890: 2074 6869 7320 7369 6e63 6520 4920 6861   this since I ha
-000188a0: 7665 2074 6573 7465 6420 6974 2061 6e64  ve tested it and
-000188b0: 2069 7420 776f 726b 732e 0a20 2020 2020   it works..     
-000188c0: 2020 2074 6573 746b 203d 2074 6573 7478     testk = testx
-000188d0: 2e6d 6170 2873 656c 662e 7472 616e 7366  .map(self.transf
-000188e0: 6f72 6d65 7229 200a 2020 2020 2020 2020  ormer) .        
-000188f0: 6966 2074 6573 7478 2e64 7479 7065 206e  if testx.dtype n
-00018900: 6f74 2069 6e20 5b6e 702e 696e 7431 362c  ot in [np.int16,
-00018910: 206e 702e 696e 7433 322c 206e 702e 696e   np.int32, np.in
-00018920: 7436 342c 2066 6c6f 6174 2c20 626f 6f6c  t64, float, bool
-00018930: 2c20 6f62 6a65 6374 5d3a 0a20 2020 2020  , object]:.     
-00018940: 2020 2020 2020 2069 6620 7465 7374 782e         if testx.
-00018950: 6973 6e75 6c6c 2829 2e73 756d 2829 2e73  isnull().sum().s
-00018960: 756d 2829 203e 2030 3a0a 2020 2020 2020  um() > 0:.      
-00018970: 2020 2020 2020 2020 2020 6669 6c6c 7661            fillva
-00018980: 6c20 3d20 7365 6c66 2e74 7261 6e73 666f  l = self.transfo
-00018990: 726d 6572 5b6e 702e 6e61 6e5d 0a20 2020  rmer[np.nan].   
-000189a0: 2020 2020 2020 2020 2020 2020 2074 6573               tes
-000189b0: 746b 203d 2074 6573 7478 2e63 6174 2e61  tk = testx.cat.a
-000189c0: 6464 5f63 6174 6567 6f72 6965 7328 5b66  dd_categories([f
-000189d0: 696c 6c76 616c 5d29 0a20 2020 2020 2020  illval]).       
-000189e0: 2020 2020 2020 2020 2074 6573 746b 203d           testk =
-000189f0: 2074 6573 746b 2e66 696c 6c6e 6128 6669   testk.fillna(fi
-00018a00: 6c6c 7661 6c29 0a20 2020 2020 2020 2020  llval).         
-00018a10: 2020 2020 2020 2074 6573 746b 203d 2074         testk = t
-00018a20: 6573 7478 2e6d 6170 2873 656c 662e 7472  estx.map(self.tr
-00018a30: 616e 7366 6f72 6d65 7229 2e76 616c 7565  ansformer).value
-00018a40: 732e 6173 7479 7065 2869 6e74 290a 2020  s.astype(int).  
-00018a50: 2020 2020 2020 2020 2020 2020 2020 7265                re
-00018a60: 7475 726e 2074 6573 746b 0a20 2020 2020  turn testk.     
-00018a70: 2020 2020 2020 2065 6c73 653a 0a20 2020         else:.   
-00018a80: 2020 2020 2020 2020 2020 2020 2074 6573               tes
-00018a90: 746b 203d 2074 6573 7478 2e6d 6170 2873  tk = testx.map(s
-00018aa0: 656c 662e 7472 616e 7366 6f72 6d65 7229  elf.transformer)
-00018ab0: 2e76 616c 7565 732e 6173 7479 7065 2869  .values.astype(i
-00018ac0: 6e74 290a 2020 2020 2020 2020 2020 2020  nt).            
-00018ad0: 2020 2020 7265 7475 726e 2074 6573 746b      return testk
-00018ae0: 0a20 2020 2020 2020 2065 6c73 653a 0a20  .        else:. 
-00018af0: 2020 2020 2020 2020 2020 206f 7574 7320             outs 
-00018b00: 3d20 7465 7374 782e 6d61 7028 7365 6c66  = testx.map(self
-00018b10: 2e74 7261 6e73 666f 726d 6572 292e 7661  .transformer).va
-00018b20: 6c75 6573 2e61 7374 7970 6528 696e 7429  lues.astype(int)
-00018b30: 0a20 2020 2020 2020 2020 2020 2072 6574  .            ret
-00018b40: 7572 6e20 6f75 7473 0a0a 2020 2020 6465  urn outs..    de
-00018b50: 6620 696e 7665 7273 655f 7472 616e 7366  f inverse_transf
-00018b60: 6f72 6d28 7365 6c66 2c20 7465 7374 782c  orm(self, testx,
-00018b70: 2079 3d4e 6f6e 6529 3a0a 2020 2020 2020   y=None):.      
-00018b80: 2020 2323 2320 6e6f 7720 636f 6e76 6572    ### now conver
-00018b90: 7420 7468 6520 696e 7075 7420 746f 2074  t the input to t
-00018ba0: 7261 6e73 666f 726d 6572 2064 6963 7469  ransformer dicti
-00018bb0: 6f6e 6172 7920 7661 6c75 6573 0a20 2020  onary values.   
-00018bc0: 2020 2020 2069 6620 6973 696e 7374 616e       if isinstan
-00018bd0: 6365 2874 6573 7478 2c20 7064 2e53 6572  ce(testx, pd.Ser
-00018be0: 6965 7329 3a0a 2020 2020 2020 2020 2020  ies):.          
-00018bf0: 2020 6f75 7473 203d 2074 6573 7478 2e6d    outs = testx.m
-00018c00: 6170 2873 656c 662e 696e 7665 7273 655f  ap(self.inverse_
-00018c10: 7472 616e 7366 6f72 6d65 7229 2e76 616c  transformer).val
-00018c20: 7565 730a 2020 2020 2020 2020 656c 6966  ues.        elif
-00018c30: 2069 7369 6e73 7461 6e63 6528 7465 7374   isinstance(test
-00018c40: 782c 206e 702e 6e64 6172 7261 7929 3a0a  x, np.ndarray):.
-00018c50: 2020 2020 2020 2020 2020 2020 6f75 7473              outs
-00018c60: 203d 2070 642e 5365 7269 6573 2874 6573   = pd.Series(tes
-00018c70: 7478 292e 6d61 7028 7365 6c66 2e69 6e76  tx).map(self.inv
-00018c80: 6572 7365 5f74 7261 6e73 666f 726d 6572  erse_transformer
-00018c90: 292e 7661 6c75 6573 0a20 2020 2020 2020  ).values.       
-00018ca0: 2065 6c73 653a 0a20 2020 2020 2020 2020   else:.         
-00018cb0: 2020 206f 7574 7320 3d20 7465 7374 785b     outs = testx[
-00018cc0: 3a5d 0a20 2020 2020 2020 2072 6574 7572  :].        retur
-00018cd0: 6e20 6f75 7473 0a23 2323 2323 2323 2323  n outs.#########
-00018ce0: 2323 2323 2323 2323 2323 2323 2323 2323  ################
-00018cf0: 2323 2323 2323 2323 2323 2323 2323 2323  ################
-00018d00: 2323 2323 2323 2323 2323 2323 2323 2323  ################
-00018d10: 2323 2323 2323 2323 2323 2323 2323 2323  ################
-00018d20: 2323 2323 2323 2323 0a63 6c61 7373 204d  ########.class M
-00018d30: 795f 4c61 6265 6c45 6e63 6f64 6572 5f50  y_LabelEncoder_P
-00018d40: 6970 6528 4261 7365 4573 7469 6d61 746f  ipe(BaseEstimato
-00018d50: 722c 2054 7261 6e73 666f 726d 6572 4d69  r, TransformerMi
-00018d60: 7869 6e29 3a0a 2020 2020 2222 220a 2020  xin):.    """.  
-00018d70: 2020 2323 2323 2323 2323 2323 2323 2323    ##############
-00018d80: 2323 2323 2323 2323 2323 2323 2323 2323  ################
-00018d90: 2323 2323 2323 2323 2323 2323 2323 2323  ################
-00018da0: 2323 2323 2323 2323 2323 2323 2323 2323  ################
-00018db0: 2323 2323 2323 2323 2323 2323 2323 2323  ################
-00018dc0: 2323 2323 2323 2323 2323 2323 2323 2323  ################
-00018dd0: 2323 0a20 2020 2023 2323 2323 2320 2054  ##.    ######  T
-00018de0: 6865 204d 795f 4c61 6265 6c45 6e63 6f64  he My_LabelEncod
-00018df0: 6572 5f50 6970 6520 636c 6173 7320 776f  er_Pipe class wo
-00018e00: 726b 7320 6a75 7374 206c 696b 6520 736b  rks just like sk
-00018e10: 6c65 6172 6e27 7320 4c61 6265 6c20 456e  learn's Label En
-00018e20: 636f 6465 7220 6275 7420 6265 7474 6572  coder but better
-00018e30: 2120 2323 2323 230a 2020 2020 2323 2323  ! #####.    ####
-00018e40: 2320 2049 7420 6c61 6265 6c20 656e 636f  #  It label enco
-00018e50: 6465 7320 616e 7920 6361 7420 7661 7220  des any cat var 
-00018e60: 696e 2079 6f75 7220 6461 7461 7365 742e  in your dataset.
-00018e70: 2042 7574 2069 7420 6361 6e20 616c 736f   But it can also
-00018e80: 2062 6520 7573 6564 2069 6e20 5069 7065   be used in Pipe
-00018e90: 6c69 6e65 7321 2023 2323 2323 0a20 2020  lines! #####.   
-00018ea0: 2023 2320 2054 6865 2062 6561 7574 7920   ##  The beauty 
-00018eb0: 6f66 2074 6869 7320 6675 6e63 7469 6f6e  of this function
-00018ec0: 2069 7320 7468 6174 2069 7420 7461 6b65   is that it take
-00018ed0: 7320 6361 7265 206f 6620 4e61 4e27 7320  s care of NaN's 
-00018ee0: 616e 6420 756e 6b6e 6f77 6e20 2866 7574  and unknown (fut
-00018ef0: 7572 6529 2076 616c 7565 732e 2323 2323  ure) values.####
-00018f00: 230a 2020 2020 2323 2323 2320 2053 696e  #.    #####  Sin
-00018f10: 6365 2069 7420 7072 6f64 7563 6573 2061  ce it produces a
-00018f20: 6e20 756e 7573 6564 2073 6563 6f6e 6420  n unused second 
-00018f30: 636f 6c75 6d6e 2069 7420 6361 6e20 6265  column it can be
-00018f40: 2075 7365 6420 696e 2073 6b6c 6561 726e   used in sklearn
-00018f50: 2773 2050 6970 656c 696e 6573 2e20 2020  's Pipelines.   
-00018f60: 2023 2323 2323 0a20 2020 2023 2323 2323   #####.    #####
-00018f70: 2020 4275 7420 666f 7220 7468 6174 2079    But for that y
-00018f80: 6f75 206e 6565 6420 746f 2061 6464 2061  ou need to add a
-00018f90: 2064 726f 705f 7365 636f 6e64 5f63 6f6c   drop_second_col
-00018fa0: 2829 2066 756e 6374 696f 6e20 746f 2074  () function to t
-00018fb0: 6869 7320 4d79 5f4c 6162 656c 456e 636f  his My_LabelEnco
-00018fc0: 6465 725f 5069 7065 2023 2320 0a20 2020  der_Pipe ## .   
-00018fd0: 2023 2323 2323 2020 616e 6420 7468 656e   #####  and then
-00018fe0: 2066 6565 6420 7468 6520 7768 6f6c 6520   feed the whole 
-00018ff0: 7069 7065 6c69 6e65 2074 6f20 6120 436f  pipeline to a Co
-00019000: 6c75 6d6e 5f54 7261 6e73 666f 726d 6572  lumn_Transformer
-00019010: 2066 756e 6374 696f 6e2e 2049 7420 6973   function. It is
-00019020: 2076 6572 7920 6561 7379 2e20 2323 2323   very easy. ####
-00019030: 230a 2020 2020 2323 2323 2323 2323 2323  #.    ##########
-00019040: 2323 2323 2323 2323 2323 2320 5468 6973  ########### This
-00019050: 2069 7320 7468 6520 4245 5354 2077 6f72   is the BEST wor
-00019060: 6b69 6e67 2076 6572 7369 6f6e 202d 2064  king version - d
-00019070: 6f6e 2774 206d 6573 7320 7769 7468 2069  on't mess with i
-00019080: 7421 2120 2323 2323 2323 2323 2323 2323  t!! ############
-00019090: 2323 2323 2323 0a20 2020 2023 2323 2323  ######.    #####
-000190a0: 2323 2323 2323 2323 2323 2323 2323 2323  ################
-000190b0: 2323 2323 2323 2323 2323 2323 2323 2323  ################
-000190c0: 2323 2323 2323 2323 2323 2323 2323 2323  ################
-000190d0: 2323 2323 2323 2323 2323 2323 2323 2323  ################
-000190e0: 2323 2323 2323 2323 2323 2323 2323 2323  ################
-000190f0: 2323 2323 2323 2323 2323 230a 2020 2020  ###########.    
-00019100: 5573 6167 6520 696e 2070 6970 656c 696e  Usage in pipelin
-00019110: 6573 3a0a 2020 2020 2020 2020 2020 6c65  es:.          le
-00019120: 203d 204d 795f 4c61 6265 6c45 6e63 6f64   = My_LabelEncod
-00019130: 6572 5f50 6970 6528 290a 2020 2020 2020  er_Pipe().      
-00019140: 2020 2020 6c65 2e66 6974 5f74 7261 6e73      le.fit_trans
-00019150: 666f 726d 2874 7261 696e 5b63 6f6c 756d  form(train[colum
-00019160: 6e5d 2920 2323 2074 6869 7320 7769 6c6c  n]) ## this will
-00019170: 2067 6976 6520 796f 7520 7477 6f20 636f   give you two co
-00019180: 6c75 6d6e 7320 2d20 6265 7761 7265 210a  lumns - beware!.
-00019190: 2020 2020 2020 2020 2020 6c65 2e74 7261            le.tra
-000191a0: 6e73 666f 726d 2874 6573 745b 636f 6c75  nsform(test[colu
-000191b0: 6d6e 5d29 2023 2323 2074 6869 7320 7769  mn]) ### this wi
-000191c0: 6c6c 2067 6976 6520 796f 7520 7477 6f20  ll give you two 
-000191d0: 636f 6c75 6d6e 7320 2d20 6265 7761 7265  columns - beware
-000191e0: 210a 2020 2020 2020 2020 2020 2020 2020  !.              
-000191f0: 0a20 2020 2055 7361 6765 2069 6e20 436f  .    Usage in Co
-00019200: 6c75 6d6e 2054 7261 6e73 666f 726d 6572  lumn Transformer
-00019210: 733a 0a20 2020 2020 2020 2064 6566 2064  s:.        def d
-00019220: 726f 705f 7365 636f 6e64 5f63 6f6c 2858  rop_second_col(X
-00019230: 7429 3a0a 2020 2020 2020 2020 2323 2320  t):.        ### 
-00019240: 5468 6973 2064 656c 6574 6573 2074 6865  This deletes the
-00019250: 2032 6e64 2063 6f6c 756d 6e2e 2048 656e   2nd column. Hen
-00019260: 6365 2063 6f6c 206e 756d 6265 723d 3120  ce col number=1 
-00019270: 616e 6420 6178 6973 3d31 2023 2323 0a20  and axis=1 ###. 
-00019280: 2020 2020 2020 2072 6574 7572 6e20 6e70         return np
-00019290: 2e64 656c 6574 6528 5874 2c20 312c 2031  .delete(Xt, 1, 1
-000192a0: 290a 2020 2020 2020 2020 0a20 2020 2020  ).        .     
-000192b0: 2020 2064 726f 705f 7365 636f 6e64 5f63     drop_second_c
-000192c0: 6f6c 5f66 756e 6320 3d20 4675 6e63 7469  ol_func = Functi
-000192d0: 6f6e 5472 616e 7366 6f72 6d65 7228 6472  onTransformer(dr
-000192e0: 6f70 5f73 6563 6f6e 645f 636f 6c29 0a20  op_second_col). 
-000192f0: 2020 2020 2020 200a 2020 2020 2020 2020         .        
-00019300: 6c65 5f6f 6e65 203d 206d 616b 655f 7069  le_one = make_pi
-00019310: 7065 6c69 6e65 286c 652c 2064 726f 705f  peline(le, drop_
-00019320: 7365 636f 6e64 5f63 6f6c 5f66 756e 6329  second_col_func)
-00019330: 0a20 2020 200a 2020 2020 2020 2020 6374  .    .        ct
-00019340: 203d 206d 616b 655f 636f 6c75 6d6e 5f74   = make_column_t
-00019350: 7261 6e73 666f 726d 6572 280a 2020 2020  ransformer(.    
-00019360: 2020 2020 2020 2020 286c 655f 6f6e 652c          (le_one,
-00019370: 2063 6174 7661 7273 5b30 5d29 2c0a 2020   catvars[0]),.  
-00019380: 2020 2020 2020 2020 2020 286c 655f 6f6e            (le_on
-00019390: 652c 2063 6174 7661 7273 5b31 5d29 2c0a  e, catvars[1]),.
-000193a0: 2020 2020 2020 2020 2020 2020 2869 6d70              (imp
-000193b0: 2c20 6e75 6d76 6172 7329 2c0a 2020 2020  , numvars),.    
-000193c0: 2020 2020 2020 2020 7265 6d61 696e 6465          remainde
-000193d0: 723d 7265 6d61 696e 6465 7229 2020 2020  r=remainder)    
-000193e0: 0a0a 2020 2020 2222 220a 2020 2020 6465  ..    """.    de
-000193f0: 6620 5f5f 696e 6974 5f5f 2873 656c 6629  f __init__(self)
-00019400: 3a0a 2020 2020 2020 2020 7365 6c66 2e74  :.        self.t
-00019410: 7261 6e73 666f 726d 6572 203d 2064 6566  ransformer = def
-00019420: 6175 6c74 6469 6374 2873 7472 290a 2020  aultdict(str).  
-00019430: 2020 2020 2020 7365 6c66 2e69 6e76 6572        self.inver
-00019440: 7365 5f74 7261 6e73 666f 726d 6572 203d  se_transformer =
-00019450: 2064 6566 6175 6c74 6469 6374 2873 7472   defaultdict(str
-00019460: 290a 2020 2020 2020 2020 7365 6c66 2e6d  ).        self.m
-00019470: 6178 5f76 616c 203d 2030 0a20 2020 2020  ax_val = 0.     
-00019480: 2020 200a 2020 2020 6465 6620 6669 7428     .    def fit(
-00019490: 7365 6c66 2c74 6573 7478 2c20 793d 4e6f  self,testx, y=No
-000194a0: 6e65 293a 0a20 2020 2020 2020 2023 2323  ne):.        ###
-000194b0: 2044 6f20 6e6f 7420 6368 616e 6765 2074   Do not change t
-000194c0: 6869 7320 7369 6e63 6520 5261 7265 2063  his since Rare c
-000194d0: 6c61 7373 2063 6f6d 6269 6e65 7220 7265  lass combiner re
-000194e0: 7175 6972 6573 2074 6869 7320 7465 7374  quires this test
-000194f0: 2023 230a 2020 2020 2020 2020 6966 2069   ##.        if i
-00019500: 7369 6e73 7461 6e63 6528 7465 7374 782c  sinstance(testx,
-00019510: 2074 7570 6c65 293a 0a20 2020 2020 2020   tuple):.       
-00019520: 2020 2020 2079 203d 2074 6573 7478 5b31       y = testx[1
-00019530: 5d0a 2020 2020 2020 2020 2020 2020 7465  ].            te
-00019540: 7374 7820 3d20 7465 7374 785b 305d 0a20  stx = testx[0]. 
-00019550: 2020 2020 2020 2069 6620 6973 696e 7374         if isinst
-00019560: 616e 6365 2874 6573 7478 2c20 7064 2e53  ance(testx, pd.S
-00019570: 6572 6965 7329 3a0a 2020 2020 2020 2020  eries):.        
-00019580: 2020 2020 7061 7373 0a20 2020 2020 2020      pass.       
-00019590: 2065 6c69 6620 6973 696e 7374 616e 6365   elif isinstance
-000195a0: 2874 6573 7478 2c20 6e70 2e6e 6461 7272  (testx, np.ndarr
-000195b0: 6179 293a 0a20 2020 2020 2020 2020 2020  ay):.           
-000195c0: 2074 6573 7478 203d 2070 642e 5365 7269   testx = pd.Seri
-000195d0: 6573 2874 6573 7478 290a 2020 2020 2020  es(testx).      
-000195e0: 2020 656c 7365 3a0a 2020 2020 2020 2020    else:.        
-000195f0: 2020 2020 2323 2323 2054 6865 7265 2069      #### There i
-00019600: 7320 6e6f 2077 6179 2074 6f20 7472 616e  s no way to tran
-00019610: 7366 6f72 6d20 6461 7461 6672 616d 6573  sform dataframes
-00019620: 2073 696e 6365 2079 6f75 2077 696c 6c20   since you will 
-00019630: 6765 7420 6120 6e65 7374 6564 2072 656e  get a nested ren
-00019640: 616d 6572 2065 7272 6f72 2069 6620 796f  amer error if yo
-00019650: 7520 7472 7920 2323 230a 2020 2020 2020  u try ###.      
-00019660: 2020 2020 2020 2323 2320 4275 7420 6966        ### But if
-00019670: 2069 7420 6973 2061 206f 6e65 2d64 696d   it is a one-dim
-00019680: 656e 7369 6f6e 616c 2064 6174 6166 7261  ensional datafra
-00019690: 6d65 2c20 636f 6e76 6572 7420 6974 2069  me, convert it i
-000196a0: 6e74 6f20 6120 5365 7269 6573 0a20 2020  nto a Series.   
-000196b0: 2020 2020 2020 2020 2069 6620 7465 7374           if test
-000196c0: 782e 7368 6170 655b 315d 203d 3d20 313a  x.shape[1] == 1:
-000196d0: 0a20 2020 2020 2020 2020 2020 2020 2020  .               
-000196e0: 2074 6573 7478 203d 2070 642e 5365 7269   testx = pd.Seri
-000196f0: 6573 2874 6573 7478 2e76 616c 7565 732e  es(testx.values.
-00019700: 7261 7665 6c28 292c 6e61 6d65 3d74 6573  ravel(),name=tes
-00019710: 7478 2e63 6f6c 756d 6e73 5b30 5d29 0a20  tx.columns[0]). 
-00019720: 2020 2020 2020 2020 2020 2065 6c73 653a             else:
-00019730: 0a20 2020 2020 2020 2020 2020 2020 2020  .               
-00019740: 2023 2323 2320 5369 6e63 6520 6974 2069   #### Since it i
-00019750: 7320 6d75 6c74 692d 6469 6d65 6e73 696f  s multi-dimensio
-00019760: 6e61 6c2c 2053 6f20 696e 2074 6869 7320  nal, So in this 
-00019770: 6361 7365 2c20 6a75 7374 2072 6574 7572  case, just retur
-00019780: 6e20 7468 6520 6461 7461 2061 7320 6973  n the data as is
-00019790: 0a20 2020 2020 2020 2020 2020 2020 2020  .               
-000197a0: 2072 6574 7572 6e20 7365 6c66 0a20 2020   return self.   
-000197b0: 2020 2020 2069 6e73 203d 206e 702e 756e       ins = np.un
-000197c0: 6971 7565 2874 6573 7478 2e66 6163 746f  ique(testx.facto
-000197d0: 7269 7a65 2829 5b31 5d29 2e74 6f6c 6973  rize()[1]).tolis
-000197e0: 7428 290a 2020 2020 2020 2020 6f75 7473  t().        outs
-000197f0: 203d 206e 702e 756e 6971 7565 2874 6573   = np.unique(tes
-00019800: 7478 2e66 6163 746f 7269 7a65 2829 5b30  tx.factorize()[0
-00019810: 5d29 2e74 6f6c 6973 7428 290a 2020 2020  ]).tolist().    
-00019820: 2020 2020 2369 6e73 203d 2074 6573 7478      #ins = testx
-00019830: 2e76 616c 7565 5f63 6f75 6e74 7328 6472  .value_counts(dr
-00019840: 6f70 6e61 3d46 616c 7365 292e 696e 6465  opna=False).inde
-00019850: 7820 2020 2020 2020 200a 2020 2020 2020  x        .      
-00019860: 2020 6966 202d 3120 696e 206f 7574 733a    if -1 in outs:
-00019870: 0a20 2020 2020 2020 2023 2020 2069 7420  .        #   it 
-00019880: 616c 7265 6164 7920 6861 7320 6e61 6e20  already has nan 
-00019890: 6966 202d 3120 6973 2069 6e20 6f75 7473  if -1 is in outs
-000198a0: 2e20 4e6f 206e 6565 6420 746f 2061 6464  . No need to add
-000198b0: 2069 742e 0a20 2020 2020 2020 2020 2020   it..           
-000198c0: 2069 6620 6e6f 7420 6e70 2e6e 616e 2069   if not np.nan i
-000198d0: 6e20 696e 733a 0a20 2020 2020 2020 2020  n ins:.         
-000198e0: 2020 2020 2020 2069 6e73 2e69 6e73 6572         ins.inser
-000198f0: 7428 302c 6e70 2e6e 616e 290a 2020 2020  t(0,np.nan).    
-00019900: 2020 2020 7365 6c66 2e74 7261 6e73 666f      self.transfo
-00019910: 726d 6572 203d 2064 6963 7428 7a69 7028  rmer = dict(zip(
-00019920: 696e 732c 6f75 7473 2929 0a20 2020 2020  ins,outs)).     
-00019930: 2020 2073 656c 662e 696e 7665 7273 655f     self.inverse_
-00019940: 7472 616e 7366 6f72 6d65 7220 3d20 6469  transformer = di
-00019950: 6374 287a 6970 286f 7574 732c 696e 7329  ct(zip(outs,ins)
-00019960: 290a 2020 2020 2020 2020 7265 7475 726e  ).        return
-00019970: 2073 656c 660a 0a20 2020 2064 6566 2074   self..    def t
-00019980: 7261 6e73 666f 726d 2873 656c 662c 2074  ransform(self, t
-00019990: 6573 7478 2c20 793d 4e6f 6e65 293a 0a20  estx, y=None):. 
-000199a0: 2020 2020 2020 2023 2323 2044 6f20 6e6f         ### Do no
-000199b0: 7420 6368 616e 6765 2074 6869 7320 7369  t change this si
-000199c0: 6e63 6520 5261 7265 2063 6c61 7373 2063  nce Rare class c
-000199d0: 6f6d 6269 6e65 7220 7265 7175 6972 6573  ombiner requires
-000199e0: 2074 6869 7320 7465 7374 2023 230a 2020   this test ##.  
-000199f0: 2020 2020 2020 6966 2069 7369 6e73 7461        if isinsta
-00019a00: 6e63 6528 7465 7374 782c 2074 7570 6c65  nce(testx, tuple
-00019a10: 293a 0a20 2020 2020 2020 2020 2020 2079  ):.            y
-00019a20: 203d 2074 6573 7478 5b31 5d0a 2020 2020   = testx[1].    
-00019a30: 2020 2020 2020 2020 7465 7374 7820 3d20          testx = 
-00019a40: 7465 7374 785b 305d 0a20 2020 2020 2020  testx[0].       
-00019a50: 2023 2320 7465 7374 7820 6d75 7374 2073   ## testx must s
-00019a60: 7469 6c6c 2062 6520 6120 7064 2e53 6572  till be a pd.Ser
-00019a70: 6965 7320 666f 7220 7468 6973 2065 6e63  ies for this enc
-00019a80: 6f64 6572 2074 6f20 776f 726b 210a 2020  oder to work!.  
-00019a90: 2020 2020 2020 6966 2069 7369 6e73 7461        if isinsta
-00019aa0: 6e63 6528 7465 7374 782c 2070 642e 5365  nce(testx, pd.Se
-00019ab0: 7269 6573 293a 0a20 2020 2020 2020 2020  ries):.         
-00019ac0: 2020 2070 6173 730a 2020 2020 2020 2020     pass.        
-00019ad0: 656c 6966 2069 7369 6e73 7461 6e63 6528  elif isinstance(
-00019ae0: 7465 7374 782c 206e 702e 6e64 6172 7261  testx, np.ndarra
-00019af0: 7929 3a0a 2020 2020 2020 2020 2020 2020  y):.            
-00019b00: 7465 7374 7820 3d20 7064 2e53 6572 6965  testx = pd.Serie
-00019b10: 7328 7465 7374 7829 0a20 2020 2020 2020  s(testx).       
-00019b20: 2065 6c73 653a 0a20 2020 2020 2020 2020   else:.         
-00019b30: 2020 2023 2323 2320 5468 6572 6520 6973     #### There is
-00019b40: 206e 6f20 7761 7920 746f 2074 7261 6e73   no way to trans
-00019b50: 666f 726d 2064 6174 6166 7261 6d65 7320  form dataframes 
-00019b60: 7369 6e63 6520 796f 7520 7769 6c6c 2067  since you will g
-00019b70: 6574 2061 206e 6573 7465 6420 7265 6e61  et a nested rena
-00019b80: 6d65 7220 6572 726f 7220 6966 2079 6f75  mer error if you
-00019b90: 2074 7279 2023 2323 0a20 2020 2020 2020   try ###.       
-00019ba0: 2020 2020 2023 2323 2042 7574 2069 6620       ### But if 
-00019bb0: 6974 2069 7320 6120 6f6e 652d 6469 6d65  it is a one-dime
-00019bc0: 6e73 696f 6e61 6c20 6461 7461 6672 616d  nsional datafram
-00019bd0: 652c 2063 6f6e 7665 7274 2069 7420 696e  e, convert it in
-00019be0: 746f 2061 2053 6572 6965 730a 2020 2020  to a Series.    
-00019bf0: 2020 2020 2020 2020 2323 2323 2044 6f20          #### Do 
-00019c00: 6e6f 7420 6368 616e 6765 2074 6869 7320  not change this 
-00019c10: 7369 6e63 6520 4920 6861 7665 2074 6573  since I have tes
-00019c20: 7465 6420 6974 2061 6e64 2069 7420 776f  ted it and it wo
-00019c30: 726b 732e 0a20 2020 2020 2020 2020 2020  rks..           
-00019c40: 2069 6620 7465 7374 782e 7368 6170 655b   if testx.shape[
-00019c50: 315d 203d 3d20 313a 0a20 2020 2020 2020  1] == 1:.       
-00019c60: 2020 2020 2020 2020 2074 6573 7478 203d           testx =
-00019c70: 2070 642e 5365 7269 6573 2874 6573 7478   pd.Series(testx
-00019c80: 2e76 616c 7565 732e 7261 7665 6c28 292c  .values.ravel(),
-00019c90: 6e61 6d65 3d74 6573 7478 2e63 6f6c 756d  name=testx.colum
-00019ca0: 6e73 5b30 5d29 0a20 2020 2020 2020 2020  ns[0]).         
-00019cb0: 2020 2065 6c73 653a 0a20 2020 2020 2020     else:.       
-00019cc0: 2020 2020 2020 2020 2023 2323 2320 5369           #### Si
-00019cd0: 6e63 6520 6974 2069 7320 6d75 6c74 692d  nce it is multi-
-00019ce0: 6469 6d65 6e73 696f 6e61 6c2c 2053 6f20  dimensional, So 
-00019cf0: 696e 2074 6869 7320 6361 7365 2c20 6a75  in this case, ju
-00019d00: 7374 2072 6574 7572 6e20 7468 6520 6461  st return the da
-00019d10: 7461 2061 7320 6973 0a20 2020 2020 2020  ta as is.       
-00019d20: 2020 2020 2020 2020 2023 2323 2320 446f           #### Do
-00019d30: 206e 6f74 2063 6861 6e67 6520 7468 6973   not change this
-00019d40: 2073 696e 6365 2049 2068 6176 6520 7465   since I have te
-00019d50: 7374 6564 2069 7420 616e 6420 6974 2077  sted it and it w
-00019d60: 6f72 6b73 2e0a 2020 2020 2020 2020 2020  orks..          
-00019d70: 2020 2020 2020 7265 7475 726e 2074 6573        return tes
-00019d80: 7478 0a0a 2020 2020 2020 2020 2323 2320  tx..        ### 
-00019d90: 6e6f 7720 636f 6e76 6572 7420 7468 6520  now convert the 
-00019da0: 696e 7075 7420 746f 2074 7261 6e73 666f  input to transfo
-00019db0: 726d 6572 2064 6963 7469 6f6e 6172 7920  rmer dictionary 
-00019dc0: 7661 6c75 6573 0a20 2020 2020 2020 206e  values.        n
-00019dd0: 6577 5f69 6e73 203d 206e 702e 756e 6971  ew_ins = np.uniq
-00019de0: 7565 2874 6573 7478 2e66 6163 746f 7269  ue(testx.factori
-00019df0: 7a65 2829 5b31 5d29 2e74 6f6c 6973 7428  ze()[1]).tolist(
-00019e00: 290a 2020 2020 2020 2020 6d69 7373 696e  ).        missin
-00019e10: 6720 3d20 5b78 2066 6f72 2078 2069 6e20  g = [x for x in 
-00019e20: 6e65 775f 696e 7320 6966 2078 206e 6f74  new_ins if x not
-00019e30: 2069 6e20 7365 6c66 2e74 7261 6e73 666f   in self.transfo
-00019e40: 726d 6572 2e6b 6579 7328 295d 0a20 2020  rmer.keys()].   
-00019e50: 2020 2020 2069 6620 6c65 6e28 6d69 7373       if len(miss
-00019e60: 696e 6729 203e 2030 3a0a 2020 2020 2020  ing) > 0:.      
-00019e70: 2020 2020 2020 666f 7220 6561 6368 5f6d        for each_m
-00019e80: 6973 7369 6e67 2069 6e20 6d69 7373 696e  issing in missin
-00019e90: 673a 0a20 2020 2020 2020 2020 2020 2020  g:.             
-00019ea0: 2020 2073 656c 662e 7472 616e 7366 6f72     self.transfor
-00019eb0: 6d65 725b 6561 6368 5f6d 6973 7369 6e67  mer[each_missing
-00019ec0: 5d20 3d20 696e 7428 7365 6c66 2e6d 6178  ] = int(self.max
-00019ed0: 5f76 616c 202b 2031 290a 2020 2020 2020  _val + 1).      
-00019ee0: 2020 2020 2020 2020 2020 7365 6c66 2e69            self.i
-00019ef0: 6e76 6572 7365 5f74 7261 6e73 666f 726d  nverse_transform
-00019f00: 6572 5b69 6e74 2873 656c 662e 6d61 785f  er[int(self.max_
-00019f10: 7661 6c2b 3129 5d20 3d20 6561 6368 5f6d  val+1)] = each_m
-00019f20: 6973 7369 6e67 0a20 2020 2020 2020 2020  issing.         
-00019f30: 2020 2020 2020 2073 656c 662e 6d61 785f         self.max_
-00019f40: 7661 6c20 3d20 696e 7428 7365 6c66 2e6d  val = int(self.m
-00019f50: 6178 5f76 616c 2b31 290a 2020 2020 2020  ax_val+1).      
-00019f60: 2020 656c 7365 3a0a 2020 2020 2020 2020    else:.        
-00019f70: 2020 2020 7365 6c66 2e6d 6178 5f76 616c      self.max_val
-00019f80: 203d 206e 702e 6d61 7828 6c69 7374 2873   = np.max(list(s
-00019f90: 656c 662e 7472 616e 7366 6f72 6d65 722e  elf.transformer.
-00019fa0: 7661 6c75 6573 2829 2929 0a20 2020 2020  values())).     
-00019fb0: 2020 2023 2323 2054 6f20 6861 6e64 6c65     ### To handle
-00019fc0: 2063 6174 6567 6f72 7920 6474 7970 6520   category dtype 
-00019fd0: 796f 7520 6d75 7374 2064 6f20 7468 6520  you must do the 
-00019fe0: 6e65 7874 2073 7465 7020 2323 2323 230a  next step #####.
-00019ff0: 2020 2020 2020 2020 2323 2323 2044 6f20          #### Do 
-0001a000: 6e6f 7420 6368 616e 6765 2074 6869 7320  not change this 
-0001a010: 7369 6e63 6520 4920 6861 7665 2074 6573  since I have tes
-0001a020: 7465 6420 6974 2061 6e64 2069 7420 776f  ted it and it wo
-0001a030: 726b 732e 0a20 2020 2020 2020 2074 6573  rks..        tes
-0001a040: 746b 203d 2074 6573 7478 2e6d 6170 2873  tk = testx.map(s
-0001a050: 656c 662e 7472 616e 7366 6f72 6d65 7229  elf.transformer)
-0001a060: 200a 2020 2020 2020 2020 0a20 2020 2020   .        .     
-0001a070: 2020 2069 6620 7465 7374 782e 6973 6e75     if testx.isnu
-0001a080: 6c6c 2829 2e73 756d 2829 2e73 756d 2829  ll().sum().sum()
-0001a090: 203e 2030 3a0a 2020 2020 2020 2020 2020   > 0:.          
-0001a0a0: 2020 7472 793a 0a20 2020 2020 2020 2020    try:.         
-0001a0b0: 2020 2020 2020 2066 696c 6c76 616c 203d         fillval =
-0001a0c0: 2073 656c 662e 7472 616e 7366 6f72 6d65   self.transforme
-0001a0d0: 725b 6e70 2e6e 616e 5d0a 2020 2020 2020  r[np.nan].      
-0001a0e0: 2020 2020 2020 6578 6365 7074 3a0a 2020        except:.  
-0001a0f0: 2020 2020 2020 2020 2020 2020 2020 6669                fi
-0001a100: 6c6c 7661 6c20 3d20 2d31 0a20 2020 2020  llval = -1.     
-0001a110: 2020 2020 2020 2069 6620 7465 7374 782e         if testx.
-0001a120: 6474 7970 6520 6e6f 7420 696e 205b 6e70  dtype not in [np
-0001a130: 2e69 6e74 3136 2c20 6e70 2e69 6e74 3332  .int16, np.int32
-0001a140: 2c20 6e70 2e69 6e74 3634 2c20 666c 6f61  , np.int64, floa
-0001a150: 742c 2062 6f6f 6c2c 206f 626a 6563 745d  t, bool, object]
-0001a160: 3a0a 2020 2020 2020 2020 2020 2020 2020  :.              
-0001a170: 2020 7465 7374 6b20 3d20 7465 7374 6b2e    testk = testk.
-0001a180: 6d61 7028 7365 6c66 2e74 7261 6e73 666f  map(self.transfo
-0001a190: 726d 6572 292e 6669 6c6c 6e61 2866 696c  rmer).fillna(fil
-0001a1a0: 6c76 616c 292e 7661 6c75 6573 2e61 7374  lval).values.ast
-0001a1b0: 7970 6528 696e 7429 0a20 2020 2020 2020  ype(int).       
-0001a1c0: 2020 2020 2065 6c73 653a 0a20 2020 2020       else:.     
-0001a1d0: 2020 2020 2020 2020 2020 2074 6573 746b             testk
-0001a1e0: 203d 2074 6573 746b 2e66 696c 6c6e 6128   = testk.fillna(
-0001a1f0: 6669 6c6c 7661 6c29 0a20 2020 2020 2020  fillval).       
-0001a200: 2020 2020 2020 2020 2074 6573 746b 203d           testk =
-0001a210: 2074 6573 7478 2e6d 6170 2873 656c 662e   testx.map(self.
-0001a220: 7472 616e 7366 6f72 6d65 7229 2e76 616c  transformer).val
-0001a230: 7565 732e 6173 7479 7065 2869 6e74 290a  ues.astype(int).
-0001a240: 2020 2020 2020 2020 2020 2020 7265 7475              retu
-0001a250: 726e 206e 702e 635f 5b74 6573 746b 2c6e  rn np.c_[testk,n
-0001a260: 702e 7a65 726f 7328 7368 6170 653d 7465  p.zeros(shape=te
-0001a270: 7374 6b2e 7368 6170 6529 5d2e 6173 7479  stk.shape)].asty
-0001a280: 7065 2869 6e74 290a 2020 2020 2020 2020  pe(int).        
-0001a290: 656c 7365 3a0a 2020 2020 2020 2020 2020  else:.          
-0001a2a0: 2020 7465 7374 6b20 3d20 7465 7374 782e    testk = testx.
-0001a2b0: 6d61 7028 7365 6c66 2e74 7261 6e73 666f  map(self.transfo
-0001a2c0: 726d 6572 292e 7661 6c75 6573 2e61 7374  rmer).values.ast
-0001a2d0: 7970 6528 696e 7429 0a20 2020 2020 2020  ype(int).       
-0001a2e0: 2020 2020 2072 6574 7572 6e20 6e70 2e63       return np.c
-0001a2f0: 5f5b 7465 7374 6b2c 6e70 2e7a 6572 6f73  _[testk,np.zeros
-0001a300: 2873 6861 7065 3d74 6573 746b 2e73 6861  (shape=testk.sha
-0001a310: 7065 295d 2e61 7374 7970 6528 696e 7429  pe)].astype(int)
-0001a320: 0a0a 2020 2020 6465 6620 696e 7665 7273  ..    def invers
-0001a330: 655f 7472 616e 7366 6f72 6d28 7365 6c66  e_transform(self
-0001a340: 2c20 7465 7374 782c 2079 3d4e 6f6e 6529  , testx, y=None)
-0001a350: 3a0a 2020 2020 2020 2020 2323 2320 6e6f  :.        ### no
-0001a360: 7720 636f 6e76 6572 7420 7468 6520 696e  w convert the in
-0001a370: 7075 7420 746f 2074 7261 6e73 666f 726d  put to transform
-0001a380: 6572 2064 6963 7469 6f6e 6172 7920 7661  er dictionary va
-0001a390: 6c75 6573 0a20 2020 2020 2020 2069 6620  lues.        if 
-0001a3a0: 6973 696e 7374 616e 6365 2874 6573 7478  isinstance(testx
-0001a3b0: 2c20 7064 2e53 6572 6965 7329 3a0a 2020  , pd.Series):.  
-0001a3c0: 2020 2020 2020 2020 2020 6f75 7473 203d            outs =
-0001a3d0: 2074 6573 7478 2e6d 6170 2873 656c 662e   testx.map(self.
-0001a3e0: 696e 7665 7273 655f 7472 616e 7366 6f72  inverse_transfor
-0001a3f0: 6d65 7229 2e76 616c 7565 730a 2020 2020  mer).values.    
-0001a400: 2020 2020 656c 6966 2069 7369 6e73 7461      elif isinsta
-0001a410: 6e63 6528 7465 7374 782c 206e 702e 6e64  nce(testx, np.nd
-0001a420: 6172 7261 7929 3a0a 2020 2020 2020 2020  array):.        
-0001a430: 2020 2020 6f75 7473 203d 2070 642e 5365      outs = pd.Se
-0001a440: 7269 6573 2874 6573 7478 292e 6d61 7028  ries(testx).map(
-0001a450: 7365 6c66 2e69 6e76 6572 7365 5f74 7261  self.inverse_tra
-0001a460: 6e73 666f 726d 6572 292e 7661 6c75 6573  nsformer).values
-0001a470: 0a20 2020 2020 2020 2065 6c73 653a 0a20  .        else:. 
-0001a480: 2020 2020 2020 2020 2020 206f 7574 7320             outs 
-0001a490: 3d20 7465 7374 785b 3a5d 0a20 2020 2020  = testx[:].     
-0001a4a0: 2020 2072 6574 7572 6e20 6f75 7473 0a23     return outs.#
-0001a4b0: 2323 2323 2323 2323 2323 2323 2323 2323  ################
-0001a4c0: 2323 2323 2323 2323 2323 2323 2323 2323  ################
-0001a4d0: 2323 2323 2323 2323 2323 2323 2323 2323  ################
-0001a4e0: 2323 2323 2323 2323 2323 2323 2323 2323  ################
-0001a4f0: 2323 2323 2323 2323 2323 2323 2323 2323  ################
-0001a500: 0a23 2023 2320 4669 7273 7420 796f 7520  .# ## First you 
-0001a510: 6e65 6564 2074 6f20 636c 6173 7369 6679  need to classify
-0001a520: 2076 6172 6961 626c 6573 2069 6e74 6f20   variables into 
-0001a530: 6469 6666 6572 656e 7420 7479 7065 732e  different types.
-0001a540: 204f 6e6c 7920 7468 656e 2063 616e 2079   Only then can y
-0001a550: 6f75 2064 6f20 7468 6520 636f 7272 6563  ou do the correc
-0001a560: 7420 7472 616e 7366 6f72 6d61 7469 6f6e  t transformation
-0001a570: 732e 0a64 6566 2063 6c61 7373 6966 795f  s..def classify_
-0001a580: 7661 7273 5f70 616e 6461 7328 6466 2c20  vars_pandas(df, 
-0001a590: 7665 7262 6f73 653d 3029 3a0a 2020 2020  verbose=0):.    
-0001a5a0: 2222 220a 2020 2020 2323 2323 2323 2323  """.    ########
-0001a5b0: 2323 2323 2323 2323 2323 2323 2323 2323  ################
-0001a5c0: 2323 2323 2323 2323 2323 2323 2323 2323  ################
-0001a5d0: 2323 2323 2323 2323 2323 2323 2323 2323  ################
-0001a5e0: 2323 2323 2323 2323 2323 2323 2323 2323  ################
-0001a5f0: 2323 2323 2323 2323 2323 2323 2323 2323  ################
-0001a600: 2323 2323 2323 2323 0a20 2020 2050 616e  ########.    Pan
-0001a610: 6461 7320 7365 6c65 6374 5f64 7479 7065  das select_dtype
-0001a620: 7320 6d61 6b65 7320 636c 6173 7369 6679  s makes classify
-0001a630: 696e 6720 7661 7269 6162 6c65 7320 6120  ing variables a 
-0001a640: 6272 6565 7a65 2e20 596f 7520 7368 6f75  breeze. You shou
-0001a650: 6c64 2063 6865 636b 206f 7574 2074 6865  ld check out the
-0001a660: 206c 696e 6b73 2068 6572 653a 0a20 2020   links here:.   
-0001a670: 2068 7474 7073 3a2f 2f70 616e 6461 732e   https://pandas.
-0001a680: 7079 6461 7461 2e6f 7267 2f64 6f63 732f  pydata.org/docs/
-0001a690: 7265 6665 7265 6e63 652f 6170 692f 7061  reference/api/pa
-0001a6a0: 6e64 6173 2e44 6174 6146 7261 6d65 2e73  ndas.DataFrame.s
-0001a6b0: 656c 6563 745f 6474 7970 6573 2e68 746d  elect_dtypes.htm
-0001a6c0: 6c0a 2020 2020 2323 2323 2323 2323 2323  l.    ##########
-0001a6d0: 2323 2323 2323 2323 2323 2323 2323 2323  ################
-0001a6e0: 2323 2323 2323 2323 2323 2323 2323 2323  ################
-0001a6f0: 2323 2323 2323 2323 2323 2323 2323 2323  ################
-0001a700: 2323 2323 2323 2323 2323 2323 2323 2323  ################
-0001a710: 2323 2323 2323 2323 2323 2323 2323 2323  ################
-0001a720: 2323 2323 2323 0a20 2020 2022 2222 0a20  ######.    """. 
-0001a730: 2020 2023 2323 206e 756d 6265 7220 6f66     ### number of
-0001a740: 2063 6174 6567 6f72 6965 7320 696e 2061   categories in a
-0001a750: 2063 6f6c 756d 6e20 6265 6c6f 7720 7768   column below wh
-0001a760: 6963 6820 6974 2069 7320 636f 6e73 6964  ich it is consid
-0001a770: 6572 6564 2061 2063 6174 6567 6f72 6961  ered a categoria
-0001a780: 6c20 7661 7220 2323 0a20 2020 2063 6174  l var ##.    cat
-0001a790: 6567 6f72 795f 6c69 6d69 7420 3d20 3330  egory_limit = 30
-0001a7a0: 200a 2020 2020 6e6c 705f 7468 7265 7368   .    nlp_thresh
-0001a7b0: 6f6c 6420 3d20 3530 0a20 2020 2076 6172  old = 50.    var
-0001a7c0: 5f64 6963 7420 3d20 6465 6661 756c 7464  _dict = defaultd
-0001a7d0: 6963 7428 6c69 7374 290a 2020 2020 2323  ict(list).    ##
-0001a7e0: 2323 2054 6f20 7365 6c65 6374 2061 6c6c  ## To select all
-0001a7f0: 206e 756d 6572 6963 2074 7970 6573 2c20   numeric types, 
-0001a800: 7573 6520 6e70 2e6e 756d 6265 7220 6f72  use np.number or
-0001a810: 2027 6e75 6d62 6572 270a 2020 2020 696e   'number'.    in
-0001a820: 7476 6172 7320 3d20 6466 2e73 656c 6563  tvars = df.selec
-0001a830: 745f 6474 7970 6573 2869 6e63 6c75 6465  t_dtypes(include
-0001a840: 3d27 696e 7465 6765 7227 292e 636f 6c75  ='integer').colu
-0001a850: 6d6e 732e 746f 6c69 7374 2829 0a20 2020  mns.tolist().   
-0001a860: 2023 2323 2042 6563 6175 7365 206f 6620   ### Because of 
-0001a870: 6469 6666 6572 656e 6365 7320 696e 2070  differences in p
-0001a880: 616e 6461 7320 7665 7273 696f 6e73 2c20  andas versions, 
-0001a890: 666c 6f61 7473 2064 6f6e 2774 2067 6574  floats don't get
-0001a8a0: 2064 6574 6563 7465 6420 6561 7369 6c79   detected easily
-0001a8b0: 0a20 2020 2023 2323 2020 4865 6e63 6520  .    ###  Hence 
-0001a8c0: 4920 616d 2066 6f72 6365 6420 746f 2077  I am forced to w
-0001a8d0: 7269 7465 2063 6c75 6d73 696c 7920 6c69  rite clumsily li
-0001a8e0: 6b65 2074 6869 732e 2044 6f6e 2774 2063  ke this. Don't c
-0001a8f0: 6861 6e67 6520 7468 6520 6e65 7874 206c  hange the next l
-0001a900: 696e 6521 210a 2020 2020 666c 6f61 7476  ine!!.    floatv
-0001a910: 6172 7320 3d20 6466 2e73 656c 6563 745f  ars = df.select_
-0001a920: 6474 7970 6573 2869 6e63 6c75 6465 3d27  dtypes(include='
-0001a930: 666c 6f61 7431 3627 292e 636f 6c75 6d6e  float16').column
-0001a940: 732e 746f 6c69 7374 2829 202b 2064 662e  s.tolist() + df.
-0001a950: 7365 6c65 6374 5f64 7479 7065 7328 0a20  select_dtypes(. 
-0001a960: 2020 2020 2020 2020 2020 2020 2020 2069                 i
-0001a970: 6e63 6c75 6465 3d27 666c 6f61 7433 3227  nclude='float32'
-0001a980: 292e 636f 6c75 6d6e 732e 746f 6c69 7374  ).columns.tolist
-0001a990: 2829 202b 2064 662e 7365 6c65 6374 5f64  () + df.select_d
-0001a9a0: 7479 7065 7328 696e 636c 7564 653d 2766  types(include='f
-0001a9b0: 6c6f 6174 3634 2729 2e63 6f6c 756d 6e73  loat64').columns
-0001a9c0: 2e74 6f6c 6973 7428 290a 2020 2020 696e  .tolist().    in
-0001a9d0: 665f 636f 6c73 203d 2045 4441 5f66 696e  f_cols = EDA_fin
-0001a9e0: 645f 7265 6d6f 7665 5f63 6f6c 756d 6e73  d_remove_columns
-0001a9f0: 5f77 6974 685f 696e 6669 6e69 7479 2864  _with_infinity(d
-0001aa00: 6629 0a20 2020 206e 756d 7661 7273 203d  f).    numvars =
-0001aa10: 206c 6566 745f 7375 6274 7261 6374 2866   left_subtract(f
-0001aa20: 6c6f 6174 7661 7273 2c20 696e 665f 636f  loatvars, inf_co
-0001aa30: 6c73 290a 2020 2020 7661 725f 6469 6374  ls).    var_dict
-0001aa40: 5b27 636f 6e74 696e 756f 7573 5f76 6172  ['continuous_var
-0001aa50: 7327 5d20 3d20 666c 6f61 7476 6172 730a  s'] = floatvars.
-0001aa60: 2020 2020 7661 725f 6469 6374 5b27 696e      var_dict['in
-0001aa70: 745f 7661 7273 275d 203d 2069 6e74 7661  t_vars'] = intva
-0001aa80: 7273 0a20 2020 2023 2323 2320 546f 2073  rs.    #### To s
-0001aa90: 656c 6563 7420 7374 7269 6e67 7320 796f  elect strings yo
-0001aaa0: 7520 6d75 7374 2075 7365 2074 6865 206f  u must use the o
-0001aab0: 626a 6563 7420 6474 7970 652c 2062 7574  bject dtype, but
-0001aac0: 206e 6f74 6520 7468 6174 2074 6869 7320   note that this 
-0001aad0: 7769 6c6c 2072 6574 7572 6e20 616c 6c20  will return all 
-0001aae0: 6f62 6a65 6374 2064 7479 7065 2063 6f6c  object dtype col
-0001aaf0: 756d 6e73 0a20 2020 2073 7472 696e 6776  umns.    stringv
-0001ab00: 6172 7320 3d20 6466 2e73 656c 6563 745f  ars = df.select_
-0001ab10: 6474 7970 6573 2869 6e63 6c75 6465 3d27  dtypes(include='
-0001ab20: 6f62 6a65 6374 2729 2e63 6f6c 756d 6e73  object').columns
-0001ab30: 2e74 6f6c 6973 7428 290a 2020 2020 6469  .tolist().    di
-0001ab40: 7363 7265 7465 5f76 6172 7320 3d20 5b5d  screte_vars = []
-0001ab50: 0a20 2020 2069 6620 6c65 6e28 7374 7269  .    if len(stri
-0001ab60: 6e67 7661 7273 2920 3e20 303a 0a20 2020  ngvars) > 0:.   
-0001ab70: 2020 2020 2063 6f70 795f 7374 7269 6e67       copy_string
-0001ab80: 5f76 6172 7320 3d20 636f 7079 2e64 6565  _vars = copy.dee
-0001ab90: 7063 6f70 7928 7374 7269 6e67 7661 7273  pcopy(stringvars
-0001aba0: 290a 2020 2020 2020 2020 666f 7220 6561  ).        for ea
-0001abb0: 6368 5f73 7472 696e 6720 696e 2063 6f70  ch_string in cop
-0001abc0: 795f 7374 7269 6e67 5f76 6172 733a 0a20  y_string_vars:. 
-0001abd0: 2020 2020 2020 2020 2020 2069 6620 6c65             if le
-0001abe0: 6e28 6466 5b65 6163 685f 7374 7269 6e67  n(df[each_string
-0001abf0: 5d2e 756e 6971 7565 2829 2920 3e20 6361  ].unique()) > ca
-0001ac00: 7465 676f 7279 5f6c 696d 6974 3a0a 2020  tegory_limit:.  
-0001ac10: 2020 2020 2020 2020 2020 2020 2020 6469                di
-0001ac20: 7363 7265 7465 5f76 6172 732e 6170 7065  screte_vars.appe
-0001ac30: 6e64 2865 6163 685f 7374 7269 6e67 290a  nd(each_string).
-0001ac40: 2020 2020 2020 2020 2020 2020 2020 2020                  
-0001ac50: 7374 7269 6e67 7661 7273 2e72 656d 6f76  stringvars.remov
-0001ac60: 6528 6561 6368 5f73 7472 696e 6729 0a20  e(each_string). 
-0001ac70: 2020 2076 6172 5f64 6963 745b 2764 6973     var_dict['dis
-0001ac80: 6372 6574 655f 7374 7269 6e67 5f76 6172  crete_string_var
-0001ac90: 7327 5d20 3d20 6469 7363 7265 7465 5f76  s'] = discrete_v
-0001aca0: 6172 730a 2020 2020 2323 2323 2054 6f20  ars.    #### To 
-0001acb0: 7365 6c65 6374 2064 6174 6574 696d 6573  select datetimes
-0001acc0: 2c20 7573 6520 6e70 2e64 6174 6574 696d  , use np.datetim
-0001acd0: 6536 342c 2027 6461 7465 7469 6d65 2720  e64, 'datetime' 
-0001ace0: 6f72 2027 6461 7465 7469 6d65 3634 270a  or 'datetime64'.
-0001acf0: 2020 2020 6461 7465 7661 7273 203d 2064      datevars = d
-0001ad00: 662e 7365 6c65 6374 5f64 7479 7065 7328  f.select_dtypes(
-0001ad10: 696e 636c 7564 653d 2764 6174 6574 696d  include='datetim
-0001ad20: 6527 292e 636f 6c75 6d6e 732e 746f 6c69  e').columns.toli
-0001ad30: 7374 2829 0a20 2020 2076 6172 5f64 6963  st().    var_dic
-0001ad40: 745b 2764 6174 655f 7661 7273 275d 203d  t['date_vars'] =
-0001ad50: 2064 6174 6576 6172 730a 2020 2020 2323   datevars.    ##
-0001ad60: 2323 2054 6f20 7365 6c65 6374 2074 696d  ## To select tim
-0001ad70: 6564 656c 7461 732c 2075 7365 206e 702e  edeltas, use np.
-0001ad80: 7469 6d65 6465 6c74 6136 342c 2027 7469  timedelta64, 'ti
-0001ad90: 6d65 6465 6c74 6127 206f 7220 2774 696d  medelta' or 'tim
-0001ada0: 6564 656c 7461 3634 270a 2020 2020 6465  edelta64'.    de
-0001adb0: 6c74 6176 6172 7320 3d20 6466 2e73 656c  ltavars = df.sel
-0001adc0: 6563 745f 6474 7970 6573 2869 6e63 6c75  ect_dtypes(inclu
-0001add0: 6465 3d27 7469 6d65 6465 6c74 6127 292e  de='timedelta').
-0001ade0: 636f 6c75 6d6e 732e 746f 6c69 7374 2829  columns.tolist()
-0001adf0: 0a20 2020 2076 6172 5f64 6963 745b 2774  .    var_dict['t
-0001ae00: 696d 655f 6465 6c74 6173 275d 203d 2064  ime_deltas'] = d
-0001ae10: 656c 7461 7661 7273 0a20 2020 2023 2323  eltavars.    ###
-0001ae20: 2320 546f 2073 656c 6563 7420 5061 6e64  # To select Pand
-0001ae30: 6173 2063 6174 6567 6f72 6963 616c 2064  as categorical d
-0001ae40: 7479 7065 732c 2075 7365 2027 6361 7465  types, use 'cate
-0001ae50: 676f 7279 270a 2020 2020 6361 7476 6172  gory'.    catvar
-0001ae60: 7320 3d20 6466 2e73 656c 6563 745f 6474  s = df.select_dt
-0001ae70: 7970 6573 2869 6e63 6c75 6465 3d27 6361  ypes(include='ca
-0001ae80: 7465 676f 7279 2729 2e63 6f6c 756d 6e73  tegory').columns
-0001ae90: 2e74 6f6c 6973 7428 290a 2020 2020 6966  .tolist().    if
-0001aea0: 206c 656e 2863 6174 7661 7273 2920 3e20   len(catvars) > 
-0001aeb0: 303a 0a20 2020 2020 2020 2063 6f70 795f  0:.        copy_
-0001aec0: 6361 7476 6172 7320 3d20 636f 7079 2e64  catvars = copy.d
-0001aed0: 6565 7063 6f70 7928 6361 7476 6172 7329  eepcopy(catvars)
-0001aee0: 0a20 2020 2020 2020 2066 6f72 2065 6163  .        for eac
-0001aef0: 685f 6361 7420 696e 2063 6f70 795f 6361  h_cat in copy_ca
-0001af00: 7476 6172 733a 0a20 2020 2020 2020 2020  tvars:.         
-0001af10: 2020 2069 6620 6c65 6e28 6466 5b65 6163     if len(df[eac
-0001af20: 685f 6361 745d 2e75 6e69 7175 6528 2929  h_cat].unique())
-0001af30: 203e 2063 6174 6567 6f72 795f 6c69 6d69   > category_limi
-0001af40: 743a 0a20 2020 2020 2020 2020 2020 2020  t:.             
-0001af50: 2020 2064 6973 6372 6574 655f 7661 7273     discrete_vars
-0001af60: 2e61 7070 656e 6428 6561 6368 5f63 6174  .append(each_cat
-0001af70: 290a 2020 2020 2020 2020 2020 2020 2020  ).              
-0001af80: 2020 6361 7476 6172 732e 7265 6d6f 7665    catvars.remove
-0001af90: 2865 6163 685f 6361 7429 2020 2020 0a20  (each_cat)    . 
-0001afa0: 2020 2076 6172 5f64 6963 745b 2763 6174     var_dict['cat
-0001afb0: 6567 6f72 6963 616c 5f76 6172 7327 5d20  egorical_vars'] 
-0001afc0: 3d20 6361 7476 6172 7320 2b20 7374 7269  = catvars + stri
-0001afd0: 6e67 7661 7273 0a20 2020 2076 6172 5f64  ngvars.    var_d
-0001afe0: 6963 745b 2764 6973 6372 6574 655f 7374  ict['discrete_st
-0001aff0: 7269 6e67 5f76 6172 7327 5d20 3d20 6469  ring_vars'] = di
-0001b000: 7363 7265 7465 5f76 6172 730a 2020 2020  screte_vars.    
-0001b010: 2323 2323 2054 6f20 7365 6c65 6374 2050  #### To select P
-0001b020: 616e 6461 7320 6461 7465 7469 6d65 747a  andas datetimetz
-0001b030: 2064 7479 7065 732c 2075 7365 2027 6461   dtypes, use 'da
-0001b040: 7465 7469 6d65 747a 2720 286e 6577 2069  tetimetz' (new i
-0001b050: 6e20 302e 3230 2e30 2920 6f72 2027 6461  n 0.20.0) or 'da
-0001b060: 7465 7469 6d65 3634 5b6e 732c 2074 7a5d  tetime64[ns, tz]
-0001b070: 270a 2020 2020 6461 7465 7a76 6172 7320  '.    datezvars 
-0001b080: 3d20 6466 2e73 656c 6563 745f 6474 7970  = df.select_dtyp
-0001b090: 6573 2869 6e63 6c75 6465 3d27 6461 7465  es(include='date
-0001b0a0: 7469 6d65 747a 2729 2e63 6f6c 756d 6e73  timetz').columns
-0001b0b0: 2e74 6f6c 6973 7428 290a 2020 2020 7661  .tolist().    va
-0001b0c0: 725f 6469 6374 5b27 6461 7465 5f7a 6f6e  r_dict['date_zon
-0001b0d0: 6573 275d 203d 2064 6174 657a 7661 7273  es'] = datezvars
-0001b0e0: 0a20 2020 2023 2323 2320 6368 6563 6b20  .    #### check 
-0001b0f0: 666f 7220 6e6c 7020 7661 7269 6162 6c65  for nlp variable
-0001b100: 7320 6865 7265 2023 2323 230a 2020 2020  s here ####.    
-0001b110: 7374 725f 7661 7273 203d 2076 6172 5f64  str_vars = var_d
-0001b120: 6963 745b 2764 6973 6372 6574 655f 7374  ict['discrete_st
-0001b130: 7269 6e67 5f76 6172 7327 5d0a 2020 2020  ring_vars'].    
-0001b140: 636f 7079 5f76 6172 7320 3d20 636f 7079  copy_vars = copy
-0001b150: 2e64 6565 7063 6f70 7928 7374 725f 7661  .deepcopy(str_va
-0001b160: 7273 290a 2020 2020 6e6c 705f 7661 7273  rs).    nlp_vars
-0001b170: 203d 205b 5d0a 2020 2020 666f 7220 6561   = [].    for ea
-0001b180: 6368 5f73 7472 5f76 6172 2069 6e20 636f  ch_str_var in co
-0001b190: 7079 5f76 6172 733a 0a20 2020 2020 2020  py_vars:.       
-0001b1a0: 2074 7279 3a0a 2020 2020 2020 2020 2020   try:.          
-0001b1b0: 2020 6d65 616e 5f73 7472 5f73 697a 6520    mean_str_size 
-0001b1c0: 3d20 6466 5b65 6163 685f 7374 725f 7661  = df[each_str_va
-0001b1d0: 725d 2e66 696c 6c6e 6128 276d 6973 7369  r].fillna('missi
-0001b1e0: 6e67 2729 2e6d 6170 286c 656e 292e 6d61  ng').map(len).ma
-0001b1f0: 7828 290a 2020 2020 2020 2020 6578 6365  x().        exce
-0001b200: 7074 3a0a 2020 2020 2020 2020 2020 2020  pt:.            
-0001b210: 7072 696e 7428 2752 656d 6f76 696e 6720  print('Removing 
-0001b220: 636f 6c75 6d6e 2025 7320 7369 6e63 6520  column %s since 
-0001b230: 6974 2069 7320 6572 726f 7269 6e67 2070  it is erroring p
-0001b240: 726f 6261 626c 7920 6475 6520 746f 206d  robably due to m
-0001b250: 6978 6564 2064 6174 6120 7479 7065 732e  ixed data types.
-0001b260: 2720 2565 6163 685f 7374 725f 7661 7229  ' %each_str_var)
-0001b270: 0a20 2020 2020 2020 2020 2020 2073 7472  .            str
-0001b280: 5f76 6172 732e 7265 6d6f 7665 2865 6163  _vars.remove(eac
-0001b290: 685f 7374 725f 7661 7229 0a20 2020 2020  h_str_var).     
-0001b2a0: 2020 2020 2020 2063 6f6e 7469 6e75 650a         continue.
-0001b2b0: 2020 2020 2020 2020 6966 2020 6d65 616e          if  mean
-0001b2c0: 5f73 7472 5f73 697a 6520 3e3d 206e 6c70  _str_size >= nlp
-0001b2d0: 5f74 6872 6573 686f 6c64 3a0a 2020 2020  _threshold:.    
-0001b2e0: 2020 2020 2020 2020 7072 696e 7428 6622          print(f"
-0001b2f0: 2020 2020 7369 6e63 6520 7b65 6163 685f      since {each_
-0001b300: 7374 725f 7661 727d 2773 206d 6178 2073  str_var}'s max s
-0001b310: 7472 696e 6720 7369 7a65 207b 6d65 616e  tring size {mean
-0001b320: 5f73 7472 5f73 697a 653a 2e30 667d 203e  _str_size:.0f} >
-0001b330: 3d20 7b6e 6c70 5f74 6872 6573 686f 6c64  = {nlp_threshold
-0001b340: 7d2c 2072 652d 636c 6173 7369 6679 696e  }, re-classifyin
-0001b350: 6720 6974 2061 7320 4e4c 5020 7661 7269  g it as NLP vari
-0001b360: 6162 6c65 2229 0a20 2020 2020 2020 2020  able").         
-0001b370: 2020 206e 6c70 5f76 6172 732e 6170 7065     nlp_vars.appe
-0001b380: 6e64 2865 6163 685f 7374 725f 7661 7229  nd(each_str_var)
-0001b390: 0a20 2020 2020 2020 2020 2020 2073 7472  .            str
-0001b3a0: 5f76 6172 732e 7265 6d6f 7665 2865 6163  _vars.remove(eac
-0001b3b0: 685f 7374 725f 7661 7229 0a20 2020 2076  h_str_var).    v
-0001b3c0: 6172 5f64 6963 745b 276e 6c70 5f76 6172  ar_dict['nlp_var
-0001b3d0: 7327 5d20 3d20 6e6c 705f 7661 7273 2023  s'] = nlp_vars #
-0001b3e0: 2323 2074 6865 7365 2061 7265 204e 4c50  ## these are NLP
-0001b3f0: 2074 6578 7420 7661 7269 6162 6c65 7320   text variables 
-0001b400: 2323 2323 2323 2323 2323 0a20 2020 2076  ##########.    v
-0001b410: 6172 5f64 6963 745b 2764 6973 6372 6574  ar_dict['discret
-0001b420: 655f 7374 7269 6e67 5f76 6172 7327 5d20  e_string_vars'] 
-0001b430: 3d20 7374 725f 7661 7273 2023 2323 2074  = str_vars ### t
-0001b440: 6865 7365 2061 7265 2068 6967 6820 6361  hese are high ca
-0001b450: 7264 696e 616c 6974 7920 7374 7269 6e67  rdinality string
-0001b460: 2076 6172 6961 626c 6573 2023 230a 0a20   variables ##.. 
-0001b470: 2020 2069 6620 7665 7262 6f73 653a 0a20     if verbose:. 
-0001b480: 2020 2020 2020 2070 7269 6e74 2866 2222         print(f""
-0001b490: 2220 2020 2052 6574 7572 6e69 6e67 2064  "    Returning d
-0001b4a0: 6963 7469 6f6e 6172 7920 666f 7220 7661  ictionary for va
-0001b4b0: 7269 6162 6c65 2074 7970 6573 2077 6974  riable types wit
-0001b4c0: 6820 666f 6c6c 6f77 696e 6720 6b65 7973  h following keys
-0001b4d0: 3a0a 2020 2020 2020 2020 2020 2020 2020  :.              
-0001b4e0: 2020 2020 2020 2020 2020 636f 6e74 696e            contin
-0001b4f0: 756f 7573 5f76 6172 7320 3d20 7b6c 656e  uous_vars = {len
-0001b500: 2866 6c6f 6174 7661 7273 297d 2c20 696e  (floatvars)}, in
-0001b510: 745f 7661 7273 203d 207b 6c65 6e28 696e  t_vars = {len(in
-0001b520: 7476 6172 7329 7d2c 200a 2020 2020 2020  tvars)}, .      
-0001b530: 2020 2020 2020 2020 2020 2020 2020 2020                  
-0001b540: 2020 6469 7363 7265 7465 5f73 7472 696e    discrete_strin
-0001b550: 675f 7661 7273 203d 207b 6c65 6e28 7374  g_vars = {len(st
-0001b560: 725f 7661 7273 297d 2c20 6e6c 705f 7661  r_vars)}, nlp_va
-0001b570: 7273 203d 207b 6c65 6e28 6e6c 705f 7661  rs = {len(nlp_va
-0001b580: 7273 297d 2c0a 2020 2020 2020 2020 2020  rs)},.          
-0001b590: 2020 2020 2020 2020 2020 2020 2020 6461                da
-0001b5a0: 7465 5f76 6172 7320 3d20 7b6c 656e 2864  te_vars = {len(d
-0001b5b0: 6174 6576 6172 7329 7d2c 2074 696d 655f  atevars)}, time_
-0001b5c0: 6465 6c74 6173 203d 207b 6c65 6e28 6465  deltas = {len(de
-0001b5d0: 6c74 6176 6172 7329 7d2c 0a20 2020 2020  ltavars)},.     
-0001b5e0: 2020 2020 2020 2020 2020 2020 2020 2020                  
-0001b5f0: 2020 2063 6174 6567 6f72 6963 616c 5f76     categorical_v
-0001b600: 6172 7320 3d20 7b6c 656e 2863 6174 7661  ars = {len(catva
-0001b610: 7273 292b 6c65 6e28 7374 7269 6e67 7661  rs)+len(stringva
-0001b620: 7273 297d 2c20 6461 7465 5f7a 6f6e 6573  rs)}, date_zones
-0001b630: 203d 207b 6c65 6e28 6461 7465 7a76 6172   = {len(datezvar
-0001b640: 7329 7d22 2222 290a 2020 2020 0a20 2020  s)}""").    .   
-0001b650: 2072 6574 7572 6e20 7661 725f 6469 6374   return var_dict
-0001b660: 0a23 2323 2323 2323 2323 2323 2323 2323  .###############
-0001b670: 2323 2323 2323 2323 2323 2323 2323 2323  ################
-0001b680: 2323 2323 2323 2323 2323 2323 2323 2323  ################
-0001b690: 2323 2323 2323 2323 2323 2323 2323 2323  ################
-0001b6a0: 2323 2323 2323 2323 2323 2323 2323 2323  ################
-0001b6b0: 2323 2323 2323 2323 2323 2323 2323 2323  ################
-0001b6c0: 2323 230a 6465 6620 6c65 6674 5f73 7562  ###.def left_sub
-0001b6d0: 7472 6163 7428 6c31 2c6c 3229 3a0a 2020  tract(l1,l2):.  
-0001b6e0: 2020 2222 2254 6869 7320 6861 6e64 7920    """This handy 
-0001b6f0: 6675 6e63 7469 6f6e 2073 7562 7472 6163  function subtrac
-0001b700: 7473 206f 6e65 206c 6973 7420 6672 6f6d  ts one list from
-0001b710: 2061 6e6f 7468 6572 2e20 5072 6f62 6162   another. Probab
-0001b720: 6c79 206d 7920 6d6f 7374 2070 6f70 756c  ly my most popul
-0001b730: 6172 2066 756e 6374 696f 6e2e 2222 220a  ar function.""".
-0001b740: 2020 2020 6c73 7420 3d20 5b5d 0a20 2020      lst = [].   
-0001b750: 2066 6f72 2069 2069 6e20 6c31 3a0a 2020   for i in l1:.  
-0001b760: 2020 2020 2020 6966 2069 206e 6f74 2069        if i not i
-0001b770: 6e20 6c32 3a0a 2020 2020 2020 2020 2020  n l2:.          
-0001b780: 2020 6c73 742e 6170 7065 6e64 2869 290a    lst.append(i).
-0001b790: 2020 2020 7265 7475 726e 206c 7374 0a23      return lst.#
-0001b7a0: 2323 2323 2323 2323 2323 2323 2323 2323  ################
-0001b7b0: 2323 2323 2323 2323 2323 2323 2323 2323  ################
-0001b7c0: 2323 2323 2323 2323 2323 2323 2323 2323  ################
-0001b7d0: 2323 2323 2323 2323 2323 2323 2323 2323  ################
-0001b7e0: 2323 2323 2323 2323 2323 2323 2323 2323  ################
-0001b7f0: 2323 2323 2323 2323 2323 230a 696d 706f  ###########.impo
-0001b800: 7274 2063 6f70 790a 6465 6620 636f 6e76  rt copy.def conv
-0001b810: 6572 745f 6d69 7865 645f 6461 7461 7479  ert_mixed_dataty
-0001b820: 7065 735f 746f 5f73 7472 696e 6728 6466  pes_to_string(df
-0001b830: 293a 0a20 2020 2022 2222 0a20 2020 2023  ):.    """.    #
-0001b840: 2323 2323 2323 2323 2323 2323 2323 2323  ################
-0001b850: 2323 2323 2323 2323 2323 2323 2323 2323  ################
-0001b860: 2323 2323 2323 2323 2323 2323 2323 2323  ################
-0001b870: 2323 2323 2323 2323 2323 2323 2323 2323  ################
-0001b880: 2323 2323 2323 2323 2323 2323 2323 2323  ################
-0001b890: 2323 2323 0a20 2020 2048 616e 6479 2066  ####.    Handy f
-0001b8a0: 756e 6374 696f 6e20 666f 7220 4665 6174  unction for Feat
-0001b8b0: 7572 6520 5472 616e 7366 6f72 6d61 7469  ure Transformati
-0001b8c0: 6f6e 3a20 5468 6174 2773 2077 6879 2069  on: That's why i
-0001b8d0: 7427 7320 696e 636c 7564 6564 2069 6e20  t's included in 
-0001b8e0: 4c61 7a79 5472 616e 7366 6f72 6d0a 2020  LazyTransform.  
-0001b8f0: 2020 2323 2323 2323 2323 2323 2320 4974    ########### It
-0001b900: 2063 6f6e 7665 7274 7320 616c 6c20 6d69   converts all mi
-0001b910: 7865 6420 6461 7461 2074 7970 6520 636f  xed data type co
-0001b920: 6c75 6d6e 7320 696e 746f 206f 626a 6563  lumns into objec
-0001b930: 7420 636f 6c75 6d6e 7320 2323 2323 2323  t columns ######
-0001b940: 2323 2323 2323 0a20 2020 2049 6e70 7574  ######.    Input
-0001b950: 733a 0a20 2020 2064 6620 3a20 7061 6e64  s:.    df : pand
-0001b960: 6173 2064 6174 6166 7261 6d65 0a0a 2020  as dataframe..  
-0001b970: 2020 4f75 7470 7574 733a 0a20 2020 2064    Outputs:.    d
-0001b980: 663a 2074 6869 7320 6973 2074 6865 2074  f: this is the t
-0001b990: 7261 6e73 666f 726d 6564 2044 6174 6146  ransformed DataF
-0001b9a0: 7261 6d65 2077 6974 6820 616c 6c20 6d69  rame with all mi
-0001b9b0: 7865 6420 6461 7461 2074 7970 6573 206e  xed data types n
-0001b9c0: 6f77 2061 7320 6f62 6a65 6374 730a 2020  ow as objects.  
-0001b9d0: 2020 2323 2323 2323 2323 2323 2323 2323    ##############
-0001b9e0: 2323 2323 2323 2323 2323 2323 2323 2323  ################
-0001b9f0: 2323 2323 2323 2323 2323 2323 2323 2323  ################
-0001ba00: 2323 2323 2323 2323 2323 2323 2323 2323  ################
-0001ba10: 2323 2323 2323 2323 2323 2323 2323 2323  ################
-0001ba20: 2323 2323 2323 230a 2020 2020 2222 220a  #######.    """.
-0001ba30: 2020 2020 6466 203d 2063 6f70 792e 6465      df = copy.de
-0001ba40: 6570 636f 7079 2864 6629 0a20 2020 2063  epcopy(df).    c
-0001ba50: 6f6c 7320 3d20 6466 2e63 6f6c 756d 6e73  ols = df.columns
-0001ba60: 2e74 6f6c 6973 7428 290a 2020 2020 636f  .tolist().    co
-0001ba70: 7079 5f63 6f6c 7320 3d20 636f 7079 2e64  py_cols = copy.d
-0001ba80: 6565 7063 6f70 7928 636f 6c73 290a 2020  eepcopy(cols).  
-0001ba90: 2020 666f 7220 636f 6c20 696e 2063 6f70    for col in cop
-0001baa0: 795f 636f 6c73 3a0a 2020 2020 2020 2020  y_cols:.        
-0001bab0: 6966 206c 656e 2864 665b 636f 6c5d 2e61  if len(df[col].a
-0001bac0: 7070 6c79 2874 7970 6529 2e76 616c 7565  pply(type).value
-0001bad0: 5f63 6f75 6e74 7328 2929 203e 2031 3a0a  _counts()) > 1:.
-0001bae0: 2020 2020 2020 2020 2020 2020 7072 696e              prin
-0001baf0: 7428 274d 6978 6564 2064 6174 6120 7479  t('Mixed data ty
-0001bb00: 7065 2064 6574 6563 7465 6420 696e 2025  pe detected in %
-0001bb10: 7320 636f 6c75 6d6e 2e20 436f 6e76 6572  s column. Conver
-0001bb20: 7469 6e67 2069 7420 746f 206f 626a 6563  ting it to objec
-0001bb30: 7420 7479 7065 2e2e 2e27 2025 636f 6c29  t type...' %col)
-0001bb40: 0a20 2020 2020 2020 2020 2020 2074 7279  .            try
-0001bb50: 3a0a 2020 2020 2020 2020 2020 2020 2020  :.              
-0001bb60: 2020 6466 5b63 6f6c 5d20 3d20 6466 5b63    df[col] = df[c
-0001bb70: 6f6c 5d2e 6d61 7028 6c61 6d62 6461 2078  ol].map(lambda x
-0001bb80: 3a20 7820 6966 2069 7369 6e73 7461 6e63  : x if isinstanc
-0001bb90: 6528 782c 2073 7472 2920 656c 7365 2073  e(x, str) else s
-0001bba0: 7472 2878 2929 2e76 616c 7565 730a 2020  tr(x)).values.  
-0001bbb0: 2020 2020 2020 2020 2020 2020 2020 6966                if
-0001bbc0: 206c 656e 2864 665b 636f 6c5d 2e61 7070   len(df[col].app
-0001bbd0: 6c79 2874 7970 6529 2e76 616c 7565 5f63  ly(type).value_c
-0001bbe0: 6f75 6e74 7328 2929 203e 2031 3a0a 2020  ounts()) > 1:.  
-0001bbf0: 2020 2020 2020 2020 2020 2020 2020 2020                  
-0001bc00: 2020 6466 2e64 726f 7028 636f 6c2c 6178    df.drop(col,ax
-0001bc10: 6973 3d31 2c69 6e70 6c61 6365 3d54 7275  is=1,inplace=Tru
-0001bc20: 6529 0a20 2020 2020 2020 2020 2020 2020  e).             
-0001bc30: 2020 2020 2020 2070 7269 6e74 2827 2020         print('  
-0001bc40: 2020 2573 2073 7469 6c6c 2068 6173 206d    %s still has m
-0001bc50: 6978 6564 2064 6174 6120 7479 7065 732e  ixed data types.
-0001bc60: 2044 726f 7070 696e 6720 6974 2e27 2025   Dropping it.' %
-0001bc70: 636f 6c29 0a20 2020 2020 2020 2020 2020  col).           
-0001bc80: 2065 7863 6570 743a 0a20 2020 2020 2020   except:.       
-0001bc90: 2020 2020 2020 2020 2064 662e 6472 6f70           df.drop
-0001bca0: 2863 6f6c 2c61 7869 733d 312c 696e 706c  (col,axis=1,inpl
-0001bcb0: 6163 653d 5472 7565 290a 2020 2020 2020  ace=True).      
-0001bcc0: 2020 2020 2020 2020 2020 7072 696e 7428            print(
-0001bcd0: 2720 2020 2064 726f 7070 696e 6720 2573  '    dropping %s
-0001bce0: 2073 696e 6365 2069 7420 6769 7665 7320   since it gives 
-0001bcf0: 6572 726f 722e 2720 2563 6f6c 290a 2020  error.' %col).  
-0001bd00: 2020 7265 7475 726e 2064 660a 2323 2323    return df.####
-0001bd10: 2323 2323 2323 2323 2323 2323 2323 2323  ################
-0001bd20: 2323 2323 2323 2323 2323 2323 2323 2323  ################
-0001bd30: 2323 2323 2323 2323 2323 2323 2323 2323  ################
-0001bd40: 2323 2323 2323 2323 2323 2323 2323 2323  ################
-0001bd50: 2323 2323 2323 2323 2323 2323 2323 2323  ################
-0001bd60: 2323 2323 2323 2323 0a64 6566 2063 6f6e  ########.def con
-0001bd70: 7665 7274 5f61 6c6c 5f6f 626a 6563 745f  vert_all_object_
-0001bd80: 636f 6c75 6d6e 735f 746f 5f6e 756d 6572  columns_to_numer
-0001bd90: 6963 2874 7261 696e 2c20 7465 7374 3d22  ic(train, test="
-0001bda0: 2229 3a0a 2020 2020 2222 220a 2020 2020  "):.    """.    
-0001bdb0: 5468 6973 2061 2068 616e 6479 2066 756e  This a handy fun
-0001bdc0: 6374 696f 6e20 666f 7220 4665 6174 7572  ction for Featur
-0001bdd0: 6520 456e 6769 6e65 6572 696e 6720 2d20  e Engineering - 
-0001bde0: 5468 6174 2773 2077 6879 2049 2068 6176  That's why I hav
-0001bdf0: 6520 696e 636c 7564 6564 2069 7420 696e  e included it in
-0001be00: 204c 617a 7920 5472 616e 7366 6f72 6d0a   Lazy Transform.
-0001be10: 2020 2020 2323 2323 2323 2323 2323 2323      ############
-0001be20: 2323 2323 2323 2323 2323 2323 2323 2323  ################
-0001be30: 2323 2323 2323 2323 2323 2323 2323 2323  ################
-0001be40: 2323 2323 2323 2323 2323 2323 2323 2323  ################
-0001be50: 2323 2323 2323 2323 2323 2323 2323 2323  ################
-0001be60: 2323 2323 2323 2323 2323 0a20 2020 2054  ##########.    T
-0001be70: 6869 7320 6973 2061 2075 7469 6c69 7479  his is a utility
-0001be80: 2074 6861 7420 636f 6e76 6572 7473 2073   that converts s
-0001be90: 7472 696e 6720 636f 6c75 6d6e 7320 746f  tring columns to
-0001bea0: 206e 756d 6572 6963 2075 7369 6e67 204d   numeric using M
-0001beb0: 595f 4c41 4245 4c20 454e 434f 4445 522e  Y_LABEL ENCODER.
-0001bec0: 0a20 2020 204d 616b 6520 7375 7265 2074  .    Make sure t
-0001bed0: 6573 7420 616e 6420 7472 6169 6e20 6861  est and train ha
-0001bee0: 7665 2074 6865 2073 616d 6520 6e75 6d62  ve the same numb
-0001bef0: 6572 206f 6620 636f 6c75 6d6e 732e 2049  er of columns. I
-0001bf00: 6620 796f 7520 6861 7665 2074 6172 6765  f you have targe
-0001bf10: 7420 696e 2074 7261 696e 2c0a 2020 2020  t in train,.    
-0001bf20: 7265 6d6f 7665 2069 7420 6265 666f 7265  remove it before
-0001bf30: 2073 656e 6469 6e67 2069 7420 7468 726f   sending it thro
-0001bf40: 7567 6820 7468 6973 2075 7469 6c69 7479  ugh this utility
-0001bf50: 2e20 4f74 6865 7277 6973 652c 206d 6967  . Otherwise, mig
-0001bf60: 6874 2062 6c6f 7720 7570 2064 7572 696e  ht blow up durin
-0001bf70: 6720 7465 7374 2074 7261 6e73 666f 726d  g test transform
-0001bf80: 2e0a 2020 2020 5468 6520 6265 6175 7479  ..    The beauty
-0001bf90: 206f 6620 4d79 5f4c 6162 656c 456e 636f   of My_LabelEnco
-0001bfa0: 6465 7220 6973 2069 7420 6861 6e64 6c65  der is it handle
-0001bfb0: 7320 4e41 2773 2061 6e64 2066 7574 7572  s NA's and futur
-0001bfc0: 6520 7661 6c75 6573 2069 6e20 7465 7374  e values in test
-0001bfd0: 2074 6861 7420 6172 6520 6e6f 7420 696e   that are not in
-0001bfe0: 2074 7261 696e 2e0a 2020 2020 2323 2323   train..    ####
-0001bff0: 2323 2323 2323 2323 2323 2323 2323 2323  ################
-0001c000: 2323 2323 2323 2323 2323 2323 2323 2323  ################
-0001c010: 2323 2323 2323 2323 2323 2323 2323 2323  ################
-0001c020: 2323 2323 2323 2323 2323 2323 2323 2323  ################
-0001c030: 2323 2323 2323 2323 2323 2323 2323 2323  ################
-0001c040: 2323 230a 2020 2020 496e 7075 7473 3a0a  ###.    Inputs:.
-0001c050: 2020 2020 7472 6169 6e20 3a20 7061 6e64      train : pand
-0001c060: 6173 2064 6174 6166 7261 6d65 0a20 2020  as dataframe.   
-0001c070: 2074 6573 743a 2028 6f70 7469 6f6e 616c   test: (optional
-0001c080: 2920 7061 6e64 6173 2064 6174 6166 7261  ) pandas datafra
-0001c090: 6d65 0a0a 2020 2020 4f75 7470 7574 733a  me..    Outputs:
-0001c0a0: 0a20 2020 2074 7261 696e 3a20 7468 6973  .    train: this
-0001c0b0: 2069 7320 7468 6520 7472 616e 7366 6f72   is the transfor
-0001c0c0: 6d65 6420 4461 7461 4672 616d 650a 2020  med DataFrame.  
-0001c0d0: 2020 7465 7374 3a20 286f 7074 696f 6e61    test: (optiona
-0001c0e0: 6c29 2074 6869 7320 6973 2074 6865 2074  l) this is the t
-0001c0f0: 7261 6e73 666f 726d 6564 2074 6573 7420  ransformed test 
-0001c100: 6461 7461 6672 616d 6520 6966 2067 6976  dataframe if giv
-0001c110: 656e 2e0a 2020 2020 2323 2323 2323 2323  en..    ########
-0001c120: 2323 2323 2323 2323 2323 2323 2323 2323  ################
-0001c130: 2323 2323 2323 2323 2323 2323 2323 2323  ################
-0001c140: 2323 2323 2323 2323 2323 2323 2323 2323  ################
-0001c150: 2323 2323 2323 2323 2323 2323 2323 2323  ################
-0001c160: 2323 2323 2323 2323 2323 2323 2323 0a20  ##############. 
-0001c170: 2020 2022 2222 0a20 2020 200a 2020 2020     """.    .    
-0001c180: 7472 6169 6e20 3d20 636f 7079 2e64 6565  train = copy.dee
-0001c190: 7063 6f70 7928 7472 6169 6e29 0a20 2020  pcopy(train).   
-0001c1a0: 2074 6573 7420 3d20 636f 7079 2e64 6565   test = copy.dee
-0001c1b0: 7063 6f70 7928 7465 7374 290a 2020 2020  pcopy(test).    
-0001c1c0: 2323 2323 2054 6869 7320 6973 2074 6f20  #### This is to 
-0001c1d0: 6669 6c6c 2061 6c6c 206e 756d 6572 6963  fill all numeric
-0001c1e0: 2063 6f6c 756d 6e73 2077 6974 6820 6120   columns with a 
-0001c1f0: 6d69 7373 696e 6720 6e75 6d62 6572 2023  missing number #
-0001c200: 2323 2323 2323 2323 230a 2020 2020 6e75  #########.    nu
-0001c210: 6d73 203d 2074 7261 696e 2e73 656c 6563  ms = train.selec
-0001c220: 745f 6474 7970 6573 2827 6e75 6d62 6572  t_dtypes('number
-0001c230: 2729 2e63 6f6c 756d 6e73 2e74 6f6c 6973  ').columns.tolis
-0001c240: 7428 290a 2020 2020 6966 206c 656e 286e  t().    if len(n
-0001c250: 756d 7329 203d 3d20 303a 0a20 2020 2020  ums) == 0:.     
-0001c260: 2020 2070 6173 730a 2020 2020 656c 7365     pass.    else
-0001c270: 3a0a 0a20 2020 2020 2020 2069 6620 7472  :..        if tr
-0001c280: 6169 6e5b 6e75 6d73 5d2e 6973 6e75 6c6c  ain[nums].isnull
-0001c290: 2829 2e73 756d 2829 2e73 756d 2829 203e  ().sum().sum() >
-0001c2a0: 2030 3a0a 2020 2020 2020 2020 2020 2020   0:.            
-0001c2b0: 6e75 6c6c 5f63 6f6c 7320 3d20 6e70 2e61  null_cols = np.a
-0001c2c0: 7272 6179 286e 756d 7329 5b74 7261 696e  rray(nums)[train
-0001c2d0: 5b6e 756d 735d 2e69 736e 756c 6c28 292e  [nums].isnull().
-0001c2e0: 7375 6d28 293e 305d 2e74 6f6c 6973 7428  sum()>0].tolist(
-0001c2f0: 290a 2020 2020 2020 2020 2020 2020 666f  ).            fo
-0001c300: 7220 6561 6368 5f63 6f6c 2069 6e20 6e75  r each_col in nu
-0001c310: 6c6c 5f63 6f6c 733a 0a20 2020 2020 2020  ll_cols:.       
-0001c320: 2020 2020 2020 2020 206e 6577 5f6d 6973           new_mis
-0001c330: 7369 6e67 5f63 6f6c 203d 2065 6163 685f  sing_col = each_
-0001c340: 636f 6c20 2b20 275f 4d69 7373 696e 675f  col + '_Missing_
-0001c350: 466c 6167 270a 2020 2020 2020 2020 2020  Flag'.          
-0001c360: 2020 2020 2020 7472 6169 6e5b 6e65 775f        train[new_
-0001c370: 6d69 7373 696e 675f 636f 6c5d 203d 2030  missing_col] = 0
-0001c380: 0a20 2020 2020 2020 2020 2020 2020 2020  .               
-0001c390: 2074 7261 696e 2e6c 6f63 5b74 7261 696e   train.loc[train
-0001c3a0: 5b65 6163 685f 636f 6c5d 2e69 736e 756c  [each_col].isnul
-0001c3b0: 6c28 292c 6e65 775f 6d69 7373 696e 675f  l(),new_missing_
-0001c3c0: 636f 6c5d 3d31 0a20 2020 2020 2020 2020  col]=1.         
-0001c3d0: 2020 2020 2020 2074 7261 696e 5b65 6163         train[eac
-0001c3e0: 685f 636f 6c5d 203d 2074 7261 696e 5b65  h_col] = train[e
-0001c3f0: 6163 685f 636f 6c5d 2e66 696c 6c6e 6128  ach_col].fillna(
-0001c400: 2d39 3939 3929 0a20 2020 2020 2020 2020  -9999).         
-0001c410: 2020 2020 2020 2069 6620 6e6f 7420 7472         if not tr
-0001c420: 6169 6e5b 6561 6368 5f63 6f6c 5d2e 6474  ain[each_col].dt
-0001c430: 7970 6520 696e 205b 6e70 2e66 6c6f 6174  ype in [np.float
-0001c440: 3634 2c6e 702e 666c 6f61 7433 322c 6e70  64,np.float32,np
-0001c450: 2e66 6c6f 6174 3136 5d3a 0a20 2020 2020  .float16]:.     
-0001c460: 2020 2020 2020 2020 2020 2020 2020 2074                 t
-0001c470: 7261 696e 5b65 6163 685f 636f 6c5d 203d  rain[each_col] =
-0001c480: 2074 7261 696e 5b65 6163 685f 636f 6c5d   train[each_col]
-0001c490: 2e61 7374 7970 6528 696e 7429 0a20 2020  .astype(int).   
-0001c4a0: 2020 2020 2020 2020 2020 2020 2069 6620               if 
-0001c4b0: 6e6f 7420 6973 696e 7374 616e 6365 2874  not isinstance(t
-0001c4c0: 6573 742c 2073 7472 293a 0a20 2020 2020  est, str):.     
-0001c4d0: 2020 2020 2020 2020 2020 2020 2020 2069                 i
-0001c4e0: 6620 7465 7374 2069 7320 4e6f 6e65 3a0a  f test is None:.
-0001c4f0: 2020 2020 2020 2020 2020 2020 2020 2020                  
-0001c500: 2020 2020 2020 2020 7061 7373 0a20 2020          pass.   
-0001c510: 2020 2020 2020 2020 2020 2020 2020 2020                  
-0001c520: 2065 6c73 653a 0a20 2020 2020 2020 2020   else:.         
-0001c530: 2020 2020 2020 2020 2020 2020 2020 206e                 n
-0001c540: 6577 5f6d 6973 7369 6e67 5f63 6f6c 203d  ew_missing_col =
-0001c550: 2065 6163 685f 636f 6c20 2b20 275f 4d69   each_col + '_Mi
-0001c560: 7373 696e 675f 466c 6167 270a 2020 2020  ssing_Flag'.    
-0001c570: 2020 2020 2020 2020 2020 2020 2020 2020                  
-0001c580: 2020 2020 7465 7374 5b6e 6577 5f6d 6973      test[new_mis
-0001c590: 7369 6e67 5f63 6f6c 5d20 3d20 300a 2020  sing_col] = 0.  
-0001c5a0: 2020 2020 2020 2020 2020 2020 2020 2020                  
-0001c5b0: 2020 2020 2020 7465 7374 2e6c 6f63 5b74        test.loc[t
-0001c5c0: 6573 745b 6561 6368 5f63 6f6c 5d2e 6973  est[each_col].is
-0001c5d0: 6e75 6c6c 2829 2c6e 6577 5f6d 6973 7369  null(),new_missi
-0001c5e0: 6e67 5f63 6f6c 5d3d 310a 2020 2020 2020  ng_col]=1.      
-0001c5f0: 2020 2020 2020 2020 2020 2020 2020 2020                  
-0001c600: 2020 7465 7374 5b65 6163 685f 636f 6c5d    test[each_col]
-0001c610: 203d 2074 6573 745b 6561 6368 5f63 6f6c   = test[each_col
-0001c620: 5d2e 6669 6c6c 6e61 282d 3939 3939 290a  ].fillna(-9999).
-0001c630: 2020 2020 2020 2020 2020 2020 2020 2020                  
-0001c640: 2020 2020 2020 2020 6966 206e 6f74 2074          if not t
-0001c650: 6573 745b 6561 6368 5f63 6f6c 5d2e 6474  est[each_col].dt
-0001c660: 7970 6520 696e 205b 6e70 2e66 6c6f 6174  ype in [np.float
-0001c670: 3634 2c6e 702e 666c 6f61 7433 322c 6e70  64,np.float32,np
-0001c680: 2e66 6c6f 6174 3136 5d3a 0a20 2020 2020  .float16]:.     
-0001c690: 2020 2020 2020 2020 2020 2020 2020 2020                  
-0001c6a0: 2020 2020 2020 2074 6573 745b 6561 6368         test[each
-0001c6b0: 5f63 6f6c 5d20 3d20 7465 7374 5b65 6163  _col] = test[eac
-0001c6c0: 685f 636f 6c5d 2e61 7374 7970 6528 696e  h_col].astype(in
-0001c6d0: 7429 0a20 2020 2023 2323 2323 2320 4e6f  t).    ###### No
-0001c6e0: 7720 7765 2063 6f6e 7665 7274 2061 6c6c  w we convert all
-0001c6f0: 206f 626a 6563 7420 636f 6c75 6d6e 7320   object columns 
-0001c700: 746f 206e 756d 6572 6963 2023 2323 2323  to numeric #####
-0001c710: 2323 2323 230a 2020 2020 6c69 7320 3d20  #####.    lis = 
-0001c720: 5b5d 0a20 2020 206c 6973 203d 2074 7261  [].    lis = tra
-0001c730: 696e 2e73 656c 6563 745f 6474 7970 6573  in.select_dtypes
-0001c740: 2827 6f62 6a65 6374 2729 2e63 6f6c 756d  ('object').colum
-0001c750: 6e73 2e74 6f6c 6973 7428 2920 2b20 7472  ns.tolist() + tr
-0001c760: 6169 6e2e 7365 6c65 6374 5f64 7479 7065  ain.select_dtype
-0001c770: 7328 2763 6174 6567 6f72 7927 292e 636f  s('category').co
-0001c780: 6c75 6d6e 732e 746f 6c69 7374 2829 0a20  lumns.tolist(). 
-0001c790: 2020 2069 6620 6e6f 7420 6973 696e 7374     if not isinst
-0001c7a0: 616e 6365 2874 6573 742c 2073 7472 293a  ance(test, str):
-0001c7b0: 0a20 2020 2020 2020 2069 6620 7465 7374  .        if test
-0001c7c0: 2069 7320 4e6f 6e65 3a0a 2020 2020 2020   is None:.      
-0001c7d0: 2020 2020 2020 7061 7373 0a20 2020 2020        pass.     
-0001c7e0: 2020 2065 6c73 653a 0a20 2020 2020 2020     else:.       
-0001c7f0: 2020 2020 206c 6973 5f74 6573 7420 3d20       lis_test = 
-0001c800: 7465 7374 2e73 656c 6563 745f 6474 7970  test.select_dtyp
-0001c810: 6573 2827 6f62 6a65 6374 2729 2e63 6f6c  es('object').col
-0001c820: 756d 6e73 2e74 6f6c 6973 7428 2920 2b20  umns.tolist() + 
-0001c830: 7465 7374 2e73 656c 6563 745f 6474 7970  test.select_dtyp
-0001c840: 6573 2827 6361 7465 676f 7279 2729 2e63  es('category').c
-0001c850: 6f6c 756d 6e73 2e74 6f6c 6973 7428 290a  olumns.tolist().
-0001c860: 2020 2020 2020 2020 2020 2020 6966 206c              if l
-0001c870: 656e 286c 6566 745f 7375 6274 7261 6374  en(left_subtract
-0001c880: 286c 6973 2c20 6c69 735f 7465 7374 2929  (lis, lis_test))
-0001c890: 203e 2030 3a0a 2020 2020 2020 2020 2020   > 0:.          
-0001c8a0: 2020 2020 2020 2323 2320 6966 2074 6865        ### if the
-0001c8b0: 7265 2069 7320 616e 2065 7874 7261 2063  re is an extra c
-0001c8c0: 6f6c 756d 6e20 696e 2074 7261 696e 2074  olumn in train t
-0001c8d0: 6861 7420 6973 206e 6f74 2069 6e20 7465  hat is not in te
-0001c8e0: 7374 2c20 7468 656e 2072 656d 6f76 6520  st, then remove 
-0001c8f0: 6974 2066 726f 6d20 636f 6e73 6964 6572  it from consider
-0001c900: 6174 696f 6e0a 2020 2020 2020 2020 2020  ation.          
-0001c910: 2020 2020 2020 6c69 7320 3d20 636f 7079        lis = copy
-0001c920: 2e64 6565 7063 6f70 7928 6c69 735f 7465  .deepcopy(lis_te
-0001c930: 7374 290a 2020 2020 6966 206e 6f74 2028  st).    if not (
-0001c940: 6c65 6e28 6c69 7329 3d3d 3029 3a0a 2020  len(lis)==0):.  
-0001c950: 2020 2020 2020 666f 7220 6576 6572 7963        for everyc
-0001c960: 6f6c 2069 6e20 6c69 733a 0a20 2020 2020  ol in lis:.     
-0001c970: 2020 2020 2020 204d 4c42 203d 204d 795f         MLB = My_
-0001c980: 4c61 6265 6c45 6e63 6f64 6572 2829 0a20  LabelEncoder(). 
-0001c990: 2020 2020 2020 2020 2020 2074 7279 3a0a             try:.
-0001c9a0: 2020 2020 2020 2020 2020 2020 2020 2020                  
-0001c9b0: 7472 6169 6e5b 6576 6572 7963 6f6c 5d20  train[everycol] 
-0001c9c0: 3d20 4d4c 422e 6669 745f 7472 616e 7366  = MLB.fit_transf
-0001c9d0: 6f72 6d28 7472 6169 6e5b 6576 6572 7963  orm(train[everyc
-0001c9e0: 6f6c 5d29 0a20 2020 2020 2020 2020 2020  ol]).           
-0001c9f0: 2020 2020 2069 6620 6e6f 7420 6973 696e       if not isin
-0001ca00: 7374 616e 6365 2874 6573 742c 2073 7472  stance(test, str
-0001ca10: 293a 0a20 2020 2020 2020 2020 2020 2020  ):.             
-0001ca20: 2020 2020 2020 2069 6620 7465 7374 2069         if test i
-0001ca30: 7320 4e6f 6e65 3a0a 2020 2020 2020 2020  s None:.        
-0001ca40: 2020 2020 2020 2020 2020 2020 2020 2020                  
-0001ca50: 7061 7373 0a20 2020 2020 2020 2020 2020  pass.           
-0001ca60: 2020 2020 2020 2020 2065 6c73 653a 0a20           else:. 
-0001ca70: 2020 2020 2020 2020 2020 2020 2020 2020                  
-0001ca80: 2020 2020 2020 2074 6573 745b 6576 6572         test[ever
-0001ca90: 7963 6f6c 5d20 3d20 4d4c 422e 7472 616e  ycol] = MLB.tran
-0001caa0: 7366 6f72 6d28 7465 7374 5b65 7665 7279  sform(test[every
-0001cab0: 636f 6c5d 290a 2020 2020 2020 2020 2020  col]).          
-0001cac0: 2020 6578 6365 7074 3a0a 2020 2020 2020    except:.      
-0001cad0: 2020 2020 2020 2020 2020 7072 696e 7428            print(
-0001cae0: 2745 7272 6f72 2063 6f6e 7665 7274 696e  'Error convertin
-0001caf0: 6720 2573 2063 6f6c 756d 6e20 6672 6f6d  g %s column from
-0001cb00: 2073 7472 696e 6720 746f 206e 756d 6572   string to numer
-0001cb10: 6963 2e20 436f 6e74 696e 7569 6e67 2e2e  ic. Continuing..
-0001cb20: 2e27 2025 6576 6572 7963 6f6c 290a 2020  .' %everycol).  
-0001cb30: 2020 2020 2020 2020 2020 2020 2020 636f                co
-0001cb40: 6e74 696e 7565 0a20 2020 2072 6574 7572  ntinue.    retur
-0001cb50: 6e20 7472 6169 6e2c 2074 6573 740a 2323  n train, test.##
-0001cb60: 2323 2323 2323 2323 2323 2323 2323 2323  ################
-0001cb70: 2323 2323 2323 2323 2323 2323 2323 2323  ################
-0001cb80: 2323 2323 2323 2323 2323 2323 2323 2323  ################
-0001cb90: 2323 2323 2323 2323 2323 2323 2323 2323  ################
-0001cba0: 2323 2323 2323 2323 2323 2323 2323 2323  ################
-0001cbb0: 2323 2323 2323 2323 2323 2323 2323 0a64  ##############.d
-0001cbc0: 6566 2064 726f 705f 7365 636f 6e64 5f63  ef drop_second_c
-0001cbd0: 6f6c 2858 7429 3a20 0a20 2020 2023 2323  ol(Xt): .    ###
-0001cbe0: 2054 6869 7320 6465 6c65 7465 7320 7468   This deletes th
-0001cbf0: 6520 326e 6420 636f 6c75 6d6e 2e20 4865  e 2nd column. He
-0001cc00: 6e63 6520 636f 6c20 6e75 6d62 6572 3d31  nce col number=1
-0001cc10: 2061 6e64 2061 7869 733d 3120 2323 230a   and axis=1 ###.
-0001cc20: 2020 2020 0a20 2020 2072 6574 7572 6e20      .    return 
-0001cc30: 6e70 2e64 656c 6574 6528 5874 2c20 312c  np.delete(Xt, 1,
-0001cc40: 2031 290a 0a64 6566 2063 6861 6e67 655f   1)..def change_
-0001cc50: 636f 6c5f 746f 5f73 7472 696e 6728 5874  col_to_string(Xt
-0001cc60: 293a 200a 2020 2020 2323 2320 5468 6973  ): .    ### This
-0001cc70: 2063 6f6e 7665 7274 7320 7468 6520 696e   converts the in
-0001cc80: 7075 7420 636f 6c75 6d6e 2074 6f20 6120  put column to a 
-0001cc90: 7374 7269 6e67 2061 6e64 2072 6574 7572  string and retur
-0001cca0: 6e73 2069 7420 2323 0a20 2020 2072 6574  ns it ##.    ret
-0001ccb0: 7572 6e20 5874 2e61 7374 7970 6528 7374  urn Xt.astype(st
-0001ccc0: 7229 0a0a 6465 6620 6372 6561 7465 5f63  r)..def create_c
-0001ccd0: 6f6c 756d 6e5f 6e61 6d65 7328 5874 2c20  olumn_names(Xt, 
-0001cce0: 6e6c 7076 6172 733d 5b5d 2c20 6361 7476  nlpvars=[], catv
-0001ccf0: 6172 733d 5b5d 2c20 6469 7363 7265 7465  ars=[], discrete
-0001cd00: 7661 7273 3d5b 5d2c 2066 6c6f 6174 7661  vars=[], floatva
-0001cd10: 7273 3d5b 5d2c 2069 6e74 7661 7273 3d5b  rs=[], intvars=[
-0001cd20: 5d2c 0a20 2020 2020 2020 2020 2020 2020  ],.             
-0001cd30: 2020 2064 6174 6576 6172 733d 5b5d 2c20     datevars=[], 
-0001cd40: 6f6e 6568 6f74 5f64 6963 743d 7b7d 2c20  onehot_dict={}, 
-0001cd50: 636f 6c73 697a 655f 6469 6374 3d7b 7d2c  colsize_dict={},
-0001cd60: 6461 7465 7369 7a65 5f64 6963 743d 7b7d  datesize_dict={}
-0001cd70: 293a 0a20 2020 200a 2020 2020 636f 6c73  ):.    .    cols
-0001cd80: 5f6e 6c70 203d 205b 5d0a 2020 2020 2323  _nlp = [].    ##
-0001cd90: 2320 5468 6973 206e 616d 6573 2061 6c6c  # This names all
-0001cda0: 2074 6865 2066 6561 7475 7265 7320 6372   the features cr
-0001cdb0: 6561 7465 6420 6279 2074 6865 204e 4c50  eated by the NLP
-0001cdc0: 2063 6f6c 756d 6e2e 2048 656e 6365 2063   column. Hence c
-0001cdd0: 6f6c 206e 756d 6265 723d 3120 616e 6420  ol number=1 and 
-0001cde0: 6178 6973 3d31 2023 2323 0a20 2020 2066  axis=1 ###.    f
-0001cdf0: 6f72 2065 6163 685f 6e6c 7020 696e 206e  or each_nlp in n
-0001ce00: 6c70 7661 7273 3a0a 2020 2020 2020 2020  lpvars:.        
-0001ce10: 636f 6c73 697a 6520 3d20 636f 6c73 697a  colsize = colsiz
-0001ce20: 655f 6469 6374 5b65 6163 685f 6e6c 705d  e_dict[each_nlp]
-0001ce30: 0a20 2020 2020 2020 206e 6c70 5f61 6464  .        nlp_add
-0001ce40: 203d 205b 6561 6368 5f6e 6c70 2b27 5f27   = [each_nlp+'_'
-0001ce50: 2b73 7472 2878 2920 666f 7220 7820 696e  +str(x) for x in
-0001ce60: 2072 616e 6765 2863 6f6c 7369 7a65 295d   range(colsize)]
-0001ce70: 0a20 2020 2020 2020 2063 6f6c 735f 6e6c  .        cols_nl
-0001ce80: 7020 2b3d 206e 6c70 5f61 6464 0a20 2020  p += nlp_add.   
-0001ce90: 2023 2323 2074 6869 7320 6973 2066 6f72   ### this is for
-0001cea0: 2064 6973 6372 6574 6520 636f 6c75 6d6e   discrete column
-0001ceb0: 206e 616d 6573 2023 2323 230a 2020 2020   names ####.    
-0001cec0: 636f 6c73 5f64 6973 6372 6574 6520 3d20  cols_discrete = 
-0001ced0: 5b5d 0a20 2020 2066 6f72 2065 6163 685f  [].    for each_
-0001cee0: 6469 7363 7265 7465 2069 6e20 6469 7363  discrete in disc
-0001cef0: 7265 7465 7661 7273 3a0a 2020 2020 2020  retevars:.      
-0001cf00: 2020 2323 2320 666f 7220 616e 7974 6869    ### for anythi
-0001cf10: 6e67 206f 7468 6572 2074 6861 6e20 6f6e  ng other than on
-0001cf20: 652d 686f 7420 7765 2073 686f 756c 6420  e-hot we should 
-0001cf30: 6a75 7374 2075 7365 206c 6162 656c 2065  just use label e
-0001cf40: 6e63 6f64 696e 6720 746f 206d 616b 6520  ncoding to make 
-0001cf50: 6974 2073 696d 706c 6572 2023 230a 2020  it simpler ##.  
-0001cf60: 2020 2020 2020 6469 7363 7265 7465 5f61        discrete_a
-0001cf70: 6464 203d 2065 6163 685f 6469 7363 7265  dd = each_discre
-0001cf80: 7465 2b27 5f65 6e63 6f64 6564 270a 2020  te+'_encoded'.  
-0001cf90: 2020 2020 2020 636f 6c73 5f64 6973 6372        cols_discr
-0001cfa0: 6574 652e 6170 7065 6e64 2864 6973 6372  ete.append(discr
-0001cfb0: 6574 655f 6164 6429 0a20 2020 2023 2320  ete_add).    ## 
-0001cfc0: 646f 2074 6865 2073 616d 6520 666f 7220  do the same for 
-0001cfd0: 6461 7465 7661 7273 2023 2323 0a20 2020  datevars ###.   
-0001cfe0: 2063 6f6c 735f 6461 7465 203d 205b 5d0a   cols_date = [].
-0001cff0: 2020 2020 666f 7220 6561 6368 5f64 6174      for each_dat
-0001d000: 6520 696e 2064 6174 6576 6172 733a 0a20  e in datevars:. 
-0001d010: 2020 2020 2020 2023 636f 6c73 697a 6520         #colsize 
-0001d020: 3d20 6461 7465 7369 7a65 5f64 6963 745b  = datesize_dict[
-0001d030: 6561 6368 5f64 6174 655d 0a20 2020 2020  each_date].     
-0001d040: 2020 2023 6461 7465 5f61 6464 203d 205b     #date_add = [
-0001d050: 6561 6368 5f64 6174 652b 275f 272b 7374  each_date+'_'+st
-0001d060: 7228 7829 2066 6f72 2078 2069 6e20 7261  r(x) for x in ra
-0001d070: 6e67 6528 636f 6c73 697a 6529 5d0a 2020  nge(colsize)].  
-0001d080: 2020 2020 2020 6461 7465 5f61 6464 203d        date_add =
-0001d090: 2064 6174 6573 697a 655f 6469 6374 5b65   datesize_dict[e
-0001d0a0: 6163 685f 6461 7465 5d0a 2020 2020 2020  ach_date].      
-0001d0b0: 2020 636f 6c73 5f64 6174 6520 2b3d 2064    cols_date += d
-0001d0c0: 6174 655f 6164 640a 0a20 2020 2023 2323  ate_add..    ###
-0001d0d0: 2320 7468 6973 2069 7320 7768 6572 6520  # this is where 
-0001d0e0: 7765 2070 7574 2061 6c6c 2074 6865 2063  we put all the c
-0001d0f0: 6f6c 756d 6e20 6e61 6d65 7320 746f 6765  olumn names toge
-0001d100: 7468 6572 2023 2323 2323 2323 0a20 2020  ther #######.   
-0001d110: 2063 6f6c 735f 6e61 6d65 7320 3d20 6361   cols_names = ca
-0001d120: 7476 6172 732b 636f 6c73 5f64 6973 6372  tvars+cols_discr
-0001d130: 6574 652b 696e 7476 6172 732b 636f 6c73  ete+intvars+cols
-0001d140: 5f64 6174 650a 2020 2020 6e75 6d5f 7661  _date.    num_va
-0001d150: 7273 203d 2063 6f6c 735f 6e6c 702b 666c  rs = cols_nlp+fl
-0001d160: 6f61 7476 6172 730a 2020 2020 6e75 6d5f  oatvars.    num_
-0001d170: 6c65 6e20 3d20 6c65 6e28 6e75 6d5f 7661  len = len(num_va
-0001d180: 7273 290a 0a20 2020 2023 2323 2058 7420  rs)..    ### Xt 
-0001d190: 6973 2061 2053 7061 7273 6520 6d61 7472  is a Sparse matr
-0001d1a0: 6978 2061 7272 6179 2c20 7765 206e 6565  ix array, we nee
-0001d1b0: 6420 746f 2063 6f6e 7665 7274 2069 7420  d to convert it 
-0001d1c0: 2074 6f20 6465 6e73 6520 6172 7261 7920   to dense array 
-0001d1d0: 2323 0a20 2020 2069 6620 7363 6970 792e  ##.    if scipy.
-0001d1e0: 7370 6172 7365 2e69 7373 7061 7273 6528  sparse.issparse(
-0001d1f0: 5874 293a 0a20 2020 2020 2020 2058 7420  Xt):.        Xt 
-0001d200: 3d20 5874 2e74 6f61 7272 6179 2829 0a0a  = Xt.toarray()..
-0001d210: 2020 2020 2323 2320 5874 2069 7320 616c      ### Xt is al
-0001d220: 7265 6164 7920 6120 6465 6e73 6520 6172  ready a dense ar
-0001d230: 7261 792c 206e 6f20 6e65 6564 2074 6f20  ray, no need to 
-0001d240: 636f 6e76 6572 7420 6974 2023 230a 2020  convert it ##.  
-0001d250: 2020 6966 206e 756d 5f6c 656e 203d 3d20    if num_len == 
-0001d260: 303a 0a20 2020 2020 2020 2058 696e 7420  0:.        Xint 
-0001d270: 3d20 7064 2e44 6174 6146 7261 6d65 2858  = pd.DataFrame(X
-0001d280: 745b 3a2c 3a5d 2c20 636f 6c75 6d6e 7320  t[:,:], columns 
-0001d290: 3d20 636f 6c73 5f6e 616d 6573 2c20 6474  = cols_names, dt
-0001d2a0: 7970 653d 6e70 2e69 6e74 3136 290a 2020  ype=np.int16).  
-0001d2b0: 2020 2020 2020 7265 7475 726e 2058 696e        return Xin
-0001d2c0: 740a 2020 2020 656c 7365 3a0a 2020 2020  t.    else:.    
-0001d2d0: 2020 2020 5869 6e74 203d 2070 642e 4461      Xint = pd.Da
-0001d2e0: 7461 4672 616d 6528 5874 5b3a 2c3a 2d6e  taFrame(Xt[:,:-n
-0001d2f0: 756d 5f6c 656e 5d2c 2063 6f6c 756d 6e73  um_len], columns
-0001d300: 203d 2063 6f6c 735f 6e61 6d65 732c 2064   = cols_names, d
-0001d310: 7479 7065 3d6e 702e 696e 7431 3629 0a20  type=np.int16). 
-0001d320: 2020 2020 2020 2058 6e75 6d20 3d20 7064         Xnum = pd
-0001d330: 2e44 6174 6146 7261 6d65 2858 745b 3a2c  .DataFrame(Xt[:,
-0001d340: 2d6e 756d 5f6c 656e 3a5d 2c20 636f 6c75  -num_len:], colu
-0001d350: 6d6e 7320 3d20 6e75 6d5f 7661 7273 2c20  mns = num_vars, 
-0001d360: 6474 7970 653d 6e70 2e66 6c6f 6174 3332  dtype=np.float32
-0001d370: 290a 2020 2020 2020 2020 2323 2323 2074  ).        #### t
-0001d380: 6869 7320 6973 2077 6865 7265 2077 6520  his is where we 
-0001d390: 7075 7420 616c 6c20 7468 6520 636f 6c75  put all the colu
-0001d3a0: 6d6e 206e 616d 6573 2074 6f67 6574 6865  mn names togethe
-0001d3b0: 7220 2323 2323 2323 230a 2020 2020 2020  r #######.      
-0001d3c0: 2020 6466 203d 2070 642e 636f 6e63 6174    df = pd.concat
-0001d3d0: 285b 5869 6e74 2c20 586e 756d 5d2c 2061  ([Xint, Xnum], a
-0001d3e0: 7869 733d 3129 0a20 2020 2020 2020 2072  xis=1).        r
-0001d3f0: 6574 7572 6e20 6466 0a23 2323 2323 2323  eturn df.#######
-0001d400: 2323 2323 2323 2323 2323 2323 2323 2323  ################
-0001d410: 2323 2323 2323 2323 2323 2323 2323 2323  ################
-0001d420: 2323 2323 2323 2323 2323 2323 2323 2323  ################
-0001d430: 2323 2323 2323 2323 2323 2323 2323 2323  ################
-0001d440: 2323 2323 2323 2323 2323 2323 2323 2323  ################
-0001d450: 2323 2323 2323 2323 2323 2323 2323 2323  ################
-0001d460: 2323 2323 2323 0a69 6d70 6f72 7420 7261  ######.import ra
-0001d470: 6e64 6f6d 0a69 6d70 6f72 7420 636f 6c6c  ndom.import coll
-0001d480: 6563 7469 6f6e 730a 7261 6e64 6f6d 2e73  ections.random.s
-0001d490: 6565 6428 3130 290a 6465 6620 6d61 6b65  eed(10).def make
-0001d4a0: 5f63 6f6c 756d 6e5f 6e61 6d65 735f 756e  _column_names_un
-0001d4b0: 6971 7565 2863 6f6c 7329 3a0a 2020 2020  ique(cols):.    
-0001d4c0: 7365 7220 3d20 7064 2e53 6572 6965 7328  ser = pd.Series(
-0001d4d0: 636f 6c73 290a 2020 2020 2323 2320 5468  cols).    ### Th
-0001d4e0: 6973 2066 756e 6374 696f 6e20 7265 6d6f  is function remo
-0001d4f0: 7665 7320 616c 6c20 7370 6563 6961 6c20  ves all special 
-0001d500: 6368 6172 7320 6672 6f6d 2061 206c 6973  chars from a lis
-0001d510: 7420 2323 230a 2020 2020 7265 6d6f 7665  t ###.    remove
-0001d520: 5f73 7065 6369 616c 5f63 6861 7273 203d  _special_chars =
-0001d530: 2020 6c61 6d62 6461 2078 3a72 652e 7375    lambda x:re.su
-0001d540: 6228 275b 5e41 2d5a 612d 7a30 2d39 5f5d  b('[^A-Za-z0-9_]
-0001d550: 2b27 2c20 2727 2c20 7829 0a20 2020 200a  +', '', x).    .
-0001d560: 2020 2020 6e65 776c 7320 3d20 7365 722e      newls = ser.
-0001d570: 6d61 7028 7265 6d6f 7665 5f73 7065 6369  map(remove_speci
-0001d580: 616c 5f63 6861 7273 292e 7661 6c75 6573  al_chars).values
-0001d590: 2e74 6f6c 6973 7428 290a 2020 2020 2323  .tolist().    ##
-0001d5a0: 2320 7468 6572 6520 6d61 7920 6265 2064  # there may be d
-0001d5b0: 7570 6c69 6361 7465 7320 696e 2074 6869  uplicates in thi
-0001d5c0: 7320 6c69 7374 202d 2077 6520 6e65 6564  s list - we need
-0001d5d0: 2074 6f20 6d61 6b65 2074 6865 6d20 756e   to make them un
-0001d5e0: 6971 7565 2062 7920 7261 6e64 6f6d 6c79  ique by randomly
-0001d5f0: 2061 6464 696e 6720 7374 7269 6e67 7320   adding strings 
-0001d600: 746f 206e 616d 6520 2323 0a20 2020 2073  to name ##.    s
-0001d610: 6565 6e20 3d20 5b69 7465 6d20 666f 7220  een = [item for 
-0001d620: 6974 656d 2c20 636f 756e 7420 696e 2063  item, count in c
-0001d630: 6f6c 6c65 6374 696f 6e73 2e43 6f75 6e74  ollections.Count
-0001d640: 6572 286e 6577 6c73 292e 6974 656d 7328  er(newls).items(
-0001d650: 2920 6966 2063 6f75 6e74 203e 2031 5d0a  ) if count > 1].
-0001d660: 2020 2020 636f 6c73 203d 205b 782b 7374      cols = [x+st
-0001d670: 7228 7261 6e64 6f6d 2e72 616e 6469 6e74  r(random.randint
-0001d680: 2831 2c31 3030 3029 2920 6966 2078 2069  (1,1000)) if x i
-0001d690: 6e20 7365 656e 2065 6c73 6520 7820 666f  n seen else x fo
-0001d6a0: 7220 7820 696e 206e 6577 6c73 5d0a 2020  r x in newls].  
-0001d6b0: 2020 7265 7475 726e 2063 6f6c 730a 2323    return cols.##
-0001d6c0: 2323 2323 2323 2323 2323 2323 2323 2323  ################
-0001d6d0: 2323 2323 2323 2323 2323 2323 2323 2323  ################
-0001d6e0: 2323 2323 2323 2323 2323 2323 2323 2323  ################
-0001d6f0: 2323 2323 2323 2323 2323 2323 2323 2323  ################
-0001d700: 2323 2323 2323 2323 2323 2323 2323 2323  ################
-0001d710: 2323 2323 2323 2323 2323 2323 2323 2323  ################
-0001d720: 2323 2323 2323 2323 2323 230a 6465 6620  ###########.def 
-0001d730: 6372 6561 7465 5f63 6f6c 756d 6e5f 6e61  create_column_na
-0001d740: 6d65 735f 6f6e 6568 6f74 2858 742c 206e  mes_onehot(Xt, n
-0001d750: 6c70 7661 7273 3d5b 5d2c 2063 6174 7661  lpvars=[], catva
-0001d760: 7273 3d5b 5d2c 2064 6973 6372 6574 6576  rs=[], discretev
-0001d770: 6172 733d 5b5d 2c20 666c 6f61 7476 6172  ars=[], floatvar
-0001d780: 733d 5b5d 2c20 696e 7476 6172 733d 5b5d  s=[], intvars=[]
-0001d790: 2c0a 2020 2020 2020 2020 2020 2020 2020  ,.              
-0001d7a0: 2020 2020 2020 2020 2020 6461 7465 7661            dateva
-0001d7b0: 7273 3d5b 5d2c 206f 6e65 686f 745f 6469  rs=[], onehot_di
-0001d7c0: 6374 3d7b 7d2c 0a20 2020 2020 2020 2020  ct={},.         
-0001d7d0: 2020 2020 2020 2020 2020 2020 2020 2063                 c
-0001d7e0: 6f6c 7369 7a65 5f64 6963 743d 7b7d 2c20  olsize_dict={}, 
-0001d7f0: 6461 7465 7369 7a65 5f64 6963 743d 7b7d  datesize_dict={}
-0001d800: 293a 0a20 2020 2023 2323 2054 6869 7320  ):.    ### This 
-0001d810: 6e61 6d65 7320 616c 6c20 7468 6520 6665  names all the fe
-0001d820: 6174 7572 6573 2063 7265 6174 6564 2062  atures created b
-0001d830: 7920 7468 6520 4e4c 5020 636f 6c75 6d6e  y the NLP column
-0001d840: 2e20 4865 6e63 6520 636f 6c20 6e75 6d62  . Hence col numb
-0001d850: 6572 3d31 2061 6e64 2061 7869 733d 3120  er=1 and axis=1 
-0001d860: 2323 230a 2020 2020 2323 2320 4f6e 6365  ###.    ### Once
-0001d870: 2079 6f75 2067 6574 2062 6163 6b20 6e61   you get back na
-0001d880: 6d65 7320 6f66 206f 6e65 2068 6f74 2065  mes of one hot e
-0001d890: 6e63 6f64 6564 2063 6f6c 756d 6e73 2c20  ncoded columns, 
-0001d8a0: 6368 616e 6765 2074 6865 2063 6f6c 756d  change the colum
-0001d8b0: 6e20 6e61 6d65 730a 2020 2020 636f 6c73  n names.    cols
-0001d8c0: 5f63 6174 203d 205b 5d0a 2020 2020 785f  _cat = [].    x_
-0001d8d0: 636f 6c73 203d 205b 5d0a 2020 2020 0a20  cols = [].    . 
-0001d8e0: 2020 2066 6f72 2065 6163 685f 6361 7420     for each_cat 
-0001d8f0: 696e 2063 6174 7661 7273 3a0a 2020 2020  in catvars:.    
-0001d900: 2020 2020 6361 7465 6773 203d 206f 6e65      categs = one
-0001d910: 686f 745f 6469 6374 5b65 6163 685f 6361  hot_dict[each_ca
-0001d920: 745d 0a20 2020 2020 2020 2069 6620 6973  t].        if is
-0001d930: 696e 7374 616e 6365 2863 6174 6567 732c  instance(categs,
-0001d940: 2073 7472 293a 0a20 2020 2020 2020 2020   str):.         
-0001d950: 2020 2069 6620 6361 7465 6773 203d 3d20     if categs == 
-0001d960: 276c 6162 656c 273a 0a20 2020 2020 2020  'label':.       
-0001d970: 2020 2020 2020 2020 2063 6174 5f61 6464           cat_add
-0001d980: 203d 2065 6163 685f 6361 742b 275f 656e   = each_cat+'_en
-0001d990: 636f 6465 6427 0a20 2020 2020 2020 2020  coded'.         
-0001d9a0: 2020 2020 2020 2063 6f6c 735f 6361 742e         cols_cat.
-0001d9b0: 6170 7065 6e64 2863 6174 5f61 6464 290a  append(cat_add).
-0001d9c0: 2020 2020 2020 2020 2020 2020 656c 7365              else
-0001d9d0: 3a0a 2020 2020 2020 2020 2020 2020 2020  :.              
-0001d9e0: 2020 6361 7465 6773 203d 205b 6361 7465    categs = [cate
-0001d9f0: 6773 5d0a 2020 2020 2020 2020 2020 2020  gs].            
-0001da00: 2020 2020 6361 745f 6164 6420 3d20 5b65      cat_add = [e
-0001da10: 6163 685f 6361 742b 275f 272b 7374 7228  ach_cat+'_'+str(
-0001da20: 6361 7465 6773 5b69 5d29 2066 6f72 2069  categs[i]) for i
-0001da30: 2069 6e20 7261 6e67 6528 6c65 6e28 6361   in range(len(ca
-0001da40: 7465 6773 2929 5d0a 2020 2020 2020 2020  tegs))].        
-0001da50: 2020 2020 2020 2020 636f 6c73 5f63 6174          cols_cat
-0001da60: 202b 3d20 6361 745f 6164 640a 2020 2020   += cat_add.    
-0001da70: 2020 2020 656c 7365 3a0a 2020 2020 2020      else:.      
-0001da80: 2020 2020 2020 6361 745f 6164 6420 3d20        cat_add = 
-0001da90: 5b65 6163 685f 6361 742b 275f 272b 7374  [each_cat+'_'+st
-0001daa0: 7228 6361 7465 6773 5b69 5d29 2066 6f72  r(categs[i]) for
-0001dab0: 2069 2069 6e20 7261 6e67 6528 6c65 6e28   i in range(len(
-0001dac0: 6361 7465 6773 2929 5d0a 2020 2020 2020  categs))].      
-0001dad0: 2020 2020 2020 636f 6c73 5f63 6174 202b        cols_cat +
-0001dae0: 3d20 6361 745f 6164 640a 2020 2020 0a20  = cat_add.    . 
-0001daf0: 2020 2063 6f6c 735f 6361 7420 3d20 6d61     cols_cat = ma
-0001db00: 6b65 5f63 6f6c 756d 6e5f 6e61 6d65 735f  ke_column_names_
-0001db10: 756e 6971 7565 2863 6f6c 735f 6361 7429  unique(cols_cat)
-0001db20: 0a20 2020 200a 2020 2020 636f 6c73 5f64  .    .    cols_d
-0001db30: 6973 6372 6574 6520 3d20 5b5d 0a20 2020  iscrete = [].   
-0001db40: 2064 6973 6372 6574 655f 6164 6420 3d20   discrete_add = 
-0001db50: 5b5d 0a20 2020 2066 6f72 2065 6163 685f  [].    for each_
-0001db60: 6469 7363 7265 7465 2069 6e20 6469 7363  discrete in disc
-0001db70: 7265 7465 7661 7273 3a0a 2020 2020 2020  retevars:.      
-0001db80: 2020 2323 2320 666f 7220 616e 7974 6869    ### for anythi
-0001db90: 6e67 206f 7468 6572 2074 6861 6e20 6f6e  ng other than on
-0001dba0: 652d 686f 7420 7765 2073 686f 756c 6420  e-hot we should 
-0001dbb0: 6a75 7374 2075 7365 206c 6162 656c 2065  just use label e
-0001dbc0: 6e63 6f64 696e 6720 746f 206d 616b 6520  ncoding to make 
-0001dbd0: 6974 2073 696d 706c 6572 2023 230a 2020  it simpler ##.  
-0001dbe0: 2020 2020 2020 7472 793a 0a20 2020 2020        try:.     
-0001dbf0: 2020 2020 2020 2063 6174 6567 7320 3d20         categs = 
-0001dc00: 6f6e 6568 6f74 5f64 6963 745b 6561 6368  onehot_dict[each
-0001dc10: 5f64 6973 6372 6574 655d 0a20 2020 2020  _discrete].     
-0001dc20: 2020 2020 2020 2069 6620 6973 696e 7374         if isinst
-0001dc30: 616e 6365 2863 6174 6567 732c 2073 7472  ance(categs, str
-0001dc40: 293a 0a20 2020 2020 2020 2020 2020 2020  ):.             
-0001dc50: 2020 2069 6620 6361 7465 6773 203d 3d20     if categs == 
-0001dc60: 276c 6162 656c 273a 0a20 2020 2020 2020  'label':.       
-0001dc70: 2020 2020 2020 2020 2020 2020 2064 6973               dis
-0001dc80: 6372 6574 655f 6164 6420 3d20 6561 6368  crete_add = each
-0001dc90: 5f64 6973 6372 6574 652b 275f 656e 636f  _discrete+'_enco
-0001dca0: 6465 6427 0a20 2020 2020 2020 2020 2020  ded'.           
-0001dcb0: 2020 2020 2020 2020 2063 6f6c 735f 6469           cols_di
-0001dcc0: 7363 7265 7465 2e61 7070 656e 6428 6469  screte.append(di
-0001dcd0: 7363 7265 7465 5f61 6464 290a 2020 2020  screte_add).    
-0001dce0: 2020 2020 2020 2020 2020 2020 656c 7365              else
-0001dcf0: 3a0a 2020 2020 2020 2020 2020 2020 2020  :.              
-0001dd00: 2020 2020 2020 6361 7465 6773 203d 205b        categs = [
-0001dd10: 6361 7465 6773 5d0a 2020 2020 2020 2020  categs].        
-0001dd20: 2020 2020 2020 2020 2020 2020 6469 7363              disc
-0001dd30: 7265 7465 5f61 6464 203d 205b 6561 6368  rete_add = [each
-0001dd40: 5f64 6973 6372 6574 652b 275f 272b 7820  _discrete+'_'+x 
-0001dd50: 666f 7220 7820 696e 2063 6174 6567 735d  for x in categs]
-0001dd60: 0a20 2020 2020 2020 2020 2020 2020 2020  .               
-0001dd70: 2020 2020 2063 6f6c 735f 6469 7363 7265       cols_discre
-0001dd80: 7465 202b 3d20 6469 7363 7265 7465 5f61  te += discrete_a
-0001dd90: 6464 0a20 2020 2020 2020 2020 2020 2065  dd.            e
-0001dda0: 6c73 653a 0a20 2020 2020 2020 2020 2020  lse:.           
-0001ddb0: 2020 2020 2064 6973 6372 6574 655f 6164       discrete_ad
-0001ddc0: 6420 3d20 5b65 6163 685f 6469 7363 7265  d = [each_discre
-0001ddd0: 7465 2b27 5f27 2b78 2066 6f72 2078 2069  te+'_'+x for x i
-0001dde0: 6e20 6361 7465 6773 5d0a 2020 2020 2020  n categs].      
-0001ddf0: 2020 2020 2020 2020 2020 636f 6c73 5f64            cols_d
-0001de00: 6973 6372 6574 6520 2b3d 2064 6973 6372  iscrete += discr
-0001de10: 6574 655f 6164 640a 2020 2020 2020 2020  ete_add.        
-0001de20: 6578 6365 7074 3a0a 2020 2020 2020 2020  except:.        
-0001de30: 2020 2020 2323 2320 6966 2074 6865 7265      ### if there
-0001de40: 2069 7320 6e6f 206e 6577 2076 6172 2074   is no new var t
-0001de50: 6f20 6265 2063 7265 6174 6564 2c20 6a75  o be created, ju
-0001de60: 7374 2075 7365 2074 6865 2065 7869 7374  st use the exist
-0001de70: 696e 6720 6469 7363 7265 7465 2076 6172  ing discrete var
-0001de80: 7320 6974 7365 6c66 2023 2323 0a20 2020  s itself ###.   
-0001de90: 2020 2020 2020 2020 2063 6f6c 735f 6469           cols_di
-0001dea0: 7363 7265 7465 2e61 7070 656e 6428 6561  screte.append(ea
-0001deb0: 6368 5f64 6973 6372 6574 6529 0a20 2020  ch_discrete).   
-0001dec0: 2063 6f6c 735f 6469 7363 7265 7465 203d   cols_discrete =
-0001ded0: 206d 616b 655f 636f 6c75 6d6e 5f6e 616d   make_column_nam
-0001dee0: 6573 5f75 6e69 7175 6528 636f 6c73 5f64  es_unique(cols_d
-0001def0: 6973 6372 6574 6529 0a20 2020 200a 2020  iscrete).    .  
-0001df00: 2020 636f 6c73 5f6e 6c70 203d 205b 5d0a    cols_nlp = [].
-0001df10: 2020 2020 6e6c 705f 6164 6420 3d20 5b5d      nlp_add = []
-0001df20: 0a20 2020 2066 6f72 2065 6163 685f 6e6c  .    for each_nl
-0001df30: 7020 696e 206e 6c70 7661 7273 3a0a 2020  p in nlpvars:.  
-0001df40: 2020 2020 2020 636f 6c73 697a 6520 3d20        colsize = 
-0001df50: 636f 6c73 697a 655f 6469 6374 5b65 6163  colsize_dict[eac
-0001df60: 685f 6e6c 705d 0a20 2020 2020 2020 206e  h_nlp].        n
-0001df70: 6c70 5f61 6464 203d 205b 6561 6368 5f6e  lp_add = [each_n
-0001df80: 6c70 2b27 5f27 2b73 7472 2878 2920 666f  lp+'_'+str(x) fo
-0001df90: 7220 7820 696e 2072 616e 6765 2863 6f6c  r x in range(col
-0001dfa0: 7369 7a65 295d 0a20 2020 2020 2020 2063  size)].        c
-0001dfb0: 6f6c 735f 6e6c 7020 2b3d 206e 6c70 5f61  ols_nlp += nlp_a
-0001dfc0: 6464 0a20 2020 2023 2320 646f 2074 6865  dd.    ## do the
-0001dfd0: 2073 616d 6520 666f 7220 6461 7465 7661   same for dateva
-0001dfe0: 7273 2023 2323 0a20 2020 2063 6f6c 735f  rs ###.    cols_
-0001dff0: 6461 7465 203d 205b 5d0a 2020 2020 6461  date = [].    da
-0001e000: 7465 5f61 6464 203d 205b 5d0a 2020 2020  te_add = [].    
-0001e010: 666f 7220 6561 6368 5f64 6174 6520 696e  for each_date in
-0001e020: 2064 6174 6576 6172 733a 0a20 2020 2020   datevars:.     
-0001e030: 2020 2023 636f 6c73 697a 6520 3d20 6461     #colsize = da
-0001e040: 7465 7369 7a65 5f64 6963 745b 6561 6368  tesize_dict[each
-0001e050: 5f64 6174 655d 0a20 2020 2020 2020 2023  _date].        #
-0001e060: 6461 7465 5f61 6464 203d 205b 6561 6368  date_add = [each
-0001e070: 5f64 6174 652b 275f 272b 7374 7228 7829  _date+'_'+str(x)
-0001e080: 2066 6f72 2078 2069 6e20 7261 6e67 6528   for x in range(
-0001e090: 636f 6c73 697a 6529 5d0a 2020 2020 2020  colsize)].      
-0001e0a0: 2020 6461 7465 5f61 6464 203d 2064 6174    date_add = dat
-0001e0b0: 6573 697a 655f 6469 6374 5b65 6163 685f  esize_dict[each_
-0001e0c0: 6461 7465 5d0a 2020 2020 2020 2020 636f  date].        co
-0001e0d0: 6c73 5f64 6174 6520 2b3d 2064 6174 655f  ls_date += date_
-0001e0e0: 6164 640a 2020 2020 2323 2320 5265 6d65  add.    ### Reme
-0001e0f0: 6d62 6572 2064 6f6e 2774 2063 6f6d 6269  mber don't combi
-0001e100: 6e65 2074 6865 206e 6578 7420 3220 6c69  ne the next 2 li
-0001e110: 6e65 7320 696e 746f 206f 6e65 2e20 5468  nes into one. Th
-0001e120: 6174 2077 696c 6c20 6265 2061 2064 6973  at will be a dis
-0001e130: 6173 7465 722e 0a20 2020 2023 2323 2050  aster..    ### P
-0001e140: 616e 6461 7320 696e 6665 7273 2064 6174  andas infers dat
-0001e150: 6120 7479 7065 7320 6175 746d 6174 6963  a types autmatic
-0001e160: 616c 6c79 2061 6e64 2074 6865 7920 616c  ally and they al
-0001e170: 7761 7973 2061 7265 2066 6c6f 6174 3634  ways are float64
-0001e180: 2e20 536f 0a20 2020 2023 2323 2020 746f  . So.    ###  to
-0001e190: 2061 766f 6964 2074 6861 7420 4920 6861   avoid that I ha
-0001e1a0: 7665 2073 706c 6974 2074 6865 2064 6174  ve split the dat
-0001e1b0: 6120 696e 746f 2074 776f 206f 7220 7468  a into two or th
-0001e1c0: 7265 6520 7479 7065 7320 0a20 2020 2063  ree types .    c
-0001e1d0: 6f6c 735f 6e61 6d65 7320 3d20 636f 6c73  ols_names = cols
-0001e1e0: 5f63 6174 2b63 6f6c 735f 6469 7363 7265  _cat+cols_discre
-0001e1f0: 7465 2b69 6e74 7661 7273 2b63 6f6c 735f  te+intvars+cols_
-0001e200: 6461 7465 0a20 2020 206e 756d 5f76 6172  date.    num_var
-0001e210: 7320 3d20 636f 6c73 5f6e 6c70 2b66 6c6f  s = cols_nlp+flo
-0001e220: 6174 7661 7273 0a20 2020 206e 756d 5f6c  atvars.    num_l
-0001e230: 656e 203d 206c 656e 286e 756d 5f76 6172  en = len(num_var
-0001e240: 7329 0a20 2020 200a 2020 2020 2323 2320  s).    .    ### 
-0001e250: 5874 2069 7320 6120 5370 6172 7365 206d  Xt is a Sparse m
-0001e260: 6174 7269 7820 6172 7261 792c 2077 6520  atrix array, we 
-0001e270: 6e65 6564 2074 6f20 636f 6e76 6572 7420  need to convert 
-0001e280: 6974 2020 746f 2064 656e 7365 2061 7272  it  to dense arr
-0001e290: 6179 2023 230a 2020 2020 6966 2073 6369  ay ##.    if sci
-0001e2a0: 7079 2e73 7061 7273 652e 6973 7370 6172  py.sparse.isspar
-0001e2b0: 7365 2858 7429 3a0a 2020 2020 2020 2020  se(Xt):.        
-0001e2c0: 5874 203d 2058 742e 746f 6172 7261 7928  Xt = Xt.toarray(
-0001e2d0: 290a 2020 2020 2323 2320 5874 2069 7320  ).    ### Xt is 
-0001e2e0: 616c 7265 6164 7920 6120 6465 6e73 6520  already a dense 
-0001e2f0: 6172 7261 792c 206e 6f20 6e65 6564 2074  array, no need t
-0001e300: 6f20 636f 6e76 6572 7420 6974 2023 230a  o convert it ##.
-0001e310: 2020 2020 2323 2320 5265 6d65 6d62 6572      ### Remember
-0001e320: 2064 6f6e 2774 2063 6f6d 6269 6e65 2074   don't combine t
-0001e330: 6865 206e 6578 7420 3220 6c69 6e65 7320  he next 2 lines 
-0001e340: 696e 746f 206f 6e65 2e20 5468 6174 2077  into one. That w
-0001e350: 696c 6c20 6265 2061 2064 6973 6173 7465  ill be a disaste
-0001e360: 722e 0a20 2020 2023 2323 2050 616e 6461  r..    ### Panda
-0001e370: 7320 696e 6665 7273 2064 6174 6120 7479  s infers data ty
-0001e380: 7065 7320 6175 746d 6174 6963 616c 6c79  pes autmatically
-0001e390: 2061 6e64 2074 6865 7920 616c 7761 7973   and they always
-0001e3a0: 2061 7265 2066 6c6f 6174 3634 2e20 536f   are float64. So
-0001e3b0: 0a20 2020 2023 2323 2020 746f 2061 766f  .    ###  to avo
-0001e3c0: 6964 2074 6861 7420 4920 6861 7665 2073  id that I have s
-0001e3d0: 706c 6974 2074 6865 2064 6174 6120 696e  plit the data in
-0001e3e0: 746f 2074 776f 206f 7220 7468 7265 6520  to two or three 
-0001e3f0: 7479 7065 7320 0a20 2020 2069 6620 6e75  types .    if nu
-0001e400: 6d5f 6c65 6e20 3d3d 2030 3a0a 2020 2020  m_len == 0:.    
-0001e410: 2020 2020 5869 6e74 203d 2070 642e 4461      Xint = pd.Da
-0001e420: 7461 4672 616d 6528 5874 5b3a 2c3a 5d2c  taFrame(Xt[:,:],
-0001e430: 2063 6f6c 756d 6e73 203d 2063 6f6c 735f   columns = cols_
-0001e440: 6e61 6d65 732c 2064 7479 7065 3d6e 702e  names, dtype=np.
-0001e450: 696e 7431 3629 0a20 2020 2020 2020 2072  int16).        r
-0001e460: 6574 7572 6e20 5869 6e74 0a20 2020 2065  eturn Xint.    e
-0001e470: 6c73 653a 0a20 2020 2020 2020 2058 696e  lse:.        Xin
-0001e480: 7420 3d20 7064 2e44 6174 6146 7261 6d65  t = pd.DataFrame
-0001e490: 2858 745b 3a2c 3a2d 6e75 6d5f 6c65 6e5d  (Xt[:,:-num_len]
-0001e4a0: 2c20 636f 6c75 6d6e 7320 3d20 636f 6c73  , columns = cols
-0001e4b0: 5f6e 616d 6573 2c20 6474 7970 653d 6e70  _names, dtype=np
-0001e4c0: 2e69 6e74 3136 290a 2020 2020 2020 2020  .int16).        
-0001e4d0: 586e 756d 203d 2070 642e 4461 7461 4672  Xnum = pd.DataFr
-0001e4e0: 616d 6528 5874 5b3a 2c2d 6e75 6d5f 6c65  ame(Xt[:,-num_le
-0001e4f0: 6e3a 5d2c 2063 6f6c 756d 6e73 203d 206e  n:], columns = n
-0001e500: 756d 5f76 6172 732c 2064 7479 7065 3d6e  um_vars, dtype=n
-0001e510: 702e 666c 6f61 7433 3229 0a20 2020 2020  p.float32).     
-0001e520: 2020 2023 2323 2320 7468 6973 2069 7320     #### this is 
-0001e530: 7768 6572 6520 7765 2070 7574 2061 6c6c  where we put all
-0001e540: 2074 6865 2063 6f6c 756d 6e20 6e61 6d65   the column name
-0001e550: 7320 746f 6765 7468 6572 2023 2323 2323  s together #####
-0001e560: 2323 0a20 2020 2020 2020 2064 6620 3d20  ##.        df = 
-0001e570: 7064 2e63 6f6e 6361 7428 5b58 696e 742c  pd.concat([Xint,
-0001e580: 2058 6e75 6d5d 2c20 6178 6973 3d31 290a   Xnum], axis=1).
-0001e590: 2020 2020 2020 2020 7265 7475 726e 2064          return d
-0001e5a0: 660a 2323 2323 2323 2323 2323 2323 2323  f.##############
-0001e5b0: 2323 2323 2323 2323 2323 2323 2323 2323  ################
-0001e5c0: 2323 2323 2323 2323 2323 2323 2323 2323  ################
-0001e5d0: 2323 2323 2323 2323 2323 2323 2323 2323  ################
-0001e5e0: 2323 2323 2323 2323 2323 2323 2323 2323  ################
-0001e5f0: 2323 2323 2323 2323 0a64 6566 2066 696e  ########.def fin
-0001e600: 645f 7265 6d6f 7665 5f64 7570 6c69 6361  d_remove_duplica
-0001e610: 7465 7328 6c69 7374 5f6f 665f 7661 6c75  tes(list_of_valu
-0001e620: 6573 293a 0a20 2020 2022 2222 0a20 2020  es):.    """.   
-0001e630: 2023 2052 656d 6f76 6573 2064 7570 6c69   # Removes dupli
-0001e640: 6361 7465 7320 6672 6f6d 2061 206c 6973  cates from a lis
-0001e650: 7420 746f 2072 6574 7572 6e20 756e 6971  t to return uniq
-0001e660: 7565 2076 616c 7565 7320 2d20 5553 4544  ue values - USED
-0001e670: 204f 4e4c 5920 4f4e 4345 0a20 2020 2022   ONLY ONCE.    "
-0001e680: 2222 0a20 2020 206f 7574 7075 7420 3d20  "".    output = 
-0001e690: 5b5d 0a20 2020 2073 6565 6e20 3d20 7365  [].    seen = se
-0001e6a0: 7428 290a 2020 2020 666f 7220 7661 6c75  t().    for valu
-0001e6b0: 6520 696e 206c 6973 745f 6f66 5f76 616c  e in list_of_val
-0001e6c0: 7565 733a 0a20 2020 2020 2020 2069 6620  ues:.        if 
-0001e6d0: 7661 6c75 6520 6e6f 7420 696e 2073 6565  value not in see
-0001e6e0: 6e3a 0a20 2020 2020 2020 2020 2020 206f  n:.            o
-0001e6f0: 7574 7075 742e 6170 7065 6e64 2876 616c  utput.append(val
-0001e700: 7565 290a 2020 2020 2020 2020 2020 2020  ue).            
-0001e710: 7365 656e 2e61 6464 2876 616c 7565 290a  seen.add(value).
-0001e720: 2020 2020 7265 7475 726e 206f 7574 7075      return outpu
-0001e730: 740a 0a64 6566 2063 6f6e 7665 7274 5f63  t..def convert_c
-0001e740: 655f 746f 5f70 6970 6528 5874 293a 2020  e_to_pipe(Xt):  
-0001e750: 2020 0a20 2020 2023 2323 2054 6869 7320    .    ### This 
-0001e760: 636f 6e76 6572 7473 2061 2073 6572 6965  converts a serie
-0001e770: 7320 746f 2061 2064 6174 6166 7261 6d65  s to a dataframe
-0001e780: 2074 6f20 6d61 6b65 2063 6174 6567 6f72   to make categor
-0001e790: 7920 656e 636f 6465 7273 2077 6f72 6b20  y encoders work 
-0001e7a0: 696e 2073 6b6c 6561 726e 2070 6970 656c  in sklearn pipel
-0001e7b0: 696e 6573 2023 2323 0a20 2020 2069 6620  ines ###.    if 
-0001e7c0: 7374 7228 5874 2e64 7479 7065 2920 3d3d  str(Xt.dtype) ==
-0001e7d0: 2027 6361 7465 676f 7279 273a 0a20 2020   'category':.   
-0001e7e0: 2020 2020 2058 7478 203d 2058 742e 6361       Xtx = Xt.ca
-0001e7f0: 742e 7265 6e61 6d65 5f63 6174 6567 6f72  t.rename_categor
-0001e800: 6965 7328 7374 7229 2e76 616c 7565 732e  ies(str).values.
-0001e810: 746f 6c69 7374 2829 0a20 2020 2020 2020  tolist().       
-0001e820: 2072 6574 7572 6e20 7064 2e44 6174 6146   return pd.DataF
-0001e830: 7261 6d65 2858 7478 2c20 636f 6c75 6d6e  rame(Xtx, column
-0001e840: 733d 5b58 742e 6e61 6d65 5d29 0a20 2020  s=[Xt.name]).   
-0001e850: 2065 6c73 653a 0a20 2020 2020 2020 2058   else:.        X
-0001e860: 7478 203d 2058 742e 6669 6c6c 6e61 2827  tx = Xt.fillna('
-0001e870: 6d69 7373 696e 6727 290a 2020 2020 2020  missing').      
-0001e880: 2020 7265 7475 726e 2070 642e 4461 7461    return pd.Data
-0001e890: 4672 616d 6528 5874 7829 0a23 2323 2323  Frame(Xtx).#####
-0001e8a0: 2323 2323 2323 2323 2323 2323 2323 2323  ################
-0001e8b0: 2323 2323 2323 2323 2323 2323 2323 2323  ################
-0001e8c0: 2323 2323 2323 2323 2323 2323 2323 2323  ################
-0001e8d0: 2323 2323 2323 2323 2323 2323 2323 2323  ################
-0001e8e0: 2323 2323 2323 2323 2323 2323 2323 2323  ################
-0001e8f0: 0a23 2323 2320 5265 6772 6573 7369 6f6e  .#### Regression
-0001e900: 206f 7220 436c 6173 7369 6669 6361 7469   or Classificati
-0001e910: 6f6e 2074 7970 6520 7072 6f62 6c65 6d0a  on type problem.
-0001e920: 6465 6620 616e 616c 797a 655f 7072 6f62  def analyze_prob
-0001e930: 6c65 6d5f 7479 7065 2879 5f74 7261 696e  lem_type(y_train
-0001e940: 2c20 7461 7267 6574 2c20 7665 7262 6f73  , target, verbos
-0001e950: 653d 3029 203a 2020 0a20 2020 2079 5f74  e=0) :  .    y_t
-0001e960: 7261 696e 203d 2063 6f70 792e 6465 6570  rain = copy.deep
-0001e970: 636f 7079 2879 5f74 7261 696e 290a 2020  copy(y_train).  
-0001e980: 2020 6361 745f 6c69 6d69 7420 3d20 3330    cat_limit = 30
-0001e990: 2023 2323 2074 6869 7320 6465 7465 726d   ### this determ
-0001e9a0: 696e 6573 2074 6865 206e 756d 6265 7220  ines the number 
-0001e9b0: 6f66 2063 6174 6567 6f72 6965 7320 746f  of categories to
-0001e9c0: 206e 616d 6520 696e 7465 6765 7273 2061   name integers a
-0001e9d0: 7320 636c 6173 7369 6669 6361 7469 6f6e  s classification
-0001e9e0: 2023 230a 2020 2020 666c 6f61 745f 6c69   ##.    float_li
-0001e9f0: 6d69 7420 3d20 3135 2023 2323 2074 6869  mit = 15 ### thi
-0001ea00: 7320 6c69 6d69 7473 2074 6865 206e 756d  s limits the num
-0001ea10: 6265 7220 6f66 2066 6c6f 6174 2076 6172  ber of float var
-0001ea20: 6961 626c 6520 6361 7465 676f 7269 6573  iable categories
-0001ea30: 2066 6f72 2069 7420 746f 2062 6563 6f6d   for it to becom
-0001ea40: 6520 6361 7420 7661 720a 2020 2020 6966  e cat var.    if
-0001ea50: 2069 7369 6e73 7461 6e63 6528 7461 7267   isinstance(targ
-0001ea60: 6574 2c20 7374 7229 3a0a 2020 2020 2020  et, str):.      
-0001ea70: 2020 6d75 6c74 695f 6c61 6265 6c20 3d20    multi_label = 
-0001ea80: 4661 6c73 650a 2020 2020 2020 2020 7374  False.        st
-0001ea90: 7269 6e67 5f74 6172 6765 7420 3d20 5472  ring_target = Tr
-0001eaa0: 7565 0a20 2020 2065 6c73 653a 0a20 2020  ue.    else:.   
-0001eab0: 2020 2020 2069 6620 6c65 6e28 7461 7267       if len(targ
-0001eac0: 6574 2920 3d3d 2031 3a0a 2020 2020 2020  et) == 1:.      
-0001ead0: 2020 2020 2020 6d75 6c74 695f 6c61 6265        multi_labe
-0001eae0: 6c20 3d20 4661 6c73 650a 2020 2020 2020  l = False.      
-0001eaf0: 2020 2020 2020 7374 7269 6e67 5f74 6172        string_tar
-0001eb00: 6765 7420 3d20 4661 6c73 650a 2020 2020  get = False.    
-0001eb10: 2020 2020 656c 7365 3a0a 2020 2020 2020      else:.      
-0001eb20: 2020 2020 2020 6d75 6c74 695f 6c61 6265        multi_labe
-0001eb30: 6c20 3d20 5472 7565 0a20 2020 2020 2020  l = True.       
-0001eb40: 2020 2020 2073 7472 696e 675f 7461 7267       string_targ
-0001eb50: 6574 203d 2046 616c 7365 0a20 2020 2023  et = False.    #
-0001eb60: 2323 2320 2054 6869 7320 6973 2077 6865  ###  This is whe
-0001eb70: 7265 2079 6f75 2064 6574 6563 7420 7768  re you detect wh
-0001eb80: 6174 206b 696e 6420 6f66 2070 726f 626c  at kind of probl
-0001eb90: 656d 2069 7420 6973 2023 2323 2323 2323  em it is #######
-0001eba0: 2323 2323 2323 2323 2323 0a20 2020 2069  ##########.    i
-0001ebb0: 6620 7374 7269 6e67 5f74 6172 6765 743a  f string_target:
-0001ebc0: 0a20 2020 2020 2020 2023 2320 4966 2074  .        ## If t
-0001ebd0: 6172 6765 7420 6973 2061 2073 7472 696e  arget is a strin
-0001ebe0: 6720 7468 656e 2077 6520 7368 6f75 6c64  g then we should
-0001ebf0: 2074 6573 7420 666f 7220 6474 7970 6573   test for dtypes
-0001ec00: 2074 6869 7320 7761 7920 2323 2323 230a   this way #####.
-0001ec10: 2020 2020 2020 2020 6966 2020 795f 7472          if  y_tr
-0001ec20: 6169 6e2e 6474 7970 6520 696e 205b 2769  ain.dtype in ['i
-0001ec30: 6e74 3634 272c 2027 696e 7433 3227 2c27  nt64', 'int32','
-0001ec40: 696e 7431 3627 5d3a 0a20 2020 2020 2020  int16']:.       
-0001ec50: 2020 2020 2069 6620 6c65 6e28 6e70 2e75       if len(np.u
-0001ec60: 6e69 7175 6528 795f 7472 6169 6e29 2920  nique(y_train)) 
-0001ec70: 3c3d 2032 3a0a 2020 2020 2020 2020 2020  <= 2:.          
-0001ec80: 2020 2020 2020 6d6f 6465 6c5f 636c 6173        model_clas
-0001ec90: 7320 3d20 2742 696e 6172 795f 436c 6173  s = 'Binary_Clas
-0001eca0: 7369 6669 6361 7469 6f6e 270a 2020 2020  sification'.    
-0001ecb0: 2020 2020 2020 2020 656c 6966 206c 656e          elif len
-0001ecc0: 2879 5f74 7261 696e 2e75 6e69 7175 6528  (y_train.unique(
-0001ecd0: 2929 203e 2032 2061 6e64 206c 656e 2879  )) > 2 and len(y
-0001ece0: 5f74 7261 696e 2e75 6e69 7175 6528 2929  _train.unique())
-0001ecf0: 203c 3d20 6361 745f 6c69 6d69 743a 0a20   <= cat_limit:. 
-0001ed00: 2020 2020 2020 2020 2020 2020 2020 206d                 m
-0001ed10: 6f64 656c 5f63 6c61 7373 203d 2027 4d75  odel_class = 'Mu
-0001ed20: 6c74 695f 436c 6173 7369 6669 6361 7469  lti_Classificati
-0001ed30: 6f6e 270a 2020 2020 2020 2020 2020 2020  on'.            
-0001ed40: 656c 7365 3a0a 2020 2020 2020 2020 2020  else:.          
-0001ed50: 2020 2020 2020 6d6f 6465 6c5f 636c 6173        model_clas
-0001ed60: 7320 3d20 2752 6567 7265 7373 696f 6e27  s = 'Regression'
-0001ed70: 0a20 2020 2020 2020 2065 6c69 6620 2079  .        elif  y
-0001ed80: 5f74 7261 696e 2e64 7479 7065 2069 6e20  _train.dtype in 
-0001ed90: 5b27 666c 6f61 7431 3627 2c27 666c 6f61  ['float16','floa
-0001eda0: 7433 3227 2c27 666c 6f61 7436 3427 5d3a  t32','float64']:
-0001edb0: 0a20 2020 2020 2020 2020 2020 2069 6620  .            if 
-0001edc0: 6c65 6e28 795f 7472 6169 6e2e 756e 6971  len(y_train.uniq
-0001edd0: 7565 2829 2920 3c3d 2032 3a0a 2020 2020  ue()) <= 2:.    
-0001ede0: 2020 2020 2020 2020 2020 2020 6d6f 6465              mode
-0001edf0: 6c5f 636c 6173 7320 3d20 2742 696e 6172  l_class = 'Binar
-0001ee00: 795f 436c 6173 7369 6669 6361 7469 6f6e  y_Classification
-0001ee10: 270a 2020 2020 2020 2020 2020 2020 656c  '.            el
-0001ee20: 6966 206c 656e 2879 5f74 7261 696e 2e75  if len(y_train.u
-0001ee30: 6e69 7175 6528 2929 203e 2032 2061 6e64  nique()) > 2 and
-0001ee40: 206c 656e 2879 5f74 7261 696e 2e75 6e69   len(y_train.uni
-0001ee50: 7175 6528 2929 203c 3d20 666c 6f61 745f  que()) <= float_
-0001ee60: 6c69 6d69 743a 0a20 2020 2020 2020 2020  limit:.         
-0001ee70: 2020 2020 2020 206d 6f64 656c 5f63 6c61         model_cla
-0001ee80: 7373 203d 2027 4d75 6c74 695f 436c 6173  ss = 'Multi_Clas
-0001ee90: 7369 6669 6361 7469 6f6e 270a 2020 2020  sification'.    
-0001eea0: 2020 2020 2020 2020 656c 7365 3a0a 2020          else:.  
-0001eeb0: 2020 2020 2020 2020 2020 2020 2020 6d6f                mo
-0001eec0: 6465 6c5f 636c 6173 7320 3d20 2752 6567  del_class = 'Reg
-0001eed0: 7265 7373 696f 6e27 0a20 2020 2020 2020  ression'.       
-0001eee0: 2065 6c73 653a 0a20 2020 2020 2020 2020   else:.         
-0001eef0: 2020 2069 6620 6c65 6e28 795f 7472 6169     if len(y_trai
-0001ef00: 6e2e 756e 6971 7565 2829 2920 3c3d 2032  n.unique()) <= 2
-0001ef10: 3a0a 2020 2020 2020 2020 2020 2020 2020  :.              
-0001ef20: 2020 6d6f 6465 6c5f 636c 6173 7320 3d20    model_class = 
-0001ef30: 2742 696e 6172 795f 436c 6173 7369 6669  'Binary_Classifi
-0001ef40: 6361 7469 6f6e 270a 2020 2020 2020 2020  cation'.        
-0001ef50: 2020 2020 656c 7365 3a0a 2020 2020 2020      else:.      
-0001ef60: 2020 2020 2020 2020 2020 6d6f 6465 6c5f            model_
-0001ef70: 636c 6173 7320 3d20 274d 756c 7469 5f43  class = 'Multi_C
-0001ef80: 6c61 7373 6966 6963 6174 696f 6e27 0a20  lassification'. 
-0001ef90: 2020 2065 6c73 653a 0a20 2020 2020 2020     else:.       
-0001efa0: 2066 6f72 2069 2069 6e20 7261 6e67 6528   for i in range(
-0001efb0: 795f 7472 6169 6e2e 7368 6170 655b 315d  y_train.shape[1]
-0001efc0: 293a 0a20 2020 2020 2020 2020 2020 2023  ):.            #
-0001efd0: 2323 2069 6620 7461 7267 6574 2069 7320  ## if target is 
-0001efe0: 6120 6c69 7374 2c20 7468 656e 2077 6520  a list, then we 
-0001eff0: 7368 6f75 6c64 2074 6573 7420 6474 7970  should test dtyp
-0001f000: 6573 2061 2064 6966 6665 7265 6e74 2077  es a different w
-0001f010: 6179 2023 2323 0a20 2020 2020 2020 2020  ay ###.         
-0001f020: 2020 2069 6620 795f 7472 6169 6e2e 6474     if y_train.dt
-0001f030: 7970 6573 2e76 616c 7565 732e 616c 6c28  ypes.values.all(
-0001f040: 2920 696e 205b 2769 6e74 3634 272c 2027  ) in ['int64', '
-0001f050: 696e 7433 3227 2c27 696e 7431 3627 5d3a  int32','int16']:
-0001f060: 0a20 2020 2020 2020 2020 2020 2020 2020  .               
-0001f070: 2069 6620 6c65 6e28 6e70 2e75 6e69 7175   if len(np.uniqu
-0001f080: 6528 795f 7472 6169 6e2e 696c 6f63 5b3a  e(y_train.iloc[:
-0001f090: 2c30 5d29 2920 3c3d 2032 3a0a 2020 2020  ,0])) <= 2:.    
-0001f0a0: 2020 2020 2020 2020 2020 2020 2020 2020                  
-0001f0b0: 6d6f 6465 6c5f 636c 6173 7320 3d20 2742  model_class = 'B
-0001f0c0: 696e 6172 795f 436c 6173 7369 6669 6361  inary_Classifica
-0001f0d0: 7469 6f6e 270a 2020 2020 2020 2020 2020  tion'.          
-0001f0e0: 2020 2020 2020 656c 6966 206c 656e 286e        elif len(n
-0001f0f0: 702e 756e 6971 7565 2879 5f74 7261 696e  p.unique(y_train
-0001f100: 2e69 6c6f 635b 3a2c 305d 2929 203e 2032  .iloc[:,0])) > 2
-0001f110: 2061 6e64 206c 656e 286e 702e 756e 6971   and len(np.uniq
-0001f120: 7565 2879 5f74 7261 696e 2e69 6c6f 635b  ue(y_train.iloc[
-0001f130: 3a2c 305d 2929 203c 3d20 6361 745f 6c69  :,0])) <= cat_li
-0001f140: 6d69 743a 0a20 2020 2020 2020 2020 2020  mit:.           
-0001f150: 2020 2020 2020 2020 206d 6f64 656c 5f63           model_c
-0001f160: 6c61 7373 203d 2027 4d75 6c74 695f 436c  lass = 'Multi_Cl
-0001f170: 6173 7369 6669 6361 7469 6f6e 270a 2020  assification'.  
-0001f180: 2020 2020 2020 2020 2020 2020 2020 656c                el
-0001f190: 7365 3a0a 2020 2020 2020 2020 2020 2020  se:.            
-0001f1a0: 2020 2020 2020 2020 6d6f 6465 6c5f 636c          model_cl
-0001f1b0: 6173 7320 3d20 2752 6567 7265 7373 696f  ass = 'Regressio
-0001f1c0: 6e27 0a20 2020 2020 2020 2020 2020 2065  n'.            e
-0001f1d0: 6c69 6620 2079 5f74 7261 696e 2e64 7479  lif  y_train.dty
-0001f1e0: 7065 732e 7661 6c75 6573 2e61 6c6c 2829  pes.values.all()
-0001f1f0: 2069 6e20 5b27 666c 6f61 7431 3627 2c27   in ['float16','
-0001f200: 666c 6f61 7433 3227 2c27 666c 6f61 7436  float32','float6
-0001f210: 3427 5d3a 0a20 2020 2020 2020 2020 2020  4']:.           
-0001f220: 2020 2020 2069 6620 6c65 6e28 6e70 2e75       if len(np.u
-0001f230: 6e69 7175 6528 795f 7472 6169 6e2e 696c  nique(y_train.il
-0001f240: 6f63 5b3a 2c30 5d29 2920 3c3d 2032 3a0a  oc[:,0])) <= 2:.
-0001f250: 2020 2020 2020 2020 2020 2020 2020 2020                  
-0001f260: 2020 2020 6d6f 6465 6c5f 636c 6173 7320      model_class 
-0001f270: 3d20 2742 696e 6172 795f 436c 6173 7369  = 'Binary_Classi
-0001f280: 6669 6361 7469 6f6e 270a 2020 2020 2020  fication'.      
-0001f290: 2020 2020 2020 2020 2020 656c 6966 206c            elif l
-0001f2a0: 656e 286e 702e 756e 6971 7565 2879 5f74  en(np.unique(y_t
-0001f2b0: 7261 696e 2e69 6c6f 635b 3a2c 305d 2929  rain.iloc[:,0]))
-0001f2c0: 203e 2032 2061 6e64 206c 656e 286e 702e   > 2 and len(np.
-0001f2d0: 756e 6971 7565 2879 5f74 7261 696e 2e69  unique(y_train.i
-0001f2e0: 6c6f 635b 3a2c 305d 2929 203c 3d20 666c  loc[:,0])) <= fl
-0001f2f0: 6f61 745f 6c69 6d69 743a 0a20 2020 2020  oat_limit:.     
-0001f300: 2020 2020 2020 2020 2020 2020 2020 206d                 m
-0001f310: 6f64 656c 5f63 6c61 7373 203d 2027 4d75  odel_class = 'Mu
-0001f320: 6c74 695f 436c 6173 7369 6669 6361 7469  lti_Classificati
-0001f330: 6f6e 270a 2020 2020 2020 2020 2020 2020  on'.            
-0001f340: 2020 2020 656c 7365 3a0a 2020 2020 2020      else:.      
-0001f350: 2020 2020 2020 2020 2020 2020 2020 6d6f                mo
-0001f360: 6465 6c5f 636c 6173 7320 3d20 2752 6567  del_class = 'Reg
-0001f370: 7265 7373 696f 6e27 0a20 2020 2020 2020  ression'.       
-0001f380: 2020 2020 2065 6c73 653a 0a20 2020 2020       else:.     
-0001f390: 2020 2020 2020 2020 2020 2069 6620 6c65             if le
-0001f3a0: 6e28 6e70 2e75 6e69 7175 6528 795f 7472  n(np.unique(y_tr
-0001f3b0: 6169 6e2e 696c 6f63 5b3a 2c30 5d29 2920  ain.iloc[:,0])) 
-0001f3c0: 3c3d 2032 3a0a 2020 2020 2020 2020 2020  <= 2:.          
-0001f3d0: 2020 2020 2020 2020 2020 6d6f 6465 6c5f            model_
-0001f3e0: 636c 6173 7320 3d20 2742 696e 6172 795f  class = 'Binary_
-0001f3f0: 436c 6173 7369 6669 6361 7469 6f6e 270a  Classification'.
-0001f400: 2020 2020 2020 2020 2020 2020 2020 2020                  
-0001f410: 656c 7365 3a0a 2020 2020 2020 2020 2020  else:.          
-0001f420: 2020 2020 2020 2020 2020 6d6f 6465 6c5f            model_
-0001f430: 636c 6173 7320 3d20 274d 756c 7469 5f43  class = 'Multi_C
-0001f440: 6c61 7373 6966 6963 6174 696f 6e27 0a20  lassification'. 
-0001f450: 2020 2023 2323 2323 2323 2323 2323 2070     ########### p
-0001f460: 7269 6e74 2074 6869 7320 666f 7220 7468  rint this for th
-0001f470: 6520 7374 6172 7420 6f66 206e 6578 7420  e start of next 
-0001f480: 7374 6570 2023 2323 2323 2323 2323 2323  step ###########
-0001f490: 0a20 2020 2069 6620 7665 7262 6f73 653a  .    if verbose:
-0001f4a0: 0a20 2020 2020 2020 2069 6620 6d75 6c74  .        if mult
-0001f4b0: 695f 6c61 6265 6c3a 0a20 2020 2020 2020  i_label:.       
-0001f4c0: 2020 2020 2070 7269 6e74 2827 2727 2323       print('''##
-0001f4d0: 2323 2025 7320 2573 2070 726f 626c 656d  ## %s %s problem
-0001f4e0: 2023 2323 2327 2727 2025 2827 4d75 6c74   ####''' %('Mult
-0001f4f0: 695f 4c61 6265 6c27 2c20 6d6f 6465 6c5f  i_Label', model_
-0001f500: 636c 6173 7329 290a 2020 2020 2020 2020  class)).        
-0001f510: 656c 7365 3a0a 2020 2020 2020 2020 2020  else:.          
-0001f520: 2020 7072 696e 7428 2727 2723 2323 2320    print('''#### 
-0001f530: 2573 2025 7320 7072 6f62 6c65 6d20 2323  %s %s problem ##
-0001f540: 2323 2727 2720 2528 2753 696e 676c 655f  ##''' %('Single_
-0001f550: 4c61 6265 6c27 2c20 6d6f 6465 6c5f 636c  Label', model_cl
-0001f560: 6173 7329 290a 2020 2020 7265 7475 726e  ass)).    return
-0001f570: 206d 6f64 656c 5f63 6c61 7373 2c20 6d75   model_class, mu
-0001f580: 6c74 695f 6c61 6265 6c0a 2323 2323 2323  lti_label.######
-0001f590: 2323 2323 2323 2323 2323 2323 2323 2323  ################
-0001f5a0: 2323 2323 2323 2323 2323 2323 2323 2323  ################
-0001f5b0: 2323 2323 2323 2323 2323 2323 2323 2323  ################
-0001f5c0: 2323 2323 2323 2323 2323 2323 2323 2323  ################
-0001f5d0: 2323 2323 2323 2323 2323 2323 2323 2323  ################
-0001f5e0: 2323 2323 2323 2323 2323 2323 2323 0a69  ##############.i
-0001f5f0: 6d70 6f72 7420 636f 7079 0a69 6d70 6f72  mport copy.impor
-0001f600: 7420 7469 6d65 0a66 726f 6d20 6461 7465  t time.from date
-0001f610: 7574 696c 2e72 656c 6174 6976 6564 656c  util.relativedel
-0001f620: 7461 2069 6d70 6f72 7420 7265 6c61 7469  ta import relati
-0001f630: 7665 6465 6c74 610a 6672 6f6d 2064 6174  vedelta.from dat
-0001f640: 6574 696d 6520 696d 706f 7274 2064 6174  etime import dat
-0001f650: 650a 6465 6620 5f63 7265 6174 655f 7473  e.def _create_ts
-0001f660: 5f66 6561 7475 7265 7328 6466 2c20 7665  _features(df, ve
-0001f670: 7262 6f73 653d 3029 3a0a 2020 2020 2222  rbose=0):.    ""
-0001f680: 220a 2020 2020 5468 6973 2074 616b 6573  ".    This takes
-0001f690: 2069 6e20 696e 7075 7420 6120 6461 7461   in input a data
-0001f6a0: 6672 616d 6520 616e 6420 6120 6461 7465  frame and a date
-0001f6b0: 2076 6172 6961 626c 652e 0a20 2020 2049   variable..    I
-0001f6c0: 7420 7468 656e 2063 7265 6174 6573 2074  t then creates t
-0001f6d0: 696d 6520 7365 7269 6573 2066 6561 7475  ime series featu
-0001f6e0: 7265 7320 7573 696e 6720 7468 6520 7061  res using the pa
-0001f6f0: 6e64 6173 202e 6474 2e77 6565 6b64 6179  ndas .dt.weekday
-0001f700: 206b 696e 6420 6f66 2073 796e 7461 782e   kind of syntax.
-0001f710: 0a20 2020 2049 7420 616c 736f 2072 6574  .    It also ret
-0001f720: 7572 6e73 2074 6865 2064 6174 6120 6672  urns the data fr
-0001f730: 616d 6520 6f66 2061 6464 6564 2066 6561  ame of added fea
-0001f740: 7475 7265 7320 7769 7468 2065 6163 6820  tures with each 
-0001f750: 7661 7269 6162 6c65 2061 7320 616e 2069  variable as an i
-0001f760: 6e74 6567 6572 2076 6172 6961 626c 652e  nteger variable.
-0001f770: 0a20 2020 2022 2222 0a20 2020 2064 6620  .    """.    df 
-0001f780: 3d20 636f 7079 2e64 6565 7063 6f70 7928  = copy.deepcopy(
-0001f790: 6466 290a 2020 2020 7473 636f 6c20 3d20  df).    tscol = 
-0001f7a0: 6466 2e6e 616d 650a 2020 2020 6966 2069  df.name.    if i
-0001f7b0: 7369 6e73 7461 6e63 6528 6466 2c20 7064  sinstance(df, pd
-0001f7c0: 2e53 6572 6965 7329 3a0a 2020 2020 2020  .Series):.      
-0001f7d0: 2020 6466 203d 2070 642e 4461 7461 4672    df = pd.DataFr
-0001f7e0: 616d 6528 6466 290a 2020 2020 656c 6966  ame(df).    elif
-0001f7f0: 2069 7369 6e73 7461 6e63 6528 6466 2c20   isinstance(df, 
-0001f800: 6e70 2e6e 6461 7272 6179 293a 0a20 2020  np.ndarray):.   
-0001f810: 2020 2020 2070 7269 6e74 2827 2020 2020       print('    
-0001f820: 696e 7075 7420 6361 6e6e 6f74 2062 6520  input cannot be 
-0001f830: 6120 6e75 6d70 7920 6172 7261 7920 666f  a numpy array fo
-0001f840: 7220 6372 6561 7469 6e67 2064 6174 652d  r creating date-
-0001f850: 7469 6d65 2066 6561 7475 7265 732e 2052  time features. R
-0001f860: 6574 7572 6e69 6e67 2729 0a20 2020 2020  eturning').     
-0001f870: 2020 2072 6574 7572 6e20 6466 0a20 2020     return df.   
-0001f880: 2064 745f 6164 6473 203d 205b 5d0a 2020   dt_adds = [].  
-0001f890: 2020 2323 2323 2320 5468 6973 2069 7320    ##### This is 
-0001f8a0: 7768 6572 6520 7765 2061 6464 2066 6561  where we add fea
-0001f8b0: 7475 7265 7320 6f6e 6520 6279 206f 6e65  tures one by one
-0001f8c0: 2023 2323 2323 2323 2323 0a20 2020 2074   #########.    t
-0001f8d0: 7279 3a0a 2020 2020 2020 2020 6466 5b74  ry:.        df[t
-0001f8e0: 7363 6f6c 2b27 5f68 6f75 7227 5d20 3d20  scol+'_hour'] = 
-0001f8f0: 6466 5b74 7363 6f6c 5d2e 6474 2e68 6f75  df[tscol].dt.hou
-0001f900: 722e 6669 6c6c 6e61 2830 292e 6173 7479  r.fillna(0).asty
-0001f910: 7065 2869 6e74 290a 2020 2020 2020 2020  pe(int).        
-0001f920: 6466 5b74 7363 6f6c 2b27 5f6d 696e 7574  df[tscol+'_minut
-0001f930: 6527 5d20 3d20 6466 5b74 7363 6f6c 5d2e  e'] = df[tscol].
-0001f940: 6474 2e6d 696e 7574 652e 6669 6c6c 6e61  dt.minute.fillna
-0001f950: 2830 292e 6173 7479 7065 2869 6e74 290a  (0).astype(int).
-0001f960: 2020 2020 2020 2020 6474 5f61 6464 732e          dt_adds.
-0001f970: 6170 7065 6e64 2874 7363 6f6c 2b27 5f68  append(tscol+'_h
-0001f980: 6f75 7227 290a 2020 2020 2020 2020 6474  our').        dt
-0001f990: 5f61 6464 732e 6170 7065 6e64 2874 7363  _adds.append(tsc
-0001f9a0: 6f6c 2b27 5f6d 696e 7574 6527 290a 2020  ol+'_minute').  
-0001f9b0: 2020 6578 6365 7074 3a0a 2020 2020 2020    except:.      
-0001f9c0: 2020 7072 696e 7428 2720 2020 2045 7272    print('    Err
-0001f9d0: 6f72 2069 6e20 6372 6561 7469 6e67 2068  or in creating h
-0001f9e0: 6f75 722d 7365 636f 6e64 2064 6572 6976  our-second deriv
-0001f9f0: 6564 2066 6561 7475 7265 732e 2043 6f6e  ed features. Con
-0001fa00: 7469 6e75 696e 672e 2e2e 2729 0a20 2020  tinuing...').   
-0001fa10: 2074 7279 3a0a 2020 2020 2020 2020 6466   try:.        df
-0001fa20: 5b74 7363 6f6c 2b27 5f64 6179 6f66 7765  [tscol+'_dayofwe
-0001fa30: 656b 275d 203d 2064 665b 7473 636f 6c5d  ek'] = df[tscol]
-0001fa40: 2e64 742e 6461 796f 6677 6565 6b2e 6669  .dt.dayofweek.fi
-0001fa50: 6c6c 6e61 2830 292e 6173 7479 7065 2869  llna(0).astype(i
-0001fa60: 6e74 290a 2020 2020 2020 2020 6474 5f61  nt).        dt_a
-0001fa70: 6464 732e 6170 7065 6e64 2874 7363 6f6c  dds.append(tscol
-0001fa80: 2b27 5f64 6179 6f66 7765 656b 2729 0a20  +'_dayofweek'). 
-0001fa90: 2020 2020 2020 2069 6620 7473 636f 6c2b         if tscol+
-0001faa0: 275f 686f 7572 2720 696e 2064 745f 6164  '_hour' in dt_ad
-0001fab0: 6473 3a0a 2020 2020 2020 2020 2020 2020  ds:.            
-0001fac0: 4441 5953 203d 2064 6963 7428 7a69 7028  DAYS = dict(zip(
-0001fad0: 7261 6e67 6528 3729 2c5b 2753 756e 272c  range(7),['Sun',
-0001fae0: 2027 4d6f 6e27 2c20 2754 7565 272c 2027   'Mon', 'Tue', '
-0001faf0: 5765 6427 2c20 2754 6875 272c 2027 4672  Wed', 'Thu', 'Fr
-0001fb00: 6927 2c20 2753 6174 275d 2929 0a20 2020  i', 'Sat'])).   
-0001fb10: 2020 2020 2020 2020 2064 665b 7473 636f           df[tsco
-0001fb20: 6c2b 275f 6461 796f 6677 6565 6b27 5d20  l+'_dayofweek'] 
-0001fb30: 3d20 6466 5b74 7363 6f6c 2b27 5f64 6179  = df[tscol+'_day
-0001fb40: 6f66 7765 656b 275d 2e6d 6170 2844 4159  ofweek'].map(DAY
-0001fb50: 5329 0a20 2020 2020 2020 2020 2020 2064  S).            d
-0001fb60: 662e 6c6f 635b 3a2c 7473 636f 6c2b 275f  f.loc[:,tscol+'_
-0001fb70: 6461 796f 6677 6565 6b5f 686f 7572 5f63  dayofweek_hour_c
-0001fb80: 726f 7373 275d 203d 2064 665b 7473 636f  ross'] = df[tsco
-0001fb90: 6c2b 275f 6461 796f 6677 6565 6b27 5d20  l+'_dayofweek'] 
-0001fba0: 2b22 2022 2b20 6466 5b74 7363 6f6c 2b27  +" "+ df[tscol+'
-0001fbb0: 5f68 6f75 7227 5d2e 6173 7479 7065 2873  _hour'].astype(s
-0001fbc0: 7472 290a 2020 2020 2020 2020 2020 2020  tr).            
-0001fbd0: 6474 5f61 6464 732e 6170 7065 6e64 2874  dt_adds.append(t
-0001fbe0: 7363 6f6c 2b27 5f64 6179 6f66 7765 656b  scol+'_dayofweek
-0001fbf0: 5f68 6f75 725f 6372 6f73 7327 290a 2020  _hour_cross').  
-0001fc00: 2020 2020 2020 6466 5b74 7363 6f6c 2b27        df[tscol+'
-0001fc10: 5f71 7561 7274 6572 275d 203d 2064 665b  _quarter'] = df[
-0001fc20: 7473 636f 6c5d 2e64 742e 7175 6172 7465  tscol].dt.quarte
-0001fc30: 722e 6669 6c6c 6e61 2830 292e 6173 7479  r.fillna(0).asty
-0001fc40: 7065 2869 6e74 290a 2020 2020 2020 2020  pe(int).        
-0001fc50: 6474 5f61 6464 732e 6170 7065 6e64 2874  dt_adds.append(t
-0001fc60: 7363 6f6c 2b27 5f71 7561 7274 6572 2729  scol+'_quarter')
-0001fc70: 0a20 2020 2020 2020 2064 665b 7473 636f  .        df[tsco
-0001fc80: 6c2b 275f 6d6f 6e74 6827 5d20 3d20 6466  l+'_month'] = df
-0001fc90: 5b74 7363 6f6c 5d2e 6474 2e6d 6f6e 7468  [tscol].dt.month
-0001fca0: 2e66 696c 6c6e 6128 3029 2e61 7374 7970  .fillna(0).astyp
-0001fcb0: 6528 696e 7429 0a20 2020 2020 2020 204d  e(int).        M
-0001fcc0: 4f4e 5448 5320 3d20 6469 6374 287a 6970  ONTHS = dict(zip
-0001fcd0: 2872 616e 6765 2831 2c31 3329 2c5b 274a  (range(1,13),['J
-0001fce0: 616e 272c 2027 4665 6227 2c20 274d 6172  an', 'Feb', 'Mar
-0001fcf0: 272c 2027 4170 7227 2c20 274d 6179 272c  ', 'Apr', 'May',
-0001fd00: 2027 4a75 6e27 2c20 274a 756c 272c 0a20   'Jun', 'Jul',. 
-0001fd10: 2020 2020 2020 2020 2020 2020 2020 2020                  
-0001fd20: 2020 2020 2020 2020 2020 2020 2020 2020                  
-0001fd30: 2020 2027 4175 6727 2c20 2753 6570 272c     'Aug', 'Sep',
-0001fd40: 2027 4f63 7427 2c20 274e 6f76 272c 2027   'Oct', 'Nov', '
-0001fd50: 4465 6327 5d29 290a 2020 2020 2020 2020  Dec'])).        
-0001fd60: 6466 5b74 7363 6f6c 2b27 5f6d 6f6e 7468  df[tscol+'_month
-0001fd70: 275d 203d 2064 665b 7473 636f 6c2b 275f  '] = df[tscol+'_
-0001fd80: 6d6f 6e74 6827 5d2e 6d61 7028 4d4f 4e54  month'].map(MONT
-0001fd90: 4853 290a 2020 2020 2020 2020 6474 5f61  HS).        dt_a
-0001fda0: 6464 732e 6170 7065 6e64 2874 7363 6f6c  dds.append(tscol
-0001fdb0: 2b27 5f6d 6f6e 7468 2729 0a20 2020 2020  +'_month').     
-0001fdc0: 2020 2023 2323 2320 4164 6420 736f 6d65     #### Add some
-0001fdd0: 2066 6561 7475 7265 7320 666f 7220 6d6f   features for mo
-0001fde0: 6e74 6873 2023 2323 2323 2323 2323 2323  nths ###########
-0001fdf0: 2323 2323 2323 2323 2323 2323 2323 2323  ################
-0001fe00: 2323 2323 2323 2323 2323 2323 230a 2020  #############.  
-0001fe10: 2020 2020 2020 6665 7374 6976 6573 203d        festives =
-0001fe20: 205b 274f 6374 272c 274e 6f76 272c 2744   ['Oct','Nov','D
-0001fe30: 6563 275d 0a20 2020 2020 2020 206e 616d  ec'].        nam
-0001fe40: 655f 636f 6c20 3d20 7473 636f 6c2b 225f  e_col = tscol+"_
-0001fe50: 6973 5f66 6573 7469 7665 220a 2020 2020  is_festive".    
-0001fe60: 2020 2020 6466 5b6e 616d 655f 636f 6c5d      df[name_col]
-0001fe70: 203d 2030 0a20 2020 2020 2020 2064 665b   = 0.        df[
-0001fe80: 6e61 6d65 5f63 6f6c 5d20 3d20 6466 5b74  name_col] = df[t
-0001fe90: 7363 6f6c 2b27 5f6d 6f6e 7468 275d 2e6d  scol+'_month'].m
-0001fea0: 6170 286c 616d 6264 6120 783a 2031 2069  ap(lambda x: 1 i
-0001feb0: 6620 7820 696e 2066 6573 7469 7665 7320  f x in festives 
-0001fec0: 656c 7365 2030 292e 7661 6c75 6573 0a20  else 0).values. 
-0001fed0: 2020 2020 2020 2023 2323 2052 656d 656d         ### Remem
-0001fee0: 6265 7220 7468 6174 2066 696c 6c6e 6120  ber that fillna 
-0001fef0: 6f6e 6c79 2077 6f72 6b73 2061 7420 6461  only works at da
-0001ff00: 7461 6672 616d 6520 6c65 7665 6c21 2023  taframe level! #
-0001ff10: 2323 0a20 2020 2020 2020 2064 665b 5b6e  ##.        df[[n
-0001ff20: 616d 655f 636f 6c5d 5d20 3d20 6466 5b5b  ame_col]] = df[[
-0001ff30: 6e61 6d65 5f63 6f6c 5d5d 2e66 696c 6c6e  name_col]].filln
-0001ff40: 6128 3029 0a20 2020 2020 2020 2064 745f  a(0).        dt_
-0001ff50: 6164 6473 2e61 7070 656e 6428 6e61 6d65  adds.append(name
-0001ff60: 5f63 6f6c 290a 2020 2020 2020 2020 7375  _col).        su
-0001ff70: 6d6d 6572 203d 205b 274a 756e 272c 274a  mmer = ['Jun','J
-0001ff80: 756c 272c 2741 7567 275d 0a20 2020 2020  ul','Aug'].     
-0001ff90: 2020 206e 616d 655f 636f 6c20 3d20 7473     name_col = ts
-0001ffa0: 636f 6c2b 225f 6973 5f73 756d 6d65 7222  col+"_is_summer"
-0001ffb0: 0a20 2020 2020 2020 2064 665b 6e61 6d65  .        df[name
-0001ffc0: 5f63 6f6c 5d20 3d20 300a 2020 2020 2020  _col] = 0.      
-0001ffd0: 2020 6466 5b6e 616d 655f 636f 6c5d 203d    df[name_col] =
-0001ffe0: 2064 665b 7473 636f 6c2b 275f 6d6f 6e74   df[tscol+'_mont
-0001fff0: 6827 5d2e 6d61 7028 6c61 6d62 6461 2078  h'].map(lambda x
-00020000: 3a20 3120 6966 2078 2069 6e20 7375 6d6d  : 1 if x in summ
-00020010: 6572 2065 6c73 6520 3029 2e76 616c 7565  er else 0).value
-00020020: 730a 2020 2020 2020 2020 2323 2320 5265  s.        ### Re
-00020030: 6d65 6d62 6572 2074 6861 7420 6669 6c6c  member that fill
-00020040: 6e61 206f 6e6c 7920 776f 726b 7320 6174  na only works at
-00020050: 2064 6174 6166 7261 6d65 206c 6576 656c   dataframe level
-00020060: 2120 2323 230a 2020 2020 2020 2020 6466  ! ###.        df
-00020070: 5b5b 6e61 6d65 5f63 6f6c 5d5d 203d 2064  [[name_col]] = d
-00020080: 665b 5b6e 616d 655f 636f 6c5d 5d2e 6669  f[[name_col]].fi
-00020090: 6c6c 6e61 2830 290a 2020 2020 2020 2020  llna(0).        
-000200a0: 6474 5f61 6464 732e 6170 7065 6e64 286e  dt_adds.append(n
-000200b0: 616d 655f 636f 6c29 0a20 2020 2020 2020  ame_col).       
-000200c0: 2077 696e 7465 7220 3d20 5b27 4465 6327   winter = ['Dec'
-000200d0: 2c27 4a61 6e27 2c27 4665 6227 5d0a 2020  ,'Jan','Feb'].  
-000200e0: 2020 2020 2020 6e61 6d65 5f63 6f6c 203d        name_col =
-000200f0: 2074 7363 6f6c 2b22 5f69 735f 7769 6e74   tscol+"_is_wint
-00020100: 6572 220a 2020 2020 2020 2020 6466 5b6e  er".        df[n
-00020110: 616d 655f 636f 6c5d 203d 2030 0a20 2020  ame_col] = 0.   
-00020120: 2020 2020 2064 665b 6e61 6d65 5f63 6f6c       df[name_col
-00020130: 5d20 3d20 6466 5b74 7363 6f6c 2b27 5f6d  ] = df[tscol+'_m
-00020140: 6f6e 7468 275d 2e6d 6170 286c 616d 6264  onth'].map(lambd
-00020150: 6120 783a 2031 2069 6620 7820 696e 2077  a x: 1 if x in w
-00020160: 696e 7465 7220 656c 7365 2030 292e 7661  inter else 0).va
-00020170: 6c75 6573 0a20 2020 2020 2020 2023 2323  lues.        ###
-00020180: 2052 656d 656d 6265 7220 7468 6174 2066   Remember that f
-00020190: 696c 6c6e 6120 6f6e 6c79 2077 6f72 6b73  illna only works
-000201a0: 2061 7420 6461 7461 6672 616d 6520 6c65   at dataframe le
-000201b0: 7665 6c21 2023 2323 0a20 2020 2020 2020  vel! ###.       
-000201c0: 2064 665b 5b6e 616d 655f 636f 6c5d 5d20   df[[name_col]] 
-000201d0: 3d20 6466 5b5b 6e61 6d65 5f63 6f6c 5d5d  = df[[name_col]]
-000201e0: 2e66 696c 6c6e 6128 3029 0a20 2020 2020  .fillna(0).     
-000201f0: 2020 2064 745f 6164 6473 2e61 7070 656e     dt_adds.appen
-00020200: 6428 6e61 6d65 5f63 6f6c 290a 2020 2020  d(name_col).    
-00020210: 2020 2020 636f 6c64 203d 205b 274f 6374      cold = ['Oct
-00020220: 272c 274e 6f76 272c 2744 6563 272c 274a  ','Nov','Dec','J
-00020230: 616e 272c 2746 6562 272c 274d 6172 275d  an','Feb','Mar']
-00020240: 0a20 2020 2020 2020 206e 616d 655f 636f  .        name_co
-00020250: 6c20 3d20 7473 636f 6c2b 225f 6973 5f63  l = tscol+"_is_c
-00020260: 6f6c 6422 0a20 2020 2020 2020 2064 665b  old".        df[
-00020270: 6e61 6d65 5f63 6f6c 5d20 3d20 300a 2020  name_col] = 0.  
-00020280: 2020 2020 2020 6466 5b6e 616d 655f 636f        df[name_co
-00020290: 6c5d 203d 2064 665b 7473 636f 6c2b 275f  l] = df[tscol+'_
-000202a0: 6d6f 6e74 6827 5d2e 6d61 7028 6c61 6d62  month'].map(lamb
-000202b0: 6461 2078 3a20 3120 6966 2078 2069 6e20  da x: 1 if x in 
-000202c0: 636f 6c64 2065 6c73 6520 3029 2e76 616c  cold else 0).val
-000202d0: 7565 730a 2020 2020 2020 2020 2323 2320  ues.        ### 
-000202e0: 5265 6d65 6d62 6572 2074 6861 7420 6669  Remember that fi
-000202f0: 6c6c 6e61 206f 6e6c 7920 776f 726b 7320  llna only works 
-00020300: 6174 2064 6174 6166 7261 6d65 206c 6576  at dataframe lev
-00020310: 656c 2120 2323 230a 2020 2020 2020 2020  el! ###.        
-00020320: 6466 5b5b 6e61 6d65 5f63 6f6c 5d5d 203d  df[[name_col]] =
-00020330: 2064 665b 5b6e 616d 655f 636f 6c5d 5d2e   df[[name_col]].
-00020340: 6669 6c6c 6e61 2830 290a 2020 2020 2020  fillna(0).      
-00020350: 2020 6474 5f61 6464 732e 6170 7065 6e64    dt_adds.append
-00020360: 286e 616d 655f 636f 6c29 0a20 2020 2020  (name_col).     
-00020370: 2020 2077 6172 6d20 3d20 5b27 4170 7227     warm = ['Apr'
-00020380: 2c27 4d61 7927 2c27 4a75 6e27 2c27 4a75  ,'May','Jun','Ju
-00020390: 6c27 2c27 4175 6727 2c27 5365 7027 5d0a  l','Aug','Sep'].
-000203a0: 2020 2020 2020 2020 6e61 6d65 5f63 6f6c          name_col
-000203b0: 203d 2074 7363 6f6c 2b22 5f69 735f 7761   = tscol+"_is_wa
-000203c0: 726d 220a 2020 2020 2020 2020 6466 5b6e  rm".        df[n
-000203d0: 616d 655f 636f 6c5d 203d 2030 0a20 2020  ame_col] = 0.   
-000203e0: 2020 2020 2064 665b 6e61 6d65 5f63 6f6c       df[name_col
-000203f0: 5d20 3d20 6466 5b74 7363 6f6c 2b27 5f6d  ] = df[tscol+'_m
-00020400: 6f6e 7468 275d 2e6d 6170 286c 616d 6264  onth'].map(lambd
-00020410: 6120 783a 2031 2069 6620 7820 696e 2077  a x: 1 if x in w
-00020420: 6172 6d20 656c 7365 2030 292e 7661 6c75  arm else 0).valu
-00020430: 6573 0a20 2020 2020 2020 2023 2323 2052  es.        ### R
-00020440: 656d 656d 6265 7220 7468 6174 2066 696c  emember that fil
-00020450: 6c6e 6120 6f6e 6c79 2077 6f72 6b73 2061  lna only works a
-00020460: 7420 6461 7461 6672 616d 6520 6c65 7665  t dataframe leve
-00020470: 6c21 2023 2323 0a20 2020 2020 2020 2064  l! ###.        d
-00020480: 665b 5b6e 616d 655f 636f 6c5d 5d20 3d20  f[[name_col]] = 
-00020490: 6466 5b5b 6e61 6d65 5f63 6f6c 5d5d 2e66  df[[name_col]].f
-000204a0: 696c 6c6e 6128 3029 0a20 2020 2020 2020  illna(0).       
-000204b0: 2064 745f 6164 6473 2e61 7070 656e 6428   dt_adds.append(
-000204c0: 6e61 6d65 5f63 6f6c 290a 2020 2020 2020  name_col).      
-000204d0: 2020 2323 2323 2323 2323 2323 2323 2323    ##############
-000204e0: 2323 2323 2323 2323 2323 2323 2323 2323  ################
-000204f0: 2323 2323 2323 2323 2323 2323 2323 2323  ################
-00020500: 2323 2323 2323 2323 2323 2323 2323 2323  ################
-00020510: 2323 2323 2323 2323 2323 230a 2020 2020  ###########.    
-00020520: 2020 2020 6966 2074 7363 6f6c 2b27 5f64      if tscol+'_d
-00020530: 6179 6f66 7765 656b 2720 696e 2064 745f  ayofweek' in dt_
-00020540: 6164 6473 3a0a 2020 2020 2020 2020 2020  adds:.          
-00020550: 2020 6466 2e6c 6f63 5b3a 2c74 7363 6f6c    df.loc[:,tscol
-00020560: 2b27 5f6d 6f6e 7468 5f64 6179 6f66 7765  +'_month_dayofwe
-00020570: 656b 5f63 726f 7373 275d 203d 2064 665b  ek_cross'] = df[
-00020580: 7473 636f 6c2b 275f 6d6f 6e74 6827 5d20  tscol+'_month'] 
-00020590: 2b22 2022 2b20 6466 5b74 7363 6f6c 2b27  +" "+ df[tscol+'
-000205a0: 5f64 6179 6f66 7765 656b 275d 0a20 2020  _dayofweek'].   
-000205b0: 2020 2020 2020 2020 2064 745f 6164 6473           dt_adds
-000205c0: 2e61 7070 656e 6428 7473 636f 6c2b 275f  .append(tscol+'_
-000205d0: 6d6f 6e74 685f 6461 796f 6677 6565 6b5f  month_dayofweek_
-000205e0: 6372 6f73 7327 290a 2020 2020 2020 2020  cross').        
-000205f0: 6466 5b74 7363 6f6c 2b27 5f79 6561 7227  df[tscol+'_year'
-00020600: 5d20 3d20 6466 5b74 7363 6f6c 5d2e 6474  ] = df[tscol].dt
-00020610: 2e79 6561 722e 6669 6c6c 6e61 2830 292e  .year.fillna(0).
-00020620: 6173 7479 7065 2869 6e74 290a 2020 2020  astype(int).    
-00020630: 2020 2020 6474 5f61 6464 732e 6170 7065      dt_adds.appe
-00020640: 6e64 2874 7363 6f6c 2b27 5f79 6561 7227  nd(tscol+'_year'
-00020650: 290a 2020 2020 2020 2020 746f 6461 7920  ).        today 
-00020660: 3d20 6461 7465 2e74 6f64 6179 2829 0a20  = date.today(). 
-00020670: 2020 2020 2020 2064 665b 7473 636f 6c2b         df[tscol+
-00020680: 275f 6167 655f 696e 5f79 6561 7273 275d  '_age_in_years']
-00020690: 203d 2074 6f64 6179 2e79 6561 7220 2d20   = today.year - 
-000206a0: 6466 5b74 7363 6f6c 5d2e 6474 2e79 6561  df[tscol].dt.yea
-000206b0: 722e 6669 6c6c 6e61 2830 292e 6173 7479  r.fillna(0).asty
-000206c0: 7065 2869 6e74 290a 2020 2020 2020 2020  pe(int).        
-000206d0: 6474 5f61 6464 732e 6170 7065 6e64 2874  dt_adds.append(t
-000206e0: 7363 6f6c 2b27 5f61 6765 5f69 6e5f 7965  scol+'_age_in_ye
-000206f0: 6172 7327 290a 2020 2020 2020 2020 6466  ars').        df
-00020700: 5b74 7363 6f6c 2b27 5f64 6179 6f66 7965  [tscol+'_dayofye
-00020710: 6172 275d 203d 2064 665b 7473 636f 6c5d  ar'] = df[tscol]
-00020720: 2e64 742e 6461 796f 6679 6561 722e 6669  .dt.dayofyear.fi
-00020730: 6c6c 6e61 2830 292e 6173 7479 7065 2869  llna(0).astype(i
-00020740: 6e74 290a 2020 2020 2020 2020 6474 5f61  nt).        dt_a
-00020750: 6464 732e 6170 7065 6e64 2874 7363 6f6c  dds.append(tscol
-00020760: 2b27 5f64 6179 6f66 7965 6172 2729 0a20  +'_dayofyear'). 
-00020770: 2020 2020 2020 2064 665b 7473 636f 6c2b         df[tscol+
-00020780: 275f 6461 796f 666d 6f6e 7468 275d 203d  '_dayofmonth'] =
-00020790: 2064 665b 7473 636f 6c5d 2e64 742e 6461   df[tscol].dt.da
-000207a0: 792e 6669 6c6c 6e61 2830 292e 6173 7479  y.fillna(0).asty
-000207b0: 7065 2869 6e74 290a 2020 2020 2020 2020  pe(int).        
-000207c0: 6474 5f61 6464 732e 6170 7065 6e64 2874  dt_adds.append(t
-000207d0: 7363 6f6c 2b27 5f64 6179 6f66 6d6f 6e74  scol+'_dayofmont
-000207e0: 6827 290a 2020 2020 2020 2020 6466 5b74  h').        df[t
-000207f0: 7363 6f6c 2b27 5f77 6565 6b6f 6679 6561  scol+'_weekofyea
-00020800: 7227 5d20 3d20 6466 5b74 7363 6f6c 5d2e  r'] = df[tscol].
-00020810: 6474 2e77 6565 6b6f 6679 6561 722e 6669  dt.weekofyear.fi
-00020820: 6c6c 6e61 2830 292e 6173 7479 7065 2869  llna(0).astype(i
-00020830: 6e74 290a 2020 2020 2020 2020 6474 5f61  nt).        dt_a
-00020840: 6464 732e 6170 7065 6e64 2874 7363 6f6c  dds.append(tscol
-00020850: 2b27 5f77 6565 6b6f 6679 6561 7227 290a  +'_weekofyear').
-00020860: 2020 2020 2020 2020 7765 656b 656e 6473          weekends
-00020870: 203d 2028 6466 5b74 7363 6f6c 2b27 5f64   = (df[tscol+'_d
-00020880: 6179 6f66 7765 656b 275d 203d 3d20 2753  ayofweek'] == 'S
-00020890: 6174 2729 207c 2028 6466 5b74 7363 6f6c  at') | (df[tscol
-000208a0: 2b27 5f64 6179 6f66 7765 656b 275d 203d  +'_dayofweek'] =
-000208b0: 3d20 2753 756e 2729 0a20 2020 2020 2020  = 'Sun').       
-000208c0: 2064 665b 7473 636f 6c2b 275f 7479 7065   df[tscol+'_type
-000208d0: 6f66 6461 7927 5d20 3d20 2777 6565 6b64  ofday'] = 'weekd
-000208e0: 6179 270a 2020 2020 2020 2020 6466 2e6c  ay'.        df.l
-000208f0: 6f63 5b77 6565 6b65 6e64 732c 2074 7363  oc[weekends, tsc
-00020900: 6f6c 2b27 5f74 7970 656f 6664 6179 275d  ol+'_typeofday']
-00020910: 203d 2027 7765 656b 656e 6427 0a20 2020   = 'weekend'.   
-00020920: 2020 2020 2064 745f 6164 6473 2e61 7070       dt_adds.app
-00020930: 656e 6428 7473 636f 6c2b 275f 7479 7065  end(tscol+'_type
-00020940: 6f66 6461 7927 290a 2020 2020 2020 2020  ofday').        
-00020950: 6966 2074 7363 6f6c 2b27 5f74 7970 656f  if tscol+'_typeo
-00020960: 6664 6179 2720 696e 2064 745f 6164 6473  fday' in dt_adds
-00020970: 3a0a 2020 2020 2020 2020 2020 2020 6466  :.            df
-00020980: 2e6c 6f63 5b3a 2c74 7363 6f6c 2b27 5f6d  .loc[:,tscol+'_m
-00020990: 6f6e 7468 5f74 7970 656f 6664 6179 5f63  onth_typeofday_c
-000209a0: 726f 7373 275d 203d 2064 665b 7473 636f  ross'] = df[tsco
-000209b0: 6c2b 275f 6d6f 6e74 6827 5d20 2b22 2022  l+'_month'] +" "
-000209c0: 2b20 6466 5b74 7363 6f6c 2b27 5f74 7970  + df[tscol+'_typ
-000209d0: 656f 6664 6179 275d 0a20 2020 2020 2020  eofday'].       
-000209e0: 2020 2020 2064 745f 6164 6473 2e61 7070       dt_adds.app
-000209f0: 656e 6428 7473 636f 6c2b 275f 6d6f 6e74  end(tscol+'_mont
-00020a00: 685f 7479 7065 6f66 6461 795f 6372 6f73  h_typeofday_cros
-00020a10: 7327 290a 2020 2020 6578 6365 7074 3a0a  s').    except:.
-00020a20: 2020 2020 2020 2020 7072 696e 7428 2720          print(' 
-00020a30: 2020 2045 7272 6f72 2069 6e20 6372 6561     Error in crea
-00020a40: 7469 6e67 2064 6174 6520 7469 6d65 2064  ting date time d
-00020a50: 6572 6976 6564 2066 6561 7475 7265 732e  erived features.
-00020a60: 2043 6f6e 7469 6e75 696e 672e 2e2e 2729   Continuing...')
-00020a70: 0a20 2020 2069 6620 7665 7262 6f73 653a  .    if verbose:
-00020a80: 0a20 2020 2020 2020 2070 7269 6e74 2827  .        print('
-00020a90: 2020 2020 6372 6561 7465 6420 2564 2063      created %d c
-00020aa0: 6f6c 756d 6e73 2066 726f 6d20 7469 6d65  olumns from time
-00020ab0: 2073 6572 6965 7320 2573 2063 6f6c 756d   series %s colum
-00020ac0: 6e27 2025 286c 656e 2864 745f 6164 6473  n' %(len(dt_adds
-00020ad0: 292c 7473 636f 6c29 290a 2020 2020 7265  ),tscol)).    re
-00020ae0: 7475 726e 2064 665b 6474 5f61 6464 735d  turn df[dt_adds]
-00020af0: 0a23 2323 2323 2323 2323 2323 2323 2323  .###############
-00020b00: 2323 2323 2323 2323 2323 2323 2323 2323  ################
-00020b10: 2323 2323 2323 2323 2323 2323 2323 2323  ################
-00020b20: 2323 2323 2323 2323 2323 2323 2323 2323  ################
-00020b30: 2323 2323 2323 2323 2323 2323 2323 2323  ################
-00020b40: 2323 230a 2323 2320 5468 6973 2077 7261  ###.### This wra
-00020b50: 7070 6572 2077 6173 2070 726f 706f 7365  pper was propose
-00020b60: 6420 6279 2073 6f6d 656f 6e65 2069 6e20  d by someone in 
-00020b70: 5374 6163 6b6f 7665 7266 6c6f 7720 7768  Stackoverflow wh
-00020b80: 6963 6820 776f 726b 7320 7765 6c6c 2023  ich works well #
-00020b90: 2323 2323 2323 0a23 2323 2020 4d61 6e79  ######.###  Many
-00020ba0: 2074 6861 6e6b 7320 746f 3a20 6874 7470   thanks to: http
-00020bb0: 733a 2f2f 7374 6163 6b6f 7665 7266 6c6f  s://stackoverflo
-00020bc0: 772e 636f 6d2f 7175 6573 7469 6f6e 732f  w.com/questions/
-00020bd0: 3633 3030 3033 3838 2f68 6f77 2d74 6f2d  63000388/how-to-
-00020be0: 696e 636c 7564 652d 7369 6d70 6c65 696d  include-simpleim
-00020bf0: 7075 7465 722d 6265 666f 7265 2d63 6f75  puter-before-cou
-00020c00: 6e74 7665 6374 6f72 697a 6572 2d69 6e2d  ntvectorizer-in-
-00020c10: 612d 7363 696b 6974 2d6c 6561 726e 2d70  a-scikit-learn-p
-00020c20: 6970 656c 696e 650a 2323 2323 2323 2323  ipeline.########
-00020c30: 2323 2323 2323 2323 2323 2323 2323 2323  ################
-00020c40: 2323 2323 2323 2323 2323 2323 2323 2323  ################
-00020c50: 2323 2323 2323 2323 2323 2323 2323 2323  ################
-00020c60: 2323 2323 2323 2323 2323 2323 2323 2323  ################
-00020c70: 2323 2323 2323 2323 2323 0a63 6c61 7373  ##########.class
-00020c80: 204d 616b 6532 443a 0a20 2020 2022 2222   Make2D:.    """
-00020c90: 4f6e 6520 6469 6d65 6e73 696f 6e61 6c20  One dimensional 
-00020ca0: 7772 6170 7065 7220 666f 7220 736b 6c65  wrapper for skle
-00020cb0: 6172 6e20 5472 616e 7366 6f72 6d65 7273  arn Transformers
-00020cc0: 2222 220a 2020 2020 6465 6620 5f5f 696e  """.    def __in
-00020cd0: 6974 5f5f 2873 656c 662c 2074 7261 6e73  it__(self, trans
-00020ce0: 666f 726d 6572 293a 0a20 2020 2020 2020  former):.       
-00020cf0: 2073 656c 662e 7472 616e 7366 6f72 6d65   self.transforme
-00020d00: 7220 3d20 7472 616e 7366 6f72 6d65 720a  r = transformer.
-00020d10: 0a20 2020 2064 6566 2066 6974 2873 656c  .    def fit(sel
-00020d20: 662c 2058 2c20 793d 4e6f 6e65 293a 0a20  f, X, y=None):. 
-00020d30: 2020 2020 2020 2073 656c 662e 7472 616e         self.tran
-00020d40: 7366 6f72 6d65 722e 6669 7428 6e70 2e61  sformer.fit(np.a
-00020d50: 7272 6179 2858 292e 7265 7368 6170 6528  rray(X).reshape(
-00020d60: 2d31 2c20 3129 290a 2020 2020 2020 2020  -1, 1)).        
-00020d70: 7265 7475 726e 2073 656c 660a 0a20 2020  return self..   
-00020d80: 2064 6566 2074 7261 6e73 666f 726d 2873   def transform(s
-00020d90: 656c 662c 2058 2c20 793d 4e6f 6e65 293a  elf, X, y=None):
-00020da0: 0a20 2020 2020 2020 2072 6574 7572 6e20  .        return 
-00020db0: 7365 6c66 2e74 7261 6e73 666f 726d 6572  self.transformer
-00020dc0: 2e74 7261 6e73 666f 726d 280a 2020 2020  .transform(.    
-00020dd0: 2020 2020 2020 2020 6e70 2e61 7272 6179          np.array
-00020de0: 2858 292e 7265 7368 6170 6528 2d31 2c20  (X).reshape(-1, 
-00020df0: 3129 292e 7261 7665 6c28 290a 0a20 2020  1)).ravel()..   
-00020e00: 2064 6566 2069 6e76 6572 7365 5f74 7261   def inverse_tra
-00020e10: 6e73 666f 726d 2873 656c 662c 2058 2c20  nsform(self, X, 
-00020e20: 793d 4e6f 6e65 293a 0a20 2020 2020 2020  y=None):.       
-00020e30: 2072 6574 7572 6e20 7365 6c66 2e74 7261   return self.tra
-00020e40: 6e73 666f 726d 6572 2e69 6e76 6572 7365  nsformer.inverse
-00020e50: 5f74 7261 6e73 666f 726d 280a 2020 2020  _transform(.    
-00020e60: 2020 2020 2020 2020 6e70 2e65 7870 616e          np.expan
-00020e70: 645f 6469 6d73 2858 2c20 6178 6973 3d31  d_dims(X, axis=1
-00020e80: 2929 2e72 6176 656c 2829 0a23 2323 2323  )).ravel().#####
-00020e90: 2323 2323 2323 2323 2323 2323 2323 2323  ################
-00020ea0: 2323 2323 2323 2323 2323 2323 2323 2323  ################
-00020eb0: 2323 2323 2323 2323 2323 2323 2323 2323  ################
-00020ec0: 2323 2323 2323 2323 2323 2323 2323 2323  ################
-00020ed0: 2323 2323 2323 2323 2323 2323 230a 6465  #############.de
-00020ee0: 6620 7265 7475 726e 5f64 6566 6175 6c74  f return_default
-00020ef0: 2829 3a0a 2020 2020 6d69 7373 696e 675f  ():.    missing_
-00020f00: 7661 6c75 6520 3d20 226d 6973 7369 6e67  value = "missing
-00020f10: 5f22 2b73 7472 2872 616e 646f 6d2e 7261  _"+str(random.ra
-00020f20: 6e64 696e 7428 312c 3130 3030 2929 0a20  ndint(1,1000)). 
-00020f30: 2020 2072 6574 7572 6e20 6d69 7373 696e     return missin
-00020f40: 675f 7661 6c75 650a 2323 2323 2323 2323  g_value.########
-00020f50: 2323 2323 2323 2323 2323 2323 2323 2323  ################
-00020f60: 2323 2323 2323 2323 2323 2323 2323 2323  ################
-00020f70: 2323 2323 2323 2323 2323 2323 2323 2323  ################
-00020f80: 2323 2323 2323 2323 2323 2323 2323 2323  ################
-00020f90: 2323 2323 2323 2323 2323 0a64 6566 206d  ##########.def m
-00020fa0: 616b 655f 7369 6d70 6c65 5f70 6970 656c  ake_simple_pipel
-00020fb0: 696e 6528 585f 7472 6169 6e2c 2079 5f74  ine(X_train, y_t
-00020fc0: 7261 696e 2c20 656e 636f 6465 7273 3d27  rain, encoders='
-00020fd0: 6175 746f 272c 2073 6361 6c65 7273 3d27  auto', scalers='
-00020fe0: 272c 200a 2020 2020 2020 2020 2020 2020  ', .            
-00020ff0: 6461 7465 5f74 6f5f 7374 7269 6e67 3d27  date_to_string='
-00021000: 272c 2073 6176 655f 666c 6167 3d46 616c  ', save_flag=Fal
-00021010: 7365 2c20 636f 6d62 696e 655f 7261 7265  se, combine_rare
-00021020: 5f66 6c61 673d 4661 6c73 652c 2076 6572  _flag=False, ver
-00021030: 626f 7365 3d30 293a 0a20 2020 2022 2222  bose=0):.    """
-00021040: 0a20 2020 2023 2323 2323 2323 2323 2323  .    ###########
-00021050: 2323 2323 2323 2323 2323 2323 2323 2323  ################
-00021060: 2323 2323 2323 2323 2323 2323 2323 2323  ################
-00021070: 2323 2323 2323 2323 2323 2323 2323 2323  ################
-00021080: 2323 2323 2323 2323 2323 2323 2323 2323  ################
-00021090: 2323 2323 2323 2323 2323 2323 2323 2323  ################
-000210a0: 2323 2323 2323 2323 2323 2323 2323 2323  ################
-000210b0: 2323 2323 2323 2323 2323 230a 2020 2020  ###########.    
-000210c0: 2320 2320 5468 6973 2069 7320 7468 6520  # # This is the 
-000210d0: 5349 4d50 4c45 5354 2062 6573 7420 7069  SIMPLEST best pi
-000210e0: 7065 6c69 6e65 2066 6f72 204e 4c50 2061  peline for NLP a
-000210f0: 6e64 2054 696d 6520 5365 7269 6573 2070  nd Time Series p
-00021100: 726f 626c 656d 7320 2d20 4372 6561 7465  roblems - Create
-00021110: 6420 6279 2052 616d 2053 6573 6861 6472  d by Ram Seshadr
-00021120: 690a 2020 2020 2323 2323 2323 2054 6869  i.    ###### Thi
-00021130: 7320 7069 7065 6c69 6e65 2069 7320 696e  s pipeline is in
-00021140: 7370 6972 6564 2062 7920 4b65 7669 6e20  spired by Kevin 
-00021150: 4d61 726b 6861 6d27 7320 636c 6173 7320  Markham's class 
-00021160: 6f6e 2053 6369 6b69 742d 4c65 6172 6e20  on Scikit-Learn 
-00021170: 7069 7065 6c69 6e65 732e 200a 2020 2020  pipelines. .    
-00021180: 2323 2323 2323 2020 2020 2020 596f 7520  ######      You 
-00021190: 6361 6e20 7369 676e 2075 7020 666f 7220  can sign up for 
-000211a0: 6869 7320 4461 7461 2053 6368 6f6f 6c20  his Data School 
-000211b0: 636c 6173 7320 6865 7265 3a20 6874 7470  class here: http
-000211c0: 733a 2f2f 7777 772e 6461 7461 7363 686f  s://www.datascho
-000211d0: 6f6c 2e69 6f2f 0a20 2020 2023 2323 2323  ol.io/.    #####
-000211e0: 2323 2323 2323 2323 2323 2323 2323 2323  ################
-000211f0: 2323 2323 2323 2323 2323 2323 2323 2323  ################
-00021200: 2323 2323 2323 2323 2323 2323 2323 2323  ################
-00021210: 2323 2323 2323 2323 2323 2323 2323 2323  ################
-00021220: 2323 2323 2323 2323 2323 2323 2323 2323  ################
-00021230: 2323 2323 2323 2323 2323 2323 2323 2323  ################
-00021240: 2323 2323 2323 2323 2323 2323 2323 2323  ################
-00021250: 230a 2020 2020 2323 2323 2057 6861 7420  #.    #### What 
-00021260: 646f 6573 2074 6869 7320 7069 7065 6c69  does this pipeli
-00021270: 6e65 2064 6f2e 2048 6572 6527 7320 7468  ne do. Here's th
-00021280: 6520 6d61 6a6f 7220 7374 6570 733a 0a20  e major steps:. 
-00021290: 2020 2023 2031 2e20 5461 6b65 7320 6361     # 1. Takes ca
-000212a0: 7465 676f 7269 6361 6c20 7661 7269 6162  tegorical variab
-000212b0: 6c65 7320 616e 6420 656e 636f 6465 7320  les and encodes 
-000212c0: 7468 656d 2075 7369 6e67 206d 7920 7370  them using my sp
-000212d0: 6563 6961 6c20 6c61 6265 6c20 656e 636f  ecial label enco
-000212e0: 6465 7220 7768 6963 6820 6361 6e20 6861  der which can ha
-000212f0: 6e64 6c65 204e 614e 7320 616e 6420 6675  ndle NaNs and fu
-00021300: 7475 7265 2063 6174 6567 6f72 6965 730a  ture categories.
-00021310: 2020 2020 2320 322e 2054 616b 6573 206e      # 2. Takes n
-00021320: 756d 6572 6963 2076 6172 6961 626c 6573  umeric variables
-00021330: 2061 6e64 2069 6d70 7574 6573 2074 6865   and imputes the
-00021340: 6d20 7573 696e 6720 6120 7369 6d70 6c65  m using a simple
-00021350: 2069 6d70 7574 6572 0a20 2020 2023 2033   imputer.    # 3
-00021360: 2e20 5461 6b65 7320 4e4c 5020 616e 6420  . Takes NLP and 
-00021370: 7469 6d65 2073 6572 6965 7320 2873 7472  time series (str
-00021380: 696e 6729 2076 6172 6961 626c 6573 2061  ing) variables a
-00021390: 6e64 2076 6563 746f 7269 7a65 7320 7468  nd vectorizes th
-000213a0: 656d 2075 7369 6e67 2043 6f75 6e74 5665  em using CountVe
-000213b0: 6374 6f72 697a 6572 0a20 2020 2023 2034  ctorizer.    # 4
-000213c0: 2e20 436f 6d70 6c65 7465 6c79 2073 7461  . Completely sta
-000213d0: 6e64 6172 6469 7a69 6e67 2061 6c6c 206f  ndardizing all o
-000213e0: 6620 7468 6520 6162 6f76 6520 7573 696e  f the above usin
-000213f0: 6720 4162 734d 6178 5363 616c 6572 2077  g AbsMaxScaler w
-00021400: 6869 6368 2070 7265 7365 7276 6573 2074  hich preserves t
-00021410: 6865 2072 656c 6174 696f 6e73 6869 7020  he relationship 
-00021420: 6f66 206c 6162 656c 2065 6e63 6f64 6564  of label encoded
-00021430: 2076 6172 730a 2020 2020 2320 352e 2046   vars.    # 5. F
-00021440: 696e 616c 6c79 2061 6464 7320 616e 2052  inally adds an R
-00021450: 4643 206f 7220 5246 5220 746f 2074 6865  FC or RFR to the
-00021460: 2070 6970 656c 696e 6520 736f 2074 6865   pipeline so the
-00021470: 2065 6e74 6972 6520 7069 7065 6c69 6e65   entire pipeline
-00021480: 2063 616e 2062 6520 6665 6420 746f 2061   can be fed to a
-00021490: 2063 726f 7373 2076 616c 6964 6174 696f   cross validatio
-000214a0: 6e20 7363 6865 6d65 0a20 2020 2023 2323  n scheme.    ###
-000214b0: 2320 5468 6520 7265 7375 6c74 7320 6172  # The results ar
-000214c0: 6520 7965 7420 746f 2062 6520 5448 4f52  e yet to be THOR
-000214d0: 4f55 4748 4c59 2054 4553 5445 4420 6275  OUGHLY TESTED bu
-000214e0: 7420 7072 656c 696d 696e 6172 7920 7265  t preliminary re
-000214f0: 7375 6c74 7320 4f46 2054 4849 5320 5049  sults OF THIS PI
-00021500: 5045 4c49 4e45 2041 5245 2076 6572 7920  PELINE ARE very 
-00021510: 7072 6f6d 6973 696e 6720 494e 4445 4544  promising INDEED
-00021520: 2e0a 2020 2020 2323 2323 2323 2323 2323  ..    ##########
-00021530: 2323 2323 2323 2323 2323 2323 2323 2323  ################
-00021540: 2323 2323 2323 2323 2323 2323 2323 2323  ################
-00021550: 2323 2323 2323 2323 2323 2323 2323 2323  ################
-00021560: 2323 2323 2323 2323 2323 2323 2323 2323  ################
-00021570: 2323 2323 2323 2323 2323 2323 2323 2323  ################
-00021580: 2323 2323 2323 2323 2323 2323 2323 2323  ################
-00021590: 2323 2323 2323 2323 2323 2323 0a20 2020  ############.   
-000215a0: 2022 2222 0a20 2020 2073 7461 7274 5f74   """.    start_t
-000215b0: 696d 6520 3d20 7469 6d65 2e74 696d 6528  ime = time.time(
-000215c0: 290a 2020 2020 2323 2320 4e6f 7720 6465  ).    ### Now de
-000215d0: 6369 6465 2077 6869 6368 2070 6970 656c  cide which pipel
-000215e0: 696e 6520 796f 7520 7761 6e74 2074 6f20  ine you want to 
-000215f0: 7573 6520 2323 2323 2323 2323 2323 230a  use ###########.
-00021600: 2020 2020 2323 2323 2320 4e6f 7720 7365      ##### Now se
-00021610: 7420 7570 2061 6c6c 2074 6865 2065 6e63  t up all the enc
-00021620: 6f64 6572 7320 2323 2323 2323 2323 2323  oders ##########
-00021630: 2323 2323 2323 2323 0a20 2020 2069 6620  ########.    if 
-00021640: 6973 696e 7374 616e 6365 2865 6e63 6f64  isinstance(encod
-00021650: 6572 732c 206c 6973 7429 3a0a 2020 2020  ers, list):.    
-00021660: 2020 2020 6261 7369 635f 656e 636f 6465      basic_encode
-00021670: 7220 3d20 656e 636f 6465 7273 5b30 5d0a  r = encoders[0].
-00021680: 2020 2020 2020 2020 656e 636f 6465 7220          encoder 
-00021690: 3d20 656e 636f 6465 7273 5b31 5d0a 2020  = encoders[1].  
-000216a0: 2020 2020 2020 6966 206e 6f74 2069 7369        if not isi
-000216b0: 6e73 7461 6e63 6528 6261 7369 635f 656e  nstance(basic_en
-000216c0: 636f 6465 722c 2073 7472 2920 6f72 206e  coder, str) or n
-000216d0: 6f74 2069 7369 6e73 7461 6e63 6528 656e  ot isinstance(en
-000216e0: 636f 6465 722c 2073 7472 293a 0a20 2020  coder, str):.   
-000216f0: 2020 2020 2020 2020 2070 7269 6e74 2827           print('
-00021700: 656e 636f 6465 7273 206d 7573 7420 6265  encoders must be
-00021710: 2065 6974 6865 7220 7374 7269 6e67 206f   either string o
-00021720: 7220 6c69 7374 206f 6620 7374 7269 6e67  r list of string
-00021730: 732e 2050 6c65 6173 6520 6368 6563 6b20  s. Please check 
-00021740: 796f 7572 2069 6e70 7574 2061 6e64 2074  your input and t
-00021750: 7279 2061 6761 696e 2e27 290a 2020 2020  ry again.').    
-00021760: 2020 2020 2020 2020 7265 7475 726e 0a20          return. 
-00021770: 2020 2065 6c69 6620 6973 696e 7374 616e     elif isinstan
-00021780: 6365 2865 6e63 6f64 6572 732c 2073 7472  ce(encoders, str
-00021790: 293a 0a20 2020 2020 2020 2069 6620 656e  ):.        if en
-000217a0: 636f 6465 7273 203d 3d20 2761 7574 6f27  coders == 'auto'
-000217b0: 3a0a 2020 2020 2020 2020 2020 2020 6261  :.            ba
-000217c0: 7369 635f 656e 636f 6465 7220 3d20 276f  sic_encoder = 'o
-000217d0: 6e65 686f 7427 0a20 2020 2020 2020 2020  nehot'.         
-000217e0: 2020 2065 6e63 6f64 6572 203d 2027 6c61     encoder = 'la
-000217f0: 6265 6c27 0a20 2020 2020 2020 2065 6c73  bel'.        els
-00021800: 653a 0a20 2020 2020 2020 2020 2020 2062  e:.            b
-00021810: 6173 6963 5f65 6e63 6f64 6572 203d 2063  asic_encoder = c
-00021820: 6f70 792e 6465 6570 636f 7079 2865 6e63  opy.deepcopy(enc
-00021830: 6f64 6572 7329 0a20 2020 2020 2020 2020  oders).         
-00021840: 2020 2065 6e63 6f64 6572 203d 2063 6f70     encoder = cop
-00021850: 792e 6465 6570 636f 7079 2865 6e63 6f64  y.deepcopy(encod
-00021860: 6572 7329 0a20 2020 2065 6c73 653a 0a20  ers).    else:. 
-00021870: 2020 2020 2020 2070 7269 6e74 2827 656e         print('en
-00021880: 636f 6465 7273 206d 7573 7420 6265 2065  coders must be e
-00021890: 6974 6865 7220 7374 7269 6e67 206f 7220  ither string or 
-000218a0: 6c69 7374 206f 6620 7374 7269 6e67 732e  list of strings.
-000218b0: 2050 6c65 6173 6520 6368 6563 6b20 796f   Please check yo
-000218c0: 7572 2069 6e70 7574 2061 6e64 2074 7279  ur input and try
-000218d0: 2061 6761 696e 2e27 290a 2020 2020 2020   again.').      
-000218e0: 2020 7265 7475 726e 0a20 2020 2069 6620    return.    if 
-000218f0: 6973 696e 7374 616e 6365 2858 5f74 7261  isinstance(X_tra
-00021900: 696e 2c20 6e70 2e6e 6461 7272 6179 293a  in, np.ndarray):
-00021910: 0a20 2020 2020 2020 2070 7269 6e74 2827  .        print('
-00021920: 585f 7472 6169 6e20 696e 7075 7420 6d75  X_train input mu
-00021930: 7374 2062 6520 6120 6461 7461 6672 616d  st be a datafram
-00021940: 6520 7369 6e63 6520 7765 2075 7365 2063  e since we use c
-00021950: 6f6c 756d 6e20 6e61 6d65 7320 746f 2062  olumn names to b
-00021960: 7569 6c64 2064 6174 6120 7069 7065 6c69  uild data pipeli
-00021970: 6e65 732e 2052 6574 7572 6e69 6e67 2729  nes. Returning')
-00021980: 0a20 2020 2020 2020 2072 6574 7572 6e20  .        return 
-00021990: 7b7d 2c20 7b7d 0a20 2020 200a 2020 2020  {}, {}.    .    
-000219a0: 6466 203d 2070 642e 636f 6e63 6174 285b  df = pd.concat([
-000219b0: 585f 7472 6169 6e2c 2079 5f74 7261 696e  X_train, y_train
-000219c0: 5d2c 2061 7869 733d 3129 0a20 2020 2069  ], axis=1).    i
-000219d0: 6620 6973 696e 7374 616e 6365 2879 5f74  f isinstance(y_t
-000219e0: 7261 696e 2c20 7064 2e53 6572 6965 7329  rain, pd.Series)
-000219f0: 3a0a 2020 2020 2020 2020 7461 7267 6574  :.        target
-00021a00: 203d 2079 5f74 7261 696e 2e6e 616d 650a   = y_train.name.
-00021a10: 2020 2020 2020 2020 7461 7267 6574 7320          targets 
-00021a20: 3d20 5b74 6172 6765 745d 0a20 2020 2065  = [target].    e
-00021a30: 6c69 6620 6973 696e 7374 616e 6365 2879  lif isinstance(y
-00021a40: 5f74 7261 696e 2c20 7064 2e44 6174 6146  _train, pd.DataF
-00021a50: 7261 6d65 293a 0a20 2020 2020 2020 2074  rame):.        t
-00021a60: 6172 6765 7420 3d20 795f 7472 6169 6e2e  arget = y_train.
-00021a70: 636f 6c75 6d6e 732e 746f 6c69 7374 2829  columns.tolist()
-00021a80: 0a20 2020 2020 2020 2074 6172 6765 7473  .        targets
-00021a90: 203d 2063 6f70 792e 6465 6570 636f 7079   = copy.deepcopy
-00021aa0: 2874 6172 6765 7429 0a20 2020 2065 6c69  (target).    eli
-00021ab0: 6620 6973 696e 7374 616e 6365 2858 5f74  f isinstance(X_t
-00021ac0: 7261 696e 2c20 6e70 2e6e 6461 7272 6179  rain, np.ndarray
-00021ad0: 293a 0a20 2020 2020 2020 2070 7269 6e74  ):.        print
-00021ae0: 2827 795f 7472 6169 6e20 6d75 7374 2062  ('y_train must b
-00021af0: 6520 6120 7064 2e53 6572 6965 7320 6f72  e a pd.Series or
-00021b00: 2070 642e 4461 7461 4672 616d 6520 7369   pd.DataFrame si
-00021b10: 6e63 6520 7765 2075 7365 2063 6f6c 756d  nce we use colum
-00021b20: 6e20 6e61 6d65 7320 746f 2062 7569 6c64  n names to build
-00021b30: 2064 6174 6120 7069 7065 6c69 6e65 2e20   data pipeline. 
-00021b40: 5265 7475 726e 696e 6727 290a 2020 2020  Returning').    
-00021b50: 2020 2020 7265 7475 726e 207b 7d2c 207b      return {}, {
-00021b60: 7d0a 2020 2020 2323 2323 2323 2054 6869  }.    ###### Thi
-00021b70: 7320 6865 6c70 7320 6669 6e64 2061 6c6c  s helps find all
-00021b80: 2074 6865 2070 7265 6469 6374 6f72 2076   the predictor v
-00021b90: 6172 6961 626c 6573 200a 2020 2020 636f  ariables .    co
-00021ba0: 6c73 203d 2058 5f74 7261 696e 2e63 6f6c  ls = X_train.col
-00021bb0: 756d 6e73 2e74 6f6c 6973 7428 290a 2020  umns.tolist().  
-00021bc0: 2020 2323 2323 2053 656e 6420 7461 7267    #### Send targ
-00021bd0: 6574 2076 6172 6961 626c 6520 6173 2069  et variable as i
-00021be0: 7420 6973 2073 6f20 7468 6174 2079 5f74  t is so that y_t
-00021bf0: 7261 696e 2069 7320 616e 616c 797a 6564  rain is analyzed
-00021c00: 2070 726f 7065 726c 7920 2323 230a 2020   properly ###.  
-00021c10: 2020 6d6f 6465 6c74 7970 652c 206d 756c    modeltype, mul
-00021c20: 7469 5f6c 6162 656c 203d 2061 6e61 6c79  ti_label = analy
-00021c30: 7a65 5f70 726f 626c 656d 5f74 7970 6528  ze_problem_type(
-00021c40: 795f 7472 6169 6e2c 2074 6172 6765 742c  y_train, target,
-00021c50: 2076 6572 626f 7365 3d31 290a 2020 2020   verbose=1).    
-00021c60: 7072 696e 7428 2753 6861 7065 206f 6620  print('Shape of 
-00021c70: 6461 7461 7365 743a 2025 732e 204e 6f77  dataset: %s. Now
-00021c80: 2077 6520 636c 6173 7369 6679 2076 6172   we classify var
-00021c90: 6961 626c 6573 2069 6e74 6f20 6469 6666  iables into diff
-00021ca0: 6572 656e 7420 7479 7065 732e 2e2e 2720  erent types...' 
-00021cb0: 2528 585f 7472 6169 6e2e 7368 6170 652c  %(X_train.shape,
-00021cc0: 2929 0a20 2020 2076 6172 5f64 6963 7420  )).    var_dict 
-00021cd0: 3d20 636c 6173 7369 6679 5f76 6172 735f  = classify_vars_
-00021ce0: 7061 6e64 6173 2864 665b 636f 6c73 5d2c  pandas(df[cols],
-00021cf0: 7665 7262 6f73 6529 0a20 2020 2023 2323  verbose).    ###
-00021d00: 2320 4f6e 6365 2076 6172 7320 6172 6520  # Once vars are 
-00021d10: 636c 6173 7369 6669 6564 2062 7563 6b65  classified bucke
-00021d20: 7420 7468 656d 2069 6e74 6f20 6d61 6a6f  t them into majo
-00021d30: 7220 7479 7065 7320 2323 230a 2020 2020  r types ###.    
-00021d40: 6361 7476 6172 7320 3d20 7661 725f 6469  catvars = var_di
-00021d50: 6374 5b27 6361 7465 676f 7269 6361 6c5f  ct['categorical_
-00021d60: 7661 7273 275d 2023 2323 2074 6865 7365  vars'] ### these
-00021d70: 2061 7265 206c 6f77 2063 6172 6469 6e61   are low cardina
-00021d80: 6c69 7479 2063 6174 2076 6172 6961 626c  lity cat variabl
-00021d90: 6573 200a 2020 2020 6469 7363 7265 7465  es .    discrete
-00021da0: 7661 7273 203d 2076 6172 5f64 6963 745b  vars = var_dict[
-00021db0: 2764 6973 6372 6574 655f 7374 7269 6e67  'discrete_string
-00021dc0: 5f76 6172 7327 5d20 2323 2320 7468 6573  _vars'] ### thes
-00021dd0: 6520 6172 6520 6869 6768 2063 6172 6469  e are high cardi
-00021de0: 6e61 6c69 7479 2063 6174 2076 6172 6961  nality cat varia
-00021df0: 626c 6573 200a 2020 2020 666c 6f61 7476  bles .    floatv
-00021e00: 6172 7320 3d20 7661 725f 6469 6374 5b27  ars = var_dict['
-00021e10: 636f 6e74 696e 756f 7573 5f76 6172 7327  continuous_vars'
-00021e20: 5d0a 2020 2020 696e 7476 6172 7320 3d20  ].    intvars = 
-00021e30: 7661 725f 6469 6374 5b27 696e 745f 7661  var_dict['int_va
-00021e40: 7273 275d 0a20 2020 206e 6c70 7661 7273  rs'].    nlpvars
-00021e50: 203d 2076 6172 5f64 6963 745b 276e 6c70   = var_dict['nlp
-00021e60: 5f76 6172 7327 5d0a 2020 2020 6461 7465  _vars'].    date
-00021e70: 7661 7273 203d 2076 6172 5f64 6963 745b  vars = var_dict[
-00021e80: 2764 6174 655f 7661 7273 275d 202b 2076  'date_vars'] + v
-00021e90: 6172 5f64 6963 745b 2774 696d 655f 6465  ar_dict['time_de
-00021ea0: 6c74 6173 275d 202b 2076 6172 5f64 6963  ltas'] + var_dic
-00021eb0: 745b 2764 6174 655f 7a6f 6e65 7327 5d0a  t['date_zones'].
-00021ec0: 2020 2020 2323 2323 2043 6f6e 7665 7274      #### Convert
-00021ed0: 696e 6720 6461 7465 2076 6172 6961 626c  ing date variabl
-00021ee0: 6520 746f 2061 2073 7472 696e 6720 7661  e to a string va
-00021ef0: 7269 6162 6c65 2069 6620 7468 6174 2069  riable if that i
-00021f00: 7320 7265 7175 6573 7465 6420 2323 2323  s requested ####
-00021f10: 2323 2323 2323 2323 2323 2323 2323 230a  ###############.
-00021f20: 2020 2020 6966 2064 6174 655f 746f 5f73      if date_to_s
-00021f30: 7472 696e 673a 0a20 2020 2020 2020 2069  tring:.        i
-00021f40: 6620 6973 696e 7374 616e 6365 2864 6174  f isinstance(dat
-00021f50: 655f 746f 5f73 7472 696e 672c 2073 7472  e_to_string, str
-00021f60: 293a 0a20 2020 2020 2020 2020 2020 2063  ):.            c
-00021f70: 6f70 795f 6461 7465 7661 7273 203d 205b  opy_datevars = [
-00021f80: 6461 7465 5f74 6f5f 7374 7269 6e67 5d0a  date_to_string].
-00021f90: 2020 2020 2020 2020 656c 7365 3a0a 2020          else:.  
-00021fa0: 2020 2020 2020 2020 2020 636f 7079 5f64            copy_d
-00021fb0: 6174 6576 6172 7320 3d20 636f 7079 2e64  atevars = copy.d
-00021fc0: 6565 7063 6f70 7928 6461 7465 5f74 6f5f  eepcopy(date_to_
-00021fd0: 7374 7269 6e67 290a 2020 2020 2020 2020  string).        
-00021fe0: 2323 2069 6620 7468 6579 2068 6176 6520  ## if they have 
-00021ff0: 6769 7665 6e20 6f6e 6c79 206f 6e65 2073  given only one s
-00022000: 7472 696e 6720 7661 7269 6162 6c65 200a  tring variable .
-00022010: 2020 2020 2020 2020 666f 7220 6561 6368          for each
-00022020: 5f64 6174 6520 696e 2063 6f70 795f 6461  _date in copy_da
-00022030: 7465 7661 7273 3a0a 2020 2020 2020 2020  tevars:.        
-00022040: 2020 2020 7072 696e 7428 2720 2020 2073      print('    s
-00022050: 7472 696e 6720 7661 7269 6162 6c65 2025  tring variable %
-00022060: 7320 7769 6c6c 2062 6520 7472 6561 7465  s will be treate
-00022070: 6420 6173 204e 4c50 2076 6172 2061 6e64  d as NLP var and
-00022080: 2074 7261 6e73 666f 726d 6564 2062 7920   transformed by 
-00022090: 5466 6964 6656 6563 746f 7269 7a65 7227  TfidfVectorizer'
-000220a0: 2025 6561 6368 5f64 6174 6529 0a20 2020   %each_date).   
-000220b0: 2020 2020 2020 2020 2058 5f74 7261 696e           X_train
-000220c0: 5b65 6163 685f 6461 7465 5d20 3d20 585f  [each_date] = X_
-000220d0: 7472 6169 6e5b 6561 6368 5f64 6174 655d  train[each_date]
-000220e0: 2e61 7374 7970 6528 7374 7229 2e76 616c  .astype(str).val
-000220f0: 7565 730a 2020 2020 2020 2020 2020 2020  ues.            
-00022100: 6966 206e 6f74 2065 6163 685f 6461 7465  if not each_date
-00022110: 2069 6e20 6e6c 7076 6172 733a 0a20 2020   in nlpvars:.   
-00022120: 2020 2020 2020 2020 2020 2020 206e 6c70               nlp
-00022130: 7661 7273 2e61 7070 656e 6428 6561 6368  vars.append(each
-00022140: 5f64 6174 6529 0a20 2020 2020 2020 2020  _date).         
-00022150: 2020 2023 2323 2320 4e65 7874 2063 6865     #### Next che
-00022160: 636b 2074 6f20 7265 6d6f 7665 2074 6865  ck to remove the
-00022170: 6d20 6865 7265 2023 2323 0a20 2020 2020  m here ###.     
-00022180: 2020 2020 2020 2069 6620 6561 6368 5f64         if each_d
-00022190: 6174 6520 696e 2064 6174 6576 6172 733a  ate in datevars:
-000221a0: 0a20 2020 2020 2020 2020 2020 2020 2020  .               
-000221b0: 2064 6174 6576 6172 732e 7265 6d6f 7665   datevars.remove
-000221c0: 2865 6163 685f 6461 7465 290a 2020 2020  (each_date).    
-000221d0: 2020 2020 2020 2020 656c 6966 2065 6163          elif eac
-000221e0: 685f 6461 7465 2069 6e20 6469 7363 7265  h_date in discre
-000221f0: 7465 7661 7273 3a0a 2020 2020 2020 2020  tevars:.        
-00022200: 2020 2020 2020 2020 6469 7363 7265 7465          discrete
-00022210: 7661 7273 2e72 656d 6f76 6528 6561 6368  vars.remove(each
-00022220: 5f64 6174 6529 0a20 2020 2020 2020 2020  _date).         
-00022230: 2020 2065 6c69 6620 6561 6368 5f64 6174     elif each_dat
-00022240: 6520 696e 2063 6174 7661 7273 3a0a 2020  e in catvars:.  
-00022250: 2020 2020 2020 2020 2020 2020 2020 6361                ca
-00022260: 7476 6172 732e 7265 6d6f 7665 2865 6163  tvars.remove(eac
-00022270: 685f 6461 7465 290a 2020 2020 2323 2320  h_date).    ### 
-00022280: 4e6f 7720 646f 2074 6865 2061 6374 7561  Now do the actua
-00022290: 6c20 7072 6f63 6573 7369 6e67 2066 6f72  l processing for
-000222a0: 2064 6174 6576 6172 7320 2323 2323 2323   datevars ######
-000222b0: 2323 0a20 2020 2069 6620 6461 7465 7661  ##.    if dateva
-000222c0: 7273 3a0a 2020 2020 2020 2020 6966 2076  rs:.        if v
-000222d0: 6572 626f 7365 3a0a 2020 2020 2020 2020  erbose:.        
-000222e0: 2020 2020 7072 696e 7428 2744 6174 6520      print('Date 
-000222f0: 7469 6d65 2076 6172 733a 2025 7320 6465  time vars: %s de
-00022300: 7465 6374 6564 2e20 5365 7665 7261 6c20  tected. Several 
-00022310: 6665 6174 7572 6573 2077 696c 6c20 6265  features will be
-00022320: 2065 7874 7261 6374 6564 2e2e 2e27 2025   extracted...' %
-00022330: 6461 7465 7661 7273 290a 2020 2020 2020  datevars).      
-00022340: 2020 656c 7365 3a0a 2020 2020 2020 2020    else:.        
-00022350: 2020 2020 7061 7373 0a20 2020 2065 6c73      pass.    els
-00022360: 653a 0a20 2020 2020 2020 2069 6620 7665  e:.        if ve
-00022370: 7262 6f73 653a 0a20 2020 2020 2020 2020  rbose:.         
-00022380: 2020 2070 7269 6e74 2827 2020 2020 6e6f     print('    no
-00022390: 2064 6174 6520 7469 6d65 2076 6172 6961   date time varia
-000223a0: 626c 6573 2064 6574 6563 7465 6420 696e  bles detected in
-000223b0: 2074 6869 7320 6461 7461 7365 7427 290a   this dataset').
-000223c0: 2020 2020 2020 2020 656c 7365 3a0a 2020          else:.  
-000223d0: 2020 2020 2020 2020 2020 7061 7373 0a20            pass. 
-000223e0: 2020 2023 2323 2323 2323 2323 2323 2323     #############
-000223f0: 2323 2323 2323 2323 2323 2323 2323 2323  ################
-00022400: 2323 2323 2323 2323 2323 230a 2020 2020  ###########.    
-00022410: 2323 2320 5365 7420 7468 6520 6361 7465  ### Set the cate
-00022420: 676f 7279 2065 6e63 6f64 6572 7320 6865  gory encoders he
-00022430: 7265 2023 2323 2323 0a20 2020 2023 2323  re #####.    ###
-00022440: 2323 2323 2323 2323 2323 2323 2323 2323  ################
-00022450: 2323 2323 2323 2323 2323 2323 2323 2323  ################
-00022460: 2323 2323 230a 2020 2020 2323 2320 596f  #####.    ### Yo
-00022470: 7520 6172 6520 676f 696e 6720 746f 2073  u are going to s
-00022480: 6574 204c 6162 656c 2045 6e63 6f64 6572  et Label Encoder
-00022490: 2061 7320 7468 6520 6465 6661 756c 7420   as the default 
-000224a0: 656e 636f 6465 7220 7369 6e63 6520 6974  encoder since it
-000224b0: 2069 7320 6d6f 7374 2076 6572 7361 7469   is most versati
-000224c0: 6c65 2023 230a 2020 2020 6465 6620 6465  le ##.    def de
-000224d0: 6661 756c 745f 656e 636f 6465 7228 293a  fault_encoder():
-000224e0: 0a20 2020 2020 2020 2072 6574 7572 6e20  .        return 
-000224f0: 4d79 5f4c 6162 656c 456e 636f 6465 7228  My_LabelEncoder(
-00022500: 290a 2020 2020 656e 636f 6465 725f 6469  ).    encoder_di
-00022510: 6374 203d 2064 6566 6175 6c74 6469 6374  ct = defaultdict
-00022520: 2864 6566 6175 6c74 5f65 6e63 6f64 6572  (default_encoder
-00022530: 290a 0a20 2020 2023 2323 2079 6f75 206d  )..    ### you m
-00022540: 7573 7420 6c65 6176 6520 6472 6f70 5f69  ust leave drop_i
-00022550: 6e76 6172 6961 6e74 203d 2046 616c 7365  nvariant = False
-00022560: 2066 6f72 2063 6174 626f 6f73 7420 7369   for catboost si
-00022570: 6e63 6520 6974 2069 7320 6e6f 7420 6120  nce it is not a 
-00022580: 6f6e 686f 7420 7479 7065 2065 6e63 6f64  onhot type encod
-00022590: 6572 2e20 2323 0a20 2020 2065 6e63 6f64  er. ##.    encod
-000225a0: 6572 5f64 6963 7420 3d20 7b0a 2020 2020  er_dict = {.    
-000225b0: 2020 2020 2020 2020 2020 2020 2020 2020                  
-000225c0: 2327 6f6e 6568 6f74 273a 204f 6e65 486f  #'onehot': OneHo
-000225d0: 7445 6e63 6f64 6572 2868 616e 646c 655f  tEncoder(handle_
-000225e0: 756e 6b6e 6f77 6e3d 2769 676e 6f72 6527  unknown='ignore'
-000225f0: 292c 2023 2320 7468 6973 2069 7320 666f  ), ## this is fo
-00022600: 7220 736b 6c65 6172 6e20 7665 7273 696f  r sklearn versio
-00022610: 6e20 2323 0a20 2020 2020 2020 2020 2020  n ##.           
-00022620: 2020 2020 2020 2020 2027 6f6e 6568 6f74           'onehot
-00022630: 273a 204f 6e65 486f 7445 6e63 6f64 6572  ': OneHotEncoder
-00022640: 2868 616e 646c 655f 756e 6b6e 6f77 6e3d  (handle_unknown=
-00022650: 2776 616c 7565 2729 2c20 2323 2320 7468  'value'), ### th
-00022660: 6973 2069 7320 666f 7220 6361 7465 676f  is is for catego
-00022670: 7279 5f65 6e63 6f64 6572 7320 7665 7273  ry_encoders vers
-00022680: 696f 6e0a 2020 2020 2020 2020 2020 2020  ion.            
-00022690: 2020 2020 2020 2020 276f 7264 696e 616c          'ordinal
-000226a0: 273a 204f 7264 696e 616c 456e 636f 6465  ': OrdinalEncode
-000226b0: 7228 292c 0a20 2020 2020 2020 2020 2020  r(),.           
-000226c0: 2020 2020 2020 2020 2027 6861 7368 696e           'hashin
-000226d0: 6727 3a20 4861 7368 696e 6745 6e63 6f64  g': HashingEncod
-000226e0: 6572 286e 5f63 6f6d 706f 6e65 6e74 733d  er(n_components=
-000226f0: 3230 2c20 6472 6f70 5f69 6e76 6172 6961  20, drop_invaria
-00022700: 6e74 3d54 7275 6529 2c0a 2020 2020 2020  nt=True),.      
-00022710: 2020 2020 2020 2020 2020 2020 2020 2768                'h
-00022720: 6173 6827 3a20 4861 7368 696e 6745 6e63  ash': HashingEnc
-00022730: 6f64 6572 286e 5f63 6f6d 706f 6e65 6e74  oder(n_component
-00022740: 733d 3230 2c20 6472 6f70 5f69 6e76 6172  s=20, drop_invar
-00022750: 6961 6e74 3d54 7275 6529 2c0a 2020 2020  iant=True),.    
-00022760: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00022770: 2763 6f75 6e74 273a 2043 6f75 6e74 456e  'count': CountEn
-00022780: 636f 6465 7228 6472 6f70 5f69 6e76 6172  coder(drop_invar
-00022790: 6961 6e74 3d54 7275 6529 2c0a 2020 2020  iant=True),.    
-000227a0: 2020 2020 2020 2020 2020 2020 2020 2020                  
-000227b0: 2763 6174 626f 6f73 7427 3a20 4361 7442  'catboost': CatB
-000227c0: 6f6f 7374 456e 636f 6465 7228 6472 6f70  oostEncoder(drop
-000227d0: 5f69 6e76 6172 6961 6e74 3d46 616c 7365  _invariant=False
-000227e0: 292c 0a20 2020 2020 2020 2020 2020 2020  ),.             
-000227f0: 2020 2020 2020 2027 7461 7267 6574 273a         'target':
-00022800: 2054 6172 6765 7445 6e63 6f64 6572 286d   TargetEncoder(m
-00022810: 696e 5f73 616d 706c 6573 5f6c 6561 663d  in_samples_leaf=
-00022820: 332c 2064 726f 705f 696e 7661 7269 616e  3, drop_invarian
-00022830: 743d 5472 7565 292c 0a20 2020 2020 2020  t=True),.       
-00022840: 2020 2020 2020 2020 2020 2020 2027 676c               'gl
-00022850: 6d27 3a20 474c 4d4d 456e 636f 6465 7228  m': GLMMEncoder(
-00022860: 6472 6f70 5f69 6e76 6172 6961 6e74 3d54  drop_invariant=T
-00022870: 7275 6529 2c0a 2020 2020 2020 2020 2020  rue),.          
-00022880: 2020 2020 2020 2020 2020 2767 6c6d 6d27            'glmm'
-00022890: 3a20 474c 4d4d 456e 636f 6465 7228 6472  : GLMMEncoder(dr
-000228a0: 6f70 5f69 6e76 6172 6961 6e74 3d54 7275  op_invariant=Tru
-000228b0: 6529 2c0a 2020 2020 2020 2020 2020 2020  e),.            
-000228c0: 2020 2020 2020 2020 2773 756d 273a 2053          'sum': S
-000228d0: 756d 456e 636f 6465 7228 6472 6f70 5f69  umEncoder(drop_i
-000228e0: 6e76 6172 6961 6e74 3d54 7275 6529 2c0a  nvariant=True),.
-000228f0: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00022900: 2020 2020 2777 6f65 273a 2057 4f45 456e      'woe': WOEEn
-00022910: 636f 6465 7228 7261 6e64 6f6d 697a 6564  coder(randomized
-00022920: 3d46 616c 7365 2c20 6472 6f70 5f69 6e76  =False, drop_inv
-00022930: 6172 6961 6e74 3d54 7275 6529 2c0a 2020  ariant=True),.  
-00022940: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00022950: 2020 2762 6463 273a 2042 6163 6b77 6172    'bdc': Backwar
-00022960: 6444 6966 6665 7265 6e63 6545 6e63 6f64  dDifferenceEncod
-00022970: 6572 2864 726f 705f 696e 7661 7269 616e  er(drop_invarian
-00022980: 743d 5472 7565 292c 0a20 2020 2020 2020  t=True),.       
-00022990: 2020 2020 2020 2020 2020 2020 2027 6264               'bd
-000229a0: 6527 3a20 4261 636b 7761 7264 4469 6666  e': BackwardDiff
-000229b0: 6572 656e 6365 456e 636f 6465 7228 6472  erenceEncoder(dr
-000229c0: 6f70 5f69 6e76 6172 6961 6e74 3d54 7275  op_invariant=Tru
-000229d0: 6529 2c0a 2020 2020 2020 2020 2020 2020  e),.            
-000229e0: 2020 2020 2020 2020 276c 6f6f 273a 204c          'loo': L
-000229f0: 6561 7665 4f6e 654f 7574 456e 636f 6465  eaveOneOutEncode
-00022a00: 7228 7369 676d 613d 302e 3130 2c20 6472  r(sigma=0.10, dr
-00022a10: 6f70 5f69 6e76 6172 6961 6e74 3d54 7275  op_invariant=Tru
-00022a20: 6529 2c0a 2020 2020 2020 2020 2020 2020  e),.            
-00022a30: 2020 2020 2020 2020 2762 6173 6527 3a20          'base': 
-00022a40: 4261 7365 4e45 6e63 6f64 6572 2862 6173  BaseNEncoder(bas
-00022a50: 653d 322c 2064 726f 705f 696e 7661 7269  e=2, drop_invari
-00022a60: 616e 743d 5472 7565 292c 0a20 2020 2020  ant=True),.     
-00022a70: 2020 2020 2020 2020 2020 2020 2020 2027                 '
-00022a80: 6a61 6d65 7327 3a20 4a61 6d65 7353 7465  james': JamesSte
-00022a90: 696e 456e 636f 6465 7228 6472 6f70 5f69  inEncoder(drop_i
-00022aa0: 6e76 6172 6961 6e74 3d54 7275 6529 2c0a  nvariant=True),.
-00022ab0: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00022ac0: 2020 2020 276a 616d 6573 7374 6569 6e27      'jamesstein'
-00022ad0: 3a20 4a61 6d65 7353 7465 696e 456e 636f  : JamesSteinEnco
-00022ae0: 6465 7228 6472 6f70 5f69 6e76 6172 6961  der(drop_invaria
-00022af0: 6e74 3d54 7275 6529 2c0a 2020 2020 2020  nt=True),.      
-00022b00: 2020 2020 2020 2020 2020 2020 2020 2768                'h
-00022b10: 656c 6d65 7274 273a 2048 656c 6d65 7274  elmert': Helmert
-00022b20: 456e 636f 6465 7228 6472 6f70 5f69 6e76  Encoder(drop_inv
-00022b30: 6172 6961 6e74 3d54 7275 6529 2c0a 2020  ariant=True),.  
-00022b40: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00022b50: 2020 2327 7375 6d6d 6172 7927 3a20 5375    #'summary': Su
-00022b60: 6d6d 6172 7945 6e63 6f64 6572 2864 726f  mmaryEncoder(dro
-00022b70: 705f 696e 7661 7269 616e 743d 5472 7565  p_invariant=True
-00022b80: 2c20 7175 616e 7469 6c65 733d 5b30 2e32  , quantiles=[0.2
-00022b90: 352c 2030 2e35 2c20 312e 305d 2c20 6d3d  5, 0.5, 1.0], m=
-00022ba0: 312e 3029 2c0a 2020 2020 2020 2020 2020  1.0),.          
-00022bb0: 2020 2020 2020 2020 2020 276c 6162 656c            'label
-00022bc0: 273a 204d 795f 4c61 6265 6c45 6e63 6f64  ': My_LabelEncod
-00022bd0: 6572 2829 2c0a 2020 2020 2020 2020 2020  er(),.          
-00022be0: 2020 2020 2020 2020 2020 2761 7574 6f27            'auto'
-00022bf0: 3a20 4d79 5f4c 6162 656c 456e 636f 6465  : My_LabelEncode
-00022c00: 7228 292c 0a20 2020 2020 2020 2020 2020  r(),.           
-00022c10: 2020 2020 2020 2020 207d 0a0a 2020 2020           }..    
-00022c20: 6e6f 6e5f 6f6e 655f 686f 745f 6c69 7374  non_one_hot_list
-00022c30: 203d 205b 276c 6162 656c 272c 276a 616d   = ['label','jam
-00022c40: 6573 272c 276a 616d 6573 7374 6569 6e27  es','jamesstein'
-00022c50: 2c27 6c6f 6f27 2c27 776f 6527 2c27 676c  ,'loo','woe','gl
-00022c60: 6d6d 272c 2767 6c6d 272c 2774 6172 6765  mm','glm','targe
-00022c70: 7427 2c27 6361 7462 6f6f 7374 272c 2763  t','catboost','c
-00022c80: 6f75 6e74 272c 276f 7264 696e 616c 275d  ount','ordinal']
-00022c90: 0a20 2020 2023 2323 2073 6574 2074 6865  .    ### set the
-00022ca0: 2062 6173 6963 2065 6e63 6f64 6572 2066   basic encoder f
-00022cb0: 6f72 206c 6f77 2063 6172 6469 6e61 6c69  or low cardinali
-00022cc0: 7479 2076 6172 7320 6865 7265 2023 2323  ty vars here ###
-00022cd0: 2323 230a 2020 2020 6265 203d 2065 6e63  ###.    be = enc
-00022ce0: 6f64 6572 5f64 6963 745b 6261 7369 635f  oder_dict[basic_
-00022cf0: 656e 636f 6465 725d 0a20 2020 2023 2323  encoder].    ###
-00022d00: 2320 5468 6573 6520 6172 6520 6170 706c  # These are appl
-00022d10: 6965 6420 666f 7220 6869 6768 2063 6172  ied for high car
-00022d20: 6469 6e61 6c69 7479 2076 6172 6961 626c  dinality variabl
-00022d30: 6573 2023 2323 2323 2323 230a 2020 2020  es ########.    
-00022d40: 6c65 203d 2065 6e63 6f64 6572 5f64 6963  le = encoder_dic
-00022d50: 745b 656e 636f 6465 725d 0a20 2020 2023  t[encoder].    #
-00022d60: 2323 2048 6f77 2064 6f20 7765 206d 616b  ## How do we mak
-00022d70: 6520 7375 7265 2074 6861 7420 7765 2063  e sure that we c
-00022d80: 7265 6174 6520 6f6e 6520 6e65 7720 4c45  reate one new LE
-00022d90: 5f50 6970 6520 666f 7220 6561 6368 2063  _Pipe for each c
-00022da0: 6174 7661 723f 2048 6572 6527 7320 6f6e  atvar? Here's on
-00022db0: 6520 7761 7920 746f 2064 6f20 6974 2e0a  e way to do it..
-00022dc0: 2020 2020 6c65 7020 3d20 4d79 5f4c 6162      lep = My_Lab
-00022dd0: 656c 456e 636f 6465 725f 5069 7065 2829  elEncoder_Pipe()
-00022de0: 0a20 2020 2023 2323 2323 2320 4a75 7374  .    ###### Just
-00022df0: 2061 2077 6172 6e69 6e67 2069 6e20 6361   a warning in ca
-00022e00: 7365 2073 6f6d 656f 6e65 2064 6f65 736e  se someone doesn
-00022e10: 2774 206b 6e6f 7720 6162 6f75 7420 6f6e  't know about on
-00022e20: 6520 686f 7420 656e 636f 6469 6e67 2023  e hot encoding #
-00022e30: 2323 230a 2020 2020 2323 2320 7468 6573  ###.    ### thes
-00022e40: 6520 656e 636f 6465 7273 2072 6573 756c  e encoders resul
-00022e50: 7420 696e 206d 6f72 6520 636f 6c75 6d6e  t in more column
-00022e60: 7320 7468 616e 2074 6865 206f 7269 6769  s than the origi
-00022e70: 6e61 6c20 2d20 6865 6e63 6520 7468 6579  nal - hence they
-00022e80: 2061 7265 2063 6f6e 7369 6465 7265 6420   are considered 
-00022e90: 6f6e 6520 686f 7420 7479 7065 2023 2323  one hot type ###
-00022ea0: 0a20 2020 206f 6e65 686f 745f 7479 7065  .    onehot_type
-00022eb0: 5f65 6e63 6f64 6572 7320 3d20 5b27 6f6e  _encoders = ['on
-00022ec0: 6568 6f74 272c 2027 6865 6c6d 6572 7427  ehot', 'helmert'
-00022ed0: 2c27 6264 6327 2c20 2762 6465 272c 2027  ,'bdc', 'bde', '
-00022ee0: 6861 7368 696e 6727 2c27 6861 7368 272c  hashing','hash',
-00022ef0: 2773 756d 272c 2762 6173 6527 2c20 0a20  'sum','base', . 
-00022f00: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00022f10: 2020 2020 2020 2020 2020 2020 2020 2023                 #
-00022f20: 2771 7561 6e74 696c 6527 2c0a 2020 2020  'quantile',.    
-00022f30: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00022f40: 2020 2020 2020 2020 2020 2020 2327 7375              #'su
-00022f50: 6d6d 6172 7927 0a20 2020 2020 2020 2020  mmary'.         
-00022f60: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00022f70: 2020 2020 2020 205d 0a0a 2020 2020 6966         ]..    if
-00022f80: 2062 6173 6963 5f65 6e63 6f64 6572 2069   basic_encoder i
-00022f90: 6e20 6f6e 6568 6f74 5f74 7970 655f 656e  n onehot_type_en
-00022fa0: 636f 6465 7273 206f 7220 656e 636f 6465  coders or encode
-00022fb0: 7220 696e 206f 6e65 686f 745f 7479 7065  r in onehot_type
-00022fc0: 5f65 6e63 6f64 6572 733a 0a20 2020 2020  _encoders:.     
-00022fd0: 2020 2069 6620 7665 7262 6f73 653a 0a20     if verbose:. 
-00022fe0: 2020 2020 2020 2020 2020 2070 7269 6e74             print
-00022ff0: 2827 2020 2020 4265 7761 7265 2120 2573  ('    Beware! %s
-00023000: 2065 6e63 6f64 696e 6720 6361 6e20 6372   encoding can cr
-00023010: 6561 7465 2068 756e 6472 6564 7320 6966  eate hundreds if
-00023020: 206e 6f74 2031 3030 3073 206f 6620 7661   not 1000s of va
-00023030: 7269 6162 6c65 732e 2e2e 2720 2562 6173  riables...' %bas
-00023040: 6963 5f65 6e63 6f64 6572 290a 2020 2020  ic_encoder).    
-00023050: 2020 2020 656c 7365 3a0a 2020 2020 2020      else:.      
-00023060: 2020 2020 2020 7061 7373 0a20 2020 2023        pass.    #
-00023070: 2323 204e 6f77 2074 7279 2074 6865 206f  ## Now try the o
-00023080: 7468 6572 2065 6e63 6f64 6572 7320 7468  ther encoders th
-00023090: 6174 2075 7365 7220 6861 7320 6769 7665  at user has give
-000230a0: 6e20 6173 2069 6e70 7574 2023 2323 2323  n as input #####
-000230b0: 2323 2323 2323 2323 2323 2323 2323 230a  ###############.
-000230c0: 2020 2020 6966 2065 6e63 6f64 6572 2069      if encoder i
-000230d0: 6e20 5b27 6861 7368 696e 6727 2c27 6861  n ['hashing','ha
-000230e0: 7368 275d 206f 7220 6261 7369 635f 656e  sh'] or basic_en
-000230f0: 636f 6465 7220 696e 205b 2768 6173 6869  coder in ['hashi
-00023100: 6e67 272c 2027 6861 7368 275d 3a0a 2020  ng', 'hash']:.  
-00023110: 2020 2020 2020 6966 2076 6572 626f 7365        if verbose
-00023120: 3a0a 2020 2020 2020 2020 2020 2020 7072  :.            pr
-00023130: 696e 7428 2720 2020 2042 6577 6172 6521  int('    Beware!
-00023140: 2048 6173 6869 6e67 2065 6e63 6f64 6572   Hashing encoder
-00023150: 7320 6361 6e20 7461 6b65 2061 2072 6561  s can take a rea
-00023160: 6c20 6c6f 6e67 2074 696d 6520 666f 7220  l long time for 
-00023170: 6576 656e 2073 6d61 6c6c 2064 6174 6120  even small data 
-00023180: 7365 7473 2127 290a 2020 2020 2020 2020  sets!').        
-00023190: 656c 7365 3a0a 2020 2020 2020 2020 2020  else:.          
-000231a0: 2020 7061 7373 0a20 2020 2065 6c69 6620    pass.    elif 
-000231b0: 656e 636f 6465 7220 696e 206e 6f6e 5f6f  encoder in non_o
-000231c0: 6e65 5f68 6f74 5f6c 6973 7420 6f72 2062  ne_hot_list or b
-000231d0: 6173 6963 5f65 6e63 6f64 6572 2069 6e20  asic_encoder in 
-000231e0: 6e6f 6e5f 6f6e 655f 686f 745f 6c69 7374  non_one_hot_list
-000231f0: 3a0a 2020 2020 2020 2020 6966 2076 6572  :.        if ver
-00023200: 626f 7365 3a0a 2020 2020 2020 2020 2020  bose:.          
-00023210: 2020 7072 696e 7428 2725 7320 656e 636f    print('%s enco
-00023220: 6465 7220 7365 6c65 6374 6564 2066 6f72  der selected for
-00023230: 2074 7261 6e73 666f 726d 696e 6720 616c   transforming al
-00023240: 6c20 6361 7465 676f 7269 6361 6c20 7661  l categorical va
-00023250: 7269 6162 6c65 7327 2025 656e 636f 6465  riables' %encode
-00023260: 7229 0a20 2020 2065 6c73 653a 0a20 2020  r).    else:.   
-00023270: 2020 2020 2070 7269 6e74 2827 2573 2065       print('%s e
-00023280: 6e63 6f64 6572 206e 6f74 2066 6f75 6e64  ncoder not found
-00023290: 2069 6e20 6c69 7374 206f 6620 656e 636f   in list of enco
-000232a0: 6465 7273 2e20 5573 696e 6720 6175 746f  ders. Using auto
-000232b0: 2069 6e73 7465 6164 2720 2565 6e63 6f64   instead' %encod
-000232c0: 6572 290a 2020 2020 2020 2020 656e 636f  er).        enco
-000232d0: 6465 7273 203d 2027 6175 746f 270a 2020  ders = 'auto'.  
-000232e0: 2020 2020 2020 6261 7369 635f 656e 636f        basic_enco
-000232f0: 6465 7220 3d20 276c 6162 656c 270a 2020  der = 'label'.  
-00023300: 2020 2020 2020 656e 636f 6465 7220 3d20        encoder = 
-00023310: 276c 6162 656c 270a 0a0a 2020 2020 2323  'label'...    ##
-00023320: 2323 2323 2323 2323 2323 2323 2323 2323  ################
-00023330: 2323 2323 2323 2323 2323 2323 2323 2323  ################
-00023340: 2323 2323 2323 2323 2323 2323 2323 2323  ################
-00023350: 2323 2323 2323 2323 2323 2323 2323 2323  ################
-00023360: 2323 2323 2323 2323 2323 2323 2323 2323  ################
-00023370: 2323 2323 0a20 2020 2023 2323 2320 2020  ####.    ####   
-00023380: 2020 2020 2020 2054 6869 7320 6973 2077         This is w
-00023390: 6865 7265 2077 6520 636f 6e76 6572 7420  here we convert 
-000233a0: 616c 6c20 7468 6520 656e 636f 6465 7273  all the encoders
-000233b0: 2074 6f20 7069 7065 6c69 6e65 2063 6f6d   to pipeline com
-000233c0: 706f 6e65 6e74 7320 2020 2023 2323 230a  ponents    ####.
-000233d0: 2020 2020 2323 2323 2323 2323 2323 2323      ############
-000233e0: 2323 2323 2323 2323 2323 2323 2323 2323  ################
-000233f0: 2323 2323 2323 2323 2323 2323 2323 2323  ################
-00023400: 2323 2323 2323 2323 2323 2323 2323 2323  ################
-00023410: 2323 2323 2323 2323 2323 2323 2323 2323  ################
-00023420: 2323 2323 2323 2323 2323 0a20 2020 2069  ##########.    i
-00023430: 6620 7665 7262 6f73 653a 0a20 2020 2020  f verbose:.     
-00023440: 2020 2070 7269 6e74 2827 5573 696e 6720     print('Using 
-00023450: 2573 2061 6e64 2025 7320 6173 2065 6e63  %s and %s as enc
-00023460: 6f64 6572 7327 2025 2862 652c 6c65 2929  oders' %(be,le))
-00023470: 0a20 2020 2069 6d70 5f6d 6973 7369 6e67  .    imp_missing
-00023480: 203d 2053 696d 706c 6549 6d70 7574 6572   = SimpleImputer
-00023490: 2873 7472 6174 6567 793d 2763 6f6e 7374  (strategy='const
-000234a0: 616e 7427 2c20 6669 6c6c 5f76 616c 7565  ant', fill_value
-000234b0: 3d27 6d69 7373 696e 6727 290a 2020 2020  ='missing').    
-000234c0: 696d 7020 3d20 5369 6d70 6c65 496d 7075  imp = SimpleImpu
-000234d0: 7465 7228 7374 7261 7465 6779 3d27 636f  ter(strategy='co
-000234e0: 6e73 7461 6e74 272c 6669 6c6c 5f76 616c  nstant',fill_val
-000234f0: 7565 3d2d 3939 290a 2020 2020 636f 6e76  ue=-99).    conv
-00023500: 6572 745f 6365 5f74 6f5f 7069 7065 5f66  ert_ce_to_pipe_f
-00023510: 756e 6320 3d20 4675 6e63 7469 6f6e 5472  unc = FunctionTr
-00023520: 616e 7366 6f72 6d65 7228 636f 6e76 6572  ansformer(conver
-00023530: 745f 6365 5f74 6f5f 7069 7065 290a 2020  t_ce_to_pipe).  
-00023540: 2020 7263 6320 3d20 5261 7265 5f43 6c61    rcc = Rare_Cla
-00023550: 7373 5f43 6f6d 6269 6e65 725f 5069 7065  ss_Combiner_Pipe
-00023560: 2829 0a20 2020 2069 6620 636f 6d62 696e  ().    if combin
-00023570: 655f 7261 7265 5f66 6c61 673a 0a20 2020  e_rare_flag:.   
-00023580: 2020 2020 2070 7269 6e74 2827 2020 2020       print('    
-00023590: 636f 6d62 696e 696e 6720 7261 7265 2063  combining rare c
-000235a0: 6c61 7373 6573 2066 6f72 2063 6174 6567  lasses for categ
-000235b0: 6f72 6963 616c 2061 6e64 2064 6973 6372  orical and discr
-000235c0: 6574 6520 7661 7273 2061 7320 6769 7665  ete vars as give
-000235d0: 6e2e 2e2e 2729 0a0a 2020 2020 2323 2323  n...')..    ####
-000235e0: 206c 6570 5f6f 6e65 2069 7320 7468 6520   lep_one is the 
-000235f0: 6261 7369 6320 656e 636f 6465 7220 6f66  basic encoder of
-00023600: 2063 6174 2076 6172 6961 626c 6573 2023   cat variables #
-00023610: 2323 2323 2323 2323 2323 230a 2020 2020  ###########.    
-00023620: 6966 2062 6173 6963 5f65 6e63 6f64 6572  if basic_encoder
-00023630: 203d 3d20 276c 6162 656c 273a 0a20 2020   == 'label':.   
-00023640: 2020 2020 2023 2323 2323 2320 2043 7265       ######  Cre
-00023650: 6174 6520 6120 6675 6e63 7469 6f6e 2063  ate a function c
-00023660: 616c 6c65 6420 6472 6f70 5f73 6563 6f6e  alled drop_secon
-00023670: 645f 636f 6c20 7468 6174 2064 726f 7073  d_col that drops
-00023680: 2074 6865 2073 6563 6f6e 6420 756e 6e65   the second unne
-00023690: 6365 7373 6172 7920 636f 6c75 6d6e 2069  cessary column i
-000236a0: 6e20 4d79 5f4c 6162 656c 5f45 6e63 6f64  n My_Label_Encod
-000236b0: 6572 0a20 2020 2020 2020 2064 726f 705f  er.        drop_
-000236c0: 7365 636f 6e64 5f63 6f6c 5f66 756e 6320  second_col_func 
-000236d0: 3d20 4675 6e63 7469 6f6e 5472 616e 7366  = FunctionTransf
-000236e0: 6f72 6d65 7228 6472 6f70 5f73 6563 6f6e  ormer(drop_secon
-000236f0: 645f 636f 6c29 0a20 2020 2020 2020 2023  d_col).        #
-00023700: 2323 2320 4e6f 7720 636f 6d62 696e 6520  ### Now combine 
-00023710: 6974 2077 6974 6820 7468 6520 4c61 6265  it with the Labe
-00023720: 6c45 6e63 6f64 6572 2074 6f20 6d61 6b65  lEncoder to make
-00023730: 2069 7420 7275 6e20 736d 6f6f 7468 6c79   it run smoothly
-00023740: 2069 6e20 6120 5069 7065 2023 230a 2020   in a Pipe ##.  
-00023750: 2020 2020 2020 6966 2063 6f6d 6269 6e65        if combine
-00023760: 5f72 6172 655f 666c 6167 3a0a 2020 2020  _rare_flag:.    
-00023770: 2020 2020 2020 2020 2323 2320 6c65 705f          ### lep_
-00023780: 6f6e 6520 7573 6573 2072 6172 655f 636c  one uses rare_cl
-00023790: 6173 735f 636f 6d62 696e 6572 2077 6974  ass_combiner wit
-000237a0: 6820 4d79 5f4c 6162 656c 456e 636f 6465  h My_LabelEncode
-000237b0: 7220 746f 2066 6972 7374 206c 6162 656c  r to first label
-000237c0: 2065 6e63 6f64 6520 616e 6420 7468 656e   encode and then
-000237d0: 2064 726f 7020 7468 6520 7365 636f 6e64   drop the second
-000237e0: 2075 6e75 7365 6420 636f 6c75 6d6e 2023   unused column #
-000237f0: 230a 2020 2020 2020 2020 2020 2020 6c65  #.            le
-00023800: 705f 6f6e 6520 3d20 5069 7065 6c69 6e65  p_one = Pipeline
-00023810: 285b 2827 7261 7265 5f63 6c61 7373 5f63  ([('rare_class_c
-00023820: 6f6d 6269 6e65 7227 2c20 7263 6329 2c20  ombiner', rcc), 
-00023830: 2827 6261 7369 635f 656e 636f 6465 7227  ('basic_encoder'
-00023840: 2c20 6c65 7029 2c20 2827 6472 6f70 5f73  , lep), ('drop_s
-00023850: 6563 6f6e 645f 636f 6c75 6d6e 272c 2064  econd_column', d
-00023860: 726f 705f 7365 636f 6e64 5f63 6f6c 5f66  rop_second_col_f
-00023870: 756e 6329 5d29 0a20 2020 2020 2020 2065  unc)]).        e
-00023880: 6c73 653a 0a20 2020 2020 2020 2020 2020  lse:.           
-00023890: 2023 2323 206c 6570 5f6f 6e65 2075 7365   ### lep_one use
-000238a0: 7320 4d79 5f4c 6162 656c 456e 636f 6465  s My_LabelEncode
-000238b0: 7220 746f 2066 6972 7374 206c 6162 656c  r to first label
-000238c0: 2065 6e63 6f64 6520 616e 6420 7468 656e   encode and then
-000238d0: 2064 726f 7020 7468 6520 7365 636f 6e64   drop the second
-000238e0: 2075 6e75 7365 6420 636f 6c75 6d6e 2023   unused column #
-000238f0: 230a 2020 2020 2020 2020 2020 2020 6c65  #.            le
-00023900: 705f 6f6e 6520 3d20 5069 7065 6c69 6e65  p_one = Pipeline
-00023910: 285b 2827 6261 7369 635f 656e 636f 6465  ([('basic_encode
-00023920: 7227 2c20 6c65 7029 2c20 2827 6472 6f70  r', lep), ('drop
-00023930: 5f73 6563 6f6e 645f 636f 6c75 6d6e 272c  _second_column',
-00023940: 2064 726f 705f 7365 636f 6e64 5f63 6f6c   drop_second_col
-00023950: 5f66 756e 6329 5d29 0a20 2020 2065 6c73  _func)]).    els
-00023960: 653a 0a20 2020 2020 2020 2069 6620 636f  e:.        if co
-00023970: 6d62 696e 655f 7261 7265 5f66 6c61 673a  mbine_rare_flag:
-00023980: 0a20 2020 2020 2020 2020 2020 206c 6570  .            lep
-00023990: 5f6f 6e65 203d 2050 6970 656c 696e 6528  _one = Pipeline(
-000239a0: 5b28 2772 6172 655f 636c 6173 735f 636f  [('rare_class_co
-000239b0: 6d62 696e 6572 272c 2072 6363 292c 2827  mbiner', rcc),('
-000239c0: 636f 6e76 6572 745f 4345 5f74 6f5f 7069  convert_CE_to_pi
-000239d0: 7065 272c 2063 6f6e 7665 7274 5f63 655f  pe', convert_ce_
-000239e0: 746f 5f70 6970 655f 6675 6e63 292c 2028  to_pipe_func), (
-000239f0: 2762 6173 6963 5f65 6e63 6f64 6572 272c  'basic_encoder',
-00023a00: 2062 6529 5d29 0a20 2020 2020 2020 2065   be)]).        e
-00023a10: 6c73 653a 0a20 2020 2020 2020 2020 2020  lse:.           
-00023a20: 206c 6570 5f6f 6e65 203d 2050 6970 656c   lep_one = Pipel
-00023a30: 696e 6528 5b28 2763 6f6e 7665 7274 5f43  ine([('convert_C
-00023a40: 455f 746f 5f70 6970 6527 2c20 636f 6e76  E_to_pipe', conv
-00023a50: 6572 745f 6365 5f74 6f5f 7069 7065 5f66  ert_ce_to_pipe_f
-00023a60: 756e 6329 2c20 2827 6261 7369 635f 656e  unc), ('basic_en
-00023a70: 636f 6465 7227 2c20 6265 295d 290a 2020  coder', be)]).  
-00023a80: 2020 2323 2323 206c 6570 5f74 776f 2061    #### lep_two a
-00023a90: 6374 7320 6173 2074 6865 206d 616a 6f72  cts as the major
-00023aa0: 2065 6e63 6f64 6572 206f 6620 6469 7363   encoder of disc
-00023ab0: 7265 7465 2073 7472 696e 6720 7661 7269  rete string vari
-00023ac0: 6162 6c65 7320 2323 2323 2323 2323 2323  ables ##########
-00023ad0: 2323 0a20 2020 2069 6620 656e 636f 6465  ##.    if encode
-00023ae0: 7220 3d3d 2027 6c61 6265 6c27 3a0a 2020  r == 'label':.  
-00023af0: 2020 2020 2020 2323 2323 2323 2020 4372        ######  Cr
-00023b00: 6561 7465 2061 2066 756e 6374 696f 6e20  eate a function 
-00023b10: 6361 6c6c 6564 2064 726f 705f 7365 636f  called drop_seco
-00023b20: 6e64 5f63 6f6c 2074 6861 7420 6472 6f70  nd_col that drop
-00023b30: 7320 7468 6520 7365 636f 6e64 2075 6e6e  s the second unn
-00023b40: 6563 6573 7361 7279 2063 6f6c 756d 6e20  ecessary column 
-00023b50: 696e 204d 795f 4c61 6265 6c5f 456e 636f  in My_Label_Enco
-00023b60: 6465 720a 2020 2020 2020 2020 6472 6f70  der.        drop
-00023b70: 5f73 6563 6f6e 645f 636f 6c5f 6675 6e63  _second_col_func
-00023b80: 203d 2046 756e 6374 696f 6e54 7261 6e73   = FunctionTrans
-00023b90: 666f 726d 6572 2864 726f 705f 7365 636f  former(drop_seco
-00023ba0: 6e64 5f63 6f6c 290a 2020 2020 2020 2020  nd_col).        
-00023bb0: 2323 2323 204e 6f77 2063 6f6d 6269 6e65  #### Now combine
-00023bc0: 2069 7420 7769 7468 2074 6865 204c 6162   it with the Lab
-00023bd0: 656c 456e 636f 6465 7220 746f 206d 616b  elEncoder to mak
-00023be0: 6520 6974 2072 756e 2073 6d6f 6f74 686c  e it run smoothl
-00023bf0: 7920 696e 2061 2050 6970 6520 2323 0a20  y in a Pipe ##. 
-00023c00: 2020 2020 2020 2069 6620 636f 6d62 696e         if combin
-00023c10: 655f 7261 7265 5f66 6c61 673a 0a20 2020  e_rare_flag:.   
-00023c20: 2020 2020 2020 2020 2023 2323 206c 6570           ### lep
-00023c30: 5f6f 6e65 2075 7365 7320 7261 7265 5f63  _one uses rare_c
-00023c40: 6c61 7373 5f63 6f6d 6269 6e65 7220 4d79  lass_combiner My
-00023c50: 5f4c 6162 656c 456e 636f 6465 7220 746f  _LabelEncoder to
-00023c60: 2066 6972 7374 206c 6162 656c 2065 6e63   first label enc
-00023c70: 6f64 6520 616e 6420 7468 656e 2064 726f  ode and then dro
-00023c80: 7020 7468 6520 7365 636f 6e64 2075 6e75  p the second unu
-00023c90: 7365 6420 636f 6c75 6d6e 2023 230a 2020  sed column ##.  
-00023ca0: 2020 2020 2020 2020 2020 6c65 705f 7477            lep_tw
-00023cb0: 6f20 3d20 5069 7065 6c69 6e65 285b 2827  o = Pipeline([('
-00023cc0: 7261 7265 5f63 6c61 7373 5f63 6f6d 6269  rare_class_combi
-00023cd0: 6e65 7227 2c20 7263 6329 2c20 2827 6261  ner', rcc), ('ba
-00023ce0: 7369 635f 656e 636f 6465 7227 2c20 6c65  sic_encoder', le
-00023cf0: 7029 2c20 2827 6472 6f70 5f73 6563 6f6e  p), ('drop_secon
-00023d00: 645f 636f 6c75 6d6e 272c 2064 726f 705f  d_column', drop_
-00023d10: 7365 636f 6e64 5f63 6f6c 5f66 756e 6329  second_col_func)
-00023d20: 5d29 0a20 2020 2020 2020 2065 6c73 653a  ]).        else:
-00023d30: 0a20 2020 2020 2020 2020 2020 2023 2323  .            ###
-00023d40: 206c 6570 5f6f 6e65 2075 7365 7320 4d79   lep_one uses My
-00023d50: 5f4c 6162 656c 456e 636f 6465 7220 746f  _LabelEncoder to
-00023d60: 2066 6972 7374 206c 6162 656c 2065 6e63   first label enc
-00023d70: 6f64 6520 616e 6420 7468 656e 2064 726f  ode and then dro
-00023d80: 7020 7468 6520 7365 636f 6e64 2075 6e75  p the second unu
-00023d90: 7365 6420 636f 6c75 6d6e 2023 230a 2020  sed column ##.  
-00023da0: 2020 2020 2020 2020 2020 6c65 705f 7477            lep_tw
-00023db0: 6f20 3d20 5069 7065 6c69 6e65 285b 2827  o = Pipeline([('
-00023dc0: 6261 7369 635f 656e 636f 6465 7227 2c20  basic_encoder', 
-00023dd0: 6c65 7029 2c20 2827 6472 6f70 5f73 6563  lep), ('drop_sec
-00023de0: 6f6e 645f 636f 6c75 6d6e 272c 2064 726f  ond_column', dro
-00023df0: 705f 7365 636f 6e64 5f63 6f6c 5f66 756e  p_second_col_fun
-00023e00: 6329 5d29 0a20 2020 2065 6c73 653a 0a20  c)]).    else:. 
-00023e10: 2020 2020 2020 2023 6c65 705f 7477 6f20         #lep_two 
-00023e20: 3d20 6d61 6b65 5f70 6970 656c 696e 6528  = make_pipeline(
-00023e30: 636f 6e76 6572 745f 6365 5f74 6f5f 7069  convert_ce_to_pi
-00023e40: 7065 5f66 756e 632c 206c 6529 0a20 2020  pe_func, le).   
-00023e50: 2020 2020 2069 6620 636f 6d62 696e 655f       if combine_
-00023e60: 7261 7265 5f66 6c61 673a 0a20 2020 2020  rare_flag:.     
-00023e70: 2020 2020 2020 206c 6570 5f74 776f 203d         lep_two =
-00023e80: 2050 6970 656c 696e 6528 5b28 2772 6172   Pipeline([('rar
-00023e90: 655f 636c 6173 735f 636f 6d62 696e 6572  e_class_combiner
-00023ea0: 272c 2072 6363 292c 2028 2763 6f6e 7665  ', rcc), ('conve
-00023eb0: 7274 5f43 455f 746f 5f70 6970 6527 2c20  rt_CE_to_pipe', 
-00023ec0: 636f 6e76 6572 745f 6365 5f74 6f5f 7069  convert_ce_to_pi
-00023ed0: 7065 5f66 756e 6329 2c20 2827 6261 7369  pe_func), ('basi
-00023ee0: 635f 656e 636f 6465 7227 2c20 6c65 295d  c_encoder', le)]
-00023ef0: 290a 2020 2020 2020 2020 656c 7365 3a0a  ).        else:.
-00023f00: 2020 2020 2020 2020 2020 2020 6c65 705f              lep_
-00023f10: 7477 6f20 3d20 5069 7065 6c69 6e65 285b  two = Pipeline([
-00023f20: 2827 636f 6e76 6572 745f 4345 5f74 6f5f  ('convert_CE_to_
-00023f30: 7069 7065 272c 2063 6f6e 7665 7274 5f63  pipe', convert_c
-00023f40: 655f 746f 5f70 6970 655f 6675 6e63 292c  e_to_pipe_func),
-00023f50: 2028 2762 6173 6963 5f65 6e63 6f64 6572   ('basic_encoder
-00023f60: 272c 206c 6529 5d29 0a20 2020 2023 2323  ', le)]).    ###
-00023f70: 2323 2323 2323 2323 2323 2323 2323 2323  ################
-00023f80: 2323 2323 2323 2323 2323 2323 2323 2323  ################
-00023f90: 2323 2323 2323 2323 2323 2323 2323 2323  ################
-00023fa0: 2323 2323 2323 2323 2323 2323 2323 2323  ################
+00016e80: 2323 2323 2323 2323 2323 2323 2323 2323  ################
+00016e90: 2323 2323 2323 2323 2323 2323 2323 2323  ################
+00016ea0: 2323 2323 2323 230a 2320 2323 2046 6972  #######.# ## Fir
+00016eb0: 7374 2079 6f75 206e 6565 6420 746f 2063  st you need to c
+00016ec0: 6c61 7373 6966 7920 7661 7269 6162 6c65  lassify variable
+00016ed0: 7320 696e 746f 2064 6966 6665 7265 6e74  s into different
+00016ee0: 2074 7970 6573 2e20 4f6e 6c79 2074 6865   types. Only the
+00016ef0: 6e20 6361 6e20 796f 7520 646f 2074 6865  n can you do the
+00016f00: 2063 6f72 7265 6374 2074 7261 6e73 666f   correct transfo
+00016f10: 726d 6174 696f 6e73 2e0a 6465 6620 636c  rmations..def cl
+00016f20: 6173 7369 6679 5f76 6172 735f 7061 6e64  assify_vars_pand
+00016f30: 6173 2864 662c 2076 6572 626f 7365 3d30  as(df, verbose=0
+00016f40: 293a 0a20 2020 2022 2222 0a20 2020 2023  ):.    """.    #
+00016f50: 2323 2323 2323 2323 2323 2323 2323 2323  ################
+00016f60: 2323 2323 2323 2323 2323 2323 2323 2323  ################
+00016f70: 2323 2323 2323 2323 2323 2323 2323 2323  ################
+00016f80: 2323 2323 2323 2323 2323 2323 2323 2323  ################
+00016f90: 2323 2323 2323 2323 2323 2323 2323 2323  ################
+00016fa0: 2323 2323 2323 2323 2323 2323 2323 230a  ###############.
+00016fb0: 2020 2020 5061 6e64 6173 2073 656c 6563      Pandas selec
+00016fc0: 745f 6474 7970 6573 206d 616b 6573 2063  t_dtypes makes c
+00016fd0: 6c61 7373 6966 7969 6e67 2076 6172 6961  lassifying varia
+00016fe0: 626c 6573 2061 2062 7265 657a 652e 2059  bles a breeze. Y
+00016ff0: 6f75 2073 686f 756c 6420 6368 6563 6b20  ou should check 
+00017000: 6f75 7420 7468 6520 6c69 6e6b 7320 6865  out the links he
+00017010: 7265 3a0a 2020 2020 6874 7470 733a 2f2f  re:.    https://
+00017020: 7061 6e64 6173 2e70 7964 6174 612e 6f72  pandas.pydata.or
+00017030: 672f 646f 6373 2f72 6566 6572 656e 6365  g/docs/reference
+00017040: 2f61 7069 2f70 616e 6461 732e 4461 7461  /api/pandas.Data
+00017050: 4672 616d 652e 7365 6c65 6374 5f64 7479  Frame.select_dty
+00017060: 7065 732e 6874 6d6c 0a20 2020 2023 2323  pes.html.    ###
+00017070: 2323 2323 2323 2323 2323 2323 2323 2323  ################
+00017080: 2323 2323 2323 2323 2323 2323 2323 2323  ################
+00017090: 2323 2323 2323 2323 2323 2323 2323 2323  ################
+000170a0: 2323 2323 2323 2323 2323 2323 2323 2323  ################
+000170b0: 2323 2323 2323 2323 2323 2323 2323 2323  ################
+000170c0: 2323 2323 2323 2323 2323 2323 230a 2020  #############.  
+000170d0: 2020 2222 220a 2020 2020 2323 2320 6e75    """.    ### nu
+000170e0: 6d62 6572 206f 6620 6361 7465 676f 7269  mber of categori
+000170f0: 6573 2069 6e20 6120 636f 6c75 6d6e 2062  es in a column b
+00017100: 656c 6f77 2077 6869 6368 2069 7420 6973  elow which it is
+00017110: 2063 6f6e 7369 6465 7265 6420 6120 6361   considered a ca
+00017120: 7465 676f 7269 616c 2076 6172 2023 230a  tegorial var ##.
+00017130: 2020 2020 6361 7465 676f 7279 5f6c 696d      category_lim
+00017140: 6974 203d 2033 3020 0a20 2020 206e 6c70  it = 30 .    nlp
+00017150: 5f74 6872 6573 686f 6c64 203d 2035 300a  _threshold = 50.
+00017160: 2020 2020 7661 725f 6469 6374 203d 2064      var_dict = d
+00017170: 6566 6175 6c74 6469 6374 286c 6973 7429  efaultdict(list)
+00017180: 0a20 2020 2023 2323 2320 546f 2073 656c  .    #### To sel
+00017190: 6563 7420 616c 6c20 6e75 6d65 7269 6320  ect all numeric 
+000171a0: 7479 7065 732c 2075 7365 206e 702e 6e75  types, use np.nu
+000171b0: 6d62 6572 206f 7220 276e 756d 6265 7227  mber or 'number'
+000171c0: 0a20 2020 2069 6e74 7661 7273 203d 2064  .    intvars = d
+000171d0: 662e 7365 6c65 6374 5f64 7479 7065 7328  f.select_dtypes(
+000171e0: 696e 636c 7564 653d 2769 6e74 6567 6572  include='integer
+000171f0: 2729 2e63 6f6c 756d 6e73 2e74 6f6c 6973  ').columns.tolis
+00017200: 7428 290a 2020 2020 2323 2320 4265 6361  t().    ### Beca
+00017210: 7573 6520 6f66 2064 6966 6665 7265 6e63  use of differenc
+00017220: 6573 2069 6e20 7061 6e64 6173 2076 6572  es in pandas ver
+00017230: 7369 6f6e 732c 2066 6c6f 6174 7320 646f  sions, floats do
+00017240: 6e27 7420 6765 7420 6465 7465 6374 6564  n't get detected
+00017250: 2065 6173 696c 790a 2020 2020 2323 2320   easily.    ### 
+00017260: 2048 656e 6365 2049 2061 6d20 666f 7263   Hence I am forc
+00017270: 6564 2074 6f20 7772 6974 6520 636c 756d  ed to write clum
+00017280: 7369 6c79 206c 696b 6520 7468 6973 2e20  sily like this. 
+00017290: 446f 6e27 7420 6368 616e 6765 2074 6865  Don't change the
+000172a0: 206e 6578 7420 6c69 6e65 2121 0a20 2020   next line!!.   
+000172b0: 2066 6c6f 6174 7661 7273 203d 2064 662e   floatvars = df.
+000172c0: 7365 6c65 6374 5f64 7479 7065 7328 696e  select_dtypes(in
+000172d0: 636c 7564 653d 2766 6c6f 6174 3136 2729  clude='float16')
+000172e0: 2e63 6f6c 756d 6e73 2e74 6f6c 6973 7428  .columns.tolist(
+000172f0: 2920 2b20 6466 2e73 656c 6563 745f 6474  ) + df.select_dt
+00017300: 7970 6573 280a 2020 2020 2020 2020 2020  ypes(.          
+00017310: 2020 2020 2020 696e 636c 7564 653d 2766        include='f
+00017320: 6c6f 6174 3332 2729 2e63 6f6c 756d 6e73  loat32').columns
+00017330: 2e74 6f6c 6973 7428 2920 2b20 6466 2e73  .tolist() + df.s
+00017340: 656c 6563 745f 6474 7970 6573 2869 6e63  elect_dtypes(inc
+00017350: 6c75 6465 3d27 666c 6f61 7436 3427 292e  lude='float64').
+00017360: 636f 6c75 6d6e 732e 746f 6c69 7374 2829  columns.tolist()
+00017370: 0a20 2020 2069 6e66 5f63 6f6c 7320 3d20  .    inf_cols = 
+00017380: 4544 415f 6669 6e64 5f72 656d 6f76 655f  EDA_find_remove_
+00017390: 636f 6c75 6d6e 735f 7769 7468 5f69 6e66  columns_with_inf
+000173a0: 696e 6974 7928 6466 290a 2020 2020 6e75  inity(df).    nu
+000173b0: 6d76 6172 7320 3d20 6c65 6674 5f73 7562  mvars = left_sub
+000173c0: 7472 6163 7428 666c 6f61 7476 6172 732c  tract(floatvars,
+000173d0: 2069 6e66 5f63 6f6c 7329 0a20 2020 2076   inf_cols).    v
+000173e0: 6172 5f64 6963 745b 2763 6f6e 7469 6e75  ar_dict['continu
+000173f0: 6f75 735f 7661 7273 275d 203d 2066 6c6f  ous_vars'] = flo
+00017400: 6174 7661 7273 0a20 2020 2076 6172 5f64  atvars.    var_d
+00017410: 6963 745b 2769 6e74 5f76 6172 7327 5d20  ict['int_vars'] 
+00017420: 3d20 696e 7476 6172 730a 2020 2020 2323  = intvars.    ##
+00017430: 2323 2054 6f20 7365 6c65 6374 2073 7472  ## To select str
+00017440: 696e 6773 2079 6f75 206d 7573 7420 7573  ings you must us
+00017450: 6520 7468 6520 6f62 6a65 6374 2064 7479  e the object dty
+00017460: 7065 2c20 6275 7420 6e6f 7465 2074 6861  pe, but note tha
+00017470: 7420 7468 6973 2077 696c 6c20 7265 7475  t this will retu
+00017480: 726e 2061 6c6c 206f 626a 6563 7420 6474  rn all object dt
+00017490: 7970 6520 636f 6c75 6d6e 730a 2020 2020  ype columns.    
+000174a0: 7374 7269 6e67 7661 7273 203d 2064 662e  stringvars = df.
+000174b0: 7365 6c65 6374 5f64 7479 7065 7328 696e  select_dtypes(in
+000174c0: 636c 7564 653d 276f 626a 6563 7427 292e  clude='object').
+000174d0: 636f 6c75 6d6e 732e 746f 6c69 7374 2829  columns.tolist()
+000174e0: 0a20 2020 2064 6973 6372 6574 655f 7661  .    discrete_va
+000174f0: 7273 203d 205b 5d0a 2020 2020 6966 206c  rs = [].    if l
+00017500: 656e 2873 7472 696e 6776 6172 7329 203e  en(stringvars) >
+00017510: 2030 3a0a 2020 2020 2020 2020 636f 7079   0:.        copy
+00017520: 5f73 7472 696e 675f 7661 7273 203d 2063  _string_vars = c
+00017530: 6f70 792e 6465 6570 636f 7079 2873 7472  opy.deepcopy(str
+00017540: 696e 6776 6172 7329 0a20 2020 2020 2020  ingvars).       
+00017550: 2066 6f72 2065 6163 685f 7374 7269 6e67   for each_string
+00017560: 2069 6e20 636f 7079 5f73 7472 696e 675f   in copy_string_
+00017570: 7661 7273 3a0a 2020 2020 2020 2020 2020  vars:.          
+00017580: 2020 6966 206c 656e 2864 665b 6561 6368    if len(df[each
+00017590: 5f73 7472 696e 675d 2e75 6e69 7175 6528  _string].unique(
+000175a0: 2929 203e 2063 6174 6567 6f72 795f 6c69  )) > category_li
+000175b0: 6d69 743a 0a20 2020 2020 2020 2020 2020  mit:.           
+000175c0: 2020 2020 2064 6973 6372 6574 655f 7661       discrete_va
+000175d0: 7273 2e61 7070 656e 6428 6561 6368 5f73  rs.append(each_s
+000175e0: 7472 696e 6729 0a20 2020 2020 2020 2020  tring).         
+000175f0: 2020 2020 2020 2073 7472 696e 6776 6172         stringvar
+00017600: 732e 7265 6d6f 7665 2865 6163 685f 7374  s.remove(each_st
+00017610: 7269 6e67 290a 2020 2020 7661 725f 6469  ring).    var_di
+00017620: 6374 5b27 6469 7363 7265 7465 5f73 7472  ct['discrete_str
+00017630: 696e 675f 7661 7273 275d 203d 2064 6973  ing_vars'] = dis
+00017640: 6372 6574 655f 7661 7273 0a20 2020 2023  crete_vars.    #
+00017650: 2323 2320 546f 2073 656c 6563 7420 6461  ### To select da
+00017660: 7465 7469 6d65 732c 2075 7365 206e 702e  tetimes, use np.
+00017670: 6461 7465 7469 6d65 3634 2c20 2764 6174  datetime64, 'dat
+00017680: 6574 696d 6527 206f 7220 2764 6174 6574  etime' or 'datet
+00017690: 696d 6536 3427 0a20 2020 2064 6174 6576  ime64'.    datev
+000176a0: 6172 7320 3d20 6466 2e73 656c 6563 745f  ars = df.select_
+000176b0: 6474 7970 6573 2869 6e63 6c75 6465 3d27  dtypes(include='
+000176c0: 6461 7465 7469 6d65 2729 2e63 6f6c 756d  datetime').colum
+000176d0: 6e73 2e74 6f6c 6973 7428 290a 2020 2020  ns.tolist().    
+000176e0: 7661 725f 6469 6374 5b27 6461 7465 5f76  var_dict['date_v
+000176f0: 6172 7327 5d20 3d20 6461 7465 7661 7273  ars'] = datevars
+00017700: 0a20 2020 2023 2323 2320 546f 2073 656c  .    #### To sel
+00017710: 6563 7420 7469 6d65 6465 6c74 6173 2c20  ect timedeltas, 
+00017720: 7573 6520 6e70 2e74 696d 6564 656c 7461  use np.timedelta
+00017730: 3634 2c20 2774 696d 6564 656c 7461 2720  64, 'timedelta' 
+00017740: 6f72 2027 7469 6d65 6465 6c74 6136 3427  or 'timedelta64'
+00017750: 0a20 2020 2064 656c 7461 7661 7273 203d  .    deltavars =
+00017760: 2064 662e 7365 6c65 6374 5f64 7479 7065   df.select_dtype
+00017770: 7328 696e 636c 7564 653d 2774 696d 6564  s(include='timed
+00017780: 656c 7461 2729 2e63 6f6c 756d 6e73 2e74  elta').columns.t
+00017790: 6f6c 6973 7428 290a 2020 2020 7661 725f  olist().    var_
+000177a0: 6469 6374 5b27 7469 6d65 5f64 656c 7461  dict['time_delta
+000177b0: 7327 5d20 3d20 6465 6c74 6176 6172 730a  s'] = deltavars.
+000177c0: 2020 2020 2323 2323 2054 6f20 7365 6c65      #### To sele
+000177d0: 6374 2050 616e 6461 7320 6361 7465 676f  ct Pandas catego
+000177e0: 7269 6361 6c20 6474 7970 6573 2c20 7573  rical dtypes, us
+000177f0: 6520 2763 6174 6567 6f72 7927 0a20 2020  e 'category'.   
+00017800: 2063 6174 7661 7273 203d 2064 662e 7365   catvars = df.se
+00017810: 6c65 6374 5f64 7479 7065 7328 696e 636c  lect_dtypes(incl
+00017820: 7564 653d 2763 6174 6567 6f72 7927 292e  ude='category').
+00017830: 636f 6c75 6d6e 732e 746f 6c69 7374 2829  columns.tolist()
+00017840: 0a20 2020 2069 6620 6c65 6e28 6361 7476  .    if len(catv
+00017850: 6172 7329 203e 2030 3a0a 2020 2020 2020  ars) > 0:.      
+00017860: 2020 636f 7079 5f63 6174 7661 7273 203d    copy_catvars =
+00017870: 2063 6f70 792e 6465 6570 636f 7079 2863   copy.deepcopy(c
+00017880: 6174 7661 7273 290a 2020 2020 2020 2020  atvars).        
+00017890: 666f 7220 6561 6368 5f63 6174 2069 6e20  for each_cat in 
+000178a0: 636f 7079 5f63 6174 7661 7273 3a0a 2020  copy_catvars:.  
+000178b0: 2020 2020 2020 2020 2020 6966 206c 656e            if len
+000178c0: 2864 665b 6561 6368 5f63 6174 5d2e 756e  (df[each_cat].un
+000178d0: 6971 7565 2829 2920 3e20 6361 7465 676f  ique()) > catego
+000178e0: 7279 5f6c 696d 6974 3a0a 2020 2020 2020  ry_limit:.      
+000178f0: 2020 2020 2020 2020 2020 6469 7363 7265            discre
+00017900: 7465 5f76 6172 732e 6170 7065 6e64 2865  te_vars.append(e
+00017910: 6163 685f 6361 7429 0a20 2020 2020 2020  ach_cat).       
+00017920: 2020 2020 2020 2020 2063 6174 7661 7273           catvars
+00017930: 2e72 656d 6f76 6528 6561 6368 5f63 6174  .remove(each_cat
+00017940: 2920 2020 200a 2020 2020 7661 725f 6469  )    .    var_di
+00017950: 6374 5b27 6361 7465 676f 7269 6361 6c5f  ct['categorical_
+00017960: 7661 7273 275d 203d 2063 6174 7661 7273  vars'] = catvars
+00017970: 202b 2073 7472 696e 6776 6172 730a 2020   + stringvars.  
+00017980: 2020 7661 725f 6469 6374 5b27 6469 7363    var_dict['disc
+00017990: 7265 7465 5f73 7472 696e 675f 7661 7273  rete_string_vars
+000179a0: 275d 203d 2064 6973 6372 6574 655f 7661  '] = discrete_va
+000179b0: 7273 0a20 2020 2023 2323 2320 546f 2073  rs.    #### To s
+000179c0: 656c 6563 7420 5061 6e64 6173 2064 6174  elect Pandas dat
+000179d0: 6574 696d 6574 7a20 6474 7970 6573 2c20  etimetz dtypes, 
+000179e0: 7573 6520 2764 6174 6574 696d 6574 7a27  use 'datetimetz'
+000179f0: 2028 6e65 7720 696e 2030 2e32 302e 3029   (new in 0.20.0)
+00017a00: 206f 7220 2764 6174 6574 696d 6536 345b   or 'datetime64[
+00017a10: 6e73 2c20 747a 5d27 0a20 2020 2064 6174  ns, tz]'.    dat
+00017a20: 657a 7661 7273 203d 2064 662e 7365 6c65  ezvars = df.sele
+00017a30: 6374 5f64 7479 7065 7328 696e 636c 7564  ct_dtypes(includ
+00017a40: 653d 2764 6174 6574 696d 6574 7a27 292e  e='datetimetz').
+00017a50: 636f 6c75 6d6e 732e 746f 6c69 7374 2829  columns.tolist()
+00017a60: 0a20 2020 2076 6172 5f64 6963 745b 2764  .    var_dict['d
+00017a70: 6174 655f 7a6f 6e65 7327 5d20 3d20 6461  ate_zones'] = da
+00017a80: 7465 7a76 6172 730a 2020 2020 2323 2323  tezvars.    ####
+00017a90: 2063 6865 636b 2066 6f72 206e 6c70 2076   check for nlp v
+00017aa0: 6172 6961 626c 6573 2068 6572 6520 2323  ariables here ##
+00017ab0: 2323 0a20 2020 2073 7472 5f76 6172 7320  ##.    str_vars 
+00017ac0: 3d20 7661 725f 6469 6374 5b27 6469 7363  = var_dict['disc
+00017ad0: 7265 7465 5f73 7472 696e 675f 7661 7273  rete_string_vars
+00017ae0: 275d 0a20 2020 2063 6f70 795f 7661 7273  '].    copy_vars
+00017af0: 203d 2063 6f70 792e 6465 6570 636f 7079   = copy.deepcopy
+00017b00: 2873 7472 5f76 6172 7329 0a20 2020 206e  (str_vars).    n
+00017b10: 6c70 5f76 6172 7320 3d20 5b5d 0a20 2020  lp_vars = [].   
+00017b20: 2066 6f72 2065 6163 685f 7374 725f 7661   for each_str_va
+00017b30: 7220 696e 2063 6f70 795f 7661 7273 3a0a  r in copy_vars:.
+00017b40: 2020 2020 2020 2020 7472 793a 0a20 2020          try:.   
+00017b50: 2020 2020 2020 2020 206d 6561 6e5f 7374           mean_st
+00017b60: 725f 7369 7a65 203d 2064 665b 6561 6368  r_size = df[each
+00017b70: 5f73 7472 5f76 6172 5d2e 6669 6c6c 6e61  _str_var].fillna
+00017b80: 2827 6d69 7373 696e 6727 292e 6d61 7028  ('missing').map(
+00017b90: 6c65 6e29 2e6d 6178 2829 0a20 2020 2020  len).max().     
+00017ba0: 2020 2065 7863 6570 743a 0a20 2020 2020     except:.     
+00017bb0: 2020 2020 2020 2070 7269 6e74 2827 5265         print('Re
+00017bc0: 6d6f 7669 6e67 2063 6f6c 756d 6e20 2573  moving column %s
+00017bd0: 2073 696e 6365 2069 7420 6973 2065 7272   since it is err
+00017be0: 6f72 696e 6720 7072 6f62 6162 6c79 2064  oring probably d
+00017bf0: 7565 2074 6f20 6d69 7865 6420 6461 7461  ue to mixed data
+00017c00: 2074 7970 6573 2e27 2025 6561 6368 5f73   types.' %each_s
+00017c10: 7472 5f76 6172 290a 2020 2020 2020 2020  tr_var).        
+00017c20: 2020 2020 7374 725f 7661 7273 2e72 656d      str_vars.rem
+00017c30: 6f76 6528 6561 6368 5f73 7472 5f76 6172  ove(each_str_var
+00017c40: 290a 2020 2020 2020 2020 2020 2020 636f  ).            co
+00017c50: 6e74 696e 7565 0a20 2020 2020 2020 2069  ntinue.        i
+00017c60: 6620 206d 6561 6e5f 7374 725f 7369 7a65  f  mean_str_size
+00017c70: 203e 3d20 6e6c 705f 7468 7265 7368 6f6c   >= nlp_threshol
+00017c80: 643a 0a20 2020 2020 2020 2020 2020 2070  d:.            p
+00017c90: 7269 6e74 2866 2220 2020 2073 696e 6365  rint(f"    since
+00017ca0: 207b 6561 6368 5f73 7472 5f76 6172 7d27   {each_str_var}'
+00017cb0: 7320 6d61 7820 7374 7269 6e67 2073 697a  s max string siz
+00017cc0: 6520 7b6d 6561 6e5f 7374 725f 7369 7a65  e {mean_str_size
+00017cd0: 3a2e 3066 7d20 3e3d 207b 6e6c 705f 7468  :.0f} >= {nlp_th
+00017ce0: 7265 7368 6f6c 647d 2c20 7265 2d63 6c61  reshold}, re-cla
+00017cf0: 7373 6966 7969 6e67 2069 7420 6173 204e  ssifying it as N
+00017d00: 4c50 2076 6172 6961 626c 6522 290a 2020  LP variable").  
+00017d10: 2020 2020 2020 2020 2020 6e6c 705f 7661            nlp_va
+00017d20: 7273 2e61 7070 656e 6428 6561 6368 5f73  rs.append(each_s
+00017d30: 7472 5f76 6172 290a 2020 2020 2020 2020  tr_var).        
+00017d40: 2020 2020 7374 725f 7661 7273 2e72 656d      str_vars.rem
+00017d50: 6f76 6528 6561 6368 5f73 7472 5f76 6172  ove(each_str_var
+00017d60: 290a 2020 2020 7661 725f 6469 6374 5b27  ).    var_dict['
+00017d70: 6e6c 705f 7661 7273 275d 203d 206e 6c70  nlp_vars'] = nlp
+00017d80: 5f76 6172 7320 2323 2320 7468 6573 6520  _vars ### these 
+00017d90: 6172 6520 4e4c 5020 7465 7874 2076 6172  are NLP text var
+00017da0: 6961 626c 6573 2023 2323 2323 2323 2323  iables #########
+00017db0: 230a 2020 2020 7661 725f 6469 6374 5b27  #.    var_dict['
+00017dc0: 6469 7363 7265 7465 5f73 7472 696e 675f  discrete_string_
+00017dd0: 7661 7273 275d 203d 2073 7472 5f76 6172  vars'] = str_var
+00017de0: 7320 2323 2320 7468 6573 6520 6172 6520  s ### these are 
+00017df0: 6869 6768 2063 6172 6469 6e61 6c69 7479  high cardinality
+00017e00: 2073 7472 696e 6720 7661 7269 6162 6c65   string variable
+00017e10: 7320 2323 0a0a 2020 2020 6966 2076 6572  s ##..    if ver
+00017e20: 626f 7365 3a0a 2020 2020 2020 2020 7072  bose:.        pr
+00017e30: 696e 7428 6622 2222 2020 2020 5265 7475  int(f"""    Retu
+00017e40: 726e 696e 6720 6469 6374 696f 6e61 7279  rning dictionary
+00017e50: 2066 6f72 2076 6172 6961 626c 6520 7479   for variable ty
+00017e60: 7065 7320 7769 7468 2066 6f6c 6c6f 7769  pes with followi
+00017e70: 6e67 206b 6579 733a 0a20 2020 2020 2020  ng keys:.       
+00017e80: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00017e90: 2063 6f6e 7469 6e75 6f75 735f 7661 7273   continuous_vars
+00017ea0: 203d 207b 6c65 6e28 666c 6f61 7476 6172   = {len(floatvar
+00017eb0: 7329 7d2c 2069 6e74 5f76 6172 7320 3d20  s)}, int_vars = 
+00017ec0: 7b6c 656e 2869 6e74 7661 7273 297d 2c20  {len(intvars)}, 
+00017ed0: 0a20 2020 2020 2020 2020 2020 2020 2020  .               
+00017ee0: 2020 2020 2020 2020 2064 6973 6372 6574           discret
+00017ef0: 655f 7374 7269 6e67 5f76 6172 7320 3d20  e_string_vars = 
+00017f00: 7b6c 656e 2873 7472 5f76 6172 7329 7d2c  {len(str_vars)},
+00017f10: 206e 6c70 5f76 6172 7320 3d20 7b6c 656e   nlp_vars = {len
+00017f20: 286e 6c70 5f76 6172 7329 7d2c 0a20 2020  (nlp_vars)},.   
+00017f30: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00017f40: 2020 2020 2064 6174 655f 7661 7273 203d       date_vars =
+00017f50: 207b 6c65 6e28 6461 7465 7661 7273 297d   {len(datevars)}
+00017f60: 2c20 7469 6d65 5f64 656c 7461 7320 3d20  , time_deltas = 
+00017f70: 7b6c 656e 2864 656c 7461 7661 7273 297d  {len(deltavars)}
+00017f80: 2c0a 2020 2020 2020 2020 2020 2020 2020  ,.              
+00017f90: 2020 2020 2020 2020 2020 6361 7465 676f            catego
+00017fa0: 7269 6361 6c5f 7661 7273 203d 207b 6c65  rical_vars = {le
+00017fb0: 6e28 6361 7476 6172 7329 2b6c 656e 2873  n(catvars)+len(s
+00017fc0: 7472 696e 6776 6172 7329 7d2c 2064 6174  tringvars)}, dat
+00017fd0: 655f 7a6f 6e65 7320 3d20 7b6c 656e 2864  e_zones = {len(d
+00017fe0: 6174 657a 7661 7273 297d 2222 2229 0a20  atezvars)}"""). 
+00017ff0: 2020 200a 2020 2020 7265 7475 726e 2076     .    return v
+00018000: 6172 5f64 6963 740a 2323 2323 2323 2323  ar_dict.########
+00018010: 2323 2323 2323 2323 2323 2323 2323 2323  ################
+00018020: 2323 2323 2323 2323 2323 2323 2323 2323  ################
+00018030: 2323 2323 2323 2323 2323 2323 2323 2323  ################
+00018040: 2323 2323 2323 2323 2323 2323 2323 2323  ################
+00018050: 2323 2323 2323 2323 2323 2323 2323 2323  ################
+00018060: 2323 2323 2323 2323 2323 0a64 6566 206c  ##########.def l
+00018070: 6566 745f 7375 6274 7261 6374 286c 312c  eft_subtract(l1,
+00018080: 6c32 293a 0a20 2020 2022 2222 5468 6973  l2):.    """This
+00018090: 2068 616e 6479 2066 756e 6374 696f 6e20   handy function 
+000180a0: 7375 6274 7261 6374 7320 6f6e 6520 6c69  subtracts one li
+000180b0: 7374 2066 726f 6d20 616e 6f74 6865 722e  st from another.
+000180c0: 2050 726f 6261 626c 7920 6d79 206d 6f73   Probably my mos
+000180d0: 7420 706f 7075 6c61 7220 6675 6e63 7469  t popular functi
+000180e0: 6f6e 2e22 2222 0a20 2020 206c 7374 203d  on.""".    lst =
+000180f0: 205b 5d0a 2020 2020 666f 7220 6920 696e   [].    for i in
+00018100: 206c 313a 0a20 2020 2020 2020 2069 6620   l1:.        if 
+00018110: 6920 6e6f 7420 696e 206c 323a 0a20 2020  i not in l2:.   
+00018120: 2020 2020 2020 2020 206c 7374 2e61 7070           lst.app
+00018130: 656e 6428 6929 0a20 2020 2072 6574 7572  end(i).    retur
+00018140: 6e20 6c73 740a 2323 2323 2323 2323 2323  n lst.##########
+00018150: 2323 2323 2323 2323 2323 2323 2323 2323  ################
+00018160: 2323 2323 2323 2323 2323 2323 2323 2323  ################
+00018170: 2323 2323 2323 2323 2323 2323 2323 2323  ################
+00018180: 2323 2323 2323 2323 2323 2323 2323 2323  ################
+00018190: 2323 2323 2323 2323 2323 2323 2323 2323  ################
+000181a0: 2323 0a69 6d70 6f72 7420 636f 7079 0a64  ##.import copy.d
+000181b0: 6566 2063 6f6e 7665 7274 5f6d 6978 6564  ef convert_mixed
+000181c0: 5f64 6174 6174 7970 6573 5f74 6f5f 7374  _datatypes_to_st
+000181d0: 7269 6e67 2864 6629 3a0a 2020 2020 2222  ring(df):.    ""
+000181e0: 220a 2020 2020 2323 2323 2323 2323 2323  ".    ##########
+000181f0: 2323 2323 2323 2323 2323 2323 2323 2323  ################
+00018200: 2323 2323 2323 2323 2323 2323 2323 2323  ################
+00018210: 2323 2323 2323 2323 2323 2323 2323 2323  ################
+00018220: 2323 2323 2323 2323 2323 2323 2323 2323  ################
+00018230: 2323 2323 2323 2323 2323 230a 2020 2020  ###########.    
+00018240: 4861 6e64 7920 6675 6e63 7469 6f6e 2066  Handy function f
+00018250: 6f72 2046 6561 7475 7265 2054 7261 6e73  or Feature Trans
+00018260: 666f 726d 6174 696f 6e3a 2054 6861 7427  formation: That'
+00018270: 7320 7768 7920 6974 2773 2069 6e63 6c75  s why it's inclu
+00018280: 6465 6420 696e 204c 617a 7954 7261 6e73  ded in LazyTrans
+00018290: 666f 726d 0a20 2020 2023 2323 2323 2323  form.    #######
+000182a0: 2323 2323 2049 7420 636f 6e76 6572 7473  #### It converts
+000182b0: 2061 6c6c 206d 6978 6564 2064 6174 6120   all mixed data 
+000182c0: 7479 7065 2063 6f6c 756d 6e73 2069 6e74  type columns int
+000182d0: 6f20 6f62 6a65 6374 2063 6f6c 756d 6e73  o object columns
+000182e0: 2023 2323 2323 2323 2323 2323 230a 2020   ############.  
+000182f0: 2020 496e 7075 7473 3a0a 2020 2020 6466    Inputs:.    df
+00018300: 203a 2070 616e 6461 7320 6461 7461 6672   : pandas datafr
+00018310: 616d 650a 0a20 2020 204f 7574 7075 7473  ame..    Outputs
+00018320: 3a0a 2020 2020 6466 3a20 7468 6973 2069  :.    df: this i
+00018330: 7320 7468 6520 7472 616e 7366 6f72 6d65  s the transforme
+00018340: 6420 4461 7461 4672 616d 6520 7769 7468  d DataFrame with
+00018350: 2061 6c6c 206d 6978 6564 2064 6174 6120   all mixed data 
+00018360: 7479 7065 7320 6e6f 7720 6173 206f 626a  types now as obj
+00018370: 6563 7473 0a20 2020 2023 2323 2323 2323  ects.    #######
+00018380: 2323 2323 2323 2323 2323 2323 2323 2323  ################
+00018390: 2323 2323 2323 2323 2323 2323 2323 2323  ################
+000183a0: 2323 2323 2323 2323 2323 2323 2323 2323  ################
+000183b0: 2323 2323 2323 2323 2323 2323 2323 2323  ################
+000183c0: 2323 2323 2323 2323 2323 2323 2323 0a20  ##############. 
+000183d0: 2020 2022 2222 0a20 2020 2064 6620 3d20     """.    df = 
+000183e0: 636f 7079 2e64 6565 7063 6f70 7928 6466  copy.deepcopy(df
+000183f0: 290a 2020 2020 636f 6c73 203d 2064 662e  ).    cols = df.
+00018400: 636f 6c75 6d6e 732e 746f 6c69 7374 2829  columns.tolist()
+00018410: 0a20 2020 2063 6f70 795f 636f 6c73 203d  .    copy_cols =
+00018420: 2063 6f70 792e 6465 6570 636f 7079 2863   copy.deepcopy(c
+00018430: 6f6c 7329 0a20 2020 2066 6f72 2063 6f6c  ols).    for col
+00018440: 2069 6e20 636f 7079 5f63 6f6c 733a 0a20   in copy_cols:. 
+00018450: 2020 2020 2020 2069 6620 6c65 6e28 6466         if len(df
+00018460: 5b63 6f6c 5d2e 6170 706c 7928 7479 7065  [col].apply(type
+00018470: 292e 7661 6c75 655f 636f 756e 7473 2829  ).value_counts()
+00018480: 2920 3e20 313a 0a20 2020 2020 2020 2020  ) > 1:.         
+00018490: 2020 2070 7269 6e74 2827 4d69 7865 6420     print('Mixed 
+000184a0: 6461 7461 2074 7970 6520 6465 7465 6374  data type detect
+000184b0: 6564 2069 6e20 2573 2063 6f6c 756d 6e2e  ed in %s column.
+000184c0: 2043 6f6e 7665 7274 696e 6720 6974 2074   Converting it t
+000184d0: 6f20 6f62 6a65 6374 2074 7970 652e 2e2e  o object type...
+000184e0: 2720 2563 6f6c 290a 2020 2020 2020 2020  ' %col).        
+000184f0: 2020 2020 7472 793a 0a20 2020 2020 2020      try:.       
+00018500: 2020 2020 2020 2020 2064 665b 636f 6c5d           df[col]
+00018510: 203d 2064 665b 636f 6c5d 2e6d 6170 286c   = df[col].map(l
+00018520: 616d 6264 6120 783a 2078 2069 6620 6973  ambda x: x if is
+00018530: 696e 7374 616e 6365 2878 2c20 7374 7229  instance(x, str)
+00018540: 2065 6c73 6520 7374 7228 7829 292e 7661   else str(x)).va
+00018550: 6c75 6573 0a20 2020 2020 2020 2020 2020  lues.           
+00018560: 2020 2020 2069 6620 6c65 6e28 6466 5b63       if len(df[c
+00018570: 6f6c 5d2e 6170 706c 7928 7479 7065 292e  ol].apply(type).
+00018580: 7661 6c75 655f 636f 756e 7473 2829 2920  value_counts()) 
+00018590: 3e20 313a 0a20 2020 2020 2020 2020 2020  > 1:.           
+000185a0: 2020 2020 2020 2020 2064 662e 6472 6f70           df.drop
+000185b0: 2863 6f6c 2c61 7869 733d 312c 696e 706c  (col,axis=1,inpl
+000185c0: 6163 653d 5472 7565 290a 2020 2020 2020  ace=True).      
+000185d0: 2020 2020 2020 2020 2020 2020 2020 7072                pr
+000185e0: 696e 7428 2720 2020 2025 7320 7374 696c  int('    %s stil
+000185f0: 6c20 6861 7320 6d69 7865 6420 6461 7461  l has mixed data
+00018600: 2074 7970 6573 2e20 4472 6f70 7069 6e67   types. Dropping
+00018610: 2069 742e 2720 2563 6f6c 290a 2020 2020   it.' %col).    
+00018620: 2020 2020 2020 2020 6578 6365 7074 3a0a          except:.
+00018630: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00018640: 6466 2e64 726f 7028 636f 6c2c 6178 6973  df.drop(col,axis
+00018650: 3d31 2c69 6e70 6c61 6365 3d54 7275 6529  =1,inplace=True)
+00018660: 0a20 2020 2020 2020 2020 2020 2020 2020  .               
+00018670: 2070 7269 6e74 2827 2020 2020 6472 6f70   print('    drop
+00018680: 7069 6e67 2025 7320 7369 6e63 6520 6974  ping %s since it
+00018690: 2067 6976 6573 2065 7272 6f72 2e27 2025   gives error.' %
+000186a0: 636f 6c29 0a20 2020 2072 6574 7572 6e20  col).    return 
+000186b0: 6466 0a23 2323 2323 2323 2323 2323 2323  df.#############
+000186c0: 2323 2323 2323 2323 2323 2323 2323 2323  ################
+000186d0: 2323 2323 2323 2323 2323 2323 2323 2323  ################
+000186e0: 2323 2323 2323 2323 2323 2323 2323 2323  ################
+000186f0: 2323 2323 2323 2323 2323 2323 2323 2323  ################
+00018700: 2323 2323 2323 2323 2323 2323 2323 230a  ###############.
+00018710: 6465 6620 636f 6e76 6572 745f 616c 6c5f  def convert_all_
+00018720: 6f62 6a65 6374 5f63 6f6c 756d 6e73 5f74  object_columns_t
+00018730: 6f5f 6e75 6d65 7269 6328 7472 6169 6e2c  o_numeric(train,
+00018740: 2074 6573 743d 2222 293a 0a20 2020 2022   test=""):.    "
+00018750: 2222 0a20 2020 2054 6869 7320 6120 6861  "".    This a ha
+00018760: 6e64 7920 6675 6e63 7469 6f6e 2066 6f72  ndy function for
+00018770: 2046 6561 7475 7265 2045 6e67 696e 6565   Feature Enginee
+00018780: 7269 6e67 202d 2054 6861 7427 7320 7768  ring - That's wh
+00018790: 7920 4920 6861 7665 2069 6e63 6c75 6465  y I have include
+000187a0: 6420 6974 2069 6e20 4c61 7a79 2054 7261  d it in Lazy Tra
+000187b0: 6e73 666f 726d 0a20 2020 2023 2323 2323  nsform.    #####
+000187c0: 2323 2323 2323 2323 2323 2323 2323 2323  ################
+000187d0: 2323 2323 2323 2323 2323 2323 2323 2323  ################
+000187e0: 2323 2323 2323 2323 2323 2323 2323 2323  ################
+000187f0: 2323 2323 2323 2323 2323 2323 2323 2323  ################
+00018800: 2323 2323 2323 2323 2323 2323 2323 2323  ################
+00018810: 230a 2020 2020 5468 6973 2069 7320 6120  #.    This is a 
+00018820: 7574 696c 6974 7920 7468 6174 2063 6f6e  utility that con
+00018830: 7665 7274 7320 7374 7269 6e67 2063 6f6c  verts string col
+00018840: 756d 6e73 2074 6f20 6e75 6d65 7269 6320  umns to numeric 
+00018850: 7573 696e 6720 4d59 5f4c 4142 454c 2045  using MY_LABEL E
+00018860: 4e43 4f44 4552 2e0a 2020 2020 4d61 6b65  NCODER..    Make
+00018870: 2073 7572 6520 7465 7374 2061 6e64 2074   sure test and t
+00018880: 7261 696e 2068 6176 6520 7468 6520 7361  rain have the sa
+00018890: 6d65 206e 756d 6265 7220 6f66 2063 6f6c  me number of col
+000188a0: 756d 6e73 2e20 4966 2079 6f75 2068 6176  umns. If you hav
+000188b0: 6520 7461 7267 6574 2069 6e20 7472 6169  e target in trai
+000188c0: 6e2c 0a20 2020 2072 656d 6f76 6520 6974  n,.    remove it
+000188d0: 2062 6566 6f72 6520 7365 6e64 696e 6720   before sending 
+000188e0: 6974 2074 6872 6f75 6768 2074 6869 7320  it through this 
+000188f0: 7574 696c 6974 792e 204f 7468 6572 7769  utility. Otherwi
+00018900: 7365 2c20 6d69 6768 7420 626c 6f77 2075  se, might blow u
+00018910: 7020 6475 7269 6e67 2074 6573 7420 7472  p during test tr
+00018920: 616e 7366 6f72 6d2e 0a20 2020 2054 6865  ansform..    The
+00018930: 2062 6561 7574 7920 6f66 204d 795f 4c61   beauty of My_La
+00018940: 6265 6c45 6e63 6f64 6572 2069 7320 6974  belEncoder is it
+00018950: 2068 616e 646c 6573 204e 4127 7320 616e   handles NA's an
+00018960: 6420 6675 7475 7265 2076 616c 7565 7320  d future values 
+00018970: 696e 2074 6573 7420 7468 6174 2061 7265  in test that are
+00018980: 206e 6f74 2069 6e20 7472 6169 6e2e 0a20   not in train.. 
+00018990: 2020 2023 2323 2323 2323 2323 2323 2323     #############
+000189a0: 2323 2323 2323 2323 2323 2323 2323 2323  ################
+000189b0: 2323 2323 2323 2323 2323 2323 2323 2323  ################
+000189c0: 2323 2323 2323 2323 2323 2323 2323 2323  ################
+000189d0: 2323 2323 2323 2323 2323 2323 2323 2323  ################
+000189e0: 2323 2323 2323 2323 2323 0a20 2020 2049  ##########.    I
+000189f0: 6e70 7574 733a 0a20 2020 2074 7261 696e  nputs:.    train
+00018a00: 203a 2070 616e 6461 7320 6461 7461 6672   : pandas datafr
+00018a10: 616d 650a 2020 2020 7465 7374 3a20 286f  ame.    test: (o
+00018a20: 7074 696f 6e61 6c29 2070 616e 6461 7320  ptional) pandas 
+00018a30: 6461 7461 6672 616d 650a 0a20 2020 204f  dataframe..    O
+00018a40: 7574 7075 7473 3a0a 2020 2020 7472 6169  utputs:.    trai
+00018a50: 6e3a 2074 6869 7320 6973 2074 6865 2074  n: this is the t
+00018a60: 7261 6e73 666f 726d 6564 2044 6174 6146  ransformed DataF
+00018a70: 7261 6d65 0a20 2020 2074 6573 743a 2028  rame.    test: (
+00018a80: 6f70 7469 6f6e 616c 2920 7468 6973 2069  optional) this i
+00018a90: 7320 7468 6520 7472 616e 7366 6f72 6d65  s the transforme
+00018aa0: 6420 7465 7374 2064 6174 6166 7261 6d65  d test dataframe
+00018ab0: 2069 6620 6769 7665 6e2e 0a20 2020 2023   if given..    #
+00018ac0: 2323 2323 2323 2323 2323 2323 2323 2323  ################
+00018ad0: 2323 2323 2323 2323 2323 2323 2323 2323  ################
+00018ae0: 2323 2323 2323 2323 2323 2323 2323 2323  ################
+00018af0: 2323 2323 2323 2323 2323 2323 2323 2323  ################
+00018b00: 2323 2323 2323 2323 2323 2323 2323 2323  ################
+00018b10: 2323 2323 230a 2020 2020 2222 220a 2020  #####.    """.  
+00018b20: 2020 0a20 2020 2074 7261 696e 203d 2063    .    train = c
+00018b30: 6f70 792e 6465 6570 636f 7079 2874 7261  opy.deepcopy(tra
+00018b40: 696e 290a 2020 2020 7465 7374 203d 2063  in).    test = c
+00018b50: 6f70 792e 6465 6570 636f 7079 2874 6573  opy.deepcopy(tes
+00018b60: 7429 0a20 2020 2023 2323 2320 5468 6973  t).    #### This
+00018b70: 2069 7320 746f 2066 696c 6c20 616c 6c20   is to fill all 
+00018b80: 6e75 6d65 7269 6320 636f 6c75 6d6e 7320  numeric columns 
+00018b90: 7769 7468 2061 206d 6973 7369 6e67 206e  with a missing n
+00018ba0: 756d 6265 7220 2323 2323 2323 2323 2323  umber ##########
+00018bb0: 0a20 2020 206e 756d 7320 3d20 7472 6169  .    nums = trai
+00018bc0: 6e2e 7365 6c65 6374 5f64 7479 7065 7328  n.select_dtypes(
+00018bd0: 276e 756d 6265 7227 292e 636f 6c75 6d6e  'number').column
+00018be0: 732e 746f 6c69 7374 2829 0a20 2020 2069  s.tolist().    i
+00018bf0: 6620 6c65 6e28 6e75 6d73 2920 3d3d 2030  f len(nums) == 0
+00018c00: 3a0a 2020 2020 2020 2020 7061 7373 0a20  :.        pass. 
+00018c10: 2020 2065 6c73 653a 0a0a 2020 2020 2020     else:..      
+00018c20: 2020 6966 2074 7261 696e 5b6e 756d 735d    if train[nums]
+00018c30: 2e69 736e 756c 6c28 292e 7375 6d28 292e  .isnull().sum().
+00018c40: 7375 6d28 2920 3e20 303a 0a20 2020 2020  sum() > 0:.     
+00018c50: 2020 2020 2020 206e 756c 6c5f 636f 6c73         null_cols
+00018c60: 203d 206e 702e 6172 7261 7928 6e75 6d73   = np.array(nums
+00018c70: 295b 7472 6169 6e5b 6e75 6d73 5d2e 6973  )[train[nums].is
+00018c80: 6e75 6c6c 2829 2e73 756d 2829 3e30 5d2e  null().sum()>0].
+00018c90: 746f 6c69 7374 2829 0a20 2020 2020 2020  tolist().       
+00018ca0: 2020 2020 2066 6f72 2065 6163 685f 636f       for each_co
+00018cb0: 6c20 696e 206e 756c 6c5f 636f 6c73 3a0a  l in null_cols:.
+00018cc0: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00018cd0: 6e65 775f 6d69 7373 696e 675f 636f 6c20  new_missing_col 
+00018ce0: 3d20 6561 6368 5f63 6f6c 202b 2027 5f4d  = each_col + '_M
+00018cf0: 6973 7369 6e67 5f46 6c61 6727 0a20 2020  issing_Flag'.   
+00018d00: 2020 2020 2020 2020 2020 2020 2074 7261               tra
+00018d10: 696e 5b6e 6577 5f6d 6973 7369 6e67 5f63  in[new_missing_c
+00018d20: 6f6c 5d20 3d20 300a 2020 2020 2020 2020  ol] = 0.        
+00018d30: 2020 2020 2020 2020 7472 6169 6e2e 6c6f          train.lo
+00018d40: 635b 7472 6169 6e5b 6561 6368 5f63 6f6c  c[train[each_col
+00018d50: 5d2e 6973 6e75 6c6c 2829 2c6e 6577 5f6d  ].isnull(),new_m
+00018d60: 6973 7369 6e67 5f63 6f6c 5d3d 310a 2020  issing_col]=1.  
+00018d70: 2020 2020 2020 2020 2020 2020 2020 7472                tr
+00018d80: 6169 6e5b 6561 6368 5f63 6f6c 5d20 3d20  ain[each_col] = 
+00018d90: 7472 6169 6e5b 6561 6368 5f63 6f6c 5d2e  train[each_col].
+00018da0: 6669 6c6c 6e61 282d 3939 3939 290a 2020  fillna(-9999).  
+00018db0: 2020 2020 2020 2020 2020 2020 2020 6966                if
+00018dc0: 206e 6f74 2074 7261 696e 5b65 6163 685f   not train[each_
+00018dd0: 636f 6c5d 2e64 7479 7065 2069 6e20 5b6e  col].dtype in [n
+00018de0: 702e 666c 6f61 7436 342c 6e70 2e66 6c6f  p.float64,np.flo
+00018df0: 6174 3332 2c6e 702e 666c 6f61 7431 365d  at32,np.float16]
+00018e00: 3a0a 2020 2020 2020 2020 2020 2020 2020  :.              
+00018e10: 2020 2020 2020 7472 6169 6e5b 6561 6368        train[each
+00018e20: 5f63 6f6c 5d20 3d20 7472 6169 6e5b 6561  _col] = train[ea
+00018e30: 6368 5f63 6f6c 5d2e 6173 7479 7065 2869  ch_col].astype(i
+00018e40: 6e74 290a 2020 2020 2020 2020 2020 2020  nt).            
+00018e50: 2020 2020 6966 206e 6f74 2069 7369 6e73      if not isins
+00018e60: 7461 6e63 6528 7465 7374 2c20 7374 7229  tance(test, str)
+00018e70: 3a0a 2020 2020 2020 2020 2020 2020 2020  :.              
+00018e80: 2020 2020 2020 6966 2074 6573 7420 6973        if test is
+00018e90: 204e 6f6e 653a 0a20 2020 2020 2020 2020   None:.         
+00018ea0: 2020 2020 2020 2020 2020 2020 2020 2070                 p
+00018eb0: 6173 730a 2020 2020 2020 2020 2020 2020  ass.            
+00018ec0: 2020 2020 2020 2020 656c 7365 3a0a 2020          else:.  
+00018ed0: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00018ee0: 2020 2020 2020 6e65 775f 6d69 7373 696e        new_missin
+00018ef0: 675f 636f 6c20 3d20 6561 6368 5f63 6f6c  g_col = each_col
+00018f00: 202b 2027 5f4d 6973 7369 6e67 5f46 6c61   + '_Missing_Fla
+00018f10: 6727 0a20 2020 2020 2020 2020 2020 2020  g'.             
+00018f20: 2020 2020 2020 2020 2020 2074 6573 745b             test[
+00018f30: 6e65 775f 6d69 7373 696e 675f 636f 6c5d  new_missing_col]
+00018f40: 203d 2030 0a20 2020 2020 2020 2020 2020   = 0.           
+00018f50: 2020 2020 2020 2020 2020 2020 2074 6573               tes
+00018f60: 742e 6c6f 635b 7465 7374 5b65 6163 685f  t.loc[test[each_
+00018f70: 636f 6c5d 2e69 736e 756c 6c28 292c 6e65  col].isnull(),ne
+00018f80: 775f 6d69 7373 696e 675f 636f 6c5d 3d31  w_missing_col]=1
+00018f90: 0a20 2020 2020 2020 2020 2020 2020 2020  .               
+00018fa0: 2020 2020 2020 2020 2074 6573 745b 6561           test[ea
+00018fb0: 6368 5f63 6f6c 5d20 3d20 7465 7374 5b65  ch_col] = test[e
+00018fc0: 6163 685f 636f 6c5d 2e66 696c 6c6e 6128  ach_col].fillna(
+00018fd0: 2d39 3939 3929 0a20 2020 2020 2020 2020  -9999).         
+00018fe0: 2020 2020 2020 2020 2020 2020 2020 2069                 i
+00018ff0: 6620 6e6f 7420 7465 7374 5b65 6163 685f  f not test[each_
+00019000: 636f 6c5d 2e64 7479 7065 2069 6e20 5b6e  col].dtype in [n
+00019010: 702e 666c 6f61 7436 342c 6e70 2e66 6c6f  p.float64,np.flo
+00019020: 6174 3332 2c6e 702e 666c 6f61 7431 365d  at32,np.float16]
+00019030: 3a0a 2020 2020 2020 2020 2020 2020 2020  :.              
+00019040: 2020 2020 2020 2020 2020 2020 2020 7465                te
+00019050: 7374 5b65 6163 685f 636f 6c5d 203d 2074  st[each_col] = t
+00019060: 6573 745b 6561 6368 5f63 6f6c 5d2e 6173  est[each_col].as
+00019070: 7479 7065 2869 6e74 290a 2020 2020 2323  type(int).    ##
+00019080: 2323 2323 204e 6f77 2077 6520 636f 6e76  #### Now we conv
+00019090: 6572 7420 616c 6c20 6f62 6a65 6374 2063  ert all object c
+000190a0: 6f6c 756d 6e73 2074 6f20 6e75 6d65 7269  olumns to numeri
+000190b0: 6320 2323 2323 2323 2323 2323 0a20 2020  c ##########.   
+000190c0: 206c 6973 203d 205b 5d0a 2020 2020 6c69   lis = [].    li
+000190d0: 7320 3d20 7472 6169 6e2e 7365 6c65 6374  s = train.select
+000190e0: 5f64 7479 7065 7328 276f 626a 6563 7427  _dtypes('object'
+000190f0: 292e 636f 6c75 6d6e 732e 746f 6c69 7374  ).columns.tolist
+00019100: 2829 202b 2074 7261 696e 2e73 656c 6563  () + train.selec
+00019110: 745f 6474 7970 6573 2827 6361 7465 676f  t_dtypes('catego
+00019120: 7279 2729 2e63 6f6c 756d 6e73 2e74 6f6c  ry').columns.tol
+00019130: 6973 7428 290a 2020 2020 6966 206e 6f74  ist().    if not
+00019140: 2069 7369 6e73 7461 6e63 6528 7465 7374   isinstance(test
+00019150: 2c20 7374 7229 3a0a 2020 2020 2020 2020  , str):.        
+00019160: 6966 2074 6573 7420 6973 204e 6f6e 653a  if test is None:
+00019170: 0a20 2020 2020 2020 2020 2020 2070 6173  .            pas
+00019180: 730a 2020 2020 2020 2020 656c 7365 3a0a  s.        else:.
+00019190: 2020 2020 2020 2020 2020 2020 6c69 735f              lis_
+000191a0: 7465 7374 203d 2074 6573 742e 7365 6c65  test = test.sele
+000191b0: 6374 5f64 7479 7065 7328 276f 626a 6563  ct_dtypes('objec
+000191c0: 7427 292e 636f 6c75 6d6e 732e 746f 6c69  t').columns.toli
+000191d0: 7374 2829 202b 2074 6573 742e 7365 6c65  st() + test.sele
+000191e0: 6374 5f64 7479 7065 7328 2763 6174 6567  ct_dtypes('categ
+000191f0: 6f72 7927 292e 636f 6c75 6d6e 732e 746f  ory').columns.to
+00019200: 6c69 7374 2829 0a20 2020 2020 2020 2020  list().         
+00019210: 2020 2069 6620 6c65 6e28 6c65 6674 5f73     if len(left_s
+00019220: 7562 7472 6163 7428 6c69 732c 206c 6973  ubtract(lis, lis
+00019230: 5f74 6573 7429 2920 3e20 303a 0a20 2020  _test)) > 0:.   
+00019240: 2020 2020 2020 2020 2020 2020 2023 2323               ###
+00019250: 2069 6620 7468 6572 6520 6973 2061 6e20   if there is an 
+00019260: 6578 7472 6120 636f 6c75 6d6e 2069 6e20  extra column in 
+00019270: 7472 6169 6e20 7468 6174 2069 7320 6e6f  train that is no
+00019280: 7420 696e 2074 6573 742c 2074 6865 6e20  t in test, then 
+00019290: 7265 6d6f 7665 2069 7420 6672 6f6d 2063  remove it from c
+000192a0: 6f6e 7369 6465 7261 7469 6f6e 0a20 2020  onsideration.   
+000192b0: 2020 2020 2020 2020 2020 2020 206c 6973               lis
+000192c0: 203d 2063 6f70 792e 6465 6570 636f 7079   = copy.deepcopy
+000192d0: 286c 6973 5f74 6573 7429 0a20 2020 2069  (lis_test).    i
+000192e0: 6620 6e6f 7420 286c 656e 286c 6973 293d  f not (len(lis)=
+000192f0: 3d30 293a 0a20 2020 2020 2020 2066 6f72  =0):.        for
+00019300: 2065 7665 7279 636f 6c20 696e 206c 6973   everycol in lis
+00019310: 3a0a 2020 2020 2020 2020 2020 2020 4d4c  :.            ML
+00019320: 4220 3d20 4d79 5f4c 6162 656c 456e 636f  B = My_LabelEnco
+00019330: 6465 7228 290a 2020 2020 2020 2020 2020  der().          
+00019340: 2020 7472 793a 0a20 2020 2020 2020 2020    try:.         
+00019350: 2020 2020 2020 2074 7261 696e 5b65 7665         train[eve
+00019360: 7279 636f 6c5d 203d 204d 4c42 2e66 6974  rycol] = MLB.fit
+00019370: 5f74 7261 6e73 666f 726d 2874 7261 696e  _transform(train
+00019380: 5b65 7665 7279 636f 6c5d 290a 2020 2020  [everycol]).    
+00019390: 2020 2020 2020 2020 2020 2020 6966 206e              if n
+000193a0: 6f74 2069 7369 6e73 7461 6e63 6528 7465  ot isinstance(te
+000193b0: 7374 2c20 7374 7229 3a0a 2020 2020 2020  st, str):.      
+000193c0: 2020 2020 2020 2020 2020 2020 2020 6966                if
+000193d0: 2074 6573 7420 6973 204e 6f6e 653a 0a20   test is None:. 
+000193e0: 2020 2020 2020 2020 2020 2020 2020 2020                  
+000193f0: 2020 2020 2020 2070 6173 730a 2020 2020         pass.    
+00019400: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00019410: 656c 7365 3a0a 2020 2020 2020 2020 2020  else:.          
+00019420: 2020 2020 2020 2020 2020 2020 2020 7465                te
+00019430: 7374 5b65 7665 7279 636f 6c5d 203d 204d  st[everycol] = M
+00019440: 4c42 2e74 7261 6e73 666f 726d 2874 6573  LB.transform(tes
+00019450: 745b 6576 6572 7963 6f6c 5d29 0a20 2020  t[everycol]).   
+00019460: 2020 2020 2020 2020 2065 7863 6570 743a           except:
+00019470: 0a20 2020 2020 2020 2020 2020 2020 2020  .               
+00019480: 2070 7269 6e74 2827 4572 726f 7220 636f   print('Error co
+00019490: 6e76 6572 7469 6e67 2025 7320 636f 6c75  nverting %s colu
+000194a0: 6d6e 2066 726f 6d20 7374 7269 6e67 2074  mn from string t
+000194b0: 6f20 6e75 6d65 7269 632e 2043 6f6e 7469  o numeric. Conti
+000194c0: 6e75 696e 672e 2e2e 2720 2565 7665 7279  nuing...' %every
+000194d0: 636f 6c29 0a20 2020 2020 2020 2020 2020  col).           
+000194e0: 2020 2020 2063 6f6e 7469 6e75 650a 2020       continue.  
+000194f0: 2020 7265 7475 726e 2074 7261 696e 2c20    return train, 
+00019500: 7465 7374 0a23 2323 2323 2323 2323 2323  test.###########
+00019510: 2323 2323 2323 2323 2323 2323 2323 2323  ################
+00019520: 2323 2323 2323 2323 2323 2323 2323 2323  ################
+00019530: 2323 2323 2323 2323 2323 2323 2323 2323  ################
+00019540: 2323 2323 2323 2323 2323 2323 2323 2323  ################
+00019550: 2323 2323 2323 2323 2323 2323 2323 2323  ################
+00019560: 2323 2323 230a 6465 6620 6472 6f70 5f73  #####.def drop_s
+00019570: 6563 6f6e 645f 636f 6c28 5874 293a 200a  econd_col(Xt): .
+00019580: 2020 2020 2323 2320 5468 6973 2064 656c      ### This del
+00019590: 6574 6573 2074 6865 2032 6e64 2063 6f6c  etes the 2nd col
+000195a0: 756d 6e2e 2048 656e 6365 2063 6f6c 206e  umn. Hence col n
+000195b0: 756d 6265 723d 3120 616e 6420 6178 6973  umber=1 and axis
+000195c0: 3d31 2023 2323 0a20 2020 200a 2020 2020  =1 ###.    .    
+000195d0: 7265 7475 726e 206e 702e 6465 6c65 7465  return np.delete
+000195e0: 2858 742c 2031 2c20 3129 0a0a 6465 6620  (Xt, 1, 1)..def 
+000195f0: 6368 616e 6765 5f63 6f6c 5f74 6f5f 7374  change_col_to_st
+00019600: 7269 6e67 2858 7429 3a20 0a20 2020 2023  ring(Xt): .    #
+00019610: 2323 2054 6869 7320 636f 6e76 6572 7473  ## This converts
+00019620: 2074 6865 2069 6e70 7574 2063 6f6c 756d   the input colum
+00019630: 6e20 746f 2061 2073 7472 696e 6720 616e  n to a string an
+00019640: 6420 7265 7475 726e 7320 6974 2023 230a  d returns it ##.
+00019650: 2020 2020 7265 7475 726e 2058 742e 6173      return Xt.as
+00019660: 7479 7065 2873 7472 290a 0a64 6566 2063  type(str)..def c
+00019670: 7265 6174 655f 636f 6c75 6d6e 5f6e 616d  reate_column_nam
+00019680: 6573 2858 742c 206e 6c70 7661 7273 3d5b  es(Xt, nlpvars=[
+00019690: 5d2c 2063 6174 7661 7273 3d5b 5d2c 2064  ], catvars=[], d
+000196a0: 6973 6372 6574 6576 6172 733d 5b5d 2c20  iscretevars=[], 
+000196b0: 666c 6f61 7476 6172 733d 5b5d 2c20 696e  floatvars=[], in
+000196c0: 7476 6172 733d 5b5d 2c0a 2020 2020 2020  tvars=[],.      
+000196d0: 2020 2020 2020 2020 2020 6461 7465 7661            dateva
+000196e0: 7273 3d5b 5d2c 206f 6e65 686f 745f 6469  rs=[], onehot_di
+000196f0: 6374 3d7b 7d2c 2063 6f6c 7369 7a65 5f64  ct={}, colsize_d
+00019700: 6963 743d 7b7d 2c64 6174 6573 697a 655f  ict={},datesize_
+00019710: 6469 6374 3d7b 7d29 3a0a 2020 2020 0a20  dict={}):.    . 
+00019720: 2020 2063 6f6c 735f 6e6c 7020 3d20 5b5d     cols_nlp = []
+00019730: 0a20 2020 2023 2323 2054 6869 7320 6e61  .    ### This na
+00019740: 6d65 7320 616c 6c20 7468 6520 6665 6174  mes all the feat
+00019750: 7572 6573 2063 7265 6174 6564 2062 7920  ures created by 
+00019760: 7468 6520 4e4c 5020 636f 6c75 6d6e 2e20  the NLP column. 
+00019770: 4865 6e63 6520 636f 6c20 6e75 6d62 6572  Hence col number
+00019780: 3d31 2061 6e64 2061 7869 733d 3120 2323  =1 and axis=1 ##
+00019790: 230a 2020 2020 666f 7220 6561 6368 5f6e  #.    for each_n
+000197a0: 6c70 2069 6e20 6e6c 7076 6172 733a 0a20  lp in nlpvars:. 
+000197b0: 2020 2020 2020 2063 6f6c 7369 7a65 203d         colsize =
+000197c0: 2063 6f6c 7369 7a65 5f64 6963 745b 6561   colsize_dict[ea
+000197d0: 6368 5f6e 6c70 5d0a 2020 2020 2020 2020  ch_nlp].        
+000197e0: 6e6c 705f 6164 6420 3d20 5b65 6163 685f  nlp_add = [each_
+000197f0: 6e6c 702b 275f 272b 7374 7228 7829 2066  nlp+'_'+str(x) f
+00019800: 6f72 2078 2069 6e20 7261 6e67 6528 636f  or x in range(co
+00019810: 6c73 697a 6529 5d0a 2020 2020 2020 2020  lsize)].        
+00019820: 636f 6c73 5f6e 6c70 202b 3d20 6e6c 705f  cols_nlp += nlp_
+00019830: 6164 640a 2020 2020 2323 2320 7468 6973  add.    ### this
+00019840: 2069 7320 666f 7220 6469 7363 7265 7465   is for discrete
+00019850: 2063 6f6c 756d 6e20 6e61 6d65 7320 2323   column names ##
+00019860: 2323 0a20 2020 2063 6f6c 735f 6469 7363  ##.    cols_disc
+00019870: 7265 7465 203d 205b 5d0a 2020 2020 666f  rete = [].    fo
+00019880: 7220 6561 6368 5f64 6973 6372 6574 6520  r each_discrete 
+00019890: 696e 2064 6973 6372 6574 6576 6172 733a  in discretevars:
+000198a0: 0a20 2020 2020 2020 2023 2323 2066 6f72  .        ### for
+000198b0: 2061 6e79 7468 696e 6720 6f74 6865 7220   anything other 
+000198c0: 7468 616e 206f 6e65 2d68 6f74 2077 6520  than one-hot we 
+000198d0: 7368 6f75 6c64 206a 7573 7420 7573 6520  should just use 
+000198e0: 6c61 6265 6c20 656e 636f 6469 6e67 2074  label encoding t
+000198f0: 6f20 6d61 6b65 2069 7420 7369 6d70 6c65  o make it simple
+00019900: 7220 2323 0a20 2020 2020 2020 2064 6973  r ##.        dis
+00019910: 6372 6574 655f 6164 6420 3d20 6561 6368  crete_add = each
+00019920: 5f64 6973 6372 6574 652b 275f 656e 636f  _discrete+'_enco
+00019930: 6465 6427 0a20 2020 2020 2020 2063 6f6c  ded'.        col
+00019940: 735f 6469 7363 7265 7465 2e61 7070 656e  s_discrete.appen
+00019950: 6428 6469 7363 7265 7465 5f61 6464 290a  d(discrete_add).
+00019960: 2020 2020 2323 2064 6f20 7468 6520 7361      ## do the sa
+00019970: 6d65 2066 6f72 2064 6174 6576 6172 7320  me for datevars 
+00019980: 2323 230a 2020 2020 636f 6c73 5f64 6174  ###.    cols_dat
+00019990: 6520 3d20 5b5d 0a20 2020 2066 6f72 2065  e = [].    for e
+000199a0: 6163 685f 6461 7465 2069 6e20 6461 7465  ach_date in date
+000199b0: 7661 7273 3a0a 2020 2020 2020 2020 2363  vars:.        #c
+000199c0: 6f6c 7369 7a65 203d 2064 6174 6573 697a  olsize = datesiz
+000199d0: 655f 6469 6374 5b65 6163 685f 6461 7465  e_dict[each_date
+000199e0: 5d0a 2020 2020 2020 2020 2364 6174 655f  ].        #date_
+000199f0: 6164 6420 3d20 5b65 6163 685f 6461 7465  add = [each_date
+00019a00: 2b27 5f27 2b73 7472 2878 2920 666f 7220  +'_'+str(x) for 
+00019a10: 7820 696e 2072 616e 6765 2863 6f6c 7369  x in range(colsi
+00019a20: 7a65 295d 0a20 2020 2020 2020 2064 6174  ze)].        dat
+00019a30: 655f 6164 6420 3d20 6461 7465 7369 7a65  e_add = datesize
+00019a40: 5f64 6963 745b 6561 6368 5f64 6174 655d  _dict[each_date]
+00019a50: 0a20 2020 2020 2020 2063 6f6c 735f 6461  .        cols_da
+00019a60: 7465 202b 3d20 6461 7465 5f61 6464 0a0a  te += date_add..
+00019a70: 2020 2020 2323 2323 2074 6869 7320 6973      #### this is
+00019a80: 2077 6865 7265 2077 6520 7075 7420 616c   where we put al
+00019a90: 6c20 7468 6520 636f 6c75 6d6e 206e 616d  l the column nam
+00019aa0: 6573 2074 6f67 6574 6865 7220 2323 2323  es together ####
+00019ab0: 2323 230a 2020 2020 636f 6c73 5f6e 616d  ###.    cols_nam
+00019ac0: 6573 203d 2063 6174 7661 7273 2b63 6f6c  es = catvars+col
+00019ad0: 735f 6469 7363 7265 7465 2b69 6e74 7661  s_discrete+intva
+00019ae0: 7273 2b63 6f6c 735f 6461 7465 0a20 2020  rs+cols_date.   
+00019af0: 206e 756d 5f76 6172 7320 3d20 636f 6c73   num_vars = cols
+00019b00: 5f6e 6c70 2b66 6c6f 6174 7661 7273 0a20  _nlp+floatvars. 
+00019b10: 2020 206e 756d 5f6c 656e 203d 206c 656e     num_len = len
+00019b20: 286e 756d 5f76 6172 7329 0a0a 2020 2020  (num_vars)..    
+00019b30: 2323 2320 5874 2069 7320 6120 5370 6172  ### Xt is a Spar
+00019b40: 7365 206d 6174 7269 7820 6172 7261 792c  se matrix array,
+00019b50: 2077 6520 6e65 6564 2074 6f20 636f 6e76   we need to conv
+00019b60: 6572 7420 6974 2020 746f 2064 656e 7365  ert it  to dense
+00019b70: 2061 7272 6179 2023 230a 2020 2020 6966   array ##.    if
+00019b80: 2073 6369 7079 2e73 7061 7273 652e 6973   scipy.sparse.is
+00019b90: 7370 6172 7365 2858 7429 3a0a 2020 2020  sparse(Xt):.    
+00019ba0: 2020 2020 5874 203d 2058 742e 746f 6172      Xt = Xt.toar
+00019bb0: 7261 7928 290a 0a20 2020 2023 2323 2058  ray()..    ### X
+00019bc0: 7420 6973 2061 6c72 6561 6479 2061 2064  t is already a d
+00019bd0: 656e 7365 2061 7272 6179 2c20 6e6f 206e  ense array, no n
+00019be0: 6565 6420 746f 2063 6f6e 7665 7274 2069  eed to convert i
+00019bf0: 7420 2323 0a20 2020 2069 6620 6e75 6d5f  t ##.    if num_
+00019c00: 6c65 6e20 3d3d 2030 3a0a 2020 2020 2020  len == 0:.      
+00019c10: 2020 5869 6e74 203d 2070 642e 4461 7461    Xint = pd.Data
+00019c20: 4672 616d 6528 5874 5b3a 2c3a 5d2c 2063  Frame(Xt[:,:], c
+00019c30: 6f6c 756d 6e73 203d 2063 6f6c 735f 6e61  olumns = cols_na
+00019c40: 6d65 732c 2064 7479 7065 3d6e 702e 696e  mes, dtype=np.in
+00019c50: 7431 3629 0a20 2020 2020 2020 2072 6574  t16).        ret
+00019c60: 7572 6e20 5869 6e74 0a20 2020 2065 6c73  urn Xint.    els
+00019c70: 653a 0a20 2020 2020 2020 2058 696e 7420  e:.        Xint 
+00019c80: 3d20 7064 2e44 6174 6146 7261 6d65 2858  = pd.DataFrame(X
+00019c90: 745b 3a2c 3a2d 6e75 6d5f 6c65 6e5d 2c20  t[:,:-num_len], 
+00019ca0: 636f 6c75 6d6e 7320 3d20 636f 6c73 5f6e  columns = cols_n
+00019cb0: 616d 6573 2c20 6474 7970 653d 6e70 2e69  ames, dtype=np.i
+00019cc0: 6e74 3136 290a 2020 2020 2020 2020 586e  nt16).        Xn
+00019cd0: 756d 203d 2070 642e 4461 7461 4672 616d  um = pd.DataFram
+00019ce0: 6528 5874 5b3a 2c2d 6e75 6d5f 6c65 6e3a  e(Xt[:,-num_len:
+00019cf0: 5d2c 2063 6f6c 756d 6e73 203d 206e 756d  ], columns = num
+00019d00: 5f76 6172 732c 2064 7479 7065 3d6e 702e  _vars, dtype=np.
+00019d10: 666c 6f61 7433 3229 0a20 2020 2020 2020  float32).       
+00019d20: 2023 2323 2320 7468 6973 2069 7320 7768   #### this is wh
+00019d30: 6572 6520 7765 2070 7574 2061 6c6c 2074  ere we put all t
+00019d40: 6865 2063 6f6c 756d 6e20 6e61 6d65 7320  he column names 
+00019d50: 746f 6765 7468 6572 2023 2323 2323 2323  together #######
+00019d60: 0a20 2020 2020 2020 2064 6620 3d20 7064  .        df = pd
+00019d70: 2e63 6f6e 6361 7428 5b58 696e 742c 2058  .concat([Xint, X
+00019d80: 6e75 6d5d 2c20 6178 6973 3d31 290a 2020  num], axis=1).  
+00019d90: 2020 2020 2020 7265 7475 726e 2064 660a        return df.
+00019da0: 2323 2323 2323 2323 2323 2323 2323 2323  ################
+00019db0: 2323 2323 2323 2323 2323 2323 2323 2323  ################
+00019dc0: 2323 2323 2323 2323 2323 2323 2323 2323  ################
+00019dd0: 2323 2323 2323 2323 2323 2323 2323 2323  ################
+00019de0: 2323 2323 2323 2323 2323 2323 2323 2323  ################
+00019df0: 2323 2323 2323 2323 2323 2323 2323 2323  ################
+00019e00: 2323 2323 2323 2323 2323 2323 230a 696d  #############.im
+00019e10: 706f 7274 2063 6f6c 6c65 6374 696f 6e73  port collections
+00019e20: 0a64 6566 206d 616b 655f 636f 6c75 6d6e  .def make_column
+00019e30: 5f6e 616d 6573 5f75 6e69 7175 6528 636f  _names_unique(co
+00019e40: 6c73 293a 0a20 2020 2073 6572 203d 2070  ls):.    ser = p
+00019e50: 642e 5365 7269 6573 2863 6f6c 7329 0a20  d.Series(cols). 
+00019e60: 2020 2023 2323 2054 6869 7320 6675 6e63     ### This func
+00019e70: 7469 6f6e 2072 656d 6f76 6573 2061 6c6c  tion removes all
+00019e80: 2073 7065 6369 616c 2063 6861 7273 2066   special chars f
+00019e90: 726f 6d20 6120 6c69 7374 2023 2323 0a20  rom a list ###. 
+00019ea0: 2020 2072 656d 6f76 655f 7370 6563 6961     remove_specia
+00019eb0: 6c5f 6368 6172 7320 3d20 206c 616d 6264  l_chars =  lambd
+00019ec0: 6120 783a 7265 2e73 7562 2827 5b5e 412d  a x:re.sub('[^A-
+00019ed0: 5a61 2d7a 302d 395f 5d2b 272c 2027 272c  Za-z0-9_]+', '',
+00019ee0: 2078 290a 2020 2020 0a20 2020 206e 6577   x).    .    new
+00019ef0: 6c73 203d 2073 6572 2e6d 6170 2872 656d  ls = ser.map(rem
+00019f00: 6f76 655f 7370 6563 6961 6c5f 6368 6172  ove_special_char
+00019f10: 7329 2e76 616c 7565 732e 746f 6c69 7374  s).values.tolist
+00019f20: 2829 0a20 2020 2023 2323 2074 6865 7265  ().    ### there
+00019f30: 206d 6179 2062 6520 6475 706c 6963 6174   may be duplicat
+00019f40: 6573 2069 6e20 7468 6973 206c 6973 7420  es in this list 
+00019f50: 2d20 7765 206e 6565 6420 746f 206d 616b  - we need to mak
+00019f60: 6520 7468 656d 2075 6e69 7175 6520 6279  e them unique by
+00019f70: 2072 616e 646f 6d6c 7920 6164 6469 6e67   randomly adding
+00019f80: 2073 7472 696e 6773 2074 6f20 6e61 6d65   strings to name
+00019f90: 2023 230a 2020 2020 7365 656e 203d 205b   ##.    seen = [
+00019fa0: 6974 656d 2066 6f72 2069 7465 6d2c 2063  item for item, c
+00019fb0: 6f75 6e74 2069 6e20 636f 6c6c 6563 7469  ount in collecti
+00019fc0: 6f6e 732e 436f 756e 7465 7228 6e65 776c  ons.Counter(newl
+00019fd0: 7329 2e69 7465 6d73 2829 2069 6620 636f  s).items() if co
+00019fe0: 756e 7420 3e20 315d 0a20 2020 2063 6f6c  unt > 1].    col
+00019ff0: 7320 3d20 5b78 2b73 7472 2872 616e 646f  s = [x+str(rando
+0001a000: 6d2e 7261 6e64 696e 7428 312c 3130 3030  m.randint(1,1000
+0001a010: 2929 2069 6620 7820 696e 2073 6565 6e20  )) if x in seen 
+0001a020: 656c 7365 2078 2066 6f72 2078 2069 6e20  else x for x in 
+0001a030: 6e65 776c 735d 0a20 2020 2072 6574 7572  newls].    retur
+0001a040: 6e20 636f 6c73 0a23 2323 2323 2323 2323  n cols.#########
+0001a050: 2323 2323 2323 2323 2323 2323 2323 2323  ################
+0001a060: 2323 2323 2323 2323 2323 2323 2323 2323  ################
+0001a070: 2323 2323 2323 2323 2323 2323 2323 2323  ################
+0001a080: 2323 2323 2323 2323 2323 2323 2323 2323  ################
+0001a090: 2323 2323 2323 2323 2323 2323 2323 2323  ################
+0001a0a0: 2323 2323 2323 2323 2323 2323 2323 2323  ################
+0001a0b0: 2323 2323 0a64 6566 2063 7265 6174 655f  ####.def create_
+0001a0c0: 636f 6c75 6d6e 5f6e 616d 6573 5f6f 6e65  column_names_one
+0001a0d0: 686f 7428 5874 2c20 6e6c 7076 6172 733d  hot(Xt, nlpvars=
+0001a0e0: 5b5d 2c20 6361 7476 6172 733d 5b5d 2c20  [], catvars=[], 
+0001a0f0: 6469 7363 7265 7465 7661 7273 3d5b 5d2c  discretevars=[],
+0001a100: 2066 6c6f 6174 7661 7273 3d5b 5d2c 2069   floatvars=[], i
+0001a110: 6e74 7661 7273 3d5b 5d2c 0a20 2020 2020  ntvars=[],.     
+0001a120: 2020 2020 2020 2020 2020 2020 2020 2020                  
+0001a130: 2020 2064 6174 6576 6172 733d 5b5d 2c20     datevars=[], 
+0001a140: 6f6e 6568 6f74 5f64 6963 743d 7b7d 2c0a  onehot_dict={},.
+0001a150: 2020 2020 2020 2020 2020 2020 2020 2020                  
+0001a160: 2020 2020 2020 2020 636f 6c73 697a 655f          colsize_
+0001a170: 6469 6374 3d7b 7d2c 2064 6174 6573 697a  dict={}, datesiz
+0001a180: 655f 6469 6374 3d7b 7d29 3a0a 2020 2020  e_dict={}):.    
+0001a190: 2323 2320 5468 6973 206e 616d 6573 2061  ### This names a
+0001a1a0: 6c6c 2074 6865 2066 6561 7475 7265 7320  ll the features 
+0001a1b0: 6372 6561 7465 6420 6279 2074 6865 204e  created by the N
+0001a1c0: 4c50 2063 6f6c 756d 6e2e 2048 656e 6365  LP column. Hence
+0001a1d0: 2063 6f6c 206e 756d 6265 723d 3120 616e   col number=1 an
+0001a1e0: 6420 6178 6973 3d31 2023 2323 0a20 2020  d axis=1 ###.   
+0001a1f0: 2023 2323 204f 6e63 6520 796f 7520 6765   ### Once you ge
+0001a200: 7420 6261 636b 206e 616d 6573 206f 6620  t back names of 
+0001a210: 6f6e 6520 686f 7420 656e 636f 6465 6420  one hot encoded 
+0001a220: 636f 6c75 6d6e 732c 2063 6861 6e67 6520  columns, change 
+0001a230: 7468 6520 636f 6c75 6d6e 206e 616d 6573  the column names
+0001a240: 0a20 2020 2063 6f6c 735f 6361 7420 3d20  .    cols_cat = 
+0001a250: 5b5d 0a20 2020 2078 5f63 6f6c 7320 3d20  [].    x_cols = 
+0001a260: 5b5d 0a20 2020 200a 2020 2020 666f 7220  [].    .    for 
+0001a270: 6561 6368 5f63 6174 2069 6e20 6361 7476  each_cat in catv
+0001a280: 6172 733a 0a20 2020 2020 2020 2063 6174  ars:.        cat
+0001a290: 6567 7320 3d20 6f6e 6568 6f74 5f64 6963  egs = onehot_dic
+0001a2a0: 745b 6561 6368 5f63 6174 5d0a 2020 2020  t[each_cat].    
+0001a2b0: 2020 2020 6966 2069 7369 6e73 7461 6e63      if isinstanc
+0001a2c0: 6528 6361 7465 6773 2c20 7374 7229 3a0a  e(categs, str):.
+0001a2d0: 2020 2020 2020 2020 2020 2020 6966 2063              if c
+0001a2e0: 6174 6567 7320 3d3d 2027 6c61 6265 6c27  ategs == 'label'
+0001a2f0: 3a0a 2020 2020 2020 2020 2020 2020 2020  :.              
+0001a300: 2020 6361 745f 6164 6420 3d20 6561 6368    cat_add = each
+0001a310: 5f63 6174 2b27 5f65 6e63 6f64 6564 270a  _cat+'_encoded'.
+0001a320: 2020 2020 2020 2020 2020 2020 2020 2020                  
+0001a330: 636f 6c73 5f63 6174 2e61 7070 656e 6428  cols_cat.append(
+0001a340: 6361 745f 6164 6429 0a20 2020 2020 2020  cat_add).       
+0001a350: 2020 2020 2065 6c73 653a 0a20 2020 2020       else:.     
+0001a360: 2020 2020 2020 2020 2020 2063 6174 6567             categ
+0001a370: 7320 3d20 5b63 6174 6567 735d 0a20 2020  s = [categs].   
+0001a380: 2020 2020 2020 2020 2020 2020 2063 6174               cat
+0001a390: 5f61 6464 203d 205b 6561 6368 5f63 6174  _add = [each_cat
+0001a3a0: 2b27 5f27 2b73 7472 2863 6174 6567 735b  +'_'+str(categs[
+0001a3b0: 695d 2920 666f 7220 6920 696e 2072 616e  i]) for i in ran
+0001a3c0: 6765 286c 656e 2863 6174 6567 7329 295d  ge(len(categs))]
+0001a3d0: 0a20 2020 2020 2020 2020 2020 2020 2020  .               
+0001a3e0: 2063 6f6c 735f 6361 7420 2b3d 2063 6174   cols_cat += cat
+0001a3f0: 5f61 6464 0a20 2020 2020 2020 2065 6c73  _add.        els
+0001a400: 653a 0a20 2020 2020 2020 2020 2020 2063  e:.            c
+0001a410: 6174 5f61 6464 203d 205b 6561 6368 5f63  at_add = [each_c
+0001a420: 6174 2b27 5f27 2b73 7472 2863 6174 6567  at+'_'+str(categ
+0001a430: 735b 695d 2920 666f 7220 6920 696e 2072  s[i]) for i in r
+0001a440: 616e 6765 286c 656e 2863 6174 6567 7329  ange(len(categs)
+0001a450: 295d 0a20 2020 2020 2020 2020 2020 2063  )].            c
+0001a460: 6f6c 735f 6361 7420 2b3d 2063 6174 5f61  ols_cat += cat_a
+0001a470: 6464 0a20 2020 200a 2020 2020 636f 6c73  dd.    .    cols
+0001a480: 5f63 6174 203d 206d 616b 655f 636f 6c75  _cat = make_colu
+0001a490: 6d6e 5f6e 616d 6573 5f75 6e69 7175 6528  mn_names_unique(
+0001a4a0: 636f 6c73 5f63 6174 290a 2020 2020 0a20  cols_cat).    . 
+0001a4b0: 2020 2063 6f6c 735f 6469 7363 7265 7465     cols_discrete
+0001a4c0: 203d 205b 5d0a 2020 2020 6469 7363 7265   = [].    discre
+0001a4d0: 7465 5f61 6464 203d 205b 5d0a 2020 2020  te_add = [].    
+0001a4e0: 666f 7220 6561 6368 5f64 6973 6372 6574  for each_discret
+0001a4f0: 6520 696e 2064 6973 6372 6574 6576 6172  e in discretevar
+0001a500: 733a 0a20 2020 2020 2020 2023 2323 2066  s:.        ### f
+0001a510: 6f72 2061 6e79 7468 696e 6720 6f74 6865  or anything othe
+0001a520: 7220 7468 616e 206f 6e65 2d68 6f74 2077  r than one-hot w
+0001a530: 6520 7368 6f75 6c64 206a 7573 7420 7573  e should just us
+0001a540: 6520 6c61 6265 6c20 656e 636f 6469 6e67  e label encoding
+0001a550: 2074 6f20 6d61 6b65 2069 7420 7369 6d70   to make it simp
+0001a560: 6c65 7220 2323 0a20 2020 2020 2020 2074  ler ##.        t
+0001a570: 7279 3a0a 2020 2020 2020 2020 2020 2020  ry:.            
+0001a580: 6361 7465 6773 203d 206f 6e65 686f 745f  categs = onehot_
+0001a590: 6469 6374 5b65 6163 685f 6469 7363 7265  dict[each_discre
+0001a5a0: 7465 5d0a 2020 2020 2020 2020 2020 2020  te].            
+0001a5b0: 6966 2069 7369 6e73 7461 6e63 6528 6361  if isinstance(ca
+0001a5c0: 7465 6773 2c20 7374 7229 3a0a 2020 2020  tegs, str):.    
+0001a5d0: 2020 2020 2020 2020 2020 2020 6966 2063              if c
+0001a5e0: 6174 6567 7320 3d3d 2027 6c61 6265 6c27  ategs == 'label'
+0001a5f0: 3a0a 2020 2020 2020 2020 2020 2020 2020  :.              
+0001a600: 2020 2020 2020 6469 7363 7265 7465 5f61        discrete_a
+0001a610: 6464 203d 2065 6163 685f 6469 7363 7265  dd = each_discre
+0001a620: 7465 2b27 5f65 6e63 6f64 6564 270a 2020  te+'_encoded'.  
+0001a630: 2020 2020 2020 2020 2020 2020 2020 2020                  
+0001a640: 2020 636f 6c73 5f64 6973 6372 6574 652e    cols_discrete.
+0001a650: 6170 7065 6e64 2864 6973 6372 6574 655f  append(discrete_
+0001a660: 6164 6429 0a20 2020 2020 2020 2020 2020  add).           
+0001a670: 2020 2020 2065 6c73 653a 0a20 2020 2020       else:.     
+0001a680: 2020 2020 2020 2020 2020 2020 2020 2063                 c
+0001a690: 6174 6567 7320 3d20 5b63 6174 6567 735d  ategs = [categs]
+0001a6a0: 0a20 2020 2020 2020 2020 2020 2020 2020  .               
+0001a6b0: 2020 2020 2064 6973 6372 6574 655f 6164       discrete_ad
+0001a6c0: 6420 3d20 5b65 6163 685f 6469 7363 7265  d = [each_discre
+0001a6d0: 7465 2b27 5f27 2b78 2066 6f72 2078 2069  te+'_'+x for x i
+0001a6e0: 6e20 6361 7465 6773 5d0a 2020 2020 2020  n categs].      
+0001a6f0: 2020 2020 2020 2020 2020 2020 2020 636f                co
+0001a700: 6c73 5f64 6973 6372 6574 6520 2b3d 2064  ls_discrete += d
+0001a710: 6973 6372 6574 655f 6164 640a 2020 2020  iscrete_add.    
+0001a720: 2020 2020 2020 2020 656c 7365 3a0a 2020          else:.  
+0001a730: 2020 2020 2020 2020 2020 2020 2020 6469                di
+0001a740: 7363 7265 7465 5f61 6464 203d 205b 6561  screte_add = [ea
+0001a750: 6368 5f64 6973 6372 6574 652b 275f 272b  ch_discrete+'_'+
+0001a760: 7820 666f 7220 7820 696e 2063 6174 6567  x for x in categ
+0001a770: 735d 0a20 2020 2020 2020 2020 2020 2020  s].             
+0001a780: 2020 2063 6f6c 735f 6469 7363 7265 7465     cols_discrete
+0001a790: 202b 3d20 6469 7363 7265 7465 5f61 6464   += discrete_add
+0001a7a0: 0a20 2020 2020 2020 2065 7863 6570 743a  .        except:
+0001a7b0: 0a20 2020 2020 2020 2020 2020 2023 2323  .            ###
+0001a7c0: 2069 6620 7468 6572 6520 6973 206e 6f20   if there is no 
+0001a7d0: 6e65 7720 7661 7220 746f 2062 6520 6372  new var to be cr
+0001a7e0: 6561 7465 642c 206a 7573 7420 7573 6520  eated, just use 
+0001a7f0: 7468 6520 6578 6973 7469 6e67 2064 6973  the existing dis
+0001a800: 6372 6574 6520 7661 7273 2069 7473 656c  crete vars itsel
+0001a810: 6620 2323 230a 2020 2020 2020 2020 2020  f ###.          
+0001a820: 2020 636f 6c73 5f64 6973 6372 6574 652e    cols_discrete.
+0001a830: 6170 7065 6e64 2865 6163 685f 6469 7363  append(each_disc
+0001a840: 7265 7465 290a 2020 2020 636f 6c73 5f64  rete).    cols_d
+0001a850: 6973 6372 6574 6520 3d20 6d61 6b65 5f63  iscrete = make_c
+0001a860: 6f6c 756d 6e5f 6e61 6d65 735f 756e 6971  olumn_names_uniq
+0001a870: 7565 2863 6f6c 735f 6469 7363 7265 7465  ue(cols_discrete
+0001a880: 290a 2020 2020 0a20 2020 2063 6f6c 735f  ).    .    cols_
+0001a890: 6e6c 7020 3d20 5b5d 0a20 2020 206e 6c70  nlp = [].    nlp
+0001a8a0: 5f61 6464 203d 205b 5d0a 2020 2020 666f  _add = [].    fo
+0001a8b0: 7220 6561 6368 5f6e 6c70 2069 6e20 6e6c  r each_nlp in nl
+0001a8c0: 7076 6172 733a 0a20 2020 2020 2020 2063  pvars:.        c
+0001a8d0: 6f6c 7369 7a65 203d 2063 6f6c 7369 7a65  olsize = colsize
+0001a8e0: 5f64 6963 745b 6561 6368 5f6e 6c70 5d0a  _dict[each_nlp].
+0001a8f0: 2020 2020 2020 2020 6e6c 705f 6164 6420          nlp_add 
+0001a900: 3d20 5b65 6163 685f 6e6c 702b 275f 272b  = [each_nlp+'_'+
+0001a910: 7374 7228 7829 2066 6f72 2078 2069 6e20  str(x) for x in 
+0001a920: 7261 6e67 6528 636f 6c73 697a 6529 5d0a  range(colsize)].
+0001a930: 2020 2020 2020 2020 636f 6c73 5f6e 6c70          cols_nlp
+0001a940: 202b 3d20 6e6c 705f 6164 640a 2020 2020   += nlp_add.    
+0001a950: 2323 2064 6f20 7468 6520 7361 6d65 2066  ## do the same f
+0001a960: 6f72 2064 6174 6576 6172 7320 2323 230a  or datevars ###.
+0001a970: 2020 2020 636f 6c73 5f64 6174 6520 3d20      cols_date = 
+0001a980: 5b5d 0a20 2020 2064 6174 655f 6164 6420  [].    date_add 
+0001a990: 3d20 5b5d 0a20 2020 2066 6f72 2065 6163  = [].    for eac
+0001a9a0: 685f 6461 7465 2069 6e20 6461 7465 7661  h_date in dateva
+0001a9b0: 7273 3a0a 2020 2020 2020 2020 2363 6f6c  rs:.        #col
+0001a9c0: 7369 7a65 203d 2064 6174 6573 697a 655f  size = datesize_
+0001a9d0: 6469 6374 5b65 6163 685f 6461 7465 5d0a  dict[each_date].
+0001a9e0: 2020 2020 2020 2020 2364 6174 655f 6164          #date_ad
+0001a9f0: 6420 3d20 5b65 6163 685f 6461 7465 2b27  d = [each_date+'
+0001aa00: 5f27 2b73 7472 2878 2920 666f 7220 7820  _'+str(x) for x 
+0001aa10: 696e 2072 616e 6765 2863 6f6c 7369 7a65  in range(colsize
+0001aa20: 295d 0a20 2020 2020 2020 2064 6174 655f  )].        date_
+0001aa30: 6164 6420 3d20 6461 7465 7369 7a65 5f64  add = datesize_d
+0001aa40: 6963 745b 6561 6368 5f64 6174 655d 0a20  ict[each_date]. 
+0001aa50: 2020 2020 2020 2063 6f6c 735f 6461 7465         cols_date
+0001aa60: 202b 3d20 6461 7465 5f61 6464 0a20 2020   += date_add.   
+0001aa70: 2023 2323 2052 656d 656d 6265 7220 646f   ### Remember do
+0001aa80: 6e27 7420 636f 6d62 696e 6520 7468 6520  n't combine the 
+0001aa90: 6e65 7874 2032 206c 696e 6573 2069 6e74  next 2 lines int
+0001aaa0: 6f20 6f6e 652e 2054 6861 7420 7769 6c6c  o one. That will
+0001aab0: 2062 6520 6120 6469 7361 7374 6572 2e0a   be a disaster..
+0001aac0: 2020 2020 2323 2320 5061 6e64 6173 2069      ### Pandas i
+0001aad0: 6e66 6572 7320 6461 7461 2074 7970 6573  nfers data types
+0001aae0: 2061 7574 6d61 7469 6361 6c6c 7920 616e   autmatically an
+0001aaf0: 6420 7468 6579 2061 6c77 6179 7320 6172  d they always ar
+0001ab00: 6520 666c 6f61 7436 342e 2053 6f0a 2020  e float64. So.  
+0001ab10: 2020 2323 2320 2074 6f20 6176 6f69 6420    ###  to avoid 
+0001ab20: 7468 6174 2049 2068 6176 6520 7370 6c69  that I have spli
+0001ab30: 7420 7468 6520 6461 7461 2069 6e74 6f20  t the data into 
+0001ab40: 7477 6f20 6f72 2074 6872 6565 2074 7970  two or three typ
+0001ab50: 6573 200a 2020 2020 636f 6c73 5f6e 616d  es .    cols_nam
+0001ab60: 6573 203d 2063 6f6c 735f 6361 742b 636f  es = cols_cat+co
+0001ab70: 6c73 5f64 6973 6372 6574 652b 696e 7476  ls_discrete+intv
+0001ab80: 6172 732b 636f 6c73 5f64 6174 650a 2020  ars+cols_date.  
+0001ab90: 2020 6e75 6d5f 7661 7273 203d 2063 6f6c    num_vars = col
+0001aba0: 735f 6e6c 702b 666c 6f61 7476 6172 730a  s_nlp+floatvars.
+0001abb0: 2020 2020 6e75 6d5f 6c65 6e20 3d20 6c65      num_len = le
+0001abc0: 6e28 6e75 6d5f 7661 7273 290a 2020 2020  n(num_vars).    
+0001abd0: 0a20 2020 2023 2323 2058 7420 6973 2061  .    ### Xt is a
+0001abe0: 2053 7061 7273 6520 6d61 7472 6978 2061   Sparse matrix a
+0001abf0: 7272 6179 2c20 7765 206e 6565 6420 746f  rray, we need to
+0001ac00: 2063 6f6e 7665 7274 2069 7420 2074 6f20   convert it  to 
+0001ac10: 6465 6e73 6520 6172 7261 7920 2323 0a20  dense array ##. 
+0001ac20: 2020 2069 6620 7363 6970 792e 7370 6172     if scipy.spar
+0001ac30: 7365 2e69 7373 7061 7273 6528 5874 293a  se.issparse(Xt):
+0001ac40: 0a20 2020 2020 2020 2058 7420 3d20 5874  .        Xt = Xt
+0001ac50: 2e74 6f61 7272 6179 2829 0a20 2020 2023  .toarray().    #
+0001ac60: 2323 2058 7420 6973 2061 6c72 6561 6479  ## Xt is already
+0001ac70: 2061 2064 656e 7365 2061 7272 6179 2c20   a dense array, 
+0001ac80: 6e6f 206e 6565 6420 746f 2063 6f6e 7665  no need to conve
+0001ac90: 7274 2069 7420 2323 0a20 2020 2023 2323  rt it ##.    ###
+0001aca0: 2052 656d 656d 6265 7220 646f 6e27 7420   Remember don't 
+0001acb0: 636f 6d62 696e 6520 7468 6520 6e65 7874  combine the next
+0001acc0: 2032 206c 696e 6573 2069 6e74 6f20 6f6e   2 lines into on
+0001acd0: 652e 2054 6861 7420 7769 6c6c 2062 6520  e. That will be 
+0001ace0: 6120 6469 7361 7374 6572 2e0a 2020 2020  a disaster..    
+0001acf0: 2323 2320 5061 6e64 6173 2069 6e66 6572  ### Pandas infer
+0001ad00: 7320 6461 7461 2074 7970 6573 2061 7574  s data types aut
+0001ad10: 6d61 7469 6361 6c6c 7920 616e 6420 7468  matically and th
+0001ad20: 6579 2061 6c77 6179 7320 6172 6520 666c  ey always are fl
+0001ad30: 6f61 7436 342e 2053 6f0a 2020 2020 2323  oat64. So.    ##
+0001ad40: 2320 2074 6f20 6176 6f69 6420 7468 6174  #  to avoid that
+0001ad50: 2049 2068 6176 6520 7370 6c69 7420 7468   I have split th
+0001ad60: 6520 6461 7461 2069 6e74 6f20 7477 6f20  e data into two 
+0001ad70: 6f72 2074 6872 6565 2074 7970 6573 200a  or three types .
+0001ad80: 2020 2020 6966 206e 756d 5f6c 656e 203d      if num_len =
+0001ad90: 3d20 303a 0a20 2020 2020 2020 2058 696e  = 0:.        Xin
+0001ada0: 7420 3d20 7064 2e44 6174 6146 7261 6d65  t = pd.DataFrame
+0001adb0: 2858 745b 3a2c 3a5d 2c20 636f 6c75 6d6e  (Xt[:,:], column
+0001adc0: 7320 3d20 636f 6c73 5f6e 616d 6573 2c20  s = cols_names, 
+0001add0: 6474 7970 653d 6e70 2e69 6e74 3136 290a  dtype=np.int16).
+0001ade0: 2020 2020 2020 2020 7265 7475 726e 2058          return X
+0001adf0: 696e 740a 2020 2020 656c 7365 3a0a 2020  int.    else:.  
+0001ae00: 2020 2020 2020 5869 6e74 203d 2070 642e        Xint = pd.
+0001ae10: 4461 7461 4672 616d 6528 5874 5b3a 2c3a  DataFrame(Xt[:,:
+0001ae20: 2d6e 756d 5f6c 656e 5d2c 2063 6f6c 756d  -num_len], colum
+0001ae30: 6e73 203d 2063 6f6c 735f 6e61 6d65 732c  ns = cols_names,
+0001ae40: 2064 7479 7065 3d6e 702e 696e 7431 3629   dtype=np.int16)
+0001ae50: 0a20 2020 2020 2020 2058 6e75 6d20 3d20  .        Xnum = 
+0001ae60: 7064 2e44 6174 6146 7261 6d65 2858 745b  pd.DataFrame(Xt[
+0001ae70: 3a2c 2d6e 756d 5f6c 656e 3a5d 2c20 636f  :,-num_len:], co
+0001ae80: 6c75 6d6e 7320 3d20 6e75 6d5f 7661 7273  lumns = num_vars
+0001ae90: 2c20 6474 7970 653d 6e70 2e66 6c6f 6174  , dtype=np.float
+0001aea0: 3332 290a 2020 2020 2020 2020 2323 2323  32).        ####
+0001aeb0: 2074 6869 7320 6973 2077 6865 7265 2077   this is where w
+0001aec0: 6520 7075 7420 616c 6c20 7468 6520 636f  e put all the co
+0001aed0: 6c75 6d6e 206e 616d 6573 2074 6f67 6574  lumn names toget
+0001aee0: 6865 7220 2323 2323 2323 230a 2020 2020  her #######.    
+0001aef0: 2020 2020 6466 203d 2070 642e 636f 6e63      df = pd.conc
+0001af00: 6174 285b 5869 6e74 2c20 586e 756d 5d2c  at([Xint, Xnum],
+0001af10: 2061 7869 733d 3129 0a20 2020 2020 2020   axis=1).       
+0001af20: 2072 6574 7572 6e20 6466 0a23 2323 2323   return df.#####
+0001af30: 2323 2323 2323 2323 2323 2323 2323 2323  ################
+0001af40: 2323 2323 2323 2323 2323 2323 2323 2323  ################
+0001af50: 2323 2323 2323 2323 2323 2323 2323 2323  ################
+0001af60: 2323 2323 2323 2323 2323 2323 2323 2323  ################
+0001af70: 2323 2323 2323 2323 2323 2323 2323 2323  ################
+0001af80: 230a 6465 6620 6669 6e64 5f72 656d 6f76  #.def find_remov
+0001af90: 655f 6475 706c 6963 6174 6573 286c 6973  e_duplicates(lis
+0001afa0: 745f 6f66 5f76 616c 7565 7329 3a0a 2020  t_of_values):.  
+0001afb0: 2020 2222 220a 2020 2020 2320 5265 6d6f    """.    # Remo
+0001afc0: 7665 7320 6475 706c 6963 6174 6573 2066  ves duplicates f
+0001afd0: 726f 6d20 6120 6c69 7374 2074 6f20 7265  rom a list to re
+0001afe0: 7475 726e 2075 6e69 7175 6520 7661 6c75  turn unique valu
+0001aff0: 6573 202d 2055 5345 4420 4f4e 4c59 204f  es - USED ONLY O
+0001b000: 4e43 450a 2020 2020 2222 220a 2020 2020  NCE.    """.    
+0001b010: 6f75 7470 7574 203d 205b 5d0a 2020 2020  output = [].    
+0001b020: 7365 656e 203d 2073 6574 2829 0a20 2020  seen = set().   
+0001b030: 2066 6f72 2076 616c 7565 2069 6e20 6c69   for value in li
+0001b040: 7374 5f6f 665f 7661 6c75 6573 3a0a 2020  st_of_values:.  
+0001b050: 2020 2020 2020 6966 2076 616c 7565 206e        if value n
+0001b060: 6f74 2069 6e20 7365 656e 3a0a 2020 2020  ot in seen:.    
+0001b070: 2020 2020 2020 2020 6f75 7470 7574 2e61          output.a
+0001b080: 7070 656e 6428 7661 6c75 6529 0a20 2020  ppend(value).   
+0001b090: 2020 2020 2020 2020 2073 6565 6e2e 6164           seen.ad
+0001b0a0: 6428 7661 6c75 6529 0a20 2020 2072 6574  d(value).    ret
+0001b0b0: 7572 6e20 6f75 7470 7574 0a0a 6465 6620  urn output..def 
+0001b0c0: 636f 6e76 6572 745f 6365 5f74 6f5f 7069  convert_ce_to_pi
+0001b0d0: 7065 2858 7429 3a20 2020 200a 2020 2020  pe(Xt):    .    
+0001b0e0: 2323 2320 5468 6973 2063 6f6e 7665 7274  ### This convert
+0001b0f0: 7320 6120 7365 7269 6573 2074 6f20 6120  s a series to a 
+0001b100: 6461 7461 6672 616d 6520 746f 206d 616b  dataframe to mak
+0001b110: 6520 6361 7465 676f 7279 2065 6e63 6f64  e category encod
+0001b120: 6572 7320 776f 726b 2069 6e20 736b 6c65  ers work in skle
+0001b130: 6172 6e20 7069 7065 6c69 6e65 7320 2323  arn pipelines ##
+0001b140: 230a 2020 2020 6966 2073 7472 2858 742e  #.    if str(Xt.
+0001b150: 6474 7970 6529 203d 3d20 2763 6174 6567  dtype) == 'categ
+0001b160: 6f72 7927 3a0a 2020 2020 2020 2020 5874  ory':.        Xt
+0001b170: 7820 3d20 5874 2e63 6174 2e72 656e 616d  x = Xt.cat.renam
+0001b180: 655f 6361 7465 676f 7269 6573 2873 7472  e_categories(str
+0001b190: 292e 7661 6c75 6573 2e74 6f6c 6973 7428  ).values.tolist(
+0001b1a0: 290a 2020 2020 2020 2020 7265 7475 726e  ).        return
+0001b1b0: 2070 642e 4461 7461 4672 616d 6528 5874   pd.DataFrame(Xt
+0001b1c0: 782c 2063 6f6c 756d 6e73 3d5b 5874 2e6e  x, columns=[Xt.n
+0001b1d0: 616d 655d 290a 2020 2020 656c 7365 3a0a  ame]).    else:.
+0001b1e0: 2020 2020 2020 2020 5874 7820 3d20 5874          Xtx = Xt
+0001b1f0: 2e66 696c 6c6e 6128 276d 6973 7369 6e67  .fillna('missing
+0001b200: 2729 0a20 2020 2020 2020 2072 6574 7572  ').        retur
+0001b210: 6e20 7064 2e44 6174 6146 7261 6d65 2858  n pd.DataFrame(X
+0001b220: 7478 290a 2323 2323 2323 2323 2323 2323  tx).############
+0001b230: 2323 2323 2323 2323 2323 2323 2323 2323  ################
+0001b240: 2323 2323 2323 2323 2323 2323 2323 2323  ################
+0001b250: 2323 2323 2323 2323 2323 2323 2323 2323  ################
+0001b260: 2323 2323 2323 2323 2323 2323 2323 2323  ################
+0001b270: 2323 2323 2323 2323 230a 2323 2323 2052  #########.#### R
+0001b280: 6567 7265 7373 696f 6e20 6f72 2043 6c61  egression or Cla
+0001b290: 7373 6966 6963 6174 696f 6e20 7479 7065  ssification type
+0001b2a0: 2070 726f 626c 656d 0a64 6566 2061 6e61   problem.def ana
+0001b2b0: 6c79 7a65 5f70 726f 626c 656d 5f74 7970  lyze_problem_typ
+0001b2c0: 6528 795f 7472 6169 6e2c 2074 6172 6765  e(y_train, targe
+0001b2d0: 742c 2076 6572 626f 7365 3d30 2920 3a20  t, verbose=0) : 
+0001b2e0: 200a 2020 2020 795f 7472 6169 6e20 3d20   .    y_train = 
+0001b2f0: 636f 7079 2e64 6565 7063 6f70 7928 795f  copy.deepcopy(y_
+0001b300: 7472 6169 6e29 0a20 2020 2063 6174 5f6c  train).    cat_l
+0001b310: 696d 6974 203d 2033 3020 2323 2320 7468  imit = 30 ### th
+0001b320: 6973 2064 6574 6572 6d69 6e65 7320 7468  is determines th
+0001b330: 6520 6e75 6d62 6572 206f 6620 6361 7465  e number of cate
+0001b340: 676f 7269 6573 2074 6f20 6e61 6d65 2069  gories to name i
+0001b350: 6e74 6567 6572 7320 6173 2063 6c61 7373  ntegers as class
+0001b360: 6966 6963 6174 696f 6e20 2323 0a20 2020  ification ##.   
+0001b370: 2066 6c6f 6174 5f6c 696d 6974 203d 2031   float_limit = 1
+0001b380: 3520 2323 2320 7468 6973 206c 696d 6974  5 ### this limit
+0001b390: 7320 7468 6520 6e75 6d62 6572 206f 6620  s the number of 
+0001b3a0: 666c 6f61 7420 7661 7269 6162 6c65 2063  float variable c
+0001b3b0: 6174 6567 6f72 6965 7320 666f 7220 6974  ategories for it
+0001b3c0: 2074 6f20 6265 636f 6d65 2063 6174 2076   to become cat v
+0001b3d0: 6172 0a20 2020 2069 6620 6973 696e 7374  ar.    if isinst
+0001b3e0: 616e 6365 2874 6172 6765 742c 2073 7472  ance(target, str
+0001b3f0: 293a 0a20 2020 2020 2020 206d 756c 7469  ):.        multi
+0001b400: 5f6c 6162 656c 203d 2046 616c 7365 0a20  _label = False. 
+0001b410: 2020 2020 2020 2073 7472 696e 675f 7461         string_ta
+0001b420: 7267 6574 203d 2054 7275 650a 2020 2020  rget = True.    
+0001b430: 656c 7365 3a0a 2020 2020 2020 2020 6966  else:.        if
+0001b440: 206c 656e 2874 6172 6765 7429 203d 3d20   len(target) == 
+0001b450: 313a 0a20 2020 2020 2020 2020 2020 206d  1:.            m
+0001b460: 756c 7469 5f6c 6162 656c 203d 2046 616c  ulti_label = Fal
+0001b470: 7365 0a20 2020 2020 2020 2020 2020 2073  se.            s
+0001b480: 7472 696e 675f 7461 7267 6574 203d 2046  tring_target = F
+0001b490: 616c 7365 0a20 2020 2020 2020 2065 6c73  alse.        els
+0001b4a0: 653a 0a20 2020 2020 2020 2020 2020 206d  e:.            m
+0001b4b0: 756c 7469 5f6c 6162 656c 203d 2054 7275  ulti_label = Tru
+0001b4c0: 650a 2020 2020 2020 2020 2020 2020 7374  e.            st
+0001b4d0: 7269 6e67 5f74 6172 6765 7420 3d20 4661  ring_target = Fa
+0001b4e0: 6c73 650a 2020 2020 2323 2323 2020 5468  lse.    ####  Th
+0001b4f0: 6973 2069 7320 7768 6572 6520 796f 7520  is is where you 
+0001b500: 6465 7465 6374 2077 6861 7420 6b69 6e64  detect what kind
+0001b510: 206f 6620 7072 6f62 6c65 6d20 6974 2069   of problem it i
+0001b520: 7320 2323 2323 2323 2323 2323 2323 2323  s ##############
+0001b530: 2323 230a 2020 2020 6966 2073 7472 696e  ###.    if strin
+0001b540: 675f 7461 7267 6574 3a0a 2020 2020 2020  g_target:.      
+0001b550: 2020 2323 2049 6620 7461 7267 6574 2069    ## If target i
+0001b560: 7320 6120 7374 7269 6e67 2074 6865 6e20  s a string then 
+0001b570: 7765 2073 686f 756c 6420 7465 7374 2066  we should test f
+0001b580: 6f72 2064 7479 7065 7320 7468 6973 2077  or dtypes this w
+0001b590: 6179 2023 2323 2323 0a20 2020 2020 2020  ay #####.       
+0001b5a0: 2069 6620 2079 5f74 7261 696e 2e64 7479   if  y_train.dty
+0001b5b0: 7065 2069 6e20 5b27 696e 7436 3427 2c20  pe in ['int64', 
+0001b5c0: 2769 6e74 3332 272c 2769 6e74 3136 275d  'int32','int16']
+0001b5d0: 3a0a 2020 2020 2020 2020 2020 2020 6966  :.            if
+0001b5e0: 206c 656e 286e 702e 756e 6971 7565 2879   len(np.unique(y
+0001b5f0: 5f74 7261 696e 2929 203c 3d20 323a 0a20  _train)) <= 2:. 
+0001b600: 2020 2020 2020 2020 2020 2020 2020 206d                 m
+0001b610: 6f64 656c 5f63 6c61 7373 203d 2027 4269  odel_class = 'Bi
+0001b620: 6e61 7279 5f43 6c61 7373 6966 6963 6174  nary_Classificat
+0001b630: 696f 6e27 0a20 2020 2020 2020 2020 2020  ion'.           
+0001b640: 2065 6c69 6620 6c65 6e28 795f 7472 6169   elif len(y_trai
+0001b650: 6e2e 756e 6971 7565 2829 2920 3e20 3220  n.unique()) > 2 
+0001b660: 616e 6420 6c65 6e28 795f 7472 6169 6e2e  and len(y_train.
+0001b670: 756e 6971 7565 2829 2920 3c3d 2063 6174  unique()) <= cat
+0001b680: 5f6c 696d 6974 3a0a 2020 2020 2020 2020  _limit:.        
+0001b690: 2020 2020 2020 2020 6d6f 6465 6c5f 636c          model_cl
+0001b6a0: 6173 7320 3d20 274d 756c 7469 5f43 6c61  ass = 'Multi_Cla
+0001b6b0: 7373 6966 6963 6174 696f 6e27 0a20 2020  ssification'.   
+0001b6c0: 2020 2020 2020 2020 2065 6c73 653a 0a20           else:. 
+0001b6d0: 2020 2020 2020 2020 2020 2020 2020 206d                 m
+0001b6e0: 6f64 656c 5f63 6c61 7373 203d 2027 5265  odel_class = 'Re
+0001b6f0: 6772 6573 7369 6f6e 270a 2020 2020 2020  gression'.      
+0001b700: 2020 656c 6966 2020 795f 7472 6169 6e2e    elif  y_train.
+0001b710: 6474 7970 6520 696e 205b 2766 6c6f 6174  dtype in ['float
+0001b720: 3136 272c 2766 6c6f 6174 3332 272c 2766  16','float32','f
+0001b730: 6c6f 6174 3634 275d 3a0a 2020 2020 2020  loat64']:.      
+0001b740: 2020 2020 2020 6966 206c 656e 2879 5f74        if len(y_t
+0001b750: 7261 696e 2e75 6e69 7175 6528 2929 203c  rain.unique()) <
+0001b760: 3d20 323a 0a20 2020 2020 2020 2020 2020  = 2:.           
+0001b770: 2020 2020 206d 6f64 656c 5f63 6c61 7373       model_class
+0001b780: 203d 2027 4269 6e61 7279 5f43 6c61 7373   = 'Binary_Class
+0001b790: 6966 6963 6174 696f 6e27 0a20 2020 2020  ification'.     
+0001b7a0: 2020 2020 2020 2065 6c69 6620 6c65 6e28         elif len(
+0001b7b0: 795f 7472 6169 6e2e 756e 6971 7565 2829  y_train.unique()
+0001b7c0: 2920 3e20 3220 616e 6420 6c65 6e28 795f  ) > 2 and len(y_
+0001b7d0: 7472 6169 6e2e 756e 6971 7565 2829 2920  train.unique()) 
+0001b7e0: 3c3d 2066 6c6f 6174 5f6c 696d 6974 3a0a  <= float_limit:.
+0001b7f0: 2020 2020 2020 2020 2020 2020 2020 2020                  
+0001b800: 6d6f 6465 6c5f 636c 6173 7320 3d20 274d  model_class = 'M
+0001b810: 756c 7469 5f43 6c61 7373 6966 6963 6174  ulti_Classificat
+0001b820: 696f 6e27 0a20 2020 2020 2020 2020 2020  ion'.           
+0001b830: 2065 6c73 653a 0a20 2020 2020 2020 2020   else:.         
+0001b840: 2020 2020 2020 206d 6f64 656c 5f63 6c61         model_cla
+0001b850: 7373 203d 2027 5265 6772 6573 7369 6f6e  ss = 'Regression
+0001b860: 270a 2020 2020 2020 2020 656c 7365 3a0a  '.        else:.
+0001b870: 2020 2020 2020 2020 2020 2020 6966 206c              if l
+0001b880: 656e 2879 5f74 7261 696e 2e75 6e69 7175  en(y_train.uniqu
+0001b890: 6528 2929 203c 3d20 323a 0a20 2020 2020  e()) <= 2:.     
+0001b8a0: 2020 2020 2020 2020 2020 206d 6f64 656c             model
+0001b8b0: 5f63 6c61 7373 203d 2027 4269 6e61 7279  _class = 'Binary
+0001b8c0: 5f43 6c61 7373 6966 6963 6174 696f 6e27  _Classification'
+0001b8d0: 0a20 2020 2020 2020 2020 2020 2065 6c73  .            els
+0001b8e0: 653a 0a20 2020 2020 2020 2020 2020 2020  e:.             
+0001b8f0: 2020 206d 6f64 656c 5f63 6c61 7373 203d     model_class =
+0001b900: 2027 4d75 6c74 695f 436c 6173 7369 6669   'Multi_Classifi
+0001b910: 6361 7469 6f6e 270a 2020 2020 656c 7365  cation'.    else
+0001b920: 3a0a 2020 2020 2020 2020 666f 7220 6920  :.        for i 
+0001b930: 696e 2072 616e 6765 2879 5f74 7261 696e  in range(y_train
+0001b940: 2e73 6861 7065 5b31 5d29 3a0a 2020 2020  .shape[1]):.    
+0001b950: 2020 2020 2020 2020 2323 2320 6966 2074          ### if t
+0001b960: 6172 6765 7420 6973 2061 206c 6973 742c  arget is a list,
+0001b970: 2074 6865 6e20 7765 2073 686f 756c 6420   then we should 
+0001b980: 7465 7374 2064 7479 7065 7320 6120 6469  test dtypes a di
+0001b990: 6666 6572 656e 7420 7761 7920 2323 230a  fferent way ###.
+0001b9a0: 2020 2020 2020 2020 2020 2020 6966 2079              if y
+0001b9b0: 5f74 7261 696e 2e64 7479 7065 732e 7661  _train.dtypes.va
+0001b9c0: 6c75 6573 2e61 6c6c 2829 2069 6e20 5b27  lues.all() in ['
+0001b9d0: 696e 7436 3427 2c20 2769 6e74 3332 272c  int64', 'int32',
+0001b9e0: 2769 6e74 3136 275d 3a0a 2020 2020 2020  'int16']:.      
+0001b9f0: 2020 2020 2020 2020 2020 6966 206c 656e            if len
+0001ba00: 286e 702e 756e 6971 7565 2879 5f74 7261  (np.unique(y_tra
+0001ba10: 696e 2e69 6c6f 635b 3a2c 305d 2929 203c  in.iloc[:,0])) <
+0001ba20: 3d20 323a 0a20 2020 2020 2020 2020 2020  = 2:.           
+0001ba30: 2020 2020 2020 2020 206d 6f64 656c 5f63           model_c
+0001ba40: 6c61 7373 203d 2027 4269 6e61 7279 5f43  lass = 'Binary_C
+0001ba50: 6c61 7373 6966 6963 6174 696f 6e27 0a20  lassification'. 
+0001ba60: 2020 2020 2020 2020 2020 2020 2020 2065                 e
+0001ba70: 6c69 6620 6c65 6e28 6e70 2e75 6e69 7175  lif len(np.uniqu
+0001ba80: 6528 795f 7472 6169 6e2e 696c 6f63 5b3a  e(y_train.iloc[:
+0001ba90: 2c30 5d29 2920 3e20 3220 616e 6420 6c65  ,0])) > 2 and le
+0001baa0: 6e28 6e70 2e75 6e69 7175 6528 795f 7472  n(np.unique(y_tr
+0001bab0: 6169 6e2e 696c 6f63 5b3a 2c30 5d29 2920  ain.iloc[:,0])) 
+0001bac0: 3c3d 2063 6174 5f6c 696d 6974 3a0a 2020  <= cat_limit:.  
+0001bad0: 2020 2020 2020 2020 2020 2020 2020 2020                  
+0001bae0: 2020 6d6f 6465 6c5f 636c 6173 7320 3d20    model_class = 
+0001baf0: 274d 756c 7469 5f43 6c61 7373 6966 6963  'Multi_Classific
+0001bb00: 6174 696f 6e27 0a20 2020 2020 2020 2020  ation'.         
+0001bb10: 2020 2020 2020 2065 6c73 653a 0a20 2020         else:.   
+0001bb20: 2020 2020 2020 2020 2020 2020 2020 2020                  
+0001bb30: 206d 6f64 656c 5f63 6c61 7373 203d 2027   model_class = '
+0001bb40: 5265 6772 6573 7369 6f6e 270a 2020 2020  Regression'.    
+0001bb50: 2020 2020 2020 2020 656c 6966 2020 795f          elif  y_
+0001bb60: 7472 6169 6e2e 6474 7970 6573 2e76 616c  train.dtypes.val
+0001bb70: 7565 732e 616c 6c28 2920 696e 205b 2766  ues.all() in ['f
+0001bb80: 6c6f 6174 3136 272c 2766 6c6f 6174 3332  loat16','float32
+0001bb90: 272c 2766 6c6f 6174 3634 275d 3a0a 2020  ','float64']:.  
+0001bba0: 2020 2020 2020 2020 2020 2020 2020 6966                if
+0001bbb0: 206c 656e 286e 702e 756e 6971 7565 2879   len(np.unique(y
+0001bbc0: 5f74 7261 696e 2e69 6c6f 635b 3a2c 305d  _train.iloc[:,0]
+0001bbd0: 2929 203c 3d20 323a 0a20 2020 2020 2020  )) <= 2:.       
+0001bbe0: 2020 2020 2020 2020 2020 2020 206d 6f64               mod
+0001bbf0: 656c 5f63 6c61 7373 203d 2027 4269 6e61  el_class = 'Bina
+0001bc00: 7279 5f43 6c61 7373 6966 6963 6174 696f  ry_Classificatio
+0001bc10: 6e27 0a20 2020 2020 2020 2020 2020 2020  n'.             
+0001bc20: 2020 2065 6c69 6620 6c65 6e28 6e70 2e75     elif len(np.u
+0001bc30: 6e69 7175 6528 795f 7472 6169 6e2e 696c  nique(y_train.il
+0001bc40: 6f63 5b3a 2c30 5d29 2920 3e20 3220 616e  oc[:,0])) > 2 an
+0001bc50: 6420 6c65 6e28 6e70 2e75 6e69 7175 6528  d len(np.unique(
+0001bc60: 795f 7472 6169 6e2e 696c 6f63 5b3a 2c30  y_train.iloc[:,0
+0001bc70: 5d29 2920 3c3d 2066 6c6f 6174 5f6c 696d  ])) <= float_lim
+0001bc80: 6974 3a0a 2020 2020 2020 2020 2020 2020  it:.            
+0001bc90: 2020 2020 2020 2020 6d6f 6465 6c5f 636c          model_cl
+0001bca0: 6173 7320 3d20 274d 756c 7469 5f43 6c61  ass = 'Multi_Cla
+0001bcb0: 7373 6966 6963 6174 696f 6e27 0a20 2020  ssification'.   
+0001bcc0: 2020 2020 2020 2020 2020 2020 2065 6c73               els
+0001bcd0: 653a 0a20 2020 2020 2020 2020 2020 2020  e:.             
+0001bce0: 2020 2020 2020 206d 6f64 656c 5f63 6c61         model_cla
+0001bcf0: 7373 203d 2027 5265 6772 6573 7369 6f6e  ss = 'Regression
+0001bd00: 270a 2020 2020 2020 2020 2020 2020 656c  '.            el
+0001bd10: 7365 3a0a 2020 2020 2020 2020 2020 2020  se:.            
+0001bd20: 2020 2020 6966 206c 656e 286e 702e 756e      if len(np.un
+0001bd30: 6971 7565 2879 5f74 7261 696e 2e69 6c6f  ique(y_train.ilo
+0001bd40: 635b 3a2c 305d 2929 203c 3d20 323a 0a20  c[:,0])) <= 2:. 
+0001bd50: 2020 2020 2020 2020 2020 2020 2020 2020                  
+0001bd60: 2020 206d 6f64 656c 5f63 6c61 7373 203d     model_class =
+0001bd70: 2027 4269 6e61 7279 5f43 6c61 7373 6966   'Binary_Classif
+0001bd80: 6963 6174 696f 6e27 0a20 2020 2020 2020  ication'.       
+0001bd90: 2020 2020 2020 2020 2065 6c73 653a 0a20           else:. 
+0001bda0: 2020 2020 2020 2020 2020 2020 2020 2020                  
+0001bdb0: 2020 206d 6f64 656c 5f63 6c61 7373 203d     model_class =
+0001bdc0: 2027 4d75 6c74 695f 436c 6173 7369 6669   'Multi_Classifi
+0001bdd0: 6361 7469 6f6e 270a 2020 2020 2323 2323  cation'.    ####
+0001bde0: 2323 2323 2323 2320 7072 696e 7420 7468  ####### print th
+0001bdf0: 6973 2066 6f72 2074 6865 2073 7461 7274  is for the start
+0001be00: 206f 6620 6e65 7874 2073 7465 7020 2323   of next step ##
+0001be10: 2323 2323 2323 2323 230a 2020 2020 6966  #########.    if
+0001be20: 2076 6572 626f 7365 3a0a 2020 2020 2020   verbose:.      
+0001be30: 2020 6966 206d 756c 7469 5f6c 6162 656c    if multi_label
+0001be40: 3a0a 2020 2020 2020 2020 2020 2020 7072  :.            pr
+0001be50: 696e 7428 2727 2723 2323 2320 2573 2025  int('''#### %s %
+0001be60: 7320 7072 6f62 6c65 6d20 2323 2323 2727  s problem ####''
+0001be70: 2720 2528 274d 756c 7469 5f4c 6162 656c  ' %('Multi_Label
+0001be80: 272c 206d 6f64 656c 5f63 6c61 7373 2929  ', model_class))
+0001be90: 0a20 2020 2020 2020 2065 6c73 653a 0a20  .        else:. 
+0001bea0: 2020 2020 2020 2020 2020 2070 7269 6e74             print
+0001beb0: 2827 2727 2323 2323 2025 7320 2573 2070  ('''#### %s %s p
+0001bec0: 726f 626c 656d 2023 2323 2327 2727 2025  roblem ####''' %
+0001bed0: 2827 5369 6e67 6c65 5f4c 6162 656c 272c  ('Single_Label',
+0001bee0: 206d 6f64 656c 5f63 6c61 7373 2929 0a20   model_class)). 
+0001bef0: 2020 2072 6574 7572 6e20 6d6f 6465 6c5f     return model_
+0001bf00: 636c 6173 732c 206d 756c 7469 5f6c 6162  class, multi_lab
+0001bf10: 656c 0a23 2323 2323 2323 2323 2323 2323  el.#############
+0001bf20: 2323 2323 2323 2323 2323 2323 2323 2323  ################
+0001bf30: 2323 2323 2323 2323 2323 2323 2323 2323  ################
+0001bf40: 2323 2323 2323 2323 2323 2323 2323 2323  ################
+0001bf50: 2323 2323 2323 2323 2323 2323 2323 2323  ################
+0001bf60: 2323 2323 2323 2323 2323 2323 2323 2323  ################
+0001bf70: 2323 2323 2323 230a 696d 706f 7274 2063  #######.import c
+0001bf80: 6f70 790a 696d 706f 7274 2074 696d 650a  opy.import time.
+0001bf90: 6672 6f6d 2064 6174 6575 7469 6c2e 7265  from dateutil.re
+0001bfa0: 6c61 7469 7665 6465 6c74 6120 696d 706f  lativedelta impo
+0001bfb0: 7274 2072 656c 6174 6976 6564 656c 7461  rt relativedelta
+0001bfc0: 0a66 726f 6d20 6461 7465 7469 6d65 2069  .from datetime i
+0001bfd0: 6d70 6f72 7420 6461 7465 0a64 6566 205f  mport date.def _
+0001bfe0: 6372 6561 7465 5f74 735f 6665 6174 7572  create_ts_featur
+0001bff0: 6573 2864 662c 2076 6572 626f 7365 3d30  es(df, verbose=0
+0001c000: 293a 0a20 2020 2022 2222 0a20 2020 2054  ):.    """.    T
+0001c010: 6869 7320 7461 6b65 7320 696e 2069 6e70  his takes in inp
+0001c020: 7574 2061 2064 6174 6166 7261 6d65 2061  ut a dataframe a
+0001c030: 6e64 2061 2064 6174 6520 7661 7269 6162  nd a date variab
+0001c040: 6c65 2e0a 2020 2020 4974 2074 6865 6e20  le..    It then 
+0001c050: 6372 6561 7465 7320 7469 6d65 2073 6572  creates time ser
+0001c060: 6965 7320 6665 6174 7572 6573 2075 7369  ies features usi
+0001c070: 6e67 2074 6865 2070 616e 6461 7320 2e64  ng the pandas .d
+0001c080: 742e 7765 656b 6461 7920 6b69 6e64 206f  t.weekday kind o
+0001c090: 6620 7379 6e74 6178 2e0a 2020 2020 4974  f syntax..    It
+0001c0a0: 2061 6c73 6f20 7265 7475 726e 7320 7468   also returns th
+0001c0b0: 6520 6461 7461 2066 7261 6d65 206f 6620  e data frame of 
+0001c0c0: 6164 6465 6420 6665 6174 7572 6573 2077  added features w
+0001c0d0: 6974 6820 6561 6368 2076 6172 6961 626c  ith each variabl
+0001c0e0: 6520 6173 2061 6e20 696e 7465 6765 7220  e as an integer 
+0001c0f0: 7661 7269 6162 6c65 2e0a 2020 2020 2222  variable..    ""
+0001c100: 220a 2020 2020 6466 203d 2063 6f70 792e  ".    df = copy.
+0001c110: 6465 6570 636f 7079 2864 6629 0a20 2020  deepcopy(df).   
+0001c120: 2074 7363 6f6c 203d 2064 662e 6e61 6d65   tscol = df.name
+0001c130: 0a20 2020 2069 6620 6973 696e 7374 616e  .    if isinstan
+0001c140: 6365 2864 662c 2070 642e 5365 7269 6573  ce(df, pd.Series
+0001c150: 293a 0a20 2020 2020 2020 2064 6620 3d20  ):.        df = 
+0001c160: 7064 2e44 6174 6146 7261 6d65 2864 6629  pd.DataFrame(df)
+0001c170: 0a20 2020 2065 6c69 6620 6973 696e 7374  .    elif isinst
+0001c180: 616e 6365 2864 662c 206e 702e 6e64 6172  ance(df, np.ndar
+0001c190: 7261 7929 3a0a 2020 2020 2020 2020 7072  ray):.        pr
+0001c1a0: 696e 7428 2720 2020 2069 6e70 7574 2063  int('    input c
+0001c1b0: 616e 6e6f 7420 6265 2061 206e 756d 7079  annot be a numpy
+0001c1c0: 2061 7272 6179 2066 6f72 2063 7265 6174   array for creat
+0001c1d0: 696e 6720 6461 7465 2d74 696d 6520 6665  ing date-time fe
+0001c1e0: 6174 7572 6573 2e20 5265 7475 726e 696e  atures. Returnin
+0001c1f0: 6727 290a 2020 2020 2020 2020 7265 7475  g').        retu
+0001c200: 726e 2064 660a 2020 2020 6474 5f61 6464  rn df.    dt_add
+0001c210: 7320 3d20 5b5d 0a20 2020 2023 2323 2323  s = [].    #####
+0001c220: 2054 6869 7320 6973 2077 6865 7265 2077   This is where w
+0001c230: 6520 6164 6420 6665 6174 7572 6573 206f  e add features o
+0001c240: 6e65 2062 7920 6f6e 6520 2323 2323 2323  ne by one ######
+0001c250: 2323 230a 2020 2020 7472 793a 0a20 2020  ###.    try:.   
+0001c260: 2020 2020 2064 665b 7473 636f 6c2b 275f       df[tscol+'_
+0001c270: 686f 7572 275d 203d 2064 665b 7473 636f  hour'] = df[tsco
+0001c280: 6c5d 2e64 742e 686f 7572 2e66 696c 6c6e  l].dt.hour.filln
+0001c290: 6128 3029 2e61 7374 7970 6528 696e 7429  a(0).astype(int)
+0001c2a0: 0a20 2020 2020 2020 2064 665b 7473 636f  .        df[tsco
+0001c2b0: 6c2b 275f 6d69 6e75 7465 275d 203d 2064  l+'_minute'] = d
+0001c2c0: 665b 7473 636f 6c5d 2e64 742e 6d69 6e75  f[tscol].dt.minu
+0001c2d0: 7465 2e66 696c 6c6e 6128 3029 2e61 7374  te.fillna(0).ast
+0001c2e0: 7970 6528 696e 7429 0a20 2020 2020 2020  ype(int).       
+0001c2f0: 2064 745f 6164 6473 2e61 7070 656e 6428   dt_adds.append(
+0001c300: 7473 636f 6c2b 275f 686f 7572 2729 0a20  tscol+'_hour'). 
+0001c310: 2020 2020 2020 2064 745f 6164 6473 2e61         dt_adds.a
+0001c320: 7070 656e 6428 7473 636f 6c2b 275f 6d69  ppend(tscol+'_mi
+0001c330: 6e75 7465 2729 0a20 2020 2065 7863 6570  nute').    excep
+0001c340: 743a 0a20 2020 2020 2020 2070 7269 6e74  t:.        print
+0001c350: 2827 2020 2020 4572 726f 7220 696e 2063  ('    Error in c
+0001c360: 7265 6174 696e 6720 686f 7572 2d73 6563  reating hour-sec
+0001c370: 6f6e 6420 6465 7269 7665 6420 6665 6174  ond derived feat
+0001c380: 7572 6573 2e20 436f 6e74 696e 7569 6e67  ures. Continuing
+0001c390: 2e2e 2e27 290a 2020 2020 7472 793a 0a20  ...').    try:. 
+0001c3a0: 2020 2020 2020 2064 665b 7473 636f 6c2b         df[tscol+
+0001c3b0: 275f 6461 796f 6677 6565 6b27 5d20 3d20  '_dayofweek'] = 
+0001c3c0: 6466 5b74 7363 6f6c 5d2e 6474 2e64 6179  df[tscol].dt.day
+0001c3d0: 6f66 7765 656b 2e66 696c 6c6e 6128 3029  ofweek.fillna(0)
+0001c3e0: 2e61 7374 7970 6528 696e 7429 0a20 2020  .astype(int).   
+0001c3f0: 2020 2020 2064 745f 6164 6473 2e61 7070       dt_adds.app
+0001c400: 656e 6428 7473 636f 6c2b 275f 6461 796f  end(tscol+'_dayo
+0001c410: 6677 6565 6b27 290a 2020 2020 2020 2020  fweek').        
+0001c420: 6966 2074 7363 6f6c 2b27 5f68 6f75 7227  if tscol+'_hour'
+0001c430: 2069 6e20 6474 5f61 6464 733a 0a20 2020   in dt_adds:.   
+0001c440: 2020 2020 2020 2020 2044 4159 5320 3d20           DAYS = 
+0001c450: 6469 6374 287a 6970 2872 616e 6765 2837  dict(zip(range(7
+0001c460: 292c 5b27 5375 6e27 2c20 274d 6f6e 272c  ),['Sun', 'Mon',
+0001c470: 2027 5475 6527 2c20 2757 6564 272c 2027   'Tue', 'Wed', '
+0001c480: 5468 7527 2c20 2746 7269 272c 2027 5361  Thu', 'Fri', 'Sa
+0001c490: 7427 5d29 290a 2020 2020 2020 2020 2020  t'])).          
+0001c4a0: 2020 6466 5b74 7363 6f6c 2b27 5f64 6179    df[tscol+'_day
+0001c4b0: 6f66 7765 656b 275d 203d 2064 665b 7473  ofweek'] = df[ts
+0001c4c0: 636f 6c2b 275f 6461 796f 6677 6565 6b27  col+'_dayofweek'
+0001c4d0: 5d2e 6d61 7028 4441 5953 290a 2020 2020  ].map(DAYS).    
+0001c4e0: 2020 2020 2020 2020 6466 2e6c 6f63 5b3a          df.loc[:
+0001c4f0: 2c74 7363 6f6c 2b27 5f64 6179 6f66 7765  ,tscol+'_dayofwe
+0001c500: 656b 5f68 6f75 725f 6372 6f73 7327 5d20  ek_hour_cross'] 
+0001c510: 3d20 6466 5b74 7363 6f6c 2b27 5f64 6179  = df[tscol+'_day
+0001c520: 6f66 7765 656b 275d 202b 2220 222b 2064  ofweek'] +" "+ d
+0001c530: 665b 7473 636f 6c2b 275f 686f 7572 275d  f[tscol+'_hour']
+0001c540: 2e61 7374 7970 6528 7374 7229 0a20 2020  .astype(str).   
+0001c550: 2020 2020 2020 2020 2064 745f 6164 6473           dt_adds
+0001c560: 2e61 7070 656e 6428 7473 636f 6c2b 275f  .append(tscol+'_
+0001c570: 6461 796f 6677 6565 6b5f 686f 7572 5f63  dayofweek_hour_c
+0001c580: 726f 7373 2729 0a20 2020 2020 2020 2064  ross').        d
+0001c590: 665b 7473 636f 6c2b 275f 7175 6172 7465  f[tscol+'_quarte
+0001c5a0: 7227 5d20 3d20 6466 5b74 7363 6f6c 5d2e  r'] = df[tscol].
+0001c5b0: 6474 2e71 7561 7274 6572 2e66 696c 6c6e  dt.quarter.filln
+0001c5c0: 6128 3029 2e61 7374 7970 6528 696e 7429  a(0).astype(int)
+0001c5d0: 0a20 2020 2020 2020 2064 745f 6164 6473  .        dt_adds
+0001c5e0: 2e61 7070 656e 6428 7473 636f 6c2b 275f  .append(tscol+'_
+0001c5f0: 7175 6172 7465 7227 290a 2020 2020 2020  quarter').      
+0001c600: 2020 6466 5b74 7363 6f6c 2b27 5f6d 6f6e    df[tscol+'_mon
+0001c610: 7468 275d 203d 2064 665b 7473 636f 6c5d  th'] = df[tscol]
+0001c620: 2e64 742e 6d6f 6e74 682e 6669 6c6c 6e61  .dt.month.fillna
+0001c630: 2830 292e 6173 7479 7065 2869 6e74 290a  (0).astype(int).
+0001c640: 2020 2020 2020 2020 4d4f 4e54 4853 203d          MONTHS =
+0001c650: 2064 6963 7428 7a69 7028 7261 6e67 6528   dict(zip(range(
+0001c660: 312c 3133 292c 5b27 4a61 6e27 2c20 2746  1,13),['Jan', 'F
+0001c670: 6562 272c 2027 4d61 7227 2c20 2741 7072  eb', 'Mar', 'Apr
+0001c680: 272c 2027 4d61 7927 2c20 274a 756e 272c  ', 'May', 'Jun',
+0001c690: 2027 4a75 6c27 2c0a 2020 2020 2020 2020   'Jul',.        
+0001c6a0: 2020 2020 2020 2020 2020 2020 2020 2020                  
+0001c6b0: 2020 2020 2020 2020 2020 2020 2741 7567              'Aug
+0001c6c0: 272c 2027 5365 7027 2c20 274f 6374 272c  ', 'Sep', 'Oct',
+0001c6d0: 2027 4e6f 7627 2c20 2744 6563 275d 2929   'Nov', 'Dec']))
+0001c6e0: 0a20 2020 2020 2020 2064 665b 7473 636f  .        df[tsco
+0001c6f0: 6c2b 275f 6d6f 6e74 6827 5d20 3d20 6466  l+'_month'] = df
+0001c700: 5b74 7363 6f6c 2b27 5f6d 6f6e 7468 275d  [tscol+'_month']
+0001c710: 2e6d 6170 284d 4f4e 5448 5329 0a20 2020  .map(MONTHS).   
+0001c720: 2020 2020 2064 745f 6164 6473 2e61 7070       dt_adds.app
+0001c730: 656e 6428 7473 636f 6c2b 275f 6d6f 6e74  end(tscol+'_mont
+0001c740: 6827 290a 2020 2020 2020 2020 2323 2323  h').        ####
+0001c750: 2041 6464 2073 6f6d 6520 6665 6174 7572   Add some featur
+0001c760: 6573 2066 6f72 206d 6f6e 7468 7320 2323  es for months ##
+0001c770: 2323 2323 2323 2323 2323 2323 2323 2323  ################
+0001c780: 2323 2323 2323 2323 2323 2323 2323 2323  ################
+0001c790: 2323 2323 2323 0a20 2020 2020 2020 2066  ######.        f
+0001c7a0: 6573 7469 7665 7320 3d20 5b27 4f63 7427  estives = ['Oct'
+0001c7b0: 2c27 4e6f 7627 2c27 4465 6327 5d0a 2020  ,'Nov','Dec'].  
+0001c7c0: 2020 2020 2020 6e61 6d65 5f63 6f6c 203d        name_col =
+0001c7d0: 2074 7363 6f6c 2b22 5f69 735f 6665 7374   tscol+"_is_fest
+0001c7e0: 6976 6522 0a20 2020 2020 2020 2064 665b  ive".        df[
+0001c7f0: 6e61 6d65 5f63 6f6c 5d20 3d20 300a 2020  name_col] = 0.  
+0001c800: 2020 2020 2020 6466 5b6e 616d 655f 636f        df[name_co
+0001c810: 6c5d 203d 2064 665b 7473 636f 6c2b 275f  l] = df[tscol+'_
+0001c820: 6d6f 6e74 6827 5d2e 6d61 7028 6c61 6d62  month'].map(lamb
+0001c830: 6461 2078 3a20 3120 6966 2078 2069 6e20  da x: 1 if x in 
+0001c840: 6665 7374 6976 6573 2065 6c73 6520 3029  festives else 0)
+0001c850: 2e76 616c 7565 730a 2020 2020 2020 2020  .values.        
+0001c860: 2323 2320 5265 6d65 6d62 6572 2074 6861  ### Remember tha
+0001c870: 7420 6669 6c6c 6e61 206f 6e6c 7920 776f  t fillna only wo
+0001c880: 726b 7320 6174 2064 6174 6166 7261 6d65  rks at dataframe
+0001c890: 206c 6576 656c 2120 2323 230a 2020 2020   level! ###.    
+0001c8a0: 2020 2020 6466 5b5b 6e61 6d65 5f63 6f6c      df[[name_col
+0001c8b0: 5d5d 203d 2064 665b 5b6e 616d 655f 636f  ]] = df[[name_co
+0001c8c0: 6c5d 5d2e 6669 6c6c 6e61 2830 290a 2020  l]].fillna(0).  
+0001c8d0: 2020 2020 2020 6474 5f61 6464 732e 6170        dt_adds.ap
+0001c8e0: 7065 6e64 286e 616d 655f 636f 6c29 0a20  pend(name_col). 
+0001c8f0: 2020 2020 2020 2073 756d 6d65 7220 3d20         summer = 
+0001c900: 5b27 4a75 6e27 2c27 4a75 6c27 2c27 4175  ['Jun','Jul','Au
+0001c910: 6727 5d0a 2020 2020 2020 2020 6e61 6d65  g'].        name
+0001c920: 5f63 6f6c 203d 2074 7363 6f6c 2b22 5f69  _col = tscol+"_i
+0001c930: 735f 7375 6d6d 6572 220a 2020 2020 2020  s_summer".      
+0001c940: 2020 6466 5b6e 616d 655f 636f 6c5d 203d    df[name_col] =
+0001c950: 2030 0a20 2020 2020 2020 2064 665b 6e61   0.        df[na
+0001c960: 6d65 5f63 6f6c 5d20 3d20 6466 5b74 7363  me_col] = df[tsc
+0001c970: 6f6c 2b27 5f6d 6f6e 7468 275d 2e6d 6170  ol+'_month'].map
+0001c980: 286c 616d 6264 6120 783a 2031 2069 6620  (lambda x: 1 if 
+0001c990: 7820 696e 2073 756d 6d65 7220 656c 7365  x in summer else
+0001c9a0: 2030 292e 7661 6c75 6573 0a20 2020 2020   0).values.     
+0001c9b0: 2020 2023 2323 2052 656d 656d 6265 7220     ### Remember 
+0001c9c0: 7468 6174 2066 696c 6c6e 6120 6f6e 6c79  that fillna only
+0001c9d0: 2077 6f72 6b73 2061 7420 6461 7461 6672   works at datafr
+0001c9e0: 616d 6520 6c65 7665 6c21 2023 2323 0a20  ame level! ###. 
+0001c9f0: 2020 2020 2020 2064 665b 5b6e 616d 655f         df[[name_
+0001ca00: 636f 6c5d 5d20 3d20 6466 5b5b 6e61 6d65  col]] = df[[name
+0001ca10: 5f63 6f6c 5d5d 2e66 696c 6c6e 6128 3029  _col]].fillna(0)
+0001ca20: 0a20 2020 2020 2020 2064 745f 6164 6473  .        dt_adds
+0001ca30: 2e61 7070 656e 6428 6e61 6d65 5f63 6f6c  .append(name_col
+0001ca40: 290a 2020 2020 2020 2020 7769 6e74 6572  ).        winter
+0001ca50: 203d 205b 2744 6563 272c 274a 616e 272c   = ['Dec','Jan',
+0001ca60: 2746 6562 275d 0a20 2020 2020 2020 206e  'Feb'].        n
+0001ca70: 616d 655f 636f 6c20 3d20 7473 636f 6c2b  ame_col = tscol+
+0001ca80: 225f 6973 5f77 696e 7465 7222 0a20 2020  "_is_winter".   
+0001ca90: 2020 2020 2064 665b 6e61 6d65 5f63 6f6c       df[name_col
+0001caa0: 5d20 3d20 300a 2020 2020 2020 2020 6466  ] = 0.        df
+0001cab0: 5b6e 616d 655f 636f 6c5d 203d 2064 665b  [name_col] = df[
+0001cac0: 7473 636f 6c2b 275f 6d6f 6e74 6827 5d2e  tscol+'_month'].
+0001cad0: 6d61 7028 6c61 6d62 6461 2078 3a20 3120  map(lambda x: 1 
+0001cae0: 6966 2078 2069 6e20 7769 6e74 6572 2065  if x in winter e
+0001caf0: 6c73 6520 3029 2e76 616c 7565 730a 2020  lse 0).values.  
+0001cb00: 2020 2020 2020 2323 2320 5265 6d65 6d62        ### Rememb
+0001cb10: 6572 2074 6861 7420 6669 6c6c 6e61 206f  er that fillna o
+0001cb20: 6e6c 7920 776f 726b 7320 6174 2064 6174  nly works at dat
+0001cb30: 6166 7261 6d65 206c 6576 656c 2120 2323  aframe level! ##
+0001cb40: 230a 2020 2020 2020 2020 6466 5b5b 6e61  #.        df[[na
+0001cb50: 6d65 5f63 6f6c 5d5d 203d 2064 665b 5b6e  me_col]] = df[[n
+0001cb60: 616d 655f 636f 6c5d 5d2e 6669 6c6c 6e61  ame_col]].fillna
+0001cb70: 2830 290a 2020 2020 2020 2020 6474 5f61  (0).        dt_a
+0001cb80: 6464 732e 6170 7065 6e64 286e 616d 655f  dds.append(name_
+0001cb90: 636f 6c29 0a20 2020 2020 2020 2063 6f6c  col).        col
+0001cba0: 6420 3d20 5b27 4f63 7427 2c27 4e6f 7627  d = ['Oct','Nov'
+0001cbb0: 2c27 4465 6327 2c27 4a61 6e27 2c27 4665  ,'Dec','Jan','Fe
+0001cbc0: 6227 2c27 4d61 7227 5d0a 2020 2020 2020  b','Mar'].      
+0001cbd0: 2020 6e61 6d65 5f63 6f6c 203d 2074 7363    name_col = tsc
+0001cbe0: 6f6c 2b22 5f69 735f 636f 6c64 220a 2020  ol+"_is_cold".  
+0001cbf0: 2020 2020 2020 6466 5b6e 616d 655f 636f        df[name_co
+0001cc00: 6c5d 203d 2030 0a20 2020 2020 2020 2064  l] = 0.        d
+0001cc10: 665b 6e61 6d65 5f63 6f6c 5d20 3d20 6466  f[name_col] = df
+0001cc20: 5b74 7363 6f6c 2b27 5f6d 6f6e 7468 275d  [tscol+'_month']
+0001cc30: 2e6d 6170 286c 616d 6264 6120 783a 2031  .map(lambda x: 1
+0001cc40: 2069 6620 7820 696e 2063 6f6c 6420 656c   if x in cold el
+0001cc50: 7365 2030 292e 7661 6c75 6573 0a20 2020  se 0).values.   
+0001cc60: 2020 2020 2023 2323 2052 656d 656d 6265       ### Remembe
+0001cc70: 7220 7468 6174 2066 696c 6c6e 6120 6f6e  r that fillna on
+0001cc80: 6c79 2077 6f72 6b73 2061 7420 6461 7461  ly works at data
+0001cc90: 6672 616d 6520 6c65 7665 6c21 2023 2323  frame level! ###
+0001cca0: 0a20 2020 2020 2020 2064 665b 5b6e 616d  .        df[[nam
+0001ccb0: 655f 636f 6c5d 5d20 3d20 6466 5b5b 6e61  e_col]] = df[[na
+0001ccc0: 6d65 5f63 6f6c 5d5d 2e66 696c 6c6e 6128  me_col]].fillna(
+0001ccd0: 3029 0a20 2020 2020 2020 2064 745f 6164  0).        dt_ad
+0001cce0: 6473 2e61 7070 656e 6428 6e61 6d65 5f63  ds.append(name_c
+0001ccf0: 6f6c 290a 2020 2020 2020 2020 7761 726d  ol).        warm
+0001cd00: 203d 205b 2741 7072 272c 274d 6179 272c   = ['Apr','May',
+0001cd10: 274a 756e 272c 274a 756c 272c 2741 7567  'Jun','Jul','Aug
+0001cd20: 272c 2753 6570 275d 0a20 2020 2020 2020  ','Sep'].       
+0001cd30: 206e 616d 655f 636f 6c20 3d20 7473 636f   name_col = tsco
+0001cd40: 6c2b 225f 6973 5f77 6172 6d22 0a20 2020  l+"_is_warm".   
+0001cd50: 2020 2020 2064 665b 6e61 6d65 5f63 6f6c       df[name_col
+0001cd60: 5d20 3d20 300a 2020 2020 2020 2020 6466  ] = 0.        df
+0001cd70: 5b6e 616d 655f 636f 6c5d 203d 2064 665b  [name_col] = df[
+0001cd80: 7473 636f 6c2b 275f 6d6f 6e74 6827 5d2e  tscol+'_month'].
+0001cd90: 6d61 7028 6c61 6d62 6461 2078 3a20 3120  map(lambda x: 1 
+0001cda0: 6966 2078 2069 6e20 7761 726d 2065 6c73  if x in warm els
+0001cdb0: 6520 3029 2e76 616c 7565 730a 2020 2020  e 0).values.    
+0001cdc0: 2020 2020 2323 2320 5265 6d65 6d62 6572      ### Remember
+0001cdd0: 2074 6861 7420 6669 6c6c 6e61 206f 6e6c   that fillna onl
+0001cde0: 7920 776f 726b 7320 6174 2064 6174 6166  y works at dataf
+0001cdf0: 7261 6d65 206c 6576 656c 2120 2323 230a  rame level! ###.
+0001ce00: 2020 2020 2020 2020 6466 5b5b 6e61 6d65          df[[name
+0001ce10: 5f63 6f6c 5d5d 203d 2064 665b 5b6e 616d  _col]] = df[[nam
+0001ce20: 655f 636f 6c5d 5d2e 6669 6c6c 6e61 2830  e_col]].fillna(0
+0001ce30: 290a 2020 2020 2020 2020 6474 5f61 6464  ).        dt_add
+0001ce40: 732e 6170 7065 6e64 286e 616d 655f 636f  s.append(name_co
+0001ce50: 6c29 0a20 2020 2020 2020 2023 2323 2323  l).        #####
+0001ce60: 2323 2323 2323 2323 2323 2323 2323 2323  ################
+0001ce70: 2323 2323 2323 2323 2323 2323 2323 2323  ################
+0001ce80: 2323 2323 2323 2323 2323 2323 2323 2323  ################
+0001ce90: 2323 2323 2323 2323 2323 2323 2323 2323  ################
+0001cea0: 2323 2323 0a20 2020 2020 2020 2069 6620  ####.        if 
+0001ceb0: 7473 636f 6c2b 275f 6461 796f 6677 6565  tscol+'_dayofwee
+0001cec0: 6b27 2069 6e20 6474 5f61 6464 733a 0a20  k' in dt_adds:. 
+0001ced0: 2020 2020 2020 2020 2020 2064 662e 6c6f             df.lo
+0001cee0: 635b 3a2c 7473 636f 6c2b 275f 6d6f 6e74  c[:,tscol+'_mont
+0001cef0: 685f 6461 796f 6677 6565 6b5f 6372 6f73  h_dayofweek_cros
+0001cf00: 7327 5d20 3d20 6466 5b74 7363 6f6c 2b27  s'] = df[tscol+'
+0001cf10: 5f6d 6f6e 7468 275d 202b 2220 222b 2064  _month'] +" "+ d
+0001cf20: 665b 7473 636f 6c2b 275f 6461 796f 6677  f[tscol+'_dayofw
+0001cf30: 6565 6b27 5d0a 2020 2020 2020 2020 2020  eek'].          
+0001cf40: 2020 6474 5f61 6464 732e 6170 7065 6e64    dt_adds.append
+0001cf50: 2874 7363 6f6c 2b27 5f6d 6f6e 7468 5f64  (tscol+'_month_d
+0001cf60: 6179 6f66 7765 656b 5f63 726f 7373 2729  ayofweek_cross')
+0001cf70: 0a20 2020 2020 2020 2064 665b 7473 636f  .        df[tsco
+0001cf80: 6c2b 275f 7965 6172 275d 203d 2064 665b  l+'_year'] = df[
+0001cf90: 7473 636f 6c5d 2e64 742e 7965 6172 2e66  tscol].dt.year.f
+0001cfa0: 696c 6c6e 6128 3029 2e61 7374 7970 6528  illna(0).astype(
+0001cfb0: 696e 7429 0a20 2020 2020 2020 2064 745f  int).        dt_
+0001cfc0: 6164 6473 2e61 7070 656e 6428 7473 636f  adds.append(tsco
+0001cfd0: 6c2b 275f 7965 6172 2729 0a20 2020 2020  l+'_year').     
+0001cfe0: 2020 2074 6f64 6179 203d 2064 6174 652e     today = date.
+0001cff0: 746f 6461 7928 290a 2020 2020 2020 2020  today().        
+0001d000: 6466 5b74 7363 6f6c 2b27 5f61 6765 5f69  df[tscol+'_age_i
+0001d010: 6e5f 7965 6172 7327 5d20 3d20 746f 6461  n_years'] = toda
+0001d020: 792e 7965 6172 202d 2064 665b 7473 636f  y.year - df[tsco
+0001d030: 6c5d 2e64 742e 7965 6172 2e66 696c 6c6e  l].dt.year.filln
+0001d040: 6128 3029 2e61 7374 7970 6528 696e 7429  a(0).astype(int)
+0001d050: 0a20 2020 2020 2020 2064 745f 6164 6473  .        dt_adds
+0001d060: 2e61 7070 656e 6428 7473 636f 6c2b 275f  .append(tscol+'_
+0001d070: 6167 655f 696e 5f79 6561 7273 2729 0a20  age_in_years'). 
+0001d080: 2020 2020 2020 2064 665b 7473 636f 6c2b         df[tscol+
+0001d090: 275f 6461 796f 6679 6561 7227 5d20 3d20  '_dayofyear'] = 
+0001d0a0: 6466 5b74 7363 6f6c 5d2e 6474 2e64 6179  df[tscol].dt.day
+0001d0b0: 6f66 7965 6172 2e66 696c 6c6e 6128 3029  ofyear.fillna(0)
+0001d0c0: 2e61 7374 7970 6528 696e 7429 0a20 2020  .astype(int).   
+0001d0d0: 2020 2020 2064 745f 6164 6473 2e61 7070       dt_adds.app
+0001d0e0: 656e 6428 7473 636f 6c2b 275f 6461 796f  end(tscol+'_dayo
+0001d0f0: 6679 6561 7227 290a 2020 2020 2020 2020  fyear').        
+0001d100: 6466 5b74 7363 6f6c 2b27 5f64 6179 6f66  df[tscol+'_dayof
+0001d110: 6d6f 6e74 6827 5d20 3d20 6466 5b74 7363  month'] = df[tsc
+0001d120: 6f6c 5d2e 6474 2e64 6179 2e66 696c 6c6e  ol].dt.day.filln
+0001d130: 6128 3029 2e61 7374 7970 6528 696e 7429  a(0).astype(int)
+0001d140: 0a20 2020 2020 2020 2064 745f 6164 6473  .        dt_adds
+0001d150: 2e61 7070 656e 6428 7473 636f 6c2b 275f  .append(tscol+'_
+0001d160: 6461 796f 666d 6f6e 7468 2729 0a20 2020  dayofmonth').   
+0001d170: 2020 2020 2064 665b 7473 636f 6c2b 275f       df[tscol+'_
+0001d180: 7765 656b 6f66 7965 6172 275d 203d 2064  weekofyear'] = d
+0001d190: 665b 7473 636f 6c5d 2e64 742e 7765 656b  f[tscol].dt.week
+0001d1a0: 6f66 7965 6172 2e66 696c 6c6e 6128 3029  ofyear.fillna(0)
+0001d1b0: 2e61 7374 7970 6528 696e 7429 0a20 2020  .astype(int).   
+0001d1c0: 2020 2020 2064 745f 6164 6473 2e61 7070       dt_adds.app
+0001d1d0: 656e 6428 7473 636f 6c2b 275f 7765 656b  end(tscol+'_week
+0001d1e0: 6f66 7965 6172 2729 0a20 2020 2020 2020  ofyear').       
+0001d1f0: 2077 6565 6b65 6e64 7320 3d20 2864 665b   weekends = (df[
+0001d200: 7473 636f 6c2b 275f 6461 796f 6677 6565  tscol+'_dayofwee
+0001d210: 6b27 5d20 3d3d 2027 5361 7427 2920 7c20  k'] == 'Sat') | 
+0001d220: 2864 665b 7473 636f 6c2b 275f 6461 796f  (df[tscol+'_dayo
+0001d230: 6677 6565 6b27 5d20 3d3d 2027 5375 6e27  fweek'] == 'Sun'
+0001d240: 290a 2020 2020 2020 2020 6466 5b74 7363  ).        df[tsc
+0001d250: 6f6c 2b27 5f74 7970 656f 6664 6179 275d  ol+'_typeofday']
+0001d260: 203d 2027 7765 656b 6461 7927 0a20 2020   = 'weekday'.   
+0001d270: 2020 2020 2064 662e 6c6f 635b 7765 656b       df.loc[week
+0001d280: 656e 6473 2c20 7473 636f 6c2b 275f 7479  ends, tscol+'_ty
+0001d290: 7065 6f66 6461 7927 5d20 3d20 2777 6565  peofday'] = 'wee
+0001d2a0: 6b65 6e64 270a 2020 2020 2020 2020 6474  kend'.        dt
+0001d2b0: 5f61 6464 732e 6170 7065 6e64 2874 7363  _adds.append(tsc
+0001d2c0: 6f6c 2b27 5f74 7970 656f 6664 6179 2729  ol+'_typeofday')
+0001d2d0: 0a20 2020 2020 2020 2069 6620 7473 636f  .        if tsco
+0001d2e0: 6c2b 275f 7479 7065 6f66 6461 7927 2069  l+'_typeofday' i
+0001d2f0: 6e20 6474 5f61 6464 733a 0a20 2020 2020  n dt_adds:.     
+0001d300: 2020 2020 2020 2064 662e 6c6f 635b 3a2c         df.loc[:,
+0001d310: 7473 636f 6c2b 275f 6d6f 6e74 685f 7479  tscol+'_month_ty
+0001d320: 7065 6f66 6461 795f 6372 6f73 7327 5d20  peofday_cross'] 
+0001d330: 3d20 6466 5b74 7363 6f6c 2b27 5f6d 6f6e  = df[tscol+'_mon
+0001d340: 7468 275d 202b 2220 222b 2064 665b 7473  th'] +" "+ df[ts
+0001d350: 636f 6c2b 275f 7479 7065 6f66 6461 7927  col+'_typeofday'
+0001d360: 5d0a 2020 2020 2020 2020 2020 2020 6474  ].            dt
+0001d370: 5f61 6464 732e 6170 7065 6e64 2874 7363  _adds.append(tsc
+0001d380: 6f6c 2b27 5f6d 6f6e 7468 5f74 7970 656f  ol+'_month_typeo
+0001d390: 6664 6179 5f63 726f 7373 2729 0a20 2020  fday_cross').   
+0001d3a0: 2065 7863 6570 743a 0a20 2020 2020 2020   except:.       
+0001d3b0: 2070 7269 6e74 2827 2020 2020 4572 726f   print('    Erro
+0001d3c0: 7220 696e 2063 7265 6174 696e 6720 6461  r in creating da
+0001d3d0: 7465 2074 696d 6520 6465 7269 7665 6420  te time derived 
+0001d3e0: 6665 6174 7572 6573 2e20 436f 6e74 696e  features. Contin
+0001d3f0: 7569 6e67 2e2e 2e27 290a 2020 2020 6966  uing...').    if
+0001d400: 2076 6572 626f 7365 3a0a 2020 2020 2020   verbose:.      
+0001d410: 2020 7072 696e 7428 2720 2020 2063 7265    print('    cre
+0001d420: 6174 6564 2025 6420 636f 6c75 6d6e 7320  ated %d columns 
+0001d430: 6672 6f6d 2074 696d 6520 7365 7269 6573  from time series
+0001d440: 2025 7320 636f 6c75 6d6e 2720 2528 6c65   %s column' %(le
+0001d450: 6e28 6474 5f61 6464 7329 2c74 7363 6f6c  n(dt_adds),tscol
+0001d460: 2929 0a20 2020 2072 6574 7572 6e20 6466  )).    return df
+0001d470: 5b64 745f 6164 6473 5d0a 2323 2323 2323  [dt_adds].######
+0001d480: 2323 2323 2323 2323 2323 2323 2323 2323  ################
+0001d490: 2323 2323 2323 2323 2323 2323 2323 2323  ################
+0001d4a0: 2323 2323 2323 2323 2323 2323 2323 2323  ################
+0001d4b0: 2323 2323 2323 2323 2323 2323 2323 2323  ################
+0001d4c0: 2323 2323 2323 2323 2323 2323 0a23 2323  ############.###
+0001d4d0: 2054 6869 7320 7772 6170 7065 7220 7761   This wrapper wa
+0001d4e0: 7320 7072 6f70 6f73 6564 2062 7920 736f  s proposed by so
+0001d4f0: 6d65 6f6e 6520 696e 2053 7461 636b 6f76  meone in Stackov
+0001d500: 6572 666c 6f77 2077 6869 6368 2077 6f72  erflow which wor
+0001d510: 6b73 2077 656c 6c20 2323 2323 2323 230a  ks well #######.
+0001d520: 2323 2320 204d 616e 7920 7468 616e 6b73  ###  Many thanks
+0001d530: 2074 6f3a 2068 7474 7073 3a2f 2f73 7461   to: https://sta
+0001d540: 636b 6f76 6572 666c 6f77 2e63 6f6d 2f71  ckoverflow.com/q
+0001d550: 7565 7374 696f 6e73 2f36 3330 3030 3338  uestions/6300038
+0001d560: 382f 686f 772d 746f 2d69 6e63 6c75 6465  8/how-to-include
+0001d570: 2d73 696d 706c 6569 6d70 7574 6572 2d62  -simpleimputer-b
+0001d580: 6566 6f72 652d 636f 756e 7476 6563 746f  efore-countvecto
+0001d590: 7269 7a65 722d 696e 2d61 2d73 6369 6b69  rizer-in-a-sciki
+0001d5a0: 742d 6c65 6172 6e2d 7069 7065 6c69 6e65  t-learn-pipeline
+0001d5b0: 0a23 2323 2323 2323 2323 2323 2323 2323  .###############
+0001d5c0: 2323 2323 2323 2323 2323 2323 2323 2323  ################
+0001d5d0: 2323 2323 2323 2323 2323 2323 2323 2323  ################
+0001d5e0: 2323 2323 2323 2323 2323 2323 2323 2323  ################
+0001d5f0: 2323 2323 2323 2323 2323 2323 2323 2323  ################
+0001d600: 2323 230a 636c 6173 7320 4d61 6b65 3244  ###.class Make2D
+0001d610: 3a0a 2020 2020 2222 224f 6e65 2064 696d  :.    """One dim
+0001d620: 656e 7369 6f6e 616c 2077 7261 7070 6572  ensional wrapper
+0001d630: 2066 6f72 2073 6b6c 6561 726e 2054 7261   for sklearn Tra
+0001d640: 6e73 666f 726d 6572 7322 2222 0a20 2020  nsformers""".   
+0001d650: 2064 6566 205f 5f69 6e69 745f 5f28 7365   def __init__(se
+0001d660: 6c66 2c20 7472 616e 7366 6f72 6d65 7229  lf, transformer)
+0001d670: 3a0a 2020 2020 2020 2020 7365 6c66 2e74  :.        self.t
+0001d680: 7261 6e73 666f 726d 6572 203d 2074 7261  ransformer = tra
+0001d690: 6e73 666f 726d 6572 0a0a 2020 2020 6465  nsformer..    de
+0001d6a0: 6620 6669 7428 7365 6c66 2c20 582c 2079  f fit(self, X, y
+0001d6b0: 3d4e 6f6e 6529 3a0a 2020 2020 2020 2020  =None):.        
+0001d6c0: 7365 6c66 2e74 7261 6e73 666f 726d 6572  self.transformer
+0001d6d0: 2e66 6974 286e 702e 6172 7261 7928 5829  .fit(np.array(X)
+0001d6e0: 2e72 6573 6861 7065 282d 312c 2031 2929  .reshape(-1, 1))
+0001d6f0: 0a20 2020 2020 2020 2072 6574 7572 6e20  .        return 
+0001d700: 7365 6c66 0a0a 2020 2020 6465 6620 7472  self..    def tr
+0001d710: 616e 7366 6f72 6d28 7365 6c66 2c20 582c  ansform(self, X,
+0001d720: 2079 3d4e 6f6e 6529 3a0a 2020 2020 2020   y=None):.      
+0001d730: 2020 7265 7475 726e 2073 656c 662e 7472    return self.tr
+0001d740: 616e 7366 6f72 6d65 722e 7472 616e 7366  ansformer.transf
+0001d750: 6f72 6d28 0a20 2020 2020 2020 2020 2020  orm(.           
+0001d760: 206e 702e 6172 7261 7928 5829 2e72 6573   np.array(X).res
+0001d770: 6861 7065 282d 312c 2031 2929 2e72 6176  hape(-1, 1)).rav
+0001d780: 656c 2829 0a0a 2020 2020 6465 6620 696e  el()..    def in
+0001d790: 7665 7273 655f 7472 616e 7366 6f72 6d28  verse_transform(
+0001d7a0: 7365 6c66 2c20 582c 2079 3d4e 6f6e 6529  self, X, y=None)
+0001d7b0: 3a0a 2020 2020 2020 2020 7265 7475 726e  :.        return
+0001d7c0: 2073 656c 662e 7472 616e 7366 6f72 6d65   self.transforme
+0001d7d0: 722e 696e 7665 7273 655f 7472 616e 7366  r.inverse_transf
+0001d7e0: 6f72 6d28 0a20 2020 2020 2020 2020 2020  orm(.           
+0001d7f0: 206e 702e 6578 7061 6e64 5f64 696d 7328   np.expand_dims(
+0001d800: 582c 2061 7869 733d 3129 292e 7261 7665  X, axis=1)).rave
+0001d810: 6c28 290a 2323 2323 2323 2323 2323 2323  l().############
+0001d820: 2323 2323 2323 2323 2323 2323 2323 2323  ################
+0001d830: 2323 2323 2323 2323 2323 2323 2323 2323  ################
+0001d840: 2323 2323 2323 2323 2323 2323 2323 2323  ################
+0001d850: 2323 2323 2323 2323 2323 2323 2323 2323  ################
+0001d860: 2323 2323 2323 0a64 6566 2072 6574 7572  ######.def retur
+0001d870: 6e5f 6465 6661 756c 7428 293a 0a20 2020  n_default():.   
+0001d880: 206d 6973 7369 6e67 5f76 616c 7565 203d   missing_value =
+0001d890: 2022 6d69 7373 696e 675f 222b 7374 7228   "missing_"+str(
+0001d8a0: 7261 6e64 6f6d 2e72 616e 6469 6e74 2831  random.randint(1
+0001d8b0: 2c31 3030 3029 290a 2020 2020 7265 7475  ,1000)).    retu
+0001d8c0: 726e 206d 6973 7369 6e67 5f76 616c 7565  rn missing_value
+0001d8d0: 0a23 2323 2323 2323 2323 2323 2323 2323  .###############
+0001d8e0: 2323 2323 2323 2323 2323 2323 2323 2323  ################
+0001d8f0: 2323 2323 2323 2323 2323 2323 2323 2323  ################
+0001d900: 2323 2323 2323 2323 2323 2323 2323 2323  ################
+0001d910: 2323 2323 2323 2323 2323 2323 2323 2323  ################
+0001d920: 2323 230a 6465 6620 6d61 6b65 5f73 696d  ###.def make_sim
+0001d930: 706c 655f 7069 7065 6c69 6e65 2858 5f74  ple_pipeline(X_t
+0001d940: 7261 696e 2c20 795f 7472 6169 6e2c 2065  rain, y_train, e
+0001d950: 6e63 6f64 6572 733d 2761 7574 6f27 2c20  ncoders='auto', 
+0001d960: 7363 616c 6572 733d 2727 2c20 0a20 2020  scalers='', .   
+0001d970: 2020 2020 2020 2020 2064 6174 655f 746f           date_to
+0001d980: 5f73 7472 696e 673d 2727 2c20 7361 7665  _string='', save
+0001d990: 5f66 6c61 673d 4661 6c73 652c 2063 6f6d  _flag=False, com
+0001d9a0: 6269 6e65 5f72 6172 655f 666c 6167 3d46  bine_rare_flag=F
+0001d9b0: 616c 7365 2c20 7665 7262 6f73 653d 3029  alse, verbose=0)
+0001d9c0: 3a0a 2020 2020 2222 220a 2020 2020 2323  :.    """.    ##
+0001d9d0: 2323 2323 2323 2323 2323 2323 2323 2323  ################
+0001d9e0: 2323 2323 2323 2323 2323 2323 2323 2323  ################
+0001d9f0: 2323 2323 2323 2323 2323 2323 2323 2323  ################
+0001da00: 2323 2323 2323 2323 2323 2323 2323 2323  ################
+0001da10: 2323 2323 2323 2323 2323 2323 2323 2323  ################
+0001da20: 2323 2323 2323 2323 2323 2323 2323 2323  ################
+0001da30: 2323 2323 2323 2323 2323 2323 2323 2323  ################
+0001da40: 2323 2323 0a20 2020 2023 2023 2054 6869  ####.    # # Thi
+0001da50: 7320 6973 2074 6865 2053 494d 504c 4553  s is the SIMPLES
+0001da60: 5420 6265 7374 2070 6970 656c 696e 6520  T best pipeline 
+0001da70: 666f 7220 4e4c 5020 616e 6420 5469 6d65  for NLP and Time
+0001da80: 2053 6572 6965 7320 7072 6f62 6c65 6d73   Series problems
+0001da90: 202d 2043 7265 6174 6564 2062 7920 5261   - Created by Ra
+0001daa0: 6d20 5365 7368 6164 7269 0a20 2020 2023  m Seshadri.    #
+0001dab0: 2323 2323 2320 5468 6973 2070 6970 656c  ##### This pipel
+0001dac0: 696e 6520 6973 2069 6e73 7069 7265 6420  ine is inspired 
+0001dad0: 6279 204b 6576 696e 204d 6172 6b68 616d  by Kevin Markham
+0001dae0: 2773 2063 6c61 7373 206f 6e20 5363 696b  's class on Scik
+0001daf0: 6974 2d4c 6561 726e 2070 6970 656c 696e  it-Learn pipelin
+0001db00: 6573 2e20 0a20 2020 2023 2323 2323 2320  es. .    ###### 
+0001db10: 2020 2020 2059 6f75 2063 616e 2073 6967       You can sig
+0001db20: 6e20 7570 2066 6f72 2068 6973 2044 6174  n up for his Dat
+0001db30: 6120 5363 686f 6f6c 2063 6c61 7373 2068  a School class h
+0001db40: 6572 653a 2068 7474 7073 3a2f 2f77 7777  ere: https://www
+0001db50: 2e64 6174 6173 6368 6f6f 6c2e 696f 2f0a  .dataschool.io/.
+0001db60: 2020 2020 2323 2323 2323 2323 2323 2323      ############
+0001db70: 2323 2323 2323 2323 2323 2323 2323 2323  ################
+0001db80: 2323 2323 2323 2323 2323 2323 2323 2323  ################
+0001db90: 2323 2323 2323 2323 2323 2323 2323 2323  ################
+0001dba0: 2323 2323 2323 2323 2323 2323 2323 2323  ################
+0001dbb0: 2323 2323 2323 2323 2323 2323 2323 2323  ################
+0001dbc0: 2323 2323 2323 2323 2323 2323 2323 2323  ################
+0001dbd0: 2323 2323 2323 2323 2323 0a20 2020 2023  ##########.    #
+0001dbe0: 2323 2320 5768 6174 2064 6f65 7320 7468  ### What does th
+0001dbf0: 6973 2070 6970 656c 696e 6520 646f 2e20  is pipeline do. 
+0001dc00: 4865 7265 2773 2074 6865 206d 616a 6f72  Here's the major
+0001dc10: 2073 7465 7073 3a0a 2020 2020 2320 312e   steps:.    # 1.
+0001dc20: 2054 616b 6573 2063 6174 6567 6f72 6963   Takes categoric
+0001dc30: 616c 2076 6172 6961 626c 6573 2061 6e64  al variables and
+0001dc40: 2065 6e63 6f64 6573 2074 6865 6d20 7573   encodes them us
+0001dc50: 696e 6720 6d79 2073 7065 6369 616c 206c  ing my special l
+0001dc60: 6162 656c 2065 6e63 6f64 6572 2077 6869  abel encoder whi
+0001dc70: 6368 2063 616e 2068 616e 646c 6520 4e61  ch can handle Na
+0001dc80: 4e73 2061 6e64 2066 7574 7572 6520 6361  Ns and future ca
+0001dc90: 7465 676f 7269 6573 0a20 2020 2023 2032  tegories.    # 2
+0001dca0: 2e20 5461 6b65 7320 6e75 6d65 7269 6320  . Takes numeric 
+0001dcb0: 7661 7269 6162 6c65 7320 616e 6420 696d  variables and im
+0001dcc0: 7075 7465 7320 7468 656d 2075 7369 6e67  putes them using
+0001dcd0: 2061 2073 696d 706c 6520 696d 7075 7465   a simple impute
+0001dce0: 720a 2020 2020 2320 332e 2054 616b 6573  r.    # 3. Takes
+0001dcf0: 204e 4c50 2061 6e64 2074 696d 6520 7365   NLP and time se
+0001dd00: 7269 6573 2028 7374 7269 6e67 2920 7661  ries (string) va
+0001dd10: 7269 6162 6c65 7320 616e 6420 7665 6374  riables and vect
+0001dd20: 6f72 697a 6573 2074 6865 6d20 7573 696e  orizes them usin
+0001dd30: 6720 436f 756e 7456 6563 746f 7269 7a65  g CountVectorize
+0001dd40: 720a 2020 2020 2320 342e 2043 6f6d 706c  r.    # 4. Compl
+0001dd50: 6574 656c 7920 7374 616e 6461 7264 697a  etely standardiz
+0001dd60: 696e 6720 616c 6c20 6f66 2074 6865 2061  ing all of the a
+0001dd70: 626f 7665 2075 7369 6e67 2041 6273 4d61  bove using AbsMa
+0001dd80: 7853 6361 6c65 7220 7768 6963 6820 7072  xScaler which pr
+0001dd90: 6573 6572 7665 7320 7468 6520 7265 6c61  eserves the rela
+0001dda0: 7469 6f6e 7368 6970 206f 6620 6c61 6265  tionship of labe
+0001ddb0: 6c20 656e 636f 6465 6420 7661 7273 0a20  l encoded vars. 
+0001ddc0: 2020 2023 2035 2e20 4669 6e61 6c6c 7920     # 5. Finally 
+0001ddd0: 6164 6473 2061 6e20 5246 4320 6f72 2052  adds an RFC or R
+0001dde0: 4652 2074 6f20 7468 6520 7069 7065 6c69  FR to the pipeli
+0001ddf0: 6e65 2073 6f20 7468 6520 656e 7469 7265  ne so the entire
+0001de00: 2070 6970 656c 696e 6520 6361 6e20 6265   pipeline can be
+0001de10: 2066 6564 2074 6f20 6120 6372 6f73 7320   fed to a cross 
+0001de20: 7661 6c69 6461 7469 6f6e 2073 6368 656d  validation schem
+0001de30: 650a 2020 2020 2323 2323 2054 6865 2072  e.    #### The r
+0001de40: 6573 756c 7473 2061 7265 2079 6574 2074  esults are yet t
+0001de50: 6f20 6265 2054 484f 524f 5547 484c 5920  o be THOROUGHLY 
+0001de60: 5445 5354 4544 2062 7574 2070 7265 6c69  TESTED but preli
+0001de70: 6d69 6e61 7279 2072 6573 756c 7473 204f  minary results O
+0001de80: 4620 5448 4953 2050 4950 454c 494e 4520  F THIS PIPELINE 
+0001de90: 4152 4520 7665 7279 2070 726f 6d69 7369  ARE very promisi
+0001dea0: 6e67 2049 4e44 4545 442e 0a20 2020 2023  ng INDEED..    #
+0001deb0: 2323 2323 2323 2323 2323 2323 2323 2323  ################
+0001dec0: 2323 2323 2323 2323 2323 2323 2323 2323  ################
+0001ded0: 2323 2323 2323 2323 2323 2323 2323 2323  ################
+0001dee0: 2323 2323 2323 2323 2323 2323 2323 2323  ################
+0001def0: 2323 2323 2323 2323 2323 2323 2323 2323  ################
+0001df00: 2323 2323 2323 2323 2323 2323 2323 2323  ################
+0001df10: 2323 2323 2323 2323 2323 2323 2323 2323  ################
+0001df20: 2323 2323 230a 2020 2020 2222 220a 2020  #####.    """.  
+0001df30: 2020 7374 6172 745f 7469 6d65 203d 2074    start_time = t
+0001df40: 696d 652e 7469 6d65 2829 0a20 2020 2023  ime.time().    #
+0001df50: 2323 204e 6f77 2064 6563 6964 6520 7768  ## Now decide wh
+0001df60: 6963 6820 7069 7065 6c69 6e65 2079 6f75  ich pipeline you
+0001df70: 2077 616e 7420 746f 2075 7365 2023 2323   want to use ###
+0001df80: 2323 2323 2323 2323 0a20 2020 2023 2323  ########.    ###
+0001df90: 2323 204e 6f77 2073 6574 2075 7020 616c  ## Now set up al
+0001dfa0: 6c20 7468 6520 656e 636f 6465 7273 2023  l the encoders #
+0001dfb0: 2323 2323 2323 2323 2323 2323 2323 2323  ################
+0001dfc0: 230a 2020 2020 6966 2069 7369 6e73 7461  #.    if isinsta
+0001dfd0: 6e63 6528 656e 636f 6465 7273 2c20 6c69  nce(encoders, li
+0001dfe0: 7374 293a 0a20 2020 2020 2020 2062 6173  st):.        bas
+0001dff0: 6963 5f65 6e63 6f64 6572 203d 2065 6e63  ic_encoder = enc
+0001e000: 6f64 6572 735b 305d 0a20 2020 2020 2020  oders[0].       
+0001e010: 2065 6e63 6f64 6572 203d 2065 6e63 6f64   encoder = encod
+0001e020: 6572 735b 315d 0a20 2020 2020 2020 2069  ers[1].        i
+0001e030: 6620 6e6f 7420 6973 696e 7374 616e 6365  f not isinstance
+0001e040: 2862 6173 6963 5f65 6e63 6f64 6572 2c20  (basic_encoder, 
+0001e050: 7374 7229 206f 7220 6e6f 7420 6973 696e  str) or not isin
+0001e060: 7374 616e 6365 2865 6e63 6f64 6572 2c20  stance(encoder, 
+0001e070: 7374 7229 3a0a 2020 2020 2020 2020 2020  str):.          
+0001e080: 2020 7072 696e 7428 2765 6e63 6f64 6572    print('encoder
+0001e090: 7320 6d75 7374 2062 6520 6569 7468 6572  s must be either
+0001e0a0: 2073 7472 696e 6720 6f72 206c 6973 7420   string or list 
+0001e0b0: 6f66 2073 7472 696e 6773 2e20 506c 6561  of strings. Plea
+0001e0c0: 7365 2063 6865 636b 2079 6f75 7220 696e  se check your in
+0001e0d0: 7075 7420 616e 6420 7472 7920 6167 6169  put and try agai
+0001e0e0: 6e2e 2729 0a20 2020 2020 2020 2020 2020  n.').           
+0001e0f0: 2072 6574 7572 6e0a 2020 2020 656c 6966   return.    elif
+0001e100: 2069 7369 6e73 7461 6e63 6528 656e 636f   isinstance(enco
+0001e110: 6465 7273 2c20 7374 7229 3a0a 2020 2020  ders, str):.    
+0001e120: 2020 2020 6966 2065 6e63 6f64 6572 7320      if encoders 
+0001e130: 3d3d 2027 6175 746f 273a 0a20 2020 2020  == 'auto':.     
+0001e140: 2020 2020 2020 2062 6173 6963 5f65 6e63         basic_enc
+0001e150: 6f64 6572 203d 2027 6f6e 6568 6f74 270a  oder = 'onehot'.
+0001e160: 2020 2020 2020 2020 2020 2020 656e 636f              enco
+0001e170: 6465 7220 3d20 276c 6162 656c 270a 2020  der = 'label'.  
+0001e180: 2020 2020 2020 656c 7365 3a0a 2020 2020        else:.    
+0001e190: 2020 2020 2020 2020 6261 7369 635f 656e          basic_en
+0001e1a0: 636f 6465 7220 3d20 636f 7079 2e64 6565  coder = copy.dee
+0001e1b0: 7063 6f70 7928 656e 636f 6465 7273 290a  pcopy(encoders).
+0001e1c0: 2020 2020 2020 2020 2020 2020 656e 636f              enco
+0001e1d0: 6465 7220 3d20 636f 7079 2e64 6565 7063  der = copy.deepc
+0001e1e0: 6f70 7928 656e 636f 6465 7273 290a 2020  opy(encoders).  
+0001e1f0: 2020 656c 7365 3a0a 2020 2020 2020 2020    else:.        
+0001e200: 7072 696e 7428 2765 6e63 6f64 6572 7320  print('encoders 
+0001e210: 6d75 7374 2062 6520 6569 7468 6572 2073  must be either s
+0001e220: 7472 696e 6720 6f72 206c 6973 7420 6f66  tring or list of
+0001e230: 2073 7472 696e 6773 2e20 506c 6561 7365   strings. Please
+0001e240: 2063 6865 636b 2079 6f75 7220 696e 7075   check your inpu
+0001e250: 7420 616e 6420 7472 7920 6167 6169 6e2e  t and try again.
+0001e260: 2729 0a20 2020 2020 2020 2072 6574 7572  ').        retur
+0001e270: 6e0a 2020 2020 6966 2069 7369 6e73 7461  n.    if isinsta
+0001e280: 6e63 6528 585f 7472 6169 6e2c 206e 702e  nce(X_train, np.
+0001e290: 6e64 6172 7261 7929 3a0a 2020 2020 2020  ndarray):.      
+0001e2a0: 2020 7072 696e 7428 2758 5f74 7261 696e    print('X_train
+0001e2b0: 2069 6e70 7574 206d 7573 7420 6265 2061   input must be a
+0001e2c0: 2064 6174 6166 7261 6d65 2073 696e 6365   dataframe since
+0001e2d0: 2077 6520 7573 6520 636f 6c75 6d6e 206e   we use column n
+0001e2e0: 616d 6573 2074 6f20 6275 696c 6420 6461  ames to build da
+0001e2f0: 7461 2070 6970 656c 696e 6573 2e20 5265  ta pipelines. Re
+0001e300: 7475 726e 696e 6727 290a 2020 2020 2020  turning').      
+0001e310: 2020 7265 7475 726e 207b 7d2c 207b 7d0a    return {}, {}.
+0001e320: 2020 2020 0a20 2020 2064 6620 3d20 7064      .    df = pd
+0001e330: 2e63 6f6e 6361 7428 5b58 5f74 7261 696e  .concat([X_train
+0001e340: 2c20 795f 7472 6169 6e5d 2c20 6178 6973  , y_train], axis
+0001e350: 3d31 290a 2020 2020 6966 2069 7369 6e73  =1).    if isins
+0001e360: 7461 6e63 6528 795f 7472 6169 6e2c 2070  tance(y_train, p
+0001e370: 642e 5365 7269 6573 293a 0a20 2020 2020  d.Series):.     
+0001e380: 2020 2074 6172 6765 7420 3d20 795f 7472     target = y_tr
+0001e390: 6169 6e2e 6e61 6d65 0a20 2020 2020 2020  ain.name.       
+0001e3a0: 2074 6172 6765 7473 203d 205b 7461 7267   targets = [targ
+0001e3b0: 6574 5d0a 2020 2020 656c 6966 2069 7369  et].    elif isi
+0001e3c0: 6e73 7461 6e63 6528 795f 7472 6169 6e2c  nstance(y_train,
+0001e3d0: 2070 642e 4461 7461 4672 616d 6529 3a0a   pd.DataFrame):.
+0001e3e0: 2020 2020 2020 2020 7461 7267 6574 203d          target =
+0001e3f0: 2079 5f74 7261 696e 2e63 6f6c 756d 6e73   y_train.columns
+0001e400: 2e74 6f6c 6973 7428 290a 2020 2020 2020  .tolist().      
+0001e410: 2020 7461 7267 6574 7320 3d20 636f 7079    targets = copy
+0001e420: 2e64 6565 7063 6f70 7928 7461 7267 6574  .deepcopy(target
+0001e430: 290a 2020 2020 656c 6966 2069 7369 6e73  ).    elif isins
+0001e440: 7461 6e63 6528 585f 7472 6169 6e2c 206e  tance(X_train, n
+0001e450: 702e 6e64 6172 7261 7929 3a0a 2020 2020  p.ndarray):.    
+0001e460: 2020 2020 7072 696e 7428 2779 5f74 7261      print('y_tra
+0001e470: 696e 206d 7573 7420 6265 2061 2070 642e  in must be a pd.
+0001e480: 5365 7269 6573 206f 7220 7064 2e44 6174  Series or pd.Dat
+0001e490: 6146 7261 6d65 2073 696e 6365 2077 6520  aFrame since we 
+0001e4a0: 7573 6520 636f 6c75 6d6e 206e 616d 6573  use column names
+0001e4b0: 2074 6f20 6275 696c 6420 6461 7461 2070   to build data p
+0001e4c0: 6970 656c 696e 652e 2052 6574 7572 6e69  ipeline. Returni
+0001e4d0: 6e67 2729 0a20 2020 2020 2020 2072 6574  ng').        ret
+0001e4e0: 7572 6e20 7b7d 2c20 7b7d 0a20 2020 2023  urn {}, {}.    #
+0001e4f0: 2323 2323 2320 5468 6973 2068 656c 7073  ##### This helps
+0001e500: 2066 696e 6420 616c 6c20 7468 6520 7072   find all the pr
+0001e510: 6564 6963 746f 7220 7661 7269 6162 6c65  edictor variable
+0001e520: 7320 0a20 2020 2063 6f6c 7320 3d20 585f  s .    cols = X_
+0001e530: 7472 6169 6e2e 636f 6c75 6d6e 732e 746f  train.columns.to
+0001e540: 6c69 7374 2829 0a20 2020 2023 2323 2320  list().    #### 
+0001e550: 5365 6e64 2074 6172 6765 7420 7661 7269  Send target vari
+0001e560: 6162 6c65 2061 7320 6974 2069 7320 736f  able as it is so
+0001e570: 2074 6861 7420 795f 7472 6169 6e20 6973   that y_train is
+0001e580: 2061 6e61 6c79 7a65 6420 7072 6f70 6572   analyzed proper
+0001e590: 6c79 2023 2323 0a20 2020 206d 6f64 656c  ly ###.    model
+0001e5a0: 7479 7065 2c20 6d75 6c74 695f 6c61 6265  type, multi_labe
+0001e5b0: 6c20 3d20 616e 616c 797a 655f 7072 6f62  l = analyze_prob
+0001e5c0: 6c65 6d5f 7479 7065 2879 5f74 7261 696e  lem_type(y_train
+0001e5d0: 2c20 7461 7267 6574 2c20 7665 7262 6f73  , target, verbos
+0001e5e0: 653d 3129 0a20 2020 2070 7269 6e74 2827  e=1).    print('
+0001e5f0: 5368 6170 6520 6f66 2064 6174 6173 6574  Shape of dataset
+0001e600: 3a20 2573 2e20 4e6f 7720 7765 2063 6c61  : %s. Now we cla
+0001e610: 7373 6966 7920 7661 7269 6162 6c65 7320  ssify variables 
+0001e620: 696e 746f 2064 6966 6665 7265 6e74 2074  into different t
+0001e630: 7970 6573 2e2e 2e27 2025 2858 5f74 7261  ypes...' %(X_tra
+0001e640: 696e 2e73 6861 7065 2c29 290a 2020 2020  in.shape,)).    
+0001e650: 7661 725f 6469 6374 203d 2063 6c61 7373  var_dict = class
+0001e660: 6966 795f 7661 7273 5f70 616e 6461 7328  ify_vars_pandas(
+0001e670: 6466 5b63 6f6c 735d 2c76 6572 626f 7365  df[cols],verbose
+0001e680: 290a 2020 2020 2323 2323 204f 6e63 6520  ).    #### Once 
+0001e690: 7661 7273 2061 7265 2063 6c61 7373 6966  vars are classif
+0001e6a0: 6965 6420 6275 636b 6574 2074 6865 6d20  ied bucket them 
+0001e6b0: 696e 746f 206d 616a 6f72 2074 7970 6573  into major types
+0001e6c0: 2023 2323 0a20 2020 2063 6174 7661 7273   ###.    catvars
+0001e6d0: 203d 2076 6172 5f64 6963 745b 2763 6174   = var_dict['cat
+0001e6e0: 6567 6f72 6963 616c 5f76 6172 7327 5d20  egorical_vars'] 
+0001e6f0: 2323 2320 7468 6573 6520 6172 6520 6c6f  ### these are lo
+0001e700: 7720 6361 7264 696e 616c 6974 7920 6361  w cardinality ca
+0001e710: 7420 7661 7269 6162 6c65 7320 0a20 2020  t variables .   
+0001e720: 2064 6973 6372 6574 6576 6172 7320 3d20   discretevars = 
+0001e730: 7661 725f 6469 6374 5b27 6469 7363 7265  var_dict['discre
+0001e740: 7465 5f73 7472 696e 675f 7661 7273 275d  te_string_vars']
+0001e750: 2023 2323 2074 6865 7365 2061 7265 2068   ### these are h
+0001e760: 6967 6820 6361 7264 696e 616c 6974 7920  igh cardinality 
+0001e770: 6361 7420 7661 7269 6162 6c65 7320 0a20  cat variables . 
+0001e780: 2020 2066 6c6f 6174 7661 7273 203d 2076     floatvars = v
+0001e790: 6172 5f64 6963 745b 2763 6f6e 7469 6e75  ar_dict['continu
+0001e7a0: 6f75 735f 7661 7273 275d 0a20 2020 2069  ous_vars'].    i
+0001e7b0: 6e74 7661 7273 203d 2076 6172 5f64 6963  ntvars = var_dic
+0001e7c0: 745b 2769 6e74 5f76 6172 7327 5d0a 2020  t['int_vars'].  
+0001e7d0: 2020 6e6c 7076 6172 7320 3d20 7661 725f    nlpvars = var_
+0001e7e0: 6469 6374 5b27 6e6c 705f 7661 7273 275d  dict['nlp_vars']
+0001e7f0: 0a20 2020 2064 6174 6576 6172 7320 3d20  .    datevars = 
+0001e800: 7661 725f 6469 6374 5b27 6461 7465 5f76  var_dict['date_v
+0001e810: 6172 7327 5d20 2b20 7661 725f 6469 6374  ars'] + var_dict
+0001e820: 5b27 7469 6d65 5f64 656c 7461 7327 5d20  ['time_deltas'] 
+0001e830: 2b20 7661 725f 6469 6374 5b27 6461 7465  + var_dict['date
+0001e840: 5f7a 6f6e 6573 275d 0a20 2020 2023 2323  _zones'].    ###
+0001e850: 2320 436f 6e76 6572 7469 6e67 2064 6174  # Converting dat
+0001e860: 6520 7661 7269 6162 6c65 2074 6f20 6120  e variable to a 
+0001e870: 7374 7269 6e67 2076 6172 6961 626c 6520  string variable 
+0001e880: 6966 2074 6861 7420 6973 2072 6571 7565  if that is reque
+0001e890: 7374 6564 2023 2323 2323 2323 2323 2323  sted ###########
+0001e8a0: 2323 2323 2323 2323 0a20 2020 2069 6620  ########.    if 
+0001e8b0: 6461 7465 5f74 6f5f 7374 7269 6e67 3a0a  date_to_string:.
+0001e8c0: 2020 2020 2020 2020 6966 2069 7369 6e73          if isins
+0001e8d0: 7461 6e63 6528 6461 7465 5f74 6f5f 7374  tance(date_to_st
+0001e8e0: 7269 6e67 2c20 7374 7229 3a0a 2020 2020  ring, str):.    
+0001e8f0: 2020 2020 2020 2020 636f 7079 5f64 6174          copy_dat
+0001e900: 6576 6172 7320 3d20 5b64 6174 655f 746f  evars = [date_to
+0001e910: 5f73 7472 696e 675d 0a20 2020 2020 2020  _string].       
+0001e920: 2065 6c73 653a 0a20 2020 2020 2020 2020   else:.         
+0001e930: 2020 2063 6f70 795f 6461 7465 7661 7273     copy_datevars
+0001e940: 203d 2063 6f70 792e 6465 6570 636f 7079   = copy.deepcopy
+0001e950: 2864 6174 655f 746f 5f73 7472 696e 6729  (date_to_string)
+0001e960: 0a20 2020 2020 2020 2023 2320 6966 2074  .        ## if t
+0001e970: 6865 7920 6861 7665 2067 6976 656e 206f  hey have given o
+0001e980: 6e6c 7920 6f6e 6520 7374 7269 6e67 2076  nly one string v
+0001e990: 6172 6961 626c 6520 0a20 2020 2020 2020  ariable .       
+0001e9a0: 2066 6f72 2065 6163 685f 6461 7465 2069   for each_date i
+0001e9b0: 6e20 636f 7079 5f64 6174 6576 6172 733a  n copy_datevars:
+0001e9c0: 0a20 2020 2020 2020 2020 2020 2070 7269  .            pri
+0001e9d0: 6e74 2827 2020 2020 7374 7269 6e67 2076  nt('    string v
+0001e9e0: 6172 6961 626c 6520 2573 2077 696c 6c20  ariable %s will 
+0001e9f0: 6265 2074 7265 6174 6564 2061 7320 4e4c  be treated as NL
+0001ea00: 5020 7661 7220 616e 6420 7472 616e 7366  P var and transf
+0001ea10: 6f72 6d65 6420 6279 2054 6669 6466 5665  ormed by TfidfVe
+0001ea20: 6374 6f72 697a 6572 2720 2565 6163 685f  ctorizer' %each_
+0001ea30: 6461 7465 290a 2020 2020 2020 2020 2020  date).          
+0001ea40: 2020 585f 7472 6169 6e5b 6561 6368 5f64    X_train[each_d
+0001ea50: 6174 655d 203d 2058 5f74 7261 696e 5b65  ate] = X_train[e
+0001ea60: 6163 685f 6461 7465 5d2e 6173 7479 7065  ach_date].astype
+0001ea70: 2873 7472 292e 7661 6c75 6573 0a20 2020  (str).values.   
+0001ea80: 2020 2020 2020 2020 2069 6620 6e6f 7420           if not 
+0001ea90: 6561 6368 5f64 6174 6520 696e 206e 6c70  each_date in nlp
+0001eaa0: 7661 7273 3a0a 2020 2020 2020 2020 2020  vars:.          
+0001eab0: 2020 2020 2020 6e6c 7076 6172 732e 6170        nlpvars.ap
+0001eac0: 7065 6e64 2865 6163 685f 6461 7465 290a  pend(each_date).
+0001ead0: 2020 2020 2020 2020 2020 2020 2323 2323              ####
+0001eae0: 204e 6578 7420 6368 6563 6b20 746f 2072   Next check to r
+0001eaf0: 656d 6f76 6520 7468 656d 2068 6572 6520  emove them here 
+0001eb00: 2323 230a 2020 2020 2020 2020 2020 2020  ###.            
+0001eb10: 6966 2065 6163 685f 6461 7465 2069 6e20  if each_date in 
+0001eb20: 6461 7465 7661 7273 3a0a 2020 2020 2020  datevars:.      
+0001eb30: 2020 2020 2020 2020 2020 6461 7465 7661            dateva
+0001eb40: 7273 2e72 656d 6f76 6528 6561 6368 5f64  rs.remove(each_d
+0001eb50: 6174 6529 0a20 2020 2020 2020 2020 2020  ate).           
+0001eb60: 2065 6c69 6620 6561 6368 5f64 6174 6520   elif each_date 
+0001eb70: 696e 2064 6973 6372 6574 6576 6172 733a  in discretevars:
+0001eb80: 0a20 2020 2020 2020 2020 2020 2020 2020  .               
+0001eb90: 2064 6973 6372 6574 6576 6172 732e 7265   discretevars.re
+0001eba0: 6d6f 7665 2865 6163 685f 6461 7465 290a  move(each_date).
+0001ebb0: 2020 2020 2020 2020 2020 2020 656c 6966              elif
+0001ebc0: 2065 6163 685f 6461 7465 2069 6e20 6361   each_date in ca
+0001ebd0: 7476 6172 733a 0a20 2020 2020 2020 2020  tvars:.         
+0001ebe0: 2020 2020 2020 2063 6174 7661 7273 2e72         catvars.r
+0001ebf0: 656d 6f76 6528 6561 6368 5f64 6174 6529  emove(each_date)
+0001ec00: 0a20 2020 2023 2323 204e 6f77 2064 6f20  .    ### Now do 
+0001ec10: 7468 6520 6163 7475 616c 2070 726f 6365  the actual proce
+0001ec20: 7373 696e 6720 666f 7220 6461 7465 7661  ssing for dateva
+0001ec30: 7273 2023 2323 2323 2323 230a 2020 2020  rs ########.    
+0001ec40: 6966 2064 6174 6576 6172 733a 0a20 2020  if datevars:.   
+0001ec50: 2020 2020 2069 6620 7665 7262 6f73 653a       if verbose:
+0001ec60: 0a20 2020 2020 2020 2020 2020 2070 7269  .            pri
+0001ec70: 6e74 2827 4461 7465 2074 696d 6520 7661  nt('Date time va
+0001ec80: 7273 3a20 2573 2064 6574 6563 7465 642e  rs: %s detected.
+0001ec90: 2053 6576 6572 616c 2066 6561 7475 7265   Several feature
+0001eca0: 7320 7769 6c6c 2062 6520 6578 7472 6163  s will be extrac
+0001ecb0: 7465 642e 2e2e 2720 2564 6174 6576 6172  ted...' %datevar
+0001ecc0: 7329 0a20 2020 2020 2020 2065 6c73 653a  s).        else:
+0001ecd0: 0a20 2020 2020 2020 2020 2020 2070 6173  .            pas
+0001ece0: 730a 2020 2020 656c 7365 3a0a 2020 2020  s.    else:.    
+0001ecf0: 2020 2020 6966 2076 6572 626f 7365 3a0a      if verbose:.
+0001ed00: 2020 2020 2020 2020 2020 2020 7072 696e              prin
+0001ed10: 7428 2720 2020 206e 6f20 6461 7465 2074  t('    no date t
+0001ed20: 696d 6520 7661 7269 6162 6c65 7320 6465  ime variables de
+0001ed30: 7465 6374 6564 2069 6e20 7468 6973 2064  tected in this d
+0001ed40: 6174 6173 6574 2729 0a20 2020 2020 2020  ataset').       
+0001ed50: 2065 6c73 653a 0a20 2020 2020 2020 2020   else:.         
+0001ed60: 2020 2070 6173 730a 2020 2020 2323 2323     pass.    ####
+0001ed70: 2323 2323 2323 2323 2323 2323 2323 2323  ################
+0001ed80: 2323 2323 2323 2323 2323 2323 2323 2323  ################
+0001ed90: 2323 2323 0a20 2020 2023 2323 2053 6574  ####.    ### Set
+0001eda0: 2074 6865 2063 6174 6567 6f72 7920 656e   the category en
+0001edb0: 636f 6465 7273 2068 6572 6520 2323 2323  coders here ####
+0001edc0: 230a 2020 2020 2323 2323 2323 2323 2323  #.    ##########
+0001edd0: 2323 2323 2323 2323 2323 2323 2323 2323  ################
+0001ede0: 2323 2323 2323 2323 2323 2323 2323 0a20  ##############. 
+0001edf0: 2020 2023 2323 2059 6f75 2061 7265 2067     ### You are g
+0001ee00: 6f69 6e67 2074 6f20 7365 7420 4c61 6265  oing to set Labe
+0001ee10: 6c20 456e 636f 6465 7220 6173 2074 6865  l Encoder as the
+0001ee20: 2064 6566 6175 6c74 2065 6e63 6f64 6572   default encoder
+0001ee30: 2073 696e 6365 2069 7420 6973 206d 6f73   since it is mos
+0001ee40: 7420 7665 7273 6174 696c 6520 2323 0a20  t versatile ##. 
+0001ee50: 2020 2064 6566 2064 6566 6175 6c74 5f65     def default_e
+0001ee60: 6e63 6f64 6572 2829 3a0a 2020 2020 2020  ncoder():.      
+0001ee70: 2020 7265 7475 726e 204d 795f 4c61 6265    return My_Labe
+0001ee80: 6c45 6e63 6f64 6572 2829 0a20 2020 2065  lEncoder().    e
+0001ee90: 6e63 6f64 6572 5f64 6963 7420 3d20 6465  ncoder_dict = de
+0001eea0: 6661 756c 7464 6963 7428 6465 6661 756c  faultdict(defaul
+0001eeb0: 745f 656e 636f 6465 7229 0a0a 2020 2020  t_encoder)..    
+0001eec0: 2323 2320 796f 7520 6d75 7374 206c 6561  ### you must lea
+0001eed0: 7665 2064 726f 705f 696e 7661 7269 616e  ve drop_invarian
+0001eee0: 7420 3d20 4661 6c73 6520 666f 7220 6361  t = False for ca
+0001eef0: 7462 6f6f 7374 2073 696e 6365 2069 7420  tboost since it 
+0001ef00: 6973 206e 6f74 2061 206f 6e68 6f74 2074  is not a onhot t
+0001ef10: 7970 6520 656e 636f 6465 722e 2023 230a  ype encoder. ##.
+0001ef20: 2020 2020 656e 636f 6465 725f 6469 6374      encoder_dict
+0001ef30: 203d 207b 0a20 2020 2020 2020 2020 2020   = {.           
+0001ef40: 2020 2020 2020 2020 2023 276f 6e65 686f           #'oneho
+0001ef50: 7427 3a20 4f6e 6548 6f74 456e 636f 6465  t': OneHotEncode
+0001ef60: 7228 6861 6e64 6c65 5f75 6e6b 6e6f 776e  r(handle_unknown
+0001ef70: 3d27 6967 6e6f 7265 2729 2c20 2323 2074  ='ignore'), ## t
+0001ef80: 6869 7320 6973 2066 6f72 2073 6b6c 6561  his is for sklea
+0001ef90: 726e 2076 6572 7369 6f6e 2023 230a 2020  rn version ##.  
+0001efa0: 2020 2020 2020 2020 2020 2020 2020 2020                  
+0001efb0: 2020 276f 6e65 686f 7427 3a20 4f6e 6548    'onehot': OneH
+0001efc0: 6f74 456e 636f 6465 7228 6861 6e64 6c65  otEncoder(handle
+0001efd0: 5f75 6e6b 6e6f 776e 3d27 7661 6c75 6527  _unknown='value'
+0001efe0: 292c 2023 2323 2074 6869 7320 6973 2066  ), ### this is f
+0001eff0: 6f72 2063 6174 6567 6f72 795f 656e 636f  or category_enco
+0001f000: 6465 7273 2076 6572 7369 6f6e 0a20 2020  ders version.   
+0001f010: 2020 2020 2020 2020 2020 2020 2020 2020                  
+0001f020: 2027 6f72 6469 6e61 6c27 3a20 4f72 6469   'ordinal': Ordi
+0001f030: 6e61 6c45 6e63 6f64 6572 2829 2c0a 2020  nalEncoder(),.  
+0001f040: 2020 2020 2020 2020 2020 2020 2020 2020                  
+0001f050: 2020 2768 6173 6869 6e67 273a 2048 6173    'hashing': Has
+0001f060: 6869 6e67 456e 636f 6465 7228 6e5f 636f  hingEncoder(n_co
+0001f070: 6d70 6f6e 656e 7473 3d32 302c 2064 726f  mponents=20, dro
+0001f080: 705f 696e 7661 7269 616e 743d 5472 7565  p_invariant=True
+0001f090: 292c 0a20 2020 2020 2020 2020 2020 2020  ),.             
+0001f0a0: 2020 2020 2020 2027 6861 7368 273a 2048         'hash': H
+0001f0b0: 6173 6869 6e67 456e 636f 6465 7228 6e5f  ashingEncoder(n_
+0001f0c0: 636f 6d70 6f6e 656e 7473 3d32 302c 2064  components=20, d
+0001f0d0: 726f 705f 696e 7661 7269 616e 743d 5472  rop_invariant=Tr
+0001f0e0: 7565 292c 0a20 2020 2020 2020 2020 2020  ue),.           
+0001f0f0: 2020 2020 2020 2020 2027 636f 756e 7427           'count'
+0001f100: 3a20 436f 756e 7445 6e63 6f64 6572 2864  : CountEncoder(d
+0001f110: 726f 705f 696e 7661 7269 616e 743d 5472  rop_invariant=Tr
+0001f120: 7565 292c 0a20 2020 2020 2020 2020 2020  ue),.           
+0001f130: 2020 2020 2020 2020 2027 6361 7462 6f6f           'catboo
+0001f140: 7374 273a 2043 6174 426f 6f73 7445 6e63  st': CatBoostEnc
+0001f150: 6f64 6572 2864 726f 705f 696e 7661 7269  oder(drop_invari
+0001f160: 616e 743d 4661 6c73 6529 2c0a 2020 2020  ant=False),.    
+0001f170: 2020 2020 2020 2020 2020 2020 2020 2020                  
+0001f180: 2774 6172 6765 7427 3a20 5461 7267 6574  'target': Target
+0001f190: 456e 636f 6465 7228 6d69 6e5f 7361 6d70  Encoder(min_samp
+0001f1a0: 6c65 735f 6c65 6166 3d33 2c20 6472 6f70  les_leaf=3, drop
+0001f1b0: 5f69 6e76 6172 6961 6e74 3d54 7275 6529  _invariant=True)
+0001f1c0: 2c0a 2020 2020 2020 2020 2020 2020 2020  ,.              
+0001f1d0: 2020 2020 2020 2767 6c6d 273a 2047 4c4d        'glm': GLM
+0001f1e0: 4d45 6e63 6f64 6572 2864 726f 705f 696e  MEncoder(drop_in
+0001f1f0: 7661 7269 616e 743d 5472 7565 292c 0a20  variant=True),. 
+0001f200: 2020 2020 2020 2020 2020 2020 2020 2020                  
+0001f210: 2020 2027 676c 6d6d 273a 2047 4c4d 4d45     'glmm': GLMME
+0001f220: 6e63 6f64 6572 2864 726f 705f 696e 7661  ncoder(drop_inva
+0001f230: 7269 616e 743d 5472 7565 292c 0a20 2020  riant=True),.   
+0001f240: 2020 2020 2020 2020 2020 2020 2020 2020                  
+0001f250: 2027 7375 6d27 3a20 5375 6d45 6e63 6f64   'sum': SumEncod
+0001f260: 6572 2864 726f 705f 696e 7661 7269 616e  er(drop_invarian
+0001f270: 743d 5472 7565 292c 0a20 2020 2020 2020  t=True),.       
+0001f280: 2020 2020 2020 2020 2020 2020 2027 776f               'wo
+0001f290: 6527 3a20 574f 4545 6e63 6f64 6572 2872  e': WOEEncoder(r
+0001f2a0: 616e 646f 6d69 7a65 643d 4661 6c73 652c  andomized=False,
+0001f2b0: 2064 726f 705f 696e 7661 7269 616e 743d   drop_invariant=
+0001f2c0: 5472 7565 292c 0a20 2020 2020 2020 2020  True),.         
+0001f2d0: 2020 2020 2020 2020 2020 2027 6264 6327             'bdc'
+0001f2e0: 3a20 4261 636b 7761 7264 4469 6666 6572  : BackwardDiffer
+0001f2f0: 656e 6365 456e 636f 6465 7228 6472 6f70  enceEncoder(drop
+0001f300: 5f69 6e76 6172 6961 6e74 3d54 7275 6529  _invariant=True)
+0001f310: 2c0a 2020 2020 2020 2020 2020 2020 2020  ,.              
+0001f320: 2020 2020 2020 2762 6465 273a 2042 6163        'bde': Bac
+0001f330: 6b77 6172 6444 6966 6665 7265 6e63 6545  kwardDifferenceE
+0001f340: 6e63 6f64 6572 2864 726f 705f 696e 7661  ncoder(drop_inva
+0001f350: 7269 616e 743d 5472 7565 292c 0a20 2020  riant=True),.   
+0001f360: 2020 2020 2020 2020 2020 2020 2020 2020                  
+0001f370: 2027 6c6f 6f27 3a20 4c65 6176 654f 6e65   'loo': LeaveOne
+0001f380: 4f75 7445 6e63 6f64 6572 2873 6967 6d61  OutEncoder(sigma
+0001f390: 3d30 2e31 302c 2064 726f 705f 696e 7661  =0.10, drop_inva
+0001f3a0: 7269 616e 743d 5472 7565 292c 0a20 2020  riant=True),.   
+0001f3b0: 2020 2020 2020 2020 2020 2020 2020 2020                  
+0001f3c0: 2027 6261 7365 273a 2042 6173 654e 456e   'base': BaseNEn
+0001f3d0: 636f 6465 7228 6261 7365 3d32 2c20 6472  coder(base=2, dr
+0001f3e0: 6f70 5f69 6e76 6172 6961 6e74 3d54 7275  op_invariant=Tru
+0001f3f0: 6529 2c0a 2020 2020 2020 2020 2020 2020  e),.            
+0001f400: 2020 2020 2020 2020 276a 616d 6573 273a          'james':
+0001f410: 204a 616d 6573 5374 6569 6e45 6e63 6f64   JamesSteinEncod
+0001f420: 6572 2864 726f 705f 696e 7661 7269 616e  er(drop_invarian
+0001f430: 743d 5472 7565 292c 0a20 2020 2020 2020  t=True),.       
+0001f440: 2020 2020 2020 2020 2020 2020 2027 6a61               'ja
+0001f450: 6d65 7373 7465 696e 273a 204a 616d 6573  messtein': James
+0001f460: 5374 6569 6e45 6e63 6f64 6572 2864 726f  SteinEncoder(dro
+0001f470: 705f 696e 7661 7269 616e 743d 5472 7565  p_invariant=True
+0001f480: 292c 0a20 2020 2020 2020 2020 2020 2020  ),.             
+0001f490: 2020 2020 2020 2027 6865 6c6d 6572 7427         'helmert'
+0001f4a0: 3a20 4865 6c6d 6572 7445 6e63 6f64 6572  : HelmertEncoder
+0001f4b0: 2864 726f 705f 696e 7661 7269 616e 743d  (drop_invariant=
+0001f4c0: 5472 7565 292c 0a20 2020 2020 2020 2020  True),.         
+0001f4d0: 2020 2020 2020 2020 2020 2023 2773 756d             #'sum
+0001f4e0: 6d61 7279 273a 2053 756d 6d61 7279 456e  mary': SummaryEn
+0001f4f0: 636f 6465 7228 6472 6f70 5f69 6e76 6172  coder(drop_invar
+0001f500: 6961 6e74 3d54 7275 652c 2071 7561 6e74  iant=True, quant
+0001f510: 696c 6573 3d5b 302e 3235 2c20 302e 352c  iles=[0.25, 0.5,
+0001f520: 2031 2e30 5d2c 206d 3d31 2e30 292c 0a20   1.0], m=1.0),. 
+0001f530: 2020 2020 2020 2020 2020 2020 2020 2020                  
+0001f540: 2020 2027 6c61 6265 6c27 3a20 4d79 5f4c     'label': My_L
+0001f550: 6162 656c 456e 636f 6465 7228 292c 0a20  abelEncoder(),. 
+0001f560: 2020 2020 2020 2020 2020 2020 2020 2020                  
+0001f570: 2020 2027 6175 746f 273a 204d 795f 4c61     'auto': My_La
+0001f580: 6265 6c45 6e63 6f64 6572 2829 2c0a 2020  belEncoder(),.  
+0001f590: 2020 2020 2020 2020 2020 2020 2020 2020                  
+0001f5a0: 2020 7d0a 0a20 2020 206e 6f6e 5f6f 6e65    }..    non_one
+0001f5b0: 5f68 6f74 5f6c 6973 7420 3d20 5b27 6c61  _hot_list = ['la
+0001f5c0: 6265 6c27 2c27 6a61 6d65 7327 2c27 6a61  bel','james','ja
+0001f5d0: 6d65 7373 7465 696e 272c 276c 6f6f 272c  messtein','loo',
+0001f5e0: 2777 6f65 272c 2767 6c6d 6d27 2c27 676c  'woe','glmm','gl
+0001f5f0: 6d27 2c27 7461 7267 6574 272c 2763 6174  m','target','cat
+0001f600: 626f 6f73 7427 2c27 636f 756e 7427 2c27  boost','count','
+0001f610: 6f72 6469 6e61 6c27 5d0a 2020 2020 2323  ordinal'].    ##
+0001f620: 2320 7365 7420 7468 6520 6261 7369 6320  # set the basic 
+0001f630: 656e 636f 6465 7220 666f 7220 6c6f 7720  encoder for low 
+0001f640: 6361 7264 696e 616c 6974 7920 7661 7273  cardinality vars
+0001f650: 2068 6572 6520 2323 2323 2323 0a20 2020   here ######.   
+0001f660: 2062 6520 3d20 656e 636f 6465 725f 6469   be = encoder_di
+0001f670: 6374 5b62 6173 6963 5f65 6e63 6f64 6572  ct[basic_encoder
+0001f680: 5d0a 2020 2020 2323 2323 2054 6865 7365  ].    #### These
+0001f690: 2061 7265 2061 7070 6c69 6564 2066 6f72   are applied for
+0001f6a0: 2068 6967 6820 6361 7264 696e 616c 6974   high cardinalit
+0001f6b0: 7920 7661 7269 6162 6c65 7320 2323 2323  y variables ####
+0001f6c0: 2323 2323 0a20 2020 206c 6520 3d20 656e  ####.    le = en
+0001f6d0: 636f 6465 725f 6469 6374 5b65 6e63 6f64  coder_dict[encod
+0001f6e0: 6572 5d0a 2020 2020 2323 2320 486f 7720  er].    ### How 
+0001f6f0: 646f 2077 6520 6d61 6b65 2073 7572 6520  do we make sure 
+0001f700: 7468 6174 2077 6520 6372 6561 7465 206f  that we create o
+0001f710: 6e65 206e 6577 204c 455f 5069 7065 2066  ne new LE_Pipe f
+0001f720: 6f72 2065 6163 6820 6361 7476 6172 3f20  or each catvar? 
+0001f730: 4865 7265 2773 206f 6e65 2077 6179 2074  Here's one way t
+0001f740: 6f20 646f 2069 742e 0a20 2020 206c 6570  o do it..    lep
+0001f750: 203d 204d 795f 4c61 6265 6c45 6e63 6f64   = My_LabelEncod
+0001f760: 6572 5f50 6970 6528 290a 2020 2020 2323  er_Pipe().    ##
+0001f770: 2323 2323 204a 7573 7420 6120 7761 726e  #### Just a warn
+0001f780: 696e 6720 696e 2063 6173 6520 736f 6d65  ing in case some
+0001f790: 6f6e 6520 646f 6573 6e27 7420 6b6e 6f77  one doesn't know
+0001f7a0: 2061 626f 7574 206f 6e65 2068 6f74 2065   about one hot e
+0001f7b0: 6e63 6f64 696e 6720 2323 2323 0a20 2020  ncoding ####.   
+0001f7c0: 2023 2323 2074 6865 7365 2065 6e63 6f64   ### these encod
+0001f7d0: 6572 7320 7265 7375 6c74 2069 6e20 6d6f  ers result in mo
+0001f7e0: 7265 2063 6f6c 756d 6e73 2074 6861 6e20  re columns than 
+0001f7f0: 7468 6520 6f72 6967 696e 616c 202d 2068  the original - h
+0001f800: 656e 6365 2074 6865 7920 6172 6520 636f  ence they are co
+0001f810: 6e73 6964 6572 6564 206f 6e65 2068 6f74  nsidered one hot
+0001f820: 2074 7970 6520 2323 230a 2020 2020 6f6e   type ###.    on
+0001f830: 6568 6f74 5f74 7970 655f 656e 636f 6465  ehot_type_encode
+0001f840: 7273 203d 205b 276f 6e65 686f 7427 2c20  rs = ['onehot', 
+0001f850: 2768 656c 6d65 7274 272c 2762 6463 272c  'helmert','bdc',
+0001f860: 2027 6264 6527 2c20 2768 6173 6869 6e67   'bde', 'hashing
+0001f870: 272c 2768 6173 6827 2c27 7375 6d27 2c27  ','hash','sum','
+0001f880: 6261 7365 272c 200a 2020 2020 2020 2020  base', .        
+0001f890: 2020 2020 2020 2020 2020 2020 2020 2020                  
+0001f8a0: 2020 2020 2020 2020 2327 7175 616e 7469          #'quanti
+0001f8b0: 6c65 272c 0a20 2020 2020 2020 2020 2020  le',.           
+0001f8c0: 2020 2020 2020 2020 2020 2020 2020 2020                  
+0001f8d0: 2020 2020 2023 2773 756d 6d61 7279 270a       #'summary'.
+0001f8e0: 2020 2020 2020 2020 2020 2020 2020 2020                  
+0001f8f0: 2020 2020 2020 2020 2020 2020 2020 2020                  
+0001f900: 5d0a 0a20 2020 2069 6620 6261 7369 635f  ]..    if basic_
+0001f910: 656e 636f 6465 7220 696e 206f 6e65 686f  encoder in oneho
+0001f920: 745f 7479 7065 5f65 6e63 6f64 6572 7320  t_type_encoders 
+0001f930: 6f72 2065 6e63 6f64 6572 2069 6e20 6f6e  or encoder in on
+0001f940: 6568 6f74 5f74 7970 655f 656e 636f 6465  ehot_type_encode
+0001f950: 7273 3a0a 2020 2020 2020 2020 6966 2076  rs:.        if v
+0001f960: 6572 626f 7365 3a0a 2020 2020 2020 2020  erbose:.        
+0001f970: 2020 2020 7072 696e 7428 2720 2020 2042      print('    B
+0001f980: 6577 6172 6521 2025 7320 656e 636f 6469  eware! %s encodi
+0001f990: 6e67 2063 616e 2063 7265 6174 6520 6875  ng can create hu
+0001f9a0: 6e64 7265 6473 2069 6620 6e6f 7420 3130  ndreds if not 10
+0001f9b0: 3030 7320 6f66 2076 6172 6961 626c 6573  00s of variables
+0001f9c0: 2e2e 2e27 2025 6261 7369 635f 656e 636f  ...' %basic_enco
+0001f9d0: 6465 7229 0a20 2020 2020 2020 2065 6c73  der).        els
+0001f9e0: 653a 0a20 2020 2020 2020 2020 2020 2070  e:.            p
+0001f9f0: 6173 730a 2020 2020 2323 2320 4e6f 7720  ass.    ### Now 
+0001fa00: 7472 7920 7468 6520 6f74 6865 7220 656e  try the other en
+0001fa10: 636f 6465 7273 2074 6861 7420 7573 6572  coders that user
+0001fa20: 2068 6173 2067 6976 656e 2061 7320 696e   has given as in
+0001fa30: 7075 7420 2323 2323 2323 2323 2323 2323  put ############
+0001fa40: 2323 2323 2323 2323 0a20 2020 2069 6620  ########.    if 
+0001fa50: 656e 636f 6465 7220 696e 205b 2768 6173  encoder in ['has
+0001fa60: 6869 6e67 272c 2768 6173 6827 5d20 6f72  hing','hash'] or
+0001fa70: 2062 6173 6963 5f65 6e63 6f64 6572 2069   basic_encoder i
+0001fa80: 6e20 5b27 6861 7368 696e 6727 2c20 2768  n ['hashing', 'h
+0001fa90: 6173 6827 5d3a 0a20 2020 2020 2020 2069  ash']:.        i
+0001faa0: 6620 7665 7262 6f73 653a 0a20 2020 2020  f verbose:.     
+0001fab0: 2020 2020 2020 2070 7269 6e74 2827 2020         print('  
+0001fac0: 2020 4265 7761 7265 2120 4861 7368 696e    Beware! Hashin
+0001fad0: 6720 656e 636f 6465 7273 2063 616e 2074  g encoders can t
+0001fae0: 616b 6520 6120 7265 616c 206c 6f6e 6720  ake a real long 
+0001faf0: 7469 6d65 2066 6f72 2065 7665 6e20 736d  time for even sm
+0001fb00: 616c 6c20 6461 7461 2073 6574 7321 2729  all data sets!')
+0001fb10: 0a20 2020 2020 2020 2065 6c73 653a 0a20  .        else:. 
+0001fb20: 2020 2020 2020 2020 2020 2070 6173 730a             pass.
+0001fb30: 2020 2020 656c 6966 2065 6e63 6f64 6572      elif encoder
+0001fb40: 2069 6e20 6e6f 6e5f 6f6e 655f 686f 745f   in non_one_hot_
+0001fb50: 6c69 7374 206f 7220 6261 7369 635f 656e  list or basic_en
+0001fb60: 636f 6465 7220 696e 206e 6f6e 5f6f 6e65  coder in non_one
+0001fb70: 5f68 6f74 5f6c 6973 743a 0a20 2020 2020  _hot_list:.     
+0001fb80: 2020 2069 6620 7665 7262 6f73 653a 0a20     if verbose:. 
+0001fb90: 2020 2020 2020 2020 2020 2070 7269 6e74             print
+0001fba0: 2827 2573 2065 6e63 6f64 6572 2073 656c  ('%s encoder sel
+0001fbb0: 6563 7465 6420 666f 7220 7472 616e 7366  ected for transf
+0001fbc0: 6f72 6d69 6e67 2061 6c6c 2063 6174 6567  orming all categ
+0001fbd0: 6f72 6963 616c 2076 6172 6961 626c 6573  orical variables
+0001fbe0: 2720 2565 6e63 6f64 6572 290a 2020 2020  ' %encoder).    
+0001fbf0: 656c 7365 3a0a 2020 2020 2020 2020 7072  else:.        pr
+0001fc00: 696e 7428 2725 7320 656e 636f 6465 7220  int('%s encoder 
+0001fc10: 6e6f 7420 666f 756e 6420 696e 206c 6973  not found in lis
+0001fc20: 7420 6f66 2065 6e63 6f64 6572 732e 2055  t of encoders. U
+0001fc30: 7369 6e67 2061 7574 6f20 696e 7374 6561  sing auto instea
+0001fc40: 6427 2025 656e 636f 6465 7229 0a20 2020  d' %encoder).   
+0001fc50: 2020 2020 2065 6e63 6f64 6572 7320 3d20       encoders = 
+0001fc60: 2761 7574 6f27 0a20 2020 2020 2020 2062  'auto'.        b
+0001fc70: 6173 6963 5f65 6e63 6f64 6572 203d 2027  asic_encoder = '
+0001fc80: 6c61 6265 6c27 0a20 2020 2020 2020 2065  label'.        e
+0001fc90: 6e63 6f64 6572 203d 2027 6c61 6265 6c27  ncoder = 'label'
+0001fca0: 0a0a 0a20 2020 2023 2323 2323 2323 2323  ...    #########
+0001fcb0: 2323 2323 2323 2323 2323 2323 2323 2323  ################
+0001fcc0: 2323 2323 2323 2323 2323 2323 2323 2323  ################
+0001fcd0: 2323 2323 2323 2323 2323 2323 2323 2323  ################
+0001fce0: 2323 2323 2323 2323 2323 2323 2323 2323  ################
+0001fcf0: 2323 2323 2323 2323 2323 2323 230a 2020  #############.  
+0001fd00: 2020 2323 2323 2020 2020 2020 2020 2020    ####          
+0001fd10: 5468 6973 2069 7320 7768 6572 6520 7765  This is where we
+0001fd20: 2063 6f6e 7665 7274 2061 6c6c 2074 6865   convert all the
+0001fd30: 2065 6e63 6f64 6572 7320 746f 2070 6970   encoders to pip
+0001fd40: 656c 696e 6520 636f 6d70 6f6e 656e 7473  eline components
+0001fd50: 2020 2020 2323 2323 0a20 2020 2023 2323      ####.    ###
+0001fd60: 2323 2323 2323 2323 2323 2323 2323 2323  ################
+0001fd70: 2323 2323 2323 2323 2323 2323 2323 2323  ################
+0001fd80: 2323 2323 2323 2323 2323 2323 2323 2323  ################
+0001fd90: 2323 2323 2323 2323 2323 2323 2323 2323  ################
+0001fda0: 2323 2323 2323 2323 2323 2323 2323 2323  ################
+0001fdb0: 2323 230a 2020 2020 6966 2076 6572 626f  ###.    if verbo
+0001fdc0: 7365 3a0a 2020 2020 2020 2020 7072 696e  se:.        prin
+0001fdd0: 7428 2755 7369 6e67 2025 7320 616e 6420  t('Using %s and 
+0001fde0: 2573 2061 7320 656e 636f 6465 7273 2720  %s as encoders' 
+0001fdf0: 2528 6265 2c6c 6529 290a 2020 2020 696d  %(be,le)).    im
+0001fe00: 705f 6d69 7373 696e 6720 3d20 5369 6d70  p_missing = Simp
+0001fe10: 6c65 496d 7075 7465 7228 7374 7261 7465  leImputer(strate
+0001fe20: 6779 3d27 636f 6e73 7461 6e74 272c 2066  gy='constant', f
+0001fe30: 696c 6c5f 7661 6c75 653d 276d 6973 7369  ill_value='missi
+0001fe40: 6e67 2729 0a20 2020 2069 6d70 203d 2053  ng').    imp = S
+0001fe50: 696d 706c 6549 6d70 7574 6572 2873 7472  impleImputer(str
+0001fe60: 6174 6567 793d 2763 6f6e 7374 616e 7427  ategy='constant'
+0001fe70: 2c66 696c 6c5f 7661 6c75 653d 2d39 3929  ,fill_value=-99)
+0001fe80: 0a20 2020 2063 6f6e 7665 7274 5f63 655f  .    convert_ce_
+0001fe90: 746f 5f70 6970 655f 6675 6e63 203d 2046  to_pipe_func = F
+0001fea0: 756e 6374 696f 6e54 7261 6e73 666f 726d  unctionTransform
+0001feb0: 6572 2863 6f6e 7665 7274 5f63 655f 746f  er(convert_ce_to
+0001fec0: 5f70 6970 6529 0a20 2020 2072 6363 203d  _pipe).    rcc =
+0001fed0: 2052 6172 655f 436c 6173 735f 436f 6d62   Rare_Class_Comb
+0001fee0: 696e 6572 5f50 6970 6528 290a 2020 2020  iner_Pipe().    
+0001fef0: 6966 2063 6f6d 6269 6e65 5f72 6172 655f  if combine_rare_
+0001ff00: 666c 6167 3a0a 2020 2020 2020 2020 7072  flag:.        pr
+0001ff10: 696e 7428 2720 2020 2063 6f6d 6269 6e69  int('    combini
+0001ff20: 6e67 2072 6172 6520 636c 6173 7365 7320  ng rare classes 
+0001ff30: 666f 7220 6361 7465 676f 7269 6361 6c20  for categorical 
+0001ff40: 616e 6420 6469 7363 7265 7465 2076 6172  and discrete var
+0001ff50: 7320 6173 2067 6976 656e 2e2e 2e27 290a  s as given...').
+0001ff60: 0a20 2020 2023 2323 2320 6c65 705f 6f6e  .    #### lep_on
+0001ff70: 6520 6973 2074 6865 2062 6173 6963 2065  e is the basic e
+0001ff80: 6e63 6f64 6572 206f 6620 6361 7420 7661  ncoder of cat va
+0001ff90: 7269 6162 6c65 7320 2323 2323 2323 2323  riables ########
+0001ffa0: 2323 2323 0a20 2020 2069 6620 6261 7369  ####.    if basi
+0001ffb0: 635f 656e 636f 6465 7220 3d3d 2027 6c61  c_encoder == 'la
+0001ffc0: 6265 6c27 3a0a 2020 2020 2020 2020 2323  bel':.        ##
+0001ffd0: 2323 2323 2020 4372 6561 7465 2061 2066  ####  Create a f
+0001ffe0: 756e 6374 696f 6e20 6361 6c6c 6564 2064  unction called d
+0001fff0: 726f 705f 7365 636f 6e64 5f63 6f6c 2074  rop_second_col t
+00020000: 6861 7420 6472 6f70 7320 7468 6520 7365  hat drops the se
+00020010: 636f 6e64 2075 6e6e 6563 6573 7361 7279  cond unnecessary
+00020020: 2063 6f6c 756d 6e20 696e 204d 795f 4c61   column in My_La
+00020030: 6265 6c5f 456e 636f 6465 720a 2020 2020  bel_Encoder.    
+00020040: 2020 2020 6472 6f70 5f73 6563 6f6e 645f      drop_second_
+00020050: 636f 6c5f 6675 6e63 203d 2046 756e 6374  col_func = Funct
+00020060: 696f 6e54 7261 6e73 666f 726d 6572 2864  ionTransformer(d
+00020070: 726f 705f 7365 636f 6e64 5f63 6f6c 290a  rop_second_col).
+00020080: 2020 2020 2020 2020 2323 2323 204e 6f77          #### Now
+00020090: 2063 6f6d 6269 6e65 2069 7420 7769 7468   combine it with
+000200a0: 2074 6865 204c 6162 656c 456e 636f 6465   the LabelEncode
+000200b0: 7220 746f 206d 616b 6520 6974 2072 756e  r to make it run
+000200c0: 2073 6d6f 6f74 686c 7920 696e 2061 2050   smoothly in a P
+000200d0: 6970 6520 2323 0a20 2020 2020 2020 2069  ipe ##.        i
+000200e0: 6620 636f 6d62 696e 655f 7261 7265 5f66  f combine_rare_f
+000200f0: 6c61 673a 0a20 2020 2020 2020 2020 2020  lag:.           
+00020100: 2023 2323 206c 6570 5f6f 6e65 2075 7365   ### lep_one use
+00020110: 7320 7261 7265 5f63 6c61 7373 5f63 6f6d  s rare_class_com
+00020120: 6269 6e65 7220 7769 7468 204d 795f 4c61  biner with My_La
+00020130: 6265 6c45 6e63 6f64 6572 2074 6f20 6669  belEncoder to fi
+00020140: 7273 7420 6c61 6265 6c20 656e 636f 6465  rst label encode
+00020150: 2061 6e64 2074 6865 6e20 6472 6f70 2074   and then drop t
+00020160: 6865 2073 6563 6f6e 6420 756e 7573 6564  he second unused
+00020170: 2063 6f6c 756d 6e20 2323 0a20 2020 2020   column ##.     
+00020180: 2020 2020 2020 206c 6570 5f6f 6e65 203d         lep_one =
+00020190: 2050 6970 656c 696e 6528 5b28 2772 6172   Pipeline([('rar
+000201a0: 655f 636c 6173 735f 636f 6d62 696e 6572  e_class_combiner
+000201b0: 272c 2072 6363 292c 2028 2762 6173 6963  ', rcc), ('basic
+000201c0: 5f65 6e63 6f64 6572 272c 206c 6570 292c  _encoder', lep),
+000201d0: 2028 2764 726f 705f 7365 636f 6e64 5f63   ('drop_second_c
+000201e0: 6f6c 756d 6e27 2c20 6472 6f70 5f73 6563  olumn', drop_sec
+000201f0: 6f6e 645f 636f 6c5f 6675 6e63 295d 290a  ond_col_func)]).
+00020200: 2020 2020 2020 2020 656c 7365 3a0a 2020          else:.  
+00020210: 2020 2020 2020 2020 2020 2323 2320 6c65            ### le
+00020220: 705f 6f6e 6520 7573 6573 204d 795f 4c61  p_one uses My_La
+00020230: 6265 6c45 6e63 6f64 6572 2074 6f20 6669  belEncoder to fi
+00020240: 7273 7420 6c61 6265 6c20 656e 636f 6465  rst label encode
+00020250: 2061 6e64 2074 6865 6e20 6472 6f70 2074   and then drop t
+00020260: 6865 2073 6563 6f6e 6420 756e 7573 6564  he second unused
+00020270: 2063 6f6c 756d 6e20 2323 0a20 2020 2020   column ##.     
+00020280: 2020 2020 2020 206c 6570 5f6f 6e65 203d         lep_one =
+00020290: 2050 6970 656c 696e 6528 5b28 2762 6173   Pipeline([('bas
+000202a0: 6963 5f65 6e63 6f64 6572 272c 206c 6570  ic_encoder', lep
+000202b0: 292c 2028 2764 726f 705f 7365 636f 6e64  ), ('drop_second
+000202c0: 5f63 6f6c 756d 6e27 2c20 6472 6f70 5f73  _column', drop_s
+000202d0: 6563 6f6e 645f 636f 6c5f 6675 6e63 295d  econd_col_func)]
+000202e0: 290a 2020 2020 656c 7365 3a0a 2020 2020  ).    else:.    
+000202f0: 2020 2020 6966 2063 6f6d 6269 6e65 5f72      if combine_r
+00020300: 6172 655f 666c 6167 3a0a 2020 2020 2020  are_flag:.      
+00020310: 2020 2020 2020 6c65 705f 6f6e 6520 3d20        lep_one = 
+00020320: 5069 7065 6c69 6e65 285b 2827 7261 7265  Pipeline([('rare
+00020330: 5f63 6c61 7373 5f63 6f6d 6269 6e65 7227  _class_combiner'
+00020340: 2c20 7263 6329 2c28 2763 6f6e 7665 7274  , rcc),('convert
+00020350: 5f43 455f 746f 5f70 6970 6527 2c20 636f  _CE_to_pipe', co
+00020360: 6e76 6572 745f 6365 5f74 6f5f 7069 7065  nvert_ce_to_pipe
+00020370: 5f66 756e 6329 2c20 2827 6261 7369 635f  _func), ('basic_
+00020380: 656e 636f 6465 7227 2c20 6265 295d 290a  encoder', be)]).
+00020390: 2020 2020 2020 2020 656c 7365 3a0a 2020          else:.  
+000203a0: 2020 2020 2020 2020 2020 6c65 705f 6f6e            lep_on
+000203b0: 6520 3d20 5069 7065 6c69 6e65 285b 2827  e = Pipeline([('
+000203c0: 636f 6e76 6572 745f 4345 5f74 6f5f 7069  convert_CE_to_pi
+000203d0: 7065 272c 2063 6f6e 7665 7274 5f63 655f  pe', convert_ce_
+000203e0: 746f 5f70 6970 655f 6675 6e63 292c 2028  to_pipe_func), (
+000203f0: 2762 6173 6963 5f65 6e63 6f64 6572 272c  'basic_encoder',
+00020400: 2062 6529 5d29 0a20 2020 2023 2323 2320   be)]).    #### 
+00020410: 6c65 705f 7477 6f20 6163 7473 2061 7320  lep_two acts as 
+00020420: 7468 6520 6d61 6a6f 7220 656e 636f 6465  the major encode
+00020430: 7220 6f66 2064 6973 6372 6574 6520 7374  r of discrete st
+00020440: 7269 6e67 2076 6172 6961 626c 6573 2023  ring variables #
+00020450: 2323 2323 2323 2323 2323 230a 2020 2020  ###########.    
+00020460: 6966 2065 6e63 6f64 6572 203d 3d20 276c  if encoder == 'l
+00020470: 6162 656c 273a 0a20 2020 2020 2020 2023  abel':.        #
+00020480: 2323 2323 2320 2043 7265 6174 6520 6120  #####  Create a 
+00020490: 6675 6e63 7469 6f6e 2063 616c 6c65 6420  function called 
+000204a0: 6472 6f70 5f73 6563 6f6e 645f 636f 6c20  drop_second_col 
+000204b0: 7468 6174 2064 726f 7073 2074 6865 2073  that drops the s
+000204c0: 6563 6f6e 6420 756e 6e65 6365 7373 6172  econd unnecessar
+000204d0: 7920 636f 6c75 6d6e 2069 6e20 4d79 5f4c  y column in My_L
+000204e0: 6162 656c 5f45 6e63 6f64 6572 0a20 2020  abel_Encoder.   
+000204f0: 2020 2020 2064 726f 705f 7365 636f 6e64       drop_second
+00020500: 5f63 6f6c 5f66 756e 6320 3d20 4675 6e63  _col_func = Func
+00020510: 7469 6f6e 5472 616e 7366 6f72 6d65 7228  tionTransformer(
+00020520: 6472 6f70 5f73 6563 6f6e 645f 636f 6c29  drop_second_col)
+00020530: 0a20 2020 2020 2020 2023 2323 2320 4e6f  .        #### No
+00020540: 7720 636f 6d62 696e 6520 6974 2077 6974  w combine it wit
+00020550: 6820 7468 6520 4c61 6265 6c45 6e63 6f64  h the LabelEncod
+00020560: 6572 2074 6f20 6d61 6b65 2069 7420 7275  er to make it ru
+00020570: 6e20 736d 6f6f 7468 6c79 2069 6e20 6120  n smoothly in a 
+00020580: 5069 7065 2023 230a 2020 2020 2020 2020  Pipe ##.        
+00020590: 6966 2063 6f6d 6269 6e65 5f72 6172 655f  if combine_rare_
+000205a0: 666c 6167 3a0a 2020 2020 2020 2020 2020  flag:.          
+000205b0: 2020 2323 2320 6c65 705f 6f6e 6520 7573    ### lep_one us
+000205c0: 6573 2072 6172 655f 636c 6173 735f 636f  es rare_class_co
+000205d0: 6d62 696e 6572 204d 795f 4c61 6265 6c45  mbiner My_LabelE
+000205e0: 6e63 6f64 6572 2074 6f20 6669 7273 7420  ncoder to first 
+000205f0: 6c61 6265 6c20 656e 636f 6465 2061 6e64  label encode and
+00020600: 2074 6865 6e20 6472 6f70 2074 6865 2073   then drop the s
+00020610: 6563 6f6e 6420 756e 7573 6564 2063 6f6c  econd unused col
+00020620: 756d 6e20 2323 0a20 2020 2020 2020 2020  umn ##.         
+00020630: 2020 206c 6570 5f74 776f 203d 2050 6970     lep_two = Pip
+00020640: 656c 696e 6528 5b28 2772 6172 655f 636c  eline([('rare_cl
+00020650: 6173 735f 636f 6d62 696e 6572 272c 2072  ass_combiner', r
+00020660: 6363 292c 2028 2762 6173 6963 5f65 6e63  cc), ('basic_enc
+00020670: 6f64 6572 272c 206c 6570 292c 2028 2764  oder', lep), ('d
+00020680: 726f 705f 7365 636f 6e64 5f63 6f6c 756d  rop_second_colum
+00020690: 6e27 2c20 6472 6f70 5f73 6563 6f6e 645f  n', drop_second_
+000206a0: 636f 6c5f 6675 6e63 295d 290a 2020 2020  col_func)]).    
+000206b0: 2020 2020 656c 7365 3a0a 2020 2020 2020      else:.      
+000206c0: 2020 2020 2020 2323 2320 6c65 705f 6f6e        ### lep_on
+000206d0: 6520 7573 6573 204d 795f 4c61 6265 6c45  e uses My_LabelE
+000206e0: 6e63 6f64 6572 2074 6f20 6669 7273 7420  ncoder to first 
+000206f0: 6c61 6265 6c20 656e 636f 6465 2061 6e64  label encode and
+00020700: 2074 6865 6e20 6472 6f70 2074 6865 2073   then drop the s
+00020710: 6563 6f6e 6420 756e 7573 6564 2063 6f6c  econd unused col
+00020720: 756d 6e20 2323 0a20 2020 2020 2020 2020  umn ##.         
+00020730: 2020 206c 6570 5f74 776f 203d 2050 6970     lep_two = Pip
+00020740: 656c 696e 6528 5b28 2762 6173 6963 5f65  eline([('basic_e
+00020750: 6e63 6f64 6572 272c 206c 6570 292c 2028  ncoder', lep), (
+00020760: 2764 726f 705f 7365 636f 6e64 5f63 6f6c  'drop_second_col
+00020770: 756d 6e27 2c20 6472 6f70 5f73 6563 6f6e  umn', drop_secon
+00020780: 645f 636f 6c5f 6675 6e63 295d 290a 2020  d_col_func)]).  
+00020790: 2020 656c 7365 3a0a 2020 2020 2020 2020    else:.        
+000207a0: 236c 6570 5f74 776f 203d 206d 616b 655f  #lep_two = make_
+000207b0: 7069 7065 6c69 6e65 2863 6f6e 7665 7274  pipeline(convert
+000207c0: 5f63 655f 746f 5f70 6970 655f 6675 6e63  _ce_to_pipe_func
+000207d0: 2c20 6c65 290a 2020 2020 2020 2020 6966  , le).        if
+000207e0: 2063 6f6d 6269 6e65 5f72 6172 655f 666c   combine_rare_fl
+000207f0: 6167 3a0a 2020 2020 2020 2020 2020 2020  ag:.            
+00020800: 6c65 705f 7477 6f20 3d20 5069 7065 6c69  lep_two = Pipeli
+00020810: 6e65 285b 2827 7261 7265 5f63 6c61 7373  ne([('rare_class
+00020820: 5f63 6f6d 6269 6e65 7227 2c20 7263 6329  _combiner', rcc)
+00020830: 2c20 2827 636f 6e76 6572 745f 4345 5f74  , ('convert_CE_t
+00020840: 6f5f 7069 7065 272c 2063 6f6e 7665 7274  o_pipe', convert
+00020850: 5f63 655f 746f 5f70 6970 655f 6675 6e63  _ce_to_pipe_func
+00020860: 292c 2028 2762 6173 6963 5f65 6e63 6f64  ), ('basic_encod
+00020870: 6572 272c 206c 6529 5d29 0a20 2020 2020  er', le)]).     
+00020880: 2020 2065 6c73 653a 0a20 2020 2020 2020     else:.       
+00020890: 2020 2020 206c 6570 5f74 776f 203d 2050       lep_two = P
+000208a0: 6970 656c 696e 6528 5b28 2763 6f6e 7665  ipeline([('conve
+000208b0: 7274 5f43 455f 746f 5f70 6970 6527 2c20  rt_CE_to_pipe', 
+000208c0: 636f 6e76 6572 745f 6365 5f74 6f5f 7069  convert_ce_to_pi
+000208d0: 7065 5f66 756e 6329 2c20 2827 6261 7369  pe_func), ('basi
+000208e0: 635f 656e 636f 6465 7227 2c20 6c65 295d  c_encoder', le)]
+000208f0: 290a 2020 2020 2323 2323 2323 2323 2323  ).    ##########
+00020900: 2323 2323 2323 2323 2323 2323 2323 2323  ################
+00020910: 2323 2323 2323 2323 2323 2323 2323 2323  ################
+00020920: 2323 2323 2323 2323 2323 2323 2323 2323  ################
+00020930: 2323 2323 2323 2323 2323 2323 2323 2323  ################
+00020940: 2323 2323 2323 2323 2323 0a20 2020 2023  ##########.    #
+00020950: 2043 5245 4154 4520 6f6e 655f 6469 6d20   CREATE one_dim 
+00020960: 5452 414e 5346 4f52 4d45 5220 696e 206f  TRANSFORMER in o
+00020970: 7264 6572 2074 6f20 6669 7420 6265 7477  rder to fit betw
+00020980: 6565 6e20 696d 7075 7465 7220 616e 6420  een imputer and 
+00020990: 5446 6944 4620 666f 7220 4e4c 5020 6865  TFiDF for NLP he
+000209a0: 7265 2023 2323 0a20 2020 2023 2323 2323  re ###.    #####
+000209b0: 2323 2323 2323 2323 2323 2323 2323 2323  ################
+000209c0: 2323 2323 2323 2323 2323 2323 2323 2323  ################
+000209d0: 2323 2323 2323 2323 2323 2323 2323 2323  ################
+000209e0: 2323 2323 2323 2323 2323 2323 2323 2323  ################
+000209f0: 2323 2323 2323 2323 2323 2323 2323 230a  ###############.
+00020a00: 2020 2020 6f6e 655f 6469 6d20 3d20 4d61      one_dim = Ma
+00020a10: 6b65 3244 2869 6d70 5f6d 6973 7369 6e67  ke2D(imp_missing
+00020a20: 290a 2020 2020 7265 6d6f 7665 5f73 7065  ).    remove_spe
+00020a30: 6369 616c 5f63 6861 7273 203d 2020 6c61  cial_chars =  la
+00020a40: 6d62 6461 2078 3a72 652e 7375 6228 275b  mbda x:re.sub('[
+00020a50: 5e41 2d5a 612d 7a30 2d39 5f5d 2b27 2c20  ^A-Za-z0-9_]+', 
+00020a60: 2720 272c 2078 290a 2020 2020 636f 6c73  ' ', x).    cols
+00020a70: 697a 655f 6469 6374 203d 207b 7d0a 2020  ize_dict = {}.  
+00020a80: 2020 2323 206e 756d 6265 7220 6f66 2063    ## number of c
+00020a90: 6f6d 706f 6e65 6e74 7320 696e 2053 5644  omponents in SVD
+00020aa0: 2023 2323 230a 2020 2020 6966 206c 656e   ####.    if len
+00020ab0: 286e 6c70 7661 7273 2920 3e20 303a 0a20  (nlpvars) > 0:. 
+00020ac0: 2020 2020 2020 2063 6f70 795f 6e6c 7073         copy_nlps
+00020ad0: 203d 2063 6f70 792e 6465 6570 636f 7079   = copy.deepcopy
+00020ae0: 286e 6c70 7661 7273 290a 2020 2020 2020  (nlpvars).      
+00020af0: 2020 6e75 6e69 7175 6573 203d 205b 5d0a    nuniques = [].
+00020b00: 2020 2020 2020 2020 666f 7220 6561 6368          for each
+00020b10: 5f6e 6c70 2069 6e20 636f 7079 5f6e 6c70  _nlp in copy_nlp
+00020b20: 733a 0a20 2020 2020 2020 2020 2020 206e  s:.            n
+00020b30: 756e 6971 7565 732e 6170 7065 6e64 2869  uniques.append(i
+00020b40: 6e74 286d 6178 2832 2c20 332a 6e70 2e6c  nt(max(2, 3*np.l
+00020b50: 6f67 3228 585f 7472 6169 6e5b 6561 6368  og2(X_train[each
+00020b60: 5f6e 6c70 5d2e 6e75 6e69 7175 6528 2929  _nlp].nunique())
+00020b70: 2929 290a 2020 2020 2020 2020 2323 2323  ))).        ####
+00020b80: 2066 696e 6420 7468 6520 6d69 6e20 616e   find the min an
+00020b90: 6420 7365 7420 7468 6520 5446 4944 4620  d set the TFIDF 
+00020ba0: 666f 7220 7468 6174 2073 6d61 6c6c 6573  for that smalles
+00020bb0: 7420 4e4c 5020 7661 7269 6162 6c65 2023  t NLP variable #
+00020bc0: 2323 2323 2323 2320 2020 2020 2020 2020  #######         
+00020bd0: 2020 200a 2020 2020 2020 2020 746f 705f     .        top_
+00020be0: 6e20 3d20 6e70 2e6d 696e 286e 756e 6971  n = np.min(nuniq
+00020bf0: 7565 7329 0a20 2020 2020 2020 2074 6f70  ues).        top
+00020c00: 5f6e 203d 2069 6e74 286d 696e 2833 302c  _n = int(min(30,
+00020c10: 2074 6f70 5f6e 2a30 2e31 2929 0a20 2020   top_n*0.1)).   
+00020c20: 2020 2020 2073 7664 5f6e 5f69 7465 7220       svd_n_iter 
+00020c30: 3d20 696e 7428 6d69 6e28 3130 2c20 746f  = int(min(10, to
+00020c40: 705f 6e2a 302e 3129 290a 2020 2020 2020  p_n*0.1)).      
+00020c50: 2020 6966 2076 6572 626f 7365 3a0a 2020    if verbose:.  
+00020c60: 2020 2020 2020 2020 2020 7072 696e 7428            print(
+00020c70: 2720 2020 2025 6420 636f 6d70 6f6e 656e  '    %d componen
+00020c80: 7473 2063 686f 7365 6e20 666f 7220 5472  ts chosen for Tr
+00020c90: 756e 6361 7465 6453 5644 286e 5f69 7465  uncatedSVD(n_ite
+00020ca0: 723d 2564 2920 6166 7465 7220 5446 4944  r=%d) after TFID
+00020cb0: 4627 2025 2874 6f70 5f6e 2c20 7376 645f  F' %(top_n, svd_
+00020cc0: 6e5f 6974 6572 2929 0a20 2020 2020 2020  n_iter)).       
+00020cd0: 2023 2323 2323 2323 2323 2323 2323 2020   #############  
+00020ce0: 2054 6869 7320 6973 2077 6865 7265 2077   This is where w
+00020cf0: 6520 7365 7420 6465 6661 756c 7473 2066  e set defaults f
+00020d00: 6f72 204e 4c50 2074 7261 6e73 666f 726d  or NLP transform
+00020d10: 6572 7320 2323 2323 2323 2323 2323 0a20  ers ##########. 
+00020d20: 2020 2020 2020 2069 6620 585f 7472 6169         if X_trai
+00020d30: 6e2e 7368 6170 655b 305d 203e 3d20 3130  n.shape[0] >= 10
+00020d40: 3030 3030 3a0a 2020 2020 2020 2020 2020  0000:.          
+00020d50: 2020 7469 6666 6420 3d20 5466 6964 6656    tiffd = TfidfV
+00020d60: 6563 746f 7269 7a65 7228 7374 7269 705f  ectorizer(strip_
+00020d70: 6163 6365 6e74 733d 2775 6e69 636f 6465  accents='unicode
+00020d80: 272c 6d61 785f 6665 6174 7572 6573 3d36  ',max_features=6
+00020d90: 3030 302c 2070 7265 7072 6f63 6573 736f  000, preprocesso
+00020da0: 723d 7265 6d6f 7665 5f73 7065 6369 616c  r=remove_special
+00020db0: 5f63 6861 7273 290a 2020 2020 2020 2020  _chars).        
+00020dc0: 656c 6966 2058 5f74 7261 696e 2e73 6861  elif X_train.sha
+00020dd0: 7065 5b30 5d20 3e3d 2031 3030 3030 3a0a  pe[0] >= 10000:.
+00020de0: 2020 2020 2020 2020 2020 2020 2374 6966              #tif
+00020df0: 6664 203d 2043 6f75 6e74 5665 6374 6f72  fd = CountVector
+00020e00: 697a 6572 2873 7472 6970 5f61 6363 656e  izer(strip_accen
+00020e10: 7473 3d27 756e 6963 6f64 6527 2c6d 6178  ts='unicode',max
+00020e20: 5f66 6561 7475 7265 733d 3130 3030 290a  _features=1000).
+00020e30: 2020 2020 2020 2020 2020 2020 7469 6666              tiff
+00020e40: 6420 3d20 5466 6964 6656 6563 746f 7269  d = TfidfVectori
+00020e50: 7a65 7228 7374 7269 705f 6163 6365 6e74  zer(strip_accent
+00020e60: 733d 2775 6e69 636f 6465 272c 6d61 785f  s='unicode',max_
+00020e70: 6665 6174 7572 6573 3d33 3030 302c 2070  features=3000, p
+00020e80: 7265 7072 6f63 6573 736f 723d 7265 6d6f  reprocessor=remo
+00020e90: 7665 5f73 7065 6369 616c 5f63 6861 7273  ve_special_chars
+00020ea0: 290a 2020 2020 2020 2020 2020 2020 2374  ).            #t
+00020eb0: 6966 6664 203d 204d 7954 6966 6628 7374  iffd = MyTiff(st
+00020ec0: 7269 705f 6163 6365 6e74 733d 2775 6e69  rip_accents='uni
+00020ed0: 636f 6465 272c 6d61 785f 6665 6174 7572  code',max_featur
+00020ee0: 6573 3d33 3030 2c20 6d69 6e5f 6466 3d30  es=300, min_df=0
+00020ef0: 2e30 3129 0a20 2020 2020 2020 2065 6c73  .01).        els
+00020f00: 653a 0a20 2020 2020 2020 2020 2020 2023  e:.            #
+00020f10: 7665 6374 203d 2043 6f75 6e74 5665 6374  vect = CountVect
+00020f20: 6f72 697a 6572 2873 7472 6970 5f61 6363  orizer(strip_acc
+00020f30: 656e 7473 3d27 756e 6963 6f64 6527 2c6d  ents='unicode',m
+00020f40: 6178 5f66 6561 7475 7265 733d 3130 3029  ax_features=100)
+00020f50: 0a20 2020 2020 2020 2020 2020 2074 6966  .            tif
+00020f60: 6664 203d 2054 6669 6466 5665 6374 6f72  fd = TfidfVector
+00020f70: 697a 6572 2873 7472 6970 5f61 6363 656e  izer(strip_accen
+00020f80: 7473 3d27 756e 6963 6f64 6527 2c6d 6178  ts='unicode',max
+00020f90: 5f66 6561 7475 7265 733d 3130 3030 2c20  _features=1000, 
+00020fa0: 7072 6570 726f 6365 7373 6f72 3d72 656d  preprocessor=rem
+00020fb0: 6f76 655f 7370 6563 6961 6c5f 6368 6172  ove_special_char
+00020fc0: 7329 0a20 2020 2020 2020 2020 2020 2023  s).            #
+00020fd0: 7469 6666 6420 3d20 4d79 5469 6666 2873  tiffd = MyTiff(s
+00020fe0: 7472 6970 5f61 6363 656e 7473 3d27 756e  trip_accents='un
+00020ff0: 6963 6f64 6527 2c6d 6178 5f66 6561 7475  icode',max_featu
+00021000: 7265 733d 3330 302c 206d 696e 5f64 663d  res=300, min_df=
+00021010: 302e 3031 290a 2020 2020 2020 2020 2323  0.01).        ##
+00021020: 2320 6372 6561 7465 2061 206e 6577 2070  # create a new p
+00021030: 6970 656c 696e 6520 7769 7468 2066 696c  ipeline with fil
+00021040: 6c69 6e67 2077 6974 6820 636f 6e73 7461  ling with consta
+00021050: 6e74 206d 6973 7369 6e67 2023 230a 2020  nt missing ##.  
+00021060: 2020 2020 2020 7473 7664 203d 2054 7275        tsvd = Tru
+00021070: 6e63 6174 6564 5356 4428 6e5f 636f 6d70  ncatedSVD(n_comp
+00021080: 6f6e 656e 7473 3d74 6f70 5f6e 2c20 6e5f  onents=top_n, n_
+00021090: 6974 6572 3d73 7664 5f6e 5f69 7465 722c  iter=svd_n_iter,
+000210a0: 2072 616e 646f 6d5f 7374 6174 653d 3329   random_state=3)
+000210b0: 0a20 2020 2020 2020 2076 6563 7420 3d20  .        vect = 
+000210c0: 5069 7065 6c69 6e65 285b 2827 6d61 6b65  Pipeline([('make
+000210d0: 5f6f 6e65 5f64 696d 272c 206f 6e65 5f64  _one_dim', one_d
+000210e0: 696d 292c 2028 276d 616b 655f 7466 6964  im), ('make_tfid
+000210f0: 665f 7069 7065 6c69 6e65 272c 2074 6966  f_pipeline', tif
+00021100: 6664 292c 2028 2774 7275 6e63 6174 6564  fd), ('truncated
+00021110: 5f73 7664 272c 2074 7376 6429 5d29 0a20  _svd', tsvd)]). 
+00021120: 2020 2020 2020 2023 7665 6374 203d 206d         #vect = m
+00021130: 616b 655f 7069 7065 6c69 6e65 286f 6e65  ake_pipeline(one
+00021140: 5f64 696d 2c20 7469 6666 642c 2074 7376  _dim, tiffd, tsv
+00021150: 6429 0a20 2020 2020 2020 2023 2323 2053  d).        ### S
+00021160: 696d 696c 6172 6c79 2079 6f75 206e 6565  imilarly you nee
+00021170: 6420 746f 2063 7265 6174 6520 6120 6675  d to create a fu
+00021180: 6e63 7469 6f6e 2074 6861 7420 636f 6e76  nction that conv
+00021190: 6572 7473 2061 6c6c 204e 4c50 2063 6f6c  erts all NLP col
+000211a0: 756d 6e73 2074 6f20 7374 7269 6e67 2062  umns to string b
+000211b0: 6566 6f72 6520 6665 6564 696e 6720 746f  efore feeding to
+000211c0: 2043 6f75 6e74 5665 6374 6f72 697a 6572   CountVectorizer
+000211d0: 0a20 2020 2020 2020 2063 6861 6e67 655f  .        change_
+000211e0: 636f 6c5f 746f 5f73 7472 696e 675f 6675  col_to_string_fu
+000211f0: 6e63 203d 2046 756e 6374 696f 6e54 7261  nc = FunctionTra
+00021200: 6e73 666f 726d 6572 2863 6861 6e67 655f  nsformer(change_
+00021210: 636f 6c5f 746f 5f73 7472 696e 6729 0a20  col_to_string). 
+00021220: 2020 2020 2020 2023 2323 2077 6520 7472         ### we tr
+00021230: 7920 746f 2066 696e 6420 7468 6520 636f  y to find the co
+00021240: 6c75 6d6e 7320 6372 6561 7465 6420 6279  lumns created by
+00021250: 2063 6f75 6e74 7476 6563 746f 7269 7a65   counttvectorize
+00021260: 7220 2323 230a 2020 2020 2020 2020 636f  r ###.        co
+00021270: 7079 5f6e 6c70 5f76 6172 7320 3d20 636f  py_nlp_vars = co
+00021280: 7079 2e64 6565 7063 6f70 7928 6e6c 7076  py.deepcopy(nlpv
+00021290: 6172 7329 0a20 2020 2020 2020 2066 6f72  ars).        for
+000212a0: 2065 6163 685f 6e6c 7020 696e 2063 6f70   each_nlp in cop
+000212b0: 795f 6e6c 705f 7661 7273 3a0a 2020 2020  y_nlp_vars:.    
+000212c0: 2020 2020 2020 2020 636f 6c73 697a 6520          colsize 
+000212d0: 3d20 7665 6374 2e66 6974 5f74 7261 6e73  = vect.fit_trans
+000212e0: 666f 726d 2858 5f74 7261 696e 5b65 6163  form(X_train[eac
+000212f0: 685f 6e6c 705d 292e 7368 6170 655b 315d  h_nlp]).shape[1]
+00021300: 0a20 2020 2020 2020 2020 2020 2063 6f6c  .            col
+00021310: 7369 7a65 5f64 6963 745b 6561 6368 5f6e  size_dict[each_n
+00021320: 6c70 5d20 3d20 636f 6c73 697a 650a 2020  lp] = colsize.  
+00021330: 2020 2020 2020 2323 2323 2320 7765 2063        ##### we c
+00021340: 6f6c 6c65 6374 2074 6865 2063 6f6c 756d  ollect the colum
+00021350: 6e20 7369 7a65 206f 6620 6561 6368 206e  n size of each n
+00021360: 6c70 2076 6172 6961 626c 6520 616e 6420  lp variable and 
+00021370: 6665 6564 2069 7420 746f 2076 6563 745f  feed it to vect_
+00021380: 6f6e 6520 2323 0a20 2020 2020 2020 2023  one ##.        #
+00021390: 7665 6374 5f6f 6e65 203d 206d 616b 655f  vect_one = make_
+000213a0: 7069 7065 6c69 6e65 2863 6861 6e67 655f  pipeline(change_
+000213b0: 636f 6c5f 746f 5f73 7472 696e 675f 6675  col_to_string_fu
+000213c0: 6e63 2c20 7665 6374 290a 2020 2020 2020  nc, vect).      
+000213d0: 2020 7665 6374 5f6f 6e65 203d 2050 6970    vect_one = Pip
+000213e0: 656c 696e 6528 5b28 2763 6861 6e67 655f  eline([('change_
+000213f0: 636f 6c5f 746f 5f73 7472 696e 6727 2c20  col_to_string', 
+00021400: 6368 616e 6765 5f63 6f6c 5f74 6f5f 7374  change_col_to_st
+00021410: 7269 6e67 5f66 756e 6329 2c20 2827 7466  ring_func), ('tf
+00021420: 6964 665f 7473 7664 5f70 6970 656c 696e  idf_tsvd_pipelin
+00021430: 6527 2c20 7665 6374 295d 290a 2020 2020  e', vect)]).    
+00021440: 2323 2323 204e 6f77 2063 7265 6174 6520  #### Now create 
+00021450: 6120 6675 6e63 7469 6f6e 2074 6861 7420  a function that 
+00021460: 6372 6561 7465 7320 7469 6d65 2073 6572  creates time ser
+00021470: 6965 7320 6665 6174 7572 6573 2023 2323  ies features ###
+00021480: 2323 2323 2323 0a20 2020 2063 7265 6174  ######.    creat
+00021490: 655f 7473 5f66 6561 7475 7265 735f 6675  e_ts_features_fu
+000214a0: 6e63 203d 2046 756e 6374 696f 6e54 7261  nc = FunctionTra
+000214b0: 6e73 666f 726d 6572 285f 6372 6561 7465  nsformer(_create
+000214c0: 5f74 735f 6665 6174 7572 6573 290a 2020  _ts_features).  
+000214d0: 2020 2323 2323 2077 6520 6e65 6564 2074    #### we need t
+000214e0: 6f20 7468 6520 7361 6d65 2066 6f72 2064  o the same for d
+000214f0: 6174 652d 7661 7273 2023 2323 2323 2323  ate-vars #######
+00021500: 2323 0a20 2020 2063 6f70 795f 6461 7465  ##.    copy_date
+00021510: 5f76 6172 7320 3d20 636f 7079 2e64 6565  _vars = copy.dee
+00021520: 7063 6f70 7928 6461 7465 7661 7273 290a  pcopy(datevars).
+00021530: 2020 2020 6461 7465 7369 7a65 5f64 6963      datesize_dic
+00021540: 7420 3d20 7b7d 0a20 2020 2066 6f72 2065  t = {}.    for e
+00021550: 6163 685f 6461 7465 636f 6c20 696e 2063  ach_datecol in c
+00021560: 6f70 795f 6461 7465 5f76 6172 733a 0a20  opy_date_vars:. 
+00021570: 2020 2020 2020 2064 7478 203d 2063 7265         dtx = cre
+00021580: 6174 655f 7473 5f66 6561 7475 7265 735f  ate_ts_features_
+00021590: 6675 6e63 2e66 6974 5f74 7261 6e73 666f  func.fit_transfo
+000215a0: 726d 2858 5f74 7261 696e 5b65 6163 685f  rm(X_train[each_
+000215b0: 6461 7465 636f 6c5d 290a 2020 2020 2020  datecol]).      
+000215c0: 2020 6461 7465 7369 7a65 5f64 6963 745b    datesize_dict[
+000215d0: 6561 6368 5f64 6174 6563 6f6c 5d20 3d20  each_datecol] = 
+000215e0: 6474 782e 636f 6c75 6d6e 732e 746f 6c69  dtx.columns.toli
+000215f0: 7374 2829 0a20 2020 2020 2020 2064 656c  st().        del
+00021600: 2064 7478 0a20 2020 2023 2323 2320 4e6f   dtx.    #### No
+00021610: 7720 7765 2063 7265 6174 6520 6120 7069  w we create a pi
+00021620: 7065 6c69 6e65 2066 6f72 2064 6174 652d  peline for date-
+00021630: 7469 6d65 2066 6561 7475 7265 7320 6173  time features as
+00021640: 2077 656c 6c20 2323 2323 0a20 2020 206f   well ####.    o
+00021650: 6c62 203d 204f 7264 696e 616c 456e 636f  lb = OrdinalEnco
+00021660: 6465 7228 290a 2020 2020 6d6b 5f64 6174  der().    mk_dat
+00021670: 6573 203d 2050 6970 656c 696e 6528 5b28  es = Pipeline([(
+00021680: 2764 6174 655f 7469 6d65 5f66 6561 7475  'date_time_featu
+00021690: 7265 7327 2c20 6372 6561 7465 5f74 735f  res', create_ts_
+000216a0: 6665 6174 7572 6573 5f66 756e 6329 2c20  features_func), 
+000216b0: 2827 6f72 6469 6e61 6c5f 656e 636f 6465  ('ordinal_encode
+000216c0: 7227 2c20 6f6c 6229 5d29 0a20 2020 2023  r', olb)]).    #
+000216d0: 2323 2323 2323 2323 2323 2323 2323 2323  ################
+000216e0: 2323 2323 2323 2323 2323 2323 2323 2323  ################
+000216f0: 2323 2323 2323 2323 2323 2323 2323 2323  ################
+00021700: 2323 2323 2323 2323 2323 2323 2323 2323  ################
+00021710: 2323 2323 2323 2323 2323 2323 2323 2323  ################
+00021720: 2323 230a 2020 2020 2323 2323 2323 2020  ###.    ######  
+00021730: 2020 2043 2041 2054 2045 2047 204f 2052     C A T E G O R
+00021740: 2049 2043 2041 204c 2020 2020 4520 4e20   I C A L    E N 
+00021750: 4320 4f20 4420 4520 5220 5320 2020 2048  C O D E R S    H
+00021760: 2045 2052 2045 2023 2323 2323 2323 2323   E R E #########
+00021770: 2323 2323 2323 2323 2323 2323 0a20 2020  ############.   
+00021780: 2023 2323 2323 2320 2020 2020 7765 206e   ######     we n
+00021790: 6565 6420 746f 2063 7265 6174 6520 756e  eed to create un
+000217a0: 6971 7565 2063 6f6c 756d 6e20 6e61 6d65  ique column name
+000217b0: 7320 666f 7220 6f6e 6520 686f 7420 7661  s for one hot va
+000217c0: 7269 6162 6c65 7320 2020 2023 2323 2323  riables    #####
+000217d0: 2323 2323 230a 2020 2020 2323 2323 2323  #####.    ######
+000217e0: 2323 2323 2323 2323 2323 2323 2323 2323  ################
+000217f0: 2323 2323 2323 2323 2323 2323 2323 2323  ################
+00021800: 2323 2323 2323 2323 2323 2323 2323 2323  ################
+00021810: 2323 2323 2323 2323 2323 2323 2323 2323  ################
+00021820: 2323 2323 2323 2323 2323 2323 2323 0a20  ##############. 
+00021830: 2020 2063 6f70 795f 6361 745f 7661 7273     copy_cat_vars
+00021840: 203d 2063 6f70 792e 6465 6570 636f 7079   = copy.deepcopy
+00021850: 2863 6174 7661 7273 290a 2020 2020 6f6e  (catvars).    on
+00021860: 6568 6f74 5f64 6963 7420 3d20 6465 6661  ehot_dict = defa
+00021870: 756c 7464 6963 7428 7265 7475 726e 5f64  ultdict(return_d
+00021880: 6566 6175 6c74 290a 2020 2020 2323 2323  efault).    ####
+00021890: 2320 5468 6973 2069 7320 6578 7472 656d  # This is extrem
+000218a0: 656c 7920 636f 6d70 6c69 6361 7465 6420  ely complicated 
+000218b0: 6c6f 6769 6320 2d3e 2062 6520 6361 7265  logic -> be care
+000218c0: 6675 6c20 6265 666f 7265 206d 6f64 6966  ful before modif
+000218d0: 7969 6e67 2074 6865 6d21 0a20 2020 2067  ying them!.    g
+000218e0: 632e 636f 6c6c 6563 7428 290a 2020 2020  c.collect().    
+000218f0: 6966 2062 6173 6963 5f65 6e63 6f64 6572  if basic_encoder
+00021900: 2069 6e20 6f6e 6568 6f74 5f74 7970 655f   in onehot_type_
+00021910: 656e 636f 6465 7273 3a0a 2020 2020 2020  encoders:.      
+00021920: 2020 666f 7220 6561 6368 5f63 6174 636f    for each_catco
+00021930: 6c20 696e 2063 6f70 795f 6361 745f 7661  l in copy_cat_va
+00021940: 7273 3a0a 2020 2020 2020 2020 2020 2020  rs:.            
+00021950: 636f 7079 5f6c 6570 5f6f 6e65 203d 2063  copy_lep_one = c
+00021960: 6f70 792e 6465 6570 636f 7079 286c 6570  opy.deepcopy(lep
+00021970: 5f6f 6e65 290a 2020 2020 2020 2020 2020  _one).          
+00021980: 2020 6966 2063 6f6d 6269 6e65 5f72 6172    if combine_rar
+00021990: 655f 666c 6167 3a0a 2020 2020 2020 2020  e_flag:.        
+000219a0: 2020 2020 2020 2020 7263 6374 203d 2052          rcct = R
+000219b0: 6172 655f 436c 6173 735f 436f 6d62 696e  are_Class_Combin
+000219c0: 6572 5f50 6970 6528 290a 2020 2020 2020  er_Pipe().      
+000219d0: 2020 2020 2020 2020 2020 2323 2320 5468            ### Th
+000219e0: 6973 2069 7320 746f 206d 616b 6520 6d69  is is to make mi
+000219f0: 7373 696e 6720 7661 6c75 6573 2064 6f6e  ssing values don
+00021a00: 7420 7472 6970 2075 7020 7468 6520 7472  t trip up the tr
+00021a10: 616e 7366 6f72 6d65 7220 2323 2323 0a20  ansformer ####. 
+00021a20: 2020 2020 2020 2020 2020 2020 2020 2058                 X
+00021a30: 5f74 7261 696e 5b5b 6561 6368 5f63 6174  _train[[each_cat
+00021a40: 636f 6c5d 5d20 3d20 585f 7472 6169 6e5b  col]] = X_train[
+00021a50: 5b65 6163 685f 6361 7463 6f6c 5d5d 2e66  [each_catcol]].f
+00021a60: 696c 6c6e 6128 274d 4953 5349 4e47 5641  illna('MISSINGVA
+00021a70: 4c55 4527 2c61 7869 733d 3129 0a20 2020  LUE',axis=1).   
+00021a80: 2020 2020 2020 2020 2020 2020 2075 6e69               uni
+00021a90: 7175 655f 636f 6c73 203d 206d 616b 655f  que_cols = make_
+00021aa0: 636f 6c75 6d6e 5f6e 616d 6573 5f75 6e69  column_names_uni
+00021ab0: 7175 6528 7263 6374 2e66 6974 5f74 7261  que(rcct.fit_tra
+00021ac0: 6e73 666f 726d 2858 5f74 7261 696e 5b65  nsform(X_train[e
+00021ad0: 6163 685f 6361 7463 6f6c 5d29 2e75 6e69  ach_catcol]).uni
+00021ae0: 7175 6528 292e 746f 6c69 7374 2829 290a  que().tolist()).
+00021af0: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00021b00: 756e 6971 7565 5f63 6f6c 7320 3d20 5b73  unique_cols = [s
+00021b10: 7472 2878 2920 666f 7220 7820 696e 2075  tr(x) for x in u
+00021b20: 6e69 7175 655f 636f 6c73 5d20 2323 2320  nique_cols] ### 
+00021b30: 6a75 7374 206d 616b 6520 7468 656d 2061  just make them a
+00021b40: 6c6c 2073 7472 696e 6773 0a20 2020 2020  ll strings.     
+00021b50: 2020 2020 2020 2020 2020 206f 6e65 686f             oneho
+00021b60: 745f 6469 6374 5b65 6163 685f 6361 7463  t_dict[each_catc
+00021b70: 6f6c 5d20 3d20 756e 6971 7565 5f63 6f6c  ol] = unique_col
+00021b80: 730a 2020 2020 2020 2020 2020 2020 656c  s.            el
+00021b90: 7365 3a0a 2020 2020 2020 2020 2020 2020  se:.            
+00021ba0: 2020 2020 6966 2062 6173 6963 5f65 6e63      if basic_enc
+00021bb0: 6f64 6572 203d 3d20 276f 6e65 686f 7427  oder == 'onehot'
+00021bc0: 3a0a 2020 2020 2020 2020 2020 2020 2020  :.              
+00021bd0: 2020 2020 2020 585f 7472 6169 6e5b 5b65        X_train[[e
+00021be0: 6163 685f 6361 7463 6f6c 5d5d 203d 2058  ach_catcol]] = X
+00021bf0: 5f74 7261 696e 5b5b 6561 6368 5f63 6174  _train[[each_cat
+00021c00: 636f 6c5d 5d2e 6669 6c6c 6e61 2827 4d49  col]].fillna('MI
+00021c10: 5353 494e 4756 414c 5545 272c 6178 6973  SSINGVALUE',axis
+00021c20: 3d31 290a 2020 2020 2020 2020 2020 2020  =1).            
+00021c30: 2020 2020 2020 2020 756e 6971 7565 5f63          unique_c
+00021c40: 6f6c 7320 3d20 585f 7472 6169 6e5b 6561  ols = X_train[ea
+00021c50: 6368 5f63 6174 636f 6c5d 2e75 6e69 7175  ch_catcol].uniqu
+00021c60: 6528 292e 746f 6c69 7374 2829 0a20 2020  e().tolist().   
+00021c70: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00021c80: 2023 756e 6971 7565 5f63 6f6c 7320 3d20   #unique_cols = 
+00021c90: 6e70 2e77 6865 7265 2875 6e69 7175 655f  np.where(unique_
+00021ca0: 636f 6c73 3d3d 6e70 2e6e 616e 2c20 276d  cols==np.nan, 'm
+00021cb0: 6973 7369 6e67 272c 2075 6e69 7175 655f  issing', unique_
+00021cc0: 636f 6c73 290a 2020 2020 2020 2020 2020  cols).          
+00021cd0: 2020 2020 2020 2020 2020 2375 6e69 7175            #uniqu
+00021ce0: 655f 636f 6c73 203d 206e 702e 7768 6572  e_cols = np.wher
+00021cf0: 6528 756e 6971 7565 5f63 6f6c 7320 3d3d  e(unique_cols ==
+00021d00: 204e 6f6e 652c 2027 6d69 7373 696e 6727   None, 'missing'
+00021d10: 2c20 756e 6971 7565 5f63 6f6c 7329 0a20  , unique_cols). 
+00021d20: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00021d30: 2020 2075 6e69 7175 655f 636f 6c73 203d     unique_cols =
+00021d40: 205b 7374 7228 7829 2066 6f72 2078 2069   [str(x) for x i
+00021d50: 6e20 756e 6971 7565 5f63 6f6c 735d 2023  n unique_cols] #
+00021d60: 2323 206a 7573 7420 6d61 6b65 2074 6865  ## just make the
+00021d70: 6d20 616c 6c20 7374 7269 6e67 730a 2020  m all strings.  
+00021d80: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00021d90: 2020 756e 6971 7565 5f63 6f6c 7320 3d20    unique_cols = 
+00021da0: 6d61 6b65 5f63 6f6c 756d 6e5f 6e61 6d65  make_column_name
+00021db0: 735f 756e 6971 7565 2875 6e69 7175 655f  s_unique(unique_
+00021dc0: 636f 6c73 290a 2020 2020 2020 2020 2020  cols).          
+00021dd0: 2020 2020 2020 2020 2020 6f6e 6568 6f74            onehot
+00021de0: 5f64 6963 745b 6561 6368 5f63 6174 636f  _dict[each_catco
+00021df0: 6c5d 203d 2075 6e69 7175 655f 636f 6c73  l] = unique_cols
+00021e00: 0a20 2020 2020 2020 2020 2020 2020 2020  .               
+00021e10: 2065 6c73 653a 0a20 2020 2020 2020 2020   else:.         
+00021e20: 2020 2020 2020 2020 2020 2058 5f74 7261             X_tra
+00021e30: 696e 5b5b 6561 6368 5f63 6174 636f 6c5d  in[[each_catcol]
+00021e40: 5d20 3d20 585f 7472 6169 6e5b 5b65 6163  ] = X_train[[eac
+00021e50: 685f 6361 7463 6f6c 5d5d 2e66 696c 6c6e  h_catcol]].filln
+00021e60: 6128 274d 4953 5349 4e47 5641 4c55 4527  a('MISSINGVALUE'
+00021e70: 2c61 7869 733d 3129 0a20 2020 2020 2020  ,axis=1).       
+00021e80: 2020 2020 2020 2020 2020 2020 206f 6e65               one
+00021e90: 686f 745f 6469 6374 5b65 6163 685f 6361  hot_dict[each_ca
+00021ea0: 7463 6f6c 5d20 3d20 636f 7079 5f6c 6570  tcol] = copy_lep
+00021eb0: 5f6f 6e65 2e66 6974 5f74 7261 6e73 666f  _one.fit_transfo
+00021ec0: 726d 2858 5f74 7261 696e 5b65 6163 685f  rm(X_train[each_
+00021ed0: 6361 7463 6f6c 5d2c 2079 5f74 7261 696e  catcol], y_train
+00021ee0: 292e 636f 6c75 6d6e 732e 746f 6c69 7374  ).columns.tolist
+00021ef0: 2829 0a20 2020 2065 6c73 653a 0a20 2020  ().    else:.   
+00021f00: 2020 2020 2066 6f72 2065 6163 685f 6361       for each_ca
+00021f10: 7463 6f6c 2069 6e20 636f 7079 5f63 6174  tcol in copy_cat
+00021f20: 5f76 6172 733a 0a20 2020 2020 2020 2020  _vars:.         
+00021f30: 2020 206f 6e65 686f 745f 6469 6374 5b65     onehot_dict[e
+00021f40: 6163 685f 6361 7463 6f6c 5d20 3d20 276c  ach_catcol] = 'l
+00021f50: 6162 656c 270a 2020 2020 0a20 2020 200a  abel'.    .    .
+00021f60: 2020 2020 2323 2320 7765 206e 6f77 206e      ### we now n
+00021f70: 6565 6420 746f 2064 6f20 7468 6520 7361  eed to do the sa
+00021f80: 6d65 2066 6f72 2064 6973 6372 6574 6520  me for discrete 
+00021f90: 7661 7269 6162 6c65 7320 6261 7365 6420  variables based 
+00021fa0: 6f6e 2065 6e63 6f64 6572 2074 6861 7420  on encoder that 
+00021fb0: 6973 2073 656c 6563 7465 6420 2323 0a20  is selected ##. 
+00021fc0: 2020 2023 2323 2323 2054 6869 7320 6973     ##### This is
+00021fd0: 2065 7874 7265 6d65 6c79 2063 6f6d 706c   extremely compl
+00021fe0: 6963 6174 6564 206c 6f67 6963 202d 3e20  icated logic -> 
+00021ff0: 6265 2063 6172 6566 756c 2062 6566 6f72  be careful befor
+00022000: 6520 6d6f 6469 6679 696e 6720 7468 656d  e modifying them
+00022010: 210a 2020 2020 636f 7079 5f64 6973 6372  !.    copy_discr
+00022020: 6574 655f 7661 7273 203d 2063 6f70 792e  ete_vars = copy.
+00022030: 6465 6570 636f 7079 2864 6973 6372 6574  deepcopy(discret
+00022040: 6576 6172 7329 0a20 2020 2069 6620 656e  evars).    if en
+00022050: 636f 6465 7220 696e 206f 6e65 686f 745f  coder in onehot_
+00022060: 7479 7065 5f65 6e63 6f64 6572 733a 0a20  type_encoders:. 
+00022070: 2020 2020 2020 2066 6f72 2065 6163 685f         for each_
+00022080: 6469 7363 7265 7465 2069 6e20 636f 7079  discrete in copy
+00022090: 5f64 6973 6372 6574 655f 7661 7273 3a0a  _discrete_vars:.
+000220a0: 2020 2020 2020 2020 2020 2020 636f 7079              copy
+000220b0: 5f6c 6570 5f74 776f 203d 2063 6f70 792e  _lep_two = copy.
+000220c0: 6465 6570 636f 7079 286c 6570 5f74 776f  deepcopy(lep_two
+000220d0: 290a 2020 2020 2020 2020 2020 2020 6966  ).            if
+000220e0: 2063 6f6d 6269 6e65 5f72 6172 655f 666c   combine_rare_fl
+000220f0: 6167 3a0a 2020 2020 2020 2020 2020 2020  ag:.            
+00022100: 2020 2020 7263 6374 203d 2052 6172 655f      rcct = Rare_
+00022110: 436c 6173 735f 436f 6d62 696e 6572 5f50  Class_Combiner_P
+00022120: 6970 6528 290a 2020 2020 2020 2020 2020  ipe().          
+00022130: 2020 2020 2020 585f 7472 6169 6e5b 5b65        X_train[[e
+00022140: 6163 685f 6469 7363 7265 7465 5d5d 203d  ach_discrete]] =
+00022150: 2058 5f74 7261 696e 5b5b 6561 6368 5f64   X_train[[each_d
+00022160: 6973 6372 6574 655d 5d2e 6669 6c6c 6e61  iscrete]].fillna
+00022170: 2827 4d49 5353 494e 4756 414c 5545 272c  ('MISSINGVALUE',
+00022180: 2061 7869 733d 3129 0a20 2020 2020 2020   axis=1).       
+00022190: 2020 2020 2020 2020 2075 6e69 7175 655f           unique_
+000221a0: 636f 6c73 203d 206d 616b 655f 636f 6c75  cols = make_colu
+000221b0: 6d6e 5f6e 616d 6573 5f75 6e69 7175 6528  mn_names_unique(
+000221c0: 7263 6374 2e66 6974 5f74 7261 6e73 666f  rcct.fit_transfo
+000221d0: 726d 2858 5f74 7261 696e 5b65 6163 685f  rm(X_train[each_
+000221e0: 6469 7363 7265 7465 5d29 2e75 6e69 7175  discrete]).uniqu
+000221f0: 6528 292e 746f 6c69 7374 2829 290a 2020  e().tolist()).  
+00022200: 2020 2020 2020 2020 2020 2020 2020 756e                un
+00022210: 6971 7565 5f63 6f6c 7320 3d20 5b73 7472  ique_cols = [str
+00022220: 2878 2920 666f 7220 7820 696e 2075 6e69  (x) for x in uni
+00022230: 7175 655f 636f 6c73 5d20 2323 2320 6a75  que_cols] ### ju
+00022240: 7374 206d 616b 6520 7468 656d 2061 6c6c  st make them all
+00022250: 2073 7472 696e 6773 0a20 2020 2020 2020   strings.       
+00022260: 2020 2020 2020 2020 206f 6e65 686f 745f           onehot_
+00022270: 6469 6374 5b65 6163 685f 6469 7363 7265  dict[each_discre
+00022280: 7465 5d20 3d20 756e 6971 7565 5f63 6f6c  te] = unique_col
+00022290: 730a 2020 2020 2020 2020 2020 2020 656c  s.            el
+000222a0: 7365 3a0a 2020 2020 2020 2020 2020 2020  se:.            
+000222b0: 2020 2020 6966 2065 6e63 6f64 6572 203d      if encoder =
+000222c0: 3d20 276f 6e65 686f 7427 3a0a 2020 2020  = 'onehot':.    
+000222d0: 2020 2020 2020 2020 2020 2020 2020 2020                  
+000222e0: 585f 7472 6169 6e5b 5b65 6163 685f 6469  X_train[[each_di
+000222f0: 7363 7265 7465 5d5d 203d 2058 5f74 7261  screte]] = X_tra
+00022300: 696e 5b5b 6561 6368 5f64 6973 6372 6574  in[[each_discret
+00022310: 655d 5d2e 6669 6c6c 6e61 2827 4d49 5353  e]].fillna('MISS
+00022320: 494e 4756 414c 5545 272c 2061 7869 733d  INGVALUE', axis=
+00022330: 3129 0a20 2020 2020 2020 2020 2020 2020  1).             
+00022340: 2020 2020 2020 2075 6e69 7175 655f 636f         unique_co
+00022350: 6c73 203d 2058 5f74 7261 696e 5b65 6163  ls = X_train[eac
+00022360: 685f 6469 7363 7265 7465 5d2e 756e 6971  h_discrete].uniq
+00022370: 7565 2829 2e74 6f6c 6973 7428 290a 2020  ue().tolist().  
+00022380: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00022390: 2020 2375 6e69 7175 655f 636f 6c73 203d    #unique_cols =
+000223a0: 206e 702e 7768 6572 6528 756e 6971 7565   np.where(unique
+000223b0: 5f63 6f6c 733d 3d6e 702e 6e61 6e2c 2027  _cols==np.nan, '
+000223c0: 6d69 7373 696e 6727 2c20 756e 6971 7565  missing', unique
+000223d0: 5f63 6f6c 7329 0a20 2020 2020 2020 2020  _cols).         
+000223e0: 2020 2020 2020 2020 2020 2075 6e69 7175             uniqu
+000223f0: 655f 636f 6c73 203d 205b 7374 7228 7829  e_cols = [str(x)
+00022400: 2066 6f72 2078 2069 6e20 756e 6971 7565   for x in unique
+00022410: 5f63 6f6c 735d 2023 2323 206a 7573 7420  _cols] ### just 
+00022420: 6d61 6b65 2074 6865 6d20 616c 6c20 7374  make them all st
+00022430: 7269 6e67 730a 2020 2020 2020 2020 2020  rings.          
+00022440: 2020 2020 2020 2020 2020 756e 6971 7565            unique
+00022450: 5f63 6f6c 7320 3d20 6d61 6b65 5f63 6f6c  _cols = make_col
+00022460: 756d 6e5f 6e61 6d65 735f 756e 6971 7565  umn_names_unique
+00022470: 2875 6e69 7175 655f 636f 6c73 290a 2020  (unique_cols).  
+00022480: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00022490: 2020 6f6e 6568 6f74 5f64 6963 745b 6561    onehot_dict[ea
+000224a0: 6368 5f64 6973 6372 6574 655d 203d 2075  ch_discrete] = u
+000224b0: 6e69 7175 655f 636f 6c73 0a20 2020 2020  nique_cols.     
+000224c0: 2020 2020 2020 2020 2020 2065 6c73 653a             else:
+000224d0: 0a20 2020 2020 2020 2020 2020 2020 2020  .               
+000224e0: 2020 2020 2058 5f74 7261 696e 5b5b 6561       X_train[[ea
+000224f0: 6368 5f64 6973 6372 6574 655d 5d20 3d20  ch_discrete]] = 
+00022500: 585f 7472 6169 6e5b 5b65 6163 685f 6469  X_train[[each_di
+00022510: 7363 7265 7465 5d5d 2e66 696c 6c6e 6128  screte]].fillna(
+00022520: 274d 4953 5349 4e47 5641 4c55 4527 2c20  'MISSINGVALUE', 
+00022530: 6178 6973 3d31 290a 2020 2020 2020 2020  axis=1).        
+00022540: 2020 2020 2020 2020 2020 2020 6f6e 6568              oneh
+00022550: 6f74 5f64 6963 745b 6561 6368 5f64 6973  ot_dict[each_dis
+00022560: 6372 6574 655d 203d 2063 6f70 795f 6c65  crete] = copy_le
+00022570: 705f 7477 6f2e 6669 745f 7472 616e 7366  p_two.fit_transf
+00022580: 6f72 6d28 585f 7472 6169 6e5b 6561 6368  orm(X_train[each
+00022590: 5f64 6973 6372 6574 655d 2c20 795f 7472  _discrete], y_tr
+000225a0: 6169 6e29 2e63 6f6c 756d 6e73 2e74 6f6c  ain).columns.tol
+000225b0: 6973 7428 290a 2020 2020 656c 7365 3a0a  ist().    else:.
+000225c0: 2020 2020 2020 2020 2323 2320 5468 656e          ### Then
+000225d0: 206d 6172 6b20 6974 2061 7320 6c61 6265   mark it as labe
+000225e0: 6c20 656e 636f 6469 6e67 2073 6f20 6974  l encoding so it
+000225f0: 2063 616e 2062 6520 6861 6e64 6c65 6420   can be handled 
+00022600: 7072 6f70 6572 6c79 2023 2323 230a 2020  properly ####.  
+00022610: 2020 2020 2020 666f 7220 6561 6368 5f64        for each_d
+00022620: 6973 6372 6574 6520 696e 2063 6f70 795f  iscrete in copy_
+00022630: 6469 7363 7265 7465 5f76 6172 733a 0a20  discrete_vars:. 
+00022640: 2020 2020 2020 2020 2020 206f 6e65 686f             oneho
+00022650: 745f 6469 6374 5b65 6163 685f 6469 7363  t_dict[each_disc
+00022660: 7265 7465 5d20 3d20 276c 6162 656c 270a  rete] = 'label'.
+00022670: 2020 2020 0a20 2020 2023 2323 2069 6620      .    ### if 
+00022680: 796f 7520 6472 6f70 2072 656d 6169 6e64  you drop remaind
+00022690: 6572 2c20 7468 656e 206c 6566 746f 7665  er, then leftove
+000226a0: 7276 6172 7320 6973 206e 6f74 206e 6565  rvars is not nee
+000226b0: 6465 642e 0a20 2020 2072 656d 6169 6e64  ded..    remaind
+000226c0: 6572 203d 2027 6472 6f70 270a 2020 2020  er = 'drop'.    
+000226d0: 0a20 2020 2023 2323 2049 6620 796f 7520  .    ### If you 
+000226e0: 7061 7373 7468 726f 7567 6820 7265 6d61  passthrough rema
+000226f0: 696e 6465 722c 2074 6865 6e20 6c65 6674  inder, then left
+00022700: 6f76 6572 7320 6d75 7374 2062 6520 696e  overs must be in
+00022710: 636c 7564 6564 200a 2020 2020 2372 656d  cluded .    #rem
+00022720: 6169 6e64 6572 203d 2027 7061 7373 7468  ainder = 'passth
+00022730: 726f 7567 6827 0a0a 2020 2020 2323 2323  rough'..    ####
+00022740: 2323 2323 2323 2323 2323 2323 2323 2323  ################
+00022750: 2323 2323 2323 2323 2323 2323 2323 2323  ################
+00022760: 2323 2323 2323 2323 2323 2323 2323 2323  ################
+00022770: 2323 2323 2323 2323 2323 2323 2323 2323  ################
+00022780: 2323 2323 2323 2323 2323 2323 2323 2323  ################
+00022790: 0a20 2020 2023 2323 2323 2323 2323 2323  .    ###########
+000227a0: 2323 2020 2020 2020 2020 2020 2020 2020  ##              
+000227b0: 2020 2020 2053 2043 2041 204c 2045 2052       S C A L E R
+000227c0: 2053 2020 2020 2048 2045 2052 2045 2020   S     H E R E  
+000227d0: 2020 2020 2020 2020 2020 2023 2323 2323             #####
+000227e0: 2323 2323 2323 2323 230a 2020 2020 2323  #########.    ##
+000227f0: 2320 4966 2079 6f75 2063 686f 6f73 6520  # If you choose 
+00022800: 5374 616e 6461 7264 5363 616c 6572 206f  StandardScaler o
+00022810: 7220 4d69 6e4d 6178 5363 616c 6572 2c20  r MinMaxScaler, 
+00022820: 7468 6520 696e 7465 6765 7220 7661 6c75  the integer valu
+00022830: 6573 2062 6563 6f6d 6520 7374 7265 7463  es become stretc
+00022840: 6865 6420 0a20 2020 2023 2323 2020 6173  hed .    ###  as
+00022850: 2069 6620 7468 6579 2061 7265 2066 6172   if they are far
+00022860: 2061 7061 7274 2077 6865 6e20 696e 2072   apart when in r
+00022870: 6561 6c69 7479 2074 6865 7920 6172 6520  eality they are 
+00022880: 636c 6f73 652e 2053 6f20 6176 6f69 6420  close. So avoid 
+00022890: 6974 2066 6f72 206e 6f77 2e0a 2020 2020  it for now..    
+000228a0: 2323 2323 2323 2323 2323 2323 2323 2323  ################
+000228b0: 2323 2323 2323 2323 2323 2323 2323 2323  ################
+000228c0: 2323 2323 2323 2323 2323 2323 2323 2323  ################
+000228d0: 2323 2323 2323 2323 2323 2323 2323 2323  ################
+000228e0: 2323 2323 2323 2323 2323 2323 2323 2323  ################
+000228f0: 2323 2323 0a20 2020 2069 6620 7363 616c  ####.    if scal
+00022900: 6572 7320 616e 6420 7665 7262 6f73 653a  ers and verbose:
+00022910: 0a20 2020 2020 2020 2020 2020 2070 7269  .            pri
+00022920: 6e74 2827 4361 7574 696f 6e3a 2023 2323  nt('Caution: ###
+00022930: 2057 6865 6e20 796f 7520 6861 7665 2063   When you have c
+00022940: 6174 6567 6f72 6963 616c 206f 7220 6461  ategorical or da
+00022950: 7465 2d74 696d 6520 7661 7273 2069 6e20  te-time vars in 
+00022960: 6461 7461 2c20 7363 616c 696e 6720 6d61  data, scaling ma
+00022970: 7920 6e6f 7420 6265 2068 656c 7066 756c  y not be helpful
+00022980: 2e20 2323 2729 0a20 2020 2069 6620 7363  . ##').    if sc
+00022990: 616c 6572 733d 3d27 6d61 7827 206f 7220  alers=='max' or 
+000229a0: 7363 616c 6572 7320 3d3d 2027 6d69 6e6d  scalers == 'minm
+000229b0: 6178 273a 0a20 2020 2020 2020 2073 6361  ax':.        sca
+000229c0: 6c65 7220 3d20 4d69 6e4d 6178 5363 616c  ler = MinMaxScal
+000229d0: 6572 2829 0a20 2020 2065 6c69 6620 7363  er().    elif sc
+000229e0: 616c 6572 733d 3d27 7374 616e 6461 7264  alers=='standard
+000229f0: 2720 6f72 2073 6361 6c65 7273 3d3d 2773  ' or scalers=='s
+00022a00: 7464 273a 0a20 2020 2020 2020 2023 2323  td':.        ###
+00022a10: 2059 6f75 2068 6176 6520 746f 2073 6574   You have to set
+00022a20: 2077 6974 685f 6d65 616e 3d46 616c 7365   with_mean=False
+00022a30: 2077 6865 6e20 6465 616c 696e 6720 7769   when dealing wi
+00022a40: 7468 2073 7061 7273 6520 6d61 7472 6963  th sparse matric
+00022a50: 6573 2023 230a 2020 2020 2020 2020 7363  es ##.        sc
+00022a60: 616c 6572 203d 2053 7461 6e64 6172 6453  aler = StandardS
+00022a70: 6361 6c65 7228 7769 7468 5f6d 6561 6e3d  caler(with_mean=
+00022a80: 4661 6c73 6529 0a20 2020 2065 6c69 6620  False).    elif 
+00022a90: 7363 616c 6572 733d 3d27 726f 6275 7374  scalers=='robust
+00022aa0: 273a 0a20 2020 2020 2020 2073 6361 6c65  ':.        scale
+00022ab0: 7220 3d20 526f 6275 7374 5363 616c 6572  r = RobustScaler
+00022ac0: 2875 6e69 745f 7661 7269 616e 6365 3d54  (unit_variance=T
+00022ad0: 7275 6529 0a20 2020 2065 6c69 6620 7363  rue).    elif sc
+00022ae0: 616c 6572 733d 3d27 6d61 7861 6273 273a  alers=='maxabs':
+00022af0: 0a20 2020 2020 2020 2023 2323 2049 6620  .        ### If 
+00022b00: 796f 7520 6368 6f6f 7365 204d 6178 4162  you choose MaxAb
+00022b10: 7353 6361 6c65 722c 2074 6865 6e20 4e61  sScaler, then Na
+00022b20: 4e73 2077 6869 6368 2077 6572 6520 4c61  Ns which were La
+00022b30: 6265 6c20 456e 636f 6465 6420 6173 202d  bel Encoded as -
+00022b40: 3120 6172 6520 7072 6573 6572 7665 6420  1 are preserved 
+00022b50: 6173 202d 2028 6e65 6761 7469 7665 7329  as - (negatives)
+00022b60: 2e20 5468 6973 2069 7320 6661 6e74 6173  . This is fantas
+00022b70: 7469 632e 0a20 2020 2020 2020 2073 6361  tic..        sca
+00022b80: 6c65 7220 3d20 4d61 7841 6273 5363 616c  ler = MaxAbsScal
+00022b90: 6572 2829 0a20 2020 2065 6c73 653a 0a20  er().    else:. 
+00022ba0: 2020 2020 2020 2069 6620 7665 7262 6f73         if verbos
+00022bb0: 653a 0a20 2020 2020 2020 2020 2020 2070  e:.            p
+00022bc0: 7269 6e74 2827 2020 2020 616c 6572 743a  rint('    alert:
+00022bd0: 2074 6865 7265 2069 7320 6e6f 2073 6361   there is no sca
+00022be0: 6c65 7220 7370 6563 6966 6965 642e 204f  ler specified. O
+00022bf0: 7074 696f 6e73 2061 7265 3a20 6d61 782c  ptions are: max,
+00022c00: 2073 7464 2c20 726f 6275 7374 2c20 6d61   std, robust, ma
+00022c10: 7861 6273 2e27 290a 2020 2020 2020 2020  xabs.').        
+00022c20: 7363 616c 6572 7320 3d20 2727 0a20 2020  scalers = ''.   
+00022c30: 2023 2323 2323 2323 2323 2320 2064 6566   ##########  def
+00022c40: 696e 6520 6e75 6d65 7269 6320 7661 7273  ine numeric vars
+00022c50: 2061 7320 636f 6d62 6f20 6f66 2066 6c6f   as combo of flo
+00022c60: 6174 2061 6e64 2069 6e74 6567 6572 2076  at and integer v
+00022c70: 6172 6961 626c 6573 2020 2020 2323 2323  ariables    ####
+00022c80: 2323 2323 230a 2020 2020 6e75 6d76 6172  #####.    numvar
+00022c90: 7320 3d20 696e 7476 6172 7320 2b20 666c  s = intvars + fl
+00022ca0: 6f61 7476 6172 730a 2020 2020 2323 2323  oatvars.    ####
+00022cb0: 2323 2323 2323 2323 2323 2323 2323 2323  ################
+00022cc0: 2323 2323 2323 2323 2323 2323 2323 2323  ################
+00022cd0: 2323 2323 2323 2323 2323 2323 2323 2323  ################
+00022ce0: 2323 2323 2323 2323 2323 2323 2323 2323  ################
+00022cf0: 2323 2323 2323 2323 2323 2323 2323 2323  ################
+00022d00: 0a20 2020 2023 2323 2323 2323 2323 2020  .    #########  
+00022d10: 2020 2020 2020 2020 4320 5220 4520 4120          C R E A 
+00022d20: 5420 4920 4e20 4720 2020 2020 2050 2049  T I N G      P I
+00022d30: 2050 2045 204c 2049 204e 2045 2020 2020   P E L I N E    
+00022d40: 2020 4820 4520 5220 4520 2023 2323 2323    H E R E  #####
+00022d50: 2323 2323 2323 2323 230a 2020 2020 2323  #########.    ##
+00022d60: 2320 416c 6c20 7468 6520 696d 7075 7465  # All the impute
+00022d70: 7273 2077 6f72 6b20 6f6e 2067 726f 7570  rs work on group
+00022d80: 7320 6f66 2076 6172 6961 626c 6573 203d  s of variables =
+00022d90: 3e20 736f 2074 6865 7920 6e65 6564 2074  > so they need t
+00022da0: 6f20 6265 2069 6e20 7468 6520 2323 2323  o be in the ####
+00022db0: 2323 0a20 2020 2023 2323 2020 2020 656e  ##.    ###    en
+00022dc0: 6420 7369 6e63 6520 7468 6579 2072 6574  d since they ret
+00022dd0: 7572 6e20 6f6e 6c79 2031 4420 6172 7261  urn only 1D arra
+00022de0: 7973 2e20 4d79 5f4c 6162 656c 456e 636f  ys. My_LabelEnco
+00022df0: 6465 7220 616e 6420 6f74 6865 7220 2020  der and other   
+00022e00: 2020 2020 2023 2323 2323 230a 2020 2020       ######.    
+00022e10: 2323 2320 2020 2066 6974 5f74 7261 6e73  ###    fit_trans
+00022e20: 666f 726d 6572 7320 6e65 6564 2032 4420  formers need 2D 
+00022e30: 6172 7261 7973 2073 696e 6365 2074 6865  arrays since the
+00022e40: 7920 776f 726b 206f 6e20 5461 7267 6574  y work on Target
+00022e50: 206c 6162 656c 7320 746f 6f2e 2020 2323   labels too.  ##
+00022e60: 2323 2323 0a20 2020 2023 2323 2323 2323  ####.    #######
+00022e70: 2323 2323 2323 2323 2323 2323 2323 2323  ################
+00022e80: 2323 2323 2323 2323 2323 2323 2323 2323  ################
+00022e90: 2323 2323 2323 2323 2323 2323 2323 2323  ################
+00022ea0: 2323 2323 2323 2323 2323 2323 2323 2323  ################
+00022eb0: 2323 2323 2323 2323 2323 2323 230a 2020  #############.  
+00022ec0: 2020 696e 6974 5f73 7472 203d 2027 6d61    init_str = 'ma
+00022ed0: 6b65 5f63 6f6c 756d 6e5f 7472 616e 7366  ke_column_transf
+00022ee0: 6f72 6d65 7228 270a 2020 2020 2323 2323  ormer('.    ####
+00022ef0: 206c 6570 5f6f 6e65 2061 6374 7320 6173   lep_one acts as
+00022f00: 2061 206f 6e65 2d68 6f74 2065 6e63 6f64   a one-hot encod
+00022f10: 6572 206f 6620 6c6f 7720 6361 7264 696e  er of low cardin
+00022f20: 616c 6974 7920 6361 7465 676f 7269 6361  ality categorica
+00022f30: 6c20 7661 7269 6162 6c65 7320 2323 2323  l variables ####
+00022f40: 2323 2323 0a20 2020 206d 6964 646c 655f  ####.    middle_
+00022f50: 7374 7230 203d 2022 222e 6a6f 696e 285b  str0 = "".join([
+00022f60: 2728 6c65 705f 6f6e 652c 2063 6174 7661  '(lep_one, catva
+00022f70: 7273 5b27 2b73 7472 2869 292b 275d 292c  rs['+str(i)+']),
+00022f80: 2720 666f 7220 6920 696e 2072 616e 6765  ' for i in range
+00022f90: 286c 656e 2863 6174 7661 7273 2929 5d29  (len(catvars))])
+00022fa0: 0a20 2020 2023 2323 2320 6c65 705f 7477  .    #### lep_tw
+00022fb0: 6f20 6163 7473 2061 7320 6120 6d61 6a6f  o acts as a majo
+00022fc0: 7220 656e 636f 6465 7220 6f66 2068 6967  r encoder of hig
+00022fd0: 6820 6361 7264 696e 616c 6974 7920 6361  h cardinality ca
+00022fe0: 7465 676f 7269 6361 6c20 7661 7269 6162  tegorical variab
+00022ff0: 6c65 7320 2323 2323 2323 2323 0a20 2020  les ########.   
+00023000: 206d 6964 646c 655f 7374 7231 203d 2022   middle_str1 = "
+00023010: 222e 6a6f 696e 285b 2728 6c65 705f 7477  ".join(['(lep_tw
+00023020: 6f2c 2064 6973 6372 6574 6576 6172 735b  o, discretevars[
+00023030: 272b 7374 7228 6929 2b27 5d29 2c27 2066  '+str(i)+']),' f
+00023040: 6f72 2069 2069 6e20 7261 6e67 6528 6c65  or i in range(le
+00023050: 6e28 6469 7363 7265 7465 7661 7273 2929  n(discretevars))
+00023060: 5d29 0a20 2020 206d 6964 646c 655f 7374  ]).    middle_st
+00023070: 7231 3220 3d20 2728 696d 702c 2069 6e74  r12 = '(imp, int
+00023080: 7661 7273 292c 270a 2020 2020 6d69 6464  vars),'.    midd
+00023090: 6c65 5f73 7472 3220 3d20 2222 2e6a 6f69  le_str2 = "".joi
+000230a0: 6e28 5b27 286d 6b5f 6461 7465 732c 2064  n(['(mk_dates, d
+000230b0: 6174 6576 6172 735b 272b 7374 7228 6929  atevars['+str(i)
+000230c0: 2b27 5d29 2c27 2066 6f72 2069 2069 6e20  +']),' for i in 
+000230d0: 7261 6e67 6528 6c65 6e28 6461 7465 7661  range(len(dateva
+000230e0: 7273 2929 5d29 0a20 2020 2023 2323 2323  rs))]).    #####
+000230f0: 204e 6f77 2077 6520 6361 6e20 636f 6d62   Now we can comb
+00023100: 696e 6520 7468 6520 7265 7374 206f 6620  ine the rest of 
+00023110: 7468 6520 7661 7269 6162 6c65 7320 696e  the variables in
+00023120: 746f 2074 6865 2070 6970 656c 696e 6520  to the pipeline 
+00023130: 2323 2323 2323 2323 2323 2323 2323 2323  ################
+00023140: 0a20 2020 2069 6620 6e6c 7076 6172 733a  .    if nlpvars:
+00023150: 0a20 2020 2020 2020 206d 6964 646c 655f  .        middle_
+00023160: 7374 7233 203d 2022 222e 6a6f 696e 285b  str3 = "".join([
+00023170: 2728 7665 6374 5f6f 6e65 2c20 6e6c 7076  '(vect_one, nlpv
+00023180: 6172 735b 272b 7374 7228 6929 2b27 5d29  ars['+str(i)+'])
+00023190: 2c27 2066 6f72 2069 2069 6e20 7261 6e67  ,' for i in rang
+000231a0: 6528 6c65 6e28 6e6c 7076 6172 7329 295d  e(len(nlpvars))]
+000231b0: 290a 2020 2020 656c 7365 3a0a 2020 2020  ).    else:.    
+000231c0: 2020 2020 6d69 6464 6c65 5f73 7472 3320      middle_str3 
+000231d0: 3d20 2727 0a20 2020 2065 6e64 5f73 7472  = ''.    end_str
+000231e0: 203d 2027 2869 6d70 2c20 666c 6f61 7476   = '(imp, floatv
+000231f0: 6172 7329 2c20 2020 2072 656d 6169 6e64  ars),    remaind
+00023200: 6572 3d72 656d 6169 6e64 6572 2927 0a20  er=remainder)'. 
+00023210: 2020 2023 2323 2057 6520 6e6f 7720 7075     ### We now pu
+00023220: 7420 7468 6520 7768 6f6c 6520 7472 616e  t the whole tran
+00023230: 7366 6f72 6d65 7220 7069 7065 6c69 6e65  sformer pipeline
+00023240: 2074 6f67 6574 6865 7220 2323 230a 2020   together ###.  
+00023250: 2020 6675 6c6c 5f73 7472 203d 2069 6e69    full_str = ini
+00023260: 745f 7374 722b 6d69 6464 6c65 5f73 7472  t_str+middle_str
+00023270: 302b 6d69 6464 6c65 5f73 7472 312b 6d69  0+middle_str1+mi
+00023280: 6464 6c65 5f73 7472 3132 2b6d 6964 646c  ddle_str12+middl
+00023290: 655f 7374 7232 2b6d 6964 646c 655f 7374  e_str2+middle_st
+000232a0: 7233 2b65 6e64 5f73 7472 0a20 2020 2063  r3+end_str.    c
+000232b0: 7420 3d20 6576 616c 2866 756c 6c5f 7374  t = eval(full_st
+000232c0: 7229 0a20 2020 2069 6620 7665 7262 6f73  r).    if verbos
+000232d0: 6520 3e3d 323a 0a20 2020 2020 2020 2070  e >=2:.        p
+000232e0: 7269 6e74 2827 4368 6563 6b20 7468 6520  rint('Check the 
+000232f0: 7069 7065 6c69 6e65 2063 7265 6174 696f  pipeline creatio
+00023300: 6e20 7374 6174 656d 656e 7420 666f 7220  n statement for 
+00023310: 6572 726f 7273 2028 6966 2061 6e79 293a  errors (if any):
+00023320: 5c6e 5c74 2573 2720 2566 756c 6c5f 7374  \n\t%s' %full_st
+00023330: 7229 0a20 2020 2023 2323 204f 6e63 6520  r).    ### Once 
+00023340: 7468 6174 2069 7320 646f 6e65 2c20 7765  that is done, we
+00023350: 2063 7265 6174 6520 7365 7175 656e 7469   create sequenti
+00023360: 616c 2073 7465 7073 2066 6f72 2061 2070  al steps for a p
+00023370: 6970 656c 696e 650a 2020 2020 6966 2073  ipeline.    if s
+00023380: 6361 6c65 7273 3a0a 2020 2020 2020 2020  calers:.        
+00023390: 2373 6361 6c65 725f 7069 7065 203d 206d  #scaler_pipe = m
+000233a0: 616b 655f 7069 7065 6c69 6e65 2863 742c  ake_pipeline(ct,
+000233b0: 2073 6361 6c65 7220 290a 2020 2020 2020   scaler ).      
+000233c0: 2020 7363 616c 6572 5f70 6970 6520 3d20    scaler_pipe = 
+000233d0: 5069 7065 6c69 6e65 285b 2827 636f 6d70  Pipeline([('comp
+000233e0: 6c65 7465 5f70 6970 656c 696e 6527 2c20  lete_pipeline', 
+000233f0: 6374 292c 2028 2773 6361 6c65 7227 2c20  ct), ('scaler', 
+00023400: 7363 616c 6572 295d 290a 2020 2020 656c  scaler)]).    el
+00023410: 7365 3a0a 2020 2020 2020 2020 2323 2320  se:.        ### 
+00023420: 6465 6661 756c 7420 6973 206e 6f20 7363  default is no sc
+00023430: 616c 6572 2023 230a 2020 2020 2020 2020  aler ##.        
+00023440: 7363 616c 6572 5f70 6970 6520 3d20 636f  scaler_pipe = co
+00023450: 7079 2e64 6565 7063 6f70 7928 6374 290a  py.deepcopy(ct).
+00023460: 2020 2020 2323 2320 5468 6520 6669 7273      ### The firs
+00023470: 7420 636f 6c75 6d6e 7320 7368 6f75 6c64  t columns should
+00023480: 2062 6520 7768 6174 6576 6572 2069 7320   be whatever is 
+00023490: 696e 2074 6865 2054 7261 6e73 666f 726d  in the Transform
+000234a0: 6572 5f50 6970 656c 696e 6520 6c69 7374  er_Pipeline list
+000234b0: 206f 6620 636f 6c75 6d6e 730a 2020 2020   of columns.    
+000234c0: 2323 2320 4865 6e63 6520 7468 6579 2077  ### Hence they w
+000234d0: 696c 6c20 6265 2027 5365 7827 2c20 2245  ill be 'Sex', "E
+000234e0: 6d62 6172 6b65 6422 2c20 2241 6765 222c  mbarked", "Age",
+000234f0: 2022 4661 7265 222e 2054 6865 6e20 6f6e   "Fare". Then on
+00023500: 6c79 206f 7468 6572 2063 6f6c 756d 6e73  ly other columns
+00023510: 2074 6861 7420 6172 6520 7061 7373 6564   that are passed
+00023520: 2074 6872 6f75 6768 2e0a 2020 2020 2323   through..    ##
+00023530: 2320 536f 2061 6674 6572 2074 6865 2061  # So after the a
+00023540: 626f 7665 2034 2c20 796f 7520 7769 6c6c  bove 4, you will
+00023550: 2067 6574 2072 656d 6169 6e64 6572 2063   get remainder c
+00023560: 6f6c 7320 756e 6368 616e 6765 643a 2022  ols unchanged: "
+00023570: 5061 7263 6822 2c22 4e61 6d65 220a 2020  Parch","Name".  
+00023580: 2020 2323 2053 6f20 6966 2079 6f75 2064    ## So if you d
+00023590: 6f20 6974 2063 6f72 7265 6374 6c79 2c20  o it correctly, 
+000235a0: 796f 7520 7769 6c6c 2067 6574 2074 6865  you will get the
+000235b0: 206c 6973 7420 6f66 206e 616d 6573 2069   list of names i
+000235c0: 6e20 7072 6f70 6572 206f 7264 6572 2074  n proper order t
+000235d0: 6869 7320 7761 793a 0a20 2020 2023 2320  his way:.    ## 
+000235e0: 6669 7273 7420 6973 2063 6174 7661 7273  first is catvars
+000235f0: 2c20 7468 656e 206e 756d 7661 7273 2061  , then numvars a
+00023600: 6e64 2074 6865 6e20 6c65 6674 6f76 6572  nd then leftover
+00023610: 7661 7273 0a20 2020 206c 6566 746f 7665  vars.    leftove
+00023620: 7276 6172 7320 3d20 6c65 6674 5f73 7562  rvars = left_sub
+00023630: 7472 6163 7428 585f 7472 6169 6e2e 636f  tract(X_train.co
+00023640: 6c75 6d6e 732c 6361 7476 6172 732b 6e6c  lumns,catvars+nl
+00023650: 7076 6172 732b 6461 7465 7661 7273 2b6e  pvars+datevars+n
+00023660: 756d 7661 7273 2b64 6973 6372 6574 6576  umvars+discretev
+00023670: 6172 7329 0a20 2020 2069 6620 7665 7262  ars).    if verb
+00023680: 6f73 653a 0a20 2020 2020 2020 2069 6620  ose:.        if 
+00023690: 6c65 6674 6f76 6572 7661 7273 3a0a 2020  leftovervars:.  
+000236a0: 2020 2020 2020 2020 2020 7072 696e 7428            print(
+000236b0: 2720 2020 2072 656d 6169 6e69 6e67 2076  '    remaining v
+000236c0: 6172 7320 2573 2061 7265 2069 6e20 2573  ars %s are in %s
+000236d0: 2073 7461 7475 7320 6279 2074 7261 6e73   status by trans
+000236e0: 666f 726d 6572 732e 2e2e 2720 2528 6c65  formers...' %(le
+000236f0: 6674 6f76 6572 7661 7273 2c20 7265 6d61  ftovervars, rema
+00023700: 696e 6465 7229 290a 2020 2020 2020 2020  inder)).        
+00023710: 656c 7365 3a0a 2020 2020 2020 2020 2020  else:.          
+00023720: 2020 7072 696e 7428 2720 2020 206e 6f20    print('    no 
+00023730: 6f74 6865 7220 7661 7273 206c 6566 7420  other vars left 
+00023740: 696e 2064 6174 6173 6574 2074 6f20 7472  in dataset to tr
+00023750: 616e 7366 6f72 6d2e 2e2e 2729 0a20 2020  ansform...').   
+00023760: 2023 2323 206e 6f77 2077 6520 6372 6561   ### now we crea
+00023770: 7465 206e 616d 6573 2066 6f72 2074 6865  te names for the
+00023780: 2076 6172 6961 626c 6573 2074 7261 6e73   variables trans
+00023790: 666f 726d 6564 2062 7920 4e4c 5020 696e  formed by NLP in
+000237a0: 746f 2061 2066 756e 6374 696f 6e20 6361  to a function ca
+000237b0: 6c6c 6564 206e 6c70 5f63 6f6c 0a20 2020  lled nlp_col.   
+000237c0: 2070 6172 616d 7320 3d20 7b22 6e6c 7076   params = {"nlpv
+000237d0: 6172 7322 3a20 6e6c 7076 6172 732c 0a20  ars": nlpvars,. 
+000237e0: 2020 2020 2020 2020 2022 6361 7476 6172           "catvar
+000237f0: 7322 3a20 6361 7476 6172 732c 0a20 2020  s": catvars,.   
+00023800: 2020 2020 2020 2022 6469 7363 7265 7465         "discrete
+00023810: 7661 7273 223a 2064 6973 6372 6574 6576  vars": discretev
+00023820: 6172 732c 0a20 2020 2020 2020 2020 2022  ars,.          "
+00023830: 666c 6f61 7476 6172 7322 3a20 666c 6f61  floatvars": floa
+00023840: 7476 6172 732c 0a20 2020 2020 2020 2020  tvars,.         
+00023850: 2022 696e 7476 6172 7322 3a20 696e 7476   "intvars": intv
+00023860: 6172 732c 0a20 2020 2020 2020 2020 2022  ars,.          "
+00023870: 6461 7465 7661 7273 223a 2064 6174 6576  datevars": datev
+00023880: 6172 732c 0a20 2020 2020 2020 2020 2022  ars,.          "
+00023890: 6f6e 6568 6f74 5f64 6963 7422 3a20 6f6e  onehot_dict": on
+000238a0: 6568 6f74 5f64 6963 742c 0a20 2020 2020  ehot_dict,.     
+000238b0: 2020 2020 2022 636f 6c73 697a 655f 6469       "colsize_di
+000238c0: 6374 223a 636f 6c73 697a 655f 6469 6374  ct":colsize_dict
+000238d0: 2c0a 2020 2020 2020 2020 2020 2264 6174  ,.          "dat
+000238e0: 6573 697a 655f 6469 6374 223a 6461 7465  esize_dict":date
+000238f0: 7369 7a65 5f64 6963 747d 0a20 2020 2023  size_dict}.    #
+00023900: 2323 2043 7265 6174 6520 6120 4675 6e63  ## Create a Func
+00023910: 7469 6f6e 2075 7369 6e67 2074 6865 2061  tion using the a
+00023920: 626f 7665 2066 756e 6374 696f 6e20 746f  bove function to
+00023930: 2074 7261 6e73 666f 726d 2069 6e20 7069   transform in pi
+00023940: 7065 6c69 6e65 7320 2323 230a 2020 2020  pelines ###.    
+00023950: 0a20 2020 2069 6620 6261 7369 635f 656e  .    if basic_en
+00023960: 636f 6465 7220 6e6f 7420 696e 206f 6e65  coder not in one
+00023970: 686f 745f 7479 7065 5f65 6e63 6f64 6572  hot_type_encoder
+00023980: 7320 616e 6420 656e 636f 6465 7220 6e6f  s and encoder no
+00023990: 7420 696e 206f 6e65 686f 745f 7479 7065  t in onehot_type
+000239a0: 5f65 6e63 6f64 6572 733a 0a20 2020 2020  _encoders:.     
+000239b0: 2020 206e 6c70 5f70 6970 6520 3d20 5069     nlp_pipe = Pi
+000239c0: 7065 6c69 6e65 285b 2827 4e4c 5027 2c20  peline([('NLP', 
+000239d0: 4675 6e63 7469 6f6e 5472 616e 7366 6f72  FunctionTransfor
+000239e0: 6d65 7228 6372 6561 7465 5f63 6f6c 756d  mer(create_colum
+000239f0: 6e5f 6e61 6d65 732c 206b 775f 6172 6773  n_names, kw_args
+00023a00: 3d70 6172 616d 7329 295d 290a 2020 2020  =params))]).    
+00023a10: 656c 7365 3a0a 2020 2020 2020 2020 2323  else:.        ##
+00023a20: 2320 5573 6520 7468 6520 6f6e 652d 686f  # Use the one-ho
+00023a30: 7420 616e 7977 6179 2073 696e 6365 206d  t anyway since m
+00023a40: 6f73 7420 6f66 2074 6865 2074 696d 6573  ost of the times
+00023a50: 2c20 796f 7520 7769 6c6c 2062 6520 646f  , you will be do
+00023a60: 696e 6720 6f6e 652d 686f 7420 656e 636f  ing one-hot enco
+00023a70: 6469 6e67 2023 2323 0a20 2020 2020 2020  ding ###.       
+00023a80: 206e 6c70 5f70 6970 6520 3d20 5069 7065   nlp_pipe = Pipe
+00023a90: 6c69 6e65 285b 2827 4e4c 5027 2c20 4675  line([('NLP', Fu
+00023aa0: 6e63 7469 6f6e 5472 616e 7366 6f72 6d65  nctionTransforme
+00023ab0: 7228 6372 6561 7465 5f63 6f6c 756d 6e5f  r(create_column_
+00023ac0: 6e61 6d65 735f 6f6e 6568 6f74 2c20 6b77  names_onehot, kw
+00023ad0: 5f61 7267 733d 7061 7261 6d73 2929 5d29  _args=params))])
+00023ae0: 0a20 2020 200a 2020 2020 2323 2323 2043  .    .    #### C
+00023af0: 6861 696e 2069 7420 746f 6765 7468 6572  hain it together
+00023b00: 2069 6e20 7468 6520 6162 6f76 6520 7069   in the above pi
+00023b10: 7065 6c69 6e65 2023 2323 2323 2323 2323  peline #########
+00023b20: 0a20 2020 2064 6174 615f 7069 7065 203d  .    data_pipe =
+00023b30: 2050 6970 656c 696e 6528 5b28 2773 6361   Pipeline([('sca
+00023b40: 6c65 725f 7069 7065 6c69 6e65 272c 2073  ler_pipeline', s
+00023b50: 6361 6c65 725f 7069 7065 292c 2028 276e  caler_pipe), ('n
+00023b60: 6c70 5f70 6970 656c 696e 6527 2c20 6e6c  lp_pipeline', nl
+00023b70: 705f 7069 7065 295d 290a 2020 2020 0a20  p_pipe)]).    . 
+00023b80: 2020 2023 2323 2323 2323 2323 2323 2323     #############
+00023b90: 2323 2323 2323 2323 2323 2323 2323 2323  ################
+00023ba0: 2323 2323 2323 2323 2323 2323 2323 230a  ###############.
+00023bb0: 2020 2020 2323 2323 2320 2020 2053 2041      #####    S A
+00023bc0: 2056 2045 2020 2050 2049 2050 2045 204c   V E   P I P E L
+00023bd0: 2049 204e 2045 2020 2323 2323 2323 2323   I N E  ########
+00023be0: 0a20 2020 2023 2323 2073 6176 6520 7468  .    ### save th
+00023bf0: 6520 6d6f 6465 6c20 616e 6420 6f72 2070  e model and or p
+00023c00: 6970 656c 696e 6520 6865 7265 2023 2323  ipeline here ###
+00023c10: 230a 2020 2020 2323 2323 2323 2323 2323  #.    ##########
+00023c20: 2323 2323 2323 2323 2323 2323 2323 2323  ################
+00023c30: 2323 2323 2323 2323 2323 2323 2323 2323  ################
+00023c40: 2323 0a20 2020 2023 2073 6176 6520 7468  ##.    # save th
+00023c50: 6520 6d6f 6465 6c20 746f 2064 6973 6b20  e model to disk 
+00023c60: 6f6e 6c79 2069 6620 7361 7665 2066 6c61  only if save fla
+00023c70: 6720 6973 2073 6574 2074 6f20 5472 7565  g is set to True
+00023c80: 2023 230a 2020 2020 6966 2073 6176 655f   ##.    if save_
+00023c90: 666c 6167 3a0a 2020 2020 2020 2020 6669  flag:.        fi
+00023ca0: 6c65 6e61 6d65 203d 2027 4c61 7a79 5472  lename = 'LazyTr
+00023cb0: 616e 7366 6f72 6d65 725f 7069 7065 6c69  ansformer_pipeli
+00023cc0: 6e65 2e70 6b6c 270a 2020 2020 2020 2020  ne.pkl'.        
+00023cd0: 7072 696e 7428 2720 2020 2044 6174 6120  print('    Data 
+00023ce0: 7069 7065 6c69 6e65 2069 7320 7361 7665  pipeline is save
+00023cf0: 6420 6173 3a20 2573 2069 6e20 6375 7272  d as: %s in curr
+00023d00: 656e 7420 776f 726b 696e 6720 6469 7265  ent working dire
+00023d10: 6374 6f72 792e 2720 2566 696c 656e 616d  ctory.' %filenam
+00023d20: 6529 0a20 2020 2020 2020 2070 6963 6b6c  e).        pickl
+00023d30: 652e 6475 6d70 2864 6174 615f 7069 7065  e.dump(data_pipe
+00023d40: 2c20 6f70 656e 2866 696c 656e 616d 652c  , open(filename,
+00023d50: 2027 7762 2729 290a 2020 2020 6469 6666   'wb')).    diff
+00023d60: 7469 6d65 203d 206d 6178 2831 2c20 696e  time = max(1, in
+00023d70: 7428 7469 6d65 2e74 696d 6528 292d 7374  t(time.time()-st
+00023d80: 6172 745f 7469 6d65 2929 0a20 2020 2070  art_time)).    p
+00023d90: 7269 6e74 2827 5469 6d65 2074 616b 656e  rint('Time taken
+00023da0: 2074 6f20 6465 6669 6e65 2064 6174 6120   to define data 
+00023db0: 7069 7065 6c69 6e65 203d 2025 7320 7365  pipeline = %s se
+00023dc0: 636f 6e64 2873 2927 2025 6469 6666 7469  cond(s)' %diffti
+00023dd0: 6d65 290a 2020 2020 7265 7475 726e 2064  me).    return d
+00023de0: 6174 615f 7069 7065 0a23 2323 2323 2323  ata_pipe.#######
+00023df0: 2323 2323 2323 2323 2323 2323 2323 2323  ################
+00023e00: 2323 2323 2323 2323 2323 2323 2323 2323  ################
+00023e10: 2323 2323 2323 2323 2323 2323 2323 2323  ################
+00023e20: 2323 2323 2323 2323 2323 2323 2323 2323  ################
+00023e30: 2323 2323 2323 2323 2323 2323 2323 230a  ###############.
+00023e40: 2367 6976 6573 2066 6974 5f74 7261 6e73  #gives fit_trans
+00023e50: 666f 726d 206d 6574 686f 6420 666f 7220  form method for 
+00023e60: 6672 6565 0a66 726f 6d20 736b 6c65 6172  free.from sklear
+00023e70: 6e2e 6261 7365 2069 6d70 6f72 7420 5472  n.base import Tr
+00023e80: 616e 7366 6f72 6d65 724d 6978 696e 200a  ansformerMixin .
+00023e90: 636c 6173 7320 4d79 5469 6666 2854 7261  class MyTiff(Tra
+00023ea0: 6e73 666f 726d 6572 4d69 7869 6e29 3a0a  nsformerMixin):.
+00023eb0: 2020 2020 6465 6620 5f5f 696e 6974 5f5f      def __init__
+00023ec0: 2873 656c 662c 202a 6172 6773 2c20 2a2a  (self, *args, **
+00023ed0: 6b77 6172 6773 293a 0a20 2020 2020 2020  kwargs):.       
+00023ee0: 2073 656c 662e 656e 636f 6465 7220 3d20   self.encoder = 
+00023ef0: 5466 6964 6656 6563 746f 7269 7a65 7228  TfidfVectorizer(
+00023f00: 2a61 7267 732c 202a 2a6b 7761 7267 7329  *args, **kwargs)
+00023f10: 0a20 2020 2064 6566 2066 6974 2873 656c  .    def fit(sel
+00023f20: 662c 2078 2c20 793d 4e6f 6e65 293a 0a20  f, x, y=None):. 
+00023f30: 2020 2020 2020 2073 656c 662e 656e 636f         self.enco
+00023f40: 6465 722e 6669 7428 7829 0a20 2020 2020  der.fit(x).     
+00023f50: 2020 2072 6574 7572 6e20 7365 6c66 0a20     return self. 
+00023f60: 2020 2064 6566 2074 7261 6e73 666f 726d     def transform
+00023f70: 2873 656c 662c 2078 2c20 793d 4e6f 6e65  (self, x, y=None
+00023f80: 293a 0a20 2020 2020 2020 2072 6574 7572  ):.        retur
+00023f90: 6e20 7365 6c66 2e65 6e63 6f64 6572 2e74  n self.encoder.t
+00023fa0: 7261 6e73 666f 726d 2878 290a 2323 2323  ransform(x).####
 00023fb0: 2323 2323 2323 2323 2323 2323 2323 2323  ################
-00023fc0: 230a 2020 2020 2320 4352 4541 5445 206f  #.    # CREATE o
-00023fd0: 6e65 5f64 696d 2054 5241 4e53 464f 524d  ne_dim TRANSFORM
-00023fe0: 4552 2069 6e20 6f72 6465 7220 746f 2066  ER in order to f
-00023ff0: 6974 2062 6574 7765 656e 2069 6d70 7574  it between imput
-00024000: 6572 2061 6e64 2054 4669 4446 2066 6f72  er and TFiDF for
-00024010: 204e 4c50 2068 6572 6520 2323 230a 2020   NLP here ###.  
-00024020: 2020 2323 2323 2323 2323 2323 2323 2323    ##############
-00024030: 2323 2323 2323 2323 2323 2323 2323 2323  ################
+00023fc0: 2323 2323 2323 2323 2323 2323 2323 2323  ################
+00023fd0: 2323 2323 2323 2323 2323 2323 2323 2323  ################
+00023fe0: 2323 2323 2323 2323 2323 2323 2323 2323  ################
+00023ff0: 2323 2323 0a69 6d70 6f72 7420 7265 0a63  ####.import re.c
+00024000: 6c61 7373 204c 617a 7954 7261 6e73 666f  lass LazyTransfo
+00024010: 726d 6572 2854 7261 6e73 666f 726d 6572  rmer(Transformer
+00024020: 4d69 7869 6e29 3a0a 2020 2020 2222 220a  Mixin):.    """.
+00024030: 2020 2020 2323 2323 2323 2323 2323 2323      ############
 00024040: 2323 2323 2323 2323 2323 2323 2323 2323  ################
 00024050: 2323 2323 2323 2323 2323 2323 2323 2323  ################
 00024060: 2323 2323 2323 2323 2323 2323 2323 2323  ################
-00024070: 2323 2323 2323 0a20 2020 206f 6e65 5f64  ######.    one_d
-00024080: 696d 203d 204d 616b 6532 4428 696d 705f  im = Make2D(imp_
-00024090: 6d69 7373 696e 6729 0a20 2020 2072 656d  missing).    rem
-000240a0: 6f76 655f 7370 6563 6961 6c5f 6368 6172  ove_special_char
-000240b0: 7320 3d20 206c 616d 6264 6120 783a 7265  s =  lambda x:re
-000240c0: 2e73 7562 2827 5b5e 412d 5a61 2d7a 302d  .sub('[^A-Za-z0-
-000240d0: 395f 5d2b 272c 2027 2027 2c20 7829 0a20  9_]+', ' ', x). 
-000240e0: 2020 2063 6f6c 7369 7a65 5f64 6963 7420     colsize_dict 
-000240f0: 3d20 7b7d 0a20 2020 2023 2320 6e75 6d62  = {}.    ## numb
-00024100: 6572 206f 6620 636f 6d70 6f6e 656e 7473  er of components
-00024110: 2069 6e20 5356 4420 2323 2323 0a20 2020   in SVD ####.   
-00024120: 2069 6620 6c65 6e28 6e6c 7076 6172 7329   if len(nlpvars)
-00024130: 203e 2030 3a0a 2020 2020 2020 2020 636f   > 0:.        co
-00024140: 7079 5f6e 6c70 7320 3d20 636f 7079 2e64  py_nlps = copy.d
-00024150: 6565 7063 6f70 7928 6e6c 7076 6172 7329  eepcopy(nlpvars)
-00024160: 0a20 2020 2020 2020 206e 756e 6971 7565  .        nunique
-00024170: 7320 3d20 5b5d 0a20 2020 2020 2020 2066  s = [].        f
-00024180: 6f72 2065 6163 685f 6e6c 7020 696e 2063  or each_nlp in c
-00024190: 6f70 795f 6e6c 7073 3a0a 2020 2020 2020  opy_nlps:.      
-000241a0: 2020 2020 2020 6e75 6e69 7175 6573 2e61        nuniques.a
-000241b0: 7070 656e 6428 696e 7428 6d61 7828 322c  ppend(int(max(2,
-000241c0: 2033 2a6e 702e 6c6f 6732 2858 5f74 7261   3*np.log2(X_tra
-000241d0: 696e 5b65 6163 685f 6e6c 705d 2e6e 756e  in[each_nlp].nun
-000241e0: 6971 7565 2829 2929 2929 0a20 2020 2020  ique())))).     
-000241f0: 2020 2023 2323 2320 6669 6e64 2074 6865     #### find the
-00024200: 206d 696e 2061 6e64 2073 6574 2074 6865   min and set the
-00024210: 2054 4649 4446 2066 6f72 2074 6861 7420   TFIDF for that 
-00024220: 736d 616c 6c65 7374 204e 4c50 2076 6172  smallest NLP var
-00024230: 6961 626c 6520 2323 2323 2323 2323 2020  iable ########  
-00024240: 2020 2020 2020 2020 2020 0a20 2020 2020            .     
-00024250: 2020 2074 6f70 5f6e 203d 206e 702e 6d69     top_n = np.mi
-00024260: 6e28 6e75 6e69 7175 6573 290a 2020 2020  n(nuniques).    
-00024270: 2020 2020 746f 705f 6e20 3d20 696e 7428      top_n = int(
-00024280: 6d69 6e28 3330 2c20 746f 705f 6e2a 302e  min(30, top_n*0.
-00024290: 3129 290a 2020 2020 2020 2020 7376 645f  1)).        svd_
-000242a0: 6e5f 6974 6572 203d 2069 6e74 286d 696e  n_iter = int(min
-000242b0: 2831 302c 2074 6f70 5f6e 2a30 2e31 2929  (10, top_n*0.1))
-000242c0: 0a20 2020 2020 2020 2069 6620 7665 7262  .        if verb
-000242d0: 6f73 653a 0a20 2020 2020 2020 2020 2020  ose:.           
-000242e0: 2070 7269 6e74 2827 2020 2020 2564 2063   print('    %d c
-000242f0: 6f6d 706f 6e65 6e74 7320 6368 6f73 656e  omponents chosen
-00024300: 2066 6f72 2054 7275 6e63 6174 6564 5356   for TruncatedSV
-00024310: 4428 6e5f 6974 6572 3d25 6429 2061 6674  D(n_iter=%d) aft
-00024320: 6572 2054 4649 4446 2720 2528 746f 705f  er TFIDF' %(top_
-00024330: 6e2c 2073 7664 5f6e 5f69 7465 7229 290a  n, svd_n_iter)).
-00024340: 2020 2020 2020 2020 2323 2323 2323 2323          ########
-00024350: 2323 2323 2320 2020 5468 6973 2069 7320  #####   This is 
-00024360: 7768 6572 6520 7765 2073 6574 2064 6566  where we set def
-00024370: 6175 6c74 7320 666f 7220 4e4c 5020 7472  aults for NLP tr
-00024380: 616e 7366 6f72 6d65 7273 2023 2323 2323  ansformers #####
-00024390: 2323 2323 230a 2020 2020 2020 2020 6966  #####.        if
-000243a0: 2058 5f74 7261 696e 2e73 6861 7065 5b30   X_train.shape[0
-000243b0: 5d20 3e3d 2031 3030 3030 303a 0a20 2020  ] >= 100000:.   
-000243c0: 2020 2020 2020 2020 2074 6966 6664 203d           tiffd =
-000243d0: 2054 6669 6466 5665 6374 6f72 697a 6572   TfidfVectorizer
-000243e0: 2873 7472 6970 5f61 6363 656e 7473 3d27  (strip_accents='
-000243f0: 756e 6963 6f64 6527 2c6d 6178 5f66 6561  unicode',max_fea
-00024400: 7475 7265 733d 3630 3030 2c20 7072 6570  tures=6000, prep
-00024410: 726f 6365 7373 6f72 3d72 656d 6f76 655f  rocessor=remove_
-00024420: 7370 6563 6961 6c5f 6368 6172 7329 0a20  special_chars). 
-00024430: 2020 2020 2020 2065 6c69 6620 585f 7472         elif X_tr
-00024440: 6169 6e2e 7368 6170 655b 305d 203e 3d20  ain.shape[0] >= 
-00024450: 3130 3030 303a 0a20 2020 2020 2020 2020  10000:.         
-00024460: 2020 2023 7469 6666 6420 3d20 436f 756e     #tiffd = Coun
-00024470: 7456 6563 746f 7269 7a65 7228 7374 7269  tVectorizer(stri
-00024480: 705f 6163 6365 6e74 733d 2775 6e69 636f  p_accents='unico
-00024490: 6465 272c 6d61 785f 6665 6174 7572 6573  de',max_features
-000244a0: 3d31 3030 3029 0a20 2020 2020 2020 2020  =1000).         
-000244b0: 2020 2074 6966 6664 203d 2054 6669 6466     tiffd = Tfidf
-000244c0: 5665 6374 6f72 697a 6572 2873 7472 6970  Vectorizer(strip
-000244d0: 5f61 6363 656e 7473 3d27 756e 6963 6f64  _accents='unicod
-000244e0: 6527 2c6d 6178 5f66 6561 7475 7265 733d  e',max_features=
-000244f0: 3330 3030 2c20 7072 6570 726f 6365 7373  3000, preprocess
-00024500: 6f72 3d72 656d 6f76 655f 7370 6563 6961  or=remove_specia
-00024510: 6c5f 6368 6172 7329 0a20 2020 2020 2020  l_chars).       
-00024520: 2020 2020 2023 7469 6666 6420 3d20 4d79       #tiffd = My
-00024530: 5469 6666 2873 7472 6970 5f61 6363 656e  Tiff(strip_accen
-00024540: 7473 3d27 756e 6963 6f64 6527 2c6d 6178  ts='unicode',max
-00024550: 5f66 6561 7475 7265 733d 3330 302c 206d  _features=300, m
-00024560: 696e 5f64 663d 302e 3031 290a 2020 2020  in_df=0.01).    
-00024570: 2020 2020 656c 7365 3a0a 2020 2020 2020      else:.      
-00024580: 2020 2020 2020 2376 6563 7420 3d20 436f        #vect = Co
-00024590: 756e 7456 6563 746f 7269 7a65 7228 7374  untVectorizer(st
-000245a0: 7269 705f 6163 6365 6e74 733d 2775 6e69  rip_accents='uni
-000245b0: 636f 6465 272c 6d61 785f 6665 6174 7572  code',max_featur
-000245c0: 6573 3d31 3030 290a 2020 2020 2020 2020  es=100).        
-000245d0: 2020 2020 7469 6666 6420 3d20 5466 6964      tiffd = Tfid
-000245e0: 6656 6563 746f 7269 7a65 7228 7374 7269  fVectorizer(stri
-000245f0: 705f 6163 6365 6e74 733d 2775 6e69 636f  p_accents='unico
-00024600: 6465 272c 6d61 785f 6665 6174 7572 6573  de',max_features
-00024610: 3d31 3030 302c 2070 7265 7072 6f63 6573  =1000, preproces
-00024620: 736f 723d 7265 6d6f 7665 5f73 7065 6369  sor=remove_speci
-00024630: 616c 5f63 6861 7273 290a 2020 2020 2020  al_chars).      
-00024640: 2020 2020 2020 2374 6966 6664 203d 204d        #tiffd = M
-00024650: 7954 6966 6628 7374 7269 705f 6163 6365  yTiff(strip_acce
-00024660: 6e74 733d 2775 6e69 636f 6465 272c 6d61  nts='unicode',ma
-00024670: 785f 6665 6174 7572 6573 3d33 3030 2c20  x_features=300, 
-00024680: 6d69 6e5f 6466 3d30 2e30 3129 0a20 2020  min_df=0.01).   
-00024690: 2020 2020 2023 2323 2063 7265 6174 6520       ### create 
-000246a0: 6120 6e65 7720 7069 7065 6c69 6e65 2077  a new pipeline w
-000246b0: 6974 6820 6669 6c6c 696e 6720 7769 7468  ith filling with
-000246c0: 2063 6f6e 7374 616e 7420 6d69 7373 696e   constant missin
-000246d0: 6720 2323 0a20 2020 2020 2020 2074 7376  g ##.        tsv
-000246e0: 6420 3d20 5472 756e 6361 7465 6453 5644  d = TruncatedSVD
-000246f0: 286e 5f63 6f6d 706f 6e65 6e74 733d 746f  (n_components=to
-00024700: 705f 6e2c 206e 5f69 7465 723d 7376 645f  p_n, n_iter=svd_
-00024710: 6e5f 6974 6572 2c20 7261 6e64 6f6d 5f73  n_iter, random_s
-00024720: 7461 7465 3d33 290a 2020 2020 2020 2020  tate=3).        
-00024730: 7665 6374 203d 2050 6970 656c 696e 6528  vect = Pipeline(
-00024740: 5b28 276d 616b 655f 6f6e 655f 6469 6d27  [('make_one_dim'
-00024750: 2c20 6f6e 655f 6469 6d29 2c20 2827 6d61  , one_dim), ('ma
-00024760: 6b65 5f74 6669 6466 5f70 6970 656c 696e  ke_tfidf_pipelin
-00024770: 6527 2c20 7469 6666 6429 2c20 2827 7472  e', tiffd), ('tr
-00024780: 756e 6361 7465 645f 7376 6427 2c20 7473  uncated_svd', ts
-00024790: 7664 295d 290a 2020 2020 2020 2020 2376  vd)]).        #v
-000247a0: 6563 7420 3d20 6d61 6b65 5f70 6970 656c  ect = make_pipel
-000247b0: 696e 6528 6f6e 655f 6469 6d2c 2074 6966  ine(one_dim, tif
-000247c0: 6664 2c20 7473 7664 290a 2020 2020 2020  fd, tsvd).      
-000247d0: 2020 2323 2320 5369 6d69 6c61 726c 7920    ### Similarly 
-000247e0: 796f 7520 6e65 6564 2074 6f20 6372 6561  you need to crea
-000247f0: 7465 2061 2066 756e 6374 696f 6e20 7468  te a function th
-00024800: 6174 2063 6f6e 7665 7274 7320 616c 6c20  at converts all 
-00024810: 4e4c 5020 636f 6c75 6d6e 7320 746f 2073  NLP columns to s
-00024820: 7472 696e 6720 6265 666f 7265 2066 6565  tring before fee
-00024830: 6469 6e67 2074 6f20 436f 756e 7456 6563  ding to CountVec
-00024840: 746f 7269 7a65 720a 2020 2020 2020 2020  torizer.        
-00024850: 6368 616e 6765 5f63 6f6c 5f74 6f5f 7374  change_col_to_st
-00024860: 7269 6e67 5f66 756e 6320 3d20 4675 6e63  ring_func = Func
-00024870: 7469 6f6e 5472 616e 7366 6f72 6d65 7228  tionTransformer(
-00024880: 6368 616e 6765 5f63 6f6c 5f74 6f5f 7374  change_col_to_st
-00024890: 7269 6e67 290a 2020 2020 2020 2020 2323  ring).        ##
-000248a0: 2320 7765 2074 7279 2074 6f20 6669 6e64  # we try to find
-000248b0: 2074 6865 2063 6f6c 756d 6e73 2063 7265   the columns cre
-000248c0: 6174 6564 2062 7920 636f 756e 7474 7665  ated by counttve
-000248d0: 6374 6f72 697a 6572 2023 2323 0a20 2020  ctorizer ###.   
-000248e0: 2020 2020 2063 6f70 795f 6e6c 705f 7661       copy_nlp_va
-000248f0: 7273 203d 2063 6f70 792e 6465 6570 636f  rs = copy.deepco
-00024900: 7079 286e 6c70 7661 7273 290a 2020 2020  py(nlpvars).    
-00024910: 2020 2020 666f 7220 6561 6368 5f6e 6c70      for each_nlp
-00024920: 2069 6e20 636f 7079 5f6e 6c70 5f76 6172   in copy_nlp_var
-00024930: 733a 0a20 2020 2020 2020 2020 2020 2063  s:.            c
-00024940: 6f6c 7369 7a65 203d 2076 6563 742e 6669  olsize = vect.fi
-00024950: 745f 7472 616e 7366 6f72 6d28 585f 7472  t_transform(X_tr
-00024960: 6169 6e5b 6561 6368 5f6e 6c70 5d29 2e73  ain[each_nlp]).s
-00024970: 6861 7065 5b31 5d0a 2020 2020 2020 2020  hape[1].        
-00024980: 2020 2020 636f 6c73 697a 655f 6469 6374      colsize_dict
-00024990: 5b65 6163 685f 6e6c 705d 203d 2063 6f6c  [each_nlp] = col
-000249a0: 7369 7a65 0a20 2020 2020 2020 2023 2323  size.        ###
-000249b0: 2323 2077 6520 636f 6c6c 6563 7420 7468  ## we collect th
-000249c0: 6520 636f 6c75 6d6e 2073 697a 6520 6f66  e column size of
-000249d0: 2065 6163 6820 6e6c 7020 7661 7269 6162   each nlp variab
-000249e0: 6c65 2061 6e64 2066 6565 6420 6974 2074  le and feed it t
-000249f0: 6f20 7665 6374 5f6f 6e65 2023 230a 2020  o vect_one ##.  
-00024a00: 2020 2020 2020 2376 6563 745f 6f6e 6520        #vect_one 
-00024a10: 3d20 6d61 6b65 5f70 6970 656c 696e 6528  = make_pipeline(
-00024a20: 6368 616e 6765 5f63 6f6c 5f74 6f5f 7374  change_col_to_st
-00024a30: 7269 6e67 5f66 756e 632c 2076 6563 7429  ring_func, vect)
-00024a40: 0a20 2020 2020 2020 2076 6563 745f 6f6e  .        vect_on
-00024a50: 6520 3d20 5069 7065 6c69 6e65 285b 2827  e = Pipeline([('
-00024a60: 6368 616e 6765 5f63 6f6c 5f74 6f5f 7374  change_col_to_st
-00024a70: 7269 6e67 272c 2063 6861 6e67 655f 636f  ring', change_co
-00024a80: 6c5f 746f 5f73 7472 696e 675f 6675 6e63  l_to_string_func
-00024a90: 292c 2028 2774 6669 6466 5f74 7376 645f  ), ('tfidf_tsvd_
-00024aa0: 7069 7065 6c69 6e65 272c 2076 6563 7429  pipeline', vect)
-00024ab0: 5d29 0a20 2020 2023 2323 2320 4e6f 7720  ]).    #### Now 
-00024ac0: 6372 6561 7465 2061 2066 756e 6374 696f  create a functio
-00024ad0: 6e20 7468 6174 2063 7265 6174 6573 2074  n that creates t
-00024ae0: 696d 6520 7365 7269 6573 2066 6561 7475  ime series featu
-00024af0: 7265 7320 2323 2323 2323 2323 230a 2020  res #########.  
-00024b00: 2020 6372 6561 7465 5f74 735f 6665 6174    create_ts_feat
-00024b10: 7572 6573 5f66 756e 6320 3d20 4675 6e63  ures_func = Func
-00024b20: 7469 6f6e 5472 616e 7366 6f72 6d65 7228  tionTransformer(
-00024b30: 5f63 7265 6174 655f 7473 5f66 6561 7475  _create_ts_featu
-00024b40: 7265 7329 0a20 2020 2023 2323 2320 7765  res).    #### we
-00024b50: 206e 6565 6420 746f 2074 6865 2073 616d   need to the sam
-00024b60: 6520 666f 7220 6461 7465 2d76 6172 7320  e for date-vars 
-00024b70: 2323 2323 2323 2323 230a 2020 2020 636f  #########.    co
-00024b80: 7079 5f64 6174 655f 7661 7273 203d 2063  py_date_vars = c
-00024b90: 6f70 792e 6465 6570 636f 7079 2864 6174  opy.deepcopy(dat
-00024ba0: 6576 6172 7329 0a20 2020 2064 6174 6573  evars).    dates
-00024bb0: 697a 655f 6469 6374 203d 207b 7d0a 2020  ize_dict = {}.  
-00024bc0: 2020 666f 7220 6561 6368 5f64 6174 6563    for each_datec
-00024bd0: 6f6c 2069 6e20 636f 7079 5f64 6174 655f  ol in copy_date_
-00024be0: 7661 7273 3a0a 2020 2020 2020 2020 6474  vars:.        dt
-00024bf0: 7820 3d20 6372 6561 7465 5f74 735f 6665  x = create_ts_fe
-00024c00: 6174 7572 6573 5f66 756e 632e 6669 745f  atures_func.fit_
-00024c10: 7472 616e 7366 6f72 6d28 585f 7472 6169  transform(X_trai
-00024c20: 6e5b 6561 6368 5f64 6174 6563 6f6c 5d29  n[each_datecol])
-00024c30: 0a20 2020 2020 2020 2064 6174 6573 697a  .        datesiz
-00024c40: 655f 6469 6374 5b65 6163 685f 6461 7465  e_dict[each_date
-00024c50: 636f 6c5d 203d 2064 7478 2e63 6f6c 756d  col] = dtx.colum
-00024c60: 6e73 2e74 6f6c 6973 7428 290a 2020 2020  ns.tolist().    
-00024c70: 2020 2020 6465 6c20 6474 780a 2020 2020      del dtx.    
-00024c80: 2323 2323 204e 6f77 2077 6520 6372 6561  #### Now we crea
-00024c90: 7465 2061 2070 6970 656c 696e 6520 666f  te a pipeline fo
-00024ca0: 7220 6461 7465 2d74 696d 6520 6665 6174  r date-time feat
-00024cb0: 7572 6573 2061 7320 7765 6c6c 2023 2323  ures as well ###
-00024cc0: 230a 2020 2020 6f6c 6220 3d20 4f72 6469  #.    olb = Ordi
-00024cd0: 6e61 6c45 6e63 6f64 6572 2829 0a20 2020  nalEncoder().   
-00024ce0: 206d 6b5f 6461 7465 7320 3d20 5069 7065   mk_dates = Pipe
-00024cf0: 6c69 6e65 285b 2827 6461 7465 5f74 696d  line([('date_tim
-00024d00: 655f 6665 6174 7572 6573 272c 2063 7265  e_features', cre
-00024d10: 6174 655f 7473 5f66 6561 7475 7265 735f  ate_ts_features_
-00024d20: 6675 6e63 292c 2028 276f 7264 696e 616c  func), ('ordinal
-00024d30: 5f65 6e63 6f64 6572 272c 206f 6c62 295d  _encoder', olb)]
-00024d40: 290a 2020 2020 2323 2323 2323 2323 2323  ).    ##########
-00024d50: 2323 2323 2323 2323 2323 2323 2323 2323  ################
-00024d60: 2323 2323 2323 2323 2323 2323 2323 2323  ################
-00024d70: 2323 2323 2323 2323 2323 2323 2323 2323  ################
-00024d80: 2323 2323 2323 2323 2323 2323 2323 2323  ################
-00024d90: 2323 2323 2323 2323 2323 0a20 2020 2023  ##########.    #
-00024da0: 2323 2323 2320 2020 2020 4320 4120 5420  #####     C A T 
-00024db0: 4520 4720 4f20 5220 4920 4320 4120 4c20  E G O R I C A L 
-00024dc0: 2020 2045 204e 2043 204f 2044 2045 2052     E N C O D E R
-00024dd0: 2053 2020 2020 4820 4520 5220 4520 2323   S    H E R E ##
-00024de0: 2323 2323 2323 2323 2323 2323 2323 2323  ################
-00024df0: 2323 230a 2020 2020 2323 2323 2323 2020  ###.    ######  
-00024e00: 2020 2077 6520 6e65 6564 2074 6f20 6372     we need to cr
-00024e10: 6561 7465 2075 6e69 7175 6520 636f 6c75  eate unique colu
-00024e20: 6d6e 206e 616d 6573 2066 6f72 206f 6e65  mn names for one
-00024e30: 2068 6f74 2076 6172 6961 626c 6573 2020   hot variables  
-00024e40: 2020 2323 2323 2323 2323 2323 0a20 2020    ##########.   
-00024e50: 2023 2323 2323 2323 2323 2323 2323 2323   ###############
-00024e60: 2323 2323 2323 2323 2323 2323 2323 2323  ################
-00024e70: 2323 2323 2323 2323 2323 2323 2323 2323  ################
-00024e80: 2323 2323 2323 2323 2323 2323 2323 2323  ################
-00024e90: 2323 2323 2323 2323 2323 2323 2323 2323  ################
-00024ea0: 2323 2323 230a 2020 2020 636f 7079 5f63  #####.    copy_c
-00024eb0: 6174 5f76 6172 7320 3d20 636f 7079 2e64  at_vars = copy.d
-00024ec0: 6565 7063 6f70 7928 6361 7476 6172 7329  eepcopy(catvars)
-00024ed0: 0a20 2020 206f 6e65 686f 745f 6469 6374  .    onehot_dict
-00024ee0: 203d 2064 6566 6175 6c74 6469 6374 2872   = defaultdict(r
-00024ef0: 6574 7572 6e5f 6465 6661 756c 7429 0a20  eturn_default). 
-00024f00: 2020 2023 2323 2323 2054 6869 7320 6973     ##### This is
-00024f10: 2065 7874 7265 6d65 6c79 2063 6f6d 706c   extremely compl
-00024f20: 6963 6174 6564 206c 6f67 6963 202d 3e20  icated logic -> 
-00024f30: 6265 2063 6172 6566 756c 2062 6566 6f72  be careful befor
-00024f40: 6520 6d6f 6469 6679 696e 6720 7468 656d  e modifying them
-00024f50: 210a 2020 2020 6763 2e63 6f6c 6c65 6374  !.    gc.collect
-00024f60: 2829 0a20 2020 2069 6620 6261 7369 635f  ().    if basic_
-00024f70: 656e 636f 6465 7220 696e 206f 6e65 686f  encoder in oneho
-00024f80: 745f 7479 7065 5f65 6e63 6f64 6572 733a  t_type_encoders:
-00024f90: 0a20 2020 2020 2020 2066 6f72 2065 6163  .        for eac
-00024fa0: 685f 6361 7463 6f6c 2069 6e20 636f 7079  h_catcol in copy
-00024fb0: 5f63 6174 5f76 6172 733a 0a20 2020 2020  _cat_vars:.     
-00024fc0: 2020 2020 2020 2063 6f70 795f 6c65 705f         copy_lep_
-00024fd0: 6f6e 6520 3d20 636f 7079 2e64 6565 7063  one = copy.deepc
-00024fe0: 6f70 7928 6c65 705f 6f6e 6529 0a20 2020  opy(lep_one).   
-00024ff0: 2020 2020 2020 2020 2069 6620 636f 6d62           if comb
-00025000: 696e 655f 7261 7265 5f66 6c61 673a 0a20  ine_rare_flag:. 
-00025010: 2020 2020 2020 2020 2020 2020 2020 2072                 r
-00025020: 6363 7420 3d20 5261 7265 5f43 6c61 7373  cct = Rare_Class
-00025030: 5f43 6f6d 6269 6e65 725f 5069 7065 2829  _Combiner_Pipe()
-00025040: 0a20 2020 2020 2020 2020 2020 2020 2020  .               
-00025050: 2023 2323 2054 6869 7320 6973 2074 6f20   ### This is to 
-00025060: 6d61 6b65 206d 6973 7369 6e67 2076 616c  make missing val
-00025070: 7565 7320 646f 6e74 2074 7269 7020 7570  ues dont trip up
-00025080: 2074 6865 2074 7261 6e73 666f 726d 6572   the transformer
-00025090: 2023 2323 230a 2020 2020 2020 2020 2020   ####.          
-000250a0: 2020 2020 2020 585f 7472 6169 6e5b 5b65        X_train[[e
-000250b0: 6163 685f 6361 7463 6f6c 5d5d 203d 2058  ach_catcol]] = X
-000250c0: 5f74 7261 696e 5b5b 6561 6368 5f63 6174  _train[[each_cat
-000250d0: 636f 6c5d 5d2e 6669 6c6c 6e61 2827 4d49  col]].fillna('MI
-000250e0: 5353 494e 4756 414c 5545 272c 6178 6973  SSINGVALUE',axis
-000250f0: 3d31 290a 2020 2020 2020 2020 2020 2020  =1).            
-00025100: 2020 2020 756e 6971 7565 5f63 6f6c 7320      unique_cols 
-00025110: 3d20 6d61 6b65 5f63 6f6c 756d 6e5f 6e61  = make_column_na
-00025120: 6d65 735f 756e 6971 7565 2872 6363 742e  mes_unique(rcct.
-00025130: 6669 745f 7472 616e 7366 6f72 6d28 585f  fit_transform(X_
-00025140: 7472 6169 6e5b 6561 6368 5f63 6174 636f  train[each_catco
-00025150: 6c5d 292e 756e 6971 7565 2829 2e74 6f6c  l]).unique().tol
-00025160: 6973 7428 2929 0a20 2020 2020 2020 2020  ist()).         
-00025170: 2020 2020 2020 2075 6e69 7175 655f 636f         unique_co
-00025180: 6c73 203d 205b 7374 7228 7829 2066 6f72  ls = [str(x) for
-00025190: 2078 2069 6e20 756e 6971 7565 5f63 6f6c   x in unique_col
-000251a0: 735d 2023 2323 206a 7573 7420 6d61 6b65  s] ### just make
-000251b0: 2074 6865 6d20 616c 6c20 7374 7269 6e67   them all string
-000251c0: 730a 2020 2020 2020 2020 2020 2020 2020  s.              
-000251d0: 2020 6f6e 6568 6f74 5f64 6963 745b 6561    onehot_dict[ea
-000251e0: 6368 5f63 6174 636f 6c5d 203d 2075 6e69  ch_catcol] = uni
-000251f0: 7175 655f 636f 6c73 0a20 2020 2020 2020  que_cols.       
-00025200: 2020 2020 2065 6c73 653a 0a20 2020 2020       else:.     
-00025210: 2020 2020 2020 2020 2020 2069 6620 6261             if ba
-00025220: 7369 635f 656e 636f 6465 7220 3d3d 2027  sic_encoder == '
-00025230: 6f6e 6568 6f74 273a 0a20 2020 2020 2020  onehot':.       
-00025240: 2020 2020 2020 2020 2020 2020 2058 5f74               X_t
-00025250: 7261 696e 5b5b 6561 6368 5f63 6174 636f  rain[[each_catco
-00025260: 6c5d 5d20 3d20 585f 7472 6169 6e5b 5b65  l]] = X_train[[e
-00025270: 6163 685f 6361 7463 6f6c 5d5d 2e66 696c  ach_catcol]].fil
-00025280: 6c6e 6128 274d 4953 5349 4e47 5641 4c55  lna('MISSINGVALU
-00025290: 4527 2c61 7869 733d 3129 0a20 2020 2020  E',axis=1).     
-000252a0: 2020 2020 2020 2020 2020 2020 2020 2075                 u
-000252b0: 6e69 7175 655f 636f 6c73 203d 2058 5f74  nique_cols = X_t
-000252c0: 7261 696e 5b65 6163 685f 6361 7463 6f6c  rain[each_catcol
-000252d0: 5d2e 756e 6971 7565 2829 2e74 6f6c 6973  ].unique().tolis
-000252e0: 7428 290a 2020 2020 2020 2020 2020 2020  t().            
-000252f0: 2020 2020 2020 2020 2375 6e69 7175 655f          #unique_
-00025300: 636f 6c73 203d 206e 702e 7768 6572 6528  cols = np.where(
-00025310: 756e 6971 7565 5f63 6f6c 733d 3d6e 702e  unique_cols==np.
-00025320: 6e61 6e2c 2027 6d69 7373 696e 6727 2c20  nan, 'missing', 
-00025330: 756e 6971 7565 5f63 6f6c 7329 0a20 2020  unique_cols).   
-00025340: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00025350: 2023 756e 6971 7565 5f63 6f6c 7320 3d20   #unique_cols = 
-00025360: 6e70 2e77 6865 7265 2875 6e69 7175 655f  np.where(unique_
-00025370: 636f 6c73 203d 3d20 4e6f 6e65 2c20 276d  cols == None, 'm
-00025380: 6973 7369 6e67 272c 2075 6e69 7175 655f  issing', unique_
-00025390: 636f 6c73 290a 2020 2020 2020 2020 2020  cols).          
-000253a0: 2020 2020 2020 2020 2020 756e 6971 7565            unique
-000253b0: 5f63 6f6c 7320 3d20 5b73 7472 2878 2920  _cols = [str(x) 
-000253c0: 666f 7220 7820 696e 2075 6e69 7175 655f  for x in unique_
-000253d0: 636f 6c73 5d20 2323 2320 6a75 7374 206d  cols] ### just m
-000253e0: 616b 6520 7468 656d 2061 6c6c 2073 7472  ake them all str
-000253f0: 696e 6773 0a20 2020 2020 2020 2020 2020  ings.           
-00025400: 2020 2020 2020 2020 2075 6e69 7175 655f           unique_
-00025410: 636f 6c73 203d 206d 616b 655f 636f 6c75  cols = make_colu
-00025420: 6d6e 5f6e 616d 6573 5f75 6e69 7175 6528  mn_names_unique(
-00025430: 756e 6971 7565 5f63 6f6c 7329 0a20 2020  unique_cols).   
-00025440: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00025450: 206f 6e65 686f 745f 6469 6374 5b65 6163   onehot_dict[eac
-00025460: 685f 6361 7463 6f6c 5d20 3d20 756e 6971  h_catcol] = uniq
-00025470: 7565 5f63 6f6c 730a 2020 2020 2020 2020  ue_cols.        
-00025480: 2020 2020 2020 2020 656c 7365 3a0a 2020          else:.  
-00025490: 2020 2020 2020 2020 2020 2020 2020 2020                  
-000254a0: 2020 585f 7472 6169 6e5b 5b65 6163 685f    X_train[[each_
-000254b0: 6361 7463 6f6c 5d5d 203d 2058 5f74 7261  catcol]] = X_tra
-000254c0: 696e 5b5b 6561 6368 5f63 6174 636f 6c5d  in[[each_catcol]
-000254d0: 5d2e 6669 6c6c 6e61 2827 4d49 5353 494e  ].fillna('MISSIN
-000254e0: 4756 414c 5545 272c 6178 6973 3d31 290a  GVALUE',axis=1).
-000254f0: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00025500: 2020 2020 6f6e 6568 6f74 5f64 6963 745b      onehot_dict[
-00025510: 6561 6368 5f63 6174 636f 6c5d 203d 2063  each_catcol] = c
-00025520: 6f70 795f 6c65 705f 6f6e 652e 6669 745f  opy_lep_one.fit_
-00025530: 7472 616e 7366 6f72 6d28 585f 7472 6169  transform(X_trai
-00025540: 6e5b 6561 6368 5f63 6174 636f 6c5d 2c20  n[each_catcol], 
-00025550: 795f 7472 6169 6e29 2e63 6f6c 756d 6e73  y_train).columns
-00025560: 2e74 6f6c 6973 7428 290a 2020 2020 656c  .tolist().    el
-00025570: 7365 3a0a 2020 2020 2020 2020 666f 7220  se:.        for 
-00025580: 6561 6368 5f63 6174 636f 6c20 696e 2063  each_catcol in c
-00025590: 6f70 795f 6361 745f 7661 7273 3a0a 2020  opy_cat_vars:.  
-000255a0: 2020 2020 2020 2020 2020 6f6e 6568 6f74            onehot
-000255b0: 5f64 6963 745b 6561 6368 5f63 6174 636f  _dict[each_catco
-000255c0: 6c5d 203d 2027 6c61 6265 6c27 0a20 2020  l] = 'label'.   
-000255d0: 200a 2020 2020 0a20 2020 2023 2323 2077   .    .    ### w
-000255e0: 6520 6e6f 7720 6e65 6564 2074 6f20 646f  e now need to do
-000255f0: 2074 6865 2073 616d 6520 666f 7220 6469   the same for di
-00025600: 7363 7265 7465 2076 6172 6961 626c 6573  screte variables
-00025610: 2062 6173 6564 206f 6e20 656e 636f 6465   based on encode
-00025620: 7220 7468 6174 2069 7320 7365 6c65 6374  r that is select
-00025630: 6564 2023 230a 2020 2020 2323 2323 2320  ed ##.    ##### 
-00025640: 5468 6973 2069 7320 6578 7472 656d 656c  This is extremel
-00025650: 7920 636f 6d70 6c69 6361 7465 6420 6c6f  y complicated lo
-00025660: 6769 6320 2d3e 2062 6520 6361 7265 6675  gic -> be carefu
-00025670: 6c20 6265 666f 7265 206d 6f64 6966 7969  l before modifyi
-00025680: 6e67 2074 6865 6d21 0a20 2020 2063 6f70  ng them!.    cop
-00025690: 795f 6469 7363 7265 7465 5f76 6172 7320  y_discrete_vars 
-000256a0: 3d20 636f 7079 2e64 6565 7063 6f70 7928  = copy.deepcopy(
-000256b0: 6469 7363 7265 7465 7661 7273 290a 2020  discretevars).  
-000256c0: 2020 6966 2065 6e63 6f64 6572 2069 6e20    if encoder in 
-000256d0: 6f6e 6568 6f74 5f74 7970 655f 656e 636f  onehot_type_enco
-000256e0: 6465 7273 3a0a 2020 2020 2020 2020 666f  ders:.        fo
-000256f0: 7220 6561 6368 5f64 6973 6372 6574 6520  r each_discrete 
-00025700: 696e 2063 6f70 795f 6469 7363 7265 7465  in copy_discrete
-00025710: 5f76 6172 733a 0a20 2020 2020 2020 2020  _vars:.         
-00025720: 2020 2063 6f70 795f 6c65 705f 7477 6f20     copy_lep_two 
-00025730: 3d20 636f 7079 2e64 6565 7063 6f70 7928  = copy.deepcopy(
-00025740: 6c65 705f 7477 6f29 0a20 2020 2020 2020  lep_two).       
-00025750: 2020 2020 2069 6620 636f 6d62 696e 655f       if combine_
-00025760: 7261 7265 5f66 6c61 673a 0a20 2020 2020  rare_flag:.     
-00025770: 2020 2020 2020 2020 2020 2072 6363 7420             rcct 
-00025780: 3d20 5261 7265 5f43 6c61 7373 5f43 6f6d  = Rare_Class_Com
-00025790: 6269 6e65 725f 5069 7065 2829 0a20 2020  biner_Pipe().   
-000257a0: 2020 2020 2020 2020 2020 2020 2058 5f74               X_t
-000257b0: 7261 696e 5b5b 6561 6368 5f64 6973 6372  rain[[each_discr
-000257c0: 6574 655d 5d20 3d20 585f 7472 6169 6e5b  ete]] = X_train[
-000257d0: 5b65 6163 685f 6469 7363 7265 7465 5d5d  [each_discrete]]
-000257e0: 2e66 696c 6c6e 6128 274d 4953 5349 4e47  .fillna('MISSING
-000257f0: 5641 4c55 4527 2c20 6178 6973 3d31 290a  VALUE', axis=1).
-00025800: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00025810: 756e 6971 7565 5f63 6f6c 7320 3d20 6d61  unique_cols = ma
-00025820: 6b65 5f63 6f6c 756d 6e5f 6e61 6d65 735f  ke_column_names_
-00025830: 756e 6971 7565 2872 6363 742e 6669 745f  unique(rcct.fit_
-00025840: 7472 616e 7366 6f72 6d28 585f 7472 6169  transform(X_trai
-00025850: 6e5b 6561 6368 5f64 6973 6372 6574 655d  n[each_discrete]
-00025860: 292e 756e 6971 7565 2829 2e74 6f6c 6973  ).unique().tolis
-00025870: 7428 2929 0a20 2020 2020 2020 2020 2020  t()).           
-00025880: 2020 2020 2075 6e69 7175 655f 636f 6c73       unique_cols
-00025890: 203d 205b 7374 7228 7829 2066 6f72 2078   = [str(x) for x
-000258a0: 2069 6e20 756e 6971 7565 5f63 6f6c 735d   in unique_cols]
-000258b0: 2023 2323 206a 7573 7420 6d61 6b65 2074   ### just make t
-000258c0: 6865 6d20 616c 6c20 7374 7269 6e67 730a  hem all strings.
-000258d0: 2020 2020 2020 2020 2020 2020 2020 2020                  
-000258e0: 6f6e 6568 6f74 5f64 6963 745b 6561 6368  onehot_dict[each
-000258f0: 5f64 6973 6372 6574 655d 203d 2075 6e69  _discrete] = uni
-00025900: 7175 655f 636f 6c73 0a20 2020 2020 2020  que_cols.       
-00025910: 2020 2020 2065 6c73 653a 0a20 2020 2020       else:.     
-00025920: 2020 2020 2020 2020 2020 2069 6620 656e             if en
-00025930: 636f 6465 7220 3d3d 2027 6f6e 6568 6f74  coder == 'onehot
-00025940: 273a 0a20 2020 2020 2020 2020 2020 2020  ':.             
-00025950: 2020 2020 2020 2058 5f74 7261 696e 5b5b         X_train[[
-00025960: 6561 6368 5f64 6973 6372 6574 655d 5d20  each_discrete]] 
-00025970: 3d20 585f 7472 6169 6e5b 5b65 6163 685f  = X_train[[each_
-00025980: 6469 7363 7265 7465 5d5d 2e66 696c 6c6e  discrete]].filln
-00025990: 6128 274d 4953 5349 4e47 5641 4c55 4527  a('MISSINGVALUE'
-000259a0: 2c20 6178 6973 3d31 290a 2020 2020 2020  , axis=1).      
-000259b0: 2020 2020 2020 2020 2020 2020 2020 756e                un
-000259c0: 6971 7565 5f63 6f6c 7320 3d20 585f 7472  ique_cols = X_tr
-000259d0: 6169 6e5b 6561 6368 5f64 6973 6372 6574  ain[each_discret
-000259e0: 655d 2e75 6e69 7175 6528 292e 746f 6c69  e].unique().toli
-000259f0: 7374 2829 0a20 2020 2020 2020 2020 2020  st().           
-00025a00: 2020 2020 2020 2020 2023 756e 6971 7565           #unique
-00025a10: 5f63 6f6c 7320 3d20 6e70 2e77 6865 7265  _cols = np.where
-00025a20: 2875 6e69 7175 655f 636f 6c73 3d3d 6e70  (unique_cols==np
-00025a30: 2e6e 616e 2c20 276d 6973 7369 6e67 272c  .nan, 'missing',
-00025a40: 2075 6e69 7175 655f 636f 6c73 290a 2020   unique_cols).  
-00025a50: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00025a60: 2020 756e 6971 7565 5f63 6f6c 7320 3d20    unique_cols = 
-00025a70: 5b73 7472 2878 2920 666f 7220 7820 696e  [str(x) for x in
-00025a80: 2075 6e69 7175 655f 636f 6c73 5d20 2323   unique_cols] ##
-00025a90: 2320 6a75 7374 206d 616b 6520 7468 656d  # just make them
-00025aa0: 2061 6c6c 2073 7472 696e 6773 0a20 2020   all strings.   
-00025ab0: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00025ac0: 2075 6e69 7175 655f 636f 6c73 203d 206d   unique_cols = m
-00025ad0: 616b 655f 636f 6c75 6d6e 5f6e 616d 6573  ake_column_names
-00025ae0: 5f75 6e69 7175 6528 756e 6971 7565 5f63  _unique(unique_c
-00025af0: 6f6c 7329 0a20 2020 2020 2020 2020 2020  ols).           
-00025b00: 2020 2020 2020 2020 206f 6e65 686f 745f           onehot_
-00025b10: 6469 6374 5b65 6163 685f 6469 7363 7265  dict[each_discre
-00025b20: 7465 5d20 3d20 756e 6971 7565 5f63 6f6c  te] = unique_col
-00025b30: 730a 2020 2020 2020 2020 2020 2020 2020  s.              
-00025b40: 2020 656c 7365 3a0a 2020 2020 2020 2020    else:.        
-00025b50: 2020 2020 2020 2020 2020 2020 585f 7472              X_tr
-00025b60: 6169 6e5b 5b65 6163 685f 6469 7363 7265  ain[[each_discre
-00025b70: 7465 5d5d 203d 2058 5f74 7261 696e 5b5b  te]] = X_train[[
-00025b80: 6561 6368 5f64 6973 6372 6574 655d 5d2e  each_discrete]].
-00025b90: 6669 6c6c 6e61 2827 4d49 5353 494e 4756  fillna('MISSINGV
-00025ba0: 414c 5545 272c 2061 7869 733d 3129 0a20  ALUE', axis=1). 
-00025bb0: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00025bc0: 2020 206f 6e65 686f 745f 6469 6374 5b65     onehot_dict[e
-00025bd0: 6163 685f 6469 7363 7265 7465 5d20 3d20  ach_discrete] = 
-00025be0: 636f 7079 5f6c 6570 5f74 776f 2e66 6974  copy_lep_two.fit
-00025bf0: 5f74 7261 6e73 666f 726d 2858 5f74 7261  _transform(X_tra
-00025c00: 696e 5b65 6163 685f 6469 7363 7265 7465  in[each_discrete
-00025c10: 5d2c 2079 5f74 7261 696e 292e 636f 6c75  ], y_train).colu
-00025c20: 6d6e 732e 746f 6c69 7374 2829 0a20 2020  mns.tolist().   
-00025c30: 2065 6c73 653a 0a20 2020 2020 2020 2023   else:.        #
-00025c40: 2323 2054 6865 6e20 6d61 726b 2069 7420  ## Then mark it 
-00025c50: 6173 206c 6162 656c 2065 6e63 6f64 696e  as label encodin
-00025c60: 6720 736f 2069 7420 6361 6e20 6265 2068  g so it can be h
-00025c70: 616e 646c 6564 2070 726f 7065 726c 7920  andled properly 
-00025c80: 2323 2323 0a20 2020 2020 2020 2066 6f72  ####.        for
-00025c90: 2065 6163 685f 6469 7363 7265 7465 2069   each_discrete i
-00025ca0: 6e20 636f 7079 5f64 6973 6372 6574 655f  n copy_discrete_
-00025cb0: 7661 7273 3a0a 2020 2020 2020 2020 2020  vars:.          
-00025cc0: 2020 6f6e 6568 6f74 5f64 6963 745b 6561    onehot_dict[ea
-00025cd0: 6368 5f64 6973 6372 6574 655d 203d 2027  ch_discrete] = '
-00025ce0: 6c61 6265 6c27 0a20 2020 200a 2020 2020  label'.    .    
-00025cf0: 2323 2320 6966 2079 6f75 2064 726f 7020  ### if you drop 
-00025d00: 7265 6d61 696e 6465 722c 2074 6865 6e20  remainder, then 
-00025d10: 6c65 6674 6f76 6572 7661 7273 2069 7320  leftovervars is 
-00025d20: 6e6f 7420 6e65 6564 6564 2e0a 2020 2020  not needed..    
-00025d30: 7265 6d61 696e 6465 7220 3d20 2764 726f  remainder = 'dro
-00025d40: 7027 0a20 2020 200a 2020 2020 2323 2320  p'.    .    ### 
-00025d50: 4966 2079 6f75 2070 6173 7374 6872 6f75  If you passthrou
-00025d60: 6768 2072 656d 6169 6e64 6572 2c20 7468  gh remainder, th
-00025d70: 656e 206c 6566 746f 7665 7273 206d 7573  en leftovers mus
-00025d80: 7420 6265 2069 6e63 6c75 6465 6420 0a20  t be included . 
-00025d90: 2020 2023 7265 6d61 696e 6465 7220 3d20     #remainder = 
-00025da0: 2770 6173 7374 6872 6f75 6768 270a 0a20  'passthrough'.. 
-00025db0: 2020 2023 2323 2323 2323 2323 2323 2323     #############
-00025dc0: 2323 2323 2323 2323 2323 2323 2323 2323  ################
-00025dd0: 2323 2323 2323 2323 2323 2323 2323 2323  ################
-00025de0: 2323 2323 2323 2323 2323 2323 2323 2323  ################
-00025df0: 2323 2323 2323 2323 2323 2323 2323 2323  ################
-00025e00: 2323 2323 2323 230a 2020 2020 2323 2323  #######.    ####
-00025e10: 2323 2323 2323 2323 2320 2020 2020 2020  #########       
-00025e20: 2020 2020 2020 2020 2020 2020 5320 4320              S C 
-00025e30: 4120 4c20 4520 5220 5320 2020 2020 4820  A L E R S     H 
-00025e40: 4520 5220 4520 2020 2020 2020 2020 2020  E R E           
-00025e50: 2020 2323 2323 2323 2323 2323 2323 2323    ##############
-00025e60: 0a20 2020 2023 2323 2049 6620 796f 7520  .    ### If you 
-00025e70: 6368 6f6f 7365 2053 7461 6e64 6172 6453  choose StandardS
-00025e80: 6361 6c65 7220 6f72 204d 696e 4d61 7853  caler or MinMaxS
-00025e90: 6361 6c65 722c 2074 6865 2069 6e74 6567  caler, the integ
-00025ea0: 6572 2076 616c 7565 7320 6265 636f 6d65  er values become
-00025eb0: 2073 7472 6574 6368 6564 200a 2020 2020   stretched .    
-00025ec0: 2323 2320 2061 7320 6966 2074 6865 7920  ###  as if they 
-00025ed0: 6172 6520 6661 7220 6170 6172 7420 7768  are far apart wh
-00025ee0: 656e 2069 6e20 7265 616c 6974 7920 7468  en in reality th
-00025ef0: 6579 2061 7265 2063 6c6f 7365 2e20 536f  ey are close. So
-00025f00: 2061 766f 6964 2069 7420 666f 7220 6e6f   avoid it for no
-00025f10: 772e 0a20 2020 2023 2323 2323 2323 2323  w..    #########
-00025f20: 2323 2323 2323 2323 2323 2323 2323 2323  ################
-00025f30: 2323 2323 2323 2323 2323 2323 2323 2323  ################
-00025f40: 2323 2323 2323 2323 2323 2323 2323 2323  ################
-00025f50: 2323 2323 2323 2323 2323 2323 2323 2323  ################
-00025f60: 2323 2323 2323 2323 2323 230a 2020 2020  ###########.    
-00025f70: 6966 2073 6361 6c65 7273 2061 6e64 2076  if scalers and v
-00025f80: 6572 626f 7365 3a0a 2020 2020 2020 2020  erbose:.        
-00025f90: 2020 2020 7072 696e 7428 2743 6175 7469      print('Cauti
-00025fa0: 6f6e 3a20 2323 2320 5768 656e 2079 6f75  on: ### When you
-00025fb0: 2068 6176 6520 6361 7465 676f 7269 6361   have categorica
-00025fc0: 6c20 6f72 2064 6174 652d 7469 6d65 2076  l or date-time v
-00025fd0: 6172 7320 696e 2064 6174 612c 2073 6361  ars in data, sca
-00025fe0: 6c69 6e67 206d 6179 206e 6f74 2062 6520  ling may not be 
-00025ff0: 6865 6c70 6675 6c2e 2023 2327 290a 2020  helpful. ##').  
-00026000: 2020 6966 2073 6361 6c65 7273 3d3d 276d    if scalers=='m
-00026010: 6178 2720 6f72 2073 6361 6c65 7273 203d  ax' or scalers =
-00026020: 3d20 276d 696e 6d61 7827 3a0a 2020 2020  = 'minmax':.    
-00026030: 2020 2020 7363 616c 6572 203d 204d 696e      scaler = Min
-00026040: 4d61 7853 6361 6c65 7228 290a 2020 2020  MaxScaler().    
-00026050: 656c 6966 2073 6361 6c65 7273 3d3d 2773  elif scalers=='s
-00026060: 7461 6e64 6172 6427 206f 7220 7363 616c  tandard' or scal
-00026070: 6572 733d 3d27 7374 6427 3a0a 2020 2020  ers=='std':.    
-00026080: 2020 2020 2323 2320 596f 7520 6861 7665      ### You have
-00026090: 2074 6f20 7365 7420 7769 7468 5f6d 6561   to set with_mea
-000260a0: 6e3d 4661 6c73 6520 7768 656e 2064 6561  n=False when dea
-000260b0: 6c69 6e67 2077 6974 6820 7370 6172 7365  ling with sparse
-000260c0: 206d 6174 7269 6365 7320 2323 0a20 2020   matrices ##.   
-000260d0: 2020 2020 2073 6361 6c65 7220 3d20 5374       scaler = St
-000260e0: 616e 6461 7264 5363 616c 6572 2877 6974  andardScaler(wit
-000260f0: 685f 6d65 616e 3d46 616c 7365 290a 2020  h_mean=False).  
-00026100: 2020 656c 6966 2073 6361 6c65 7273 3d3d    elif scalers==
-00026110: 2772 6f62 7573 7427 3a0a 2020 2020 2020  'robust':.      
-00026120: 2020 7363 616c 6572 203d 2052 6f62 7573    scaler = Robus
-00026130: 7453 6361 6c65 7228 756e 6974 5f76 6172  tScaler(unit_var
-00026140: 6961 6e63 653d 5472 7565 290a 2020 2020  iance=True).    
-00026150: 656c 6966 2073 6361 6c65 7273 3d3d 276d  elif scalers=='m
-00026160: 6178 6162 7327 3a0a 2020 2020 2020 2020  axabs':.        
-00026170: 2323 2320 4966 2079 6f75 2063 686f 6f73  ### If you choos
-00026180: 6520 4d61 7841 6273 5363 616c 6572 2c20  e MaxAbsScaler, 
-00026190: 7468 656e 204e 614e 7320 7768 6963 6820  then NaNs which 
-000261a0: 7765 7265 204c 6162 656c 2045 6e63 6f64  were Label Encod
-000261b0: 6564 2061 7320 2d31 2061 7265 2070 7265  ed as -1 are pre
-000261c0: 7365 7276 6564 2061 7320 2d20 286e 6567  served as - (neg
-000261d0: 6174 6976 6573 292e 2054 6869 7320 6973  atives). This is
-000261e0: 2066 616e 7461 7374 6963 2e0a 2020 2020   fantastic..    
-000261f0: 2020 2020 7363 616c 6572 203d 204d 6178      scaler = Max
-00026200: 4162 7353 6361 6c65 7228 290a 2020 2020  AbsScaler().    
-00026210: 656c 7365 3a0a 2020 2020 2020 2020 6966  else:.        if
-00026220: 2076 6572 626f 7365 3a0a 2020 2020 2020   verbose:.      
-00026230: 2020 2020 2020 7072 696e 7428 2720 2020        print('   
-00026240: 2061 6c65 7274 3a20 7468 6572 6520 6973   alert: there is
-00026250: 206e 6f20 7363 616c 6572 2073 7065 6369   no scaler speci
-00026260: 6669 6564 2e20 4f70 7469 6f6e 7320 6172  fied. Options ar
-00026270: 653a 206d 6178 2c20 7374 642c 2072 6f62  e: max, std, rob
-00026280: 7573 742c 206d 6178 6162 732e 2729 0a20  ust, maxabs.'). 
-00026290: 2020 2020 2020 2073 6361 6c65 7273 203d         scalers =
-000262a0: 2027 270a 2020 2020 2323 2323 2323 2323   ''.    ########
-000262b0: 2323 2020 6465 6669 6e65 206e 756d 6572  ##  define numer
-000262c0: 6963 2076 6172 7320 6173 2063 6f6d 626f  ic vars as combo
-000262d0: 206f 6620 666c 6f61 7420 616e 6420 696e   of float and in
-000262e0: 7465 6765 7220 7661 7269 6162 6c65 7320  teger variables 
-000262f0: 2020 2023 2323 2323 2323 2323 0a20 2020     #########.   
-00026300: 206e 756d 7661 7273 203d 2069 6e74 7661   numvars = intva
-00026310: 7273 202b 2066 6c6f 6174 7661 7273 0a20  rs + floatvars. 
-00026320: 2020 2023 2323 2323 2323 2323 2323 2323     #############
-00026330: 2323 2323 2323 2323 2323 2323 2323 2323  ################
-00026340: 2323 2323 2323 2323 2323 2323 2323 2323  ################
-00026350: 2323 2323 2323 2323 2323 2323 2323 2323  ################
-00026360: 2323 2323 2323 2323 2323 2323 2323 2323  ################
-00026370: 2323 2323 2323 230a 2020 2020 2323 2323  #######.    ####
-00026380: 2323 2323 2320 2020 2020 2020 2020 2043  #####          C
-00026390: 2052 2045 2041 2054 2049 204e 2047 2020   R E A T I N G  
-000263a0: 2020 2020 5020 4920 5020 4520 4c20 4920      P I P E L I 
-000263b0: 4e20 4520 2020 2020 2048 2045 2052 2045  N E      H E R E
-000263c0: 2020 2323 2323 2323 2323 2323 2323 2323    ##############
-000263d0: 0a20 2020 2023 2323 2041 6c6c 2074 6865  .    ### All the
-000263e0: 2069 6d70 7574 6572 7320 776f 726b 206f   imputers work o
-000263f0: 6e20 6772 6f75 7073 206f 6620 7661 7269  n groups of vari
-00026400: 6162 6c65 7320 3d3e 2073 6f20 7468 6579  ables => so they
-00026410: 206e 6565 6420 746f 2062 6520 696e 2074   need to be in t
-00026420: 6865 2023 2323 2323 230a 2020 2020 2323  he ######.    ##
-00026430: 2320 2020 2065 6e64 2073 696e 6365 2074  #    end since t
-00026440: 6865 7920 7265 7475 726e 206f 6e6c 7920  hey return only 
-00026450: 3144 2061 7272 6179 732e 204d 795f 4c61  1D arrays. My_La
-00026460: 6265 6c45 6e63 6f64 6572 2061 6e64 206f  belEncoder and o
-00026470: 7468 6572 2020 2020 2020 2020 2323 2323  ther        ####
-00026480: 2323 0a20 2020 2023 2323 2020 2020 6669  ##.    ###    fi
-00026490: 745f 7472 616e 7366 6f72 6d65 7273 206e  t_transformers n
-000264a0: 6565 6420 3244 2061 7272 6179 7320 7369  eed 2D arrays si
-000264b0: 6e63 6520 7468 6579 2077 6f72 6b20 6f6e  nce they work on
-000264c0: 2054 6172 6765 7420 6c61 6265 6c73 2074   Target labels t
-000264d0: 6f6f 2e20 2023 2323 2323 230a 2020 2020  oo.  ######.    
-000264e0: 2323 2323 2323 2323 2323 2323 2323 2323  ################
-000264f0: 2323 2323 2323 2323 2323 2323 2323 2323  ################
-00026500: 2323 2323 2323 2323 2323 2323 2323 2323  ################
-00026510: 2323 2323 2323 2323 2323 2323 2323 2323  ################
-00026520: 2323 2323 2323 2323 2323 2323 2323 2323  ################
-00026530: 2323 2323 0a20 2020 2069 6e69 745f 7374  ####.    init_st
-00026540: 7220 3d20 276d 616b 655f 636f 6c75 6d6e  r = 'make_column
-00026550: 5f74 7261 6e73 666f 726d 6572 2827 0a20  _transformer('. 
-00026560: 2020 2023 2323 2320 6c65 705f 6f6e 6520     #### lep_one 
-00026570: 6163 7473 2061 7320 6120 6f6e 652d 686f  acts as a one-ho
-00026580: 7420 656e 636f 6465 7220 6f66 206c 6f77  t encoder of low
-00026590: 2063 6172 6469 6e61 6c69 7479 2063 6174   cardinality cat
-000265a0: 6567 6f72 6963 616c 2076 6172 6961 626c  egorical variabl
-000265b0: 6573 2023 2323 2323 2323 230a 2020 2020  es ########.    
-000265c0: 6d69 6464 6c65 5f73 7472 3020 3d20 2222  middle_str0 = ""
-000265d0: 2e6a 6f69 6e28 5b27 286c 6570 5f6f 6e65  .join(['(lep_one
-000265e0: 2c20 6361 7476 6172 735b 272b 7374 7228  , catvars['+str(
-000265f0: 6929 2b27 5d29 2c27 2066 6f72 2069 2069  i)+']),' for i i
-00026600: 6e20 7261 6e67 6528 6c65 6e28 6361 7476  n range(len(catv
-00026610: 6172 7329 295d 290a 2020 2020 2323 2323  ars))]).    ####
-00026620: 206c 6570 5f74 776f 2061 6374 7320 6173   lep_two acts as
-00026630: 2061 206d 616a 6f72 2065 6e63 6f64 6572   a major encoder
-00026640: 206f 6620 6869 6768 2063 6172 6469 6e61   of high cardina
-00026650: 6c69 7479 2063 6174 6567 6f72 6963 616c  lity categorical
-00026660: 2076 6172 6961 626c 6573 2023 2323 2323   variables #####
-00026670: 2323 230a 2020 2020 6d69 6464 6c65 5f73  ###.    middle_s
-00026680: 7472 3120 3d20 2222 2e6a 6f69 6e28 5b27  tr1 = "".join(['
-00026690: 286c 6570 5f74 776f 2c20 6469 7363 7265  (lep_two, discre
-000266a0: 7465 7661 7273 5b27 2b73 7472 2869 292b  tevars['+str(i)+
-000266b0: 275d 292c 2720 666f 7220 6920 696e 2072  ']),' for i in r
-000266c0: 616e 6765 286c 656e 2864 6973 6372 6574  ange(len(discret
-000266d0: 6576 6172 7329 295d 290a 2020 2020 6d69  evars))]).    mi
-000266e0: 6464 6c65 5f73 7472 3132 203d 2027 2869  ddle_str12 = '(i
-000266f0: 6d70 2c20 696e 7476 6172 7329 2c27 0a20  mp, intvars),'. 
-00026700: 2020 206d 6964 646c 655f 7374 7232 203d     middle_str2 =
-00026710: 2022 222e 6a6f 696e 285b 2728 6d6b 5f64   "".join(['(mk_d
-00026720: 6174 6573 2c20 6461 7465 7661 7273 5b27  ates, datevars['
-00026730: 2b73 7472 2869 292b 275d 292c 2720 666f  +str(i)+']),' fo
-00026740: 7220 6920 696e 2072 616e 6765 286c 656e  r i in range(len
-00026750: 2864 6174 6576 6172 7329 295d 290a 2020  (datevars))]).  
-00026760: 2020 2323 2323 2320 4e6f 7720 7765 2063    ##### Now we c
-00026770: 616e 2063 6f6d 6269 6e65 2074 6865 2072  an combine the r
-00026780: 6573 7420 6f66 2074 6865 2076 6172 6961  est of the varia
-00026790: 626c 6573 2069 6e74 6f20 7468 6520 7069  bles into the pi
-000267a0: 7065 6c69 6e65 2023 2323 2323 2323 2323  peline #########
-000267b0: 2323 2323 2323 230a 2020 2020 6966 206e  #######.    if n
-000267c0: 6c70 7661 7273 3a0a 2020 2020 2020 2020  lpvars:.        
-000267d0: 6d69 6464 6c65 5f73 7472 3320 3d20 2222  middle_str3 = ""
-000267e0: 2e6a 6f69 6e28 5b27 2876 6563 745f 6f6e  .join(['(vect_on
-000267f0: 652c 206e 6c70 7661 7273 5b27 2b73 7472  e, nlpvars['+str
-00026800: 2869 292b 275d 292c 2720 666f 7220 6920  (i)+']),' for i 
-00026810: 696e 2072 616e 6765 286c 656e 286e 6c70  in range(len(nlp
-00026820: 7661 7273 2929 5d29 0a20 2020 2065 6c73  vars))]).    els
-00026830: 653a 0a20 2020 2020 2020 206d 6964 646c  e:.        middl
-00026840: 655f 7374 7233 203d 2027 270a 2020 2020  e_str3 = ''.    
-00026850: 656e 645f 7374 7220 3d20 2728 696d 702c  end_str = '(imp,
-00026860: 2066 6c6f 6174 7661 7273 292c 2020 2020   floatvars),    
-00026870: 7265 6d61 696e 6465 723d 7265 6d61 696e  remainder=remain
-00026880: 6465 7229 270a 2020 2020 2323 2320 5765  der)'.    ### We
-00026890: 206e 6f77 2070 7574 2074 6865 2077 686f   now put the who
-000268a0: 6c65 2074 7261 6e73 666f 726d 6572 2070  le transformer p
-000268b0: 6970 656c 696e 6520 746f 6765 7468 6572  ipeline together
-000268c0: 2023 2323 0a20 2020 2066 756c 6c5f 7374   ###.    full_st
-000268d0: 7220 3d20 696e 6974 5f73 7472 2b6d 6964  r = init_str+mid
-000268e0: 646c 655f 7374 7230 2b6d 6964 646c 655f  dle_str0+middle_
-000268f0: 7374 7231 2b6d 6964 646c 655f 7374 7231  str1+middle_str1
-00026900: 322b 6d69 6464 6c65 5f73 7472 322b 6d69  2+middle_str2+mi
-00026910: 6464 6c65 5f73 7472 332b 656e 645f 7374  ddle_str3+end_st
-00026920: 720a 2020 2020 6374 203d 2065 7661 6c28  r.    ct = eval(
-00026930: 6675 6c6c 5f73 7472 290a 2020 2020 6966  full_str).    if
-00026940: 2076 6572 626f 7365 203e 3d32 3a0a 2020   verbose >=2:.  
-00026950: 2020 2020 2020 7072 696e 7428 2743 6865        print('Che
-00026960: 636b 2074 6865 2070 6970 656c 696e 6520  ck the pipeline 
-00026970: 6372 6561 7469 6f6e 2073 7461 7465 6d65  creation stateme
-00026980: 6e74 2066 6f72 2065 7272 6f72 7320 2869  nt for errors (i
-00026990: 6620 616e 7929 3a5c 6e5c 7425 7327 2025  f any):\n\t%s' %
-000269a0: 6675 6c6c 5f73 7472 290a 2020 2020 2323  full_str).    ##
-000269b0: 2320 4f6e 6365 2074 6861 7420 6973 2064  # Once that is d
-000269c0: 6f6e 652c 2077 6520 6372 6561 7465 2073  one, we create s
-000269d0: 6571 7565 6e74 6961 6c20 7374 6570 7320  equential steps 
-000269e0: 666f 7220 6120 7069 7065 6c69 6e65 0a20  for a pipeline. 
-000269f0: 2020 2069 6620 7363 616c 6572 733a 0a20     if scalers:. 
-00026a00: 2020 2020 2020 2023 7363 616c 6572 5f70         #scaler_p
-00026a10: 6970 6520 3d20 6d61 6b65 5f70 6970 656c  ipe = make_pipel
-00026a20: 696e 6528 6374 2c20 7363 616c 6572 2029  ine(ct, scaler )
-00026a30: 0a20 2020 2020 2020 2073 6361 6c65 725f  .        scaler_
-00026a40: 7069 7065 203d 2050 6970 656c 696e 6528  pipe = Pipeline(
-00026a50: 5b28 2763 6f6d 706c 6574 655f 7069 7065  [('complete_pipe
-00026a60: 6c69 6e65 272c 2063 7429 2c20 2827 7363  line', ct), ('sc
-00026a70: 616c 6572 272c 2073 6361 6c65 7229 5d29  aler', scaler)])
-00026a80: 0a20 2020 2065 6c73 653a 0a20 2020 2020  .    else:.     
-00026a90: 2020 2023 2323 2064 6566 6175 6c74 2069     ### default i
-00026aa0: 7320 6e6f 2073 6361 6c65 7220 2323 0a20  s no scaler ##. 
-00026ab0: 2020 2020 2020 2073 6361 6c65 725f 7069         scaler_pi
-00026ac0: 7065 203d 2063 6f70 792e 6465 6570 636f  pe = copy.deepco
-00026ad0: 7079 2863 7429 0a20 2020 2023 2323 2054  py(ct).    ### T
-00026ae0: 6865 2066 6972 7374 2063 6f6c 756d 6e73  he first columns
-00026af0: 2073 686f 756c 6420 6265 2077 6861 7465   should be whate
-00026b00: 7665 7220 6973 2069 6e20 7468 6520 5472  ver is in the Tr
-00026b10: 616e 7366 6f72 6d65 725f 5069 7065 6c69  ansformer_Pipeli
-00026b20: 6e65 206c 6973 7420 6f66 2063 6f6c 756d  ne list of colum
-00026b30: 6e73 0a20 2020 2023 2323 2048 656e 6365  ns.    ### Hence
-00026b40: 2074 6865 7920 7769 6c6c 2062 6520 2753   they will be 'S
-00026b50: 6578 272c 2022 456d 6261 726b 6564 222c  ex', "Embarked",
-00026b60: 2022 4167 6522 2c20 2246 6172 6522 2e20   "Age", "Fare". 
-00026b70: 5468 656e 206f 6e6c 7920 6f74 6865 7220  Then only other 
-00026b80: 636f 6c75 6d6e 7320 7468 6174 2061 7265  columns that are
-00026b90: 2070 6173 7365 6420 7468 726f 7567 682e   passed through.
-00026ba0: 0a20 2020 2023 2323 2053 6f20 6166 7465  .    ### So afte
-00026bb0: 7220 7468 6520 6162 6f76 6520 342c 2079  r the above 4, y
-00026bc0: 6f75 2077 696c 6c20 6765 7420 7265 6d61  ou will get rema
-00026bd0: 696e 6465 7220 636f 6c73 2075 6e63 6861  inder cols uncha
-00026be0: 6e67 6564 3a20 2250 6172 6368 222c 224e  nged: "Parch","N
-00026bf0: 616d 6522 0a20 2020 2023 2320 536f 2069  ame".    ## So i
-00026c00: 6620 796f 7520 646f 2069 7420 636f 7272  f you do it corr
-00026c10: 6563 746c 792c 2079 6f75 2077 696c 6c20  ectly, you will 
-00026c20: 6765 7420 7468 6520 6c69 7374 206f 6620  get the list of 
-00026c30: 6e61 6d65 7320 696e 2070 726f 7065 7220  names in proper 
-00026c40: 6f72 6465 7220 7468 6973 2077 6179 3a0a  order this way:.
-00026c50: 2020 2020 2323 2066 6972 7374 2069 7320      ## first is 
-00026c60: 6361 7476 6172 732c 2074 6865 6e20 6e75  catvars, then nu
-00026c70: 6d76 6172 7320 616e 6420 7468 656e 206c  mvars and then l
-00026c80: 6566 746f 7665 7276 6172 730a 2020 2020  eftovervars.    
-00026c90: 6c65 6674 6f76 6572 7661 7273 203d 206c  leftovervars = l
-00026ca0: 6566 745f 7375 6274 7261 6374 2858 5f74  eft_subtract(X_t
-00026cb0: 7261 696e 2e63 6f6c 756d 6e73 2c63 6174  rain.columns,cat
-00026cc0: 7661 7273 2b6e 6c70 7661 7273 2b64 6174  vars+nlpvars+dat
-00026cd0: 6576 6172 732b 6e75 6d76 6172 732b 6469  evars+numvars+di
-00026ce0: 7363 7265 7465 7661 7273 290a 2020 2020  scretevars).    
-00026cf0: 6966 2076 6572 626f 7365 3a0a 2020 2020  if verbose:.    
-00026d00: 2020 2020 6966 206c 6566 746f 7665 7276      if leftoverv
-00026d10: 6172 733a 0a20 2020 2020 2020 2020 2020  ars:.           
-00026d20: 2070 7269 6e74 2827 2020 2020 7265 6d61   print('    rema
-00026d30: 696e 696e 6720 7661 7273 2025 7320 6172  ining vars %s ar
-00026d40: 6520 696e 2025 7320 7374 6174 7573 2062  e in %s status b
-00026d50: 7920 7472 616e 7366 6f72 6d65 7273 2e2e  y transformers..
-00026d60: 2e27 2025 286c 6566 746f 7665 7276 6172  .' %(leftovervar
-00026d70: 732c 2072 656d 6169 6e64 6572 2929 0a20  s, remainder)). 
-00026d80: 2020 2020 2020 2065 6c73 653a 0a20 2020         else:.   
-00026d90: 2020 2020 2020 2020 2070 7269 6e74 2827           print('
-00026da0: 2020 2020 6e6f 206f 7468 6572 2076 6172      no other var
-00026db0: 7320 6c65 6674 2069 6e20 6461 7461 7365  s left in datase
-00026dc0: 7420 746f 2074 7261 6e73 666f 726d 2e2e  t to transform..
-00026dd0: 2e27 290a 2020 2020 2323 2320 6e6f 7720  .').    ### now 
-00026de0: 7765 2063 7265 6174 6520 6e61 6d65 7320  we create names 
-00026df0: 666f 7220 7468 6520 7661 7269 6162 6c65  for the variable
-00026e00: 7320 7472 616e 7366 6f72 6d65 6420 6279  s transformed by
-00026e10: 204e 4c50 2069 6e74 6f20 6120 6675 6e63   NLP into a func
-00026e20: 7469 6f6e 2063 616c 6c65 6420 6e6c 705f  tion called nlp_
-00026e30: 636f 6c0a 2020 2020 7061 7261 6d73 203d  col.    params =
-00026e40: 207b 226e 6c70 7661 7273 223a 206e 6c70   {"nlpvars": nlp
-00026e50: 7661 7273 2c0a 2020 2020 2020 2020 2020  vars,.          
-00026e60: 2263 6174 7661 7273 223a 2063 6174 7661  "catvars": catva
-00026e70: 7273 2c0a 2020 2020 2020 2020 2020 2264  rs,.          "d
-00026e80: 6973 6372 6574 6576 6172 7322 3a20 6469  iscretevars": di
-00026e90: 7363 7265 7465 7661 7273 2c0a 2020 2020  scretevars,.    
-00026ea0: 2020 2020 2020 2266 6c6f 6174 7661 7273        "floatvars
-00026eb0: 223a 2066 6c6f 6174 7661 7273 2c0a 2020  ": floatvars,.  
-00026ec0: 2020 2020 2020 2020 2269 6e74 7661 7273          "intvars
-00026ed0: 223a 2069 6e74 7661 7273 2c0a 2020 2020  ": intvars,.    
-00026ee0: 2020 2020 2020 2264 6174 6576 6172 7322        "datevars"
-00026ef0: 3a20 6461 7465 7661 7273 2c0a 2020 2020  : datevars,.    
-00026f00: 2020 2020 2020 226f 6e65 686f 745f 6469        "onehot_di
-00026f10: 6374 223a 206f 6e65 686f 745f 6469 6374  ct": onehot_dict
-00026f20: 2c0a 2020 2020 2020 2020 2020 2263 6f6c  ,.          "col
-00026f30: 7369 7a65 5f64 6963 7422 3a63 6f6c 7369  size_dict":colsi
-00026f40: 7a65 5f64 6963 742c 0a20 2020 2020 2020  ze_dict,.       
-00026f50: 2020 2022 6461 7465 7369 7a65 5f64 6963     "datesize_dic
-00026f60: 7422 3a64 6174 6573 697a 655f 6469 6374  t":datesize_dict
-00026f70: 7d0a 2020 2020 2323 2320 4372 6561 7465  }.    ### Create
-00026f80: 2061 2046 756e 6374 696f 6e20 7573 696e   a Function usin
-00026f90: 6720 7468 6520 6162 6f76 6520 6675 6e63  g the above func
-00026fa0: 7469 6f6e 2074 6f20 7472 616e 7366 6f72  tion to transfor
-00026fb0: 6d20 696e 2070 6970 656c 696e 6573 2023  m in pipelines #
-00026fc0: 2323 0a20 2020 200a 2020 2020 6966 2062  ##.    .    if b
-00026fd0: 6173 6963 5f65 6e63 6f64 6572 206e 6f74  asic_encoder not
-00026fe0: 2069 6e20 6f6e 6568 6f74 5f74 7970 655f   in onehot_type_
-00026ff0: 656e 636f 6465 7273 2061 6e64 2065 6e63  encoders and enc
-00027000: 6f64 6572 206e 6f74 2069 6e20 6f6e 6568  oder not in oneh
-00027010: 6f74 5f74 7970 655f 656e 636f 6465 7273  ot_type_encoders
-00027020: 3a0a 2020 2020 2020 2020 6e6c 705f 7069  :.        nlp_pi
-00027030: 7065 203d 2050 6970 656c 696e 6528 5b28  pe = Pipeline([(
-00027040: 274e 4c50 272c 2046 756e 6374 696f 6e54  'NLP', FunctionT
-00027050: 7261 6e73 666f 726d 6572 2863 7265 6174  ransformer(creat
-00027060: 655f 636f 6c75 6d6e 5f6e 616d 6573 2c20  e_column_names, 
-00027070: 6b77 5f61 7267 733d 7061 7261 6d73 2929  kw_args=params))
-00027080: 5d29 0a20 2020 2065 6c73 653a 0a20 2020  ]).    else:.   
-00027090: 2020 2020 2023 2323 2055 7365 2074 6865       ### Use the
-000270a0: 206f 6e65 2d68 6f74 2061 6e79 7761 7920   one-hot anyway 
-000270b0: 7369 6e63 6520 6d6f 7374 206f 6620 7468  since most of th
-000270c0: 6520 7469 6d65 732c 2079 6f75 2077 696c  e times, you wil
-000270d0: 6c20 6265 2064 6f69 6e67 206f 6e65 2d68  l be doing one-h
-000270e0: 6f74 2065 6e63 6f64 696e 6720 2323 230a  ot encoding ###.
-000270f0: 2020 2020 2020 2020 6e6c 705f 7069 7065          nlp_pipe
-00027100: 203d 2050 6970 656c 696e 6528 5b28 274e   = Pipeline([('N
-00027110: 4c50 272c 2046 756e 6374 696f 6e54 7261  LP', FunctionTra
-00027120: 6e73 666f 726d 6572 2863 7265 6174 655f  nsformer(create_
-00027130: 636f 6c75 6d6e 5f6e 616d 6573 5f6f 6e65  column_names_one
-00027140: 686f 742c 206b 775f 6172 6773 3d70 6172  hot, kw_args=par
-00027150: 616d 7329 295d 290a 2020 2020 0a20 2020  ams))]).    .   
-00027160: 2023 2323 2320 4368 6169 6e20 6974 2074   #### Chain it t
-00027170: 6f67 6574 6865 7220 696e 2074 6865 2061  ogether in the a
-00027180: 626f 7665 2070 6970 656c 696e 6520 2323  bove pipeline ##
-00027190: 2323 2323 2323 230a 2020 2020 6461 7461  #######.    data
-000271a0: 5f70 6970 6520 3d20 5069 7065 6c69 6e65  _pipe = Pipeline
-000271b0: 285b 2827 7363 616c 6572 5f70 6970 656c  ([('scaler_pipel
-000271c0: 696e 6527 2c20 7363 616c 6572 5f70 6970  ine', scaler_pip
-000271d0: 6529 2c20 2827 6e6c 705f 7069 7065 6c69  e), ('nlp_pipeli
-000271e0: 6e65 272c 206e 6c70 5f70 6970 6529 5d29  ne', nlp_pipe)])
-000271f0: 0a20 2020 200a 2020 2020 2323 2323 2323  .    .    ######
-00027200: 2323 2323 2323 2323 2323 2323 2323 2323  ################
-00027210: 2323 2323 2323 2323 2323 2323 2323 2323  ################
-00027220: 2323 2323 2323 0a20 2020 2023 2323 2323  ######.    #####
-00027230: 2020 2020 5320 4120 5620 4520 2020 5020      S A V E   P 
-00027240: 4920 5020 4520 4c20 4920 4e20 4520 2023  I P E L I N E  #
-00027250: 2323 2323 2323 230a 2020 2020 2323 2320  #######.    ### 
-00027260: 7361 7665 2074 6865 206d 6f64 656c 2061  save the model a
-00027270: 6e64 206f 7220 7069 7065 6c69 6e65 2068  nd or pipeline h
-00027280: 6572 6520 2323 2323 0a20 2020 2023 2323  ere ####.    ###
-00027290: 2323 2323 2323 2323 2323 2323 2323 2323  ################
-000272a0: 2323 2323 2323 2323 2323 2323 2323 2323  ################
-000272b0: 2323 2323 2323 2323 230a 2020 2020 2320  #########.    # 
-000272c0: 7361 7665 2074 6865 206d 6f64 656c 2074  save the model t
-000272d0: 6f20 6469 736b 206f 6e6c 7920 6966 2073  o disk only if s
-000272e0: 6176 6520 666c 6167 2069 7320 7365 7420  ave flag is set 
-000272f0: 746f 2054 7275 6520 2323 0a20 2020 2069  to True ##.    i
-00027300: 6620 7361 7665 5f66 6c61 673a 0a20 2020  f save_flag:.   
-00027310: 2020 2020 2066 696c 656e 616d 6520 3d20       filename = 
-00027320: 274c 617a 7954 7261 6e73 666f 726d 6572  'LazyTransformer
-00027330: 5f70 6970 656c 696e 652e 706b 6c27 0a20  _pipeline.pkl'. 
-00027340: 2020 2020 2020 2070 7269 6e74 2827 2020         print('  
-00027350: 2020 4461 7461 2070 6970 656c 696e 6520    Data pipeline 
-00027360: 6973 2073 6176 6564 2061 733a 2025 7320  is saved as: %s 
-00027370: 696e 2063 7572 7265 6e74 2077 6f72 6b69  in current worki
-00027380: 6e67 2064 6972 6563 746f 7279 2e27 2025  ng directory.' %
-00027390: 6669 6c65 6e61 6d65 290a 2020 2020 2020  filename).      
-000273a0: 2020 7069 636b 6c65 2e64 756d 7028 6461    pickle.dump(da
-000273b0: 7461 5f70 6970 652c 206f 7065 6e28 6669  ta_pipe, open(fi
-000273c0: 6c65 6e61 6d65 2c20 2777 6227 2929 0a20  lename, 'wb')). 
-000273d0: 2020 2064 6966 6674 696d 6520 3d20 6d61     difftime = ma
-000273e0: 7828 312c 2069 6e74 2874 696d 652e 7469  x(1, int(time.ti
-000273f0: 6d65 2829 2d73 7461 7274 5f74 696d 6529  me()-start_time)
-00027400: 290a 2020 2020 7072 696e 7428 2754 696d  ).    print('Tim
-00027410: 6520 7461 6b65 6e20 746f 2064 6566 696e  e taken to defin
-00027420: 6520 6461 7461 2070 6970 656c 696e 6520  e data pipeline 
-00027430: 3d20 2573 2073 6563 6f6e 6428 7329 2720  = %s second(s)' 
-00027440: 2564 6966 6674 696d 6529 0a20 2020 2072  %difftime).    r
-00027450: 6574 7572 6e20 6461 7461 5f70 6970 650a  eturn data_pipe.
-00027460: 2323 2323 2323 2323 2323 2323 2323 2323  ################
-00027470: 2323 2323 2323 2323 2323 2323 2323 2323  ################
-00027480: 2323 2323 2323 2323 2323 2323 2323 2323  ################
-00027490: 2323 2323 2323 2323 2323 2323 2323 2323  ################
-000274a0: 2323 2323 2323 2323 2323 2323 2323 2323  ################
-000274b0: 2323 2323 2323 0a23 6769 7665 7320 6669  ######.#gives fi
-000274c0: 745f 7472 616e 7366 6f72 6d20 6d65 7468  t_transform meth
-000274d0: 6f64 2066 6f72 2066 7265 650a 6672 6f6d  od for free.from
-000274e0: 2073 6b6c 6561 726e 2e62 6173 6520 696d   sklearn.base im
-000274f0: 706f 7274 2054 7261 6e73 666f 726d 6572  port Transformer
-00027500: 4d69 7869 6e20 0a63 6c61 7373 204d 7954  Mixin .class MyT
-00027510: 6966 6628 5472 616e 7366 6f72 6d65 724d  iff(TransformerM
-00027520: 6978 696e 293a 0a20 2020 2064 6566 205f  ixin):.    def _
-00027530: 5f69 6e69 745f 5f28 7365 6c66 2c20 2a61  _init__(self, *a
-00027540: 7267 732c 202a 2a6b 7761 7267 7329 3a0a  rgs, **kwargs):.
-00027550: 2020 2020 2020 2020 7365 6c66 2e65 6e63          self.enc
-00027560: 6f64 6572 203d 2054 6669 6466 5665 6374  oder = TfidfVect
-00027570: 6f72 697a 6572 282a 6172 6773 2c20 2a2a  orizer(*args, **
-00027580: 6b77 6172 6773 290a 2020 2020 6465 6620  kwargs).    def 
-00027590: 6669 7428 7365 6c66 2c20 782c 2079 3d4e  fit(self, x, y=N
-000275a0: 6f6e 6529 3a0a 2020 2020 2020 2020 7365  one):.        se
-000275b0: 6c66 2e65 6e63 6f64 6572 2e66 6974 2878  lf.encoder.fit(x
-000275c0: 290a 2020 2020 2020 2020 7265 7475 726e  ).        return
-000275d0: 2073 656c 660a 2020 2020 6465 6620 7472   self.    def tr
-000275e0: 616e 7366 6f72 6d28 7365 6c66 2c20 782c  ansform(self, x,
-000275f0: 2079 3d4e 6f6e 6529 3a0a 2020 2020 2020   y=None):.      
-00027600: 2020 7265 7475 726e 2073 656c 662e 656e    return self.en
-00027610: 636f 6465 722e 7472 616e 7366 6f72 6d28  coder.transform(
-00027620: 7829 0a23 2323 2323 2323 2323 2323 2323  x).#############
-00027630: 2323 2323 2323 2323 2323 2323 2323 2323  ################
-00027640: 2323 2323 2323 2323 2323 2323 2323 2323  ################
-00027650: 2323 2323 2323 2323 2323 2323 2323 2323  ################
-00027660: 2323 2323 2323 2323 2323 230a 696d 706f  ###########.impo
-00027670: 7274 2072 650a 636c 6173 7320 4c61 7a79  rt re.class Lazy
-00027680: 5472 616e 7366 6f72 6d65 7228 5472 616e  Transformer(Tran
-00027690: 7366 6f72 6d65 724d 6978 696e 293a 0a20  sformerMixin):. 
-000276a0: 2020 2022 2222 0a20 2020 2023 2323 2323     """.    #####
-000276b0: 2323 2323 2323 2323 2323 2323 2323 2323  ################
-000276c0: 2323 2323 2323 2323 2323 2323 2323 2323  ################
-000276d0: 2323 2323 2323 2323 2323 2323 2323 2323  ################
-000276e0: 2323 2323 2323 2323 2323 2323 2323 2323  ################
-000276f0: 2323 2323 0a20 2020 2020 2020 2023 2020  ####.        #  
-00027700: 2020 2020 2020 2020 2020 204c 617a 7954             LazyT
-00027710: 7261 6e73 666f 726d 6572 2020 2020 2020  ransformer      
-00027720: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00027730: 2020 2020 230a 2020 2020 2320 4c61 7a79      #.    # Lazy
-00027740: 5472 616e 7366 6f72 6d65 7220 6973 2061  Transformer is a
-00027750: 2073 696d 706c 6520 7472 616e 7366 6f72   simple transfor
-00027760: 6d65 7220 7069 7065 6c69 6e65 2066 6f72  mer pipeline for
-00027770: 2061 6c6c 206b 696e 6473 206f 6620 4d4c   all kinds of ML
-00027780: 2023 230a 2020 2020 2020 2020 2320 2020   ##.        #   
-00027790: 2020 2020 2020 4372 6561 7465 6420 6279        Created by
-000277a0: 2052 616d 2053 6573 6861 6472 6920 2020   Ram Seshadri   
-000277b0: 2020 2020 2020 2020 2020 2020 2023 0a20               #. 
-000277c0: 2020 2020 2020 2023 2020 2020 2020 2020         #        
-000277d0: 2020 2020 4170 6163 6865 204c 6963 656e      Apache Licen
-000277e0: 7365 2032 2e30 2020 2020 2020 2020 2020  se 2.0          
-000277f0: 2020 2020 2020 2020 230a 2020 2020 2323          #.    ##
-00027800: 2323 2323 2323 2323 2323 2323 2323 2323  ################
-00027810: 2323 2323 2323 2323 2323 2323 2323 2323  ################
-00027820: 2323 2323 2323 2323 2323 2323 2323 2323  ################
-00027830: 2323 2323 2323 2323 2323 2323 2323 2323  ################
-00027840: 2323 2323 2323 230a 2020 2020 2320 2054  #######.    #  T
-00027850: 6869 7320 6973 2061 2073 696d 706c 6520  his is a simple 
-00027860: 7069 7065 6c69 6e65 2066 6f72 204e 4c50  pipeline for NLP
-00027870: 2061 6e64 2054 696d 6520 5365 7269 6573   and Time Series
-00027880: 2070 726f 626c 656d 7320 2323 0a20 2020   problems ##.   
-00027890: 2023 2020 5768 6174 2064 6f65 7320 7468   #  What does th
-000278a0: 6973 2070 6970 656c 696e 6520 646f 2e20  is pipeline do. 
-000278b0: 4865 7265 2773 2074 6865 206d 616a 6f72  Here's the major
-000278c0: 2073 7465 7073 3a20 2020 2020 2020 2023   steps:        #
-000278d0: 230a 2020 2020 2320 312e 2054 616b 6573  #.    # 1. Takes
-000278e0: 2063 6174 6567 6f72 6963 616c 2076 6172   categorical var
-000278f0: 6961 626c 6573 2061 6e64 2065 6e63 6f64  iables and encod
-00027900: 6573 2074 6865 6d20 7573 696e 6720 6d79  es them using my
-00027910: 2020 2020 2323 0a20 2020 2023 2020 2020      ##.    #    
-00027920: 7370 6563 6961 6c20 6c61 6265 6c20 656e  special label en
-00027930: 636f 6465 7220 7768 6963 6820 6361 6e20  coder which can 
-00027940: 6861 6e64 6c65 204e 614e 7320 616e 6420  handle NaNs and 
-00027950: 6576 656e 2020 2020 2023 230a 2020 2020  even     ##.    
-00027960: 2320 2020 2066 7574 7572 6520 6361 7465  #    future cate
-00027970: 676f 7269 6573 2074 6861 7420 6d69 6768  gories that migh
-00027980: 7420 6f63 6375 7220 696e 2074 6573 7420  t occur in test 
-00027990: 6275 7420 6e6f 7420 7472 6169 6e20 2323  but not train ##
-000279a0: 0a20 2020 2023 2031 2e20 5461 6b65 7320  .    # 1. Takes 
-000279b0: 6e75 6d65 7269 6320 7661 7269 6162 6c65  numeric variable
-000279c0: 7320 616e 6420 696d 7075 7465 7320 7573  s and imputes us
-000279d0: 696e 6720 7369 6d70 6c65 2069 6d70 7574  ing simple imput
-000279e0: 6572 2023 230a 2020 2020 2320 312e 2056  er ##.    # 1. V
-000279f0: 6563 746f 7269 7a65 7320 4e4c 5020 616e  ectorizes NLP an
-00027a00: 6420 7469 6d65 2073 6572 6965 7320 2873  d time series (s
-00027a10: 7472 696e 6729 2076 6172 6961 626c 6573  tring) variables
-00027a20: 2061 6e64 2020 2020 2323 0a20 2020 2023   and    ##.    #
-00027a30: 2020 2020 7573 696e 6720 436f 756e 7456      using CountV
-00027a40: 6563 746f 7269 7a65 7220 6f72 2054 6669  ectorizer or Tfi
-00027a50: 6466 5665 6374 6f72 697a 6572 2061 7320  dfVectorizer as 
-00027a60: 7468 6520 6361 7365 206d 6179 2062 650a  the case may be.
-00027a70: 2020 2020 2320 312e 2043 6f6d 706c 6574      # 1. Complet
-00027a80: 656c 7920 7374 616e 6461 7264 697a 6573  ely standardizes
-00027a90: 2061 6c6c 2061 626f 7665 2075 7369 6e67   all above using
-00027aa0: 2041 6273 4d61 7853 6361 6c65 7220 2020   AbsMaxScaler   
-00027ab0: 2020 2323 0a20 2020 2023 2020 2020 7768    ##.    #    wh
-00027ac0: 6963 6820 7072 6573 6572 7665 7320 7468  ich preserves th
-00027ad0: 6520 7265 6c61 7469 6f6e 7368 6970 206f  e relationship o
-00027ae0: 6620 6c61 6265 6c20 656e 636f 6465 6420  f label encoded 
-00027af0: 7661 7273 2020 2023 230a 2020 2020 2320  vars   ##.    # 
-00027b00: 312e 2046 696e 616c 6c79 2061 6464 7320  1. Finally adds 
-00027b10: 616e 2052 4643 206f 7220 5246 5220 746f  an RFC or RFR to
-00027b20: 2074 6865 2070 6970 656c 696e 6520 736f   the pipeline so
-00027b30: 2074 6865 2065 6e74 6972 6520 2323 0a20   the entire ##. 
-00027b40: 2020 2023 2020 2020 7069 7065 6c69 6e65     #    pipeline
-00027b50: 2063 616e 2062 6520 6665 6420 746f 2061   can be fed to a
-00027b60: 2063 726f 7373 2076 616c 6964 6174 696f   cross validatio
-00027b70: 6e20 7363 6865 6d65 2020 2020 2020 2020  n scheme        
-00027b80: 2023 230a 2020 2020 2320 2020 2020 2020   ##.    #       
-00027b90: 2020 2020 2020 5472 7920 6974 206f 7574        Try it out
-00027ba0: 2061 6e64 206c 6574 206d 6520 6b6e 6f77   and let me know
-00027bb0: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00027bc0: 2020 2020 2020 2323 0a20 2020 2023 2323        ##.    ###
-00027bd0: 2323 2323 2323 2323 2323 2323 2323 2323  ################
-00027be0: 2323 2323 2323 2323 2323 2323 2323 2323  ################
-00027bf0: 2323 2323 2323 2323 2323 2323 2323 2323  ################
-00027c00: 2323 2323 2323 2323 2323 2323 230a 2020  #############.  
-00027c10: 2020 2323 2054 6869 7320 6973 206e 6f74    ## This is not
-00027c20: 2061 2073 6369 6b69 742d 6c65 6172 6e20   a scikit-learn 
-00027c30: 4261 7365 4573 7469 6d61 746f 722c 2054  BaseEstimator, T
-00027c40: 7261 6e73 666f 726d 6572 4d69 7869 6e20  ransformerMixin 
-00027c50: 2323 0a20 2020 2023 2320 2020 4275 7420  ##.    ##   But 
-00027c60: 796f 7520 6361 6e20 7573 6520 6974 2069  you can use it i
-00027c70: 6e20 616c 6c20 7363 696b 6974 2d6c 6561  n all scikit-lea
-00027c80: 726e 2070 6970 656c 696e 6573 2061 7320  rn pipelines as 
-00027c90: 6973 2020 2323 230a 2020 2020 2323 2323  is  ###.    ####
-00027ca0: 2323 2323 2323 2323 2323 2323 2323 2323  ################
-00027cb0: 2323 2323 2323 2323 2323 2323 2323 2323  ################
-00027cc0: 2323 2323 2323 2323 2323 2323 2323 2323  ################
-00027cd0: 2323 2323 2323 2323 2323 2323 0a20 2020  ############.   
-00027ce0: 2050 6172 616d 6574 6572 730a 2020 2020   Parameters.    
-00027cf0: 2d2d 2d2d 2d2d 2d2d 2d2d 0a20 2020 2058  ----------.    X
-00027d00: 203a 2070 616e 6461 7320 4461 7461 4672   : pandas DataFr
-00027d10: 616d 6520 2d20 4e6f 206e 756d 7079 2061  ame - No numpy a
-00027d20: 7272 6179 7320 6172 6520 616c 6c6f 7765  rrays are allowe
-00027d30: 6420 7369 6e63 6520 7765 206e 6565 6420  d since we need 
-00027d40: 636f 6c75 6d6e 732e 0a20 2020 2079 203a  columns..    y :
-00027d50: 2070 616e 6461 7320 5365 7269 6573 206f   pandas Series o
-00027d60: 7220 4461 7461 4672 616d 6520 2d20 6e6f  r DataFrame - no
-00027d70: 206e 756d 7079 2061 7272 6179 7320 6172   numpy arrays ar
-00027d80: 6520 616c 6c6f 7765 6420 6167 6169 6e2e  e allowed again.
-00027d90: 0a20 2020 206d 6f64 656c 203a 2064 6566  .    model : def
-00027da0: 6175 6c74 204e 6f6e 652e 2059 6f75 2063  ault None. You c
-00027db0: 616e 2073 656e 6420 796f 7572 206d 6f64  an send your mod
-00027dc0: 656c 2074 6f20 7472 6169 6e20 7769 7468  el to train with
-00027dd0: 2074 6865 2064 6174 612e 200a 2020 2020   the data. .    
-00027de0: 2020 2020 2020 2020 4d75 7374 2062 6520          Must be 
-00027df0: 616e 2073 6b6c 6561 726e 206f 7220 6d75  an sklearn or mu
-00027e00: 6c74 696f 7574 7075 7420 6d6f 6465 6c2e  ltioutput model.
-00027e10: 2059 6f75 2063 616e 2074 7279 206f 7468   You can try oth
-00027e20: 6572 206d 6f64 656c 730a 2020 2020 2020  er models.      
-00027e30: 2020 2020 2020 6275 7420 4920 6861 7665        but I have
-00027e40: 206e 6f74 2074 6573 7465 6420 6974 2e20   not tested it. 
-00027e50: 4974 206d 6967 6874 2077 6f72 6b2e 0a20  It might work.. 
-00027e60: 2020 2065 6e63 6f64 6572 7320 3a20 6465     encoders : de
-00027e70: 6661 756c 7420 6973 2022 6175 746f 222e  fault is "auto".
-00027e80: 2059 6f75 2063 616e 206c 6561 7665 2074   You can leave t
-00027e90: 6869 7320 6173 2061 7574 6f20 616e 6420  his as auto and 
-00027ea0: 6974 2077 696c 6c20 0a20 2020 2020 2020  it will .       
-00027eb0: 2020 2020 2061 7574 6f6d 6174 6963 616c       automatical
-00027ec0: 6c79 2063 686f 6f73 6520 7468 6520 7269  ly choose the ri
-00027ed0: 6768 7420 656e 636f 6465 7220 666f 7220  ght encoder for 
-00027ee0: 796f 7572 2064 6174 6173 6574 2e20 4974  your dataset. It
-00027ef0: 2077 696c 6c0a 2020 2020 2020 2020 2020   will.          
-00027f00: 2020 7573 6520 6f6e 652d 686f 7420 656e    use one-hot en
-00027f10: 636f 6469 6e67 2066 6f72 206c 6f77 2063  coding for low c
-00027f20: 6172 6469 6e61 6c69 7479 2076 6172 7320  ardinality vars 
-00027f30: 616e 6420 6c61 6265 6c20 656e 636f 6469  and label encodi
-00027f40: 6e67 0a20 2020 2020 2020 2020 2020 2066  ng.            f
-00027f50: 6f72 2068 6967 6820 6361 7264 696e 616c  or high cardinal
-00027f60: 6974 7920 7661 7273 2e20 596f 7520 6361  ity vars. You ca
-00027f70: 6e20 616c 736f 2073 656e 6420 6569 7468  n also send eith
-00027f80: 6572 206f 6e65 206f 7220 7477 6f20 656e  er one or two en
-00027f90: 636f 6465 7273 0a20 2020 2020 2020 2020  coders.         
-00027fa0: 2020 206f 6620 796f 7572 206f 776e 2e20     of your own. 
-00027fb0: 4974 206d 7573 7420 6265 2061 2073 7472  It must be a str
-00027fc0: 696e 6720 636f 6e73 6973 7469 6e67 206f  ing consisting o
-00027fd0: 6620 6f6e 6520 6f66 2074 6865 2066 6f6c  f one of the fol
-00027fe0: 6c6f 7769 6e67 3a0a 2020 2020 2020 2020  lowing:.        
-00027ff0: 2020 2020 276f 6e65 686f 7427 2c27 6f72      'onehot','or
-00028000: 6469 6e61 6c27 2c27 6861 7368 696e 6727  dinal','hashing'
-00028010: 2c27 6861 7368 272c 2763 6f75 6e74 272c  ,'hash','count',
-00028020: 2763 6174 626f 6f73 7427 2c27 7461 7267  'catboost','targ
-00028030: 6574 272c 2767 6c6d 272c 0a20 2020 2020  et','glm',.     
-00028040: 2020 2020 2020 2020 2767 6c6d 6d27 2c27          'glmm','
-00028050: 7375 6d27 2c27 776f 6527 2c27 6264 6327  sum','woe','bdc'
-00028060: 2c27 6264 6527 2c27 6c6f 6f27 2c27 6261  ,'bde','loo','ba
-00028070: 7365 272c 276a 616d 6573 272c 276a 616d  se','james','jam
-00028080: 6573 7374 6569 6e27 2c0a 2020 2020 2020  esstein',.      
-00028090: 2020 2020 2020 2027 6865 6c6d 6572 7427         'helmert'
-000280a0: 2c27 7175 616e 7469 6c65 272c 2773 756d  ,'quantile','sum
-000280b0: 6d61 7279 272c 2027 6c61 6265 6c27 2c27  mary', 'label','
-000280c0: 6175 746f 270a 2020 2020 7363 616c 6572  auto'.    scaler
-000280d0: 7320 3a20 6465 6661 756c 7420 6973 204e  s : default is N
-000280e0: 6f6e 652e 2059 6f75 2063 616e 2073 656e  one. You can sen
-000280f0: 6420 6f6e 6520 6f66 2074 6865 2066 6f6c  d one of the fol
-00028100: 6c6f 7769 6e67 2073 7472 696e 6773 3a0a  lowing strings:.
-00028110: 2020 2020 2020 2020 2020 2020 2773 7464              'std
-00028120: 272c 2027 7374 616e 6461 7264 272c 2027  ', 'standard', '
-00028130: 6d69 6e6d 6178 272c 2027 6d61 7827 2c20  minmax', 'max', 
-00028140: 2772 6f62 7573 7427 2c20 276d 6178 6162  'robust', 'maxab
-00028150: 7327 0a20 2020 2064 6174 655f 746f 5f73  s'.    date_to_s
-00028160: 7472 696e 6720 3a20 6465 6661 756c 7420  tring : default 
-00028170: 6973 2027 272e 2049 6620 796f 7520 7761  is ''. If you wa
-00028180: 6e74 206f 6e65 206f 7220 6d6f 7265 2064  nt one or more d
-00028190: 6174 652d 7469 6d65 2063 6f6c 756d 6e73  ate-time columns
-000281a0: 2077 6869 6368 2061 7265 0a20 2020 2020   which are.     
-000281b0: 2020 2020 2020 206f 626a 6563 7420 6f72         object or
-000281c0: 2073 7472 696e 6720 666f 726d 6174 2c20   string format, 
-000281d0: 796f 7520 6361 6e20 7365 6e64 2074 686f  you can send tho
-000281e0: 7365 2063 6f6c 756d 6e20 6e61 6d65 7320  se column names 
-000281f0: 6865 7265 2061 6e64 2074 6865 7920 7769  here and they wi
-00028200: 6c6c 0a20 2020 2020 2020 2020 2020 2062  ll.            b
-00028210: 6520 7472 6561 7465 6420 6173 2073 7472  e treated as str
-00028220: 696e 6720 7661 7269 6162 6c65 7320 616e  ing variables an
-00028230: 6420 7573 6564 2061 7320 4e4c 5020 7661  d used as NLP va
-00028240: 7273 2066 6f72 2054 4649 4446 2e20 4275  rs for TFIDF. Bu
-00028250: 7420 0a20 2020 2020 2020 2020 2020 2069  t .            i
-00028260: 6620 796f 7520 6c65 6176 6520 6974 2061  f you leave it a
-00028270: 7320 616e 2065 6d70 7479 2073 7472 696e  s an empty strin
-00028280: 6720 7468 656e 2069 6620 6461 7465 2d74  g then if date-t
-00028290: 696d 6520 636f 6c75 6d6e 7320 6172 6520  ime columns are 
-000282a0: 6465 7465 6374 6564 0a20 2020 2020 2020  detected.       
-000282b0: 2020 2020 2074 6865 7920 7769 6c6c 2062       they will b
-000282c0: 6520 6175 746f 6d61 7469 6361 6c6c 7920  e automatically 
-000282d0: 636f 6e76 6572 7465 6420 746f 2061 2070  converted to a p
-000282e0: 616e 6461 7320 6461 7465 7469 6d65 2076  andas datetime v
-000282f0: 6172 6961 626c 6520 616e 6420 0a20 2020  ariable and .   
-00028300: 2020 2020 2020 2020 206d 6561 6e69 6e67           meaning
-00028310: 6675 6c20 6665 6174 7572 6573 2077 696c  ful features wil
-00028320: 6c20 6265 2065 7874 7261 6374 6564 2073  l be extracted s
-00028330: 7563 6820 6173 2064 6179 6f66 7468 6577  uch as dayofthew
-00028340: 6565 6b2c 2066 726f 6d20 6974 2e0a 2020  eek, from it..  
-00028350: 2020 7472 616e 7366 6f72 6d5f 7461 7267    transform_targ
-00028360: 6574 203a 2064 6566 6175 6c74 2069 7320  et : default is 
-00028370: 4661 6c73 652e 2049 6620 5472 7565 202c  False. If True ,
-00028380: 2074 6172 6765 7420 636f 6c75 6d6e 2873   target column(s
-00028390: 2920 7769 6c6c 2062 6520 0a20 2020 2020  ) will be .     
-000283a0: 2020 2020 2020 2063 6f6e 7665 7274 6564         converted
-000283b0: 2074 6f20 6e75 6d62 6572 7320 616e 6420   to numbers and 
-000283c0: 7472 6561 7465 6420 6173 206e 756d 6572  treated as numer
-000283d0: 6963 2e20 4966 2046 616c 7365 2c20 7461  ic. If False, ta
-000283e0: 7267 6574 2873 290a 2020 2020 2020 2020  rget(s).        
-000283f0: 2020 2020 7769 6c6c 2062 6520 6c65 6674      will be left
-00028400: 2061 7320 7468 6579 2061 7265 2061 6e64   as they are and
-00028410: 206e 6f74 2063 6f6e 7665 7274 6564 2e0a   not converted..
-00028420: 2020 2020 696d 6261 6c61 6e63 6564 203a      imbalanced :
-00028430: 2064 6566 6175 6c74 2069 7320 4661 6c73   default is Fals
-00028440: 652e 2049 6620 5472 7565 2c20 7765 2077  e. If True, we w
-00028450: 696c 6c20 7472 7920 534d 4f54 4520 6966  ill try SMOTE if
-00028460: 206e 6f20 6d6f 6465 6c20 6973 2069 6e70   no model is inp
-00028470: 7574 2e0a 2020 2020 2020 2020 2020 2020  ut..            
-00028480: 4164 6469 7469 6f6e 616c 6c79 2c20 6966  Additionally, if
-00028490: 2061 206d 6f64 656c 2069 7320 616c 736f   a model is also
-000284a0: 2067 6976 656e 2061 7320 696e 7075 742c   given as input,
-000284b0: 2074 6865 6e20 7468 6174 2062 6173 6520   then that base 
-000284c0: 6d6f 6465 6c20 7769 6c6c 2062 650a 2020  model will be.  
-000284d0: 2020 2020 2020 2020 2020 7772 6170 7065            wrappe
-000284e0: 6420 696e 2061 2053 7570 6572 204c 6561  d in a Super Lea
-000284f0: 726e 696e 6720 4f70 7469 6d69 7a65 6420  rning Optimized 
-00028500: 2853 554c 4f29 2065 6e73 656d 626c 6520  (SULO) ensemble 
-00028510: 6d6f 6465 6c0a 2020 2020 2020 2020 2020  model.          
-00028520: 2020 6361 6c6c 6564 2053 756c 6f43 6c61    called SuloCla
-00028530: 7373 6966 6965 7220 7768 6963 6820 6973  ssifier which is
-00028540: 2061 2070 6572 666f 726d 616e 7420 7374   a performant st
-00028550: 6163 6b69 6e67 206d 6f64 656c 2074 6861  acking model tha
-00028560: 740a 2020 2020 2020 2020 2020 2020 7472  t.            tr
-00028570: 6169 6e20 6f6e 2079 6f75 7220 696d 6261  ain on your imba
-00028580: 6c61 6e63 6564 2064 6174 6120 7365 742e  lanced data set.
-00028590: 2049 6620 4661 6c73 652c 2079 6f75 7220   If False, your 
-000285a0: 6461 7461 2077 696c 6c20 6265 200a 2020  data will be .  
-000285b0: 2020 2020 2020 2020 2020 6c65 6674 2061            left a
-000285c0: 7320 6973 2061 6e64 206e 6f74 6869 6e67  s is and nothing
-000285d0: 2077 696c 6c20 6265 2064 6f6e 6520 746f   will be done to
-000285e0: 2069 742e 0a20 2020 2073 6176 6520 3a20   it..    save : 
-000285f0: 6465 6661 756c 7420 6973 2046 616c 7365  default is False
-00028600: 2e20 4966 2054 7275 652c 2069 7420 7769  . If True, it wi
-00028610: 6c6c 2073 6176 6520 7468 6520 6461 7461  ll save the data
-00028620: 2061 6e64 206d 6f64 656c 2070 6970 656c   and model pipel
-00028630: 696e 6520 696e 2061 200a 2020 2020 2020  ine in a .      
-00028640: 2020 2020 2020 7069 636b 6c65 2066 696c        pickle fil
-00028650: 6520 696e 2074 6865 2063 7572 7265 6e74  e in the current
-00028660: 2077 6f72 6b69 6e67 2064 6972 6563 746f   working directo
-00028670: 7279 2075 6e64 6572 2022 4c61 7a79 5472  ry under "LazyTr
-00028680: 616e 7366 6f72 6d65 725f 7069 7065 6c69  ansformer_pipeli
-00028690: 6e65 2e70 6b6c 220a 2020 2020 2020 2020  ne.pkl".        
-000286a0: 2020 2020 6669 6c65 206e 616d 652e 0a20      file name.. 
-000286b0: 2020 2063 6f6d 6269 6e65 5f72 6172 6520     combine_rare 
-000286c0: 3a20 6465 6661 756c 7420 6973 2046 616c  : default is Fal
-000286d0: 7365 2e20 4966 2054 7275 652c 2069 7420  se. If True, it 
-000286e0: 7769 6c6c 2063 6f6d 6269 6e65 2072 6172  will combine rar
-000286f0: 6520 6361 7465 676f 7269 6573 2069 6e20  e categories in 
-00028700: 796f 7572 200a 2020 2020 2020 2020 2020  your .          
-00028710: 2020 6361 7465 676f 7269 6361 6c20 7661    categorical va
-00028720: 7273 2061 6e64 206d 616b 6520 7468 656d  rs and make them
-00028730: 2069 6e20 746f 2061 2073 696e 676c 6520   in to a single 
-00028740: 2272 6172 655f 6361 7465 676f 7269 6573  "rare_categories
-00028750: 2220 636c 6173 732e 200a 2020 2020 2020  " class. .      
-00028760: 2020 2020 2020 4966 2046 616c 7365 2c20        If False, 
-00028770: 6e6f 7468 696e 6720 7769 6c6c 2062 6520  nothing will be 
-00028780: 646f 6e65 2074 6f20 796f 7572 2063 6174  done to your cat
-00028790: 6567 6f72 6963 616c 2076 6172 732e 0a20  egorical vars.. 
-000287a0: 2020 2076 6572 626f 7365 3a20 4966 2030     verbose: If 0
-000287b0: 2c20 6e6f 7420 6d75 6368 2077 696c 6c20  , not much will 
-000287c0: 6265 2070 7269 6e74 6564 206f 6e20 7468  be printed on th
-000287d0: 6520 7465 726d 696e 616c 2e20 4966 2031  e terminal. If 1
-000287e0: 206f 7220 322c 206c 6f74 7320 6f66 200a   or 2, lots of .
-000287f0: 2020 2020 2020 2020 2020 2020 7374 6570              step
-00028800: 7320 7769 6c6c 2062 6520 7072 696e 7465  s will be printe
-00028810: 6420 6f6e 2074 6865 2074 6572 6d69 6e61  d on the termina
-00028820: 6c2e 0a0a 2020 2020 2222 220a 2020 2020  l...    """.    
-00028830: 6465 6620 5f5f 696e 6974 5f5f 2873 656c  def __init__(sel
-00028840: 662c 206d 6f64 656c 3d4e 6f6e 652c 2065  f, model=None, e
-00028850: 6e63 6f64 6572 733d 2761 7574 6f27 2c20  ncoders='auto', 
-00028860: 7363 616c 6572 733d 4e6f 6e65 2c20 6461  scalers=None, da
-00028870: 7465 5f74 6f5f 7374 7269 6e67 3d46 616c  te_to_string=Fal
-00028880: 7365 2c20 0a20 2020 2020 2020 2020 2020  se, .           
-00028890: 2020 2020 2020 2020 2074 7261 6e73 666f           transfo
-000288a0: 726d 5f74 6172 6765 743d 4661 6c73 652c  rm_target=False,
-000288b0: 2069 6d62 616c 616e 6365 643d 4661 6c73   imbalanced=Fals
-000288c0: 652c 2073 6176 653d 4661 6c73 652c 2063  e, save=False, c
-000288d0: 6f6d 6269 6e65 5f72 6172 6520 3d20 4661  ombine_rare = Fa
-000288e0: 6c73 652c 0a20 2020 2020 2020 2020 2020  lse,.           
-000288f0: 2020 2020 2020 2020 2020 7665 7262 6f73            verbos
-00028900: 653d 3029 3a0a 2020 2020 2020 2020 2222  e=0):.        ""
-00028910: 220a 2020 2020 2020 2020 4465 7363 7269  ".        Descri
-00028920: 7074 696f 6e20 6f66 205f 5f69 6e69 745f  ption of __init_
-00028930: 5f0a 0a20 2020 2020 2020 2041 7267 733a  _..        Args:
-00028940: 0a20 2020 2020 2020 2020 2020 206d 6f64  .            mod
-00028950: 656c 3d4e 6f6e 653a 2041 6e79 206d 6f64  el=None: Any mod
-00028960: 656c 2065 7370 2e20 7363 696b 6974 2d6c  el esp. scikit-l
-00028970: 6561 726e 206d 6f64 656c 2069 6620 796f  earn model if yo
-00028980: 7520 7761 6e74 2074 6f20 7265 7475 726e  u want to return
-00028990: 2070 6970 656c 696e 6520 7769 7468 2074   pipeline with t
-000289a0: 7261 696e 6564 206d 6f64 656c 2e0a 2020  rained model..  
-000289b0: 2020 2020 2020 2020 2020 6461 7465 5f74            date_t
-000289c0: 6f5f 7374 7269 6e67 3d46 616c 7365 3a20  o_string=False: 
-000289d0: 4966 2054 7275 652c 2069 7420 636f 6e76  If True, it conv
-000289e0: 6572 7473 2064 6174 6520 636f 6c75 6d6e  erts date column
-000289f0: 7320 696e 2064 6174 6173 6574 2074 6f20  s in dataset to 
-00028a00: 7374 7269 6e67 206f 626a 6563 7473 0a20  string objects. 
-00028a10: 2020 2020 2020 2020 2020 2074 7261 6e73             trans
-00028a20: 666f 726d 5f74 6172 6765 743d 4661 6c73  form_target=Fals
-00028a30: 653a 2055 7375 616c 6c79 206d 6f64 656c  e: Usually model
-00028a40: 7320 7365 6e74 2061 7320 696e 7075 7420  s sent as input 
-00028a50: 6172 6520 736b 6c65 6172 6e2e 2049 6620  are sklearn. If 
-00028a60: 6e6f 742c 2073 7769 7463 6820 7468 6973  not, switch this
-00028a70: 2066 6c61 6720 746f 2054 7275 652e 0a0a   flag to True...
-00028a80: 2020 2020 2020 2020 2222 220a 2020 2020          """.    
-00028a90: 2020 2020 7365 6c66 2e64 6174 655f 746f      self.date_to
-00028aa0: 5f73 7472 696e 6720 3d20 6461 7465 5f74  _string = date_t
-00028ab0: 6f5f 7374 7269 6e67 0a20 2020 2020 2020  o_string.       
-00028ac0: 2073 656c 662e 656e 636f 6465 7273 203d   self.encoders =
-00028ad0: 2065 6e63 6f64 6572 730a 2020 2020 2020   encoders.      
-00028ae0: 2020 7365 6c66 2e73 6361 6c65 7273 203d    self.scalers =
-00028af0: 2073 6361 6c65 7273 0a20 2020 2020 2020   scalers.       
-00028b00: 2073 656c 662e 696d 6261 6c61 6e63 6564   self.imbalanced
-00028b10: 203d 2069 6d62 616c 616e 6365 640a 2020   = imbalanced.  
-00028b20: 2020 2020 2020 7365 6c66 2e76 6572 626f        self.verbo
-00028b30: 7365 203d 2076 6572 626f 7365 0a20 2020  se = verbose.   
-00028b40: 2020 2020 200a 2020 2020 2020 2020 7365       .        se
-00028b50: 6c66 2e6d 6f64 656c 5f69 6e70 7574 203d  lf.model_input =
-00028b60: 206d 6f64 656c 0a20 2020 2020 2020 2069   model.        i
-00028b70: 6620 6e6f 7420 7365 6c66 2e6d 6f64 656c  f not self.model
-00028b80: 5f69 6e70 7574 3a0a 2020 2020 2020 2020  _input:.        
-00028b90: 2020 2020 7365 6c66 2e6d 6f64 656c 5f69      self.model_i
-00028ba0: 6e70 7574 203d 204e 6f6e 650a 2020 2020  nput = None.    
-00028bb0: 2020 2020 7365 6c66 2e74 7261 6e73 666f      self.transfo
-00028bc0: 726d 5f74 6172 6765 7420 3d20 7472 616e  rm_target = tran
-00028bd0: 7366 6f72 6d5f 7461 7267 6574 0a20 2020  sform_target.   
-00028be0: 2020 2020 2073 656c 662e 6669 7474 6564       self.fitted
-00028bf0: 203d 2046 616c 7365 0a20 2020 2020 2020   = False.       
-00028c00: 2073 656c 662e 7361 7665 203d 2073 6176   self.save = sav
-00028c10: 650a 2020 2020 2020 2020 7365 6c66 2e63  e.        self.c
-00028c20: 6f6d 6269 6e65 5f72 6172 6520 3d20 636f  ombine_rare = co
-00028c30: 6d62 696e 655f 7261 7265 0a0a 2020 2020  mbine_rare..    
-00028c40: 6465 6620 6765 745f 7061 7261 6d73 2873  def get_params(s
-00028c50: 656c 662c 2064 6565 703d 5472 7565 293a  elf, deep=True):
-00028c60: 0a20 2020 2020 2020 2023 2054 6869 7320  .        # This 
-00028c70: 6973 2074 6f20 6d61 6b65 2069 7420 7363  is to make it sc
-00028c80: 696b 6974 2d6c 6561 726e 2063 6f6d 7061  ikit-learn compa
-00028c90: 7469 626c 6520 2323 2323 0a20 2020 2020  tible ####.     
-00028ca0: 2020 2072 6574 7572 6e20 7b22 6461 7465     return {"date
-00028cb0: 5f74 6f5f 7374 7269 6e67 223a 2073 656c  _to_string": sel
-00028cc0: 662e 6461 7465 5f74 6f5f 7374 7269 6e67  f.date_to_string
-00028cd0: 2c20 2265 6e63 6f64 6572 7322 3a20 7365  , "encoders": se
-00028ce0: 6c66 2e65 6e63 6f64 6572 732c 0a20 2020  lf.encoders,.   
-00028cf0: 2020 2020 2020 2020 2022 7363 616c 6572           "scaler
-00028d00: 7322 3a20 7365 6c66 2e73 6361 6c65 7273  s": self.scalers
-00028d10: 2c20 2269 6d62 616c 616e 6365 6422 3a20  , "imbalanced": 
-00028d20: 7365 6c66 2e69 6d62 616c 616e 6365 642c  self.imbalanced,
-00028d30: 200a 2020 2020 2020 2020 2020 2020 2276   .            "v
-00028d40: 6572 626f 7365 223a 2073 656c 662e 7665  erbose": self.ve
-00028d50: 7262 6f73 652c 2022 7472 616e 7366 6f72  rbose, "transfor
-00028d60: 6d5f 7461 7267 6574 223a 2073 656c 662e  m_target": self.
-00028d70: 7472 616e 7366 6f72 6d5f 7461 7267 6574  transform_target
-00028d80: 2c0a 2020 2020 2020 2020 2020 2020 226d  ,.            "m
-00028d90: 6f64 656c 223a 2073 656c 662e 6d6f 6465  odel": self.mode
-00028da0: 6c5f 696e 7075 742c 2022 636f 6d62 696e  l_input, "combin
-00028db0: 655f 7261 7265 223a 2073 656c 662e 636f  e_rare": self.co
-00028dc0: 6d62 696e 655f 7261 7265 2c7d 0a0a 2020  mbine_rare,}..  
-00028dd0: 2020 6465 6620 7365 745f 7061 7261 6d73    def set_params
-00028de0: 2873 656c 662c 202a 2a70 6172 616d 6574  (self, **paramet
-00028df0: 6572 7329 3a0a 2020 2020 2020 2020 666f  ers):.        fo
-00028e00: 7220 7061 7261 6d65 7465 722c 2076 616c  r parameter, val
-00028e10: 7565 2069 6e20 7061 7261 6d65 7465 7273  ue in parameters
-00028e20: 2e69 7465 6d73 2829 3a0a 2020 2020 2020  .items():.      
-00028e30: 2020 2020 2020 7365 7461 7474 7228 7365        setattr(se
-00028e40: 6c66 2c20 7061 7261 6d65 7465 722c 2076  lf, parameter, v
-00028e50: 616c 7565 290a 2020 2020 2020 2020 7265  alue).        re
-00028e60: 7475 726e 2073 656c 660a 0a0a 2020 2020  turn self...    
-00028e70: 6465 6620 6669 7428 7365 6c66 2c20 583a  def fit(self, X:
-00028e80: 2070 642e 4461 7461 4672 616d 652c 2079   pd.DataFrame, y
-00028e90: 3a20 7064 2e44 6174 6146 7261 6d65 293a  : pd.DataFrame):
-00028ea0: 0a20 2020 2020 2020 2022 2222 0a20 2020  .        """.   
-00028eb0: 2020 2020 2044 6573 6372 6970 7469 6f6e       Description
-00028ec0: 206f 6620 6669 7420 6d65 7468 6f64 0a0a   of fit method..
-00028ed0: 2020 2020 2020 2020 4172 6773 3a0a 2020          Args:.  
-00028ee0: 2020 2020 2020 2020 2020 5820 2870 642e            X (pd.
-00028ef0: 4461 7461 4672 616d 6529 3a20 6461 7461  DataFrame): data
-00028f00: 7365 740a 2020 2020 2020 2020 2020 2020  set.            
-00028f10: 793d 4e6f 6e65 2028 7064 2e53 6572 6965  y=None (pd.Serie
-00028f20: 7320 6f72 2070 642e 4461 7461 4672 616d  s or pd.DataFram
-00028f30: 6529 3a20 7461 7267 6574 2063 6f6c 756d  e): target colum
-00028f40: 6e28 7329 0a0a 2020 2020 2020 2020 5265  n(s)..        Re
-00028f50: 7475 726e 733a 0a20 2020 2020 2020 2020  turns:.         
-00028f60: 2020 2041 2053 6369 6b69 742d 4c65 6172     A Scikit-Lear
-00028f70: 6e20 5069 7065 6c69 6e65 206f 626a 6563  n Pipeline objec
-00028f80: 7420 7468 6174 2079 6f75 2063 616e 2064  t that you can d
-00028f90: 6f20 7468 6520 666f 6c6c 6f77 696e 673a  o the following:
-00028fa0: 0a20 2020 2020 2020 2020 2020 2020 2020  .               
-00028fb0: 2069 6620 6d6f 6465 6c66 6f72 6d65 723d   if modelformer=
-00028fc0: 5472 7565 2c20 7468 656e 2079 6f75 2063  True, then you c
-00028fd0: 616e 2064 6f20 6669 7428 2920 616e 6420  an do fit() and 
-00028fe0: 7072 6564 6963 7428 2920 7769 7468 206d  predict() with m
-00028ff0: 6f64 656c 0a20 2020 2020 2020 2020 2020  odel.           
-00029000: 2020 2020 2069 6620 6d6f 6465 6c66 6f72       if modelfor
-00029010: 6d65 723d 4661 6c73 652c 2074 6865 6e20  mer=False, then 
-00029020: 796f 7520 6361 6e20 646f 206f 6e6c 7920  you can do only 
-00029030: 6669 745f 7472 616e 7366 6f72 6d28 2920  fit_transform() 
-00029040: 616e 6420 7072 6564 6963 7428 290a 2020  and predict().  
-00029050: 2020 2020 2020 2222 220a 2020 2020 2020        """.      
-00029060: 2020 7365 6c66 2e78 666f 726d 6572 203d    self.xformer =
-00029070: 204e 6f6e 650a 2020 2020 2020 2020 7365   None.        se
-00029080: 6c66 2e79 666f 726d 6572 203d 204e 6f6e  lf.yformer = Non
-00029090: 650a 2020 2020 2020 2020 7365 6c66 2e69  e.        self.i
-000290a0: 6d62 616c 616e 6365 645f 6669 7273 745f  mbalanced_first_
-000290b0: 646f 6e65 203d 2046 616c 7365 0a20 2020  done = False.   
-000290c0: 2020 2020 2073 656c 662e 736d 6f74 6578       self.smotex
-000290d0: 203d 204e 6f6e 650a 2020 2020 2020 2020   = None.        
-000290e0: 5820 3d20 636f 7079 2e64 6565 7063 6f70  X = copy.deepcop
-000290f0: 7928 5829 0a20 2020 2020 2020 2073 656c  y(X).        sel
-00029100: 662e 585f 696e 6465 7820 3d20 582e 696e  f.X_index = X.in
-00029110: 6465 780a 2020 2020 2020 2020 6966 2079  dex.        if y
-00029120: 2069 7320 6e6f 7420 4e6f 6e65 3a0a 2020   is not None:.  
-00029130: 2020 2020 2020 2020 2020 7365 6c66 2e79            self.y
-00029140: 5f69 6e64 6578 203d 2079 2e69 6e64 6578  _index = y.index
-00029150: 0a20 2020 2020 2020 2023 5820 3d20 582e  .        #X = X.
-00029160: 7265 6e61 6d65 2863 6f6c 756d 6e73 203d  rename(columns =
-00029170: 206c 616d 6264 6120 783a 7265 2e73 7562   lambda x:re.sub
-00029180: 2827 5b5e 412d 5a61 2d7a 302d 395f 5d2b  ('[^A-Za-z0-9_]+
-00029190: 272c 2027 272c 2078 2929 0a20 2020 2020  ', '', x)).     
-000291a0: 2020 200a 2020 2020 2020 2020 7920 3d20     .        y = 
-000291b0: 636f 7079 2e64 6565 7063 6f70 7928 7929  copy.deepcopy(y)
-000291c0: 0a20 2020 2020 2020 2069 6620 792e 6e64  .        if y.nd
-000291d0: 696d 203e 3d20 323a 0a20 2020 2020 2020  im >= 2:.       
-000291e0: 2020 2020 206d 6f64 656c 7479 7065 2c20       modeltype, 
-000291f0: 6d75 6c74 695f 6c61 6265 6c20 3d20 616e  multi_label = an
-00029200: 616c 797a 655f 7072 6f62 6c65 6d5f 7479  alyze_problem_ty
-00029210: 7065 2879 2c20 7461 7267 6574 3d79 2e63  pe(y, target=y.c
-00029220: 6f6c 756d 6e73 2e74 6f6c 6973 7428 292c  olumns.tolist(),
-00029230: 2076 6572 626f 7365 3d30 290a 2020 2020   verbose=0).    
-00029240: 2020 2020 656c 7365 3a0a 2020 2020 2020      else:.      
-00029250: 2020 2020 2020 6d6f 6465 6c74 7970 652c        modeltype,
-00029260: 206d 756c 7469 5f6c 6162 656c 203d 2061   multi_label = a
-00029270: 6e61 6c79 7a65 5f70 726f 626c 656d 5f74  nalyze_problem_t
-00029280: 7970 6528 792c 2074 6172 6765 743d 792e  ype(y, target=y.
-00029290: 6e61 6d65 2c20 7665 7262 6f73 653d 3029  name, verbose=0)
-000292a0: 0a20 2020 2020 2020 2069 6620 6d6f 6465  .        if mode
-000292b0: 6c74 7970 6520 3d3d 2027 5265 6772 6573  ltype == 'Regres
-000292c0: 7369 6f6e 2720 616e 6420 7365 6c66 2e74  sion' and self.t
-000292d0: 7261 6e73 666f 726d 5f74 6172 6765 743a  ransform_target:
-000292e0: 0a20 2020 2020 2020 2020 2020 2070 7269  .            pri
-000292f0: 6e74 2822 2020 2020 5265 6772 6573 7369  nt("    Regressi
-00029300: 6f6e 206d 6f64 656c 7320 646f 6e27 7420  on models don't 
-00029310: 6e65 6564 2074 6172 6765 7473 2074 6f20  need targets to 
-00029320: 6265 2074 7261 6e73 666f 726d 6564 2074  be transformed t
-00029330: 6f20 6e75 6d65 7269 632e 2e2e 2229 2020  o numeric...")  
-00029340: 2020 2020 2020 2020 2020 2020 2020 200a                 .
-00029350: 2020 2020 2020 2020 2020 2020 7365 6c66              self
-00029360: 2e74 7261 6e73 666f 726d 5f74 6172 6765  .transform_targe
-00029370: 7420 3d20 4661 6c73 650a 2020 2020 2020  t = False.      
-00029380: 2020 6966 206d 6f64 656c 7479 7065 203d    if modeltype =
-00029390: 3d20 2752 6567 7265 7373 696f 6e27 2061  = 'Regression' a
-000293a0: 6e64 2073 656c 662e 696d 6261 6c61 6e63  nd self.imbalanc
-000293b0: 6564 3a0a 2020 2020 2020 2020 2020 2020  ed:.            
-000293c0: 7072 696e 7428 2220 2020 2052 6567 7265  print("    Regre
-000293d0: 7373 696f 6e20 6d6f 6465 6c73 2064 6f6e  ssion models don
-000293e0: 2774 206e 6565 6420 696d 6261 6c61 6e63  't need imbalanc
-000293f0: 6564 2066 6c61 6720 7365 7420 746f 2054  ed flag set to T
-00029400: 7275 652e 2e2e 2229 2020 2020 2020 2020  rue...")        
-00029410: 2020 2020 2020 2020 200a 2020 2020 2020           .      
-00029420: 2020 2020 2020 7365 6c66 2e69 6d62 616c        self.imbal
-00029430: 616e 6365 6420 3d20 4661 6c73 650a 2020  anced = False.  
-00029440: 2020 2020 2020 2323 2320 6966 2074 6865        ### if the
-00029450: 7265 2069 7320 6120 666c 6167 2061 6e64  re is a flag and
-00029460: 2069 7420 6973 2061 2063 6c61 7373 6966   it is a classif
-00029470: 6963 6174 696f 6e2c 2064 6f20 6974 2023  ication, do it #
-00029480: 2323 0a20 2020 2020 2020 2069 6620 7365  ##.        if se
-00029490: 6c66 2e74 7261 6e73 666f 726d 5f74 6172  lf.transform_tar
-000294a0: 6765 743a 0a20 2020 2020 2020 2020 2020  get:.           
-000294b0: 2023 2323 2048 656e 6365 2059 5472 616e   ### Hence YTran
-000294c0: 7366 6f72 6d65 7220 636f 6e76 6572 7473  sformer converts
-000294d0: 2074 6865 6d20 6265 666f 7265 2066 6565   them before fee
-000294e0: 6469 6e67 206d 6f64 656c 0a20 2020 2020  ding model.     
-000294f0: 2020 2020 2020 2073 656c 662e 7966 6f72         self.yfor
-00029500: 6d65 7220 3d20 5954 7261 6e73 666f 726d  mer = YTransform
-00029510: 6572 2829 0a20 2020 2020 2020 2023 2323  er().        ###
-00029520: 2320 5468 6973 2069 7320 7768 6572 6520  # This is where 
-00029530: 7765 2062 7569 6c64 2070 6970 656c 696e  we build pipelin
-00029540: 6573 2066 6f72 2058 2061 6e64 2079 2023  es for X and y #
-00029550: 2323 2323 2323 2323 2323 2323 0a20 2020  ############.   
-00029560: 2020 2020 2073 7461 7274 5f74 696d 6520       start_time 
-00029570: 3d20 7469 6d65 2e74 696d 6528 290a 2020  = time.time().  
-00029580: 2020 2020 2020 0a20 2020 2020 2020 2069        .        i
-00029590: 6620 7365 6c66 2e6d 6f64 656c 5f69 6e70  f self.model_inp
-000295a0: 7574 2069 7320 6e6f 7420 4e6f 6e65 3a0a  ut is not None:.
-000295b0: 2020 2020 2020 2020 2020 2020 2323 2320              ### 
-000295c0: 4966 2061 206d 6f64 656c 2069 7320 6769  If a model is gi
-000295d0: 7665 6e2c 2074 6865 6e20 6164 6420 6974  ven, then add it
-000295e0: 2074 6f20 7069 7065 6c69 6e65 2061 6e64   to pipeline and
-000295f0: 2066 6974 2069 7420 2323 230a 2020 2020   fit it ###.    
-00029600: 2020 2020 2020 2020 6461 7461 5f70 6970          data_pip
-00029610: 6520 3d20 6d61 6b65 5f73 696d 706c 655f  e = make_simple_
-00029620: 7069 7065 6c69 6e65 2858 2c20 792c 2065  pipeline(X, y, e
-00029630: 6e63 6f64 6572 733d 7365 6c66 2e65 6e63  ncoders=self.enc
-00029640: 6f64 6572 732c 2073 6361 6c65 7273 3d73  oders, scalers=s
-00029650: 656c 662e 7363 616c 6572 732c 0a20 2020  elf.scalers,.   
-00029660: 2020 2020 2020 2020 2020 2020 2064 6174               dat
-00029670: 655f 746f 5f73 7472 696e 673d 7365 6c66  e_to_string=self
-00029680: 2e64 6174 655f 746f 5f73 7472 696e 672c  .date_to_string,
-00029690: 2073 6176 655f 666c 6167 203d 2073 656c   save_flag = sel
-000296a0: 662e 7361 7665 2c20 0a20 2020 2020 2020  f.save, .       
-000296b0: 2020 2020 2020 2020 2063 6f6d 6269 6e65           combine
-000296c0: 5f72 6172 655f 666c 6167 3d73 656c 662e  _rare_flag=self.
-000296d0: 636f 6d62 696e 655f 7261 7265 2c20 7665  combine_rare, ve
-000296e0: 7262 6f73 653d 7365 6c66 2e76 6572 626f  rbose=self.verbo
-000296f0: 7365 290a 2020 2020 2020 2020 2020 2020  se).            
-00029700: 0a20 2020 2020 2020 2020 2020 2023 2323  .            ###
-00029710: 2054 6865 7265 2069 7320 6e6f 2059 5472   There is no YTr
-00029720: 616e 7366 6f72 6d65 7220 696e 2074 6869  ansformer in thi
-00029730: 7320 7069 7065 6c69 6e65 2073 6f20 7461  s pipeline so ta
-00029740: 7267 6574 7320 6d75 7374 2062 6520 7369  rgets must be si
-00029750: 6e67 6c65 206c 6162 656c 206f 6e6c 7920  ngle label only 
-00029760: 2323 0a20 2020 2020 2020 2020 2020 206d  ##.            m
-00029770: 6f64 656c 5f6e 616d 6520 3d20 7374 7228  odel_name = str(
-00029780: 7365 6c66 2e6d 6f64 656c 5f69 6e70 7574  self.model_input
-00029790: 292e 7370 6c69 7428 2228 2229 5b30 5d20  ).split("(")[0] 
-000297a0: 2020 2020 2020 2020 2020 200a 2020 2020             .    
-000297b0: 2020 2020 2020 2020 6966 2079 2e6e 6469          if y.ndi
-000297c0: 6d20 3e3d 2032 3a0a 2020 2020 2020 2020  m >= 2:.        
-000297d0: 2020 2020 2020 2020 2323 2320 496e 2073          ### In s
-000297e0: 6f6d 6520 6361 7365 732c 2069 6620 7920  ome cases, if y 
-000297f0: 6973 2061 2044 6174 6146 7261 6d65 2077  is a DataFrame w
-00029800: 6974 6820 6f6e 6520 636f 6c75 6d6e 2061  ith one column a
-00029810: 6c73 6f2c 2079 6f75 2067 6574 2074 6865  lso, you get the
-00029820: 7365 2073 6974 7561 7469 6f6e 732e 0a20  se situations.. 
-00029830: 2020 2020 2020 2020 2020 2020 2020 2069                 i
-00029840: 6620 792e 7368 6170 655b 315d 203d 3d20  f y.shape[1] == 
-00029850: 313a 0a20 2020 2020 2020 2020 2020 2020  1:.             
-00029860: 2020 2020 2020 2023 2320 496e 2074 6869         ## In thi
-00029870: 7320 6361 7365 2c20 7920 6861 7320 6f6e  s case, y has on
-00029880: 6c79 206f 6e65 2063 6f6c 756d 6e20 6865  ly one column he
-00029890: 6e63 652c 2079 6f75 2063 616e 2075 7365  nce, you can use
-000298a0: 2061 206d 6f64 656c 2070 6970 656c 696e   a model pipelin
-000298b0: 6520 2323 0a20 2020 2020 2020 2020 2020  e ##.           
-000298c0: 2020 2020 2020 2020 2069 6620 6d6f 6465           if mode
-000298d0: 6c5f 6e61 6d65 203d 3d20 2727 3a20 0a20  l_name == '': . 
-000298e0: 2020 2020 2020 2020 2020 2020 2020 2020                  
-000298f0: 2020 2020 2020 2070 7269 6e74 2827 4e6f         print('No
-00029900: 206d 6f64 656c 206e 616d 6520 7370 6563   model name spec
-00029910: 6966 6965 6427 290a 2020 2020 2020 2020  ified').        
-00029920: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00029930: 7365 6c66 2e6d 6f64 656c 5f69 6e70 7574  self.model_input
-00029940: 203d 204e 6f6e 650a 2020 2020 2020 2020   = None.        
-00029950: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00029960: 6d6c 5f70 6970 6520 3d20 5069 7065 6c69  ml_pipe = Pipeli
-00029970: 6e65 285b 2827 6461 7461 5f70 6970 656c  ne([('data_pipel
-00029980: 696e 6527 2c20 6461 7461 5f70 6970 6529  ine', data_pipe)
-00029990: 2c5d 290a 2020 2020 2020 2020 2020 2020  ,]).            
-000299a0: 2020 2020 2020 2020 656c 7365 3a0a 2020          else:.  
-000299b0: 2020 2020 2020 2020 2020 2020 2020 2020                  
-000299c0: 2020 2020 2020 6d6c 5f70 6970 6520 3d20        ml_pipe = 
-000299d0: 5069 7065 6c69 6e65 285b 2827 6461 7461  Pipeline([('data
-000299e0: 5f70 6970 656c 696e 6527 2c20 6461 7461  _pipeline', data
-000299f0: 5f70 6970 6529 2c20 2827 6d6f 6465 6c27  _pipe), ('model'
-00029a00: 2c20 7365 6c66 2e6d 6f64 656c 5f69 6e70  , self.model_inp
-00029a10: 7574 295d 290a 2020 2020 2020 2020 2020  ut)]).          
-00029a20: 2020 2020 2020 656c 6966 206d 6f64 656c        elif model
-00029a30: 5f6e 616d 6520 3d3d 2027 273a 200a 2020  _name == '': .  
-00029a40: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00029a50: 2020 7072 696e 7428 274e 6f20 6d6f 6465    print('No mode
-00029a60: 6c20 6e61 6d65 2073 7065 6369 6669 6564  l name specified
-00029a70: 2729 0a20 2020 2020 2020 2020 2020 2020  ').             
-00029a80: 2020 2020 2020 2073 656c 662e 6d6f 6465         self.mode
-00029a90: 6c5f 696e 7075 7420 3d20 4e6f 6e65 0a20  l_input = None. 
-00029aa0: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00029ab0: 2020 206d 6c5f 7069 7065 203d 2050 6970     ml_pipe = Pip
-00029ac0: 656c 696e 6528 5b28 2764 6174 615f 7069  eline([('data_pi
-00029ad0: 7065 6c69 6e65 272c 2064 6174 615f 7069  peline', data_pi
-00029ae0: 7065 292c 5d29 0a20 2020 2020 2020 2020  pe),]).         
-00029af0: 2020 2020 2020 2065 6c69 6620 6d6f 6465         elif mode
-00029b00: 6c5f 6e61 6d65 206e 6f74 2069 6e20 5b27  l_name not in ['
-00029b10: 4d75 6c74 694f 7574 7075 7443 6c61 7373  MultiOutputClass
-00029b20: 6966 6965 7227 2c27 4d75 6c74 694f 7574  ifier','MultiOut
-00029b30: 7075 7452 6567 7265 7373 6f72 275d 3a0a  putRegressor']:.
-00029b40: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00029b50: 2020 2020 2323 2320 496e 2074 6869 7320      ### In this 
-00029b60: 6361 7365 2c20 7920 6861 7320 6d6f 7265  case, y has more
-00029b70: 2074 6861 6e20 3120 636f 6c75 6d6e 2c20   than 1 column, 
-00029b80: 6865 6e63 6520 6966 2069 7420 6973 206e  hence if it is n
-00029b90: 6f74 2061 206d 756c 7469 6f75 7470 7574  ot a multioutput
-00029ba0: 206d 6f64 656c 2c20 6769 7665 2065 7272   model, give err
-00029bb0: 6f72 0a20 2020 2020 2020 2020 2020 2020  or.             
-00029bc0: 2020 2020 2020 2070 7269 6e74 2827 2020         print('  
-00029bd0: 2020 416c 6572 743a 204d 756c 7469 2d4c    Alert: Multi-L
-00029be0: 6162 656c 2070 726f 626c 656d 202d 206d  abel problem - m
-00029bf0: 616b 6520 7375 7265 2079 6f75 7220 696e  ake sure your in
-00029c00: 7075 7420 6d6f 6465 6c20 6361 6e20 646f  put model can do
-00029c10: 204d 756c 7469 4f75 7470 7574 2127 290a   MultiOutput!').
-00029c20: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00029c30: 2020 2020 6d6c 5f70 6970 6520 3d20 5069      ml_pipe = Pi
-00029c40: 7065 6c69 6e65 285b 2827 6461 7461 5f70  peline([('data_p
-00029c50: 6970 656c 696e 6527 2c20 6461 7461 5f70  ipeline', data_p
-00029c60: 6970 6529 2c20 2827 6d6f 6465 6c27 2c20  ipe), ('model', 
-00029c70: 7365 6c66 2e6d 6f64 656c 5f69 6e70 7574  self.model_input
-00029c80: 295d 290a 2020 2020 2020 2020 2020 2020  )]).            
-00029c90: 2020 2020 656c 7365 3a0a 2020 2020 2020      else:.      
-00029ca0: 2020 2020 2020 2020 2020 2020 2020 2323                ##
-00029cb0: 2049 6e20 7468 6973 2063 6173 6520 7765   In this case we
-00029cc0: 2068 6176 6520 6120 6d75 6c74 6920 6f75   have a multi ou
-00029cd0: 7470 7574 206d 6f64 656c 2e20 536f 206c  tput model. So l
-00029ce0: 6574 2773 2075 7365 2069 7420 2323 230a  et's use it ###.
-00029cf0: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00029d00: 2020 2020 236d 6c5f 7069 7065 203d 206d      #ml_pipe = m
-00029d10: 616b 655f 7069 7065 6c69 6e65 2864 6174  ake_pipeline(dat
-00029d20: 615f 7069 7065 2c20 7365 6c66 2e6d 6f64  a_pipe, self.mod
-00029d30: 656c 5f69 6e70 7574 290a 2020 2020 2020  el_input).      
-00029d40: 2020 2020 2020 2020 2020 2020 2020 6d6c                ml
-00029d50: 5f70 6970 6520 3d20 5069 7065 6c69 6e65  _pipe = Pipeline
-00029d60: 285b 2827 6461 7461 5f70 6970 656c 696e  ([('data_pipelin
-00029d70: 6527 2c20 6461 7461 5f70 6970 6529 2c20  e', data_pipe), 
-00029d80: 2827 6d6f 6465 6c27 2c20 7365 6c66 2e6d  ('model', self.m
-00029d90: 6f64 656c 5f69 6e70 7574 295d 290a 2020  odel_input)]).  
-00029da0: 2020 2020 2020 2020 2020 656c 7365 3a0a            else:.
-00029db0: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00029dc0: 2323 2320 596f 7520 646f 6e27 7420 6e65  ### You don't ne
-00029dd0: 6564 2059 5472 616e 7366 6f72 6d65 7220  ed YTransformer 
-00029de0: 7369 6e63 6520 6974 2069 7320 6120 7369  since it is a si
-00029df0: 6d70 6c65 2073 6b6c 6561 726e 206d 6f64  mple sklearn mod
-00029e00: 656c 0a20 2020 2020 2020 2020 2020 2020  el.             
-00029e10: 2020 2023 6d6c 5f70 6970 6520 3d20 6d61     #ml_pipe = ma
-00029e20: 6b65 5f70 6970 656c 696e 6528 6461 7461  ke_pipeline(data
-00029e30: 5f70 6970 652c 2073 656c 662e 6d6f 6465  _pipe, self.mode
-00029e40: 6c5f 696e 7075 7429 0a20 2020 2020 2020  l_input).       
-00029e50: 2020 2020 2020 2020 206d 6c5f 7069 7065           ml_pipe
-00029e60: 203d 2050 6970 656c 696e 6528 5b28 2764   = Pipeline([('d
-00029e70: 6174 615f 7069 7065 6c69 6e65 272c 2064  ata_pipeline', d
-00029e80: 6174 615f 7069 7065 292c 2028 276d 6f64  ata_pipe), ('mod
-00029e90: 656c 272c 2073 656c 662e 6d6f 6465 6c5f  el', self.model_
-00029ea0: 696e 7075 7429 5d29 0a20 2020 2020 2020  input)]).       
-00029eb0: 2020 2020 2023 2320 2020 4e6f 7720 7765       ##   Now we
-00029ec0: 2066 6974 2074 6865 206d 6f64 656c 2070   fit the model p
-00029ed0: 6970 656c 696e 6520 746f 2058 2061 6e64  ipeline to X and
-00029ee0: 2079 2023 2323 0a20 2020 2020 2020 2020   y ###.         
-00029ef0: 2020 2074 7279 3a0a 2020 2020 2020 2020     try:.        
-00029f00: 2020 2020 2020 2020 0a20 2020 2020 2020          .       
-00029f10: 2020 2020 2020 2020 2023 2323 2320 5468           #### Th
-00029f20: 6973 2069 7320 6120 7665 7279 2069 6d70  is is a very imp
-00029f30: 6f72 7461 6e74 2073 6574 206f 6620 7374  ortant set of st
-00029f40: 6174 656d 656e 7473 2023 2323 230a 2020  atements ####.  
-00029f50: 2020 2020 2020 2020 2020 2020 2020 6966                if
-00029f60: 2073 656c 662e 7472 616e 7366 6f72 6d5f   self.transform_
-00029f70: 7461 7267 6574 3a0a 2020 2020 2020 2020  target:.        
-00029f80: 2020 2020 2020 2020 2020 2020 6966 2079              if y
-00029f90: 2069 7320 6e6f 7420 4e6f 6e65 3a0a 2020   is not None:.  
-00029fa0: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00029fb0: 2020 2020 2020 7365 6c66 2e79 5f69 6e64        self.y_ind
-00029fc0: 6578 203d 2079 2e69 6e64 6578 0a20 2020  ex = y.index.   
+00024070: 2323 2323 2323 2323 2323 2323 230a 2020  #############.  
+00024080: 2020 2020 2020 2320 2020 2020 2020 2020        #         
+00024090: 2020 2020 4c61 7a79 5472 616e 7366 6f72      LazyTransfor
+000240a0: 6d65 7220 2020 2020 2020 2020 2020 2020  mer             
+000240b0: 2020 2020 2020 2020 2020 2020 2023 0a20               #. 
+000240c0: 2020 2023 204c 617a 7954 7261 6e73 666f     # LazyTransfo
+000240d0: 726d 6572 2069 7320 6120 7369 6d70 6c65  rmer is a simple
+000240e0: 2074 7261 6e73 666f 726d 6572 2070 6970   transformer pip
+000240f0: 656c 696e 6520 666f 7220 616c 6c20 6b69  eline for all ki
+00024100: 6e64 7320 6f66 204d 4c20 2323 0a20 2020  nds of ML ##.   
+00024110: 2020 2020 2023 2020 2020 2020 2020 2043       #         C
+00024120: 7265 6174 6564 2062 7920 5261 6d20 5365  reated by Ram Se
+00024130: 7368 6164 7269 2020 2020 2020 2020 2020  shadri          
+00024140: 2020 2020 2020 230a 2020 2020 2020 2020        #.        
+00024150: 2320 2020 2020 2020 2020 2020 2041 7061  #            Apa
+00024160: 6368 6520 4c69 6365 6e73 6520 322e 3020  che License 2.0 
+00024170: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00024180: 2023 0a20 2020 2023 2323 2323 2323 2323   #.    #########
+00024190: 2323 2323 2323 2323 2323 2323 2323 2323  ################
+000241a0: 2323 2323 2323 2323 2323 2323 2323 2323  ################
+000241b0: 2323 2323 2323 2323 2323 2323 2323 2323  ################
+000241c0: 2323 2323 2323 2323 2323 2323 2323 2323  ################
+000241d0: 0a20 2020 2023 2020 5468 6973 2069 7320  .    #  This is 
+000241e0: 6120 7369 6d70 6c65 2070 6970 656c 696e  a simple pipelin
+000241f0: 6520 666f 7220 4e4c 5020 616e 6420 5469  e for NLP and Ti
+00024200: 6d65 2053 6572 6965 7320 7072 6f62 6c65  me Series proble
+00024210: 6d73 2023 230a 2020 2020 2320 2057 6861  ms ##.    #  Wha
+00024220: 7420 646f 6573 2074 6869 7320 7069 7065  t does this pipe
+00024230: 6c69 6e65 2064 6f2e 2048 6572 6527 7320  line do. Here's 
+00024240: 7468 6520 6d61 6a6f 7220 7374 6570 733a  the major steps:
+00024250: 2020 2020 2020 2020 2323 0a20 2020 2023          ##.    #
+00024260: 2031 2e20 5461 6b65 7320 6361 7465 676f   1. Takes catego
+00024270: 7269 6361 6c20 7661 7269 6162 6c65 7320  rical variables 
+00024280: 616e 6420 656e 636f 6465 7320 7468 656d  and encodes them
+00024290: 2075 7369 6e67 206d 7920 2020 2023 230a   using my    ##.
+000242a0: 2020 2020 2320 2020 2073 7065 6369 616c      #    special
+000242b0: 206c 6162 656c 2065 6e63 6f64 6572 2077   label encoder w
+000242c0: 6869 6368 2063 616e 2068 616e 646c 6520  hich can handle 
+000242d0: 4e61 4e73 2061 6e64 2065 7665 6e20 2020  NaNs and even   
+000242e0: 2020 2323 0a20 2020 2023 2020 2020 6675    ##.    #    fu
+000242f0: 7475 7265 2063 6174 6567 6f72 6965 7320  ture categories 
+00024300: 7468 6174 206d 6967 6874 206f 6363 7572  that might occur
+00024310: 2069 6e20 7465 7374 2062 7574 206e 6f74   in test but not
+00024320: 2074 7261 696e 2023 230a 2020 2020 2320   train ##.    # 
+00024330: 312e 2054 616b 6573 206e 756d 6572 6963  1. Takes numeric
+00024340: 2076 6172 6961 626c 6573 2061 6e64 2069   variables and i
+00024350: 6d70 7574 6573 2075 7369 6e67 2073 696d  mputes using sim
+00024360: 706c 6520 696d 7075 7465 7220 2323 0a20  ple imputer ##. 
+00024370: 2020 2023 2031 2e20 5665 6374 6f72 697a     # 1. Vectoriz
+00024380: 6573 204e 4c50 2061 6e64 2074 696d 6520  es NLP and time 
+00024390: 7365 7269 6573 2028 7374 7269 6e67 2920  series (string) 
+000243a0: 7661 7269 6162 6c65 7320 616e 6420 2020  variables and   
+000243b0: 2023 230a 2020 2020 2320 2020 2075 7369   ##.    #    usi
+000243c0: 6e67 2043 6f75 6e74 5665 6374 6f72 697a  ng CountVectoriz
+000243d0: 6572 206f 7220 5466 6964 6656 6563 746f  er or TfidfVecto
+000243e0: 7269 7a65 7220 6173 2074 6865 2063 6173  rizer as the cas
+000243f0: 6520 6d61 7920 6265 0a20 2020 2023 2031  e may be.    # 1
+00024400: 2e20 436f 6d70 6c65 7465 6c79 2073 7461  . Completely sta
+00024410: 6e64 6172 6469 7a65 7320 616c 6c20 6162  ndardizes all ab
+00024420: 6f76 6520 7573 696e 6720 4162 734d 6178  ove using AbsMax
+00024430: 5363 616c 6572 2020 2020 2023 230a 2020  Scaler     ##.  
+00024440: 2020 2320 2020 2077 6869 6368 2070 7265    #    which pre
+00024450: 7365 7276 6573 2074 6865 2072 656c 6174  serves the relat
+00024460: 696f 6e73 6869 7020 6f66 206c 6162 656c  ionship of label
+00024470: 2065 6e63 6f64 6564 2076 6172 7320 2020   encoded vars   
+00024480: 2323 0a20 2020 2023 2031 2e20 4669 6e61  ##.    # 1. Fina
+00024490: 6c6c 7920 6164 6473 2061 6e20 5246 4320  lly adds an RFC 
+000244a0: 6f72 2052 4652 2074 6f20 7468 6520 7069  or RFR to the pi
+000244b0: 7065 6c69 6e65 2073 6f20 7468 6520 656e  peline so the en
+000244c0: 7469 7265 2023 230a 2020 2020 2320 2020  tire ##.    #   
+000244d0: 2070 6970 656c 696e 6520 6361 6e20 6265   pipeline can be
+000244e0: 2066 6564 2074 6f20 6120 6372 6f73 7320   fed to a cross 
+000244f0: 7661 6c69 6461 7469 6f6e 2073 6368 656d  validation schem
+00024500: 6520 2020 2020 2020 2020 2323 0a20 2020  e         ##.   
+00024510: 2023 2020 2020 2020 2020 2020 2020 2054   #             T
+00024520: 7279 2069 7420 6f75 7420 616e 6420 6c65  ry it out and le
+00024530: 7420 6d65 206b 6e6f 7720 2020 2020 2020  t me know       
+00024540: 2020 2020 2020 2020 2020 2020 2020 2023                 #
+00024550: 230a 2020 2020 2323 2323 2323 2323 2323  #.    ##########
+00024560: 2323 2323 2323 2323 2323 2323 2323 2323  ################
+00024570: 2323 2323 2323 2323 2323 2323 2323 2323  ################
+00024580: 2323 2323 2323 2323 2323 2323 2323 2323  ################
+00024590: 2323 2323 2323 0a20 2020 2023 2320 5468  ######.    ## Th
+000245a0: 6973 2069 7320 6e6f 7420 6120 7363 696b  is is not a scik
+000245b0: 6974 2d6c 6561 726e 2042 6173 6545 7374  it-learn BaseEst
+000245c0: 696d 6174 6f72 2c20 5472 616e 7366 6f72  imator, Transfor
+000245d0: 6d65 724d 6978 696e 2023 230a 2020 2020  merMixin ##.    
+000245e0: 2323 2020 2042 7574 2079 6f75 2063 616e  ##   But you can
+000245f0: 2075 7365 2069 7420 696e 2061 6c6c 2073   use it in all s
+00024600: 6369 6b69 742d 6c65 6172 6e20 7069 7065  cikit-learn pipe
+00024610: 6c69 6e65 7320 6173 2069 7320 2023 2323  lines as is  ###
+00024620: 0a20 2020 2023 2323 2323 2323 2323 2323  .    ###########
+00024630: 2323 2323 2323 2323 2323 2323 2323 2323  ################
+00024640: 2323 2323 2323 2323 2323 2323 2323 2323  ################
+00024650: 2323 2323 2323 2323 2323 2323 2323 2323  ################
+00024660: 2323 2323 230a 2020 2020 5061 7261 6d65  #####.    Parame
+00024670: 7465 7273 0a20 2020 202d 2d2d 2d2d 2d2d  ters.    -------
+00024680: 2d2d 2d0a 2020 2020 5820 3a20 7061 6e64  ---.    X : pand
+00024690: 6173 2044 6174 6146 7261 6d65 202d 204e  as DataFrame - N
+000246a0: 6f20 6e75 6d70 7920 6172 7261 7973 2061  o numpy arrays a
+000246b0: 7265 2061 6c6c 6f77 6564 2073 696e 6365  re allowed since
+000246c0: 2077 6520 6e65 6564 2063 6f6c 756d 6e73   we need columns
+000246d0: 2e0a 2020 2020 7920 3a20 7061 6e64 6173  ..    y : pandas
+000246e0: 2053 6572 6965 7320 6f72 2044 6174 6146   Series or DataF
+000246f0: 7261 6d65 202d 206e 6f20 6e75 6d70 7920  rame - no numpy 
+00024700: 6172 7261 7973 2061 7265 2061 6c6c 6f77  arrays are allow
+00024710: 6564 2061 6761 696e 2e0a 2020 2020 6d6f  ed again..    mo
+00024720: 6465 6c20 3a20 6465 6661 756c 7420 4e6f  del : default No
+00024730: 6e65 2e20 596f 7520 6361 6e20 7365 6e64  ne. You can send
+00024740: 2079 6f75 7220 6d6f 6465 6c20 746f 2074   your model to t
+00024750: 7261 696e 2077 6974 6820 7468 6520 6461  rain with the da
+00024760: 7461 2e20 0a20 2020 2020 2020 2020 2020  ta. .           
+00024770: 204d 7573 7420 6265 2061 6e20 736b 6c65   Must be an skle
+00024780: 6172 6e20 6f72 206d 756c 7469 6f75 7470  arn or multioutp
+00024790: 7574 206d 6f64 656c 2e20 596f 7520 6361  ut model. You ca
+000247a0: 6e20 7472 7920 6f74 6865 7220 6d6f 6465  n try other mode
+000247b0: 6c73 0a20 2020 2020 2020 2020 2020 2062  ls.            b
+000247c0: 7574 2049 2068 6176 6520 6e6f 7420 7465  ut I have not te
+000247d0: 7374 6564 2069 742e 2049 7420 6d69 6768  sted it. It migh
+000247e0: 7420 776f 726b 2e0a 2020 2020 656e 636f  t work..    enco
+000247f0: 6465 7273 203a 2064 6566 6175 6c74 2069  ders : default i
+00024800: 7320 2261 7574 6f22 2e20 596f 7520 6361  s "auto". You ca
+00024810: 6e20 6c65 6176 6520 7468 6973 2061 7320  n leave this as 
+00024820: 6175 746f 2061 6e64 2069 7420 7769 6c6c  auto and it will
+00024830: 200a 2020 2020 2020 2020 2020 2020 6175   .            au
+00024840: 746f 6d61 7469 6361 6c6c 7920 6368 6f6f  tomatically choo
+00024850: 7365 2074 6865 2072 6967 6874 2065 6e63  se the right enc
+00024860: 6f64 6572 2066 6f72 2079 6f75 7220 6461  oder for your da
+00024870: 7461 7365 742e 2049 7420 7769 6c6c 0a20  taset. It will. 
+00024880: 2020 2020 2020 2020 2020 2075 7365 206f             use o
+00024890: 6e65 2d68 6f74 2065 6e63 6f64 696e 6720  ne-hot encoding 
+000248a0: 666f 7220 6c6f 7720 6361 7264 696e 616c  for low cardinal
+000248b0: 6974 7920 7661 7273 2061 6e64 206c 6162  ity vars and lab
+000248c0: 656c 2065 6e63 6f64 696e 670a 2020 2020  el encoding.    
+000248d0: 2020 2020 2020 2020 666f 7220 6869 6768          for high
+000248e0: 2063 6172 6469 6e61 6c69 7479 2076 6172   cardinality var
+000248f0: 732e 2059 6f75 2063 616e 2061 6c73 6f20  s. You can also 
+00024900: 7365 6e64 2065 6974 6865 7220 6f6e 6520  send either one 
+00024910: 6f72 2074 776f 2065 6e63 6f64 6572 730a  or two encoders.
+00024920: 2020 2020 2020 2020 2020 2020 6f66 2079              of y
+00024930: 6f75 7220 6f77 6e2e 2049 7420 6d75 7374  our own. It must
+00024940: 2062 6520 6120 7374 7269 6e67 2063 6f6e   be a string con
+00024950: 7369 7374 696e 6720 6f66 206f 6e65 206f  sisting of one o
+00024960: 6620 7468 6520 666f 6c6c 6f77 696e 673a  f the following:
+00024970: 0a20 2020 2020 2020 2020 2020 2027 6f6e  .            'on
+00024980: 6568 6f74 272c 276f 7264 696e 616c 272c  ehot','ordinal',
+00024990: 2768 6173 6869 6e67 272c 2768 6173 6827  'hashing','hash'
+000249a0: 2c27 636f 756e 7427 2c27 6361 7462 6f6f  ,'count','catboo
+000249b0: 7374 272c 2774 6172 6765 7427 2c27 676c  st','target','gl
+000249c0: 6d27 2c0a 2020 2020 2020 2020 2020 2020  m',.            
+000249d0: 2027 676c 6d6d 272c 2773 756d 272c 2777   'glmm','sum','w
+000249e0: 6f65 272c 2762 6463 272c 2762 6465 272c  oe','bdc','bde',
+000249f0: 276c 6f6f 272c 2762 6173 6527 2c27 6a61  'loo','base','ja
+00024a00: 6d65 7327 2c27 6a61 6d65 7373 7465 696e  mes','jamesstein
+00024a10: 272c 0a20 2020 2020 2020 2020 2020 2020  ',.             
+00024a20: 2768 656c 6d65 7274 272c 2771 7561 6e74  'helmert','quant
+00024a30: 696c 6527 2c27 7375 6d6d 6172 7927 2c20  ile','summary', 
+00024a40: 276c 6162 656c 272c 2761 7574 6f27 0a20  'label','auto'. 
+00024a50: 2020 2073 6361 6c65 7273 203a 2064 6566     scalers : def
+00024a60: 6175 6c74 2069 7320 4e6f 6e65 2e20 596f  ault is None. Yo
+00024a70: 7520 6361 6e20 7365 6e64 206f 6e65 206f  u can send one o
+00024a80: 6620 7468 6520 666f 6c6c 6f77 696e 6720  f the following 
+00024a90: 7374 7269 6e67 733a 0a20 2020 2020 2020  strings:.       
+00024aa0: 2020 2020 2027 7374 6427 2c20 2773 7461       'std', 'sta
+00024ab0: 6e64 6172 6427 2c20 276d 696e 6d61 7827  ndard', 'minmax'
+00024ac0: 2c20 276d 6178 272c 2027 726f 6275 7374  , 'max', 'robust
+00024ad0: 272c 2027 6d61 7861 6273 270a 2020 2020  ', 'maxabs'.    
+00024ae0: 6461 7465 5f74 6f5f 7374 7269 6e67 203a  date_to_string :
+00024af0: 2064 6566 6175 6c74 2069 7320 2727 2e20   default is ''. 
+00024b00: 4966 2079 6f75 2077 616e 7420 6f6e 6520  If you want one 
+00024b10: 6f72 206d 6f72 6520 6461 7465 2d74 696d  or more date-tim
+00024b20: 6520 636f 6c75 6d6e 7320 7768 6963 6820  e columns which 
+00024b30: 6172 650a 2020 2020 2020 2020 2020 2020  are.            
+00024b40: 6f62 6a65 6374 206f 7220 7374 7269 6e67  object or string
+00024b50: 2066 6f72 6d61 742c 2079 6f75 2063 616e   format, you can
+00024b60: 2073 656e 6420 7468 6f73 6520 636f 6c75   send those colu
+00024b70: 6d6e 206e 616d 6573 2068 6572 6520 616e  mn names here an
+00024b80: 6420 7468 6579 2077 696c 6c0a 2020 2020  d they will.    
+00024b90: 2020 2020 2020 2020 6265 2074 7265 6174          be treat
+00024ba0: 6564 2061 7320 7374 7269 6e67 2076 6172  ed as string var
+00024bb0: 6961 626c 6573 2061 6e64 2075 7365 6420  iables and used 
+00024bc0: 6173 204e 4c50 2076 6172 7320 666f 7220  as NLP vars for 
+00024bd0: 5446 4944 462e 2042 7574 200a 2020 2020  TFIDF. But .    
+00024be0: 2020 2020 2020 2020 6966 2079 6f75 206c          if you l
+00024bf0: 6561 7665 2069 7420 6173 2061 6e20 656d  eave it as an em
+00024c00: 7074 7920 7374 7269 6e67 2074 6865 6e20  pty string then 
+00024c10: 6966 2064 6174 652d 7469 6d65 2063 6f6c  if date-time col
+00024c20: 756d 6e73 2061 7265 2064 6574 6563 7465  umns are detecte
+00024c30: 640a 2020 2020 2020 2020 2020 2020 7468  d.            th
+00024c40: 6579 2077 696c 6c20 6265 2061 7574 6f6d  ey will be autom
+00024c50: 6174 6963 616c 6c79 2063 6f6e 7665 7274  atically convert
+00024c60: 6564 2074 6f20 6120 7061 6e64 6173 2064  ed to a pandas d
+00024c70: 6174 6574 696d 6520 7661 7269 6162 6c65  atetime variable
+00024c80: 2061 6e64 200a 2020 2020 2020 2020 2020   and .          
+00024c90: 2020 6d65 616e 696e 6766 756c 2066 6561    meaningful fea
+00024ca0: 7475 7265 7320 7769 6c6c 2062 6520 6578  tures will be ex
+00024cb0: 7472 6163 7465 6420 7375 6368 2061 7320  tracted such as 
+00024cc0: 6461 796f 6674 6865 7765 656b 2c20 6672  dayoftheweek, fr
+00024cd0: 6f6d 2069 742e 0a20 2020 2074 7261 6e73  om it..    trans
+00024ce0: 666f 726d 5f74 6172 6765 7420 3a20 6465  form_target : de
+00024cf0: 6661 756c 7420 6973 2046 616c 7365 2e20  fault is False. 
+00024d00: 4966 2054 7275 6520 2c20 7461 7267 6574  If True , target
+00024d10: 2063 6f6c 756d 6e28 7329 2077 696c 6c20   column(s) will 
+00024d20: 6265 200a 2020 2020 2020 2020 2020 2020  be .            
+00024d30: 636f 6e76 6572 7465 6420 746f 206e 756d  converted to num
+00024d40: 6265 7273 2061 6e64 2074 7265 6174 6564  bers and treated
+00024d50: 2061 7320 6e75 6d65 7269 632e 2049 6620   as numeric. If 
+00024d60: 4661 6c73 652c 2074 6172 6765 7428 7329  False, target(s)
+00024d70: 0a20 2020 2020 2020 2020 2020 2077 696c  .            wil
+00024d80: 6c20 6265 206c 6566 7420 6173 2074 6865  l be left as the
+00024d90: 7920 6172 6520 616e 6420 6e6f 7420 636f  y are and not co
+00024da0: 6e76 6572 7465 642e 0a20 2020 2069 6d62  nverted..    imb
+00024db0: 616c 616e 6365 6420 3a20 6465 6661 756c  alanced : defaul
+00024dc0: 7420 6973 2046 616c 7365 2e20 4966 2054  t is False. If T
+00024dd0: 7275 652c 2077 6520 7769 6c6c 2074 7279  rue, we will try
+00024de0: 2053 4d4f 5445 2069 6620 6e6f 206d 6f64   SMOTE if no mod
+00024df0: 656c 2069 7320 696e 7075 742e 0a20 2020  el is input..   
+00024e00: 2020 2020 2020 2020 2041 6c74 6572 6e61           Alterna
+00024e10: 7469 7665 6c79 2c20 6966 2061 206d 6f64  tively, if a mod
+00024e20: 656c 2069 7320 6769 7665 6e20 6173 2069  el is given as i
+00024e30: 6e70 7574 2c20 7468 656e 2053 4d4f 5445  nput, then SMOTE
+00024e40: 2077 696c 6c20 6e6f 7420 6265 2075 7365   will not be use
+00024e50: 642e 0a20 2020 2020 2020 2020 2020 2049  d..            I
+00024e60: 6e73 7465 6164 2c20 7765 2077 696c 6c20  nstead, we will 
+00024e70: 7772 6170 2074 6861 7420 6769 7665 6e20  wrap that given 
+00024e80: 6573 7469 6d61 746f 7220 696e 746f 2061  estimator into a
+00024e90: 0a20 2020 2020 2020 2020 2020 2061 2053  .            a S
+00024ea0: 7570 6572 204c 6561 726e 696e 6720 4f70  uper Learning Op
+00024eb0: 7469 6d69 7a65 6420 2853 554c 4f29 2065  timized (SULO) e
+00024ec0: 6e73 656d 626c 6520 6d6f 6465 6c0a 2020  nsemble model.  
+00024ed0: 2020 2020 2020 2020 2020 6361 6c6c 6564            called
+00024ee0: 2053 756c 6f43 6c61 7373 6966 6965 7220   SuloClassifier 
+00024ef0: 7769 6c6c 2077 696c 6c20 7065 7266 6f72  will will perfor
+00024f00: 6d20 7374 6163 6b69 6e67 2074 6861 7420  m stacking that 
+00024f10: 7769 6c6c 0a20 2020 2020 2020 2020 2020  will.           
+00024f20: 2074 7261 696e 206f 6e20 796f 7572 2069   train on your i
+00024f30: 6d62 616c 616e 6365 6420 6461 7461 2073  mbalanced data s
+00024f40: 6574 2e20 4966 2069 6d62 616c 616e 6365  et. If imbalance
+00024f50: 643d 4661 6c73 652c 2079 6f75 7220 6461  d=False, your da
+00024f60: 7461 2077 696c 6c20 6265 200a 2020 2020  ta will be .    
+00024f70: 2020 2020 2020 2020 6c65 6674 2061 7320          left as 
+00024f80: 6973 2061 6e64 206e 6f74 6869 6e67 2077  is and nothing w
+00024f90: 696c 6c20 6265 2064 6f6e 6520 746f 2069  ill be done to i
+00024fa0: 742e 0a20 2020 2073 6176 6520 3a20 6465  t..    save : de
+00024fb0: 6661 756c 7420 6973 2046 616c 7365 2e20  fault is False. 
+00024fc0: 4966 2054 7275 652c 2069 7420 7769 6c6c  If True, it will
+00024fd0: 2073 6176 6520 7468 6520 6461 7461 2061   save the data a
+00024fe0: 6e64 206d 6f64 656c 2070 6970 656c 696e  nd model pipelin
+00024ff0: 6520 696e 2061 200a 2020 2020 2020 2020  e in a .        
+00025000: 2020 2020 7069 636b 6c65 2066 696c 6520      pickle file 
+00025010: 696e 2074 6865 2063 7572 7265 6e74 2077  in the current w
+00025020: 6f72 6b69 6e67 2064 6972 6563 746f 7279  orking directory
+00025030: 2075 6e64 6572 2022 4c61 7a79 5472 616e   under "LazyTran
+00025040: 7366 6f72 6d65 725f 7069 7065 6c69 6e65  sformer_pipeline
+00025050: 2e70 6b6c 220a 2020 2020 2020 2020 2020  .pkl".          
+00025060: 2020 6669 6c65 206e 616d 652e 0a20 2020    file name..   
+00025070: 2063 6f6d 6269 6e65 5f72 6172 6520 3a20   combine_rare : 
+00025080: 6465 6661 756c 7420 6973 2046 616c 7365  default is False
+00025090: 2e20 4966 2054 7275 652c 2069 7420 7769  . If True, it wi
+000250a0: 6c6c 2063 6f6d 6269 6e65 2072 6172 6520  ll combine rare 
+000250b0: 6361 7465 676f 7269 6573 2069 6e20 796f  categories in yo
+000250c0: 7572 200a 2020 2020 2020 2020 2020 2020  ur .            
+000250d0: 6361 7465 676f 7269 6361 6c20 7661 7273  categorical vars
+000250e0: 2061 6e64 206d 616b 6520 7468 656d 2069   and make them i
+000250f0: 6e20 746f 2061 2073 696e 676c 6520 2272  n to a single "r
+00025100: 6172 655f 6361 7465 676f 7269 6573 2220  are_categories" 
+00025110: 636c 6173 732e 200a 2020 2020 2020 2020  class. .        
+00025120: 2020 2020 4966 2046 616c 7365 2c20 6e6f      If False, no
+00025130: 7468 696e 6720 7769 6c6c 2062 6520 646f  thing will be do
+00025140: 6e65 2074 6f20 796f 7572 2063 6174 6567  ne to your categ
+00025150: 6f72 6963 616c 2076 6172 732e 0a20 2020  orical vars..   
+00025160: 2076 6572 626f 7365 3a20 4966 2030 2c20   verbose: If 0, 
+00025170: 6e6f 7420 6d75 6368 2077 696c 6c20 6265  not much will be
+00025180: 2070 7269 6e74 6564 206f 6e20 7468 6520   printed on the 
+00025190: 7465 726d 696e 616c 2e20 4966 2031 206f  terminal. If 1 o
+000251a0: 7220 322c 206c 6f74 7320 6f66 200a 2020  r 2, lots of .  
+000251b0: 2020 2020 2020 2020 2020 7374 6570 7320            steps 
+000251c0: 7769 6c6c 2062 6520 7072 696e 7465 6420  will be printed 
+000251d0: 6f6e 2074 6865 2074 6572 6d69 6e61 6c2e  on the terminal.
+000251e0: 0a0a 2020 2020 2222 220a 2020 2020 6465  ..    """.    de
+000251f0: 6620 5f5f 696e 6974 5f5f 2873 656c 662c  f __init__(self,
+00025200: 206d 6f64 656c 3d4e 6f6e 652c 2065 6e63   model=None, enc
+00025210: 6f64 6572 733d 2761 7574 6f27 2c20 7363  oders='auto', sc
+00025220: 616c 6572 733d 4e6f 6e65 2c20 6461 7465  alers=None, date
+00025230: 5f74 6f5f 7374 7269 6e67 3d46 616c 7365  _to_string=False
+00025240: 2c20 0a20 2020 2020 2020 2020 2020 2020  , .             
+00025250: 2020 2020 2020 2074 7261 6e73 666f 726d         transform
+00025260: 5f74 6172 6765 743d 4661 6c73 652c 2069  _target=False, i
+00025270: 6d62 616c 616e 6365 643d 4661 6c73 652c  mbalanced=False,
+00025280: 2073 6176 653d 4661 6c73 652c 2063 6f6d   save=False, com
+00025290: 6269 6e65 5f72 6172 6520 3d20 4661 6c73  bine_rare = Fals
+000252a0: 652c 0a20 2020 2020 2020 2020 2020 2020  e,.             
+000252b0: 2020 2020 2020 2020 7665 7262 6f73 653d          verbose=
+000252c0: 3029 3a0a 2020 2020 2020 2020 2222 220a  0):.        """.
+000252d0: 2020 2020 2020 2020 4465 7363 7269 7074          Descript
+000252e0: 696f 6e20 6f66 205f 5f69 6e69 745f 5f0a  ion of __init__.
+000252f0: 0a20 2020 2020 2020 2041 7267 733a 0a20  .        Args:. 
+00025300: 2020 2020 2020 2020 2020 206d 6f64 656c             model
+00025310: 3d4e 6f6e 653a 2041 6e79 206d 6f64 656c  =None: Any model
+00025320: 2065 7370 2e20 7363 696b 6974 2d6c 6561   esp. scikit-lea
+00025330: 726e 206d 6f64 656c 2069 6620 796f 7520  rn model if you 
+00025340: 7761 6e74 2074 6f20 7265 7475 726e 2070  want to return p
+00025350: 6970 656c 696e 6520 7769 7468 2074 7261  ipeline with tra
+00025360: 696e 6564 206d 6f64 656c 2e0a 2020 2020  ined model..    
+00025370: 2020 2020 2020 2020 6461 7465 5f74 6f5f          date_to_
+00025380: 7374 7269 6e67 3d46 616c 7365 3a20 4966  string=False: If
+00025390: 2054 7275 652c 2069 7420 636f 6e76 6572   True, it conver
+000253a0: 7473 2064 6174 6520 636f 6c75 6d6e 7320  ts date columns 
+000253b0: 696e 2064 6174 6173 6574 2074 6f20 7374  in dataset to st
+000253c0: 7269 6e67 206f 626a 6563 7473 0a20 2020  ring objects.   
+000253d0: 2020 2020 2020 2020 2074 7261 6e73 666f           transfo
+000253e0: 726d 5f74 6172 6765 743d 4661 6c73 653a  rm_target=False:
+000253f0: 2055 7375 616c 6c79 206d 6f64 656c 7320   Usually models 
+00025400: 7365 6e74 2061 7320 696e 7075 7420 6172  sent as input ar
+00025410: 6520 736b 6c65 6172 6e2e 2049 6620 6e6f  e sklearn. If no
+00025420: 742c 2073 7769 7463 6820 7468 6973 2066  t, switch this f
+00025430: 6c61 6720 746f 2054 7275 652e 0a0a 2020  lag to True...  
+00025440: 2020 2020 2020 2222 220a 2020 2020 2020        """.      
+00025450: 2020 7365 6c66 2e64 6174 655f 746f 5f73    self.date_to_s
+00025460: 7472 696e 6720 3d20 6461 7465 5f74 6f5f  tring = date_to_
+00025470: 7374 7269 6e67 0a20 2020 2020 2020 2073  string.        s
+00025480: 656c 662e 656e 636f 6465 7273 203d 2065  elf.encoders = e
+00025490: 6e63 6f64 6572 730a 2020 2020 2020 2020  ncoders.        
+000254a0: 7365 6c66 2e73 6361 6c65 7273 203d 2073  self.scalers = s
+000254b0: 6361 6c65 7273 0a20 2020 2020 2020 2073  calers.        s
+000254c0: 656c 662e 696d 6261 6c61 6e63 6564 203d  elf.imbalanced =
+000254d0: 2069 6d62 616c 616e 6365 640a 2020 2020   imbalanced.    
+000254e0: 2020 2020 7365 6c66 2e76 6572 626f 7365      self.verbose
+000254f0: 203d 2076 6572 626f 7365 0a20 2020 2020   = verbose.     
+00025500: 2020 200a 2020 2020 2020 2020 7365 6c66     .        self
+00025510: 2e6d 6f64 656c 5f69 6e70 7574 203d 206d  .model_input = m
+00025520: 6f64 656c 0a20 2020 2020 2020 2069 6620  odel.        if 
+00025530: 6e6f 7420 7365 6c66 2e6d 6f64 656c 5f69  not self.model_i
+00025540: 6e70 7574 3a0a 2020 2020 2020 2020 2020  nput:.          
+00025550: 2020 7365 6c66 2e6d 6f64 656c 5f69 6e70    self.model_inp
+00025560: 7574 203d 204e 6f6e 650a 2020 2020 2020  ut = None.      
+00025570: 2020 7365 6c66 2e74 7261 6e73 666f 726d    self.transform
+00025580: 5f74 6172 6765 7420 3d20 7472 616e 7366  _target = transf
+00025590: 6f72 6d5f 7461 7267 6574 0a20 2020 2020  orm_target.     
+000255a0: 2020 2073 656c 662e 6669 7474 6564 203d     self.fitted =
+000255b0: 2046 616c 7365 0a20 2020 2020 2020 2073   False.        s
+000255c0: 656c 662e 7361 7665 203d 2073 6176 650a  elf.save = save.
+000255d0: 2020 2020 2020 2020 7365 6c66 2e63 6f6d          self.com
+000255e0: 6269 6e65 5f72 6172 6520 3d20 636f 6d62  bine_rare = comb
+000255f0: 696e 655f 7261 7265 0a0a 2020 2020 6465  ine_rare..    de
+00025600: 6620 6765 745f 7061 7261 6d73 2873 656c  f get_params(sel
+00025610: 662c 2064 6565 703d 5472 7565 293a 0a20  f, deep=True):. 
+00025620: 2020 2020 2020 2023 2054 6869 7320 6973         # This is
+00025630: 2074 6f20 6d61 6b65 2069 7420 7363 696b   to make it scik
+00025640: 6974 2d6c 6561 726e 2063 6f6d 7061 7469  it-learn compati
+00025650: 626c 6520 2323 2323 0a20 2020 2020 2020  ble ####.       
+00025660: 2072 6574 7572 6e20 7b22 6461 7465 5f74   return {"date_t
+00025670: 6f5f 7374 7269 6e67 223a 2073 656c 662e  o_string": self.
+00025680: 6461 7465 5f74 6f5f 7374 7269 6e67 2c20  date_to_string, 
+00025690: 2265 6e63 6f64 6572 7322 3a20 7365 6c66  "encoders": self
+000256a0: 2e65 6e63 6f64 6572 732c 0a20 2020 2020  .encoders,.     
+000256b0: 2020 2020 2020 2022 7363 616c 6572 7322         "scalers"
+000256c0: 3a20 7365 6c66 2e73 6361 6c65 7273 2c20  : self.scalers, 
+000256d0: 2269 6d62 616c 616e 6365 6422 3a20 7365  "imbalanced": se
+000256e0: 6c66 2e69 6d62 616c 616e 6365 642c 200a  lf.imbalanced, .
+000256f0: 2020 2020 2020 2020 2020 2020 2276 6572              "ver
+00025700: 626f 7365 223a 2073 656c 662e 7665 7262  bose": self.verb
+00025710: 6f73 652c 2022 7472 616e 7366 6f72 6d5f  ose, "transform_
+00025720: 7461 7267 6574 223a 2073 656c 662e 7472  target": self.tr
+00025730: 616e 7366 6f72 6d5f 7461 7267 6574 2c0a  ansform_target,.
+00025740: 2020 2020 2020 2020 2020 2020 226d 6f64              "mod
+00025750: 656c 223a 2073 656c 662e 6d6f 6465 6c5f  el": self.model_
+00025760: 696e 7075 742c 2022 636f 6d62 696e 655f  input, "combine_
+00025770: 7261 7265 223a 2073 656c 662e 636f 6d62  rare": self.comb
+00025780: 696e 655f 7261 7265 2c7d 0a0a 2020 2020  ine_rare,}..    
+00025790: 6465 6620 7365 745f 7061 7261 6d73 2873  def set_params(s
+000257a0: 656c 662c 202a 2a70 6172 616d 6574 6572  elf, **parameter
+000257b0: 7329 3a0a 2020 2020 2020 2020 666f 7220  s):.        for 
+000257c0: 7061 7261 6d65 7465 722c 2076 616c 7565  parameter, value
+000257d0: 2069 6e20 7061 7261 6d65 7465 7273 2e69   in parameters.i
+000257e0: 7465 6d73 2829 3a0a 2020 2020 2020 2020  tems():.        
+000257f0: 2020 2020 7365 7461 7474 7228 7365 6c66      setattr(self
+00025800: 2c20 7061 7261 6d65 7465 722c 2076 616c  , parameter, val
+00025810: 7565 290a 2020 2020 2020 2020 7265 7475  ue).        retu
+00025820: 726e 2073 656c 660a 0a0a 2020 2020 6465  rn self...    de
+00025830: 6620 6669 7428 7365 6c66 2c20 583a 2070  f fit(self, X: p
+00025840: 642e 4461 7461 4672 616d 652c 2079 3a20  d.DataFrame, y: 
+00025850: 7064 2e44 6174 6146 7261 6d65 293a 0a20  pd.DataFrame):. 
+00025860: 2020 2020 2020 2022 2222 0a20 2020 2020         """.     
+00025870: 2020 2044 6573 6372 6970 7469 6f6e 206f     Description o
+00025880: 6620 6669 7420 6d65 7468 6f64 0a0a 2020  f fit method..  
+00025890: 2020 2020 2020 4172 6773 3a0a 2020 2020        Args:.    
+000258a0: 2020 2020 2020 2020 5820 2870 642e 4461          X (pd.Da
+000258b0: 7461 4672 616d 6529 3a20 6461 7461 7365  taFrame): datase
+000258c0: 740a 2020 2020 2020 2020 2020 2020 793d  t.            y=
+000258d0: 4e6f 6e65 2028 7064 2e53 6572 6965 7320  None (pd.Series 
+000258e0: 6f72 2070 642e 4461 7461 4672 616d 6529  or pd.DataFrame)
+000258f0: 3a20 7461 7267 6574 2063 6f6c 756d 6e28  : target column(
+00025900: 7329 0a0a 2020 2020 2020 2020 5265 7475  s)..        Retu
+00025910: 726e 733a 0a20 2020 2020 2020 2020 2020  rns:.           
+00025920: 2041 2053 6369 6b69 742d 4c65 6172 6e20   A Scikit-Learn 
+00025930: 5069 7065 6c69 6e65 206f 626a 6563 7420  Pipeline object 
+00025940: 7468 6174 2079 6f75 2063 616e 2064 6f20  that you can do 
+00025950: 7468 6520 666f 6c6c 6f77 696e 673a 0a20  the following:. 
+00025960: 2020 2020 2020 2020 2020 2020 2020 2069                 i
+00025970: 6620 6d6f 6465 6c66 6f72 6d65 723d 5472  f modelformer=Tr
+00025980: 7565 2c20 7468 656e 2079 6f75 2063 616e  ue, then you can
+00025990: 2064 6f20 6669 7428 2920 616e 6420 7072   do fit() and pr
+000259a0: 6564 6963 7428 2920 7769 7468 206d 6f64  edict() with mod
+000259b0: 656c 0a20 2020 2020 2020 2020 2020 2020  el.             
+000259c0: 2020 2069 6620 6d6f 6465 6c66 6f72 6d65     if modelforme
+000259d0: 723d 4661 6c73 652c 2074 6865 6e20 796f  r=False, then yo
+000259e0: 7520 6361 6e20 646f 206f 6e6c 7920 6669  u can do only fi
+000259f0: 745f 7472 616e 7366 6f72 6d28 2920 616e  t_transform() an
+00025a00: 6420 7072 6564 6963 7428 290a 2020 2020  d predict().    
+00025a10: 2020 2020 2222 220a 2020 2020 2020 2020      """.        
+00025a20: 7365 6c66 2e78 666f 726d 6572 203d 204e  self.xformer = N
+00025a30: 6f6e 650a 2020 2020 2020 2020 7365 6c66  one.        self
+00025a40: 2e79 666f 726d 6572 203d 204e 6f6e 650a  .yformer = None.
+00025a50: 2020 2020 2020 2020 7365 6c66 2e69 6d62          self.imb
+00025a60: 616c 616e 6365 645f 6669 7273 745f 646f  alanced_first_do
+00025a70: 6e65 203d 2046 616c 7365 0a20 2020 2020  ne = False.     
+00025a80: 2020 2073 656c 662e 736d 6f74 6578 203d     self.smotex =
+00025a90: 204e 6f6e 650a 2020 2020 2020 2020 5820   None.        X 
+00025aa0: 3d20 636f 7079 2e64 6565 7063 6f70 7928  = copy.deepcopy(
+00025ab0: 5829 0a20 2020 2020 2020 2073 656c 662e  X).        self.
+00025ac0: 585f 696e 6465 7820 3d20 582e 696e 6465  X_index = X.inde
+00025ad0: 780a 2020 2020 2020 2020 6966 2079 2069  x.        if y i
+00025ae0: 7320 6e6f 7420 4e6f 6e65 3a0a 2020 2020  s not None:.    
+00025af0: 2020 2020 2020 2020 7365 6c66 2e79 5f69          self.y_i
+00025b00: 6e64 6578 203d 2079 2e69 6e64 6578 0a20  ndex = y.index. 
+00025b10: 2020 2020 2020 2023 5820 3d20 582e 7265         #X = X.re
+00025b20: 6e61 6d65 2863 6f6c 756d 6e73 203d 206c  name(columns = l
+00025b30: 616d 6264 6120 783a 7265 2e73 7562 2827  ambda x:re.sub('
+00025b40: 5b5e 412d 5a61 2d7a 302d 395f 5d2b 272c  [^A-Za-z0-9_]+',
+00025b50: 2027 272c 2078 2929 0a20 2020 2020 2020   '', x)).       
+00025b60: 200a 2020 2020 2020 2020 7920 3d20 636f   .        y = co
+00025b70: 7079 2e64 6565 7063 6f70 7928 7929 0a20  py.deepcopy(y). 
+00025b80: 2020 2020 2020 2069 6620 792e 6e64 696d         if y.ndim
+00025b90: 203e 3d20 323a 0a20 2020 2020 2020 2020   >= 2:.         
+00025ba0: 2020 206d 6f64 656c 7479 7065 2c20 6d75     modeltype, mu
+00025bb0: 6c74 695f 6c61 6265 6c20 3d20 616e 616c  lti_label = anal
+00025bc0: 797a 655f 7072 6f62 6c65 6d5f 7479 7065  yze_problem_type
+00025bd0: 2879 2c20 7461 7267 6574 3d79 2e63 6f6c  (y, target=y.col
+00025be0: 756d 6e73 2e74 6f6c 6973 7428 292c 2076  umns.tolist(), v
+00025bf0: 6572 626f 7365 3d30 290a 2020 2020 2020  erbose=0).      
+00025c00: 2020 656c 7365 3a0a 2020 2020 2020 2020    else:.        
+00025c10: 2020 2020 6d6f 6465 6c74 7970 652c 206d      modeltype, m
+00025c20: 756c 7469 5f6c 6162 656c 203d 2061 6e61  ulti_label = ana
+00025c30: 6c79 7a65 5f70 726f 626c 656d 5f74 7970  lyze_problem_typ
+00025c40: 6528 792c 2074 6172 6765 743d 792e 6e61  e(y, target=y.na
+00025c50: 6d65 2c20 7665 7262 6f73 653d 3029 0a20  me, verbose=0). 
+00025c60: 2020 2020 2020 2069 6620 6d6f 6465 6c74         if modelt
+00025c70: 7970 6520 3d3d 2027 5265 6772 6573 7369  ype == 'Regressi
+00025c80: 6f6e 2720 616e 6420 7365 6c66 2e74 7261  on' and self.tra
+00025c90: 6e73 666f 726d 5f74 6172 6765 743a 0a20  nsform_target:. 
+00025ca0: 2020 2020 2020 2020 2020 2070 7269 6e74             print
+00025cb0: 2822 2020 2020 5265 6772 6573 7369 6f6e  ("    Regression
+00025cc0: 206d 6f64 656c 7320 646f 6e27 7420 6e65   models don't ne
+00025cd0: 6564 2074 6172 6765 7473 2074 6f20 6265  ed targets to be
+00025ce0: 2074 7261 6e73 666f 726d 6564 2074 6f20   transformed to 
+00025cf0: 6e75 6d65 7269 632e 2e2e 2229 2020 2020  numeric...")    
+00025d00: 2020 2020 2020 2020 2020 2020 200a 2020               .  
+00025d10: 2020 2020 2020 2020 2020 7365 6c66 2e74            self.t
+00025d20: 7261 6e73 666f 726d 5f74 6172 6765 7420  ransform_target 
+00025d30: 3d20 4661 6c73 650a 2020 2020 2020 2020  = False.        
+00025d40: 6966 206d 6f64 656c 7479 7065 203d 3d20  if modeltype == 
+00025d50: 2752 6567 7265 7373 696f 6e27 2061 6e64  'Regression' and
+00025d60: 2073 656c 662e 696d 6261 6c61 6e63 6564   self.imbalanced
+00025d70: 3a0a 2020 2020 2020 2020 2020 2020 7072  :.            pr
+00025d80: 696e 7428 2220 2020 2052 6567 7265 7373  int("    Regress
+00025d90: 696f 6e20 6d6f 6465 6c73 2064 6f6e 2774  ion models don't
+00025da0: 206e 6565 6420 696d 6261 6c61 6e63 6564   need imbalanced
+00025db0: 2066 6c61 6720 7365 7420 746f 2054 7275   flag set to Tru
+00025dc0: 652e 2e2e 2229 2020 2020 2020 2020 2020  e...")          
+00025dd0: 2020 2020 2020 200a 2020 2020 2020 2020         .        
+00025de0: 2020 2020 7365 6c66 2e69 6d62 616c 616e      self.imbalan
+00025df0: 6365 6420 3d20 4661 6c73 650a 2020 2020  ced = False.    
+00025e00: 2020 2020 2323 2320 6966 2074 6865 7265      ### if there
+00025e10: 2069 7320 6120 666c 6167 2061 6e64 2069   is a flag and i
+00025e20: 7420 6973 2061 2063 6c61 7373 6966 6963  t is a classific
+00025e30: 6174 696f 6e2c 2064 6f20 6974 2023 2323  ation, do it ###
+00025e40: 0a20 2020 2020 2020 2069 6620 7365 6c66  .        if self
+00025e50: 2e74 7261 6e73 666f 726d 5f74 6172 6765  .transform_targe
+00025e60: 743a 0a20 2020 2020 2020 2020 2020 2023  t:.            #
+00025e70: 2323 2048 656e 6365 2059 5472 616e 7366  ## Hence YTransf
+00025e80: 6f72 6d65 7220 636f 6e76 6572 7473 2074  ormer converts t
+00025e90: 6865 6d20 6265 666f 7265 2066 6565 6469  hem before feedi
+00025ea0: 6e67 206d 6f64 656c 0a20 2020 2020 2020  ng model.       
+00025eb0: 2020 2020 2073 656c 662e 7966 6f72 6d65       self.yforme
+00025ec0: 7220 3d20 5954 7261 6e73 666f 726d 6572  r = YTransformer
+00025ed0: 2829 0a20 2020 2020 2020 2023 2323 2320  ().        #### 
+00025ee0: 5468 6973 2069 7320 7768 6572 6520 7765  This is where we
+00025ef0: 2062 7569 6c64 2070 6970 656c 696e 6573   build pipelines
+00025f00: 2066 6f72 2058 2061 6e64 2079 2023 2323   for X and y ###
+00025f10: 2323 2323 2323 2323 2323 0a20 2020 2020  ##########.     
+00025f20: 2020 2073 7461 7274 5f74 696d 6520 3d20     start_time = 
+00025f30: 7469 6d65 2e74 696d 6528 290a 2020 2020  time.time().    
+00025f40: 2020 2020 0a20 2020 2020 2020 2069 6620      .        if 
+00025f50: 7365 6c66 2e6d 6f64 656c 5f69 6e70 7574  self.model_input
+00025f60: 2069 7320 6e6f 7420 4e6f 6e65 3a0a 2020   is not None:.  
+00025f70: 2020 2020 2020 2020 2020 2323 2320 4966            ### If
+00025f80: 2061 206d 6f64 656c 2069 7320 6769 7665   a model is give
+00025f90: 6e2c 2074 6865 6e20 6164 6420 6974 2074  n, then add it t
+00025fa0: 6f20 7069 7065 6c69 6e65 2061 6e64 2066  o pipeline and f
+00025fb0: 6974 2069 7420 2323 230a 2020 2020 2020  it it ###.      
+00025fc0: 2020 2020 2020 6461 7461 5f70 6970 6520        data_pipe 
+00025fd0: 3d20 6d61 6b65 5f73 696d 706c 655f 7069  = make_simple_pi
+00025fe0: 7065 6c69 6e65 2858 2c20 792c 2065 6e63  peline(X, y, enc
+00025ff0: 6f64 6572 733d 7365 6c66 2e65 6e63 6f64  oders=self.encod
+00026000: 6572 732c 2073 6361 6c65 7273 3d73 656c  ers, scalers=sel
+00026010: 662e 7363 616c 6572 732c 0a20 2020 2020  f.scalers,.     
+00026020: 2020 2020 2020 2020 2020 2064 6174 655f             date_
+00026030: 746f 5f73 7472 696e 673d 7365 6c66 2e64  to_string=self.d
+00026040: 6174 655f 746f 5f73 7472 696e 672c 2073  ate_to_string, s
+00026050: 6176 655f 666c 6167 203d 2073 656c 662e  ave_flag = self.
+00026060: 7361 7665 2c20 0a20 2020 2020 2020 2020  save, .         
+00026070: 2020 2020 2020 2063 6f6d 6269 6e65 5f72         combine_r
+00026080: 6172 655f 666c 6167 3d73 656c 662e 636f  are_flag=self.co
+00026090: 6d62 696e 655f 7261 7265 2c20 7665 7262  mbine_rare, verb
+000260a0: 6f73 653d 7365 6c66 2e76 6572 626f 7365  ose=self.verbose
+000260b0: 290a 2020 2020 2020 2020 2020 2020 0a20  ).            . 
+000260c0: 2020 2020 2020 2020 2020 2023 2323 2054             ### T
+000260d0: 6865 7265 2069 7320 6e6f 2059 5472 616e  here is no YTran
+000260e0: 7366 6f72 6d65 7220 696e 2074 6869 7320  sformer in this 
+000260f0: 7069 7065 6c69 6e65 2073 6f20 7461 7267  pipeline so targ
+00026100: 6574 7320 6d75 7374 2062 6520 7369 6e67  ets must be sing
+00026110: 6c65 206c 6162 656c 206f 6e6c 7920 2323  le label only ##
+00026120: 0a20 2020 2020 2020 2020 2020 206d 6f64  .            mod
+00026130: 656c 5f6e 616d 6520 3d20 7374 7228 7365  el_name = str(se
+00026140: 6c66 2e6d 6f64 656c 5f69 6e70 7574 292e  lf.model_input).
+00026150: 7370 6c69 7428 2228 2229 5b30 5d20 2020  split("(")[0]   
+00026160: 2020 2020 2020 2020 200a 2020 2020 2020           .      
+00026170: 2020 2020 2020 6966 2079 2e6e 6469 6d20        if y.ndim 
+00026180: 3e3d 2032 3a0a 2020 2020 2020 2020 2020  >= 2:.          
+00026190: 2020 2020 2020 2323 2320 496e 2073 6f6d        ### In som
+000261a0: 6520 6361 7365 732c 2069 6620 7920 6973  e cases, if y is
+000261b0: 2061 2044 6174 6146 7261 6d65 2077 6974   a DataFrame wit
+000261c0: 6820 6f6e 6520 636f 6c75 6d6e 2061 6c73  h one column als
+000261d0: 6f2c 2079 6f75 2067 6574 2074 6865 7365  o, you get these
+000261e0: 2073 6974 7561 7469 6f6e 732e 0a20 2020   situations..   
+000261f0: 2020 2020 2020 2020 2020 2020 2069 6620               if 
+00026200: 792e 7368 6170 655b 315d 203d 3d20 313a  y.shape[1] == 1:
+00026210: 0a20 2020 2020 2020 2020 2020 2020 2020  .               
+00026220: 2020 2020 2023 2320 496e 2074 6869 7320       ## In this 
+00026230: 6361 7365 2c20 7920 6861 7320 6f6e 6c79  case, y has only
+00026240: 206f 6e65 2063 6f6c 756d 6e20 6865 6e63   one column henc
+00026250: 652c 2079 6f75 2063 616e 2075 7365 2061  e, you can use a
+00026260: 206d 6f64 656c 2070 6970 656c 696e 6520   model pipeline 
+00026270: 2323 0a20 2020 2020 2020 2020 2020 2020  ##.             
+00026280: 2020 2020 2020 2069 6620 6d6f 6465 6c5f         if model_
+00026290: 6e61 6d65 203d 3d20 2727 3a20 0a20 2020  name == '': .   
+000262a0: 2020 2020 2020 2020 2020 2020 2020 2020                  
+000262b0: 2020 2020 2070 7269 6e74 2827 4e6f 206d       print('No m
+000262c0: 6f64 656c 206e 616d 6520 7370 6563 6966  odel name specif
+000262d0: 6965 6427 290a 2020 2020 2020 2020 2020  ied').          
+000262e0: 2020 2020 2020 2020 2020 2020 2020 7365                se
+000262f0: 6c66 2e6d 6f64 656c 5f69 6e70 7574 203d  lf.model_input =
+00026300: 204e 6f6e 650a 2020 2020 2020 2020 2020   None.          
+00026310: 2020 2020 2020 2020 2020 2020 2020 6d6c                ml
+00026320: 5f70 6970 6520 3d20 5069 7065 6c69 6e65  _pipe = Pipeline
+00026330: 285b 2827 6461 7461 5f70 6970 656c 696e  ([('data_pipelin
+00026340: 6527 2c20 6461 7461 5f70 6970 6529 2c5d  e', data_pipe),]
+00026350: 290a 2020 2020 2020 2020 2020 2020 2020  ).              
+00026360: 2020 2020 2020 656c 7365 3a0a 2020 2020        else:.    
+00026370: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00026380: 2020 2020 6d6c 5f70 6970 6520 3d20 5069      ml_pipe = Pi
+00026390: 7065 6c69 6e65 285b 2827 6461 7461 5f70  peline([('data_p
+000263a0: 6970 656c 696e 6527 2c20 6461 7461 5f70  ipeline', data_p
+000263b0: 6970 6529 2c20 2827 6d6f 6465 6c27 2c20  ipe), ('model', 
+000263c0: 7365 6c66 2e6d 6f64 656c 5f69 6e70 7574  self.model_input
+000263d0: 295d 290a 2020 2020 2020 2020 2020 2020  )]).            
+000263e0: 2020 2020 656c 6966 206d 6f64 656c 5f6e      elif model_n
+000263f0: 616d 6520 3d3d 2027 273a 200a 2020 2020  ame == '': .    
+00026400: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00026410: 7072 696e 7428 274e 6f20 6d6f 6465 6c20  print('No model 
+00026420: 6e61 6d65 2073 7065 6369 6669 6564 2729  name specified')
+00026430: 0a20 2020 2020 2020 2020 2020 2020 2020  .               
+00026440: 2020 2020 2073 656c 662e 6d6f 6465 6c5f       self.model_
+00026450: 696e 7075 7420 3d20 4e6f 6e65 0a20 2020  input = None.   
+00026460: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00026470: 206d 6c5f 7069 7065 203d 2050 6970 656c   ml_pipe = Pipel
+00026480: 696e 6528 5b28 2764 6174 615f 7069 7065  ine([('data_pipe
+00026490: 6c69 6e65 272c 2064 6174 615f 7069 7065  line', data_pipe
+000264a0: 292c 5d29 0a20 2020 2020 2020 2020 2020  ),]).           
+000264b0: 2020 2020 2065 6c69 6620 6d6f 6465 6c5f       elif model_
+000264c0: 6e61 6d65 206e 6f74 2069 6e20 5b27 4d75  name not in ['Mu
+000264d0: 6c74 694f 7574 7075 7443 6c61 7373 6966  ltiOutputClassif
+000264e0: 6965 7227 2c27 4d75 6c74 694f 7574 7075  ier','MultiOutpu
+000264f0: 7452 6567 7265 7373 6f72 275d 3a0a 2020  tRegressor']:.  
+00026500: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00026510: 2020 2323 2320 496e 2074 6869 7320 6361    ### In this ca
+00026520: 7365 2c20 7920 6861 7320 6d6f 7265 2074  se, y has more t
+00026530: 6861 6e20 3120 636f 6c75 6d6e 2c20 6865  han 1 column, he
+00026540: 6e63 6520 6966 2069 7420 6973 206e 6f74  nce if it is not
+00026550: 2061 206d 756c 7469 6f75 7470 7574 206d   a multioutput m
+00026560: 6f64 656c 2c20 6769 7665 2065 7272 6f72  odel, give error
+00026570: 0a20 2020 2020 2020 2020 2020 2020 2020  .               
+00026580: 2020 2020 2070 7269 6e74 2827 2020 2020       print('    
+00026590: 416c 6572 743a 204d 756c 7469 2d4c 6162  Alert: Multi-Lab
+000265a0: 656c 2070 726f 626c 656d 202d 206d 616b  el problem - mak
+000265b0: 6520 7375 7265 2079 6f75 7220 696e 7075  e sure your inpu
+000265c0: 7420 6d6f 6465 6c20 6361 6e20 646f 204d  t model can do M
+000265d0: 756c 7469 4f75 7470 7574 2127 290a 2020  ultiOutput!').  
+000265e0: 2020 2020 2020 2020 2020 2020 2020 2020                  
+000265f0: 2020 6d6c 5f70 6970 6520 3d20 5069 7065    ml_pipe = Pipe
+00026600: 6c69 6e65 285b 2827 6461 7461 5f70 6970  line([('data_pip
+00026610: 656c 696e 6527 2c20 6461 7461 5f70 6970  eline', data_pip
+00026620: 6529 2c20 2827 6d6f 6465 6c27 2c20 7365  e), ('model', se
+00026630: 6c66 2e6d 6f64 656c 5f69 6e70 7574 295d  lf.model_input)]
+00026640: 290a 2020 2020 2020 2020 2020 2020 2020  ).              
+00026650: 2020 656c 7365 3a0a 2020 2020 2020 2020    else:.        
+00026660: 2020 2020 2020 2020 2020 2020 2323 2049              ## I
+00026670: 6e20 7468 6973 2063 6173 6520 7765 2068  n this case we h
+00026680: 6176 6520 6120 6d75 6c74 6920 6f75 7470  ave a multi outp
+00026690: 7574 206d 6f64 656c 2e20 536f 206c 6574  ut model. So let
+000266a0: 2773 2075 7365 2069 7420 2323 230a 2020  's use it ###.  
+000266b0: 2020 2020 2020 2020 2020 2020 2020 2020                  
+000266c0: 2020 236d 6c5f 7069 7065 203d 206d 616b    #ml_pipe = mak
+000266d0: 655f 7069 7065 6c69 6e65 2864 6174 615f  e_pipeline(data_
+000266e0: 7069 7065 2c20 7365 6c66 2e6d 6f64 656c  pipe, self.model
+000266f0: 5f69 6e70 7574 290a 2020 2020 2020 2020  _input).        
+00026700: 2020 2020 2020 2020 2020 2020 6d6c 5f70              ml_p
+00026710: 6970 6520 3d20 5069 7065 6c69 6e65 285b  ipe = Pipeline([
+00026720: 2827 6461 7461 5f70 6970 656c 696e 6527  ('data_pipeline'
+00026730: 2c20 6461 7461 5f70 6970 6529 2c20 2827  , data_pipe), ('
+00026740: 6d6f 6465 6c27 2c20 7365 6c66 2e6d 6f64  model', self.mod
+00026750: 656c 5f69 6e70 7574 295d 290a 2020 2020  el_input)]).    
+00026760: 2020 2020 2020 2020 656c 7365 3a0a 2020          else:.  
+00026770: 2020 2020 2020 2020 2020 2020 2020 2323                ##
+00026780: 2320 596f 7520 646f 6e27 7420 6e65 6564  # You don't need
+00026790: 2059 5472 616e 7366 6f72 6d65 7220 7369   YTransformer si
+000267a0: 6e63 6520 6974 2069 7320 6120 7369 6d70  nce it is a simp
+000267b0: 6c65 2073 6b6c 6561 726e 206d 6f64 656c  le sklearn model
+000267c0: 0a20 2020 2020 2020 2020 2020 2020 2020  .               
+000267d0: 2023 6d6c 5f70 6970 6520 3d20 6d61 6b65   #ml_pipe = make
+000267e0: 5f70 6970 656c 696e 6528 6461 7461 5f70  _pipeline(data_p
+000267f0: 6970 652c 2073 656c 662e 6d6f 6465 6c5f  ipe, self.model_
+00026800: 696e 7075 7429 0a20 2020 2020 2020 2020  input).         
+00026810: 2020 2020 2020 206d 6c5f 7069 7065 203d         ml_pipe =
+00026820: 2050 6970 656c 696e 6528 5b28 2764 6174   Pipeline([('dat
+00026830: 615f 7069 7065 6c69 6e65 272c 2064 6174  a_pipeline', dat
+00026840: 615f 7069 7065 292c 2028 276d 6f64 656c  a_pipe), ('model
+00026850: 272c 2073 656c 662e 6d6f 6465 6c5f 696e  ', self.model_in
+00026860: 7075 7429 5d29 0a20 2020 2020 2020 2020  put)]).         
+00026870: 2020 2023 2320 2020 4e6f 7720 7765 2066     ##   Now we f
+00026880: 6974 2074 6865 206d 6f64 656c 2070 6970  it the model pip
+00026890: 656c 696e 6520 746f 2058 2061 6e64 2079  eline to X and y
+000268a0: 2023 2323 0a20 2020 2020 2020 2020 2020   ###.           
+000268b0: 2074 7279 3a0a 2020 2020 2020 2020 2020   try:.          
+000268c0: 2020 2020 2020 0a20 2020 2020 2020 2020        .         
+000268d0: 2020 2020 2020 2023 2323 2320 5468 6973         #### This
+000268e0: 2069 7320 6120 7665 7279 2069 6d70 6f72   is a very impor
+000268f0: 7461 6e74 2073 6574 206f 6620 7374 6174  tant set of stat
+00026900: 656d 656e 7473 2023 2323 230a 2020 2020  ements ####.    
+00026910: 2020 2020 2020 2020 2020 2020 6966 2073              if s
+00026920: 656c 662e 7472 616e 7366 6f72 6d5f 7461  elf.transform_ta
+00026930: 7267 6574 3a0a 2020 2020 2020 2020 2020  rget:.          
+00026940: 2020 2020 2020 2020 2020 6966 2079 2069            if y i
+00026950: 7320 6e6f 7420 4e6f 6e65 3a0a 2020 2020  s not None:.    
+00026960: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00026970: 2020 2020 7365 6c66 2e79 5f69 6e64 6578      self.y_index
+00026980: 203d 2079 2e69 6e64 6578 0a20 2020 2020   = y.index.     
+00026990: 2020 2020 2020 2020 2020 2020 2020 2073                 s
+000269a0: 656c 662e 7966 6f72 6d65 722e 6669 7428  elf.yformer.fit(
+000269b0: 7929 0a20 2020 2020 2020 2020 2020 2020  y).             
+000269c0: 2020 2020 2020 2079 7420 3d20 7365 6c66         yt = self
+000269d0: 2e79 666f 726d 6572 2e74 7261 6e73 666f  .yformer.transfo
+000269e0: 726d 2879 290a 2020 2020 2020 2020 2020  rm(y).          
+000269f0: 2020 2020 2020 2020 2020 7072 696e 7428            print(
+00026a00: 2720 2020 2074 7261 6e73 666f 726d 6564  '    transformed
+00026a10: 2074 6172 6765 7420 6672 6f6d 206f 626a   target from obj
+00026a20: 6563 7420 7479 7065 2074 6f20 6e75 6d65  ect type to nume
+00026a30: 7269 6327 290a 0a20 2020 2020 2020 2020  ric')..         
+00026a40: 2020 2020 2020 2020 2020 2069 6620 7920             if y 
+00026a50: 6973 206e 6f74 204e 6f6e 653a 0a20 2020  is not None:.   
+00026a60: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00026a70: 2020 2020 2079 742e 696e 6465 7820 3d20       yt.index = 
+00026a80: 7365 6c66 2e79 5f69 6e64 6578 0a20 2020  self.y_index.   
+00026a90: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00026aa0: 2023 2323 204d 616b 6520 7375 7265 2079   ### Make sure y
+00026ab0: 6f75 206c 6561 7665 2073 656c 662e 6d6f  ou leave self.mo
+00026ac0: 6465 6c5f 696e 7075 7420 6173 204e 6f6e  del_input as Non
+00026ad0: 6520 7768 656e 2074 6865 7265 2069 7320  e when there is 
+00026ae0: 6e6f 206d 6f64 656c 2023 2323 200a 2020  no model ### .  
+00026af0: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00026b00: 2020 6966 206d 6f64 656c 5f6e 616d 6520    if model_name 
+00026b10: 3d3d 2027 273a 200a 2020 2020 2020 2020  == '': .        
+00026b20: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00026b30: 7365 6c66 2e6d 6f64 656c 5f69 6e70 7574  self.model_input
+00026b40: 203d 204e 6f6e 650a 2020 2020 2020 2020   = None.        
+00026b50: 2020 2020 2020 2020 2020 2020 656c 7365              else
+00026b60: 3a0a 2020 2020 2020 2020 2020 2020 2020  :.              
+00026b70: 2020 2020 2020 2020 2020 6d6c 5f70 6970            ml_pip
+00026b80: 652e 6669 7428 582c 7974 290a 2020 2020  e.fit(X,yt).    
+00026b90: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00026ba0: 2020 2020 7365 6c66 2e78 666f 726d 6572      self.xformer
+00026bb0: 203d 206d 6c5f 7069 7065 0a20 2020 2020   = ml_pipe.     
+00026bc0: 2020 2020 2020 2020 2020 2065 6c73 653a             else:
+00026bd0: 0a20 2020 2020 2020 2020 2020 2020 2020  .               
+00026be0: 2020 2020 2023 2323 204d 616b 6520 7375       ### Make su
+00026bf0: 7265 2079 6f75 206c 6561 7665 2073 656c  re you leave sel
+00026c00: 662e 6d6f 6465 6c20 6173 204e 6f6e 6520  f.model as None 
+00026c10: 7768 656e 2074 6865 7265 2069 7320 6e6f  when there is no
+00026c20: 206d 6f64 656c 2023 2323 200a 2020 2020   model ### .    
+00026c30: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00026c40: 6966 206d 6f64 656c 5f6e 616d 6520 3d3d  if model_name ==
+00026c50: 2027 273a 200a 2020 2020 2020 2020 2020   '': .          
+00026c60: 2020 2020 2020 2020 2020 2020 2020 7365                se
+00026c70: 6c66 2e6d 6f64 656c 203d 204e 6f6e 650a  lf.model = None.
+00026c80: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00026c90: 2020 2020 656c 7365 3a0a 2020 2020 2020      else:.      
+00026ca0: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00026cb0: 2020 6d6c 5f70 6970 652e 6669 7428 582c    ml_pipe.fit(X,
+00026cc0: 7929 0a20 2020 2020 2020 2020 2020 2020  y).             
+00026cd0: 2020 2020 2020 2020 2020 2073 656c 662e             self.
+00026ce0: 7866 6f72 6d65 7220 3d20 6d6c 5f70 6970  xformer = ml_pip
+00026cf0: 650a 2020 2020 2020 2020 2020 2020 6578  e.            ex
+00026d00: 6365 7074 2045 7863 6570 7469 6f6e 2061  cept Exception a
+00026d10: 7320 653a 0a20 2020 2020 2020 2020 2020  s e:.           
+00026d20: 2020 2020 2070 7269 6e74 2827 4572 726f       print('Erro
+00026d30: 7269 6e67 2064 7565 2074 6f20 2573 3a20  ring due to %s: 
+00026d40: 5468 6572 6520 6d61 7920 6265 2073 6f6d  There may be som
+00026d50: 6574 6869 6e67 2077 726f 6e67 2077 6974  ething wrong wit
+00026d60: 6820 796f 7572 2064 6174 6120 7479 7065  h your data type
+00026d70: 7320 6f72 2069 6e70 7574 732e 2720 2565  s or inputs.' %e
+00026d80: 290a 2020 2020 2020 2020 2020 2020 2020  ).              
+00026d90: 2020 7365 6c66 2e78 666f 726d 6572 203d    self.xformer =
+00026da0: 206d 6c5f 7069 7065 0a20 2020 2020 2020   ml_pipe.       
+00026db0: 2020 2020 2020 2020 2072 6574 7572 6e20           return 
+00026dc0: 7365 6c66 0a20 2020 2020 2020 2020 2020  self.           
+00026dd0: 2070 7269 6e74 2827 6d6f 6465 6c20 7069   print('model pi
+00026de0: 7065 6c69 6e65 2066 6974 7465 6420 7769  peline fitted wi
+00026df0: 7468 2025 7320 6d6f 6465 6c27 2025 6d6f  th %s model' %mo
+00026e00: 6465 6c5f 6e61 6d65 290a 2020 2020 2020  del_name).      
+00026e10: 2020 2020 2020 7365 6c66 2e66 6974 7465        self.fitte
+00026e20: 6420 3d20 5472 7565 0a20 2020 2020 2020  d = True.       
+00026e30: 2065 6c73 653a 0a20 2020 2020 2020 2020   else:.         
+00026e40: 2020 2023 2323 2069 6620 7468 6572 6520     ### if there 
+00026e50: 6973 206e 6f20 6769 7665 6e20 6d6f 6465  is no given mode
+00026e60: 6c2c 206a 7573 7420 7573 6520 7468 6520  l, just use the 
+00026e70: 6461 7461 5f70 6970 656c 696e 6520 2323  data_pipeline ##
+00026e80: 0a20 2020 2020 2020 2020 2020 2064 6174  .            dat
+00026e90: 615f 7069 7065 203d 206d 616b 655f 7369  a_pipe = make_si
+00026ea0: 6d70 6c65 5f70 6970 656c 696e 6528 582c  mple_pipeline(X,
+00026eb0: 2079 2c20 656e 636f 6465 7273 3d73 656c   y, encoders=sel
+00026ec0: 662e 656e 636f 6465 7273 2c20 7363 616c  f.encoders, scal
+00026ed0: 6572 733d 7365 6c66 2e73 6361 6c65 7273  ers=self.scalers
+00026ee0: 2c0a 2020 2020 2020 2020 2020 2020 2020  ,.              
+00026ef0: 2020 6461 7465 5f74 6f5f 7374 7269 6e67    date_to_string
+00026f00: 3d73 656c 662e 6461 7465 5f74 6f5f 7374  =self.date_to_st
+00026f10: 7269 6e67 2c20 7361 7665 5f66 6c61 6720  ring, save_flag 
+00026f20: 3d20 7365 6c66 2e73 6176 652c 200a 2020  = self.save, .  
+00026f30: 2020 2020 2020 2020 2020 2020 2020 636f                co
+00026f40: 6d62 696e 655f 7261 7265 5f66 6c61 673d  mbine_rare_flag=
+00026f50: 7365 6c66 2e63 6f6d 6269 6e65 5f72 6172  self.combine_rar
+00026f60: 652c 2076 6572 626f 7365 3d73 656c 662e  e, verbose=self.
+00026f70: 7665 7262 6f73 6529 0a20 2020 2020 2020  verbose).       
+00026f80: 2020 2020 2070 7269 6e74 2827 4e6f 206d       print('No m
+00026f90: 6f64 656c 2069 6e70 7574 2067 6976 656e  odel input given
+00026fa0: 2e2e 2e27 290a 2020 2020 2020 2020 2020  ...').          
+00026fb0: 2020 2323 2323 2068 6572 6520 7765 2063    #### here we c
+00026fc0: 6865 636b 2069 6620 7765 2073 686f 756c  heck if we shoul
+00026fd0: 6420 6164 6420 6120 6d6f 6465 6c20 746f  d add a model to
+00026fe0: 2074 6865 2070 6970 656c 696e 6520 0a20   the pipeline . 
+00026ff0: 2020 2020 2020 2020 2020 2070 7269 6e74             print
+00027000: 2827 5820 616e 6420 7920 5472 616e 7366  ('X and y Transf
+00027010: 6f72 6d65 7220 5069 7065 6c69 6e65 2063  ormer Pipeline c
+00027020: 7265 6174 6564 2e2e 2e27 290a 2020 2020  reated...').    
+00027030: 2020 2020 2020 2020 6966 2073 656c 662e          if self.
+00027040: 7472 616e 7366 6f72 6d5f 7461 7267 6574  transform_target
+00027050: 3a0a 2020 2020 2020 2020 2020 2020 2020  :.              
+00027060: 2020 7365 6c66 2e79 666f 726d 6572 2e66    self.yformer.f
+00027070: 6974 2879 290a 2020 2020 2020 2020 2020  it(y).          
+00027080: 2020 2020 2020 7974 203d 2073 656c 662e        yt = self.
+00027090: 7966 6f72 6d65 722e 7472 616e 7366 6f72  yformer.transfor
+000270a0: 6d28 7929 0a20 2020 2020 2020 2020 2020  m(y).           
+000270b0: 2020 2020 2070 7269 6e74 2827 2020 2020       print('    
+000270c0: 7472 616e 7366 6f72 6d65 6420 7461 7267  transformed targ
+000270d0: 6574 2066 726f 6d20 6f62 6a65 6374 2074  et from object t
+000270e0: 7970 6520 746f 206e 756d 6572 6963 2729  ype to numeric')
+000270f0: 0a20 2020 2020 2020 2020 2020 2020 2020  .               
+00027100: 2069 6620 7920 6973 206e 6f74 204e 6f6e   if y is not Non
+00027110: 653a 0a20 2020 2020 2020 2020 2020 2020  e:.             
+00027120: 2020 2020 2020 2079 742e 696e 6465 7820         yt.index 
+00027130: 3d20 7365 6c66 2e79 5f69 6e64 6578 0a20  = self.y_index. 
+00027140: 2020 2020 2020 2020 2020 2020 2020 2064                 d
+00027150: 6174 615f 7069 7065 2e66 6974 2858 2c79  ata_pipe.fit(X,y
+00027160: 7429 0a20 2020 2020 2020 2020 2020 2020  t).             
+00027170: 2020 2073 656c 662e 7866 6f72 6d65 7220     self.xformer 
+00027180: 3d20 6461 7461 5f70 6970 6520 0a20 2020  = data_pipe .   
+00027190: 2020 2020 2020 2020 2065 6c73 653a 0a20           else:. 
+000271a0: 2020 2020 2020 2020 2020 2020 2020 2064                 d
+000271b0: 6174 615f 7069 7065 2e66 6974 2858 2c79  ata_pipe.fit(X,y
+000271c0: 290a 2020 2020 2020 2020 2020 2020 2020  ).              
+000271d0: 2020 7365 6c66 2e78 666f 726d 6572 203d    self.xformer =
+000271e0: 2064 6174 615f 7069 7065 0a20 2020 2020   data_pipe.     
+000271f0: 2020 2020 2020 2023 2320 7765 2077 696c         ## we wil
+00027200: 6c20 6c65 6176 6520 7365 6c66 2e6d 6f64  l leave self.mod
+00027210: 656c 2061 7320 4e6f 6e65 2023 230a 2020  el as None ##.  
+00027220: 2020 2020 2020 2020 2020 7365 6c66 2e66            self.f
+00027230: 6974 7465 6420 3d20 5472 7565 0a20 2020  itted = True.   
+00027240: 2020 2020 2023 2323 2070 7269 6e74 2069       ### print i
+00027250: 6d62 616c 616e 6365 6420 2323 230a 2020  mbalanced ###.  
+00027260: 2020 2020 2020 6966 2073 656c 662e 696d        if self.im
+00027270: 6261 6c61 6e63 6564 3a0a 2020 2020 2020  balanced:.      
+00027280: 2020 2020 2020 7072 696e 7428 2723 2323        print('###
+00027290: 2041 6c65 7274 2120 446f 206e 6f74 2075   Alert! Do not u
+000272a0: 7365 2053 4d4f 5445 2069 6620 7468 6973  se SMOTE if this
+000272b0: 2069 7320 6e6f 7420 616e 2069 6d62 616c   is not an imbal
+000272c0: 616e 6365 6420 636c 6173 7369 6669 6361  anced classifica
+000272d0: 7469 6f6e 2070 726f 626c 656d 2023 2323  tion problem ###
+000272e0: 2323 2323 2729 0a20 2020 2020 2020 2020  ####').         
+000272f0: 2020 2069 6620 6973 696e 7374 616e 6365     if isinstance
+00027300: 2858 2c20 7064 2e44 6174 6146 7261 6d65  (X, pd.DataFrame
+00027310: 293a 0a20 2020 2020 2020 2020 2020 2020  ):.             
+00027320: 2020 2076 6172 5f63 6c61 7373 6573 203d     var_classes =
+00027330: 2063 6c61 7373 6966 795f 7661 7273 5f70   classify_vars_p
+00027340: 616e 6461 7328 5829 0a20 2020 2020 2020  andas(X).       
+00027350: 2020 2020 2020 2020 2063 6174 5f76 6172           cat_var
+00027360: 7320 3d20 7661 725f 636c 6173 7365 735b  s = var_classes[
+00027370: 2763 6174 6567 6f72 6963 616c 5f76 6172  'categorical_var
+00027380: 7327 5d0a 2020 2020 2020 2020 2020 2020  s'].            
+00027390: 2020 2020 6966 206c 656e 2863 6174 5f76      if len(cat_v
+000273a0: 6172 7329 203e 2030 3a0a 2020 2020 2020  ars) > 0:.      
+000273b0: 2020 2020 2020 2020 2020 2020 2020 6361                ca
+000273c0: 745f 696e 6465 7820 3d20 5b58 2e63 6f6c  t_index = [X.col
+000273d0: 756d 6e73 2e74 6f6c 6973 7428 292e 696e  umns.tolist().in
+000273e0: 6465 7828 7829 2066 6f72 2078 2069 6e20  dex(x) for x in 
+000273f0: 6361 745f 7661 7273 5d0a 2020 2020 2020  cat_vars].      
+00027400: 2020 2020 2020 2020 2020 2020 2020 7365                se
+00027410: 6c66 2e73 6d6f 7465 7820 3d20 534d 4f54  lf.smotex = SMOT
+00027420: 454e 4328 6361 7465 676f 7269 6361 6c5f  ENC(categorical_
+00027430: 6665 6174 7572 6573 3d63 6174 5f69 6e64  features=cat_ind
+00027440: 6578 290a 2020 2020 2020 2020 2020 2020  ex).            
+00027450: 2020 2020 2020 2020 6966 2073 656c 662e          if self.
+00027460: 7665 7262 6f73 653a 0a20 2020 2020 2020  verbose:.       
+00027470: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00027480: 2070 7269 6e74 2827 496d 6261 6c61 6e63   print('Imbalanc
+00027490: 6564 2066 6c61 6720 7365 742e 2053 4d4f  ed flag set. SMO
+000274a0: 5445 4e43 2077 6974 6820 2564 2063 6174  TENC with %d cat
+000274b0: 6567 6f72 6963 616c 2076 6172 7320 7769  egorical vars wi
+000274c0: 6c6c 2062 6520 7573 6564 2069 6e20 7069  ll be used in pi
+000274d0: 7065 6c69 6e65 2e27 2025 6c65 6e28 6361  peline.' %len(ca
+000274e0: 745f 7661 7273 2929 0a20 2020 2020 2020  t_vars)).       
+000274f0: 2020 2020 2020 2020 2065 6c73 653a 0a20           else:. 
+00027500: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00027510: 2020 2073 656c 662e 736d 6f74 6578 203d     self.smotex =
+00027520: 2042 6f72 6465 726c 696e 6553 4d4f 5445   BorderlineSMOTE
+00027530: 2829 0a20 2020 2020 2020 2020 2020 2020  ().             
+00027540: 2020 2020 2020 2069 6620 7365 6c66 2e76         if self.v
+00027550: 6572 626f 7365 3a0a 2020 2020 2020 2020  erbose:.        
+00027560: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00027570: 7072 696e 7428 2749 6d62 616c 616e 6365  print('Imbalance
+00027580: 6420 666c 6167 2073 6574 2e20 426f 7264  d flag set. Bord
+00027590: 6572 6c69 6e65 2053 4d4f 5445 2077 696c  erline SMOTE wil
+000275a0: 6c20 6265 2061 6464 6564 2074 6f20 7069  l be added to pi
+000275b0: 7065 6c69 6e65 2e27 290a 2020 2020 2020  peline.').      
+000275c0: 2020 2020 2020 656c 7365 3a0a 2020 2020        else:.    
+000275d0: 2020 2020 2020 2020 2020 2020 7365 6c66              self
+000275e0: 2e73 6d6f 7465 7820 3d20 426f 7264 6572  .smotex = Border
+000275f0: 6c69 6e65 534d 4f54 4528 290a 2020 2020  lineSMOTE().    
+00027600: 2020 2020 2020 2020 2020 2020 6966 2073              if s
+00027610: 656c 662e 7665 7262 6f73 653a 0a20 2020  elf.verbose:.   
+00027620: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00027630: 2070 7269 6e74 2827 496d 6261 6c61 6e63   print('Imbalanc
+00027640: 6564 2066 6c61 6720 7365 742e 2042 6f72  ed flag set. Bor
+00027650: 6465 726c 696e 6520 534d 4f54 4520 7769  derline SMOTE wi
+00027660: 6c6c 2062 6520 6164 6465 6420 746f 2070  ll be added to p
+00027670: 6970 656c 696e 652e 2729 0a20 2020 2020  ipeline.').     
+00027680: 2020 2064 6966 6674 696d 6520 3d20 6d61     difftime = ma
+00027690: 7828 312c 2069 6e74 2874 696d 652e 7469  x(1, int(time.ti
+000276a0: 6d65 2829 2d73 7461 7274 5f74 696d 6529  me()-start_time)
+000276b0: 290a 2020 2020 2020 2020 7072 696e 7428  ).        print(
+000276c0: 2720 2020 2054 696d 6520 7461 6b65 6e20  '    Time taken 
+000276d0: 746f 2066 6974 2064 6174 6173 6574 203d  to fit dataset =
+000276e0: 2025 7320 7365 636f 6e64 2873 2927 2025   %s second(s)' %
+000276f0: 6469 6666 7469 6d65 290a 2020 2020 2020  difftime).      
+00027700: 2020 7265 7475 726e 2073 656c 660a 0a20    return self.. 
+00027710: 2020 2064 6566 2070 7265 6469 6374 2873     def predict(s
+00027720: 656c 662c 2058 2c20 793d 4e6f 6e65 293a  elf, X, y=None):
+00027730: 0a20 2020 2020 2020 2069 6620 7365 6c66  .        if self
+00027740: 2e66 6974 7465 6420 616e 6420 7365 6c66  .fitted and self
+00027750: 2e6d 6f64 656c 5f69 6e70 7574 2069 7320  .model_input is 
+00027760: 6e6f 7420 4e6f 6e65 3a0a 2020 2020 2020  not None:.      
+00027770: 2020 2020 2020 795f 656e 6320 3d20 7365        y_enc = se
+00027780: 6c66 2e78 666f 726d 6572 2e70 7265 6469  lf.xformer.predi
+00027790: 6374 2858 290a 2020 2020 2020 2020 2020  ct(X).          
+000277a0: 2020 7265 7475 726e 2079 5f65 6e63 0a20    return y_enc. 
+000277b0: 2020 2020 2020 2065 6c73 653a 0a20 2020         else:.   
+000277c0: 2020 2020 2020 2020 2070 7269 6e74 2827           print('
+000277d0: 4d6f 6465 6c20 6e6f 7420 6669 7474 6564  Model not fitted
+000277e0: 206f 7220 6d6f 6465 6c20 6e6f 7420 7072   or model not pr
+000277f0: 6f76 6964 6564 2e20 506c 6561 7365 2063  ovided. Please c
+00027800: 6865 636b 2079 6f75 7220 696e 7075 7473  heck your inputs
+00027810: 2061 6e64 2074 7279 2061 6761 696e 2729   and try again')
+00027820: 0a20 2020 2020 2020 2020 2020 2072 6574  .            ret
+00027830: 7572 6e20 790a 0a20 2020 2064 6566 2074  urn y..    def t
+00027840: 7261 6e73 666f 726d 2873 656c 662c 2058  ransform(self, X
+00027850: 2c20 793d 4e6f 6e65 293a 0a20 2020 2020  , y=None):.     
+00027860: 2020 2058 203d 2063 6f70 792e 6465 6570     X = copy.deep
+00027870: 636f 7079 2858 290a 2020 2020 2020 2020  copy(X).        
+00027880: 7920 3d20 636f 7079 2e64 6565 7063 6f70  y = copy.deepcop
+00027890: 7928 7929 0a20 2020 2020 2020 2073 656c  y(y).        sel
+000278a0: 662e 585f 696e 6465 7820 3d20 582e 696e  f.X_index = X.in
+000278b0: 6465 780a 2020 2020 2020 2020 0a20 2020  dex.        .   
+000278c0: 2020 2020 2073 7461 7274 5f74 696d 6520       start_time 
+000278d0: 3d20 7469 6d65 2e74 696d 6528 290a 2020  = time.time().  
+000278e0: 2020 2020 2020 6966 2079 2069 7320 4e6f        if y is No
+000278f0: 6e65 2061 6e64 2073 656c 662e 6669 7474  ne and self.fitt
+00027900: 6564 3a0a 2020 2020 2020 2020 2020 2020  ed:.            
+00027910: 585f 656e 6320 3d20 7365 6c66 2e78 666f  X_enc = self.xfo
+00027920: 726d 6572 2e74 7261 6e73 666f 726d 2858  rmer.transform(X
+00027930: 290a 2020 2020 2020 2020 2020 2020 585f  ).            X_
+00027940: 656e 632e 696e 6465 7820 3d20 7365 6c66  enc.index = self
+00027950: 2e58 5f69 6e64 6578 0a20 2020 2020 2020  .X_index.       
+00027960: 2020 2020 2023 2323 2073 696e 6365 2078       ### since x
+00027970: 666f 726d 6572 206f 6e6c 7920 7472 616e  former only tran
+00027980: 7366 6f72 6d73 2058 2023 2323 0a20 2020  sforms X ###.   
+00027990: 2020 2020 2020 2020 2064 6966 6674 696d           difftim
+000279a0: 6520 3d20 6d61 7828 312c 2069 6e74 2874  e = max(1, int(t
+000279b0: 696d 652e 7469 6d65 2829 2d73 7461 7274  ime.time()-start
+000279c0: 5f74 696d 6529 290a 2020 2020 2020 2020  _time)).        
+000279d0: 2020 2020 7072 696e 7428 2720 2020 2054      print('    T
+000279e0: 696d 6520 7461 6b65 6e20 746f 2074 7261  ime taken to tra
+000279f0: 6e73 666f 726d 2064 6174 6173 6574 203d  nsform dataset =
+00027a00: 2025 7320 7365 636f 6e64 2873 2927 2025   %s second(s)' %
+00027a10: 6469 6666 7469 6d65 290a 2020 2020 2020  difftime).      
+00027a20: 2020 2020 2020 7072 696e 7428 2720 2020        print('   
+00027a30: 2053 6861 7065 206f 6620 7472 616e 7366   Shape of transf
+00027a40: 6f72 6d65 6420 6461 7461 7365 743a 2025  ormed dataset: %
+00027a50: 7327 2025 2858 5f65 6e63 2e73 6861 7065  s' %(X_enc.shape
+00027a60: 2c29 290a 2020 2020 2020 2020 2020 2020  ,)).            
+00027a70: 7265 7475 726e 2058 5f65 6e63 0a20 2020  return X_enc.   
+00027a80: 2020 2020 2065 6c69 6620 7365 6c66 2e66       elif self.f
+00027a90: 6974 7465 6420 616e 6420 7365 6c66 2e6d  itted and self.m
+00027aa0: 6f64 656c 5f69 6e70 7574 2069 7320 6e6f  odel_input is no
+00027ab0: 7420 4e6f 6e65 3a0a 2020 2020 2020 2020  t None:.        
+00027ac0: 2020 2020 7072 696e 7428 2745 7272 6f72      print('Error
+00027ad0: 3a20 4e6f 2074 7261 6e73 666f 726d 2061  : No transform a
+00027ae0: 6c6c 6f77 6564 2e20 596f 7520 6d75 7374  llowed. You must
+00027af0: 2075 7365 2066 6974 2061 6e64 2070 7265   use fit and pre
+00027b00: 6469 6374 2077 6865 6e20 7573 696e 6720  dict when using 
+00027b10: 6120 7069 7065 6c69 6e65 2077 6974 6820  a pipeline with 
+00027b20: 6120 6d6f 6465 6c2e 2729 0a20 2020 2020  a model.').     
+00027b30: 2020 2020 2020 2072 6574 7572 6e20 582c         return X,
+00027b40: 2079 0a20 2020 2020 2020 2065 6c69 6620   y.        elif 
+00027b50: 6e6f 7420 7365 6c66 2e66 6974 7465 643a  not self.fitted:
+00027b60: 0a20 2020 2020 2020 2020 2020 2070 7269  .            pri
+00027b70: 6e74 2827 4c61 7a79 5472 616e 7366 6f72  nt('LazyTransfor
+00027b80: 6d65 7220 6861 7320 6e6f 7420 6265 656e  mer has not been
+00027b90: 2066 6974 2079 6574 2e20 4669 7420 6974   fit yet. Fit it
+00027ba0: 2066 6972 7374 2061 6e64 2074 7279 2061   first and try a
+00027bb0: 6761 696e 2e27 290a 2020 2020 2020 2020  gain.').        
+00027bc0: 2020 2020 7265 7475 726e 2058 2c20 790a      return X, y.
+00027bd0: 2020 2020 2020 2020 656c 6966 2079 2069          elif y i
+00027be0: 7320 6e6f 7420 4e6f 6e65 2061 6e64 2073  s not None and s
+00027bf0: 656c 662e 6669 7474 6564 2061 6e64 2073  elf.fitted and s
+00027c00: 656c 662e 6d6f 6465 6c5f 696e 7075 7420  elf.model_input 
+00027c10: 6973 204e 6f6e 653a 0a20 2020 2020 2020  is None:.       
+00027c20: 2020 2020 2069 6620 7365 6c66 2e74 7261       if self.tra
+00027c30: 6e73 666f 726d 5f74 6172 6765 743a 0a20  nsform_target:. 
+00027c40: 2020 2020 2020 2020 2020 2020 2020 2069                 i
+00027c50: 6620 7920 6973 206e 6f74 204e 6f6e 653a  f y is not None:
+00027c60: 0a20 2020 2020 2020 2020 2020 2020 2020  .               
+00027c70: 2020 2020 2073 656c 662e 795f 696e 6465       self.y_inde
+00027c80: 7820 3d20 792e 696e 6465 780a 2020 2020  x = y.index.    
+00027c90: 2020 2020 2020 2020 2020 2020 795f 656e              y_en
+00027ca0: 6320 3d20 7365 6c66 2e79 666f 726d 6572  c = self.yformer
+00027cb0: 2e74 7261 6e73 666f 726d 2879 290a 2020  .transform(y).  
+00027cc0: 2020 2020 2020 2020 2020 2020 2020 6966                if
+00027cd0: 2079 2069 7320 6e6f 7420 4e6f 6e65 3a0a   y is not None:.
+00027ce0: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00027cf0: 2020 2020 795f 656e 632e 696e 6465 7820      y_enc.index 
+00027d00: 3d20 7365 6c66 2e79 5f69 6e64 6578 0a20  = self.y_index. 
+00027d10: 2020 2020 2020 2020 2020 2065 6c73 653a             else:
+00027d20: 0a20 2020 2020 2020 2020 2020 2020 2020  .               
+00027d30: 2079 5f65 6e63 203d 2079 0a20 2020 2020   y_enc = y.     
+00027d40: 2020 2020 2020 2058 5f65 6e63 203d 2073         X_enc = s
+00027d50: 656c 662e 7866 6f72 6d65 722e 7472 616e  elf.xformer.tran
+00027d60: 7366 6f72 6d28 5829 0a20 2020 2020 2020  sform(X).       
+00027d70: 2020 2020 2058 5f65 6e63 2e69 6e64 6578       X_enc.index
+00027d80: 203d 2073 656c 662e 585f 696e 6465 780a   = self.X_index.
+00027d90: 2020 2020 2020 2020 2020 2020 2323 2323              ####
+00027da0: 204e 6f77 2063 6865 636b 2069 6620 7468   Now check if th
+00027db0: 6520 696d 6261 6c61 6e63 6564 5f66 6c61  e imbalanced_fla
+00027dc0: 6720 6973 2054 7275 652c 2074 6865 6e20  g is True, then 
+00027dd0: 6170 706c 7920 534d 4f54 4520 7573 696e  apply SMOTE usin
+00027de0: 6720 626f 7264 6572 6c69 6e65 3220 616c  g borderline2 al
+00027df0: 676f 7269 7468 6d20 7768 6963 6820 776f  gorithm which wo
+00027e00: 726b 7320 6265 7474 6572 0a20 2020 2020  rks better.     
+00027e10: 2020 2020 2020 2069 6620 7365 6c66 2e69         if self.i
+00027e20: 6d62 616c 616e 6365 645f 6669 7273 745f  mbalanced_first_
+00027e30: 646f 6e65 2061 6e64 2073 656c 662e 696d  done and self.im
+00027e40: 6261 6c61 6e63 6564 3a0a 2020 2020 2020  balanced:.      
+00027e50: 2020 2020 2020 2020 2020 7061 7373 0a20            pass. 
+00027e60: 2020 2020 2020 2020 2020 2065 6c69 6620             elif 
+00027e70: 6e6f 7420 7365 6c66 2e69 6d62 616c 616e  not self.imbalan
+00027e80: 6365 645f 6669 7273 745f 646f 6e65 2061  ced_first_done a
+00027e90: 6e64 2073 656c 662e 696d 6261 6c61 6e63  nd self.imbalanc
+00027ea0: 6564 3a0a 2020 2020 2020 2020 2020 2020  ed:.            
+00027eb0: 2020 2020 736d 203d 2073 656c 662e 736d      sm = self.sm
+00027ec0: 6f74 6578 0a20 2020 2020 2020 2020 2020  otex.           
+00027ed0: 2020 2020 2058 5f65 6e63 2c20 795f 656e       X_enc, y_en
+00027ee0: 6320 3d20 736d 2e66 6974 5f72 6573 616d  c = sm.fit_resam
+00027ef0: 706c 6528 585f 656e 632c 2079 5f65 6e63  ple(X_enc, y_enc
+00027f00: 290a 2020 2020 2020 2020 2020 2020 2020  ).              
+00027f10: 2020 7365 6c66 2e69 6d62 616c 616e 6365    self.imbalance
+00027f20: 645f 6669 7273 745f 646f 6e65 203d 2054  d_first_done = T
+00027f30: 7275 650a 2020 2020 2020 2020 2020 2020  rue.            
+00027f40: 2020 2020 7365 6c66 2e73 6d6f 7465 7820      self.smotex 
+00027f50: 3d20 736d 0a20 2020 2020 2020 2020 2020  = sm.           
+00027f60: 2020 2020 2069 6620 7365 6c66 2e76 6572       if self.ver
+00027f70: 626f 7365 3a0a 2020 2020 2020 2020 2020  bose:.          
+00027f80: 2020 2020 2020 2020 2020 7072 696e 7428            print(
+00027f90: 2720 2020 2053 4d4f 5445 2074 7261 6e73  '    SMOTE trans
+00027fa0: 666f 726d 6564 2064 6174 6120 696e 2070  formed data in p
+00027fb0: 6970 656c 696e 652e 2044 6f6e 7420 666f  ipeline. Dont fo
+00027fc0: 7267 6574 2074 6f20 7573 6520 7472 616e  rget to use tran
+00027fd0: 7366 6f72 6d65 6420 5820 616e 6420 7920  sformed X and y 
+00027fe0: 6672 6f6d 206f 7574 7075 742e 2729 0a20  from output.'). 
+00027ff0: 2020 2020 2020 2020 2020 2064 6966 6674             difft
+00028000: 696d 6520 3d20 6d61 7828 312c 2069 6e74  ime = max(1, int
+00028010: 2874 696d 652e 7469 6d65 2829 2d73 7461  (time.time()-sta
+00028020: 7274 5f74 696d 6529 290a 2020 2020 2020  rt_time)).      
+00028030: 2020 2020 2020 7072 696e 7428 2720 2020        print('   
+00028040: 2054 696d 6520 7461 6b65 6e20 746f 2074   Time taken to t
+00028050: 7261 6e73 666f 726d 2064 6174 6173 6574  ransform dataset
+00028060: 203d 2025 7320 7365 636f 6e64 2873 2927   = %s second(s)'
+00028070: 2025 6469 6666 7469 6d65 290a 2020 2020   %difftime).    
+00028080: 2020 2020 2020 2020 7072 696e 7428 2720          print(' 
+00028090: 2020 2053 6861 7065 206f 6620 7472 616e     Shape of tran
+000280a0: 7366 6f72 6d65 6420 6461 7461 7365 743a  sformed dataset:
+000280b0: 2025 7327 2025 2858 5f65 6e63 2e73 6861   %s' %(X_enc.sha
+000280c0: 7065 2c29 290a 2020 2020 2020 2020 2020  pe,)).          
+000280d0: 2020 7265 7475 726e 2058 5f65 6e63 2c20    return X_enc, 
+000280e0: 795f 656e 630a 2020 2020 2020 2020 656c  y_enc.        el
+000280f0: 7365 3a0a 2020 2020 2020 2020 2020 2020  se:.            
+00028100: 7072 696e 7428 274c 617a 7954 7261 6e73  print('LazyTrans
+00028110: 666f 726d 6572 2068 6173 206e 6f74 2062  former has not b
+00028120: 6565 6e20 6669 7474 6564 2079 6574 2e20  een fitted yet. 
+00028130: 5265 7475 726e 696e 672e 2e2e 2729 0a20  Returning...'). 
+00028140: 2020 2020 2020 2020 2020 2072 6574 7572             retur
+00028150: 6e20 582c 2079 0a0a 2020 2020 6465 6620  n X, y..    def 
+00028160: 6669 745f 7472 616e 7366 6f72 6d28 7365  fit_transform(se
+00028170: 6c66 2c20 582c 2079 3d4e 6f6e 6529 3a0a  lf, X, y=None):.
+00028180: 2020 2020 2020 2020 5820 3d20 636f 7079          X = copy
+00028190: 2e64 6565 7063 6f70 7928 5829 0a20 2020  .deepcopy(X).   
+000281a0: 2020 2020 2079 203d 2063 6f70 792e 6465       y = copy.de
+000281b0: 6570 636f 7079 2879 290a 2020 2020 2020  epcopy(y).      
+000281c0: 2020 7365 6c66 2e58 5f69 6e64 6578 203d    self.X_index =
+000281d0: 2058 2e69 6e64 6578 0a20 2020 2020 2020   X.index.       
+000281e0: 2069 6620 7920 6973 206e 6f74 204e 6f6e   if y is not Non
+000281f0: 653a 0a20 2020 2020 2020 2020 2020 2073  e:.            s
+00028200: 656c 662e 795f 696e 6465 7820 3d20 792e  elf.y_index = y.
+00028210: 696e 6465 780a 2020 2020 2020 2020 7374  index.        st
+00028220: 6172 745f 7469 6d65 203d 2074 696d 652e  art_time = time.
+00028230: 7469 6d65 2829 0a20 2020 2020 2020 2073  time().        s
+00028240: 656c 662e 6669 7428 582c 7929 0a20 2020  elf.fit(X,y).   
+00028250: 2020 2020 2058 5f74 7261 6e73 203d 2020       X_trans =  
+00028260: 7365 6c66 2e78 666f 726d 6572 2e74 7261  self.xformer.tra
+00028270: 6e73 666f 726d 2858 290a 2020 2020 2020  nsform(X).      
+00028280: 2020 585f 7472 616e 732e 696e 6465 7820    X_trans.index 
+00028290: 3d20 7365 6c66 2e58 5f69 6e64 6578 0a20  = self.X_index. 
+000282a0: 2020 2020 2020 2023 2323 2048 6572 6520         ### Here 
+000282b0: 796f 7520 6361 6e20 7374 7261 6967 6874  you can straight
+000282c0: 2061 7761 7920 6669 7420 616e 6420 7472   away fit and tr
+000282d0: 616e 7366 6f72 6d20 7920 2323 230a 2020  ansform y ###.  
+000282e0: 2020 2020 2020 6966 2073 656c 662e 7472        if self.tr
+000282f0: 616e 7366 6f72 6d5f 7461 7267 6574 3a0a  ansform_target:.
+00028300: 2020 2020 2020 2020 2020 2020 795f 7472              y_tr
+00028310: 616e 7320 3d20 7365 6c66 2e79 666f 726d  ans = self.yform
+00028320: 6572 2e66 6974 5f74 7261 6e73 666f 726d  er.fit_transform
+00028330: 2879 290a 2020 2020 2020 2020 656c 7365  (y).        else
+00028340: 3a0a 2020 2020 2020 2020 2020 2020 795f  :.            y_
+00028350: 7472 616e 7320 3d20 790a 2020 2020 2020  trans = y.      
+00028360: 2020 2323 2323 204e 6f77 2077 6520 6e65    #### Now we ne
+00028370: 6564 2074 6f20 6368 6563 6b20 6966 2069  ed to check if i
+00028380: 6d62 616c 616e 6365 6420 666c 6167 2069  mbalanced flag i
+00028390: 7320 7365 7420 2323 230a 2020 2020 2020  s set ###.      
+000283a0: 2020 6966 2073 656c 662e 696d 6261 6c61    if self.imbala
+000283b0: 6e63 6564 5f66 6972 7374 5f64 6f6e 6520  nced_first_done 
+000283c0: 616e 6420 7365 6c66 2e69 6d62 616c 616e  and self.imbalan
+000283d0: 6365 643a 0a20 2020 2020 2020 2020 2020  ced:.           
+000283e0: 2070 6173 730a 2020 2020 2020 2020 656c   pass.        el
+000283f0: 6966 206e 6f74 2073 656c 662e 696d 6261  if not self.imba
+00028400: 6c61 6e63 6564 5f66 6972 7374 5f64 6f6e  lanced_first_don
+00028410: 6520 616e 6420 7365 6c66 2e69 6d62 616c  e and self.imbal
+00028420: 616e 6365 643a 0a20 2020 2020 2020 2020  anced:.         
+00028430: 2020 2070 7269 6e74 2827 2323 2320 416c     print('### Al
+00028440: 6572 7421 2044 6f20 6e6f 7420 7573 6520  ert! Do not use 
+00028450: 534d 4f54 4520 6966 2074 6869 7320 6973  SMOTE if this is
+00028460: 206e 6f74 2061 6e20 696d 6261 6c61 6e63   not an imbalanc
+00028470: 6564 2063 6c61 7373 6966 6963 6174 696f  ed classificatio
+00028480: 6e20 7072 6f62 6c65 6d20 2323 2323 2323  n problem ######
+00028490: 2327 290a 2020 2020 2020 2020 2020 2020  #').            
+000284a0: 736d 203d 2073 656c 662e 736d 6f74 6578  sm = self.smotex
+000284b0: 0a20 2020 2020 2020 2020 2020 2069 6620  .            if 
+000284c0: 7365 6c66 2e76 6572 626f 7365 3a0a 2020  self.verbose:.  
+000284d0: 2020 2020 2020 2020 2020 2020 2020 7072                pr
+000284e0: 696e 7428 2749 6d62 616c 616e 6365 6420  int('Imbalanced 
+000284f0: 666c 6167 2073 6574 2e20 5573 696e 6720  flag set. Using 
+00028500: 534d 4f54 4520 746f 2074 7261 6e73 666f  SMOTE to transfo
+00028510: 726d 2058 2061 6e64 2079 2e2e 2e27 290a  rm X and y...').
+00028520: 2020 2020 2020 2020 2020 2020 585f 7472              X_tr
+00028530: 616e 732c 2079 5f74 7261 6e73 203d 2073  ans, y_trans = s
+00028540: 6d2e 6669 745f 7265 7361 6d70 6c65 2858  m.fit_resample(X
+00028550: 5f74 7261 6e73 2c20 795f 7472 616e 7329  _trans, y_trans)
+00028560: 0a20 2020 2020 2020 2020 2020 2073 656c  .            sel
+00028570: 662e 696d 6261 6c61 6e63 6564 5f66 6972  f.imbalanced_fir
+00028580: 7374 5f64 6f6e 6520 3d20 5472 7565 0a20  st_done = True. 
+00028590: 2020 2020 2020 2020 2020 2073 656c 662e             self.
+000285a0: 736d 6f74 6578 203d 2073 6d0a 2020 2020  smotex = sm.    
+000285b0: 2020 2020 2020 2020 6966 2073 656c 662e          if self.
+000285c0: 7665 7262 6f73 653a 0a20 2020 2020 2020  verbose:.       
+000285d0: 2020 2020 2020 2020 2070 7269 6e74 2827           print('
+000285e0: 2020 2020 534d 4f54 4520 7472 616e 7366      SMOTE transf
+000285f0: 6f72 6d65 6420 6461 7461 2069 6e20 7069  ormed data in pi
+00028600: 7065 6c69 6e65 2e20 446f 6e74 2066 6f72  peline. Dont for
+00028610: 6765 7420 746f 2075 7365 2074 7261 6e73  get to use trans
+00028620: 666f 726d 6564 2058 2061 6e64 2079 2066  formed X and y f
+00028630: 726f 6d20 6f75 7470 7574 2e27 290a 2020  rom output.').  
+00028640: 2020 2020 2020 6469 6666 7469 6d65 203d        difftime =
+00028650: 206d 6178 2831 2c20 696e 7428 7469 6d65   max(1, int(time
+00028660: 2e74 696d 6528 292d 7374 6172 745f 7469  .time()-start_ti
+00028670: 6d65 2929 0a20 2020 2020 2020 2070 7269  me)).        pri
+00028680: 6e74 2827 2020 2020 5469 6d65 2074 616b  nt('    Time tak
+00028690: 656e 2074 6f20 7472 616e 7366 6f72 6d20  en to transform 
+000286a0: 6461 7461 7365 7420 3d20 2573 2073 6563  dataset = %s sec
+000286b0: 6f6e 6428 7329 2720 2564 6966 6674 696d  ond(s)' %difftim
+000286c0: 6529 0a20 2020 2020 2020 2070 7269 6e74  e).        print
+000286d0: 2827 2020 2020 5368 6170 6520 6f66 2074  ('    Shape of t
+000286e0: 7261 6e73 666f 726d 6564 2064 6174 6173  ransformed datas
+000286f0: 6574 3a20 2573 2720 2528 585f 7472 616e  et: %s' %(X_tran
+00028700: 732e 7368 6170 652c 2929 0a20 2020 2020  s.shape,)).     
+00028710: 2020 2072 6574 7572 6e20 585f 7472 616e     return X_tran
+00028720: 732c 2079 5f74 7261 6e73 0a0a 2020 2020  s, y_trans..    
+00028730: 6465 6620 6669 745f 7072 6564 6963 7428  def fit_predict(
+00028740: 7365 6c66 2c20 582c 2079 3d4e 6f6e 6529  self, X, y=None)
+00028750: 3a0a 2020 2020 2020 2020 7472 616e 7366  :.        transf
+00028760: 6f72 6d65 725f 203d 2073 656c 662e 6669  ormer_ = self.fi
+00028770: 7428 582c 7929 0a20 2020 2020 2020 2079  t(X,y).        y
+00028780: 5f74 7261 6e73 203d 2020 7472 616e 7366  _trans =  transf
+00028790: 6f72 6d65 725f 2e70 7265 6469 6374 2858  ormer_.predict(X
+000287a0: 290a 2020 2020 2020 2020 7265 7475 726e  ).        return
+000287b0: 2058 2c20 795f 7472 616e 730a 0a20 2020   X, y_trans..   
+000287c0: 2064 6566 2070 7269 6e74 5f70 6970 656c   def print_pipel
+000287d0: 696e 6528 7365 6c66 293a 0a20 2020 2020  ine(self):.     
+000287e0: 2020 2066 726f 6d20 736b 6c65 6172 6e20     from sklearn 
+000287f0: 696d 706f 7274 2073 6574 5f63 6f6e 6669  import set_confi
+00028800: 670a 2020 2020 2020 2020 7365 745f 636f  g.        set_co
+00028810: 6e66 6967 2864 6973 706c 6179 3d22 7465  nfig(display="te
+00028820: 7874 2229 0a20 2020 2020 2020 2072 6574  xt").        ret
+00028830: 7572 6e20 7365 6c66 2e78 666f 726d 6572  urn self.xformer
+00028840: 0a0a 2020 2020 6465 6620 706c 6f74 5f70  ..    def plot_p
+00028850: 6970 656c 696e 6528 7365 6c66 293a 0a20  ipeline(self):. 
+00028860: 2020 2020 2020 2066 726f 6d20 736b 6c65         from skle
+00028870: 6172 6e20 696d 706f 7274 2073 6574 5f63  arn import set_c
+00028880: 6f6e 6669 670a 2020 2020 2020 2020 7365  onfig.        se
+00028890: 745f 636f 6e66 6967 2864 6973 706c 6179  t_config(display
+000288a0: 3d22 6469 6167 7261 6d22 290a 2020 2020  ="diagram").    
+000288b0: 2020 2020 7265 7475 726e 2073 656c 662e      return self.
+000288c0: 7866 6f72 6d65 720a 0a20 2020 2064 6566  xformer..    def
+000288d0: 2070 6c6f 745f 696d 706f 7274 616e 6365   plot_importance
+000288e0: 2873 656c 662c 206d 6178 5f66 6561 7475  (self, max_featu
+000288f0: 7265 733d 3130 293a 0a20 2020 2020 2020  res=10):.       
+00028900: 2069 6d70 6f72 7420 6c69 6768 7467 626d   import lightgbm
+00028910: 2061 7320 6c67 626d 0a20 2020 2020 2020   as lgbm.       
+00028920: 2066 726f 6d20 7867 626f 6f73 7420 696d   from xgboost im
+00028930: 706f 7274 2070 6c6f 745f 696d 706f 7274  port plot_import
+00028940: 616e 6365 0a20 2020 2020 2020 206d 6f64  ance.        mod
+00028950: 656c 5f6e 616d 6520 3d20 7374 7228 7365  el_name = str(se
+00028960: 6c66 2e6d 6f64 656c 292e 7370 6c69 7428  lf.model).split(
+00028970: 2228 2229 5b2d 325d 2e73 706c 6974 2822  "(")[-2].split("
+00028980: 2c22 295b 2d31 5d0a 2020 2020 2020 2020  ,")[-1].        
+00028990: 6966 2020 6d6f 6465 6c5f 6e61 6d65 203d  if  model_name =
+000289a0: 3d20 2720 4c47 424d 436c 6173 7369 6669  = ' LGBMClassifi
+000289b0: 6572 2720 6f72 206d 6f64 656c 5f6e 616d  er' or model_nam
+000289c0: 6520 3d3d 2027 204c 4742 4d52 6567 7265  e == ' LGBMRegre
+000289d0: 7373 6f72 273a 0a20 2020 2020 2020 2020  ssor':.         
+000289e0: 2020 206c 6762 6d2e 706c 6f74 5f69 6d70     lgbm.plot_imp
+000289f0: 6f72 7461 6e63 6528 7365 6c66 2e6d 6f64  ortance(self.mod
+00028a00: 656c 2e6e 616d 6564 5f73 7465 7073 5b27  el.named_steps['
+00028a10: 6d6f 6465 6c27 5d2c 2069 6d70 6f72 7461  model'], importa
+00028a20: 6e63 655f 7479 7065 3d27 6761 696e 272c  nce_type='gain',
+00028a30: 206d 6178 5f6e 756d 5f66 6561 7475 7265   max_num_feature
+00028a40: 733d 6d61 785f 6665 6174 7572 6573 290a  s=max_features).
+00028a50: 2020 2020 2020 2020 656c 6966 206d 6f64          elif mod
+00028a60: 656c 5f6e 616d 6520 3d3d 2027 2058 4742  el_name == ' XGB
+00028a70: 436c 6173 7369 6669 6572 2720 6f72 206d  Classifier' or m
+00028a80: 6f64 656c 5f6e 616d 6520 3d3d 2027 2058  odel_name == ' X
+00028a90: 4742 5265 6772 6573 736f 7227 3a0a 2020  GBRegressor':.  
+00028aa0: 2020 2020 2020 2020 2020 706c 6f74 5f69            plot_i
+00028ab0: 6d70 6f72 7461 6e63 6528 7365 6c66 2e6d  mportance(self.m
+00028ac0: 6f64 656c 2e6e 616d 6564 5f73 7465 7073  odel.named_steps
+00028ad0: 5b27 6d6f 6465 6c27 5d2c 2069 6d70 6f72  ['model'], impor
+00028ae0: 7461 6e63 655f 7479 7065 3d27 6761 696e  tance_type='gain
+00028af0: 272c 206d 6178 5f6e 756d 5f66 6561 7475  ', max_num_featu
+00028b00: 7265 733d 6d61 785f 6665 6174 7572 6573  res=max_features
+00028b10: 290a 2020 2020 2020 2020 656c 6966 206d  ).        elif m
+00028b20: 6f64 656c 5f6e 616d 6520 3d3d 2027 204c  odel_name == ' L
+00028b30: 6f67 6973 7469 6352 6567 7265 7373 696f  ogisticRegressio
+00028b40: 6e27 3a0a 2020 2020 2020 2020 2020 2020  n':.            
+00028b50: 6672 6f6d 2073 6b6c 6561 726e 2e6c 696e  from sklearn.lin
+00028b60: 6561 725f 6d6f 6465 6c20 696d 706f 7274  ear_model import
+00028b70: 204c 6f67 6973 7469 6352 6567 7265 7373   LogisticRegress
+00028b80: 696f 6e0a 2020 2020 2020 2020 2020 2020  ion.            
+00028b90: 696d 706f 7274 206d 6174 680a 2020 2020  import math.    
+00028ba0: 2020 2020 2020 2020 6665 6174 7572 655f          feature_
+00028bb0: 6e61 6d65 7320 3d20 7365 6c66 2e6d 6f64  names = self.mod
+00028bc0: 656c 2e6e 616d 6564 5f73 7465 7073 5b27  el.named_steps['
+00028bd0: 6d6f 6465 6c27 5d2e 6665 6174 7572 655f  model'].feature_
+00028be0: 6e61 6d65 735f 696e 5f0a 2020 2020 2020  names_in_.      
+00028bf0: 2020 2020 2020 6d6f 6465 6c20 3d20 7365        model = se
+00028c00: 6c66 2e6d 6f64 656c 2e6e 616d 6564 5f73  lf.model.named_s
+00028c10: 7465 7073 5b27 6d6f 6465 6c27 5d0a 2020  teps['model'].  
+00028c20: 2020 2020 2020 2020 2020 7730 203d 206d            w0 = m
+00028c30: 6f64 656c 2e69 6e74 6572 6365 7074 5f5b  odel.intercept_[
+00028c40: 305d 0a20 2020 2020 2020 2020 2020 2077  0].            w
+00028c50: 203d 206d 6f64 656c 2e63 6f65 665f 5b30   = model.coef_[0
+00028c60: 5d0a 2020 2020 2020 2020 2020 2020 6665  ].            fe
+00028c70: 6174 7572 655f 696d 706f 7274 616e 6365  ature_importance
+00028c80: 203d 2070 642e 4461 7461 4672 616d 6528   = pd.DataFrame(
+00028c90: 6665 6174 7572 655f 6e61 6d65 732c 2063  feature_names, c
+00028ca0: 6f6c 756d 6e73 203d 205b 2266 6561 7475  olumns = ["featu
+00028cb0: 7265 225d 290a 2020 2020 2020 2020 2020  re"]).          
+00028cc0: 2020 6665 6174 7572 655f 696d 706f 7274    feature_import
+00028cd0: 616e 6365 5b22 696d 706f 7274 616e 6365  ance["importance
+00028ce0: 225d 203d 2070 6f77 286d 6174 682e 652c  "] = pow(math.e,
+00028cf0: 2077 290a 2020 2020 2020 2020 2020 2020   w).            
+00028d00: 6665 6174 7572 655f 696d 706f 7274 616e  feature_importan
+00028d10: 6365 203d 2066 6561 7475 7265 5f69 6d70  ce = feature_imp
+00028d20: 6f72 7461 6e63 652e 736f 7274 5f76 616c  ortance.sort_val
+00028d30: 7565 7328 6279 203d 205b 2269 6d70 6f72  ues(by = ["impor
+00028d40: 7461 6e63 6522 5d2c 2061 7363 656e 6469  tance"], ascendi
+00028d50: 6e67 3d46 616c 7365 295b 3a6d 6178 5f66  ng=False)[:max_f
+00028d60: 6561 7475 7265 735d 0a20 2020 2020 2020  eatures].       
+00028d70: 2020 2020 2066 6561 7475 7265 5f69 6d70       feature_imp
+00028d80: 6f72 7461 6e63 652e 706c 6f74 2e62 6172  ortance.plot.bar
+00028d90: 6828 783d 2766 6561 7475 7265 272c 2079  h(x='feature', y
+00028da0: 3d27 696d 706f 7274 616e 6365 2729 0a20  ='importance'). 
+00028db0: 2020 2020 2020 2065 6c73 653a 0a20 2020         else:.   
+00028dc0: 2020 2020 2020 2020 2023 2323 2054 6865           ### The
+00028dd0: 7365 2061 7265 2066 6f72 2052 616e 646f  se are for Rando
+00028de0: 6d46 6f72 6573 7443 6c61 7373 6966 6965  mForestClassifie
+00028df0: 7220 6b69 6e64 206f 6620 7363 696b 6974  r kind of scikit
+00028e00: 2d6c 6561 726e 206d 6f64 656c 7320 2323  -learn models ##
+00028e10: 230a 2020 2020 2020 2020 2020 2020 7472  #.            tr
+00028e20: 793a 0a20 2020 2020 2020 2020 2020 2020  y:.             
+00028e30: 2020 2069 6d70 6f72 7461 6e63 6573 203d     importances =
+00028e40: 206d 6f64 656c 2e66 6561 7475 7265 5f69   model.feature_i
+00028e50: 6d70 6f72 7461 6e63 6573 5f0a 2020 2020  mportances_.    
+00028e60: 2020 2020 2020 2020 2020 2020 6665 6174              feat
+00028e70: 7572 655f 6e61 6d65 7320 3d20 7365 6c66  ure_names = self
+00028e80: 2e6d 6f64 656c 2e6e 616d 6564 5f73 7465  .model.named_ste
+00028e90: 7073 5b27 6d6f 6465 6c27 5d2e 6665 6174  ps['model'].feat
+00028ea0: 7572 655f 6e61 6d65 735f 696e 5f0a 2020  ure_names_in_.  
+00028eb0: 2020 2020 2020 2020 2020 2020 2020 666f                fo
+00028ec0: 7265 7374 5f69 6d70 6f72 7461 6e63 6573  rest_importances
+00028ed0: 203d 2070 642e 5365 7269 6573 2869 6d70   = pd.Series(imp
+00028ee0: 6f72 7461 6e63 6573 2c20 696e 6465 783d  ortances, index=
+00028ef0: 6665 6174 7572 655f 6e61 6d65 7329 0a20  feature_names). 
+00028f00: 2020 2020 2020 2020 2020 2020 2020 2066                 f
+00028f10: 6f72 6573 745f 696d 706f 7274 616e 6365  orest_importance
+00028f20: 732e 736f 7274 5f76 616c 7565 7328 6173  s.sort_values(as
+00028f30: 6365 6e64 696e 673d 4661 6c73 6529 5b3a  cending=False)[:
+00028f40: 6d61 785f 6665 6174 7572 6573 5d2e 706c  max_features].pl
+00028f50: 6f74 286b 696e 643d 2762 6172 6827 290a  ot(kind='barh').
+00028f60: 2020 2020 2020 2020 2020 2020 6578 6365              exce
+00028f70: 7074 3a0a 2020 2020 2020 2020 2020 2020  pt:.            
+00028f80: 2020 2020 7072 696e 7428 2743 6f75 6c64      print('Could
+00028f90: 206e 6f74 2070 6c6f 7420 6665 6174 7572   not plot featur
+00028fa0: 6520 696d 706f 7274 616e 6365 732e 2050  e importances. P
+00028fb0: 6c65 6173 6520 6368 6563 6b20 796f 7572  lease check your
+00028fc0: 206d 6f64 656c 2061 6e64 2074 7279 2061   model and try a
+00028fd0: 6761 696e 2e27 290a 0a0a 2020 2020 6465  gain.')...    de
+00028fe0: 6620 6c69 6768 7467 626d 5f67 7269 645f  f lightgbm_grid_
+00028ff0: 7365 6172 6368 2873 656c 662c 2058 5f74  search(self, X_t
+00029000: 7261 696e 2c20 795f 7472 6169 6e2c 206d  rain, y_train, m
+00029010: 6f64 656c 7479 7065 2c0a 2020 2020 2020  odeltype,.      
+00029020: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00029030: 2020 2020 2020 2070 6172 616d 733d 7b7d         params={}
+00029040: 2c20 6772 6964 5f73 6561 7263 683d 4661  , grid_search=Fa
+00029050: 6c73 652c 206d 756c 7469 5f6c 6162 656c  lse, multi_label
+00029060: 3d46 616c 7365 2c0a 2020 2020 2020 2020  =False,.        
+00029070: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00029080: 2020 2020 2029 3a0a 2020 2020 2020 2020       ):.        
+00029090: 2222 220a 2020 2020 2020 2020 5065 7266  """.        Perf
+000290a0: 6f72 6d20 4772 6964 5365 6172 6368 4356  orm GridSearchCV
+000290b0: 206f 7220 5261 6e64 6f6d 697a 6564 5365   or RandomizedSe
+000290c0: 6172 6368 4356 2075 7369 6e67 204c 6967  archCV using Lig
+000290d0: 6874 4742 4d20 6261 7365 6420 4c61 7a79  htGBM based Lazy
+000290e0: 5472 616e 7366 6f72 6d65 7220 7069 7065  Transformer pipe
+000290f0: 6c69 6e65 2e0a 2020 2020 2020 2020 2d2d  line..        --
+00029100: 2052 656d 656d 6265 7220 7468 6174 2079   Remember that y
+00029110: 6f75 2063 616e 206f 6e6c 7920 7573 6520  ou can only use 
+00029120: 4c69 6768 7447 424d 2073 6369 6b69 742d  LightGBM scikit-
+00029130: 6c65 6172 6e20 7379 6e74 6178 2062 6173  learn syntax bas
+00029140: 6564 206d 6f64 656c 7320 6865 7265 2e20  ed models here. 
+00029150: 0a20 2020 2020 2020 204f 7074 696f 6e61  .        Optiona
+00029160: 6c6c 7920 796f 7520 6361 6e20 7072 6f76  lly you can prov
+00029170: 6964 6520 7061 7261 6d65 7465 7273 2074  ide parameters t
+00029180: 6f20 7365 6172 6368 2028 6173 2061 2064  o search (as a d
+00029190: 6963 7469 6f6e 6172 7929 2069 6e20 7468  ictionary) in th
+000291a0: 6520 666f 6c6c 6f77 696e 6720 666f 726d  e following form
+000291b0: 6174 3a0a 2020 2020 2020 2020 2020 2020  at:.            
+000291c0: 2020 2020 7061 7261 6d73 203d 207b 0a20      params = {. 
+000291d0: 2020 2020 2020 2020 2020 2020 2020 2027                 '
+000291e0: 6d6f 6465 6c5f 5f6c 6561 726e 696e 675f  model__learning_
+000291f0: 7261 7465 273a 205b 302e 3030 312c 2030  rate': [0.001, 0
+00029200: 2e30 312c 2030 2e31 2c20 302e 332c 2030  .01, 0.1, 0.3, 0
+00029210: 2e35 5d2c 0a20 2020 2020 2020 2020 2020  .5],.           
+00029220: 2020 2020 2027 6d6f 6465 6c5f 5f6e 756d       'model__num
+00029230: 5f6c 6561 7665 7327 3a20 5b32 302c 3330  _leaves': [20,30
+00029240: 2c34 302c 3530 5d2c 0a20 2020 2020 2020  ,40,50],.       
+00029250: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00029260: 207d 0a20 2020 2020 2020 2020 2020 2059   }.            Y
+00029270: 6f75 2063 616e 2075 7365 2061 6e79 204c  ou can use any L
+00029280: 6967 6874 4742 4d20 7061 7261 6d65 7465  ightGBM paramete
+00029290: 7220 796f 7520 7761 6e74 2069 6e20 6164  r you want in ad
+000292a0: 6469 7469 6f6e 2074 6f20 7468 6520 6162  dition to the ab
+000292b0: 6f76 652e 2050 6c65 6173 6520 6368 6563  ove. Please chec
+000292c0: 6b20 7379 6e74 6178 2e0a 2020 2020 2020  k syntax..      
+000292d0: 2020 596f 7520 6361 6e20 616c 736f 2070    You can also p
+000292e0: 726f 7669 6465 206d 756c 7469 5f6c 6162  rovide multi_lab
+000292f0: 656c 2061 7320 5472 7565 2074 6f20 656e  el as True to en
+00029300: 6162 6c65 204d 756c 7469 4f75 7470 7574  able MultiOutput
+00029310: 5265 6772 6573 736f 7220 6f72 204d 756c  Regressor or Mul
+00029320: 7469 4f75 7470 7574 436c 6173 7369 6669  tiOutputClassifi
+00029330: 6572 0a20 2020 2020 2020 2020 2020 746f  er.           to
+00029340: 2062 6520 7573 6564 2061 7320 6120 7772   be used as a wr
+00029350: 6170 7065 7220 6172 6f75 6e64 2074 6865  apper around the
+00029360: 204c 6967 6874 4742 4d20 6f62 6a65 6374   LightGBM object
+00029370: 2e20 5468 6520 7061 7261 6d73 2077 696c  . The params wil
+00029380: 6c20 6265 2070 6173 7365 6420 746f 2074  l be passed to t
+00029390: 6865 200a 2020 2020 2020 2020 2020 206d  he .           m
+000293a0: 756c 7469 6f75 7470 7574 2065 7374 696d  ultioutput estim
+000293b0: 6174 6f72 2077 6869 6368 2077 696c 6c20  ator which will 
+000293c0: 696e 2074 7572 6e20 7061 7373 2074 6865  in turn pass the
+000293d0: 6d20 6f6e 2074 6f20 7468 6520 4c47 424d  m on to the LGBM
+000293e0: 2065 7374 696d 6174 6f72 7320 6475 7269   estimators duri
+000293f0: 6e67 2066 6974 2e0a 0a20 2020 2020 2020  ng fit...       
+00029400: 2054 6869 7320 6675 6e63 7469 6f6e 2072   This function r
+00029410: 6574 7572 6e73 2061 206e 6577 204c 617a  eturns a new Laz
+00029420: 7954 7261 6e73 666f 726d 6572 2070 6970  yTransformer pip
+00029430: 656c 696e 6520 7468 6174 2063 6f6e 7461  eline that conta
+00029440: 696e 7320 7468 6520 6265 7374 206d 6f64  ins the best mod
+00029450: 656c 2074 7261 696e 6564 206f 6e20 7468  el trained on th
+00029460: 6174 2064 6174 6173 6574 2e0a 2020 2020  at dataset..    
+00029470: 2020 2020 596f 7520 6361 6e20 7573 6520      You can use 
+00029480: 7468 6973 206e 6577 2070 6970 656c 696e  this new pipelin
+00029490: 6520 746f 2070 7265 6469 6374 206f 6e20  e to predict on 
+000294a0: 6578 6973 7469 6e67 206f 7220 6e65 7720  existing or new 
+000294b0: 6461 7461 7365 7473 2e0a 0a20 2020 2020  datasets...     
+000294c0: 2020 2022 2222 0a0a 2020 2020 2020 2020     """..        
+000294d0: 7374 6172 745f 7469 6d65 203d 2074 696d  start_time = tim
+000294e0: 652e 7469 6d65 2829 0a20 2020 2020 2020  e.time().       
+000294f0: 2069 6620 6c65 6e28 7061 7261 6d73 2920   if len(params) 
+00029500: 3d3d 2030 3a20 0a20 2020 2020 2020 2020  == 0: .         
+00029510: 2020 2069 6620 6d6f 6465 6c74 7970 6520     if modeltype 
+00029520: 3d3d 2027 5265 6772 6573 7369 6f6e 273a  == 'Regression':
+00029530: 0a20 2020 2020 2020 2020 2020 2020 2020  .               
+00029540: 2072 616e 645f 7061 7261 6d73 203d 207b   rand_params = {
+00029550: 0a20 2020 2020 2020 2020 2020 2020 2020  .               
+00029560: 2020 2020 2027 6d6f 6465 6c5f 5f6e 5f65       'model__n_e
+00029570: 7374 696d 6174 6f72 7327 3a20 6e70 2e6c  stimators': np.l
+00029580: 696e 7370 6163 6528 3530 2c31 3030 302c  inspace(50,1000,
+00029590: 3130 292e 6173 7479 7065 2869 6e74 292c  10).astype(int),
+000295a0: 0a20 2020 2020 2020 2020 2020 2020 2020  .               
+000295b0: 2020 2020 2027 6d6f 6465 6c5f 5f6c 6561       'model__lea
+000295c0: 726e 696e 675f 7261 7465 273a 206e 702e  rning_rate': np.
+000295d0: 6c69 6e73 7061 6365 2830 2e30 3030 312c  linspace(0.0001,
+000295e0: 312c 3130 292c 0a20 2020 2020 2020 2020  1,10),.         
+000295f0: 2020 2020 2020 2020 2020 2027 6d6f 6465             'mode
+00029600: 6c5f 5f62 6f6f 7374 696e 675f 7479 7065  l__boosting_type
+00029610: 273a 205b 2764 6172 7427 2c27 6762 6474  ': ['dart','gbdt
+00029620: 275d 2c0a 2020 2020 2020 2020 2020 2020  '],.            
+00029630: 2020 2020 2020 2020 7d0a 2020 2020 2020          }.      
+00029640: 2020 2020 2020 2020 2020 6772 6964 5f70            grid_p
+00029650: 6172 616d 7320 3d20 7b0a 2020 2020 2020  arams = {.      
+00029660: 2020 2020 2020 2020 2020 2020 2020 276d                'm
+00029670: 6f64 656c 5f5f 6e5f 6573 7469 6d61 746f  odel__n_estimato
+00029680: 7273 273a 206e 702e 6c69 6e73 7061 6365  rs': np.linspace
+00029690: 2835 302c 3130 3030 2c35 292e 6173 7479  (50,1000,5).asty
+000296a0: 7065 2869 6e74 292c 0a20 2020 2020 2020  pe(int),.       
+000296b0: 2020 2020 2020 2020 2020 2020 2027 6d6f               'mo
+000296c0: 6465 6c5f 5f6c 6561 726e 696e 675f 7261  del__learning_ra
+000296d0: 7465 273a 206e 702e 6c69 6e73 7061 6365  te': np.linspace
+000296e0: 2830 2e30 3030 312c 312c 3529 2c0a 2020  (0.0001,1,5),.  
+000296f0: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00029700: 2020 276d 6f64 656c 5f5f 626f 6f73 7469    'model__boosti
+00029710: 6e67 5f74 7970 6527 3a20 5b27 6461 7274  ng_type': ['dart
+00029720: 272c 2767 6264 7427 5d2c 0a20 2020 2020  ','gbdt'],.     
+00029730: 2020 2020 2020 2020 2020 207d 0a20 2020             }.   
+00029740: 2020 2020 2020 2020 2065 6c73 653a 0a20           else:. 
+00029750: 2020 2020 2020 2020 2020 2020 2020 2072                 r
+00029760: 616e 645f 7061 7261 6d73 203d 207b 0a20  and_params = {. 
+00029770: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00029780: 2020 2027 6d6f 6465 6c5f 5f6e 5f65 7374     'model__n_est
+00029790: 696d 6174 6f72 7327 3a20 6e70 2e6c 696e  imators': np.lin
+000297a0: 7370 6163 6528 3530 2c31 3030 302c 3130  space(50,1000,10
+000297b0: 292e 6173 7479 7065 2869 6e74 292c 0a20  ).astype(int),. 
+000297c0: 2020 2020 2020 2020 2020 2020 2020 2020                  
+000297d0: 2020 2027 6d6f 6465 6c5f 5f63 6c61 7373     'model__class
+000297e0: 5f77 6569 6768 7427 3a5b 4e6f 6e65 2c20  _weight':[None, 
+000297f0: 2762 616c 616e 6365 6427 5d2c 0a20 2020  'balanced'],.   
+00029800: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00029810: 2027 6d6f 6465 6c5f 5f6c 6561 726e 696e   'model__learnin
+00029820: 675f 7261 7465 273a 206e 702e 6c69 6e73  g_rate': np.lins
+00029830: 7061 6365 2830 2e30 3030 312c 312c 3130  pace(0.0001,1,10
+00029840: 292c 0a20 2020 2020 2020 2020 2020 2020  ),.             
+00029850: 2020 2020 2020 2027 6d6f 6465 6c5f 5f62         'model__b
+00029860: 6f6f 7374 696e 675f 7479 7065 273a 205b  oosting_type': [
+00029870: 2764 6172 7427 2c27 6762 6474 275d 2c0a  'dart','gbdt'],.
+00029880: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00029890: 2020 2020 7d0a 2020 2020 2020 2020 2020      }.          
+000298a0: 2020 2020 2020 6772 6964 5f70 6172 616d        grid_param
+000298b0: 7320 3d20 7b0a 2020 2020 2020 2020 2020  s = {.          
+000298c0: 2020 2020 2020 2020 2020 276d 6f64 656c            'model
+000298d0: 5f5f 6e5f 6573 7469 6d61 746f 7273 273a  __n_estimators':
+000298e0: 206e 702e 6c69 6e73 7061 6365 2835 302c   np.linspace(50,
+000298f0: 3130 3030 2c35 292e 6173 7479 7065 2869  1000,5).astype(i
+00029900: 6e74 292c 0a20 2020 2020 2020 2020 2020  nt),.           
+00029910: 2020 2020 2020 2020 2027 6d6f 6465 6c5f           'model_
+00029920: 5f63 6c61 7373 5f77 6569 6768 7427 3a5b  _class_weight':[
+00029930: 4e6f 6e65 2c20 2762 616c 616e 6365 6427  None, 'balanced'
+00029940: 5d2c 0a20 2020 2020 2020 2020 2020 2020  ],.             
+00029950: 2020 2020 2020 2027 6d6f 6465 6c5f 5f62         'model__b
+00029960: 6f6f 7374 696e 675f 7479 7065 273a 205b  oosting_type': [
+00029970: 2764 6172 7427 2c27 6762 6474 275d 2c0a  'dart','gbdt'],.
+00029980: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00029990: 2020 2020 2020 2020 7d0a 2020 2020 2020          }.      
+000299a0: 2020 656c 7365 3a0a 2020 2020 2020 2020    else:.        
+000299b0: 2020 2020 6966 2067 7269 645f 7365 6172      if grid_sear
+000299c0: 6368 3a0a 2020 2020 2020 2020 2020 2020  ch:.            
+000299d0: 2020 2020 6772 6964 5f70 6172 616d 7320      grid_params 
+000299e0: 3d20 636f 7079 2e64 6565 7063 6f70 7928  = copy.deepcopy(
+000299f0: 7061 7261 6d73 290a 2020 2020 2020 2020  params).        
+00029a00: 2020 2020 656c 7365 3a0a 2020 2020 2020      else:.      
+00029a10: 2020 2020 2020 2020 2020 7261 6e64 5f70            rand_p
+00029a20: 6172 616d 7320 3d20 636f 7079 2e64 6565  arams = copy.dee
+00029a30: 7063 6f70 7928 7061 7261 6d73 290a 2020  pcopy(params).  
+00029a40: 2020 2020 2020 2020 2020 2020 2020 0a20                . 
+00029a50: 2020 2020 2020 2023 2323 2323 2323 2320         ######## 
+00029a60: 2020 4e6f 7720 6c65 7427 7320 7065 7266    Now let's perf
+00029a70: 6f72 6d20 7261 6e64 6f6d 697a 6564 2073  orm randomized s
+00029a80: 6561 7263 6820 746f 2066 696e 6420 6265  earch to find be
+00029a90: 7374 2068 7970 6572 2070 6172 616d 6574  st hyper paramet
+00029aa0: 6572 7320 2323 2323 2323 0a20 2020 2020  ers ######.     
+00029ab0: 2020 2069 6e69 745f 7061 7261 6d73 203d     init_params =
+00029ac0: 207b 0a20 2020 2020 2020 2020 2020 2020   {.             
+00029ad0: 207d 0a0a 2020 2020 2020 2020 6966 206d   }..        if m
+00029ae0: 6f64 656c 7479 7065 203d 3d20 2752 6567  odeltype == 'Reg
+00029af0: 7265 7373 696f 6e27 3a0a 2020 2020 2020  ression':.      
+00029b00: 2020 2020 2020 7363 6f72 696e 6720 3d20        scoring = 
+00029b10: 276e 6567 5f6d 6561 6e5f 7371 7561 7265  'neg_mean_square
+00029b20: 645f 6572 726f 7227 0a20 2020 2020 2020  d_error'.       
+00029b30: 2020 2020 2073 636f 7265 5f6e 616d 6520       score_name 
+00029b40: 3d20 274d 5345 270a 2020 2020 2020 2020  = 'MSE'.        
+00029b50: 2020 2020 7365 6c66 2e6d 6f64 656c 203d      self.model =
+00029b60: 204c 4742 4d52 6567 7265 7373 6f72 2872   LGBMRegressor(r
+00029b70: 616e 646f 6d5f 7365 6564 3d39 3929 0a20  andom_seed=99). 
+00029b80: 2020 2020 2020 2020 2020 2073 656c 662e             self.
+00029b90: 6d6f 6465 6c2e 7365 745f 7061 7261 6d73  model.set_params
+00029ba0: 282a 2a69 6e69 745f 7061 7261 6d73 2920  (**init_params) 
+00029bb0: 2020 2020 2020 2020 2020 200a 2020 2020             .    
+00029bc0: 2020 2020 656c 7365 3a0a 2020 2020 2020      else:.      
+00029bd0: 2020 2020 2020 7365 6c66 2e6d 6f64 656c        self.model
+00029be0: 203d 204c 4742 4d43 6c61 7373 6966 6965   = LGBMClassifie
+00029bf0: 7228 7261 6e64 6f6d 5f73 6565 643d 3939  r(random_seed=99
+00029c00: 290a 2020 2020 2020 2020 2020 2020 7365  ).            se
+00029c10: 6c66 2e6d 6f64 656c 2e73 6574 5f70 6172  lf.model.set_par
+00029c20: 616d 7328 2a2a 696e 6974 5f70 6172 616d  ams(**init_param
+00029c30: 7329 2020 2020 2020 2020 2020 2020 0a20  s)            . 
+00029c40: 2020 2020 2020 2020 2020 2069 6620 6772             if gr
+00029c50: 6964 5f73 6561 7263 683a 0a20 2020 2020  id_search:.     
+00029c60: 2020 2020 2020 2020 2020 2073 636f 7269             scori
+00029c70: 6e67 203d 2027 6261 6c61 6e63 6564 5f61  ng = 'balanced_a
+00029c80: 6363 7572 6163 7927 0a20 2020 2020 2020  ccuracy'.       
+00029c90: 2020 2020 2020 2020 2073 636f 7265 5f6e           score_n
+00029ca0: 616d 6520 3d20 2762 616c 616e 6365 645f  ame = 'balanced_
+00029cb0: 6163 6375 7261 6379 270a 2020 2020 2020  accuracy'.      
+00029cc0: 2020 2020 2020 656c 7365 3a0a 2020 2020        else:.    
+00029cd0: 2020 2020 2020 2020 2020 2020 7363 6f72              scor
+00029ce0: 696e 6720 3d20 2762 616c 616e 6365 645f  ing = 'balanced_
+00029cf0: 6163 6375 7261 6379 270a 2020 2020 2020  accuracy'.      
+00029d00: 2020 2020 2020 2020 2020 7363 6f72 655f            score_
+00029d10: 6e61 6d65 203d 2027 6261 6c61 6e63 6564  name = 'balanced
+00029d20: 5f61 6363 7572 6163 7927 0a0a 2020 2020  _accuracy'..    
+00029d30: 2020 2020 6966 2058 5f74 7261 696e 2e73      if X_train.s
+00029d40: 6861 7065 5b30 5d20 3c3d 3130 3030 3030  hape[0] <=100000
+00029d50: 3a0a 2020 2020 2020 2020 2020 2020 6e5f  :.            n_
+00029d60: 6974 6572 203d 2031 300a 2020 2020 2020  iter = 10.      
+00029d70: 2020 656c 7365 3a0a 2020 2020 2020 2020    else:.        
+00029d80: 2020 2020 6e5f 6974 6572 203d 2035 0a20      n_iter = 5. 
+00029d90: 2020 2020 2020 2023 2323 2320 5468 6973         #### This
+00029da0: 2069 7320 7768 6572 6520 796f 7520 6772   is where you gr
+00029db0: 6964 2073 6561 7263 6820 7468 6520 7069  id search the pi
+00029dc0: 7065 6c69 6e65 206e 6f77 2023 2323 2323  peline now #####
+00029dd0: 2323 2323 2323 2323 230a 0a20 2020 2020  #########..     
+00029de0: 2020 2069 6620 6772 6964 5f73 6561 7263     if grid_searc
+00029df0: 683a 0a20 2020 2020 2020 2020 2020 2073  h:.            s
+00029e00: 6561 7263 6820 3d20 4772 6964 5365 6172  earch = GridSear
+00029e10: 6368 4356 280a 2020 2020 2020 2020 2020  chCV(.          
+00029e20: 2020 2020 2020 2020 2020 7365 6c66 2c20            self, 
+00029e30: 0a20 2020 2020 2020 2020 2020 2020 2020  .               
+00029e40: 2020 2020 2067 7269 645f 7061 7261 6d73       grid_params
+00029e50: 2c20 0a20 2020 2020 2020 2020 2020 2020  , .             
+00029e60: 2020 2020 2020 2063 763d 352c 0a20 2020         cv=5,.   
+00029e70: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00029e80: 2073 636f 7269 6e67 3d73 636f 7269 6e67   scoring=scoring
+00029e90: 2c0a 2020 2020 2020 2020 2020 2020 2020  ,.              
+00029ea0: 2020 2020 2020 7265 6669 743d 4661 6c73        refit=Fals
+00029eb0: 652c 0a20 2020 2020 2020 2020 2020 2020  e,.             
+00029ec0: 2020 2020 2020 2072 6574 7572 6e5f 7472         return_tr
+00029ed0: 6169 6e5f 7363 6f72 6520 3d20 5472 7565  ain_score = True
+00029ee0: 2c0a 2020 2020 2020 2020 2020 2020 2020  ,.              
+00029ef0: 2020 2020 2020 6e5f 6a6f 6273 3d2d 312c        n_jobs=-1,
+00029f00: 0a20 2020 2020 2020 2020 2020 2020 2020  .               
+00029f10: 2020 2020 2076 6572 626f 7365 3d54 7275       verbose=Tru
+00029f20: 652c 0a20 2020 2020 2020 2020 2020 2020  e,.             
+00029f30: 2020 2020 2020 2029 0a20 2020 2020 2020         ).       
+00029f40: 2065 6c73 653a 0a20 2020 2020 2020 2020   else:.         
+00029f50: 2020 2073 6561 7263 6820 3d20 5261 6e64     search = Rand
+00029f60: 6f6d 697a 6564 5365 6172 6368 4356 280a  omizedSearchCV(.
+00029f70: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00029f80: 2020 2020 7365 6c66 2c0a 2020 2020 2020      self,.      
+00029f90: 2020 2020 2020 2020 2020 2020 2020 7261                ra
+00029fa0: 6e64 5f70 6172 616d 732c 0a20 2020 2020  nd_params,.     
+00029fb0: 2020 2020 2020 2020 2020 2020 2020 206e                 n
+00029fc0: 5f69 7465 7220 3d20 6e5f 6974 6572 2c0a  _iter = n_iter,.
 00029fd0: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00029fe0: 2073 656c 662e 7966 6f72 6d65 722e 6669   self.yformer.fi
-00029ff0: 7428 7929 0a20 2020 2020 2020 2020 2020  t(y).           
-0002a000: 2020 2020 2020 2020 2079 7420 3d20 7365           yt = se
-0002a010: 6c66 2e79 666f 726d 6572 2e74 7261 6e73  lf.yformer.trans
-0002a020: 666f 726d 2879 290a 2020 2020 2020 2020  form(y).        
-0002a030: 2020 2020 2020 2020 2020 2020 7072 696e              prin
-0002a040: 7428 2720 2020 2074 7261 6e73 666f 726d  t('    transform
-0002a050: 6564 2074 6172 6765 7420 6672 6f6d 206f  ed target from o
-0002a060: 626a 6563 7420 7479 7065 2074 6f20 6e75  bject type to nu
-0002a070: 6d65 7269 6327 290a 0a20 2020 2020 2020  meric')..       
-0002a080: 2020 2020 2020 2020 2020 2020 2069 6620               if 
-0002a090: 7920 6973 206e 6f74 204e 6f6e 653a 0a20  y is not None:. 
-0002a0a0: 2020 2020 2020 2020 2020 2020 2020 2020                  
-0002a0b0: 2020 2020 2020 2079 742e 696e 6465 7820         yt.index 
-0002a0c0: 3d20 7365 6c66 2e79 5f69 6e64 6578 0a20  = self.y_index. 
-0002a0d0: 2020 2020 2020 2020 2020 2020 2020 2020                  
-0002a0e0: 2020 2023 2323 204d 616b 6520 7375 7265     ### Make sure
-0002a0f0: 2079 6f75 206c 6561 7665 2073 656c 662e   you leave self.
-0002a100: 6d6f 6465 6c5f 696e 7075 7420 6173 204e  model_input as N
-0002a110: 6f6e 6520 7768 656e 2074 6865 7265 2069  one when there i
-0002a120: 7320 6e6f 206d 6f64 656c 2023 2323 200a  s no model ### .
-0002a130: 2020 2020 2020 2020 2020 2020 2020 2020                  
-0002a140: 2020 2020 6966 206d 6f64 656c 5f6e 616d      if model_nam
-0002a150: 6520 3d3d 2027 273a 200a 2020 2020 2020  e == '': .      
-0002a160: 2020 2020 2020 2020 2020 2020 2020 2020                  
-0002a170: 2020 7365 6c66 2e6d 6f64 656c 5f69 6e70    self.model_inp
-0002a180: 7574 203d 204e 6f6e 650a 2020 2020 2020  ut = None.      
-0002a190: 2020 2020 2020 2020 2020 2020 2020 656c                el
-0002a1a0: 7365 3a0a 2020 2020 2020 2020 2020 2020  se:.            
-0002a1b0: 2020 2020 2020 2020 2020 2020 6d6c 5f70              ml_p
-0002a1c0: 6970 652e 6669 7428 582c 7974 290a 2020  ipe.fit(X,yt).  
-0002a1d0: 2020 2020 2020 2020 2020 2020 2020 2020                  
-0002a1e0: 2020 2020 2020 7365 6c66 2e78 666f 726d        self.xform
-0002a1f0: 6572 203d 206d 6c5f 7069 7065 0a20 2020  er = ml_pipe.   
-0002a200: 2020 2020 2020 2020 2020 2020 2065 6c73               els
-0002a210: 653a 0a20 2020 2020 2020 2020 2020 2020  e:.             
-0002a220: 2020 2020 2020 2023 2323 204d 616b 6520         ### Make 
-0002a230: 7375 7265 2079 6f75 206c 6561 7665 2073  sure you leave s
-0002a240: 656c 662e 6d6f 6465 6c20 6173 204e 6f6e  elf.model as Non
-0002a250: 6520 7768 656e 2074 6865 7265 2069 7320  e when there is 
-0002a260: 6e6f 206d 6f64 656c 2023 2323 200a 2020  no model ### .  
-0002a270: 2020 2020 2020 2020 2020 2020 2020 2020                  
-0002a280: 2020 6966 206d 6f64 656c 5f6e 616d 6520    if model_name 
-0002a290: 3d3d 2027 273a 200a 2020 2020 2020 2020  == '': .        
-0002a2a0: 2020 2020 2020 2020 2020 2020 2020 2020                  
-0002a2b0: 7365 6c66 2e6d 6f64 656c 203d 204e 6f6e  self.model = Non
-0002a2c0: 650a 2020 2020 2020 2020 2020 2020 2020  e.              
-0002a2d0: 2020 2020 2020 656c 7365 3a0a 2020 2020        else:.    
-0002a2e0: 2020 2020 2020 2020 2020 2020 2020 2020                  
-0002a2f0: 2020 2020 6d6c 5f70 6970 652e 6669 7428      ml_pipe.fit(
-0002a300: 582c 7929 0a20 2020 2020 2020 2020 2020  X,y).           
-0002a310: 2020 2020 2020 2020 2020 2020 2073 656c               sel
-0002a320: 662e 7866 6f72 6d65 7220 3d20 6d6c 5f70  f.xformer = ml_p
-0002a330: 6970 650a 2020 2020 2020 2020 2020 2020  ipe.            
-0002a340: 6578 6365 7074 2045 7863 6570 7469 6f6e  except Exception
-0002a350: 2061 7320 653a 0a20 2020 2020 2020 2020   as e:.         
-0002a360: 2020 2020 2020 2070 7269 6e74 2827 4572         print('Er
-0002a370: 726f 7269 6e67 2064 7565 2074 6f20 2573  roring due to %s
-0002a380: 3a20 5468 6572 6520 6d61 7920 6265 2073  : There may be s
-0002a390: 6f6d 6574 6869 6e67 2077 726f 6e67 2077  omething wrong w
-0002a3a0: 6974 6820 796f 7572 2064 6174 6120 7479  ith your data ty
-0002a3b0: 7065 7320 6f72 2069 6e70 7574 732e 2720  pes or inputs.' 
-0002a3c0: 2565 290a 2020 2020 2020 2020 2020 2020  %e).            
-0002a3d0: 2020 2020 7365 6c66 2e78 666f 726d 6572      self.xformer
-0002a3e0: 203d 206d 6c5f 7069 7065 0a20 2020 2020   = ml_pipe.     
-0002a3f0: 2020 2020 2020 2020 2020 2072 6574 7572             retur
-0002a400: 6e20 7365 6c66 0a20 2020 2020 2020 2020  n self.         
-0002a410: 2020 2070 7269 6e74 2827 6d6f 6465 6c20     print('model 
-0002a420: 7069 7065 6c69 6e65 2066 6974 7465 6420  pipeline fitted 
-0002a430: 7769 7468 2025 7320 6d6f 6465 6c27 2025  with %s model' %
-0002a440: 6d6f 6465 6c5f 6e61 6d65 290a 2020 2020  model_name).    
-0002a450: 2020 2020 2020 2020 7365 6c66 2e66 6974          self.fit
-0002a460: 7465 6420 3d20 5472 7565 0a20 2020 2020  ted = True.     
-0002a470: 2020 2065 6c73 653a 0a20 2020 2020 2020     else:.       
-0002a480: 2020 2020 2023 2323 2069 6620 7468 6572       ### if ther
-0002a490: 6520 6973 206e 6f20 6769 7665 6e20 6d6f  e is no given mo
-0002a4a0: 6465 6c2c 206a 7573 7420 7573 6520 7468  del, just use th
-0002a4b0: 6520 6461 7461 5f70 6970 656c 696e 6520  e data_pipeline 
-0002a4c0: 2323 0a20 2020 2020 2020 2020 2020 2064  ##.            d
-0002a4d0: 6174 615f 7069 7065 203d 206d 616b 655f  ata_pipe = make_
-0002a4e0: 7369 6d70 6c65 5f70 6970 656c 696e 6528  simple_pipeline(
-0002a4f0: 582c 2079 2c20 656e 636f 6465 7273 3d73  X, y, encoders=s
-0002a500: 656c 662e 656e 636f 6465 7273 2c20 7363  elf.encoders, sc
-0002a510: 616c 6572 733d 7365 6c66 2e73 6361 6c65  alers=self.scale
-0002a520: 7273 2c0a 2020 2020 2020 2020 2020 2020  rs,.            
-0002a530: 2020 2020 6461 7465 5f74 6f5f 7374 7269      date_to_stri
-0002a540: 6e67 3d73 656c 662e 6461 7465 5f74 6f5f  ng=self.date_to_
-0002a550: 7374 7269 6e67 2c20 7361 7665 5f66 6c61  string, save_fla
-0002a560: 6720 3d20 7365 6c66 2e73 6176 652c 200a  g = self.save, .
-0002a570: 2020 2020 2020 2020 2020 2020 2020 2020                  
-0002a580: 636f 6d62 696e 655f 7261 7265 5f66 6c61  combine_rare_fla
-0002a590: 673d 7365 6c66 2e63 6f6d 6269 6e65 5f72  g=self.combine_r
-0002a5a0: 6172 652c 2076 6572 626f 7365 3d73 656c  are, verbose=sel
-0002a5b0: 662e 7665 7262 6f73 6529 0a20 2020 2020  f.verbose).     
-0002a5c0: 2020 2020 2020 2070 7269 6e74 2827 4e6f         print('No
-0002a5d0: 206d 6f64 656c 2069 6e70 7574 2067 6976   model input giv
-0002a5e0: 656e 2e2e 2e27 290a 2020 2020 2020 2020  en...').        
-0002a5f0: 2020 2020 2323 2323 2068 6572 6520 7765      #### here we
-0002a600: 2063 6865 636b 2069 6620 7765 2073 686f   check if we sho
-0002a610: 756c 6420 6164 6420 6120 6d6f 6465 6c20  uld add a model 
-0002a620: 746f 2074 6865 2070 6970 656c 696e 6520  to the pipeline 
-0002a630: 0a20 2020 2020 2020 2020 2020 2070 7269  .            pri
-0002a640: 6e74 2827 5820 616e 6420 7920 5472 616e  nt('X and y Tran
-0002a650: 7366 6f72 6d65 7220 5069 7065 6c69 6e65  sformer Pipeline
-0002a660: 2063 7265 6174 6564 2e2e 2e27 290a 2020   created...').  
-0002a670: 2020 2020 2020 2020 2020 6966 2073 656c            if sel
-0002a680: 662e 7472 616e 7366 6f72 6d5f 7461 7267  f.transform_targ
-0002a690: 6574 3a0a 2020 2020 2020 2020 2020 2020  et:.            
-0002a6a0: 2020 2020 7365 6c66 2e79 666f 726d 6572      self.yformer
-0002a6b0: 2e66 6974 2879 290a 2020 2020 2020 2020  .fit(y).        
-0002a6c0: 2020 2020 2020 2020 7974 203d 2073 656c          yt = sel
-0002a6d0: 662e 7966 6f72 6d65 722e 7472 616e 7366  f.yformer.transf
-0002a6e0: 6f72 6d28 7929 0a20 2020 2020 2020 2020  orm(y).         
-0002a6f0: 2020 2020 2020 2070 7269 6e74 2827 2020         print('  
-0002a700: 2020 7472 616e 7366 6f72 6d65 6420 7461    transformed ta
-0002a710: 7267 6574 2066 726f 6d20 6f62 6a65 6374  rget from object
-0002a720: 2074 7970 6520 746f 206e 756d 6572 6963   type to numeric
-0002a730: 2729 0a20 2020 2020 2020 2020 2020 2020  ').             
-0002a740: 2020 2069 6620 7920 6973 206e 6f74 204e     if y is not N
-0002a750: 6f6e 653a 0a20 2020 2020 2020 2020 2020  one:.           
-0002a760: 2020 2020 2020 2020 2079 742e 696e 6465           yt.inde
-0002a770: 7820 3d20 7365 6c66 2e79 5f69 6e64 6578  x = self.y_index
-0002a780: 0a20 2020 2020 2020 2020 2020 2020 2020  .               
-0002a790: 2064 6174 615f 7069 7065 2e66 6974 2858   data_pipe.fit(X
-0002a7a0: 2c79 7429 0a20 2020 2020 2020 2020 2020  ,yt).           
-0002a7b0: 2020 2020 2073 656c 662e 7866 6f72 6d65       self.xforme
-0002a7c0: 7220 3d20 6461 7461 5f70 6970 6520 0a20  r = data_pipe . 
-0002a7d0: 2020 2020 2020 2020 2020 2065 6c73 653a             else:
-0002a7e0: 0a20 2020 2020 2020 2020 2020 2020 2020  .               
-0002a7f0: 2064 6174 615f 7069 7065 2e66 6974 2858   data_pipe.fit(X
-0002a800: 2c79 290a 2020 2020 2020 2020 2020 2020  ,y).            
-0002a810: 2020 2020 7365 6c66 2e78 666f 726d 6572      self.xformer
-0002a820: 203d 2064 6174 615f 7069 7065 0a20 2020   = data_pipe.   
-0002a830: 2020 2020 2020 2020 2023 2320 7765 2077           ## we w
-0002a840: 696c 6c20 6c65 6176 6520 7365 6c66 2e6d  ill leave self.m
-0002a850: 6f64 656c 2061 7320 4e6f 6e65 2023 230a  odel as None ##.
-0002a860: 2020 2020 2020 2020 2020 2020 7365 6c66              self
-0002a870: 2e66 6974 7465 6420 3d20 5472 7565 0a20  .fitted = True. 
-0002a880: 2020 2020 2020 2023 2323 2070 7269 6e74         ### print
-0002a890: 2069 6d62 616c 616e 6365 6420 2323 230a   imbalanced ###.
-0002a8a0: 2020 2020 2020 2020 6966 2073 656c 662e          if self.
-0002a8b0: 696d 6261 6c61 6e63 6564 3a0a 2020 2020  imbalanced:.    
-0002a8c0: 2020 2020 2020 2020 7072 696e 7428 2723          print('#
-0002a8d0: 2323 2041 6c65 7274 2120 446f 206e 6f74  ## Alert! Do not
-0002a8e0: 2075 7365 2053 4d4f 5445 2069 6620 7468   use SMOTE if th
-0002a8f0: 6973 2069 7320 6e6f 7420 616e 2069 6d62  is is not an imb
-0002a900: 616c 616e 6365 6420 636c 6173 7369 6669  alanced classifi
-0002a910: 6361 7469 6f6e 2070 726f 626c 656d 2023  cation problem #
-0002a920: 2323 2323 2323 2729 0a20 2020 2020 2020  ######').       
-0002a930: 2020 2020 2069 6620 6973 696e 7374 616e       if isinstan
-0002a940: 6365 2858 2c20 7064 2e44 6174 6146 7261  ce(X, pd.DataFra
-0002a950: 6d65 293a 0a20 2020 2020 2020 2020 2020  me):.           
-0002a960: 2020 2020 2076 6172 5f63 6c61 7373 6573       var_classes
-0002a970: 203d 2063 6c61 7373 6966 795f 7661 7273   = classify_vars
-0002a980: 5f70 616e 6461 7328 5829 0a20 2020 2020  _pandas(X).     
-0002a990: 2020 2020 2020 2020 2020 2063 6174 5f76             cat_v
-0002a9a0: 6172 7320 3d20 7661 725f 636c 6173 7365  ars = var_classe
-0002a9b0: 735b 2763 6174 6567 6f72 6963 616c 5f76  s['categorical_v
-0002a9c0: 6172 7327 5d0a 2020 2020 2020 2020 2020  ars'].          
-0002a9d0: 2020 2020 2020 6966 206c 656e 2863 6174        if len(cat
-0002a9e0: 5f76 6172 7329 203e 2030 3a0a 2020 2020  _vars) > 0:.    
-0002a9f0: 2020 2020 2020 2020 2020 2020 2020 2020                  
-0002aa00: 6361 745f 696e 6465 7820 3d20 5b58 2e63  cat_index = [X.c
-0002aa10: 6f6c 756d 6e73 2e74 6f6c 6973 7428 292e  olumns.tolist().
-0002aa20: 696e 6465 7828 7829 2066 6f72 2078 2069  index(x) for x i
-0002aa30: 6e20 6361 745f 7661 7273 5d0a 2020 2020  n cat_vars].    
-0002aa40: 2020 2020 2020 2020 2020 2020 2020 2020                  
-0002aa50: 7365 6c66 2e73 6d6f 7465 7820 3d20 534d  self.smotex = SM
-0002aa60: 4f54 454e 4328 6361 7465 676f 7269 6361  OTENC(categorica
-0002aa70: 6c5f 6665 6174 7572 6573 3d63 6174 5f69  l_features=cat_i
-0002aa80: 6e64 6578 290a 2020 2020 2020 2020 2020  ndex).          
-0002aa90: 2020 2020 2020 2020 2020 6966 2073 656c            if sel
-0002aaa0: 662e 7665 7262 6f73 653a 0a20 2020 2020  f.verbose:.     
-0002aab0: 2020 2020 2020 2020 2020 2020 2020 2020                  
-0002aac0: 2020 2070 7269 6e74 2827 496d 6261 6c61     print('Imbala
-0002aad0: 6e63 6564 2066 6c61 6720 7365 742e 2053  nced flag set. S
-0002aae0: 4d4f 5445 4e43 2077 6974 6820 2564 2063  MOTENC with %d c
-0002aaf0: 6174 6567 6f72 6963 616c 2076 6172 7320  ategorical vars 
-0002ab00: 7769 6c6c 2062 6520 7573 6564 2069 6e20  will be used in 
-0002ab10: 7069 7065 6c69 6e65 2e27 2025 6c65 6e28  pipeline.' %len(
-0002ab20: 6361 745f 7661 7273 2929 0a20 2020 2020  cat_vars)).     
-0002ab30: 2020 2020 2020 2020 2020 2065 6c73 653a             else:
-0002ab40: 0a20 2020 2020 2020 2020 2020 2020 2020  .               
-0002ab50: 2020 2020 2073 656c 662e 736d 6f74 6578       self.smotex
-0002ab60: 203d 2042 6f72 6465 726c 696e 6553 4d4f   = BorderlineSMO
-0002ab70: 5445 2829 0a20 2020 2020 2020 2020 2020  TE().           
-0002ab80: 2020 2020 2020 2020 2069 6620 7365 6c66           if self
-0002ab90: 2e76 6572 626f 7365 3a0a 2020 2020 2020  .verbose:.      
-0002aba0: 2020 2020 2020 2020 2020 2020 2020 2020                  
-0002abb0: 2020 7072 696e 7428 2749 6d62 616c 616e    print('Imbalan
-0002abc0: 6365 6420 666c 6167 2073 6574 2e20 426f  ced flag set. Bo
-0002abd0: 7264 6572 6c69 6e65 2053 4d4f 5445 2077  rderline SMOTE w
-0002abe0: 696c 6c20 6265 2061 6464 6564 2074 6f20  ill be added to 
-0002abf0: 7069 7065 6c69 6e65 2e27 290a 2020 2020  pipeline.').    
-0002ac00: 2020 2020 2020 2020 656c 7365 3a0a 2020          else:.  
-0002ac10: 2020 2020 2020 2020 2020 2020 2020 7365                se
-0002ac20: 6c66 2e73 6d6f 7465 7820 3d20 426f 7264  lf.smotex = Bord
-0002ac30: 6572 6c69 6e65 534d 4f54 4528 290a 2020  erlineSMOTE().  
-0002ac40: 2020 2020 2020 2020 2020 2020 2020 6966                if
-0002ac50: 2073 656c 662e 7665 7262 6f73 653a 0a20   self.verbose:. 
-0002ac60: 2020 2020 2020 2020 2020 2020 2020 2020                  
-0002ac70: 2020 2070 7269 6e74 2827 496d 6261 6c61     print('Imbala
-0002ac80: 6e63 6564 2066 6c61 6720 7365 742e 2042  nced flag set. B
-0002ac90: 6f72 6465 726c 696e 6520 534d 4f54 4520  orderline SMOTE 
-0002aca0: 7769 6c6c 2062 6520 6164 6465 6420 746f  will be added to
-0002acb0: 2070 6970 656c 696e 652e 2729 0a20 2020   pipeline.').   
-0002acc0: 2020 2020 2064 6966 6674 696d 6520 3d20       difftime = 
-0002acd0: 6d61 7828 312c 2069 6e74 2874 696d 652e  max(1, int(time.
-0002ace0: 7469 6d65 2829 2d73 7461 7274 5f74 696d  time()-start_tim
-0002acf0: 6529 290a 2020 2020 2020 2020 7072 696e  e)).        prin
-0002ad00: 7428 2720 2020 2054 696d 6520 7461 6b65  t('    Time take
-0002ad10: 6e20 746f 2066 6974 2064 6174 6173 6574  n to fit dataset
-0002ad20: 203d 2025 7320 7365 636f 6e64 2873 2927   = %s second(s)'
-0002ad30: 2025 6469 6666 7469 6d65 290a 2020 2020   %difftime).    
-0002ad40: 2020 2020 7265 7475 726e 2073 656c 660a      return self.
-0002ad50: 0a20 2020 2064 6566 2070 7265 6469 6374  .    def predict
-0002ad60: 2873 656c 662c 2058 2c20 793d 4e6f 6e65  (self, X, y=None
-0002ad70: 293a 0a20 2020 2020 2020 2069 6620 7365  ):.        if se
-0002ad80: 6c66 2e66 6974 7465 6420 616e 6420 7365  lf.fitted and se
-0002ad90: 6c66 2e6d 6f64 656c 5f69 6e70 7574 2069  lf.model_input i
-0002ada0: 7320 6e6f 7420 4e6f 6e65 3a0a 2020 2020  s not None:.    
-0002adb0: 2020 2020 2020 2020 795f 656e 6320 3d20          y_enc = 
-0002adc0: 7365 6c66 2e78 666f 726d 6572 2e70 7265  self.xformer.pre
-0002add0: 6469 6374 2858 290a 2020 2020 2020 2020  dict(X).        
-0002ade0: 2020 2020 7265 7475 726e 2079 5f65 6e63      return y_enc
-0002adf0: 0a20 2020 2020 2020 2065 6c73 653a 0a20  .        else:. 
-0002ae00: 2020 2020 2020 2020 2020 2070 7269 6e74             print
-0002ae10: 2827 4d6f 6465 6c20 6e6f 7420 6669 7474  ('Model not fitt
-0002ae20: 6564 206f 7220 6d6f 6465 6c20 6e6f 7420  ed or model not 
-0002ae30: 7072 6f76 6964 6564 2e20 506c 6561 7365  provided. Please
-0002ae40: 2063 6865 636b 2079 6f75 7220 696e 7075   check your inpu
-0002ae50: 7473 2061 6e64 2074 7279 2061 6761 696e  ts and try again
-0002ae60: 2729 0a20 2020 2020 2020 2020 2020 2072  ').            r
-0002ae70: 6574 7572 6e20 790a 0a20 2020 2064 6566  eturn y..    def
-0002ae80: 2074 7261 6e73 666f 726d 2873 656c 662c   transform(self,
-0002ae90: 2058 2c20 793d 4e6f 6e65 293a 0a20 2020   X, y=None):.   
-0002aea0: 2020 2020 2058 203d 2063 6f70 792e 6465       X = copy.de
-0002aeb0: 6570 636f 7079 2858 290a 2020 2020 2020  epcopy(X).      
-0002aec0: 2020 7920 3d20 636f 7079 2e64 6565 7063    y = copy.deepc
-0002aed0: 6f70 7928 7929 0a20 2020 2020 2020 2073  opy(y).        s
-0002aee0: 656c 662e 585f 696e 6465 7820 3d20 582e  elf.X_index = X.
-0002aef0: 696e 6465 780a 2020 2020 2020 2020 0a20  index.        . 
-0002af00: 2020 2020 2020 2073 7461 7274 5f74 696d         start_tim
-0002af10: 6520 3d20 7469 6d65 2e74 696d 6528 290a  e = time.time().
-0002af20: 2020 2020 2020 2020 6966 2079 2069 7320          if y is 
-0002af30: 4e6f 6e65 2061 6e64 2073 656c 662e 6669  None and self.fi
-0002af40: 7474 6564 3a0a 2020 2020 2020 2020 2020  tted:.          
-0002af50: 2020 585f 656e 6320 3d20 7365 6c66 2e78    X_enc = self.x
-0002af60: 666f 726d 6572 2e74 7261 6e73 666f 726d  former.transform
-0002af70: 2858 290a 2020 2020 2020 2020 2020 2020  (X).            
-0002af80: 585f 656e 632e 696e 6465 7820 3d20 7365  X_enc.index = se
-0002af90: 6c66 2e58 5f69 6e64 6578 0a20 2020 2020  lf.X_index.     
-0002afa0: 2020 2020 2020 2023 2323 2073 696e 6365         ### since
-0002afb0: 2078 666f 726d 6572 206f 6e6c 7920 7472   xformer only tr
-0002afc0: 616e 7366 6f72 6d73 2058 2023 2323 0a20  ansforms X ###. 
-0002afd0: 2020 2020 2020 2020 2020 2064 6966 6674             difft
-0002afe0: 696d 6520 3d20 6d61 7828 312c 2069 6e74  ime = max(1, int
-0002aff0: 2874 696d 652e 7469 6d65 2829 2d73 7461  (time.time()-sta
-0002b000: 7274 5f74 696d 6529 290a 2020 2020 2020  rt_time)).      
-0002b010: 2020 2020 2020 7072 696e 7428 2720 2020        print('   
-0002b020: 2054 696d 6520 7461 6b65 6e20 746f 2074   Time taken to t
-0002b030: 7261 6e73 666f 726d 2064 6174 6173 6574  ransform dataset
-0002b040: 203d 2025 7320 7365 636f 6e64 2873 2927   = %s second(s)'
-0002b050: 2025 6469 6666 7469 6d65 290a 2020 2020   %difftime).    
-0002b060: 2020 2020 2020 2020 7072 696e 7428 2720          print(' 
-0002b070: 2020 2053 6861 7065 206f 6620 7472 616e     Shape of tran
-0002b080: 7366 6f72 6d65 6420 6461 7461 7365 743a  sformed dataset:
-0002b090: 2025 7327 2025 2858 5f65 6e63 2e73 6861   %s' %(X_enc.sha
-0002b0a0: 7065 2c29 290a 2020 2020 2020 2020 2020  pe,)).          
-0002b0b0: 2020 7265 7475 726e 2058 5f65 6e63 0a20    return X_enc. 
-0002b0c0: 2020 2020 2020 2065 6c69 6620 7365 6c66         elif self
-0002b0d0: 2e66 6974 7465 6420 616e 6420 7365 6c66  .fitted and self
-0002b0e0: 2e6d 6f64 656c 5f69 6e70 7574 2069 7320  .model_input is 
-0002b0f0: 6e6f 7420 4e6f 6e65 3a0a 2020 2020 2020  not None:.      
-0002b100: 2020 2020 2020 7072 696e 7428 2745 7272        print('Err
-0002b110: 6f72 3a20 4e6f 2074 7261 6e73 666f 726d  or: No transform
-0002b120: 2061 6c6c 6f77 6564 2e20 596f 7520 6d75   allowed. You mu
-0002b130: 7374 2075 7365 2066 6974 2061 6e64 2070  st use fit and p
-0002b140: 7265 6469 6374 2077 6865 6e20 7573 696e  redict when usin
-0002b150: 6720 6120 7069 7065 6c69 6e65 2077 6974  g a pipeline wit
-0002b160: 6820 6120 6d6f 6465 6c2e 2729 0a20 2020  h a model.').   
-0002b170: 2020 2020 2020 2020 2072 6574 7572 6e20           return 
-0002b180: 582c 2079 0a20 2020 2020 2020 2065 6c69  X, y.        eli
-0002b190: 6620 6e6f 7420 7365 6c66 2e66 6974 7465  f not self.fitte
-0002b1a0: 643a 0a20 2020 2020 2020 2020 2020 2070  d:.            p
-0002b1b0: 7269 6e74 2827 4c61 7a79 5472 616e 7366  rint('LazyTransf
-0002b1c0: 6f72 6d65 7220 6861 7320 6e6f 7420 6265  ormer has not be
-0002b1d0: 656e 2066 6974 2079 6574 2e20 4669 7420  en fit yet. Fit 
-0002b1e0: 6974 2066 6972 7374 2061 6e64 2074 7279  it first and try
-0002b1f0: 2061 6761 696e 2e27 290a 2020 2020 2020   again.').      
-0002b200: 2020 2020 2020 7265 7475 726e 2058 2c20        return X, 
-0002b210: 790a 2020 2020 2020 2020 656c 6966 2079  y.        elif y
-0002b220: 2069 7320 6e6f 7420 4e6f 6e65 2061 6e64   is not None and
-0002b230: 2073 656c 662e 6669 7474 6564 2061 6e64   self.fitted and
-0002b240: 2073 656c 662e 6d6f 6465 6c5f 696e 7075   self.model_inpu
-0002b250: 7420 6973 204e 6f6e 653a 0a20 2020 2020  t is None:.     
-0002b260: 2020 2020 2020 2069 6620 7365 6c66 2e74         if self.t
-0002b270: 7261 6e73 666f 726d 5f74 6172 6765 743a  ransform_target:
-0002b280: 0a20 2020 2020 2020 2020 2020 2020 2020  .               
-0002b290: 2069 6620 7920 6973 206e 6f74 204e 6f6e   if y is not Non
-0002b2a0: 653a 0a20 2020 2020 2020 2020 2020 2020  e:.             
-0002b2b0: 2020 2020 2020 2073 656c 662e 795f 696e         self.y_in
-0002b2c0: 6465 7820 3d20 792e 696e 6465 780a 2020  dex = y.index.  
-0002b2d0: 2020 2020 2020 2020 2020 2020 2020 795f                y_
-0002b2e0: 656e 6320 3d20 7365 6c66 2e79 666f 726d  enc = self.yform
-0002b2f0: 6572 2e74 7261 6e73 666f 726d 2879 290a  er.transform(y).
-0002b300: 2020 2020 2020 2020 2020 2020 2020 2020                  
-0002b310: 6966 2079 2069 7320 6e6f 7420 4e6f 6e65  if y is not None
-0002b320: 3a0a 2020 2020 2020 2020 2020 2020 2020  :.              
-0002b330: 2020 2020 2020 795f 656e 632e 696e 6465        y_enc.inde
-0002b340: 7820 3d20 7365 6c66 2e79 5f69 6e64 6578  x = self.y_index
-0002b350: 0a20 2020 2020 2020 2020 2020 2065 6c73  .            els
-0002b360: 653a 0a20 2020 2020 2020 2020 2020 2020  e:.             
-0002b370: 2020 2079 5f65 6e63 203d 2079 0a20 2020     y_enc = y.   
-0002b380: 2020 2020 2020 2020 2058 5f65 6e63 203d           X_enc =
-0002b390: 2073 656c 662e 7866 6f72 6d65 722e 7472   self.xformer.tr
-0002b3a0: 616e 7366 6f72 6d28 5829 0a20 2020 2020  ansform(X).     
-0002b3b0: 2020 2020 2020 2058 5f65 6e63 2e69 6e64         X_enc.ind
-0002b3c0: 6578 203d 2073 656c 662e 585f 696e 6465  ex = self.X_inde
-0002b3d0: 780a 2020 2020 2020 2020 2020 2020 2323  x.            ##
-0002b3e0: 2323 204e 6f77 2063 6865 636b 2069 6620  ## Now check if 
-0002b3f0: 7468 6520 696d 6261 6c61 6e63 6564 5f66  the imbalanced_f
-0002b400: 6c61 6720 6973 2054 7275 652c 2074 6865  lag is True, the
-0002b410: 6e20 6170 706c 7920 534d 4f54 4520 7573  n apply SMOTE us
-0002b420: 696e 6720 626f 7264 6572 6c69 6e65 3220  ing borderline2 
-0002b430: 616c 676f 7269 7468 6d20 7768 6963 6820  algorithm which 
-0002b440: 776f 726b 7320 6265 7474 6572 0a20 2020  works better.   
-0002b450: 2020 2020 2020 2020 2069 6620 7365 6c66           if self
-0002b460: 2e69 6d62 616c 616e 6365 645f 6669 7273  .imbalanced_firs
-0002b470: 745f 646f 6e65 2061 6e64 2073 656c 662e  t_done and self.
-0002b480: 696d 6261 6c61 6e63 6564 3a0a 2020 2020  imbalanced:.    
-0002b490: 2020 2020 2020 2020 2020 2020 7061 7373              pass
-0002b4a0: 0a20 2020 2020 2020 2020 2020 2065 6c69  .            eli
-0002b4b0: 6620 6e6f 7420 7365 6c66 2e69 6d62 616c  f not self.imbal
-0002b4c0: 616e 6365 645f 6669 7273 745f 646f 6e65  anced_first_done
-0002b4d0: 2061 6e64 2073 656c 662e 696d 6261 6c61   and self.imbala
-0002b4e0: 6e63 6564 3a0a 2020 2020 2020 2020 2020  nced:.          
-0002b4f0: 2020 2020 2020 736d 203d 2073 656c 662e        sm = self.
-0002b500: 736d 6f74 6578 0a20 2020 2020 2020 2020  smotex.         
-0002b510: 2020 2020 2020 2058 5f65 6e63 2c20 795f         X_enc, y_
-0002b520: 656e 6320 3d20 736d 2e66 6974 5f72 6573  enc = sm.fit_res
-0002b530: 616d 706c 6528 585f 656e 632c 2079 5f65  ample(X_enc, y_e
-0002b540: 6e63 290a 2020 2020 2020 2020 2020 2020  nc).            
-0002b550: 2020 2020 7365 6c66 2e69 6d62 616c 616e      self.imbalan
-0002b560: 6365 645f 6669 7273 745f 646f 6e65 203d  ced_first_done =
-0002b570: 2054 7275 650a 2020 2020 2020 2020 2020   True.          
-0002b580: 2020 2020 2020 7365 6c66 2e73 6d6f 7465        self.smote
-0002b590: 7820 3d20 736d 0a20 2020 2020 2020 2020  x = sm.         
-0002b5a0: 2020 2020 2020 2069 6620 7365 6c66 2e76         if self.v
-0002b5b0: 6572 626f 7365 3a0a 2020 2020 2020 2020  erbose:.        
-0002b5c0: 2020 2020 2020 2020 2020 2020 7072 696e              prin
-0002b5d0: 7428 2720 2020 2053 4d4f 5445 2074 7261  t('    SMOTE tra
-0002b5e0: 6e73 666f 726d 6564 2064 6174 6120 696e  nsformed data in
-0002b5f0: 2070 6970 656c 696e 652e 2044 6f6e 7420   pipeline. Dont 
-0002b600: 666f 7267 6574 2074 6f20 7573 6520 7472  forget to use tr
-0002b610: 616e 7366 6f72 6d65 6420 5820 616e 6420  ansformed X and 
-0002b620: 7920 6672 6f6d 206f 7574 7075 742e 2729  y from output.')
-0002b630: 0a20 2020 2020 2020 2020 2020 2064 6966  .            dif
-0002b640: 6674 696d 6520 3d20 6d61 7828 312c 2069  ftime = max(1, i
-0002b650: 6e74 2874 696d 652e 7469 6d65 2829 2d73  nt(time.time()-s
-0002b660: 7461 7274 5f74 696d 6529 290a 2020 2020  tart_time)).    
-0002b670: 2020 2020 2020 2020 7072 696e 7428 2720          print(' 
-0002b680: 2020 2054 696d 6520 7461 6b65 6e20 746f     Time taken to
-0002b690: 2074 7261 6e73 666f 726d 2064 6174 6173   transform datas
-0002b6a0: 6574 203d 2025 7320 7365 636f 6e64 2873  et = %s second(s
-0002b6b0: 2927 2025 6469 6666 7469 6d65 290a 2020  )' %difftime).  
-0002b6c0: 2020 2020 2020 2020 2020 7072 696e 7428            print(
-0002b6d0: 2720 2020 2053 6861 7065 206f 6620 7472  '    Shape of tr
-0002b6e0: 616e 7366 6f72 6d65 6420 6461 7461 7365  ansformed datase
-0002b6f0: 743a 2025 7327 2025 2858 5f65 6e63 2e73  t: %s' %(X_enc.s
-0002b700: 6861 7065 2c29 290a 2020 2020 2020 2020  hape,)).        
-0002b710: 2020 2020 7265 7475 726e 2058 5f65 6e63      return X_enc
-0002b720: 2c20 795f 656e 630a 2020 2020 2020 2020  , y_enc.        
-0002b730: 656c 7365 3a0a 2020 2020 2020 2020 2020  else:.          
-0002b740: 2020 7072 696e 7428 274c 617a 7954 7261    print('LazyTra
-0002b750: 6e73 666f 726d 6572 2068 6173 206e 6f74  nsformer has not
-0002b760: 2062 6565 6e20 6669 7474 6564 2079 6574   been fitted yet
-0002b770: 2e20 5265 7475 726e 696e 672e 2e2e 2729  . Returning...')
-0002b780: 0a20 2020 2020 2020 2020 2020 2072 6574  .            ret
-0002b790: 7572 6e20 582c 2079 0a0a 2020 2020 6465  urn X, y..    de
-0002b7a0: 6620 6669 745f 7472 616e 7366 6f72 6d28  f fit_transform(
-0002b7b0: 7365 6c66 2c20 582c 2079 3d4e 6f6e 6529  self, X, y=None)
-0002b7c0: 3a0a 2020 2020 2020 2020 5820 3d20 636f  :.        X = co
-0002b7d0: 7079 2e64 6565 7063 6f70 7928 5829 0a20  py.deepcopy(X). 
-0002b7e0: 2020 2020 2020 2079 203d 2063 6f70 792e         y = copy.
-0002b7f0: 6465 6570 636f 7079 2879 290a 2020 2020  deepcopy(y).    
-0002b800: 2020 2020 7365 6c66 2e58 5f69 6e64 6578      self.X_index
-0002b810: 203d 2058 2e69 6e64 6578 0a20 2020 2020   = X.index.     
-0002b820: 2020 2069 6620 7920 6973 206e 6f74 204e     if y is not N
-0002b830: 6f6e 653a 0a20 2020 2020 2020 2020 2020  one:.           
-0002b840: 2073 656c 662e 795f 696e 6465 7820 3d20   self.y_index = 
-0002b850: 792e 696e 6465 780a 2020 2020 2020 2020  y.index.        
-0002b860: 7374 6172 745f 7469 6d65 203d 2074 696d  start_time = tim
-0002b870: 652e 7469 6d65 2829 0a20 2020 2020 2020  e.time().       
-0002b880: 2073 656c 662e 6669 7428 582c 7929 0a20   self.fit(X,y). 
-0002b890: 2020 2020 2020 2058 5f74 7261 6e73 203d         X_trans =
-0002b8a0: 2020 7365 6c66 2e78 666f 726d 6572 2e74    self.xformer.t
-0002b8b0: 7261 6e73 666f 726d 2858 290a 2020 2020  ransform(X).    
-0002b8c0: 2020 2020 585f 7472 616e 732e 696e 6465      X_trans.inde
-0002b8d0: 7820 3d20 7365 6c66 2e58 5f69 6e64 6578  x = self.X_index
-0002b8e0: 0a20 2020 2020 2020 2023 2323 2048 6572  .        ### Her
-0002b8f0: 6520 796f 7520 6361 6e20 7374 7261 6967  e you can straig
-0002b900: 6874 2061 7761 7920 6669 7420 616e 6420  ht away fit and 
-0002b910: 7472 616e 7366 6f72 6d20 7920 2323 230a  transform y ###.
-0002b920: 2020 2020 2020 2020 6966 2073 656c 662e          if self.
-0002b930: 7472 616e 7366 6f72 6d5f 7461 7267 6574  transform_target
-0002b940: 3a0a 2020 2020 2020 2020 2020 2020 795f  :.            y_
-0002b950: 7472 616e 7320 3d20 7365 6c66 2e79 666f  trans = self.yfo
-0002b960: 726d 6572 2e66 6974 5f74 7261 6e73 666f  rmer.fit_transfo
-0002b970: 726d 2879 290a 2020 2020 2020 2020 656c  rm(y).        el
-0002b980: 7365 3a0a 2020 2020 2020 2020 2020 2020  se:.            
-0002b990: 795f 7472 616e 7320 3d20 790a 2020 2020  y_trans = y.    
-0002b9a0: 2020 2020 2323 2323 204e 6f77 2077 6520      #### Now we 
-0002b9b0: 6e65 6564 2074 6f20 6368 6563 6b20 6966  need to check if
-0002b9c0: 2069 6d62 616c 616e 6365 6420 666c 6167   imbalanced flag
-0002b9d0: 2069 7320 7365 7420 2323 230a 2020 2020   is set ###.    
-0002b9e0: 2020 2020 6966 2073 656c 662e 696d 6261      if self.imba
-0002b9f0: 6c61 6e63 6564 5f66 6972 7374 5f64 6f6e  lanced_first_don
-0002ba00: 6520 616e 6420 7365 6c66 2e69 6d62 616c  e and self.imbal
-0002ba10: 616e 6365 643a 0a20 2020 2020 2020 2020  anced:.         
-0002ba20: 2020 2070 6173 730a 2020 2020 2020 2020     pass.        
-0002ba30: 656c 6966 206e 6f74 2073 656c 662e 696d  elif not self.im
-0002ba40: 6261 6c61 6e63 6564 5f66 6972 7374 5f64  balanced_first_d
-0002ba50: 6f6e 6520 616e 6420 7365 6c66 2e69 6d62  one and self.imb
-0002ba60: 616c 616e 6365 643a 0a20 2020 2020 2020  alanced:.       
-0002ba70: 2020 2020 2070 7269 6e74 2827 2323 2320       print('### 
-0002ba80: 416c 6572 7421 2044 6f20 6e6f 7420 7573  Alert! Do not us
-0002ba90: 6520 534d 4f54 4520 6966 2074 6869 7320  e SMOTE if this 
-0002baa0: 6973 206e 6f74 2061 6e20 696d 6261 6c61  is not an imbala
-0002bab0: 6e63 6564 2063 6c61 7373 6966 6963 6174  nced classificat
-0002bac0: 696f 6e20 7072 6f62 6c65 6d20 2323 2323  ion problem ####
-0002bad0: 2323 2327 290a 2020 2020 2020 2020 2020  ###').          
-0002bae0: 2020 736d 203d 2073 656c 662e 736d 6f74    sm = self.smot
-0002baf0: 6578 0a20 2020 2020 2020 2020 2020 2069  ex.            i
-0002bb00: 6620 7365 6c66 2e76 6572 626f 7365 3a0a  f self.verbose:.
-0002bb10: 2020 2020 2020 2020 2020 2020 2020 2020                  
-0002bb20: 7072 696e 7428 2749 6d62 616c 616e 6365  print('Imbalance
-0002bb30: 6420 666c 6167 2073 6574 2e20 5573 696e  d flag set. Usin
-0002bb40: 6720 534d 4f54 4520 746f 2074 7261 6e73  g SMOTE to trans
-0002bb50: 666f 726d 2058 2061 6e64 2079 2e2e 2e27  form X and y...'
-0002bb60: 290a 2020 2020 2020 2020 2020 2020 585f  ).            X_
-0002bb70: 7472 616e 732c 2079 5f74 7261 6e73 203d  trans, y_trans =
-0002bb80: 2073 6d2e 6669 745f 7265 7361 6d70 6c65   sm.fit_resample
-0002bb90: 2858 5f74 7261 6e73 2c20 795f 7472 616e  (X_trans, y_tran
-0002bba0: 7329 0a20 2020 2020 2020 2020 2020 2073  s).            s
-0002bbb0: 656c 662e 696d 6261 6c61 6e63 6564 5f66  elf.imbalanced_f
-0002bbc0: 6972 7374 5f64 6f6e 6520 3d20 5472 7565  irst_done = True
-0002bbd0: 0a20 2020 2020 2020 2020 2020 2073 656c  .            sel
-0002bbe0: 662e 736d 6f74 6578 203d 2073 6d0a 2020  f.smotex = sm.  
-0002bbf0: 2020 2020 2020 2020 2020 6966 2073 656c            if sel
-0002bc00: 662e 7665 7262 6f73 653a 0a20 2020 2020  f.verbose:.     
-0002bc10: 2020 2020 2020 2020 2020 2070 7269 6e74             print
-0002bc20: 2827 2020 2020 534d 4f54 4520 7472 616e  ('    SMOTE tran
-0002bc30: 7366 6f72 6d65 6420 6461 7461 2069 6e20  sformed data in 
-0002bc40: 7069 7065 6c69 6e65 2e20 446f 6e74 2066  pipeline. Dont f
-0002bc50: 6f72 6765 7420 746f 2075 7365 2074 7261  orget to use tra
-0002bc60: 6e73 666f 726d 6564 2058 2061 6e64 2079  nsformed X and y
-0002bc70: 2066 726f 6d20 6f75 7470 7574 2e27 290a   from output.').
-0002bc80: 2020 2020 2020 2020 6469 6666 7469 6d65          difftime
-0002bc90: 203d 206d 6178 2831 2c20 696e 7428 7469   = max(1, int(ti
-0002bca0: 6d65 2e74 696d 6528 292d 7374 6172 745f  me.time()-start_
-0002bcb0: 7469 6d65 2929 0a20 2020 2020 2020 2070  time)).        p
-0002bcc0: 7269 6e74 2827 2020 2020 5469 6d65 2074  rint('    Time t
-0002bcd0: 616b 656e 2074 6f20 7472 616e 7366 6f72  aken to transfor
-0002bce0: 6d20 6461 7461 7365 7420 3d20 2573 2073  m dataset = %s s
-0002bcf0: 6563 6f6e 6428 7329 2720 2564 6966 6674  econd(s)' %difft
-0002bd00: 696d 6529 0a20 2020 2020 2020 2070 7269  ime).        pri
-0002bd10: 6e74 2827 2020 2020 5368 6170 6520 6f66  nt('    Shape of
-0002bd20: 2074 7261 6e73 666f 726d 6564 2064 6174   transformed dat
-0002bd30: 6173 6574 3a20 2573 2720 2528 585f 7472  aset: %s' %(X_tr
-0002bd40: 616e 732e 7368 6170 652c 2929 0a20 2020  ans.shape,)).   
-0002bd50: 2020 2020 2072 6574 7572 6e20 585f 7472       return X_tr
-0002bd60: 616e 732c 2079 5f74 7261 6e73 0a0a 2020  ans, y_trans..  
-0002bd70: 2020 6465 6620 6669 745f 7072 6564 6963    def fit_predic
-0002bd80: 7428 7365 6c66 2c20 582c 2079 3d4e 6f6e  t(self, X, y=Non
-0002bd90: 6529 3a0a 2020 2020 2020 2020 7472 616e  e):.        tran
-0002bda0: 7366 6f72 6d65 725f 203d 2073 656c 662e  sformer_ = self.
-0002bdb0: 6669 7428 582c 7929 0a20 2020 2020 2020  fit(X,y).       
-0002bdc0: 2079 5f74 7261 6e73 203d 2020 7472 616e   y_trans =  tran
-0002bdd0: 7366 6f72 6d65 725f 2e70 7265 6469 6374  sformer_.predict
-0002bde0: 2858 290a 2020 2020 2020 2020 7265 7475  (X).        retu
-0002bdf0: 726e 2058 2c20 795f 7472 616e 730a 0a20  rn X, y_trans.. 
-0002be00: 2020 2064 6566 2070 7269 6e74 5f70 6970     def print_pip
-0002be10: 656c 696e 6528 7365 6c66 293a 0a20 2020  eline(self):.   
-0002be20: 2020 2020 2066 726f 6d20 736b 6c65 6172       from sklear
-0002be30: 6e20 696d 706f 7274 2073 6574 5f63 6f6e  n import set_con
-0002be40: 6669 670a 2020 2020 2020 2020 7365 745f  fig.        set_
-0002be50: 636f 6e66 6967 2864 6973 706c 6179 3d22  config(display="
-0002be60: 7465 7874 2229 0a20 2020 2020 2020 2072  text").        r
-0002be70: 6574 7572 6e20 7365 6c66 2e78 666f 726d  eturn self.xform
-0002be80: 6572 0a0a 2020 2020 6465 6620 706c 6f74  er..    def plot
-0002be90: 5f70 6970 656c 696e 6528 7365 6c66 293a  _pipeline(self):
-0002bea0: 0a20 2020 2020 2020 2066 726f 6d20 736b  .        from sk
-0002beb0: 6c65 6172 6e20 696d 706f 7274 2073 6574  learn import set
-0002bec0: 5f63 6f6e 6669 670a 2020 2020 2020 2020  _config.        
-0002bed0: 7365 745f 636f 6e66 6967 2864 6973 706c  set_config(displ
-0002bee0: 6179 3d22 6469 6167 7261 6d22 290a 2020  ay="diagram").  
-0002bef0: 2020 2020 2020 7265 7475 726e 2073 656c        return sel
-0002bf00: 662e 7866 6f72 6d65 720a 0a20 2020 2064  f.xformer..    d
-0002bf10: 6566 2070 6c6f 745f 696d 706f 7274 616e  ef plot_importan
-0002bf20: 6365 2873 656c 662c 206d 6178 5f66 6561  ce(self, max_fea
-0002bf30: 7475 7265 733d 3130 293a 0a20 2020 2020  tures=10):.     
-0002bf40: 2020 2069 6d70 6f72 7420 6c69 6768 7467     import lightg
-0002bf50: 626d 2061 7320 6c67 626d 0a20 2020 2020  bm as lgbm.     
-0002bf60: 2020 2066 726f 6d20 7867 626f 6f73 7420     from xgboost 
-0002bf70: 696d 706f 7274 2070 6c6f 745f 696d 706f  import plot_impo
-0002bf80: 7274 616e 6365 0a20 2020 2020 2020 206d  rtance.        m
-0002bf90: 6f64 656c 5f6e 616d 6520 3d20 7374 7228  odel_name = str(
-0002bfa0: 7365 6c66 2e6d 6f64 656c 292e 7370 6c69  self.model).spli
-0002bfb0: 7428 2228 2229 5b2d 325d 2e73 706c 6974  t("(")[-2].split
-0002bfc0: 2822 2c22 295b 2d31 5d0a 2020 2020 2020  (",")[-1].      
-0002bfd0: 2020 6966 2020 6d6f 6465 6c5f 6e61 6d65    if  model_name
-0002bfe0: 203d 3d20 2720 4c47 424d 436c 6173 7369   == ' LGBMClassi
-0002bff0: 6669 6572 2720 6f72 206d 6f64 656c 5f6e  fier' or model_n
-0002c000: 616d 6520 3d3d 2027 204c 4742 4d52 6567  ame == ' LGBMReg
-0002c010: 7265 7373 6f72 273a 0a20 2020 2020 2020  ressor':.       
-0002c020: 2020 2020 206c 6762 6d2e 706c 6f74 5f69       lgbm.plot_i
-0002c030: 6d70 6f72 7461 6e63 6528 7365 6c66 2e6d  mportance(self.m
-0002c040: 6f64 656c 2e6e 616d 6564 5f73 7465 7073  odel.named_steps
-0002c050: 5b27 6d6f 6465 6c27 5d2c 2069 6d70 6f72  ['model'], impor
-0002c060: 7461 6e63 655f 7479 7065 3d27 6761 696e  tance_type='gain
-0002c070: 272c 206d 6178 5f6e 756d 5f66 6561 7475  ', max_num_featu
-0002c080: 7265 733d 6d61 785f 6665 6174 7572 6573  res=max_features
-0002c090: 290a 2020 2020 2020 2020 656c 6966 206d  ).        elif m
-0002c0a0: 6f64 656c 5f6e 616d 6520 3d3d 2027 2058  odel_name == ' X
-0002c0b0: 4742 436c 6173 7369 6669 6572 2720 6f72  GBClassifier' or
-0002c0c0: 206d 6f64 656c 5f6e 616d 6520 3d3d 2027   model_name == '
-0002c0d0: 2058 4742 5265 6772 6573 736f 7227 3a0a   XGBRegressor':.
-0002c0e0: 2020 2020 2020 2020 2020 2020 706c 6f74              plot
-0002c0f0: 5f69 6d70 6f72 7461 6e63 6528 7365 6c66  _importance(self
-0002c100: 2e6d 6f64 656c 2e6e 616d 6564 5f73 7465  .model.named_ste
-0002c110: 7073 5b27 6d6f 6465 6c27 5d2c 2069 6d70  ps['model'], imp
-0002c120: 6f72 7461 6e63 655f 7479 7065 3d27 6761  ortance_type='ga
-0002c130: 696e 272c 206d 6178 5f6e 756d 5f66 6561  in', max_num_fea
-0002c140: 7475 7265 733d 6d61 785f 6665 6174 7572  tures=max_featur
-0002c150: 6573 290a 2020 2020 2020 2020 656c 6966  es).        elif
-0002c160: 206d 6f64 656c 5f6e 616d 6520 3d3d 2027   model_name == '
-0002c170: 204c 6f67 6973 7469 6352 6567 7265 7373   LogisticRegress
-0002c180: 696f 6e27 3a0a 2020 2020 2020 2020 2020  ion':.          
-0002c190: 2020 6672 6f6d 2073 6b6c 6561 726e 2e6c    from sklearn.l
-0002c1a0: 696e 6561 725f 6d6f 6465 6c20 696d 706f  inear_model impo
-0002c1b0: 7274 204c 6f67 6973 7469 6352 6567 7265  rt LogisticRegre
-0002c1c0: 7373 696f 6e0a 2020 2020 2020 2020 2020  ssion.          
-0002c1d0: 2020 696d 706f 7274 206d 6174 680a 2020    import math.  
-0002c1e0: 2020 2020 2020 2020 2020 6665 6174 7572            featur
-0002c1f0: 655f 6e61 6d65 7320 3d20 7365 6c66 2e6d  e_names = self.m
-0002c200: 6f64 656c 2e6e 616d 6564 5f73 7465 7073  odel.named_steps
-0002c210: 5b27 6d6f 6465 6c27 5d2e 6665 6174 7572  ['model'].featur
-0002c220: 655f 6e61 6d65 735f 696e 5f0a 2020 2020  e_names_in_.    
-0002c230: 2020 2020 2020 2020 6d6f 6465 6c20 3d20          model = 
-0002c240: 7365 6c66 2e6d 6f64 656c 2e6e 616d 6564  self.model.named
-0002c250: 5f73 7465 7073 5b27 6d6f 6465 6c27 5d0a  _steps['model'].
-0002c260: 2020 2020 2020 2020 2020 2020 7730 203d              w0 =
-0002c270: 206d 6f64 656c 2e69 6e74 6572 6365 7074   model.intercept
-0002c280: 5f5b 305d 0a20 2020 2020 2020 2020 2020  _[0].           
-0002c290: 2077 203d 206d 6f64 656c 2e63 6f65 665f   w = model.coef_
-0002c2a0: 5b30 5d0a 2020 2020 2020 2020 2020 2020  [0].            
-0002c2b0: 6665 6174 7572 655f 696d 706f 7274 616e  feature_importan
-0002c2c0: 6365 203d 2070 642e 4461 7461 4672 616d  ce = pd.DataFram
-0002c2d0: 6528 6665 6174 7572 655f 6e61 6d65 732c  e(feature_names,
-0002c2e0: 2063 6f6c 756d 6e73 203d 205b 2266 6561   columns = ["fea
-0002c2f0: 7475 7265 225d 290a 2020 2020 2020 2020  ture"]).        
-0002c300: 2020 2020 6665 6174 7572 655f 696d 706f      feature_impo
-0002c310: 7274 616e 6365 5b22 696d 706f 7274 616e  rtance["importan
-0002c320: 6365 225d 203d 2070 6f77 286d 6174 682e  ce"] = pow(math.
-0002c330: 652c 2077 290a 2020 2020 2020 2020 2020  e, w).          
-0002c340: 2020 6665 6174 7572 655f 696d 706f 7274    feature_import
-0002c350: 616e 6365 203d 2066 6561 7475 7265 5f69  ance = feature_i
-0002c360: 6d70 6f72 7461 6e63 652e 736f 7274 5f76  mportance.sort_v
-0002c370: 616c 7565 7328 6279 203d 205b 2269 6d70  alues(by = ["imp
-0002c380: 6f72 7461 6e63 6522 5d2c 2061 7363 656e  ortance"], ascen
-0002c390: 6469 6e67 3d46 616c 7365 295b 3a6d 6178  ding=False)[:max
-0002c3a0: 5f66 6561 7475 7265 735d 0a20 2020 2020  _features].     
-0002c3b0: 2020 2020 2020 2066 6561 7475 7265 5f69         feature_i
-0002c3c0: 6d70 6f72 7461 6e63 652e 706c 6f74 2e62  mportance.plot.b
-0002c3d0: 6172 6828 783d 2766 6561 7475 7265 272c  arh(x='feature',
-0002c3e0: 2079 3d27 696d 706f 7274 616e 6365 2729   y='importance')
-0002c3f0: 0a20 2020 2020 2020 2065 6c73 653a 0a20  .        else:. 
-0002c400: 2020 2020 2020 2020 2020 2023 2323 2054             ### T
-0002c410: 6865 7365 2061 7265 2066 6f72 2052 616e  hese are for Ran
-0002c420: 646f 6d46 6f72 6573 7443 6c61 7373 6966  domForestClassif
-0002c430: 6965 7220 6b69 6e64 206f 6620 7363 696b  ier kind of scik
-0002c440: 6974 2d6c 6561 726e 206d 6f64 656c 7320  it-learn models 
-0002c450: 2323 230a 2020 2020 2020 2020 2020 2020  ###.            
-0002c460: 7472 793a 0a20 2020 2020 2020 2020 2020  try:.           
-0002c470: 2020 2020 2069 6d70 6f72 7461 6e63 6573       importances
-0002c480: 203d 206d 6f64 656c 2e66 6561 7475 7265   = model.feature
-0002c490: 5f69 6d70 6f72 7461 6e63 6573 5f0a 2020  _importances_.  
-0002c4a0: 2020 2020 2020 2020 2020 2020 2020 6665                fe
-0002c4b0: 6174 7572 655f 6e61 6d65 7320 3d20 7365  ature_names = se
-0002c4c0: 6c66 2e6d 6f64 656c 2e6e 616d 6564 5f73  lf.model.named_s
-0002c4d0: 7465 7073 5b27 6d6f 6465 6c27 5d2e 6665  teps['model'].fe
-0002c4e0: 6174 7572 655f 6e61 6d65 735f 696e 5f0a  ature_names_in_.
-0002c4f0: 2020 2020 2020 2020 2020 2020 2020 2020                  
-0002c500: 666f 7265 7374 5f69 6d70 6f72 7461 6e63  forest_importanc
-0002c510: 6573 203d 2070 642e 5365 7269 6573 2869  es = pd.Series(i
-0002c520: 6d70 6f72 7461 6e63 6573 2c20 696e 6465  mportances, inde
-0002c530: 783d 6665 6174 7572 655f 6e61 6d65 7329  x=feature_names)
-0002c540: 0a20 2020 2020 2020 2020 2020 2020 2020  .               
-0002c550: 2066 6f72 6573 745f 696d 706f 7274 616e   forest_importan
-0002c560: 6365 732e 736f 7274 5f76 616c 7565 7328  ces.sort_values(
-0002c570: 6173 6365 6e64 696e 673d 4661 6c73 6529  ascending=False)
-0002c580: 5b3a 6d61 785f 6665 6174 7572 6573 5d2e  [:max_features].
-0002c590: 706c 6f74 286b 696e 643d 2762 6172 6827  plot(kind='barh'
-0002c5a0: 290a 2020 2020 2020 2020 2020 2020 6578  ).            ex
-0002c5b0: 6365 7074 3a0a 2020 2020 2020 2020 2020  cept:.          
-0002c5c0: 2020 2020 2020 7072 696e 7428 2743 6f75        print('Cou
-0002c5d0: 6c64 206e 6f74 2070 6c6f 7420 6665 6174  ld not plot feat
-0002c5e0: 7572 6520 696d 706f 7274 616e 6365 732e  ure importances.
-0002c5f0: 2050 6c65 6173 6520 6368 6563 6b20 796f   Please check yo
-0002c600: 7572 206d 6f64 656c 2061 6e64 2074 7279  ur model and try
-0002c610: 2061 6761 696e 2e27 290a 0a0a 2020 2020   again.')...    
-0002c620: 6465 6620 6c69 6768 7467 626d 5f67 7269  def lightgbm_gri
-0002c630: 645f 7365 6172 6368 2873 656c 662c 2058  d_search(self, X
-0002c640: 5f74 7261 696e 2c20 795f 7472 6169 6e2c  _train, y_train,
-0002c650: 206d 6f64 656c 7479 7065 2c0a 2020 2020   modeltype,.    
-0002c660: 2020 2020 2020 2020 2020 2020 2020 2020                  
-0002c670: 2020 2020 2020 2020 2070 6172 616d 733d           params=
-0002c680: 7b7d 2c20 6772 6964 5f73 6561 7263 683d  {}, grid_search=
-0002c690: 4661 6c73 652c 206d 756c 7469 5f6c 6162  False, multi_lab
-0002c6a0: 656c 3d46 616c 7365 2c0a 2020 2020 2020  el=False,.      
-0002c6b0: 2020 2020 2020 2020 2020 2020 2020 2020                  
-0002c6c0: 2020 2020 2020 2029 3a0a 2020 2020 2020         ):.      
-0002c6d0: 2020 2222 220a 2020 2020 2020 2020 5065    """.        Pe
-0002c6e0: 7266 6f72 6d20 4772 6964 5365 6172 6368  rform GridSearch
-0002c6f0: 4356 206f 7220 5261 6e64 6f6d 697a 6564  CV or Randomized
-0002c700: 5365 6172 6368 4356 2075 7369 6e67 204c  SearchCV using L
-0002c710: 6967 6874 4742 4d20 6261 7365 6420 4c61  ightGBM based La
-0002c720: 7a79 5472 616e 7366 6f72 6d65 7220 7069  zyTransformer pi
-0002c730: 7065 6c69 6e65 2e0a 2020 2020 2020 2020  peline..        
-0002c740: 2d2d 2052 656d 656d 6265 7220 7468 6174  -- Remember that
-0002c750: 2079 6f75 2063 616e 206f 6e6c 7920 7573   you can only us
-0002c760: 6520 4c69 6768 7447 424d 2073 6369 6b69  e LightGBM sciki
-0002c770: 742d 6c65 6172 6e20 7379 6e74 6178 2062  t-learn syntax b
-0002c780: 6173 6564 206d 6f64 656c 7320 6865 7265  ased models here
-0002c790: 2e20 0a20 2020 2020 2020 204f 7074 696f  . .        Optio
-0002c7a0: 6e61 6c6c 7920 796f 7520 6361 6e20 7072  nally you can pr
-0002c7b0: 6f76 6964 6520 7061 7261 6d65 7465 7273  ovide parameters
-0002c7c0: 2074 6f20 7365 6172 6368 2028 6173 2061   to search (as a
-0002c7d0: 2064 6963 7469 6f6e 6172 7929 2069 6e20   dictionary) in 
-0002c7e0: 7468 6520 666f 6c6c 6f77 696e 6720 666f  the following fo
-0002c7f0: 726d 6174 3a0a 2020 2020 2020 2020 2020  rmat:.          
-0002c800: 2020 2020 2020 7061 7261 6d73 203d 207b        params = {
-0002c810: 0a20 2020 2020 2020 2020 2020 2020 2020  .               
-0002c820: 2027 6d6f 6465 6c5f 5f6c 6561 726e 696e   'model__learnin
-0002c830: 675f 7261 7465 273a 205b 302e 3030 312c  g_rate': [0.001,
-0002c840: 2030 2e30 312c 2030 2e31 2c20 302e 332c   0.01, 0.1, 0.3,
-0002c850: 2030 2e35 5d2c 0a20 2020 2020 2020 2020   0.5],.         
-0002c860: 2020 2020 2020 2027 6d6f 6465 6c5f 5f6e         'model__n
-0002c870: 756d 5f6c 6561 7665 7327 3a20 5b32 302c  um_leaves': [20,
-0002c880: 3330 2c34 302c 3530 5d2c 0a20 2020 2020  30,40,50],.     
-0002c890: 2020 2020 2020 2020 2020 2020 2020 2020                  
-0002c8a0: 2020 207d 0a20 2020 2020 2020 2020 2020     }.           
-0002c8b0: 2059 6f75 2063 616e 2075 7365 2061 6e79   You can use any
-0002c8c0: 204c 6967 6874 4742 4d20 7061 7261 6d65   LightGBM parame
-0002c8d0: 7465 7220 796f 7520 7761 6e74 2069 6e20  ter you want in 
-0002c8e0: 6164 6469 7469 6f6e 2074 6f20 7468 6520  addition to the 
-0002c8f0: 6162 6f76 652e 2050 6c65 6173 6520 6368  above. Please ch
-0002c900: 6563 6b20 7379 6e74 6178 2e0a 2020 2020  eck syntax..    
-0002c910: 2020 2020 596f 7520 6361 6e20 616c 736f      You can also
-0002c920: 2070 726f 7669 6465 206d 756c 7469 5f6c   provide multi_l
-0002c930: 6162 656c 2061 7320 5472 7565 2074 6f20  abel as True to 
-0002c940: 656e 6162 6c65 204d 756c 7469 4f75 7470  enable MultiOutp
-0002c950: 7574 5265 6772 6573 736f 7220 6f72 204d  utRegressor or M
-0002c960: 756c 7469 4f75 7470 7574 436c 6173 7369  ultiOutputClassi
-0002c970: 6669 6572 0a20 2020 2020 2020 2020 2020  fier.           
-0002c980: 746f 2062 6520 7573 6564 2061 7320 6120  to be used as a 
-0002c990: 7772 6170 7065 7220 6172 6f75 6e64 2074  wrapper around t
-0002c9a0: 6865 204c 6967 6874 4742 4d20 6f62 6a65  he LightGBM obje
-0002c9b0: 6374 2e20 5468 6520 7061 7261 6d73 2077  ct. The params w
-0002c9c0: 696c 6c20 6265 2070 6173 7365 6420 746f  ill be passed to
-0002c9d0: 2074 6865 200a 2020 2020 2020 2020 2020   the .          
-0002c9e0: 206d 756c 7469 6f75 7470 7574 2065 7374   multioutput est
-0002c9f0: 696d 6174 6f72 2077 6869 6368 2077 696c  imator which wil
-0002ca00: 6c20 696e 2074 7572 6e20 7061 7373 2074  l in turn pass t
-0002ca10: 6865 6d20 6f6e 2074 6f20 7468 6520 4c47  hem on to the LG
-0002ca20: 424d 2065 7374 696d 6174 6f72 7320 6475  BM estimators du
-0002ca30: 7269 6e67 2066 6974 2e0a 0a20 2020 2020  ring fit...     
-0002ca40: 2020 2054 6869 7320 6675 6e63 7469 6f6e     This function
-0002ca50: 2072 6574 7572 6e73 2061 206e 6577 204c   returns a new L
-0002ca60: 617a 7954 7261 6e73 666f 726d 6572 2070  azyTransformer p
-0002ca70: 6970 656c 696e 6520 7468 6174 2063 6f6e  ipeline that con
-0002ca80: 7461 696e 7320 7468 6520 6265 7374 206d  tains the best m
-0002ca90: 6f64 656c 2074 7261 696e 6564 206f 6e20  odel trained on 
-0002caa0: 7468 6174 2064 6174 6173 6574 2e0a 2020  that dataset..  
-0002cab0: 2020 2020 2020 596f 7520 6361 6e20 7573        You can us
-0002cac0: 6520 7468 6973 206e 6577 2070 6970 656c  e this new pipel
-0002cad0: 696e 6520 746f 2070 7265 6469 6374 206f  ine to predict o
-0002cae0: 6e20 6578 6973 7469 6e67 206f 7220 6e65  n existing or ne
-0002caf0: 7720 6461 7461 7365 7473 2e0a 0a20 2020  w datasets...   
-0002cb00: 2020 2020 2022 2222 0a0a 2020 2020 2020       """..      
-0002cb10: 2020 7374 6172 745f 7469 6d65 203d 2074    start_time = t
-0002cb20: 696d 652e 7469 6d65 2829 0a20 2020 2020  ime.time().     
-0002cb30: 2020 2069 6620 6c65 6e28 7061 7261 6d73     if len(params
-0002cb40: 2920 3d3d 2030 3a20 0a20 2020 2020 2020  ) == 0: .       
-0002cb50: 2020 2020 2069 6620 6d6f 6465 6c74 7970       if modeltyp
-0002cb60: 6520 3d3d 2027 5265 6772 6573 7369 6f6e  e == 'Regression
-0002cb70: 273a 0a20 2020 2020 2020 2020 2020 2020  ':.             
-0002cb80: 2020 2072 616e 645f 7061 7261 6d73 203d     rand_params =
-0002cb90: 207b 0a20 2020 2020 2020 2020 2020 2020   {.             
-0002cba0: 2020 2020 2020 2027 6d6f 6465 6c5f 5f6e         'model__n
-0002cbb0: 5f65 7374 696d 6174 6f72 7327 3a20 6e70  _estimators': np
-0002cbc0: 2e6c 696e 7370 6163 6528 3530 2c31 3030  .linspace(50,100
-0002cbd0: 302c 3130 292e 6173 7479 7065 2869 6e74  0,10).astype(int
-0002cbe0: 292c 0a20 2020 2020 2020 2020 2020 2020  ),.             
-0002cbf0: 2020 2020 2020 2027 6d6f 6465 6c5f 5f6c         'model__l
-0002cc00: 6561 726e 696e 675f 7261 7465 273a 206e  earning_rate': n
-0002cc10: 702e 6c69 6e73 7061 6365 2830 2e30 3030  p.linspace(0.000
-0002cc20: 312c 312c 3130 292c 0a20 2020 2020 2020  1,1,10),.       
-0002cc30: 2020 2020 2020 2020 2020 2020 2027 6d6f               'mo
-0002cc40: 6465 6c5f 5f62 6f6f 7374 696e 675f 7479  del__boosting_ty
-0002cc50: 7065 273a 205b 2764 6172 7427 2c27 6762  pe': ['dart','gb
-0002cc60: 6474 275d 2c0a 2020 2020 2020 2020 2020  dt'],.          
-0002cc70: 2020 2020 2020 2020 2020 7d0a 2020 2020            }.    
-0002cc80: 2020 2020 2020 2020 2020 2020 6772 6964              grid
-0002cc90: 5f70 6172 616d 7320 3d20 7b0a 2020 2020  _params = {.    
-0002cca0: 2020 2020 2020 2020 2020 2020 2020 2020                  
-0002ccb0: 276d 6f64 656c 5f5f 6e5f 6573 7469 6d61  'model__n_estima
-0002ccc0: 746f 7273 273a 206e 702e 6c69 6e73 7061  tors': np.linspa
-0002ccd0: 6365 2835 302c 3130 3030 2c35 292e 6173  ce(50,1000,5).as
-0002cce0: 7479 7065 2869 6e74 292c 0a20 2020 2020  type(int),.     
-0002ccf0: 2020 2020 2020 2020 2020 2020 2020 2027                 '
-0002cd00: 6d6f 6465 6c5f 5f6c 6561 726e 696e 675f  model__learning_
-0002cd10: 7261 7465 273a 206e 702e 6c69 6e73 7061  rate': np.linspa
-0002cd20: 6365 2830 2e30 3030 312c 312c 3529 2c0a  ce(0.0001,1,5),.
-0002cd30: 2020 2020 2020 2020 2020 2020 2020 2020                  
-0002cd40: 2020 2020 276d 6f64 656c 5f5f 626f 6f73      'model__boos
-0002cd50: 7469 6e67 5f74 7970 6527 3a20 5b27 6461  ting_type': ['da
-0002cd60: 7274 272c 2767 6264 7427 5d2c 0a20 2020  rt','gbdt'],.   
-0002cd70: 2020 2020 2020 2020 2020 2020 207d 0a20               }. 
-0002cd80: 2020 2020 2020 2020 2020 2065 6c73 653a             else:
-0002cd90: 0a20 2020 2020 2020 2020 2020 2020 2020  .               
-0002cda0: 2072 616e 645f 7061 7261 6d73 203d 207b   rand_params = {
-0002cdb0: 0a20 2020 2020 2020 2020 2020 2020 2020  .               
-0002cdc0: 2020 2020 2027 6d6f 6465 6c5f 5f6e 5f65       'model__n_e
-0002cdd0: 7374 696d 6174 6f72 7327 3a20 6e70 2e6c  stimators': np.l
-0002cde0: 696e 7370 6163 6528 3530 2c31 3030 302c  inspace(50,1000,
-0002cdf0: 3130 292e 6173 7479 7065 2869 6e74 292c  10).astype(int),
-0002ce00: 0a20 2020 2020 2020 2020 2020 2020 2020  .               
-0002ce10: 2020 2020 2027 6d6f 6465 6c5f 5f63 6c61       'model__cla
-0002ce20: 7373 5f77 6569 6768 7427 3a5b 4e6f 6e65  ss_weight':[None
-0002ce30: 2c20 2762 616c 616e 6365 6427 5d2c 0a20  , 'balanced'],. 
-0002ce40: 2020 2020 2020 2020 2020 2020 2020 2020                  
-0002ce50: 2020 2027 6d6f 6465 6c5f 5f6c 6561 726e     'model__learn
-0002ce60: 696e 675f 7261 7465 273a 206e 702e 6c69  ing_rate': np.li
-0002ce70: 6e73 7061 6365 2830 2e30 3030 312c 312c  nspace(0.0001,1,
-0002ce80: 3130 292c 0a20 2020 2020 2020 2020 2020  10),.           
-0002ce90: 2020 2020 2020 2020 2027 6d6f 6465 6c5f           'model_
-0002cea0: 5f62 6f6f 7374 696e 675f 7479 7065 273a  _boosting_type':
-0002ceb0: 205b 2764 6172 7427 2c27 6762 6474 275d   ['dart','gbdt']
-0002cec0: 2c0a 2020 2020 2020 2020 2020 2020 2020  ,.              
-0002ced0: 2020 2020 2020 7d0a 2020 2020 2020 2020        }.        
-0002cee0: 2020 2020 2020 2020 6772 6964 5f70 6172          grid_par
-0002cef0: 616d 7320 3d20 7b0a 2020 2020 2020 2020  ams = {.        
-0002cf00: 2020 2020 2020 2020 2020 2020 276d 6f64              'mod
-0002cf10: 656c 5f5f 6e5f 6573 7469 6d61 746f 7273  el__n_estimators
-0002cf20: 273a 206e 702e 6c69 6e73 7061 6365 2835  ': np.linspace(5
-0002cf30: 302c 3130 3030 2c35 292e 6173 7479 7065  0,1000,5).astype
-0002cf40: 2869 6e74 292c 0a20 2020 2020 2020 2020  (int),.         
-0002cf50: 2020 2020 2020 2020 2020 2027 6d6f 6465             'mode
-0002cf60: 6c5f 5f63 6c61 7373 5f77 6569 6768 7427  l__class_weight'
-0002cf70: 3a5b 4e6f 6e65 2c20 2762 616c 616e 6365  :[None, 'balance
-0002cf80: 6427 5d2c 0a20 2020 2020 2020 2020 2020  d'],.           
-0002cf90: 2020 2020 2020 2020 2027 6d6f 6465 6c5f           'model_
-0002cfa0: 5f62 6f6f 7374 696e 675f 7479 7065 273a  _boosting_type':
-0002cfb0: 205b 2764 6172 7427 2c27 6762 6474 275d   ['dart','gbdt']
-0002cfc0: 2c0a 2020 2020 2020 2020 2020 2020 2020  ,.              
-0002cfd0: 2020 2020 2020 2020 2020 7d0a 2020 2020            }.    
-0002cfe0: 2020 2020 656c 7365 3a0a 2020 2020 2020      else:.      
-0002cff0: 2020 2020 2020 6966 2067 7269 645f 7365        if grid_se
-0002d000: 6172 6368 3a0a 2020 2020 2020 2020 2020  arch:.          
-0002d010: 2020 2020 2020 6772 6964 5f70 6172 616d        grid_param
-0002d020: 7320 3d20 636f 7079 2e64 6565 7063 6f70  s = copy.deepcop
-0002d030: 7928 7061 7261 6d73 290a 2020 2020 2020  y(params).      
-0002d040: 2020 2020 2020 656c 7365 3a0a 2020 2020        else:.    
-0002d050: 2020 2020 2020 2020 2020 2020 7261 6e64              rand
-0002d060: 5f70 6172 616d 7320 3d20 636f 7079 2e64  _params = copy.d
-0002d070: 6565 7063 6f70 7928 7061 7261 6d73 290a  eepcopy(params).
-0002d080: 2020 2020 2020 2020 2020 2020 2020 2020                  
-0002d090: 0a20 2020 2020 2020 2023 2323 2323 2323  .        #######
-0002d0a0: 2320 2020 4e6f 7720 6c65 7427 7320 7065  #   Now let's pe
-0002d0b0: 7266 6f72 6d20 7261 6e64 6f6d 697a 6564  rform randomized
-0002d0c0: 2073 6561 7263 6820 746f 2066 696e 6420   search to find 
-0002d0d0: 6265 7374 2068 7970 6572 2070 6172 616d  best hyper param
-0002d0e0: 6574 6572 7320 2323 2323 2323 0a20 2020  eters ######.   
-0002d0f0: 2020 2020 2069 6e69 745f 7061 7261 6d73       init_params
-0002d100: 203d 207b 0a20 2020 2020 2020 2020 2020   = {.           
-0002d110: 2020 207d 0a0a 2020 2020 2020 2020 6966     }..        if
-0002d120: 206d 6f64 656c 7479 7065 203d 3d20 2752   modeltype == 'R
-0002d130: 6567 7265 7373 696f 6e27 3a0a 2020 2020  egression':.    
-0002d140: 2020 2020 2020 2020 7363 6f72 696e 6720          scoring 
-0002d150: 3d20 276e 6567 5f6d 6561 6e5f 7371 7561  = 'neg_mean_squa
-0002d160: 7265 645f 6572 726f 7227 0a20 2020 2020  red_error'.     
-0002d170: 2020 2020 2020 2073 636f 7265 5f6e 616d         score_nam
-0002d180: 6520 3d20 274d 5345 270a 2020 2020 2020  e = 'MSE'.      
-0002d190: 2020 2020 2020 7365 6c66 2e6d 6f64 656c        self.model
-0002d1a0: 203d 204c 4742 4d52 6567 7265 7373 6f72   = LGBMRegressor
-0002d1b0: 2872 616e 646f 6d5f 7365 6564 3d39 3929  (random_seed=99)
-0002d1c0: 0a20 2020 2020 2020 2020 2020 2073 656c  .            sel
-0002d1d0: 662e 6d6f 6465 6c2e 7365 745f 7061 7261  f.model.set_para
-0002d1e0: 6d73 282a 2a69 6e69 745f 7061 7261 6d73  ms(**init_params
-0002d1f0: 2920 2020 2020 2020 2020 2020 200a 2020  )            .  
-0002d200: 2020 2020 2020 656c 7365 3a0a 2020 2020        else:.    
-0002d210: 2020 2020 2020 2020 7365 6c66 2e6d 6f64          self.mod
-0002d220: 656c 203d 204c 4742 4d43 6c61 7373 6966  el = LGBMClassif
-0002d230: 6965 7228 7261 6e64 6f6d 5f73 6565 643d  ier(random_seed=
-0002d240: 3939 290a 2020 2020 2020 2020 2020 2020  99).            
-0002d250: 7365 6c66 2e6d 6f64 656c 2e73 6574 5f70  self.model.set_p
-0002d260: 6172 616d 7328 2a2a 696e 6974 5f70 6172  arams(**init_par
-0002d270: 616d 7329 2020 2020 2020 2020 2020 2020  ams)            
-0002d280: 0a20 2020 2020 2020 2020 2020 2069 6620  .            if 
-0002d290: 6772 6964 5f73 6561 7263 683a 0a20 2020  grid_search:.   
-0002d2a0: 2020 2020 2020 2020 2020 2020 2073 636f               sco
-0002d2b0: 7269 6e67 203d 2027 6261 6c61 6e63 6564  ring = 'balanced
-0002d2c0: 5f61 6363 7572 6163 7927 0a20 2020 2020  _accuracy'.     
-0002d2d0: 2020 2020 2020 2020 2020 2073 636f 7265             score
-0002d2e0: 5f6e 616d 6520 3d20 2762 616c 616e 6365  _name = 'balance
-0002d2f0: 645f 6163 6375 7261 6379 270a 2020 2020  d_accuracy'.    
-0002d300: 2020 2020 2020 2020 656c 7365 3a0a 2020          else:.  
-0002d310: 2020 2020 2020 2020 2020 2020 2020 7363                sc
-0002d320: 6f72 696e 6720 3d20 2762 616c 616e 6365  oring = 'balance
-0002d330: 645f 6163 6375 7261 6379 270a 2020 2020  d_accuracy'.    
-0002d340: 2020 2020 2020 2020 2020 2020 7363 6f72              scor
-0002d350: 655f 6e61 6d65 203d 2027 6261 6c61 6e63  e_name = 'balanc
-0002d360: 6564 5f61 6363 7572 6163 7927 0a0a 2020  ed_accuracy'..  
-0002d370: 2020 2020 2020 6966 2058 5f74 7261 696e        if X_train
-0002d380: 2e73 6861 7065 5b30 5d20 3c3d 3130 3030  .shape[0] <=1000
-0002d390: 3030 3a0a 2020 2020 2020 2020 2020 2020  00:.            
-0002d3a0: 6e5f 6974 6572 203d 2031 300a 2020 2020  n_iter = 10.    
-0002d3b0: 2020 2020 656c 7365 3a0a 2020 2020 2020      else:.      
-0002d3c0: 2020 2020 2020 6e5f 6974 6572 203d 2035        n_iter = 5
-0002d3d0: 0a20 2020 2020 2020 2023 2323 2320 5468  .        #### Th
-0002d3e0: 6973 2069 7320 7768 6572 6520 796f 7520  is is where you 
-0002d3f0: 6772 6964 2073 6561 7263 6820 7468 6520  grid search the 
-0002d400: 7069 7065 6c69 6e65 206e 6f77 2023 2323  pipeline now ###
-0002d410: 2323 2323 2323 2323 2323 230a 0a20 2020  ###########..   
-0002d420: 2020 2020 2069 6620 6772 6964 5f73 6561       if grid_sea
-0002d430: 7263 683a 0a20 2020 2020 2020 2020 2020  rch:.           
-0002d440: 2073 6561 7263 6820 3d20 4772 6964 5365   search = GridSe
-0002d450: 6172 6368 4356 280a 2020 2020 2020 2020  archCV(.        
-0002d460: 2020 2020 2020 2020 2020 2020 7365 6c66              self
-0002d470: 2c20 0a20 2020 2020 2020 2020 2020 2020  , .             
-0002d480: 2020 2020 2020 2067 7269 645f 7061 7261         grid_para
-0002d490: 6d73 2c20 0a20 2020 2020 2020 2020 2020  ms, .           
-0002d4a0: 2020 2020 2020 2020 2063 763d 352c 0a20           cv=5,. 
-0002d4b0: 2020 2020 2020 2020 2020 2020 2020 2020                  
-0002d4c0: 2020 2073 636f 7269 6e67 3d73 636f 7269     scoring=scori
-0002d4d0: 6e67 2c0a 2020 2020 2020 2020 2020 2020  ng,.            
-0002d4e0: 2020 2020 2020 2020 7265 6669 743d 4661          refit=Fa
-0002d4f0: 6c73 652c 0a20 2020 2020 2020 2020 2020  lse,.           
-0002d500: 2020 2020 2020 2020 2072 6574 7572 6e5f           return_
-0002d510: 7472 6169 6e5f 7363 6f72 6520 3d20 5472  train_score = Tr
-0002d520: 7565 2c0a 2020 2020 2020 2020 2020 2020  ue,.            
-0002d530: 2020 2020 2020 2020 6e5f 6a6f 6273 3d2d          n_jobs=-
-0002d540: 312c 0a20 2020 2020 2020 2020 2020 2020  1,.             
-0002d550: 2020 2020 2020 2076 6572 626f 7365 3d54         verbose=T
-0002d560: 7275 652c 0a20 2020 2020 2020 2020 2020  rue,.           
-0002d570: 2020 2020 2020 2020 2029 0a20 2020 2020           ).     
-0002d580: 2020 2065 6c73 653a 0a20 2020 2020 2020     else:.       
-0002d590: 2020 2020 2073 6561 7263 6820 3d20 5261       search = Ra
-0002d5a0: 6e64 6f6d 697a 6564 5365 6172 6368 4356  ndomizedSearchCV
-0002d5b0: 280a 2020 2020 2020 2020 2020 2020 2020  (.              
-0002d5c0: 2020 2020 2020 7365 6c66 2c0a 2020 2020        self,.    
-0002d5d0: 2020 2020 2020 2020 2020 2020 2020 2020                  
-0002d5e0: 7261 6e64 5f70 6172 616d 732c 0a20 2020  rand_params,.   
-0002d5f0: 2020 2020 2020 2020 2020 2020 2020 2020                  
-0002d600: 206e 5f69 7465 7220 3d20 6e5f 6974 6572   n_iter = n_iter
-0002d610: 2c0a 2020 2020 2020 2020 2020 2020 2020  ,.              
-0002d620: 2020 2020 2020 6376 203d 2035 2c0a 2020        cv = 5,.  
-0002d630: 2020 2020 2020 2020 2020 2020 2020 2020                  
-0002d640: 2020 7265 6669 743d 4661 6c73 652c 0a20    refit=False,. 
-0002d650: 2020 2020 2020 2020 2020 2020 2020 2020                  
-0002d660: 2020 2072 6574 7572 6e5f 7472 6169 6e5f     return_train_
-0002d670: 7363 6f72 6520 3d20 5472 7565 2c0a 2020  score = True,.  
-0002d680: 2020 2020 2020 2020 2020 2020 2020 2020                  
-0002d690: 2020 7261 6e64 6f6d 5f73 7461 7465 203d    random_state =
-0002d6a0: 2039 392c 0a20 2020 2020 2020 2020 2020   99,.           
-0002d6b0: 2020 2020 2020 2020 2073 636f 7269 6e67           scoring
-0002d6c0: 3d73 636f 7269 6e67 2c0a 2020 2020 2020  =scoring,.      
-0002d6d0: 2020 2020 2020 2020 2020 2020 2020 6e5f                n_
-0002d6e0: 6a6f 6273 3d2d 312c 0a20 2020 2020 2020  jobs=-1,.       
-0002d6f0: 2020 2020 2020 2020 2020 2020 2076 6572               ver
-0002d700: 626f 7365 3d54 7275 652c 0a20 2020 2020  bose=True,.     
-0002d710: 2020 2020 2020 2020 2020 2020 2020 2029                 )
-0002d720: 0a20 2020 2020 2020 2020 2020 2070 7269  .            pri
-0002d730: 6e74 2827 4e75 6d62 6572 206f 6620 6974  nt('Number of it
-0002d740: 6572 6174 696f 6e73 2069 6e20 7261 6e64  erations in rand
-0002d750: 6f6d 697a 6564 2073 6561 7263 6820 3d20  omized search = 
-0002d760: 2573 2720 256e 5f69 7465 7229 0a20 2020  %s' %n_iter).   
-0002d770: 2020 2020 200a 2020 2020 2020 2020 2323       .        ##
-0002d780: 2323 2320 5468 6973 2069 7320 7768 6572  ### This is wher
-0002d790: 6520 7765 2073 6561 7263 6820 666f 7220  e we search for 
-0002d7a0: 6879 7065 7220 7061 7261 6d73 2066 6f72  hyper params for
-0002d7b0: 206d 6f64 656c 2023 2323 2323 2323 0a20   model #######. 
-0002d7c0: 2020 2020 2020 2073 6561 7263 682e 6669         search.fi
-0002d7d0: 7428 585f 7472 6169 6e2c 2079 5f74 7261  t(X_train, y_tra
-0002d7e0: 696e 290a 2020 2020 2020 2020 0a20 2020  in).        .   
-0002d7f0: 2020 2020 2063 765f 7265 7375 6c74 7320       cv_results 
-0002d800: 3d20 7064 2e44 6174 6146 7261 6d65 2873  = pd.DataFrame(s
-0002d810: 6561 7263 682e 6376 5f72 6573 756c 7473  earch.cv_results
-0002d820: 5f29 0a20 2020 2020 2020 2069 6620 6d6f  _).        if mo
-0002d830: 6465 6c74 7970 6520 3d3d 2027 5265 6772  deltype == 'Regr
-0002d840: 6573 7369 6f6e 273a 0a20 2020 2020 2020  ession':.       
-0002d850: 2020 2020 2070 7269 6e74 2827 4d65 616e       print('Mean
-0002d860: 2063 726f 7373 2d76 616c 6964 6174 6564   cross-validated
-0002d870: 2074 7261 696e 2025 7320 3d20 2530 2e30   train %s = %0.0
-0002d880: 3466 2720 2528 7363 6f72 655f 6e61 6d65  4f' %(score_name
-0002d890: 2c20 6e70 2e73 7172 7428 6162 7328 6376  , np.sqrt(abs(cv
-0002d8a0: 5f72 6573 756c 7473 5b27 6d65 616e 5f74  _results['mean_t
-0002d8b0: 7261 696e 5f73 636f 7265 275d 2e6d 6561  rain_score'].mea
-0002d8c0: 6e28 2929 2929 290a 2020 2020 2020 2020  n())))).        
-0002d8d0: 2020 2020 7072 696e 7428 2720 2020 204d      print('    M
-0002d8e0: 6561 6e20 6372 6f73 732d 7661 6c69 6461  ean cross-valida
-0002d8f0: 7465 6420 7465 7374 2025 7320 3d20 2530  ted test %s = %0
-0002d900: 2e30 3466 2720 2528 7363 6f72 655f 6e61  .04f' %(score_na
-0002d910: 6d65 2c20 6e70 2e73 7172 7428 6162 7328  me, np.sqrt(abs(
-0002d920: 6376 5f72 6573 756c 7473 5b27 6d65 616e  cv_results['mean
-0002d930: 5f74 6573 745f 7363 6f72 6527 5d2e 6d65  _test_score'].me
-0002d940: 616e 2829 2929 2929 0a20 2020 2020 2020  an())))).       
-0002d950: 2020 2020 2069 6620 6376 5f72 6573 756c       if cv_resul
-0002d960: 7473 5b27 6d65 616e 5f74 6573 745f 7363  ts['mean_test_sc
-0002d970: 6f72 6527 5d2e 6d65 616e 2829 2f63 765f  ore'].mean()/cv_
-0002d980: 7265 7375 6c74 735b 276d 6561 6e5f 7472  results['mean_tr
-0002d990: 6169 6e5f 7363 6f72 6527 5d2e 6d65 616e  ain_score'].mean
-0002d9a0: 2829 203e 3d20 312e 323a 0a20 2020 2020  () >= 1.2:.     
-0002d9b0: 2020 2020 2020 2020 2020 2070 7269 6e74             print
-0002d9c0: 2827 2323 2323 204d 6f64 656c 2069 7320  ('#### Model is 
-0002d9d0: 6f76 6572 6669 7474 696e 672e 2059 6f75  overfitting. You
-0002d9e0: 206d 6967 6874 2077 616e 7420 746f 2074   might want to t
-0002d9f0: 6573 7420 7769 7468 6f75 7420 4772 6964  est without Grid
-0002da00: 5365 6172 6368 206f 7074 696f 6e20 6173  Search option as
-0002da10: 2077 656c 6c20 2323 2323 2729 0a20 2020   well ####').   
-0002da20: 2020 2020 2065 6c73 653a 0a20 2020 2020       else:.     
-0002da30: 2020 2020 2020 2070 7269 6e74 2827 4d65         print('Me
-0002da40: 616e 2063 726f 7373 2d76 616c 6964 6174  an cross-validat
-0002da50: 6564 2074 7261 696e 2025 7320 3d20 2530  ed train %s = %0
-0002da60: 2e30 3466 2720 2528 7363 6f72 655f 6e61  .04f' %(score_na
-0002da70: 6d65 2c20 6376 5f72 6573 756c 7473 5b27  me, cv_results['
-0002da80: 6d65 616e 5f74 7261 696e 5f73 636f 7265  mean_train_score
-0002da90: 275d 2e6d 6561 6e28 2929 290a 2020 2020  '].mean())).    
-0002daa0: 2020 2020 2020 2020 7072 696e 7428 2720          print(' 
-0002dab0: 2020 204d 6561 6e20 6372 6f73 732d 7661     Mean cross-va
-0002dac0: 6c69 6461 7465 6420 7465 7374 2025 7320  lidated test %s 
-0002dad0: 3d20 2530 2e30 3466 2720 2528 7363 6f72  = %0.04f' %(scor
-0002dae0: 655f 6e61 6d65 2c20 6376 5f72 6573 756c  e_name, cv_resul
-0002daf0: 7473 5b27 6d65 616e 5f74 6573 745f 7363  ts['mean_test_sc
-0002db00: 6f72 6527 5d2e 6d65 616e 2829 2929 0a20  ore'].mean())). 
-0002db10: 2020 2020 2020 2020 2020 2069 6620 6376             if cv
-0002db20: 5f72 6573 756c 7473 5b27 6d65 616e 5f74  _results['mean_t
-0002db30: 7261 696e 5f73 636f 7265 275d 2e6d 6561  rain_score'].mea
-0002db40: 6e28 292f 6376 5f72 6573 756c 7473 5b27  n()/cv_results['
-0002db50: 6d65 616e 5f74 6573 745f 7363 6f72 6527  mean_test_score'
-0002db60: 5d2e 6d65 616e 2829 203e 3d20 312e 323a  ].mean() >= 1.2:
-0002db70: 0a20 2020 2020 2020 2020 2020 2020 2020  .               
-0002db80: 2070 7269 6e74 2827 2323 2323 204d 6f64   print('#### Mod
-0002db90: 656c 2069 7320 6f76 6572 6669 7474 696e  el is overfittin
-0002dba0: 672e 2059 6f75 206d 6967 6874 2077 616e  g. You might wan
-0002dbb0: 7420 746f 2074 6573 7420 7769 7468 6f75  t to test withou
-0002dbc0: 7420 4772 6964 5365 6172 6368 206f 7074  t GridSearch opt
-0002dbd0: 696f 6e20 6173 2077 656c 6c20 2323 2323  ion as well ####
-0002dbe0: 2729 0a20 2020 2020 2020 2020 2020 200a  ').            .
-0002dbf0: 2020 2020 2020 2020 7072 696e 7428 2754          print('T
-0002dc00: 696d 6520 7461 6b65 6e20 666f 7220 4879  ime taken for Hy
-0002dc10: 7065 7220 5061 7261 6d20 7475 6e69 6e67  per Param tuning
-0002dc20: 206f 6620 4c47 424d 2028 696e 206d 696e   of LGBM (in min
-0002dc30: 7574 6573 2920 3d20 2530 2e31 6627 2025  utes) = %0.1f' %
-0002dc40: 280a 2020 2020 2020 2020 2020 2020 2020  (.              
-0002dc50: 2020 2020 2020 2020 2020 2020 2020 2020                  
-0002dc60: 2020 2020 2020 2020 2020 2874 696d 652e            (time.
-0002dc70: 7469 6d65 2829 2d73 7461 7274 5f74 696d  time()-start_tim
-0002dc80: 6529 2f36 3029 290a 2020 2020 2020 2020  e)/60)).        
-0002dc90: 7072 696e 7428 2742 6573 7420 7061 7261  print('Best para
-0002dca0: 6d73 2066 726f 6d20 7365 6172 6368 3a5c  ms from search:\
-0002dcb0: 6e25 7327 2025 7365 6172 6368 2e62 6573  n%s' %search.bes
-0002dcc0: 745f 7061 7261 6d73 5f29 0a20 2020 2020  t_params_).     
-0002dcd0: 2020 206e 6577 5f6d 6f64 656c 203d 2073     new_model = s
-0002dce0: 656c 662e 6d6f 6465 6c2e 7365 745f 7061  elf.model.set_pa
-0002dcf0: 7261 6d73 282a 2a73 6561 7263 682e 6265  rams(**search.be
-0002dd00: 7374 5f70 6172 616d 735f 290a 2020 2020  st_params_).    
-0002dd10: 2020 2020 6966 206d 756c 7469 5f6c 6162      if multi_lab
-0002dd20: 656c 3a0a 2020 2020 2020 2020 2020 2020  el:.            
-0002dd30: 6966 206d 6f64 656c 7479 7065 203d 3d20  if modeltype == 
-0002dd40: 2752 6567 7265 7373 696f 6e27 3a0a 2020  'Regression':.  
-0002dd50: 2020 2020 2020 2020 2020 2020 2020 6e65                ne
-0002dd60: 775f 6d6f 6465 6c20 3d20 4d75 6c74 694f  w_model = MultiO
-0002dd70: 7574 7075 7452 6567 7265 7373 6f72 286e  utputRegressor(n
-0002dd80: 6577 5f6d 6f64 656c 290a 2020 2020 2020  ew_model).      
-0002dd90: 2020 2020 2020 656c 7365 3a0a 2020 2020        else:.    
-0002dda0: 2020 2020 2020 2020 2020 2020 6e65 775f              new_
-0002ddb0: 6d6f 6465 6c20 3d20 4d75 6c74 694f 7574  model = MultiOut
-0002ddc0: 7075 7443 6c61 7373 6966 6965 7228 6e65  putClassifier(ne
-0002ddd0: 775f 6d6f 6465 6c29 0a20 2020 2020 2020  w_model).       
-0002dde0: 2073 656c 662e 6d6f 6465 6c20 3d20 6e65   self.model = ne
-0002ddf0: 775f 6d6f 6465 6c0a 2020 2020 2020 2020  w_model.        
-0002de00: 7365 6c66 2e66 6974 2858 5f74 7261 696e  self.fit(X_train
-0002de10: 2c20 795f 7472 6169 6e29 0a20 2020 2020  , y_train).     
-0002de20: 2020 2070 7269 6e74 2827 2020 2020 7265     print('    re
-0002de30: 7475 726e 696e 6720 6120 6e65 7720 4c61  turning a new La
-0002de40: 7a79 5472 616e 7366 6f72 6d65 7220 7069  zyTransformer pi
-0002de50: 7065 6c69 6e65 2074 6861 7420 636f 6e74  peline that cont
-0002de60: 6169 6e73 2074 6865 2062 6573 7420 6d6f  ains the best mo
-0002de70: 6465 6c20 7472 6169 6e65 6420 6f6e 2079  del trained on y
-0002de80: 6f75 7220 7472 6169 6e20 6461 7461 7365  our train datase
-0002de90: 7421 2729 0a20 2020 2020 2020 2072 6574  t!').        ret
-0002dea0: 7572 6e20 7365 6c66 0a23 2323 2323 2323  urn self.#######
-0002deb0: 2323 2323 2323 2323 2323 2323 2323 2323  ################
-0002dec0: 2323 2323 2323 2323 2323 2323 2323 2323  ################
-0002ded0: 2323 2323 2323 2323 2323 2323 2323 2323  ################
-0002dee0: 2323 2323 2323 2323 2323 2323 2323 2323  ################
-0002def0: 2323 2323 2323 2323 2323 2323 230a 2320  #############.# 
-0002df00: 5468 6973 2069 7320 6e65 6564 6564 2074  This is needed t
-0002df10: 6f20 6d61 6b65 2074 6869 7320 6120 7265  o make this a re
-0002df20: 6775 6c61 7220 7472 616e 7366 6f72 6d65  gular transforme
-0002df30: 7220 2323 230a 636c 6173 7320 5954 7261  r ###.class YTra
-0002df40: 6e73 666f 726d 6572 2854 7261 6e73 666f  nsformer(Transfo
-0002df50: 726d 6572 4d69 7869 6e29 3a0a 2020 2020  rmerMixin):.    
-0002df60: 6465 6620 5f5f 696e 6974 5f5f 2873 656c  def __init__(sel
-0002df70: 662c 2074 7261 6e73 666f 726d 6572 733d  f, transformers=
-0002df80: 7b7d 2c20 7461 7267 6574 733d 5b5d 293a  {}, targets=[]):
-0002df90: 0a20 2020 2020 2020 2023 2073 746f 7265  .        # store
-0002dfa0: 2074 6865 206e 756d 6265 7220 6f66 2064   the number of d
-0002dfb0: 696d 656e 7369 6f6e 206f 6620 7468 6520  imension of the 
-0002dfc0: 7461 7267 6574 2074 6f20 7072 6564 6963  target to predic
-0002dfd0: 7420 616e 2061 7272 6179 206f 660a 2020  t an array of.  
-0002dfe0: 2020 2020 2020 2320 7369 6d69 6c61 7220        # similar 
-0002dff0: 7368 6170 6520 6174 2070 7265 6469 6374  shape at predict
-0002e000: 0a20 2020 2020 2020 2073 656c 662e 7472  .        self.tr
-0002e010: 616e 7366 6f72 6d65 7273 203d 2020 7472  ansformers =  tr
-0002e020: 616e 7366 6f72 6d65 7273 0a20 2020 2020  ansformers.     
-0002e030: 2020 2073 656c 662e 7461 7267 6574 7320     self.targets 
-0002e040: 3d20 7461 7267 6574 730a 2020 2020 2020  = targets.      
-0002e050: 2020 0a20 2020 2064 6566 2067 6574 5f70    .    def get_p
-0002e060: 6172 616d 7328 7365 6c66 2c20 6465 6570  arams(self, deep
-0002e070: 3d54 7275 6529 3a0a 2020 2020 2020 2020  =True):.        
-0002e080: 2320 5468 6973 2069 7320 746f 206d 616b  # This is to mak
-0002e090: 6520 6974 2073 6369 6b69 742d 6c65 6172  e it scikit-lear
-0002e0a0: 6e20 636f 6d70 6174 6962 6c65 2023 2323  n compatible ###
-0002e0b0: 230a 2020 2020 2020 2020 7265 7475 726e  #.        return
-0002e0c0: 207b 2274 7261 6e73 666f 726d 6572 7322   {"transformers"
-0002e0d0: 3a20 7365 6c66 2e74 7261 6e73 666f 726d  : self.transform
-0002e0e0: 6572 732c 2022 7461 7267 6574 7322 3a20  ers, "targets": 
-0002e0f0: 7365 6c66 2e74 6172 6765 7473 7d0a 0a20  self.targets}.. 
-0002e100: 2020 2064 6566 2073 6574 5f70 6172 616d     def set_param
-0002e110: 7328 7365 6c66 2c20 2a2a 7061 7261 6d65  s(self, **parame
-0002e120: 7465 7273 293a 0a20 2020 2020 2020 2066  ters):.        f
-0002e130: 6f72 2070 6172 616d 6574 6572 2c20 7661  or parameter, va
-0002e140: 6c75 6520 696e 2070 6172 616d 6574 6572  lue in parameter
-0002e150: 732e 6974 656d 7328 293a 0a20 2020 2020  s.items():.     
-0002e160: 2020 2020 2020 2073 6574 6174 7472 2873         setattr(s
-0002e170: 656c 662c 2070 6172 616d 6574 6572 2c20  elf, parameter, 
-0002e180: 7661 6c75 6529 0a20 2020 2020 2020 2072  value).        r
-0002e190: 6574 7572 6e20 7365 6c66 0a0a 2020 2020  eturn self..    
-0002e1a0: 6465 6620 6669 7428 7365 6c66 2c20 7929  def fit(self, y)
-0002e1b0: 3a0a 2020 2020 2020 2020 2222 2246 6974  :.        """Fit
-0002e1c0: 2074 6865 206d 6f64 656c 2061 6363 6f72   the model accor
-0002e1d0: 6469 6e67 2074 6f20 7468 6520 6769 7665  ding to the give
-0002e1e0: 6e20 7472 6169 6e69 6e67 2064 6174 6122  n training data"
-0002e1f0: 2222 2020 2020 2020 2020 0a20 2020 2020  ""        .     
-0002e200: 2020 2023 2074 7261 6e73 666f 726d 6572     # transformer
-0002e210: 7320 6172 6520 6465 7369 676e 6564 2074  s are designed t
-0002e220: 6f20 6d6f 6469 6679 2058 2077 6869 6368  o modify X which
-0002e230: 2069 7320 3264 2064 696d 656e 7369 6f6e   is 2d dimension
-0002e240: 616c 2c20 7765 0a20 2020 2020 2020 2023  al, we.        #
-0002e250: 206e 6565 6420 746f 206d 6f64 6966 7920   need to modify 
-0002e260: 7920 6163 636f 7264 696e 676c 792e 0a20  y accordingly.. 
-0002e270: 2020 2020 2020 2069 6620 6973 696e 7374         if isinst
-0002e280: 616e 6365 2879 2c20 7064 2e53 6572 6965  ance(y, pd.Serie
-0002e290: 7329 3a0a 2020 2020 2020 2020 2020 2020  s):.            
-0002e2a0: 6966 2079 2e6e 616d 6520 6e6f 7420 696e  if y.name not in
-0002e2b0: 2073 656c 662e 7461 7267 6574 733a 0a20   self.targets:. 
-0002e2c0: 2020 2020 2020 2020 2020 2020 2020 2073                 s
-0002e2d0: 656c 662e 7461 7267 6574 732e 6170 7065  elf.targets.appe
-0002e2e0: 6e64 2879 2e6e 616d 6529 0a20 2020 2020  nd(y.name).     
-0002e2f0: 2020 2065 6c69 6620 6973 696e 7374 616e     elif isinstan
-0002e300: 6365 2879 2c20 7064 2e44 6174 6146 7261  ce(y, pd.DataFra
-0002e310: 6d65 293a 0a20 2020 2020 2020 2020 2020  me):.           
-0002e320: 2073 656c 662e 7461 7267 6574 7320 2b3d   self.targets +=
-0002e330: 2079 2e63 6f6c 756d 6e73 2e74 6f6c 6973   y.columns.tolis
-0002e340: 7428 290a 2020 2020 2020 2020 2020 2020  t().            
-0002e350: 7365 6c66 2e74 6172 6765 7473 203d 2066  self.targets = f
-0002e360: 696e 645f 7265 6d6f 7665 5f64 7570 6c69  ind_remove_dupli
-0002e370: 6361 7465 7328 7365 6c66 2e74 6172 6765  cates(self.targe
-0002e380: 7473 290a 2020 2020 2020 2020 2320 7472  ts).        # tr
-0002e390: 616e 7366 6f72 6d20 7920 616e 6420 636f  ansform y and co
-0002e3a0: 6e76 6572 7420 6261 636b 2074 6f20 3164  nvert back to 1d
-0002e3b0: 2061 7272 6179 2069 6620 6e65 6564 6564   array if needed
-0002e3c0: 0a20 2020 2020 2020 2069 6620 6973 696e  .        if isin
-0002e3d0: 7374 616e 6365 2879 2c20 7064 2e53 6572  stance(y, pd.Ser
-0002e3e0: 6965 7329 3a0a 2020 2020 2020 2020 2020  ies):.          
-0002e3f0: 2020 795f 3164 203d 2079 2e76 616c 7565    y_1d = y.value
-0002e400: 730a 2020 2020 2020 2020 2020 2020 7920  s.            y 
-0002e410: 3d20 7064 2e44 6174 6146 7261 6d65 2879  = pd.DataFrame(y
-0002e420: 5f31 642c 2063 6f6c 756d 6e73 3d73 656c  _1d, columns=sel
-0002e430: 662e 7461 7267 6574 7329 0a20 2020 2020  f.targets).     
-0002e440: 2020 2065 6c69 6620 6973 696e 7374 616e     elif isinstan
-0002e450: 6365 2879 2c20 7064 2e44 6174 6146 7261  ce(y, pd.DataFra
-0002e460: 6d65 293a 0a20 2020 2020 2020 2020 2020  me):.           
-0002e470: 2079 5f31 6420 3d20 792e 7661 6c75 6573   y_1d = y.values
-0002e480: 0a20 2020 2020 2020 2023 795f 3164 203d  .        #y_1d =
-0002e490: 2063 6f6c 756d 6e5f 6f72 5f31 6428 795f   column_or_1d(y_
-0002e4a0: 3164 290a 2020 2020 2020 2020 666f 7220  1d).        for 
-0002e4b0: 692c 2065 6163 685f 7461 7267 6574 2069  i, each_target i
-0002e4c0: 6e20 656e 756d 6572 6174 6528 7365 6c66  n enumerate(self
-0002e4d0: 2e74 6172 6765 7473 293a 0a20 2020 2020  .targets):.     
-0002e4e0: 2020 2020 2020 206c 6220 3d20 4d79 5f4c         lb = My_L
-0002e4f0: 6162 656c 456e 636f 6465 7228 290a 2020  abelEncoder().  
-0002e500: 2020 2020 2020 2020 2020 6c62 2e66 6974            lb.fit
-0002e510: 2879 2e69 6c6f 635b 3a2c 695d 290a 2020  (y.iloc[:,i]).  
-0002e520: 2020 2020 2020 2020 2020 7365 6c66 2e74            self.t
-0002e530: 7261 6e73 666f 726d 6572 735b 6561 6368  ransformers[each
-0002e540: 5f74 6172 6765 745d 203d 206c 620a 2020  _target] = lb.  
-0002e550: 2020 2020 2020 7265 7475 726e 2073 656c        return sel
-0002e560: 660a 2020 2020 0a20 2020 2064 6566 2074  f.    .    def t
-0002e570: 7261 6e73 666f 726d 2873 656c 662c 2079  ransform(self, y
-0002e580: 293a 0a20 2020 2020 2020 2074 6172 6765  ):.        targe
-0002e590: 745f 6c65 6e20 3d20 6c65 6e28 7365 6c66  t_len = len(self
-0002e5a0: 2e74 6172 6765 7473 2920 2d20 310a 2020  .targets) - 1.  
-0002e5b0: 2020 2020 2020 6966 2079 2069 7320 4e6f        if y is No
-0002e5c0: 6e65 3a0a 2020 2020 2020 2020 2020 2020  ne:.            
-0002e5d0: 7265 7475 726e 2079 0a20 2020 2020 2020  return y.       
-0002e5e0: 2065 6c73 653a 0a20 2020 2020 2020 2020   else:.         
-0002e5f0: 2020 2069 6620 6973 696e 7374 616e 6365     if isinstance
-0002e600: 2879 2c20 7064 2e53 6572 6965 7329 3a0a  (y, pd.Series):.
-0002e610: 2020 2020 2020 2020 2020 2020 2020 2020                  
-0002e620: 7920 3d20 7064 2e44 6174 6146 7261 6d65  y = pd.DataFrame
-0002e630: 2879 290a 2020 2020 2020 2020 2020 2020  (y).            
-0002e640: 795f 7472 616e 7320 3d20 636f 7079 2e64  y_trans = copy.d
-0002e650: 6565 7063 6f70 7928 7929 0a20 2020 2020  eepcopy(y).     
-0002e660: 2020 2020 2020 2066 6f72 2065 6163 685f         for each_
-0002e670: 7461 7267 6574 2069 6e20 7365 6c66 2e74  target in self.t
-0002e680: 6172 6765 7473 3a0a 2020 2020 2020 2020  argets:.        
-0002e690: 2020 2020 2020 2020 795f 7472 616e 735b          y_trans[
-0002e6a0: 6561 6368 5f74 6172 6765 745d 203d 2073  each_target] = s
-0002e6b0: 656c 662e 7472 616e 7366 6f72 6d65 7273  elf.transformers
-0002e6c0: 5b65 6163 685f 7461 7267 6574 5d2e 7472  [each_target].tr
-0002e6d0: 616e 7366 6f72 6d28 795b 6561 6368 5f74  ansform(y[each_t
-0002e6e0: 6172 6765 745d 290a 2020 2020 2020 2020  arget]).        
-0002e6f0: 2020 2020 7265 7475 726e 2079 5f74 7261      return y_tra
-0002e700: 6e73 0a20 2020 200a 2020 2020 6465 6620  ns.    .    def 
-0002e710: 6669 745f 7472 616e 7366 6f72 6d28 7365  fit_transform(se
-0002e720: 6c66 2c20 793d 4e6f 6e65 293a 0a20 2020  lf, y=None):.   
-0002e730: 2020 2020 2073 656c 662e 6669 7428 7929       self.fit(y)
-0002e740: 0a20 2020 2020 2020 2069 6620 6973 696e  .        if isin
-0002e750: 7374 616e 6365 2879 2c20 7064 2e53 6572  stance(y, pd.Ser
-0002e760: 6965 7329 3a0a 2020 2020 2020 2020 2020  ies):.          
-0002e770: 2020 795f 7472 616e 7320 3d20 7365 6c66    y_trans = self
-0002e780: 2e74 7261 6e73 666f 726d 6572 735b 7365  .transformers[se
-0002e790: 6c66 2e74 6172 6765 7473 5b30 5d5d 2e74  lf.targets[0]].t
-0002e7a0: 7261 6e73 666f 726d 2879 290a 2020 2020  ransform(y).    
-0002e7b0: 2020 2020 656c 6966 2069 7369 6e73 7461      elif isinsta
-0002e7c0: 6e63 6528 792c 2070 642e 4461 7461 4672  nce(y, pd.DataFr
-0002e7d0: 616d 6529 3a0a 2020 2020 2020 2020 2020  ame):.          
-0002e7e0: 2020 795f 7472 616e 7320 3d20 636f 7079    y_trans = copy
-0002e7f0: 2e64 6565 7063 6f70 7928 7929 0a20 2020  .deepcopy(y).   
-0002e800: 2020 2020 2020 2020 2066 6f72 2065 6163           for eac
-0002e810: 685f 7461 7267 6574 2069 6e20 7365 6c66  h_target in self
-0002e820: 2e74 6172 6765 7473 3a0a 2020 2020 2020  .targets:.      
-0002e830: 2020 2020 2020 2020 2020 795f 7472 616e            y_tran
-0002e840: 735b 6561 6368 5f74 6172 6765 745d 203d  s[each_target] =
-0002e850: 2073 656c 662e 7472 616e 7366 6f72 6d65   self.transforme
-0002e860: 7273 5b65 6163 685f 7461 7267 6574 5d2e  rs[each_target].
-0002e870: 7472 616e 7366 6f72 6d28 795b 6561 6368  transform(y[each
-0002e880: 5f74 6172 6765 745d 290a 2020 2020 2020  _target]).      
-0002e890: 2020 656c 7365 3a0a 2020 2020 2020 2020    else:.        
-0002e8a0: 2020 2020 7072 696e 7428 2745 7272 6f72      print('Error
-0002e8b0: 3a20 4361 6e6e 6f74 2074 7261 6e73 666f  : Cannot transfo
-0002e8c0: 726d 206e 756d 7079 2061 7272 6179 732e  rm numpy arrays.
-0002e8d0: 2052 6574 7572 6e69 6e67 2729 0a20 2020   Returning').   
-0002e8e0: 2020 2020 2020 2020 2072 6574 7572 6e20           return 
-0002e8f0: 790a 2020 2020 2020 2020 7265 7475 726e  y.        return
-0002e900: 2079 5f74 7261 6e73 0a20 2020 200a 2020   y_trans.    .  
-0002e910: 2020 6465 6620 696e 7665 7273 655f 7472    def inverse_tr
-0002e920: 616e 7366 6f72 6d28 7365 6c66 2c20 7929  ansform(self, y)
-0002e930: 3a0a 2020 2020 2020 2020 666f 7220 692c  :.        for i,
-0002e940: 2065 6163 685f 7461 7267 6574 2069 6e20   each_target in 
-0002e950: 656e 756d 6572 6174 6528 7365 6c66 2e74  enumerate(self.t
-0002e960: 6172 6765 7473 293a 0a20 2020 2020 2020  argets):.       
-0002e970: 2020 2020 2069 6620 6920 3d3d 2030 3a0a       if i == 0:.
-0002e980: 2020 2020 2020 2020 2020 2020 2020 2020                  
-0002e990: 7472 616e 7366 6f72 6d65 725f 203d 2073  transformer_ = s
-0002e9a0: 656c 662e 7472 616e 7366 6f72 6d65 7273  elf.transformers
-0002e9b0: 5b65 6163 685f 7461 7267 6574 5d0a 2020  [each_target].  
-0002e9c0: 2020 2020 2020 2020 2020 2020 2020 6966                if
-0002e9d0: 2069 7369 6e73 7461 6e63 6528 792c 2070   isinstance(y, p
-0002e9e0: 642e 5365 7269 6573 293a 0a20 2020 2020  d.Series):.     
-0002e9f0: 2020 2020 2020 2020 2020 2020 2020 2079                 y
-0002ea00: 203d 2070 642e 4461 7461 4672 616d 6528   = pd.DataFrame(
-0002ea10: 792c 2063 6f6c 756d 6e73 3d73 656c 662e  y, columns=self.
-0002ea20: 7461 7267 6574 7329 0a20 2020 2020 2020  targets).       
-0002ea30: 2020 2020 2020 2020 2065 6c69 6620 6973           elif is
-0002ea40: 696e 7374 616e 6365 2879 2c20 6e70 2e6e  instance(y, np.n
-0002ea50: 6461 7272 6179 293a 0a20 2020 2020 2020  darray):.       
-0002ea60: 2020 2020 2020 2020 2020 2020 2079 203d               y =
-0002ea70: 2070 642e 4461 7461 4672 616d 6528 792c   pd.DataFrame(y,
-0002ea80: 2063 6f6c 756d 6e73 3d73 656c 662e 7461   columns=self.ta
-0002ea90: 7267 6574 7329 0a20 2020 2020 2020 2020  rgets).         
-0002eaa0: 2020 2020 2020 2065 6c73 653a 0a20 2020         else:.   
-0002eab0: 2020 2020 2020 2020 2020 2020 2020 2020                  
-0002eac0: 2023 2323 2069 6620 6974 2069 7320 6120   ### if it is a 
-0002ead0: 6461 7461 6672 616d 6520 7468 656e 206c  dataframe then l
-0002eae0: 6561 7665 2069 7420 616c 6f6e 6520 2323  eave it alone ##
-0002eaf0: 0a20 2020 2020 2020 2020 2020 2020 2020  .               
-0002eb00: 2020 2020 2070 6173 730a 2020 2020 2020       pass.      
-0002eb10: 2020 2020 2020 2020 2020 795f 7420 3d20            y_t = 
-0002eb20: 7472 616e 7366 6f72 6d65 725f 2e69 6e76  transformer_.inv
-0002eb30: 6572 7365 5f74 7261 6e73 666f 726d 2879  erse_transform(y
-0002eb40: 2e76 616c 7565 735b 3a2c 695d 290a 2020  .values[:,i]).  
-0002eb50: 2020 2020 2020 2020 2020 2020 2020 795f                y_
-0002eb60: 7472 616e 7320 3d20 7064 2e53 6572 6965  trans = pd.Serie
-0002eb70: 7328 795f 742c 6e61 6d65 3d65 6163 685f  s(y_t,name=each_
-0002eb80: 7461 7267 6574 290a 2020 2020 2020 2020  target).        
-0002eb90: 2020 2020 656c 7365 3a0a 2020 2020 2020      else:.      
-0002eba0: 2020 2020 2020 2020 2020 7472 616e 7366            transf
-0002ebb0: 6f72 6d65 725f 203d 2073 656c 662e 7472  ormer_ = self.tr
-0002ebc0: 616e 7366 6f72 6d65 7273 5b65 6163 685f  ansformers[each_
-0002ebd0: 7461 7267 6574 5d0a 2020 2020 2020 2020  target].        
-0002ebe0: 2020 2020 2020 2020 795f 7420 3d20 7472          y_t = tr
-0002ebf0: 616e 7366 6f72 6d65 725f 2e69 6e76 6572  ansformer_.inver
-0002ec00: 7365 5f74 7261 6e73 666f 726d 2879 2e76  se_transform(y.v
-0002ec10: 616c 7565 735b 3a2c 695d 290a 2020 2020  alues[:,i]).    
-0002ec20: 2020 2020 2020 2020 2020 2020 795f 7472              y_tr
-0002ec30: 616e 7320 3d20 7064 2e44 6174 6146 7261  ans = pd.DataFra
-0002ec40: 6d65 2879 5f74 7261 6e73 290a 2020 2020  me(y_trans).    
-0002ec50: 2020 2020 2020 2020 2020 2020 795f 7472              y_tr
-0002ec60: 616e 735b 6561 6368 5f74 6172 6765 745d  ans[each_target]
-0002ec70: 203d 2079 5f74 0a20 2020 2020 2020 2072   = y_t.        r
-0002ec80: 6574 7572 6e20 795f 7472 616e 730a 2020  eturn y_trans.  
-0002ec90: 2020 0a20 2020 2064 6566 2070 7265 6469    .    def predi
-0002eca0: 6374 2873 656c 662c 2079 3d4e 6f6e 652c  ct(self, y=None,
-0002ecb0: 202a 2a66 6974 5f70 6172 616d 7329 3a0a   **fit_params):.
-0002ecc0: 2020 2020 2020 2020 2370 7269 6e74 2827          #print('
-0002ecd0: 5468 6572 6520 6973 206e 6f20 7072 6564  There is no pred
-0002ece0: 6963 7420 6675 6e63 7469 6f6e 2069 6e20  ict function in 
-0002ecf0: 4c61 6265 6c20 456e 636f 6465 722e 2052  Label Encoder. R
-0002ed00: 6574 7572 6e69 6e67 2e2e 2e27 290a 2020  eturning...').  
-0002ed10: 2020 2020 2020 7265 7475 726e 2079 0a23        return y.#
-0002ed20: 2323 2323 2323 2323 2323 2323 2323 2323  ################
-0002ed30: 2323 2323 2323 2323 2323 2323 2323 2323  ################
-0002ed40: 2323 2323 2323 2323 2323 2323 2323 2323  ################
-0002ed50: 2323 2323 2323 2323 2323 2323 2323 2323  ################
-0002ed60: 2323 2323 2323 2323 2323 2323 230a 6672  #############.fr
-0002ed70: 6f6d 2063 6f6c 6c65 6374 696f 6e73 2069  om collections i
-0002ed80: 6d70 6f72 7420 6465 6661 756c 7464 6963  mport defaultdic
-0002ed90: 740a 2320 5468 6973 2069 7320 6e65 6564  t.# This is need
-0002eda0: 6564 2074 6f20 6d61 6b65 2074 6869 7320  ed to make this 
-0002edb0: 6120 7265 6775 6c61 7220 7472 616e 7366  a regular transf
-0002edc0: 6f72 6d65 7220 2323 230a 6672 6f6d 2073  ormer ###.from s
-0002edd0: 6b6c 6561 726e 2e62 6173 6520 696d 706f  klearn.base impo
-0002ede0: 7274 2042 6173 6545 7374 696d 6174 6f72  rt BaseEstimator
-0002edf0: 2c20 5472 616e 7366 6f72 6d65 724d 6978  , TransformerMix
-0002ee00: 696e 200a 636c 6173 7320 5261 7265 5f43  in .class Rare_C
-0002ee10: 6c61 7373 5f43 6f6d 6269 6e65 725f 5069  lass_Combiner_Pi
-0002ee20: 7065 2842 6173 6545 7374 696d 6174 6f72  pe(BaseEstimator
-0002ee30: 2c20 5472 616e 7366 6f72 6d65 724d 6978  , TransformerMix
-0002ee40: 696e 2029 3a0a 2020 2020 2222 220a 2020  in ):.    """.  
-0002ee50: 2020 5468 6973 2069 7320 7468 6520 7069    This is the pi
-0002ee60: 7065 6c69 6e65 2076 6572 7369 6f6e 206f  peline version o
-0002ee70: 6620 7261 7265 2063 6c61 7373 2063 6f6d  f rare class com
-0002ee80: 6269 6e65 7220 7573 6564 2069 6e20 736b  biner used in sk
-0002ee90: 6c65 6172 6e20 7069 7065 6c69 6e65 732e  learn pipelines.
-0002eea0: 0a20 2020 2022 2222 0a20 2020 2064 6566  .    """.    def
-0002eeb0: 205f 5f69 6e69 745f 5f28 7365 6c66 2c20   __init__(self, 
-0002eec0: 7472 616e 7366 6f72 6d65 7273 3d7b 7d20  transformers={} 
-0002eed0: 2029 3a0a 2020 2020 2020 2020 2320 7374   ):.        # st
-0002eee0: 6f72 6520 7468 6520 6e75 6d62 6572 206f  ore the number o
-0002eef0: 6620 6469 6d65 6e73 696f 6e20 6f66 2074  f dimension of t
-0002ef00: 6865 2074 6172 6765 7420 746f 2070 7265  he target to pre
-0002ef10: 6469 6374 2061 6e20 6172 7261 7920 6f66  dict an array of
-0002ef20: 0a20 2020 2020 2020 2023 2073 696d 696c  .        # simil
-0002ef30: 6172 2073 6861 7065 2061 7420 7072 6564  ar shape at pred
-0002ef40: 6963 740a 2020 2020 2020 2020 7365 6c66  ict.        self
-0002ef50: 2e74 7261 6e73 666f 726d 6572 7320 3d20  .transformers = 
-0002ef60: 2074 7261 6e73 666f 726d 6572 730a 2020   transformers.  
-0002ef70: 2020 2020 2020 7365 6c66 2e7a 6572 6f5f        self.zero_
-0002ef80: 6c6f 775f 636f 756e 7473 203d 2064 6566  low_counts = def
-0002ef90: 6175 6c74 6469 6374 2862 6f6f 6c29 0a20  aultdict(bool). 
-0002efa0: 2020 2020 2020 200a 2020 2020 6465 6620         .    def 
-0002efb0: 6765 745f 7061 7261 6d73 2873 656c 662c  get_params(self,
-0002efc0: 2064 6565 703d 5472 7565 293a 0a20 2020   deep=True):.   
-0002efd0: 2020 2020 2023 2054 6869 7320 6973 2074       # This is t
-0002efe0: 6f20 6d61 6b65 2069 7420 7363 696b 6974  o make it scikit
-0002eff0: 2d6c 6561 726e 2063 6f6d 7061 7469 626c  -learn compatibl
-0002f000: 6520 2323 2323 0a20 2020 2020 2020 2072  e ####.        r
-0002f010: 6574 7572 6e20 7b22 7472 616e 7366 6f72  eturn {"transfor
-0002f020: 6d65 7273 223a 2073 656c 662e 7472 616e  mers": self.tran
-0002f030: 7366 6f72 6d65 7273 7d0a 0a20 2020 2064  sformers}..    d
-0002f040: 6566 2073 6574 5f70 6172 616d 7328 7365  ef set_params(se
-0002f050: 6c66 2c20 2a2a 7061 7261 6d65 7465 7273  lf, **parameters
-0002f060: 293a 0a20 2020 2020 2020 2066 6f72 2070  ):.        for p
-0002f070: 6172 616d 6574 6572 2c20 7661 6c75 6520  arameter, value 
-0002f080: 696e 2070 6172 616d 6574 6572 732e 6974  in parameters.it
-0002f090: 656d 7328 293a 0a20 2020 2020 2020 2020  ems():.         
-0002f0a0: 2020 2073 6574 6174 7472 2873 656c 662c     setattr(self,
-0002f0b0: 2070 6172 616d 6574 6572 2c20 7661 6c75   parameter, valu
-0002f0c0: 6529 0a20 2020 2020 2020 2072 6574 7572  e).        retur
-0002f0d0: 6e20 7365 6c66 0a0a 2020 2020 6465 6620  n self..    def 
-0002f0e0: 6669 7428 7365 6c66 2c20 582c 2079 3d4e  fit(self, X, y=N
-0002f0f0: 6f6e 652c 202a 2a66 6974 5f70 6172 616d  one, **fit_param
-0002f100: 7329 3a0a 2020 2020 2020 2020 2222 2246  s):.        """F
-0002f110: 6974 2074 6865 206d 6f64 656c 2061 6363  it the model acc
-0002f120: 6f72 6469 6e67 2074 6f20 7468 6520 6769  ording to the gi
-0002f130: 7665 6e20 7472 6169 6e69 6e67 2064 6174  ven training dat
-0002f140: 6122 2222 2020 2020 2020 2020 0a20 2020  a"""        .   
-0002f150: 2020 2020 2023 2074 7261 6e73 666f 726d       # transform
-0002f160: 6572 7320 6e65 6564 2061 2064 6566 6175  ers need a defau
-0002f170: 6c74 206e 616d 6520 666f 7220 7261 7265  lt name for rare
-0002f180: 2063 6174 6567 6f72 6965 7320 2323 0a20   categories ##. 
-0002f190: 2020 2020 2020 2064 6566 2072 6574 7572         def retur
-0002f1a0: 6e5f 6361 745f 7661 6c75 6528 293a 0a20  n_cat_value():. 
-0002f1b0: 2020 2020 2020 2020 2020 2072 6574 7572             retur
-0002f1c0: 6e20 2272 6172 655f 6361 7465 676f 7269  n "rare_categori
-0002f1d0: 6573 220a 2020 2020 2020 2020 2323 2320  es".        ### 
-0002f1e0: 496e 2074 6869 7320 6361 7365 2058 2069  In this case X i
-0002f1f0: 7473 656c 6620 7769 6c6c 206f 6e6c 7920  tself will only 
-0002f200: 6265 2061 2070 642e 5365 7269 6573 2023  be a pd.Series #
-0002f210: 2323 0a20 2020 2020 2020 2065 6163 685f  ##.        each_
-0002f220: 6361 7476 6172 203d 2058 2e6e 616d 650a  catvar = X.name.
-0002f230: 2020 2020 2020 2020 2323 2323 2069 6620          #### if 
-0002f240: 6974 2069 7320 616c 7265 6164 7920 6120  it is already a 
-0002f250: 6c69 7374 2c20 7468 656e 206c 6561 7665  list, then leave
-0002f260: 2069 7420 6173 2069 7320 2323 230a 2020   it as is ###.  
-0002f270: 2020 2020 2020 7365 6c66 2e74 7261 6e73        self.trans
-0002f280: 666f 726d 6572 735b 6561 6368 5f63 6174  formers[each_cat
-0002f290: 7661 725d 203d 2064 6566 6175 6c74 6469  var] = defaultdi
-0002f2a0: 6374 2872 6574 7572 6e5f 6361 745f 7661  ct(return_cat_va
-0002f2b0: 6c75 6529 0a20 2020 2020 2020 2023 2323  lue).        ###
-0002f2c0: 2054 6865 6e20 6669 6e64 2074 6865 2075   Then find the u
-0002f2d0: 6e69 7175 6520 6361 7465 676f 7269 6573  nique categories
-0002f2e0: 2069 6e20 7468 6520 636f 6c75 6d6e 2023   in the column #
-0002f2f0: 2323 0a20 2020 2020 2020 2073 656c 662e  ##.        self.
-0002f300: 7472 616e 7366 6f72 6d65 7273 5b65 6163  transformers[eac
-0002f310: 685f 6361 7476 6172 5d20 3d20 6469 6374  h_catvar] = dict
-0002f320: 287a 6970 2858 2e75 6e69 7175 6528 292c  (zip(X.unique(),
-0002f330: 2058 2e75 6e69 7175 6528 2929 290a 2020   X.unique())).  
-0002f340: 2020 2020 2020 6c6f 775f 636f 756e 7473        low_counts
-0002f350: 203d 2070 642e 4461 7461 4672 616d 6528   = pd.DataFrame(
-0002f360: 5829 2e61 7070 6c79 286c 616d 6264 6120  X).apply(lambda 
-0002f370: 783a 2078 2e76 616c 7565 5f63 6f75 6e74  x: x.value_count
-0002f380: 7328 295b 0a20 2020 2020 2020 2020 2020  s()[.           
-0002f390: 2020 2020 2028 782e 7661 6c75 655f 636f       (x.value_co
-0002f3a0: 756e 7473 2829 3c3d 2830 2e30 312a 782e  unts()<=(0.01*x.
-0002f3b0: 7368 6170 655b 305d 2929 2e76 616c 7565  shape[0])).value
-0002f3c0: 735d 2e69 6e64 6578 292e 7661 6c75 6573  s].index).values
-0002f3d0: 2e72 6176 656c 2829 0a20 2020 2020 2020  .ravel().       
-0002f3e0: 200a 2020 2020 2020 2020 6966 206c 656e   .        if len
-0002f3f0: 286c 6f77 5f63 6f75 6e74 7329 203d 3d20  (low_counts) == 
-0002f400: 303a 0a20 2020 2020 2020 2020 2020 2073  0:.            s
-0002f410: 656c 662e 7a65 726f 5f6c 6f77 5f63 6f75  elf.zero_low_cou
-0002f420: 6e74 735b 6561 6368 5f63 6174 7661 725d  nts[each_catvar]
-0002f430: 203d 2054 7275 650a 2020 2020 2020 2020   = True.        
-0002f440: 656c 7365 3a0a 2020 2020 2020 2020 2020  else:.          
-0002f450: 2020 7365 6c66 2e7a 6572 6f5f 6c6f 775f    self.zero_low_
-0002f460: 636f 756e 7473 5b65 6163 685f 6361 7476  counts[each_catv
-0002f470: 6172 5d20 3d20 4661 6c73 650a 2020 2020  ar] = False.    
-0002f480: 2020 2020 666f 7220 6561 6368 5f6c 6f77      for each_low
-0002f490: 2069 6e20 6c6f 775f 636f 756e 7473 3a0a   in low_counts:.
-0002f4a0: 2020 2020 2020 2020 2020 2020 7365 6c66              self
-0002f4b0: 2e74 7261 6e73 666f 726d 6572 735b 6561  .transformers[ea
-0002f4c0: 6368 5f63 6174 7661 725d 2e75 7064 6174  ch_catvar].updat
-0002f4d0: 6528 7b65 6163 685f 6c6f 773a 2772 6172  e({each_low:'rar
-0002f4e0: 655f 6361 7465 676f 7269 6573 277d 290a  e_categories'}).
-0002f4f0: 2020 2020 2020 2020 7265 7475 726e 2073          return s
-0002f500: 656c 660a 2020 2020 0a20 2020 2064 6566  elf.    .    def
-0002f510: 2074 7261 6e73 666f 726d 2873 656c 662c   transform(self,
-0002f520: 2058 2c20 793d 4e6f 6e65 2c20 2a2a 6669   X, y=None, **fi
-0002f530: 745f 7061 7261 6d73 293a 0a20 2020 2020  t_params):.     
-0002f540: 2020 2065 6163 685f 6361 7476 6172 203d     each_catvar =
-0002f550: 2058 2e6e 616d 650a 2020 2020 2020 2020   X.name.        
-0002f560: 6966 2073 656c 662e 7a65 726f 5f6c 6f77  if self.zero_low
-0002f570: 5f63 6f75 6e74 735b 6561 6368 5f63 6174  _counts[each_cat
-0002f580: 7661 725d 3a0a 2020 2020 2020 2020 2020  var]:.          
-0002f590: 2020 7061 7373 0a20 2020 2020 2020 2065    pass.        e
-0002f5a0: 6c73 653a 0a20 2020 2020 2020 2020 2020  lse:.           
-0002f5b0: 2058 203d 2058 2e6d 6170 2873 656c 662e   X = X.map(self.
-0002f5c0: 7472 616e 7366 6f72 6d65 7273 5b65 6163  transformers[eac
-0002f5d0: 685f 6361 7476 6172 5d29 0a20 2020 2020  h_catvar]).     
-0002f5e0: 2020 2020 2020 2023 2323 2073 696d 706c         ### simpl
-0002f5f0: 7920 6669 6c6c 2069 6e20 7468 6520 6d69  y fill in the mi
-0002f600: 7373 696e 6720 7661 6c75 6573 2077 6974  ssing values wit
-0002f610: 6820 7468 6520 776f 7264 2022 6d69 7373  h the word "miss
-0002f620: 696e 6722 2023 230a 2020 2020 2020 2020  ing" ##.        
-0002f630: 2020 2020 5820 3d20 582e 6669 6c6c 6e61      X = X.fillna
-0002f640: 2827 6d69 7373 696e 6727 2c69 6e70 6c61  ('missing',inpla
-0002f650: 6365 3d46 616c 7365 290a 2020 2020 2020  ce=False).      
-0002f660: 2020 7265 7475 726e 2058 0a0a 2020 2020    return X..    
-0002f670: 6465 6620 6669 745f 7472 616e 7366 6f72  def fit_transfor
-0002f680: 6d28 7365 6c66 2c20 582c 2079 3d4e 6f6e  m(self, X, y=Non
-0002f690: 652c 202a 2a66 6974 5f70 6172 616d 7329  e, **fit_params)
-0002f6a0: 3a0a 2020 2020 2020 2020 2323 2320 5369  :.        ### Si
-0002f6b0: 6e63 6520 5820 666f 7220 7954 2069 6e20  nce X for yT in 
-0002f6c0: 6120 7069 7065 6c69 6e65 2069 7320 7365  a pipeline is se
-0002f6d0: 6e74 2061 7320 582c 2077 6520 6e65 6564  nt as X, we need
-0002f6e0: 2074 6f20 7377 6974 6368 2058 2061 6e64   to switch X and
-0002f6f0: 2079 2074 6869 7320 7761 7920 2323 0a20   y this way ##. 
-0002f700: 2020 2020 2020 2073 656c 662e 6669 7428         self.fit(
-0002f710: 582c 2079 290a 2020 2020 2020 2020 6561  X, y).        ea
-0002f720: 6368 5f63 6174 7661 7220 3d20 582e 6e61  ch_catvar = X.na
-0002f730: 6d65 0a20 2020 2020 2020 2069 6620 7365  me.        if se
-0002f740: 6c66 2e7a 6572 6f5f 6c6f 775f 636f 756e  lf.zero_low_coun
-0002f750: 7473 5b65 6163 685f 6361 7476 6172 5d3a  ts[each_catvar]:
-0002f760: 0a20 2020 2020 2020 2020 2020 2070 6173  .            pas
-0002f770: 730a 2020 2020 2020 2020 656c 7365 3a0a  s.        else:.
-0002f780: 2020 2020 2020 2020 2020 2020 5820 3d20              X = 
-0002f790: 582e 6d61 7028 7365 6c66 2e74 7261 6e73  X.map(self.trans
-0002f7a0: 666f 726d 6572 735b 6561 6368 5f63 6174  formers[each_cat
-0002f7b0: 7661 725d 290a 2020 2020 2020 2020 2020  var]).          
-0002f7c0: 2020 2323 2320 7369 6d70 6c79 2066 696c    ### simply fil
-0002f7d0: 6c20 696e 2074 6865 206d 6973 7369 6e67  l in the missing
-0002f7e0: 2076 616c 7565 7320 7769 7468 2074 6865   values with the
-0002f7f0: 2077 6f72 6420 226d 6973 7369 6e67 2220   word "missing" 
-0002f800: 2323 0a20 2020 2020 2020 2020 2020 2058  ##.            X
-0002f810: 203d 2058 2e66 696c 6c6e 6128 276d 6973   = X.fillna('mis
-0002f820: 7369 6e67 272c 696e 706c 6163 653d 4661  sing',inplace=Fa
-0002f830: 6c73 6529 0a20 2020 2020 2020 2072 6574  lse).        ret
-0002f840: 7572 6e20 580a 0a20 2020 2064 6566 2069  urn X..    def i
-0002f850: 6e76 6572 7365 5f74 7261 6e73 666f 726d  nverse_transform
-0002f860: 2873 656c 662c 2058 2c20 2a2a 6669 745f  (self, X, **fit_
-0002f870: 7061 7261 6d73 293a 0a20 2020 2020 2020  params):.       
-0002f880: 2023 2323 204f 6e65 2070 726f 626c 656d   ### One problem
-0002f890: 2077 6974 6820 7468 6973 2061 7070 726f   with this appro
-0002f8a0: 6163 6820 6973 2074 6861 7420 796f 7520  ach is that you 
-0002f8b0: 6861 7665 2063 6f6d 6269 6e65 6420 6361  have combined ca
-0002f8c0: 7465 676f 7269 6573 2069 6e74 6f20 6f6e  tegories into on
-0002f8d0: 652e 0a20 2020 2020 2020 2023 2323 2020  e..        ###  
-0002f8e0: 2059 6f75 2063 616e 6e6f 7420 756e 636f   You cannot unco
-0002f8f0: 6d62 696e 6520 7468 656d 2073 696e 6365  mbine them since
-0002f900: 2074 6865 7920 6e6f 206c 6f6e 6765 7220   they no longer 
-0002f910: 6861 7665 2061 2075 6e69 7175 6520 6361  have a unique ca
-0002f920: 7465 676f 7279 2e20 0a20 2020 2020 2020  tegory. .       
-0002f930: 2023 2323 2020 2059 6f75 2077 696c 6c20   ###   You will 
-0002f940: 6765 7420 6261 636b 2074 6865 206c 6173  get back the las
-0002f950: 7420 7472 616e 7366 6f72 6d65 6420 6361  t transformed ca
-0002f960: 7465 676f 7279 2077 6865 6e20 796f 7520  tegory when you 
-0002f970: 696e 7665 7273 6520 7472 616e 7366 6f72  inverse transfor
-0002f980: 6d20 6974 2e0a 2020 2020 2020 2020 6561  m it..        ea
-0002f990: 6368 5f63 6174 7661 7220 3d20 582e 6e61  ch_catvar = X.na
-0002f9a0: 6d65 0a20 2020 2020 2020 2074 7261 6e73  me.        trans
-0002f9b0: 666f 726d 6572 5f20 3d20 7365 6c66 2e74  former_ = self.t
-0002f9c0: 7261 6e73 666f 726d 6572 735b 6561 6368  ransformers[each
-0002f9d0: 5f63 6174 7661 725d 0a20 2020 2020 2020  _catvar].       
-0002f9e0: 2072 6576 6572 7365 5f74 7261 6e73 666f   reverse_transfo
-0002f9f0: 726d 6572 5f20 3d20 6469 6374 285b 2879  rmer_ = dict([(y
-0002fa00: 2c78 2920 666f 7220 2878 2c79 2920 696e  ,x) for (x,y) in
-0002fa10: 2074 7261 6e73 666f 726d 6572 5f2e 6974   transformer_.it
-0002fa20: 656d 7328 295d 290a 2020 2020 2020 2020  ems()]).        
-0002fa30: 6966 2073 656c 662e 7a65 726f 5f6c 6f77  if self.zero_low
-0002fa40: 5f63 6f75 6e74 735b 6561 6368 5f63 6174  _counts[each_cat
-0002fa50: 7661 725d 3a0a 2020 2020 2020 2020 2020  var]:.          
-0002fa60: 2020 7061 7373 0a20 2020 2020 2020 2065    pass.        e
-0002fa70: 6c73 653a 0a20 2020 2020 2020 2020 2020  lse:.           
-0002fa80: 2058 5b65 6163 685f 6361 7476 6172 5d20   X[each_catvar] 
-0002fa90: 3d20 585b 6561 6368 5f63 6174 7661 725d  = X[each_catvar]
-0002faa0: 2e6d 6170 2872 6576 6572 7365 5f74 7261  .map(reverse_tra
-0002fab0: 6e73 666f 726d 6572 5f29 2e76 616c 7565  nsformer_).value
-0002fac0: 730a 2020 2020 2020 2020 7265 7475 726e  s.        return
-0002fad0: 2058 0a20 2020 200a 2020 2020 6465 6620   X.    .    def 
-0002fae0: 7072 6564 6963 7428 7365 6c66 2c20 582c  predict(self, X,
-0002faf0: 2079 3d4e 6f6e 652c 202a 2a66 6974 5f70   y=None, **fit_p
-0002fb00: 6172 616d 7329 3a0a 2020 2020 2020 2020  arams):.        
-0002fb10: 2370 7269 6e74 2827 5468 6572 6520 6973  #print('There is
-0002fb20: 206e 6f20 7072 6564 6963 7420 6675 6e63   no predict func
-0002fb30: 7469 6f6e 2069 6e20 5261 7265 2063 6c61  tion in Rare cla
-0002fb40: 7373 2063 6f6d 6269 6e65 722e 2052 6574  ss combiner. Ret
-0002fb50: 7572 6e69 6e67 2e2e 2e27 290a 2020 2020  urning...').    
-0002fb60: 2020 2020 7265 7475 726e 2058 0a23 2323      return X.###
-0002fb70: 2323 2323 2323 2323 2323 2323 2323 2323  ################
-0002fb80: 2323 2323 2323 2323 2323 2323 2323 2323  ################
-0002fb90: 2323 2323 2323 2323 2323 2323 2323 2323  ################
-0002fba0: 2323 2323 2323 2323 2323 2323 2323 2323  ################
-0002fbb0: 2323 2323 2323 2323 2323 230a 696d 706f  ###########.impo
-0002fbc0: 7274 2063 6f70 790a 6465 6620 4544 415f  rt copy.def EDA_
-0002fbd0: 6669 6e64 5f72 656d 6f76 655f 636f 6c75  find_remove_colu
-0002fbe0: 6d6e 735f 7769 7468 5f69 6e66 696e 6974  mns_with_infinit
-0002fbf0: 7928 6466 2c20 7265 6d6f 7665 3d46 616c  y(df, remove=Fal
-0002fc00: 7365 293a 0a20 2020 2022 2222 0a20 2020  se):.    """.   
-0002fc10: 2054 6869 7320 6675 6e63 7469 6f6e 2066   This function f
-0002fc20: 696e 6473 2061 6c6c 2063 6f6c 756d 6e73  inds all columns
-0002fc30: 2069 6e20 6120 6461 7461 6672 616d 6520   in a dataframe 
-0002fc40: 7468 6174 2068 6176 6520 696e 6966 696e  that have inifin
-0002fc50: 6974 6520 7661 6c75 6573 2028 6e70 2e69  ite values (np.i
-0002fc60: 6e66 206f 7220 2d6e 702e 696e 6629 0a20  nf or -np.inf). 
-0002fc70: 2020 2049 7420 7265 7475 726e 7320 6120     It returns a 
-0002fc80: 6c69 7374 206f 6620 636f 6c75 6d6e 206e  list of column n
-0002fc90: 616d 6573 2e20 4966 2074 6865 206c 6973  ames. If the lis
-0002fca0: 7420 6973 2065 6d70 7479 2c20 6974 206d  t is empty, it m
-0002fcb0: 6561 6e73 206e 6f20 636f 6c75 6d6e 7320  eans no columns 
-0002fcc0: 7765 7265 2066 6f75 6e64 2e0a 2020 2020  were found..    
-0002fcd0: 4966 2072 656d 6f76 6520 666c 6167 2069  If remove flag i
-0002fce0: 7320 7365 742c 2074 6865 6e20 6974 2072  s set, then it r
-0002fcf0: 6574 7572 6e73 2061 2073 6d61 6c6c 6572  eturns a smaller
-0002fd00: 2064 6174 6166 7261 6d65 2077 6974 6820   dataframe with 
-0002fd10: 696e 6620 636f 6c75 6d6e 7320 7265 6d6f  inf columns remo
-0002fd20: 7665 642e 0a20 2020 2022 2222 0a20 2020  ved..    """.   
-0002fd30: 206e 756d 7320 3d20 6466 2e73 656c 6563   nums = df.selec
-0002fd40: 745f 6474 7970 6573 2869 6e63 6c75 6465  t_dtypes(include
-0002fd50: 3d27 6e75 6d62 6572 2729 2e63 6f6c 756d  ='number').colum
-0002fd60: 6e73 2e74 6f6c 6973 7428 290a 2020 2020  ns.tolist().    
-0002fd70: 6466 7820 3d20 6466 5b6e 756d 735d 0a20  dfx = df[nums]. 
-0002fd80: 2020 2073 756d 5f72 6f77 7320 3d20 6e70     sum_rows = np
-0002fd90: 2e69 7369 6e66 2864 6678 292e 7661 6c75  .isinf(dfx).valu
-0002fda0: 6573 2e73 756d 2829 0a20 2020 2061 6464  es.sum().    add
-0002fdb0: 5f63 6f6c 7320 3d20 206c 6973 7428 6466  _cols =  list(df
-0002fdc0: 782e 636f 6c75 6d6e 732e 746f 5f73 6572  x.columns.to_ser
-0002fdd0: 6965 7328 295b 6e70 2e69 7369 6e66 2864  ies()[np.isinf(d
-0002fde0: 6678 292e 616e 7928 295d 290a 2020 2020  fx).any()]).    
-0002fdf0: 6966 2073 756d 5f72 6f77 7320 3e20 303a  if sum_rows > 0:
-0002fe00: 0a20 2020 2020 2020 2070 7269 6e74 2827  .        print('
-0002fe10: 2020 2020 7468 6572 6520 6172 6520 2564      there are %d
-0002fe20: 2072 6f77 7320 616e 6420 2564 2063 6f6c   rows and %d col
-0002fe30: 756d 6e73 2077 6974 6820 696e 6669 6e69  umns with infini
-0002fe40: 7479 2069 6e20 7468 656d 2e2e 2e27 2025  ty in them...' %
-0002fe50: 2873 756d 5f72 6f77 732c 6c65 6e28 6164  (sum_rows,len(ad
-0002fe60: 645f 636f 6c73 2929 290a 2020 2020 2020  d_cols))).      
-0002fe70: 2020 6966 2072 656d 6f76 653a 0a20 2020    if remove:.   
-0002fe80: 2020 2020 2020 2020 2023 2323 2068 6572           ### her
-0002fe90: 6520 796f 7520 6e65 6564 2074 6f20 7573  e you need to us
-0002fea0: 6520 6466 2073 696e 6365 2074 6865 2077  e df since the w
-0002feb0: 686f 6c65 2064 6174 6173 6574 2069 7320  hole dataset is 
-0002fec0: 696e 766f 6c76 6564 2023 2323 0a20 2020  involved ###.   
-0002fed0: 2020 2020 2020 2020 206e 6f63 6f6c 7320           nocols 
-0002fee0: 3d20 5b78 2066 6f72 2078 2069 6e20 6466  = [x for x in df
-0002fef0: 2e63 6f6c 756d 6e73 2069 6620 7820 6e6f  .columns if x no
-0002ff00: 7420 696e 2061 6464 5f63 6f6c 735d 0a20  t in add_cols]. 
-0002ff10: 2020 2020 2020 2020 2020 2070 7269 6e74             print
-0002ff20: 2822 2020 2020 5368 6170 6520 6f66 2064  ("    Shape of d
-0002ff30: 6174 6173 6574 2062 6566 6f72 6520 2573  ataset before %s
-0002ff40: 2061 6e64 2061 6674 6572 2025 7320 7265   and after %s re
-0002ff50: 6d6f 7669 6e67 2063 6f6c 756d 6e73 2077  moving columns w
-0002ff60: 6974 6820 696e 6669 6e69 7479 2220 2528  ith infinity" %(
-0002ff70: 6466 2e73 6861 7065 2c28 6466 5b6e 6f63  df.shape,(df[noc
-0002ff80: 6f6c 735d 2e73 6861 7065 2c29 2929 0a20  ols].shape,))). 
-0002ff90: 2020 2020 2020 2020 2020 2072 6574 7572             retur
-0002ffa0: 6e20 6466 5b6e 6f63 6f6c 735d 0a20 2020  n df[nocols].   
-0002ffb0: 2020 2020 2065 6c73 653a 0a20 2020 2020       else:.     
-0002ffc0: 2020 2020 2020 2023 2320 7468 6973 2077         ## this w
-0002ffd0: 696c 6c20 6265 2061 206c 6973 7420 6f66  ill be a list of
-0002ffe0: 2063 6f6c 756d 6e73 2077 6974 6820 696e   columns with in
-0002fff0: 6669 6e69 7479 2023 2323 230a 2020 2020  finity ####.    
-00030000: 2020 2020 2020 2020 7265 7475 726e 2061          return a
-00030010: 6464 5f63 6f6c 730a 2020 2020 656c 7365  dd_cols.    else
-00030020: 3a0a 2020 2020 2020 2020 2323 2074 6869  :.        ## thi
-00030030: 7320 7769 6c6c 2062 6520 616e 2065 6d70  s will be an emp
-00030040: 7479 206c 6973 7420 6966 2074 6865 7265  ty list if there
-00030050: 2061 7265 206e 6f20 636f 6c75 6d6e 7320   are no columns 
-00030060: 7769 7468 2069 6e66 696e 6974 790a 2020  with infinity.  
-00030070: 2020 2020 2020 7265 7475 726e 2061 6464        return add
-00030080: 5f63 6f6c 730a 2323 2323 2323 2323 2323  _cols.##########
-00030090: 2323 2323 2323 2323 2323 2323 2323 2323  ################
-000300a0: 2323 2323 2323 2323 2323 2323 2323 2323  ################
-000300b0: 2323 2323 2323 2323 2323 2323 2323 2323  ################
+00029fe0: 2020 2020 6376 203d 2035 2c0a 2020 2020      cv = 5,.    
+00029ff0: 2020 2020 2020 2020 2020 2020 2020 2020                  
+0002a000: 7265 6669 743d 4661 6c73 652c 0a20 2020  refit=False,.   
+0002a010: 2020 2020 2020 2020 2020 2020 2020 2020                  
+0002a020: 2072 6574 7572 6e5f 7472 6169 6e5f 7363   return_train_sc
+0002a030: 6f72 6520 3d20 5472 7565 2c0a 2020 2020  ore = True,.    
+0002a040: 2020 2020 2020 2020 2020 2020 2020 2020                  
+0002a050: 7261 6e64 6f6d 5f73 7461 7465 203d 2039  random_state = 9
+0002a060: 392c 0a20 2020 2020 2020 2020 2020 2020  9,.             
+0002a070: 2020 2020 2020 2073 636f 7269 6e67 3d73         scoring=s
+0002a080: 636f 7269 6e67 2c0a 2020 2020 2020 2020  coring,.        
+0002a090: 2020 2020 2020 2020 2020 2020 6e5f 6a6f              n_jo
+0002a0a0: 6273 3d2d 312c 0a20 2020 2020 2020 2020  bs=-1,.         
+0002a0b0: 2020 2020 2020 2020 2020 2076 6572 626f             verbo
+0002a0c0: 7365 3d54 7275 652c 0a20 2020 2020 2020  se=True,.       
+0002a0d0: 2020 2020 2020 2020 2020 2020 2029 0a20               ). 
+0002a0e0: 2020 2020 2020 2020 2020 2070 7269 6e74             print
+0002a0f0: 2827 4e75 6d62 6572 206f 6620 6974 6572  ('Number of iter
+0002a100: 6174 696f 6e73 2069 6e20 7261 6e64 6f6d  ations in random
+0002a110: 697a 6564 2073 6561 7263 6820 3d20 2573  ized search = %s
+0002a120: 2720 256e 5f69 7465 7229 0a20 2020 2020  ' %n_iter).     
+0002a130: 2020 200a 2020 2020 2020 2020 2323 2323     .        ####
+0002a140: 2320 5468 6973 2069 7320 7768 6572 6520  # This is where 
+0002a150: 7765 2073 6561 7263 6820 666f 7220 6879  we search for hy
+0002a160: 7065 7220 7061 7261 6d73 2066 6f72 206d  per params for m
+0002a170: 6f64 656c 2023 2323 2323 2323 0a20 2020  odel #######.   
+0002a180: 2020 2020 2073 6561 7263 682e 6669 7428       search.fit(
+0002a190: 585f 7472 6169 6e2c 2079 5f74 7261 696e  X_train, y_train
+0002a1a0: 290a 2020 2020 2020 2020 0a20 2020 2020  ).        .     
+0002a1b0: 2020 2063 765f 7265 7375 6c74 7320 3d20     cv_results = 
+0002a1c0: 7064 2e44 6174 6146 7261 6d65 2873 6561  pd.DataFrame(sea
+0002a1d0: 7263 682e 6376 5f72 6573 756c 7473 5f29  rch.cv_results_)
+0002a1e0: 0a20 2020 2020 2020 2069 6620 6d6f 6465  .        if mode
+0002a1f0: 6c74 7970 6520 3d3d 2027 5265 6772 6573  ltype == 'Regres
+0002a200: 7369 6f6e 273a 0a20 2020 2020 2020 2020  sion':.         
+0002a210: 2020 2070 7269 6e74 2827 4d65 616e 2063     print('Mean c
+0002a220: 726f 7373 2d76 616c 6964 6174 6564 2074  ross-validated t
+0002a230: 7261 696e 2025 7320 3d20 2530 2e30 3466  rain %s = %0.04f
+0002a240: 2720 2528 7363 6f72 655f 6e61 6d65 2c20  ' %(score_name, 
+0002a250: 6e70 2e73 7172 7428 6162 7328 6376 5f72  np.sqrt(abs(cv_r
+0002a260: 6573 756c 7473 5b27 6d65 616e 5f74 7261  esults['mean_tra
+0002a270: 696e 5f73 636f 7265 275d 2e6d 6561 6e28  in_score'].mean(
+0002a280: 2929 2929 290a 2020 2020 2020 2020 2020  ))))).          
+0002a290: 2020 7072 696e 7428 2720 2020 204d 6561    print('    Mea
+0002a2a0: 6e20 6372 6f73 732d 7661 6c69 6461 7465  n cross-validate
+0002a2b0: 6420 7465 7374 2025 7320 3d20 2530 2e30  d test %s = %0.0
+0002a2c0: 3466 2720 2528 7363 6f72 655f 6e61 6d65  4f' %(score_name
+0002a2d0: 2c20 6e70 2e73 7172 7428 6162 7328 6376  , np.sqrt(abs(cv
+0002a2e0: 5f72 6573 756c 7473 5b27 6d65 616e 5f74  _results['mean_t
+0002a2f0: 6573 745f 7363 6f72 6527 5d2e 6d65 616e  est_score'].mean
+0002a300: 2829 2929 2929 0a20 2020 2020 2020 2020  ())))).         
+0002a310: 2020 2069 6620 6376 5f72 6573 756c 7473     if cv_results
+0002a320: 5b27 6d65 616e 5f74 6573 745f 7363 6f72  ['mean_test_scor
+0002a330: 6527 5d2e 6d65 616e 2829 2f63 765f 7265  e'].mean()/cv_re
+0002a340: 7375 6c74 735b 276d 6561 6e5f 7472 6169  sults['mean_trai
+0002a350: 6e5f 7363 6f72 6527 5d2e 6d65 616e 2829  n_score'].mean()
+0002a360: 203e 3d20 312e 323a 0a20 2020 2020 2020   >= 1.2:.       
+0002a370: 2020 2020 2020 2020 2070 7269 6e74 2827           print('
+0002a380: 2323 2323 204d 6f64 656c 2069 7320 6f76  #### Model is ov
+0002a390: 6572 6669 7474 696e 672e 2059 6f75 206d  erfitting. You m
+0002a3a0: 6967 6874 2077 616e 7420 746f 2074 6573  ight want to tes
+0002a3b0: 7420 7769 7468 6f75 7420 4772 6964 5365  t without GridSe
+0002a3c0: 6172 6368 206f 7074 696f 6e20 6173 2077  arch option as w
+0002a3d0: 656c 6c20 2323 2323 2729 0a20 2020 2020  ell ####').     
+0002a3e0: 2020 2065 6c73 653a 0a20 2020 2020 2020     else:.       
+0002a3f0: 2020 2020 2070 7269 6e74 2827 4d65 616e       print('Mean
+0002a400: 2063 726f 7373 2d76 616c 6964 6174 6564   cross-validated
+0002a410: 2074 7261 696e 2025 7320 3d20 2530 2e30   train %s = %0.0
+0002a420: 3466 2720 2528 7363 6f72 655f 6e61 6d65  4f' %(score_name
+0002a430: 2c20 6376 5f72 6573 756c 7473 5b27 6d65  , cv_results['me
+0002a440: 616e 5f74 7261 696e 5f73 636f 7265 275d  an_train_score']
+0002a450: 2e6d 6561 6e28 2929 290a 2020 2020 2020  .mean())).      
+0002a460: 2020 2020 2020 7072 696e 7428 2720 2020        print('   
+0002a470: 204d 6561 6e20 6372 6f73 732d 7661 6c69   Mean cross-vali
+0002a480: 6461 7465 6420 7465 7374 2025 7320 3d20  dated test %s = 
+0002a490: 2530 2e30 3466 2720 2528 7363 6f72 655f  %0.04f' %(score_
+0002a4a0: 6e61 6d65 2c20 6376 5f72 6573 756c 7473  name, cv_results
+0002a4b0: 5b27 6d65 616e 5f74 6573 745f 7363 6f72  ['mean_test_scor
+0002a4c0: 6527 5d2e 6d65 616e 2829 2929 0a20 2020  e'].mean())).   
+0002a4d0: 2020 2020 2020 2020 2069 6620 6376 5f72           if cv_r
+0002a4e0: 6573 756c 7473 5b27 6d65 616e 5f74 7261  esults['mean_tra
+0002a4f0: 696e 5f73 636f 7265 275d 2e6d 6561 6e28  in_score'].mean(
+0002a500: 292f 6376 5f72 6573 756c 7473 5b27 6d65  )/cv_results['me
+0002a510: 616e 5f74 6573 745f 7363 6f72 6527 5d2e  an_test_score'].
+0002a520: 6d65 616e 2829 203e 3d20 312e 323a 0a20  mean() >= 1.2:. 
+0002a530: 2020 2020 2020 2020 2020 2020 2020 2070                 p
+0002a540: 7269 6e74 2827 2323 2323 204d 6f64 656c  rint('#### Model
+0002a550: 2069 7320 6f76 6572 6669 7474 696e 672e   is overfitting.
+0002a560: 2059 6f75 206d 6967 6874 2077 616e 7420   You might want 
+0002a570: 746f 2074 6573 7420 7769 7468 6f75 7420  to test without 
+0002a580: 4772 6964 5365 6172 6368 206f 7074 696f  GridSearch optio
+0002a590: 6e20 6173 2077 656c 6c20 2323 2323 2729  n as well ####')
+0002a5a0: 0a20 2020 2020 2020 2020 2020 200a 2020  .            .  
+0002a5b0: 2020 2020 2020 7072 696e 7428 2754 696d        print('Tim
+0002a5c0: 6520 7461 6b65 6e20 666f 7220 4879 7065  e taken for Hype
+0002a5d0: 7220 5061 7261 6d20 7475 6e69 6e67 206f  r Param tuning o
+0002a5e0: 6620 4c47 424d 2028 696e 206d 696e 7574  f LGBM (in minut
+0002a5f0: 6573 2920 3d20 2530 2e31 6627 2025 280a  es) = %0.1f' %(.
+0002a600: 2020 2020 2020 2020 2020 2020 2020 2020                  
+0002a610: 2020 2020 2020 2020 2020 2020 2020 2020                  
+0002a620: 2020 2020 2020 2020 2874 696d 652e 7469          (time.ti
+0002a630: 6d65 2829 2d73 7461 7274 5f74 696d 6529  me()-start_time)
+0002a640: 2f36 3029 290a 2020 2020 2020 2020 7072  /60)).        pr
+0002a650: 696e 7428 2742 6573 7420 7061 7261 6d73  int('Best params
+0002a660: 2066 726f 6d20 7365 6172 6368 3a5c 6e25   from search:\n%
+0002a670: 7327 2025 7365 6172 6368 2e62 6573 745f  s' %search.best_
+0002a680: 7061 7261 6d73 5f29 0a20 2020 2020 2020  params_).       
+0002a690: 206e 6577 5f6d 6f64 656c 203d 2073 656c   new_model = sel
+0002a6a0: 662e 6d6f 6465 6c2e 7365 745f 7061 7261  f.model.set_para
+0002a6b0: 6d73 282a 2a73 6561 7263 682e 6265 7374  ms(**search.best
+0002a6c0: 5f70 6172 616d 735f 290a 2020 2020 2020  _params_).      
+0002a6d0: 2020 6966 206d 756c 7469 5f6c 6162 656c    if multi_label
+0002a6e0: 3a0a 2020 2020 2020 2020 2020 2020 6966  :.            if
+0002a6f0: 206d 6f64 656c 7479 7065 203d 3d20 2752   modeltype == 'R
+0002a700: 6567 7265 7373 696f 6e27 3a0a 2020 2020  egression':.    
+0002a710: 2020 2020 2020 2020 2020 2020 6e65 775f              new_
+0002a720: 6d6f 6465 6c20 3d20 4d75 6c74 694f 7574  model = MultiOut
+0002a730: 7075 7452 6567 7265 7373 6f72 286e 6577  putRegressor(new
+0002a740: 5f6d 6f64 656c 290a 2020 2020 2020 2020  _model).        
+0002a750: 2020 2020 656c 7365 3a0a 2020 2020 2020      else:.      
+0002a760: 2020 2020 2020 2020 2020 6e65 775f 6d6f            new_mo
+0002a770: 6465 6c20 3d20 4d75 6c74 694f 7574 7075  del = MultiOutpu
+0002a780: 7443 6c61 7373 6966 6965 7228 6e65 775f  tClassifier(new_
+0002a790: 6d6f 6465 6c29 0a20 2020 2020 2020 2073  model).        s
+0002a7a0: 656c 662e 6d6f 6465 6c20 3d20 6e65 775f  elf.model = new_
+0002a7b0: 6d6f 6465 6c0a 2020 2020 2020 2020 7365  model.        se
+0002a7c0: 6c66 2e66 6974 2858 5f74 7261 696e 2c20  lf.fit(X_train, 
+0002a7d0: 795f 7472 6169 6e29 0a20 2020 2020 2020  y_train).       
+0002a7e0: 2070 7269 6e74 2827 2020 2020 7265 7475   print('    retu
+0002a7f0: 726e 696e 6720 6120 6e65 7720 4c61 7a79  rning a new Lazy
+0002a800: 5472 616e 7366 6f72 6d65 7220 7069 7065  Transformer pipe
+0002a810: 6c69 6e65 2074 6861 7420 636f 6e74 6169  line that contai
+0002a820: 6e73 2074 6865 2062 6573 7420 6d6f 6465  ns the best mode
+0002a830: 6c20 7472 6169 6e65 6420 6f6e 2079 6f75  l trained on you
+0002a840: 7220 7472 6169 6e20 6461 7461 7365 7421  r train dataset!
+0002a850: 2729 0a20 2020 2020 2020 2072 6574 7572  ').        retur
+0002a860: 6e20 7365 6c66 0a23 2323 2323 2323 2323  n self.#########
+0002a870: 2323 2323 2323 2323 2323 2323 2323 2323  ################
+0002a880: 2323 2323 2323 2323 2323 2323 2323 2323  ################
+0002a890: 2323 2323 2323 2323 2323 2323 2323 2323  ################
+0002a8a0: 2323 2323 2323 2323 2323 2323 2323 2323  ################
+0002a8b0: 2323 2323 2323 2323 2323 230a 2320 5468  ###########.# Th
+0002a8c0: 6973 2069 7320 6e65 6564 6564 2074 6f20  is is needed to 
+0002a8d0: 6d61 6b65 2074 6869 7320 6120 7265 6775  make this a regu
+0002a8e0: 6c61 7220 7472 616e 7366 6f72 6d65 7220  lar transformer 
+0002a8f0: 2323 230a 636c 6173 7320 5954 7261 6e73  ###.class YTrans
+0002a900: 666f 726d 6572 2854 7261 6e73 666f 726d  former(Transform
+0002a910: 6572 4d69 7869 6e29 3a0a 2020 2020 6465  erMixin):.    de
+0002a920: 6620 5f5f 696e 6974 5f5f 2873 656c 662c  f __init__(self,
+0002a930: 2074 7261 6e73 666f 726d 6572 733d 7b7d   transformers={}
+0002a940: 2c20 7461 7267 6574 733d 5b5d 293a 0a20  , targets=[]):. 
+0002a950: 2020 2020 2020 2023 2073 746f 7265 2074         # store t
+0002a960: 6865 206e 756d 6265 7220 6f66 2064 696d  he number of dim
+0002a970: 656e 7369 6f6e 206f 6620 7468 6520 7461  ension of the ta
+0002a980: 7267 6574 2074 6f20 7072 6564 6963 7420  rget to predict 
+0002a990: 616e 2061 7272 6179 206f 660a 2020 2020  an array of.    
+0002a9a0: 2020 2020 2320 7369 6d69 6c61 7220 7368      # similar sh
+0002a9b0: 6170 6520 6174 2070 7265 6469 6374 0a20  ape at predict. 
+0002a9c0: 2020 2020 2020 2073 656c 662e 7472 616e         self.tran
+0002a9d0: 7366 6f72 6d65 7273 203d 2020 7472 616e  sformers =  tran
+0002a9e0: 7366 6f72 6d65 7273 0a20 2020 2020 2020  sformers.       
+0002a9f0: 2073 656c 662e 7461 7267 6574 7320 3d20   self.targets = 
+0002aa00: 7461 7267 6574 730a 2020 2020 2020 2020  targets.        
+0002aa10: 0a20 2020 2064 6566 2067 6574 5f70 6172  .    def get_par
+0002aa20: 616d 7328 7365 6c66 2c20 6465 6570 3d54  ams(self, deep=T
+0002aa30: 7275 6529 3a0a 2020 2020 2020 2020 2320  rue):.        # 
+0002aa40: 5468 6973 2069 7320 746f 206d 616b 6520  This is to make 
+0002aa50: 6974 2073 6369 6b69 742d 6c65 6172 6e20  it scikit-learn 
+0002aa60: 636f 6d70 6174 6962 6c65 2023 2323 230a  compatible ####.
+0002aa70: 2020 2020 2020 2020 7265 7475 726e 207b          return {
+0002aa80: 2274 7261 6e73 666f 726d 6572 7322 3a20  "transformers": 
+0002aa90: 7365 6c66 2e74 7261 6e73 666f 726d 6572  self.transformer
+0002aaa0: 732c 2022 7461 7267 6574 7322 3a20 7365  s, "targets": se
+0002aab0: 6c66 2e74 6172 6765 7473 7d0a 0a20 2020  lf.targets}..   
+0002aac0: 2064 6566 2073 6574 5f70 6172 616d 7328   def set_params(
+0002aad0: 7365 6c66 2c20 2a2a 7061 7261 6d65 7465  self, **paramete
+0002aae0: 7273 293a 0a20 2020 2020 2020 2066 6f72  rs):.        for
+0002aaf0: 2070 6172 616d 6574 6572 2c20 7661 6c75   parameter, valu
+0002ab00: 6520 696e 2070 6172 616d 6574 6572 732e  e in parameters.
+0002ab10: 6974 656d 7328 293a 0a20 2020 2020 2020  items():.       
+0002ab20: 2020 2020 2073 6574 6174 7472 2873 656c       setattr(sel
+0002ab30: 662c 2070 6172 616d 6574 6572 2c20 7661  f, parameter, va
+0002ab40: 6c75 6529 0a20 2020 2020 2020 2072 6574  lue).        ret
+0002ab50: 7572 6e20 7365 6c66 0a0a 2020 2020 6465  urn self..    de
+0002ab60: 6620 6669 7428 7365 6c66 2c20 7929 3a0a  f fit(self, y):.
+0002ab70: 2020 2020 2020 2020 2222 2246 6974 2074          """Fit t
+0002ab80: 6865 206d 6f64 656c 2061 6363 6f72 6469  he model accordi
+0002ab90: 6e67 2074 6f20 7468 6520 6769 7665 6e20  ng to the given 
+0002aba0: 7472 6169 6e69 6e67 2064 6174 6122 2222  training data"""
+0002abb0: 2020 2020 2020 2020 0a20 2020 2020 2020          .       
+0002abc0: 2023 2074 7261 6e73 666f 726d 6572 7320   # transformers 
+0002abd0: 6172 6520 6465 7369 676e 6564 2074 6f20  are designed to 
+0002abe0: 6d6f 6469 6679 2058 2077 6869 6368 2069  modify X which i
+0002abf0: 7320 3264 2064 696d 656e 7369 6f6e 616c  s 2d dimensional
+0002ac00: 2c20 7765 0a20 2020 2020 2020 2023 206e  , we.        # n
+0002ac10: 6565 6420 746f 206d 6f64 6966 7920 7920  eed to modify y 
+0002ac20: 6163 636f 7264 696e 676c 792e 0a20 2020  accordingly..   
+0002ac30: 2020 2020 2069 6620 6973 696e 7374 616e       if isinstan
+0002ac40: 6365 2879 2c20 7064 2e53 6572 6965 7329  ce(y, pd.Series)
+0002ac50: 3a0a 2020 2020 2020 2020 2020 2020 6966  :.            if
+0002ac60: 2079 2e6e 616d 6520 6e6f 7420 696e 2073   y.name not in s
+0002ac70: 656c 662e 7461 7267 6574 733a 0a20 2020  elf.targets:.   
+0002ac80: 2020 2020 2020 2020 2020 2020 2073 656c               sel
+0002ac90: 662e 7461 7267 6574 732e 6170 7065 6e64  f.targets.append
+0002aca0: 2879 2e6e 616d 6529 0a20 2020 2020 2020  (y.name).       
+0002acb0: 2065 6c69 6620 6973 696e 7374 616e 6365   elif isinstance
+0002acc0: 2879 2c20 7064 2e44 6174 6146 7261 6d65  (y, pd.DataFrame
+0002acd0: 293a 0a20 2020 2020 2020 2020 2020 2073  ):.            s
+0002ace0: 656c 662e 7461 7267 6574 7320 2b3d 2079  elf.targets += y
+0002acf0: 2e63 6f6c 756d 6e73 2e74 6f6c 6973 7428  .columns.tolist(
+0002ad00: 290a 2020 2020 2020 2020 2020 2020 7365  ).            se
+0002ad10: 6c66 2e74 6172 6765 7473 203d 2066 696e  lf.targets = fin
+0002ad20: 645f 7265 6d6f 7665 5f64 7570 6c69 6361  d_remove_duplica
+0002ad30: 7465 7328 7365 6c66 2e74 6172 6765 7473  tes(self.targets
+0002ad40: 290a 2020 2020 2020 2020 2320 7472 616e  ).        # tran
+0002ad50: 7366 6f72 6d20 7920 616e 6420 636f 6e76  sform y and conv
+0002ad60: 6572 7420 6261 636b 2074 6f20 3164 2061  ert back to 1d a
+0002ad70: 7272 6179 2069 6620 6e65 6564 6564 0a20  rray if needed. 
+0002ad80: 2020 2020 2020 2069 6620 6973 696e 7374         if isinst
+0002ad90: 616e 6365 2879 2c20 7064 2e53 6572 6965  ance(y, pd.Serie
+0002ada0: 7329 3a0a 2020 2020 2020 2020 2020 2020  s):.            
+0002adb0: 795f 3164 203d 2079 2e76 616c 7565 730a  y_1d = y.values.
+0002adc0: 2020 2020 2020 2020 2020 2020 7920 3d20              y = 
+0002add0: 7064 2e44 6174 6146 7261 6d65 2879 5f31  pd.DataFrame(y_1
+0002ade0: 642c 2063 6f6c 756d 6e73 3d73 656c 662e  d, columns=self.
+0002adf0: 7461 7267 6574 7329 0a20 2020 2020 2020  targets).       
+0002ae00: 2065 6c69 6620 6973 696e 7374 616e 6365   elif isinstance
+0002ae10: 2879 2c20 7064 2e44 6174 6146 7261 6d65  (y, pd.DataFrame
+0002ae20: 293a 0a20 2020 2020 2020 2020 2020 2079  ):.            y
+0002ae30: 5f31 6420 3d20 792e 7661 6c75 6573 0a20  _1d = y.values. 
+0002ae40: 2020 2020 2020 2023 795f 3164 203d 2063         #y_1d = c
+0002ae50: 6f6c 756d 6e5f 6f72 5f31 6428 795f 3164  olumn_or_1d(y_1d
+0002ae60: 290a 2020 2020 2020 2020 666f 7220 692c  ).        for i,
+0002ae70: 2065 6163 685f 7461 7267 6574 2069 6e20   each_target in 
+0002ae80: 656e 756d 6572 6174 6528 7365 6c66 2e74  enumerate(self.t
+0002ae90: 6172 6765 7473 293a 0a20 2020 2020 2020  argets):.       
+0002aea0: 2020 2020 206c 6220 3d20 4d79 5f4c 6162       lb = My_Lab
+0002aeb0: 656c 456e 636f 6465 7228 290a 2020 2020  elEncoder().    
+0002aec0: 2020 2020 2020 2020 6c62 2e66 6974 2879          lb.fit(y
+0002aed0: 2e69 6c6f 635b 3a2c 695d 290a 2020 2020  .iloc[:,i]).    
+0002aee0: 2020 2020 2020 2020 7365 6c66 2e74 7261          self.tra
+0002aef0: 6e73 666f 726d 6572 735b 6561 6368 5f74  nsformers[each_t
+0002af00: 6172 6765 745d 203d 206c 620a 2020 2020  arget] = lb.    
+0002af10: 2020 2020 7265 7475 726e 2073 656c 660a      return self.
+0002af20: 2020 2020 0a20 2020 2064 6566 2074 7261      .    def tra
+0002af30: 6e73 666f 726d 2873 656c 662c 2079 293a  nsform(self, y):
+0002af40: 0a20 2020 2020 2020 2074 6172 6765 745f  .        target_
+0002af50: 6c65 6e20 3d20 6c65 6e28 7365 6c66 2e74  len = len(self.t
+0002af60: 6172 6765 7473 2920 2d20 310a 2020 2020  argets) - 1.    
+0002af70: 2020 2020 6966 2079 2069 7320 4e6f 6e65      if y is None
+0002af80: 3a0a 2020 2020 2020 2020 2020 2020 7265  :.            re
+0002af90: 7475 726e 2079 0a20 2020 2020 2020 2065  turn y.        e
+0002afa0: 6c73 653a 0a20 2020 2020 2020 2020 2020  lse:.           
+0002afb0: 2069 6620 6973 696e 7374 616e 6365 2879   if isinstance(y
+0002afc0: 2c20 7064 2e53 6572 6965 7329 3a0a 2020  , pd.Series):.  
+0002afd0: 2020 2020 2020 2020 2020 2020 2020 7920                y 
+0002afe0: 3d20 7064 2e44 6174 6146 7261 6d65 2879  = pd.DataFrame(y
+0002aff0: 290a 2020 2020 2020 2020 2020 2020 795f  ).            y_
+0002b000: 7472 616e 7320 3d20 636f 7079 2e64 6565  trans = copy.dee
+0002b010: 7063 6f70 7928 7929 0a20 2020 2020 2020  pcopy(y).       
+0002b020: 2020 2020 2066 6f72 2065 6163 685f 7461       for each_ta
+0002b030: 7267 6574 2069 6e20 7365 6c66 2e74 6172  rget in self.tar
+0002b040: 6765 7473 3a0a 2020 2020 2020 2020 2020  gets:.          
+0002b050: 2020 2020 2020 795f 7472 616e 735b 6561        y_trans[ea
+0002b060: 6368 5f74 6172 6765 745d 203d 2073 656c  ch_target] = sel
+0002b070: 662e 7472 616e 7366 6f72 6d65 7273 5b65  f.transformers[e
+0002b080: 6163 685f 7461 7267 6574 5d2e 7472 616e  ach_target].tran
+0002b090: 7366 6f72 6d28 795b 6561 6368 5f74 6172  sform(y[each_tar
+0002b0a0: 6765 745d 290a 2020 2020 2020 2020 2020  get]).          
+0002b0b0: 2020 7265 7475 726e 2079 5f74 7261 6e73    return y_trans
+0002b0c0: 0a20 2020 200a 2020 2020 6465 6620 6669  .    .    def fi
+0002b0d0: 745f 7472 616e 7366 6f72 6d28 7365 6c66  t_transform(self
+0002b0e0: 2c20 793d 4e6f 6e65 293a 0a20 2020 2020  , y=None):.     
+0002b0f0: 2020 2073 656c 662e 6669 7428 7929 0a20     self.fit(y). 
+0002b100: 2020 2020 2020 2069 6620 6973 696e 7374         if isinst
+0002b110: 616e 6365 2879 2c20 7064 2e53 6572 6965  ance(y, pd.Serie
+0002b120: 7329 3a0a 2020 2020 2020 2020 2020 2020  s):.            
+0002b130: 795f 7472 616e 7320 3d20 7365 6c66 2e74  y_trans = self.t
+0002b140: 7261 6e73 666f 726d 6572 735b 7365 6c66  ransformers[self
+0002b150: 2e74 6172 6765 7473 5b30 5d5d 2e74 7261  .targets[0]].tra
+0002b160: 6e73 666f 726d 2879 290a 2020 2020 2020  nsform(y).      
+0002b170: 2020 656c 6966 2069 7369 6e73 7461 6e63    elif isinstanc
+0002b180: 6528 792c 2070 642e 4461 7461 4672 616d  e(y, pd.DataFram
+0002b190: 6529 3a0a 2020 2020 2020 2020 2020 2020  e):.            
+0002b1a0: 795f 7472 616e 7320 3d20 636f 7079 2e64  y_trans = copy.d
+0002b1b0: 6565 7063 6f70 7928 7929 0a20 2020 2020  eepcopy(y).     
+0002b1c0: 2020 2020 2020 2066 6f72 2065 6163 685f         for each_
+0002b1d0: 7461 7267 6574 2069 6e20 7365 6c66 2e74  target in self.t
+0002b1e0: 6172 6765 7473 3a0a 2020 2020 2020 2020  argets:.        
+0002b1f0: 2020 2020 2020 2020 795f 7472 616e 735b          y_trans[
+0002b200: 6561 6368 5f74 6172 6765 745d 203d 2073  each_target] = s
+0002b210: 656c 662e 7472 616e 7366 6f72 6d65 7273  elf.transformers
+0002b220: 5b65 6163 685f 7461 7267 6574 5d2e 7472  [each_target].tr
+0002b230: 616e 7366 6f72 6d28 795b 6561 6368 5f74  ansform(y[each_t
+0002b240: 6172 6765 745d 290a 2020 2020 2020 2020  arget]).        
+0002b250: 656c 7365 3a0a 2020 2020 2020 2020 2020  else:.          
+0002b260: 2020 7072 696e 7428 2745 7272 6f72 3a20    print('Error: 
+0002b270: 4361 6e6e 6f74 2074 7261 6e73 666f 726d  Cannot transform
+0002b280: 206e 756d 7079 2061 7272 6179 732e 2052   numpy arrays. R
+0002b290: 6574 7572 6e69 6e67 2729 0a20 2020 2020  eturning').     
+0002b2a0: 2020 2020 2020 2072 6574 7572 6e20 790a         return y.
+0002b2b0: 2020 2020 2020 2020 7265 7475 726e 2079          return y
+0002b2c0: 5f74 7261 6e73 0a20 2020 200a 2020 2020  _trans.    .    
+0002b2d0: 6465 6620 696e 7665 7273 655f 7472 616e  def inverse_tran
+0002b2e0: 7366 6f72 6d28 7365 6c66 2c20 7929 3a0a  sform(self, y):.
+0002b2f0: 2020 2020 2020 2020 666f 7220 692c 2065          for i, e
+0002b300: 6163 685f 7461 7267 6574 2069 6e20 656e  ach_target in en
+0002b310: 756d 6572 6174 6528 7365 6c66 2e74 6172  umerate(self.tar
+0002b320: 6765 7473 293a 0a20 2020 2020 2020 2020  gets):.         
+0002b330: 2020 2069 6620 6920 3d3d 2030 3a0a 2020     if i == 0:.  
+0002b340: 2020 2020 2020 2020 2020 2020 2020 7472                tr
+0002b350: 616e 7366 6f72 6d65 725f 203d 2073 656c  ansformer_ = sel
+0002b360: 662e 7472 616e 7366 6f72 6d65 7273 5b65  f.transformers[e
+0002b370: 6163 685f 7461 7267 6574 5d0a 2020 2020  ach_target].    
+0002b380: 2020 2020 2020 2020 2020 2020 6966 2069              if i
+0002b390: 7369 6e73 7461 6e63 6528 792c 2070 642e  sinstance(y, pd.
+0002b3a0: 5365 7269 6573 293a 0a20 2020 2020 2020  Series):.       
+0002b3b0: 2020 2020 2020 2020 2020 2020 2079 203d               y =
+0002b3c0: 2070 642e 4461 7461 4672 616d 6528 792c   pd.DataFrame(y,
+0002b3d0: 2063 6f6c 756d 6e73 3d73 656c 662e 7461   columns=self.ta
+0002b3e0: 7267 6574 7329 0a20 2020 2020 2020 2020  rgets).         
+0002b3f0: 2020 2020 2020 2065 6c69 6620 6973 696e         elif isin
+0002b400: 7374 616e 6365 2879 2c20 6e70 2e6e 6461  stance(y, np.nda
+0002b410: 7272 6179 293a 0a20 2020 2020 2020 2020  rray):.         
+0002b420: 2020 2020 2020 2020 2020 2079 203d 2070             y = p
+0002b430: 642e 4461 7461 4672 616d 6528 792c 2063  d.DataFrame(y, c
+0002b440: 6f6c 756d 6e73 3d73 656c 662e 7461 7267  olumns=self.targ
+0002b450: 6574 7329 0a20 2020 2020 2020 2020 2020  ets).           
+0002b460: 2020 2020 2065 6c73 653a 0a20 2020 2020       else:.     
+0002b470: 2020 2020 2020 2020 2020 2020 2020 2023                 #
+0002b480: 2323 2069 6620 6974 2069 7320 6120 6461  ## if it is a da
+0002b490: 7461 6672 616d 6520 7468 656e 206c 6561  taframe then lea
+0002b4a0: 7665 2069 7420 616c 6f6e 6520 2323 0a20  ve it alone ##. 
+0002b4b0: 2020 2020 2020 2020 2020 2020 2020 2020                  
+0002b4c0: 2020 2070 6173 730a 2020 2020 2020 2020     pass.        
+0002b4d0: 2020 2020 2020 2020 795f 7420 3d20 7472          y_t = tr
+0002b4e0: 616e 7366 6f72 6d65 725f 2e69 6e76 6572  ansformer_.inver
+0002b4f0: 7365 5f74 7261 6e73 666f 726d 2879 2e76  se_transform(y.v
+0002b500: 616c 7565 735b 3a2c 695d 290a 2020 2020  alues[:,i]).    
+0002b510: 2020 2020 2020 2020 2020 2020 795f 7472              y_tr
+0002b520: 616e 7320 3d20 7064 2e53 6572 6965 7328  ans = pd.Series(
+0002b530: 795f 742c 6e61 6d65 3d65 6163 685f 7461  y_t,name=each_ta
+0002b540: 7267 6574 290a 2020 2020 2020 2020 2020  rget).          
+0002b550: 2020 656c 7365 3a0a 2020 2020 2020 2020    else:.        
+0002b560: 2020 2020 2020 2020 7472 616e 7366 6f72          transfor
+0002b570: 6d65 725f 203d 2073 656c 662e 7472 616e  mer_ = self.tran
+0002b580: 7366 6f72 6d65 7273 5b65 6163 685f 7461  sformers[each_ta
+0002b590: 7267 6574 5d0a 2020 2020 2020 2020 2020  rget].          
+0002b5a0: 2020 2020 2020 795f 7420 3d20 7472 616e        y_t = tran
+0002b5b0: 7366 6f72 6d65 725f 2e69 6e76 6572 7365  sformer_.inverse
+0002b5c0: 5f74 7261 6e73 666f 726d 2879 2e76 616c  _transform(y.val
+0002b5d0: 7565 735b 3a2c 695d 290a 2020 2020 2020  ues[:,i]).      
+0002b5e0: 2020 2020 2020 2020 2020 795f 7472 616e            y_tran
+0002b5f0: 7320 3d20 7064 2e44 6174 6146 7261 6d65  s = pd.DataFrame
+0002b600: 2879 5f74 7261 6e73 290a 2020 2020 2020  (y_trans).      
+0002b610: 2020 2020 2020 2020 2020 795f 7472 616e            y_tran
+0002b620: 735b 6561 6368 5f74 6172 6765 745d 203d  s[each_target] =
+0002b630: 2079 5f74 0a20 2020 2020 2020 2072 6574   y_t.        ret
+0002b640: 7572 6e20 795f 7472 616e 730a 2020 2020  urn y_trans.    
+0002b650: 0a20 2020 2064 6566 2070 7265 6469 6374  .    def predict
+0002b660: 2873 656c 662c 2079 3d4e 6f6e 652c 202a  (self, y=None, *
+0002b670: 2a66 6974 5f70 6172 616d 7329 3a0a 2020  *fit_params):.  
+0002b680: 2020 2020 2020 2370 7269 6e74 2827 5468        #print('Th
+0002b690: 6572 6520 6973 206e 6f20 7072 6564 6963  ere is no predic
+0002b6a0: 7420 6675 6e63 7469 6f6e 2069 6e20 4c61  t function in La
+0002b6b0: 6265 6c20 456e 636f 6465 722e 2052 6574  bel Encoder. Ret
+0002b6c0: 7572 6e69 6e67 2e2e 2e27 290a 2020 2020  urning...').    
+0002b6d0: 2020 2020 7265 7475 726e 2079 0a23 2323      return y.###
+0002b6e0: 2323 2323 2323 2323 2323 2323 2323 2323  ################
+0002b6f0: 2323 2323 2323 2323 2323 2323 2323 2323  ################
+0002b700: 2323 2323 2323 2323 2323 2323 2323 2323  ################
+0002b710: 2323 2323 2323 2323 2323 2323 2323 2323  ################
+0002b720: 2323 2323 2323 2323 2323 230a 6672 6f6d  ###########.from
+0002b730: 2063 6f6c 6c65 6374 696f 6e73 2069 6d70   collections imp
+0002b740: 6f72 7420 6465 6661 756c 7464 6963 740a  ort defaultdict.
+0002b750: 2320 5468 6973 2069 7320 6e65 6564 6564  # This is needed
+0002b760: 2074 6f20 6d61 6b65 2074 6869 7320 6120   to make this a 
+0002b770: 7265 6775 6c61 7220 7472 616e 7366 6f72  regular transfor
+0002b780: 6d65 7220 2323 230a 6672 6f6d 2073 6b6c  mer ###.from skl
+0002b790: 6561 726e 2e62 6173 6520 696d 706f 7274  earn.base import
+0002b7a0: 2042 6173 6545 7374 696d 6174 6f72 2c20   BaseEstimator, 
+0002b7b0: 5472 616e 7366 6f72 6d65 724d 6978 696e  TransformerMixin
+0002b7c0: 200a 636c 6173 7320 5261 7265 5f43 6c61   .class Rare_Cla
+0002b7d0: 7373 5f43 6f6d 6269 6e65 725f 5069 7065  ss_Combiner_Pipe
+0002b7e0: 2842 6173 6545 7374 696d 6174 6f72 2c20  (BaseEstimator, 
+0002b7f0: 5472 616e 7366 6f72 6d65 724d 6978 696e  TransformerMixin
+0002b800: 2029 3a0a 2020 2020 2222 220a 2020 2020   ):.    """.    
+0002b810: 5468 6973 2069 7320 7468 6520 7069 7065  This is the pipe
+0002b820: 6c69 6e65 2076 6572 7369 6f6e 206f 6620  line version of 
+0002b830: 7261 7265 2063 6c61 7373 2063 6f6d 6269  rare class combi
+0002b840: 6e65 7220 7573 6564 2069 6e20 736b 6c65  ner used in skle
+0002b850: 6172 6e20 7069 7065 6c69 6e65 732e 0a20  arn pipelines.. 
+0002b860: 2020 2022 2222 0a20 2020 2064 6566 205f     """.    def _
+0002b870: 5f69 6e69 745f 5f28 7365 6c66 2c20 7472  _init__(self, tr
+0002b880: 616e 7366 6f72 6d65 7273 3d7b 7d20 2029  ansformers={}  )
+0002b890: 3a0a 2020 2020 2020 2020 2320 7374 6f72  :.        # stor
+0002b8a0: 6520 7468 6520 6e75 6d62 6572 206f 6620  e the number of 
+0002b8b0: 6469 6d65 6e73 696f 6e20 6f66 2074 6865  dimension of the
+0002b8c0: 2074 6172 6765 7420 746f 2070 7265 6469   target to predi
+0002b8d0: 6374 2061 6e20 6172 7261 7920 6f66 0a20  ct an array of. 
+0002b8e0: 2020 2020 2020 2023 2073 696d 696c 6172         # similar
+0002b8f0: 2073 6861 7065 2061 7420 7072 6564 6963   shape at predic
+0002b900: 740a 2020 2020 2020 2020 7365 6c66 2e74  t.        self.t
+0002b910: 7261 6e73 666f 726d 6572 7320 3d20 2074  ransformers =  t
+0002b920: 7261 6e73 666f 726d 6572 730a 2020 2020  ransformers.    
+0002b930: 2020 2020 7365 6c66 2e7a 6572 6f5f 6c6f      self.zero_lo
+0002b940: 775f 636f 756e 7473 203d 2064 6566 6175  w_counts = defau
+0002b950: 6c74 6469 6374 2862 6f6f 6c29 0a20 2020  ltdict(bool).   
+0002b960: 2020 2020 200a 2020 2020 6465 6620 6765       .    def ge
+0002b970: 745f 7061 7261 6d73 2873 656c 662c 2064  t_params(self, d
+0002b980: 6565 703d 5472 7565 293a 0a20 2020 2020  eep=True):.     
+0002b990: 2020 2023 2054 6869 7320 6973 2074 6f20     # This is to 
+0002b9a0: 6d61 6b65 2069 7420 7363 696b 6974 2d6c  make it scikit-l
+0002b9b0: 6561 726e 2063 6f6d 7061 7469 626c 6520  earn compatible 
+0002b9c0: 2323 2323 0a20 2020 2020 2020 2072 6574  ####.        ret
+0002b9d0: 7572 6e20 7b22 7472 616e 7366 6f72 6d65  urn {"transforme
+0002b9e0: 7273 223a 2073 656c 662e 7472 616e 7366  rs": self.transf
+0002b9f0: 6f72 6d65 7273 7d0a 0a20 2020 2064 6566  ormers}..    def
+0002ba00: 2073 6574 5f70 6172 616d 7328 7365 6c66   set_params(self
+0002ba10: 2c20 2a2a 7061 7261 6d65 7465 7273 293a  , **parameters):
+0002ba20: 0a20 2020 2020 2020 2066 6f72 2070 6172  .        for par
+0002ba30: 616d 6574 6572 2c20 7661 6c75 6520 696e  ameter, value in
+0002ba40: 2070 6172 616d 6574 6572 732e 6974 656d   parameters.item
+0002ba50: 7328 293a 0a20 2020 2020 2020 2020 2020  s():.           
+0002ba60: 2073 6574 6174 7472 2873 656c 662c 2070   setattr(self, p
+0002ba70: 6172 616d 6574 6572 2c20 7661 6c75 6529  arameter, value)
+0002ba80: 0a20 2020 2020 2020 2072 6574 7572 6e20  .        return 
+0002ba90: 7365 6c66 0a0a 2020 2020 6465 6620 6669  self..    def fi
+0002baa0: 7428 7365 6c66 2c20 582c 2079 3d4e 6f6e  t(self, X, y=Non
+0002bab0: 652c 202a 2a66 6974 5f70 6172 616d 7329  e, **fit_params)
+0002bac0: 3a0a 2020 2020 2020 2020 2222 2246 6974  :.        """Fit
+0002bad0: 2074 6865 206d 6f64 656c 2061 6363 6f72   the model accor
+0002bae0: 6469 6e67 2074 6f20 7468 6520 6769 7665  ding to the give
+0002baf0: 6e20 7472 6169 6e69 6e67 2064 6174 6122  n training data"
+0002bb00: 2222 2020 2020 2020 2020 0a20 2020 2020  ""        .     
+0002bb10: 2020 2023 2074 7261 6e73 666f 726d 6572     # transformer
+0002bb20: 7320 6e65 6564 2061 2064 6566 6175 6c74  s need a default
+0002bb30: 206e 616d 6520 666f 7220 7261 7265 2063   name for rare c
+0002bb40: 6174 6567 6f72 6965 7320 2323 0a20 2020  ategories ##.   
+0002bb50: 2020 2020 2064 6566 2072 6574 7572 6e5f       def return_
+0002bb60: 6361 745f 7661 6c75 6528 293a 0a20 2020  cat_value():.   
+0002bb70: 2020 2020 2020 2020 2072 6574 7572 6e20           return 
+0002bb80: 2272 6172 655f 6361 7465 676f 7269 6573  "rare_categories
+0002bb90: 220a 2020 2020 2020 2020 2323 2320 496e  ".        ### In
+0002bba0: 2074 6869 7320 6361 7365 2058 2069 7473   this case X its
+0002bbb0: 656c 6620 7769 6c6c 206f 6e6c 7920 6265  elf will only be
+0002bbc0: 2061 2070 642e 5365 7269 6573 2023 2323   a pd.Series ###
+0002bbd0: 0a20 2020 2020 2020 2065 6163 685f 6361  .        each_ca
+0002bbe0: 7476 6172 203d 2058 2e6e 616d 650a 2020  tvar = X.name.  
+0002bbf0: 2020 2020 2020 2323 2323 2069 6620 6974        #### if it
+0002bc00: 2069 7320 616c 7265 6164 7920 6120 6c69   is already a li
+0002bc10: 7374 2c20 7468 656e 206c 6561 7665 2069  st, then leave i
+0002bc20: 7420 6173 2069 7320 2323 230a 2020 2020  t as is ###.    
+0002bc30: 2020 2020 7365 6c66 2e74 7261 6e73 666f      self.transfo
+0002bc40: 726d 6572 735b 6561 6368 5f63 6174 7661  rmers[each_catva
+0002bc50: 725d 203d 2064 6566 6175 6c74 6469 6374  r] = defaultdict
+0002bc60: 2872 6574 7572 6e5f 6361 745f 7661 6c75  (return_cat_valu
+0002bc70: 6529 0a20 2020 2020 2020 2023 2323 2054  e).        ### T
+0002bc80: 6865 6e20 6669 6e64 2074 6865 2075 6e69  hen find the uni
+0002bc90: 7175 6520 6361 7465 676f 7269 6573 2069  que categories i
+0002bca0: 6e20 7468 6520 636f 6c75 6d6e 2023 2323  n the column ###
+0002bcb0: 0a20 2020 2020 2020 2073 656c 662e 7472  .        self.tr
+0002bcc0: 616e 7366 6f72 6d65 7273 5b65 6163 685f  ansformers[each_
+0002bcd0: 6361 7476 6172 5d20 3d20 6469 6374 287a  catvar] = dict(z
+0002bce0: 6970 2858 2e75 6e69 7175 6528 292c 2058  ip(X.unique(), X
+0002bcf0: 2e75 6e69 7175 6528 2929 290a 2020 2020  .unique())).    
+0002bd00: 2020 2020 6c6f 775f 636f 756e 7473 203d      low_counts =
+0002bd10: 2070 642e 4461 7461 4672 616d 6528 5829   pd.DataFrame(X)
+0002bd20: 2e61 7070 6c79 286c 616d 6264 6120 783a  .apply(lambda x:
+0002bd30: 2078 2e76 616c 7565 5f63 6f75 6e74 7328   x.value_counts(
+0002bd40: 295b 0a20 2020 2020 2020 2020 2020 2020  )[.             
+0002bd50: 2020 2028 782e 7661 6c75 655f 636f 756e     (x.value_coun
+0002bd60: 7473 2829 3c3d 2830 2e30 312a 782e 7368  ts()<=(0.01*x.sh
+0002bd70: 6170 655b 305d 2929 2e76 616c 7565 735d  ape[0])).values]
+0002bd80: 2e69 6e64 6578 292e 7661 6c75 6573 2e72  .index).values.r
+0002bd90: 6176 656c 2829 0a20 2020 2020 2020 200a  avel().        .
+0002bda0: 2020 2020 2020 2020 6966 206c 656e 286c          if len(l
+0002bdb0: 6f77 5f63 6f75 6e74 7329 203d 3d20 303a  ow_counts) == 0:
+0002bdc0: 0a20 2020 2020 2020 2020 2020 2073 656c  .            sel
+0002bdd0: 662e 7a65 726f 5f6c 6f77 5f63 6f75 6e74  f.zero_low_count
+0002bde0: 735b 6561 6368 5f63 6174 7661 725d 203d  s[each_catvar] =
+0002bdf0: 2054 7275 650a 2020 2020 2020 2020 656c   True.        el
+0002be00: 7365 3a0a 2020 2020 2020 2020 2020 2020  se:.            
+0002be10: 7365 6c66 2e7a 6572 6f5f 6c6f 775f 636f  self.zero_low_co
+0002be20: 756e 7473 5b65 6163 685f 6361 7476 6172  unts[each_catvar
+0002be30: 5d20 3d20 4661 6c73 650a 2020 2020 2020  ] = False.      
+0002be40: 2020 666f 7220 6561 6368 5f6c 6f77 2069    for each_low i
+0002be50: 6e20 6c6f 775f 636f 756e 7473 3a0a 2020  n low_counts:.  
+0002be60: 2020 2020 2020 2020 2020 7365 6c66 2e74            self.t
+0002be70: 7261 6e73 666f 726d 6572 735b 6561 6368  ransformers[each
+0002be80: 5f63 6174 7661 725d 2e75 7064 6174 6528  _catvar].update(
+0002be90: 7b65 6163 685f 6c6f 773a 2772 6172 655f  {each_low:'rare_
+0002bea0: 6361 7465 676f 7269 6573 277d 290a 2020  categories'}).  
+0002beb0: 2020 2020 2020 7265 7475 726e 2073 656c        return sel
+0002bec0: 660a 2020 2020 0a20 2020 2064 6566 2074  f.    .    def t
+0002bed0: 7261 6e73 666f 726d 2873 656c 662c 2058  ransform(self, X
+0002bee0: 2c20 793d 4e6f 6e65 2c20 2a2a 6669 745f  , y=None, **fit_
+0002bef0: 7061 7261 6d73 293a 0a20 2020 2020 2020  params):.       
+0002bf00: 2065 6163 685f 6361 7476 6172 203d 2058   each_catvar = X
+0002bf10: 2e6e 616d 650a 2020 2020 2020 2020 6966  .name.        if
+0002bf20: 2073 656c 662e 7a65 726f 5f6c 6f77 5f63   self.zero_low_c
+0002bf30: 6f75 6e74 735b 6561 6368 5f63 6174 7661  ounts[each_catva
+0002bf40: 725d 3a0a 2020 2020 2020 2020 2020 2020  r]:.            
+0002bf50: 7061 7373 0a20 2020 2020 2020 2065 6c73  pass.        els
+0002bf60: 653a 0a20 2020 2020 2020 2020 2020 2058  e:.            X
+0002bf70: 203d 2058 2e6d 6170 2873 656c 662e 7472   = X.map(self.tr
+0002bf80: 616e 7366 6f72 6d65 7273 5b65 6163 685f  ansformers[each_
+0002bf90: 6361 7476 6172 5d29 0a20 2020 2020 2020  catvar]).       
+0002bfa0: 2020 2020 2023 2323 2073 696d 706c 7920       ### simply 
+0002bfb0: 6669 6c6c 2069 6e20 7468 6520 6d69 7373  fill in the miss
+0002bfc0: 696e 6720 7661 6c75 6573 2077 6974 6820  ing values with 
+0002bfd0: 7468 6520 776f 7264 2022 6d69 7373 696e  the word "missin
+0002bfe0: 6722 2023 230a 2020 2020 2020 2020 2020  g" ##.          
+0002bff0: 2020 5820 3d20 582e 6669 6c6c 6e61 2827    X = X.fillna('
+0002c000: 6d69 7373 696e 6727 2c69 6e70 6c61 6365  missing',inplace
+0002c010: 3d46 616c 7365 290a 2020 2020 2020 2020  =False).        
+0002c020: 7265 7475 726e 2058 0a0a 2020 2020 6465  return X..    de
+0002c030: 6620 6669 745f 7472 616e 7366 6f72 6d28  f fit_transform(
+0002c040: 7365 6c66 2c20 582c 2079 3d4e 6f6e 652c  self, X, y=None,
+0002c050: 202a 2a66 6974 5f70 6172 616d 7329 3a0a   **fit_params):.
+0002c060: 2020 2020 2020 2020 2323 2320 5369 6e63          ### Sinc
+0002c070: 6520 5820 666f 7220 7954 2069 6e20 6120  e X for yT in a 
+0002c080: 7069 7065 6c69 6e65 2069 7320 7365 6e74  pipeline is sent
+0002c090: 2061 7320 582c 2077 6520 6e65 6564 2074   as X, we need t
+0002c0a0: 6f20 7377 6974 6368 2058 2061 6e64 2079  o switch X and y
+0002c0b0: 2074 6869 7320 7761 7920 2323 0a20 2020   this way ##.   
+0002c0c0: 2020 2020 2073 656c 662e 6669 7428 582c       self.fit(X,
+0002c0d0: 2079 290a 2020 2020 2020 2020 6561 6368   y).        each
+0002c0e0: 5f63 6174 7661 7220 3d20 582e 6e61 6d65  _catvar = X.name
+0002c0f0: 0a20 2020 2020 2020 2069 6620 7365 6c66  .        if self
+0002c100: 2e7a 6572 6f5f 6c6f 775f 636f 756e 7473  .zero_low_counts
+0002c110: 5b65 6163 685f 6361 7476 6172 5d3a 0a20  [each_catvar]:. 
+0002c120: 2020 2020 2020 2020 2020 2070 6173 730a             pass.
+0002c130: 2020 2020 2020 2020 656c 7365 3a0a 2020          else:.  
+0002c140: 2020 2020 2020 2020 2020 5820 3d20 582e            X = X.
+0002c150: 6d61 7028 7365 6c66 2e74 7261 6e73 666f  map(self.transfo
+0002c160: 726d 6572 735b 6561 6368 5f63 6174 7661  rmers[each_catva
+0002c170: 725d 290a 2020 2020 2020 2020 2020 2020  r]).            
+0002c180: 2323 2320 7369 6d70 6c79 2066 696c 6c20  ### simply fill 
+0002c190: 696e 2074 6865 206d 6973 7369 6e67 2076  in the missing v
+0002c1a0: 616c 7565 7320 7769 7468 2074 6865 2077  alues with the w
+0002c1b0: 6f72 6420 226d 6973 7369 6e67 2220 2323  ord "missing" ##
+0002c1c0: 0a20 2020 2020 2020 2020 2020 2058 203d  .            X =
+0002c1d0: 2058 2e66 696c 6c6e 6128 276d 6973 7369   X.fillna('missi
+0002c1e0: 6e67 272c 696e 706c 6163 653d 4661 6c73  ng',inplace=Fals
+0002c1f0: 6529 0a20 2020 2020 2020 2072 6574 7572  e).        retur
+0002c200: 6e20 580a 0a20 2020 2064 6566 2069 6e76  n X..    def inv
+0002c210: 6572 7365 5f74 7261 6e73 666f 726d 2873  erse_transform(s
+0002c220: 656c 662c 2058 2c20 2a2a 6669 745f 7061  elf, X, **fit_pa
+0002c230: 7261 6d73 293a 0a20 2020 2020 2020 2023  rams):.        #
+0002c240: 2323 204f 6e65 2070 726f 626c 656d 2077  ## One problem w
+0002c250: 6974 6820 7468 6973 2061 7070 726f 6163  ith this approac
+0002c260: 6820 6973 2074 6861 7420 796f 7520 6861  h is that you ha
+0002c270: 7665 2063 6f6d 6269 6e65 6420 6361 7465  ve combined cate
+0002c280: 676f 7269 6573 2069 6e74 6f20 6f6e 652e  gories into one.
+0002c290: 0a20 2020 2020 2020 2023 2323 2020 2059  .        ###   Y
+0002c2a0: 6f75 2063 616e 6e6f 7420 756e 636f 6d62  ou cannot uncomb
+0002c2b0: 696e 6520 7468 656d 2073 696e 6365 2074  ine them since t
+0002c2c0: 6865 7920 6e6f 206c 6f6e 6765 7220 6861  hey no longer ha
+0002c2d0: 7665 2061 2075 6e69 7175 6520 6361 7465  ve a unique cate
+0002c2e0: 676f 7279 2e20 0a20 2020 2020 2020 2023  gory. .        #
+0002c2f0: 2323 2020 2059 6f75 2077 696c 6c20 6765  ##   You will ge
+0002c300: 7420 6261 636b 2074 6865 206c 6173 7420  t back the last 
+0002c310: 7472 616e 7366 6f72 6d65 6420 6361 7465  transformed cate
+0002c320: 676f 7279 2077 6865 6e20 796f 7520 696e  gory when you in
+0002c330: 7665 7273 6520 7472 616e 7366 6f72 6d20  verse transform 
+0002c340: 6974 2e0a 2020 2020 2020 2020 6561 6368  it..        each
+0002c350: 5f63 6174 7661 7220 3d20 582e 6e61 6d65  _catvar = X.name
+0002c360: 0a20 2020 2020 2020 2074 7261 6e73 666f  .        transfo
+0002c370: 726d 6572 5f20 3d20 7365 6c66 2e74 7261  rmer_ = self.tra
+0002c380: 6e73 666f 726d 6572 735b 6561 6368 5f63  nsformers[each_c
+0002c390: 6174 7661 725d 0a20 2020 2020 2020 2072  atvar].        r
+0002c3a0: 6576 6572 7365 5f74 7261 6e73 666f 726d  everse_transform
+0002c3b0: 6572 5f20 3d20 6469 6374 285b 2879 2c78  er_ = dict([(y,x
+0002c3c0: 2920 666f 7220 2878 2c79 2920 696e 2074  ) for (x,y) in t
+0002c3d0: 7261 6e73 666f 726d 6572 5f2e 6974 656d  ransformer_.item
+0002c3e0: 7328 295d 290a 2020 2020 2020 2020 6966  s()]).        if
+0002c3f0: 2073 656c 662e 7a65 726f 5f6c 6f77 5f63   self.zero_low_c
+0002c400: 6f75 6e74 735b 6561 6368 5f63 6174 7661  ounts[each_catva
+0002c410: 725d 3a0a 2020 2020 2020 2020 2020 2020  r]:.            
+0002c420: 7061 7373 0a20 2020 2020 2020 2065 6c73  pass.        els
+0002c430: 653a 0a20 2020 2020 2020 2020 2020 2058  e:.            X
+0002c440: 5b65 6163 685f 6361 7476 6172 5d20 3d20  [each_catvar] = 
+0002c450: 585b 6561 6368 5f63 6174 7661 725d 2e6d  X[each_catvar].m
+0002c460: 6170 2872 6576 6572 7365 5f74 7261 6e73  ap(reverse_trans
+0002c470: 666f 726d 6572 5f29 2e76 616c 7565 730a  former_).values.
+0002c480: 2020 2020 2020 2020 7265 7475 726e 2058          return X
+0002c490: 0a20 2020 200a 2020 2020 6465 6620 7072  .    .    def pr
+0002c4a0: 6564 6963 7428 7365 6c66 2c20 582c 2079  edict(self, X, y
+0002c4b0: 3d4e 6f6e 652c 202a 2a66 6974 5f70 6172  =None, **fit_par
+0002c4c0: 616d 7329 3a0a 2020 2020 2020 2020 2370  ams):.        #p
+0002c4d0: 7269 6e74 2827 5468 6572 6520 6973 206e  rint('There is n
+0002c4e0: 6f20 7072 6564 6963 7420 6675 6e63 7469  o predict functi
+0002c4f0: 6f6e 2069 6e20 5261 7265 2063 6c61 7373  on in Rare class
+0002c500: 2063 6f6d 6269 6e65 722e 2052 6574 7572   combiner. Retur
+0002c510: 6e69 6e67 2e2e 2e27 290a 2020 2020 2020  ning...').      
+0002c520: 2020 7265 7475 726e 2058 0a23 2323 2323    return X.#####
+0002c530: 2323 2323 2323 2323 2323 2323 2323 2323  ################
+0002c540: 2323 2323 2323 2323 2323 2323 2323 2323  ################
+0002c550: 2323 2323 2323 2323 2323 2323 2323 2323  ################
+0002c560: 2323 2323 2323 2323 2323 2323 2323 2323  ################
+0002c570: 2323 2323 2323 2323 230a 696d 706f 7274  #########.import
+0002c580: 2063 6f70 790a 6465 6620 4544 415f 6669   copy.def EDA_fi
+0002c590: 6e64 5f72 656d 6f76 655f 636f 6c75 6d6e  nd_remove_column
+0002c5a0: 735f 7769 7468 5f69 6e66 696e 6974 7928  s_with_infinity(
+0002c5b0: 6466 2c20 7265 6d6f 7665 3d46 616c 7365  df, remove=False
+0002c5c0: 293a 0a20 2020 2022 2222 0a20 2020 2054  ):.    """.    T
+0002c5d0: 6869 7320 6675 6e63 7469 6f6e 2066 696e  his function fin
+0002c5e0: 6473 2061 6c6c 2063 6f6c 756d 6e73 2069  ds all columns i
+0002c5f0: 6e20 6120 6461 7461 6672 616d 6520 7468  n a dataframe th
+0002c600: 6174 2068 6176 6520 696e 6966 696e 6974  at have inifinit
+0002c610: 6520 7661 6c75 6573 2028 6e70 2e69 6e66  e values (np.inf
+0002c620: 206f 7220 2d6e 702e 696e 6629 0a20 2020   or -np.inf).   
+0002c630: 2049 7420 7265 7475 726e 7320 6120 6c69   It returns a li
+0002c640: 7374 206f 6620 636f 6c75 6d6e 206e 616d  st of column nam
+0002c650: 6573 2e20 4966 2074 6865 206c 6973 7420  es. If the list 
+0002c660: 6973 2065 6d70 7479 2c20 6974 206d 6561  is empty, it mea
+0002c670: 6e73 206e 6f20 636f 6c75 6d6e 7320 7765  ns no columns we
+0002c680: 7265 2066 6f75 6e64 2e0a 2020 2020 4966  re found..    If
+0002c690: 2072 656d 6f76 6520 666c 6167 2069 7320   remove flag is 
+0002c6a0: 7365 742c 2074 6865 6e20 6974 2072 6574  set, then it ret
+0002c6b0: 7572 6e73 2061 2073 6d61 6c6c 6572 2064  urns a smaller d
+0002c6c0: 6174 6166 7261 6d65 2077 6974 6820 696e  ataframe with in
+0002c6d0: 6620 636f 6c75 6d6e 7320 7265 6d6f 7665  f columns remove
+0002c6e0: 642e 0a20 2020 2022 2222 0a20 2020 206e  d..    """.    n
+0002c6f0: 756d 7320 3d20 6466 2e73 656c 6563 745f  ums = df.select_
+0002c700: 6474 7970 6573 2869 6e63 6c75 6465 3d27  dtypes(include='
+0002c710: 6e75 6d62 6572 2729 2e63 6f6c 756d 6e73  number').columns
+0002c720: 2e74 6f6c 6973 7428 290a 2020 2020 6466  .tolist().    df
+0002c730: 7820 3d20 6466 5b6e 756d 735d 0a20 2020  x = df[nums].   
+0002c740: 2073 756d 5f72 6f77 7320 3d20 6e70 2e69   sum_rows = np.i
+0002c750: 7369 6e66 2864 6678 292e 7661 6c75 6573  sinf(dfx).values
+0002c760: 2e73 756d 2829 0a20 2020 2061 6464 5f63  .sum().    add_c
+0002c770: 6f6c 7320 3d20 206c 6973 7428 6466 782e  ols =  list(dfx.
+0002c780: 636f 6c75 6d6e 732e 746f 5f73 6572 6965  columns.to_serie
+0002c790: 7328 295b 6e70 2e69 7369 6e66 2864 6678  s()[np.isinf(dfx
+0002c7a0: 292e 616e 7928 295d 290a 2020 2020 6966  ).any()]).    if
+0002c7b0: 2073 756d 5f72 6f77 7320 3e20 303a 0a20   sum_rows > 0:. 
+0002c7c0: 2020 2020 2020 2070 7269 6e74 2827 2020         print('  
+0002c7d0: 2020 7468 6572 6520 6172 6520 2564 2072    there are %d r
+0002c7e0: 6f77 7320 616e 6420 2564 2063 6f6c 756d  ows and %d colum
+0002c7f0: 6e73 2077 6974 6820 696e 6669 6e69 7479  ns with infinity
+0002c800: 2069 6e20 7468 656d 2e2e 2e27 2025 2873   in them...' %(s
+0002c810: 756d 5f72 6f77 732c 6c65 6e28 6164 645f  um_rows,len(add_
+0002c820: 636f 6c73 2929 290a 2020 2020 2020 2020  cols))).        
+0002c830: 6966 2072 656d 6f76 653a 0a20 2020 2020  if remove:.     
+0002c840: 2020 2020 2020 2023 2323 2068 6572 6520         ### here 
+0002c850: 796f 7520 6e65 6564 2074 6f20 7573 6520  you need to use 
+0002c860: 6466 2073 696e 6365 2074 6865 2077 686f  df since the who
+0002c870: 6c65 2064 6174 6173 6574 2069 7320 696e  le dataset is in
+0002c880: 766f 6c76 6564 2023 2323 0a20 2020 2020  volved ###.     
+0002c890: 2020 2020 2020 206e 6f63 6f6c 7320 3d20         nocols = 
+0002c8a0: 5b78 2066 6f72 2078 2069 6e20 6466 2e63  [x for x in df.c
+0002c8b0: 6f6c 756d 6e73 2069 6620 7820 6e6f 7420  olumns if x not 
+0002c8c0: 696e 2061 6464 5f63 6f6c 735d 0a20 2020  in add_cols].   
+0002c8d0: 2020 2020 2020 2020 2070 7269 6e74 2822           print("
+0002c8e0: 2020 2020 5368 6170 6520 6f66 2064 6174      Shape of dat
+0002c8f0: 6173 6574 2062 6566 6f72 6520 2573 2061  aset before %s a
+0002c900: 6e64 2061 6674 6572 2025 7320 7265 6d6f  nd after %s remo
+0002c910: 7669 6e67 2063 6f6c 756d 6e73 2077 6974  ving columns wit
+0002c920: 6820 696e 6669 6e69 7479 2220 2528 6466  h infinity" %(df
+0002c930: 2e73 6861 7065 2c28 6466 5b6e 6f63 6f6c  .shape,(df[nocol
+0002c940: 735d 2e73 6861 7065 2c29 2929 0a20 2020  s].shape,))).   
+0002c950: 2020 2020 2020 2020 2072 6574 7572 6e20           return 
+0002c960: 6466 5b6e 6f63 6f6c 735d 0a20 2020 2020  df[nocols].     
+0002c970: 2020 2065 6c73 653a 0a20 2020 2020 2020     else:.       
+0002c980: 2020 2020 2023 2320 7468 6973 2077 696c       ## this wil
+0002c990: 6c20 6265 2061 206c 6973 7420 6f66 2063  l be a list of c
+0002c9a0: 6f6c 756d 6e73 2077 6974 6820 696e 6669  olumns with infi
+0002c9b0: 6e69 7479 2023 2323 230a 2020 2020 2020  nity ####.      
+0002c9c0: 2020 2020 2020 7265 7475 726e 2061 6464        return add
+0002c9d0: 5f63 6f6c 730a 2020 2020 656c 7365 3a0a  _cols.    else:.
+0002c9e0: 2020 2020 2020 2020 2323 2074 6869 7320          ## this 
+0002c9f0: 7769 6c6c 2062 6520 616e 2065 6d70 7479  will be an empty
+0002ca00: 206c 6973 7420 6966 2074 6865 7265 2061   list if there a
+0002ca10: 7265 206e 6f20 636f 6c75 6d6e 7320 7769  re no columns wi
+0002ca20: 7468 2069 6e66 696e 6974 790a 2020 2020  th infinity.    
+0002ca30: 2020 2020 7265 7475 726e 2061 6464 5f63      return add_c
+0002ca40: 6f6c 730a 2323 2323 2323 2323 2323 2323  ols.############
+0002ca50: 2323 2323 2323 2323 2323 2323 2323 2323  ################
+0002ca60: 2323 2323 2323 2323 2323 2323 2323 2323  ################
+0002ca70: 2323 2323 2323 2323 2323 2323 2323 2323  ################
+0002ca80: 2323 2323 2323 2323 2323 2323 2323 2323  ################
+0002ca90: 2323 2323 2323 2323 0a64 6566 2063 6865  ########.def che
+0002caa0: 636b 5f69 665f 4750 555f 6578 6973 7473  ck_if_GPU_exists
+0002cab0: 2829 3a0a 2020 2020 7472 793a 0a20 2020  ():.    try:.   
+0002cac0: 2020 2020 206f 732e 656e 7669 726f 6e5b       os.environ[
+0002cad0: 274e 5649 4449 415f 5649 5349 424c 455f  'NVIDIA_VISIBLE_
+0002cae0: 4445 5649 4345 5327 5d0a 2020 2020 2020  DEVICES'].      
+0002caf0: 2020 7072 696e 7428 2747 5055 2061 6374    print('GPU act
+0002cb00: 6976 6520 6f6e 2074 6869 7320 6465 7669  ive on this devi
+0002cb10: 6365 2729 0a20 2020 2020 2020 2072 6574  ce').        ret
+0002cb20: 7572 6e20 5472 7565 0a20 2020 2065 7863  urn True.    exc
+0002cb30: 6570 743a 0a20 2020 2020 2020 2070 7269  ept:.        pri
+0002cb40: 6e74 2827 4e6f 2047 5055 2061 6374 6976  nt('No GPU activ
+0002cb50: 6520 6f6e 2074 6869 7320 6465 7669 6365  e on this device
+0002cb60: 2729 0a20 2020 2020 2020 2072 6574 7572  ').        retur
+0002cb70: 6e20 4661 6c73 650a 2323 2323 2323 2323  n False.########
+0002cb80: 2323 2323 2323 2323 2323 2323 2323 2323  ################
+0002cb90: 2323 2323 2323 2323 2323 2323 2323 2323  ################
+0002cba0: 2323 2323 2323 2323 2323 2323 2323 2323  ################
+0002cbb0: 2323 2323 2323 2323 2323 2323 2323 2323  ################
+0002cbc0: 2323 2323 2323 2323 2323 2323 2323 2323  ################
+0002cbd0: 2323 2323 0a23 2323 2320 2020 2020 2020  ####.####       
+0002cbe0: 2054 6869 7320 6973 2077 6865 7265 2053   This is where S
+0002cbf0: 554c 4f20 434c 4153 5349 4649 4552 2041  ULO CLASSIFIER A
+0002cc00: 4e44 2052 4547 5245 5353 4f52 2041 5245  ND REGRESSOR ARE
+0002cc10: 2044 4546 494e 4544 2020 2020 2020 2020   DEFINED        
+0002cc20: 2020 2323 2323 2323 2323 2323 2323 2323    ##############
+0002cc30: 230a 2323 2323 2323 2323 2323 2323 2323  #.##############
+0002cc40: 2323 2323 2323 2323 2323 2323 2323 2323  ################
+0002cc50: 2323 2323 2323 2323 2323 2323 2323 2323  ################
+0002cc60: 2323 2323 2323 2323 2323 2323 2323 2323  ################
+0002cc70: 2323 2323 2323 2323 2323 2323 2323 2323  ################
+0002cc80: 2323 2323 2323 2323 2323 2323 2323 0a63  ##############.c
+0002cc90: 6c61 7373 2053 756c 6f43 6c61 7373 6966  lass SuloClassif
+0002cca0: 6965 7228 4261 7365 4573 7469 6d61 746f  ier(BaseEstimato
+0002ccb0: 722c 2043 6c61 7373 6966 6965 724d 6978  r, ClassifierMix
+0002ccc0: 696e 293a 0a20 2020 2022 2222 0a20 2020  in):.    """.   
+0002ccd0: 2053 756c 6f43 6c61 7373 6966 6965 7220   SuloClassifier 
+0002cce0: 7374 616e 6473 2066 6f72 2053 7570 6572  stands for Super
+0002ccf0: 204c 6561 726e 696e 6720 4f70 7469 6d69   Learning Optimi
+0002cd00: 7a65 6420 2853 554c 4f29 2043 6c61 7373  zed (SULO) Class
+0002cd10: 6966 6965 722e 0a20 2020 202d 2d20 4974  ifier..    -- It
+0002cd20: 2077 6f72 6b73 206f 6e20 736d 616c 6c20   works on small 
+0002cd30: 6173 2077 656c 6c20 6173 2062 6967 2064  as well as big d
+0002cd40: 6174 612e 2049 7420 776f 726b 7320 696e  ata. It works in
+0002cd50: 2049 6e74 6567 6572 206d 6f64 6520 6173   Integer mode as
+0002cd60: 2077 656c 6c20 6173 2066 6c6f 6174 2d6d   well as float-m
+0002cd70: 6f64 652e 0a20 2020 202d 2d20 4974 2077  ode..    -- It w
+0002cd80: 6f72 6b73 206f 6e20 7265 6775 6c61 7220  orks on regular 
+0002cd90: 6261 6c61 6e63 6564 2064 6174 6120 6173  balanced data as
+0002cda0: 2077 656c 6c20 6173 2073 6b65 7765 6420   well as skewed 
+0002cdb0: 7265 6772 6573 7369 6f6e 2074 6172 6765  regression targe
+0002cdc0: 7473 2e0a 2020 2020 5468 6520 7265 6173  ts..    The reas
+0002cdd0: 6f6e 2069 7420 776f 726b 7320 736f 2077  on it works so w
+0002cde0: 656c 6c20 6973 2074 6861 7420 5375 6c6f  ell is that Sulo
+0002cdf0: 2069 7320 616e 2065 6e73 656d 626c 6520   is an ensemble 
+0002ce00: 6f66 2068 6967 686c 7920 7475 6e65 6420  of highly tuned 
+0002ce10: 6d6f 6465 6c73 2e0a 2020 2020 2d2d 2059  models..    -- Y
+0002ce20: 6f75 2064 6f6e 2774 2068 6176 6520 746f  ou don't have to
+0002ce30: 2073 656e 6420 616e 7920 696e 7075 7473   send any inputs
+0002ce40: 2062 7574 2069 6620 796f 7520 7761 6e74   but if you want
+0002ce50: 6564 2074 6f2c 2079 6f75 2063 616e 2073  ed to, you can s
+0002ce60: 7065 6669 6679 206d 756c 7469 706c 6520  pefify multiple 
+0002ce70: 6f70 7469 6f6e 732e 0a20 2020 2049 7420  options..    It 
+0002ce80: 6973 2066 756c 6c79 2063 6f6d 7061 7469  is fully compati
+0002ce90: 626c 6520 7769 7468 2073 6369 6b69 742d  ble with scikit-
+0002cea0: 6c65 6172 6e20 7069 7065 6c69 6e65 7320  learn pipelines 
+0002ceb0: 616e 6420 6f74 6865 7220 6d6f 6465 6c73  and other models
+0002cec0: 2e0a 0a20 2020 2053 796e 7461 783a 0a20  ...    Syntax:. 
+0002ced0: 2020 2020 2020 2073 756c 6f20 3d20 5375         sulo = Su
+0002cee0: 6c6f 436c 6173 7369 6669 6572 2862 6173  loClassifier(bas
+0002cef0: 655f 6573 7469 6d61 746f 723d 4e6f 6e65  e_estimator=None
+0002cf00: 2c20 6e5f 6573 7469 6d61 746f 7273 3d4e  , n_estimators=N
+0002cf10: 6f6e 652c 2070 6970 656c 696e 653d 5472  one, pipeline=Tr
+0002cf20: 7565 2c20 0a20 2020 2020 2020 2020 2020  ue, .           
+0002cf30: 2020 2020 2020 2020 2020 2020 2020 2020                  
+0002cf40: 2020 2020 2077 6569 6768 7473 3d46 616c       weights=Fal
+0002cf50: 7365 2c20 696d 6261 6c61 6e63 6564 3d46  se, imbalanced=F
+0002cf60: 616c 7365 2c20 7665 7262 6f73 653d 3029  alse, verbose=0)
+0002cf70: 0a20 2020 2020 2020 2073 756c 6f2e 6669  .        sulo.fi
+0002cf80: 7428 585f 7472 6169 6e2c 2079 5f74 7261  t(X_train, y_tra
+0002cf90: 696e 290a 2020 2020 2020 2020 795f 7072  in).        y_pr
+0002cfa0: 6564 7320 3d20 7375 6c6f 2e70 7265 6469  eds = sulo.predi
+0002cfb0: 6374 2858 5f74 6573 7429 0a0a 2020 2020  ct(X_test)..    
+0002cfc0: 496e 7075 7473 3a0a 2020 2020 2020 2020  Inputs:.        
+0002cfd0: 6e5f 6573 7469 6d61 746f 7273 3a20 6465  n_estimators: de
+0002cfe0: 6661 756c 7420 6973 204e 6f6e 652e 204e  fault is None. N
+0002cff0: 756d 6265 7220 6f66 206d 6f64 656c 7320  umber of models 
+0002d000: 796f 7520 7761 6e74 2069 6e20 7468 6520  you want in the 
+0002d010: 6669 6e61 6c20 656e 7365 6d62 6c65 2e0a  final ensemble..
+0002d020: 2020 2020 2020 2020 6261 7365 5f65 7374          base_est
+0002d030: 696d 6174 6f72 3a20 6465 6661 756c 7420  imator: default 
+0002d040: 6973 204e 6f6e 652e 2042 6173 6520 6d6f  is None. Base mo
+0002d050: 6465 6c20 796f 7520 7761 6e74 2074 6f20  del you want to 
+0002d060: 7472 6169 6e20 696e 2065 6163 6820 6f66  train in each of
+0002d070: 2074 6865 2065 6e73 656d 626c 6573 2e0a   the ensembles..
+0002d080: 2020 2020 2020 2020 7069 7065 6c69 6e65          pipeline
+0002d090: 3a20 6465 6661 756c 7420 6973 2046 616c  : default is Fal
+0002d0a0: 7365 2e20 4974 2077 696c 6c20 7472 616e  se. It will tran
+0002d0b0: 7366 6f72 6d20 616c 6c20 6461 7461 2074  sform all data t
+0002d0c0: 6f20 6e75 6d65 7269 6320 6175 746f 6d61  o numeric automa
+0002d0d0: 7469 6361 6c6c 7920 6966 2073 6574 2074  tically if set t
+0002d0e0: 6f20 5472 7565 2e0a 2020 2020 2020 2020  o True..        
+0002d0f0: 7765 6967 6874 733a 2064 6566 6175 6c74  weights: default
+0002d100: 2069 7320 4661 6c73 652e 2049 7420 7769   is False. It wi
+0002d110: 6c6c 2070 6572 666f 726d 2077 6569 6768  ll perform weigh
+0002d120: 7469 6e67 206f 6620 6469 6666 6572 656e  ting of differen
+0002d130: 7420 636c 6173 7369 6669 6572 7320 6966  t classifiers if
+0002d140: 2073 6574 2074 6f20 5472 7565 0a20 2020   set to True.   
+0002d150: 2020 2020 2069 6d62 616c 616e 6365 643a       imbalanced:
+0002d160: 2064 6566 6175 6c74 2069 7320 4661 6c73   default is Fals
+0002d170: 652e 2049 7420 7769 6c6c 2061 6374 6976  e. It will activ
+0002d180: 6174 6520 6120 7370 6563 6961 6c20 696d  ate a special im
+0002d190: 6261 6c61 6e63 6564 2063 6c61 7373 6966  balanced classif
+0002d1a0: 6965 7220 6966 2073 6574 2074 6f20 5472  ier if set to Tr
+0002d1b0: 7565 2e0a 2020 2020 2020 2020 7665 7262  ue..        verb
+0002d1c0: 6f73 653a 2064 6566 6175 6c74 2069 7320  ose: default is 
+0002d1d0: 302e 2049 7420 7769 6c6c 2070 7269 6e74  0. It will print
+0002d1e0: 2076 6572 626f 7365 206f 7574 7075 7420   verbose output 
+0002d1f0: 6966 2073 6574 2074 6f20 5472 7565 2e0a  if set to True..
+0002d200: 0a20 2020 204f 7574 7574 733a 0a20 2020  .    Oututs:.   
+0002d210: 2020 2020 2053 756c 6f43 6c61 7373 6966       SuloClassif
+0002d220: 6965 723a 2072 6574 7572 6e73 2061 2063  ier: returns a c
+0002d230: 6c61 7373 6966 6963 6174 696f 6e20 6d6f  lassification mo
+0002d240: 6465 6c20 6869 6768 6c79 2074 756e 6564  del highly tuned
+0002d250: 2074 6f20 796f 7572 2073 7065 6369 6669   to your specifi
+0002d260: 6320 6e65 6564 7320 616e 6420 6461 7461  c needs and data
+0002d270: 7365 742e 0a20 2020 2022 2222 0a20 2020  set..    """.   
+0002d280: 2064 6566 205f 5f69 6e69 745f 5f28 7365   def __init__(se
+0002d290: 6c66 2c20 6261 7365 5f65 7374 696d 6174  lf, base_estimat
+0002d2a0: 6f72 3d4e 6f6e 652c 206e 5f65 7374 696d  or=None, n_estim
+0002d2b0: 6174 6f72 733d 4e6f 6e65 2c20 7069 7065  ators=None, pipe
+0002d2c0: 6c69 6e65 3d54 7275 652c 2077 6569 6768  line=True, weigh
+0002d2d0: 7473 3d46 616c 7365 2c20 0a20 2020 2020  ts=False, .     
+0002d2e0: 2020 2020 2020 2020 2020 2020 2020 2020                  
+0002d2f0: 2020 2020 2020 2020 2020 2020 2020 2020                  
+0002d300: 2020 696d 6261 6c61 6e63 6564 3d46 616c    imbalanced=Fal
+0002d310: 7365 2c20 7665 7262 6f73 653d 3029 3a0a  se, verbose=0):.
+0002d320: 2020 2020 2020 2020 7365 6c66 2e6e 5f65          self.n_e
+0002d330: 7374 696d 6174 6f72 7320 3d20 6e5f 6573  stimators = n_es
+0002d340: 7469 6d61 746f 7273 0a20 2020 2020 2020  timators.       
+0002d350: 2073 656c 662e 6261 7365 5f65 7374 696d   self.base_estim
+0002d360: 6174 6f72 203d 2062 6173 655f 6573 7469  ator = base_esti
+0002d370: 6d61 746f 720a 2020 2020 2020 2020 7365  mator.        se
+0002d380: 6c66 2e70 6970 656c 696e 6520 3d20 7069  lf.pipeline = pi
+0002d390: 7065 6c69 6e65 0a20 2020 2020 2020 2073  peline.        s
+0002d3a0: 656c 662e 7765 6967 6874 7320 3d20 7765  elf.weights = we
+0002d3b0: 6967 6874 730a 2020 2020 2020 2020 7365  ights.        se
+0002d3c0: 6c66 2e69 6d62 616c 616e 6365 6420 3d20  lf.imbalanced = 
+0002d3d0: 696d 6261 6c61 6e63 6564 0a20 2020 2020  imbalanced.     
+0002d3e0: 2020 2073 656c 662e 7665 7262 6f73 6520     self.verbose 
+0002d3f0: 3d20 7665 7262 6f73 650a 2020 2020 2020  = verbose.      
+0002d400: 2020 7365 6c66 2e6d 6f64 656c 7320 3d20    self.models = 
+0002d410: 5b5d 0a20 2020 2020 2020 2073 656c 662e  [].        self.
+0002d420: 6d75 6c74 695f 6c61 6265 6c20 3d20 2046  multi_label =  F
+0002d430: 616c 7365 0a20 2020 2020 2020 2073 656c  alse.        sel
+0002d440: 662e 6d61 785f 6e75 6d62 6572 5f6f 665f  f.max_number_of_
+0002d450: 636c 6173 7365 7320 3d20 310a 2020 2020  classes = 1.    
+0002d460: 2020 2020 7365 6c66 2e73 636f 7265 7320      self.scores 
+0002d470: 3d20 5b5d 0a20 2020 2020 2020 2073 656c  = [].        sel
+0002d480: 662e 636c 6173 7365 7320 3d20 5b5d 0a20  f.classes = []. 
+0002d490: 2020 2020 2020 2073 656c 662e 7265 6772         self.regr
+0002d4a0: 6573 7369 6f6e 5f6d 696e 5f6d 6178 203d  ession_min_max =
+0002d4b0: 205b 5d0a 2020 2020 2020 2020 7365 6c66   [].        self
+0002d4c0: 2e6d 6f64 656c 5f6e 616d 6520 3d20 2727  .model_name = ''
+0002d4d0: 0a20 2020 2020 2020 2073 656c 662e 6665  .        self.fe
+0002d4e0: 6174 7572 6573 203d 205b 5d0a 0a20 2020  atures = []..   
+0002d4f0: 2064 6566 2072 6574 7572 6e5f 776f 7273   def return_wors
+0002d500: 745f 666f 6c64 2873 656c 662c 2058 293a  t_fold(self, X):
+0002d510: 0a20 2020 2020 2020 2022 2222 0a20 2020  .        """.   
+0002d520: 2020 2020 2054 6869 7320 6d65 7468 6f64       This method
+0002d530: 2072 6574 7572 6e73 2074 6865 2077 6f72   returns the wor
+0002d540: 7374 2070 6572 666f 726d 696e 6720 7472  st performing tr
+0002d550: 6169 6e20 616e 6420 7465 7374 2072 6f77  ain and test row
+0002d560: 7320 616d 6f6e 6720 616c 6c20 7468 6520  s among all the 
+0002d570: 666f 6c64 732e 0a20 2020 2020 2020 2054  folds..        T
+0002d580: 6869 7320 6973 2076 6572 7920 696d 706f  his is very impo
+0002d590: 7274 616e 7420 696e 666f 726d 6174 696f  rtant informatio
+0002d5a0: 6e20 7369 6e63 6520 6974 2068 656c 7073  n since it helps
+0002d5b0: 2061 6e20 4d4c 2065 6e67 696e 6565 7220   an ML engineer 
+0002d5c0: 6f72 2044 6174 6120 5363 6965 6e74 6973  or Data Scientis
+0002d5d0: 7420 0a20 2020 2020 2020 2020 2020 2074  t .            t
+0002d5e0: 6f20 7472 6f75 626c 6520 7368 6f6f 7420  o trouble shoot 
+0002d5f0: 636c 6173 7369 6669 6361 7469 6f6e 2070  classification p
+0002d600: 726f 626c 656d 732e 2049 7420 6865 6c70  roblems. It help
+0002d610: 7320 746f 2066 696e 6420 7768 6572 6520  s to find where 
+0002d620: 7468 6520 6d6f 6465 6c20 6973 2073 7472  the model is str
+0002d630: 7567 676c 696e 672e 0a0a 2020 2020 2020  uggling...      
+0002d640: 2020 496e 7075 7473 3a0a 2020 2020 2020    Inputs:.      
+0002d650: 2020 2d2d 2d2d 2d2d 2d2d 0a20 2020 2020    --------.     
+0002d660: 2020 2058 3a20 4461 7461 6672 616d 652e     X: Dataframe.
+0002d670: 2054 6869 7320 6d75 7374 2062 6520 7468   This must be th
+0002d680: 6520 6665 6174 7572 6573 2064 6174 6166  e features dataf
+0002d690: 7261 6d65 206f 6620 796f 7572 2064 6174  rame of your dat
+0002d6a0: 6173 6574 2e20 4974 2063 616e 6e6f 7420  aset. It cannot 
+0002d6b0: 6265 2061 206e 756d 7079 2061 7272 6179  be a numpy array
+0002d6c0: 2e0a 0a20 2020 2020 2020 204f 7574 7075  ...        Outpu
+0002d6d0: 7473 3a0a 2020 2020 2020 2020 2d2d 2d2d  ts:.        ----
+0002d6e0: 2d2d 2d2d 2d0a 2020 2020 2020 2020 7472  -----.        tr
+0002d6f0: 6169 6e5f 726f 7773 5f64 6174 6166 7261  ain_rows_datafra
+0002d700: 6d65 2c20 7465 7374 5f72 6f77 735f 6461  me, test_rows_da
+0002d710: 7461 6672 616d 653a 2044 6174 6166 7261  taframe: Datafra
+0002d720: 6d65 732e 200a 2020 2020 2020 2020 2020  mes. .          
+0002d730: 2020 2054 6869 7320 7265 7475 726e 7320     This returns 
+0002d740: 7468 6520 706f 7274 696f 6e20 6f66 2058  the portion of X
+0002d750: 2061 7320 7472 6169 6e20 616e 6420 7465   as train and te
+0002d760: 7374 2074 6f20 6865 6c70 2079 6f75 2075  st to help you u
+0002d770: 6e64 6572 7374 616e 6420 7768 6572 6520  nderstand where 
+0002d780: 6d6f 6465 6c20 7374 7275 6767 6c65 642e  model struggled.
+0002d790: 0a20 2020 2020 2020 2022 2222 0a20 2020  .        """.   
+0002d7a0: 2020 2020 2077 6f72 7374 5f66 6f6c 6420       worst_fold 
+0002d7b0: 3d20 6e70 2e61 7267 6d69 6e28 7365 6c66  = np.argmin(self
+0002d7c0: 2e73 636f 7265 7329 0a20 2020 2020 2020  .scores).       
+0002d7d0: 2066 6f72 2069 2c20 2874 722c 2074 7429   for i, (tr, tt)
+0002d7e0: 2069 6e20 656e 756d 6572 6174 6528 7365   in enumerate(se
+0002d7f0: 6c66 2e6b 662e 7370 6c69 7428 5829 293a  lf.kf.split(X)):
+0002d800: 0a20 2020 2020 2020 2020 2020 2069 6620  .            if 
+0002d810: 6920 3d3d 2077 6f72 7374 5f66 6f6c 643a  i == worst_fold:
+0002d820: 0a20 2020 2020 2020 2020 2020 2020 2020  .               
+0002d830: 2077 6f72 7374 5f74 7261 696e 5f72 6f77   worst_train_row
+0002d840: 7320 3d20 636f 7079 2e64 6565 7063 6f70  s = copy.deepcop
+0002d850: 7928 7472 290a 2020 2020 2020 2020 2020  y(tr).          
+0002d860: 2020 2020 2020 776f 7273 745f 7474 6573        worst_ttes
+0002d870: 745f 726f 7773 203d 2063 6f70 792e 6465  t_rows = copy.de
+0002d880: 6570 636f 7079 2874 7429 0a20 2020 2020  epcopy(tt).     
+0002d890: 2020 2020 2020 2020 2020 2070 7269 6e74             print
+0002d8a0: 2822 666f 6c64 2025 733a 2074 7261 696e  ("fold %s: train
+0002d8b0: 2072 6f77 7320 696e 6465 7820 3d20 2573   rows index = %s
+0002d8c0: 2e20 5375 6c6f 206d 6f64 656c 2073 7472  . Sulo model str
+0002d8d0: 7567 676c 6564 2069 6e20 7468 6973 2066  uggled in this f
+0002d8e0: 6f6c 642e 2220 2528 692b 312c 7472 2929  old." %(i+1,tr))
+0002d8f0: 0a20 2020 2020 2020 2020 2020 2065 6c73  .            els
+0002d900: 653a 0a20 2020 2020 2020 2020 2020 2020  e:.             
+0002d910: 2020 2070 7269 6e74 2822 666f 6c64 2025     print("fold %
+0002d920: 733a 2074 7261 696e 2072 6f77 7320 696e  s: train rows in
+0002d930: 6465 7820 3d20 2573 2220 2528 692b 312c  dex = %s" %(i+1,
+0002d940: 7472 2929 0a20 2020 2020 2020 2072 6574  tr)).        ret
+0002d950: 7572 6e20 582e 696c 6f63 5b77 6f72 7374  urn X.iloc[worst
+0002d960: 5f74 7261 696e 5f72 6f77 735d 2c20 582e  _train_rows], X.
+0002d970: 696c 6f63 5b77 6f72 7374 5f74 7465 7374  iloc[worst_ttest
+0002d980: 5f72 6f77 735d 0a0a 2020 2020 6465 6620  _rows]..    def 
+0002d990: 6669 7428 7365 6c66 2c20 582c 2079 293a  fit(self, X, y):
+0002d9a0: 0a20 2020 2020 2020 2058 203d 2063 6f70  .        X = cop
+0002d9b0: 792e 6465 6570 636f 7079 2858 290a 2020  y.deepcopy(X).  
+0002d9c0: 2020 2020 2020 7072 696e 7428 2749 6e70        print('Inp
+0002d9d0: 7574 2064 6174 6120 7368 6170 6573 3a20  ut data shapes: 
+0002d9e0: 5820 3d20 2573 2720 2528 582e 7368 6170  X = %s' %(X.shap
+0002d9f0: 652c 2929 0a20 2020 2020 2020 2070 7269  e,)).        pri
+0002da00: 6e74 2827 2020 2020 7920 7368 6170 6520  nt('    y shape 
+0002da10: 3d20 2573 2720 2528 792e 7368 6170 652c  = %s' %(y.shape,
+0002da20: 2929 0a20 2020 2020 2020 2073 6565 6420  )).        seed 
+0002da30: 3d20 3432 0a20 2020 2020 2020 2073 6875  = 42.        shu
+0002da40: 6666 6c65 466c 6167 203d 2054 7275 650a  ffleFlag = True.
+0002da50: 2020 2020 2020 2020 6d6f 6465 6c74 7970          modeltyp
+0002da60: 6520 3d20 2743 6c61 7373 6966 6963 6174  e = 'Classificat
+0002da70: 696f 6e27 0a20 2020 2020 2020 2066 6561  ion'.        fea
+0002da80: 7475 7265 735f 6c69 6d69 7420 3d20 3530  tures_limit = 50
+0002da90: 2023 2320 6966 2074 6865 7265 2061 7265   ## if there are
+0002daa0: 206d 6f72 6520 7468 616e 2035 3020 6665   more than 50 fe
+0002dab0: 6174 7572 6573 2069 6e20 6461 7461 7365  atures in datase
+0002dac0: 742c 2062 6574 7465 7220 746f 2075 7365  t, better to use
+0002dad0: 204c 4742 4d20 2323 0a20 2020 2020 2020   LGBM ##.       
+0002dae0: 2073 7461 7274 203d 2074 696d 652e 7469   start = time.ti
+0002daf0: 6d65 2829 0a20 2020 2020 2020 2069 6620  me().        if 
+0002db00: 6973 696e 7374 616e 6365 2858 2c20 7064  isinstance(X, pd
+0002db10: 2e44 6174 6146 7261 6d65 293a 0a20 2020  .DataFrame):.   
+0002db20: 2020 2020 2020 2020 2073 656c 662e 6665           self.fe
+0002db30: 6174 7572 6573 203d 2058 2e63 6f6c 756d  atures = X.colum
+0002db40: 6e73 2e74 6f6c 6973 7428 290a 2020 2020  ns.tolist().    
+0002db50: 2020 2020 656c 7365 3a0a 2020 2020 2020      else:.      
+0002db60: 2020 2020 2020 7072 696e 7428 2743 616e        print('Can
+0002db70: 6e6f 7420 6f70 6572 6174 6520 5375 6c6f  not operate Sulo
+0002db80: 436c 6173 7369 6669 6572 206f 6e20 6e75  Classifier on nu
+0002db90: 6d70 7920 6172 7261 7973 2e20 4d75 7374  mpy arrays. Must
+0002dba0: 2062 6520 6461 7461 6672 616d 6573 2e20   be dataframes. 
+0002dbb0: 5265 7475 726e 696e 672e 2e2e 2729 0a20  Returning...'). 
+0002dbc0: 2020 2020 2020 2020 2020 2072 6574 7572             retur
+0002dbd0: 6e20 7365 6c66 0a20 2020 2020 2020 2023  n self.        #
+0002dbe0: 2055 7365 204b 466f 6c64 2066 6f72 2075   Use KFold for u
+0002dbf0: 6e64 6572 7374 616e 6469 6e67 2074 6865  nderstanding the
+0002dc00: 2070 6572 666f 726d 616e 6365 0a20 2020   performance.   
+0002dc10: 2020 2020 2069 6620 7365 6c66 2e77 6569       if self.wei
+0002dc20: 6768 7473 3a0a 2020 2020 2020 2020 2020  ghts:.          
+0002dc30: 2020 7072 696e 7428 2752 656d 656d 6265    print('Remembe
+0002dc40: 7220 7468 6174 2075 7369 6e67 2063 6c61  r that using cla
+0002dc50: 7373 2077 6569 6768 7473 2077 696c 6c20  ss weights will 
+0002dc60: 7772 6f6e 676c 7920 736b 6577 2070 7265  wrongly skew pre
+0002dc70: 6469 6374 5f70 726f 6261 7320 6672 6f6d  dict_probas from
+0002dc80: 2061 6e79 2063 6c61 7373 6966 6965 7227   any classifier'
+0002dc90: 290a 2020 2020 2020 2020 6966 2073 656c  ).        if sel
+0002dca0: 662e 696d 6261 6c61 6e63 6564 3a0a 2020  f.imbalanced:.  
+0002dcb0: 2020 2020 2020 2020 2020 636c 6173 735f            class_
+0002dcc0: 7765 6967 6874 7320 3d20 4e6f 6e65 0a20  weights = None. 
+0002dcd0: 2020 2020 2020 2065 6c73 653a 0a20 2020         else:.   
+0002dce0: 2020 2020 2020 2020 2063 6c61 7373 5f77           class_w
+0002dcf0: 6569 6768 7473 203d 2067 6574 5f63 6c61  eights = get_cla
+0002dd00: 7373 5f77 6569 6768 7473 2879 2c20 7665  ss_weights(y, ve
+0002dd10: 7262 6f73 653d 3029 0a20 2020 2020 2020  rbose=0).       
+0002dd20: 2023 2323 2052 656d 656d 6265 7220 7468   ### Remember th
+0002dd30: 6174 2070 7574 7469 6e67 2063 6c61 7373  at putting class
+0002dd40: 2077 6569 6768 7473 2077 696c 6c20 746f   weights will to
+0002dd50: 7461 6c6c 7920 6465 7374 726f 7920 7072  tally destroy pr
+0002dd60: 6564 6963 745f 7072 6f62 6173 2023 2323  edict_probas ###
+0002dd70: 0a20 2020 2020 2020 2073 656c 662e 636c  .        self.cl
+0002dd80: 6173 7365 7320 3d20 7072 696e 745f 666c  asses = print_fl
+0002dd90: 6174 7465 6e5f 6469 6374 2863 6c61 7373  atten_dict(class
+0002dda0: 5f77 6569 6768 7473 290a 2020 2020 2020  _weights).      
+0002ddb0: 2020 7363 616c 655f 706f 735f 7765 6967    scale_pos_weig
+0002ddc0: 6874 203d 2067 6574 5f73 6361 6c65 5f70  ht = get_scale_p
+0002ddd0: 6f73 5f77 6569 6768 7428 7929 0a20 2020  os_weight(y).   
+0002dde0: 2020 2020 2023 7072 696e 7428 2743 6c61       #print('Cla
+0002ddf0: 7373 2077 6569 6768 7473 203d 2025 7327  ss weights = %s'
+0002de00: 2025 636c 6173 735f 7765 6967 6874 7329   %class_weights)
+0002de10: 0a20 2020 2020 2020 2067 7075 5f65 7869  .        gpu_exi
+0002de20: 7374 7320 3d20 6368 6563 6b5f 6966 5f47  sts = check_if_G
+0002de30: 5055 5f65 7869 7374 7328 290a 2020 2020  PU_exists().    
+0002de40: 2020 2020 6966 2067 7075 5f65 7869 7374      if gpu_exist
+0002de50: 733a 0a20 2020 2020 2020 2020 2020 2064  s:.            d
+0002de60: 6576 6963 653d 2267 7075 220a 2020 2020  evice="gpu".    
+0002de70: 2020 2020 656c 7365 3a0a 2020 2020 2020      else:.      
+0002de80: 2020 2020 2020 6465 7669 6365 3d22 6370        device="cp
+0002de90: 7522 0a20 2020 2020 2020 2023 2320 446f  u".        ## Do
+0002dea0: 6e27 7420 6368 616e 6765 2074 6869 7320  n't change this 
+0002deb0: 7369 6e63 6520 6974 2067 6976 6573 2061  since it gives a
+0002dec0: 6e20 6572 726f 7220 2323 0a20 2020 2020  n error ##.     
+0002ded0: 2020 206d 6574 7269 6320 203d 2027 6175     metric  = 'au
+0002dee0: 6327 0a20 2020 2020 2020 2023 2323 2064  c'.        ### d
+0002def0: 6f6e 2774 2063 6861 6e67 6520 7468 6973  on't change this
+0002df00: 206d 6574 7269 6320 616e 6420 6576 616c   metric and eval
+0002df10: 206d 6574 7269 6320 2d20 6974 2067 6976   metric - it giv
+0002df20: 6573 2065 7272 6f72 2069 6620 796f 7520  es error if you 
+0002df30: 6368 616e 6765 2069 7420 2323 0a20 2020  change it ##.   
+0002df40: 2020 2020 2065 7661 6c5f 6d65 7472 6963       eval_metric
+0002df50: 203d 2027 6175 6327 0a20 2020 2020 2020   = 'auc'.       
+0002df60: 2072 6f77 5f6c 696d 6974 203d 2031 3030   row_limit = 100
+0002df70: 3030 0a20 2020 2020 2020 2069 6620 7365  00.        if se
+0002df80: 6c66 2e69 6d62 616c 616e 6365 643a 0a20  lf.imbalanced:. 
+0002df90: 2020 2020 2020 2020 2020 2070 7269 6e74             print
+0002dfa0: 2827 2020 2020 496d 6261 6c61 6e63 6564  ('    Imbalanced
+0002dfb0: 2063 6c61 7373 6573 206f 6620 7920 3d20   classes of y = 
+0002dfc0: 2573 2720 2566 696e 645f 7261 7265 5f63  %s' %find_rare_c
+0002dfd0: 6c61 7373 2879 2c20 7665 7262 6f73 653d  lass(y, verbose=
+0002dfe0: 7365 6c66 2e76 6572 626f 7365 2929 0a20  self.verbose)). 
+0002dff0: 2020 2020 2020 2023 2323 2323 2323 2323         #########
+0002e000: 2323 2323 2323 2320 2020 2020 2020 2020  #######         
+0002e010: 2050 2049 2050 2045 204c 2049 204e 2045   P I P E L I N E
+0002e020: 2020 2020 2020 2020 2323 2323 2323 2323          ########
+0002e030: 2323 2323 2323 2323 2323 2323 2323 2323  ################
+0002e040: 2323 0a20 2020 2020 2020 206e 756d 6572  ##.        numer
+0002e050: 6963 5f74 7261 6e73 666f 726d 6572 203d  ic_transformer =
+0002e060: 2050 6970 656c 696e 6528 0a20 2020 2020   Pipeline(.     
+0002e070: 2020 2020 2020 2073 7465 7073 3d5b 2822         steps=[("
+0002e080: 696d 7075 7465 7222 2c20 5369 6d70 6c65  imputer", Simple
+0002e090: 496d 7075 7465 7228 7374 7261 7465 6779  Imputer(strategy
+0002e0a0: 3d22 6d65 616e 222c 2061 6464 5f69 6e64  ="mean", add_ind
+0002e0b0: 6963 6174 6f72 3d54 7275 6529 292c 2028  icator=True)), (
+0002e0c0: 2273 6361 6c65 7222 2c20 5374 616e 6461  "scaler", Standa
+0002e0d0: 7264 5363 616c 6572 2829 295d 0a20 2020  rdScaler())].   
+0002e0e0: 2020 2020 2029 0a0a 2020 2020 2020 2020       )..        
+0002e0f0: 6361 7465 676f 7269 6361 6c5f 7472 616e  categorical_tran
+0002e100: 7366 6f72 6d65 725f 6c6f 7720 3d20 5069  sformer_low = Pi
+0002e110: 7065 6c69 6e65 280a 2020 2020 2020 2020  peline(.        
+0002e120: 2020 2020 7374 6570 733d 5b0a 2020 2020      steps=[.    
+0002e130: 2020 2020 2020 2020 2020 2020 2822 696d              ("im
+0002e140: 7075 7465 7222 2c20 5369 6d70 6c65 496d  puter", SimpleIm
+0002e150: 7075 7465 7228 7374 7261 7465 6779 3d22  puter(strategy="
+0002e160: 636f 6e73 7461 6e74 222c 2066 696c 6c5f  constant", fill_
+0002e170: 7661 6c75 653d 226d 6973 7369 6e67 222c  value="missing",
+0002e180: 2061 6464 5f69 6e64 6963 6174 6f72 3d54   add_indicator=T
+0002e190: 7275 6529 292c 0a20 2020 2020 2020 2020  rue)),.         
+0002e1a0: 2020 2020 2020 2028 2265 6e63 6f64 696e         ("encodin
+0002e1b0: 6722 2c20 4f6e 6548 6f74 456e 636f 6465  g", OneHotEncode
+0002e1c0: 7228 6861 6e64 6c65 5f75 6e6b 6e6f 776e  r(handle_unknown
+0002e1d0: 3d22 7661 6c75 6522 2929 2c0a 2020 2020  ="value")),.    
+0002e1e0: 2020 2020 2020 2020 5d0a 2020 2020 2020          ].      
+0002e1f0: 2020 290a 0a20 2020 2020 2020 2063 6174    )..        cat
+0002e200: 6567 6f72 6963 616c 5f74 7261 6e73 666f  egorical_transfo
+0002e210: 726d 6572 5f68 6967 6820 3d20 5069 7065  rmer_high = Pipe
+0002e220: 6c69 6e65 280a 2020 2020 2020 2020 2020  line(.          
+0002e230: 2020 7374 6570 733d 5b0a 2020 2020 2020    steps=[.      
+0002e240: 2020 2020 2020 2020 2020 2822 696d 7075            ("impu
+0002e250: 7465 7222 2c20 5369 6d70 6c65 496d 7075  ter", SimpleImpu
+0002e260: 7465 7228 7374 7261 7465 6779 3d22 636f  ter(strategy="co
+0002e270: 6e73 7461 6e74 222c 2066 696c 6c5f 7661  nstant", fill_va
+0002e280: 6c75 653d 226d 6973 7369 6e67 222c 2061  lue="missing", a
+0002e290: 6464 5f69 6e64 6963 6174 6f72 3d54 7275  dd_indicator=Tru
+0002e2a0: 6529 292c 0a20 2020 2020 2020 2020 2020  e)),.           
+0002e2b0: 2020 2020 2028 2265 6e63 6f64 696e 6722       ("encoding"
+0002e2c0: 2c20 4c61 6265 6c45 6e63 6f64 6572 2829  , LabelEncoder()
+0002e2d0: 292c 0a20 2020 2020 2020 2020 2020 205d  ),.            ]
+0002e2e0: 0a20 2020 2020 2020 2029 0a0a 2020 2020  .        )..    
+0002e2f0: 2020 2020 6e75 6d65 7269 635f 6665 6174      numeric_feat
+0002e300: 7572 6573 203d 2058 2e73 656c 6563 745f  ures = X.select_
+0002e310: 6474 7970 6573 2869 6e63 6c75 6465 3d5b  dtypes(include=[
+0002e320: 6e70 2e6e 756d 6265 725d 292e 636f 6c75  np.number]).colu
+0002e330: 6d6e 730a 2020 2020 2020 2020 6361 7465  mns.        cate
+0002e340: 676f 7269 6361 6c5f 6665 6174 7572 6573  gorical_features
+0002e350: 203d 2058 2e73 656c 6563 745f 6474 7970   = X.select_dtyp
+0002e360: 6573 2869 6e63 6c75 6465 3d5b 226f 626a  es(include=["obj
+0002e370: 6563 7422 5d29 2e63 6f6c 756d 6e73 0a0a  ect"]).columns..
+0002e380: 2020 2020 2020 2020 6361 7465 676f 7269          categori
+0002e390: 6361 6c5f 6c6f 772c 2063 6174 6567 6f72  cal_low, categor
+0002e3a0: 6963 616c 5f68 6967 6820 3d20 6765 745f  ical_high = get_
+0002e3b0: 6361 7264 696e 616c 6974 7928 582c 2063  cardinality(X, c
+0002e3c0: 6174 6567 6f72 6963 616c 5f66 6561 7475  ategorical_featu
+0002e3d0: 7265 7329 0a20 2020 2020 2020 2070 7265  res).        pre
+0002e3e0: 7072 6f63 6573 736f 7220 3d20 436f 6c75  processor = Colu
+0002e3f0: 6d6e 5472 616e 7366 6f72 6d65 7228 0a20  mnTransformer(. 
+0002e400: 2020 2020 2020 2020 2020 2074 7261 6e73             trans
+0002e410: 666f 726d 6572 733d 5b0a 2020 2020 2020  formers=[.      
+0002e420: 2020 2020 2020 2020 2020 2822 6e75 6d65            ("nume
+0002e430: 7269 6322 2c20 6e75 6d65 7269 635f 7472  ric", numeric_tr
+0002e440: 616e 7366 6f72 6d65 722c 206e 756d 6572  ansformer, numer
+0002e450: 6963 5f66 6561 7475 7265 7329 2c0a 2020  ic_features),.  
+0002e460: 2020 2020 2020 2020 2020 2020 2020 2822                ("
+0002e470: 6361 7465 676f 7269 6361 6c5f 6c6f 7722  categorical_low"
+0002e480: 2c20 6361 7465 676f 7269 6361 6c5f 7472  , categorical_tr
+0002e490: 616e 7366 6f72 6d65 725f 6c6f 772c 2063  ansformer_low, c
+0002e4a0: 6174 6567 6f72 6963 616c 5f6c 6f77 292c  ategorical_low),
+0002e4b0: 0a20 2020 2020 2020 2020 2020 2020 2020  .               
+0002e4c0: 2028 2263 6174 6567 6f72 6963 616c 5f68   ("categorical_h
+0002e4d0: 6967 6822 2c20 6361 7465 676f 7269 6361  igh", categorica
+0002e4e0: 6c5f 7472 616e 7366 6f72 6d65 725f 6869  l_transformer_hi
+0002e4f0: 6768 2c20 6361 7465 676f 7269 6361 6c5f  gh, categorical_
+0002e500: 6869 6768 292c 0a20 2020 2020 2020 2020  high),.         
+0002e510: 2020 205d 0a20 2020 2020 2020 2029 0a20     ].        ). 
+0002e520: 2020 2020 2020 2023 2323 2323 2323 2323         #########
+0002e530: 2323 2323 2323 2323 2323 2323 2323 2323  ################
+0002e540: 2323 2323 2323 2323 2323 2323 2323 2323  ################
+0002e550: 2323 2323 2323 2323 2323 2323 2323 2323  ################
+0002e560: 2323 2323 2323 2323 2323 2323 2323 2323  ################
+0002e570: 2323 2323 2323 2323 2323 230a 2020 2020  ###########.    
+0002e580: 2020 2020 6966 2069 7369 6e73 7461 6e63      if isinstanc
+0002e590: 6528 792c 2070 642e 4461 7461 4672 616d  e(y, pd.DataFram
+0002e5a0: 6529 3a0a 2020 2020 2020 2020 2020 2020  e):.            
+0002e5b0: 6966 206c 656e 2879 2e63 6f6c 756d 6e73  if len(y.columns
+0002e5c0: 2920 3e3d 2032 3a0a 2020 2020 2020 2020  ) >= 2:.        
+0002e5d0: 2020 2020 2020 2020 6e75 6d62 6572 5f6f          number_o
+0002e5e0: 665f 636c 6173 7365 7320 3d20 6e75 6d5f  f_classes = num_
+0002e5f0: 636c 6173 7365 7328 7929 0a20 2020 2020  classes(y).     
+0002e600: 2020 2020 2020 2020 2020 2066 6f72 2065             for e
+0002e610: 6163 685f 6920 696e 2079 2e63 6f6c 756d  ach_i in y.colum
+0002e620: 6e73 3a0a 2020 2020 2020 2020 2020 2020  ns:.            
+0002e630: 2020 2020 2020 2020 6e75 6d62 6572 5f6f          number_o
+0002e640: 665f 636c 6173 7365 735b 6561 6368 5f69  f_classes[each_i
+0002e650: 5d20 3d20 696e 7428 6e75 6d62 6572 5f6f  ] = int(number_o
+0002e660: 665f 636c 6173 7365 735b 6561 6368 5f69  f_classes[each_i
+0002e670: 5d20 2d20 3129 0a20 2020 2020 2020 2020  ] - 1).         
+0002e680: 2020 2020 2020 206d 6178 5f6e 756d 6265         max_numbe
+0002e690: 725f 6f66 5f63 6c61 7373 6573 203d 206e  r_of_classes = n
+0002e6a0: 702e 6d61 7828 6c69 7374 286e 756d 6265  p.max(list(numbe
+0002e6b0: 725f 6f66 5f63 6c61 7373 6573 2e76 616c  r_of_classes.val
+0002e6c0: 7565 7328 2929 290a 2020 2020 2020 2020  ues())).        
+0002e6d0: 2020 2020 656c 7365 3a0a 2020 2020 2020      else:.      
+0002e6e0: 2020 2020 2020 2020 2020 6e75 6d62 6572            number
+0002e6f0: 5f6f 665f 636c 6173 7365 7320 3d20 696e  _of_classes = in
+0002e700: 7428 6e75 6d5f 636c 6173 7365 7328 7929  t(num_classes(y)
+0002e710: 202d 2031 290a 2020 2020 2020 2020 2020   - 1).          
+0002e720: 2020 2020 2020 6d61 785f 6e75 6d62 6572        max_number
+0002e730: 5f6f 665f 636c 6173 7365 7320 3d20 6e70  _of_classes = np
+0002e740: 2e6d 6178 286e 756d 6265 725f 6f66 5f63  .max(number_of_c
+0002e750: 6c61 7373 6573 290a 2020 2020 2020 2020  lasses).        
+0002e760: 656c 7365 3a0a 2020 2020 2020 2020 2020  else:.          
+0002e770: 2020 6e75 6d62 6572 5f6f 665f 636c 6173    number_of_clas
+0002e780: 7365 7320 3d20 696e 7428 6e75 6d5f 636c  ses = int(num_cl
+0002e790: 6173 7365 7328 7929 202d 2031 290a 2020  asses(y) - 1).  
+0002e7a0: 2020 2020 2020 2020 2020 6d61 785f 6e75            max_nu
+0002e7b0: 6d62 6572 5f6f 665f 636c 6173 7365 7320  mber_of_classes 
+0002e7c0: 3d20 6e70 2e6d 6178 286e 756d 6265 725f  = np.max(number_
+0002e7d0: 6f66 5f63 6c61 7373 6573 290a 2020 2020  of_classes).    
+0002e7e0: 2020 2020 6461 7461 5f73 616d 706c 6573      data_samples
+0002e7f0: 203d 2058 2e73 6861 7065 5b30 5d0a 2020   = X.shape[0].  
+0002e800: 2020 2020 2020 7365 6c66 2e6d 6178 5f6e        self.max_n
+0002e810: 756d 6265 725f 6f66 5f63 6c61 7373 6573  umber_of_classes
+0002e820: 203d 206d 6178 5f6e 756d 6265 725f 6f66   = max_number_of
+0002e830: 5f63 6c61 7373 6573 0a20 2020 2020 2020  _classes.       
+0002e840: 2069 6620 7365 6c66 2e6e 5f65 7374 696d   if self.n_estim
+0002e850: 6174 6f72 7320 6973 204e 6f6e 653a 0a20  ators is None:. 
+0002e860: 2020 2020 2020 2020 2020 2069 6620 6461             if da
+0002e870: 7461 5f73 616d 706c 6573 203c 3d20 726f  ta_samples <= ro
+0002e880: 775f 6c69 6d69 743a 0a20 2020 2020 2020  w_limit:.       
+0002e890: 2020 2020 2020 2020 2073 656c 662e 6e5f           self.n_
+0002e8a0: 6573 7469 6d61 746f 7273 203d 206d 696e  estimators = min
+0002e8b0: 2833 2c20 696e 7428 312e 352a 6e70 2e6c  (3, int(1.5*np.l
+0002e8c0: 6f67 3130 2864 6174 615f 7361 6d70 6c65  og10(data_sample
+0002e8d0: 7329 2929 0a20 2020 2020 2020 2020 2020  s))).           
+0002e8e0: 2065 6c73 653a 0a20 2020 2020 2020 2020   else:.         
+0002e8f0: 2020 2020 2020 2073 656c 662e 6e5f 6573         self.n_es
+0002e900: 7469 6d61 746f 7273 203d 206d 696e 2831  timators = min(1
+0002e910: 302c 2069 6e74 2831 2e35 2a6e 702e 6c6f  0, int(1.5*np.lo
+0002e920: 6731 3028 6461 7461 5f73 616d 706c 6573  g10(data_samples
+0002e930: 2929 290a 2020 2020 2020 2020 7365 6c66  ))).        self
+0002e940: 2e6d 6f64 656c 5f6e 616d 6520 3d20 276c  .model_name = 'l
+0002e950: 6762 270a 2020 2020 2020 2020 6e75 6d5f  gb'.        num_
+0002e960: 7370 6c69 7473 203d 2073 656c 662e 6e5f  splits = self.n_
+0002e970: 6573 7469 6d61 746f 7273 0a20 2020 2020  estimators.     
+0002e980: 2020 206e 756d 5f72 6570 6561 7473 203d     num_repeats =
+0002e990: 2031 0a20 2020 2020 2020 206b 666f 6c64   1.        kfold
+0002e9a0: 203d 2052 6570 6561 7465 644b 466f 6c64   = RepeatedKFold
+0002e9b0: 286e 5f73 706c 6974 733d 6e75 6d5f 7370  (n_splits=num_sp
+0002e9c0: 6c69 7473 2c20 7261 6e64 6f6d 5f73 7461  lits, random_sta
+0002e9d0: 7465 3d73 6565 642c 206e 5f72 6570 6561  te=seed, n_repea
+0002e9e0: 7473 3d6e 756d 5f72 6570 6561 7473 290a  ts=num_repeats).
+0002e9f0: 2020 2020 2020 2020 6e75 6d5f 6974 6572          num_iter
+0002ea00: 6174 696f 6e73 203d 2069 6e74 286e 756d  ations = int(num
+0002ea10: 5f73 706c 6974 7320 2a20 6e75 6d5f 7265  _splits * num_re
+0002ea20: 7065 6174 7329 0a20 2020 2020 2020 2073  peats).        s
+0002ea30: 636f 7269 6e67 203d 2027 6261 6c61 6e63  coring = 'balanc
+0002ea40: 6564 5f61 6363 7572 6163 7927 0a20 2020  ed_accuracy'.   
+0002ea50: 2020 2020 2070 7269 6e74 2827 2020 2020       print('    
+0002ea60: 4e75 6d62 6572 206f 6620 6573 7469 6d61  Number of estima
+0002ea70: 746f 7273 2075 7365 6420 696e 2053 756c  tors used in Sul
+0002ea80: 6f43 6c61 7373 6966 6965 7220 3d20 2573  oClassifier = %s
+0002ea90: 2720 256e 756d 5f69 7465 7261 7469 6f6e  ' %num_iteration
+0002eaa0: 7329 0a20 2020 2020 2020 2023 2323 2323  s).        #####
+0002eab0: 2054 6869 7320 6973 2077 6865 7265 2077   This is where w
+0002eac0: 6520 6368 6563 6b20 6966 2079 2069 7320  e check if y is 
+0002ead0: 7369 6e67 6c65 206c 6162 656c 206f 7220  single label or 
+0002eae0: 6d75 6c74 692d 6c61 6265 6c20 2323 0a20  multi-label ##. 
+0002eaf0: 2020 2020 2020 2069 6620 6973 696e 7374         if isinst
+0002eb00: 616e 6365 2879 2c20 7064 2e44 6174 6146  ance(y, pd.DataF
+0002eb10: 7261 6d65 293a 0a20 2020 2020 2020 2020  rame):.         
+0002eb20: 2020 2023 2323 2323 2323 2323 2323 2323     #############
+0002eb30: 2323 2323 2323 2323 2323 2323 2323 2323  ################
+0002eb40: 2323 2323 2323 2323 2323 2323 2323 2323  ################
+0002eb50: 2323 2323 2323 2323 2323 2323 2323 2323  ################
+0002eb60: 2323 0a20 2020 2020 2020 2020 2020 2023  ##.            #
+0002eb70: 2323 2054 6869 7320 6973 2066 6f72 204d  ## This is for M
+0002eb80: 756c 7469 2d4c 6162 656c 2070 726f 626c  ulti-Label probl
+0002eb90: 656d 7320 6f6e 6c79 2023 2323 2323 2323  ems only #######
+0002eba0: 2323 2323 2323 2323 2323 2323 2323 0a20  ##############. 
+0002ebb0: 2020 2020 2020 2020 2020 2023 2323 2323             #####
+0002ebc0: 2323 2323 2323 2323 2323 2323 2323 2323  ################
+0002ebd0: 2323 2323 2323 2323 2323 2323 2323 2323  ################
+0002ebe0: 2323 2323 2323 2323 2323 2323 2323 2323  ################
+0002ebf0: 2323 2323 2323 2323 2323 0a20 2020 2020  ##########.     
+0002ec00: 2020 2020 2020 2074 6172 6765 7473 203d         targets =
+0002ec10: 2079 2e63 6f6c 756d 6e73 2e74 6f6c 6973   y.columns.tolis
+0002ec20: 7428 290a 2020 2020 2020 2020 2020 2020  t().            
+0002ec30: 6966 2069 735f 795f 6f62 6a65 6374 2879  if is_y_object(y
+0002ec40: 293a 0a20 2020 2020 2020 2020 2020 2020  ):.             
+0002ec50: 2020 2070 7269 6e74 2827 4361 6e6e 6f74     print('Cannot
+0002ec60: 2070 6572 666f 726d 2063 6c61 7373 6966   perform classif
+0002ec70: 6963 6174 696f 6e20 7573 696e 6720 6f62  ication using ob
+0002ec80: 6a65 6374 206f 7220 7374 7269 6e67 2074  ject or string t
+0002ec90: 6172 6765 7473 2e20 506c 6561 7365 2063  argets. Please c
+0002eca0: 6f6e 7665 7274 2074 6f20 6e75 6d65 7269  onvert to numeri
+0002ecb0: 6320 616e 6420 7472 7920 6167 6169 6e2e  c and try again.
+0002ecc0: 2729 0a20 2020 2020 2020 2020 2020 2020  ').             
+0002ecd0: 2020 2072 6574 7572 6e20 7365 6c66 0a20     return self. 
+0002ece0: 2020 2020 2020 2020 2020 2069 6620 6c65             if le
+0002ecf0: 6e28 7461 7267 6574 7329 203e 2031 3a0a  n(targets) > 1:.
+0002ed00: 2020 2020 2020 2020 2020 2020 2020 2020                  
+0002ed10: 7365 6c66 2e6d 756c 7469 5f6c 6162 656c  self.multi_label
+0002ed20: 203d 2079 2e63 6f6c 756d 6e73 2e74 6f6c   = y.columns.tol
+0002ed30: 6973 7428 290a 2020 2020 2020 2020 2020  ist().          
+0002ed40: 2020 2020 2020 2323 2320 596f 7520 6e65        ### You ne
+0002ed50: 6564 2074 6f20 696e 6974 6961 6c69 7a65  ed to initialize
+0002ed60: 2074 6865 2063 6c61 7373 2062 6566 6f72   the class befor
+0002ed70: 6520 6561 6368 2072 756e 202d 206f 7468  e each run - oth
+0002ed80: 6572 7769 7365 2c20 6572 726f 7221 0a20  erwise, error!. 
+0002ed90: 2020 2020 2020 2020 2020 2020 2020 2023                 #
+0002eda0: 2323 2052 656d 656d 6265 7220 7765 2064  ## Remember we d
+0002edb0: 6f6e 2774 2074 6f20 4850 5420 5475 6e69  on't to HPT Tuni
+0002edc0: 6e67 2066 6f72 204d 756c 7469 2d6c 6162  ng for Multi-lab
+0002edd0: 656c 2070 726f 626c 656d 7320 7369 6e63  el problems sinc
+0002ede0: 6520 6974 2065 7272 6f72 7320 2323 2323  e it errors ####
+0002edf0: 0a20 2020 2020 2020 2020 2020 2020 2020  .               
+0002ee00: 2069 203d 2030 0a20 2020 2020 2020 2020   i = 0.         
+0002ee10: 2020 2020 2020 2066 6f72 2074 7261 696e         for train
+0002ee20: 5f69 6e64 6578 2c20 7465 7374 5f69 6e64  _index, test_ind
+0002ee30: 6578 2069 6e20 7471 646d 286b 666f 6c64  ex in tqdm(kfold
+0002ee40: 2e73 706c 6974 2858 2c20 7929 2c20 746f  .split(X, y), to
+0002ee50: 7461 6c3d 6b66 6f6c 642e 6765 745f 6e5f  tal=kfold.get_n_
+0002ee60: 7370 6c69 7473 2829 2c0a 2020 2020 2020  splits(),.      
+0002ee70: 2020 2020 2020 2020 2020 2020 2020 2020                  
+0002ee80: 2020 2020 2020 2020 2020 2020 2020 2020                  
+0002ee90: 2020 2020 2020 6465 7363 3d22 6b2d 666f        desc="k-fo
+0002eea0: 6c64 2074 7261 696e 696e 6722 293a 0a20  ld training"):. 
+0002eeb0: 2020 2020 2020 2020 2020 2020 2020 2020                  
+0002eec0: 2020 2073 7461 7274 5f74 696d 6520 3d20     start_time = 
+0002eed0: 7469 6d65 2e74 696d 6528 290a 2020 2020  time.time().    
+0002eee0: 2020 2020 2020 2020 2020 2020 2020 2020                  
+0002eef0: 2372 616e 646f 6d5f 7365 6564 203d 206e  #random_seed = n
+0002ef00: 702e 7261 6e64 6f6d 2e72 616e 6469 6e74  p.random.randint
+0002ef10: 2832 2c31 3030 290a 2020 2020 2020 2020  (2,100).        
+0002ef20: 2020 2020 2020 2020 2020 2020 7261 6e64              rand
+0002ef30: 6f6d 5f73 6565 6420 3d20 3939 3939 0a20  om_seed = 9999. 
+0002ef40: 2020 2020 2020 2020 2020 2020 2020 2020                  
+0002ef50: 2020 2069 6620 7365 6c66 2e62 6173 655f     if self.base_
+0002ef60: 6573 7469 6d61 746f 7220 6973 204e 6f6e  estimator is Non
+0002ef70: 653a 0a20 2020 2020 2020 2020 2020 2020  e:.             
+0002ef80: 2020 2020 2020 2020 2020 2069 6620 7365             if se
+0002ef90: 6c66 2e6d 6178 5f6e 756d 6265 725f 6f66  lf.max_number_of
+0002efa0: 5f63 6c61 7373 6573 203c 3d20 313a 0a20  _classes <= 1:. 
+0002efb0: 2020 2020 2020 2020 2020 2020 2020 2020                  
+0002efc0: 2020 2020 2020 2020 2020 2023 2323 2323             #####
+0002efd0: 2323 2323 2323 2323 2323 2323 2323 2323  ################
+0002efe0: 2323 2323 2323 2323 2323 2323 2323 2323  ################
+0002eff0: 2323 2323 2323 2323 2323 2323 2323 2323  ################
+0002f000: 2323 2323 2323 2323 230a 2020 2020 2020  #########.      
+0002f010: 2020 2020 2020 2020 2020 2020 2020 2020                  
+0002f020: 2020 2020 2020 2323 2320 2020 5468 6973        ###   This
+0002f030: 2069 7320 666f 7220 4269 6e61 7279 2043   is for Binary C
+0002f040: 6c61 7373 6966 6963 6174 696f 6e20 7072  lassification pr
+0002f050: 6f62 6c65 6d73 206f 6e6c 7920 2323 2323  oblems only ####
+0002f060: 2323 2323 0a20 2020 2020 2020 2020 2020  ####.           
+0002f070: 2020 2020 2020 2020 2020 2020 2020 2020                  
+0002f080: 2023 2323 2323 2323 2323 2323 2323 2323   ###############
+0002f090: 2323 2323 2323 2323 2323 2323 2323 2323  ################
+0002f0a0: 2323 2323 2323 2323 2323 2323 2323 2323  ################
+0002f0b0: 2323 2323 2323 2323 2323 2323 2323 230a  ###############.
+0002f0c0: 2020 2020 2020 2020 2020 2020 2020 2020                  
+0002f0d0: 2020 2020 2020 2020 2020 2020 6966 2073              if s
+0002f0e0: 656c 662e 696d 6261 6c61 6e63 6564 3a0a  elf.imbalanced:.
+0002f0f0: 2020 2020 2020 2020 2020 2020 2020 2020                  
+0002f100: 2020 2020 2020 2020 2020 2020 2020 2020                  
+0002f110: 7472 793a 0a20 2020 2020 2020 2020 2020  try:.           
+0002f120: 2020 2020 2020 2020 2020 2020 2020 2020                  
+0002f130: 2020 2020 2020 2020 2066 726f 6d20 696d           from im
+0002f140: 6261 6c61 6e63 6564 5f65 6e73 656d 626c  balanced_ensembl
+0002f150: 652e 656e 7365 6d62 6c65 2069 6d70 6f72  e.ensemble impor
+0002f160: 7420 5365 6c66 5061 6365 6445 6e73 656d  t SelfPacedEnsem
+0002f170: 626c 6543 6c61 7373 6966 6965 720a 2020  bleClassifier.  
+0002f180: 2020 2020 2020 2020 2020 2020 2020 2020                  
+0002f190: 2020 2020 2020 2020 2020 2020 2020 2020                  
+0002f1a0: 2020 7365 6c66 2e62 6173 655f 6573 7469    self.base_esti
+0002f1b0: 6d61 746f 7220 3d20 5365 6c66 5061 6365  mator = SelfPace
+0002f1c0: 6445 6e73 656d 626c 6543 6c61 7373 6966  dEnsembleClassif
+0002f1d0: 6965 7228 6e5f 6a6f 6273 3d2d 312c 2072  ier(n_jobs=-1, r
+0002f1e0: 616e 646f 6d5f 7374 6174 653d 7261 6e64  andom_state=rand
+0002f1f0: 6f6d 5f73 6565 6429 0a20 2020 2020 2020  om_seed).       
+0002f200: 2020 2020 2020 2020 2020 2020 2020 2020                  
+0002f210: 2020 2020 2020 2020 2065 7863 6570 743a           except:
+0002f220: 0a20 2020 2020 2020 2020 2020 2020 2020  .               
+0002f230: 2020 2020 2020 2020 2020 2020 2020 2020                  
+0002f240: 2020 2020 2070 7269 6e74 2827 7069 7020       print('pip 
+0002f250: 696e 7374 616c 6c20 696d 6261 6c61 6e63  install imbalanc
+0002f260: 6564 5f65 6e73 656d 626c 6520 616e 6420  ed_ensemble and 
+0002f270: 7265 2d72 756e 2074 6869 7320 6167 6169  re-run this agai
+0002f280: 6e2e 2729 0a20 2020 2020 2020 2020 2020  n.').           
+0002f290: 2020 2020 2020 2020 2020 2020 2020 2020                  
+0002f2a0: 2020 2020 2020 2020 2072 6574 7572 6e20           return 
+0002f2b0: 7365 6c66 0a20 2020 2020 2020 2020 2020  self.           
+0002f2c0: 2020 2020 2020 2020 2020 2020 2020 2020                  
+0002f2d0: 2020 2020 2073 656c 662e 6d6f 6465 6c5f       self.model_
+0002f2e0: 6e61 6d65 203d 2027 6f74 6865 7227 0a20  name = 'other'. 
+0002f2f0: 2020 2020 2020 2020 2020 2020 2020 2020                  
+0002f300: 2020 2020 2020 2020 2020 2065 6c73 653a             else:
+0002f310: 0a20 2020 2020 2020 2020 2020 2020 2020  .               
+0002f320: 2020 2020 2020 2020 2020 2020 2020 2020                  
+0002f330: 2023 2323 206d 616b 6520 6974 2061 2072   ### make it a r
+0002f340: 6567 756c 6172 2064 6963 7469 6f6e 6172  egular dictionar
+0002f350: 7920 7769 7468 2077 6569 6768 7473 2066  y with weights f
+0002f360: 6f72 2070 6f73 2061 6e64 206e 6567 2063  or pos and neg c
+0002f370: 6c61 7373 6573 2023 230a 2020 2020 2020  lasses ##.      
+0002f380: 2020 2020 2020 2020 2020 2020 2020 2020                  
+0002f390: 2020 2020 2020 2020 2020 636c 6173 735f            class_
+0002f3a0: 7765 6967 6874 7320 3d20 6469 6374 285b  weights = dict([
+0002f3b0: 7620 666f 7220 6b2c 7620 696e 2063 6c61  v for k,v in cla
+0002f3c0: 7373 5f77 6569 6768 7473 2e69 7465 6d73  ss_weights.items
+0002f3d0: 2829 5d5b 305d 290a 2020 2020 2020 2020  ()][0]).        
+0002f3e0: 2020 2020 2020 2020 2020 2020 2020 2020                  
+0002f3f0: 2020 2020 2020 2020 6966 2064 6174 615f          if data_
+0002f400: 7361 6d70 6c65 7320 3c3d 2072 6f77 5f6c  samples <= row_l
+0002f410: 696d 6974 3a0a 2020 2020 2020 2020 2020  imit:.          
+0002f420: 2020 2020 2020 2020 2020 2020 2020 2020                  
+0002f430: 2020 2020 2020 2020 2020 6966 2028 582e            if (X.
+0002f440: 6474 7970 6573 3d3d 666c 6f61 7429 2e61  dtypes==float).a
+0002f450: 6c6c 2829 2061 6e64 206c 656e 2873 656c  ll() and len(sel
+0002f460: 662e 6665 6174 7572 6573 2920 3c3d 2066  f.features) <= f
+0002f470: 6561 7475 7265 735f 6c69 6d69 743a 0a20  eatures_limit:. 
+0002f480: 2020 2020 2020 2020 2020 2020 2020 2020                  
+0002f490: 2020 2020 2020 2020 2020 2020 2020 2020                  
+0002f4a0: 2020 2020 2020 2069 6620 7365 6c66 2e76         if self.v
+0002f4b0: 6572 626f 7365 3a0a 2020 2020 2020 2020  erbose:.        
+0002f4c0: 2020 2020 2020 2020 2020 2020 2020 2020                  
+0002f4d0: 2020 2020 2020 2020 2020 2020 2020 2020                  
+0002f4e0: 2020 2020 7072 696e 7428 2720 2020 2053      print('    S
+0002f4f0: 656c 6563 7469 6e67 204c 6162 656c 2050  electing Label P
+0002f500: 726f 7061 6761 7469 6f6e 2073 696e 6365  ropagation since
+0002f510: 2069 7420 7769 6c6c 2077 6f72 6b20 6772   it will work gr
+0002f520: 6561 7420 666f 7220 7468 6973 2064 6174  eat for this dat
+0002f530: 6173 6574 2e2e 2e27 290a 2020 2020 2020  aset...').      
+0002f540: 2020 2020 2020 2020 2020 2020 2020 2020                  
+0002f550: 2020 2020 2020 2020 2020 2020 2020 2020                  
+0002f560: 2020 2020 2020 7072 696e 7428 2720 2020        print('   
+0002f570: 2020 2020 2068 6f77 6576 6572 2069 7420       however it 
+0002f580: 7769 6c6c 2073 6b65 7720 7072 6f62 6162  will skew probab
+0002f590: 696c 6974 6965 7320 616e 6420 7368 6f77  ilities and show
+0002f5a0: 206c 6f77 6572 2052 4f43 2041 5543 2073   lower ROC AUC s
+0002f5b0: 636f 7265 2074 6861 6e20 6e6f 726d 616c  core than normal
+0002f5c0: 2e27 290a 2020 2020 2020 2020 2020 2020  .').            
+0002f5d0: 2020 2020 2020 2020 2020 2020 2020 2020                  
+0002f5e0: 2020 2020 2020 2020 2020 2020 7365 6c66              self
+0002f5f0: 2e62 6173 655f 6573 7469 6d61 746f 7220  .base_estimator 
+0002f600: 3d20 204c 6162 656c 5072 6f70 6167 6174  =  LabelPropagat
+0002f610: 696f 6e28 290a 2020 2020 2020 2020 2020  ion().          
+0002f620: 2020 2020 2020 2020 2020 2020 2020 2020                  
+0002f630: 2020 2020 2020 2020 2020 2020 2020 7365                se
+0002f640: 6c66 2e6d 6f64 656c 5f6e 616d 6520 3d20  lf.model_name = 
+0002f650: 276c 7027 0a20 2020 2020 2020 2020 2020  'lp'.           
+0002f660: 2020 2020 2020 2020 2020 2020 2020 2020                  
+0002f670: 2020 2020 2020 2020 2065 6c73 653a 0a20           else:. 
+0002f680: 2020 2020 2020 2020 2020 2020 2020 2020                  
+0002f690: 2020 2020 2020 2020 2020 2020 2020 2020                  
+0002f6a0: 2020 2020 2020 2069 6620 6c65 6e28 7365         if len(se
+0002f6b0: 6c66 2e66 6561 7475 7265 7329 203c 3d20  lf.features) <= 
+0002f6c0: 6665 6174 7572 6573 5f6c 696d 6974 3a0a  features_limit:.
+0002f6d0: 2020 2020 2020 2020 2020 2020 2020 2020                  
+0002f6e0: 2020 2020 2020 2020 2020 2020 2020 2020                  
+0002f6f0: 2020 2020 2020 2020 2020 2020 6966 2073              if s
+0002f700: 656c 662e 7665 7262 6f73 653a 0a20 2020  elf.verbose:.   
+0002f710: 2020 2020 2020 2020 2020 2020 2020 2020                  
+0002f720: 2020 2020 2020 2020 2020 2020 2020 2020                  
+0002f730: 2020 2020 2020 2020 2020 2020 2070 7269               pri
+0002f740: 6e74 2827 2020 2020 5365 6c65 6374 696e  nt('    Selectin
+0002f750: 6720 4261 6767 696e 6720 436c 6173 7369  g Bagging Classi
+0002f760: 6669 6572 2066 6f72 2074 6869 7320 6461  fier for this da
+0002f770: 7461 7365 742e 2e2e 2729 0a20 2020 2020  taset...').     
+0002f780: 2020 2020 2020 2020 2020 2020 2020 2020                  
+0002f790: 2020 2020 2020 2020 2020 2020 2020 2020                  
+0002f7a0: 2020 2020 2020 2045 5420 3d20 4578 7472         ET = Extr
+0002f7b0: 6154 7265 6543 6c61 7373 6966 6965 7228  aTreeClassifier(
+0002f7c0: 290a 2020 2020 2020 2020 2020 2020 2020  ).              
+0002f7d0: 2020 2020 2020 2020 2020 2020 2020 2020                  
+0002f7e0: 2020 2020 2020 2020 2020 2020 2020 7365                se
+0002f7f0: 6c66 2e62 6173 655f 6573 7469 6d61 746f  lf.base_estimato
+0002f800: 7220 3d20 4261 6767 696e 6743 6c61 7373  r = BaggingClass
+0002f810: 6966 6965 7228 6261 7365 5f65 7374 696d  ifier(base_estim
+0002f820: 6174 6f72 3d45 542c 206e 5f6a 6f62 733d  ator=ET, n_jobs=
+0002f830: 2d31 290a 2020 2020 2020 2020 2020 2020  -1).            
+0002f840: 2020 2020 2020 2020 2020 2020 2020 2020                  
+0002f850: 2020 2020 2020 2020 2020 2020 2020 2020                  
+0002f860: 7365 6c66 2e6d 6f64 656c 5f6e 616d 6520  self.model_name 
+0002f870: 3d20 2762 6727 0a20 2020 2020 2020 2020  = 'bg'.         
+0002f880: 2020 2020 2020 2020 2020 2020 2020 2020                  
+0002f890: 2020 2020 2020 2020 2020 2020 2020 2065                 e
+0002f8a0: 6c73 653a 0a20 2020 2020 2020 2020 2020  lse:.           
+0002f8b0: 2020 2020 2020 2020 2020 2020 2020 2020                  
+0002f8c0: 2020 2020 2020 2020 2020 2020 2020 2020                  
+0002f8d0: 2069 6620 7365 6c66 2e76 6572 626f 7365   if self.verbose
+0002f8e0: 3a0a 2020 2020 2020 2020 2020 2020 2020  :.              
+0002f8f0: 2020 2020 2020 2020 2020 2020 2020 2020                  
+0002f900: 2020 2020 2020 2020 2020 2020 2020 2020                  
+0002f910: 2020 7072 696e 7428 2720 2020 2053 656c    print('    Sel
+0002f920: 6563 7469 6e67 204c 4742 4d20 5265 6772  ecting LGBM Regr
+0002f930: 6573 736f 7220 6173 2062 6173 6520 6573  essor as base es
+0002f940: 7469 6d61 746f 722e 2e2e 2729 0a20 2020  timator...').   
+0002f950: 2020 2020 2020 2020 2020 2020 2020 2020                  
+0002f960: 2020 2020 2020 2020 2020 2020 2020 2020                  
+0002f970: 2020 2020 2020 2020 2073 656c 662e 6261           self.ba
+0002f980: 7365 5f65 7374 696d 6174 6f72 203d 204c  se_estimator = L
+0002f990: 4742 4d43 6c61 7373 6966 6965 7228 6465  GBMClassifier(de
+0002f9a0: 7669 6365 3d64 6576 6963 652c 2072 616e  vice=device, ran
+0002f9b0: 646f 6d5f 7374 6174 653d 7261 6e64 6f6d  dom_state=random
+0002f9c0: 5f73 6565 642c 0a20 2020 2020 2020 2020  _seed,.         
+0002f9d0: 2020 2020 2020 2020 2020 2020 2020 2020                  
+0002f9e0: 2020 2020 2020 2020 2020 2020 2020 2020                  
+0002f9f0: 2020 2020 2020 2020 2020 2020 2020 2020                  
+0002fa00: 2020 2020 2020 636c 6173 735f 7765 6967        class_weig
+0002fa10: 6874 3d63 6c61 7373 5f77 6569 6768 7473  ht=class_weights
+0002fa20: 2c20 6e5f 6a6f 6273 3d2d 312c 0a20 2020  , n_jobs=-1,.   
+0002fa30: 2020 2020 2020 2020 2020 2020 2020 2020                  
+0002fa40: 2020 2020 2020 2020 2020 2020 2020 2020                  
+0002fa50: 2020 2020 2020 2020 2020 2020 2020 2020                  
+0002fa60: 2020 2020 2020 2020 2020 2020 2029 0a20               ). 
+0002fa70: 2020 2020 2020 2020 2020 2020 2020 2020                  
+0002fa80: 2020 2020 2020 2020 2020 2020 2020 2065                 e
+0002fa90: 6c73 653a 0a20 2020 2020 2020 2020 2020  lse:.           
+0002faa0: 2020 2020 2020 2020 2020 2020 2020 2020                  
+0002fab0: 2020 2020 2020 2020 2023 2323 2054 6869           ### Thi
+0002fac0: 7320 6973 2066 6f72 206c 6172 6765 2064  s is for large d
+0002fad0: 6174 6173 6574 7320 696e 2042 696e 6172  atasets in Binar
+0002fae0: 7920 636c 6173 7365 7320 2323 2323 2323  y classes ######
+0002faf0: 2323 2323 230a 2020 2020 2020 2020 2020  #####.          
+0002fb00: 2020 2020 2020 2020 2020 2020 2020 2020                  
+0002fb10: 2020 2020 2020 2020 2020 6966 2073 656c            if sel
+0002fb20: 662e 7665 7262 6f73 653a 0a20 2020 2020  f.verbose:.     
+0002fb30: 2020 2020 2020 2020 2020 2020 2020 2020                  
+0002fb40: 2020 2020 2020 2020 2020 2020 2020 2020                  
+0002fb50: 2020 2070 7269 6e74 2827 2020 2020 5365     print('    Se
+0002fb60: 6c65 6374 696e 6720 4c47 424d 2052 6567  lecting LGBM Reg
+0002fb70: 7265 7373 6f72 2061 7320 6261 7365 2065  ressor as base e
+0002fb80: 7374 696d 6174 6f72 2e2e 2e27 290a 2020  stimator...').  
+0002fb90: 2020 2020 2020 2020 2020 2020 2020 2020                  
+0002fba0: 2020 2020 2020 2020 2020 2020 2020 2020                  
+0002fbb0: 2020 6966 2067 7075 5f65 7869 7374 733a    if gpu_exists:
+0002fbc0: 0a20 2020 2020 2020 2020 2020 2020 2020  .               
+0002fbd0: 2020 2020 2020 2020 2020 2020 2020 2020                  
+0002fbe0: 2020 2020 2020 2020 2073 656c 662e 6261           self.ba
+0002fbf0: 7365 5f65 7374 696d 6174 6f72 203d 2058  se_estimator = X
+0002fc00: 4742 436c 6173 7369 6669 6572 286e 5f65  GBClassifier(n_e
+0002fc10: 7374 696d 6174 6f72 733d 3235 302c 200a  stimators=250, .
+0002fc20: 2020 2020 2020 2020 2020 2020 2020 2020                  
+0002fc30: 2020 2020 2020 2020 2020 2020 2020 2020                  
+0002fc40: 2020 2020 2020 2020 2020 2020 6e5f 6a6f              n_jo
+0002fc50: 6273 3d2d 312c 7472 6565 5f6d 6574 686f  bs=-1,tree_metho
+0002fc60: 6420 3d20 2767 7075 5f68 6973 7427 2c67  d = 'gpu_hist',g
+0002fc70: 7075 5f69 643d 302c 2070 7265 6469 6374  pu_id=0, predict
+0002fc80: 6f72 3d22 6770 755f 7072 6564 6963 746f  or="gpu_predicto
+0002fc90: 7222 290a 2020 2020 2020 2020 2020 2020  r").            
+0002fca0: 2020 2020 2020 2020 2020 2020 2020 2020                  
+0002fcb0: 2020 2020 2020 2020 656c 7365 3a0a 2020          else:.  
+0002fcc0: 2020 2020 2020 2020 2020 2020 2020 2020                  
+0002fcd0: 2020 2020 2020 2020 2020 2020 2020 2020                  
+0002fce0: 2020 2020 2020 7365 6c66 2e62 6173 655f        self.base_
+0002fcf0: 6573 7469 6d61 746f 7220 3d20 4c47 424d  estimator = LGBM
+0002fd00: 436c 6173 7369 6669 6572 2864 6576 6963  Classifier(devic
+0002fd10: 653d 6465 7669 6365 2c20 7261 6e64 6f6d  e=device, random
+0002fd20: 5f73 7461 7465 3d72 616e 646f 6d5f 7365  _state=random_se
+0002fd30: 6564 2c20 0a20 2020 2020 2020 2020 2020  ed, .           
+0002fd40: 2020 2020 2020 2020 2020 2020 2020 2020                  
+0002fd50: 2020 2020 2020 2020 2020 2020 2020 2020                  
+0002fd60: 2020 2020 2020 2020 2020 2020 2020 2020                  
+0002fd70: 206e 5f6a 6f62 733d 2d31 2c0a 2020 2020   n_jobs=-1,.    
+0002fd80: 2020 2020 2020 2020 2020 2020 2020 2020                  
+0002fd90: 2020 2020 2020 2020 2020 2020 2020 2020                  
+0002fda0: 2020 2020 2020 2020 2020 2020 2020 2020                  
+0002fdb0: 2020 2020 2020 2020 2369 735f 756e 6261          #is_unba
+0002fdc0: 6c61 6e63 653d 5472 7565 2c20 0a20 2020  lance=True, .   
+0002fdd0: 2020 2020 2020 2020 2020 2020 2020 2020                  
+0002fde0: 2020 2020 2020 2020 2020 2020 2020 2020                  
+0002fdf0: 2020 2020 2020 2020 2020 2020 2020 2020                  
+0002fe00: 2020 2020 2020 2020 2023 6d61 785f 6465           #max_de
+0002fe10: 7074 683d 3130 2c20 6d65 7472 6963 3d6d  pth=10, metric=m
+0002fe20: 6574 7269 632c 0a20 2020 2020 2020 2020  etric,.         
+0002fe30: 2020 2020 2020 2020 2020 2020 2020 2020                  
+0002fe40: 2020 2020 2020 2020 2020 2020 2020 2020                  
+0002fe50: 2020 2020 2020 2020 2020 2020 2020 2020                  
+0002fe60: 2020 2023 6e75 6d5f 636c 6173 733d 7365     #num_class=se
+0002fe70: 6c66 2e6d 6178 5f6e 756d 6265 725f 6f66  lf.max_number_of
+0002fe80: 5f63 6c61 7373 6573 2c0a 2020 2020 2020  _classes,.      
+0002fe90: 2020 2020 2020 2020 2020 2020 2020 2020                  
+0002fea0: 2020 2020 2020 2020 2020 2020 2020 2020                  
+0002feb0: 2020 2020 2020 2020 2020 2020 2020 2020                  
+0002fec0: 2020 2020 2020 236e 5f65 7374 696d 6174        #n_estimat
+0002fed0: 6f72 733d 3130 302c 2020 6e75 6d5f 6c65  ors=100,  num_le
+0002fee0: 6176 6573 3d38 342c 200a 2020 2020 2020  aves=84, .      
+0002fef0: 2020 2020 2020 2020 2020 2020 2020 2020                  
+0002ff00: 2020 2020 2020 2020 2020 2020 2020 2020                  
+0002ff10: 2020 2020 2020 2020 2020 2020 2020 2020                  
+0002ff20: 2020 2020 2020 236f 626a 6563 7469 7665        #objective
+0002ff30: 3d27 6269 6e61 7279 272c 0a20 2020 2020  ='binary',.     
+0002ff40: 2020 2020 2020 2020 2020 2020 2020 2020                  
+0002ff50: 2020 2020 2020 2020 2020 2020 2020 2020                  
+0002ff60: 2020 2020 2020 2020 2020 2020 2020 2020                  
+0002ff70: 2020 2020 2020 2023 626f 6f73 7469 6e67         #boosting
+0002ff80: 5f74 7970 6520 3d27 676f 7373 272c 200a  _type ='goss', .
+0002ff90: 2020 2020 2020 2020 2020 2020 2020 2020                  
+0002ffa0: 2020 2020 2020 2020 2020 2020 2020 2020                  
+0002ffb0: 2020 2020 2020 2020 2020 2020 2020 2020                  
+0002ffc0: 2020 2020 2020 2020 2020 2020 2373 6361              #sca
+0002ffd0: 6c65 5f70 6f73 5f77 6569 6768 743d 7363  le_pos_weight=sc
+0002ffe0: 616c 655f 706f 735f 7765 6967 6874 2c0a  ale_pos_weight,.
+0002fff0: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00030000: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00030010: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00030020: 2020 2020 2020 2020 2020 2063 6c61 7373             class
+00030030: 5f77 6569 6768 743d 636c 6173 735f 7765  _weight=class_we
+00030040: 6967 6874 732c 0a20 2020 2020 2020 2020  ights,.         
+00030050: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00030060: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00030070: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00030080: 2020 2029 0a20 2020 2020 2020 2020 2020     ).           
+00030090: 2020 2020 2020 2020 2020 2020 2065 6c73               els
+000300a0: 653a 0a20 2020 2020 2020 2020 2020 2020  e:.             
+000300b0: 2020 2020 2020 2020 2020 2020 2020 2023                 #
 000300c0: 2323 2323 2323 2323 2323 2323 2323 2323  ################
-000300d0: 2323 2323 2323 2323 2323 0a64 6566 2063  ##########.def c
-000300e0: 6865 636b 5f69 665f 4750 555f 6578 6973  heck_if_GPU_exis
-000300f0: 7473 2829 3a0a 2020 2020 7472 793a 0a20  ts():.    try:. 
-00030100: 2020 2020 2020 206f 732e 656e 7669 726f         os.enviro
-00030110: 6e5b 274e 5649 4449 415f 5649 5349 424c  n['NVIDIA_VISIBL
-00030120: 455f 4445 5649 4345 5327 5d0a 2020 2020  E_DEVICES'].    
-00030130: 2020 2020 7072 696e 7428 2747 5055 2061      print('GPU a
-00030140: 6374 6976 6520 6f6e 2074 6869 7320 6465  ctive on this de
-00030150: 7669 6365 2729 0a20 2020 2020 2020 2072  vice').        r
-00030160: 6574 7572 6e20 5472 7565 0a20 2020 2065  eturn True.    e
-00030170: 7863 6570 743a 0a20 2020 2020 2020 2070  xcept:.        p
-00030180: 7269 6e74 2827 4e6f 2047 5055 2061 6374  rint('No GPU act
-00030190: 6976 6520 6f6e 2074 6869 7320 6465 7669  ive on this devi
-000301a0: 6365 2729 0a20 2020 2020 2020 2072 6574  ce').        ret
-000301b0: 7572 6e20 4661 6c73 650a 2323 2323 2323  urn False.######
-000301c0: 2323 2323 2323 2323 2323 2323 2323 2323  ################
-000301d0: 2323 2323 2323 2323 2323 2323 2323 2323  ################
-000301e0: 2323 2323 2323 2323 2323 2323 2323 2323  ################
+000300d0: 2323 2323 2323 2323 2323 2323 2323 2323  ################
+000300e0: 2323 2323 2323 2323 2323 2323 2323 2323  ################
+000300f0: 2323 2323 2323 2323 2323 2323 0a20 2020  ############.   
+00030100: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00030110: 2020 2020 2020 2020 2023 2323 2020 2054           ###   T
+00030120: 6869 7320 6973 2066 6f72 204d 756c 7469  his is for Multi
+00030130: 2043 6c61 7373 6966 6963 6174 696f 6e20   Classification 
+00030140: 7072 6f62 6c65 6d73 206f 6e6c 7920 2323  problems only ##
+00030150: 2323 2323 2323 0a20 2020 2020 2020 2020  ######.         
+00030160: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00030170: 2020 2023 2323 204d 616b 6520 7375 7265     ### Make sure
+00030180: 2079 6f75 2064 6f6e 2774 2070 7574 2061   you don't put a
+00030190: 6e79 2063 6c61 7373 2077 6569 6768 7473  ny class weights
+000301a0: 2068 6572 6520 7369 6e63 6520 6974 2077   here since it w
+000301b0: 6f6e 2774 2077 6f72 6b20 696e 206d 756c  on't work in mul
+000301c0: 7469 2d6c 6162 656c 7320 2323 0a20 2020  ti-labels ##.   
+000301d0: 2020 2020 2020 2020 2020 2020 2020 2020                  
+000301e0: 2020 2020 2020 2020 2023 2323 2323 2323           #######
 000301f0: 2323 2323 2323 2323 2323 2323 2323 2323  ################
 00030200: 2323 2323 2323 2323 2323 2323 2323 2323  ################
-00030210: 2323 2323 2323 0a23 2323 2320 2020 2020  ######.####     
-00030220: 2020 2054 6869 7320 6973 2077 6865 7265     This is where
-00030230: 2053 554c 4f20 434c 4153 5349 4649 4552   SULO CLASSIFIER
-00030240: 2041 4e44 2052 4547 5245 5353 4f52 2041   AND REGRESSOR A
-00030250: 5245 2044 4546 494e 4544 2020 2020 2020  RE DEFINED      
-00030260: 2020 2020 2323 2323 2323 2323 2323 2323      ############
-00030270: 2323 230a 2323 2323 2323 2323 2323 2323  ###.############
-00030280: 2323 2323 2323 2323 2323 2323 2323 2323  ################
-00030290: 2323 2323 2323 2323 2323 2323 2323 2323  ################
-000302a0: 2323 2323 2323 2323 2323 2323 2323 2323  ################
-000302b0: 2323 2323 2323 2323 2323 2323 2323 2323  ################
-000302c0: 2323 2323 2323 2323 2323 2323 2323 2323  ################
-000302d0: 0a69 6d70 6f72 7420 6e75 6d70 7920 6173  .import numpy as
-000302e0: 206e 700a 696d 706f 7274 2070 616e 6461   np.import panda
-000302f0: 7320 6173 2070 640a 2323 2323 2323 2323  s as pd.########
-00030300: 2323 2323 2323 2323 2323 2323 2323 2323  ################
-00030310: 2323 2323 2323 2323 2323 2323 2323 2323  ################
-00030320: 2323 2323 2323 2323 2323 2323 2323 2323  ################
-00030330: 2323 2323 2323 2323 2323 2323 2323 2323  ################
-00030340: 2323 2323 2323 2323 0a69 6d70 6f72 7420  ########.import 
-00030350: 7761 726e 696e 6773 0a77 6172 6e69 6e67  warnings.warning
-00030360: 732e 6669 6c74 6572 7761 726e 696e 6773  s.filterwarnings
-00030370: 2822 6967 6e6f 7265 2229 0a66 726f 6d20  ("ignore").from 
-00030380: 736b 6c65 6172 6e2e 6578 6365 7074 696f  sklearn.exceptio
-00030390: 6e73 2069 6d70 6f72 7420 4461 7461 436f  ns import DataCo
-000303a0: 6e76 6572 7369 6f6e 5761 726e 696e 670a  nversionWarning.
-000303b0: 7761 726e 696e 6773 2e66 696c 7465 7277  warnings.filterw
-000303c0: 6172 6e69 6e67 7328 6163 7469 6f6e 3d27  arnings(action='
-000303d0: 6967 6e6f 7265 272c 2063 6174 6567 6f72  ignore', categor
-000303e0: 793d 4461 7461 436f 6e76 6572 7369 6f6e  y=DataConversion
-000303f0: 5761 726e 696e 6729 0a77 6974 6820 7761  Warning).with wa
-00030400: 726e 696e 6773 2e63 6174 6368 5f77 6172  rnings.catch_war
-00030410: 6e69 6e67 7328 293a 0a20 2020 2077 6172  nings():.    war
-00030420: 6e69 6e67 732e 7369 6d70 6c65 6669 6c74  nings.simplefilt
-00030430: 6572 2822 6967 6e6f 7265 2229 0a23 2323  er("ignore").###
-00030440: 2323 2323 2323 2323 2323 2323 2323 2323  ################
-00030450: 2323 2323 2323 2323 2323 2323 2323 2323  ################
-00030460: 2323 2323 2323 2323 2323 2323 2323 2323  ################
-00030470: 2323 2323 2323 2323 2323 2323 2323 2323  ################
-00030480: 2323 2323 2323 2323 2323 2323 230a 696d  #############.im
-00030490: 706f 7274 206d 6174 680a 6672 6f6d 2063  port math.from c
-000304a0: 6f6c 6c65 6374 696f 6e73 2069 6d70 6f72  ollections impor
-000304b0: 7420 436f 756e 7465 720a 6672 6f6d 2073  t Counter.from s
-000304c0: 6b6c 6561 726e 2e6c 696e 6561 725f 6d6f  klearn.linear_mo
-000304d0: 6465 6c20 696d 706f 7274 2052 6964 6765  del import Ridge
-000304e0: 2c20 4c61 7373 6f2c 2052 6964 6765 4356  , Lasso, RidgeCV
-000304f0: 0a66 726f 6d20 736b 6c65 6172 6e2e 7472  .from sklearn.tr
-00030500: 6565 2069 6d70 6f72 7420 4465 6369 7369  ee import Decisi
-00030510: 6f6e 5472 6565 436c 6173 7369 6669 6572  onTreeClassifier
-00030520: 2c20 4465 6369 7369 6f6e 5472 6565 5265  , DecisionTreeRe
-00030530: 6772 6573 736f 720a 6672 6f6d 2073 6b6c  gressor.from skl
-00030540: 6561 726e 2e65 6e73 656d 626c 6520 696d  earn.ensemble im
-00030550: 706f 7274 2052 616e 646f 6d46 6f72 6573  port RandomFores
-00030560: 7443 6c61 7373 6966 6965 722c 2052 616e  tClassifier, Ran
-00030570: 646f 6d46 6f72 6573 7452 6567 7265 7373  domForestRegress
-00030580: 6f72 2c20 4164 6142 6f6f 7374 436c 6173  or, AdaBoostClas
-00030590: 7369 6669 6572 0a66 726f 6d20 736b 6c65  sifier.from skle
-000305a0: 6172 6e2e 656e 7365 6d62 6c65 2069 6d70  arn.ensemble imp
-000305b0: 6f72 7420 4578 7472 6154 7265 6573 436c  ort ExtraTreesCl
-000305c0: 6173 7369 6669 6572 2c20 4578 7472 6154  assifier, ExtraT
-000305d0: 7265 6573 5265 6772 6573 736f 720a 6672  reesRegressor.fr
-000305e0: 6f6d 2073 6b6c 6561 726e 2e6c 696e 6561  om sklearn.linea
-000305f0: 725f 6d6f 6465 6c20 696d 706f 7274 204c  r_model import L
-00030600: 6f67 6973 7469 6352 6567 7265 7373 696f  ogisticRegressio
-00030610: 6e2c 204c 6f67 6973 7469 6352 6567 7265  n, LogisticRegre
-00030620: 7373 696f 6e43 560a 6672 6f6d 2073 6b6c  ssionCV.from skl
-00030630: 6561 726e 2e6d 756c 7469 636c 6173 7320  earn.multiclass 
-00030640: 696d 706f 7274 204f 6e65 5673 5265 7374  import OneVsRest
-00030650: 436c 6173 7369 6669 6572 2c20 4f6e 6556  Classifier, OneV
-00030660: 734f 6e65 436c 6173 7369 6669 6572 0a66  sOneClassifier.f
-00030670: 726f 6d20 736b 6c65 6172 6e2e 6d65 7472  rom sklearn.metr
-00030680: 6963 7320 696d 706f 7274 2061 6363 7572  ics import accur
-00030690: 6163 795f 7363 6f72 650a 6672 6f6d 2073  acy_score.from s
-000306a0: 6b6c 6561 726e 2e6d 6f64 656c 5f73 656c  klearn.model_sel
-000306b0: 6563 7469 6f6e 2069 6d70 6f72 7420 4b46  ection import KF
-000306c0: 6f6c 642c 2053 7472 6174 6966 6965 644b  old, StratifiedK
-000306d0: 466f 6c64 0a69 6d70 6f72 7420 7469 6d65  Fold.import time
-000306e0: 0a66 726f 6d20 736b 6c65 6172 6e2e 636c  .from sklearn.cl
-000306f0: 7573 7465 7220 696d 706f 7274 204b 4d65  uster import KMe
-00030700: 616e 730a 6672 6f6d 206d 6174 706c 6f74  ans.from matplot
-00030710: 6c69 622e 7079 706c 6f74 2069 6d70 6f72  lib.pyplot impor
-00030720: 7420 6669 6775 7265 0a66 726f 6d20 736b  t figure.from sk
-00030730: 6c65 6172 6e2e 6d65 7472 6963 732e 636c  learn.metrics.cl
-00030740: 7573 7465 7220 696d 706f 7274 206e 6f72  uster import nor
-00030750: 6d61 6c69 7a65 645f 6d75 7475 616c 5f69  malized_mutual_i
-00030760: 6e66 6f5f 7363 6f72 650a 6672 6f6d 2073  nfo_score.from s
-00030770: 6b6c 6561 726e 2e6d 6574 7269 6373 2069  klearn.metrics i
-00030780: 6d70 6f72 7420 6261 6c61 6e63 6564 5f61  mport balanced_a
-00030790: 6363 7572 6163 795f 7363 6f72 650a 6672  ccuracy_score.fr
-000307a0: 6f6d 2073 6b6c 6561 726e 2e65 6e73 656d  om sklearn.ensem
-000307b0: 626c 6520 696d 706f 7274 2056 6f74 696e  ble import Votin
-000307c0: 6752 6567 7265 7373 6f72 2c20 566f 7469  gRegressor, Voti
-000307d0: 6e67 436c 6173 7369 6669 6572 0a69 6d70  ngClassifier.imp
-000307e0: 6f72 7420 636f 7079 0a66 726f 6d20 736b  ort copy.from sk
-000307f0: 6c65 6172 6e2e 6261 7365 2069 6d70 6f72  learn.base impor
-00030800: 7420 4261 7365 4573 7469 6d61 746f 722c  t BaseEstimator,
-00030810: 2054 7261 6e73 666f 726d 6572 4d69 7869   TransformerMixi
-00030820: 6e2c 2052 6567 7265 7373 6f72 4d69 7869  n, RegressorMixi
-00030830: 6e2c 2063 6c6f 6e65 0a66 726f 6d20 736b  n, clone.from sk
-00030840: 6c65 6172 6e2e 6261 7365 2069 6d70 6f72  learn.base impor
-00030850: 7420 436c 6173 7369 6669 6572 4d69 7869  t ClassifierMixi
-00030860: 6e2c 2052 6567 7265 7373 6f72 4d69 7869  n, RegressorMixi
-00030870: 6e0a 6672 6f6d 2069 6d62 6c65 6172 6e2e  n.from imblearn.
-00030880: 6f76 6572 5f73 616d 706c 696e 6720 696d  over_sampling im
-00030890: 706f 7274 2053 4d4f 5445 4e43 2c20 4144  port SMOTENC, AD
-000308a0: 4153 594e 0a66 726f 6d20 696d 626c 6561  ASYN.from imblea
-000308b0: 726e 2e6f 7665 725f 7361 6d70 6c69 6e67  rn.over_sampling
-000308c0: 2069 6d70 6f72 7420 534d 4f54 452c 2053   import SMOTE, S
-000308d0: 564d 534d 4f54 450a 6672 6f6d 2069 6d62  VMSMOTE.from imb
-000308e0: 6c65 6172 6e2e 636f 6d62 696e 6520 696d  learn.combine im
-000308f0: 706f 7274 2053 4d4f 5445 546f 6d65 6b20  port SMOTETomek 
-00030900: 0a69 6d70 6f72 7420 6c69 6768 7467 626d  .import lightgbm
-00030910: 0a66 726f 6d20 6c69 6768 7467 626d 2069  .from lightgbm i
-00030920: 6d70 6f72 7420 4c47 424d 436c 6173 7369  mport LGBMClassi
-00030930: 6669 6572 2c20 4c47 424d 5265 6772 6573  fier, LGBMRegres
-00030940: 736f 720a 6672 6f6d 2078 6762 6f6f 7374  sor.from xgboost
-00030950: 2069 6d70 6f72 7420 5847 4252 6567 7265   import XGBRegre
-00030960: 7373 6f72 2c20 5847 4243 6c61 7373 6966  ssor, XGBClassif
-00030970: 6965 720a 6672 6f6d 2073 6b6c 6561 726e  ier.from sklearn
-00030980: 2e6d 756c 7469 6f75 7470 7574 2069 6d70  .multioutput imp
-00030990: 6f72 7420 4d75 6c74 694f 7574 7075 7452  ort MultiOutputR
-000309a0: 6567 7265 7373 6f72 2c20 4d75 6c74 694f  egressor, MultiO
-000309b0: 7574 7075 7443 6c61 7373 6966 6965 720a  utputClassifier.
-000309c0: 6672 6f6d 2073 6b6c 6561 726e 2e6d 756c  from sklearn.mul
-000309d0: 7469 6f75 7470 7574 2069 6d70 6f72 7420  tioutput import 
-000309e0: 436c 6173 7369 6669 6572 4368 6169 6e2c  ClassifierChain,
-000309f0: 2052 6567 7265 7373 6f72 4368 6169 6e0a   RegressorChain.
-00030a00: 696d 706f 7274 2073 6369 7079 2061 7320  import scipy as 
-00030a10: 7370 0a69 6d70 6f72 7420 7064 620a 6672  sp.import pdb.fr
-00030a20: 6f6d 2073 6b6c 6561 726e 2e73 656d 695f  om sklearn.semi_
-00030a30: 7375 7065 7276 6973 6564 2069 6d70 6f72  supervised impor
-00030a40: 7420 4c61 6265 6c50 726f 7061 6761 7469  t LabelPropagati
-00030a50: 6f6e 0a66 726f 6d20 736b 6c65 6172 6e2e  on.from sklearn.
-00030a60: 656e 7365 6d62 6c65 2069 6d70 6f72 7420  ensemble import 
-00030a70: 4261 6767 696e 6743 6c61 7373 6966 6965  BaggingClassifie
-00030a80: 722c 2042 6167 6769 6e67 5265 6772 6573  r, BaggingRegres
-00030a90: 736f 720a 6672 6f6d 2073 6b6c 6561 726e  sor.from sklearn
-00030aa0: 2e73 766d 2069 6d70 6f72 7420 5356 522c  .svm import SVR,
-00030ab0: 204c 696e 6561 7253 5652 0a66 726f 6d20   LinearSVR.from 
-00030ac0: 736b 6c65 6172 6e2e 7069 7065 6c69 6e65  sklearn.pipeline
-00030ad0: 2069 6d70 6f72 7420 5069 7065 6c69 6e65   import Pipeline
-00030ae0: 0a66 726f 6d20 736b 6c65 6172 6e2e 696d  .from sklearn.im
-00030af0: 7075 7465 2069 6d70 6f72 7420 5369 6d70  pute import Simp
-00030b00: 6c65 496d 7075 7465 722c 204d 6973 7369  leImputer, Missi
-00030b10: 6e67 496e 6469 6361 746f 720a 2366 726f  ngIndicator.#fro
-00030b20: 6d20 736b 6c65 6172 6e2e 7072 6570 726f  m sklearn.prepro
-00030b30: 6365 7373 696e 6720 696d 706f 7274 2053  cessing import S
-00030b40: 7461 6e64 6172 6453 6361 6c65 722c 204f  tandardScaler, O
-00030b50: 6e65 486f 7445 6e63 6f64 6572 2c20 4c61  neHotEncoder, La
-00030b60: 6265 6c45 6e63 6f64 6572 0a66 726f 6d20  belEncoder.from 
-00030b70: 736b 6c65 6172 6e2e 636f 6d70 6f73 6520  sklearn.compose 
-00030b80: 696d 706f 7274 2043 6f6c 756d 6e54 7261  import ColumnTra
-00030b90: 6e73 666f 726d 6572 0a66 726f 6d20 7363  nsformer.from sc
-00030ba0: 6970 792e 7374 6174 7320 696d 706f 7274  ipy.stats import
-00030bb0: 2075 6e69 666f 726d 2061 7320 7370 5f72   uniform as sp_r
-00030bc0: 616e 6446 6c6f 6174 0a66 726f 6d20 7363  andFloat.from sc
-00030bd0: 6970 792e 7374 6174 7320 696d 706f 7274  ipy.stats import
-00030be0: 2072 616e 6469 6e74 2061 7320 7370 5f72   randint as sp_r
-00030bf0: 616e 6449 6e74 0a0a 636c 6173 7320 5375  andInt..class Su
-00030c00: 6c6f 436c 6173 7369 6669 6572 2842 6173  loClassifier(Bas
-00030c10: 6545 7374 696d 6174 6f72 2c20 436c 6173  eEstimator, Clas
-00030c20: 7369 6669 6572 4d69 7869 6e29 3a0a 2020  sifierMixin):.  
-00030c30: 2020 2222 220a 2020 2020 5375 6c6f 436c    """.    SuloCl
-00030c40: 6173 7369 6669 6572 2073 7461 6e64 7320  assifier stands 
-00030c50: 666f 7220 5375 7065 7220 4c65 6172 6e69  for Super Learni
-00030c60: 6e67 204f 7074 696d 697a 6564 2028 5355  ng Optimized (SU
-00030c70: 4c4f 2920 436c 6173 7369 6669 6572 2e0a  LO) Classifier..
-00030c80: 2020 2020 2d2d 2049 7420 776f 726b 7320      -- It works 
-00030c90: 6f6e 2073 6d61 6c6c 2061 7320 7765 6c6c  on small as well
-00030ca0: 2061 7320 6269 6720 6461 7461 2e20 4974   as big data. It
-00030cb0: 2077 6f72 6b73 2069 6e20 496e 7465 6765   works in Intege
-00030cc0: 7220 6d6f 6465 2061 7320 7765 6c6c 2061  r mode as well a
-00030cd0: 7320 666c 6f61 742d 6d6f 6465 2e0a 2020  s float-mode..  
-00030ce0: 2020 2d2d 2049 7420 776f 726b 7320 6f6e    -- It works on
-00030cf0: 2072 6567 756c 6172 2062 616c 616e 6365   regular balance
-00030d00: 6420 6461 7461 2061 7320 7765 6c6c 2061  d data as well a
-00030d10: 7320 736b 6577 6564 2072 6567 7265 7373  s skewed regress
-00030d20: 696f 6e20 7461 7267 6574 732e 0a20 2020  ion targets..   
-00030d30: 2054 6865 2072 6561 736f 6e20 6974 2077   The reason it w
-00030d40: 6f72 6b73 2073 6f20 7765 6c6c 2069 7320  orks so well is 
-00030d50: 7468 6174 2053 756c 6f20 6973 2061 6e20  that Sulo is an 
-00030d60: 656e 7365 6d62 6c65 206f 6620 6869 6768  ensemble of high
-00030d70: 6c79 2074 756e 6564 206d 6f64 656c 732e  ly tuned models.
-00030d80: 0a20 2020 202d 2d20 596f 7520 646f 6e27  .    -- You don'
-00030d90: 7420 6861 7665 2074 6f20 7365 6e64 2061  t have to send a
-00030da0: 6e79 2069 6e70 7574 7320 6275 7420 6966  ny inputs but if
-00030db0: 2079 6f75 2077 616e 7465 6420 746f 2c20   you wanted to, 
-00030dc0: 796f 7520 6361 6e20 7370 6566 6966 7920  you can spefify 
-00030dd0: 6d75 6c74 6970 6c65 206f 7074 696f 6e73  multiple options
-00030de0: 2e0a 2020 2020 4974 2069 7320 6675 6c6c  ..    It is full
-00030df0: 7920 636f 6d70 6174 6962 6c65 2077 6974  y compatible wit
-00030e00: 6820 7363 696b 6974 2d6c 6561 726e 2070  h scikit-learn p
-00030e10: 6970 656c 696e 6573 2061 6e64 206f 7468  ipelines and oth
-00030e20: 6572 206d 6f64 656c 732e 0a0a 2020 2020  er models...    
-00030e30: 496e 7075 7473 3a0a 2020 2020 2020 2020  Inputs:.        
-00030e40: 6e5f 6573 7469 6d61 746f 7273 3a20 6465  n_estimators: de
-00030e50: 6661 756c 7420 6973 204e 6f6e 652e 204e  fault is None. N
-00030e60: 756d 6265 7220 6f66 206d 6f64 656c 7320  umber of models 
-00030e70: 796f 7520 7761 6e74 2069 6e20 7468 6520  you want in the 
-00030e80: 6669 6e61 6c20 656e 7365 6d62 6c65 2e0a  final ensemble..
-00030e90: 2020 2020 2020 2020 6261 7365 5f65 7374          base_est
-00030ea0: 696d 6174 6f72 3a20 6465 6661 756c 7420  imator: default 
-00030eb0: 6973 204e 6f6e 652e 2042 6173 6520 6d6f  is None. Base mo
-00030ec0: 6465 6c20 796f 7520 7761 6e74 2074 6f20  del you want to 
-00030ed0: 7472 6169 6e20 696e 2065 6163 6820 6f66  train in each of
-00030ee0: 2074 6865 2065 6e73 656d 626c 6573 2e0a   the ensembles..
-00030ef0: 2020 2020 2020 2020 7069 7065 6c69 6e65          pipeline
-00030f00: 3a20 6465 6661 756c 7420 6973 2046 616c  : default is Fal
-00030f10: 7365 2e20 4974 2077 696c 6c20 7472 616e  se. It will tran
-00030f20: 7366 6f72 6d20 616c 6c20 6461 7461 2074  sform all data t
-00030f30: 6f20 6e75 6d65 7269 6320 6175 746f 6d61  o numeric automa
-00030f40: 7469 6361 6c6c 7920 6966 2073 6574 2074  tically if set t
-00030f50: 6f20 5472 7565 2e0a 2020 2020 2020 2020  o True..        
-00030f60: 7765 6967 6874 733a 2064 6566 6175 6c74  weights: default
-00030f70: 2069 7320 4661 6c73 652e 2049 7420 7769   is False. It wi
-00030f80: 6c6c 2070 6572 666f 726d 2077 6569 6768  ll perform weigh
-00030f90: 7469 6e67 206f 6620 6469 6666 6572 656e  ting of differen
-00030fa0: 7420 636c 6173 7369 6669 6572 7320 6966  t classifiers if
-00030fb0: 2073 6574 2074 6f20 5472 7565 0a20 2020   set to True.   
-00030fc0: 2020 2020 2069 6d62 616c 616e 6365 643a       imbalanced:
-00030fd0: 2064 6566 6175 6c74 2069 7320 4661 6c73   default is Fals
-00030fe0: 652e 2049 7420 7769 6c6c 2061 6374 6976  e. It will activ
-00030ff0: 6174 6520 6120 7370 6563 6961 6c20 696d  ate a special im
-00031000: 6261 6c61 6e63 6564 2063 6c61 7373 6966  balanced classif
-00031010: 6965 7220 6966 2073 6574 2074 6f20 5472  ier if set to Tr
-00031020: 7565 2e0a 2020 2020 2020 2020 7665 7262  ue..        verb
-00031030: 6f73 653a 2064 6566 6175 6c74 2069 7320  ose: default is 
-00031040: 302e 2049 7420 7769 6c6c 2070 7269 6e74  0. It will print
-00031050: 2076 6572 626f 7365 206f 7574 7075 7420   verbose output 
-00031060: 6966 2073 6574 2074 6f20 5472 7565 2e0a  if set to True..
-00031070: 0a20 2020 204f 7574 7574 733a 0a20 2020  .    Oututs:.   
-00031080: 2020 2020 2053 756c 6f43 6c61 7373 6966       SuloClassif
-00031090: 6965 723a 2072 6574 7572 6e73 2061 2063  ier: returns a c
-000310a0: 6c61 7373 6966 6963 6174 696f 6e20 6d6f  lassification mo
-000310b0: 6465 6c20 6869 6768 6c79 2074 756e 6564  del highly tuned
-000310c0: 2074 6f20 796f 7572 2073 7065 6369 6669   to your specifi
-000310d0: 6320 6e65 6564 7320 616e 6420 6461 7461  c needs and data
-000310e0: 7365 742e 0a20 2020 2022 2222 0a20 2020  set..    """.   
-000310f0: 2064 6566 205f 5f69 6e69 745f 5f28 7365   def __init__(se
-00031100: 6c66 2c20 6261 7365 5f65 7374 696d 6174  lf, base_estimat
-00031110: 6f72 3d4e 6f6e 652c 206e 5f65 7374 696d  or=None, n_estim
-00031120: 6174 6f72 733d 4e6f 6e65 2c20 7069 7065  ators=None, pipe
-00031130: 6c69 6e65 3d54 7275 652c 2077 6569 6768  line=True, weigh
-00031140: 7473 3d46 616c 7365 2c20 0a20 2020 2020  ts=False, .     
-00031150: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00030210: 2323 2323 2323 2323 2323 2323 2323 2323  ################
+00030220: 2323 2323 2323 230a 2020 2020 2020 2020  #######.        
+00030230: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00030240: 2020 2020 6966 2073 656c 662e 696d 6261      if self.imba
+00030250: 6c61 6e63 6564 3a0a 2020 2020 2020 2020  lanced:.        
+00030260: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00030270: 2020 2020 2020 2020 6966 2073 656c 662e          if self.
+00030280: 7665 7262 6f73 653a 0a20 2020 2020 2020  verbose:.       
+00030290: 2020 2020 2020 2020 2020 2020 2020 2020                  
+000302a0: 2020 2020 2020 2020 2020 2020 2070 7269               pri
+000302b0: 6e74 2827 2020 2020 5365 6c65 6374 696e  nt('    Selectin
+000302c0: 6720 5365 6c66 2050 6163 6564 2065 6e73  g Self Paced ens
+000302d0: 656d 626c 6520 636c 6173 7369 6669 6572  emble classifier
+000302e0: 2073 696e 6365 2069 6d62 616c 616e 6365   since imbalance
+000302f0: 6420 666c 6167 2069 7320 7365 742e 2e2e  d flag is set...
+00030300: 2729 0a20 2020 2020 2020 2020 2020 2020  ').             
+00030310: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00030320: 2020 2074 7279 3a0a 2020 2020 2020 2020     try:.        
+00030330: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00030340: 2020 2020 2020 2020 2020 2020 6672 6f6d              from
+00030350: 2069 6d62 616c 616e 6365 645f 656e 7365   imbalanced_ense
+00030360: 6d62 6c65 2e65 6e73 656d 626c 6520 696d  mble.ensemble im
+00030370: 706f 7274 2053 656c 6650 6163 6564 456e  port SelfPacedEn
+00030380: 7365 6d62 6c65 436c 6173 7369 6669 6572  sembleClassifier
+00030390: 0a20 2020 2020 2020 2020 2020 2020 2020  .               
+000303a0: 2020 2020 2020 2020 2020 2020 2020 2020                  
+000303b0: 2020 2020 2073 656c 662e 6261 7365 5f65       self.base_e
+000303c0: 7374 696d 6174 6f72 203d 2053 656c 6650  stimator = SelfP
+000303d0: 6163 6564 456e 7365 6d62 6c65 436c 6173  acedEnsembleClas
+000303e0: 7369 6669 6572 286e 5f6a 6f62 733d 2d31  sifier(n_jobs=-1
+000303f0: 2c20 7261 6e64 6f6d 5f73 7461 7465 3d72  , random_state=r
+00030400: 616e 646f 6d5f 7365 6564 290a 2020 2020  andom_seed).    
+00030410: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00030420: 2020 2020 2020 2020 2020 2020 6578 6365              exce
+00030430: 7074 3a0a 2020 2020 2020 2020 2020 2020  pt:.            
+00030440: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00030450: 2020 2020 2020 2020 7072 696e 7428 2770          print('p
+00030460: 6970 2069 6e73 7461 6c6c 2069 6d62 616c  ip install imbal
+00030470: 616e 6365 645f 656e 7365 6d62 6c65 2061  anced_ensemble a
+00030480: 6e64 2072 652d 7275 6e20 7468 6973 2061  nd re-run this a
+00030490: 6761 696e 2e27 290a 2020 2020 2020 2020  gain.').        
+000304a0: 2020 2020 2020 2020 2020 2020 2020 2020                  
+000304b0: 2020 2020 2020 2020 2020 2020 7265 7475              retu
+000304c0: 726e 2073 656c 660a 2020 2020 2020 2020  rn self.        
+000304d0: 2020 2020 2020 2020 2020 2020 2020 2020                  
+000304e0: 2020 2020 2020 2020 7365 6c66 2e6d 6f64          self.mod
+000304f0: 656c 5f6e 616d 6520 3d20 276f 7468 6572  el_name = 'other
+00030500: 270a 2020 2020 2020 2020 2020 2020 2020  '.              
+00030510: 2020 2020 2020 2020 2020 2020 2020 656c                el
+00030520: 7365 3a0a 2020 2020 2020 2020 2020 2020  se:.            
+00030530: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00030540: 2020 2020 6966 2064 6174 615f 7361 6d70      if data_samp
+00030550: 6c65 7320 3c3d 2072 6f77 5f6c 696d 6974  les <= row_limit
+00030560: 3a0a 2020 2020 2020 2020 2020 2020 2020  :.              
+00030570: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00030580: 2020 2020 2020 6966 206c 656e 2873 656c        if len(sel
+00030590: 662e 6665 6174 7572 6573 2920 3c3d 2066  f.features) <= f
+000305a0: 6561 7475 7265 735f 6c69 6d69 743a 0a20  eatures_limit:. 
+000305b0: 2020 2020 2020 2020 2020 2020 2020 2020                  
+000305c0: 2020 2020 2020 2020 2020 2020 2020 2020                  
+000305d0: 2020 2020 2020 2069 6620 7365 6c66 2e76         if self.v
+000305e0: 6572 626f 7365 3a0a 2020 2020 2020 2020  erbose:.        
+000305f0: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00030600: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00030610: 2020 2020 7072 696e 7428 2720 2020 2053      print('    S
+00030620: 656c 6563 7469 6e67 2045 7874 7261 2054  electing Extra T
+00030630: 7265 6573 2043 6c61 7373 6966 6965 7220  rees Classifier 
+00030640: 666f 7220 736d 616c 6c20 6461 7461 7365  for small datase
+00030650: 7473 2e2e 2e27 290a 2020 2020 2020 2020  ts...').        
+00030660: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00030670: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00030680: 7365 6c66 2e62 6173 655f 6573 7469 6d61  self.base_estima
+00030690: 746f 7220 3d20 4578 7472 6154 7265 6573  tor = ExtraTrees
+000306a0: 436c 6173 7369 6669 6572 2872 616e 646f  Classifier(rando
+000306b0: 6d5f 7374 6174 653d 7261 6e64 6f6d 5f73  m_state=random_s
+000306c0: 6565 6429 0a20 2020 2020 2020 2020 2020  eed).           
+000306d0: 2020 2020 2020 2020 2020 2020 2020 2020                  
+000306e0: 2020 2020 2020 2020 2020 2020 2073 656c               sel
+000306f0: 662e 6d6f 6465 6c5f 6e61 6d65 203d 2027  f.model_name = '
+00030700: 7266 270a 2020 2020 2020 2020 2020 2020  rf'.            
+00030710: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00030720: 2020 2020 2020 2020 656c 7365 3a0a 2020          else:.  
+00030730: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00030740: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00030750: 2020 2020 2020 7365 6c66 2e62 6173 655f        self.base_
+00030760: 6573 7469 6d61 746f 7220 3d20 4c47 424d  estimator = LGBM
+00030770: 5265 6772 6573 736f 7228 6e5f 6a6f 6273  Regressor(n_jobs
+00030780: 3d2d 312c 2064 6576 6963 653d 6465 7669  =-1, device=devi
+00030790: 6365 2c20 7261 6e64 6f6d 5f73 7461 7465  ce, random_state
+000307a0: 3d72 616e 646f 6d5f 7365 6564 2920 2020  =random_seed)   
+000307b0: 2020 2020 2020 2020 2020 2020 2020 2020                  
+000307c0: 2020 2020 2020 2020 2020 2020 2020 2020                  
+000307d0: 200a 2020 2020 2020 2020 2020 2020 2020   .              
+000307e0: 2020 2020 2020 2020 2020 2020 2020 2020                  
+000307f0: 2020 656c 7365 3a0a 2020 2020 2020 2020    else:.        
+00030800: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00030810: 2020 2020 2020 2020 2020 2020 6966 2028              if (
+00030820: 582e 6474 7970 6573 3d3d 666c 6f61 7429  X.dtypes==float)
+00030830: 2e61 6c6c 2829 2061 6e64 206c 656e 2873  .all() and len(s
+00030840: 656c 662e 6665 6174 7572 6573 2920 3c3d  elf.features) <=
+00030850: 2066 6561 7475 7265 735f 6c69 6d69 743a   features_limit:
+00030860: 0a20 2020 2020 2020 2020 2020 2020 2020  .               
+00030870: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00030880: 2020 2020 2020 2020 2070 7269 6e74 2827           print('
+00030890: 2020 2020 5365 6c65 6374 696e 6720 4c61      Selecting La
+000308a0: 6265 6c20 5072 6f70 6167 6174 696f 6e20  bel Propagation 
+000308b0: 7369 6e63 6520 6974 2077 6f72 6b73 2067  since it works g
+000308c0: 7265 6174 2066 6f72 206d 756c 7469 636c  reat for multicl
+000308d0: 6173 7320 7072 6f62 6c65 6d73 2e2e 2e27  ass problems...'
+000308e0: 290a 2020 2020 2020 2020 2020 2020 2020  ).              
+000308f0: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00030900: 2020 2020 2020 2020 2020 7072 696e 7428            print(
+00030910: 2720 2020 2020 2020 2068 6f77 6576 6572  '        however
+00030920: 2069 7420 7769 6c6c 2073 6b65 7720 7072   it will skew pr
+00030930: 6f62 6162 696c 6974 6965 7320 6120 6c69  obabilities a li
+00030940: 7474 6c65 2073 6f20 6265 2061 7761 7265  ttle so be aware
+00030950: 206f 6620 7468 6973 2729 0a20 2020 2020   of this').     
+00030960: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00030970: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00030980: 2020 2073 656c 662e 6261 7365 5f65 7374     self.base_est
+00030990: 696d 6174 6f72 203d 2020 4c61 6265 6c50  imator =  LabelP
+000309a0: 726f 7061 6761 7469 6f6e 2829 0a20 2020  ropagation().   
+000309b0: 2020 2020 2020 2020 2020 2020 2020 2020                  
+000309c0: 2020 2020 2020 2020 2020 2020 2020 2020                  
+000309d0: 2020 2020 2073 656c 662e 6d6f 6465 6c5f       self.model_
+000309e0: 6e61 6d65 203d 2027 6c70 270a 2020 2020  name = 'lp'.    
+000309f0: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00030a00: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00030a10: 656c 7365 3a0a 2020 2020 2020 2020 2020  else:.          
+00030a20: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00030a30: 2020 2020 2020 2020 2020 2020 2020 7365                se
+00030a40: 6c66 2e62 6173 655f 6573 7469 6d61 746f  lf.base_estimato
+00030a50: 7220 3d20 4c47 424d 436c 6173 7369 6669  r = LGBMClassifi
+00030a60: 6572 286e 5f6a 6f62 733d 2d31 2c20 6465  er(n_jobs=-1, de
+00030a70: 7669 6365 3d64 6576 6963 652c 2072 616e  vice=device, ran
+00030a80: 646f 6d5f 7374 6174 653d 7261 6e64 6f6d  dom_state=random
+00030a90: 5f73 6565 6429 0a20 2020 2020 2020 2020  _seed).         
+00030aa0: 2020 2020 2020 2020 2020 2065 6c73 653a             else:
+00030ab0: 0a20 2020 2020 2020 2020 2020 2020 2020  .               
+00030ac0: 2020 2020 2020 2020 2073 656c 662e 6d6f           self.mo
+00030ad0: 6465 6c5f 6e61 6d65 203d 3d20 276f 7468  del_name == 'oth
+00030ae0: 6572 270a 2020 2020 2020 2020 2020 2020  er'.            
+00030af0: 2020 2020 2020 2020 2323 2320 4e6f 7720          ### Now 
+00030b00: 7072 696e 7420 4c47 424d 2069 6620 6170  print LGBM if ap
+00030b10: 7072 6f70 7269 6174 6520 2323 2323 2323  propriate ######
+00030b20: 230a 2020 2020 2020 2020 2020 2020 2020  #.              
+00030b30: 2020 2020 2020 6966 2073 656c 662e 7665        if self.ve
+00030b40: 7262 6f73 6520 616e 6420 7365 6c66 2e6d  rbose and self.m
+00030b50: 6f64 656c 5f6e 616d 653d 3d27 6c67 6227  odel_name=='lgb'
+00030b60: 3a0a 2020 2020 2020 2020 2020 2020 2020  :.              
+00030b70: 2020 2020 2020 2020 2020 7072 696e 7428            print(
+00030b80: 2720 2020 2053 656c 6563 7469 6e67 204c  '    Selecting L
+00030b90: 4742 4d20 436c 6173 7369 6669 6572 2061  GBM Classifier a
+00030ba0: 7320 6261 7365 2065 7374 696d 6174 6f72  s base estimator
+00030bb0: 2e2e 2e27 290a 2020 2020 2020 2020 2020  ...').          
+00030bc0: 2020 2020 2020 2020 2020 2320 5370 6c69            # Spli
+00030bd0: 7420 6461 7461 2069 6e74 6f20 7472 6169  t data into trai
+00030be0: 6e20 616e 6420 7465 7374 2062 6173 6564  n and test based
+00030bf0: 206f 6e20 666f 6c64 7320 2020 2020 2020   on folds       
+00030c00: 2020 200a 2020 2020 2020 2020 2020 2020     .            
+00030c10: 2020 2020 2020 2020 6966 2069 7369 6e73          if isins
+00030c20: 7461 6e63 6528 792c 2070 642e 5365 7269  tance(y, pd.Seri
+00030c30: 6573 2920 6f72 2069 7369 6e73 7461 6e63  es) or isinstanc
+00030c40: 6528 792c 2070 642e 4461 7461 4672 616d  e(y, pd.DataFram
+00030c50: 6529 3a0a 2020 2020 2020 2020 2020 2020  e):.            
+00030c60: 2020 2020 2020 2020 2020 2020 795f 7472              y_tr
+00030c70: 6169 6e2c 2079 5f74 6573 7420 3d20 792e  ain, y_test = y.
+00030c80: 696c 6f63 5b74 7261 696e 5f69 6e64 6578  iloc[train_index
+00030c90: 5d2c 2079 2e69 6c6f 635b 7465 7374 5f69  ], y.iloc[test_i
+00030ca0: 6e64 6578 5d20 2020 2020 2020 2020 2020  ndex]           
+00030cb0: 2020 2020 200a 2020 2020 2020 2020 2020       .          
+00030cc0: 2020 2020 2020 2020 2020 656c 7365 3a0a            else:.
+00030cd0: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00030ce0: 2020 2020 2020 2020 795f 7472 6169 6e2c          y_train,
+00030cf0: 2079 5f74 6573 7420 3d20 795b 7472 6169   y_test = y[trai
+00030d00: 6e5f 696e 6465 785d 2c20 795b 7465 7374  n_index], y[test
+00030d10: 5f69 6e64 6578 5d0a 0a20 2020 2020 2020  _index]..       
+00030d20: 2020 2020 2020 2020 2020 2020 2069 6620               if 
+00030d30: 6973 696e 7374 616e 6365 2858 2c20 7064  isinstance(X, pd
+00030d40: 2e44 6174 6146 7261 6d65 293a 0a20 2020  .DataFrame):.   
+00030d50: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00030d60: 2020 2020 2078 5f74 7261 696e 2c20 785f       x_train, x_
+00030d70: 7465 7374 203d 2058 2e69 6c6f 635b 7472  test = X.iloc[tr
+00030d80: 6169 6e5f 696e 6465 785d 2c20 582e 696c  ain_index], X.il
+00030d90: 6f63 5b74 6573 745f 696e 6465 785d 0a20  oc[test_index]. 
+00030da0: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00030db0: 2020 2065 6c73 653a 0a20 2020 2020 2020     else:.       
+00030dc0: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00030dd0: 2078 5f74 7261 696e 2c20 785f 7465 7374   x_train, x_test
+00030de0: 203d 2058 5b74 7261 696e 5f69 6e64 6578   = X[train_index
+00030df0: 5d2c 2058 5b74 6573 745f 696e 6465 785d  ], X[test_index]
+00030e00: 0a0a 2020 2020 2020 2020 2020 2020 2020  ..              
+00030e10: 2020 2020 2020 2323 2323 2323 2044 6f20        ###### Do 
+00030e20: 7468 6973 206f 6e6c 7920 7468 6520 6669  this only the fi
+00030e30: 7273 7420 7469 6d65 2023 2323 2323 2323  rst time #######
+00030e40: 2323 2323 2323 2323 2323 2323 2323 2323  ################
+00030e50: 2323 2323 2323 2323 2323 2323 2323 2323  ################
+00030e60: 2323 2323 2323 2323 230a 2020 2020 2020  #########.      
+00030e70: 2020 2020 2020 2020 2020 2020 2020 6966                if
+00030e80: 2069 203d 3d20 303a 0a20 2020 2020 2020   i == 0:.       
+00030e90: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00030ea0: 2023 2323 2049 7420 646f 6573 206e 6f74   ### It does not
+00030eb0: 206d 616b 6520 7365 6e73 6520 746f 2064   make sense to d
+00030ec0: 6f20 6879 7065 722d 7061 7261 6d20 7475  o hyper-param tu
+00030ed0: 6e69 6e67 2066 6f72 206d 756c 7469 2d6c  ning for multi-l
+00030ee0: 6162 656c 206d 6f64 656c 7320 2323 0a20  abel models ##. 
+00030ef0: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00030f00: 2020 2020 2020 2023 2323 2020 2020 7369         ###    si
+00030f10: 6e63 6520 436c 6173 7369 6669 6572 4368  nce ClassifierCh
+00030f20: 6169 6e73 2064 6f20 6e6f 7420 6861 7665  ains do not have
+00030f30: 206d 616e 7920 6879 7065 7220 7061 7261   many hyper para
+00030f40: 6d73 2023 2323 2323 2323 2323 2323 2323  ms #############
+00030f50: 2323 2323 0a20 2020 2020 2020 2020 2020  ####.           
+00030f60: 2020 2020 2020 2020 2020 2020 2023 7365               #se
+00030f70: 6c66 2e62 6173 655f 6573 7469 6d61 746f  lf.base_estimato
+00030f80: 7220 3d20 7261 6e64 5f73 6561 7263 6828  r = rand_search(
+00030f90: 7365 6c66 2e62 6173 655f 6573 7469 6d61  self.base_estima
+00030fa0: 746f 722c 2078 5f74 7261 696e 2c20 795f  tor, x_train, y_
+00030fb0: 7472 6169 6e2c 200a 2020 2020 2020 2020  train, .        
+00030fc0: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00030fd0: 2320 2020 2020 2020 2020 2020 2020 2020  #               
+00030fe0: 2020 2020 2020 2020 2073 656c 662e 6d6f           self.mo
+00030ff0: 6465 6c5f 6e61 6d65 2c20 7665 7262 6f73  del_name, verbos
+00031000: 653d 7365 6c66 2e76 6572 626f 7365 290a  e=self.verbose).
+00031010: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00031020: 2020 2020 2020 2020 2370 7269 6e74 2827          #print('
+00031030: 2020 2020 6879 7065 7220 7475 6e65 6420      hyper tuned 
+00031040: 6261 7365 2065 7374 696d 6174 6f72 203d  base estimator =
+00031050: 2025 7327 2025 7365 6c66 2e62 6173 655f   %s' %self.base_
+00031060: 6573 7469 6d61 746f 7229 0a20 2020 2020  estimator).     
+00031070: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00031080: 2020 2069 6620 7365 6c66 2e6d 6178 5f6e     if self.max_n
+00031090: 756d 6265 725f 6f66 5f63 6c61 7373 6573  umber_of_classes
+000310a0: 203c 3d20 313a 0a20 2020 2020 2020 2020   <= 1:.         
+000310b0: 2020 2020 2020 2020 2020 2020 2020 2020                  
+000310c0: 2020 2065 7374 5f6c 6973 7420 3d20 5b43     est_list = [C
+000310d0: 6c61 7373 6966 6965 7243 6861 696e 2873  lassifierChain(s
+000310e0: 656c 662e 6261 7365 5f65 7374 696d 6174  elf.base_estimat
+000310f0: 6f72 2c20 6f72 6465 723d 4e6f 6e65 2c20  or, order=None, 
+00031100: 6376 3d33 2c20 7261 6e64 6f6d 5f73 7461  cv=3, random_sta
+00031110: 7465 3d69 2920 0a20 2020 2020 2020 2020  te=i) .         
+00031120: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00031130: 2020 2020 2020 2020 2020 2020 2020 2066                 f
+00031140: 6f72 2069 2069 6e20 7261 6e67 6528 6e75  or i in range(nu
+00031150: 6d5f 6974 6572 6174 696f 6e73 295d 200a  m_iterations)] .
 00031160: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00031170: 2020 696d 6261 6c61 6e63 6564 3d46 616c    imbalanced=Fal
-00031180: 7365 2c20 7665 7262 6f73 653d 3029 3a0a  se, verbose=0):.
-00031190: 2020 2020 2020 2020 7365 6c66 2e6e 5f65          self.n_e
-000311a0: 7374 696d 6174 6f72 7320 3d20 6e5f 6573  stimators = n_es
-000311b0: 7469 6d61 746f 7273 0a20 2020 2020 2020  timators.       
-000311c0: 2073 656c 662e 6261 7365 5f65 7374 696d   self.base_estim
-000311d0: 6174 6f72 203d 2062 6173 655f 6573 7469  ator = base_esti
-000311e0: 6d61 746f 720a 2020 2020 2020 2020 7365  mator.        se
-000311f0: 6c66 2e70 6970 656c 696e 6520 3d20 7069  lf.pipeline = pi
-00031200: 7065 6c69 6e65 0a20 2020 2020 2020 2073  peline.        s
-00031210: 656c 662e 7765 6967 6874 7320 3d20 7765  elf.weights = we
-00031220: 6967 6874 730a 2020 2020 2020 2020 7365  ights.        se
-00031230: 6c66 2e69 6d62 616c 616e 6365 6420 3d20  lf.imbalanced = 
-00031240: 696d 6261 6c61 6e63 6564 0a20 2020 2020  imbalanced.     
-00031250: 2020 2073 656c 662e 7665 7262 6f73 6520     self.verbose 
-00031260: 3d20 7665 7262 6f73 650a 2020 2020 2020  = verbose.      
-00031270: 2020 7365 6c66 2e6d 6f64 656c 7320 3d20    self.models = 
-00031280: 5b5d 0a20 2020 2020 2020 2073 656c 662e  [].        self.
-00031290: 6d75 6c74 695f 6c61 6265 6c20 3d20 2046  multi_label =  F
-000312a0: 616c 7365 0a20 2020 2020 2020 2073 656c  alse.        sel
-000312b0: 662e 6d61 785f 6e75 6d62 6572 5f6f 665f  f.max_number_of_
-000312c0: 636c 6173 7365 7320 3d20 310a 2020 2020  classes = 1.    
-000312d0: 2020 2020 7365 6c66 2e73 636f 7265 7320      self.scores 
-000312e0: 3d20 5b5d 0a20 2020 2020 2020 2073 656c  = [].        sel
-000312f0: 662e 636c 6173 7365 7320 3d20 5b5d 0a20  f.classes = []. 
-00031300: 2020 2020 2020 2073 656c 662e 7265 6772         self.regr
-00031310: 6573 7369 6f6e 5f6d 696e 5f6d 6178 203d  ession_min_max =
-00031320: 205b 5d0a 2020 2020 2020 2020 7365 6c66   [].        self
-00031330: 2e6d 6f64 656c 5f6e 616d 6520 3d20 2727  .model_name = ''
-00031340: 0a20 2020 2020 2020 2073 656c 662e 6665  .        self.fe
-00031350: 6174 7572 6573 203d 205b 5d0a 0a20 2020  atures = []..   
-00031360: 2064 6566 2072 6574 7572 6e5f 776f 7273   def return_wors
-00031370: 745f 666f 6c64 2873 656c 662c 2058 293a  t_fold(self, X):
-00031380: 0a20 2020 2020 2020 2022 2222 0a20 2020  .        """.   
-00031390: 2020 2020 2054 6869 7320 6d65 7468 6f64       This method
-000313a0: 2072 6574 7572 6e73 2074 6865 2077 6f72   returns the wor
-000313b0: 7374 2070 6572 666f 726d 696e 6720 7472  st performing tr
-000313c0: 6169 6e20 616e 6420 7465 7374 2072 6f77  ain and test row
-000313d0: 7320 616d 6f6e 6720 616c 6c20 7468 6520  s among all the 
-000313e0: 666f 6c64 732e 0a20 2020 2020 2020 2054  folds..        T
-000313f0: 6869 7320 6973 2076 6572 7920 696d 706f  his is very impo
-00031400: 7274 616e 7420 696e 666f 726d 6174 696f  rtant informatio
-00031410: 6e20 7369 6e63 6520 6974 2068 656c 7073  n since it helps
-00031420: 2061 6e20 4d4c 2065 6e67 696e 6565 7220   an ML engineer 
-00031430: 6f72 2044 6174 6120 5363 6965 6e74 6973  or Data Scientis
-00031440: 7420 0a20 2020 2020 2020 2020 2020 2074  t .            t
-00031450: 6f20 7472 6f75 626c 6520 7368 6f6f 7420  o trouble shoot 
-00031460: 636c 6173 7369 6669 6361 7469 6f6e 2070  classification p
-00031470: 726f 626c 656d 732e 2049 7420 6865 6c70  roblems. It help
-00031480: 7320 746f 2066 696e 6420 7768 6572 6520  s to find where 
-00031490: 7468 6520 6d6f 6465 6c20 6973 2073 7472  the model is str
-000314a0: 7567 676c 696e 672e 0a0a 2020 2020 2020  uggling...      
-000314b0: 2020 496e 7075 7473 3a0a 2020 2020 2020    Inputs:.      
-000314c0: 2020 2d2d 2d2d 2d2d 2d2d 0a20 2020 2020    --------.     
-000314d0: 2020 2058 3a20 4461 7461 6672 616d 652e     X: Dataframe.
-000314e0: 2054 6869 7320 6d75 7374 2062 6520 7468   This must be th
-000314f0: 6520 6665 6174 7572 6573 2064 6174 6166  e features dataf
-00031500: 7261 6d65 206f 6620 796f 7572 2064 6174  rame of your dat
-00031510: 6173 6574 2e20 4974 2063 616e 6e6f 7420  aset. It cannot 
-00031520: 6265 2061 206e 756d 7079 2061 7272 6179  be a numpy array
-00031530: 2e0a 0a20 2020 2020 2020 204f 7574 7075  ...        Outpu
-00031540: 7473 3a0a 2020 2020 2020 2020 2d2d 2d2d  ts:.        ----
-00031550: 2d2d 2d2d 2d0a 2020 2020 2020 2020 7472  -----.        tr
-00031560: 6169 6e5f 726f 7773 5f64 6174 6166 7261  ain_rows_datafra
-00031570: 6d65 2c20 7465 7374 5f72 6f77 735f 6461  me, test_rows_da
-00031580: 7461 6672 616d 653a 2044 6174 6166 7261  taframe: Datafra
-00031590: 6d65 732e 200a 2020 2020 2020 2020 2020  mes. .          
-000315a0: 2020 2054 6869 7320 7265 7475 726e 7320     This returns 
-000315b0: 7468 6520 706f 7274 696f 6e20 6f66 2058  the portion of X
-000315c0: 2061 7320 7472 6169 6e20 616e 6420 7465   as train and te
-000315d0: 7374 2074 6f20 6865 6c70 2079 6f75 2075  st to help you u
-000315e0: 6e64 6572 7374 616e 6420 7768 6572 6520  nderstand where 
-000315f0: 6d6f 6465 6c20 7374 7275 6767 6c65 642e  model struggled.
-00031600: 0a20 2020 2020 2020 2022 2222 0a20 2020  .        """.   
-00031610: 2020 2020 2077 6f72 7374 5f66 6f6c 6420       worst_fold 
-00031620: 3d20 6e70 2e61 7267 6d69 6e28 7365 6c66  = np.argmin(self
-00031630: 2e73 636f 7265 7329 0a20 2020 2020 2020  .scores).       
-00031640: 2066 6f72 2069 2c20 2874 722c 2074 7429   for i, (tr, tt)
-00031650: 2069 6e20 656e 756d 6572 6174 6528 7365   in enumerate(se
-00031660: 6c66 2e6b 662e 7370 6c69 7428 5829 293a  lf.kf.split(X)):
-00031670: 0a20 2020 2020 2020 2020 2020 2069 6620  .            if 
-00031680: 6920 3d3d 2077 6f72 7374 5f66 6f6c 643a  i == worst_fold:
-00031690: 0a20 2020 2020 2020 2020 2020 2020 2020  .               
-000316a0: 2077 6f72 7374 5f74 7261 696e 5f72 6f77   worst_train_row
-000316b0: 7320 3d20 636f 7079 2e64 6565 7063 6f70  s = copy.deepcop
-000316c0: 7928 7472 290a 2020 2020 2020 2020 2020  y(tr).          
-000316d0: 2020 2020 2020 776f 7273 745f 7474 6573        worst_ttes
-000316e0: 745f 726f 7773 203d 2063 6f70 792e 6465  t_rows = copy.de
-000316f0: 6570 636f 7079 2874 7429 0a20 2020 2020  epcopy(tt).     
-00031700: 2020 2020 2020 2020 2020 2070 7269 6e74             print
-00031710: 2822 666f 6c64 2025 733a 2074 7261 696e  ("fold %s: train
-00031720: 2072 6f77 7320 696e 6465 7820 3d20 2573   rows index = %s
-00031730: 2e20 5375 6c6f 206d 6f64 656c 2073 7472  . Sulo model str
-00031740: 7567 676c 6564 2069 6e20 7468 6973 2066  uggled in this f
-00031750: 6f6c 642e 2220 2528 692b 312c 7472 2929  old." %(i+1,tr))
-00031760: 0a20 2020 2020 2020 2020 2020 2065 6c73  .            els
-00031770: 653a 0a20 2020 2020 2020 2020 2020 2020  e:.             
-00031780: 2020 2070 7269 6e74 2822 666f 6c64 2025     print("fold %
-00031790: 733a 2074 7261 696e 2072 6f77 7320 696e  s: train rows in
-000317a0: 6465 7820 3d20 2573 2220 2528 692b 312c  dex = %s" %(i+1,
-000317b0: 7472 2929 0a20 2020 2020 2020 2072 6574  tr)).        ret
-000317c0: 7572 6e20 582e 696c 6f63 5b77 6f72 7374  urn X.iloc[worst
-000317d0: 5f74 7261 696e 5f72 6f77 735d 2c20 582e  _train_rows], X.
-000317e0: 696c 6f63 5b77 6f72 7374 5f74 7465 7374  iloc[worst_ttest
-000317f0: 5f72 6f77 735d 0a0a 2020 2020 6465 6620  _rows]..    def 
-00031800: 6669 7428 7365 6c66 2c20 582c 2079 293a  fit(self, X, y):
-00031810: 0a20 2020 2020 2020 2058 203d 2063 6f70  .        X = cop
-00031820: 792e 6465 6570 636f 7079 2858 290a 2020  y.deepcopy(X).  
-00031830: 2020 2020 2020 7072 696e 7428 2749 6e70        print('Inp
-00031840: 7574 2064 6174 6120 7368 6170 6573 3a20  ut data shapes: 
-00031850: 5820 3d20 2573 2720 2528 582e 7368 6170  X = %s' %(X.shap
-00031860: 652c 2929 0a20 2020 2020 2020 2070 7269  e,)).        pri
-00031870: 6e74 2827 2020 2020 7920 7368 6170 6520  nt('    y shape 
-00031880: 3d20 2573 2720 2528 792e 7368 6170 652c  = %s' %(y.shape,
-00031890: 2929 0a20 2020 2020 2020 2073 6565 6420  )).        seed 
-000318a0: 3d20 3432 0a20 2020 2020 2020 2073 6875  = 42.        shu
-000318b0: 6666 6c65 466c 6167 203d 2054 7275 650a  ffleFlag = True.
-000318c0: 2020 2020 2020 2020 6d6f 6465 6c74 7970          modeltyp
-000318d0: 6520 3d20 2743 6c61 7373 6966 6963 6174  e = 'Classificat
-000318e0: 696f 6e27 0a20 2020 2020 2020 2066 6561  ion'.        fea
-000318f0: 7475 7265 735f 6c69 6d69 7420 3d20 3530  tures_limit = 50
-00031900: 2023 2320 6966 2074 6865 7265 2061 7265   ## if there are
-00031910: 206d 6f72 6520 7468 616e 2035 3020 6665   more than 50 fe
-00031920: 6174 7572 6573 2069 6e20 6461 7461 7365  atures in datase
-00031930: 742c 2062 6574 7465 7220 746f 2075 7365  t, better to use
-00031940: 204c 4742 4d20 2323 0a20 2020 2020 2020   LGBM ##.       
-00031950: 2073 7461 7274 203d 2074 696d 652e 7469   start = time.ti
-00031960: 6d65 2829 0a20 2020 2020 2020 2069 6620  me().        if 
-00031970: 6973 696e 7374 616e 6365 2858 2c20 7064  isinstance(X, pd
-00031980: 2e44 6174 6146 7261 6d65 293a 0a20 2020  .DataFrame):.   
-00031990: 2020 2020 2020 2020 2073 656c 662e 6665           self.fe
-000319a0: 6174 7572 6573 203d 2058 2e63 6f6c 756d  atures = X.colum
-000319b0: 6e73 2e74 6f6c 6973 7428 290a 2020 2020  ns.tolist().    
-000319c0: 2020 2020 656c 7365 3a0a 2020 2020 2020      else:.      
-000319d0: 2020 2020 2020 7072 696e 7428 2743 616e        print('Can
-000319e0: 6e6f 7420 6f70 6572 6174 6520 5375 6c6f  not operate Sulo
-000319f0: 436c 6173 7369 6669 6572 206f 6e20 6e75  Classifier on nu
-00031a00: 6d70 7920 6172 7261 7973 2e20 4d75 7374  mpy arrays. Must
-00031a10: 2062 6520 6461 7461 6672 616d 6573 2e20   be dataframes. 
-00031a20: 5265 7475 726e 696e 672e 2e2e 2729 0a20  Returning...'). 
-00031a30: 2020 2020 2020 2020 2020 2072 6574 7572             retur
-00031a40: 6e20 7365 6c66 0a20 2020 2020 2020 2023  n self.        #
-00031a50: 2055 7365 204b 466f 6c64 2066 6f72 2075   Use KFold for u
-00031a60: 6e64 6572 7374 616e 6469 6e67 2074 6865  nderstanding the
-00031a70: 2070 6572 666f 726d 616e 6365 0a20 2020   performance.   
-00031a80: 2020 2020 2069 6620 7365 6c66 2e77 6569       if self.wei
-00031a90: 6768 7473 3a0a 2020 2020 2020 2020 2020  ghts:.          
-00031aa0: 2020 7072 696e 7428 2752 656d 656d 6265    print('Remembe
-00031ab0: 7220 7468 6174 2075 7369 6e67 2063 6c61  r that using cla
-00031ac0: 7373 2077 6569 6768 7473 2077 696c 6c20  ss weights will 
-00031ad0: 7772 6f6e 676c 7920 736b 6577 2070 7265  wrongly skew pre
-00031ae0: 6469 6374 5f70 726f 6261 7320 6672 6f6d  dict_probas from
-00031af0: 2061 6e79 2063 6c61 7373 6966 6965 7227   any classifier'
-00031b00: 290a 2020 2020 2020 2020 6966 2073 656c  ).        if sel
-00031b10: 662e 696d 6261 6c61 6e63 6564 3a0a 2020  f.imbalanced:.  
-00031b20: 2020 2020 2020 2020 2020 636c 6173 735f            class_
-00031b30: 7765 6967 6874 7320 3d20 4e6f 6e65 0a20  weights = None. 
-00031b40: 2020 2020 2020 2065 6c73 653a 0a20 2020         else:.   
-00031b50: 2020 2020 2020 2020 2063 6c61 7373 5f77           class_w
-00031b60: 6569 6768 7473 203d 2067 6574 5f63 6c61  eights = get_cla
-00031b70: 7373 5f77 6569 6768 7473 2879 2c20 7665  ss_weights(y, ve
-00031b80: 7262 6f73 653d 3029 0a20 2020 2020 2020  rbose=0).       
-00031b90: 2023 2323 2052 656d 656d 6265 7220 7468   ### Remember th
-00031ba0: 6174 2070 7574 7469 6e67 2063 6c61 7373  at putting class
-00031bb0: 2077 6569 6768 7473 2077 696c 6c20 746f   weights will to
-00031bc0: 7461 6c6c 7920 6465 7374 726f 7920 7072  tally destroy pr
-00031bd0: 6564 6963 745f 7072 6f62 6173 2023 2323  edict_probas ###
-00031be0: 0a20 2020 2020 2020 2073 656c 662e 636c  .        self.cl
-00031bf0: 6173 7365 7320 3d20 7072 696e 745f 666c  asses = print_fl
-00031c00: 6174 7465 6e5f 6469 6374 2863 6c61 7373  atten_dict(class
-00031c10: 5f77 6569 6768 7473 290a 2020 2020 2020  _weights).      
-00031c20: 2020 7363 616c 655f 706f 735f 7765 6967    scale_pos_weig
-00031c30: 6874 203d 2067 6574 5f73 6361 6c65 5f70  ht = get_scale_p
-00031c40: 6f73 5f77 6569 6768 7428 7929 0a20 2020  os_weight(y).   
-00031c50: 2020 2020 2023 7072 696e 7428 2743 6c61       #print('Cla
-00031c60: 7373 2077 6569 6768 7473 203d 2025 7327  ss weights = %s'
-00031c70: 2025 636c 6173 735f 7765 6967 6874 7329   %class_weights)
-00031c80: 0a20 2020 2020 2020 2067 7075 5f65 7869  .        gpu_exi
-00031c90: 7374 7320 3d20 6368 6563 6b5f 6966 5f47  sts = check_if_G
-00031ca0: 5055 5f65 7869 7374 7328 290a 2020 2020  PU_exists().    
-00031cb0: 2020 2020 6966 2067 7075 5f65 7869 7374      if gpu_exist
-00031cc0: 733a 0a20 2020 2020 2020 2020 2020 2064  s:.            d
-00031cd0: 6576 6963 653d 2267 7075 220a 2020 2020  evice="gpu".    
-00031ce0: 2020 2020 656c 7365 3a0a 2020 2020 2020      else:.      
-00031cf0: 2020 2020 2020 6465 7669 6365 3d22 6370        device="cp
-00031d00: 7522 0a20 2020 2020 2020 2023 2320 446f  u".        ## Do
-00031d10: 6e27 7420 6368 616e 6765 2074 6869 7320  n't change this 
-00031d20: 7369 6e63 6520 6974 2067 6976 6573 2061  since it gives a
-00031d30: 6e20 6572 726f 7220 2323 0a20 2020 2020  n error ##.     
-00031d40: 2020 206d 6574 7269 6320 203d 2027 6175     metric  = 'au
-00031d50: 6327 0a20 2020 2020 2020 2023 2323 2064  c'.        ### d
-00031d60: 6f6e 2774 2063 6861 6e67 6520 7468 6973  on't change this
-00031d70: 206d 6574 7269 6320 616e 6420 6576 616c   metric and eval
-00031d80: 206d 6574 7269 6320 2d20 6974 2067 6976   metric - it giv
-00031d90: 6573 2065 7272 6f72 2069 6620 796f 7520  es error if you 
-00031da0: 6368 616e 6765 2069 7420 2323 0a20 2020  change it ##.   
-00031db0: 2020 2020 2065 7661 6c5f 6d65 7472 6963       eval_metric
-00031dc0: 203d 2027 6175 6327 0a20 2020 2020 2020   = 'auc'.       
-00031dd0: 2072 6f77 5f6c 696d 6974 203d 2031 3030   row_limit = 100
-00031de0: 3030 0a20 2020 2020 2020 2069 6620 7365  00.        if se
-00031df0: 6c66 2e69 6d62 616c 616e 6365 643a 0a20  lf.imbalanced:. 
-00031e00: 2020 2020 2020 2020 2020 2070 7269 6e74             print
-00031e10: 2827 2020 2020 496d 6261 6c61 6e63 6564  ('    Imbalanced
-00031e20: 2063 6c61 7373 6573 206f 6620 7920 3d20   classes of y = 
-00031e30: 2573 2720 2566 696e 645f 7261 7265 5f63  %s' %find_rare_c
-00031e40: 6c61 7373 2879 2c20 7665 7262 6f73 653d  lass(y, verbose=
-00031e50: 7365 6c66 2e76 6572 626f 7365 2929 0a20  self.verbose)). 
-00031e60: 2020 2020 2020 2023 2323 2323 2323 2323         #########
-00031e70: 2323 2323 2323 2320 2020 2020 2020 2020  #######         
-00031e80: 2050 2049 2050 2045 204c 2049 204e 2045   P I P E L I N E
-00031e90: 2020 2020 2020 2020 2323 2323 2323 2323          ########
-00031ea0: 2323 2323 2323 2323 2323 2323 2323 2323  ################
-00031eb0: 2323 0a20 2020 2020 2020 206e 756d 6572  ##.        numer
-00031ec0: 6963 5f74 7261 6e73 666f 726d 6572 203d  ic_transformer =
-00031ed0: 2050 6970 656c 696e 6528 0a20 2020 2020   Pipeline(.     
-00031ee0: 2020 2020 2020 2073 7465 7073 3d5b 2822         steps=[("
-00031ef0: 696d 7075 7465 7222 2c20 5369 6d70 6c65  imputer", Simple
-00031f00: 496d 7075 7465 7228 7374 7261 7465 6779  Imputer(strategy
-00031f10: 3d22 6d65 616e 222c 2061 6464 5f69 6e64  ="mean", add_ind
-00031f20: 6963 6174 6f72 3d54 7275 6529 292c 2028  icator=True)), (
-00031f30: 2273 6361 6c65 7222 2c20 5374 616e 6461  "scaler", Standa
-00031f40: 7264 5363 616c 6572 2829 295d 0a20 2020  rdScaler())].   
-00031f50: 2020 2020 2029 0a0a 2020 2020 2020 2020       )..        
-00031f60: 6361 7465 676f 7269 6361 6c5f 7472 616e  categorical_tran
-00031f70: 7366 6f72 6d65 725f 6c6f 7720 3d20 5069  sformer_low = Pi
-00031f80: 7065 6c69 6e65 280a 2020 2020 2020 2020  peline(.        
-00031f90: 2020 2020 7374 6570 733d 5b0a 2020 2020      steps=[.    
-00031fa0: 2020 2020 2020 2020 2020 2020 2822 696d              ("im
-00031fb0: 7075 7465 7222 2c20 5369 6d70 6c65 496d  puter", SimpleIm
-00031fc0: 7075 7465 7228 7374 7261 7465 6779 3d22  puter(strategy="
-00031fd0: 636f 6e73 7461 6e74 222c 2066 696c 6c5f  constant", fill_
-00031fe0: 7661 6c75 653d 226d 6973 7369 6e67 222c  value="missing",
-00031ff0: 2061 6464 5f69 6e64 6963 6174 6f72 3d54   add_indicator=T
-00032000: 7275 6529 292c 0a20 2020 2020 2020 2020  rue)),.         
-00032010: 2020 2020 2020 2028 2265 6e63 6f64 696e         ("encodin
-00032020: 6722 2c20 4f6e 6548 6f74 456e 636f 6465  g", OneHotEncode
-00032030: 7228 6861 6e64 6c65 5f75 6e6b 6e6f 776e  r(handle_unknown
-00032040: 3d22 7661 6c75 6522 2929 2c0a 2020 2020  ="value")),.    
-00032050: 2020 2020 2020 2020 5d0a 2020 2020 2020          ].      
-00032060: 2020 290a 0a20 2020 2020 2020 2063 6174    )..        cat
-00032070: 6567 6f72 6963 616c 5f74 7261 6e73 666f  egorical_transfo
-00032080: 726d 6572 5f68 6967 6820 3d20 5069 7065  rmer_high = Pipe
-00032090: 6c69 6e65 280a 2020 2020 2020 2020 2020  line(.          
-000320a0: 2020 7374 6570 733d 5b0a 2020 2020 2020    steps=[.      
-000320b0: 2020 2020 2020 2020 2020 2822 696d 7075            ("impu
-000320c0: 7465 7222 2c20 5369 6d70 6c65 496d 7075  ter", SimpleImpu
-000320d0: 7465 7228 7374 7261 7465 6779 3d22 636f  ter(strategy="co
-000320e0: 6e73 7461 6e74 222c 2066 696c 6c5f 7661  nstant", fill_va
-000320f0: 6c75 653d 226d 6973 7369 6e67 222c 2061  lue="missing", a
-00032100: 6464 5f69 6e64 6963 6174 6f72 3d54 7275  dd_indicator=Tru
-00032110: 6529 292c 0a20 2020 2020 2020 2020 2020  e)),.           
-00032120: 2020 2020 2028 2265 6e63 6f64 696e 6722       ("encoding"
-00032130: 2c20 4c61 6265 6c45 6e63 6f64 6572 2829  , LabelEncoder()
-00032140: 292c 0a20 2020 2020 2020 2020 2020 205d  ),.            ]
-00032150: 0a20 2020 2020 2020 2029 0a0a 2020 2020  .        )..    
-00032160: 2020 2020 6e75 6d65 7269 635f 6665 6174      numeric_feat
-00032170: 7572 6573 203d 2058 2e73 656c 6563 745f  ures = X.select_
-00032180: 6474 7970 6573 2869 6e63 6c75 6465 3d5b  dtypes(include=[
-00032190: 6e70 2e6e 756d 6265 725d 292e 636f 6c75  np.number]).colu
-000321a0: 6d6e 730a 2020 2020 2020 2020 6361 7465  mns.        cate
-000321b0: 676f 7269 6361 6c5f 6665 6174 7572 6573  gorical_features
-000321c0: 203d 2058 2e73 656c 6563 745f 6474 7970   = X.select_dtyp
-000321d0: 6573 2869 6e63 6c75 6465 3d5b 226f 626a  es(include=["obj
-000321e0: 6563 7422 5d29 2e63 6f6c 756d 6e73 0a0a  ect"]).columns..
-000321f0: 2020 2020 2020 2020 6361 7465 676f 7269          categori
-00032200: 6361 6c5f 6c6f 772c 2063 6174 6567 6f72  cal_low, categor
-00032210: 6963 616c 5f68 6967 6820 3d20 6765 745f  ical_high = get_
-00032220: 6361 7264 696e 616c 6974 7928 582c 2063  cardinality(X, c
-00032230: 6174 6567 6f72 6963 616c 5f66 6561 7475  ategorical_featu
-00032240: 7265 7329 0a20 2020 2020 2020 2070 7265  res).        pre
-00032250: 7072 6f63 6573 736f 7220 3d20 436f 6c75  processor = Colu
-00032260: 6d6e 5472 616e 7366 6f72 6d65 7228 0a20  mnTransformer(. 
-00032270: 2020 2020 2020 2020 2020 2074 7261 6e73             trans
-00032280: 666f 726d 6572 733d 5b0a 2020 2020 2020  formers=[.      
-00032290: 2020 2020 2020 2020 2020 2822 6e75 6d65            ("nume
-000322a0: 7269 6322 2c20 6e75 6d65 7269 635f 7472  ric", numeric_tr
-000322b0: 616e 7366 6f72 6d65 722c 206e 756d 6572  ansformer, numer
-000322c0: 6963 5f66 6561 7475 7265 7329 2c0a 2020  ic_features),.  
-000322d0: 2020 2020 2020 2020 2020 2020 2020 2822                ("
-000322e0: 6361 7465 676f 7269 6361 6c5f 6c6f 7722  categorical_low"
-000322f0: 2c20 6361 7465 676f 7269 6361 6c5f 7472  , categorical_tr
-00032300: 616e 7366 6f72 6d65 725f 6c6f 772c 2063  ansformer_low, c
-00032310: 6174 6567 6f72 6963 616c 5f6c 6f77 292c  ategorical_low),
-00032320: 0a20 2020 2020 2020 2020 2020 2020 2020  .               
-00032330: 2028 2263 6174 6567 6f72 6963 616c 5f68   ("categorical_h
-00032340: 6967 6822 2c20 6361 7465 676f 7269 6361  igh", categorica
-00032350: 6c5f 7472 616e 7366 6f72 6d65 725f 6869  l_transformer_hi
-00032360: 6768 2c20 6361 7465 676f 7269 6361 6c5f  gh, categorical_
-00032370: 6869 6768 292c 0a20 2020 2020 2020 2020  high),.         
-00032380: 2020 205d 0a20 2020 2020 2020 2029 0a20     ].        ). 
-00032390: 2020 2020 2020 2023 2323 2323 2323 2323         #########
-000323a0: 2323 2323 2323 2323 2323 2323 2323 2323  ################
-000323b0: 2323 2323 2323 2323 2323 2323 2323 2323  ################
-000323c0: 2323 2323 2323 2323 2323 2323 2323 2323  ################
-000323d0: 2323 2323 2323 2323 2323 2323 2323 2323  ################
-000323e0: 2323 2323 2323 2323 2323 230a 2020 2020  ###########.    
-000323f0: 2020 2020 6966 2069 7369 6e73 7461 6e63      if isinstanc
-00032400: 6528 792c 2070 642e 4461 7461 4672 616d  e(y, pd.DataFram
-00032410: 6529 3a0a 2020 2020 2020 2020 2020 2020  e):.            
-00032420: 6966 206c 656e 2879 2e63 6f6c 756d 6e73  if len(y.columns
-00032430: 2920 3e3d 2032 3a0a 2020 2020 2020 2020  ) >= 2:.        
-00032440: 2020 2020 2020 2020 6e75 6d62 6572 5f6f          number_o
-00032450: 665f 636c 6173 7365 7320 3d20 6e75 6d5f  f_classes = num_
-00032460: 636c 6173 7365 7328 7929 0a20 2020 2020  classes(y).     
-00032470: 2020 2020 2020 2020 2020 2066 6f72 2065             for e
-00032480: 6163 685f 6920 696e 2079 2e63 6f6c 756d  ach_i in y.colum
-00032490: 6e73 3a0a 2020 2020 2020 2020 2020 2020  ns:.            
-000324a0: 2020 2020 2020 2020 6e75 6d62 6572 5f6f          number_o
-000324b0: 665f 636c 6173 7365 735b 6561 6368 5f69  f_classes[each_i
-000324c0: 5d20 3d20 696e 7428 6e75 6d62 6572 5f6f  ] = int(number_o
-000324d0: 665f 636c 6173 7365 735b 6561 6368 5f69  f_classes[each_i
-000324e0: 5d20 2d20 3129 0a20 2020 2020 2020 2020  ] - 1).         
-000324f0: 2020 2020 2020 206d 6178 5f6e 756d 6265         max_numbe
-00032500: 725f 6f66 5f63 6c61 7373 6573 203d 206e  r_of_classes = n
-00032510: 702e 6d61 7828 6c69 7374 286e 756d 6265  p.max(list(numbe
-00032520: 725f 6f66 5f63 6c61 7373 6573 2e76 616c  r_of_classes.val
-00032530: 7565 7328 2929 290a 2020 2020 2020 2020  ues())).        
-00032540: 2020 2020 656c 7365 3a0a 2020 2020 2020      else:.      
-00032550: 2020 2020 2020 2020 2020 6e75 6d62 6572            number
-00032560: 5f6f 665f 636c 6173 7365 7320 3d20 696e  _of_classes = in
-00032570: 7428 6e75 6d5f 636c 6173 7365 7328 7929  t(num_classes(y)
-00032580: 202d 2031 290a 2020 2020 2020 2020 2020   - 1).          
-00032590: 2020 2020 2020 6d61 785f 6e75 6d62 6572        max_number
-000325a0: 5f6f 665f 636c 6173 7365 7320 3d20 6e70  _of_classes = np
-000325b0: 2e6d 6178 286e 756d 6265 725f 6f66 5f63  .max(number_of_c
-000325c0: 6c61 7373 6573 290a 2020 2020 2020 2020  lasses).        
-000325d0: 656c 7365 3a0a 2020 2020 2020 2020 2020  else:.          
-000325e0: 2020 6e75 6d62 6572 5f6f 665f 636c 6173    number_of_clas
-000325f0: 7365 7320 3d20 696e 7428 6e75 6d5f 636c  ses = int(num_cl
-00032600: 6173 7365 7328 7929 202d 2031 290a 2020  asses(y) - 1).  
-00032610: 2020 2020 2020 2020 2020 6d61 785f 6e75            max_nu
-00032620: 6d62 6572 5f6f 665f 636c 6173 7365 7320  mber_of_classes 
-00032630: 3d20 6e70 2e6d 6178 286e 756d 6265 725f  = np.max(number_
-00032640: 6f66 5f63 6c61 7373 6573 290a 2020 2020  of_classes).    
-00032650: 2020 2020 6461 7461 5f73 616d 706c 6573      data_samples
-00032660: 203d 2058 2e73 6861 7065 5b30 5d0a 2020   = X.shape[0].  
-00032670: 2020 2020 2020 7365 6c66 2e6d 6178 5f6e        self.max_n
-00032680: 756d 6265 725f 6f66 5f63 6c61 7373 6573  umber_of_classes
-00032690: 203d 206d 6178 5f6e 756d 6265 725f 6f66   = max_number_of
-000326a0: 5f63 6c61 7373 6573 0a20 2020 2020 2020  _classes.       
-000326b0: 2069 6620 7365 6c66 2e6e 5f65 7374 696d   if self.n_estim
-000326c0: 6174 6f72 7320 6973 204e 6f6e 653a 0a20  ators is None:. 
-000326d0: 2020 2020 2020 2020 2020 2069 6620 6461             if da
-000326e0: 7461 5f73 616d 706c 6573 203c 3d20 726f  ta_samples <= ro
-000326f0: 775f 6c69 6d69 743a 0a20 2020 2020 2020  w_limit:.       
-00032700: 2020 2020 2020 2020 2073 656c 662e 6e5f           self.n_
-00032710: 6573 7469 6d61 746f 7273 203d 206d 696e  estimators = min
-00032720: 2833 2c20 696e 7428 312e 352a 6e70 2e6c  (3, int(1.5*np.l
-00032730: 6f67 3130 2864 6174 615f 7361 6d70 6c65  og10(data_sample
-00032740: 7329 2929 0a20 2020 2020 2020 2020 2020  s))).           
-00032750: 2065 6c73 653a 0a20 2020 2020 2020 2020   else:.         
-00032760: 2020 2020 2020 2073 656c 662e 6e5f 6573         self.n_es
-00032770: 7469 6d61 746f 7273 203d 206d 696e 2831  timators = min(1
-00032780: 302c 2069 6e74 2831 2e35 2a6e 702e 6c6f  0, int(1.5*np.lo
-00032790: 6731 3028 6461 7461 5f73 616d 706c 6573  g10(data_samples
-000327a0: 2929 290a 2020 2020 2020 2020 7365 6c66  ))).        self
-000327b0: 2e6d 6f64 656c 5f6e 616d 6520 3d20 276c  .model_name = 'l
-000327c0: 6762 270a 2020 2020 2020 2020 6e75 6d5f  gb'.        num_
-000327d0: 7370 6c69 7473 203d 2073 656c 662e 6e5f  splits = self.n_
-000327e0: 6573 7469 6d61 746f 7273 0a20 2020 2020  estimators.     
-000327f0: 2020 206e 756d 5f72 6570 6561 7473 203d     num_repeats =
-00032800: 2031 0a20 2020 2020 2020 206b 666f 6c64   1.        kfold
-00032810: 203d 2052 6570 6561 7465 644b 466f 6c64   = RepeatedKFold
-00032820: 286e 5f73 706c 6974 733d 6e75 6d5f 7370  (n_splits=num_sp
-00032830: 6c69 7473 2c20 7261 6e64 6f6d 5f73 7461  lits, random_sta
-00032840: 7465 3d73 6565 642c 206e 5f72 6570 6561  te=seed, n_repea
-00032850: 7473 3d6e 756d 5f72 6570 6561 7473 290a  ts=num_repeats).
-00032860: 2020 2020 2020 2020 6e75 6d5f 6974 6572          num_iter
-00032870: 6174 696f 6e73 203d 2069 6e74 286e 756d  ations = int(num
-00032880: 5f73 706c 6974 7320 2a20 6e75 6d5f 7265  _splits * num_re
-00032890: 7065 6174 7329 0a20 2020 2020 2020 2073  peats).        s
-000328a0: 636f 7269 6e67 203d 2027 6261 6c61 6e63  coring = 'balanc
-000328b0: 6564 5f61 6363 7572 6163 7927 0a20 2020  ed_accuracy'.   
-000328c0: 2020 2020 2070 7269 6e74 2827 2020 2020       print('    
-000328d0: 4e75 6d62 6572 206f 6620 6573 7469 6d61  Number of estima
-000328e0: 746f 7273 2075 7365 6420 696e 2053 756c  tors used in Sul
-000328f0: 6f43 6c61 7373 6966 6965 7220 3d20 2573  oClassifier = %s
-00032900: 2720 256e 756d 5f69 7465 7261 7469 6f6e  ' %num_iteration
-00032910: 7329 0a20 2020 2020 2020 2023 2323 2323  s).        #####
-00032920: 2054 6869 7320 6973 2077 6865 7265 2077   This is where w
-00032930: 6520 6368 6563 6b20 6966 2079 2069 7320  e check if y is 
-00032940: 7369 6e67 6c65 206c 6162 656c 206f 7220  single label or 
-00032950: 6d75 6c74 692d 6c61 6265 6c20 2323 0a20  multi-label ##. 
-00032960: 2020 2020 2020 2069 6620 6973 696e 7374         if isinst
-00032970: 616e 6365 2879 2c20 7064 2e44 6174 6146  ance(y, pd.DataF
-00032980: 7261 6d65 293a 0a20 2020 2020 2020 2020  rame):.         
-00032990: 2020 2023 2323 2323 2323 2323 2323 2323     #############
-000329a0: 2323 2323 2323 2323 2323 2323 2323 2323  ################
-000329b0: 2323 2323 2323 2323 2323 2323 2323 2323  ################
-000329c0: 2323 2323 2323 2323 2323 2323 2323 2323  ################
-000329d0: 2323 0a20 2020 2020 2020 2020 2020 2023  ##.            #
-000329e0: 2323 2054 6869 7320 6973 2066 6f72 204d  ## This is for M
-000329f0: 756c 7469 2d4c 6162 656c 2070 726f 626c  ulti-Label probl
-00032a00: 656d 7320 6f6e 6c79 2023 2323 2323 2323  ems only #######
-00032a10: 2323 2323 2323 2323 2323 2323 2323 0a20  ##############. 
-00032a20: 2020 2020 2020 2020 2020 2023 2323 2323             #####
-00032a30: 2323 2323 2323 2323 2323 2323 2323 2323  ################
-00032a40: 2323 2323 2323 2323 2323 2323 2323 2323  ################
-00032a50: 2323 2323 2323 2323 2323 2323 2323 2323  ################
-00032a60: 2323 2323 2323 2323 2323 0a20 2020 2020  ##########.     
-00032a70: 2020 2020 2020 2074 6172 6765 7473 203d         targets =
-00032a80: 2079 2e63 6f6c 756d 6e73 2e74 6f6c 6973   y.columns.tolis
-00032a90: 7428 290a 2020 2020 2020 2020 2020 2020  t().            
-00032aa0: 6966 2069 735f 795f 6f62 6a65 6374 2879  if is_y_object(y
-00032ab0: 293a 0a20 2020 2020 2020 2020 2020 2020  ):.             
-00032ac0: 2020 2070 7269 6e74 2827 4361 6e6e 6f74     print('Cannot
-00032ad0: 2070 6572 666f 726d 2063 6c61 7373 6966   perform classif
-00032ae0: 6963 6174 696f 6e20 7573 696e 6720 6f62  ication using ob
-00032af0: 6a65 6374 206f 7220 7374 7269 6e67 2074  ject or string t
-00032b00: 6172 6765 7473 2e20 506c 6561 7365 2063  argets. Please c
-00032b10: 6f6e 7665 7274 2074 6f20 6e75 6d65 7269  onvert to numeri
-00032b20: 6320 616e 6420 7472 7920 6167 6169 6e2e  c and try again.
-00032b30: 2729 0a20 2020 2020 2020 2020 2020 2020  ').             
-00032b40: 2020 2072 6574 7572 6e20 7365 6c66 0a20     return self. 
-00032b50: 2020 2020 2020 2020 2020 2069 6620 6c65             if le
-00032b60: 6e28 7461 7267 6574 7329 203e 2031 3a0a  n(targets) > 1:.
+00031170: 2020 2020 2020 2020 2020 2020 6966 2073              if s
+00031180: 656c 662e 7665 7262 6f73 653a 0a20 2020  elf.verbose:.   
+00031190: 2020 2020 2020 2020 2020 2020 2020 2020                  
+000311a0: 2020 2020 2020 2020 2020 2020 2070 7269               pri
+000311b0: 6e74 2827 4669 7474 696e 6720 6120 2573  nt('Fitting a %s
+000311c0: 2066 6f72 2025 7320 7461 7267 6574 7320   for %s targets 
+000311d0: 7769 7468 204d 756c 7469 4f75 7470 7574  with MultiOutput
+000311e0: 436c 6173 7369 6669 6572 2e20 5468 6973  Classifier. This
+000311f0: 2077 696c 6c20 7461 6b65 2074 696d 652e   will take time.
+00031200: 2e2e 2720 2528 0a20 2020 2020 2020 2020  ..' %(.         
+00031210: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00031220: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00031230: 2020 2073 7472 2873 656c 662e 6261 7365     str(self.base
+00031240: 5f65 7374 696d 6174 6f72 292e 7370 6c69  _estimator).spli
+00031250: 7428 2228 2229 5b30 5d2c 792e 7368 6170  t("(")[0],y.shap
+00031260: 655b 315d 2929 0a20 2020 2020 2020 2020  e[1])).         
+00031270: 2020 2020 2020 2020 2020 2020 2020 2065                 e
+00031280: 6c73 653a 0a20 2020 2020 2020 2020 2020  lse:.           
+00031290: 2020 2020 2020 2020 2020 2020 2020 2020                  
+000312a0: 2069 6620 7365 6c66 2e69 6d62 616c 616e   if self.imbalan
+000312b0: 6365 643a 0a20 2020 2020 2020 2020 2020  ced:.           
+000312c0: 2020 2020 2020 2020 2020 2020 2020 2020                  
+000312d0: 2020 2020 2069 6620 7365 6c66 2e76 6572       if self.ver
+000312e0: 626f 7365 3a0a 2020 2020 2020 2020 2020  bose:.          
+000312f0: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00031300: 2020 2020 2020 2020 2020 7072 696e 7428            print(
+00031310: 2720 2020 2054 7261 696e 696e 6720 7769  '    Training wi
+00031320: 7468 2043 6c61 7373 6966 6965 7243 6861  th ClassifierCha
+00031330: 696e 2073 696e 6365 206d 756c 7469 5f6c  in since multi_l
+00031340: 6162 656c 2064 6174 6173 6574 2e20 5468  abel dataset. Th
+00031350: 6973 2077 696c 6c20 7461 6b65 2074 696d  is will take tim
+00031360: 652e 2e2e 2729 0a20 2020 2020 2020 2020  e...').         
+00031370: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00031380: 2020 2020 2020 2065 7374 5f6c 6973 7420         est_list 
+00031390: 3d20 5b43 6c61 7373 6966 6965 7243 6861  = [ClassifierCha
+000313a0: 696e 2873 656c 662e 6261 7365 5f65 7374  in(self.base_est
+000313b0: 696d 6174 6f72 2c20 6f72 6465 723d 4e6f  imator, order=No
+000313c0: 6e65 2c20 7261 6e64 6f6d 5f73 7461 7465  ne, random_state
+000313d0: 3d69 290a 2020 2020 2020 2020 2020 2020  =i).            
+000313e0: 2020 2020 2020 2020 2020 2020 2020 2020                  
+000313f0: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00031400: 666f 7220 6920 696e 2072 616e 6765 286e  for i in range(n
+00031410: 756d 5f69 7465 7261 7469 6f6e 7329 5d20  um_iterations)] 
+00031420: 0a20 2020 2020 2020 2020 2020 2020 2020  .               
+00031430: 2020 2020 2020 2020 2020 2020 2065 6c73               els
+00031440: 653a 0a20 2020 2020 2020 2020 2020 2020  e:.             
+00031450: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00031460: 2020 2023 2323 2059 6f75 206d 7573 7420     ### You must 
+00031470: 7573 6520 6d75 6c74 696f 7574 7075 7463  use multioutputc
+00031480: 6c61 7373 6966 6965 7220 7369 6e63 6520  lassifier since 
+00031490: 6974 2069 7320 7468 6520 6f6e 6c79 206f  it is the only o
+000314a0: 6e65 2070 7265 6469 6374 7320 7072 6f62  ne predicts prob
+000314b0: 6173 2063 6f72 7265 6374 6c79 2023 230a  as correctly ##.
+000314c0: 2020 2020 2020 2020 2020 2020 2020 2020                  
+000314d0: 2020 2020 2020 2020 2020 2020 2020 2020                  
+000314e0: 6573 745f 6c69 7374 203d 205b 4d75 6c74  est_list = [Mult
+000314f0: 694f 7574 7075 7443 6c61 7373 6966 6965  iOutputClassifie
+00031500: 7228 7365 6c66 2e62 6173 655f 6573 7469  r(self.base_esti
+00031510: 6d61 746f 7229 232c 206f 7264 6572 3d22  mator)#, order="
+00031520: 7261 6e64 6f6d 222c 2072 616e 646f 6d5f  random", random_
+00031530: 7374 6174 653d 6929 200a 2020 2020 2020  state=i) .      
+00031540: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00031550: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00031560: 2020 2020 2020 666f 7220 6920 696e 2072        for i in r
+00031570: 616e 6765 286e 756d 5f69 7465 7261 7469  ange(num_iterati
+00031580: 6f6e 7329 5d20 0a20 2020 2020 2020 2020  ons)] .         
+00031590: 2020 2020 2020 2020 2020 2020 2020 2020                  
+000315a0: 2020 2020 2020 2069 6620 7365 6c66 2e76         if self.v
+000315b0: 6572 626f 7365 3a0a 2020 2020 2020 2020  erbose:.        
+000315c0: 2020 2020 2020 2020 2020 2020 2020 2020                  
+000315d0: 2020 2020 2020 2020 2020 2020 7072 696e              prin
+000315e0: 7428 2754 7261 696e 696e 6720 6120 2573  t('Training a %s
+000315f0: 2066 6f72 2025 7320 7461 7267 6574 7320   for %s targets 
+00031600: 7769 7468 204d 756c 7469 4f75 7470 7574  with MultiOutput
+00031610: 436c 6173 7369 6669 6572 2e20 5468 6973  Classifier. This
+00031620: 2077 696c 6c20 7461 6b65 2074 696d 652e   will take time.
+00031630: 2e2e 2720 2528 0a20 2020 2020 2020 2020  ..' %(.         
+00031640: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00031650: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00031660: 2020 2020 2020 2073 7472 2873 656c 662e         str(self.
+00031670: 6261 7365 5f65 7374 696d 6174 6f72 292e  base_estimator).
+00031680: 7370 6c69 7428 2228 2229 5b30 5d2c 792e  split("(")[0],y.
+00031690: 7368 6170 655b 315d 2929 0a0a 2020 2020  shape[1]))..    
+000316a0: 2020 2020 2020 2020 2020 2020 2020 2020                  
+000316b0: 2320 496e 6974 6961 6c69 7a65 206d 6f64  # Initialize mod
+000316c0: 656c 2077 6974 6820 796f 7572 2073 7570  el with your sup
+000316d0: 6572 7669 7365 6420 616c 676f 7269 7468  ervised algorith
+000316e0: 6d20 6f66 2063 686f 6963 650a 2020 2020  m of choice.    
+000316f0: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00031700: 6d6f 6465 6c20 3d20 6573 745f 6c69 7374  model = est_list
+00031710: 5b69 5d0a 0a20 2020 2020 2020 2020 2020  [i]..           
+00031720: 2020 2020 2020 2020 2023 2054 7261 696e           # Train
+00031730: 206d 6f64 656c 2061 6e64 2075 7365 2069   model and use i
+00031740: 7420 746f 2074 7261 696e 206f 6e20 7468  t to train on th
+00031750: 6520 666f 6c64 0a20 2020 2020 2020 2020  e fold.         
+00031760: 2020 2020 2020 2020 2020 2069 6620 7365             if se
+00031770: 6c66 2e70 6970 656c 696e 653a 0a20 2020  lf.pipeline:.   
+00031780: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00031790: 2020 2020 2023 2323 2054 6869 7320 6973       ### This is
+000317a0: 206f 6e6c 7920 7769 7468 2061 2070 6970   only with a pip
+000317b0: 656c 696e 6520 2323 2323 2323 2323 0a20  eline ########. 
+000317c0: 2020 2020 2020 2020 2020 2020 2020 2020                  
+000317d0: 2020 2020 2020 2070 6970 6520 3d20 5069         pipe = Pi
+000317e0: 7065 6c69 6e65 280a 2020 2020 2020 2020  peline(.        
+000317f0: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00031800: 2020 2020 7374 6570 733d 5b28 2270 7265      steps=[("pre
+00031810: 7072 6f63 6573 736f 7222 2c20 7072 6570  processor", prep
+00031820: 726f 6365 7373 6f72 292c 2028 226d 6f64  rocessor), ("mod
+00031830: 656c 222c 206d 6f64 656c 295d 0a20 2020  el", model)].   
+00031840: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00031850: 2020 2020 2029 0a0a 2020 2020 2020 2020       )..        
+00031860: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00031870: 7069 7065 2e66 6974 2878 5f74 7261 696e  pipe.fit(x_train
+00031880: 2c20 795f 7472 6169 6e29 0a20 2020 2020  , y_train).     
+00031890: 2020 2020 2020 2020 2020 2020 2020 2020                  
+000318a0: 2020 2073 656c 662e 6d6f 6465 6c73 2e61     self.models.a
+000318b0: 7070 656e 6428 7069 7065 290a 0a20 2020  ppend(pipe)..   
+000318c0: 2020 2020 2020 2020 2020 2020 2020 2020                  
+000318d0: 2020 2020 2023 2050 7265 6469 6374 206f       # Predict o
+000318e0: 6e20 7265 6d61 696e 696e 6720 6461 7461  n remaining data
+000318f0: 206f 6620 6561 6368 2066 6f6c 640a 2020   of each fold.  
+00031900: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00031910: 2020 2020 2020 7072 6564 7320 3d20 7069        preds = pi
+00031920: 7065 2e70 7265 6469 6374 2878 5f74 6573  pe.predict(x_tes
+00031930: 7429 0a0a 2020 2020 2020 2020 2020 2020  t)..            
+00031940: 2020 2020 2020 2020 656c 7365 3a0a 2020          else:.  
+00031950: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00031960: 2020 2020 2020 2323 2323 2054 6869 7320        #### This 
+00031970: 6973 2077 6974 686f 7574 2061 2070 6970  is without a pip
+00031980: 656c 696e 6520 2323 230a 2020 2020 2020  eline ###.      
+00031990: 2020 2020 2020 2020 2020 2020 2020 2020                  
+000319a0: 2020 6d6f 6465 6c2e 6669 7428 785f 7472    model.fit(x_tr
+000319b0: 6169 6e2c 2079 5f74 7261 696e 290a 2020  ain, y_train).  
+000319c0: 2020 2020 2020 2020 2020 2020 2020 2020                  
+000319d0: 2020 2020 2020 7365 6c66 2e6d 6f64 656c        self.model
+000319e0: 732e 6170 7065 6e64 286d 6f64 656c 290a  s.append(model).
+000319f0: 0a20 2020 2020 2020 2020 2020 2020 2020  .               
+00031a00: 2020 2020 2020 2020 2023 2050 7265 6469           # Predi
+00031a10: 6374 206f 6e20 7265 6d61 696e 696e 6720  ct on remaining 
+00031a20: 6461 7461 206f 6620 6561 6368 2066 6f6c  data of each fol
+00031a30: 640a 2020 2020 2020 2020 2020 2020 2020  d.              
+00031a40: 2020 2020 2020 2020 2020 7072 6564 7320            preds 
+00031a50: 3d20 6d6f 6465 6c2e 7072 6564 6963 7428  = model.predict(
+00031a60: 785f 7465 7374 290a 0a20 2020 2020 2020  x_test)..       
+00031a70: 2020 2020 2020 2020 2020 2020 200a 2020               .  
+00031a80: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00031a90: 2020 2320 5573 6520 6265 7374 2063 6c61    # Use best cla
+00031aa0: 7373 6966 6963 6174 696f 6e20 6d65 7472  ssification metr
+00031ab0: 6963 2074 6f20 6d65 6173 7572 6520 7065  ic to measure pe
+00031ac0: 7266 6f72 6d61 6e63 6520 6f66 206d 6f64  rformance of mod
+00031ad0: 656c 0a20 2020 2020 2020 2020 2020 2020  el.             
+00031ae0: 2020 2020 2020 2069 6620 7365 6c66 2e69         if self.i
+00031af0: 6d62 616c 616e 6365 643a 0a20 2020 2020  mbalanced:.     
+00031b00: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00031b10: 2020 2023 2323 2055 7365 2073 7065 6369     ### Use speci
+00031b20: 616c 2070 7269 7469 6e67 2070 726f 6772  al priting progr
+00031b30: 616d 2068 6572 6520 2323 0a20 2020 2020  am here ##.     
+00031b40: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00031b50: 2020 2073 636f 7265 203d 2070 7269 6e74     score = print
+00031b60: 5f73 756c 6f5f 6163 6375 7261 6379 2879  _sulo_accuracy(y
+00031b70: 5f74 6573 742c 2070 7265 6473 2c20 795f  _test, preds, y_
+00031b80: 7072 6f62 6173 3d22 222c 2076 6572 626f  probas="", verbo
+00031b90: 7365 3d73 656c 662e 7665 7262 6f73 6529  se=self.verbose)
+00031ba0: 0a20 2020 2020 2020 2020 2020 2020 2020  .               
+00031bb0: 2020 2020 2020 2020 2069 6620 7365 6c66           if self
+00031bc0: 2e76 6572 626f 7365 3a0a 2020 2020 2020  .verbose:.      
+00031bd0: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00031be0: 2020 2020 2020 7072 696e 7428 2220 2020        print("   
+00031bf0: 2046 6f6c 6420 2573 3a20 6f75 742d 6f66   Fold %s: out-of
+00031c00: 2d66 6f6c 6420 6261 6c61 6e63 6564 5f61  -fold balanced_a
+00031c10: 6363 7572 6163 793a 2025 302e 3166 2525  ccuracy: %0.1f%%
+00031c20: 2220 2528 692b 312c 2031 3030 2a73 636f  " %(i+1, 100*sco
+00031c30: 7265 2929 0a20 2020 2020 2020 2020 2020  re)).           
+00031c40: 2020 2020 2020 2020 2065 6c73 653a 0a20           else:. 
+00031c50: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00031c60: 2020 2020 2020 2073 636f 7265 203d 2070         score = p
+00031c70: 7269 6e74 5f61 6363 7572 6163 7928 7461  rint_accuracy(ta
+00031c80: 7267 6574 732c 2079 5f74 6573 742c 2070  rgets, y_test, p
+00031c90: 7265 6473 2c20 7665 7262 6f73 653d 7365  reds, verbose=se
+00031ca0: 6c66 2e76 6572 626f 7365 290a 2020 2020  lf.verbose).    
+00031cb0: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00031cc0: 2020 2020 6966 2073 656c 662e 7665 7262      if self.verb
+00031cd0: 6f73 653a 0a20 2020 2020 2020 2020 2020  ose:.           
+00031ce0: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00031cf0: 2070 7269 6e74 2822 2020 2020 466f 6c64   print("    Fold
+00031d00: 2025 733a 206f 7574 2d6f 662d 666f 6c64   %s: out-of-fold
+00031d10: 2062 616c 616e 6365 645f 6163 6375 7261   balanced_accura
+00031d20: 6379 3a20 2530 2e31 6625 2522 2025 2869  cy: %0.1f%%" %(i
+00031d30: 2b31 2c20 3130 302a 7363 6f72 6529 290a  +1, 100*score)).
+00031d40: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00031d50: 2020 2020 7365 6c66 2e73 636f 7265 732e      self.scores.
+00031d60: 6170 7065 6e64 2873 636f 7265 290a 2020  append(score).  
+00031d70: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00031d80: 2020 0a20 2020 2020 2020 2020 2020 2020    .             
+00031d90: 2020 2020 2020 2023 2046 696e 616c 6c79         # Finally
+00031da0: 2c20 6368 6563 6b20 6f75 7420 7468 6520  , check out the 
+00031db0: 746f 7461 6c20 7469 6d65 2074 616b 656e  total time taken
+00031dc0: 0a20 2020 2020 2020 2020 2020 2020 2020  .               
+00031dd0: 2020 2020 2065 6e64 5f74 696d 6520 3d20       end_time = 
+00031de0: 7469 6d65 2e74 696d 6528 290a 2020 2020  time.time().    
+00031df0: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00031e00: 7469 6d65 5461 6b65 6e20 3d20 656e 645f  timeTaken = end_
+00031e10: 7469 6d65 202d 2073 7461 7274 5f74 696d  time - start_tim
+00031e20: 650a 2020 2020 2020 2020 2020 2020 2020  e.              
+00031e30: 2020 2020 2020 6966 2073 656c 662e 7665        if self.ve
+00031e40: 7262 6f73 653a 0a20 2020 2020 2020 2020  rbose:.         
+00031e50: 2020 2020 2020 2020 2020 2020 2020 2070                 p
+00031e60: 7269 6e74 2822 5469 6d65 2054 616b 656e  rint("Time Taken
+00031e70: 2066 6f72 2066 6f6c 6420 2573 3a20 2530   for fold %s: %0
+00031e80: 2e30 6620 2873 6563 6f6e 6473 2922 2025  .0f (seconds)" %
+00031e90: 2869 2b31 2c20 7469 6d65 5461 6b65 6e29  (i+1, timeTaken)
+00031ea0: 290a 0a20 2020 2020 2020 2020 2020 2020  )..             
+00031eb0: 2020 2020 2020 2069 202b 3d20 310a 0a20         i += 1.. 
+00031ec0: 2020 2020 2020 2020 2020 2020 2020 2023                 #
+00031ed0: 2043 6f6d 7075 7465 2061 7665 7261 6765   Compute average
+00031ee0: 2073 636f 7265 0a20 2020 2020 2020 2020   score.         
+00031ef0: 2020 2020 2020 2061 7665 7261 6765 4163         averageAc
+00031f00: 6375 7261 6379 203d 2073 756d 2873 656c  curacy = sum(sel
+00031f10: 662e 7363 6f72 6573 292f 6c65 6e28 7365  f.scores)/len(se
+00031f20: 6c66 2e73 636f 7265 7329 0a20 2020 2020  lf.scores).     
+00031f30: 2020 2020 2020 2020 2020 2070 7269 6e74             print
+00031f40: 2822 4669 6e61 6c20 4261 6c61 6e63 6564  ("Final Balanced
+00031f50: 2041 6363 7572 6163 7920 7363 6f72 6520   Accuracy score 
+00031f60: 6f66 2025 732d 6573 7469 6d61 746f 7220  of %s-estimator 
+00031f70: 5375 6c6f 436c 6173 7369 6669 6572 3a20  SuloClassifier: 
+00031f80: 2530 2e31 6625 2522 2025 280a 2020 2020  %0.1f%%" %(.    
+00031f90: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00031fa0: 2020 2020 2020 2020 2020 2020 7365 6c66              self
+00031fb0: 2e6e 5f65 7374 696d 6174 6f72 732c 2031  .n_estimators, 1
+00031fc0: 3030 2a61 7665 7261 6765 4163 6375 7261  00*averageAccura
+00031fd0: 6379 2929 0a0a 2020 2020 2020 2020 2020  cy))..          
+00031fe0: 2020 2020 2020 656e 6420 3d20 7469 6d65        end = time
+00031ff0: 2e74 696d 6528 290a 2020 2020 2020 2020  .time().        
+00032000: 2020 2020 2020 2020 7469 6d65 5461 6b65          timeTake
+00032010: 6e20 3d20 656e 6420 2d20 7374 6172 740a  n = end - start.
+00032020: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00032030: 7072 696e 7428 2254 696d 6520 5461 6b65  print("Time Take
+00032040: 6e20 6f76 6572 616c 6c3a 2025 302e 3066  n overall: %0.0f
+00032050: 2028 7365 636f 6e64 7329 2220 2528 7469   (seconds)" %(ti
+00032060: 6d65 5461 6b65 6e29 290a 2020 2020 2020  meTaken)).      
+00032070: 2020 2020 2020 2020 2020 7365 6c66 2e6b            self.k
+00032080: 6620 3d20 6b66 6f6c 640a 2020 2020 2020  f = kfold.      
+00032090: 2020 2020 2020 2020 2020 7265 7475 726e            return
+000320a0: 2073 656c 660a 2020 2020 2020 2020 2323   self.        ##
+000320b0: 2323 2323 2323 2323 2323 2323 2323 2323  ################
+000320c0: 2323 2323 2323 2323 2323 2323 2323 2323  ################
+000320d0: 2323 2323 2323 2323 2323 2323 2323 2323  ################
+000320e0: 2323 2323 2323 0a20 2020 2020 2020 2023  ######.        #
+000320f0: 2323 2323 2020 5468 6973 2069 7320 666f  ####  This is fo
+00032100: 7220 5369 6e67 6c65 204c 6162 656c 2043  r Single Label C
+00032110: 6c61 7373 6966 6963 6174 696f 6e20 7072  lassification pr
+00032120: 6f62 6c65 6d73 200a 2020 2020 2020 2020  oblems .        
+00032130: 2323 2323 2323 2323 2323 2323 2323 2323  ################
+00032140: 2323 2323 2323 2323 2323 2323 2323 2323  ################
+00032150: 2323 2323 2323 2323 2323 2323 2323 2323  ################
+00032160: 2323 2323 2323 2323 0a20 2020 2020 2020  ########.       
+00032170: 200a 2020 2020 2020 2020 6966 2069 7369   .        if isi
+00032180: 6e73 7461 6e63 6528 792c 2070 642e 5365  nstance(y, pd.Se
+00032190: 7269 6573 293a 0a20 2020 2020 2020 2020  ries):.         
+000321a0: 2020 2074 6172 6765 7473 203d 2079 2e6e     targets = y.n
+000321b0: 616d 650a 2020 2020 2020 2020 2020 2020  ame.            
+000321c0: 6966 2074 6172 6765 7473 2069 7320 4e6f  if targets is No
+000321d0: 6e65 3a0a 2020 2020 2020 2020 2020 2020  ne:.            
+000321e0: 2020 2020 7461 7267 6574 7320 3d20 5b5d      targets = []
+000321f0: 0a20 2020 2020 2020 2065 6c73 653a 0a20  .        else:. 
+00032200: 2020 2020 2020 2020 2020 2074 6172 6765             targe
+00032210: 7473 203d 205b 5d0a 0a20 2020 2020 2020  ts = []..       
+00032220: 2065 7374 5f6c 6973 7420 3d20 6e75 6d5f   est_list = num_
+00032230: 6974 6572 6174 696f 6e73 2a5b 7365 6c66  iterations*[self
+00032240: 2e62 6173 655f 6573 7469 6d61 746f 725d  .base_estimator]
+00032250: 0a20 2020 2020 2020 200a 2020 2020 2020  .        .      
+00032260: 2020 2320 5065 7266 6f72 6d20 4356 0a20    # Perform CV. 
+00032270: 2020 2020 2020 2069 203d 2030 0a20 2020         i = 0.   
+00032280: 2020 2020 2066 6f72 2074 7261 696e 5f69       for train_i
+00032290: 6e64 6578 2c20 7465 7374 5f69 6e64 6578  ndex, test_index
+000322a0: 2069 6e20 7471 646d 286b 666f 6c64 2e73   in tqdm(kfold.s
+000322b0: 706c 6974 2858 2c20 7929 2c20 746f 7461  plit(X, y), tota
+000322c0: 6c3d 6b66 6f6c 642e 6765 745f 6e5f 7370  l=kfold.get_n_sp
+000322d0: 6c69 7473 2829 2c20 0a20 2020 2020 2020  lits(), .       
+000322e0: 2020 2020 2020 2020 2020 2020 2020 2020                  
+000322f0: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00032300: 2064 6573 633d 226b 2d66 6f6c 6420 7472   desc="k-fold tr
+00032310: 6169 6e69 6e67 2229 3a0a 2020 2020 2020  aining"):.      
+00032320: 2020 2020 2020 7374 6172 745f 7469 6d65        start_time
+00032330: 203d 2074 696d 652e 7469 6d65 2829 0a20   = time.time(). 
+00032340: 2020 2020 2020 2020 2020 2072 616e 646f             rando
+00032350: 6d5f 7365 6564 203d 206e 702e 7261 6e64  m_seed = np.rand
+00032360: 6f6d 2e72 616e 6469 6e74 2832 2c31 3030  om.randint(2,100
+00032370: 290a 2020 2020 2020 2020 2020 2020 2323  ).            ##
+00032380: 2323 2323 2323 2323 2020 5468 6973 2069  ########  This i
+00032390: 7320 7768 6572 6520 7765 2064 6f20 6d75  s where we do mu
+000323a0: 6c74 692d 7365 6564 2063 6c61 7373 6966  lti-seed classif
+000323b0: 6965 7273 2023 2323 2323 2323 2323 0a20  iers #########. 
+000323c0: 2020 2020 2020 2020 2020 200a 2020 2020             .    
+000323d0: 2020 2020 2020 2020 6966 2073 656c 662e          if self.
+000323e0: 6261 7365 5f65 7374 696d 6174 6f72 2069  base_estimator i
+000323f0: 7320 4e6f 6e65 3a0a 2020 2020 2020 2020  s None:.        
+00032400: 2020 2020 2020 2020 6966 2064 6174 615f          if data_
+00032410: 7361 6d70 6c65 7320 3c3d 2072 6f77 5f6c  samples <= row_l
+00032420: 696d 6974 3a0a 2020 2020 2020 2020 2020  imit:.          
+00032430: 2020 2020 2020 2020 2020 2323 2320 466f            ### Fo
+00032440: 7220 736d 616c 6c20 6461 7461 7365 7473  r small datasets
+00032450: 2075 7365 2052 4643 2066 6f72 2042 696e   use RFC for Bin
+00032460: 6172 7920 436c 6173 7320 2020 2323 2323  ary Class   ####
+00032470: 2323 2323 2323 2323 2323 2323 2323 2323  ################
+00032480: 2323 2323 0a20 2020 2020 2020 2020 2020  ####.           
+00032490: 2020 2020 2020 2020 2069 6620 6e75 6d62           if numb
+000324a0: 6572 5f6f 665f 636c 6173 7365 7320 3c3d  er_of_classes <=
+000324b0: 2031 3a0a 2020 2020 2020 2020 2020 2020   1:.            
+000324c0: 2020 2020 2020 2020 2020 2020 6966 2073              if s
+000324d0: 656c 662e 696d 6261 6c61 6e63 6564 3a0a  elf.imbalanced:.
+000324e0: 2020 2020 2020 2020 2020 2020 2020 2020                  
+000324f0: 2020 2020 2020 2020 2020 2020 6966 2073              if s
+00032500: 656c 662e 7665 7262 6f73 653a 0a20 2020  elf.verbose:.   
+00032510: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00032520: 2020 2020 2020 2020 2020 2020 2070 7269               pri
+00032530: 6e74 2827 2020 2020 5365 6c65 6374 696e  nt('    Selectin
+00032540: 6720 5365 6c66 2050 6163 6564 2065 6e73  g Self Paced ens
+00032550: 656d 626c 6520 636c 6173 7369 6669 6572  emble classifier
+00032560: 2061 7320 6261 7365 2065 7374 696d 6174   as base estimat
+00032570: 6f72 2e2e 2e27 290a 2020 2020 2020 2020  or...').        
+00032580: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00032590: 2020 2020 7472 793a 0a20 2020 2020 2020      try:.       
+000325a0: 2020 2020 2020 2020 2020 2020 2020 2020                  
+000325b0: 2020 2020 2020 2020 2066 726f 6d20 696d           from im
+000325c0: 6261 6c61 6e63 6564 5f65 6e73 656d 626c  balanced_ensembl
+000325d0: 652e 656e 7365 6d62 6c65 2069 6d70 6f72  e.ensemble impor
+000325e0: 7420 5365 6c66 5061 6365 6445 6e73 656d  t SelfPacedEnsem
+000325f0: 626c 6543 6c61 7373 6966 6965 720a 2020  bleClassifier.  
+00032600: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00032610: 2020 2020 2020 2020 2020 2020 2020 7365                se
+00032620: 6c66 2e62 6173 655f 6573 7469 6d61 746f  lf.base_estimato
+00032630: 7220 3d20 5365 6c66 5061 6365 6445 6e73  r = SelfPacedEns
+00032640: 656d 626c 6543 6c61 7373 6966 6965 7228  embleClassifier(
+00032650: 6e5f 6a6f 6273 3d2d 312c 2072 616e 646f  n_jobs=-1, rando
+00032660: 6d5f 7374 6174 653d 7261 6e64 6f6d 5f73  m_state=random_s
+00032670: 6565 6429 0a20 2020 2020 2020 2020 2020  eed).           
+00032680: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00032690: 2065 7863 6570 743a 0a20 2020 2020 2020   except:.       
+000326a0: 2020 2020 2020 2020 2020 2020 2020 2020                  
+000326b0: 2020 2020 2020 2020 2070 7269 6e74 2827           print('
+000326c0: 7069 7020 696e 7374 616c 6c20 696d 6261  pip install imba
+000326d0: 6c61 6e63 6564 5f65 6e73 656d 626c 6520  lanced_ensemble 
+000326e0: 616e 6420 7265 2d72 756e 2074 6869 7320  and re-run this 
+000326f0: 6167 6169 6e2e 2729 0a20 2020 2020 2020  again.').       
+00032700: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00032710: 2020 2020 2020 2020 2072 6574 7572 6e20           return 
+00032720: 7365 6c66 0a20 2020 2020 2020 2020 2020  self.           
+00032730: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00032740: 2073 656c 662e 6d6f 6465 6c5f 6e61 6d65   self.model_name
+00032750: 203d 2027 6f74 6865 7227 0a20 2020 2020   = 'other'.     
+00032760: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00032770: 2020 2065 6c73 653a 0a20 2020 2020 2020     else:.       
+00032780: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00032790: 2020 2020 2023 2323 2046 6f72 2062 696e       ### For bin
+000327a0: 6172 792d 636c 6173 7320 7072 6f62 6c65  ary-class proble
+000327b0: 6d73 2075 7365 2052 616e 646f 6d46 6f72  ms use RandomFor
+000327c0: 6573 7420 6f72 2074 6865 2066 6173 7465  est or the faste
+000327d0: 7220 4554 2043 6c61 7373 6966 6965 7220  r ET Classifier 
+000327e0: 2323 2323 2323 0a20 2020 2020 2020 2020  ######.         
+000327f0: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00032800: 2020 2069 6620 2858 2e64 7479 7065 733d     if (X.dtypes=
+00032810: 3d66 6c6f 6174 292e 616c 6c28 2920 616e  =float).all() an
+00032820: 6420 6c65 6e28 7365 6c66 2e66 6561 7475  d len(self.featu
+00032830: 7265 7329 203c 3d20 6665 6174 7572 6573  res) <= features
+00032840: 5f6c 696d 6974 3a0a 2020 2020 2020 2020  _limit:.        
+00032850: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00032860: 2020 2020 2020 2020 7072 696e 7428 2720          print(' 
+00032870: 2020 2053 656c 6563 7469 6e67 204c 6162     Selecting Lab
+00032880: 656c 2050 726f 7061 6761 7469 6f6e 2073  el Propagation s
+00032890: 696e 6365 2069 7420 7769 6c6c 2077 6f72  ince it will wor
+000328a0: 6b20 6772 6561 7420 666f 7220 7468 6973  k great for this
+000328b0: 2064 6174 6173 6574 2e2e 2e27 290a 2020   dataset...').  
+000328c0: 2020 2020 2020 2020 2020 2020 2020 2020                  
+000328d0: 2020 2020 2020 2020 2020 2020 2020 7072                pr
+000328e0: 696e 7428 2720 2020 2020 2020 2068 6f77  int('        how
+000328f0: 6576 6572 2069 7420 7769 6c6c 2073 6b65  ever it will ske
+00032900: 7720 7072 6f62 6162 696c 6974 6965 7320  w probabilities 
+00032910: 616e 6420 7368 6f77 206c 6f77 6572 2052  and show lower R
+00032920: 4f43 2041 5543 2073 636f 7265 2074 6861  OC AUC score tha
+00032930: 6e20 6e6f 726d 616c 2e27 290a 2020 2020  n normal.').    
+00032940: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00032950: 2020 2020 2020 2020 2020 2020 7365 6c66              self
+00032960: 2e62 6173 655f 6573 7469 6d61 746f 7220  .base_estimator 
+00032970: 3d20 204c 6162 656c 5072 6f70 6167 6174  =  LabelPropagat
+00032980: 696f 6e28 290a 2020 2020 2020 2020 2020  ion().          
+00032990: 2020 2020 2020 2020 2020 2020 2020 2020                  
+000329a0: 2020 2020 2020 7365 6c66 2e6d 6f64 656c        self.model
+000329b0: 5f6e 616d 6520 3d20 276c 7027 0a20 2020  _name = 'lp'.   
+000329c0: 2020 2020 2020 2020 2020 2020 2020 2020                  
+000329d0: 2020 2020 2020 2020 2065 6c73 653a 0a20           else:. 
+000329e0: 2020 2020 2020 2020 2020 2020 2020 2020                  
+000329f0: 2020 2020 2020 2020 2020 2020 2020 2069                 i
+00032a00: 6620 6c65 6e28 7365 6c66 2e66 6561 7475  f len(self.featu
+00032a10: 7265 7329 203c 3d20 6665 6174 7572 6573  res) <= features
+00032a20: 5f6c 696d 6974 3a0a 2020 2020 2020 2020  _limit:.        
+00032a30: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00032a40: 2020 2020 2020 2020 2020 2020 6966 2073              if s
+00032a50: 656c 662e 7665 7262 6f73 653a 0a20 2020  elf.verbose:.   
+00032a60: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00032a70: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00032a80: 2020 2020 2070 7269 6e74 2827 2020 2020       print('    
+00032a90: 5365 6c65 6374 696e 6720 4261 6767 696e  Selecting Baggin
+00032aa0: 6720 436c 6173 7369 6669 6572 2066 6f72  g Classifier for
+00032ab0: 2074 6869 7320 6461 7461 7365 742e 2e2e   this dataset...
+00032ac0: 2729 0a20 2020 2020 2020 2020 2020 2020  ').             
+00032ad0: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00032ae0: 2020 2020 2020 2023 2323 2054 6865 2042         ### The B
+00032af0: 6167 6769 6e67 2063 6c61 7373 6966 6965  agging classifie
+00032b00: 7220 6f75 7470 6572 666f 726d 7320 4554  r outperforms ET
+00032b10: 4320 6d6f 7374 206f 6620 7468 6520 7469  C most of the ti
+00032b20: 6d65 2023 2323 230a 2020 2020 2020 2020  me ####.        
+00032b30: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00032b40: 2020 2020 2020 2020 2020 2020 4554 203d              ET =
+00032b50: 2045 7874 7261 5472 6565 436c 6173 7369   ExtraTreeClassi
+00032b60: 6669 6572 2829 0a20 2020 2020 2020 2020  fier().         
 00032b70: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00032b80: 7365 6c66 2e6d 756c 7469 5f6c 6162 656c  self.multi_label
-00032b90: 203d 2079 2e63 6f6c 756d 6e73 2e74 6f6c   = y.columns.tol
-00032ba0: 6973 7428 290a 2020 2020 2020 2020 2020  ist().          
-00032bb0: 2020 2020 2020 2323 2320 596f 7520 6e65        ### You ne
-00032bc0: 6564 2074 6f20 696e 6974 6961 6c69 7a65  ed to initialize
-00032bd0: 2074 6865 2063 6c61 7373 2062 6566 6f72   the class befor
-00032be0: 6520 6561 6368 2072 756e 202d 206f 7468  e each run - oth
-00032bf0: 6572 7769 7365 2c20 6572 726f 7221 0a20  erwise, error!. 
-00032c00: 2020 2020 2020 2020 2020 2020 2020 2023                 #
-00032c10: 2323 2052 656d 656d 6265 7220 7765 2064  ## Remember we d
-00032c20: 6f6e 2774 2074 6f20 4850 5420 5475 6e69  on't to HPT Tuni
-00032c30: 6e67 2066 6f72 204d 756c 7469 2d6c 6162  ng for Multi-lab
-00032c40: 656c 2070 726f 626c 656d 7320 7369 6e63  el problems sinc
-00032c50: 6520 6974 2065 7272 6f72 7320 2323 2323  e it errors ####
-00032c60: 0a20 2020 2020 2020 2020 2020 2020 2020  .               
-00032c70: 2069 203d 2030 0a20 2020 2020 2020 2020   i = 0.         
-00032c80: 2020 2020 2020 2066 6f72 2074 7261 696e         for train
-00032c90: 5f69 6e64 6578 2c20 7465 7374 5f69 6e64  _index, test_ind
-00032ca0: 6578 2069 6e20 7471 646d 286b 666f 6c64  ex in tqdm(kfold
-00032cb0: 2e73 706c 6974 2858 2c20 7929 2c20 746f  .split(X, y), to
-00032cc0: 7461 6c3d 6b66 6f6c 642e 6765 745f 6e5f  tal=kfold.get_n_
-00032cd0: 7370 6c69 7473 2829 2c0a 2020 2020 2020  splits(),.      
-00032ce0: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00032cf0: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00032d00: 2020 2020 2020 6465 7363 3d22 6b2d 666f        desc="k-fo
-00032d10: 6c64 2074 7261 696e 696e 6722 293a 0a20  ld training"):. 
-00032d20: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00032d30: 2020 2073 7461 7274 5f74 696d 6520 3d20     start_time = 
-00032d40: 7469 6d65 2e74 696d 6528 290a 2020 2020  time.time().    
+00032b80: 2020 2020 2020 2020 2020 2073 656c 662e             self.
+00032b90: 6261 7365 5f65 7374 696d 6174 6f72 203d  base_estimator =
+00032ba0: 2042 6167 6769 6e67 436c 6173 7369 6669   BaggingClassifi
+00032bb0: 6572 2862 6173 655f 6573 7469 6d61 746f  er(base_estimato
+00032bc0: 723d 4554 2c20 6e5f 6a6f 6273 3d2d 3129  r=ET, n_jobs=-1)
+00032bd0: 0a20 2020 2020 2020 2020 2020 2020 2020  .               
+00032be0: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00032bf0: 2020 2020 2073 656c 662e 6d6f 6465 6c5f       self.model_
+00032c00: 6e61 6d65 203d 2027 6267 270a 2020 2020  name = 'bg'.    
+00032c10: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00032c20: 2020 2020 2020 2020 2020 2020 656c 7365              else
+00032c30: 3a0a 2020 2020 2020 2020 2020 2020 2020  :.              
+00032c40: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00032c50: 2020 2020 2020 6966 2073 656c 662e 7665        if self.ve
+00032c60: 7262 6f73 653a 0a20 2020 2020 2020 2020  rbose:.         
+00032c70: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00032c80: 2020 2020 2020 2020 2020 2020 2020 2070                 p
+00032c90: 7269 6e74 2827 2020 2020 5365 6c65 6374  rint('    Select
+00032ca0: 696e 6720 4c47 424d 2043 6c61 7373 6966  ing LGBM Classif
+00032cb0: 6965 7220 6173 2062 6173 6520 6573 7469  ier as base esti
+00032cc0: 6d61 746f 722e 2e2e 2729 0a20 2020 2020  mator...').     
+00032cd0: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00032ce0: 2020 2020 2020 2020 2020 2020 2020 2073                 s
+00032cf0: 656c 662e 6261 7365 5f65 7374 696d 6174  elf.base_estimat
+00032d00: 6f72 203d 204c 4742 4d43 6c61 7373 6966  or = LGBMClassif
+00032d10: 6965 7228 6465 7669 6365 3d64 6576 6963  ier(device=devic
+00032d20: 652c 2072 616e 646f 6d5f 7374 6174 653d  e, random_state=
+00032d30: 7261 6e64 6f6d 5f73 6565 642c 206e 5f6a  random_seed, n_j
+00032d40: 6f62 733d 2d31 2c0a 2020 2020 2020 2020  obs=-1,.        
 00032d50: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00032d60: 2372 616e 646f 6d5f 7365 6564 203d 206e  #random_seed = n
-00032d70: 702e 7261 6e64 6f6d 2e72 616e 6469 6e74  p.random.randint
-00032d80: 2832 2c31 3030 290a 2020 2020 2020 2020  (2,100).        
-00032d90: 2020 2020 2020 2020 2020 2020 7261 6e64              rand
-00032da0: 6f6d 5f73 6565 6420 3d20 3939 3939 0a20  om_seed = 9999. 
-00032db0: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00032dc0: 2020 2069 6620 7365 6c66 2e62 6173 655f     if self.base_
-00032dd0: 6573 7469 6d61 746f 7220 6973 204e 6f6e  estimator is Non
-00032de0: 653a 0a20 2020 2020 2020 2020 2020 2020  e:.             
-00032df0: 2020 2020 2020 2020 2020 2069 6620 7365             if se
-00032e00: 6c66 2e6d 6178 5f6e 756d 6265 725f 6f66  lf.max_number_of
-00032e10: 5f63 6c61 7373 6573 203c 3d20 313a 0a20  _classes <= 1:. 
-00032e20: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00032e30: 2020 2020 2020 2020 2020 2023 2323 2323             #####
-00032e40: 2323 2323 2323 2323 2323 2323 2323 2323  ################
-00032e50: 2323 2323 2323 2323 2323 2323 2323 2323  ################
-00032e60: 2323 2323 2323 2323 2323 2323 2323 2323  ################
-00032e70: 2323 2323 2323 2323 230a 2020 2020 2020  #########.      
-00032e80: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00032e90: 2020 2020 2020 2323 2320 2020 5468 6973        ###   This
-00032ea0: 2069 7320 666f 7220 4269 6e61 7279 2043   is for Binary C
-00032eb0: 6c61 7373 6966 6963 6174 696f 6e20 7072  lassification pr
-00032ec0: 6f62 6c65 6d73 206f 6e6c 7920 2323 2323  oblems only ####
-00032ed0: 2323 2323 0a20 2020 2020 2020 2020 2020  ####.           
-00032ee0: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00032ef0: 2023 2323 2323 2323 2323 2323 2323 2323   ###############
-00032f00: 2323 2323 2323 2323 2323 2323 2323 2323  ################
-00032f10: 2323 2323 2323 2323 2323 2323 2323 2323  ################
-00032f20: 2323 2323 2323 2323 2323 2323 2323 230a  ###############.
-00032f30: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00032f40: 2020 2020 2020 2020 2020 2020 6966 2073              if s
-00032f50: 656c 662e 696d 6261 6c61 6e63 6564 3a0a  elf.imbalanced:.
-00032f60: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00032f70: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00032f80: 7472 793a 0a20 2020 2020 2020 2020 2020  try:.           
+00032d60: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00032d70: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00032d80: 2020 2020 7363 616c 655f 706f 735f 7765      scale_pos_we
+00032d90: 6967 6874 3d73 6361 6c65 5f70 6f73 5f77  ight=scale_pos_w
+00032da0: 6569 6768 742c 290a 2020 2020 2020 2020  eight,).        
+00032db0: 2020 2020 2020 2020 2020 2020 656c 7365              else
+00032dc0: 3a0a 2020 2020 2020 2020 2020 2020 2020  :.              
+00032dd0: 2020 2020 2020 2020 2020 2323 2320 466f            ### Fo
+00032de0: 7220 4d75 6c74 692d 636c 6173 7320 6461  r Multi-class da
+00032df0: 7461 7365 7473 2079 6f75 2063 616e 2075  tasets you can u
+00032e00: 7365 2052 6567 7265 7373 6f72 7320 666f  se Regressors fo
+00032e10: 7220 6e75 6d65 7269 6320 636c 6173 7365  r numeric classe
+00032e20: 7320 2323 2323 2323 2323 2323 2323 2323  s ##############
+00032e30: 2323 2323 2323 0a20 2020 2020 2020 2020  ######.         
+00032e40: 2020 2020 2020 2020 2020 2020 2020 2069                 i
+00032e50: 6620 7365 6c66 2e69 6d62 616c 616e 6365  f self.imbalance
+00032e60: 643a 0a20 2020 2020 2020 2020 2020 2020  d:.             
+00032e70: 2020 2020 2020 2020 2020 2020 2020 2069                 i
+00032e80: 6620 7365 6c66 2e76 6572 626f 7365 3a0a  f self.verbose:.
+00032e90: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00032ea0: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00032eb0: 7072 696e 7428 2720 2020 2053 656c 6563  print('    Selec
+00032ec0: 7469 6e67 2053 656c 6620 5061 6365 6420  ting Self Paced 
+00032ed0: 656e 7365 6d62 6c65 2063 6c61 7373 6966  ensemble classif
+00032ee0: 6965 7220 6173 2062 6173 6520 6573 7469  ier as base esti
+00032ef0: 6d61 746f 722e 2e2e 2729 0a20 2020 2020  mator...').     
+00032f00: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00032f10: 2020 2020 2020 2074 7279 3a0a 2020 2020         try:.    
+00032f20: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00032f30: 2020 2020 2020 2020 2020 2020 6672 6f6d              from
+00032f40: 2069 6d62 616c 616e 6365 645f 656e 7365   imbalanced_ense
+00032f50: 6d62 6c65 2e65 6e73 656d 626c 6520 696d  mble.ensemble im
+00032f60: 706f 7274 2053 656c 6650 6163 6564 456e  port SelfPacedEn
+00032f70: 7365 6d62 6c65 436c 6173 7369 6669 6572  sembleClassifier
+00032f80: 0a20 2020 2020 2020 2020 2020 2020 2020  .               
 00032f90: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00032fa0: 2020 2020 2020 2020 2066 726f 6d20 696d           from im
-00032fb0: 6261 6c61 6e63 6564 5f65 6e73 656d 626c  balanced_ensembl
-00032fc0: 652e 656e 7365 6d62 6c65 2069 6d70 6f72  e.ensemble impor
-00032fd0: 7420 5365 6c66 5061 6365 6445 6e73 656d  t SelfPacedEnsem
-00032fe0: 626c 6543 6c61 7373 6966 6965 720a 2020  bleClassifier.  
-00032ff0: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00032fa0: 2073 656c 662e 6261 7365 5f65 7374 696d   self.base_estim
+00032fb0: 6174 6f72 203d 2053 656c 6650 6163 6564  ator = SelfPaced
+00032fc0: 456e 7365 6d62 6c65 436c 6173 7369 6669  EnsembleClassifi
+00032fd0: 6572 286e 5f6a 6f62 733d 2d31 2c20 7261  er(n_jobs=-1, ra
+00032fe0: 6e64 6f6d 5f73 7461 7465 3d72 616e 646f  ndom_state=rando
+00032ff0: 6d5f 7365 6564 290a 2020 2020 2020 2020  m_seed).        
 00033000: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00033010: 2020 7365 6c66 2e62 6173 655f 6573 7469    self.base_esti
-00033020: 6d61 746f 7220 3d20 5365 6c66 5061 6365  mator = SelfPace
-00033030: 6445 6e73 656d 626c 6543 6c61 7373 6966  dEnsembleClassif
-00033040: 6965 7228 6e5f 6a6f 6273 3d2d 312c 2072  ier(n_jobs=-1, r
-00033050: 616e 646f 6d5f 7374 6174 653d 7261 6e64  andom_state=rand
-00033060: 6f6d 5f73 6565 6429 0a20 2020 2020 2020  om_seed).       
-00033070: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00033080: 2020 2020 2020 2020 2065 7863 6570 743a           except:
-00033090: 0a20 2020 2020 2020 2020 2020 2020 2020  .               
-000330a0: 2020 2020 2020 2020 2020 2020 2020 2020                  
-000330b0: 2020 2020 2070 7269 6e74 2827 7069 7020       print('pip 
-000330c0: 696e 7374 616c 6c20 696d 6261 6c61 6e63  install imbalanc
-000330d0: 6564 5f65 6e73 656d 626c 6520 616e 6420  ed_ensemble and 
-000330e0: 7265 2d72 756e 2074 6869 7320 6167 6169  re-run this agai
-000330f0: 6e2e 2729 0a20 2020 2020 2020 2020 2020  n.').           
+00033010: 2020 2020 6578 6365 7074 3a0a 2020 2020      except:.    
+00033020: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00033030: 2020 2020 2020 2020 2020 2020 7072 696e              prin
+00033040: 7428 2770 6970 2069 6e73 7461 6c6c 2069  t('pip install i
+00033050: 6d62 616c 616e 6365 645f 656e 7365 6d62  mbalanced_ensemb
+00033060: 6c65 2061 6e64 2072 652d 7275 6e20 7468  le and re-run th
+00033070: 6973 2061 6761 696e 2e27 290a 2020 2020  is again.').    
+00033080: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00033090: 2020 2020 2020 2020 2020 2020 7265 7475              retu
+000330a0: 726e 2073 656c 660a 2020 2020 2020 2020  rn self.        
+000330b0: 2020 2020 2020 2020 2020 2020 2020 2020                  
+000330c0: 2020 2020 7365 6c66 2e6d 6f64 656c 5f6e      self.model_n
+000330d0: 616d 6520 3d20 276f 7468 6572 270a 2020  ame = 'other'.  
+000330e0: 2020 2020 2020 2020 2020 2020 2020 2020                  
+000330f0: 2020 2020 2020 656c 7365 3a0a 2020 2020        else:.    
 00033100: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00033110: 2020 2020 2020 2020 2072 6574 7572 6e20           return 
-00033120: 7365 6c66 0a20 2020 2020 2020 2020 2020  self.           
-00033130: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00033140: 2020 2020 2073 656c 662e 6d6f 6465 6c5f       self.model_
-00033150: 6e61 6d65 203d 2027 6f74 6865 7227 0a20  name = 'other'. 
-00033160: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00033170: 2020 2020 2020 2020 2020 2065 6c73 653a             else:
-00033180: 0a20 2020 2020 2020 2020 2020 2020 2020  .               
-00033190: 2020 2020 2020 2020 2020 2020 2020 2020                  
-000331a0: 2023 2323 206d 616b 6520 6974 2061 2072   ### make it a r
-000331b0: 6567 756c 6172 2064 6963 7469 6f6e 6172  egular dictionar
-000331c0: 7920 7769 7468 2077 6569 6768 7473 2066  y with weights f
-000331d0: 6f72 2070 6f73 2061 6e64 206e 6567 2063  or pos and neg c
-000331e0: 6c61 7373 6573 2023 230a 2020 2020 2020  lasses ##.      
-000331f0: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00033200: 2020 2020 2020 2020 2020 636c 6173 735f            class_
-00033210: 7765 6967 6874 7320 3d20 6469 6374 285b  weights = dict([
-00033220: 7620 666f 7220 6b2c 7620 696e 2063 6c61  v for k,v in cla
-00033230: 7373 5f77 6569 6768 7473 2e69 7465 6d73  ss_weights.items
-00033240: 2829 5d5b 305d 290a 2020 2020 2020 2020  ()][0]).        
+00033110: 2020 2020 2020 2020 2323 2320 466f 7220          ### For 
+00033120: 6d75 6c74 692d 636c 6173 7320 7072 6f62  multi-class prob
+00033130: 6c65 6d73 2075 7365 204c 6162 656c 2050  lems use Label P
+00033140: 726f 7061 6761 7469 6f6e 2077 6869 6368  ropagation which
+00033150: 2069 7320 6661 7374 6572 2061 6e64 2062   is faster and b
+00033160: 6574 7465 7220 2323 0a20 2020 2020 2020  etter ##.       
+00033170: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00033180: 2020 2020 2069 6620 2858 2e64 7479 7065       if (X.dtype
+00033190: 733d 3d66 6c6f 6174 292e 616c 6c28 2920  s==float).all() 
+000331a0: 616e 6420 6c65 6e28 7365 6c66 2e66 6561  and len(self.fea
+000331b0: 7475 7265 7329 203c 3d20 6665 6174 7572  tures) <= featur
+000331c0: 6573 5f6c 696d 6974 3a0a 2020 2020 2020  es_limit:.      
+000331d0: 2020 2020 2020 2020 2020 2020 2020 2020                  
+000331e0: 2020 2020 2020 2020 2020 2020 2020 7072                pr
+000331f0: 696e 7428 2720 2020 2053 656c 6563 7469  int('    Selecti
+00033200: 6e67 204c 6162 656c 2050 726f 7061 6761  ng Label Propaga
+00033210: 7469 6f6e 2073 696e 6365 2069 7420 7769  tion since it wi
+00033220: 6c6c 2077 6f72 6b20 6772 6561 7420 666f  ll work great fo
+00033230: 7220 7468 6973 2064 6174 6173 6574 2e2e  r this dataset..
+00033240: 2e27 290a 2020 2020 2020 2020 2020 2020  .').            
 00033250: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00033260: 2020 2020 2020 2020 6966 2064 6174 615f          if data_
-00033270: 7361 6d70 6c65 7320 3c3d 2072 6f77 5f6c  samples <= row_l
-00033280: 696d 6974 3a0a 2020 2020 2020 2020 2020  imit:.          
-00033290: 2020 2020 2020 2020 2020 2020 2020 2020                  
-000332a0: 2020 2020 2020 2020 2020 6966 2028 582e            if (X.
-000332b0: 6474 7970 6573 3d3d 666c 6f61 7429 2e61  dtypes==float).a
-000332c0: 6c6c 2829 2061 6e64 206c 656e 2873 656c  ll() and len(sel
-000332d0: 662e 6665 6174 7572 6573 2920 3c3d 2066  f.features) <= f
-000332e0: 6561 7475 7265 735f 6c69 6d69 743a 0a20  eatures_limit:. 
-000332f0: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00033300: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00033310: 2020 2020 2020 2069 6620 7365 6c66 2e76         if self.v
-00033320: 6572 626f 7365 3a0a 2020 2020 2020 2020  erbose:.        
-00033330: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00033340: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00033350: 2020 2020 7072 696e 7428 2720 2020 2053      print('    S
-00033360: 656c 6563 7469 6e67 204c 6162 656c 2050  electing Label P
-00033370: 726f 7061 6761 7469 6f6e 2073 696e 6365  ropagation since
-00033380: 2069 7420 7769 6c6c 2077 6f72 6b20 6772   it will work gr
-00033390: 6561 7420 666f 7220 7468 6973 2064 6174  eat for this dat
-000333a0: 6173 6574 2e2e 2e27 290a 2020 2020 2020  aset...').      
-000333b0: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00033260: 2020 2020 2020 2020 7072 696e 7428 2720          print(' 
+00033270: 2020 2020 2020 2068 6f77 6576 6572 2069         however i
+00033280: 7420 7769 6c6c 2073 6b65 7720 7072 6f62  t will skew prob
+00033290: 6162 696c 6974 6965 7320 616e 6420 7368  abilities and sh
+000332a0: 6f77 206c 6f77 6572 2052 4f43 2041 5543  ow lower ROC AUC
+000332b0: 2073 636f 7265 2074 6861 6e20 6e6f 726d   score than norm
+000332c0: 616c 2e27 290a 2020 2020 2020 2020 2020  al.').          
+000332d0: 2020 2020 2020 2020 2020 2020 2020 2020                  
+000332e0: 2020 2020 2020 2020 2020 7365 6c66 2e62            self.b
+000332f0: 6173 655f 6573 7469 6d61 746f 7220 3d20  ase_estimator = 
+00033300: 204c 6162 656c 5072 6f70 6167 6174 696f   LabelPropagatio
+00033310: 6e28 290a 2020 2020 2020 2020 2020 2020  n().            
+00033320: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00033330: 2020 2020 2020 2020 7365 6c66 2e6d 6f64          self.mod
+00033340: 656c 5f6e 616d 6520 3d20 276c 7027 0a20  el_name = 'lp'. 
+00033350: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00033360: 2020 2020 2020 2020 2020 2065 6c73 653a             else:
+00033370: 0a20 2020 2020 2020 2020 2020 2020 2020  .               
+00033380: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00033390: 2069 6620 6c65 6e28 7365 6c66 2e66 6561   if len(self.fea
+000333a0: 7475 7265 7329 203c 3d20 6665 6174 7572  tures) <= featur
+000333b0: 6573 5f6c 696d 6974 3a0a 2020 2020 2020  es_limit:.      
 000333c0: 2020 2020 2020 2020 2020 2020 2020 2020                  
-000333d0: 2020 2020 2020 7072 696e 7428 2720 2020        print('   
-000333e0: 2020 2020 2068 6f77 6576 6572 2069 7420       however it 
-000333f0: 7769 6c6c 2073 6b65 7720 7072 6f62 6162  will skew probab
-00033400: 696c 6974 6965 7320 616e 6420 7368 6f77  ilities and show
-00033410: 206c 6f77 6572 2052 4f43 2041 5543 2073   lower ROC AUC s
-00033420: 636f 7265 2074 6861 6e20 6e6f 726d 616c  core than normal
-00033430: 2e27 290a 2020 2020 2020 2020 2020 2020  .').            
-00033440: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00033450: 2020 2020 2020 2020 2020 2020 7365 6c66              self
-00033460: 2e62 6173 655f 6573 7469 6d61 746f 7220  .base_estimator 
-00033470: 3d20 204c 6162 656c 5072 6f70 6167 6174  =  LabelPropagat
-00033480: 696f 6e28 290a 2020 2020 2020 2020 2020  ion().          
-00033490: 2020 2020 2020 2020 2020 2020 2020 2020                  
-000334a0: 2020 2020 2020 2020 2020 2020 2020 7365                se
-000334b0: 6c66 2e6d 6f64 656c 5f6e 616d 6520 3d20  lf.model_name = 
-000334c0: 276c 7027 0a20 2020 2020 2020 2020 2020  'lp'.           
-000334d0: 2020 2020 2020 2020 2020 2020 2020 2020                  
-000334e0: 2020 2020 2020 2020 2065 6c73 653a 0a20           else:. 
-000334f0: 2020 2020 2020 2020 2020 2020 2020 2020                  
+000333d0: 2020 2020 2020 2020 2020 2020 2020 6966                if
+000333e0: 2073 656c 662e 7665 7262 6f73 653a 0a20   self.verbose:. 
+000333f0: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00033400: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00033410: 2020 2020 2020 2070 7269 6e74 2827 2020         print('  
+00033420: 2020 5365 6c65 6374 696e 6720 4261 6767    Selecting Bagg
+00033430: 696e 6720 436c 6173 7369 6669 6572 2066  ing Classifier f
+00033440: 6f72 2074 6869 7320 6461 7461 7365 742e  or this dataset.
+00033450: 2e2e 2729 0a20 2020 2020 2020 2020 2020  ..').           
+00033460: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00033470: 2020 2020 2020 2020 2045 5420 3d20 4578           ET = Ex
+00033480: 7472 6154 7265 6543 6c61 7373 6966 6965  traTreeClassifie
+00033490: 7228 290a 2020 2020 2020 2020 2020 2020  r().            
+000334a0: 2020 2020 2020 2020 2020 2020 2020 2020                  
+000334b0: 2020 2020 2020 2020 7365 6c66 2e62 6173          self.bas
+000334c0: 655f 6573 7469 6d61 746f 7220 3d20 4261  e_estimator = Ba
+000334d0: 6767 696e 6743 6c61 7373 6966 6965 7228  ggingClassifier(
+000334e0: 6261 7365 5f65 7374 696d 6174 6f72 3d45  base_estimator=E
+000334f0: 542c 206e 5f6a 6f62 733d 2d31 290a 2020  T, n_jobs=-1).  
 00033500: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00033510: 2020 2020 2020 2069 6620 6c65 6e28 7365         if len(se
-00033520: 6c66 2e66 6561 7475 7265 7329 203c 3d20  lf.features) <= 
-00033530: 6665 6174 7572 6573 5f6c 696d 6974 3a0a  features_limit:.
+00033510: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00033520: 2020 7365 6c66 2e6d 6f64 656c 5f6e 616d    self.model_nam
+00033530: 6520 3d20 2762 6727 0a20 2020 2020 2020  e = 'bg'.       
 00033540: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00033550: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00033560: 2020 2020 2020 2020 2020 2020 6966 2073              if s
-00033570: 656c 662e 7665 7262 6f73 653a 0a20 2020  elf.verbose:.   
-00033580: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00033590: 2020 2020 2020 2020 2020 2020 2020 2020                  
-000335a0: 2020 2020 2020 2020 2020 2020 2070 7269               pri
-000335b0: 6e74 2827 2020 2020 5365 6c65 6374 696e  nt('    Selectin
-000335c0: 6720 4261 6767 696e 6720 436c 6173 7369  g Bagging Classi
-000335d0: 6669 6572 2066 6f72 2074 6869 7320 6461  fier for this da
-000335e0: 7461 7365 742e 2e2e 2729 0a20 2020 2020  taset...').     
-000335f0: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00033550: 2020 2020 2020 2020 2065 6c73 653a 0a20           else:. 
+00033560: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00033570: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00033580: 2020 2069 6620 7365 6c66 2e76 6572 626f     if self.verbo
+00033590: 7365 3a0a 2020 2020 2020 2020 2020 2020  se:.            
+000335a0: 2020 2020 2020 2020 2020 2020 2020 2020                  
+000335b0: 2020 2020 2020 2020 2020 2020 7072 696e              prin
+000335c0: 7428 2720 2020 2053 656c 6563 7469 6e67  t('    Selecting
+000335d0: 204c 4742 4d20 436c 6173 7369 6669 6572   LGBM Classifier
+000335e0: 2061 7320 6261 7365 2065 7374 696d 6174   as base estimat
+000335f0: 6f72 2e2e 2e27 290a 2020 2020 2020 2020  or...').        
 00033600: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00033610: 2020 2020 2020 2045 5420 3d20 4578 7472         ET = Extr
-00033620: 6154 7265 6543 6c61 7373 6966 6965 7228  aTreeClassifier(
-00033630: 290a 2020 2020 2020 2020 2020 2020 2020  ).              
-00033640: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00033650: 2020 2020 2020 2020 2020 2020 2020 7365                se
-00033660: 6c66 2e62 6173 655f 6573 7469 6d61 746f  lf.base_estimato
-00033670: 7220 3d20 4261 6767 696e 6743 6c61 7373  r = BaggingClass
-00033680: 6966 6965 7228 6261 7365 5f65 7374 696d  ifier(base_estim
-00033690: 6174 6f72 3d45 542c 206e 5f6a 6f62 733d  ator=ET, n_jobs=
-000336a0: 2d31 290a 2020 2020 2020 2020 2020 2020  -1).            
+00033610: 2020 2020 2020 2020 2020 2020 7365 6c66              self
+00033620: 2e62 6173 655f 6573 7469 6d61 746f 7220  .base_estimator 
+00033630: 3d20 4c47 424d 436c 6173 7369 6669 6572  = LGBMClassifier
+00033640: 2864 6576 6963 653d 6465 7669 6365 2c20  (device=device, 
+00033650: 7261 6e64 6f6d 5f73 7461 7465 3d72 616e  random_state=ran
+00033660: 646f 6d5f 7365 6564 2c0a 2020 2020 2020  dom_seed,.      
+00033670: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00033680: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00033690: 2020 2020 2020 2020 2020 2020 2020 6e5f                n_
+000336a0: 6a6f 6273 3d2d 312c 0a20 2020 2020 2020  jobs=-1,.       
 000336b0: 2020 2020 2020 2020 2020 2020 2020 2020                  
 000336c0: 2020 2020 2020 2020 2020 2020 2020 2020                  
-000336d0: 7365 6c66 2e6d 6f64 656c 5f6e 616d 6520  self.model_name 
-000336e0: 3d20 2762 6727 0a20 2020 2020 2020 2020  = 'bg'.         
-000336f0: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00033700: 2020 2020 2020 2020 2020 2020 2020 2065                 e
-00033710: 6c73 653a 0a20 2020 2020 2020 2020 2020  lse:.           
-00033720: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00033730: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00033740: 2069 6620 7365 6c66 2e76 6572 626f 7365   if self.verbose
-00033750: 3a0a 2020 2020 2020 2020 2020 2020 2020  :.              
-00033760: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00033770: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00033780: 2020 7072 696e 7428 2720 2020 2053 656c    print('    Sel
-00033790: 6563 7469 6e67 204c 4742 4d20 5265 6772  ecting LGBM Regr
-000337a0: 6573 736f 7220 6173 2062 6173 6520 6573  essor as base es
-000337b0: 7469 6d61 746f 722e 2e2e 2729 0a20 2020  timator...').   
-000337c0: 2020 2020 2020 2020 2020 2020 2020 2020                  
+000336d0: 2020 2020 2020 2020 2020 2020 2023 6973               #is
+000336e0: 5f75 6e62 616c 616e 6365 3d46 616c 7365  _unbalance=False
+000336f0: 2c0a 2020 2020 2020 2020 2020 2020 2020  ,.              
+00033700: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00033710: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00033720: 2020 2020 2020 236c 6561 726e 696e 675f        #learning_
+00033730: 7261 7465 3d30 2e33 2c0a 2020 2020 2020  rate=0.3,.      
+00033740: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00033750: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00033760: 2020 2020 2020 2020 2020 2020 2020 236d                #m
+00033770: 6178 5f64 6570 7468 3d31 302c 0a20 2020  ax_depth=10,.   
+00033780: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00033790: 2020 2020 2020 2020 2020 2020 2020 2020                  
+000337a0: 2020 2020 2020 2020 2020 2020 2020 2020                  
+000337b0: 206d 6574 7269 633d 276d 756c 7469 5f6c   metric='multi_l
+000337c0: 6f67 6c6f 7373 272c 0a20 2020 2020 2020  ogloss',.       
 000337d0: 2020 2020 2020 2020 2020 2020 2020 2020                  
-000337e0: 2020 2020 2020 2020 2073 656c 662e 6261           self.ba
-000337f0: 7365 5f65 7374 696d 6174 6f72 203d 204c  se_estimator = L
-00033800: 4742 4d43 6c61 7373 6966 6965 7228 6465  GBMClassifier(de
-00033810: 7669 6365 3d64 6576 6963 652c 2072 616e  vice=device, ran
-00033820: 646f 6d5f 7374 6174 653d 7261 6e64 6f6d  dom_state=random
-00033830: 5f73 6565 642c 0a20 2020 2020 2020 2020  _seed,.         
+000337e0: 2020 2020 2020 2020 2020 2020 2020 2020                  
+000337f0: 2020 2020 2020 2020 2020 2020 2023 6e5f               #n_
+00033800: 6573 7469 6d61 746f 7273 3d31 3330 2c20  estimators=130, 
+00033810: 6e75 6d5f 6c65 6176 6573 3d38 342c 0a20  num_leaves=84,. 
+00033820: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00033830: 2020 2020 2020 2020 2020 2020 2020 2020                  
 00033840: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00033850: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00033860: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00033870: 2020 2020 2020 636c 6173 735f 7765 6967        class_weig
-00033880: 6874 3d63 6c61 7373 5f77 6569 6768 7473  ht=class_weights
-00033890: 2c20 6e5f 6a6f 6273 3d2d 312c 0a20 2020  , n_jobs=-1,.   
+00033850: 2020 206e 756d 5f63 6c61 7373 3d6e 756d     num_class=num
+00033860: 6265 725f 6f66 5f63 6c61 7373 6573 2c20  ber_of_classes, 
+00033870: 6f62 6a65 6374 6976 653d 276d 756c 7469  objective='multi
+00033880: 636c 6173 7327 2c0a 2020 2020 2020 2020  class',.        
+00033890: 2020 2020 2020 2020 2020 2020 2020 2020                  
 000338a0: 2020 2020 2020 2020 2020 2020 2020 2020                  
-000338b0: 2020 2020 2020 2020 2020 2020 2020 2020                  
-000338c0: 2020 2020 2020 2020 2020 2020 2020 2020                  
-000338d0: 2020 2020 2020 2020 2020 2020 2029 0a20               ). 
+000338b0: 2020 2020 2020 2020 2020 2020 2362 6f6f              #boo
+000338c0: 7374 696e 675f 7479 7065 203d 2767 6f73  sting_type ='gos
+000338d0: 7327 2c20 0a20 2020 2020 2020 2020 2020  s', .           
 000338e0: 2020 2020 2020 2020 2020 2020 2020 2020                  
-000338f0: 2020 2020 2020 2020 2020 2020 2020 2065                 e
-00033900: 6c73 653a 0a20 2020 2020 2020 2020 2020  lse:.           
-00033910: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00033920: 2020 2020 2020 2020 2023 2323 2054 6869           ### Thi
-00033930: 7320 6973 2066 6f72 206c 6172 6765 2064  s is for large d
-00033940: 6174 6173 6574 7320 696e 2042 696e 6172  atasets in Binar
-00033950: 7920 636c 6173 7365 7320 2323 2323 2323  y classes ######
-00033960: 2323 2323 230a 2020 2020 2020 2020 2020  #####.          
+000338f0: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00033900: 2020 2020 2020 2020 2023 7363 616c 655f           #scale_
+00033910: 706f 735f 7765 6967 6874 3d4e 6f6e 652c  pos_weight=None,
+00033920: 0a20 2020 2020 2020 2020 2020 2020 2020  .               
+00033930: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00033940: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00033950: 2020 2020 2063 6c61 7373 5f77 6569 6768       class_weigh
+00033960: 743d 636c 6173 735f 7765 6967 6874 730a  t=class_weights.
 00033970: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00033980: 2020 2020 2020 2020 2020 6966 2073 656c            if sel
-00033990: 662e 7665 7262 6f73 653a 0a20 2020 2020  f.verbose:.     
-000339a0: 2020 2020 2020 2020 2020 2020 2020 2020                  
-000339b0: 2020 2020 2020 2020 2020 2020 2020 2020                  
-000339c0: 2020 2070 7269 6e74 2827 2020 2020 5365     print('    Se
-000339d0: 6c65 6374 696e 6720 4c47 424d 2052 6567  lecting LGBM Reg
-000339e0: 7265 7373 6f72 2061 7320 6261 7365 2065  ressor as base e
-000339f0: 7374 696d 6174 6f72 2e2e 2e27 290a 2020  stimator...').  
-00033a00: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00033a10: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00033a20: 2020 6966 2067 7075 5f65 7869 7374 733a    if gpu_exists:
-00033a30: 0a20 2020 2020 2020 2020 2020 2020 2020  .               
-00033a40: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00033a50: 2020 2020 2020 2020 2073 656c 662e 6261           self.ba
-00033a60: 7365 5f65 7374 696d 6174 6f72 203d 2058  se_estimator = X
-00033a70: 4742 436c 6173 7369 6669 6572 286e 5f65  GBClassifier(n_e
-00033a80: 7374 696d 6174 6f72 733d 3235 302c 200a  stimators=250, .
-00033a90: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00033aa0: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00033ab0: 2020 2020 2020 2020 2020 2020 6e5f 6a6f              n_jo
-00033ac0: 6273 3d2d 312c 7472 6565 5f6d 6574 686f  bs=-1,tree_metho
-00033ad0: 6420 3d20 2767 7075 5f68 6973 7427 2c67  d = 'gpu_hist',g
-00033ae0: 7075 5f69 643d 302c 2070 7265 6469 6374  pu_id=0, predict
-00033af0: 6f72 3d22 6770 755f 7072 6564 6963 746f  or="gpu_predicto
-00033b00: 7222 290a 2020 2020 2020 2020 2020 2020  r").            
-00033b10: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00033b20: 2020 2020 2020 2020 656c 7365 3a0a 2020          else:.  
-00033b30: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00033980: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00033990: 2020 2020 2020 2020 2020 2020 2020 2020                  
+000339a0: 2020 2020 290a 2020 2020 2020 2020 2020      ).          
+000339b0: 2020 2020 2020 656c 7365 3a0a 2020 2020        else:.    
+000339c0: 2020 2020 2020 2020 2020 2020 2020 2020                  
+000339d0: 2323 2320 466f 7220 6c61 7267 6520 6461  ### For large da
+000339e0: 7461 7365 7473 2075 7365 204c 4742 4d20  tasets use LGBM 
+000339f0: 6f72 2052 6567 7265 7373 6f72 7320 6173  or Regressors as
+00033a00: 2077 656c 6c20 2323 2323 2323 2323 2323   well ##########
+00033a10: 2323 2323 2323 2323 2323 2323 2323 0a20  ##############. 
+00033a20: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00033a30: 2020 2069 6620 6e75 6d62 6572 5f6f 665f     if number_of_
+00033a40: 636c 6173 7365 7320 3c3d 2031 3a0a 2020  classes <= 1:.  
+00033a50: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00033a60: 2020 2020 2020 6966 2073 656c 662e 696d        if self.im
+00033a70: 6261 6c61 6e63 6564 3a0a 2020 2020 2020  balanced:.      
+00033a80: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00033a90: 2020 2020 2020 6966 2073 656c 662e 7665        if self.ve
+00033aa0: 7262 6f73 653a 0a20 2020 2020 2020 2020  rbose:.         
+00033ab0: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00033ac0: 2020 2020 2020 2070 7269 6e74 2827 2020         print('  
+00033ad0: 2020 5365 6c65 6374 696e 6720 5365 6c66    Selecting Self
+00033ae0: 2050 6163 6564 2065 6e73 656d 626c 6520   Paced ensemble 
+00033af0: 636c 6173 7369 6669 6572 2061 7320 6261  classifier as ba
+00033b00: 7365 2065 7374 696d 6174 6f72 2e2e 2e27  se estimator...'
+00033b10: 290a 2020 2020 2020 2020 2020 2020 2020  ).              
+00033b20: 2020 2020 2020 2020 2020 2020 2020 7472                tr
+00033b30: 793a 0a20 2020 2020 2020 2020 2020 2020  y:.             
 00033b40: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00033b50: 2020 2020 2020 7365 6c66 2e62 6173 655f        self.base_
-00033b60: 6573 7469 6d61 746f 7220 3d20 4c47 424d  estimator = LGBM
-00033b70: 436c 6173 7369 6669 6572 2864 6576 6963  Classifier(devic
-00033b80: 653d 6465 7669 6365 2c20 7261 6e64 6f6d  e=device, random
-00033b90: 5f73 7461 7465 3d72 616e 646f 6d5f 7365  _state=random_se
-00033ba0: 6564 2c20 0a20 2020 2020 2020 2020 2020  ed, .           
-00033bb0: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00033bc0: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00033bd0: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00033be0: 206e 5f6a 6f62 733d 2d31 2c0a 2020 2020   n_jobs=-1,.    
-00033bf0: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00033c00: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00033b50: 2020 2066 726f 6d20 696d 6261 6c61 6e63     from imbalanc
+00033b60: 6564 5f65 6e73 656d 626c 652e 656e 7365  ed_ensemble.ense
+00033b70: 6d62 6c65 2069 6d70 6f72 7420 5365 6c66  mble import Self
+00033b80: 5061 6365 6445 6e73 656d 626c 6543 6c61  PacedEnsembleCla
+00033b90: 7373 6966 6965 720a 2020 2020 2020 2020  ssifier.        
+00033ba0: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00033bb0: 2020 2020 2020 2020 7365 6c66 2e62 6173          self.bas
+00033bc0: 655f 6573 7469 6d61 746f 7220 3d20 5365  e_estimator = Se
+00033bd0: 6c66 5061 6365 6445 6e73 656d 626c 6543  lfPacedEnsembleC
+00033be0: 6c61 7373 6966 6965 7228 6e5f 6a6f 6273  lassifier(n_jobs
+00033bf0: 3d2d 312c 2072 616e 646f 6d5f 7374 6174  =-1, random_stat
+00033c00: 653d 7261 6e64 6f6d 5f73 6565 6429 0a20  e=random_seed). 
 00033c10: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00033c20: 2020 2020 2020 2020 2369 735f 756e 6261          #is_unba
-00033c30: 6c61 6e63 653d 5472 7565 2c20 0a20 2020  lance=True, .   
+00033c20: 2020 2020 2020 2020 2020 2065 7863 6570             excep
+00033c30: 743a 0a20 2020 2020 2020 2020 2020 2020  t:.             
 00033c40: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00033c50: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00033c60: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00033c70: 2020 2020 2020 2020 2023 6d61 785f 6465           #max_de
-00033c80: 7074 683d 3130 2c20 6d65 7472 6963 3d6d  pth=10, metric=m
-00033c90: 6574 7269 632c 0a20 2020 2020 2020 2020  etric,.         
+00033c50: 2020 2070 7269 6e74 2827 7069 7020 696e     print('pip in
+00033c60: 7374 616c 6c20 696d 6261 6c61 6e63 6564  stall imbalanced
+00033c70: 5f65 6e73 656d 626c 6520 616e 6420 7265  _ensemble and re
+00033c80: 2d72 756e 2074 6869 7320 6167 6169 6e2e  -run this again.
+00033c90: 2729 0a20 2020 2020 2020 2020 2020 2020  ').             
 00033ca0: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00033cb0: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00033cb0: 2020 2072 6574 7572 6e20 7365 6c66 0a20     return self. 
 00033cc0: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00033cd0: 2020 2023 6e75 6d5f 636c 6173 733d 7365     #num_class=se
-00033ce0: 6c66 2e6d 6178 5f6e 756d 6265 725f 6f66  lf.max_number_of
-00033cf0: 5f63 6c61 7373 6573 2c0a 2020 2020 2020  _classes,.      
-00033d00: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00033d10: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00033d20: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00033d30: 2020 2020 2020 236e 5f65 7374 696d 6174        #n_estimat
-00033d40: 6f72 733d 3130 302c 2020 6e75 6d5f 6c65  ors=100,  num_le
-00033d50: 6176 6573 3d38 342c 200a 2020 2020 2020  aves=84, .      
-00033d60: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00033d70: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00033d80: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00033d90: 2020 2020 2020 236f 626a 6563 7469 7665        #objective
-00033da0: 3d27 6269 6e61 7279 272c 0a20 2020 2020  ='binary',.     
-00033db0: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00033dc0: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00033dd0: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00033de0: 2020 2020 2020 2023 626f 6f73 7469 6e67         #boosting
-00033df0: 5f74 7970 6520 3d27 676f 7373 272c 200a  _type ='goss', .
-00033e00: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00033cd0: 2020 2020 2020 2020 2020 2073 656c 662e             self.
+00033ce0: 6d6f 6465 6c5f 6e61 6d65 203d 2027 6f74  model_name = 'ot
+00033cf0: 6865 7227 0a20 2020 2020 2020 2020 2020  her'.           
+00033d00: 2020 2020 2020 2020 2020 2020 2065 6c73               els
+00033d10: 653a 0a20 2020 2020 2020 2020 2020 2020  e:.             
+00033d20: 2020 2020 2020 2020 2020 2020 2020 2069                 i
+00033d30: 6620 7365 6c66 2e76 6572 626f 7365 3a0a  f self.verbose:.
+00033d40: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00033d50: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00033d60: 7072 696e 7428 2720 2020 2053 656c 6563  print('    Selec
+00033d70: 7469 6e67 204c 4742 4d20 436c 6173 7369  ting LGBM Classi
+00033d80: 6669 6572 2066 6f72 2074 6869 7320 6461  fier for this da
+00033d90: 7461 7365 742e 2e2e 2729 0a20 2020 2020  taset...').     
+00033da0: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00033db0: 2020 2020 2020 2023 7365 6c66 2e62 6173         #self.bas
+00033dc0: 655f 6573 7469 6d61 746f 7220 3d20 4c47  e_estimator = LG
+00033dd0: 424d 436c 6173 7369 6669 6572 286e 5f65  BMClassifier(n_e
+00033de0: 7374 696d 6174 6f72 733d 3235 302c 2072  stimators=250, r
+00033df0: 616e 646f 6d5f 7374 6174 653d 7261 6e64  andom_state=rand
+00033e00: 6f6d 5f73 6565 642c 200a 2020 2020 2020  om_seed, .      
 00033e10: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00033e20: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00033e30: 2020 2020 2020 2020 2020 2020 2373 6361              #sca
-00033e40: 6c65 5f70 6f73 5f77 6569 6768 743d 7363  le_pos_weight=sc
-00033e50: 616c 655f 706f 735f 7765 6967 6874 2c0a  ale_pos_weight,.
-00033e60: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00033e20: 2020 2020 2020 2320 2020 2020 2020 2020        #         
+00033e30: 2020 2062 6f6f 7374 696e 675f 7479 7065     boosting_type
+00033e40: 203d 2767 6f73 7327 2c20 7363 616c 655f   ='goss', scale_
+00033e50: 706f 735f 7765 6967 6874 3d73 6361 6c65  pos_weight=scale
+00033e60: 5f70 6f73 5f77 6569 6768 7429 0a20 2020  _pos_weight).   
 00033e70: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00033e80: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00033e90: 2020 2020 2020 2020 2020 2063 6c61 7373             class
-00033ea0: 5f77 6569 6768 743d 636c 6173 735f 7765  _weight=class_we
-00033eb0: 6967 6874 732c 0a20 2020 2020 2020 2020  ights,.         
-00033ec0: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00033ed0: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00033e80: 2020 2020 2020 2020 2073 656c 662e 6261           self.ba
+00033e90: 7365 5f65 7374 696d 6174 6f72 203d 204c  se_estimator = L
+00033ea0: 4742 4d43 6c61 7373 6966 6965 7228 6465  GBMClassifier(de
+00033eb0: 7669 6365 3d64 6576 6963 652c 2072 616e  vice=device, ran
+00033ec0: 646f 6d5f 7374 6174 653d 7261 6e64 6f6d  dom_state=random
+00033ed0: 5f73 6565 642c 0a20 2020 2020 2020 2020  _seed,.         
 00033ee0: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00033ef0: 2020 2029 0a20 2020 2020 2020 2020 2020     ).           
-00033f00: 2020 2020 2020 2020 2020 2020 2065 6c73               els
-00033f10: 653a 0a20 2020 2020 2020 2020 2020 2020  e:.             
-00033f20: 2020 2020 2020 2020 2020 2020 2020 2023                 #
-00033f30: 2323 2323 2323 2323 2323 2323 2323 2323  ################
-00033f40: 2323 2323 2323 2323 2323 2323 2323 2323  ################
-00033f50: 2323 2323 2323 2323 2323 2323 2323 2323  ################
-00033f60: 2323 2323 2323 2323 2323 2323 0a20 2020  ############.   
+00033ef0: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00033f00: 2020 2020 2020 2020 2020 206e 5f6a 6f62             n_job
+00033f10: 733d 2d31 2c0a 2020 2020 2020 2020 2020  s=-1,.          
+00033f20: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00033f30: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00033f40: 2020 2020 2020 2020 2020 2369 735f 756e            #is_un
+00033f50: 6261 6c61 6e63 653d 5472 7565 2c0a 2020  balance=True,.  
+00033f60: 2020 2020 2020 2020 2020 2020 2020 2020                  
 00033f70: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00033f80: 2020 2020 2020 2020 2023 2323 2020 2054           ###   T
-00033f90: 6869 7320 6973 2066 6f72 204d 756c 7469  his is for Multi
-00033fa0: 2043 6c61 7373 6966 6963 6174 696f 6e20   Classification 
-00033fb0: 7072 6f62 6c65 6d73 206f 6e6c 7920 2323  problems only ##
-00033fc0: 2323 2323 2323 0a20 2020 2020 2020 2020  ######.         
-00033fd0: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00033fe0: 2020 2023 2323 204d 616b 6520 7375 7265     ### Make sure
-00033ff0: 2079 6f75 2064 6f6e 2774 2070 7574 2061   you don't put a
-00034000: 6e79 2063 6c61 7373 2077 6569 6768 7473  ny class weights
-00034010: 2068 6572 6520 7369 6e63 6520 6974 2077   here since it w
-00034020: 6f6e 2774 2077 6f72 6b20 696e 206d 756c  on't work in mul
-00034030: 7469 2d6c 6162 656c 7320 2323 0a20 2020  ti-labels ##.   
+00033f80: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00033f90: 2020 236c 6561 726e 696e 675f 7261 7465    #learning_rate
+00033fa0: 3d30 2e33 2c20 0a20 2020 2020 2020 2020  =0.3, .         
+00033fb0: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00033fc0: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00033fd0: 2020 2020 2020 2020 2020 2023 6d61 785f             #max_
+00033fe0: 6465 7074 683d 3130 2c20 0a20 2020 2020  depth=10, .     
+00033ff0: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00034000: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00034010: 2020 2020 2020 2020 2020 2020 2020 2023                 #
+00034020: 6d65 7472 6963 3d6d 6574 7269 632c 0a20  metric=metric,. 
+00034030: 2020 2020 2020 2020 2020 2020 2020 2020                  
 00034040: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00034050: 2020 2020 2020 2020 2023 2323 2323 2323           #######
-00034060: 2323 2323 2323 2323 2323 2323 2323 2323  ################
-00034070: 2323 2323 2323 2323 2323 2323 2323 2323  ################
-00034080: 2323 2323 2323 2323 2323 2323 2323 2323  ################
-00034090: 2323 2323 2323 230a 2020 2020 2020 2020  #######.        
+00034050: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00034060: 2020 2023 6e5f 6573 7469 6d61 746f 7273     #n_estimators
+00034070: 3d32 3330 2c20 6e75 6d5f 6c65 6176 6573  =230, num_leaves
+00034080: 3d38 342c 200a 2020 2020 2020 2020 2020  =84, .          
+00034090: 2020 2020 2020 2020 2020 2020 2020 2020                  
 000340a0: 2020 2020 2020 2020 2020 2020 2020 2020                  
-000340b0: 2020 2020 6966 2073 656c 662e 696d 6261      if self.imba
-000340c0: 6c61 6e63 6564 3a0a 2020 2020 2020 2020  lanced:.        
-000340d0: 2020 2020 2020 2020 2020 2020 2020 2020                  
-000340e0: 2020 2020 2020 2020 6966 2073 656c 662e          if self.
-000340f0: 7665 7262 6f73 653a 0a20 2020 2020 2020  verbose:.       
-00034100: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00034110: 2020 2020 2020 2020 2020 2020 2070 7269               pri
-00034120: 6e74 2827 2020 2020 5365 6c65 6374 696e  nt('    Selectin
-00034130: 6720 5365 6c66 2050 6163 6564 2065 6e73  g Self Paced ens
-00034140: 656d 626c 6520 636c 6173 7369 6669 6572  emble classifier
-00034150: 2073 696e 6365 2069 6d62 616c 616e 6365   since imbalance
-00034160: 6420 666c 6167 2069 7320 7365 742e 2e2e  d flag is set...
-00034170: 2729 0a20 2020 2020 2020 2020 2020 2020  ').             
+000340b0: 2020 2020 2020 2020 2020 236e 756d 5f63            #num_c
+000340c0: 6c61 7373 3d6e 756d 6265 725f 6f66 5f63  lass=number_of_c
+000340d0: 6c61 7373 6573 2c0a 2020 2020 2020 2020  lasses,.        
+000340e0: 2020 2020 2020 2020 2020 2020 2020 2020                  
+000340f0: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00034100: 2020 2020 2020 2020 2020 2020 236f 626a              #obj
+00034110: 6563 7469 7665 3d27 6269 6e61 7279 272c  ective='binary',
+00034120: 0a20 2020 2020 2020 2020 2020 2020 2020  .               
+00034130: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00034140: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00034150: 2020 2020 2023 626f 6f73 7469 6e67 5f74       #boosting_t
+00034160: 7970 6520 3d27 676f 7373 272c 200a 2020  ype ='goss', .  
+00034170: 2020 2020 2020 2020 2020 2020 2020 2020                  
 00034180: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00034190: 2020 2074 7279 3a0a 2020 2020 2020 2020     try:.        
-000341a0: 2020 2020 2020 2020 2020 2020 2020 2020                  
-000341b0: 2020 2020 2020 2020 2020 2020 6672 6f6d              from
-000341c0: 2069 6d62 616c 616e 6365 645f 656e 7365   imbalanced_ense
-000341d0: 6d62 6c65 2e65 6e73 656d 626c 6520 696d  mble.ensemble im
-000341e0: 706f 7274 2053 656c 6650 6163 6564 456e  port SelfPacedEn
-000341f0: 7365 6d62 6c65 436c 6173 7369 6669 6572  sembleClassifier
-00034200: 0a20 2020 2020 2020 2020 2020 2020 2020  .               
-00034210: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00034220: 2020 2020 2073 656c 662e 6261 7365 5f65       self.base_e
-00034230: 7374 696d 6174 6f72 203d 2053 656c 6650  stimator = SelfP
-00034240: 6163 6564 456e 7365 6d62 6c65 436c 6173  acedEnsembleClas
-00034250: 7369 6669 6572 286e 5f6a 6f62 733d 2d31  sifier(n_jobs=-1
-00034260: 2c20 7261 6e64 6f6d 5f73 7461 7465 3d72  , random_state=r
-00034270: 616e 646f 6d5f 7365 6564 290a 2020 2020  andom_seed).    
-00034280: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00034290: 2020 2020 2020 2020 2020 2020 6578 6365              exce
-000342a0: 7074 3a0a 2020 2020 2020 2020 2020 2020  pt:.            
-000342b0: 2020 2020 2020 2020 2020 2020 2020 2020                  
-000342c0: 2020 2020 2020 2020 7072 696e 7428 2770          print('p
-000342d0: 6970 2069 6e73 7461 6c6c 2069 6d62 616c  ip install imbal
-000342e0: 616e 6365 645f 656e 7365 6d62 6c65 2061  anced_ensemble a
-000342f0: 6e64 2072 652d 7275 6e20 7468 6973 2061  nd re-run this a
-00034300: 6761 696e 2e27 290a 2020 2020 2020 2020  gain.').        
-00034310: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00034320: 2020 2020 2020 2020 2020 2020 7265 7475              retu
-00034330: 726e 2073 656c 660a 2020 2020 2020 2020  rn self.        
-00034340: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00034350: 2020 2020 2020 2020 7365 6c66 2e6d 6f64          self.mod
-00034360: 656c 5f6e 616d 6520 3d20 276f 7468 6572  el_name = 'other
-00034370: 270a 2020 2020 2020 2020 2020 2020 2020  '.              
-00034380: 2020 2020 2020 2020 2020 2020 2020 656c                el
-00034390: 7365 3a0a 2020 2020 2020 2020 2020 2020  se:.            
-000343a0: 2020 2020 2020 2020 2020 2020 2020 2020                  
-000343b0: 2020 2020 6966 2064 6174 615f 7361 6d70      if data_samp
-000343c0: 6c65 7320 3c3d 2072 6f77 5f6c 696d 6974  les <= row_limit
-000343d0: 3a0a 2020 2020 2020 2020 2020 2020 2020  :.              
+00034190: 2020 2020 2020 2020 2020 2020 2020 2020                  
+000341a0: 2020 7363 616c 655f 706f 735f 7765 6967    scale_pos_weig
+000341b0: 6874 3d73 6361 6c65 5f70 6f73 5f77 6569  ht=scale_pos_wei
+000341c0: 6768 740a 2020 2020 2020 2020 2020 2020  ght.            
+000341d0: 2020 2020 2020 2020 2020 2020 2020 2020                  
+000341e0: 2020 2020 2020 2020 2020 2020 2020 2020                  
+000341f0: 2020 2020 2020 2020 290a 2020 2020 2020          ).      
+00034200: 2020 2020 2020 2020 2020 2020 2020 656c                el
+00034210: 7365 3a0a 2020 2020 2020 2020 2020 2020  se:.            
+00034220: 2020 2020 2020 2020 2020 2020 2323 2320              ### 
+00034230: 466f 7220 4d75 6c74 692d 636c 6173 7320  For Multi-class 
+00034240: 6461 7461 7365 7473 2079 6f75 2063 616e  datasets you can
+00034250: 2075 7365 2052 6567 7265 7373 6f72 7320   use Regressors 
+00034260: 666f 7220 6e75 6d65 7269 6320 636c 6173  for numeric clas
+00034270: 7365 7320 2323 2323 2323 2323 2323 2323  ses ############
+00034280: 2323 2323 2323 2323 0a20 2020 2020 2020  ########.       
+00034290: 2020 2020 2020 2020 2020 2020 2020 2020                  
+000342a0: 2069 6620 7365 6c66 2e69 6d62 616c 616e   if self.imbalan
+000342b0: 6365 643a 0a20 2020 2020 2020 2020 2020  ced:.           
+000342c0: 2020 2020 2020 2020 2020 2020 2020 2020                  
+000342d0: 2069 6620 7365 6c66 2e76 6572 626f 7365   if self.verbose
+000342e0: 3a0a 2020 2020 2020 2020 2020 2020 2020  :.              
+000342f0: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00034300: 2020 7072 696e 7428 2720 2020 2053 656c    print('    Sel
+00034310: 6563 7469 6e67 2053 656c 6620 5061 6365  ecting Self Pace
+00034320: 6420 656e 7365 6d62 6c65 2063 6c61 7373  d ensemble class
+00034330: 6966 6965 7220 6173 2062 6173 6520 6573  ifier as base es
+00034340: 7469 6d61 746f 722e 2e2e 2729 0a20 2020  timator...').   
+00034350: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00034360: 2020 2020 2020 2020 2074 7279 3a0a 2020           try:.  
+00034370: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00034380: 2020 2020 2020 2020 2020 2020 2020 6672                fr
+00034390: 6f6d 2069 6d62 616c 616e 6365 645f 656e  om imbalanced_en
+000343a0: 7365 6d62 6c65 2e65 6e73 656d 626c 6520  semble.ensemble 
+000343b0: 696d 706f 7274 2053 656c 6650 6163 6564  import SelfPaced
+000343c0: 456e 7365 6d62 6c65 436c 6173 7369 6669  EnsembleClassifi
+000343d0: 6572 0a20 2020 2020 2020 2020 2020 2020  er.             
 000343e0: 2020 2020 2020 2020 2020 2020 2020 2020                  
-000343f0: 2020 2020 2020 6966 206c 656e 2873 656c        if len(sel
-00034400: 662e 6665 6174 7572 6573 2920 3c3d 2066  f.features) <= f
-00034410: 6561 7475 7265 735f 6c69 6d69 743a 0a20  eatures_limit:. 
-00034420: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00034430: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00034440: 2020 2020 2020 2069 6620 7365 6c66 2e76         if self.v
-00034450: 6572 626f 7365 3a0a 2020 2020 2020 2020  erbose:.        
-00034460: 2020 2020 2020 2020 2020 2020 2020 2020                  
+000343f0: 2020 2073 656c 662e 6261 7365 5f65 7374     self.base_est
+00034400: 696d 6174 6f72 203d 2053 656c 6650 6163  imator = SelfPac
+00034410: 6564 456e 7365 6d62 6c65 436c 6173 7369  edEnsembleClassi
+00034420: 6669 6572 286e 5f6a 6f62 733d 2d31 2c20  fier(n_jobs=-1, 
+00034430: 7261 6e64 6f6d 5f73 7461 7465 3d72 616e  random_state=ran
+00034440: 646f 6d5f 7365 6564 290a 2020 2020 2020  dom_seed).      
+00034450: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00034460: 2020 2020 2020 6578 6365 7074 3a0a 2020        except:.  
 00034470: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00034480: 2020 2020 7072 696e 7428 2720 2020 2053      print('    S
-00034490: 656c 6563 7469 6e67 2045 7874 7261 2054  electing Extra T
-000344a0: 7265 6573 2043 6c61 7373 6966 6965 7220  rees Classifier 
-000344b0: 666f 7220 736d 616c 6c20 6461 7461 7365  for small datase
-000344c0: 7473 2e2e 2e27 290a 2020 2020 2020 2020  ts...').        
+00034480: 2020 2020 2020 2020 2020 2020 2020 7072                pr
+00034490: 696e 7428 2770 6970 2069 6e73 7461 6c6c  int('pip install
+000344a0: 2069 6d62 616c 616e 6365 645f 656e 7365   imbalanced_ense
+000344b0: 6d62 6c65 2061 6e64 2072 652d 7275 6e20  mble and re-run 
+000344c0: 7468 6973 2061 6761 696e 2e27 290a 2020  this again.').  
 000344d0: 2020 2020 2020 2020 2020 2020 2020 2020                  
-000344e0: 2020 2020 2020 2020 2020 2020 2020 2020                  
-000344f0: 7365 6c66 2e62 6173 655f 6573 7469 6d61  self.base_estima
-00034500: 746f 7220 3d20 4578 7472 6154 7265 6573  tor = ExtraTrees
-00034510: 436c 6173 7369 6669 6572 2872 616e 646f  Classifier(rando
-00034520: 6d5f 7374 6174 653d 7261 6e64 6f6d 5f73  m_state=random_s
-00034530: 6565 6429 0a20 2020 2020 2020 2020 2020  eed).           
-00034540: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00034550: 2020 2020 2020 2020 2020 2020 2073 656c               sel
-00034560: 662e 6d6f 6465 6c5f 6e61 6d65 203d 2027  f.model_name = '
-00034570: 7266 270a 2020 2020 2020 2020 2020 2020  rf'.            
+000344e0: 2020 2020 2020 2020 2020 2020 2020 7265                re
+000344f0: 7475 726e 2073 656c 660a 2020 2020 2020  turn self.      
+00034500: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00034510: 2020 2020 2020 7365 6c66 2e6d 6f64 656c        self.model
+00034520: 5f6e 616d 6520 3d20 276f 7468 6572 270a  _name = 'other'.
+00034530: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00034540: 2020 2020 2020 2020 656c 7365 3a0a 2020          else:.  
+00034550: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00034560: 2020 2020 2020 2020 2020 2369 6620 7365            #if se
+00034570: 6c66 2e77 6569 6768 7473 3a0a 2020 2020  lf.weights:.    
 00034580: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00034590: 2020 2020 2020 2020 656c 7365 3a0a 2020          else:.  
-000345a0: 2020 2020 2020 2020 2020 2020 2020 2020                  
-000345b0: 2020 2020 2020 2020 2020 2020 2020 2020                  
-000345c0: 2020 2020 2020 7365 6c66 2e62 6173 655f        self.base_
-000345d0: 6573 7469 6d61 746f 7220 3d20 4c47 424d  estimator = LGBM
-000345e0: 5265 6772 6573 736f 7228 6e5f 6a6f 6273  Regressor(n_jobs
-000345f0: 3d2d 312c 2064 6576 6963 653d 6465 7669  =-1, device=devi
-00034600: 6365 2c20 7261 6e64 6f6d 5f73 7461 7465  ce, random_state
-00034610: 3d72 616e 646f 6d5f 7365 6564 2920 2020  =random_seed)   
-00034620: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00034630: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00034640: 200a 2020 2020 2020 2020 2020 2020 2020   .              
-00034650: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00034660: 2020 656c 7365 3a0a 2020 2020 2020 2020    else:.        
-00034670: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00034680: 2020 2020 2020 2020 2020 2020 6966 2028              if (
-00034690: 582e 6474 7970 6573 3d3d 666c 6f61 7429  X.dtypes==float)
-000346a0: 2e61 6c6c 2829 2061 6e64 206c 656e 2873  .all() and len(s
-000346b0: 656c 662e 6665 6174 7572 6573 2920 3c3d  elf.features) <=
-000346c0: 2066 6561 7475 7265 735f 6c69 6d69 743a   features_limit:
-000346d0: 0a20 2020 2020 2020 2020 2020 2020 2020  .               
-000346e0: 2020 2020 2020 2020 2020 2020 2020 2020                  
-000346f0: 2020 2020 2020 2020 2070 7269 6e74 2827           print('
-00034700: 2020 2020 5365 6c65 6374 696e 6720 4c61      Selecting La
-00034710: 6265 6c20 5072 6f70 6167 6174 696f 6e20  bel Propagation 
-00034720: 7369 6e63 6520 6974 2077 6f72 6b73 2067  since it works g
-00034730: 7265 6174 2066 6f72 206d 756c 7469 636c  reat for multicl
-00034740: 6173 7320 7072 6f62 6c65 6d73 2e2e 2e27  ass problems...'
-00034750: 290a 2020 2020 2020 2020 2020 2020 2020  ).              
+00034590: 2020 2020 2020 2020 2320 2020 2063 6c61          #    cla
+000345a0: 7373 5f77 6569 6768 7473 203d 204e 6f6e  ss_weights = Non
+000345b0: 650a 2020 2020 2020 2020 2020 2020 2020  e.              
+000345c0: 2020 2020 2020 2020 2020 2020 2020 6966                if
+000345d0: 2073 656c 662e 7665 7262 6f73 653a 0a20   self.verbose:. 
+000345e0: 2020 2020 2020 2020 2020 2020 2020 2020                  
+000345f0: 2020 2020 2020 2020 2020 2020 2020 2070                 p
+00034600: 7269 6e74 2827 2020 2020 5365 6c65 6374  rint('    Select
+00034610: 696e 6720 4c47 424d 2043 6c61 7373 6966  ing LGBM Classif
+00034620: 6965 7220 6173 2062 6173 6520 6573 7469  ier as base esti
+00034630: 6d61 746f 722e 2e2e 2729 0a20 2020 2020  mator...').     
+00034640: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00034650: 2020 2020 2020 2073 656c 662e 6261 7365         self.base
+00034660: 5f65 7374 696d 6174 6f72 203d 204c 4742  _estimator = LGB
+00034670: 4d43 6c61 7373 6966 6965 7228 6465 7669  MClassifier(devi
+00034680: 6365 3d64 6576 6963 652c 2072 616e 646f  ce=device, rando
+00034690: 6d5f 7374 6174 653d 7261 6e64 6f6d 5f73  m_state=random_s
+000346a0: 6565 642c 0a20 2020 2020 2020 2020 2020  eed,.           
+000346b0: 2020 2020 2020 2020 2020 2020 2020 2020                  
+000346c0: 2020 2020 2020 2020 2020 2020 2020 2020                  
+000346d0: 2020 2020 2020 2020 206e 5f6a 6f62 733d           n_jobs=
+000346e0: 2d31 2c0a 2020 2020 2020 2020 2020 2020  -1,.            
+000346f0: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00034700: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00034710: 2020 2020 2020 2020 2369 735f 756e 6261          #is_unba
+00034720: 6c61 6e63 653d 4661 6c73 652c 206c 6561  lance=False, lea
+00034730: 726e 696e 675f 7261 7465 3d30 2e33 2c0a  rning_rate=0.3,.
+00034740: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00034750: 2020 2020 2020 2020 2020 2020 2020 2020                  
 00034760: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00034770: 2020 2020 2020 2020 2020 7072 696e 7428            print(
-00034780: 2720 2020 2020 2020 2068 6f77 6576 6572  '        however
-00034790: 2069 7420 7769 6c6c 2073 6b65 7720 7072   it will skew pr
-000347a0: 6f62 6162 696c 6974 6965 7320 6120 6c69  obabilities a li
-000347b0: 7474 6c65 2073 6f20 6265 2061 7761 7265  ttle so be aware
-000347c0: 206f 6620 7468 6973 2729 0a20 2020 2020   of this').     
+00034770: 2020 2020 236d 6178 5f64 6570 7468 3d31      #max_depth=1
+00034780: 302c 200a 2020 2020 2020 2020 2020 2020  0, .            
+00034790: 2020 2020 2020 2020 2020 2020 2020 2020                  
+000347a0: 2020 2020 2020 2020 2020 2020 2020 2020                  
+000347b0: 2020 2020 2020 2020 6d65 7472 6963 3d27          metric='
+000347c0: 6d75 6c74 695f 6c6f 676c 6f73 7327 2c0a  multi_logloss',.
 000347d0: 2020 2020 2020 2020 2020 2020 2020 2020                  
 000347e0: 2020 2020 2020 2020 2020 2020 2020 2020                  
-000347f0: 2020 2073 656c 662e 6261 7365 5f65 7374     self.base_est
-00034800: 696d 6174 6f72 203d 2020 4c61 6265 6c50  imator =  LabelP
-00034810: 726f 7061 6761 7469 6f6e 2829 0a20 2020  ropagation().   
-00034820: 2020 2020 2020 2020 2020 2020 2020 2020                  
+000347f0: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00034800: 2020 2020 236e 5f65 7374 696d 6174 6f72      #n_estimator
+00034810: 733d 3233 302c 206e 756d 5f6c 6561 7665  s=230, num_leave
+00034820: 733d 3834 2c0a 2020 2020 2020 2020 2020  s=84,.          
 00034830: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00034840: 2020 2020 2073 656c 662e 6d6f 6465 6c5f       self.model_
-00034850: 6e61 6d65 203d 2027 6c70 270a 2020 2020  name = 'lp'.    
-00034860: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00034870: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00034880: 656c 7365 3a0a 2020 2020 2020 2020 2020  else:.          
+00034840: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00034850: 2020 2020 2020 2020 2020 6e75 6d5f 636c            num_cl
+00034860: 6173 733d 6e75 6d62 6572 5f6f 665f 636c  ass=number_of_cl
+00034870: 6173 7365 732c 206f 626a 6563 7469 7665  asses, objective
+00034880: 3d27 6d75 6c74 6963 6c61 7373 272c 0a20  ='multiclass',. 
 00034890: 2020 2020 2020 2020 2020 2020 2020 2020                  
-000348a0: 2020 2020 2020 2020 2020 2020 2020 7365                se
-000348b0: 6c66 2e62 6173 655f 6573 7469 6d61 746f  lf.base_estimato
-000348c0: 7220 3d20 4c47 424d 436c 6173 7369 6669  r = LGBMClassifi
-000348d0: 6572 286e 5f6a 6f62 733d 2d31 2c20 6465  er(n_jobs=-1, de
-000348e0: 7669 6365 3d64 6576 6963 652c 2072 616e  vice=device, ran
-000348f0: 646f 6d5f 7374 6174 653d 7261 6e64 6f6d  dom_state=random
-00034900: 5f73 6565 6429 0a20 2020 2020 2020 2020  _seed).         
-00034910: 2020 2020 2020 2020 2020 2065 6c73 653a             else:
-00034920: 0a20 2020 2020 2020 2020 2020 2020 2020  .               
-00034930: 2020 2020 2020 2020 2073 656c 662e 6d6f           self.mo
-00034940: 6465 6c5f 6e61 6d65 203d 3d20 276f 7468  del_name == 'oth
-00034950: 6572 270a 2020 2020 2020 2020 2020 2020  er'.            
-00034960: 2020 2020 2020 2020 2323 2320 4e6f 7720          ### Now 
-00034970: 7072 696e 7420 4c47 424d 2069 6620 6170  print LGBM if ap
-00034980: 7072 6f70 7269 6174 6520 2323 2323 2323  propriate ######
-00034990: 230a 2020 2020 2020 2020 2020 2020 2020  #.              
-000349a0: 2020 2020 2020 6966 2073 656c 662e 7665        if self.ve
-000349b0: 7262 6f73 6520 616e 6420 7365 6c66 2e6d  rbose and self.m
-000349c0: 6f64 656c 5f6e 616d 653d 3d27 6c67 6227  odel_name=='lgb'
-000349d0: 3a0a 2020 2020 2020 2020 2020 2020 2020  :.              
-000349e0: 2020 2020 2020 2020 2020 7072 696e 7428            print(
-000349f0: 2720 2020 2053 656c 6563 7469 6e67 204c  '    Selecting L
-00034a00: 4742 4d20 436c 6173 7369 6669 6572 2061  GBM Classifier a
-00034a10: 7320 6261 7365 2065 7374 696d 6174 6f72  s base estimator
-00034a20: 2e2e 2e27 290a 2020 2020 2020 2020 2020  ...').          
-00034a30: 2020 2020 2020 2020 2020 2320 5370 6c69            # Spli
-00034a40: 7420 6461 7461 2069 6e74 6f20 7472 6169  t data into trai
-00034a50: 6e20 616e 6420 7465 7374 2062 6173 6564  n and test based
-00034a60: 206f 6e20 666f 6c64 7320 2020 2020 2020   on folds       
-00034a70: 2020 200a 2020 2020 2020 2020 2020 2020     .            
-00034a80: 2020 2020 2020 2020 6966 2069 7369 6e73          if isins
-00034a90: 7461 6e63 6528 792c 2070 642e 5365 7269  tance(y, pd.Seri
-00034aa0: 6573 2920 6f72 2069 7369 6e73 7461 6e63  es) or isinstanc
-00034ab0: 6528 792c 2070 642e 4461 7461 4672 616d  e(y, pd.DataFram
-00034ac0: 6529 3a0a 2020 2020 2020 2020 2020 2020  e):.            
-00034ad0: 2020 2020 2020 2020 2020 2020 795f 7472              y_tr
-00034ae0: 6169 6e2c 2079 5f74 6573 7420 3d20 792e  ain, y_test = y.
-00034af0: 696c 6f63 5b74 7261 696e 5f69 6e64 6578  iloc[train_index
-00034b00: 5d2c 2079 2e69 6c6f 635b 7465 7374 5f69  ], y.iloc[test_i
-00034b10: 6e64 6578 5d20 2020 2020 2020 2020 2020  ndex]           
-00034b20: 2020 2020 200a 2020 2020 2020 2020 2020       .          
-00034b30: 2020 2020 2020 2020 2020 656c 7365 3a0a            else:.
-00034b40: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00034b50: 2020 2020 2020 2020 795f 7472 6169 6e2c          y_train,
-00034b60: 2079 5f74 6573 7420 3d20 795b 7472 6169   y_test = y[trai
-00034b70: 6e5f 696e 6465 785d 2c20 795b 7465 7374  n_index], y[test
-00034b80: 5f69 6e64 6578 5d0a 0a20 2020 2020 2020  _index]..       
-00034b90: 2020 2020 2020 2020 2020 2020 2069 6620               if 
-00034ba0: 6973 696e 7374 616e 6365 2858 2c20 7064  isinstance(X, pd
-00034bb0: 2e44 6174 6146 7261 6d65 293a 0a20 2020  .DataFrame):.   
-00034bc0: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00034bd0: 2020 2020 2078 5f74 7261 696e 2c20 785f       x_train, x_
-00034be0: 7465 7374 203d 2058 2e69 6c6f 635b 7472  test = X.iloc[tr
-00034bf0: 6169 6e5f 696e 6465 785d 2c20 582e 696c  ain_index], X.il
-00034c00: 6f63 5b74 6573 745f 696e 6465 785d 0a20  oc[test_index]. 
-00034c10: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00034c20: 2020 2065 6c73 653a 0a20 2020 2020 2020     else:.       
-00034c30: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00034c40: 2078 5f74 7261 696e 2c20 785f 7465 7374   x_train, x_test
-00034c50: 203d 2058 5b74 7261 696e 5f69 6e64 6578   = X[train_index
-00034c60: 5d2c 2058 5b74 6573 745f 696e 6465 785d  ], X[test_index]
-00034c70: 0a0a 2020 2020 2020 2020 2020 2020 2020  ..              
-00034c80: 2020 2020 2020 2323 2323 2323 2044 6f20        ###### Do 
-00034c90: 7468 6973 206f 6e6c 7920 7468 6520 6669  this only the fi
-00034ca0: 7273 7420 7469 6d65 2023 2323 2323 2323  rst time #######
-00034cb0: 2323 2323 2323 2323 2323 2323 2323 2323  ################
-00034cc0: 2323 2323 2323 2323 2323 2323 2323 2323  ################
-00034cd0: 2323 2323 2323 2323 230a 2020 2020 2020  #########.      
-00034ce0: 2020 2020 2020 2020 2020 2020 2020 6966                if
-00034cf0: 2069 203d 3d20 303a 0a20 2020 2020 2020   i == 0:.       
-00034d00: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00034d10: 2023 2323 2049 7420 646f 6573 206e 6f74   ### It does not
-00034d20: 206d 616b 6520 7365 6e73 6520 746f 2064   make sense to d
-00034d30: 6f20 6879 7065 722d 7061 7261 6d20 7475  o hyper-param tu
-00034d40: 6e69 6e67 2066 6f72 206d 756c 7469 2d6c  ning for multi-l
-00034d50: 6162 656c 206d 6f64 656c 7320 2323 0a20  abel models ##. 
-00034d60: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00034d70: 2020 2020 2020 2023 2323 2020 2020 7369         ###    si
-00034d80: 6e63 6520 436c 6173 7369 6669 6572 4368  nce ClassifierCh
-00034d90: 6169 6e73 2064 6f20 6e6f 7420 6861 7665  ains do not have
-00034da0: 206d 616e 7920 6879 7065 7220 7061 7261   many hyper para
-00034db0: 6d73 2023 2323 2323 2323 2323 2323 2323  ms #############
-00034dc0: 2323 2323 0a20 2020 2020 2020 2020 2020  ####.           
-00034dd0: 2020 2020 2020 2020 2020 2020 2023 7365               #se
-00034de0: 6c66 2e62 6173 655f 6573 7469 6d61 746f  lf.base_estimato
-00034df0: 7220 3d20 7261 6e64 5f73 6561 7263 6828  r = rand_search(
-00034e00: 7365 6c66 2e62 6173 655f 6573 7469 6d61  self.base_estima
-00034e10: 746f 722c 2078 5f74 7261 696e 2c20 795f  tor, x_train, y_
-00034e20: 7472 6169 6e2c 200a 2020 2020 2020 2020  train, .        
+000348a0: 2020 2020 2020 2020 2020 2020 2020 2020                  
+000348b0: 2020 2020 2020 2020 2020 2020 2020 2020                  
+000348c0: 2020 2023 626f 6f73 7469 6e67 5f74 7970     #boosting_typ
+000348d0: 6520 3d27 676f 7373 272c 200a 2020 2020  e ='goss', .    
+000348e0: 2020 2020 2020 2020 2020 2020 2020 2020                  
+000348f0: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00034900: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00034910: 7363 616c 655f 706f 735f 7765 6967 6874  scale_pos_weight
+00034920: 3d4e 6f6e 652c 0a20 2020 2020 2020 2020  =None,.         
+00034930: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00034940: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00034950: 2020 2020 2020 2020 2020 2063 6c61 7373             class
+00034960: 5f77 6569 6768 743d 636c 6173 735f 7765  _weight=class_we
+00034970: 6967 6874 730a 2020 2020 2020 2020 2020  ights.          
+00034980: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00034990: 2020 2020 2020 2020 2020 2020 2020 2020                  
+000349a0: 2020 2020 2020 2020 2020 290a 2020 2020            ).    
+000349b0: 2020 2020 2020 2020 656c 7365 3a0a 2020          else:.  
+000349c0: 2020 2020 2020 2020 2020 2020 2020 7365                se
+000349d0: 6c66 2e6d 6f64 656c 5f6e 616d 6520 3d20  lf.model_name = 
+000349e0: 276f 7468 6572 270a 0a0a 2020 2020 2020  'other'...      
+000349f0: 2020 2020 2020 2320 5370 6c69 7420 6461        # Split da
+00034a00: 7461 2069 6e74 6f20 7472 6169 6e20 616e  ta into train an
+00034a10: 6420 7465 7374 2062 6173 6564 206f 6e20  d test based on 
+00034a20: 666f 6c64 7320 2020 2020 2020 2020 200a  folds          .
+00034a30: 2020 2020 2020 2020 2020 2020 6966 2069              if i
+00034a40: 7369 6e73 7461 6e63 6528 792c 2070 642e  sinstance(y, pd.
+00034a50: 5365 7269 6573 2920 6f72 2069 7369 6e73  Series) or isins
+00034a60: 7461 6e63 6528 792c 2070 642e 4461 7461  tance(y, pd.Data
+00034a70: 4672 616d 6529 3a0a 2020 2020 2020 2020  Frame):.        
+00034a80: 2020 2020 2020 2020 795f 7472 6169 6e2c          y_train,
+00034a90: 2079 5f74 6573 7420 3d20 792e 696c 6f63   y_test = y.iloc
+00034aa0: 5b74 7261 696e 5f69 6e64 6578 5d2c 2079  [train_index], y
+00034ab0: 2e69 6c6f 635b 7465 7374 5f69 6e64 6578  .iloc[test_index
+00034ac0: 5d20 2020 2020 2020 2020 2020 2020 2020  ]               
+00034ad0: 200a 2020 2020 2020 2020 2020 2020 656c   .            el
+00034ae0: 7365 3a0a 2020 2020 2020 2020 2020 2020  se:.            
+00034af0: 2020 2020 795f 7472 6169 6e2c 2079 5f74      y_train, y_t
+00034b00: 6573 7420 3d20 795b 7472 6169 6e5f 696e  est = y[train_in
+00034b10: 6465 785d 2c20 795b 7465 7374 5f69 6e64  dex], y[test_ind
+00034b20: 6578 5d0a 0a20 2020 2020 2020 2020 2020  ex]..           
+00034b30: 2069 6620 6973 696e 7374 616e 6365 2858   if isinstance(X
+00034b40: 2c20 7064 2e44 6174 6146 7261 6d65 293a  , pd.DataFrame):
+00034b50: 0a20 2020 2020 2020 2020 2020 2020 2020  .               
+00034b60: 2078 5f74 7261 696e 2c20 785f 7465 7374   x_train, x_test
+00034b70: 203d 2058 2e69 6c6f 635b 7472 6169 6e5f   = X.iloc[train_
+00034b80: 696e 6465 785d 2c20 582e 696c 6f63 5b74  index], X.iloc[t
+00034b90: 6573 745f 696e 6465 785d 0a20 2020 2020  est_index].     
+00034ba0: 2020 2020 2020 2065 6c73 653a 0a20 2020         else:.   
+00034bb0: 2020 2020 2020 2020 2020 2020 2078 5f74               x_t
+00034bc0: 7261 696e 2c20 785f 7465 7374 203d 2058  rain, x_test = X
+00034bd0: 5b74 7261 696e 5f69 6e64 6578 5d2c 2058  [train_index], X
+00034be0: 5b74 6573 745f 696e 6465 785d 0a0a 2020  [test_index]..  
+00034bf0: 2020 2020 2020 2020 2020 0a20 2020 2020            .     
+00034c00: 2020 2020 2020 2023 2320 2020 736d 616c         ##   smal
+00034c10: 6c20 6461 7461 7365 7473 2070 726f 6365  l datasets proce
+00034c20: 7373 696e 6720 2323 2323 230a 2020 2020  ssing #####.    
+00034c30: 2020 2020 2020 2020 6966 2069 203d 3d20          if i == 
+00034c40: 303a 0a20 2020 2020 2020 2020 2020 2020  0:.             
+00034c50: 2020 2069 6620 7365 6c66 2e70 6970 656c     if self.pipel
+00034c60: 696e 653a 0a20 2020 2020 2020 2020 2020  ine:.           
+00034c70: 2020 2020 2020 2020 2023 2054 7261 696e           # Train
+00034c80: 206d 6f64 656c 2061 6e64 2075 7365 2069   model and use i
+00034c90: 7420 696e 2061 2070 6970 656c 696e 6520  t in a pipeline 
+00034ca0: 746f 2074 7261 696e 206f 6e20 7468 6520  to train on the 
+00034cb0: 666f 6c64 2020 2323 0a20 2020 2020 2020  fold  ##.       
+00034cc0: 2020 2020 2020 2020 2020 2020 2070 6970               pip
+00034cd0: 6520 3d20 5069 7065 6c69 6e65 280a 2020  e = Pipeline(.  
+00034ce0: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00034cf0: 2020 2020 2020 7374 6570 733d 5b28 2270        steps=[("p
+00034d00: 7265 7072 6f63 6573 736f 7222 2c20 7072  reprocessor", pr
+00034d10: 6570 726f 6365 7373 6f72 292c 2028 226d  eprocessor), ("m
+00034d20: 6f64 656c 222c 2073 656c 662e 6261 7365  odel", self.base
+00034d30: 5f65 7374 696d 6174 6f72 295d 290a 2020  _estimator)]).  
+00034d40: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00034d50: 2020 6966 2073 656c 662e 6d6f 6465 6c5f    if self.model_
+00034d60: 6e61 6d65 203d 3d20 276f 7468 6572 273a  name == 'other':
+00034d70: 0a20 2020 2020 2020 2020 2020 2020 2020  .               
+00034d80: 2020 2020 2020 2020 2070 7269 6e74 2827           print('
+00034d90: 4e6f 2048 5054 2074 756e 696e 6720 7065  No HPT tuning pe
+00034da0: 7266 6f72 6d65 6420 7369 6e63 6520 6261  rformed since ba
+00034db0: 7365 2065 7374 696d 6174 6f72 2069 7320  se estimator is 
+00034dc0: 6769 7665 6e20 6279 2069 6e70 7574 2e2e  given by input..
+00034dd0: 2e27 290a 2020 2020 2020 2020 2020 2020  .').            
+00034de0: 2020 2020 2020 2020 2020 2020 7365 6c66              self
+00034df0: 2e62 6173 655f 6573 7469 6d61 746f 7220  .base_estimator 
+00034e00: 3d20 636f 7079 2e64 6565 7063 6f70 7928  = copy.deepcopy(
+00034e10: 7069 7065 290a 2020 2020 2020 2020 2020  pipe).          
+00034e20: 2020 2020 2020 2020 2020 656c 7365 3a0a            else:.
 00034e30: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00034e40: 2320 2020 2020 2020 2020 2020 2020 2020  #               
-00034e50: 2020 2020 2020 2020 2073 656c 662e 6d6f           self.mo
-00034e60: 6465 6c5f 6e61 6d65 2c20 7665 7262 6f73  del_name, verbos
-00034e70: 653d 7365 6c66 2e76 6572 626f 7365 290a  e=self.verbose).
-00034e80: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00034e90: 2020 2020 2020 2020 2370 7269 6e74 2827          #print('
-00034ea0: 2020 2020 6879 7065 7220 7475 6e65 6420      hyper tuned 
-00034eb0: 6261 7365 2065 7374 696d 6174 6f72 203d  base estimator =
-00034ec0: 2025 7327 2025 7365 6c66 2e62 6173 655f   %s' %self.base_
-00034ed0: 6573 7469 6d61 746f 7229 0a20 2020 2020  estimator).     
+00034e40: 2020 2020 2020 2020 6966 206c 656e 2873          if len(s
+00034e50: 656c 662e 6665 6174 7572 6573 2920 3c3d  elf.features) <=
+00034e60: 2066 6561 7475 7265 735f 6c69 6d69 743a   features_limit:
+00034e70: 0a20 2020 2020 2020 2020 2020 2020 2020  .               
+00034e80: 2020 2020 2020 2020 2020 2020 2073 656c               sel
+00034e90: 662e 6261 7365 5f65 7374 696d 6174 6f72  f.base_estimator
+00034ea0: 203d 2072 616e 645f 7365 6172 6368 2870   = rand_search(p
+00034eb0: 6970 652c 2078 5f74 7261 696e 2c20 795f  ipe, x_train, y_
+00034ec0: 7472 6169 6e2c 200a 2020 2020 2020 2020  train, .        
+00034ed0: 2020 2020 2020 2020 2020 2020 2020 2020                  
 00034ee0: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00034ef0: 2020 2069 6620 7365 6c66 2e6d 6178 5f6e     if self.max_n
-00034f00: 756d 6265 725f 6f66 5f63 6c61 7373 6573  umber_of_classes
-00034f10: 203c 3d20 313a 0a20 2020 2020 2020 2020   <= 1:.         
-00034f20: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00034f30: 2020 2065 7374 5f6c 6973 7420 3d20 5b43     est_list = [C
-00034f40: 6c61 7373 6966 6965 7243 6861 696e 2873  lassifierChain(s
-00034f50: 656c 662e 6261 7365 5f65 7374 696d 6174  elf.base_estimat
-00034f60: 6f72 2c20 6f72 6465 723d 4e6f 6e65 2c20  or, order=None, 
-00034f70: 6376 3d33 2c20 7261 6e64 6f6d 5f73 7461  cv=3, random_sta
-00034f80: 7465 3d69 2920 0a20 2020 2020 2020 2020  te=i) .         
-00034f90: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00034fa0: 2020 2020 2020 2020 2020 2020 2020 2066                 f
-00034fb0: 6f72 2069 2069 6e20 7261 6e67 6528 6e75  or i in range(nu
-00034fc0: 6d5f 6974 6572 6174 696f 6e73 295d 200a  m_iterations)] .
-00034fd0: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00034fe0: 2020 2020 2020 2020 2020 2020 6966 2073              if s
-00034ff0: 656c 662e 7665 7262 6f73 653a 0a20 2020  elf.verbose:.   
-00035000: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00035010: 2020 2020 2020 2020 2020 2020 2070 7269               pri
-00035020: 6e74 2827 4669 7474 696e 6720 6120 2573  nt('Fitting a %s
-00035030: 2066 6f72 2025 7320 7461 7267 6574 7320   for %s targets 
-00035040: 7769 7468 204d 756c 7469 4f75 7470 7574  with MultiOutput
-00035050: 436c 6173 7369 6669 6572 2e20 5468 6973  Classifier. This
-00035060: 2077 696c 6c20 7461 6b65 2074 696d 652e   will take time.
-00035070: 2e2e 2720 2528 0a20 2020 2020 2020 2020  ..' %(.         
-00035080: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00034ef0: 2020 2020 2020 2020 2020 2020 7365 6c66              self
+00034f00: 2e6d 6f64 656c 5f6e 616d 652c 2073 656c  .model_name, sel
+00034f10: 662e 7069 7065 6c69 6e65 2c20 7363 6f72  f.pipeline, scor
+00034f20: 696e 672c 2076 6572 626f 7365 3d73 656c  ing, verbose=sel
+00034f30: 662e 7665 7262 6f73 6529 0a20 2020 2020  f.verbose).     
+00034f40: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00034f50: 2020 2065 6c73 653a 0a20 2020 2020 2020     else:.       
+00034f60: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00034f70: 2020 2020 2070 7269 6e74 2827 4e6f 2048       print('No H
+00034f80: 5054 2074 756e 696e 6720 7065 7266 6f72  PT tuning perfor
+00034f90: 6d65 6420 7369 6e63 6520 6e75 6d62 6572  med since number
+00034fa0: 206f 6620 6665 6174 7572 6573 2069 7320   of features is 
+00034fb0: 746f 6f20 6c61 7267 652e 2e2e 2729 0a20  too large...'). 
+00034fc0: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00034fd0: 2020 2020 2020 2020 2020 2073 656c 662e             self.
+00034fe0: 6261 7365 5f65 7374 696d 6174 6f72 203d  base_estimator =
+00034ff0: 2063 6f70 792e 6465 6570 636f 7079 2870   copy.deepcopy(p
+00035000: 6970 6529 0a20 2020 2020 2020 2020 2020  ipe).           
+00035010: 2020 2020 2065 6c73 653a 0a20 2020 2020       else:.     
+00035020: 2020 2020 2020 2020 2020 2020 2020 2023                 #
+00035030: 2323 2054 6869 7320 6973 2066 6f72 2077  ## This is for w
+00035040: 6974 686f 7574 2061 2070 6970 656c 696e  ithout a pipelin
+00035050: 6520 2323 2323 2323 230a 2020 2020 2020  e #######.      
+00035060: 2020 2020 2020 2020 2020 2020 2020 6966                if
+00035070: 2073 656c 662e 6d6f 6465 6c5f 6e61 6d65   self.model_name
+00035080: 203d 3d20 276f 7468 6572 273a 0a20 2020   == 'other':.   
 00035090: 2020 2020 2020 2020 2020 2020 2020 2020                  
-000350a0: 2020 2073 7472 2873 656c 662e 6261 7365     str(self.base
-000350b0: 5f65 7374 696d 6174 6f72 292e 7370 6c69  _estimator).spli
-000350c0: 7428 2228 2229 5b30 5d2c 792e 7368 6170  t("(")[0],y.shap
-000350d0: 655b 315d 2929 0a20 2020 2020 2020 2020  e[1])).         
-000350e0: 2020 2020 2020 2020 2020 2020 2020 2065                 e
-000350f0: 6c73 653a 0a20 2020 2020 2020 2020 2020  lse:.           
-00035100: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00035110: 2069 6620 7365 6c66 2e69 6d62 616c 616e   if self.imbalan
-00035120: 6365 643a 0a20 2020 2020 2020 2020 2020  ced:.           
+000350a0: 2020 2020 2023 2323 206c 6561 7665 2074       ### leave t
+000350b0: 6865 2062 6173 6520 6573 7469 6d61 746f  he base estimato
+000350c0: 7220 6173 2069 7320 2323 230a 2020 2020  r as is ###.    
+000350d0: 2020 2020 2020 2020 2020 2020 2020 2020                  
+000350e0: 2020 2020 7072 696e 7428 274e 6f20 4850      print('No HP
+000350f0: 5420 7475 6e69 6e67 2070 6572 666f 726d  T tuning perform
+00035100: 6564 2073 696e 6365 2062 6173 6520 6573  ed since base es
+00035110: 7469 6d61 746f 7220 6973 2067 6976 656e  timator is given
+00035120: 2062 7920 696e 7075 742e 2e2e 2729 0a20   by input...'). 
 00035130: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00035140: 2020 2020 2069 6620 7365 6c66 2e76 6572       if self.ver
-00035150: 626f 7365 3a0a 2020 2020 2020 2020 2020  bose:.          
-00035160: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00035170: 2020 2020 2020 2020 2020 7072 696e 7428            print(
-00035180: 2720 2020 2054 7261 696e 696e 6720 7769  '    Training wi
-00035190: 7468 2043 6c61 7373 6966 6965 7243 6861  th ClassifierCha
-000351a0: 696e 2073 696e 6365 206d 756c 7469 5f6c  in since multi_l
-000351b0: 6162 656c 2064 6174 6173 6574 2e20 5468  abel dataset. Th
-000351c0: 6973 2077 696c 6c20 7461 6b65 2074 696d  is will take tim
-000351d0: 652e 2e2e 2729 0a20 2020 2020 2020 2020  e...').         
-000351e0: 2020 2020 2020 2020 2020 2020 2020 2020                  
-000351f0: 2020 2020 2020 2065 7374 5f6c 6973 7420         est_list 
-00035200: 3d20 5b43 6c61 7373 6966 6965 7243 6861  = [ClassifierCha
-00035210: 696e 2873 656c 662e 6261 7365 5f65 7374  in(self.base_est
-00035220: 696d 6174 6f72 2c20 6f72 6465 723d 4e6f  imator, order=No
-00035230: 6e65 2c20 7261 6e64 6f6d 5f73 7461 7465  ne, random_state
-00035240: 3d69 290a 2020 2020 2020 2020 2020 2020  =i).            
-00035250: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00035260: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00035270: 666f 7220 6920 696e 2072 616e 6765 286e  for i in range(n
-00035280: 756d 5f69 7465 7261 7469 6f6e 7329 5d20  um_iterations)] 
-00035290: 0a20 2020 2020 2020 2020 2020 2020 2020  .               
-000352a0: 2020 2020 2020 2020 2020 2020 2065 6c73               els
-000352b0: 653a 0a20 2020 2020 2020 2020 2020 2020  e:.             
+00035140: 2020 2065 6c73 653a 0a20 2020 2020 2020     else:.       
+00035150: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00035160: 2069 6620 6c65 6e28 7365 6c66 2e66 6561   if len(self.fea
+00035170: 7475 7265 7329 203c 3d20 6665 6174 7572  tures) <= featur
+00035180: 6573 5f6c 696d 6974 3a0a 2020 2020 2020  es_limit:.      
+00035190: 2020 2020 2020 2020 2020 2020 2020 2020                  
+000351a0: 2020 2020 2020 2323 2320 6c65 6176 6520        ### leave 
+000351b0: 7468 6520 6261 7365 2065 7374 696d 6174  the base estimat
+000351c0: 6f72 2061 7320 6973 2023 2323 0a20 2020  or as is ###.   
+000351d0: 2020 2020 2020 2020 2020 2020 2020 2020                  
+000351e0: 2020 2020 2020 2020 2073 656c 662e 6261           self.ba
+000351f0: 7365 5f65 7374 696d 6174 6f72 203d 2072  se_estimator = r
+00035200: 616e 645f 7365 6172 6368 2873 656c 662e  and_search(self.
+00035210: 6261 7365 5f65 7374 696d 6174 6f72 2c20  base_estimator, 
+00035220: 785f 7472 6169 6e2c 200a 2020 2020 2020  x_train, .      
+00035230: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00035240: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00035250: 2020 2020 2020 2020 2020 795f 7472 6169            y_trai
+00035260: 6e2c 2073 656c 662e 6d6f 6465 6c5f 6e61  n, self.model_na
+00035270: 6d65 2c20 7365 6c66 2e70 6970 656c 696e  me, self.pipelin
+00035280: 652c 2073 636f 7269 6e67 2c20 7665 7262  e, scoring, verb
+00035290: 6f73 653d 7365 6c66 2e76 6572 626f 7365  ose=self.verbose
+000352a0: 290a 2020 2020 2020 2020 2020 2020 2020  ).              
+000352b0: 2020 2020 2020 2020 2020 656c 7365 3a0a            else:.
 000352c0: 2020 2020 2020 2020 2020 2020 2020 2020                  
-000352d0: 2020 2023 2323 2059 6f75 206d 7573 7420     ### You must 
-000352e0: 7573 6520 6d75 6c74 696f 7574 7075 7463  use multioutputc
-000352f0: 6c61 7373 6966 6965 7220 7369 6e63 6520  lassifier since 
-00035300: 6974 2069 7320 7468 6520 6f6e 6c79 206f  it is the only o
-00035310: 6e65 2070 7265 6469 6374 7320 7072 6f62  ne predicts prob
-00035320: 6173 2063 6f72 7265 6374 6c79 2023 230a  as correctly ##.
-00035330: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00035340: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00035350: 6573 745f 6c69 7374 203d 205b 4d75 6c74  est_list = [Mult
-00035360: 694f 7574 7075 7443 6c61 7373 6966 6965  iOutputClassifie
-00035370: 7228 7365 6c66 2e62 6173 655f 6573 7469  r(self.base_esti
-00035380: 6d61 746f 7229 232c 206f 7264 6572 3d22  mator)#, order="
-00035390: 7261 6e64 6f6d 222c 2072 616e 646f 6d5f  random", random_
-000353a0: 7374 6174 653d 6929 200a 2020 2020 2020  state=i) .      
-000353b0: 2020 2020 2020 2020 2020 2020 2020 2020                  
-000353c0: 2020 2020 2020 2020 2020 2020 2020 2020                  
-000353d0: 2020 2020 2020 666f 7220 6920 696e 2072        for i in r
-000353e0: 616e 6765 286e 756d 5f69 7465 7261 7469  ange(num_iterati
-000353f0: 6f6e 7329 5d20 0a20 2020 2020 2020 2020  ons)] .         
-00035400: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00035410: 2020 2020 2020 2069 6620 7365 6c66 2e76         if self.v
-00035420: 6572 626f 7365 3a0a 2020 2020 2020 2020  erbose:.        
-00035430: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00035440: 2020 2020 2020 2020 2020 2020 7072 696e              prin
-00035450: 7428 2754 7261 696e 696e 6720 6120 2573  t('Training a %s
-00035460: 2066 6f72 2025 7320 7461 7267 6574 7320   for %s targets 
-00035470: 7769 7468 204d 756c 7469 4f75 7470 7574  with MultiOutput
-00035480: 436c 6173 7369 6669 6572 2e20 5468 6973  Classifier. This
-00035490: 2077 696c 6c20 7461 6b65 2074 696d 652e   will take time.
-000354a0: 2e2e 2720 2528 0a20 2020 2020 2020 2020  ..' %(.         
-000354b0: 2020 2020 2020 2020 2020 2020 2020 2020                  
-000354c0: 2020 2020 2020 2020 2020 2020 2020 2020                  
-000354d0: 2020 2020 2020 2073 7472 2873 656c 662e         str(self.
-000354e0: 6261 7365 5f65 7374 696d 6174 6f72 292e  base_estimator).
-000354f0: 7370 6c69 7428 2228 2229 5b30 5d2c 792e  split("(")[0],y.
-00035500: 7368 6170 655b 315d 2929 0a0a 2020 2020  shape[1]))..    
-00035510: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00035520: 2320 496e 6974 6961 6c69 7a65 206d 6f64  # Initialize mod
-00035530: 656c 2077 6974 6820 796f 7572 2073 7570  el with your sup
-00035540: 6572 7669 7365 6420 616c 676f 7269 7468  ervised algorith
-00035550: 6d20 6f66 2063 686f 6963 650a 2020 2020  m of choice.    
-00035560: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00035570: 6d6f 6465 6c20 3d20 6573 745f 6c69 7374  model = est_list
-00035580: 5b69 5d0a 0a20 2020 2020 2020 2020 2020  [i]..           
-00035590: 2020 2020 2020 2020 2023 2054 7261 696e           # Train
-000355a0: 206d 6f64 656c 2061 6e64 2075 7365 2069   model and use i
-000355b0: 7420 746f 2074 7261 696e 206f 6e20 7468  t to train on th
-000355c0: 6520 666f 6c64 0a20 2020 2020 2020 2020  e fold.         
-000355d0: 2020 2020 2020 2020 2020 2069 6620 7365             if se
-000355e0: 6c66 2e70 6970 656c 696e 653a 0a20 2020  lf.pipeline:.   
-000355f0: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00035600: 2020 2020 2023 2323 2054 6869 7320 6973       ### This is
-00035610: 206f 6e6c 7920 7769 7468 2061 2070 6970   only with a pip
-00035620: 656c 696e 6520 2323 2323 2323 2323 0a20  eline ########. 
+000352d0: 2020 2020 2020 2020 2020 2020 7072 696e              prin
+000352e0: 7428 274e 6f20 4850 5420 7475 6e69 6e67  t('No HPT tuning
+000352f0: 2070 6572 666f 726d 6564 2073 696e 6365   performed since
+00035300: 206e 756d 6265 7220 6f66 2066 6561 7475   number of featu
+00035310: 7265 7320 6973 2074 6f6f 206c 6172 6765  res is too large
+00035320: 2e2e 2e27 290a 0a20 2020 2020 2020 2020  ...')..         
+00035330: 2020 2020 2020 2065 7374 5f6c 6973 7420         est_list 
+00035340: 3d20 6e75 6d5f 6974 6572 6174 696f 6e73  = num_iterations
+00035350: 2a5b 7365 6c66 2e62 6173 655f 6573 7469  *[self.base_esti
+00035360: 6d61 746f 725d 0a20 2020 2020 2020 2020  mator].         
+00035370: 2020 2020 2020 2023 7072 696e 7428 2720         #print(' 
+00035380: 2020 2062 6173 6520 6573 7469 6d61 746f     base estimato
+00035390: 7220 3d20 2573 2720 2573 656c 662e 6261  r = %s' %self.ba
+000353a0: 7365 5f65 7374 696d 6174 6f72 290a 2020  se_estimator).  
+000353b0: 2020 2020 2020 2020 2020 0a20 2020 2020            .     
+000353c0: 2020 2020 2020 2023 2049 6e69 7469 616c         # Initial
+000353d0: 697a 6520 6d6f 6465 6c20 7769 7468 2079  ize model with y
+000353e0: 6f75 7220 7375 7065 7276 6973 6564 2061  our supervised a
+000353f0: 6c67 6f72 6974 686d 206f 6620 6368 6f69  lgorithm of choi
+00035400: 6365 0a20 2020 2020 2020 2020 2020 206d  ce.            m
+00035410: 6f64 656c 203d 2065 7374 5f6c 6973 745b  odel = est_list[
+00035420: 695d 0a20 2020 2020 2020 2020 2020 200a  i].            .
+00035430: 2020 2020 2020 2020 2020 2020 6d6f 6465              mode
+00035440: 6c2e 6669 7428 785f 7472 6169 6e2c 2079  l.fit(x_train, y
+00035450: 5f74 7261 696e 290a 2020 2020 2020 2020  _train).        
+00035460: 2020 2020 7365 6c66 2e6d 6f64 656c 732e      self.models.
+00035470: 6170 7065 6e64 286d 6f64 656c 290a 2020  append(model).  
+00035480: 2020 2020 2020 2020 2020 0a20 2020 2020            .     
+00035490: 2020 2020 2020 2023 2050 7265 6469 6374         # Predict
+000354a0: 206f 6e20 7265 6d61 696e 696e 6720 6461   on remaining da
+000354b0: 7461 206f 6620 6561 6368 2066 6f6c 640a  ta of each fold.
+000354c0: 2020 2020 2020 2020 2020 2020 7072 6564              pred
+000354d0: 7320 3d20 6d6f 6465 6c2e 7072 6564 6963  s = model.predic
+000354e0: 7428 785f 7465 7374 290a 0a20 2020 2020  t(x_test)..     
+000354f0: 2020 2020 2020 2023 2055 7365 2062 6573         # Use bes
+00035500: 7420 636c 6173 7369 6669 6361 7469 6f6e  t classification
+00035510: 206d 6574 7269 6320 746f 206d 6561 7375   metric to measu
+00035520: 7265 2070 6572 666f 726d 616e 6365 206f  re performance o
+00035530: 6620 6d6f 6465 6c0a 0a20 2020 2020 2020  f model..       
+00035540: 2020 2020 2069 6620 7365 6c66 2e69 6d62       if self.imb
+00035550: 616c 616e 6365 643a 0a20 2020 2020 2020  alanced:.       
+00035560: 2020 2020 2020 2020 2023 2323 2055 7365           ### Use
+00035570: 2052 6567 7265 7373 696f 6e20 7072 6564   Regression pred
+00035580: 6963 7469 6f6e 7320 616e 6420 636f 6e76  ictions and conv
+00035590: 6572 7420 7468 656d 2069 6e74 6f20 636c  ert them into cl
+000355a0: 6173 7365 7320 6865 7265 2023 230a 2020  asses here ##.  
+000355b0: 2020 2020 2020 2020 2020 2020 2020 7363                sc
+000355c0: 6f72 6520 3d20 7072 696e 745f 7375 6c6f  ore = print_sulo
+000355d0: 5f61 6363 7572 6163 7928 795f 7465 7374  _accuracy(y_test
+000355e0: 2c20 7072 6564 732c 2079 5f70 726f 6261  , preds, y_proba
+000355f0: 733d 2222 2c20 7665 7262 6f73 653d 7365  s="", verbose=se
+00035600: 6c66 2e76 6572 626f 7365 290a 2020 2020  lf.verbose).    
+00035610: 2020 2020 2020 2020 2020 2020 6966 2073              if s
+00035620: 656c 662e 7665 7262 6f73 653a 0a20 2020  elf.verbose:.   
 00035630: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00035640: 2020 2020 2020 2070 6970 6520 3d20 5069         pipe = Pi
-00035650: 7065 6c69 6e65 280a 2020 2020 2020 2020  peline(.        
-00035660: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00035670: 2020 2020 7374 6570 733d 5b28 2270 7265      steps=[("pre
-00035680: 7072 6f63 6573 736f 7222 2c20 7072 6570  processor", prep
-00035690: 726f 6365 7373 6f72 292c 2028 226d 6f64  rocessor), ("mod
-000356a0: 656c 222c 206d 6f64 656c 295d 0a20 2020  el", model)].   
-000356b0: 2020 2020 2020 2020 2020 2020 2020 2020                  
-000356c0: 2020 2020 2029 0a0a 2020 2020 2020 2020       )..        
-000356d0: 2020 2020 2020 2020 2020 2020 2020 2020                  
-000356e0: 7069 7065 2e66 6974 2878 5f74 7261 696e  pipe.fit(x_train
-000356f0: 2c20 795f 7472 6169 6e29 0a20 2020 2020  , y_train).     
-00035700: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00035710: 2020 2073 656c 662e 6d6f 6465 6c73 2e61     self.models.a
-00035720: 7070 656e 6428 7069 7065 290a 0a20 2020  ppend(pipe)..   
-00035730: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00035740: 2020 2020 2023 2050 7265 6469 6374 206f       # Predict o
-00035750: 6e20 7265 6d61 696e 696e 6720 6461 7461  n remaining data
-00035760: 206f 6620 6561 6368 2066 6f6c 640a 2020   of each fold.  
-00035770: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00035780: 2020 2020 2020 7072 6564 7320 3d20 7069        preds = pi
-00035790: 7065 2e70 7265 6469 6374 2878 5f74 6573  pe.predict(x_tes
-000357a0: 7429 0a0a 2020 2020 2020 2020 2020 2020  t)..            
-000357b0: 2020 2020 2020 2020 656c 7365 3a0a 2020          else:.  
-000357c0: 2020 2020 2020 2020 2020 2020 2020 2020                  
-000357d0: 2020 2020 2020 2323 2323 2054 6869 7320        #### This 
-000357e0: 6973 2077 6974 686f 7574 2061 2070 6970  is without a pip
-000357f0: 656c 696e 6520 2323 230a 2020 2020 2020  eline ###.      
-00035800: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00035810: 2020 6d6f 6465 6c2e 6669 7428 785f 7472    model.fit(x_tr
-00035820: 6169 6e2c 2079 5f74 7261 696e 290a 2020  ain, y_train).  
-00035830: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00035840: 2020 2020 2020 7365 6c66 2e6d 6f64 656c        self.model
-00035850: 732e 6170 7065 6e64 286d 6f64 656c 290a  s.append(model).
-00035860: 0a20 2020 2020 2020 2020 2020 2020 2020  .               
-00035870: 2020 2020 2020 2020 2023 2050 7265 6469           # Predi
-00035880: 6374 206f 6e20 7265 6d61 696e 696e 6720  ct on remaining 
-00035890: 6461 7461 206f 6620 6561 6368 2066 6f6c  data of each fol
-000358a0: 640a 2020 2020 2020 2020 2020 2020 2020  d.              
-000358b0: 2020 2020 2020 2020 2020 7072 6564 7320            preds 
-000358c0: 3d20 6d6f 6465 6c2e 7072 6564 6963 7428  = model.predict(
-000358d0: 785f 7465 7374 290a 0a20 2020 2020 2020  x_test)..       
-000358e0: 2020 2020 2020 2020 2020 2020 200a 2020               .  
-000358f0: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00035900: 2020 2320 5573 6520 6265 7374 2063 6c61    # Use best cla
-00035910: 7373 6966 6963 6174 696f 6e20 6d65 7472  ssification metr
-00035920: 6963 2074 6f20 6d65 6173 7572 6520 7065  ic to measure pe
-00035930: 7266 6f72 6d61 6e63 6520 6f66 206d 6f64  rformance of mod
-00035940: 656c 0a20 2020 2020 2020 2020 2020 2020  el.             
-00035950: 2020 2020 2020 2069 6620 7365 6c66 2e69         if self.i
-00035960: 6d62 616c 616e 6365 643a 0a20 2020 2020  mbalanced:.     
-00035970: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00035980: 2020 2023 2323 2055 7365 2073 7065 6369     ### Use speci
-00035990: 616c 2070 7269 7469 6e67 2070 726f 6772  al priting progr
-000359a0: 616d 2068 6572 6520 2323 0a20 2020 2020  am here ##.     
-000359b0: 2020 2020 2020 2020 2020 2020 2020 2020                  
-000359c0: 2020 2073 636f 7265 203d 2070 7269 6e74     score = print
-000359d0: 5f73 756c 6f5f 6163 6375 7261 6379 2879  _sulo_accuracy(y
-000359e0: 5f74 6573 742c 2070 7265 6473 2c20 795f  _test, preds, y_
-000359f0: 7072 6f62 6173 3d22 222c 2076 6572 626f  probas="", verbo
-00035a00: 7365 3d73 656c 662e 7665 7262 6f73 6529  se=self.verbose)
-00035a10: 0a20 2020 2020 2020 2020 2020 2020 2020  .               
-00035a20: 2020 2020 2020 2020 2069 6620 7365 6c66           if self
-00035a30: 2e76 6572 626f 7365 3a0a 2020 2020 2020  .verbose:.      
-00035a40: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00035a50: 2020 2020 2020 7072 696e 7428 2220 2020        print("   
-00035a60: 2046 6f6c 6420 2573 3a20 6f75 742d 6f66   Fold %s: out-of
-00035a70: 2d66 6f6c 6420 6261 6c61 6e63 6564 5f61  -fold balanced_a
-00035a80: 6363 7572 6163 793a 2025 302e 3166 2525  ccuracy: %0.1f%%
-00035a90: 2220 2528 692b 312c 2031 3030 2a73 636f  " %(i+1, 100*sco
-00035aa0: 7265 2929 0a20 2020 2020 2020 2020 2020  re)).           
-00035ab0: 2020 2020 2020 2020 2065 6c73 653a 0a20           else:. 
-00035ac0: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00035ad0: 2020 2020 2020 2073 636f 7265 203d 2070         score = p
-00035ae0: 7269 6e74 5f61 6363 7572 6163 7928 7461  rint_accuracy(ta
-00035af0: 7267 6574 732c 2079 5f74 6573 742c 2070  rgets, y_test, p
-00035b00: 7265 6473 2c20 7665 7262 6f73 653d 7365  reds, verbose=se
-00035b10: 6c66 2e76 6572 626f 7365 290a 2020 2020  lf.verbose).    
-00035b20: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00035b30: 2020 2020 6966 2073 656c 662e 7665 7262      if self.verb
-00035b40: 6f73 653a 0a20 2020 2020 2020 2020 2020  ose:.           
-00035b50: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00035b60: 2070 7269 6e74 2822 2020 2020 466f 6c64   print("    Fold
-00035b70: 2025 733a 206f 7574 2d6f 662d 666f 6c64   %s: out-of-fold
-00035b80: 2062 616c 616e 6365 645f 6163 6375 7261   balanced_accura
-00035b90: 6379 3a20 2530 2e31 6625 2522 2025 2869  cy: %0.1f%%" %(i
-00035ba0: 2b31 2c20 3130 302a 7363 6f72 6529 290a  +1, 100*score)).
-00035bb0: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00035bc0: 2020 2020 7365 6c66 2e73 636f 7265 732e      self.scores.
-00035bd0: 6170 7065 6e64 2873 636f 7265 290a 2020  append(score).  
-00035be0: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00035bf0: 2020 0a20 2020 2020 2020 2020 2020 2020    .             
-00035c00: 2020 2020 2020 2023 2046 696e 616c 6c79         # Finally
-00035c10: 2c20 6368 6563 6b20 6f75 7420 7468 6520  , check out the 
-00035c20: 746f 7461 6c20 7469 6d65 2074 616b 656e  total time taken
-00035c30: 0a20 2020 2020 2020 2020 2020 2020 2020  .               
-00035c40: 2020 2020 2065 6e64 5f74 696d 6520 3d20       end_time = 
-00035c50: 7469 6d65 2e74 696d 6528 290a 2020 2020  time.time().    
-00035c60: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00035c70: 7469 6d65 5461 6b65 6e20 3d20 656e 645f  timeTaken = end_
-00035c80: 7469 6d65 202d 2073 7461 7274 5f74 696d  time - start_tim
-00035c90: 650a 2020 2020 2020 2020 2020 2020 2020  e.              
-00035ca0: 2020 2020 2020 6966 2073 656c 662e 7665        if self.ve
-00035cb0: 7262 6f73 653a 0a20 2020 2020 2020 2020  rbose:.         
-00035cc0: 2020 2020 2020 2020 2020 2020 2020 2070                 p
-00035cd0: 7269 6e74 2822 5469 6d65 2054 616b 656e  rint("Time Taken
-00035ce0: 2066 6f72 2066 6f6c 6420 2573 3a20 2530   for fold %s: %0
-00035cf0: 2e30 6620 2873 6563 6f6e 6473 2922 2025  .0f (seconds)" %
-00035d00: 2869 2b31 2c20 7469 6d65 5461 6b65 6e29  (i+1, timeTaken)
-00035d10: 290a 0a20 2020 2020 2020 2020 2020 2020  )..             
-00035d20: 2020 2020 2020 2069 202b 3d20 310a 0a20         i += 1.. 
-00035d30: 2020 2020 2020 2020 2020 2020 2020 2023                 #
-00035d40: 2043 6f6d 7075 7465 2061 7665 7261 6765   Compute average
-00035d50: 2073 636f 7265 0a20 2020 2020 2020 2020   score.         
-00035d60: 2020 2020 2020 2061 7665 7261 6765 4163         averageAc
-00035d70: 6375 7261 6379 203d 2073 756d 2873 656c  curacy = sum(sel
-00035d80: 662e 7363 6f72 6573 292f 6c65 6e28 7365  f.scores)/len(se
-00035d90: 6c66 2e73 636f 7265 7329 0a20 2020 2020  lf.scores).     
-00035da0: 2020 2020 2020 2020 2020 2070 7269 6e74             print
-00035db0: 2822 4669 6e61 6c20 4261 6c61 6e63 6564  ("Final Balanced
-00035dc0: 2041 6363 7572 6163 7920 7363 6f72 6520   Accuracy score 
-00035dd0: 6f66 2025 732d 6573 7469 6d61 746f 7220  of %s-estimator 
-00035de0: 5375 6c6f 436c 6173 7369 6669 6572 3a20  SuloClassifier: 
-00035df0: 2530 2e31 6625 2522 2025 280a 2020 2020  %0.1f%%" %(.    
-00035e00: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00035e10: 2020 2020 2020 2020 2020 2020 7365 6c66              self
-00035e20: 2e6e 5f65 7374 696d 6174 6f72 732c 2031  .n_estimators, 1
-00035e30: 3030 2a61 7665 7261 6765 4163 6375 7261  00*averageAccura
-00035e40: 6379 2929 0a0a 2020 2020 2020 2020 2020  cy))..          
-00035e50: 2020 2020 2020 656e 6420 3d20 7469 6d65        end = time
-00035e60: 2e74 696d 6528 290a 2020 2020 2020 2020  .time().        
-00035e70: 2020 2020 2020 2020 7469 6d65 5461 6b65          timeTake
-00035e80: 6e20 3d20 656e 6420 2d20 7374 6172 740a  n = end - start.
-00035e90: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00035ea0: 7072 696e 7428 2254 696d 6520 5461 6b65  print("Time Take
-00035eb0: 6e20 6f76 6572 616c 6c3a 2025 302e 3066  n overall: %0.0f
-00035ec0: 2028 7365 636f 6e64 7329 2220 2528 7469   (seconds)" %(ti
-00035ed0: 6d65 5461 6b65 6e29 290a 2020 2020 2020  meTaken)).      
-00035ee0: 2020 2020 2020 2020 2020 7365 6c66 2e6b            self.k
-00035ef0: 6620 3d20 6b66 6f6c 640a 2020 2020 2020  f = kfold.      
-00035f00: 2020 2020 2020 2020 2020 7265 7475 726e            return
-00035f10: 2073 656c 660a 2020 2020 2020 2020 2323   self.        ##
-00035f20: 2323 2323 2323 2323 2323 2323 2323 2323  ################
-00035f30: 2323 2323 2323 2323 2323 2323 2323 2323  ################
-00035f40: 2323 2323 2323 2323 2323 2323 2323 2323  ################
-00035f50: 2323 2323 2323 0a20 2020 2020 2020 2023  ######.        #
-00035f60: 2323 2323 2020 5468 6973 2069 7320 666f  ####  This is fo
-00035f70: 7220 5369 6e67 6c65 204c 6162 656c 2043  r Single Label C
-00035f80: 6c61 7373 6966 6963 6174 696f 6e20 7072  lassification pr
-00035f90: 6f62 6c65 6d73 200a 2020 2020 2020 2020  oblems .        
-00035fa0: 2323 2323 2323 2323 2323 2323 2323 2323  ################
-00035fb0: 2323 2323 2323 2323 2323 2323 2323 2323  ################
-00035fc0: 2323 2323 2323 2323 2323 2323 2323 2323  ################
-00035fd0: 2323 2323 2323 2323 0a20 2020 2020 2020  ########.       
-00035fe0: 200a 2020 2020 2020 2020 6966 2069 7369   .        if isi
-00035ff0: 6e73 7461 6e63 6528 792c 2070 642e 5365  nstance(y, pd.Se
-00036000: 7269 6573 293a 0a20 2020 2020 2020 2020  ries):.         
-00036010: 2020 2074 6172 6765 7473 203d 2079 2e6e     targets = y.n
-00036020: 616d 650a 2020 2020 2020 2020 2020 2020  ame.            
-00036030: 6966 2074 6172 6765 7473 2069 7320 4e6f  if targets is No
-00036040: 6e65 3a0a 2020 2020 2020 2020 2020 2020  ne:.            
-00036050: 2020 2020 7461 7267 6574 7320 3d20 5b5d      targets = []
-00036060: 0a20 2020 2020 2020 2065 6c73 653a 0a20  .        else:. 
-00036070: 2020 2020 2020 2020 2020 2074 6172 6765             targe
-00036080: 7473 203d 205b 5d0a 0a20 2020 2020 2020  ts = []..       
-00036090: 2065 7374 5f6c 6973 7420 3d20 6e75 6d5f   est_list = num_
-000360a0: 6974 6572 6174 696f 6e73 2a5b 7365 6c66  iterations*[self
-000360b0: 2e62 6173 655f 6573 7469 6d61 746f 725d  .base_estimator]
-000360c0: 0a20 2020 2020 2020 200a 2020 2020 2020  .        .      
-000360d0: 2020 2320 5065 7266 6f72 6d20 4356 0a20    # Perform CV. 
-000360e0: 2020 2020 2020 2069 203d 2030 0a20 2020         i = 0.   
-000360f0: 2020 2020 2066 6f72 2074 7261 696e 5f69       for train_i
-00036100: 6e64 6578 2c20 7465 7374 5f69 6e64 6578  ndex, test_index
-00036110: 2069 6e20 7471 646d 286b 666f 6c64 2e73   in tqdm(kfold.s
-00036120: 706c 6974 2858 2c20 7929 2c20 746f 7461  plit(X, y), tota
-00036130: 6c3d 6b66 6f6c 642e 6765 745f 6e5f 7370  l=kfold.get_n_sp
-00036140: 6c69 7473 2829 2c20 0a20 2020 2020 2020  lits(), .       
-00036150: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00036160: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00036170: 2064 6573 633d 226b 2d66 6f6c 6420 7472   desc="k-fold tr
-00036180: 6169 6e69 6e67 2229 3a0a 2020 2020 2020  aining"):.      
-00036190: 2020 2020 2020 7374 6172 745f 7469 6d65        start_time
-000361a0: 203d 2074 696d 652e 7469 6d65 2829 0a20   = time.time(). 
-000361b0: 2020 2020 2020 2020 2020 2072 616e 646f             rando
-000361c0: 6d5f 7365 6564 203d 206e 702e 7261 6e64  m_seed = np.rand
-000361d0: 6f6d 2e72 616e 6469 6e74 2832 2c31 3030  om.randint(2,100
-000361e0: 290a 2020 2020 2020 2020 2020 2020 2323  ).            ##
-000361f0: 2323 2323 2323 2323 2020 5468 6973 2069  ########  This i
-00036200: 7320 7768 6572 6520 7765 2064 6f20 6d75  s where we do mu
-00036210: 6c74 692d 7365 6564 2063 6c61 7373 6966  lti-seed classif
-00036220: 6965 7273 2023 2323 2323 2323 2323 0a20  iers #########. 
-00036230: 2020 2020 2020 2020 2020 200a 2020 2020             .    
-00036240: 2020 2020 2020 2020 6966 2073 656c 662e          if self.
-00036250: 6261 7365 5f65 7374 696d 6174 6f72 2069  base_estimator i
-00036260: 7320 4e6f 6e65 3a0a 2020 2020 2020 2020  s None:.        
-00036270: 2020 2020 2020 2020 6966 2064 6174 615f          if data_
-00036280: 7361 6d70 6c65 7320 3c3d 2072 6f77 5f6c  samples <= row_l
-00036290: 696d 6974 3a0a 2020 2020 2020 2020 2020  imit:.          
-000362a0: 2020 2020 2020 2020 2020 2323 2320 466f            ### Fo
-000362b0: 7220 736d 616c 6c20 6461 7461 7365 7473  r small datasets
-000362c0: 2075 7365 2052 4643 2066 6f72 2042 696e   use RFC for Bin
-000362d0: 6172 7920 436c 6173 7320 2020 2323 2323  ary Class   ####
-000362e0: 2323 2323 2323 2323 2323 2323 2323 2323  ################
-000362f0: 2323 2323 0a20 2020 2020 2020 2020 2020  ####.           
-00036300: 2020 2020 2020 2020 2069 6620 6e75 6d62           if numb
-00036310: 6572 5f6f 665f 636c 6173 7365 7320 3c3d  er_of_classes <=
-00036320: 2031 3a0a 2020 2020 2020 2020 2020 2020   1:.            
-00036330: 2020 2020 2020 2020 2020 2020 6966 2073              if s
-00036340: 656c 662e 696d 6261 6c61 6e63 6564 3a0a  elf.imbalanced:.
-00036350: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00036360: 2020 2020 2020 2020 2020 2020 6966 2073              if s
-00036370: 656c 662e 7665 7262 6f73 653a 0a20 2020  elf.verbose:.   
-00036380: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00036390: 2020 2020 2020 2020 2020 2020 2070 7269               pri
-000363a0: 6e74 2827 2020 2020 5365 6c65 6374 696e  nt('    Selectin
-000363b0: 6720 5365 6c66 2050 6163 6564 2065 6e73  g Self Paced ens
-000363c0: 656d 626c 6520 636c 6173 7369 6669 6572  emble classifier
-000363d0: 2061 7320 6261 7365 2065 7374 696d 6174   as base estimat
-000363e0: 6f72 2e2e 2e27 290a 2020 2020 2020 2020  or...').        
-000363f0: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00036400: 2020 2020 7472 793a 0a20 2020 2020 2020      try:.       
+00035640: 2020 2020 2070 7269 6e74 2822 2020 2020       print("    
+00035650: 466f 6c64 2025 733a 206f 7574 2d6f 662d  Fold %s: out-of-
+00035660: 666f 6c64 2062 616c 616e 6365 6420 6163  fold balanced ac
+00035670: 6375 7261 6379 3a20 2530 2e31 6625 2522  curacy: %0.1f%%"
+00035680: 2025 2869 2b31 2c20 3130 302a 7363 6f72   %(i+1, 100*scor
+00035690: 6529 290a 2020 2020 2020 2020 2020 2020  e)).            
+000356a0: 656c 7365 3a0a 2020 2020 2020 2020 2020  else:.          
+000356b0: 2020 2020 2020 2373 636f 7265 203d 2062        #score = b
+000356c0: 616c 616e 6365 645f 6163 6375 7261 6379  alanced_accuracy
+000356d0: 5f73 636f 7265 2879 5f74 6573 742c 2070  _score(y_test, p
+000356e0: 7265 6473 290a 2020 2020 2020 2020 2020  reds).          
+000356f0: 2020 2020 2020 7363 6f72 6520 3d20 7072        score = pr
+00035700: 696e 745f 6163 6375 7261 6379 2874 6172  int_accuracy(tar
+00035710: 6765 7473 2c20 795f 7465 7374 2c20 7072  gets, y_test, pr
+00035720: 6564 732c 2076 6572 626f 7365 3d73 656c  eds, verbose=sel
+00035730: 662e 7665 7262 6f73 6529 0a20 2020 2020  f.verbose).     
+00035740: 2020 2020 2020 2020 2020 2069 6620 7365             if se
+00035750: 6c66 2e76 6572 626f 7365 3a0a 2020 2020  lf.verbose:.    
+00035760: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00035770: 2020 2020 7072 696e 7428 2220 2020 2046      print("    F
+00035780: 6f6c 6420 2573 3a20 6f75 742d 6f66 2d66  old %s: out-of-f
+00035790: 6f6c 6420 6261 6c61 6e63 6564 2061 6363  old balanced acc
+000357a0: 7572 6163 793a 2025 302e 3166 2525 2220  uracy: %0.1f%%" 
+000357b0: 2528 692b 312c 2031 3030 2a73 636f 7265  %(i+1, 100*score
+000357c0: 2929 0a20 2020 2020 2020 2020 2020 2073  )).            s
+000357d0: 656c 662e 7363 6f72 6573 2e61 7070 656e  elf.scores.appen
+000357e0: 6428 7363 6f72 6529 0a0a 2020 2020 2020  d(score)..      
+000357f0: 2020 2020 2020 6920 2b3d 2031 0a0a 2020        i += 1..  
+00035800: 2020 2020 2020 2320 436f 6d70 7574 6520        # Compute 
+00035810: 6176 6572 6167 6520 7363 6f72 650a 2020  average score.  
+00035820: 2020 2020 2020 6176 6572 6167 6541 6363        averageAcc
+00035830: 7572 6163 7920 3d20 7375 6d28 7365 6c66  uracy = sum(self
+00035840: 2e73 636f 7265 7329 2f6c 656e 2873 656c  .scores)/len(sel
+00035850: 662e 7363 6f72 6573 290a 2020 2020 2020  f.scores).      
+00035860: 2020 7072 696e 7428 2246 696e 616c 2062    print("Final b
+00035870: 616c 616e 6365 6420 4163 6375 7261 6379  alanced Accuracy
+00035880: 206f 6620 2573 2d65 7374 696d 6174 6f72   of %s-estimator
+00035890: 2053 756c 6f43 6c61 7373 6966 6965 723a   SuloClassifier:
+000358a0: 2025 302e 3166 2525 2220 2528 6e75 6d5f   %0.1f%%" %(num_
+000358b0: 6974 6572 6174 696f 6e73 2c20 3130 302a  iterations, 100*
+000358c0: 6176 6572 6167 6541 6363 7572 6163 7929  averageAccuracy)
+000358d0: 290a 0a20 2020 2020 2020 2023 2046 696e  )..        # Fin
+000358e0: 616c 6c79 2c20 6368 6563 6b20 6f75 7420  ally, check out 
+000358f0: 7468 6520 746f 7461 6c20 7469 6d65 2074  the total time t
+00035900: 616b 656e 0a20 2020 2020 2020 2065 6e64  aken.        end
+00035910: 203d 2074 696d 652e 7469 6d65 2829 0a20   = time.time(). 
+00035920: 2020 2020 2020 2074 696d 6554 616b 656e         timeTaken
+00035930: 203d 2065 6e64 2d73 7461 7274 0a20 2020   = end-start.   
+00035940: 2020 2020 2070 7269 6e74 2822 5469 6d65       print("Time
+00035950: 2054 616b 656e 3a20 2530 2e30 6620 2873   Taken: %0.0f (s
+00035960: 6563 6f6e 6473 2922 2025 7469 6d65 5461  econds)" %timeTa
+00035970: 6b65 6e29 0a20 2020 2020 2020 2073 656c  ken).        sel
+00035980: 662e 6b66 203d 206b 666f 6c64 0a20 2020  f.kf = kfold.   
+00035990: 2020 2020 2072 6574 7572 6e20 7365 6c66       return self
+000359a0: 0a0a 2020 2020 6465 6620 7072 6564 6963  ..    def predic
+000359b0: 7428 7365 6c66 2c20 5829 3a0a 2020 2020  t(self, X):.    
+000359c0: 2020 2020 6672 6f6d 2073 6369 7079 2069      from scipy i
+000359d0: 6d70 6f72 7420 7374 6174 730a 2020 2020  mport stats.    
+000359e0: 2020 2020 7765 6967 6874 7320 3d20 7365      weights = se
+000359f0: 6c66 2e73 636f 7265 730a 2020 2020 2020  lf.scores.      
+00035a00: 2020 6966 2073 656c 662e 6d75 6c74 695f    if self.multi_
+00035a10: 6c61 6265 6c3a 0a20 2020 2020 2020 2020  label:.         
+00035a20: 2020 2023 2323 2049 6e20 6d75 6c74 692d     ### In multi-
+00035a30: 6c61 6265 6c2c 2074 6172 6765 7473 2068  label, targets h
+00035a40: 6176 6520 746f 2062 6520 6e75 6d65 7269  ave to be numeri
+00035a50: 632c 2073 6f20 796f 7520 6361 6e20 6c65  c, so you can le
+00035a60: 6176 6520 7765 6967 6874 7320 6173 2d69  ave weights as-i
+00035a70: 7320 2323 0a20 2020 2020 2020 2020 2020  s ##.           
+00035a80: 2079 7072 6520 3d20 6e70 2e61 7272 6179   ypre = np.array
+00035a90: 285b 6d6f 6465 6c2e 7072 6564 6963 7428  ([model.predict(
+00035aa0: 5829 2066 6f72 206d 6f64 656c 2069 6e20  X) for model in 
+00035ab0: 7365 6c66 2e6d 6f64 656c 7320 5d29 0a20  self.models ]). 
+00035ac0: 2020 2020 2020 2020 2020 2079 5f70 7265             y_pre
+00035ad0: 6469 7320 3d20 6e70 2e61 7665 7261 6765  dis = np.average
+00035ae0: 2879 7072 652c 2061 7869 733d 302c 2077  (ypre, axis=0, w
+00035af0: 6569 6768 7473 3d77 6569 6768 7473 290a  eights=weights).
+00035b00: 2020 2020 2020 2020 2020 2020 795f 7072              y_pr
+00035b10: 6564 7320 3d20 6e70 2e72 6f75 6e64 2879  eds = np.round(y
+00035b20: 5f70 7265 6469 732c 3029 2e61 7374 7970  _predis,0).astyp
+00035b30: 6528 696e 7429 0a20 2020 2020 2020 2020  e(int).         
+00035b40: 2020 2072 6574 7572 6e20 795f 7072 6564     return y_pred
+00035b50: 730a 2020 2020 2020 2020 795f 7072 6564  s.        y_pred
+00035b60: 6973 203d 206e 702e 636f 6c75 6d6e 5f73  is = np.column_s
+00035b70: 7461 636b 285b 6d6f 6465 6c2e 7072 6564  tack([model.pred
+00035b80: 6963 7428 5829 2066 6f72 206d 6f64 656c  ict(X) for model
+00035b90: 2069 6e20 7365 6c66 2e6d 6f64 656c 7320   in self.models 
+00035ba0: 5d29 0a20 2020 2020 2020 2023 2323 2054  ]).        ### T
+00035bb0: 6869 7320 7765 6967 6874 7320 7468 6520  his weights the 
+00035bc0: 6d6f 6465 6c27 7320 7072 6564 6963 7469  model's predicti
+00035bd0: 6f6e 7320 6163 636f 7264 696e 6720 746f  ons according to
+00035be0: 204f 4f42 2073 636f 7265 7320 6f62 7461   OOB scores obta
+00035bf0: 696e 6564 0a20 2020 2020 2020 2023 2323  ined.        ###
+00035c00: 2320 496e 2073 696e 676c 6520 6c61 6265  # In single labe
+00035c10: 6c2c 2074 6172 6765 7473 2063 616e 2062  l, targets can b
+00035c20: 6520 6f62 6a65 6374 206f 7220 7374 7269  e object or stri
+00035c30: 6e67 2c20 736f 2077 6569 6768 7473 2063  ng, so weights c
+00035c40: 616e 6e6f 7420 6265 2061 7070 6c69 6564  annot be applied
+00035c50: 2061 6c77 6179 7320 2323 0a20 2020 2020   always ##.     
+00035c60: 2020 2069 6620 795f 7072 6564 6973 2e64     if y_predis.d
+00035c70: 7479 7065 203d 3d20 6f62 6a65 6374 206f  type == object o
+00035c80: 7220 795f 7072 6564 6973 2e64 7479 7065  r y_predis.dtype
+00035c90: 203d 3d20 626f 6f6c 3a0a 2020 2020 2020   == bool:.      
+00035ca0: 2020 2020 2020 2323 2320 696e 2074 6865        ### in the
+00035cb0: 2063 6173 6520 6f66 2070 7265 6469 6374   case of predict
+00035cc0: 696f 6e73 2074 6861 7420 6172 6520 7374  ions that are st
+00035cd0: 7269 6e67 732c 206e 6f20 6e65 6564 2066  rings, no need f
+00035ce0: 6f72 2077 6569 6768 7473 2023 230a 2020  or weights ##.  
+00035cf0: 2020 2020 2020 2020 2020 795f 7072 6564            y_pred
+00035d00: 6973 203d 2073 7461 7473 2e6d 6f64 6528  is = stats.mode(
+00035d10: 795f 7072 6564 6973 2c20 6178 6973 3d31  y_predis, axis=1
+00035d20: 295b 305d 2e72 6176 656c 2829 0a20 2020  )[0].ravel().   
+00035d30: 2020 2020 2065 6c73 653a 0a20 2020 2020       else:.     
+00035d40: 2020 2020 2020 2069 6620 7374 7228 795f         if str(y_
+00035d50: 7072 6564 6973 2e64 7479 7065 2920 3d3d  predis.dtype) ==
+00035d60: 2027 6361 7465 676f 7279 273a 0a20 2020   'category':.   
+00035d70: 2020 2020 2020 2020 2020 2020 2079 5f70               y_p
+00035d80: 7265 6469 7320 3d20 7374 6174 732e 6d6f  redis = stats.mo
+00035d90: 6465 2879 5f70 7265 6469 732c 2061 7869  de(y_predis, axi
+00035da0: 733d 3129 5b30 5d2e 7261 7665 6c28 290a  s=1)[0].ravel().
+00035db0: 2020 2020 2020 2020 2020 2020 656c 7365              else
+00035dc0: 3a0a 2020 2020 2020 2020 2020 2020 2020  :.              
+00035dd0: 2020 795f 7072 6564 6973 203d 206e 702e    y_predis = np.
+00035de0: 6176 6572 6167 6528 795f 7072 6564 6973  average(y_predis
+00035df0: 2c20 7765 6967 6874 733d 7765 6967 6874  , weights=weight
+00035e00: 732c 2061 7869 733d 3129 0a20 2020 2020  s, axis=1).     
+00035e10: 2020 2020 2020 2020 2020 2079 5f70 7265             y_pre
+00035e20: 6469 7320 3d20 6e70 2e72 6f75 6e64 2879  dis = np.round(y
+00035e30: 5f70 7265 6469 732c 3029 2e61 7374 7970  _predis,0).astyp
+00035e40: 6528 696e 7429 0a20 2020 2020 2020 2069  e(int).        i
+00035e50: 6620 7365 6c66 2e69 6d62 616c 616e 6365  f self.imbalance
+00035e60: 643a 0a20 2020 2020 2020 2020 2020 2079  d:.            y
+00035e70: 5f70 7265 6469 7320 3d20 636f 7079 2e64  _predis = copy.d
+00035e80: 6565 7063 6f70 7928 795f 7072 6564 6973  eepcopy(y_predis
+00035e90: 290a 2020 2020 2020 2020 7265 7475 726e  ).        return
+00035ea0: 2079 5f70 7265 6469 730a 2020 2020 0a20   y_predis.    . 
+00035eb0: 2020 2064 6566 2070 7265 6469 6374 5f70     def predict_p
+00035ec0: 726f 6261 2873 656c 662c 2058 293a 0a20  roba(self, X):. 
+00035ed0: 2020 2020 2020 2077 6569 6768 7473 203d         weights =
+00035ee0: 2073 656c 662e 7363 6f72 6573 0a20 2020   self.scores.   
+00035ef0: 2020 2020 2079 5f70 726f 6261 7320 3d20       y_probas = 
+00035f00: 5b6d 6f64 656c 2e70 7265 6469 6374 5f70  [model.predict_p
+00035f10: 726f 6261 2858 2920 666f 7220 6d6f 6465  roba(X) for mode
+00035f20: 6c20 696e 2073 656c 662e 6d6f 6465 6c73  l in self.models
+00035f30: 205d 0a20 2020 2020 2020 2079 5f70 726f   ].        y_pro
+00035f40: 6261 7320 3d20 7265 7475 726e 5f70 7265  bas = return_pre
+00035f50: 6469 6374 5f70 726f 6261 2879 5f70 726f  dict_proba(y_pro
+00035f60: 6261 7329 0a20 2020 2020 2020 2072 6574  bas).        ret
+00035f70: 7572 6e20 795f 7072 6f62 6173 0a0a 2020  urn y_probas..  
+00035f80: 2020 6465 6620 7072 696e 745f 7069 7065    def print_pipe
+00035f90: 6c69 6e65 2873 656c 6629 3a0a 2020 2020  line(self):.    
+00035fa0: 2020 2020 6672 6f6d 2073 6b6c 6561 726e      from sklearn
+00035fb0: 2069 6d70 6f72 7420 7365 745f 636f 6e66   import set_conf
+00035fc0: 6967 0a20 2020 2020 2020 2073 6574 5f63  ig.        set_c
+00035fd0: 6f6e 6669 6728 6469 7370 6c61 793d 2274  onfig(display="t
+00035fe0: 6578 7422 290a 2020 2020 2020 2020 7265  ext").        re
+00035ff0: 7475 726e 2073 656c 662e 7866 6f72 6d65  turn self.xforme
+00036000: 720a 0a20 2020 2064 6566 2070 6c6f 745f  r..    def plot_
+00036010: 7069 7065 6c69 6e65 2873 656c 6629 3a0a  pipeline(self):.
+00036020: 2020 2020 2020 2020 6672 6f6d 2073 6b6c          from skl
+00036030: 6561 726e 2069 6d70 6f72 7420 7365 745f  earn import set_
+00036040: 636f 6e66 6967 0a20 2020 2020 2020 2073  config.        s
+00036050: 6574 5f63 6f6e 6669 6728 6469 7370 6c61  et_config(displa
+00036060: 793d 2264 6961 6772 616d 2229 0a20 2020  y="diagram").   
+00036070: 2020 2020 2072 6574 7572 6e20 7365 6c66       return self
+00036080: 0a0a 2020 2020 6465 6620 706c 6f74 5f69  ..    def plot_i
+00036090: 6d70 6f72 7461 6e63 6528 7365 6c66 2c20  mportance(self, 
+000360a0: 6d61 785f 6665 6174 7572 6573 3d31 3029  max_features=10)
+000360b0: 3a0a 2020 2020 2020 2020 696d 706f 7274  :.        import
+000360c0: 206c 6967 6874 6762 6d20 6173 206c 6762   lightgbm as lgb
+000360d0: 6d0a 2020 2020 2020 2020 6672 6f6d 2078  m.        from x
+000360e0: 6762 6f6f 7374 2069 6d70 6f72 7420 706c  gboost import pl
+000360f0: 6f74 5f69 6d70 6f72 7461 6e63 650a 2020  ot_importance.  
+00036100: 2020 2020 2020 6d6f 6465 6c5f 6e61 6d65        model_name
+00036110: 203d 2073 656c 662e 6d6f 6465 6c5f 6e61   = self.model_na
+00036120: 6d65 0a20 2020 2020 2020 2066 6561 7475  me.        featu
+00036130: 7265 5f6e 616d 6573 203d 2073 656c 662e  re_names = self.
+00036140: 6665 6174 7572 6573 0a20 2020 2020 2020  features.       
+00036150: 2069 6620 7365 6c66 2e6d 756c 7469 5f6c   if self.multi_l
+00036160: 6162 656c 3a0a 2020 2020 2020 2020 2020  abel:.          
+00036170: 2020 7072 696e 7428 274e 6f20 6665 6174    print('No feat
+00036180: 7572 6520 696d 706f 7274 616e 6365 7320  ure importances 
+00036190: 6176 6169 6c61 626c 6520 666f 7220 6d75  available for mu
+000361a0: 6c74 695f 6c61 6265 6c20 7072 6f62 6c65  lti_label proble
+000361b0: 6d73 2729 0a20 2020 2020 2020 2020 2020  ms').           
+000361c0: 2072 6574 7572 6e0a 2020 2020 2020 2020   return.        
+000361d0: 6966 2020 6d6f 6465 6c5f 6e61 6d65 203d  if  model_name =
+000361e0: 3d20 276c 6762 2720 6f72 206d 6f64 656c  = 'lgb' or model
+000361f0: 5f6e 616d 6520 3d3d 2027 7867 6227 3a0a  _name == 'xgb':.
+00036200: 2020 2020 2020 2020 2020 2020 666f 7220              for 
+00036210: 692c 206d 6f64 656c 2069 6e20 656e 756d  i, model in enum
+00036220: 6572 6174 6528 7365 6c66 2e6d 6f64 656c  erate(self.model
+00036230: 7329 3a0a 2020 2020 2020 2020 2020 2020  s):.            
+00036240: 2020 2020 6966 2073 656c 662e 7069 7065      if self.pipe
+00036250: 6c69 6e65 3a0a 2020 2020 2020 2020 2020  line:.          
+00036260: 2020 2020 2020 2020 2020 6d6f 6465 6c5f            model_
+00036270: 6f62 6a65 6374 203d 206d 6f64 656c 2e6e  object = model.n
+00036280: 616d 6564 5f73 7465 7073 5b27 6d6f 6465  amed_steps['mode
+00036290: 6c27 5d0a 2020 2020 2020 2020 2020 2020  l'].            
+000362a0: 2020 2020 656c 7365 3a0a 2020 2020 2020      else:.      
+000362b0: 2020 2020 2020 2020 2020 2020 2020 6d6f                mo
+000362c0: 6465 6c5f 6f62 6a65 6374 203d 206d 6f64  del_object = mod
+000362d0: 656c 0a20 2020 2020 2020 2020 2020 2020  el.             
+000362e0: 2020 2066 6561 7475 7265 5f69 6d70 6f72     feature_impor
+000362f0: 7461 6e63 6573 203d 206d 6f64 656c 5f6f  tances = model_o
+00036300: 626a 6563 742e 626f 6f73 7465 725f 2e66  bject.booster_.f
+00036310: 6561 7475 7265 5f69 6d70 6f72 7461 6e63  eature_importanc
+00036320: 6528 696d 706f 7274 616e 6365 5f74 7970  e(importance_typ
+00036330: 653d 2767 6169 6e27 290a 2020 2020 2020  e='gain').      
+00036340: 2020 2020 2020 2020 2020 6966 2069 203d            if i =
+00036350: 3d20 303a 0a20 2020 2020 2020 2020 2020  = 0:.           
+00036360: 2020 2020 2020 2020 2066 6561 7475 7265           feature
+00036370: 5f69 6d70 203d 2070 642e 4461 7461 4672  _imp = pd.DataFr
+00036380: 616d 6528 7b27 5661 6c75 6527 3a66 6561  ame({'Value':fea
+00036390: 7475 7265 5f69 6d70 6f72 7461 6e63 6573  ture_importances
+000363a0: 2c27 4665 6174 7572 6527 3a66 6561 7475  ,'Feature':featu
+000363b0: 7265 5f6e 616d 6573 7d29 0a20 2020 2020  re_names}).     
+000363c0: 2020 2020 2020 2020 2020 2065 6c73 653a             else:
+000363d0: 0a20 2020 2020 2020 2020 2020 2020 2020  .               
+000363e0: 2020 2020 2066 6561 7475 7265 5f69 6d70       feature_imp
+000363f0: 203d 2070 642e 636f 6e63 6174 285b 6665   = pd.concat([fe
+00036400: 6174 7572 655f 696d 702c 200a 2020 2020  ature_imp, .    
 00036410: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00036420: 2020 2020 2020 2020 2066 726f 6d20 696d           from im
-00036430: 6261 6c61 6e63 6564 5f65 6e73 656d 626c  balanced_ensembl
-00036440: 652e 656e 7365 6d62 6c65 2069 6d70 6f72  e.ensemble impor
-00036450: 7420 5365 6c66 5061 6365 6445 6e73 656d  t SelfPacedEnsem
-00036460: 626c 6543 6c61 7373 6966 6965 720a 2020  bleClassifier.  
-00036470: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00036480: 2020 2020 2020 2020 2020 2020 2020 7365                se
-00036490: 6c66 2e62 6173 655f 6573 7469 6d61 746f  lf.base_estimato
-000364a0: 7220 3d20 5365 6c66 5061 6365 6445 6e73  r = SelfPacedEns
-000364b0: 656d 626c 6543 6c61 7373 6966 6965 7228  embleClassifier(
-000364c0: 6e5f 6a6f 6273 3d2d 312c 2072 616e 646f  n_jobs=-1, rando
-000364d0: 6d5f 7374 6174 653d 7261 6e64 6f6d 5f73  m_state=random_s
-000364e0: 6565 6429 0a20 2020 2020 2020 2020 2020  eed).           
-000364f0: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00036500: 2065 7863 6570 743a 0a20 2020 2020 2020   except:.       
-00036510: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00036520: 2020 2020 2020 2020 2070 7269 6e74 2827           print('
-00036530: 7069 7020 696e 7374 616c 6c20 696d 6261  pip install imba
-00036540: 6c61 6e63 6564 5f65 6e73 656d 626c 6520  lanced_ensemble 
-00036550: 616e 6420 7265 2d72 756e 2074 6869 7320  and re-run this 
-00036560: 6167 6169 6e2e 2729 0a20 2020 2020 2020  again.').       
-00036570: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00036580: 2020 2020 2020 2020 2072 6574 7572 6e20           return 
-00036590: 7365 6c66 0a20 2020 2020 2020 2020 2020  self.           
-000365a0: 2020 2020 2020 2020 2020 2020 2020 2020                  
-000365b0: 2073 656c 662e 6d6f 6465 6c5f 6e61 6d65   self.model_name
-000365c0: 203d 2027 6f74 6865 7227 0a20 2020 2020   = 'other'.     
-000365d0: 2020 2020 2020 2020 2020 2020 2020 2020                  
-000365e0: 2020 2065 6c73 653a 0a20 2020 2020 2020     else:.       
-000365f0: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00036600: 2020 2020 2023 2323 2046 6f72 2062 696e       ### For bin
-00036610: 6172 792d 636c 6173 7320 7072 6f62 6c65  ary-class proble
-00036620: 6d73 2075 7365 2052 616e 646f 6d46 6f72  ms use RandomFor
-00036630: 6573 7420 6f72 2074 6865 2066 6173 7465  est or the faste
-00036640: 7220 4554 2043 6c61 7373 6966 6965 7220  r ET Classifier 
-00036650: 2323 2323 2323 0a20 2020 2020 2020 2020  ######.         
-00036660: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00036670: 2020 2069 6620 2858 2e64 7479 7065 733d     if (X.dtypes=
-00036680: 3d66 6c6f 6174 292e 616c 6c28 2920 616e  =float).all() an
-00036690: 6420 6c65 6e28 7365 6c66 2e66 6561 7475  d len(self.featu
-000366a0: 7265 7329 203c 3d20 6665 6174 7572 6573  res) <= features
-000366b0: 5f6c 696d 6974 3a0a 2020 2020 2020 2020  _limit:.        
-000366c0: 2020 2020 2020 2020 2020 2020 2020 2020                  
-000366d0: 2020 2020 2020 2020 7072 696e 7428 2720          print(' 
-000366e0: 2020 2053 656c 6563 7469 6e67 204c 6162     Selecting Lab
-000366f0: 656c 2050 726f 7061 6761 7469 6f6e 2073  el Propagation s
-00036700: 696e 6365 2069 7420 7769 6c6c 2077 6f72  ince it will wor
-00036710: 6b20 6772 6561 7420 666f 7220 7468 6973  k great for this
-00036720: 2064 6174 6173 6574 2e2e 2e27 290a 2020   dataset...').  
-00036730: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00036740: 2020 2020 2020 2020 2020 2020 2020 7072                pr
-00036750: 696e 7428 2720 2020 2020 2020 2068 6f77  int('        how
-00036760: 6576 6572 2069 7420 7769 6c6c 2073 6b65  ever it will ske
-00036770: 7720 7072 6f62 6162 696c 6974 6965 7320  w probabilities 
-00036780: 616e 6420 7368 6f77 206c 6f77 6572 2052  and show lower R
-00036790: 4f43 2041 5543 2073 636f 7265 2074 6861  OC AUC score tha
-000367a0: 6e20 6e6f 726d 616c 2e27 290a 2020 2020  n normal.').    
-000367b0: 2020 2020 2020 2020 2020 2020 2020 2020                  
-000367c0: 2020 2020 2020 2020 2020 2020 7365 6c66              self
-000367d0: 2e62 6173 655f 6573 7469 6d61 746f 7220  .base_estimator 
-000367e0: 3d20 204c 6162 656c 5072 6f70 6167 6174  =  LabelPropagat
-000367f0: 696f 6e28 290a 2020 2020 2020 2020 2020  ion().          
-00036800: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00036810: 2020 2020 2020 7365 6c66 2e6d 6f64 656c        self.model
-00036820: 5f6e 616d 6520 3d20 276c 7027 0a20 2020  _name = 'lp'.   
+00036420: 2020 2020 7064 2e44 6174 6146 7261 6d65      pd.DataFrame
+00036430: 287b 2756 616c 7565 273a 6665 6174 7572  ({'Value':featur
+00036440: 655f 696d 706f 7274 616e 6365 732c 2746  e_importances,'F
+00036450: 6561 7475 7265 273a 6665 6174 7572 655f  eature':feature_
+00036460: 6e61 6d65 737d 295d 2c20 6178 6973 3d30  names})], axis=0
+00036470: 290a 2020 2020 2020 2020 2020 2020 2020  ).              
+00036480: 2020 236c 6762 6d2e 706c 6f74 5f69 6d70    #lgbm.plot_imp
+00036490: 6f72 7461 6e63 6528 6d6f 6465 6c5f 6f62  ortance(model_ob
+000364a0: 6a65 6374 2c20 696d 706f 7274 616e 6365  ject, importance
+000364b0: 5f74 7970 653d 2767 6169 6e27 2c20 6d61  _type='gain', ma
+000364c0: 785f 6e75 6d5f 6665 6174 7572 6573 3d6d  x_num_features=m
+000364d0: 6178 5f66 6561 7475 7265 7329 0a20 2020  ax_features).   
+000364e0: 2020 2020 2020 2020 2066 6561 7475 7265           feature
+000364f0: 5f69 6d70 203d 2066 6561 7475 7265 5f69  _imp = feature_i
+00036500: 6d70 2e67 726f 7570 6279 2827 4665 6174  mp.groupby('Feat
+00036510: 7572 6527 292e 6d65 616e 2829 2e73 6f72  ure').mean().sor
+00036520: 745f 7661 6c75 6573 2827 5661 6c75 6527  t_values('Value'
+00036530: 2c61 7363 656e 6469 6e67 3d46 616c 7365  ,ascending=False
+00036540: 292e 7265 7365 745f 696e 6465 7828 290a  ).reset_index().
+00036550: 2020 2020 2020 2020 2020 2020 6665 6174              feat
+00036560: 7572 655f 696d 702e 7365 745f 696e 6465  ure_imp.set_inde
+00036570: 7828 2746 6561 7475 7265 2729 5b3a 6d61  x('Feature')[:ma
+00036580: 785f 6665 6174 7572 6573 5d2e 706c 6f74  x_features].plot
+00036590: 286b 696e 643d 2762 6172 6827 2c20 7469  (kind='barh', ti
+000365a0: 746c 653d 2754 6f70 2031 3020 4665 6174  tle='Top 10 Feat
+000365b0: 7572 6573 2729 0a20 2020 2020 2020 2020  ures').         
+000365c0: 2020 2023 2323 2054 6869 7320 6973 2066     ### This is f
+000365d0: 6f72 2058 4742 2023 2323 0a20 2020 2020  or XGB ###.     
+000365e0: 2020 2020 2020 2023 706c 6f74 5f69 6d70         #plot_imp
+000365f0: 6f72 7461 6e63 6528 7365 6c66 2e6d 6f64  ortance(self.mod
+00036600: 656c 2e6e 616d 6564 5f73 7465 7073 5b27  el.named_steps['
+00036610: 6d6f 6465 6c27 5d2c 2069 6d70 6f72 7461  model'], importa
+00036620: 6e63 655f 7479 7065 3d27 6761 696e 272c  nce_type='gain',
+00036630: 206d 6178 5f6e 756d 5f66 6561 7475 7265   max_num_feature
+00036640: 733d 6d61 785f 6665 6174 7572 6573 290a  s=max_features).
+00036650: 2020 2020 2020 2020 656c 6966 206d 6f64          elif mod
+00036660: 656c 5f6e 616d 6520 3d3d 2027 6c70 273a  el_name == 'lp':
+00036670: 0a20 2020 2020 2020 2020 2020 2070 7269  .            pri
+00036680: 6e74 2827 4e6f 2066 6561 7475 7265 2069  nt('No feature i
+00036690: 6d70 6f72 7461 6e63 6573 2061 7661 696c  mportances avail
+000366a0: 6162 6c65 2066 6f72 204c 6162 656c 5072  able for LabelPr
+000366b0: 6f70 6167 6174 696f 6e20 616c 676f 7269  opagation algori
+000366c0: 7468 6d2e 2052 6574 7572 6e69 6e67 2e2e  thm. Returning..
+000366d0: 2e27 290a 2020 2020 2020 2020 2020 2020  .').            
+000366e0: 7265 7475 726e 0a20 2020 2020 2020 2065  return.        e
+000366f0: 6c69 6620 6d6f 6465 6c5f 6e61 6d65 203d  lif model_name =
+00036700: 3d20 2772 6627 3a0a 2020 2020 2020 2020  = 'rf':.        
+00036710: 2020 2020 2323 2320 5468 6573 6520 6172      ### These ar
+00036720: 6520 666f 7220 5261 6e64 6f6d 466f 7265  e for RandomFore
+00036730: 7374 436c 6173 7369 6669 6572 206b 696e  stClassifier kin
+00036740: 6420 6f66 2073 6369 6b69 742d 6c65 6172  d of scikit-lear
+00036750: 6e20 6d6f 6465 6c73 2023 2323 0a20 2020  n models ###.   
+00036760: 2020 2020 2020 2020 2074 7279 3a0a 2020           try:.  
+00036770: 2020 2020 2020 2020 2020 2020 2020 666f                fo
+00036780: 7220 692c 206d 6f64 656c 2069 6e20 656e  r i, model in en
+00036790: 756d 6572 6174 6528 7365 6c66 2e6d 6f64  umerate(self.mod
+000367a0: 656c 7329 3a0a 2020 2020 2020 2020 2020  els):.          
+000367b0: 2020 2020 2020 2020 2020 6966 2073 656c            if sel
+000367c0: 662e 7069 7065 6c69 6e65 3a0a 2020 2020  f.pipeline:.    
+000367d0: 2020 2020 2020 2020 2020 2020 2020 2020                  
+000367e0: 2020 2020 6d6f 6465 6c5f 6f62 6a65 6374      model_object
+000367f0: 203d 206d 6f64 656c 2e6e 616d 6564 5f73   = model.named_s
+00036800: 7465 7073 5b27 6d6f 6465 6c27 5d0a 2020  teps['model'].  
+00036810: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00036820: 2020 656c 7365 3a0a 2020 2020 2020 2020    else:.        
 00036830: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00036840: 2020 2020 2020 2020 2065 6c73 653a 0a20           else:. 
-00036850: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00036860: 2020 2020 2020 2020 2020 2020 2020 2069                 i
-00036870: 6620 6c65 6e28 7365 6c66 2e66 6561 7475  f len(self.featu
-00036880: 7265 7329 203c 3d20 6665 6174 7572 6573  res) <= features
-00036890: 5f6c 696d 6974 3a0a 2020 2020 2020 2020  _limit:.        
-000368a0: 2020 2020 2020 2020 2020 2020 2020 2020                  
-000368b0: 2020 2020 2020 2020 2020 2020 6966 2073              if s
-000368c0: 656c 662e 7665 7262 6f73 653a 0a20 2020  elf.verbose:.   
-000368d0: 2020 2020 2020 2020 2020 2020 2020 2020                  
-000368e0: 2020 2020 2020 2020 2020 2020 2020 2020                  
-000368f0: 2020 2020 2070 7269 6e74 2827 2020 2020       print('    
-00036900: 5365 6c65 6374 696e 6720 4261 6767 696e  Selecting Baggin
-00036910: 6720 436c 6173 7369 6669 6572 2066 6f72  g Classifier for
-00036920: 2074 6869 7320 6461 7461 7365 742e 2e2e   this dataset...
-00036930: 2729 0a20 2020 2020 2020 2020 2020 2020  ').             
-00036940: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00036950: 2020 2020 2020 2023 2323 2054 6865 2042         ### The B
-00036960: 6167 6769 6e67 2063 6c61 7373 6966 6965  agging classifie
-00036970: 7220 6f75 7470 6572 666f 726d 7320 4554  r outperforms ET
-00036980: 4320 6d6f 7374 206f 6620 7468 6520 7469  C most of the ti
-00036990: 6d65 2023 2323 230a 2020 2020 2020 2020  me ####.        
-000369a0: 2020 2020 2020 2020 2020 2020 2020 2020                  
-000369b0: 2020 2020 2020 2020 2020 2020 4554 203d              ET =
-000369c0: 2045 7874 7261 5472 6565 436c 6173 7369   ExtraTreeClassi
-000369d0: 6669 6572 2829 0a20 2020 2020 2020 2020  fier().         
-000369e0: 2020 2020 2020 2020 2020 2020 2020 2020                  
-000369f0: 2020 2020 2020 2020 2020 2073 656c 662e             self.
-00036a00: 6261 7365 5f65 7374 696d 6174 6f72 203d  base_estimator =
-00036a10: 2042 6167 6769 6e67 436c 6173 7369 6669   BaggingClassifi
-00036a20: 6572 2862 6173 655f 6573 7469 6d61 746f  er(base_estimato
-00036a30: 723d 4554 2c20 6e5f 6a6f 6273 3d2d 3129  r=ET, n_jobs=-1)
-00036a40: 0a20 2020 2020 2020 2020 2020 2020 2020  .               
-00036a50: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00036a60: 2020 2020 2073 656c 662e 6d6f 6465 6c5f       self.model_
-00036a70: 6e61 6d65 203d 2027 6267 270a 2020 2020  name = 'bg'.    
-00036a80: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00036a90: 2020 2020 2020 2020 2020 2020 656c 7365              else
-00036aa0: 3a0a 2020 2020 2020 2020 2020 2020 2020  :.              
-00036ab0: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00036ac0: 2020 2020 2020 6966 2073 656c 662e 7665        if self.ve
-00036ad0: 7262 6f73 653a 0a20 2020 2020 2020 2020  rbose:.         
-00036ae0: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00036af0: 2020 2020 2020 2020 2020 2020 2020 2070                 p
-00036b00: 7269 6e74 2827 2020 2020 5365 6c65 6374  rint('    Select
-00036b10: 696e 6720 4c47 424d 2043 6c61 7373 6966  ing LGBM Classif
-00036b20: 6965 7220 6173 2062 6173 6520 6573 7469  ier as base esti
-00036b30: 6d61 746f 722e 2e2e 2729 0a20 2020 2020  mator...').     
-00036b40: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00036b50: 2020 2020 2020 2020 2020 2020 2020 2073                 s
-00036b60: 656c 662e 6261 7365 5f65 7374 696d 6174  elf.base_estimat
-00036b70: 6f72 203d 204c 4742 4d43 6c61 7373 6966  or = LGBMClassif
-00036b80: 6965 7228 6465 7669 6365 3d64 6576 6963  ier(device=devic
-00036b90: 652c 2072 616e 646f 6d5f 7374 6174 653d  e, random_state=
-00036ba0: 7261 6e64 6f6d 5f73 6565 642c 206e 5f6a  random_seed, n_j
-00036bb0: 6f62 733d 2d31 2c0a 2020 2020 2020 2020  obs=-1,.        
-00036bc0: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00036bd0: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00036be0: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00036bf0: 2020 2020 7363 616c 655f 706f 735f 7765      scale_pos_we
-00036c00: 6967 6874 3d73 6361 6c65 5f70 6f73 5f77  ight=scale_pos_w
-00036c10: 6569 6768 742c 290a 2020 2020 2020 2020  eight,).        
-00036c20: 2020 2020 2020 2020 2020 2020 656c 7365              else
-00036c30: 3a0a 2020 2020 2020 2020 2020 2020 2020  :.              
-00036c40: 2020 2020 2020 2020 2020 2323 2320 466f            ### Fo
-00036c50: 7220 4d75 6c74 692d 636c 6173 7320 6461  r Multi-class da
-00036c60: 7461 7365 7473 2079 6f75 2063 616e 2075  tasets you can u
-00036c70: 7365 2052 6567 7265 7373 6f72 7320 666f  se Regressors fo
-00036c80: 7220 6e75 6d65 7269 6320 636c 6173 7365  r numeric classe
-00036c90: 7320 2323 2323 2323 2323 2323 2323 2323  s ##############
-00036ca0: 2323 2323 2323 0a20 2020 2020 2020 2020  ######.         
-00036cb0: 2020 2020 2020 2020 2020 2020 2020 2069                 i
-00036cc0: 6620 7365 6c66 2e69 6d62 616c 616e 6365  f self.imbalance
-00036cd0: 643a 0a20 2020 2020 2020 2020 2020 2020  d:.             
-00036ce0: 2020 2020 2020 2020 2020 2020 2020 2069                 i
-00036cf0: 6620 7365 6c66 2e76 6572 626f 7365 3a0a  f self.verbose:.
-00036d00: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00036d10: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00036d20: 7072 696e 7428 2720 2020 2053 656c 6563  print('    Selec
-00036d30: 7469 6e67 2053 656c 6620 5061 6365 6420  ting Self Paced 
-00036d40: 656e 7365 6d62 6c65 2063 6c61 7373 6966  ensemble classif
-00036d50: 6965 7220 6173 2062 6173 6520 6573 7469  ier as base esti
-00036d60: 6d61 746f 722e 2e2e 2729 0a20 2020 2020  mator...').     
-00036d70: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00036d80: 2020 2020 2020 2074 7279 3a0a 2020 2020         try:.    
-00036d90: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00036da0: 2020 2020 2020 2020 2020 2020 6672 6f6d              from
-00036db0: 2069 6d62 616c 616e 6365 645f 656e 7365   imbalanced_ense
-00036dc0: 6d62 6c65 2e65 6e73 656d 626c 6520 696d  mble.ensemble im
-00036dd0: 706f 7274 2053 656c 6650 6163 6564 456e  port SelfPacedEn
-00036de0: 7365 6d62 6c65 436c 6173 7369 6669 6572  sembleClassifier
-00036df0: 0a20 2020 2020 2020 2020 2020 2020 2020  .               
-00036e00: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00036e10: 2073 656c 662e 6261 7365 5f65 7374 696d   self.base_estim
-00036e20: 6174 6f72 203d 2053 656c 6650 6163 6564  ator = SelfPaced
-00036e30: 456e 7365 6d62 6c65 436c 6173 7369 6669  EnsembleClassifi
-00036e40: 6572 286e 5f6a 6f62 733d 2d31 2c20 7261  er(n_jobs=-1, ra
-00036e50: 6e64 6f6d 5f73 7461 7465 3d72 616e 646f  ndom_state=rando
-00036e60: 6d5f 7365 6564 290a 2020 2020 2020 2020  m_seed).        
-00036e70: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00036e80: 2020 2020 6578 6365 7074 3a0a 2020 2020      except:.    
-00036e90: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00036ea0: 2020 2020 2020 2020 2020 2020 7072 696e              prin
-00036eb0: 7428 2770 6970 2069 6e73 7461 6c6c 2069  t('pip install i
-00036ec0: 6d62 616c 616e 6365 645f 656e 7365 6d62  mbalanced_ensemb
-00036ed0: 6c65 2061 6e64 2072 652d 7275 6e20 7468  le and re-run th
-00036ee0: 6973 2061 6761 696e 2e27 290a 2020 2020  is again.').    
-00036ef0: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00036f00: 2020 2020 2020 2020 2020 2020 7265 7475              retu
-00036f10: 726e 2073 656c 660a 2020 2020 2020 2020  rn self.        
-00036f20: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00036f30: 2020 2020 7365 6c66 2e6d 6f64 656c 5f6e      self.model_n
-00036f40: 616d 6520 3d20 276f 7468 6572 270a 2020  ame = 'other'.  
-00036f50: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00036f60: 2020 2020 2020 656c 7365 3a0a 2020 2020        else:.    
-00036f70: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00036f80: 2020 2020 2020 2020 2323 2320 466f 7220          ### For 
-00036f90: 6d75 6c74 692d 636c 6173 7320 7072 6f62  multi-class prob
-00036fa0: 6c65 6d73 2075 7365 204c 6162 656c 2050  lems use Label P
-00036fb0: 726f 7061 6761 7469 6f6e 2077 6869 6368  ropagation which
-00036fc0: 2069 7320 6661 7374 6572 2061 6e64 2062   is faster and b
-00036fd0: 6574 7465 7220 2323 0a20 2020 2020 2020  etter ##.       
-00036fe0: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00036ff0: 2020 2020 2069 6620 2858 2e64 7479 7065       if (X.dtype
-00037000: 733d 3d66 6c6f 6174 292e 616c 6c28 2920  s==float).all() 
-00037010: 616e 6420 6c65 6e28 7365 6c66 2e66 6561  and len(self.fea
-00037020: 7475 7265 7329 203c 3d20 6665 6174 7572  tures) <= featur
-00037030: 6573 5f6c 696d 6974 3a0a 2020 2020 2020  es_limit:.      
-00037040: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00037050: 2020 2020 2020 2020 2020 2020 2020 7072                pr
-00037060: 696e 7428 2720 2020 2053 656c 6563 7469  int('    Selecti
-00037070: 6e67 204c 6162 656c 2050 726f 7061 6761  ng Label Propaga
-00037080: 7469 6f6e 2073 696e 6365 2069 7420 7769  tion since it wi
-00037090: 6c6c 2077 6f72 6b20 6772 6561 7420 666f  ll work great fo
-000370a0: 7220 7468 6973 2064 6174 6173 6574 2e2e  r this dataset..
-000370b0: 2e27 290a 2020 2020 2020 2020 2020 2020  .').            
-000370c0: 2020 2020 2020 2020 2020 2020 2020 2020                  
-000370d0: 2020 2020 2020 2020 7072 696e 7428 2720          print(' 
-000370e0: 2020 2020 2020 2068 6f77 6576 6572 2069         however i
-000370f0: 7420 7769 6c6c 2073 6b65 7720 7072 6f62  t will skew prob
-00037100: 6162 696c 6974 6965 7320 616e 6420 7368  abilities and sh
-00037110: 6f77 206c 6f77 6572 2052 4f43 2041 5543  ow lower ROC AUC
-00037120: 2073 636f 7265 2074 6861 6e20 6e6f 726d   score than norm
-00037130: 616c 2e27 290a 2020 2020 2020 2020 2020  al.').          
-00037140: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00037150: 2020 2020 2020 2020 2020 7365 6c66 2e62            self.b
-00037160: 6173 655f 6573 7469 6d61 746f 7220 3d20  ase_estimator = 
-00037170: 204c 6162 656c 5072 6f70 6167 6174 696f   LabelPropagatio
-00037180: 6e28 290a 2020 2020 2020 2020 2020 2020  n().            
-00037190: 2020 2020 2020 2020 2020 2020 2020 2020                  
-000371a0: 2020 2020 2020 2020 7365 6c66 2e6d 6f64          self.mod
-000371b0: 656c 5f6e 616d 6520 3d20 276c 7027 0a20  el_name = 'lp'. 
-000371c0: 2020 2020 2020 2020 2020 2020 2020 2020                  
-000371d0: 2020 2020 2020 2020 2020 2065 6c73 653a             else:
-000371e0: 0a20 2020 2020 2020 2020 2020 2020 2020  .               
-000371f0: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00037200: 2069 6620 6c65 6e28 7365 6c66 2e66 6561   if len(self.fea
-00037210: 7475 7265 7329 203c 3d20 6665 6174 7572  tures) <= featur
-00037220: 6573 5f6c 696d 6974 3a0a 2020 2020 2020  es_limit:.      
-00037230: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00037240: 2020 2020 2020 2020 2020 2020 2020 6966                if
-00037250: 2073 656c 662e 7665 7262 6f73 653a 0a20   self.verbose:. 
-00037260: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00037270: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00037280: 2020 2020 2020 2070 7269 6e74 2827 2020         print('  
-00037290: 2020 5365 6c65 6374 696e 6720 4261 6767    Selecting Bagg
-000372a0: 696e 6720 436c 6173 7369 6669 6572 2066  ing Classifier f
-000372b0: 6f72 2074 6869 7320 6461 7461 7365 742e  or this dataset.
-000372c0: 2e2e 2729 0a20 2020 2020 2020 2020 2020  ..').           
-000372d0: 2020 2020 2020 2020 2020 2020 2020 2020                  
-000372e0: 2020 2020 2020 2020 2045 5420 3d20 4578           ET = Ex
-000372f0: 7472 6154 7265 6543 6c61 7373 6966 6965  traTreeClassifie
-00037300: 7228 290a 2020 2020 2020 2020 2020 2020  r().            
-00037310: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00037320: 2020 2020 2020 2020 7365 6c66 2e62 6173          self.bas
-00037330: 655f 6573 7469 6d61 746f 7220 3d20 4261  e_estimator = Ba
-00037340: 6767 696e 6743 6c61 7373 6966 6965 7228  ggingClassifier(
-00037350: 6261 7365 5f65 7374 696d 6174 6f72 3d45  base_estimator=E
-00037360: 542c 206e 5f6a 6f62 733d 2d31 290a 2020  T, n_jobs=-1).  
-00037370: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00037380: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00037390: 2020 7365 6c66 2e6d 6f64 656c 5f6e 616d    self.model_nam
-000373a0: 6520 3d20 2762 6727 0a20 2020 2020 2020  e = 'bg'.       
-000373b0: 2020 2020 2020 2020 2020 2020 2020 2020                  
-000373c0: 2020 2020 2020 2020 2065 6c73 653a 0a20           else:. 
-000373d0: 2020 2020 2020 2020 2020 2020 2020 2020                  
-000373e0: 2020 2020 2020 2020 2020 2020 2020 2020                  
-000373f0: 2020 2069 6620 7365 6c66 2e76 6572 626f     if self.verbo
-00037400: 7365 3a0a 2020 2020 2020 2020 2020 2020  se:.            
-00037410: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00037420: 2020 2020 2020 2020 2020 2020 7072 696e              prin
-00037430: 7428 2720 2020 2053 656c 6563 7469 6e67  t('    Selecting
-00037440: 204c 4742 4d20 436c 6173 7369 6669 6572   LGBM Classifier
-00037450: 2061 7320 6261 7365 2065 7374 696d 6174   as base estimat
-00037460: 6f72 2e2e 2e27 290a 2020 2020 2020 2020  or...').        
-00037470: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00037480: 2020 2020 2020 2020 2020 2020 7365 6c66              self
-00037490: 2e62 6173 655f 6573 7469 6d61 746f 7220  .base_estimator 
-000374a0: 3d20 4c47 424d 436c 6173 7369 6669 6572  = LGBMClassifier
-000374b0: 2864 6576 6963 653d 6465 7669 6365 2c20  (device=device, 
-000374c0: 7261 6e64 6f6d 5f73 7461 7465 3d72 616e  random_state=ran
-000374d0: 646f 6d5f 7365 6564 2c0a 2020 2020 2020  dom_seed,.      
-000374e0: 2020 2020 2020 2020 2020 2020 2020 2020                  
-000374f0: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00037500: 2020 2020 2020 2020 2020 2020 2020 6e5f                n_
-00037510: 6a6f 6273 3d2d 312c 0a20 2020 2020 2020  jobs=-1,.       
-00037520: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00037530: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00037540: 2020 2020 2020 2020 2020 2020 2023 6973               #is
-00037550: 5f75 6e62 616c 616e 6365 3d46 616c 7365  _unbalance=False
-00037560: 2c0a 2020 2020 2020 2020 2020 2020 2020  ,.              
-00037570: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00037580: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00037590: 2020 2020 2020 236c 6561 726e 696e 675f        #learning_
-000375a0: 7261 7465 3d30 2e33 2c0a 2020 2020 2020  rate=0.3,.      
-000375b0: 2020 2020 2020 2020 2020 2020 2020 2020                  
-000375c0: 2020 2020 2020 2020 2020 2020 2020 2020                  
-000375d0: 2020 2020 2020 2020 2020 2020 2020 236d                #m
-000375e0: 6178 5f64 6570 7468 3d31 302c 0a20 2020  ax_depth=10,.   
-000375f0: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00037600: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00037610: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00037620: 206d 6574 7269 633d 276d 756c 7469 5f6c   metric='multi_l
-00037630: 6f67 6c6f 7373 272c 0a20 2020 2020 2020  ogloss',.       
-00037640: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00037650: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00037660: 2020 2020 2020 2020 2020 2020 2023 6e5f               #n_
-00037670: 6573 7469 6d61 746f 7273 3d31 3330 2c20  estimators=130, 
-00037680: 6e75 6d5f 6c65 6176 6573 3d38 342c 0a20  num_leaves=84,. 
-00037690: 2020 2020 2020 2020 2020 2020 2020 2020                  
-000376a0: 2020 2020 2020 2020 2020 2020 2020 2020                  
-000376b0: 2020 2020 2020 2020 2020 2020 2020 2020                  
-000376c0: 2020 206e 756d 5f63 6c61 7373 3d6e 756d     num_class=num
-000376d0: 6265 725f 6f66 5f63 6c61 7373 6573 2c20  ber_of_classes, 
-000376e0: 6f62 6a65 6374 6976 653d 276d 756c 7469  objective='multi
-000376f0: 636c 6173 7327 2c0a 2020 2020 2020 2020  class',.        
-00037700: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00037710: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00037720: 2020 2020 2020 2020 2020 2020 2362 6f6f              #boo
-00037730: 7374 696e 675f 7479 7065 203d 2767 6f73  sting_type ='gos
-00037740: 7327 2c20 0a20 2020 2020 2020 2020 2020  s', .           
-00037750: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00037760: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00037770: 2020 2020 2020 2020 2023 7363 616c 655f           #scale_
-00037780: 706f 735f 7765 6967 6874 3d4e 6f6e 652c  pos_weight=None,
-00037790: 0a20 2020 2020 2020 2020 2020 2020 2020  .               
-000377a0: 2020 2020 2020 2020 2020 2020 2020 2020                  
-000377b0: 2020 2020 2020 2020 2020 2020 2020 2020                  
-000377c0: 2020 2020 2063 6c61 7373 5f77 6569 6768       class_weigh
-000377d0: 743d 636c 6173 735f 7765 6967 6874 730a  t=class_weights.
-000377e0: 2020 2020 2020 2020 2020 2020 2020 2020                  
-000377f0: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00037800: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00037810: 2020 2020 290a 2020 2020 2020 2020 2020      ).          
-00037820: 2020 2020 2020 656c 7365 3a0a 2020 2020        else:.    
-00037830: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00037840: 2323 2320 466f 7220 6c61 7267 6520 6461  ### For large da
-00037850: 7461 7365 7473 2075 7365 204c 4742 4d20  tasets use LGBM 
-00037860: 6f72 2052 6567 7265 7373 6f72 7320 6173  or Regressors as
-00037870: 2077 656c 6c20 2323 2323 2323 2323 2323   well ##########
-00037880: 2323 2323 2323 2323 2323 2323 2323 0a20  ##############. 
-00037890: 2020 2020 2020 2020 2020 2020 2020 2020                  
-000378a0: 2020 2069 6620 6e75 6d62 6572 5f6f 665f     if number_of_
-000378b0: 636c 6173 7365 7320 3c3d 2031 3a0a 2020  classes <= 1:.  
-000378c0: 2020 2020 2020 2020 2020 2020 2020 2020                  
-000378d0: 2020 2020 2020 6966 2073 656c 662e 696d        if self.im
-000378e0: 6261 6c61 6e63 6564 3a0a 2020 2020 2020  balanced:.      
-000378f0: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00037900: 2020 2020 2020 6966 2073 656c 662e 7665        if self.ve
-00037910: 7262 6f73 653a 0a20 2020 2020 2020 2020  rbose:.         
-00037920: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00037930: 2020 2020 2020 2070 7269 6e74 2827 2020         print('  
-00037940: 2020 5365 6c65 6374 696e 6720 5365 6c66    Selecting Self
-00037950: 2050 6163 6564 2065 6e73 656d 626c 6520   Paced ensemble 
-00037960: 636c 6173 7369 6669 6572 2061 7320 6261  classifier as ba
-00037970: 7365 2065 7374 696d 6174 6f72 2e2e 2e27  se estimator...'
-00037980: 290a 2020 2020 2020 2020 2020 2020 2020  ).              
-00037990: 2020 2020 2020 2020 2020 2020 2020 7472                tr
-000379a0: 793a 0a20 2020 2020 2020 2020 2020 2020  y:.             
-000379b0: 2020 2020 2020 2020 2020 2020 2020 2020                  
-000379c0: 2020 2066 726f 6d20 696d 6261 6c61 6e63     from imbalanc
-000379d0: 6564 5f65 6e73 656d 626c 652e 656e 7365  ed_ensemble.ense
-000379e0: 6d62 6c65 2069 6d70 6f72 7420 5365 6c66  mble import Self
-000379f0: 5061 6365 6445 6e73 656d 626c 6543 6c61  PacedEnsembleCla
-00037a00: 7373 6966 6965 720a 2020 2020 2020 2020  ssifier.        
-00037a10: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00037a20: 2020 2020 2020 2020 7365 6c66 2e62 6173          self.bas
-00037a30: 655f 6573 7469 6d61 746f 7220 3d20 5365  e_estimator = Se
-00037a40: 6c66 5061 6365 6445 6e73 656d 626c 6543  lfPacedEnsembleC
-00037a50: 6c61 7373 6966 6965 7228 6e5f 6a6f 6273  lassifier(n_jobs
-00037a60: 3d2d 312c 2072 616e 646f 6d5f 7374 6174  =-1, random_stat
-00037a70: 653d 7261 6e64 6f6d 5f73 6565 6429 0a20  e=random_seed). 
-00037a80: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00037a90: 2020 2020 2020 2020 2020 2065 7863 6570             excep
-00037aa0: 743a 0a20 2020 2020 2020 2020 2020 2020  t:.             
-00037ab0: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00037ac0: 2020 2070 7269 6e74 2827 7069 7020 696e     print('pip in
-00037ad0: 7374 616c 6c20 696d 6261 6c61 6e63 6564  stall imbalanced
-00037ae0: 5f65 6e73 656d 626c 6520 616e 6420 7265  _ensemble and re
-00037af0: 2d72 756e 2074 6869 7320 6167 6169 6e2e  -run this again.
-00037b00: 2729 0a20 2020 2020 2020 2020 2020 2020  ').             
-00037b10: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00037b20: 2020 2072 6574 7572 6e20 7365 6c66 0a20     return self. 
-00037b30: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00037b40: 2020 2020 2020 2020 2020 2073 656c 662e             self.
-00037b50: 6d6f 6465 6c5f 6e61 6d65 203d 2027 6f74  model_name = 'ot
-00037b60: 6865 7227 0a20 2020 2020 2020 2020 2020  her'.           
-00037b70: 2020 2020 2020 2020 2020 2020 2065 6c73               els
-00037b80: 653a 0a20 2020 2020 2020 2020 2020 2020  e:.             
-00037b90: 2020 2020 2020 2020 2020 2020 2020 2069                 i
-00037ba0: 6620 7365 6c66 2e76 6572 626f 7365 3a0a  f self.verbose:.
-00037bb0: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00037bc0: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00037bd0: 7072 696e 7428 2720 2020 2053 656c 6563  print('    Selec
-00037be0: 7469 6e67 204c 4742 4d20 436c 6173 7369  ting LGBM Classi
-00037bf0: 6669 6572 2066 6f72 2074 6869 7320 6461  fier for this da
-00037c00: 7461 7365 742e 2e2e 2729 0a20 2020 2020  taset...').     
-00037c10: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00037c20: 2020 2020 2020 2023 7365 6c66 2e62 6173         #self.bas
-00037c30: 655f 6573 7469 6d61 746f 7220 3d20 4c47  e_estimator = LG
-00037c40: 424d 436c 6173 7369 6669 6572 286e 5f65  BMClassifier(n_e
-00037c50: 7374 696d 6174 6f72 733d 3235 302c 2072  stimators=250, r
-00037c60: 616e 646f 6d5f 7374 6174 653d 7261 6e64  andom_state=rand
-00037c70: 6f6d 5f73 6565 642c 200a 2020 2020 2020  om_seed, .      
-00037c80: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00037c90: 2020 2020 2020 2320 2020 2020 2020 2020        #         
-00037ca0: 2020 2062 6f6f 7374 696e 675f 7479 7065     boosting_type
-00037cb0: 203d 2767 6f73 7327 2c20 7363 616c 655f   ='goss', scale_
-00037cc0: 706f 735f 7765 6967 6874 3d73 6361 6c65  pos_weight=scale
-00037cd0: 5f70 6f73 5f77 6569 6768 7429 0a20 2020  _pos_weight).   
+00036840: 6d6f 6465 6c5f 6f62 6a65 6374 203d 206d  model_object = m
+00036850: 6f64 656c 0a20 2020 2020 2020 2020 2020  odel.           
+00036860: 2020 2020 2020 2020 2066 6561 7475 7265           feature
+00036870: 5f69 6d70 6f72 7461 6e63 6573 203d 206d  _importances = m
+00036880: 6f64 656c 5f6f 626a 6563 742e 6665 6174  odel_object.feat
+00036890: 7572 655f 696d 706f 7274 616e 6365 735f  ure_importances_
+000368a0: 0a20 2020 2020 2020 2020 2020 2020 2020  .               
+000368b0: 2020 2020 2069 6620 6920 3d3d 2030 3a0a       if i == 0:.
+000368c0: 2020 2020 2020 2020 2020 2020 2020 2020                  
+000368d0: 2020 2020 2020 2020 6665 6174 7572 655f          feature_
+000368e0: 696d 7020 3d20 7064 2e44 6174 6146 7261  imp = pd.DataFra
+000368f0: 6d65 287b 2756 616c 7565 273a 6665 6174  me({'Value':feat
+00036900: 7572 655f 696d 706f 7274 616e 6365 732c  ure_importances,
+00036910: 2746 6561 7475 7265 273a 6665 6174 7572  'Feature':featur
+00036920: 655f 6e61 6d65 737d 290a 2020 2020 2020  e_names}).      
+00036930: 2020 2020 2020 2020 2020 2020 2020 656c                el
+00036940: 7365 3a0a 2020 2020 2020 2020 2020 2020  se:.            
+00036950: 2020 2020 2020 2020 2020 2020 6665 6174              feat
+00036960: 7572 655f 696d 7020 3d20 7064 2e63 6f6e  ure_imp = pd.con
+00036970: 6361 7428 5b66 6561 7475 7265 5f69 6d70  cat([feature_imp
+00036980: 2c20 0a20 2020 2020 2020 2020 2020 2020  , .             
+00036990: 2020 2020 2020 2020 2020 2020 2020 2070                 p
+000369a0: 642e 4461 7461 4672 616d 6528 7b27 5661  d.DataFrame({'Va
+000369b0: 6c75 6527 3a66 6561 7475 7265 5f69 6d70  lue':feature_imp
+000369c0: 6f72 7461 6e63 6573 2c27 4665 6174 7572  ortances,'Featur
+000369d0: 6527 3a66 6561 7475 7265 5f6e 616d 6573  e':feature_names
+000369e0: 7d29 5d2c 2061 7869 733d 3029 0a20 2020  })], axis=0).   
+000369f0: 2020 2020 2020 2020 2020 2020 2066 6561               fea
+00036a00: 7475 7265 5f69 6d70 203d 2066 6561 7475  ture_imp = featu
+00036a10: 7265 5f69 6d70 2e67 726f 7570 6279 2827  re_imp.groupby('
+00036a20: 4665 6174 7572 6527 292e 6d65 616e 2829  Feature').mean()
+00036a30: 2e73 6f72 745f 7661 6c75 6573 2827 5661  .sort_values('Va
+00036a40: 6c75 6527 2c61 7363 656e 6469 6e67 3d46  lue',ascending=F
+00036a50: 616c 7365 292e 7265 7365 745f 696e 6465  alse).reset_inde
+00036a60: 7828 290a 2020 2020 2020 2020 2020 2020  x().            
+00036a70: 2020 2020 6665 6174 7572 655f 696d 702e      feature_imp.
+00036a80: 7365 745f 696e 6465 7828 2746 6561 7475  set_index('Featu
+00036a90: 7265 2729 5b3a 6d61 785f 6665 6174 7572  re')[:max_featur
+00036aa0: 6573 5d2e 706c 6f74 286b 696e 643d 2762  es].plot(kind='b
+00036ab0: 6172 6827 2c20 7469 746c 653d 2754 6f70  arh', title='Top
+00036ac0: 2031 3020 4665 6174 7572 6573 2729 0a20   10 Features'). 
+00036ad0: 2020 2020 2020 2020 2020 2065 7863 6570             excep
+00036ae0: 743a 0a20 2020 2020 2020 2020 2020 2020  t:.             
+00036af0: 2020 2020 2020 2070 7269 6e74 2827 436f         print('Co
+00036b00: 756c 6420 6e6f 7420 706c 6f74 2066 6561  uld not plot fea
+00036b10: 7475 7265 2069 6d70 6f72 7461 6e63 6573  ture importances
+00036b20: 2e20 506c 6561 7365 2063 6865 636b 2079  . Please check y
+00036b30: 6f75 7220 6d6f 6465 6c20 616e 6420 7472  our model and tr
+00036b40: 7920 6167 6169 6e2e 2729 2020 2020 2020  y again.')      
+00036b50: 2020 2020 2020 2020 2020 0a20 2020 2020            .     
+00036b60: 2020 2065 6c73 653a 0a20 2020 2020 2020     else:.       
+00036b70: 2020 2020 2070 7269 6e74 2827 4e6f 2066       print('No f
+00036b80: 6561 7475 7265 2069 6d70 6f72 7461 6e63  eature importanc
+00036b90: 6573 2061 7661 696c 6162 6c65 2066 6f72  es available for
+00036ba0: 2074 6869 7320 616c 676f 7269 7468 6d2e   this algorithm.
+00036bb0: 2052 6574 7572 6e69 6e67 2e2e 2e27 290a   Returning...').
+00036bc0: 2020 2020 2020 2020 2020 2020 7265 7475              retu
+00036bd0: 726e 0a23 2323 2323 2323 2323 2323 2323  rn.#############
+00036be0: 2323 2323 2323 2323 2323 2323 2323 2323  ################
+00036bf0: 2323 2323 2323 2323 2323 2323 2323 2323  ################
+00036c00: 2323 2323 2323 2323 2323 2323 2323 2323  ################
+00036c10: 2323 2323 2323 2323 2323 2323 2323 2323  ################
+00036c20: 2323 2323 2323 2323 2323 2323 2323 2323  ################
+00036c30: 2323 2323 2323 2323 0a66 726f 6d20 736b  ########.from sk
+00036c40: 6c65 6172 6e2e 6d6f 6465 6c5f 7365 6c65  learn.model_sele
+00036c50: 6374 696f 6e20 696d 706f 7274 2053 7472  ction import Str
+00036c60: 6174 6966 6965 644b 466f 6c64 2c20 4b46  atifiedKFold, KF
+00036c70: 6f6c 642c 2052 6570 6561 7465 644b 466f  old, RepeatedKFo
+00036c80: 6c64 0a66 726f 6d20 736b 6c65 6172 6e2e  ld.from sklearn.
+00036c90: 6d6f 6465 6c5f 7365 6c65 6374 696f 6e20  model_selection 
+00036ca0: 696d 706f 7274 2052 616e 646f 6d69 7a65  import Randomize
+00036cb0: 6453 6561 7263 6843 560a 6465 6620 7261  dSearchCV.def ra
+00036cc0: 6e64 5f73 6561 7263 6828 6d6f 6465 6c2c  nd_search(model,
+00036cd0: 2058 2c20 792c 206d 6f64 656c 5f6e 616d   X, y, model_nam
+00036ce0: 652c 2070 6970 655f 666c 6167 3d46 616c  e, pipe_flag=Fal
+00036cf0: 7365 2c20 7363 6f72 696e 673d 4e6f 6e65  se, scoring=None
+00036d00: 2c20 7665 7262 6f73 653d 3029 3a0a 2020  , verbose=0):.  
+00036d10: 2020 7374 6172 7420 3d20 7469 6d65 2e74    start = time.t
+00036d20: 696d 6528 290a 2020 2020 6966 2070 6970  ime().    if pip
+00036d30: 655f 666c 6167 3a0a 2020 2020 2020 2020  e_flag:.        
+00036d40: 6d6f 6465 6c5f 7374 7269 6e67 203d 2027  model_string = '
+00036d50: 6d6f 6465 6c5f 5f27 0a20 2020 2065 6c73  model__'.    els
+00036d60: 653a 0a20 2020 2020 2020 206d 6f64 656c  e:.        model
+00036d70: 5f73 7472 696e 6720 3d20 2727 0a20 2020  _string = ''.   
+00036d80: 2023 2323 2073 6574 206e 5f69 7465 7220   ### set n_iter 
+00036d90: 6865 7265 2023 2323 230a 2020 2020 6966  here ####.    if
+00036da0: 2058 2e73 6861 7065 5b30 5d20 3c3d 2031   X.shape[0] <= 1
+00036db0: 3030 3030 3a0a 2020 2020 2020 2020 6e5f  0000:.        n_
+00036dc0: 6974 6572 203d 2031 300a 2020 2020 656c  iter = 10.    el
+00036dd0: 7365 3a0a 2020 2020 2020 2020 6e5f 6974  se:.        n_it
+00036de0: 6572 203d 2035 0a20 2020 2069 6620 6d6f  er = 5.    if mo
+00036df0: 6465 6c5f 6e61 6d65 203d 3d20 2772 6627  del_name == 'rf'
+00036e00: 3a0a 2020 2020 2020 2020 2363 7269 7465  :.        #crite
+00036e10: 7269 6f6e 203d 205b 2267 696e 6922 2c20  rion = ["gini", 
+00036e20: 2265 6e74 726f 7079 222c 2022 6c6f 675f  "entropy", "log_
+00036e30: 6c6f 7373 225d 0a20 2020 2020 2020 2023  loss"].        #
+00036e40: 204e 756d 6265 7220 6f66 2074 7265 6573   Number of trees
+00036e50: 2069 6e20 7261 6e64 6f6d 2066 6f72 6573   in random fores
+00036e60: 740a 2020 2020 2020 2020 6e5f 6573 7469  t.        n_esti
+00036e70: 6d61 746f 7273 203d 2073 705f 7261 6e64  mators = sp_rand
+00036e80: 496e 7428 3130 302c 2033 3030 290a 2020  Int(100, 300).  
+00036e90: 2020 2020 2020 2320 4e75 6d62 6572 206f        # Number o
+00036ea0: 6620 6665 6174 7572 6573 2074 6f20 636f  f features to co
+00036eb0: 6e73 6964 6572 2061 7420 6576 6572 7920  nsider at every 
+00036ec0: 7370 6c69 740a 2020 2020 2020 2020 6d61  split.        ma
+00036ed0: 785f 6665 6174 7572 6573 203d 205b 2761  x_features = ['a
+00036ee0: 7574 6f27 2c20 2773 7172 7427 2c20 276c  uto', 'sqrt', 'l
+00036ef0: 6f67 275d 0a20 2020 2020 2020 2023 204d  og'].        # M
+00036f00: 6178 696d 756d 206e 756d 6265 7220 6f66  aximum number of
+00036f10: 206c 6576 656c 7320 696e 2074 7265 650a   levels in tree.
+00036f20: 2020 2020 2020 2020 6d61 785f 6465 7074          max_dept
+00036f30: 6820 3d20 7370 5f72 616e 6449 6e74 2832  h = sp_randInt(2
+00036f40: 2c20 3130 290a 2020 2020 2020 2020 2320  , 10).        # 
+00036f50: 4d69 6e69 6d75 6d20 6e75 6d62 6572 206f  Minimum number o
+00036f60: 6620 7361 6d70 6c65 7320 7265 7175 6972  f samples requir
+00036f70: 6564 2074 6f20 7370 6c69 7420 6120 6e6f  ed to split a no
+00036f80: 6465 0a20 2020 2020 2020 206d 696e 5f73  de.        min_s
+00036f90: 616d 706c 6573 5f73 706c 6974 203d 2073  amples_split = s
+00036fa0: 705f 7261 6e64 496e 7428 322c 2031 3029  p_randInt(2, 10)
+00036fb0: 0a20 2020 2020 2020 2023 204d 696e 696d  .        # Minim
+00036fc0: 756d 206e 756d 6265 7220 6f66 2073 616d  um number of sam
+00036fd0: 706c 6573 2072 6571 7569 7265 6420 6174  ples required at
+00036fe0: 2065 6163 6820 6c65 6166 206e 6f64 650a   each leaf node.
+00036ff0: 2020 2020 2020 2020 6d69 6e5f 7361 6d70          min_samp
+00037000: 6c65 735f 6c65 6166 203d 2073 705f 7261  les_leaf = sp_ra
+00037010: 6e64 496e 7428 322c 2031 3029 0a20 2020  ndInt(2, 10).   
+00037020: 2020 2020 2023 204d 6574 686f 6420 6f66       # Method of
+00037030: 2073 656c 6563 7469 6e67 2073 616d 706c   selecting sampl
+00037040: 6573 2066 6f72 2074 7261 696e 696e 6720  es for training 
+00037050: 6561 6368 2074 7265 650a 2020 2020 2020  each tree.      
+00037060: 2020 626f 6f74 7374 7261 7020 3d20 5b54    bootstrap = [T
+00037070: 7275 652c 2046 616c 7365 5d0a 2020 2020  rue, False].    
+00037080: 2020 2020 2323 2320 2054 6865 7365 2061      ###  These a
+00037090: 7265 2074 6865 2052 616e 646f 6d46 6f72  re the RandomFor
+000370a0: 6573 7420 7061 7261 6d73 2023 2323 2323  est params #####
+000370b0: 2323 2320 2020 2020 2020 200a 2020 2020  ###        .    
+000370c0: 2020 2020 7061 7261 6d73 203d 207b 0a20      params = {. 
+000370d0: 2020 2020 2020 2020 2020 2023 6d6f 6465             #mode
+000370e0: 6c5f 7374 7269 6e67 2b27 6372 6974 6572  l_string+'criter
+000370f0: 696f 6e27 3a20 6372 6974 6572 696f 6e2c  ion': criterion,
+00037100: 0a20 2020 2020 2020 2020 2020 206d 6f64  .            mod
+00037110: 656c 5f73 7472 696e 672b 276e 5f65 7374  el_string+'n_est
+00037120: 696d 6174 6f72 7327 3a20 6e5f 6573 7469  imators': n_esti
+00037130: 6d61 746f 7273 2c0a 2020 2020 2020 2020  mators,.        
+00037140: 2020 2020 6d6f 6465 6c5f 7374 7269 6e67      model_string
+00037150: 2b27 6d61 785f 6665 6174 7572 6573 273a  +'max_features':
+00037160: 206d 6178 5f66 6561 7475 7265 732c 0a20   max_features,. 
+00037170: 2020 2020 2020 2020 2020 2023 6d6f 6465             #mode
+00037180: 6c5f 7374 7269 6e67 2b27 6d61 785f 6465  l_string+'max_de
+00037190: 7074 6827 3a20 6d61 785f 6465 7074 682c  pth': max_depth,
+000371a0: 0a20 2020 2020 2020 2020 2020 2023 6d6f  .            #mo
+000371b0: 6465 6c5f 7374 7269 6e67 2b27 6d69 6e5f  del_string+'min_
+000371c0: 7361 6d70 6c65 735f 7370 6c69 7427 3a20  samples_split': 
+000371d0: 6d69 6e5f 7361 6d70 6c65 735f 7370 6c69  min_samples_spli
+000371e0: 742c 0a20 2020 2020 2020 2020 2020 2023  t,.            #
+000371f0: 6d6f 6465 6c5f 7374 7269 6e67 2b27 6d69  model_string+'mi
+00037200: 6e5f 7361 6d70 6c65 735f 6c65 6166 273a  n_samples_leaf':
+00037210: 206d 696e 5f73 616d 706c 6573 5f6c 6561   min_samples_lea
+00037220: 662c 0a20 2020 2020 2020 2020 2020 236d  f,.           #m
+00037230: 6f64 656c 5f73 7472 696e 672b 2762 6f6f  odel_string+'boo
+00037240: 7473 7472 6170 273a 2062 6f6f 7473 7472  tstrap': bootstr
+00037250: 6170 2c0a 2020 2020 2020 2020 2020 2020  ap,.            
+00037260: 2020 2020 2020 2020 2020 207d 0a20 2020             }.   
+00037270: 2065 6c69 6620 6d6f 6465 6c5f 6e61 6d65   elif model_name
+00037280: 203d 3d20 2762 6727 3a0a 2020 2020 2020   == 'bg':.      
+00037290: 2020 6372 6974 6572 696f 6e20 3d20 5b22    criterion = ["
+000372a0: 6769 6e69 222c 2022 656e 7472 6f70 7922  gini", "entropy"
+000372b0: 2c20 226c 6f67 5f6c 6f73 7322 5d0a 2020  , "log_loss"].  
+000372c0: 2020 2020 2020 2320 4e75 6d62 6572 206f        # Number o
+000372d0: 6620 6261 7365 2065 7374 696d 6174 6f72  f base estimator
+000372e0: 7320 696e 2061 2042 6167 6769 6e67 2069  s in a Bagging i
+000372f0: 7320 7665 7279 2073 6d61 6c6c 200a 2020  s very small .  
+00037300: 2020 2020 2020 6e5f 6573 7469 6d61 746f        n_estimato
+00037310: 7273 203d 2073 705f 7261 6e64 496e 7428  rs = sp_randInt(
+00037320: 322c 3230 290a 2020 2020 2020 2020 2320  2,20).        # 
+00037330: 4e75 6d62 6572 206f 6620 6665 6174 7572  Number of featur
+00037340: 6573 2074 6f20 636f 6e73 6964 6572 2061  es to consider a
+00037350: 7420 6576 6572 7920 7370 6c69 740a 2020  t every split.  
+00037360: 2020 2020 2020 236d 6178 5f66 6561 7475        #max_featu
+00037370: 7265 7320 3d20 5b27 6175 746f 272c 2027  res = ['auto', '
+00037380: 7371 7274 272c 2027 6c6f 6727 5d0a 2020  sqrt', 'log'].  
+00037390: 2020 2020 2020 236d 6178 5f66 6561 7475        #max_featu
+000373a0: 7265 7320 3d20 7370 5f72 616e 6446 6c6f  res = sp_randFlo
+000373b0: 6174 2830 2e33 2c30 2e39 290a 2020 2020  at(0.3,0.9).    
+000373c0: 2020 2020 6d61 785f 6665 6174 7572 6573      max_features
+000373d0: 203d 205b 302e 332c 2030 2e36 2c20 312e   = [0.3, 0.6, 1.
+000373e0: 305d 0a20 2020 2020 2020 2023 204d 6178  0].        # Max
+000373f0: 696d 756d 206e 756d 6265 7220 6f66 206c  imum number of l
+00037400: 6576 656c 7320 696e 2074 7265 650a 2020  evels in tree.  
+00037410: 2020 2020 2020 6d61 785f 6465 7074 6820        max_depth 
+00037420: 3d20 7370 5f72 616e 6449 6e74 2832 2c20  = sp_randInt(2, 
+00037430: 3130 290a 2020 2020 2020 2020 2320 4d69  10).        # Mi
+00037440: 6e69 6d75 6d20 6e75 6d62 6572 206f 6620  nimum number of 
+00037450: 7361 6d70 6c65 7320 7265 7175 6972 6564  samples required
+00037460: 2074 6f20 7370 6c69 7420 6120 6e6f 6465   to split a node
+00037470: 0a20 2020 2020 2020 206d 696e 5f73 616d  .        min_sam
+00037480: 706c 6573 5f73 706c 6974 203d 2073 705f  ples_split = sp_
+00037490: 7261 6e64 496e 7428 322c 2031 3029 0a20  randInt(2, 10). 
+000374a0: 2020 2020 2020 2023 204d 696e 696d 756d         # Minimum
+000374b0: 206e 756d 6265 7220 6f66 2073 616d 706c   number of sampl
+000374c0: 6573 2072 6571 7569 7265 6420 6174 2065  es required at e
+000374d0: 6163 6820 6c65 6166 206e 6f64 650a 2020  ach leaf node.  
+000374e0: 2020 2020 2020 6d69 6e5f 7361 6d70 6c65        min_sample
+000374f0: 735f 6c65 6166 203d 2073 705f 7261 6e64  s_leaf = sp_rand
+00037500: 496e 7428 322c 2031 3029 0a20 2020 2020  Int(2, 10).     
+00037510: 2020 2023 204d 6574 686f 6420 6f66 2073     # Method of s
+00037520: 656c 6563 7469 6e67 2073 616d 706c 6573  electing samples
+00037530: 2066 6f72 2074 7261 696e 696e 6720 6561   for training ea
+00037540: 6368 2074 7265 650a 2020 2020 2020 2020  ch tree.        
+00037550: 626f 6f74 7374 7261 7020 3d20 5b54 7275  bootstrap = [Tru
+00037560: 652c 2046 616c 7365 5d0a 2020 2020 2020  e, False].      
+00037570: 2020 2323 2320 2054 6865 7365 2061 7265    ###  These are
+00037580: 2074 6865 2042 6167 6769 6e67 2070 6172   the Bagging par
+00037590: 616d 7320 2323 2323 2323 2323 0a20 2020  ams ########.   
+000375a0: 2020 2020 2070 6172 616d 7320 3d20 7b0a       params = {.
+000375b0: 2020 2020 2020 2020 2020 2020 236d 6f64              #mod
+000375c0: 656c 5f73 7472 696e 672b 2763 7269 7465  el_string+'crite
+000375d0: 7269 6f6e 273a 2063 7269 7465 7269 6f6e  rion': criterion
+000375e0: 2c0a 2020 2020 2020 2020 2020 2020 6d6f  ,.            mo
+000375f0: 6465 6c5f 7374 7269 6e67 2b27 6e5f 6573  del_string+'n_es
+00037600: 7469 6d61 746f 7273 273a 206e 5f65 7374  timators': n_est
+00037610: 696d 6174 6f72 732c 0a20 2020 2020 2020  imators,.       
+00037620: 2020 2020 206d 6f64 656c 5f73 7472 696e       model_strin
+00037630: 672b 276d 6178 5f66 6561 7475 7265 7327  g+'max_features'
+00037640: 3a20 6d61 785f 6665 6174 7572 6573 2c0a  : max_features,.
+00037650: 2020 2020 2020 2020 2020 2020 236d 6f64              #mod
+00037660: 656c 5f73 7472 696e 672b 276d 6178 5f64  el_string+'max_d
+00037670: 6570 7468 273a 206d 6178 5f64 6570 7468  epth': max_depth
+00037680: 2c0a 2020 2020 2020 2020 2020 2020 236d  ,.            #m
+00037690: 6f64 656c 5f73 7472 696e 672b 276d 696e  odel_string+'min
+000376a0: 5f73 616d 706c 6573 5f73 706c 6974 273a  _samples_split':
+000376b0: 206d 696e 5f73 616d 706c 6573 5f73 706c   min_samples_spl
+000376c0: 6974 2c0a 2020 2020 2020 2020 2020 2020  it,.            
+000376d0: 236d 6f64 656c 5f73 7472 696e 672b 276d  #model_string+'m
+000376e0: 696e 5f73 616d 706c 6573 5f6c 6561 6627  in_samples_leaf'
+000376f0: 3a20 6d69 6e5f 7361 6d70 6c65 735f 6c65  : min_samples_le
+00037700: 6166 2c0a 2020 2020 2020 2020 2020 2020  af,.            
+00037710: 236d 6f64 656c 5f73 7472 696e 672b 2762  #model_string+'b
+00037720: 6f6f 7473 7472 6170 273a 2062 6f6f 7473  ootstrap': boots
+00037730: 7472 6170 2c0a 2020 2020 2020 2020 2020  trap,.          
+00037740: 2020 236d 6f64 656c 5f73 7472 696e 672b    #model_string+
+00037750: 2762 6f6f 7473 7472 6170 5f66 6561 7475  'bootstrap_featu
+00037760: 7265 7327 3a20 626f 6f74 7374 7261 702c  res': bootstrap,
+00037770: 0a20 2020 2020 2020 2020 2020 2020 2020  .               
+00037780: 2020 2020 2020 2020 7d0a 2020 2020 656c          }.    el
+00037790: 6966 206d 6f64 656c 5f6e 616d 6520 3d3d  if model_name ==
+000377a0: 2027 6c67 6227 3a0a 2020 2020 2020 2020   'lgb':.        
+000377b0: 2320 4e75 6d62 6572 206f 6620 6573 7469  # Number of esti
+000377c0: 6d61 746f 7273 2069 6e20 4c47 424d 2043  mators in LGBM C
+000377d0: 6c61 7373 6966 6965 7220 2323 0a20 2020  lassifier ##.   
+000377e0: 2020 2020 206e 5f65 7374 696d 6174 6f72       n_estimator
+000377f0: 7320 3d20 7370 5f72 616e 6449 6e74 2831  s = sp_randInt(1
+00037800: 3030 2c20 3530 3029 0a20 2020 2020 2020  00, 500).       
+00037810: 2023 2323 206e 756d 6265 7220 6f66 206c   ### number of l
+00037820: 6561 7665 7320 6973 206f 6e6c 7920 666f  eaves is only fo
+00037830: 7220 4c47 424d 2023 2323 0a20 2020 2020  r LGBM ###.     
+00037840: 2020 206e 756d 5f6c 6561 7665 7320 3d20     num_leaves = 
+00037850: 7370 5f72 616e 6449 6e74 2835 2c20 3330  sp_randInt(5, 30
+00037860: 3029 0a20 2020 2020 2020 2023 2320 6c65  0).        ## le
+00037870: 6172 6e69 6e67 2072 6174 6520 6973 2076  arning rate is v
+00037880: 6572 7920 696d 706f 7274 616e 7420 666f  ery important fo
+00037890: 7220 4c47 424d 2023 230a 2020 2020 2020  r LGBM ##.      
+000378a0: 2020 6c65 6172 6e69 6e67 5f72 6174 6520    learning_rate 
+000378b0: 3d20 7370 2e73 7461 7473 2e75 6e69 666f  = sp.stats.unifo
+000378c0: 726d 2873 6361 6c65 3d31 290a 2020 2020  rm(scale=1).    
+000378d0: 2020 2020 7061 7261 6d73 203d 207b 0a20      params = {. 
+000378e0: 2020 2020 2020 2020 2020 206d 6f64 656c             model
+000378f0: 5f73 7472 696e 672b 276e 5f65 7374 696d  _string+'n_estim
+00037900: 6174 6f72 7327 3a20 6e5f 6573 7469 6d61  ators': n_estima
+00037910: 746f 7273 2c0a 2020 2020 2020 2020 2020  tors,.          
+00037920: 2020 236d 6f64 656c 5f73 7472 696e 672b    #model_string+
+00037930: 276e 756d 5f6c 6561 7665 7327 3a20 6e75  'num_leaves': nu
+00037940: 6d5f 6c65 6176 6573 2c0a 2020 2020 2020  m_leaves,.      
+00037950: 2020 2020 2020 6d6f 6465 6c5f 7374 7269        model_stri
+00037960: 6e67 2b27 6c65 6172 6e69 6e67 5f72 6174  ng+'learning_rat
+00037970: 6527 3a20 6c65 6172 6e69 6e67 5f72 6174  e': learning_rat
+00037980: 652c 0a20 2020 2020 2020 2020 2020 2020  e,.             
+00037990: 2020 2020 2020 207d 0a20 2020 2065 6c69         }.    eli
+000379a0: 6620 6d6f 6465 6c5f 6e61 6d65 203d 3d20  f model_name == 
+000379b0: 276c 7027 3a0a 2020 2020 2020 2020 7061  'lp':.        pa
+000379c0: 7261 6d73 203d 2020 7b0a 2020 2020 2020  rams =  {.      
+000379d0: 2020 2020 2020 2323 2320 446f 6e27 7420        ### Don't 
+000379e0: 6f76 6572 6c79 2063 6f6d 706c 6963 6174  overly complicat
+000379f0: 6520 7468 6973 2073 696d 706c 6520 6d6f  e this simple mo
+00037a00: 6465 6c2e 2049 7420 776f 726b 7320 6265  del. It works be
+00037a10: 7374 2077 6974 6820 6e6f 2074 756e 696e  st with no tunin
+00037a20: 6721 0a20 2020 2020 2020 2020 2020 206d  g!.            m
+00037a30: 6f64 656c 5f73 7472 696e 672b 2767 616d  odel_string+'gam
+00037a40: 6d61 273a 2073 705f 7261 6e64 496e 7428  ma': sp_randInt(
+00037a50: 302c 2033 3229 2c0a 2020 2020 2020 2020  0, 32),.        
+00037a60: 2020 2020 6d6f 6465 6c5f 7374 7269 6e67      model_string
+00037a70: 2b27 6b65 726e 656c 273a 205b 276b 6e6e  +'kernel': ['knn
+00037a80: 272c 2027 7262 6627 5d2c 0a20 2020 2020  ', 'rbf'],.     
+00037a90: 2020 2020 2020 2023 6d6f 6465 6c5f 7374         #model_st
+00037aa0: 7269 6e67 2b27 6d61 785f 6974 6572 273a  ring+'max_iter':
+00037ab0: 2073 705f 7261 6e64 496e 7428 3530 2c20   sp_randInt(50, 
+00037ac0: 3530 3029 2c0a 2020 2020 2020 2020 2020  500),.          
+00037ad0: 2020 236d 6f64 656c 5f73 7472 696e 672b    #model_string+
+00037ae0: 276e 5f6e 6569 6768 626f 7273 273a 2073  'n_neighbors': s
+00037af0: 705f 7261 6e64 496e 7428 322c 2035 292c  p_randInt(2, 5),
+00037b00: 0a20 2020 2020 2020 2020 2020 2020 2020  .               
+00037b10: 207d 0a20 2020 2065 6c73 653a 0a20 2020   }.    else:.   
+00037b20: 2020 2020 2023 2323 2053 696e 6365 2077       ### Since w
+00037b30: 6520 646f 6e27 7420 6b6e 6f77 2077 6861  e don't know wha
+00037b40: 7420 6d6f 6465 6c20 7769 6c6c 2062 6520  t model will be 
+00037b50: 7365 6e74 2c20 7765 2063 616e 6e6f 7420  sent, we cannot 
+00037b60: 7475 6e65 2069 7420 2323 0a20 2020 2020  tune it ##.     
+00037b70: 2020 2070 6172 616d 7320 3d20 7b7d 0a20     params = {}. 
+00037b80: 2020 2020 2020 2072 6574 7572 6e20 6d6f         return mo
+00037b90: 6465 6c0a 2020 2020 2323 2320 596f 7520  del.    ### You 
+00037ba0: 6d75 7374 206c 6561 7665 2052 616e 646f  must leave Rando
+00037bb0: 6d20 5374 6174 6520 6173 204e 6f6e 6520  m State as None 
+00037bc0: 7369 6e63 6520 7368 7566 666c 6520 6973  since shuffle is
+00037bd0: 2046 616c 7365 2e20 4f74 6865 7277 6973   False. Otherwis
+00037be0: 652c 2065 7272 6f72 2120 0a20 2020 206b  e, error! .    k
+00037bf0: 666f 6c64 203d 204b 466f 6c64 286e 5f73  fold = KFold(n_s
+00037c00: 706c 6974 733d 352c 2072 616e 646f 6d5f  plits=5, random_
+00037c10: 7374 6174 653d 4e6f 6e65 2c20 7368 7566  state=None, shuf
+00037c20: 666c 653d 4661 6c73 6529 0a20 2020 2069  fle=False).    i
+00037c30: 6620 7665 7262 6f73 653a 0a20 2020 2020  f verbose:.     
+00037c40: 2020 2070 7269 6e74 2822 4669 6e64 696e     print("Findin
+00037c50: 6720 6265 7374 2070 6172 616d 7320 666f  g best params fo
+00037c60: 7220 6261 7365 2065 7374 696d 6174 6f72  r base estimator
+00037c70: 2075 7369 6e67 2052 616e 646f 6d69 7a65   using Randomize
+00037c80: 6453 6561 7263 6843 562e 2e2e 2229 0a20  dSearchCV..."). 
+00037c90: 2020 2063 6c66 203d 2052 616e 646f 6d69     clf = Randomi
+00037ca0: 7a65 6453 6561 7263 6843 5628 6d6f 6465  zedSearchCV(mode
+00037cb0: 6c2c 2070 6172 616d 732c 206e 5f69 7465  l, params, n_ite
+00037cc0: 723d 6e5f 6974 6572 2c20 7363 6f72 696e  r=n_iter, scorin
+00037cd0: 673d 7363 6f72 696e 672c 0a20 2020 2020  g=scoring,.     
 00037ce0: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00037cf0: 2020 2020 2020 2020 2073 656c 662e 6261           self.ba
-00037d00: 7365 5f65 7374 696d 6174 6f72 203d 204c  se_estimator = L
-00037d10: 4742 4d43 6c61 7373 6966 6965 7228 6465  GBMClassifier(de
-00037d20: 7669 6365 3d64 6576 6963 652c 2072 616e  vice=device, ran
-00037d30: 646f 6d5f 7374 6174 653d 7261 6e64 6f6d  dom_state=random
-00037d40: 5f73 6565 642c 0a20 2020 2020 2020 2020  _seed,.         
-00037d50: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00037d60: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00037d70: 2020 2020 2020 2020 2020 206e 5f6a 6f62             n_job
-00037d80: 733d 2d31 2c0a 2020 2020 2020 2020 2020  s=-1,.          
-00037d90: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00037da0: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00037db0: 2020 2020 2020 2020 2020 2369 735f 756e            #is_un
-00037dc0: 6261 6c61 6e63 653d 5472 7565 2c0a 2020  balance=True,.  
-00037dd0: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00037de0: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00037df0: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00037e00: 2020 236c 6561 726e 696e 675f 7261 7465    #learning_rate
-00037e10: 3d30 2e33 2c20 0a20 2020 2020 2020 2020  =0.3, .         
-00037e20: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00037e30: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00037e40: 2020 2020 2020 2020 2020 2023 6d61 785f             #max_
-00037e50: 6465 7074 683d 3130 2c20 0a20 2020 2020  depth=10, .     
-00037e60: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00037e70: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00037e80: 2020 2020 2020 2020 2020 2020 2020 2023                 #
-00037e90: 6d65 7472 6963 3d6d 6574 7269 632c 0a20  metric=metric,. 
-00037ea0: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00037eb0: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00037ec0: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00037ed0: 2020 2023 6e5f 6573 7469 6d61 746f 7273     #n_estimators
-00037ee0: 3d32 3330 2c20 6e75 6d5f 6c65 6176 6573  =230, num_leaves
-00037ef0: 3d38 342c 200a 2020 2020 2020 2020 2020  =84, .          
-00037f00: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00037f10: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00037f20: 2020 2020 2020 2020 2020 236e 756d 5f63            #num_c
-00037f30: 6c61 7373 3d6e 756d 6265 725f 6f66 5f63  lass=number_of_c
-00037f40: 6c61 7373 6573 2c0a 2020 2020 2020 2020  lasses,.        
-00037f50: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00037f60: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00037f70: 2020 2020 2020 2020 2020 2020 236f 626a              #obj
-00037f80: 6563 7469 7665 3d27 6269 6e61 7279 272c  ective='binary',
-00037f90: 0a20 2020 2020 2020 2020 2020 2020 2020  .               
-00037fa0: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00037fb0: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00037fc0: 2020 2020 2023 626f 6f73 7469 6e67 5f74       #boosting_t
-00037fd0: 7970 6520 3d27 676f 7373 272c 200a 2020  ype ='goss', .  
-00037fe0: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00037ff0: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00038000: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00038010: 2020 7363 616c 655f 706f 735f 7765 6967    scale_pos_weig
-00038020: 6874 3d73 6361 6c65 5f70 6f73 5f77 6569  ht=scale_pos_wei
-00038030: 6768 740a 2020 2020 2020 2020 2020 2020  ght.            
-00038040: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00038050: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00038060: 2020 2020 2020 2020 290a 2020 2020 2020          ).      
-00038070: 2020 2020 2020 2020 2020 2020 2020 656c                el
-00038080: 7365 3a0a 2020 2020 2020 2020 2020 2020  se:.            
-00038090: 2020 2020 2020 2020 2020 2020 2323 2320              ### 
-000380a0: 466f 7220 4d75 6c74 692d 636c 6173 7320  For Multi-class 
-000380b0: 6461 7461 7365 7473 2079 6f75 2063 616e  datasets you can
-000380c0: 2075 7365 2052 6567 7265 7373 6f72 7320   use Regressors 
-000380d0: 666f 7220 6e75 6d65 7269 6320 636c 6173  for numeric clas
-000380e0: 7365 7320 2323 2323 2323 2323 2323 2323  ses ############
-000380f0: 2323 2323 2323 2323 0a20 2020 2020 2020  ########.       
-00038100: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00038110: 2069 6620 7365 6c66 2e69 6d62 616c 616e   if self.imbalan
-00038120: 6365 643a 0a20 2020 2020 2020 2020 2020  ced:.           
-00038130: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00038140: 2069 6620 7365 6c66 2e76 6572 626f 7365   if self.verbose
-00038150: 3a0a 2020 2020 2020 2020 2020 2020 2020  :.              
-00038160: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00038170: 2020 7072 696e 7428 2720 2020 2053 656c    print('    Sel
-00038180: 6563 7469 6e67 2053 656c 6620 5061 6365  ecting Self Pace
-00038190: 6420 656e 7365 6d62 6c65 2063 6c61 7373  d ensemble class
-000381a0: 6966 6965 7220 6173 2062 6173 6520 6573  ifier as base es
-000381b0: 7469 6d61 746f 722e 2e2e 2729 0a20 2020  timator...').   
-000381c0: 2020 2020 2020 2020 2020 2020 2020 2020                  
-000381d0: 2020 2020 2020 2020 2074 7279 3a0a 2020           try:.  
-000381e0: 2020 2020 2020 2020 2020 2020 2020 2020                  
-000381f0: 2020 2020 2020 2020 2020 2020 2020 6672                fr
-00038200: 6f6d 2069 6d62 616c 616e 6365 645f 656e  om imbalanced_en
-00038210: 7365 6d62 6c65 2e65 6e73 656d 626c 6520  semble.ensemble 
-00038220: 696d 706f 7274 2053 656c 6650 6163 6564  import SelfPaced
-00038230: 456e 7365 6d62 6c65 436c 6173 7369 6669  EnsembleClassifi
-00038240: 6572 0a20 2020 2020 2020 2020 2020 2020  er.             
-00038250: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00038260: 2020 2073 656c 662e 6261 7365 5f65 7374     self.base_est
-00038270: 696d 6174 6f72 203d 2053 656c 6650 6163  imator = SelfPac
-00038280: 6564 456e 7365 6d62 6c65 436c 6173 7369  edEnsembleClassi
-00038290: 6669 6572 286e 5f6a 6f62 733d 2d31 2c20  fier(n_jobs=-1, 
-000382a0: 7261 6e64 6f6d 5f73 7461 7465 3d72 616e  random_state=ran
-000382b0: 646f 6d5f 7365 6564 290a 2020 2020 2020  dom_seed).      
-000382c0: 2020 2020 2020 2020 2020 2020 2020 2020                  
-000382d0: 2020 2020 2020 6578 6365 7074 3a0a 2020        except:.  
-000382e0: 2020 2020 2020 2020 2020 2020 2020 2020                  
-000382f0: 2020 2020 2020 2020 2020 2020 2020 7072                pr
-00038300: 696e 7428 2770 6970 2069 6e73 7461 6c6c  int('pip install
-00038310: 2069 6d62 616c 616e 6365 645f 656e 7365   imbalanced_ense
-00038320: 6d62 6c65 2061 6e64 2072 652d 7275 6e20  mble and re-run 
-00038330: 7468 6973 2061 6761 696e 2e27 290a 2020  this again.').  
-00038340: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00038350: 2020 2020 2020 2020 2020 2020 2020 7265                re
-00038360: 7475 726e 2073 656c 660a 2020 2020 2020  turn self.      
-00038370: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00038380: 2020 2020 2020 7365 6c66 2e6d 6f64 656c        self.model
-00038390: 5f6e 616d 6520 3d20 276f 7468 6572 270a  _name = 'other'.
-000383a0: 2020 2020 2020 2020 2020 2020 2020 2020                  
-000383b0: 2020 2020 2020 2020 656c 7365 3a0a 2020          else:.  
-000383c0: 2020 2020 2020 2020 2020 2020 2020 2020                  
-000383d0: 2020 2020 2020 2020 2020 2369 6620 7365            #if se
-000383e0: 6c66 2e77 6569 6768 7473 3a0a 2020 2020  lf.weights:.    
-000383f0: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00038400: 2020 2020 2020 2020 2320 2020 2063 6c61          #    cla
-00038410: 7373 5f77 6569 6768 7473 203d 204e 6f6e  ss_weights = Non
-00038420: 650a 2020 2020 2020 2020 2020 2020 2020  e.              
-00038430: 2020 2020 2020 2020 2020 2020 2020 6966                if
-00038440: 2073 656c 662e 7665 7262 6f73 653a 0a20   self.verbose:. 
-00038450: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00038460: 2020 2020 2020 2020 2020 2020 2020 2070                 p
-00038470: 7269 6e74 2827 2020 2020 5365 6c65 6374  rint('    Select
-00038480: 696e 6720 4c47 424d 2043 6c61 7373 6966  ing LGBM Classif
-00038490: 6965 7220 6173 2062 6173 6520 6573 7469  ier as base esti
-000384a0: 6d61 746f 722e 2e2e 2729 0a20 2020 2020  mator...').     
-000384b0: 2020 2020 2020 2020 2020 2020 2020 2020                  
-000384c0: 2020 2020 2020 2073 656c 662e 6261 7365         self.base
-000384d0: 5f65 7374 696d 6174 6f72 203d 204c 4742  _estimator = LGB
-000384e0: 4d43 6c61 7373 6966 6965 7228 6465 7669  MClassifier(devi
-000384f0: 6365 3d64 6576 6963 652c 2072 616e 646f  ce=device, rando
-00038500: 6d5f 7374 6174 653d 7261 6e64 6f6d 5f73  m_state=random_s
-00038510: 6565 642c 0a20 2020 2020 2020 2020 2020  eed,.           
-00038520: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00038530: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00038540: 2020 2020 2020 2020 206e 5f6a 6f62 733d           n_jobs=
-00038550: 2d31 2c0a 2020 2020 2020 2020 2020 2020  -1,.            
-00038560: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00038570: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00038580: 2020 2020 2020 2020 2369 735f 756e 6261          #is_unba
-00038590: 6c61 6e63 653d 4661 6c73 652c 206c 6561  lance=False, lea
-000385a0: 726e 696e 675f 7261 7465 3d30 2e33 2c0a  rning_rate=0.3,.
-000385b0: 2020 2020 2020 2020 2020 2020 2020 2020                  
-000385c0: 2020 2020 2020 2020 2020 2020 2020 2020                  
-000385d0: 2020 2020 2020 2020 2020 2020 2020 2020                  
-000385e0: 2020 2020 236d 6178 5f64 6570 7468 3d31      #max_depth=1
-000385f0: 302c 200a 2020 2020 2020 2020 2020 2020  0, .            
-00038600: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00038610: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00038620: 2020 2020 2020 2020 6d65 7472 6963 3d27          metric='
-00038630: 6d75 6c74 695f 6c6f 676c 6f73 7327 2c0a  multi_logloss',.
-00038640: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00038650: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00038660: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00038670: 2020 2020 236e 5f65 7374 696d 6174 6f72      #n_estimator
-00038680: 733d 3233 302c 206e 756d 5f6c 6561 7665  s=230, num_leave
-00038690: 733d 3834 2c0a 2020 2020 2020 2020 2020  s=84,.          
-000386a0: 2020 2020 2020 2020 2020 2020 2020 2020                  
-000386b0: 2020 2020 2020 2020 2020 2020 2020 2020                  
-000386c0: 2020 2020 2020 2020 2020 6e75 6d5f 636c            num_cl
-000386d0: 6173 733d 6e75 6d62 6572 5f6f 665f 636c  ass=number_of_cl
-000386e0: 6173 7365 732c 206f 626a 6563 7469 7665  asses, objective
-000386f0: 3d27 6d75 6c74 6963 6c61 7373 272c 0a20  ='multiclass',. 
-00038700: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00038710: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00038720: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00038730: 2020 2023 626f 6f73 7469 6e67 5f74 7970     #boosting_typ
-00038740: 6520 3d27 676f 7373 272c 200a 2020 2020  e ='goss', .    
-00038750: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00038760: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00038770: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00038780: 7363 616c 655f 706f 735f 7765 6967 6874  scale_pos_weight
-00038790: 3d4e 6f6e 652c 0a20 2020 2020 2020 2020  =None,.         
-000387a0: 2020 2020 2020 2020 2020 2020 2020 2020                  
-000387b0: 2020 2020 2020 2020 2020 2020 2020 2020                  
-000387c0: 2020 2020 2020 2020 2020 2063 6c61 7373             class
-000387d0: 5f77 6569 6768 743d 636c 6173 735f 7765  _weight=class_we
-000387e0: 6967 6874 730a 2020 2020 2020 2020 2020  ights.          
-000387f0: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00038800: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00038810: 2020 2020 2020 2020 2020 290a 2020 2020            ).    
-00038820: 2020 2020 2020 2020 656c 7365 3a0a 2020          else:.  
-00038830: 2020 2020 2020 2020 2020 2020 2020 7365                se
-00038840: 6c66 2e6d 6f64 656c 5f6e 616d 6520 3d20  lf.model_name = 
-00038850: 276f 7468 6572 270a 0a0a 2020 2020 2020  'other'...      
-00038860: 2020 2020 2020 2320 5370 6c69 7420 6461        # Split da
-00038870: 7461 2069 6e74 6f20 7472 6169 6e20 616e  ta into train an
-00038880: 6420 7465 7374 2062 6173 6564 206f 6e20  d test based on 
-00038890: 666f 6c64 7320 2020 2020 2020 2020 200a  folds          .
-000388a0: 2020 2020 2020 2020 2020 2020 6966 2069              if i
-000388b0: 7369 6e73 7461 6e63 6528 792c 2070 642e  sinstance(y, pd.
-000388c0: 5365 7269 6573 2920 6f72 2069 7369 6e73  Series) or isins
-000388d0: 7461 6e63 6528 792c 2070 642e 4461 7461  tance(y, pd.Data
-000388e0: 4672 616d 6529 3a0a 2020 2020 2020 2020  Frame):.        
-000388f0: 2020 2020 2020 2020 795f 7472 6169 6e2c          y_train,
-00038900: 2079 5f74 6573 7420 3d20 792e 696c 6f63   y_test = y.iloc
-00038910: 5b74 7261 696e 5f69 6e64 6578 5d2c 2079  [train_index], y
-00038920: 2e69 6c6f 635b 7465 7374 5f69 6e64 6578  .iloc[test_index
-00038930: 5d20 2020 2020 2020 2020 2020 2020 2020  ]               
-00038940: 200a 2020 2020 2020 2020 2020 2020 656c   .            el
-00038950: 7365 3a0a 2020 2020 2020 2020 2020 2020  se:.            
-00038960: 2020 2020 795f 7472 6169 6e2c 2079 5f74      y_train, y_t
-00038970: 6573 7420 3d20 795b 7472 6169 6e5f 696e  est = y[train_in
-00038980: 6465 785d 2c20 795b 7465 7374 5f69 6e64  dex], y[test_ind
-00038990: 6578 5d0a 0a20 2020 2020 2020 2020 2020  ex]..           
-000389a0: 2069 6620 6973 696e 7374 616e 6365 2858   if isinstance(X
-000389b0: 2c20 7064 2e44 6174 6146 7261 6d65 293a  , pd.DataFrame):
-000389c0: 0a20 2020 2020 2020 2020 2020 2020 2020  .               
-000389d0: 2078 5f74 7261 696e 2c20 785f 7465 7374   x_train, x_test
-000389e0: 203d 2058 2e69 6c6f 635b 7472 6169 6e5f   = X.iloc[train_
-000389f0: 696e 6465 785d 2c20 582e 696c 6f63 5b74  index], X.iloc[t
-00038a00: 6573 745f 696e 6465 785d 0a20 2020 2020  est_index].     
-00038a10: 2020 2020 2020 2065 6c73 653a 0a20 2020         else:.   
-00038a20: 2020 2020 2020 2020 2020 2020 2078 5f74               x_t
-00038a30: 7261 696e 2c20 785f 7465 7374 203d 2058  rain, x_test = X
-00038a40: 5b74 7261 696e 5f69 6e64 6578 5d2c 2058  [train_index], X
-00038a50: 5b74 6573 745f 696e 6465 785d 0a0a 2020  [test_index]..  
-00038a60: 2020 2020 2020 2020 2020 0a20 2020 2020            .     
-00038a70: 2020 2020 2020 2023 2320 2020 736d 616c         ##   smal
-00038a80: 6c20 6461 7461 7365 7473 2070 726f 6365  l datasets proce
-00038a90: 7373 696e 6720 2323 2323 230a 2020 2020  ssing #####.    
-00038aa0: 2020 2020 2020 2020 6966 2069 203d 3d20          if i == 
-00038ab0: 303a 0a20 2020 2020 2020 2020 2020 2020  0:.             
-00038ac0: 2020 2069 6620 7365 6c66 2e70 6970 656c     if self.pipel
-00038ad0: 696e 653a 0a20 2020 2020 2020 2020 2020  ine:.           
-00038ae0: 2020 2020 2020 2020 2023 2054 7261 696e           # Train
-00038af0: 206d 6f64 656c 2061 6e64 2075 7365 2069   model and use i
-00038b00: 7420 696e 2061 2070 6970 656c 696e 6520  t in a pipeline 
-00038b10: 746f 2074 7261 696e 206f 6e20 7468 6520  to train on the 
-00038b20: 666f 6c64 2020 2323 0a20 2020 2020 2020  fold  ##.       
-00038b30: 2020 2020 2020 2020 2020 2020 2070 6970               pip
-00038b40: 6520 3d20 5069 7065 6c69 6e65 280a 2020  e = Pipeline(.  
-00038b50: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00038b60: 2020 2020 2020 7374 6570 733d 5b28 2270        steps=[("p
-00038b70: 7265 7072 6f63 6573 736f 7222 2c20 7072  reprocessor", pr
-00038b80: 6570 726f 6365 7373 6f72 292c 2028 226d  eprocessor), ("m
-00038b90: 6f64 656c 222c 2073 656c 662e 6261 7365  odel", self.base
-00038ba0: 5f65 7374 696d 6174 6f72 295d 290a 2020  _estimator)]).  
-00038bb0: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00038bc0: 2020 6966 2073 656c 662e 6d6f 6465 6c5f    if self.model_
-00038bd0: 6e61 6d65 203d 3d20 276f 7468 6572 273a  name == 'other':
-00038be0: 0a20 2020 2020 2020 2020 2020 2020 2020  .               
-00038bf0: 2020 2020 2020 2020 2070 7269 6e74 2827           print('
-00038c00: 4e6f 2048 5054 2074 756e 696e 6720 7065  No HPT tuning pe
-00038c10: 7266 6f72 6d65 6420 7369 6e63 6520 6261  rformed since ba
-00038c20: 7365 2065 7374 696d 6174 6f72 2069 7320  se estimator is 
-00038c30: 6769 7665 6e20 6279 2069 6e70 7574 2e2e  given by input..
-00038c40: 2e27 290a 2020 2020 2020 2020 2020 2020  .').            
-00038c50: 2020 2020 2020 2020 2020 2020 7365 6c66              self
-00038c60: 2e62 6173 655f 6573 7469 6d61 746f 7220  .base_estimator 
-00038c70: 3d20 636f 7079 2e64 6565 7063 6f70 7928  = copy.deepcopy(
-00038c80: 7069 7065 290a 2020 2020 2020 2020 2020  pipe).          
-00038c90: 2020 2020 2020 2020 2020 656c 7365 3a0a            else:.
-00038ca0: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00038cb0: 2020 2020 2020 2020 6966 206c 656e 2873          if len(s
-00038cc0: 656c 662e 6665 6174 7572 6573 2920 3c3d  elf.features) <=
-00038cd0: 2066 6561 7475 7265 735f 6c69 6d69 743a   features_limit:
-00038ce0: 0a20 2020 2020 2020 2020 2020 2020 2020  .               
-00038cf0: 2020 2020 2020 2020 2020 2020 2073 656c               sel
-00038d00: 662e 6261 7365 5f65 7374 696d 6174 6f72  f.base_estimator
-00038d10: 203d 2072 616e 645f 7365 6172 6368 2870   = rand_search(p
-00038d20: 6970 652c 2078 5f74 7261 696e 2c20 795f  ipe, x_train, y_
-00038d30: 7472 6169 6e2c 200a 2020 2020 2020 2020  train, .        
-00038d40: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00038d50: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00038d60: 2020 2020 2020 2020 2020 2020 7365 6c66              self
-00038d70: 2e6d 6f64 656c 5f6e 616d 652c 2073 656c  .model_name, sel
-00038d80: 662e 7069 7065 6c69 6e65 2c20 7363 6f72  f.pipeline, scor
-00038d90: 696e 672c 2076 6572 626f 7365 3d73 656c  ing, verbose=sel
-00038da0: 662e 7665 7262 6f73 6529 0a20 2020 2020  f.verbose).     
-00038db0: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00038dc0: 2020 2065 6c73 653a 0a20 2020 2020 2020     else:.       
-00038dd0: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00038de0: 2020 2020 2070 7269 6e74 2827 4e6f 2048       print('No H
-00038df0: 5054 2074 756e 696e 6720 7065 7266 6f72  PT tuning perfor
-00038e00: 6d65 6420 7369 6e63 6520 6e75 6d62 6572  med since number
-00038e10: 206f 6620 6665 6174 7572 6573 2069 7320   of features is 
-00038e20: 746f 6f20 6c61 7267 652e 2e2e 2729 0a20  too large...'). 
-00038e30: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00038e40: 2020 2020 2020 2020 2020 2073 656c 662e             self.
-00038e50: 6261 7365 5f65 7374 696d 6174 6f72 203d  base_estimator =
-00038e60: 2063 6f70 792e 6465 6570 636f 7079 2870   copy.deepcopy(p
-00038e70: 6970 6529 0a20 2020 2020 2020 2020 2020  ipe).           
-00038e80: 2020 2020 2065 6c73 653a 0a20 2020 2020       else:.     
-00038e90: 2020 2020 2020 2020 2020 2020 2020 2023                 #
-00038ea0: 2323 2054 6869 7320 6973 2066 6f72 2077  ## This is for w
-00038eb0: 6974 686f 7574 2061 2070 6970 656c 696e  ithout a pipelin
-00038ec0: 6520 2323 2323 2323 230a 2020 2020 2020  e #######.      
-00038ed0: 2020 2020 2020 2020 2020 2020 2020 6966                if
-00038ee0: 2073 656c 662e 6d6f 6465 6c5f 6e61 6d65   self.model_name
-00038ef0: 203d 3d20 276f 7468 6572 273a 0a20 2020   == 'other':.   
-00038f00: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00038f10: 2020 2020 2023 2323 206c 6561 7665 2074       ### leave t
-00038f20: 6865 2062 6173 6520 6573 7469 6d61 746f  he base estimato
-00038f30: 7220 6173 2069 7320 2323 230a 2020 2020  r as is ###.    
-00038f40: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00038f50: 2020 2020 7072 696e 7428 274e 6f20 4850      print('No HP
-00038f60: 5420 7475 6e69 6e67 2070 6572 666f 726d  T tuning perform
-00038f70: 6564 2073 696e 6365 2062 6173 6520 6573  ed since base es
-00038f80: 7469 6d61 746f 7220 6973 2067 6976 656e  timator is given
-00038f90: 2062 7920 696e 7075 742e 2e2e 2729 0a20   by input...'). 
-00038fa0: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00038fb0: 2020 2065 6c73 653a 0a20 2020 2020 2020     else:.       
-00038fc0: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00038fd0: 2069 6620 6c65 6e28 7365 6c66 2e66 6561   if len(self.fea
-00038fe0: 7475 7265 7329 203c 3d20 6665 6174 7572  tures) <= featur
-00038ff0: 6573 5f6c 696d 6974 3a0a 2020 2020 2020  es_limit:.      
-00039000: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00039010: 2020 2020 2020 2323 2320 6c65 6176 6520        ### leave 
-00039020: 7468 6520 6261 7365 2065 7374 696d 6174  the base estimat
-00039030: 6f72 2061 7320 6973 2023 2323 0a20 2020  or as is ###.   
-00039040: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00039050: 2020 2020 2020 2020 2073 656c 662e 6261           self.ba
-00039060: 7365 5f65 7374 696d 6174 6f72 203d 2072  se_estimator = r
-00039070: 616e 645f 7365 6172 6368 2873 656c 662e  and_search(self.
-00039080: 6261 7365 5f65 7374 696d 6174 6f72 2c20  base_estimator, 
-00039090: 785f 7472 6169 6e2c 200a 2020 2020 2020  x_train, .      
-000390a0: 2020 2020 2020 2020 2020 2020 2020 2020                  
-000390b0: 2020 2020 2020 2020 2020 2020 2020 2020                  
-000390c0: 2020 2020 2020 2020 2020 795f 7472 6169            y_trai
-000390d0: 6e2c 2073 656c 662e 6d6f 6465 6c5f 6e61  n, self.model_na
-000390e0: 6d65 2c20 7365 6c66 2e70 6970 656c 696e  me, self.pipelin
-000390f0: 652c 2073 636f 7269 6e67 2c20 7665 7262  e, scoring, verb
-00039100: 6f73 653d 7365 6c66 2e76 6572 626f 7365  ose=self.verbose
-00039110: 290a 2020 2020 2020 2020 2020 2020 2020  ).              
-00039120: 2020 2020 2020 2020 2020 656c 7365 3a0a            else:.
-00039130: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00039140: 2020 2020 2020 2020 2020 2020 7072 696e              prin
-00039150: 7428 274e 6f20 4850 5420 7475 6e69 6e67  t('No HPT tuning
-00039160: 2070 6572 666f 726d 6564 2073 696e 6365   performed since
-00039170: 206e 756d 6265 7220 6f66 2066 6561 7475   number of featu
-00039180: 7265 7320 6973 2074 6f6f 206c 6172 6765  res is too large
-00039190: 2e2e 2e27 290a 0a20 2020 2020 2020 2020  ...')..         
-000391a0: 2020 2020 2020 2065 7374 5f6c 6973 7420         est_list 
-000391b0: 3d20 6e75 6d5f 6974 6572 6174 696f 6e73  = num_iterations
-000391c0: 2a5b 7365 6c66 2e62 6173 655f 6573 7469  *[self.base_esti
-000391d0: 6d61 746f 725d 0a20 2020 2020 2020 2020  mator].         
-000391e0: 2020 2020 2020 2023 7072 696e 7428 2720         #print(' 
-000391f0: 2020 2062 6173 6520 6573 7469 6d61 746f     base estimato
-00039200: 7220 3d20 2573 2720 2573 656c 662e 6261  r = %s' %self.ba
-00039210: 7365 5f65 7374 696d 6174 6f72 290a 2020  se_estimator).  
-00039220: 2020 2020 2020 2020 2020 0a20 2020 2020            .     
-00039230: 2020 2020 2020 2023 2049 6e69 7469 616c         # Initial
-00039240: 697a 6520 6d6f 6465 6c20 7769 7468 2079  ize model with y
-00039250: 6f75 7220 7375 7065 7276 6973 6564 2061  our supervised a
-00039260: 6c67 6f72 6974 686d 206f 6620 6368 6f69  lgorithm of choi
-00039270: 6365 0a20 2020 2020 2020 2020 2020 206d  ce.            m
-00039280: 6f64 656c 203d 2065 7374 5f6c 6973 745b  odel = est_list[
-00039290: 695d 0a20 2020 2020 2020 2020 2020 200a  i].            .
-000392a0: 2020 2020 2020 2020 2020 2020 6d6f 6465              mode
-000392b0: 6c2e 6669 7428 785f 7472 6169 6e2c 2079  l.fit(x_train, y
-000392c0: 5f74 7261 696e 290a 2020 2020 2020 2020  _train).        
-000392d0: 2020 2020 7365 6c66 2e6d 6f64 656c 732e      self.models.
-000392e0: 6170 7065 6e64 286d 6f64 656c 290a 2020  append(model).  
-000392f0: 2020 2020 2020 2020 2020 0a20 2020 2020            .     
-00039300: 2020 2020 2020 2023 2050 7265 6469 6374         # Predict
-00039310: 206f 6e20 7265 6d61 696e 696e 6720 6461   on remaining da
-00039320: 7461 206f 6620 6561 6368 2066 6f6c 640a  ta of each fold.
-00039330: 2020 2020 2020 2020 2020 2020 7072 6564              pred
-00039340: 7320 3d20 6d6f 6465 6c2e 7072 6564 6963  s = model.predic
-00039350: 7428 785f 7465 7374 290a 0a20 2020 2020  t(x_test)..     
-00039360: 2020 2020 2020 2023 2055 7365 2062 6573         # Use bes
-00039370: 7420 636c 6173 7369 6669 6361 7469 6f6e  t classification
-00039380: 206d 6574 7269 6320 746f 206d 6561 7375   metric to measu
-00039390: 7265 2070 6572 666f 726d 616e 6365 206f  re performance o
-000393a0: 6620 6d6f 6465 6c0a 0a20 2020 2020 2020  f model..       
-000393b0: 2020 2020 2069 6620 7365 6c66 2e69 6d62       if self.imb
-000393c0: 616c 616e 6365 643a 0a20 2020 2020 2020  alanced:.       
-000393d0: 2020 2020 2020 2020 2023 2323 2055 7365           ### Use
-000393e0: 2052 6567 7265 7373 696f 6e20 7072 6564   Regression pred
-000393f0: 6963 7469 6f6e 7320 616e 6420 636f 6e76  ictions and conv
-00039400: 6572 7420 7468 656d 2069 6e74 6f20 636c  ert them into cl
-00039410: 6173 7365 7320 6865 7265 2023 230a 2020  asses here ##.  
-00039420: 2020 2020 2020 2020 2020 2020 2020 7363                sc
-00039430: 6f72 6520 3d20 7072 696e 745f 7375 6c6f  ore = print_sulo
-00039440: 5f61 6363 7572 6163 7928 795f 7465 7374  _accuracy(y_test
-00039450: 2c20 7072 6564 732c 2079 5f70 726f 6261  , preds, y_proba
-00039460: 733d 2222 2c20 7665 7262 6f73 653d 7365  s="", verbose=se
-00039470: 6c66 2e76 6572 626f 7365 290a 2020 2020  lf.verbose).    
-00039480: 2020 2020 2020 2020 2020 2020 6966 2073              if s
-00039490: 656c 662e 7665 7262 6f73 653a 0a20 2020  elf.verbose:.   
-000394a0: 2020 2020 2020 2020 2020 2020 2020 2020                  
-000394b0: 2020 2020 2070 7269 6e74 2822 2020 2020       print("    
-000394c0: 466f 6c64 2025 733a 206f 7574 2d6f 662d  Fold %s: out-of-
-000394d0: 666f 6c64 2062 616c 616e 6365 6420 6163  fold balanced ac
-000394e0: 6375 7261 6379 3a20 2530 2e31 6625 2522  curacy: %0.1f%%"
-000394f0: 2025 2869 2b31 2c20 3130 302a 7363 6f72   %(i+1, 100*scor
-00039500: 6529 290a 2020 2020 2020 2020 2020 2020  e)).            
-00039510: 656c 7365 3a0a 2020 2020 2020 2020 2020  else:.          
-00039520: 2020 2020 2020 2373 636f 7265 203d 2062        #score = b
-00039530: 616c 616e 6365 645f 6163 6375 7261 6379  alanced_accuracy
-00039540: 5f73 636f 7265 2879 5f74 6573 742c 2070  _score(y_test, p
-00039550: 7265 6473 290a 2020 2020 2020 2020 2020  reds).          
-00039560: 2020 2020 2020 7363 6f72 6520 3d20 7072        score = pr
-00039570: 696e 745f 6163 6375 7261 6379 2874 6172  int_accuracy(tar
-00039580: 6765 7473 2c20 795f 7465 7374 2c20 7072  gets, y_test, pr
-00039590: 6564 732c 2076 6572 626f 7365 3d73 656c  eds, verbose=sel
-000395a0: 662e 7665 7262 6f73 6529 0a20 2020 2020  f.verbose).     
-000395b0: 2020 2020 2020 2020 2020 2069 6620 7365             if se
-000395c0: 6c66 2e76 6572 626f 7365 3a0a 2020 2020  lf.verbose:.    
-000395d0: 2020 2020 2020 2020 2020 2020 2020 2020                  
-000395e0: 2020 2020 7072 696e 7428 2220 2020 2046      print("    F
-000395f0: 6f6c 6420 2573 3a20 6f75 742d 6f66 2d66  old %s: out-of-f
-00039600: 6f6c 6420 6261 6c61 6e63 6564 2061 6363  old balanced acc
-00039610: 7572 6163 793a 2025 302e 3166 2525 2220  uracy: %0.1f%%" 
-00039620: 2528 692b 312c 2031 3030 2a73 636f 7265  %(i+1, 100*score
-00039630: 2929 0a20 2020 2020 2020 2020 2020 2073  )).            s
-00039640: 656c 662e 7363 6f72 6573 2e61 7070 656e  elf.scores.appen
-00039650: 6428 7363 6f72 6529 0a0a 2020 2020 2020  d(score)..      
-00039660: 2020 2020 2020 6920 2b3d 2031 0a0a 2020        i += 1..  
-00039670: 2020 2020 2020 2320 436f 6d70 7574 6520        # Compute 
-00039680: 6176 6572 6167 6520 7363 6f72 650a 2020  average score.  
-00039690: 2020 2020 2020 6176 6572 6167 6541 6363        averageAcc
-000396a0: 7572 6163 7920 3d20 7375 6d28 7365 6c66  uracy = sum(self
-000396b0: 2e73 636f 7265 7329 2f6c 656e 2873 656c  .scores)/len(sel
-000396c0: 662e 7363 6f72 6573 290a 2020 2020 2020  f.scores).      
-000396d0: 2020 7072 696e 7428 2246 696e 616c 2062    print("Final b
-000396e0: 616c 616e 6365 6420 4163 6375 7261 6379  alanced Accuracy
-000396f0: 206f 6620 2573 2d65 7374 696d 6174 6f72   of %s-estimator
-00039700: 2053 756c 6f43 6c61 7373 6966 6965 723a   SuloClassifier:
-00039710: 2025 302e 3166 2525 2220 2528 6e75 6d5f   %0.1f%%" %(num_
-00039720: 6974 6572 6174 696f 6e73 2c20 3130 302a  iterations, 100*
-00039730: 6176 6572 6167 6541 6363 7572 6163 7929  averageAccuracy)
-00039740: 290a 0a20 2020 2020 2020 2023 2046 696e  )..        # Fin
-00039750: 616c 6c79 2c20 6368 6563 6b20 6f75 7420  ally, check out 
-00039760: 7468 6520 746f 7461 6c20 7469 6d65 2074  the total time t
-00039770: 616b 656e 0a20 2020 2020 2020 2065 6e64  aken.        end
-00039780: 203d 2074 696d 652e 7469 6d65 2829 0a20   = time.time(). 
-00039790: 2020 2020 2020 2074 696d 6554 616b 656e         timeTaken
-000397a0: 203d 2065 6e64 2d73 7461 7274 0a20 2020   = end-start.   
-000397b0: 2020 2020 2070 7269 6e74 2822 5469 6d65       print("Time
-000397c0: 2054 616b 656e 3a20 2530 2e30 6620 2873   Taken: %0.0f (s
-000397d0: 6563 6f6e 6473 2922 2025 7469 6d65 5461  econds)" %timeTa
-000397e0: 6b65 6e29 0a20 2020 2020 2020 2073 656c  ken).        sel
-000397f0: 662e 6b66 203d 206b 666f 6c64 0a20 2020  f.kf = kfold.   
-00039800: 2020 2020 2072 6574 7572 6e20 7365 6c66       return self
-00039810: 0a0a 2020 2020 6465 6620 7072 6564 6963  ..    def predic
-00039820: 7428 7365 6c66 2c20 5829 3a0a 2020 2020  t(self, X):.    
-00039830: 2020 2020 6672 6f6d 2073 6369 7079 2069      from scipy i
-00039840: 6d70 6f72 7420 7374 6174 730a 2020 2020  mport stats.    
-00039850: 2020 2020 7765 6967 6874 7320 3d20 7365      weights = se
-00039860: 6c66 2e73 636f 7265 730a 2020 2020 2020  lf.scores.      
-00039870: 2020 6966 2073 656c 662e 6d75 6c74 695f    if self.multi_
-00039880: 6c61 6265 6c3a 0a20 2020 2020 2020 2020  label:.         
-00039890: 2020 2023 2323 2049 6e20 6d75 6c74 692d     ### In multi-
-000398a0: 6c61 6265 6c2c 2074 6172 6765 7473 2068  label, targets h
-000398b0: 6176 6520 746f 2062 6520 6e75 6d65 7269  ave to be numeri
-000398c0: 632c 2073 6f20 796f 7520 6361 6e20 6c65  c, so you can le
-000398d0: 6176 6520 7765 6967 6874 7320 6173 2d69  ave weights as-i
-000398e0: 7320 2323 0a20 2020 2020 2020 2020 2020  s ##.           
-000398f0: 2079 7072 6520 3d20 6e70 2e61 7272 6179   ypre = np.array
-00039900: 285b 6d6f 6465 6c2e 7072 6564 6963 7428  ([model.predict(
-00039910: 5829 2066 6f72 206d 6f64 656c 2069 6e20  X) for model in 
-00039920: 7365 6c66 2e6d 6f64 656c 7320 5d29 0a20  self.models ]). 
-00039930: 2020 2020 2020 2020 2020 2079 5f70 7265             y_pre
-00039940: 6469 7320 3d20 6e70 2e61 7665 7261 6765  dis = np.average
-00039950: 2879 7072 652c 2061 7869 733d 302c 2077  (ypre, axis=0, w
-00039960: 6569 6768 7473 3d77 6569 6768 7473 290a  eights=weights).
-00039970: 2020 2020 2020 2020 2020 2020 795f 7072              y_pr
-00039980: 6564 7320 3d20 6e70 2e72 6f75 6e64 2879  eds = np.round(y
-00039990: 5f70 7265 6469 732c 3029 2e61 7374 7970  _predis,0).astyp
-000399a0: 6528 696e 7429 0a20 2020 2020 2020 2020  e(int).         
-000399b0: 2020 2072 6574 7572 6e20 795f 7072 6564     return y_pred
-000399c0: 730a 2020 2020 2020 2020 795f 7072 6564  s.        y_pred
-000399d0: 6973 203d 206e 702e 636f 6c75 6d6e 5f73  is = np.column_s
-000399e0: 7461 636b 285b 6d6f 6465 6c2e 7072 6564  tack([model.pred
-000399f0: 6963 7428 5829 2066 6f72 206d 6f64 656c  ict(X) for model
-00039a00: 2069 6e20 7365 6c66 2e6d 6f64 656c 7320   in self.models 
-00039a10: 5d29 0a20 2020 2020 2020 2023 2323 2054  ]).        ### T
-00039a20: 6869 7320 7765 6967 6874 7320 7468 6520  his weights the 
-00039a30: 6d6f 6465 6c27 7320 7072 6564 6963 7469  model's predicti
-00039a40: 6f6e 7320 6163 636f 7264 696e 6720 746f  ons according to
-00039a50: 204f 4f42 2073 636f 7265 7320 6f62 7461   OOB scores obta
-00039a60: 696e 6564 0a20 2020 2020 2020 2023 2323  ined.        ###
-00039a70: 2320 496e 2073 696e 676c 6520 6c61 6265  # In single labe
-00039a80: 6c2c 2074 6172 6765 7473 2063 616e 2062  l, targets can b
-00039a90: 6520 6f62 6a65 6374 206f 7220 7374 7269  e object or stri
-00039aa0: 6e67 2c20 736f 2077 6569 6768 7473 2063  ng, so weights c
-00039ab0: 616e 6e6f 7420 6265 2061 7070 6c69 6564  annot be applied
-00039ac0: 2061 6c77 6179 7320 2323 0a20 2020 2020   always ##.     
-00039ad0: 2020 2069 6620 795f 7072 6564 6973 2e64     if y_predis.d
-00039ae0: 7479 7065 203d 3d20 6f62 6a65 6374 206f  type == object o
-00039af0: 7220 795f 7072 6564 6973 2e64 7479 7065  r y_predis.dtype
-00039b00: 203d 3d20 626f 6f6c 3a0a 2020 2020 2020   == bool:.      
-00039b10: 2020 2020 2020 2323 2320 696e 2074 6865        ### in the
-00039b20: 2063 6173 6520 6f66 2070 7265 6469 6374   case of predict
-00039b30: 696f 6e73 2074 6861 7420 6172 6520 7374  ions that are st
-00039b40: 7269 6e67 732c 206e 6f20 6e65 6564 2066  rings, no need f
-00039b50: 6f72 2077 6569 6768 7473 2023 230a 2020  or weights ##.  
-00039b60: 2020 2020 2020 2020 2020 795f 7072 6564            y_pred
-00039b70: 6973 203d 2073 7461 7473 2e6d 6f64 6528  is = stats.mode(
-00039b80: 795f 7072 6564 6973 2c20 6178 6973 3d31  y_predis, axis=1
-00039b90: 295b 305d 2e72 6176 656c 2829 0a20 2020  )[0].ravel().   
-00039ba0: 2020 2020 2065 6c73 653a 0a20 2020 2020       else:.     
-00039bb0: 2020 2020 2020 2069 6620 7374 7228 795f         if str(y_
-00039bc0: 7072 6564 6973 2e64 7479 7065 2920 3d3d  predis.dtype) ==
-00039bd0: 2027 6361 7465 676f 7279 273a 0a20 2020   'category':.   
-00039be0: 2020 2020 2020 2020 2020 2020 2079 5f70               y_p
-00039bf0: 7265 6469 7320 3d20 7374 6174 732e 6d6f  redis = stats.mo
-00039c00: 6465 2879 5f70 7265 6469 732c 2061 7869  de(y_predis, axi
-00039c10: 733d 3129 5b30 5d2e 7261 7665 6c28 290a  s=1)[0].ravel().
-00039c20: 2020 2020 2020 2020 2020 2020 656c 7365              else
-00039c30: 3a0a 2020 2020 2020 2020 2020 2020 2020  :.              
-00039c40: 2020 795f 7072 6564 6973 203d 206e 702e    y_predis = np.
-00039c50: 6176 6572 6167 6528 795f 7072 6564 6973  average(y_predis
-00039c60: 2c20 7765 6967 6874 733d 7765 6967 6874  , weights=weight
-00039c70: 732c 2061 7869 733d 3129 0a20 2020 2020  s, axis=1).     
-00039c80: 2020 2020 2020 2020 2020 2079 5f70 7265             y_pre
-00039c90: 6469 7320 3d20 6e70 2e72 6f75 6e64 2879  dis = np.round(y
-00039ca0: 5f70 7265 6469 732c 3029 2e61 7374 7970  _predis,0).astyp
-00039cb0: 6528 696e 7429 0a20 2020 2020 2020 2069  e(int).        i
-00039cc0: 6620 7365 6c66 2e69 6d62 616c 616e 6365  f self.imbalance
-00039cd0: 643a 0a20 2020 2020 2020 2020 2020 2079  d:.            y
-00039ce0: 5f70 7265 6469 7320 3d20 636f 7079 2e64  _predis = copy.d
-00039cf0: 6565 7063 6f70 7928 795f 7072 6564 6973  eepcopy(y_predis
-00039d00: 290a 2020 2020 2020 2020 7265 7475 726e  ).        return
-00039d10: 2079 5f70 7265 6469 730a 2020 2020 0a20   y_predis.    . 
-00039d20: 2020 2064 6566 2070 7265 6469 6374 5f70     def predict_p
-00039d30: 726f 6261 2873 656c 662c 2058 293a 0a20  roba(self, X):. 
-00039d40: 2020 2020 2020 2077 6569 6768 7473 203d         weights =
-00039d50: 2073 656c 662e 7363 6f72 6573 0a20 2020   self.scores.   
-00039d60: 2020 2020 2079 5f70 726f 6261 7320 3d20       y_probas = 
-00039d70: 5b6d 6f64 656c 2e70 7265 6469 6374 5f70  [model.predict_p
-00039d80: 726f 6261 2858 2920 666f 7220 6d6f 6465  roba(X) for mode
-00039d90: 6c20 696e 2073 656c 662e 6d6f 6465 6c73  l in self.models
-00039da0: 205d 0a20 2020 2020 2020 2079 5f70 726f   ].        y_pro
-00039db0: 6261 7320 3d20 7265 7475 726e 5f70 7265  bas = return_pre
-00039dc0: 6469 6374 5f70 726f 6261 2879 5f70 726f  dict_proba(y_pro
-00039dd0: 6261 7329 0a20 2020 2020 2020 2072 6574  bas).        ret
-00039de0: 7572 6e20 795f 7072 6f62 6173 0a0a 2020  urn y_probas..  
-00039df0: 2020 6465 6620 7072 696e 745f 7069 7065    def print_pipe
-00039e00: 6c69 6e65 2873 656c 6629 3a0a 2020 2020  line(self):.    
-00039e10: 2020 2020 6672 6f6d 2073 6b6c 6561 726e      from sklearn
-00039e20: 2069 6d70 6f72 7420 7365 745f 636f 6e66   import set_conf
-00039e30: 6967 0a20 2020 2020 2020 2073 6574 5f63  ig.        set_c
-00039e40: 6f6e 6669 6728 6469 7370 6c61 793d 2274  onfig(display="t
-00039e50: 6578 7422 290a 2020 2020 2020 2020 7265  ext").        re
-00039e60: 7475 726e 2073 656c 662e 7866 6f72 6d65  turn self.xforme
-00039e70: 720a 0a20 2020 2064 6566 2070 6c6f 745f  r..    def plot_
-00039e80: 7069 7065 6c69 6e65 2873 656c 6629 3a0a  pipeline(self):.
-00039e90: 2020 2020 2020 2020 6672 6f6d 2073 6b6c          from skl
-00039ea0: 6561 726e 2069 6d70 6f72 7420 7365 745f  earn import set_
-00039eb0: 636f 6e66 6967 0a20 2020 2020 2020 2073  config.        s
-00039ec0: 6574 5f63 6f6e 6669 6728 6469 7370 6c61  et_config(displa
-00039ed0: 793d 2264 6961 6772 616d 2229 0a20 2020  y="diagram").   
-00039ee0: 2020 2020 2072 6574 7572 6e20 7365 6c66       return self
-00039ef0: 0a0a 2020 2020 6465 6620 706c 6f74 5f69  ..    def plot_i
-00039f00: 6d70 6f72 7461 6e63 6528 7365 6c66 2c20  mportance(self, 
-00039f10: 6d61 785f 6665 6174 7572 6573 3d31 3029  max_features=10)
-00039f20: 3a0a 2020 2020 2020 2020 696d 706f 7274  :.        import
-00039f30: 206c 6967 6874 6762 6d20 6173 206c 6762   lightgbm as lgb
-00039f40: 6d0a 2020 2020 2020 2020 6672 6f6d 2078  m.        from x
-00039f50: 6762 6f6f 7374 2069 6d70 6f72 7420 706c  gboost import pl
-00039f60: 6f74 5f69 6d70 6f72 7461 6e63 650a 2020  ot_importance.  
-00039f70: 2020 2020 2020 6d6f 6465 6c5f 6e61 6d65        model_name
-00039f80: 203d 2073 656c 662e 6d6f 6465 6c5f 6e61   = self.model_na
-00039f90: 6d65 0a20 2020 2020 2020 2066 6561 7475  me.        featu
-00039fa0: 7265 5f6e 616d 6573 203d 2073 656c 662e  re_names = self.
-00039fb0: 6665 6174 7572 6573 0a20 2020 2020 2020  features.       
-00039fc0: 2069 6620 7365 6c66 2e6d 756c 7469 5f6c   if self.multi_l
-00039fd0: 6162 656c 3a0a 2020 2020 2020 2020 2020  abel:.          
-00039fe0: 2020 7072 696e 7428 274e 6f20 6665 6174    print('No feat
-00039ff0: 7572 6520 696d 706f 7274 616e 6365 7320  ure importances 
-0003a000: 6176 6169 6c61 626c 6520 666f 7220 6d75  available for mu
-0003a010: 6c74 695f 6c61 6265 6c20 7072 6f62 6c65  lti_label proble
-0003a020: 6d73 2729 0a20 2020 2020 2020 2020 2020  ms').           
-0003a030: 2072 6574 7572 6e0a 2020 2020 2020 2020   return.        
-0003a040: 6966 2020 6d6f 6465 6c5f 6e61 6d65 203d  if  model_name =
-0003a050: 3d20 276c 6762 2720 6f72 206d 6f64 656c  = 'lgb' or model
-0003a060: 5f6e 616d 6520 3d3d 2027 7867 6227 3a0a  _name == 'xgb':.
-0003a070: 2020 2020 2020 2020 2020 2020 666f 7220              for 
-0003a080: 692c 206d 6f64 656c 2069 6e20 656e 756d  i, model in enum
-0003a090: 6572 6174 6528 7365 6c66 2e6d 6f64 656c  erate(self.model
-0003a0a0: 7329 3a0a 2020 2020 2020 2020 2020 2020  s):.            
-0003a0b0: 2020 2020 6966 2073 656c 662e 7069 7065      if self.pipe
-0003a0c0: 6c69 6e65 3a0a 2020 2020 2020 2020 2020  line:.          
-0003a0d0: 2020 2020 2020 2020 2020 6d6f 6465 6c5f            model_
-0003a0e0: 6f62 6a65 6374 203d 206d 6f64 656c 2e6e  object = model.n
-0003a0f0: 616d 6564 5f73 7465 7073 5b27 6d6f 6465  amed_steps['mode
-0003a100: 6c27 5d0a 2020 2020 2020 2020 2020 2020  l'].            
-0003a110: 2020 2020 656c 7365 3a0a 2020 2020 2020      else:.      
-0003a120: 2020 2020 2020 2020 2020 2020 2020 6d6f                mo
-0003a130: 6465 6c5f 6f62 6a65 6374 203d 206d 6f64  del_object = mod
-0003a140: 656c 0a20 2020 2020 2020 2020 2020 2020  el.             
-0003a150: 2020 2066 6561 7475 7265 5f69 6d70 6f72     feature_impor
-0003a160: 7461 6e63 6573 203d 206d 6f64 656c 5f6f  tances = model_o
-0003a170: 626a 6563 742e 626f 6f73 7465 725f 2e66  bject.booster_.f
-0003a180: 6561 7475 7265 5f69 6d70 6f72 7461 6e63  eature_importanc
-0003a190: 6528 696d 706f 7274 616e 6365 5f74 7970  e(importance_typ
-0003a1a0: 653d 2767 6169 6e27 290a 2020 2020 2020  e='gain').      
-0003a1b0: 2020 2020 2020 2020 2020 6966 2069 203d            if i =
-0003a1c0: 3d20 303a 0a20 2020 2020 2020 2020 2020  = 0:.           
-0003a1d0: 2020 2020 2020 2020 2066 6561 7475 7265           feature
-0003a1e0: 5f69 6d70 203d 2070 642e 4461 7461 4672  _imp = pd.DataFr
-0003a1f0: 616d 6528 7b27 5661 6c75 6527 3a66 6561  ame({'Value':fea
-0003a200: 7475 7265 5f69 6d70 6f72 7461 6e63 6573  ture_importances
-0003a210: 2c27 4665 6174 7572 6527 3a66 6561 7475  ,'Feature':featu
-0003a220: 7265 5f6e 616d 6573 7d29 0a20 2020 2020  re_names}).     
-0003a230: 2020 2020 2020 2020 2020 2065 6c73 653a             else:
-0003a240: 0a20 2020 2020 2020 2020 2020 2020 2020  .               
-0003a250: 2020 2020 2066 6561 7475 7265 5f69 6d70       feature_imp
-0003a260: 203d 2070 642e 636f 6e63 6174 285b 6665   = pd.concat([fe
-0003a270: 6174 7572 655f 696d 702c 200a 2020 2020  ature_imp, .    
-0003a280: 2020 2020 2020 2020 2020 2020 2020 2020                  
-0003a290: 2020 2020 7064 2e44 6174 6146 7261 6d65      pd.DataFrame
-0003a2a0: 287b 2756 616c 7565 273a 6665 6174 7572  ({'Value':featur
-0003a2b0: 655f 696d 706f 7274 616e 6365 732c 2746  e_importances,'F
-0003a2c0: 6561 7475 7265 273a 6665 6174 7572 655f  eature':feature_
-0003a2d0: 6e61 6d65 737d 295d 2c20 6178 6973 3d30  names})], axis=0
-0003a2e0: 290a 2020 2020 2020 2020 2020 2020 2020  ).              
-0003a2f0: 2020 236c 6762 6d2e 706c 6f74 5f69 6d70    #lgbm.plot_imp
-0003a300: 6f72 7461 6e63 6528 6d6f 6465 6c5f 6f62  ortance(model_ob
-0003a310: 6a65 6374 2c20 696d 706f 7274 616e 6365  ject, importance
-0003a320: 5f74 7970 653d 2767 6169 6e27 2c20 6d61  _type='gain', ma
-0003a330: 785f 6e75 6d5f 6665 6174 7572 6573 3d6d  x_num_features=m
-0003a340: 6178 5f66 6561 7475 7265 7329 0a20 2020  ax_features).   
-0003a350: 2020 2020 2020 2020 2066 6561 7475 7265           feature
-0003a360: 5f69 6d70 203d 2066 6561 7475 7265 5f69  _imp = feature_i
-0003a370: 6d70 2e67 726f 7570 6279 2827 4665 6174  mp.groupby('Feat
-0003a380: 7572 6527 292e 6d65 616e 2829 2e73 6f72  ure').mean().sor
-0003a390: 745f 7661 6c75 6573 2827 5661 6c75 6527  t_values('Value'
-0003a3a0: 2c61 7363 656e 6469 6e67 3d46 616c 7365  ,ascending=False
-0003a3b0: 292e 7265 7365 745f 696e 6465 7828 290a  ).reset_index().
-0003a3c0: 2020 2020 2020 2020 2020 2020 6665 6174              feat
-0003a3d0: 7572 655f 696d 702e 7365 745f 696e 6465  ure_imp.set_inde
-0003a3e0: 7828 2746 6561 7475 7265 2729 5b3a 6d61  x('Feature')[:ma
-0003a3f0: 785f 6665 6174 7572 6573 5d2e 706c 6f74  x_features].plot
-0003a400: 286b 696e 643d 2762 6172 6827 2c20 7469  (kind='barh', ti
-0003a410: 746c 653d 2754 6f70 2031 3020 4665 6174  tle='Top 10 Feat
-0003a420: 7572 6573 2729 0a20 2020 2020 2020 2020  ures').         
-0003a430: 2020 2023 2323 2054 6869 7320 6973 2066     ### This is f
-0003a440: 6f72 2058 4742 2023 2323 0a20 2020 2020  or XGB ###.     
-0003a450: 2020 2020 2020 2023 706c 6f74 5f69 6d70         #plot_imp
-0003a460: 6f72 7461 6e63 6528 7365 6c66 2e6d 6f64  ortance(self.mod
-0003a470: 656c 2e6e 616d 6564 5f73 7465 7073 5b27  el.named_steps['
-0003a480: 6d6f 6465 6c27 5d2c 2069 6d70 6f72 7461  model'], importa
-0003a490: 6e63 655f 7479 7065 3d27 6761 696e 272c  nce_type='gain',
-0003a4a0: 206d 6178 5f6e 756d 5f66 6561 7475 7265   max_num_feature
-0003a4b0: 733d 6d61 785f 6665 6174 7572 6573 290a  s=max_features).
-0003a4c0: 2020 2020 2020 2020 656c 6966 206d 6f64          elif mod
-0003a4d0: 656c 5f6e 616d 6520 3d3d 2027 6c70 273a  el_name == 'lp':
-0003a4e0: 0a20 2020 2020 2020 2020 2020 2070 7269  .            pri
-0003a4f0: 6e74 2827 4e6f 2066 6561 7475 7265 2069  nt('No feature i
-0003a500: 6d70 6f72 7461 6e63 6573 2061 7661 696c  mportances avail
-0003a510: 6162 6c65 2066 6f72 204c 6162 656c 5072  able for LabelPr
-0003a520: 6f70 6167 6174 696f 6e20 616c 676f 7269  opagation algori
-0003a530: 7468 6d2e 2052 6574 7572 6e69 6e67 2e2e  thm. Returning..
-0003a540: 2e27 290a 2020 2020 2020 2020 2020 2020  .').            
-0003a550: 7265 7475 726e 0a20 2020 2020 2020 2065  return.        e
-0003a560: 6c69 6620 6d6f 6465 6c5f 6e61 6d65 203d  lif model_name =
-0003a570: 3d20 2772 6627 3a0a 2020 2020 2020 2020  = 'rf':.        
-0003a580: 2020 2020 2323 2320 5468 6573 6520 6172      ### These ar
-0003a590: 6520 666f 7220 5261 6e64 6f6d 466f 7265  e for RandomFore
-0003a5a0: 7374 436c 6173 7369 6669 6572 206b 696e  stClassifier kin
-0003a5b0: 6420 6f66 2073 6369 6b69 742d 6c65 6172  d of scikit-lear
-0003a5c0: 6e20 6d6f 6465 6c73 2023 2323 0a20 2020  n models ###.   
-0003a5d0: 2020 2020 2020 2020 2074 7279 3a0a 2020           try:.  
-0003a5e0: 2020 2020 2020 2020 2020 2020 2020 666f                fo
-0003a5f0: 7220 692c 206d 6f64 656c 2069 6e20 656e  r i, model in en
-0003a600: 756d 6572 6174 6528 7365 6c66 2e6d 6f64  umerate(self.mod
-0003a610: 656c 7329 3a0a 2020 2020 2020 2020 2020  els):.          
-0003a620: 2020 2020 2020 2020 2020 6966 2073 656c            if sel
-0003a630: 662e 7069 7065 6c69 6e65 3a0a 2020 2020  f.pipeline:.    
-0003a640: 2020 2020 2020 2020 2020 2020 2020 2020                  
-0003a650: 2020 2020 6d6f 6465 6c5f 6f62 6a65 6374      model_object
-0003a660: 203d 206d 6f64 656c 2e6e 616d 6564 5f73   = model.named_s
-0003a670: 7465 7073 5b27 6d6f 6465 6c27 5d0a 2020  teps['model'].  
-0003a680: 2020 2020 2020 2020 2020 2020 2020 2020                  
-0003a690: 2020 656c 7365 3a0a 2020 2020 2020 2020    else:.        
-0003a6a0: 2020 2020 2020 2020 2020 2020 2020 2020                  
-0003a6b0: 6d6f 6465 6c5f 6f62 6a65 6374 203d 206d  model_object = m
-0003a6c0: 6f64 656c 0a20 2020 2020 2020 2020 2020  odel.           
-0003a6d0: 2020 2020 2020 2020 2066 6561 7475 7265           feature
-0003a6e0: 5f69 6d70 6f72 7461 6e63 6573 203d 206d  _importances = m
-0003a6f0: 6f64 656c 5f6f 626a 6563 742e 6665 6174  odel_object.feat
-0003a700: 7572 655f 696d 706f 7274 616e 6365 735f  ure_importances_
-0003a710: 0a20 2020 2020 2020 2020 2020 2020 2020  .               
-0003a720: 2020 2020 2069 6620 6920 3d3d 2030 3a0a       if i == 0:.
-0003a730: 2020 2020 2020 2020 2020 2020 2020 2020                  
-0003a740: 2020 2020 2020 2020 6665 6174 7572 655f          feature_
-0003a750: 696d 7020 3d20 7064 2e44 6174 6146 7261  imp = pd.DataFra
-0003a760: 6d65 287b 2756 616c 7565 273a 6665 6174  me({'Value':feat
-0003a770: 7572 655f 696d 706f 7274 616e 6365 732c  ure_importances,
-0003a780: 2746 6561 7475 7265 273a 6665 6174 7572  'Feature':featur
-0003a790: 655f 6e61 6d65 737d 290a 2020 2020 2020  e_names}).      
-0003a7a0: 2020 2020 2020 2020 2020 2020 2020 656c                el
-0003a7b0: 7365 3a0a 2020 2020 2020 2020 2020 2020  se:.            
-0003a7c0: 2020 2020 2020 2020 2020 2020 6665 6174              feat
-0003a7d0: 7572 655f 696d 7020 3d20 7064 2e63 6f6e  ure_imp = pd.con
-0003a7e0: 6361 7428 5b66 6561 7475 7265 5f69 6d70  cat([feature_imp
-0003a7f0: 2c20 0a20 2020 2020 2020 2020 2020 2020  , .             
-0003a800: 2020 2020 2020 2020 2020 2020 2020 2070                 p
-0003a810: 642e 4461 7461 4672 616d 6528 7b27 5661  d.DataFrame({'Va
-0003a820: 6c75 6527 3a66 6561 7475 7265 5f69 6d70  lue':feature_imp
-0003a830: 6f72 7461 6e63 6573 2c27 4665 6174 7572  ortances,'Featur
-0003a840: 6527 3a66 6561 7475 7265 5f6e 616d 6573  e':feature_names
-0003a850: 7d29 5d2c 2061 7869 733d 3029 0a20 2020  })], axis=0).   
-0003a860: 2020 2020 2020 2020 2020 2020 2066 6561               fea
-0003a870: 7475 7265 5f69 6d70 203d 2066 6561 7475  ture_imp = featu
-0003a880: 7265 5f69 6d70 2e67 726f 7570 6279 2827  re_imp.groupby('
-0003a890: 4665 6174 7572 6527 292e 6d65 616e 2829  Feature').mean()
-0003a8a0: 2e73 6f72 745f 7661 6c75 6573 2827 5661  .sort_values('Va
-0003a8b0: 6c75 6527 2c61 7363 656e 6469 6e67 3d46  lue',ascending=F
-0003a8c0: 616c 7365 292e 7265 7365 745f 696e 6465  alse).reset_inde
-0003a8d0: 7828 290a 2020 2020 2020 2020 2020 2020  x().            
-0003a8e0: 2020 2020 6665 6174 7572 655f 696d 702e      feature_imp.
-0003a8f0: 7365 745f 696e 6465 7828 2746 6561 7475  set_index('Featu
-0003a900: 7265 2729 5b3a 6d61 785f 6665 6174 7572  re')[:max_featur
-0003a910: 6573 5d2e 706c 6f74 286b 696e 643d 2762  es].plot(kind='b
-0003a920: 6172 6827 2c20 7469 746c 653d 2754 6f70  arh', title='Top
-0003a930: 2031 3020 4665 6174 7572 6573 2729 0a20   10 Features'). 
-0003a940: 2020 2020 2020 2020 2020 2065 7863 6570             excep
-0003a950: 743a 0a20 2020 2020 2020 2020 2020 2020  t:.             
-0003a960: 2020 2020 2020 2070 7269 6e74 2827 436f         print('Co
-0003a970: 756c 6420 6e6f 7420 706c 6f74 2066 6561  uld not plot fea
-0003a980: 7475 7265 2069 6d70 6f72 7461 6e63 6573  ture importances
-0003a990: 2e20 506c 6561 7365 2063 6865 636b 2079  . Please check y
-0003a9a0: 6f75 7220 6d6f 6465 6c20 616e 6420 7472  our model and tr
-0003a9b0: 7920 6167 6169 6e2e 2729 2020 2020 2020  y again.')      
-0003a9c0: 2020 2020 2020 2020 2020 0a20 2020 2020            .     
-0003a9d0: 2020 2065 6c73 653a 0a20 2020 2020 2020     else:.       
-0003a9e0: 2020 2020 2070 7269 6e74 2827 4e6f 2066       print('No f
-0003a9f0: 6561 7475 7265 2069 6d70 6f72 7461 6e63  eature importanc
-0003aa00: 6573 2061 7661 696c 6162 6c65 2066 6f72  es available for
-0003aa10: 2074 6869 7320 616c 676f 7269 7468 6d2e   this algorithm.
-0003aa20: 2052 6574 7572 6e69 6e67 2e2e 2e27 290a   Returning...').
-0003aa30: 2020 2020 2020 2020 2020 2020 7265 7475              retu
-0003aa40: 726e 0a23 2323 2323 2323 2323 2323 2323  rn.#############
-0003aa50: 2323 2323 2323 2323 2323 2323 2323 2323  ################
-0003aa60: 2323 2323 2323 2323 2323 2323 2323 2323  ################
-0003aa70: 2323 2323 2323 2323 2323 2323 2323 2323  ################
-0003aa80: 2323 2323 2323 2323 2323 2323 2323 2323  ################
-0003aa90: 2323 2323 2323 2323 2323 2323 2323 2323  ################
-0003aaa0: 2323 2323 2323 2323 0a66 726f 6d20 736b  ########.from sk
-0003aab0: 6c65 6172 6e2e 6d6f 6465 6c5f 7365 6c65  learn.model_sele
-0003aac0: 6374 696f 6e20 696d 706f 7274 2053 7472  ction import Str
-0003aad0: 6174 6966 6965 644b 466f 6c64 2c20 4b46  atifiedKFold, KF
-0003aae0: 6f6c 642c 2052 6570 6561 7465 644b 466f  old, RepeatedKFo
-0003aaf0: 6c64 0a66 726f 6d20 736b 6c65 6172 6e2e  ld.from sklearn.
-0003ab00: 6d6f 6465 6c5f 7365 6c65 6374 696f 6e20  model_selection 
-0003ab10: 696d 706f 7274 2052 616e 646f 6d69 7a65  import Randomize
-0003ab20: 6453 6561 7263 6843 560a 6465 6620 7261  dSearchCV.def ra
-0003ab30: 6e64 5f73 6561 7263 6828 6d6f 6465 6c2c  nd_search(model,
-0003ab40: 2058 2c20 792c 206d 6f64 656c 5f6e 616d   X, y, model_nam
-0003ab50: 652c 2070 6970 655f 666c 6167 3d46 616c  e, pipe_flag=Fal
-0003ab60: 7365 2c20 7363 6f72 696e 673d 4e6f 6e65  se, scoring=None
-0003ab70: 2c20 7665 7262 6f73 653d 3029 3a0a 2020  , verbose=0):.  
-0003ab80: 2020 7374 6172 7420 3d20 7469 6d65 2e74    start = time.t
-0003ab90: 696d 6528 290a 2020 2020 6966 2070 6970  ime().    if pip
-0003aba0: 655f 666c 6167 3a0a 2020 2020 2020 2020  e_flag:.        
-0003abb0: 6d6f 6465 6c5f 7374 7269 6e67 203d 2027  model_string = '
-0003abc0: 6d6f 6465 6c5f 5f27 0a20 2020 2065 6c73  model__'.    els
-0003abd0: 653a 0a20 2020 2020 2020 206d 6f64 656c  e:.        model
-0003abe0: 5f73 7472 696e 6720 3d20 2727 0a20 2020  _string = ''.   
-0003abf0: 2023 2323 2073 6574 206e 5f69 7465 7220   ### set n_iter 
-0003ac00: 6865 7265 2023 2323 230a 2020 2020 6966  here ####.    if
-0003ac10: 2058 2e73 6861 7065 5b30 5d20 3c3d 2031   X.shape[0] <= 1
-0003ac20: 3030 3030 3a0a 2020 2020 2020 2020 6e5f  0000:.        n_
-0003ac30: 6974 6572 203d 2031 300a 2020 2020 656c  iter = 10.    el
-0003ac40: 7365 3a0a 2020 2020 2020 2020 6e5f 6974  se:.        n_it
-0003ac50: 6572 203d 2035 0a20 2020 2069 6620 6d6f  er = 5.    if mo
-0003ac60: 6465 6c5f 6e61 6d65 203d 3d20 2772 6627  del_name == 'rf'
-0003ac70: 3a0a 2020 2020 2020 2020 2363 7269 7465  :.        #crite
-0003ac80: 7269 6f6e 203d 205b 2267 696e 6922 2c20  rion = ["gini", 
-0003ac90: 2265 6e74 726f 7079 222c 2022 6c6f 675f  "entropy", "log_
-0003aca0: 6c6f 7373 225d 0a20 2020 2020 2020 2023  loss"].        #
-0003acb0: 204e 756d 6265 7220 6f66 2074 7265 6573   Number of trees
-0003acc0: 2069 6e20 7261 6e64 6f6d 2066 6f72 6573   in random fores
-0003acd0: 740a 2020 2020 2020 2020 6e5f 6573 7469  t.        n_esti
-0003ace0: 6d61 746f 7273 203d 2073 705f 7261 6e64  mators = sp_rand
-0003acf0: 496e 7428 3130 302c 2033 3030 290a 2020  Int(100, 300).  
-0003ad00: 2020 2020 2020 2320 4e75 6d62 6572 206f        # Number o
-0003ad10: 6620 6665 6174 7572 6573 2074 6f20 636f  f features to co
-0003ad20: 6e73 6964 6572 2061 7420 6576 6572 7920  nsider at every 
-0003ad30: 7370 6c69 740a 2020 2020 2020 2020 6d61  split.        ma
-0003ad40: 785f 6665 6174 7572 6573 203d 205b 2761  x_features = ['a
-0003ad50: 7574 6f27 2c20 2773 7172 7427 2c20 276c  uto', 'sqrt', 'l
-0003ad60: 6f67 275d 0a20 2020 2020 2020 2023 204d  og'].        # M
-0003ad70: 6178 696d 756d 206e 756d 6265 7220 6f66  aximum number of
-0003ad80: 206c 6576 656c 7320 696e 2074 7265 650a   levels in tree.
-0003ad90: 2020 2020 2020 2020 6d61 785f 6465 7074          max_dept
-0003ada0: 6820 3d20 7370 5f72 616e 6449 6e74 2832  h = sp_randInt(2
-0003adb0: 2c20 3130 290a 2020 2020 2020 2020 2320  , 10).        # 
-0003adc0: 4d69 6e69 6d75 6d20 6e75 6d62 6572 206f  Minimum number o
-0003add0: 6620 7361 6d70 6c65 7320 7265 7175 6972  f samples requir
-0003ade0: 6564 2074 6f20 7370 6c69 7420 6120 6e6f  ed to split a no
-0003adf0: 6465 0a20 2020 2020 2020 206d 696e 5f73  de.        min_s
-0003ae00: 616d 706c 6573 5f73 706c 6974 203d 2073  amples_split = s
-0003ae10: 705f 7261 6e64 496e 7428 322c 2031 3029  p_randInt(2, 10)
-0003ae20: 0a20 2020 2020 2020 2023 204d 696e 696d  .        # Minim
-0003ae30: 756d 206e 756d 6265 7220 6f66 2073 616d  um number of sam
-0003ae40: 706c 6573 2072 6571 7569 7265 6420 6174  ples required at
-0003ae50: 2065 6163 6820 6c65 6166 206e 6f64 650a   each leaf node.
-0003ae60: 2020 2020 2020 2020 6d69 6e5f 7361 6d70          min_samp
-0003ae70: 6c65 735f 6c65 6166 203d 2073 705f 7261  les_leaf = sp_ra
-0003ae80: 6e64 496e 7428 322c 2031 3029 0a20 2020  ndInt(2, 10).   
-0003ae90: 2020 2020 2023 204d 6574 686f 6420 6f66       # Method of
-0003aea0: 2073 656c 6563 7469 6e67 2073 616d 706c   selecting sampl
-0003aeb0: 6573 2066 6f72 2074 7261 696e 696e 6720  es for training 
-0003aec0: 6561 6368 2074 7265 650a 2020 2020 2020  each tree.      
-0003aed0: 2020 626f 6f74 7374 7261 7020 3d20 5b54    bootstrap = [T
-0003aee0: 7275 652c 2046 616c 7365 5d0a 2020 2020  rue, False].    
-0003aef0: 2020 2020 2323 2320 2054 6865 7365 2061      ###  These a
-0003af00: 7265 2074 6865 2052 616e 646f 6d46 6f72  re the RandomFor
-0003af10: 6573 7420 7061 7261 6d73 2023 2323 2323  est params #####
-0003af20: 2323 2320 2020 2020 2020 200a 2020 2020  ###        .    
-0003af30: 2020 2020 7061 7261 6d73 203d 207b 0a20      params = {. 
-0003af40: 2020 2020 2020 2020 2020 2023 6d6f 6465             #mode
-0003af50: 6c5f 7374 7269 6e67 2b27 6372 6974 6572  l_string+'criter
-0003af60: 696f 6e27 3a20 6372 6974 6572 696f 6e2c  ion': criterion,
-0003af70: 0a20 2020 2020 2020 2020 2020 206d 6f64  .            mod
-0003af80: 656c 5f73 7472 696e 672b 276e 5f65 7374  el_string+'n_est
-0003af90: 696d 6174 6f72 7327 3a20 6e5f 6573 7469  imators': n_esti
-0003afa0: 6d61 746f 7273 2c0a 2020 2020 2020 2020  mators,.        
-0003afb0: 2020 2020 6d6f 6465 6c5f 7374 7269 6e67      model_string
-0003afc0: 2b27 6d61 785f 6665 6174 7572 6573 273a  +'max_features':
-0003afd0: 206d 6178 5f66 6561 7475 7265 732c 0a20   max_features,. 
-0003afe0: 2020 2020 2020 2020 2020 2023 6d6f 6465             #mode
-0003aff0: 6c5f 7374 7269 6e67 2b27 6d61 785f 6465  l_string+'max_de
-0003b000: 7074 6827 3a20 6d61 785f 6465 7074 682c  pth': max_depth,
-0003b010: 0a20 2020 2020 2020 2020 2020 2023 6d6f  .            #mo
-0003b020: 6465 6c5f 7374 7269 6e67 2b27 6d69 6e5f  del_string+'min_
-0003b030: 7361 6d70 6c65 735f 7370 6c69 7427 3a20  samples_split': 
-0003b040: 6d69 6e5f 7361 6d70 6c65 735f 7370 6c69  min_samples_spli
-0003b050: 742c 0a20 2020 2020 2020 2020 2020 2023  t,.            #
-0003b060: 6d6f 6465 6c5f 7374 7269 6e67 2b27 6d69  model_string+'mi
-0003b070: 6e5f 7361 6d70 6c65 735f 6c65 6166 273a  n_samples_leaf':
-0003b080: 206d 696e 5f73 616d 706c 6573 5f6c 6561   min_samples_lea
-0003b090: 662c 0a20 2020 2020 2020 2020 2020 236d  f,.           #m
-0003b0a0: 6f64 656c 5f73 7472 696e 672b 2762 6f6f  odel_string+'boo
-0003b0b0: 7473 7472 6170 273a 2062 6f6f 7473 7472  tstrap': bootstr
-0003b0c0: 6170 2c0a 2020 2020 2020 2020 2020 2020  ap,.            
-0003b0d0: 2020 2020 2020 2020 2020 207d 0a20 2020             }.   
-0003b0e0: 2065 6c69 6620 6d6f 6465 6c5f 6e61 6d65   elif model_name
-0003b0f0: 203d 3d20 2762 6727 3a0a 2020 2020 2020   == 'bg':.      
-0003b100: 2020 6372 6974 6572 696f 6e20 3d20 5b22    criterion = ["
-0003b110: 6769 6e69 222c 2022 656e 7472 6f70 7922  gini", "entropy"
-0003b120: 2c20 226c 6f67 5f6c 6f73 7322 5d0a 2020  , "log_loss"].  
-0003b130: 2020 2020 2020 2320 4e75 6d62 6572 206f        # Number o
-0003b140: 6620 6261 7365 2065 7374 696d 6174 6f72  f base estimator
-0003b150: 7320 696e 2061 2042 6167 6769 6e67 2069  s in a Bagging i
-0003b160: 7320 7665 7279 2073 6d61 6c6c 200a 2020  s very small .  
-0003b170: 2020 2020 2020 6e5f 6573 7469 6d61 746f        n_estimato
-0003b180: 7273 203d 2073 705f 7261 6e64 496e 7428  rs = sp_randInt(
-0003b190: 322c 3230 290a 2020 2020 2020 2020 2320  2,20).        # 
-0003b1a0: 4e75 6d62 6572 206f 6620 6665 6174 7572  Number of featur
-0003b1b0: 6573 2074 6f20 636f 6e73 6964 6572 2061  es to consider a
-0003b1c0: 7420 6576 6572 7920 7370 6c69 740a 2020  t every split.  
-0003b1d0: 2020 2020 2020 236d 6178 5f66 6561 7475        #max_featu
-0003b1e0: 7265 7320 3d20 5b27 6175 746f 272c 2027  res = ['auto', '
-0003b1f0: 7371 7274 272c 2027 6c6f 6727 5d0a 2020  sqrt', 'log'].  
-0003b200: 2020 2020 2020 236d 6178 5f66 6561 7475        #max_featu
-0003b210: 7265 7320 3d20 7370 5f72 616e 6446 6c6f  res = sp_randFlo
-0003b220: 6174 2830 2e33 2c30 2e39 290a 2020 2020  at(0.3,0.9).    
-0003b230: 2020 2020 6d61 785f 6665 6174 7572 6573      max_features
-0003b240: 203d 205b 302e 332c 2030 2e36 2c20 312e   = [0.3, 0.6, 1.
-0003b250: 305d 0a20 2020 2020 2020 2023 204d 6178  0].        # Max
-0003b260: 696d 756d 206e 756d 6265 7220 6f66 206c  imum number of l
-0003b270: 6576 656c 7320 696e 2074 7265 650a 2020  evels in tree.  
-0003b280: 2020 2020 2020 6d61 785f 6465 7074 6820        max_depth 
-0003b290: 3d20 7370 5f72 616e 6449 6e74 2832 2c20  = sp_randInt(2, 
-0003b2a0: 3130 290a 2020 2020 2020 2020 2320 4d69  10).        # Mi
-0003b2b0: 6e69 6d75 6d20 6e75 6d62 6572 206f 6620  nimum number of 
-0003b2c0: 7361 6d70 6c65 7320 7265 7175 6972 6564  samples required
-0003b2d0: 2074 6f20 7370 6c69 7420 6120 6e6f 6465   to split a node
-0003b2e0: 0a20 2020 2020 2020 206d 696e 5f73 616d  .        min_sam
-0003b2f0: 706c 6573 5f73 706c 6974 203d 2073 705f  ples_split = sp_
-0003b300: 7261 6e64 496e 7428 322c 2031 3029 0a20  randInt(2, 10). 
-0003b310: 2020 2020 2020 2023 204d 696e 696d 756d         # Minimum
-0003b320: 206e 756d 6265 7220 6f66 2073 616d 706c   number of sampl
-0003b330: 6573 2072 6571 7569 7265 6420 6174 2065  es required at e
-0003b340: 6163 6820 6c65 6166 206e 6f64 650a 2020  ach leaf node.  
-0003b350: 2020 2020 2020 6d69 6e5f 7361 6d70 6c65        min_sample
-0003b360: 735f 6c65 6166 203d 2073 705f 7261 6e64  s_leaf = sp_rand
-0003b370: 496e 7428 322c 2031 3029 0a20 2020 2020  Int(2, 10).     
-0003b380: 2020 2023 204d 6574 686f 6420 6f66 2073     # Method of s
-0003b390: 656c 6563 7469 6e67 2073 616d 706c 6573  electing samples
-0003b3a0: 2066 6f72 2074 7261 696e 696e 6720 6561   for training ea
-0003b3b0: 6368 2074 7265 650a 2020 2020 2020 2020  ch tree.        
-0003b3c0: 626f 6f74 7374 7261 7020 3d20 5b54 7275  bootstrap = [Tru
-0003b3d0: 652c 2046 616c 7365 5d0a 2020 2020 2020  e, False].      
-0003b3e0: 2020 2323 2320 2054 6865 7365 2061 7265    ###  These are
-0003b3f0: 2074 6865 2042 6167 6769 6e67 2070 6172   the Bagging par
-0003b400: 616d 7320 2323 2323 2323 2323 0a20 2020  ams ########.   
-0003b410: 2020 2020 2070 6172 616d 7320 3d20 7b0a       params = {.
-0003b420: 2020 2020 2020 2020 2020 2020 236d 6f64              #mod
-0003b430: 656c 5f73 7472 696e 672b 2763 7269 7465  el_string+'crite
-0003b440: 7269 6f6e 273a 2063 7269 7465 7269 6f6e  rion': criterion
-0003b450: 2c0a 2020 2020 2020 2020 2020 2020 6d6f  ,.            mo
-0003b460: 6465 6c5f 7374 7269 6e67 2b27 6e5f 6573  del_string+'n_es
-0003b470: 7469 6d61 746f 7273 273a 206e 5f65 7374  timators': n_est
-0003b480: 696d 6174 6f72 732c 0a20 2020 2020 2020  imators,.       
-0003b490: 2020 2020 206d 6f64 656c 5f73 7472 696e       model_strin
-0003b4a0: 672b 276d 6178 5f66 6561 7475 7265 7327  g+'max_features'
-0003b4b0: 3a20 6d61 785f 6665 6174 7572 6573 2c0a  : max_features,.
-0003b4c0: 2020 2020 2020 2020 2020 2020 236d 6f64              #mod
-0003b4d0: 656c 5f73 7472 696e 672b 276d 6178 5f64  el_string+'max_d
-0003b4e0: 6570 7468 273a 206d 6178 5f64 6570 7468  epth': max_depth
-0003b4f0: 2c0a 2020 2020 2020 2020 2020 2020 236d  ,.            #m
-0003b500: 6f64 656c 5f73 7472 696e 672b 276d 696e  odel_string+'min
-0003b510: 5f73 616d 706c 6573 5f73 706c 6974 273a  _samples_split':
-0003b520: 206d 696e 5f73 616d 706c 6573 5f73 706c   min_samples_spl
-0003b530: 6974 2c0a 2020 2020 2020 2020 2020 2020  it,.            
-0003b540: 236d 6f64 656c 5f73 7472 696e 672b 276d  #model_string+'m
-0003b550: 696e 5f73 616d 706c 6573 5f6c 6561 6627  in_samples_leaf'
-0003b560: 3a20 6d69 6e5f 7361 6d70 6c65 735f 6c65  : min_samples_le
-0003b570: 6166 2c0a 2020 2020 2020 2020 2020 2020  af,.            
-0003b580: 236d 6f64 656c 5f73 7472 696e 672b 2762  #model_string+'b
-0003b590: 6f6f 7473 7472 6170 273a 2062 6f6f 7473  ootstrap': boots
-0003b5a0: 7472 6170 2c0a 2020 2020 2020 2020 2020  trap,.          
-0003b5b0: 2020 236d 6f64 656c 5f73 7472 696e 672b    #model_string+
-0003b5c0: 2762 6f6f 7473 7472 6170 5f66 6561 7475  'bootstrap_featu
-0003b5d0: 7265 7327 3a20 626f 6f74 7374 7261 702c  res': bootstrap,
-0003b5e0: 0a20 2020 2020 2020 2020 2020 2020 2020  .               
-0003b5f0: 2020 2020 2020 2020 7d0a 2020 2020 656c          }.    el
-0003b600: 6966 206d 6f64 656c 5f6e 616d 6520 3d3d  if model_name ==
-0003b610: 2027 6c67 6227 3a0a 2020 2020 2020 2020   'lgb':.        
-0003b620: 2320 4e75 6d62 6572 206f 6620 6573 7469  # Number of esti
-0003b630: 6d61 746f 7273 2069 6e20 4c47 424d 2043  mators in LGBM C
-0003b640: 6c61 7373 6966 6965 7220 2323 0a20 2020  lassifier ##.   
-0003b650: 2020 2020 206e 5f65 7374 696d 6174 6f72       n_estimator
-0003b660: 7320 3d20 7370 5f72 616e 6449 6e74 2831  s = sp_randInt(1
-0003b670: 3030 2c20 3530 3029 0a20 2020 2020 2020  00, 500).       
-0003b680: 2023 2323 206e 756d 6265 7220 6f66 206c   ### number of l
-0003b690: 6561 7665 7320 6973 206f 6e6c 7920 666f  eaves is only fo
-0003b6a0: 7220 4c47 424d 2023 2323 0a20 2020 2020  r LGBM ###.     
-0003b6b0: 2020 206e 756d 5f6c 6561 7665 7320 3d20     num_leaves = 
-0003b6c0: 7370 5f72 616e 6449 6e74 2835 2c20 3330  sp_randInt(5, 30
-0003b6d0: 3029 0a20 2020 2020 2020 2023 2320 6c65  0).        ## le
-0003b6e0: 6172 6e69 6e67 2072 6174 6520 6973 2076  arning rate is v
-0003b6f0: 6572 7920 696d 706f 7274 616e 7420 666f  ery important fo
-0003b700: 7220 4c47 424d 2023 230a 2020 2020 2020  r LGBM ##.      
-0003b710: 2020 6c65 6172 6e69 6e67 5f72 6174 6520    learning_rate 
-0003b720: 3d20 7370 2e73 7461 7473 2e75 6e69 666f  = sp.stats.unifo
-0003b730: 726d 2873 6361 6c65 3d31 290a 2020 2020  rm(scale=1).    
-0003b740: 2020 2020 7061 7261 6d73 203d 207b 0a20      params = {. 
-0003b750: 2020 2020 2020 2020 2020 206d 6f64 656c             model
-0003b760: 5f73 7472 696e 672b 276e 5f65 7374 696d  _string+'n_estim
-0003b770: 6174 6f72 7327 3a20 6e5f 6573 7469 6d61  ators': n_estima
-0003b780: 746f 7273 2c0a 2020 2020 2020 2020 2020  tors,.          
-0003b790: 2020 236d 6f64 656c 5f73 7472 696e 672b    #model_string+
-0003b7a0: 276e 756d 5f6c 6561 7665 7327 3a20 6e75  'num_leaves': nu
-0003b7b0: 6d5f 6c65 6176 6573 2c0a 2020 2020 2020  m_leaves,.      
-0003b7c0: 2020 2020 2020 6d6f 6465 6c5f 7374 7269        model_stri
-0003b7d0: 6e67 2b27 6c65 6172 6e69 6e67 5f72 6174  ng+'learning_rat
-0003b7e0: 6527 3a20 6c65 6172 6e69 6e67 5f72 6174  e': learning_rat
-0003b7f0: 652c 0a20 2020 2020 2020 2020 2020 2020  e,.             
-0003b800: 2020 2020 2020 207d 0a20 2020 2065 6c69         }.    eli
-0003b810: 6620 6d6f 6465 6c5f 6e61 6d65 203d 3d20  f model_name == 
-0003b820: 276c 7027 3a0a 2020 2020 2020 2020 7061  'lp':.        pa
-0003b830: 7261 6d73 203d 2020 7b0a 2020 2020 2020  rams =  {.      
-0003b840: 2020 2020 2020 2323 2320 446f 6e27 7420        ### Don't 
-0003b850: 6f76 6572 6c79 2063 6f6d 706c 6963 6174  overly complicat
-0003b860: 6520 7468 6973 2073 696d 706c 6520 6d6f  e this simple mo
-0003b870: 6465 6c2e 2049 7420 776f 726b 7320 6265  del. It works be
-0003b880: 7374 2077 6974 6820 6e6f 2074 756e 696e  st with no tunin
-0003b890: 6721 0a20 2020 2020 2020 2020 2020 206d  g!.            m
-0003b8a0: 6f64 656c 5f73 7472 696e 672b 2767 616d  odel_string+'gam
-0003b8b0: 6d61 273a 2073 705f 7261 6e64 496e 7428  ma': sp_randInt(
-0003b8c0: 302c 2033 3229 2c0a 2020 2020 2020 2020  0, 32),.        
-0003b8d0: 2020 2020 6d6f 6465 6c5f 7374 7269 6e67      model_string
-0003b8e0: 2b27 6b65 726e 656c 273a 205b 276b 6e6e  +'kernel': ['knn
-0003b8f0: 272c 2027 7262 6627 5d2c 0a20 2020 2020  ', 'rbf'],.     
-0003b900: 2020 2020 2020 2023 6d6f 6465 6c5f 7374         #model_st
-0003b910: 7269 6e67 2b27 6d61 785f 6974 6572 273a  ring+'max_iter':
-0003b920: 2073 705f 7261 6e64 496e 7428 3530 2c20   sp_randInt(50, 
-0003b930: 3530 3029 2c0a 2020 2020 2020 2020 2020  500),.          
-0003b940: 2020 236d 6f64 656c 5f73 7472 696e 672b    #model_string+
-0003b950: 276e 5f6e 6569 6768 626f 7273 273a 2073  'n_neighbors': s
-0003b960: 705f 7261 6e64 496e 7428 322c 2035 292c  p_randInt(2, 5),
-0003b970: 0a20 2020 2020 2020 2020 2020 2020 2020  .               
-0003b980: 207d 0a20 2020 2065 6c73 653a 0a20 2020   }.    else:.   
-0003b990: 2020 2020 2023 2323 2053 696e 6365 2077       ### Since w
-0003b9a0: 6520 646f 6e27 7420 6b6e 6f77 2077 6861  e don't know wha
-0003b9b0: 7420 6d6f 6465 6c20 7769 6c6c 2062 6520  t model will be 
-0003b9c0: 7365 6e74 2c20 7765 2063 616e 6e6f 7420  sent, we cannot 
-0003b9d0: 7475 6e65 2069 7420 2323 0a20 2020 2020  tune it ##.     
-0003b9e0: 2020 2070 6172 616d 7320 3d20 7b7d 0a20     params = {}. 
-0003b9f0: 2020 2020 2020 2072 6574 7572 6e20 6d6f         return mo
-0003ba00: 6465 6c0a 2020 2020 2323 2320 596f 7520  del.    ### You 
-0003ba10: 6d75 7374 206c 6561 7665 2052 616e 646f  must leave Rando
-0003ba20: 6d20 5374 6174 6520 6173 204e 6f6e 6520  m State as None 
-0003ba30: 7369 6e63 6520 7368 7566 666c 6520 6973  since shuffle is
-0003ba40: 2046 616c 7365 2e20 4f74 6865 7277 6973   False. Otherwis
-0003ba50: 652c 2065 7272 6f72 2120 0a20 2020 206b  e, error! .    k
-0003ba60: 666f 6c64 203d 204b 466f 6c64 286e 5f73  fold = KFold(n_s
-0003ba70: 706c 6974 733d 352c 2072 616e 646f 6d5f  plits=5, random_
-0003ba80: 7374 6174 653d 4e6f 6e65 2c20 7368 7566  state=None, shuf
-0003ba90: 666c 653d 4661 6c73 6529 0a20 2020 2069  fle=False).    i
-0003baa0: 6620 7665 7262 6f73 653a 0a20 2020 2020  f verbose:.     
-0003bab0: 2020 2070 7269 6e74 2822 4669 6e64 696e     print("Findin
-0003bac0: 6720 6265 7374 2070 6172 616d 7320 666f  g best params fo
-0003bad0: 7220 6261 7365 2065 7374 696d 6174 6f72  r base estimator
-0003bae0: 2075 7369 6e67 2052 616e 646f 6d69 7a65   using Randomize
-0003baf0: 6453 6561 7263 6843 562e 2e2e 2229 0a20  dSearchCV..."). 
-0003bb00: 2020 2063 6c66 203d 2052 616e 646f 6d69     clf = Randomi
-0003bb10: 7a65 6453 6561 7263 6843 5628 6d6f 6465  zedSearchCV(mode
-0003bb20: 6c2c 2070 6172 616d 732c 206e 5f69 7465  l, params, n_ite
-0003bb30: 723d 6e5f 6974 6572 2c20 7363 6f72 696e  r=n_iter, scorin
-0003bb40: 673d 7363 6f72 696e 672c 0a20 2020 2020  g=scoring,.     
-0003bb50: 2020 2020 2020 2020 2020 2020 2020 2020                  
-0003bb60: 2020 2020 6376 203d 206b 666f 6c64 2c20      cv = kfold, 
-0003bb70: 6e5f 6a6f 6273 3d2d 312c 2072 616e 646f  n_jobs=-1, rando
-0003bb80: 6d5f 7374 6174 653d 3130 3029 0a20 2020  m_state=100).   
-0003bb90: 200a 2020 2020 636c 662e 6669 7428 582c   .    clf.fit(X,
-0003bba0: 2079 290a 0a20 2020 2069 6620 7665 7262   y)..    if verb
-0003bbb0: 6f73 653a 0a20 2020 2020 2020 2070 7269  ose:.        pri
-0003bbc0: 6e74 2822 2020 2020 6265 7374 2073 636f  nt("    best sco
-0003bbd0: 7265 2069 7320 3a22 202c 2063 6c66 2e62  re is :" , clf.b
-0003bbe0: 6573 745f 7363 6f72 655f 290a 2020 2020  est_score_).    
-0003bbf0: 2020 2020 2370 7269 6e74 2822 2020 2020      #print("    
-0003bc00: 6265 7374 2065 7374 696d 6174 6f72 2069  best estimator i
-0003bc10: 7320 3a22 202c 2063 6c66 2e62 6573 745f  s :" , clf.best_
-0003bc20: 6573 7469 6d61 746f 725f 290a 2020 2020  estimator_).    
-0003bc30: 2020 2020 7072 696e 7428 2220 2020 2062      print("    b
-0003bc40: 6573 7420 5061 7261 6d73 2069 7320 3a22  est Params is :"
-0003bc50: 202c 2063 6c66 2e62 6573 745f 7061 7261   , clf.best_para
-0003bc60: 6d73 5f29 0a20 2020 2020 2020 2070 7269  ms_).        pri
-0003bc70: 6e74 2822 5469 6d65 2054 616b 656e 2066  nt("Time Taken f
-0003bc80: 6f72 2052 616e 646f 6d69 7a65 6453 6561  or RandomizedSea
-0003bc90: 7263 6843 563a 2025 302e 3066 2028 7365  rchCV: %0.0f (se
-0003bca0: 636f 6e64 7329 2220 2528 7469 6d65 2e74  conds)" %(time.t
-0003bcb0: 696d 6528 292d 7374 6172 7429 290a 2020  ime()-start)).  
-0003bcc0: 2020 7265 7475 726e 2063 6c66 2e62 6573    return clf.bes
-0003bcd0: 745f 6573 7469 6d61 746f 725f 0a23 2323  t_estimator_.###
-0003bce0: 2323 2323 2323 2323 2323 2323 2323 2323  ################
-0003bcf0: 2323 2323 2323 2323 2323 2323 2323 2323  ################
-0003bd00: 2323 2323 2323 2323 2323 2323 2323 2323  ################
-0003bd10: 2323 2323 2323 2323 2323 2323 2323 2323  ################
-0003bd20: 2323 2323 2323 2323 2323 2323 2323 230a  ###############.
-0003bd30: 2320 4361 6c63 756c 6174 6520 636c 6173  # Calculate clas
-0003bd40: 7320 7765 6967 6874 0a66 726f 6d20 736b  s weight.from sk
-0003bd50: 6c65 6172 6e2e 7574 696c 732e 636c 6173  learn.utils.clas
-0003bd60: 735f 7765 6967 6874 2069 6d70 6f72 7420  s_weight import 
-0003bd70: 636f 6d70 7574 655f 636c 6173 735f 7765  compute_class_we
-0003bd80: 6967 6874 0a69 6d70 6f72 7420 636f 7079  ight.import copy
-0003bd90: 0a66 726f 6d20 636f 6c6c 6563 7469 6f6e  .from collection
-0003bda0: 7320 696d 706f 7274 2043 6f75 6e74 6572  s import Counter
-0003bdb0: 0a64 6566 2066 696e 645f 7261 7265 5f63  .def find_rare_c
-0003bdc0: 6c61 7373 2863 6c61 7373 6573 2c20 7665  lass(classes, ve
-0003bdd0: 7262 6f73 653d 3029 3a0a 2020 2020 2323  rbose=0):.    ##
-0003bde0: 2323 2323 2323 2320 5072 696e 7420 7468  ####### Print th
-0003bdf0: 6520 2520 636f 756e 7420 6f66 2065 6163  e % count of eac
-0003be00: 6820 636c 6173 7320 696e 2061 2054 6172  h class in a Tar
-0003be10: 6765 7420 7661 7269 6162 6c65 2020 2323  get variable  ##
-0003be20: 2323 230a 2020 2020 2222 220a 2020 2020  ###.    """.    
-0003be30: 576f 726b 7320 6f6e 204d 756c 7469 2043  Works on Multi C
-0003be40: 6c61 7373 2074 6f6f 2e20 5072 696e 7473  lass too. Prints
-0003be50: 2063 6c61 7373 2070 6572 6365 6e74 6167   class percentag
-0003be60: 6573 2063 6f75 6e74 206f 6620 7461 7267  es count of targ
-0003be70: 6574 2076 6172 6961 626c 652e 0a20 2020  et variable..   
-0003be80: 2049 7420 7265 7475 726e 7320 7468 6520   It returns the 
-0003be90: 6e61 6d65 206f 6620 7468 6520 5261 7265  name of the Rare
-0003bea0: 2063 6c61 7373 2028 7468 6520 6f6e 6520   class (the one 
-0003beb0: 7769 7468 2074 6865 206d 696e 696d 756d  with the minimum
-0003bec0: 2063 6c61 7373 206d 656d 6265 7220 636f   class member co
-0003bed0: 756e 7429 2e0a 2020 2020 5468 6973 2063  unt)..    This c
-0003bee0: 616e 2061 6c73 6f20 6265 2068 656c 7066  an also be helpf
-0003bef0: 756c 2069 6e20 7573 696e 6720 6974 2061  ul in using it a
-0003bf00: 7320 706f 735f 6c61 6265 6c20 696e 2042  s pos_label in B
-0003bf10: 696e 6172 7920 616e 6420 4d75 6c74 6920  inary and Multi 
-0003bf20: 436c 6173 7320 7072 6f62 6c65 6d73 2e0a  Class problems..
-0003bf30: 2020 2020 2222 220a 2020 2020 636f 756e      """.    coun
-0003bf40: 7473 203d 204f 7264 6572 6564 4469 6374  ts = OrderedDict
-0003bf50: 2843 6f75 6e74 6572 2863 6c61 7373 6573  (Counter(classes
-0003bf60: 2929 0a20 2020 2074 6f74 616c 203d 2073  )).    total = s
-0003bf70: 756d 2863 6f75 6e74 732e 7661 6c75 6573  um(counts.values
-0003bf80: 2829 290a 2020 2020 6966 2076 6572 626f  ()).    if verbo
-0003bf90: 7365 203e 3d20 313a 0a20 2020 2020 2020  se >= 1:.       
-0003bfa0: 2070 7269 6e74 2827 2020 2020 2020 2043   print('       C
-0003bfb0: 6c61 7373 2020 2d3e 2043 6f75 6e74 7320  lass  -> Counts 
-0003bfc0: 2d3e 2050 6572 6365 6e74 2729 0a20 2020  -> Percent').   
-0003bfd0: 2020 2020 2073 6f72 7465 645f 6b65 7973       sorted_keys
-0003bfe0: 203d 2073 6f72 7465 6428 636f 756e 7473   = sorted(counts
-0003bff0: 2e6b 6579 7328 2929 0a20 2020 2020 2020  .keys()).       
-0003c000: 2066 6f72 2063 6c73 2069 6e20 736f 7274   for cls in sort
-0003c010: 6564 5f6b 6579 733a 0a20 2020 2020 2020  ed_keys:.       
-0003c020: 2020 2020 2070 7269 6e74 2822 2531 3273       print("%12s
-0003c030: 3a20 2520 3764 2020 2d3e 2020 2520 352e  : % 7d  ->  % 5.
-0003c040: 3166 2525 2220 2520 2863 6c73 2c20 636f  1f%%" % (cls, co
-0003c050: 756e 7473 5b63 6c73 5d2c 2063 6f75 6e74  unts[cls], count
-0003c060: 735b 636c 735d 2f74 6f74 616c 2a31 3030  s[cls]/total*100
-0003c070: 2929 0a20 2020 2069 6620 7479 7065 2870  )).    if type(p
-0003c080: 642e 5365 7269 6573 2863 6f75 6e74 7329  d.Series(counts)
-0003c090: 2e69 6478 6d69 6e28 2929 3d3d 7374 723a  .idxmin())==str:
-0003c0a0: 0a20 2020 2020 2020 2072 6574 7572 6e20  .        return 
-0003c0b0: 7064 2e53 6572 6965 7328 636f 756e 7473  pd.Series(counts
-0003c0c0: 292e 6964 786d 696e 2829 0a20 2020 2065  ).idxmin().    e
-0003c0d0: 6c73 653a 0a20 2020 2020 2020 2072 6574  lse:.        ret
-0003c0e0: 7572 6e20 696e 7428 7064 2e53 6572 6965  urn int(pd.Serie
-0003c0f0: 7328 636f 756e 7473 292e 6964 786d 696e  s(counts).idxmin
-0003c100: 2829 290a 2323 2323 2323 2323 2323 2323  ()).############
-0003c110: 2323 2323 2323 2323 2323 2323 2323 2323  ################
-0003c120: 2323 2323 2323 2323 2323 2323 2323 2323  ################
-0003c130: 2323 2323 2323 2323 2323 2323 2323 2323  ################
-0003c140: 2323 2323 2323 2323 2323 2323 2323 2323  ################
-0003c150: 2323 2323 2323 0a66 726f 6d20 636f 6c6c  ######.from coll
-0003c160: 6563 7469 6f6e 7320 696d 706f 7274 204f  ections import O
-0003c170: 7264 6572 6564 4469 6374 2020 2020 0a64  rderedDict    .d
-0003c180: 6566 2067 6574 5f63 6c61 7373 5f77 6569  ef get_class_wei
-0003c190: 6768 7473 2879 5f69 6e70 7574 2c20 7665  ghts(y_input, ve
-0003c1a0: 7262 6f73 653d 3029 3a20 2020 200a 2020  rbose=0):    .  
-0003c1b0: 2020 795f 696e 7075 7420 3d20 636f 7079    y_input = copy
-0003c1c0: 2e64 6565 7063 6f70 7928 795f 696e 7075  .deepcopy(y_inpu
-0003c1d0: 7429 0a20 2020 2069 6620 6973 696e 7374  t).    if isinst
-0003c1e0: 616e 6365 2879 5f69 6e70 7574 2c20 6e70  ance(y_input, np
-0003c1f0: 2e6e 6461 7272 6179 293a 0a20 2020 2020  .ndarray):.     
-0003c200: 2020 2079 5f69 6e70 7574 203d 2070 642e     y_input = pd.
-0003c210: 5365 7269 6573 2879 5f69 6e70 7574 290a  Series(y_input).
-0003c220: 2020 2020 656c 6966 2069 7369 6e73 7461      elif isinsta
-0003c230: 6e63 6528 795f 696e 7075 742c 2070 642e  nce(y_input, pd.
-0003c240: 5365 7269 6573 293a 0a20 2020 2020 2020  Series):.       
-0003c250: 2070 6173 730a 2020 2020 656c 6966 2069   pass.    elif i
-0003c260: 7369 6e73 7461 6e63 6528 795f 696e 7075  sinstance(y_inpu
-0003c270: 742c 2070 642e 4461 7461 4672 616d 6529  t, pd.DataFrame)
-0003c280: 3a0a 2020 2020 2020 2020 6966 206c 656e  :.        if len
-0003c290: 2879 5f69 6e70 7574 2e63 6f6c 756d 6e73  (y_input.columns
-0003c2a0: 2920 3e3d 2032 3a0a 2020 2020 2020 2020  ) >= 2:.        
-0003c2b0: 2020 2020 2323 2320 6966 2069 7420 6973      ### if it is
-0003c2c0: 2061 2064 6174 6166 7261 6d65 2c20 7265   a dataframe, re
-0003c2d0: 7475 726e 206f 6e6c 7920 6966 2069 7420  turn only if it 
-0003c2e0: 6973 206f 6e65 2063 6f6c 756d 6e20 6461  is one column da
-0003c2f0: 7461 6672 616d 6520 2323 0a20 2020 2020  taframe ##.     
-0003c300: 2020 2020 2020 2063 6c61 7373 5f77 6569         class_wei
-0003c310: 6768 7473 203d 2064 6963 7428 290a 2020  ghts = dict().  
-0003c320: 2020 2020 2020 2020 2020 666f 7220 6561            for ea
-0003c330: 6368 5f74 6172 6765 7420 696e 2079 5f69  ch_target in y_i
-0003c340: 6e70 7574 2e63 6f6c 756d 6e73 3a0a 2020  nput.columns:.  
-0003c350: 2020 2020 2020 2020 2020 2020 2020 636c                cl
-0003c360: 6173 735f 7765 6967 6874 735b 6561 6368  ass_weights[each
-0003c370: 5f74 6172 6765 745d 203d 2067 6574 5f63  _target] = get_c
-0003c380: 6c61 7373 5f77 6569 6768 7473 2879 5f69  lass_weights(y_i
-0003c390: 6e70 7574 5b65 6163 685f 7461 7267 6574  nput[each_target
-0003c3a0: 5d29 0a20 2020 2020 2020 2020 2020 2072  ]).            r
-0003c3b0: 6574 7572 6e20 636c 6173 735f 7765 6967  eturn class_weig
-0003c3c0: 6874 730a 2020 2020 2020 2020 656c 7365  hts.        else
-0003c3d0: 3a0a 2020 2020 2020 2020 2020 2020 795f  :.            y_
-0003c3e0: 696e 7075 7420 3d20 795f 696e 7075 742e  input = y_input.
-0003c3f0: 7661 6c75 6573 2e72 6573 6861 7065 282d  values.reshape(-
-0003c400: 3129 0a20 2020 2065 6c73 653a 0a20 2020  1).    else:.   
-0003c410: 2020 2020 2023 2323 2069 6620 796f 7520       ### if you 
-0003c420: 6361 6e6e 6f74 2064 6574 6563 7420 7468  cannot detect th
-0003c430: 6520 7479 7065 206f 7220 6966 2069 7420  e type or if it 
-0003c440: 6973 2061 206d 756c 7469 2d63 6f6c 756d  is a multi-colum
-0003c450: 6e20 6461 7461 6672 616d 652c 2069 676e  n dataframe, ign
-0003c460: 6f72 6520 6974 0a20 2020 2020 2020 2072  ore it.        r
-0003c470: 6574 7572 6e20 4e6f 6e65 0a20 2020 2063  eturn None.    c
-0003c480: 6c61 7373 6573 203d 206e 702e 756e 6971  lasses = np.uniq
-0003c490: 7565 2879 5f69 6e70 7574 290a 2020 2020  ue(y_input).    
-0003c4a0: 7261 7265 5f63 6c61 7373 203d 2066 696e  rare_class = fin
-0003c4b0: 645f 7261 7265 5f63 6c61 7373 2879 5f69  d_rare_class(y_i
-0003c4c0: 6e70 7574 290a 2020 2020 7870 203d 2043  nput).    xp = C
-0003c4d0: 6f75 6e74 6572 2879 5f69 6e70 7574 290a  ounter(y_input).
-0003c4e0: 2020 2020 636c 6173 735f 7765 6967 6874      class_weight
-0003c4f0: 7320 3d20 636f 6d70 7574 655f 636c 6173  s = compute_clas
-0003c500: 735f 7765 6967 6874 2827 6261 6c61 6e63  s_weight('balanc
-0003c510: 6564 272c 2063 6c61 7373 6573 3d63 6c61  ed', classes=cla
-0003c520: 7373 6573 2c20 793d 795f 696e 7075 7429  sses, y=y_input)
-0003c530: 0a20 2020 2063 6c61 7373 5f77 6569 6768  .    class_weigh
-0003c540: 7473 203d 204f 7264 6572 6564 4469 6374  ts = OrderedDict
-0003c550: 287a 6970 2863 6c61 7373 6573 2c20 6e70  (zip(classes, np
-0003c560: 2e72 6f75 6e64 2863 6c61 7373 5f77 6569  .round(class_wei
-0003c570: 6768 7473 2f63 6c61 7373 5f77 6569 6768  ghts/class_weigh
-0003c580: 7473 2e6d 696e 2829 292e 6173 7479 7065  ts.min()).astype
-0003c590: 2869 6e74 2929 290a 2020 2020 6966 2076  (int))).    if v
-0003c5a0: 6572 626f 7365 3a0a 2020 2020 2020 2020  erbose:.        
-0003c5b0: 7072 696e 7428 2743 6c61 7373 2077 6569  print('Class wei
-0003c5c0: 6768 7473 2075 7365 6420 696e 2063 6c61  ghts used in cla
-0003c5d0: 7373 6966 6965 7220 6172 653a 2025 7327  ssifier are: %s'
-0003c5e0: 2025 636c 6173 735f 7765 6967 6874 7329   %class_weights)
-0003c5f0: 0a20 2020 2072 6574 7572 6e20 636c 6173  .    return clas
-0003c600: 735f 7765 6967 6874 730a 0a66 726f 6d20  s_weights..from 
-0003c610: 636f 6c6c 6563 7469 6f6e 7320 696d 706f  collections impo
-0003c620: 7274 204f 7264 6572 6564 4469 6374 0a64  rt OrderedDict.d
-0003c630: 6566 2067 6574 5f73 6361 6c65 5f70 6f73  ef get_scale_pos
-0003c640: 5f77 6569 6768 7428 795f 696e 7075 742c  _weight(y_input,
-0003c650: 2076 6572 626f 7365 3d30 293a 0a20 2020   verbose=0):.   
-0003c660: 2063 6c61 7373 5f77 6569 6768 7465 645f   class_weighted_
-0003c670: 726f 7773 203d 2067 6574 5f63 6c61 7373  rows = get_class
-0003c680: 5f77 6569 6768 7473 2879 5f69 6e70 7574  _weights(y_input
-0003c690: 290a 2020 2020 6966 2069 7369 6e73 7461  ).    if isinsta
-0003c6a0: 6e63 6528 795f 696e 7075 742c 206e 702e  nce(y_input, np.
-0003c6b0: 6e64 6172 7261 7929 3a0a 2020 2020 2020  ndarray):.      
-0003c6c0: 2020 795f 696e 7075 7420 3d20 7064 2e53    y_input = pd.S
-0003c6d0: 6572 6965 7328 795f 696e 7075 7429 0a20  eries(y_input). 
-0003c6e0: 2020 2065 6c69 6620 6973 696e 7374 616e     elif isinstan
-0003c6f0: 6365 2879 5f69 6e70 7574 2c20 7064 2e53  ce(y_input, pd.S
-0003c700: 6572 6965 7329 3a0a 2020 2020 2020 2020  eries):.        
-0003c710: 7061 7373 0a20 2020 2065 6c69 6620 6973  pass.    elif is
-0003c720: 696e 7374 616e 6365 2879 5f69 6e70 7574  instance(y_input
-0003c730: 2c20 7064 2e44 6174 6146 7261 6d65 293a  , pd.DataFrame):
-0003c740: 0a20 2020 2020 2020 2069 6620 6c65 6e28  .        if len(
-0003c750: 795f 696e 7075 742e 636f 6c75 6d6e 7329  y_input.columns)
-0003c760: 203e 3d20 323a 0a20 2020 2020 2020 2020   >= 2:.         
-0003c770: 2020 2023 2323 2069 6620 6974 2069 7320     ### if it is 
-0003c780: 6120 6461 7461 6672 616d 652c 2072 6574  a dataframe, ret
-0003c790: 7572 6e20 6f6e 6c79 2069 6620 6974 2069  urn only if it i
-0003c7a0: 7320 6f6e 6520 636f 6c75 6d6e 2064 6174  s one column dat
-0003c7b0: 6166 7261 6d65 2023 230a 2020 2020 2020  aframe ##.      
-0003c7c0: 2020 2020 2020 7261 7265 5f63 6c61 7373        rare_class
-0003c7d0: 5f77 6569 6768 7473 203d 204f 7264 6572  _weights = Order
-0003c7e0: 6564 4469 6374 2829 0a20 2020 2020 2020  edDict().       
-0003c7f0: 2020 2020 2066 6f72 2065 6163 685f 7461       for each_ta
-0003c800: 7267 6574 2069 6e20 795f 696e 7075 742e  rget in y_input.
-0003c810: 636f 6c75 6d6e 733a 0a20 2020 2020 2020  columns:.       
-0003c820: 2020 2020 2020 2020 2072 6172 655f 636c           rare_cl
-0003c830: 6173 735f 7765 6967 6874 735b 6561 6368  ass_weights[each
-0003c840: 5f74 6172 6765 745d 203d 2067 6574 5f73  _target] = get_s
-0003c850: 6361 6c65 5f70 6f73 5f77 6569 6768 7428  cale_pos_weight(
-0003c860: 795f 696e 7075 745b 6561 6368 5f74 6172  y_input[each_tar
-0003c870: 6765 745d 290a 2020 2020 2020 2020 2020  get]).          
-0003c880: 2020 7265 7475 726e 2072 6172 655f 636c    return rare_cl
-0003c890: 6173 735f 7765 6967 6874 730a 2020 2020  ass_weights.    
-0003c8a0: 2020 2020 656c 7365 3a0a 2020 2020 2020      else:.      
-0003c8b0: 2020 2020 2020 795f 696e 7075 7420 3d20        y_input = 
-0003c8c0: 795f 696e 7075 742e 7661 6c75 6573 2e72  y_input.values.r
-0003c8d0: 6573 6861 7065 282d 3129 0a20 2020 200a  eshape(-1).    .
-0003c8e0: 2020 2020 7261 7265 5f63 6c61 7373 203d      rare_class =
-0003c8f0: 2066 696e 645f 7261 7265 5f63 6c61 7373   find_rare_class
-0003c900: 2879 5f69 6e70 7574 290a 2020 2020 7261  (y_input).    ra
-0003c910: 7265 5f63 6c61 7373 5f77 6569 6768 7420  re_class_weight 
-0003c920: 3d20 636c 6173 735f 7765 6967 6874 6564  = class_weighted
-0003c930: 5f72 6f77 735b 7261 7265 5f63 6c61 7373  _rows[rare_class
-0003c940: 5d0a 2020 2020 6966 2076 6572 626f 7365  ].    if verbose
-0003c950: 3a0a 2020 2020 2020 2020 7072 696e 7428  :.        print(
-0003c960: 2720 2020 2046 6f72 2063 6c61 7373 2025  '    For class %
-0003c970: 732c 2077 6569 6768 7420 3d20 2573 2720  s, weight = %s' 
-0003c980: 2528 7261 7265 5f63 6c61 7373 2c20 7261  %(rare_class, ra
-0003c990: 7265 5f63 6c61 7373 5f77 6569 6768 7429  re_class_weight)
-0003c9a0: 290a 2020 2020 7265 7475 726e 2072 6172  ).    return rar
-0003c9b0: 655f 636c 6173 735f 7765 6967 6874 0a23  e_class_weight.#
-0003c9c0: 2323 2323 2323 2323 2323 2323 2323 2323  ################
-0003c9d0: 2323 2323 2323 2323 2323 2323 2323 2323  ################
-0003c9e0: 2323 2323 2323 2323 2323 2323 2323 2323  ################
-0003c9f0: 2323 2323 2323 2323 2323 2323 2323 2323  ################
-0003ca00: 2323 2323 2323 2323 230a 6672 6f6d 2063  #########.from c
-0003ca10: 6f6c 6c65 6374 696f 6e73 2069 6d70 6f72  ollections impor
-0003ca20: 7420 6465 6661 756c 7464 6963 740a 6672  t defaultdict.fr
-0003ca30: 6f6d 2063 6f6c 6c65 6374 696f 6e73 2069  om collections i
-0003ca40: 6d70 6f72 7420 4f72 6465 7265 6444 6963  mport OrderedDic
-0003ca50: 740a 6465 6620 7265 7475 726e 5f6d 696e  t.def return_min
-0003ca60: 6f72 6974 795f 7361 6d70 6c65 7328 792c  ority_samples(y,
-0003ca70: 2076 6572 626f 7365 3d30 293a 0a20 2020   verbose=0):.   
-0003ca80: 2022 2222 0a20 2020 2023 2323 2320 4361   """.    #### Ca
-0003ca90: 6c63 756c 6174 6573 2074 6865 2025 2063  lculates the % c
-0003caa0: 6f75 6e74 206f 6620 6561 6368 2063 6c61  ount of each cla
-0003cab0: 7373 2069 6e20 7920 616e 6420 7265 7475  ss in y and retu
-0003cac0: 726e 7320 6120 0a20 2020 2023 2323 2320  rns a .    #### 
-0003cad0: 736d 616c 6c65 7220 7365 7420 6f66 2079  smaller set of y
-0003cae0: 2062 6173 6564 206f 6e20 6265 696e 6720   based on being 
-0003caf0: 3525 206f 7220 6c65 7373 206f 6620 6461  5% or less of da
-0003cb00: 7461 7365 742e 0a20 2020 2049 7420 7265  taset..    It re
-0003cb10: 7475 726e 7320 7468 6520 736d 616c 6c20  turns the small 
-0003cb20: 7920 6173 2061 6e20 6172 7261 7920 6f72  y as an array or
-0003cb30: 2064 6174 6166 7261 6d65 2061 7320 696e   dataframe as in
-0003cb40: 7075 7420 7920 7761 732e 0a20 2020 2022  put y was..    "
-0003cb50: 2222 0a20 2020 2069 6d70 6f72 7420 636f  "".    import co
-0003cb60: 7079 0a20 2020 2079 203d 2063 6f70 792e  py.    y = copy.
-0003cb70: 6465 6570 636f 7079 2879 290a 2020 2020  deepcopy(y).    
-0003cb80: 6966 2069 7369 6e73 7461 6e63 6528 792c  if isinstance(y,
-0003cb90: 206e 702e 6e64 6172 7261 7929 3a0a 2020   np.ndarray):.  
-0003cba0: 2020 2020 2020 6c73 203d 2070 642e 5365        ls = pd.Se
-0003cbb0: 7269 6573 2879 292e 7661 6c75 655f 636f  ries(y).value_co
-0003cbc0: 756e 7473 2829 5b28 7064 2e53 6572 6965  unts()[(pd.Serie
-0003cbd0: 7328 7929 2e76 616c 7565 5f63 6f75 6e74  s(y).value_count
-0003cbe0: 7328 3129 3c3d 302e 3035 292e 7661 6c75  s(1)<=0.05).valu
-0003cbf0: 6573 5d2e 696e 6465 780a 2020 2020 2020  es].index.      
-0003cc00: 2020 7265 7475 726e 2079 5b70 642e 5365    return y[pd.Se
-0003cc10: 7269 6573 2879 292e 6973 696e 286c 7329  ries(y).isin(ls)
-0003cc20: 2e76 616c 7565 735d 0a20 2020 2065 6c73  .values].    els
-0003cc30: 653a 0a20 2020 2020 2020 2069 6620 6973  e:.        if is
-0003cc40: 696e 7374 616e 6365 2879 2c20 7064 2e53  instance(y, pd.S
-0003cc50: 6572 6965 7329 3a0a 2020 2020 2020 2020  eries):.        
-0003cc60: 2020 2020 6c73 203d 2079 2e76 616c 7565      ls = y.value
-0003cc70: 5f63 6f75 6e74 7328 295b 2879 2e76 616c  _counts()[(y.val
-0003cc80: 7565 5f63 6f75 6e74 7328 3129 3c3d 302e  ue_counts(1)<=0.
-0003cc90: 3035 292e 7661 6c75 6573 5d2e 696e 6465  05).values].inde
-0003cca0: 780a 2020 2020 2020 2020 656c 7365 3a0a  x.        else:.
-0003ccb0: 2020 2020 2020 2020 2020 2020 7920 3d20              y = 
-0003ccc0: 792e 696c 6f63 5b3a 2c30 5d0a 2020 2020  y.iloc[:,0].    
-0003ccd0: 2020 2020 2020 2020 6c73 203d 2079 2e76          ls = y.v
-0003cce0: 616c 7565 5f63 6f75 6e74 7328 295b 2879  alue_counts()[(y
-0003ccf0: 2e76 616c 7565 5f63 6f75 6e74 7328 3129  .value_counts(1)
-0003cd00: 3c3d 302e 3035 292e 7661 6c75 6573 5d2e  <=0.05).values].
-0003cd10: 696e 6465 780a 2020 2020 2020 2020 7265  index.        re
-0003cd20: 7475 726e 2079 5b79 2e69 7369 6e28 6c73  turn y[y.isin(ls
-0003cd30: 295d 0a0a 6465 6620 6e75 6d5f 636c 6173  )]..def num_clas
-0003cd40: 7365 7328 792c 2076 6572 626f 7365 3d30  ses(y, verbose=0
-0003cd50: 293a 0a20 2020 2022 2222 0a20 2020 2023  ):.    """.    #
-0003cd60: 2323 2052 6574 7572 6e73 206e 756d 6265  ## Returns numbe
-0003cd70: 7220 6f66 2063 6c61 7373 6573 2069 6e20  r of classes in 
-0003cd80: 790a 2020 2020 2222 220a 2020 2020 696d  y.    """.    im
-0003cd90: 706f 7274 2063 6f70 790a 2020 2020 7920  port copy.    y 
-0003cda0: 3d20 636f 7079 2e64 6565 7063 6f70 7928  = copy.deepcopy(
-0003cdb0: 7929 0a20 2020 2069 6620 6973 696e 7374  y).    if isinst
-0003cdc0: 616e 6365 2879 2c20 6e70 2e6e 6461 7272  ance(y, np.ndarr
-0003cdd0: 6179 293a 0a20 2020 2020 2020 206c 7320  ay):.        ls 
-0003cde0: 3d20 7064 2e53 6572 6965 7328 7929 2e6e  = pd.Series(y).n
-0003cdf0: 756e 6971 7565 2829 0a20 2020 2065 6c73  unique().    els
-0003ce00: 653a 0a20 2020 2020 2020 2069 6620 6973  e:.        if is
-0003ce10: 696e 7374 616e 6365 2879 2c20 7064 2e53  instance(y, pd.S
-0003ce20: 6572 6965 7329 3a0a 2020 2020 2020 2020  eries):.        
-0003ce30: 2020 2020 6c73 203d 2079 2e6e 756e 6971      ls = y.nuniq
-0003ce40: 7565 2829 0a20 2020 2020 2020 2065 6c73  ue().        els
-0003ce50: 653a 0a20 2020 2020 2020 2020 2020 2069  e:.            i
-0003ce60: 6620 6c65 6e28 792e 636f 6c75 6d6e 7329  f len(y.columns)
-0003ce70: 203e 3d20 323a 0a20 2020 2020 2020 2020   >= 2:.         
-0003ce80: 2020 2020 2020 206c 7320 3d20 4f72 6465         ls = Orde
-0003ce90: 7265 6444 6963 7428 290a 2020 2020 2020  redDict().      
-0003cea0: 2020 2020 2020 2020 2020 666f 7220 6561            for ea
-0003ceb0: 6368 5f69 2069 6e20 792e 636f 6c75 6d6e  ch_i in y.column
-0003cec0: 733a 0a20 2020 2020 2020 2020 2020 2020  s:.             
-0003ced0: 2020 2020 2020 206c 735b 6561 6368 5f69         ls[each_i
-0003cee0: 5d20 3d20 795b 6561 6368 5f69 5d2e 6e75  ] = y[each_i].nu
-0003cef0: 6e69 7175 6528 290a 2020 2020 2020 2020  nique().        
-0003cf00: 2020 2020 2020 2020 7265 7475 726e 206c          return l
-0003cf10: 730a 2020 2020 2020 2020 2020 2020 656c  s.            el
-0003cf20: 7365 3a0a 2020 2020 2020 2020 2020 2020  se:.            
-0003cf30: 2020 2020 6c73 203d 2079 2e6e 756e 6971      ls = y.nuniq
-0003cf40: 7565 2829 5b30 5d0a 2020 2020 7265 7475  ue()[0].    retu
-0003cf50: 726e 206c 730a 0a64 6566 2072 6574 7572  rn ls..def retur
-0003cf60: 6e5f 6d69 6e6f 7269 7479 5f63 6c61 7373  n_minority_class
-0003cf70: 6573 2879 2c20 7665 7262 6f73 653d 3029  es(y, verbose=0)
-0003cf80: 3a0a 2020 2020 2222 220a 2020 2020 2323  :.    """.    ##
-0003cf90: 2323 2043 616c 6375 6c61 7465 7320 7468  ## Calculates th
-0003cfa0: 6520 2520 636f 756e 7420 6f66 2065 6163  e % count of eac
-0003cfb0: 6820 636c 6173 7320 696e 2079 2061 6e64  h class in y and
-0003cfc0: 2072 6574 7572 6e73 2061 200a 2020 2020   returns a .    
-0003cfd0: 2323 2323 2073 6d61 6c6c 6572 2073 6574  #### smaller set
-0003cfe0: 206f 6620 7920 6261 7365 6420 6f6e 2062   of y based on b
-0003cff0: 6569 6e67 2035 2520 6f72 206c 6573 7320  eing 5% or less 
-0003d000: 6f66 2064 6174 6173 6574 2e0a 2020 2020  of dataset..    
-0003d010: 4974 2072 6574 7572 6e73 2074 6865 206c  It returns the l
-0003d020: 6973 7420 6f66 2063 6c61 7373 6573 2074  ist of classes t
-0003d030: 6861 7420 6172 6520 3c3d 3525 2063 6c61  hat are <=5% cla
-0003d040: 7373 6573 2e0a 2020 2020 2222 220a 2020  sses..    """.  
-0003d050: 2020 696d 706f 7274 2063 6f70 790a 2020    import copy.  
-0003d060: 2020 7920 3d20 636f 7079 2e64 6565 7063    y = copy.deepc
-0003d070: 6f70 7928 7929 0a20 2020 2069 6620 6973  opy(y).    if is
-0003d080: 696e 7374 616e 6365 2879 2c20 6e70 2e6e  instance(y, np.n
-0003d090: 6461 7272 6179 293a 0a20 2020 2020 2020  darray):.       
-0003d0a0: 206c 7320 3d20 7064 2e53 6572 6965 7328   ls = pd.Series(
-0003d0b0: 7929 2e76 616c 7565 5f63 6f75 6e74 7328  y).value_counts(
-0003d0c0: 295b 2870 642e 5365 7269 6573 2879 292e  )[(pd.Series(y).
-0003d0d0: 7661 6c75 655f 636f 756e 7473 2831 293c  value_counts(1)<
-0003d0e0: 3d30 2e30 3529 2e76 616c 7565 735d 2e69  =0.05).values].i
-0003d0f0: 6e64 6578 0a20 2020 2065 6c73 653a 0a20  ndex.    else:. 
-0003d100: 2020 2020 2020 2069 6620 6973 696e 7374         if isinst
-0003d110: 616e 6365 2879 2c20 7064 2e53 6572 6965  ance(y, pd.Serie
-0003d120: 7329 3a0a 2020 2020 2020 2020 2020 2020  s):.            
-0003d130: 6c73 203d 2079 2e76 616c 7565 5f63 6f75  ls = y.value_cou
-0003d140: 6e74 7328 295b 2879 2e76 616c 7565 5f63  nts()[(y.value_c
-0003d150: 6f75 6e74 7328 3129 3c3d 302e 3035 292e  ounts(1)<=0.05).
-0003d160: 7661 6c75 6573 5d2e 696e 6465 780a 2020  values].index.  
-0003d170: 2020 2020 2020 656c 7365 3a0a 2020 2020        else:.    
-0003d180: 2020 2020 2020 2020 7920 3d20 792e 696c          y = y.il
-0003d190: 6f63 5b3a 2c30 5d0a 2020 2020 2020 2020  oc[:,0].        
-0003d1a0: 2020 2020 6c73 203d 2079 2e76 616c 7565      ls = y.value
-0003d1b0: 5f63 6f75 6e74 7328 295b 2879 2e76 616c  _counts()[(y.val
-0003d1c0: 7565 5f63 6f75 6e74 7328 3129 3c3d 302e  ue_counts(1)<=0.
-0003d1d0: 3035 292e 7661 6c75 6573 5d2e 696e 6465  05).values].inde
-0003d1e0: 780a 2020 2020 7265 7475 726e 206c 730a  x.    return ls.
-0003d1f0: 2323 2323 2323 2323 2323 2323 2323 2323  ################
-0003d200: 2323 2323 2323 2323 2323 2323 2323 2323  ################
-0003d210: 2323 2323 2323 2323 2323 2323 2323 2323  ################
-0003d220: 2323 2323 2323 2323 2323 2323 2323 2323  ################
-0003d230: 2323 2323 2323 2323 2323 2323 2323 2323  ################
-0003d240: 230a 6465 6620 6765 745f 6361 7264 696e  #.def get_cardin
-0003d250: 616c 6974 7928 582c 2063 6174 5f66 6561  ality(X, cat_fea
-0003d260: 7475 7265 7329 3a0a 2020 2020 2323 2070  tures):.    ## p
-0003d270: 6963 6b20 6120 6c69 6d69 7420 666f 7220  ick a limit for 
-0003d280: 6361 7264 696e 616c 2076 6172 6961 626c  cardinal variabl
-0003d290: 6573 2068 6572 6520 2323 0a20 2020 2063  es here ##.    c
-0003d2a0: 6174 5f6c 696d 6974 203d 2033 300a 2020  at_limit = 30.  
-0003d2b0: 2020 6d61 736b 203d 2058 5b63 6174 5f66    mask = X[cat_f
-0003d2c0: 6561 7475 7265 735d 2e6e 756e 6971 7565  eatures].nunique
-0003d2d0: 2829 203e 2063 6174 5f6c 696d 6974 0a20  () > cat_limit. 
-0003d2e0: 2020 2068 6967 685f 6361 7264 696e 616c     high_cardinal
-0003d2f0: 5f76 6172 7320 3d20 6361 745f 6665 6174  _vars = cat_feat
-0003d300: 7572 6573 5b6d 6173 6b5d 0a20 2020 206c  ures[mask].    l
-0003d310: 6f77 5f63 6172 6469 6e61 6c5f 7661 7273  ow_cardinal_vars
-0003d320: 203d 2063 6174 5f66 6561 7475 7265 735b   = cat_features[
-0003d330: 7e6d 6173 6b5d 0a20 2020 2072 6574 7572  ~mask].    retur
-0003d340: 6e20 6c6f 775f 6361 7264 696e 616c 5f76  n low_cardinal_v
-0003d350: 6172 732c 2068 6967 685f 6361 7264 696e  ars, high_cardin
-0003d360: 616c 5f76 6172 730a 2323 2323 2323 2323  al_vars.########
-0003d370: 2323 2323 2323 2323 2323 2323 2323 2323  ################
-0003d380: 2323 2323 2323 2323 2323 2323 2323 2323  ################
-0003d390: 2323 2323 2323 2323 2323 2323 2323 2323  ################
-0003d3a0: 2323 2323 2323 2323 2323 2323 2323 2323  ################
-0003d3b0: 2323 2323 2323 2323 0a64 6566 2069 735f  ########.def is_
-0003d3c0: 795f 6f62 6a65 6374 2879 293a 0a20 2020  y_object(y):.   
-0003d3d0: 2074 6573 7431 203d 2028 792e 6474 7970   test1 = (y.dtyp
-0003d3e0: 6573 2e61 6e79 2829 3d3d 6f62 6a65 6374  es.any()==object
-0003d3f0: 2920 7c20 2879 2e64 7479 7065 732e 616e  ) | (y.dtypes.an
-0003d400: 7928 293d 3d62 6f6f 6c29 0a20 2020 2074  y()==bool).    t
-0003d410: 6573 7432 203d 2073 7472 2879 2e64 7479  est2 = str(y.dty
-0003d420: 7065 732e 616e 7928 2929 3d3d 2763 6174  pes.any())=='cat
-0003d430: 6567 6f72 7927 0a20 2020 2072 6574 7572  egory'.    retur
-0003d440: 6e20 7465 7374 3120 7c20 7465 7374 320a  n test1 | test2.
-0003d450: 0a64 6566 2070 7269 6e74 5f66 6c61 7474  .def print_flatt
-0003d460: 656e 5f64 6963 7428 6464 2c20 7365 7061  en_dict(dd, sepa
-0003d470: 7261 746f 723d 275f 272c 2070 7265 6669  rator='_', prefi
-0003d480: 783d 2727 293a 0a20 2020 2023 2323 2074  x=''):.    ### t
-0003d490: 6869 7320 6675 6e63 7469 6f6e 2069 7320  his function is 
-0003d4a0: 746f 2066 6c61 7474 656e 2064 6963 7420  to flatten dict 
-0003d4b0: 746f 2070 7269 6e74 2063 6c61 7373 6573  to print classes
-0003d4c0: 2061 6e64 2074 6865 6972 206f 7264 6572   and their order
-0003d4d0: 2023 2323 0a20 2020 2023 2323 204f 6e65   ###.    ### One
-0003d4e0: 2073 6f6c 7574 696f 6e20 6865 7265 3a20   solution here: 
-0003d4f0: 6874 7470 733a 2f2f 7374 6163 6b6f 7665  https://stackove
-0003d500: 7266 6c6f 772e 636f 6d2f 7175 6573 7469  rflow.com/questi
-0003d510: 6f6e 732f 3630 3237 3535 382f 666c 6174  ons/6027558/flat
-0003d520: 7465 6e2d 6e65 7374 6564 2d64 6963 7469  ten-nested-dicti
-0003d530: 6f6e 6172 6965 732d 636f 6d70 7265 7373  onaries-compress
-0003d540: 696e 672d 6b65 7973 0a20 2020 2023 2323  ing-keys.    ###
-0003d550: 2049 2068 6176 6520 6d6f 6469 6669 6564   I have modified
-0003d560: 2069 7420 746f 206d 616b 6520 6974 2077   it to make it w
-0003d570: 6f72 6b20 666f 7220 6d65 2023 2323 2323  ork for me #####
-0003d580: 2323 2323 2323 2323 2323 2323 0a20 2020  ############.   
-0003d590: 2072 6574 7572 6e20 7b20 7072 6566 6978   return { prefix
-0003d5a0: 202b 2073 6570 6172 6174 6f72 202b 2073   + separator + s
-0003d5b0: 7472 286b 2920 6966 2070 7265 6669 7820  tr(k) if prefix 
-0003d5c0: 656c 7365 206b 203a 2076 0a20 2020 2020  else k : v.     
-0003d5d0: 2020 2020 2020 2020 666f 7220 6b6b 2c20          for kk, 
-0003d5e0: 7676 2069 6e20 6464 2e69 7465 6d73 2829  vv in dd.items()
-0003d5f0: 0a20 2020 2020 2020 2020 2020 2020 666f  .             fo
-0003d600: 7220 6b2c 2076 2069 6e20 7072 696e 745f  r k, v in print_
-0003d610: 666c 6174 7465 6e5f 6469 6374 2876 762c  flatten_dict(vv,
-0003d620: 2073 6570 6172 6174 6f72 2c20 6b6b 292e   separator, kk).
-0003d630: 6974 656d 7328 290a 2020 2020 2020 2020  items().        
-0003d640: 2020 2020 207d 2069 6620 6973 696e 7374       } if isinst
-0003d650: 616e 6365 2864 642c 2064 6963 7429 2065  ance(dd, dict) e
-0003d660: 6c73 6520 7b20 7072 6566 6978 203a 2064  lse { prefix : d
-0003d670: 6420 7d0a 0a64 6566 2070 7269 6e74 5f61  d }..def print_a
-0003d680: 6363 7572 6163 7928 7461 7267 6574 2c20  ccuracy(target, 
-0003d690: 795f 7465 7374 2c20 795f 7072 6564 732c  y_test, y_preds,
-0003d6a0: 2076 6572 626f 7365 3d30 293a 0a20 2020   verbose=0):.   
-0003d6b0: 2062 616c 5f73 636f 7265 7320 3d20 5b5d   bal_scores = []
-0003d6c0: 0a20 2020 200a 2020 2020 6672 6f6d 2073  .    .    from s
-0003d6d0: 6b6c 6561 726e 2e6d 6574 7269 6373 2069  klearn.metrics i
-0003d6e0: 6d70 6f72 7420 6261 6c61 6e63 6564 5f61  mport balanced_a
-0003d6f0: 6363 7572 6163 795f 7363 6f72 652c 2063  ccuracy_score, c
-0003d700: 6c61 7373 6966 6963 6174 696f 6e5f 7265  lassification_re
-0003d710: 706f 7274 0a20 2020 2069 6620 6973 696e  port.    if isin
-0003d720: 7374 616e 6365 2874 6172 6765 742c 2073  stance(target, s
-0003d730: 7472 293a 200a 2020 2020 2020 2020 6261  tr): .        ba
-0003d740: 6c5f 7363 6f72 6520 3d20 6261 6c61 6e63  l_score = balanc
-0003d750: 6564 5f61 6363 7572 6163 795f 7363 6f72  ed_accuracy_scor
-0003d760: 6528 795f 7465 7374 2c79 5f70 7265 6473  e(y_test,y_preds
-0003d770: 290a 2020 2020 2020 2020 6261 6c5f 7363  ).        bal_sc
-0003d780: 6f72 6573 2e61 7070 656e 6428 6261 6c5f  ores.append(bal_
-0003d790: 7363 6f72 6529 0a20 2020 2020 2020 2069  score).        i
-0003d7a0: 6620 7665 7262 6f73 653a 0a20 2020 2020  f verbose:.     
-0003d7b0: 2020 2020 2020 2070 7269 6e74 2827 4261         print('Ba
-0003d7c0: 6c20 6163 6375 2025 302e 3066 2525 2720  l accu %0.0f%%' 
-0003d7d0: 2528 3130 302a 6261 6c5f 7363 6f72 6529  %(100*bal_score)
-0003d7e0: 290a 2020 2020 2020 2020 2020 2020 7072  ).            pr
-0003d7f0: 696e 7428 636c 6173 7369 6669 6361 7469  int(classificati
-0003d800: 6f6e 5f72 6570 6f72 7428 795f 7465 7374  on_report(y_test
-0003d810: 2c79 5f70 7265 6473 2929 0a20 2020 2065  ,y_preds)).    e
-0003d820: 6c69 6620 6c65 6e28 7461 7267 6574 2920  lif len(target) 
-0003d830: 3c3d 2031 3a0a 2020 2020 2020 2020 6261  <= 1:.        ba
-0003d840: 6c5f 7363 6f72 6520 3d20 6261 6c61 6e63  l_score = balanc
-0003d850: 6564 5f61 6363 7572 6163 795f 7363 6f72  ed_accuracy_scor
-0003d860: 6528 795f 7465 7374 2c79 5f70 7265 6473  e(y_test,y_preds
-0003d870: 290a 2020 2020 2020 2020 6261 6c5f 7363  ).        bal_sc
-0003d880: 6f72 6573 2e61 7070 656e 6428 6261 6c5f  ores.append(bal_
-0003d890: 7363 6f72 6529 0a20 2020 2020 2020 2069  score).        i
-0003d8a0: 6620 7665 7262 6f73 653a 0a20 2020 2020  f verbose:.     
-0003d8b0: 2020 2020 2020 2070 7269 6e74 2827 4261         print('Ba
-0003d8c0: 6c20 6163 6375 2025 302e 3066 2525 2720  l accu %0.0f%%' 
-0003d8d0: 2528 3130 302a 6261 6c5f 7363 6f72 6529  %(100*bal_score)
-0003d8e0: 290a 2020 2020 2020 2020 2020 2020 7072  ).            pr
-0003d8f0: 696e 7428 636c 6173 7369 6669 6361 7469  int(classificati
-0003d900: 6f6e 5f72 6570 6f72 7428 795f 7465 7374  on_report(y_test
-0003d910: 2c79 5f70 7265 6473 2929 0a20 2020 2065  ,y_preds)).    e
-0003d920: 6c73 653a 0a20 2020 2020 2020 2066 6f72  lse:.        for
-0003d930: 2065 6163 685f 692c 2074 6172 6765 745f   each_i, target_
-0003d940: 6e61 6d65 2069 6e20 656e 756d 6572 6174  name in enumerat
-0003d950: 6528 7461 7267 6574 293a 0a20 2020 2020  e(target):.     
-0003d960: 2020 2020 2020 2062 616c 5f73 636f 7265         bal_score
-0003d970: 203d 2062 616c 616e 6365 645f 6163 6375   = balanced_accu
-0003d980: 7261 6379 5f73 636f 7265 2879 5f74 6573  racy_score(y_tes
-0003d990: 742e 7661 6c75 6573 5b3a 2c65 6163 685f  t.values[:,each_
-0003d9a0: 695d 2c79 5f70 7265 6473 5b3a 2c65 6163  i],y_preds[:,eac
-0003d9b0: 685f 695d 290a 2020 2020 2020 2020 2020  h_i]).          
-0003d9c0: 2020 6261 6c5f 7363 6f72 6573 2e61 7070    bal_scores.app
-0003d9d0: 656e 6428 6261 6c5f 7363 6f72 6529 0a20  end(bal_score). 
-0003d9e0: 2020 2020 2020 2020 2020 2069 6620 7665             if ve
-0003d9f0: 7262 6f73 653a 0a20 2020 2020 2020 2020  rbose:.         
-0003da00: 2020 2020 2020 2069 6620 6561 6368 5f69         if each_i
-0003da10: 203d 3d20 303a 0a20 2020 2020 2020 2020   == 0:.         
-0003da20: 2020 2020 2020 2020 2020 2070 7269 6e74             print
-0003da30: 2827 466f 7220 2573 3a27 2025 7461 7267  ('For %s:' %targ
-0003da40: 6574 5f6e 616d 6529 0a20 2020 2020 2020  et_name).       
-0003da50: 2020 2020 2020 2020 2070 7269 6e74 2827           print('
-0003da60: 2020 2020 4261 6c20 6163 6375 2025 302e      Bal accu %0.
-0003da70: 3066 2525 2720 2528 3130 302a 6261 6c5f  0f%%' %(100*bal_
-0003da80: 7363 6f72 6529 290a 2020 2020 2020 2020  score)).        
-0003da90: 2020 2020 2020 2020 7072 696e 7428 636c          print(cl
-0003daa0: 6173 7369 6669 6361 7469 6f6e 5f72 6570  assification_rep
-0003dab0: 6f72 7428 795f 7465 7374 2e76 616c 7565  ort(y_test.value
-0003dac0: 735b 3a2c 6561 6368 5f69 5d2c 795f 7072  s[:,each_i],y_pr
-0003dad0: 6564 735b 3a2c 6561 6368 5f69 5d29 290a  eds[:,each_i])).
-0003dae0: 2020 2020 7265 7475 726e 206e 702e 6d65      return np.me
-0003daf0: 616e 2862 616c 5f73 636f 7265 7329 0a23  an(bal_scores).#
-0003db00: 2323 2323 2323 2323 2323 2323 2323 2323  ################
-0003db10: 2323 2323 2323 2323 2323 2323 2323 2323  ################
-0003db20: 2323 2323 2323 2323 2323 2323 2323 2323  ################
-0003db30: 2323 2323 2323 2323 2323 2323 2323 2323  ################
-0003db40: 2323 2323 2323 2323 2323 2323 2323 2323  ################
-0003db50: 2323 2323 2323 2323 230a 6672 6f6d 2063  #########.from c
-0003db60: 6f6c 6c65 6374 696f 6e73 2069 6d70 6f72  ollections impor
-0003db70: 7420 6465 6661 756c 7464 6963 740a 6465  t defaultdict.de
-0003db80: 6620 7265 7475 726e 5f70 7265 6469 6374  f return_predict
-0003db90: 5f70 726f 6261 2879 5f70 726f 6261 7329  _proba(y_probas)
-0003dba0: 3a0a 2020 2020 2323 2320 5468 6973 2069  :.    ### This i
-0003dbb0: 7320 666f 7220 6465 7465 6374 696e 6720  s for detecting 
-0003dbc0: 7768 6174 2d6c 6162 656c 2077 6861 742d  what-label what-
-0003dbd0: 636c 6173 7320 7072 6f62 6c65 6d73 2077  class problems w
-0003dbe0: 6974 6820 7072 6f62 6173 2023 2323 230a  ith probas ####.
-0003dbf0: 2020 2020 7072 6f62 6c65 6d74 7970 6520      problemtype 
-0003dc00: 3d20 2222 0a20 2020 2069 6620 6973 696e  = "".    if isin
-0003dc10: 7374 616e 6365 2879 5f70 726f 6261 732c  stance(y_probas,
-0003dc20: 206c 6973 7429 3a0a 2020 2020 2020 2020   list):.        
-0003dc30: 2323 2320 795f 7072 6f62 6173 2069 7320  ### y_probas is 
-0003dc40: 6120 6c69 7374 2077 6865 6e20 7920 6973  a list when y is
-0003dc50: 206d 756c 7469 2d6c 6162 656c 2e20 0a20   multi-label. . 
-0003dc60: 2020 2020 2020 2069 6620 6973 696e 7374         if isinst
-0003dc70: 616e 6365 2879 5f70 726f 6261 735b 305d  ance(y_probas[0]
-0003dc80: 2c20 6c69 7374 293a 0a20 2020 2020 2020  , list):.       
-0003dc90: 2020 2020 2023 2320 2020 2031 2e20 4966       ##    1. If
-0003dca0: 2079 2069 7320 6d75 6c74 695f 6c61 6265   y is multi_labe
-0003dcb0: 6c20 6275 7420 6861 7320 6d6f 7265 2074  l but has more t
-0003dcc0: 6861 6e20 7477 6f20 636c 6173 7365 732c  han two classes,
-0003dcd0: 2079 5f70 726f 6261 735b 305d 2069 7320   y_probas[0] is 
-0003dce0: 616c 736f 2061 206c 6973 7420 2323 0a20  also a list ##. 
-0003dcf0: 2020 2020 2020 2020 2020 2070 726f 626c             probl
-0003dd00: 656d 7479 7065 203d 2022 6d75 6c74 695f  emtype = "multi_
-0003dd10: 6c61 6265 6c5f 6d75 6c74 695f 636c 6173  label_multi_clas
-0003dd20: 7322 0a20 2020 2020 2020 2065 6c73 653a  s".        else:
-0003dd30: 0a20 2020 2020 2020 2020 2020 2069 6e69  .            ini
-0003dd40: 7469 616c 203d 2079 5f70 726f 6261 735b  tial = y_probas[
-0003dd50: 305d 2e73 6861 7065 5b31 5d0a 2020 2020  0].shape[1].    
-0003dd60: 2020 2020 2020 2020 6966 206e 702e 616c          if np.al
-0003dd70: 6c28 5b78 2e73 6861 7065 5b31 5d3d 3d69  l([x.shape[1]==i
-0003dd80: 6e69 7469 616c 2066 6f72 2078 2069 6e20  nitial for x in 
-0003dd90: 795f 7072 6f62 6173 5d29 3a0a 2020 2020  y_probas]):.    
-0003dda0: 2020 2020 2020 2020 2020 2020 7072 6f62              prob
-0003ddb0: 6c65 6d74 7970 6520 3d20 2022 6d75 6c74  lemtype =  "mult
-0003ddc0: 695f 6c61 6265 6c5f 6269 6e61 7279 5f63  i_label_binary_c
-0003ddd0: 6c61 7373 220a 2020 2020 2020 2020 2020  lass".          
-0003dde0: 2020 656c 7365 3a0a 2020 2020 2020 2020    else:.        
-0003ddf0: 2020 2020 2020 2020 7072 6f62 6c65 6d74          problemt
-0003de00: 7970 6520 3d20 226d 756c 7469 5f6c 6162  ype = "multi_lab
-0003de10: 656c 5f6d 756c 7469 5f63 6c61 7373 220a  el_multi_class".
-0003de20: 2020 2020 656c 7365 3a0a 2020 2020 2020      else:.      
-0003de30: 2020 7072 6f62 6c65 6d74 7970 6520 3d20    problemtype = 
-0003de40: 2273 696e 676c 655f 6c61 6265 6c22 0a20  "single_label". 
-0003de50: 2020 2023 2323 2320 5468 6973 2069 7320     #### This is 
-0003de60: 666f 7220 6d61 6b69 6e67 206d 756c 7469  for making multi
-0003de70: 2d6c 6162 656c 206d 756c 7469 2d63 6c61  -label multi-cla
-0003de80: 7373 2070 7265 6469 6374 696f 6e73 2069  ss predictions i
-0003de90: 6e74 6f20 6120 6469 6374 696f 6e61 7279  nto a dictionary
-0003dea0: 2023 230a 2020 2020 6966 2070 726f 626c   ##.    if probl
-0003deb0: 656d 7479 7065 203d 3d20 226d 756c 7469  emtype == "multi
-0003dec0: 5f6c 6162 656c 5f6d 756c 7469 5f63 6c61  _label_multi_cla
-0003ded0: 7373 223a 0a20 2020 2020 2020 2070 726f  ss":.        pro
-0003dee0: 6261 735f 6469 6374 203d 2064 6566 6175  bas_dict = defau
-0003def0: 6c74 6469 6374 286c 6973 7429 0a20 2020  ltdict(list).   
-0003df00: 2020 2020 2023 2323 2049 6e69 7469 616c       ### Initial
-0003df10: 697a 6520 7468 6520 6465 6661 756c 7420  ize the default 
-0003df20: 6469 6374 2023 2323 2323 2323 2323 2323  dict ###########
-0003df30: 2323 0a20 2020 2020 2020 2066 6f72 2065  ##.        for e
-0003df40: 6163 685f 7461 7267 6574 2069 6e20 7261  ach_target in ra
-0003df50: 6e67 6528 6c65 6e28 795f 7072 6f62 6173  nge(len(y_probas
-0003df60: 5b30 5d29 293a 0a20 2020 2020 2020 2020  [0])):.         
-0003df70: 2020 2070 726f 6261 735f 6469 6374 5b65     probas_dict[e
-0003df80: 6163 685f 7461 7267 6574 5d20 3d20 5b5d  ach_target] = []
-0003df90: 0a20 2020 2020 2020 2023 2323 2320 4e6f  .        #### No
-0003dfa0: 7720 7468 6174 2069 7420 6973 2069 7320  w that it is is 
-0003dfb0: 696e 6974 6961 6c69 7a65 642c 2063 6f6d  initialized, com
-0003dfc0: 7069 6c65 2065 6163 6820 636c 6173 7320  pile each class 
-0003dfd0: 696e 746f 2069 7473 206f 776e 206c 6973  into its own lis
-0003dfe0: 7420 2323 230a 2020 2020 2020 2020 6966  t ###.        if
-0003dff0: 2069 7369 6e73 7461 6e63 6528 795f 7072   isinstance(y_pr
-0003e000: 6f62 6173 5b30 5d2c 206c 6973 7429 3a0a  obas[0], list):.
-0003e010: 2020 2020 2020 2020 2020 2020 666f 7220              for 
-0003e020: 6561 6368 5f69 2069 6e20 7261 6e67 6528  each_i in range(
-0003e030: 6c65 6e28 795f 7072 6f62 6173 2929 3a0a  len(y_probas)):.
-0003e040: 2020 2020 2020 2020 2020 2020 2020 2020                  
-0003e050: 666f 7220 6561 6368 5f6a 2069 6e20 7261  for each_j in ra
-0003e060: 6e67 6528 6c65 6e28 795f 7072 6f62 6173  nge(len(y_probas
-0003e070: 5b65 6163 685f 695d 2929 3a0a 2020 2020  [each_i])):.    
-0003e080: 2020 2020 2020 2020 2020 2020 2020 2020                  
-0003e090: 6966 2079 5f70 726f 6261 735b 6561 6368  if y_probas[each
-0003e0a0: 5f69 5d5b 6561 6368 5f6a 5d2e 7368 6170  _i][each_j].shap
-0003e0b0: 655b 315d 203e 2032 3a0a 2020 2020 2020  e[1] > 2:.      
-0003e0c0: 2020 2020 2020 2020 2020 2020 2020 2020                  
-0003e0d0: 2020 7072 6f62 6173 5f64 6963 745b 6561    probas_dict[ea
-0003e0e0: 6368 5f6a 5d2e 6170 7065 6e64 2879 5f70  ch_j].append(y_p
-0003e0f0: 726f 6261 735b 6561 6368 5f69 5d5b 6561  robas[each_i][ea
-0003e100: 6368 5f6a 5d29 0a20 2020 2020 2020 2020  ch_j]).         
-0003e110: 2020 2020 2020 2020 2020 2065 6c73 653a             else:
-0003e120: 0a20 2020 2020 2020 2020 2020 2020 2020  .               
-0003e130: 2020 2020 2020 2020 2070 726f 6261 735f           probas_
-0003e140: 6469 6374 5b65 6163 685f 6a5d 2e61 7070  dict[each_j].app
-0003e150: 656e 6428 795f 7072 6f62 6173 5b65 6163  end(y_probas[eac
-0003e160: 685f 695d 5b65 6163 685f 6a5d 5b3a 2c31  h_i][each_j][:,1
-0003e170: 5d29 0a20 2020 2020 2020 2020 2020 2023  ]).            #
-0003e180: 2323 2320 4f6e 6365 2061 6c6c 206f 6620  ### Once all of 
-0003e190: 7468 6520 7072 6f62 6173 2068 6176 6520  the probas have 
-0003e1a0: 6265 656e 2070 7574 2069 6e20 6120 6469  been put in a di
-0003e1b0: 6374 696f 6e61 7279 2c20 6e6f 7720 636f  ctionary, now co
-0003e1c0: 6d70 7574 6520 6d65 616e 7320 2323 0a20  mpute means ##. 
-0003e1d0: 2020 2020 2020 2020 2020 2066 6f72 2065             for e
-0003e1e0: 6163 685f 7461 7267 6574 2069 6e20 7261  ach_target in ra
-0003e1f0: 6e67 6528 6c65 6e28 7072 6f62 6173 5f64  nge(len(probas_d
-0003e200: 6963 7429 293a 0a20 2020 2020 2020 2020  ict)):.         
-0003e210: 2020 2020 2020 2070 726f 6261 735f 6469         probas_di
-0003e220: 6374 5b65 6163 685f 7461 7267 6574 5d20  ct[each_target] 
-0003e230: 3d20 6e70 2e61 7272 6179 2870 726f 6261  = np.array(proba
-0003e240: 735f 6469 6374 5b65 6163 685f 7461 7267  s_dict[each_targ
-0003e250: 6574 5d29 2e6d 6561 6e28 6178 6973 3d30  et]).mean(axis=0
-0003e260: 290a 2020 2020 656c 6966 2070 726f 626c  ).    elif probl
-0003e270: 656d 7479 7065 203d 3d20 226d 756c 7469  emtype == "multi
-0003e280: 5f6c 6162 656c 5f62 696e 6172 795f 636c  _label_binary_cl
-0003e290: 6173 7322 3a0a 2020 2020 2020 2020 696e  ass":.        in
-0003e2a0: 6974 6961 6c20 3d20 795f 7072 6f62 6173  itial = y_probas
-0003e2b0: 5b30 5d2e 7368 6170 655b 315d 0a20 2020  [0].shape[1].   
-0003e2c0: 2020 2020 2069 6620 6e70 2e61 6c6c 285b       if np.all([
-0003e2d0: 782e 7368 6170 655b 315d 3d3d 696e 6974  x.shape[1]==init
-0003e2e0: 6961 6c20 666f 7220 7820 696e 2079 5f70  ial for x in y_p
-0003e2f0: 726f 6261 735d 293a 0a20 2020 2020 2020  robas]):.       
-0003e300: 2020 2020 2070 726f 6261 735f 6469 6374       probas_dict
-0003e310: 203d 206e 702e 6172 7261 7928 795f 7072   = np.array(y_pr
-0003e320: 6f62 6173 292e 6d65 616e 2861 7869 733d  obas).mean(axis=
-0003e330: 3029 0a20 2020 2072 6574 7572 6e20 7072  0).    return pr
-0003e340: 6f62 6173 5f64 6963 7420 2020 0a23 2323  obas_dict   .###
-0003e350: 2323 2323 2323 2323 2323 2323 2323 2323  ################
-0003e360: 2323 2323 2323 2323 2323 2323 2323 2323  ################
-0003e370: 2323 2323 2323 2323 2323 2323 2323 2323  ################
-0003e380: 2323 2323 2323 2323 2323 2323 2323 2323  ################
-0003e390: 2323 2323 2323 2323 2323 2323 2323 2323  ################
-0003e3a0: 2323 2323 2323 2323 2323 2323 0a66 726f  ############.fro
-0003e3b0: 6d20 736b 6c65 6172 6e2e 6d65 7472 6963  m sklearn.metric
-0003e3c0: 7320 696d 706f 7274 2072 6f63 5f61 7563  s import roc_auc
-0003e3d0: 5f73 636f 7265 0a69 6d70 6f72 7420 636f  _score.import co
-0003e3e0: 7079 0a66 726f 6d20 736b 6c65 6172 6e2e  py.from sklearn.
-0003e3f0: 6d65 7472 6963 7320 696d 706f 7274 2062  metrics import b
-0003e400: 616c 616e 6365 645f 6163 6375 7261 6379  alanced_accuracy
-0003e410: 5f73 636f 7265 2c20 636c 6173 7369 6669  _score, classifi
-0003e420: 6361 7469 6f6e 5f72 6570 6f72 740a 696d  cation_report.im
-0003e430: 706f 7274 2070 6462 0a64 6566 2070 7269  port pdb.def pri
-0003e440: 6e74 5f73 756c 6f5f 6163 6375 7261 6379  nt_sulo_accuracy
-0003e450: 2879 5f74 6573 742c 2079 5f70 7265 6473  (y_test, y_preds
-0003e460: 2c20 795f 7072 6f62 6173 3d27 272c 2076  , y_probas='', v
-0003e470: 6572 626f 7365 3d30 293a 0a20 2020 2062  erbose=0):.    b
-0003e480: 616c 5f73 636f 7265 7320 3d20 5b5d 0a20  al_scores = []. 
-0003e490: 2020 2023 2323 2323 2323 204f 6e63 6520     ####### Once 
-0003e4a0: 796f 7520 6861 7665 2064 6574 6563 7465  you have detecte
-0003e4b0: 6420 7768 6174 2070 726f 626c 656d 2069  d what problem i
-0003e4c0: 7420 6973 2c20 6e6f 7720 7072 696e 7420  t is, now print 
-0003e4d0: 6974 7320 7363 6f72 6573 2023 2323 2323  its scores #####
-0003e4e0: 0a20 2020 2069 6620 795f 7465 7374 2e6e  .    if y_test.n
-0003e4f0: 6469 6d20 3c3d 2031 3a20 0a20 2020 2020  dim <= 1: .     
-0003e500: 2020 2023 2323 2054 6869 7320 6973 2061     ### This is a
-0003e510: 2073 696e 676c 6520 6c61 6265 6c20 7072   single label pr
-0003e520: 6f62 6c65 6d20 2320 7765 206e 6565 6420  oblem # we need 
-0003e530: 746f 2074 6573 7420 666f 7220 6d75 6c74  to test for mult
-0003e540: 6963 6c61 7373 2023 230a 2020 2020 2020  iclass ##.      
-0003e550: 2020 6261 6c5f 7363 6f72 6520 3d20 6261    bal_score = ba
-0003e560: 6c61 6e63 6564 5f61 6363 7572 6163 795f  lanced_accuracy_
-0003e570: 7363 6f72 6528 795f 7465 7374 2c79 5f70  score(y_test,y_p
-0003e580: 7265 6473 290a 2020 2020 2020 2020 7072  reds).        pr
-0003e590: 696e 7428 2742 616c 2061 6363 7520 2530  int('Bal accu %0
-0003e5a0: 2e30 6625 2527 2025 2831 3030 2a62 616c  .0f%%' %(100*bal
-0003e5b0: 5f73 636f 7265 2929 0a20 2020 2020 2020  _score)).       
-0003e5c0: 2069 6620 6e6f 7420 6973 696e 7374 616e   if not isinstan
-0003e5d0: 6365 2879 5f70 726f 6261 732c 2073 7472  ce(y_probas, str
-0003e5e0: 293a 0a20 2020 2020 2020 2020 2020 2069  ):.            i
-0003e5f0: 6620 795f 7072 6f62 6173 2e6e 6469 6d20  f y_probas.ndim 
-0003e600: 3c3d 2031 3a0a 2020 2020 2020 2020 2020  <= 1:.          
-0003e610: 2020 2020 2020 7072 696e 7428 2752 4f43        print('ROC
-0003e620: 2041 5543 203d 2025 302e 3266 2720 2572   AUC = %0.2f' %r
-0003e630: 6f63 5f61 7563 5f73 636f 7265 2879 5f74  oc_auc_score(y_t
-0003e640: 6573 742c 2079 5f70 726f 6261 735b 3a2c  est, y_probas[:,
-0003e650: 315d 2929 0a20 2020 2020 2020 2020 2020  1])).           
-0003e660: 2065 6c73 653a 0a20 2020 2020 2020 2020   else:.         
-0003e670: 2020 2020 2020 2069 6620 795f 7072 6f62         if y_prob
-0003e680: 6173 2e73 6861 7065 5b31 5d20 3d3d 2032  as.shape[1] == 2
-0003e690: 3a0a 2020 2020 2020 2020 2020 2020 2020  :.              
-0003e6a0: 2020 2020 2020 7072 696e 7428 2752 4f43        print('ROC
-0003e6b0: 2041 5543 203d 2025 302e 3266 2720 2572   AUC = %0.2f' %r
-0003e6c0: 6f63 5f61 7563 5f73 636f 7265 2879 5f74  oc_auc_score(y_t
-0003e6d0: 6573 742c 2079 5f70 726f 6261 735b 3a2c  est, y_probas[:,
-0003e6e0: 315d 2929 0a20 2020 2020 2020 2020 2020  1])).           
-0003e6f0: 2020 2020 2065 6c73 653a 0a20 2020 2020       else:.     
-0003e700: 2020 2020 2020 2020 2020 2020 2020 2070                 p
-0003e710: 7269 6e74 2827 4d75 6c74 692d 636c 6173  rint('Multi-clas
-0003e720: 7320 524f 4320 4155 4320 3d20 2530 2e32  s ROC AUC = %0.2
-0003e730: 6627 2025 726f 635f 6175 635f 7363 6f72  f' %roc_auc_scor
-0003e740: 6528 795f 7465 7374 2c20 795f 7072 6f62  e(y_test, y_prob
-0003e750: 6173 2c20 6d75 6c74 695f 636c 6173 733d  as, multi_class=
-0003e760: 226f 7672 2229 290a 2020 2020 2020 2020  "ovr")).        
-0003e770: 6261 6c5f 7363 6f72 6573 2e61 7070 656e  bal_scores.appen
-0003e780: 6428 6261 6c5f 7363 6f72 6529 0a20 2020  d(bal_score).   
-0003e790: 2020 2020 2069 6620 7665 7262 6f73 653a       if verbose:
-0003e7a0: 0a20 2020 2020 2020 2020 2020 2070 7269  .            pri
-0003e7b0: 6e74 2863 6c61 7373 6966 6963 6174 696f  nt(classificatio
-0003e7c0: 6e5f 7265 706f 7274 2879 5f74 6573 742c  n_report(y_test,
-0003e7d0: 795f 7072 6564 7329 290a 2020 2020 656c  y_preds)).    el
-0003e7e0: 6966 2079 5f74 6573 742e 6e64 696d 203e  if y_test.ndim >
-0003e7f0: 3d20 323a 0a20 2020 2020 2020 2069 6620  = 2:.        if 
-0003e800: 795f 7465 7374 2e73 6861 7065 5b31 5d20  y_test.shape[1] 
-0003e810: 3d3d 2031 3a0a 2020 2020 2020 2020 2020  == 1:.          
-0003e820: 2020 6261 6c5f 7363 6f72 6520 3d20 6261    bal_score = ba
-0003e830: 6c61 6e63 6564 5f61 6363 7572 6163 795f  lanced_accuracy_
-0003e840: 7363 6f72 6528 795f 7465 7374 2c79 5f70  score(y_test,y_p
-0003e850: 7265 6473 290a 2020 2020 2020 2020 2020  reds).          
-0003e860: 2020 6261 6c5f 7363 6f72 6573 2e61 7070    bal_scores.app
-0003e870: 656e 6428 6261 6c5f 7363 6f72 6529 0a20  end(bal_score). 
-0003e880: 2020 2020 2020 2020 2020 2070 7269 6e74             print
-0003e890: 2827 4261 6c20 6163 6375 2025 302e 3066  ('Bal accu %0.0f
-0003e8a0: 2525 2720 2528 3130 302a 6261 6c5f 7363  %%' %(100*bal_sc
-0003e8b0: 6f72 6529 290a 2020 2020 2020 2020 2020  ore)).          
-0003e8c0: 2020 6966 206e 6f74 2069 7369 6e73 7461    if not isinsta
-0003e8d0: 6e63 6528 795f 7072 6f62 6173 2c20 7374  nce(y_probas, st
-0003e8e0: 7229 3a0a 2020 2020 2020 2020 2020 2020  r):.            
-0003e8f0: 2020 2020 6966 2079 5f70 726f 6261 732e      if y_probas.
-0003e900: 7368 6170 655b 315d 203e 2032 3a0a 2020  shape[1] > 2:.  
+00037cf0: 2020 2020 6376 203d 206b 666f 6c64 2c20      cv = kfold, 
+00037d00: 6e5f 6a6f 6273 3d2d 312c 2072 616e 646f  n_jobs=-1, rando
+00037d10: 6d5f 7374 6174 653d 3130 3029 0a20 2020  m_state=100).   
+00037d20: 200a 2020 2020 636c 662e 6669 7428 582c   .    clf.fit(X,
+00037d30: 2079 290a 0a20 2020 2069 6620 7665 7262   y)..    if verb
+00037d40: 6f73 653a 0a20 2020 2020 2020 2070 7269  ose:.        pri
+00037d50: 6e74 2822 2020 2020 6265 7374 2073 636f  nt("    best sco
+00037d60: 7265 2069 7320 3a22 202c 2063 6c66 2e62  re is :" , clf.b
+00037d70: 6573 745f 7363 6f72 655f 290a 2020 2020  est_score_).    
+00037d80: 2020 2020 2370 7269 6e74 2822 2020 2020      #print("    
+00037d90: 6265 7374 2065 7374 696d 6174 6f72 2069  best estimator i
+00037da0: 7320 3a22 202c 2063 6c66 2e62 6573 745f  s :" , clf.best_
+00037db0: 6573 7469 6d61 746f 725f 290a 2020 2020  estimator_).    
+00037dc0: 2020 2020 7072 696e 7428 2220 2020 2062      print("    b
+00037dd0: 6573 7420 5061 7261 6d73 2069 7320 3a22  est Params is :"
+00037de0: 202c 2063 6c66 2e62 6573 745f 7061 7261   , clf.best_para
+00037df0: 6d73 5f29 0a20 2020 2020 2020 2070 7269  ms_).        pri
+00037e00: 6e74 2822 5469 6d65 2054 616b 656e 2066  nt("Time Taken f
+00037e10: 6f72 2052 616e 646f 6d69 7a65 6453 6561  or RandomizedSea
+00037e20: 7263 6843 563a 2025 302e 3066 2028 7365  rchCV: %0.0f (se
+00037e30: 636f 6e64 7329 2220 2528 7469 6d65 2e74  conds)" %(time.t
+00037e40: 696d 6528 292d 7374 6172 7429 290a 2020  ime()-start)).  
+00037e50: 2020 7265 7475 726e 2063 6c66 2e62 6573    return clf.bes
+00037e60: 745f 6573 7469 6d61 746f 725f 0a23 2323  t_estimator_.###
+00037e70: 2323 2323 2323 2323 2323 2323 2323 2323  ################
+00037e80: 2323 2323 2323 2323 2323 2323 2323 2323  ################
+00037e90: 2323 2323 2323 2323 2323 2323 2323 2323  ################
+00037ea0: 2323 2323 2323 2323 2323 2323 2323 2323  ################
+00037eb0: 2323 2323 2323 2323 2323 2323 2323 230a  ###############.
+00037ec0: 2320 4361 6c63 756c 6174 6520 636c 6173  # Calculate clas
+00037ed0: 7320 7765 6967 6874 0a66 726f 6d20 736b  s weight.from sk
+00037ee0: 6c65 6172 6e2e 7574 696c 732e 636c 6173  learn.utils.clas
+00037ef0: 735f 7765 6967 6874 2069 6d70 6f72 7420  s_weight import 
+00037f00: 636f 6d70 7574 655f 636c 6173 735f 7765  compute_class_we
+00037f10: 6967 6874 0a69 6d70 6f72 7420 636f 7079  ight.import copy
+00037f20: 0a66 726f 6d20 636f 6c6c 6563 7469 6f6e  .from collection
+00037f30: 7320 696d 706f 7274 2043 6f75 6e74 6572  s import Counter
+00037f40: 0a64 6566 2066 696e 645f 7261 7265 5f63  .def find_rare_c
+00037f50: 6c61 7373 2863 6c61 7373 6573 2c20 7665  lass(classes, ve
+00037f60: 7262 6f73 653d 3029 3a0a 2020 2020 2323  rbose=0):.    ##
+00037f70: 2323 2323 2323 2320 5072 696e 7420 7468  ####### Print th
+00037f80: 6520 2520 636f 756e 7420 6f66 2065 6163  e % count of eac
+00037f90: 6820 636c 6173 7320 696e 2061 2054 6172  h class in a Tar
+00037fa0: 6765 7420 7661 7269 6162 6c65 2020 2323  get variable  ##
+00037fb0: 2323 230a 2020 2020 2222 220a 2020 2020  ###.    """.    
+00037fc0: 576f 726b 7320 6f6e 204d 756c 7469 2043  Works on Multi C
+00037fd0: 6c61 7373 2074 6f6f 2e20 5072 696e 7473  lass too. Prints
+00037fe0: 2063 6c61 7373 2070 6572 6365 6e74 6167   class percentag
+00037ff0: 6573 2063 6f75 6e74 206f 6620 7461 7267  es count of targ
+00038000: 6574 2076 6172 6961 626c 652e 0a20 2020  et variable..   
+00038010: 2049 7420 7265 7475 726e 7320 7468 6520   It returns the 
+00038020: 6e61 6d65 206f 6620 7468 6520 5261 7265  name of the Rare
+00038030: 2063 6c61 7373 2028 7468 6520 6f6e 6520   class (the one 
+00038040: 7769 7468 2074 6865 206d 696e 696d 756d  with the minimum
+00038050: 2063 6c61 7373 206d 656d 6265 7220 636f   class member co
+00038060: 756e 7429 2e0a 2020 2020 5468 6973 2063  unt)..    This c
+00038070: 616e 2061 6c73 6f20 6265 2068 656c 7066  an also be helpf
+00038080: 756c 2069 6e20 7573 696e 6720 6974 2061  ul in using it a
+00038090: 7320 706f 735f 6c61 6265 6c20 696e 2042  s pos_label in B
+000380a0: 696e 6172 7920 616e 6420 4d75 6c74 6920  inary and Multi 
+000380b0: 436c 6173 7320 7072 6f62 6c65 6d73 2e0a  Class problems..
+000380c0: 2020 2020 2222 220a 2020 2020 636f 756e      """.    coun
+000380d0: 7473 203d 204f 7264 6572 6564 4469 6374  ts = OrderedDict
+000380e0: 2843 6f75 6e74 6572 2863 6c61 7373 6573  (Counter(classes
+000380f0: 2929 0a20 2020 2074 6f74 616c 203d 2073  )).    total = s
+00038100: 756d 2863 6f75 6e74 732e 7661 6c75 6573  um(counts.values
+00038110: 2829 290a 2020 2020 6966 2076 6572 626f  ()).    if verbo
+00038120: 7365 203e 3d20 313a 0a20 2020 2020 2020  se >= 1:.       
+00038130: 2070 7269 6e74 2827 2020 2020 2020 2043   print('       C
+00038140: 6c61 7373 2020 2d3e 2043 6f75 6e74 7320  lass  -> Counts 
+00038150: 2d3e 2050 6572 6365 6e74 2729 0a20 2020  -> Percent').   
+00038160: 2020 2020 2073 6f72 7465 645f 6b65 7973       sorted_keys
+00038170: 203d 2073 6f72 7465 6428 636f 756e 7473   = sorted(counts
+00038180: 2e6b 6579 7328 2929 0a20 2020 2020 2020  .keys()).       
+00038190: 2066 6f72 2063 6c73 2069 6e20 736f 7274   for cls in sort
+000381a0: 6564 5f6b 6579 733a 0a20 2020 2020 2020  ed_keys:.       
+000381b0: 2020 2020 2070 7269 6e74 2822 2531 3273       print("%12s
+000381c0: 3a20 2520 3764 2020 2d3e 2020 2520 352e  : % 7d  ->  % 5.
+000381d0: 3166 2525 2220 2520 2863 6c73 2c20 636f  1f%%" % (cls, co
+000381e0: 756e 7473 5b63 6c73 5d2c 2063 6f75 6e74  unts[cls], count
+000381f0: 735b 636c 735d 2f74 6f74 616c 2a31 3030  s[cls]/total*100
+00038200: 2929 0a20 2020 2069 6620 7479 7065 2870  )).    if type(p
+00038210: 642e 5365 7269 6573 2863 6f75 6e74 7329  d.Series(counts)
+00038220: 2e69 6478 6d69 6e28 2929 3d3d 7374 723a  .idxmin())==str:
+00038230: 0a20 2020 2020 2020 2072 6574 7572 6e20  .        return 
+00038240: 7064 2e53 6572 6965 7328 636f 756e 7473  pd.Series(counts
+00038250: 292e 6964 786d 696e 2829 0a20 2020 2065  ).idxmin().    e
+00038260: 6c73 653a 0a20 2020 2020 2020 2072 6574  lse:.        ret
+00038270: 7572 6e20 696e 7428 7064 2e53 6572 6965  urn int(pd.Serie
+00038280: 7328 636f 756e 7473 292e 6964 786d 696e  s(counts).idxmin
+00038290: 2829 290a 2323 2323 2323 2323 2323 2323  ()).############
+000382a0: 2323 2323 2323 2323 2323 2323 2323 2323  ################
+000382b0: 2323 2323 2323 2323 2323 2323 2323 2323  ################
+000382c0: 2323 2323 2323 2323 2323 2323 2323 2323  ################
+000382d0: 2323 2323 2323 2323 2323 2323 2323 2323  ################
+000382e0: 2323 2323 2323 0a66 726f 6d20 636f 6c6c  ######.from coll
+000382f0: 6563 7469 6f6e 7320 696d 706f 7274 204f  ections import O
+00038300: 7264 6572 6564 4469 6374 2020 2020 0a64  rderedDict    .d
+00038310: 6566 2067 6574 5f63 6c61 7373 5f77 6569  ef get_class_wei
+00038320: 6768 7473 2879 5f69 6e70 7574 2c20 7665  ghts(y_input, ve
+00038330: 7262 6f73 653d 3029 3a20 2020 200a 2020  rbose=0):    .  
+00038340: 2020 795f 696e 7075 7420 3d20 636f 7079    y_input = copy
+00038350: 2e64 6565 7063 6f70 7928 795f 696e 7075  .deepcopy(y_inpu
+00038360: 7429 0a20 2020 2069 6620 6973 696e 7374  t).    if isinst
+00038370: 616e 6365 2879 5f69 6e70 7574 2c20 6e70  ance(y_input, np
+00038380: 2e6e 6461 7272 6179 293a 0a20 2020 2020  .ndarray):.     
+00038390: 2020 2079 5f69 6e70 7574 203d 2070 642e     y_input = pd.
+000383a0: 5365 7269 6573 2879 5f69 6e70 7574 290a  Series(y_input).
+000383b0: 2020 2020 656c 6966 2069 7369 6e73 7461      elif isinsta
+000383c0: 6e63 6528 795f 696e 7075 742c 2070 642e  nce(y_input, pd.
+000383d0: 5365 7269 6573 293a 0a20 2020 2020 2020  Series):.       
+000383e0: 2070 6173 730a 2020 2020 656c 6966 2069   pass.    elif i
+000383f0: 7369 6e73 7461 6e63 6528 795f 696e 7075  sinstance(y_inpu
+00038400: 742c 2070 642e 4461 7461 4672 616d 6529  t, pd.DataFrame)
+00038410: 3a0a 2020 2020 2020 2020 6966 206c 656e  :.        if len
+00038420: 2879 5f69 6e70 7574 2e63 6f6c 756d 6e73  (y_input.columns
+00038430: 2920 3e3d 2032 3a0a 2020 2020 2020 2020  ) >= 2:.        
+00038440: 2020 2020 2323 2320 6966 2069 7420 6973      ### if it is
+00038450: 2061 2064 6174 6166 7261 6d65 2c20 7265   a dataframe, re
+00038460: 7475 726e 206f 6e6c 7920 6966 2069 7420  turn only if it 
+00038470: 6973 206f 6e65 2063 6f6c 756d 6e20 6461  is one column da
+00038480: 7461 6672 616d 6520 2323 0a20 2020 2020  taframe ##.     
+00038490: 2020 2020 2020 2063 6c61 7373 5f77 6569         class_wei
+000384a0: 6768 7473 203d 2064 6963 7428 290a 2020  ghts = dict().  
+000384b0: 2020 2020 2020 2020 2020 666f 7220 6561            for ea
+000384c0: 6368 5f74 6172 6765 7420 696e 2079 5f69  ch_target in y_i
+000384d0: 6e70 7574 2e63 6f6c 756d 6e73 3a0a 2020  nput.columns:.  
+000384e0: 2020 2020 2020 2020 2020 2020 2020 636c                cl
+000384f0: 6173 735f 7765 6967 6874 735b 6561 6368  ass_weights[each
+00038500: 5f74 6172 6765 745d 203d 2067 6574 5f63  _target] = get_c
+00038510: 6c61 7373 5f77 6569 6768 7473 2879 5f69  lass_weights(y_i
+00038520: 6e70 7574 5b65 6163 685f 7461 7267 6574  nput[each_target
+00038530: 5d29 0a20 2020 2020 2020 2020 2020 2072  ]).            r
+00038540: 6574 7572 6e20 636c 6173 735f 7765 6967  eturn class_weig
+00038550: 6874 730a 2020 2020 2020 2020 656c 7365  hts.        else
+00038560: 3a0a 2020 2020 2020 2020 2020 2020 795f  :.            y_
+00038570: 696e 7075 7420 3d20 795f 696e 7075 742e  input = y_input.
+00038580: 7661 6c75 6573 2e72 6573 6861 7065 282d  values.reshape(-
+00038590: 3129 0a20 2020 2065 6c73 653a 0a20 2020  1).    else:.   
+000385a0: 2020 2020 2023 2323 2069 6620 796f 7520       ### if you 
+000385b0: 6361 6e6e 6f74 2064 6574 6563 7420 7468  cannot detect th
+000385c0: 6520 7479 7065 206f 7220 6966 2069 7420  e type or if it 
+000385d0: 6973 2061 206d 756c 7469 2d63 6f6c 756d  is a multi-colum
+000385e0: 6e20 6461 7461 6672 616d 652c 2069 676e  n dataframe, ign
+000385f0: 6f72 6520 6974 0a20 2020 2020 2020 2072  ore it.        r
+00038600: 6574 7572 6e20 4e6f 6e65 0a20 2020 2063  eturn None.    c
+00038610: 6c61 7373 6573 203d 206e 702e 756e 6971  lasses = np.uniq
+00038620: 7565 2879 5f69 6e70 7574 290a 2020 2020  ue(y_input).    
+00038630: 7261 7265 5f63 6c61 7373 203d 2066 696e  rare_class = fin
+00038640: 645f 7261 7265 5f63 6c61 7373 2879 5f69  d_rare_class(y_i
+00038650: 6e70 7574 290a 2020 2020 7870 203d 2043  nput).    xp = C
+00038660: 6f75 6e74 6572 2879 5f69 6e70 7574 290a  ounter(y_input).
+00038670: 2020 2020 636c 6173 735f 7765 6967 6874      class_weight
+00038680: 7320 3d20 636f 6d70 7574 655f 636c 6173  s = compute_clas
+00038690: 735f 7765 6967 6874 2827 6261 6c61 6e63  s_weight('balanc
+000386a0: 6564 272c 2063 6c61 7373 6573 3d63 6c61  ed', classes=cla
+000386b0: 7373 6573 2c20 793d 795f 696e 7075 7429  sses, y=y_input)
+000386c0: 0a20 2020 2063 6c61 7373 5f77 6569 6768  .    class_weigh
+000386d0: 7473 203d 204f 7264 6572 6564 4469 6374  ts = OrderedDict
+000386e0: 287a 6970 2863 6c61 7373 6573 2c20 6e70  (zip(classes, np
+000386f0: 2e72 6f75 6e64 2863 6c61 7373 5f77 6569  .round(class_wei
+00038700: 6768 7473 2f63 6c61 7373 5f77 6569 6768  ghts/class_weigh
+00038710: 7473 2e6d 696e 2829 292e 6173 7479 7065  ts.min()).astype
+00038720: 2869 6e74 2929 290a 2020 2020 6966 2076  (int))).    if v
+00038730: 6572 626f 7365 3a0a 2020 2020 2020 2020  erbose:.        
+00038740: 7072 696e 7428 2743 6c61 7373 2077 6569  print('Class wei
+00038750: 6768 7473 2075 7365 6420 696e 2063 6c61  ghts used in cla
+00038760: 7373 6966 6965 7220 6172 653a 2025 7327  ssifier are: %s'
+00038770: 2025 636c 6173 735f 7765 6967 6874 7329   %class_weights)
+00038780: 0a20 2020 2072 6574 7572 6e20 636c 6173  .    return clas
+00038790: 735f 7765 6967 6874 730a 0a66 726f 6d20  s_weights..from 
+000387a0: 636f 6c6c 6563 7469 6f6e 7320 696d 706f  collections impo
+000387b0: 7274 204f 7264 6572 6564 4469 6374 0a64  rt OrderedDict.d
+000387c0: 6566 2067 6574 5f73 6361 6c65 5f70 6f73  ef get_scale_pos
+000387d0: 5f77 6569 6768 7428 795f 696e 7075 742c  _weight(y_input,
+000387e0: 2076 6572 626f 7365 3d30 293a 0a20 2020   verbose=0):.   
+000387f0: 2063 6c61 7373 5f77 6569 6768 7465 645f   class_weighted_
+00038800: 726f 7773 203d 2067 6574 5f63 6c61 7373  rows = get_class
+00038810: 5f77 6569 6768 7473 2879 5f69 6e70 7574  _weights(y_input
+00038820: 290a 2020 2020 6966 2069 7369 6e73 7461  ).    if isinsta
+00038830: 6e63 6528 795f 696e 7075 742c 206e 702e  nce(y_input, np.
+00038840: 6e64 6172 7261 7929 3a0a 2020 2020 2020  ndarray):.      
+00038850: 2020 795f 696e 7075 7420 3d20 7064 2e53    y_input = pd.S
+00038860: 6572 6965 7328 795f 696e 7075 7429 0a20  eries(y_input). 
+00038870: 2020 2065 6c69 6620 6973 696e 7374 616e     elif isinstan
+00038880: 6365 2879 5f69 6e70 7574 2c20 7064 2e53  ce(y_input, pd.S
+00038890: 6572 6965 7329 3a0a 2020 2020 2020 2020  eries):.        
+000388a0: 7061 7373 0a20 2020 2065 6c69 6620 6973  pass.    elif is
+000388b0: 696e 7374 616e 6365 2879 5f69 6e70 7574  instance(y_input
+000388c0: 2c20 7064 2e44 6174 6146 7261 6d65 293a  , pd.DataFrame):
+000388d0: 0a20 2020 2020 2020 2069 6620 6c65 6e28  .        if len(
+000388e0: 795f 696e 7075 742e 636f 6c75 6d6e 7329  y_input.columns)
+000388f0: 203e 3d20 323a 0a20 2020 2020 2020 2020   >= 2:.         
+00038900: 2020 2023 2323 2069 6620 6974 2069 7320     ### if it is 
+00038910: 6120 6461 7461 6672 616d 652c 2072 6574  a dataframe, ret
+00038920: 7572 6e20 6f6e 6c79 2069 6620 6974 2069  urn only if it i
+00038930: 7320 6f6e 6520 636f 6c75 6d6e 2064 6174  s one column dat
+00038940: 6166 7261 6d65 2023 230a 2020 2020 2020  aframe ##.      
+00038950: 2020 2020 2020 7261 7265 5f63 6c61 7373        rare_class
+00038960: 5f77 6569 6768 7473 203d 204f 7264 6572  _weights = Order
+00038970: 6564 4469 6374 2829 0a20 2020 2020 2020  edDict().       
+00038980: 2020 2020 2066 6f72 2065 6163 685f 7461       for each_ta
+00038990: 7267 6574 2069 6e20 795f 696e 7075 742e  rget in y_input.
+000389a0: 636f 6c75 6d6e 733a 0a20 2020 2020 2020  columns:.       
+000389b0: 2020 2020 2020 2020 2072 6172 655f 636c           rare_cl
+000389c0: 6173 735f 7765 6967 6874 735b 6561 6368  ass_weights[each
+000389d0: 5f74 6172 6765 745d 203d 2067 6574 5f73  _target] = get_s
+000389e0: 6361 6c65 5f70 6f73 5f77 6569 6768 7428  cale_pos_weight(
+000389f0: 795f 696e 7075 745b 6561 6368 5f74 6172  y_input[each_tar
+00038a00: 6765 745d 290a 2020 2020 2020 2020 2020  get]).          
+00038a10: 2020 7265 7475 726e 2072 6172 655f 636c    return rare_cl
+00038a20: 6173 735f 7765 6967 6874 730a 2020 2020  ass_weights.    
+00038a30: 2020 2020 656c 7365 3a0a 2020 2020 2020      else:.      
+00038a40: 2020 2020 2020 795f 696e 7075 7420 3d20        y_input = 
+00038a50: 795f 696e 7075 742e 7661 6c75 6573 2e72  y_input.values.r
+00038a60: 6573 6861 7065 282d 3129 0a20 2020 200a  eshape(-1).    .
+00038a70: 2020 2020 7261 7265 5f63 6c61 7373 203d      rare_class =
+00038a80: 2066 696e 645f 7261 7265 5f63 6c61 7373   find_rare_class
+00038a90: 2879 5f69 6e70 7574 290a 2020 2020 7261  (y_input).    ra
+00038aa0: 7265 5f63 6c61 7373 5f77 6569 6768 7420  re_class_weight 
+00038ab0: 3d20 636c 6173 735f 7765 6967 6874 6564  = class_weighted
+00038ac0: 5f72 6f77 735b 7261 7265 5f63 6c61 7373  _rows[rare_class
+00038ad0: 5d0a 2020 2020 6966 2076 6572 626f 7365  ].    if verbose
+00038ae0: 3a0a 2020 2020 2020 2020 7072 696e 7428  :.        print(
+00038af0: 2720 2020 2046 6f72 2063 6c61 7373 2025  '    For class %
+00038b00: 732c 2077 6569 6768 7420 3d20 2573 2720  s, weight = %s' 
+00038b10: 2528 7261 7265 5f63 6c61 7373 2c20 7261  %(rare_class, ra
+00038b20: 7265 5f63 6c61 7373 5f77 6569 6768 7429  re_class_weight)
+00038b30: 290a 2020 2020 7265 7475 726e 2072 6172  ).    return rar
+00038b40: 655f 636c 6173 735f 7765 6967 6874 0a23  e_class_weight.#
+00038b50: 2323 2323 2323 2323 2323 2323 2323 2323  ################
+00038b60: 2323 2323 2323 2323 2323 2323 2323 2323  ################
+00038b70: 2323 2323 2323 2323 2323 2323 2323 2323  ################
+00038b80: 2323 2323 2323 2323 2323 2323 2323 2323  ################
+00038b90: 2323 2323 2323 2323 230a 6672 6f6d 2063  #########.from c
+00038ba0: 6f6c 6c65 6374 696f 6e73 2069 6d70 6f72  ollections impor
+00038bb0: 7420 6465 6661 756c 7464 6963 740a 6672  t defaultdict.fr
+00038bc0: 6f6d 2063 6f6c 6c65 6374 696f 6e73 2069  om collections i
+00038bd0: 6d70 6f72 7420 4f72 6465 7265 6444 6963  mport OrderedDic
+00038be0: 740a 6465 6620 7265 7475 726e 5f6d 696e  t.def return_min
+00038bf0: 6f72 6974 795f 7361 6d70 6c65 7328 792c  ority_samples(y,
+00038c00: 2076 6572 626f 7365 3d30 293a 0a20 2020   verbose=0):.   
+00038c10: 2022 2222 0a20 2020 2023 2323 2320 4361   """.    #### Ca
+00038c20: 6c63 756c 6174 6573 2074 6865 2025 2063  lculates the % c
+00038c30: 6f75 6e74 206f 6620 6561 6368 2063 6c61  ount of each cla
+00038c40: 7373 2069 6e20 7920 616e 6420 7265 7475  ss in y and retu
+00038c50: 726e 7320 6120 0a20 2020 2023 2323 2320  rns a .    #### 
+00038c60: 736d 616c 6c65 7220 7365 7420 6f66 2079  smaller set of y
+00038c70: 2062 6173 6564 206f 6e20 6265 696e 6720   based on being 
+00038c80: 3525 206f 7220 6c65 7373 206f 6620 6461  5% or less of da
+00038c90: 7461 7365 742e 0a20 2020 2049 7420 7265  taset..    It re
+00038ca0: 7475 726e 7320 7468 6520 736d 616c 6c20  turns the small 
+00038cb0: 7920 6173 2061 6e20 6172 7261 7920 6f72  y as an array or
+00038cc0: 2064 6174 6166 7261 6d65 2061 7320 696e   dataframe as in
+00038cd0: 7075 7420 7920 7761 732e 0a20 2020 2022  put y was..    "
+00038ce0: 2222 0a20 2020 2069 6d70 6f72 7420 636f  "".    import co
+00038cf0: 7079 0a20 2020 2079 203d 2063 6f70 792e  py.    y = copy.
+00038d00: 6465 6570 636f 7079 2879 290a 2020 2020  deepcopy(y).    
+00038d10: 6966 2069 7369 6e73 7461 6e63 6528 792c  if isinstance(y,
+00038d20: 206e 702e 6e64 6172 7261 7929 3a0a 2020   np.ndarray):.  
+00038d30: 2020 2020 2020 6c73 203d 2070 642e 5365        ls = pd.Se
+00038d40: 7269 6573 2879 292e 7661 6c75 655f 636f  ries(y).value_co
+00038d50: 756e 7473 2829 5b28 7064 2e53 6572 6965  unts()[(pd.Serie
+00038d60: 7328 7929 2e76 616c 7565 5f63 6f75 6e74  s(y).value_count
+00038d70: 7328 3129 3c3d 302e 3035 292e 7661 6c75  s(1)<=0.05).valu
+00038d80: 6573 5d2e 696e 6465 780a 2020 2020 2020  es].index.      
+00038d90: 2020 7265 7475 726e 2079 5b70 642e 5365    return y[pd.Se
+00038da0: 7269 6573 2879 292e 6973 696e 286c 7329  ries(y).isin(ls)
+00038db0: 2e76 616c 7565 735d 0a20 2020 2065 6c73  .values].    els
+00038dc0: 653a 0a20 2020 2020 2020 2069 6620 6973  e:.        if is
+00038dd0: 696e 7374 616e 6365 2879 2c20 7064 2e53  instance(y, pd.S
+00038de0: 6572 6965 7329 3a0a 2020 2020 2020 2020  eries):.        
+00038df0: 2020 2020 6c73 203d 2079 2e76 616c 7565      ls = y.value
+00038e00: 5f63 6f75 6e74 7328 295b 2879 2e76 616c  _counts()[(y.val
+00038e10: 7565 5f63 6f75 6e74 7328 3129 3c3d 302e  ue_counts(1)<=0.
+00038e20: 3035 292e 7661 6c75 6573 5d2e 696e 6465  05).values].inde
+00038e30: 780a 2020 2020 2020 2020 656c 7365 3a0a  x.        else:.
+00038e40: 2020 2020 2020 2020 2020 2020 7920 3d20              y = 
+00038e50: 792e 696c 6f63 5b3a 2c30 5d0a 2020 2020  y.iloc[:,0].    
+00038e60: 2020 2020 2020 2020 6c73 203d 2079 2e76          ls = y.v
+00038e70: 616c 7565 5f63 6f75 6e74 7328 295b 2879  alue_counts()[(y
+00038e80: 2e76 616c 7565 5f63 6f75 6e74 7328 3129  .value_counts(1)
+00038e90: 3c3d 302e 3035 292e 7661 6c75 6573 5d2e  <=0.05).values].
+00038ea0: 696e 6465 780a 2020 2020 2020 2020 7265  index.        re
+00038eb0: 7475 726e 2079 5b79 2e69 7369 6e28 6c73  turn y[y.isin(ls
+00038ec0: 295d 0a0a 6465 6620 6e75 6d5f 636c 6173  )]..def num_clas
+00038ed0: 7365 7328 792c 2076 6572 626f 7365 3d30  ses(y, verbose=0
+00038ee0: 293a 0a20 2020 2022 2222 0a20 2020 2023  ):.    """.    #
+00038ef0: 2323 2052 6574 7572 6e73 206e 756d 6265  ## Returns numbe
+00038f00: 7220 6f66 2063 6c61 7373 6573 2069 6e20  r of classes in 
+00038f10: 790a 2020 2020 2222 220a 2020 2020 696d  y.    """.    im
+00038f20: 706f 7274 2063 6f70 790a 2020 2020 7920  port copy.    y 
+00038f30: 3d20 636f 7079 2e64 6565 7063 6f70 7928  = copy.deepcopy(
+00038f40: 7929 0a20 2020 2069 6620 6973 696e 7374  y).    if isinst
+00038f50: 616e 6365 2879 2c20 6e70 2e6e 6461 7272  ance(y, np.ndarr
+00038f60: 6179 293a 0a20 2020 2020 2020 206c 7320  ay):.        ls 
+00038f70: 3d20 7064 2e53 6572 6965 7328 7929 2e6e  = pd.Series(y).n
+00038f80: 756e 6971 7565 2829 0a20 2020 2065 6c73  unique().    els
+00038f90: 653a 0a20 2020 2020 2020 2069 6620 6973  e:.        if is
+00038fa0: 696e 7374 616e 6365 2879 2c20 7064 2e53  instance(y, pd.S
+00038fb0: 6572 6965 7329 3a0a 2020 2020 2020 2020  eries):.        
+00038fc0: 2020 2020 6c73 203d 2079 2e6e 756e 6971      ls = y.nuniq
+00038fd0: 7565 2829 0a20 2020 2020 2020 2065 6c73  ue().        els
+00038fe0: 653a 0a20 2020 2020 2020 2020 2020 2069  e:.            i
+00038ff0: 6620 6c65 6e28 792e 636f 6c75 6d6e 7329  f len(y.columns)
+00039000: 203e 3d20 323a 0a20 2020 2020 2020 2020   >= 2:.         
+00039010: 2020 2020 2020 206c 7320 3d20 4f72 6465         ls = Orde
+00039020: 7265 6444 6963 7428 290a 2020 2020 2020  redDict().      
+00039030: 2020 2020 2020 2020 2020 666f 7220 6561            for ea
+00039040: 6368 5f69 2069 6e20 792e 636f 6c75 6d6e  ch_i in y.column
+00039050: 733a 0a20 2020 2020 2020 2020 2020 2020  s:.             
+00039060: 2020 2020 2020 206c 735b 6561 6368 5f69         ls[each_i
+00039070: 5d20 3d20 795b 6561 6368 5f69 5d2e 6e75  ] = y[each_i].nu
+00039080: 6e69 7175 6528 290a 2020 2020 2020 2020  nique().        
+00039090: 2020 2020 2020 2020 7265 7475 726e 206c          return l
+000390a0: 730a 2020 2020 2020 2020 2020 2020 656c  s.            el
+000390b0: 7365 3a0a 2020 2020 2020 2020 2020 2020  se:.            
+000390c0: 2020 2020 6c73 203d 2079 2e6e 756e 6971      ls = y.nuniq
+000390d0: 7565 2829 5b30 5d0a 2020 2020 7265 7475  ue()[0].    retu
+000390e0: 726e 206c 730a 0a64 6566 2072 6574 7572  rn ls..def retur
+000390f0: 6e5f 6d69 6e6f 7269 7479 5f63 6c61 7373  n_minority_class
+00039100: 6573 2879 2c20 7665 7262 6f73 653d 3029  es(y, verbose=0)
+00039110: 3a0a 2020 2020 2222 220a 2020 2020 2323  :.    """.    ##
+00039120: 2323 2043 616c 6375 6c61 7465 7320 7468  ## Calculates th
+00039130: 6520 2520 636f 756e 7420 6f66 2065 6163  e % count of eac
+00039140: 6820 636c 6173 7320 696e 2079 2061 6e64  h class in y and
+00039150: 2072 6574 7572 6e73 2061 200a 2020 2020   returns a .    
+00039160: 2323 2323 2073 6d61 6c6c 6572 2073 6574  #### smaller set
+00039170: 206f 6620 7920 6261 7365 6420 6f6e 2062   of y based on b
+00039180: 6569 6e67 2035 2520 6f72 206c 6573 7320  eing 5% or less 
+00039190: 6f66 2064 6174 6173 6574 2e0a 2020 2020  of dataset..    
+000391a0: 4974 2072 6574 7572 6e73 2074 6865 206c  It returns the l
+000391b0: 6973 7420 6f66 2063 6c61 7373 6573 2074  ist of classes t
+000391c0: 6861 7420 6172 6520 3c3d 3525 2063 6c61  hat are <=5% cla
+000391d0: 7373 6573 2e0a 2020 2020 2222 220a 2020  sses..    """.  
+000391e0: 2020 696d 706f 7274 2063 6f70 790a 2020    import copy.  
+000391f0: 2020 7920 3d20 636f 7079 2e64 6565 7063    y = copy.deepc
+00039200: 6f70 7928 7929 0a20 2020 2069 6620 6973  opy(y).    if is
+00039210: 696e 7374 616e 6365 2879 2c20 6e70 2e6e  instance(y, np.n
+00039220: 6461 7272 6179 293a 0a20 2020 2020 2020  darray):.       
+00039230: 206c 7320 3d20 7064 2e53 6572 6965 7328   ls = pd.Series(
+00039240: 7929 2e76 616c 7565 5f63 6f75 6e74 7328  y).value_counts(
+00039250: 295b 2870 642e 5365 7269 6573 2879 292e  )[(pd.Series(y).
+00039260: 7661 6c75 655f 636f 756e 7473 2831 293c  value_counts(1)<
+00039270: 3d30 2e30 3529 2e76 616c 7565 735d 2e69  =0.05).values].i
+00039280: 6e64 6578 0a20 2020 2065 6c73 653a 0a20  ndex.    else:. 
+00039290: 2020 2020 2020 2069 6620 6973 696e 7374         if isinst
+000392a0: 616e 6365 2879 2c20 7064 2e53 6572 6965  ance(y, pd.Serie
+000392b0: 7329 3a0a 2020 2020 2020 2020 2020 2020  s):.            
+000392c0: 6c73 203d 2079 2e76 616c 7565 5f63 6f75  ls = y.value_cou
+000392d0: 6e74 7328 295b 2879 2e76 616c 7565 5f63  nts()[(y.value_c
+000392e0: 6f75 6e74 7328 3129 3c3d 302e 3035 292e  ounts(1)<=0.05).
+000392f0: 7661 6c75 6573 5d2e 696e 6465 780a 2020  values].index.  
+00039300: 2020 2020 2020 656c 7365 3a0a 2020 2020        else:.    
+00039310: 2020 2020 2020 2020 7920 3d20 792e 696c          y = y.il
+00039320: 6f63 5b3a 2c30 5d0a 2020 2020 2020 2020  oc[:,0].        
+00039330: 2020 2020 6c73 203d 2079 2e76 616c 7565      ls = y.value
+00039340: 5f63 6f75 6e74 7328 295b 2879 2e76 616c  _counts()[(y.val
+00039350: 7565 5f63 6f75 6e74 7328 3129 3c3d 302e  ue_counts(1)<=0.
+00039360: 3035 292e 7661 6c75 6573 5d2e 696e 6465  05).values].inde
+00039370: 780a 2020 2020 7265 7475 726e 206c 730a  x.    return ls.
+00039380: 2323 2323 2323 2323 2323 2323 2323 2323  ################
+00039390: 2323 2323 2323 2323 2323 2323 2323 2323  ################
+000393a0: 2323 2323 2323 2323 2323 2323 2323 2323  ################
+000393b0: 2323 2323 2323 2323 2323 2323 2323 2323  ################
+000393c0: 2323 2323 2323 2323 2323 2323 2323 2323  ################
+000393d0: 230a 6465 6620 6765 745f 6361 7264 696e  #.def get_cardin
+000393e0: 616c 6974 7928 582c 2063 6174 5f66 6561  ality(X, cat_fea
+000393f0: 7475 7265 7329 3a0a 2020 2020 2323 2070  tures):.    ## p
+00039400: 6963 6b20 6120 6c69 6d69 7420 666f 7220  ick a limit for 
+00039410: 6361 7264 696e 616c 2076 6172 6961 626c  cardinal variabl
+00039420: 6573 2068 6572 6520 2323 0a20 2020 2063  es here ##.    c
+00039430: 6174 5f6c 696d 6974 203d 2033 300a 2020  at_limit = 30.  
+00039440: 2020 6d61 736b 203d 2058 5b63 6174 5f66    mask = X[cat_f
+00039450: 6561 7475 7265 735d 2e6e 756e 6971 7565  eatures].nunique
+00039460: 2829 203e 2063 6174 5f6c 696d 6974 0a20  () > cat_limit. 
+00039470: 2020 2068 6967 685f 6361 7264 696e 616c     high_cardinal
+00039480: 5f76 6172 7320 3d20 6361 745f 6665 6174  _vars = cat_feat
+00039490: 7572 6573 5b6d 6173 6b5d 0a20 2020 206c  ures[mask].    l
+000394a0: 6f77 5f63 6172 6469 6e61 6c5f 7661 7273  ow_cardinal_vars
+000394b0: 203d 2063 6174 5f66 6561 7475 7265 735b   = cat_features[
+000394c0: 7e6d 6173 6b5d 0a20 2020 2072 6574 7572  ~mask].    retur
+000394d0: 6e20 6c6f 775f 6361 7264 696e 616c 5f76  n low_cardinal_v
+000394e0: 6172 732c 2068 6967 685f 6361 7264 696e  ars, high_cardin
+000394f0: 616c 5f76 6172 730a 2323 2323 2323 2323  al_vars.########
+00039500: 2323 2323 2323 2323 2323 2323 2323 2323  ################
+00039510: 2323 2323 2323 2323 2323 2323 2323 2323  ################
+00039520: 2323 2323 2323 2323 2323 2323 2323 2323  ################
+00039530: 2323 2323 2323 2323 2323 2323 2323 2323  ################
+00039540: 2323 2323 2323 2323 0a64 6566 2069 735f  ########.def is_
+00039550: 795f 6f62 6a65 6374 2879 293a 0a20 2020  y_object(y):.   
+00039560: 2074 6573 7431 203d 2028 792e 6474 7970   test1 = (y.dtyp
+00039570: 6573 2e61 6e79 2829 3d3d 6f62 6a65 6374  es.any()==object
+00039580: 2920 7c20 2879 2e64 7479 7065 732e 616e  ) | (y.dtypes.an
+00039590: 7928 293d 3d62 6f6f 6c29 0a20 2020 2074  y()==bool).    t
+000395a0: 6573 7432 203d 2073 7472 2879 2e64 7479  est2 = str(y.dty
+000395b0: 7065 732e 616e 7928 2929 3d3d 2763 6174  pes.any())=='cat
+000395c0: 6567 6f72 7927 0a20 2020 2072 6574 7572  egory'.    retur
+000395d0: 6e20 7465 7374 3120 7c20 7465 7374 320a  n test1 | test2.
+000395e0: 0a64 6566 2070 7269 6e74 5f66 6c61 7474  .def print_flatt
+000395f0: 656e 5f64 6963 7428 6464 2c20 7365 7061  en_dict(dd, sepa
+00039600: 7261 746f 723d 275f 272c 2070 7265 6669  rator='_', prefi
+00039610: 783d 2727 293a 0a20 2020 2023 2323 2074  x=''):.    ### t
+00039620: 6869 7320 6675 6e63 7469 6f6e 2069 7320  his function is 
+00039630: 746f 2066 6c61 7474 656e 2064 6963 7420  to flatten dict 
+00039640: 746f 2070 7269 6e74 2063 6c61 7373 6573  to print classes
+00039650: 2061 6e64 2074 6865 6972 206f 7264 6572   and their order
+00039660: 2023 2323 0a20 2020 2023 2323 204f 6e65   ###.    ### One
+00039670: 2073 6f6c 7574 696f 6e20 6865 7265 3a20   solution here: 
+00039680: 6874 7470 733a 2f2f 7374 6163 6b6f 7665  https://stackove
+00039690: 7266 6c6f 772e 636f 6d2f 7175 6573 7469  rflow.com/questi
+000396a0: 6f6e 732f 3630 3237 3535 382f 666c 6174  ons/6027558/flat
+000396b0: 7465 6e2d 6e65 7374 6564 2d64 6963 7469  ten-nested-dicti
+000396c0: 6f6e 6172 6965 732d 636f 6d70 7265 7373  onaries-compress
+000396d0: 696e 672d 6b65 7973 0a20 2020 2023 2323  ing-keys.    ###
+000396e0: 2049 2068 6176 6520 6d6f 6469 6669 6564   I have modified
+000396f0: 2069 7420 746f 206d 616b 6520 6974 2077   it to make it w
+00039700: 6f72 6b20 666f 7220 6d65 2023 2323 2323  ork for me #####
+00039710: 2323 2323 2323 2323 2323 2323 0a20 2020  ############.   
+00039720: 2072 6574 7572 6e20 7b20 7072 6566 6978   return { prefix
+00039730: 202b 2073 6570 6172 6174 6f72 202b 2073   + separator + s
+00039740: 7472 286b 2920 6966 2070 7265 6669 7820  tr(k) if prefix 
+00039750: 656c 7365 206b 203a 2076 0a20 2020 2020  else k : v.     
+00039760: 2020 2020 2020 2020 666f 7220 6b6b 2c20          for kk, 
+00039770: 7676 2069 6e20 6464 2e69 7465 6d73 2829  vv in dd.items()
+00039780: 0a20 2020 2020 2020 2020 2020 2020 666f  .             fo
+00039790: 7220 6b2c 2076 2069 6e20 7072 696e 745f  r k, v in print_
+000397a0: 666c 6174 7465 6e5f 6469 6374 2876 762c  flatten_dict(vv,
+000397b0: 2073 6570 6172 6174 6f72 2c20 6b6b 292e   separator, kk).
+000397c0: 6974 656d 7328 290a 2020 2020 2020 2020  items().        
+000397d0: 2020 2020 207d 2069 6620 6973 696e 7374       } if isinst
+000397e0: 616e 6365 2864 642c 2064 6963 7429 2065  ance(dd, dict) e
+000397f0: 6c73 6520 7b20 7072 6566 6978 203a 2064  lse { prefix : d
+00039800: 6420 7d0a 0a64 6566 2070 7269 6e74 5f61  d }..def print_a
+00039810: 6363 7572 6163 7928 7461 7267 6574 2c20  ccuracy(target, 
+00039820: 795f 7465 7374 2c20 795f 7072 6564 732c  y_test, y_preds,
+00039830: 2076 6572 626f 7365 3d30 293a 0a20 2020   verbose=0):.   
+00039840: 2062 616c 5f73 636f 7265 7320 3d20 5b5d   bal_scores = []
+00039850: 0a20 2020 200a 2020 2020 6672 6f6d 2073  .    .    from s
+00039860: 6b6c 6561 726e 2e6d 6574 7269 6373 2069  klearn.metrics i
+00039870: 6d70 6f72 7420 6261 6c61 6e63 6564 5f61  mport balanced_a
+00039880: 6363 7572 6163 795f 7363 6f72 652c 2063  ccuracy_score, c
+00039890: 6c61 7373 6966 6963 6174 696f 6e5f 7265  lassification_re
+000398a0: 706f 7274 0a20 2020 2069 6620 6973 696e  port.    if isin
+000398b0: 7374 616e 6365 2874 6172 6765 742c 2073  stance(target, s
+000398c0: 7472 293a 200a 2020 2020 2020 2020 6261  tr): .        ba
+000398d0: 6c5f 7363 6f72 6520 3d20 6261 6c61 6e63  l_score = balanc
+000398e0: 6564 5f61 6363 7572 6163 795f 7363 6f72  ed_accuracy_scor
+000398f0: 6528 795f 7465 7374 2c79 5f70 7265 6473  e(y_test,y_preds
+00039900: 290a 2020 2020 2020 2020 6261 6c5f 7363  ).        bal_sc
+00039910: 6f72 6573 2e61 7070 656e 6428 6261 6c5f  ores.append(bal_
+00039920: 7363 6f72 6529 0a20 2020 2020 2020 2069  score).        i
+00039930: 6620 7665 7262 6f73 653a 0a20 2020 2020  f verbose:.     
+00039940: 2020 2020 2020 2070 7269 6e74 2827 4261         print('Ba
+00039950: 6c20 6163 6375 2025 302e 3066 2525 2720  l accu %0.0f%%' 
+00039960: 2528 3130 302a 6261 6c5f 7363 6f72 6529  %(100*bal_score)
+00039970: 290a 2020 2020 2020 2020 2020 2020 7072  ).            pr
+00039980: 696e 7428 636c 6173 7369 6669 6361 7469  int(classificati
+00039990: 6f6e 5f72 6570 6f72 7428 795f 7465 7374  on_report(y_test
+000399a0: 2c79 5f70 7265 6473 2929 0a20 2020 2065  ,y_preds)).    e
+000399b0: 6c69 6620 6c65 6e28 7461 7267 6574 2920  lif len(target) 
+000399c0: 3c3d 2031 3a0a 2020 2020 2020 2020 6261  <= 1:.        ba
+000399d0: 6c5f 7363 6f72 6520 3d20 6261 6c61 6e63  l_score = balanc
+000399e0: 6564 5f61 6363 7572 6163 795f 7363 6f72  ed_accuracy_scor
+000399f0: 6528 795f 7465 7374 2c79 5f70 7265 6473  e(y_test,y_preds
+00039a00: 290a 2020 2020 2020 2020 6261 6c5f 7363  ).        bal_sc
+00039a10: 6f72 6573 2e61 7070 656e 6428 6261 6c5f  ores.append(bal_
+00039a20: 7363 6f72 6529 0a20 2020 2020 2020 2069  score).        i
+00039a30: 6620 7665 7262 6f73 653a 0a20 2020 2020  f verbose:.     
+00039a40: 2020 2020 2020 2070 7269 6e74 2827 4261         print('Ba
+00039a50: 6c20 6163 6375 2025 302e 3066 2525 2720  l accu %0.0f%%' 
+00039a60: 2528 3130 302a 6261 6c5f 7363 6f72 6529  %(100*bal_score)
+00039a70: 290a 2020 2020 2020 2020 2020 2020 7072  ).            pr
+00039a80: 696e 7428 636c 6173 7369 6669 6361 7469  int(classificati
+00039a90: 6f6e 5f72 6570 6f72 7428 795f 7465 7374  on_report(y_test
+00039aa0: 2c79 5f70 7265 6473 2929 0a20 2020 2065  ,y_preds)).    e
+00039ab0: 6c73 653a 0a20 2020 2020 2020 2066 6f72  lse:.        for
+00039ac0: 2065 6163 685f 692c 2074 6172 6765 745f   each_i, target_
+00039ad0: 6e61 6d65 2069 6e20 656e 756d 6572 6174  name in enumerat
+00039ae0: 6528 7461 7267 6574 293a 0a20 2020 2020  e(target):.     
+00039af0: 2020 2020 2020 2062 616c 5f73 636f 7265         bal_score
+00039b00: 203d 2062 616c 616e 6365 645f 6163 6375   = balanced_accu
+00039b10: 7261 6379 5f73 636f 7265 2879 5f74 6573  racy_score(y_tes
+00039b20: 742e 7661 6c75 6573 5b3a 2c65 6163 685f  t.values[:,each_
+00039b30: 695d 2c79 5f70 7265 6473 5b3a 2c65 6163  i],y_preds[:,eac
+00039b40: 685f 695d 290a 2020 2020 2020 2020 2020  h_i]).          
+00039b50: 2020 6261 6c5f 7363 6f72 6573 2e61 7070    bal_scores.app
+00039b60: 656e 6428 6261 6c5f 7363 6f72 6529 0a20  end(bal_score). 
+00039b70: 2020 2020 2020 2020 2020 2069 6620 7665             if ve
+00039b80: 7262 6f73 653a 0a20 2020 2020 2020 2020  rbose:.         
+00039b90: 2020 2020 2020 2069 6620 6561 6368 5f69         if each_i
+00039ba0: 203d 3d20 303a 0a20 2020 2020 2020 2020   == 0:.         
+00039bb0: 2020 2020 2020 2020 2020 2070 7269 6e74             print
+00039bc0: 2827 466f 7220 2573 3a27 2025 7461 7267  ('For %s:' %targ
+00039bd0: 6574 5f6e 616d 6529 0a20 2020 2020 2020  et_name).       
+00039be0: 2020 2020 2020 2020 2070 7269 6e74 2827           print('
+00039bf0: 2020 2020 4261 6c20 6163 6375 2025 302e      Bal accu %0.
+00039c00: 3066 2525 2720 2528 3130 302a 6261 6c5f  0f%%' %(100*bal_
+00039c10: 7363 6f72 6529 290a 2020 2020 2020 2020  score)).        
+00039c20: 2020 2020 2020 2020 7072 696e 7428 636c          print(cl
+00039c30: 6173 7369 6669 6361 7469 6f6e 5f72 6570  assification_rep
+00039c40: 6f72 7428 795f 7465 7374 2e76 616c 7565  ort(y_test.value
+00039c50: 735b 3a2c 6561 6368 5f69 5d2c 795f 7072  s[:,each_i],y_pr
+00039c60: 6564 735b 3a2c 6561 6368 5f69 5d29 290a  eds[:,each_i])).
+00039c70: 2020 2020 7265 7475 726e 206e 702e 6d65      return np.me
+00039c80: 616e 2862 616c 5f73 636f 7265 7329 0a23  an(bal_scores).#
+00039c90: 2323 2323 2323 2323 2323 2323 2323 2323  ################
+00039ca0: 2323 2323 2323 2323 2323 2323 2323 2323  ################
+00039cb0: 2323 2323 2323 2323 2323 2323 2323 2323  ################
+00039cc0: 2323 2323 2323 2323 2323 2323 2323 2323  ################
+00039cd0: 2323 2323 2323 2323 2323 2323 2323 2323  ################
+00039ce0: 2323 2323 2323 2323 230a 6672 6f6d 2063  #########.from c
+00039cf0: 6f6c 6c65 6374 696f 6e73 2069 6d70 6f72  ollections impor
+00039d00: 7420 6465 6661 756c 7464 6963 740a 6465  t defaultdict.de
+00039d10: 6620 7265 7475 726e 5f70 7265 6469 6374  f return_predict
+00039d20: 5f70 726f 6261 2879 5f70 726f 6261 7329  _proba(y_probas)
+00039d30: 3a0a 2020 2020 2323 2320 5468 6973 2069  :.    ### This i
+00039d40: 7320 666f 7220 6465 7465 6374 696e 6720  s for detecting 
+00039d50: 7768 6174 2d6c 6162 656c 2077 6861 742d  what-label what-
+00039d60: 636c 6173 7320 7072 6f62 6c65 6d73 2077  class problems w
+00039d70: 6974 6820 7072 6f62 6173 2023 2323 230a  ith probas ####.
+00039d80: 2020 2020 7072 6f62 6c65 6d74 7970 6520      problemtype 
+00039d90: 3d20 2222 0a20 2020 2069 6620 6973 696e  = "".    if isin
+00039da0: 7374 616e 6365 2879 5f70 726f 6261 732c  stance(y_probas,
+00039db0: 206c 6973 7429 3a0a 2020 2020 2020 2020   list):.        
+00039dc0: 2323 2320 795f 7072 6f62 6173 2069 7320  ### y_probas is 
+00039dd0: 6120 6c69 7374 2077 6865 6e20 7920 6973  a list when y is
+00039de0: 206d 756c 7469 2d6c 6162 656c 2e20 0a20   multi-label. . 
+00039df0: 2020 2020 2020 2069 6620 6973 696e 7374         if isinst
+00039e00: 616e 6365 2879 5f70 726f 6261 735b 305d  ance(y_probas[0]
+00039e10: 2c20 6c69 7374 293a 0a20 2020 2020 2020  , list):.       
+00039e20: 2020 2020 2023 2320 2020 2031 2e20 4966       ##    1. If
+00039e30: 2079 2069 7320 6d75 6c74 695f 6c61 6265   y is multi_labe
+00039e40: 6c20 6275 7420 6861 7320 6d6f 7265 2074  l but has more t
+00039e50: 6861 6e20 7477 6f20 636c 6173 7365 732c  han two classes,
+00039e60: 2079 5f70 726f 6261 735b 305d 2069 7320   y_probas[0] is 
+00039e70: 616c 736f 2061 206c 6973 7420 2323 0a20  also a list ##. 
+00039e80: 2020 2020 2020 2020 2020 2070 726f 626c             probl
+00039e90: 656d 7479 7065 203d 2022 6d75 6c74 695f  emtype = "multi_
+00039ea0: 6c61 6265 6c5f 6d75 6c74 695f 636c 6173  label_multi_clas
+00039eb0: 7322 0a20 2020 2020 2020 2065 6c73 653a  s".        else:
+00039ec0: 0a20 2020 2020 2020 2020 2020 2069 6e69  .            ini
+00039ed0: 7469 616c 203d 2079 5f70 726f 6261 735b  tial = y_probas[
+00039ee0: 305d 2e73 6861 7065 5b31 5d0a 2020 2020  0].shape[1].    
+00039ef0: 2020 2020 2020 2020 6966 206e 702e 616c          if np.al
+00039f00: 6c28 5b78 2e73 6861 7065 5b31 5d3d 3d69  l([x.shape[1]==i
+00039f10: 6e69 7469 616c 2066 6f72 2078 2069 6e20  nitial for x in 
+00039f20: 795f 7072 6f62 6173 5d29 3a0a 2020 2020  y_probas]):.    
+00039f30: 2020 2020 2020 2020 2020 2020 7072 6f62              prob
+00039f40: 6c65 6d74 7970 6520 3d20 2022 6d75 6c74  lemtype =  "mult
+00039f50: 695f 6c61 6265 6c5f 6269 6e61 7279 5f63  i_label_binary_c
+00039f60: 6c61 7373 220a 2020 2020 2020 2020 2020  lass".          
+00039f70: 2020 656c 7365 3a0a 2020 2020 2020 2020    else:.        
+00039f80: 2020 2020 2020 2020 7072 6f62 6c65 6d74          problemt
+00039f90: 7970 6520 3d20 226d 756c 7469 5f6c 6162  ype = "multi_lab
+00039fa0: 656c 5f6d 756c 7469 5f63 6c61 7373 220a  el_multi_class".
+00039fb0: 2020 2020 656c 7365 3a0a 2020 2020 2020      else:.      
+00039fc0: 2020 7072 6f62 6c65 6d74 7970 6520 3d20    problemtype = 
+00039fd0: 2273 696e 676c 655f 6c61 6265 6c22 0a20  "single_label". 
+00039fe0: 2020 2023 2323 2320 5468 6973 2069 7320     #### This is 
+00039ff0: 666f 7220 6d61 6b69 6e67 206d 756c 7469  for making multi
+0003a000: 2d6c 6162 656c 206d 756c 7469 2d63 6c61  -label multi-cla
+0003a010: 7373 2070 7265 6469 6374 696f 6e73 2069  ss predictions i
+0003a020: 6e74 6f20 6120 6469 6374 696f 6e61 7279  nto a dictionary
+0003a030: 2023 230a 2020 2020 6966 2070 726f 626c   ##.    if probl
+0003a040: 656d 7479 7065 203d 3d20 226d 756c 7469  emtype == "multi
+0003a050: 5f6c 6162 656c 5f6d 756c 7469 5f63 6c61  _label_multi_cla
+0003a060: 7373 223a 0a20 2020 2020 2020 2070 726f  ss":.        pro
+0003a070: 6261 735f 6469 6374 203d 2064 6566 6175  bas_dict = defau
+0003a080: 6c74 6469 6374 286c 6973 7429 0a20 2020  ltdict(list).   
+0003a090: 2020 2020 2023 2323 2049 6e69 7469 616c       ### Initial
+0003a0a0: 697a 6520 7468 6520 6465 6661 756c 7420  ize the default 
+0003a0b0: 6469 6374 2023 2323 2323 2323 2323 2323  dict ###########
+0003a0c0: 2323 0a20 2020 2020 2020 2066 6f72 2065  ##.        for e
+0003a0d0: 6163 685f 7461 7267 6574 2069 6e20 7261  ach_target in ra
+0003a0e0: 6e67 6528 6c65 6e28 795f 7072 6f62 6173  nge(len(y_probas
+0003a0f0: 5b30 5d29 293a 0a20 2020 2020 2020 2020  [0])):.         
+0003a100: 2020 2070 726f 6261 735f 6469 6374 5b65     probas_dict[e
+0003a110: 6163 685f 7461 7267 6574 5d20 3d20 5b5d  ach_target] = []
+0003a120: 0a20 2020 2020 2020 2023 2323 2320 4e6f  .        #### No
+0003a130: 7720 7468 6174 2069 7420 6973 2069 7320  w that it is is 
+0003a140: 696e 6974 6961 6c69 7a65 642c 2063 6f6d  initialized, com
+0003a150: 7069 6c65 2065 6163 6820 636c 6173 7320  pile each class 
+0003a160: 696e 746f 2069 7473 206f 776e 206c 6973  into its own lis
+0003a170: 7420 2323 230a 2020 2020 2020 2020 6966  t ###.        if
+0003a180: 2069 7369 6e73 7461 6e63 6528 795f 7072   isinstance(y_pr
+0003a190: 6f62 6173 5b30 5d2c 206c 6973 7429 3a0a  obas[0], list):.
+0003a1a0: 2020 2020 2020 2020 2020 2020 666f 7220              for 
+0003a1b0: 6561 6368 5f69 2069 6e20 7261 6e67 6528  each_i in range(
+0003a1c0: 6c65 6e28 795f 7072 6f62 6173 2929 3a0a  len(y_probas)):.
+0003a1d0: 2020 2020 2020 2020 2020 2020 2020 2020                  
+0003a1e0: 666f 7220 6561 6368 5f6a 2069 6e20 7261  for each_j in ra
+0003a1f0: 6e67 6528 6c65 6e28 795f 7072 6f62 6173  nge(len(y_probas
+0003a200: 5b65 6163 685f 695d 2929 3a0a 2020 2020  [each_i])):.    
+0003a210: 2020 2020 2020 2020 2020 2020 2020 2020                  
+0003a220: 6966 2079 5f70 726f 6261 735b 6561 6368  if y_probas[each
+0003a230: 5f69 5d5b 6561 6368 5f6a 5d2e 7368 6170  _i][each_j].shap
+0003a240: 655b 315d 203e 2032 3a0a 2020 2020 2020  e[1] > 2:.      
+0003a250: 2020 2020 2020 2020 2020 2020 2020 2020                  
+0003a260: 2020 7072 6f62 6173 5f64 6963 745b 6561    probas_dict[ea
+0003a270: 6368 5f6a 5d2e 6170 7065 6e64 2879 5f70  ch_j].append(y_p
+0003a280: 726f 6261 735b 6561 6368 5f69 5d5b 6561  robas[each_i][ea
+0003a290: 6368 5f6a 5d29 0a20 2020 2020 2020 2020  ch_j]).         
+0003a2a0: 2020 2020 2020 2020 2020 2065 6c73 653a             else:
+0003a2b0: 0a20 2020 2020 2020 2020 2020 2020 2020  .               
+0003a2c0: 2020 2020 2020 2020 2070 726f 6261 735f           probas_
+0003a2d0: 6469 6374 5b65 6163 685f 6a5d 2e61 7070  dict[each_j].app
+0003a2e0: 656e 6428 795f 7072 6f62 6173 5b65 6163  end(y_probas[eac
+0003a2f0: 685f 695d 5b65 6163 685f 6a5d 5b3a 2c31  h_i][each_j][:,1
+0003a300: 5d29 0a20 2020 2020 2020 2020 2020 2023  ]).            #
+0003a310: 2323 2320 4f6e 6365 2061 6c6c 206f 6620  ### Once all of 
+0003a320: 7468 6520 7072 6f62 6173 2068 6176 6520  the probas have 
+0003a330: 6265 656e 2070 7574 2069 6e20 6120 6469  been put in a di
+0003a340: 6374 696f 6e61 7279 2c20 6e6f 7720 636f  ctionary, now co
+0003a350: 6d70 7574 6520 6d65 616e 7320 2323 0a20  mpute means ##. 
+0003a360: 2020 2020 2020 2020 2020 2066 6f72 2065             for e
+0003a370: 6163 685f 7461 7267 6574 2069 6e20 7261  ach_target in ra
+0003a380: 6e67 6528 6c65 6e28 7072 6f62 6173 5f64  nge(len(probas_d
+0003a390: 6963 7429 293a 0a20 2020 2020 2020 2020  ict)):.         
+0003a3a0: 2020 2020 2020 2070 726f 6261 735f 6469         probas_di
+0003a3b0: 6374 5b65 6163 685f 7461 7267 6574 5d20  ct[each_target] 
+0003a3c0: 3d20 6e70 2e61 7272 6179 2870 726f 6261  = np.array(proba
+0003a3d0: 735f 6469 6374 5b65 6163 685f 7461 7267  s_dict[each_targ
+0003a3e0: 6574 5d29 2e6d 6561 6e28 6178 6973 3d30  et]).mean(axis=0
+0003a3f0: 290a 2020 2020 656c 6966 2070 726f 626c  ).    elif probl
+0003a400: 656d 7479 7065 203d 3d20 226d 756c 7469  emtype == "multi
+0003a410: 5f6c 6162 656c 5f62 696e 6172 795f 636c  _label_binary_cl
+0003a420: 6173 7322 3a0a 2020 2020 2020 2020 696e  ass":.        in
+0003a430: 6974 6961 6c20 3d20 795f 7072 6f62 6173  itial = y_probas
+0003a440: 5b30 5d2e 7368 6170 655b 315d 0a20 2020  [0].shape[1].   
+0003a450: 2020 2020 2069 6620 6e70 2e61 6c6c 285b       if np.all([
+0003a460: 782e 7368 6170 655b 315d 3d3d 696e 6974  x.shape[1]==init
+0003a470: 6961 6c20 666f 7220 7820 696e 2079 5f70  ial for x in y_p
+0003a480: 726f 6261 735d 293a 0a20 2020 2020 2020  robas]):.       
+0003a490: 2020 2020 2070 726f 6261 735f 6469 6374       probas_dict
+0003a4a0: 203d 206e 702e 6172 7261 7928 795f 7072   = np.array(y_pr
+0003a4b0: 6f62 6173 292e 6d65 616e 2861 7869 733d  obas).mean(axis=
+0003a4c0: 3029 0a20 2020 2072 6574 7572 6e20 7072  0).    return pr
+0003a4d0: 6f62 6173 5f64 6963 7420 2020 0a23 2323  obas_dict   .###
+0003a4e0: 2323 2323 2323 2323 2323 2323 2323 2323  ################
+0003a4f0: 2323 2323 2323 2323 2323 2323 2323 2323  ################
+0003a500: 2323 2323 2323 2323 2323 2323 2323 2323  ################
+0003a510: 2323 2323 2323 2323 2323 2323 2323 2323  ################
+0003a520: 2323 2323 2323 2323 2323 2323 2323 2323  ################
+0003a530: 2323 2323 2323 2323 2323 2323 0a66 726f  ############.fro
+0003a540: 6d20 736b 6c65 6172 6e2e 6d65 7472 6963  m sklearn.metric
+0003a550: 7320 696d 706f 7274 2072 6f63 5f61 7563  s import roc_auc
+0003a560: 5f73 636f 7265 0a69 6d70 6f72 7420 636f  _score.import co
+0003a570: 7079 0a66 726f 6d20 736b 6c65 6172 6e2e  py.from sklearn.
+0003a580: 6d65 7472 6963 7320 696d 706f 7274 2062  metrics import b
+0003a590: 616c 616e 6365 645f 6163 6375 7261 6379  alanced_accuracy
+0003a5a0: 5f73 636f 7265 2c20 636c 6173 7369 6669  _score, classifi
+0003a5b0: 6361 7469 6f6e 5f72 6570 6f72 740a 696d  cation_report.im
+0003a5c0: 706f 7274 2070 6462 0a64 6566 2070 7269  port pdb.def pri
+0003a5d0: 6e74 5f73 756c 6f5f 6163 6375 7261 6379  nt_sulo_accuracy
+0003a5e0: 2879 5f74 6573 742c 2079 5f70 7265 6473  (y_test, y_preds
+0003a5f0: 2c20 795f 7072 6f62 6173 3d27 272c 2076  , y_probas='', v
+0003a600: 6572 626f 7365 3d30 293a 0a20 2020 2062  erbose=0):.    b
+0003a610: 616c 5f73 636f 7265 7320 3d20 5b5d 0a20  al_scores = []. 
+0003a620: 2020 2023 2323 2323 2323 204f 6e63 6520     ####### Once 
+0003a630: 796f 7520 6861 7665 2064 6574 6563 7465  you have detecte
+0003a640: 6420 7768 6174 2070 726f 626c 656d 2069  d what problem i
+0003a650: 7420 6973 2c20 6e6f 7720 7072 696e 7420  t is, now print 
+0003a660: 6974 7320 7363 6f72 6573 2023 2323 2323  its scores #####
+0003a670: 0a20 2020 2069 6620 795f 7465 7374 2e6e  .    if y_test.n
+0003a680: 6469 6d20 3c3d 2031 3a20 0a20 2020 2020  dim <= 1: .     
+0003a690: 2020 2023 2323 2054 6869 7320 6973 2061     ### This is a
+0003a6a0: 2073 696e 676c 6520 6c61 6265 6c20 7072   single label pr
+0003a6b0: 6f62 6c65 6d20 2320 7765 206e 6565 6420  oblem # we need 
+0003a6c0: 746f 2074 6573 7420 666f 7220 6d75 6c74  to test for mult
+0003a6d0: 6963 6c61 7373 2023 230a 2020 2020 2020  iclass ##.      
+0003a6e0: 2020 6261 6c5f 7363 6f72 6520 3d20 6261    bal_score = ba
+0003a6f0: 6c61 6e63 6564 5f61 6363 7572 6163 795f  lanced_accuracy_
+0003a700: 7363 6f72 6528 795f 7465 7374 2c79 5f70  score(y_test,y_p
+0003a710: 7265 6473 290a 2020 2020 2020 2020 7072  reds).        pr
+0003a720: 696e 7428 2742 616c 2061 6363 7520 2530  int('Bal accu %0
+0003a730: 2e30 6625 2527 2025 2831 3030 2a62 616c  .0f%%' %(100*bal
+0003a740: 5f73 636f 7265 2929 0a20 2020 2020 2020  _score)).       
+0003a750: 2069 6620 6e6f 7420 6973 696e 7374 616e   if not isinstan
+0003a760: 6365 2879 5f70 726f 6261 732c 2073 7472  ce(y_probas, str
+0003a770: 293a 0a20 2020 2020 2020 2020 2020 2069  ):.            i
+0003a780: 6620 795f 7072 6f62 6173 2e6e 6469 6d20  f y_probas.ndim 
+0003a790: 3c3d 2031 3a0a 2020 2020 2020 2020 2020  <= 1:.          
+0003a7a0: 2020 2020 2020 7072 696e 7428 2752 4f43        print('ROC
+0003a7b0: 2041 5543 203d 2025 302e 3266 2720 2572   AUC = %0.2f' %r
+0003a7c0: 6f63 5f61 7563 5f73 636f 7265 2879 5f74  oc_auc_score(y_t
+0003a7d0: 6573 742c 2079 5f70 726f 6261 735b 3a2c  est, y_probas[:,
+0003a7e0: 315d 2929 0a20 2020 2020 2020 2020 2020  1])).           
+0003a7f0: 2065 6c73 653a 0a20 2020 2020 2020 2020   else:.         
+0003a800: 2020 2020 2020 2069 6620 795f 7072 6f62         if y_prob
+0003a810: 6173 2e73 6861 7065 5b31 5d20 3d3d 2032  as.shape[1] == 2
+0003a820: 3a0a 2020 2020 2020 2020 2020 2020 2020  :.              
+0003a830: 2020 2020 2020 7072 696e 7428 2752 4f43        print('ROC
+0003a840: 2041 5543 203d 2025 302e 3266 2720 2572   AUC = %0.2f' %r
+0003a850: 6f63 5f61 7563 5f73 636f 7265 2879 5f74  oc_auc_score(y_t
+0003a860: 6573 742c 2079 5f70 726f 6261 735b 3a2c  est, y_probas[:,
+0003a870: 315d 2929 0a20 2020 2020 2020 2020 2020  1])).           
+0003a880: 2020 2020 2065 6c73 653a 0a20 2020 2020       else:.     
+0003a890: 2020 2020 2020 2020 2020 2020 2020 2070                 p
+0003a8a0: 7269 6e74 2827 4d75 6c74 692d 636c 6173  rint('Multi-clas
+0003a8b0: 7320 524f 4320 4155 4320 3d20 2530 2e32  s ROC AUC = %0.2
+0003a8c0: 6627 2025 726f 635f 6175 635f 7363 6f72  f' %roc_auc_scor
+0003a8d0: 6528 795f 7465 7374 2c20 795f 7072 6f62  e(y_test, y_prob
+0003a8e0: 6173 2c20 6d75 6c74 695f 636c 6173 733d  as, multi_class=
+0003a8f0: 226f 7672 2229 290a 2020 2020 2020 2020  "ovr")).        
+0003a900: 6261 6c5f 7363 6f72 6573 2e61 7070 656e  bal_scores.appen
+0003a910: 6428 6261 6c5f 7363 6f72 6529 0a20 2020  d(bal_score).   
+0003a920: 2020 2020 2069 6620 7665 7262 6f73 653a       if verbose:
+0003a930: 0a20 2020 2020 2020 2020 2020 2070 7269  .            pri
+0003a940: 6e74 2863 6c61 7373 6966 6963 6174 696f  nt(classificatio
+0003a950: 6e5f 7265 706f 7274 2879 5f74 6573 742c  n_report(y_test,
+0003a960: 795f 7072 6564 7329 290a 2020 2020 656c  y_preds)).    el
+0003a970: 6966 2079 5f74 6573 742e 6e64 696d 203e  if y_test.ndim >
+0003a980: 3d20 323a 0a20 2020 2020 2020 2069 6620  = 2:.        if 
+0003a990: 795f 7465 7374 2e73 6861 7065 5b31 5d20  y_test.shape[1] 
+0003a9a0: 3d3d 2031 3a0a 2020 2020 2020 2020 2020  == 1:.          
+0003a9b0: 2020 6261 6c5f 7363 6f72 6520 3d20 6261    bal_score = ba
+0003a9c0: 6c61 6e63 6564 5f61 6363 7572 6163 795f  lanced_accuracy_
+0003a9d0: 7363 6f72 6528 795f 7465 7374 2c79 5f70  score(y_test,y_p
+0003a9e0: 7265 6473 290a 2020 2020 2020 2020 2020  reds).          
+0003a9f0: 2020 6261 6c5f 7363 6f72 6573 2e61 7070    bal_scores.app
+0003aa00: 656e 6428 6261 6c5f 7363 6f72 6529 0a20  end(bal_score). 
+0003aa10: 2020 2020 2020 2020 2020 2070 7269 6e74             print
+0003aa20: 2827 4261 6c20 6163 6375 2025 302e 3066  ('Bal accu %0.0f
+0003aa30: 2525 2720 2528 3130 302a 6261 6c5f 7363  %%' %(100*bal_sc
+0003aa40: 6f72 6529 290a 2020 2020 2020 2020 2020  ore)).          
+0003aa50: 2020 6966 206e 6f74 2069 7369 6e73 7461    if not isinsta
+0003aa60: 6e63 6528 795f 7072 6f62 6173 2c20 7374  nce(y_probas, st
+0003aa70: 7229 3a0a 2020 2020 2020 2020 2020 2020  r):.            
+0003aa80: 2020 2020 6966 2079 5f70 726f 6261 732e      if y_probas.
+0003aa90: 7368 6170 655b 315d 203e 2032 3a0a 2020  shape[1] > 2:.  
+0003aaa0: 2020 2020 2020 2020 2020 2020 2020 2020                  
+0003aab0: 2020 7072 696e 7428 2752 4f43 2041 5543    print('ROC AUC
+0003aac0: 203d 2025 302e 3266 2720 2572 6f63 5f61   = %0.2f' %roc_a
+0003aad0: 7563 5f73 636f 7265 2879 5f74 6573 742c  uc_score(y_test,
+0003aae0: 2079 5f70 726f 6261 732c 206d 756c 7469   y_probas, multi
+0003aaf0: 5f63 6c61 7373 3d22 6f76 7222 2929 0a20  _class="ovr")). 
+0003ab00: 2020 2020 2020 2020 2020 2020 2020 2065                 e
+0003ab10: 6c73 653a 0a20 2020 2020 2020 2020 2020  lse:.           
+0003ab20: 2020 2020 2020 2020 2070 7269 6e74 2827           print('
+0003ab30: 524f 4320 4155 4320 3d20 2530 2e32 6627  ROC AUC = %0.2f'
+0003ab40: 2025 726f 635f 6175 635f 7363 6f72 6528   %roc_auc_score(
+0003ab50: 795f 7465 7374 2c20 795f 7072 6f62 6173  y_test, y_probas
+0003ab60: 5b3a 2c31 5d29 290a 2020 2020 2020 2020  [:,1])).        
+0003ab70: 2020 2020 6966 2076 6572 626f 7365 3a0a      if verbose:.
+0003ab80: 2020 2020 2020 2020 2020 2020 2020 2020                  
+0003ab90: 7072 696e 7428 636c 6173 7369 6669 6361  print(classifica
+0003aba0: 7469 6f6e 5f72 6570 6f72 7428 795f 7465  tion_report(y_te
+0003abb0: 7374 2c79 5f70 7265 6473 2929 0a20 2020  st,y_preds)).   
+0003abc0: 2020 2020 2065 6c73 653a 0a20 2020 2020       else:.     
+0003abd0: 2020 2020 2020 2069 6620 6973 696e 7374         if isinst
+0003abe0: 616e 6365 2879 5f70 726f 6261 732c 2073  ance(y_probas, s
+0003abf0: 7472 293a 0a20 2020 2020 2020 2020 2020  tr):.           
+0003ac00: 2020 2020 2023 2323 2054 6869 7320 6973       ### This is
+0003ac10: 2066 6f72 206d 756c 7469 2d6c 6162 656c   for multi-label
+0003ac20: 2070 726f 626c 656d 7320 7769 7468 6f75   problems withou
+0003ac30: 7420 7072 6f62 6173 2023 2323 230a 2020  t probas ####.  
+0003ac40: 2020 2020 2020 2020 2020 2020 2020 666f                fo
+0003ac50: 7220 6561 6368 5f69 2069 6e20 7261 6e67  r each_i in rang
+0003ac60: 6528 795f 7465 7374 2e73 6861 7065 5b31  e(y_test.shape[1
+0003ac70: 5d29 3a0a 2020 2020 2020 2020 2020 2020  ]):.            
+0003ac80: 2020 2020 2020 2020 6261 6c5f 7363 6f72          bal_scor
+0003ac90: 6520 3d20 6261 6c61 6e63 6564 5f61 6363  e = balanced_acc
+0003aca0: 7572 6163 795f 7363 6f72 6528 795f 7465  uracy_score(y_te
+0003acb0: 7374 2e76 616c 7565 735b 3a2c 6561 6368  st.values[:,each
+0003acc0: 5f69 5d2c 795f 7072 6564 735b 3a2c 6561  _i],y_preds[:,ea
+0003acd0: 6368 5f69 5d29 0a20 2020 2020 2020 2020  ch_i]).         
+0003ace0: 2020 2020 2020 2020 2020 2062 616c 5f73             bal_s
+0003acf0: 636f 7265 732e 6170 7065 6e64 2862 616c  cores.append(bal
+0003ad00: 5f73 636f 7265 290a 2020 2020 2020 2020  _score).        
+0003ad10: 2020 2020 2020 2020 2020 2020 7072 696e              prin
+0003ad20: 7428 2720 2020 2042 616c 2061 6363 7520  t('    Bal accu 
+0003ad30: 2530 2e30 6625 2527 2025 2831 3030 2a62  %0.0f%%' %(100*b
+0003ad40: 616c 5f73 636f 7265 2929 0a20 2020 2020  al_score)).     
+0003ad50: 2020 2020 2020 2020 2020 2020 2020 2069                 i
+0003ad60: 6620 7665 7262 6f73 653a 0a20 2020 2020  f verbose:.     
+0003ad70: 2020 2020 2020 2020 2020 2020 2020 2020                  
+0003ad80: 2020 2070 7269 6e74 2863 6c61 7373 6966     print(classif
+0003ad90: 6963 6174 696f 6e5f 7265 706f 7274 2879  ication_report(y
+0003ada0: 5f74 6573 742e 7661 6c75 6573 5b3a 2c65  _test.values[:,e
+0003adb0: 6163 685f 695d 2c79 5f70 7265 6473 5b3a  ach_i],y_preds[:
+0003adc0: 2c65 6163 685f 695d 2929 0a20 2020 2020  ,each_i])).     
+0003add0: 2020 2020 2020 2065 6c73 653a 0a20 2020         else:.   
+0003ade0: 2020 2020 2020 2020 2020 2020 2023 2323               ###
+0003adf0: 2323 2054 6869 7320 6973 206f 6e6c 7920  ## This is only 
+0003ae00: 666f 7220 6d75 6c74 695f 6c61 6265 6c5f  for multi_label_
+0003ae10: 6d75 6c74 695f 636c 6173 7320 7072 6f62  multi_class prob
+0003ae20: 6c65 6d73 0a20 2020 2020 2020 2020 2020  lems.           
+0003ae30: 2020 2020 206e 756d 5f74 6172 6765 7473       num_targets
+0003ae40: 203d 2079 5f74 6573 742e 7368 6170 655b   = y_test.shape[
+0003ae50: 315d 0a20 2020 2020 2020 2020 2020 2020  1].             
+0003ae60: 2020 2066 6f72 2065 6163 685f 6920 696e     for each_i in
+0003ae70: 2072 616e 6765 286e 756d 5f74 6172 6765   range(num_targe
+0003ae80: 7473 293a 0a20 2020 2020 2020 2020 2020  ts):.           
+0003ae90: 2020 2020 2020 2020 2070 7269 6e74 2827           print('
+0003aea0: 2020 2020 4261 6c20 6163 6375 2025 302e      Bal accu %0.
+0003aeb0: 3066 2525 2720 2528 3130 302a 6261 6c61  0f%%' %(100*bala
+0003aec0: 6e63 6564 5f61 6363 7572 6163 795f 7363  nced_accuracy_sc
+0003aed0: 6f72 6528 795f 7465 7374 2e76 616c 7565  ore(y_test.value
+0003aee0: 735b 3a2c 6561 6368 5f69 5d2c 795f 7072  s[:,each_i],y_pr
+0003aef0: 6564 735b 3a2c 6561 6368 5f69 5d29 2929  eds[:,each_i])))
+0003af00: 0a20 2020 2020 2020 2020 2020 2020 2020  .               
+0003af10: 2020 2020 2069 6620 6c65 6e28 6e70 2e75       if len(np.u
+0003af20: 6e69 7175 6528 795f 7465 7374 2e76 616c  nique(y_test.val
+0003af30: 7565 735b 3a2c 6561 6368 5f69 5d29 2920  ues[:,each_i])) 
+0003af40: 3e20 323a 0a20 2020 2020 2020 2020 2020  > 2:.           
+0003af50: 2020 2020 2020 2020 2020 2020 2023 2323               ###
+0003af60: 2054 6869 7320 6e61 6e20 7072 6f62 6c65   This nan proble
+0003af70: 6d20 6861 7070 656e 7320 6475 6520 746f  m happens due to
+0003af80: 204c 6162 656c 2050 726f 7061 6761 7469   Label Propagati
+0003af90: 6f6e 2062 7574 2063 616e 2062 6520 6669  on but can be fi
+0003afa0: 7865 6420 6173 2066 6f6c 6c6f 7773 2023  xed as follows #
+0003afb0: 230a 2020 2020 2020 2020 2020 2020 2020  #.              
+0003afc0: 2020 2020 2020 2020 2020 6d61 7420 3d20            mat = 
+0003afd0: 795f 7072 6f62 6173 5b65 6163 685f 695d  y_probas[each_i]
+0003afe0: 0a20 2020 2020 2020 2020 2020 2020 2020  .               
+0003aff0: 2020 2020 2020 2020 2069 6620 6e70 2e61           if np.a
+0003b000: 6e79 286e 702e 6973 6e61 6e28 6d61 7429  ny(np.isnan(mat)
+0003b010: 293a 0a20 2020 2020 2020 2020 2020 2020  ):.             
+0003b020: 2020 2020 2020 2020 2020 2020 2020 206d                 m
+0003b030: 6174 203d 2070 642e 4461 7461 4672 616d  at = pd.DataFram
+0003b040: 6528 6d61 7429 2e66 696c 6c6e 6128 6d65  e(mat).fillna(me
+0003b050: 7468 6f64 3d27 6666 696c 6c27 292e 7661  thod='ffill').va
+0003b060: 6c75 6573 0a20 2020 2020 2020 2020 2020  lues.           
+0003b070: 2020 2020 2020 2020 2020 2020 2020 2020                  
+0003b080: 2062 616c 5f73 636f 7265 203d 2072 6f63   bal_score = roc
+0003b090: 5f61 7563 5f73 636f 7265 2879 5f74 6573  _auc_score(y_tes
+0003b0a0: 742e 7661 6c75 6573 5b3a 2c65 6163 685f  t.values[:,each_
+0003b0b0: 695d 2c6d 6174 2c6d 756c 7469 5f63 6c61  i],mat,multi_cla
+0003b0c0: 7373 3d22 6f76 7222 290a 2020 2020 2020  ss="ovr").      
+0003b0d0: 2020 2020 2020 2020 2020 2020 2020 2020                  
+0003b0e0: 2020 656c 7365 3a0a 2020 2020 2020 2020    else:.        
+0003b0f0: 2020 2020 2020 2020 2020 2020 2020 2020                  
+0003b100: 2020 2020 6261 6c5f 7363 6f72 6520 3d20      bal_score = 
+0003b110: 726f 635f 6175 635f 7363 6f72 6528 795f  roc_auc_score(y_
+0003b120: 7465 7374 2e76 616c 7565 735b 3a2c 6561  test.values[:,ea
+0003b130: 6368 5f69 5d2c 6d61 742c 6d75 6c74 695f  ch_i],mat,multi_
+0003b140: 636c 6173 733d 226f 7672 2229 0a20 2020  class="ovr").   
+0003b150: 2020 2020 2020 2020 2020 2020 2020 2020                  
+0003b160: 2065 6c73 653a 0a20 2020 2020 2020 2020   else:.         
+0003b170: 2020 2020 2020 2020 2020 2020 2020 2069                 i
+0003b180: 6620 6973 696e 7374 616e 6365 2879 5f70  f isinstance(y_p
+0003b190: 726f 6261 732c 2064 6963 7429 3a0a 2020  robas, dict):.  
+0003b1a0: 2020 2020 2020 2020 2020 2020 2020 2020                  
+0003b1b0: 2020 2020 2020 2020 2020 6966 2079 5f70            if y_p
+0003b1c0: 726f 6261 735b 6561 6368 5f69 5d2e 6e64  robas[each_i].nd
+0003b1d0: 696d 203c 3d20 313a 0a20 2020 2020 2020  im <= 1:.       
+0003b1e0: 2020 2020 2020 2020 2020 2020 2020 2020                  
+0003b1f0: 2020 2020 2020 2020 2023 2320 5468 6973           ## This
+0003b200: 2069 7320 6361 7573 6564 2062 7920 4c61   is caused by La
+0003b210: 6265 6c20 5072 6f70 6167 6174 696f 6e20  bel Propagation 
+0003b220: 6865 6e63 6520 796f 7520 6d75 7374 2070  hence you must p
+0003b230: 726f 6261 7320 6c69 6b65 2074 6869 7320  robas like this 
+0003b240: 2323 0a20 2020 2020 2020 2020 2020 2020  ##.             
+0003b250: 2020 2020 2020 2020 2020 2020 2020 2020                  
+0003b260: 2020 206d 6174 203d 2079 5f70 726f 6261     mat = y_proba
+0003b270: 735b 6561 6368 5f69 5d0a 2020 2020 2020  s[each_i].      
+0003b280: 2020 2020 2020 2020 2020 2020 2020 2020                  
+0003b290: 2020 2020 2020 2020 2020 6966 206e 702e            if np.
+0003b2a0: 616e 7928 6e70 2e69 736e 616e 286d 6174  any(np.isnan(mat
+0003b2b0: 2929 3a0a 2020 2020 2020 2020 2020 2020  )):.            
+0003b2c0: 2020 2020 2020 2020 2020 2020 2020 2020                  
+0003b2d0: 2020 2020 2020 2020 6d61 7420 3d20 7064          mat = pd
+0003b2e0: 2e44 6174 6146 7261 6d65 286d 6174 292e  .DataFrame(mat).
+0003b2f0: 6669 6c6c 6e61 286d 6574 686f 643d 2766  fillna(method='f
+0003b300: 6669 6c6c 2729 2e76 616c 7565 730a 2020  fill').values.  
+0003b310: 2020 2020 2020 2020 2020 2020 2020 2020                  
+0003b320: 2020 2020 2020 2020 2020 2020 2020 6261                ba
+0003b330: 6c5f 7363 6f72 6520 3d20 726f 635f 6175  l_score = roc_au
+0003b340: 635f 7363 6f72 6528 795f 7465 7374 2e76  c_score(y_test.v
+0003b350: 616c 7565 735b 3a2c 6561 6368 5f69 5d2c  alues[:,each_i],
+0003b360: 6d61 7429 0a20 2020 2020 2020 2020 2020  mat).           
+0003b370: 2020 2020 2020 2020 2020 2020 2020 2020                  
+0003b380: 2065 6c73 653a 0a20 2020 2020 2020 2020   else:.         
+0003b390: 2020 2020 2020 2020 2020 2020 2020 2020                  
+0003b3a0: 2020 2020 2020 2062 616c 5f73 636f 7265         bal_score
+0003b3b0: 203d 2072 6f63 5f61 7563 5f73 636f 7265   = roc_auc_score
+0003b3c0: 2879 5f74 6573 742e 7661 6c75 6573 5b3a  (y_test.values[:
+0003b3d0: 2c65 6163 685f 695d 2c79 5f70 726f 6261  ,each_i],y_proba
+0003b3e0: 735b 6561 6368 5f69 5d5b 3a2c 315d 290a  s[each_i][:,1]).
+0003b3f0: 2020 2020 2020 2020 2020 2020 2020 2020                  
+0003b400: 2020 2020 2020 2020 656c 7365 3a0a 2020          else:.  
+0003b410: 2020 2020 2020 2020 2020 2020 2020 2020                  
+0003b420: 2020 2020 2020 2020 2020 6966 2079 5f70            if y_p
+0003b430: 726f 6261 732e 7368 6170 655b 315d 203d  robas.shape[1] =
+0003b440: 3d20 6e75 6d5f 7461 7267 6574 733a 0a20  = num_targets:. 
+0003b450: 2020 2020 2020 2020 2020 2020 2020 2020                  
+0003b460: 2020 2020 2020 2020 2020 2020 2020 2023                 #
+0003b470: 2323 2054 6869 7320 6d65 616e 7320 4c61  ## This means La
+0003b480: 6265 6c20 5072 6f70 6167 6174 696f 6e20  bel Propagation 
+0003b490: 7761 7320 7573 6564 2077 6869 6368 2063  was used which c
+0003b4a0: 7265 6174 6573 2070 726f 6261 7320 6c69  reates probas li
+0003b4b0: 6b65 2074 6869 7320 2323 0a20 2020 2020  ke this ##.     
+0003b4c0: 2020 2020 2020 2020 2020 2020 2020 2020                  
+0003b4d0: 2020 2020 2020 2020 2020 2062 616c 5f73             bal_s
+0003b4e0: 636f 7265 203d 2072 6f63 5f61 7563 5f73  core = roc_auc_s
+0003b4f0: 636f 7265 2879 5f74 6573 742e 7661 6c75  core(y_test.valu
+0003b500: 6573 5b3a 2c65 6163 685f 695d 2c79 5f70  es[:,each_i],y_p
+0003b510: 726f 6261 735b 3a2c 6561 6368 5f69 5d29  robas[:,each_i])
+0003b520: 0a20 2020 2020 2020 2020 2020 2020 2020  .               
+0003b530: 2020 2020 2020 2020 2020 2020 2065 6c73               els
+0003b540: 653a 0a20 2020 2020 2020 2020 2020 2020  e:.             
+0003b550: 2020 2020 2020 2020 2020 2020 2020 2020                  
+0003b560: 2020 2023 2323 2054 6869 7320 6d65 616e     ### This mean
+0003b570: 7320 7265 6775 6c61 7220 736b 6c65 6172  s regular sklear
+0003b580: 6e20 636c 6173 7369 6669 6572 7320 7768  n classifiers wh
+0003b590: 6963 6820 7072 6564 6963 7420 6d75 6c74  ich predict mult
+0003b5a0: 6920 6469 6d20 7072 6f62 6173 2023 0a20  i dim probas #. 
+0003b5b0: 2020 2020 2020 2020 2020 2020 2020 2020                  
+0003b5c0: 2020 2020 2020 2020 2020 2020 2020 2062                 b
+0003b5d0: 616c 5f73 636f 7265 203d 2072 6f63 5f61  al_score = roc_a
+0003b5e0: 7563 5f73 636f 7265 2879 5f74 6573 742e  uc_score(y_test.
+0003b5f0: 7661 6c75 6573 5b3a 2c65 6163 685f 695d  values[:,each_i]
+0003b600: 2c79 5f70 726f 6261 735b 6561 6368 5f69  ,y_probas[each_i
+0003b610: 5d29 0a20 2020 2020 2020 2020 2020 2020  ]).             
+0003b620: 2020 2020 2020 2070 7269 6e74 2827 5461         print('Ta
+0003b630: 7267 6574 206e 756d 6265 7220 2573 3a20  rget number %s: 
+0003b640: 524f 4320 4155 4320 7363 6f72 6520 2530  ROC AUC score %0
+0003b650: 2e30 6625 2527 2025 2865 6163 685f 692b  .0f%%' %(each_i+
+0003b660: 312c 3130 302a 6261 6c5f 7363 6f72 6529  1,100*bal_score)
+0003b670: 290a 2020 2020 2020 2020 2020 2020 2020  ).              
+0003b680: 2020 2020 2020 6261 6c5f 7363 6f72 6573        bal_scores
+0003b690: 2e61 7070 656e 6428 6261 6c5f 7363 6f72  .append(bal_scor
+0003b6a0: 6529 0a20 2020 2020 2020 2020 2020 2020  e).             
+0003b6b0: 2020 2020 2020 2069 6620 7665 7262 6f73         if verbos
+0003b6c0: 653a 0a20 2020 2020 2020 2020 2020 2020  e:.             
+0003b6d0: 2020 2020 2020 2020 2020 2070 7269 6e74             print
+0003b6e0: 2863 6c61 7373 6966 6963 6174 696f 6e5f  (classification_
+0003b6f0: 7265 706f 7274 2879 5f74 6573 742e 7661  report(y_test.va
+0003b700: 6c75 6573 5b3a 2c65 6163 685f 695d 2c79  lues[:,each_i],y
+0003b710: 5f70 7265 6473 5b3a 2c65 6163 685f 695d  _preds[:,each_i]
+0003b720: 2929 0a20 2020 2066 696e 616c 5f73 636f  )).    final_sco
+0003b730: 7265 203d 206e 702e 6d65 616e 2862 616c  re = np.mean(bal
+0003b740: 5f73 636f 7265 7329 0a20 2020 2069 6620  _scores).    if 
+0003b750: 7665 7262 6f73 653a 0a20 2020 2020 2020  verbose:.       
+0003b760: 2070 7269 6e74 2822 6669 6e61 6c20 6176   print("final av
+0003b770: 6572 6167 6520 6261 6c61 6e63 6564 2061  erage balanced a
+0003b780: 6363 7572 6163 7920 7363 6f72 6520 3d20  ccuracy score = 
+0003b790: 2530 2e32 6622 2025 6669 6e61 6c5f 7363  %0.2f" %final_sc
+0003b7a0: 6f72 6529 0a20 2020 2072 6574 7572 6e20  ore).    return 
+0003b7b0: 6669 6e61 6c5f 7363 6f72 650a 2323 2323  final_score.####
+0003b7c0: 2323 2323 2323 2323 2323 2323 2323 2323  ################
+0003b7d0: 2323 2323 2323 2323 2323 2323 2323 2323  ################
+0003b7e0: 2323 2323 2323 2323 2323 2323 2323 2323  ################
+0003b7f0: 2323 2323 2323 2323 2323 2323 2323 2323  ################
+0003b800: 2323 2323 2323 2323 2323 0a69 6d70 6f72  ##########.impor
+0003b810: 7420 6f73 0a64 6566 2063 6865 636b 5f69  t os.def check_i
+0003b820: 665f 4750 555f 6578 6973 7473 2829 3a0a  f_GPU_exists():.
+0003b830: 2020 2020 7472 793a 0a20 2020 2020 2020      try:.       
+0003b840: 206f 732e 656e 7669 726f 6e5b 274e 5649   os.environ['NVI
+0003b850: 4449 415f 5649 5349 424c 455f 4445 5649  DIA_VISIBLE_DEVI
+0003b860: 4345 5327 5d0a 2020 2020 2020 2020 7072  CES'].        pr
+0003b870: 696e 7428 2747 5055 2061 7661 696c 6162  int('GPU availab
+0003b880: 6c65 206f 6e20 7468 6973 2064 6576 6963  le on this devic
+0003b890: 652e 2050 6c65 6173 6520 6163 7469 7661  e. Please activa
+0003b8a0: 7465 2069 7420 746f 2073 7065 6564 2075  te it to speed u
+0003b8b0: 7020 6c69 6768 7467 626d 2e27 290a 2020  p lightgbm.').  
+0003b8c0: 2020 2020 2020 7265 7475 726e 2054 7275        return Tru
+0003b8d0: 650a 2020 2020 6578 6365 7074 3a0a 2020  e.    except:.  
+0003b8e0: 2020 2020 2020 7072 696e 7428 274e 6f20        print('No 
+0003b8f0: 4750 5520 6176 6169 6c61 626c 6520 6f6e  GPU available on
+0003b900: 2074 6869 7320 6465 7669 6365 2e20 5573   this device. Us
+0003b910: 696e 6720 4350 5520 666f 7220 6c69 6768  ing CPU for ligh
+0003b920: 7467 626d 2061 6e64 206f 7468 6572 732e  tgbm and others.
+0003b930: 2729 0a20 2020 2020 2020 2072 6574 7572  ').        retur
+0003b940: 6e20 4661 6c73 650a 2323 2323 2323 2323  n False.########
+0003b950: 2323 2323 2323 2323 2323 2323 2323 2323  ################
+0003b960: 2323 2323 2323 2323 2323 2323 2323 2323  ################
+0003b970: 2323 2323 2323 2323 2323 2323 2323 2323  ################
+0003b980: 2323 2323 2323 2323 2323 2323 2323 2323  ################
+0003b990: 2323 2323 2323 230a 6465 6620 6765 745f  #######.def get_
+0003b9a0: 6d61 785f 6d69 6e5f 6672 6f6d 5f79 2861  max_min_from_y(a
+0003b9b0: 6374 7561 6c73 293a 0a20 2020 2069 6620  ctuals):.    if 
+0003b9c0: 6973 696e 7374 616e 6365 2861 6374 7561  isinstance(actua
+0003b9d0: 6c73 2c20 7064 2e53 6572 6965 7329 3a0a  ls, pd.Series):.
+0003b9e0: 2020 2020 2020 2020 595f 6d69 6e20 3d20          Y_min = 
+0003b9f0: 6163 7475 616c 732e 7661 6c75 6573 2e6d  actuals.values.m
+0003ba00: 696e 2829 0a20 2020 2020 2020 2059 5f6d  in().        Y_m
+0003ba10: 6178 203d 2061 6374 7561 6c73 2e76 616c  ax = actuals.val
+0003ba20: 7565 732e 6d61 7828 290a 2020 2020 656c  ues.max().    el
+0003ba30: 6966 2069 7369 6e73 7461 6e63 6528 6163  if isinstance(ac
+0003ba40: 7475 616c 732c 2070 642e 4461 7461 4672  tuals, pd.DataFr
+0003ba50: 616d 6529 3a0a 2020 2020 2020 2020 595f  ame):.        Y_
+0003ba60: 6d69 6e20 3d20 6163 7475 616c 732e 7661  min = actuals.va
+0003ba70: 6c75 6573 2e72 6176 656c 2829 2e6d 696e  lues.ravel().min
+0003ba80: 2829 0a20 2020 2020 2020 2059 5f6d 6178  ().        Y_max
+0003ba90: 203d 2061 6374 7561 6c73 2e76 616c 7565   = actuals.value
+0003baa0: 732e 7261 7665 6c28 292e 6d61 7828 290a  s.ravel().max().
+0003bab0: 2020 2020 656c 7365 3a0a 2020 2020 2020      else:.      
+0003bac0: 2020 595f 6d69 6e20 3d20 6163 7475 616c    Y_min = actual
+0003bad0: 732e 6d69 6e28 290a 2020 2020 2020 2020  s.min().        
+0003bae0: 595f 6d61 7820 3d20 6163 7475 616c 732e  Y_max = actuals.
+0003baf0: 6d61 7828 290a 2020 2020 7265 7475 726e  max().    return
+0003bb00: 206e 702e 6172 7261 7928 5b59 5f6d 696e   np.array([Y_min
+0003bb10: 2c20 595f 6d61 785d 290a 0a64 6566 2063  , Y_max])..def c
+0003bb20: 6f6e 7665 7274 5f72 6567 7265 7373 696f  onvert_regressio
+0003bb30: 6e5f 746f 5f63 6c61 7373 6573 2870 7265  n_to_classes(pre
+0003bb40: 6469 6374 696f 6e73 2c20 6163 7475 616c  dictions, actual
+0003bb50: 7329 3a0a 2020 2020 6966 2069 7369 6e73  s):.    if isins
+0003bb60: 7461 6e63 6528 6163 7475 616c 732c 2070  tance(actuals, p
+0003bb70: 642e 5365 7269 6573 293a 0a20 2020 2020  d.Series):.     
+0003bb80: 2020 2059 5f6d 696e 203d 2061 6374 7561     Y_min = actua
+0003bb90: 6c73 2e76 616c 7565 732e 6d69 6e28 290a  ls.values.min().
+0003bba0: 2020 2020 2020 2020 595f 6d61 7820 3d20          Y_max = 
+0003bbb0: 6163 7475 616c 732e 7661 6c75 6573 2e6d  actuals.values.m
+0003bbc0: 6178 2829 0a20 2020 2065 6c69 6620 6973  ax().    elif is
+0003bbd0: 696e 7374 616e 6365 2861 6374 7561 6c73  instance(actuals
+0003bbe0: 2c20 7064 2e44 6174 6146 7261 6d65 293a  , pd.DataFrame):
+0003bbf0: 0a20 2020 2020 2020 2059 5f6d 696e 203d  .        Y_min =
+0003bc00: 2061 6374 7561 6c73 2e76 616c 7565 732e   actuals.values.
+0003bc10: 7261 7665 6c28 292e 6d69 6e28 290a 2020  ravel().min().  
+0003bc20: 2020 2020 2020 595f 6d61 7820 3d20 6163        Y_max = ac
+0003bc30: 7475 616c 732e 7661 6c75 6573 2e72 6176  tuals.values.rav
+0003bc40: 656c 2829 2e6d 6178 2829 0a20 2020 2065  el().max().    e
+0003bc50: 6c73 653a 0a20 2020 2020 2020 2059 5f6d  lse:.        Y_m
+0003bc60: 696e 203d 2061 6374 7561 6c73 2e6d 696e  in = actuals.min
+0003bc70: 2829 0a20 2020 2020 2020 2059 5f6d 6178  ().        Y_max
+0003bc80: 203d 2061 6374 7561 6c73 2e6d 6178 2829   = actuals.max()
+0003bc90: 0a20 2020 2070 7265 6469 6374 696f 6e73  .    predictions
+0003bca0: 203d 206e 702e 726f 756e 6428 7072 6564   = np.round(pred
+0003bcb0: 6963 7469 6f6e 732c 3029 2e61 7374 7970  ictions,0).astyp
+0003bcc0: 6528 696e 7429 0a20 2020 2070 7265 6469  e(int).    predi
+0003bcd0: 6374 696f 6e73 203d 206e 702e 7768 6572  ctions = np.wher
+0003bce0: 6528 7072 6564 6963 7469 6f6e 733c 595f  e(predictions<Y_
+0003bcf0: 6d69 6e2c 2059 5f6d 696e 2c20 7072 6564  min, Y_min, pred
+0003bd00: 6963 7469 6f6e 7329 0a20 2020 2070 7265  ictions).    pre
+0003bd10: 6469 6374 696f 6e73 203d 206e 702e 7768  dictions = np.wh
+0003bd20: 6572 6528 7072 6564 6963 7469 6f6e 733e  ere(predictions>
+0003bd30: 595f 6d61 782c 2059 5f6d 6178 2c20 7072  Y_max, Y_max, pr
+0003bd40: 6564 6963 7469 6f6e 7329 0a20 2020 2072  edictions).    r
+0003bd50: 6574 7572 6e20 7072 6564 6963 7469 6f6e  eturn prediction
+0003bd60: 730a 2323 2323 2323 2323 2323 2323 2323  s.##############
+0003bd70: 2323 2323 2323 2323 2323 2323 2323 2323  ################
+0003bd80: 2323 2323 2323 2323 2323 2323 2323 2323  ################
+0003bd90: 2323 2323 2323 2323 2323 2323 2323 2323  ################
+0003bda0: 2323 2323 2323 2323 2323 2323 2323 2323  ################
+0003bdb0: 230a 6672 6f6d 2073 6b6c 6561 726e 2e6d  #.from sklearn.m
+0003bdc0: 6574 7269 6373 2069 6d70 6f72 7420 6d65  etrics import me
+0003bdd0: 616e 5f73 7175 6172 6564 5f65 7272 6f72  an_squared_error
+0003bde0: 0a0a 6465 6620 726d 7365 2879 5f61 6374  ..def rmse(y_act
+0003bdf0: 7561 6c2c 2079 5f70 7265 6469 6374 6564  ual, y_predicted
+0003be00: 293a 0a20 2020 2072 6574 7572 6e20 6d65  ):.    return me
+0003be10: 616e 5f73 7175 6172 6564 5f65 7272 6f72  an_squared_error
+0003be20: 2879 5f61 6374 7561 6c2c 2079 5f70 7265  (y_actual, y_pre
+0003be30: 6469 6374 6564 2c20 7371 7561 7265 643d  dicted, squared=
+0003be40: 4661 6c73 6529 0a23 2323 2323 2323 2323  False).#########
+0003be50: 2323 2323 2323 2323 2323 2323 2323 2323  ################
+0003be60: 2323 2323 2323 2323 2323 2323 2323 2323  ################
+0003be70: 2323 2323 2323 2323 2323 2323 2323 2323  ################
+0003be80: 2323 2323 2323 2323 2323 2323 2323 2323  ################
+0003be90: 2323 2323 230a 636c 6173 7320 5375 6c6f  #####.class Sulo
+0003bea0: 5265 6772 6573 736f 7228 4261 7365 4573  Regressor(BaseEs
+0003beb0: 7469 6d61 746f 722c 2052 6567 7265 7373  timator, Regress
+0003bec0: 6f72 4d69 7869 6e29 3a0a 2020 2020 2222  orMixin):.    ""
+0003bed0: 220a 2020 2020 5375 6c6f 5265 6772 6573  ".    SuloRegres
+0003bee0: 736f 7220 7374 616e 6473 2066 6f72 2053  sor stands for S
+0003bef0: 7570 6572 204c 6561 726e 696e 6720 4f70  uper Learning Op
+0003bf00: 7469 6d69 7a65 6420 2853 554c 4f29 2052  timized (SULO) R
+0003bf10: 6567 7265 7373 6f72 2e0a 2020 2020 2d2d  egressor..    --
+0003bf20: 2049 7420 776f 726b 7320 6f6e 2073 6d61   It works on sma
+0003bf30: 6c6c 2061 7320 7765 6c6c 2061 7320 6269  ll as well as bi
+0003bf40: 6720 6461 7461 2e20 4974 2077 6f72 6b73  g data. It works
+0003bf50: 2069 6e20 496e 7465 6765 7220 6d6f 6465   in Integer mode
+0003bf60: 2061 7320 7765 6c6c 2061 7320 666c 6f61   as well as floa
+0003bf70: 742d 6d6f 6465 2e0a 2020 2020 2d2d 2049  t-mode..    -- I
+0003bf80: 7420 776f 726b 7320 6f6e 2072 6567 756c  t works on regul
+0003bf90: 6172 2062 616c 616e 6365 6420 6461 7461  ar balanced data
+0003bfa0: 2061 7320 7765 6c6c 2061 7320 736b 6577   as well as skew
+0003bfb0: 6564 2072 6567 7265 7373 696f 6e20 7461  ed regression ta
+0003bfc0: 7267 6574 732e 0a20 2020 2054 6865 2072  rgets..    The r
+0003bfd0: 6561 736f 6e20 6974 2077 6f72 6b73 2073  eason it works s
+0003bfe0: 6f20 7765 6c6c 2069 7320 7468 6174 2053  o well is that S
+0003bff0: 756c 6f20 6973 2061 6e20 656e 7365 6d62  ulo is an ensemb
+0003c000: 6c65 206f 6620 6869 6768 6c79 2074 756e  le of highly tun
+0003c010: 6564 206d 6f64 656c 732e 0a20 2020 202d  ed models..    -
+0003c020: 2d20 596f 7520 646f 6e27 7420 6861 7665  - You don't have
+0003c030: 2074 6f20 7365 6e64 2061 6e79 2069 6e70   to send any inp
+0003c040: 7574 7320 6275 7420 6966 2079 6f75 2077  uts but if you w
+0003c050: 616e 7465 6420 746f 2c20 796f 7520 6361  anted to, you ca
+0003c060: 6e20 7370 6566 6966 7920 6d75 6c74 6970  n spefify multip
+0003c070: 6c65 206f 7074 696f 6e73 2e0a 2020 2020  le options..    
+0003c080: 4974 2069 7320 6675 6c6c 7920 636f 6d70  It is fully comp
+0003c090: 6174 6962 6c65 2077 6974 6820 7363 696b  atible with scik
+0003c0a0: 6974 2d6c 6561 726e 2070 6970 656c 696e  it-learn pipelin
+0003c0b0: 6573 2061 6e64 206f 7468 6572 206d 6f64  es and other mod
+0003c0c0: 656c 732e 0a0a 2020 2020 5379 6e74 6178  els...    Syntax
+0003c0d0: 3a0a 2020 2020 2020 2020 7375 6c6f 203d  :.        sulo =
+0003c0e0: 2053 756c 6f52 6567 7265 7373 6f72 2862   SuloRegressor(b
+0003c0f0: 6173 655f 6573 7469 6d61 746f 723d 4e6f  ase_estimator=No
+0003c100: 6e65 2c20 6e5f 6573 7469 6d61 746f 7273  ne, n_estimators
+0003c110: 3d4e 6f6e 652c 2070 6970 656c 696e 653d  =None, pipeline=
+0003c120: 4661 6c73 652c 200a 2020 2020 2020 2020  False, .        
+0003c130: 2020 2020 2020 2020 2020 2020 2020 2020                  
+0003c140: 2020 2020 2020 2020 696d 6261 6c61 6e63          imbalanc
+0003c150: 6564 3d46 616c 7365 2c20 696e 7465 6765  ed=False, intege
+0003c160: 7273 5f6f 6e6c 793d 4661 6c73 652c 206c  rs_only=False, l
+0003c170: 6f67 5f74 7261 6e73 666f 726d 3d46 616c  og_transform=Fal
+0003c180: 7365 2c20 0a20 2020 2020 2020 2020 2020  se, .           
+0003c190: 2020 2020 2020 2020 2020 2020 2020 2020                  
+0003c1a0: 2020 2020 2074 696d 655f 7365 7269 6573       time_series
+0003c1b0: 203d 2046 616c 7365 2c20 7665 7262 6f73   = False, verbos
+0003c1c0: 653d 3029 0a20 2020 2020 2020 2073 756c  e=0).        sul
+0003c1d0: 6f2e 6669 7428 585f 7472 6169 6e2c 2079  o.fit(X_train, y
+0003c1e0: 5f74 7261 696e 290a 2020 2020 2020 2020  _train).        
+0003c1f0: 795f 7072 6564 7320 3d20 7375 6c6f 2e70  y_preds = sulo.p
+0003c200: 7265 6469 6374 2858 5f74 6573 7429 0a0a  redict(X_test)..
+0003c210: 2020 2020 496e 7075 7473 3a0a 2020 2020      Inputs:.    
+0003c220: 2020 2020 6e5f 6573 7469 6d61 746f 7273      n_estimators
+0003c230: 3a20 6465 6661 756c 7420 6973 204e 6f6e  : default is Non
+0003c240: 652e 204e 756d 6265 7220 6f66 206d 6f64  e. Number of mod
+0003c250: 656c 7320 796f 7520 7761 6e74 2069 6e20  els you want in 
+0003c260: 7468 6520 6669 6e61 6c20 656e 7365 6d62  the final ensemb
+0003c270: 6c65 2e0a 2020 2020 2020 2020 6261 7365  le..        base
+0003c280: 5f65 7374 696d 6174 6f72 3a20 6465 6661  _estimator: defa
+0003c290: 756c 7420 6973 204e 6f6e 652e 2042 6173  ult is None. Bas
+0003c2a0: 6520 6d6f 6465 6c20 796f 7520 7761 6e74  e model you want
+0003c2b0: 2074 6f20 7472 6169 6e20 696e 2065 6163   to train in eac
+0003c2c0: 6820 6f66 2074 6865 2065 6e73 656d 626c  h of the ensembl
+0003c2d0: 6573 2e0a 2020 2020 2020 2020 7069 7065  es..        pipe
+0003c2e0: 6c69 6e65 3a20 6465 6661 756c 7420 6973  line: default is
+0003c2f0: 2046 616c 7365 2e20 4974 2077 696c 6c20   False. It will 
+0003c300: 7472 616e 7366 6f72 6d20 616c 6c20 6461  transform all da
+0003c310: 7461 2074 6f20 6e75 6d65 7269 6320 6175  ta to numeric au
+0003c320: 746f 6d61 7469 6361 6c6c 7920 6966 2073  tomatically if s
+0003c330: 6574 2074 6f20 5472 7565 2e0a 2020 2020  et to True..    
+0003c340: 2020 2020 696d 6261 6c61 6e63 6564 3a20      imbalanced: 
+0003c350: 6465 6661 756c 7420 6973 2046 616c 7365  default is False
+0003c360: 2e20 4974 2077 696c 6c20 6163 7469 7661  . It will activa
+0003c370: 7465 2061 2073 7065 6369 616c 2069 6d62  te a special imb
+0003c380: 616c 616e 6365 6420 5265 6772 6573 736f  alanced Regresso
+0003c390: 7220 6966 2073 6574 2074 6f20 5472 7565  r if set to True
+0003c3a0: 2e0a 2020 2020 2020 2020 696e 7465 6765  ..        intege
+0003c3b0: 7273 5f6f 6e6c 793a 2064 6566 6175 6c74  rs_only: default
+0003c3c0: 2069 7320 4661 6c73 652e 2049 7420 7769   is False. It wi
+0003c3d0: 6c6c 2070 6572 666f 726d 2049 6e74 6567  ll perform Integ
+0003c3e0: 6572 2072 6567 7265 7373 696f 6e20 6966  er regression if
+0003c3f0: 2073 6574 2074 6f20 5472 7565 0a20 2020   set to True.   
+0003c400: 2020 2020 206c 6f67 5f74 7261 6e73 666f       log_transfo
+0003c410: 726d 3a20 6465 6661 756c 7420 6973 2046  rm: default is F
+0003c420: 616c 7365 2e20 4974 2077 696c 6c20 7065  alse. It will pe
+0003c430: 7266 6f72 6d20 6c6f 6720 7472 616e 7366  rform log transf
+0003c440: 6f72 6d61 7469 6f6e 206f 6620 7461 7267  ormation of targ
+0003c450: 6574 2069 6620 7365 7420 746f 2054 7275  et if set to Tru
+0003c460: 652e 0a20 2020 2020 2020 2074 696d 655f  e..        time_
+0003c470: 7365 7269 6573 3a20 6465 6661 756c 7420  series: default 
+0003c480: 6973 2046 616c 7365 2e20 4966 2073 6574  is False. If set
+0003c490: 2074 6f20 5472 7565 2c20 616e 2065 7870   to True, an exp
+0003c4a0: 616e 6469 6e67 2077 696e 646f 7720 5469  anding window Ti
+0003c4b0: 6d65 2053 6572 6965 7320 7370 6c69 7420  me Series split 
+0003c4c0: 6973 2070 6572 666f 726d 6564 2e0a 2020  is performed..  
+0003c4d0: 2020 2020 2020 2020 2020 496e 7374 6561            Instea
+0003c4e0: 642c 2075 7365 2022 736c 6964 696e 6722  d, use "sliding"
+0003c4f0: 2069 6620 796f 7520 7761 6e74 2069 7420   if you want it 
+0003c500: 746f 2070 6572 666f 726d 2061 2073 6c69  to perform a sli
+0003c510: 6469 6e67 2077 696e 646f 7720 7469 6d65  ding window time
+0003c520: 2073 6572 6965 7320 7370 6c69 742e 0a20   series split.. 
+0003c530: 2020 2020 2020 2076 6572 626f 7365 3a20         verbose: 
+0003c540: 6465 6661 756c 7420 6973 2030 2e20 4974  default is 0. It
+0003c550: 2077 696c 6c20 7072 696e 7420 7665 7262   will print verb
+0003c560: 6f73 6520 6f75 7470 7574 2069 6620 7365  ose output if se
+0003c570: 7420 746f 2054 7275 652e 0a0a 2020 2020  t to True...    
+0003c580: 4f75 7475 7473 3a0a 2020 2020 2020 2020  Oututs:.        
+0003c590: 7265 6772 6573 736f 723a 2072 6574 7572  regressor: retur
+0003c5a0: 6e73 2061 2072 6567 7265 7373 696f 6e20  ns a regression 
+0003c5b0: 6d6f 6465 6c20 6869 6768 6c79 2074 756e  model highly tun
+0003c5c0: 6564 2074 6f20 796f 7572 2073 7065 6369  ed to your speci
+0003c5d0: 6669 6320 6e65 6564 7320 616e 6420 6461  fic needs and da
+0003c5e0: 7461 7365 742e 0a20 2020 2022 2222 0a20  taset..    """. 
+0003c5f0: 2020 2064 6566 205f 5f69 6e69 745f 5f28     def __init__(
+0003c600: 7365 6c66 2c20 6261 7365 5f65 7374 696d  self, base_estim
+0003c610: 6174 6f72 3d4e 6f6e 652c 206e 5f65 7374  ator=None, n_est
+0003c620: 696d 6174 6f72 733d 4e6f 6e65 2c20 7069  imators=None, pi
+0003c630: 7065 6c69 6e65 3d46 616c 7365 2c20 696d  peline=False, im
+0003c640: 6261 6c61 6e63 6564 3d46 616c 7365 2c20  balanced=False, 
+0003c650: 0a20 2020 2020 2020 2020 2020 2020 2020  .               
+0003c660: 2020 2020 2020 2020 2020 2020 2020 2020                  
+0003c670: 2020 2020 2020 2020 696e 7465 6765 7273          integers
+0003c680: 5f6f 6e6c 793d 4661 6c73 652c 206c 6f67  _only=False, log
+0003c690: 5f74 7261 6e73 666f 726d 3d46 616c 7365  _transform=False
+0003c6a0: 2c20 0a20 2020 2020 2020 2020 2020 2020  , .             
+0003c6b0: 2020 2020 2020 2020 2020 2020 2020 2020                  
+0003c6c0: 2020 2020 2020 2020 2020 7469 6d65 5f73            time_s
+0003c6d0: 6572 6965 7320 3d20 4661 6c73 652c 2076  eries = False, v
+0003c6e0: 6572 626f 7365 3d30 293a 0a20 2020 2020  erbose=0):.     
+0003c6f0: 2020 2073 656c 662e 6e5f 6573 7469 6d61     self.n_estima
+0003c700: 746f 7273 203d 206e 5f65 7374 696d 6174  tors = n_estimat
+0003c710: 6f72 730a 2020 2020 2020 2020 7365 6c66  ors.        self
+0003c720: 2e62 6173 655f 6573 7469 6d61 746f 7220  .base_estimator 
+0003c730: 3d20 6261 7365 5f65 7374 696d 6174 6f72  = base_estimator
+0003c740: 0a20 2020 2020 2020 2073 656c 662e 7069  .        self.pi
+0003c750: 7065 6c69 6e65 203d 2070 6970 656c 696e  peline = pipelin
+0003c760: 650a 2020 2020 2020 2020 7365 6c66 2e69  e.        self.i
+0003c770: 6d62 616c 616e 6365 6420 3d20 696d 6261  mbalanced = imba
+0003c780: 6c61 6e63 6564 0a20 2020 2020 2020 2073  lanced.        s
+0003c790: 656c 662e 696e 7465 6765 7273 5f6f 6e6c  elf.integers_onl
+0003c7a0: 7920 3d20 696e 7465 6765 7273 5f6f 6e6c  y = integers_onl
+0003c7b0: 790a 2020 2020 2020 2020 7365 6c66 2e6c  y.        self.l
+0003c7c0: 6f67 5f74 7261 6e73 666f 726d 203d 206c  og_transform = l
+0003c7d0: 6f67 5f74 7261 6e73 666f 726d 0a20 2020  og_transform.   
+0003c7e0: 2020 2020 2073 656c 662e 7469 6d65 5f73       self.time_s
+0003c7f0: 6572 6965 7320 3d20 7469 6d65 5f73 6572  eries = time_ser
+0003c800: 6965 7320 0a20 2020 2020 2020 2073 656c  ies .        sel
+0003c810: 662e 7665 7262 6f73 6520 3d20 7665 7262  f.verbose = verb
+0003c820: 6f73 650a 2020 2020 2020 2020 7365 6c66  ose.        self
+0003c830: 2e6d 6f64 656c 7320 3d20 5b5d 0a20 2020  .models = [].   
+0003c840: 2020 2020 2073 656c 662e 6d75 6c74 695f       self.multi_
+0003c850: 6c61 6265 6c20 3d20 2046 616c 7365 0a20  label =  False. 
+0003c860: 2020 2020 2020 2073 656c 662e 7363 6f72         self.scor
+0003c870: 6573 203d 205b 5d0a 2020 2020 2020 2020  es = [].        
+0003c880: 7365 6c66 2e69 6e74 6567 6572 735f 6f6e  self.integers_on
+0003c890: 6c79 5f6d 696e 5f6d 6178 203d 205b 5d0a  ly_min_max = [].
+0003c8a0: 2020 2020 2020 2020 7365 6c66 2e6d 6f64          self.mod
+0003c8b0: 656c 5f6e 616d 6520 3d20 2727 0a20 2020  el_name = ''.   
+0003c8c0: 2020 2020 2073 656c 662e 6665 6174 7572       self.featur
+0003c8d0: 6573 203d 205b 5d0a 0a20 2020 2064 6566  es = []..    def
+0003c8e0: 2066 6974 2873 656c 662c 2058 2c20 7929   fit(self, X, y)
+0003c8f0: 3a0a 2020 2020 2020 2020 5820 3d20 636f  :.        X = co
+0003c900: 7079 2e64 6565 7063 6f70 7928 5829 0a20  py.deepcopy(X). 
+0003c910: 2020 2020 2020 2070 7269 6e74 2827 496e         print('In
+0003c920: 7075 7420 6461 7461 2073 6861 7065 733a  put data shapes:
+0003c930: 2058 203d 2025 7327 2025 2858 2e73 6861   X = %s' %(X.sha
+0003c940: 7065 2c29 290a 2020 2020 2020 2020 7072  pe,)).        pr
+0003c950: 696e 7428 2720 2020 2079 2073 6861 7065  int('    y shape
+0003c960: 203d 2025 7327 2025 2879 2e73 6861 7065   = %s' %(y.shape
+0003c970: 2c29 290a 2020 2020 2020 2020 7365 6564  ,)).        seed
+0003c980: 203d 2034 320a 2020 2020 2020 2020 7368   = 42.        sh
+0003c990: 7566 666c 6546 6c61 6720 3d20 5472 7565  uffleFlag = True
+0003c9a0: 0a20 2020 2020 2020 206d 6f64 656c 7479  .        modelty
+0003c9b0: 7065 203d 2027 5265 6772 6573 7369 6f6e  pe = 'Regression
+0003c9c0: 270a 2020 2020 2020 2020 6665 6174 7572  '.        featur
+0003c9d0: 6573 5f6c 696d 6974 203d 2035 3020 2323  es_limit = 50 ##
+0003c9e0: 2069 6620 7468 6572 6520 6172 6520 6d6f   if there are mo
+0003c9f0: 7265 2074 6861 6e20 3530 2066 6561 7475  re than 50 featu
+0003ca00: 7265 7320 696e 2064 6174 6173 6574 2c20  res in dataset, 
+0003ca10: 6265 7474 6572 2074 6f20 7573 6520 4c47  better to use LG
+0003ca20: 424d 2023 230a 2020 2020 2020 2020 7374  BM ##.        st
+0003ca30: 6172 7420 3d20 7469 6d65 2e74 696d 6528  art = time.time(
+0003ca40: 290a 2020 2020 2020 2020 6966 2069 7369  ).        if isi
+0003ca50: 6e73 7461 6e63 6528 582c 2070 642e 4461  nstance(X, pd.Da
+0003ca60: 7461 4672 616d 6529 3a0a 2020 2020 2020  taFrame):.      
+0003ca70: 2020 2020 2020 7365 6c66 2e66 6561 7475        self.featu
+0003ca80: 7265 7320 3d20 582e 636f 6c75 6d6e 732e  res = X.columns.
+0003ca90: 746f 6c69 7374 2829 0a20 2020 2020 2020  tolist().       
+0003caa0: 2065 6c73 653a 0a20 2020 2020 2020 2020   else:.         
+0003cab0: 2020 2070 7269 6e74 2827 4361 6e6e 6f74     print('Cannot
+0003cac0: 206f 7065 7261 7465 2053 756c 6f43 6c61   operate SuloCla
+0003cad0: 7373 6966 6965 7220 6f6e 206e 756d 7079  ssifier on numpy
+0003cae0: 2061 7272 6179 732e 204d 7573 7420 6265   arrays. Must be
+0003caf0: 2064 6174 6166 7261 6d65 732e 2052 6574   dataframes. Ret
+0003cb00: 7572 6e69 6e67 2e2e 2e27 290a 2020 2020  urning...').    
+0003cb10: 2020 2020 2020 2020 7265 7475 726e 2073          return s
+0003cb20: 656c 660a 2020 2020 2020 2020 2320 5573  elf.        # Us
+0003cb30: 6520 4b46 6f6c 6420 666f 7220 756e 6465  e KFold for unde
+0003cb40: 7273 7461 6e64 696e 6720 7468 6520 7065  rstanding the pe
+0003cb50: 7266 6f72 6d61 6e63 650a 2020 2020 2020  rformance.      
+0003cb60: 2020 6966 2073 656c 662e 696d 6261 6c61    if self.imbala
+0003cb70: 6e63 6564 3a0a 2020 2020 2020 2020 2020  nced:.          
+0003cb80: 2020 7072 696e 7428 2752 656d 656d 6265    print('Remembe
+0003cb90: 7220 7468 6174 2075 7369 6e67 2063 6c61  r that using cla
+0003cba0: 7373 2077 6569 6768 7473 2077 696c 6c20  ss weights will 
+0003cbb0: 7772 6f6e 676c 7920 736b 6577 2070 7265  wrongly skew pre
+0003cbc0: 6469 6374 5f70 726f 6261 7320 6672 6f6d  dict_probas from
+0003cbd0: 2061 6e79 2063 6c61 7373 6966 6965 7227   any classifier'
+0003cbe0: 290a 2020 2020 2020 2020 2323 2320 5265  ).        ### Re
+0003cbf0: 6d65 6d62 6572 2074 6861 7420 7075 7474  member that putt
+0003cc00: 696e 6720 636c 6173 7320 7765 6967 6874  ing class weight
+0003cc10: 7320 7769 6c6c 2074 6f74 616c 6c79 2064  s will totally d
+0003cc20: 6573 7472 6f79 2070 7265 6469 6374 5f70  estroy predict_p
+0003cc30: 726f 6261 7320 2323 230a 2020 2020 2020  robas ###.      
+0003cc40: 2020 6770 755f 6578 6973 7473 203d 2063    gpu_exists = c
+0003cc50: 6865 636b 5f69 665f 4750 555f 6578 6973  heck_if_GPU_exis
+0003cc60: 7473 2829 0a20 2020 2020 2020 2069 6620  ts().        if 
+0003cc70: 6770 755f 6578 6973 7473 3a0a 2020 2020  gpu_exists:.    
+0003cc80: 2020 2020 2020 2020 6465 7669 6365 3d22          device="
+0003cc90: 6770 7522 0a20 2020 2020 2020 2065 6c73  gpu".        els
+0003cca0: 653a 0a20 2020 2020 2020 2020 2020 2064  e:.            d
+0003ccb0: 6576 6963 653d 2263 7075 220a 2020 2020  evice="cpu".    
+0003ccc0: 2020 2020 726f 775f 6c69 6d69 7420 3d20      row_limit = 
+0003ccd0: 3130 3030 300a 2020 2020 2020 2020 6966  10000.        if
+0003cce0: 2073 656c 662e 696e 7465 6765 7273 5f6f   self.integers_o
+0003ccf0: 6e6c 793a 0a20 2020 2020 2020 2020 2020  nly:.           
+0003cd00: 2073 656c 662e 696e 7465 6765 7273 5f6f   self.integers_o
+0003cd10: 6e6c 795f 6d69 6e5f 6d61 7820 3d20 6765  nly_min_max = ge
+0003cd20: 745f 6d61 785f 6d69 6e5f 6672 6f6d 5f79  t_max_min_from_y
+0003cd30: 2879 290a 2020 2020 2020 2020 2020 2020  (y).            
+0003cd40: 7072 696e 7428 2720 2020 204d 696e 2061  print('    Min a
+0003cd50: 6e64 206d 6178 2076 616c 7565 7320 6f66  nd max values of
+0003cd60: 2079 203d 2025 7327 2025 7365 6c66 2e69   y = %s' %self.i
+0003cd70: 6e74 6567 6572 735f 6f6e 6c79 5f6d 696e  ntegers_only_min
+0003cd80: 5f6d 6178 290a 2020 2020 2020 2020 2323  _max).        ##
+0003cd90: 2323 2323 2323 2323 2323 2323 2323 2020  ##############  
+0003cda0: 2020 2020 2020 2020 5020 4920 5020 4520          P I P E 
+0003cdb0: 4c20 4920 4e20 4520 2020 2020 2020 2023  L I N E        #
+0003cdc0: 2323 2323 2323 2323 2323 2323 2323 2323  ################
+0003cdd0: 2323 2323 2323 2323 230a 2020 2020 2020  #########.      
+0003cde0: 2020 6e75 6d65 7269 635f 7472 616e 7366    numeric_transf
+0003cdf0: 6f72 6d65 7220 3d20 5069 7065 6c69 6e65  ormer = Pipeline
+0003ce00: 280a 2020 2020 2020 2020 2020 2020 7374  (.            st
+0003ce10: 6570 733d 5b28 2269 6d70 7574 6572 222c  eps=[("imputer",
+0003ce20: 2053 696d 706c 6549 6d70 7574 6572 2873   SimpleImputer(s
+0003ce30: 7472 6174 6567 793d 226d 6561 6e22 2c20  trategy="mean", 
+0003ce40: 6164 645f 696e 6469 6361 746f 723d 5472  add_indicator=Tr
+0003ce50: 7565 2929 2c20 2822 7363 616c 6572 222c  ue)), ("scaler",
+0003ce60: 2053 7461 6e64 6172 6453 6361 6c65 7228   StandardScaler(
+0003ce70: 2929 5d29 0a0a 2020 2020 2020 2020 6361  ))])..        ca
+0003ce80: 7465 676f 7269 6361 6c5f 7472 616e 7366  tegorical_transf
+0003ce90: 6f72 6d65 725f 6c6f 7720 3d20 5069 7065  ormer_low = Pipe
+0003cea0: 6c69 6e65 280a 2020 2020 2020 2020 2020  line(.          
+0003ceb0: 2020 7374 6570 733d 5b0a 2020 2020 2020    steps=[.      
+0003cec0: 2020 2020 2020 2020 2020 2822 696d 7075            ("impu
+0003ced0: 7465 7222 2c20 5369 6d70 6c65 496d 7075  ter", SimpleImpu
+0003cee0: 7465 7228 7374 7261 7465 6779 3d22 636f  ter(strategy="co
+0003cef0: 6e73 7461 6e74 222c 2066 696c 6c5f 7661  nstant", fill_va
+0003cf00: 6c75 653d 226d 6973 7369 6e67 222c 2061  lue="missing", a
+0003cf10: 6464 5f69 6e64 6963 6174 6f72 3d54 7275  dd_indicator=Tru
+0003cf20: 6529 292c 0a20 2020 2020 2020 2020 2020  e)),.           
+0003cf30: 2020 2020 2028 2265 6e63 6f64 696e 6722       ("encoding"
+0003cf40: 2c20 4f6e 6548 6f74 456e 636f 6465 7228  , OneHotEncoder(
+0003cf50: 6861 6e64 6c65 5f75 6e6b 6e6f 776e 3d22  handle_unknown="
+0003cf60: 7661 6c75 6522 2929 2c5d 290a 0a20 2020  value")),])..   
+0003cf70: 2020 2020 2063 6174 6567 6f72 6963 616c       categorical
+0003cf80: 5f74 7261 6e73 666f 726d 6572 5f68 6967  _transformer_hig
+0003cf90: 6820 3d20 5069 7065 6c69 6e65 280a 2020  h = Pipeline(.  
+0003cfa0: 2020 2020 2020 2020 2020 7374 6570 733d            steps=
+0003cfb0: 5b0a 2020 2020 2020 2020 2020 2020 2020  [.              
+0003cfc0: 2020 2822 696d 7075 7465 7222 2c20 5369    ("imputer", Si
+0003cfd0: 6d70 6c65 496d 7075 7465 7228 7374 7261  mpleImputer(stra
+0003cfe0: 7465 6779 3d22 636f 6e73 7461 6e74 222c  tegy="constant",
+0003cff0: 2066 696c 6c5f 7661 6c75 653d 226d 6973   fill_value="mis
+0003d000: 7369 6e67 222c 2061 6464 5f69 6e64 6963  sing", add_indic
+0003d010: 6174 6f72 3d54 7275 6529 292c 0a20 2020  ator=True)),.   
+0003d020: 2020 2020 2020 2020 2020 2020 2028 2265               ("e
+0003d030: 6e63 6f64 696e 6722 2c20 4c61 6265 6c45  ncoding", LabelE
+0003d040: 6e63 6f64 6572 2829 292c 5d29 0a0a 2020  ncoder()),])..  
+0003d050: 2020 2020 2020 6e75 6d65 7269 635f 6665        numeric_fe
+0003d060: 6174 7572 6573 203d 2058 2e73 656c 6563  atures = X.selec
+0003d070: 745f 6474 7970 6573 2869 6e63 6c75 6465  t_dtypes(include
+0003d080: 3d27 6e75 6d62 6572 2729 2e63 6f6c 756d  ='number').colum
+0003d090: 6e73 0a20 2020 2020 2020 2063 6174 6567  ns.        categ
+0003d0a0: 6f72 6963 616c 5f66 6561 7475 7265 7320  orical_features 
+0003d0b0: 3d20 582e 7365 6c65 6374 5f64 7479 7065  = X.select_dtype
+0003d0c0: 7328 696e 636c 7564 653d 5b22 6f62 6a65  s(include=["obje
+0003d0d0: 6374 225d 292e 636f 6c75 6d6e 730a 0a20  ct"]).columns.. 
+0003d0e0: 2020 2020 2020 2063 6174 6567 6f72 6963         categoric
+0003d0f0: 616c 5f6c 6f77 2c20 6361 7465 676f 7269  al_low, categori
+0003d100: 6361 6c5f 6869 6768 203d 2067 6574 5f63  cal_high = get_c
+0003d110: 6172 6469 6e61 6c69 7479 2858 2c20 6361  ardinality(X, ca
+0003d120: 7465 676f 7269 6361 6c5f 6665 6174 7572  tegorical_featur
+0003d130: 6573 290a 2020 2020 2020 2020 7072 6570  es).        prep
+0003d140: 726f 6365 7373 6f72 203d 2043 6f6c 756d  rocessor = Colum
+0003d150: 6e54 7261 6e73 666f 726d 6572 280a 2020  nTransformer(.  
+0003d160: 2020 2020 2020 2020 2020 7472 616e 7366            transf
+0003d170: 6f72 6d65 7273 3d5b 0a20 2020 2020 2020  ormers=[.       
+0003d180: 2020 2020 2020 2020 2028 226e 756d 6572           ("numer
+0003d190: 6963 222c 206e 756d 6572 6963 5f74 7261  ic", numeric_tra
+0003d1a0: 6e73 666f 726d 6572 2c20 6e75 6d65 7269  nsformer, numeri
+0003d1b0: 635f 6665 6174 7572 6573 292c 0a20 2020  c_features),.   
+0003d1c0: 2020 2020 2020 2020 2020 2020 2028 2263               ("c
+0003d1d0: 6174 6567 6f72 6963 616c 5f6c 6f77 222c  ategorical_low",
+0003d1e0: 2063 6174 6567 6f72 6963 616c 5f74 7261   categorical_tra
+0003d1f0: 6e73 666f 726d 6572 5f6c 6f77 2c20 6361  nsformer_low, ca
+0003d200: 7465 676f 7269 6361 6c5f 6c6f 7729 2c0a  tegorical_low),.
+0003d210: 2020 2020 2020 2020 2020 2020 2020 2020                  
+0003d220: 2822 6361 7465 676f 7269 6361 6c5f 6869  ("categorical_hi
+0003d230: 6768 222c 2063 6174 6567 6f72 6963 616c  gh", categorical
+0003d240: 5f74 7261 6e73 666f 726d 6572 5f68 6967  _transformer_hig
+0003d250: 682c 2063 6174 6567 6f72 6963 616c 5f68  h, categorical_h
+0003d260: 6967 6829 2c0a 2020 2020 2020 2020 2020  igh),.          
+0003d270: 2020 5d0a 2020 2020 2020 2020 290a 2020    ].        ).  
+0003d280: 2020 2020 2020 2323 2323 2323 2323 2323        ##########
+0003d290: 2323 2323 2323 2323 2323 2323 2323 2323  ################
+0003d2a0: 2323 2323 2323 2323 2323 2323 2323 2323  ################
+0003d2b0: 2323 2323 2323 2323 2323 2323 2323 2323  ################
+0003d2c0: 2323 2323 2323 2323 2323 2323 2323 2323  ################
+0003d2d0: 2323 2323 2323 2323 2323 0a20 2020 2020  ##########.     
+0003d2e0: 2020 2064 6174 615f 7361 6d70 6c65 7320     data_samples 
+0003d2f0: 3d20 582e 7368 6170 655b 305d 0a20 2020  = X.shape[0].   
+0003d300: 2020 2020 2069 6620 7365 6c66 2e6e 5f65       if self.n_e
+0003d310: 7374 696d 6174 6f72 7320 6973 204e 6f6e  stimators is Non
+0003d320: 653a 0a20 2020 2020 2020 2020 2020 2069  e:.            i
+0003d330: 6620 6461 7461 5f73 616d 706c 6573 203c  f data_samples <
+0003d340: 3d20 726f 775f 6c69 6d69 743a 0a20 2020  = row_limit:.   
+0003d350: 2020 2020 2020 2020 2020 2020 2073 656c               sel
+0003d360: 662e 6e5f 6573 7469 6d61 746f 7273 203d  f.n_estimators =
+0003d370: 206d 696e 2835 2c20 696e 7428 312e 352a   min(5, int(1.5*
+0003d380: 6e70 2e6c 6f67 3130 2864 6174 615f 7361  np.log10(data_sa
+0003d390: 6d70 6c65 7329 2929 0a20 2020 2020 2020  mples))).       
+0003d3a0: 2020 2020 2065 6c73 653a 0a20 2020 2020       else:.     
+0003d3b0: 2020 2020 2020 2020 2020 2073 656c 662e             self.
+0003d3c0: 6e5f 6573 7469 6d61 746f 7273 203d 206d  n_estimators = m
+0003d3d0: 696e 2835 2c20 696e 7428 312e 322a 6e70  in(5, int(1.2*np
+0003d3e0: 2e6c 6f67 3130 2864 6174 615f 7361 6d70  .log10(data_samp
+0003d3f0: 6c65 7329 2929 0a20 2020 2020 2020 206e  les))).        n
+0003d400: 756d 5f73 706c 6974 7320 3d20 7365 6c66  um_splits = self
+0003d410: 2e6e 5f65 7374 696d 6174 6f72 730a 2020  .n_estimators.  
+0003d420: 2020 2020 2020 7365 6c66 2e6d 6f64 656c        self.model
+0003d430: 5f6e 616d 6520 3d20 276c 6762 270a 2020  _name = 'lgb'.  
+0003d440: 2020 2020 2020 6e75 6d5f 7265 7065 6174        num_repeat
+0003d450: 7320 3d20 310a 2020 2020 2020 2020 2323  s = 1.        ##
+0003d460: 2323 2323 2323 2323 2323 2323 2323 2323  ################
+0003d470: 2323 2323 2323 2323 2323 2323 2323 2323  ################
+0003d480: 2323 2323 2323 2323 2323 2323 2323 2323  ################
+0003d490: 2323 2323 2323 2323 2323 2323 2323 2323  ################
+0003d4a0: 2323 2323 2323 2323 2323 2323 2323 2323  ################
+0003d4b0: 2323 0a20 2020 2020 2020 2023 2323 2323  ##.        #####
+0003d4c0: 2323 2323 2320 5065 7266 6f72 6d20 5469  ##### Perform Ti
+0003d4d0: 6d65 2053 6572 6965 7320 5370 6c69 7420  me Series Split 
+0003d4e0: 6865 7265 2023 2323 2323 2323 2323 2323  here ###########
+0003d4f0: 2323 2323 2323 2323 2323 2323 2323 2323  ################
+0003d500: 2323 2323 2323 2323 2323 2323 230a 2020  #############.  
+0003d510: 2020 2020 2020 2323 2323 2323 2323 2323        ##########
+0003d520: 2323 2323 2323 2323 2323 2323 2323 2323  ################
+0003d530: 2323 2323 2323 2323 2323 2323 2323 2323  ################
+0003d540: 2323 2323 2323 2323 2323 2323 2323 2323  ################
+0003d550: 2323 2323 2323 2323 2323 2323 2323 2323  ################
+0003d560: 2323 2323 2323 2323 2323 0a20 2020 2020  ##########.     
+0003d570: 2020 2069 6620 7365 6c66 2e74 696d 655f     if self.time_
+0003d580: 7365 7269 6573 3a0a 2020 2020 2020 2020  series:.        
+0003d590: 2020 2020 6966 2069 7369 6e73 7461 6e63      if isinstanc
+0003d5a0: 6528 7365 6c66 2e74 696d 655f 7365 7269  e(self.time_seri
+0003d5b0: 6573 2c20 7374 7229 3a0a 2020 2020 2020  es, str):.      
+0003d5c0: 2020 2020 2020 2020 2020 6966 2073 656c            if sel
+0003d5d0: 662e 7469 6d65 5f73 6572 6965 7320 3d3d  f.time_series ==
+0003d5e0: 2027 736c 6964 696e 6727 3a0a 2020 2020   'sliding':.    
+0003d5f0: 2020 2020 2020 2020 2020 2020 2020 2020                  
+0003d600: 7072 696e 7428 2750 6572 666f 726d 696e  print('Performin
+0003d610: 6720 736c 6964 696e 6720 7769 6e64 6f77  g sliding window
+0003d620: 2074 696d 6520 7365 7269 6573 2073 706c   time series spl
+0003d630: 6974 2e2e 2e27 290a 2020 2020 2020 2020  it...').        
+0003d640: 2020 2020 2020 2020 2020 2020 6b66 6f6c              kfol
+0003d650: 6420 3d20 536c 6964 696e 6754 696d 6553  d = SlidingTimeS
+0003d660: 6572 6965 7353 706c 6974 286e 5f73 706c  eriesSplit(n_spl
+0003d670: 6974 733d 6e75 6d5f 7370 6c69 7473 2c20  its=num_splits, 
+0003d680: 6669 7865 645f 6c65 6e67 7468 3d54 7275  fixed_length=Tru
+0003d690: 652c 2074 7261 696e 5f73 706c 6974 733d  e, train_splits=
+0003d6a0: 322c 2074 6573 745f 7370 6c69 7473 3d31  2, test_splits=1
+0003d6b0: 290a 2020 2020 2020 2020 2020 2020 2020  ).              
+0003d6c0: 2020 656c 7365 3a0a 2020 2020 2020 2020    else:.        
+0003d6d0: 2020 2020 2020 2020 2020 2020 7072 696e              prin
+0003d6e0: 7428 2750 6572 666f 726d 696e 6720 6578  t('Performing ex
+0003d6f0: 7061 6e64 696e 6720 7769 6e64 6f77 2074  panding window t
+0003d700: 696d 6520 7365 7269 6573 2073 706c 6974  ime series split
+0003d710: 2e2e 2e27 290a 2020 2020 2020 2020 2020  ...').          
+0003d720: 2020 2020 2020 2020 2020 6b66 6f6c 6420            kfold 
+0003d730: 3d20 5469 6d65 5365 7269 6573 5370 6c69  = TimeSeriesSpli
+0003d740: 7428 6e5f 7370 6c69 7473 3d6e 756d 5f73  t(n_splits=num_s
+0003d750: 706c 6974 7329 0a20 2020 2020 2020 2020  plits).         
+0003d760: 2020 2065 6c73 653a 0a20 2020 2020 2020     else:.       
+0003d770: 2020 2020 2020 2020 2070 7269 6e74 2827           print('
+0003d780: 5065 7266 6f72 6d69 6e67 2065 7870 616e  Performing expan
+0003d790: 6469 6e67 2077 696e 646f 7720 7469 6d65  ding window time
+0003d7a0: 2073 6572 6965 7320 7370 6c69 742e 2e2e   series split...
+0003d7b0: 2729 0a20 2020 2020 2020 2020 2020 2020  ').             
+0003d7c0: 2020 206b 666f 6c64 203d 2054 696d 6553     kfold = TimeS
+0003d7d0: 6572 6965 7353 706c 6974 286e 5f73 706c  eriesSplit(n_spl
+0003d7e0: 6974 733d 6e75 6d5f 7370 6c69 7473 290a  its=num_splits).
+0003d7f0: 2020 2020 2020 2020 656c 7365 3a0a 2020          else:.  
+0003d800: 2020 2020 2020 2020 2020 7072 696e 7428            print(
+0003d810: 2750 6572 666f 726d 696e 6720 4b46 6f6c  'Performing KFol
+0003d820: 6420 7265 6775 6c61 7220 7370 6c69 742e  d regular split.
+0003d830: 2e2e 2729 0a20 2020 2020 2020 2020 2020  ..').           
+0003d840: 206b 666f 6c64 203d 2052 6570 6561 7465   kfold = Repeate
+0003d850: 644b 466f 6c64 286e 5f73 706c 6974 733d  dKFold(n_splits=
+0003d860: 6e75 6d5f 7370 6c69 7473 2c20 7261 6e64  num_splits, rand
+0003d870: 6f6d 5f73 7461 7465 3d73 6565 642c 206e  om_state=seed, n
+0003d880: 5f72 6570 6561 7473 3d6e 756d 5f72 6570  _repeats=num_rep
+0003d890: 6561 7473 290a 2020 2020 2020 2020 2323  eats).        ##
+0003d8a0: 2323 2323 2323 2323 2323 2323 2323 2323  ################
+0003d8b0: 2323 2323 2323 2323 2323 2323 2323 2323  ################
+0003d8c0: 2323 2323 2323 2323 2323 2323 2323 2323  ################
+0003d8d0: 2323 2323 2323 2323 2323 2323 2323 2323  ################
+0003d8e0: 2323 2323 2323 2323 2323 2323 2323 2323  ################
+0003d8f0: 2323 0a20 2020 2020 2020 206e 756d 5f69  ##.        num_i
+0003d900: 7465 7261 7469 6f6e 7320 3d20 696e 7428  terations = int(
+0003d910: 6e75 6d5f 7370 6c69 7473 202a 206e 756d  num_splits * num
+0003d920: 5f72 6570 6561 7473 290a 2020 2020 2020  _repeats).      
+0003d930: 2020 7363 6f72 696e 6720 3d20 276e 6567    scoring = 'neg
+0003d940: 5f6d 6561 6e5f 7371 7561 7265 645f 6572  _mean_squared_er
+0003d950: 726f 7227 0a20 2020 2020 2020 2070 7269  ror'.        pri
+0003d960: 6e74 2827 2020 2020 4e75 6d2e 2065 7374  nt('    Num. est
+0003d970: 696d 6174 6f72 7320 3d20 2573 2028 7769  imators = %s (wi
+0003d980: 6c6c 2062 6520 6c61 7267 6572 2074 6861  ll be larger tha
+0003d990: 6e20 6e5f 6573 7469 6d61 746f 7273 2073  n n_estimators s
+0003d9a0: 696e 6365 206b 666f 6c64 2069 7320 7265  ince kfold is re
+0003d9b0: 7065 6174 6564 2074 7769 6365 2927 2025  peated twice)' %
+0003d9c0: 6e75 6d5f 6974 6572 6174 696f 6e73 290a  num_iterations).
+0003d9d0: 2020 2020 2020 2020 2323 2323 2320 5468          ##### Th
+0003d9e0: 6973 2069 7320 7768 6572 6520 7765 2063  is is where we c
+0003d9f0: 6865 636b 2069 6620 7920 6973 2073 696e  heck if y is sin
+0003da00: 676c 6520 6c61 6265 6c20 6f72 206d 756c  gle label or mul
+0003da10: 7469 2d6c 6162 656c 2023 230a 2020 2020  ti-label ##.    
+0003da20: 2020 2020 6966 2069 7369 6e73 7461 6e63      if isinstanc
+0003da30: 6528 792c 2070 642e 4461 7461 4672 616d  e(y, pd.DataFram
+0003da40: 6529 3a0a 2020 2020 2020 2020 2020 2020  e):.            
+0003da50: 6966 2073 656c 662e 6c6f 675f 7472 616e  if self.log_tran
+0003da60: 7366 6f72 6d3a 0a20 2020 2020 2020 2020  sform:.         
+0003da70: 2020 2020 2020 2069 6620 7365 6c66 2e76         if self.v
+0003da80: 6572 626f 7365 3a0a 2020 2020 2020 2020  erbose:.        
+0003da90: 2020 2020 2020 2020 2020 2020 7072 696e              prin
+0003daa0: 7428 2720 2020 206c 6f67 2074 7261 6e73  t('    log trans
+0003dab0: 666f 726d 696e 6720 7461 7267 6574 2076  forming target v
+0003dac0: 6172 6961 626c 653a 2065 6e73 7572 6520  ariable: ensure 
+0003dad0: 6e6f 207a 6572 6f73 2069 6e20 7461 7267  no zeros in targ
+0003dae0: 6574 2e20 4f74 6865 7277 6973 6520 6572  et. Otherwise er
+0003daf0: 726f 722e 2729 0a20 2020 2020 2020 2020  ror.').         
+0003db00: 2020 2020 2020 2074 7279 3a0a 2020 2020         try:.    
+0003db10: 2020 2020 2020 2020 2020 2020 2020 2020                  
+0003db20: 7920 3d20 6e70 2e6c 6f67 3170 2879 290a  y = np.log1p(y).
+0003db30: 2020 2020 2020 2020 2020 2020 2020 2020                  
+0003db40: 6578 6365 7074 3a0a 2020 2020 2020 2020  except:.        
+0003db50: 2020 2020 2020 2020 2020 2020 7072 696e              prin
+0003db60: 7428 2720 2020 2045 7272 6f72 3a20 6c6f  t('    Error: lo
+0003db70: 6720 7472 616e 7366 6f72 6d69 6e67 2074  g transforming t
+0003db80: 6172 6765 7473 2e20 5265 6d6f 7665 207a  argets. Remove z
+0003db90: 6572 6f73 2069 6e20 7461 7267 6574 2061  eros in target a
+0003dba0: 6e64 2074 7279 2061 6761 696e 2e27 290a  nd try again.').
+0003dbb0: 2020 2020 2020 2020 2020 2020 2020 2020                  
+0003dbc0: 2020 2020 7265 7475 726e 2073 656c 660a      return self.
+0003dbd0: 2020 2020 2020 2020 2020 2020 2323 2323              ####
+0003dbe0: 2323 2323 2323 2323 2323 2323 2323 2323  ################
+0003dbf0: 2323 2323 2323 2323 2323 2323 2323 2323  ################
+0003dc00: 2323 2323 2323 2323 2323 2323 2323 2323  ################
+0003dc10: 2323 2323 2323 2323 2323 230a 2020 2020  ###########.    
+0003dc20: 2020 2020 2020 2020 2323 2320 5468 6973          ### This
+0003dc30: 2069 7320 666f 7220 4d75 6c74 692d 4c61   is for Multi-La
+0003dc40: 6265 6c20 5265 6772 6573 7369 6f6e 2070  bel Regression p
+0003dc50: 726f 626c 656d 7320 6f6e 6c79 2023 2323  roblems only ###
+0003dc60: 2323 2323 2323 2323 2323 2323 2323 2323  ################
+0003dc70: 2323 0a20 2020 2020 2020 2020 2020 2023  ##.            #
+0003dc80: 2323 2323 2323 2323 2323 2323 2323 2323  ################
+0003dc90: 2323 2323 2323 2323 2323 2323 2323 2323  ################
+0003dca0: 2323 2323 2323 2323 2323 2323 2323 2323  ################
+0003dcb0: 2323 2323 2323 2323 2323 2323 2323 0a20  ##############. 
+0003dcc0: 2020 2020 2020 2020 2020 2074 6172 6765             targe
+0003dcd0: 7473 203d 2079 2e63 6f6c 756d 6e73 2e74  ts = y.columns.t
+0003dce0: 6f6c 6973 7428 290a 2020 2020 2020 2020  olist().        
+0003dcf0: 2020 2020 6966 2069 735f 795f 6f62 6a65      if is_y_obje
+0003dd00: 6374 2879 293a 0a20 2020 2020 2020 2020  ct(y):.         
+0003dd10: 2020 2020 2020 2070 7269 6e74 2827 4361         print('Ca
+0003dd20: 6e6e 6f74 2070 6572 666f 726d 2052 6567  nnot perform Reg
+0003dd30: 7265 7373 696f 6e20 7573 696e 6720 6f62  ression using ob
+0003dd40: 6a65 6374 206f 7220 7374 7269 6e67 2074  ject or string t
+0003dd50: 6172 6765 7473 2e20 506c 6561 7365 2063  argets. Please c
+0003dd60: 6f6e 7665 7274 2074 6f20 6e75 6d65 7269  onvert to numeri
+0003dd70: 6320 616e 6420 7472 7920 6167 6169 6e2e  c and try again.
+0003dd80: 2729 0a20 2020 2020 2020 2020 2020 2020  ').             
+0003dd90: 2020 2072 6574 7572 6e20 7365 6c66 0a20     return self. 
+0003dda0: 2020 2020 2020 2020 2020 2069 6620 6c65             if le
+0003ddb0: 6e28 7461 7267 6574 7329 203e 2031 3a0a  n(targets) > 1:.
+0003ddc0: 2020 2020 2020 2020 2020 2020 2020 2020                  
+0003ddd0: 7365 6c66 2e6d 756c 7469 5f6c 6162 656c  self.multi_label
+0003dde0: 203d 2079 2e63 6f6c 756d 6e73 2e74 6f6c   = y.columns.tol
+0003ddf0: 6973 7428 290a 2020 2020 2020 2020 2020  ist().          
+0003de00: 2020 2020 2020 2323 2320 596f 7520 6e65        ### You ne
+0003de10: 6564 2074 6f20 696e 6974 6961 6c69 7a65  ed to initialize
+0003de20: 2074 6865 2063 6c61 7373 2062 6566 6f72   the class befor
+0003de30: 6520 6561 6368 2072 756e 202d 206f 7468  e each run - oth
+0003de40: 6572 7769 7365 2c20 6572 726f 7221 0a20  erwise, error!. 
+0003de50: 2020 2020 2020 2020 2020 2020 2020 2023                 #
+0003de60: 2323 2052 656d 656d 6265 7220 7765 2064  ## Remember we d
+0003de70: 6f6e 2774 2074 6f20 4850 5420 5475 6e69  on't to HPT Tuni
+0003de80: 6e67 2066 6f72 204d 756c 7469 2d6c 6162  ng for Multi-lab
+0003de90: 656c 2070 726f 626c 656d 7320 7369 6e63  el problems sinc
+0003dea0: 6520 6974 2065 7272 6f72 7320 2323 2323  e it errors ####
+0003deb0: 0a20 2020 2020 2020 2020 2020 2020 2020  .               
+0003dec0: 2069 203d 2030 0a20 2020 2020 2020 2020   i = 0.         
+0003ded0: 2020 2020 2020 2066 6f72 2074 7261 696e         for train
+0003dee0: 5f69 6e64 6578 2c20 7465 7374 5f69 6e64  _index, test_ind
+0003def0: 6578 2069 6e20 7471 646d 286b 666f 6c64  ex in tqdm(kfold
+0003df00: 2e73 706c 6974 2858 2c20 7929 2c20 746f  .split(X, y), to
+0003df10: 7461 6c3d 6b66 6f6c 642e 6765 745f 6e5f  tal=kfold.get_n_
+0003df20: 7370 6c69 7473 2829 2c20 0a20 2020 2020  splits(), .     
+0003df30: 2020 2020 2020 2020 2020 2020 2020 2020                  
+0003df40: 2020 2020 2020 2020 2020 2020 2020 2020                  
+0003df50: 2020 2064 6573 633d 226b 2d66 6f6c 6420     desc="k-fold 
+0003df60: 7472 6169 6e69 6e67 2229 3a0a 2020 2020  training"):.    
+0003df70: 2020 2020 2020 2020 2020 2020 2020 2020                  
+0003df80: 7374 6172 745f 7469 6d65 203d 2074 696d  start_time = tim
+0003df90: 652e 7469 6d65 2829 0a20 2020 2020 2020  e.time().       
+0003dfa0: 2020 2020 2020 2020 2020 2020 2023 7261               #ra
+0003dfb0: 6e64 6f6d 5f73 6565 6420 3d20 6e70 2e72  ndom_seed = np.r
+0003dfc0: 616e 646f 6d2e 7261 6e64 696e 7428 322c  andom.randint(2,
+0003dfd0: 3130 3029 0a20 2020 2020 2020 2020 2020  100).           
+0003dfe0: 2020 2020 2020 2020 2072 616e 646f 6d5f           random_
+0003dff0: 7365 6564 203d 2039 3939 0a20 2020 2020  seed = 999.     
+0003e000: 2020 2020 2020 2020 2020 2020 2020 2069                 i
+0003e010: 6620 7365 6c66 2e62 6173 655f 6573 7469  f self.base_esti
+0003e020: 6d61 746f 7220 6973 204e 6f6e 653a 0a20  mator is None:. 
+0003e030: 2020 2020 2020 2020 2020 2020 2020 2020                  
+0003e040: 2020 2020 2020 2023 2323 2323 2323 2323         #########
+0003e050: 2323 2323 2323 2323 2323 2323 2323 2323  ################
+0003e060: 2323 2323 2323 2323 2323 2323 2323 2323  ################
+0003e070: 2323 2323 2323 2323 2323 2323 2323 2323  ################
+0003e080: 2323 2323 2323 230a 2020 2020 2020 2020  #######.        
+0003e090: 2020 2020 2020 2020 2020 2020 2020 2020                  
+0003e0a0: 2323 2320 2020 5468 6973 2069 7320 666f  ###   This is fo
+0003e0b0: 7220 5369 6e67 6c65 204c 6162 656c 2052  r Single Label R
+0003e0c0: 6567 7265 7373 696f 6e20 7072 6f62 6c65  egression proble
+0003e0d0: 6d73 206f 6e6c 7920 2323 2323 2323 2323  ms only ########
+0003e0e0: 0a20 2020 2020 2020 2020 2020 2020 2020  .               
+0003e0f0: 2020 2020 2020 2020 2023 2323 2020 204d           ###   M
+0003e100: 616b 6520 7375 7265 2079 6f75 2064 6f6e  ake sure you don
+0003e110: 2774 2064 6f20 696d 6261 6c61 6e63 6564  't do imbalanced
+0003e120: 2053 4d4f 5445 2077 6f72 6b20 6865 7265   SMOTE work here
+0003e130: 2020 2323 2323 2323 230a 2020 2020 2020    #######.      
+0003e140: 2020 2020 2020 2020 2020 2020 2020 2020                  
+0003e150: 2020 2323 2323 2323 2323 2323 2323 2323    ##############
+0003e160: 2323 2323 2323 2323 2323 2323 2323 2323  ################
+0003e170: 2323 2323 2323 2323 2323 2323 2323 2323  ################
+0003e180: 2323 2323 2323 2323 2323 2323 2323 2323  ################
+0003e190: 2323 0a20 2020 2020 2020 2020 2020 2020  ##.             
+0003e1a0: 2020 2020 2020 2020 2020 2069 6620 792e             if y.
+0003e1b0: 7368 6170 655b 305d 203c 3d20 726f 775f  shape[0] <= row_
+0003e1c0: 6c69 6d69 743a 0a20 2020 2020 2020 2020  limit:.         
+0003e1d0: 2020 2020 2020 2020 2020 2020 2020 2020                  
+0003e1e0: 2020 2069 6620 7365 6c66 2e69 6e74 6567     if self.integ
+0003e1f0: 6572 735f 6f6e 6c79 3a0a 2020 2020 2020  ers_only:.      
+0003e200: 2020 2020 2020 2020 2020 2020 2020 2020                  
+0003e210: 2020 2020 2020 2020 2020 6966 2028 582e            if (X.
+0003e220: 6474 7970 6573 3d3d 666c 6f61 7429 2e61  dtypes==float).a
+0003e230: 6c6c 2829 2061 6e64 206c 656e 2873 656c  ll() and len(sel
+0003e240: 662e 6665 6174 7572 6573 2920 3c3d 2066  f.features) <= f
+0003e250: 6561 7475 7265 735f 6c69 6d69 743a 0a20  eatures_limit:. 
+0003e260: 2020 2020 2020 2020 2020 2020 2020 2020                  
+0003e270: 2020 2020 2020 2020 2020 2020 2020 2020                  
+0003e280: 2020 2070 7269 6e74 2827 2020 2020 5365     print('    Se
+0003e290: 6c65 6374 696e 6720 5269 6467 6520 6173  lecting Ridge as
+0003e2a0: 2062 6173 655f 6573 7469 6d61 746f 722e   base_estimator.
+0003e2b0: 2046 6565 6c20 6672 6565 2074 6f20 7365   Feel free to se
+0003e2c0: 6e64 2069 6e20 796f 7572 206f 776e 2065  nd in your own e
+0003e2d0: 7374 696d 6174 6f72 2e27 290a 2020 2020  stimator.').    
+0003e2e0: 2020 2020 2020 2020 2020 2020 2020 2020                  
+0003e2f0: 2020 2020 2020 2020 2020 2020 2020 2020                  
+0003e300: 7365 6c66 2e62 6173 655f 6573 7469 6d61  self.base_estima
+0003e310: 746f 7220 3d20 5269 6467 6528 6e6f 726d  tor = Ridge(norm
+0003e320: 616c 697a 653d 4661 6c73 6529 0a20 2020  alize=False).   
+0003e330: 2020 2020 2020 2020 2020 2020 2020 2020                  
+0003e340: 2020 2020 2020 2020 2020 2020 2020 2020                  
+0003e350: 2073 656c 662e 6d6f 6465 6c5f 6e61 6d65   self.model_name
+0003e360: 203d 2027 6f74 6865 7227 0a20 2020 2020   = 'other'.     
+0003e370: 2020 2020 2020 2020 2020 2020 2020 2020                  
+0003e380: 2020 2020 2020 2020 2020 2065 6c73 653a             else:
+0003e390: 0a20 2020 2020 2020 2020 2020 2020 2020  .               
+0003e3a0: 2020 2020 2020 2020 2020 2020 2020 2020                  
+0003e3b0: 2020 2020 2069 6620 7365 6c66 2e76 6572       if self.ver
+0003e3c0: 626f 7365 3a0a 2020 2020 2020 2020 2020  bose:.          
+0003e3d0: 2020 2020 2020 2020 2020 2020 2020 2020                  
+0003e3e0: 2020 2020 2020 2020 2020 2020 2020 7072                pr
+0003e3f0: 696e 7428 2720 2020 2053 656c 6563 7469  int('    Selecti
+0003e400: 6e67 204c 4742 4d20 5265 6772 6573 736f  ng LGBM Regresso
+0003e410: 7220 6173 2062 6173 6520 6573 7469 6d61  r as base estima
+0003e420: 746f 722e 2e2e 2729 0a20 2020 2020 2020  tor...').       
+0003e430: 2020 2020 2020 2020 2020 2020 2020 2020                  
+0003e440: 2020 2020 2020 2020 2020 2020 2073 656c               sel
+0003e450: 662e 6261 7365 5f65 7374 696d 6174 6f72  f.base_estimator
+0003e460: 203d 204c 4742 4d52 6567 7265 7373 6f72   = LGBMRegressor
+0003e470: 286e 5f6a 6f62 733d 2d31 2c20 6465 7669  (n_jobs=-1, devi
+0003e480: 6365 3d64 6576 6963 652c 2072 616e 646f  ce=device, rando
+0003e490: 6d5f 7374 6174 653d 7261 6e64 6f6d 5f73  m_state=random_s
+0003e4a0: 6565 6429 2020 2020 2020 2020 2020 2020  eed)            
+0003e4b0: 2020 2020 2020 2020 2020 2020 2020 2020                  
+0003e4c0: 2020 2020 2020 2020 0a20 2020 2020 2020          .       
+0003e4d0: 2020 2020 2020 2020 2020 2020 2020 2020                  
+0003e4e0: 2020 2020 2065 6c73 653a 0a20 2020 2020       else:.     
+0003e4f0: 2020 2020 2020 2020 2020 2020 2020 2020                  
+0003e500: 2020 2020 2020 2020 2020 2069 6620 6c65             if le
+0003e510: 6e28 7365 6c66 2e66 6561 7475 7265 7329  n(self.features)
+0003e520: 203c 3d20 6665 6174 7572 6573 5f6c 696d   <= features_lim
+0003e530: 6974 3a0a 2020 2020 2020 2020 2020 2020  it:.            
+0003e540: 2020 2020 2020 2020 2020 2020 2020 2020                  
+0003e550: 2020 2020 2020 2020 6966 2073 656c 662e          if self.
+0003e560: 7665 7262 6f73 653a 0a20 2020 2020 2020  verbose:.       
+0003e570: 2020 2020 2020 2020 2020 2020 2020 2020                  
+0003e580: 2020 2020 2020 2020 2020 2020 2020 2020                  
+0003e590: 2070 7269 6e74 2827 2020 2020 5365 6c65   print('    Sele
+0003e5a0: 6374 696e 6720 4261 6767 696e 6720 5265  cting Bagging Re
+0003e5b0: 6772 6573 736f 7220 7369 6e63 6520 696e  gressor since in
+0003e5c0: 7465 6765 7273 5f6f 6e6c 7920 666c 6167  tegers_only flag
+0003e5d0: 2069 7320 7365 742e 2e2e 2729 0a20 2020   is set...').   
+0003e5e0: 2020 2020 2020 2020 2020 2020 2020 2020                  
+0003e5f0: 2020 2020 2020 2020 2020 2020 2020 2020                  
+0003e600: 2045 5420 3d20 4578 7472 6154 7265 6552   ET = ExtraTreeR
+0003e610: 6567 7265 7373 6f72 2829 0a20 2020 2020  egressor().     
+0003e620: 2020 2020 2020 2020 2020 2020 2020 2020                  
+0003e630: 2020 2020 2020 2020 2020 2020 2020 2045                 E
+0003e640: 5420 3d20 4c69 6e65 6172 5356 5228 290a  T = LinearSVR().
+0003e650: 2020 2020 2020 2020 2020 2020 2020 2020                  
+0003e660: 2020 2020 2020 2020 2020 2020 2020 2020                  
+0003e670: 2020 2020 4554 203d 2044 6563 6973 696f      ET = Decisio
+0003e680: 6e54 7265 6552 6567 7265 7373 6f72 2829  nTreeRegressor()
+0003e690: 0a20 2020 2020 2020 2020 2020 2020 2020  .               
+0003e6a0: 2020 2020 2020 2020 2020 2020 2020 2020                  
+0003e6b0: 2020 2020 2073 656c 662e 6261 7365 5f65       self.base_e
+0003e6c0: 7374 696d 6174 6f72 203d 2042 6167 6769  stimator = Baggi
+0003e6d0: 6e67 5265 6772 6573 736f 7228 6261 7365  ngRegressor(base
+0003e6e0: 5f65 7374 696d 6174 6f72 203d 2045 542c  _estimator = ET,
+0003e6f0: 2062 6f6f 7473 7472 6170 5f66 6561 7475   bootstrap_featu
+0003e700: 7265 733d 4661 6c73 652c 0a20 2020 2020  res=False,.     
+0003e710: 2020 2020 2020 2020 2020 2020 2020 2020                  
+0003e720: 2020 2020 2020 2020 2020 2020 2020 2020                  
+0003e730: 2020 2020 2020 2020 2020 2020 2020 2020                  
+0003e740: 2020 2020 2020 206e 5f6a 6f62 733d 2d31         n_jobs=-1
+0003e750: 2c20 7261 6e64 6f6d 5f73 7461 7465 3d72  , random_state=r
+0003e760: 616e 646f 6d5f 7365 6564 290a 2020 2020  andom_seed).    
+0003e770: 2020 2020 2020 2020 2020 2020 2020 2020                  
+0003e780: 2020 2020 2020 2020 2020 2020 2020 2020                  
+0003e790: 7365 6c66 2e6d 6f64 656c 5f6e 616d 6520  self.model_name 
+0003e7a0: 3d20 2762 6727 0a20 2020 2020 2020 2020  = 'bg'.         
+0003e7b0: 2020 2020 2020 2020 2020 2020 2020 2020                  
+0003e7c0: 2020 2020 2020 2065 6c73 653a 0a20 2020         else:.   
+0003e7d0: 2020 2020 2020 2020 2020 2020 2020 2020                  
+0003e7e0: 2020 2020 2020 2020 2020 2020 2020 2020                  
+0003e7f0: 2069 6620 6770 755f 6578 6973 7473 3a0a   if gpu_exists:.
+0003e800: 2020 2020 2020 2020 2020 2020 2020 2020                  
+0003e810: 2020 2020 2020 2020 2020 2020 2020 2020                  
+0003e820: 2020 2020 2020 2020 6966 2073 656c 662e          if self.
+0003e830: 7665 7262 6f73 653a 0a20 2020 2020 2020  verbose:.       
+0003e840: 2020 2020 2020 2020 2020 2020 2020 2020                  
+0003e850: 2020 2020 2020 2020 2020 2020 2020 2020                  
+0003e860: 2020 2020 2070 7269 6e74 2827 2020 2020       print('    
+0003e870: 5365 6c65 6374 696e 6720 5847 4252 6567  Selecting XGBReg
+0003e880: 7265 7373 6f72 2077 6974 6820 4750 5520  ressor with GPU 
+0003e890: 6173 2062 6173 6520 6573 7469 6d61 746f  as base estimato
+0003e8a0: 722e 2e2e 2729 0a20 2020 2020 2020 2020  r...').         
+0003e8b0: 2020 2020 2020 2020 2020 2020 2020 2020                  
+0003e8c0: 2020 2020 2020 2020 2020 2020 2020 2073                 s
+0003e8d0: 656c 662e 6261 7365 5f65 7374 696d 6174  elf.base_estimat
+0003e8e0: 6f72 203d 2058 4742 5265 6772 6573 736f  or = XGBRegresso
+0003e8f0: 7228 200a 2020 2020 2020 2020 2020 2020  r( .            
+0003e900: 2020 2020 2020 2020 2020 2020 2020 2020                  
 0003e910: 2020 2020 2020 2020 2020 2020 2020 2020                  
-0003e920: 2020 7072 696e 7428 2752 4f43 2041 5543    print('ROC AUC
-0003e930: 203d 2025 302e 3266 2720 2572 6f63 5f61   = %0.2f' %roc_a
-0003e940: 7563 5f73 636f 7265 2879 5f74 6573 742c  uc_score(y_test,
-0003e950: 2079 5f70 726f 6261 732c 206d 756c 7469   y_probas, multi
-0003e960: 5f63 6c61 7373 3d22 6f76 7222 2929 0a20  _class="ovr")). 
-0003e970: 2020 2020 2020 2020 2020 2020 2020 2065                 e
-0003e980: 6c73 653a 0a20 2020 2020 2020 2020 2020  lse:.           
-0003e990: 2020 2020 2020 2020 2070 7269 6e74 2827           print('
-0003e9a0: 524f 4320 4155 4320 3d20 2530 2e32 6627  ROC AUC = %0.2f'
-0003e9b0: 2025 726f 635f 6175 635f 7363 6f72 6528   %roc_auc_score(
-0003e9c0: 795f 7465 7374 2c20 795f 7072 6f62 6173  y_test, y_probas
-0003e9d0: 5b3a 2c31 5d29 290a 2020 2020 2020 2020  [:,1])).        
-0003e9e0: 2020 2020 6966 2076 6572 626f 7365 3a0a      if verbose:.
-0003e9f0: 2020 2020 2020 2020 2020 2020 2020 2020                  
-0003ea00: 7072 696e 7428 636c 6173 7369 6669 6361  print(classifica
-0003ea10: 7469 6f6e 5f72 6570 6f72 7428 795f 7465  tion_report(y_te
-0003ea20: 7374 2c79 5f70 7265 6473 2929 0a20 2020  st,y_preds)).   
-0003ea30: 2020 2020 2065 6c73 653a 0a20 2020 2020       else:.     
-0003ea40: 2020 2020 2020 2069 6620 6973 696e 7374         if isinst
-0003ea50: 616e 6365 2879 5f70 726f 6261 732c 2073  ance(y_probas, s
-0003ea60: 7472 293a 0a20 2020 2020 2020 2020 2020  tr):.           
-0003ea70: 2020 2020 2023 2323 2054 6869 7320 6973       ### This is
-0003ea80: 2066 6f72 206d 756c 7469 2d6c 6162 656c   for multi-label
-0003ea90: 2070 726f 626c 656d 7320 7769 7468 6f75   problems withou
-0003eaa0: 7420 7072 6f62 6173 2023 2323 230a 2020  t probas ####.  
-0003eab0: 2020 2020 2020 2020 2020 2020 2020 666f                fo
-0003eac0: 7220 6561 6368 5f69 2069 6e20 7261 6e67  r each_i in rang
-0003ead0: 6528 795f 7465 7374 2e73 6861 7065 5b31  e(y_test.shape[1
-0003eae0: 5d29 3a0a 2020 2020 2020 2020 2020 2020  ]):.            
-0003eaf0: 2020 2020 2020 2020 6261 6c5f 7363 6f72          bal_scor
-0003eb00: 6520 3d20 6261 6c61 6e63 6564 5f61 6363  e = balanced_acc
-0003eb10: 7572 6163 795f 7363 6f72 6528 795f 7465  uracy_score(y_te
-0003eb20: 7374 2e76 616c 7565 735b 3a2c 6561 6368  st.values[:,each
-0003eb30: 5f69 5d2c 795f 7072 6564 735b 3a2c 6561  _i],y_preds[:,ea
-0003eb40: 6368 5f69 5d29 0a20 2020 2020 2020 2020  ch_i]).         
-0003eb50: 2020 2020 2020 2020 2020 2062 616c 5f73             bal_s
-0003eb60: 636f 7265 732e 6170 7065 6e64 2862 616c  cores.append(bal
-0003eb70: 5f73 636f 7265 290a 2020 2020 2020 2020  _score).        
-0003eb80: 2020 2020 2020 2020 2020 2020 7072 696e              prin
-0003eb90: 7428 2720 2020 2042 616c 2061 6363 7520  t('    Bal accu 
-0003eba0: 2530 2e30 6625 2527 2025 2831 3030 2a62  %0.0f%%' %(100*b
-0003ebb0: 616c 5f73 636f 7265 2929 0a20 2020 2020  al_score)).     
-0003ebc0: 2020 2020 2020 2020 2020 2020 2020 2069                 i
-0003ebd0: 6620 7665 7262 6f73 653a 0a20 2020 2020  f verbose:.     
-0003ebe0: 2020 2020 2020 2020 2020 2020 2020 2020                  
-0003ebf0: 2020 2070 7269 6e74 2863 6c61 7373 6966     print(classif
-0003ec00: 6963 6174 696f 6e5f 7265 706f 7274 2879  ication_report(y
-0003ec10: 5f74 6573 742e 7661 6c75 6573 5b3a 2c65  _test.values[:,e
-0003ec20: 6163 685f 695d 2c79 5f70 7265 6473 5b3a  ach_i],y_preds[:
-0003ec30: 2c65 6163 685f 695d 2929 0a20 2020 2020  ,each_i])).     
-0003ec40: 2020 2020 2020 2065 6c73 653a 0a20 2020         else:.   
-0003ec50: 2020 2020 2020 2020 2020 2020 2023 2323               ###
-0003ec60: 2323 2054 6869 7320 6973 206f 6e6c 7920  ## This is only 
-0003ec70: 666f 7220 6d75 6c74 695f 6c61 6265 6c5f  for multi_label_
-0003ec80: 6d75 6c74 695f 636c 6173 7320 7072 6f62  multi_class prob
-0003ec90: 6c65 6d73 0a20 2020 2020 2020 2020 2020  lems.           
-0003eca0: 2020 2020 206e 756d 5f74 6172 6765 7473       num_targets
-0003ecb0: 203d 2079 5f74 6573 742e 7368 6170 655b   = y_test.shape[
-0003ecc0: 315d 0a20 2020 2020 2020 2020 2020 2020  1].             
-0003ecd0: 2020 2066 6f72 2065 6163 685f 6920 696e     for each_i in
-0003ece0: 2072 616e 6765 286e 756d 5f74 6172 6765   range(num_targe
-0003ecf0: 7473 293a 0a20 2020 2020 2020 2020 2020  ts):.           
-0003ed00: 2020 2020 2020 2020 2070 7269 6e74 2827           print('
-0003ed10: 2020 2020 4261 6c20 6163 6375 2025 302e      Bal accu %0.
-0003ed20: 3066 2525 2720 2528 3130 302a 6261 6c61  0f%%' %(100*bala
-0003ed30: 6e63 6564 5f61 6363 7572 6163 795f 7363  nced_accuracy_sc
-0003ed40: 6f72 6528 795f 7465 7374 2e76 616c 7565  ore(y_test.value
-0003ed50: 735b 3a2c 6561 6368 5f69 5d2c 795f 7072  s[:,each_i],y_pr
-0003ed60: 6564 735b 3a2c 6561 6368 5f69 5d29 2929  eds[:,each_i])))
-0003ed70: 0a20 2020 2020 2020 2020 2020 2020 2020  .               
-0003ed80: 2020 2020 2069 6620 6c65 6e28 6e70 2e75       if len(np.u
-0003ed90: 6e69 7175 6528 795f 7465 7374 2e76 616c  nique(y_test.val
-0003eda0: 7565 735b 3a2c 6561 6368 5f69 5d29 2920  ues[:,each_i])) 
-0003edb0: 3e20 323a 0a20 2020 2020 2020 2020 2020  > 2:.           
-0003edc0: 2020 2020 2020 2020 2020 2020 2023 2323               ###
-0003edd0: 2054 6869 7320 6e61 6e20 7072 6f62 6c65   This nan proble
-0003ede0: 6d20 6861 7070 656e 7320 6475 6520 746f  m happens due to
-0003edf0: 204c 6162 656c 2050 726f 7061 6761 7469   Label Propagati
-0003ee00: 6f6e 2062 7574 2063 616e 2062 6520 6669  on but can be fi
-0003ee10: 7865 6420 6173 2066 6f6c 6c6f 7773 2023  xed as follows #
-0003ee20: 230a 2020 2020 2020 2020 2020 2020 2020  #.              
-0003ee30: 2020 2020 2020 2020 2020 6d61 7420 3d20            mat = 
-0003ee40: 795f 7072 6f62 6173 5b65 6163 685f 695d  y_probas[each_i]
-0003ee50: 0a20 2020 2020 2020 2020 2020 2020 2020  .               
-0003ee60: 2020 2020 2020 2020 2069 6620 6e70 2e61           if np.a
-0003ee70: 6e79 286e 702e 6973 6e61 6e28 6d61 7429  ny(np.isnan(mat)
-0003ee80: 293a 0a20 2020 2020 2020 2020 2020 2020  ):.             
-0003ee90: 2020 2020 2020 2020 2020 2020 2020 206d                 m
-0003eea0: 6174 203d 2070 642e 4461 7461 4672 616d  at = pd.DataFram
-0003eeb0: 6528 6d61 7429 2e66 696c 6c6e 6128 6d65  e(mat).fillna(me
-0003eec0: 7468 6f64 3d27 6666 696c 6c27 292e 7661  thod='ffill').va
-0003eed0: 6c75 6573 0a20 2020 2020 2020 2020 2020  lues.           
+0003e920: 6e5f 6a6f 6273 3d2d 312c 7472 6565 5f6d  n_jobs=-1,tree_m
+0003e930: 6574 686f 6420 3d20 2767 7075 5f68 6973  ethod = 'gpu_his
+0003e940: 7427 2c67 7075 5f69 643d 302c 2070 7265  t',gpu_id=0, pre
+0003e950: 6469 6374 6f72 3d22 6770 755f 7072 6564  dictor="gpu_pred
+0003e960: 6963 746f 7222 290a 2020 2020 2020 2020  ictor").        
+0003e970: 2020 2020 2020 2020 2020 2020 2020 2020                  
+0003e980: 2020 2020 2020 2020 2020 2020 656c 7365              else
+0003e990: 3a0a 2020 2020 2020 2020 2020 2020 2020  :.              
+0003e9a0: 2020 2020 2020 2020 2020 2020 2020 2020                  
+0003e9b0: 2020 2020 2020 2020 2020 6966 2073 656c            if sel
+0003e9c0: 662e 7665 7262 6f73 653a 0a20 2020 2020  f.verbose:.     
+0003e9d0: 2020 2020 2020 2020 2020 2020 2020 2020                  
+0003e9e0: 2020 2020 2020 2020 2020 2020 2020 2020                  
+0003e9f0: 2020 2020 2020 2070 7269 6e74 2827 2020         print('  
+0003ea00: 2020 5365 6c65 6374 696e 6720 4c47 424d    Selecting LGBM
+0003ea10: 2052 6567 7265 7373 6f72 2061 7320 6261   Regressor as ba
+0003ea20: 7365 2065 7374 696d 6174 6f72 2e2e 2e27  se estimator...'
+0003ea30: 290a 2020 2020 2020 2020 2020 2020 2020  ).              
+0003ea40: 2020 2020 2020 2020 2020 2020 2020 2020                  
+0003ea50: 2020 2020 2020 2020 2020 7365 6c66 2e62            self.b
+0003ea60: 6173 655f 6573 7469 6d61 746f 7220 3d20  ase_estimator = 
+0003ea70: 4c47 424d 5265 6772 6573 736f 7228 6e5f  LGBMRegressor(n_
+0003ea80: 6a6f 6273 3d2d 312c 6465 7669 6365 3d64  jobs=-1,device=d
+0003ea90: 6576 6963 652c 2072 616e 646f 6d5f 7374  evice, random_st
+0003eaa0: 6174 653d 7261 6e64 6f6d 5f73 6565 6429  ate=random_seed)
+0003eab0: 2020 2020 2020 2020 2020 2020 2020 2020                  
+0003eac0: 2020 2020 2020 2020 2020 2020 2020 2020                  
+0003ead0: 2020 2020 0a20 2020 2020 2020 2020 2020      .           
+0003eae0: 2020 2020 2020 2020 2020 2020 2065 6c73               els
+0003eaf0: 653a 0a20 2020 2020 2020 2020 2020 2020  e:.             
+0003eb00: 2020 2020 2020 2020 2020 2020 2020 2069                 i
+0003eb10: 6620 6770 755f 6578 6973 7473 3a0a 2020  f gpu_exists:.  
+0003eb20: 2020 2020 2020 2020 2020 2020 2020 2020                  
+0003eb30: 2020 2020 2020 2020 2020 2020 2020 6966                if
+0003eb40: 2073 656c 662e 7665 7262 6f73 653a 0a20   self.verbose:. 
+0003eb50: 2020 2020 2020 2020 2020 2020 2020 2020                  
+0003eb60: 2020 2020 2020 2020 2020 2020 2020 2020                  
+0003eb70: 2020 2070 7269 6e74 2827 2020 2020 5365     print('    Se
+0003eb80: 6c65 6374 696e 6720 5847 4220 5265 6772  lecting XGB Regr
+0003eb90: 6573 736f 7220 7769 7468 2047 5055 2061  essor with GPU a
+0003eba0: 7320 6261 7365 2065 7374 696d 6174 6f72  s base estimator
+0003ebb0: 2e2e 2e27 290a 2020 2020 2020 2020 2020  ...').          
+0003ebc0: 2020 2020 2020 2020 2020 2020 2020 2020                  
+0003ebd0: 2020 2020 2020 7365 6c66 2e62 6173 655f        self.base_
+0003ebe0: 6573 7469 6d61 746f 7220 3d20 5847 4252  estimator = XGBR
+0003ebf0: 6567 7265 7373 6f72 2820 0a20 2020 2020  egressor( .     
+0003ec00: 2020 2020 2020 2020 2020 2020 2020 2020                  
+0003ec10: 2020 2020 2020 2020 2020 2020 2020 206e                 n
+0003ec20: 5f6a 6f62 733d 2d31 2c74 7265 655f 6d65  _jobs=-1,tree_me
+0003ec30: 7468 6f64 203d 2027 6770 755f 6869 7374  thod = 'gpu_hist
+0003ec40: 272c 6770 755f 6964 3d30 2c20 7072 6564  ',gpu_id=0, pred
+0003ec50: 6963 746f 723d 2267 7075 5f70 7265 6469  ictor="gpu_predi
+0003ec60: 6374 6f72 2229 0a20 2020 2020 2020 2020  ctor").         
+0003ec70: 2020 2020 2020 2020 2020 2020 2020 2020                  
+0003ec80: 2020 2065 6c73 653a 0a20 2020 2020 2020     else:.       
+0003ec90: 2020 2020 2020 2020 2020 2020 2020 2020                  
+0003eca0: 2020 2020 2020 2020 2069 6620 7365 6c66           if self
+0003ecb0: 2e76 6572 626f 7365 3a0a 2020 2020 2020  .verbose:.      
+0003ecc0: 2020 2020 2020 2020 2020 2020 2020 2020                  
+0003ecd0: 2020 2020 2020 2020 2020 2020 2020 7072                pr
+0003ece0: 696e 7428 2720 2020 2053 656c 6563 7469  int('    Selecti
+0003ecf0: 6e67 204c 4742 4d20 5265 6772 6573 736f  ng LGBM Regresso
+0003ed00: 7220 6173 2062 6173 6520 6573 7469 6d61  r as base estima
+0003ed10: 746f 722e 2e2e 2729 0a20 2020 2020 2020  tor...').       
+0003ed20: 2020 2020 2020 2020 2020 2020 2020 2020                  
+0003ed30: 2020 2020 2020 2020 2073 656c 662e 6261           self.ba
+0003ed40: 7365 5f65 7374 696d 6174 6f72 203d 204c  se_estimator = L
+0003ed50: 4742 4d52 6567 7265 7373 6f72 286e 5f6a  GBMRegressor(n_j
+0003ed60: 6f62 733d 2d31 2c64 6576 6963 653d 6465  obs=-1,device=de
+0003ed70: 7669 6365 2c20 7261 6e64 6f6d 5f73 7461  vice, random_sta
+0003ed80: 7465 3d72 616e 646f 6d5f 7365 6564 290a  te=random_seed).
+0003ed90: 2020 2020 2020 2020 2020 2020 2020 2020                  
+0003eda0: 2020 2020 656c 7365 3a0a 2020 2020 2020      else:.      
+0003edb0: 2020 2020 2020 2020 2020 2020 2020 2020                  
+0003edc0: 2020 7365 6c66 2e6d 6f64 656c 5f6e 616d    self.model_nam
+0003edd0: 6520 3d3d 2027 6f74 6865 7227 0a20 2020  e == 'other'.   
+0003ede0: 2020 2020 2020 2020 2020 2020 2020 2020                  
+0003edf0: 2023 2053 706c 6974 2064 6174 6120 696e   # Split data in
+0003ee00: 746f 2074 7261 696e 2061 6e64 2074 6573  to train and tes
+0003ee10: 7420 6261 7365 6420 6f6e 2066 6f6c 6473  t based on folds
+0003ee20: 2020 2020 2020 2020 2020 0a20 2020 2020            .     
+0003ee30: 2020 2020 2020 2020 2020 2020 2020 2069                 i
+0003ee40: 6620 6973 696e 7374 616e 6365 2879 2c20  f isinstance(y, 
+0003ee50: 7064 2e53 6572 6965 7329 206f 7220 6973  pd.Series) or is
+0003ee60: 696e 7374 616e 6365 2879 2c20 7064 2e44  instance(y, pd.D
+0003ee70: 6174 6146 7261 6d65 293a 0a20 2020 2020  ataFrame):.     
+0003ee80: 2020 2020 2020 2020 2020 2020 2020 2020                  
+0003ee90: 2020 2079 5f74 7261 696e 2c20 795f 7465     y_train, y_te
+0003eea0: 7374 203d 2079 2e69 6c6f 635b 7472 6169  st = y.iloc[trai
+0003eeb0: 6e5f 696e 6465 785d 2c20 792e 696c 6f63  n_index], y.iloc
+0003eec0: 5b74 6573 745f 696e 6465 785d 2020 2020  [test_index]    
+0003eed0: 2020 2020 2020 2020 2020 2020 0a20 2020              .   
 0003eee0: 2020 2020 2020 2020 2020 2020 2020 2020                  
-0003eef0: 2062 616c 5f73 636f 7265 203d 2072 6f63   bal_score = roc
-0003ef00: 5f61 7563 5f73 636f 7265 2879 5f74 6573  _auc_score(y_tes
-0003ef10: 742e 7661 6c75 6573 5b3a 2c65 6163 685f  t.values[:,each_
-0003ef20: 695d 2c6d 6174 2c6d 756c 7469 5f63 6c61  i],mat,multi_cla
-0003ef30: 7373 3d22 6f76 7222 290a 2020 2020 2020  ss="ovr").      
+0003eef0: 2065 6c73 653a 0a20 2020 2020 2020 2020   else:.         
+0003ef00: 2020 2020 2020 2020 2020 2020 2020 2079                 y
+0003ef10: 5f74 7261 696e 2c20 795f 7465 7374 203d  _train, y_test =
+0003ef20: 2079 5b74 7261 696e 5f69 6e64 6578 5d2c   y[train_index],
+0003ef30: 2079 5b74 6573 745f 696e 6465 785d 0a0a   y[test_index]..
 0003ef40: 2020 2020 2020 2020 2020 2020 2020 2020                  
-0003ef50: 2020 656c 7365 3a0a 2020 2020 2020 2020    else:.        
-0003ef60: 2020 2020 2020 2020 2020 2020 2020 2020                  
-0003ef70: 2020 2020 6261 6c5f 7363 6f72 6520 3d20      bal_score = 
-0003ef80: 726f 635f 6175 635f 7363 6f72 6528 795f  roc_auc_score(y_
-0003ef90: 7465 7374 2e76 616c 7565 735b 3a2c 6561  test.values[:,ea
-0003efa0: 6368 5f69 5d2c 6d61 742c 6d75 6c74 695f  ch_i],mat,multi_
-0003efb0: 636c 6173 733d 226f 7672 2229 0a20 2020  class="ovr").   
-0003efc0: 2020 2020 2020 2020 2020 2020 2020 2020                  
-0003efd0: 2065 6c73 653a 0a20 2020 2020 2020 2020   else:.         
-0003efe0: 2020 2020 2020 2020 2020 2020 2020 2069                 i
-0003eff0: 6620 6973 696e 7374 616e 6365 2879 5f70  f isinstance(y_p
-0003f000: 726f 6261 732c 2064 6963 7429 3a0a 2020  robas, dict):.  
-0003f010: 2020 2020 2020 2020 2020 2020 2020 2020                  
-0003f020: 2020 2020 2020 2020 2020 6966 2079 5f70            if y_p
-0003f030: 726f 6261 735b 6561 6368 5f69 5d2e 6e64  robas[each_i].nd
-0003f040: 696d 203c 3d20 313a 0a20 2020 2020 2020  im <= 1:.       
-0003f050: 2020 2020 2020 2020 2020 2020 2020 2020                  
-0003f060: 2020 2020 2020 2020 2023 2320 5468 6973           ## This
-0003f070: 2069 7320 6361 7573 6564 2062 7920 4c61   is caused by La
-0003f080: 6265 6c20 5072 6f70 6167 6174 696f 6e20  bel Propagation 
-0003f090: 6865 6e63 6520 796f 7520 6d75 7374 2070  hence you must p
-0003f0a0: 726f 6261 7320 6c69 6b65 2074 6869 7320  robas like this 
-0003f0b0: 2323 0a20 2020 2020 2020 2020 2020 2020  ##.             
-0003f0c0: 2020 2020 2020 2020 2020 2020 2020 2020                  
-0003f0d0: 2020 206d 6174 203d 2079 5f70 726f 6261     mat = y_proba
-0003f0e0: 735b 6561 6368 5f69 5d0a 2020 2020 2020  s[each_i].      
-0003f0f0: 2020 2020 2020 2020 2020 2020 2020 2020                  
-0003f100: 2020 2020 2020 2020 2020 6966 206e 702e            if np.
-0003f110: 616e 7928 6e70 2e69 736e 616e 286d 6174  any(np.isnan(mat
-0003f120: 2929 3a0a 2020 2020 2020 2020 2020 2020  )):.            
-0003f130: 2020 2020 2020 2020 2020 2020 2020 2020                  
-0003f140: 2020 2020 2020 2020 6d61 7420 3d20 7064          mat = pd
-0003f150: 2e44 6174 6146 7261 6d65 286d 6174 292e  .DataFrame(mat).
-0003f160: 6669 6c6c 6e61 286d 6574 686f 643d 2766  fillna(method='f
-0003f170: 6669 6c6c 2729 2e76 616c 7565 730a 2020  fill').values.  
+0003ef50: 2020 2020 6966 2069 7369 6e73 7461 6e63      if isinstanc
+0003ef60: 6528 582c 2070 642e 4461 7461 4672 616d  e(X, pd.DataFram
+0003ef70: 6529 3a0a 2020 2020 2020 2020 2020 2020  e):.            
+0003ef80: 2020 2020 2020 2020 2020 2020 785f 7472              x_tr
+0003ef90: 6169 6e2c 2078 5f74 6573 7420 3d20 582e  ain, x_test = X.
+0003efa0: 696c 6f63 5b74 7261 696e 5f69 6e64 6578  iloc[train_index
+0003efb0: 5d2c 2058 2e69 6c6f 635b 7465 7374 5f69  ], X.iloc[test_i
+0003efc0: 6e64 6578 5d0a 2020 2020 2020 2020 2020  ndex].          
+0003efd0: 2020 2020 2020 2020 2020 656c 7365 3a0a            else:.
+0003efe0: 2020 2020 2020 2020 2020 2020 2020 2020                  
+0003eff0: 2020 2020 2020 2020 785f 7472 6169 6e2c          x_train,
+0003f000: 2078 5f74 6573 7420 3d20 585b 7472 6169   x_test = X[trai
+0003f010: 6e5f 696e 6465 785d 2c20 585b 7465 7374  n_index], X[test
+0003f020: 5f69 6e64 6578 5d0a 0a20 2020 2020 2020  _index]..       
+0003f030: 2020 2020 2020 2020 2020 2020 2023 2323               ###
+0003f040: 2323 2320 446f 2074 6869 7320 6f6e 6c79  ### Do this only
+0003f050: 2074 6865 2066 6972 7374 2074 696d 6520   the first time 
+0003f060: 2323 2323 2323 2323 2323 2323 2323 2323  ################
+0003f070: 2323 2323 2323 2323 2323 2323 2323 2323  ################
+0003f080: 2323 2323 2323 2323 2323 2323 2323 2323  ################
+0003f090: 0a20 2020 2020 2020 2020 2020 2020 2020  .               
+0003f0a0: 2020 2020 2069 6620 6920 3d3d 2030 3a0a       if i == 0:.
+0003f0b0: 2020 2020 2020 2020 2020 2020 2020 2020                  
+0003f0c0: 2020 2020 2020 2020 2323 2320 4974 2064          ### It d
+0003f0d0: 6f65 7320 6e6f 7420 6d61 6b65 2073 656e  oes not make sen
+0003f0e0: 7365 2074 6f20 646f 2068 7970 6572 2d70  se to do hyper-p
+0003f0f0: 6172 616d 2074 756e 696e 6720 666f 7220  aram tuning for 
+0003f100: 6d75 6c74 692d 6c61 6265 6c20 6d6f 6465  multi-label mode
+0003f110: 6c73 2023 230a 2020 2020 2020 2020 2020  ls ##.          
+0003f120: 2020 2020 2020 2020 2020 2020 2020 2323                ##
+0003f130: 2320 2020 2073 696e 6365 2043 6c61 7373  #    since Class
+0003f140: 6966 6965 7243 6861 696e 7320 646f 206e  ifierChains do n
+0003f150: 6f74 2068 6176 6520 6d61 6e79 2068 7970  ot have many hyp
+0003f160: 6572 2070 6172 616d 7320 2323 2323 2323  er params ######
+0003f170: 2323 2323 2323 2323 2323 230a 2020 2020  ###########.    
 0003f180: 2020 2020 2020 2020 2020 2020 2020 2020                  
-0003f190: 2020 2020 2020 2020 2020 2020 2020 6261                ba
-0003f1a0: 6c5f 7363 6f72 6520 3d20 726f 635f 6175  l_score = roc_au
-0003f1b0: 635f 7363 6f72 6528 795f 7465 7374 2e76  c_score(y_test.v
-0003f1c0: 616c 7565 735b 3a2c 6561 6368 5f69 5d2c  alues[:,each_i],
-0003f1d0: 6d61 7429 0a20 2020 2020 2020 2020 2020  mat).           
+0003f190: 2020 2020 2373 656c 662e 6261 7365 5f65      #self.base_e
+0003f1a0: 7374 696d 6174 6f72 203d 2072 616e 645f  stimator = rand_
+0003f1b0: 7365 6172 6368 2873 656c 662e 6261 7365  search(self.base
+0003f1c0: 5f65 7374 696d 6174 6f72 2c20 785f 7472  _estimator, x_tr
+0003f1d0: 6169 6e2c 2079 5f74 7261 696e 2c20 0a20  ain, y_train, . 
 0003f1e0: 2020 2020 2020 2020 2020 2020 2020 2020                  
-0003f1f0: 2065 6c73 653a 0a20 2020 2020 2020 2020   else:.         
+0003f1f0: 2020 2020 2020 2023 2020 2020 2020 2020         #        
 0003f200: 2020 2020 2020 2020 2020 2020 2020 2020                  
-0003f210: 2020 2020 2020 2062 616c 5f73 636f 7265         bal_score
-0003f220: 203d 2072 6f63 5f61 7563 5f73 636f 7265   = roc_auc_score
-0003f230: 2879 5f74 6573 742e 7661 6c75 6573 5b3a  (y_test.values[:
-0003f240: 2c65 6163 685f 695d 2c79 5f70 726f 6261  ,each_i],y_proba
-0003f250: 735b 6561 6368 5f69 5d5b 3a2c 315d 290a  s[each_i][:,1]).
-0003f260: 2020 2020 2020 2020 2020 2020 2020 2020                  
-0003f270: 2020 2020 2020 2020 656c 7365 3a0a 2020          else:.  
-0003f280: 2020 2020 2020 2020 2020 2020 2020 2020                  
-0003f290: 2020 2020 2020 2020 2020 6966 2079 5f70            if y_p
-0003f2a0: 726f 6261 732e 7368 6170 655b 315d 203d  robas.shape[1] =
-0003f2b0: 3d20 6e75 6d5f 7461 7267 6574 733a 0a20  = num_targets:. 
+0003f210: 7365 6c66 2e6d 6f64 656c 5f6e 616d 652c  self.model_name,
+0003f220: 2076 6572 626f 7365 3d73 656c 662e 7665   verbose=self.ve
+0003f230: 7262 6f73 6529 0a20 2020 2020 2020 2020  rbose).         
+0003f240: 2020 2020 2020 2020 2020 2020 2020 2023                 #
+0003f250: 7072 696e 7428 2720 2020 2068 7970 6572  print('    hyper
+0003f260: 2074 756e 6564 2062 6173 6520 6573 7469   tuned base esti
+0003f270: 6d61 746f 7220 3d20 2573 2720 2573 656c  mator = %s' %sel
+0003f280: 662e 6261 7365 5f65 7374 696d 6174 6f72  f.base_estimator
+0003f290: 290a 2020 2020 2020 2020 2020 2020 2020  ).              
+0003f2a0: 2020 2020 2020 2020 2020 6966 2073 656c            if sel
+0003f2b0: 662e 7665 7262 6f73 653a 0a20 2020 2020  f.verbose:.     
 0003f2c0: 2020 2020 2020 2020 2020 2020 2020 2020                  
-0003f2d0: 2020 2020 2020 2020 2020 2020 2020 2023                 #
-0003f2e0: 2323 2054 6869 7320 6d65 616e 7320 4c61  ## This means La
-0003f2f0: 6265 6c20 5072 6f70 6167 6174 696f 6e20  bel Propagation 
-0003f300: 7761 7320 7573 6564 2077 6869 6368 2063  was used which c
-0003f310: 7265 6174 6573 2070 726f 6261 7320 6c69  reates probas li
-0003f320: 6b65 2074 6869 7320 2323 0a20 2020 2020  ke this ##.     
-0003f330: 2020 2020 2020 2020 2020 2020 2020 2020                  
-0003f340: 2020 2020 2020 2020 2020 2062 616c 5f73             bal_s
-0003f350: 636f 7265 203d 2072 6f63 5f61 7563 5f73  core = roc_auc_s
-0003f360: 636f 7265 2879 5f74 6573 742e 7661 6c75  core(y_test.valu
-0003f370: 6573 5b3a 2c65 6163 685f 695d 2c79 5f70  es[:,each_i],y_p
-0003f380: 726f 6261 735b 3a2c 6561 6368 5f69 5d29  robas[:,each_i])
-0003f390: 0a20 2020 2020 2020 2020 2020 2020 2020  .               
-0003f3a0: 2020 2020 2020 2020 2020 2020 2065 6c73               els
-0003f3b0: 653a 0a20 2020 2020 2020 2020 2020 2020  e:.             
-0003f3c0: 2020 2020 2020 2020 2020 2020 2020 2020                  
-0003f3d0: 2020 2023 2323 2054 6869 7320 6d65 616e     ### This mean
-0003f3e0: 7320 7265 6775 6c61 7220 736b 6c65 6172  s regular sklear
-0003f3f0: 6e20 636c 6173 7369 6669 6572 7320 7768  n classifiers wh
-0003f400: 6963 6820 7072 6564 6963 7420 6d75 6c74  ich predict mult
-0003f410: 6920 6469 6d20 7072 6f62 6173 2023 0a20  i dim probas #. 
-0003f420: 2020 2020 2020 2020 2020 2020 2020 2020                  
-0003f430: 2020 2020 2020 2020 2020 2020 2020 2062                 b
-0003f440: 616c 5f73 636f 7265 203d 2072 6f63 5f61  al_score = roc_a
-0003f450: 7563 5f73 636f 7265 2879 5f74 6573 742e  uc_score(y_test.
-0003f460: 7661 6c75 6573 5b3a 2c65 6163 685f 695d  values[:,each_i]
-0003f470: 2c79 5f70 726f 6261 735b 6561 6368 5f69  ,y_probas[each_i
-0003f480: 5d29 0a20 2020 2020 2020 2020 2020 2020  ]).             
-0003f490: 2020 2020 2020 2070 7269 6e74 2827 5461         print('Ta
-0003f4a0: 7267 6574 206e 756d 6265 7220 2573 3a20  rget number %s: 
-0003f4b0: 524f 4320 4155 4320 7363 6f72 6520 2530  ROC AUC score %0
-0003f4c0: 2e30 6625 2527 2025 2865 6163 685f 692b  .0f%%' %(each_i+
-0003f4d0: 312c 3130 302a 6261 6c5f 7363 6f72 6529  1,100*bal_score)
-0003f4e0: 290a 2020 2020 2020 2020 2020 2020 2020  ).              
-0003f4f0: 2020 2020 2020 6261 6c5f 7363 6f72 6573        bal_scores
-0003f500: 2e61 7070 656e 6428 6261 6c5f 7363 6f72  .append(bal_scor
-0003f510: 6529 0a20 2020 2020 2020 2020 2020 2020  e).             
-0003f520: 2020 2020 2020 2069 6620 7665 7262 6f73         if verbos
-0003f530: 653a 0a20 2020 2020 2020 2020 2020 2020  e:.             
-0003f540: 2020 2020 2020 2020 2020 2070 7269 6e74             print
-0003f550: 2863 6c61 7373 6966 6963 6174 696f 6e5f  (classification_
-0003f560: 7265 706f 7274 2879 5f74 6573 742e 7661  report(y_test.va
-0003f570: 6c75 6573 5b3a 2c65 6163 685f 695d 2c79  lues[:,each_i],y
-0003f580: 5f70 7265 6473 5b3a 2c65 6163 685f 695d  _preds[:,each_i]
-0003f590: 2929 0a20 2020 2066 696e 616c 5f73 636f  )).    final_sco
-0003f5a0: 7265 203d 206e 702e 6d65 616e 2862 616c  re = np.mean(bal
-0003f5b0: 5f73 636f 7265 7329 0a20 2020 2069 6620  _scores).    if 
-0003f5c0: 7665 7262 6f73 653a 0a20 2020 2020 2020  verbose:.       
-0003f5d0: 2070 7269 6e74 2822 6669 6e61 6c20 6176   print("final av
-0003f5e0: 6572 6167 6520 6261 6c61 6e63 6564 2061  erage balanced a
-0003f5f0: 6363 7572 6163 7920 7363 6f72 6520 3d20  ccuracy score = 
-0003f600: 2530 2e32 6622 2025 6669 6e61 6c5f 7363  %0.2f" %final_sc
-0003f610: 6f72 6529 0a20 2020 2072 6574 7572 6e20  ore).    return 
-0003f620: 6669 6e61 6c5f 7363 6f72 650a 2323 2323  final_score.####
-0003f630: 2323 2323 2323 2323 2323 2323 2323 2323  ################
-0003f640: 2323 2323 2323 2323 2323 2323 2323 2323  ################
-0003f650: 2323 2323 2323 2323 2323 2323 2323 2323  ################
-0003f660: 2323 2323 2323 2323 2323 2323 2323 2323  ################
-0003f670: 2323 2323 2323 2323 2323 0a69 6d70 6f72  ##########.impor
-0003f680: 7420 6f73 0a64 6566 2063 6865 636b 5f69  t os.def check_i
-0003f690: 665f 4750 555f 6578 6973 7473 2829 3a0a  f_GPU_exists():.
-0003f6a0: 2020 2020 7472 793a 0a20 2020 2020 2020      try:.       
-0003f6b0: 206f 732e 656e 7669 726f 6e5b 274e 5649   os.environ['NVI
-0003f6c0: 4449 415f 5649 5349 424c 455f 4445 5649  DIA_VISIBLE_DEVI
-0003f6d0: 4345 5327 5d0a 2020 2020 2020 2020 7072  CES'].        pr
-0003f6e0: 696e 7428 2747 5055 2061 7661 696c 6162  int('GPU availab
-0003f6f0: 6c65 206f 6e20 7468 6973 2064 6576 6963  le on this devic
-0003f700: 652e 2050 6c65 6173 6520 6163 7469 7661  e. Please activa
-0003f710: 7465 2069 7420 746f 2073 7065 6564 2075  te it to speed u
-0003f720: 7020 6c69 6768 7467 626d 2e27 290a 2020  p lightgbm.').  
-0003f730: 2020 2020 2020 7265 7475 726e 2054 7275        return Tru
-0003f740: 650a 2020 2020 6578 6365 7074 3a0a 2020  e.    except:.  
-0003f750: 2020 2020 2020 7072 696e 7428 274e 6f20        print('No 
-0003f760: 4750 5520 6176 6169 6c61 626c 6520 6f6e  GPU available on
-0003f770: 2074 6869 7320 6465 7669 6365 2e20 5573   this device. Us
-0003f780: 696e 6720 4350 5520 666f 7220 6c69 6768  ing CPU for ligh
-0003f790: 7467 626d 2061 6e64 206f 7468 6572 732e  tgbm and others.
-0003f7a0: 2729 0a20 2020 2020 2020 2072 6574 7572  ').        retur
-0003f7b0: 6e20 4661 6c73 650a 2323 2323 2323 2323  n False.########
-0003f7c0: 2323 2323 2323 2323 2323 2323 2323 2323  ################
-0003f7d0: 2323 2323 2323 2323 2323 2323 2323 2323  ################
-0003f7e0: 2323 2323 2323 2323 2323 2323 2323 2323  ################
-0003f7f0: 2323 2323 2323 2323 2323 2323 2323 2323  ################
-0003f800: 2323 2323 2323 230a 6465 6620 6765 745f  #######.def get_
-0003f810: 6d61 785f 6d69 6e5f 6672 6f6d 5f79 2861  max_min_from_y(a
-0003f820: 6374 7561 6c73 293a 0a20 2020 2069 6620  ctuals):.    if 
-0003f830: 6973 696e 7374 616e 6365 2861 6374 7561  isinstance(actua
-0003f840: 6c73 2c20 7064 2e53 6572 6965 7329 3a0a  ls, pd.Series):.
-0003f850: 2020 2020 2020 2020 595f 6d69 6e20 3d20          Y_min = 
-0003f860: 6163 7475 616c 732e 7661 6c75 6573 2e6d  actuals.values.m
-0003f870: 696e 2829 0a20 2020 2020 2020 2059 5f6d  in().        Y_m
-0003f880: 6178 203d 2061 6374 7561 6c73 2e76 616c  ax = actuals.val
-0003f890: 7565 732e 6d61 7828 290a 2020 2020 656c  ues.max().    el
-0003f8a0: 6966 2069 7369 6e73 7461 6e63 6528 6163  if isinstance(ac
-0003f8b0: 7475 616c 732c 2070 642e 4461 7461 4672  tuals, pd.DataFr
-0003f8c0: 616d 6529 3a0a 2020 2020 2020 2020 595f  ame):.        Y_
-0003f8d0: 6d69 6e20 3d20 6163 7475 616c 732e 7661  min = actuals.va
-0003f8e0: 6c75 6573 2e72 6176 656c 2829 2e6d 696e  lues.ravel().min
-0003f8f0: 2829 0a20 2020 2020 2020 2059 5f6d 6178  ().        Y_max
-0003f900: 203d 2061 6374 7561 6c73 2e76 616c 7565   = actuals.value
-0003f910: 732e 7261 7665 6c28 292e 6d61 7828 290a  s.ravel().max().
-0003f920: 2020 2020 656c 7365 3a0a 2020 2020 2020      else:.      
-0003f930: 2020 595f 6d69 6e20 3d20 6163 7475 616c    Y_min = actual
-0003f940: 732e 6d69 6e28 290a 2020 2020 2020 2020  s.min().        
-0003f950: 595f 6d61 7820 3d20 6163 7475 616c 732e  Y_max = actuals.
-0003f960: 6d61 7828 290a 2020 2020 7265 7475 726e  max().    return
-0003f970: 206e 702e 6172 7261 7928 5b59 5f6d 696e   np.array([Y_min
-0003f980: 2c20 595f 6d61 785d 290a 0a64 6566 2063  , Y_max])..def c
-0003f990: 6f6e 7665 7274 5f72 6567 7265 7373 696f  onvert_regressio
-0003f9a0: 6e5f 746f 5f63 6c61 7373 6573 2870 7265  n_to_classes(pre
-0003f9b0: 6469 6374 696f 6e73 2c20 6163 7475 616c  dictions, actual
-0003f9c0: 7329 3a0a 2020 2020 6966 2069 7369 6e73  s):.    if isins
-0003f9d0: 7461 6e63 6528 6163 7475 616c 732c 2070  tance(actuals, p
-0003f9e0: 642e 5365 7269 6573 293a 0a20 2020 2020  d.Series):.     
-0003f9f0: 2020 2059 5f6d 696e 203d 2061 6374 7561     Y_min = actua
-0003fa00: 6c73 2e76 616c 7565 732e 6d69 6e28 290a  ls.values.min().
-0003fa10: 2020 2020 2020 2020 595f 6d61 7820 3d20          Y_max = 
-0003fa20: 6163 7475 616c 732e 7661 6c75 6573 2e6d  actuals.values.m
-0003fa30: 6178 2829 0a20 2020 2065 6c69 6620 6973  ax().    elif is
-0003fa40: 696e 7374 616e 6365 2861 6374 7561 6c73  instance(actuals
-0003fa50: 2c20 7064 2e44 6174 6146 7261 6d65 293a  , pd.DataFrame):
-0003fa60: 0a20 2020 2020 2020 2059 5f6d 696e 203d  .        Y_min =
-0003fa70: 2061 6374 7561 6c73 2e76 616c 7565 732e   actuals.values.
-0003fa80: 7261 7665 6c28 292e 6d69 6e28 290a 2020  ravel().min().  
-0003fa90: 2020 2020 2020 595f 6d61 7820 3d20 6163        Y_max = ac
-0003faa0: 7475 616c 732e 7661 6c75 6573 2e72 6176  tuals.values.rav
-0003fab0: 656c 2829 2e6d 6178 2829 0a20 2020 2065  el().max().    e
-0003fac0: 6c73 653a 0a20 2020 2020 2020 2059 5f6d  lse:.        Y_m
-0003fad0: 696e 203d 2061 6374 7561 6c73 2e6d 696e  in = actuals.min
-0003fae0: 2829 0a20 2020 2020 2020 2059 5f6d 6178  ().        Y_max
-0003faf0: 203d 2061 6374 7561 6c73 2e6d 6178 2829   = actuals.max()
-0003fb00: 0a20 2020 2070 7265 6469 6374 696f 6e73  .    predictions
-0003fb10: 203d 206e 702e 726f 756e 6428 7072 6564   = np.round(pred
-0003fb20: 6963 7469 6f6e 732c 3029 2e61 7374 7970  ictions,0).astyp
-0003fb30: 6528 696e 7429 0a20 2020 2070 7265 6469  e(int).    predi
-0003fb40: 6374 696f 6e73 203d 206e 702e 7768 6572  ctions = np.wher
-0003fb50: 6528 7072 6564 6963 7469 6f6e 733c 595f  e(predictions<Y_
-0003fb60: 6d69 6e2c 2059 5f6d 696e 2c20 7072 6564  min, Y_min, pred
-0003fb70: 6963 7469 6f6e 7329 0a20 2020 2070 7265  ictions).    pre
-0003fb80: 6469 6374 696f 6e73 203d 206e 702e 7768  dictions = np.wh
-0003fb90: 6572 6528 7072 6564 6963 7469 6f6e 733e  ere(predictions>
-0003fba0: 595f 6d61 782c 2059 5f6d 6178 2c20 7072  Y_max, Y_max, pr
-0003fbb0: 6564 6963 7469 6f6e 7329 0a20 2020 2072  edictions).    r
-0003fbc0: 6574 7572 6e20 7072 6564 6963 7469 6f6e  eturn prediction
-0003fbd0: 730a 2323 2323 2323 2323 2323 2323 2323  s.##############
-0003fbe0: 2323 2323 2323 2323 2323 2323 2323 2323  ################
-0003fbf0: 2323 2323 2323 2323 2323 2323 2323 2323  ################
-0003fc00: 2323 2323 2323 2323 2323 2323 2323 2323  ################
-0003fc10: 2323 2323 2323 2323 2323 2323 2323 2323  ################
-0003fc20: 230a 6672 6f6d 2073 6b6c 6561 726e 2e6d  #.from sklearn.m
-0003fc30: 6574 7269 6373 2069 6d70 6f72 7420 6d65  etrics import me
-0003fc40: 616e 5f73 7175 6172 6564 5f65 7272 6f72  an_squared_error
-0003fc50: 0a0a 6465 6620 726d 7365 2879 5f61 6374  ..def rmse(y_act
-0003fc60: 7561 6c2c 2079 5f70 7265 6469 6374 6564  ual, y_predicted
-0003fc70: 293a 0a20 2020 2072 6574 7572 6e20 6d65  ):.    return me
-0003fc80: 616e 5f73 7175 6172 6564 5f65 7272 6f72  an_squared_error
-0003fc90: 2879 5f61 6374 7561 6c2c 2079 5f70 7265  (y_actual, y_pre
-0003fca0: 6469 6374 6564 2c20 7371 7561 7265 643d  dicted, squared=
-0003fcb0: 4661 6c73 6529 0a23 2323 2323 2323 2323  False).#########
-0003fcc0: 2323 2323 2323 2323 2323 2323 2323 2323  ################
-0003fcd0: 2323 2323 2323 2323 2323 2323 2323 2323  ################
-0003fce0: 2323 2323 2323 2323 2323 2323 2323 2323  ################
-0003fcf0: 2323 2323 2323 2323 2323 2323 2323 2323  ################
-0003fd00: 2323 2323 230a 636c 6173 7320 5375 6c6f  #####.class Sulo
-0003fd10: 5265 6772 6573 736f 7228 4261 7365 4573  Regressor(BaseEs
-0003fd20: 7469 6d61 746f 722c 2052 6567 7265 7373  timator, Regress
-0003fd30: 6f72 4d69 7869 6e29 3a0a 2020 2020 2222  orMixin):.    ""
-0003fd40: 220a 2020 2020 5375 6c6f 5265 6772 6573  ".    SuloRegres
-0003fd50: 736f 7220 7374 616e 6473 2066 6f72 2053  sor stands for S
-0003fd60: 7570 6572 204c 6561 726e 696e 6720 4f70  uper Learning Op
-0003fd70: 7469 6d69 7a65 6420 2853 554c 4f29 2052  timized (SULO) R
-0003fd80: 6567 7265 7373 6f72 2e0a 2020 2020 2d2d  egressor..    --
-0003fd90: 2049 7420 776f 726b 7320 6f6e 2073 6d61   It works on sma
-0003fda0: 6c6c 2061 7320 7765 6c6c 2061 7320 6269  ll as well as bi
-0003fdb0: 6720 6461 7461 2e20 4974 2077 6f72 6b73  g data. It works
-0003fdc0: 2069 6e20 496e 7465 6765 7220 6d6f 6465   in Integer mode
-0003fdd0: 2061 7320 7765 6c6c 2061 7320 666c 6f61   as well as floa
-0003fde0: 742d 6d6f 6465 2e0a 2020 2020 2d2d 2049  t-mode..    -- I
-0003fdf0: 7420 776f 726b 7320 6f6e 2072 6567 756c  t works on regul
-0003fe00: 6172 2062 616c 616e 6365 6420 6461 7461  ar balanced data
-0003fe10: 2061 7320 7765 6c6c 2061 7320 736b 6577   as well as skew
-0003fe20: 6564 2072 6567 7265 7373 696f 6e20 7461  ed regression ta
-0003fe30: 7267 6574 732e 0a20 2020 2054 6865 2072  rgets..    The r
-0003fe40: 6561 736f 6e20 6974 2077 6f72 6b73 2073  eason it works s
-0003fe50: 6f20 7765 6c6c 2069 7320 7468 6174 2053  o well is that S
-0003fe60: 756c 6f20 6973 2061 6e20 656e 7365 6d62  ulo is an ensemb
-0003fe70: 6c65 206f 6620 6869 6768 6c79 2074 756e  le of highly tun
-0003fe80: 6564 206d 6f64 656c 732e 0a20 2020 202d  ed models..    -
-0003fe90: 2d20 596f 7520 646f 6e27 7420 6861 7665  - You don't have
-0003fea0: 2074 6f20 7365 6e64 2061 6e79 2069 6e70   to send any inp
-0003feb0: 7574 7320 6275 7420 6966 2079 6f75 2077  uts but if you w
-0003fec0: 616e 7465 6420 746f 2c20 796f 7520 6361  anted to, you ca
-0003fed0: 6e20 7370 6566 6966 7920 6d75 6c74 6970  n spefify multip
-0003fee0: 6c65 206f 7074 696f 6e73 2e0a 2020 2020  le options..    
-0003fef0: 4974 2069 7320 6675 6c6c 7920 636f 6d70  It is fully comp
-0003ff00: 6174 6962 6c65 2077 6974 6820 7363 696b  atible with scik
-0003ff10: 6974 2d6c 6561 726e 2070 6970 656c 696e  it-learn pipelin
-0003ff20: 6573 2061 6e64 206f 7468 6572 206d 6f64  es and other mod
-0003ff30: 656c 732e 0a0a 2020 2020 496e 7075 7473  els...    Inputs
-0003ff40: 3a0a 2020 2020 2020 2020 6e5f 6573 7469  :.        n_esti
-0003ff50: 6d61 746f 7273 3a20 6465 6661 756c 7420  mators: default 
-0003ff60: 6973 204e 6f6e 652e 204e 756d 6265 7220  is None. Number 
-0003ff70: 6f66 206d 6f64 656c 7320 796f 7520 7761  of models you wa
-0003ff80: 6e74 2069 6e20 7468 6520 6669 6e61 6c20  nt in the final 
-0003ff90: 656e 7365 6d62 6c65 2e0a 2020 2020 2020  ensemble..      
-0003ffa0: 2020 6261 7365 5f65 7374 696d 6174 6f72    base_estimator
-0003ffb0: 3a20 6465 6661 756c 7420 6973 204e 6f6e  : default is Non
-0003ffc0: 652e 2042 6173 6520 6d6f 6465 6c20 796f  e. Base model yo
-0003ffd0: 7520 7761 6e74 2074 6f20 7472 6169 6e20  u want to train 
-0003ffe0: 696e 2065 6163 6820 6f66 2074 6865 2065  in each of the e
-0003fff0: 6e73 656d 626c 6573 2e0a 2020 2020 2020  nsembles..      
-00040000: 2020 7069 7065 6c69 6e65 3a20 6465 6661    pipeline: defa
-00040010: 756c 7420 6973 2046 616c 7365 2e20 4974  ult is False. It
-00040020: 2077 696c 6c20 7472 616e 7366 6f72 6d20   will transform 
-00040030: 616c 6c20 6461 7461 2074 6f20 6e75 6d65  all data to nume
-00040040: 7269 6320 6175 746f 6d61 7469 6361 6c6c  ric automaticall
-00040050: 7920 6966 2073 6574 2074 6f20 5472 7565  y if set to True
-00040060: 2e0a 2020 2020 2020 2020 696d 6261 6c61  ..        imbala
-00040070: 6e63 6564 3a20 6465 6661 756c 7420 6973  nced: default is
-00040080: 2046 616c 7365 2e20 4974 2077 696c 6c20   False. It will 
-00040090: 6163 7469 7661 7465 2061 2073 7065 6369  activate a speci
-000400a0: 616c 2069 6d62 616c 616e 6365 6420 5265  al imbalanced Re
-000400b0: 6772 6573 736f 7220 6966 2073 6574 2074  gressor if set t
-000400c0: 6f20 5472 7565 2e0a 2020 2020 2020 2020  o True..        
-000400d0: 696e 7465 6765 7273 5f6f 6e6c 793a 2064  integers_only: d
-000400e0: 6566 6175 6c74 2069 7320 4661 6c73 652e  efault is False.
-000400f0: 2049 7420 7769 6c6c 2070 6572 666f 726d   It will perform
-00040100: 2049 6e74 6567 6572 2072 6567 7265 7373   Integer regress
-00040110: 696f 6e20 6966 2073 6574 2074 6f20 5472  ion if set to Tr
-00040120: 7565 0a20 2020 2020 2020 206c 6f67 5f74  ue.        log_t
-00040130: 7261 6e73 666f 726d 3a20 6465 6661 756c  ransform: defaul
-00040140: 7420 6973 2046 616c 7365 2e20 4974 2077  t is False. It w
-00040150: 696c 6c20 7065 7266 6f72 6d20 6c6f 6720  ill perform log 
-00040160: 7472 616e 7366 6f72 6d20 6f66 2074 6172  transform of tar
-00040170: 6765 7420 6966 2073 6574 2074 6f20 5472  get if set to Tr
-00040180: 7565 2e0a 2020 2020 2020 2020 7469 6d65  ue..        time
-00040190: 5f73 6572 6965 733a 2064 6566 6175 6c74  _series: default
-000401a0: 2069 7320 4661 6c73 652e 2049 6620 7365   is False. If se
-000401b0: 7420 746f 2054 7275 652c 2065 7870 616e  t to True, expan
-000401c0: 6469 6e67 2077 696e 646f 7720 5469 6d65  ding window Time
-000401d0: 2053 6572 6965 7320 7370 6c69 7420 6973   Series split is
-000401e0: 2070 6572 666f 726d 6564 2e0a 2020 2020   performed..    
-000401f0: 2020 2020 2020 2020 4966 2079 6f75 2069          If you i
-00040200: 6e70 7574 2022 736c 6964 696e 6722 2068  nput "sliding" h
-00040210: 6572 652c 2074 6865 6e20 7765 2077 696c  ere, then we wil
-00040220: 6c20 7065 7266 6f72 6d20 6120 736c 6964  l perform a slid
-00040230: 696e 6720 7769 6e64 6f77 2074 696d 6520  ing window time 
-00040240: 7365 7269 6573 2073 706c 6974 2e0a 2020  series split..  
-00040250: 2020 2020 2020 7665 7262 6f73 653a 2064        verbose: d
-00040260: 6566 6175 6c74 2069 7320 302e 2049 7420  efault is 0. It 
-00040270: 7769 6c6c 2070 7269 6e74 2076 6572 626f  will print verbo
-00040280: 7365 206f 7574 7075 7420 6966 2073 6574  se output if set
-00040290: 2074 6f20 5472 7565 2e0a 0a20 2020 204f   to True...    O
-000402a0: 7574 7574 733a 0a20 2020 2020 2020 2072  ututs:.        r
-000402b0: 6567 7265 7373 6f72 3a20 7265 7475 726e  egressor: return
-000402c0: 7320 6120 7265 6772 6573 7369 6f6e 206d  s a regression m
-000402d0: 6f64 656c 2068 6967 686c 7920 7475 6e65  odel highly tune
-000402e0: 6420 746f 2079 6f75 7220 7370 6563 6966  d to your specif
-000402f0: 6963 206e 6565 6473 2061 6e64 2064 6174  ic needs and dat
-00040300: 6173 6574 2e0a 2020 2020 2222 220a 2020  aset..    """.  
-00040310: 2020 6465 6620 5f5f 696e 6974 5f5f 2873    def __init__(s
-00040320: 656c 662c 2062 6173 655f 6573 7469 6d61  elf, base_estima
-00040330: 746f 723d 4e6f 6e65 2c20 6e5f 6573 7469  tor=None, n_esti
-00040340: 6d61 746f 7273 3d4e 6f6e 652c 2070 6970  mators=None, pip
-00040350: 656c 696e 653d 4661 6c73 652c 2069 6d62  eline=False, imb
-00040360: 616c 616e 6365 643d 4661 6c73 652c 200a  alanced=False, .
-00040370: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00040380: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00040390: 2020 2020 2020 2069 6e74 6567 6572 735f         integers_
-000403a0: 6f6e 6c79 3d46 616c 7365 2c20 6c6f 675f  only=False, log_
-000403b0: 7472 616e 7366 6f72 6d3d 4661 6c73 652c  transform=False,
-000403c0: 200a 2020 2020 2020 2020 2020 2020 2020   .              
-000403d0: 2020 2020 2020 2020 2020 2020 2020 2020                  
-000403e0: 2020 2020 2020 2020 2074 696d 655f 7365           time_se
-000403f0: 7269 6573 203d 2046 616c 7365 2c20 7665  ries = False, ve
-00040400: 7262 6f73 653d 3029 3a0a 2020 2020 2020  rbose=0):.      
-00040410: 2020 7365 6c66 2e6e 5f65 7374 696d 6174    self.n_estimat
-00040420: 6f72 7320 3d20 6e5f 6573 7469 6d61 746f  ors = n_estimato
-00040430: 7273 0a20 2020 2020 2020 2073 656c 662e  rs.        self.
-00040440: 6261 7365 5f65 7374 696d 6174 6f72 203d  base_estimator =
-00040450: 2062 6173 655f 6573 7469 6d61 746f 720a   base_estimator.
-00040460: 2020 2020 2020 2020 7365 6c66 2e70 6970          self.pip
-00040470: 656c 696e 6520 3d20 7069 7065 6c69 6e65  eline = pipeline
-00040480: 0a20 2020 2020 2020 2073 656c 662e 696d  .        self.im
-00040490: 6261 6c61 6e63 6564 203d 2069 6d62 616c  balanced = imbal
-000404a0: 616e 6365 640a 2020 2020 2020 2020 7365  anced.        se
-000404b0: 6c66 2e69 6e74 6567 6572 735f 6f6e 6c79  lf.integers_only
-000404c0: 203d 2069 6e74 6567 6572 735f 6f6e 6c79   = integers_only
-000404d0: 0a20 2020 2020 2020 2073 656c 662e 6c6f  .        self.lo
-000404e0: 675f 7472 616e 7366 6f72 6d20 3d20 6c6f  g_transform = lo
-000404f0: 675f 7472 616e 7366 6f72 6d0a 2020 2020  g_transform.    
-00040500: 2020 2020 7365 6c66 2e74 696d 655f 7365      self.time_se
-00040510: 7269 6573 203d 2074 696d 655f 7365 7269  ries = time_seri
-00040520: 6573 200a 2020 2020 2020 2020 7365 6c66  es .        self
-00040530: 2e76 6572 626f 7365 203d 2076 6572 626f  .verbose = verbo
-00040540: 7365 0a20 2020 2020 2020 2073 656c 662e  se.        self.
-00040550: 6d6f 6465 6c73 203d 205b 5d0a 2020 2020  models = [].    
-00040560: 2020 2020 7365 6c66 2e6d 756c 7469 5f6c      self.multi_l
-00040570: 6162 656c 203d 2020 4661 6c73 650a 2020  abel =  False.  
-00040580: 2020 2020 2020 7365 6c66 2e73 636f 7265        self.score
-00040590: 7320 3d20 5b5d 0a20 2020 2020 2020 2073  s = [].        s
-000405a0: 656c 662e 696e 7465 6765 7273 5f6f 6e6c  elf.integers_onl
-000405b0: 795f 6d69 6e5f 6d61 7820 3d20 5b5d 0a20  y_min_max = []. 
-000405c0: 2020 2020 2020 2073 656c 662e 6d6f 6465         self.mode
-000405d0: 6c5f 6e61 6d65 203d 2027 270a 2020 2020  l_name = ''.    
-000405e0: 2020 2020 7365 6c66 2e66 6561 7475 7265      self.feature
-000405f0: 7320 3d20 5b5d 0a0a 2020 2020 6465 6620  s = []..    def 
-00040600: 6669 7428 7365 6c66 2c20 582c 2079 293a  fit(self, X, y):
-00040610: 0a20 2020 2020 2020 2058 203d 2063 6f70  .        X = cop
-00040620: 792e 6465 6570 636f 7079 2858 290a 2020  y.deepcopy(X).  
-00040630: 2020 2020 2020 7072 696e 7428 2749 6e70        print('Inp
-00040640: 7574 2064 6174 6120 7368 6170 6573 3a20  ut data shapes: 
-00040650: 5820 3d20 2573 2720 2528 582e 7368 6170  X = %s' %(X.shap
-00040660: 652c 2929 0a20 2020 2020 2020 2070 7269  e,)).        pri
-00040670: 6e74 2827 2020 2020 7920 7368 6170 6520  nt('    y shape 
-00040680: 3d20 2573 2720 2528 792e 7368 6170 652c  = %s' %(y.shape,
-00040690: 2929 0a20 2020 2020 2020 2073 6565 6420  )).        seed 
-000406a0: 3d20 3432 0a20 2020 2020 2020 2073 6875  = 42.        shu
-000406b0: 6666 6c65 466c 6167 203d 2054 7275 650a  ffleFlag = True.
-000406c0: 2020 2020 2020 2020 6d6f 6465 6c74 7970          modeltyp
-000406d0: 6520 3d20 2752 6567 7265 7373 696f 6e27  e = 'Regression'
-000406e0: 0a20 2020 2020 2020 2066 6561 7475 7265  .        feature
-000406f0: 735f 6c69 6d69 7420 3d20 3530 2023 2320  s_limit = 50 ## 
-00040700: 6966 2074 6865 7265 2061 7265 206d 6f72  if there are mor
-00040710: 6520 7468 616e 2035 3020 6665 6174 7572  e than 50 featur
-00040720: 6573 2069 6e20 6461 7461 7365 742c 2062  es in dataset, b
-00040730: 6574 7465 7220 746f 2075 7365 204c 4742  etter to use LGB
-00040740: 4d20 2323 0a20 2020 2020 2020 2073 7461  M ##.        sta
-00040750: 7274 203d 2074 696d 652e 7469 6d65 2829  rt = time.time()
-00040760: 0a20 2020 2020 2020 2069 6620 6973 696e  .        if isin
-00040770: 7374 616e 6365 2858 2c20 7064 2e44 6174  stance(X, pd.Dat
-00040780: 6146 7261 6d65 293a 0a20 2020 2020 2020  aFrame):.       
-00040790: 2020 2020 2073 656c 662e 6665 6174 7572       self.featur
-000407a0: 6573 203d 2058 2e63 6f6c 756d 6e73 2e74  es = X.columns.t
-000407b0: 6f6c 6973 7428 290a 2020 2020 2020 2020  olist().        
-000407c0: 656c 7365 3a0a 2020 2020 2020 2020 2020  else:.          
-000407d0: 2020 7072 696e 7428 2743 616e 6e6f 7420    print('Cannot 
-000407e0: 6f70 6572 6174 6520 5375 6c6f 436c 6173  operate SuloClas
-000407f0: 7369 6669 6572 206f 6e20 6e75 6d70 7920  sifier on numpy 
-00040800: 6172 7261 7973 2e20 4d75 7374 2062 6520  arrays. Must be 
-00040810: 6461 7461 6672 616d 6573 2e20 5265 7475  dataframes. Retu
-00040820: 726e 696e 672e 2e2e 2729 0a20 2020 2020  rning...').     
-00040830: 2020 2020 2020 2072 6574 7572 6e20 7365         return se
-00040840: 6c66 0a20 2020 2020 2020 2023 2055 7365  lf.        # Use
-00040850: 204b 466f 6c64 2066 6f72 2075 6e64 6572   KFold for under
-00040860: 7374 616e 6469 6e67 2074 6865 2070 6572  standing the per
-00040870: 666f 726d 616e 6365 0a20 2020 2020 2020  formance.       
-00040880: 2069 6620 7365 6c66 2e69 6d62 616c 616e   if self.imbalan
-00040890: 6365 643a 0a20 2020 2020 2020 2020 2020  ced:.           
-000408a0: 2070 7269 6e74 2827 5265 6d65 6d62 6572   print('Remember
-000408b0: 2074 6861 7420 7573 696e 6720 636c 6173   that using clas
-000408c0: 7320 7765 6967 6874 7320 7769 6c6c 2077  s weights will w
-000408d0: 726f 6e67 6c79 2073 6b65 7720 7072 6564  rongly skew pred
-000408e0: 6963 745f 7072 6f62 6173 2066 726f 6d20  ict_probas from 
-000408f0: 616e 7920 636c 6173 7369 6669 6572 2729  any classifier')
-00040900: 0a20 2020 2020 2020 2023 2323 2052 656d  .        ### Rem
-00040910: 656d 6265 7220 7468 6174 2070 7574 7469  ember that putti
-00040920: 6e67 2063 6c61 7373 2077 6569 6768 7473  ng class weights
-00040930: 2077 696c 6c20 746f 7461 6c6c 7920 6465   will totally de
-00040940: 7374 726f 7920 7072 6564 6963 745f 7072  stroy predict_pr
-00040950: 6f62 6173 2023 2323 0a20 2020 2020 2020  obas ###.       
-00040960: 2067 7075 5f65 7869 7374 7320 3d20 6368   gpu_exists = ch
-00040970: 6563 6b5f 6966 5f47 5055 5f65 7869 7374  eck_if_GPU_exist
-00040980: 7328 290a 2020 2020 2020 2020 6966 2067  s().        if g
-00040990: 7075 5f65 7869 7374 733a 0a20 2020 2020  pu_exists:.     
-000409a0: 2020 2020 2020 2064 6576 6963 653d 2267         device="g
-000409b0: 7075 220a 2020 2020 2020 2020 656c 7365  pu".        else
-000409c0: 3a0a 2020 2020 2020 2020 2020 2020 6465  :.            de
-000409d0: 7669 6365 3d22 6370 7522 0a20 2020 2020  vice="cpu".     
-000409e0: 2020 2072 6f77 5f6c 696d 6974 203d 2031     row_limit = 1
-000409f0: 3030 3030 0a20 2020 2020 2020 2069 6620  0000.        if 
-00040a00: 7365 6c66 2e69 6e74 6567 6572 735f 6f6e  self.integers_on
-00040a10: 6c79 3a0a 2020 2020 2020 2020 2020 2020  ly:.            
-00040a20: 7365 6c66 2e69 6e74 6567 6572 735f 6f6e  self.integers_on
-00040a30: 6c79 5f6d 696e 5f6d 6178 203d 2067 6574  ly_min_max = get
-00040a40: 5f6d 6178 5f6d 696e 5f66 726f 6d5f 7928  _max_min_from_y(
-00040a50: 7929 0a20 2020 2020 2020 2020 2020 2070  y).            p
-00040a60: 7269 6e74 2827 2020 2020 4d69 6e20 616e  rint('    Min an
-00040a70: 6420 6d61 7820 7661 6c75 6573 206f 6620  d max values of 
-00040a80: 7920 3d20 2573 2720 2573 656c 662e 696e  y = %s' %self.in
-00040a90: 7465 6765 7273 5f6f 6e6c 795f 6d69 6e5f  tegers_only_min_
-00040aa0: 6d61 7829 0a20 2020 2020 2020 2023 2323  max).        ###
-00040ab0: 2323 2323 2323 2323 2323 2323 2320 2020  #############   
-00040ac0: 2020 2020 2020 2050 2049 2050 2045 204c         P I P E L
-00040ad0: 2049 204e 2045 2020 2020 2020 2020 2323   I N E        ##
-00040ae0: 2323 2323 2323 2323 2323 2323 2323 2323  ################
-00040af0: 2323 2323 2323 2323 0a20 2020 2020 2020  ########.       
-00040b00: 206e 756d 6572 6963 5f74 7261 6e73 666f   numeric_transfo
-00040b10: 726d 6572 203d 2050 6970 656c 696e 6528  rmer = Pipeline(
-00040b20: 0a20 2020 2020 2020 2020 2020 2073 7465  .            ste
-00040b30: 7073 3d5b 2822 696d 7075 7465 7222 2c20  ps=[("imputer", 
-00040b40: 5369 6d70 6c65 496d 7075 7465 7228 7374  SimpleImputer(st
-00040b50: 7261 7465 6779 3d22 6d65 616e 222c 2061  rategy="mean", a
-00040b60: 6464 5f69 6e64 6963 6174 6f72 3d54 7275  dd_indicator=Tru
-00040b70: 6529 292c 2028 2273 6361 6c65 7222 2c20  e)), ("scaler", 
-00040b80: 5374 616e 6461 7264 5363 616c 6572 2829  StandardScaler()
-00040b90: 295d 290a 0a20 2020 2020 2020 2063 6174  )])..        cat
-00040ba0: 6567 6f72 6963 616c 5f74 7261 6e73 666f  egorical_transfo
-00040bb0: 726d 6572 5f6c 6f77 203d 2050 6970 656c  rmer_low = Pipel
-00040bc0: 696e 6528 0a20 2020 2020 2020 2020 2020  ine(.           
-00040bd0: 2073 7465 7073 3d5b 0a20 2020 2020 2020   steps=[.       
-00040be0: 2020 2020 2020 2020 2028 2269 6d70 7574           ("imput
-00040bf0: 6572 222c 2053 696d 706c 6549 6d70 7574  er", SimpleImput
-00040c00: 6572 2873 7472 6174 6567 793d 2263 6f6e  er(strategy="con
-00040c10: 7374 616e 7422 2c20 6669 6c6c 5f76 616c  stant", fill_val
-00040c20: 7565 3d22 6d69 7373 696e 6722 2c20 6164  ue="missing", ad
-00040c30: 645f 696e 6469 6361 746f 723d 5472 7565  d_indicator=True
-00040c40: 2929 2c0a 2020 2020 2020 2020 2020 2020  )),.            
-00040c50: 2020 2020 2822 656e 636f 6469 6e67 222c      ("encoding",
-00040c60: 204f 6e65 486f 7445 6e63 6f64 6572 2868   OneHotEncoder(h
-00040c70: 616e 646c 655f 756e 6b6e 6f77 6e3d 2276  andle_unknown="v
-00040c80: 616c 7565 2229 292c 5d29 0a0a 2020 2020  alue")),])..    
-00040c90: 2020 2020 6361 7465 676f 7269 6361 6c5f      categorical_
-00040ca0: 7472 616e 7366 6f72 6d65 725f 6869 6768  transformer_high
-00040cb0: 203d 2050 6970 656c 696e 6528 0a20 2020   = Pipeline(.   
-00040cc0: 2020 2020 2020 2020 2073 7465 7073 3d5b           steps=[
-00040cd0: 0a20 2020 2020 2020 2020 2020 2020 2020  .               
-00040ce0: 2028 2269 6d70 7574 6572 222c 2053 696d   ("imputer", Sim
-00040cf0: 706c 6549 6d70 7574 6572 2873 7472 6174  pleImputer(strat
-00040d00: 6567 793d 2263 6f6e 7374 616e 7422 2c20  egy="constant", 
-00040d10: 6669 6c6c 5f76 616c 7565 3d22 6d69 7373  fill_value="miss
-00040d20: 696e 6722 2c20 6164 645f 696e 6469 6361  ing", add_indica
-00040d30: 746f 723d 5472 7565 2929 2c0a 2020 2020  tor=True)),.    
-00040d40: 2020 2020 2020 2020 2020 2020 2822 656e              ("en
-00040d50: 636f 6469 6e67 222c 204c 6162 656c 456e  coding", LabelEn
-00040d60: 636f 6465 7228 2929 2c5d 290a 0a20 2020  coder()),])..   
-00040d70: 2020 2020 206e 756d 6572 6963 5f66 6561       numeric_fea
-00040d80: 7475 7265 7320 3d20 582e 7365 6c65 6374  tures = X.select
-00040d90: 5f64 7479 7065 7328 696e 636c 7564 653d  _dtypes(include=
-00040da0: 276e 756d 6265 7227 292e 636f 6c75 6d6e  'number').column
-00040db0: 730a 2020 2020 2020 2020 6361 7465 676f  s.        catego
-00040dc0: 7269 6361 6c5f 6665 6174 7572 6573 203d  rical_features =
-00040dd0: 2058 2e73 656c 6563 745f 6474 7970 6573   X.select_dtypes
-00040de0: 2869 6e63 6c75 6465 3d5b 226f 626a 6563  (include=["objec
-00040df0: 7422 5d29 2e63 6f6c 756d 6e73 0a0a 2020  t"]).columns..  
-00040e00: 2020 2020 2020 6361 7465 676f 7269 6361        categorica
-00040e10: 6c5f 6c6f 772c 2063 6174 6567 6f72 6963  l_low, categoric
-00040e20: 616c 5f68 6967 6820 3d20 6765 745f 6361  al_high = get_ca
-00040e30: 7264 696e 616c 6974 7928 582c 2063 6174  rdinality(X, cat
-00040e40: 6567 6f72 6963 616c 5f66 6561 7475 7265  egorical_feature
-00040e50: 7329 0a20 2020 2020 2020 2070 7265 7072  s).        prepr
-00040e60: 6f63 6573 736f 7220 3d20 436f 6c75 6d6e  ocessor = Column
-00040e70: 5472 616e 7366 6f72 6d65 7228 0a20 2020  Transformer(.   
-00040e80: 2020 2020 2020 2020 2074 7261 6e73 666f           transfo
-00040e90: 726d 6572 733d 5b0a 2020 2020 2020 2020  rmers=[.        
-00040ea0: 2020 2020 2020 2020 2822 6e75 6d65 7269          ("numeri
-00040eb0: 6322 2c20 6e75 6d65 7269 635f 7472 616e  c", numeric_tran
-00040ec0: 7366 6f72 6d65 722c 206e 756d 6572 6963  sformer, numeric
-00040ed0: 5f66 6561 7475 7265 7329 2c0a 2020 2020  _features),.    
-00040ee0: 2020 2020 2020 2020 2020 2020 2822 6361              ("ca
-00040ef0: 7465 676f 7269 6361 6c5f 6c6f 7722 2c20  tegorical_low", 
-00040f00: 6361 7465 676f 7269 6361 6c5f 7472 616e  categorical_tran
-00040f10: 7366 6f72 6d65 725f 6c6f 772c 2063 6174  sformer_low, cat
-00040f20: 6567 6f72 6963 616c 5f6c 6f77 292c 0a20  egorical_low),. 
-00040f30: 2020 2020 2020 2020 2020 2020 2020 2028                 (
-00040f40: 2263 6174 6567 6f72 6963 616c 5f68 6967  "categorical_hig
-00040f50: 6822 2c20 6361 7465 676f 7269 6361 6c5f  h", categorical_
-00040f60: 7472 616e 7366 6f72 6d65 725f 6869 6768  transformer_high
-00040f70: 2c20 6361 7465 676f 7269 6361 6c5f 6869  , categorical_hi
-00040f80: 6768 292c 0a20 2020 2020 2020 2020 2020  gh),.           
-00040f90: 205d 0a20 2020 2020 2020 2029 0a20 2020   ].        ).   
-00040fa0: 2020 2020 2023 2323 2323 2323 2323 2323       ###########
-00040fb0: 2323 2323 2323 2323 2323 2323 2323 2323  ################
-00040fc0: 2323 2323 2323 2323 2323 2323 2323 2323  ################
-00040fd0: 2323 2323 2323 2323 2323 2323 2323 2323  ################
-00040fe0: 2323 2323 2323 2323 2323 2323 2323 2323  ################
-00040ff0: 2323 2323 2323 2323 230a 2020 2020 2020  #########.      
-00041000: 2020 6461 7461 5f73 616d 706c 6573 203d    data_samples =
-00041010: 2058 2e73 6861 7065 5b30 5d0a 2020 2020   X.shape[0].    
-00041020: 2020 2020 6966 2073 656c 662e 6e5f 6573      if self.n_es
-00041030: 7469 6d61 746f 7273 2069 7320 4e6f 6e65  timators is None
-00041040: 3a0a 2020 2020 2020 2020 2020 2020 6966  :.            if
-00041050: 2064 6174 615f 7361 6d70 6c65 7320 3c3d   data_samples <=
-00041060: 2072 6f77 5f6c 696d 6974 3a0a 2020 2020   row_limit:.    
-00041070: 2020 2020 2020 2020 2020 2020 7365 6c66              self
-00041080: 2e6e 5f65 7374 696d 6174 6f72 7320 3d20  .n_estimators = 
-00041090: 6d69 6e28 352c 2069 6e74 2831 2e35 2a6e  min(5, int(1.5*n
-000410a0: 702e 6c6f 6731 3028 6461 7461 5f73 616d  p.log10(data_sam
-000410b0: 706c 6573 2929 290a 2020 2020 2020 2020  ples))).        
-000410c0: 2020 2020 656c 7365 3a0a 2020 2020 2020      else:.      
-000410d0: 2020 2020 2020 2020 2020 7365 6c66 2e6e            self.n
-000410e0: 5f65 7374 696d 6174 6f72 7320 3d20 6d69  _estimators = mi
-000410f0: 6e28 352c 2069 6e74 2831 2e32 2a6e 702e  n(5, int(1.2*np.
-00041100: 6c6f 6731 3028 6461 7461 5f73 616d 706c  log10(data_sampl
-00041110: 6573 2929 290a 2020 2020 2020 2020 6e75  es))).        nu
-00041120: 6d5f 7370 6c69 7473 203d 2073 656c 662e  m_splits = self.
-00041130: 6e5f 6573 7469 6d61 746f 7273 0a20 2020  n_estimators.   
-00041140: 2020 2020 2073 656c 662e 6d6f 6465 6c5f       self.model_
-00041150: 6e61 6d65 203d 2027 6c67 6227 0a20 2020  name = 'lgb'.   
-00041160: 2020 2020 206e 756d 5f72 6570 6561 7473       num_repeats
-00041170: 203d 2031 0a20 2020 2020 2020 2023 2323   = 1.        ###
-00041180: 2323 2323 2323 2323 2323 2323 2323 2323  ################
-00041190: 2323 2323 2323 2323 2323 2323 2323 2323  ################
-000411a0: 2323 2323 2323 2323 2323 2323 2323 2323  ################
-000411b0: 2323 2323 2323 2323 2323 2323 2323 2323  ################
-000411c0: 2323 2323 2323 2323 2323 2323 2323 2323  ################
-000411d0: 230a 2020 2020 2020 2020 2323 2323 2323  #.        ######
-000411e0: 2323 2323 2050 6572 666f 726d 2054 696d  #### Perform Tim
-000411f0: 6520 5365 7269 6573 2053 706c 6974 2068  e Series Split h
-00041200: 6572 6520 2323 2323 2323 2323 2323 2323  ere ############
-00041210: 2323 2323 2323 2323 2323 2323 2323 2323  ################
-00041220: 2323 2323 2323 2323 2323 2323 0a20 2020  ############.   
-00041230: 2020 2020 2023 2323 2323 2323 2323 2323       ###########
-00041240: 2323 2323 2323 2323 2323 2323 2323 2323  ################
-00041250: 2323 2323 2323 2323 2323 2323 2323 2323  ################
-00041260: 2323 2323 2323 2323 2323 2323 2323 2323  ################
-00041270: 2323 2323 2323 2323 2323 2323 2323 2323  ################
-00041280: 2323 2323 2323 2323 230a 2020 2020 2020  #########.      
-00041290: 2020 6966 2073 656c 662e 7469 6d65 5f73    if self.time_s
-000412a0: 6572 6965 733a 0a20 2020 2020 2020 2020  eries:.         
-000412b0: 2020 2069 6620 6973 696e 7374 616e 6365     if isinstance
-000412c0: 2873 656c 662e 7469 6d65 5f73 6572 6965  (self.time_serie
-000412d0: 732c 2073 7472 293a 0a20 2020 2020 2020  s, str):.       
-000412e0: 2020 2020 2020 2020 2069 6620 7365 6c66           if self
-000412f0: 2e74 696d 655f 7365 7269 6573 203d 3d20  .time_series == 
-00041300: 2773 6c69 6469 6e67 273a 0a20 2020 2020  'sliding':.     
-00041310: 2020 2020 2020 2020 2020 2020 2020 2070                 p
-00041320: 7269 6e74 2827 5065 7266 6f72 6d69 6e67  rint('Performing
-00041330: 2073 6c69 6469 6e67 2077 696e 646f 7720   sliding window 
-00041340: 7469 6d65 2073 6572 6965 7320 7370 6c69  time series spli
-00041350: 742e 2e2e 2729 0a20 2020 2020 2020 2020  t...').         
-00041360: 2020 2020 2020 2020 2020 206b 666f 6c64             kfold
-00041370: 203d 2053 6c69 6469 6e67 5469 6d65 5365   = SlidingTimeSe
-00041380: 7269 6573 5370 6c69 7428 6e5f 7370 6c69  riesSplit(n_spli
-00041390: 7473 3d6e 756d 5f73 706c 6974 732c 2066  ts=num_splits, f
-000413a0: 6978 6564 5f6c 656e 6774 683d 5472 7565  ixed_length=True
-000413b0: 2c20 7472 6169 6e5f 7370 6c69 7473 3d32  , train_splits=2
-000413c0: 2c20 7465 7374 5f73 706c 6974 733d 3129  , test_splits=1)
-000413d0: 0a20 2020 2020 2020 2020 2020 2020 2020  .               
-000413e0: 2065 6c73 653a 0a20 2020 2020 2020 2020   else:.         
-000413f0: 2020 2020 2020 2020 2020 2070 7269 6e74             print
-00041400: 2827 5065 7266 6f72 6d69 6e67 2065 7870  ('Performing exp
-00041410: 616e 6469 6e67 2077 696e 646f 7720 7469  anding window ti
-00041420: 6d65 2073 6572 6965 7320 7370 6c69 742e  me series split.
-00041430: 2e2e 2729 0a20 2020 2020 2020 2020 2020  ..').           
-00041440: 2020 2020 2020 2020 206b 666f 6c64 203d           kfold =
-00041450: 2054 696d 6553 6572 6965 7353 706c 6974   TimeSeriesSplit
-00041460: 286e 5f73 706c 6974 733d 6e75 6d5f 7370  (n_splits=num_sp
-00041470: 6c69 7473 290a 2020 2020 2020 2020 2020  lits).          
-00041480: 2020 656c 7365 3a0a 2020 2020 2020 2020    else:.        
-00041490: 2020 2020 2020 2020 7072 696e 7428 2750          print('P
-000414a0: 6572 666f 726d 696e 6720 6578 7061 6e64  erforming expand
-000414b0: 696e 6720 7769 6e64 6f77 2074 696d 6520  ing window time 
-000414c0: 7365 7269 6573 2073 706c 6974 2e2e 2e27  series split...'
-000414d0: 290a 2020 2020 2020 2020 2020 2020 2020  ).              
-000414e0: 2020 6b66 6f6c 6420 3d20 5469 6d65 5365    kfold = TimeSe
-000414f0: 7269 6573 5370 6c69 7428 6e5f 7370 6c69  riesSplit(n_spli
-00041500: 7473 3d6e 756d 5f73 706c 6974 7329 0a20  ts=num_splits). 
-00041510: 2020 2020 2020 2065 6c73 653a 0a20 2020         else:.   
-00041520: 2020 2020 2020 2020 2070 7269 6e74 2827           print('
-00041530: 5065 7266 6f72 6d69 6e67 204b 466f 6c64  Performing KFold
-00041540: 2072 6567 756c 6172 2073 706c 6974 2e2e   regular split..
-00041550: 2e27 290a 2020 2020 2020 2020 2020 2020  .').            
-00041560: 6b66 6f6c 6420 3d20 5265 7065 6174 6564  kfold = Repeated
-00041570: 4b46 6f6c 6428 6e5f 7370 6c69 7473 3d6e  KFold(n_splits=n
-00041580: 756d 5f73 706c 6974 732c 2072 616e 646f  um_splits, rando
-00041590: 6d5f 7374 6174 653d 7365 6564 2c20 6e5f  m_state=seed, n_
-000415a0: 7265 7065 6174 733d 6e75 6d5f 7265 7065  repeats=num_repe
-000415b0: 6174 7329 0a20 2020 2020 2020 2023 2323  ats).        ###
-000415c0: 2323 2323 2323 2323 2323 2323 2323 2323  ################
-000415d0: 2323 2323 2323 2323 2323 2323 2323 2323  ################
-000415e0: 2323 2323 2323 2323 2323 2323 2323 2323  ################
-000415f0: 2323 2323 2323 2323 2323 2323 2323 2323  ################
-00041600: 2323 2323 2323 2323 2323 2323 2323 2323  ################
-00041610: 230a 2020 2020 2020 2020 6e75 6d5f 6974  #.        num_it
-00041620: 6572 6174 696f 6e73 203d 2069 6e74 286e  erations = int(n
-00041630: 756d 5f73 706c 6974 7320 2a20 6e75 6d5f  um_splits * num_
-00041640: 7265 7065 6174 7329 0a20 2020 2020 2020  repeats).       
-00041650: 2073 636f 7269 6e67 203d 2027 6e65 675f   scoring = 'neg_
-00041660: 6d65 616e 5f73 7175 6172 6564 5f65 7272  mean_squared_err
-00041670: 6f72 270a 2020 2020 2020 2020 7072 696e  or'.        prin
-00041680: 7428 2720 2020 204e 756d 2e20 6573 7469  t('    Num. esti
-00041690: 6d61 746f 7273 203d 2025 7320 2877 696c  mators = %s (wil
-000416a0: 6c20 6265 206c 6172 6765 7220 7468 616e  l be larger than
-000416b0: 206e 5f65 7374 696d 6174 6f72 7320 7369   n_estimators si
-000416c0: 6e63 6520 6b66 6f6c 6420 6973 2072 6570  nce kfold is rep
-000416d0: 6561 7465 6420 7477 6963 6529 2720 256e  eated twice)' %n
-000416e0: 756d 5f69 7465 7261 7469 6f6e 7329 0a20  um_iterations). 
-000416f0: 2020 2020 2020 2023 2323 2323 2054 6869         ##### Thi
-00041700: 7320 6973 2077 6865 7265 2077 6520 6368  s is where we ch
-00041710: 6563 6b20 6966 2079 2069 7320 7369 6e67  eck if y is sing
-00041720: 6c65 206c 6162 656c 206f 7220 6d75 6c74  le label or mult
-00041730: 692d 6c61 6265 6c20 2323 0a20 2020 2020  i-label ##.     
-00041740: 2020 2069 6620 6973 696e 7374 616e 6365     if isinstance
-00041750: 2879 2c20 7064 2e44 6174 6146 7261 6d65  (y, pd.DataFrame
-00041760: 293a 0a20 2020 2020 2020 2020 2020 2069  ):.            i
-00041770: 6620 7365 6c66 2e6c 6f67 5f74 7261 6e73  f self.log_trans
-00041780: 666f 726d 3a0a 2020 2020 2020 2020 2020  form:.          
-00041790: 2020 2020 2020 6966 2073 656c 662e 7665        if self.ve
-000417a0: 7262 6f73 653a 0a20 2020 2020 2020 2020  rbose:.         
-000417b0: 2020 2020 2020 2020 2020 2070 7269 6e74             print
-000417c0: 2827 2020 2020 6c6f 6720 7472 616e 7366  ('    log transf
-000417d0: 6f72 6d69 6e67 2074 6172 6765 7420 7661  orming target va
-000417e0: 7269 6162 6c65 3a20 656e 7375 7265 206e  riable: ensure n
-000417f0: 6f20 7a65 726f 7320 696e 2074 6172 6765  o zeros in targe
-00041800: 742e 204f 7468 6572 7769 7365 2065 7272  t. Otherwise err
-00041810: 6f72 2e27 290a 2020 2020 2020 2020 2020  or.').          
-00041820: 2020 2020 2020 7472 793a 0a20 2020 2020        try:.     
-00041830: 2020 2020 2020 2020 2020 2020 2020 2079                 y
-00041840: 203d 206e 702e 6c6f 6731 7028 7929 0a20   = np.log1p(y). 
-00041850: 2020 2020 2020 2020 2020 2020 2020 2065                 e
-00041860: 7863 6570 743a 0a20 2020 2020 2020 2020  xcept:.         
-00041870: 2020 2020 2020 2020 2020 2070 7269 6e74             print
-00041880: 2827 2020 2020 4572 726f 723a 206c 6f67  ('    Error: log
-00041890: 2074 7261 6e73 666f 726d 696e 6720 7461   transforming ta
-000418a0: 7267 6574 732e 2052 656d 6f76 6520 7a65  rgets. Remove ze
-000418b0: 726f 7320 696e 2074 6172 6765 7420 616e  ros in target an
-000418c0: 6420 7472 7920 6167 6169 6e2e 2729 0a20  d try again.'). 
-000418d0: 2020 2020 2020 2020 2020 2020 2020 2020                  
-000418e0: 2020 2072 6574 7572 6e20 7365 6c66 0a20     return self. 
-000418f0: 2020 2020 2020 2020 2020 2023 2323 2323             #####
-00041900: 2323 2323 2323 2323 2323 2323 2323 2323  ################
-00041910: 2323 2323 2323 2323 2323 2323 2323 2323  ################
-00041920: 2323 2323 2323 2323 2323 2323 2323 2323  ################
-00041930: 2323 2323 2323 2323 2323 0a20 2020 2020  ##########.     
-00041940: 2020 2020 2020 2023 2323 2054 6869 7320         ### This 
-00041950: 6973 2066 6f72 204d 756c 7469 2d4c 6162  is for Multi-Lab
-00041960: 656c 2052 6567 7265 7373 696f 6e20 7072  el Regression pr
-00041970: 6f62 6c65 6d73 206f 6e6c 7920 2323 2323  oblems only ####
-00041980: 2323 2323 2323 2323 2323 2323 2323 2323  ################
-00041990: 230a 2020 2020 2020 2020 2020 2020 2323  #.            ##
-000419a0: 2323 2323 2323 2323 2323 2323 2323 2323  ################
-000419b0: 2323 2323 2323 2323 2323 2323 2323 2323  ################
-000419c0: 2323 2323 2323 2323 2323 2323 2323 2323  ################
-000419d0: 2323 2323 2323 2323 2323 2323 230a 2020  #############.  
-000419e0: 2020 2020 2020 2020 2020 7461 7267 6574            target
-000419f0: 7320 3d20 792e 636f 6c75 6d6e 732e 746f  s = y.columns.to
-00041a00: 6c69 7374 2829 0a20 2020 2020 2020 2020  list().         
-00041a10: 2020 2069 6620 6973 5f79 5f6f 626a 6563     if is_y_objec
-00041a20: 7428 7929 3a0a 2020 2020 2020 2020 2020  t(y):.          
-00041a30: 2020 2020 2020 7072 696e 7428 2743 616e        print('Can
-00041a40: 6e6f 7420 7065 7266 6f72 6d20 5265 6772  not perform Regr
-00041a50: 6573 7369 6f6e 2075 7369 6e67 206f 626a  ession using obj
-00041a60: 6563 7420 6f72 2073 7472 696e 6720 7461  ect or string ta
-00041a70: 7267 6574 732e 2050 6c65 6173 6520 636f  rgets. Please co
-00041a80: 6e76 6572 7420 746f 206e 756d 6572 6963  nvert to numeric
-00041a90: 2061 6e64 2074 7279 2061 6761 696e 2e27   and try again.'
-00041aa0: 290a 2020 2020 2020 2020 2020 2020 2020  ).              
-00041ab0: 2020 7265 7475 726e 2073 656c 660a 2020    return self.  
-00041ac0: 2020 2020 2020 2020 2020 6966 206c 656e            if len
-00041ad0: 2874 6172 6765 7473 2920 3e20 313a 0a20  (targets) > 1:. 
-00041ae0: 2020 2020 2020 2020 2020 2020 2020 2073                 s
-00041af0: 656c 662e 6d75 6c74 695f 6c61 6265 6c20  elf.multi_label 
-00041b00: 3d20 792e 636f 6c75 6d6e 732e 746f 6c69  = y.columns.toli
-00041b10: 7374 2829 0a20 2020 2020 2020 2020 2020  st().           
-00041b20: 2020 2020 2023 2323 2059 6f75 206e 6565       ### You nee
-00041b30: 6420 746f 2069 6e69 7469 616c 697a 6520  d to initialize 
-00041b40: 7468 6520 636c 6173 7320 6265 666f 7265  the class before
-00041b50: 2065 6163 6820 7275 6e20 2d20 6f74 6865   each run - othe
-00041b60: 7277 6973 652c 2065 7272 6f72 210a 2020  rwise, error!.  
-00041b70: 2020 2020 2020 2020 2020 2020 2020 2323                ##
-00041b80: 2320 5265 6d65 6d62 6572 2077 6520 646f  # Remember we do
-00041b90: 6e27 7420 746f 2048 5054 2054 756e 696e  n't to HPT Tunin
-00041ba0: 6720 666f 7220 4d75 6c74 692d 6c61 6265  g for Multi-labe
-00041bb0: 6c20 7072 6f62 6c65 6d73 2073 696e 6365  l problems since
-00041bc0: 2069 7420 6572 726f 7273 2023 2323 230a   it errors ####.
-00041bd0: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00041be0: 6920 3d20 300a 2020 2020 2020 2020 2020  i = 0.          
-00041bf0: 2020 2020 2020 666f 7220 7472 6169 6e5f        for train_
-00041c00: 696e 6465 782c 2074 6573 745f 696e 6465  index, test_inde
-00041c10: 7820 696e 2074 7164 6d28 6b66 6f6c 642e  x in tqdm(kfold.
-00041c20: 7370 6c69 7428 582c 2079 292c 2074 6f74  split(X, y), tot
-00041c30: 616c 3d6b 666f 6c64 2e67 6574 5f6e 5f73  al=kfold.get_n_s
-00041c40: 706c 6974 7328 292c 200a 2020 2020 2020  plits(), .      
-00041c50: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00041c60: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00041c70: 2020 6465 7363 3d22 6b2d 666f 6c64 2074    desc="k-fold t
-00041c80: 7261 696e 696e 6722 293a 0a20 2020 2020  raining"):.     
-00041c90: 2020 2020 2020 2020 2020 2020 2020 2073                 s
-00041ca0: 7461 7274 5f74 696d 6520 3d20 7469 6d65  tart_time = time
-00041cb0: 2e74 696d 6528 290a 2020 2020 2020 2020  .time().        
-00041cc0: 2020 2020 2020 2020 2020 2020 2372 616e              #ran
-00041cd0: 646f 6d5f 7365 6564 203d 206e 702e 7261  dom_seed = np.ra
-00041ce0: 6e64 6f6d 2e72 616e 6469 6e74 2832 2c31  ndom.randint(2,1
-00041cf0: 3030 290a 2020 2020 2020 2020 2020 2020  00).            
-00041d00: 2020 2020 2020 2020 7261 6e64 6f6d 5f73          random_s
-00041d10: 6565 6420 3d20 3939 390a 2020 2020 2020  eed = 999.      
-00041d20: 2020 2020 2020 2020 2020 2020 2020 6966                if
-00041d30: 2073 656c 662e 6261 7365 5f65 7374 696d   self.base_estim
-00041d40: 6174 6f72 2069 7320 4e6f 6e65 3a0a 2020  ator is None:.  
-00041d50: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00041d60: 2020 2020 2020 2323 2323 2323 2323 2323        ##########
-00041d70: 2323 2323 2323 2323 2323 2323 2323 2323  ################
-00041d80: 2323 2323 2323 2323 2323 2323 2323 2323  ################
-00041d90: 2323 2323 2323 2323 2323 2323 2323 2323  ################
-00041da0: 2323 2323 2323 0a20 2020 2020 2020 2020  ######.         
-00041db0: 2020 2020 2020 2020 2020 2020 2020 2023                 #
-00041dc0: 2323 2020 2054 6869 7320 6973 2066 6f72  ##   This is for
-00041dd0: 2053 696e 676c 6520 4c61 6265 6c20 5265   Single Label Re
-00041de0: 6772 6573 7369 6f6e 2070 726f 626c 656d  gression problem
-00041df0: 7320 6f6e 6c79 2023 2323 2323 2323 230a  s only ########.
-00041e00: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00041e10: 2020 2020 2020 2020 2323 2320 2020 4d61          ###   Ma
-00041e20: 6b65 2073 7572 6520 796f 7520 646f 6e27  ke sure you don'
-00041e30: 7420 646f 2069 6d62 616c 616e 6365 6420  t do imbalanced 
-00041e40: 534d 4f54 4520 776f 726b 2068 6572 6520  SMOTE work here 
-00041e50: 2023 2323 2323 2323 0a20 2020 2020 2020   #######.       
-00041e60: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00041e70: 2023 2323 2323 2323 2323 2323 2323 2323   ###############
-00041e80: 2323 2323 2323 2323 2323 2323 2323 2323  ################
-00041e90: 2323 2323 2323 2323 2323 2323 2323 2323  ################
-00041ea0: 2323 2323 2323 2323 2323 2323 2323 2323  ################
-00041eb0: 230a 2020 2020 2020 2020 2020 2020 2020  #.              
-00041ec0: 2020 2020 2020 2020 2020 6966 2079 2e73            if y.s
-00041ed0: 6861 7065 5b30 5d20 3c3d 2072 6f77 5f6c  hape[0] <= row_l
-00041ee0: 696d 6974 3a0a 2020 2020 2020 2020 2020  imit:.          
+0003f2d0: 2020 2020 2020 2070 7269 6e74 2827 2020         print('  
+0003f2e0: 2020 4669 7474 696e 6720 7769 7468 2052    Fitting with R
+0003f2f0: 6567 7265 7373 6f72 4368 6169 6e2e 2e2e  egressorChain...
+0003f300: 2729 0a20 2020 2020 2020 2020 2020 2020  ').             
+0003f310: 2020 2020 2020 2020 2020 2065 7374 5f6c             est_l
+0003f320: 6973 7420 3d20 5b52 6567 7265 7373 6f72  ist = [Regressor
+0003f330: 4368 6169 6e28 7365 6c66 2e62 6173 655f  Chain(self.base_
+0003f340: 6573 7469 6d61 746f 722c 206f 7264 6572  estimator, order
+0003f350: 3d4e 6f6e 652c 2072 616e 646f 6d5f 7374  =None, random_st
+0003f360: 6174 653d 6929 0a20 2020 2020 2020 2020  ate=i).         
+0003f370: 2020 2020 2020 2020 2020 2020 2020 2020                  
+0003f380: 2020 2020 2020 2020 2020 2066 6f72 2069             for i
+0003f390: 2069 6e20 7261 6e67 6528 6e75 6d5f 6974   in range(num_it
+0003f3a0: 6572 6174 696f 6e73 295d 200a 0a20 2020  erations)] ..   
+0003f3b0: 2020 2020 2020 2020 2020 2020 2020 2020                  
+0003f3c0: 2023 2049 6e69 7469 616c 697a 6520 6d6f   # Initialize mo
+0003f3d0: 6465 6c20 7769 7468 2079 6f75 7220 7375  del with your su
+0003f3e0: 7065 7276 6973 6564 2061 6c67 6f72 6974  pervised algorit
+0003f3f0: 686d 206f 6620 6368 6f69 6365 0a20 2020  hm of choice.   
+0003f400: 2020 2020 2020 2020 2020 2020 2020 2020                  
+0003f410: 206d 6f64 656c 203d 2065 7374 5f6c 6973   model = est_lis
+0003f420: 745b 695d 0a0a 2020 2020 2020 2020 2020  t[i]..          
+0003f430: 2020 2020 2020 2020 2020 2320 5472 6169            # Trai
+0003f440: 6e20 6d6f 6465 6c20 616e 6420 7573 6520  n model and use 
+0003f450: 6974 2074 6f20 7472 6169 6e20 6f6e 2074  it to train on t
+0003f460: 6865 2066 6f6c 640a 2020 2020 2020 2020  he fold.        
+0003f470: 2020 2020 2020 2020 2020 2020 6966 2073              if s
+0003f480: 656c 662e 7069 7065 6c69 6e65 3a0a 2020  elf.pipeline:.  
+0003f490: 2020 2020 2020 2020 2020 2020 2020 2020                  
+0003f4a0: 2020 2020 2020 2323 2320 5468 6973 2069        ### This i
+0003f4b0: 7320 6f6e 6c79 2077 6974 6820 6120 7069  s only with a pi
+0003f4c0: 7065 6c69 6e65 2023 2323 2323 2323 230a  peline ########.
+0003f4d0: 2020 2020 2020 2020 2020 2020 2020 2020                  
+0003f4e0: 2020 2020 2020 2020 7069 7065 203d 2050          pipe = P
+0003f4f0: 6970 656c 696e 6528 0a20 2020 2020 2020  ipeline(.       
+0003f500: 2020 2020 2020 2020 2020 2020 2020 2020                  
+0003f510: 2020 2020 2073 7465 7073 3d5b 2822 7072       steps=[("pr
+0003f520: 6570 726f 6365 7373 6f72 222c 2070 7265  eprocessor", pre
+0003f530: 7072 6f63 6573 736f 7229 2c20 2822 6d6f  processor), ("mo
+0003f540: 6465 6c22 2c20 6d6f 6465 6c29 5d0a 2020  del", model)].  
+0003f550: 2020 2020 2020 2020 2020 2020 2020 2020                  
+0003f560: 2020 2020 2020 290a 0a20 2020 2020 2020        )..       
+0003f570: 2020 2020 2020 2020 2020 2020 2020 2020                  
+0003f580: 2070 6970 652e 6669 7428 785f 7472 6169   pipe.fit(x_trai
+0003f590: 6e2c 2079 5f74 7261 696e 290a 2020 2020  n, y_train).    
+0003f5a0: 2020 2020 2020 2020 2020 2020 2020 2020                  
+0003f5b0: 2020 2020 7365 6c66 2e6d 6f64 656c 732e      self.models.
+0003f5c0: 6170 7065 6e64 2870 6970 6529 0a0a 2020  append(pipe)..  
+0003f5d0: 2020 2020 2020 2020 2020 2020 2020 2020                  
+0003f5e0: 2020 2020 2020 2320 5072 6564 6963 7420        # Predict 
+0003f5f0: 6f6e 2072 656d 6169 6e69 6e67 2064 6174  on remaining dat
+0003f600: 6120 6f66 2065 6163 6820 666f 6c64 0a20  a of each fold. 
+0003f610: 2020 2020 2020 2020 2020 2020 2020 2020                  
+0003f620: 2020 2020 2020 2070 7265 6473 203d 2070         preds = p
+0003f630: 6970 652e 7072 6564 6963 7428 785f 7465  ipe.predict(x_te
+0003f640: 7374 290a 0a20 2020 2020 2020 2020 2020  st)..           
+0003f650: 2020 2020 2020 2020 2065 6c73 653a 0a20           else:. 
+0003f660: 2020 2020 2020 2020 2020 2020 2020 2020                  
+0003f670: 2020 2020 2020 2023 2323 2320 5468 6973         #### This
+0003f680: 2069 7320 7769 7468 6f75 7420 6120 7069   is without a pi
+0003f690: 7065 6c69 6e65 2023 2323 0a20 2020 2020  peline ###.     
+0003f6a0: 2020 2020 2020 2020 2020 2020 2020 2020                  
+0003f6b0: 2020 206d 6f64 656c 2e66 6974 2878 5f74     model.fit(x_t
+0003f6c0: 7261 696e 2c20 795f 7472 6169 6e29 0a20  rain, y_train). 
+0003f6d0: 2020 2020 2020 2020 2020 2020 2020 2020                  
+0003f6e0: 2020 2020 2020 2073 656c 662e 6d6f 6465         self.mode
+0003f6f0: 6c73 2e61 7070 656e 6428 6d6f 6465 6c29  ls.append(model)
+0003f700: 0a0a 2020 2020 2020 2020 2020 2020 2020  ..              
+0003f710: 2020 2020 2020 2020 2020 2320 5072 6564            # Pred
+0003f720: 6963 7420 6f6e 2072 656d 6169 6e69 6e67  ict on remaining
+0003f730: 2064 6174 6120 6f66 2065 6163 6820 666f   data of each fo
+0003f740: 6c64 0a20 2020 2020 2020 2020 2020 2020  ld.             
+0003f750: 2020 2020 2020 2020 2020 2070 7265 6473             preds
+0003f760: 203d 206d 6f64 656c 2e70 7265 6469 6374   = model.predict
+0003f770: 2878 5f74 6573 7429 0a0a 2020 2020 2020  (x_test)..      
+0003f780: 2020 2020 2020 2020 2020 2020 2020 2020                  
+0003f790: 2020 6966 2073 656c 662e 6c6f 675f 7472    if self.log_tr
+0003f7a0: 616e 7366 6f72 6d3a 0a20 2020 2020 2020  ansform:.       
+0003f7b0: 2020 2020 2020 2020 2020 2020 2020 2020                  
+0003f7c0: 2020 2020 2070 7265 6473 203d 206e 702e       preds = np.
+0003f7d0: 6578 706d 3128 7072 6564 7329 0a20 2020  expm1(preds).   
+0003f7e0: 2020 2020 2020 2020 2020 2020 2020 2020                  
+0003f7f0: 2020 2020 2065 6c69 6620 7365 6c66 2e69       elif self.i
+0003f800: 6e74 6567 6572 735f 6f6e 6c79 3a0a 2020  ntegers_only:.  
+0003f810: 2020 2020 2020 2020 2020 2020 2020 2020                  
+0003f820: 2020 2020 2020 2020 2020 2323 2320 5573            ### Us
+0003f830: 6520 5265 6772 6573 7369 6f6e 2070 7265  e Regression pre
+0003f840: 6469 6374 696f 6e73 2061 6e64 2063 6f6e  dictions and con
+0003f850: 7665 7274 2074 6865 6d20 696e 746f 2069  vert them into i
+0003f860: 6e74 6567 6572 7320 6865 7265 2023 230a  ntegers here ##.
+0003f870: 2020 2020 2020 2020 2020 2020 2020 2020                  
+0003f880: 2020 2020 2020 2020 2020 2020 7072 6564              pred
+0003f890: 7320 3d20 6e70 2e72 6f75 6e64 2870 7265  s = np.round(pre
+0003f8a0: 6473 2c30 292e 6173 7479 7065 2869 6e74  ds,0).astype(int
+0003f8b0: 290a 2020 2020 2020 2020 2020 2020 2020  ).              
+0003f8c0: 2020 2020 2020 2020 2020 2020 2020 0a20                . 
+0003f8d0: 2020 2020 2020 2020 2020 2020 2020 2020                  
+0003f8e0: 2020 2073 636f 7265 203d 2070 7269 6e74     score = print
+0003f8f0: 5f72 6567 7265 7373 696f 6e5f 6d6f 6465  _regression_mode
+0003f900: 6c5f 7374 6174 7328 795f 7465 7374 2c20  l_stats(y_test, 
+0003f910: 7072 6564 732c 2073 656c 662e 7665 7262  preds, self.verb
+0003f920: 6f73 6529 0a20 2020 2020 2020 2020 2020  ose).           
+0003f930: 2020 2020 2020 2020 2069 6620 6920 3d3d           if i ==
+0003f940: 2030 3a0a 2020 2020 2020 2020 2020 2020   0:.            
+0003f950: 2020 2020 2020 2020 2020 2020 795f 7374              y_st
+0003f960: 6163 6b20 3d20 636f 7079 2e64 6565 7063  ack = copy.deepc
+0003f970: 6f70 7928 795f 7465 7374 290a 2020 2020  opy(y_test).    
+0003f980: 2020 2020 2020 2020 2020 2020 2020 2020                  
+0003f990: 2020 2020 7072 6564 5f73 7461 636b 203d      pred_stack =
+0003f9a0: 2063 6f70 792e 6465 6570 636f 7079 2870   copy.deepcopy(p
+0003f9b0: 7265 6473 290a 2020 2020 2020 2020 2020  reds).          
+0003f9c0: 2020 2020 2020 2020 2020 656c 7365 3a0a            else:.
+0003f9d0: 2020 2020 2020 2020 2020 2020 2020 2020                  
+0003f9e0: 2020 2020 2020 2020 795f 7374 6163 6b20          y_stack 
+0003f9f0: 3d20 7064 2e63 6f6e 6361 7428 5b79 5f73  = pd.concat([y_s
+0003fa00: 7461 636b 2c79 5f74 6573 745d 2c20 6178  tack,y_test], ax
+0003fa10: 6973 3d30 290a 2020 2020 2020 2020 2020  is=0).          
+0003fa20: 2020 2020 2020 2020 2020 2020 2020 7072                pr
+0003fa30: 6564 5f73 7461 636b 203d 206e 702e 725f  ed_stack = np.r_
+0003fa40: 5b70 7265 645f 7374 6163 6b2c 7072 6564  [pred_stack,pred
+0003fa50: 735d 0a0a 2020 2020 2020 2020 2020 2020  s]..            
+0003fa60: 2020 2020 2020 2020 6966 2073 656c 662e          if self.
+0003fa70: 7665 7262 6f73 653a 0a20 2020 2020 2020  verbose:.       
+0003fa80: 2020 2020 2020 2020 2020 2020 2020 2020                  
+0003fa90: 2070 7269 6e74 2822 2020 2020 466f 6c64   print("    Fold
+0003faa0: 2025 733a 206f 7574 2d6f 662d 666f 6c64   %s: out-of-fold
+0003fab0: 2052 4d53 4520 2873 6d61 6c6c 6572 2069   RMSE (smaller i
+0003fac0: 7320 6265 7474 6572 293a 2025 302e 3366  s better): %0.3f
+0003fad0: 2220 2528 692b 312c 2073 636f 7265 2929  " %(i+1, score))
+0003fae0: 0a20 2020 2020 2020 2020 2020 2020 2020  .               
+0003faf0: 2020 2020 2073 656c 662e 7363 6f72 6573       self.scores
+0003fb00: 2e61 7070 656e 6428 7363 6f72 6529 0a20  .append(score). 
+0003fb10: 2020 2020 2020 2020 2020 2020 2020 2020                  
+0003fb20: 2020 200a 2020 2020 2020 2020 2020 2020     .            
+0003fb30: 2020 2020 2020 2020 2320 4669 6e61 6c6c          # Finall
+0003fb40: 792c 2063 6865 636b 206f 7574 2074 6865  y, check out the
+0003fb50: 2074 6f74 616c 2074 696d 6520 7461 6b65   total time take
+0003fb60: 6e0a 2020 2020 2020 2020 2020 2020 2020  n.              
+0003fb70: 2020 2020 2020 656e 645f 7469 6d65 203d        end_time =
+0003fb80: 2074 696d 652e 7469 6d65 2829 0a20 2020   time.time().   
+0003fb90: 2020 2020 2020 2020 2020 2020 2020 2020                  
+0003fba0: 2074 696d 6554 616b 656e 203d 2065 6e64   timeTaken = end
+0003fbb0: 5f74 696d 6520 2d20 7374 6172 745f 7469  _time - start_ti
+0003fbc0: 6d65 0a20 2020 2020 2020 2020 2020 2020  me.             
+0003fbd0: 2020 2020 2020 2069 6620 7365 6c66 2e76         if self.v
+0003fbe0: 6572 626f 7365 3a0a 2020 2020 2020 2020  erbose:.        
+0003fbf0: 2020 2020 2020 2020 2020 2020 2020 2020                  
+0003fc00: 7072 696e 7428 2254 696d 6520 5461 6b65  print("Time Take
+0003fc10: 6e20 666f 7220 666f 6c64 2025 733a 2025  n for fold %s: %
+0003fc20: 302e 3066 2028 7365 636f 6e64 7329 2220  0.0f (seconds)" 
+0003fc30: 2528 692b 312c 2074 696d 6554 616b 656e  %(i+1, timeTaken
+0003fc40: 2929 0a20 2020 2020 2020 2020 2020 2020  )).             
+0003fc50: 2020 200a 2020 2020 2020 2020 2020 2020     .            
+0003fc60: 2020 2020 2020 2020 6920 2b3d 2031 0a0a          i += 1..
+0003fc70: 2020 2020 2020 2020 2020 2020 2020 2020                  
+0003fc80: 2320 436f 6d70 7574 6520 6176 6572 6167  # Compute averag
+0003fc90: 6520 7363 6f72 650a 2020 2020 2020 2020  e score.        
+0003fca0: 2020 2020 2020 2020 7072 696e 7428 2223          print("#
+0003fcb0: 2323 2323 2323 2320 4669 6e61 6c20 5265  ####### Final Re
+0003fcc0: 6772 6573 736f 7220 6d65 7472 6963 733a  gressor metrics:
+0003fcd0: 2023 2323 2323 2323 2323 2323 2323 2322   ##############"
+0003fce0: 290a 2020 2020 2020 2020 2020 2020 2020  ).              
+0003fcf0: 2020 6e6f 726d 6176 6572 6167 6541 6363    normaverageAcc
+0003fd00: 7572 6163 7920 3d20 7072 696e 745f 7265  uracy = print_re
+0003fd10: 6772 6573 7369 6f6e 5f6d 6f64 656c 5f73  gression_model_s
+0003fd20: 7461 7473 2879 5f73 7461 636b 2c20 7072  tats(y_stack, pr
+0003fd30: 6564 5f73 7461 636b 2c20 7365 6c66 2e76  ed_stack, self.v
+0003fd40: 6572 626f 7365 290a 2020 2020 2020 2020  erbose).        
+0003fd50: 2020 2020 2020 2020 656e 6420 3d20 7469          end = ti
+0003fd60: 6d65 2e74 696d 6528 290a 2020 2020 2020  me.time().      
+0003fd70: 2020 2020 2020 2020 2020 7469 6d65 5461            timeTa
+0003fd80: 6b65 6e20 3d20 656e 6420 2d20 7374 6172  ken = end - star
+0003fd90: 740a 2020 2020 2020 2020 2020 2020 2020  t.              
+0003fda0: 2020 7072 696e 7428 2254 696d 6520 5461    print("Time Ta
+0003fdb0: 6b65 6e20 6f76 6572 616c 6c3a 2025 302e  ken overall: %0.
+0003fdc0: 3066 2028 7365 636f 6e64 7329 2220 2528  0f (seconds)" %(
+0003fdd0: 7469 6d65 5461 6b65 6e29 290a 2020 2020  timeTaken)).    
+0003fde0: 2020 2020 2020 2020 2020 2020 7365 6c66              self
+0003fdf0: 2e6b 6620 3d20 6b66 6f6c 640a 2020 2020  .kf = kfold.    
+0003fe00: 2020 2020 2020 2020 2020 2020 7265 7475              retu
+0003fe10: 726e 2073 656c 660a 2020 2020 2020 2020  rn self.        
+0003fe20: 2323 2323 2323 2323 2323 2323 2323 2323  ################
+0003fe30: 2323 2323 2323 2323 2323 2323 2323 2323  ################
+0003fe40: 2323 2323 2323 2323 2323 2323 2323 2323  ################
+0003fe50: 2323 2323 2323 2323 0a20 2020 2020 2020  ########.       
+0003fe60: 2023 2323 2323 2020 5468 6973 2069 7320   #####  This is 
+0003fe70: 666f 7220 5369 6e67 6c65 204c 6162 656c  for Single Label
+0003fe80: 2052 6567 7265 7373 696f 6e20 7072 6f62   Regression prob
+0003fe90: 6c65 6d73 200a 2020 2020 2020 2020 2323  lems .        ##
+0003fea0: 2323 2323 2323 2323 2323 2323 2323 2323  ################
+0003feb0: 2323 2323 2323 2323 2323 2323 2323 2323  ################
+0003fec0: 2323 2323 2323 2323 2323 2323 2323 2323  ################
+0003fed0: 2323 2323 2323 0a20 2020 2020 2020 2069  ######.        i
+0003fee0: 6620 6973 696e 7374 616e 6365 2879 2c20  f isinstance(y, 
+0003fef0: 7064 2e53 6572 6965 7329 3a0a 2020 2020  pd.Series):.    
+0003ff00: 2020 2020 2020 2020 7461 7267 6574 7320          targets 
+0003ff10: 3d20 792e 6e61 6d65 0a20 2020 2020 2020  = y.name.       
+0003ff20: 2065 6c73 653a 0a20 2020 2020 2020 2020   else:.         
+0003ff30: 2020 2074 6172 6765 7473 203d 205b 5d0a     targets = [].
+0003ff40: 0a20 2020 2020 2020 2065 7374 5f6c 6973  .        est_lis
+0003ff50: 7420 3d20 6e75 6d5f 6974 6572 6174 696f  t = num_iteratio
+0003ff60: 6e73 2a5b 7365 6c66 2e62 6173 655f 6573  ns*[self.base_es
+0003ff70: 7469 6d61 746f 725d 0a20 2020 2020 2020  timator].       
+0003ff80: 200a 2020 2020 2020 2020 2323 2320 6966   .        ### if
+0003ff90: 2074 6865 7265 2069 7320 6120 6e65 6564   there is a need
+0003ffa0: 2074 6f20 646f 2053 4d4f 5445 2064 6f20   to do SMOTE do 
+0003ffb0: 6974 2068 6572 6520 2323 0a20 2020 2020  it here ##.     
+0003ffc0: 2020 2073 6d6f 7465 203d 2046 616c 7365     smote = False
+0003ffd0: 0a20 2020 2020 2020 2023 6c69 7374 5f63  .        #list_c
+0003ffe0: 6c61 7373 6573 203d 2072 6574 7572 6e5f  lasses = return_
+0003fff0: 6d69 6e6f 7269 7479 5f63 6c61 7373 6573  minority_classes
+00040000: 2879 290a 2020 2020 2020 2020 2369 6620  (y).        #if 
+00040010: 6e6f 7420 6c69 7374 5f63 6c61 7373 6573  not list_classes
+00040020: 2e65 6d70 7479 3a0a 2020 2020 2020 2020  .empty:.        
+00040030: 2320 2020 2073 6d6f 7465 203d 2054 7275  #    smote = Tru
+00040040: 650a 2020 2020 2020 2020 2323 2323 2046  e.        #### F
+00040050: 6f72 206e 6f77 2c20 646f 6e27 7420 646f  or now, don't do
+00040060: 2053 4d4f 5445 2073 696e 6365 2069 7420   SMOTE since it 
+00040070: 6973 206d 616b 696e 6720 7468 696e 6773  is making things
+00040080: 2072 6561 6c6c 7920 736c 6f77 2023 230a   really slow ##.
+00040090: 2020 2020 2020 2020 0a20 2020 2020 2020          .       
+000400a0: 2023 2050 6572 666f 726d 2043 560a 2020   # Perform CV.  
+000400b0: 2020 2020 2020 6920 3d20 300a 2020 2020        i = 0.    
+000400c0: 2020 2020 666f 7220 7472 6169 6e5f 696e      for train_in
+000400d0: 6465 782c 2074 6573 745f 696e 6465 7820  dex, test_index 
+000400e0: 696e 2074 7164 6d28 6b66 6f6c 642e 7370  in tqdm(kfold.sp
+000400f0: 6c69 7428 582c 2079 292c 2074 6f74 616c  lit(X, y), total
+00040100: 3d6b 666f 6c64 2e67 6574 5f6e 5f73 706c  =kfold.get_n_spl
+00040110: 6974 7328 292c 200a 2020 2020 2020 2020  its(), .        
+00040120: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00040130: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00040140: 2020 2020 6465 7363 3d22 6b2d 666f 6c64      desc="k-fold
+00040150: 2074 7261 696e 696e 6722 293a 0a20 2020   training"):.   
+00040160: 2020 2020 2020 2020 2073 7461 7274 5f74           start_t
+00040170: 696d 6520 3d20 7469 6d65 2e74 696d 6528  ime = time.time(
+00040180: 290a 2020 2020 2020 2020 2020 2020 7261  ).            ra
+00040190: 6e64 6f6d 5f73 6565 6420 3d20 6e70 2e72  ndom_seed = np.r
+000401a0: 616e 646f 6d2e 7261 6e64 696e 7428 322c  andom.randint(2,
+000401b0: 3130 3029 0a20 2020 2020 2020 2020 2020  100).           
+000401c0: 2069 6620 7365 6c66 2e62 6173 655f 6573   if self.base_es
+000401d0: 7469 6d61 746f 7220 6973 204e 6f6e 653a  timator is None:
+000401e0: 0a20 2020 2020 2020 2020 2020 2020 2020  .               
+000401f0: 2069 6620 6461 7461 5f73 616d 706c 6573   if data_samples
+00040200: 203c 3d20 726f 775f 6c69 6d69 743a 0a20   <= row_limit:. 
+00040210: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00040220: 2020 2023 2323 2046 6f72 2073 6d61 6c6c     ### For small
+00040230: 2064 6174 6173 6574 7320 7573 6520 5246   datasets use RF
+00040240: 5220 666f 7220 5265 6772 6573 7369 6f6e  R for Regression
+00040250: 7320 2020 2323 2323 2323 2323 2323 2323  s   ############
+00040260: 2323 2323 2323 2323 2323 2323 0a20 2020  ############.   
+00040270: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00040280: 2069 6620 6c65 6e28 7365 6c66 2e66 6561   if len(self.fea
+00040290: 7475 7265 7329 203c 3d20 6665 6174 7572  tures) <= featur
+000402a0: 6573 5f6c 696d 6974 3a0a 2020 2020 2020  es_limit:.      
+000402b0: 2020 2020 2020 2020 2020 2020 2020 2020                  
+000402c0: 2020 6966 2073 656c 662e 7665 7262 6f73    if self.verbos
+000402d0: 653a 0a20 2020 2020 2020 2020 2020 2020  e:.             
+000402e0: 2020 2020 2020 2020 2020 2020 2020 2070                 p
+000402f0: 7269 6e74 2827 2020 2020 5365 6c65 6374  rint('    Select
+00040300: 696e 6720 4261 6767 696e 6720 5265 6772  ing Bagging Regr
+00040310: 6573 736f 7220 666f 7220 7468 6973 2064  essor for this d
+00040320: 6174 6173 6574 2e2e 2e27 290a 2020 2020  ataset...').    
+00040330: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00040340: 2020 2020 2323 2320 5468 6520 4261 6767      ### The Bagg
+00040350: 696e 6720 5265 6772 6573 6f72 206f 7574  ing Regresor out
+00040360: 7065 7266 6f72 6d73 2045 5443 206d 6f73  performs ETC mos
+00040370: 7420 6f66 2074 6865 2074 696d 6520 2323  t of the time ##
+00040380: 2323 0a20 2020 2020 2020 2020 2020 2020  ##.             
+00040390: 2020 2020 2020 2020 2020 2045 5420 3d20             ET = 
+000403a0: 4578 7472 6154 7265 6552 6567 7265 7373  ExtraTreeRegress
+000403b0: 6f72 2829 0a20 2020 2020 2020 2020 2020  or().           
+000403c0: 2020 2020 2020 2020 2020 2020 2045 5420               ET 
+000403d0: 3d20 4c69 6e65 6172 5356 5228 290a 2020  = LinearSVR().  
+000403e0: 2020 2020 2020 2020 2020 2020 2020 2020                  
+000403f0: 2020 2020 2020 4554 203d 2044 6563 6973        ET = Decis
+00040400: 696f 6e54 7265 6552 6567 7265 7373 6f72  ionTreeRegressor
+00040410: 2829 0a20 2020 2020 2020 2020 2020 2020  ().             
+00040420: 2020 2020 2020 2020 2020 2073 656c 662e             self.
+00040430: 6261 7365 5f65 7374 696d 6174 6f72 203d  base_estimator =
+00040440: 2042 6167 6769 6e67 5265 6772 6573 736f   BaggingRegresso
+00040450: 7228 6261 7365 5f65 7374 696d 6174 6f72  r(base_estimator
+00040460: 203d 2045 542c 2062 6f6f 7473 7472 6170   = ET, bootstrap
+00040470: 5f66 6561 7475 7265 733d 4661 6c73 652c  _features=False,
+00040480: 0a20 2020 2020 2020 2020 2020 2020 2020  .               
+00040490: 2020 2020 2020 2020 2020 2020 2020 2020                  
+000404a0: 2020 2020 2020 2020 2020 2020 2020 2020                  
+000404b0: 2020 2020 2020 2020 2020 2020 206e 5f6a               n_j
+000404c0: 6f62 733d 2d31 2c20 7261 6e64 6f6d 5f73  obs=-1, random_s
+000404d0: 7461 7465 3d72 616e 646f 6d5f 7365 6564  tate=random_seed
+000404e0: 290a 2020 2020 2020 2020 2020 2020 2020  ).              
+000404f0: 2020 2020 2020 2020 2020 7365 6c66 2e6d            self.m
+00040500: 6f64 656c 5f6e 616d 6520 3d20 2762 6727  odel_name = 'bg'
+00040510: 0a20 2020 2020 2020 2020 2020 2020 2020  .               
+00040520: 2020 2020 2065 6c73 653a 0a20 2020 2020       else:.     
+00040530: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00040540: 2020 2069 6620 2858 2e64 7479 7065 733d     if (X.dtypes=
+00040550: 3d66 6c6f 6174 292e 616c 6c28 293a 0a20  =float).all():. 
+00040560: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00040570: 2020 2020 2020 2020 2020 2069 6620 7365             if se
+00040580: 6c66 2e76 6572 626f 7365 3a0a 2020 2020  lf.verbose:.    
+00040590: 2020 2020 2020 2020 2020 2020 2020 2020                  
+000405a0: 2020 2020 2020 2020 2020 2020 7072 696e              prin
+000405b0: 7428 2720 2020 2053 656c 6563 7469 6e67  t('    Selecting
+000405c0: 2052 6964 6765 2061 7320 6261 7365 5f65   Ridge as base_e
+000405d0: 7374 696d 6174 6f72 2e20 4665 656c 2066  stimator. Feel f
+000405e0: 7265 6520 746f 2073 656e 6420 696e 2079  ree to send in y
+000405f0: 6f75 7220 6f77 6e20 6573 7469 6d61 746f  our own estimato
+00040600: 722e 2729 0a20 2020 2020 2020 2020 2020  r.').           
+00040610: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00040620: 2073 656c 662e 6261 7365 5f65 7374 696d   self.base_estim
+00040630: 6174 6f72 203d 2052 6964 6765 286e 6f72  ator = Ridge(nor
+00040640: 6d61 6c69 7a65 3d46 616c 7365 290a 2020  malize=False).  
+00040650: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00040660: 2020 2020 2020 2020 2020 7365 6c66 2e6d            self.m
+00040670: 6f64 656c 5f6e 616d 6520 3d20 276f 7468  odel_name = 'oth
+00040680: 6572 270a 2020 2020 2020 2020 2020 2020  er'.            
+00040690: 2020 2020 2020 2020 2020 2020 656c 7365              else
+000406a0: 3a0a 2020 2020 2020 2020 2020 2020 2020  :.              
+000406b0: 2020 2020 2020 2020 2020 2020 2020 6966                if
+000406c0: 2073 656c 662e 7665 7262 6f73 653a 0a20   self.verbose:. 
+000406d0: 2020 2020 2020 2020 2020 2020 2020 2020                  
+000406e0: 2020 2020 2020 2020 2020 2020 2020 2070                 p
+000406f0: 7269 6e74 2827 2020 2020 5365 6c65 6374  rint('    Select
+00040700: 696e 6720 4c47 424d 2052 6567 7265 7373  ing LGBM Regress
+00040710: 6f72 2061 7320 6261 7365 2065 7374 696d  or as base estim
+00040720: 6174 6f72 2e2e 2e27 290a 2020 2020 2020  ator...').      
+00040730: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00040740: 2020 2020 2020 7365 6c66 2e62 6173 655f        self.base_
+00040750: 6573 7469 6d61 746f 7220 3d20 4c47 424d  estimator = LGBM
+00040760: 5265 6772 6573 736f 7228 6e5f 6a6f 6273  Regressor(n_jobs
+00040770: 3d2d 312c 2020 7261 6e64 6f6d 5f73 7461  =-1,  random_sta
+00040780: 7465 3d72 616e 646f 6d5f 7365 6564 290a  te=random_seed).
+00040790: 2020 2020 2020 2020 2020 2020 2020 2020                  
+000407a0: 656c 7365 3a0a 2020 2020 2020 2020 2020  else:.          
+000407b0: 2020 2020 2020 2020 2020 2323 2320 466f            ### Fo
+000407c0: 7220 6c61 7267 6520 6461 7461 7365 7473  r large datasets
+000407d0: 2042 6574 7465 7220 746f 2075 7365 204c   Better to use L
+000407e0: 4742 4d0a 2020 2020 2020 2020 2020 2020  GBM.            
+000407f0: 2020 2020 2020 2020 6966 2064 6174 615f          if data_
+00040800: 7361 6d70 6c65 7320 3e3d 2031 6535 3a0a  samples >= 1e5:.
+00040810: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00040820: 2020 2020 2020 2020 6966 2067 7075 5f65          if gpu_e
+00040830: 7869 7374 733a 0a20 2020 2020 2020 2020  xists:.         
+00040840: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00040850: 2020 2069 6620 7365 6c66 2e76 6572 626f     if self.verbo
+00040860: 7365 3a0a 2020 2020 2020 2020 2020 2020  se:.            
+00040870: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00040880: 2020 2020 7072 696e 7428 2720 2020 2053      print('    S
+00040890: 656c 6563 7469 6e67 2058 4742 5265 6772  electing XGBRegr
+000408a0: 6573 736f 7220 7769 7468 2047 5055 2061  essor with GPU a
+000408b0: 7320 6261 7365 2065 7374 696d 6174 6f72  s base estimator
+000408c0: 2e2e 2e27 290a 2020 2020 2020 2020 2020  ...').          
+000408d0: 2020 2020 2020 2020 2020 2020 2020 2020                  
+000408e0: 2020 7365 6c66 2e62 6173 655f 6573 7469    self.base_esti
+000408f0: 6d61 746f 7220 3d20 5847 4252 6567 7265  mator = XGBRegre
+00040900: 7373 6f72 286e 5f6a 6f62 733d 2d31 2c74  ssor(n_jobs=-1,t
+00040910: 7265 655f 6d65 7468 6f64 203d 2027 6770  ree_method = 'gp
+00040920: 755f 6869 7374 272c 0a20 2020 2020 2020  u_hist',.       
+00040930: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00040940: 2020 2020 2020 2020 2067 7075 5f69 643d           gpu_id=
+00040950: 302c 2070 7265 6469 6374 6f72 3d22 6770  0, predictor="gp
+00040960: 755f 7072 6564 6963 746f 7222 290a 2020  u_predictor").  
+00040970: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00040980: 2020 2020 2020 656c 7365 3a0a 2020 2020        else:.    
+00040990: 2020 2020 2020 2020 2020 2020 2020 2020                  
+000409a0: 2020 2020 2020 2020 7365 6c66 2e62 6173          self.bas
+000409b0: 655f 6573 7469 6d61 746f 7220 3d20 4c47  e_estimator = LG
+000409c0: 424d 5265 6772 6573 736f 7228 6e5f 6a6f  BMRegressor(n_jo
+000409d0: 6273 3d2d 312c 2072 616e 646f 6d5f 7374  bs=-1, random_st
+000409e0: 6174 653d 7261 6e64 6f6d 5f73 6565 6429  ate=random_seed)
+000409f0: 200a 2020 2020 2020 2020 2020 2020 2020   .              
+00040a00: 2020 2020 2020 656c 7365 3a0a 2020 2020        else:.    
+00040a10: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00040a20: 2020 2020 2323 2320 466f 7220 736d 616c      ### For smal
+00040a30: 6c65 7220 7468 616e 2042 6967 2044 6174  ler than Big Dat
+00040a40: 612c 2075 7365 204c 6162 656c 2050 726f  a, use Label Pro
+00040a50: 7061 6761 7469 6f6e 2077 6869 6368 2069  pagation which i
+00040a60: 7320 6661 7374 6572 2061 6e64 2062 6574  s faster and bet
+00040a70: 7465 7220 2323 0a20 2020 2020 2020 2020  ter ##.         
+00040a80: 2020 2020 2020 2020 2020 2020 2020 2069                 i
+00040a90: 6620 2858 2e64 7479 7065 733d 3d66 6c6f  f (X.dtypes==flo
+00040aa0: 6174 292e 616c 6c28 293a 0a20 2020 2020  at).all():.     
+00040ab0: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00040ac0: 2020 2020 2020 2069 6620 7365 6c66 2e76         if self.v
+00040ad0: 6572 626f 7365 3a0a 2020 2020 2020 2020  erbose:.        
+00040ae0: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00040af0: 2020 2020 2020 2020 7072 696e 7428 2720          print(' 
+00040b00: 2020 2053 656c 6563 7469 6e67 2052 6964     Selecting Rid
+00040b10: 6765 2061 7320 6261 7365 5f65 7374 696d  ge as base_estim
+00040b20: 6174 6f72 2e20 4665 656c 2066 7265 6520  ator. Feel free 
+00040b30: 746f 2073 656e 6420 696e 2079 6f75 7220  to send in your 
+00040b40: 6f77 6e20 6573 7469 6d61 746f 722e 2729  own estimator.')
+00040b50: 0a20 2020 2020 2020 2020 2020 2020 2020  .               
+00040b60: 2020 2020 2020 2020 2020 2020 2073 656c               sel
+00040b70: 662e 6261 7365 5f65 7374 696d 6174 6f72  f.base_estimator
+00040b80: 203d 2052 6964 6765 286e 6f72 6d61 6c69   = Ridge(normali
+00040b90: 7a65 3d46 616c 7365 290a 2020 2020 2020  ze=False).      
+00040ba0: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00040bb0: 2020 2020 2020 7365 6c66 2e6d 6f64 656c        self.model
+00040bc0: 5f6e 616d 6520 3d20 276f 7468 6572 270a  _name = 'other'.
+00040bd0: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00040be0: 2020 2020 2020 2020 656c 7365 3a0a 2020          else:.  
+00040bf0: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00040c00: 2020 2020 2020 2020 2020 6966 206c 656e            if len
+00040c10: 2873 656c 662e 6665 6174 7572 6573 2920  (self.features) 
+00040c20: 3c3d 2066 6561 7475 7265 735f 6c69 6d69  <= features_limi
+00040c30: 743a 0a20 2020 2020 2020 2020 2020 2020  t:.             
+00040c40: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00040c50: 2020 2069 6620 7365 6c66 2e76 6572 626f     if self.verbo
+00040c60: 7365 3a0a 2020 2020 2020 2020 2020 2020  se:.            
+00040c70: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00040c80: 2020 2020 2020 2020 7072 696e 7428 2720          print(' 
+00040c90: 2020 2053 656c 6563 7469 6e67 2042 6167     Selecting Bag
+00040ca0: 6769 6e67 2052 6567 7265 7373 6f72 2066  ging Regressor f
+00040cb0: 6f72 2074 6869 7320 6461 7461 7365 742e  or this dataset.
+00040cc0: 2e2e 2729 0a20 2020 2020 2020 2020 2020  ..').           
+00040cd0: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00040ce0: 2020 2020 2045 5420 3d20 4578 7472 6154       ET = ExtraT
+00040cf0: 7265 6552 6567 7265 7373 6f72 2829 0a20  reeRegressor(). 
+00040d00: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00040d10: 2020 2020 2020 2020 2020 2020 2020 2045                 E
+00040d20: 5420 3d20 4c69 6e65 6172 5356 5228 290a  T = LinearSVR().
+00040d30: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00040d40: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00040d50: 4554 203d 2044 6563 6973 696f 6e54 7265  ET = DecisionTre
+00040d60: 6552 6567 7265 7373 6f72 2829 0a20 2020  eRegressor().   
+00040d70: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00040d80: 2020 2020 2020 2020 2020 2020 2073 656c               sel
+00040d90: 662e 6261 7365 5f65 7374 696d 6174 6f72  f.base_estimator
+00040da0: 203d 2042 6167 6769 6e67 5265 6772 6573   = BaggingRegres
+00040db0: 736f 7228 6261 7365 5f65 7374 696d 6174  sor(base_estimat
+00040dc0: 6f72 203d 2045 542c 2062 6f6f 7473 7472  or = ET, bootstr
+00040dd0: 6170 5f66 6561 7475 7265 733d 4661 6c73  ap_features=Fals
+00040de0: 652c 0a20 2020 2020 2020 2020 2020 2020  e,.             
+00040df0: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00040e00: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00040e10: 2020 2020 2020 2020 2020 2020 2020 206e                 n
+00040e20: 5f6a 6f62 733d 2d31 2c20 7261 6e64 6f6d  _jobs=-1, random
+00040e30: 5f73 7461 7465 3d72 616e 646f 6d5f 7365  _state=random_se
+00040e40: 6564 290a 2020 2020 2020 2020 2020 2020  ed).            
+00040e50: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00040e60: 2020 2020 7365 6c66 2e6d 6f64 656c 5f6e      self.model_n
+00040e70: 616d 6520 3d20 2762 6727 0a20 2020 2020  ame = 'bg'.     
+00040e80: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00040e90: 2020 2020 2020 2065 6c73 653a 0a20 2020         else:.   
+00040ea0: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00040eb0: 2020 2020 2020 2020 2020 2020 2073 636f               sco
+00040ec0: 7269 6e67 203d 2027 6e65 675f 6d65 616e  ring = 'neg_mean
+00040ed0: 5f73 7175 6172 6564 5f65 7272 6f72 270a  _squared_error'.
+00040ee0: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00040ef0: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00040f00: 2323 2320 2020 4578 7472 6120 5472 6565  ###   Extra Tree
+00040f10: 7320 6973 206e 6f74 2073 6f20 6772 6561  s is not so grea
+00040f20: 7420 666f 7220 6c61 7267 6520 6461 7461  t for large data
+00040f30: 2073 6574 7320 2d20 4c47 424d 2069 7320   sets - LGBM is 
+00040f40: 6265 7474 6572 2023 2323 230a 2020 2020  better ####.    
+00040f50: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00040f60: 2020 2020 2020 2020 2020 2020 6966 2067              if g
+00040f70: 7075 5f65 7869 7374 733a 0a20 2020 2020  pu_exists:.     
+00040f80: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00040f90: 2020 2020 2020 2020 2020 2020 2020 2069                 i
+00040fa0: 6620 7365 6c66 2e76 6572 626f 7365 3a0a  f self.verbose:.
+00040fb0: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00040fc0: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00040fd0: 2020 2020 2020 2020 7072 696e 7428 2720          print(' 
+00040fe0: 2020 2053 656c 6563 7469 6e67 2058 4742     Selecting XGB
+00040ff0: 5265 6772 6573 736f 7220 7769 7468 2047  Regressor with G
+00041000: 5055 2061 7320 6261 7365 2065 7374 696d  PU as base estim
+00041010: 6174 6f72 2e2e 2e27 290a 2020 2020 2020  ator...').      
+00041020: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00041030: 2020 2020 2020 2020 2020 2020 2020 7365                se
+00041040: 6c66 2e62 6173 655f 6573 7469 6d61 746f  lf.base_estimato
+00041050: 7220 3d20 5847 4252 6567 7265 7373 6f72  r = XGBRegressor
+00041060: 280a 2020 2020 2020 2020 2020 2020 2020  (.              
+00041070: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00041080: 2020 2020 2020 2020 2020 6e5f 6a6f 6273            n_jobs
+00041090: 3d2d 312c 7472 6565 5f6d 6574 686f 6420  =-1,tree_method 
+000410a0: 3d20 2767 7075 5f68 6973 7427 2c67 7075  = 'gpu_hist',gpu
+000410b0: 5f69 643d 302c 2070 7265 6469 6374 6f72  _id=0, predictor
+000410c0: 3d22 6770 755f 7072 6564 6963 746f 7222  ="gpu_predictor"
+000410d0: 290a 2020 2020 2020 2020 2020 2020 2020  ).              
+000410e0: 2020 2020 2020 2020 2020 2020 2020 2020                  
+000410f0: 2020 656c 7365 3a0a 2020 2020 2020 2020    else:.        
+00041100: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00041110: 2020 2020 2020 2020 2020 2020 6966 2073              if s
+00041120: 656c 662e 7665 7262 6f73 653a 0a20 2020  elf.verbose:.   
+00041130: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00041140: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00041150: 2020 2020 2070 7269 6e74 2827 2020 2020       print('    
+00041160: 5365 6c65 6374 696e 6720 4c47 424d 2052  Selecting LGBM R
+00041170: 6567 7265 7373 6f72 2061 7320 6261 7365  egressor as base
+00041180: 2065 7374 696d 6174 6f72 2e2e 2e27 290a   estimator...').
+00041190: 2020 2020 2020 2020 2020 2020 2020 2020                  
+000411a0: 2020 2020 2020 2020 2020 2020 2020 2020                  
+000411b0: 2020 2020 7365 6c66 2e62 6173 655f 6573      self.base_es
+000411c0: 7469 6d61 746f 7220 3d20 4c47 424d 5265  timator = LGBMRe
+000411d0: 6772 6573 736f 7228 6e5f 6a6f 6273 3d2d  gressor(n_jobs=-
+000411e0: 312c 2072 616e 646f 6d5f 7374 6174 653d  1, random_state=
+000411f0: 7261 6e64 6f6d 5f73 6565 6429 200a 2020  random_seed) .  
+00041200: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00041210: 2020 2020 2020 2020 2020 2020 2020 7365                se
+00041220: 6c66 2e6d 6f64 656c 5f6e 616d 6520 3d20  lf.model_name = 
+00041230: 276c 6762 270a 2020 2020 2020 2020 2020  'lgb'.          
+00041240: 2020 656c 7365 3a0a 2020 2020 2020 2020    else:.        
+00041250: 2020 2020 2020 2020 7365 6c66 2e6d 6f64          self.mod
+00041260: 656c 5f6e 616d 6520 3d20 276f 7468 6572  el_name = 'other
+00041270: 270a 2020 2020 2020 2020 2020 2020 2320  '.            # 
+00041280: 5370 6c69 7420 6461 7461 2069 6e74 6f20  Split data into 
+00041290: 7472 6169 6e20 616e 6420 7465 7374 2062  train and test b
+000412a0: 6173 6564 206f 6e20 666f 6c64 7320 2020  ased on folds   
+000412b0: 2020 2020 2020 200a 2020 2020 2020 2020         .        
+000412c0: 2020 2020 6966 2069 7369 6e73 7461 6e63      if isinstanc
+000412d0: 6528 792c 2070 642e 5365 7269 6573 2920  e(y, pd.Series) 
+000412e0: 6f72 2069 7369 6e73 7461 6e63 6528 792c  or isinstance(y,
+000412f0: 2070 642e 4461 7461 4672 616d 6529 3a0a   pd.DataFrame):.
+00041300: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00041310: 795f 7472 6169 6e2c 2079 5f74 6573 7420  y_train, y_test 
+00041320: 3d20 792e 696c 6f63 5b74 7261 696e 5f69  = y.iloc[train_i
+00041330: 6e64 6578 5d2c 2079 2e69 6c6f 635b 7465  ndex], y.iloc[te
+00041340: 7374 5f69 6e64 6578 5d20 2020 2020 2020  st_index]       
+00041350: 2020 2020 2020 2020 200a 2020 2020 2020           .      
+00041360: 2020 2020 2020 656c 7365 3a0a 2020 2020        else:.    
+00041370: 2020 2020 2020 2020 2020 2020 795f 7472              y_tr
+00041380: 6169 6e2c 2079 5f74 6573 7420 3d20 795b  ain, y_test = y[
+00041390: 7472 6169 6e5f 696e 6465 785d 2c20 795b  train_index], y[
+000413a0: 7465 7374 5f69 6e64 6578 5d0a 0a20 2020  test_index]..   
+000413b0: 2020 2020 2020 2020 2069 6620 6973 696e           if isin
+000413c0: 7374 616e 6365 2858 2c20 7064 2e44 6174  stance(X, pd.Dat
+000413d0: 6146 7261 6d65 293a 0a20 2020 2020 2020  aFrame):.       
+000413e0: 2020 2020 2020 2020 2078 5f74 7261 696e           x_train
+000413f0: 2c20 785f 7465 7374 203d 2058 2e69 6c6f  , x_test = X.ilo
+00041400: 635b 7472 6169 6e5f 696e 6465 785d 2c20  c[train_index], 
+00041410: 582e 696c 6f63 5b74 6573 745f 696e 6465  X.iloc[test_inde
+00041420: 785d 0a20 2020 2020 2020 2020 2020 2065  x].            e
+00041430: 6c73 653a 0a20 2020 2020 2020 2020 2020  lse:.           
+00041440: 2020 2020 2078 5f74 7261 696e 2c20 785f       x_train, x_
+00041450: 7465 7374 203d 2058 5b74 7261 696e 5f69  test = X[train_i
+00041460: 6e64 6578 5d2c 2058 5b74 6573 745f 696e  ndex], X[test_in
+00041470: 6465 785d 0a0a 2020 2020 2020 2020 2020  dex]..          
+00041480: 2020 2320 436f 6e76 6572 7420 7468 6520    # Convert the 
+00041490: 6461 7461 2069 6e74 6f20 6e75 6d70 7920  data into numpy 
+000414a0: 6172 7261 7973 0a20 2020 2020 2020 2020  arrays.         
+000414b0: 2020 2023 6966 206e 6f74 2069 7369 6e73     #if not isins
+000414c0: 7461 6e63 6528 785f 7472 6169 6e2c 206e  tance(x_train, n
+000414d0: 702e 6e64 6172 7261 7929 3a0a 2020 2020  p.ndarray):.    
+000414e0: 2020 2020 2020 2020 2320 2020 2078 5f74          #    x_t
+000414f0: 7261 696e 2c20 785f 7465 7374 203d 2078  rain, x_test = x
+00041500: 5f74 7261 696e 2e76 616c 7565 732c 2078  _train.values, x
+00041510: 5f74 6573 742e 7661 6c75 6573 0a20 2020  _test.values.   
+00041520: 2020 2020 2020 2020 200a 2020 2020 2020           .      
+00041530: 2020 2020 2020 2323 2020 2073 6d61 6c6c        ##   small
+00041540: 2064 6174 6173 6574 7320 7072 6f63 6573   datasets proces
+00041550: 7369 6e67 2023 2323 2323 0a20 2020 2020  sing #####.     
+00041560: 2020 2020 2020 2069 6620 6920 3d3d 2030         if i == 0
+00041570: 3a0a 2020 2020 2020 2020 2020 2020 2020  :.              
+00041580: 2020 6966 2073 656c 662e 7069 7065 6c69    if self.pipeli
+00041590: 6e65 3a0a 2020 2020 2020 2020 2020 2020  ne:.            
+000415a0: 2020 2020 2020 2020 2320 5472 6169 6e20          # Train 
+000415b0: 6d6f 6465 6c20 616e 6420 7573 6520 6974  model and use it
+000415c0: 2069 6e20 6120 7069 7065 6c69 6e65 2074   in a pipeline t
+000415d0: 6f20 7472 6169 6e20 6f6e 2074 6865 2066  o train on the f
+000415e0: 6f6c 6420 2023 230a 2020 2020 2020 2020  old  ##.        
+000415f0: 2020 2020 2020 2020 2020 2020 7069 7065              pipe
+00041600: 203d 2050 6970 656c 696e 6528 0a20 2020   = Pipeline(.   
+00041610: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00041620: 2020 2020 2073 7465 7073 3d5b 2822 7072       steps=[("pr
+00041630: 6570 726f 6365 7373 6f72 222c 2070 7265  eprocessor", pre
+00041640: 7072 6f63 6573 736f 7229 2c20 2822 6d6f  processor), ("mo
+00041650: 6465 6c22 2c20 7365 6c66 2e62 6173 655f  del", self.base_
+00041660: 6573 7469 6d61 746f 7229 5d29 0a20 2020  estimator)]).   
+00041670: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00041680: 2069 6620 7365 6c66 2e6d 6f64 656c 5f6e   if self.model_n
+00041690: 616d 6520 3d3d 2027 6f74 6865 7227 3a0a  ame == 'other':.
+000416a0: 2020 2020 2020 2020 2020 2020 2020 2020                  
+000416b0: 2020 2020 2020 2020 7072 696e 7428 274e          print('N
+000416c0: 6f20 4850 5420 7475 6e69 6e67 2070 6572  o HPT tuning per
+000416d0: 666f 726d 6564 2073 696e 6365 2062 6173  formed since bas
+000416e0: 6520 6573 7469 6d61 746f 7220 6973 2067  e estimator is g
+000416f0: 6976 656e 2062 7920 696e 7075 742e 2e2e  iven by input...
+00041700: 2729 0a20 2020 2020 2020 2020 2020 2020  ').             
+00041710: 2020 2020 2020 2020 2020 2073 656c 662e             self.
+00041720: 6261 7365 5f65 7374 696d 6174 6f72 203d  base_estimator =
+00041730: 2063 6f70 792e 6465 6570 636f 7079 2870   copy.deepcopy(p
+00041740: 6970 6529 0a20 2020 2020 2020 2020 2020  ipe).           
+00041750: 2020 2020 2020 2020 2065 6c73 653a 0a20           else:. 
+00041760: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00041770: 2020 2020 2020 2069 6620 6c65 6e28 7365         if len(se
+00041780: 6c66 2e66 6561 7475 7265 7329 203c 3d20  lf.features) <= 
+00041790: 6665 6174 7572 6573 5f6c 696d 6974 3a0a  features_limit:.
+000417a0: 2020 2020 2020 2020 2020 2020 2020 2020                  
+000417b0: 2020 2020 2020 2020 2020 2020 7365 6c66              self
+000417c0: 2e62 6173 655f 6573 7469 6d61 746f 7220  .base_estimator 
+000417d0: 3d20 7261 6e64 5f73 6561 7263 6828 7069  = rand_search(pi
+000417e0: 7065 2c20 785f 7472 6169 6e2c 2079 5f74  pe, x_train, y_t
+000417f0: 7261 696e 2c20 0a20 2020 2020 2020 2020  rain, .         
+00041800: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00041810: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00041820: 2020 2020 2020 2020 2020 2073 656c 662e             self.
+00041830: 6d6f 6465 6c5f 6e61 6d65 2c20 7365 6c66  model_name, self
+00041840: 2e70 6970 656c 696e 652c 2073 636f 7269  .pipeline, scori
+00041850: 6e67 2c20 7665 7262 6f73 653d 7365 6c66  ng, verbose=self
+00041860: 2e76 6572 626f 7365 290a 2020 2020 2020  .verbose).      
+00041870: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00041880: 2020 656c 7365 3a0a 2020 2020 2020 2020    else:.        
+00041890: 2020 2020 2020 2020 2020 2020 2020 2020                  
+000418a0: 2020 2020 7072 696e 7428 274e 6f20 4850      print('No HP
+000418b0: 5420 7475 6e69 6e67 2070 6572 666f 726d  T tuning perform
+000418c0: 6564 2073 696e 6365 206e 756d 6265 7220  ed since number 
+000418d0: 6f66 2066 6561 7475 7265 7320 6973 2074  of features is t
+000418e0: 6f6f 206c 6172 6765 2e2e 2e27 290a 2020  oo large...').  
+000418f0: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00041900: 2020 2020 2020 2020 2020 7365 6c66 2e62            self.b
+00041910: 6173 655f 6573 7469 6d61 746f 7220 3d20  ase_estimator = 
+00041920: 636f 7079 2e64 6565 7063 6f70 7928 7069  copy.deepcopy(pi
+00041930: 7065 290a 2020 2020 2020 2020 2020 2020  pe).            
+00041940: 2020 2020 656c 7365 3a0a 2020 2020 2020      else:.      
+00041950: 2020 2020 2020 2020 2020 2020 2020 2323                ##
+00041960: 2320 5468 6973 2069 7320 666f 7220 7769  # This is for wi
+00041970: 7468 6f75 7420 6120 7069 7065 6c69 6e65  thout a pipeline
+00041980: 2023 2323 2323 2323 0a20 2020 2020 2020   #######.       
+00041990: 2020 2020 2020 2020 2020 2020 2069 6620               if 
+000419a0: 7365 6c66 2e6d 6f64 656c 5f6e 616d 6520  self.model_name 
+000419b0: 3d3d 2027 6f74 6865 7227 3a0a 2020 2020  == 'other':.    
+000419c0: 2020 2020 2020 2020 2020 2020 2020 2020                  
+000419d0: 2020 2020 2323 2320 6c65 6176 6520 7468      ### leave th
+000419e0: 6520 6261 7365 2065 7374 696d 6174 6f72  e base estimator
+000419f0: 2061 7320 6973 2023 2323 0a20 2020 2020   as is ###.     
+00041a00: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00041a10: 2020 2070 7269 6e74 2827 4e6f 2048 5054     print('No HPT
+00041a20: 2074 756e 696e 6720 7065 7266 6f72 6d65   tuning performe
+00041a30: 6420 7369 6e63 6520 6261 7365 2065 7374  d since base est
+00041a40: 696d 6174 6f72 2069 7320 6769 7665 6e20  imator is given 
+00041a50: 6279 2069 6e70 7574 2e2e 2e27 290a 2020  by input...').  
+00041a60: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00041a70: 2020 656c 7365 3a0a 2020 2020 2020 2020    else:.        
+00041a80: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00041a90: 6966 206c 656e 2873 656c 662e 6665 6174  if len(self.feat
+00041aa0: 7572 6573 2920 3c3d 2066 6561 7475 7265  ures) <= feature
+00041ab0: 735f 6c69 6d69 743a 0a20 2020 2020 2020  s_limit:.       
+00041ac0: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00041ad0: 2020 2020 2023 2323 206c 6561 7665 2074       ### leave t
+00041ae0: 6865 2062 6173 6520 6573 7469 6d61 746f  he base estimato
+00041af0: 7220 6173 2069 7320 2323 230a 2020 2020  r as is ###.    
+00041b00: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00041b10: 2020 2020 2020 2020 7365 6c66 2e62 6173          self.bas
+00041b20: 655f 6573 7469 6d61 746f 7220 3d20 7261  e_estimator = ra
+00041b30: 6e64 5f73 6561 7263 6828 7365 6c66 2e62  nd_search(self.b
+00041b40: 6173 655f 6573 7469 6d61 746f 722c 2078  ase_estimator, x
+00041b50: 5f74 7261 696e 2c20 0a20 2020 2020 2020  _train, .       
+00041b60: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00041b70: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00041b80: 2020 2020 2020 2020 2079 5f74 7261 696e           y_train
+00041b90: 2c20 7365 6c66 2e6d 6f64 656c 5f6e 616d  , self.model_nam
+00041ba0: 652c 2073 656c 662e 7069 7065 6c69 6e65  e, self.pipeline
+00041bb0: 2c20 7363 6f72 696e 672c 2076 6572 626f  , scoring, verbo
+00041bc0: 7365 3d73 656c 662e 7665 7262 6f73 6529  se=self.verbose)
+00041bd0: 0a20 2020 2020 2020 2020 2020 2020 2020  .               
+00041be0: 2020 2020 2020 2020 2065 6c73 653a 0a20           else:. 
+00041bf0: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00041c00: 2020 2020 2020 2020 2020 2070 7269 6e74             print
+00041c10: 2827 4e6f 2048 5054 2074 756e 696e 6720  ('No HPT tuning 
+00041c20: 7065 7266 6f72 6d65 6420 7369 6e63 6520  performed since 
+00041c30: 6e75 6d62 6572 206f 6620 6665 6174 7572  number of featur
+00041c40: 6573 2069 7320 746f 6f20 6c61 7267 652e  es is too large.
+00041c50: 2e2e 2729 0a0a 2020 2020 2020 2020 2020  ..')..          
+00041c60: 2020 2020 2020 6573 745f 6c69 7374 203d        est_list =
+00041c70: 206e 756d 5f69 7465 7261 7469 6f6e 732a   num_iterations*
+00041c80: 5b73 656c 662e 6261 7365 5f65 7374 696d  [self.base_estim
+00041c90: 6174 6f72 5d0a 2020 2020 2020 2020 2020  ator].          
+00041ca0: 2020 2020 2020 2370 7269 6e74 2827 2020        #print('  
+00041cb0: 2020 6261 7365 2065 7374 696d 6174 6f72    base estimator
+00041cc0: 203d 2025 7327 2025 7365 6c66 2e62 6173   = %s' %self.bas
+00041cd0: 655f 6573 7469 6d61 746f 7229 0a20 2020  e_estimator).   
+00041ce0: 2020 2020 2020 2020 200a 2020 2020 2020           .      
+00041cf0: 2020 2020 2020 2323 2320 534d 4f54 4520        ### SMOTE 
+00041d00: 7072 6f63 6573 7369 6e67 2023 2323 2323  processing #####
+00041d10: 0a20 2020 2020 2020 2020 2020 2069 6620  .            if 
+00041d20: 6920 3d3d 2030 3a0a 2020 2020 2020 2020  i == 0:.        
+00041d30: 2020 2020 2020 2020 6966 2073 6d6f 7465          if smote
+00041d40: 3a0a 2020 2020 2020 2020 2020 2020 2020  :.              
+00041d50: 2020 2020 2020 7072 696e 7428 2750 6572        print('Per
+00041d60: 666f 726d 696e 6720 534d 4f54 452e 2e2e  forming SMOTE...
+00041d70: 2729 0a20 2020 2020 2020 2020 2020 2020  ').             
+00041d80: 2020 2020 2020 2069 6620 7365 6c66 2e76         if self.v
+00041d90: 6572 626f 7365 3a0a 2020 2020 2020 2020  erbose:.        
+00041da0: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00041db0: 7072 696e 7428 2720 2020 2078 5f74 7261  print('    x_tra
+00041dc0: 696e 2073 6861 7065 2062 6566 6f72 6520  in shape before 
+00041dd0: 534d 4f54 4520 3d20 2573 2720 2528 785f  SMOTE = %s' %(x_
+00041de0: 7472 6169 6e2e 7368 6170 652c 2929 0a20  train.shape,)). 
+00041df0: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00041e00: 2020 200a 2020 2020 2020 2020 2020 2020     .            
+00041e10: 6966 2073 6d6f 7465 3a0a 2020 2020 2020  if smote:.      
+00041e20: 2020 2020 2020 2020 2020 2323 2320 4974            ### It
+00041e30: 2064 6f65 7320 6e6f 7420 6170 7065 6172   does not appear
+00041e40: 2074 6861 7420 636c 6173 7320 7765 6967   that class weig
+00041e50: 6874 7320 776f 726b 2077 656c 6c20 696e  hts work well in
+00041e60: 2053 4d4f 5445 202d 2068 656e 6365 2061   SMOTE - hence a
+00041e70: 766f 6964 2023 2323 2020 2020 2020 2020  void ###        
+00041e80: 2020 2020 2020 2020 0a20 2020 2020 2020          .       
+00041e90: 2020 2020 2020 2020 2074 7279 3a0a 2020           try:.  
+00041ea0: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00041eb0: 2020 736d 203d 2041 4441 5359 4e28 6e5f    sm = ADASYN(n_
+00041ec0: 6e65 6967 6862 6f72 733d 352c 2072 616e  neighbors=5, ran
+00041ed0: 646f 6d5f 7374 6174 653d 7365 6564 2c20  dom_state=seed, 
+00041ee0: 290a 2020 2020 2020 2020 2020 2020 2020  ).              
 00041ef0: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00041f00: 2020 6966 2073 656c 662e 696e 7465 6765    if self.intege
-00041f10: 7273 5f6f 6e6c 793a 0a20 2020 2020 2020  rs_only:.       
-00041f20: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00041f30: 2020 2020 2020 2020 2069 6620 2858 2e64           if (X.d
-00041f40: 7479 7065 733d 3d66 6c6f 6174 292e 616c  types==float).al
-00041f50: 6c28 2920 616e 6420 6c65 6e28 7365 6c66  l() and len(self
-00041f60: 2e66 6561 7475 7265 7329 203c 3d20 6665  .features) <= fe
-00041f70: 6174 7572 6573 5f6c 696d 6974 3a0a 2020  atures_limit:.  
-00041f80: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00041f90: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00041fa0: 2020 7072 696e 7428 2720 2020 2053 656c    print('    Sel
-00041fb0: 6563 7469 6e67 2052 6964 6765 2061 7320  ecting Ridge as 
-00041fc0: 6261 7365 5f65 7374 696d 6174 6f72 2e20  base_estimator. 
-00041fd0: 4665 656c 2066 7265 6520 746f 2073 656e  Feel free to sen
-00041fe0: 6420 696e 2079 6f75 7220 6f77 6e20 6573  d in your own es
-00041ff0: 7469 6d61 746f 722e 2729 0a20 2020 2020  timator.').     
-00042000: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00042010: 2020 2020 2020 2020 2020 2020 2020 2073                 s
-00042020: 656c 662e 6261 7365 5f65 7374 696d 6174  elf.base_estimat
-00042030: 6f72 203d 2052 6964 6765 286e 6f72 6d61  or = Ridge(norma
-00042040: 6c69 7a65 3d46 616c 7365 290a 2020 2020  lize=False).    
-00042050: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00042060: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00042070: 7365 6c66 2e6d 6f64 656c 5f6e 616d 6520  self.model_name 
-00042080: 3d20 276f 7468 6572 270a 2020 2020 2020  = 'other'.      
+00041f00: 2020 2373 616d 706c 696e 675f 7374 7261    #sampling_stra
+00041f10: 7465 6779 3d63 6c61 7373 5f77 6569 6768  tegy=class_weigh
+00041f20: 7465 645f 726f 7773 290a 2020 2020 2020  ted_rows).      
+00041f30: 2020 2020 2020 2020 2020 2020 2020 0a20                . 
+00041f40: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00041f50: 2020 2078 5f74 7261 696e 2c20 795f 7472     x_train, y_tr
+00041f60: 6169 6e20 3d20 736d 2e66 6974 5f72 6573  ain = sm.fit_res
+00041f70: 616d 706c 6528 785f 7472 6169 6e2c 2079  ample(x_train, y
+00041f80: 5f74 7261 696e 290a 2020 2020 2020 2020  _train).        
+00041f90: 2020 2020 2020 2020 2020 2020 6966 2069              if i
+00041fa0: 203d 3d20 303a 0a20 2020 2020 2020 2020   == 0:.         
+00041fb0: 2020 2020 2020 2020 2020 2020 2020 2070                 p
+00041fc0: 7269 6e74 2827 2020 2020 785f 7472 6169  rint('    x_trai
+00041fd0: 6e20 7368 6170 6520 6166 7465 7220 534d  n shape after SM
+00041fe0: 4f54 4520 3d20 2573 2720 2528 785f 7472  OTE = %s' %(x_tr
+00041ff0: 6169 6e2e 7368 6170 652c 2929 0a20 2020  ain.shape,)).   
+00042000: 2020 2020 2020 2020 2020 2020 2065 7863               exc
+00042010: 6570 743a 0a20 2020 2020 2020 2020 2020  ept:.           
+00042020: 2020 2020 2020 2020 2073 6d20 3d20 534d           sm = SM
+00042030: 4f54 4554 6f6d 656b 2872 616e 646f 6d5f  OTETomek(random_
+00042040: 7374 6174 653d 3432 2c29 0a20 2020 2020  state=42,).     
+00042050: 2020 2020 2020 2020 2020 2020 2020 2023                 #
+00042060: 736d 203d 2041 4441 5359 4e28 6e5f 6e65  sm = ADASYN(n_ne
+00042070: 6967 6862 6f72 733d 322c 2072 616e 646f  ighbors=2, rando
+00042080: 6d5f 7374 6174 653d 7365 6564 2c20 290a  m_state=seed, ).
 00042090: 2020 2020 2020 2020 2020 2020 2020 2020                  
-000420a0: 2020 2020 2020 2020 2020 656c 7365 3a0a            else:.
-000420b0: 2020 2020 2020 2020 2020 2020 2020 2020                  
-000420c0: 2020 2020 2020 2020 2020 2020 2020 2020                  
-000420d0: 2020 2020 6966 2073 656c 662e 7665 7262      if self.verb
-000420e0: 6f73 653a 0a20 2020 2020 2020 2020 2020  ose:.           
-000420f0: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00042100: 2020 2020 2020 2020 2020 2020 2070 7269               pri
-00042110: 6e74 2827 2020 2020 5365 6c65 6374 696e  nt('    Selectin
-00042120: 6720 4c47 424d 2052 6567 7265 7373 6f72  g LGBM Regressor
-00042130: 2061 7320 6261 7365 2065 7374 696d 6174   as base estimat
-00042140: 6f72 2e2e 2e27 290a 2020 2020 2020 2020  or...').        
-00042150: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00042160: 2020 2020 2020 2020 2020 2020 7365 6c66              self
-00042170: 2e62 6173 655f 6573 7469 6d61 746f 7220  .base_estimator 
-00042180: 3d20 4c47 424d 5265 6772 6573 736f 7228  = LGBMRegressor(
-00042190: 6e5f 6a6f 6273 3d2d 312c 2064 6576 6963  n_jobs=-1, devic
-000421a0: 653d 6465 7669 6365 2c20 7261 6e64 6f6d  e=device, random
-000421b0: 5f73 7461 7465 3d72 616e 646f 6d5f 7365  _state=random_se
-000421c0: 6564 2920 2020 2020 2020 2020 2020 2020  ed)             
-000421d0: 2020 2020 2020 2020 2020 2020 2020 2020                  
-000421e0: 2020 2020 2020 200a 2020 2020 2020 2020         .        
-000421f0: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00042200: 2020 2020 656c 7365 3a0a 2020 2020 2020      else:.      
-00042210: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00042220: 2020 2020 2020 2020 2020 6966 206c 656e            if len
-00042230: 2873 656c 662e 6665 6174 7572 6573 2920  (self.features) 
-00042240: 3c3d 2066 6561 7475 7265 735f 6c69 6d69  <= features_limi
-00042250: 743a 0a20 2020 2020 2020 2020 2020 2020  t:.             
-00042260: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00042270: 2020 2020 2020 2069 6620 7365 6c66 2e76         if self.v
-00042280: 6572 626f 7365 3a0a 2020 2020 2020 2020  erbose:.        
-00042290: 2020 2020 2020 2020 2020 2020 2020 2020                  
-000422a0: 2020 2020 2020 2020 2020 2020 2020 2020                  
-000422b0: 7072 696e 7428 2720 2020 2053 656c 6563  print('    Selec
-000422c0: 7469 6e67 2042 6167 6769 6e67 2052 6567  ting Bagging Reg
-000422d0: 7265 7373 6f72 2073 696e 6365 2069 6e74  ressor since int
-000422e0: 6567 6572 735f 6f6e 6c79 2066 6c61 6720  egers_only flag 
-000422f0: 6973 2073 6574 2e2e 2e27 290a 2020 2020  is set...').    
-00042300: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00042310: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00042320: 4554 203d 2045 7874 7261 5472 6565 5265  ET = ExtraTreeRe
-00042330: 6772 6573 736f 7228 290a 2020 2020 2020  gressor().      
-00042340: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00042350: 2020 2020 2020 2020 2020 2020 2020 4554                ET
-00042360: 203d 204c 696e 6561 7253 5652 2829 0a20   = LinearSVR(). 
-00042370: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00042380: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00042390: 2020 2045 5420 3d20 4465 6369 7369 6f6e     ET = Decision
-000423a0: 5472 6565 5265 6772 6573 736f 7228 290a  TreeRegressor().
-000423b0: 2020 2020 2020 2020 2020 2020 2020 2020                  
-000423c0: 2020 2020 2020 2020 2020 2020 2020 2020                  
-000423d0: 2020 2020 7365 6c66 2e62 6173 655f 6573      self.base_es
-000423e0: 7469 6d61 746f 7220 3d20 4261 6767 696e  timator = Baggin
-000423f0: 6752 6567 7265 7373 6f72 2862 6173 655f  gRegressor(base_
-00042400: 6573 7469 6d61 746f 7220 3d20 4554 2c20  estimator = ET, 
-00042410: 626f 6f74 7374 7261 705f 6665 6174 7572  bootstrap_featur
-00042420: 6573 3d46 616c 7365 2c0a 2020 2020 2020  es=False,.      
-00042430: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00042440: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00042450: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00042460: 2020 2020 2020 6e5f 6a6f 6273 3d2d 312c        n_jobs=-1,
-00042470: 2072 616e 646f 6d5f 7374 6174 653d 7261   random_state=ra
-00042480: 6e64 6f6d 5f73 6565 6429 0a20 2020 2020  ndom_seed).     
-00042490: 2020 2020 2020 2020 2020 2020 2020 2020                  
-000424a0: 2020 2020 2020 2020 2020 2020 2020 2073                 s
-000424b0: 656c 662e 6d6f 6465 6c5f 6e61 6d65 203d  elf.model_name =
-000424c0: 2027 6267 270a 2020 2020 2020 2020 2020   'bg'.          
-000424d0: 2020 2020 2020 2020 2020 2020 2020 2020                  
-000424e0: 2020 2020 2020 656c 7365 3a0a 2020 2020        else:.    
-000424f0: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00042500: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00042510: 6966 2067 7075 5f65 7869 7374 733a 0a20  if gpu_exists:. 
-00042520: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00042530: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00042540: 2020 2020 2020 2069 6620 7365 6c66 2e76         if self.v
-00042550: 6572 626f 7365 3a0a 2020 2020 2020 2020  erbose:.        
-00042560: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00042570: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00042580: 2020 2020 7072 696e 7428 2720 2020 2053      print('    S
-00042590: 656c 6563 7469 6e67 2058 4742 5265 6772  electing XGBRegr
-000425a0: 6573 736f 7220 7769 7468 2047 5055 2061  essor with GPU a
-000425b0: 7320 6261 7365 2065 7374 696d 6174 6f72  s base estimator
-000425c0: 2e2e 2e27 290a 2020 2020 2020 2020 2020  ...').          
-000425d0: 2020 2020 2020 2020 2020 2020 2020 2020                  
-000425e0: 2020 2020 2020 2020 2020 2020 2020 7365                se
-000425f0: 6c66 2e62 6173 655f 6573 7469 6d61 746f  lf.base_estimato
-00042600: 7220 3d20 5847 4252 6567 7265 7373 6f72  r = XGBRegressor
-00042610: 2820 0a20 2020 2020 2020 2020 2020 2020  ( .             
-00042620: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00042630: 2020 2020 2020 2020 2020 2020 2020 206e                 n
-00042640: 5f6a 6f62 733d 2d31 2c74 7265 655f 6d65  _jobs=-1,tree_me
-00042650: 7468 6f64 203d 2027 6770 755f 6869 7374  thod = 'gpu_hist
-00042660: 272c 6770 755f 6964 3d30 2c20 7072 6564  ',gpu_id=0, pred
-00042670: 6963 746f 723d 2267 7075 5f70 7265 6469  ictor="gpu_predi
-00042680: 6374 6f72 2229 0a20 2020 2020 2020 2020  ctor").         
-00042690: 2020 2020 2020 2020 2020 2020 2020 2020                  
-000426a0: 2020 2020 2020 2020 2020 2065 6c73 653a             else:
-000426b0: 0a20 2020 2020 2020 2020 2020 2020 2020  .               
-000426c0: 2020 2020 2020 2020 2020 2020 2020 2020                  
-000426d0: 2020 2020 2020 2020 2069 6620 7365 6c66           if self
-000426e0: 2e76 6572 626f 7365 3a0a 2020 2020 2020  .verbose:.      
-000426f0: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00042700: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00042710: 2020 2020 2020 7072 696e 7428 2720 2020        print('   
-00042720: 2053 656c 6563 7469 6e67 204c 4742 4d20   Selecting LGBM 
-00042730: 5265 6772 6573 736f 7220 6173 2062 6173  Regressor as bas
-00042740: 6520 6573 7469 6d61 746f 722e 2e2e 2729  e estimator...')
-00042750: 0a20 2020 2020 2020 2020 2020 2020 2020  .               
-00042760: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00042770: 2020 2020 2020 2020 2073 656c 662e 6261           self.ba
-00042780: 7365 5f65 7374 696d 6174 6f72 203d 204c  se_estimator = L
-00042790: 4742 4d52 6567 7265 7373 6f72 286e 5f6a  GBMRegressor(n_j
-000427a0: 6f62 733d 2d31 2c64 6576 6963 653d 6465  obs=-1,device=de
-000427b0: 7669 6365 2c20 7261 6e64 6f6d 5f73 7461  vice, random_sta
-000427c0: 7465 3d72 616e 646f 6d5f 7365 6564 2920  te=random_seed) 
-000427d0: 2020 2020 2020 2020 2020 2020 2020 2020                  
-000427e0: 2020 2020 2020 2020 2020 2020 2020 2020                  
-000427f0: 2020 200a 2020 2020 2020 2020 2020 2020     .            
-00042800: 2020 2020 2020 2020 2020 2020 656c 7365              else
-00042810: 3a0a 2020 2020 2020 2020 2020 2020 2020  :.              
-00042820: 2020 2020 2020 2020 2020 2020 2020 6966                if
-00042830: 2067 7075 5f65 7869 7374 733a 0a20 2020   gpu_exists:.   
-00042840: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00042850: 2020 2020 2020 2020 2020 2020 2069 6620               if 
-00042860: 7365 6c66 2e76 6572 626f 7365 3a0a 2020  self.verbose:.  
-00042870: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00042880: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00042890: 2020 7072 696e 7428 2720 2020 2053 656c    print('    Sel
-000428a0: 6563 7469 6e67 2058 4742 2052 6567 7265  ecting XGB Regre
-000428b0: 7373 6f72 2077 6974 6820 4750 5520 6173  ssor with GPU as
-000428c0: 2062 6173 6520 6573 7469 6d61 746f 722e   base estimator.
-000428d0: 2e2e 2729 0a20 2020 2020 2020 2020 2020  ..').           
-000428e0: 2020 2020 2020 2020 2020 2020 2020 2020                  
-000428f0: 2020 2020 2073 656c 662e 6261 7365 5f65       self.base_e
-00042900: 7374 696d 6174 6f72 203d 2058 4742 5265  stimator = XGBRe
-00042910: 6772 6573 736f 7228 200a 2020 2020 2020  gressor( .      
-00042920: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00042930: 2020 2020 2020 2020 2020 2020 2020 6e5f                n_
-00042940: 6a6f 6273 3d2d 312c 7472 6565 5f6d 6574  jobs=-1,tree_met
-00042950: 686f 6420 3d20 2767 7075 5f68 6973 7427  hod = 'gpu_hist'
-00042960: 2c67 7075 5f69 643d 302c 2070 7265 6469  ,gpu_id=0, predi
-00042970: 6374 6f72 3d22 6770 755f 7072 6564 6963  ctor="gpu_predic
-00042980: 746f 7222 290a 2020 2020 2020 2020 2020  tor").          
-00042990: 2020 2020 2020 2020 2020 2020 2020 2020                  
-000429a0: 2020 656c 7365 3a0a 2020 2020 2020 2020    else:.        
-000429b0: 2020 2020 2020 2020 2020 2020 2020 2020                  
-000429c0: 2020 2020 2020 2020 6966 2073 656c 662e          if self.
-000429d0: 7665 7262 6f73 653a 0a20 2020 2020 2020  verbose:.       
-000429e0: 2020 2020 2020 2020 2020 2020 2020 2020                  
-000429f0: 2020 2020 2020 2020 2020 2020 2070 7269               pri
-00042a00: 6e74 2827 2020 2020 5365 6c65 6374 696e  nt('    Selectin
-00042a10: 6720 4c47 424d 2052 6567 7265 7373 6f72  g LGBM Regressor
-00042a20: 2061 7320 6261 7365 2065 7374 696d 6174   as base estimat
-00042a30: 6f72 2e2e 2e27 290a 2020 2020 2020 2020  or...').        
-00042a40: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00042a50: 2020 2020 2020 2020 7365 6c66 2e62 6173          self.bas
-00042a60: 655f 6573 7469 6d61 746f 7220 3d20 4c47  e_estimator = LG
-00042a70: 424d 5265 6772 6573 736f 7228 6e5f 6a6f  BMRegressor(n_jo
-00042a80: 6273 3d2d 312c 6465 7669 6365 3d64 6576  bs=-1,device=dev
-00042a90: 6963 652c 2072 616e 646f 6d5f 7374 6174  ice, random_stat
-00042aa0: 653d 7261 6e64 6f6d 5f73 6565 6429 0a20  e=random_seed). 
-00042ab0: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00042ac0: 2020 2065 6c73 653a 0a20 2020 2020 2020     else:.       
-00042ad0: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00042ae0: 2073 656c 662e 6d6f 6465 6c5f 6e61 6d65   self.model_name
-00042af0: 203d 3d20 276f 7468 6572 270a 2020 2020   == 'other'.    
-00042b00: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00042b10: 2320 5370 6c69 7420 6461 7461 2069 6e74  # Split data int
-00042b20: 6f20 7472 6169 6e20 616e 6420 7465 7374  o train and test
-00042b30: 2062 6173 6564 206f 6e20 666f 6c64 7320   based on folds 
-00042b40: 2020 2020 2020 2020 200a 2020 2020 2020           .      
-00042b50: 2020 2020 2020 2020 2020 2020 2020 6966                if
-00042b60: 2069 7369 6e73 7461 6e63 6528 792c 2070   isinstance(y, p
-00042b70: 642e 5365 7269 6573 2920 6f72 2069 7369  d.Series) or isi
-00042b80: 6e73 7461 6e63 6528 792c 2070 642e 4461  nstance(y, pd.Da
-00042b90: 7461 4672 616d 6529 3a0a 2020 2020 2020  taFrame):.      
-00042ba0: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00042bb0: 2020 795f 7472 6169 6e2c 2079 5f74 6573    y_train, y_tes
-00042bc0: 7420 3d20 792e 696c 6f63 5b74 7261 696e  t = y.iloc[train
-00042bd0: 5f69 6e64 6578 5d2c 2079 2e69 6c6f 635b  _index], y.iloc[
-00042be0: 7465 7374 5f69 6e64 6578 5d20 2020 2020  test_index]     
-00042bf0: 2020 2020 2020 2020 2020 200a 2020 2020             .    
-00042c00: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00042c10: 656c 7365 3a0a 2020 2020 2020 2020 2020  else:.          
-00042c20: 2020 2020 2020 2020 2020 2020 2020 795f                y_
-00042c30: 7472 6169 6e2c 2079 5f74 6573 7420 3d20  train, y_test = 
-00042c40: 795b 7472 6169 6e5f 696e 6465 785d 2c20  y[train_index], 
-00042c50: 795b 7465 7374 5f69 6e64 6578 5d0a 0a20  y[test_index].. 
-00042c60: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00042c70: 2020 2069 6620 6973 696e 7374 616e 6365     if isinstance
-00042c80: 2858 2c20 7064 2e44 6174 6146 7261 6d65  (X, pd.DataFrame
-00042c90: 293a 0a20 2020 2020 2020 2020 2020 2020  ):.             
-00042ca0: 2020 2020 2020 2020 2020 2078 5f74 7261             x_tra
-00042cb0: 696e 2c20 785f 7465 7374 203d 2058 2e69  in, x_test = X.i
-00042cc0: 6c6f 635b 7472 6169 6e5f 696e 6465 785d  loc[train_index]
-00042cd0: 2c20 582e 696c 6f63 5b74 6573 745f 696e  , X.iloc[test_in
-00042ce0: 6465 785d 0a20 2020 2020 2020 2020 2020  dex].           
-00042cf0: 2020 2020 2020 2020 2065 6c73 653a 0a20           else:. 
-00042d00: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00042d10: 2020 2020 2020 2078 5f74 7261 696e 2c20         x_train, 
-00042d20: 785f 7465 7374 203d 2058 5b74 7261 696e  x_test = X[train
-00042d30: 5f69 6e64 6578 5d2c 2058 5b74 6573 745f  _index], X[test_
-00042d40: 696e 6465 785d 0a0a 2020 2020 2020 2020  index]..        
-00042d50: 2020 2020 2020 2020 2020 2020 2323 2323              ####
-00042d60: 2323 2044 6f20 7468 6973 206f 6e6c 7920  ## Do this only 
-00042d70: 7468 6520 6669 7273 7420 7469 6d65 2023  the first time #
-00042d80: 2323 2323 2323 2323 2323 2323 2323 2323  ################
-00042d90: 2323 2323 2323 2323 2323 2323 2323 2323  ################
-00042da0: 2323 2323 2323 2323 2323 2323 2323 230a  ###############.
-00042db0: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00042dc0: 2020 2020 6966 2069 203d 3d20 303a 0a20      if i == 0:. 
-00042dd0: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00042de0: 2020 2020 2020 2023 2323 2049 7420 646f         ### It do
-00042df0: 6573 206e 6f74 206d 616b 6520 7365 6e73  es not make sens
-00042e00: 6520 746f 2064 6f20 6879 7065 722d 7061  e to do hyper-pa
-00042e10: 7261 6d20 7475 6e69 6e67 2066 6f72 206d  ram tuning for m
-00042e20: 756c 7469 2d6c 6162 656c 206d 6f64 656c  ulti-label model
-00042e30: 7320 2323 0a20 2020 2020 2020 2020 2020  s ##.           
-00042e40: 2020 2020 2020 2020 2020 2020 2023 2323               ###
-00042e50: 2020 2020 7369 6e63 6520 436c 6173 7369      since Classi
-00042e60: 6669 6572 4368 6169 6e73 2064 6f20 6e6f  fierChains do no
-00042e70: 7420 6861 7665 206d 616e 7920 6879 7065  t have many hype
-00042e80: 7220 7061 7261 6d73 2023 2323 2323 2323  r params #######
-00042e90: 2323 2323 2323 2323 2323 0a20 2020 2020  ##########.     
-00042ea0: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00042eb0: 2020 2023 7365 6c66 2e62 6173 655f 6573     #self.base_es
-00042ec0: 7469 6d61 746f 7220 3d20 7261 6e64 5f73  timator = rand_s
-00042ed0: 6561 7263 6828 7365 6c66 2e62 6173 655f  earch(self.base_
-00042ee0: 6573 7469 6d61 746f 722c 2078 5f74 7261  estimator, x_tra
-00042ef0: 696e 2c20 795f 7472 6169 6e2c 200a 2020  in, y_train, .  
-00042f00: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00042f10: 2020 2020 2020 2320 2020 2020 2020 2020        #         
-00042f20: 2020 2020 2020 2020 2020 2020 2020 2073                 s
-00042f30: 656c 662e 6d6f 6465 6c5f 6e61 6d65 2c20  elf.model_name, 
-00042f40: 7665 7262 6f73 653d 7365 6c66 2e76 6572  verbose=self.ver
-00042f50: 626f 7365 290a 2020 2020 2020 2020 2020  bose).          
-00042f60: 2020 2020 2020 2020 2020 2020 2020 2370                #p
-00042f70: 7269 6e74 2827 2020 2020 6879 7065 7220  rint('    hyper 
-00042f80: 7475 6e65 6420 6261 7365 2065 7374 696d  tuned base estim
-00042f90: 6174 6f72 203d 2025 7327 2025 7365 6c66  ator = %s' %self
-00042fa0: 2e62 6173 655f 6573 7469 6d61 746f 7229  .base_estimator)
-00042fb0: 0a20 2020 2020 2020 2020 2020 2020 2020  .               
-00042fc0: 2020 2020 2020 2020 2069 6620 7365 6c66           if self
-00042fd0: 2e76 6572 626f 7365 3a0a 2020 2020 2020  .verbose:.      
-00042fe0: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00042ff0: 2020 2020 2020 7072 696e 7428 2720 2020        print('   
-00043000: 2046 6974 7469 6e67 2077 6974 6820 5265   Fitting with Re
-00043010: 6772 6573 736f 7243 6861 696e 2e2e 2e27  gressorChain...'
-00043020: 290a 2020 2020 2020 2020 2020 2020 2020  ).              
-00043030: 2020 2020 2020 2020 2020 6573 745f 6c69            est_li
-00043040: 7374 203d 205b 5265 6772 6573 736f 7243  st = [RegressorC
-00043050: 6861 696e 2873 656c 662e 6261 7365 5f65  hain(self.base_e
-00043060: 7374 696d 6174 6f72 2c20 6f72 6465 723d  stimator, order=
-00043070: 4e6f 6e65 2c20 7261 6e64 6f6d 5f73 7461  None, random_sta
-00043080: 7465 3d69 290a 2020 2020 2020 2020 2020  te=i).          
-00043090: 2020 2020 2020 2020 2020 2020 2020 2020                  
-000430a0: 2020 2020 2020 2020 2020 666f 7220 6920            for i 
-000430b0: 696e 2072 616e 6765 286e 756d 5f69 7465  in range(num_ite
-000430c0: 7261 7469 6f6e 7329 5d20 0a0a 2020 2020  rations)] ..    
-000430d0: 2020 2020 2020 2020 2020 2020 2020 2020                  
-000430e0: 2320 496e 6974 6961 6c69 7a65 206d 6f64  # Initialize mod
-000430f0: 656c 2077 6974 6820 796f 7572 2073 7570  el with your sup
-00043100: 6572 7669 7365 6420 616c 676f 7269 7468  ervised algorith
-00043110: 6d20 6f66 2063 686f 6963 650a 2020 2020  m of choice.    
-00043120: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00043130: 6d6f 6465 6c20 3d20 6573 745f 6c69 7374  model = est_list
-00043140: 5b69 5d0a 0a20 2020 2020 2020 2020 2020  [i]..           
-00043150: 2020 2020 2020 2020 2023 2054 7261 696e           # Train
-00043160: 206d 6f64 656c 2061 6e64 2075 7365 2069   model and use i
-00043170: 7420 746f 2074 7261 696e 206f 6e20 7468  t to train on th
-00043180: 6520 666f 6c64 0a20 2020 2020 2020 2020  e fold.         
-00043190: 2020 2020 2020 2020 2020 2069 6620 7365             if se
-000431a0: 6c66 2e70 6970 656c 696e 653a 0a20 2020  lf.pipeline:.   
-000431b0: 2020 2020 2020 2020 2020 2020 2020 2020                  
-000431c0: 2020 2020 2023 2323 2054 6869 7320 6973       ### This is
-000431d0: 206f 6e6c 7920 7769 7468 2061 2070 6970   only with a pip
-000431e0: 656c 696e 6520 2323 2323 2323 2323 0a20  eline ########. 
-000431f0: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00043200: 2020 2020 2020 2070 6970 6520 3d20 5069         pipe = Pi
-00043210: 7065 6c69 6e65 280a 2020 2020 2020 2020  peline(.        
-00043220: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00043230: 2020 2020 7374 6570 733d 5b28 2270 7265      steps=[("pre
-00043240: 7072 6f63 6573 736f 7222 2c20 7072 6570  processor", prep
-00043250: 726f 6365 7373 6f72 292c 2028 226d 6f64  rocessor), ("mod
-00043260: 656c 222c 206d 6f64 656c 295d 0a20 2020  el", model)].   
+000420a0: 2020 2020 2020 2020 2020 2020 2020 2020                  
+000420b0: 2373 616d 706c 696e 675f 7374 7261 7465  #sampling_strate
+000420c0: 6779 3d63 6c61 7373 5f77 6569 6768 7465  gy=class_weighte
+000420d0: 645f 726f 7773 290a 2020 2020 2020 2020  d_rows).        
+000420e0: 2020 2020 2020 2020 2020 2020 785f 7472              x_tr
+000420f0: 6169 6e2c 2079 5f74 7261 696e 203d 2073  ain, y_train = s
+00042100: 6d2e 6669 745f 7265 7361 6d70 6c65 2878  m.fit_resample(x
+00042110: 5f74 7261 696e 2c20 795f 7472 6169 6e29  _train, y_train)
+00042120: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00042130: 2020 2020 0a20 2020 2020 2020 2020 2020      .           
+00042140: 2020 2020 2020 2020 2069 6620 6920 3d3d           if i ==
+00042150: 2030 2061 6e64 2073 6d6f 7465 3a0a 2020   0 and smote:.  
+00042160: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00042170: 2020 2020 2020 7072 696e 7428 2720 2020        print('   
+00042180: 2078 5f74 7261 696e 2073 6861 7065 2061   x_train shape a
+00042190: 6674 6572 2053 4d4f 5445 203d 2025 7327  fter SMOTE = %s'
+000421a0: 2025 2878 5f74 7261 696e 2e73 6861 7065   %(x_train.shape
+000421b0: 2c29 290a 2020 2020 2020 2020 2020 2020  ,)).            
+000421c0: 0a20 2020 2020 2020 2020 2020 2023 2049  .            # I
+000421d0: 6e69 7469 616c 697a 6520 6d6f 6465 6c20  nitialize model 
+000421e0: 7769 7468 2079 6f75 7220 7375 7065 7276  with your superv
+000421f0: 6973 6564 2061 6c67 6f72 6974 686d 206f  ised algorithm o
+00042200: 6620 6368 6f69 6365 0a20 2020 2020 2020  f choice.       
+00042210: 2020 2020 206d 6f64 656c 203d 2065 7374       model = est
+00042220: 5f6c 6973 745b 695d 0a20 2020 2020 2020  _list[i].       
+00042230: 2020 2020 200a 2020 2020 2020 2020 2020       .          
+00042240: 2020 6d6f 6465 6c2e 6669 7428 785f 7472    model.fit(x_tr
+00042250: 6169 6e2c 2079 5f74 7261 696e 290a 2020  ain, y_train).  
+00042260: 2020 2020 2020 2020 2020 7365 6c66 2e6d            self.m
+00042270: 6f64 656c 732e 6170 7065 6e64 286d 6f64  odels.append(mod
+00042280: 656c 290a 0a20 2020 2020 2020 2020 2020  el)..           
+00042290: 2023 2050 7265 6469 6374 206f 6e20 7265   # Predict on re
+000422a0: 6d61 696e 696e 6720 6461 7461 206f 6620  maining data of 
+000422b0: 6561 6368 2066 6f6c 640a 2020 2020 2020  each fold.      
+000422c0: 2020 2020 2020 7072 6564 7320 3d20 6d6f        preds = mo
+000422d0: 6465 6c2e 7072 6564 6963 7428 785f 7465  del.predict(x_te
+000422e0: 7374 290a 0a20 2020 2020 2020 2020 2020  st)..           
+000422f0: 2069 6620 7365 6c66 2e6c 6f67 5f74 7261   if self.log_tra
+00042300: 6e73 666f 726d 3a0a 2020 2020 2020 2020  nsform:.        
+00042310: 2020 2020 2020 2020 7072 6564 7320 3d20          preds = 
+00042320: 6e70 2e65 7870 6d31 2870 7265 6473 290a  np.expm1(preds).
+00042330: 2020 2020 2020 2020 2020 2020 656c 6966              elif
+00042340: 2073 656c 662e 696e 7465 6765 7273 5f6f   self.integers_o
+00042350: 6e6c 793a 0a20 2020 2020 2020 2020 2020  nly:.           
+00042360: 2020 2020 2023 2323 2055 7365 2052 6567       ### Use Reg
+00042370: 7265 7373 696f 6e20 7072 6564 6963 7469  ression predicti
+00042380: 6f6e 7320 616e 6420 636f 6e76 6572 7420  ons and convert 
+00042390: 7468 656d 2069 6e74 6f20 696e 7465 6765  them into intege
+000423a0: 7273 2068 6572 6520 2323 0a20 2020 2020  rs here ##.     
+000423b0: 2020 2020 2020 2020 2020 2070 7265 6473             preds
+000423c0: 203d 206e 702e 726f 756e 6428 7072 6564   = np.round(pred
+000423d0: 732c 3029 2e61 7374 7970 6528 696e 7429  s,0).astype(int)
+000423e0: 0a0a 2020 2020 2020 2020 2020 2020 7363  ..            sc
+000423f0: 6f72 6520 3d20 7072 696e 745f 7265 6772  ore = print_regr
+00042400: 6573 7369 6f6e 5f6d 6f64 656c 5f73 7461  ession_model_sta
+00042410: 7473 2879 5f74 6573 742c 2070 7265 6473  ts(y_test, preds
+00042420: 290a 2020 2020 2020 2020 2020 2020 6966  ).            if
+00042430: 2073 656c 662e 7665 7262 6f73 653a 0a20   self.verbose:. 
+00042440: 2020 2020 2020 2020 2020 2020 2020 2070                 p
+00042450: 7269 6e74 2822 2020 2020 466f 6c64 2025  rint("    Fold %
+00042460: 733a 206f 7574 2d6f 662d 666f 6c64 2052  s: out-of-fold R
+00042470: 4d53 4520 2873 6d61 6c6c 6572 2069 7320  MSE (smaller is 
+00042480: 6265 7474 6572 293a 2025 302e 3366 2220  better): %0.3f" 
+00042490: 2528 692b 312c 2073 636f 7265 2929 0a20  %(i+1, score)). 
+000424a0: 2020 2020 2020 2020 2020 2020 2020 2070                 p
+000424b0: 7269 6e74 2822 2020 2020 2020 2020 2020  rint("          
+000424c0: 2020 2020 4e6f 726d 616c 697a 6564 2052      Normalized R
+000424d0: 4d53 4520 2873 6d61 6c6c 6572 2069 7320  MSE (smaller is 
+000424e0: 6265 7474 6572 293a 2025 302e 3366 2220  better): %0.3f" 
+000424f0: 2528 7363 6f72 652f 6e70 2e73 7464 2879  %(score/np.std(y
+00042500: 5f74 6573 7429 2929 0a20 2020 2020 2020  _test))).       
+00042510: 2020 2020 2073 656c 662e 7363 6f72 6573       self.scores
+00042520: 2e61 7070 656e 6428 7363 6f72 6529 0a0a  .append(score)..
+00042530: 2020 2020 2020 2020 2020 2020 6920 2b3d              i +=
+00042540: 2031 0a0a 2020 2020 2020 2020 2320 436f   1..        # Co
+00042550: 6d70 7574 6520 6176 6572 6167 6520 7363  mpute average sc
+00042560: 6f72 650a 2020 2020 2020 2020 6176 6572  ore.        aver
+00042570: 6167 6541 6363 7572 6163 7920 3d20 7375  ageAccuracy = su
+00042580: 6d28 7365 6c66 2e73 636f 7265 7329 2f6c  m(self.scores)/l
+00042590: 656e 2873 656c 662e 7363 6f72 6573 290a  en(self.scores).
+000425a0: 2020 2020 2020 2020 7072 696e 7428 2246          print("F
+000425b0: 696e 616c 2052 4d53 4520 6f66 2025 732d  inal RMSE of %s-
+000425c0: 6573 7469 6d61 746f 7220 5375 6c6f 5265  estimator SuloRe
+000425d0: 6772 6573 736f 723a 2025 302e 3366 2220  gressor: %0.3f" 
+000425e0: 2528 6e75 6d5f 6974 6572 6174 696f 6e73  %(num_iterations
+000425f0: 2c20 6176 6572 6167 6541 6363 7572 6163  , averageAccurac
+00042600: 7929 290a 2020 2020 2020 2020 7072 696e  y)).        prin
+00042610: 7428 2220 2020 2046 696e 616c 204e 6f72  t("    Final Nor
+00042620: 6d61 6c69 7a65 6420 524d 5345 3a20 2530  malized RMSE: %0
+00042630: 2e31 6625 2522 2025 2831 3030 2a61 7665  .1f%%" %(100*ave
+00042640: 7261 6765 4163 6375 7261 6379 2f6e 702e  rageAccuracy/np.
+00042650: 7374 6428 795f 7465 7374 2929 290a 0a20  std(y_test))).. 
+00042660: 2020 2020 2020 2023 2046 696e 616c 6c79         # Finally
+00042670: 2c20 6368 6563 6b20 6f75 7420 7468 6520  , check out the 
+00042680: 746f 7461 6c20 7469 6d65 2074 616b 656e  total time taken
+00042690: 0a20 2020 2020 2020 2065 6e64 203d 2074  .        end = t
+000426a0: 696d 652e 7469 6d65 2829 0a20 2020 2020  ime.time().     
+000426b0: 2020 2074 696d 6554 616b 656e 203d 2065     timeTaken = e
+000426c0: 6e64 2d73 7461 7274 0a20 2020 2020 2020  nd-start.       
+000426d0: 2070 7269 6e74 2822 5469 6d65 2054 616b   print("Time Tak
+000426e0: 656e 3a20 2530 2e30 6620 2873 6563 6f6e  en: %0.0f (secon
+000426f0: 6473 2922 2025 7469 6d65 5461 6b65 6e29  ds)" %timeTaken)
+00042700: 0a20 2020 2020 2020 2073 656c 662e 6b66  .        self.kf
+00042710: 203d 206b 666f 6c64 0a0a 2020 2020 2020   = kfold..      
+00042720: 2020 7265 7475 726e 2073 656c 660a 0a20    return self.. 
+00042730: 2020 2064 6566 2070 7265 6469 6374 2873     def predict(s
+00042740: 656c 662c 2058 293a 0a20 2020 2020 2020  elf, X):.       
+00042750: 2066 726f 6d20 7363 6970 7920 696d 706f   from scipy impo
+00042760: 7274 2073 7461 7473 0a20 2020 2020 2020  rt stats.       
+00042770: 2077 6569 6768 7473 203d 2031 2f6e 702e   weights = 1/np.
+00042780: 6172 7261 7928 7365 6c66 2e73 636f 7265  array(self.score
+00042790: 7329 0a20 2020 2020 2020 2069 6620 7365  s).        if se
+000427a0: 6c66 2e6d 756c 7469 5f6c 6162 656c 3a0a  lf.multi_label:.
+000427b0: 2020 2020 2020 2020 2020 2020 2323 2320              ### 
+000427c0: 496e 206d 756c 7469 2d6c 6162 656c 2c20  In multi-label, 
+000427d0: 7461 7267 6574 7320 6861 7665 2074 6f20  targets have to 
+000427e0: 6265 206e 756d 6572 6963 2c20 736f 2079  be numeric, so y
+000427f0: 6f75 2063 616e 206c 6561 7665 2077 6569  ou can leave wei
+00042800: 6768 7473 2061 732d 6973 2023 230a 2020  ghts as-is ##.  
+00042810: 2020 2020 2020 2020 2020 7970 7265 203d            ypre =
+00042820: 206e 702e 6172 7261 7928 5b6d 6f64 656c   np.array([model
+00042830: 2e70 7265 6469 6374 2858 2920 666f 7220  .predict(X) for 
+00042840: 6d6f 6465 6c20 696e 2073 656c 662e 6d6f  model in self.mo
+00042850: 6465 6c73 205d 290a 2020 2020 2020 2020  dels ]).        
+00042860: 2020 2020 795f 7072 6564 6973 203d 206e      y_predis = n
+00042870: 702e 6176 6572 6167 6528 7970 7265 2c20  p.average(ypre, 
+00042880: 6178 6973 3d30 2c20 7765 6967 6874 733d  axis=0, weights=
+00042890: 7765 6967 6874 7329 0a20 2020 2020 2020  weights).       
+000428a0: 2020 2020 2069 6620 7365 6c66 2e6c 6f67       if self.log
+000428b0: 5f74 7261 6e73 666f 726d 3a0a 2020 2020  _transform:.    
+000428c0: 2020 2020 2020 2020 2020 2020 795f 7072              y_pr
+000428d0: 6564 6973 203d 206e 702e 6578 706d 3128  edis = np.expm1(
+000428e0: 795f 7072 6564 6973 290a 2020 2020 2020  y_predis).      
+000428f0: 2020 2020 2020 2323 2320 6c65 6176 6520        ### leave 
+00042900: 7468 6520 6e65 7874 206c 696e 6520 6173  the next line as
+00042910: 2069 6620 7369 6e63 6520 796f 7520 7761   if since you wa
+00042920: 6e74 2074 6f20 6368 6563 6b20 666f 7220  nt to check for 
+00042930: 6974 2073 6570 6172 6174 656c 790a 2020  it separately.  
+00042940: 2020 2020 2020 2020 2020 6966 2073 656c            if sel
+00042950: 662e 696e 7465 6765 7273 5f6f 6e6c 793a  f.integers_only:
+00042960: 0a20 2020 2020 2020 2020 2020 2020 2020  .               
+00042970: 2079 5f70 7265 6469 7320 3d20 6e70 2e72   y_predis = np.r
+00042980: 6f75 6e64 2879 5f70 7265 6469 732c 3029  ound(y_predis,0)
+00042990: 2e61 7374 7970 6528 696e 7429 0a20 2020  .astype(int).   
+000429a0: 2020 2020 2020 2020 2072 6574 7572 6e20           return 
+000429b0: 795f 7072 6564 6973 0a20 2020 2020 2020  y_predis.       
+000429c0: 2079 5f70 7265 6469 7320 3d20 6e70 2e63   y_predis = np.c
+000429d0: 6f6c 756d 6e5f 7374 6163 6b28 5b6d 6f64  olumn_stack([mod
+000429e0: 656c 2e70 7265 6469 6374 2858 2920 666f  el.predict(X) fo
+000429f0: 7220 6d6f 6465 6c20 696e 2073 656c 662e  r model in self.
+00042a00: 6d6f 6465 6c73 205d 290a 2020 2020 2020  models ]).      
+00042a10: 2020 2323 2320 5468 6973 2077 6569 6768    ### This weigh
+00042a20: 7473 2074 6865 206d 6f64 656c 2773 2070  ts the model's p
+00042a30: 7265 6469 6374 696f 6e73 2061 6363 6f72  redictions accor
+00042a40: 6469 6e67 2074 6f20 4f4f 4220 7363 6f72  ding to OOB scor
+00042a50: 6573 206f 6274 6169 6e65 640a 2020 2020  es obtained.    
+00042a60: 2020 2020 2323 2323 2049 6e20 7369 6e67      #### In sing
+00042a70: 6c65 206c 6162 656c 2c20 7461 7267 6574  le label, target
+00042a80: 7320 6361 6e20 6265 206f 626a 6563 7420  s can be object 
+00042a90: 6f72 2073 7472 696e 672c 2073 6f20 7765  or string, so we
+00042aa0: 6967 6874 7320 6361 6e6e 6f74 2062 6520  ights cannot be 
+00042ab0: 6170 706c 6965 6420 616c 7761 7973 2023  applied always #
+00042ac0: 230a 2020 2020 2020 2020 795f 7072 6564  #.        y_pred
+00042ad0: 6973 203d 206e 702e 6176 6572 6167 6528  is = np.average(
+00042ae0: 795f 7072 6564 6973 2c20 7765 6967 6874  y_predis, weight
+00042af0: 733d 7765 6967 6874 732c 2061 7869 733d  s=weights, axis=
+00042b00: 3129 0a20 2020 2020 2020 2069 6620 7365  1).        if se
+00042b10: 6c66 2e6c 6f67 5f74 7261 6e73 666f 726d  lf.log_transform
+00042b20: 3a0a 2020 2020 2020 2020 2020 2020 795f  :.            y_
+00042b30: 7072 6564 6973 203d 206e 702e 6578 706d  predis = np.expm
+00042b40: 3128 795f 7072 6564 6973 290a 2020 2020  1(y_predis).    
+00042b50: 2020 2020 6966 2073 656c 662e 696e 7465      if self.inte
+00042b60: 6765 7273 5f6f 6e6c 793a 0a20 2020 2020  gers_only:.     
+00042b70: 2020 2020 2020 2079 5f70 7265 6469 7320         y_predis 
+00042b80: 3d20 6e70 2e72 6f75 6e64 2879 5f70 7265  = np.round(y_pre
+00042b90: 6469 732c 3029 2e61 7374 7970 6528 696e  dis,0).astype(in
+00042ba0: 7429 0a20 2020 2020 2020 2072 6574 7572  t).        retur
+00042bb0: 6e20 795f 7072 6564 6973 0a20 2020 200a  n y_predis.    .
+00042bc0: 2020 2020 6465 6620 7072 6564 6963 745f      def predict_
+00042bd0: 7072 6f62 6128 7365 6c66 2c20 5829 3a0a  proba(self, X):.
+00042be0: 2020 2020 2020 2020 7072 696e 7428 2745          print('E
+00042bf0: 7272 6f72 3a20 496e 2072 6567 7265 7373  rror: In regress
+00042c00: 696f 6e20 7072 6f62 6c65 6d73 2c20 6e6f  ion problems, no
+00042c10: 2070 726f 6261 6269 6c69 7469 6573 2063   probabilities c
+00042c20: 616e 2062 6520 6f62 7461 696e 6564 2e20  an be obtained. 
+00042c30: 5265 7475 726e 696e 672e 2e2e 2729 0a20  Returning...'). 
+00042c40: 2020 2020 2020 2072 6574 7572 6e20 580a         return X.
+00042c50: 0a20 2020 2064 6566 2072 6574 7572 6e5f  .    def return_
+00042c60: 776f 7273 745f 666f 6c64 2873 656c 662c  worst_fold(self,
+00042c70: 2058 293a 0a20 2020 2020 2020 2022 2222   X):.        """
+00042c80: 0a20 2020 2020 2020 2054 6869 7320 6d65  .        This me
+00042c90: 7468 6f64 2072 6574 7572 6e73 2074 6865  thod returns the
+00042ca0: 2077 6f72 7374 2070 6572 666f 726d 696e   worst performin
+00042cb0: 6720 7472 6169 6e20 616e 6420 7465 7374  g train and test
+00042cc0: 2072 6f77 7320 616d 6f6e 6720 616c 6c20   rows among all 
+00042cd0: 7468 6520 666f 6c64 732e 0a20 2020 2020  the folds..     
+00042ce0: 2020 2054 6869 7320 6973 2076 6572 7920     This is very 
+00042cf0: 696d 706f 7274 616e 7420 696e 666f 726d  important inform
+00042d00: 6174 696f 6e20 7369 6e63 6520 6974 2068  ation since it h
+00042d10: 656c 7073 2061 6e20 4d4c 2065 6e67 696e  elps an ML engin
+00042d20: 6565 7220 6f72 2044 6174 6120 5363 6965  eer or Data Scie
+00042d30: 6e74 6973 7420 0a20 2020 2020 2020 2020  ntist .         
+00042d40: 2020 2074 6f20 7472 6f75 626c 6520 7368     to trouble sh
+00042d50: 6f6f 7420 7469 6d65 2073 6572 6965 7320  oot time series 
+00042d60: 7072 6f62 6c65 6d73 2e20 4974 2068 656c  problems. It hel
+00042d70: 7073 2074 6f20 6669 6e64 2077 6865 7265  ps to find where
+00042d80: 2074 6865 206d 6f64 656c 2069 7320 7374   the model is st
+00042d90: 7275 6767 6c69 6e67 2e0a 0a20 2020 2020  ruggling...     
+00042da0: 2020 2049 6e70 7574 733a 0a20 2020 2020     Inputs:.     
+00042db0: 2020 202d 2d2d 2d2d 2d2d 2d0a 2020 2020     --------.    
+00042dc0: 2020 2020 583a 2044 6174 6166 7261 6d65      X: Dataframe
+00042dd0: 2e20 5468 6973 206d 7573 7420 6265 2074  . This must be t
+00042de0: 6865 2066 6561 7475 7265 7320 6461 7461  he features data
+00042df0: 6672 616d 6520 6f66 2079 6f75 7220 6461  frame of your da
+00042e00: 7461 7365 742e 2049 7420 6361 6e6e 6f74  taset. It cannot
+00042e10: 2062 6520 6120 6e75 6d70 7920 6172 7261   be a numpy arra
+00042e20: 792e 0a0a 2020 2020 2020 2020 4f75 7470  y...        Outp
+00042e30: 7574 733a 0a20 2020 2020 2020 202d 2d2d  uts:.        ---
+00042e40: 2d2d 2d2d 2d2d 0a20 2020 2020 2020 2074  ------.        t
+00042e50: 7261 696e 5f72 6f77 735f 6461 7461 6672  rain_rows_datafr
+00042e60: 616d 652c 2074 6573 745f 726f 7773 5f64  ame, test_rows_d
+00042e70: 6174 6166 7261 6d65 3a20 4461 7461 6672  ataframe: Datafr
+00042e80: 616d 6573 2e20 0a20 2020 2020 2020 2020  ames. .         
+00042e90: 2020 2020 5468 6973 2072 6574 7572 6e73      This returns
+00042ea0: 2074 6865 2070 6f72 7469 6f6e 206f 6620   the portion of 
+00042eb0: 5820 6173 2074 7261 696e 2061 6e64 2074  X as train and t
+00042ec0: 6573 7420 746f 2068 656c 7020 796f 7520  est to help you 
+00042ed0: 756e 6465 7273 7461 6e64 2077 6865 7265  understand where
+00042ee0: 206d 6f64 656c 2073 7472 7567 676c 6564   model struggled
+00042ef0: 2e0a 2020 2020 2020 2020 2222 220a 2020  ..        """.  
+00042f00: 2020 2020 2020 776f 7273 745f 666f 6c64        worst_fold
+00042f10: 203d 206e 702e 6172 676d 6178 2873 656c   = np.argmax(sel
+00042f20: 662e 7363 6f72 6573 290a 2020 2020 2020  f.scores).      
+00042f30: 2020 666f 7220 692c 2028 7472 2c20 7474    for i, (tr, tt
+00042f40: 2920 696e 2065 6e75 6d65 7261 7465 2873  ) in enumerate(s
+00042f50: 656c 662e 6b66 2e73 706c 6974 2858 2929  elf.kf.split(X))
+00042f60: 3a0a 2020 2020 2020 2020 2020 2020 6966  :.            if
+00042f70: 2069 203d 3d20 776f 7273 745f 666f 6c64   i == worst_fold
+00042f80: 3a0a 2020 2020 2020 2020 2020 2020 2020  :.              
+00042f90: 2020 776f 7273 745f 7472 6169 6e5f 726f    worst_train_ro
+00042fa0: 7773 203d 2063 6f70 792e 6465 6570 636f  ws = copy.deepco
+00042fb0: 7079 2874 7229 0a20 2020 2020 2020 2020  py(tr).         
+00042fc0: 2020 2020 2020 2077 6f72 7374 5f74 7465         worst_tte
+00042fd0: 7374 5f72 6f77 7320 3d20 636f 7079 2e64  st_rows = copy.d
+00042fe0: 6565 7063 6f70 7928 7474 290a 2020 2020  eepcopy(tt).    
+00042ff0: 2020 2020 2020 2020 2020 2020 7072 696e              prin
+00043000: 7428 2266 6f6c 6420 2573 3a20 7472 6169  t("fold %s: trai
+00043010: 6e20 726f 7773 2069 6e64 6578 203d 2025  n rows index = %
+00043020: 732e 2053 756c 6f20 6d6f 6465 6c20 7374  s. Sulo model st
+00043030: 7275 6767 6c65 6420 696e 2074 6869 7320  ruggled in this 
+00043040: 666f 6c64 2e22 2025 2869 2b31 2c74 7229  fold." %(i+1,tr)
+00043050: 290a 2020 2020 2020 2020 2020 2020 656c  ).            el
+00043060: 7365 3a0a 2020 2020 2020 2020 2020 2020  se:.            
+00043070: 2020 2020 7072 696e 7428 2266 6f6c 6420      print("fold 
+00043080: 2573 3a20 7472 6169 6e20 726f 7773 2069  %s: train rows i
+00043090: 6e64 6578 203d 2025 7322 2025 2869 2b31  ndex = %s" %(i+1
+000430a0: 2c74 7229 290a 2020 2020 2020 2020 7265  ,tr)).        re
+000430b0: 7475 726e 2058 2e69 6c6f 635b 776f 7273  turn X.iloc[wors
+000430c0: 745f 7472 6169 6e5f 726f 7773 5d2c 2058  t_train_rows], X
+000430d0: 2e69 6c6f 635b 776f 7273 745f 7474 6573  .iloc[worst_ttes
+000430e0: 745f 726f 7773 5d0a 0a20 2020 2064 6566  t_rows]..    def
+000430f0: 2070 6c6f 745f 696d 706f 7274 616e 6365   plot_importance
+00043100: 2873 656c 662c 206d 6178 5f66 6561 7475  (self, max_featu
+00043110: 7265 733d 3130 293a 0a20 2020 2020 2020  res=10):.       
+00043120: 2069 6d70 6f72 7420 6c69 6768 7467 626d   import lightgbm
+00043130: 2061 7320 6c67 626d 0a20 2020 2020 2020   as lgbm.       
+00043140: 2066 726f 6d20 7867 626f 6f73 7420 696d   from xgboost im
+00043150: 706f 7274 2070 6c6f 745f 696d 706f 7274  port plot_import
+00043160: 616e 6365 0a20 2020 2020 2020 206d 6f64  ance.        mod
+00043170: 656c 5f6e 616d 6520 3d20 7365 6c66 2e6d  el_name = self.m
+00043180: 6f64 656c 5f6e 616d 650a 2020 2020 2020  odel_name.      
+00043190: 2020 6665 6174 7572 655f 6e61 6d65 7320    feature_names 
+000431a0: 3d20 7365 6c66 2e66 6561 7475 7265 730a  = self.features.
+000431b0: 0a20 2020 2020 2020 2069 6620 206d 6f64  .        if  mod
+000431c0: 656c 5f6e 616d 6520 3d3d 2027 6c67 6227  el_name == 'lgb'
+000431d0: 206f 7220 6d6f 6465 6c5f 6e61 6d65 203d   or model_name =
+000431e0: 3d20 2778 6762 273a 0a20 2020 2020 2020  = 'xgb':.       
+000431f0: 2020 2020 2066 6f72 2069 2c20 6d6f 6465       for i, mode
+00043200: 6c20 696e 2065 6e75 6d65 7261 7465 2873  l in enumerate(s
+00043210: 656c 662e 6d6f 6465 6c73 293a 0a20 2020  elf.models):.   
+00043220: 2020 2020 2020 2020 2020 2020 2069 6620               if 
+00043230: 7365 6c66 2e70 6970 656c 696e 653a 0a20  self.pipeline:. 
+00043240: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00043250: 2020 2069 6620 7365 6c66 2e6d 756c 7469     if self.multi
+00043260: 5f6c 6162 656c 3a0a 2020 2020 2020 2020  _label:.        
 00043270: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00043280: 2020 2020 2029 0a0a 2020 2020 2020 2020       )..        
-00043290: 2020 2020 2020 2020 2020 2020 2020 2020                  
-000432a0: 7069 7065 2e66 6974 2878 5f74 7261 696e  pipe.fit(x_train
-000432b0: 2c20 795f 7472 6169 6e29 0a20 2020 2020  , y_train).     
+00043280: 236d 6f64 656c 5f6f 626a 6563 7420 3d20  #model_object = 
+00043290: 6d6f 6465 6c2e 6e61 6d65 645f 7374 6570  model.named_step
+000432a0: 735b 276d 6f64 656c 275d 2e62 6173 655f  s['model'].base_
+000432b0: 6573 7469 6d61 746f 720a 2020 2020 2020  estimator.      
 000432c0: 2020 2020 2020 2020 2020 2020 2020 2020                  
-000432d0: 2020 2073 656c 662e 6d6f 6465 6c73 2e61     self.models.a
-000432e0: 7070 656e 6428 7069 7065 290a 0a20 2020  ppend(pipe)..   
-000432f0: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00043300: 2020 2020 2023 2050 7265 6469 6374 206f       # Predict o
-00043310: 6e20 7265 6d61 696e 696e 6720 6461 7461  n remaining data
-00043320: 206f 6620 6561 6368 2066 6f6c 640a 2020   of each fold.  
-00043330: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00043340: 2020 2020 2020 7072 6564 7320 3d20 7069        preds = pi
-00043350: 7065 2e70 7265 6469 6374 2878 5f74 6573  pe.predict(x_tes
-00043360: 7429 0a0a 2020 2020 2020 2020 2020 2020  t)..            
-00043370: 2020 2020 2020 2020 656c 7365 3a0a 2020          else:.  
-00043380: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00043390: 2020 2020 2020 2323 2323 2054 6869 7320        #### This 
-000433a0: 6973 2077 6974 686f 7574 2061 2070 6970  is without a pip
-000433b0: 656c 696e 6520 2323 230a 2020 2020 2020  eline ###.      
-000433c0: 2020 2020 2020 2020 2020 2020 2020 2020                  
-000433d0: 2020 6d6f 6465 6c2e 6669 7428 785f 7472    model.fit(x_tr
-000433e0: 6169 6e2c 2079 5f74 7261 696e 290a 2020  ain, y_train).  
-000433f0: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00043400: 2020 2020 2020 7365 6c66 2e6d 6f64 656c        self.model
-00043410: 732e 6170 7065 6e64 286d 6f64 656c 290a  s.append(model).
-00043420: 0a20 2020 2020 2020 2020 2020 2020 2020  .               
-00043430: 2020 2020 2020 2020 2023 2050 7265 6469           # Predi
-00043440: 6374 206f 6e20 7265 6d61 696e 696e 6720  ct on remaining 
-00043450: 6461 7461 206f 6620 6561 6368 2066 6f6c  data of each fol
-00043460: 640a 2020 2020 2020 2020 2020 2020 2020  d.              
-00043470: 2020 2020 2020 2020 2020 7072 6564 7320            preds 
-00043480: 3d20 6d6f 6465 6c2e 7072 6564 6963 7428  = model.predict(
-00043490: 785f 7465 7374 290a 0a20 2020 2020 2020  x_test)..       
+000432d0: 2020 7072 696e 7428 274e 6f20 6665 6174    print('No feat
+000432e0: 7572 6520 696d 706f 7274 616e 6365 7320  ure importances 
+000432f0: 6176 6169 6c61 626c 6520 666f 7220 6d75  available for mu
+00043300: 6c74 695f 6c61 6265 6c20 7461 7267 6574  lti_label target
+00043310: 732e 2052 6574 7572 6e69 6e67 2e2e 2e27  s. Returning...'
+00043320: 290a 2020 2020 2020 2020 2020 2020 2020  ).              
+00043330: 2020 2020 2020 2020 2020 7265 7475 726e            return
+00043340: 0a20 2020 2020 2020 2020 2020 2020 2020  .               
+00043350: 2020 2020 2065 6c73 653a 0a20 2020 2020       else:.     
+00043360: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00043370: 2020 206d 6f64 656c 5f6f 626a 6563 7420     model_object 
+00043380: 3d20 6d6f 6465 6c2e 6e61 6d65 645f 7374  = model.named_st
+00043390: 6570 735b 276d 6f64 656c 275d 0a20 2020  eps['model'].   
+000433a0: 2020 2020 2020 2020 2020 2020 2065 6c73               els
+000433b0: 653a 0a20 2020 2020 2020 2020 2020 2020  e:.             
+000433c0: 2020 2020 2020 2069 6620 7365 6c66 2e6d         if self.m
+000433d0: 756c 7469 5f6c 6162 656c 3a0a 2020 2020  ulti_label:.    
+000433e0: 2020 2020 2020 2020 2020 2020 2020 2020                  
+000433f0: 2020 2020 236d 6f64 656c 5f6f 626a 6563      #model_objec
+00043400: 7420 3d20 6d6f 6465 6c2e 6261 7365 5f65  t = model.base_e
+00043410: 7374 696d 6174 6f72 0a20 2020 2020 2020  stimator.       
+00043420: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00043430: 2070 7269 6e74 2827 4e6f 2066 6561 7475   print('No featu
+00043440: 7265 2069 6d70 6f72 7461 6e63 6573 2061  re importances a
+00043450: 7661 696c 6162 6c65 2066 6f72 206d 756c  vailable for mul
+00043460: 7469 5f6c 6162 656c 2074 6172 6765 7473  ti_label targets
+00043470: 2e20 5265 7475 726e 696e 672e 2e2e 2729  . Returning...')
+00043480: 0a20 2020 2020 2020 2020 2020 2020 2020  .               
+00043490: 2020 2020 2020 2020 2072 6574 7572 6e0a           return.
 000434a0: 2020 2020 2020 2020 2020 2020 2020 2020                  
-000434b0: 2069 6620 7365 6c66 2e6c 6f67 5f74 7261   if self.log_tra
-000434c0: 6e73 666f 726d 3a0a 2020 2020 2020 2020  nsform:.        
-000434d0: 2020 2020 2020 2020 2020 2020 2020 2020                  
-000434e0: 2020 2020 7072 6564 7320 3d20 6e70 2e65      preds = np.e
-000434f0: 7870 6d31 2870 7265 6473 290a 2020 2020  xpm1(preds).    
-00043500: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00043510: 2020 2020 656c 6966 2073 656c 662e 696e      elif self.in
-00043520: 7465 6765 7273 5f6f 6e6c 793a 0a20 2020  tegers_only:.   
-00043530: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00043540: 2020 2020 2020 2020 2023 2323 2055 7365           ### Use
-00043550: 2052 6567 7265 7373 696f 6e20 7072 6564   Regression pred
-00043560: 6963 7469 6f6e 7320 616e 6420 636f 6e76  ictions and conv
-00043570: 6572 7420 7468 656d 2069 6e74 6f20 696e  ert them into in
-00043580: 7465 6765 7273 2068 6572 6520 2323 0a20  tegers here ##. 
-00043590: 2020 2020 2020 2020 2020 2020 2020 2020                  
-000435a0: 2020 2020 2020 2020 2020 2070 7265 6473             preds
-000435b0: 203d 206e 702e 726f 756e 6428 7072 6564   = np.round(pred
-000435c0: 732c 3029 2e61 7374 7970 6528 696e 7429  s,0).astype(int)
-000435d0: 0a20 2020 2020 2020 2020 2020 2020 2020  .               
-000435e0: 2020 2020 2020 2020 2020 2020 200a 2020               .  
-000435f0: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00043600: 2020 7363 6f72 6520 3d20 7072 696e 745f    score = print_
-00043610: 7265 6772 6573 7369 6f6e 5f6d 6f64 656c  regression_model
-00043620: 5f73 7461 7473 2879 5f74 6573 742c 2070  _stats(y_test, p
-00043630: 7265 6473 2c20 7365 6c66 2e76 6572 626f  reds, self.verbo
-00043640: 7365 290a 2020 2020 2020 2020 2020 2020  se).            
-00043650: 2020 2020 2020 2020 6966 2069 203d 3d20          if i == 
-00043660: 303a 0a20 2020 2020 2020 2020 2020 2020  0:.             
-00043670: 2020 2020 2020 2020 2020 2079 5f73 7461             y_sta
-00043680: 636b 203d 2063 6f70 792e 6465 6570 636f  ck = copy.deepco
-00043690: 7079 2879 5f74 6573 7429 0a20 2020 2020  py(y_test).     
-000436a0: 2020 2020 2020 2020 2020 2020 2020 2020                  
-000436b0: 2020 2070 7265 645f 7374 6163 6b20 3d20     pred_stack = 
-000436c0: 636f 7079 2e64 6565 7063 6f70 7928 7072  copy.deepcopy(pr
-000436d0: 6564 7329 0a20 2020 2020 2020 2020 2020  eds).           
-000436e0: 2020 2020 2020 2020 2065 6c73 653a 0a20           else:. 
-000436f0: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00043700: 2020 2020 2020 2079 5f73 7461 636b 203d         y_stack =
-00043710: 2070 642e 636f 6e63 6174 285b 795f 7374   pd.concat([y_st
-00043720: 6163 6b2c 795f 7465 7374 5d2c 2061 7869  ack,y_test], axi
-00043730: 733d 3029 0a20 2020 2020 2020 2020 2020  s=0).           
-00043740: 2020 2020 2020 2020 2020 2020 2070 7265               pre
-00043750: 645f 7374 6163 6b20 3d20 6e70 2e72 5f5b  d_stack = np.r_[
-00043760: 7072 6564 5f73 7461 636b 2c70 7265 6473  pred_stack,preds
-00043770: 5d0a 0a20 2020 2020 2020 2020 2020 2020  ]..             
-00043780: 2020 2020 2020 2069 6620 7365 6c66 2e76         if self.v
-00043790: 6572 626f 7365 3a0a 2020 2020 2020 2020  erbose:.        
-000437a0: 2020 2020 2020 2020 2020 2020 2020 2020                  
-000437b0: 7072 696e 7428 2220 2020 2046 6f6c 6420  print("    Fold 
-000437c0: 2573 3a20 6f75 742d 6f66 2d66 6f6c 6420  %s: out-of-fold 
-000437d0: 524d 5345 2028 736d 616c 6c65 7220 6973  RMSE (smaller is
-000437e0: 2062 6574 7465 7229 3a20 2530 2e33 6622   better): %0.3f"
-000437f0: 2025 2869 2b31 2c20 7363 6f72 6529 290a   %(i+1, score)).
-00043800: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00043810: 2020 2020 7365 6c66 2e73 636f 7265 732e      self.scores.
-00043820: 6170 7065 6e64 2873 636f 7265 290a 2020  append(score).  
-00043830: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00043840: 2020 0a20 2020 2020 2020 2020 2020 2020    .             
-00043850: 2020 2020 2020 2023 2046 696e 616c 6c79         # Finally
-00043860: 2c20 6368 6563 6b20 6f75 7420 7468 6520  , check out the 
-00043870: 746f 7461 6c20 7469 6d65 2074 616b 656e  total time taken
-00043880: 0a20 2020 2020 2020 2020 2020 2020 2020  .               
-00043890: 2020 2020 2065 6e64 5f74 696d 6520 3d20       end_time = 
-000438a0: 7469 6d65 2e74 696d 6528 290a 2020 2020  time.time().    
-000438b0: 2020 2020 2020 2020 2020 2020 2020 2020                  
-000438c0: 7469 6d65 5461 6b65 6e20 3d20 656e 645f  timeTaken = end_
-000438d0: 7469 6d65 202d 2073 7461 7274 5f74 696d  time - start_tim
-000438e0: 650a 2020 2020 2020 2020 2020 2020 2020  e.              
-000438f0: 2020 2020 2020 6966 2073 656c 662e 7665        if self.ve
-00043900: 7262 6f73 653a 0a20 2020 2020 2020 2020  rbose:.         
-00043910: 2020 2020 2020 2020 2020 2020 2020 2070                 p
-00043920: 7269 6e74 2822 5469 6d65 2054 616b 656e  rint("Time Taken
-00043930: 2066 6f72 2066 6f6c 6420 2573 3a20 2530   for fold %s: %0
-00043940: 2e30 6620 2873 6563 6f6e 6473 2922 2025  .0f (seconds)" %
-00043950: 2869 2b31 2c20 7469 6d65 5461 6b65 6e29  (i+1, timeTaken)
-00043960: 290a 2020 2020 2020 2020 2020 2020 2020  ).              
-00043970: 2020 0a20 2020 2020 2020 2020 2020 2020    .             
-00043980: 2020 2020 2020 2069 202b 3d20 310a 0a20         i += 1.. 
-00043990: 2020 2020 2020 2020 2020 2020 2020 2023                 #
-000439a0: 2043 6f6d 7075 7465 2061 7665 7261 6765   Compute average
-000439b0: 2073 636f 7265 0a20 2020 2020 2020 2020   score.         
-000439c0: 2020 2020 2020 2070 7269 6e74 2822 2323         print("##
-000439d0: 2323 2323 2323 2046 696e 616c 2052 6567  ###### Final Reg
-000439e0: 7265 7373 6f72 206d 6574 7269 6373 3a20  ressor metrics: 
-000439f0: 2323 2323 2323 2323 2323 2323 2323 2229  ##############")
-00043a00: 0a20 2020 2020 2020 2020 2020 2020 2020  .               
-00043a10: 206e 6f72 6d61 7665 7261 6765 4163 6375   normaverageAccu
-00043a20: 7261 6379 203d 2070 7269 6e74 5f72 6567  racy = print_reg
-00043a30: 7265 7373 696f 6e5f 6d6f 6465 6c5f 7374  ression_model_st
-00043a40: 6174 7328 795f 7374 6163 6b2c 2070 7265  ats(y_stack, pre
-00043a50: 645f 7374 6163 6b2c 2073 656c 662e 7665  d_stack, self.ve
-00043a60: 7262 6f73 6529 0a20 2020 2020 2020 2020  rbose).         
-00043a70: 2020 2020 2020 2065 6e64 203d 2074 696d         end = tim
-00043a80: 652e 7469 6d65 2829 0a20 2020 2020 2020  e.time().       
-00043a90: 2020 2020 2020 2020 2074 696d 6554 616b           timeTak
-00043aa0: 656e 203d 2065 6e64 202d 2073 7461 7274  en = end - start
-00043ab0: 0a20 2020 2020 2020 2020 2020 2020 2020  .               
-00043ac0: 2070 7269 6e74 2822 5469 6d65 2054 616b   print("Time Tak
-00043ad0: 656e 206f 7665 7261 6c6c 3a20 2530 2e30  en overall: %0.0
-00043ae0: 6620 2873 6563 6f6e 6473 2922 2025 2874  f (seconds)" %(t
-00043af0: 696d 6554 616b 656e 2929 0a20 2020 2020  imeTaken)).     
-00043b00: 2020 2020 2020 2020 2020 2073 656c 662e             self.
-00043b10: 6b66 203d 206b 666f 6c64 0a20 2020 2020  kf = kfold.     
-00043b20: 2020 2020 2020 2020 2020 2072 6574 7572             retur
-00043b30: 6e20 7365 6c66 0a20 2020 2020 2020 2023  n self.        #
-00043b40: 2323 2323 2323 2323 2323 2323 2323 2323  ################
-00043b50: 2323 2323 2323 2323 2323 2323 2323 2323  ################
-00043b60: 2323 2323 2323 2323 2323 2323 2323 2323  ################
-00043b70: 2323 2323 2323 230a 2020 2020 2020 2020  #######.        
-00043b80: 2323 2323 2320 2054 6869 7320 6973 2066  #####  This is f
-00043b90: 6f72 2053 696e 676c 6520 4c61 6265 6c20  or Single Label 
-00043ba0: 5265 6772 6573 7369 6f6e 2070 726f 626c  Regression probl
-00043bb0: 656d 7320 0a20 2020 2020 2020 2023 2323  ems .        ###
-00043bc0: 2323 2323 2323 2323 2323 2323 2323 2323  ################
-00043bd0: 2323 2323 2323 2323 2323 2323 2323 2323  ################
-00043be0: 2323 2323 2323 2323 2323 2323 2323 2323  ################
-00043bf0: 2323 2323 230a 2020 2020 2020 2020 6966  #####.        if
-00043c00: 2069 7369 6e73 7461 6e63 6528 792c 2070   isinstance(y, p
-00043c10: 642e 5365 7269 6573 293a 0a20 2020 2020  d.Series):.     
-00043c20: 2020 2020 2020 2074 6172 6765 7473 203d         targets =
-00043c30: 2079 2e6e 616d 650a 2020 2020 2020 2020   y.name.        
-00043c40: 656c 7365 3a0a 2020 2020 2020 2020 2020  else:.          
-00043c50: 2020 7461 7267 6574 7320 3d20 5b5d 0a0a    targets = []..
-00043c60: 2020 2020 2020 2020 6573 745f 6c69 7374          est_list
-00043c70: 203d 206e 756d 5f69 7465 7261 7469 6f6e   = num_iteration
-00043c80: 732a 5b73 656c 662e 6261 7365 5f65 7374  s*[self.base_est
-00043c90: 696d 6174 6f72 5d0a 2020 2020 2020 2020  imator].        
-00043ca0: 0a20 2020 2020 2020 2023 2323 2069 6620  .        ### if 
-00043cb0: 7468 6572 6520 6973 2061 206e 6565 6420  there is a need 
-00043cc0: 746f 2064 6f20 534d 4f54 4520 646f 2069  to do SMOTE do i
-00043cd0: 7420 6865 7265 2023 230a 2020 2020 2020  t here ##.      
-00043ce0: 2020 736d 6f74 6520 3d20 4661 6c73 650a    smote = False.
-00043cf0: 2020 2020 2020 2020 236c 6973 745f 636c          #list_cl
-00043d00: 6173 7365 7320 3d20 7265 7475 726e 5f6d  asses = return_m
-00043d10: 696e 6f72 6974 795f 636c 6173 7365 7328  inority_classes(
-00043d20: 7929 0a20 2020 2020 2020 2023 6966 206e  y).        #if n
-00043d30: 6f74 206c 6973 745f 636c 6173 7365 732e  ot list_classes.
-00043d40: 656d 7074 793a 0a20 2020 2020 2020 2023  empty:.        #
-00043d50: 2020 2020 736d 6f74 6520 3d20 5472 7565      smote = True
-00043d60: 0a20 2020 2020 2020 2023 2323 2320 466f  .        #### Fo
-00043d70: 7220 6e6f 772c 2064 6f6e 2774 2064 6f20  r now, don't do 
-00043d80: 534d 4f54 4520 7369 6e63 6520 6974 2069  SMOTE since it i
-00043d90: 7320 6d61 6b69 6e67 2074 6869 6e67 7320  s making things 
-00043da0: 7265 616c 6c79 2073 6c6f 7720 2323 0a20  really slow ##. 
-00043db0: 2020 2020 2020 200a 2020 2020 2020 2020         .        
-00043dc0: 2320 5065 7266 6f72 6d20 4356 0a20 2020  # Perform CV.   
-00043dd0: 2020 2020 2069 203d 2030 0a20 2020 2020       i = 0.     
-00043de0: 2020 2066 6f72 2074 7261 696e 5f69 6e64     for train_ind
-00043df0: 6578 2c20 7465 7374 5f69 6e64 6578 2069  ex, test_index i
-00043e00: 6e20 7471 646d 286b 666f 6c64 2e73 706c  n tqdm(kfold.spl
-00043e10: 6974 2858 2c20 7929 2c20 746f 7461 6c3d  it(X, y), total=
-00043e20: 6b66 6f6c 642e 6765 745f 6e5f 7370 6c69  kfold.get_n_spli
-00043e30: 7473 2829 2c20 0a20 2020 2020 2020 2020  ts(), .         
-00043e40: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00043e50: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00043e60: 2020 2064 6573 633d 226b 2d66 6f6c 6420     desc="k-fold 
-00043e70: 7472 6169 6e69 6e67 2229 3a0a 2020 2020  training"):.    
-00043e80: 2020 2020 2020 2020 7374 6172 745f 7469          start_ti
-00043e90: 6d65 203d 2074 696d 652e 7469 6d65 2829  me = time.time()
-00043ea0: 0a20 2020 2020 2020 2020 2020 2072 616e  .            ran
-00043eb0: 646f 6d5f 7365 6564 203d 206e 702e 7261  dom_seed = np.ra
-00043ec0: 6e64 6f6d 2e72 616e 6469 6e74 2832 2c31  ndom.randint(2,1
-00043ed0: 3030 290a 2020 2020 2020 2020 2020 2020  00).            
-00043ee0: 6966 2073 656c 662e 6261 7365 5f65 7374  if self.base_est
-00043ef0: 696d 6174 6f72 2069 7320 4e6f 6e65 3a0a  imator is None:.
-00043f00: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00043f10: 6966 2064 6174 615f 7361 6d70 6c65 7320  if data_samples 
-00043f20: 3c3d 2072 6f77 5f6c 696d 6974 3a0a 2020  <= row_limit:.  
-00043f30: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00043f40: 2020 2323 2320 466f 7220 736d 616c 6c20    ### For small 
-00043f50: 6461 7461 7365 7473 2075 7365 2052 4652  datasets use RFR
-00043f60: 2066 6f72 2052 6567 7265 7373 696f 6e73   for Regressions
-00043f70: 2020 2023 2323 2323 2323 2323 2323 2323     #############
-00043f80: 2323 2323 2323 2323 2323 230a 2020 2020  ###########.    
-00043f90: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00043fa0: 6966 206c 656e 2873 656c 662e 6665 6174  if len(self.feat
-00043fb0: 7572 6573 2920 3c3d 2066 6561 7475 7265  ures) <= feature
-00043fc0: 735f 6c69 6d69 743a 0a20 2020 2020 2020  s_limit:.       
-00043fd0: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00043fe0: 2069 6620 7365 6c66 2e76 6572 626f 7365   if self.verbose
-00043ff0: 3a0a 2020 2020 2020 2020 2020 2020 2020  :.              
-00044000: 2020 2020 2020 2020 2020 2020 2020 7072                pr
-00044010: 696e 7428 2720 2020 2053 656c 6563 7469  int('    Selecti
-00044020: 6e67 2042 6167 6769 6e67 2052 6567 7265  ng Bagging Regre
-00044030: 7373 6f72 2066 6f72 2074 6869 7320 6461  ssor for this da
-00044040: 7461 7365 742e 2e2e 2729 0a20 2020 2020  taset...').     
-00044050: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00044060: 2020 2023 2323 2054 6865 2042 6167 6769     ### The Baggi
-00044070: 6e67 2052 6567 7265 736f 7220 6f75 7470  ng Regresor outp
-00044080: 6572 666f 726d 7320 4554 4320 6d6f 7374  erforms ETC most
-00044090: 206f 6620 7468 6520 7469 6d65 2023 2323   of the time ###
-000440a0: 230a 2020 2020 2020 2020 2020 2020 2020  #.              
-000440b0: 2020 2020 2020 2020 2020 4554 203d 2045            ET = E
-000440c0: 7874 7261 5472 6565 5265 6772 6573 736f  xtraTreeRegresso
-000440d0: 7228 290a 2020 2020 2020 2020 2020 2020  r().            
-000440e0: 2020 2020 2020 2020 2020 2020 4554 203d              ET =
-000440f0: 204c 696e 6561 7253 5652 2829 0a20 2020   LinearSVR().   
-00044100: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00044110: 2020 2020 2045 5420 3d20 4465 6369 7369       ET = Decisi
-00044120: 6f6e 5472 6565 5265 6772 6573 736f 7228  onTreeRegressor(
-00044130: 290a 2020 2020 2020 2020 2020 2020 2020  ).              
-00044140: 2020 2020 2020 2020 2020 7365 6c66 2e62            self.b
-00044150: 6173 655f 6573 7469 6d61 746f 7220 3d20  ase_estimator = 
-00044160: 4261 6767 696e 6752 6567 7265 7373 6f72  BaggingRegressor
-00044170: 2862 6173 655f 6573 7469 6d61 746f 7220  (base_estimator 
-00044180: 3d20 4554 2c20 626f 6f74 7374 7261 705f  = ET, bootstrap_
-00044190: 6665 6174 7572 6573 3d46 616c 7365 2c0a  features=False,.
-000441a0: 2020 2020 2020 2020 2020 2020 2020 2020                  
-000441b0: 2020 2020 2020 2020 2020 2020 2020 2020                  
-000441c0: 2020 2020 2020 2020 2020 2020 2020 2020                  
-000441d0: 2020 2020 2020 2020 2020 2020 6e5f 6a6f              n_jo
-000441e0: 6273 3d2d 312c 2072 616e 646f 6d5f 7374  bs=-1, random_st
-000441f0: 6174 653d 7261 6e64 6f6d 5f73 6565 6429  ate=random_seed)
-00044200: 0a20 2020 2020 2020 2020 2020 2020 2020  .               
-00044210: 2020 2020 2020 2020 2073 656c 662e 6d6f           self.mo
-00044220: 6465 6c5f 6e61 6d65 203d 2027 6267 270a  del_name = 'bg'.
-00044230: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00044240: 2020 2020 656c 7365 3a0a 2020 2020 2020      else:.      
-00044250: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00044260: 2020 6966 2028 582e 6474 7970 6573 3d3d    if (X.dtypes==
-00044270: 666c 6f61 7429 2e61 6c6c 2829 3a0a 2020  float).all():.  
-00044280: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00044290: 2020 2020 2020 2020 2020 6966 2073 656c            if sel
-000442a0: 662e 7665 7262 6f73 653a 0a20 2020 2020  f.verbose:.     
-000442b0: 2020 2020 2020 2020 2020 2020 2020 2020                  
-000442c0: 2020 2020 2020 2020 2020 2070 7269 6e74             print
-000442d0: 2827 2020 2020 5365 6c65 6374 696e 6720  ('    Selecting 
-000442e0: 5269 6467 6520 6173 2062 6173 655f 6573  Ridge as base_es
-000442f0: 7469 6d61 746f 722e 2046 6565 6c20 6672  timator. Feel fr
-00044300: 6565 2074 6f20 7365 6e64 2069 6e20 796f  ee to send in yo
-00044310: 7572 206f 776e 2065 7374 696d 6174 6f72  ur own estimator
-00044320: 2e27 290a 2020 2020 2020 2020 2020 2020  .').            
-00044330: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00044340: 7365 6c66 2e62 6173 655f 6573 7469 6d61  self.base_estima
-00044350: 746f 7220 3d20 5269 6467 6528 6e6f 726d  tor = Ridge(norm
-00044360: 616c 697a 653d 4661 6c73 6529 0a20 2020  alize=False).   
-00044370: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00044380: 2020 2020 2020 2020 2073 656c 662e 6d6f           self.mo
-00044390: 6465 6c5f 6e61 6d65 203d 2027 6f74 6865  del_name = 'othe
-000443a0: 7227 0a20 2020 2020 2020 2020 2020 2020  r'.             
-000443b0: 2020 2020 2020 2020 2020 2065 6c73 653a             else:
-000443c0: 0a20 2020 2020 2020 2020 2020 2020 2020  .               
-000443d0: 2020 2020 2020 2020 2020 2020 2069 6620               if 
-000443e0: 7365 6c66 2e76 6572 626f 7365 3a0a 2020  self.verbose:.  
-000443f0: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00044400: 2020 2020 2020 2020 2020 2020 2020 7072                pr
-00044410: 696e 7428 2720 2020 2053 656c 6563 7469  int('    Selecti
-00044420: 6e67 204c 4742 4d20 5265 6772 6573 736f  ng LGBM Regresso
-00044430: 7220 6173 2062 6173 6520 6573 7469 6d61  r as base estima
-00044440: 746f 722e 2e2e 2729 0a20 2020 2020 2020  tor...').       
-00044450: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00044460: 2020 2020 2073 656c 662e 6261 7365 5f65       self.base_e
-00044470: 7374 696d 6174 6f72 203d 204c 4742 4d52  stimator = LGBMR
-00044480: 6567 7265 7373 6f72 286e 5f6a 6f62 733d  egressor(n_jobs=
-00044490: 2d31 2c20 2072 616e 646f 6d5f 7374 6174  -1,  random_stat
-000444a0: 653d 7261 6e64 6f6d 5f73 6565 6429 0a20  e=random_seed). 
-000444b0: 2020 2020 2020 2020 2020 2020 2020 2065                 e
-000444c0: 6c73 653a 0a20 2020 2020 2020 2020 2020  lse:.           
-000444d0: 2020 2020 2020 2020 2023 2323 2046 6f72           ### For
-000444e0: 206c 6172 6765 2064 6174 6173 6574 7320   large datasets 
-000444f0: 4265 7474 6572 2074 6f20 7573 6520 4c47  Better to use LG
-00044500: 424d 0a20 2020 2020 2020 2020 2020 2020  BM.             
-00044510: 2020 2020 2020 2069 6620 6461 7461 5f73         if data_s
-00044520: 616d 706c 6573 203e 3d20 3165 353a 0a20  amples >= 1e5:. 
-00044530: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00044540: 2020 2020 2020 2069 6620 6770 755f 6578         if gpu_ex
-00044550: 6973 7473 3a0a 2020 2020 2020 2020 2020  ists:.          
-00044560: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00044570: 2020 6966 2073 656c 662e 7665 7262 6f73    if self.verbos
-00044580: 653a 0a20 2020 2020 2020 2020 2020 2020  e:.             
-00044590: 2020 2020 2020 2020 2020 2020 2020 2020                  
-000445a0: 2020 2070 7269 6e74 2827 2020 2020 5365     print('    Se
-000445b0: 6c65 6374 696e 6720 5847 4252 6567 7265  lecting XGBRegre
-000445c0: 7373 6f72 2077 6974 6820 4750 5520 6173  ssor with GPU as
-000445d0: 2062 6173 6520 6573 7469 6d61 746f 722e   base estimator.
-000445e0: 2e2e 2729 0a20 2020 2020 2020 2020 2020  ..').           
-000445f0: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00044600: 2073 656c 662e 6261 7365 5f65 7374 696d   self.base_estim
-00044610: 6174 6f72 203d 2058 4742 5265 6772 6573  ator = XGBRegres
-00044620: 736f 7228 6e5f 6a6f 6273 3d2d 312c 7472  sor(n_jobs=-1,tr
-00044630: 6565 5f6d 6574 686f 6420 3d20 2767 7075  ee_method = 'gpu
-00044640: 5f68 6973 7427 2c0a 2020 2020 2020 2020  _hist',.        
-00044650: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00044660: 2020 2020 2020 2020 6770 755f 6964 3d30          gpu_id=0
-00044670: 2c20 7072 6564 6963 746f 723d 2267 7075  , predictor="gpu
-00044680: 5f70 7265 6469 6374 6f72 2229 0a20 2020  _predictor").   
-00044690: 2020 2020 2020 2020 2020 2020 2020 2020                  
-000446a0: 2020 2020 2065 6c73 653a 0a20 2020 2020       else:.     
-000446b0: 2020 2020 2020 2020 2020 2020 2020 2020                  
-000446c0: 2020 2020 2020 2073 656c 662e 6261 7365         self.base
-000446d0: 5f65 7374 696d 6174 6f72 203d 204c 4742  _estimator = LGB
-000446e0: 4d52 6567 7265 7373 6f72 286e 5f6a 6f62  MRegressor(n_job
-000446f0: 733d 2d31 2c20 7261 6e64 6f6d 5f73 7461  s=-1, random_sta
-00044700: 7465 3d72 616e 646f 6d5f 7365 6564 2920  te=random_seed) 
-00044710: 0a20 2020 2020 2020 2020 2020 2020 2020  .               
-00044720: 2020 2020 2065 6c73 653a 0a20 2020 2020       else:.     
-00044730: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00044740: 2020 2023 2323 2046 6f72 2073 6d61 6c6c     ### For small
-00044750: 6572 2074 6861 6e20 4269 6720 4461 7461  er than Big Data
-00044760: 2c20 7573 6520 4c61 6265 6c20 5072 6f70  , use Label Prop
-00044770: 6167 6174 696f 6e20 7768 6963 6820 6973  agation which is
-00044780: 2066 6173 7465 7220 616e 6420 6265 7474   faster and bett
-00044790: 6572 2023 230a 2020 2020 2020 2020 2020  er ##.          
-000447a0: 2020 2020 2020 2020 2020 2020 2020 6966                if
-000447b0: 2028 582e 6474 7970 6573 3d3d 666c 6f61   (X.dtypes==floa
-000447c0: 7429 2e61 6c6c 2829 3a0a 2020 2020 2020  t).all():.      
-000447d0: 2020 2020 2020 2020 2020 2020 2020 2020                  
-000447e0: 2020 2020 2020 6966 2073 656c 662e 7665        if self.ve
-000447f0: 7262 6f73 653a 0a20 2020 2020 2020 2020  rbose:.         
-00044800: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00044810: 2020 2020 2020 2070 7269 6e74 2827 2020         print('  
-00044820: 2020 5365 6c65 6374 696e 6720 5269 6467    Selecting Ridg
-00044830: 6520 6173 2062 6173 655f 6573 7469 6d61  e as base_estima
-00044840: 746f 722e 2046 6565 6c20 6672 6565 2074  tor. Feel free t
-00044850: 6f20 7365 6e64 2069 6e20 796f 7572 206f  o send in your o
-00044860: 776e 2065 7374 696d 6174 6f72 2e27 290a  wn estimator.').
-00044870: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00044880: 2020 2020 2020 2020 2020 2020 7365 6c66              self
-00044890: 2e62 6173 655f 6573 7469 6d61 746f 7220  .base_estimator 
-000448a0: 3d20 5269 6467 6528 6e6f 726d 616c 697a  = Ridge(normaliz
-000448b0: 653d 4661 6c73 6529 0a20 2020 2020 2020  e=False).       
-000448c0: 2020 2020 2020 2020 2020 2020 2020 2020                  
-000448d0: 2020 2020 2073 656c 662e 6d6f 6465 6c5f       self.model_
-000448e0: 6e61 6d65 203d 2027 6f74 6865 7227 0a20  name = 'other'. 
-000448f0: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00044900: 2020 2020 2020 2065 6c73 653a 0a20 2020         else:.   
-00044910: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00044920: 2020 2020 2020 2020 2069 6620 6c65 6e28           if len(
-00044930: 7365 6c66 2e66 6561 7475 7265 7329 203c  self.features) <
-00044940: 3d20 6665 6174 7572 6573 5f6c 696d 6974  = features_limit
-00044950: 3a0a 2020 2020 2020 2020 2020 2020 2020  :.              
-00044960: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00044970: 2020 6966 2073 656c 662e 7665 7262 6f73    if self.verbos
-00044980: 653a 0a20 2020 2020 2020 2020 2020 2020  e:.             
-00044990: 2020 2020 2020 2020 2020 2020 2020 2020                  
-000449a0: 2020 2020 2020 2070 7269 6e74 2827 2020         print('  
-000449b0: 2020 5365 6c65 6374 696e 6720 4261 6767    Selecting Bagg
-000449c0: 696e 6720 5265 6772 6573 736f 7220 666f  ing Regressor fo
-000449d0: 7220 7468 6973 2064 6174 6173 6574 2e2e  r this dataset..
-000449e0: 2e27 290a 2020 2020 2020 2020 2020 2020  .').            
-000449f0: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00044a00: 2020 2020 4554 203d 2045 7874 7261 5472      ET = ExtraTr
-00044a10: 6565 5265 6772 6573 736f 7228 290a 2020  eeRegressor().  
-00044a20: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00044a30: 2020 2020 2020 2020 2020 2020 2020 4554                ET
-00044a40: 203d 204c 696e 6561 7253 5652 2829 0a20   = LinearSVR(). 
-00044a50: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00044a60: 2020 2020 2020 2020 2020 2020 2020 2045                 E
-00044a70: 5420 3d20 4465 6369 7369 6f6e 5472 6565  T = DecisionTree
-00044a80: 5265 6772 6573 736f 7228 290a 2020 2020  Regressor().    
-00044a90: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00044aa0: 2020 2020 2020 2020 2020 2020 7365 6c66              self
-00044ab0: 2e62 6173 655f 6573 7469 6d61 746f 7220  .base_estimator 
-00044ac0: 3d20 4261 6767 696e 6752 6567 7265 7373  = BaggingRegress
-00044ad0: 6f72 2862 6173 655f 6573 7469 6d61 746f  or(base_estimato
-00044ae0: 7220 3d20 4554 2c20 626f 6f74 7374 7261  r = ET, bootstra
-00044af0: 705f 6665 6174 7572 6573 3d46 616c 7365  p_features=False
-00044b00: 2c0a 2020 2020 2020 2020 2020 2020 2020  ,.              
-00044b10: 2020 2020 2020 2020 2020 2020 2020 2020                  
+000434b0: 2020 2020 656c 7365 3a0a 2020 2020 2020      else:.      
+000434c0: 2020 2020 2020 2020 2020 2020 2020 2020                  
+000434d0: 2020 6d6f 6465 6c5f 6f62 6a65 6374 203d    model_object =
+000434e0: 206d 6f64 656c 0a20 2020 2020 2020 2020   model.         
+000434f0: 2020 2020 2020 2066 6561 7475 7265 5f69         feature_i
+00043500: 6d70 6f72 7461 6e63 6573 203d 206d 6f64  mportances = mod
+00043510: 656c 5f6f 626a 6563 742e 626f 6f73 7465  el_object.booste
+00043520: 725f 2e66 6561 7475 7265 5f69 6d70 6f72  r_.feature_impor
+00043530: 7461 6e63 6528 696d 706f 7274 616e 6365  tance(importance
+00043540: 5f74 7970 653d 2767 6169 6e27 290a 2020  _type='gain').  
+00043550: 2020 2020 2020 2020 2020 2020 2020 6966                if
+00043560: 2069 203d 3d20 303a 0a20 2020 2020 2020   i == 0:.       
+00043570: 2020 2020 2020 2020 2020 2020 2066 6561               fea
+00043580: 7475 7265 5f69 6d70 203d 2070 642e 4461  ture_imp = pd.Da
+00043590: 7461 4672 616d 6528 7b27 5661 6c75 6527  taFrame({'Value'
+000435a0: 3a66 6561 7475 7265 5f69 6d70 6f72 7461  :feature_importa
+000435b0: 6e63 6573 2c27 4665 6174 7572 6527 3a66  nces,'Feature':f
+000435c0: 6561 7475 7265 5f6e 616d 6573 7d29 0a20  eature_names}). 
+000435d0: 2020 2020 2020 2020 2020 2020 2020 2065                 e
+000435e0: 6c73 653a 0a20 2020 2020 2020 2020 2020  lse:.           
+000435f0: 2020 2020 2020 2020 2066 6561 7475 7265           feature
+00043600: 5f69 6d70 203d 2070 642e 636f 6e63 6174  _imp = pd.concat
+00043610: 285b 6665 6174 7572 655f 696d 702c 200a  ([feature_imp, .
+00043620: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00043630: 2020 2020 2020 2020 7064 2e44 6174 6146          pd.DataF
+00043640: 7261 6d65 287b 2756 616c 7565 273a 6665  rame({'Value':fe
+00043650: 6174 7572 655f 696d 706f 7274 616e 6365  ature_importance
+00043660: 732c 2746 6561 7475 7265 273a 6665 6174  s,'Feature':feat
+00043670: 7572 655f 6e61 6d65 737d 295d 2c20 6178  ure_names})], ax
+00043680: 6973 3d30 290a 2020 2020 2020 2020 2020  is=0).          
+00043690: 2020 2020 2020 236c 6762 6d2e 706c 6f74        #lgbm.plot
+000436a0: 5f69 6d70 6f72 7461 6e63 6528 6d6f 6465  _importance(mode
+000436b0: 6c5f 6f62 6a65 6374 2c20 696d 706f 7274  l_object, import
+000436c0: 616e 6365 5f74 7970 653d 2767 6169 6e27  ance_type='gain'
+000436d0: 2c20 6d61 785f 6e75 6d5f 6665 6174 7572  , max_num_featur
+000436e0: 6573 3d6d 6178 5f66 6561 7475 7265 7329  es=max_features)
+000436f0: 0a20 2020 2020 2020 2020 2020 2066 6561  .            fea
+00043700: 7475 7265 5f69 6d70 203d 2066 6561 7475  ture_imp = featu
+00043710: 7265 5f69 6d70 2e67 726f 7570 6279 2827  re_imp.groupby('
+00043720: 4665 6174 7572 6527 292e 6d65 616e 2829  Feature').mean()
+00043730: 2e73 6f72 745f 7661 6c75 6573 2827 5661  .sort_values('Va
+00043740: 6c75 6527 2c61 7363 656e 6469 6e67 3d46  lue',ascending=F
+00043750: 616c 7365 292e 7265 7365 745f 696e 6465  alse).reset_inde
+00043760: 7828 290a 2020 2020 2020 2020 2020 2020  x().            
+00043770: 6665 6174 7572 655f 696d 702e 7365 745f  feature_imp.set_
+00043780: 696e 6465 7828 2746 6561 7475 7265 2729  index('Feature')
+00043790: 5b3a 6d61 785f 6665 6174 7572 6573 5d2e  [:max_features].
+000437a0: 706c 6f74 286b 696e 643d 2762 6172 6827  plot(kind='barh'
+000437b0: 2c20 7469 746c 653d 2754 6f70 2031 3020  , title='Top 10 
+000437c0: 4665 6174 7572 6573 2729 0a20 2020 2020  Features').     
+000437d0: 2020 2020 2020 2023 2323 2054 6869 7320         ### This 
+000437e0: 6973 2066 6f72 2058 4742 2023 2323 0a20  is for XGB ###. 
+000437f0: 2020 2020 2020 2020 2020 2023 706c 6f74             #plot
+00043800: 5f69 6d70 6f72 7461 6e63 6528 7365 6c66  _importance(self
+00043810: 2e6d 6f64 656c 2e6e 616d 6564 5f73 7465  .model.named_ste
+00043820: 7073 5b27 6d6f 6465 6c27 5d2c 2069 6d70  ps['model'], imp
+00043830: 6f72 7461 6e63 655f 7479 7065 3d27 6761  ortance_type='ga
+00043840: 696e 272c 206d 6178 5f6e 756d 5f66 6561  in', max_num_fea
+00043850: 7475 7265 733d 6d61 785f 6665 6174 7572  tures=max_featur
+00043860: 6573 290a 2020 2020 2020 2020 656c 6966  es).        elif
+00043870: 206d 6f64 656c 5f6e 616d 6520 3d3d 2027   model_name == '
+00043880: 6c70 273a 0a20 2020 2020 2020 2020 2020  lp':.           
+00043890: 2070 7269 6e74 2827 4e6f 2066 6561 7475   print('No featu
+000438a0: 7265 2069 6d70 6f72 7461 6e63 6573 2061  re importances a
+000438b0: 7661 696c 6162 6c65 2066 6f72 204c 6162  vailable for Lab
+000438c0: 656c 5072 6f70 6167 6174 696f 6e20 616c  elPropagation al
+000438d0: 676f 7269 7468 6d2e 2052 6574 7572 6e69  gorithm. Returni
+000438e0: 6e67 2e2e 2e27 290a 2020 2020 2020 2020  ng...').        
+000438f0: 2020 2020 7265 7475 726e 0a20 2020 2020      return.     
+00043900: 2020 2065 6c69 6620 6d6f 6465 6c5f 6e61     elif model_na
+00043910: 6d65 203d 3d20 2772 6627 3a0a 2020 2020  me == 'rf':.    
+00043920: 2020 2020 2020 2020 2323 2320 5468 6573          ### Thes
+00043930: 6520 6172 6520 666f 7220 5261 6e64 6f6d  e are for Random
+00043940: 466f 7265 7374 436c 6173 7369 6669 6572  ForestClassifier
+00043950: 206b 696e 6420 6f66 2073 6369 6b69 742d   kind of scikit-
+00043960: 6c65 6172 6e20 6d6f 6465 6c73 2023 2323  learn models ###
+00043970: 0a20 2020 2020 2020 2020 2020 2074 7279  .            try
+00043980: 3a0a 2020 2020 2020 2020 2020 2020 2020  :.              
+00043990: 2020 666f 7220 692c 206d 6f64 656c 2069    for i, model i
+000439a0: 6e20 656e 756d 6572 6174 6528 7365 6c66  n enumerate(self
+000439b0: 2e6d 6f64 656c 7329 3a0a 2020 2020 2020  .models):.      
+000439c0: 2020 2020 2020 2020 2020 2020 2020 6966                if
+000439d0: 2073 656c 662e 7069 7065 6c69 6e65 3a0a   self.pipeline:.
+000439e0: 2020 2020 2020 2020 2020 2020 2020 2020                  
+000439f0: 2020 2020 2020 2020 6966 2073 656c 662e          if self.
+00043a00: 6d75 6c74 695f 6c61 6265 6c3a 0a20 2020  multi_label:.   
+00043a10: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00043a20: 2020 2020 2020 2020 2023 6d6f 6465 6c5f           #model_
+00043a30: 6f62 6a65 6374 203d 206d 6f64 656c 2e6e  object = model.n
+00043a40: 616d 6564 5f73 7465 7073 5b27 6d6f 6465  amed_steps['mode
+00043a50: 6c27 5d2e 6261 7365 5f65 7374 696d 6174  l'].base_estimat
+00043a60: 6f72 0a20 2020 2020 2020 2020 2020 2020  or.             
+00043a70: 2020 2020 2020 2020 2020 2020 2020 2070                 p
+00043a80: 7269 6e74 2827 4e6f 2066 6561 7475 7265  rint('No feature
+00043a90: 2069 6d70 6f72 7461 6e63 6573 2061 7661   importances ava
+00043aa0: 696c 6162 6c65 2066 6f72 206d 756c 7469  ilable for multi
+00043ab0: 5f6c 6162 656c 2074 6172 6765 7473 2e20  _label targets. 
+00043ac0: 5265 7475 726e 696e 672e 2e2e 2729 0a20  Returning...'). 
+00043ad0: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00043ae0: 2020 2020 2020 2020 2020 2072 6574 7572             retur
+00043af0: 6e0a 2020 2020 2020 2020 2020 2020 2020  n.              
+00043b00: 2020 2020 2020 2020 2020 656c 7365 3a0a            else:.
+00043b10: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00043b20: 2020 2020 2020 2020 2020 2020 6d6f 6465              mode
+00043b30: 6c5f 6f62 6a65 6374 203d 206d 6f64 656c  l_object = model
+00043b40: 2e6e 616d 6564 5f73 7465 7073 5b27 6d6f  .named_steps['mo
+00043b50: 6465 6c27 5d0a 2020 2020 2020 2020 2020  del'].          
+00043b60: 2020 2020 2020 2020 2020 656c 7365 3a0a            else:.
+00043b70: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00043b80: 2020 2020 2020 2020 6966 2073 656c 662e          if self.
+00043b90: 6d75 6c74 695f 6c61 6265 6c3a 0a20 2020  multi_label:.   
+00043ba0: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00043bb0: 2020 2020 2020 2020 2023 6d6f 6465 6c5f           #model_
+00043bc0: 6f62 6a65 6374 203d 206d 6f64 656c 2e62  object = model.b
+00043bd0: 6173 655f 6573 7469 6d61 746f 720a 2020  ase_estimator.  
+00043be0: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00043bf0: 2020 2020 2020 2020 2020 7072 696e 7428            print(
+00043c00: 274e 6f20 6665 6174 7572 6520 696d 706f  'No feature impo
+00043c10: 7274 616e 6365 7320 6176 6169 6c61 626c  rtances availabl
+00043c20: 6520 666f 7220 6d75 6c74 695f 6c61 6265  e for multi_labe
+00043c30: 6c20 7461 7267 6574 732e 2052 6574 7572  l targets. Retur
+00043c40: 6e69 6e67 2e2e 2e27 290a 2020 2020 2020  ning...').      
+00043c50: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00043c60: 2020 2020 2020 7265 7475 726e 0a20 2020        return.   
+00043c70: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00043c80: 2020 2020 2065 6c73 653a 0a20 2020 2020       else:.     
+00043c90: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00043ca0: 2020 2020 2020 206d 6f64 656c 5f6f 626a         model_obj
+00043cb0: 6563 7420 3d20 6d6f 6465 6c0a 2020 2020  ect = model.    
+00043cc0: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00043cd0: 6665 6174 7572 655f 696d 706f 7274 616e  feature_importan
+00043ce0: 6365 7320 3d20 6d6f 6465 6c5f 6f62 6a65  ces = model_obje
+00043cf0: 6374 2e66 6561 7475 7265 5f69 6d70 6f72  ct.feature_impor
+00043d00: 7461 6e63 6573 5f0a 2020 2020 2020 2020  tances_.        
+00043d10: 2020 2020 2020 2020 2020 2020 6966 2069              if i
+00043d20: 203d 3d20 303a 0a20 2020 2020 2020 2020   == 0:.         
+00043d30: 2020 2020 2020 2020 2020 2020 2020 2066                 f
+00043d40: 6561 7475 7265 5f69 6d70 203d 2070 642e  eature_imp = pd.
+00043d50: 4461 7461 4672 616d 6528 7b27 5661 6c75  DataFrame({'Valu
+00043d60: 6527 3a66 6561 7475 7265 5f69 6d70 6f72  e':feature_impor
+00043d70: 7461 6e63 6573 2c27 4665 6174 7572 6527  tances,'Feature'
+00043d80: 3a66 6561 7475 7265 5f6e 616d 6573 7d29  :feature_names})
+00043d90: 0a20 2020 2020 2020 2020 2020 2020 2020  .               
+00043da0: 2020 2020 2065 6c73 653a 0a20 2020 2020       else:.     
+00043db0: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00043dc0: 2020 2066 6561 7475 7265 5f69 6d70 203d     feature_imp =
+00043dd0: 2070 642e 636f 6e63 6174 285b 6665 6174   pd.concat([feat
+00043de0: 7572 655f 696d 702c 200a 2020 2020 2020  ure_imp, .      
+00043df0: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00043e00: 2020 2020 2020 7064 2e44 6174 6146 7261        pd.DataFra
+00043e10: 6d65 287b 2756 616c 7565 273a 6665 6174  me({'Value':feat
+00043e20: 7572 655f 696d 706f 7274 616e 6365 732c  ure_importances,
+00043e30: 2746 6561 7475 7265 273a 6665 6174 7572  'Feature':featur
+00043e40: 655f 6e61 6d65 737d 295d 2c20 6178 6973  e_names})], axis
+00043e50: 3d30 290a 2020 2020 2020 2020 2020 2020  =0).            
+00043e60: 2020 2020 6665 6174 7572 655f 696d 7020      feature_imp 
+00043e70: 3d20 6665 6174 7572 655f 696d 702e 6772  = feature_imp.gr
+00043e80: 6f75 7062 7928 2746 6561 7475 7265 2729  oupby('Feature')
+00043e90: 2e6d 6561 6e28 292e 736f 7274 5f76 616c  .mean().sort_val
+00043ea0: 7565 7328 2756 616c 7565 272c 6173 6365  ues('Value',asce
+00043eb0: 6e64 696e 673d 4661 6c73 6529 2e72 6573  nding=False).res
+00043ec0: 6574 5f69 6e64 6578 2829 0a20 2020 2020  et_index().     
+00043ed0: 2020 2020 2020 2020 2020 2066 6561 7475             featu
+00043ee0: 7265 5f69 6d70 2e73 6574 5f69 6e64 6578  re_imp.set_index
+00043ef0: 2827 4665 6174 7572 6527 295b 3a6d 6178  ('Feature')[:max
+00043f00: 5f66 6561 7475 7265 735d 2e70 6c6f 7428  _features].plot(
+00043f10: 6b69 6e64 3d27 6261 7268 272c 2074 6974  kind='barh', tit
+00043f20: 6c65 3d27 546f 7020 3130 2046 6561 7475  le='Top 10 Featu
+00043f30: 7265 7327 290a 2020 2020 2020 2020 2020  res').          
+00043f40: 2020 6578 6365 7074 3a0a 2020 2020 2020    except:.      
+00043f50: 2020 2020 2020 2020 2020 2020 2020 7072                pr
+00043f60: 696e 7428 2743 6f75 6c64 206e 6f74 2070  int('Could not p
+00043f70: 6c6f 7420 6665 6174 7572 6520 696d 706f  lot feature impo
+00043f80: 7274 616e 6365 732e 2050 6c65 6173 6520  rtances. Please 
+00043f90: 6368 6563 6b20 796f 7572 206d 6f64 656c  check your model
+00043fa0: 2061 6e64 2074 7279 2061 6761 696e 2e27   and try again.'
+00043fb0: 2920 2020 2020 2020 2020 2020 2020 2020  )               
+00043fc0: 200a 2020 2020 2020 2020 656c 7365 3a0a   .        else:.
+00043fd0: 2020 2020 2020 2020 2020 2020 7072 696e              prin
+00043fe0: 7428 274e 6f20 6665 6174 7572 6520 696d  t('No feature im
+00043ff0: 706f 7274 616e 6365 7320 6176 6169 6c61  portances availa
+00044000: 626c 6520 666f 7220 7468 6973 2061 6c67  ble for this alg
+00044010: 6f72 6974 686d 2e20 5265 7475 726e 696e  orithm. Returnin
+00044020: 672e 2e2e 2729 0a20 2020 2020 2020 2020  g...').         
+00044030: 2020 2072 6574 7572 6e0a 2323 2323 2323     return.######
+00044040: 2323 2323 2323 2323 2323 2323 2323 2323  ################
+00044050: 2323 2323 2323 2323 2323 2323 2323 2323  ################
+00044060: 2323 2323 2323 2323 2323 2323 2323 2323  ################
+00044070: 2323 2323 2323 2323 2323 2323 2323 2323  ################
+00044080: 2323 2323 2323 2323 2323 2323 2323 2323  ################
+00044090: 2323 2323 0a66 726f 6d20 736b 6c65 6172  ####.from sklear
+000440a0: 6e2e 6d65 7472 6963 7320 696d 706f 7274  n.metrics import
+000440b0: 206d 6561 6e5f 6162 736f 6c75 7465 5f65   mean_absolute_e
+000440c0: 7272 6f72 2c20 6d65 616e 5f73 7175 6172  rror, mean_squar
+000440d0: 6564 5f65 7272 6f72 2c20 7232 5f73 636f  ed_error, r2_sco
+000440e0: 7265 0a66 726f 6d20 6974 6572 746f 6f6c  re.from itertool
+000440f0: 7320 696d 706f 7274 2063 7963 6c65 0a64  s import cycle.d
+00044100: 6566 2070 7269 6e74 5f72 6567 7265 7373  ef print_regress
+00044110: 696f 6e5f 6d6f 6465 6c5f 7374 6174 7328  ion_model_stats(
+00044120: 6163 7475 616c 732c 2070 7265 6469 6374  actuals, predict
+00044130: 6564 2c20 7665 7262 6f73 653d 3029 3a0a  ed, verbose=0):.
+00044140: 2020 2020 2222 220a 2020 2020 5468 6973      """.    This
+00044150: 2070 726f 6772 616d 2070 7269 6e74 7320   program prints 
+00044160: 616e 6420 7265 7475 726e 7320 4d41 452c  and returns MAE,
+00044170: 2052 4d53 452c 204d 4150 452e 0a20 2020   RMSE, MAPE..   
+00044180: 2049 6620 796f 7520 6c69 6b65 2074 6865   If you like the
+00044190: 204d 4145 2061 6e64 2052 4d53 4520 746f   MAE and RMSE to
+000441a0: 2068 6176 6520 6120 7469 746c 6520 6f72   have a title or
+000441b0: 2073 6f6d 6574 6869 6e67 2c20 6a75 7374   something, just
+000441c0: 2067 6976 6520 7468 6174 0a20 2020 2069   give that.    i
+000441d0: 6e20 7468 6520 696e 7075 7420 6173 2022  n the input as "
+000441e0: 7469 746c 6522 2061 6e64 2069 7420 7769  title" and it wi
+000441f0: 6c6c 2070 7269 6e74 2074 6861 7420 7469  ll print that ti
+00044200: 746c 6520 6f6e 2074 6865 204d 4145 2061  tle on the MAE a
+00044210: 6e64 2052 4d53 4520 6173 2061 0a20 2020  nd RMSE as a.   
+00044220: 2063 6861 7274 2066 6f72 2074 6861 7420   chart for that 
+00044230: 6d6f 6465 6c2e 2052 6574 7572 6e73 204d  model. Returns M
+00044240: 4145 2c20 4d41 455f 6173 5f70 6572 6365  AE, MAE_as_perce
+00044250: 6e74 6167 652c 2061 6e64 2052 4d53 455f  ntage, and RMSE_
+00044260: 6173 5f70 6572 6365 6e74 6167 650a 2020  as_percentage.  
+00044270: 2020 2222 220a 2020 2020 6966 2069 7369    """.    if isi
+00044280: 6e73 7461 6e63 6528 6163 7475 616c 732c  nstance(actuals,
+00044290: 7064 2e53 6572 6965 7329 206f 7220 6973  pd.Series) or is
+000442a0: 696e 7374 616e 6365 2861 6374 7561 6c73  instance(actuals
+000442b0: 2c70 642e 4461 7461 4672 616d 6529 3a0a  ,pd.DataFrame):.
+000442c0: 2020 2020 2020 2020 6163 7475 616c 7320          actuals 
+000442d0: 3d20 6163 7475 616c 732e 7661 6c75 6573  = actuals.values
+000442e0: 0a20 2020 2069 6620 6973 696e 7374 616e  .    if isinstan
+000442f0: 6365 2870 7265 6469 6374 6564 2c70 642e  ce(predicted,pd.
+00044300: 5365 7269 6573 2920 6f72 2069 7369 6e73  Series) or isins
+00044310: 7461 6e63 6528 7072 6564 6963 7465 642c  tance(predicted,
+00044320: 7064 2e44 6174 6146 7261 6d65 293a 0a20  pd.DataFrame):. 
+00044330: 2020 2020 2020 2070 7265 6469 6374 6564         predicted
+00044340: 203d 2070 7265 6469 6374 6564 2e76 616c   = predicted.val
+00044350: 7565 730a 2020 2020 6966 206c 656e 2861  ues.    if len(a
+00044360: 6374 7561 6c73 2920 213d 206c 656e 2870  ctuals) != len(p
+00044370: 7265 6469 6374 6564 293a 0a20 2020 2020  redicted):.     
+00044380: 2020 2069 6620 7665 7262 6f73 653a 0a20     if verbose:. 
+00044390: 2020 2020 2020 2020 2020 2070 7269 6e74             print
+000443a0: 2827 4572 726f 723a 204e 756d 6265 7220  ('Error: Number 
+000443b0: 6f66 2072 6f77 7320 696e 2061 6374 7561  of rows in actua
+000443c0: 6c73 2061 6e64 2070 7265 6469 6374 6564  ls and predicted
+000443d0: 2064 6f6e 7420 6d61 7463 682e 2043 6f6e   dont match. Con
+000443e0: 7469 6e75 696e 672e 2e2e 2729 0a20 2020  tinuing...').   
+000443f0: 2020 2020 2072 6574 7572 6e20 6e70 2e69       return np.i
+00044400: 6e66 0a20 2020 2074 7279 3a0a 2020 2020  nf.    try:.    
+00044410: 2020 2020 2323 2320 5468 6973 2069 7320      ### This is 
+00044420: 666f 7220 4d75 6c74 695f 4c61 6265 6c20  for Multi_Label 
+00044430: 5072 6f62 6c65 6d73 2023 2323 0a20 2020  Problems ###.   
+00044440: 2020 2020 2061 7373 6572 7420 6163 7475       assert actu
+00044450: 616c 732e 7368 6170 655b 315d 0a20 2020  als.shape[1].   
+00044460: 2020 2020 206d 756c 7469 5f6c 6162 656c       multi_label
+00044470: 203d 2054 7275 650a 2020 2020 6578 6365   = True.    exce
+00044480: 7074 3a0a 2020 2020 2020 2020 6d75 6c74  pt:.        mult
+00044490: 695f 6c61 6265 6c20 3d20 4661 6c73 650a  i_label = False.
+000444a0: 2020 2020 6966 206d 756c 7469 5f6c 6162      if multi_lab
+000444b0: 656c 3a0a 2020 2020 2020 2020 666f 7220  el:.        for 
+000444c0: 6920 696e 2072 616e 6765 2861 6374 7561  i in range(actua
+000444d0: 6c73 2e73 6861 7065 5b31 5d29 3a0a 2020  ls.shape[1]):.  
+000444e0: 2020 2020 2020 2020 2020 6163 7475 616c            actual
+000444f0: 735f 7820 3d20 6163 7475 616c 735b 3a2c  s_x = actuals[:,
+00044500: 695d 0a20 2020 2020 2020 2020 2020 2074  i].            t
+00044510: 7279 3a0a 2020 2020 2020 2020 2020 2020  ry:.            
+00044520: 2020 2020 7072 6564 6963 7465 645f 7820      predicted_x 
+00044530: 3d20 7072 6564 6963 7465 645b 3a2c 695d  = predicted[:,i]
+00044540: 0a20 2020 2020 2020 2020 2020 2065 7863  .            exc
+00044550: 6570 743a 0a20 2020 2020 2020 2020 2020  ept:.           
+00044560: 2020 2020 2070 7265 6469 6374 6564 5f78       predicted_x
+00044570: 203d 2070 7265 6469 6374 6564 5b3a 5d0a   = predicted[:].
+00044580: 2020 2020 2020 2020 2020 2020 6966 2076              if v
+00044590: 6572 626f 7365 3a0a 2020 2020 2020 2020  erbose:.        
+000445a0: 2020 2020 2020 2020 7072 696e 7428 2766          print('f
+000445b0: 6f72 2074 6172 6765 7420 2573 3a27 2025  or target %s:' %
+000445c0: 6929 0a20 2020 2020 2020 2020 2020 2065  i).            e
+000445d0: 6163 685f 726d 7365 203d 2070 7269 6e74  ach_rmse = print
+000445e0: 5f72 6567 7265 7373 696f 6e5f 6d65 7472  _regression_metr
+000445f0: 6963 7328 6163 7475 616c 735f 782c 2070  ics(actuals_x, p
+00044600: 7265 6469 6374 6564 5f78 2c20 7665 7262  redicted_x, verb
+00044610: 6f73 6529 0a20 2020 2020 2020 2066 696e  ose).        fin
+00044620: 616c 5f72 6d73 6520 3d20 6e70 2e6d 6561  al_rmse = np.mea
+00044630: 6e28 6561 6368 5f72 6d73 6529 0a20 2020  n(each_rmse).   
+00044640: 2065 6c73 653a 0a20 2020 2020 2020 2066   else:.        f
+00044650: 696e 616c 5f72 6d73 6520 3d20 7072 696e  inal_rmse = prin
+00044660: 745f 7265 6772 6573 7369 6f6e 5f6d 6574  t_regression_met
+00044670: 7269 6373 2861 6374 7561 6c73 2c20 7072  rics(actuals, pr
+00044680: 6564 6963 7465 642c 2076 6572 626f 7365  edicted, verbose
+00044690: 290a 2020 2020 7265 7475 726e 2066 696e  ).    return fin
+000446a0: 616c 5f72 6d73 650a 2323 2323 2323 2323  al_rmse.########
+000446b0: 2323 2323 2323 2323 2323 2323 2323 2323  ################
+000446c0: 2323 2323 2323 2323 2323 2323 2323 2323  ################
+000446d0: 2323 2323 2323 2323 2323 2323 2323 2323  ################
+000446e0: 2323 2323 2323 2323 2323 2323 2323 2323  ################
+000446f0: 2323 2323 2323 2323 0a66 726f 6d20 736b  ########.from sk
+00044700: 6c65 6172 6e2e 6d65 7472 6963 7320 696d  learn.metrics im
+00044710: 706f 7274 206d 6561 6e5f 7371 7561 7265  port mean_square
+00044720: 645f 6572 726f 722c 206d 6561 6e5f 6162  d_error, mean_ab
+00044730: 736f 6c75 7465 5f65 7272 6f72 2c20 7232  solute_error, r2
+00044740: 5f73 636f 7265 0a64 6566 204d 4150 4528  _score.def MAPE(
+00044750: 795f 7472 7565 2c20 795f 7072 6564 293a  y_true, y_pred):
+00044760: 200a 2020 795f 7472 7565 2c20 795f 7072   .  y_true, y_pr
+00044770: 6564 203d 206e 702e 6172 7261 7928 795f  ed = np.array(y_
+00044780: 7472 7565 292c 206e 702e 6172 7261 7928  true), np.array(
+00044790: 795f 7072 6564 290a 2020 7265 7475 726e  y_pred).  return
+000447a0: 206e 702e 6d65 616e 286e 702e 6162 7328   np.mean(np.abs(
+000447b0: 2879 5f74 7275 6520 2d20 795f 7072 6564  (y_true - y_pred
+000447c0: 2920 2f20 6e70 2e6d 6178 696d 756d 286e  ) / np.maximum(n
+000447d0: 702e 6f6e 6573 286c 656e 2879 5f74 7275  p.ones(len(y_tru
+000447e0: 6529 292c 206e 702e 6162 7328 795f 7472  e)), np.abs(y_tr
+000447f0: 7565 2929 2929 2a31 3030 0a0a 6465 6620  ue))))*100..def 
+00044800: 7072 696e 745f 7265 6772 6573 7369 6f6e  print_regression
+00044810: 5f6d 6574 7269 6373 2879 5f74 7275 652c  _metrics(y_true,
+00044820: 2079 5f70 7265 6473 2c20 7665 7262 6f73   y_preds, verbos
+00044830: 653d 3029 3a0a 2020 2020 6561 6368 5f72  e=0):.    each_r
+00044840: 6d73 6520 3d20 6e70 2e73 7172 7428 6d65  mse = np.sqrt(me
+00044850: 616e 5f73 7175 6172 6564 5f65 7272 6f72  an_squared_error
+00044860: 2879 5f74 7275 652c 2079 5f70 7265 6473  (y_true, y_preds
+00044870: 2929 0a20 2020 2069 6620 7665 7262 6f73  )).    if verbos
+00044880: 653a 0a20 2020 2020 2020 2070 7269 6e74  e:.        print
+00044890: 2827 2020 2020 524d 5345 203d 2025 302e  ('    RMSE = %0.
+000448a0: 3366 2720 2565 6163 685f 726d 7365 290a  3f' %each_rmse).
+000448b0: 2020 2020 2020 2020 7072 696e 7428 2720          print(' 
+000448c0: 2020 204e 6f72 6d20 524d 5345 203d 2025     Norm RMSE = %
+000448d0: 302e 3066 2525 2720 2528 3130 302a 6e70  0.0f%%' %(100*np
+000448e0: 2e73 7172 7428 6d65 616e 5f73 7175 6172  .sqrt(mean_squar
+000448f0: 6564 5f65 7272 6f72 2879 5f74 7275 652c  ed_error(y_true,
+00044900: 2079 5f70 7265 6473 2929 2f6e 702e 7374   y_preds))/np.st
+00044910: 6428 795f 7472 7565 2929 290a 2020 2020  d(y_true))).    
+00044920: 2020 2020 7072 696e 7428 2720 2020 204d      print('    M
+00044930: 4145 203d 2025 302e 3366 2720 2025 6d65  AE = %0.3f'  %me
+00044940: 616e 5f61 6273 6f6c 7574 655f 6572 726f  an_absolute_erro
+00044950: 7228 795f 7472 7565 2c20 795f 7072 6564  r(y_true, y_pred
+00044960: 7329 290a 2020 2020 6966 206c 656e 2879  s)).    if len(y
+00044970: 5f74 7275 655b 2879 5f74 7275 653d 3d30  _true[(y_true==0
+00044980: 295d 2920 3e20 303a 0a20 2020 2020 2020  )]) > 0:.       
+00044990: 2069 6620 7665 7262 6f73 653a 0a20 2020   if verbose:.   
+000449a0: 2020 2020 2020 2020 2070 7269 6e74 2827           print('
+000449b0: 2020 2020 5741 5045 203d 2025 302e 3066      WAPE = %0.0f
+000449c0: 2525 2c20 4269 6173 203d 2025 302e 3066  %%, Bias = %0.0f
+000449d0: 2525 2720 2528 3130 302a 6e70 2e73 756d  %%' %(100*np.sum
+000449e0: 286e 702e 6162 7328 795f 7472 7565 2d79  (np.abs(y_true-y
+000449f0: 5f70 7265 6473 2929 2f6e 702e 7375 6d28  _preds))/np.sum(
+00044a00: 795f 7472 7565 292c 200a 2020 2020 2020  y_true), .      
+00044a10: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00044a20: 2020 3130 302a 6e70 2e73 756d 2879 5f74    100*np.sum(y_t
+00044a30: 7275 652d 795f 7072 6564 7329 2f6e 702e  rue-y_preds)/np.
+00044a40: 7375 6d28 795f 7472 7565 2929 290a 2020  sum(y_true))).  
+00044a50: 2020 2020 2020 2020 2020 7072 696e 7428            print(
+00044a60: 2720 2020 204e 6f20 4d41 5045 2061 7661  '    No MAPE ava
+00044a70: 696c 6162 6c65 2073 696e 6365 207a 6572  ilable since zer
+00044a80: 6f65 7320 696e 2061 6374 7561 6c73 2729  oes in actuals')
+00044a90: 0a20 2020 2065 6c73 653a 0a20 2020 2020  .    else:.     
+00044aa0: 2020 2069 6620 7665 7262 6f73 653a 0a20     if verbose:. 
+00044ab0: 2020 2020 2020 2020 2020 2070 7269 6e74             print
+00044ac0: 2827 2020 2020 5741 5045 203d 2025 302e  ('    WAPE = %0.
+00044ad0: 3066 2525 2c20 4269 6173 203d 2025 302e  0f%%, Bias = %0.
+00044ae0: 3066 2525 2720 2528 3130 302a 6e70 2e73  0f%%' %(100*np.s
+00044af0: 756d 286e 702e 6162 7328 795f 7472 7565  um(np.abs(y_true
+00044b00: 2d79 5f70 7265 6473 2929 2f6e 702e 7375  -y_preds))/np.su
+00044b10: 6d28 795f 7472 7565 292c 200a 2020 2020  m(y_true), .    
 00044b20: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00044b30: 2020 2020 2020 2020 2020 2020 2020 6e5f                n_
-00044b40: 6a6f 6273 3d2d 312c 2072 616e 646f 6d5f  jobs=-1, random_
-00044b50: 7374 6174 653d 7261 6e64 6f6d 5f73 6565  state=random_see
-00044b60: 6429 0a20 2020 2020 2020 2020 2020 2020  d).             
-00044b70: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00044b80: 2020 2073 656c 662e 6d6f 6465 6c5f 6e61     self.model_na
-00044b90: 6d65 203d 2027 6267 270a 2020 2020 2020  me = 'bg'.      
-00044ba0: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00044bb0: 2020 2020 2020 656c 7365 3a0a 2020 2020        else:.    
-00044bc0: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00044bd0: 2020 2020 2020 2020 2020 2020 7363 6f72              scor
-00044be0: 696e 6720 3d20 276e 6567 5f6d 6561 6e5f  ing = 'neg_mean_
-00044bf0: 7371 7561 7265 645f 6572 726f 7227 0a20  squared_error'. 
-00044c00: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00044c10: 2020 2020 2020 2020 2020 2020 2020 2023                 #
-00044c20: 2323 2020 2045 7874 7261 2054 7265 6573  ##   Extra Trees
-00044c30: 2069 7320 6e6f 7420 736f 2067 7265 6174   is not so great
-00044c40: 2066 6f72 206c 6172 6765 2064 6174 6120   for large data 
-00044c50: 7365 7473 202d 204c 4742 4d20 6973 2062  sets - LGBM is b
-00044c60: 6574 7465 7220 2323 2323 0a20 2020 2020  etter ####.     
-00044c70: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00044c80: 2020 2020 2020 2020 2020 2069 6620 6770             if gp
-00044c90: 755f 6578 6973 7473 3a0a 2020 2020 2020  u_exists:.      
-00044ca0: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00044cb0: 2020 2020 2020 2020 2020 2020 2020 6966                if
-00044cc0: 2073 656c 662e 7665 7262 6f73 653a 0a20   self.verbose:. 
-00044cd0: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00044ce0: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00044cf0: 2020 2020 2020 2070 7269 6e74 2827 2020         print('  
-00044d00: 2020 5365 6c65 6374 696e 6720 5847 4252    Selecting XGBR
-00044d10: 6567 7265 7373 6f72 2077 6974 6820 4750  egressor with GP
-00044d20: 5520 6173 2062 6173 6520 6573 7469 6d61  U as base estima
-00044d30: 746f 722e 2e2e 2729 0a20 2020 2020 2020  tor...').       
-00044d40: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00044d50: 2020 2020 2020 2020 2020 2020 2073 656c               sel
-00044d60: 662e 6261 7365 5f65 7374 696d 6174 6f72  f.base_estimator
-00044d70: 203d 2058 4742 5265 6772 6573 736f 7228   = XGBRegressor(
-00044d80: 0a20 2020 2020 2020 2020 2020 2020 2020  .               
-00044d90: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00044da0: 2020 2020 2020 2020 206e 5f6a 6f62 733d           n_jobs=
-00044db0: 2d31 2c74 7265 655f 6d65 7468 6f64 203d  -1,tree_method =
-00044dc0: 2027 6770 755f 6869 7374 272c 6770 755f   'gpu_hist',gpu_
-00044dd0: 6964 3d30 2c20 7072 6564 6963 746f 723d  id=0, predictor=
-00044de0: 2267 7075 5f70 7265 6469 6374 6f72 2229  "gpu_predictor")
-00044df0: 0a20 2020 2020 2020 2020 2020 2020 2020  .               
-00044e00: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00044e10: 2065 6c73 653a 0a20 2020 2020 2020 2020   else:.         
-00044e20: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00044e30: 2020 2020 2020 2020 2020 2069 6620 7365             if se
-00044e40: 6c66 2e76 6572 626f 7365 3a0a 2020 2020  lf.verbose:.    
-00044e50: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00044e60: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00044e70: 2020 2020 7072 696e 7428 2720 2020 2053      print('    S
-00044e80: 656c 6563 7469 6e67 204c 4742 4d20 5265  electing LGBM Re
-00044e90: 6772 6573 736f 7220 6173 2062 6173 6520  gressor as base 
-00044ea0: 6573 7469 6d61 746f 722e 2e2e 2729 0a20  estimator...'). 
-00044eb0: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00044ec0: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00044ed0: 2020 2073 656c 662e 6261 7365 5f65 7374     self.base_est
-00044ee0: 696d 6174 6f72 203d 204c 4742 4d52 6567  imator = LGBMReg
-00044ef0: 7265 7373 6f72 286e 5f6a 6f62 733d 2d31  ressor(n_jobs=-1
-00044f00: 2c20 7261 6e64 6f6d 5f73 7461 7465 3d72  , random_state=r
-00044f10: 616e 646f 6d5f 7365 6564 2920 0a20 2020  andom_seed) .   
-00044f20: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00044f30: 2020 2020 2020 2020 2020 2020 2073 656c               sel
-00044f40: 662e 6d6f 6465 6c5f 6e61 6d65 203d 2027  f.model_name = '
-00044f50: 6c67 6227 0a20 2020 2020 2020 2020 2020  lgb'.           
-00044f60: 2065 6c73 653a 0a20 2020 2020 2020 2020   else:.         
-00044f70: 2020 2020 2020 2073 656c 662e 6d6f 6465         self.mode
-00044f80: 6c5f 6e61 6d65 203d 2027 6f74 6865 7227  l_name = 'other'
-00044f90: 0a20 2020 2020 2020 2020 2020 2023 2053  .            # S
-00044fa0: 706c 6974 2064 6174 6120 696e 746f 2074  plit data into t
-00044fb0: 7261 696e 2061 6e64 2074 6573 7420 6261  rain and test ba
-00044fc0: 7365 6420 6f6e 2066 6f6c 6473 2020 2020  sed on folds    
-00044fd0: 2020 2020 2020 0a20 2020 2020 2020 2020        .         
-00044fe0: 2020 2069 6620 6973 696e 7374 616e 6365     if isinstance
-00044ff0: 2879 2c20 7064 2e53 6572 6965 7329 206f  (y, pd.Series) o
-00045000: 7220 6973 696e 7374 616e 6365 2879 2c20  r isinstance(y, 
-00045010: 7064 2e44 6174 6146 7261 6d65 293a 0a20  pd.DataFrame):. 
-00045020: 2020 2020 2020 2020 2020 2020 2020 2079                 y
-00045030: 5f74 7261 696e 2c20 795f 7465 7374 203d  _train, y_test =
-00045040: 2079 2e69 6c6f 635b 7472 6169 6e5f 696e   y.iloc[train_in
-00045050: 6465 785d 2c20 792e 696c 6f63 5b74 6573  dex], y.iloc[tes
-00045060: 745f 696e 6465 785d 2020 2020 2020 2020  t_index]        
-00045070: 2020 2020 2020 2020 0a20 2020 2020 2020          .       
-00045080: 2020 2020 2065 6c73 653a 0a20 2020 2020       else:.     
-00045090: 2020 2020 2020 2020 2020 2079 5f74 7261             y_tra
-000450a0: 696e 2c20 795f 7465 7374 203d 2079 5b74  in, y_test = y[t
-000450b0: 7261 696e 5f69 6e64 6578 5d2c 2079 5b74  rain_index], y[t
-000450c0: 6573 745f 696e 6465 785d 0a0a 2020 2020  est_index]..    
-000450d0: 2020 2020 2020 2020 6966 2069 7369 6e73          if isins
-000450e0: 7461 6e63 6528 582c 2070 642e 4461 7461  tance(X, pd.Data
-000450f0: 4672 616d 6529 3a0a 2020 2020 2020 2020  Frame):.        
-00045100: 2020 2020 2020 2020 785f 7472 6169 6e2c          x_train,
-00045110: 2078 5f74 6573 7420 3d20 582e 696c 6f63   x_test = X.iloc
-00045120: 5b74 7261 696e 5f69 6e64 6578 5d2c 2058  [train_index], X
-00045130: 2e69 6c6f 635b 7465 7374 5f69 6e64 6578  .iloc[test_index
-00045140: 5d0a 2020 2020 2020 2020 2020 2020 656c  ].            el
-00045150: 7365 3a0a 2020 2020 2020 2020 2020 2020  se:.            
-00045160: 2020 2020 785f 7472 6169 6e2c 2078 5f74      x_train, x_t
-00045170: 6573 7420 3d20 585b 7472 6169 6e5f 696e  est = X[train_in
-00045180: 6465 785d 2c20 585b 7465 7374 5f69 6e64  dex], X[test_ind
-00045190: 6578 5d0a 0a20 2020 2020 2020 2020 2020  ex]..           
-000451a0: 2023 2043 6f6e 7665 7274 2074 6865 2064   # Convert the d
-000451b0: 6174 6120 696e 746f 206e 756d 7079 2061  ata into numpy a
-000451c0: 7272 6179 730a 2020 2020 2020 2020 2020  rrays.          
-000451d0: 2020 2369 6620 6e6f 7420 6973 696e 7374    #if not isinst
-000451e0: 616e 6365 2878 5f74 7261 696e 2c20 6e70  ance(x_train, np
-000451f0: 2e6e 6461 7272 6179 293a 0a20 2020 2020  .ndarray):.     
-00045200: 2020 2020 2020 2023 2020 2020 785f 7472         #    x_tr
-00045210: 6169 6e2c 2078 5f74 6573 7420 3d20 785f  ain, x_test = x_
-00045220: 7472 6169 6e2e 7661 6c75 6573 2c20 785f  train.values, x_
-00045230: 7465 7374 2e76 616c 7565 730a 2020 2020  test.values.    
-00045240: 2020 2020 2020 2020 0a20 2020 2020 2020          .       
-00045250: 2020 2020 2023 2320 2020 736d 616c 6c20       ##   small 
-00045260: 6461 7461 7365 7473 2070 726f 6365 7373  datasets process
-00045270: 696e 6720 2323 2323 230a 2020 2020 2020  ing #####.      
-00045280: 2020 2020 2020 6966 2069 203d 3d20 303a        if i == 0:
-00045290: 0a20 2020 2020 2020 2020 2020 2020 2020  .               
-000452a0: 2069 6620 7365 6c66 2e70 6970 656c 696e   if self.pipelin
-000452b0: 653a 0a20 2020 2020 2020 2020 2020 2020  e:.             
-000452c0: 2020 2020 2020 2023 2054 7261 696e 206d         # Train m
-000452d0: 6f64 656c 2061 6e64 2075 7365 2069 7420  odel and use it 
-000452e0: 696e 2061 2070 6970 656c 696e 6520 746f  in a pipeline to
-000452f0: 2074 7261 696e 206f 6e20 7468 6520 666f   train on the fo
-00045300: 6c64 2020 2323 0a20 2020 2020 2020 2020  ld  ##.         
-00045310: 2020 2020 2020 2020 2020 2070 6970 6520             pipe 
-00045320: 3d20 5069 7065 6c69 6e65 280a 2020 2020  = Pipeline(.    
-00045330: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00045340: 2020 2020 7374 6570 733d 5b28 2270 7265      steps=[("pre
-00045350: 7072 6f63 6573 736f 7222 2c20 7072 6570  processor", prep
-00045360: 726f 6365 7373 6f72 292c 2028 226d 6f64  rocessor), ("mod
-00045370: 656c 222c 2073 656c 662e 6261 7365 5f65  el", self.base_e
-00045380: 7374 696d 6174 6f72 295d 290a 2020 2020  stimator)]).    
-00045390: 2020 2020 2020 2020 2020 2020 2020 2020                  
-000453a0: 6966 2073 656c 662e 6d6f 6465 6c5f 6e61  if self.model_na
-000453b0: 6d65 203d 3d20 276f 7468 6572 273a 0a20  me == 'other':. 
-000453c0: 2020 2020 2020 2020 2020 2020 2020 2020                  
-000453d0: 2020 2020 2020 2070 7269 6e74 2827 4e6f         print('No
-000453e0: 2048 5054 2074 756e 696e 6720 7065 7266   HPT tuning perf
-000453f0: 6f72 6d65 6420 7369 6e63 6520 6261 7365  ormed since base
-00045400: 2065 7374 696d 6174 6f72 2069 7320 6769   estimator is gi
-00045410: 7665 6e20 6279 2069 6e70 7574 2e2e 2e27  ven by input...'
-00045420: 290a 2020 2020 2020 2020 2020 2020 2020  ).              
-00045430: 2020 2020 2020 2020 2020 7365 6c66 2e62            self.b
-00045440: 6173 655f 6573 7469 6d61 746f 7220 3d20  ase_estimator = 
-00045450: 636f 7079 2e64 6565 7063 6f70 7928 7069  copy.deepcopy(pi
-00045460: 7065 290a 2020 2020 2020 2020 2020 2020  pe).            
-00045470: 2020 2020 2020 2020 656c 7365 3a0a 2020          else:.  
-00045480: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00045490: 2020 2020 2020 6966 206c 656e 2873 656c        if len(sel
-000454a0: 662e 6665 6174 7572 6573 2920 3c3d 2066  f.features) <= f
-000454b0: 6561 7475 7265 735f 6c69 6d69 743a 0a20  eatures_limit:. 
-000454c0: 2020 2020 2020 2020 2020 2020 2020 2020                  
-000454d0: 2020 2020 2020 2020 2020 2073 656c 662e             self.
-000454e0: 6261 7365 5f65 7374 696d 6174 6f72 203d  base_estimator =
-000454f0: 2072 616e 645f 7365 6172 6368 2870 6970   rand_search(pip
-00045500: 652c 2078 5f74 7261 696e 2c20 795f 7472  e, x_train, y_tr
-00045510: 6169 6e2c 200a 2020 2020 2020 2020 2020  ain, .          
-00045520: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00045530: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00045540: 2020 2020 2020 2020 2020 7365 6c66 2e6d            self.m
-00045550: 6f64 656c 5f6e 616d 652c 2073 656c 662e  odel_name, self.
-00045560: 7069 7065 6c69 6e65 2c20 7363 6f72 696e  pipeline, scorin
-00045570: 672c 2076 6572 626f 7365 3d73 656c 662e  g, verbose=self.
-00045580: 7665 7262 6f73 6529 0a20 2020 2020 2020  verbose).       
-00045590: 2020 2020 2020 2020 2020 2020 2020 2020                  
-000455a0: 2065 6c73 653a 0a20 2020 2020 2020 2020   else:.         
-000455b0: 2020 2020 2020 2020 2020 2020 2020 2020                  
-000455c0: 2020 2070 7269 6e74 2827 4e6f 2048 5054     print('No HPT
-000455d0: 2074 756e 696e 6720 7065 7266 6f72 6d65   tuning performe
-000455e0: 6420 7369 6e63 6520 6e75 6d62 6572 206f  d since number o
-000455f0: 6620 6665 6174 7572 6573 2069 7320 746f  f features is to
-00045600: 6f20 6c61 7267 652e 2e2e 2729 0a20 2020  o large...').   
-00045610: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00045620: 2020 2020 2020 2020 2073 656c 662e 6261           self.ba
-00045630: 7365 5f65 7374 696d 6174 6f72 203d 2063  se_estimator = c
-00045640: 6f70 792e 6465 6570 636f 7079 2870 6970  opy.deepcopy(pip
-00045650: 6529 0a20 2020 2020 2020 2020 2020 2020  e).             
-00045660: 2020 2065 6c73 653a 0a20 2020 2020 2020     else:.       
-00045670: 2020 2020 2020 2020 2020 2020 2023 2323               ###
-00045680: 2054 6869 7320 6973 2066 6f72 2077 6974   This is for wit
-00045690: 686f 7574 2061 2070 6970 656c 696e 6520  hout a pipeline 
-000456a0: 2323 2323 2323 230a 2020 2020 2020 2020  #######.        
-000456b0: 2020 2020 2020 2020 2020 2020 6966 2073              if s
-000456c0: 656c 662e 6d6f 6465 6c5f 6e61 6d65 203d  elf.model_name =
-000456d0: 3d20 276f 7468 6572 273a 0a20 2020 2020  = 'other':.     
-000456e0: 2020 2020 2020 2020 2020 2020 2020 2020                  
-000456f0: 2020 2023 2323 206c 6561 7665 2074 6865     ### leave the
-00045700: 2062 6173 6520 6573 7469 6d61 746f 7220   base estimator 
-00045710: 6173 2069 7320 2323 230a 2020 2020 2020  as is ###.      
-00045720: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00045730: 2020 7072 696e 7428 274e 6f20 4850 5420    print('No HPT 
-00045740: 7475 6e69 6e67 2070 6572 666f 726d 6564  tuning performed
-00045750: 2073 696e 6365 2062 6173 6520 6573 7469   since base esti
-00045760: 6d61 746f 7220 6973 2067 6976 656e 2062  mator is given b
-00045770: 7920 696e 7075 742e 2e2e 2729 0a20 2020  y input...').   
-00045780: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00045790: 2065 6c73 653a 0a20 2020 2020 2020 2020   else:.         
-000457a0: 2020 2020 2020 2020 2020 2020 2020 2069                 i
-000457b0: 6620 6c65 6e28 7365 6c66 2e66 6561 7475  f len(self.featu
-000457c0: 7265 7329 203c 3d20 6665 6174 7572 6573  res) <= features
-000457d0: 5f6c 696d 6974 3a0a 2020 2020 2020 2020  _limit:.        
-000457e0: 2020 2020 2020 2020 2020 2020 2020 2020                  
-000457f0: 2020 2020 2323 2320 6c65 6176 6520 7468      ### leave th
-00045800: 6520 6261 7365 2065 7374 696d 6174 6f72  e base estimator
-00045810: 2061 7320 6973 2023 2323 0a20 2020 2020   as is ###.     
-00045820: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00045830: 2020 2020 2020 2073 656c 662e 6261 7365         self.base
-00045840: 5f65 7374 696d 6174 6f72 203d 2072 616e  _estimator = ran
-00045850: 645f 7365 6172 6368 2873 656c 662e 6261  d_search(self.ba
-00045860: 7365 5f65 7374 696d 6174 6f72 2c20 785f  se_estimator, x_
-00045870: 7472 6169 6e2c 200a 2020 2020 2020 2020  train, .        
-00045880: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00045890: 2020 2020 2020 2020 2020 2020 2020 2020                  
-000458a0: 2020 2020 2020 2020 795f 7472 6169 6e2c          y_train,
-000458b0: 2073 656c 662e 6d6f 6465 6c5f 6e61 6d65   self.model_name
-000458c0: 2c20 7365 6c66 2e70 6970 656c 696e 652c  , self.pipeline,
-000458d0: 2073 636f 7269 6e67 2c20 7665 7262 6f73   scoring, verbos
-000458e0: 653d 7365 6c66 2e76 6572 626f 7365 290a  e=self.verbose).
-000458f0: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00045900: 2020 2020 2020 2020 656c 7365 3a0a 2020          else:.  
-00045910: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00045920: 2020 2020 2020 2020 2020 7072 696e 7428            print(
-00045930: 274e 6f20 4850 5420 7475 6e69 6e67 2070  'No HPT tuning p
-00045940: 6572 666f 726d 6564 2073 696e 6365 206e  erformed since n
-00045950: 756d 6265 7220 6f66 2066 6561 7475 7265  umber of feature
-00045960: 7320 6973 2074 6f6f 206c 6172 6765 2e2e  s is too large..
-00045970: 2e27 290a 0a20 2020 2020 2020 2020 2020  .')..           
-00045980: 2020 2020 2065 7374 5f6c 6973 7420 3d20       est_list = 
-00045990: 6e75 6d5f 6974 6572 6174 696f 6e73 2a5b  num_iterations*[
-000459a0: 7365 6c66 2e62 6173 655f 6573 7469 6d61  self.base_estima
-000459b0: 746f 725d 0a20 2020 2020 2020 2020 2020  tor].           
-000459c0: 2020 2020 2023 7072 696e 7428 2720 2020       #print('   
-000459d0: 2062 6173 6520 6573 7469 6d61 746f 7220   base estimator 
-000459e0: 3d20 2573 2720 2573 656c 662e 6261 7365  = %s' %self.base
-000459f0: 5f65 7374 696d 6174 6f72 290a 2020 2020  _estimator).    
-00045a00: 2020 2020 2020 2020 0a20 2020 2020 2020          .       
-00045a10: 2020 2020 2023 2323 2053 4d4f 5445 2070       ### SMOTE p
-00045a20: 726f 6365 7373 696e 6720 2323 2323 230a  rocessing #####.
-00045a30: 2020 2020 2020 2020 2020 2020 6966 2069              if i
-00045a40: 203d 3d20 303a 0a20 2020 2020 2020 2020   == 0:.         
-00045a50: 2020 2020 2020 2069 6620 736d 6f74 653a         if smote:
-00045a60: 0a20 2020 2020 2020 2020 2020 2020 2020  .               
-00045a70: 2020 2020 2070 7269 6e74 2827 5065 7266       print('Perf
-00045a80: 6f72 6d69 6e67 2053 4d4f 5445 2e2e 2e27  orming SMOTE...'
-00045a90: 290a 2020 2020 2020 2020 2020 2020 2020  ).              
-00045aa0: 2020 2020 2020 6966 2073 656c 662e 7665        if self.ve
-00045ab0: 7262 6f73 653a 0a20 2020 2020 2020 2020  rbose:.         
-00045ac0: 2020 2020 2020 2020 2020 2020 2020 2070                 p
-00045ad0: 7269 6e74 2827 2020 2020 785f 7472 6169  rint('    x_trai
-00045ae0: 6e20 7368 6170 6520 6265 666f 7265 2053  n shape before S
-00045af0: 4d4f 5445 203d 2025 7327 2025 2878 5f74  MOTE = %s' %(x_t
-00045b00: 7261 696e 2e73 6861 7065 2c29 290a 2020  rain.shape,)).  
-00045b10: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00045b20: 2020 0a20 2020 2020 2020 2020 2020 2069    .            i
-00045b30: 6620 736d 6f74 653a 0a20 2020 2020 2020  f smote:.       
-00045b40: 2020 2020 2020 2020 2023 2323 2049 7420           ### It 
-00045b50: 646f 6573 206e 6f74 2061 7070 6561 7220  does not appear 
-00045b60: 7468 6174 2063 6c61 7373 2077 6569 6768  that class weigh
-00045b70: 7473 2077 6f72 6b20 7765 6c6c 2069 6e20  ts work well in 
-00045b80: 534d 4f54 4520 2d20 6865 6e63 6520 6176  SMOTE - hence av
-00045b90: 6f69 6420 2323 2320 2020 2020 2020 2020  oid ###         
-00045ba0: 2020 2020 2020 200a 2020 2020 2020 2020         .        
-00045bb0: 2020 2020 2020 2020 7472 793a 0a20 2020          try:.   
-00045bc0: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00045bd0: 2073 6d20 3d20 4144 4153 594e 286e 5f6e   sm = ADASYN(n_n
-00045be0: 6569 6768 626f 7273 3d35 2c20 7261 6e64  eighbors=5, rand
-00045bf0: 6f6d 5f73 7461 7465 3d73 6565 642c 2029  om_state=seed, )
-00045c00: 0a20 2020 2020 2020 2020 2020 2020 2020  .               
-00045c10: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00045c20: 2023 7361 6d70 6c69 6e67 5f73 7472 6174   #sampling_strat
-00045c30: 6567 793d 636c 6173 735f 7765 6967 6874  egy=class_weight
-00045c40: 6564 5f72 6f77 7329 0a20 2020 2020 2020  ed_rows).       
-00045c50: 2020 2020 2020 2020 2020 2020 200a 2020               .  
-00045c60: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00045c70: 2020 785f 7472 6169 6e2c 2079 5f74 7261    x_train, y_tra
-00045c80: 696e 203d 2073 6d2e 6669 745f 7265 7361  in = sm.fit_resa
-00045c90: 6d70 6c65 2878 5f74 7261 696e 2c20 795f  mple(x_train, y_
-00045ca0: 7472 6169 6e29 0a20 2020 2020 2020 2020  train).         
-00045cb0: 2020 2020 2020 2020 2020 2069 6620 6920             if i 
-00045cc0: 3d3d 2030 3a0a 2020 2020 2020 2020 2020  == 0:.          
-00045cd0: 2020 2020 2020 2020 2020 2020 2020 7072                pr
-00045ce0: 696e 7428 2720 2020 2078 5f74 7261 696e  int('    x_train
-00045cf0: 2073 6861 7065 2061 6674 6572 2053 4d4f   shape after SMO
-00045d00: 5445 203d 2025 7327 2025 2878 5f74 7261  TE = %s' %(x_tra
-00045d10: 696e 2e73 6861 7065 2c29 290a 2020 2020  in.shape,)).    
-00045d20: 2020 2020 2020 2020 2020 2020 6578 6365              exce
-00045d30: 7074 3a0a 2020 2020 2020 2020 2020 2020  pt:.            
-00045d40: 2020 2020 2020 2020 736d 203d 2053 4d4f          sm = SMO
-00045d50: 5445 546f 6d65 6b28 7261 6e64 6f6d 5f73  TETomek(random_s
-00045d60: 7461 7465 3d34 322c 290a 2020 2020 2020  tate=42,).      
-00045d70: 2020 2020 2020 2020 2020 2020 2020 2373                #s
-00045d80: 6d20 3d20 4144 4153 594e 286e 5f6e 6569  m = ADASYN(n_nei
-00045d90: 6768 626f 7273 3d32 2c20 7261 6e64 6f6d  ghbors=2, random
-00045da0: 5f73 7461 7465 3d73 6565 642c 2029 0a20  _state=seed, ). 
-00045db0: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00045dc0: 2020 2020 2020 2020 2020 2020 2020 2023                 #
-00045dd0: 7361 6d70 6c69 6e67 5f73 7472 6174 6567  sampling_strateg
-00045de0: 793d 636c 6173 735f 7765 6967 6874 6564  y=class_weighted
-00045df0: 5f72 6f77 7329 0a20 2020 2020 2020 2020  _rows).         
-00045e00: 2020 2020 2020 2020 2020 2078 5f74 7261             x_tra
-00045e10: 696e 2c20 795f 7472 6169 6e20 3d20 736d  in, y_train = sm
-00045e20: 2e66 6974 5f72 6573 616d 706c 6528 785f  .fit_resample(x_
-00045e30: 7472 6169 6e2c 2079 5f74 7261 696e 2920  train, y_train) 
-00045e40: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00045e50: 2020 200a 2020 2020 2020 2020 2020 2020     .            
-00045e60: 2020 2020 2020 2020 6966 2069 203d 3d20          if i == 
-00045e70: 3020 616e 6420 736d 6f74 653a 0a20 2020  0 and smote:.   
-00045e80: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00045e90: 2020 2020 2070 7269 6e74 2827 2020 2020       print('    
-00045ea0: 785f 7472 6169 6e20 7368 6170 6520 6166  x_train shape af
-00045eb0: 7465 7220 534d 4f54 4520 3d20 2573 2720  ter SMOTE = %s' 
-00045ec0: 2528 785f 7472 6169 6e2e 7368 6170 652c  %(x_train.shape,
-00045ed0: 2929 0a20 2020 2020 2020 2020 2020 200a  )).            .
-00045ee0: 2020 2020 2020 2020 2020 2020 2320 496e              # In
-00045ef0: 6974 6961 6c69 7a65 206d 6f64 656c 2077  itialize model w
-00045f00: 6974 6820 796f 7572 2073 7570 6572 7669  ith your supervi
-00045f10: 7365 6420 616c 676f 7269 7468 6d20 6f66  sed algorithm of
-00045f20: 2063 686f 6963 650a 2020 2020 2020 2020   choice.        
-00045f30: 2020 2020 6d6f 6465 6c20 3d20 6573 745f      model = est_
-00045f40: 6c69 7374 5b69 5d0a 2020 2020 2020 2020  list[i].        
-00045f50: 2020 2020 0a20 2020 2020 2020 2020 2020      .           
-00045f60: 206d 6f64 656c 2e66 6974 2878 5f74 7261   model.fit(x_tra
-00045f70: 696e 2c20 795f 7472 6169 6e29 0a20 2020  in, y_train).   
-00045f80: 2020 2020 2020 2020 2073 656c 662e 6d6f           self.mo
-00045f90: 6465 6c73 2e61 7070 656e 6428 6d6f 6465  dels.append(mode
-00045fa0: 6c29 0a0a 2020 2020 2020 2020 2020 2020  l)..            
-00045fb0: 2320 5072 6564 6963 7420 6f6e 2072 656d  # Predict on rem
-00045fc0: 6169 6e69 6e67 2064 6174 6120 6f66 2065  aining data of e
-00045fd0: 6163 6820 666f 6c64 0a20 2020 2020 2020  ach fold.       
-00045fe0: 2020 2020 2070 7265 6473 203d 206d 6f64       preds = mod
-00045ff0: 656c 2e70 7265 6469 6374 2878 5f74 6573  el.predict(x_tes
-00046000: 7429 0a0a 2020 2020 2020 2020 2020 2020  t)..            
-00046010: 6966 2073 656c 662e 6c6f 675f 7472 616e  if self.log_tran
-00046020: 7366 6f72 6d3a 0a20 2020 2020 2020 2020  sform:.         
-00046030: 2020 2020 2020 2070 7265 6473 203d 206e         preds = n
-00046040: 702e 6578 706d 3128 7072 6564 7329 0a20  p.expm1(preds). 
-00046050: 2020 2020 2020 2020 2020 2065 6c69 6620             elif 
-00046060: 7365 6c66 2e69 6e74 6567 6572 735f 6f6e  self.integers_on
-00046070: 6c79 3a0a 2020 2020 2020 2020 2020 2020  ly:.            
-00046080: 2020 2020 2323 2320 5573 6520 5265 6772      ### Use Regr
-00046090: 6573 7369 6f6e 2070 7265 6469 6374 696f  ession predictio
-000460a0: 6e73 2061 6e64 2063 6f6e 7665 7274 2074  ns and convert t
-000460b0: 6865 6d20 696e 746f 2069 6e74 6567 6572  hem into integer
-000460c0: 7320 6865 7265 2023 230a 2020 2020 2020  s here ##.      
-000460d0: 2020 2020 2020 2020 2020 7072 6564 7320            preds 
-000460e0: 3d20 6e70 2e72 6f75 6e64 2870 7265 6473  = np.round(preds
-000460f0: 2c30 292e 6173 7479 7065 2869 6e74 290a  ,0).astype(int).
-00046100: 0a20 2020 2020 2020 2020 2020 2073 636f  .            sco
-00046110: 7265 203d 2070 7269 6e74 5f72 6567 7265  re = print_regre
-00046120: 7373 696f 6e5f 6d6f 6465 6c5f 7374 6174  ssion_model_stat
-00046130: 7328 795f 7465 7374 2c20 7072 6564 7329  s(y_test, preds)
-00046140: 0a20 2020 2020 2020 2020 2020 2069 6620  .            if 
-00046150: 7365 6c66 2e76 6572 626f 7365 3a0a 2020  self.verbose:.  
-00046160: 2020 2020 2020 2020 2020 2020 2020 7072                pr
-00046170: 696e 7428 2220 2020 2046 6f6c 6420 2573  int("    Fold %s
-00046180: 3a20 6f75 742d 6f66 2d66 6f6c 6420 524d  : out-of-fold RM
-00046190: 5345 2028 736d 616c 6c65 7220 6973 2062  SE (smaller is b
-000461a0: 6574 7465 7229 3a20 2530 2e33 6622 2025  etter): %0.3f" %
-000461b0: 2869 2b31 2c20 7363 6f72 6529 290a 2020  (i+1, score)).  
-000461c0: 2020 2020 2020 2020 2020 2020 2020 7072                pr
-000461d0: 696e 7428 2220 2020 2020 2020 2020 2020  int("           
-000461e0: 2020 204e 6f72 6d61 6c69 7a65 6420 524d     Normalized RM
-000461f0: 5345 2028 736d 616c 6c65 7220 6973 2062  SE (smaller is b
-00046200: 6574 7465 7229 3a20 2530 2e33 6622 2025  etter): %0.3f" %
-00046210: 2873 636f 7265 2f6e 702e 7374 6428 795f  (score/np.std(y_
-00046220: 7465 7374 2929 290a 2020 2020 2020 2020  test))).        
-00046230: 2020 2020 7365 6c66 2e73 636f 7265 732e      self.scores.
-00046240: 6170 7065 6e64 2873 636f 7265 290a 0a20  append(score).. 
-00046250: 2020 2020 2020 2020 2020 2069 202b 3d20             i += 
-00046260: 310a 0a20 2020 2020 2020 2023 2043 6f6d  1..        # Com
-00046270: 7075 7465 2061 7665 7261 6765 2073 636f  pute average sco
-00046280: 7265 0a20 2020 2020 2020 2061 7665 7261  re.        avera
-00046290: 6765 4163 6375 7261 6379 203d 2073 756d  geAccuracy = sum
-000462a0: 2873 656c 662e 7363 6f72 6573 292f 6c65  (self.scores)/le
-000462b0: 6e28 7365 6c66 2e73 636f 7265 7329 0a20  n(self.scores). 
-000462c0: 2020 2020 2020 2070 7269 6e74 2822 4669         print("Fi
-000462d0: 6e61 6c20 524d 5345 206f 6620 2573 2d65  nal RMSE of %s-e
-000462e0: 7374 696d 6174 6f72 2053 756c 6f52 6567  stimator SuloReg
-000462f0: 7265 7373 6f72 3a20 2530 2e33 6622 2025  ressor: %0.3f" %
-00046300: 286e 756d 5f69 7465 7261 7469 6f6e 732c  (num_iterations,
-00046310: 2061 7665 7261 6765 4163 6375 7261 6379   averageAccuracy
-00046320: 2929 0a20 2020 2020 2020 2070 7269 6e74  )).        print
-00046330: 2822 2020 2020 4669 6e61 6c20 4e6f 726d  ("    Final Norm
-00046340: 616c 697a 6564 2052 4d53 453a 2025 302e  alized RMSE: %0.
-00046350: 3166 2525 2220 2528 3130 302a 6176 6572  1f%%" %(100*aver
-00046360: 6167 6541 6363 7572 6163 792f 6e70 2e73  ageAccuracy/np.s
-00046370: 7464 2879 5f74 6573 7429 2929 0a0a 2020  td(y_test)))..  
-00046380: 2020 2020 2020 2320 4669 6e61 6c6c 792c        # Finally,
-00046390: 2063 6865 636b 206f 7574 2074 6865 2074   check out the t
-000463a0: 6f74 616c 2074 696d 6520 7461 6b65 6e0a  otal time taken.
-000463b0: 2020 2020 2020 2020 656e 6420 3d20 7469          end = ti
-000463c0: 6d65 2e74 696d 6528 290a 2020 2020 2020  me.time().      
-000463d0: 2020 7469 6d65 5461 6b65 6e20 3d20 656e    timeTaken = en
-000463e0: 642d 7374 6172 740a 2020 2020 2020 2020  d-start.        
-000463f0: 7072 696e 7428 2254 696d 6520 5461 6b65  print("Time Take
-00046400: 6e3a 2025 302e 3066 2028 7365 636f 6e64  n: %0.0f (second
-00046410: 7329 2220 2574 696d 6554 616b 656e 290a  s)" %timeTaken).
-00046420: 2020 2020 2020 2020 7365 6c66 2e6b 6620          self.kf 
-00046430: 3d20 6b66 6f6c 640a 0a20 2020 2020 2020  = kfold..       
-00046440: 2072 6574 7572 6e20 7365 6c66 0a0a 2020   return self..  
-00046450: 2020 6465 6620 7072 6564 6963 7428 7365    def predict(se
-00046460: 6c66 2c20 5829 3a0a 2020 2020 2020 2020  lf, X):.        
-00046470: 6672 6f6d 2073 6369 7079 2069 6d70 6f72  from scipy impor
-00046480: 7420 7374 6174 730a 2020 2020 2020 2020  t stats.        
-00046490: 7765 6967 6874 7320 3d20 312f 6e70 2e61  weights = 1/np.a
-000464a0: 7272 6179 2873 656c 662e 7363 6f72 6573  rray(self.scores
-000464b0: 290a 2020 2020 2020 2020 6966 2073 656c  ).        if sel
-000464c0: 662e 6d75 6c74 695f 6c61 6265 6c3a 0a20  f.multi_label:. 
-000464d0: 2020 2020 2020 2020 2020 2023 2323 2049             ### I
-000464e0: 6e20 6d75 6c74 692d 6c61 6265 6c2c 2074  n multi-label, t
-000464f0: 6172 6765 7473 2068 6176 6520 746f 2062  argets have to b
-00046500: 6520 6e75 6d65 7269 632c 2073 6f20 796f  e numeric, so yo
-00046510: 7520 6361 6e20 6c65 6176 6520 7765 6967  u can leave weig
-00046520: 6874 7320 6173 2d69 7320 2323 0a20 2020  hts as-is ##.   
-00046530: 2020 2020 2020 2020 2079 7072 6520 3d20           ypre = 
-00046540: 6e70 2e61 7272 6179 285b 6d6f 6465 6c2e  np.array([model.
-00046550: 7072 6564 6963 7428 5829 2066 6f72 206d  predict(X) for m
-00046560: 6f64 656c 2069 6e20 7365 6c66 2e6d 6f64  odel in self.mod
-00046570: 656c 7320 5d29 0a20 2020 2020 2020 2020  els ]).         
-00046580: 2020 2079 5f70 7265 6469 7320 3d20 6e70     y_predis = np
-00046590: 2e61 7665 7261 6765 2879 7072 652c 2061  .average(ypre, a
-000465a0: 7869 733d 302c 2077 6569 6768 7473 3d77  xis=0, weights=w
-000465b0: 6569 6768 7473 290a 2020 2020 2020 2020  eights).        
-000465c0: 2020 2020 6966 2073 656c 662e 6c6f 675f      if self.log_
-000465d0: 7472 616e 7366 6f72 6d3a 0a20 2020 2020  transform:.     
-000465e0: 2020 2020 2020 2020 2020 2079 5f70 7265             y_pre
-000465f0: 6469 7320 3d20 6e70 2e65 7870 6d31 2879  dis = np.expm1(y
-00046600: 5f70 7265 6469 7329 0a20 2020 2020 2020  _predis).       
-00046610: 2020 2020 2023 2323 206c 6561 7665 2074       ### leave t
-00046620: 6865 206e 6578 7420 6c69 6e65 2061 7320  he next line as 
-00046630: 6966 2073 696e 6365 2079 6f75 2077 616e  if since you wan
-00046640: 7420 746f 2063 6865 636b 2066 6f72 2069  t to check for i
-00046650: 7420 7365 7061 7261 7465 6c79 0a20 2020  t separately.   
-00046660: 2020 2020 2020 2020 2069 6620 7365 6c66           if self
-00046670: 2e69 6e74 6567 6572 735f 6f6e 6c79 3a0a  .integers_only:.
-00046680: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00046690: 795f 7072 6564 6973 203d 206e 702e 726f  y_predis = np.ro
-000466a0: 756e 6428 795f 7072 6564 6973 2c30 292e  und(y_predis,0).
-000466b0: 6173 7479 7065 2869 6e74 290a 2020 2020  astype(int).    
-000466c0: 2020 2020 2020 2020 7265 7475 726e 2079          return y
-000466d0: 5f70 7265 6469 730a 2020 2020 2020 2020  _predis.        
-000466e0: 795f 7072 6564 6973 203d 206e 702e 636f  y_predis = np.co
-000466f0: 6c75 6d6e 5f73 7461 636b 285b 6d6f 6465  lumn_stack([mode
-00046700: 6c2e 7072 6564 6963 7428 5829 2066 6f72  l.predict(X) for
-00046710: 206d 6f64 656c 2069 6e20 7365 6c66 2e6d   model in self.m
-00046720: 6f64 656c 7320 5d29 0a20 2020 2020 2020  odels ]).       
-00046730: 2023 2323 2054 6869 7320 7765 6967 6874   ### This weight
-00046740: 7320 7468 6520 6d6f 6465 6c27 7320 7072  s the model's pr
-00046750: 6564 6963 7469 6f6e 7320 6163 636f 7264  edictions accord
-00046760: 696e 6720 746f 204f 4f42 2073 636f 7265  ing to OOB score
-00046770: 7320 6f62 7461 696e 6564 0a20 2020 2020  s obtained.     
-00046780: 2020 2023 2323 2320 496e 2073 696e 676c     #### In singl
-00046790: 6520 6c61 6265 6c2c 2074 6172 6765 7473  e label, targets
-000467a0: 2063 616e 2062 6520 6f62 6a65 6374 206f   can be object o
-000467b0: 7220 7374 7269 6e67 2c20 736f 2077 6569  r string, so wei
-000467c0: 6768 7473 2063 616e 6e6f 7420 6265 2061  ghts cannot be a
-000467d0: 7070 6c69 6564 2061 6c77 6179 7320 2323  pplied always ##
-000467e0: 0a20 2020 2020 2020 2079 5f70 7265 6469  .        y_predi
-000467f0: 7320 3d20 6e70 2e61 7665 7261 6765 2879  s = np.average(y
-00046800: 5f70 7265 6469 732c 2077 6569 6768 7473  _predis, weights
-00046810: 3d77 6569 6768 7473 2c20 6178 6973 3d31  =weights, axis=1
-00046820: 290a 2020 2020 2020 2020 6966 2073 656c  ).        if sel
-00046830: 662e 6c6f 675f 7472 616e 7366 6f72 6d3a  f.log_transform:
-00046840: 0a20 2020 2020 2020 2020 2020 2079 5f70  .            y_p
-00046850: 7265 6469 7320 3d20 6e70 2e65 7870 6d31  redis = np.expm1
-00046860: 2879 5f70 7265 6469 7329 0a20 2020 2020  (y_predis).     
-00046870: 2020 2069 6620 7365 6c66 2e69 6e74 6567     if self.integ
-00046880: 6572 735f 6f6e 6c79 3a0a 2020 2020 2020  ers_only:.      
-00046890: 2020 2020 2020 795f 7072 6564 6973 203d        y_predis =
-000468a0: 206e 702e 726f 756e 6428 795f 7072 6564   np.round(y_pred
-000468b0: 6973 2c30 292e 6173 7479 7065 2869 6e74  is,0).astype(int
-000468c0: 290a 2020 2020 2020 2020 7265 7475 726e  ).        return
-000468d0: 2079 5f70 7265 6469 730a 2020 2020 0a20   y_predis.    . 
-000468e0: 2020 2064 6566 2070 7265 6469 6374 5f70     def predict_p
-000468f0: 726f 6261 2873 656c 662c 2058 293a 0a20  roba(self, X):. 
-00046900: 2020 2020 2020 2070 7269 6e74 2827 4572         print('Er
-00046910: 726f 723a 2049 6e20 7265 6772 6573 7369  ror: In regressi
-00046920: 6f6e 2070 726f 626c 656d 732c 206e 6f20  on problems, no 
-00046930: 7072 6f62 6162 696c 6974 6965 7320 6361  probabilities ca
-00046940: 6e20 6265 206f 6274 6169 6e65 642e 2052  n be obtained. R
-00046950: 6574 7572 6e69 6e67 2e2e 2e27 290a 2020  eturning...').  
-00046960: 2020 2020 2020 7265 7475 726e 2058 0a0a        return X..
-00046970: 2020 2020 6465 6620 7265 7475 726e 5f77      def return_w
-00046980: 6f72 7374 5f66 6f6c 6428 7365 6c66 2c20  orst_fold(self, 
-00046990: 5829 3a0a 2020 2020 2020 2020 2222 220a  X):.        """.
-000469a0: 2020 2020 2020 2020 5468 6973 206d 6574          This met
-000469b0: 686f 6420 7265 7475 726e 7320 7468 6520  hod returns the 
-000469c0: 776f 7273 7420 7065 7266 6f72 6d69 6e67  worst performing
-000469d0: 2074 7261 696e 2061 6e64 2074 6573 7420   train and test 
-000469e0: 726f 7773 2061 6d6f 6e67 2061 6c6c 2074  rows among all t
-000469f0: 6865 2066 6f6c 6473 2e0a 2020 2020 2020  he folds..      
-00046a00: 2020 5468 6973 2069 7320 7665 7279 2069    This is very i
-00046a10: 6d70 6f72 7461 6e74 2069 6e66 6f72 6d61  mportant informa
-00046a20: 7469 6f6e 2073 696e 6365 2069 7420 6865  tion since it he
-00046a30: 6c70 7320 616e 204d 4c20 656e 6769 6e65  lps an ML engine
-00046a40: 6572 206f 7220 4461 7461 2053 6369 656e  er or Data Scien
-00046a50: 7469 7374 200a 2020 2020 2020 2020 2020  tist .          
-00046a60: 2020 746f 2074 726f 7562 6c65 2073 686f    to trouble sho
-00046a70: 6f74 2074 696d 6520 7365 7269 6573 2070  ot time series p
-00046a80: 726f 626c 656d 732e 2049 7420 6865 6c70  roblems. It help
-00046a90: 7320 746f 2066 696e 6420 7768 6572 6520  s to find where 
-00046aa0: 7468 6520 6d6f 6465 6c20 6973 2073 7472  the model is str
-00046ab0: 7567 676c 696e 672e 0a0a 2020 2020 2020  uggling...      
-00046ac0: 2020 496e 7075 7473 3a0a 2020 2020 2020    Inputs:.      
-00046ad0: 2020 2d2d 2d2d 2d2d 2d2d 0a20 2020 2020    --------.     
-00046ae0: 2020 2058 3a20 4461 7461 6672 616d 652e     X: Dataframe.
-00046af0: 2054 6869 7320 6d75 7374 2062 6520 7468   This must be th
-00046b00: 6520 6665 6174 7572 6573 2064 6174 6166  e features dataf
-00046b10: 7261 6d65 206f 6620 796f 7572 2064 6174  rame of your dat
-00046b20: 6173 6574 2e20 4974 2063 616e 6e6f 7420  aset. It cannot 
-00046b30: 6265 2061 206e 756d 7079 2061 7272 6179  be a numpy array
-00046b40: 2e0a 0a20 2020 2020 2020 204f 7574 7075  ...        Outpu
-00046b50: 7473 3a0a 2020 2020 2020 2020 2d2d 2d2d  ts:.        ----
-00046b60: 2d2d 2d2d 2d0a 2020 2020 2020 2020 7472  -----.        tr
-00046b70: 6169 6e5f 726f 7773 5f64 6174 6166 7261  ain_rows_datafra
-00046b80: 6d65 2c20 7465 7374 5f72 6f77 735f 6461  me, test_rows_da
-00046b90: 7461 6672 616d 653a 2044 6174 6166 7261  taframe: Datafra
-00046ba0: 6d65 732e 200a 2020 2020 2020 2020 2020  mes. .          
-00046bb0: 2020 2054 6869 7320 7265 7475 726e 7320     This returns 
-00046bc0: 7468 6520 706f 7274 696f 6e20 6f66 2058  the portion of X
-00046bd0: 2061 7320 7472 6169 6e20 616e 6420 7465   as train and te
-00046be0: 7374 2074 6f20 6865 6c70 2079 6f75 2075  st to help you u
-00046bf0: 6e64 6572 7374 616e 6420 7768 6572 6520  nderstand where 
-00046c00: 6d6f 6465 6c20 7374 7275 6767 6c65 642e  model struggled.
-00046c10: 0a20 2020 2020 2020 2022 2222 0a20 2020  .        """.   
-00046c20: 2020 2020 2077 6f72 7374 5f66 6f6c 6420       worst_fold 
-00046c30: 3d20 6e70 2e61 7267 6d61 7828 7365 6c66  = np.argmax(self
-00046c40: 2e73 636f 7265 7329 0a20 2020 2020 2020  .scores).       
-00046c50: 2066 6f72 2069 2c20 2874 722c 2074 7429   for i, (tr, tt)
-00046c60: 2069 6e20 656e 756d 6572 6174 6528 7365   in enumerate(se
-00046c70: 6c66 2e6b 662e 7370 6c69 7428 5829 293a  lf.kf.split(X)):
-00046c80: 0a20 2020 2020 2020 2020 2020 2069 6620  .            if 
-00046c90: 6920 3d3d 2077 6f72 7374 5f66 6f6c 643a  i == worst_fold:
-00046ca0: 0a20 2020 2020 2020 2020 2020 2020 2020  .               
-00046cb0: 2077 6f72 7374 5f74 7261 696e 5f72 6f77   worst_train_row
-00046cc0: 7320 3d20 636f 7079 2e64 6565 7063 6f70  s = copy.deepcop
-00046cd0: 7928 7472 290a 2020 2020 2020 2020 2020  y(tr).          
-00046ce0: 2020 2020 2020 776f 7273 745f 7474 6573        worst_ttes
-00046cf0: 745f 726f 7773 203d 2063 6f70 792e 6465  t_rows = copy.de
-00046d00: 6570 636f 7079 2874 7429 0a20 2020 2020  epcopy(tt).     
-00046d10: 2020 2020 2020 2020 2020 2070 7269 6e74             print
-00046d20: 2822 666f 6c64 2025 733a 2074 7261 696e  ("fold %s: train
-00046d30: 2072 6f77 7320 696e 6465 7820 3d20 2573   rows index = %s
-00046d40: 2e20 5375 6c6f 206d 6f64 656c 2073 7472  . Sulo model str
-00046d50: 7567 676c 6564 2069 6e20 7468 6973 2066  uggled in this f
-00046d60: 6f6c 642e 2220 2528 692b 312c 7472 2929  old." %(i+1,tr))
-00046d70: 0a20 2020 2020 2020 2020 2020 2065 6c73  .            els
-00046d80: 653a 0a20 2020 2020 2020 2020 2020 2020  e:.             
-00046d90: 2020 2070 7269 6e74 2822 666f 6c64 2025     print("fold %
-00046da0: 733a 2074 7261 696e 2072 6f77 7320 696e  s: train rows in
-00046db0: 6465 7820 3d20 2573 2220 2528 692b 312c  dex = %s" %(i+1,
-00046dc0: 7472 2929 0a20 2020 2020 2020 2072 6574  tr)).        ret
-00046dd0: 7572 6e20 582e 696c 6f63 5b77 6f72 7374  urn X.iloc[worst
-00046de0: 5f74 7261 696e 5f72 6f77 735d 2c20 582e  _train_rows], X.
-00046df0: 696c 6f63 5b77 6f72 7374 5f74 7465 7374  iloc[worst_ttest
-00046e00: 5f72 6f77 735d 0a0a 2020 2020 6465 6620  _rows]..    def 
-00046e10: 706c 6f74 5f69 6d70 6f72 7461 6e63 6528  plot_importance(
-00046e20: 7365 6c66 2c20 6d61 785f 6665 6174 7572  self, max_featur
-00046e30: 6573 3d31 3029 3a0a 2020 2020 2020 2020  es=10):.        
-00046e40: 696d 706f 7274 206c 6967 6874 6762 6d20  import lightgbm 
-00046e50: 6173 206c 6762 6d0a 2020 2020 2020 2020  as lgbm.        
-00046e60: 6672 6f6d 2078 6762 6f6f 7374 2069 6d70  from xgboost imp
-00046e70: 6f72 7420 706c 6f74 5f69 6d70 6f72 7461  ort plot_importa
-00046e80: 6e63 650a 2020 2020 2020 2020 6d6f 6465  nce.        mode
-00046e90: 6c5f 6e61 6d65 203d 2073 656c 662e 6d6f  l_name = self.mo
-00046ea0: 6465 6c5f 6e61 6d65 0a20 2020 2020 2020  del_name.       
-00046eb0: 2066 6561 7475 7265 5f6e 616d 6573 203d   feature_names =
-00046ec0: 2073 656c 662e 6665 6174 7572 6573 0a0a   self.features..
-00046ed0: 2020 2020 2020 2020 6966 2020 6d6f 6465          if  mode
-00046ee0: 6c5f 6e61 6d65 203d 3d20 276c 6762 2720  l_name == 'lgb' 
-00046ef0: 6f72 206d 6f64 656c 5f6e 616d 6520 3d3d  or model_name ==
-00046f00: 2027 7867 6227 3a0a 2020 2020 2020 2020   'xgb':.        
-00046f10: 2020 2020 666f 7220 692c 206d 6f64 656c      for i, model
-00046f20: 2069 6e20 656e 756d 6572 6174 6528 7365   in enumerate(se
-00046f30: 6c66 2e6d 6f64 656c 7329 3a0a 2020 2020  lf.models):.    
-00046f40: 2020 2020 2020 2020 2020 2020 6966 2073              if s
-00046f50: 656c 662e 7069 7065 6c69 6e65 3a0a 2020  elf.pipeline:.  
-00046f60: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00046f70: 2020 6966 2073 656c 662e 6d75 6c74 695f    if self.multi_
-00046f80: 6c61 6265 6c3a 0a20 2020 2020 2020 2020  label:.         
-00046f90: 2020 2020 2020 2020 2020 2020 2020 2023                 #
-00046fa0: 6d6f 6465 6c5f 6f62 6a65 6374 203d 206d  model_object = m
-00046fb0: 6f64 656c 2e6e 616d 6564 5f73 7465 7073  odel.named_steps
-00046fc0: 5b27 6d6f 6465 6c27 5d2e 6261 7365 5f65  ['model'].base_e
-00046fd0: 7374 696d 6174 6f72 0a20 2020 2020 2020  stimator.       
-00046fe0: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00046ff0: 2070 7269 6e74 2827 4e6f 2066 6561 7475   print('No featu
-00047000: 7265 2069 6d70 6f72 7461 6e63 6573 2061  re importances a
-00047010: 7661 696c 6162 6c65 2066 6f72 206d 756c  vailable for mul
-00047020: 7469 5f6c 6162 656c 2074 6172 6765 7473  ti_label targets
-00047030: 2e20 5265 7475 726e 696e 672e 2e2e 2729  . Returning...')
-00047040: 0a20 2020 2020 2020 2020 2020 2020 2020  .               
-00047050: 2020 2020 2020 2020 2072 6574 7572 6e0a           return.
-00047060: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00047070: 2020 2020 656c 7365 3a0a 2020 2020 2020      else:.      
-00047080: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00047090: 2020 6d6f 6465 6c5f 6f62 6a65 6374 203d    model_object =
-000470a0: 206d 6f64 656c 2e6e 616d 6564 5f73 7465   model.named_ste
-000470b0: 7073 5b27 6d6f 6465 6c27 5d0a 2020 2020  ps['model'].    
-000470c0: 2020 2020 2020 2020 2020 2020 656c 7365              else
-000470d0: 3a0a 2020 2020 2020 2020 2020 2020 2020  :.              
-000470e0: 2020 2020 2020 6966 2073 656c 662e 6d75        if self.mu
-000470f0: 6c74 695f 6c61 6265 6c3a 0a20 2020 2020  lti_label:.     
-00047100: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00047110: 2020 2023 6d6f 6465 6c5f 6f62 6a65 6374     #model_object
-00047120: 203d 206d 6f64 656c 2e62 6173 655f 6573   = model.base_es
-00047130: 7469 6d61 746f 720a 2020 2020 2020 2020  timator.        
-00047140: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00047150: 7072 696e 7428 274e 6f20 6665 6174 7572  print('No featur
-00047160: 6520 696d 706f 7274 616e 6365 7320 6176  e importances av
-00047170: 6169 6c61 626c 6520 666f 7220 6d75 6c74  ailable for mult
-00047180: 695f 6c61 6265 6c20 7461 7267 6574 732e  i_label targets.
-00047190: 2052 6574 7572 6e69 6e67 2e2e 2e27 290a   Returning...').
-000471a0: 2020 2020 2020 2020 2020 2020 2020 2020                  
-000471b0: 2020 2020 2020 2020 7265 7475 726e 0a20          return. 
-000471c0: 2020 2020 2020 2020 2020 2020 2020 2020                  
-000471d0: 2020 2065 6c73 653a 0a20 2020 2020 2020     else:.       
-000471e0: 2020 2020 2020 2020 2020 2020 2020 2020                  
-000471f0: 206d 6f64 656c 5f6f 626a 6563 7420 3d20   model_object = 
-00047200: 6d6f 6465 6c0a 2020 2020 2020 2020 2020  model.          
-00047210: 2020 2020 2020 6665 6174 7572 655f 696d        feature_im
-00047220: 706f 7274 616e 6365 7320 3d20 6d6f 6465  portances = mode
-00047230: 6c5f 6f62 6a65 6374 2e62 6f6f 7374 6572  l_object.booster
-00047240: 5f2e 6665 6174 7572 655f 696d 706f 7274  _.feature_import
-00047250: 616e 6365 2869 6d70 6f72 7461 6e63 655f  ance(importance_
-00047260: 7479 7065 3d27 6761 696e 2729 0a20 2020  type='gain').   
-00047270: 2020 2020 2020 2020 2020 2020 2069 6620               if 
-00047280: 6920 3d3d 2030 3a0a 2020 2020 2020 2020  i == 0:.        
-00047290: 2020 2020 2020 2020 2020 2020 6665 6174              feat
-000472a0: 7572 655f 696d 7020 3d20 7064 2e44 6174  ure_imp = pd.Dat
-000472b0: 6146 7261 6d65 287b 2756 616c 7565 273a  aFrame({'Value':
-000472c0: 6665 6174 7572 655f 696d 706f 7274 616e  feature_importan
-000472d0: 6365 732c 2746 6561 7475 7265 273a 6665  ces,'Feature':fe
-000472e0: 6174 7572 655f 6e61 6d65 737d 290a 2020  ature_names}).  
-000472f0: 2020 2020 2020 2020 2020 2020 2020 656c                el
-00047300: 7365 3a0a 2020 2020 2020 2020 2020 2020  se:.            
-00047310: 2020 2020 2020 2020 6665 6174 7572 655f          feature_
-00047320: 696d 7020 3d20 7064 2e63 6f6e 6361 7428  imp = pd.concat(
-00047330: 5b66 6561 7475 7265 5f69 6d70 2c20 0a20  [feature_imp, . 
-00047340: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00047350: 2020 2020 2020 2070 642e 4461 7461 4672         pd.DataFr
-00047360: 616d 6528 7b27 5661 6c75 6527 3a66 6561  ame({'Value':fea
-00047370: 7475 7265 5f69 6d70 6f72 7461 6e63 6573  ture_importances
-00047380: 2c27 4665 6174 7572 6527 3a66 6561 7475  ,'Feature':featu
-00047390: 7265 5f6e 616d 6573 7d29 5d2c 2061 7869  re_names})], axi
-000473a0: 733d 3029 0a20 2020 2020 2020 2020 2020  s=0).           
-000473b0: 2020 2020 2023 6c67 626d 2e70 6c6f 745f       #lgbm.plot_
-000473c0: 696d 706f 7274 616e 6365 286d 6f64 656c  importance(model
-000473d0: 5f6f 626a 6563 742c 2069 6d70 6f72 7461  _object, importa
-000473e0: 6e63 655f 7479 7065 3d27 6761 696e 272c  nce_type='gain',
-000473f0: 206d 6178 5f6e 756d 5f66 6561 7475 7265   max_num_feature
-00047400: 733d 6d61 785f 6665 6174 7572 6573 290a  s=max_features).
-00047410: 2020 2020 2020 2020 2020 2020 6665 6174              feat
-00047420: 7572 655f 696d 7020 3d20 6665 6174 7572  ure_imp = featur
-00047430: 655f 696d 702e 6772 6f75 7062 7928 2746  e_imp.groupby('F
-00047440: 6561 7475 7265 2729 2e6d 6561 6e28 292e  eature').mean().
-00047450: 736f 7274 5f76 616c 7565 7328 2756 616c  sort_values('Val
-00047460: 7565 272c 6173 6365 6e64 696e 673d 4661  ue',ascending=Fa
-00047470: 6c73 6529 2e72 6573 6574 5f69 6e64 6578  lse).reset_index
-00047480: 2829 0a20 2020 2020 2020 2020 2020 2066  ().            f
-00047490: 6561 7475 7265 5f69 6d70 2e73 6574 5f69  eature_imp.set_i
-000474a0: 6e64 6578 2827 4665 6174 7572 6527 295b  ndex('Feature')[
-000474b0: 3a6d 6178 5f66 6561 7475 7265 735d 2e70  :max_features].p
-000474c0: 6c6f 7428 6b69 6e64 3d27 6261 7268 272c  lot(kind='barh',
-000474d0: 2074 6974 6c65 3d27 546f 7020 3130 2046   title='Top 10 F
-000474e0: 6561 7475 7265 7327 290a 2020 2020 2020  eatures').      
-000474f0: 2020 2020 2020 2323 2320 5468 6973 2069        ### This i
-00047500: 7320 666f 7220 5847 4220 2323 230a 2020  s for XGB ###.  
-00047510: 2020 2020 2020 2020 2020 2370 6c6f 745f            #plot_
-00047520: 696d 706f 7274 616e 6365 2873 656c 662e  importance(self.
-00047530: 6d6f 6465 6c2e 6e61 6d65 645f 7374 6570  model.named_step
-00047540: 735b 276d 6f64 656c 275d 2c20 696d 706f  s['model'], impo
-00047550: 7274 616e 6365 5f74 7970 653d 2767 6169  rtance_type='gai
-00047560: 6e27 2c20 6d61 785f 6e75 6d5f 6665 6174  n', max_num_feat
-00047570: 7572 6573 3d6d 6178 5f66 6561 7475 7265  ures=max_feature
-00047580: 7329 0a20 2020 2020 2020 2065 6c69 6620  s).        elif 
-00047590: 6d6f 6465 6c5f 6e61 6d65 203d 3d20 276c  model_name == 'l
-000475a0: 7027 3a0a 2020 2020 2020 2020 2020 2020  p':.            
-000475b0: 7072 696e 7428 274e 6f20 6665 6174 7572  print('No featur
-000475c0: 6520 696d 706f 7274 616e 6365 7320 6176  e importances av
-000475d0: 6169 6c61 626c 6520 666f 7220 4c61 6265  ailable for Labe
-000475e0: 6c50 726f 7061 6761 7469 6f6e 2061 6c67  lPropagation alg
-000475f0: 6f72 6974 686d 2e20 5265 7475 726e 696e  orithm. Returnin
-00047600: 672e 2e2e 2729 0a20 2020 2020 2020 2020  g...').         
-00047610: 2020 2072 6574 7572 6e0a 2020 2020 2020     return.      
-00047620: 2020 656c 6966 206d 6f64 656c 5f6e 616d    elif model_nam
-00047630: 6520 3d3d 2027 7266 273a 0a20 2020 2020  e == 'rf':.     
-00047640: 2020 2020 2020 2023 2323 2054 6865 7365         ### These
-00047650: 2061 7265 2066 6f72 2052 616e 646f 6d46   are for RandomF
-00047660: 6f72 6573 7443 6c61 7373 6966 6965 7220  orestClassifier 
-00047670: 6b69 6e64 206f 6620 7363 696b 6974 2d6c  kind of scikit-l
-00047680: 6561 726e 206d 6f64 656c 7320 2323 230a  earn models ###.
-00047690: 2020 2020 2020 2020 2020 2020 7472 793a              try:
-000476a0: 0a20 2020 2020 2020 2020 2020 2020 2020  .               
-000476b0: 2066 6f72 2069 2c20 6d6f 6465 6c20 696e   for i, model in
-000476c0: 2065 6e75 6d65 7261 7465 2873 656c 662e   enumerate(self.
-000476d0: 6d6f 6465 6c73 293a 0a20 2020 2020 2020  models):.       
-000476e0: 2020 2020 2020 2020 2020 2020 2069 6620               if 
-000476f0: 7365 6c66 2e70 6970 656c 696e 653a 0a20  self.pipeline:. 
-00047700: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00047710: 2020 2020 2020 2069 6620 7365 6c66 2e6d         if self.m
-00047720: 756c 7469 5f6c 6162 656c 3a0a 2020 2020  ulti_label:.    
-00047730: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00047740: 2020 2020 2020 2020 236d 6f64 656c 5f6f          #model_o
-00047750: 626a 6563 7420 3d20 6d6f 6465 6c2e 6e61  bject = model.na
-00047760: 6d65 645f 7374 6570 735b 276d 6f64 656c  med_steps['model
-00047770: 275d 2e62 6173 655f 6573 7469 6d61 746f  '].base_estimato
-00047780: 720a 2020 2020 2020 2020 2020 2020 2020  r.              
-00047790: 2020 2020 2020 2020 2020 2020 2020 7072                pr
-000477a0: 696e 7428 274e 6f20 6665 6174 7572 6520  int('No feature 
-000477b0: 696d 706f 7274 616e 6365 7320 6176 6169  importances avai
-000477c0: 6c61 626c 6520 666f 7220 6d75 6c74 695f  lable for multi_
-000477d0: 6c61 6265 6c20 7461 7267 6574 732e 2052  label targets. R
-000477e0: 6574 7572 6e69 6e67 2e2e 2e27 290a 2020  eturning...').  
-000477f0: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00047800: 2020 2020 2020 2020 2020 7265 7475 726e            return
-00047810: 0a20 2020 2020 2020 2020 2020 2020 2020  .               
-00047820: 2020 2020 2020 2020 2065 6c73 653a 0a20           else:. 
-00047830: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00047840: 2020 2020 2020 2020 2020 206d 6f64 656c             model
-00047850: 5f6f 626a 6563 7420 3d20 6d6f 6465 6c2e  _object = model.
-00047860: 6e61 6d65 645f 7374 6570 735b 276d 6f64  named_steps['mod
-00047870: 656c 275d 0a20 2020 2020 2020 2020 2020  el'].           
-00047880: 2020 2020 2020 2020 2065 6c73 653a 0a20           else:. 
-00047890: 2020 2020 2020 2020 2020 2020 2020 2020                  
-000478a0: 2020 2020 2020 2069 6620 7365 6c66 2e6d         if self.m
-000478b0: 756c 7469 5f6c 6162 656c 3a0a 2020 2020  ulti_label:.    
-000478c0: 2020 2020 2020 2020 2020 2020 2020 2020                  
-000478d0: 2020 2020 2020 2020 236d 6f64 656c 5f6f          #model_o
-000478e0: 626a 6563 7420 3d20 6d6f 6465 6c2e 6261  bject = model.ba
-000478f0: 7365 5f65 7374 696d 6174 6f72 0a20 2020  se_estimator.   
-00047900: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00047910: 2020 2020 2020 2020 2070 7269 6e74 2827           print('
-00047920: 4e6f 2066 6561 7475 7265 2069 6d70 6f72  No feature impor
-00047930: 7461 6e63 6573 2061 7661 696c 6162 6c65  tances available
-00047940: 2066 6f72 206d 756c 7469 5f6c 6162 656c   for multi_label
-00047950: 2074 6172 6765 7473 2e20 5265 7475 726e   targets. Return
-00047960: 696e 672e 2e2e 2729 0a20 2020 2020 2020  ing...').       
-00047970: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00047980: 2020 2020 2072 6574 7572 6e0a 2020 2020       return.    
-00047990: 2020 2020 2020 2020 2020 2020 2020 2020                  
-000479a0: 2020 2020 656c 7365 3a0a 2020 2020 2020      else:.      
-000479b0: 2020 2020 2020 2020 2020 2020 2020 2020                  
-000479c0: 2020 2020 2020 6d6f 6465 6c5f 6f62 6a65        model_obje
-000479d0: 6374 203d 206d 6f64 656c 0a20 2020 2020  ct = model.     
-000479e0: 2020 2020 2020 2020 2020 2020 2020 2066                 f
-000479f0: 6561 7475 7265 5f69 6d70 6f72 7461 6e63  eature_importanc
-00047a00: 6573 203d 206d 6f64 656c 5f6f 626a 6563  es = model_objec
-00047a10: 742e 6665 6174 7572 655f 696d 706f 7274  t.feature_import
-00047a20: 616e 6365 735f 0a20 2020 2020 2020 2020  ances_.         
-00047a30: 2020 2020 2020 2020 2020 2069 6620 6920             if i 
-00047a40: 3d3d 2030 3a0a 2020 2020 2020 2020 2020  == 0:.          
-00047a50: 2020 2020 2020 2020 2020 2020 2020 6665                fe
-00047a60: 6174 7572 655f 696d 7020 3d20 7064 2e44  ature_imp = pd.D
-00047a70: 6174 6146 7261 6d65 287b 2756 616c 7565  ataFrame({'Value
-00047a80: 273a 6665 6174 7572 655f 696d 706f 7274  ':feature_import
-00047a90: 616e 6365 732c 2746 6561 7475 7265 273a  ances,'Feature':
-00047aa0: 6665 6174 7572 655f 6e61 6d65 737d 290a  feature_names}).
-00047ab0: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00047ac0: 2020 2020 656c 7365 3a0a 2020 2020 2020      else:.      
-00047ad0: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00047ae0: 2020 6665 6174 7572 655f 696d 7020 3d20    feature_imp = 
-00047af0: 7064 2e63 6f6e 6361 7428 5b66 6561 7475  pd.concat([featu
-00047b00: 7265 5f69 6d70 2c20 0a20 2020 2020 2020  re_imp, .       
-00047b10: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00047b20: 2020 2020 2070 642e 4461 7461 4672 616d       pd.DataFram
-00047b30: 6528 7b27 5661 6c75 6527 3a66 6561 7475  e({'Value':featu
-00047b40: 7265 5f69 6d70 6f72 7461 6e63 6573 2c27  re_importances,'
-00047b50: 4665 6174 7572 6527 3a66 6561 7475 7265  Feature':feature
-00047b60: 5f6e 616d 6573 7d29 5d2c 2061 7869 733d  _names})], axis=
-00047b70: 3029 0a20 2020 2020 2020 2020 2020 2020  0).             
-00047b80: 2020 2066 6561 7475 7265 5f69 6d70 203d     feature_imp =
-00047b90: 2066 6561 7475 7265 5f69 6d70 2e67 726f   feature_imp.gro
-00047ba0: 7570 6279 2827 4665 6174 7572 6527 292e  upby('Feature').
-00047bb0: 6d65 616e 2829 2e73 6f72 745f 7661 6c75  mean().sort_valu
-00047bc0: 6573 2827 5661 6c75 6527 2c61 7363 656e  es('Value',ascen
-00047bd0: 6469 6e67 3d46 616c 7365 292e 7265 7365  ding=False).rese
-00047be0: 745f 696e 6465 7828 290a 2020 2020 2020  t_index().      
-00047bf0: 2020 2020 2020 2020 2020 6665 6174 7572            featur
-00047c00: 655f 696d 702e 7365 745f 696e 6465 7828  e_imp.set_index(
-00047c10: 2746 6561 7475 7265 2729 5b3a 6d61 785f  'Feature')[:max_
-00047c20: 6665 6174 7572 6573 5d2e 706c 6f74 286b  features].plot(k
-00047c30: 696e 643d 2762 6172 6827 2c20 7469 746c  ind='barh', titl
-00047c40: 653d 2754 6f70 2031 3020 4665 6174 7572  e='Top 10 Featur
-00047c50: 6573 2729 0a20 2020 2020 2020 2020 2020  es').           
-00047c60: 2065 7863 6570 743a 0a20 2020 2020 2020   except:.       
-00047c70: 2020 2020 2020 2020 2020 2020 2070 7269               pri
-00047c80: 6e74 2827 436f 756c 6420 6e6f 7420 706c  nt('Could not pl
-00047c90: 6f74 2066 6561 7475 7265 2069 6d70 6f72  ot feature impor
-00047ca0: 7461 6e63 6573 2e20 506c 6561 7365 2063  tances. Please c
-00047cb0: 6865 636b 2079 6f75 7220 6d6f 6465 6c20  heck your model 
-00047cc0: 616e 6420 7472 7920 6167 6169 6e2e 2729  and try again.')
-00047cd0: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00047ce0: 0a20 2020 2020 2020 2065 6c73 653a 0a20  .        else:. 
-00047cf0: 2020 2020 2020 2020 2020 2070 7269 6e74             print
-00047d00: 2827 4e6f 2066 6561 7475 7265 2069 6d70  ('No feature imp
-00047d10: 6f72 7461 6e63 6573 2061 7661 696c 6162  ortances availab
-00047d20: 6c65 2066 6f72 2074 6869 7320 616c 676f  le for this algo
-00047d30: 7269 7468 6d2e 2052 6574 7572 6e69 6e67  rithm. Returning
-00047d40: 2e2e 2e27 290a 2020 2020 2020 2020 2020  ...').          
-00047d50: 2020 7265 7475 726e 0a23 2323 2323 2323    return.#######
-00047d60: 2323 2323 2323 2323 2323 2323 2323 2323  ################
-00047d70: 2323 2323 2323 2323 2323 2323 2323 2323  ################
-00047d80: 2323 2323 2323 2323 2323 2323 2323 2323  ################
-00047d90: 2323 2323 2323 2323 2323 2323 2323 2323  ################
-00047da0: 2323 2323 2323 2323 2323 2323 2323 2323  ################
-00047db0: 2323 230a 6672 6f6d 2073 6b6c 6561 726e  ###.from sklearn
-00047dc0: 2e6d 6574 7269 6373 2069 6d70 6f72 7420  .metrics import 
-00047dd0: 6d65 616e 5f61 6273 6f6c 7574 655f 6572  mean_absolute_er
-00047de0: 726f 722c 206d 6561 6e5f 7371 7561 7265  ror, mean_square
-00047df0: 645f 6572 726f 722c 2072 325f 7363 6f72  d_error, r2_scor
-00047e00: 650a 6672 6f6d 2069 7465 7274 6f6f 6c73  e.from itertools
-00047e10: 2069 6d70 6f72 7420 6379 636c 650a 6465   import cycle.de
-00047e20: 6620 7072 696e 745f 7265 6772 6573 7369  f print_regressi
-00047e30: 6f6e 5f6d 6f64 656c 5f73 7461 7473 2861  on_model_stats(a
-00047e40: 6374 7561 6c73 2c20 7072 6564 6963 7465  ctuals, predicte
-00047e50: 642c 2076 6572 626f 7365 3d30 293a 0a20  d, verbose=0):. 
-00047e60: 2020 2022 2222 0a20 2020 2054 6869 7320     """.    This 
-00047e70: 7072 6f67 7261 6d20 7072 696e 7473 2061  program prints a
-00047e80: 6e64 2072 6574 7572 6e73 204d 4145 2c20  nd returns MAE, 
-00047e90: 524d 5345 2c20 4d41 5045 2e0a 2020 2020  RMSE, MAPE..    
-00047ea0: 4966 2079 6f75 206c 696b 6520 7468 6520  If you like the 
-00047eb0: 4d41 4520 616e 6420 524d 5345 2074 6f20  MAE and RMSE to 
-00047ec0: 6861 7665 2061 2074 6974 6c65 206f 7220  have a title or 
-00047ed0: 736f 6d65 7468 696e 672c 206a 7573 7420  something, just 
-00047ee0: 6769 7665 2074 6861 740a 2020 2020 696e  give that.    in
-00047ef0: 2074 6865 2069 6e70 7574 2061 7320 2274   the input as "t
-00047f00: 6974 6c65 2220 616e 6420 6974 2077 696c  itle" and it wil
-00047f10: 6c20 7072 696e 7420 7468 6174 2074 6974  l print that tit
-00047f20: 6c65 206f 6e20 7468 6520 4d41 4520 616e  le on the MAE an
-00047f30: 6420 524d 5345 2061 7320 610a 2020 2020  d RMSE as a.    
-00047f40: 6368 6172 7420 666f 7220 7468 6174 206d  chart for that m
-00047f50: 6f64 656c 2e20 5265 7475 726e 7320 4d41  odel. Returns MA
-00047f60: 452c 204d 4145 5f61 735f 7065 7263 656e  E, MAE_as_percen
-00047f70: 7461 6765 2c20 616e 6420 524d 5345 5f61  tage, and RMSE_a
-00047f80: 735f 7065 7263 656e 7461 6765 0a20 2020  s_percentage.   
-00047f90: 2022 2222 0a20 2020 2069 6620 6973 696e   """.    if isin
-00047fa0: 7374 616e 6365 2861 6374 7561 6c73 2c70  stance(actuals,p
-00047fb0: 642e 5365 7269 6573 2920 6f72 2069 7369  d.Series) or isi
-00047fc0: 6e73 7461 6e63 6528 6163 7475 616c 732c  nstance(actuals,
-00047fd0: 7064 2e44 6174 6146 7261 6d65 293a 0a20  pd.DataFrame):. 
-00047fe0: 2020 2020 2020 2061 6374 7561 6c73 203d         actuals =
-00047ff0: 2061 6374 7561 6c73 2e76 616c 7565 730a   actuals.values.
-00048000: 2020 2020 6966 2069 7369 6e73 7461 6e63      if isinstanc
-00048010: 6528 7072 6564 6963 7465 642c 7064 2e53  e(predicted,pd.S
-00048020: 6572 6965 7329 206f 7220 6973 696e 7374  eries) or isinst
-00048030: 616e 6365 2870 7265 6469 6374 6564 2c70  ance(predicted,p
-00048040: 642e 4461 7461 4672 616d 6529 3a0a 2020  d.DataFrame):.  
-00048050: 2020 2020 2020 7072 6564 6963 7465 6420        predicted 
-00048060: 3d20 7072 6564 6963 7465 642e 7661 6c75  = predicted.valu
-00048070: 6573 0a20 2020 2069 6620 6c65 6e28 6163  es.    if len(ac
-00048080: 7475 616c 7329 2021 3d20 6c65 6e28 7072  tuals) != len(pr
-00048090: 6564 6963 7465 6429 3a0a 2020 2020 2020  edicted):.      
-000480a0: 2020 6966 2076 6572 626f 7365 3a0a 2020    if verbose:.  
-000480b0: 2020 2020 2020 2020 2020 7072 696e 7428            print(
-000480c0: 2745 7272 6f72 3a20 4e75 6d62 6572 206f  'Error: Number o
-000480d0: 6620 726f 7773 2069 6e20 6163 7475 616c  f rows in actual
-000480e0: 7320 616e 6420 7072 6564 6963 7465 6420  s and predicted 
-000480f0: 646f 6e74 206d 6174 6368 2e20 436f 6e74  dont match. Cont
-00048100: 696e 7569 6e67 2e2e 2e27 290a 2020 2020  inuing...').    
-00048110: 2020 2020 7265 7475 726e 206e 702e 696e      return np.in
-00048120: 660a 2020 2020 7472 793a 0a20 2020 2020  f.    try:.     
-00048130: 2020 2023 2323 2054 6869 7320 6973 2066     ### This is f
-00048140: 6f72 204d 756c 7469 5f4c 6162 656c 2050  or Multi_Label P
-00048150: 726f 626c 656d 7320 2323 230a 2020 2020  roblems ###.    
-00048160: 2020 2020 6173 7365 7274 2061 6374 7561      assert actua
-00048170: 6c73 2e73 6861 7065 5b31 5d0a 2020 2020  ls.shape[1].    
-00048180: 2020 2020 6d75 6c74 695f 6c61 6265 6c20      multi_label 
-00048190: 3d20 5472 7565 0a20 2020 2065 7863 6570  = True.    excep
-000481a0: 743a 0a20 2020 2020 2020 206d 756c 7469  t:.        multi
-000481b0: 5f6c 6162 656c 203d 2046 616c 7365 0a20  _label = False. 
-000481c0: 2020 2069 6620 6d75 6c74 695f 6c61 6265     if multi_labe
-000481d0: 6c3a 0a20 2020 2020 2020 2066 6f72 2069  l:.        for i
-000481e0: 2069 6e20 7261 6e67 6528 6163 7475 616c   in range(actual
-000481f0: 732e 7368 6170 655b 315d 293a 0a20 2020  s.shape[1]):.   
-00048200: 2020 2020 2020 2020 2061 6374 7561 6c73           actuals
-00048210: 5f78 203d 2061 6374 7561 6c73 5b3a 2c69  _x = actuals[:,i
-00048220: 5d0a 2020 2020 2020 2020 2020 2020 7472  ].            tr
-00048230: 793a 0a20 2020 2020 2020 2020 2020 2020  y:.             
-00048240: 2020 2070 7265 6469 6374 6564 5f78 203d     predicted_x =
-00048250: 2070 7265 6469 6374 6564 5b3a 2c69 5d0a   predicted[:,i].
-00048260: 2020 2020 2020 2020 2020 2020 6578 6365              exce
-00048270: 7074 3a0a 2020 2020 2020 2020 2020 2020  pt:.            
-00048280: 2020 2020 7072 6564 6963 7465 645f 7820      predicted_x 
-00048290: 3d20 7072 6564 6963 7465 645b 3a5d 0a20  = predicted[:]. 
-000482a0: 2020 2020 2020 2020 2020 2069 6620 7665             if ve
-000482b0: 7262 6f73 653a 0a20 2020 2020 2020 2020  rbose:.         
-000482c0: 2020 2020 2020 2070 7269 6e74 2827 666f         print('fo
-000482d0: 7220 7461 7267 6574 2025 733a 2720 2569  r target %s:' %i
-000482e0: 290a 2020 2020 2020 2020 2020 2020 6561  ).            ea
-000482f0: 6368 5f72 6d73 6520 3d20 7072 696e 745f  ch_rmse = print_
-00048300: 7265 6772 6573 7369 6f6e 5f6d 6574 7269  regression_metri
-00048310: 6373 2861 6374 7561 6c73 5f78 2c20 7072  cs(actuals_x, pr
-00048320: 6564 6963 7465 645f 782c 2076 6572 626f  edicted_x, verbo
-00048330: 7365 290a 2020 2020 2020 2020 6669 6e61  se).        fina
-00048340: 6c5f 726d 7365 203d 206e 702e 6d65 616e  l_rmse = np.mean
-00048350: 2865 6163 685f 726d 7365 290a 2020 2020  (each_rmse).    
-00048360: 656c 7365 3a0a 2020 2020 2020 2020 6669  else:.        fi
-00048370: 6e61 6c5f 726d 7365 203d 2070 7269 6e74  nal_rmse = print
-00048380: 5f72 6567 7265 7373 696f 6e5f 6d65 7472  _regression_metr
-00048390: 6963 7328 6163 7475 616c 732c 2070 7265  ics(actuals, pre
-000483a0: 6469 6374 6564 2c20 7665 7262 6f73 6529  dicted, verbose)
-000483b0: 0a20 2020 2072 6574 7572 6e20 6669 6e61  .    return fina
-000483c0: 6c5f 726d 7365 0a23 2323 2323 2323 2323  l_rmse.#########
-000483d0: 2323 2323 2323 2323 2323 2323 2323 2323  ################
-000483e0: 2323 2323 2323 2323 2323 2323 2323 2323  ################
-000483f0: 2323 2323 2323 2323 2323 2323 2323 2323  ################
-00048400: 2323 2323 2323 2323 2323 2323 2323 2323  ################
-00048410: 2323 2323 2323 230a 6672 6f6d 2073 6b6c  #######.from skl
-00048420: 6561 726e 2e6d 6574 7269 6373 2069 6d70  earn.metrics imp
-00048430: 6f72 7420 6d65 616e 5f73 7175 6172 6564  ort mean_squared
-00048440: 5f65 7272 6f72 2c20 6d65 616e 5f61 6273  _error, mean_abs
-00048450: 6f6c 7574 655f 6572 726f 722c 2072 325f  olute_error, r2_
-00048460: 7363 6f72 652c 206d 6561 6e5f 6162 736f  score, mean_abso
-00048470: 6c75 7465 5f70 6572 6365 6e74 6167 655f  lute_percentage_
-00048480: 6572 726f 720a 6465 6620 7072 696e 745f  error.def print_
-00048490: 7265 6772 6573 7369 6f6e 5f6d 6574 7269  regression_metri
-000484a0: 6373 2879 5f74 7275 652c 2079 5f70 7265  cs(y_true, y_pre
-000484b0: 6473 2c20 7665 7262 6f73 653d 3029 3a0a  ds, verbose=0):.
-000484c0: 2020 2020 6561 6368 5f72 6d73 6520 3d20      each_rmse = 
-000484d0: 6e70 2e73 7172 7428 6d65 616e 5f73 7175  np.sqrt(mean_squ
-000484e0: 6172 6564 5f65 7272 6f72 2879 5f74 7275  ared_error(y_tru
-000484f0: 652c 2079 5f70 7265 6473 2929 0a20 2020  e, y_preds)).   
-00048500: 2069 6620 7665 7262 6f73 653a 0a20 2020   if verbose:.   
-00048510: 2020 2020 2070 7269 6e74 2827 2020 2020       print('    
-00048520: 524d 5345 203d 2025 302e 3366 2720 2565  RMSE = %0.3f' %e
-00048530: 6163 685f 726d 7365 290a 2020 2020 2020  ach_rmse).      
-00048540: 2020 7072 696e 7428 2720 2020 204e 6f72    print('    Nor
-00048550: 6d20 524d 5345 203d 2025 302e 3066 2525  m RMSE = %0.0f%%
-00048560: 2720 2528 3130 302a 6e70 2e73 7172 7428  ' %(100*np.sqrt(
-00048570: 6d65 616e 5f73 7175 6172 6564 5f65 7272  mean_squared_err
-00048580: 6f72 2879 5f74 7275 652c 2079 5f70 7265  or(y_true, y_pre
-00048590: 6473 2929 2f6e 702e 7374 6428 795f 7472  ds))/np.std(y_tr
-000485a0: 7565 2929 290a 2020 2020 2020 2020 7072  ue))).        pr
-000485b0: 696e 7428 2720 2020 204d 4145 203d 2025  int('    MAE = %
-000485c0: 302e 3366 2720 2025 6d65 616e 5f61 6273  0.3f'  %mean_abs
-000485d0: 6f6c 7574 655f 6572 726f 7228 795f 7472  olute_error(y_tr
-000485e0: 7565 2c20 795f 7072 6564 7329 290a 2020  ue, y_preds)).  
-000485f0: 2020 6966 206c 656e 2879 5f74 7275 655b    if len(y_true[
-00048600: 2879 5f74 7275 653d 3d30 295d 2920 3e20  (y_true==0)]) > 
-00048610: 303a 0a20 2020 2020 2020 2069 6620 7665  0:.        if ve
-00048620: 7262 6f73 653a 0a20 2020 2020 2020 2020  rbose:.         
-00048630: 2020 2070 7269 6e74 2827 2020 2020 5741     print('    WA
-00048640: 5045 203d 2025 302e 3066 2525 2c20 4269  PE = %0.0f%%, Bi
-00048650: 6173 203d 2025 302e 3066 2525 2720 2528  as = %0.0f%%' %(
-00048660: 3130 302a 6e70 2e73 756d 286e 702e 6162  100*np.sum(np.ab
-00048670: 7328 795f 7472 7565 2d79 5f70 7265 6473  s(y_true-y_preds
-00048680: 2929 2f6e 702e 7375 6d28 795f 7472 7565  ))/np.sum(y_true
-00048690: 292c 200a 2020 2020 2020 2020 2020 2020  ), .            
-000486a0: 2020 2020 2020 2020 2020 2020 3130 302a              100*
-000486b0: 6e70 2e73 756d 2879 5f74 7275 652d 795f  np.sum(y_true-y_
-000486c0: 7072 6564 7329 2f6e 702e 7375 6d28 795f  preds)/np.sum(y_
-000486d0: 7472 7565 2929 290a 2020 2020 2020 2020  true))).        
-000486e0: 2020 2020 7072 696e 7428 2720 2020 204e      print('    N
-000486f0: 6f20 4d41 5045 2061 7661 696c 6162 6c65  o MAPE available
-00048700: 2073 696e 6365 207a 6572 6f65 7320 696e   since zeroes in
-00048710: 2061 6374 7561 6c73 2729 0a20 2020 2065   actuals').    e
-00048720: 6c73 653a 0a20 2020 2020 2020 2069 6620  lse:.        if 
-00048730: 7665 7262 6f73 653a 0a20 2020 2020 2020  verbose:.       
-00048740: 2020 2020 2070 7269 6e74 2827 2020 2020       print('    
-00048750: 5741 5045 203d 2025 302e 3066 2525 2c20  WAPE = %0.0f%%, 
-00048760: 4269 6173 203d 2025 302e 3066 2525 2720  Bias = %0.0f%%' 
-00048770: 2528 3130 302a 6e70 2e73 756d 286e 702e  %(100*np.sum(np.
-00048780: 6162 7328 795f 7472 7565 2d79 5f70 7265  abs(y_true-y_pre
-00048790: 6473 2929 2f6e 702e 7375 6d28 795f 7472  ds))/np.sum(y_tr
-000487a0: 7565 292c 200a 2020 2020 2020 2020 2020  ue), .          
-000487b0: 2020 2020 2020 2020 2020 2020 2020 3130                10
-000487c0: 302a 6e70 2e73 756d 2879 5f74 7275 652d  0*np.sum(y_true-
-000487d0: 795f 7072 6564 7329 2f6e 702e 7375 6d28  y_preds)/np.sum(
-000487e0: 795f 7472 7565 2929 290a 2020 2020 2020  y_true))).      
-000487f0: 2020 2020 2020 7072 696e 7428 2720 2020        print('   
-00048800: 204d 4150 4520 3d20 2530 2e30 6625 2527   MAPE = %0.0f%%'
-00048810: 2025 2831 3030 2a6d 6561 6e5f 6162 736f   %(100*mean_abso
-00048820: 6c75 7465 5f70 6572 6365 6e74 6167 655f  lute_percentage_
-00048830: 6572 726f 7228 795f 7472 7565 2c20 795f  error(y_true, y_
-00048840: 7072 6564 7329 2929 0a20 2020 2070 7269  preds))).    pri
-00048850: 6e74 2827 2020 2020 522d 5371 7561 7265  nt('    R-Square
-00048860: 6420 3d20 2530 2e30 6625 2527 2025 2831  d = %0.0f%%' %(1
-00048870: 3030 2a72 325f 7363 6f72 6528 795f 7472  00*r2_score(y_tr
-00048880: 7565 2c20 795f 7072 6564 7329 2929 0a20  ue, y_preds))). 
-00048890: 2020 2070 6c6f 745f 7265 6772 6573 7369     plot_regressi
-000488a0: 6f6e 2879 5f74 7275 652c 2079 5f70 7265  on(y_true, y_pre
-000488b0: 6473 2c20 6368 6172 743d 2773 6361 7474  ds, chart='scatt
-000488c0: 6572 2729 0a20 2020 2072 6574 7572 6e20  er').    return 
-000488d0: 6561 6368 5f72 6d73 650a 2323 2323 2323  each_rmse.######
-000488e0: 2323 2323 2323 2323 2323 2323 2323 2323  ################
-000488f0: 2323 2323 2323 2323 2323 2323 2323 2323  ################
-00048900: 2323 2323 2323 2323 2323 2323 2323 2323  ################
-00048910: 2323 2323 2323 2323 2323 2323 2323 2323  ################
-00048920: 2323 2323 2323 2323 2323 0a64 6566 2070  ##########.def p
-00048930: 7269 6e74 5f73 7461 7469 635f 726d 7365  rint_static_rmse
-00048940: 2861 6374 7561 6c2c 2070 7265 6469 6374  (actual, predict
-00048950: 6564 2c20 7374 6172 745f 6672 6f6d 3d30  ed, start_from=0
-00048960: 2c76 6572 626f 7365 3d30 293a 0a20 2020  ,verbose=0):.   
-00048970: 2022 2222 0a20 2020 2074 6869 7320 6361   """.    this ca
-00048980: 6c63 756c 6174 6573 2074 6865 2072 6174  lculates the rat
-00048990: 696f 206f 6620 7468 6520 726d 7365 2065  io of the rmse e
-000489a0: 7272 6f72 2074 6f20 7468 6520 7374 616e  rror to the stan
-000489b0: 6461 7264 2064 6576 6961 7469 6f6e 206f  dard deviation o
-000489c0: 6620 7468 6520 6163 7475 616c 732e 0a20  f the actuals.. 
-000489d0: 2020 2054 6869 7320 7261 7469 6f20 7368     This ratio sh
-000489e0: 6f75 6c64 2062 6520 6265 6c6f 7720 3120  ould be below 1 
-000489f0: 666f 7220 6120 6d6f 6465 6c20 746f 2062  for a model to b
-00048a00: 6520 636f 6e73 6964 6572 6564 2075 7365  e considered use
-00048a10: 6675 6c2e 0a20 2020 2054 6865 2063 6f6d  ful..    The com
-00048a20: 7061 7269 736f 6e20 7374 6172 7473 2066  parison starts f
-00048a30: 726f 6d20 7468 6520 726f 7720 696e 6469  rom the row indi
-00048a40: 6361 7465 6420 696e 2074 6865 2022 7374  cated in the "st
-00048a50: 6172 745f 6672 6f6d 2220 7661 7269 6162  art_from" variab
-00048a60: 6c65 2e0a 2020 2020 2222 220a 2020 2020  le..    """.    
-00048a70: 726d 7365 203d 206e 702e 7371 7274 286d  rmse = np.sqrt(m
-00048a80: 6561 6e5f 7371 7561 7265 645f 6572 726f  ean_squared_erro
-00048a90: 7228 6163 7475 616c 5b73 7461 7274 5f66  r(actual[start_f
-00048aa0: 726f 6d3a 5d2c 7072 6564 6963 7465 645b  rom:],predicted[
-00048ab0: 7374 6172 745f 6672 6f6d 3a5d 2929 0a20  start_from:])). 
-00048ac0: 2020 2073 7464 5f64 6576 203d 2061 6374     std_dev = act
-00048ad0: 7561 6c5b 7374 6172 745f 6672 6f6d 3a5d  ual[start_from:]
-00048ae0: 2e73 7464 2829 0a20 2020 2069 6620 7665  .std().    if ve
-00048af0: 7262 6f73 6520 3e3d 2031 3a0a 2020 2020  rbose >= 1:.    
-00048b00: 2020 2020 7072 696e 7428 2720 2020 2052      print('    R
-00048b10: 4d53 4520 3d20 2530 2e32 6627 2025 726d  MSE = %0.2f' %rm
-00048b20: 7365 290a 2020 2020 2020 2020 7072 696e  se).        prin
-00048b30: 7428 2720 2020 2053 7464 2044 6576 6961  t('    Std Devia
-00048b40: 7469 6f6e 206f 6620 4163 7475 616c 7320  tion of Actuals 
-00048b50: 3d20 2530 2e32 6627 2025 2873 7464 5f64  = %0.2f' %(std_d
-00048b60: 6576 2929 0a20 2020 2020 2020 2070 7269  ev)).        pri
-00048b70: 6e74 2827 2020 2020 4e6f 726d 616c 697a  nt('    Normaliz
-00048b80: 6564 2052 4d53 4520 3d20 2530 2e31 6625  ed RMSE = %0.1f%
-00048b90: 2527 2025 2872 6d73 652a 3130 302f 7374  %' %(rmse*100/st
-00048ba0: 645f 6465 7629 290a 2020 2020 7265 7475  d_dev)).    retu
-00048bb0: 726e 2072 6d73 652c 2072 6d73 652f 7374  rn rmse, rmse/st
-00048bc0: 645f 6465 760a 2323 2323 2323 2323 2323  d_dev.##########
-00048bd0: 2323 2323 2323 2323 2323 2323 2323 2323  ################
-00048be0: 2323 2323 2323 2323 2323 2323 2323 2323  ################
-00048bf0: 2323 2323 2323 2323 2323 2323 2323 2323  ################
-00048c00: 2323 2323 2323 2323 2323 2323 2323 2323  ################
-00048c10: 2323 2323 2323 0a66 726f 6d20 736b 6c65  ######.from skle
-00048c20: 6172 6e2e 6d65 7472 6963 7320 696d 706f  arn.metrics impo
-00048c30: 7274 206d 6561 6e5f 7371 7561 7265 645f  rt mean_squared_
-00048c40: 6572 726f 722c 6d65 616e 5f61 6273 6f6c  error,mean_absol
-00048c50: 7574 655f 6572 726f 720a 6465 6620 7072  ute_error.def pr
-00048c60: 696e 745f 726d 7365 2879 2c20 795f 6861  int_rmse(y, y_ha
-00048c70: 7429 3a0a 2020 2020 2222 220a 2020 2020  t):.    """.    
-00048c80: 4361 6c63 756c 6174 696e 6720 526f 6f74  Calculating Root
-00048c90: 204d 6561 6e20 5371 7561 7265 2045 7272   Mean Square Err
-00048ca0: 6f72 2068 7474 7073 3a2f 2f65 6e2e 7769  or https://en.wi
-00048cb0: 6b69 7065 6469 612e 6f72 672f 7769 6b69  kipedia.org/wiki
-00048cc0: 2f52 6f6f 742d 6d65 616e 2d73 7175 6172  /Root-mean-squar
-00048cd0: 655f 6465 7669 6174 696f 6e0a 2020 2020  e_deviation.    
-00048ce0: 2222 220a 2020 2020 6d73 6520 3d20 6e70  """.    mse = np
-00048cf0: 2e6d 6561 6e28 2879 202d 2079 5f68 6174  .mean((y - y_hat
-00048d00: 292a 2a32 290a 2020 2020 7265 7475 726e  )**2).    return
-00048d10: 206e 702e 7371 7274 286d 7365 290a 0a64   np.sqrt(mse)..d
-00048d20: 6566 2070 7269 6e74 5f6d 6170 6528 792c  ef print_mape(y,
-00048d30: 2079 5f68 6174 293a 0a20 2020 2022 2222   y_hat):.    """
-00048d40: 0a20 2020 2043 616c 6375 6c61 7469 6e67  .    Calculating
-00048d50: 204d 6561 6e20 4162 736f 6c75 7465 2050   Mean Absolute P
-00048d60: 6572 6365 6e74 2045 7272 6f72 2068 7474  ercent Error htt
-00048d70: 7073 3a2f 2f65 6e2e 7769 6b69 7065 6469  ps://en.wikipedi
-00048d80: 612e 6f72 672f 7769 6b69 2f4d 6561 6e5f  a.org/wiki/Mean_
-00048d90: 6162 736f 6c75 7465 5f70 6572 6365 6e74  absolute_percent
-00048da0: 6167 655f 6572 726f 720a 2020 2020 546f  age_error.    To
-00048db0: 2061 766f 6964 2069 6e66 696e 6974 7920   avoid infinity 
-00048dc0: 6475 6520 746f 2064 6976 6973 696f 6e20  due to division 
-00048dd0: 6279 207a 6572 6f2c 2077 6520 7365 6c65  by zero, we sele
-00048de0: 6374 206d 6178 2830 2e30 312c 2061 6273  ct max(0.01, abs
-00048df0: 2861 6374 7561 6c73 2929 2074 6f20 7368  (actuals)) to sh
-00048e00: 6f77 204d 4150 452e 0a20 2020 2022 2222  ow MAPE..    """
-00048e10: 0a20 2020 2023 2323 2057 6865 7265 7665  .    ### Whereve
-00048e20: 7220 7468 6572 6520 6973 207a 6572 6f2c  r there is zero,
-00048e30: 2072 6570 6c61 6365 2069 7420 7769 7468   replace it with
-00048e40: 2030 2e30 3031 2073 6f20 6974 2064 6f65   0.001 so it doe
-00048e50: 736e 2774 2072 6573 756c 7420 696e 2064  sn't result in d
-00048e60: 6976 6973 696f 6e20 6279 207a 6572 6f0a  ivision by zero.
-00048e70: 2020 2020 7065 7263 5f65 7272 203d 2028      perc_err = (
-00048e80: 3130 302a 286e 702e 7768 6572 6528 793d  100*(np.where(y=
-00048e90: 3d30 2c30 2e30 3031 2c79 2920 2d20 795f  =0,0.001,y) - y_
-00048ea0: 6861 7429 292f 6e70 2e77 6865 7265 2879  hat))/np.where(y
-00048eb0: 3d3d 302c 302e 3030 312c 7929 0a20 2020  ==0,0.001,y).   
-00048ec0: 2072 6574 7572 6e20 6e70 2e6d 6561 6e28   return np.mean(
-00048ed0: 6162 7328 7065 7263 5f65 7272 2929 0a20  abs(perc_err)). 
-00048ee0: 2020 200a 6672 6f6d 2073 6b6c 6561 726e     .from sklearn
-00048ef0: 2e6d 6574 7269 6373 2069 6d70 6f72 7420  .metrics import 
-00048f00: 6d65 616e 5f61 6273 6f6c 7574 655f 6572  mean_absolute_er
-00048f10: 726f 722c 206d 6561 6e5f 7371 7561 7265  ror, mean_square
-00048f20: 645f 6572 726f 720a 6672 6f6d 2069 7465  d_error.from ite
-00048f30: 7274 6f6f 6c73 2069 6d70 6f72 7420 6379  rtools import cy
-00048f40: 636c 650a 696d 706f 7274 206d 6174 706c  cle.import matpl
-00048f50: 6f74 6c69 622e 7079 706c 6f74 2061 7320  otlib.pyplot as 
-00048f60: 706c 740a 6465 6620 706c 6f74 5f72 6567  plt.def plot_reg
-00048f70: 7265 7373 696f 6e28 6163 7475 616c 732c  ression(actuals,
-00048f80: 2070 7265 6469 6374 6564 2c20 6368 6172   predicted, char
-00048f90: 743d 2773 6361 7474 6572 2729 3a0a 2020  t='scatter'):.  
-00048fa0: 2020 2222 220a 2020 2020 5468 6973 2066    """.    This f
-00048fb0: 756e 6374 696f 6e20 706c 6f74 7320 7468  unction plots th
-00048fc0: 6520 6163 7475 616c 7320 7673 2e20 7072  e actuals vs. pr
-00048fd0: 6564 6963 7465 6420 6173 2061 206c 696e  edicted as a lin
-00048fe0: 6520 706c 6f74 2e0a 2020 2020 596f 7520  e plot..    You 
-00048ff0: 6361 6e20 6368 616e 6765 2074 6865 2063  can change the c
-00049000: 6861 7274 2074 7970 6520 746f 2022 7363  hart type to "sc
-00049010: 6174 7465 7227 2074 6f20 6765 7420 6120  atter' to get a 
-00049020: 7363 6174 7465 7220 706c 6f74 2e0a 2020  scatter plot..  
-00049030: 2020 2222 220a 2020 2020 6669 6773 697a    """.    figsiz
-00049040: 6520 3d20 2831 302c 2031 3029 0a20 2020  e = (10, 10).   
-00049050: 2063 6f6c 6f72 7320 3d20 6379 636c 6528   colors = cycle(
-00049060: 2762 7972 636d 676b 6279 7263 6d67 6b62  'byrcmgkbyrcmgkb
-00049070: 7972 636d 676b 6279 7263 6d67 6b27 290a  yrcmgkbyrcmgk').
-00049080: 2020 2020 706c 742e 6669 6775 7265 2866      plt.figure(f
-00049090: 6967 7369 7a65 3d66 6967 7369 7a65 290a  igsize=figsize).
-000490a0: 2020 2020 6966 206e 6f74 2069 7369 6e73      if not isins
-000490b0: 7461 6e63 6528 6163 7475 616c 732c 206e  tance(actuals, n
-000490c0: 702e 6e64 6172 7261 7929 3a0a 2020 2020  p.ndarray):.    
-000490d0: 2020 2020 6163 7475 616c 7320 3d20 6163      actuals = ac
-000490e0: 7475 616c 732e 7661 6c75 6573 0a20 2020  tuals.values.   
-000490f0: 2064 6670 6c6f 7420 3d20 7064 2e44 6174   dfplot = pd.Dat
-00049100: 6146 7261 6d65 285b 6163 7475 616c 732c  aFrame([actuals,
-00049110: 7072 6564 6963 7465 645d 292e 540a 2020  predicted]).T.  
-00049120: 2020 6466 706c 6f74 2e63 6f6c 756d 6e73    dfplot.columns
-00049130: 203d 205b 2741 6374 7561 6c27 2c27 466f   = ['Actual','Fo
-00049140: 7265 6361 7374 275d 0a20 2020 2064 6670  recast'].    dfp
-00049150: 6c6f 7420 3d20 6466 706c 6f74 2e73 6f72  lot = dfplot.sor
-00049160: 745f 696e 6465 7828 290a 2020 2020 6c69  t_index().    li
-00049170: 6e65 5374 6172 7420 3d20 6163 7475 616c  neStart = actual
-00049180: 732e 6d69 6e28 290a 2020 2020 6c69 6e65  s.min().    line
-00049190: 456e 6420 3d20 6163 7475 616c 732e 6d61  End = actuals.ma
-000491a0: 7828 290a 2020 2020 6966 2063 6861 7274  x().    if chart
-000491b0: 203d 3d20 276c 696e 6527 3a0a 2020 2020   == 'line':.    
-000491c0: 2020 2020 706c 742e 706c 6f74 2864 6670      plt.plot(dfp
-000491d0: 6c6f 7429 0a20 2020 2065 6c73 653a 0a20  lot).    else:. 
-000491e0: 2020 2020 2020 2070 6c74 2e73 6361 7474         plt.scatt
-000491f0: 6572 2861 6374 7561 6c73 2c20 7072 6564  er(actuals, pred
-00049200: 6963 7465 642c 2063 6f6c 6f72 203d 206e  icted, color = n
-00049210: 6578 7428 636f 6c6f 7273 292c 2061 6c70  ext(colors), alp
-00049220: 6861 3d30 2e35 2c6c 6162 656c 3d27 5072  ha=0.5,label='Pr
-00049230: 6564 6963 7469 6f6e 7327 290a 2020 2020  edictions').    
-00049240: 2020 2020 706c 742e 706c 6f74 285b 6c69      plt.plot([li
-00049250: 6e65 5374 6172 742c 206c 696e 6545 6e64  neStart, lineEnd
-00049260: 5d2c 205b 6c69 6e65 5374 6172 742c 206c  ], [lineStart, l
-00049270: 696e 6545 6e64 5d2c 2027 6b2d 272c 2063  ineEnd], 'k-', c
-00049280: 6f6c 6f72 203d 206e 6578 7428 636f 6c6f  olor = next(colo
-00049290: 7273 2929 0a20 2020 2020 2020 2070 6c74  rs)).        plt
-000492a0: 2e78 6c69 6d28 6c69 6e65 5374 6172 742c  .xlim(lineStart,
-000492b0: 206c 696e 6545 6e64 290a 2020 2020 2020   lineEnd).      
-000492c0: 2020 706c 742e 796c 696d 286c 696e 6553    plt.ylim(lineS
-000492d0: 7461 7274 2c20 6c69 6e65 456e 6429 0a20  tart, lineEnd). 
-000492e0: 2020 2070 6c74 2e78 6c61 6265 6c28 2741     plt.xlabel('A
-000492f0: 6374 7561 6c27 290a 2020 2020 706c 742e  ctual').    plt.
-00049300: 796c 6162 656c 2827 5072 6564 6963 7465  ylabel('Predicte
-00049310: 6427 290a 2020 2020 706c 742e 6c65 6765  d').    plt.lege
-00049320: 6e64 2829 0a20 2020 2070 6c74 2e74 6974  nd().    plt.tit
-00049330: 6c65 2827 4d6f 6465 6c3a 2050 7265 6469  le('Model: Predi
-00049340: 6374 6564 2076 7320 4163 7475 616c 7327  cted vs Actuals'
-00049350: 2c20 666f 6e74 7369 7a65 3d31 3229 0a20  , fontsize=12). 
-00049360: 2020 2070 6c74 2e73 686f 7728 293b 0a23     plt.show();.#
-00049370: 2323 2323 2323 2323 2323 2323 2323 2323  ################
-00049380: 2323 2323 2323 2323 2323 2323 2323 2323  ################
-00049390: 2323 2323 2323 2323 2323 2323 2323 2323  ################
-000493a0: 2323 2323 2323 2323 2323 2323 2323 2323  ################
-000493b0: 2323 2323 2323 2323 2323 2323 2323 2323  ################
-000493c0: 2323 2323 2323 2323 2323 230a 6672 6f6d  ###########.from
-000493d0: 2073 6b6c 6561 726e 2e6d 6f64 656c 5f73   sklearn.model_s
-000493e0: 656c 6563 7469 6f6e 2069 6d70 6f72 7420  election import 
-000493f0: 5469 6d65 5365 7269 6573 5370 6c69 740a  TimeSeriesSplit.
-00049400: 6672 6f6d 2073 6b6c 6561 726e 2e75 7469  from sklearn.uti
-00049410: 6c73 2069 6d70 6f72 7420 696e 6465 7861  ls import indexa
-00049420: 626c 650a 6672 6f6d 2073 6b6c 6561 726e  ble.from sklearn
-00049430: 2e75 7469 6c73 2e76 616c 6964 6174 696f  .utils.validatio
-00049440: 6e20 696d 706f 7274 205f 6e75 6d5f 7361  n import _num_sa
-00049450: 6d70 6c65 730a 636c 6173 7320 536c 6964  mples.class Slid
-00049460: 696e 6754 696d 6553 6572 6965 7353 706c  ingTimeSeriesSpl
-00049470: 6974 2854 696d 6553 6572 6965 7353 706c  it(TimeSeriesSpl
-00049480: 6974 293a 0a20 2020 2022 2222 0a20 2020  it):.    """.   
-00049490: 2054 6865 2053 6c69 6469 6e67 5469 6d65   The SlidingTime
-000494a0: 5365 7269 6573 5370 6c69 7420 6973 2062  SeriesSplit is b
-000494b0: 6173 6564 206f 6e20 7468 6520 666f 6c6c  ased on the foll
-000494c0: 6f77 696e 6720 7265 7370 6f6e 7365 2066  owing response f
-000494d0: 726f 6d20 5374 6163 6b6f 7665 7266 6c6f  rom Stackoverflo
-000494e0: 773a 0a20 2020 2068 7474 7073 3a2f 2f73  w:.    https://s
-000494f0: 7461 636b 6f76 6572 666c 6f77 2e63 6f6d  tackoverflow.com
-00049500: 2f71 7565 7374 696f 6e73 2f35 3832 3935  /questions/58295
-00049510: 3234 322f 736c 6964 696e 672d 7769 6e64  242/sliding-wind
-00049520: 6f77 2d74 7261 696e 2d74 6573 742d 7370  ow-train-test-sp
-00049530: 6c69 742d 666f 722d 7469 6d65 2d73 6572  lit-for-time-ser
-00049540: 6965 732d 6461 7461 0a20 2020 204d 616e  ies-data.    Man
-00049550: 7920 7468 616e 6b73 2074 6f20 7468 6520  y thanks to the 
-00049560: 706f 7374 6572 2061 6e64 2061 7574 686f  poster and autho
-00049570: 7220 6f66 2074 6869 7320 636f 6465 2073  r of this code s
-00049580: 6e69 7070 6574 2e20 0a20 2020 2049 2068  nippet. .    I h
-00049590: 6176 6520 6d6f 6469 6669 6564 2069 7420  ave modified it 
-000495a0: 736c 6967 6874 6c79 2074 6f20 7375 6974  slightly to suit
-000495b0: 206d 7920 6e65 6564 732e 0a20 2020 2022   my needs..    "
-000495c0: 2222 0a0a 2020 2020 6465 6620 5f5f 696e  ""..    def __in
-000495d0: 6974 5f5f 2873 656c 662c 206e 5f73 706c  it__(self, n_spl
-000495e0: 6974 733d 352c 2067 726f 7570 733d 4e6f  its=5, groups=No
-000495f0: 6e65 2c20 6669 7865 645f 6c65 6e67 7468  ne, fixed_length
-00049600: 3d4e 6f6e 652c 2074 7261 696e 5f73 706c  =None, train_spl
-00049610: 6974 733d 322c 2074 6573 745f 7370 6c69  its=2, test_spli
-00049620: 7473 3d31 293a 0a20 2020 2020 2020 2073  ts=1):.        s
-00049630: 656c 662e 6e5f 7370 6c69 7473 203d 206e  elf.n_splits = n
-00049640: 5f73 706c 6974 730a 2020 2020 2020 2020  _splits.        
-00049650: 7365 6c66 2e67 726f 7570 7320 3d20 6772  self.groups = gr
-00049660: 6f75 7073 0a20 2020 2020 2020 2073 656c  oups.        sel
-00049670: 662e 6669 7865 645f 6c65 6e67 7468 203d  f.fixed_length =
-00049680: 2066 6978 6564 5f6c 656e 6774 680a 2020   fixed_length.  
-00049690: 2020 2020 2020 7365 6c66 2e74 7261 696e        self.train
-000496a0: 5f73 706c 6974 7320 3d20 7472 6169 6e5f  _splits = train_
-000496b0: 7370 6c69 7473 0a20 2020 2020 2020 2073  splits.        s
-000496c0: 656c 662e 7465 7374 5f73 706c 6974 7320  elf.test_splits 
-000496d0: 3d20 7465 7374 5f73 706c 6974 730a 0a20  = test_splits.. 
-000496e0: 2020 2064 6566 2073 706c 6974 2873 656c     def split(sel
-000496f0: 662c 2058 2c20 793d 4e6f 6e65 293a 0a20  f, X, y=None):. 
-00049700: 2020 2020 2020 2067 726f 7570 7320 3d20         groups = 
-00049710: 7365 6c66 2e67 726f 7570 730a 2020 2020  self.groups.    
-00049720: 2020 2020 6669 7865 645f 6c65 6e67 7468      fixed_length
-00049730: 203d 2073 656c 662e 6669 7865 645f 6c65   = self.fixed_le
-00049740: 6e67 7468 0a20 2020 2020 2020 2074 7261  ngth.        tra
-00049750: 696e 5f73 706c 6974 7320 3d20 7365 6c66  in_splits = self
-00049760: 2e74 7261 696e 5f73 706c 6974 730a 2020  .train_splits.  
-00049770: 2020 2020 2020 7465 7374 5f73 706c 6974        test_split
-00049780: 7320 3d20 7365 6c66 2e74 6573 745f 7370  s = self.test_sp
-00049790: 6c69 7473 0a20 2020 2020 2020 206e 5f73  lits.        n_s
-000497a0: 706c 6974 7320 3d20 7365 6c66 2e6e 5f73  plits = self.n_s
-000497b0: 706c 6974 730a 2020 2020 2020 2020 2323  plits.        ##
-000497c0: 2323 2323 2323 2323 2323 2323 2323 2323  ################
-000497d0: 2323 2323 2323 2323 2323 2323 2323 2323  ################
-000497e0: 230a 2020 2020 2020 2020 582c 2079 2c20  #.        X, y, 
-000497f0: 6772 6f75 7073 203d 2069 6e64 6578 6162  groups = indexab
-00049800: 6c65 2858 2c20 792c 2067 726f 7570 7329  le(X, y, groups)
-00049810: 0a20 2020 2020 2020 206e 5f73 616d 706c  .        n_sampl
-00049820: 6573 203d 205f 6e75 6d5f 7361 6d70 6c65  es = _num_sample
-00049830: 7328 5829 0a20 2020 2020 2020 206e 5f73  s(X).        n_s
-00049840: 706c 6974 7320 3d20 7365 6c66 2e6e 5f73  plits = self.n_s
-00049850: 706c 6974 730a 2020 2020 2020 2020 6e5f  plits.        n_
-00049860: 666f 6c64 7320 3d20 6e5f 7370 6c69 7473  folds = n_splits
-00049870: 202b 2031 0a20 2020 2020 2020 2074 7261   + 1.        tra
-00049880: 696e 5f73 706c 6974 732c 2074 6573 745f  in_splits, test_
-00049890: 7370 6c69 7473 203d 2069 6e74 2874 7261  splits = int(tra
-000498a0: 696e 5f73 706c 6974 7329 2c20 696e 7428  in_splits), int(
-000498b0: 7465 7374 5f73 706c 6974 7329 0a20 2020  test_splits).   
-000498c0: 2020 2020 2069 6620 6e5f 666f 6c64 7320       if n_folds 
-000498d0: 3e20 6e5f 7361 6d70 6c65 733a 0a20 2020  > n_samples:.   
-000498e0: 2020 2020 2020 2020 2072 6169 7365 2056           raise V
-000498f0: 616c 7565 4572 726f 7228 0a20 2020 2020  alueError(.     
-00049900: 2020 2020 2020 2020 2020 2028 2243 616e             ("Can
-00049910: 6e6f 7420 6861 7665 206e 756d 6265 7220  not have number 
-00049920: 6f66 2066 6f6c 6473 203d 7b30 7d20 6772  of folds ={0} gr
-00049930: 6561 7465 7222 0a20 2020 2020 2020 2020  eater".         
-00049940: 2020 2020 2020 2020 2220 7468 616e 2074          " than t
-00049950: 6865 206e 756d 6265 7220 6f66 2073 616d  he number of sam
-00049960: 706c 6573 3a20 7b31 7d2e 2229 2e66 6f72  ples: {1}.").for
-00049970: 6d61 7428 6e5f 666f 6c64 732c 0a20 2020  mat(n_folds,.   
-00049980: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00049990: 2020 2020 2020 2020 2020 2020 2020 2020                  
-000499a0: 2020 2020 2020 2020 2020 2020 2020 2020                  
-000499b0: 2020 2020 2020 2020 2020 6e5f 7361 6d70            n_samp
-000499c0: 6c65 7329 290a 2020 2020 2020 2020 6966  les)).        if
-000499d0: 2028 6e5f 666f 6c64 7320 2d20 7472 6169   (n_folds - trai
-000499e0: 6e5f 7370 6c69 7473 202d 2074 6573 745f  n_splits - test_
-000499f0: 7370 6c69 7473 2920 3c3d 2030 2061 6e64  splits) <= 0 and
-00049a00: 2074 6573 745f 7370 6c69 7473 203e 2030   test_splits > 0
-00049a10: 3a0a 2020 2020 2020 2020 2020 2020 7261  :.            ra
-00049a20: 6973 6520 5661 6c75 6545 7272 6f72 280a  ise ValueError(.
-00049a30: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00049a40: 2822 426f 7468 2074 7261 696e 5f73 706c  ("Both train_spl
-00049a50: 6974 7320 616e 6420 7465 7374 5f73 706c  its and test_spl
-00049a60: 6974 7320 6d75 7374 2062 6520 706f 7369  its must be posi
-00049a70: 7469 7665 220a 2020 2020 2020 2020 2020  tive".          
-00049a80: 2020 2020 2020 2022 2069 6e74 6567 6572         " integer
-00049a90: 732e 2229 290a 2020 2020 2020 2020 696e  s.")).        in
-00049aa0: 6469 6365 7320 3d20 6e70 2e61 7261 6e67  dices = np.arang
-00049ab0: 6528 6e5f 7361 6d70 6c65 7329 0a20 2020  e(n_samples).   
-00049ac0: 2020 2020 2073 706c 6974 5f73 697a 6520       split_size 
-00049ad0: 3d20 286e 5f73 616d 706c 6573 202f 2f20  = (n_samples // 
-00049ae0: 6e5f 666f 6c64 7329 0a20 2020 2020 2020  n_folds).       
-00049af0: 2074 6573 745f 7369 7a65 203d 2073 706c   test_size = spl
-00049b00: 6974 5f73 697a 6520 2a20 7465 7374 5f73  it_size * test_s
-00049b10: 706c 6974 730a 2020 2020 2020 2020 7472  plits.        tr
-00049b20: 6169 6e5f 7369 7a65 203d 2073 706c 6974  ain_size = split
-00049b30: 5f73 697a 6520 2a20 7472 6169 6e5f 7370  _size * train_sp
-00049b40: 6c69 7473 0a20 2020 2020 2020 2074 6573  lits.        tes
-00049b50: 745f 7374 6172 7473 203d 2072 616e 6765  t_starts = range
-00049b60: 2874 7261 696e 5f73 697a 6520 2b20 6e5f  (train_size + n_
-00049b70: 7361 6d70 6c65 7320 2520 6e5f 666f 6c64  samples % n_fold
-00049b80: 732c 0a20 2020 2020 2020 2020 2020 2020  s,.             
-00049b90: 2020 2020 2020 2020 2020 2020 2020 206e                 n
-00049ba0: 5f73 616d 706c 6573 202d 2028 7465 7374  _samples - (test
-00049bb0: 5f73 697a 6520 2d20 7370 6c69 745f 7369  _size - split_si
-00049bc0: 7a65 292c 0a20 2020 2020 2020 2020 2020  ze),.           
-00049bd0: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00049be0: 2073 706c 6974 5f73 697a 6529 0a20 2020   split_size).   
-00049bf0: 2020 2020 2069 6620 6669 7865 645f 6c65       if fixed_le
-00049c00: 6e67 7468 3a0a 2020 2020 2020 2020 2020  ngth:.          
-00049c10: 2020 666f 7220 692c 2074 6573 745f 7374    for i, test_st
-00049c20: 6172 7420 696e 207a 6970 2872 616e 6765  art in zip(range
-00049c30: 286c 656e 2874 6573 745f 7374 6172 7473  (len(test_starts
-00049c40: 2929 2c0a 2020 2020 2020 2020 2020 2020  )),.            
-00049c50: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00049c60: 2020 2020 2020 2020 2074 6573 745f 7374           test_st
-00049c70: 6172 7473 293a 0a20 2020 2020 2020 2020  arts):.         
-00049c80: 2020 2020 2020 2072 656d 203d 2030 0a20         rem = 0. 
-00049c90: 2020 2020 2020 2020 2020 2020 2020 2069                 i
-00049ca0: 6620 6920 3d3d 2030 3a0a 2020 2020 2020  f i == 0:.      
-00049cb0: 2020 2020 2020 2020 2020 2020 2020 7265                re
-00049cc0: 6d20 3d20 6e5f 7361 6d70 6c65 7320 2520  m = n_samples % 
-00049cd0: 6e5f 666f 6c64 730a 2020 2020 2020 2020  n_folds.        
-00049ce0: 2020 2020 2020 2020 7969 656c 6420 2869          yield (i
-00049cf0: 6e64 6963 6573 5b28 7465 7374 5f73 7461  ndices[(test_sta
-00049d00: 7274 202d 2074 7261 696e 5f73 697a 6520  rt - train_size 
-00049d10: 2d20 7265 6d29 3a74 6573 745f 7374 6172  - rem):test_star
-00049d20: 745d 2c69 6e64 6963 6573 5b74 6573 745f  t],indices[test_
-00049d30: 7374 6172 743a 7465 7374 5f73 7461 7274  start:test_start
-00049d40: 202b 2074 6573 745f 7369 7a65 5d29 0a20   + test_size]). 
-00049d50: 2020 2020 2020 2065 6c73 653a 0a20 2020         else:.   
-00049d60: 2020 2020 2020 2020 2066 6f72 2074 6573           for tes
-00049d70: 745f 7374 6172 7420 696e 2074 6573 745f  t_start in test_
-00049d80: 7374 6172 7473 3a0a 2020 2020 2020 2020  starts:.        
-00049d90: 2020 2020 2020 2020 7969 656c 6420 2869          yield (i
-00049da0: 6e64 6963 6573 5b3a 7465 7374 5f73 7461  ndices[:test_sta
-00049db0: 7274 5d2c 696e 6469 6365 735b 7465 7374  rt],indices[test
-00049dc0: 5f73 7461 7274 3a74 6573 745f 7374 6172  _start:test_star
-00049dd0: 7420 2b20 7465 7374 5f73 697a 655d 290a  t + test_size]).
-00049de0: 2323 2323 2323 2323 2323 2323 2323 2323  ################
-00049df0: 2323 2323 2323 2323 2323 2323 2323 2323  ################
-00049e00: 2323 2323 2323 2323 2323 2323 2323 2323  ################
-00049e10: 2323 2323 2323 2323 2323 2323 2323 2323  ################
-00049e20: 2323 2323 2323 2323 2323 2323 2323 2323  ################
-00049e30: 2323 2323 2323 2323 2323 2323 0a64 6566  ############.def
-00049e40: 2072 6d73 7065 2879 2c20 7968 6174 293a   rmspe(y, yhat):
-00049e50: 0a20 2020 2072 6574 7572 6e20 6e70 2e73  .    return np.s
-00049e60: 7172 7428 6e70 2e6d 6561 6e28 2879 6861  qrt(np.mean((yha
-00049e70: 742f 792d 3129 202a 2a20 3229 290a 0a64  t/y-1) ** 2))..d
-00049e80: 6566 2072 6d73 7065 5f78 675f 6c6f 6728  ef rmspe_xg_log(
-00049e90: 7968 6174 2c20 7929 3a0a 2020 2020 7920  yhat, y):.    y 
-00049ea0: 3d20 6e70 2e70 6f77 6572 2831 302c 2079  = np.power(10, y
-00049eb0: 2e67 6574 5f6c 6162 656c 2829 290a 2020  .get_label()).  
-00049ec0: 2020 7968 6174 203d 206e 702e 706f 7765    yhat = np.powe
-00049ed0: 7228 3130 2c20 7968 6174 290a 2020 2020  r(10, yhat).    
-00049ee0: 7265 7475 726e 2022 726d 7370 6522 2c20  return "rmspe", 
-00049ef0: 726d 7370 6528 792c 7968 6174 290a 0a64  rmspe(y,yhat)..d
-00049f00: 6566 2072 6d73 7065 5f78 6728 7968 6174  ef rmspe_xg(yhat
-00049f10: 2c20 7929 3a0a 2020 2020 7265 7475 726e  , y):.    return
-00049f20: 2022 726d 7370 6522 2c20 726d 7370 6528   "rmspe", rmspe(
-00049f30: 792e 6765 745f 6c61 6265 6c28 292c 7968  y.get_label(),yh
-00049f40: 6174 290a 2323 2323 2323 2323 2323 2323  at).############
-00049f50: 2323 2323 2323 2323 2323 2323 2323 2323  ################
-00049f60: 2323 2323 2323 2323 2323 2323 2323 2323  ################
-00049f70: 2323 2323 2323 2323 2323 2323 2323 2323  ################
-00049f80: 2323 2323 2323 2323 2323 2323 2323 2323  ################
-00049f90: 2323 2323 2323 2323 2323 2323 2323 2323  ################
-00049fa0: 230a 6672 6f6d 2073 6b6c 6561 726e 2e6d  #.from sklearn.m
-00049fb0: 6f64 656c 5f73 656c 6563 7469 6f6e 2069  odel_selection i
-00049fc0: 6d70 6f72 7420 7472 6169 6e5f 7465 7374  mport train_test
-00049fd0: 5f73 706c 6974 0a64 6566 2078 6762 6f6f  _split.def xgboo
-00049fe0: 7374 5f72 6567 7265 7373 6f72 2820 585f  st_regressor( X_
-00049ff0: 7472 6169 6e2c 2079 5f74 7261 696e 2c20  train, y_train, 
-0004a000: 585f 7465 7374 2c20 0a20 2020 2020 2020  X_test, .       
-0004a010: 2020 2020 2020 2020 2020 2020 206c 6f67               log
-0004a020: 5f74 7261 6e73 666f 726d 3d46 616c 7365  _transform=False
-0004a030: 2c20 7370 6172 7369 7479 3d46 616c 7365  , sparsity=False
-0004a040: 2c20 6574 613d 302e 3129 3a0a 2020 2020  , eta=0.1):.    
-0004a050: 2222 220a 2020 2020 5065 7266 6f72 6d20  """.    Perform 
-0004a060: 7472 6169 6e69 6e67 2075 7369 6e67 2058  training using X
-0004a070: 4742 6f6f 7374 2077 6974 6820 6120 6c6f  GBoost with a lo
-0004a080: 6720 6261 7365 6420 7461 7267 6574 2074  g based target t
-0004a090: 7261 6e73 666f 726d 6174 696f 6e20 7069  ransformation pi
-0004a0a0: 7065 6c69 6e65 2e0a 2020 2020 2323 2323  peline..    ####
-0004a0b0: 2323 2323 2052 656d 656d 6265 7220 7468  #### Remember th
-0004a0c0: 6174 2077 6520 7573 6520 7468 6973 206f  at we use this o
-0004a0d0: 6e6c 7920 666f 7220 5265 6772 6573 7369  nly for Regressi
-0004a0e0: 6f6e 2070 726f 626c 656d 7320 2323 2323  on problems ####
-0004a0f0: 2323 2323 2323 2323 2323 230a 2020 2020  ###########.    
-0004a100: 5468 6973 2066 756e 6374 696f 6e20 7573  This function us
-0004a110: 6573 206c 6f67 2074 7261 6e73 666f 726d  es log transform
-0004a120: 6174 696f 6e20 6f66 2074 6172 6765 7420  ation of target 
-0004a130: 7661 7269 6162 6c65 2074 6f20 6d61 6b65  variable to make
-0004a140: 2069 7420 6561 7369 6572 2e0a 2020 2020   it easier..    
-0004a150: 4966 2073 7061 7273 6974 7920 6973 2073  If sparsity is s
-0004a160: 6574 2c20 7468 656e 2074 6172 6765 7420  et, then target 
-0004a170: 7768 6572 6520 7a65 726f 7320 6172 6520  where zeros are 
-0004a180: 7365 7420 746f 2073 6d61 6c6c 2076 616c  set to small val
-0004a190: 7565 2073 7563 6820 6173 2030 2e31 2e0a  ue such as 0.1..
-0004a1a0: 2020 2020 5468 6973 2068 6170 7065 6e73      This happens
-0004a1b0: 2066 7265 7175 656e 746c 7920 696e 2072   frequently in r
-0004a1c0: 6574 6169 6c20 6461 7461 7365 7473 2077  etail datasets w
-0004a1d0: 6865 7265 2069 6d62 616c 616e 6365 6420  here imbalanced 
-0004a1e0: 6461 7461 7365 7473 2061 7265 2063 6f6d  datasets are com
-0004a1f0: 6d6f 6e2e 200a 0a20 2020 2049 6e70 7574  mon. ..    Input
-0004a200: 733a 0a20 2020 2058 5f74 7261 696e 3a20  s:.    X_train: 
-0004a210: 6361 6e20 6265 2061 7272 6179 206f 7220  can be array or 
-0004a220: 4461 7461 4672 616d 6520 6f66 2074 7261  DataFrame of tra
-0004a230: 696e 2070 7265 6469 6374 6f72 2076 616c  in predictor val
-0004a240: 7565 730a 2020 2020 795f 7472 6169 6e3a  ues.    y_train:
-0004a250: 2063 616e 2062 6520 6172 7261 7920 6f72   can be array or
-0004a260: 2044 6174 6146 7261 6d65 206f 6620 7472   DataFrame of tr
-0004a270: 6169 6e20 7461 7267 6574 2076 616c 7565  ain target value
-0004a280: 730a 2020 2020 585f 7465 7374 3a20 6361  s.    X_test: ca
-0004a290: 6e20 6265 2061 7272 6179 206f 7220 6461  n be array or da
-0004a2a0: 7461 6672 616d 6520 6f66 2074 6573 7420  taframe of test 
-0004a2b0: 7072 6564 6963 746f 7220 7661 6c75 6573  predictor values
-0004a2c0: 0a0a 2020 2020 4f75 7470 7574 3a0a 2020  ..    Output:.  
-0004a2d0: 2020 7072 6564 7331 3a20 7072 6564 6963    preds1: predic
-0004a2e0: 7469 6f6e 7320 6f6e 2058 5f74 6573 7420  tions on X_test 
-0004a2f0: 7768 6963 6820 6361 6e20 6265 2063 6f6d  which can be com
-0004a300: 7061 7265 6420 746f 2079 5f74 6573 7420  pared to y_test 
-0004a310: 6f72 2073 7562 6d69 7474 6564 2e0a 2020  or submitted..  
-0004a320: 2020 2222 220a 2020 2020 7472 793a 0a20    """.    try:. 
-0004a330: 2020 2020 2020 2069 6d70 6f72 7420 7867         import xg
-0004a340: 626f 6f73 7420 6173 2078 6762 0a20 2020  boost as xgb.   
-0004a350: 2065 7863 6570 743a 0a20 2020 2020 2020   except:.       
-0004a360: 2070 7269 6e74 2827 596f 7520 6d75 7374   print('You must
-0004a370: 2068 6176 6520 7867 626f 6f73 7420 696e   have xgboost in
-0004a380: 7374 616c 6c65 6420 696e 2079 6f75 7220  stalled in your 
-0004a390: 6d61 6368 696e 6520 746f 2074 7279 2074  machine to try t
-0004a3a0: 6869 7320 6675 6e63 7469 6f6e 2e27 290a  his function.').
-0004a3b0: 2020 2020 2020 2020 7265 7475 726e 0a20          return. 
-0004a3c0: 2020 2023 2323 2323 2320 4966 2074 6865     ###### If the
-0004a3d0: 7920 6769 7665 2073 7061 7273 6974 7920  y give sparsity 
-0004a3e0: 666c 6167 2074 6865 6e20 7365 7420 7468  flag then set th
-0004a3f0: 6520 7461 7267 6574 2076 616c 7565 7320  e target values 
-0004a400: 746f 6120 6c6f 7720 6e75 6d62 6572 2023  toa low number #
-0004a410: 2323 0a20 2020 2069 6620 7370 6172 7369  ##.    if sparsi
-0004a420: 7479 3a0a 2020 2020 2020 2020 7072 696e  ty:.        prin
-0004a430: 7428 2753 696e 6365 2073 7061 7273 6974  t('Since sparsit
-0004a440: 7920 6973 2073 6574 2054 7275 652c 2072  y is set True, r
-0004a450: 6570 6c61 6365 207a 6572 6f20 7661 6c75  eplace zero valu
-0004a460: 6564 2074 6172 6765 7420 726f 7773 2077  ed target rows w
-0004a470: 6974 6820 6120 736d 616c 6c20 302e 3120  ith a small 0.1 
-0004a480: 7661 6c75 652e 2e2e 2729 0a20 2020 2020  value...').     
-0004a490: 2020 2069 6620 6973 696e 7374 616e 6365     if isinstance
-0004a4a0: 2879 5f74 7261 696e 2c20 6e70 2e6e 6461  (y_train, np.nda
-0004a4b0: 7272 6179 293a 0a20 2020 2020 2020 2020  rray):.         
-0004a4c0: 2020 2079 5f74 7261 696e 5b28 795f 7472     y_train[(y_tr
-0004a4d0: 6169 6e3d 3d30 295d 203d 2030 2e31 0a20  ain==0)] = 0.1. 
-0004a4e0: 2020 2020 2020 2065 6c69 6620 6973 696e         elif isin
-0004a4f0: 7374 616e 6365 2879 5f74 7261 696e 2c20  stance(y_train, 
-0004a500: 7064 2e53 6572 6965 7329 3a0a 2020 2020  pd.Series):.    
-0004a510: 2020 2020 2020 2020 2323 2320 5369 6e63          ### Sinc
-0004a520: 6520 7765 2077 616e 7420 7370 6172 7369  e we want sparsi
-0004a530: 7479 2077 6520 6172 6520 676f 696e 6720  ty we are going 
-0004a540: 746f 2073 6574 2074 6172 6765 7420 7661  to set target va
-0004a550: 6c75 6573 2074 6861 7420 6172 6520 7a65  lues that are ze
-0004a560: 726f 2061 7320 6e65 6172 207a 6572 6f0a  ro as near zero.
-0004a570: 2020 2020 2020 2020 2020 2020 7461 7267              targ
-0004a580: 6574 203d 2079 5f74 7261 696e 2e6e 616d  et = y_train.nam
-0004a590: 650a 2020 2020 2020 2020 2020 2020 6966  e.            if
-0004a5a0: 206c 656e 2879 5f74 7261 696e 2e6c 6f63   len(y_train.loc
-0004a5b0: 5b28 795f 7472 6169 6e3d 3d30 295d 2920  [(y_train==0)]) 
-0004a5c0: 3e20 303a 0a20 2020 2020 2020 2020 2020  > 0:.           
-0004a5d0: 2020 2020 2079 5f74 7261 696e 2e6c 6f63       y_train.loc
-0004a5e0: 5b28 795f 7472 6169 6e3d 3d30 295d 203d  [(y_train==0)] =
-0004a5f0: 2030 2e31 0a20 2020 2020 2020 2065 6c69   0.1.        eli
-0004a600: 6620 6973 696e 7374 616e 6365 2879 5f74  f isinstance(y_t
-0004a610: 7261 696e 2c20 7064 2e44 6174 6146 7261  rain, pd.DataFra
-0004a620: 6d65 293a 0a20 2020 2020 2020 2020 2020  me):.           
-0004a630: 2074 6172 6765 7473 203d 2079 5f74 7261   targets = y_tra
-0004a640: 696e 2e63 6f6c 756d 6e73 2e74 6f6c 6973  in.columns.tolis
-0004a650: 7428 290a 2020 2020 2020 2020 2020 2020  t().            
-0004a660: 666f 7220 6561 6368 5f74 6172 6765 7420  for each_target 
-0004a670: 696e 2074 6172 6765 7473 3a0a 2020 2020  in targets:.    
-0004a680: 2020 2020 2020 2020 2020 2020 6966 206c              if l
-0004a690: 656e 2879 5f74 7261 696e 2e6c 6f63 5b28  en(y_train.loc[(
-0004a6a0: 795f 7472 6169 6e5b 6561 6368 5f74 6172  y_train[each_tar
-0004a6b0: 6765 745d 3d3d 3029 5d29 203e 2030 3a0a  get]==0)]) > 0:.
-0004a6c0: 2020 2020 2020 2020 2020 2020 2020 2020                  
-0004a6d0: 2020 2020 795f 7472 6169 6e2e 6c6f 635b      y_train.loc[
-0004a6e0: 2879 5f74 7261 696e 5b65 6163 685f 7461  (y_train[each_ta
-0004a6f0: 7267 6574 5d3d 3d30 292c 2065 6163 685f  rget]==0), each_
-0004a700: 7461 7267 6574 5d20 3d20 302e 310a 0a20  target] = 0.1.. 
-0004a710: 2020 2023 2323 2323 2054 6869 7320 6973     ##### This is
-0004a720: 2077 6865 7265 2077 6520 7374 6172 7420   where we start 
-0004a730: 7468 6520 7370 6c69 7420 696e 746f 2074  the split into t
-0004a740: 7261 696e 2061 6e64 2076 616c 6964 2074  rain and valid t
-0004a750: 6f20 7475 6e65 2074 6865 206d 6f64 656c  o tune the model
-0004a760: 2023 2323 0a20 2020 2073 7461 7274 5f74   ###.    start_t
-0004a770: 696d 6520 3d20 7469 6d65 2e74 696d 6528  ime = time.time(
-0004a780: 290a 2020 2020 585f 7472 6169 6e31 2c20  ).    X_train1, 
-0004a790: 585f 7661 6c69 642c 2079 5f74 7261 696e  X_valid, y_train
-0004a7a0: 312c 2079 5f76 616c 6964 203d 2074 7261  1, y_valid = tra
-0004a7b0: 696e 5f74 6573 745f 7370 6c69 7428 0a20  in_test_split(. 
-0004a7c0: 2020 2020 2020 2020 2020 2020 2020 2058                 X
-0004a7d0: 5f74 7261 696e 2c20 795f 7472 6169 6e2c  _train, y_train,
-0004a7e0: 2074 6573 745f 7369 7a65 3d30 2e30 322c   test_size=0.02,
-0004a7f0: 2072 616e 646f 6d5f 7374 6174 653d 3130   random_state=10
-0004a800: 290a 2020 2020 6966 206c 6f67 5f74 7261  ).    if log_tra
-0004a810: 6e73 666f 726d 3a0a 2020 2020 2020 2020  nsform:.        
-0004a820: 795f 7472 6169 6e31 203d 206e 702e 6c6f  y_train1 = np.lo
-0004a830: 6731 3028 795f 7472 6169 6e31 290a 2020  g10(y_train1).  
-0004a840: 2020 2020 2020 795f 7661 6c69 6420 3d20        y_valid = 
-0004a850: 6e70 2e6c 6f67 3130 2879 5f76 616c 6964  np.log10(y_valid
-0004a860: 290a 2020 2020 7072 696e 7428 585f 7472  ).    print(X_tr
-0004a870: 6169 6e31 2e73 6861 7065 2c20 585f 7661  ain1.shape, X_va
-0004a880: 6c69 642e 7368 6170 6529 0a0a 2020 2020  lid.shape)..    
-0004a890: 2323 2323 2320 4e6f 7720 6c65 7420 7573  ##### Now let us
-0004a8a0: 2074 7261 6e73 666f 726d 2058 5f74 7261   transform X_tra
-0004a8b0: 696e 3120 616e 6420 795f 7472 6169 6e31  in1 and y_train1
-0004a8c0: 2077 6974 6820 6c61 7a79 7472 616e 7366   with lazytransf
-0004a8d0: 6f72 6d65 7220 2323 2323 230a 2020 2020  ormer #####.    
-0004a8e0: 6c61 7a79 203d 204c 617a 7954 7261 6e73  lazy = LazyTrans
-0004a8f0: 666f 726d 6572 286d 6f64 656c 3d4e 6f6e  former(model=Non
-0004a900: 652c 2065 6e63 6f64 6572 733d 276c 6162  e, encoders='lab
-0004a910: 656c 272c 2073 6361 6c65 7273 3d27 272c  el', scalers='',
-0004a920: 200a 2020 2020 2020 2020 2020 2020 2020   .              
-0004a930: 2020 2020 2020 2020 2020 7472 616e 7366            transf
-0004a940: 6f72 6d5f 7461 7267 6574 3d46 616c 7365  orm_target=False
-0004a950: 2c20 696d 6261 6c61 6e63 6564 3d46 616c  , imbalanced=Fal
-0004a960: 7365 2c20 7665 7262 6f73 653d 3129 0a20  se, verbose=1). 
-0004a970: 2020 2058 5f74 7261 696e 312c 2079 5f74     X_train1, y_t
-0004a980: 7261 696e 3120 3d20 6c61 7a79 2e66 6974  rain1 = lazy.fit
-0004a990: 5f74 7261 6e73 666f 726d 2858 5f74 7261  _transform(X_tra
-0004a9a0: 696e 312c 2079 5f74 7261 696e 3129 0a20  in1, y_train1). 
-0004a9b0: 2020 2058 5f76 616c 6964 312c 2079 5f76     X_valid1, y_v
-0004a9c0: 616c 6964 3120 3d20 6c61 7a79 2e74 7261  alid1 = lazy.tra
-0004a9d0: 6e73 666f 726d 2858 5f76 616c 6964 2c20  nsform(X_valid, 
-0004a9e0: 795f 7661 6c69 6429 0a0a 2020 2020 2323  y_valid)..    ##
-0004a9f0: 2323 2323 2323 2020 204e 6f77 206c 6574  ######   Now let
-0004aa00: 2773 2070 6572 666f 726d 2072 616e 646f  's perform rando
-0004aa10: 6d69 7a65 6420 7365 6172 6368 2074 6f20  mized search to 
-0004aa20: 6669 6e64 2062 6573 7420 6879 7065 7220  find best hyper 
-0004aa30: 7061 7261 6d65 7465 7273 2023 2323 2323  parameters #####
-0004aa40: 230a 2020 2020 7072 696e 7428 2723 2323  #.    print('###
-0004aa50: 2320 4d6f 6465 6c20 7472 6169 6e69 6e67  # Model training
-0004aa60: 2075 7369 6e67 2058 4742 2023 2323 2323   using XGB #####
-0004aa70: 2323 2320 6574 6120 3d20 2573 2720 2565  ### eta = %s' %e
-0004aa80: 7461 290a 2020 2020 7061 7261 6d73 203d  ta).    params =
-0004aa90: 207b 226f 626a 6563 7469 7665 223a 2022   {"objective": "
-0004aaa0: 7265 673a 7371 7561 7265 6465 7272 6f72  reg:squarederror
-0004aab0: 222c 0a20 2020 2020 2020 2020 2020 2020  ",.             
-0004aac0: 2022 626f 6f73 7465 7222 203a 2022 6762   "booster" : "gb
-0004aad0: 7472 6565 222c 0a20 2020 2020 2020 2020  tree",.         
-0004aae0: 2020 2020 2022 6574 6122 3a20 6574 612c       "eta": eta,
-0004aaf0: 0a20 2020 2020 2020 2020 2020 2020 2022  .              "
-0004ab00: 7369 6c65 6e74 223a 2031 2c0a 2020 2020  silent": 1,.    
-0004ab10: 2020 2020 2020 2020 2020 2273 6565 6422            "seed"
-0004ab20: 3a20 3939 0a20 2020 2020 2020 2020 2020  : 99.           
-0004ab30: 2020 207d 0a20 2020 206e 756d 5f62 6f6f     }.    num_boo
-0004ab40: 7374 5f72 6f75 6e64 203d 2035 3030 0a20  st_round = 500. 
-0004ab50: 2020 2023 2323 2323 206e 6f77 2064 6f20     ##### now do 
-0004ab60: 7468 6520 7472 6169 6e69 6e67 2023 2323  the training ###
-0004ab70: 2323 2323 2323 2323 0a20 2020 2064 7472  ########.    dtr
-0004ab80: 6169 6e20 3d20 7867 622e 444d 6174 7269  ain = xgb.DMatri
-0004ab90: 7828 585f 7472 6169 6e31 2c20 795f 7472  x(X_train1, y_tr
-0004aba0: 6169 6e31 290a 2020 2020 6476 616c 6964  ain1).    dvalid
-0004abb0: 203d 2078 6762 2e44 4d61 7472 6978 2858   = xgb.DMatrix(X
-0004abc0: 5f76 616c 6964 312c 2079 5f76 616c 6964  _valid1, y_valid
-0004abd0: 3129 0a20 2020 2023 2323 2323 2323 2323  1).    #########
-0004abe0: 2320 2020 4e6f 7720 7765 2075 7365 2072  #   Now we use r
-0004abf0: 6d73 7065 5f78 6720 2323 2323 2323 2323  mspe_xg ########
-0004ac00: 2323 2323 2323 2323 2323 230a 2020 2020  ###########.    
-0004ac10: 6966 206c 6f67 5f74 7261 6e73 666f 726d  if log_transform
-0004ac20: 3a0a 2020 2020 2020 2020 6665 7661 6c20  :.        feval 
-0004ac30: 3d20 726d 7370 655f 7867 5f6c 6f67 0a20  = rmspe_xg_log. 
-0004ac40: 2020 2065 6c73 653a 0a20 2020 2020 2020     else:.       
-0004ac50: 2066 6576 616c 203d 2072 6d73 7065 5f78   feval = rmspe_x
-0004ac60: 670a 2020 2020 7761 7463 686c 6973 7420  g.    watchlist 
-0004ac70: 3d20 5b28 6474 7261 696e 2c20 2774 7261  = [(dtrain, 'tra
-0004ac80: 696e 2729 2c20 2864 7661 6c69 642c 2027  in'), (dvalid, '
-0004ac90: 6576 616c 2729 5d0a 2020 2020 6762 6d20  eval')].    gbm 
-0004aca0: 3d20 7867 622e 7472 6169 6e28 7061 7261  = xgb.train(para
-0004acb0: 6d73 2c20 6474 7261 696e 2c20 6e75 6d5f  ms, dtrain, num_
-0004acc0: 626f 6f73 745f 726f 756e 642c 2065 7661  boost_round, eva
-0004acd0: 6c73 3d77 6174 6368 6c69 7374 2c20 5c0a  ls=watchlist, \.
-0004ace0: 2020 2020 2020 6561 726c 795f 7374 6f70        early_stop
-0004acf0: 7069 6e67 5f72 6f75 6e64 733d 3130 2c20  ping_rounds=10, 
-0004ad00: 6665 7661 6c3d 6665 7661 6c2c 2076 6572  feval=feval, ver
-0004ad10: 626f 7365 5f65 7661 6c3d 5472 7565 290a  bose_eval=True).
-0004ad20: 2020 2020 7072 696e 7428 2754 7261 696e      print('Train
-0004ad30: 696e 6720 436f 6d70 6c65 7465 6427 290a  ing Completed').
-0004ad40: 0a20 2020 2023 2323 2320 5468 6973 2069  .    #### This i
-0004ad50: 7320 7768 6572 6520 796f 7520 6772 6964  s where you grid
-0004ad60: 2073 6561 7263 6820 7468 6520 7069 7065   search the pipe
-0004ad70: 6c69 6e65 206e 6f77 2023 2323 2323 2323  line now #######
-0004ad80: 2323 2323 2323 230a 2020 2020 7072 696e  #######.    prin
-0004ad90: 7428 2256 616c 6964 6174 696e 6722 290a  t("Validating").
-0004ada0: 2020 2020 2323 2323 2049 6620 6974 2069      #### If it i
-0004adb0: 7320 6e6f 7420 7370 6172 7365 2064 6174  s not sparse dat
-0004adc0: 612c 2079 6f75 206d 7573 7420 7374 696c  a, you must stil
-0004add0: 6c20 7472 616e 7366 6f72 6d20 6974 2069  l transform it i
-0004ade0: 6e74 6f20 616e 2061 7272 6179 2023 2323  nto an array ###
-0004adf0: 0a20 2020 2069 6620 6973 696e 7374 616e  .    if isinstan
-0004ae00: 6365 2879 5f76 616c 6964 312c 2070 642e  ce(y_valid1, pd.
-0004ae10: 5365 7269 6573 293a 0a20 2020 2020 2020  Series):.       
-0004ae20: 2079 5f76 616c 6964 3120 3d20 795f 7661   y_valid1 = y_va
-0004ae30: 6c69 6431 2e76 616c 7565 730a 2020 2020  lid1.values.    
-0004ae40: 656c 6966 2069 7369 6e73 7461 6e63 6528  elif isinstance(
-0004ae50: 795f 7661 6c69 6431 2c20 7064 2e44 6174  y_valid1, pd.Dat
-0004ae60: 6146 7261 6d65 293a 0a20 2020 2020 2020  aFrame):.       
-0004ae70: 2079 5f76 616c 6964 3120 3d20 795f 7661   y_valid1 = y_va
-0004ae80: 6c69 6431 2e76 616c 7565 732e 7261 7665  lid1.values.rave
-0004ae90: 6c28 290a 2020 2020 7968 6174 203d 2067  l().    yhat = g
-0004aea0: 626d 2e70 7265 6469 6374 2878 6762 2e44  bm.predict(xgb.D
-0004aeb0: 4d61 7472 6978 2858 5f76 616c 6964 3129  Matrix(X_valid1)
-0004aec0: 290a 2020 2020 6572 726f 7220 3d20 726d  ).    error = rm
-0004aed0: 7370 6528 795f 7661 6c69 6431 2c20 7968  spe(y_valid1, yh
-0004aee0: 6174 290a 2020 2020 7072 696e 7428 2752  at).    print('R
-0004aef0: 4d53 5045 3a20 7b3a 2e36 667d 272e 666f  MSPE: {:.6f}'.fo
-0004af00: 726d 6174 2865 7272 6f72 2929 0a0a 2020  rmat(error))..  
-0004af10: 2020 2323 2323 2320 5468 6973 2069 7320    ##### This is 
-0004af20: 7768 6572 6520 7765 2073 6561 7263 6820  where we search 
-0004af30: 666f 7220 6879 7065 7220 7061 7261 6d73  for hyper params
-0004af40: 2066 6f72 206d 6f64 656c 2023 2323 2323   for model #####
-0004af50: 2323 0a20 2020 2058 5f74 6573 7431 203d  ##.    X_test1 =
-0004af60: 206c 617a 792e 7472 616e 7366 6f72 6d28   lazy.transform(
-0004af70: 585f 7465 7374 290a 2020 2020 6474 6573  X_test).    dtes
-0004af80: 7420 3d20 7867 622e 444d 6174 7269 7828  t = xgb.DMatrix(
-0004af90: 585f 7465 7374 3129 0a20 2020 2070 7265  X_test1).    pre
-0004afa0: 6473 3120 3d20 6762 6d2e 7072 6564 6963  ds1 = gbm.predic
-0004afb0: 7428 6474 6573 7429 0a20 2020 2023 2052  t(dtest).    # R
-0004afc0: 6574 7572 6e20 7072 6564 6963 7469 6f6e  eturn prediction
-0004afd0: 7320 2323 230a 2020 2020 6966 206c 6f67  s ###.    if log
-0004afe0: 5f74 7261 6e73 666f 726d 3a0a 2020 2020  _transform:.    
-0004aff0: 2020 2020 7072 6564 7331 203d 206e 702e      preds1 = np.
-0004b000: 706f 7765 7228 3130 2c20 7072 6564 7331  power(10, preds1
-0004b010: 290a 0a20 2020 2072 6574 7572 6e20 7072  )..    return pr
-0004b020: 6564 7331 0a23 2323 2323 2323 2323 2323  eds1.###########
-0004b030: 2323 2323 2323 2323 2323 2323 2323 2323  ################
-0004b040: 2323 2323 2323 2323 2323 2323 2323 2323  ################
-0004b050: 2323 2323 2323 2323 2323 2323 2323 2323  ################
-0004b060: 2323 2323 2323 2323 2323 2323 2323 2323  ################
-0004b070: 2323 2323 2323 0a66 726f 6d20 7363 6970  ######.from scip
-0004b080: 792e 7374 6174 7320 696d 706f 7274 2070  y.stats import p
-0004b090: 726f 6270 6c6f 742c 736b 6577 0a64 6566  robplot,skew.def
-0004b0a0: 205f 6461 7461 5f73 7567 6765 7374 696f   _data_suggestio
-0004b0b0: 6e73 2864 6174 6129 3a0a 2020 2020 2222  ns(data):.    ""
-0004b0c0: 220a 2020 2020 4d6f 6469 6669 6564 2062  ".    Modified b
-0004b0d0: 7920 5261 6d20 5365 7368 6164 7269 2e20  y Ram Seshadri. 
-0004b0e0: 4f72 6967 696e 616c 2069 6465 6120 666f  Original idea fo
-0004b0f0: 7220 6461 7461 2073 7567 6765 7374 696f  r data suggestio
-0004b100: 6e73 206d 6f64 756c 6520 7761 7320 6120  ns module was a 
-0004b110: 4b61 6767 6c65 722e 200a 2020 2020 4d61  Kaggler. .    Ma
-0004b120: 6e79 2074 6861 6e6b 7320 746f 3a20 6874  ny thanks to: ht
-0004b130: 7470 733a 2f2f 7777 772e 6b61 6767 6c65  tps://www.kaggle
-0004b140: 2e63 6f6d 2f63 6f64 652f 6974 6b69 6e31  .com/code/itkin1
-0004b150: 362f 6361 7462 6f6f 7374 2d6f 6e2d 6770  6/catboost-on-gp
-0004b160: 752d 6261 7365 6c69 6e65 0a20 2020 2022  u-baseline.    "
-0004b170: 2222 0a20 2020 206d 6178 7820 3d20 5b5d  "".    maxx = []
-0004b180: 0a20 2020 206d 696e 6e20 3d20 5b5d 0a20  .    minn = []. 
-0004b190: 2020 2063 6174 5f63 6f6c 7331 203d 2064     cat_cols1 = d
-0004b1a0: 6174 612e 7365 6c65 6374 5f64 7479 7065  ata.select_dtype
-0004b1b0: 7328 696e 636c 7564 653d 276f 626a 6563  s(include='objec
-0004b1c0: 7427 292e 636f 6c75 6d6e 732e 746f 6c69  t').columns.toli
-0004b1d0: 7374 2829 0a20 2020 2063 6174 5f63 6f6c  st().    cat_col
-0004b1e0: 7332 203d 2064 6174 612e 7365 6c65 6374  s2 = data.select
-0004b1f0: 5f64 7479 7065 7328 696e 636c 7564 653d  _dtypes(include=
-0004b200: 2763 6174 6567 6f72 7927 292e 636f 6c75  'category').colu
-0004b210: 6d6e 732e 746f 6c69 7374 2829 0a20 2020  mns.tolist().   
-0004b220: 2063 6174 5f63 6f6c 7320 3d20 6c69 7374   cat_cols = list
-0004b230: 2873 6574 2863 6174 5f63 6f6c 7331 2b63  (set(cat_cols1+c
-0004b240: 6174 5f63 6f6c 7332 2929 0a20 2020 206e  at_cols2)).    n
-0004b250: 756d 5f63 6f6c 7320 3d20 6461 7461 2e73  um_cols = data.s
-0004b260: 656c 6563 745f 6474 7970 6573 2869 6e63  elect_dtypes(inc
-0004b270: 6c75 6465 3d27 666c 6f61 7427 292e 636f  lude='float').co
-0004b280: 6c75 6d6e 732e 746f 6c69 7374 2829 0a0a  lumns.tolist()..
-0004b290: 2020 2020 666f 7220 6920 696e 2064 6174      for i in dat
-0004b2a0: 612e 636f 6c75 6d6e 733a 0a20 2020 2020  a.columns:.     
-0004b2b0: 2020 2069 6620 6920 6e6f 7420 696e 2063     if i not in c
-0004b2c0: 6174 5f63 6f6c 733a 0a20 2020 2020 2020  at_cols:.       
-0004b2d0: 2020 2020 2023 2323 2066 6f72 2066 6c6f       ### for flo
-0004b2e0: 6174 2061 6e64 2069 6e74 6567 6572 2c20  at and integer, 
-0004b2f0: 6e6f 206e 6565 6420 746f 2063 616c 6375  no need to calcu
-0004b300: 6c61 7465 2074 6869 7320 2323 0a20 2020  late this ##.   
-0004b310: 2020 2020 2020 2020 206d 696e 6e2e 6170           minn.ap
-0004b320: 7065 6e64 2830 290a 2020 2020 2020 2020  pend(0).        
-0004b330: 656c 7365 3a0a 2020 2020 2020 2020 2020  else:.          
-0004b340: 2020 6d69 6e6e 2e61 7070 656e 6428 6461    minn.append(da
-0004b350: 7461 5b69 5d2e 7661 6c75 655f 636f 756e  ta[i].value_coun
-0004b360: 7473 2829 2e6d 696e 2829 290a 2020 2020  ts().min()).    
-0004b370: 6c65 6e67 7468 203d 206c 656e 2864 6174  length = len(dat
-0004b380: 6129 0a20 2020 206e 756e 696b 203d 2064  a).    nunik = d
-0004b390: 6174 612e 6e75 6e69 7175 6528 290a 2020  ata.nunique().  
-0004b3a0: 2020 6e75 6c6c 7320 3d20 6461 7461 2e69    nulls = data.i
-0004b3b0: 736e 6128 292e 7375 6d28 290a 2020 2020  sna().sum().    
-0004b3c0: 6466 203d 2070 642e 4461 7461 4672 616d  df = pd.DataFram
-0004b3d0: 6528 0a20 2020 2020 2020 207b 0a20 2020  e(.        {.   
-0004b3e0: 2020 2020 2020 2327 636f 6c75 6d6e 273a        #'column':
-0004b3f0: 206c 6973 7428 6461 7461 292c 0a20 2020   list(data),.   
-0004b400: 2020 2020 2027 4e75 6e69 7175 6573 273a       'Nuniques':
-0004b410: 206e 756e 696b 2c0a 2020 2020 2020 2020   nunik,.        
-0004b420: 2027 4e75 6e69 7175 6550 6572 6365 6e74   'NuniquePercent
-0004b430: 273a 2028 3130 302a 286e 756e 696b 2f6c  ': (100*(nunik/l
-0004b440: 656e 6774 6829 292c 0a20 2020 2020 2020  ength)),.       
-0004b450: 2020 2764 7479 7065 273a 2064 6174 612e    'dtype': data.
-0004b460: 6474 7970 6573 2c0a 2020 2020 2020 2020  dtypes,.        
-0004b470: 2027 4e75 6c6c 7327 203a 206e 756c 6c73   'Nulls' : nulls
-0004b480: 2c0a 2020 2020 2020 2020 2027 4e75 6c6c  ,.         'Null
-0004b490: 7065 7263 656e 7427 203a 2031 3030 2a28  percent' : 100*(
-0004b4a0: 6e75 6c6c 732f 6c65 6e67 7468 292c 0a20  nulls/length),. 
-0004b4b0: 2020 2020 2020 2020 2756 616c 7565 2063          'Value c
-0004b4c0: 6f75 6e74 7320 4d69 6e27 3a6d 696e 6e20  ounts Min':minn 
-0004b4d0: 0a20 2020 2020 2020 207d 2c0a 2020 2020  .        },.    
-0004b4e0: 2020 2020 636f 6c75 6d6e 7320 3d20 5b27      columns = ['
-0004b4f0: 4e75 6e69 7175 6573 272c 2027 6474 7970  Nuniques', 'dtyp
-0004b500: 6527 2c27 4e75 6c6c 7327 2c27 4e75 6c6c  e','Nulls','Null
-0004b510: 7065 7263 656e 7427 2c20 274e 756e 6971  percent', 'Nuniq
-0004b520: 7565 5065 7263 656e 7427 2c0a 2020 2020  uePercent',.    
-0004b530: 2020 2020 2020 2020 2020 2020 2020 2020                  
-0004b540: 2020 2027 5661 6c75 6520 636f 756e 7473     'Value counts
-0004b550: 204d 696e 275d 292e 736f 7274 5f76 616c   Min']).sort_val
-0004b560: 7565 7328 6279 203d 274e 756e 6971 7565  ues(by ='Nunique
-0004b570: 7327 2c61 7363 656e 6469 6e67 203d 2046  s',ascending = F
-0004b580: 616c 7365 290a 2020 2020 6e65 7763 6f6c  alse).    newcol
-0004b590: 203d 2027 4461 7461 2063 6c65 616e 696e   = 'Data cleanin
-0004b5a0: 6720 696d 7072 6f76 656d 656e 7420 7375  g improvement su
-0004b5b0: 6767 6573 7469 6f6e 7327 0a20 2020 206d  ggestions'.    m
-0004b5c0: 6978 6564 5f63 6f6c 7320 3d20 5b63 6f6c  ixed_cols = [col
-0004b5d0: 2066 6f72 2063 6f6c 2069 6e20 6461 7461   for col in data
-0004b5e0: 2e63 6f6c 756d 6e73 2069 6620 6c65 6e28  .columns if len(
-0004b5f0: 6461 7461 5b63 6f6c 5d2e 6170 706c 7928  data[col].apply(
-0004b600: 7479 7065 292e 7661 6c75 655f 636f 756e  type).value_coun
-0004b610: 7473 2829 2920 3e20 315d 0a20 2020 2064  ts()) > 1].    d
-0004b620: 665b 6e65 7763 6f6c 5d20 3d20 2727 0a20  f[newcol] = ''. 
-0004b630: 2020 2064 665b 2766 6972 7374 5f63 6f6d     df['first_com
-0004b640: 6d61 275d 203d 2027 270a 2020 2020 6966  ma'] = ''.    if
-0004b650: 206c 656e 2863 6174 5f63 6f6c 7329 203e   len(cat_cols) >
-0004b660: 2030 3a0a 2020 2020 2020 2020 6d61 736b   0:.        mask
-0004b670: 3020 3d20 6466 5b27 6474 7970 6527 5d20  0 = df['dtype'] 
-0004b680: 3d3d 2027 6f62 6a65 6374 270a 2020 2020  == 'object'.    
-0004b690: 2020 2020 6d61 736b 3120 3d20 6466 5b27      mask1 = df['
-0004b6a0: 5661 6c75 6520 636f 756e 7473 204d 696e  Value counts Min
-0004b6b0: 275d 2f64 665b 274e 756e 6971 7565 7327  ']/df['Nuniques'
-0004b6c0: 5d20 3c3d 2030 2e30 350a 2020 2020 2020  ] <= 0.05.      
-0004b6d0: 2020 6466 2e6c 6f63 5b6d 6173 6b30 266d    df.loc[mask0&m
-0004b6e0: 6173 6b31 2c6e 6577 636f 6c5d 202b 3d20  ask1,newcol] += 
-0004b6f0: 6466 2e6c 6f63 5b6d 6173 6b30 266d 6173  df.loc[mask0&mas
-0004b700: 6b31 2c27 6669 7273 745f 636f 6d6d 6127  k1,'first_comma'
-0004b710: 5d20 2b20 2763 6f6d 6269 6e65 2072 6172  ] + 'combine rar
-0004b720: 6520 6361 7465 676f 7269 6573 270a 2020  e categories'.  
-0004b730: 2020 2020 2020 6466 2e6c 6f63 5b6d 6173        df.loc[mas
-0004b740: 6b30 266d 6173 6b31 2c27 6669 7273 745f  k0&mask1,'first_
-0004b750: 636f 6d6d 6127 5d20 3d20 272c 2027 0a20  comma'] = ', '. 
-0004b760: 2020 206d 6173 6b32 203d 2064 665b 274e     mask2 = df['N
-0004b770: 756c 6c73 275d 203e 2030 0a20 2020 2064  ulls'] > 0.    d
-0004b780: 662e 6c6f 635b 6d61 736b 322c 6e65 7763  f.loc[mask2,newc
-0004b790: 6f6c 5d20 2b3d 2064 662e 6c6f 635b 6d61  ol] += df.loc[ma
-0004b7a0: 736b 322c 2766 6972 7374 5f63 6f6d 6d61  sk2,'first_comma
-0004b7b0: 275d 202b 2027 6669 6c6c 206d 6973 7369  '] + 'fill missi
-0004b7c0: 6e67 2076 616c 7565 7327 0a20 2020 2064  ng values'.    d
-0004b7d0: 662e 6c6f 635b 6d61 736b 322c 2766 6972  f.loc[mask2,'fir
-0004b7e0: 7374 5f63 6f6d 6d61 275d 203d 2022 2c20  st_comma'] = ", 
-0004b7f0: 220a 2020 2020 6d61 736b 3320 3d20 6466  ".    mask3 = df
-0004b800: 5b27 4e75 6e69 7175 6573 275d 203d 3d20  ['Nuniques'] == 
-0004b810: 310a 2020 2020 6466 2e6c 6f63 5b6d 6173  1.    df.loc[mas
-0004b820: 6b33 2c6e 6577 636f 6c5d 202b 3d20 6466  k3,newcol] += df
-0004b830: 2e6c 6f63 5b6d 6173 6b33 2c27 6669 7273  .loc[mask3,'firs
-0004b840: 745f 636f 6d6d 6127 5d20 2b20 2769 6e76  t_comma'] + 'inv
-0004b850: 6172 6961 6e74 2076 616c 7565 733a 2064  ariant values: d
-0004b860: 726f 7020 636f 6c75 6d6e 270a 2020 2020  rop column'.    
-0004b870: 6466 2e6c 6f63 5b6d 6173 6b33 2c27 6669  df.loc[mask3,'fi
-0004b880: 7273 745f 636f 6d6d 6127 5d20 3d20 222c  rst_comma'] = ",
-0004b890: 2022 0a20 2020 206d 6173 6b34 203d 2064   ".    mask4 = d
-0004b8a0: 665b 274e 756e 6971 7565 5065 7263 656e  f['NuniquePercen
-0004b8b0: 7427 5d20 3d3d 2031 3030 0a20 2020 2064  t'] == 100.    d
-0004b8c0: 662e 6c6f 635b 6d61 736b 342c 6e65 7763  f.loc[mask4,newc
-0004b8d0: 6f6c 5d20 2b3d 2064 662e 6c6f 635b 6d61  ol] += df.loc[ma
-0004b8e0: 736b 342c 2766 6972 7374 5f63 6f6d 6d61  sk4,'first_comma
-0004b8f0: 275d 202b 2027 706f 7373 6962 6c65 2049  '] + 'possible I
-0004b900: 4420 636f 6c75 6d6e 3a20 6472 6f70 270a  D column: drop'.
-0004b910: 2020 2020 6466 2e6c 6f63 5b6d 6173 6b34      df.loc[mask4
-0004b920: 2c27 6669 7273 745f 636f 6d6d 6127 5d20  ,'first_comma'] 
-0004b930: 3d20 222c 2022 0a20 2020 206d 6173 6b35  = ", ".    mask5
-0004b940: 203d 2064 665b 274e 756c 6c70 6572 6365   = df['Nullperce
-0004b950: 6e74 275d 203e 3d20 3930 0a20 2020 2064  nt'] >= 90.    d
-0004b960: 662e 6c6f 635b 6d61 736b 352c 6e65 7763  f.loc[mask5,newc
-0004b970: 6f6c 5d20 2b3d 2064 662e 6c6f 635b 6d61  ol] += df.loc[ma
-0004b980: 736b 352c 2766 6972 7374 5f63 6f6d 6d61  sk5,'first_comma
-0004b990: 275d 202b 2027 7665 7279 2068 6967 6820  '] + 'very high 
-0004b9a0: 6e75 6c6c 7320 7065 7263 656e 743a 2064  nulls percent: d
-0004b9b0: 726f 7020 636f 6c75 6d6e 270a 2020 2020  rop column'.    
-0004b9c0: 6466 2e6c 6f63 5b6d 6173 6b35 2c27 6669  df.loc[mask5,'fi
-0004b9d0: 7273 745f 636f 6d6d 6127 5d20 3d20 222c  rst_comma'] = ",
-0004b9e0: 2022 0a20 2020 2023 2323 2320 6368 6563   ".    #### chec
-0004b9f0: 6b20 666f 7220 696e 6669 6e69 7465 2076  k for infinite v
-0004ba00: 616c 7565 7320 6865 7265 2023 2323 2323  alues here #####
-0004ba10: 0a20 2020 2069 6e66 5f63 6f6c 7331 203d  .    inf_cols1 =
-0004ba20: 206e 702e 6172 7261 7928 6e75 6d5f 636f   np.array(num_co
-0004ba30: 6c73 295b 5b28 6461 7461 2e6c 6f63 5b28  ls)[[(data.loc[(
-0004ba40: 6461 7461 5b63 6f6c 5d20 3d3d 206e 702e  data[col] == np.
-0004ba50: 696e 6629 5d29 2e73 6861 7065 5b30 5d3e  inf)]).shape[0]>
-0004ba60: 3020 666f 7220 636f 6c20 696e 206e 756d  0 for col in num
-0004ba70: 5f63 6f6c 735d 5d2e 746f 6c69 7374 2829  _cols]].tolist()
-0004ba80: 0a20 2020 2069 6e66 5f63 6f6c 7332 203d  .    inf_cols2 =
-0004ba90: 206e 702e 6172 7261 7928 6e75 6d5f 636f   np.array(num_co
-0004baa0: 6c73 295b 5b28 6461 7461 2e6c 6f63 5b28  ls)[[(data.loc[(
-0004bab0: 6461 7461 5b63 6f6c 5d20 3d3d 202d 6e70  data[col] == -np
-0004bac0: 2e69 6e66 295d 292e 7368 6170 655b 305d  .inf)]).shape[0]
-0004bad0: 3e30 2066 6f72 2063 6f6c 2069 6e20 6e75  >0 for col in nu
-0004bae0: 6d5f 636f 6c73 5d5d 2e74 6f6c 6973 7428  m_cols]].tolist(
-0004baf0: 290a 2020 2020 696e 665f 636f 6c73 203d  ).    inf_cols =
-0004bb00: 206c 6973 7428 7365 7428 696e 665f 636f   list(set(inf_co
-0004bb10: 6c73 312b 696e 665f 636f 6c73 3229 290a  ls1+inf_cols2)).
-0004bb20: 2020 2020 2323 2320 4368 6563 6b20 666f      ### Check fo
-0004bb30: 7220 696e 6669 6e69 7465 2076 616c 7565  r infinite value
-0004bb40: 7320 696e 2063 6f6c 756d 6e73 2023 2323  s in columns ###
-0004bb50: 2323 0a20 2020 2069 6620 6c65 6e28 696e  ##.    if len(in
-0004bb60: 665f 636f 6c73 2920 3e20 303a 0a20 2020  f_cols) > 0:.   
-0004bb70: 2020 2020 2066 6f72 2078 2069 6e20 696e       for x in in
-0004bb80: 665f 636f 6c73 3a0a 2020 2020 2020 2020  f_cols:.        
-0004bb90: 2020 2020 6466 2e6c 6f63 5b78 2c6e 6577      df.loc[x,new
-0004bba0: 636f 6c5d 202b 3d20 6466 2e6c 6f63 5b78  col] += df.loc[x
-0004bbb0: 2c27 6669 7273 745f 636f 6d6d 6127 5d20  ,'first_comma'] 
-0004bbc0: 2b20 2769 6e66 696e 6974 6520 7661 6c75  + 'infinite valu
-0004bbd0: 6573 3a20 6472 6f70 270a 2020 2020 2020  es: drop'.      
-0004bbe0: 2020 2020 2020 6466 2e6c 6f63 5b78 2c27        df.loc[x,'
-0004bbf0: 6669 7273 745f 636f 6d6d 6127 5d20 3d20  first_comma'] = 
-0004bc00: 222c 2022 0a20 2020 2023 2323 2320 4368  ", ".    #### Ch
-0004bc10: 6563 6b20 666f 7220 736b 6577 6564 2066  eck for skewed f
-0004bc20: 6c6f 6174 2063 6f6c 756d 6e73 2023 2323  loat columns ###
-0004bc30: 2323 2323 0a20 2020 2073 6b65 775f 636f  ####.    skew_co
-0004bc40: 6c73 3120 3d20 6e70 2e61 7272 6179 286e  ls1 = np.array(n
-0004bc50: 756d 5f63 6f6c 7329 5b5b 286e 702e 6162  um_cols)[[(np.ab
-0004bc60: 7328 6e70 2e72 6f75 6e64 2864 6174 615b  s(np.round(data[
-0004bc70: 636f 6c5d 2e73 6b65 7728 292c 2031 2929  col].skew(), 1))
-0004bc80: 203e 2031 0a20 2020 2020 2020 2020 2020   > 1.           
-0004bc90: 2020 2020 2020 2020 2029 2026 2028 6e70           ) & (np
-0004bca0: 2e61 6273 286e 702e 726f 756e 6428 6461  .abs(np.round(da
-0004bcb0: 7461 5b63 6f6c 5d2e 736b 6577 2829 2c20  ta[col].skew(), 
-0004bcc0: 3129 2920 3c3d 2035 2920 666f 7220 636f  1)) <= 5) for co
-0004bcd0: 6c20 696e 206e 756d 5f63 6f6c 735d 5d2e  l in num_cols]].
-0004bce0: 746f 6c69 7374 2829 0a20 2020 2073 6b65  tolist().    ske
-0004bcf0: 775f 636f 6c73 3220 3d20 6e70 2e61 7272  w_cols2 = np.arr
-0004bd00: 6179 286e 756d 5f63 6f6c 7329 5b5b 286e  ay(num_cols)[[(n
-0004bd10: 702e 6162 7328 6e70 2e72 6f75 6e64 2864  p.abs(np.round(d
-0004bd20: 6174 615b 636f 6c5d 2e73 6b65 7728 292c  ata[col].skew(),
-0004bd30: 2031 2929 203e 2035 2920 666f 7220 636f   1)) > 5) for co
-0004bd40: 6c20 696e 206e 756d 5f63 6f6c 735d 5d2e  l in num_cols]].
-0004bd50: 746f 6c69 7374 2829 0a20 2020 2073 6b65  tolist().    ske
-0004bd60: 775f 636f 6c73 203d 206c 6973 7428 7365  w_cols = list(se
-0004bd70: 7428 736b 6577 5f63 6f6c 7331 2b73 6b65  t(skew_cols1+ske
-0004bd80: 775f 636f 6c73 3229 290a 2020 2020 2323  w_cols2)).    ##
-0004bd90: 2320 4368 6563 6b20 666f 7220 736b 6577  # Check for skew
-0004bda0: 6564 2076 616c 7565 7320 696e 2063 6f6c  ed values in col
-0004bdb0: 756d 6e73 2023 2323 2323 0a20 2020 2069  umns #####.    i
-0004bdc0: 6620 6c65 6e28 736b 6577 5f63 6f6c 7331  f len(skew_cols1
-0004bdd0: 2920 3e20 303a 0a20 2020 2020 2020 2066  ) > 0:.        f
-0004bde0: 6f72 2078 2069 6e20 736b 6577 5f63 6f6c  or x in skew_col
-0004bdf0: 7331 3a0a 2020 2020 2020 2020 2020 2020  s1:.            
-0004be00: 6466 2e6c 6f63 5b78 2c6e 6577 636f 6c5d  df.loc[x,newcol]
-0004be10: 202b 3d20 6466 2e6c 6f63 5b78 2c27 6669   += df.loc[x,'fi
-0004be20: 7273 745f 636f 6d6d 6127 5d20 2b20 2773  rst_comma'] + 's
-0004be30: 6b65 7765 6420 636f 6c75 6d6e 3a20 6361  kewed column: ca
-0004be40: 7020 6f72 2064 726f 7020 706f 7373 6962  p or drop possib
-0004be50: 6c65 206f 7574 6c69 6572 7327 0a20 2020  le outliers'.   
-0004be60: 2020 2020 2020 2020 2064 662e 6c6f 635b           df.loc[
-0004be70: 782c 2766 6972 7374 5f63 6f6d 6d61 275d  x,'first_comma']
-0004be80: 203d 2022 2c20 220a 2020 2020 6966 206c   = ", ".    if l
-0004be90: 656e 2873 6b65 775f 636f 6c73 3229 203e  en(skew_cols2) >
-0004bea0: 2030 3a0a 2020 2020 2020 2020 666f 7220   0:.        for 
-0004beb0: 7820 696e 2073 6b65 775f 636f 6c73 323a  x in skew_cols2:
-0004bec0: 0a20 2020 2020 2020 2020 2020 2064 662e  .            df.
-0004bed0: 6c6f 635b 782c 6e65 7763 6f6c 5d20 2b3d  loc[x,newcol] +=
-0004bee0: 2064 662e 6c6f 635b 782c 2766 6972 7374   df.loc[x,'first
-0004bef0: 5f63 6f6d 6d61 275d 202b 2027 6869 6768  _comma'] + 'high
-0004bf00: 6c79 2073 6b65 7765 6420 636f 6c75 6d6e  ly skewed column
-0004bf10: 3a20 7265 6d6f 7665 206f 7574 6c69 6572  : remove outlier
-0004bf20: 7320 6f72 2064 6f20 626f 782d 636f 7820  s or do box-cox 
-0004bf30: 7472 616e 7366 6f72 6d27 0a20 2020 2020  transform'.     
-0004bf40: 2020 2020 2020 2064 662e 6c6f 635b 782c         df.loc[x,
-0004bf50: 2766 6972 7374 5f63 6f6d 6d61 275d 203d  'first_comma'] =
-0004bf60: 2022 2c20 220a 2020 2020 2323 2323 2320   ", ".    ##### 
-0004bf70: 446f 2074 6865 2073 616d 6520 666f 7220  Do the same for 
-0004bf80: 6d69 7865 6420 6474 7970 6520 636f 6c75  mixed dtype colu
-0004bf90: 6d6e 7320 2d20 7468 6579 206d 7573 7420  mns - they must 
-0004bfa0: 6265 2066 6978 6564 2120 2323 0a20 2020  be fixed! ##.   
-0004bfb0: 2069 6620 6c65 6e28 6d69 7865 645f 636f   if len(mixed_co
-0004bfc0: 6c73 2920 3e20 303a 0a20 2020 2020 2020  ls) > 0:.       
-0004bfd0: 2066 6f72 2078 2069 6e20 6d69 7865 645f   for x in mixed_
-0004bfe0: 636f 6c73 3a0a 2020 2020 2020 2020 2020  cols:.          
-0004bff0: 2020 6466 2e6c 6f63 5b78 2c6e 6577 636f    df.loc[x,newco
-0004c000: 6c5d 202b 3d20 6466 2e6c 6f63 5b78 2c27  l] += df.loc[x,'
-0004c010: 6669 7273 745f 636f 6d6d 6127 5d20 2b20  first_comma'] + 
-0004c020: 2766 6978 206d 6978 6564 2064 6174 6120  'fix mixed data 
-0004c030: 7479 7065 7327 0a20 2020 2020 2020 2020  types'.         
-0004c040: 2020 2064 662e 6c6f 635b 782c 2766 6972     df.loc[x,'fir
-0004c050: 7374 5f63 6f6d 6d61 275d 203d 2022 2c20  st_comma'] = ", 
-0004c060: 220a 2020 2020 6466 2e64 726f 7028 2766  ".    df.drop('f
-0004c070: 6972 7374 5f63 6f6d 6d61 272c 2061 7869  irst_comma', axi
-0004c080: 733d 312c 2069 6e70 6c61 6365 3d54 7275  s=1, inplace=Tru
-0004c090: 6529 0a20 2020 2072 6574 7572 6e20 6466  e).    return df
-0004c0a0: 0a23 2323 2323 2323 2323 2323 2323 2323  .###############
-0004c0b0: 2323 2323 2323 2323 2323 2323 2323 2323  ################
-0004c0c0: 2323 2323 2323 2323 2323 2323 2323 2323  ################
-0004c0d0: 2323 2323 2323 2323 2323 2323 2323 2323  ################
-0004c0e0: 2323 2323 2323 2323 2323 2323 2323 2323  ################
-0004c0f0: 2323 2323 0a64 6566 2064 6174 615f 7375  ####.def data_su
-0004c100: 6767 6573 7469 6f6e 7328 5829 3a0a 2020  ggestions(X):.  
-0004c110: 2020 6966 2069 7369 6e73 7461 6e63 6528    if isinstance(
-0004c120: 582c 2070 642e 4461 7461 4672 616d 6529  X, pd.DataFrame)
-0004c130: 3a0a 2020 2020 2020 2020 6466 7820 3d20  :.        dfx = 
-0004c140: 5f64 6174 615f 7375 6767 6573 7469 6f6e  _data_suggestion
-0004c150: 7328 5829 0a20 2020 2020 2020 2061 6c6c  s(X).        all
-0004c160: 5f72 6f77 7320 3d20 6466 782e 7368 6170  _rows = dfx.shap
-0004c170: 655b 305d 0a20 2020 2020 2020 2061 7820  e[0].        ax 
-0004c180: 3d20 6466 782e 6865 6164 2861 6c6c 5f72  = dfx.head(all_r
-0004c190: 6f77 7329 2e73 7479 6c65 2e62 6163 6b67  ows).style.backg
-0004c1a0: 726f 756e 645f 6772 6164 6965 6e74 2863  round_gradient(c
-0004c1b0: 6d61 703d 2752 6564 7327 292e 7365 745f  map='Reds').set_
-0004c1c0: 7072 6f70 6572 7469 6573 282a 2a7b 2766  properties(**{'f
-0004c1d0: 6f6e 742d 6661 6d69 6c79 273a 2027 5365  ont-family': 'Se
-0004c1e0: 676f 6520 5549 277d 290a 2020 2020 2020  goe UI'}).      
-0004c1f0: 2020 6469 7370 6c61 7928 6178 293b 0a20    display(ax);. 
-0004c200: 2020 2065 6c73 653a 0a20 2020 2020 2020     else:.       
-0004c210: 2070 7269 6e74 2822 496e 7075 7420 6d75   print("Input mu
-0004c220: 7374 2062 6520 6120 6461 7461 6672 616d  st be a datafram
-0004c230: 652e 2050 6c65 6173 6520 6368 6563 6b20  e. Please check 
-0004c240: 696e 7075 7420 616e 6420 7472 7920 6167  input and try ag
-0004c250: 6169 6e2e 2229 0a0a 2323 2323 2323 2323  ain.")..########
-0004c260: 2323 2323 2323 2323 2323 2323 2323 2323  ################
-0004c270: 2323 2323 2323 2323 2323 2323 2323 2323  ################
-0004c280: 2323 2323 2323 2323 2323 2323 2323 2323  ################
-0004c290: 2323 2323 2323 2323 2323 2323 2323 2323  ################
-0004c2a0: 2323 2323 2323 2323 2323 2323 2323 2323  ################
-0004c2b0: 2323 2323 0a23 2323 2323 2323 2323 2020  ####.#########  
-0004c2c0: 2054 6869 7320 6973 2077 6865 7265 2053   This is where S
-0004c2d0: 554c 4f43 4c41 5353 4946 4945 5220 616e  ULOCLASSIFIER an
-0004c2e0: 6420 5355 4c4f 5245 4752 4553 534f 5220  d SULOREGRESSOR 
-0004c2f0: 454e 4420 2020 2323 2323 2323 2323 2323  END   ##########
-0004c300: 2323 2323 2323 2323 2323 2323 2323 2323  ################
-0004c310: 230a 2323 2323 2323 2323 2323 2323 2323  #.##############
-0004c320: 2323 2323 2323 2323 2323 2323 2323 2323  ################
-0004c330: 2323 2323 2323 2323 2323 2323 2323 2323  ################
-0004c340: 2323 2323 2323 2323 2323 2323 2323 2323  ################
-0004c350: 2323 2323 2323 2323 2323 2323 2323 2323  ################
-0004c360: 2323 2323 2323 2323 2323 2323 2323 0a6d  ##############.m
-0004c370: 6f64 756c 655f 7479 7065 203d 2027 5275  odule_type = 'Ru
-0004c380: 6e6e 696e 6727 2069 6620 205f 5f6e 616d  nning' if  __nam
-0004c390: 655f 5f20 3d3d 2022 5f5f 6d61 696e 5f5f  e__ == "__main__
-0004c3a0: 2220 656c 7365 2027 496d 706f 7274 6564  " else 'Imported
-0004c3b0: 270a 7665 7273 696f 6e5f 6e75 6d62 6572  '.version_number
-0004c3c0: 203d 2020 2731 2e30 3027 0a70 7269 6e74   =  '1.00'.print
-0004c3d0: 2866 2222 227b 6d6f 6475 6c65 5f74 7970  (f"""{module_typ
-0004c3e0: 657d 204c 617a 7954 7261 6e73 666f 726d  e} LazyTransform
-0004c3f0: 6572 2076 6572 7369 6f6e 3a7b 7665 7273  er version:{vers
-0004c400: 696f 6e5f 6e75 6d62 6572 7d2e 2043 616c  ion_number}. Cal
-0004c410: 6c20 6279 2075 7369 6e67 3a0a 2020 2020  l by using:.    
-0004c420: 6c61 7a79 203d 204c 617a 7954 7261 6e73  lazy = LazyTrans
-0004c430: 666f 726d 6572 286d 6f64 656c 3d4e 6f6e  former(model=Non
-0004c440: 652c 2065 6e63 6f64 6572 733d 2761 7574  e, encoders='aut
-0004c450: 6f27 2c20 7363 616c 6572 733d 4e6f 6e65  o', scalers=None
-0004c460: 2c20 6461 7465 5f74 6f5f 7374 7269 6e67  , date_to_string
-0004c470: 3d46 616c 7365 2c0a 2020 2020 2020 2020  =False,.        
-0004c480: 7472 616e 7366 6f72 6d5f 7461 7267 6574  transform_target
-0004c490: 3d46 616c 7365 2c20 696d 6261 6c61 6e63  =False, imbalanc
-0004c4a0: 6564 3d46 616c 7365 2c20 7361 7665 3d46  ed=False, save=F
-0004c4b0: 616c 7365 2c20 636f 6d62 696e 655f 7261  alse, combine_ra
-0004c4c0: 7265 3d46 616c 7365 2c20 7665 7262 6f73  re=False, verbos
-0004c4d0: 653d 3029 0a20 2020 2023 2323 2069 6620  e=0).    ### if 
-0004c4e0: 796f 7520 6172 6520 6e6f 7420 7573 696e  you are not usin
-0004c4f0: 6720 6120 6d6f 6465 6c20 696e 2070 6970  g a model in pip
-0004c500: 656c 696e 652c 2079 6f75 206d 7573 7420  eline, you must 
-0004c510: 7573 6520 6669 7420 616e 6420 7472 616e  use fit and tran
-0004c520: 7366 6f72 6d20 2323 230a 2020 2020 2020  sform ###.      
-0004c530: 2020 585f 7472 6169 6e6d 2c20 795f 7472    X_trainm, y_tr
-0004c540: 6169 6e6d 203d 206c 617a 792e 6669 745f  ainm = lazy.fit_
-0004c550: 7472 616e 7366 6f72 6d28 585f 7472 6169  transform(X_trai
-0004c560: 6e2c 2079 5f74 7261 696e 290a 2020 2020  n, y_train).    
-0004c570: 2020 2020 585f 7465 7374 6d20 3d20 6c61      X_testm = la
-0004c580: 7a79 2e74 7261 6e73 666f 726d 2858 5f74  zy.transform(X_t
-0004c590: 6573 7429 0a20 2020 2023 2323 2049 6620  est).    ### If 
-0004c5a0: 7573 696e 6720 6120 6d6f 6465 6c20 696e  using a model in
-0004c5b0: 2070 6970 656c 696e 652c 2075 7365 2066   pipeline, use f
-0004c5c0: 6974 2061 6e64 2070 7265 6469 6374 206f  it and predict o
-0004c5d0: 6e6c 7920 2323 230a 2020 2020 2020 2020  nly ###.        
-0004c5e0: 6c61 7a79 2e66 6974 2858 5f74 7261 696e  lazy.fit(X_train
-0004c5f0: 2c20 795f 7472 6169 6e29 0a20 2020 2020  , y_train).     
-0004c600: 2020 206c 617a 792e 7072 6564 6963 7428     lazy.predict(
-0004c610: 585f 7465 7374 290a 2222 2229 0a23 2323  X_test).""").###
-0004c620: 2323 2323 2323 2323 2323 2323 2323 2323  ################
-0004c630: 2323 2323 2323 2323 2323 2323 2323 2323  ################
-0004c640: 2323 2323 2323 2323 2323 2323 2323 2323  ################
-0004c650: 2323 2323 2323 2323 2323 2323 2323 2323  ################
-0004c660: 2323 2323 2323 2323 2323 2323 2323 0a00  ##############..
-0004c670: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-0004c680: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-0004c690: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-0004c6a0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-0004c6b0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-0004c6c0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-0004c6d0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-0004c6e0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-0004c6f0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-0004c700: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-0004c710: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-0004c720: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-0004c730: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-0004c740: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-0004c750: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-0004c760: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-0004c770: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-0004c780: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-0004c790: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-0004c7a0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-0004c7b0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-0004c7c0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-0004c7d0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-0004c7e0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-0004c7f0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-0004c800: 2e2f 2e2f 4050 6178 4865 6164 6572 0000  ././@PaxHeader..
-0004c810: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-0004c820: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-0004c830: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-0004c840: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-0004c850: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-0004c860: 0000 0000 3030 3030 3030 3000 3030 3030  ....0000000.0000
-0004c870: 3030 3000 3030 3030 3030 3000 3030 3030  000.0000000.0000
-0004c880: 3030 3030 3032 3600 3030 3030 3030 3030  0000026.00000000
-0004c890: 3030 3000 3031 3134 3533 0020 7800 0000  000.011453. x...
-0004c8a0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-0004c8b0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-0004c8c0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-0004c8d0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-0004c8e0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-0004c8f0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-0004c900: 0075 7374 6172 0030 3000 0000 0000 0000  .ustar.00.......
-0004c910: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-0004c920: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-0004c930: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-0004c940: 0000 0000 0000 0000 0030 3030 3030 3030  .........0000000
-0004c950: 0030 3030 3030 3030 0000 0000 0000 0000  .0000000........
-0004c960: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-0004c970: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-0004c980: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-0004c990: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-0004c9a0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-0004c9b0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-0004c9c0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-0004c9d0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-0004c9e0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-0004c9f0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-0004ca00: 3232 206d 7469 6d65 3d31 3636 3130 3931  22 mtime=1661091
-0004ca10: 3338 372e 300a 0000 0000 0000 0000 0000  387.0...........
-0004ca20: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-0004ca30: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-0004ca40: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-0004ca50: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-0004ca60: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-0004ca70: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-0004ca80: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-0004ca90: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-0004caa0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-0004cab0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-0004cac0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-0004cad0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-0004cae0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-0004caf0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-0004cb00: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-0004cb10: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-0004cb20: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-0004cb30: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-0004cb40: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-0004cb50: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-0004cb60: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-0004cb70: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-0004cb80: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-0004cb90: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-0004cba0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-0004cbb0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-0004cbc0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-0004cbd0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-0004cbe0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-0004cbf0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-0004cc00: 6c61 7a79 7472 616e 7366 6f72 6d2d 312e  lazytransform-1.
-0004cc10: 302f 7265 7175 6972 656d 656e 7473 2e74  0/requirements.t
-0004cc20: 7874 0000 0000 0000 0000 0000 0000 0000  xt..............
-0004cc30: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-0004cc40: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-0004cc50: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-0004cc60: 0000 0000 3030 3030 3737 3700 3030 3031  ....0000777.0001
-0004cc70: 3735 3000 3030 3031 3735 3000 3030 3030  750.0001750.0000
-0004cc80: 3030 3030 3232 3300 3030 3030 3030 3030  0000223.00000000
-0004cc90: 3030 3000 3031 3731 3336 0020 3000 0000  000.017136. 0...
-0004cca0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-0004ccb0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-0004ccc0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-0004ccd0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-0004cce0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-0004ccf0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-0004cd00: 0075 7374 6172 0030 3072 616d 0000 0000  .ustar.00ram....
-0004cd10: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-0004cd20: 0000 0000 0000 0000 0072 616d 0000 0000  .........ram....
-0004cd30: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-0004cd40: 0000 0000 0000 0000 0030 3030 3030 3030  .........0000000
-0004cd50: 0030 3030 3030 3030 0000 0000 0000 0000  .0000000........
-0004cd60: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-0004cd70: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-0004cd80: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-0004cd90: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-0004cda0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-0004cdb0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-0004cdc0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-0004cdd0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-0004cde0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-0004cdf0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-0004ce00: 6e75 6d70 797e 3d31 2e31 392e 350d 0a70  numpy~=1.19.5..p
-0004ce10: 616e 6461 733e 3d31 2e30 2e30 0d0a 6d61  andas>=1.0.0..ma
-0004ce20: 7470 6c6f 746c 6962 0d0a 7363 696b 6974  tplotlib..scikit
-0004ce30: 2d6c 6561 726e 3c3d 302e 3234 2e32 0d0a  -learn<=0.24.2..
-0004ce40: 696d 6261 6c61 6e63 6564 2d6c 6561 726e  imbalanced-learn
-0004ce50: 3e3d 302e 370d 0a78 6c72 640d 0a63 6174  >=0.7..xlrd..cat
-0004ce60: 6567 6f72 792d 656e 636f 6465 7273 3c3d  egory-encoders<=
-0004ce70: 322e 342e 300d 0a69 6d62 616c 616e 6365  2.4.0..imbalance
-0004ce80: 642d 656e 7365 6d62 6c65 3e3d 302e 312e  d-ensemble>=0.1.
-0004ce90: 370d 0a00 0000 0000 0000 0000 0000 0000  7...............
-0004cea0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-0004ceb0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-0004cec0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-0004ced0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-0004cee0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-0004cef0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-0004cf00: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-0004cf10: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-0004cf20: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-0004cf30: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-0004cf40: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-0004cf50: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-0004cf60: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-0004cf70: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-0004cf80: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-0004cf90: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-0004cfa0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-0004cfb0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-0004cfc0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-0004cfd0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-0004cfe0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-0004cff0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-0004d000: 2e2f 2e2f 4050 6178 4865 6164 6572 0000  ././@PaxHeader..
-0004d010: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-0004d020: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-0004d030: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-0004d040: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-0004d050: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-0004d060: 0000 0000 3030 3030 3030 3000 3030 3030  ....0000000.0000
-0004d070: 3030 3000 3030 3030 3030 3000 3030 3030  000.0000000.0000
-0004d080: 3030 3030 3033 3300 3030 3030 3030 3030  0000033.00000000
-0004d090: 3030 3000 3031 3134 3531 0020 7800 0000  000.011451. x...
-0004d0a0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-0004d0b0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-0004d0c0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-0004d0d0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-0004d0e0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-0004d0f0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-0004d100: 0075 7374 6172 0030 3000 0000 0000 0000  .ustar.00.......
-0004d110: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-0004d120: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-0004d130: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-0004d140: 0000 0000 0000 0000 0030 3030 3030 3030  .........0000000
-0004d150: 0030 3030 3030 3030 0000 0000 0000 0000  .0000000........
-0004d160: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-0004d170: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-0004d180: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-0004d190: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-0004d1a0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-0004d1b0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-0004d1c0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-0004d1d0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-0004d1e0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-0004d1f0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-0004d200: 3237 206d 7469 6d65 3d31 3636 3432 3832  27 mtime=1664282
-0004d210: 3237 342e 3333 3339 3133 0a00 0000 0000  274.333913......
-0004d220: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-0004d230: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-0004d240: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-0004d250: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-0004d260: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-0004d270: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-0004d280: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-0004d290: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-0004d2a0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-0004d2b0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-0004d2c0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-0004d2d0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-0004d2e0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-0004d2f0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-0004d300: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-0004d310: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-0004d320: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-0004d330: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-0004d340: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-0004d350: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-0004d360: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-0004d370: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-0004d380: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-0004d390: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-0004d3a0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-0004d3b0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-0004d3c0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-0004d3d0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-0004d3e0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-0004d3f0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-0004d400: 6c61 7a79 7472 616e 7366 6f72 6d2d 312e  lazytransform-1.
-0004d410: 302f 7365 7475 702e 6366 6700 0000 0000  0/setup.cfg.....
-0004d420: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-0004d430: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-0004d440: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-0004d450: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-0004d460: 0000 0000 3030 3030 3737 3700 3030 3031  ....0000777.0001
-0004d470: 3735 3000 3030 3031 3735 3000 3030 3030  750.0001750.0000
-0004d480: 3030 3030 3034 3600 3030 3030 3030 3030  0000046.00000000
-0004d490: 3030 3000 3031 3534 3736 0020 3000 0000  000.015476. 0...
-0004d4a0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-0004d4b0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-0004d4c0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-0004d4d0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-0004d4e0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-0004d4f0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-0004d500: 0075 7374 6172 0030 3072 616d 0000 0000  .ustar.00ram....
-0004d510: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-0004d520: 0000 0000 0000 0000 0072 616d 0000 0000  .........ram....
-0004d530: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-0004d540: 0000 0000 0000 0000 0030 3030 3030 3030  .........0000000
-0004d550: 0030 3030 3030 3030 0000 0000 0000 0000  .0000000........
-0004d560: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-0004d570: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-0004d580: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-0004d590: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-0004d5a0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-0004d5b0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-0004d5c0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-0004d5d0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-0004d5e0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-0004d5f0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-0004d600: 5b65 6767 5f69 6e66 6f5d 0a74 6167 5f62  [egg_info].tag_b
-0004d610: 7569 6c64 203d 200a 7461 675f 6461 7465  uild = .tag_date
-0004d620: 203d 2030 0a0a 0000 0000 0000 0000 0000   = 0............
-0004d630: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-0004d640: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-0004d650: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-0004d660: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-0004d670: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-0004d680: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-0004d690: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-0004d6a0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-0004d6b0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-0004d6c0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-0004d6d0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-0004d6e0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-0004d6f0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-0004d700: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-0004d710: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-0004d720: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-0004d730: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-0004d740: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-0004d750: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-0004d760: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-0004d770: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-0004d780: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-0004d790: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-0004d7a0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-0004d7b0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-0004d7c0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-0004d7d0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-0004d7e0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-0004d7f0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-0004d800: 2e2f 2e2f 4050 6178 4865 6164 6572 0000  ././@PaxHeader..
-0004d810: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-0004d820: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-0004d830: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-0004d840: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-0004d850: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-0004d860: 0000 0000 3030 3030 3030 3000 3030 3030  ....0000000.0000
-0004d870: 3030 3000 3030 3030 3030 3000 3030 3030  000.0000000.0000
-0004d880: 3030 3030 3032 3600 3030 3030 3030 3030  0000026.00000000
-0004d890: 3030 3000 3031 3134 3533 0020 7800 0000  000.011453. x...
-0004d8a0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-0004d8b0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-0004d8c0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-0004d8d0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-0004d8e0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-0004d8f0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-0004d900: 0075 7374 6172 0030 3000 0000 0000 0000  .ustar.00.......
-0004d910: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-0004d920: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-0004d930: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-0004d940: 0000 0000 0000 0000 0030 3030 3030 3030  .........0000000
-0004d950: 0030 3030 3030 3030 0000 0000 0000 0000  .0000000........
-0004d960: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-0004d970: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-0004d980: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-0004d990: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-0004d9a0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-0004d9b0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-0004d9c0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-0004d9d0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-0004d9e0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-0004d9f0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-0004da00: 3232 206d 7469 6d65 3d31 3636 3432 3832  22 mtime=1664282
-0004da10: 3230 362e 300a 0000 0000 0000 0000 0000  206.0...........
-0004da20: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-0004da30: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-0004da40: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-0004da50: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-0004da60: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-0004da70: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-0004da80: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-0004da90: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-0004daa0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-0004dab0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-0004dac0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-0004dad0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-0004dae0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-0004daf0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-0004db00: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-0004db10: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-0004db20: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-0004db30: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-0004db40: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-0004db50: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-0004db60: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-0004db70: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-0004db80: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-0004db90: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-0004dba0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-0004dbb0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-0004dbc0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-0004dbd0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-0004dbe0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-0004dbf0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-0004dc00: 6c61 7a79 7472 616e 7366 6f72 6d2d 312e  lazytransform-1.
-0004dc10: 302f 7365 7475 702e 7079 0000 0000 0000  0/setup.py......
-0004dc20: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-0004dc30: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-0004dc40: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-0004dc50: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-0004dc60: 0000 0000 3030 3030 3737 3700 3030 3031  ....0000777.0001
-0004dc70: 3735 3000 3030 3031 3735 3000 3030 3030  750.0001750.0000
-0004dc80: 3030 3032 3036 3400 3030 3030 3030 3030  0002064.00000000
-0004dc90: 3030 3000 3031 3533 3731 0020 3000 0000  000.015371. 0...
-0004dca0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-0004dcb0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-0004dcc0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-0004dcd0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-0004dce0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-0004dcf0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-0004dd00: 0075 7374 6172 0030 3072 616d 0000 0000  .ustar.00ram....
-0004dd10: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-0004dd20: 0000 0000 0000 0000 0072 616d 0000 0000  .........ram....
-0004dd30: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-0004dd40: 0000 0000 0000 0000 0030 3030 3030 3030  .........0000000
-0004dd50: 0030 3030 3030 3030 0000 0000 0000 0000  .0000000........
-0004dd60: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-0004dd70: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-0004dd80: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-0004dd90: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-0004dda0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-0004ddb0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-0004ddc0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-0004ddd0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-0004dde0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-0004ddf0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-0004de00: 696d 706f 7274 2073 6574 7570 746f 6f6c  import setuptool
-0004de10: 730d 0a0d 0a77 6974 6820 6f70 656e 2822  s....with open("
-0004de20: 5245 4144 4d45 2e6d 6422 2c20 2272 222c  README.md", "r",
-0004de30: 2065 6e63 6f64 696e 673d 2275 7466 2d38   encoding="utf-8
-0004de40: 2229 2061 7320 6668 3a0d 0a20 2020 206c  ") as fh:..    l
-0004de50: 6f6e 675f 6465 7363 7269 7074 696f 6e20  ong_description 
-0004de60: 3d20 6668 2e72 6561 6428 290d 0a0d 0a73  = fh.read()....s
-0004de70: 6574 7570 746f 6f6c 732e 7365 7475 7028  etuptools.setup(
-0004de80: 0d0a 2020 2020 6e61 6d65 3d22 6c61 7a79  ..    name="lazy
-0004de90: 7472 616e 7366 6f72 6d22 2c0d 0a20 2020  transform",..   
-0004dea0: 2076 6572 7369 6f6e 3d22 312e 3030 222c   version="1.00",
-0004deb0: 0d0a 2020 2020 6175 7468 6f72 3d22 5261  ..    author="Ra
-0004dec0: 6d20 5365 7368 6164 7269 222c 0d0a 2020  m Seshadri",..  
-0004ded0: 2020 2320 6175 7468 6f72 5f65 6d61 696c    # author_email
-0004dee0: 3d22 6175 7468 6f72 4065 7861 6d70 6c65  ="author@example
-0004def0: 2e63 6f6d 222c 0d0a 2020 2020 6465 7363  .com",..    desc
-0004df00: 7269 7074 696f 6e3d 2241 7574 6f6d 6174  ription="Automat
-0004df10: 6963 616c 6c79 2062 7569 6c64 2064 6174  ically build dat
-0004df20: 6120 616e 6420 6d6f 6465 6c20 7069 7065  a and model pipe
-0004df30: 6c69 6e65 7320 7573 696e 6720 7363 696b  lines using scik
-0004df40: 6974 2d6c 6561 726e 2069 6e20 6120 7369  it-learn in a si
-0004df50: 6e67 6c65 206c 696e 6520 6f66 2063 6f64  ngle line of cod
-0004df60: 6522 2c0d 0a20 2020 206c 6f6e 675f 6465  e",..    long_de
-0004df70: 7363 7269 7074 696f 6e3d 6c6f 6e67 5f64  scription=long_d
-0004df80: 6573 6372 6970 7469 6f6e 2c0d 0a20 2020  escription,..   
-0004df90: 206c 6f6e 675f 6465 7363 7269 7074 696f   long_descriptio
-0004dfa0: 6e5f 636f 6e74 656e 745f 7479 7065 3d22  n_content_type="
-0004dfb0: 7465 7874 2f6d 6172 6b64 6f77 6e22 2c0d  text/markdown",.
-0004dfc0: 0a20 2020 206c 6963 656e 7365 3d27 4170  .    license='Ap
-0004dfd0: 6163 6865 204c 6963 656e 7365 2032 2e30  ache License 2.0
-0004dfe0: 272c 0d0a 2020 2020 7572 6c3d 2268 7474  ',..    url="htt
-0004dff0: 7073 3a2f 2f67 6974 6875 622e 636f 6d2f  ps://github.com/
-0004e000: 4175 746f 5669 4d4c 2f6c 617a 7974 7261  AutoViML/lazytra
-0004e010: 6e73 666f 726d 222c 0d0a 2020 2020 7079  nsform",..    py
-0004e020: 5f6d 6f64 756c 6573 203d 205b 226c 617a  _modules = ["laz
-0004e030: 7974 7261 6e73 666f 726d 225d 2c0d 0a20  ytransform"],.. 
-0004e040: 2020 2070 6163 6b61 6765 733d 7365 7475     packages=setu
-0004e050: 7074 6f6f 6c73 2e66 696e 645f 7061 636b  ptools.find_pack
-0004e060: 6167 6573 2865 7863 6c75 6465 3d28 2274  ages(exclude=("t
-0004e070: 6573 7473 222c 2929 2c0d 0a20 2020 2069  ests",)),..    i
-0004e080: 6e73 7461 6c6c 5f72 6571 7569 7265 733d  nstall_requires=
-0004e090: 5b0d 0a20 2020 2020 2020 2022 6e75 6d70  [..        "nump
-0004e0a0: 793e 3d31 2e32 312e 3522 2c0d 0a20 2020  y>=1.21.5",..   
-0004e0b0: 2020 2020 2022 7061 6e64 6173 3e3d 312e       "pandas>=1.
-0004e0c0: 332e 3522 2c0d 0a20 2020 2020 2020 2022  3.5",..        "
-0004e0d0: 6d61 7470 6c6f 746c 6962 222c 0d0a 2020  matplotlib",..  
-0004e0e0: 2020 2020 2020 2273 6369 6b69 742d 6c65        "scikit-le
-0004e0f0: 6172 6e3c 3d30 2e32 342e 3222 2c0d 0a20  arn<=0.24.2",.. 
-0004e100: 2020 2020 2020 2022 696d 6261 6c61 6e63         "imbalanc
-0004e110: 6564 2d6c 6561 726e 3e3d 302e 3722 2c0d  ed-learn>=0.7",.
-0004e120: 0a20 2020 2020 2020 2022 6361 7465 676f  .        "catego
-0004e130: 7279 2d65 6e63 6f64 6572 737e 3d32 2e34  ry-encoders~=2.4
-0004e140: 222c 0d0a 2020 2020 2020 2020 2278 6c72  ",..        "xlr
-0004e150: 6422 2c0d 0a20 2020 2020 2020 2022 696d  d",..        "im
-0004e160: 6261 6c61 6e63 6564 2d65 6e73 656d 626c  balanced-ensembl
-0004e170: 653e 3d30 2e31 2e37 222c 0d0a 2020 2020  e>=0.1.7",..    
-0004e180: 2020 2020 2274 7164 6d22 2c0d 0a20 2020      "tqdm",..   
-0004e190: 205d 2c0d 0a20 2020 2069 6e63 6c75 6465   ],..    include
-0004e1a0: 5f70 6163 6b61 6765 5f64 6174 6120 3d20  _package_data = 
-0004e1b0: 5472 7565 2c0d 0a20 2020 2063 6c61 7373  True,..    class
-0004e1c0: 6966 6965 7273 3d5b 0d0a 2020 2020 2020  ifiers=[..      
-0004e1d0: 2020 2250 726f 6772 616d 6d69 6e67 204c    "Programming L
-0004e1e0: 616e 6775 6167 6520 3a3a 2050 7974 686f  anguage :: Pytho
-0004e1f0: 6e20 3a3a 2033 222c 0d0a 2020 2020 2020  n :: 3",..      
-0004e200: 2020 224f 7065 7261 7469 6e67 2053 7973    "Operating Sys
-0004e210: 7465 6d20 3a3a 204f 5320 496e 6465 7065  tem :: OS Indepe
-0004e220: 6e64 656e 7422 2c0d 0a20 2020 205d 2c0d  ndent",..    ],.
-0004e230: 0a29 0d0a 0000 0000 0000 0000 0000 0000  .)..............
-0004e240: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-0004e250: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-0004e260: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-0004e270: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-0004e280: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-0004e290: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-0004e2a0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-0004e2b0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-0004e2c0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-0004e2d0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-0004e2e0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-0004e2f0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-0004e300: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-0004e310: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-0004e320: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-0004e330: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-0004e340: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-0004e350: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-0004e360: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-0004e370: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-0004e380: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-0004e390: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-0004e3a0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-0004e3b0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-0004e3c0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-0004e3d0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-0004e3e0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-0004e3f0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-0004e400: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-0004e410: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-0004e420: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-0004e430: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-0004e440: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-0004e450: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-0004e460: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-0004e470: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-0004e480: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-0004e490: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-0004e4a0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-0004e4b0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-0004e4c0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-0004e4d0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-0004e4e0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-0004e4f0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-0004e500: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-0004e510: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-0004e520: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-0004e530: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-0004e540: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-0004e550: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-0004e560: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-0004e570: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-0004e580: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-0004e590: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-0004e5a0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-0004e5b0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-0004e5c0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-0004e5d0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-0004e5e0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-0004e5f0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-0004e600: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-0004e610: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-0004e620: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-0004e630: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-0004e640: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-0004e650: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-0004e660: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-0004e670: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-0004e680: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-0004e690: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-0004e6a0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-0004e6b0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-0004e6c0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-0004e6d0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-0004e6e0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-0004e6f0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-0004e700: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-0004e710: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-0004e720: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-0004e730: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-0004e740: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-0004e750: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-0004e760: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-0004e770: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-0004e780: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-0004e790: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-0004e7a0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-0004e7b0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-0004e7c0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-0004e7d0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-0004e7e0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-0004e7f0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-0004e800: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-0004e810: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-0004e820: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-0004e830: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-0004e840: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-0004e850: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-0004e860: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-0004e870: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-0004e880: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-0004e890: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-0004e8a0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-0004e8b0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-0004e8c0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-0004e8d0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-0004e8e0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-0004e8f0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-0004e900: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-0004e910: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-0004e920: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-0004e930: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-0004e940: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-0004e950: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-0004e960: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-0004e970: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-0004e980: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-0004e990: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-0004e9a0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-0004e9b0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-0004e9c0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-0004e9d0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-0004e9e0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-0004e9f0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-0004ea00: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-0004ea10: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-0004ea20: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-0004ea30: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-0004ea40: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-0004ea50: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-0004ea60: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-0004ea70: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-0004ea80: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-0004ea90: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-0004eaa0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-0004eab0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-0004eac0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-0004ead0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-0004eae0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-0004eaf0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-0004eb00: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-0004eb10: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-0004eb20: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-0004eb30: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-0004eb40: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-0004eb50: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-0004eb60: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-0004eb70: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-0004eb80: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-0004eb90: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-0004eba0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-0004ebb0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-0004ebc0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-0004ebd0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-0004ebe0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-0004ebf0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-0004ec00: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-0004ec10: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-0004ec20: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-0004ec30: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-0004ec40: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-0004ec50: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-0004ec60: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-0004ec70: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-0004ec80: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-0004ec90: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-0004eca0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-0004ecb0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-0004ecc0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-0004ecd0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-0004ece0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-0004ecf0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-0004ed00: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-0004ed10: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-0004ed20: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-0004ed30: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-0004ed40: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-0004ed50: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-0004ed60: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-0004ed70: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-0004ed80: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-0004ed90: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-0004eda0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-0004edb0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-0004edc0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-0004edd0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-0004ede0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-0004edf0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-0004ee00: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-0004ee10: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-0004ee20: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-0004ee30: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-0004ee40: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-0004ee50: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-0004ee60: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-0004ee70: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-0004ee80: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-0004ee90: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-0004eea0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-0004eeb0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-0004eec0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-0004eed0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-0004eee0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-0004eef0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-0004ef00: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-0004ef10: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-0004ef20: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-0004ef30: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-0004ef40: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-0004ef50: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-0004ef60: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-0004ef70: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-0004ef80: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-0004ef90: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-0004efa0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-0004efb0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-0004efc0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-0004efd0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-0004efe0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-0004eff0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-0004f000: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-0004f010: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-0004f020: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-0004f030: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-0004f040: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-0004f050: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-0004f060: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-0004f070: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-0004f080: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-0004f090: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-0004f0a0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-0004f0b0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-0004f0c0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-0004f0d0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-0004f0e0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-0004f0f0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-0004f100: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-0004f110: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-0004f120: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-0004f130: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-0004f140: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-0004f150: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-0004f160: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-0004f170: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-0004f180: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-0004f190: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-0004f1a0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-0004f1b0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-0004f1c0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-0004f1d0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-0004f1e0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-0004f1f0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-0004f200: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-0004f210: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-0004f220: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-0004f230: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-0004f240: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-0004f250: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-0004f260: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-0004f270: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-0004f280: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-0004f290: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-0004f2a0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-0004f2b0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-0004f2c0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-0004f2d0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-0004f2e0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-0004f2f0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-0004f300: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-0004f310: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-0004f320: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-0004f330: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-0004f340: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-0004f350: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-0004f360: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-0004f370: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-0004f380: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-0004f390: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-0004f3a0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-0004f3b0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-0004f3c0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-0004f3d0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-0004f3e0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-0004f3f0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-0004f400: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-0004f410: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-0004f420: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-0004f430: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-0004f440: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-0004f450: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-0004f460: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-0004f470: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-0004f480: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-0004f490: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-0004f4a0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-0004f4b0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-0004f4c0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-0004f4d0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-0004f4e0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-0004f4f0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-0004f500: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-0004f510: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-0004f520: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-0004f530: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-0004f540: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-0004f550: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-0004f560: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-0004f570: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-0004f580: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-0004f590: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-0004f5a0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-0004f5b0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-0004f5c0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-0004f5d0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-0004f5e0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-0004f5f0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-0004f600: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-0004f610: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-0004f620: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-0004f630: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-0004f640: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-0004f650: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-0004f660: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-0004f670: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-0004f680: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-0004f690: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-0004f6a0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-0004f6b0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-0004f6c0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-0004f6d0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-0004f6e0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-0004f6f0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-0004f700: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-0004f710: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-0004f720: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-0004f730: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-0004f740: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-0004f750: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-0004f760: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-0004f770: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-0004f780: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-0004f790: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-0004f7a0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-0004f7b0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-0004f7c0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-0004f7d0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-0004f7e0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-0004f7f0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-0004f800: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-0004f810: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-0004f820: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-0004f830: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-0004f840: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-0004f850: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-0004f860: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-0004f870: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-0004f880: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-0004f890: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-0004f8a0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-0004f8b0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-0004f8c0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-0004f8d0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-0004f8e0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-0004f8f0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-0004f900: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-0004f910: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-0004f920: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-0004f930: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-0004f940: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-0004f950: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-0004f960: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-0004f970: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-0004f980: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-0004f990: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-0004f9a0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-0004f9b0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-0004f9c0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-0004f9d0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-0004f9e0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-0004f9f0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-0004fa00: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-0004fa10: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-0004fa20: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-0004fa30: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-0004fa40: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-0004fa50: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-0004fa60: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-0004fa70: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-0004fa80: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-0004fa90: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-0004faa0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-0004fab0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-0004fac0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-0004fad0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-0004fae0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-0004faf0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-0004fb00: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-0004fb10: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-0004fb20: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-0004fb30: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-0004fb40: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-0004fb50: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-0004fb60: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-0004fb70: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-0004fb80: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-0004fb90: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-0004fba0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-0004fbb0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-0004fbc0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-0004fbd0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-0004fbe0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-0004fbf0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-0004fc00: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-0004fc10: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-0004fc20: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-0004fc30: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-0004fc40: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-0004fc50: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-0004fc60: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-0004fc70: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-0004fc80: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-0004fc90: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-0004fca0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-0004fcb0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-0004fcc0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-0004fcd0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-0004fce0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-0004fcf0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-0004fd00: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-0004fd10: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-0004fd20: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-0004fd30: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-0004fd40: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-0004fd50: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-0004fd60: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-0004fd70: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-0004fd80: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-0004fd90: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-0004fda0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-0004fdb0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-0004fdc0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-0004fdd0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-0004fde0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-0004fdf0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-0004fe00: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-0004fe10: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-0004fe20: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-0004fe30: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-0004fe40: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-0004fe50: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-0004fe60: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-0004fe70: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-0004fe80: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-0004fe90: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-0004fea0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-0004feb0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-0004fec0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-0004fed0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-0004fee0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-0004fef0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-0004ff00: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-0004ff10: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-0004ff20: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-0004ff30: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-0004ff40: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-0004ff50: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-0004ff60: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-0004ff70: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-0004ff80: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-0004ff90: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-0004ffa0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-0004ffb0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-0004ffc0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-0004ffd0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-0004ffe0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-0004fff0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+00044b30: 2020 2020 3130 302a 6e70 2e73 756d 2879      100*np.sum(y
+00044b40: 5f74 7275 652d 795f 7072 6564 7329 2f6e  _true-y_preds)/n
+00044b50: 702e 7375 6d28 795f 7472 7565 2929 290a  p.sum(y_true))).
+00044b60: 2020 2020 2020 2020 2020 2020 7072 696e              prin
+00044b70: 7428 2720 2020 204d 4150 4520 3d20 2530  t('    MAPE = %0
+00044b80: 2e30 6625 2527 2025 2831 3030 2a4d 4150  .0f%%' %(100*MAP
+00044b90: 4528 795f 7472 7565 2c20 795f 7072 6564  E(y_true, y_pred
+00044ba0: 7329 2929 0a20 2020 2070 7269 6e74 2827  s))).    print('
+00044bb0: 2020 2020 522d 5371 7561 7265 6420 3d20      R-Squared = 
+00044bc0: 2530 2e30 6625 2527 2025 2831 3030 2a72  %0.0f%%' %(100*r
+00044bd0: 325f 7363 6f72 6528 795f 7472 7565 2c20  2_score(y_true, 
+00044be0: 795f 7072 6564 7329 2929 0a20 2020 2070  y_preds))).    p
+00044bf0: 6c6f 745f 7265 6772 6573 7369 6f6e 2879  lot_regression(y
+00044c00: 5f74 7275 652c 2079 5f70 7265 6473 2c20  _true, y_preds, 
+00044c10: 6368 6172 743d 2773 6361 7474 6572 2729  chart='scatter')
+00044c20: 0a20 2020 2072 6574 7572 6e20 6561 6368  .    return each
+00044c30: 5f72 6d73 650a 2323 2323 2323 2323 2323  _rmse.##########
+00044c40: 2323 2323 2323 2323 2323 2323 2323 2323  ################
+00044c50: 2323 2323 2323 2323 2323 2323 2323 2323  ################
+00044c60: 2323 2323 2323 2323 2323 2323 2323 2323  ################
+00044c70: 2323 2323 2323 2323 2323 2323 2323 2323  ################
+00044c80: 2323 2323 2323 0a64 6566 2070 7269 6e74  ######.def print
+00044c90: 5f73 7461 7469 635f 726d 7365 2861 6374  _static_rmse(act
+00044ca0: 7561 6c2c 2070 7265 6469 6374 6564 2c20  ual, predicted, 
+00044cb0: 7374 6172 745f 6672 6f6d 3d30 2c76 6572  start_from=0,ver
+00044cc0: 626f 7365 3d30 293a 0a20 2020 2022 2222  bose=0):.    """
+00044cd0: 0a20 2020 2074 6869 7320 6361 6c63 756c  .    this calcul
+00044ce0: 6174 6573 2074 6865 2072 6174 696f 206f  ates the ratio o
+00044cf0: 6620 7468 6520 726d 7365 2065 7272 6f72  f the rmse error
+00044d00: 2074 6f20 7468 6520 7374 616e 6461 7264   to the standard
+00044d10: 2064 6576 6961 7469 6f6e 206f 6620 7468   deviation of th
+00044d20: 6520 6163 7475 616c 732e 0a20 2020 2054  e actuals..    T
+00044d30: 6869 7320 7261 7469 6f20 7368 6f75 6c64  his ratio should
+00044d40: 2062 6520 6265 6c6f 7720 3120 666f 7220   be below 1 for 
+00044d50: 6120 6d6f 6465 6c20 746f 2062 6520 636f  a model to be co
+00044d60: 6e73 6964 6572 6564 2075 7365 6675 6c2e  nsidered useful.
+00044d70: 0a20 2020 2054 6865 2063 6f6d 7061 7269  .    The compari
+00044d80: 736f 6e20 7374 6172 7473 2066 726f 6d20  son starts from 
+00044d90: 7468 6520 726f 7720 696e 6469 6361 7465  the row indicate
+00044da0: 6420 696e 2074 6865 2022 7374 6172 745f  d in the "start_
+00044db0: 6672 6f6d 2220 7661 7269 6162 6c65 2e0a  from" variable..
+00044dc0: 2020 2020 2222 220a 2020 2020 726d 7365      """.    rmse
+00044dd0: 203d 206e 702e 7371 7274 286d 6561 6e5f   = np.sqrt(mean_
+00044de0: 7371 7561 7265 645f 6572 726f 7228 6163  squared_error(ac
+00044df0: 7475 616c 5b73 7461 7274 5f66 726f 6d3a  tual[start_from:
+00044e00: 5d2c 7072 6564 6963 7465 645b 7374 6172  ],predicted[star
+00044e10: 745f 6672 6f6d 3a5d 2929 0a20 2020 2073  t_from:])).    s
+00044e20: 7464 5f64 6576 203d 2061 6374 7561 6c5b  td_dev = actual[
+00044e30: 7374 6172 745f 6672 6f6d 3a5d 2e73 7464  start_from:].std
+00044e40: 2829 0a20 2020 2069 6620 7665 7262 6f73  ().    if verbos
+00044e50: 6520 3e3d 2031 3a0a 2020 2020 2020 2020  e >= 1:.        
+00044e60: 7072 696e 7428 2720 2020 2052 4d53 4520  print('    RMSE 
+00044e70: 3d20 2530 2e32 6627 2025 726d 7365 290a  = %0.2f' %rmse).
+00044e80: 2020 2020 2020 2020 7072 696e 7428 2720          print(' 
+00044e90: 2020 2053 7464 2044 6576 6961 7469 6f6e     Std Deviation
+00044ea0: 206f 6620 4163 7475 616c 7320 3d20 2530   of Actuals = %0
+00044eb0: 2e32 6627 2025 2873 7464 5f64 6576 2929  .2f' %(std_dev))
+00044ec0: 0a20 2020 2020 2020 2070 7269 6e74 2827  .        print('
+00044ed0: 2020 2020 4e6f 726d 616c 697a 6564 2052      Normalized R
+00044ee0: 4d53 4520 3d20 2530 2e31 6625 2527 2025  MSE = %0.1f%%' %
+00044ef0: 2872 6d73 652a 3130 302f 7374 645f 6465  (rmse*100/std_de
+00044f00: 7629 290a 2020 2020 7265 7475 726e 2072  v)).    return r
+00044f10: 6d73 652c 2072 6d73 652f 7374 645f 6465  mse, rmse/std_de
+00044f20: 760a 2323 2323 2323 2323 2323 2323 2323  v.##############
+00044f30: 2323 2323 2323 2323 2323 2323 2323 2323  ################
+00044f40: 2323 2323 2323 2323 2323 2323 2323 2323  ################
+00044f50: 2323 2323 2323 2323 2323 2323 2323 2323  ################
+00044f60: 2323 2323 2323 2323 2323 2323 2323 2323  ################
+00044f70: 2323 0a66 726f 6d20 736b 6c65 6172 6e2e  ##.from sklearn.
+00044f80: 6d65 7472 6963 7320 696d 706f 7274 206d  metrics import m
+00044f90: 6561 6e5f 7371 7561 7265 645f 6572 726f  ean_squared_erro
+00044fa0: 722c 6d65 616e 5f61 6273 6f6c 7574 655f  r,mean_absolute_
+00044fb0: 6572 726f 720a 6465 6620 7072 696e 745f  error.def print_
+00044fc0: 726d 7365 2879 2c20 795f 6861 7429 3a0a  rmse(y, y_hat):.
+00044fd0: 2020 2020 2222 220a 2020 2020 4361 6c63      """.    Calc
+00044fe0: 756c 6174 696e 6720 526f 6f74 204d 6561  ulating Root Mea
+00044ff0: 6e20 5371 7561 7265 2045 7272 6f72 2068  n Square Error h
+00045000: 7474 7073 3a2f 2f65 6e2e 7769 6b69 7065  ttps://en.wikipe
+00045010: 6469 612e 6f72 672f 7769 6b69 2f52 6f6f  dia.org/wiki/Roo
+00045020: 742d 6d65 616e 2d73 7175 6172 655f 6465  t-mean-square_de
+00045030: 7669 6174 696f 6e0a 2020 2020 2222 220a  viation.    """.
+00045040: 2020 2020 6d73 6520 3d20 6e70 2e6d 6561      mse = np.mea
+00045050: 6e28 2879 202d 2079 5f68 6174 292a 2a32  n((y - y_hat)**2
+00045060: 290a 2020 2020 7265 7475 726e 206e 702e  ).    return np.
+00045070: 7371 7274 286d 7365 290a 0a64 6566 2070  sqrt(mse)..def p
+00045080: 7269 6e74 5f6d 6170 6528 792c 2079 5f68  rint_mape(y, y_h
+00045090: 6174 293a 0a20 2020 2022 2222 0a20 2020  at):.    """.   
+000450a0: 2043 616c 6375 6c61 7469 6e67 204d 6561   Calculating Mea
+000450b0: 6e20 4162 736f 6c75 7465 2050 6572 6365  n Absolute Perce
+000450c0: 6e74 2045 7272 6f72 2068 7474 7073 3a2f  nt Error https:/
+000450d0: 2f65 6e2e 7769 6b69 7065 6469 612e 6f72  /en.wikipedia.or
+000450e0: 672f 7769 6b69 2f4d 6561 6e5f 6162 736f  g/wiki/Mean_abso
+000450f0: 6c75 7465 5f70 6572 6365 6e74 6167 655f  lute_percentage_
+00045100: 6572 726f 720a 2020 2020 546f 2061 766f  error.    To avo
+00045110: 6964 2069 6e66 696e 6974 7920 6475 6520  id infinity due 
+00045120: 746f 2064 6976 6973 696f 6e20 6279 207a  to division by z
+00045130: 6572 6f2c 2077 6520 7365 6c65 6374 206d  ero, we select m
+00045140: 6178 2830 2e30 312c 2061 6273 2861 6374  ax(0.01, abs(act
+00045150: 7561 6c73 2929 2074 6f20 7368 6f77 204d  uals)) to show M
+00045160: 4150 452e 0a20 2020 2022 2222 0a20 2020  APE..    """.   
+00045170: 2023 2323 2057 6865 7265 7665 7220 7468   ### Wherever th
+00045180: 6572 6520 6973 207a 6572 6f2c 2072 6570  ere is zero, rep
+00045190: 6c61 6365 2069 7420 7769 7468 2030 2e30  lace it with 0.0
+000451a0: 3031 2073 6f20 6974 2064 6f65 736e 2774  01 so it doesn't
+000451b0: 2072 6573 756c 7420 696e 2064 6976 6973   result in divis
+000451c0: 696f 6e20 6279 207a 6572 6f0a 2020 2020  ion by zero.    
+000451d0: 7065 7263 5f65 7272 203d 2028 3130 302a  perc_err = (100*
+000451e0: 286e 702e 7768 6572 6528 793d 3d30 2c30  (np.where(y==0,0
+000451f0: 2e30 3031 2c79 2920 2d20 795f 6861 7429  .001,y) - y_hat)
+00045200: 292f 6e70 2e77 6865 7265 2879 3d3d 302c  )/np.where(y==0,
+00045210: 302e 3030 312c 7929 0a20 2020 2072 6574  0.001,y).    ret
+00045220: 7572 6e20 6e70 2e6d 6561 6e28 6162 7328  urn np.mean(abs(
+00045230: 7065 7263 5f65 7272 2929 0a20 2020 200a  perc_err)).    .
+00045240: 6465 6620 706c 6f74 5f72 6567 7265 7373  def plot_regress
+00045250: 696f 6e28 6163 7475 616c 732c 2070 7265  ion(actuals, pre
+00045260: 6469 6374 6564 2c20 6368 6172 743d 2773  dicted, chart='s
+00045270: 6361 7474 6572 2729 3a0a 2020 2020 2222  catter'):.    ""
+00045280: 220a 2020 2020 5468 6973 2066 756e 6374  ".    This funct
+00045290: 696f 6e20 706c 6f74 7320 7468 6520 6163  ion plots the ac
+000452a0: 7475 616c 7320 7673 2e20 7072 6564 6963  tuals vs. predic
+000452b0: 7465 6420 6173 2061 206c 696e 6520 706c  ted as a line pl
+000452c0: 6f74 2e0a 2020 2020 596f 7520 6361 6e20  ot..    You can 
+000452d0: 6368 616e 6765 2074 6865 2063 6861 7274  change the chart
+000452e0: 2074 7970 6520 746f 2022 7363 6174 7465   type to "scatte
+000452f0: 7227 2074 6f20 6765 7420 6120 7363 6174  r' to get a scat
+00045300: 7465 7220 706c 6f74 2e0a 2020 2020 2222  ter plot..    ""
+00045310: 220a 2020 2020 6669 6773 697a 6520 3d20  ".    figsize = 
+00045320: 2831 302c 2031 3029 0a20 2020 2063 6f6c  (10, 10).    col
+00045330: 6f72 7320 3d20 6379 636c 6528 2762 7972  ors = cycle('byr
+00045340: 636d 676b 6279 7263 6d67 6b62 7972 636d  cmgkbyrcmgkbyrcm
+00045350: 676b 6279 7263 6d67 6b27 290a 2020 2020  gkbyrcmgk').    
+00045360: 706c 742e 6669 6775 7265 2866 6967 7369  plt.figure(figsi
+00045370: 7a65 3d66 6967 7369 7a65 290a 2020 2020  ze=figsize).    
+00045380: 6966 206e 6f74 2069 7369 6e73 7461 6e63  if not isinstanc
+00045390: 6528 6163 7475 616c 732c 206e 702e 6e64  e(actuals, np.nd
+000453a0: 6172 7261 7929 3a0a 2020 2020 2020 2020  array):.        
+000453b0: 6163 7475 616c 7320 3d20 6163 7475 616c  actuals = actual
+000453c0: 732e 7661 6c75 6573 0a20 2020 2064 6670  s.values.    dfp
+000453d0: 6c6f 7420 3d20 7064 2e44 6174 6146 7261  lot = pd.DataFra
+000453e0: 6d65 285b 6163 7475 616c 732c 7072 6564  me([actuals,pred
+000453f0: 6963 7465 645d 292e 540a 2020 2020 6466  icted]).T.    df
+00045400: 706c 6f74 2e63 6f6c 756d 6e73 203d 205b  plot.columns = [
+00045410: 2741 6374 7561 6c27 2c27 466f 7265 6361  'Actual','Foreca
+00045420: 7374 275d 0a20 2020 2064 6670 6c6f 7420  st'].    dfplot 
+00045430: 3d20 6466 706c 6f74 2e73 6f72 745f 696e  = dfplot.sort_in
+00045440: 6465 7828 290a 2020 2020 6c69 6e65 5374  dex().    lineSt
+00045450: 6172 7420 3d20 6163 7475 616c 732e 6d69  art = actuals.mi
+00045460: 6e28 290a 2020 2020 6c69 6e65 456e 6420  n().    lineEnd 
+00045470: 3d20 6163 7475 616c 732e 6d61 7828 290a  = actuals.max().
+00045480: 2020 2020 6966 2063 6861 7274 203d 3d20      if chart == 
+00045490: 276c 696e 6527 3a0a 2020 2020 2020 2020  'line':.        
+000454a0: 706c 742e 706c 6f74 2864 6670 6c6f 7429  plt.plot(dfplot)
+000454b0: 0a20 2020 2065 6c73 653a 0a20 2020 2020  .    else:.     
+000454c0: 2020 2070 6c74 2e73 6361 7474 6572 2861     plt.scatter(a
+000454d0: 6374 7561 6c73 2c20 7072 6564 6963 7465  ctuals, predicte
+000454e0: 642c 2063 6f6c 6f72 203d 206e 6578 7428  d, color = next(
+000454f0: 636f 6c6f 7273 292c 2061 6c70 6861 3d30  colors), alpha=0
+00045500: 2e35 2c6c 6162 656c 3d27 5072 6564 6963  .5,label='Predic
+00045510: 7469 6f6e 7327 290a 2020 2020 2020 2020  tions').        
+00045520: 706c 742e 706c 6f74 285b 6c69 6e65 5374  plt.plot([lineSt
+00045530: 6172 742c 206c 696e 6545 6e64 5d2c 205b  art, lineEnd], [
+00045540: 6c69 6e65 5374 6172 742c 206c 696e 6545  lineStart, lineE
+00045550: 6e64 5d2c 2027 6b2d 272c 2063 6f6c 6f72  nd], 'k-', color
+00045560: 203d 206e 6578 7428 636f 6c6f 7273 2929   = next(colors))
+00045570: 0a20 2020 2020 2020 2070 6c74 2e78 6c69  .        plt.xli
+00045580: 6d28 6c69 6e65 5374 6172 742c 206c 696e  m(lineStart, lin
+00045590: 6545 6e64 290a 2020 2020 2020 2020 706c  eEnd).        pl
+000455a0: 742e 796c 696d 286c 696e 6553 7461 7274  t.ylim(lineStart
+000455b0: 2c20 6c69 6e65 456e 6429 0a20 2020 2070  , lineEnd).    p
+000455c0: 6c74 2e78 6c61 6265 6c28 2741 6374 7561  lt.xlabel('Actua
+000455d0: 6c27 290a 2020 2020 706c 742e 796c 6162  l').    plt.ylab
+000455e0: 656c 2827 5072 6564 6963 7465 6427 290a  el('Predicted').
+000455f0: 2020 2020 706c 742e 6c65 6765 6e64 2829      plt.legend()
+00045600: 0a20 2020 2070 6c74 2e74 6974 6c65 2827  .    plt.title('
+00045610: 4d6f 6465 6c3a 2050 7265 6469 6374 6564  Model: Predicted
+00045620: 2076 7320 4163 7475 616c 7327 2c20 666f   vs Actuals', fo
+00045630: 6e74 7369 7a65 3d31 3229 0a20 2020 2070  ntsize=12).    p
+00045640: 6c74 2e73 686f 7728 293b 0a23 2323 2323  lt.show();.#####
+00045650: 2323 2323 2323 2323 2323 2323 2323 2323  ################
+00045660: 2323 2323 2323 2323 2323 2323 2323 2323  ################
+00045670: 2323 2323 2323 2323 2323 2323 2323 2323  ################
+00045680: 2323 2323 2323 2323 2323 2323 2323 2323  ################
+00045690: 2323 2323 2323 2323 2323 2323 2323 2323  ################
+000456a0: 2323 2323 2323 230a 2323 2323 2323 2323  #######.########
+000456b0: 2320 2020 5468 6973 2069 7320 7768 6572  #   This is wher
+000456c0: 6520 5355 4c4f 434c 4153 5349 4649 4552  e SULOCLASSIFIER
+000456d0: 2061 6e64 2053 554c 4f52 4547 5245 5353   and SULOREGRESS
+000456e0: 4f52 2045 4e44 2020 2023 2323 2323 2323  OR END   #######
+000456f0: 2323 2323 2323 2323 2323 2323 2323 2323  ################
+00045700: 2323 2323 0a23 2323 2323 2323 2323 2323  ####.###########
+00045710: 2323 2323 2323 2323 2323 2323 2323 2323  ################
+00045720: 2323 2323 2323 2323 2323 2323 2323 2323  ################
+00045730: 2323 2323 2323 2323 2323 2323 2323 2323  ################
+00045740: 2323 2323 2323 2323 2323 2323 2323 2323  ################
+00045750: 2323 2323 2323 2323 2323 2323 2323 2323  ################
+00045760: 230a 6672 6f6d 2073 6b6c 6561 726e 2e6d  #.from sklearn.m
+00045770: 6f64 656c 5f73 656c 6563 7469 6f6e 2069  odel_selection i
+00045780: 6d70 6f72 7420 5469 6d65 5365 7269 6573  mport TimeSeries
+00045790: 5370 6c69 740a 6672 6f6d 2073 6b6c 6561  Split.from sklea
+000457a0: 726e 2e75 7469 6c73 2069 6d70 6f72 7420  rn.utils import 
+000457b0: 696e 6465 7861 626c 650a 6672 6f6d 2073  indexable.from s
+000457c0: 6b6c 6561 726e 2e75 7469 6c73 2e76 616c  klearn.utils.val
+000457d0: 6964 6174 696f 6e20 696d 706f 7274 205f  idation import _
+000457e0: 6e75 6d5f 7361 6d70 6c65 730a 636c 6173  num_samples.clas
+000457f0: 7320 536c 6964 696e 6754 696d 6553 6572  s SlidingTimeSer
+00045800: 6965 7353 706c 6974 2854 696d 6553 6572  iesSplit(TimeSer
+00045810: 6965 7353 706c 6974 293a 0a20 2020 2022  iesSplit):.    "
+00045820: 2222 0a20 2020 2054 6865 2053 6c69 6469  "".    The Slidi
+00045830: 6e67 5469 6d65 5365 7269 6573 5370 6c69  ngTimeSeriesSpli
+00045840: 7420 6973 2062 6173 6564 206f 6e20 7468  t is based on th
+00045850: 6520 666f 6c6c 6f77 696e 6720 7265 7370  e following resp
+00045860: 6f6e 7365 2066 726f 6d20 5374 6163 6b6f  onse from Stacko
+00045870: 7665 7266 6c6f 773a 0a20 2020 2068 7474  verflow:.    htt
+00045880: 7073 3a2f 2f73 7461 636b 6f76 6572 666c  ps://stackoverfl
+00045890: 6f77 2e63 6f6d 2f71 7565 7374 696f 6e73  ow.com/questions
+000458a0: 2f35 3832 3935 3234 322f 736c 6964 696e  /58295242/slidin
+000458b0: 672d 7769 6e64 6f77 2d74 7261 696e 2d74  g-window-train-t
+000458c0: 6573 742d 7370 6c69 742d 666f 722d 7469  est-split-for-ti
+000458d0: 6d65 2d73 6572 6965 732d 6461 7461 0a20  me-series-data. 
+000458e0: 2020 204d 616e 7920 7468 616e 6b73 2074     Many thanks t
+000458f0: 6f20 7468 6520 706f 7374 6572 2061 6e64  o the poster and
+00045900: 2061 7574 686f 7220 6f66 2074 6869 7320   author of this 
+00045910: 636f 6465 2073 6e69 7070 6574 2e20 0a20  code snippet. . 
+00045920: 2020 2049 2068 6176 6520 6d6f 6469 6669     I have modifi
+00045930: 6564 2069 7420 736c 6967 6874 6c79 2074  ed it slightly t
+00045940: 6f20 7375 6974 206d 7920 6e65 6564 732e  o suit my needs.
+00045950: 0a20 2020 2022 2222 0a0a 2020 2020 6465  .    """..    de
+00045960: 6620 5f5f 696e 6974 5f5f 2873 656c 662c  f __init__(self,
+00045970: 206e 5f73 706c 6974 733d 352c 2067 726f   n_splits=5, gro
+00045980: 7570 733d 4e6f 6e65 2c20 6669 7865 645f  ups=None, fixed_
+00045990: 6c65 6e67 7468 3d4e 6f6e 652c 2074 7261  length=None, tra
+000459a0: 696e 5f73 706c 6974 733d 322c 2074 6573  in_splits=2, tes
+000459b0: 745f 7370 6c69 7473 3d31 293a 0a20 2020  t_splits=1):.   
+000459c0: 2020 2020 2073 656c 662e 6e5f 7370 6c69       self.n_spli
+000459d0: 7473 203d 206e 5f73 706c 6974 730a 2020  ts = n_splits.  
+000459e0: 2020 2020 2020 7365 6c66 2e67 726f 7570        self.group
+000459f0: 7320 3d20 6772 6f75 7073 0a20 2020 2020  s = groups.     
+00045a00: 2020 2073 656c 662e 6669 7865 645f 6c65     self.fixed_le
+00045a10: 6e67 7468 203d 2066 6978 6564 5f6c 656e  ngth = fixed_len
+00045a20: 6774 680a 2020 2020 2020 2020 7365 6c66  gth.        self
+00045a30: 2e74 7261 696e 5f73 706c 6974 7320 3d20  .train_splits = 
+00045a40: 7472 6169 6e5f 7370 6c69 7473 0a20 2020  train_splits.   
+00045a50: 2020 2020 2073 656c 662e 7465 7374 5f73       self.test_s
+00045a60: 706c 6974 7320 3d20 7465 7374 5f73 706c  plits = test_spl
+00045a70: 6974 730a 0a20 2020 2064 6566 2073 706c  its..    def spl
+00045a80: 6974 2873 656c 662c 2058 2c20 793d 4e6f  it(self, X, y=No
+00045a90: 6e65 293a 0a20 2020 2020 2020 2067 726f  ne):.        gro
+00045aa0: 7570 7320 3d20 7365 6c66 2e67 726f 7570  ups = self.group
+00045ab0: 730a 2020 2020 2020 2020 6669 7865 645f  s.        fixed_
+00045ac0: 6c65 6e67 7468 203d 2073 656c 662e 6669  length = self.fi
+00045ad0: 7865 645f 6c65 6e67 7468 0a20 2020 2020  xed_length.     
+00045ae0: 2020 2074 7261 696e 5f73 706c 6974 7320     train_splits 
+00045af0: 3d20 7365 6c66 2e74 7261 696e 5f73 706c  = self.train_spl
+00045b00: 6974 730a 2020 2020 2020 2020 7465 7374  its.        test
+00045b10: 5f73 706c 6974 7320 3d20 7365 6c66 2e74  _splits = self.t
+00045b20: 6573 745f 7370 6c69 7473 0a20 2020 2020  est_splits.     
+00045b30: 2020 206e 5f73 706c 6974 7320 3d20 7365     n_splits = se
+00045b40: 6c66 2e6e 5f73 706c 6974 730a 2020 2020  lf.n_splits.    
+00045b50: 2020 2020 2323 2323 2323 2323 2323 2323      ############
+00045b60: 2323 2323 2323 2323 2323 2323 2323 2323  ################
+00045b70: 2323 2323 2323 230a 2020 2020 2020 2020  #######.        
+00045b80: 582c 2079 2c20 6772 6f75 7073 203d 2069  X, y, groups = i
+00045b90: 6e64 6578 6162 6c65 2858 2c20 792c 2067  ndexable(X, y, g
+00045ba0: 726f 7570 7329 0a20 2020 2020 2020 206e  roups).        n
+00045bb0: 5f73 616d 706c 6573 203d 205f 6e75 6d5f  _samples = _num_
+00045bc0: 7361 6d70 6c65 7328 5829 0a20 2020 2020  samples(X).     
+00045bd0: 2020 206e 5f73 706c 6974 7320 3d20 7365     n_splits = se
+00045be0: 6c66 2e6e 5f73 706c 6974 730a 2020 2020  lf.n_splits.    
+00045bf0: 2020 2020 6e5f 666f 6c64 7320 3d20 6e5f      n_folds = n_
+00045c00: 7370 6c69 7473 202b 2031 0a20 2020 2020  splits + 1.     
+00045c10: 2020 2074 7261 696e 5f73 706c 6974 732c     train_splits,
+00045c20: 2074 6573 745f 7370 6c69 7473 203d 2069   test_splits = i
+00045c30: 6e74 2874 7261 696e 5f73 706c 6974 7329  nt(train_splits)
+00045c40: 2c20 696e 7428 7465 7374 5f73 706c 6974  , int(test_split
+00045c50: 7329 0a20 2020 2020 2020 2069 6620 6e5f  s).        if n_
+00045c60: 666f 6c64 7320 3e20 6e5f 7361 6d70 6c65  folds > n_sample
+00045c70: 733a 0a20 2020 2020 2020 2020 2020 2072  s:.            r
+00045c80: 6169 7365 2056 616c 7565 4572 726f 7228  aise ValueError(
+00045c90: 0a20 2020 2020 2020 2020 2020 2020 2020  .               
+00045ca0: 2028 2243 616e 6e6f 7420 6861 7665 206e   ("Cannot have n
+00045cb0: 756d 6265 7220 6f66 2066 6f6c 6473 203d  umber of folds =
+00045cc0: 7b30 7d20 6772 6561 7465 7222 0a20 2020  {0} greater".   
+00045cd0: 2020 2020 2020 2020 2020 2020 2020 2220                " 
+00045ce0: 7468 616e 2074 6865 206e 756d 6265 7220  than the number 
+00045cf0: 6f66 2073 616d 706c 6573 3a20 7b31 7d2e  of samples: {1}.
+00045d00: 2229 2e66 6f72 6d61 7428 6e5f 666f 6c64  ").format(n_fold
+00045d10: 732c 0a20 2020 2020 2020 2020 2020 2020  s,.             
+00045d20: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00045d30: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00045d40: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00045d50: 6e5f 7361 6d70 6c65 7329 290a 2020 2020  n_samples)).    
+00045d60: 2020 2020 6966 2028 6e5f 666f 6c64 7320      if (n_folds 
+00045d70: 2d20 7472 6169 6e5f 7370 6c69 7473 202d  - train_splits -
+00045d80: 2074 6573 745f 7370 6c69 7473 2920 3c3d   test_splits) <=
+00045d90: 2030 2061 6e64 2074 6573 745f 7370 6c69   0 and test_spli
+00045da0: 7473 203e 2030 3a0a 2020 2020 2020 2020  ts > 0:.        
+00045db0: 2020 2020 7261 6973 6520 5661 6c75 6545      raise ValueE
+00045dc0: 7272 6f72 280a 2020 2020 2020 2020 2020  rror(.          
+00045dd0: 2020 2020 2020 2822 426f 7468 2074 7261        ("Both tra
+00045de0: 696e 5f73 706c 6974 7320 616e 6420 7465  in_splits and te
+00045df0: 7374 5f73 706c 6974 7320 6d75 7374 2062  st_splits must b
+00045e00: 6520 706f 7369 7469 7665 220a 2020 2020  e positive".    
+00045e10: 2020 2020 2020 2020 2020 2020 2022 2069               " i
+00045e20: 6e74 6567 6572 732e 2229 290a 2020 2020  ntegers.")).    
+00045e30: 2020 2020 696e 6469 6365 7320 3d20 6e70      indices = np
+00045e40: 2e61 7261 6e67 6528 6e5f 7361 6d70 6c65  .arange(n_sample
+00045e50: 7329 0a20 2020 2020 2020 2073 706c 6974  s).        split
+00045e60: 5f73 697a 6520 3d20 286e 5f73 616d 706c  _size = (n_sampl
+00045e70: 6573 202f 2f20 6e5f 666f 6c64 7329 0a20  es // n_folds). 
+00045e80: 2020 2020 2020 2074 6573 745f 7369 7a65         test_size
+00045e90: 203d 2073 706c 6974 5f73 697a 6520 2a20   = split_size * 
+00045ea0: 7465 7374 5f73 706c 6974 730a 2020 2020  test_splits.    
+00045eb0: 2020 2020 7472 6169 6e5f 7369 7a65 203d      train_size =
+00045ec0: 2073 706c 6974 5f73 697a 6520 2a20 7472   split_size * tr
+00045ed0: 6169 6e5f 7370 6c69 7473 0a20 2020 2020  ain_splits.     
+00045ee0: 2020 2074 6573 745f 7374 6172 7473 203d     test_starts =
+00045ef0: 2072 616e 6765 2874 7261 696e 5f73 697a   range(train_siz
+00045f00: 6520 2b20 6e5f 7361 6d70 6c65 7320 2520  e + n_samples % 
+00045f10: 6e5f 666f 6c64 732c 0a20 2020 2020 2020  n_folds,.       
+00045f20: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00045f30: 2020 2020 206e 5f73 616d 706c 6573 202d       n_samples -
+00045f40: 2028 7465 7374 5f73 697a 6520 2d20 7370   (test_size - sp
+00045f50: 6c69 745f 7369 7a65 292c 0a20 2020 2020  lit_size),.     
+00045f60: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00045f70: 2020 2020 2020 2073 706c 6974 5f73 697a         split_siz
+00045f80: 6529 0a20 2020 2020 2020 2069 6620 6669  e).        if fi
+00045f90: 7865 645f 6c65 6e67 7468 3a0a 2020 2020  xed_length:.    
+00045fa0: 2020 2020 2020 2020 666f 7220 692c 2074          for i, t
+00045fb0: 6573 745f 7374 6172 7420 696e 207a 6970  est_start in zip
+00045fc0: 2872 616e 6765 286c 656e 2874 6573 745f  (range(len(test_
+00045fd0: 7374 6172 7473 2929 2c0a 2020 2020 2020  starts)),.      
+00045fe0: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00045ff0: 2020 2020 2020 2020 2020 2020 2020 2074                 t
+00046000: 6573 745f 7374 6172 7473 293a 0a20 2020  est_starts):.   
+00046010: 2020 2020 2020 2020 2020 2020 2072 656d               rem
+00046020: 203d 2030 0a20 2020 2020 2020 2020 2020   = 0.           
+00046030: 2020 2020 2069 6620 6920 3d3d 2030 3a0a       if i == 0:.
+00046040: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00046050: 2020 2020 7265 6d20 3d20 6e5f 7361 6d70      rem = n_samp
+00046060: 6c65 7320 2520 6e5f 666f 6c64 730a 2020  les % n_folds.  
+00046070: 2020 2020 2020 2020 2020 2020 2020 7969                yi
+00046080: 656c 6420 2869 6e64 6963 6573 5b28 7465  eld (indices[(te
+00046090: 7374 5f73 7461 7274 202d 2074 7261 696e  st_start - train
+000460a0: 5f73 697a 6520 2d20 7265 6d29 3a74 6573  _size - rem):tes
+000460b0: 745f 7374 6172 745d 2c69 6e64 6963 6573  t_start],indices
+000460c0: 5b74 6573 745f 7374 6172 743a 7465 7374  [test_start:test
+000460d0: 5f73 7461 7274 202b 2074 6573 745f 7369  _start + test_si
+000460e0: 7a65 5d29 0a20 2020 2020 2020 2065 6c73  ze]).        els
+000460f0: 653a 0a20 2020 2020 2020 2020 2020 2066  e:.            f
+00046100: 6f72 2074 6573 745f 7374 6172 7420 696e  or test_start in
+00046110: 2074 6573 745f 7374 6172 7473 3a0a 2020   test_starts:.  
+00046120: 2020 2020 2020 2020 2020 2020 2020 7969                yi
+00046130: 656c 6420 2869 6e64 6963 6573 5b3a 7465  eld (indices[:te
+00046140: 7374 5f73 7461 7274 5d2c 696e 6469 6365  st_start],indice
+00046150: 735b 7465 7374 5f73 7461 7274 3a74 6573  s[test_start:tes
+00046160: 745f 7374 6172 7420 2b20 7465 7374 5f73  t_start + test_s
+00046170: 697a 655d 290a 2323 2323 2323 2323 2323  ize]).##########
+00046180: 2323 2323 2323 2323 2323 2323 2323 2323  ################
+00046190: 2323 2323 2323 2323 2323 2323 2323 2323  ################
+000461a0: 2323 2323 2323 2323 2323 2323 2323 2323  ################
+000461b0: 2323 2323 2323 2323 2323 2323 2323 2323  ################
+000461c0: 2323 2323 2323 2323 2323 2323 2323 2323  ################
+000461d0: 2323 0a64 6566 2072 6d73 7065 2879 2c20  ##.def rmspe(y, 
+000461e0: 7968 6174 293a 0a20 2020 2072 6574 7572  yhat):.    retur
+000461f0: 6e20 6e70 2e73 7172 7428 6e70 2e6d 6561  n np.sqrt(np.mea
+00046200: 6e28 2879 6861 742f 792d 3129 202a 2a20  n((yhat/y-1) ** 
+00046210: 3229 290a 0a64 6566 2072 6d73 7065 5f78  2))..def rmspe_x
+00046220: 675f 6c6f 6728 7968 6174 2c20 7929 3a0a  g_log(yhat, y):.
+00046230: 2020 2020 7920 3d20 6e70 2e70 6f77 6572      y = np.power
+00046240: 2831 302c 2079 2e67 6574 5f6c 6162 656c  (10, y.get_label
+00046250: 2829 290a 2020 2020 7968 6174 203d 206e  ()).    yhat = n
+00046260: 702e 706f 7765 7228 3130 2c20 7968 6174  p.power(10, yhat
+00046270: 290a 2020 2020 7265 7475 726e 2022 726d  ).    return "rm
+00046280: 7370 6522 2c20 726d 7370 6528 792c 7968  spe", rmspe(y,yh
+00046290: 6174 290a 0a64 6566 2072 6d73 7065 5f78  at)..def rmspe_x
+000462a0: 6728 7968 6174 2c20 7929 3a0a 2020 2020  g(yhat, y):.    
+000462b0: 7265 7475 726e 2022 726d 7370 6522 2c20  return "rmspe", 
+000462c0: 726d 7370 6528 792e 6765 745f 6c61 6265  rmspe(y.get_labe
+000462d0: 6c28 292c 7968 6174 290a 2323 2323 2323  l(),yhat).######
+000462e0: 2323 2323 2323 2323 2323 2323 2323 2323  ################
+000462f0: 2323 2323 2323 2323 2323 2323 2323 2323  ################
+00046300: 2323 2323 2323 2323 2323 2323 2323 2323  ################
+00046310: 2323 2323 2323 2323 2323 2323 2323 2323  ################
+00046320: 2323 2323 2323 2323 2323 2323 2323 2323  ################
+00046330: 2323 2323 2323 230a 6672 6f6d 2073 6b6c  #######.from skl
+00046340: 6561 726e 2e6d 6f64 656c 5f73 656c 6563  earn.model_selec
+00046350: 7469 6f6e 2069 6d70 6f72 7420 7472 6169  tion import trai
+00046360: 6e5f 7465 7374 5f73 706c 6974 0a64 6566  n_test_split.def
+00046370: 2078 6762 6f6f 7374 5f72 6567 7265 7373   xgboost_regress
+00046380: 6f72 2820 585f 7472 6169 6e2c 2079 5f74  or( X_train, y_t
+00046390: 7261 696e 2c20 585f 7465 7374 2c20 0a20  rain, X_test, . 
+000463a0: 2020 2020 2020 2020 2020 2020 2020 2020                  
+000463b0: 2020 206c 6f67 5f74 7261 6e73 666f 726d     log_transform
+000463c0: 3d46 616c 7365 2c20 7370 6172 7369 7479  =False, sparsity
+000463d0: 3d46 616c 7365 2c20 6574 613d 302e 3129  =False, eta=0.1)
+000463e0: 3a0a 2020 2020 2222 220a 2020 2020 5065  :.    """.    Pe
+000463f0: 7266 6f72 6d20 7472 6169 6e69 6e67 2075  rform training u
+00046400: 7369 6e67 2058 4742 6f6f 7374 2077 6974  sing XGBoost wit
+00046410: 6820 6120 6c6f 6720 6261 7365 6420 7461  h a log based ta
+00046420: 7267 6574 2074 7261 6e73 666f 726d 6174  rget transformat
+00046430: 696f 6e20 7069 7065 6c69 6e65 2e0a 2020  ion pipeline..  
+00046440: 2020 2323 2323 2323 2323 2052 656d 656d    ######## Remem
+00046450: 6265 7220 7468 6174 2077 6520 7573 6520  ber that we use 
+00046460: 7468 6973 206f 6e6c 7920 666f 7220 5265  this only for Re
+00046470: 6772 6573 7369 6f6e 2070 726f 626c 656d  gression problem
+00046480: 7320 2323 2323 2323 2323 2323 2323 2323  s ##############
+00046490: 230a 2020 2020 5468 6973 2066 756e 6374  #.    This funct
+000464a0: 696f 6e20 7573 6573 206c 6f67 2074 7261  ion uses log tra
+000464b0: 6e73 666f 726d 6174 696f 6e20 6f66 2074  nsformation of t
+000464c0: 6172 6765 7420 7661 7269 6162 6c65 2074  arget variable t
+000464d0: 6f20 6d61 6b65 2069 7420 6561 7369 6572  o make it easier
+000464e0: 2e0a 2020 2020 4966 2073 7061 7273 6974  ..    If sparsit
+000464f0: 7920 6973 2073 6574 2c20 7468 656e 2074  y is set, then t
+00046500: 6172 6765 7420 7768 6572 6520 7a65 726f  arget where zero
+00046510: 7320 6172 6520 7365 7420 746f 2073 6d61  s are set to sma
+00046520: 6c6c 2076 616c 7565 2073 7563 6820 6173  ll value such as
+00046530: 2030 2e31 2e0a 2020 2020 5468 6973 2068   0.1..    This h
+00046540: 6170 7065 6e73 2066 7265 7175 656e 746c  appens frequentl
+00046550: 7920 696e 2072 6574 6169 6c20 6461 7461  y in retail data
+00046560: 7365 7473 2077 6865 7265 2069 6d62 616c  sets where imbal
+00046570: 616e 6365 6420 6461 7461 7365 7473 2061  anced datasets a
+00046580: 7265 2063 6f6d 6d6f 6e2e 200a 0a20 2020  re common. ..   
+00046590: 2049 6e70 7574 733a 0a20 2020 2058 5f74   Inputs:.    X_t
+000465a0: 7261 696e 3a20 6361 6e20 6265 2061 7272  rain: can be arr
+000465b0: 6179 206f 7220 4461 7461 4672 616d 6520  ay or DataFrame 
+000465c0: 6f66 2074 7261 696e 2070 7265 6469 6374  of train predict
+000465d0: 6f72 2076 616c 7565 730a 2020 2020 795f  or values.    y_
+000465e0: 7472 6169 6e3a 2063 616e 2062 6520 6172  train: can be ar
+000465f0: 7261 7920 6f72 2044 6174 6146 7261 6d65  ray or DataFrame
+00046600: 206f 6620 7472 6169 6e20 7461 7267 6574   of train target
+00046610: 2076 616c 7565 730a 2020 2020 585f 7465   values.    X_te
+00046620: 7374 3a20 6361 6e20 6265 2061 7272 6179  st: can be array
+00046630: 206f 7220 6461 7461 6672 616d 6520 6f66   or dataframe of
+00046640: 2074 6573 7420 7072 6564 6963 746f 7220   test predictor 
+00046650: 7661 6c75 6573 0a0a 2020 2020 4f75 7470  values..    Outp
+00046660: 7574 3a0a 2020 2020 7072 6564 7331 3a20  ut:.    preds1: 
+00046670: 7072 6564 6963 7469 6f6e 7320 6f6e 2058  predictions on X
+00046680: 5f74 6573 7420 7768 6963 6820 6361 6e20  _test which can 
+00046690: 6265 2063 6f6d 7061 7265 6420 746f 2079  be compared to y
+000466a0: 5f74 6573 7420 6f72 2073 7562 6d69 7474  _test or submitt
+000466b0: 6564 2e0a 2020 2020 2222 220a 2020 2020  ed..    """.    
+000466c0: 7472 793a 0a20 2020 2020 2020 2069 6d70  try:.        imp
+000466d0: 6f72 7420 7867 626f 6f73 7420 6173 2078  ort xgboost as x
+000466e0: 6762 0a20 2020 2065 7863 6570 743a 0a20  gb.    except:. 
+000466f0: 2020 2020 2020 2070 7269 6e74 2827 596f         print('Yo
+00046700: 7520 6d75 7374 2068 6176 6520 7867 626f  u must have xgbo
+00046710: 6f73 7420 696e 7374 616c 6c65 6420 696e  ost installed in
+00046720: 2079 6f75 7220 6d61 6368 696e 6520 746f   your machine to
+00046730: 2074 7279 2074 6869 7320 6675 6e63 7469   try this functi
+00046740: 6f6e 2e27 290a 2020 2020 2020 2020 7265  on.').        re
+00046750: 7475 726e 0a20 2020 2023 2323 2323 2320  turn.    ###### 
+00046760: 4966 2074 6865 7920 6769 7665 2073 7061  If they give spa
+00046770: 7273 6974 7920 666c 6167 2074 6865 6e20  rsity flag then 
+00046780: 7365 7420 7468 6520 7461 7267 6574 2076  set the target v
+00046790: 616c 7565 7320 746f 6120 6c6f 7720 6e75  alues toa low nu
+000467a0: 6d62 6572 2023 2323 0a20 2020 2069 6620  mber ###.    if 
+000467b0: 7370 6172 7369 7479 3a0a 2020 2020 2020  sparsity:.      
+000467c0: 2020 7072 696e 7428 2753 696e 6365 2073    print('Since s
+000467d0: 7061 7273 6974 7920 6973 2073 6574 2054  parsity is set T
+000467e0: 7275 652c 2072 6570 6c61 6365 207a 6572  rue, replace zer
+000467f0: 6f20 7661 6c75 6564 2074 6172 6765 7420  o valued target 
+00046800: 726f 7773 2077 6974 6820 6120 736d 616c  rows with a smal
+00046810: 6c20 302e 3120 7661 6c75 652e 2e2e 2729  l 0.1 value...')
+00046820: 0a20 2020 2020 2020 2069 6620 6973 696e  .        if isin
+00046830: 7374 616e 6365 2879 5f74 7261 696e 2c20  stance(y_train, 
+00046840: 6e70 2e6e 6461 7272 6179 293a 0a20 2020  np.ndarray):.   
+00046850: 2020 2020 2020 2020 2079 5f74 7261 696e           y_train
+00046860: 5b28 795f 7472 6169 6e3d 3d30 295d 203d  [(y_train==0)] =
+00046870: 2030 2e31 0a20 2020 2020 2020 2065 6c69   0.1.        eli
+00046880: 6620 6973 696e 7374 616e 6365 2879 5f74  f isinstance(y_t
+00046890: 7261 696e 2c20 7064 2e53 6572 6965 7329  rain, pd.Series)
+000468a0: 3a0a 2020 2020 2020 2020 2020 2020 2323  :.            ##
+000468b0: 2320 5369 6e63 6520 7765 2077 616e 7420  # Since we want 
+000468c0: 7370 6172 7369 7479 2077 6520 6172 6520  sparsity we are 
+000468d0: 676f 696e 6720 746f 2073 6574 2074 6172  going to set tar
+000468e0: 6765 7420 7661 6c75 6573 2074 6861 7420  get values that 
+000468f0: 6172 6520 7a65 726f 2061 7320 6e65 6172  are zero as near
+00046900: 207a 6572 6f0a 2020 2020 2020 2020 2020   zero.          
+00046910: 2020 7461 7267 6574 203d 2079 5f74 7261    target = y_tra
+00046920: 696e 2e6e 616d 650a 2020 2020 2020 2020  in.name.        
+00046930: 2020 2020 6966 206c 656e 2879 5f74 7261      if len(y_tra
+00046940: 696e 2e6c 6f63 5b28 795f 7472 6169 6e3d  in.loc[(y_train=
+00046950: 3d30 295d 2920 3e20 303a 0a20 2020 2020  =0)]) > 0:.     
+00046960: 2020 2020 2020 2020 2020 2079 5f74 7261             y_tra
+00046970: 696e 2e6c 6f63 5b28 795f 7472 6169 6e3d  in.loc[(y_train=
+00046980: 3d30 295d 203d 2030 2e31 0a20 2020 2020  =0)] = 0.1.     
+00046990: 2020 2065 6c69 6620 6973 696e 7374 616e     elif isinstan
+000469a0: 6365 2879 5f74 7261 696e 2c20 7064 2e44  ce(y_train, pd.D
+000469b0: 6174 6146 7261 6d65 293a 0a20 2020 2020  ataFrame):.     
+000469c0: 2020 2020 2020 2074 6172 6765 7473 203d         targets =
+000469d0: 2079 5f74 7261 696e 2e63 6f6c 756d 6e73   y_train.columns
+000469e0: 2e74 6f6c 6973 7428 290a 2020 2020 2020  .tolist().      
+000469f0: 2020 2020 2020 666f 7220 6561 6368 5f74        for each_t
+00046a00: 6172 6765 7420 696e 2074 6172 6765 7473  arget in targets
+00046a10: 3a0a 2020 2020 2020 2020 2020 2020 2020  :.              
+00046a20: 2020 6966 206c 656e 2879 5f74 7261 696e    if len(y_train
+00046a30: 2e6c 6f63 5b28 795f 7472 6169 6e5b 6561  .loc[(y_train[ea
+00046a40: 6368 5f74 6172 6765 745d 3d3d 3029 5d29  ch_target]==0)])
+00046a50: 203e 2030 3a0a 2020 2020 2020 2020 2020   > 0:.          
+00046a60: 2020 2020 2020 2020 2020 795f 7472 6169            y_trai
+00046a70: 6e2e 6c6f 635b 2879 5f74 7261 696e 5b65  n.loc[(y_train[e
+00046a80: 6163 685f 7461 7267 6574 5d3d 3d30 292c  ach_target]==0),
+00046a90: 2065 6163 685f 7461 7267 6574 5d20 3d20   each_target] = 
+00046aa0: 302e 310a 0a20 2020 2023 2323 2323 2054  0.1..    ##### T
+00046ab0: 6869 7320 6973 2077 6865 7265 2077 6520  his is where we 
+00046ac0: 7374 6172 7420 7468 6520 7370 6c69 7420  start the split 
+00046ad0: 696e 746f 2074 7261 696e 2061 6e64 2076  into train and v
+00046ae0: 616c 6964 2074 6f20 7475 6e65 2074 6865  alid to tune the
+00046af0: 206d 6f64 656c 2023 2323 0a20 2020 2073   model ###.    s
+00046b00: 7461 7274 5f74 696d 6520 3d20 7469 6d65  tart_time = time
+00046b10: 2e74 696d 6528 290a 2020 2020 585f 7472  .time().    X_tr
+00046b20: 6169 6e31 2c20 585f 7661 6c69 642c 2079  ain1, X_valid, y
+00046b30: 5f74 7261 696e 312c 2079 5f76 616c 6964  _train1, y_valid
+00046b40: 203d 2074 7261 696e 5f74 6573 745f 7370   = train_test_sp
+00046b50: 6c69 7428 0a20 2020 2020 2020 2020 2020  lit(.           
+00046b60: 2020 2020 2058 5f74 7261 696e 2c20 795f       X_train, y_
+00046b70: 7472 6169 6e2c 2074 6573 745f 7369 7a65  train, test_size
+00046b80: 3d30 2e30 322c 2072 616e 646f 6d5f 7374  =0.02, random_st
+00046b90: 6174 653d 3130 290a 2020 2020 6966 206c  ate=10).    if l
+00046ba0: 6f67 5f74 7261 6e73 666f 726d 3a0a 2020  og_transform:.  
+00046bb0: 2020 2020 2020 795f 7472 6169 6e31 203d        y_train1 =
+00046bc0: 206e 702e 6c6f 6731 3028 795f 7472 6169   np.log10(y_trai
+00046bd0: 6e31 290a 2020 2020 2020 2020 795f 7661  n1).        y_va
+00046be0: 6c69 6420 3d20 6e70 2e6c 6f67 3130 2879  lid = np.log10(y
+00046bf0: 5f76 616c 6964 290a 2020 2020 7072 696e  _valid).    prin
+00046c00: 7428 585f 7472 6169 6e31 2e73 6861 7065  t(X_train1.shape
+00046c10: 2c20 585f 7661 6c69 642e 7368 6170 6529  , X_valid.shape)
+00046c20: 0a0a 2020 2020 2323 2323 2320 4e6f 7720  ..    ##### Now 
+00046c30: 6c65 7420 7573 2074 7261 6e73 666f 726d  let us transform
+00046c40: 2058 5f74 7261 696e 3120 616e 6420 795f   X_train1 and y_
+00046c50: 7472 6169 6e31 2077 6974 6820 6c61 7a79  train1 with lazy
+00046c60: 7472 616e 7366 6f72 6d65 7220 2323 2323  transformer ####
+00046c70: 230a 2020 2020 6c61 7a79 203d 204c 617a  #.    lazy = Laz
+00046c80: 7954 7261 6e73 666f 726d 6572 286d 6f64  yTransformer(mod
+00046c90: 656c 3d4e 6f6e 652c 2065 6e63 6f64 6572  el=None, encoder
+00046ca0: 733d 276c 6162 656c 272c 2073 6361 6c65  s='label', scale
+00046cb0: 7273 3d27 272c 200a 2020 2020 2020 2020  rs='', .        
+00046cc0: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00046cd0: 7472 616e 7366 6f72 6d5f 7461 7267 6574  transform_target
+00046ce0: 3d46 616c 7365 2c20 696d 6261 6c61 6e63  =False, imbalanc
+00046cf0: 6564 3d46 616c 7365 2c20 7665 7262 6f73  ed=False, verbos
+00046d00: 653d 3129 0a20 2020 2058 5f74 7261 696e  e=1).    X_train
+00046d10: 312c 2079 5f74 7261 696e 3120 3d20 6c61  1, y_train1 = la
+00046d20: 7a79 2e66 6974 5f74 7261 6e73 666f 726d  zy.fit_transform
+00046d30: 2858 5f74 7261 696e 312c 2079 5f74 7261  (X_train1, y_tra
+00046d40: 696e 3129 0a20 2020 2058 5f76 616c 6964  in1).    X_valid
+00046d50: 312c 2079 5f76 616c 6964 3120 3d20 6c61  1, y_valid1 = la
+00046d60: 7a79 2e74 7261 6e73 666f 726d 2858 5f76  zy.transform(X_v
+00046d70: 616c 6964 2c20 795f 7661 6c69 6429 0a0a  alid, y_valid)..
+00046d80: 2020 2020 2323 2323 2323 2323 2020 204e      ########   N
+00046d90: 6f77 206c 6574 2773 2070 6572 666f 726d  ow let's perform
+00046da0: 2072 616e 646f 6d69 7a65 6420 7365 6172   randomized sear
+00046db0: 6368 2074 6f20 6669 6e64 2062 6573 7420  ch to find best 
+00046dc0: 6879 7065 7220 7061 7261 6d65 7465 7273  hyper parameters
+00046dd0: 2023 2323 2323 230a 2020 2020 7072 696e   ######.    prin
+00046de0: 7428 2723 2323 2320 4d6f 6465 6c20 7472  t('#### Model tr
+00046df0: 6169 6e69 6e67 2075 7369 6e67 2058 4742  aining using XGB
+00046e00: 2023 2323 2323 2323 2320 6574 6120 3d20   ######## eta = 
+00046e10: 2573 2720 2565 7461 290a 2020 2020 7061  %s' %eta).    pa
+00046e20: 7261 6d73 203d 207b 226f 626a 6563 7469  rams = {"objecti
+00046e30: 7665 223a 2022 7265 673a 7371 7561 7265  ve": "reg:square
+00046e40: 6465 7272 6f72 222c 0a20 2020 2020 2020  derror",.       
+00046e50: 2020 2020 2020 2022 626f 6f73 7465 7222         "booster"
+00046e60: 203a 2022 6762 7472 6565 222c 0a20 2020   : "gbtree",.   
+00046e70: 2020 2020 2020 2020 2020 2022 6574 6122             "eta"
+00046e80: 3a20 6574 612c 0a20 2020 2020 2020 2020  : eta,.         
+00046e90: 2020 2020 2022 7369 6c65 6e74 223a 2031       "silent": 1
+00046ea0: 2c0a 2020 2020 2020 2020 2020 2020 2020  ,.              
+00046eb0: 2273 6565 6422 3a20 3939 0a20 2020 2020  "seed": 99.     
+00046ec0: 2020 2020 2020 2020 207d 0a20 2020 206e           }.    n
+00046ed0: 756d 5f62 6f6f 7374 5f72 6f75 6e64 203d  um_boost_round =
+00046ee0: 2035 3030 0a20 2020 2023 2323 2323 206e   500.    ##### n
+00046ef0: 6f77 2064 6f20 7468 6520 7472 6169 6e69  ow do the traini
+00046f00: 6e67 2023 2323 2323 2323 2323 2323 0a20  ng ###########. 
+00046f10: 2020 2064 7472 6169 6e20 3d20 7867 622e     dtrain = xgb.
+00046f20: 444d 6174 7269 7828 585f 7472 6169 6e31  DMatrix(X_train1
+00046f30: 2c20 795f 7472 6169 6e31 290a 2020 2020  , y_train1).    
+00046f40: 6476 616c 6964 203d 2078 6762 2e44 4d61  dvalid = xgb.DMa
+00046f50: 7472 6978 2858 5f76 616c 6964 312c 2079  trix(X_valid1, y
+00046f60: 5f76 616c 6964 3129 0a20 2020 2023 2323  _valid1).    ###
+00046f70: 2323 2323 2323 2320 2020 4e6f 7720 7765  #######   Now we
+00046f80: 2075 7365 2072 6d73 7065 5f78 6720 2323   use rmspe_xg ##
+00046f90: 2323 2323 2323 2323 2323 2323 2323 2323  ################
+00046fa0: 230a 2020 2020 6966 206c 6f67 5f74 7261  #.    if log_tra
+00046fb0: 6e73 666f 726d 3a0a 2020 2020 2020 2020  nsform:.        
+00046fc0: 6665 7661 6c20 3d20 726d 7370 655f 7867  feval = rmspe_xg
+00046fd0: 5f6c 6f67 0a20 2020 2065 6c73 653a 0a20  _log.    else:. 
+00046fe0: 2020 2020 2020 2066 6576 616c 203d 2072         feval = r
+00046ff0: 6d73 7065 5f78 670a 2020 2020 7761 7463  mspe_xg.    watc
+00047000: 686c 6973 7420 3d20 5b28 6474 7261 696e  hlist = [(dtrain
+00047010: 2c20 2774 7261 696e 2729 2c20 2864 7661  , 'train'), (dva
+00047020: 6c69 642c 2027 6576 616c 2729 5d0a 2020  lid, 'eval')].  
+00047030: 2020 6762 6d20 3d20 7867 622e 7472 6169    gbm = xgb.trai
+00047040: 6e28 7061 7261 6d73 2c20 6474 7261 696e  n(params, dtrain
+00047050: 2c20 6e75 6d5f 626f 6f73 745f 726f 756e  , num_boost_roun
+00047060: 642c 2065 7661 6c73 3d77 6174 6368 6c69  d, evals=watchli
+00047070: 7374 2c20 5c0a 2020 2020 2020 6561 726c  st, \.      earl
+00047080: 795f 7374 6f70 7069 6e67 5f72 6f75 6e64  y_stopping_round
+00047090: 733d 3130 2c20 6665 7661 6c3d 6665 7661  s=10, feval=feva
+000470a0: 6c2c 2076 6572 626f 7365 5f65 7661 6c3d  l, verbose_eval=
+000470b0: 5472 7565 290a 2020 2020 7072 696e 7428  True).    print(
+000470c0: 2754 7261 696e 696e 6720 436f 6d70 6c65  'Training Comple
+000470d0: 7465 6427 290a 0a20 2020 2023 2323 2320  ted')..    #### 
+000470e0: 5468 6973 2069 7320 7768 6572 6520 796f  This is where yo
+000470f0: 7520 6772 6964 2073 6561 7263 6820 7468  u grid search th
+00047100: 6520 7069 7065 6c69 6e65 206e 6f77 2023  e pipeline now #
+00047110: 2323 2323 2323 2323 2323 2323 230a 2020  #############.  
+00047120: 2020 7072 696e 7428 2256 616c 6964 6174    print("Validat
+00047130: 696e 6722 290a 2020 2020 2323 2323 2049  ing").    #### I
+00047140: 6620 6974 2069 7320 6e6f 7420 7370 6172  f it is not spar
+00047150: 7365 2064 6174 612c 2079 6f75 206d 7573  se data, you mus
+00047160: 7420 7374 696c 6c20 7472 616e 7366 6f72  t still transfor
+00047170: 6d20 6974 2069 6e74 6f20 616e 2061 7272  m it into an arr
+00047180: 6179 2023 2323 0a20 2020 2069 6620 6973  ay ###.    if is
+00047190: 696e 7374 616e 6365 2879 5f76 616c 6964  instance(y_valid
+000471a0: 312c 2070 642e 5365 7269 6573 293a 0a20  1, pd.Series):. 
+000471b0: 2020 2020 2020 2079 5f76 616c 6964 3120         y_valid1 
+000471c0: 3d20 795f 7661 6c69 6431 2e76 616c 7565  = y_valid1.value
+000471d0: 730a 2020 2020 656c 6966 2069 7369 6e73  s.    elif isins
+000471e0: 7461 6e63 6528 795f 7661 6c69 6431 2c20  tance(y_valid1, 
+000471f0: 7064 2e44 6174 6146 7261 6d65 293a 0a20  pd.DataFrame):. 
+00047200: 2020 2020 2020 2079 5f76 616c 6964 3120         y_valid1 
+00047210: 3d20 795f 7661 6c69 6431 2e76 616c 7565  = y_valid1.value
+00047220: 732e 7261 7665 6c28 290a 2020 2020 7968  s.ravel().    yh
+00047230: 6174 203d 2067 626d 2e70 7265 6469 6374  at = gbm.predict
+00047240: 2878 6762 2e44 4d61 7472 6978 2858 5f76  (xgb.DMatrix(X_v
+00047250: 616c 6964 3129 290a 2020 2020 6572 726f  alid1)).    erro
+00047260: 7220 3d20 726d 7370 6528 795f 7661 6c69  r = rmspe(y_vali
+00047270: 6431 2c20 7968 6174 290a 2020 2020 7072  d1, yhat).    pr
+00047280: 696e 7428 2752 4d53 5045 3a20 7b3a 2e36  int('RMSPE: {:.6
+00047290: 667d 272e 666f 726d 6174 2865 7272 6f72  f}'.format(error
+000472a0: 2929 0a0a 2020 2020 2323 2323 2320 5468  ))..    ##### Th
+000472b0: 6973 2069 7320 7768 6572 6520 7765 2073  is is where we s
+000472c0: 6561 7263 6820 666f 7220 6879 7065 7220  earch for hyper 
+000472d0: 7061 7261 6d73 2066 6f72 206d 6f64 656c  params for model
+000472e0: 2023 2323 2323 2323 0a20 2020 2058 5f74   #######.    X_t
+000472f0: 6573 7431 203d 206c 617a 792e 7472 616e  est1 = lazy.tran
+00047300: 7366 6f72 6d28 585f 7465 7374 290a 2020  sform(X_test).  
+00047310: 2020 6474 6573 7420 3d20 7867 622e 444d    dtest = xgb.DM
+00047320: 6174 7269 7828 585f 7465 7374 3129 0a20  atrix(X_test1). 
+00047330: 2020 2070 7265 6473 3120 3d20 6762 6d2e     preds1 = gbm.
+00047340: 7072 6564 6963 7428 6474 6573 7429 0a20  predict(dtest). 
+00047350: 2020 2023 2052 6574 7572 6e20 7072 6564     # Return pred
+00047360: 6963 7469 6f6e 7320 2323 230a 2020 2020  ictions ###.    
+00047370: 6966 206c 6f67 5f74 7261 6e73 666f 726d  if log_transform
+00047380: 3a0a 2020 2020 2020 2020 7072 6564 7331  :.        preds1
+00047390: 203d 206e 702e 706f 7765 7228 3130 2c20   = np.power(10, 
+000473a0: 7072 6564 7331 290a 2020 2020 6672 6f6d  preds1).    from
+000473b0: 2078 6762 6f6f 7374 2069 6d70 6f72 7420   xgboost import 
+000473c0: 706c 6f74 5f69 6d70 6f72 7461 6e63 650a  plot_importance.
+000473d0: 2020 2020 706c 6f74 5f69 6d70 6f72 7461      plot_importa
+000473e0: 6e63 6528 6762 6d29 0a20 2020 2072 6574  nce(gbm).    ret
+000473f0: 7572 6e20 7072 6564 7331 0a23 2323 2323  urn preds1.#####
+00047400: 2323 2323 2323 2323 2323 2323 2323 2323  ################
+00047410: 2323 2323 2323 2323 2323 2323 2323 2323  ################
+00047420: 2323 2323 2323 2323 2323 2323 2323 2323  ################
+00047430: 2323 2323 2323 2323 2323 2323 2323 2323  ################
+00047440: 2323 2323 2323 2323 2323 2323 0a66 726f  ############.fro
+00047450: 6d20 7363 6970 792e 7374 6174 7320 696d  m scipy.stats im
+00047460: 706f 7274 2070 726f 6270 6c6f 742c 736b  port probplot,sk
+00047470: 6577 0a64 6566 2064 6174 615f 7375 6767  ew.def data_sugg
+00047480: 6573 7469 6f6e 7328 6461 7461 293a 0a20  estions(data):. 
+00047490: 2020 2022 2222 0a20 2020 204d 6f64 6966     """.    Modif
+000474a0: 6965 6420 6279 2052 616d 2053 6573 6861  ied by Ram Sesha
+000474b0: 6472 692e 204f 7269 6769 6e61 6c20 6964  dri. Original id
+000474c0: 6561 2066 6f72 2064 6174 6120 7375 6767  ea for data sugg
+000474d0: 6573 7469 6f6e 7320 6d6f 6475 6c65 2077  estions module w
+000474e0: 6173 2061 204b 6167 676c 6572 2e0a 2020  as a Kaggler..  
+000474f0: 2020 4d61 6e79 2074 6861 6e6b 7320 746f    Many thanks to
+00047500: 3a20 6874 7470 733a 2f2f 7777 772e 6b61  : https://www.ka
+00047510: 6767 6c65 2e63 6f6d 2f63 6f64 652f 6974  ggle.com/code/it
+00047520: 6b69 6e31 362f 6361 7462 6f6f 7374 2d6f  kin16/catboost-o
+00047530: 6e2d 6770 752d 6261 7365 6c69 6e65 0a20  n-gpu-baseline. 
+00047540: 2020 2022 2222 0a20 2020 206d 6178 7820     """.    maxx 
+00047550: 3d20 5b5d 0a20 2020 206d 696e 6e20 3d20  = [].    minn = 
+00047560: 5b5d 0a20 2020 2061 6c6c 5f63 6f6c 7320  [].    all_cols 
+00047570: 3d20 6c69 7374 2864 6174 6129 0a20 2020  = list(data).   
+00047580: 2063 6174 5f63 6f6c 7331 203d 2064 6174   cat_cols1 = dat
+00047590: 612e 7365 6c65 6374 5f64 7479 7065 7328  a.select_dtypes(
+000475a0: 696e 636c 7564 653d 276f 626a 6563 7427  include='object'
+000475b0: 292e 636f 6c75 6d6e 732e 746f 6c69 7374  ).columns.tolist
+000475c0: 2829 0a20 2020 2063 6174 5f63 6f6c 7332  ().    cat_cols2
+000475d0: 203d 2064 6174 612e 7365 6c65 6374 5f64   = data.select_d
+000475e0: 7479 7065 7328 696e 636c 7564 653d 2763  types(include='c
+000475f0: 6174 6567 6f72 7927 292e 636f 6c75 6d6e  ategory').column
+00047600: 732e 746f 6c69 7374 2829 0a20 2020 2063  s.tolist().    c
+00047610: 6174 5f63 6f6c 7320 3d20 6c69 7374 2873  at_cols = list(s
+00047620: 6574 2863 6174 5f63 6f6c 7331 2b63 6174  et(cat_cols1+cat
+00047630: 5f63 6f6c 7332 2929 0a20 2020 2023 2323  _cols2)).    ###
+00047640: 2054 6865 206e 6578 7420 6c69 6e65 206d   The next line m
+00047650: 6179 206c 6f6f 6b20 6f64 6420 6275 7420  ay look odd but 
+00047660: 6475 6520 746f 2064 6966 6665 7265 6e74  due to different
+00047670: 2076 6572 7369 6f6e 7320 6f66 2070 616e   versions of pan
+00047680: 6461 7320 7768 6963 680a 2020 2020 2323  das which.    ##
+00047690: 2320 7472 6561 7420 7468 6520 6465 6669  # treat the defi
+000476a0: 6e69 7469 6f6e 206f 6620 666c 6f61 7420  nition of float 
+000476b0: 6469 6666 6572 656e 746c 792c 2049 2061  differently, I a
+000476c0: 6d20 666f 7263 6564 2074 6f20 7573 6520  m forced to use 
+000476d0: 7468 6973 2e20 446f 6e27 7420 6368 616e  this. Don't chan
+000476e0: 6765 2069 742e 0a20 2020 206e 756d 5f63  ge it..    num_c
+000476f0: 6f6c 7320 3d20 6461 7461 2e73 656c 6563  ols = data.selec
+00047700: 745f 6474 7970 6573 2869 6e63 6c75 6465  t_dtypes(include
+00047710: 3d27 666c 6f61 7431 3627 292e 636f 6c75  ='float16').colu
+00047720: 6d6e 732e 746f 6c69 7374 2829 202b 2064  mns.tolist() + d
+00047730: 6174 612e 7365 6c65 6374 5f64 7479 7065  ata.select_dtype
+00047740: 7328 0a20 2020 2020 2020 2020 2020 2020  s(.             
+00047750: 2020 2020 2020 2069 6e63 6c75 6465 3d27         include='
+00047760: 666c 6f61 7433 3227 292e 636f 6c75 6d6e  float32').column
+00047770: 732e 746f 6c69 7374 2829 202b 2064 6174  s.tolist() + dat
+00047780: 612e 7365 6c65 6374 5f64 7479 7065 7328  a.select_dtypes(
+00047790: 696e 636c 7564 653d 2766 6c6f 6174 3634  include='float64
+000477a0: 2729 2e63 6f6c 756d 6e73 2e74 6f6c 6973  ').columns.tolis
+000477b0: 7428 290a 2020 2020 6e6f 6e5f 6e75 6d5f  t().    non_num_
+000477c0: 636f 6c73 203d 206c 6566 745f 7375 6274  cols = left_subt
+000477d0: 7261 6374 2861 6c6c 5f63 6f6c 732c 206e  ract(all_cols, n
+000477e0: 756d 5f63 6f6c 7329 0a20 2020 2066 6f72  um_cols).    for
+000477f0: 2069 2069 6e20 6461 7461 2e63 6f6c 756d   i in data.colum
+00047800: 6e73 3a0a 2020 2020 2020 2020 6966 2069  ns:.        if i
+00047810: 206e 6f74 2069 6e20 6361 745f 636f 6c73   not in cat_cols
+00047820: 3a0a 2020 2020 2020 2020 2020 2020 2323  :.            ##
+00047830: 2320 666f 7220 666c 6f61 7420 616e 6420  # for float and 
+00047840: 696e 7465 6765 722c 206e 6f20 6e65 6564  integer, no need
+00047850: 2074 6f20 6361 6c63 756c 6174 6520 7468   to calculate th
+00047860: 6973 2023 230a 2020 2020 2020 2020 2020  is ##.          
+00047870: 2020 6d69 6e6e 2e61 7070 656e 6428 3029    minn.append(0)
+00047880: 0a20 2020 2020 2020 2065 6c73 653a 0a20  .        else:. 
+00047890: 2020 2020 2020 2020 2020 206d 696e 6e2e             minn.
+000478a0: 6170 7065 6e64 2864 6174 615b 695d 2e76  append(data[i].v
+000478b0: 616c 7565 5f63 6f75 6e74 7328 292e 6d69  alue_counts().mi
+000478c0: 6e28 2929 0a20 2020 206c 656e 6774 6820  n()).    length 
+000478d0: 3d20 6c65 6e28 6461 7461 290a 2020 2020  = len(data).    
+000478e0: 6e75 6e69 6b20 3d20 6461 7461 2e6e 756e  nunik = data.nun
+000478f0: 6971 7565 2829 0a20 2020 206e 756c 6c73  ique().    nulls
+00047900: 203d 2064 6174 612e 6973 6e61 2829 2e73   = data.isna().s
+00047910: 756d 2829 0a20 2020 2064 6620 3d20 7064  um().    df = pd
+00047920: 2e44 6174 6146 7261 6d65 280a 2020 2020  .DataFrame(.    
+00047930: 2020 2020 7b0a 2020 2020 2020 2020 2023      {.         #
+00047940: 2763 6f6c 756d 6e27 3a20 6c69 7374 2864  'column': list(d
+00047950: 6174 6129 2c0a 2020 2020 2020 2020 274e  ata),.        'N
+00047960: 756e 6971 7565 7327 3a20 6e75 6e69 6b2c  uniques': nunik,
+00047970: 0a20 2020 2020 2020 2020 274e 756e 6971  .         'Nuniq
+00047980: 7565 5065 7263 656e 7427 3a20 2831 3030  uePercent': (100
+00047990: 2a28 6e75 6e69 6b2f 6c65 6e67 7468 2929  *(nunik/length))
+000479a0: 2c0a 2020 2020 2020 2020 2027 6474 7970  ,.         'dtyp
+000479b0: 6527 3a20 6461 7461 2e64 7479 7065 732c  e': data.dtypes,
+000479c0: 0a20 2020 2020 2020 2020 274e 756c 6c73  .         'Nulls
+000479d0: 2720 3a20 6e75 6c6c 732c 0a20 2020 2020  ' : nulls,.     
+000479e0: 2020 2020 274e 756c 6c70 6572 6365 6e74      'Nullpercent
+000479f0: 2720 3a20 3130 302a 286e 756c 6c73 2f6c  ' : 100*(nulls/l
+00047a00: 656e 6774 6829 2c0a 2020 2020 2020 2020  ength),.        
+00047a10: 2027 5661 6c75 6520 636f 756e 7473 204d   'Value counts M
+00047a20: 696e 273a 6d69 6e6e 0a20 2020 2020 2020  in':minn.       
+00047a30: 207d 2c0a 2020 2020 2020 2020 636f 6c75   },.        colu
+00047a40: 6d6e 7320 3d20 5b27 4e75 6e69 7175 6573  mns = ['Nuniques
+00047a50: 272c 2027 6474 7970 6527 2c27 4e75 6c6c  ', 'dtype','Null
+00047a60: 7327 2c27 4e75 6c6c 7065 7263 656e 7427  s','Nullpercent'
+00047a70: 2c20 274e 756e 6971 7565 5065 7263 656e  , 'NuniquePercen
+00047a80: 7427 2c0a 2020 2020 2020 2020 2020 2020  t',.            
+00047a90: 2020 2020 2020 2020 2020 2027 5661 6c75             'Valu
+00047aa0: 6520 636f 756e 7473 204d 696e 275d 292e  e counts Min']).
+00047ab0: 736f 7274 5f76 616c 7565 7328 6279 203d  sort_values(by =
+00047ac0: 274e 756e 6971 7565 7327 2c61 7363 656e  'Nuniques',ascen
+00047ad0: 6469 6e67 203d 2046 616c 7365 290a 2020  ding = False).  
+00047ae0: 2020 6e65 7763 6f6c 203d 2027 4461 7461    newcol = 'Data
+00047af0: 2063 6c65 616e 696e 6720 696d 7072 6f76   cleaning improv
+00047b00: 656d 656e 7420 7375 6767 6573 7469 6f6e  ement suggestion
+00047b10: 7327 0a20 2020 2070 7269 6e74 2827 2573  s'.    print('%s
+00047b20: 2e20 436f 6d70 6c65 7465 2074 6865 6d20  . Complete them 
+00047b30: 6265 666f 7265 2070 726f 6365 6564 696e  before proceedin
+00047b40: 6720 746f 204d 4c20 6d6f 6465 6c69 6e67  g to ML modeling
+00047b50: 2e27 2025 6e65 7763 6f6c 290a 2020 2020  .' %newcol).    
+00047b60: 6d69 7865 645f 636f 6c73 203d 205b 636f  mixed_cols = [co
+00047b70: 6c20 666f 7220 636f 6c20 696e 2064 6174  l for col in dat
+00047b80: 612e 636f 6c75 6d6e 7320 6966 206c 656e  a.columns if len
+00047b90: 2864 6174 615b 636f 6c5d 2e61 7070 6c79  (data[col].apply
+00047ba0: 2874 7970 6529 2e76 616c 7565 5f63 6f75  (type).value_cou
+00047bb0: 6e74 7328 2929 203e 2031 5d0a 2020 2020  nts()) > 1].    
+00047bc0: 6466 5b6e 6577 636f 6c5d 203d 2027 270a  df[newcol] = ''.
+00047bd0: 2020 2020 6466 5b27 6669 7273 745f 636f      df['first_co
+00047be0: 6d6d 6127 5d20 3d20 2727 0a20 2020 2069  mma'] = ''.    i
+00047bf0: 6620 6c65 6e28 6361 745f 636f 6c73 2920  f len(cat_cols) 
+00047c00: 3e20 303a 0a20 2020 2020 2020 206d 6173  > 0:.        mas
+00047c10: 6b30 203d 2064 665b 2764 7479 7065 275d  k0 = df['dtype']
+00047c20: 203d 3d20 276f 626a 6563 7427 0a20 2020   == 'object'.   
+00047c30: 2020 2020 206d 6173 6b31 203d 2064 665b       mask1 = df[
+00047c40: 2756 616c 7565 2063 6f75 6e74 7320 4d69  'Value counts Mi
+00047c50: 6e27 5d2f 6466 5b27 4e75 6e69 7175 6573  n']/df['Nuniques
+00047c60: 275d 203c 3d20 302e 3035 0a20 2020 2020  '] <= 0.05.     
+00047c70: 2020 206d 6173 6b34 203d 2064 665b 2764     mask4 = df['d
+00047c80: 7479 7065 275d 203d 3d20 2763 6174 6567  type'] == 'categ
+00047c90: 6f72 7927 0a20 2020 2020 2020 2064 662e  ory'.        df.
+00047ca0: 6c6f 635b 6d61 736b 3026 6d61 736b 312c  loc[mask0&mask1,
+00047cb0: 6e65 7763 6f6c 5d20 2b3d 2064 662e 6c6f  newcol] += df.lo
+00047cc0: 635b 6d61 736b 3026 6d61 736b 312c 2766  c[mask0&mask1,'f
+00047cd0: 6972 7374 5f63 6f6d 6d61 275d 202b 2027  irst_comma'] + '
+00047ce0: 636f 6d62 696e 6520 7261 7265 2063 6174  combine rare cat
+00047cf0: 6567 6f72 6965 7327 0a20 2020 2020 2020  egories'.       
+00047d00: 2064 662e 6c6f 635b 6d61 736b 3426 6d61   df.loc[mask4&ma
+00047d10: 736b 312c 6e65 7763 6f6c 5d20 2b3d 2064  sk1,newcol] += d
+00047d20: 662e 6c6f 635b 6d61 736b 3426 6d61 736b  f.loc[mask4&mask
+00047d30: 312c 2766 6972 7374 5f63 6f6d 6d61 275d  1,'first_comma']
+00047d40: 202b 2027 636f 6d62 696e 6520 7261 7265   + 'combine rare
+00047d50: 2063 6174 6567 6f72 6965 7327 0a20 2020   categories'.   
+00047d60: 2020 2020 2064 662e 6c6f 635b 6d61 736b       df.loc[mask
+00047d70: 3026 6d61 736b 312c 2766 6972 7374 5f63  0&mask1,'first_c
+00047d80: 6f6d 6d61 275d 203d 2027 2c20 270a 2020  omma'] = ', '.  
+00047d90: 2020 2020 2020 6466 2e6c 6f63 5b6d 6173        df.loc[mas
+00047da0: 6b34 266d 6173 6b31 2c27 6669 7273 745f  k4&mask1,'first_
+00047db0: 636f 6d6d 6127 5d20 3d20 272c 2027 0a20  comma'] = ', '. 
+00047dc0: 2020 206d 6173 6b32 203d 2064 665b 274e     mask2 = df['N
+00047dd0: 756c 6c73 275d 203e 2030 0a20 2020 2064  ulls'] > 0.    d
+00047de0: 662e 6c6f 635b 6d61 736b 322c 6e65 7763  f.loc[mask2,newc
+00047df0: 6f6c 5d20 2b3d 2064 662e 6c6f 635b 6d61  ol] += df.loc[ma
+00047e00: 736b 322c 2766 6972 7374 5f63 6f6d 6d61  sk2,'first_comma
+00047e10: 275d 202b 2027 6669 6c6c 206d 6973 7369  '] + 'fill missi
+00047e20: 6e67 270a 2020 2020 6466 2e6c 6f63 5b6d  ng'.    df.loc[m
+00047e30: 6173 6b32 2c27 6669 7273 745f 636f 6d6d  ask2,'first_comm
+00047e40: 6127 5d20 3d20 222c 2022 0a20 2020 206d  a'] = ", ".    m
+00047e50: 6173 6b33 203d 2064 665b 274e 756e 6971  ask3 = df['Nuniq
+00047e60: 7565 7327 5d20 3d3d 2031 0a20 2020 2064  ues'] == 1.    d
+00047e70: 662e 6c6f 635b 6d61 736b 332c 6e65 7763  f.loc[mask3,newc
+00047e80: 6f6c 5d20 2b3d 2064 662e 6c6f 635b 6d61  ol] += df.loc[ma
+00047e90: 736b 332c 2766 6972 7374 5f63 6f6d 6d61  sk3,'first_comma
+00047ea0: 275d 202b 2027 696e 7661 7269 616e 7420  '] + 'invariant 
+00047eb0: 7661 6c75 6573 3a20 6472 6f70 270a 2020  values: drop'.  
+00047ec0: 2020 6466 2e6c 6f63 5b6d 6173 6b33 2c27    df.loc[mask3,'
+00047ed0: 6669 7273 745f 636f 6d6d 6127 5d20 3d20  first_comma'] = 
+00047ee0: 222c 2022 0a20 2020 2069 6620 6c65 6e28  ", ".    if len(
+00047ef0: 6e6f 6e5f 6e75 6d5f 636f 6c73 2920 3e20  non_num_cols) > 
+00047f00: 303a 0a20 2020 2020 2020 2066 6f72 2078  0:.        for x
+00047f10: 2069 6e20 6e6f 6e5f 6e75 6d5f 636f 6c73   in non_num_cols
+00047f20: 3a0a 2020 2020 2020 2020 2020 2020 6966  :.            if
+00047f30: 2064 662e 6c6f 635b 782c 2027 4e75 6e69   df.loc[x, 'Nuni
+00047f40: 7175 6550 6572 6365 6e74 275d 203d 3d20  quePercent'] == 
+00047f50: 3130 303a 0a20 2020 2020 2020 2020 2020  100:.           
+00047f60: 2020 2020 2064 662e 6c6f 635b 782c 206e       df.loc[x, n
+00047f70: 6577 636f 6c5d 202b 3d20 6466 2e6c 6f63  ewcol] += df.loc
+00047f80: 5b78 2c27 6669 7273 745f 636f 6d6d 6127  [x,'first_comma'
+00047f90: 5d20 2b20 2770 6f73 7369 626c 6520 4944  ] + 'possible ID
+00047fa0: 2063 6f6c 756d 6e3a 2064 726f 7027 0a20   column: drop'. 
+00047fb0: 2020 2020 2020 2020 2020 2020 2020 2064                 d
+00047fc0: 662e 6c6f 635b 782c 2766 6972 7374 5f63  f.loc[x,'first_c
+00047fd0: 6f6d 6d61 275d 203d 2022 2c20 220a 2020  omma'] = ", ".  
+00047fe0: 2020 6d61 736b 3520 3d20 6466 5b27 4e75    mask5 = df['Nu
+00047ff0: 6c6c 7065 7263 656e 7427 5d20 3e3d 2039  llpercent'] >= 9
+00048000: 300a 2020 2020 6466 2e6c 6f63 5b6d 6173  0.    df.loc[mas
+00048010: 6b35 2c6e 6577 636f 6c5d 202b 3d20 6466  k5,newcol] += df
+00048020: 2e6c 6f63 5b6d 6173 6b35 2c27 6669 7273  .loc[mask5,'firs
+00048030: 745f 636f 6d6d 6127 5d20 2b20 2776 6572  t_comma'] + 'ver
+00048040: 7920 6869 6768 206e 756c 6c73 2070 6572  y high nulls per
+00048050: 6365 6e74 3a20 6472 6f70 270a 2020 2020  cent: drop'.    
+00048060: 6466 2e6c 6f63 5b6d 6173 6b35 2c27 6669  df.loc[mask5,'fi
+00048070: 7273 745f 636f 6d6d 6127 5d20 3d20 222c  rst_comma'] = ",
+00048080: 2022 0a20 2020 2023 2323 2320 6368 6563   ".    #### chec
+00048090: 6b20 666f 7220 696e 6669 6e69 7465 2076  k for infinite v
+000480a0: 616c 7565 7320 6865 7265 2023 2323 2323  alues here #####
+000480b0: 0a20 2020 2069 6e66 5f63 6f6c 7331 203d  .    inf_cols1 =
+000480c0: 206e 702e 6172 7261 7928 6e75 6d5f 636f   np.array(num_co
+000480d0: 6c73 295b 5b28 6461 7461 2e6c 6f63 5b28  ls)[[(data.loc[(
+000480e0: 6461 7461 5b63 6f6c 5d20 3d3d 206e 702e  data[col] == np.
+000480f0: 696e 6629 5d29 2e73 6861 7065 5b30 5d3e  inf)]).shape[0]>
+00048100: 3020 666f 7220 636f 6c20 696e 206e 756d  0 for col in num
+00048110: 5f63 6f6c 735d 5d2e 746f 6c69 7374 2829  _cols]].tolist()
+00048120: 0a20 2020 2069 6e66 5f63 6f6c 7332 203d  .    inf_cols2 =
+00048130: 206e 702e 6172 7261 7928 6e75 6d5f 636f   np.array(num_co
+00048140: 6c73 295b 5b28 6461 7461 2e6c 6f63 5b28  ls)[[(data.loc[(
+00048150: 6461 7461 5b63 6f6c 5d20 3d3d 202d 6e70  data[col] == -np
+00048160: 2e69 6e66 295d 292e 7368 6170 655b 305d  .inf)]).shape[0]
+00048170: 3e30 2066 6f72 2063 6f6c 2069 6e20 6e75  >0 for col in nu
+00048180: 6d5f 636f 6c73 5d5d 2e74 6f6c 6973 7428  m_cols]].tolist(
+00048190: 290a 2020 2020 696e 665f 636f 6c73 203d  ).    inf_cols =
+000481a0: 206c 6973 7428 7365 7428 696e 665f 636f   list(set(inf_co
+000481b0: 6c73 312b 696e 665f 636f 6c73 3229 290a  ls1+inf_cols2)).
+000481c0: 2020 2020 2323 2320 4368 6563 6b20 666f      ### Check fo
+000481d0: 7220 696e 6669 6e69 7465 2076 616c 7565  r infinite value
+000481e0: 7320 696e 2063 6f6c 756d 6e73 2023 2323  s in columns ###
+000481f0: 2323 0a20 2020 2069 6620 6c65 6e28 696e  ##.    if len(in
+00048200: 665f 636f 6c73 2920 3e20 303a 0a20 2020  f_cols) > 0:.   
+00048210: 2020 2020 2066 6f72 2078 2069 6e20 696e       for x in in
+00048220: 665f 636f 6c73 3a0a 2020 2020 2020 2020  f_cols:.        
+00048230: 2020 2020 6466 2e6c 6f63 5b78 2c6e 6577      df.loc[x,new
+00048240: 636f 6c5d 202b 3d20 6466 2e6c 6f63 5b78  col] += df.loc[x
+00048250: 2c27 6669 7273 745f 636f 6d6d 6127 5d20  ,'first_comma'] 
+00048260: 2b20 2769 6e66 696e 6974 6520 7661 6c75  + 'infinite valu
+00048270: 6573 3a20 6472 6f70 270a 2020 2020 2020  es: drop'.      
+00048280: 2020 2020 2020 6466 2e6c 6f63 5b78 2c27        df.loc[x,'
+00048290: 6669 7273 745f 636f 6d6d 6127 5d20 3d20  first_comma'] = 
+000482a0: 222c 2022 0a20 2020 2023 2323 2320 4368  ", ".    #### Ch
+000482b0: 6563 6b20 666f 7220 736b 6577 6564 2066  eck for skewed f
+000482c0: 6c6f 6174 2063 6f6c 756d 6e73 2023 2323  loat columns ###
+000482d0: 2323 2323 0a20 2020 2073 6b65 775f 636f  ####.    skew_co
+000482e0: 6c73 3120 3d20 6e70 2e61 7272 6179 286e  ls1 = np.array(n
+000482f0: 756d 5f63 6f6c 7329 5b5b 286e 702e 6162  um_cols)[[(np.ab
+00048300: 7328 6e70 2e72 6f75 6e64 2864 6174 615b  s(np.round(data[
+00048310: 636f 6c5d 2e73 6b65 7728 292c 2031 2929  col].skew(), 1))
+00048320: 203e 2031 0a20 2020 2020 2020 2020 2020   > 1.           
+00048330: 2020 2020 2020 2020 2029 2026 2028 6e70           ) & (np
+00048340: 2e61 6273 286e 702e 726f 756e 6428 6461  .abs(np.round(da
+00048350: 7461 5b63 6f6c 5d2e 736b 6577 2829 2c20  ta[col].skew(), 
+00048360: 3129 2920 3c3d 2035 2920 666f 7220 636f  1)) <= 5) for co
+00048370: 6c20 696e 206e 756d 5f63 6f6c 735d 5d2e  l in num_cols]].
+00048380: 746f 6c69 7374 2829 0a20 2020 2073 6b65  tolist().    ske
+00048390: 775f 636f 6c73 3220 3d20 6e70 2e61 7272  w_cols2 = np.arr
+000483a0: 6179 286e 756d 5f63 6f6c 7329 5b5b 286e  ay(num_cols)[[(n
+000483b0: 702e 6162 7328 6e70 2e72 6f75 6e64 2864  p.abs(np.round(d
+000483c0: 6174 615b 636f 6c5d 2e73 6b65 7728 292c  ata[col].skew(),
+000483d0: 2031 2929 203e 2035 2920 666f 7220 636f   1)) > 5) for co
+000483e0: 6c20 696e 206e 756d 5f63 6f6c 735d 5d2e  l in num_cols]].
+000483f0: 746f 6c69 7374 2829 0a20 2020 2073 6b65  tolist().    ske
+00048400: 775f 636f 6c73 203d 206c 6973 7428 7365  w_cols = list(se
+00048410: 7428 736b 6577 5f63 6f6c 7331 2b73 6b65  t(skew_cols1+ske
+00048420: 775f 636f 6c73 3229 290a 2020 2020 2323  w_cols2)).    ##
+00048430: 2320 4368 6563 6b20 666f 7220 736b 6577  # Check for skew
+00048440: 6564 2076 616c 7565 7320 696e 2063 6f6c  ed values in col
+00048450: 756d 6e73 2023 2323 2323 0a20 2020 2069  umns #####.    i
+00048460: 6620 6c65 6e28 736b 6577 5f63 6f6c 7331  f len(skew_cols1
+00048470: 2920 3e20 303a 0a20 2020 2020 2020 2066  ) > 0:.        f
+00048480: 6f72 2078 2069 6e20 736b 6577 5f63 6f6c  or x in skew_col
+00048490: 7331 3a0a 2020 2020 2020 2020 2020 2020  s1:.            
+000484a0: 6466 2e6c 6f63 5b78 2c6e 6577 636f 6c5d  df.loc[x,newcol]
+000484b0: 202b 3d20 6466 2e6c 6f63 5b78 2c27 6669   += df.loc[x,'fi
+000484c0: 7273 745f 636f 6d6d 6127 5d20 2b20 2773  rst_comma'] + 's
+000484d0: 6b65 7765 643a 2063 6170 206f 7220 6472  kewed: cap or dr
+000484e0: 6f70 206f 7574 6c69 6572 7327 0a20 2020  op outliers'.   
+000484f0: 2020 2020 2020 2020 2064 662e 6c6f 635b           df.loc[
+00048500: 782c 2766 6972 7374 5f63 6f6d 6d61 275d  x,'first_comma']
+00048510: 203d 2022 2c20 220a 2020 2020 6966 206c   = ", ".    if l
+00048520: 656e 2873 6b65 775f 636f 6c73 3229 203e  en(skew_cols2) >
+00048530: 2030 3a0a 2020 2020 2020 2020 666f 7220   0:.        for 
+00048540: 7820 696e 2073 6b65 775f 636f 6c73 323a  x in skew_cols2:
+00048550: 0a20 2020 2020 2020 2020 2020 2064 662e  .            df.
+00048560: 6c6f 635b 782c 6e65 7763 6f6c 5d20 2b3d  loc[x,newcol] +=
+00048570: 2064 662e 6c6f 635b 782c 2766 6972 7374   df.loc[x,'first
+00048580: 5f63 6f6d 6d61 275d 202b 2027 6869 6768  _comma'] + 'high
+00048590: 6c79 2073 6b65 7765 643a 2064 726f 7020  ly skewed: drop 
+000485a0: 6f75 746c 6965 7273 206f 7220 646f 2062  outliers or do b
+000485b0: 6f78 2d63 6f78 2074 7261 6e73 666f 726d  ox-cox transform
+000485c0: 270a 2020 2020 2020 2020 2020 2020 6466  '.            df
+000485d0: 2e6c 6f63 5b78 2c27 6669 7273 745f 636f  .loc[x,'first_co
+000485e0: 6d6d 6127 5d20 3d20 222c 2022 0a20 2020  mma'] = ", ".   
+000485f0: 2023 2323 2323 2044 6f20 7468 6520 7361   ##### Do the sa
+00048600: 6d65 2066 6f72 206d 6978 6564 2064 7479  me for mixed dty
+00048610: 7065 2063 6f6c 756d 6e73 202d 2074 6865  pe columns - the
+00048620: 7920 6d75 7374 2062 6520 6669 7865 6421  y must be fixed!
+00048630: 2023 230a 2020 2020 6966 206c 656e 286d   ##.    if len(m
+00048640: 6978 6564 5f63 6f6c 7329 203e 2030 3a0a  ixed_cols) > 0:.
+00048650: 2020 2020 2020 2020 666f 7220 7820 696e          for x in
+00048660: 206d 6978 6564 5f63 6f6c 733a 0a20 2020   mixed_cols:.   
+00048670: 2020 2020 2020 2020 2064 662e 6c6f 635b           df.loc[
+00048680: 782c 6e65 7763 6f6c 5d20 2b3d 2064 662e  x,newcol] += df.
+00048690: 6c6f 635b 782c 2766 6972 7374 5f63 6f6d  loc[x,'first_com
+000486a0: 6d61 275d 202b 2027 6669 7820 6d69 7865  ma'] + 'fix mixe
+000486b0: 6420 6461 7461 2074 7970 6573 270a 2020  d data types'.  
+000486c0: 2020 2020 2020 2020 2020 6466 2e6c 6f63            df.loc
+000486d0: 5b78 2c27 6669 7273 745f 636f 6d6d 6127  [x,'first_comma'
+000486e0: 5d20 3d20 222c 2022 0a20 2020 2064 662e  ] = ", ".    df.
+000486f0: 6472 6f70 2827 6669 7273 745f 636f 6d6d  drop('first_comm
+00048700: 6127 2c20 6178 6973 3d31 2c20 696e 706c  a', axis=1, inpl
+00048710: 6163 653d 5472 7565 290a 2020 2020 7265  ace=True).    re
+00048720: 7475 726e 2064 660a 2323 2323 2323 2323  turn df.########
+00048730: 2323 2323 2323 2323 2323 2323 2323 2323  ################
+00048740: 2323 2323 2323 2323 2323 2323 2323 2323  ################
+00048750: 2323 2323 2323 2323 2323 2323 2323 2323  ################
+00048760: 2323 2323 2323 2323 2323 2323 2323 2323  ################
+00048770: 2323 2323 2323 2323 2323 230a 6465 6620  ###########.def 
+00048780: 6461 7461 5f63 6c65 616e 696e 675f 7375  data_cleaning_su
+00048790: 6767 6573 7469 6f6e 7328 6466 293a 0a20  ggestions(df):. 
+000487a0: 2020 2022 2222 0a20 2020 2054 6869 7320     """.    This 
+000487b0: 6973 2061 2073 696d 706c 6520 7072 6f67  is a simple prog
+000487c0: 7261 6d20 746f 2067 6976 6520 6461 7461  ram to give data
+000487d0: 2063 6c65 616e 696e 6720 616e 6420 696d   cleaning and im
+000487e0: 7072 6f76 656d 656e 7420 7375 6767 6573  provement sugges
+000487f0: 7469 6f6e 7320 696e 2063 6c61 7373 2041  tions in class A
+00048800: 562e 0a20 2020 204d 616b 6520 7375 7265  V..    Make sure
+00048810: 2079 6f75 2073 656e 6420 696e 2061 2064   you send in a d
+00048820: 6174 6166 7261 6d65 2e20 4f74 6865 7277  ataframe. Otherw
+00048830: 6973 652c 2074 6869 7320 7769 6c6c 2067  ise, this will g
+00048840: 6976 6520 616e 2065 7272 6f72 2e0a 2020  ive an error..  
+00048850: 2020 2222 220a 2020 2020 6966 2069 7369    """.    if isi
+00048860: 6e73 7461 6e63 6528 6466 2c20 7064 2e44  nstance(df, pd.D
+00048870: 6174 6146 7261 6d65 293a 0a20 2020 2020  ataFrame):.     
+00048880: 2020 2064 6678 203d 2064 6174 615f 7375     dfx = data_su
+00048890: 6767 6573 7469 6f6e 7328 6466 290a 2020  ggestions(df).  
+000488a0: 2020 2020 2020 616c 6c5f 726f 7773 203d        all_rows =
+000488b0: 2064 6678 2e73 6861 7065 5b30 5d0a 2020   dfx.shape[0].  
+000488c0: 2020 2020 2020 6178 203d 2064 6678 2e68        ax = dfx.h
+000488d0: 6561 6428 616c 6c5f 726f 7773 292e 7374  ead(all_rows).st
+000488e0: 796c 652e 6261 636b 6772 6f75 6e64 5f67  yle.background_g
+000488f0: 7261 6469 656e 7428 636d 6170 3d27 5265  radient(cmap='Re
+00048900: 6473 2729 2e73 6574 5f70 726f 7065 7274  ds').set_propert
+00048910: 6965 7328 2a2a 7b27 666f 6e74 2d66 616d  ies(**{'font-fam
+00048920: 696c 7927 3a20 2753 6567 6f65 2055 4927  ily': 'Segoe UI'
+00048930: 7d29 0a20 2020 2020 2020 2064 6973 706c  }).        displ
+00048940: 6179 2861 7829 3b0a 2020 2020 656c 7365  ay(ax);.    else
+00048950: 3a0a 2020 2020 2020 2020 7072 696e 7428  :.        print(
+00048960: 2249 6e70 7574 206d 7573 7420 6265 2061  "Input must be a
+00048970: 2064 6174 6166 7261 6d65 2e20 506c 6561   dataframe. Plea
+00048980: 7365 2063 6865 636b 2069 6e70 7574 2061  se check input a
+00048990: 6e64 2074 7279 2061 6761 696e 2e22 290a  nd try again.").
+000489a0: 2323 2323 2323 2323 2323 2323 2323 2323  ################
+000489b0: 2323 2323 2323 2323 2323 2323 2323 2323  ################
+000489c0: 2323 2323 2323 2323 2323 2323 2323 2323  ################
+000489d0: 2323 2323 2323 2323 2323 2323 2323 2323  ################
+000489e0: 2323 2323 2323 2323 2323 2323 2323 2323  ################
+000489f0: 2323 2323 2323 2323 2323 2323 230a 0a23  #############..#
+00048a00: 2323 2323 2323 2323 2323 2323 2323 2323  ################
+00048a10: 2323 2323 2323 2323 2323 2323 2323 2323  ################
+00048a20: 2323 2323 2323 2323 2323 2323 2323 2323  ################
+00048a30: 2323 2323 2323 2323 2323 2323 2323 2323  ################
+00048a40: 2323 2323 2323 2323 2323 2323 2323 2323  ################
+00048a50: 2323 2323 2323 2323 2323 230a 6d6f 6475  ###########.modu
+00048a60: 6c65 5f74 7970 6520 3d20 2752 756e 6e69  le_type = 'Runni
+00048a70: 6e67 2720 6966 2020 5f5f 6e61 6d65 5f5f  ng' if  __name__
+00048a80: 203d 3d20 225f 5f6d 6169 6e5f 5f22 2065   == "__main__" e
+00048a90: 6c73 6520 2749 6d70 6f72 7465 6427 0a76  lse 'Imported'.v
+00048aa0: 6572 7369 6f6e 5f6e 756d 6265 7220 3d20  ersion_number = 
+00048ab0: 2027 312e 3127 0a70 7269 6e74 2866 2222   '1.1'.print(f""
+00048ac0: 227b 6d6f 6475 6c65 5f74 7970 657d 204c  "{module_type} L
+00048ad0: 617a 7954 7261 6e73 666f 726d 6572 2076  azyTransformer v
+00048ae0: 6572 7369 6f6e 3a7b 7665 7273 696f 6e5f  ersion:{version_
+00048af0: 6e75 6d62 6572 7d2e 2043 616c 6c20 6279  number}. Call by
+00048b00: 2075 7369 6e67 3a0a 2020 2020 6c61 7a79   using:.    lazy
+00048b10: 203d 204c 617a 7954 7261 6e73 666f 726d   = LazyTransform
+00048b20: 6572 286d 6f64 656c 3d4e 6f6e 652c 2065  er(model=None, e
+00048b30: 6e63 6f64 6572 733d 2761 7574 6f27 2c20  ncoders='auto', 
+00048b40: 7363 616c 6572 733d 4e6f 6e65 2c20 6461  scalers=None, da
+00048b50: 7465 5f74 6f5f 7374 7269 6e67 3d46 616c  te_to_string=Fal
+00048b60: 7365 2c0a 2020 2020 2020 2020 7472 616e  se,.        tran
+00048b70: 7366 6f72 6d5f 7461 7267 6574 3d46 616c  sform_target=Fal
+00048b80: 7365 2c20 696d 6261 6c61 6e63 6564 3d46  se, imbalanced=F
+00048b90: 616c 7365 2c20 7361 7665 3d46 616c 7365  alse, save=False
+00048ba0: 2c20 636f 6d62 696e 655f 7261 7265 3d46  , combine_rare=F
+00048bb0: 616c 7365 2c20 7665 7262 6f73 653d 3029  alse, verbose=0)
+00048bc0: 0a20 2020 2023 2323 2069 6620 796f 7520  .    ### if you 
+00048bd0: 6172 6520 6e6f 7420 7573 696e 6720 6120  are not using a 
+00048be0: 6d6f 6465 6c20 696e 2070 6970 656c 696e  model in pipelin
+00048bf0: 652c 2079 6f75 206d 7573 7420 7573 6520  e, you must use 
+00048c00: 6669 7420 616e 6420 7472 616e 7366 6f72  fit and transfor
+00048c10: 6d20 2323 230a 2020 2020 2020 2020 585f  m ###.        X_
+00048c20: 7472 6169 6e6d 2c20 795f 7472 6169 6e6d  trainm, y_trainm
+00048c30: 203d 206c 617a 792e 6669 745f 7472 616e   = lazy.fit_tran
+00048c40: 7366 6f72 6d28 585f 7472 6169 6e2c 2079  sform(X_train, y
+00048c50: 5f74 7261 696e 290a 2020 2020 2020 2020  _train).        
+00048c60: 585f 7465 7374 6d20 3d20 6c61 7a79 2e74  X_testm = lazy.t
+00048c70: 7261 6e73 666f 726d 2858 5f74 6573 7429  ransform(X_test)
+00048c80: 0a20 2020 2023 2323 2049 6620 7573 696e  .    ### If usin
+00048c90: 6720 6120 6d6f 6465 6c20 696e 2070 6970  g a model in pip
+00048ca0: 656c 696e 652c 2075 7365 2066 6974 2061  eline, use fit a
+00048cb0: 6e64 2070 7265 6469 6374 206f 6e6c 7920  nd predict only 
+00048cc0: 2323 230a 2020 2020 2020 2020 6c61 7a79  ###.        lazy
+00048cd0: 2e66 6974 2858 5f74 7261 696e 2c20 795f  .fit(X_train, y_
+00048ce0: 7472 6169 6e29 0a20 2020 2020 2020 206c  train).        l
+00048cf0: 617a 792e 7072 6564 6963 7428 585f 7465  azy.predict(X_te
+00048d00: 7374 290a 2222 2229 0a23 2323 2323 2323  st).""").#######
+00048d10: 2323 2323 2323 2323 2323 2323 2323 2323  ################
+00048d20: 2323 2323 2323 2323 2323 2323 2323 2323  ################
+00048d30: 2323 2323 2323 2323 2323 2323 2323 2323  ################
+00048d40: 2323 2323 2323 2323 2323 2323 2323 2323  ################
+00048d50: 2323 2323 2323 2323 2323 0a00 0000 0000  ##########......
+00048d60: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+00048d70: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+00048d80: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+00048d90: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+00048da0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+00048db0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+00048dc0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+00048dd0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+00048de0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+00048df0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+00048e00: 2e2f 2e2f 4050 6178 4865 6164 6572 0000  ././@PaxHeader..
+00048e10: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+00048e20: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+00048e30: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+00048e40: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+00048e50: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+00048e60: 0000 0000 3030 3030 3030 3000 3030 3030  ....0000000.0000
+00048e70: 3030 3000 3030 3030 3030 3000 3030 3030  000.0000000.0000
+00048e80: 3030 3030 3033 3400 3030 3030 3030 3030  0000034.00000000
+00048e90: 3030 3000 3031 3134 3532 0020 7800 0000  000.011452. x...
+00048ea0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+00048eb0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+00048ec0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+00048ed0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+00048ee0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+00048ef0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+00048f00: 0075 7374 6172 0030 3000 0000 0000 0000  .ustar.00.......
+00048f10: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+00048f20: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+00048f30: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+00048f40: 0000 0000 0000 0000 0030 3030 3030 3030  .........0000000
+00048f50: 0030 3030 3030 3030 0000 0000 0000 0000  .0000000........
+00048f60: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+00048f70: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+00048f80: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+00048f90: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+00048fa0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+00048fb0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+00048fc0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+00048fd0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+00048fe0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+00048ff0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+00049000: 3238 206d 7469 6d65 3d31 3638 3432 3838  28 mtime=1684288
+00049010: 3437 332e 3633 3036 3532 320a 0000 0000  473.6306522.....
+00049020: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+00049030: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+00049040: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+00049050: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+00049060: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+00049070: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+00049080: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+00049090: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+000490a0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+000490b0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+000490c0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+000490d0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+000490e0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+000490f0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+00049100: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+00049110: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+00049120: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+00049130: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+00049140: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+00049150: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+00049160: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+00049170: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+00049180: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+00049190: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+000491a0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+000491b0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+000491c0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+000491d0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+000491e0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+000491f0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+00049200: 6c61 7a79 7472 616e 7366 6f72 6d2d 312e  lazytransform-1.
+00049210: 312f 7365 7475 702e 6366 6700 0000 0000  1/setup.cfg.....
+00049220: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+00049230: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+00049240: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+00049250: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+00049260: 0000 0000 3030 3030 3737 3700 3030 3031  ....0000777.0001
+00049270: 3735 3000 3030 3031 3735 3000 3030 3030  750.0001750.0000
+00049280: 3030 3030 3034 3600 3030 3030 3030 3030  0000046.00000000
+00049290: 3030 3000 3031 3534 3737 0020 3000 0000  000.015477. 0...
+000492a0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+000492b0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+000492c0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+000492d0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+000492e0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+000492f0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+00049300: 0075 7374 6172 0030 3072 616d 0000 0000  .ustar.00ram....
+00049310: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+00049320: 0000 0000 0000 0000 0072 616d 0000 0000  .........ram....
+00049330: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+00049340: 0000 0000 0000 0000 0030 3030 3030 3030  .........0000000
+00049350: 0030 3030 3030 3030 0000 0000 0000 0000  .0000000........
+00049360: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+00049370: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+00049380: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+00049390: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+000493a0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+000493b0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+000493c0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+000493d0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+000493e0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+000493f0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+00049400: 5b65 6767 5f69 6e66 6f5d 0a74 6167 5f62  [egg_info].tag_b
+00049410: 7569 6c64 203d 200a 7461 675f 6461 7465  uild = .tag_date
+00049420: 203d 2030 0a0a 0000 0000 0000 0000 0000   = 0............
+00049430: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+00049440: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+00049450: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+00049460: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+00049470: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+00049480: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+00049490: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+000494a0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+000494b0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+000494c0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+000494d0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+000494e0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+000494f0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+00049500: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+00049510: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+00049520: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+00049530: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+00049540: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+00049550: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+00049560: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+00049570: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+00049580: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+00049590: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+000495a0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+000495b0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+000495c0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+000495d0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+000495e0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+000495f0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+00049600: 2e2f 2e2f 4050 6178 4865 6164 6572 0000  ././@PaxHeader..
+00049610: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+00049620: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+00049630: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+00049640: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+00049650: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+00049660: 0000 0000 3030 3030 3030 3000 3030 3030  ....0000000.0000
+00049670: 3030 3000 3030 3030 3030 3000 3030 3030  000.0000000.0000
+00049680: 3030 3030 3032 3600 3030 3030 3030 3030  0000026.00000000
+00049690: 3030 3000 3031 3134 3533 0020 7800 0000  000.011453. x...
+000496a0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+000496b0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+000496c0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+000496d0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+000496e0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+000496f0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+00049700: 0075 7374 6172 0030 3000 0000 0000 0000  .ustar.00.......
+00049710: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+00049720: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+00049730: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+00049740: 0000 0000 0000 0000 0030 3030 3030 3030  .........0000000
+00049750: 0030 3030 3030 3030 0000 0000 0000 0000  .0000000........
+00049760: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+00049770: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+00049780: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+00049790: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+000497a0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+000497b0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+000497c0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+000497d0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+000497e0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+000497f0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+00049800: 3232 206d 7469 6d65 3d31 3638 3336 3833  22 mtime=1683683
+00049810: 3335 322e 300a 0000 0000 0000 0000 0000  352.0...........
+00049820: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+00049830: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+00049840: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+00049850: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+00049860: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+00049870: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+00049880: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+00049890: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+000498a0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+000498b0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+000498c0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+000498d0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+000498e0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+000498f0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+00049900: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+00049910: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+00049920: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+00049930: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+00049940: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+00049950: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+00049960: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+00049970: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+00049980: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+00049990: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+000499a0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+000499b0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+000499c0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+000499d0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+000499e0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+000499f0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+00049a00: 6c61 7a79 7472 616e 7366 6f72 6d2d 312e  lazytransform-1.
+00049a10: 312f 7365 7475 702e 7079 0000 0000 0000  1/setup.py......
+00049a20: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+00049a30: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+00049a40: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+00049a50: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+00049a60: 0000 0000 3030 3030 3737 3700 3030 3031  ....0000777.0001
+00049a70: 3735 3000 3030 3031 3735 3000 3030 3030  750.0001750.0000
+00049a80: 3030 3032 3033 3200 3030 3030 3030 3030  0002032.00000000
+00049a90: 3030 3000 3031 3533 3635 0020 3000 0000  000.015365. 0...
+00049aa0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+00049ab0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+00049ac0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+00049ad0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+00049ae0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+00049af0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+00049b00: 0075 7374 6172 0030 3072 616d 0000 0000  .ustar.00ram....
+00049b10: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+00049b20: 0000 0000 0000 0000 0072 616d 0000 0000  .........ram....
+00049b30: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+00049b40: 0000 0000 0000 0000 0030 3030 3030 3030  .........0000000
+00049b50: 0030 3030 3030 3030 0000 0000 0000 0000  .0000000........
+00049b60: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+00049b70: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+00049b80: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+00049b90: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+00049ba0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+00049bb0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+00049bc0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+00049bd0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+00049be0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+00049bf0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+00049c00: 696d 706f 7274 2073 6574 7570 746f 6f6c  import setuptool
+00049c10: 730d 0a0d 0a77 6974 6820 6f70 656e 2822  s....with open("
+00049c20: 5245 4144 4d45 2e6d 6422 2c20 2272 222c  README.md", "r",
+00049c30: 2065 6e63 6f64 696e 673d 2275 7466 2d38   encoding="utf-8
+00049c40: 2229 2061 7320 6668 3a0d 0a20 2020 206c  ") as fh:..    l
+00049c50: 6f6e 675f 6465 7363 7269 7074 696f 6e20  ong_description 
+00049c60: 3d20 6668 2e72 6561 6428 290d 0a0d 0a73  = fh.read()....s
+00049c70: 6574 7570 746f 6f6c 732e 7365 7475 7028  etuptools.setup(
+00049c80: 0d0a 2020 2020 6e61 6d65 3d22 6c61 7a79  ..    name="lazy
+00049c90: 7472 616e 7366 6f72 6d22 2c0d 0a20 2020  transform",..   
+00049ca0: 2076 6572 7369 6f6e 3d22 312e 3122 2c0d   version="1.1",.
+00049cb0: 0a20 2020 2061 7574 686f 723d 2252 616d  .    author="Ram
+00049cc0: 2053 6573 6861 6472 6922 2c0d 0a20 2020   Seshadri",..   
+00049cd0: 2023 2061 7574 686f 725f 656d 6169 6c3d   # author_email=
+00049ce0: 2261 7574 686f 7240 6578 616d 706c 652e  "author@example.
+00049cf0: 636f 6d22 2c0d 0a20 2020 2064 6573 6372  com",..    descr
+00049d00: 6970 7469 6f6e 3d22 436c 6561 6e20 796f  iption="Clean yo
+00049d10: 7572 2064 6174 6120 7573 696e 6720 6120  ur data using a 
+00049d20: 7363 696b 6974 2d6c 6561 726e 2074 7261  scikit-learn tra
+00049d30: 6e73 666f 726d 6572 2069 6e20 6120 7369  nsformer in a si
+00049d40: 6e67 6c65 206c 696e 6520 6f66 2063 6f64  ngle line of cod
+00049d50: 6522 2c0d 0a20 2020 206c 6f6e 675f 6465  e",..    long_de
+00049d60: 7363 7269 7074 696f 6e3d 6c6f 6e67 5f64  scription=long_d
+00049d70: 6573 6372 6970 7469 6f6e 2c0d 0a20 2020  escription,..   
+00049d80: 206c 6f6e 675f 6465 7363 7269 7074 696f   long_descriptio
+00049d90: 6e5f 636f 6e74 656e 745f 7479 7065 3d22  n_content_type="
+00049da0: 7465 7874 2f6d 6172 6b64 6f77 6e22 2c0d  text/markdown",.
+00049db0: 0a20 2020 206c 6963 656e 7365 3d27 4170  .    license='Ap
+00049dc0: 6163 6865 204c 6963 656e 7365 2032 2e30  ache License 2.0
+00049dd0: 272c 0d0a 2020 2020 7572 6c3d 2268 7474  ',..    url="htt
+00049de0: 7073 3a2f 2f67 6974 6875 622e 636f 6d2f  ps://github.com/
+00049df0: 4175 746f 5669 4d4c 2f6c 617a 7974 7261  AutoViML/lazytra
+00049e00: 6e73 666f 726d 222c 0d0a 2020 2020 7079  nsform",..    py
+00049e10: 5f6d 6f64 756c 6573 203d 205b 226c 617a  _modules = ["laz
+00049e20: 7974 7261 6e73 666f 726d 225d 2c0d 0a20  ytransform"],.. 
+00049e30: 2020 2070 6163 6b61 6765 733d 7365 7475     packages=setu
+00049e40: 7074 6f6f 6c73 2e66 696e 645f 7061 636b  ptools.find_pack
+00049e50: 6167 6573 2865 7863 6c75 6465 3d28 2274  ages(exclude=("t
+00049e60: 6573 7473 222c 2929 2c0d 0a20 2020 2069  ests",)),..    i
+00049e70: 6e73 7461 6c6c 5f72 6571 7569 7265 733d  nstall_requires=
+00049e80: 5b0d 0a20 2020 2022 6e75 6d70 797e 3d31  [..    "numpy~=1
+00049e90: 2e32 302e 3322 2c0d 0a20 2020 2022 7061  .20.3",..    "pa
+00049ea0: 6e64 6173 7e3d 312e 322e 3422 2c0d 0a20  ndas~=1.2.4",.. 
+00049eb0: 2020 2022 7363 696b 6974 2d6c 6561 726e     "scikit-learn
+00049ec0: 7e3d 302e 3234 2e32 222c 0d0a 2020 2020  ~=0.24.2",..    
+00049ed0: 2270 7974 686f 6e2d 6461 7465 7574 696c  "python-dateutil
+00049ee0: 7e3d 322e 382e 3122 2c0d 0a20 2020 2022  ~=2.8.1",..    "
+00049ef0: 6c69 6768 7467 626d 3e3d 332e 322e 3122  lightgbm>=3.2.1"
+00049f00: 2c0d 0a20 2020 2022 696d 6261 6c61 6e63  ,..    "imbalanc
+00049f10: 6564 2d6c 6561 726e 3e3d 302e 382e 3022  ed-learn>=0.8.0"
+00049f20: 2c0d 0a20 2020 2022 6d61 7470 6c6f 746c  ,..    "matplotl
+00049f30: 6962 7e3d 332e 342e 3222 2c0d 0a20 2020  ib~=3.4.2",..   
+00049f40: 2022 6361 7465 676f 7279 2d65 6e63 6f64   "category-encod
+00049f50: 6572 737e 3d32 2e32 2e32 222c 0d0a 2020  ers~=2.2.2",..  
+00049f60: 2020 2274 7164 6d7e 3d34 2e36 312e 3122    "tqdm~=4.61.1"
+00049f70: 2c0d 0a20 2020 205d 2c0d 0a20 2020 2069  ,..    ],..    i
+00049f80: 6e63 6c75 6465 5f70 6163 6b61 6765 5f64  nclude_package_d
+00049f90: 6174 6120 3d20 5472 7565 2c0d 0a20 2020  ata = True,..   
+00049fa0: 2063 6c61 7373 6966 6965 7273 3d5b 0d0a   classifiers=[..
+00049fb0: 2020 2020 2020 2020 2250 726f 6772 616d          "Program
+00049fc0: 6d69 6e67 204c 616e 6775 6167 6520 3a3a  ming Language ::
+00049fd0: 2050 7974 686f 6e20 3a3a 2033 222c 0d0a   Python :: 3",..
+00049fe0: 2020 2020 2020 2020 224f 7065 7261 7469          "Operati
+00049ff0: 6e67 2053 7973 7465 6d20 3a3a 204f 5320  ng System :: OS 
+0004a000: 496e 6465 7065 6e64 656e 7422 2c0d 0a20  Independent",.. 
+0004a010: 2020 205d 2c0d 0a29 0d0a 0000 0000 0000     ],..)........
+0004a020: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+0004a030: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+0004a040: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+0004a050: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+0004a060: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+0004a070: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+0004a080: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+0004a090: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+0004a0a0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+0004a0b0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+0004a0c0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+0004a0d0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+0004a0e0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+0004a0f0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+0004a100: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+0004a110: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+0004a120: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+0004a130: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+0004a140: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+0004a150: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+0004a160: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+0004a170: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+0004a180: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+0004a190: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+0004a1a0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+0004a1b0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+0004a1c0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+0004a1d0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+0004a1e0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+0004a1f0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+0004a200: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+0004a210: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+0004a220: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+0004a230: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+0004a240: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+0004a250: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+0004a260: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+0004a270: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+0004a280: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+0004a290: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+0004a2a0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+0004a2b0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+0004a2c0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+0004a2d0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+0004a2e0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+0004a2f0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+0004a300: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+0004a310: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+0004a320: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+0004a330: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+0004a340: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+0004a350: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+0004a360: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+0004a370: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+0004a380: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+0004a390: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+0004a3a0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+0004a3b0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+0004a3c0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+0004a3d0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+0004a3e0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+0004a3f0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+0004a400: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+0004a410: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+0004a420: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+0004a430: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+0004a440: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+0004a450: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+0004a460: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+0004a470: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+0004a480: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+0004a490: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+0004a4a0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+0004a4b0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+0004a4c0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+0004a4d0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+0004a4e0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+0004a4f0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+0004a500: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+0004a510: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+0004a520: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+0004a530: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+0004a540: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+0004a550: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+0004a560: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+0004a570: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+0004a580: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+0004a590: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+0004a5a0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+0004a5b0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+0004a5c0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+0004a5d0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+0004a5e0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+0004a5f0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+0004a600: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+0004a610: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+0004a620: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+0004a630: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+0004a640: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+0004a650: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+0004a660: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+0004a670: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+0004a680: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+0004a690: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+0004a6a0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+0004a6b0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+0004a6c0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+0004a6d0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+0004a6e0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+0004a6f0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+0004a700: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+0004a710: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+0004a720: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+0004a730: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+0004a740: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+0004a750: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+0004a760: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+0004a770: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+0004a780: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+0004a790: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+0004a7a0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+0004a7b0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+0004a7c0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+0004a7d0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+0004a7e0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+0004a7f0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+0004a800: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+0004a810: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+0004a820: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+0004a830: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+0004a840: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+0004a850: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+0004a860: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+0004a870: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+0004a880: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+0004a890: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+0004a8a0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+0004a8b0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+0004a8c0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+0004a8d0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+0004a8e0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+0004a8f0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+0004a900: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+0004a910: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+0004a920: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+0004a930: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+0004a940: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+0004a950: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+0004a960: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+0004a970: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+0004a980: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+0004a990: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+0004a9a0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+0004a9b0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+0004a9c0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+0004a9d0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+0004a9e0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+0004a9f0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+0004aa00: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+0004aa10: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+0004aa20: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+0004aa30: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+0004aa40: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+0004aa50: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+0004aa60: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+0004aa70: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+0004aa80: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+0004aa90: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+0004aaa0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+0004aab0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+0004aac0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+0004aad0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+0004aae0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+0004aaf0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+0004ab00: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+0004ab10: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+0004ab20: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+0004ab30: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+0004ab40: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+0004ab50: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+0004ab60: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+0004ab70: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+0004ab80: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+0004ab90: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+0004aba0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+0004abb0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+0004abc0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+0004abd0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+0004abe0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+0004abf0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+0004ac00: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+0004ac10: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+0004ac20: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+0004ac30: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+0004ac40: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+0004ac50: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+0004ac60: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+0004ac70: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+0004ac80: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+0004ac90: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+0004aca0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+0004acb0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+0004acc0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+0004acd0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+0004ace0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+0004acf0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+0004ad00: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+0004ad10: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+0004ad20: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+0004ad30: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+0004ad40: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+0004ad50: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+0004ad60: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+0004ad70: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+0004ad80: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+0004ad90: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+0004ada0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+0004adb0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+0004adc0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+0004add0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+0004ade0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+0004adf0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+0004ae00: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+0004ae10: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+0004ae20: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+0004ae30: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+0004ae40: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+0004ae50: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+0004ae60: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+0004ae70: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+0004ae80: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+0004ae90: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+0004aea0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+0004aeb0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+0004aec0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+0004aed0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+0004aee0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+0004aef0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+0004af00: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+0004af10: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+0004af20: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+0004af30: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+0004af40: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+0004af50: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+0004af60: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+0004af70: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+0004af80: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+0004af90: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+0004afa0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+0004afb0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+0004afc0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+0004afd0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+0004afe0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+0004aff0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
```

